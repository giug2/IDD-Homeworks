<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1906.06268] Variational Federated Multi-Task Learning</title><meta property="og:description" content="In federated learning, a central server coordinates the training of a single model on a massively distributed network of devices. This setting can be naturally extended to a multi-task learning framework, to handle rea…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Variational Federated Multi-Task Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Variational Federated Multi-Task Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1906.06268">

<!--Generated on Wed Mar  6 13:44:33 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Variational Federated Multi-Task Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Luca Corinzia,
Ami Beuret, and Joachim M. Buhmann
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
Department of Computer Science
<br class="ltx_break">ETH Zürich, Switzerland
<br class="ltx_break">Email: {luca.corinzia, ami.beuret, jbuhmann}@inf.ethz.ch
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In federated learning, a central server coordinates the training of a single model on a massively distributed network of devices. This setting can be naturally extended to a multi-task learning framework, to handle real-world federated datasets that typically show strong statistical heterogeneity among devices. Despite federated multi-task learning being shown to be an effective paradigm for real-world datasets, it has been applied only on convex models. In this work, we introduce <span id="id1.id1.1" class="ltx_text ltx_font_typewriter">VIRTUAL</span>, an algorithm for federated multi-task learning for general non-convex models. In <span id="id1.id1.2" class="ltx_text ltx_font_typewriter">VIRTUAL</span> the federated network of the server and the clients is treated as a star-shaped Bayesian network, and learning is performed on the network using approximated variational inference. We show that this method is effective on real-world federated datasets, outperforming the current state-of-the-art for federated learning, and concurrently allowing sparser gradient updates.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Large scale networks of remote devices, like mobile phones, wearables, smart homes, self-driving cars, and other IoT devices are becoming a significant source of data to train statistical models.
As a consequence, there has been a growing interest to develop machine learning paradigms that can take into account distributed data-structure, despite the several challenges arising in this setting.
(i) Security: Data generated by remote devices is often privacy-sensitive and its centralized collection and storage is governed by data protection regulations (e.g GDPR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite> and the Consumer Privacy Bill of Rights <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>).
Learning paradigms that do not access user data directly are hence desired.
(2) System: Remote devices in these networks have typically important storage and computational capacity constraints, limiting the complexity and the size of the model that can be used. Moreover, the communication of information between devices or between the central server and devices, mostly happens on wireless networks. Hence communication cost can become a significant bottleneck of the learning process.
(3) Statistical: The devices of the network typically generate samples with different user-dependent probability distributions, making the setting in general strongly non-IID.
While it is a challenge to achieve high statistical accuracy for classical federated and distributed algorithms in this setting, a multi-task learning (MTL) approach can tackle heterogeneous data more naturally.
Every device of the network requires a task-specific model, tailored for its own data distribution, to boost the performance of each task.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> has emerged to address the scenario of learning models on private distributed data sources. It assumes a federation of devices called <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">clients</em> that both collect the data and execute an optimization routine, and a <em id="S1.p2.1.2" class="ltx_emph ltx_font_italic">server</em> that coordinates the learning process by receiving and sending updates from and to the clients. This paradigm has been applied successfully in many real-world cases, e.g, to train smart keyboards in commercial mobile devices <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> and to train privacy-preserving recommendation systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Federated Averaging (<span id="S1.p2.1.3" class="ltx_text ltx_font_typewriter">FedAvg</span>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite> is the state-of-the-art for federated learning with <em id="S1.p2.1.4" class="ltx_emph ltx_font_italic">non-convex</em> models and requires all clients to share the same model. Hence, it does not address the statistical challenge of strongly skewed data distributions, and while it has been shown to work well in practice for a range of (non-federated) real-world datasets, it performs poorly in heterogeneous scenarios <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. We address this problem by introducing <span id="S1.p2.1.5" class="ltx_text ltx_font_typewriter">VIRTUAL</span> (<span id="S1.p2.1.6" class="ltx_text ltx_font_bold">V</span>ar<span id="S1.p2.1.7" class="ltx_text ltx_font_bold">I</span>ational fede<span id="S1.p2.1.8" class="ltx_text ltx_font_bold">R</span>aTed m<span id="S1.p2.1.9" class="ltx_text ltx_font_bold">U</span>lti t<span id="S1.p2.1.10" class="ltx_text ltx_font_bold">A</span>sk <span id="S1.p2.1.11" class="ltx_text ltx_font_bold">L</span>earning), a new framework for federated MTL. In <span id="S1.p2.1.12" class="ltx_text ltx_font_typewriter">VIRTUAL</span>, the central server and the clients form a hierarchical Bayesian network and the inference is performed using variational methods. Every client has a task-specific model that benefits from the server model in a transfer learning fashion with <em id="S1.p2.1.13" class="ltx_emph ltx_font_italic">lateral connections</em>. A part of the parameters are shared between all clients, and another part is private and tuned separately. The server maintains a posterior distribution that represents the plausibility of the shared parameters. In one step of the algorithm, the posterior is communicated to the clients before the training starts, while during training the clients update the posterior given the likelihood of their local data. Finally, the posterior update is sent back to the central server.</p>
</div>
<section id="S1.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Contributions</h4>

<div id="S1.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S1.SS0.SSS0.Px1.p1.1" class="ltx_p">Our main contributions are twofold: (i) We address for the first time the problem of federated MTL for <em id="S1.SS0.SSS0.Px1.p1.1.1" class="ltx_emph ltx_font_italic">generic non-convex models</em>, designing an additional MT metric and proposing <span id="S1.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_typewriter">VIRTUAL</span>, an algorithm to perform federated training with strongly non-IID client data distributions. (ii) We perform extensive experimental evaluation of <span id="S1.SS0.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_typewriter">VIRTUAL</span> on real-world federated datasets, showing that it outperforms the current state-of-the-art in FL, and simultaneously allowing lower communication costs.</p>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">The </span><span id="S2.2.2" class="ltx_text ltx_font_typewriter">VIRTUAL</span><span id="S2.3.3" class="ltx_text ltx_font_smallcaps"> algorithm</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.5" class="ltx_p">In FL, <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">K</annotation></semantics></math> clients are associated with <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">K</annotation></semantics></math> datasets <math id="S2.p1.3.m3.3" class="ltx_Math" alttext="\mathcal{D}_{1},\dots,\mathcal{D}_{K}" display="inline"><semantics id="S2.p1.3.m3.3a"><mrow id="S2.p1.3.m3.3.3.2" xref="S2.p1.3.m3.3.3.3.cmml"><msub id="S2.p1.3.m3.2.2.1.1" xref="S2.p1.3.m3.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.2.2.1.1.2" xref="S2.p1.3.m3.2.2.1.1.2.cmml">𝒟</mi><mn id="S2.p1.3.m3.2.2.1.1.3" xref="S2.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p1.3.m3.3.3.2.3" xref="S2.p1.3.m3.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">…</mi><mo id="S2.p1.3.m3.3.3.2.4" xref="S2.p1.3.m3.3.3.3.cmml">,</mo><msub id="S2.p1.3.m3.3.3.2.2" xref="S2.p1.3.m3.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.3.3.2.2.2" xref="S2.p1.3.m3.3.3.2.2.2.cmml">𝒟</mi><mi id="S2.p1.3.m3.3.3.2.2.3" xref="S2.p1.3.m3.3.3.2.2.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.3b"><list id="S2.p1.3.m3.3.3.3.cmml" xref="S2.p1.3.m3.3.3.2"><apply id="S2.p1.3.m3.2.2.1.1.cmml" xref="S2.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.2.2.1.1.1.cmml" xref="S2.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S2.p1.3.m3.2.2.1.1.2.cmml" xref="S2.p1.3.m3.2.2.1.1.2">𝒟</ci><cn type="integer" id="S2.p1.3.m3.2.2.1.1.3.cmml" xref="S2.p1.3.m3.2.2.1.1.3">1</cn></apply><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">…</ci><apply id="S2.p1.3.m3.3.3.2.2.cmml" xref="S2.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.3.3.2.2.1.cmml" xref="S2.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S2.p1.3.m3.3.3.2.2.2.cmml" xref="S2.p1.3.m3.3.3.2.2.2">𝒟</ci><ci id="S2.p1.3.m3.3.3.2.2.3.cmml" xref="S2.p1.3.m3.3.3.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.3c">\mathcal{D}_{1},\dots,\mathcal{D}_{K}</annotation></semantics></math>, where <math id="S2.p1.4.m4.4" class="ltx_Math" alttext="\mathcal{D}_{i}\coloneqq\{\textbf{x}_{i}^{(n)},y_{i}^{(n)}\}_{n=1}^{N_{i}}" display="inline"><semantics id="S2.p1.4.m4.4a"><mrow id="S2.p1.4.m4.4.4" xref="S2.p1.4.m4.4.4.cmml"><msub id="S2.p1.4.m4.4.4.4" xref="S2.p1.4.m4.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.4.4.4.2" xref="S2.p1.4.m4.4.4.4.2.cmml">𝒟</mi><mi id="S2.p1.4.m4.4.4.4.3" xref="S2.p1.4.m4.4.4.4.3.cmml">i</mi></msub><mo id="S2.p1.4.m4.4.4.3" xref="S2.p1.4.m4.4.4.3.cmml">≔</mo><msubsup id="S2.p1.4.m4.4.4.2" xref="S2.p1.4.m4.4.4.2.cmml"><mrow id="S2.p1.4.m4.4.4.2.2.2.2" xref="S2.p1.4.m4.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S2.p1.4.m4.4.4.2.2.2.2.3" xref="S2.p1.4.m4.4.4.2.2.2.3.cmml">{</mo><msubsup id="S2.p1.4.m4.3.3.1.1.1.1.1" xref="S2.p1.4.m4.3.3.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S2.p1.4.m4.3.3.1.1.1.1.1.2.2" xref="S2.p1.4.m4.3.3.1.1.1.1.1.2.2a.cmml">x</mtext><mi id="S2.p1.4.m4.3.3.1.1.1.1.1.2.3" xref="S2.p1.4.m4.3.3.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.p1.4.m4.1.1.1.3" xref="S2.p1.4.m4.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p1.4.m4.1.1.1.3.1" xref="S2.p1.4.m4.3.3.1.1.1.1.1.cmml">(</mo><mi id="S2.p1.4.m4.1.1.1.1" xref="S2.p1.4.m4.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.p1.4.m4.1.1.1.3.2" xref="S2.p1.4.m4.3.3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.p1.4.m4.4.4.2.2.2.2.4" xref="S2.p1.4.m4.4.4.2.2.2.3.cmml">,</mo><msubsup id="S2.p1.4.m4.4.4.2.2.2.2.2" xref="S2.p1.4.m4.4.4.2.2.2.2.2.cmml"><mi id="S2.p1.4.m4.4.4.2.2.2.2.2.2.2" xref="S2.p1.4.m4.4.4.2.2.2.2.2.2.2.cmml">y</mi><mi id="S2.p1.4.m4.4.4.2.2.2.2.2.2.3" xref="S2.p1.4.m4.4.4.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S2.p1.4.m4.2.2.1.3" xref="S2.p1.4.m4.4.4.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.p1.4.m4.2.2.1.3.1" xref="S2.p1.4.m4.4.4.2.2.2.2.2.cmml">(</mo><mi id="S2.p1.4.m4.2.2.1.1" xref="S2.p1.4.m4.2.2.1.1.cmml">n</mi><mo stretchy="false" id="S2.p1.4.m4.2.2.1.3.2" xref="S2.p1.4.m4.4.4.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S2.p1.4.m4.4.4.2.2.2.2.5" xref="S2.p1.4.m4.4.4.2.2.2.3.cmml">}</mo></mrow><mrow id="S2.p1.4.m4.4.4.2.2.4" xref="S2.p1.4.m4.4.4.2.2.4.cmml"><mi id="S2.p1.4.m4.4.4.2.2.4.2" xref="S2.p1.4.m4.4.4.2.2.4.2.cmml">n</mi><mo id="S2.p1.4.m4.4.4.2.2.4.1" xref="S2.p1.4.m4.4.4.2.2.4.1.cmml">=</mo><mn id="S2.p1.4.m4.4.4.2.2.4.3" xref="S2.p1.4.m4.4.4.2.2.4.3.cmml">1</mn></mrow><msub id="S2.p1.4.m4.4.4.2.4" xref="S2.p1.4.m4.4.4.2.4.cmml"><mi id="S2.p1.4.m4.4.4.2.4.2" xref="S2.p1.4.m4.4.4.2.4.2.cmml">N</mi><mi id="S2.p1.4.m4.4.4.2.4.3" xref="S2.p1.4.m4.4.4.2.4.3.cmml">i</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.4b"><apply id="S2.p1.4.m4.4.4.cmml" xref="S2.p1.4.m4.4.4"><ci id="S2.p1.4.m4.4.4.3.cmml" xref="S2.p1.4.m4.4.4.3">≔</ci><apply id="S2.p1.4.m4.4.4.4.cmml" xref="S2.p1.4.m4.4.4.4"><csymbol cd="ambiguous" id="S2.p1.4.m4.4.4.4.1.cmml" xref="S2.p1.4.m4.4.4.4">subscript</csymbol><ci id="S2.p1.4.m4.4.4.4.2.cmml" xref="S2.p1.4.m4.4.4.4.2">𝒟</ci><ci id="S2.p1.4.m4.4.4.4.3.cmml" xref="S2.p1.4.m4.4.4.4.3">𝑖</ci></apply><apply id="S2.p1.4.m4.4.4.2.cmml" xref="S2.p1.4.m4.4.4.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.4.4.2.3.cmml" xref="S2.p1.4.m4.4.4.2">superscript</csymbol><apply id="S2.p1.4.m4.4.4.2.2.cmml" xref="S2.p1.4.m4.4.4.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.4.4.2.2.3.cmml" xref="S2.p1.4.m4.4.4.2">subscript</csymbol><set id="S2.p1.4.m4.4.4.2.2.2.3.cmml" xref="S2.p1.4.m4.4.4.2.2.2.2"><apply id="S2.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S2.p1.4.m4.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.3.3.1.1.1.1.1.1.cmml" xref="S2.p1.4.m4.3.3.1.1.1.1.1">superscript</csymbol><apply id="S2.p1.4.m4.3.3.1.1.1.1.1.2.cmml" xref="S2.p1.4.m4.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.4.m4.3.3.1.1.1.1.1.2.1.cmml" xref="S2.p1.4.m4.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.4.m4.3.3.1.1.1.1.1.2.2a.cmml" xref="S2.p1.4.m4.3.3.1.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S2.p1.4.m4.3.3.1.1.1.1.1.2.2.cmml" xref="S2.p1.4.m4.3.3.1.1.1.1.1.2.2">x</mtext></ci><ci id="S2.p1.4.m4.3.3.1.1.1.1.1.2.3.cmml" xref="S2.p1.4.m4.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.p1.4.m4.1.1.1.1.cmml" xref="S2.p1.4.m4.1.1.1.1">𝑛</ci></apply><apply id="S2.p1.4.m4.4.4.2.2.2.2.2.cmml" xref="S2.p1.4.m4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.4.4.2.2.2.2.2.1.cmml" xref="S2.p1.4.m4.4.4.2.2.2.2.2">superscript</csymbol><apply id="S2.p1.4.m4.4.4.2.2.2.2.2.2.cmml" xref="S2.p1.4.m4.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.4.m4.4.4.2.2.2.2.2.2.1.cmml" xref="S2.p1.4.m4.4.4.2.2.2.2.2">subscript</csymbol><ci id="S2.p1.4.m4.4.4.2.2.2.2.2.2.2.cmml" xref="S2.p1.4.m4.4.4.2.2.2.2.2.2.2">𝑦</ci><ci id="S2.p1.4.m4.4.4.2.2.2.2.2.2.3.cmml" xref="S2.p1.4.m4.4.4.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.p1.4.m4.2.2.1.1.cmml" xref="S2.p1.4.m4.2.2.1.1">𝑛</ci></apply></set><apply id="S2.p1.4.m4.4.4.2.2.4.cmml" xref="S2.p1.4.m4.4.4.2.2.4"><eq id="S2.p1.4.m4.4.4.2.2.4.1.cmml" xref="S2.p1.4.m4.4.4.2.2.4.1"></eq><ci id="S2.p1.4.m4.4.4.2.2.4.2.cmml" xref="S2.p1.4.m4.4.4.2.2.4.2">𝑛</ci><cn type="integer" id="S2.p1.4.m4.4.4.2.2.4.3.cmml" xref="S2.p1.4.m4.4.4.2.2.4.3">1</cn></apply></apply><apply id="S2.p1.4.m4.4.4.2.4.cmml" xref="S2.p1.4.m4.4.4.2.4"><csymbol cd="ambiguous" id="S2.p1.4.m4.4.4.2.4.1.cmml" xref="S2.p1.4.m4.4.4.2.4">subscript</csymbol><ci id="S2.p1.4.m4.4.4.2.4.2.cmml" xref="S2.p1.4.m4.4.4.2.4.2">𝑁</ci><ci id="S2.p1.4.m4.4.4.2.4.3.cmml" xref="S2.p1.4.m4.4.4.2.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.4c">\mathcal{D}_{i}\coloneqq\{\textbf{x}_{i}^{(n)},y_{i}^{(n)}\}_{n=1}^{N_{i}}</annotation></semantics></math> is in general generated by a client dependent probability distribution function (pdf) and only accessible by the respective client.
It is natural to fit <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p1.5.m5.1a"><mi id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">K</annotation></semantics></math> different models, one for each dataset, enforcing a relationship between models using parameter sharing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
This approach has been investigated extensively, and it has been shown to boost effective sample size and performance in MTL for neural networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">The Bayesian network</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.9" class="ltx_p">Let assume a star-shaped Bayesian network with a server <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">S</annotation></semantics></math> with model parameters <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\bm{\theta}</annotation></semantics></math>, as well as <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">K</annotation></semantics></math> clients with model parameters <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\{\bm{\phi}_{i}\}_{i=1}^{K}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msubsup id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mrow id="S2.SS1.p1.4.m4.1.1.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.1.1.1.1.1.2" xref="S2.SS1.p1.4.m4.1.1.1.1.2.cmml">{</mo><msub id="S2.SS1.p1.4.m4.1.1.1.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.4.m4.1.1.1.1.1.1.2" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p1.4.m4.1.1.1.1.1.1.3" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p1.4.m4.1.1.1.1.1.3" xref="S2.SS1.p1.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS1.p1.4.m4.1.1.1.3" xref="S2.SS1.p1.4.m4.1.1.1.3.cmml"><mi id="S2.SS1.p1.4.m4.1.1.1.3.2" xref="S2.SS1.p1.4.m4.1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.4.m4.1.1.1.3.1" xref="S2.SS1.p1.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S2.SS1.p1.4.m4.1.1.1.3.3" xref="S2.SS1.p1.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1">superscript</csymbol><apply id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><set id="S2.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1"><apply id="S2.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.SS1.p1.4.m4.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.1.3"><eq id="S2.SS1.p1.4.m4.1.1.1.3.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1.3.1"></eq><ci id="S2.SS1.p1.4.m4.1.1.1.3.2.cmml" xref="S2.SS1.p1.4.m4.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS1.p1.4.m4.1.1.1.3.3.cmml" xref="S2.SS1.p1.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\{\bm{\phi}_{i}\}_{i=1}^{K}</annotation></semantics></math>.
Assume that every client is a discriminative model distribution over the input given by <math id="S2.SS1.p1.5.m5.4" class="ltx_Math" alttext="p(y_{i}^{(n)}|\bm{x}_{i}^{(n)},\bm{\theta},\bm{\phi}_{i})" display="inline"><semantics id="S2.SS1.p1.5.m5.4a"><mrow id="S2.SS1.p1.5.m5.4.4" xref="S2.SS1.p1.5.m5.4.4.cmml"><mi id="S2.SS1.p1.5.m5.4.4.3" xref="S2.SS1.p1.5.m5.4.4.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.5.m5.4.4.2" xref="S2.SS1.p1.5.m5.4.4.2.cmml">​</mo><mrow id="S2.SS1.p1.5.m5.4.4.1.1" xref="S2.SS1.p1.5.m5.4.4.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.5.m5.4.4.1.1.2" xref="S2.SS1.p1.5.m5.4.4.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.5.m5.4.4.1.1.1" xref="S2.SS1.p1.5.m5.4.4.1.1.1.cmml"><msubsup id="S2.SS1.p1.5.m5.4.4.1.1.1.4" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4.cmml"><mi id="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.2" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.2.cmml">y</mi><mi id="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.3" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.3.cmml">i</mi><mrow id="S2.SS1.p1.5.m5.1.1.1.3" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4.cmml"><mo stretchy="false" id="S2.SS1.p1.5.m5.1.1.1.3.1" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4.cmml">(</mo><mi id="S2.SS1.p1.5.m5.1.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.SS1.p1.5.m5.1.1.1.3.2" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4.cmml">)</mo></mrow></msubsup><mo fence="false" id="S2.SS1.p1.5.m5.4.4.1.1.1.3" xref="S2.SS1.p1.5.m5.4.4.1.1.1.3.cmml">|</mo><mrow id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.3.cmml"><msubsup id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.SS1.p1.5.m5.2.2.1.3" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.5.m5.2.2.1.3.1" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S2.SS1.p1.5.m5.2.2.1.1" xref="S2.SS1.p1.5.m5.2.2.1.1.cmml">n</mi><mo stretchy="false" id="S2.SS1.p1.5.m5.2.2.1.3.2" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.3" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.3.cmml">,</mo><mi id="S2.SS1.p1.5.m5.3.3" xref="S2.SS1.p1.5.m5.3.3.cmml">𝜽</mi><mo id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.4" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.3.cmml">,</mo><msub id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.2" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.2.cmml">ϕ</mi><mi id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.3" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S2.SS1.p1.5.m5.4.4.1.1.3" xref="S2.SS1.p1.5.m5.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.4b"><apply id="S2.SS1.p1.5.m5.4.4.cmml" xref="S2.SS1.p1.5.m5.4.4"><times id="S2.SS1.p1.5.m5.4.4.2.cmml" xref="S2.SS1.p1.5.m5.4.4.2"></times><ci id="S2.SS1.p1.5.m5.4.4.3.cmml" xref="S2.SS1.p1.5.m5.4.4.3">𝑝</ci><apply id="S2.SS1.p1.5.m5.4.4.1.1.1.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1"><csymbol cd="latexml" id="S2.SS1.p1.5.m5.4.4.1.1.1.3.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.3">conditional</csymbol><apply id="S2.SS1.p1.5.m5.4.4.1.1.1.4.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.1.1.1.4.1.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4">superscript</csymbol><apply id="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.1.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.2.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.2">𝑦</ci><ci id="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.3.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.4.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.5.m5.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1.1">𝑛</ci></apply><list id="S2.SS1.p1.5.m5.4.4.1.1.1.2.3.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.2"><apply id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.5.m5.2.2.1.1.cmml" xref="S2.SS1.p1.5.m5.2.2.1.1">𝑛</ci></apply><ci id="S2.SS1.p1.5.m5.3.3.cmml" xref="S2.SS1.p1.5.m5.3.3">𝜽</ci><apply id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p1.5.m5.4.4.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.4c">p(y_{i}^{(n)}|\bm{x}_{i}^{(n)},\bm{\theta},\bm{\phi}_{i})</annotation></semantics></math> (a straight-forward extension of the work could consider also generative models).
Each dataset <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝒟</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathcal{D}_{i}</annotation></semantics></math> has a likelihood that factorizes as <math id="S2.SS1.p1.7.m7.6" class="ltx_Math" alttext="p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi_{i}})=\prod_{n=1}^{N_{i}}p(y_{i}^{(n)}|\bm{x}_{i}^{(n)},\bm{\theta},\bm{\phi}_{i})" display="inline"><semantics id="S2.SS1.p1.7.m7.6a"><mrow id="S2.SS1.p1.7.m7.6.6" xref="S2.SS1.p1.7.m7.6.6.cmml"><mrow id="S2.SS1.p1.7.m7.5.5.1" xref="S2.SS1.p1.7.m7.5.5.1.cmml"><mi id="S2.SS1.p1.7.m7.5.5.1.3" xref="S2.SS1.p1.7.m7.5.5.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.7.m7.5.5.1.2" xref="S2.SS1.p1.7.m7.5.5.1.2.cmml">​</mo><mrow id="S2.SS1.p1.7.m7.5.5.1.1.1" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.5.5.1.1.1.2" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.7.m7.5.5.1.1.1.1" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.cmml"><msub id="S2.SS1.p1.7.m7.5.5.1.1.1.1.3" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.2" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.2.cmml">𝒟</mi><mi id="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.3" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="S2.SS1.p1.7.m7.5.5.1.1.1.1.2" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.2.cmml">|</mo><mrow id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.7.m7.3.3" xref="S2.SS1.p1.7.m7.3.3.cmml">𝜽</mi><mo id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.2" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.2.cmml">,</mo><msub id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.3.cmml">𝒊</mi></msub></mrow></mrow><mo stretchy="false" id="S2.SS1.p1.7.m7.5.5.1.1.1.3" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.SS1.p1.7.m7.6.6.3" xref="S2.SS1.p1.7.m7.6.6.3.cmml">=</mo><mrow id="S2.SS1.p1.7.m7.6.6.2" xref="S2.SS1.p1.7.m7.6.6.2.cmml"><msubsup id="S2.SS1.p1.7.m7.6.6.2.2" xref="S2.SS1.p1.7.m7.6.6.2.2.cmml"><mo id="S2.SS1.p1.7.m7.6.6.2.2.2.2" xref="S2.SS1.p1.7.m7.6.6.2.2.2.2.cmml">∏</mo><mrow id="S2.SS1.p1.7.m7.6.6.2.2.2.3" xref="S2.SS1.p1.7.m7.6.6.2.2.2.3.cmml"><mi id="S2.SS1.p1.7.m7.6.6.2.2.2.3.2" xref="S2.SS1.p1.7.m7.6.6.2.2.2.3.2.cmml">n</mi><mo id="S2.SS1.p1.7.m7.6.6.2.2.2.3.1" xref="S2.SS1.p1.7.m7.6.6.2.2.2.3.1.cmml">=</mo><mn id="S2.SS1.p1.7.m7.6.6.2.2.2.3.3" xref="S2.SS1.p1.7.m7.6.6.2.2.2.3.3.cmml">1</mn></mrow><msub id="S2.SS1.p1.7.m7.6.6.2.2.3" xref="S2.SS1.p1.7.m7.6.6.2.2.3.cmml"><mi id="S2.SS1.p1.7.m7.6.6.2.2.3.2" xref="S2.SS1.p1.7.m7.6.6.2.2.3.2.cmml">N</mi><mi id="S2.SS1.p1.7.m7.6.6.2.2.3.3" xref="S2.SS1.p1.7.m7.6.6.2.2.3.3.cmml">i</mi></msub></msubsup><mrow id="S2.SS1.p1.7.m7.6.6.2.1" xref="S2.SS1.p1.7.m7.6.6.2.1.cmml"><mi id="S2.SS1.p1.7.m7.6.6.2.1.3" xref="S2.SS1.p1.7.m7.6.6.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.7.m7.6.6.2.1.2" xref="S2.SS1.p1.7.m7.6.6.2.1.2.cmml">​</mo><mrow id="S2.SS1.p1.7.m7.6.6.2.1.1.1" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.2" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.cmml"><msubsup id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.cmml"><mi id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.2" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.2.cmml">y</mi><mi id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.3" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.3.cmml">i</mi><mrow id="S2.SS1.p1.7.m7.1.1.1.3" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.1.1.1.3.1" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.cmml">(</mo><mi id="S2.SS1.p1.7.m7.1.1.1.1" xref="S2.SS1.p1.7.m7.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.SS1.p1.7.m7.1.1.1.3.2" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.cmml">)</mo></mrow></msubsup><mo fence="false" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.3" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.3.cmml"><msubsup id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.SS1.p1.7.m7.2.2.1.3" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.7.m7.2.2.1.3.1" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.SS1.p1.7.m7.2.2.1.1" xref="S2.SS1.p1.7.m7.2.2.1.1.cmml">n</mi><mo stretchy="false" id="S2.SS1.p1.7.m7.2.2.1.3.2" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.3" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.3.cmml">,</mo><mi id="S2.SS1.p1.7.m7.4.4" xref="S2.SS1.p1.7.m7.4.4.cmml">𝜽</mi><mo id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.4" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.3.cmml">,</mo><msub id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.2" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.2.cmml">ϕ</mi><mi id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.3" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.3" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.6b"><apply id="S2.SS1.p1.7.m7.6.6.cmml" xref="S2.SS1.p1.7.m7.6.6"><eq id="S2.SS1.p1.7.m7.6.6.3.cmml" xref="S2.SS1.p1.7.m7.6.6.3"></eq><apply id="S2.SS1.p1.7.m7.5.5.1.cmml" xref="S2.SS1.p1.7.m7.5.5.1"><times id="S2.SS1.p1.7.m7.5.5.1.2.cmml" xref="S2.SS1.p1.7.m7.5.5.1.2"></times><ci id="S2.SS1.p1.7.m7.5.5.1.3.cmml" xref="S2.SS1.p1.7.m7.5.5.1.3">𝑝</ci><apply id="S2.SS1.p1.7.m7.5.5.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.7.m7.5.5.1.1.1.1.2.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.2">conditional</csymbol><apply id="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.2">𝒟</ci><ci id="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.3.3">𝑖</ci></apply><list id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1"><ci id="S2.SS1.p1.7.m7.3.3.cmml" xref="S2.SS1.p1.7.m7.3.3">𝜽</ci><apply id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.7.m7.5.5.1.1.1.1.1.1.1.3">𝒊</ci></apply></list></apply></apply><apply id="S2.SS1.p1.7.m7.6.6.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2"><apply id="S2.SS1.p1.7.m7.6.6.2.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.6.6.2.2.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2">superscript</csymbol><apply id="S2.SS1.p1.7.m7.6.6.2.2.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.6.6.2.2.2.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS1.p1.7.m7.6.6.2.2.2.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.2.2">product</csymbol><apply id="S2.SS1.p1.7.m7.6.6.2.2.2.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.2.3"><eq id="S2.SS1.p1.7.m7.6.6.2.2.2.3.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.2.3.1"></eq><ci id="S2.SS1.p1.7.m7.6.6.2.2.2.3.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.2.3.2">𝑛</ci><cn type="integer" id="S2.SS1.p1.7.m7.6.6.2.2.2.3.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.2.3.3">1</cn></apply></apply><apply id="S2.SS1.p1.7.m7.6.6.2.2.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.6.6.2.2.3.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.7.m7.6.6.2.2.3.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.3.2">𝑁</ci><ci id="S2.SS1.p1.7.m7.6.6.2.2.3.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.2.3.3">𝑖</ci></apply></apply><apply id="S2.SS1.p1.7.m7.6.6.2.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1"><times id="S2.SS1.p1.7.m7.6.6.2.1.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.2"></times><ci id="S2.SS1.p1.7.m7.6.6.2.1.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.3">𝑝</ci><apply id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.3">conditional</csymbol><apply id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4">superscript</csymbol><apply id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.2">𝑦</ci><ci id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.7.m7.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1.1.1">𝑛</ci></apply><list id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2"><apply id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.7.m7.2.2.1.1.cmml" xref="S2.SS1.p1.7.m7.2.2.1.1">𝑛</ci></apply><ci id="S2.SS1.p1.7.m7.4.4.cmml" xref="S2.SS1.p1.7.m7.4.4">𝜽</ci><apply id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p1.7.m7.6.6.2.1.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.6c">p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi_{i}})=\prod_{n=1}^{N_{i}}p(y_{i}^{(n)}|\bm{x}_{i}^{(n)},\bm{\theta},\bm{\phi}_{i})</annotation></semantics></math>. Following a Bayesian approach, we assume a prior distribution over all network parameters <math id="S2.SS1.p1.8.m8.4" class="ltx_Math" alttext="p(\bm{\theta},\bm{\phi_{1}},\dots,\bm{\phi_{K}})" display="inline"><semantics id="S2.SS1.p1.8.m8.4a"><mrow id="S2.SS1.p1.8.m8.4.4" xref="S2.SS1.p1.8.m8.4.4.cmml"><mi id="S2.SS1.p1.8.m8.4.4.4" xref="S2.SS1.p1.8.m8.4.4.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.8.m8.4.4.3" xref="S2.SS1.p1.8.m8.4.4.3.cmml">​</mo><mrow id="S2.SS1.p1.8.m8.4.4.2.2" xref="S2.SS1.p1.8.m8.4.4.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.8.m8.4.4.2.2.3" xref="S2.SS1.p1.8.m8.4.4.2.3.cmml">(</mo><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">𝜽</mi><mo id="S2.SS1.p1.8.m8.4.4.2.2.4" xref="S2.SS1.p1.8.m8.4.4.2.3.cmml">,</mo><msub id="S2.SS1.p1.8.m8.3.3.1.1.1" xref="S2.SS1.p1.8.m8.3.3.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.8.m8.3.3.1.1.1.2" xref="S2.SS1.p1.8.m8.3.3.1.1.1.2.cmml">ϕ</mi><mn id="S2.SS1.p1.8.m8.3.3.1.1.1.3" xref="S2.SS1.p1.8.m8.3.3.1.1.1.3.cmml">𝟏</mn></msub><mo id="S2.SS1.p1.8.m8.4.4.2.2.5" xref="S2.SS1.p1.8.m8.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.8.m8.2.2" xref="S2.SS1.p1.8.m8.2.2.cmml">…</mi><mo id="S2.SS1.p1.8.m8.4.4.2.2.6" xref="S2.SS1.p1.8.m8.4.4.2.3.cmml">,</mo><msub id="S2.SS1.p1.8.m8.4.4.2.2.2" xref="S2.SS1.p1.8.m8.4.4.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.8.m8.4.4.2.2.2.2" xref="S2.SS1.p1.8.m8.4.4.2.2.2.2.cmml">ϕ</mi><mi id="S2.SS1.p1.8.m8.4.4.2.2.2.3" xref="S2.SS1.p1.8.m8.4.4.2.2.2.3.cmml">𝑲</mi></msub><mo stretchy="false" id="S2.SS1.p1.8.m8.4.4.2.2.7" xref="S2.SS1.p1.8.m8.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.4b"><apply id="S2.SS1.p1.8.m8.4.4.cmml" xref="S2.SS1.p1.8.m8.4.4"><times id="S2.SS1.p1.8.m8.4.4.3.cmml" xref="S2.SS1.p1.8.m8.4.4.3"></times><ci id="S2.SS1.p1.8.m8.4.4.4.cmml" xref="S2.SS1.p1.8.m8.4.4.4">𝑝</ci><vector id="S2.SS1.p1.8.m8.4.4.2.3.cmml" xref="S2.SS1.p1.8.m8.4.4.2.2"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝜽</ci><apply id="S2.SS1.p1.8.m8.3.3.1.1.1.cmml" xref="S2.SS1.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.8.m8.3.3.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m8.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.8.m8.3.3.1.1.1.2">bold-italic-ϕ</ci><cn type="integer" id="S2.SS1.p1.8.m8.3.3.1.1.1.3.cmml" xref="S2.SS1.p1.8.m8.3.3.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.8.m8.2.2.cmml" xref="S2.SS1.p1.8.m8.2.2">…</ci><apply id="S2.SS1.p1.8.m8.4.4.2.2.2.cmml" xref="S2.SS1.p1.8.m8.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.8.m8.4.4.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.8.m8.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.8.m8.4.4.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.8.m8.4.4.2.2.2.3.cmml" xref="S2.SS1.p1.8.m8.4.4.2.2.2.3">𝑲</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.4c">p(\bm{\theta},\bm{\phi_{1}},\dots,\bm{\phi_{K}})</annotation></semantics></math>.
The posterior distribution over all parameters, given <em id="S2.SS1.p1.9.1" class="ltx_emph ltx_font_italic">all</em> datasets <math id="S2.SS1.p1.9.m9.3" class="ltx_Math" alttext="\mathcal{D}_{1:K}\coloneqq\{\mathcal{D}_{1},\dots,\mathcal{D}_{k}\}" display="inline"><semantics id="S2.SS1.p1.9.m9.3a"><mrow id="S2.SS1.p1.9.m9.3.3" xref="S2.SS1.p1.9.m9.3.3.cmml"><msub id="S2.SS1.p1.9.m9.3.3.4" xref="S2.SS1.p1.9.m9.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m9.3.3.4.2" xref="S2.SS1.p1.9.m9.3.3.4.2.cmml">𝒟</mi><mrow id="S2.SS1.p1.9.m9.3.3.4.3" xref="S2.SS1.p1.9.m9.3.3.4.3.cmml"><mn id="S2.SS1.p1.9.m9.3.3.4.3.2" xref="S2.SS1.p1.9.m9.3.3.4.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p1.9.m9.3.3.4.3.1" xref="S2.SS1.p1.9.m9.3.3.4.3.1.cmml">:</mo><mi id="S2.SS1.p1.9.m9.3.3.4.3.3" xref="S2.SS1.p1.9.m9.3.3.4.3.3.cmml">K</mi></mrow></msub><mo id="S2.SS1.p1.9.m9.3.3.3" xref="S2.SS1.p1.9.m9.3.3.3.cmml">≔</mo><mrow id="S2.SS1.p1.9.m9.3.3.2.2" xref="S2.SS1.p1.9.m9.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.9.m9.3.3.2.2.3" xref="S2.SS1.p1.9.m9.3.3.2.3.cmml">{</mo><msub id="S2.SS1.p1.9.m9.2.2.1.1.1" xref="S2.SS1.p1.9.m9.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m9.2.2.1.1.1.2" xref="S2.SS1.p1.9.m9.2.2.1.1.1.2.cmml">𝒟</mi><mn id="S2.SS1.p1.9.m9.2.2.1.1.1.3" xref="S2.SS1.p1.9.m9.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.9.m9.3.3.2.2.4" xref="S2.SS1.p1.9.m9.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">…</mi><mo id="S2.SS1.p1.9.m9.3.3.2.2.5" xref="S2.SS1.p1.9.m9.3.3.2.3.cmml">,</mo><msub id="S2.SS1.p1.9.m9.3.3.2.2.2" xref="S2.SS1.p1.9.m9.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m9.3.3.2.2.2.2" xref="S2.SS1.p1.9.m9.3.3.2.2.2.2.cmml">𝒟</mi><mi id="S2.SS1.p1.9.m9.3.3.2.2.2.3" xref="S2.SS1.p1.9.m9.3.3.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.p1.9.m9.3.3.2.2.6" xref="S2.SS1.p1.9.m9.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.3b"><apply id="S2.SS1.p1.9.m9.3.3.cmml" xref="S2.SS1.p1.9.m9.3.3"><ci id="S2.SS1.p1.9.m9.3.3.3.cmml" xref="S2.SS1.p1.9.m9.3.3.3">≔</ci><apply id="S2.SS1.p1.9.m9.3.3.4.cmml" xref="S2.SS1.p1.9.m9.3.3.4"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.3.3.4.1.cmml" xref="S2.SS1.p1.9.m9.3.3.4">subscript</csymbol><ci id="S2.SS1.p1.9.m9.3.3.4.2.cmml" xref="S2.SS1.p1.9.m9.3.3.4.2">𝒟</ci><apply id="S2.SS1.p1.9.m9.3.3.4.3.cmml" xref="S2.SS1.p1.9.m9.3.3.4.3"><ci id="S2.SS1.p1.9.m9.3.3.4.3.1.cmml" xref="S2.SS1.p1.9.m9.3.3.4.3.1">:</ci><cn type="integer" id="S2.SS1.p1.9.m9.3.3.4.3.2.cmml" xref="S2.SS1.p1.9.m9.3.3.4.3.2">1</cn><ci id="S2.SS1.p1.9.m9.3.3.4.3.3.cmml" xref="S2.SS1.p1.9.m9.3.3.4.3.3">𝐾</ci></apply></apply><set id="S2.SS1.p1.9.m9.3.3.2.3.cmml" xref="S2.SS1.p1.9.m9.3.3.2.2"><apply id="S2.SS1.p1.9.m9.2.2.1.1.1.cmml" xref="S2.SS1.p1.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.9.m9.2.2.1.1.1.2">𝒟</ci><cn type="integer" id="S2.SS1.p1.9.m9.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.9.m9.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">…</ci><apply id="S2.SS1.p1.9.m9.3.3.2.2.2.cmml" xref="S2.SS1.p1.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.9.m9.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.9.m9.3.3.2.2.2.2">𝒟</ci><ci id="S2.SS1.p1.9.m9.3.3.2.2.2.3.cmml" xref="S2.SS1.p1.9.m9.3.3.2.2.2.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.3c">\mathcal{D}_{1:K}\coloneqq\{\mathcal{D}_{1},\dots,\mathcal{D}_{k}\}</annotation></semantics></math> reads then</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.7" class="ltx_Math" alttext="p(\bm{\theta},\bm{\phi_{1}},\dots,\bm{\phi_{K}}|\mathcal{D}_{1:K})\propto\frac{\prod_{i=1}^{K}p(\bm{\theta},\bm{\phi_{i}}|\mathcal{D}_{i})}{p(\bm{\theta})^{K-1}}" display="block"><semantics id="S2.E1.m1.7a"><mrow id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml"><mrow id="S2.E1.m1.7.7.2" xref="S2.E1.m1.7.7.2.cmml"><mi id="S2.E1.m1.7.7.2.4" xref="S2.E1.m1.7.7.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.7.7.2.3" xref="S2.E1.m1.7.7.2.3.cmml">​</mo><mrow id="S2.E1.m1.7.7.2.2.2" xref="S2.E1.m1.7.7.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.7.7.2.2.2.3" xref="S2.E1.m1.7.7.2.2.3.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">𝜽</mi><mo id="S2.E1.m1.7.7.2.2.2.4" xref="S2.E1.m1.7.7.2.2.3.cmml">,</mo><msub id="S2.E1.m1.6.6.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E1.m1.6.6.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.2.cmml">ϕ</mi><mn id="S2.E1.m1.6.6.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.3.cmml">𝟏</mn></msub><mo id="S2.E1.m1.7.7.2.2.2.5" xref="S2.E1.m1.7.7.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">…</mi><mo id="S2.E1.m1.7.7.2.2.2.6" xref="S2.E1.m1.7.7.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.7.7.2.2.2.2" xref="S2.E1.m1.7.7.2.2.2.2.cmml"><msub id="S2.E1.m1.7.7.2.2.2.2.2" xref="S2.E1.m1.7.7.2.2.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E1.m1.7.7.2.2.2.2.2.2" xref="S2.E1.m1.7.7.2.2.2.2.2.2.cmml">ϕ</mi><mi id="S2.E1.m1.7.7.2.2.2.2.2.3" xref="S2.E1.m1.7.7.2.2.2.2.2.3.cmml">𝑲</mi></msub><mo fence="false" id="S2.E1.m1.7.7.2.2.2.2.1" xref="S2.E1.m1.7.7.2.2.2.2.1.cmml">|</mo><msub id="S2.E1.m1.7.7.2.2.2.2.3" xref="S2.E1.m1.7.7.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.7.7.2.2.2.2.3.2" xref="S2.E1.m1.7.7.2.2.2.2.3.2.cmml">𝒟</mi><mrow id="S2.E1.m1.7.7.2.2.2.2.3.3" xref="S2.E1.m1.7.7.2.2.2.2.3.3.cmml"><mn id="S2.E1.m1.7.7.2.2.2.2.3.3.2" xref="S2.E1.m1.7.7.2.2.2.2.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E1.m1.7.7.2.2.2.2.3.3.1" xref="S2.E1.m1.7.7.2.2.2.2.3.3.1.cmml">:</mo><mi id="S2.E1.m1.7.7.2.2.2.2.3.3.3" xref="S2.E1.m1.7.7.2.2.2.2.3.3.3.cmml">K</mi></mrow></msub></mrow><mo stretchy="false" id="S2.E1.m1.7.7.2.2.2.7" xref="S2.E1.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.7.7.3" xref="S2.E1.m1.7.7.3.cmml">∝</mo><mfrac id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml"><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><msubsup id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml"><mo id="S2.E1.m1.2.2.2.3.2.2" xref="S2.E1.m1.2.2.2.3.2.2.cmml">∏</mo><mrow id="S2.E1.m1.2.2.2.3.2.3" xref="S2.E1.m1.2.2.2.3.2.3.cmml"><mi id="S2.E1.m1.2.2.2.3.2.3.2" xref="S2.E1.m1.2.2.2.3.2.3.2.cmml">i</mi><mo id="S2.E1.m1.2.2.2.3.2.3.1" xref="S2.E1.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E1.m1.2.2.2.3.2.3.3" xref="S2.E1.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.2.2.2.3.3" xref="S2.E1.m1.2.2.2.3.3.cmml">K</mi></msubsup><mrow id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.cmml">​</mo><mrow id="S2.E1.m1.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.2.1.1.2" xref="S2.E1.m1.2.2.2.2.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">𝜽</mi><mo id="S2.E1.m1.2.2.2.2.1.1.3" xref="S2.E1.m1.2.2.2.2.1.2.cmml">,</mo><mrow id="S2.E1.m1.2.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.cmml"><msub id="S2.E1.m1.2.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.2.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E1.m1.2.2.2.2.1.1.1.2.2" xref="S2.E1.m1.2.2.2.2.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.E1.m1.2.2.2.2.1.1.1.2.3" xref="S2.E1.m1.2.2.2.2.1.1.1.2.3.cmml">𝒊</mi></msub><mo fence="false" id="S2.E1.m1.2.2.2.2.1.1.1.1" xref="S2.E1.m1.2.2.2.2.1.1.1.1.cmml">|</mo><msub id="S2.E1.m1.2.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.2.2.2.2.1.1.1.3.2" xref="S2.E1.m1.2.2.2.2.1.1.1.3.2.cmml">𝒟</mi><mi id="S2.E1.m1.2.2.2.2.1.1.1.3.3" xref="S2.E1.m1.2.2.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S2.E1.m1.2.2.2.2.1.1.4" xref="S2.E1.m1.2.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.E1.m1.3.3.3" xref="S2.E1.m1.3.3.3.cmml"><mi id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.2" xref="S2.E1.m1.3.3.3.2.cmml">​</mo><msup id="S2.E1.m1.3.3.3.4" xref="S2.E1.m1.3.3.3.4.cmml"><mrow id="S2.E1.m1.3.3.3.4.2.2" xref="S2.E1.m1.3.3.3.4.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.3.4.2.2.1" xref="S2.E1.m1.3.3.3.4.cmml">(</mo><mi id="S2.E1.m1.3.3.3.1" xref="S2.E1.m1.3.3.3.1.cmml">𝜽</mi><mo stretchy="false" id="S2.E1.m1.3.3.3.4.2.2.2" xref="S2.E1.m1.3.3.3.4.cmml">)</mo></mrow><mrow id="S2.E1.m1.3.3.3.4.3" xref="S2.E1.m1.3.3.3.4.3.cmml"><mi id="S2.E1.m1.3.3.3.4.3.2" xref="S2.E1.m1.3.3.3.4.3.2.cmml">K</mi><mo id="S2.E1.m1.3.3.3.4.3.1" xref="S2.E1.m1.3.3.3.4.3.1.cmml">−</mo><mn id="S2.E1.m1.3.3.3.4.3.3" xref="S2.E1.m1.3.3.3.4.3.3.cmml">1</mn></mrow></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.7b"><apply id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7"><csymbol cd="latexml" id="S2.E1.m1.7.7.3.cmml" xref="S2.E1.m1.7.7.3">proportional-to</csymbol><apply id="S2.E1.m1.7.7.2.cmml" xref="S2.E1.m1.7.7.2"><times id="S2.E1.m1.7.7.2.3.cmml" xref="S2.E1.m1.7.7.2.3"></times><ci id="S2.E1.m1.7.7.2.4.cmml" xref="S2.E1.m1.7.7.2.4">𝑝</ci><vector id="S2.E1.m1.7.7.2.2.3.cmml" xref="S2.E1.m1.7.7.2.2.2"><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝜽</ci><apply id="S2.E1.m1.6.6.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2">bold-italic-ϕ</ci><cn type="integer" id="S2.E1.m1.6.6.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3">1</cn></apply><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">…</ci><apply id="S2.E1.m1.7.7.2.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.7.7.2.2.2.2.1.cmml" xref="S2.E1.m1.7.7.2.2.2.2.1">conditional</csymbol><apply id="S2.E1.m1.7.7.2.2.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.2.2.2.2.2.1.cmml" xref="S2.E1.m1.7.7.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.7.7.2.2.2.2.2.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.E1.m1.7.7.2.2.2.2.2.3.cmml" xref="S2.E1.m1.7.7.2.2.2.2.2.3">𝑲</ci></apply><apply id="S2.E1.m1.7.7.2.2.2.2.3.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.7.7.2.2.2.2.3.1.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.7.7.2.2.2.2.3.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3.2">𝒟</ci><apply id="S2.E1.m1.7.7.2.2.2.2.3.3.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3.3"><ci id="S2.E1.m1.7.7.2.2.2.2.3.3.1.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3.3.1">:</ci><cn type="integer" id="S2.E1.m1.7.7.2.2.2.2.3.3.2.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3.3.2">1</cn><ci id="S2.E1.m1.7.7.2.2.2.2.3.3.3.cmml" xref="S2.E1.m1.7.7.2.2.2.2.3.3.3">𝐾</ci></apply></apply></apply></vector></apply><apply id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3"><divide id="S2.E1.m1.3.3.4.cmml" xref="S2.E1.m1.3.3"></divide><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><apply id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.3">superscript</csymbol><apply id="S2.E1.m1.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.3.2.1.cmml" xref="S2.E1.m1.2.2.2.3">subscript</csymbol><csymbol cd="latexml" id="S2.E1.m1.2.2.2.3.2.2.cmml" xref="S2.E1.m1.2.2.2.3.2.2">product</csymbol><apply id="S2.E1.m1.2.2.2.3.2.3.cmml" xref="S2.E1.m1.2.2.2.3.2.3"><eq id="S2.E1.m1.2.2.2.3.2.3.1.cmml" xref="S2.E1.m1.2.2.2.3.2.3.1"></eq><ci id="S2.E1.m1.2.2.2.3.2.3.2.cmml" xref="S2.E1.m1.2.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.2.2.2.3.2.3.3.cmml" xref="S2.E1.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.3.3">𝐾</ci></apply><apply id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"><times id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2"></times><ci id="S2.E1.m1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.3">𝑝</ci><interval closure="open" id="S2.E1.m1.2.2.2.2.1.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝜽</ci><apply id="S2.E1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.1">conditional</csymbol><apply id="S2.E1.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E1.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.2.3">𝒊</ci></apply><apply id="S2.E1.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.3.2">𝒟</ci><ci id="S2.E1.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E1.m1.2.2.2.2.1.1.1.3.3">𝑖</ci></apply></apply></interval></apply></apply><apply id="S2.E1.m1.3.3.3.cmml" xref="S2.E1.m1.3.3.3"><times id="S2.E1.m1.3.3.3.2.cmml" xref="S2.E1.m1.3.3.3.2"></times><ci id="S2.E1.m1.3.3.3.3.cmml" xref="S2.E1.m1.3.3.3.3">𝑝</ci><apply id="S2.E1.m1.3.3.3.4.cmml" xref="S2.E1.m1.3.3.3.4"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.4.1.cmml" xref="S2.E1.m1.3.3.3.4">superscript</csymbol><ci id="S2.E1.m1.3.3.3.1.cmml" xref="S2.E1.m1.3.3.3.1">𝜽</ci><apply id="S2.E1.m1.3.3.3.4.3.cmml" xref="S2.E1.m1.3.3.3.4.3"><minus id="S2.E1.m1.3.3.3.4.3.1.cmml" xref="S2.E1.m1.3.3.3.4.3.1"></minus><ci id="S2.E1.m1.3.3.3.4.3.2.cmml" xref="S2.E1.m1.3.3.3.4.3.2">𝐾</ci><cn type="integer" id="S2.E1.m1.3.3.3.4.3.3.cmml" xref="S2.E1.m1.3.3.3.4.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.7c">p(\bm{\theta},\bm{\phi_{1}},\dots,\bm{\phi_{K}}|\mathcal{D}_{1:K})\propto\frac{\prod_{i=1}^{K}p(\bm{\theta},\bm{\phi_{i}}|\mathcal{D}_{i})}{p(\bm{\theta})^{K-1}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.11" class="ltx_p">where we enforce that client-data is conditionally independent given server and client parameters,
<math id="S2.SS1.p1.10.m1.5" class="ltx_Math" alttext="p(\mathcal{D}_{1:K}|\bm{\theta},\bm{\phi_{1}},\dots,\bm{\phi_{K}})=\prod_{i=1}^{K}p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi_{i}})" display="inline"><semantics id="S2.SS1.p1.10.m1.5a"><mrow id="S2.SS1.p1.10.m1.5.5" xref="S2.SS1.p1.10.m1.5.5.cmml"><mrow id="S2.SS1.p1.10.m1.4.4.1" xref="S2.SS1.p1.10.m1.4.4.1.cmml"><mi id="S2.SS1.p1.10.m1.4.4.1.3" xref="S2.SS1.p1.10.m1.4.4.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.10.m1.4.4.1.2" xref="S2.SS1.p1.10.m1.4.4.1.2.cmml">​</mo><mrow id="S2.SS1.p1.10.m1.4.4.1.1.1" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.10.m1.4.4.1.1.1.2" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.10.m1.4.4.1.1.1.1" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.cmml"><msub id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.2" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.2.cmml">𝒟</mi><mrow id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.cmml"><mn id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.2" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.1" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.1.cmml">:</mo><mi id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.3" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.3.cmml">K</mi></mrow></msub><mo fence="false" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.3" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.3.cmml"><mi id="S2.SS1.p1.10.m1.1.1" xref="S2.SS1.p1.10.m1.1.1.cmml">𝜽</mi><mo id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.3" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.3.cmml">,</mo><msub id="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mn id="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.3.cmml">𝟏</mn></msub><mo id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.4" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.10.m1.2.2" xref="S2.SS1.p1.10.m1.2.2.cmml">…</mi><mo id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.5" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.3.cmml">,</mo><msub id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.2" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.2.cmml">ϕ</mi><mi id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.3" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.3.cmml">𝑲</mi></msub></mrow></mrow><mo stretchy="false" id="S2.SS1.p1.10.m1.4.4.1.1.1.3" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.SS1.p1.10.m1.5.5.3" xref="S2.SS1.p1.10.m1.5.5.3.cmml">=</mo><mrow id="S2.SS1.p1.10.m1.5.5.2" xref="S2.SS1.p1.10.m1.5.5.2.cmml"><msubsup id="S2.SS1.p1.10.m1.5.5.2.2" xref="S2.SS1.p1.10.m1.5.5.2.2.cmml"><mo id="S2.SS1.p1.10.m1.5.5.2.2.2.2" xref="S2.SS1.p1.10.m1.5.5.2.2.2.2.cmml">∏</mo><mrow id="S2.SS1.p1.10.m1.5.5.2.2.2.3" xref="S2.SS1.p1.10.m1.5.5.2.2.2.3.cmml"><mi id="S2.SS1.p1.10.m1.5.5.2.2.2.3.2" xref="S2.SS1.p1.10.m1.5.5.2.2.2.3.2.cmml">i</mi><mo id="S2.SS1.p1.10.m1.5.5.2.2.2.3.1" xref="S2.SS1.p1.10.m1.5.5.2.2.2.3.1.cmml">=</mo><mn id="S2.SS1.p1.10.m1.5.5.2.2.2.3.3" xref="S2.SS1.p1.10.m1.5.5.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.10.m1.5.5.2.2.3" xref="S2.SS1.p1.10.m1.5.5.2.2.3.cmml">K</mi></msubsup><mrow id="S2.SS1.p1.10.m1.5.5.2.1" xref="S2.SS1.p1.10.m1.5.5.2.1.cmml"><mi id="S2.SS1.p1.10.m1.5.5.2.1.3" xref="S2.SS1.p1.10.m1.5.5.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.10.m1.5.5.2.1.2" xref="S2.SS1.p1.10.m1.5.5.2.1.2.cmml">​</mo><mrow id="S2.SS1.p1.10.m1.5.5.2.1.1.1" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.10.m1.5.5.2.1.1.1.2" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.cmml"><msub id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.2" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.2.cmml">𝒟</mi><mi id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.3" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.2" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.2.cmml">|</mo><mrow id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.2.cmml"><mi id="S2.SS1.p1.10.m1.3.3" xref="S2.SS1.p1.10.m1.3.3.cmml">𝜽</mi><mo id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.2" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.2.cmml">,</mo><msub id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.3.cmml">𝒊</mi></msub></mrow></mrow><mo stretchy="false" id="S2.SS1.p1.10.m1.5.5.2.1.1.1.3" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m1.5b"><apply id="S2.SS1.p1.10.m1.5.5.cmml" xref="S2.SS1.p1.10.m1.5.5"><eq id="S2.SS1.p1.10.m1.5.5.3.cmml" xref="S2.SS1.p1.10.m1.5.5.3"></eq><apply id="S2.SS1.p1.10.m1.4.4.1.cmml" xref="S2.SS1.p1.10.m1.4.4.1"><times id="S2.SS1.p1.10.m1.4.4.1.2.cmml" xref="S2.SS1.p1.10.m1.4.4.1.2"></times><ci id="S2.SS1.p1.10.m1.4.4.1.3.cmml" xref="S2.SS1.p1.10.m1.4.4.1.3">𝑝</ci><apply id="S2.SS1.p1.10.m1.4.4.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.3">conditional</csymbol><apply id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.1.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.2.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.2">𝒟</ci><apply id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3"><ci id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.1.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.1">:</ci><cn type="integer" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.2.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.2">1</cn><ci id="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.3.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.4.3.3">𝐾</ci></apply></apply><list id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2"><ci id="S2.SS1.p1.10.m1.1.1.cmml" xref="S2.SS1.p1.10.m1.1.1">𝜽</ci><apply id="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.2">bold-italic-ϕ</ci><cn type="integer" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.10.m1.2.2.cmml" xref="S2.SS1.p1.10.m1.2.2">…</ci><apply id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.1.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p1.10.m1.4.4.1.1.1.1.2.2.2.3">𝑲</ci></apply></list></apply></apply><apply id="S2.SS1.p1.10.m1.5.5.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2"><apply id="S2.SS1.p1.10.m1.5.5.2.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.5.5.2.2.1.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2">superscript</csymbol><apply id="S2.SS1.p1.10.m1.5.5.2.2.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.5.5.2.2.2.1.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS1.p1.10.m1.5.5.2.2.2.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2.2.2">product</csymbol><apply id="S2.SS1.p1.10.m1.5.5.2.2.2.3.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2.2.3"><eq id="S2.SS1.p1.10.m1.5.5.2.2.2.3.1.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2.2.3.1"></eq><ci id="S2.SS1.p1.10.m1.5.5.2.2.2.3.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2.2.3.2">𝑖</ci><cn type="integer" id="S2.SS1.p1.10.m1.5.5.2.2.2.3.3.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.10.m1.5.5.2.2.3.cmml" xref="S2.SS1.p1.10.m1.5.5.2.2.3">𝐾</ci></apply><apply id="S2.SS1.p1.10.m1.5.5.2.1.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1"><times id="S2.SS1.p1.10.m1.5.5.2.1.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.2"></times><ci id="S2.SS1.p1.10.m1.5.5.2.1.3.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.3">𝑝</ci><apply id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.2">conditional</csymbol><apply id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.1.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.2">𝒟</ci><ci id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.3.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.3.3">𝑖</ci></apply><list id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1"><ci id="S2.SS1.p1.10.m1.3.3.cmml" xref="S2.SS1.p1.10.m1.3.3">𝜽</ci><apply id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.10.m1.5.5.2.1.1.1.1.1.1.1.3">𝒊</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m1.5c">p(\mathcal{D}_{1:K}|\bm{\theta},\bm{\phi_{1}},\dots,\bm{\phi_{K}})=\prod_{i=1}^{K}p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi_{i}})</annotation></semantics></math>
, and a factorization of the prior as <math id="S2.SS1.p1.11.m2.6" class="ltx_Math" alttext="p(\bm{\theta},\bm{\phi_{1}},\dots,\bm{\phi_{K}})=p(\bm{\theta})\prod_{i=1}^{K}p(\bm{\phi_{i}})" display="inline"><semantics id="S2.SS1.p1.11.m2.6a"><mrow id="S2.SS1.p1.11.m2.6.6" xref="S2.SS1.p1.11.m2.6.6.cmml"><mrow id="S2.SS1.p1.11.m2.5.5.2" xref="S2.SS1.p1.11.m2.5.5.2.cmml"><mi id="S2.SS1.p1.11.m2.5.5.2.4" xref="S2.SS1.p1.11.m2.5.5.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.11.m2.5.5.2.3" xref="S2.SS1.p1.11.m2.5.5.2.3.cmml">​</mo><mrow id="S2.SS1.p1.11.m2.5.5.2.2.2" xref="S2.SS1.p1.11.m2.5.5.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.11.m2.5.5.2.2.2.3" xref="S2.SS1.p1.11.m2.5.5.2.2.3.cmml">(</mo><mi id="S2.SS1.p1.11.m2.1.1" xref="S2.SS1.p1.11.m2.1.1.cmml">𝜽</mi><mo id="S2.SS1.p1.11.m2.5.5.2.2.2.4" xref="S2.SS1.p1.11.m2.5.5.2.2.3.cmml">,</mo><msub id="S2.SS1.p1.11.m2.4.4.1.1.1.1" xref="S2.SS1.p1.11.m2.4.4.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.11.m2.4.4.1.1.1.1.2" xref="S2.SS1.p1.11.m2.4.4.1.1.1.1.2.cmml">ϕ</mi><mn id="S2.SS1.p1.11.m2.4.4.1.1.1.1.3" xref="S2.SS1.p1.11.m2.4.4.1.1.1.1.3.cmml">𝟏</mn></msub><mo id="S2.SS1.p1.11.m2.5.5.2.2.2.5" xref="S2.SS1.p1.11.m2.5.5.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.11.m2.2.2" xref="S2.SS1.p1.11.m2.2.2.cmml">…</mi><mo id="S2.SS1.p1.11.m2.5.5.2.2.2.6" xref="S2.SS1.p1.11.m2.5.5.2.2.3.cmml">,</mo><msub id="S2.SS1.p1.11.m2.5.5.2.2.2.2" xref="S2.SS1.p1.11.m2.5.5.2.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.11.m2.5.5.2.2.2.2.2" xref="S2.SS1.p1.11.m2.5.5.2.2.2.2.2.cmml">ϕ</mi><mi id="S2.SS1.p1.11.m2.5.5.2.2.2.2.3" xref="S2.SS1.p1.11.m2.5.5.2.2.2.2.3.cmml">𝑲</mi></msub><mo stretchy="false" id="S2.SS1.p1.11.m2.5.5.2.2.2.7" xref="S2.SS1.p1.11.m2.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p1.11.m2.6.6.4" xref="S2.SS1.p1.11.m2.6.6.4.cmml">=</mo><mrow id="S2.SS1.p1.11.m2.6.6.3" xref="S2.SS1.p1.11.m2.6.6.3.cmml"><mi id="S2.SS1.p1.11.m2.6.6.3.3" xref="S2.SS1.p1.11.m2.6.6.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.11.m2.6.6.3.2" xref="S2.SS1.p1.11.m2.6.6.3.2.cmml">​</mo><mrow id="S2.SS1.p1.11.m2.6.6.3.4.2" xref="S2.SS1.p1.11.m2.6.6.3.cmml"><mo stretchy="false" id="S2.SS1.p1.11.m2.6.6.3.4.2.1" xref="S2.SS1.p1.11.m2.6.6.3.cmml">(</mo><mi id="S2.SS1.p1.11.m2.3.3" xref="S2.SS1.p1.11.m2.3.3.cmml">𝜽</mi><mo stretchy="false" id="S2.SS1.p1.11.m2.6.6.3.4.2.2" xref="S2.SS1.p1.11.m2.6.6.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS1.p1.11.m2.6.6.3.2a" xref="S2.SS1.p1.11.m2.6.6.3.2.cmml">​</mo><mrow id="S2.SS1.p1.11.m2.6.6.3.1" xref="S2.SS1.p1.11.m2.6.6.3.1.cmml"><msubsup id="S2.SS1.p1.11.m2.6.6.3.1.2" xref="S2.SS1.p1.11.m2.6.6.3.1.2.cmml"><mo id="S2.SS1.p1.11.m2.6.6.3.1.2.2.2" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.2.cmml">∏</mo><mrow id="S2.SS1.p1.11.m2.6.6.3.1.2.2.3" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.cmml"><mi id="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.2" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.2.cmml">i</mi><mo id="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.1" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.1.cmml">=</mo><mn id="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.3" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.11.m2.6.6.3.1.2.3" xref="S2.SS1.p1.11.m2.6.6.3.1.2.3.cmml">K</mi></msubsup><mrow id="S2.SS1.p1.11.m2.6.6.3.1.1" xref="S2.SS1.p1.11.m2.6.6.3.1.1.cmml"><mi id="S2.SS1.p1.11.m2.6.6.3.1.1.3" xref="S2.SS1.p1.11.m2.6.6.3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.11.m2.6.6.3.1.1.2" xref="S2.SS1.p1.11.m2.6.6.3.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.2" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.2" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.3" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.3.cmml">𝒊</mi></msub><mo stretchy="false" id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.3" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m2.6b"><apply id="S2.SS1.p1.11.m2.6.6.cmml" xref="S2.SS1.p1.11.m2.6.6"><eq id="S2.SS1.p1.11.m2.6.6.4.cmml" xref="S2.SS1.p1.11.m2.6.6.4"></eq><apply id="S2.SS1.p1.11.m2.5.5.2.cmml" xref="S2.SS1.p1.11.m2.5.5.2"><times id="S2.SS1.p1.11.m2.5.5.2.3.cmml" xref="S2.SS1.p1.11.m2.5.5.2.3"></times><ci id="S2.SS1.p1.11.m2.5.5.2.4.cmml" xref="S2.SS1.p1.11.m2.5.5.2.4">𝑝</ci><vector id="S2.SS1.p1.11.m2.5.5.2.2.3.cmml" xref="S2.SS1.p1.11.m2.5.5.2.2.2"><ci id="S2.SS1.p1.11.m2.1.1.cmml" xref="S2.SS1.p1.11.m2.1.1">𝜽</ci><apply id="S2.SS1.p1.11.m2.4.4.1.1.1.1.cmml" xref="S2.SS1.p1.11.m2.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m2.4.4.1.1.1.1.1.cmml" xref="S2.SS1.p1.11.m2.4.4.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m2.4.4.1.1.1.1.2.cmml" xref="S2.SS1.p1.11.m2.4.4.1.1.1.1.2">bold-italic-ϕ</ci><cn type="integer" id="S2.SS1.p1.11.m2.4.4.1.1.1.1.3.cmml" xref="S2.SS1.p1.11.m2.4.4.1.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.11.m2.2.2.cmml" xref="S2.SS1.p1.11.m2.2.2">…</ci><apply id="S2.SS1.p1.11.m2.5.5.2.2.2.2.cmml" xref="S2.SS1.p1.11.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m2.5.5.2.2.2.2.1.cmml" xref="S2.SS1.p1.11.m2.5.5.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.11.m2.5.5.2.2.2.2.2.cmml" xref="S2.SS1.p1.11.m2.5.5.2.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.11.m2.5.5.2.2.2.2.3.cmml" xref="S2.SS1.p1.11.m2.5.5.2.2.2.2.3">𝑲</ci></apply></vector></apply><apply id="S2.SS1.p1.11.m2.6.6.3.cmml" xref="S2.SS1.p1.11.m2.6.6.3"><times id="S2.SS1.p1.11.m2.6.6.3.2.cmml" xref="S2.SS1.p1.11.m2.6.6.3.2"></times><ci id="S2.SS1.p1.11.m2.6.6.3.3.cmml" xref="S2.SS1.p1.11.m2.6.6.3.3">𝑝</ci><ci id="S2.SS1.p1.11.m2.3.3.cmml" xref="S2.SS1.p1.11.m2.3.3">𝜽</ci><apply id="S2.SS1.p1.11.m2.6.6.3.1.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1"><apply id="S2.SS1.p1.11.m2.6.6.3.1.2.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m2.6.6.3.1.2.1.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2">superscript</csymbol><apply id="S2.SS1.p1.11.m2.6.6.3.1.2.2.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m2.6.6.3.1.2.2.1.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS1.p1.11.m2.6.6.3.1.2.2.2.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.2">product</csymbol><apply id="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.3"><eq id="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.1.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.1"></eq><ci id="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.2.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.3.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.11.m2.6.6.3.1.2.3.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.2.3">𝐾</ci></apply><apply id="S2.SS1.p1.11.m2.6.6.3.1.1.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.1"><times id="S2.SS1.p1.11.m2.6.6.3.1.1.2.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.1.2"></times><ci id="S2.SS1.p1.11.m2.6.6.3.1.1.3.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.1.3">𝑝</ci><apply id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.11.m2.6.6.3.1.1.1.1.1.3">𝒊</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m2.6c">p(\bm{\theta},\bm{\phi_{1}},\dots,\bm{\phi_{K}})=p(\bm{\theta})\prod_{i=1}^{K}p(\bm{\phi_{i}})</annotation></semantics></math>
. The Bayesian network is illustrated in <a href="#S2.F1.sf1" title="In Figure 1 ‣ II-A The Bayesian network ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1a</span></a>.</p>
</div>
<figure id="S2.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F1.sf1" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S2.F1.sf1.1" class="ltx_inline-block ltx_transformed_outer" style="width:103.8pt;height:99.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-4.1pt,3.9pt) scale(0.927271391715739,0.927271391715739) ;"><svg id="S2.F1.sf1.1.pic1" class="ltx_picture" height="148.6" overflow="visible" version="1.1" width="141.03"><g transform="translate(0,148.6) matrix(1 0 0 -1 0 0) translate(62.03,0) translate(0,56.56)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g stroke="#000000" fill="#DFDFDF"><path d="M 13.84 0 C 13.84 7.64 7.64 13.84 0 13.84 C -7.64 13.84 -13.84 7.64 -13.84 0 C -13.84 -7.64 -7.64 -13.84 0 -13.84 C 7.64 -13.84 13.84 -7.64 13.84 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -5.29 -3.15)" fill="#000000" stroke="#000000"><foreignObject width="10.58" height="11.42" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{x}_{i}^{(n)}" display="inline"><semantics id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msubsup id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mi id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml">𝒙</mi><mi id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.1" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">(</mo><mi id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">superscript</csymbol><apply id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.cmml" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">subscript</csymbol><ci id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2">𝒙</ci><ci id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" xref="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{x}_{i}^{(n)}</annotation></semantics></math></foreignObject></g><g stroke="#000000" fill="#DFDFDF"><path d="M 13.84 67.6 C 13.84 75.24 7.64 81.43 0 81.43 C -7.64 81.43 -13.84 75.24 -13.84 67.6 C -13.84 59.96 -7.64 53.76 0 53.76 C 7.64 53.76 13.84 59.96 13.84 67.6 Z M 0 67.6"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -4.97 64.51)" fill="#000000" stroke="#000000"><foreignObject width="9.95" height="11.55" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="y_{i}^{(n)}" display="inline"><semantics id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msubsup id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mi id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml">y</mi><mi id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.1" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">(</mo><mi id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">superscript</csymbol><apply id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.cmml" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">subscript</csymbol><ci id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2">𝑦</ci><ci id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" xref="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">y_{i}^{(n)}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M -34.08 0 C -34.08 7.64 -40.27 13.84 -47.91 13.84 C -55.55 13.84 -61.75 7.64 -61.75 0 C -61.75 -7.64 -55.55 -13.84 -47.91 -13.84 C -40.27 -13.84 -34.08 -7.64 -34.08 0 Z M -47.91 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -51.16 -4.8)" fill="#000000" stroke="#000000"><foreignObject width="6.5" height="9.61" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S2.F1.sf1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S2.F1.sf1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.sf1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\theta}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M 73.56 0 C 73.56 7.64 67.37 13.84 59.72 13.84 C 52.08 13.84 45.89 7.64 45.89 0 C 45.89 -7.64 52.08 -13.84 59.72 -13.84 C 67.37 -13.84 73.56 -7.64 73.56 0 Z M 59.72 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 54.27 -3.46)" fill="#000000" stroke="#000000"><foreignObject width="10.91" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\phi_{i}}" display="inline"><semantics id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">ϕ</mi><mi id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\phi_{i}}</annotation></semantics></math></foreignObject></g><path d="M 0 14.11 L 0 52.36" style="fill:none"></path><g transform="matrix(0.0 1.0 -1.0 0.0 0 52.36)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><path d="M -39.75 11.51 L -8.81 55.17" style="fill:none"></path><g transform="matrix(0.57828 0.81586 -0.81586 0.57828 -8.81 55.17)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><path d="M 50.38 10.58 L 10.09 56.18" style="fill:none"></path><g transform="matrix(-0.66211 0.7494 -0.7494 -0.66211 10.09 56.18)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 1.88 -29.15)" fill="#000000" stroke="#000000"><foreignObject width="12.24" height="9.61" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">N</mi><mi mathsize="80%" id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑁</ci><ci id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1c">N_{i}</annotation></semantics></math></foreignObject></g><path d="M 13.47 86.6 L -13.47 86.6 C -16.52 86.6 -19 84.12 -19 81.07 L -19 -30.55 C -19 -33.6 -16.52 -36.08 -13.47 -36.08 L 13.47 -36.08 C 16.52 -36.08 19 -33.6 19 -30.55 L 19 81.07 C 19 84.12 16.52 86.6 13.47 86.6 Z M -19 -36.08" style="fill:none"></path><g transform="matrix(1.0 0.0 0.0 1.0 63.64 -51.4)" fill="#000000" stroke="#000000"><foreignObject width="10.19" height="7.56" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.F1.sf1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1a"><mi mathsize="80%" id="S2.F1.sf1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.sf1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1c">K</annotation></semantics></math></foreignObject></g><path d="M 73.19 91.77 L -18.63 91.77 C -21.69 91.77 -24.17 89.29 -24.17 86.23 L -24.17 -50.75 C -24.17 -53.81 -21.69 -56.28 -18.63 -56.28 L 73.19 -56.28 C 76.25 -56.28 78.73 -53.81 78.73 -50.75 L 78.73 86.23 C 78.73 89.29 76.25 91.77 73.19 91.77 Z M -24.17 -56.28" style="fill:none"></path></g></svg>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>Bayesian network</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F1.sf2" class="ltx_figure ltx_figure_panel ltx_align_center">
<div id="S2.F1.sf2.1" class="ltx_inline-block ltx_transformed_outer" style="width:109.9pt;height:99.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-4.3pt,3.9pt) scale(0.927271391715739,0.927271391715739) ;"><svg id="S2.F1.sf2.1.pic1" class="ltx_picture" height="148.6" overflow="visible" version="1.1" width="150.14"><g transform="translate(0,148.6) matrix(1 0 0 -1 0 0) translate(66.58,0) translate(0,56.56)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g stroke="#000000" fill="#DFDFDF"><path d="M 13.84 0 C 13.84 7.64 7.64 13.84 0 13.84 C -7.64 13.84 -13.84 7.64 -13.84 0 C -13.84 -7.64 -7.64 -13.84 0 -13.84 C 7.64 -13.84 13.84 -7.64 13.84 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -5.29 -3.15)" fill="#000000" stroke="#000000"><foreignObject width="10.58" height="11.42" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{x}_{i}^{(n)}" display="inline"><semantics id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msubsup id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mi id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml">𝒙</mi><mi id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.1" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">(</mo><mi id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">superscript</csymbol><apply id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.cmml" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">subscript</csymbol><ci id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2">𝒙</ci><ci id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" xref="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{x}_{i}^{(n)}</annotation></semantics></math></foreignObject></g><g stroke="#000000" fill="#DFDFDF"><path d="M 13.84 67.6 C 13.84 75.24 7.64 81.43 0 81.43 C -7.64 81.43 -13.84 75.24 -13.84 67.6 C -13.84 59.96 -7.64 53.76 0 53.76 C 7.64 53.76 13.84 59.96 13.84 67.6 Z M 0 67.6"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -4.97 64.51)" fill="#000000" stroke="#000000"><foreignObject width="9.95" height="11.55" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="y_{i}^{(n)}" display="inline"><semantics id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msubsup id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mi id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml">y</mi><mi id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml">i</mi><mrow id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.1" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">(</mo><mi id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.3.2" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">superscript</csymbol><apply id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.1.cmml" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">subscript</csymbol><ci id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2.cmml" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.2">𝑦</ci><ci id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3.cmml" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.3">𝑖</ci></apply><ci id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" xref="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">y_{i}^{(n)}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M -34.08 0 C -34.08 7.64 -40.27 13.84 -47.91 13.84 C -55.55 13.84 -61.75 7.64 -61.75 0 C -61.75 -7.64 -55.55 -13.84 -47.91 -13.84 C -40.27 -13.84 -34.08 -7.64 -34.08 0 Z M -47.91 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -51.16 -4.8)" fill="#000000" stroke="#000000"><foreignObject width="6.5" height="9.61" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S2.F1.sf2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S2.F1.sf2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.sf2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\theta}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M 73.56 0 C 73.56 7.64 67.37 13.84 59.72 13.84 C 52.08 13.84 45.89 7.64 45.89 0 C 45.89 -7.64 52.08 -13.84 59.72 -13.84 C 67.37 -13.84 73.56 -7.64 73.56 0 Z M 59.72 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 54.27 -3.46)" fill="#000000" stroke="#000000"><foreignObject width="10.91" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\phi_{i}}" display="inline"><semantics id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">ϕ</mi><mi id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">𝒊</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝒊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\phi_{i}}</annotation></semantics></math></foreignObject></g><g transform="matrix(1.0 0.0 0.0 1.0 -61.97 61.06)" fill="#000000" stroke="#000000"><foreignObject width="16.58" height="10.32" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\mu}^{s}" display="inline"><semantics id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1a"><msup id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">𝝁</mi><mi id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝝁</ci><ci id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\mu}^{s}</annotation></semantics></math><span id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1" class="ltx_text"> <math id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\bm{\sigma}^{s}" display="inline"><semantics id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1a"><msup id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1" xref="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.cmml"><mi id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.2" xref="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.cmml">𝝈</mi><mi id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.3" xref="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1b"><apply id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.cmml" xref="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.1.cmml" xref="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1">superscript</csymbol><ci id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.cmml" xref="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.2">𝝈</ci><ci id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.3.cmml" xref="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.6.6.6.6.6.6.6.6.6.6.6.6.2.2.2.2.2.2.2.2.2.1.m1.1c">\bm{\sigma}^{s}</annotation></semantics></math></span></foreignObject></g><g transform="matrix(1.0 0.0 0.0 1.0 45.94 61.06)" fill="#000000" stroke="#000000"><foreignObject width="16.3" height="10.32" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\mu}^{c}_{i}" display="inline"><semantics id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1a"><msubsup id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.2" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml">𝝁</mi><mi id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">i</mi><mi id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.3" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><apply id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.2">𝝁</ci><ci id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.2.3">𝑐</ci></apply><ci id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\mu}^{c}_{i}</annotation></semantics></math><span id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1" class="ltx_text"> <math id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\bm{\sigma}^{c}_{i}" display="inline"><semantics id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1a"><msubsup id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.cmml"><mi id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.2" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.2.cmml">𝝈</mi><mi id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.3" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.3.cmml">i</mi><mi id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.3" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.3.cmml">c</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1b"><apply id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.cmml" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.1.cmml" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1">subscript</csymbol><apply id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.cmml" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.1.cmml" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1">superscript</csymbol><ci id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.2.cmml" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.2">𝝈</ci><ci id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.3.cmml" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.2.3">𝑐</ci></apply><ci id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.3.cmml" xref="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.8.8.8.8.8.8.8.8.8.8.8.8.2.2.2.2.2.2.2.2.2.1.m1.1c">\bm{\sigma}^{c}_{i}</annotation></semantics></math></span></foreignObject></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M -14.11 0 L -32.68 0" style="fill:none"></path></g><g transform="matrix(-1.0 0.0 0.0 -1.0 -32.68 0)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M -8.16 56.08 L -39.1 12.43" style="fill:none"></path></g><g transform="matrix(-0.57828 -0.81586 0.81586 -0.57828 -39.1 12.43)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 14.11 0 L 44.49 0" style="fill:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 44.49 0)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt"><path d="M 9.34 57.02 L 49.63 11.42" style="fill:none"></path></g><g transform="matrix(0.66211 -0.7494 0.7494 0.66211 49.63 11.42)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><g stroke-dasharray="0.4pt,2.0pt" stroke-dashoffset="0.0pt"><path d="M 59.72 53.48 L 59.72 15.24" style="fill:none"></path></g><g transform="matrix(0.0 -1.0 1.0 0.0 59.72 15.24)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><g stroke-dasharray="0.4pt,2.0pt" stroke-dashoffset="0.0pt"><path d="M -47.91 53.48 L -47.91 15.24" style="fill:none"></path></g><g transform="matrix(0.0 -1.0 1.0 0.0 -47.91 15.24)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 1.88 -29.15)" fill="#000000" stroke="#000000"><foreignObject width="12.24" height="9.61" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">N</mi><mi mathsize="80%" id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑁</ci><ci id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1c">N_{i}</annotation></semantics></math></foreignObject></g><path d="M 13.47 86.6 L -13.47 86.6 C -16.52 86.6 -19 84.12 -19 81.07 L -19 -30.55 C -19 -33.6 -16.52 -36.08 -13.47 -36.08 L 13.47 -36.08 C 16.52 -36.08 19 -33.6 19 -30.55 L 19 81.07 C 19 84.12 16.52 86.6 13.47 86.6 Z M -19 -36.08" style="fill:none"></path><g transform="matrix(1.0 0.0 0.0 1.0 68.2 -51.4)" fill="#000000" stroke="#000000"><foreignObject width="10.19" height="7.56" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S2.F1.sf2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.F1.sf2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1a"><mi mathsize="80%" id="S2.F1.sf2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.sf2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.1.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1c">K</annotation></semantics></math></foreignObject></g><path d="M 77.75 91.77 L -18.63 91.77 C -21.69 91.77 -24.17 89.29 -24.17 86.23 L -24.17 -50.75 C -24.17 -53.81 -21.69 -56.28 -18.63 -56.28 L 77.75 -56.28 C 80.8 -56.28 83.28 -53.81 83.28 -50.75 L 83.28 86.23 C 83.28 89.29 80.8 91.77 77.75 91.77 Z M -24.17 -56.28" style="fill:none"></path></g></svg>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Variational posterior model</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Graphical models that describe the <span id="S2.F1.22.1" class="ltx_text ltx_font_typewriter">VIRTUAL</span> framework for federated learning. The plates represent replicates. In both figures, the outer plate replicates client <math id="S2.F1.11.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.F1.11.m1.1b"><mi id="S2.F1.11.m1.1.1" xref="S2.F1.11.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.F1.11.m1.1c"><ci id="S2.F1.11.m1.1.1.cmml" xref="S2.F1.11.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.11.m1.1d">i</annotation></semantics></math> over the total number of clients <math id="S2.F1.12.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.F1.12.m2.1b"><mi id="S2.F1.12.m2.1.1" xref="S2.F1.12.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.F1.12.m2.1c"><ci id="S2.F1.12.m2.1.1.cmml" xref="S2.F1.12.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.12.m2.1d">K</annotation></semantics></math>, while the inner plate replicates sample index <math id="S2.F1.13.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S2.F1.13.m3.1b"><mi id="S2.F1.13.m3.1.1" xref="S2.F1.13.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.F1.13.m3.1c"><ci id="S2.F1.13.m3.1.1.cmml" xref="S2.F1.13.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.13.m3.1d">n</annotation></semantics></math> over the total number of samples per client <math id="S2.F1.14.m4.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="S2.F1.14.m4.1b"><msub id="S2.F1.14.m4.1.1" xref="S2.F1.14.m4.1.1.cmml"><mi id="S2.F1.14.m4.1.1.2" xref="S2.F1.14.m4.1.1.2.cmml">N</mi><mi id="S2.F1.14.m4.1.1.3" xref="S2.F1.14.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.F1.14.m4.1c"><apply id="S2.F1.14.m4.1.1.cmml" xref="S2.F1.14.m4.1.1"><csymbol cd="ambiguous" id="S2.F1.14.m4.1.1.1.cmml" xref="S2.F1.14.m4.1.1">subscript</csymbol><ci id="S2.F1.14.m4.1.1.2.cmml" xref="S2.F1.14.m4.1.1.2">𝑁</ci><ci id="S2.F1.14.m4.1.1.3.cmml" xref="S2.F1.14.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.14.m4.1d">N_{i}</annotation></semantics></math>. Shadowed nodes represent observed variables and non-shadowed nodes represent latent variables.
(a) Solid lines denote the discriminative model <math id="S2.F1.15.m5.4" class="ltx_Math" alttext="p(y_{i}^{(n)}|\bm{x}_{i}^{(n)},\bm{\theta},\bm{\phi}_{i})" display="inline"><semantics id="S2.F1.15.m5.4b"><mrow id="S2.F1.15.m5.4.4" xref="S2.F1.15.m5.4.4.cmml"><mi id="S2.F1.15.m5.4.4.3" xref="S2.F1.15.m5.4.4.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.F1.15.m5.4.4.2" xref="S2.F1.15.m5.4.4.2.cmml">​</mo><mrow id="S2.F1.15.m5.4.4.1.1" xref="S2.F1.15.m5.4.4.1.1.1.cmml"><mo stretchy="false" id="S2.F1.15.m5.4.4.1.1.2" xref="S2.F1.15.m5.4.4.1.1.1.cmml">(</mo><mrow id="S2.F1.15.m5.4.4.1.1.1" xref="S2.F1.15.m5.4.4.1.1.1.cmml"><msubsup id="S2.F1.15.m5.4.4.1.1.1.4" xref="S2.F1.15.m5.4.4.1.1.1.4.cmml"><mi id="S2.F1.15.m5.4.4.1.1.1.4.2.2" xref="S2.F1.15.m5.4.4.1.1.1.4.2.2.cmml">y</mi><mi id="S2.F1.15.m5.4.4.1.1.1.4.2.3" xref="S2.F1.15.m5.4.4.1.1.1.4.2.3.cmml">i</mi><mrow id="S2.F1.15.m5.1.1.1.3" xref="S2.F1.15.m5.4.4.1.1.1.4.cmml"><mo stretchy="false" id="S2.F1.15.m5.1.1.1.3.1" xref="S2.F1.15.m5.4.4.1.1.1.4.cmml">(</mo><mi id="S2.F1.15.m5.1.1.1.1" xref="S2.F1.15.m5.1.1.1.1.cmml">n</mi><mo stretchy="false" id="S2.F1.15.m5.1.1.1.3.2" xref="S2.F1.15.m5.4.4.1.1.1.4.cmml">)</mo></mrow></msubsup><mo fence="false" id="S2.F1.15.m5.4.4.1.1.1.3" xref="S2.F1.15.m5.4.4.1.1.1.3.cmml">|</mo><mrow id="S2.F1.15.m5.4.4.1.1.1.2.2" xref="S2.F1.15.m5.4.4.1.1.1.2.3.cmml"><msubsup id="S2.F1.15.m5.4.4.1.1.1.1.1.1" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1.cmml"><mi id="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.2" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi id="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.3" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S2.F1.15.m5.2.2.1.3" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.F1.15.m5.2.2.1.3.1" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S2.F1.15.m5.2.2.1.1" xref="S2.F1.15.m5.2.2.1.1.cmml">n</mi><mo stretchy="false" id="S2.F1.15.m5.2.2.1.3.2" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.F1.15.m5.4.4.1.1.1.2.2.3" xref="S2.F1.15.m5.4.4.1.1.1.2.3.cmml">,</mo><mi id="S2.F1.15.m5.3.3" xref="S2.F1.15.m5.3.3.cmml">𝜽</mi><mo id="S2.F1.15.m5.4.4.1.1.1.2.2.4" xref="S2.F1.15.m5.4.4.1.1.1.2.3.cmml">,</mo><msub id="S2.F1.15.m5.4.4.1.1.1.2.2.2" xref="S2.F1.15.m5.4.4.1.1.1.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.F1.15.m5.4.4.1.1.1.2.2.2.2" xref="S2.F1.15.m5.4.4.1.1.1.2.2.2.2.cmml">ϕ</mi><mi id="S2.F1.15.m5.4.4.1.1.1.2.2.2.3" xref="S2.F1.15.m5.4.4.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S2.F1.15.m5.4.4.1.1.3" xref="S2.F1.15.m5.4.4.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F1.15.m5.4c"><apply id="S2.F1.15.m5.4.4.cmml" xref="S2.F1.15.m5.4.4"><times id="S2.F1.15.m5.4.4.2.cmml" xref="S2.F1.15.m5.4.4.2"></times><ci id="S2.F1.15.m5.4.4.3.cmml" xref="S2.F1.15.m5.4.4.3">𝑝</ci><apply id="S2.F1.15.m5.4.4.1.1.1.cmml" xref="S2.F1.15.m5.4.4.1.1"><csymbol cd="latexml" id="S2.F1.15.m5.4.4.1.1.1.3.cmml" xref="S2.F1.15.m5.4.4.1.1.1.3">conditional</csymbol><apply id="S2.F1.15.m5.4.4.1.1.1.4.cmml" xref="S2.F1.15.m5.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S2.F1.15.m5.4.4.1.1.1.4.1.cmml" xref="S2.F1.15.m5.4.4.1.1.1.4">superscript</csymbol><apply id="S2.F1.15.m5.4.4.1.1.1.4.2.cmml" xref="S2.F1.15.m5.4.4.1.1.1.4"><csymbol cd="ambiguous" id="S2.F1.15.m5.4.4.1.1.1.4.2.1.cmml" xref="S2.F1.15.m5.4.4.1.1.1.4">subscript</csymbol><ci id="S2.F1.15.m5.4.4.1.1.1.4.2.2.cmml" xref="S2.F1.15.m5.4.4.1.1.1.4.2.2">𝑦</ci><ci id="S2.F1.15.m5.4.4.1.1.1.4.2.3.cmml" xref="S2.F1.15.m5.4.4.1.1.1.4.2.3">𝑖</ci></apply><ci id="S2.F1.15.m5.1.1.1.1.cmml" xref="S2.F1.15.m5.1.1.1.1">𝑛</ci></apply><list id="S2.F1.15.m5.4.4.1.1.1.2.3.cmml" xref="S2.F1.15.m5.4.4.1.1.1.2.2"><apply id="S2.F1.15.m5.4.4.1.1.1.1.1.1.cmml" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.F1.15.m5.4.4.1.1.1.1.1.1.1.cmml" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.cmml" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.2.cmml" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.3.cmml" xref="S2.F1.15.m5.4.4.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.F1.15.m5.2.2.1.1.cmml" xref="S2.F1.15.m5.2.2.1.1">𝑛</ci></apply><ci id="S2.F1.15.m5.3.3.cmml" xref="S2.F1.15.m5.3.3">𝜽</ci><apply id="S2.F1.15.m5.4.4.1.1.1.2.2.2.cmml" xref="S2.F1.15.m5.4.4.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.F1.15.m5.4.4.1.1.1.2.2.2.1.cmml" xref="S2.F1.15.m5.4.4.1.1.1.2.2.2">subscript</csymbol><ci id="S2.F1.15.m5.4.4.1.1.1.2.2.2.2.cmml" xref="S2.F1.15.m5.4.4.1.1.1.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.F1.15.m5.4.4.1.1.1.2.2.2.3.cmml" xref="S2.F1.15.m5.4.4.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.15.m5.4d">p(y_{i}^{(n)}|\bm{x}_{i}^{(n)},\bm{\theta},\bm{\phi}_{i})</annotation></semantics></math>. (b) Graphical model of the approximated variational posterior. Dashed lines denote (deterministic) dependencies in the approximated variational posterior while dotted lines denote stochastic dependencies. Here we indicate as <math id="S2.F1.16.m6.1" class="ltx_math_unparsed" alttext="(\bm{\mu}^{s}" display="inline"><semantics id="S2.F1.16.m6.1b"><mrow id="S2.F1.16.m6.1c"><mo stretchy="false" id="S2.F1.16.m6.1.1">(</mo><msup id="S2.F1.16.m6.1.2"><mi id="S2.F1.16.m6.1.2.2">𝝁</mi><mi id="S2.F1.16.m6.1.2.3">s</mi></msup></mrow><annotation encoding="application/x-tex" id="S2.F1.16.m6.1d">(\bm{\mu}^{s}</annotation></semantics></math>,<math id="S2.F1.17.m7.1" class="ltx_math_unparsed" alttext="\bm{\sigma}^{s})" display="inline"><semantics id="S2.F1.17.m7.1b"><mrow id="S2.F1.17.m7.1c"><msup id="S2.F1.17.m7.1.1"><mi id="S2.F1.17.m7.1.1.2">𝝈</mi><mi id="S2.F1.17.m7.1.1.3">s</mi></msup><mo stretchy="false" id="S2.F1.17.m7.1.2">)</mo></mrow><annotation encoding="application/x-tex" id="S2.F1.17.m7.1d">\bm{\sigma}^{s})</annotation></semantics></math> and <math id="S2.F1.18.m8.1" class="ltx_math_unparsed" alttext="(\bm{\mu}^{c}_{i}" display="inline"><semantics id="S2.F1.18.m8.1b"><mrow id="S2.F1.18.m8.1c"><mo stretchy="false" id="S2.F1.18.m8.1.1">(</mo><msubsup id="S2.F1.18.m8.1.2"><mi id="S2.F1.18.m8.1.2.2.2">𝝁</mi><mi id="S2.F1.18.m8.1.2.3">i</mi><mi id="S2.F1.18.m8.1.2.2.3">c</mi></msubsup></mrow><annotation encoding="application/x-tex" id="S2.F1.18.m8.1d">(\bm{\mu}^{c}_{i}</annotation></semantics></math>,<math id="S2.F1.19.m9.1" class="ltx_math_unparsed" alttext="\bm{\sigma}^{c}_{i})" display="inline"><semantics id="S2.F1.19.m9.1b"><mrow id="S2.F1.19.m9.1c"><msubsup id="S2.F1.19.m9.1.1"><mi id="S2.F1.19.m9.1.1.2.2">𝝈</mi><mi id="S2.F1.19.m9.1.1.3">i</mi><mi id="S2.F1.19.m9.1.1.2.3">c</mi></msubsup><mo stretchy="false" id="S2.F1.19.m9.1.2">)</mo></mrow><annotation encoding="application/x-tex" id="S2.F1.19.m9.1d">\bm{\sigma}^{c}_{i})</annotation></semantics></math> the collection of all Gaussian parameters of server and client <math id="S2.F1.20.m10.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.F1.20.m10.1b"><mi id="S2.F1.20.m10.1.1" xref="S2.F1.20.m10.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.F1.20.m10.1c"><ci id="S2.F1.20.m10.1.1.cmml" xref="S2.F1.20.m10.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.20.m10.1d">i</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">The optimization procedure</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.2" class="ltx_p">The posterior given in <a href="#S2.E1" title="In II-A The Bayesian network ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">1</span></a> is in general intractable and hence we have to rely on an approximation inference scheme (e.g. variational inference, sampling, expectation propagation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>). Here we propose an expectation propagation (<span id="S2.SS2.p1.2.1" class="ltx_text ltx_font_typewriter">EP</span>) like approximation algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> that has been shown to be effective and to outperform other methods when applied in the continual learning (CL) setting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>. Let us denote the collection of all client parameters by <math id="S2.SS2.p1.1.m1.3" class="ltx_Math" alttext="\bm{\phi}=(\bm{\phi}_{1},\dots,\bm{\phi}_{K})" display="inline"><semantics id="S2.SS2.p1.1.m1.3a"><mrow id="S2.SS2.p1.1.m1.3.3" xref="S2.SS2.p1.1.m1.3.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS2.p1.1.m1.3.3.4" xref="S2.SS2.p1.1.m1.3.3.4.cmml">ϕ</mi><mo id="S2.SS2.p1.1.m1.3.3.3" xref="S2.SS2.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.1.m1.3.3.2.2" xref="S2.SS2.p1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS2.p1.1.m1.3.3.2.2.3" xref="S2.SS2.p1.1.m1.3.3.2.3.cmml">(</mo><msub id="S2.SS2.p1.1.m1.2.2.1.1.1" xref="S2.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS2.p1.1.m1.2.2.1.1.1.2" xref="S2.SS2.p1.1.m1.2.2.1.1.1.2.cmml">ϕ</mi><mn id="S2.SS2.p1.1.m1.2.2.1.1.1.3" xref="S2.SS2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.1.m1.3.3.2.2.4" xref="S2.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S2.SS2.p1.1.m1.3.3.2.2.5" xref="S2.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.1.m1.3.3.2.2.2" xref="S2.SS2.p1.1.m1.3.3.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS2.p1.1.m1.3.3.2.2.2.2" xref="S2.SS2.p1.1.m1.3.3.2.2.2.2.cmml">ϕ</mi><mi id="S2.SS2.p1.1.m1.3.3.2.2.2.3" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S2.SS2.p1.1.m1.3.3.2.2.6" xref="S2.SS2.p1.1.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.3b"><apply id="S2.SS2.p1.1.m1.3.3.cmml" xref="S2.SS2.p1.1.m1.3.3"><eq id="S2.SS2.p1.1.m1.3.3.3.cmml" xref="S2.SS2.p1.1.m1.3.3.3"></eq><ci id="S2.SS2.p1.1.m1.3.3.4.cmml" xref="S2.SS2.p1.1.m1.3.3.4">bold-italic-ϕ</ci><vector id="S2.SS2.p1.1.m1.3.3.2.3.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2"><apply id="S2.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1.2">bold-italic-ϕ</ci><cn type="integer" id="S2.SS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">…</ci><apply id="S2.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.SS2.p1.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.3.3.2.2.2.3">𝐾</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.3c">\bm{\phi}=(\bm{\phi}_{1},\dots,\bm{\phi}_{K})</annotation></semantics></math>. Then we define a <em id="S2.SS2.p1.2.2" class="ltx_emph ltx_font_italic">proxy</em> posterior distribution that factorizes into a server and a client contribution for every client <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><mi id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">i</annotation></semantics></math> as</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.4" class="ltx_Math" alttext="q(\bm{\theta},\bm{\phi})=\left(\prod_{i=1}^{K}s_{i}(\bm{\theta})\right)\left(\prod_{i=1}^{K}c_{i}(\bm{\phi}_{i})\right)." display="block"><semantics id="S2.E2.m1.4a"><mrow id="S2.E2.m1.4.4.1" xref="S2.E2.m1.4.4.1.1.cmml"><mrow id="S2.E2.m1.4.4.1.1" xref="S2.E2.m1.4.4.1.1.cmml"><mrow id="S2.E2.m1.4.4.1.1.4" xref="S2.E2.m1.4.4.1.1.4.cmml"><mi id="S2.E2.m1.4.4.1.1.4.2" xref="S2.E2.m1.4.4.1.1.4.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.1.1.4.1" xref="S2.E2.m1.4.4.1.1.4.1.cmml">​</mo><mrow id="S2.E2.m1.4.4.1.1.4.3.2" xref="S2.E2.m1.4.4.1.1.4.3.1.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.1.1.4.3.2.1" xref="S2.E2.m1.4.4.1.1.4.3.1.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">𝜽</mi><mo id="S2.E2.m1.4.4.1.1.4.3.2.2" xref="S2.E2.m1.4.4.1.1.4.3.1.cmml">,</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">ϕ</mi><mo stretchy="false" id="S2.E2.m1.4.4.1.1.4.3.2.3" xref="S2.E2.m1.4.4.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.3" xref="S2.E2.m1.4.4.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.4.4.1.1.2" xref="S2.E2.m1.4.4.1.1.2.cmml"><mrow id="S2.E2.m1.4.4.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.4.4.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.cmml"><munderover id="S2.E2.m1.4.4.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">∏</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml">K</mi></munderover><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.cmml"><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">s</mi><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.1.1.1.1.1.1.2.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.1.cmml">​</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.1.1.1.2.3.2.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">𝜽</mi><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.1.1.1.2.3.2.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.1.1.2.3" xref="S2.E2.m1.4.4.1.1.2.3.cmml">​</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.cmml"><mo id="S2.E2.m1.4.4.1.1.2.2.1.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.cmml">(</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.1.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.cmml"><munderover id="S2.E2.m1.4.4.1.1.2.2.1.1.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.cmml"><mo lspace="0em" movablelimits="false" id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.2.cmml">∏</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.4.4.1.1.2.2.1.1.2.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.3.cmml">K</mi></munderover><mrow id="S2.E2.m1.4.4.1.1.2.2.1.1.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.cmml"><msub id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.cmml"><mi id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.2.cmml">c</mi><mi id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.4.4.1.1.2.2.1.3" xref="S2.E2.m1.4.4.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E2.m1.4.4.1.2" xref="S2.E2.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.4b"><apply id="S2.E2.m1.4.4.1.1.cmml" xref="S2.E2.m1.4.4.1"><eq id="S2.E2.m1.4.4.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.3"></eq><apply id="S2.E2.m1.4.4.1.1.4.cmml" xref="S2.E2.m1.4.4.1.1.4"><times id="S2.E2.m1.4.4.1.1.4.1.cmml" xref="S2.E2.m1.4.4.1.1.4.1"></times><ci id="S2.E2.m1.4.4.1.1.4.2.cmml" xref="S2.E2.m1.4.4.1.1.4.2">𝑞</ci><interval closure="open" id="S2.E2.m1.4.4.1.1.4.3.1.cmml" xref="S2.E2.m1.4.4.1.1.4.3.2"><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝜽</ci><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">bold-italic-ϕ</ci></interval></apply><apply id="S2.E2.m1.4.4.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2"><times id="S2.E2.m1.4.4.1.1.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.3"></times><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1"><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><csymbol cd="latexml" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.2">product</csymbol><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3"><eq id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.3">𝐾</ci></apply><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2"><times id="S2.E2.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.1"></times><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.2">𝑠</ci><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝜽</ci></apply></apply><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1"><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.1.1.2.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2">superscript</csymbol><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.2">product</csymbol><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3"><eq id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.2.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.2.3">𝐾</ci></apply><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1"><times id="S2.E2.m1.4.4.1.1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.2"></times><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.2">𝑐</ci><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.4c">q(\bm{\theta},\bm{\phi})=\left(\prod_{i=1}^{K}s_{i}(\bm{\theta})\right)\left(\prod_{i=1}^{K}c_{i}(\bm{\phi}_{i})\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p1.3" class="ltx_p">The fully factorization of both server and client parameters allows us to perform a client update that is independent from other clients, and to perform a server update in the form of an aggregated posterior that preserves privacy.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Given a factorization of this kind, the general <span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_typewriter">EP</span> algorithm refines one factor at each step. It first computes a refined posterior distribution where the refining factor of the proxy is replaced with the respective factor in the true posterior distribution. It then performs the update minimizing the Kullback-Leibler (KL) divergence between the full proxy posterior distribution and the refined posterior. The optimization to be performed for our particular Bayesian network and factorization is given by the following.</p>
</div>
<div id="Thmproposition1" class="ltx_theorem ltx_theorem_proposition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmproposition1.1.1.1" class="ltx_text ltx_font_bold">Proposition 1</span></span><span id="Thmproposition1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmproposition1.p1" class="ltx_para">
<p id="Thmproposition1.p1.5" class="ltx_p"><span id="Thmproposition1.p1.5.5" class="ltx_text ltx_font_italic">Assuming that at step <math id="Thmproposition1.p1.1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="Thmproposition1.p1.1.1.m1.1a"><mi id="Thmproposition1.p1.1.1.m1.1.1" xref="Thmproposition1.p1.1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.1.1.m1.1b"><ci id="Thmproposition1.p1.1.1.m1.1.1.cmml" xref="Thmproposition1.p1.1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.1.1.m1.1c">t</annotation></semantics></math> the factor <math id="Thmproposition1.p1.2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="Thmproposition1.p1.2.2.m2.1a"><mi id="Thmproposition1.p1.2.2.m2.1.1" xref="Thmproposition1.p1.2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.2.2.m2.1b"><ci id="Thmproposition1.p1.2.2.m2.1.1.cmml" xref="Thmproposition1.p1.2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.2.2.m2.1c">i</annotation></semantics></math> is refined, then the proxy pdf <math id="Thmproposition1.p1.3.3.m3.2" class="ltx_Math" alttext="s_{i}^{(t)}(\bm{\theta})" display="inline"><semantics id="Thmproposition1.p1.3.3.m3.2a"><mrow id="Thmproposition1.p1.3.3.m3.2.3" xref="Thmproposition1.p1.3.3.m3.2.3.cmml"><msubsup id="Thmproposition1.p1.3.3.m3.2.3.2" xref="Thmproposition1.p1.3.3.m3.2.3.2.cmml"><mi id="Thmproposition1.p1.3.3.m3.2.3.2.2.2" xref="Thmproposition1.p1.3.3.m3.2.3.2.2.2.cmml">s</mi><mi id="Thmproposition1.p1.3.3.m3.2.3.2.2.3" xref="Thmproposition1.p1.3.3.m3.2.3.2.2.3.cmml">i</mi><mrow id="Thmproposition1.p1.3.3.m3.1.1.1.3" xref="Thmproposition1.p1.3.3.m3.2.3.2.cmml"><mo stretchy="false" id="Thmproposition1.p1.3.3.m3.1.1.1.3.1" xref="Thmproposition1.p1.3.3.m3.2.3.2.cmml">(</mo><mi id="Thmproposition1.p1.3.3.m3.1.1.1.1" xref="Thmproposition1.p1.3.3.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="Thmproposition1.p1.3.3.m3.1.1.1.3.2" xref="Thmproposition1.p1.3.3.m3.2.3.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.3.3.m3.2.3.1" xref="Thmproposition1.p1.3.3.m3.2.3.1.cmml">​</mo><mrow id="Thmproposition1.p1.3.3.m3.2.3.3.2" xref="Thmproposition1.p1.3.3.m3.2.3.cmml"><mo stretchy="false" id="Thmproposition1.p1.3.3.m3.2.3.3.2.1" xref="Thmproposition1.p1.3.3.m3.2.3.cmml">(</mo><mi id="Thmproposition1.p1.3.3.m3.2.2" xref="Thmproposition1.p1.3.3.m3.2.2.cmml">𝛉</mi><mo stretchy="false" id="Thmproposition1.p1.3.3.m3.2.3.3.2.2" xref="Thmproposition1.p1.3.3.m3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.3.3.m3.2b"><apply id="Thmproposition1.p1.3.3.m3.2.3.cmml" xref="Thmproposition1.p1.3.3.m3.2.3"><times id="Thmproposition1.p1.3.3.m3.2.3.1.cmml" xref="Thmproposition1.p1.3.3.m3.2.3.1"></times><apply id="Thmproposition1.p1.3.3.m3.2.3.2.cmml" xref="Thmproposition1.p1.3.3.m3.2.3.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.3.3.m3.2.3.2.1.cmml" xref="Thmproposition1.p1.3.3.m3.2.3.2">superscript</csymbol><apply id="Thmproposition1.p1.3.3.m3.2.3.2.2.cmml" xref="Thmproposition1.p1.3.3.m3.2.3.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.3.3.m3.2.3.2.2.1.cmml" xref="Thmproposition1.p1.3.3.m3.2.3.2">subscript</csymbol><ci id="Thmproposition1.p1.3.3.m3.2.3.2.2.2.cmml" xref="Thmproposition1.p1.3.3.m3.2.3.2.2.2">𝑠</ci><ci id="Thmproposition1.p1.3.3.m3.2.3.2.2.3.cmml" xref="Thmproposition1.p1.3.3.m3.2.3.2.2.3">𝑖</ci></apply><ci id="Thmproposition1.p1.3.3.m3.1.1.1.1.cmml" xref="Thmproposition1.p1.3.3.m3.1.1.1.1">𝑡</ci></apply><ci id="Thmproposition1.p1.3.3.m3.2.2.cmml" xref="Thmproposition1.p1.3.3.m3.2.2">𝛉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.3.3.m3.2c">s_{i}^{(t)}(\bm{\theta})</annotation></semantics></math> and <math id="Thmproposition1.p1.4.4.m4.2" class="ltx_Math" alttext="c^{(t)}_{i}(\bm{\phi}_{i})" display="inline"><semantics id="Thmproposition1.p1.4.4.m4.2a"><mrow id="Thmproposition1.p1.4.4.m4.2.2" xref="Thmproposition1.p1.4.4.m4.2.2.cmml"><msubsup id="Thmproposition1.p1.4.4.m4.2.2.3" xref="Thmproposition1.p1.4.4.m4.2.2.3.cmml"><mi id="Thmproposition1.p1.4.4.m4.2.2.3.2.2" xref="Thmproposition1.p1.4.4.m4.2.2.3.2.2.cmml">c</mi><mi id="Thmproposition1.p1.4.4.m4.2.2.3.3" xref="Thmproposition1.p1.4.4.m4.2.2.3.3.cmml">i</mi><mrow id="Thmproposition1.p1.4.4.m4.1.1.1.3" xref="Thmproposition1.p1.4.4.m4.2.2.3.cmml"><mo stretchy="false" id="Thmproposition1.p1.4.4.m4.1.1.1.3.1" xref="Thmproposition1.p1.4.4.m4.2.2.3.cmml">(</mo><mi id="Thmproposition1.p1.4.4.m4.1.1.1.1" xref="Thmproposition1.p1.4.4.m4.1.1.1.1.cmml">t</mi><mo stretchy="false" id="Thmproposition1.p1.4.4.m4.1.1.1.3.2" xref="Thmproposition1.p1.4.4.m4.2.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.4.4.m4.2.2.2" xref="Thmproposition1.p1.4.4.m4.2.2.2.cmml">​</mo><mrow id="Thmproposition1.p1.4.4.m4.2.2.1.1" xref="Thmproposition1.p1.4.4.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="Thmproposition1.p1.4.4.m4.2.2.1.1.2" xref="Thmproposition1.p1.4.4.m4.2.2.1.1.1.cmml">(</mo><msub id="Thmproposition1.p1.4.4.m4.2.2.1.1.1" xref="Thmproposition1.p1.4.4.m4.2.2.1.1.1.cmml"><mi class="ltx_mathvariant_bold" mathvariant="bold" id="Thmproposition1.p1.4.4.m4.2.2.1.1.1.2" xref="Thmproposition1.p1.4.4.m4.2.2.1.1.1.2.cmml">ϕ</mi><mi id="Thmproposition1.p1.4.4.m4.2.2.1.1.1.3" xref="Thmproposition1.p1.4.4.m4.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Thmproposition1.p1.4.4.m4.2.2.1.1.3" xref="Thmproposition1.p1.4.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.4.4.m4.2b"><apply id="Thmproposition1.p1.4.4.m4.2.2.cmml" xref="Thmproposition1.p1.4.4.m4.2.2"><times id="Thmproposition1.p1.4.4.m4.2.2.2.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.2"></times><apply id="Thmproposition1.p1.4.4.m4.2.2.3.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.3"><csymbol cd="ambiguous" id="Thmproposition1.p1.4.4.m4.2.2.3.1.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.3">subscript</csymbol><apply id="Thmproposition1.p1.4.4.m4.2.2.3.2.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.3"><csymbol cd="ambiguous" id="Thmproposition1.p1.4.4.m4.2.2.3.2.1.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.3">superscript</csymbol><ci id="Thmproposition1.p1.4.4.m4.2.2.3.2.2.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.3.2.2">𝑐</ci><ci id="Thmproposition1.p1.4.4.m4.1.1.1.1.cmml" xref="Thmproposition1.p1.4.4.m4.1.1.1.1">𝑡</ci></apply><ci id="Thmproposition1.p1.4.4.m4.2.2.3.3.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.3.3">𝑖</ci></apply><apply id="Thmproposition1.p1.4.4.m4.2.2.1.1.1.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="Thmproposition1.p1.4.4.m4.2.2.1.1.1.1.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.1.1">subscript</csymbol><ci id="Thmproposition1.p1.4.4.m4.2.2.1.1.1.2.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.1.1.1.2">bold-ϕ</ci><ci id="Thmproposition1.p1.4.4.m4.2.2.1.1.1.3.cmml" xref="Thmproposition1.p1.4.4.m4.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.4.4.m4.2c">c^{(t)}_{i}(\bm{\phi}_{i})</annotation></semantics></math> are found minimizing the variational free energy function <math id="Thmproposition1.p1.5.5.m5.3" class="ltx_Math" alttext="\mathcal{L}_{i}\coloneqq\mathcal{L}(s_{i}(\bm{\theta}),c_{i}(\bm{\phi}_{i}))" display="inline"><semantics id="Thmproposition1.p1.5.5.m5.3a"><mrow id="Thmproposition1.p1.5.5.m5.3.3" xref="Thmproposition1.p1.5.5.m5.3.3.cmml"><msub id="Thmproposition1.p1.5.5.m5.3.3.4" xref="Thmproposition1.p1.5.5.m5.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproposition1.p1.5.5.m5.3.3.4.2" xref="Thmproposition1.p1.5.5.m5.3.3.4.2.cmml">ℒ</mi><mi id="Thmproposition1.p1.5.5.m5.3.3.4.3" xref="Thmproposition1.p1.5.5.m5.3.3.4.3.cmml">i</mi></msub><mo id="Thmproposition1.p1.5.5.m5.3.3.3" xref="Thmproposition1.p1.5.5.m5.3.3.3.cmml">≔</mo><mrow id="Thmproposition1.p1.5.5.m5.3.3.2" xref="Thmproposition1.p1.5.5.m5.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproposition1.p1.5.5.m5.3.3.2.4" xref="Thmproposition1.p1.5.5.m5.3.3.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.5.5.m5.3.3.2.3" xref="Thmproposition1.p1.5.5.m5.3.3.2.3.cmml">​</mo><mrow id="Thmproposition1.p1.5.5.m5.3.3.2.2.2" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.3.cmml"><mo stretchy="false" id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.3" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.3.cmml">(</mo><mrow id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.cmml"><msub id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.cmml"><mi id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.2" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.2.cmml">s</mi><mi id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.3" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.1" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.1.cmml">​</mo><mrow id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.3.2" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.3.2.1" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.cmml">(</mo><mi id="Thmproposition1.p1.5.5.m5.1.1" xref="Thmproposition1.p1.5.5.m5.1.1.cmml">𝛉</mi><mo stretchy="false" id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.3.2.2" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.4" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.3.cmml">,</mo><mrow id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.cmml"><msub id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.cmml"><mi id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.2" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.2.cmml">c</mi><mi id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.3" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.2" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.2.cmml">​</mo><mrow id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.2" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.cmml">(</mo><msub id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.cmml"><mi class="ltx_mathvariant_bold" mathvariant="bold" id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.2" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.2.cmml">ϕ</mi><mi id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.3" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.3" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.5" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.5.5.m5.3b"><apply id="Thmproposition1.p1.5.5.m5.3.3.cmml" xref="Thmproposition1.p1.5.5.m5.3.3"><ci id="Thmproposition1.p1.5.5.m5.3.3.3.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.3">≔</ci><apply id="Thmproposition1.p1.5.5.m5.3.3.4.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.4"><csymbol cd="ambiguous" id="Thmproposition1.p1.5.5.m5.3.3.4.1.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.4">subscript</csymbol><ci id="Thmproposition1.p1.5.5.m5.3.3.4.2.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.4.2">ℒ</ci><ci id="Thmproposition1.p1.5.5.m5.3.3.4.3.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.4.3">𝑖</ci></apply><apply id="Thmproposition1.p1.5.5.m5.3.3.2.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2"><times id="Thmproposition1.p1.5.5.m5.3.3.2.3.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.3"></times><ci id="Thmproposition1.p1.5.5.m5.3.3.2.4.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.4">ℒ</ci><interval closure="open" id="Thmproposition1.p1.5.5.m5.3.3.2.2.3.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2"><apply id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.cmml" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1"><times id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.1.cmml" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.1"></times><apply id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.cmml" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.1.cmml" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2">subscript</csymbol><ci id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.2.cmml" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.2">𝑠</ci><ci id="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.3.cmml" xref="Thmproposition1.p1.5.5.m5.2.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="Thmproposition1.p1.5.5.m5.1.1.cmml" xref="Thmproposition1.p1.5.5.m5.1.1">𝛉</ci></apply><apply id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2"><times id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.2.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.2"></times><apply id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.1.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3">subscript</csymbol><ci id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.2.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.2">𝑐</ci><ci id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.3.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.3.3">𝑖</ci></apply><apply id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.1.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1">subscript</csymbol><ci id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.2.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.2">bold-ϕ</ci><ci id="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.3.cmml" xref="Thmproposition1.p1.5.5.m5.3.3.2.2.2.2.1.1.1.3">𝑖</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.5.5.m5.3c">\mathcal{L}_{i}\coloneqq\mathcal{L}(s_{i}(\bm{\theta}),c_{i}(\bm{\phi}_{i}))</annotation></semantics></math>, with</span></p>
<table id="A4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{i}" display="inline"><semantics id="S2.Ex1.m1.1a"><msub id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.1.1.2" xref="S2.Ex1.m1.1.1.2.cmml">ℒ</mi><mi id="S2.Ex1.m1.1.1.3" xref="S2.Ex1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.1b"><apply id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.cmml" xref="S2.Ex1.m1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.2">ℒ</ci><ci id="S2.Ex1.m1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\displaystyle\mathcal{L}_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex1.m2.10" class="ltx_math_unparsed" alttext="\displaystyle=D_{KL}\left(s_{i}(\bm{\theta})\frac{s^{(t-1)}(\bm{\theta})}{s^{(t-1)}_{i}(\bm{\theta})}\bigg{|}\bigg{|}p(\bm{\theta})^{\frac{1}{K}}\frac{s^{(t-1)}(\bm{\theta})}{s^{(t-1)}_{i}(\bm{\theta})}\right)" display="inline"><semantics id="S2.Ex1.m2.10a"><mrow id="S2.Ex1.m2.10b"><mo id="S2.Ex1.m2.10.11">=</mo><msub id="S2.Ex1.m2.10.12"><mi id="S2.Ex1.m2.10.12.2">D</mi><mrow id="S2.Ex1.m2.10.12.3"><mi id="S2.Ex1.m2.10.12.3.2">K</mi><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.10.12.3.1">​</mo><mi id="S2.Ex1.m2.10.12.3.3">L</mi></mrow></msub><mrow id="S2.Ex1.m2.10.13"><mo id="S2.Ex1.m2.10.13.1">(</mo><msub id="S2.Ex1.m2.10.13.2"><mi id="S2.Ex1.m2.10.13.2.2">s</mi><mi id="S2.Ex1.m2.10.13.2.3">i</mi></msub><mrow id="S2.Ex1.m2.10.13.3"><mo stretchy="false" id="S2.Ex1.m2.10.13.3.1">(</mo><mi id="S2.Ex1.m2.9.9">𝜽</mi><mo stretchy="false" id="S2.Ex1.m2.10.13.3.2">)</mo></mrow><mstyle displaystyle="true" id="S2.Ex1.m2.4.4"><mfrac id="S2.Ex1.m2.4.4a"><mrow id="S2.Ex1.m2.2.2.2"><msup id="S2.Ex1.m2.2.2.2.4"><mi id="S2.Ex1.m2.2.2.2.4.2">s</mi><mrow id="S2.Ex1.m2.1.1.1.1.1.1"><mo stretchy="false" id="S2.Ex1.m2.1.1.1.1.1.1.2">(</mo><mrow id="S2.Ex1.m2.1.1.1.1.1.1.1"><mi id="S2.Ex1.m2.1.1.1.1.1.1.1.2">t</mi><mo id="S2.Ex1.m2.1.1.1.1.1.1.1.1">−</mo><mn id="S2.Ex1.m2.1.1.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S2.Ex1.m2.1.1.1.1.1.1.3">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.2.2.2.3">​</mo><mrow id="S2.Ex1.m2.2.2.2.5.2"><mo stretchy="false" id="S2.Ex1.m2.2.2.2.5.2.1">(</mo><mi id="S2.Ex1.m2.2.2.2.2">𝜽</mi><mo stretchy="false" id="S2.Ex1.m2.2.2.2.5.2.2">)</mo></mrow></mrow><mrow id="S2.Ex1.m2.4.4.4"><msubsup id="S2.Ex1.m2.4.4.4.4"><mi id="S2.Ex1.m2.4.4.4.4.2.2">s</mi><mi id="S2.Ex1.m2.4.4.4.4.3">i</mi><mrow id="S2.Ex1.m2.3.3.3.1.1.1"><mo stretchy="false" id="S2.Ex1.m2.3.3.3.1.1.1.2">(</mo><mrow id="S2.Ex1.m2.3.3.3.1.1.1.1"><mi id="S2.Ex1.m2.3.3.3.1.1.1.1.2">t</mi><mo id="S2.Ex1.m2.3.3.3.1.1.1.1.1">−</mo><mn id="S2.Ex1.m2.3.3.3.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S2.Ex1.m2.3.3.3.1.1.1.3">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.4.4.4.3">​</mo><mrow id="S2.Ex1.m2.4.4.4.5.2"><mo stretchy="false" id="S2.Ex1.m2.4.4.4.5.2.1">(</mo><mi id="S2.Ex1.m2.4.4.4.2">𝜽</mi><mo stretchy="false" id="S2.Ex1.m2.4.4.4.5.2.2">)</mo></mrow></mrow></mfrac></mstyle><mo fence="false" maxsize="210%" minsize="210%" rspace="0.167em" id="S2.Ex1.m2.10.13.4">|</mo><mo fence="false" maxsize="210%" minsize="210%" rspace="0.167em" id="S2.Ex1.m2.10.13.5">|</mo><mi id="S2.Ex1.m2.10.13.6">p</mi><msup id="S2.Ex1.m2.10.13.7"><mrow id="S2.Ex1.m2.10.13.7.2"><mo stretchy="false" id="S2.Ex1.m2.10.13.7.2.1">(</mo><mi id="S2.Ex1.m2.10.10">𝜽</mi><mo stretchy="false" id="S2.Ex1.m2.10.13.7.2.2">)</mo></mrow><mfrac id="S2.Ex1.m2.10.13.7.3"><mn id="S2.Ex1.m2.10.13.7.3.2">1</mn><mi id="S2.Ex1.m2.10.13.7.3.3">K</mi></mfrac></msup><mstyle displaystyle="true" id="S2.Ex1.m2.8.8"><mfrac id="S2.Ex1.m2.8.8a"><mrow id="S2.Ex1.m2.6.6.2"><msup id="S2.Ex1.m2.6.6.2.4"><mi id="S2.Ex1.m2.6.6.2.4.2">s</mi><mrow id="S2.Ex1.m2.5.5.1.1.1.1"><mo stretchy="false" id="S2.Ex1.m2.5.5.1.1.1.1.2">(</mo><mrow id="S2.Ex1.m2.5.5.1.1.1.1.1"><mi id="S2.Ex1.m2.5.5.1.1.1.1.1.2">t</mi><mo id="S2.Ex1.m2.5.5.1.1.1.1.1.1">−</mo><mn id="S2.Ex1.m2.5.5.1.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S2.Ex1.m2.5.5.1.1.1.1.3">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.6.6.2.3">​</mo><mrow id="S2.Ex1.m2.6.6.2.5.2"><mo stretchy="false" id="S2.Ex1.m2.6.6.2.5.2.1">(</mo><mi id="S2.Ex1.m2.6.6.2.2">𝜽</mi><mo stretchy="false" id="S2.Ex1.m2.6.6.2.5.2.2">)</mo></mrow></mrow><mrow id="S2.Ex1.m2.8.8.4"><msubsup id="S2.Ex1.m2.8.8.4.4"><mi id="S2.Ex1.m2.8.8.4.4.2.2">s</mi><mi id="S2.Ex1.m2.8.8.4.4.3">i</mi><mrow id="S2.Ex1.m2.7.7.3.1.1.1"><mo stretchy="false" id="S2.Ex1.m2.7.7.3.1.1.1.2">(</mo><mrow id="S2.Ex1.m2.7.7.3.1.1.1.1"><mi id="S2.Ex1.m2.7.7.3.1.1.1.1.2">t</mi><mo id="S2.Ex1.m2.7.7.3.1.1.1.1.1">−</mo><mn id="S2.Ex1.m2.7.7.3.1.1.1.1.3">1</mn></mrow><mo stretchy="false" id="S2.Ex1.m2.7.7.3.1.1.1.3">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.Ex1.m2.8.8.4.3">​</mo><mrow id="S2.Ex1.m2.8.8.4.5.2"><mo stretchy="false" id="S2.Ex1.m2.8.8.4.5.2.1">(</mo><mi id="S2.Ex1.m2.8.8.4.2">𝜽</mi><mo stretchy="false" id="S2.Ex1.m2.8.8.4.5.2.2">)</mo></mrow></mrow></mfrac></mstyle><mo id="S2.Ex1.m2.10.13.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.Ex1.m2.10c">\displaystyle=D_{KL}\left(s_{i}(\bm{\theta})\frac{s^{(t-1)}(\bm{\theta})}{s^{(t-1)}_{i}(\bm{\theta})}\bigg{|}\bigg{|}p(\bm{\theta})^{\frac{1}{K}}\frac{s^{(t-1)}(\bm{\theta})}{s^{(t-1)}_{i}(\bm{\theta})}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\hskip 28.45274pt+D_{KL}\left(c_{i}(\bm{\phi}_{i})||p(\bm{\phi}_{i})\right)" display="inline"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1b"><mo id="S2.E3.m1.1.1">+</mo><msub id="S2.E3.m1.1.2"><mi id="S2.E3.m1.1.2.2">D</mi><mrow id="S2.E3.m1.1.2.3"><mi id="S2.E3.m1.1.2.3.2">K</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.2.3.1">​</mo><mi id="S2.E3.m1.1.2.3.3">L</mi></mrow></msub><mrow id="S2.E3.m1.1.3"><mo id="S2.E3.m1.1.3.1">(</mo><msub id="S2.E3.m1.1.3.2"><mi id="S2.E3.m1.1.3.2.2">c</mi><mi id="S2.E3.m1.1.3.2.3">i</mi></msub><mrow id="S2.E3.m1.1.3.3"><mo stretchy="false" id="S2.E3.m1.1.3.3.1">(</mo><msub id="S2.E3.m1.1.3.3.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E3.m1.1.3.3.2.2">ϕ</mi><mi id="S2.E3.m1.1.3.3.2.3">i</mi></msub><mo stretchy="false" id="S2.E3.m1.1.3.3.3">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E3.m1.1.3.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S2.E3.m1.1.3.5">|</mo><mi id="S2.E3.m1.1.3.6">p</mi><mrow id="S2.E3.m1.1.3.7"><mo stretchy="false" id="S2.E3.m1.1.3.7.1">(</mo><msub id="S2.E3.m1.1.3.7.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E3.m1.1.3.7.2.2">ϕ</mi><mi id="S2.E3.m1.1.3.7.2.3">i</mi></msub><mo stretchy="false" id="S2.E3.m1.1.3.7.3">)</mo></mrow><mo id="S2.E3.m1.1.3.8">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\hskip 28.45274pt+D_{KL}\left(c_{i}(\bm{\phi}_{i})||p(\bm{\phi}_{i})\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.Ex2.m1.3" class="ltx_Math" alttext="\displaystyle\hskip 28.45274pt-\mathbb{E}_{\begin{subarray}{c}s^{(t)}(\bm{\theta})\\
c_{i}(\bm{\phi}_{i})\end{subarray}}\log p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi}_{i})" display="inline"><semantics id="S2.Ex2.m1.3a"><mrow id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3.cmml"><mo id="S2.Ex2.m1.3.3a" xref="S2.Ex2.m1.3.3.cmml">−</mo><mrow id="S2.Ex2.m1.3.3.1" xref="S2.Ex2.m1.3.3.1.cmml"><msub id="S2.Ex2.m1.3.3.1.3" xref="S2.Ex2.m1.3.3.1.3.cmml"><mi id="S2.Ex2.m1.3.3.1.3.2" xref="S2.Ex2.m1.3.3.1.3.2.cmml">𝔼</mi><mtable rowspacing="0pt" id="S2.Ex2.m1.1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1a.2.cmml"><mtr id="S2.Ex2.m1.1.1.1.1.1.1a" xref="S2.Ex2.m1.1.1.1a.2.cmml"><mtd id="S2.Ex2.m1.1.1.1.1.1.1b" xref="S2.Ex2.m1.1.1.1a.2.cmml"><mrow id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.cmml"><msup id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.cmml"><mi id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.2.cmml">s</mi><mrow id="S2.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.cmml"><mo stretchy="false" id="S2.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.cmml">(</mo><mi id="S2.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S2.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.5.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mo stretchy="false" id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.5.2.1" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝜽</mi><mo stretchy="false" id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.5.2.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S2.Ex2.m1.1.1.1.1.1.1c" xref="S2.Ex2.m1.1.1.1a.2.cmml"><mtd id="S2.Ex2.m1.1.1.1.1.1.1d" xref="S2.Ex2.m1.1.1.1a.2.cmml"><mrow id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.cmml"><msub id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.cmml"><mi id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.2" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.2.cmml">c</mi><mi id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.3" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.2" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.3" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mtd></mtr></mtable></msub><mo lspace="0.167em" rspace="0em" id="S2.Ex2.m1.3.3.1.2" xref="S2.Ex2.m1.3.3.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.3.3.1.4" xref="S2.Ex2.m1.3.3.1.4.cmml"><mi id="S2.Ex2.m1.3.3.1.4.1" xref="S2.Ex2.m1.3.3.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S2.Ex2.m1.3.3.1.4a" xref="S2.Ex2.m1.3.3.1.4.cmml">⁡</mo><mi id="S2.Ex2.m1.3.3.1.4.2" xref="S2.Ex2.m1.3.3.1.4.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.3.3.1.2a" xref="S2.Ex2.m1.3.3.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.3.3.1.1.1" xref="S2.Ex2.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.3.3.1.1.1.2" xref="S2.Ex2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.3.3.1.1.1.1" xref="S2.Ex2.m1.3.3.1.1.1.1.cmml"><msub id="S2.Ex2.m1.3.3.1.1.1.1.3" xref="S2.Ex2.m1.3.3.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex2.m1.3.3.1.1.1.1.3.2" xref="S2.Ex2.m1.3.3.1.1.1.1.3.2.cmml">𝒟</mi><mi id="S2.Ex2.m1.3.3.1.1.1.1.3.3" xref="S2.Ex2.m1.3.3.1.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="S2.Ex2.m1.3.3.1.1.1.1.2" xref="S2.Ex2.m1.3.3.1.1.1.1.2.cmml">|</mo><mrow id="S2.Ex2.m1.3.3.1.1.1.1.1.1" xref="S2.Ex2.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S2.Ex2.m1.2.2" xref="S2.Ex2.m1.2.2.cmml">𝜽</mi><mo id="S2.Ex2.m1.3.3.1.1.1.1.1.1.2" xref="S2.Ex2.m1.3.3.1.1.1.1.1.2.cmml">,</mo><msub id="S2.Ex2.m1.3.3.1.1.1.1.1.1.1" xref="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S2.Ex2.m1.3.3.1.1.1.3" xref="S2.Ex2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.3b"><apply id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3"><minus id="S2.Ex2.m1.3.3.2.cmml" xref="S2.Ex2.m1.3.3"></minus><apply id="S2.Ex2.m1.3.3.1.cmml" xref="S2.Ex2.m1.3.3.1"><times id="S2.Ex2.m1.3.3.1.2.cmml" xref="S2.Ex2.m1.3.3.1.2"></times><apply id="S2.Ex2.m1.3.3.1.3.cmml" xref="S2.Ex2.m1.3.3.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.1.3.1.cmml" xref="S2.Ex2.m1.3.3.1.3">subscript</csymbol><ci id="S2.Ex2.m1.3.3.1.3.2.cmml" xref="S2.Ex2.m1.3.3.1.3.2">𝔼</ci><list id="S2.Ex2.m1.1.1.1a.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1"><matrix id="S2.Ex2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1"><matrixrow id="S2.Ex2.m1.1.1.1.1.1.1a.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1"><apply id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2"><times id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.3"></times><apply id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4">superscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.4.2">𝑠</ci><ci id="S2.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1">𝑡</ci></apply><ci id="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2.2.2.2.2">𝜽</ci></apply></matrixrow><matrixrow id="S2.Ex2.m1.1.1.1.1.1.1b.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1"><apply id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1"><times id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.2"></times><apply id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3">subscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.2">𝑐</ci><ci id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.3.3">𝑖</ci></apply><apply id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.3.3.1.1.1.1.1.3">𝑖</ci></apply></apply></matrixrow></matrix></list></apply><apply id="S2.Ex2.m1.3.3.1.4.cmml" xref="S2.Ex2.m1.3.3.1.4"><log id="S2.Ex2.m1.3.3.1.4.1.cmml" xref="S2.Ex2.m1.3.3.1.4.1"></log><ci id="S2.Ex2.m1.3.3.1.4.2.cmml" xref="S2.Ex2.m1.3.3.1.4.2">𝑝</ci></apply><apply id="S2.Ex2.m1.3.3.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1"><csymbol cd="latexml" id="S2.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.2">conditional</csymbol><apply id="S2.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex2.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3.2">𝒟</ci><ci id="S2.Ex2.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.3.3">𝑖</ci></apply><list id="S2.Ex2.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.1.1"><ci id="S2.Ex2.m1.2.2.cmml" xref="S2.Ex2.m1.2.2">𝜽</ci><apply id="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.3c">\displaystyle\hskip 28.45274pt-\mathbb{E}_{\begin{subarray}{c}s^{(t)}(\bm{\theta})\\
c_{i}(\bm{\phi}_{i})\end{subarray}}\log p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="Thmproposition1.p1.6" class="ltx_p"><span id="Thmproposition1.p1.6.1" class="ltx_text ltx_font_italic">where <math id="Thmproposition1.p1.6.1.m1.5" class="ltx_Math" alttext="s^{(t)}(\bm{\theta})=s_{i}(\bm{\theta})\prod_{j\neq i}^{K}s_{j}^{(t-1)}(\bm{\theta})" display="inline"><semantics id="Thmproposition1.p1.6.1.m1.5a"><mrow id="Thmproposition1.p1.6.1.m1.5.6" xref="Thmproposition1.p1.6.1.m1.5.6.cmml"><mrow id="Thmproposition1.p1.6.1.m1.5.6.2" xref="Thmproposition1.p1.6.1.m1.5.6.2.cmml"><msup id="Thmproposition1.p1.6.1.m1.5.6.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.2.2.cmml"><mi id="Thmproposition1.p1.6.1.m1.5.6.2.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.2.2.2.cmml">s</mi><mrow id="Thmproposition1.p1.6.1.m1.1.1.1.3" xref="Thmproposition1.p1.6.1.m1.5.6.2.2.cmml"><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.1.1.1.3.1" xref="Thmproposition1.p1.6.1.m1.5.6.2.2.cmml">(</mo><mi id="Thmproposition1.p1.6.1.m1.1.1.1.1" xref="Thmproposition1.p1.6.1.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.1.1.1.3.2" xref="Thmproposition1.p1.6.1.m1.5.6.2.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.6.1.m1.5.6.2.1" xref="Thmproposition1.p1.6.1.m1.5.6.2.1.cmml">​</mo><mrow id="Thmproposition1.p1.6.1.m1.5.6.2.3.2" xref="Thmproposition1.p1.6.1.m1.5.6.2.cmml"><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.5.6.2.3.2.1" xref="Thmproposition1.p1.6.1.m1.5.6.2.cmml">(</mo><mi id="Thmproposition1.p1.6.1.m1.3.3" xref="Thmproposition1.p1.6.1.m1.3.3.cmml">𝛉</mi><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.5.6.2.3.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.2.cmml">)</mo></mrow></mrow><mo id="Thmproposition1.p1.6.1.m1.5.6.1" xref="Thmproposition1.p1.6.1.m1.5.6.1.cmml">=</mo><mrow id="Thmproposition1.p1.6.1.m1.5.6.3" xref="Thmproposition1.p1.6.1.m1.5.6.3.cmml"><msub id="Thmproposition1.p1.6.1.m1.5.6.3.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.2.cmml"><mi id="Thmproposition1.p1.6.1.m1.5.6.3.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.2.2.cmml">s</mi><mi id="Thmproposition1.p1.6.1.m1.5.6.3.2.3" xref="Thmproposition1.p1.6.1.m1.5.6.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.6.1.m1.5.6.3.1" xref="Thmproposition1.p1.6.1.m1.5.6.3.1.cmml">​</mo><mrow id="Thmproposition1.p1.6.1.m1.5.6.3.3.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.cmml"><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.5.6.3.3.2.1" xref="Thmproposition1.p1.6.1.m1.5.6.3.cmml">(</mo><mi id="Thmproposition1.p1.6.1.m1.4.4" xref="Thmproposition1.p1.6.1.m1.4.4.cmml">𝛉</mi><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.5.6.3.3.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.6.1.m1.5.6.3.1a" xref="Thmproposition1.p1.6.1.m1.5.6.3.1.cmml">​</mo><mrow id="Thmproposition1.p1.6.1.m1.5.6.3.4" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.cmml"><msubsup id="Thmproposition1.p1.6.1.m1.5.6.3.4.1" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.cmml"><mo id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.2.cmml">∏</mo><mrow id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.cmml"><mi id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.2.cmml">j</mi><mo id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.1" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.1.cmml">≠</mo><mi id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.3" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.3.cmml">i</mi></mrow><mi id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.3" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.3.cmml">K</mi></msubsup><mrow id="Thmproposition1.p1.6.1.m1.5.6.3.4.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.cmml"><msubsup id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.cmml"><mi id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.2.cmml">s</mi><mi id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.3" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.3.cmml">j</mi><mrow id="Thmproposition1.p1.6.1.m1.2.2.1.1" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.2.2.1.1.2" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="Thmproposition1.p1.6.1.m1.2.2.1.1.1" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.cmml"><mi id="Thmproposition1.p1.6.1.m1.2.2.1.1.1.2" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.2.cmml">t</mi><mo id="Thmproposition1.p1.6.1.m1.2.2.1.1.1.1" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.1.cmml">−</mo><mn id="Thmproposition1.p1.6.1.m1.2.2.1.1.1.3" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.2.2.1.1.3" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.1" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.1.cmml">​</mo><mrow id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.3.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.cmml"><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.3.2.1" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.cmml">(</mo><mi id="Thmproposition1.p1.6.1.m1.5.5" xref="Thmproposition1.p1.6.1.m1.5.5.cmml">𝛉</mi><mo stretchy="false" id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.3.2.2" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmproposition1.p1.6.1.m1.5b"><apply id="Thmproposition1.p1.6.1.m1.5.6.cmml" xref="Thmproposition1.p1.6.1.m1.5.6"><eq id="Thmproposition1.p1.6.1.m1.5.6.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.1"></eq><apply id="Thmproposition1.p1.6.1.m1.5.6.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.2"><times id="Thmproposition1.p1.6.1.m1.5.6.2.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.2.1"></times><apply id="Thmproposition1.p1.6.1.m1.5.6.2.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.2.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.6.1.m1.5.6.2.2.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.2.2">superscript</csymbol><ci id="Thmproposition1.p1.6.1.m1.5.6.2.2.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.2.2.2">𝑠</ci><ci id="Thmproposition1.p1.6.1.m1.1.1.1.1.cmml" xref="Thmproposition1.p1.6.1.m1.1.1.1.1">𝑡</ci></apply><ci id="Thmproposition1.p1.6.1.m1.3.3.cmml" xref="Thmproposition1.p1.6.1.m1.3.3">𝛉</ci></apply><apply id="Thmproposition1.p1.6.1.m1.5.6.3.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3"><times id="Thmproposition1.p1.6.1.m1.5.6.3.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.1"></times><apply id="Thmproposition1.p1.6.1.m1.5.6.3.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.6.1.m1.5.6.3.2.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.2">subscript</csymbol><ci id="Thmproposition1.p1.6.1.m1.5.6.3.2.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.2.2">𝑠</ci><ci id="Thmproposition1.p1.6.1.m1.5.6.3.2.3.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.2.3">𝑖</ci></apply><ci id="Thmproposition1.p1.6.1.m1.4.4.cmml" xref="Thmproposition1.p1.6.1.m1.4.4">𝛉</ci><apply id="Thmproposition1.p1.6.1.m1.5.6.3.4.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4"><apply id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1"><csymbol cd="ambiguous" id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1">superscript</csymbol><apply id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1"><csymbol cd="ambiguous" id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1">subscript</csymbol><csymbol cd="latexml" id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.2">product</csymbol><apply id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3"><neq id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.1"></neq><ci id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.2">𝑗</ci><ci id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.3.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.2.3.3">𝑖</ci></apply></apply><ci id="Thmproposition1.p1.6.1.m1.5.6.3.4.1.3.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.1.3">𝐾</ci></apply><apply id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2"><times id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.1"></times><apply id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2">superscript</csymbol><apply id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2"><csymbol cd="ambiguous" id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.1.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2">subscript</csymbol><ci id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.2.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.2">𝑠</ci><ci id="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.3.cmml" xref="Thmproposition1.p1.6.1.m1.5.6.3.4.2.2.2.3">𝑗</ci></apply><apply id="Thmproposition1.p1.6.1.m1.2.2.1.1.1.cmml" xref="Thmproposition1.p1.6.1.m1.2.2.1.1"><minus id="Thmproposition1.p1.6.1.m1.2.2.1.1.1.1.cmml" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.1"></minus><ci id="Thmproposition1.p1.6.1.m1.2.2.1.1.1.2.cmml" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="Thmproposition1.p1.6.1.m1.2.2.1.1.1.3.cmml" xref="Thmproposition1.p1.6.1.m1.2.2.1.1.1.3">1</cn></apply></apply><ci id="Thmproposition1.p1.6.1.m1.5.5.cmml" xref="Thmproposition1.p1.6.1.m1.5.5">𝛉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmproposition1.p1.6.1.m1.5c">s^{(t)}(\bm{\theta})=s_{i}(\bm{\theta})\prod_{j\neq i}^{K}s_{j}^{(t-1)}(\bm{\theta})</annotation></semantics></math> is the updated posterior over the server parameters.</span></p>
</div>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.3" class="ltx_p">We can see that the variational free energy in <a href="#S2.Ex2" title="Proposition 1. ‣ II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> decomposes naturally into two parts. The terms that involve the client parameters <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="c_{i}(\bm{\phi}_{i})" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><mrow id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><msub id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3.cmml"><mi id="S2.SS2.p3.1.m1.1.1.3.2" xref="S2.SS2.p3.1.m1.1.1.3.2.cmml">c</mi><mi id="S2.SS2.p3.1.m1.1.1.3.3" xref="S2.SS2.p3.1.m1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p3.1.m1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p3.1.m1.1.1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p3.1.m1.1.1.1.1.1" xref="S2.SS2.p3.1.m1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS2.p3.1.m1.1.1.1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.SS2.p3.1.m1.1.1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS2.p3.1.m1.1.1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"><times id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2"></times><apply id="S2.SS2.p3.1.m1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.3.1.cmml" xref="S2.SS2.p3.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.3.2.cmml" xref="S2.SS2.p3.1.m1.1.1.3.2">𝑐</ci><ci id="S2.SS2.p3.1.m1.1.1.3.3.cmml" xref="S2.SS2.p3.1.m1.1.1.3.3">𝑖</ci></apply><apply id="S2.SS2.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">c_{i}(\bm{\phi}_{i})</annotation></semantics></math> correspond to the standard variational free energy terms of <em id="S2.SS2.p3.3.1" class="ltx_emph ltx_font_italic">Bayes by backprop</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Note that, except for the natural entropic complexity cost given by the second KL term, no additional regularization is applied on the client parameters, that can hence be trained efficiently and network agnostic. The terms that involve the server posterior are instead the likelihood cost and the first KL term. This regularization restricts the server to learn an overall posterior close to the so-called cavity distribution <math id="S2.SS2.p3.2.m2.3" class="ltx_Math" alttext="\tilde{s}_{i}(\theta)^{t}=p(\theta)^{1/K}\prod_{j\neq i}s_{j}(\theta)^{t}" display="inline"><semantics id="S2.SS2.p3.2.m2.3a"><mrow id="S2.SS2.p3.2.m2.3.4" xref="S2.SS2.p3.2.m2.3.4.cmml"><mrow id="S2.SS2.p3.2.m2.3.4.2" xref="S2.SS2.p3.2.m2.3.4.2.cmml"><msub id="S2.SS2.p3.2.m2.3.4.2.2" xref="S2.SS2.p3.2.m2.3.4.2.2.cmml"><mover accent="true" id="S2.SS2.p3.2.m2.3.4.2.2.2" xref="S2.SS2.p3.2.m2.3.4.2.2.2.cmml"><mi id="S2.SS2.p3.2.m2.3.4.2.2.2.2" xref="S2.SS2.p3.2.m2.3.4.2.2.2.2.cmml">s</mi><mo id="S2.SS2.p3.2.m2.3.4.2.2.2.1" xref="S2.SS2.p3.2.m2.3.4.2.2.2.1.cmml">~</mo></mover><mi id="S2.SS2.p3.2.m2.3.4.2.2.3" xref="S2.SS2.p3.2.m2.3.4.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.2.m2.3.4.2.1" xref="S2.SS2.p3.2.m2.3.4.2.1.cmml">​</mo><msup id="S2.SS2.p3.2.m2.3.4.2.3" xref="S2.SS2.p3.2.m2.3.4.2.3.cmml"><mrow id="S2.SS2.p3.2.m2.3.4.2.3.2.2" xref="S2.SS2.p3.2.m2.3.4.2.3.cmml"><mo stretchy="false" id="S2.SS2.p3.2.m2.3.4.2.3.2.2.1" xref="S2.SS2.p3.2.m2.3.4.2.3.cmml">(</mo><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">θ</mi><mo stretchy="false" id="S2.SS2.p3.2.m2.3.4.2.3.2.2.2" xref="S2.SS2.p3.2.m2.3.4.2.3.cmml">)</mo></mrow><mi id="S2.SS2.p3.2.m2.3.4.2.3.3" xref="S2.SS2.p3.2.m2.3.4.2.3.3.cmml">t</mi></msup></mrow><mo id="S2.SS2.p3.2.m2.3.4.1" xref="S2.SS2.p3.2.m2.3.4.1.cmml">=</mo><mrow id="S2.SS2.p3.2.m2.3.4.3" xref="S2.SS2.p3.2.m2.3.4.3.cmml"><mi id="S2.SS2.p3.2.m2.3.4.3.2" xref="S2.SS2.p3.2.m2.3.4.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.2.m2.3.4.3.1" xref="S2.SS2.p3.2.m2.3.4.3.1.cmml">​</mo><msup id="S2.SS2.p3.2.m2.3.4.3.3" xref="S2.SS2.p3.2.m2.3.4.3.3.cmml"><mrow id="S2.SS2.p3.2.m2.3.4.3.3.2.2" xref="S2.SS2.p3.2.m2.3.4.3.3.cmml"><mo stretchy="false" id="S2.SS2.p3.2.m2.3.4.3.3.2.2.1" xref="S2.SS2.p3.2.m2.3.4.3.3.cmml">(</mo><mi id="S2.SS2.p3.2.m2.2.2" xref="S2.SS2.p3.2.m2.2.2.cmml">θ</mi><mo stretchy="false" id="S2.SS2.p3.2.m2.3.4.3.3.2.2.2" xref="S2.SS2.p3.2.m2.3.4.3.3.cmml">)</mo></mrow><mrow id="S2.SS2.p3.2.m2.3.4.3.3.3" xref="S2.SS2.p3.2.m2.3.4.3.3.3.cmml"><mn id="S2.SS2.p3.2.m2.3.4.3.3.3.2" xref="S2.SS2.p3.2.m2.3.4.3.3.3.2.cmml">1</mn><mo id="S2.SS2.p3.2.m2.3.4.3.3.3.1" xref="S2.SS2.p3.2.m2.3.4.3.3.3.1.cmml">/</mo><mi id="S2.SS2.p3.2.m2.3.4.3.3.3.3" xref="S2.SS2.p3.2.m2.3.4.3.3.3.3.cmml">K</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S2.SS2.p3.2.m2.3.4.3.1a" xref="S2.SS2.p3.2.m2.3.4.3.1.cmml">​</mo><mrow id="S2.SS2.p3.2.m2.3.4.3.4" xref="S2.SS2.p3.2.m2.3.4.3.4.cmml"><msub id="S2.SS2.p3.2.m2.3.4.3.4.1" xref="S2.SS2.p3.2.m2.3.4.3.4.1.cmml"><mo id="S2.SS2.p3.2.m2.3.4.3.4.1.2" xref="S2.SS2.p3.2.m2.3.4.3.4.1.2.cmml">∏</mo><mrow id="S2.SS2.p3.2.m2.3.4.3.4.1.3" xref="S2.SS2.p3.2.m2.3.4.3.4.1.3.cmml"><mi id="S2.SS2.p3.2.m2.3.4.3.4.1.3.2" xref="S2.SS2.p3.2.m2.3.4.3.4.1.3.2.cmml">j</mi><mo id="S2.SS2.p3.2.m2.3.4.3.4.1.3.1" xref="S2.SS2.p3.2.m2.3.4.3.4.1.3.1.cmml">≠</mo><mi id="S2.SS2.p3.2.m2.3.4.3.4.1.3.3" xref="S2.SS2.p3.2.m2.3.4.3.4.1.3.3.cmml">i</mi></mrow></msub><mrow id="S2.SS2.p3.2.m2.3.4.3.4.2" xref="S2.SS2.p3.2.m2.3.4.3.4.2.cmml"><msub id="S2.SS2.p3.2.m2.3.4.3.4.2.2" xref="S2.SS2.p3.2.m2.3.4.3.4.2.2.cmml"><mi id="S2.SS2.p3.2.m2.3.4.3.4.2.2.2" xref="S2.SS2.p3.2.m2.3.4.3.4.2.2.2.cmml">s</mi><mi id="S2.SS2.p3.2.m2.3.4.3.4.2.2.3" xref="S2.SS2.p3.2.m2.3.4.3.4.2.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p3.2.m2.3.4.3.4.2.1" xref="S2.SS2.p3.2.m2.3.4.3.4.2.1.cmml">​</mo><msup id="S2.SS2.p3.2.m2.3.4.3.4.2.3" xref="S2.SS2.p3.2.m2.3.4.3.4.2.3.cmml"><mrow id="S2.SS2.p3.2.m2.3.4.3.4.2.3.2.2" xref="S2.SS2.p3.2.m2.3.4.3.4.2.3.cmml"><mo stretchy="false" id="S2.SS2.p3.2.m2.3.4.3.4.2.3.2.2.1" xref="S2.SS2.p3.2.m2.3.4.3.4.2.3.cmml">(</mo><mi id="S2.SS2.p3.2.m2.3.3" xref="S2.SS2.p3.2.m2.3.3.cmml">θ</mi><mo stretchy="false" id="S2.SS2.p3.2.m2.3.4.3.4.2.3.2.2.2" xref="S2.SS2.p3.2.m2.3.4.3.4.2.3.cmml">)</mo></mrow><mi id="S2.SS2.p3.2.m2.3.4.3.4.2.3.3" xref="S2.SS2.p3.2.m2.3.4.3.4.2.3.3.cmml">t</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.3b"><apply id="S2.SS2.p3.2.m2.3.4.cmml" xref="S2.SS2.p3.2.m2.3.4"><eq id="S2.SS2.p3.2.m2.3.4.1.cmml" xref="S2.SS2.p3.2.m2.3.4.1"></eq><apply id="S2.SS2.p3.2.m2.3.4.2.cmml" xref="S2.SS2.p3.2.m2.3.4.2"><times id="S2.SS2.p3.2.m2.3.4.2.1.cmml" xref="S2.SS2.p3.2.m2.3.4.2.1"></times><apply id="S2.SS2.p3.2.m2.3.4.2.2.cmml" xref="S2.SS2.p3.2.m2.3.4.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.3.4.2.2.1.cmml" xref="S2.SS2.p3.2.m2.3.4.2.2">subscript</csymbol><apply id="S2.SS2.p3.2.m2.3.4.2.2.2.cmml" xref="S2.SS2.p3.2.m2.3.4.2.2.2"><ci id="S2.SS2.p3.2.m2.3.4.2.2.2.1.cmml" xref="S2.SS2.p3.2.m2.3.4.2.2.2.1">~</ci><ci id="S2.SS2.p3.2.m2.3.4.2.2.2.2.cmml" xref="S2.SS2.p3.2.m2.3.4.2.2.2.2">𝑠</ci></apply><ci id="S2.SS2.p3.2.m2.3.4.2.2.3.cmml" xref="S2.SS2.p3.2.m2.3.4.2.2.3">𝑖</ci></apply><apply id="S2.SS2.p3.2.m2.3.4.2.3.cmml" xref="S2.SS2.p3.2.m2.3.4.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.3.4.2.3.1.cmml" xref="S2.SS2.p3.2.m2.3.4.2.3">superscript</csymbol><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝜃</ci><ci id="S2.SS2.p3.2.m2.3.4.2.3.3.cmml" xref="S2.SS2.p3.2.m2.3.4.2.3.3">𝑡</ci></apply></apply><apply id="S2.SS2.p3.2.m2.3.4.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3"><times id="S2.SS2.p3.2.m2.3.4.3.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.1"></times><ci id="S2.SS2.p3.2.m2.3.4.3.2.cmml" xref="S2.SS2.p3.2.m2.3.4.3.2">𝑝</ci><apply id="S2.SS2.p3.2.m2.3.4.3.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3.3"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.3.4.3.3.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.3">superscript</csymbol><ci id="S2.SS2.p3.2.m2.2.2.cmml" xref="S2.SS2.p3.2.m2.2.2">𝜃</ci><apply id="S2.SS2.p3.2.m2.3.4.3.3.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3.3.3"><divide id="S2.SS2.p3.2.m2.3.4.3.3.3.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.3.3.1"></divide><cn type="integer" id="S2.SS2.p3.2.m2.3.4.3.3.3.2.cmml" xref="S2.SS2.p3.2.m2.3.4.3.3.3.2">1</cn><ci id="S2.SS2.p3.2.m2.3.4.3.3.3.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3.3.3.3">𝐾</ci></apply></apply><apply id="S2.SS2.p3.2.m2.3.4.3.4.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4"><apply id="S2.SS2.p3.2.m2.3.4.3.4.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.1"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.3.4.3.4.1.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.1">subscript</csymbol><csymbol cd="latexml" id="S2.SS2.p3.2.m2.3.4.3.4.1.2.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.1.2">product</csymbol><apply id="S2.SS2.p3.2.m2.3.4.3.4.1.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.1.3"><neq id="S2.SS2.p3.2.m2.3.4.3.4.1.3.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.1.3.1"></neq><ci id="S2.SS2.p3.2.m2.3.4.3.4.1.3.2.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.1.3.2">𝑗</ci><ci id="S2.SS2.p3.2.m2.3.4.3.4.1.3.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.1.3.3">𝑖</ci></apply></apply><apply id="S2.SS2.p3.2.m2.3.4.3.4.2.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2"><times id="S2.SS2.p3.2.m2.3.4.3.4.2.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2.1"></times><apply id="S2.SS2.p3.2.m2.3.4.3.4.2.2.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2.2"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.3.4.3.4.2.2.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2.2">subscript</csymbol><ci id="S2.SS2.p3.2.m2.3.4.3.4.2.2.2.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2.2.2">𝑠</ci><ci id="S2.SS2.p3.2.m2.3.4.3.4.2.2.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2.2.3">𝑗</ci></apply><apply id="S2.SS2.p3.2.m2.3.4.3.4.2.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2.3"><csymbol cd="ambiguous" id="S2.SS2.p3.2.m2.3.4.3.4.2.3.1.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2.3">superscript</csymbol><ci id="S2.SS2.p3.2.m2.3.3.cmml" xref="S2.SS2.p3.2.m2.3.3">𝜃</ci><ci id="S2.SS2.p3.2.m2.3.4.3.4.2.3.3.cmml" xref="S2.SS2.p3.2.m2.3.4.3.4.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.3c">\tilde{s}_{i}(\theta)^{t}=p(\theta)^{1/K}\prod_{j\neq i}s_{j}(\theta)^{t}</annotation></semantics></math>, obtained by the proxy posterior distribution replacing the current refining factor <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><mi id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><ci id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">i</annotation></semantics></math> by the prior. This constraint effectively forces the server to progress in a CL fashion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, learning from new federated datasets and avoiding catastrophic forgetting of the ones already seen.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para">
<p id="S2.SS2.p4.12" class="ltx_p">The free energy in <a href="#S2.Ex2" title="Proposition 1. ‣ II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> can be optimized using gradient descent and the reparametrization trick <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. For simplicity, we use a Gaussian mean-field approximation of the posterior, hence for server and client parameters, the factorization reads respectively <math id="S2.SS2.p4.1.m1.2" class="ltx_Math" alttext="s_{i}(\bm{\theta})=\prod_{d=1}^{D^{s}}\mathcal{N}(\theta_{d}|\mu_{id}^{s},\sigma_{id}^{s})" display="inline"><semantics id="S2.SS2.p4.1.m1.2a"><mrow id="S2.SS2.p4.1.m1.2.2" xref="S2.SS2.p4.1.m1.2.2.cmml"><mrow id="S2.SS2.p4.1.m1.2.2.3" xref="S2.SS2.p4.1.m1.2.2.3.cmml"><msub id="S2.SS2.p4.1.m1.2.2.3.2" xref="S2.SS2.p4.1.m1.2.2.3.2.cmml"><mi id="S2.SS2.p4.1.m1.2.2.3.2.2" xref="S2.SS2.p4.1.m1.2.2.3.2.2.cmml">s</mi><mi id="S2.SS2.p4.1.m1.2.2.3.2.3" xref="S2.SS2.p4.1.m1.2.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p4.1.m1.2.2.3.1" xref="S2.SS2.p4.1.m1.2.2.3.1.cmml">​</mo><mrow id="S2.SS2.p4.1.m1.2.2.3.3.2" xref="S2.SS2.p4.1.m1.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.p4.1.m1.2.2.3.3.2.1" xref="S2.SS2.p4.1.m1.2.2.3.cmml">(</mo><mi id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.SS2.p4.1.m1.2.2.3.3.2.2" xref="S2.SS2.p4.1.m1.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.SS2.p4.1.m1.2.2.2" xref="S2.SS2.p4.1.m1.2.2.2.cmml">=</mo><mrow id="S2.SS2.p4.1.m1.2.2.1" xref="S2.SS2.p4.1.m1.2.2.1.cmml"><msubsup id="S2.SS2.p4.1.m1.2.2.1.2" xref="S2.SS2.p4.1.m1.2.2.1.2.cmml"><mo id="S2.SS2.p4.1.m1.2.2.1.2.2.2" xref="S2.SS2.p4.1.m1.2.2.1.2.2.2.cmml">∏</mo><mrow id="S2.SS2.p4.1.m1.2.2.1.2.2.3" xref="S2.SS2.p4.1.m1.2.2.1.2.2.3.cmml"><mi id="S2.SS2.p4.1.m1.2.2.1.2.2.3.2" xref="S2.SS2.p4.1.m1.2.2.1.2.2.3.2.cmml">d</mi><mo id="S2.SS2.p4.1.m1.2.2.1.2.2.3.1" xref="S2.SS2.p4.1.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="S2.SS2.p4.1.m1.2.2.1.2.2.3.3" xref="S2.SS2.p4.1.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><msup id="S2.SS2.p4.1.m1.2.2.1.2.3" xref="S2.SS2.p4.1.m1.2.2.1.2.3.cmml"><mi id="S2.SS2.p4.1.m1.2.2.1.2.3.2" xref="S2.SS2.p4.1.m1.2.2.1.2.3.2.cmml">D</mi><mi id="S2.SS2.p4.1.m1.2.2.1.2.3.3" xref="S2.SS2.p4.1.m1.2.2.1.2.3.3.cmml">s</mi></msup></msubsup><mrow id="S2.SS2.p4.1.m1.2.2.1.1" xref="S2.SS2.p4.1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.1.m1.2.2.1.1.3" xref="S2.SS2.p4.1.m1.2.2.1.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.1.m1.2.2.1.1.2" xref="S2.SS2.p4.1.m1.2.2.1.1.2.cmml">​</mo><mrow id="S2.SS2.p4.1.m1.2.2.1.1.1.1" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.2" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.cmml"><msub id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.cmml"><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.2" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.2.cmml">θ</mi><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.3.cmml">d</mi></msub><mo fence="false" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.3.cmml"><msubsup id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mrow id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.2" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mrow id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.2" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.3.cmml">d</mi></mrow><mi id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">s</mi></msubsup></mrow></mrow><mo stretchy="false" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.3" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.2b"><apply id="S2.SS2.p4.1.m1.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2"><eq id="S2.SS2.p4.1.m1.2.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2.2"></eq><apply id="S2.SS2.p4.1.m1.2.2.3.cmml" xref="S2.SS2.p4.1.m1.2.2.3"><times id="S2.SS2.p4.1.m1.2.2.3.1.cmml" xref="S2.SS2.p4.1.m1.2.2.3.1"></times><apply id="S2.SS2.p4.1.m1.2.2.3.2.cmml" xref="S2.SS2.p4.1.m1.2.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.3.2.1.cmml" xref="S2.SS2.p4.1.m1.2.2.3.2">subscript</csymbol><ci id="S2.SS2.p4.1.m1.2.2.3.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2.3.2.2">𝑠</ci><ci id="S2.SS2.p4.1.m1.2.2.3.2.3.cmml" xref="S2.SS2.p4.1.m1.2.2.3.2.3">𝑖</ci></apply><ci id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">𝜽</ci></apply><apply id="S2.SS2.p4.1.m1.2.2.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1"><apply id="S2.SS2.p4.1.m1.2.2.1.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.1.2.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2">superscript</csymbol><apply id="S2.SS2.p4.1.m1.2.2.1.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.1.2.2.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS2.p4.1.m1.2.2.1.2.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.2.2">product</csymbol><apply id="S2.SS2.p4.1.m1.2.2.1.2.2.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.2.3"><eq id="S2.SS2.p4.1.m1.2.2.1.2.2.3.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.2.3.1"></eq><ci id="S2.SS2.p4.1.m1.2.2.1.2.2.3.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.2.3.2">𝑑</ci><cn type="integer" id="S2.SS2.p4.1.m1.2.2.1.2.2.3.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.2.3.3">1</cn></apply></apply><apply id="S2.SS2.p4.1.m1.2.2.1.2.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.1.2.3.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.3">superscript</csymbol><ci id="S2.SS2.p4.1.m1.2.2.1.2.3.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.3.2">𝐷</ci><ci id="S2.SS2.p4.1.m1.2.2.1.2.3.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.2.3.3">𝑠</ci></apply></apply><apply id="S2.SS2.p4.1.m1.2.2.1.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1"><times id="S2.SS2.p4.1.m1.2.2.1.1.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.2"></times><ci id="S2.SS2.p4.1.m1.2.2.1.1.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.3">𝒩</ci><apply id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.3">conditional</csymbol><apply id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.2">𝜃</ci><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.4.3">𝑑</ci></apply><list id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2"><apply id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝜇</ci><apply id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3"><times id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.2">𝜎</ci><apply id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3"><times id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.2">𝑖</ci><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.2.3.3">𝑑</ci></apply></apply><ci id="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.2.3">𝑠</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.2c">s_{i}(\bm{\theta})=\prod_{d=1}^{D^{s}}\mathcal{N}(\theta_{d}|\mu_{id}^{s},\sigma_{id}^{s})</annotation></semantics></math> and <math id="S2.SS2.p4.2.m2.2" class="ltx_Math" alttext="c_{i}(\bm{\phi}_{i})=\prod_{d=1}^{D_{i}^{c}}\mathcal{N}(\phi_{id}|\mu_{id}^{c},\sigma_{id}^{c})" display="inline"><semantics id="S2.SS2.p4.2.m2.2a"><mrow id="S2.SS2.p4.2.m2.2.2" xref="S2.SS2.p4.2.m2.2.2.cmml"><mrow id="S2.SS2.p4.2.m2.1.1.1" xref="S2.SS2.p4.2.m2.1.1.1.cmml"><msub id="S2.SS2.p4.2.m2.1.1.1.3" xref="S2.SS2.p4.2.m2.1.1.1.3.cmml"><mi id="S2.SS2.p4.2.m2.1.1.1.3.2" xref="S2.SS2.p4.2.m2.1.1.1.3.2.cmml">c</mi><mi id="S2.SS2.p4.2.m2.1.1.1.3.3" xref="S2.SS2.p4.2.m2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.1.1.1.2" xref="S2.SS2.p4.2.m2.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.p4.2.m2.1.1.1.1.1" xref="S2.SS2.p4.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p4.2.m2.1.1.1.1.1.2" xref="S2.SS2.p4.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p4.2.m2.1.1.1.1.1.1" xref="S2.SS2.p4.2.m2.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS2.p4.2.m2.1.1.1.1.1.1.2" xref="S2.SS2.p4.2.m2.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.SS2.p4.2.m2.1.1.1.1.1.1.3" xref="S2.SS2.p4.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS2.p4.2.m2.1.1.1.1.1.3" xref="S2.SS2.p4.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.SS2.p4.2.m2.2.2.3" xref="S2.SS2.p4.2.m2.2.2.3.cmml">=</mo><mrow id="S2.SS2.p4.2.m2.2.2.2" xref="S2.SS2.p4.2.m2.2.2.2.cmml"><msubsup id="S2.SS2.p4.2.m2.2.2.2.2" xref="S2.SS2.p4.2.m2.2.2.2.2.cmml"><mo id="S2.SS2.p4.2.m2.2.2.2.2.2.2" xref="S2.SS2.p4.2.m2.2.2.2.2.2.2.cmml">∏</mo><mrow id="S2.SS2.p4.2.m2.2.2.2.2.2.3" xref="S2.SS2.p4.2.m2.2.2.2.2.2.3.cmml"><mi id="S2.SS2.p4.2.m2.2.2.2.2.2.3.2" xref="S2.SS2.p4.2.m2.2.2.2.2.2.3.2.cmml">d</mi><mo id="S2.SS2.p4.2.m2.2.2.2.2.2.3.1" xref="S2.SS2.p4.2.m2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.SS2.p4.2.m2.2.2.2.2.2.3.3" xref="S2.SS2.p4.2.m2.2.2.2.2.2.3.3.cmml">1</mn></mrow><msubsup id="S2.SS2.p4.2.m2.2.2.2.2.3" xref="S2.SS2.p4.2.m2.2.2.2.2.3.cmml"><mi id="S2.SS2.p4.2.m2.2.2.2.2.3.2.2" xref="S2.SS2.p4.2.m2.2.2.2.2.3.2.2.cmml">D</mi><mi id="S2.SS2.p4.2.m2.2.2.2.2.3.2.3" xref="S2.SS2.p4.2.m2.2.2.2.2.3.2.3.cmml">i</mi><mi id="S2.SS2.p4.2.m2.2.2.2.2.3.3" xref="S2.SS2.p4.2.m2.2.2.2.2.3.3.cmml">c</mi></msubsup></msubsup><mrow id="S2.SS2.p4.2.m2.2.2.2.1" xref="S2.SS2.p4.2.m2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.2.m2.2.2.2.1.3" xref="S2.SS2.p4.2.m2.2.2.2.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.2.2.2.1.2" xref="S2.SS2.p4.2.m2.2.2.2.1.2.cmml">​</mo><mrow id="S2.SS2.p4.2.m2.2.2.2.1.1.1" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.cmml"><msub id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.cmml"><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.2.cmml">ϕ</mi><mrow id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.cmml"><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.1" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.1.cmml">​</mo><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.3.cmml">d</mi></mrow></msub><mo fence="false" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.3.cmml"><msubsup id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mrow id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.1" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.3.cmml">c</mi></msubsup><mo id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.3.cmml">,</mo><msubsup id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mrow id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.cmml"><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.2" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.1" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.3.cmml">d</mi></mrow><mi id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.3.cmml">c</mi></msubsup></mrow></mrow><mo stretchy="false" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.3" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.2b"><apply id="S2.SS2.p4.2.m2.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2"><eq id="S2.SS2.p4.2.m2.2.2.3.cmml" xref="S2.SS2.p4.2.m2.2.2.3"></eq><apply id="S2.SS2.p4.2.m2.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1.1"><times id="S2.SS2.p4.2.m2.1.1.1.2.cmml" xref="S2.SS2.p4.2.m2.1.1.1.2"></times><apply id="S2.SS2.p4.2.m2.1.1.1.3.cmml" xref="S2.SS2.p4.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.1.3.1.cmml" xref="S2.SS2.p4.2.m2.1.1.1.3">subscript</csymbol><ci id="S2.SS2.p4.2.m2.1.1.1.3.2.cmml" xref="S2.SS2.p4.2.m2.1.1.1.3.2">𝑐</ci><ci id="S2.SS2.p4.2.m2.1.1.1.3.3.cmml" xref="S2.SS2.p4.2.m2.1.1.1.3.3">𝑖</ci></apply><apply id="S2.SS2.p4.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p4.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.2.m2.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS2.p4.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S2.SS2.p4.2.m2.2.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2"><apply id="S2.SS2.p4.2.m2.2.2.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.2.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2">superscript</csymbol><apply id="S2.SS2.p4.2.m2.2.2.2.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.2.2.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2">subscript</csymbol><csymbol cd="latexml" id="S2.SS2.p4.2.m2.2.2.2.2.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.2.2">product</csymbol><apply id="S2.SS2.p4.2.m2.2.2.2.2.2.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.2.3"><eq id="S2.SS2.p4.2.m2.2.2.2.2.2.3.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.2.3.1"></eq><ci id="S2.SS2.p4.2.m2.2.2.2.2.2.3.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.2.3.2">𝑑</ci><cn type="integer" id="S2.SS2.p4.2.m2.2.2.2.2.2.3.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S2.SS2.p4.2.m2.2.2.2.2.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.2.3.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.3">superscript</csymbol><apply id="S2.SS2.p4.2.m2.2.2.2.2.3.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.2.3.2.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p4.2.m2.2.2.2.2.3.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.3.2.2">𝐷</ci><ci id="S2.SS2.p4.2.m2.2.2.2.2.3.2.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.3.2.3">𝑖</ci></apply><ci id="S2.SS2.p4.2.m2.2.2.2.2.3.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.2.3.3">𝑐</ci></apply></apply><apply id="S2.SS2.p4.2.m2.2.2.2.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1"><times id="S2.SS2.p4.2.m2.2.2.2.1.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.2"></times><ci id="S2.SS2.p4.2.m2.2.2.2.1.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.3">𝒩</ci><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.3">conditional</csymbol><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4">subscript</csymbol><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.2">italic-ϕ</ci><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3"><times id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.1"></times><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.2">𝑖</ci><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.4.3.3">𝑑</ci></apply></apply><list id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2"><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.2">𝜇</ci><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3"><times id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.1"></times><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.2">𝜎</ci><apply id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3"><times id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.1"></times><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.2">𝑖</ci><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.2.3.3">𝑑</ci></apply></apply><ci id="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.p4.2.m2.2.2.2.1.1.1.1.2.2.2.3">𝑐</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.2c">c_{i}(\bm{\phi}_{i})=\prod_{d=1}^{D_{i}^{c}}\mathcal{N}(\phi_{id}|\mu_{id}^{c},\sigma_{id}^{c})</annotation></semantics></math>, where <math id="S2.SS2.p4.3.m3.1" class="ltx_Math" alttext="D^{s}" display="inline"><semantics id="S2.SS2.p4.3.m3.1a"><msup id="S2.SS2.p4.3.m3.1.1" xref="S2.SS2.p4.3.m3.1.1.cmml"><mi id="S2.SS2.p4.3.m3.1.1.2" xref="S2.SS2.p4.3.m3.1.1.2.cmml">D</mi><mi id="S2.SS2.p4.3.m3.1.1.3" xref="S2.SS2.p4.3.m3.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.3.m3.1b"><apply id="S2.SS2.p4.3.m3.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.3.m3.1.1.1.cmml" xref="S2.SS2.p4.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p4.3.m3.1.1.2.cmml" xref="S2.SS2.p4.3.m3.1.1.2">𝐷</ci><ci id="S2.SS2.p4.3.m3.1.1.3.cmml" xref="S2.SS2.p4.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.3.m3.1c">D^{s}</annotation></semantics></math> and <math id="S2.SS2.p4.4.m4.1" class="ltx_Math" alttext="\{D_{i}^{c}\}_{i=0}^{K}" display="inline"><semantics id="S2.SS2.p4.4.m4.1a"><msubsup id="S2.SS2.p4.4.m4.1.1" xref="S2.SS2.p4.4.m4.1.1.cmml"><mrow id="S2.SS2.p4.4.m4.1.1.1.1.1" xref="S2.SS2.p4.4.m4.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p4.4.m4.1.1.1.1.1.2" xref="S2.SS2.p4.4.m4.1.1.1.1.2.cmml">{</mo><msubsup id="S2.SS2.p4.4.m4.1.1.1.1.1.1" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1.cmml"><mi id="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.2" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.2.cmml">D</mi><mi id="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.3" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.SS2.p4.4.m4.1.1.1.1.1.1.3" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1.3.cmml">c</mi></msubsup><mo stretchy="false" id="S2.SS2.p4.4.m4.1.1.1.1.1.3" xref="S2.SS2.p4.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.SS2.p4.4.m4.1.1.1.3" xref="S2.SS2.p4.4.m4.1.1.1.3.cmml"><mi id="S2.SS2.p4.4.m4.1.1.1.3.2" xref="S2.SS2.p4.4.m4.1.1.1.3.2.cmml">i</mi><mo id="S2.SS2.p4.4.m4.1.1.1.3.1" xref="S2.SS2.p4.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S2.SS2.p4.4.m4.1.1.1.3.3" xref="S2.SS2.p4.4.m4.1.1.1.3.3.cmml">0</mn></mrow><mi id="S2.SS2.p4.4.m4.1.1.3" xref="S2.SS2.p4.4.m4.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.4.m4.1b"><apply id="S2.SS2.p4.4.m4.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.1.1.2.cmml" xref="S2.SS2.p4.4.m4.1.1">superscript</csymbol><apply id="S2.SS2.p4.4.m4.1.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.1.1.1.2.cmml" xref="S2.SS2.p4.4.m4.1.1">subscript</csymbol><set id="S2.SS2.p4.4.m4.1.1.1.1.2.cmml" xref="S2.SS2.p4.4.m4.1.1.1.1.1"><apply id="S2.SS2.p4.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.2">𝐷</ci><ci id="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.p4.4.m4.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p4.4.m4.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S2.SS2.p4.4.m4.1.1.1.3.cmml" xref="S2.SS2.p4.4.m4.1.1.1.3"><eq id="S2.SS2.p4.4.m4.1.1.1.3.1.cmml" xref="S2.SS2.p4.4.m4.1.1.1.3.1"></eq><ci id="S2.SS2.p4.4.m4.1.1.1.3.2.cmml" xref="S2.SS2.p4.4.m4.1.1.1.3.2">𝑖</ci><cn type="integer" id="S2.SS2.p4.4.m4.1.1.1.3.3.cmml" xref="S2.SS2.p4.4.m4.1.1.1.3.3">0</cn></apply></apply><ci id="S2.SS2.p4.4.m4.1.1.3.cmml" xref="S2.SS2.p4.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.4.m4.1c">\{D_{i}^{c}\}_{i=0}^{K}</annotation></semantics></math> are respectively the total number of parameters of the server and client networks. A depiction of the full graphical model of the approximated variational posterior is given in <a href="#S2.F1.sf2" title="In Figure 1 ‣ II-A The Bayesian network ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1b</span></a>.
The pseudo-code of <span id="S2.SS2.p4.12.1" class="ltx_text ltx_font_typewriter">VIRTUAL</span> is described in <a href="#alg1" title="In II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Algorithm</span> <span class="ltx_text ltx_ref_tag">1</span></a>. The structure of the algorithm is equivalent to the FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> and the FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> algorithms.
At each round, a subset of clients is selected and trained with the local free energy given in <a href="#S2.Ex2" title="Proposition 1. ‣ II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a>.
The client update is then computed as the ratio of the client parameter distribution before and after the training. The ratio corresponds to the simple difference of the sufficient statistics in the case of exponential family distributions (see <a href="#A2" title="Appendix B The Gaussian case ‣ IV-F Inducing sparse updates ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a>), that hence is equivalent to the delta computation in the FedAvg setting. In the general setting, it can be computed as the un-normalized pdf <math id="S2.SS2.p4.5.m5.4" class="ltx_Math" alttext="\Delta_{i}=\frac{s_{i}^{(t)}(\bm{\theta})}{s_{i}^{(t-1)}(\bm{\theta})}" display="inline"><semantics id="S2.SS2.p4.5.m5.4a"><mrow id="S2.SS2.p4.5.m5.4.5" xref="S2.SS2.p4.5.m5.4.5.cmml"><msub id="S2.SS2.p4.5.m5.4.5.2" xref="S2.SS2.p4.5.m5.4.5.2.cmml"><mi mathvariant="normal" id="S2.SS2.p4.5.m5.4.5.2.2" xref="S2.SS2.p4.5.m5.4.5.2.2.cmml">Δ</mi><mi id="S2.SS2.p4.5.m5.4.5.2.3" xref="S2.SS2.p4.5.m5.4.5.2.3.cmml">i</mi></msub><mo id="S2.SS2.p4.5.m5.4.5.1" xref="S2.SS2.p4.5.m5.4.5.1.cmml">=</mo><mfrac id="S2.SS2.p4.5.m5.4.4" xref="S2.SS2.p4.5.m5.4.4.cmml"><mrow id="S2.SS2.p4.5.m5.2.2.2" xref="S2.SS2.p4.5.m5.2.2.2.cmml"><msubsup id="S2.SS2.p4.5.m5.2.2.2.4" xref="S2.SS2.p4.5.m5.2.2.2.4.cmml"><mi id="S2.SS2.p4.5.m5.2.2.2.4.2.2" xref="S2.SS2.p4.5.m5.2.2.2.4.2.2.cmml">s</mi><mi id="S2.SS2.p4.5.m5.2.2.2.4.2.3" xref="S2.SS2.p4.5.m5.2.2.2.4.2.3.cmml">i</mi><mrow id="S2.SS2.p4.5.m5.1.1.1.1.1.3" xref="S2.SS2.p4.5.m5.2.2.2.4.cmml"><mo stretchy="false" id="S2.SS2.p4.5.m5.1.1.1.1.1.3.1" xref="S2.SS2.p4.5.m5.2.2.2.4.cmml">(</mo><mi id="S2.SS2.p4.5.m5.1.1.1.1.1.1" xref="S2.SS2.p4.5.m5.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S2.SS2.p4.5.m5.1.1.1.1.1.3.2" xref="S2.SS2.p4.5.m5.2.2.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.SS2.p4.5.m5.2.2.2.3" xref="S2.SS2.p4.5.m5.2.2.2.3.cmml">​</mo><mrow id="S2.SS2.p4.5.m5.2.2.2.5.2" xref="S2.SS2.p4.5.m5.2.2.2.cmml"><mo stretchy="false" id="S2.SS2.p4.5.m5.2.2.2.5.2.1" xref="S2.SS2.p4.5.m5.2.2.2.cmml">(</mo><mi id="S2.SS2.p4.5.m5.2.2.2.2" xref="S2.SS2.p4.5.m5.2.2.2.2.cmml">𝜽</mi><mo stretchy="false" id="S2.SS2.p4.5.m5.2.2.2.5.2.2" xref="S2.SS2.p4.5.m5.2.2.2.cmml">)</mo></mrow></mrow><mrow id="S2.SS2.p4.5.m5.4.4.4" xref="S2.SS2.p4.5.m5.4.4.4.cmml"><msubsup id="S2.SS2.p4.5.m5.4.4.4.4" xref="S2.SS2.p4.5.m5.4.4.4.4.cmml"><mi id="S2.SS2.p4.5.m5.4.4.4.4.2.2" xref="S2.SS2.p4.5.m5.4.4.4.4.2.2.cmml">s</mi><mi id="S2.SS2.p4.5.m5.4.4.4.4.2.3" xref="S2.SS2.p4.5.m5.4.4.4.4.2.3.cmml">i</mi><mrow id="S2.SS2.p4.5.m5.3.3.3.1.1.1" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p4.5.m5.3.3.3.1.1.1.2" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.p4.5.m5.3.3.3.1.1.1.1" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.cmml"><mi id="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.2" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.2.cmml">t</mi><mo id="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.1" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.1.cmml">−</mo><mn id="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.3" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS2.p4.5.m5.3.3.3.1.1.1.3" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.SS2.p4.5.m5.4.4.4.3" xref="S2.SS2.p4.5.m5.4.4.4.3.cmml">​</mo><mrow id="S2.SS2.p4.5.m5.4.4.4.5.2" xref="S2.SS2.p4.5.m5.4.4.4.cmml"><mo stretchy="false" id="S2.SS2.p4.5.m5.4.4.4.5.2.1" xref="S2.SS2.p4.5.m5.4.4.4.cmml">(</mo><mi id="S2.SS2.p4.5.m5.4.4.4.2" xref="S2.SS2.p4.5.m5.4.4.4.2.cmml">𝜽</mi><mo stretchy="false" id="S2.SS2.p4.5.m5.4.4.4.5.2.2" xref="S2.SS2.p4.5.m5.4.4.4.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.5.m5.4b"><apply id="S2.SS2.p4.5.m5.4.5.cmml" xref="S2.SS2.p4.5.m5.4.5"><eq id="S2.SS2.p4.5.m5.4.5.1.cmml" xref="S2.SS2.p4.5.m5.4.5.1"></eq><apply id="S2.SS2.p4.5.m5.4.5.2.cmml" xref="S2.SS2.p4.5.m5.4.5.2"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m5.4.5.2.1.cmml" xref="S2.SS2.p4.5.m5.4.5.2">subscript</csymbol><ci id="S2.SS2.p4.5.m5.4.5.2.2.cmml" xref="S2.SS2.p4.5.m5.4.5.2.2">Δ</ci><ci id="S2.SS2.p4.5.m5.4.5.2.3.cmml" xref="S2.SS2.p4.5.m5.4.5.2.3">𝑖</ci></apply><apply id="S2.SS2.p4.5.m5.4.4.cmml" xref="S2.SS2.p4.5.m5.4.4"><divide id="S2.SS2.p4.5.m5.4.4.5.cmml" xref="S2.SS2.p4.5.m5.4.4"></divide><apply id="S2.SS2.p4.5.m5.2.2.2.cmml" xref="S2.SS2.p4.5.m5.2.2.2"><times id="S2.SS2.p4.5.m5.2.2.2.3.cmml" xref="S2.SS2.p4.5.m5.2.2.2.3"></times><apply id="S2.SS2.p4.5.m5.2.2.2.4.cmml" xref="S2.SS2.p4.5.m5.2.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m5.2.2.2.4.1.cmml" xref="S2.SS2.p4.5.m5.2.2.2.4">superscript</csymbol><apply id="S2.SS2.p4.5.m5.2.2.2.4.2.cmml" xref="S2.SS2.p4.5.m5.2.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m5.2.2.2.4.2.1.cmml" xref="S2.SS2.p4.5.m5.2.2.2.4">subscript</csymbol><ci id="S2.SS2.p4.5.m5.2.2.2.4.2.2.cmml" xref="S2.SS2.p4.5.m5.2.2.2.4.2.2">𝑠</ci><ci id="S2.SS2.p4.5.m5.2.2.2.4.2.3.cmml" xref="S2.SS2.p4.5.m5.2.2.2.4.2.3">𝑖</ci></apply><ci id="S2.SS2.p4.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p4.5.m5.1.1.1.1.1.1">𝑡</ci></apply><ci id="S2.SS2.p4.5.m5.2.2.2.2.cmml" xref="S2.SS2.p4.5.m5.2.2.2.2">𝜽</ci></apply><apply id="S2.SS2.p4.5.m5.4.4.4.cmml" xref="S2.SS2.p4.5.m5.4.4.4"><times id="S2.SS2.p4.5.m5.4.4.4.3.cmml" xref="S2.SS2.p4.5.m5.4.4.4.3"></times><apply id="S2.SS2.p4.5.m5.4.4.4.4.cmml" xref="S2.SS2.p4.5.m5.4.4.4.4"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m5.4.4.4.4.1.cmml" xref="S2.SS2.p4.5.m5.4.4.4.4">superscript</csymbol><apply id="S2.SS2.p4.5.m5.4.4.4.4.2.cmml" xref="S2.SS2.p4.5.m5.4.4.4.4"><csymbol cd="ambiguous" id="S2.SS2.p4.5.m5.4.4.4.4.2.1.cmml" xref="S2.SS2.p4.5.m5.4.4.4.4">subscript</csymbol><ci id="S2.SS2.p4.5.m5.4.4.4.4.2.2.cmml" xref="S2.SS2.p4.5.m5.4.4.4.4.2.2">𝑠</ci><ci id="S2.SS2.p4.5.m5.4.4.4.4.2.3.cmml" xref="S2.SS2.p4.5.m5.4.4.4.4.2.3">𝑖</ci></apply><apply id="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.cmml" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1"><minus id="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.1.cmml" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.1"></minus><ci id="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.2.cmml" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.2">𝑡</ci><cn type="integer" id="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.3.cmml" xref="S2.SS2.p4.5.m5.3.3.3.1.1.1.1.3">1</cn></apply></apply><ci id="S2.SS2.p4.5.m5.4.4.4.2.cmml" xref="S2.SS2.p4.5.m5.4.4.4.2">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.5.m5.4c">\Delta_{i}=\frac{s_{i}^{(t)}(\bm{\theta})}{s_{i}^{(t-1)}(\bm{\theta})}</annotation></semantics></math>.
The client <math id="S2.SS2.p4.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.p4.6.m6.1a"><mi id="S2.SS2.p4.6.m6.1.1" xref="S2.SS2.p4.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.6.m6.1b"><ci id="S2.SS2.p4.6.m6.1.1.cmml" xref="S2.SS2.p4.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.6.m6.1c">i</annotation></semantics></math> communicates the delta <math id="S2.SS2.p4.7.m7.1" class="ltx_Math" alttext="\Delta_{i}" display="inline"><semantics id="S2.SS2.p4.7.m7.1a"><msub id="S2.SS2.p4.7.m7.1.1" xref="S2.SS2.p4.7.m7.1.1.cmml"><mi mathvariant="normal" id="S2.SS2.p4.7.m7.1.1.2" xref="S2.SS2.p4.7.m7.1.1.2.cmml">Δ</mi><mi id="S2.SS2.p4.7.m7.1.1.3" xref="S2.SS2.p4.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.7.m7.1b"><apply id="S2.SS2.p4.7.m7.1.1.cmml" xref="S2.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.7.m7.1.1.1.cmml" xref="S2.SS2.p4.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.p4.7.m7.1.1.2.cmml" xref="S2.SS2.p4.7.m7.1.1.2">Δ</ci><ci id="S2.SS2.p4.7.m7.1.1.3.cmml" xref="S2.SS2.p4.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.7.m7.1c">\Delta_{i}</annotation></semantics></math> to the main server, that aggregates all the received updates into a single update <math id="S2.SS2.p4.8.m8.1" class="ltx_Math" alttext="\Delta=\prod_{i\in\mathcal{C}_{t}}\Delta_{i}" display="inline"><semantics id="S2.SS2.p4.8.m8.1a"><mrow id="S2.SS2.p4.8.m8.1.1" xref="S2.SS2.p4.8.m8.1.1.cmml"><mi mathvariant="normal" id="S2.SS2.p4.8.m8.1.1.2" xref="S2.SS2.p4.8.m8.1.1.2.cmml">Δ</mi><mo rspace="0.111em" id="S2.SS2.p4.8.m8.1.1.1" xref="S2.SS2.p4.8.m8.1.1.1.cmml">=</mo><mrow id="S2.SS2.p4.8.m8.1.1.3" xref="S2.SS2.p4.8.m8.1.1.3.cmml"><msub id="S2.SS2.p4.8.m8.1.1.3.1" xref="S2.SS2.p4.8.m8.1.1.3.1.cmml"><mo id="S2.SS2.p4.8.m8.1.1.3.1.2" xref="S2.SS2.p4.8.m8.1.1.3.1.2.cmml">∏</mo><mrow id="S2.SS2.p4.8.m8.1.1.3.1.3" xref="S2.SS2.p4.8.m8.1.1.3.1.3.cmml"><mi id="S2.SS2.p4.8.m8.1.1.3.1.3.2" xref="S2.SS2.p4.8.m8.1.1.3.1.3.2.cmml">i</mi><mo id="S2.SS2.p4.8.m8.1.1.3.1.3.1" xref="S2.SS2.p4.8.m8.1.1.3.1.3.1.cmml">∈</mo><msub id="S2.SS2.p4.8.m8.1.1.3.1.3.3" xref="S2.SS2.p4.8.m8.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p4.8.m8.1.1.3.1.3.3.2" xref="S2.SS2.p4.8.m8.1.1.3.1.3.3.2.cmml">𝒞</mi><mi id="S2.SS2.p4.8.m8.1.1.3.1.3.3.3" xref="S2.SS2.p4.8.m8.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><msub id="S2.SS2.p4.8.m8.1.1.3.2" xref="S2.SS2.p4.8.m8.1.1.3.2.cmml"><mi mathvariant="normal" id="S2.SS2.p4.8.m8.1.1.3.2.2" xref="S2.SS2.p4.8.m8.1.1.3.2.2.cmml">Δ</mi><mi id="S2.SS2.p4.8.m8.1.1.3.2.3" xref="S2.SS2.p4.8.m8.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.8.m8.1b"><apply id="S2.SS2.p4.8.m8.1.1.cmml" xref="S2.SS2.p4.8.m8.1.1"><eq id="S2.SS2.p4.8.m8.1.1.1.cmml" xref="S2.SS2.p4.8.m8.1.1.1"></eq><ci id="S2.SS2.p4.8.m8.1.1.2.cmml" xref="S2.SS2.p4.8.m8.1.1.2">Δ</ci><apply id="S2.SS2.p4.8.m8.1.1.3.cmml" xref="S2.SS2.p4.8.m8.1.1.3"><apply id="S2.SS2.p4.8.m8.1.1.3.1.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1"><csymbol cd="ambiguous" id="S2.SS2.p4.8.m8.1.1.3.1.1.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S2.SS2.p4.8.m8.1.1.3.1.2.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1.2">product</csymbol><apply id="S2.SS2.p4.8.m8.1.1.3.1.3.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1.3"><in id="S2.SS2.p4.8.m8.1.1.3.1.3.1.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1.3.1"></in><ci id="S2.SS2.p4.8.m8.1.1.3.1.3.2.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1.3.2">𝑖</ci><apply id="S2.SS2.p4.8.m8.1.1.3.1.3.3.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p4.8.m8.1.1.3.1.3.3.1.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1.3.3">subscript</csymbol><ci id="S2.SS2.p4.8.m8.1.1.3.1.3.3.2.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1.3.3.2">𝒞</ci><ci id="S2.SS2.p4.8.m8.1.1.3.1.3.3.3.cmml" xref="S2.SS2.p4.8.m8.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S2.SS2.p4.8.m8.1.1.3.2.cmml" xref="S2.SS2.p4.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p4.8.m8.1.1.3.2.1.cmml" xref="S2.SS2.p4.8.m8.1.1.3.2">subscript</csymbol><ci id="S2.SS2.p4.8.m8.1.1.3.2.2.cmml" xref="S2.SS2.p4.8.m8.1.1.3.2.2">Δ</ci><ci id="S2.SS2.p4.8.m8.1.1.3.2.3.cmml" xref="S2.SS2.p4.8.m8.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.8.m8.1c">\Delta=\prod_{i\in\mathcal{C}_{t}}\Delta_{i}</annotation></semantics></math>.
A major difference with the typical non-MTL setting, where the new server model is given by averaging all selected active clients at any given round, in our case we aggregate <em id="S2.SS2.p4.12.2" class="ltx_emph ltx_font_italic">updates</em> and the information of non-active clients is effectively retained in the server posterior.
In the simple case of mean-field Gaussian approximation of the posterior distribution, the delta computation and the aggregation easily generalize the subtraction and average used in FedAvg, taking into account the uncertainty in the parameters represented by the standard deviation of the learned Gaussian (see <a href="#A2" title="Appendix B The Gaussian case ‣ IV-F Inducing sparse updates ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">B</span></a>). Notice that similarly to <span id="S2.SS2.p4.12.3" class="ltx_text ltx_font_typewriter">FedAvg</span>, privacy is preserved since at any time the server can get access only to the overall posterior distribution <math id="S2.SS2.p4.9.m9.1" class="ltx_Math" alttext="s(\bm{\theta})" display="inline"><semantics id="S2.SS2.p4.9.m9.1a"><mrow id="S2.SS2.p4.9.m9.1.2" xref="S2.SS2.p4.9.m9.1.2.cmml"><mi id="S2.SS2.p4.9.m9.1.2.2" xref="S2.SS2.p4.9.m9.1.2.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.9.m9.1.2.1" xref="S2.SS2.p4.9.m9.1.2.1.cmml">​</mo><mrow id="S2.SS2.p4.9.m9.1.2.3.2" xref="S2.SS2.p4.9.m9.1.2.cmml"><mo stretchy="false" id="S2.SS2.p4.9.m9.1.2.3.2.1" xref="S2.SS2.p4.9.m9.1.2.cmml">(</mo><mi id="S2.SS2.p4.9.m9.1.1" xref="S2.SS2.p4.9.m9.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.SS2.p4.9.m9.1.2.3.2.2" xref="S2.SS2.p4.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.9.m9.1b"><apply id="S2.SS2.p4.9.m9.1.2.cmml" xref="S2.SS2.p4.9.m9.1.2"><times id="S2.SS2.p4.9.m9.1.2.1.cmml" xref="S2.SS2.p4.9.m9.1.2.1"></times><ci id="S2.SS2.p4.9.m9.1.2.2.cmml" xref="S2.SS2.p4.9.m9.1.2.2">𝑠</ci><ci id="S2.SS2.p4.9.m9.1.1.cmml" xref="S2.SS2.p4.9.m9.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.9.m9.1c">s(\bm{\theta})</annotation></semantics></math> and to the aggregated update <math id="S2.SS2.p4.10.m10.1" class="ltx_Math" alttext="\Delta(\bm{\theta})" display="inline"><semantics id="S2.SS2.p4.10.m10.1a"><mrow id="S2.SS2.p4.10.m10.1.2" xref="S2.SS2.p4.10.m10.1.2.cmml"><mi mathvariant="normal" id="S2.SS2.p4.10.m10.1.2.2" xref="S2.SS2.p4.10.m10.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p4.10.m10.1.2.1" xref="S2.SS2.p4.10.m10.1.2.1.cmml">​</mo><mrow id="S2.SS2.p4.10.m10.1.2.3.2" xref="S2.SS2.p4.10.m10.1.2.cmml"><mo stretchy="false" id="S2.SS2.p4.10.m10.1.2.3.2.1" xref="S2.SS2.p4.10.m10.1.2.cmml">(</mo><mi id="S2.SS2.p4.10.m10.1.1" xref="S2.SS2.p4.10.m10.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.SS2.p4.10.m10.1.2.3.2.2" xref="S2.SS2.p4.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.10.m10.1b"><apply id="S2.SS2.p4.10.m10.1.2.cmml" xref="S2.SS2.p4.10.m10.1.2"><times id="S2.SS2.p4.10.m10.1.2.1.cmml" xref="S2.SS2.p4.10.m10.1.2.1"></times><ci id="S2.SS2.p4.10.m10.1.2.2.cmml" xref="S2.SS2.p4.10.m10.1.2.2">Δ</ci><ci id="S2.SS2.p4.10.m10.1.1.cmml" xref="S2.SS2.p4.10.m10.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.10.m10.1c">\Delta(\bm{\theta})</annotation></semantics></math>, and never to the individual factor <math id="S2.SS2.p4.11.m11.1" class="ltx_Math" alttext="s_{i}(\bm{\theta})" display="inline"><semantics id="S2.SS2.p4.11.m11.1a"><mrow id="S2.SS2.p4.11.m11.1.2" xref="S2.SS2.p4.11.m11.1.2.cmml"><msub id="S2.SS2.p4.11.m11.1.2.2" xref="S2.SS2.p4.11.m11.1.2.2.cmml"><mi id="S2.SS2.p4.11.m11.1.2.2.2" xref="S2.SS2.p4.11.m11.1.2.2.2.cmml">s</mi><mi id="S2.SS2.p4.11.m11.1.2.2.3" xref="S2.SS2.p4.11.m11.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p4.11.m11.1.2.1" xref="S2.SS2.p4.11.m11.1.2.1.cmml">​</mo><mrow id="S2.SS2.p4.11.m11.1.2.3.2" xref="S2.SS2.p4.11.m11.1.2.cmml"><mo stretchy="false" id="S2.SS2.p4.11.m11.1.2.3.2.1" xref="S2.SS2.p4.11.m11.1.2.cmml">(</mo><mi id="S2.SS2.p4.11.m11.1.1" xref="S2.SS2.p4.11.m11.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.SS2.p4.11.m11.1.2.3.2.2" xref="S2.SS2.p4.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.11.m11.1b"><apply id="S2.SS2.p4.11.m11.1.2.cmml" xref="S2.SS2.p4.11.m11.1.2"><times id="S2.SS2.p4.11.m11.1.2.1.cmml" xref="S2.SS2.p4.11.m11.1.2.1"></times><apply id="S2.SS2.p4.11.m11.1.2.2.cmml" xref="S2.SS2.p4.11.m11.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.11.m11.1.2.2.1.cmml" xref="S2.SS2.p4.11.m11.1.2.2">subscript</csymbol><ci id="S2.SS2.p4.11.m11.1.2.2.2.cmml" xref="S2.SS2.p4.11.m11.1.2.2.2">𝑠</ci><ci id="S2.SS2.p4.11.m11.1.2.2.3.cmml" xref="S2.SS2.p4.11.m11.1.2.2.3">𝑖</ci></apply><ci id="S2.SS2.p4.11.m11.1.1.cmml" xref="S2.SS2.p4.11.m11.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.11.m11.1c">s_{i}(\bm{\theta})</annotation></semantics></math> and <math id="S2.SS2.p4.12.m12.1" class="ltx_Math" alttext="c_{i}(\bm{\theta})" display="inline"><semantics id="S2.SS2.p4.12.m12.1a"><mrow id="S2.SS2.p4.12.m12.1.2" xref="S2.SS2.p4.12.m12.1.2.cmml"><msub id="S2.SS2.p4.12.m12.1.2.2" xref="S2.SS2.p4.12.m12.1.2.2.cmml"><mi id="S2.SS2.p4.12.m12.1.2.2.2" xref="S2.SS2.p4.12.m12.1.2.2.2.cmml">c</mi><mi id="S2.SS2.p4.12.m12.1.2.2.3" xref="S2.SS2.p4.12.m12.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p4.12.m12.1.2.1" xref="S2.SS2.p4.12.m12.1.2.1.cmml">​</mo><mrow id="S2.SS2.p4.12.m12.1.2.3.2" xref="S2.SS2.p4.12.m12.1.2.cmml"><mo stretchy="false" id="S2.SS2.p4.12.m12.1.2.3.2.1" xref="S2.SS2.p4.12.m12.1.2.cmml">(</mo><mi id="S2.SS2.p4.12.m12.1.1" xref="S2.SS2.p4.12.m12.1.1.cmml">𝜽</mi><mo stretchy="false" id="S2.SS2.p4.12.m12.1.2.3.2.2" xref="S2.SS2.p4.12.m12.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.12.m12.1b"><apply id="S2.SS2.p4.12.m12.1.2.cmml" xref="S2.SS2.p4.12.m12.1.2"><times id="S2.SS2.p4.12.m12.1.2.1.cmml" xref="S2.SS2.p4.12.m12.1.2.1"></times><apply id="S2.SS2.p4.12.m12.1.2.2.cmml" xref="S2.SS2.p4.12.m12.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p4.12.m12.1.2.2.1.cmml" xref="S2.SS2.p4.12.m12.1.2.2">subscript</csymbol><ci id="S2.SS2.p4.12.m12.1.2.2.2.cmml" xref="S2.SS2.p4.12.m12.1.2.2.2">𝑐</ci><ci id="S2.SS2.p4.12.m12.1.2.2.3.cmml" xref="S2.SS2.p4.12.m12.1.2.2.3">𝑖</ci></apply><ci id="S2.SS2.p4.12.m12.1.1.cmml" xref="S2.SS2.p4.12.m12.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.12.m12.1c">c_{i}(\bm{\theta})</annotation></semantics></math>, that are visible only to the respective client.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.4.2" class="ltx_text ltx_font_typewriter">VIRTUAL</span></figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Input:</span> datasets <math id="alg1.l1.m1.3" class="ltx_Math" alttext="\{\mathcal{D}_{1},\dots,\mathcal{D}_{k}\}" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3.2" xref="alg1.l1.m1.3.3.3.cmml"><mo stretchy="false" id="alg1.l1.m1.3.3.2.3" xref="alg1.l1.m1.3.3.3.cmml">{</mo><msub id="alg1.l1.m1.2.2.1.1" xref="alg1.l1.m1.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.2.2.1.1.2" xref="alg1.l1.m1.2.2.1.1.2.cmml">𝒟</mi><mn id="alg1.l1.m1.2.2.1.1.3" xref="alg1.l1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l1.m1.3.3.2.4" xref="alg1.l1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">…</mi><mo id="alg1.l1.m1.3.3.2.5" xref="alg1.l1.m1.3.3.3.cmml">,</mo><msub id="alg1.l1.m1.3.3.2.2" xref="alg1.l1.m1.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.3.3.2.2.2" xref="alg1.l1.m1.3.3.2.2.2.cmml">𝒟</mi><mi id="alg1.l1.m1.3.3.2.2.3" xref="alg1.l1.m1.3.3.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l1.m1.3.3.2.6" xref="alg1.l1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><set id="alg1.l1.m1.3.3.3.cmml" xref="alg1.l1.m1.3.3.2"><apply id="alg1.l1.m1.2.2.1.1.cmml" xref="alg1.l1.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.2">𝒟</ci><cn type="integer" id="alg1.l1.m1.2.2.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.3">1</cn></apply><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">…</ci><apply id="alg1.l1.m1.3.3.2.2.cmml" xref="alg1.l1.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.2.2.1.cmml" xref="alg1.l1.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l1.m1.3.3.2.2.2.cmml" xref="alg1.l1.m1.3.3.2.2.2">𝒟</ci><ci id="alg1.l1.m1.3.3.2.2.3.cmml" xref="alg1.l1.m1.3.3.2.2.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\{\mathcal{D}_{1},\dots,\mathcal{D}_{k}\}</annotation></semantics></math>, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">T</annotation></semantics></math> number of rounds, priors <math id="alg1.l1.m3.3" class="ltx_Math" alttext="p(\bm{\theta}),\{p(\bm{\phi}_{i})\}_{i=1}^{K}" display="inline"><semantics id="alg1.l1.m3.3a"><mrow id="alg1.l1.m3.3.3.2" xref="alg1.l1.m3.3.3.3.cmml"><mrow id="alg1.l1.m3.2.2.1.1" xref="alg1.l1.m3.2.2.1.1.cmml"><mi id="alg1.l1.m3.2.2.1.1.2" xref="alg1.l1.m3.2.2.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m3.2.2.1.1.1" xref="alg1.l1.m3.2.2.1.1.1.cmml">​</mo><mrow id="alg1.l1.m3.2.2.1.1.3.2" xref="alg1.l1.m3.2.2.1.1.cmml"><mo stretchy="false" id="alg1.l1.m3.2.2.1.1.3.2.1" xref="alg1.l1.m3.2.2.1.1.cmml">(</mo><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">𝜽</mi><mo stretchy="false" id="alg1.l1.m3.2.2.1.1.3.2.2" xref="alg1.l1.m3.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l1.m3.3.3.2.3" xref="alg1.l1.m3.3.3.3.cmml">,</mo><msubsup id="alg1.l1.m3.3.3.2.2" xref="alg1.l1.m3.3.3.2.2.cmml"><mrow id="alg1.l1.m3.3.3.2.2.1.1.1" xref="alg1.l1.m3.3.3.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l1.m3.3.3.2.2.1.1.1.2" xref="alg1.l1.m3.3.3.2.2.1.1.2.cmml">{</mo><mrow id="alg1.l1.m3.3.3.2.2.1.1.1.1" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.cmml"><mi id="alg1.l1.m3.3.3.2.2.1.1.1.1.3" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m3.3.3.2.2.1.1.1.1.2" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.2" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.2" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.3" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.3" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l1.m3.3.3.2.2.1.1.1.3" xref="alg1.l1.m3.3.3.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg1.l1.m3.3.3.2.2.1.3" xref="alg1.l1.m3.3.3.2.2.1.3.cmml"><mi id="alg1.l1.m3.3.3.2.2.1.3.2" xref="alg1.l1.m3.3.3.2.2.1.3.2.cmml">i</mi><mo id="alg1.l1.m3.3.3.2.2.1.3.1" xref="alg1.l1.m3.3.3.2.2.1.3.1.cmml">=</mo><mn id="alg1.l1.m3.3.3.2.2.1.3.3" xref="alg1.l1.m3.3.3.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg1.l1.m3.3.3.2.2.3" xref="alg1.l1.m3.3.3.2.2.3.cmml">K</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.3b"><list id="alg1.l1.m3.3.3.3.cmml" xref="alg1.l1.m3.3.3.2"><apply id="alg1.l1.m3.2.2.1.1.cmml" xref="alg1.l1.m3.2.2.1.1"><times id="alg1.l1.m3.2.2.1.1.1.cmml" xref="alg1.l1.m3.2.2.1.1.1"></times><ci id="alg1.l1.m3.2.2.1.1.2.cmml" xref="alg1.l1.m3.2.2.1.1.2">𝑝</ci><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝜽</ci></apply><apply id="alg1.l1.m3.3.3.2.2.cmml" xref="alg1.l1.m3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m3.3.3.2.2.2.cmml" xref="alg1.l1.m3.3.3.2.2">superscript</csymbol><apply id="alg1.l1.m3.3.3.2.2.1.cmml" xref="alg1.l1.m3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m3.3.3.2.2.1.2.cmml" xref="alg1.l1.m3.3.3.2.2">subscript</csymbol><set id="alg1.l1.m3.3.3.2.2.1.1.2.cmml" xref="alg1.l1.m3.3.3.2.2.1.1.1"><apply id="alg1.l1.m3.3.3.2.2.1.1.1.1.cmml" xref="alg1.l1.m3.3.3.2.2.1.1.1.1"><times id="alg1.l1.m3.3.3.2.2.1.1.1.1.2.cmml" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.2"></times><ci id="alg1.l1.m3.3.3.2.2.1.1.1.1.3.cmml" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.3">𝑝</ci><apply id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m3.3.3.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></set><apply id="alg1.l1.m3.3.3.2.2.1.3.cmml" xref="alg1.l1.m3.3.3.2.2.1.3"><eq id="alg1.l1.m3.3.3.2.2.1.3.1.cmml" xref="alg1.l1.m3.3.3.2.2.1.3.1"></eq><ci id="alg1.l1.m3.3.3.2.2.1.3.2.cmml" xref="alg1.l1.m3.3.3.2.2.1.3.2">𝑖</ci><cn type="integer" id="alg1.l1.m3.3.3.2.2.1.3.3.cmml" xref="alg1.l1.m3.3.3.2.2.1.3.3">1</cn></apply></apply><ci id="alg1.l1.m3.3.3.2.2.3.cmml" xref="alg1.l1.m3.3.3.2.2.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.3c">p(\bm{\theta}),\{p(\bm{\phi}_{i})\}_{i=1}^{K}</annotation></semantics></math>, <math id="alg1.l1.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">C</annotation></semantics></math> number of refined clients per round, <math id="alg1.l1.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">E</annotation></semantics></math> number of training epochs per round.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  initialize all pdfs <math id="alg1.l2.m1.2" class="ltx_Math" alttext="c_{i}^{(0)}(\bm{\phi}_{i})" display="inline"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml"><msubsup id="alg1.l2.m1.2.2.3" xref="alg1.l2.m1.2.2.3.cmml"><mi id="alg1.l2.m1.2.2.3.2.2" xref="alg1.l2.m1.2.2.3.2.2.cmml">c</mi><mi id="alg1.l2.m1.2.2.3.2.3" xref="alg1.l2.m1.2.2.3.2.3.cmml">i</mi><mrow id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.1.3.1" xref="alg1.l2.m1.2.2.3.cmml">(</mo><mn id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l2.m1.1.1.1.3.2" xref="alg1.l2.m1.2.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.2.cmml">​</mo><mrow id="alg1.l2.m1.2.2.1.1" xref="alg1.l2.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.2" xref="alg1.l2.m1.2.2.1.1.1.cmml">(</mo><msub id="alg1.l2.m1.2.2.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l2.m1.2.2.1.1.1.2" xref="alg1.l2.m1.2.2.1.1.1.2.cmml">ϕ</mi><mi id="alg1.l2.m1.2.2.1.1.1.3" xref="alg1.l2.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.3" xref="alg1.l2.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2"><times id="alg1.l2.m1.2.2.2.cmml" xref="alg1.l2.m1.2.2.2"></times><apply id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.3.1.cmml" xref="alg1.l2.m1.2.2.3">superscript</csymbol><apply id="alg1.l2.m1.2.2.3.2.cmml" xref="alg1.l2.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.3.2.1.cmml" xref="alg1.l2.m1.2.2.3">subscript</csymbol><ci id="alg1.l2.m1.2.2.3.2.2.cmml" xref="alg1.l2.m1.2.2.3.2.2">𝑐</ci><ci id="alg1.l2.m1.2.2.3.2.3.cmml" xref="alg1.l2.m1.2.2.3.2.3">𝑖</ci></apply><cn type="integer" id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">0</cn></apply><apply id="alg1.l2.m1.2.2.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l2.m1.2.2.1.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.1.2">bold-italic-ϕ</ci><ci id="alg1.l2.m1.2.2.1.1.1.3.cmml" xref="alg1.l2.m1.2.2.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">c_{i}^{(0)}(\bm{\phi}_{i})</annotation></semantics></math> and <math id="alg1.l2.m2.2" class="ltx_Math" alttext="s_{i}^{(0)}(\bm{\theta})" display="inline"><semantics id="alg1.l2.m2.2a"><mrow id="alg1.l2.m2.2.3" xref="alg1.l2.m2.2.3.cmml"><msubsup id="alg1.l2.m2.2.3.2" xref="alg1.l2.m2.2.3.2.cmml"><mi id="alg1.l2.m2.2.3.2.2.2" xref="alg1.l2.m2.2.3.2.2.2.cmml">s</mi><mi id="alg1.l2.m2.2.3.2.2.3" xref="alg1.l2.m2.2.3.2.2.3.cmml">i</mi><mrow id="alg1.l2.m2.1.1.1.3" xref="alg1.l2.m2.2.3.2.cmml"><mo stretchy="false" id="alg1.l2.m2.1.1.1.3.1" xref="alg1.l2.m2.2.3.2.cmml">(</mo><mn id="alg1.l2.m2.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l2.m2.1.1.1.3.2" xref="alg1.l2.m2.2.3.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l2.m2.2.3.1" xref="alg1.l2.m2.2.3.1.cmml">​</mo><mrow id="alg1.l2.m2.2.3.3.2" xref="alg1.l2.m2.2.3.cmml"><mo stretchy="false" id="alg1.l2.m2.2.3.3.2.1" xref="alg1.l2.m2.2.3.cmml">(</mo><mi id="alg1.l2.m2.2.2" xref="alg1.l2.m2.2.2.cmml">𝜽</mi><mo stretchy="false" id="alg1.l2.m2.2.3.3.2.2" xref="alg1.l2.m2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.2b"><apply id="alg1.l2.m2.2.3.cmml" xref="alg1.l2.m2.2.3"><times id="alg1.l2.m2.2.3.1.cmml" xref="alg1.l2.m2.2.3.1"></times><apply id="alg1.l2.m2.2.3.2.cmml" xref="alg1.l2.m2.2.3.2"><csymbol cd="ambiguous" id="alg1.l2.m2.2.3.2.1.cmml" xref="alg1.l2.m2.2.3.2">superscript</csymbol><apply id="alg1.l2.m2.2.3.2.2.cmml" xref="alg1.l2.m2.2.3.2"><csymbol cd="ambiguous" id="alg1.l2.m2.2.3.2.2.1.cmml" xref="alg1.l2.m2.2.3.2">subscript</csymbol><ci id="alg1.l2.m2.2.3.2.2.2.cmml" xref="alg1.l2.m2.2.3.2.2.2">𝑠</ci><ci id="alg1.l2.m2.2.3.2.2.3.cmml" xref="alg1.l2.m2.2.3.2.2.3">𝑖</ci></apply><cn type="integer" id="alg1.l2.m2.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1">0</cn></apply><ci id="alg1.l2.m2.2.2.cmml" xref="alg1.l2.m2.2.2">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.2c">s_{i}^{(0)}(\bm{\theta})</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <math id="alg1.l3.m1.4" class="ltx_Math" alttext="s^{(0)}(\bm{\theta})\leftarrow\prod_{i}s_{i}^{(0)}(\bm{\theta})" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.5" xref="alg1.l3.m1.4.5.cmml"><mrow id="alg1.l3.m1.4.5.2" xref="alg1.l3.m1.4.5.2.cmml"><msup id="alg1.l3.m1.4.5.2.2" xref="alg1.l3.m1.4.5.2.2.cmml"><mi id="alg1.l3.m1.4.5.2.2.2" xref="alg1.l3.m1.4.5.2.2.2.cmml">s</mi><mrow id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.4.5.2.2.cmml"><mo stretchy="false" id="alg1.l3.m1.1.1.1.3.1" xref="alg1.l3.m1.4.5.2.2.cmml">(</mo><mn id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l3.m1.1.1.1.3.2" xref="alg1.l3.m1.4.5.2.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="alg1.l3.m1.4.5.2.1" xref="alg1.l3.m1.4.5.2.1.cmml">​</mo><mrow id="alg1.l3.m1.4.5.2.3.2" xref="alg1.l3.m1.4.5.2.cmml"><mo stretchy="false" id="alg1.l3.m1.4.5.2.3.2.1" xref="alg1.l3.m1.4.5.2.cmml">(</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">𝜽</mi><mo stretchy="false" id="alg1.l3.m1.4.5.2.3.2.2" xref="alg1.l3.m1.4.5.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" stretchy="false" id="alg1.l3.m1.4.5.1" xref="alg1.l3.m1.4.5.1.cmml">←</mo><mrow id="alg1.l3.m1.4.5.3" xref="alg1.l3.m1.4.5.3.cmml"><msub id="alg1.l3.m1.4.5.3.1" xref="alg1.l3.m1.4.5.3.1.cmml"><mo id="alg1.l3.m1.4.5.3.1.2" xref="alg1.l3.m1.4.5.3.1.2.cmml">∏</mo><mi id="alg1.l3.m1.4.5.3.1.3" xref="alg1.l3.m1.4.5.3.1.3.cmml">i</mi></msub><mrow id="alg1.l3.m1.4.5.3.2" xref="alg1.l3.m1.4.5.3.2.cmml"><msubsup id="alg1.l3.m1.4.5.3.2.2" xref="alg1.l3.m1.4.5.3.2.2.cmml"><mi id="alg1.l3.m1.4.5.3.2.2.2.2" xref="alg1.l3.m1.4.5.3.2.2.2.2.cmml">s</mi><mi id="alg1.l3.m1.4.5.3.2.2.2.3" xref="alg1.l3.m1.4.5.3.2.2.2.3.cmml">i</mi><mrow id="alg1.l3.m1.2.2.1.3" xref="alg1.l3.m1.4.5.3.2.2.cmml"><mo stretchy="false" id="alg1.l3.m1.2.2.1.3.1" xref="alg1.l3.m1.4.5.3.2.2.cmml">(</mo><mn id="alg1.l3.m1.2.2.1.1" xref="alg1.l3.m1.2.2.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l3.m1.2.2.1.3.2" xref="alg1.l3.m1.4.5.3.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l3.m1.4.5.3.2.1" xref="alg1.l3.m1.4.5.3.2.1.cmml">​</mo><mrow id="alg1.l3.m1.4.5.3.2.3.2" xref="alg1.l3.m1.4.5.3.2.cmml"><mo stretchy="false" id="alg1.l3.m1.4.5.3.2.3.2.1" xref="alg1.l3.m1.4.5.3.2.cmml">(</mo><mi id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml">𝜽</mi><mo stretchy="false" id="alg1.l3.m1.4.5.3.2.3.2.2" xref="alg1.l3.m1.4.5.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.5.cmml" xref="alg1.l3.m1.4.5"><ci id="alg1.l3.m1.4.5.1.cmml" xref="alg1.l3.m1.4.5.1">←</ci><apply id="alg1.l3.m1.4.5.2.cmml" xref="alg1.l3.m1.4.5.2"><times id="alg1.l3.m1.4.5.2.1.cmml" xref="alg1.l3.m1.4.5.2.1"></times><apply id="alg1.l3.m1.4.5.2.2.cmml" xref="alg1.l3.m1.4.5.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.4.5.2.2.1.cmml" xref="alg1.l3.m1.4.5.2.2">superscript</csymbol><ci id="alg1.l3.m1.4.5.2.2.2.cmml" xref="alg1.l3.m1.4.5.2.2.2">𝑠</ci><cn type="integer" id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">0</cn></apply><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝜽</ci></apply><apply id="alg1.l3.m1.4.5.3.cmml" xref="alg1.l3.m1.4.5.3"><apply id="alg1.l3.m1.4.5.3.1.cmml" xref="alg1.l3.m1.4.5.3.1"><csymbol cd="ambiguous" id="alg1.l3.m1.4.5.3.1.1.cmml" xref="alg1.l3.m1.4.5.3.1">subscript</csymbol><csymbol cd="latexml" id="alg1.l3.m1.4.5.3.1.2.cmml" xref="alg1.l3.m1.4.5.3.1.2">product</csymbol><ci id="alg1.l3.m1.4.5.3.1.3.cmml" xref="alg1.l3.m1.4.5.3.1.3">𝑖</ci></apply><apply id="alg1.l3.m1.4.5.3.2.cmml" xref="alg1.l3.m1.4.5.3.2"><times id="alg1.l3.m1.4.5.3.2.1.cmml" xref="alg1.l3.m1.4.5.3.2.1"></times><apply id="alg1.l3.m1.4.5.3.2.2.cmml" xref="alg1.l3.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.4.5.3.2.2.1.cmml" xref="alg1.l3.m1.4.5.3.2.2">superscript</csymbol><apply id="alg1.l3.m1.4.5.3.2.2.2.cmml" xref="alg1.l3.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.4.5.3.2.2.2.1.cmml" xref="alg1.l3.m1.4.5.3.2.2">subscript</csymbol><ci id="alg1.l3.m1.4.5.3.2.2.2.2.cmml" xref="alg1.l3.m1.4.5.3.2.2.2.2">𝑠</ci><ci id="alg1.l3.m1.4.5.3.2.2.2.3.cmml" xref="alg1.l3.m1.4.5.3.2.2.2.3">𝑖</ci></apply><cn type="integer" id="alg1.l3.m1.2.2.1.1.cmml" xref="alg1.l3.m1.2.2.1.1">0</cn></apply><ci id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">s^{(0)}(\bm{\theta})\leftarrow\prod_{i}s_{i}^{(0)}(\bm{\theta})</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span>  round <math id="alg1.l4.m1.3" class="ltx_Math" alttext="t=1,2\dots,T" display="inline"><semantics id="alg1.l4.m1.3a"><mrow id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml"><mi id="alg1.l4.m1.3.3.3" xref="alg1.l4.m1.3.3.3.cmml">t</mi><mo id="alg1.l4.m1.3.3.2" xref="alg1.l4.m1.3.3.2.cmml">=</mo><mrow id="alg1.l4.m1.3.3.1.1" xref="alg1.l4.m1.3.3.1.2.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.3.3.1.1.2" xref="alg1.l4.m1.3.3.1.2.cmml">,</mo><mrow id="alg1.l4.m1.3.3.1.1.1" xref="alg1.l4.m1.3.3.1.1.1.cmml"><mn id="alg1.l4.m1.3.3.1.1.1.2" xref="alg1.l4.m1.3.3.1.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="alg1.l4.m1.3.3.1.1.1.1" xref="alg1.l4.m1.3.3.1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l4.m1.3.3.1.1.1.3" xref="alg1.l4.m1.3.3.1.1.1.3.cmml">…</mi></mrow><mo id="alg1.l4.m1.3.3.1.1.3" xref="alg1.l4.m1.3.3.1.2.cmml">,</mo><mi id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.3b"><apply id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3"><eq id="alg1.l4.m1.3.3.2.cmml" xref="alg1.l4.m1.3.3.2"></eq><ci id="alg1.l4.m1.3.3.3.cmml" xref="alg1.l4.m1.3.3.3">𝑡</ci><list id="alg1.l4.m1.3.3.1.2.cmml" xref="alg1.l4.m1.3.3.1.1"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><apply id="alg1.l4.m1.3.3.1.1.1.cmml" xref="alg1.l4.m1.3.3.1.1.1"><times id="alg1.l4.m1.3.3.1.1.1.1.cmml" xref="alg1.l4.m1.3.3.1.1.1.1"></times><cn type="integer" id="alg1.l4.m1.3.3.1.1.1.2.cmml" xref="alg1.l4.m1.3.3.1.1.1.2">2</cn><ci id="alg1.l4.m1.3.3.1.1.1.3.cmml" xref="alg1.l4.m1.3.3.1.1.1.3">…</ci></apply><ci id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.3c">t=1,2\dots,T</annotation></semantics></math>
 <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     choose randomly a set of <math id="alg1.l5.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">C</annotation></semantics></math> active clients <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\mathcal{C}_{t}" display="inline"><semantics id="alg1.l5.m2.1a"><msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">𝒞</mi><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">𝒞</ci><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\mathcal{C}_{t}</annotation></semantics></math> to be refined.

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     (client) receives <math id="alg1.l6.m1.1" class="ltx_Math" alttext="s^{(t)}" display="inline"><semantics id="alg1.l6.m1.1a"><msup id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><mi id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml">s</mi><mrow id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.2.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.3.1" xref="alg1.l6.m1.1.2.cmml">(</mo><mi id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l6.m1.1.1.1.3.2" xref="alg1.l6.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2">superscript</csymbol><ci id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2">𝑠</ci><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">s^{(t)}</annotation></semantics></math> from server.

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     (<em id="alg1.l7.2" class="ltx_emph ltx_font_italic">client</em>) compute new server prior <math id="alg1.l7.m1.5" class="ltx_Math" alttext="p(\bm{\theta})^{\frac{1}{K}}\frac{s^{(t)}(\bm{\theta})}{s^{(t-1)}_{i}(\bm{\theta})}" display="inline"><semantics id="alg1.l7.m1.5a"><mrow id="alg1.l7.m1.5.6" xref="alg1.l7.m1.5.6.cmml"><mi id="alg1.l7.m1.5.6.2" xref="alg1.l7.m1.5.6.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.5.6.1" xref="alg1.l7.m1.5.6.1.cmml">​</mo><msup id="alg1.l7.m1.5.6.3" xref="alg1.l7.m1.5.6.3.cmml"><mrow id="alg1.l7.m1.5.6.3.2.2" xref="alg1.l7.m1.5.6.3.cmml"><mo stretchy="false" id="alg1.l7.m1.5.6.3.2.2.1" xref="alg1.l7.m1.5.6.3.cmml">(</mo><mi id="alg1.l7.m1.5.5" xref="alg1.l7.m1.5.5.cmml">𝜽</mi><mo stretchy="false" id="alg1.l7.m1.5.6.3.2.2.2" xref="alg1.l7.m1.5.6.3.cmml">)</mo></mrow><mfrac id="alg1.l7.m1.5.6.3.3" xref="alg1.l7.m1.5.6.3.3.cmml"><mn id="alg1.l7.m1.5.6.3.3.2" xref="alg1.l7.m1.5.6.3.3.2.cmml">1</mn><mi id="alg1.l7.m1.5.6.3.3.3" xref="alg1.l7.m1.5.6.3.3.3.cmml">K</mi></mfrac></msup><mo lspace="0em" rspace="0em" id="alg1.l7.m1.5.6.1a" xref="alg1.l7.m1.5.6.1.cmml">​</mo><mfrac id="alg1.l7.m1.4.4" xref="alg1.l7.m1.4.4.cmml"><mrow id="alg1.l7.m1.2.2.2" xref="alg1.l7.m1.2.2.2.cmml"><msup id="alg1.l7.m1.2.2.2.4" xref="alg1.l7.m1.2.2.2.4.cmml"><mi id="alg1.l7.m1.2.2.2.4.2" xref="alg1.l7.m1.2.2.2.4.2.cmml">s</mi><mrow id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.2.2.2.4.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.3.1" xref="alg1.l7.m1.2.2.2.4.cmml">(</mo><mi id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.3.2" xref="alg1.l7.m1.2.2.2.4.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.3" xref="alg1.l7.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l7.m1.2.2.2.5.2" xref="alg1.l7.m1.2.2.2.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.2.5.2.1" xref="alg1.l7.m1.2.2.2.cmml">(</mo><mi id="alg1.l7.m1.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.cmml">𝜽</mi><mo stretchy="false" id="alg1.l7.m1.2.2.2.5.2.2" xref="alg1.l7.m1.2.2.2.cmml">)</mo></mrow></mrow><mrow id="alg1.l7.m1.4.4.4" xref="alg1.l7.m1.4.4.4.cmml"><msubsup id="alg1.l7.m1.4.4.4.4" xref="alg1.l7.m1.4.4.4.4.cmml"><mi id="alg1.l7.m1.4.4.4.4.2.2" xref="alg1.l7.m1.4.4.4.4.2.2.cmml">s</mi><mi id="alg1.l7.m1.4.4.4.4.3" xref="alg1.l7.m1.4.4.4.4.3.cmml">i</mi><mrow id="alg1.l7.m1.3.3.3.1.1.1" xref="alg1.l7.m1.3.3.3.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.3.1.1.1.2" xref="alg1.l7.m1.3.3.3.1.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.3.3.3.1.1.1.1" xref="alg1.l7.m1.3.3.3.1.1.1.1.cmml"><mi id="alg1.l7.m1.3.3.3.1.1.1.1.2" xref="alg1.l7.m1.3.3.3.1.1.1.1.2.cmml">t</mi><mo id="alg1.l7.m1.3.3.3.1.1.1.1.1" xref="alg1.l7.m1.3.3.3.1.1.1.1.1.cmml">−</mo><mn id="alg1.l7.m1.3.3.3.1.1.1.1.3" xref="alg1.l7.m1.3.3.3.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l7.m1.3.3.3.1.1.1.3" xref="alg1.l7.m1.3.3.3.1.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l7.m1.4.4.4.3" xref="alg1.l7.m1.4.4.4.3.cmml">​</mo><mrow id="alg1.l7.m1.4.4.4.5.2" xref="alg1.l7.m1.4.4.4.cmml"><mo stretchy="false" id="alg1.l7.m1.4.4.4.5.2.1" xref="alg1.l7.m1.4.4.4.cmml">(</mo><mi id="alg1.l7.m1.4.4.4.2" xref="alg1.l7.m1.4.4.4.2.cmml">𝜽</mi><mo stretchy="false" id="alg1.l7.m1.4.4.4.5.2.2" xref="alg1.l7.m1.4.4.4.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.5b"><apply id="alg1.l7.m1.5.6.cmml" xref="alg1.l7.m1.5.6"><times id="alg1.l7.m1.5.6.1.cmml" xref="alg1.l7.m1.5.6.1"></times><ci id="alg1.l7.m1.5.6.2.cmml" xref="alg1.l7.m1.5.6.2">𝑝</ci><apply id="alg1.l7.m1.5.6.3.cmml" xref="alg1.l7.m1.5.6.3"><csymbol cd="ambiguous" id="alg1.l7.m1.5.6.3.1.cmml" xref="alg1.l7.m1.5.6.3">superscript</csymbol><ci id="alg1.l7.m1.5.5.cmml" xref="alg1.l7.m1.5.5">𝜽</ci><apply id="alg1.l7.m1.5.6.3.3.cmml" xref="alg1.l7.m1.5.6.3.3"><divide id="alg1.l7.m1.5.6.3.3.1.cmml" xref="alg1.l7.m1.5.6.3.3"></divide><cn type="integer" id="alg1.l7.m1.5.6.3.3.2.cmml" xref="alg1.l7.m1.5.6.3.3.2">1</cn><ci id="alg1.l7.m1.5.6.3.3.3.cmml" xref="alg1.l7.m1.5.6.3.3.3">𝐾</ci></apply></apply><apply id="alg1.l7.m1.4.4.cmml" xref="alg1.l7.m1.4.4"><divide id="alg1.l7.m1.4.4.5.cmml" xref="alg1.l7.m1.4.4"></divide><apply id="alg1.l7.m1.2.2.2.cmml" xref="alg1.l7.m1.2.2.2"><times id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.3"></times><apply id="alg1.l7.m1.2.2.2.4.cmml" xref="alg1.l7.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.4.1.cmml" xref="alg1.l7.m1.2.2.2.4">superscript</csymbol><ci id="alg1.l7.m1.2.2.2.4.2.cmml" xref="alg1.l7.m1.2.2.2.4.2">𝑠</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1">𝑡</ci></apply><ci id="alg1.l7.m1.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2">𝜽</ci></apply><apply id="alg1.l7.m1.4.4.4.cmml" xref="alg1.l7.m1.4.4.4"><times id="alg1.l7.m1.4.4.4.3.cmml" xref="alg1.l7.m1.4.4.4.3"></times><apply id="alg1.l7.m1.4.4.4.4.cmml" xref="alg1.l7.m1.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.4.4.1.cmml" xref="alg1.l7.m1.4.4.4.4">subscript</csymbol><apply id="alg1.l7.m1.4.4.4.4.2.cmml" xref="alg1.l7.m1.4.4.4.4"><csymbol cd="ambiguous" id="alg1.l7.m1.4.4.4.4.2.1.cmml" xref="alg1.l7.m1.4.4.4.4">superscript</csymbol><ci id="alg1.l7.m1.4.4.4.4.2.2.cmml" xref="alg1.l7.m1.4.4.4.4.2.2">𝑠</ci><apply id="alg1.l7.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.3.1.1.1"><minus id="alg1.l7.m1.3.3.3.1.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.3.1.1.1.1.1"></minus><ci id="alg1.l7.m1.3.3.3.1.1.1.1.2.cmml" xref="alg1.l7.m1.3.3.3.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.3.3.3.1.1.1.1.3.cmml" xref="alg1.l7.m1.3.3.3.1.1.1.1.3">1</cn></apply></apply><ci id="alg1.l7.m1.4.4.4.4.3.cmml" xref="alg1.l7.m1.4.4.4.4.3">𝑖</ci></apply><ci id="alg1.l7.m1.4.4.4.2.cmml" xref="alg1.l7.m1.4.4.4.2">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.5c">p(\bm{\theta})^{\frac{1}{K}}\frac{s^{(t)}(\bm{\theta})}{s^{(t-1)}_{i}(\bm{\theta})}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     (<em id="alg1.l8.2" class="ltx_emph ltx_font_italic">client</em>) <math id="alg1.l8.m1.5" class="ltx_Math" alttext="s_{i}^{(t)}(\bm{\theta}),c^{(t)}_{i}(\bm{\phi}_{i})\leftarrow" display="inline"><semantics id="alg1.l8.m1.5a"><mrow id="alg1.l8.m1.5.5" xref="alg1.l8.m1.5.5.cmml"><mrow id="alg1.l8.m1.5.5.2.2" xref="alg1.l8.m1.5.5.2.3.cmml"><mrow id="alg1.l8.m1.4.4.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.cmml"><msubsup id="alg1.l8.m1.4.4.1.1.1.2" xref="alg1.l8.m1.4.4.1.1.1.2.cmml"><mi id="alg1.l8.m1.4.4.1.1.1.2.2.2" xref="alg1.l8.m1.4.4.1.1.1.2.2.2.cmml">s</mi><mi id="alg1.l8.m1.4.4.1.1.1.2.2.3" xref="alg1.l8.m1.4.4.1.1.1.2.2.3.cmml">i</mi><mrow id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.4.4.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.1.1.1.3.1" xref="alg1.l8.m1.4.4.1.1.1.2.cmml">(</mo><mi id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l8.m1.1.1.1.3.2" xref="alg1.l8.m1.4.4.1.1.1.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l8.m1.4.4.1.1.1.1" xref="alg1.l8.m1.4.4.1.1.1.1.cmml">​</mo><mrow id="alg1.l8.m1.4.4.1.1.1.3.2" xref="alg1.l8.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.4.4.1.1.1.3.2.1" xref="alg1.l8.m1.4.4.1.1.1.cmml">(</mo><mi id="alg1.l8.m1.3.3" xref="alg1.l8.m1.3.3.cmml">𝜽</mi><mo stretchy="false" id="alg1.l8.m1.4.4.1.1.1.3.2.2" xref="alg1.l8.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l8.m1.5.5.2.2.3" xref="alg1.l8.m1.5.5.2.3.cmml">,</mo><mrow id="alg1.l8.m1.5.5.2.2.2" xref="alg1.l8.m1.5.5.2.2.2.cmml"><msubsup id="alg1.l8.m1.5.5.2.2.2.3" xref="alg1.l8.m1.5.5.2.2.2.3.cmml"><mi id="alg1.l8.m1.5.5.2.2.2.3.2.2" xref="alg1.l8.m1.5.5.2.2.2.3.2.2.cmml">c</mi><mi id="alg1.l8.m1.5.5.2.2.2.3.3" xref="alg1.l8.m1.5.5.2.2.2.3.3.cmml">i</mi><mrow id="alg1.l8.m1.2.2.1.3" xref="alg1.l8.m1.5.5.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l8.m1.2.2.1.3.1" xref="alg1.l8.m1.5.5.2.2.2.3.cmml">(</mo><mi id="alg1.l8.m1.2.2.1.1" xref="alg1.l8.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l8.m1.2.2.1.3.2" xref="alg1.l8.m1.5.5.2.2.2.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l8.m1.5.5.2.2.2.2" xref="alg1.l8.m1.5.5.2.2.2.2.cmml">​</mo><mrow id="alg1.l8.m1.5.5.2.2.2.1.1" xref="alg1.l8.m1.5.5.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m1.5.5.2.2.2.1.1.2" xref="alg1.l8.m1.5.5.2.2.2.1.1.1.cmml">(</mo><msub id="alg1.l8.m1.5.5.2.2.2.1.1.1" xref="alg1.l8.m1.5.5.2.2.2.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="alg1.l8.m1.5.5.2.2.2.1.1.1.2" xref="alg1.l8.m1.5.5.2.2.2.1.1.1.2.cmml">ϕ</mi><mi id="alg1.l8.m1.5.5.2.2.2.1.1.1.3" xref="alg1.l8.m1.5.5.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l8.m1.5.5.2.2.2.1.1.3" xref="alg1.l8.m1.5.5.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l8.m1.5.5.3" xref="alg1.l8.m1.5.5.3.cmml">←</mo><mi id="alg1.l8.m1.5.5.4" xref="alg1.l8.m1.5.5.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.5b"><apply id="alg1.l8.m1.5.5.cmml" xref="alg1.l8.m1.5.5"><ci id="alg1.l8.m1.5.5.3.cmml" xref="alg1.l8.m1.5.5.3">←</ci><list id="alg1.l8.m1.5.5.2.3.cmml" xref="alg1.l8.m1.5.5.2.2"><apply id="alg1.l8.m1.4.4.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1"><times id="alg1.l8.m1.4.4.1.1.1.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.1"></times><apply id="alg1.l8.m1.4.4.1.1.1.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.1.1.1.2.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.2">superscript</csymbol><apply id="alg1.l8.m1.4.4.1.1.1.2.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.4.4.1.1.1.2.2.1.cmml" xref="alg1.l8.m1.4.4.1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.4.4.1.1.1.2.2.2.cmml" xref="alg1.l8.m1.4.4.1.1.1.2.2.2">𝑠</ci><ci id="alg1.l8.m1.4.4.1.1.1.2.2.3.cmml" xref="alg1.l8.m1.4.4.1.1.1.2.2.3">𝑖</ci></apply><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">𝑡</ci></apply><ci id="alg1.l8.m1.3.3.cmml" xref="alg1.l8.m1.3.3">𝜽</ci></apply><apply id="alg1.l8.m1.5.5.2.2.2.cmml" xref="alg1.l8.m1.5.5.2.2.2"><times id="alg1.l8.m1.5.5.2.2.2.2.cmml" xref="alg1.l8.m1.5.5.2.2.2.2"></times><apply id="alg1.l8.m1.5.5.2.2.2.3.cmml" xref="alg1.l8.m1.5.5.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.2.2.2.3.1.cmml" xref="alg1.l8.m1.5.5.2.2.2.3">subscript</csymbol><apply id="alg1.l8.m1.5.5.2.2.2.3.2.cmml" xref="alg1.l8.m1.5.5.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.2.2.2.3.2.1.cmml" xref="alg1.l8.m1.5.5.2.2.2.3">superscript</csymbol><ci id="alg1.l8.m1.5.5.2.2.2.3.2.2.cmml" xref="alg1.l8.m1.5.5.2.2.2.3.2.2">𝑐</ci><ci id="alg1.l8.m1.2.2.1.1.cmml" xref="alg1.l8.m1.2.2.1.1">𝑡</ci></apply><ci id="alg1.l8.m1.5.5.2.2.2.3.3.cmml" xref="alg1.l8.m1.5.5.2.2.2.3.3">𝑖</ci></apply><apply id="alg1.l8.m1.5.5.2.2.2.1.1.1.cmml" xref="alg1.l8.m1.5.5.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.5.5.2.2.2.1.1.1.1.cmml" xref="alg1.l8.m1.5.5.2.2.2.1.1">subscript</csymbol><ci id="alg1.l8.m1.5.5.2.2.2.1.1.1.2.cmml" xref="alg1.l8.m1.5.5.2.2.2.1.1.1.2">bold-italic-ϕ</ci><ci id="alg1.l8.m1.5.5.2.2.2.1.1.1.3.cmml" xref="alg1.l8.m1.5.5.2.2.2.1.1.1.3">𝑖</ci></apply></apply></list><csymbol cd="latexml" id="alg1.l8.m1.5.5.4.cmml" xref="alg1.l8.m1.5.5.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.5c">s_{i}^{(t)}(\bm{\theta}),c^{(t)}_{i}(\bm{\phi}_{i})\leftarrow</annotation></semantics></math> joint optimization of <a href="#S2.Ex2" title="Proposition 1. ‣ II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> for <math id="alg1.l8.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">E</annotation></semantics></math> epochs.

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     (<em id="alg1.l9.2" class="ltx_emph ltx_font_italic">client</em>) compute delta <math id="alg1.l9.m1.6" class="ltx_Math" alttext="\Delta_{i}^{(t)}(\bm{\theta})\leftarrow\frac{s_{i}^{(t)}(\bm{\theta})}{s_{i}^{(t-1)}(\bm{\theta})}" display="inline"><semantics id="alg1.l9.m1.6a"><mrow id="alg1.l9.m1.6.7" xref="alg1.l9.m1.6.7.cmml"><mrow id="alg1.l9.m1.6.7.2" xref="alg1.l9.m1.6.7.2.cmml"><msubsup id="alg1.l9.m1.6.7.2.2" xref="alg1.l9.m1.6.7.2.2.cmml"><mi mathvariant="normal" id="alg1.l9.m1.6.7.2.2.2.2" xref="alg1.l9.m1.6.7.2.2.2.2.cmml">Δ</mi><mi id="alg1.l9.m1.6.7.2.2.2.3" xref="alg1.l9.m1.6.7.2.2.2.3.cmml">i</mi><mrow id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.6.7.2.2.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.3.1" xref="alg1.l9.m1.6.7.2.2.cmml">(</mo><mi id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l9.m1.1.1.1.3.2" xref="alg1.l9.m1.6.7.2.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l9.m1.6.7.2.1" xref="alg1.l9.m1.6.7.2.1.cmml">​</mo><mrow id="alg1.l9.m1.6.7.2.3.2" xref="alg1.l9.m1.6.7.2.cmml"><mo stretchy="false" id="alg1.l9.m1.6.7.2.3.2.1" xref="alg1.l9.m1.6.7.2.cmml">(</mo><mi id="alg1.l9.m1.6.6" xref="alg1.l9.m1.6.6.cmml">𝜽</mi><mo stretchy="false" id="alg1.l9.m1.6.7.2.3.2.2" xref="alg1.l9.m1.6.7.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l9.m1.6.7.1" xref="alg1.l9.m1.6.7.1.cmml">←</mo><mfrac id="alg1.l9.m1.5.5" xref="alg1.l9.m1.5.5.cmml"><mrow id="alg1.l9.m1.3.3.2" xref="alg1.l9.m1.3.3.2.cmml"><msubsup id="alg1.l9.m1.3.3.2.4" xref="alg1.l9.m1.3.3.2.4.cmml"><mi id="alg1.l9.m1.3.3.2.4.2.2" xref="alg1.l9.m1.3.3.2.4.2.2.cmml">s</mi><mi id="alg1.l9.m1.3.3.2.4.2.3" xref="alg1.l9.m1.3.3.2.4.2.3.cmml">i</mi><mrow id="alg1.l9.m1.2.2.1.1.1.3" xref="alg1.l9.m1.3.3.2.4.cmml"><mo stretchy="false" id="alg1.l9.m1.2.2.1.1.1.3.1" xref="alg1.l9.m1.3.3.2.4.cmml">(</mo><mi id="alg1.l9.m1.2.2.1.1.1.1" xref="alg1.l9.m1.2.2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l9.m1.2.2.1.1.1.3.2" xref="alg1.l9.m1.3.3.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.2.3" xref="alg1.l9.m1.3.3.2.3.cmml">​</mo><mrow id="alg1.l9.m1.3.3.2.5.2" xref="alg1.l9.m1.3.3.2.cmml"><mo stretchy="false" id="alg1.l9.m1.3.3.2.5.2.1" xref="alg1.l9.m1.3.3.2.cmml">(</mo><mi id="alg1.l9.m1.3.3.2.2" xref="alg1.l9.m1.3.3.2.2.cmml">𝜽</mi><mo stretchy="false" id="alg1.l9.m1.3.3.2.5.2.2" xref="alg1.l9.m1.3.3.2.cmml">)</mo></mrow></mrow><mrow id="alg1.l9.m1.5.5.4" xref="alg1.l9.m1.5.5.4.cmml"><msubsup id="alg1.l9.m1.5.5.4.4" xref="alg1.l9.m1.5.5.4.4.cmml"><mi id="alg1.l9.m1.5.5.4.4.2.2" xref="alg1.l9.m1.5.5.4.4.2.2.cmml">s</mi><mi id="alg1.l9.m1.5.5.4.4.2.3" xref="alg1.l9.m1.5.5.4.4.2.3.cmml">i</mi><mrow id="alg1.l9.m1.4.4.3.1.1.1" xref="alg1.l9.m1.4.4.3.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.4.4.3.1.1.1.2" xref="alg1.l9.m1.4.4.3.1.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.4.4.3.1.1.1.1" xref="alg1.l9.m1.4.4.3.1.1.1.1.cmml"><mi id="alg1.l9.m1.4.4.3.1.1.1.1.2" xref="alg1.l9.m1.4.4.3.1.1.1.1.2.cmml">t</mi><mo id="alg1.l9.m1.4.4.3.1.1.1.1.1" xref="alg1.l9.m1.4.4.3.1.1.1.1.1.cmml">−</mo><mn id="alg1.l9.m1.4.4.3.1.1.1.1.3" xref="alg1.l9.m1.4.4.3.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l9.m1.4.4.3.1.1.1.3" xref="alg1.l9.m1.4.4.3.1.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l9.m1.5.5.4.3" xref="alg1.l9.m1.5.5.4.3.cmml">​</mo><mrow id="alg1.l9.m1.5.5.4.5.2" xref="alg1.l9.m1.5.5.4.cmml"><mo stretchy="false" id="alg1.l9.m1.5.5.4.5.2.1" xref="alg1.l9.m1.5.5.4.cmml">(</mo><mi id="alg1.l9.m1.5.5.4.2" xref="alg1.l9.m1.5.5.4.2.cmml">𝜽</mi><mo stretchy="false" id="alg1.l9.m1.5.5.4.5.2.2" xref="alg1.l9.m1.5.5.4.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.6b"><apply id="alg1.l9.m1.6.7.cmml" xref="alg1.l9.m1.6.7"><ci id="alg1.l9.m1.6.7.1.cmml" xref="alg1.l9.m1.6.7.1">←</ci><apply id="alg1.l9.m1.6.7.2.cmml" xref="alg1.l9.m1.6.7.2"><times id="alg1.l9.m1.6.7.2.1.cmml" xref="alg1.l9.m1.6.7.2.1"></times><apply id="alg1.l9.m1.6.7.2.2.cmml" xref="alg1.l9.m1.6.7.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.6.7.2.2.1.cmml" xref="alg1.l9.m1.6.7.2.2">superscript</csymbol><apply id="alg1.l9.m1.6.7.2.2.2.cmml" xref="alg1.l9.m1.6.7.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.6.7.2.2.2.1.cmml" xref="alg1.l9.m1.6.7.2.2">subscript</csymbol><ci id="alg1.l9.m1.6.7.2.2.2.2.cmml" xref="alg1.l9.m1.6.7.2.2.2.2">Δ</ci><ci id="alg1.l9.m1.6.7.2.2.2.3.cmml" xref="alg1.l9.m1.6.7.2.2.2.3">𝑖</ci></apply><ci id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1">𝑡</ci></apply><ci id="alg1.l9.m1.6.6.cmml" xref="alg1.l9.m1.6.6">𝜽</ci></apply><apply id="alg1.l9.m1.5.5.cmml" xref="alg1.l9.m1.5.5"><divide id="alg1.l9.m1.5.5.5.cmml" xref="alg1.l9.m1.5.5"></divide><apply id="alg1.l9.m1.3.3.2.cmml" xref="alg1.l9.m1.3.3.2"><times id="alg1.l9.m1.3.3.2.3.cmml" xref="alg1.l9.m1.3.3.2.3"></times><apply id="alg1.l9.m1.3.3.2.4.cmml" xref="alg1.l9.m1.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.2.4.1.cmml" xref="alg1.l9.m1.3.3.2.4">superscript</csymbol><apply id="alg1.l9.m1.3.3.2.4.2.cmml" xref="alg1.l9.m1.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.2.4.2.1.cmml" xref="alg1.l9.m1.3.3.2.4">subscript</csymbol><ci id="alg1.l9.m1.3.3.2.4.2.2.cmml" xref="alg1.l9.m1.3.3.2.4.2.2">𝑠</ci><ci id="alg1.l9.m1.3.3.2.4.2.3.cmml" xref="alg1.l9.m1.3.3.2.4.2.3">𝑖</ci></apply><ci id="alg1.l9.m1.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.1.1.1.1">𝑡</ci></apply><ci id="alg1.l9.m1.3.3.2.2.cmml" xref="alg1.l9.m1.3.3.2.2">𝜽</ci></apply><apply id="alg1.l9.m1.5.5.4.cmml" xref="alg1.l9.m1.5.5.4"><times id="alg1.l9.m1.5.5.4.3.cmml" xref="alg1.l9.m1.5.5.4.3"></times><apply id="alg1.l9.m1.5.5.4.4.cmml" xref="alg1.l9.m1.5.5.4.4"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.4.4.1.cmml" xref="alg1.l9.m1.5.5.4.4">superscript</csymbol><apply id="alg1.l9.m1.5.5.4.4.2.cmml" xref="alg1.l9.m1.5.5.4.4"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.4.4.2.1.cmml" xref="alg1.l9.m1.5.5.4.4">subscript</csymbol><ci id="alg1.l9.m1.5.5.4.4.2.2.cmml" xref="alg1.l9.m1.5.5.4.4.2.2">𝑠</ci><ci id="alg1.l9.m1.5.5.4.4.2.3.cmml" xref="alg1.l9.m1.5.5.4.4.2.3">𝑖</ci></apply><apply id="alg1.l9.m1.4.4.3.1.1.1.1.cmml" xref="alg1.l9.m1.4.4.3.1.1.1"><minus id="alg1.l9.m1.4.4.3.1.1.1.1.1.cmml" xref="alg1.l9.m1.4.4.3.1.1.1.1.1"></minus><ci id="alg1.l9.m1.4.4.3.1.1.1.1.2.cmml" xref="alg1.l9.m1.4.4.3.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.4.4.3.1.1.1.1.3.cmml" xref="alg1.l9.m1.4.4.3.1.1.1.1.3">1</cn></apply></apply><ci id="alg1.l9.m1.5.5.4.2.cmml" xref="alg1.l9.m1.5.5.4.2">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.6c">\Delta_{i}^{(t)}(\bm{\theta})\leftarrow\frac{s_{i}^{(t)}(\bm{\theta})}{s_{i}^{(t-1)}(\bm{\theta})}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     (aggregate) <math id="alg1.l10.m1.2" class="ltx_Math" alttext="\Delta(\bm{\theta})\leftarrow\prod_{i\in\mathcal{C}_{t}}\Delta_{i}(\bm{\theta})" display="inline"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.3" xref="alg1.l10.m1.2.3.cmml"><mrow id="alg1.l10.m1.2.3.2" xref="alg1.l10.m1.2.3.2.cmml"><mi mathvariant="normal" id="alg1.l10.m1.2.3.2.2" xref="alg1.l10.m1.2.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.3.2.1" xref="alg1.l10.m1.2.3.2.1.cmml">​</mo><mrow id="alg1.l10.m1.2.3.2.3.2" xref="alg1.l10.m1.2.3.2.cmml"><mo stretchy="false" id="alg1.l10.m1.2.3.2.3.2.1" xref="alg1.l10.m1.2.3.2.cmml">(</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="alg1.l10.m1.2.3.2.3.2.2" xref="alg1.l10.m1.2.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" stretchy="false" id="alg1.l10.m1.2.3.1" xref="alg1.l10.m1.2.3.1.cmml">←</mo><mrow id="alg1.l10.m1.2.3.3" xref="alg1.l10.m1.2.3.3.cmml"><msub id="alg1.l10.m1.2.3.3.1" xref="alg1.l10.m1.2.3.3.1.cmml"><mo id="alg1.l10.m1.2.3.3.1.2" xref="alg1.l10.m1.2.3.3.1.2.cmml">∏</mo><mrow id="alg1.l10.m1.2.3.3.1.3" xref="alg1.l10.m1.2.3.3.1.3.cmml"><mi id="alg1.l10.m1.2.3.3.1.3.2" xref="alg1.l10.m1.2.3.3.1.3.2.cmml">i</mi><mo id="alg1.l10.m1.2.3.3.1.3.1" xref="alg1.l10.m1.2.3.3.1.3.1.cmml">∈</mo><msub id="alg1.l10.m1.2.3.3.1.3.3" xref="alg1.l10.m1.2.3.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.2.3.3.1.3.3.2" xref="alg1.l10.m1.2.3.3.1.3.3.2.cmml">𝒞</mi><mi id="alg1.l10.m1.2.3.3.1.3.3.3" xref="alg1.l10.m1.2.3.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg1.l10.m1.2.3.3.2" xref="alg1.l10.m1.2.3.3.2.cmml"><msub id="alg1.l10.m1.2.3.3.2.2" xref="alg1.l10.m1.2.3.3.2.2.cmml"><mi mathvariant="normal" id="alg1.l10.m1.2.3.3.2.2.2" xref="alg1.l10.m1.2.3.3.2.2.2.cmml">Δ</mi><mi id="alg1.l10.m1.2.3.3.2.2.3" xref="alg1.l10.m1.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.3.3.2.1" xref="alg1.l10.m1.2.3.3.2.1.cmml">​</mo><mrow id="alg1.l10.m1.2.3.3.2.3.2" xref="alg1.l10.m1.2.3.3.2.cmml"><mo stretchy="false" id="alg1.l10.m1.2.3.3.2.3.2.1" xref="alg1.l10.m1.2.3.3.2.cmml">(</mo><mi id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml">𝜽</mi><mo stretchy="false" id="alg1.l10.m1.2.3.3.2.3.2.2" xref="alg1.l10.m1.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.3.cmml" xref="alg1.l10.m1.2.3"><ci id="alg1.l10.m1.2.3.1.cmml" xref="alg1.l10.m1.2.3.1">←</ci><apply id="alg1.l10.m1.2.3.2.cmml" xref="alg1.l10.m1.2.3.2"><times id="alg1.l10.m1.2.3.2.1.cmml" xref="alg1.l10.m1.2.3.2.1"></times><ci id="alg1.l10.m1.2.3.2.2.cmml" xref="alg1.l10.m1.2.3.2.2">Δ</ci><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝜽</ci></apply><apply id="alg1.l10.m1.2.3.3.cmml" xref="alg1.l10.m1.2.3.3"><apply id="alg1.l10.m1.2.3.3.1.cmml" xref="alg1.l10.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.3.1.1.cmml" xref="alg1.l10.m1.2.3.3.1">subscript</csymbol><csymbol cd="latexml" id="alg1.l10.m1.2.3.3.1.2.cmml" xref="alg1.l10.m1.2.3.3.1.2">product</csymbol><apply id="alg1.l10.m1.2.3.3.1.3.cmml" xref="alg1.l10.m1.2.3.3.1.3"><in id="alg1.l10.m1.2.3.3.1.3.1.cmml" xref="alg1.l10.m1.2.3.3.1.3.1"></in><ci id="alg1.l10.m1.2.3.3.1.3.2.cmml" xref="alg1.l10.m1.2.3.3.1.3.2">𝑖</ci><apply id="alg1.l10.m1.2.3.3.1.3.3.cmml" xref="alg1.l10.m1.2.3.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.3.1.3.3.1.cmml" xref="alg1.l10.m1.2.3.3.1.3.3">subscript</csymbol><ci id="alg1.l10.m1.2.3.3.1.3.3.2.cmml" xref="alg1.l10.m1.2.3.3.1.3.3.2">𝒞</ci><ci id="alg1.l10.m1.2.3.3.1.3.3.3.cmml" xref="alg1.l10.m1.2.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l10.m1.2.3.3.2.cmml" xref="alg1.l10.m1.2.3.3.2"><times id="alg1.l10.m1.2.3.3.2.1.cmml" xref="alg1.l10.m1.2.3.3.2.1"></times><apply id="alg1.l10.m1.2.3.3.2.2.cmml" xref="alg1.l10.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.3.3.2.2.1.cmml" xref="alg1.l10.m1.2.3.3.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.3.3.2.2.2.cmml" xref="alg1.l10.m1.2.3.3.2.2.2">Δ</ci><ci id="alg1.l10.m1.2.3.3.2.2.3.cmml" xref="alg1.l10.m1.2.3.3.2.2.3">𝑖</ci></apply><ci id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">\Delta(\bm{\theta})\leftarrow\prod_{i\in\mathcal{C}_{t}}\Delta_{i}(\bm{\theta})</annotation></semantics></math>.

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     (server) receives <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\Delta(\bm{\theta})" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.2" xref="alg1.l11.m1.1.2.cmml"><mi mathvariant="normal" id="alg1.l11.m1.1.2.2" xref="alg1.l11.m1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.1.2.1" xref="alg1.l11.m1.1.2.1.cmml">​</mo><mrow id="alg1.l11.m1.1.2.3.2" xref="alg1.l11.m1.1.2.cmml"><mo stretchy="false" id="alg1.l11.m1.1.2.3.2.1" xref="alg1.l11.m1.1.2.cmml">(</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="alg1.l11.m1.1.2.3.2.2" xref="alg1.l11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.2.cmml" xref="alg1.l11.m1.1.2"><times id="alg1.l11.m1.1.2.1.cmml" xref="alg1.l11.m1.1.2.1"></times><ci id="alg1.l11.m1.1.2.2.cmml" xref="alg1.l11.m1.1.2.2">Δ</ci><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\Delta(\bm{\theta})</annotation></semantics></math> and applies it as <math id="alg1.l11.m2.5" class="ltx_Math" alttext="s^{(t+1)}(\bm{\theta})\leftarrow s^{(t)}(\bm{\theta})\Delta(\bm{\theta})" display="inline"><semantics id="alg1.l11.m2.5a"><mrow id="alg1.l11.m2.5.6" xref="alg1.l11.m2.5.6.cmml"><mrow id="alg1.l11.m2.5.6.2" xref="alg1.l11.m2.5.6.2.cmml"><msup id="alg1.l11.m2.5.6.2.2" xref="alg1.l11.m2.5.6.2.2.cmml"><mi id="alg1.l11.m2.5.6.2.2.2" xref="alg1.l11.m2.5.6.2.2.2.cmml">s</mi><mrow id="alg1.l11.m2.1.1.1.1" xref="alg1.l11.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l11.m2.1.1.1.1.2" xref="alg1.l11.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l11.m2.1.1.1.1.1" xref="alg1.l11.m2.1.1.1.1.1.cmml"><mi id="alg1.l11.m2.1.1.1.1.1.2" xref="alg1.l11.m2.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l11.m2.1.1.1.1.1.1" xref="alg1.l11.m2.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l11.m2.1.1.1.1.1.3" xref="alg1.l11.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l11.m2.1.1.1.1.3" xref="alg1.l11.m2.1.1.1.1.1.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="alg1.l11.m2.5.6.2.1" xref="alg1.l11.m2.5.6.2.1.cmml">​</mo><mrow id="alg1.l11.m2.5.6.2.3.2" xref="alg1.l11.m2.5.6.2.cmml"><mo stretchy="false" id="alg1.l11.m2.5.6.2.3.2.1" xref="alg1.l11.m2.5.6.2.cmml">(</mo><mi id="alg1.l11.m2.3.3" xref="alg1.l11.m2.3.3.cmml">𝜽</mi><mo stretchy="false" id="alg1.l11.m2.5.6.2.3.2.2" xref="alg1.l11.m2.5.6.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l11.m2.5.6.1" xref="alg1.l11.m2.5.6.1.cmml">←</mo><mrow id="alg1.l11.m2.5.6.3" xref="alg1.l11.m2.5.6.3.cmml"><msup id="alg1.l11.m2.5.6.3.2" xref="alg1.l11.m2.5.6.3.2.cmml"><mi id="alg1.l11.m2.5.6.3.2.2" xref="alg1.l11.m2.5.6.3.2.2.cmml">s</mi><mrow id="alg1.l11.m2.2.2.1.3" xref="alg1.l11.m2.5.6.3.2.cmml"><mo stretchy="false" id="alg1.l11.m2.2.2.1.3.1" xref="alg1.l11.m2.5.6.3.2.cmml">(</mo><mi id="alg1.l11.m2.2.2.1.1" xref="alg1.l11.m2.2.2.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l11.m2.2.2.1.3.2" xref="alg1.l11.m2.5.6.3.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="alg1.l11.m2.5.6.3.1" xref="alg1.l11.m2.5.6.3.1.cmml">​</mo><mrow id="alg1.l11.m2.5.6.3.3.2" xref="alg1.l11.m2.5.6.3.cmml"><mo stretchy="false" id="alg1.l11.m2.5.6.3.3.2.1" xref="alg1.l11.m2.5.6.3.cmml">(</mo><mi id="alg1.l11.m2.4.4" xref="alg1.l11.m2.4.4.cmml">𝜽</mi><mo stretchy="false" id="alg1.l11.m2.5.6.3.3.2.2" xref="alg1.l11.m2.5.6.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l11.m2.5.6.3.1a" xref="alg1.l11.m2.5.6.3.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l11.m2.5.6.3.4" xref="alg1.l11.m2.5.6.3.4.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m2.5.6.3.1b" xref="alg1.l11.m2.5.6.3.1.cmml">​</mo><mrow id="alg1.l11.m2.5.6.3.5.2" xref="alg1.l11.m2.5.6.3.cmml"><mo stretchy="false" id="alg1.l11.m2.5.6.3.5.2.1" xref="alg1.l11.m2.5.6.3.cmml">(</mo><mi id="alg1.l11.m2.5.5" xref="alg1.l11.m2.5.5.cmml">𝜽</mi><mo stretchy="false" id="alg1.l11.m2.5.6.3.5.2.2" xref="alg1.l11.m2.5.6.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.5b"><apply id="alg1.l11.m2.5.6.cmml" xref="alg1.l11.m2.5.6"><ci id="alg1.l11.m2.5.6.1.cmml" xref="alg1.l11.m2.5.6.1">←</ci><apply id="alg1.l11.m2.5.6.2.cmml" xref="alg1.l11.m2.5.6.2"><times id="alg1.l11.m2.5.6.2.1.cmml" xref="alg1.l11.m2.5.6.2.1"></times><apply id="alg1.l11.m2.5.6.2.2.cmml" xref="alg1.l11.m2.5.6.2.2"><csymbol cd="ambiguous" id="alg1.l11.m2.5.6.2.2.1.cmml" xref="alg1.l11.m2.5.6.2.2">superscript</csymbol><ci id="alg1.l11.m2.5.6.2.2.2.cmml" xref="alg1.l11.m2.5.6.2.2.2">𝑠</ci><apply id="alg1.l11.m2.1.1.1.1.1.cmml" xref="alg1.l11.m2.1.1.1.1"><plus id="alg1.l11.m2.1.1.1.1.1.1.cmml" xref="alg1.l11.m2.1.1.1.1.1.1"></plus><ci id="alg1.l11.m2.1.1.1.1.1.2.cmml" xref="alg1.l11.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l11.m2.1.1.1.1.1.3.cmml" xref="alg1.l11.m2.1.1.1.1.1.3">1</cn></apply></apply><ci id="alg1.l11.m2.3.3.cmml" xref="alg1.l11.m2.3.3">𝜽</ci></apply><apply id="alg1.l11.m2.5.6.3.cmml" xref="alg1.l11.m2.5.6.3"><times id="alg1.l11.m2.5.6.3.1.cmml" xref="alg1.l11.m2.5.6.3.1"></times><apply id="alg1.l11.m2.5.6.3.2.cmml" xref="alg1.l11.m2.5.6.3.2"><csymbol cd="ambiguous" id="alg1.l11.m2.5.6.3.2.1.cmml" xref="alg1.l11.m2.5.6.3.2">superscript</csymbol><ci id="alg1.l11.m2.5.6.3.2.2.cmml" xref="alg1.l11.m2.5.6.3.2.2">𝑠</ci><ci id="alg1.l11.m2.2.2.1.1.cmml" xref="alg1.l11.m2.2.2.1.1">𝑡</ci></apply><ci id="alg1.l11.m2.4.4.cmml" xref="alg1.l11.m2.4.4">𝜽</ci><ci id="alg1.l11.m2.5.6.3.4.cmml" xref="alg1.l11.m2.5.6.3.4">Δ</ci><ci id="alg1.l11.m2.5.5.cmml" xref="alg1.l11.m2.5.5">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.5c">s^{(t+1)}(\bm{\theta})\leftarrow s^{(t)}(\bm{\theta})\Delta(\bm{\theta})</annotation></semantics></math> to the server

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <span id="alg1.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
<div id="S2.SS2.p5" class="ltx_para">
<p id="S2.SS2.p5.1" class="ltx_p">We can further notice an interesting similarity of the <span id="S2.SS2.p5.1.1" class="ltx_text ltx_font_typewriter">VIRTUAL</span> algorithm to the <em id="S2.SS2.p5.1.2" class="ltx_emph ltx_font_italic">Progress&amp;Compress</em> method for CL introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>, where a similar free energy is obtained heuristically by composing CL regularization terms and distillation cost functions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>.</p>
</div>
<div id="S2.SS2.p6" class="ltx_para">
<p id="S2.SS2.p6.2" class="ltx_p">In the experimental section we will make use of a slight modification of the free energy given in <a href="#S2.Ex2" title="Proposition 1. ‣ II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> where the KL divergence terms are weighted by a regularization multiplier <math id="S2.SS2.p6.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S2.SS2.p6.1.m1.1a"><mi id="S2.SS2.p6.1.m1.1.1" xref="S2.SS2.p6.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.1.m1.1b"><ci id="S2.SS2.p6.1.m1.1.1.cmml" xref="S2.SS2.p6.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.1.m1.1c">\beta</annotation></semantics></math>. The Kl multiplier has been widely used already in other scenarios, e.g., disentanglement in unsupervised learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, where it has been shown that at different values of <math id="S2.SS2.p6.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S2.SS2.p6.2.m2.1a"><mi id="S2.SS2.p6.2.m2.1.1" xref="S2.SS2.p6.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p6.2.m2.1b"><ci id="S2.SS2.p6.2.m2.1.1.cmml" xref="S2.SS2.p6.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p6.2.m2.1c">\beta</annotation></semantics></math> achieves various degree of disentanglement in the embedding space. We will show also in this case that a tuning of the KL multiplier can enhance the performance of the model.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We here provide a brief survey of work in the area of distributed/federated learning and of transfer/continual learning, in light of the problem at hand described in <a href="#S1" title="I Introduction ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">I</span></a> and of the tools used in deriving <span id="S3.p1.1.1" class="ltx_text ltx_font_typewriter">VIRTUAL</span>.</p>
</div>
<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Distributed and Federated Learning</h4>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p1.1" class="ltx_p">Distributed learning is a learning paradigm for which the optimization of a generic model is distributed in a parallel computing environment with centralized data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Early work on this paradigm propose various learning strategies that require iterative averaging of locally trained models, typically using Stochastic Gradient Descent (<span id="S3.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_typewriter">SGD</span>) steps in the local optimization routine <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
Distributed learning typically consider the learning to be set in a computational cluster, hence with few computing devices, fast and reliable communication between devices, and centralized unbalanced datasets.
FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> eliminates all these latter constraints and it is framed as a paradigm that encompasses the new challenges and desiderata listed in <a href="#S1" title="I Introduction ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">I</span></a>.
<span id="S3.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> has been proposed as a straightforward heuristic for the FL. At each step of the algorithm, a subset of online clients is selected randomly, and these are then updated locally using <span id="S3.SS0.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_typewriter">SGD</span>. The models are then averaged to form the model at the next step, which is maintained in the server and transmitted back to all clients. Despite working well in practice, it has been shown that the performance of <span id="S3.SS0.SSS0.Px1.p1.1.4" class="ltx_text ltx_font_typewriter">FedAvg</span> can degrade significantly for skewed non-IID data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite>.</p>
</div>
<div id="S3.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p2.1" class="ltx_p">Some heuristics have been proposed recently to solve the statistical challenges of FL. In particular recently it has been proposed to share part of the client-generated data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib63" title="" class="ltx_ref">63</a>]</cite> or a server-trained generative model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> to the whole network of clients.
These solutions are however questionable since they require significant communication effort and do not comply with the standard privacy requirements of FL.
Another solution for this problem has been proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>, where the authors extend <span id="S3.SS0.SSS0.Px1.p2.1.1" class="ltx_text ltx_font_typewriter">FedAvg</span> into <span id="S3.SS0.SSS0.Px1.p2.1.2" class="ltx_text ltx_font_typewriter">FedProx</span>, an algorithm that prescribes clients to optimize the local loss function, further regularized with an quadratic penalty anchored on the weights of the previous step.
Despite showing improvements on the <span id="S3.SS0.SSS0.Px1.p2.1.3" class="ltx_text ltx_font_typewriter">FedAvg</span> algorithm for highly data-heterogeneous settings, the method is strongly inspired by early works on continual and transfer learning (see, e.g., Elastic Weight consolidation in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> and the literature review in the next paragraph) and hence can be further refined.</p>
</div>
<div id="S3.SS0.SSS0.Px1.p3" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p3.1" class="ltx_p">The first contribution to highlight the possibility of naturally embedding FL in the MTL framework has been reported by <span id="S3.SS0.SSS0.Px1.p3.1.1" class="ltx_text ltx_font_typewriter">MOCHA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, that extends some early work on distributed MTL-like <span id="S3.SS0.SSS0.Px1.p3.1.2" class="ltx_text ltx_font_typewriter">CoCoA</span> and variations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>.
In this work a federated primal-dual optimization algorithm is derived for <em id="S3.SS0.SSS0.Px1.p3.1.3" class="ltx_emph ltx_font_italic">convex</em> models with MTL regularization, and it is shown for the first time that the MTL framework can enhance the model performance, with the MTL model outperforming global models (trained with centralized data) and local models as well, on real world federated datasets.
This method, however, can be only used on convex models, hence it does not constitute a usable benchmark for deep learning models that are used in the experimental section here.</p>
</div>
<div id="S3.SS0.SSS0.Px1.p4" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p4.1" class="ltx_p">More recently, multiple efforts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>, <a href="#bib.bib56" title="" class="ltx_ref">56</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> have been made to align and match the weights of client models before aggregation in a layer-wise fashion. This is done to minimize the effect of averaging model weights that do not correspond to each other, due to the overparametrization and the symmetry of neural network parametrization. Note that, despite such efforts are applied to standard algorithms as FedAvg, they can be extended to our framework seamlessly.</p>
</div>
<div id="S3.SS0.SSS0.Px1.p5" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p5.1" class="ltx_p">A Bayesian approach for distributed datasets, similar to the method proposed in this paper, is developed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, where Expectation Propagation (EP) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> and its variations are performed on a generic partition of the dataset for distributed inference. However, the authors propose only a <em id="S3.SS0.SSS0.Px1.p5.1.1" class="ltx_emph ltx_font_italic">global</em> model, hence with no structure of shared and non shared parameters between the server and clients. The training is further performed according to a single loss function, hence not in a MTL setting. Moreover, inference is performed using heavy MCMC methods to estimate the moment of the local distributions, limiting the scale of the model considered.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, a further variational framework for generic partitioned data is described. It can be noted that the frameworks proposed encompasse also our method if applied to the particular MTL BayesNet in <a href="#S2.F1.sf1" title="In Figure 1 ‣ II-A The Bayesian network ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1a</span></a>. However the case study and the experimental section are focused on a classic EP algorithm based on moment matching and heavy MCMC simulation for moment estimation, and hence it can only address limited size models.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Transfer and Continual Learning</h4>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p1.1" class="ltx_p">The transfer of knowledge in neural network, from one task to another, has been used extensively and with great success since the pioneering work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> of transferring information from a generative to a discriminative model using fine tuning.
The application of this straightforward procedure is however difficult to apply in scenarios where multiple tasks from which to transfer from are available.
Indeed a good target performance can be obtained only with a priori knowledge of task similarity, that is usually not known, while learning of sequential tasks causes knowledge of previous tasks to be abruptly erased from the network in what has been called <em id="S3.SS0.SSS0.Px2.p1.1.1" class="ltx_emph ltx_font_italic">catastrophic forgetting</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
<div id="S3.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p2.1" class="ltx_p">Many methods have been introduced to overcome catastrophic forgetting, and to enable models to learn multiple task sequentially retaining a good overall performance, and transferring effectively to new tasks. Many early works proposed different regularization terms of the loss function anchored to the previous solution in order to achieve new solutions that generalize well on old tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>. These methods have been first introduced as heuristics, but have been found to be applications of well-known inference algorithms like <em id="S3.SS0.SSS0.Px2.p2.1.1" class="ltx_emph ltx_font_italic">Laplace Propagation</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite> and <em id="S3.SS0.SSS0.Px2.p2.1.2" class="ltx_emph ltx_font_italic">Streaming Variational Bayes</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, which led to further generalizations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. New approaches focused on other components, like architecture innovations, introducing lateral connections that allow new models to reuse knowledge from previously trained models with <em id="S3.SS0.SSS0.Px2.p2.1.3" class="ltx_emph ltx_font_italic">layer-wise adaptors</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>, and memory enhanced models with generative networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>. A recently introduced online Bayesian inference approach <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> served as inspiration for our work. It frames the continual learning paradigm in the Bayesian inference framework, establishing a posterior distribution over network parameters that is updated for any new task in light of the new likelihood function. It has been shown that this method outperformed all previously known methods for CL.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section we present an empirical evaluation of the performance of <span id="S4.p1.1.1" class="ltx_text ltx_font_typewriter">VIRTUAL</span> on three real-world federated datasets that well represent both the challenges of federated training and of multi-task learning. Due to the fact that in VIRTUAL clients retain a private model at every round, experiments performed on a simulated network on a single GPU have a memory cost that scales linearly with the number of clients (compared to FedAvg that has a constant memory cost on simulation as well). For this reason, the number of clients is bounded in all experiments to 100. Note however that this drawback does <em id="S4.p1.1.2" class="ltx_emph ltx_font_italic">not</em> extend to a real network of devices, as in the latter case the client model is retained by the device, and the memory cost at the server side is constant w.r.t the number of clients.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Dataset description</span>
</h3>

<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Statistics of the datasets used in the experiments.</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T1.1.1.2.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S4.T1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T1.1.1.3.1" class="ltx_text ltx_font_bold">K</span></th>
<th id="S4.T1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt">
<span id="S4.T1.1.1.1.1" class="ltx_text ltx_font_bold">Size</span> (<math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><mo id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><approx id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\approx</annotation></semantics></math>)</th>
<th id="S4.T1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S4.T1.1.1.4.1" class="ltx_text ltx_font_bold">Size/K</span></th>
</tr>
<tr id="S4.T1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.2.1.1" class="ltx_td ltx_th ltx_th_row"></th>
<th id="S4.T1.1.2.1.2" class="ltx_td ltx_th ltx_th_column ltx_th_row"></th>
<th id="S4.T1.1.2.1.3" class="ltx_td ltx_th ltx_th_column"></th>
<th id="S4.T1.1.2.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">mean</th>
<th id="S4.T1.1.2.1.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_th ltx_th_column ltx_border_t">std</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.3.1" class="ltx_tr">
<th id="S4.T1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FEMNIST</th>
<th id="S4.T1.1.3.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">100</th>
<td id="S4.T1.1.3.1.3" class="ltx_td ltx_align_right ltx_border_t">55k</td>
<td id="S4.T1.1.3.1.4" class="ltx_td ltx_align_right ltx_border_t">0.5k</td>
<td id="S4.T1.1.3.1.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t">54</td>
</tr>
<tr id="S4.T1.1.4.2" class="ltx_tr">
<th id="S4.T1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MNIST</th>
<th id="S4.T1.1.4.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_row">100</th>
<td id="S4.T1.1.4.2.3" class="ltx_td ltx_align_right">60k</td>
<td id="S4.T1.1.4.2.4" class="ltx_td ltx_align_right">600</td>
<td id="S4.T1.1.4.2.5" class="ltx_td ltx_nopad_r ltx_align_right">0</td>
</tr>
<tr id="S4.T1.1.5.3" class="ltx_tr">
<th id="S4.T1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PMNIST</th>
<th id="S4.T1.1.5.3.2" class="ltx_td ltx_align_right ltx_th ltx_th_row">100</th>
<td id="S4.T1.1.5.3.3" class="ltx_td ltx_align_right">60k</td>
<td id="S4.T1.1.5.3.4" class="ltx_td ltx_align_right">600</td>
<td id="S4.T1.1.5.3.5" class="ltx_td ltx_nopad_r ltx_align_right">0</td>
</tr>
<tr id="S4.T1.1.6.4" class="ltx_tr">
<th id="S4.T1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">VSN</th>
<th id="S4.T1.1.6.4.2" class="ltx_td ltx_align_right ltx_th ltx_th_row">23</th>
<td id="S4.T1.1.6.4.3" class="ltx_td ltx_align_right">68k</td>
<td id="S4.T1.1.6.4.4" class="ltx_td ltx_align_right">3k</td>
<td id="S4.T1.1.6.4.5" class="ltx_td ltx_nopad_r ltx_align_right">559</td>
</tr>
<tr id="S4.T1.1.7.5" class="ltx_tr">
<th id="S4.T1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">HAR</th>
<th id="S4.T1.1.7.5.2" class="ltx_td ltx_align_right ltx_th ltx_th_row">30</th>
<td id="S4.T1.1.7.5.3" class="ltx_td ltx_align_right">15k</td>
<td id="S4.T1.1.7.5.4" class="ltx_td ltx_align_right">0.5k</td>
<td id="S4.T1.1.7.5.5" class="ltx_td ltx_nopad_r ltx_align_right">56</td>
</tr>
<tr id="S4.T1.1.8.6" class="ltx_tr">
<th id="S4.T1.1.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">NLP</th>
<th id="S4.T1.1.8.6.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_bb">100</th>
<td id="S4.T1.1.8.6.3" class="ltx_td ltx_align_right ltx_border_bb">1.2m</td>
<td id="S4.T1.1.8.6.4" class="ltx_td ltx_align_right ltx_border_bb">13k</td>
<td id="S4.T1.1.8.6.5" class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb">11k</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">FEMNIST</span>: This dataset consists of a federated version of the EMNIST dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, maintained by the <em id="S4.SS1.p1.1.2" class="ltx_emph ltx_font_italic">LEAF</em> project <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Different clients correspond to different writers. We subsample 100 random writers and use only the 10 digit labels. Train and test split is provided by the distribution.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Vehicle Sensors Network (VSN)<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnote1.1.1.1" class="ltx_text ltx_font_medium">1</span></span><a target="_blank" href="http://www.ecs.umass.edu/~mduarte/Software.html" title="" class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium">http://www.ecs.umass.edu/~mduarte/Software.html</a></span></span></span></span>: A network of 23 different sensors (including seismic, acoustic, and passive infra-red sensors) are place around a road segment to classify vehicles driving through. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. The raw signal is featurized in the original paper into 50 acoustic and 50 seismic features. We consider every sensor as a client and perform the binary classification of assault amphibious and dragon wagon vehicles.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Human Activity Recognition (HAR)<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span id="footnote2.1.1.1" class="ltx_text ltx_font_medium">2</span></span><a target="_blank" href="https://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones" title="" class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium">https://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones</a></span></span></span></span>: Recordings of 30 subjects performing daily activities are collected using a waist-mounted smartphone with inertial sensors. The raw signal is divided into windows and featurized into a 561-length vector <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Every individual corresponds to a different client and we perform classification of 12 different activities (e.g., sitting, walking). For both the VSN and the HAR, a 75%-25% train-test split is performed.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">MNIST</span>: The classic MNIST dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, randomly split into 100 different sections, one section per client. Every client has 600 training samples and 100 test samples. This dataset represents an atypical federated dataset with very homogeneous clients, both in terms of dataset sizes and in term of statistical properties of samples.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p"><span id="S4.SS1.p5.1.1" class="ltx_text ltx_font_bold">Permuted MNIST (PMNIST)</span>: The MNIST dataset is randomly split into 100 sections as above, and a random permutation of pixels is applied to every single client dataset. This dataset has been introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> in the context of continual learning and represent a strongly non-IID federated dataset, with low level features being very dissimilar between clients.</p>
</div>
<div id="S4.SS1.p6" class="ltx_para">
<p id="S4.SS1.p6.1" class="ltx_p"><span id="S4.SS1.p6.1.1" class="ltx_text ltx_font_bold">Shakespeare (NLP)</span>: This dataset is built concatenating the whole literary production of William Shakespeare <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. The task here considered is English words spelling, hence the next character prediction task, over a vocabulary size of 86. The characters are arranged in sequences of 80 and further aggregated in batches of 10 sequences. Every role of a play is considered as a individual client, and we excluded roles that do not contain a single full batch.</p>
</div>
<div id="S4.SS1.p7" class="ltx_para">
<p id="S4.SS1.p7.1" class="ltx_p">A comprehensive description of the statistics of the datasets used is available in <a href="#S4.T1" title="In IV-A Dataset description ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">I</span></a>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Experimental setting</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We consider a multilayer perceptrons (MLP) with two hidden dense layers (with local reparametrization for the Bayesian counterpart <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>) with 100 units and ReLU activation functions in the hidden layers, and softmax activation at the output layer.
For the NLP task, we use a two-layer LSTM classifier with 100 hidden units per layer and an 8D embedding layer. The Bayesian model makes use of Bayesian LSTMs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and Bayesian Gaussian Embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>.
We further use a convolutional neural network for the FEMNIST dataset with two convolutional layers with kernel size 5 and number of filter respectively 32 and 64. We use max-pooling after both convolutional layers, then we adopt an MLP as described above on the flattened activations.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.2" class="ltx_p">Using the notation of the original paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, all methods are evaluated in all experiments with a number of updated clients per round <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="C=10" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">C</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝐶</ci><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">C=10</annotation></semantics></math> and a number of epochs per round <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="E=20" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">E</mi><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></eq><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝐸</ci><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">E=20</annotation></semantics></math>, that is high enough to be meaningful on a FL setting, to guarantee convergence in all scenarios <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> while being challenging on complex tasks, like in the case of the Shakespeare dataset.
Hyperparameter optimization is performed over a grid of 5 log-spaced <em id="S4.SS2.p2.2.1" class="ltx_emph ltx_font_italic">client</em> learning rates. Vanilla SGD optimizer is used as the local optimizer for every client.
Implementation of <span id="S4.SS2.p2.2.2" class="ltx_text ltx_font_typewriter">VIRTUAL</span> is based on <em id="S4.SS2.p2.2.3" class="ltx_emph ltx_font_italic">tensorflow</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and <em id="S4.SS2.p2.2.4" class="ltx_emph ltx_font_italic">tensorflow distributions</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> packages.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Metrics</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">At every round and for any given metric (cross-entropy loss or accuracy), we report two different variations: (i) The centralized metric measured by the central server (S) tested on all client test data; (ii) the Multi-Task (MT) metric measured as the average test metric of all clients models.
In both cases, the average is weighted by the client dataset size. For the case of a non-MTL approach (like FedAvg and FedProx), we measure the MT metric using the model that every client deployed last, while in the case of an MTL setting as in Virtual, every client maintains a private model that is tested at every round.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Effect of the kl divergence weight</span>
</h3>

<figure id="S4.F2" class="ltx_figure"><img src="/html/1906.06268/assets/x1.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="259" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Regularization effect of the KL divergence on the cross-entropy loss. For the FEMNIST dataset, we report the server and the MT cross-entropy loss during training at different values of the KL divergence multiplier <math id="S4.F2.2.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.F2.2.m1.1b"><mi id="S4.F2.2.m1.1.1" xref="S4.F2.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.F2.2.m1.1c"><ci id="S4.F2.2.m1.1.1.cmml" xref="S4.F2.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.2.m1.1d">\beta</annotation></semantics></math>. Thick lines represent moving averages with window size 20. Log-scale is applied on both the y scale and the color bar.</figcaption>
</figure>
<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.10" class="ltx_p">We first study the effect of the KL divergence multiplier <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\beta</annotation></semantics></math> on the performance of an MLP network in the FEMNIST dataset.
We can observe from <a href="#S4.F2" title="In IV-D Effect of the kl divergence weight ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> that values of <math id="S4.SS4.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\beta</annotation></semantics></math> in the range <math id="S4.SS4.p1.3.m3.1" class="ltx_Math" alttext="10^{-6}-10^{-3}" display="inline"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><msup id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml"><mn id="S4.SS4.p1.3.m3.1.1.2.2" xref="S4.SS4.p1.3.m3.1.1.2.2.cmml">10</mn><mrow id="S4.SS4.p1.3.m3.1.1.2.3" xref="S4.SS4.p1.3.m3.1.1.2.3.cmml"><mo id="S4.SS4.p1.3.m3.1.1.2.3a" xref="S4.SS4.p1.3.m3.1.1.2.3.cmml">−</mo><mn id="S4.SS4.p1.3.m3.1.1.2.3.2" xref="S4.SS4.p1.3.m3.1.1.2.3.2.cmml">6</mn></mrow></msup><mo id="S4.SS4.p1.3.m3.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.cmml">−</mo><msup id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml"><mn id="S4.SS4.p1.3.m3.1.1.3.2" xref="S4.SS4.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.p1.3.m3.1.1.3.3" xref="S4.SS4.p1.3.m3.1.1.3.3.cmml"><mo id="S4.SS4.p1.3.m3.1.1.3.3a" xref="S4.SS4.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS4.p1.3.m3.1.1.3.3.2" xref="S4.SS4.p1.3.m3.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><minus id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></minus><apply id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.2.1.cmml" xref="S4.SS4.p1.3.m3.1.1.2">superscript</csymbol><cn type="integer" id="S4.SS4.p1.3.m3.1.1.2.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2.2">10</cn><apply id="S4.SS4.p1.3.m3.1.1.2.3.cmml" xref="S4.SS4.p1.3.m3.1.1.2.3"><minus id="S4.SS4.p1.3.m3.1.1.2.3.1.cmml" xref="S4.SS4.p1.3.m3.1.1.2.3"></minus><cn type="integer" id="S4.SS4.p1.3.m3.1.1.2.3.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2.3.2">6</cn></apply></apply><apply id="S4.SS4.p1.3.m3.1.1.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.p1.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS4.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.p1.3.m3.1.1.3.2">10</cn><apply id="S4.SS4.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.p1.3.m3.1.1.3.3"><minus id="S4.SS4.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS4.p1.3.m3.1.1.3.3"></minus><cn type="integer" id="S4.SS4.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS4.p1.3.m3.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">10^{-6}-10^{-3}</annotation></semantics></math> do not impair the performance of the model. For a higher value of <math id="S4.SS4.p1.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS4.p1.4.m4.1a"><mi id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><ci id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\beta</annotation></semantics></math> the leading term in the free energy <a href="#S2.Ex2" title="Proposition 1. ‣ II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> is given by the regularization term and the reconstruction loss is negligible.
From <a href="#S4.F2" title="In IV-D Effect of the kl divergence weight ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a> we can further observe that in the range of adequate values of <math id="S4.SS4.p1.5.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS4.p1.5.m5.1a"><mi id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><ci id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">\beta</annotation></semantics></math>, the server performance is not affected, while increased generalization is achieved in the MT loss, with the <math id="S4.SS4.p1.6.m6.1" class="ltx_Math" alttext="\beta=10^{-5}" display="inline"><semantics id="S4.SS4.p1.6.m6.1a"><mrow id="S4.SS4.p1.6.m6.1.1" xref="S4.SS4.p1.6.m6.1.1.cmml"><mi id="S4.SS4.p1.6.m6.1.1.2" xref="S4.SS4.p1.6.m6.1.1.2.cmml">β</mi><mo id="S4.SS4.p1.6.m6.1.1.1" xref="S4.SS4.p1.6.m6.1.1.1.cmml">=</mo><msup id="S4.SS4.p1.6.m6.1.1.3" xref="S4.SS4.p1.6.m6.1.1.3.cmml"><mn id="S4.SS4.p1.6.m6.1.1.3.2" xref="S4.SS4.p1.6.m6.1.1.3.2.cmml">10</mn><mrow id="S4.SS4.p1.6.m6.1.1.3.3" xref="S4.SS4.p1.6.m6.1.1.3.3.cmml"><mo id="S4.SS4.p1.6.m6.1.1.3.3a" xref="S4.SS4.p1.6.m6.1.1.3.3.cmml">−</mo><mn id="S4.SS4.p1.6.m6.1.1.3.3.2" xref="S4.SS4.p1.6.m6.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.6.m6.1b"><apply id="S4.SS4.p1.6.m6.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1"><eq id="S4.SS4.p1.6.m6.1.1.1.cmml" xref="S4.SS4.p1.6.m6.1.1.1"></eq><ci id="S4.SS4.p1.6.m6.1.1.2.cmml" xref="S4.SS4.p1.6.m6.1.1.2">𝛽</ci><apply id="S4.SS4.p1.6.m6.1.1.3.cmml" xref="S4.SS4.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.6.m6.1.1.3.1.cmml" xref="S4.SS4.p1.6.m6.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS4.p1.6.m6.1.1.3.2.cmml" xref="S4.SS4.p1.6.m6.1.1.3.2">10</cn><apply id="S4.SS4.p1.6.m6.1.1.3.3.cmml" xref="S4.SS4.p1.6.m6.1.1.3.3"><minus id="S4.SS4.p1.6.m6.1.1.3.3.1.cmml" xref="S4.SS4.p1.6.m6.1.1.3.3"></minus><cn type="integer" id="S4.SS4.p1.6.m6.1.1.3.3.2.cmml" xref="S4.SS4.p1.6.m6.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.6.m6.1c">\beta=10^{-5}</annotation></semantics></math> being the best performing model.
In all following experiments, we tune the <math id="S4.SS4.p1.7.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS4.p1.7.m7.1a"><mi id="S4.SS4.p1.7.m7.1.1" xref="S4.SS4.p1.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.7.m7.1b"><ci id="S4.SS4.p1.7.m7.1.1.cmml" xref="S4.SS4.p1.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.7.m7.1c">\beta</annotation></semantics></math> parameter and the <math id="S4.SS4.p1.8.m8.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S4.SS4.p1.8.m8.1a"><msub id="S4.SS4.p1.8.m8.1.1" xref="S4.SS4.p1.8.m8.1.1.cmml"><mi id="S4.SS4.p1.8.m8.1.1.2" xref="S4.SS4.p1.8.m8.1.1.2.cmml">l</mi><mn id="S4.SS4.p1.8.m8.1.1.3" xref="S4.SS4.p1.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.8.m8.1b"><apply id="S4.SS4.p1.8.m8.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.8.m8.1.1.1.cmml" xref="S4.SS4.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS4.p1.8.m8.1.1.2.cmml" xref="S4.SS4.p1.8.m8.1.1.2">𝑙</ci><cn type="integer" id="S4.SS4.p1.8.m8.1.1.3.cmml" xref="S4.SS4.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.8.m8.1c">l_{2}</annotation></semantics></math> regularizer in the case of the FedProx baseline (with <math id="S4.SS4.p1.9.m9.1" class="ltx_Math" alttext="\beta=0" display="inline"><semantics id="S4.SS4.p1.9.m9.1a"><mrow id="S4.SS4.p1.9.m9.1.1" xref="S4.SS4.p1.9.m9.1.1.cmml"><mi id="S4.SS4.p1.9.m9.1.1.2" xref="S4.SS4.p1.9.m9.1.1.2.cmml">β</mi><mo id="S4.SS4.p1.9.m9.1.1.1" xref="S4.SS4.p1.9.m9.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.9.m9.1.1.3" xref="S4.SS4.p1.9.m9.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.9.m9.1b"><apply id="S4.SS4.p1.9.m9.1.1.cmml" xref="S4.SS4.p1.9.m9.1.1"><eq id="S4.SS4.p1.9.m9.1.1.1.cmml" xref="S4.SS4.p1.9.m9.1.1.1"></eq><ci id="S4.SS4.p1.9.m9.1.1.2.cmml" xref="S4.SS4.p1.9.m9.1.1.2">𝛽</ci><cn type="integer" id="S4.SS4.p1.9.m9.1.1.3.cmml" xref="S4.SS4.p1.9.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.9.m9.1c">\beta=0</annotation></semantics></math> corresponding to FedAvg) in a log-spaced grid of 5 values.
We denote as FedProx the best model with a <math id="S4.SS4.p1.10.m10.1" class="ltx_Math" alttext="l_{2}" display="inline"><semantics id="S4.SS4.p1.10.m10.1a"><msub id="S4.SS4.p1.10.m10.1.1" xref="S4.SS4.p1.10.m10.1.1.cmml"><mi id="S4.SS4.p1.10.m10.1.1.2" xref="S4.SS4.p1.10.m10.1.1.2.cmml">l</mi><mn id="S4.SS4.p1.10.m10.1.1.3" xref="S4.SS4.p1.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.10.m10.1b"><apply id="S4.SS4.p1.10.m10.1.1.cmml" xref="S4.SS4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.10.m10.1.1.1.cmml" xref="S4.SS4.p1.10.m10.1.1">subscript</csymbol><ci id="S4.SS4.p1.10.m10.1.1.2.cmml" xref="S4.SS4.p1.10.m10.1.1.2">𝑙</ci><cn type="integer" id="S4.SS4.p1.10.m10.1.1.3.cmml" xref="S4.SS4.p1.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.10.m10.1c">l_{2}</annotation></semantics></math> multiplier strictly larger than 0.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/1906.06268/assets/x2.png" id="S4.F3.g1" class="ltx_graphics ltx_img_landscape" width="461" height="178" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Central server (first row) and multi-task (MT, second row) cross-entropy loss as a function of the federated training round. For every dataset (column) we report the loss of the two baselines FedAvg and FedProx and our method Virtual. For the FEMNIST dataset, we report both the performance of the MLP and the convolutional NN architecture. For all the other datasets, only the performance of one model is showed (LSTM architecture in the Shakespeare datasets, MLPs on all the others). Log-scale is used in the y-axis.</figcaption>
</figure>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">Full results</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">In this section, we evaluate the performance of our proposed method and the baselines FedAvg and FedProx in terms of both server and multi-tasks performance.</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<p id="S4.SS5.p2.1" class="ltx_p"><span id="S4.SS5.p2.1.1" class="ltx_text ltx_font_bold">Metric comparison.</span>
From <a href="#S4.F3" title="In IV-D Effect of the kl divergence weight ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a> we can first observe that the MT metric is uniformly more stable than the respective server variant since the former assumes clients retaining a private model until further training, while the latter assumes a server model that is updated at every single round, hence experiencing more stochasticity during the training process. Moreover, the MT metric is typically delayed compared to the server counterpart since clients are updated on average only every <math id="S4.SS5.p2.1.m1.1" class="ltx_Math" alttext="K/C" display="inline"><semantics id="S4.SS5.p2.1.m1.1a"><mrow id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml"><mi id="S4.SS5.p2.1.m1.1.1.2" xref="S4.SS5.p2.1.m1.1.1.2.cmml">K</mi><mo id="S4.SS5.p2.1.m1.1.1.1" xref="S4.SS5.p2.1.m1.1.1.1.cmml">/</mo><mi id="S4.SS5.p2.1.m1.1.1.3" xref="S4.SS5.p2.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><apply id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1"><divide id="S4.SS5.p2.1.m1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1.1"></divide><ci id="S4.SS5.p2.1.m1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.1.1.2">𝐾</ci><ci id="S4.SS5.p2.1.m1.1.1.3.cmml" xref="S4.SS5.p2.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">K/C</annotation></semantics></math> rounds. This is responsible for the slower progress of the MT metric, with the values of the losses in the first stages of training being up to a factor of 10 larger than the server counterpart.
We further notice from <a href="#S4.F3" title="In IV-D Effect of the kl divergence weight ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a> (last column) that the MT metrics are typically superior to the centralized metrics (with some exceptions that are examined thoroughly in the following), showing that, at convergence, clients can personalize the model to a specific private dataset.</p>
</div>
<div id="S4.SS5.p3" class="ltx_para">
<p id="S4.SS5.p3.2" class="ltx_p"><span id="S4.SS5.p3.2.1" class="ltx_text ltx_font_bold">Method comparison.</span>
In <a href="#S4.T2" title="In IV-E Full results ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">II</span></a> we additionally report the maximum accuracy achieved at convergence by the baselines FedAvg and FedProx and our method in all datasets.
We can observe that our method outperforms both baselines in almost all datasets (except in the PMNIST datasets) and with all neural network architectures considered (MLPs, convolutional and RNNs).
Virtual is able to achieve up to <math id="S4.SS5.p3.1.m1.1" class="ltx_Math" alttext="+2\%" display="inline"><semantics id="S4.SS5.p3.1.m1.1a"><mrow id="S4.SS5.p3.1.m1.1.1" xref="S4.SS5.p3.1.m1.1.1.cmml"><mo id="S4.SS5.p3.1.m1.1.1a" xref="S4.SS5.p3.1.m1.1.1.cmml">+</mo><mrow id="S4.SS5.p3.1.m1.1.1.2" xref="S4.SS5.p3.1.m1.1.1.2.cmml"><mn id="S4.SS5.p3.1.m1.1.1.2.2" xref="S4.SS5.p3.1.m1.1.1.2.2.cmml">2</mn><mo id="S4.SS5.p3.1.m1.1.1.2.1" xref="S4.SS5.p3.1.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.1.m1.1b"><apply id="S4.SS5.p3.1.m1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1"><plus id="S4.SS5.p3.1.m1.1.1.1.cmml" xref="S4.SS5.p3.1.m1.1.1"></plus><apply id="S4.SS5.p3.1.m1.1.1.2.cmml" xref="S4.SS5.p3.1.m1.1.1.2"><csymbol cd="latexml" id="S4.SS5.p3.1.m1.1.1.2.1.cmml" xref="S4.SS5.p3.1.m1.1.1.2.1">percent</csymbol><cn type="integer" id="S4.SS5.p3.1.m1.1.1.2.2.cmml" xref="S4.SS5.p3.1.m1.1.1.2.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.1.m1.1c">+2\%</annotation></semantics></math> and <math id="S4.SS5.p3.2.m2.1" class="ltx_Math" alttext="+1\%" display="inline"><semantics id="S4.SS5.p3.2.m2.1a"><mrow id="S4.SS5.p3.2.m2.1.1" xref="S4.SS5.p3.2.m2.1.1.cmml"><mo id="S4.SS5.p3.2.m2.1.1a" xref="S4.SS5.p3.2.m2.1.1.cmml">+</mo><mrow id="S4.SS5.p3.2.m2.1.1.2" xref="S4.SS5.p3.2.m2.1.1.2.cmml"><mn id="S4.SS5.p3.2.m2.1.1.2.2" xref="S4.SS5.p3.2.m2.1.1.2.2.cmml">1</mn><mo id="S4.SS5.p3.2.m2.1.1.2.1" xref="S4.SS5.p3.2.m2.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS5.p3.2.m2.1b"><apply id="S4.SS5.p3.2.m2.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1"><plus id="S4.SS5.p3.2.m2.1.1.1.cmml" xref="S4.SS5.p3.2.m2.1.1"></plus><apply id="S4.SS5.p3.2.m2.1.1.2.cmml" xref="S4.SS5.p3.2.m2.1.1.2"><csymbol cd="latexml" id="S4.SS5.p3.2.m2.1.1.2.1.cmml" xref="S4.SS5.p3.2.m2.1.1.2.1">percent</csymbol><cn type="integer" id="S4.SS5.p3.2.m2.1.1.2.2.cmml" xref="S4.SS5.p3.2.m2.1.1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p3.2.m2.1c">+1\%</annotation></semantics></math> in maximum accuracy respectively in the MT and S variant in the FEMNIST, MNIST and Shakespeare datasets, and marginally outperforms the baselines in VSN.
The Shakespeare dataset is particularly crucial.
In this dataset, the S metrics are superior then the MT metrics, implying that, at convergence, the clients that train further on the private datasets impair their performance.
This follows likely from the high heterogeneity of the size of the Shakespeare datasets (see the last row in <a href="#S4.T1" title="In IV-A Dataset description ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">I</span></a>), that can cause clients with a small dataset to over-fit the private data and under-perform the central server model.
Our proposed method performs particularly well in this scenario, causing only a slight reduction of the MT compared to the S accuracy.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Server (S) and Multi-Task (MT) max accuracy over all dataset at convergence. Values are given in percentage.</figcaption>
<table id="S4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T2.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S4.T2.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S4.T2.1.1.1.2.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="S4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.1.1.1.3.1" class="ltx_text ltx_font_bold">FedAvg</span></th>
<th id="S4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.1.1.1.4.1" class="ltx_text ltx_font_bold">FedProx</span></th>
<th id="S4.T2.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.1.1.1.5.1" class="ltx_text ltx_font_bold">Virtual</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.1.2.1" class="ltx_tr">
<th id="S4.T2.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="S4.T2.1.2.1.1.1" class="ltx_text">
<span id="S4.T2.1.2.1.1.1.1" class="ltx_inline-block ltx_align_left">
<span id="S4.T2.1.2.1.1.1.1.1" class="ltx_p">FEMNIST</span>
<span id="S4.T2.1.2.1.1.1.1.2" class="ltx_p">MLP</span>
</span></span></th>
<th id="S4.T2.1.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">MT</th>
<td id="S4.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">94.3</td>
<td id="S4.T2.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">94.5</td>
<td id="S4.T2.1.2.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S4.T2.1.2.1.5.1" class="ltx_text ltx_font_bold">95.7</span></td>
</tr>
<tr id="S4.T2.1.3.2" class="ltx_tr">
<th id="S4.T2.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">S</th>
<td id="S4.T2.1.3.2.2" class="ltx_td ltx_align_center">90.2</td>
<td id="S4.T2.1.3.2.3" class="ltx_td ltx_align_center">89.9</td>
<td id="S4.T2.1.3.2.4" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.3.2.4.1" class="ltx_text ltx_font_bold">90.9</span></td>
</tr>
<tr id="S4.T2.1.4.3" class="ltx_tr">
<th id="S4.T2.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" rowspan="2"><span id="S4.T2.1.4.3.1.1" class="ltx_text">
<span id="S4.T2.1.4.3.1.1.1" class="ltx_inline-block ltx_align_left">
<span id="S4.T2.1.4.3.1.1.1.1" class="ltx_p">FEMNIST</span>
<span id="S4.T2.1.4.3.1.1.1.2" class="ltx_p">Conv</span>
</span></span></th>
<th id="S4.T2.1.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">MT</th>
<td id="S4.T2.1.4.3.3" class="ltx_td ltx_align_center">97.3</td>
<td id="S4.T2.1.4.3.4" class="ltx_td ltx_align_center">97.0</td>
<td id="S4.T2.1.4.3.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.4.3.5.1" class="ltx_text ltx_font_bold">98.2</span></td>
</tr>
<tr id="S4.T2.1.5.4" class="ltx_tr">
<th id="S4.T2.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">S</th>
<td id="S4.T2.1.5.4.2" class="ltx_td ltx_align_center">95.5</td>
<td id="S4.T2.1.5.4.3" class="ltx_td ltx_align_center">95.5</td>
<td id="S4.T2.1.5.4.4" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.5.4.4.1" class="ltx_text ltx_font_bold">97.3</span></td>
</tr>
<tr id="S4.T2.1.6.5" class="ltx_tr">
<th id="S4.T2.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" rowspan="2"><span id="S4.T2.1.6.5.1.1" class="ltx_text">MNIST</span></th>
<th id="S4.T2.1.6.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">MT</th>
<td id="S4.T2.1.6.5.3" class="ltx_td ltx_align_center">96.9</td>
<td id="S4.T2.1.6.5.4" class="ltx_td ltx_align_center">96.9</td>
<td id="S4.T2.1.6.5.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.6.5.5.1" class="ltx_text ltx_font_bold">97.4</span></td>
</tr>
<tr id="S4.T2.1.7.6" class="ltx_tr">
<th id="S4.T2.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">S</th>
<td id="S4.T2.1.7.6.2" class="ltx_td ltx_align_center">97.6</td>
<td id="S4.T2.1.7.6.3" class="ltx_td ltx_align_center">97.6</td>
<td id="S4.T2.1.7.6.4" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.7.6.4.1" class="ltx_text ltx_font_bold">97.8</span></td>
</tr>
<tr id="S4.T2.1.8.7" class="ltx_tr">
<th id="S4.T2.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" rowspan="2"><span id="S4.T2.1.8.7.1.1" class="ltx_text">PMNIST</span></th>
<th id="S4.T2.1.8.7.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">MT</th>
<td id="S4.T2.1.8.7.3" class="ltx_td ltx_align_center"><span id="S4.T2.1.8.7.3.1" class="ltx_text ltx_font_bold">85.9</span></td>
<td id="S4.T2.1.8.7.4" class="ltx_td ltx_align_center">85.6</td>
<td id="S4.T2.1.8.7.5" class="ltx_td ltx_nopad_r ltx_align_center">84.2</td>
</tr>
<tr id="S4.T2.1.9.8" class="ltx_tr">
<th id="S4.T2.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">S</th>
<td id="S4.T2.1.9.8.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.9.8.2.1" class="ltx_text ltx_font_bold">48.3</span></td>
<td id="S4.T2.1.9.8.3" class="ltx_td ltx_align_center">47.5</td>
<td id="S4.T2.1.9.8.4" class="ltx_td ltx_nopad_r ltx_align_center">42.5</td>
</tr>
<tr id="S4.T2.1.10.9" class="ltx_tr">
<th id="S4.T2.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" rowspan="2"><span id="S4.T2.1.10.9.1.1" class="ltx_text">VSN</span></th>
<th id="S4.T2.1.10.9.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">MT</th>
<td id="S4.T2.1.10.9.3" class="ltx_td ltx_align_center">96.2</td>
<td id="S4.T2.1.10.9.4" class="ltx_td ltx_align_center">96.0</td>
<td id="S4.T2.1.10.9.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.10.9.5.1" class="ltx_text ltx_font_bold">96.6</span></td>
</tr>
<tr id="S4.T2.1.11.10" class="ltx_tr">
<th id="S4.T2.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">S</th>
<td id="S4.T2.1.11.10.2" class="ltx_td ltx_align_center"><span id="S4.T2.1.11.10.2.1" class="ltx_text ltx_font_bold">89.6</span></td>
<td id="S4.T2.1.11.10.3" class="ltx_td ltx_align_center">89.5</td>
<td id="S4.T2.1.11.10.4" class="ltx_td ltx_nopad_r ltx_align_center">88.8</td>
</tr>
<tr id="S4.T2.1.12.11" class="ltx_tr">
<th id="S4.T2.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" rowspan="2"><span id="S4.T2.1.12.11.1.1" class="ltx_text">HAR</span></th>
<th id="S4.T2.1.12.11.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">MT</th>
<td id="S4.T2.1.12.11.3" class="ltx_td ltx_align_center">98.9</td>
<td id="S4.T2.1.12.11.4" class="ltx_td ltx_align_center"><span id="S4.T2.1.12.11.4.1" class="ltx_text ltx_font_bold">99.4</span></td>
<td id="S4.T2.1.12.11.5" class="ltx_td ltx_nopad_r ltx_align_center">99.1</td>
</tr>
<tr id="S4.T2.1.13.12" class="ltx_tr">
<th id="S4.T2.1.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">S</th>
<td id="S4.T2.1.13.12.2" class="ltx_td ltx_align_center">94.0</td>
<td id="S4.T2.1.13.12.3" class="ltx_td ltx_align_center">94.0</td>
<td id="S4.T2.1.13.12.4" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.13.12.4.1" class="ltx_text ltx_font_bold">94.3</span></td>
</tr>
<tr id="S4.T2.1.14.13" class="ltx_tr">
<th id="S4.T2.1.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" rowspan="2"><span id="S4.T2.1.14.13.1.1" class="ltx_text">NLP</span></th>
<th id="S4.T2.1.14.13.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">MT</th>
<td id="S4.T2.1.14.13.3" class="ltx_td ltx_align_center">46.1</td>
<td id="S4.T2.1.14.13.4" class="ltx_td ltx_align_center">46.4</td>
<td id="S4.T2.1.14.13.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.1.14.13.5.1" class="ltx_text ltx_font_bold">48.4</span></td>
</tr>
<tr id="S4.T2.1.15.14" class="ltx_tr">
<th id="S4.T2.1.15.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">S</th>
<td id="S4.T2.1.15.14.2" class="ltx_td ltx_align_center ltx_border_bb">48.1</td>
<td id="S4.T2.1.15.14.3" class="ltx_td ltx_align_center ltx_border_bb">48.5</td>
<td id="S4.T2.1.15.14.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="S4.T2.1.15.14.4.1" class="ltx_text ltx_font_bold">48.6</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS6.6.1.1" class="ltx_text">IV-F</span> </span><span id="S4.SS6.7.2" class="ltx_text ltx_font_italic">Inducing sparse updates</span>
</h3>

<div id="S4.SS6.p1" class="ltx_para">
<p id="S4.SS6.p1.2" class="ltx_p">The use of a Bayesian framework allows us to estimate the importance of the client <math id="S4.SS6.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS6.p1.1.m1.1a"><mi id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><ci id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">i</annotation></semantics></math> using the property of the client posterior distributions and client un-normalized updates distributions <math id="S4.SS6.p1.2.m2.1" class="ltx_Math" alttext="\Delta_{i}" display="inline"><semantics id="S4.SS6.p1.2.m2.1a"><msub id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS6.p1.2.m2.1.1.2" xref="S4.SS6.p1.2.m2.1.1.2.cmml">Δ</mi><mi id="S4.SS6.p1.2.m2.1.1.3" xref="S4.SS6.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><apply id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.2.m2.1.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p1.2.m2.1.1.2.cmml" xref="S4.SS6.p1.2.m2.1.1.2">Δ</ci><ci id="S4.SS6.p1.2.m2.1.1.3.cmml" xref="S4.SS6.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">\Delta_{i}</annotation></semantics></math>.
In <a href="#S4.F4" title="In IV-F Inducing sparse updates ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a> we examine the cumulative distribution function (CDF) of the signal-to-noise (SNR) of the weights of the client posteriors. A CDF located on the right-hand side of the plot represents a compressible network, with only a small ratio of the weights with high SNR being determinant in the model performance (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> for an application of this concept to simple neural network pruning).
For comparison, we also implement a variation of the Virtual method that retains the client loss function used in Virtual, and in addition initializes the weights of the client with the server posterior at the beginning of every training round (Virtual + FedAvg init in <a href="#S4.F4" title="In IV-F Inducing sparse updates ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">fig.</span> <span class="ltx_text ltx_ref_tag">4</span></a>). In these plots, we observe that the server initialization forces all clients to learn a complex model (larger CDF), while with no such initialization the clients specialize to the task at hand with a small ratio of weights.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/1906.06268/assets/x3.png" id="S4.F4.g1" class="ltx_graphics ltx_img_landscape" width="461" height="285" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Cumulative distribution function of the signal-to-noise ratio (reported in log scale) for all clients and for the three consecutive dense layer of the network. Clients that are not initialized with the server weights at each round show a more compressible model. Simulation performed on the FEMNIST dataset on an MLP architecture.</figcaption>
</figure>
<div id="S4.SS6.p2" class="ltx_para">
<p id="S4.SS6.p2.1" class="ltx_p">We, therefore, design a simple updated pruning procedure that sparsifies the client updates setting to zero all <math id="S4.SS6.p2.1.m1.1" class="ltx_Math" alttext="\Delta_{i}" display="inline"><semantics id="S4.SS6.p2.1.m1.1a"><msub id="S4.SS6.p2.1.m1.1.1" xref="S4.SS6.p2.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.SS6.p2.1.m1.1.1.2" xref="S4.SS6.p2.1.m1.1.1.2.cmml">Δ</mi><mi id="S4.SS6.p2.1.m1.1.1.3" xref="S4.SS6.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p2.1.m1.1b"><apply id="S4.SS6.p2.1.m1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p2.1.m1.1.1.1.cmml" xref="S4.SS6.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS6.p2.1.m1.1.1.2.cmml" xref="S4.SS6.p2.1.m1.1.1.2">Δ</ci><ci id="S4.SS6.p2.1.m1.1.1.3.cmml" xref="S4.SS6.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p2.1.m1.1c">\Delta_{i}</annotation></semantics></math> elements that have a SNR smaller than a given percentile.
The results are reported in <a href="#S4.SS6" title="IV-F Inducing sparse updates ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">section</span> <span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-F</span></span></a>.
Virtual greatly outperforms the FedAvg initialization variant and retains a superior performance compared to the FedProx method (compare with <a href="#S4.T2" title="In IV-E Full results ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">II</span></a>, first and second row) up to an induced sparsity of 75%.
This is equivalent to a 50% communication reduction cost compared to FedProx, factoring the use of a Bayesian Neural Network that uses twice as many parameters as a standard deterministic network.</p>
</div>
<figure id="S4.SS6.1" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Max accuracy at various levels of updates sparsity. Pruning is performed using the signal-to-noise-ratio of the updates.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="S4.SS6.1.2" class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.SS6.1.2.1.1" class="ltx_tr">
<th id="S4.SS6.1.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt">
<span id="S4.SS6.1.2.1.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS6.1.2.1.1.1.1.1" class="ltx_p" style="width:48.4pt;"><span id="S4.SS6.1.2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">% pruned</span></span>
</span>
</th>
<th id="S4.SS6.1.2.1.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S4.SS6.1.2.1.1.3" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S4.SS6.1.2.1.1.4" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<td id="S4.SS6.1.2.1.1.5" class="ltx_td ltx_border_tt"></td>
</tr>
<tr id="S4.SS6.1.2.2.2" class="ltx_tr">
<th id="S4.SS6.1.2.2.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_column">weights</th>
<th id="S4.SS6.1.2.2.2.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column">
<span id="S4.SS6.1.2.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS6.1.2.2.2.2.1.1" class="ltx_p" style="width:25.6pt;"><span id="S4.SS6.1.2.2.2.2.1.1.1" class="ltx_text ltx_font_bold">Delta</span></span>
</span>
</th>
<th id="S4.SS6.1.2.2.2.3" class="ltx_td ltx_th ltx_th_column"></th>
<th id="S4.SS6.1.2.2.2.4" class="ltx_td ltx_th ltx_th_column"></th>
<td id="S4.SS6.1.2.2.2.5" class="ltx_td"></td>
</tr>
<tr id="S4.SS6.1.2.3.3" class="ltx_tr">
<td id="S4.SS6.1.2.3.3.1" class="ltx_td"></td>
<th id="S4.SS6.1.2.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="S4.SS6.1.2.3.3.2.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="S4.SS6.1.2.3.3.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column">
<span id="S4.SS6.1.2.3.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS6.1.2.3.3.3.1.1" class="ltx_p" style="width:59.8pt;"><span id="S4.SS6.1.2.3.3.3.1.1.1" class="ltx_text ltx_font_bold">Virtual +</span></span>
</span>
</th>
<th id="S4.SS6.1.2.3.3.4" class="ltx_td ltx_th ltx_th_column"></th>
<td id="S4.SS6.1.2.3.3.5" class="ltx_td"></td>
</tr>
<tr id="S4.SS6.1.2.4.4" class="ltx_tr">
<td id="S4.SS6.1.2.4.4.1" class="ltx_td"></td>
<th id="S4.SS6.1.2.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="S4.SS6.1.2.4.4.2.1" class="ltx_text ltx_font_bold">Virtual</span></th>
<th id="S4.SS6.1.2.4.4.3" class="ltx_td ltx_align_right ltx_th ltx_th_column" colspan="-1">FedAvg init</th>
<th id="S4.SS6.1.2.4.4.4" class="ltx_td ltx_th ltx_th_column"></th>
<td id="S4.SS6.1.2.4.4.5" class="ltx_td"></td>
</tr>
<tr id="S4.SS6.1.2.5.5" class="ltx_tr">
<td id="S4.SS6.1.2.5.5.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.SS6.1.2.5.5.1.1" class="ltx_text">0%</span></td>
<td id="S4.SS6.1.2.5.5.2" class="ltx_td ltx_align_left ltx_border_t" rowspan="2"><span id="S4.SS6.1.2.5.5.2.1" class="ltx_text">158k</span></td>
<td id="S4.SS6.1.2.5.5.3" class="ltx_td ltx_align_left ltx_border_t">MT</td>
<td id="S4.SS6.1.2.5.5.4" class="ltx_td ltx_align_center ltx_border_t">86.2</td>
<td id="S4.SS6.1.2.5.5.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S4.SS6.1.2.5.5.5.1" class="ltx_text ltx_font_bold">95.6</span></td>
</tr>
<tr id="S4.SS6.1.2.6.6" class="ltx_tr">
<td id="S4.SS6.1.2.6.6.1" class="ltx_td ltx_align_left">S</td>
<td id="S4.SS6.1.2.6.6.2" class="ltx_td ltx_align_center">89.4</td>
<td id="S4.SS6.1.2.6.6.3" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS6.1.2.6.6.3.1" class="ltx_text ltx_font_bold">90.9</span></td>
</tr>
<tr id="S4.SS6.1.2.7.7" class="ltx_tr">
<td id="S4.SS6.1.2.7.7.1" class="ltx_td ltx_align_center" rowspan="2"><span id="S4.SS6.1.2.7.7.1.1" class="ltx_text">50%</span></td>
<td id="S4.SS6.1.2.7.7.2" class="ltx_td ltx_align_left" rowspan="2"><span id="S4.SS6.1.2.7.7.2.1" class="ltx_text">79k</span></td>
<td id="S4.SS6.1.2.7.7.3" class="ltx_td ltx_align_left">MT</td>
<td id="S4.SS6.1.2.7.7.4" class="ltx_td ltx_align_center">76.3</td>
<td id="S4.SS6.1.2.7.7.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS6.1.2.7.7.5.1" class="ltx_text ltx_font_bold">94.3</span></td>
</tr>
<tr id="S4.SS6.1.2.8.8" class="ltx_tr">
<td id="S4.SS6.1.2.8.8.1" class="ltx_td ltx_align_left">S</td>
<td id="S4.SS6.1.2.8.8.2" class="ltx_td ltx_align_center">81.8</td>
<td id="S4.SS6.1.2.8.8.3" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS6.1.2.8.8.3.1" class="ltx_text ltx_font_bold">89.2</span></td>
</tr>
<tr id="S4.SS6.1.2.9.9" class="ltx_tr">
<td id="S4.SS6.1.2.9.9.1" class="ltx_td ltx_align_center" rowspan="2"><span id="S4.SS6.1.2.9.9.1.1" class="ltx_text">75%</span></td>
<td id="S4.SS6.1.2.9.9.2" class="ltx_td ltx_align_left" rowspan="2"><span id="S4.SS6.1.2.9.9.2.1" class="ltx_text">40k</span></td>
<td id="S4.SS6.1.2.9.9.3" class="ltx_td ltx_align_left">MT</td>
<td id="S4.SS6.1.2.9.9.4" class="ltx_td ltx_align_center">78.7</td>
<td id="S4.SS6.1.2.9.9.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS6.1.2.9.9.5.1" class="ltx_text ltx_font_bold">94.9</span></td>
</tr>
<tr id="S4.SS6.1.2.10.10" class="ltx_tr">
<td id="S4.SS6.1.2.10.10.1" class="ltx_td ltx_align_left">S</td>
<td id="S4.SS6.1.2.10.10.2" class="ltx_td ltx_align_center">80.4</td>
<td id="S4.SS6.1.2.10.10.3" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS6.1.2.10.10.3.1" class="ltx_text ltx_font_bold">90.8</span></td>
</tr>
<tr id="S4.SS6.1.2.11.11" class="ltx_tr">
<td id="S4.SS6.1.2.11.11.1" class="ltx_td ltx_align_center ltx_border_bb" rowspan="2"><span id="S4.SS6.1.2.11.11.1.1" class="ltx_text">90%</span></td>
<td id="S4.SS6.1.2.11.11.2" class="ltx_td ltx_align_left ltx_border_bb" rowspan="2"><span id="S4.SS6.1.2.11.11.2.1" class="ltx_text">16k</span></td>
<td id="S4.SS6.1.2.11.11.3" class="ltx_td ltx_align_left">MT</td>
<td id="S4.SS6.1.2.11.11.4" class="ltx_td ltx_align_center">25.5</td>
<td id="S4.SS6.1.2.11.11.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.SS6.1.2.11.11.5.1" class="ltx_text ltx_font_bold">48.5</span></td>
</tr>
<tr id="S4.SS6.1.2.12.12" class="ltx_tr">
<td id="S4.SS6.1.2.12.12.1" class="ltx_td ltx_align_left ltx_border_bb">S</td>
<td id="S4.SS6.1.2.12.12.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.SS6.1.2.12.12.2.1" class="ltx_text ltx_font_bold">21.0</span></td>
<td id="S4.SS6.1.2.12.12.3" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">20.3</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.SS6.1.3" class="ltx_p ltx_figure_panel">Note that the scenario here described is very different from usual pruning performed on NNs, as in the latter case the pruning is performed only at test time (or after fine tuning) on fully trained NN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, or a priori on a carefully initialized NN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> while in our case the pruning is performed at every training round (hence at every E epochs of training), making it much a much harder task at a high level of pruning.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<section id="S5" class="ltx_section ltx_figure_panel">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work we introduced <span id="S5.p1.1.1" class="ltx_text ltx_font_typewriter">VIRTUAL</span>, an algorithm for federated learning that tackles the well-known statistical challenges of the federated learning framework in a multi-task setting.
We consider the federation of a central server and clients as a Bayesian network and perform training using approximated variational inference.
The algorithm naturally complies with the federated setting desiderata, giving access to the central server only to an aggregated parameter update in the form of an overall posterior distribution over shared parameters.
The algorithm is shown to outperform the state-of-the-art in many IID and non-IID real world federated datasets.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">One possible direction for further developments is to consider synchronous updates of multiple clients (as preliminary seen already in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>) studying empirically the effect of using outdated priors during client training or theoretically developing a new Bayesian model of synchronous updates.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">Another interesting direction is the exploration of other design choices. Indeed the general method can be tuned for a particular application by modifying, e.g., the architecture of lateral connections between devices (Block-Modular NN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>, NinN architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>), the topology of the Bayesian network (star shape, hierarchical etc.), the choice of the variational inference algorithm.
Finally, it is possible to study thoroughly <span id="S5.p3.1.1" class="ltx_text ltx_font_typewriter">VIRTUAL</span> under memory constraints, using more sophisticated pruning procedures, sparsity inducing losses or using optimal strategy for data storage, in the line of coresets theory.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional experiments</h2>

<figure id="A1.fig1" class="ltx_figure">
</figure>
<figure id="A1.F4.sf2" class="ltx_figure"><img src="/html/1906.06268/assets/x4.png" id="A1.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="447" height="186" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Server, Multi-Task and training accuracy over all datasets considered.</figcaption>
</figure>
</section>
</section>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Figure 5: </span>Additional learning curves.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<p id="S4.SS6.1.4" class="ltx_p ltx_figure_panel">In this section, we report the additional learning curves that are not reported in the main text, i.e., training cross-entropy in <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:fig:losses_20</span> and the server, MT and training accuracies in <a href="#A1.F4.sf2" title="In Appendix A Additional experiments ‣ V Conclusion ‣ IV-F Inducing sparse updates ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4b</span></a> for the dataset considered, and for both MLPs and ConvNet architectures in the case of the FEMNIST dataset.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.SS6.1.1" class="ltx_p ltx_figure_panel">In <a href="#A1.F6" title="In IV-F Inducing sparse updates ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">6</span></a> we also report the learning curves obtained in an additional experiment performed on the FEMNIST dataset, with the epochs per round parameter set to <math id="S4.SS6.1.1.m1.1" class="ltx_Math" alttext="E=100" display="inline"><semantics id="S4.SS6.1.1.m1.1a"><mrow id="S4.SS6.1.1.m1.1.1" xref="S4.SS6.1.1.m1.1.1.cmml"><mi id="S4.SS6.1.1.m1.1.1.2" xref="S4.SS6.1.1.m1.1.1.2.cmml">E</mi><mo id="S4.SS6.1.1.m1.1.1.1" xref="S4.SS6.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS6.1.1.m1.1.1.3" xref="S4.SS6.1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.1.1.m1.1b"><apply id="S4.SS6.1.1.m1.1.1.cmml" xref="S4.SS6.1.1.m1.1.1"><eq id="S4.SS6.1.1.m1.1.1.1.cmml" xref="S4.SS6.1.1.m1.1.1.1"></eq><ci id="S4.SS6.1.1.m1.1.1.2.cmml" xref="S4.SS6.1.1.m1.1.1.2">𝐸</ci><cn type="integer" id="S4.SS6.1.1.m1.1.1.3.cmml" xref="S4.SS6.1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.1.1.m1.1c">E=100</annotation></semantics></math>, to show the applicability of the method in scenarios of higher node computational load. We can observe that also in this scenario Virtual outperforms both FedAvg and FedProx using MLPs and ConvNet architectures. In <a href="#A1.T4" title="In IV-F Inducing sparse updates ‣ IV Experiments ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">table</span> <span class="ltx_text ltx_ref_tag">IV</span></a> the maximum MT and server accuracies are reported, with Virtual achieving a +0.4% and +0.9% respectively on MLPs and convolutional architectures.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="A1.F6" class="ltx_figure ltx_figure_panel"><img src="/html/1906.06268/assets/x5.png" id="A1.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="81" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Learning curves for the FEMNIST dataset with epochs per round set at <math id="A1.F6.2.m1.1" class="ltx_Math" alttext="E=100" display="inline"><semantics id="A1.F6.2.m1.1b"><mrow id="A1.F6.2.m1.1.1" xref="A1.F6.2.m1.1.1.cmml"><mi id="A1.F6.2.m1.1.1.2" xref="A1.F6.2.m1.1.1.2.cmml">E</mi><mo id="A1.F6.2.m1.1.1.1" xref="A1.F6.2.m1.1.1.1.cmml">=</mo><mn id="A1.F6.2.m1.1.1.3" xref="A1.F6.2.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F6.2.m1.1c"><apply id="A1.F6.2.m1.1.1.cmml" xref="A1.F6.2.m1.1.1"><eq id="A1.F6.2.m1.1.1.1.cmml" xref="A1.F6.2.m1.1.1.1"></eq><ci id="A1.F6.2.m1.1.1.2.cmml" xref="A1.F6.2.m1.1.1.2">𝐸</ci><cn type="integer" id="A1.F6.2.m1.1.1.3.cmml" xref="A1.F6.2.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F6.2.m1.1d">E=100</annotation></semantics></math>, simulating a high node computation scenario.</figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.T4" class="ltx_table ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Server (S) and Multi-Task (MT) maximum accuracy over all datasets at convergence, with <math id="A1.T4.2.m1.1" class="ltx_Math" alttext="E=100" display="inline"><semantics id="A1.T4.2.m1.1b"><mrow id="A1.T4.2.m1.1.1" xref="A1.T4.2.m1.1.1.cmml"><mi id="A1.T4.2.m1.1.1.2" xref="A1.T4.2.m1.1.1.2.cmml">E</mi><mo id="A1.T4.2.m1.1.1.1" xref="A1.T4.2.m1.1.1.1.cmml">=</mo><mn id="A1.T4.2.m1.1.1.3" xref="A1.T4.2.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.2.m1.1c"><apply id="A1.T4.2.m1.1.1.cmml" xref="A1.T4.2.m1.1.1"><eq id="A1.T4.2.m1.1.1.1.cmml" xref="A1.T4.2.m1.1.1.1"></eq><ci id="A1.T4.2.m1.1.1.2.cmml" xref="A1.T4.2.m1.1.1.2">𝐸</ci><cn type="integer" id="A1.T4.2.m1.1.1.3.cmml" xref="A1.T4.2.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.2.m1.1d">E=100</annotation></semantics></math> epochs per round. Values are given in percentage.</figcaption>
<table id="A1.T4.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.3.1.1" class="ltx_tr">
<th id="A1.T4.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="A1.T4.3.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="A1.T4.3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="A1.T4.3.1.1.2.1" class="ltx_text ltx_font_bold">Metric</span></th>
<th id="A1.T4.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A1.T4.3.1.1.3.1" class="ltx_text ltx_font_bold">FedAvg</span></th>
<th id="A1.T4.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A1.T4.3.1.1.4.1" class="ltx_text ltx_font_bold">FedProx</span></th>
<th id="A1.T4.3.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A1.T4.3.1.1.5.1" class="ltx_text ltx_font_bold">Virtual</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.3.2.1" class="ltx_tr">
<th id="A1.T4.3.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="A1.T4.3.2.1.1.1" class="ltx_text">
<span id="A1.T4.3.2.1.1.1.1" class="ltx_inline-block ltx_align_left">
<span id="A1.T4.3.2.1.1.1.1.1" class="ltx_p">FEMNIST</span>
<span id="A1.T4.3.2.1.1.1.1.2" class="ltx_p">MLP</span>
</span></span></th>
<th id="A1.T4.3.2.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">MT</th>
<td id="A1.T4.3.2.1.3" class="ltx_td ltx_align_center ltx_border_t">92.7</td>
<td id="A1.T4.3.2.1.4" class="ltx_td ltx_align_center ltx_border_t">92.8</td>
<td id="A1.T4.3.2.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="A1.T4.3.2.1.5.1" class="ltx_text ltx_font_bold">93.2</span></td>
</tr>
<tr id="A1.T4.3.3.2" class="ltx_tr">
<th id="A1.T4.3.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">S</th>
<td id="A1.T4.3.3.2.2" class="ltx_td ltx_align_center">86.2</td>
<td id="A1.T4.3.3.2.3" class="ltx_td ltx_align_center">86.6</td>
<td id="A1.T4.3.3.2.4" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A1.T4.3.3.2.4.1" class="ltx_text ltx_font_bold">87.6</span></td>
</tr>
<tr id="A1.T4.3.4.3" class="ltx_tr">
<th id="A1.T4.3.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" rowspan="2"><span id="A1.T4.3.4.3.1.1" class="ltx_text">
<span id="A1.T4.3.4.3.1.1.1" class="ltx_inline-block ltx_align_left">
<span id="A1.T4.3.4.3.1.1.1.1" class="ltx_p">FEMNIST</span>
<span id="A1.T4.3.4.3.1.1.1.2" class="ltx_p">Conv</span>
</span></span></th>
<th id="A1.T4.3.4.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">MT</th>
<td id="A1.T4.3.4.3.3" class="ltx_td ltx_align_center">97.0</td>
<td id="A1.T4.3.4.3.4" class="ltx_td ltx_align_center">97.3</td>
<td id="A1.T4.3.4.3.5" class="ltx_td ltx_nopad_r ltx_align_center"><span id="A1.T4.3.4.3.5.1" class="ltx_text ltx_font_bold">98.2</span></td>
</tr>
<tr id="A1.T4.3.5.4" class="ltx_tr">
<th id="A1.T4.3.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">S</th>
<td id="A1.T4.3.5.4.2" class="ltx_td ltx_align_center ltx_border_bb">95.5</td>
<td id="A1.T4.3.5.4.3" class="ltx_td ltx_align_center ltx_border_bb">95.6</td>
<td id="A1.T4.3.5.4.4" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb"><span id="A1.T4.3.5.4.4.1" class="ltx_text ltx_font_bold">97.3</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<section id="A2" class="ltx_appendix ltx_figure_panel">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>The Gaussian case</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.4" class="ltx_p">The Virtual method requires to compute the so-called (un-normalized) cavity distributions <math id="A2.p1.1.m1.2" class="ltx_Math" alttext="\frac{s(\theta)}{s_{i}(\theta)}" display="inline"><semantics id="A2.p1.1.m1.2a"><mfrac id="A2.p1.1.m1.2.2" xref="A2.p1.1.m1.2.2.cmml"><mrow id="A2.p1.1.m1.1.1.1" xref="A2.p1.1.m1.1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.1.3" xref="A2.p1.1.m1.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="A2.p1.1.m1.1.1.1.2" xref="A2.p1.1.m1.1.1.1.2.cmml">​</mo><mrow id="A2.p1.1.m1.1.1.1.4.2" xref="A2.p1.1.m1.1.1.1.cmml"><mo stretchy="false" id="A2.p1.1.m1.1.1.1.4.2.1" xref="A2.p1.1.m1.1.1.1.cmml">(</mo><mi id="A2.p1.1.m1.1.1.1.1" xref="A2.p1.1.m1.1.1.1.1.cmml">θ</mi><mo stretchy="false" id="A2.p1.1.m1.1.1.1.4.2.2" xref="A2.p1.1.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.p1.1.m1.2.2.2" xref="A2.p1.1.m1.2.2.2.cmml"><msub id="A2.p1.1.m1.2.2.2.3" xref="A2.p1.1.m1.2.2.2.3.cmml"><mi id="A2.p1.1.m1.2.2.2.3.2" xref="A2.p1.1.m1.2.2.2.3.2.cmml">s</mi><mi id="A2.p1.1.m1.2.2.2.3.3" xref="A2.p1.1.m1.2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A2.p1.1.m1.2.2.2.2" xref="A2.p1.1.m1.2.2.2.2.cmml">​</mo><mrow id="A2.p1.1.m1.2.2.2.4.2" xref="A2.p1.1.m1.2.2.2.cmml"><mo stretchy="false" id="A2.p1.1.m1.2.2.2.4.2.1" xref="A2.p1.1.m1.2.2.2.cmml">(</mo><mi id="A2.p1.1.m1.2.2.2.1" xref="A2.p1.1.m1.2.2.2.1.cmml">θ</mi><mo stretchy="false" id="A2.p1.1.m1.2.2.2.4.2.2" xref="A2.p1.1.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.2b"><apply id="A2.p1.1.m1.2.2.cmml" xref="A2.p1.1.m1.2.2"><divide id="A2.p1.1.m1.2.2.3.cmml" xref="A2.p1.1.m1.2.2"></divide><apply id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1"><times id="A2.p1.1.m1.1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.1.2"></times><ci id="A2.p1.1.m1.1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.1.3">𝑠</ci><ci id="A2.p1.1.m1.1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1.1">𝜃</ci></apply><apply id="A2.p1.1.m1.2.2.2.cmml" xref="A2.p1.1.m1.2.2.2"><times id="A2.p1.1.m1.2.2.2.2.cmml" xref="A2.p1.1.m1.2.2.2.2"></times><apply id="A2.p1.1.m1.2.2.2.3.cmml" xref="A2.p1.1.m1.2.2.2.3"><csymbol cd="ambiguous" id="A2.p1.1.m1.2.2.2.3.1.cmml" xref="A2.p1.1.m1.2.2.2.3">subscript</csymbol><ci id="A2.p1.1.m1.2.2.2.3.2.cmml" xref="A2.p1.1.m1.2.2.2.3.2">𝑠</ci><ci id="A2.p1.1.m1.2.2.2.3.3.cmml" xref="A2.p1.1.m1.2.2.2.3.3">𝑖</ci></apply><ci id="A2.p1.1.m1.2.2.2.1.cmml" xref="A2.p1.1.m1.2.2.2.1">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.2c">\frac{s(\theta)}{s_{i}(\theta)}</annotation></semantics></math>, the client deltas <math id="A2.p1.2.m2.2" class="ltx_Math" alttext="\Delta_{i}=\frac{s(\theta)}{s_{i}(\theta)}" display="inline"><semantics id="A2.p1.2.m2.2a"><mrow id="A2.p1.2.m2.2.3" xref="A2.p1.2.m2.2.3.cmml"><msub id="A2.p1.2.m2.2.3.2" xref="A2.p1.2.m2.2.3.2.cmml"><mi mathvariant="normal" id="A2.p1.2.m2.2.3.2.2" xref="A2.p1.2.m2.2.3.2.2.cmml">Δ</mi><mi id="A2.p1.2.m2.2.3.2.3" xref="A2.p1.2.m2.2.3.2.3.cmml">i</mi></msub><mo id="A2.p1.2.m2.2.3.1" xref="A2.p1.2.m2.2.3.1.cmml">=</mo><mfrac id="A2.p1.2.m2.2.2" xref="A2.p1.2.m2.2.2.cmml"><mrow id="A2.p1.2.m2.1.1.1" xref="A2.p1.2.m2.1.1.1.cmml"><mi id="A2.p1.2.m2.1.1.1.3" xref="A2.p1.2.m2.1.1.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.1.1.1.2" xref="A2.p1.2.m2.1.1.1.2.cmml">​</mo><mrow id="A2.p1.2.m2.1.1.1.4.2" xref="A2.p1.2.m2.1.1.1.cmml"><mo stretchy="false" id="A2.p1.2.m2.1.1.1.4.2.1" xref="A2.p1.2.m2.1.1.1.cmml">(</mo><mi id="A2.p1.2.m2.1.1.1.1" xref="A2.p1.2.m2.1.1.1.1.cmml">θ</mi><mo stretchy="false" id="A2.p1.2.m2.1.1.1.4.2.2" xref="A2.p1.2.m2.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.p1.2.m2.2.2.2" xref="A2.p1.2.m2.2.2.2.cmml"><msub id="A2.p1.2.m2.2.2.2.3" xref="A2.p1.2.m2.2.2.2.3.cmml"><mi id="A2.p1.2.m2.2.2.2.3.2" xref="A2.p1.2.m2.2.2.2.3.2.cmml">s</mi><mi id="A2.p1.2.m2.2.2.2.3.3" xref="A2.p1.2.m2.2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A2.p1.2.m2.2.2.2.2" xref="A2.p1.2.m2.2.2.2.2.cmml">​</mo><mrow id="A2.p1.2.m2.2.2.2.4.2" xref="A2.p1.2.m2.2.2.2.cmml"><mo stretchy="false" id="A2.p1.2.m2.2.2.2.4.2.1" xref="A2.p1.2.m2.2.2.2.cmml">(</mo><mi id="A2.p1.2.m2.2.2.2.1" xref="A2.p1.2.m2.2.2.2.1.cmml">θ</mi><mo stretchy="false" id="A2.p1.2.m2.2.2.2.4.2.2" xref="A2.p1.2.m2.2.2.2.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.2b"><apply id="A2.p1.2.m2.2.3.cmml" xref="A2.p1.2.m2.2.3"><eq id="A2.p1.2.m2.2.3.1.cmml" xref="A2.p1.2.m2.2.3.1"></eq><apply id="A2.p1.2.m2.2.3.2.cmml" xref="A2.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="A2.p1.2.m2.2.3.2.1.cmml" xref="A2.p1.2.m2.2.3.2">subscript</csymbol><ci id="A2.p1.2.m2.2.3.2.2.cmml" xref="A2.p1.2.m2.2.3.2.2">Δ</ci><ci id="A2.p1.2.m2.2.3.2.3.cmml" xref="A2.p1.2.m2.2.3.2.3">𝑖</ci></apply><apply id="A2.p1.2.m2.2.2.cmml" xref="A2.p1.2.m2.2.2"><divide id="A2.p1.2.m2.2.2.3.cmml" xref="A2.p1.2.m2.2.2"></divide><apply id="A2.p1.2.m2.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1"><times id="A2.p1.2.m2.1.1.1.2.cmml" xref="A2.p1.2.m2.1.1.1.2"></times><ci id="A2.p1.2.m2.1.1.1.3.cmml" xref="A2.p1.2.m2.1.1.1.3">𝑠</ci><ci id="A2.p1.2.m2.1.1.1.1.cmml" xref="A2.p1.2.m2.1.1.1.1">𝜃</ci></apply><apply id="A2.p1.2.m2.2.2.2.cmml" xref="A2.p1.2.m2.2.2.2"><times id="A2.p1.2.m2.2.2.2.2.cmml" xref="A2.p1.2.m2.2.2.2.2"></times><apply id="A2.p1.2.m2.2.2.2.3.cmml" xref="A2.p1.2.m2.2.2.2.3"><csymbol cd="ambiguous" id="A2.p1.2.m2.2.2.2.3.1.cmml" xref="A2.p1.2.m2.2.2.2.3">subscript</csymbol><ci id="A2.p1.2.m2.2.2.2.3.2.cmml" xref="A2.p1.2.m2.2.2.2.3.2">𝑠</ci><ci id="A2.p1.2.m2.2.2.2.3.3.cmml" xref="A2.p1.2.m2.2.2.2.3.3">𝑖</ci></apply><ci id="A2.p1.2.m2.2.2.2.1.cmml" xref="A2.p1.2.m2.2.2.2.1">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.2c">\Delta_{i}=\frac{s(\theta)}{s_{i}(\theta)}</annotation></semantics></math>, and deltas aggregation <math id="A2.p1.3.m3.1" class="ltx_Math" alttext="\Delta=\prod_{i\in\mathcal{C}_{t}}\Delta_{i}" display="inline"><semantics id="A2.p1.3.m3.1a"><mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mi mathvariant="normal" id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml">Δ</mi><mo rspace="0.111em" id="A2.p1.3.m3.1.1.1" xref="A2.p1.3.m3.1.1.1.cmml">=</mo><mrow id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml"><msub id="A2.p1.3.m3.1.1.3.1" xref="A2.p1.3.m3.1.1.3.1.cmml"><mo id="A2.p1.3.m3.1.1.3.1.2" xref="A2.p1.3.m3.1.1.3.1.2.cmml">∏</mo><mrow id="A2.p1.3.m3.1.1.3.1.3" xref="A2.p1.3.m3.1.1.3.1.3.cmml"><mi id="A2.p1.3.m3.1.1.3.1.3.2" xref="A2.p1.3.m3.1.1.3.1.3.2.cmml">i</mi><mo id="A2.p1.3.m3.1.1.3.1.3.1" xref="A2.p1.3.m3.1.1.3.1.3.1.cmml">∈</mo><msub id="A2.p1.3.m3.1.1.3.1.3.3" xref="A2.p1.3.m3.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.p1.3.m3.1.1.3.1.3.3.2" xref="A2.p1.3.m3.1.1.3.1.3.3.2.cmml">𝒞</mi><mi id="A2.p1.3.m3.1.1.3.1.3.3.3" xref="A2.p1.3.m3.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><msub id="A2.p1.3.m3.1.1.3.2" xref="A2.p1.3.m3.1.1.3.2.cmml"><mi mathvariant="normal" id="A2.p1.3.m3.1.1.3.2.2" xref="A2.p1.3.m3.1.1.3.2.2.cmml">Δ</mi><mi id="A2.p1.3.m3.1.1.3.2.3" xref="A2.p1.3.m3.1.1.3.2.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><eq id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1"></eq><ci id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2">Δ</ci><apply id="A2.p1.3.m3.1.1.3.cmml" xref="A2.p1.3.m3.1.1.3"><apply id="A2.p1.3.m3.1.1.3.1.cmml" xref="A2.p1.3.m3.1.1.3.1"><csymbol cd="ambiguous" id="A2.p1.3.m3.1.1.3.1.1.cmml" xref="A2.p1.3.m3.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="A2.p1.3.m3.1.1.3.1.2.cmml" xref="A2.p1.3.m3.1.1.3.1.2">product</csymbol><apply id="A2.p1.3.m3.1.1.3.1.3.cmml" xref="A2.p1.3.m3.1.1.3.1.3"><in id="A2.p1.3.m3.1.1.3.1.3.1.cmml" xref="A2.p1.3.m3.1.1.3.1.3.1"></in><ci id="A2.p1.3.m3.1.1.3.1.3.2.cmml" xref="A2.p1.3.m3.1.1.3.1.3.2">𝑖</ci><apply id="A2.p1.3.m3.1.1.3.1.3.3.cmml" xref="A2.p1.3.m3.1.1.3.1.3.3"><csymbol cd="ambiguous" id="A2.p1.3.m3.1.1.3.1.3.3.1.cmml" xref="A2.p1.3.m3.1.1.3.1.3.3">subscript</csymbol><ci id="A2.p1.3.m3.1.1.3.1.3.3.2.cmml" xref="A2.p1.3.m3.1.1.3.1.3.3.2">𝒞</ci><ci id="A2.p1.3.m3.1.1.3.1.3.3.3.cmml" xref="A2.p1.3.m3.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="A2.p1.3.m3.1.1.3.2.cmml" xref="A2.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="A2.p1.3.m3.1.1.3.2.1.cmml" xref="A2.p1.3.m3.1.1.3.2">subscript</csymbol><ci id="A2.p1.3.m3.1.1.3.2.2.cmml" xref="A2.p1.3.m3.1.1.3.2.2">Δ</ci><ci id="A2.p1.3.m3.1.1.3.2.3.cmml" xref="A2.p1.3.m3.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">\Delta=\prod_{i\in\mathcal{C}_{t}}\Delta_{i}</annotation></semantics></math> (see Algorithm 1 in the main text). Using a factorized Gaussian distribution over the weights as <math id="A2.p1.4.m4.2" class="ltx_Math" alttext="s_{i}(\bm{\theta})=\prod_{d=1}^{D^{s}}\mathcal{N}(\theta_{d}|\mu_{id}^{s},\sigma_{id}^{s})" display="inline"><semantics id="A2.p1.4.m4.2a"><mrow id="A2.p1.4.m4.2.2" xref="A2.p1.4.m4.2.2.cmml"><mrow id="A2.p1.4.m4.2.2.3" xref="A2.p1.4.m4.2.2.3.cmml"><msub id="A2.p1.4.m4.2.2.3.2" xref="A2.p1.4.m4.2.2.3.2.cmml"><mi id="A2.p1.4.m4.2.2.3.2.2" xref="A2.p1.4.m4.2.2.3.2.2.cmml">s</mi><mi id="A2.p1.4.m4.2.2.3.2.3" xref="A2.p1.4.m4.2.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A2.p1.4.m4.2.2.3.1" xref="A2.p1.4.m4.2.2.3.1.cmml">​</mo><mrow id="A2.p1.4.m4.2.2.3.3.2" xref="A2.p1.4.m4.2.2.3.cmml"><mo stretchy="false" id="A2.p1.4.m4.2.2.3.3.2.1" xref="A2.p1.4.m4.2.2.3.cmml">(</mo><mi id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml">𝜽</mi><mo stretchy="false" id="A2.p1.4.m4.2.2.3.3.2.2" xref="A2.p1.4.m4.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="A2.p1.4.m4.2.2.2" xref="A2.p1.4.m4.2.2.2.cmml">=</mo><mrow id="A2.p1.4.m4.2.2.1" xref="A2.p1.4.m4.2.2.1.cmml"><msubsup id="A2.p1.4.m4.2.2.1.2" xref="A2.p1.4.m4.2.2.1.2.cmml"><mo id="A2.p1.4.m4.2.2.1.2.2.2" xref="A2.p1.4.m4.2.2.1.2.2.2.cmml">∏</mo><mrow id="A2.p1.4.m4.2.2.1.2.2.3" xref="A2.p1.4.m4.2.2.1.2.2.3.cmml"><mi id="A2.p1.4.m4.2.2.1.2.2.3.2" xref="A2.p1.4.m4.2.2.1.2.2.3.2.cmml">d</mi><mo id="A2.p1.4.m4.2.2.1.2.2.3.1" xref="A2.p1.4.m4.2.2.1.2.2.3.1.cmml">=</mo><mn id="A2.p1.4.m4.2.2.1.2.2.3.3" xref="A2.p1.4.m4.2.2.1.2.2.3.3.cmml">1</mn></mrow><msup id="A2.p1.4.m4.2.2.1.2.3" xref="A2.p1.4.m4.2.2.1.2.3.cmml"><mi id="A2.p1.4.m4.2.2.1.2.3.2" xref="A2.p1.4.m4.2.2.1.2.3.2.cmml">D</mi><mi id="A2.p1.4.m4.2.2.1.2.3.3" xref="A2.p1.4.m4.2.2.1.2.3.3.cmml">s</mi></msup></msubsup><mrow id="A2.p1.4.m4.2.2.1.1" xref="A2.p1.4.m4.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.p1.4.m4.2.2.1.1.3" xref="A2.p1.4.m4.2.2.1.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.p1.4.m4.2.2.1.1.2" xref="A2.p1.4.m4.2.2.1.1.2.cmml">​</mo><mrow id="A2.p1.4.m4.2.2.1.1.1.1" xref="A2.p1.4.m4.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.p1.4.m4.2.2.1.1.1.1.2" xref="A2.p1.4.m4.2.2.1.1.1.1.1.cmml">(</mo><mrow id="A2.p1.4.m4.2.2.1.1.1.1.1" xref="A2.p1.4.m4.2.2.1.1.1.1.1.cmml"><msub id="A2.p1.4.m4.2.2.1.1.1.1.1.4" xref="A2.p1.4.m4.2.2.1.1.1.1.1.4.cmml"><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.4.2" xref="A2.p1.4.m4.2.2.1.1.1.1.1.4.2.cmml">θ</mi><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.4.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.4.3.cmml">d</mi></msub><mo fence="false" id="A2.p1.4.m4.2.2.1.1.1.1.1.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.3.cmml"><msubsup id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.2" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mrow id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">d</mi></mrow><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.cmml">s</mi></msubsup><mo id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.2" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mrow id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.2" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.1" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.3.cmml">d</mi></mrow><mi id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.3.cmml">s</mi></msubsup></mrow></mrow><mo stretchy="false" id="A2.p1.4.m4.2.2.1.1.1.1.3" xref="A2.p1.4.m4.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.2b"><apply id="A2.p1.4.m4.2.2.cmml" xref="A2.p1.4.m4.2.2"><eq id="A2.p1.4.m4.2.2.2.cmml" xref="A2.p1.4.m4.2.2.2"></eq><apply id="A2.p1.4.m4.2.2.3.cmml" xref="A2.p1.4.m4.2.2.3"><times id="A2.p1.4.m4.2.2.3.1.cmml" xref="A2.p1.4.m4.2.2.3.1"></times><apply id="A2.p1.4.m4.2.2.3.2.cmml" xref="A2.p1.4.m4.2.2.3.2"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.3.2.1.cmml" xref="A2.p1.4.m4.2.2.3.2">subscript</csymbol><ci id="A2.p1.4.m4.2.2.3.2.2.cmml" xref="A2.p1.4.m4.2.2.3.2.2">𝑠</ci><ci id="A2.p1.4.m4.2.2.3.2.3.cmml" xref="A2.p1.4.m4.2.2.3.2.3">𝑖</ci></apply><ci id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1">𝜽</ci></apply><apply id="A2.p1.4.m4.2.2.1.cmml" xref="A2.p1.4.m4.2.2.1"><apply id="A2.p1.4.m4.2.2.1.2.cmml" xref="A2.p1.4.m4.2.2.1.2"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.1.2.1.cmml" xref="A2.p1.4.m4.2.2.1.2">superscript</csymbol><apply id="A2.p1.4.m4.2.2.1.2.2.cmml" xref="A2.p1.4.m4.2.2.1.2"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.1.2.2.1.cmml" xref="A2.p1.4.m4.2.2.1.2">subscript</csymbol><csymbol cd="latexml" id="A2.p1.4.m4.2.2.1.2.2.2.cmml" xref="A2.p1.4.m4.2.2.1.2.2.2">product</csymbol><apply id="A2.p1.4.m4.2.2.1.2.2.3.cmml" xref="A2.p1.4.m4.2.2.1.2.2.3"><eq id="A2.p1.4.m4.2.2.1.2.2.3.1.cmml" xref="A2.p1.4.m4.2.2.1.2.2.3.1"></eq><ci id="A2.p1.4.m4.2.2.1.2.2.3.2.cmml" xref="A2.p1.4.m4.2.2.1.2.2.3.2">𝑑</ci><cn type="integer" id="A2.p1.4.m4.2.2.1.2.2.3.3.cmml" xref="A2.p1.4.m4.2.2.1.2.2.3.3">1</cn></apply></apply><apply id="A2.p1.4.m4.2.2.1.2.3.cmml" xref="A2.p1.4.m4.2.2.1.2.3"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.1.2.3.1.cmml" xref="A2.p1.4.m4.2.2.1.2.3">superscript</csymbol><ci id="A2.p1.4.m4.2.2.1.2.3.2.cmml" xref="A2.p1.4.m4.2.2.1.2.3.2">𝐷</ci><ci id="A2.p1.4.m4.2.2.1.2.3.3.cmml" xref="A2.p1.4.m4.2.2.1.2.3.3">𝑠</ci></apply></apply><apply id="A2.p1.4.m4.2.2.1.1.cmml" xref="A2.p1.4.m4.2.2.1.1"><times id="A2.p1.4.m4.2.2.1.1.2.cmml" xref="A2.p1.4.m4.2.2.1.1.2"></times><ci id="A2.p1.4.m4.2.2.1.1.3.cmml" xref="A2.p1.4.m4.2.2.1.1.3">𝒩</ci><apply id="A2.p1.4.m4.2.2.1.1.1.1.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1"><csymbol cd="latexml" id="A2.p1.4.m4.2.2.1.1.1.1.1.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.3">conditional</csymbol><apply id="A2.p1.4.m4.2.2.1.1.1.1.1.4.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.1.1.1.1.1.4.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.4">subscript</csymbol><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.4.2.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.4.2">𝜃</ci><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.4.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.4.3">𝑑</ci></apply><list id="A2.p1.4.m4.2.2.1.1.1.1.1.2.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2"><apply id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.2">𝜇</ci><apply id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3"><times id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.2.3.3">𝑑</ci></apply></apply><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.2">𝜎</ci><apply id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3"><times id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.2">𝑖</ci><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.2.3.3">𝑑</ci></apply></apply><ci id="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="A2.p1.4.m4.2.2.1.1.1.1.1.2.2.2.3">𝑠</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.2c">s_{i}(\bm{\theta})=\prod_{d=1}^{D^{s}}\mathcal{N}(\theta_{d}|\mu_{id}^{s},\sigma_{id}^{s})</annotation></semantics></math>, we can easily observe that the factorization extends to all three terms listed above. In turn, in order to implement the Virtual algorithm with factorized Gaussian distributions, we need to compute univariate Gaussian products and ratios that read respectively (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, Sec 8.1.8]</cite>):</p>
<table id="A4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex3.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{N}(x|\mu_{1},\sigma_{1}^{2})\cdot\mathcal{N}(x|\mu_{2},\sigma_{2}^{2})=\frac{1}{Z_{p}}\mathcal{N}(x|\mu_{p},\sigma_{p}^{2})" display="inline"><semantics id="A2.Ex3.m1.3a"><mrow id="A2.Ex3.m1.3.3" xref="A2.Ex3.m1.3.3.cmml"><mrow id="A2.Ex3.m1.2.2.2" xref="A2.Ex3.m1.2.2.2.cmml"><mrow id="A2.Ex3.m1.1.1.1.1" xref="A2.Ex3.m1.1.1.1.1.cmml"><mrow id="A2.Ex3.m1.1.1.1.1.1" xref="A2.Ex3.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex3.m1.1.1.1.1.1.3" xref="A2.Ex3.m1.1.1.1.1.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.1.1.1.1.1.2" xref="A2.Ex3.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="A2.Ex3.m1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex3.m1.1.1.1.1.1.1.1.2" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex3.m1.1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex3.m1.1.1.1.1.1.1.1.1.4" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.4.cmml">x</mi><mo fence="false" id="A2.Ex3.m1.1.1.1.1.1.1.1.1.3" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mn id="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.3" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mn id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">1</mn><mn id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msubsup></mrow></mrow><mo rspace="0.055em" stretchy="false" id="A2.Ex3.m1.1.1.1.1.1.1.1.3" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="A2.Ex3.m1.1.1.1.1.2" xref="A2.Ex3.m1.1.1.1.1.2.cmml">⋅</mo><mi class="ltx_font_mathcaligraphic" id="A2.Ex3.m1.1.1.1.1.3" xref="A2.Ex3.m1.1.1.1.1.3.cmml">𝒩</mi></mrow><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.2.2.2.3" xref="A2.Ex3.m1.2.2.2.3.cmml">​</mo><mrow id="A2.Ex3.m1.2.2.2.2.1" xref="A2.Ex3.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A2.Ex3.m1.2.2.2.2.1.2" xref="A2.Ex3.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="A2.Ex3.m1.2.2.2.2.1.1" xref="A2.Ex3.m1.2.2.2.2.1.1.cmml"><mi id="A2.Ex3.m1.2.2.2.2.1.1.4" xref="A2.Ex3.m1.2.2.2.2.1.1.4.cmml">x</mi><mo fence="false" id="A2.Ex3.m1.2.2.2.2.1.1.3" xref="A2.Ex3.m1.2.2.2.2.1.1.3.cmml">|</mo><mrow id="A2.Ex3.m1.2.2.2.2.1.1.2.2" xref="A2.Ex3.m1.2.2.2.2.1.1.2.3.cmml"><msub id="A2.Ex3.m1.2.2.2.2.1.1.1.1.1" xref="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.2" xref="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.2.cmml">μ</mi><mn id="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.3" xref="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.3.cmml">2</mn></msub><mo id="A2.Ex3.m1.2.2.2.2.1.1.2.2.3" xref="A2.Ex3.m1.2.2.2.2.1.1.2.3.cmml">,</mo><msubsup id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.cmml"><mi id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.2" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.2.cmml">σ</mi><mn id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.3" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">2</mn><mn id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.3" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.3.cmml">2</mn></msubsup></mrow></mrow><mo stretchy="false" id="A2.Ex3.m1.2.2.2.2.1.3" xref="A2.Ex3.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="A2.Ex3.m1.3.3.4" xref="A2.Ex3.m1.3.3.4.cmml">=</mo><mrow id="A2.Ex3.m1.3.3.3" xref="A2.Ex3.m1.3.3.3.cmml"><mstyle displaystyle="true" id="A2.Ex3.m1.3.3.3.3" xref="A2.Ex3.m1.3.3.3.3.cmml"><mfrac id="A2.Ex3.m1.3.3.3.3a" xref="A2.Ex3.m1.3.3.3.3.cmml"><mn id="A2.Ex3.m1.3.3.3.3.2" xref="A2.Ex3.m1.3.3.3.3.2.cmml">1</mn><msub id="A2.Ex3.m1.3.3.3.3.3" xref="A2.Ex3.m1.3.3.3.3.3.cmml"><mi id="A2.Ex3.m1.3.3.3.3.3.2" xref="A2.Ex3.m1.3.3.3.3.3.2.cmml">Z</mi><mi id="A2.Ex3.m1.3.3.3.3.3.3" xref="A2.Ex3.m1.3.3.3.3.3.3.cmml">p</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.3.3.3.2" xref="A2.Ex3.m1.3.3.3.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="A2.Ex3.m1.3.3.3.4" xref="A2.Ex3.m1.3.3.3.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.Ex3.m1.3.3.3.2a" xref="A2.Ex3.m1.3.3.3.2.cmml">​</mo><mrow id="A2.Ex3.m1.3.3.3.1.1" xref="A2.Ex3.m1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="A2.Ex3.m1.3.3.3.1.1.2" xref="A2.Ex3.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="A2.Ex3.m1.3.3.3.1.1.1" xref="A2.Ex3.m1.3.3.3.1.1.1.cmml"><mi id="A2.Ex3.m1.3.3.3.1.1.1.4" xref="A2.Ex3.m1.3.3.3.1.1.1.4.cmml">x</mi><mo fence="false" id="A2.Ex3.m1.3.3.3.1.1.1.3" xref="A2.Ex3.m1.3.3.3.1.1.1.3.cmml">|</mo><mrow id="A2.Ex3.m1.3.3.3.1.1.1.2.2" xref="A2.Ex3.m1.3.3.3.1.1.1.2.3.cmml"><msub id="A2.Ex3.m1.3.3.3.1.1.1.1.1.1" xref="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.cmml"><mi id="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.2" xref="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.2.cmml">μ</mi><mi id="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.3" xref="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.3.cmml">p</mi></msub><mo id="A2.Ex3.m1.3.3.3.1.1.1.2.2.3" xref="A2.Ex3.m1.3.3.3.1.1.1.2.3.cmml">,</mo><msubsup id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.cmml"><mi id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.2" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.2.cmml">σ</mi><mi id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.3" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.3.cmml">p</mi><mn id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.3" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.3.cmml">2</mn></msubsup></mrow></mrow><mo stretchy="false" id="A2.Ex3.m1.3.3.3.1.1.3" xref="A2.Ex3.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex3.m1.3b"><apply id="A2.Ex3.m1.3.3.cmml" xref="A2.Ex3.m1.3.3"><eq id="A2.Ex3.m1.3.3.4.cmml" xref="A2.Ex3.m1.3.3.4"></eq><apply id="A2.Ex3.m1.2.2.2.cmml" xref="A2.Ex3.m1.2.2.2"><times id="A2.Ex3.m1.2.2.2.3.cmml" xref="A2.Ex3.m1.2.2.2.3"></times><apply id="A2.Ex3.m1.1.1.1.1.cmml" xref="A2.Ex3.m1.1.1.1.1"><ci id="A2.Ex3.m1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.1.1.1.1.2">⋅</ci><apply id="A2.Ex3.m1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.1.1.1.1.1"><times id="A2.Ex3.m1.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.1.1.1.1.1.2"></times><ci id="A2.Ex3.m1.1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.1.1.1.1.1.3">𝒩</ci><apply id="A2.Ex3.m1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A2.Ex3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.3">conditional</csymbol><ci id="A2.Ex3.m1.1.1.1.1.1.1.1.1.4.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.4">𝑥</ci><list id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2"><apply id="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝜇</ci><cn type="integer" id="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.2">𝜎</ci><cn type="integer" id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.2.3">1</cn></apply><cn type="integer" id="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.Ex3.m1.1.1.1.1.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply><ci id="A2.Ex3.m1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.1.1.1.1.3">𝒩</ci></apply><apply id="A2.Ex3.m1.2.2.2.2.1.1.cmml" xref="A2.Ex3.m1.2.2.2.2.1"><csymbol cd="latexml" id="A2.Ex3.m1.2.2.2.2.1.1.3.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.3">conditional</csymbol><ci id="A2.Ex3.m1.2.2.2.2.1.1.4.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.4">𝑥</ci><list id="A2.Ex3.m1.2.2.2.2.1.1.2.3.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2"><apply id="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.2">𝜇</ci><cn type="integer" id="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.1.1.1.3">2</cn></apply><apply id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.1.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2">superscript</csymbol><apply id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2">subscript</csymbol><ci id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.2">𝜎</ci><cn type="integer" id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.2.3">2</cn></apply><cn type="integer" id="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.3.cmml" xref="A2.Ex3.m1.2.2.2.2.1.1.2.2.2.3">2</cn></apply></list></apply></apply><apply id="A2.Ex3.m1.3.3.3.cmml" xref="A2.Ex3.m1.3.3.3"><times id="A2.Ex3.m1.3.3.3.2.cmml" xref="A2.Ex3.m1.3.3.3.2"></times><apply id="A2.Ex3.m1.3.3.3.3.cmml" xref="A2.Ex3.m1.3.3.3.3"><divide id="A2.Ex3.m1.3.3.3.3.1.cmml" xref="A2.Ex3.m1.3.3.3.3"></divide><cn type="integer" id="A2.Ex3.m1.3.3.3.3.2.cmml" xref="A2.Ex3.m1.3.3.3.3.2">1</cn><apply id="A2.Ex3.m1.3.3.3.3.3.cmml" xref="A2.Ex3.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="A2.Ex3.m1.3.3.3.3.3.1.cmml" xref="A2.Ex3.m1.3.3.3.3.3">subscript</csymbol><ci id="A2.Ex3.m1.3.3.3.3.3.2.cmml" xref="A2.Ex3.m1.3.3.3.3.3.2">𝑍</ci><ci id="A2.Ex3.m1.3.3.3.3.3.3.cmml" xref="A2.Ex3.m1.3.3.3.3.3.3">𝑝</ci></apply></apply><ci id="A2.Ex3.m1.3.3.3.4.cmml" xref="A2.Ex3.m1.3.3.3.4">𝒩</ci><apply id="A2.Ex3.m1.3.3.3.1.1.1.cmml" xref="A2.Ex3.m1.3.3.3.1.1"><csymbol cd="latexml" id="A2.Ex3.m1.3.3.3.1.1.1.3.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.3">conditional</csymbol><ci id="A2.Ex3.m1.3.3.3.1.1.1.4.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.4">𝑥</ci><list id="A2.Ex3.m1.3.3.3.1.1.1.2.3.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2"><apply id="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.2">𝜇</ci><ci id="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.1.1.1.3">𝑝</ci></apply><apply id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.1.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2">superscript</csymbol><apply id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2">subscript</csymbol><ci id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.2">𝜎</ci><ci id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.2.3">𝑝</ci></apply><cn type="integer" id="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.3.cmml" xref="A2.Ex3.m1.3.3.3.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex3.m1.3c">\displaystyle\mathcal{N}(x|\mu_{1},\sigma_{1}^{2})\cdot\mathcal{N}(x|\mu_{2},\sigma_{2}^{2})=\frac{1}{Z_{p}}\mathcal{N}(x|\mu_{p},\sigma_{p}^{2})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex4.m1.3" class="ltx_Math" alttext="\displaystyle\frac{\mathcal{N}(x|\mu_{1},\sigma_{1}^{2})}{\mathcal{N}(x|\mu_{2},\sigma_{2}^{2})}=\frac{1}{Z_{r}}\mathcal{N}(x|\mu_{r},\sigma_{r}^{2})" display="inline"><semantics id="A2.Ex4.m1.3a"><mrow id="A2.Ex4.m1.3.3" xref="A2.Ex4.m1.3.3.cmml"><mstyle displaystyle="true" id="A2.Ex4.m1.2.2" xref="A2.Ex4.m1.2.2.cmml"><mfrac id="A2.Ex4.m1.2.2a" xref="A2.Ex4.m1.2.2.cmml"><mrow id="A2.Ex4.m1.1.1.1" xref="A2.Ex4.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex4.m1.1.1.1.3" xref="A2.Ex4.m1.1.1.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.Ex4.m1.1.1.1.2" xref="A2.Ex4.m1.1.1.1.2.cmml">​</mo><mrow id="A2.Ex4.m1.1.1.1.1.1" xref="A2.Ex4.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex4.m1.1.1.1.1.1.2" xref="A2.Ex4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex4.m1.1.1.1.1.1.1" xref="A2.Ex4.m1.1.1.1.1.1.1.cmml"><mi id="A2.Ex4.m1.1.1.1.1.1.1.4" xref="A2.Ex4.m1.1.1.1.1.1.1.4.cmml">x</mi><mo fence="false" id="A2.Ex4.m1.1.1.1.1.1.1.3" xref="A2.Ex4.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="A2.Ex4.m1.1.1.1.1.1.1.2.2" xref="A2.Ex4.m1.1.1.1.1.1.1.2.3.cmml"><msub id="A2.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.2" xref="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mn id="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.3" xref="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="A2.Ex4.m1.1.1.1.1.1.1.2.2.3" xref="A2.Ex4.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msubsup id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.2" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mn id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.3" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">1</mn><mn id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.3" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msubsup></mrow></mrow><mo stretchy="false" id="A2.Ex4.m1.1.1.1.1.1.3" xref="A2.Ex4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A2.Ex4.m1.2.2.2" xref="A2.Ex4.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A2.Ex4.m1.2.2.2.3" xref="A2.Ex4.m1.2.2.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.Ex4.m1.2.2.2.2" xref="A2.Ex4.m1.2.2.2.2.cmml">​</mo><mrow id="A2.Ex4.m1.2.2.2.1.1" xref="A2.Ex4.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A2.Ex4.m1.2.2.2.1.1.2" xref="A2.Ex4.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="A2.Ex4.m1.2.2.2.1.1.1" xref="A2.Ex4.m1.2.2.2.1.1.1.cmml"><mi id="A2.Ex4.m1.2.2.2.1.1.1.4" xref="A2.Ex4.m1.2.2.2.1.1.1.4.cmml">x</mi><mo fence="false" id="A2.Ex4.m1.2.2.2.1.1.1.3" xref="A2.Ex4.m1.2.2.2.1.1.1.3.cmml">|</mo><mrow id="A2.Ex4.m1.2.2.2.1.1.1.2.2" xref="A2.Ex4.m1.2.2.2.1.1.1.2.3.cmml"><msub id="A2.Ex4.m1.2.2.2.1.1.1.1.1.1" xref="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.cmml"><mi id="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.2" xref="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.2.cmml">μ</mi><mn id="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.3" xref="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="A2.Ex4.m1.2.2.2.1.1.1.2.2.3" xref="A2.Ex4.m1.2.2.2.1.1.1.2.3.cmml">,</mo><msubsup id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.cmml"><mi id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.2" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.2.cmml">σ</mi><mn id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.3" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.3.cmml">2</mn><mn id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.3" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.3.cmml">2</mn></msubsup></mrow></mrow><mo stretchy="false" id="A2.Ex4.m1.2.2.2.1.1.3" xref="A2.Ex4.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="A2.Ex4.m1.3.3.2" xref="A2.Ex4.m1.3.3.2.cmml">=</mo><mrow id="A2.Ex4.m1.3.3.1" xref="A2.Ex4.m1.3.3.1.cmml"><mstyle displaystyle="true" id="A2.Ex4.m1.3.3.1.3" xref="A2.Ex4.m1.3.3.1.3.cmml"><mfrac id="A2.Ex4.m1.3.3.1.3a" xref="A2.Ex4.m1.3.3.1.3.cmml"><mn id="A2.Ex4.m1.3.3.1.3.2" xref="A2.Ex4.m1.3.3.1.3.2.cmml">1</mn><msub id="A2.Ex4.m1.3.3.1.3.3" xref="A2.Ex4.m1.3.3.1.3.3.cmml"><mi id="A2.Ex4.m1.3.3.1.3.3.2" xref="A2.Ex4.m1.3.3.1.3.3.2.cmml">Z</mi><mi id="A2.Ex4.m1.3.3.1.3.3.3" xref="A2.Ex4.m1.3.3.1.3.3.3.cmml">r</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A2.Ex4.m1.3.3.1.2" xref="A2.Ex4.m1.3.3.1.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="A2.Ex4.m1.3.3.1.4" xref="A2.Ex4.m1.3.3.1.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A2.Ex4.m1.3.3.1.2a" xref="A2.Ex4.m1.3.3.1.2.cmml">​</mo><mrow id="A2.Ex4.m1.3.3.1.1.1" xref="A2.Ex4.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex4.m1.3.3.1.1.1.2" xref="A2.Ex4.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="A2.Ex4.m1.3.3.1.1.1.1" xref="A2.Ex4.m1.3.3.1.1.1.1.cmml"><mi id="A2.Ex4.m1.3.3.1.1.1.1.4" xref="A2.Ex4.m1.3.3.1.1.1.1.4.cmml">x</mi><mo fence="false" id="A2.Ex4.m1.3.3.1.1.1.1.3" xref="A2.Ex4.m1.3.3.1.1.1.1.3.cmml">|</mo><mrow id="A2.Ex4.m1.3.3.1.1.1.1.2.2" xref="A2.Ex4.m1.3.3.1.1.1.1.2.3.cmml"><msub id="A2.Ex4.m1.3.3.1.1.1.1.1.1.1" xref="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.2" xref="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.3" xref="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.3.cmml">r</mi></msub><mo id="A2.Ex4.m1.3.3.1.1.1.1.2.2.3" xref="A2.Ex4.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msubsup id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.2" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mi id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.3" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.3.cmml">r</mi><mn id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.3" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.3.cmml">2</mn></msubsup></mrow></mrow><mo stretchy="false" id="A2.Ex4.m1.3.3.1.1.1.3" xref="A2.Ex4.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex4.m1.3b"><apply id="A2.Ex4.m1.3.3.cmml" xref="A2.Ex4.m1.3.3"><eq id="A2.Ex4.m1.3.3.2.cmml" xref="A2.Ex4.m1.3.3.2"></eq><apply id="A2.Ex4.m1.2.2.cmml" xref="A2.Ex4.m1.2.2"><divide id="A2.Ex4.m1.2.2.3.cmml" xref="A2.Ex4.m1.2.2"></divide><apply id="A2.Ex4.m1.1.1.1.cmml" xref="A2.Ex4.m1.1.1.1"><times id="A2.Ex4.m1.1.1.1.2.cmml" xref="A2.Ex4.m1.1.1.1.2"></times><ci id="A2.Ex4.m1.1.1.1.3.cmml" xref="A2.Ex4.m1.1.1.1.3">𝒩</ci><apply id="A2.Ex4.m1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.1.1.1.1.1"><csymbol cd="latexml" id="A2.Ex4.m1.1.1.1.1.1.1.3.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.3">conditional</csymbol><ci id="A2.Ex4.m1.1.1.1.1.1.1.4.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.4">𝑥</ci><list id="A2.Ex4.m1.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2"><apply id="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.2">𝜇</ci><cn type="integer" id="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.2">𝜎</ci><cn type="integer" id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.2.3">1</cn></apply><cn type="integer" id="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A2.Ex4.m1.1.1.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply><apply id="A2.Ex4.m1.2.2.2.cmml" xref="A2.Ex4.m1.2.2.2"><times id="A2.Ex4.m1.2.2.2.2.cmml" xref="A2.Ex4.m1.2.2.2.2"></times><ci id="A2.Ex4.m1.2.2.2.3.cmml" xref="A2.Ex4.m1.2.2.2.3">𝒩</ci><apply id="A2.Ex4.m1.2.2.2.1.1.1.cmml" xref="A2.Ex4.m1.2.2.2.1.1"><csymbol cd="latexml" id="A2.Ex4.m1.2.2.2.1.1.1.3.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.3">conditional</csymbol><ci id="A2.Ex4.m1.2.2.2.1.1.1.4.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.4">𝑥</ci><list id="A2.Ex4.m1.2.2.2.1.1.1.2.3.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2"><apply id="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.2">𝜇</ci><cn type="integer" id="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.3.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.1.1.1.3">2</cn></apply><apply id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.1.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2">superscript</csymbol><apply id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.2">𝜎</ci><cn type="integer" id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.2.3">2</cn></apply><cn type="integer" id="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.3.cmml" xref="A2.Ex4.m1.2.2.2.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></apply><apply id="A2.Ex4.m1.3.3.1.cmml" xref="A2.Ex4.m1.3.3.1"><times id="A2.Ex4.m1.3.3.1.2.cmml" xref="A2.Ex4.m1.3.3.1.2"></times><apply id="A2.Ex4.m1.3.3.1.3.cmml" xref="A2.Ex4.m1.3.3.1.3"><divide id="A2.Ex4.m1.3.3.1.3.1.cmml" xref="A2.Ex4.m1.3.3.1.3"></divide><cn type="integer" id="A2.Ex4.m1.3.3.1.3.2.cmml" xref="A2.Ex4.m1.3.3.1.3.2">1</cn><apply id="A2.Ex4.m1.3.3.1.3.3.cmml" xref="A2.Ex4.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="A2.Ex4.m1.3.3.1.3.3.1.cmml" xref="A2.Ex4.m1.3.3.1.3.3">subscript</csymbol><ci id="A2.Ex4.m1.3.3.1.3.3.2.cmml" xref="A2.Ex4.m1.3.3.1.3.3.2">𝑍</ci><ci id="A2.Ex4.m1.3.3.1.3.3.3.cmml" xref="A2.Ex4.m1.3.3.1.3.3.3">𝑟</ci></apply></apply><ci id="A2.Ex4.m1.3.3.1.4.cmml" xref="A2.Ex4.m1.3.3.1.4">𝒩</ci><apply id="A2.Ex4.m1.3.3.1.1.1.1.cmml" xref="A2.Ex4.m1.3.3.1.1.1"><csymbol cd="latexml" id="A2.Ex4.m1.3.3.1.1.1.1.3.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.3">conditional</csymbol><ci id="A2.Ex4.m1.3.3.1.1.1.1.4.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.4">𝑥</ci><list id="A2.Ex4.m1.3.3.1.1.1.1.2.3.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2"><apply id="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.2">𝜇</ci><ci id="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.1.1.1.3">𝑟</ci></apply><apply id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2">superscript</csymbol><apply id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.2">𝜎</ci><ci id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.2.3">𝑟</ci></apply><cn type="integer" id="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="A2.Ex4.m1.3.3.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex4.m1.3c">\displaystyle\frac{\mathcal{N}(x|\mu_{1},\sigma_{1}^{2})}{\mathcal{N}(x|\mu_{2},\sigma_{2}^{2})}=\frac{1}{Z_{r}}\mathcal{N}(x|\mu_{r},\sigma_{r}^{2})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A2.p1.6" class="ltx_p">where <math id="A2.p1.5.m1.1" class="ltx_Math" alttext="S_{p}" display="inline"><semantics id="A2.p1.5.m1.1a"><msub id="A2.p1.5.m1.1.1" xref="A2.p1.5.m1.1.1.cmml"><mi id="A2.p1.5.m1.1.1.2" xref="A2.p1.5.m1.1.1.2.cmml">S</mi><mi id="A2.p1.5.m1.1.1.3" xref="A2.p1.5.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.5.m1.1b"><apply id="A2.p1.5.m1.1.1.cmml" xref="A2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="A2.p1.5.m1.1.1.1.cmml" xref="A2.p1.5.m1.1.1">subscript</csymbol><ci id="A2.p1.5.m1.1.1.2.cmml" xref="A2.p1.5.m1.1.1.2">𝑆</ci><ci id="A2.p1.5.m1.1.1.3.cmml" xref="A2.p1.5.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.5.m1.1c">S_{p}</annotation></semantics></math> and <math id="A2.p1.6.m2.1" class="ltx_Math" alttext="Z_{r}" display="inline"><semantics id="A2.p1.6.m2.1a"><msub id="A2.p1.6.m2.1.1" xref="A2.p1.6.m2.1.1.cmml"><mi id="A2.p1.6.m2.1.1.2" xref="A2.p1.6.m2.1.1.2.cmml">Z</mi><mi id="A2.p1.6.m2.1.1.3" xref="A2.p1.6.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A2.p1.6.m2.1b"><apply id="A2.p1.6.m2.1.1.cmml" xref="A2.p1.6.m2.1.1"><csymbol cd="ambiguous" id="A2.p1.6.m2.1.1.1.cmml" xref="A2.p1.6.m2.1.1">subscript</csymbol><ci id="A2.p1.6.m2.1.1.2.cmml" xref="A2.p1.6.m2.1.1.2">𝑍</ci><ci id="A2.p1.6.m2.1.1.3.cmml" xref="A2.p1.6.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.6.m2.1c">Z_{r}</annotation></semantics></math> are normalization constants and</p>
<table id="A4.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex5.m1.1" class="ltx_Math" alttext="\displaystyle\sigma_{p}^{2}" display="inline"><semantics id="A2.Ex5.m1.1a"><msubsup id="A2.Ex5.m1.1.1" xref="A2.Ex5.m1.1.1.cmml"><mi id="A2.Ex5.m1.1.1.2.2" xref="A2.Ex5.m1.1.1.2.2.cmml">σ</mi><mi id="A2.Ex5.m1.1.1.2.3" xref="A2.Ex5.m1.1.1.2.3.cmml">p</mi><mn id="A2.Ex5.m1.1.1.3" xref="A2.Ex5.m1.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="A2.Ex5.m1.1b"><apply id="A2.Ex5.m1.1.1.cmml" xref="A2.Ex5.m1.1.1"><csymbol cd="ambiguous" id="A2.Ex5.m1.1.1.1.cmml" xref="A2.Ex5.m1.1.1">superscript</csymbol><apply id="A2.Ex5.m1.1.1.2.cmml" xref="A2.Ex5.m1.1.1"><csymbol cd="ambiguous" id="A2.Ex5.m1.1.1.2.1.cmml" xref="A2.Ex5.m1.1.1">subscript</csymbol><ci id="A2.Ex5.m1.1.1.2.2.cmml" xref="A2.Ex5.m1.1.1.2.2">𝜎</ci><ci id="A2.Ex5.m1.1.1.2.3.cmml" xref="A2.Ex5.m1.1.1.2.3">𝑝</ci></apply><cn type="integer" id="A2.Ex5.m1.1.1.3.cmml" xref="A2.Ex5.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex5.m1.1c">\displaystyle\sigma_{p}^{2}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex5.m2.1" class="ltx_Math" alttext="\displaystyle=\left(\frac{1}{\sigma_{1}^{2}}+\frac{1}{\sigma_{2}^{2}}\right)^{-1}" display="inline"><semantics id="A2.Ex5.m2.1a"><mrow id="A2.Ex5.m2.1.1" xref="A2.Ex5.m2.1.1.cmml"><mi id="A2.Ex5.m2.1.1.3" xref="A2.Ex5.m2.1.1.3.cmml"></mi><mo id="A2.Ex5.m2.1.1.2" xref="A2.Ex5.m2.1.1.2.cmml">=</mo><msup id="A2.Ex5.m2.1.1.1" xref="A2.Ex5.m2.1.1.1.cmml"><mrow id="A2.Ex5.m2.1.1.1.1.1" xref="A2.Ex5.m2.1.1.1.1.1.1.cmml"><mo id="A2.Ex5.m2.1.1.1.1.1.2" xref="A2.Ex5.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex5.m2.1.1.1.1.1.1" xref="A2.Ex5.m2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.Ex5.m2.1.1.1.1.1.1.2" xref="A2.Ex5.m2.1.1.1.1.1.1.2.cmml"><mfrac id="A2.Ex5.m2.1.1.1.1.1.1.2a" xref="A2.Ex5.m2.1.1.1.1.1.1.2.cmml"><mn id="A2.Ex5.m2.1.1.1.1.1.1.2.2" xref="A2.Ex5.m2.1.1.1.1.1.1.2.2.cmml">1</mn><msubsup id="A2.Ex5.m2.1.1.1.1.1.1.2.3" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3.cmml"><mi id="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.2" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.2.cmml">σ</mi><mn id="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.3" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.3.cmml">1</mn><mn id="A2.Ex5.m2.1.1.1.1.1.1.2.3.3" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3.3.cmml">2</mn></msubsup></mfrac></mstyle><mo id="A2.Ex5.m2.1.1.1.1.1.1.1" xref="A2.Ex5.m2.1.1.1.1.1.1.1.cmml">+</mo><mstyle displaystyle="true" id="A2.Ex5.m2.1.1.1.1.1.1.3" xref="A2.Ex5.m2.1.1.1.1.1.1.3.cmml"><mfrac id="A2.Ex5.m2.1.1.1.1.1.1.3a" xref="A2.Ex5.m2.1.1.1.1.1.1.3.cmml"><mn id="A2.Ex5.m2.1.1.1.1.1.1.3.2" xref="A2.Ex5.m2.1.1.1.1.1.1.3.2.cmml">1</mn><msubsup id="A2.Ex5.m2.1.1.1.1.1.1.3.3" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3.cmml"><mi id="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.2" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.2.cmml">σ</mi><mn id="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.3" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.3.cmml">2</mn><mn id="A2.Ex5.m2.1.1.1.1.1.1.3.3.3" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mfrac></mstyle></mrow><mo id="A2.Ex5.m2.1.1.1.1.1.3" xref="A2.Ex5.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A2.Ex5.m2.1.1.1.3" xref="A2.Ex5.m2.1.1.1.3.cmml"><mo id="A2.Ex5.m2.1.1.1.3a" xref="A2.Ex5.m2.1.1.1.3.cmml">−</mo><mn id="A2.Ex5.m2.1.1.1.3.2" xref="A2.Ex5.m2.1.1.1.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex5.m2.1b"><apply id="A2.Ex5.m2.1.1.cmml" xref="A2.Ex5.m2.1.1"><eq id="A2.Ex5.m2.1.1.2.cmml" xref="A2.Ex5.m2.1.1.2"></eq><csymbol cd="latexml" id="A2.Ex5.m2.1.1.3.cmml" xref="A2.Ex5.m2.1.1.3">absent</csymbol><apply id="A2.Ex5.m2.1.1.1.cmml" xref="A2.Ex5.m2.1.1.1"><csymbol cd="ambiguous" id="A2.Ex5.m2.1.1.1.2.cmml" xref="A2.Ex5.m2.1.1.1">superscript</csymbol><apply id="A2.Ex5.m2.1.1.1.1.1.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1"><plus id="A2.Ex5.m2.1.1.1.1.1.1.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.1"></plus><apply id="A2.Ex5.m2.1.1.1.1.1.1.2.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2"><divide id="A2.Ex5.m2.1.1.1.1.1.1.2.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2"></divide><cn type="integer" id="A2.Ex5.m2.1.1.1.1.1.1.2.2.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2.2">1</cn><apply id="A2.Ex5.m2.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex5.m2.1.1.1.1.1.1.2.3.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.2.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.2">𝜎</ci><cn type="integer" id="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.3.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3.2.3">1</cn></apply><cn type="integer" id="A2.Ex5.m2.1.1.1.1.1.1.2.3.3.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A2.Ex5.m2.1.1.1.1.1.1.3.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3"><divide id="A2.Ex5.m2.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3"></divide><cn type="integer" id="A2.Ex5.m2.1.1.1.1.1.1.3.2.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3.2">1</cn><apply id="A2.Ex5.m2.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex5.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.1.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.2.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.2">𝜎</ci><cn type="integer" id="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.3.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3.2.3">2</cn></apply><cn type="integer" id="A2.Ex5.m2.1.1.1.1.1.1.3.3.3.cmml" xref="A2.Ex5.m2.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="A2.Ex5.m2.1.1.1.3.cmml" xref="A2.Ex5.m2.1.1.1.3"><minus id="A2.Ex5.m2.1.1.1.3.1.cmml" xref="A2.Ex5.m2.1.1.1.3"></minus><cn type="integer" id="A2.Ex5.m2.1.1.1.3.2.cmml" xref="A2.Ex5.m2.1.1.1.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex5.m2.1c">\displaystyle=\left(\frac{1}{\sigma_{1}^{2}}+\frac{1}{\sigma_{2}^{2}}\right)^{-1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex6.m1.1" class="ltx_Math" alttext="\displaystyle\mu_{p}" display="inline"><semantics id="A2.Ex6.m1.1a"><msub id="A2.Ex6.m1.1.1" xref="A2.Ex6.m1.1.1.cmml"><mi id="A2.Ex6.m1.1.1.2" xref="A2.Ex6.m1.1.1.2.cmml">μ</mi><mi id="A2.Ex6.m1.1.1.3" xref="A2.Ex6.m1.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="A2.Ex6.m1.1b"><apply id="A2.Ex6.m1.1.1.cmml" xref="A2.Ex6.m1.1.1"><csymbol cd="ambiguous" id="A2.Ex6.m1.1.1.1.cmml" xref="A2.Ex6.m1.1.1">subscript</csymbol><ci id="A2.Ex6.m1.1.1.2.cmml" xref="A2.Ex6.m1.1.1.2">𝜇</ci><ci id="A2.Ex6.m1.1.1.3.cmml" xref="A2.Ex6.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex6.m1.1c">\displaystyle\mu_{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex6.m2.1" class="ltx_Math" alttext="\displaystyle=\sigma_{p}^{2}\cdot\left(\frac{\mu_{1}}{\sigma_{1}^{2}}+\frac{\mu_{2}}{\sigma_{2}^{2}}\right)" display="inline"><semantics id="A2.Ex6.m2.1a"><mrow id="A2.Ex6.m2.1.1" xref="A2.Ex6.m2.1.1.cmml"><mi id="A2.Ex6.m2.1.1.3" xref="A2.Ex6.m2.1.1.3.cmml"></mi><mo id="A2.Ex6.m2.1.1.2" xref="A2.Ex6.m2.1.1.2.cmml">=</mo><mrow id="A2.Ex6.m2.1.1.1" xref="A2.Ex6.m2.1.1.1.cmml"><msubsup id="A2.Ex6.m2.1.1.1.3" xref="A2.Ex6.m2.1.1.1.3.cmml"><mi id="A2.Ex6.m2.1.1.1.3.2.2" xref="A2.Ex6.m2.1.1.1.3.2.2.cmml">σ</mi><mi id="A2.Ex6.m2.1.1.1.3.2.3" xref="A2.Ex6.m2.1.1.1.3.2.3.cmml">p</mi><mn id="A2.Ex6.m2.1.1.1.3.3" xref="A2.Ex6.m2.1.1.1.3.3.cmml">2</mn></msubsup><mo lspace="0.222em" rspace="0.222em" id="A2.Ex6.m2.1.1.1.2" xref="A2.Ex6.m2.1.1.1.2.cmml">⋅</mo><mrow id="A2.Ex6.m2.1.1.1.1.1" xref="A2.Ex6.m2.1.1.1.1.1.1.cmml"><mo id="A2.Ex6.m2.1.1.1.1.1.2" xref="A2.Ex6.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex6.m2.1.1.1.1.1.1" xref="A2.Ex6.m2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.Ex6.m2.1.1.1.1.1.1.2" xref="A2.Ex6.m2.1.1.1.1.1.1.2.cmml"><mfrac id="A2.Ex6.m2.1.1.1.1.1.1.2a" xref="A2.Ex6.m2.1.1.1.1.1.1.2.cmml"><msub id="A2.Ex6.m2.1.1.1.1.1.1.2.2" xref="A2.Ex6.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A2.Ex6.m2.1.1.1.1.1.1.2.2.2" xref="A2.Ex6.m2.1.1.1.1.1.1.2.2.2.cmml">μ</mi><mn id="A2.Ex6.m2.1.1.1.1.1.1.2.2.3" xref="A2.Ex6.m2.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><msubsup id="A2.Ex6.m2.1.1.1.1.1.1.2.3" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3.cmml"><mi id="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.2" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.2.cmml">σ</mi><mn id="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.3" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.3.cmml">1</mn><mn id="A2.Ex6.m2.1.1.1.1.1.1.2.3.3" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3.3.cmml">2</mn></msubsup></mfrac></mstyle><mo id="A2.Ex6.m2.1.1.1.1.1.1.1" xref="A2.Ex6.m2.1.1.1.1.1.1.1.cmml">+</mo><mstyle displaystyle="true" id="A2.Ex6.m2.1.1.1.1.1.1.3" xref="A2.Ex6.m2.1.1.1.1.1.1.3.cmml"><mfrac id="A2.Ex6.m2.1.1.1.1.1.1.3a" xref="A2.Ex6.m2.1.1.1.1.1.1.3.cmml"><msub id="A2.Ex6.m2.1.1.1.1.1.1.3.2" xref="A2.Ex6.m2.1.1.1.1.1.1.3.2.cmml"><mi id="A2.Ex6.m2.1.1.1.1.1.1.3.2.2" xref="A2.Ex6.m2.1.1.1.1.1.1.3.2.2.cmml">μ</mi><mn id="A2.Ex6.m2.1.1.1.1.1.1.3.2.3" xref="A2.Ex6.m2.1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><msubsup id="A2.Ex6.m2.1.1.1.1.1.1.3.3" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3.cmml"><mi id="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.2" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.2.cmml">σ</mi><mn id="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.3" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.3.cmml">2</mn><mn id="A2.Ex6.m2.1.1.1.1.1.1.3.3.3" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mfrac></mstyle></mrow><mo id="A2.Ex6.m2.1.1.1.1.1.3" xref="A2.Ex6.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex6.m2.1b"><apply id="A2.Ex6.m2.1.1.cmml" xref="A2.Ex6.m2.1.1"><eq id="A2.Ex6.m2.1.1.2.cmml" xref="A2.Ex6.m2.1.1.2"></eq><csymbol cd="latexml" id="A2.Ex6.m2.1.1.3.cmml" xref="A2.Ex6.m2.1.1.3">absent</csymbol><apply id="A2.Ex6.m2.1.1.1.cmml" xref="A2.Ex6.m2.1.1.1"><ci id="A2.Ex6.m2.1.1.1.2.cmml" xref="A2.Ex6.m2.1.1.1.2">⋅</ci><apply id="A2.Ex6.m2.1.1.1.3.cmml" xref="A2.Ex6.m2.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex6.m2.1.1.1.3.1.cmml" xref="A2.Ex6.m2.1.1.1.3">superscript</csymbol><apply id="A2.Ex6.m2.1.1.1.3.2.cmml" xref="A2.Ex6.m2.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex6.m2.1.1.1.3.2.1.cmml" xref="A2.Ex6.m2.1.1.1.3">subscript</csymbol><ci id="A2.Ex6.m2.1.1.1.3.2.2.cmml" xref="A2.Ex6.m2.1.1.1.3.2.2">𝜎</ci><ci id="A2.Ex6.m2.1.1.1.3.2.3.cmml" xref="A2.Ex6.m2.1.1.1.3.2.3">𝑝</ci></apply><cn type="integer" id="A2.Ex6.m2.1.1.1.3.3.cmml" xref="A2.Ex6.m2.1.1.1.3.3">2</cn></apply><apply id="A2.Ex6.m2.1.1.1.1.1.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1"><plus id="A2.Ex6.m2.1.1.1.1.1.1.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.1"></plus><apply id="A2.Ex6.m2.1.1.1.1.1.1.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2"><divide id="A2.Ex6.m2.1.1.1.1.1.1.2.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2"></divide><apply id="A2.Ex6.m2.1.1.1.1.1.1.2.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.Ex6.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A2.Ex6.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.2.2">𝜇</ci><cn type="integer" id="A2.Ex6.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.2.3">1</cn></apply><apply id="A2.Ex6.m2.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex6.m2.1.1.1.1.1.1.2.3.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.2">𝜎</ci><cn type="integer" id="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3.2.3">1</cn></apply><cn type="integer" id="A2.Ex6.m2.1.1.1.1.1.1.2.3.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A2.Ex6.m2.1.1.1.1.1.1.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3"><divide id="A2.Ex6.m2.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3"></divide><apply id="A2.Ex6.m2.1.1.1.1.1.1.3.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A2.Ex6.m2.1.1.1.1.1.1.3.2.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A2.Ex6.m2.1.1.1.1.1.1.3.2.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.2.2">𝜇</ci><cn type="integer" id="A2.Ex6.m2.1.1.1.1.1.1.3.2.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.2.3">2</cn></apply><apply id="A2.Ex6.m2.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex6.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.1.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.2.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.2">𝜎</ci><cn type="integer" id="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3.2.3">2</cn></apply><cn type="integer" id="A2.Ex6.m2.1.1.1.1.1.1.3.3.3.cmml" xref="A2.Ex6.m2.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex6.m2.1c">\displaystyle=\sigma_{p}^{2}\cdot\left(\frac{\mu_{1}}{\sigma_{1}^{2}}+\frac{\mu_{2}}{\sigma_{2}^{2}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex7.m1.1" class="ltx_Math" alttext="\displaystyle\sigma_{r}^{2}" display="inline"><semantics id="A2.Ex7.m1.1a"><msubsup id="A2.Ex7.m1.1.1" xref="A2.Ex7.m1.1.1.cmml"><mi id="A2.Ex7.m1.1.1.2.2" xref="A2.Ex7.m1.1.1.2.2.cmml">σ</mi><mi id="A2.Ex7.m1.1.1.2.3" xref="A2.Ex7.m1.1.1.2.3.cmml">r</mi><mn id="A2.Ex7.m1.1.1.3" xref="A2.Ex7.m1.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="A2.Ex7.m1.1b"><apply id="A2.Ex7.m1.1.1.cmml" xref="A2.Ex7.m1.1.1"><csymbol cd="ambiguous" id="A2.Ex7.m1.1.1.1.cmml" xref="A2.Ex7.m1.1.1">superscript</csymbol><apply id="A2.Ex7.m1.1.1.2.cmml" xref="A2.Ex7.m1.1.1"><csymbol cd="ambiguous" id="A2.Ex7.m1.1.1.2.1.cmml" xref="A2.Ex7.m1.1.1">subscript</csymbol><ci id="A2.Ex7.m1.1.1.2.2.cmml" xref="A2.Ex7.m1.1.1.2.2">𝜎</ci><ci id="A2.Ex7.m1.1.1.2.3.cmml" xref="A2.Ex7.m1.1.1.2.3">𝑟</ci></apply><cn type="integer" id="A2.Ex7.m1.1.1.3.cmml" xref="A2.Ex7.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex7.m1.1c">\displaystyle\sigma_{r}^{2}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex7.m2.1" class="ltx_Math" alttext="\displaystyle=\left(\frac{1}{\sigma_{1}^{2}}-\frac{1}{\sigma_{2}^{2}}\right)^{-1}" display="inline"><semantics id="A2.Ex7.m2.1a"><mrow id="A2.Ex7.m2.1.1" xref="A2.Ex7.m2.1.1.cmml"><mi id="A2.Ex7.m2.1.1.3" xref="A2.Ex7.m2.1.1.3.cmml"></mi><mo id="A2.Ex7.m2.1.1.2" xref="A2.Ex7.m2.1.1.2.cmml">=</mo><msup id="A2.Ex7.m2.1.1.1" xref="A2.Ex7.m2.1.1.1.cmml"><mrow id="A2.Ex7.m2.1.1.1.1.1" xref="A2.Ex7.m2.1.1.1.1.1.1.cmml"><mo id="A2.Ex7.m2.1.1.1.1.1.2" xref="A2.Ex7.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex7.m2.1.1.1.1.1.1" xref="A2.Ex7.m2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.Ex7.m2.1.1.1.1.1.1.2" xref="A2.Ex7.m2.1.1.1.1.1.1.2.cmml"><mfrac id="A2.Ex7.m2.1.1.1.1.1.1.2a" xref="A2.Ex7.m2.1.1.1.1.1.1.2.cmml"><mn id="A2.Ex7.m2.1.1.1.1.1.1.2.2" xref="A2.Ex7.m2.1.1.1.1.1.1.2.2.cmml">1</mn><msubsup id="A2.Ex7.m2.1.1.1.1.1.1.2.3" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3.cmml"><mi id="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.2" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.2.cmml">σ</mi><mn id="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.3" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.3.cmml">1</mn><mn id="A2.Ex7.m2.1.1.1.1.1.1.2.3.3" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3.3.cmml">2</mn></msubsup></mfrac></mstyle><mo id="A2.Ex7.m2.1.1.1.1.1.1.1" xref="A2.Ex7.m2.1.1.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="A2.Ex7.m2.1.1.1.1.1.1.3" xref="A2.Ex7.m2.1.1.1.1.1.1.3.cmml"><mfrac id="A2.Ex7.m2.1.1.1.1.1.1.3a" xref="A2.Ex7.m2.1.1.1.1.1.1.3.cmml"><mn id="A2.Ex7.m2.1.1.1.1.1.1.3.2" xref="A2.Ex7.m2.1.1.1.1.1.1.3.2.cmml">1</mn><msubsup id="A2.Ex7.m2.1.1.1.1.1.1.3.3" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3.cmml"><mi id="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.2" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.2.cmml">σ</mi><mn id="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.3" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.3.cmml">2</mn><mn id="A2.Ex7.m2.1.1.1.1.1.1.3.3.3" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mfrac></mstyle></mrow><mo id="A2.Ex7.m2.1.1.1.1.1.3" xref="A2.Ex7.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A2.Ex7.m2.1.1.1.3" xref="A2.Ex7.m2.1.1.1.3.cmml"><mo id="A2.Ex7.m2.1.1.1.3a" xref="A2.Ex7.m2.1.1.1.3.cmml">−</mo><mn id="A2.Ex7.m2.1.1.1.3.2" xref="A2.Ex7.m2.1.1.1.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex7.m2.1b"><apply id="A2.Ex7.m2.1.1.cmml" xref="A2.Ex7.m2.1.1"><eq id="A2.Ex7.m2.1.1.2.cmml" xref="A2.Ex7.m2.1.1.2"></eq><csymbol cd="latexml" id="A2.Ex7.m2.1.1.3.cmml" xref="A2.Ex7.m2.1.1.3">absent</csymbol><apply id="A2.Ex7.m2.1.1.1.cmml" xref="A2.Ex7.m2.1.1.1"><csymbol cd="ambiguous" id="A2.Ex7.m2.1.1.1.2.cmml" xref="A2.Ex7.m2.1.1.1">superscript</csymbol><apply id="A2.Ex7.m2.1.1.1.1.1.1.cmml" xref="A2.Ex7.m2.1.1.1.1.1"><minus id="A2.Ex7.m2.1.1.1.1.1.1.1.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.1"></minus><apply id="A2.Ex7.m2.1.1.1.1.1.1.2.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2"><divide id="A2.Ex7.m2.1.1.1.1.1.1.2.1.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2"></divide><cn type="integer" id="A2.Ex7.m2.1.1.1.1.1.1.2.2.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2.2">1</cn><apply id="A2.Ex7.m2.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex7.m2.1.1.1.1.1.1.2.3.1.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.1.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.2.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.2">𝜎</ci><cn type="integer" id="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.3.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3.2.3">1</cn></apply><cn type="integer" id="A2.Ex7.m2.1.1.1.1.1.1.2.3.3.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A2.Ex7.m2.1.1.1.1.1.1.3.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3"><divide id="A2.Ex7.m2.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3"></divide><cn type="integer" id="A2.Ex7.m2.1.1.1.1.1.1.3.2.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3.2">1</cn><apply id="A2.Ex7.m2.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex7.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.1.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.2.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.2">𝜎</ci><cn type="integer" id="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.3.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3.2.3">2</cn></apply><cn type="integer" id="A2.Ex7.m2.1.1.1.1.1.1.3.3.3.cmml" xref="A2.Ex7.m2.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="A2.Ex7.m2.1.1.1.3.cmml" xref="A2.Ex7.m2.1.1.1.3"><minus id="A2.Ex7.m2.1.1.1.3.1.cmml" xref="A2.Ex7.m2.1.1.1.3"></minus><cn type="integer" id="A2.Ex7.m2.1.1.1.3.2.cmml" xref="A2.Ex7.m2.1.1.1.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex7.m2.1c">\displaystyle=\left(\frac{1}{\sigma_{1}^{2}}-\frac{1}{\sigma_{2}^{2}}\right)^{-1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex8.m1.1" class="ltx_Math" alttext="\displaystyle\mu_{r}" display="inline"><semantics id="A2.Ex8.m1.1a"><msub id="A2.Ex8.m1.1.1" xref="A2.Ex8.m1.1.1.cmml"><mi id="A2.Ex8.m1.1.1.2" xref="A2.Ex8.m1.1.1.2.cmml">μ</mi><mi id="A2.Ex8.m1.1.1.3" xref="A2.Ex8.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A2.Ex8.m1.1b"><apply id="A2.Ex8.m1.1.1.cmml" xref="A2.Ex8.m1.1.1"><csymbol cd="ambiguous" id="A2.Ex8.m1.1.1.1.cmml" xref="A2.Ex8.m1.1.1">subscript</csymbol><ci id="A2.Ex8.m1.1.1.2.cmml" xref="A2.Ex8.m1.1.1.2">𝜇</ci><ci id="A2.Ex8.m1.1.1.3.cmml" xref="A2.Ex8.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex8.m1.1c">\displaystyle\mu_{r}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A2.Ex8.m2.1" class="ltx_Math" alttext="\displaystyle=\sigma_{r}^{2}\cdot\left(\frac{\mu_{1}}{\sigma_{1}^{2}}-\frac{\mu_{2}}{\sigma_{2}^{2}}\right)" display="inline"><semantics id="A2.Ex8.m2.1a"><mrow id="A2.Ex8.m2.1.1" xref="A2.Ex8.m2.1.1.cmml"><mi id="A2.Ex8.m2.1.1.3" xref="A2.Ex8.m2.1.1.3.cmml"></mi><mo id="A2.Ex8.m2.1.1.2" xref="A2.Ex8.m2.1.1.2.cmml">=</mo><mrow id="A2.Ex8.m2.1.1.1" xref="A2.Ex8.m2.1.1.1.cmml"><msubsup id="A2.Ex8.m2.1.1.1.3" xref="A2.Ex8.m2.1.1.1.3.cmml"><mi id="A2.Ex8.m2.1.1.1.3.2.2" xref="A2.Ex8.m2.1.1.1.3.2.2.cmml">σ</mi><mi id="A2.Ex8.m2.1.1.1.3.2.3" xref="A2.Ex8.m2.1.1.1.3.2.3.cmml">r</mi><mn id="A2.Ex8.m2.1.1.1.3.3" xref="A2.Ex8.m2.1.1.1.3.3.cmml">2</mn></msubsup><mo lspace="0.222em" rspace="0.222em" id="A2.Ex8.m2.1.1.1.2" xref="A2.Ex8.m2.1.1.1.2.cmml">⋅</mo><mrow id="A2.Ex8.m2.1.1.1.1.1" xref="A2.Ex8.m2.1.1.1.1.1.1.cmml"><mo id="A2.Ex8.m2.1.1.1.1.1.2" xref="A2.Ex8.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex8.m2.1.1.1.1.1.1" xref="A2.Ex8.m2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A2.Ex8.m2.1.1.1.1.1.1.2" xref="A2.Ex8.m2.1.1.1.1.1.1.2.cmml"><mfrac id="A2.Ex8.m2.1.1.1.1.1.1.2a" xref="A2.Ex8.m2.1.1.1.1.1.1.2.cmml"><msub id="A2.Ex8.m2.1.1.1.1.1.1.2.2" xref="A2.Ex8.m2.1.1.1.1.1.1.2.2.cmml"><mi id="A2.Ex8.m2.1.1.1.1.1.1.2.2.2" xref="A2.Ex8.m2.1.1.1.1.1.1.2.2.2.cmml">μ</mi><mn id="A2.Ex8.m2.1.1.1.1.1.1.2.2.3" xref="A2.Ex8.m2.1.1.1.1.1.1.2.2.3.cmml">1</mn></msub><msubsup id="A2.Ex8.m2.1.1.1.1.1.1.2.3" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3.cmml"><mi id="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.2" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.2.cmml">σ</mi><mn id="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.3" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.3.cmml">1</mn><mn id="A2.Ex8.m2.1.1.1.1.1.1.2.3.3" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3.3.cmml">2</mn></msubsup></mfrac></mstyle><mo id="A2.Ex8.m2.1.1.1.1.1.1.1" xref="A2.Ex8.m2.1.1.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="A2.Ex8.m2.1.1.1.1.1.1.3" xref="A2.Ex8.m2.1.1.1.1.1.1.3.cmml"><mfrac id="A2.Ex8.m2.1.1.1.1.1.1.3a" xref="A2.Ex8.m2.1.1.1.1.1.1.3.cmml"><msub id="A2.Ex8.m2.1.1.1.1.1.1.3.2" xref="A2.Ex8.m2.1.1.1.1.1.1.3.2.cmml"><mi id="A2.Ex8.m2.1.1.1.1.1.1.3.2.2" xref="A2.Ex8.m2.1.1.1.1.1.1.3.2.2.cmml">μ</mi><mn id="A2.Ex8.m2.1.1.1.1.1.1.3.2.3" xref="A2.Ex8.m2.1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><msubsup id="A2.Ex8.m2.1.1.1.1.1.1.3.3" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3.cmml"><mi id="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.2" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.2.cmml">σ</mi><mn id="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.3" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.3.cmml">2</mn><mn id="A2.Ex8.m2.1.1.1.1.1.1.3.3.3" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3.3.cmml">2</mn></msubsup></mfrac></mstyle></mrow><mo id="A2.Ex8.m2.1.1.1.1.1.3" xref="A2.Ex8.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex8.m2.1b"><apply id="A2.Ex8.m2.1.1.cmml" xref="A2.Ex8.m2.1.1"><eq id="A2.Ex8.m2.1.1.2.cmml" xref="A2.Ex8.m2.1.1.2"></eq><csymbol cd="latexml" id="A2.Ex8.m2.1.1.3.cmml" xref="A2.Ex8.m2.1.1.3">absent</csymbol><apply id="A2.Ex8.m2.1.1.1.cmml" xref="A2.Ex8.m2.1.1.1"><ci id="A2.Ex8.m2.1.1.1.2.cmml" xref="A2.Ex8.m2.1.1.1.2">⋅</ci><apply id="A2.Ex8.m2.1.1.1.3.cmml" xref="A2.Ex8.m2.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex8.m2.1.1.1.3.1.cmml" xref="A2.Ex8.m2.1.1.1.3">superscript</csymbol><apply id="A2.Ex8.m2.1.1.1.3.2.cmml" xref="A2.Ex8.m2.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex8.m2.1.1.1.3.2.1.cmml" xref="A2.Ex8.m2.1.1.1.3">subscript</csymbol><ci id="A2.Ex8.m2.1.1.1.3.2.2.cmml" xref="A2.Ex8.m2.1.1.1.3.2.2">𝜎</ci><ci id="A2.Ex8.m2.1.1.1.3.2.3.cmml" xref="A2.Ex8.m2.1.1.1.3.2.3">𝑟</ci></apply><cn type="integer" id="A2.Ex8.m2.1.1.1.3.3.cmml" xref="A2.Ex8.m2.1.1.1.3.3">2</cn></apply><apply id="A2.Ex8.m2.1.1.1.1.1.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1"><minus id="A2.Ex8.m2.1.1.1.1.1.1.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.1"></minus><apply id="A2.Ex8.m2.1.1.1.1.1.1.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2"><divide id="A2.Ex8.m2.1.1.1.1.1.1.2.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2"></divide><apply id="A2.Ex8.m2.1.1.1.1.1.1.2.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A2.Ex8.m2.1.1.1.1.1.1.2.2.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A2.Ex8.m2.1.1.1.1.1.1.2.2.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.2.2">𝜇</ci><cn type="integer" id="A2.Ex8.m2.1.1.1.1.1.1.2.2.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.2.3">1</cn></apply><apply id="A2.Ex8.m2.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex8.m2.1.1.1.1.1.1.2.3.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.2">𝜎</ci><cn type="integer" id="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3.2.3">1</cn></apply><cn type="integer" id="A2.Ex8.m2.1.1.1.1.1.1.2.3.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A2.Ex8.m2.1.1.1.1.1.1.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3"><divide id="A2.Ex8.m2.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3"></divide><apply id="A2.Ex8.m2.1.1.1.1.1.1.3.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A2.Ex8.m2.1.1.1.1.1.1.3.2.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A2.Ex8.m2.1.1.1.1.1.1.3.2.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.2.2">𝜇</ci><cn type="integer" id="A2.Ex8.m2.1.1.1.1.1.1.3.2.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.2.3">2</cn></apply><apply id="A2.Ex8.m2.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex8.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.1.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.2.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.2">𝜎</ci><cn type="integer" id="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3.2.3">2</cn></apply><cn type="integer" id="A2.Ex8.m2.1.1.1.1.1.1.3.3.3.cmml" xref="A2.Ex8.m2.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex8.m2.1c">\displaystyle=\sigma_{r}^{2}\cdot\left(\frac{\mu_{1}}{\sigma_{1}^{2}}-\frac{\mu_{2}}{\sigma_{2}^{2}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A2.p1.7" class="ltx_p">with <math id="A2.p1.7.m1.1" class="ltx_Math" alttext="\sigma_{1}&lt;\sigma_{2}" display="inline"><semantics id="A2.p1.7.m1.1a"><mrow id="A2.p1.7.m1.1.1" xref="A2.p1.7.m1.1.1.cmml"><msub id="A2.p1.7.m1.1.1.2" xref="A2.p1.7.m1.1.1.2.cmml"><mi id="A2.p1.7.m1.1.1.2.2" xref="A2.p1.7.m1.1.1.2.2.cmml">σ</mi><mn id="A2.p1.7.m1.1.1.2.3" xref="A2.p1.7.m1.1.1.2.3.cmml">1</mn></msub><mo id="A2.p1.7.m1.1.1.1" xref="A2.p1.7.m1.1.1.1.cmml">&lt;</mo><msub id="A2.p1.7.m1.1.1.3" xref="A2.p1.7.m1.1.1.3.cmml"><mi id="A2.p1.7.m1.1.1.3.2" xref="A2.p1.7.m1.1.1.3.2.cmml">σ</mi><mn id="A2.p1.7.m1.1.1.3.3" xref="A2.p1.7.m1.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.7.m1.1b"><apply id="A2.p1.7.m1.1.1.cmml" xref="A2.p1.7.m1.1.1"><lt id="A2.p1.7.m1.1.1.1.cmml" xref="A2.p1.7.m1.1.1.1"></lt><apply id="A2.p1.7.m1.1.1.2.cmml" xref="A2.p1.7.m1.1.1.2"><csymbol cd="ambiguous" id="A2.p1.7.m1.1.1.2.1.cmml" xref="A2.p1.7.m1.1.1.2">subscript</csymbol><ci id="A2.p1.7.m1.1.1.2.2.cmml" xref="A2.p1.7.m1.1.1.2.2">𝜎</ci><cn type="integer" id="A2.p1.7.m1.1.1.2.3.cmml" xref="A2.p1.7.m1.1.1.2.3">1</cn></apply><apply id="A2.p1.7.m1.1.1.3.cmml" xref="A2.p1.7.m1.1.1.3"><csymbol cd="ambiguous" id="A2.p1.7.m1.1.1.3.1.cmml" xref="A2.p1.7.m1.1.1.3">subscript</csymbol><ci id="A2.p1.7.m1.1.1.3.2.cmml" xref="A2.p1.7.m1.1.1.3.2">𝜎</ci><cn type="integer" id="A2.p1.7.m1.1.1.3.3.cmml" xref="A2.p1.7.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.7.m1.1c">\sigma_{1}&lt;\sigma_{2}</annotation></semantics></math> in the latter case (ratio).
It is easy to observe that using the natural parameterization of the Gaussian distribution with sufficient statistics given by</p>
<table id="A4.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A2.Ex9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex9.m1.1" class="ltx_Math" alttext="\displaystyle\chi=\frac{\mu}{\sigma^{2}}" display="inline"><semantics id="A2.Ex9.m1.1a"><mrow id="A2.Ex9.m1.1.1" xref="A2.Ex9.m1.1.1.cmml"><mi id="A2.Ex9.m1.1.1.2" xref="A2.Ex9.m1.1.1.2.cmml">χ</mi><mo id="A2.Ex9.m1.1.1.1" xref="A2.Ex9.m1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A2.Ex9.m1.1.1.3" xref="A2.Ex9.m1.1.1.3.cmml"><mfrac id="A2.Ex9.m1.1.1.3a" xref="A2.Ex9.m1.1.1.3.cmml"><mi id="A2.Ex9.m1.1.1.3.2" xref="A2.Ex9.m1.1.1.3.2.cmml">μ</mi><msup id="A2.Ex9.m1.1.1.3.3" xref="A2.Ex9.m1.1.1.3.3.cmml"><mi id="A2.Ex9.m1.1.1.3.3.2" xref="A2.Ex9.m1.1.1.3.3.2.cmml">σ</mi><mn id="A2.Ex9.m1.1.1.3.3.3" xref="A2.Ex9.m1.1.1.3.3.3.cmml">2</mn></msup></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex9.m1.1b"><apply id="A2.Ex9.m1.1.1.cmml" xref="A2.Ex9.m1.1.1"><eq id="A2.Ex9.m1.1.1.1.cmml" xref="A2.Ex9.m1.1.1.1"></eq><ci id="A2.Ex9.m1.1.1.2.cmml" xref="A2.Ex9.m1.1.1.2">𝜒</ci><apply id="A2.Ex9.m1.1.1.3.cmml" xref="A2.Ex9.m1.1.1.3"><divide id="A2.Ex9.m1.1.1.3.1.cmml" xref="A2.Ex9.m1.1.1.3"></divide><ci id="A2.Ex9.m1.1.1.3.2.cmml" xref="A2.Ex9.m1.1.1.3.2">𝜇</ci><apply id="A2.Ex9.m1.1.1.3.3.cmml" xref="A2.Ex9.m1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex9.m1.1.1.3.3.1.cmml" xref="A2.Ex9.m1.1.1.3.3">superscript</csymbol><ci id="A2.Ex9.m1.1.1.3.3.2.cmml" xref="A2.Ex9.m1.1.1.3.3.2">𝜎</ci><cn type="integer" id="A2.Ex9.m1.1.1.3.3.3.cmml" xref="A2.Ex9.m1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex9.m1.1c">\displaystyle\chi=\frac{\mu}{\sigma^{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A2.Ex10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A2.Ex10.m1.1" class="ltx_Math" alttext="\displaystyle\xi=\frac{1}{\sigma^{2}}," display="inline"><semantics id="A2.Ex10.m1.1a"><mrow id="A2.Ex10.m1.1.1.1" xref="A2.Ex10.m1.1.1.1.1.cmml"><mrow id="A2.Ex10.m1.1.1.1.1" xref="A2.Ex10.m1.1.1.1.1.cmml"><mi id="A2.Ex10.m1.1.1.1.1.2" xref="A2.Ex10.m1.1.1.1.1.2.cmml">ξ</mi><mo id="A2.Ex10.m1.1.1.1.1.1" xref="A2.Ex10.m1.1.1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="A2.Ex10.m1.1.1.1.1.3" xref="A2.Ex10.m1.1.1.1.1.3.cmml"><mfrac id="A2.Ex10.m1.1.1.1.1.3a" xref="A2.Ex10.m1.1.1.1.1.3.cmml"><mn id="A2.Ex10.m1.1.1.1.1.3.2" xref="A2.Ex10.m1.1.1.1.1.3.2.cmml">1</mn><msup id="A2.Ex10.m1.1.1.1.1.3.3" xref="A2.Ex10.m1.1.1.1.1.3.3.cmml"><mi id="A2.Ex10.m1.1.1.1.1.3.3.2" xref="A2.Ex10.m1.1.1.1.1.3.3.2.cmml">σ</mi><mn id="A2.Ex10.m1.1.1.1.1.3.3.3" xref="A2.Ex10.m1.1.1.1.1.3.3.3.cmml">2</mn></msup></mfrac></mstyle></mrow><mo id="A2.Ex10.m1.1.1.1.2" xref="A2.Ex10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex10.m1.1b"><apply id="A2.Ex10.m1.1.1.1.1.cmml" xref="A2.Ex10.m1.1.1.1"><eq id="A2.Ex10.m1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.1.1.1.1.1"></eq><ci id="A2.Ex10.m1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.1.1.1.1.2">𝜉</ci><apply id="A2.Ex10.m1.1.1.1.1.3.cmml" xref="A2.Ex10.m1.1.1.1.1.3"><divide id="A2.Ex10.m1.1.1.1.1.3.1.cmml" xref="A2.Ex10.m1.1.1.1.1.3"></divide><cn type="integer" id="A2.Ex10.m1.1.1.1.1.3.2.cmml" xref="A2.Ex10.m1.1.1.1.1.3.2">1</cn><apply id="A2.Ex10.m1.1.1.1.1.3.3.cmml" xref="A2.Ex10.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex10.m1.1.1.1.1.3.3.1.cmml" xref="A2.Ex10.m1.1.1.1.1.3.3">superscript</csymbol><ci id="A2.Ex10.m1.1.1.1.1.3.3.2.cmml" xref="A2.Ex10.m1.1.1.1.1.3.3.2">𝜎</ci><cn type="integer" id="A2.Ex10.m1.1.1.1.1.3.3.3.cmml" xref="A2.Ex10.m1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex10.m1.1c">\displaystyle\xi=\frac{1}{\sigma^{2}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A2.p1.9" class="ltx_p">products and ratios of Gaussians translates respectively into the sum and difference of the natural parameters <math id="A2.p1.8.m1.1" class="ltx_Math" alttext="\chi" display="inline"><semantics id="A2.p1.8.m1.1a"><mi id="A2.p1.8.m1.1.1" xref="A2.p1.8.m1.1.1.cmml">χ</mi><annotation-xml encoding="MathML-Content" id="A2.p1.8.m1.1b"><ci id="A2.p1.8.m1.1.1.cmml" xref="A2.p1.8.m1.1.1">𝜒</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.8.m1.1c">\chi</annotation></semantics></math> and <math id="A2.p1.9.m2.1" class="ltx_Math" alttext="\xi" display="inline"><semantics id="A2.p1.9.m2.1a"><mi id="A2.p1.9.m2.1.1" xref="A2.p1.9.m2.1.1.cmml">ξ</mi><annotation-xml encoding="MathML-Content" id="A2.p1.9.m2.1b"><ci id="A2.p1.9.m2.1.1.cmml" xref="A2.p1.9.m2.1.1">𝜉</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.9.m2.1c">\xi</annotation></semantics></math>. The implementation used in the code uses natural parameter Gaussian distributions, and sum and difference of its parameters to obtain the required products and ratios. This parameterization and the consequences on product and ratios easily generalize to any exponential family distribution, but it is here presented in the Gaussian case for convenience.</p>
</div>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Omitted proofs</h2>

<div id="A3.1" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof of <a href="#Thmproposition1" title="Proposition 1. ‣ II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</h6>
<div id="A3.1.p1" class="ltx_para">
<p id="A3.1.p1.5" class="ltx_p">At step <math id="A3.1.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="A3.1.p1.1.m1.1a"><mi id="A3.1.p1.1.m1.1.1" xref="A3.1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="A3.1.p1.1.m1.1b"><ci id="A3.1.p1.1.m1.1.1.cmml" xref="A3.1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.1.m1.1c">t</annotation></semantics></math> the global posterior for server parameters is <math id="A3.1.p1.2.m2.5" class="ltx_Math" alttext="s^{(t)}(\bm{\theta})=s_{i}(\bm{\theta})\prod_{j\neq i}^{K}s_{j}^{(t-1)}(\bm{\theta})" display="inline"><semantics id="A3.1.p1.2.m2.5a"><mrow id="A3.1.p1.2.m2.5.6" xref="A3.1.p1.2.m2.5.6.cmml"><mrow id="A3.1.p1.2.m2.5.6.2" xref="A3.1.p1.2.m2.5.6.2.cmml"><msup id="A3.1.p1.2.m2.5.6.2.2" xref="A3.1.p1.2.m2.5.6.2.2.cmml"><mi id="A3.1.p1.2.m2.5.6.2.2.2" xref="A3.1.p1.2.m2.5.6.2.2.2.cmml">s</mi><mrow id="A3.1.p1.2.m2.1.1.1.3" xref="A3.1.p1.2.m2.5.6.2.2.cmml"><mo stretchy="false" id="A3.1.p1.2.m2.1.1.1.3.1" xref="A3.1.p1.2.m2.5.6.2.2.cmml">(</mo><mi id="A3.1.p1.2.m2.1.1.1.1" xref="A3.1.p1.2.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.1.p1.2.m2.1.1.1.3.2" xref="A3.1.p1.2.m2.5.6.2.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.1.p1.2.m2.5.6.2.1" xref="A3.1.p1.2.m2.5.6.2.1.cmml">​</mo><mrow id="A3.1.p1.2.m2.5.6.2.3.2" xref="A3.1.p1.2.m2.5.6.2.cmml"><mo stretchy="false" id="A3.1.p1.2.m2.5.6.2.3.2.1" xref="A3.1.p1.2.m2.5.6.2.cmml">(</mo><mi id="A3.1.p1.2.m2.3.3" xref="A3.1.p1.2.m2.3.3.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.2.m2.5.6.2.3.2.2" xref="A3.1.p1.2.m2.5.6.2.cmml">)</mo></mrow></mrow><mo id="A3.1.p1.2.m2.5.6.1" xref="A3.1.p1.2.m2.5.6.1.cmml">=</mo><mrow id="A3.1.p1.2.m2.5.6.3" xref="A3.1.p1.2.m2.5.6.3.cmml"><msub id="A3.1.p1.2.m2.5.6.3.2" xref="A3.1.p1.2.m2.5.6.3.2.cmml"><mi id="A3.1.p1.2.m2.5.6.3.2.2" xref="A3.1.p1.2.m2.5.6.3.2.2.cmml">s</mi><mi id="A3.1.p1.2.m2.5.6.3.2.3" xref="A3.1.p1.2.m2.5.6.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.1.p1.2.m2.5.6.3.1" xref="A3.1.p1.2.m2.5.6.3.1.cmml">​</mo><mrow id="A3.1.p1.2.m2.5.6.3.3.2" xref="A3.1.p1.2.m2.5.6.3.cmml"><mo stretchy="false" id="A3.1.p1.2.m2.5.6.3.3.2.1" xref="A3.1.p1.2.m2.5.6.3.cmml">(</mo><mi id="A3.1.p1.2.m2.4.4" xref="A3.1.p1.2.m2.4.4.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.2.m2.5.6.3.3.2.2" xref="A3.1.p1.2.m2.5.6.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.1.p1.2.m2.5.6.3.1a" xref="A3.1.p1.2.m2.5.6.3.1.cmml">​</mo><mrow id="A3.1.p1.2.m2.5.6.3.4" xref="A3.1.p1.2.m2.5.6.3.4.cmml"><msubsup id="A3.1.p1.2.m2.5.6.3.4.1" xref="A3.1.p1.2.m2.5.6.3.4.1.cmml"><mo id="A3.1.p1.2.m2.5.6.3.4.1.2.2" xref="A3.1.p1.2.m2.5.6.3.4.1.2.2.cmml">∏</mo><mrow id="A3.1.p1.2.m2.5.6.3.4.1.2.3" xref="A3.1.p1.2.m2.5.6.3.4.1.2.3.cmml"><mi id="A3.1.p1.2.m2.5.6.3.4.1.2.3.2" xref="A3.1.p1.2.m2.5.6.3.4.1.2.3.2.cmml">j</mi><mo id="A3.1.p1.2.m2.5.6.3.4.1.2.3.1" xref="A3.1.p1.2.m2.5.6.3.4.1.2.3.1.cmml">≠</mo><mi id="A3.1.p1.2.m2.5.6.3.4.1.2.3.3" xref="A3.1.p1.2.m2.5.6.3.4.1.2.3.3.cmml">i</mi></mrow><mi id="A3.1.p1.2.m2.5.6.3.4.1.3" xref="A3.1.p1.2.m2.5.6.3.4.1.3.cmml">K</mi></msubsup><mrow id="A3.1.p1.2.m2.5.6.3.4.2" xref="A3.1.p1.2.m2.5.6.3.4.2.cmml"><msubsup id="A3.1.p1.2.m2.5.6.3.4.2.2" xref="A3.1.p1.2.m2.5.6.3.4.2.2.cmml"><mi id="A3.1.p1.2.m2.5.6.3.4.2.2.2.2" xref="A3.1.p1.2.m2.5.6.3.4.2.2.2.2.cmml">s</mi><mi id="A3.1.p1.2.m2.5.6.3.4.2.2.2.3" xref="A3.1.p1.2.m2.5.6.3.4.2.2.2.3.cmml">j</mi><mrow id="A3.1.p1.2.m2.2.2.1.1" xref="A3.1.p1.2.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.2.m2.2.2.1.1.2" xref="A3.1.p1.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="A3.1.p1.2.m2.2.2.1.1.1" xref="A3.1.p1.2.m2.2.2.1.1.1.cmml"><mi id="A3.1.p1.2.m2.2.2.1.1.1.2" xref="A3.1.p1.2.m2.2.2.1.1.1.2.cmml">t</mi><mo id="A3.1.p1.2.m2.2.2.1.1.1.1" xref="A3.1.p1.2.m2.2.2.1.1.1.1.cmml">−</mo><mn id="A3.1.p1.2.m2.2.2.1.1.1.3" xref="A3.1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A3.1.p1.2.m2.2.2.1.1.3" xref="A3.1.p1.2.m2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A3.1.p1.2.m2.5.6.3.4.2.1" xref="A3.1.p1.2.m2.5.6.3.4.2.1.cmml">​</mo><mrow id="A3.1.p1.2.m2.5.6.3.4.2.3.2" xref="A3.1.p1.2.m2.5.6.3.4.2.cmml"><mo stretchy="false" id="A3.1.p1.2.m2.5.6.3.4.2.3.2.1" xref="A3.1.p1.2.m2.5.6.3.4.2.cmml">(</mo><mi id="A3.1.p1.2.m2.5.5" xref="A3.1.p1.2.m2.5.5.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.2.m2.5.6.3.4.2.3.2.2" xref="A3.1.p1.2.m2.5.6.3.4.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.2.m2.5b"><apply id="A3.1.p1.2.m2.5.6.cmml" xref="A3.1.p1.2.m2.5.6"><eq id="A3.1.p1.2.m2.5.6.1.cmml" xref="A3.1.p1.2.m2.5.6.1"></eq><apply id="A3.1.p1.2.m2.5.6.2.cmml" xref="A3.1.p1.2.m2.5.6.2"><times id="A3.1.p1.2.m2.5.6.2.1.cmml" xref="A3.1.p1.2.m2.5.6.2.1"></times><apply id="A3.1.p1.2.m2.5.6.2.2.cmml" xref="A3.1.p1.2.m2.5.6.2.2"><csymbol cd="ambiguous" id="A3.1.p1.2.m2.5.6.2.2.1.cmml" xref="A3.1.p1.2.m2.5.6.2.2">superscript</csymbol><ci id="A3.1.p1.2.m2.5.6.2.2.2.cmml" xref="A3.1.p1.2.m2.5.6.2.2.2">𝑠</ci><ci id="A3.1.p1.2.m2.1.1.1.1.cmml" xref="A3.1.p1.2.m2.1.1.1.1">𝑡</ci></apply><ci id="A3.1.p1.2.m2.3.3.cmml" xref="A3.1.p1.2.m2.3.3">𝜽</ci></apply><apply id="A3.1.p1.2.m2.5.6.3.cmml" xref="A3.1.p1.2.m2.5.6.3"><times id="A3.1.p1.2.m2.5.6.3.1.cmml" xref="A3.1.p1.2.m2.5.6.3.1"></times><apply id="A3.1.p1.2.m2.5.6.3.2.cmml" xref="A3.1.p1.2.m2.5.6.3.2"><csymbol cd="ambiguous" id="A3.1.p1.2.m2.5.6.3.2.1.cmml" xref="A3.1.p1.2.m2.5.6.3.2">subscript</csymbol><ci id="A3.1.p1.2.m2.5.6.3.2.2.cmml" xref="A3.1.p1.2.m2.5.6.3.2.2">𝑠</ci><ci id="A3.1.p1.2.m2.5.6.3.2.3.cmml" xref="A3.1.p1.2.m2.5.6.3.2.3">𝑖</ci></apply><ci id="A3.1.p1.2.m2.4.4.cmml" xref="A3.1.p1.2.m2.4.4">𝜽</ci><apply id="A3.1.p1.2.m2.5.6.3.4.cmml" xref="A3.1.p1.2.m2.5.6.3.4"><apply id="A3.1.p1.2.m2.5.6.3.4.1.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1"><csymbol cd="ambiguous" id="A3.1.p1.2.m2.5.6.3.4.1.1.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1">superscript</csymbol><apply id="A3.1.p1.2.m2.5.6.3.4.1.2.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1"><csymbol cd="ambiguous" id="A3.1.p1.2.m2.5.6.3.4.1.2.1.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1">subscript</csymbol><csymbol cd="latexml" id="A3.1.p1.2.m2.5.6.3.4.1.2.2.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1.2.2">product</csymbol><apply id="A3.1.p1.2.m2.5.6.3.4.1.2.3.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1.2.3"><neq id="A3.1.p1.2.m2.5.6.3.4.1.2.3.1.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1.2.3.1"></neq><ci id="A3.1.p1.2.m2.5.6.3.4.1.2.3.2.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1.2.3.2">𝑗</ci><ci id="A3.1.p1.2.m2.5.6.3.4.1.2.3.3.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1.2.3.3">𝑖</ci></apply></apply><ci id="A3.1.p1.2.m2.5.6.3.4.1.3.cmml" xref="A3.1.p1.2.m2.5.6.3.4.1.3">𝐾</ci></apply><apply id="A3.1.p1.2.m2.5.6.3.4.2.cmml" xref="A3.1.p1.2.m2.5.6.3.4.2"><times id="A3.1.p1.2.m2.5.6.3.4.2.1.cmml" xref="A3.1.p1.2.m2.5.6.3.4.2.1"></times><apply id="A3.1.p1.2.m2.5.6.3.4.2.2.cmml" xref="A3.1.p1.2.m2.5.6.3.4.2.2"><csymbol cd="ambiguous" id="A3.1.p1.2.m2.5.6.3.4.2.2.1.cmml" xref="A3.1.p1.2.m2.5.6.3.4.2.2">superscript</csymbol><apply id="A3.1.p1.2.m2.5.6.3.4.2.2.2.cmml" xref="A3.1.p1.2.m2.5.6.3.4.2.2"><csymbol cd="ambiguous" id="A3.1.p1.2.m2.5.6.3.4.2.2.2.1.cmml" xref="A3.1.p1.2.m2.5.6.3.4.2.2">subscript</csymbol><ci id="A3.1.p1.2.m2.5.6.3.4.2.2.2.2.cmml" xref="A3.1.p1.2.m2.5.6.3.4.2.2.2.2">𝑠</ci><ci id="A3.1.p1.2.m2.5.6.3.4.2.2.2.3.cmml" xref="A3.1.p1.2.m2.5.6.3.4.2.2.2.3">𝑗</ci></apply><apply id="A3.1.p1.2.m2.2.2.1.1.1.cmml" xref="A3.1.p1.2.m2.2.2.1.1"><minus id="A3.1.p1.2.m2.2.2.1.1.1.1.cmml" xref="A3.1.p1.2.m2.2.2.1.1.1.1"></minus><ci id="A3.1.p1.2.m2.2.2.1.1.1.2.cmml" xref="A3.1.p1.2.m2.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="A3.1.p1.2.m2.2.2.1.1.1.3.cmml" xref="A3.1.p1.2.m2.2.2.1.1.1.3">1</cn></apply></apply><ci id="A3.1.p1.2.m2.5.5.cmml" xref="A3.1.p1.2.m2.5.5">𝜽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.2.m2.5c">s^{(t)}(\bm{\theta})=s_{i}(\bm{\theta})\prod_{j\neq i}^{K}s_{j}^{(t-1)}(\bm{\theta})</annotation></semantics></math> and analogously the client parameters distribution reads <math id="A3.1.p1.3.m3.5" class="ltx_Math" alttext="c^{(t)}(\bm{\phi})=c_{i}(\bm{\phi}_{i})\prod_{j\neq i}^{K}c_{j}^{(t-1)}(\bm{\phi}_{j})" display="inline"><semantics id="A3.1.p1.3.m3.5a"><mrow id="A3.1.p1.3.m3.5.5" xref="A3.1.p1.3.m3.5.5.cmml"><mrow id="A3.1.p1.3.m3.5.5.4" xref="A3.1.p1.3.m3.5.5.4.cmml"><msup id="A3.1.p1.3.m3.5.5.4.2" xref="A3.1.p1.3.m3.5.5.4.2.cmml"><mi id="A3.1.p1.3.m3.5.5.4.2.2" xref="A3.1.p1.3.m3.5.5.4.2.2.cmml">c</mi><mrow id="A3.1.p1.3.m3.1.1.1.3" xref="A3.1.p1.3.m3.5.5.4.2.cmml"><mo stretchy="false" id="A3.1.p1.3.m3.1.1.1.3.1" xref="A3.1.p1.3.m3.5.5.4.2.cmml">(</mo><mi id="A3.1.p1.3.m3.1.1.1.1" xref="A3.1.p1.3.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.1.p1.3.m3.1.1.1.3.2" xref="A3.1.p1.3.m3.5.5.4.2.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.1.p1.3.m3.5.5.4.1" xref="A3.1.p1.3.m3.5.5.4.1.cmml">​</mo><mrow id="A3.1.p1.3.m3.5.5.4.3.2" xref="A3.1.p1.3.m3.5.5.4.cmml"><mo stretchy="false" id="A3.1.p1.3.m3.5.5.4.3.2.1" xref="A3.1.p1.3.m3.5.5.4.cmml">(</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.1.p1.3.m3.3.3" xref="A3.1.p1.3.m3.3.3.cmml">ϕ</mi><mo stretchy="false" id="A3.1.p1.3.m3.5.5.4.3.2.2" xref="A3.1.p1.3.m3.5.5.4.cmml">)</mo></mrow></mrow><mo id="A3.1.p1.3.m3.5.5.3" xref="A3.1.p1.3.m3.5.5.3.cmml">=</mo><mrow id="A3.1.p1.3.m3.5.5.2" xref="A3.1.p1.3.m3.5.5.2.cmml"><msub id="A3.1.p1.3.m3.5.5.2.4" xref="A3.1.p1.3.m3.5.5.2.4.cmml"><mi id="A3.1.p1.3.m3.5.5.2.4.2" xref="A3.1.p1.3.m3.5.5.2.4.2.cmml">c</mi><mi id="A3.1.p1.3.m3.5.5.2.4.3" xref="A3.1.p1.3.m3.5.5.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.1.p1.3.m3.5.5.2.3" xref="A3.1.p1.3.m3.5.5.2.3.cmml">​</mo><mrow id="A3.1.p1.3.m3.4.4.1.1.1" xref="A3.1.p1.3.m3.4.4.1.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.3.m3.4.4.1.1.1.2" xref="A3.1.p1.3.m3.4.4.1.1.1.1.cmml">(</mo><msub id="A3.1.p1.3.m3.4.4.1.1.1.1" xref="A3.1.p1.3.m3.4.4.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.1.p1.3.m3.4.4.1.1.1.1.2" xref="A3.1.p1.3.m3.4.4.1.1.1.1.2.cmml">ϕ</mi><mi id="A3.1.p1.3.m3.4.4.1.1.1.1.3" xref="A3.1.p1.3.m3.4.4.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.1.p1.3.m3.4.4.1.1.1.3" xref="A3.1.p1.3.m3.4.4.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.1.p1.3.m3.5.5.2.3a" xref="A3.1.p1.3.m3.5.5.2.3.cmml">​</mo><mrow id="A3.1.p1.3.m3.5.5.2.2" xref="A3.1.p1.3.m3.5.5.2.2.cmml"><msubsup id="A3.1.p1.3.m3.5.5.2.2.2" xref="A3.1.p1.3.m3.5.5.2.2.2.cmml"><mo id="A3.1.p1.3.m3.5.5.2.2.2.2.2" xref="A3.1.p1.3.m3.5.5.2.2.2.2.2.cmml">∏</mo><mrow id="A3.1.p1.3.m3.5.5.2.2.2.2.3" xref="A3.1.p1.3.m3.5.5.2.2.2.2.3.cmml"><mi id="A3.1.p1.3.m3.5.5.2.2.2.2.3.2" xref="A3.1.p1.3.m3.5.5.2.2.2.2.3.2.cmml">j</mi><mo id="A3.1.p1.3.m3.5.5.2.2.2.2.3.1" xref="A3.1.p1.3.m3.5.5.2.2.2.2.3.1.cmml">≠</mo><mi id="A3.1.p1.3.m3.5.5.2.2.2.2.3.3" xref="A3.1.p1.3.m3.5.5.2.2.2.2.3.3.cmml">i</mi></mrow><mi id="A3.1.p1.3.m3.5.5.2.2.2.3" xref="A3.1.p1.3.m3.5.5.2.2.2.3.cmml">K</mi></msubsup><mrow id="A3.1.p1.3.m3.5.5.2.2.1" xref="A3.1.p1.3.m3.5.5.2.2.1.cmml"><msubsup id="A3.1.p1.3.m3.5.5.2.2.1.3" xref="A3.1.p1.3.m3.5.5.2.2.1.3.cmml"><mi id="A3.1.p1.3.m3.5.5.2.2.1.3.2.2" xref="A3.1.p1.3.m3.5.5.2.2.1.3.2.2.cmml">c</mi><mi id="A3.1.p1.3.m3.5.5.2.2.1.3.2.3" xref="A3.1.p1.3.m3.5.5.2.2.1.3.2.3.cmml">j</mi><mrow id="A3.1.p1.3.m3.2.2.1.1" xref="A3.1.p1.3.m3.2.2.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.3.m3.2.2.1.1.2" xref="A3.1.p1.3.m3.2.2.1.1.1.cmml">(</mo><mrow id="A3.1.p1.3.m3.2.2.1.1.1" xref="A3.1.p1.3.m3.2.2.1.1.1.cmml"><mi id="A3.1.p1.3.m3.2.2.1.1.1.2" xref="A3.1.p1.3.m3.2.2.1.1.1.2.cmml">t</mi><mo id="A3.1.p1.3.m3.2.2.1.1.1.1" xref="A3.1.p1.3.m3.2.2.1.1.1.1.cmml">−</mo><mn id="A3.1.p1.3.m3.2.2.1.1.1.3" xref="A3.1.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A3.1.p1.3.m3.2.2.1.1.3" xref="A3.1.p1.3.m3.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A3.1.p1.3.m3.5.5.2.2.1.2" xref="A3.1.p1.3.m3.5.5.2.2.1.2.cmml">​</mo><mrow id="A3.1.p1.3.m3.5.5.2.2.1.1.1" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.3.m3.5.5.2.2.1.1.1.2" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.cmml">(</mo><msub id="A3.1.p1.3.m3.5.5.2.2.1.1.1.1" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.2" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.2.cmml">ϕ</mi><mi id="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.3" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="A3.1.p1.3.m3.5.5.2.2.1.1.1.3" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.3.m3.5b"><apply id="A3.1.p1.3.m3.5.5.cmml" xref="A3.1.p1.3.m3.5.5"><eq id="A3.1.p1.3.m3.5.5.3.cmml" xref="A3.1.p1.3.m3.5.5.3"></eq><apply id="A3.1.p1.3.m3.5.5.4.cmml" xref="A3.1.p1.3.m3.5.5.4"><times id="A3.1.p1.3.m3.5.5.4.1.cmml" xref="A3.1.p1.3.m3.5.5.4.1"></times><apply id="A3.1.p1.3.m3.5.5.4.2.cmml" xref="A3.1.p1.3.m3.5.5.4.2"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.5.5.4.2.1.cmml" xref="A3.1.p1.3.m3.5.5.4.2">superscript</csymbol><ci id="A3.1.p1.3.m3.5.5.4.2.2.cmml" xref="A3.1.p1.3.m3.5.5.4.2.2">𝑐</ci><ci id="A3.1.p1.3.m3.1.1.1.1.cmml" xref="A3.1.p1.3.m3.1.1.1.1">𝑡</ci></apply><ci id="A3.1.p1.3.m3.3.3.cmml" xref="A3.1.p1.3.m3.3.3">bold-italic-ϕ</ci></apply><apply id="A3.1.p1.3.m3.5.5.2.cmml" xref="A3.1.p1.3.m3.5.5.2"><times id="A3.1.p1.3.m3.5.5.2.3.cmml" xref="A3.1.p1.3.m3.5.5.2.3"></times><apply id="A3.1.p1.3.m3.5.5.2.4.cmml" xref="A3.1.p1.3.m3.5.5.2.4"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.5.5.2.4.1.cmml" xref="A3.1.p1.3.m3.5.5.2.4">subscript</csymbol><ci id="A3.1.p1.3.m3.5.5.2.4.2.cmml" xref="A3.1.p1.3.m3.5.5.2.4.2">𝑐</ci><ci id="A3.1.p1.3.m3.5.5.2.4.3.cmml" xref="A3.1.p1.3.m3.5.5.2.4.3">𝑖</ci></apply><apply id="A3.1.p1.3.m3.4.4.1.1.1.1.cmml" xref="A3.1.p1.3.m3.4.4.1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.4.4.1.1.1.1.1.cmml" xref="A3.1.p1.3.m3.4.4.1.1.1">subscript</csymbol><ci id="A3.1.p1.3.m3.4.4.1.1.1.1.2.cmml" xref="A3.1.p1.3.m3.4.4.1.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.1.p1.3.m3.4.4.1.1.1.1.3.cmml" xref="A3.1.p1.3.m3.4.4.1.1.1.1.3">𝑖</ci></apply><apply id="A3.1.p1.3.m3.5.5.2.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2"><apply id="A3.1.p1.3.m3.5.5.2.2.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.5.5.2.2.2.1.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2">superscript</csymbol><apply id="A3.1.p1.3.m3.5.5.2.2.2.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.5.5.2.2.2.2.1.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2">subscript</csymbol><csymbol cd="latexml" id="A3.1.p1.3.m3.5.5.2.2.2.2.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2.2.2">product</csymbol><apply id="A3.1.p1.3.m3.5.5.2.2.2.2.3.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2.2.3"><neq id="A3.1.p1.3.m3.5.5.2.2.2.2.3.1.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2.2.3.1"></neq><ci id="A3.1.p1.3.m3.5.5.2.2.2.2.3.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2.2.3.2">𝑗</ci><ci id="A3.1.p1.3.m3.5.5.2.2.2.2.3.3.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2.2.3.3">𝑖</ci></apply></apply><ci id="A3.1.p1.3.m3.5.5.2.2.2.3.cmml" xref="A3.1.p1.3.m3.5.5.2.2.2.3">𝐾</ci></apply><apply id="A3.1.p1.3.m3.5.5.2.2.1.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1"><times id="A3.1.p1.3.m3.5.5.2.2.1.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.2"></times><apply id="A3.1.p1.3.m3.5.5.2.2.1.3.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.3"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.5.5.2.2.1.3.1.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.3">superscript</csymbol><apply id="A3.1.p1.3.m3.5.5.2.2.1.3.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.3"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.5.5.2.2.1.3.2.1.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.3">subscript</csymbol><ci id="A3.1.p1.3.m3.5.5.2.2.1.3.2.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.3.2.2">𝑐</ci><ci id="A3.1.p1.3.m3.5.5.2.2.1.3.2.3.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.3.2.3">𝑗</ci></apply><apply id="A3.1.p1.3.m3.2.2.1.1.1.cmml" xref="A3.1.p1.3.m3.2.2.1.1"><minus id="A3.1.p1.3.m3.2.2.1.1.1.1.cmml" xref="A3.1.p1.3.m3.2.2.1.1.1.1"></minus><ci id="A3.1.p1.3.m3.2.2.1.1.1.2.cmml" xref="A3.1.p1.3.m3.2.2.1.1.1.2">𝑡</ci><cn type="integer" id="A3.1.p1.3.m3.2.2.1.1.1.3.cmml" xref="A3.1.p1.3.m3.2.2.1.1.1.3">1</cn></apply></apply><apply id="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.1.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1">subscript</csymbol><ci id="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.2.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.3.cmml" xref="A3.1.p1.3.m3.5.5.2.2.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.3.m3.5c">c^{(t)}(\bm{\phi})=c_{i}(\bm{\phi}_{i})\prod_{j\neq i}^{K}c_{j}^{(t-1)}(\bm{\phi}_{j})</annotation></semantics></math>. Then the <span id="A3.1.p1.5.1" class="ltx_text ltx_font_typewriter">EP</span>-like update for the model described is given by minimizing the following KL divergence w.r.t <math id="A3.1.p1.4.m4.1" class="ltx_Math" alttext="s_{i}(\bm{\theta})" display="inline"><semantics id="A3.1.p1.4.m4.1a"><mrow id="A3.1.p1.4.m4.1.2" xref="A3.1.p1.4.m4.1.2.cmml"><msub id="A3.1.p1.4.m4.1.2.2" xref="A3.1.p1.4.m4.1.2.2.cmml"><mi id="A3.1.p1.4.m4.1.2.2.2" xref="A3.1.p1.4.m4.1.2.2.2.cmml">s</mi><mi id="A3.1.p1.4.m4.1.2.2.3" xref="A3.1.p1.4.m4.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.1.p1.4.m4.1.2.1" xref="A3.1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="A3.1.p1.4.m4.1.2.3.2" xref="A3.1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="A3.1.p1.4.m4.1.2.3.2.1" xref="A3.1.p1.4.m4.1.2.cmml">(</mo><mi id="A3.1.p1.4.m4.1.1" xref="A3.1.p1.4.m4.1.1.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.4.m4.1.2.3.2.2" xref="A3.1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.4.m4.1b"><apply id="A3.1.p1.4.m4.1.2.cmml" xref="A3.1.p1.4.m4.1.2"><times id="A3.1.p1.4.m4.1.2.1.cmml" xref="A3.1.p1.4.m4.1.2.1"></times><apply id="A3.1.p1.4.m4.1.2.2.cmml" xref="A3.1.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="A3.1.p1.4.m4.1.2.2.1.cmml" xref="A3.1.p1.4.m4.1.2.2">subscript</csymbol><ci id="A3.1.p1.4.m4.1.2.2.2.cmml" xref="A3.1.p1.4.m4.1.2.2.2">𝑠</ci><ci id="A3.1.p1.4.m4.1.2.2.3.cmml" xref="A3.1.p1.4.m4.1.2.2.3">𝑖</ci></apply><ci id="A3.1.p1.4.m4.1.1.cmml" xref="A3.1.p1.4.m4.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.4.m4.1c">s_{i}(\bm{\theta})</annotation></semantics></math> and <math id="A3.1.p1.5.m5.1" class="ltx_Math" alttext="c_{i}(\bm{\phi}_{i})" display="inline"><semantics id="A3.1.p1.5.m5.1a"><mrow id="A3.1.p1.5.m5.1.1" xref="A3.1.p1.5.m5.1.1.cmml"><msub id="A3.1.p1.5.m5.1.1.3" xref="A3.1.p1.5.m5.1.1.3.cmml"><mi id="A3.1.p1.5.m5.1.1.3.2" xref="A3.1.p1.5.m5.1.1.3.2.cmml">c</mi><mi id="A3.1.p1.5.m5.1.1.3.3" xref="A3.1.p1.5.m5.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.1.p1.5.m5.1.1.2" xref="A3.1.p1.5.m5.1.1.2.cmml">​</mo><mrow id="A3.1.p1.5.m5.1.1.1.1" xref="A3.1.p1.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.5.m5.1.1.1.1.2" xref="A3.1.p1.5.m5.1.1.1.1.1.cmml">(</mo><msub id="A3.1.p1.5.m5.1.1.1.1.1" xref="A3.1.p1.5.m5.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.1.p1.5.m5.1.1.1.1.1.2" xref="A3.1.p1.5.m5.1.1.1.1.1.2.cmml">ϕ</mi><mi id="A3.1.p1.5.m5.1.1.1.1.1.3" xref="A3.1.p1.5.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.1.p1.5.m5.1.1.1.1.3" xref="A3.1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.5.m5.1b"><apply id="A3.1.p1.5.m5.1.1.cmml" xref="A3.1.p1.5.m5.1.1"><times id="A3.1.p1.5.m5.1.1.2.cmml" xref="A3.1.p1.5.m5.1.1.2"></times><apply id="A3.1.p1.5.m5.1.1.3.cmml" xref="A3.1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="A3.1.p1.5.m5.1.1.3.1.cmml" xref="A3.1.p1.5.m5.1.1.3">subscript</csymbol><ci id="A3.1.p1.5.m5.1.1.3.2.cmml" xref="A3.1.p1.5.m5.1.1.3.2">𝑐</ci><ci id="A3.1.p1.5.m5.1.1.3.3.cmml" xref="A3.1.p1.5.m5.1.1.3.3">𝑖</ci></apply><apply id="A3.1.p1.5.m5.1.1.1.1.1.cmml" xref="A3.1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.5.m5.1.1.1.1.1.1.cmml" xref="A3.1.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="A3.1.p1.5.m5.1.1.1.1.1.2.cmml" xref="A3.1.p1.5.m5.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.1.p1.5.m5.1.1.1.1.1.3.cmml" xref="A3.1.p1.5.m5.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.5.m5.1c">c_{i}(\bm{\phi}_{i})</annotation></semantics></math></p>
<table id="A4.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A3.Ex11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A3.Ex11.m1.1" class="ltx_Math" alttext="\displaystyle D_{KL}" display="inline"><semantics id="A3.Ex11.m1.1a"><msub id="A3.Ex11.m1.1.1" xref="A3.Ex11.m1.1.1.cmml"><mi id="A3.Ex11.m1.1.1.2" xref="A3.Ex11.m1.1.1.2.cmml">D</mi><mrow id="A3.Ex11.m1.1.1.3" xref="A3.Ex11.m1.1.1.3.cmml"><mi id="A3.Ex11.m1.1.1.3.2" xref="A3.Ex11.m1.1.1.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="A3.Ex11.m1.1.1.3.1" xref="A3.Ex11.m1.1.1.3.1.cmml">​</mo><mi id="A3.Ex11.m1.1.1.3.3" xref="A3.Ex11.m1.1.1.3.3.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A3.Ex11.m1.1b"><apply id="A3.Ex11.m1.1.1.cmml" xref="A3.Ex11.m1.1.1"><csymbol cd="ambiguous" id="A3.Ex11.m1.1.1.1.cmml" xref="A3.Ex11.m1.1.1">subscript</csymbol><ci id="A3.Ex11.m1.1.1.2.cmml" xref="A3.Ex11.m1.1.1.2">𝐷</ci><apply id="A3.Ex11.m1.1.1.3.cmml" xref="A3.Ex11.m1.1.1.3"><times id="A3.Ex11.m1.1.1.3.1.cmml" xref="A3.Ex11.m1.1.1.3.1"></times><ci id="A3.Ex11.m1.1.1.3.2.cmml" xref="A3.Ex11.m1.1.1.3.2">𝐾</ci><ci id="A3.Ex11.m1.1.1.3.3.cmml" xref="A3.Ex11.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex11.m1.1c">\displaystyle D_{KL}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.Ex11.m2.13" class="ltx_math_unparsed" alttext="\displaystyle\left(s^{(t)}(\bm{\theta})c^{(t)}(\bm{\phi})\bigg{|}\bigg{|}\frac{s^{(t)}(\bm{\theta})c^{(t)}(\bm{\phi})}{s_{i}(\bm{\theta})c_{i}(\bm{\phi}_{i})}\frac{p(\bm{\theta},\bm{\phi}_{i}|\mathcal{D}_{i})}{p(\bm{\theta})^{\frac{k-1}{k}}}\right)=" display="inline"><semantics id="A3.Ex11.m2.13a"><mrow id="A3.Ex11.m2.13b"><mrow id="A3.Ex11.m2.13.14"><mo id="A3.Ex11.m2.13.14.1">(</mo><msup id="A3.Ex11.m2.13.14.2"><mi id="A3.Ex11.m2.13.14.2.2">s</mi><mrow id="A3.Ex11.m2.1.1.1.3"><mo stretchy="false" id="A3.Ex11.m2.1.1.1.3.1">(</mo><mi id="A3.Ex11.m2.1.1.1.1">t</mi><mo stretchy="false" id="A3.Ex11.m2.1.1.1.3.2">)</mo></mrow></msup><mrow id="A3.Ex11.m2.13.14.3"><mo stretchy="false" id="A3.Ex11.m2.13.14.3.1">(</mo><mi id="A3.Ex11.m2.12.12">𝜽</mi><mo stretchy="false" id="A3.Ex11.m2.13.14.3.2">)</mo></mrow><msup id="A3.Ex11.m2.13.14.4"><mi id="A3.Ex11.m2.13.14.4.2">c</mi><mrow id="A3.Ex11.m2.2.2.1.3"><mo stretchy="false" id="A3.Ex11.m2.2.2.1.3.1">(</mo><mi id="A3.Ex11.m2.2.2.1.1">t</mi><mo stretchy="false" id="A3.Ex11.m2.2.2.1.3.2">)</mo></mrow></msup><mrow id="A3.Ex11.m2.13.14.5"><mo stretchy="false" id="A3.Ex11.m2.13.14.5.1">(</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex11.m2.13.13">ϕ</mi><mo stretchy="false" id="A3.Ex11.m2.13.14.5.2">)</mo></mrow><mo fence="false" maxsize="210%" minsize="210%" rspace="0.167em" id="A3.Ex11.m2.13.14.6">|</mo><mo fence="false" maxsize="210%" minsize="210%" rspace="0.167em" id="A3.Ex11.m2.13.14.7">|</mo><mstyle displaystyle="true" id="A3.Ex11.m2.8.8"><mfrac id="A3.Ex11.m2.8.8a"><mrow id="A3.Ex11.m2.6.6.4"><msup id="A3.Ex11.m2.6.6.4.6"><mi id="A3.Ex11.m2.6.6.4.6.2">s</mi><mrow id="A3.Ex11.m2.3.3.1.1.1.3"><mo stretchy="false" id="A3.Ex11.m2.3.3.1.1.1.3.1">(</mo><mi id="A3.Ex11.m2.3.3.1.1.1.1">t</mi><mo stretchy="false" id="A3.Ex11.m2.3.3.1.1.1.3.2">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex11.m2.6.6.4.5">​</mo><mrow id="A3.Ex11.m2.6.6.4.7.2"><mo stretchy="false" id="A3.Ex11.m2.6.6.4.7.2.1">(</mo><mi id="A3.Ex11.m2.5.5.3.3">𝜽</mi><mo stretchy="false" id="A3.Ex11.m2.6.6.4.7.2.2">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex11.m2.6.6.4.5a">​</mo><msup id="A3.Ex11.m2.6.6.4.8"><mi id="A3.Ex11.m2.6.6.4.8.2">c</mi><mrow id="A3.Ex11.m2.4.4.2.2.1.3"><mo stretchy="false" id="A3.Ex11.m2.4.4.2.2.1.3.1">(</mo><mi id="A3.Ex11.m2.4.4.2.2.1.1">t</mi><mo stretchy="false" id="A3.Ex11.m2.4.4.2.2.1.3.2">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex11.m2.6.6.4.5b">​</mo><mrow id="A3.Ex11.m2.6.6.4.9.2"><mo stretchy="false" id="A3.Ex11.m2.6.6.4.9.2.1">(</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex11.m2.6.6.4.4">ϕ</mi><mo stretchy="false" id="A3.Ex11.m2.6.6.4.9.2.2">)</mo></mrow></mrow><mrow id="A3.Ex11.m2.8.8.6"><msub id="A3.Ex11.m2.8.8.6.4"><mi id="A3.Ex11.m2.8.8.6.4.2">s</mi><mi id="A3.Ex11.m2.8.8.6.4.3">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex11.m2.8.8.6.3">​</mo><mrow id="A3.Ex11.m2.8.8.6.5.2"><mo stretchy="false" id="A3.Ex11.m2.8.8.6.5.2.1">(</mo><mi id="A3.Ex11.m2.7.7.5.1">𝜽</mi><mo stretchy="false" id="A3.Ex11.m2.8.8.6.5.2.2">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex11.m2.8.8.6.3a">​</mo><msub id="A3.Ex11.m2.8.8.6.6"><mi id="A3.Ex11.m2.8.8.6.6.2">c</mi><mi id="A3.Ex11.m2.8.8.6.6.3">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex11.m2.8.8.6.3b">​</mo><mrow id="A3.Ex11.m2.8.8.6.2.1"><mo stretchy="false" id="A3.Ex11.m2.8.8.6.2.1.2">(</mo><msub id="A3.Ex11.m2.8.8.6.2.1.1"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex11.m2.8.8.6.2.1.1.2">ϕ</mi><mi id="A3.Ex11.m2.8.8.6.2.1.1.3">i</mi></msub><mo stretchy="false" id="A3.Ex11.m2.8.8.6.2.1.3">)</mo></mrow></mrow></mfrac></mstyle><mstyle displaystyle="true" id="A3.Ex11.m2.11.11"><mfrac id="A3.Ex11.m2.11.11a"><mrow id="A3.Ex11.m2.10.10.2"><mi id="A3.Ex11.m2.10.10.2.4">p</mi><mo lspace="0em" rspace="0em" id="A3.Ex11.m2.10.10.2.3">​</mo><mrow id="A3.Ex11.m2.10.10.2.2.1"><mo stretchy="false" id="A3.Ex11.m2.10.10.2.2.1.2">(</mo><mi id="A3.Ex11.m2.9.9.1.1">𝜽</mi><mo id="A3.Ex11.m2.10.10.2.2.1.3">,</mo><mrow id="A3.Ex11.m2.10.10.2.2.1.1"><msub id="A3.Ex11.m2.10.10.2.2.1.1.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex11.m2.10.10.2.2.1.1.2.2">ϕ</mi><mi id="A3.Ex11.m2.10.10.2.2.1.1.2.3">i</mi></msub><mo fence="false" id="A3.Ex11.m2.10.10.2.2.1.1.1">|</mo><msub id="A3.Ex11.m2.10.10.2.2.1.1.3"><mi class="ltx_font_mathcaligraphic" id="A3.Ex11.m2.10.10.2.2.1.1.3.2">𝒟</mi><mi id="A3.Ex11.m2.10.10.2.2.1.1.3.3">i</mi></msub></mrow><mo stretchy="false" id="A3.Ex11.m2.10.10.2.2.1.4">)</mo></mrow></mrow><mrow id="A3.Ex11.m2.11.11.3"><mi id="A3.Ex11.m2.11.11.3.3">p</mi><mo lspace="0em" rspace="0em" id="A3.Ex11.m2.11.11.3.2">​</mo><msup id="A3.Ex11.m2.11.11.3.4"><mrow id="A3.Ex11.m2.11.11.3.4.2.2"><mo stretchy="false" id="A3.Ex11.m2.11.11.3.4.2.2.1">(</mo><mi id="A3.Ex11.m2.11.11.3.1">𝜽</mi><mo stretchy="false" id="A3.Ex11.m2.11.11.3.4.2.2.2">)</mo></mrow><mfrac id="A3.Ex11.m2.11.11.3.4.3"><mrow id="A3.Ex11.m2.11.11.3.4.3.2"><mi id="A3.Ex11.m2.11.11.3.4.3.2.2">k</mi><mo id="A3.Ex11.m2.11.11.3.4.3.2.1">−</mo><mn id="A3.Ex11.m2.11.11.3.4.3.2.3">1</mn></mrow><mi id="A3.Ex11.m2.11.11.3.4.3.3">k</mi></mfrac></msup></mrow></mfrac></mstyle><mo id="A3.Ex11.m2.13.14.8">)</mo></mrow><mo id="A3.Ex11.m2.13.15">=</mo></mrow><annotation encoding="application/x-tex" id="A3.Ex11.m2.13c">\displaystyle\left(s^{(t)}(\bm{\theta})c^{(t)}(\bm{\phi})\bigg{|}\bigg{|}\frac{s^{(t)}(\bm{\theta})c^{(t)}(\bm{\phi})}{s_{i}(\bm{\theta})c_{i}(\bm{\phi}_{i})}\frac{p(\bm{\theta},\bm{\phi}_{i}|\mathcal{D}_{i})}{p(\bm{\theta})^{\frac{k-1}{k}}}\right)=</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.Ex12.m1.5" class="ltx_Math" alttext="\displaystyle=\int d\bm{\theta}\ s^{(t)}(\bm{\theta})\log s_{i}(\bm{\theta})\int d\bm{\phi}\ c^{(t)}(\bm{\phi})" display="inline"><semantics id="A3.Ex12.m1.5a"><mrow id="A3.Ex12.m1.5.6" xref="A3.Ex12.m1.5.6.cmml"><mi id="A3.Ex12.m1.5.6.2" xref="A3.Ex12.m1.5.6.2.cmml"></mi><mo id="A3.Ex12.m1.5.6.1" xref="A3.Ex12.m1.5.6.1.cmml">=</mo><mstyle displaystyle="true" id="A3.Ex12.m1.5.6.3" xref="A3.Ex12.m1.5.6.3.cmml"><mrow id="A3.Ex12.m1.5.6.3a" xref="A3.Ex12.m1.5.6.3.cmml"><mo id="A3.Ex12.m1.5.6.3.1" xref="A3.Ex12.m1.5.6.3.1.cmml">∫</mo><mrow id="A3.Ex12.m1.5.6.3.2" xref="A3.Ex12.m1.5.6.3.2.cmml"><mrow id="A3.Ex12.m1.5.6.3.2.2" xref="A3.Ex12.m1.5.6.3.2.2.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.2.1" xref="A3.Ex12.m1.5.6.3.2.2.1.cmml">𝑑</mo><mi id="A3.Ex12.m1.5.6.3.2.2.2" xref="A3.Ex12.m1.5.6.3.2.2.2.cmml">𝜽</mi></mrow><mo lspace="0.500em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.1" xref="A3.Ex12.m1.5.6.3.2.1.cmml">​</mo><msup id="A3.Ex12.m1.5.6.3.2.3" xref="A3.Ex12.m1.5.6.3.2.3.cmml"><mi id="A3.Ex12.m1.5.6.3.2.3.2" xref="A3.Ex12.m1.5.6.3.2.3.2.cmml">s</mi><mrow id="A3.Ex12.m1.1.1.1.3" xref="A3.Ex12.m1.5.6.3.2.3.cmml"><mo stretchy="false" id="A3.Ex12.m1.1.1.1.3.1" xref="A3.Ex12.m1.5.6.3.2.3.cmml">(</mo><mi id="A3.Ex12.m1.1.1.1.1" xref="A3.Ex12.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex12.m1.1.1.1.3.2" xref="A3.Ex12.m1.5.6.3.2.3.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.1a" xref="A3.Ex12.m1.5.6.3.2.1.cmml">​</mo><mrow id="A3.Ex12.m1.5.6.3.2.4.2" xref="A3.Ex12.m1.5.6.3.2.cmml"><mo stretchy="false" id="A3.Ex12.m1.5.6.3.2.4.2.1" xref="A3.Ex12.m1.5.6.3.2.cmml">(</mo><mi id="A3.Ex12.m1.3.3" xref="A3.Ex12.m1.3.3.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex12.m1.5.6.3.2.4.2.2" xref="A3.Ex12.m1.5.6.3.2.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.1b" xref="A3.Ex12.m1.5.6.3.2.1.cmml">​</mo><mrow id="A3.Ex12.m1.5.6.3.2.5" xref="A3.Ex12.m1.5.6.3.2.5.cmml"><mi id="A3.Ex12.m1.5.6.3.2.5.1" xref="A3.Ex12.m1.5.6.3.2.5.1.cmml">log</mi><mo lspace="0.167em" id="A3.Ex12.m1.5.6.3.2.5a" xref="A3.Ex12.m1.5.6.3.2.5.cmml">⁡</mo><msub id="A3.Ex12.m1.5.6.3.2.5.2" xref="A3.Ex12.m1.5.6.3.2.5.2.cmml"><mi id="A3.Ex12.m1.5.6.3.2.5.2.2" xref="A3.Ex12.m1.5.6.3.2.5.2.2.cmml">s</mi><mi id="A3.Ex12.m1.5.6.3.2.5.2.3" xref="A3.Ex12.m1.5.6.3.2.5.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.1c" xref="A3.Ex12.m1.5.6.3.2.1.cmml">​</mo><mrow id="A3.Ex12.m1.5.6.3.2.6.2" xref="A3.Ex12.m1.5.6.3.2.cmml"><mo stretchy="false" id="A3.Ex12.m1.5.6.3.2.6.2.1" xref="A3.Ex12.m1.5.6.3.2.cmml">(</mo><mi id="A3.Ex12.m1.4.4" xref="A3.Ex12.m1.4.4.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex12.m1.5.6.3.2.6.2.2" xref="A3.Ex12.m1.5.6.3.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.1d" xref="A3.Ex12.m1.5.6.3.2.1.cmml">​</mo><mrow id="A3.Ex12.m1.5.6.3.2.7" xref="A3.Ex12.m1.5.6.3.2.7.cmml"><mo id="A3.Ex12.m1.5.6.3.2.7.1" xref="A3.Ex12.m1.5.6.3.2.7.1.cmml">∫</mo><mrow id="A3.Ex12.m1.5.6.3.2.7.2" xref="A3.Ex12.m1.5.6.3.2.7.2.cmml"><mrow id="A3.Ex12.m1.5.6.3.2.7.2.2" xref="A3.Ex12.m1.5.6.3.2.7.2.2.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.7.2.2.1" xref="A3.Ex12.m1.5.6.3.2.7.2.2.1.cmml">𝑑</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex12.m1.5.6.3.2.7.2.2.2" xref="A3.Ex12.m1.5.6.3.2.7.2.2.2.cmml">ϕ</mi></mrow><mo lspace="0.500em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.7.2.1" xref="A3.Ex12.m1.5.6.3.2.7.2.1.cmml">​</mo><msup id="A3.Ex12.m1.5.6.3.2.7.2.3" xref="A3.Ex12.m1.5.6.3.2.7.2.3.cmml"><mi id="A3.Ex12.m1.5.6.3.2.7.2.3.2" xref="A3.Ex12.m1.5.6.3.2.7.2.3.2.cmml">c</mi><mrow id="A3.Ex12.m1.2.2.1.3" xref="A3.Ex12.m1.5.6.3.2.7.2.3.cmml"><mo stretchy="false" id="A3.Ex12.m1.2.2.1.3.1" xref="A3.Ex12.m1.5.6.3.2.7.2.3.cmml">(</mo><mi id="A3.Ex12.m1.2.2.1.1" xref="A3.Ex12.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex12.m1.2.2.1.3.2" xref="A3.Ex12.m1.5.6.3.2.7.2.3.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex12.m1.5.6.3.2.7.2.1a" xref="A3.Ex12.m1.5.6.3.2.7.2.1.cmml">​</mo><mrow id="A3.Ex12.m1.5.6.3.2.7.2.4.2" xref="A3.Ex12.m1.5.6.3.2.7.2.cmml"><mo stretchy="false" id="A3.Ex12.m1.5.6.3.2.7.2.4.2.1" xref="A3.Ex12.m1.5.6.3.2.7.2.cmml">(</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex12.m1.5.5" xref="A3.Ex12.m1.5.5.cmml">ϕ</mi><mo stretchy="false" id="A3.Ex12.m1.5.6.3.2.7.2.4.2.2" xref="A3.Ex12.m1.5.6.3.2.7.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex12.m1.5b"><apply id="A3.Ex12.m1.5.6.cmml" xref="A3.Ex12.m1.5.6"><eq id="A3.Ex12.m1.5.6.1.cmml" xref="A3.Ex12.m1.5.6.1"></eq><csymbol cd="latexml" id="A3.Ex12.m1.5.6.2.cmml" xref="A3.Ex12.m1.5.6.2">absent</csymbol><apply id="A3.Ex12.m1.5.6.3.cmml" xref="A3.Ex12.m1.5.6.3"><int id="A3.Ex12.m1.5.6.3.1.cmml" xref="A3.Ex12.m1.5.6.3.1"></int><apply id="A3.Ex12.m1.5.6.3.2.cmml" xref="A3.Ex12.m1.5.6.3.2"><times id="A3.Ex12.m1.5.6.3.2.1.cmml" xref="A3.Ex12.m1.5.6.3.2.1"></times><apply id="A3.Ex12.m1.5.6.3.2.2.cmml" xref="A3.Ex12.m1.5.6.3.2.2"><csymbol cd="latexml" id="A3.Ex12.m1.5.6.3.2.2.1.cmml" xref="A3.Ex12.m1.5.6.3.2.2.1">differential-d</csymbol><ci id="A3.Ex12.m1.5.6.3.2.2.2.cmml" xref="A3.Ex12.m1.5.6.3.2.2.2">𝜽</ci></apply><apply id="A3.Ex12.m1.5.6.3.2.3.cmml" xref="A3.Ex12.m1.5.6.3.2.3"><csymbol cd="ambiguous" id="A3.Ex12.m1.5.6.3.2.3.1.cmml" xref="A3.Ex12.m1.5.6.3.2.3">superscript</csymbol><ci id="A3.Ex12.m1.5.6.3.2.3.2.cmml" xref="A3.Ex12.m1.5.6.3.2.3.2">𝑠</ci><ci id="A3.Ex12.m1.1.1.1.1.cmml" xref="A3.Ex12.m1.1.1.1.1">𝑡</ci></apply><ci id="A3.Ex12.m1.3.3.cmml" xref="A3.Ex12.m1.3.3">𝜽</ci><apply id="A3.Ex12.m1.5.6.3.2.5.cmml" xref="A3.Ex12.m1.5.6.3.2.5"><log id="A3.Ex12.m1.5.6.3.2.5.1.cmml" xref="A3.Ex12.m1.5.6.3.2.5.1"></log><apply id="A3.Ex12.m1.5.6.3.2.5.2.cmml" xref="A3.Ex12.m1.5.6.3.2.5.2"><csymbol cd="ambiguous" id="A3.Ex12.m1.5.6.3.2.5.2.1.cmml" xref="A3.Ex12.m1.5.6.3.2.5.2">subscript</csymbol><ci id="A3.Ex12.m1.5.6.3.2.5.2.2.cmml" xref="A3.Ex12.m1.5.6.3.2.5.2.2">𝑠</ci><ci id="A3.Ex12.m1.5.6.3.2.5.2.3.cmml" xref="A3.Ex12.m1.5.6.3.2.5.2.3">𝑖</ci></apply></apply><ci id="A3.Ex12.m1.4.4.cmml" xref="A3.Ex12.m1.4.4">𝜽</ci><apply id="A3.Ex12.m1.5.6.3.2.7.cmml" xref="A3.Ex12.m1.5.6.3.2.7"><int id="A3.Ex12.m1.5.6.3.2.7.1.cmml" xref="A3.Ex12.m1.5.6.3.2.7.1"></int><apply id="A3.Ex12.m1.5.6.3.2.7.2.cmml" xref="A3.Ex12.m1.5.6.3.2.7.2"><times id="A3.Ex12.m1.5.6.3.2.7.2.1.cmml" xref="A3.Ex12.m1.5.6.3.2.7.2.1"></times><apply id="A3.Ex12.m1.5.6.3.2.7.2.2.cmml" xref="A3.Ex12.m1.5.6.3.2.7.2.2"><csymbol cd="latexml" id="A3.Ex12.m1.5.6.3.2.7.2.2.1.cmml" xref="A3.Ex12.m1.5.6.3.2.7.2.2.1">differential-d</csymbol><ci id="A3.Ex12.m1.5.6.3.2.7.2.2.2.cmml" xref="A3.Ex12.m1.5.6.3.2.7.2.2.2">bold-italic-ϕ</ci></apply><apply id="A3.Ex12.m1.5.6.3.2.7.2.3.cmml" xref="A3.Ex12.m1.5.6.3.2.7.2.3"><csymbol cd="ambiguous" id="A3.Ex12.m1.5.6.3.2.7.2.3.1.cmml" xref="A3.Ex12.m1.5.6.3.2.7.2.3">superscript</csymbol><ci id="A3.Ex12.m1.5.6.3.2.7.2.3.2.cmml" xref="A3.Ex12.m1.5.6.3.2.7.2.3.2">𝑐</ci><ci id="A3.Ex12.m1.2.2.1.1.cmml" xref="A3.Ex12.m1.2.2.1.1">𝑡</ci></apply><ci id="A3.Ex12.m1.5.5.cmml" xref="A3.Ex12.m1.5.5">bold-italic-ϕ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex12.m1.5c">\displaystyle=\int d\bm{\theta}\ s^{(t)}(\bm{\theta})\log s_{i}(\bm{\theta})\int d\bm{\phi}\ c^{(t)}(\bm{\phi})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.Ex13.m1.5" class="ltx_Math" alttext="\displaystyle\hskip 28.45274pt+\int d\bm{\theta}\ s^{(t)}(\bm{\theta})\int d\bm{\phi}\ c^{(t)}(\bm{\phi})\log c_{i}(\bm{\phi}_{i})" display="inline"><semantics id="A3.Ex13.m1.5a"><mrow id="A3.Ex13.m1.5.5" xref="A3.Ex13.m1.5.5.cmml"><mo id="A3.Ex13.m1.5.5a" xref="A3.Ex13.m1.5.5.cmml">+</mo><mstyle displaystyle="true" id="A3.Ex13.m1.5.5.1" xref="A3.Ex13.m1.5.5.1.cmml"><mrow id="A3.Ex13.m1.5.5.1a" xref="A3.Ex13.m1.5.5.1.cmml"><mo id="A3.Ex13.m1.5.5.1.2" xref="A3.Ex13.m1.5.5.1.2.cmml">∫</mo><mrow id="A3.Ex13.m1.5.5.1.1" xref="A3.Ex13.m1.5.5.1.1.cmml"><mrow id="A3.Ex13.m1.5.5.1.1.3" xref="A3.Ex13.m1.5.5.1.1.3.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.3.1" xref="A3.Ex13.m1.5.5.1.1.3.1.cmml">𝑑</mo><mi id="A3.Ex13.m1.5.5.1.1.3.2" xref="A3.Ex13.m1.5.5.1.1.3.2.cmml">𝜽</mi></mrow><mo lspace="0.500em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.2" xref="A3.Ex13.m1.5.5.1.1.2.cmml">​</mo><msup id="A3.Ex13.m1.5.5.1.1.4" xref="A3.Ex13.m1.5.5.1.1.4.cmml"><mi id="A3.Ex13.m1.5.5.1.1.4.2" xref="A3.Ex13.m1.5.5.1.1.4.2.cmml">s</mi><mrow id="A3.Ex13.m1.1.1.1.3" xref="A3.Ex13.m1.5.5.1.1.4.cmml"><mo stretchy="false" id="A3.Ex13.m1.1.1.1.3.1" xref="A3.Ex13.m1.5.5.1.1.4.cmml">(</mo><mi id="A3.Ex13.m1.1.1.1.1" xref="A3.Ex13.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex13.m1.1.1.1.3.2" xref="A3.Ex13.m1.5.5.1.1.4.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.2a" xref="A3.Ex13.m1.5.5.1.1.2.cmml">​</mo><mrow id="A3.Ex13.m1.5.5.1.1.5.2" xref="A3.Ex13.m1.5.5.1.1.cmml"><mo stretchy="false" id="A3.Ex13.m1.5.5.1.1.5.2.1" xref="A3.Ex13.m1.5.5.1.1.cmml">(</mo><mi id="A3.Ex13.m1.3.3" xref="A3.Ex13.m1.3.3.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex13.m1.5.5.1.1.5.2.2" xref="A3.Ex13.m1.5.5.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.2b" xref="A3.Ex13.m1.5.5.1.1.2.cmml">​</mo><mrow id="A3.Ex13.m1.5.5.1.1.1" xref="A3.Ex13.m1.5.5.1.1.1.cmml"><mo id="A3.Ex13.m1.5.5.1.1.1.2" xref="A3.Ex13.m1.5.5.1.1.1.2.cmml">∫</mo><mrow id="A3.Ex13.m1.5.5.1.1.1.1" xref="A3.Ex13.m1.5.5.1.1.1.1.cmml"><mrow id="A3.Ex13.m1.5.5.1.1.1.1.3" xref="A3.Ex13.m1.5.5.1.1.1.1.3.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.1.1.3.1" xref="A3.Ex13.m1.5.5.1.1.1.1.3.1.cmml">𝑑</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex13.m1.5.5.1.1.1.1.3.2" xref="A3.Ex13.m1.5.5.1.1.1.1.3.2.cmml">ϕ</mi></mrow><mo lspace="0.500em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.1.1.2" xref="A3.Ex13.m1.5.5.1.1.1.1.2.cmml">​</mo><msup id="A3.Ex13.m1.5.5.1.1.1.1.4" xref="A3.Ex13.m1.5.5.1.1.1.1.4.cmml"><mi id="A3.Ex13.m1.5.5.1.1.1.1.4.2" xref="A3.Ex13.m1.5.5.1.1.1.1.4.2.cmml">c</mi><mrow id="A3.Ex13.m1.2.2.1.3" xref="A3.Ex13.m1.5.5.1.1.1.1.4.cmml"><mo stretchy="false" id="A3.Ex13.m1.2.2.1.3.1" xref="A3.Ex13.m1.5.5.1.1.1.1.4.cmml">(</mo><mi id="A3.Ex13.m1.2.2.1.1" xref="A3.Ex13.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex13.m1.2.2.1.3.2" xref="A3.Ex13.m1.5.5.1.1.1.1.4.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.1.1.2a" xref="A3.Ex13.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="A3.Ex13.m1.5.5.1.1.1.1.5.2" xref="A3.Ex13.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="A3.Ex13.m1.5.5.1.1.1.1.5.2.1" xref="A3.Ex13.m1.5.5.1.1.1.1.cmml">(</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex13.m1.4.4" xref="A3.Ex13.m1.4.4.cmml">ϕ</mi><mo stretchy="false" id="A3.Ex13.m1.5.5.1.1.1.1.5.2.2" xref="A3.Ex13.m1.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.1.1.2b" xref="A3.Ex13.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="A3.Ex13.m1.5.5.1.1.1.1.6" xref="A3.Ex13.m1.5.5.1.1.1.1.6.cmml"><mi id="A3.Ex13.m1.5.5.1.1.1.1.6.1" xref="A3.Ex13.m1.5.5.1.1.1.1.6.1.cmml">log</mi><mo lspace="0.167em" id="A3.Ex13.m1.5.5.1.1.1.1.6a" xref="A3.Ex13.m1.5.5.1.1.1.1.6.cmml">⁡</mo><msub id="A3.Ex13.m1.5.5.1.1.1.1.6.2" xref="A3.Ex13.m1.5.5.1.1.1.1.6.2.cmml"><mi id="A3.Ex13.m1.5.5.1.1.1.1.6.2.2" xref="A3.Ex13.m1.5.5.1.1.1.1.6.2.2.cmml">c</mi><mi id="A3.Ex13.m1.5.5.1.1.1.1.6.2.3" xref="A3.Ex13.m1.5.5.1.1.1.1.6.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.Ex13.m1.5.5.1.1.1.1.2c" xref="A3.Ex13.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="A3.Ex13.m1.5.5.1.1.1.1.1.1" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.Ex13.m1.5.5.1.1.1.1.1.1.2" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex13.m1.5.5.1.1.1.1.1.1.1" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.2" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.3" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.Ex13.m1.5.5.1.1.1.1.1.1.3" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex13.m1.5b"><apply id="A3.Ex13.m1.5.5.cmml" xref="A3.Ex13.m1.5.5"><plus id="A3.Ex13.m1.5.5.2.cmml" xref="A3.Ex13.m1.5.5"></plus><apply id="A3.Ex13.m1.5.5.1.cmml" xref="A3.Ex13.m1.5.5.1"><int id="A3.Ex13.m1.5.5.1.2.cmml" xref="A3.Ex13.m1.5.5.1.2"></int><apply id="A3.Ex13.m1.5.5.1.1.cmml" xref="A3.Ex13.m1.5.5.1.1"><times id="A3.Ex13.m1.5.5.1.1.2.cmml" xref="A3.Ex13.m1.5.5.1.1.2"></times><apply id="A3.Ex13.m1.5.5.1.1.3.cmml" xref="A3.Ex13.m1.5.5.1.1.3"><csymbol cd="latexml" id="A3.Ex13.m1.5.5.1.1.3.1.cmml" xref="A3.Ex13.m1.5.5.1.1.3.1">differential-d</csymbol><ci id="A3.Ex13.m1.5.5.1.1.3.2.cmml" xref="A3.Ex13.m1.5.5.1.1.3.2">𝜽</ci></apply><apply id="A3.Ex13.m1.5.5.1.1.4.cmml" xref="A3.Ex13.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="A3.Ex13.m1.5.5.1.1.4.1.cmml" xref="A3.Ex13.m1.5.5.1.1.4">superscript</csymbol><ci id="A3.Ex13.m1.5.5.1.1.4.2.cmml" xref="A3.Ex13.m1.5.5.1.1.4.2">𝑠</ci><ci id="A3.Ex13.m1.1.1.1.1.cmml" xref="A3.Ex13.m1.1.1.1.1">𝑡</ci></apply><ci id="A3.Ex13.m1.3.3.cmml" xref="A3.Ex13.m1.3.3">𝜽</ci><apply id="A3.Ex13.m1.5.5.1.1.1.cmml" xref="A3.Ex13.m1.5.5.1.1.1"><int id="A3.Ex13.m1.5.5.1.1.1.2.cmml" xref="A3.Ex13.m1.5.5.1.1.1.2"></int><apply id="A3.Ex13.m1.5.5.1.1.1.1.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1"><times id="A3.Ex13.m1.5.5.1.1.1.1.2.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.2"></times><apply id="A3.Ex13.m1.5.5.1.1.1.1.3.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.3"><csymbol cd="latexml" id="A3.Ex13.m1.5.5.1.1.1.1.3.1.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.3.1">differential-d</csymbol><ci id="A3.Ex13.m1.5.5.1.1.1.1.3.2.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.3.2">bold-italic-ϕ</ci></apply><apply id="A3.Ex13.m1.5.5.1.1.1.1.4.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.4"><csymbol cd="ambiguous" id="A3.Ex13.m1.5.5.1.1.1.1.4.1.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.4">superscript</csymbol><ci id="A3.Ex13.m1.5.5.1.1.1.1.4.2.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.4.2">𝑐</ci><ci id="A3.Ex13.m1.2.2.1.1.cmml" xref="A3.Ex13.m1.2.2.1.1">𝑡</ci></apply><ci id="A3.Ex13.m1.4.4.cmml" xref="A3.Ex13.m1.4.4">bold-italic-ϕ</ci><apply id="A3.Ex13.m1.5.5.1.1.1.1.6.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.6"><log id="A3.Ex13.m1.5.5.1.1.1.1.6.1.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.6.1"></log><apply id="A3.Ex13.m1.5.5.1.1.1.1.6.2.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.6.2"><csymbol cd="ambiguous" id="A3.Ex13.m1.5.5.1.1.1.1.6.2.1.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.6.2">subscript</csymbol><ci id="A3.Ex13.m1.5.5.1.1.1.1.6.2.2.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.6.2.2">𝑐</ci><ci id="A3.Ex13.m1.5.5.1.1.1.1.6.2.3.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.6.2.3">𝑖</ci></apply></apply><apply id="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex13.m1.5.5.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex13.m1.5c">\displaystyle\hskip 28.45274pt+\int d\bm{\theta}\ s^{(t)}(\bm{\theta})\int d\bm{\phi}\ c^{(t)}(\bm{\phi})\log c_{i}(\bm{\phi}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.Ex14.m1.7" class="ltx_Math" alttext="\displaystyle\hskip 28.45274pt-\int d\bm{\theta}\ d\bm{\phi}\ s^{(t)}(\bm{\theta})c^{(t)}(\bm{\phi})\log\frac{p(\bm{\theta},\bm{\phi}_{i}|\mathcal{D}_{i})}{p(\bm{\theta})^{\frac{k-1}{k}}}" display="inline"><semantics id="A3.Ex14.m1.7a"><mrow id="A3.Ex14.m1.7.8" xref="A3.Ex14.m1.7.8.cmml"><mo id="A3.Ex14.m1.7.8a" xref="A3.Ex14.m1.7.8.cmml">−</mo><mstyle displaystyle="true" id="A3.Ex14.m1.7.8.2" xref="A3.Ex14.m1.7.8.2.cmml"><mrow id="A3.Ex14.m1.7.8.2a" xref="A3.Ex14.m1.7.8.2.cmml"><mo id="A3.Ex14.m1.7.8.2.1" xref="A3.Ex14.m1.7.8.2.1.cmml">∫</mo><mrow id="A3.Ex14.m1.7.8.2.2" xref="A3.Ex14.m1.7.8.2.2.cmml"><mrow id="A3.Ex14.m1.7.8.2.2.2" xref="A3.Ex14.m1.7.8.2.2.2.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex14.m1.7.8.2.2.2.1" xref="A3.Ex14.m1.7.8.2.2.2.1.cmml">𝑑</mo><mi id="A3.Ex14.m1.7.8.2.2.2.2" xref="A3.Ex14.m1.7.8.2.2.2.2.cmml">𝜽</mi></mrow><mo lspace="0.500em" rspace="0em" id="A3.Ex14.m1.7.8.2.2.1" xref="A3.Ex14.m1.7.8.2.2.1.cmml">​</mo><mrow id="A3.Ex14.m1.7.8.2.2.3" xref="A3.Ex14.m1.7.8.2.2.3.cmml"><mo rspace="0em" id="A3.Ex14.m1.7.8.2.2.3.1" xref="A3.Ex14.m1.7.8.2.2.3.1.cmml">𝑑</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex14.m1.7.8.2.2.3.2" xref="A3.Ex14.m1.7.8.2.2.3.2.cmml">ϕ</mi></mrow><mo lspace="0.500em" rspace="0em" id="A3.Ex14.m1.7.8.2.2.1a" xref="A3.Ex14.m1.7.8.2.2.1.cmml">​</mo><msup id="A3.Ex14.m1.7.8.2.2.4" xref="A3.Ex14.m1.7.8.2.2.4.cmml"><mi id="A3.Ex14.m1.7.8.2.2.4.2" xref="A3.Ex14.m1.7.8.2.2.4.2.cmml">s</mi><mrow id="A3.Ex14.m1.1.1.1.3" xref="A3.Ex14.m1.7.8.2.2.4.cmml"><mo stretchy="false" id="A3.Ex14.m1.1.1.1.3.1" xref="A3.Ex14.m1.7.8.2.2.4.cmml">(</mo><mi id="A3.Ex14.m1.1.1.1.1" xref="A3.Ex14.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex14.m1.1.1.1.3.2" xref="A3.Ex14.m1.7.8.2.2.4.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex14.m1.7.8.2.2.1b" xref="A3.Ex14.m1.7.8.2.2.1.cmml">​</mo><mrow id="A3.Ex14.m1.7.8.2.2.5.2" xref="A3.Ex14.m1.7.8.2.2.cmml"><mo stretchy="false" id="A3.Ex14.m1.7.8.2.2.5.2.1" xref="A3.Ex14.m1.7.8.2.2.cmml">(</mo><mi id="A3.Ex14.m1.6.6" xref="A3.Ex14.m1.6.6.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex14.m1.7.8.2.2.5.2.2" xref="A3.Ex14.m1.7.8.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex14.m1.7.8.2.2.1c" xref="A3.Ex14.m1.7.8.2.2.1.cmml">​</mo><msup id="A3.Ex14.m1.7.8.2.2.6" xref="A3.Ex14.m1.7.8.2.2.6.cmml"><mi id="A3.Ex14.m1.7.8.2.2.6.2" xref="A3.Ex14.m1.7.8.2.2.6.2.cmml">c</mi><mrow id="A3.Ex14.m1.2.2.1.3" xref="A3.Ex14.m1.7.8.2.2.6.cmml"><mo stretchy="false" id="A3.Ex14.m1.2.2.1.3.1" xref="A3.Ex14.m1.7.8.2.2.6.cmml">(</mo><mi id="A3.Ex14.m1.2.2.1.1" xref="A3.Ex14.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex14.m1.2.2.1.3.2" xref="A3.Ex14.m1.7.8.2.2.6.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex14.m1.7.8.2.2.1d" xref="A3.Ex14.m1.7.8.2.2.1.cmml">​</mo><mrow id="A3.Ex14.m1.7.8.2.2.7.2" xref="A3.Ex14.m1.7.8.2.2.cmml"><mo stretchy="false" id="A3.Ex14.m1.7.8.2.2.7.2.1" xref="A3.Ex14.m1.7.8.2.2.cmml">(</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex14.m1.7.7" xref="A3.Ex14.m1.7.7.cmml">ϕ</mi><mo stretchy="false" id="A3.Ex14.m1.7.8.2.2.7.2.2" xref="A3.Ex14.m1.7.8.2.2.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A3.Ex14.m1.7.8.2.2.1e" xref="A3.Ex14.m1.7.8.2.2.1.cmml">​</mo><mrow id="A3.Ex14.m1.7.8.2.2.8" xref="A3.Ex14.m1.7.8.2.2.8.cmml"><mi id="A3.Ex14.m1.7.8.2.2.8.1" xref="A3.Ex14.m1.7.8.2.2.8.1.cmml">log</mi><mo lspace="0.167em" id="A3.Ex14.m1.7.8.2.2.8a" xref="A3.Ex14.m1.7.8.2.2.8.cmml">⁡</mo><mfrac id="A3.Ex14.m1.5.5" xref="A3.Ex14.m1.5.5.cmml"><mrow id="A3.Ex14.m1.4.4.2" xref="A3.Ex14.m1.4.4.2.cmml"><mi id="A3.Ex14.m1.4.4.2.4" xref="A3.Ex14.m1.4.4.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.Ex14.m1.4.4.2.3" xref="A3.Ex14.m1.4.4.2.3.cmml">​</mo><mrow id="A3.Ex14.m1.4.4.2.2.1" xref="A3.Ex14.m1.4.4.2.2.2.cmml"><mo stretchy="false" id="A3.Ex14.m1.4.4.2.2.1.2" xref="A3.Ex14.m1.4.4.2.2.2.cmml">(</mo><mi id="A3.Ex14.m1.3.3.1.1" xref="A3.Ex14.m1.3.3.1.1.cmml">𝜽</mi><mo id="A3.Ex14.m1.4.4.2.2.1.3" xref="A3.Ex14.m1.4.4.2.2.2.cmml">,</mo><mrow id="A3.Ex14.m1.4.4.2.2.1.1" xref="A3.Ex14.m1.4.4.2.2.1.1.cmml"><msub id="A3.Ex14.m1.4.4.2.2.1.1.2" xref="A3.Ex14.m1.4.4.2.2.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex14.m1.4.4.2.2.1.1.2.2" xref="A3.Ex14.m1.4.4.2.2.1.1.2.2.cmml">ϕ</mi><mi id="A3.Ex14.m1.4.4.2.2.1.1.2.3" xref="A3.Ex14.m1.4.4.2.2.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="A3.Ex14.m1.4.4.2.2.1.1.1" xref="A3.Ex14.m1.4.4.2.2.1.1.1.cmml">|</mo><msub id="A3.Ex14.m1.4.4.2.2.1.1.3" xref="A3.Ex14.m1.4.4.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.Ex14.m1.4.4.2.2.1.1.3.2" xref="A3.Ex14.m1.4.4.2.2.1.1.3.2.cmml">𝒟</mi><mi id="A3.Ex14.m1.4.4.2.2.1.1.3.3" xref="A3.Ex14.m1.4.4.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A3.Ex14.m1.4.4.2.2.1.4" xref="A3.Ex14.m1.4.4.2.2.2.cmml">)</mo></mrow></mrow><mrow id="A3.Ex14.m1.5.5.3" xref="A3.Ex14.m1.5.5.3.cmml"><mi id="A3.Ex14.m1.5.5.3.3" xref="A3.Ex14.m1.5.5.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.Ex14.m1.5.5.3.2" xref="A3.Ex14.m1.5.5.3.2.cmml">​</mo><msup id="A3.Ex14.m1.5.5.3.4" xref="A3.Ex14.m1.5.5.3.4.cmml"><mrow id="A3.Ex14.m1.5.5.3.4.2.2" xref="A3.Ex14.m1.5.5.3.4.cmml"><mo stretchy="false" id="A3.Ex14.m1.5.5.3.4.2.2.1" xref="A3.Ex14.m1.5.5.3.4.cmml">(</mo><mi id="A3.Ex14.m1.5.5.3.1" xref="A3.Ex14.m1.5.5.3.1.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex14.m1.5.5.3.4.2.2.2" xref="A3.Ex14.m1.5.5.3.4.cmml">)</mo></mrow><mfrac id="A3.Ex14.m1.5.5.3.4.3" xref="A3.Ex14.m1.5.5.3.4.3.cmml"><mrow id="A3.Ex14.m1.5.5.3.4.3.2" xref="A3.Ex14.m1.5.5.3.4.3.2.cmml"><mi id="A3.Ex14.m1.5.5.3.4.3.2.2" xref="A3.Ex14.m1.5.5.3.4.3.2.2.cmml">k</mi><mo id="A3.Ex14.m1.5.5.3.4.3.2.1" xref="A3.Ex14.m1.5.5.3.4.3.2.1.cmml">−</mo><mn id="A3.Ex14.m1.5.5.3.4.3.2.3" xref="A3.Ex14.m1.5.5.3.4.3.2.3.cmml">1</mn></mrow><mi id="A3.Ex14.m1.5.5.3.4.3.3" xref="A3.Ex14.m1.5.5.3.4.3.3.cmml">k</mi></mfrac></msup></mrow></mfrac></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex14.m1.7b"><apply id="A3.Ex14.m1.7.8.cmml" xref="A3.Ex14.m1.7.8"><minus id="A3.Ex14.m1.7.8.1.cmml" xref="A3.Ex14.m1.7.8"></minus><apply id="A3.Ex14.m1.7.8.2.cmml" xref="A3.Ex14.m1.7.8.2"><int id="A3.Ex14.m1.7.8.2.1.cmml" xref="A3.Ex14.m1.7.8.2.1"></int><apply id="A3.Ex14.m1.7.8.2.2.cmml" xref="A3.Ex14.m1.7.8.2.2"><times id="A3.Ex14.m1.7.8.2.2.1.cmml" xref="A3.Ex14.m1.7.8.2.2.1"></times><apply id="A3.Ex14.m1.7.8.2.2.2.cmml" xref="A3.Ex14.m1.7.8.2.2.2"><csymbol cd="latexml" id="A3.Ex14.m1.7.8.2.2.2.1.cmml" xref="A3.Ex14.m1.7.8.2.2.2.1">differential-d</csymbol><ci id="A3.Ex14.m1.7.8.2.2.2.2.cmml" xref="A3.Ex14.m1.7.8.2.2.2.2">𝜽</ci></apply><apply id="A3.Ex14.m1.7.8.2.2.3.cmml" xref="A3.Ex14.m1.7.8.2.2.3"><csymbol cd="latexml" id="A3.Ex14.m1.7.8.2.2.3.1.cmml" xref="A3.Ex14.m1.7.8.2.2.3.1">differential-d</csymbol><ci id="A3.Ex14.m1.7.8.2.2.3.2.cmml" xref="A3.Ex14.m1.7.8.2.2.3.2">bold-italic-ϕ</ci></apply><apply id="A3.Ex14.m1.7.8.2.2.4.cmml" xref="A3.Ex14.m1.7.8.2.2.4"><csymbol cd="ambiguous" id="A3.Ex14.m1.7.8.2.2.4.1.cmml" xref="A3.Ex14.m1.7.8.2.2.4">superscript</csymbol><ci id="A3.Ex14.m1.7.8.2.2.4.2.cmml" xref="A3.Ex14.m1.7.8.2.2.4.2">𝑠</ci><ci id="A3.Ex14.m1.1.1.1.1.cmml" xref="A3.Ex14.m1.1.1.1.1">𝑡</ci></apply><ci id="A3.Ex14.m1.6.6.cmml" xref="A3.Ex14.m1.6.6">𝜽</ci><apply id="A3.Ex14.m1.7.8.2.2.6.cmml" xref="A3.Ex14.m1.7.8.2.2.6"><csymbol cd="ambiguous" id="A3.Ex14.m1.7.8.2.2.6.1.cmml" xref="A3.Ex14.m1.7.8.2.2.6">superscript</csymbol><ci id="A3.Ex14.m1.7.8.2.2.6.2.cmml" xref="A3.Ex14.m1.7.8.2.2.6.2">𝑐</ci><ci id="A3.Ex14.m1.2.2.1.1.cmml" xref="A3.Ex14.m1.2.2.1.1">𝑡</ci></apply><ci id="A3.Ex14.m1.7.7.cmml" xref="A3.Ex14.m1.7.7">bold-italic-ϕ</ci><apply id="A3.Ex14.m1.7.8.2.2.8.cmml" xref="A3.Ex14.m1.7.8.2.2.8"><log id="A3.Ex14.m1.7.8.2.2.8.1.cmml" xref="A3.Ex14.m1.7.8.2.2.8.1"></log><apply id="A3.Ex14.m1.5.5.cmml" xref="A3.Ex14.m1.5.5"><divide id="A3.Ex14.m1.5.5.4.cmml" xref="A3.Ex14.m1.5.5"></divide><apply id="A3.Ex14.m1.4.4.2.cmml" xref="A3.Ex14.m1.4.4.2"><times id="A3.Ex14.m1.4.4.2.3.cmml" xref="A3.Ex14.m1.4.4.2.3"></times><ci id="A3.Ex14.m1.4.4.2.4.cmml" xref="A3.Ex14.m1.4.4.2.4">𝑝</ci><interval closure="open" id="A3.Ex14.m1.4.4.2.2.2.cmml" xref="A3.Ex14.m1.4.4.2.2.1"><ci id="A3.Ex14.m1.3.3.1.1.cmml" xref="A3.Ex14.m1.3.3.1.1">𝜽</ci><apply id="A3.Ex14.m1.4.4.2.2.1.1.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="A3.Ex14.m1.4.4.2.2.1.1.1.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.1">conditional</csymbol><apply id="A3.Ex14.m1.4.4.2.2.1.1.2.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.2"><csymbol cd="ambiguous" id="A3.Ex14.m1.4.4.2.2.1.1.2.1.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.2">subscript</csymbol><ci id="A3.Ex14.m1.4.4.2.2.1.1.2.2.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.2.2">bold-italic-ϕ</ci><ci id="A3.Ex14.m1.4.4.2.2.1.1.2.3.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.2.3">𝑖</ci></apply><apply id="A3.Ex14.m1.4.4.2.2.1.1.3.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.Ex14.m1.4.4.2.2.1.1.3.1.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.3">subscript</csymbol><ci id="A3.Ex14.m1.4.4.2.2.1.1.3.2.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.3.2">𝒟</ci><ci id="A3.Ex14.m1.4.4.2.2.1.1.3.3.cmml" xref="A3.Ex14.m1.4.4.2.2.1.1.3.3">𝑖</ci></apply></apply></interval></apply><apply id="A3.Ex14.m1.5.5.3.cmml" xref="A3.Ex14.m1.5.5.3"><times id="A3.Ex14.m1.5.5.3.2.cmml" xref="A3.Ex14.m1.5.5.3.2"></times><ci id="A3.Ex14.m1.5.5.3.3.cmml" xref="A3.Ex14.m1.5.5.3.3">𝑝</ci><apply id="A3.Ex14.m1.5.5.3.4.cmml" xref="A3.Ex14.m1.5.5.3.4"><csymbol cd="ambiguous" id="A3.Ex14.m1.5.5.3.4.1.cmml" xref="A3.Ex14.m1.5.5.3.4">superscript</csymbol><ci id="A3.Ex14.m1.5.5.3.1.cmml" xref="A3.Ex14.m1.5.5.3.1">𝜽</ci><apply id="A3.Ex14.m1.5.5.3.4.3.cmml" xref="A3.Ex14.m1.5.5.3.4.3"><divide id="A3.Ex14.m1.5.5.3.4.3.1.cmml" xref="A3.Ex14.m1.5.5.3.4.3"></divide><apply id="A3.Ex14.m1.5.5.3.4.3.2.cmml" xref="A3.Ex14.m1.5.5.3.4.3.2"><minus id="A3.Ex14.m1.5.5.3.4.3.2.1.cmml" xref="A3.Ex14.m1.5.5.3.4.3.2.1"></minus><ci id="A3.Ex14.m1.5.5.3.4.3.2.2.cmml" xref="A3.Ex14.m1.5.5.3.4.3.2.2">𝑘</ci><cn type="integer" id="A3.Ex14.m1.5.5.3.4.3.2.3.cmml" xref="A3.Ex14.m1.5.5.3.4.3.2.3">1</cn></apply><ci id="A3.Ex14.m1.5.5.3.4.3.3.cmml" xref="A3.Ex14.m1.5.5.3.4.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex14.m1.7c">\displaystyle\hskip 28.45274pt-\int d\bm{\theta}\ d\bm{\phi}\ s^{(t)}(\bm{\theta})c^{(t)}(\bm{\phi})\log\frac{p(\bm{\theta},\bm{\phi}_{i}|\mathcal{D}_{i})}{p(\bm{\theta})^{\frac{k-1}{k}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.Ex15.m1.8" class="ltx_Math" alttext="\displaystyle=\int d\bm{\theta}\ s^{(t)}(\bm{\theta})\log\frac{s_{i}(\bm{\theta})s^{(t)}(\bm{\theta})}{s^{(t)}(\bm{\theta})p(\bm{\theta})^{\frac{1}{K}}}" display="inline"><semantics id="A3.Ex15.m1.8a"><mrow id="A3.Ex15.m1.8.9" xref="A3.Ex15.m1.8.9.cmml"><mi id="A3.Ex15.m1.8.9.2" xref="A3.Ex15.m1.8.9.2.cmml"></mi><mo id="A3.Ex15.m1.8.9.1" xref="A3.Ex15.m1.8.9.1.cmml">=</mo><mstyle displaystyle="true" id="A3.Ex15.m1.8.9.3" xref="A3.Ex15.m1.8.9.3.cmml"><mrow id="A3.Ex15.m1.8.9.3a" xref="A3.Ex15.m1.8.9.3.cmml"><mo id="A3.Ex15.m1.8.9.3.1" xref="A3.Ex15.m1.8.9.3.1.cmml">∫</mo><mrow id="A3.Ex15.m1.8.9.3.2" xref="A3.Ex15.m1.8.9.3.2.cmml"><mrow id="A3.Ex15.m1.8.9.3.2.2" xref="A3.Ex15.m1.8.9.3.2.2.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex15.m1.8.9.3.2.2.1" xref="A3.Ex15.m1.8.9.3.2.2.1.cmml">𝑑</mo><mi id="A3.Ex15.m1.8.9.3.2.2.2" xref="A3.Ex15.m1.8.9.3.2.2.2.cmml">𝜽</mi></mrow><mo lspace="0.500em" rspace="0em" id="A3.Ex15.m1.8.9.3.2.1" xref="A3.Ex15.m1.8.9.3.2.1.cmml">​</mo><msup id="A3.Ex15.m1.8.9.3.2.3" xref="A3.Ex15.m1.8.9.3.2.3.cmml"><mi id="A3.Ex15.m1.8.9.3.2.3.2" xref="A3.Ex15.m1.8.9.3.2.3.2.cmml">s</mi><mrow id="A3.Ex15.m1.1.1.1.3" xref="A3.Ex15.m1.8.9.3.2.3.cmml"><mo stretchy="false" id="A3.Ex15.m1.1.1.1.3.1" xref="A3.Ex15.m1.8.9.3.2.3.cmml">(</mo><mi id="A3.Ex15.m1.1.1.1.1" xref="A3.Ex15.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex15.m1.1.1.1.3.2" xref="A3.Ex15.m1.8.9.3.2.3.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex15.m1.8.9.3.2.1a" xref="A3.Ex15.m1.8.9.3.2.1.cmml">​</mo><mrow id="A3.Ex15.m1.8.9.3.2.4.2" xref="A3.Ex15.m1.8.9.3.2.cmml"><mo stretchy="false" id="A3.Ex15.m1.8.9.3.2.4.2.1" xref="A3.Ex15.m1.8.9.3.2.cmml">(</mo><mi id="A3.Ex15.m1.8.8" xref="A3.Ex15.m1.8.8.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex15.m1.8.9.3.2.4.2.2" xref="A3.Ex15.m1.8.9.3.2.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A3.Ex15.m1.8.9.3.2.1b" xref="A3.Ex15.m1.8.9.3.2.1.cmml">​</mo><mrow id="A3.Ex15.m1.8.9.3.2.5" xref="A3.Ex15.m1.8.9.3.2.5.cmml"><mi id="A3.Ex15.m1.8.9.3.2.5.1" xref="A3.Ex15.m1.8.9.3.2.5.1.cmml">log</mi><mo lspace="0.167em" id="A3.Ex15.m1.8.9.3.2.5a" xref="A3.Ex15.m1.8.9.3.2.5.cmml">⁡</mo><mfrac id="A3.Ex15.m1.7.7" xref="A3.Ex15.m1.7.7.cmml"><mrow id="A3.Ex15.m1.4.4.3" xref="A3.Ex15.m1.4.4.3.cmml"><msub id="A3.Ex15.m1.4.4.3.5" xref="A3.Ex15.m1.4.4.3.5.cmml"><mi id="A3.Ex15.m1.4.4.3.5.2" xref="A3.Ex15.m1.4.4.3.5.2.cmml">s</mi><mi id="A3.Ex15.m1.4.4.3.5.3" xref="A3.Ex15.m1.4.4.3.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.Ex15.m1.4.4.3.4" xref="A3.Ex15.m1.4.4.3.4.cmml">​</mo><mrow id="A3.Ex15.m1.4.4.3.6.2" xref="A3.Ex15.m1.4.4.3.cmml"><mo stretchy="false" id="A3.Ex15.m1.4.4.3.6.2.1" xref="A3.Ex15.m1.4.4.3.cmml">(</mo><mi id="A3.Ex15.m1.3.3.2.2" xref="A3.Ex15.m1.3.3.2.2.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex15.m1.4.4.3.6.2.2" xref="A3.Ex15.m1.4.4.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex15.m1.4.4.3.4a" xref="A3.Ex15.m1.4.4.3.4.cmml">​</mo><msup id="A3.Ex15.m1.4.4.3.7" xref="A3.Ex15.m1.4.4.3.7.cmml"><mi id="A3.Ex15.m1.4.4.3.7.2" xref="A3.Ex15.m1.4.4.3.7.2.cmml">s</mi><mrow id="A3.Ex15.m1.2.2.1.1.1.3" xref="A3.Ex15.m1.4.4.3.7.cmml"><mo stretchy="false" id="A3.Ex15.m1.2.2.1.1.1.3.1" xref="A3.Ex15.m1.4.4.3.7.cmml">(</mo><mi id="A3.Ex15.m1.2.2.1.1.1.1" xref="A3.Ex15.m1.2.2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex15.m1.2.2.1.1.1.3.2" xref="A3.Ex15.m1.4.4.3.7.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex15.m1.4.4.3.4b" xref="A3.Ex15.m1.4.4.3.4.cmml">​</mo><mrow id="A3.Ex15.m1.4.4.3.8.2" xref="A3.Ex15.m1.4.4.3.cmml"><mo stretchy="false" id="A3.Ex15.m1.4.4.3.8.2.1" xref="A3.Ex15.m1.4.4.3.cmml">(</mo><mi id="A3.Ex15.m1.4.4.3.3" xref="A3.Ex15.m1.4.4.3.3.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex15.m1.4.4.3.8.2.2" xref="A3.Ex15.m1.4.4.3.cmml">)</mo></mrow></mrow><mrow id="A3.Ex15.m1.7.7.6" xref="A3.Ex15.m1.7.7.6.cmml"><msup id="A3.Ex15.m1.7.7.6.5" xref="A3.Ex15.m1.7.7.6.5.cmml"><mi id="A3.Ex15.m1.7.7.6.5.2" xref="A3.Ex15.m1.7.7.6.5.2.cmml">s</mi><mrow id="A3.Ex15.m1.5.5.4.1.1.3" xref="A3.Ex15.m1.7.7.6.5.cmml"><mo stretchy="false" id="A3.Ex15.m1.5.5.4.1.1.3.1" xref="A3.Ex15.m1.7.7.6.5.cmml">(</mo><mi id="A3.Ex15.m1.5.5.4.1.1.1" xref="A3.Ex15.m1.5.5.4.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex15.m1.5.5.4.1.1.3.2" xref="A3.Ex15.m1.7.7.6.5.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex15.m1.7.7.6.4" xref="A3.Ex15.m1.7.7.6.4.cmml">​</mo><mrow id="A3.Ex15.m1.7.7.6.6.2" xref="A3.Ex15.m1.7.7.6.cmml"><mo stretchy="false" id="A3.Ex15.m1.7.7.6.6.2.1" xref="A3.Ex15.m1.7.7.6.cmml">(</mo><mi id="A3.Ex15.m1.6.6.5.2" xref="A3.Ex15.m1.6.6.5.2.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex15.m1.7.7.6.6.2.2" xref="A3.Ex15.m1.7.7.6.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex15.m1.7.7.6.4a" xref="A3.Ex15.m1.7.7.6.4.cmml">​</mo><mi id="A3.Ex15.m1.7.7.6.7" xref="A3.Ex15.m1.7.7.6.7.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.Ex15.m1.7.7.6.4b" xref="A3.Ex15.m1.7.7.6.4.cmml">​</mo><msup id="A3.Ex15.m1.7.7.6.8" xref="A3.Ex15.m1.7.7.6.8.cmml"><mrow id="A3.Ex15.m1.7.7.6.8.2.2" xref="A3.Ex15.m1.7.7.6.8.cmml"><mo stretchy="false" id="A3.Ex15.m1.7.7.6.8.2.2.1" xref="A3.Ex15.m1.7.7.6.8.cmml">(</mo><mi id="A3.Ex15.m1.7.7.6.3" xref="A3.Ex15.m1.7.7.6.3.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex15.m1.7.7.6.8.2.2.2" xref="A3.Ex15.m1.7.7.6.8.cmml">)</mo></mrow><mfrac id="A3.Ex15.m1.7.7.6.8.3" xref="A3.Ex15.m1.7.7.6.8.3.cmml"><mn id="A3.Ex15.m1.7.7.6.8.3.2" xref="A3.Ex15.m1.7.7.6.8.3.2.cmml">1</mn><mi id="A3.Ex15.m1.7.7.6.8.3.3" xref="A3.Ex15.m1.7.7.6.8.3.3.cmml">K</mi></mfrac></msup></mrow></mfrac></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex15.m1.8b"><apply id="A3.Ex15.m1.8.9.cmml" xref="A3.Ex15.m1.8.9"><eq id="A3.Ex15.m1.8.9.1.cmml" xref="A3.Ex15.m1.8.9.1"></eq><csymbol cd="latexml" id="A3.Ex15.m1.8.9.2.cmml" xref="A3.Ex15.m1.8.9.2">absent</csymbol><apply id="A3.Ex15.m1.8.9.3.cmml" xref="A3.Ex15.m1.8.9.3"><int id="A3.Ex15.m1.8.9.3.1.cmml" xref="A3.Ex15.m1.8.9.3.1"></int><apply id="A3.Ex15.m1.8.9.3.2.cmml" xref="A3.Ex15.m1.8.9.3.2"><times id="A3.Ex15.m1.8.9.3.2.1.cmml" xref="A3.Ex15.m1.8.9.3.2.1"></times><apply id="A3.Ex15.m1.8.9.3.2.2.cmml" xref="A3.Ex15.m1.8.9.3.2.2"><csymbol cd="latexml" id="A3.Ex15.m1.8.9.3.2.2.1.cmml" xref="A3.Ex15.m1.8.9.3.2.2.1">differential-d</csymbol><ci id="A3.Ex15.m1.8.9.3.2.2.2.cmml" xref="A3.Ex15.m1.8.9.3.2.2.2">𝜽</ci></apply><apply id="A3.Ex15.m1.8.9.3.2.3.cmml" xref="A3.Ex15.m1.8.9.3.2.3"><csymbol cd="ambiguous" id="A3.Ex15.m1.8.9.3.2.3.1.cmml" xref="A3.Ex15.m1.8.9.3.2.3">superscript</csymbol><ci id="A3.Ex15.m1.8.9.3.2.3.2.cmml" xref="A3.Ex15.m1.8.9.3.2.3.2">𝑠</ci><ci id="A3.Ex15.m1.1.1.1.1.cmml" xref="A3.Ex15.m1.1.1.1.1">𝑡</ci></apply><ci id="A3.Ex15.m1.8.8.cmml" xref="A3.Ex15.m1.8.8">𝜽</ci><apply id="A3.Ex15.m1.8.9.3.2.5.cmml" xref="A3.Ex15.m1.8.9.3.2.5"><log id="A3.Ex15.m1.8.9.3.2.5.1.cmml" xref="A3.Ex15.m1.8.9.3.2.5.1"></log><apply id="A3.Ex15.m1.7.7.cmml" xref="A3.Ex15.m1.7.7"><divide id="A3.Ex15.m1.7.7.7.cmml" xref="A3.Ex15.m1.7.7"></divide><apply id="A3.Ex15.m1.4.4.3.cmml" xref="A3.Ex15.m1.4.4.3"><times id="A3.Ex15.m1.4.4.3.4.cmml" xref="A3.Ex15.m1.4.4.3.4"></times><apply id="A3.Ex15.m1.4.4.3.5.cmml" xref="A3.Ex15.m1.4.4.3.5"><csymbol cd="ambiguous" id="A3.Ex15.m1.4.4.3.5.1.cmml" xref="A3.Ex15.m1.4.4.3.5">subscript</csymbol><ci id="A3.Ex15.m1.4.4.3.5.2.cmml" xref="A3.Ex15.m1.4.4.3.5.2">𝑠</ci><ci id="A3.Ex15.m1.4.4.3.5.3.cmml" xref="A3.Ex15.m1.4.4.3.5.3">𝑖</ci></apply><ci id="A3.Ex15.m1.3.3.2.2.cmml" xref="A3.Ex15.m1.3.3.2.2">𝜽</ci><apply id="A3.Ex15.m1.4.4.3.7.cmml" xref="A3.Ex15.m1.4.4.3.7"><csymbol cd="ambiguous" id="A3.Ex15.m1.4.4.3.7.1.cmml" xref="A3.Ex15.m1.4.4.3.7">superscript</csymbol><ci id="A3.Ex15.m1.4.4.3.7.2.cmml" xref="A3.Ex15.m1.4.4.3.7.2">𝑠</ci><ci id="A3.Ex15.m1.2.2.1.1.1.1.cmml" xref="A3.Ex15.m1.2.2.1.1.1.1">𝑡</ci></apply><ci id="A3.Ex15.m1.4.4.3.3.cmml" xref="A3.Ex15.m1.4.4.3.3">𝜽</ci></apply><apply id="A3.Ex15.m1.7.7.6.cmml" xref="A3.Ex15.m1.7.7.6"><times id="A3.Ex15.m1.7.7.6.4.cmml" xref="A3.Ex15.m1.7.7.6.4"></times><apply id="A3.Ex15.m1.7.7.6.5.cmml" xref="A3.Ex15.m1.7.7.6.5"><csymbol cd="ambiguous" id="A3.Ex15.m1.7.7.6.5.1.cmml" xref="A3.Ex15.m1.7.7.6.5">superscript</csymbol><ci id="A3.Ex15.m1.7.7.6.5.2.cmml" xref="A3.Ex15.m1.7.7.6.5.2">𝑠</ci><ci id="A3.Ex15.m1.5.5.4.1.1.1.cmml" xref="A3.Ex15.m1.5.5.4.1.1.1">𝑡</ci></apply><ci id="A3.Ex15.m1.6.6.5.2.cmml" xref="A3.Ex15.m1.6.6.5.2">𝜽</ci><ci id="A3.Ex15.m1.7.7.6.7.cmml" xref="A3.Ex15.m1.7.7.6.7">𝑝</ci><apply id="A3.Ex15.m1.7.7.6.8.cmml" xref="A3.Ex15.m1.7.7.6.8"><csymbol cd="ambiguous" id="A3.Ex15.m1.7.7.6.8.1.cmml" xref="A3.Ex15.m1.7.7.6.8">superscript</csymbol><ci id="A3.Ex15.m1.7.7.6.3.cmml" xref="A3.Ex15.m1.7.7.6.3">𝜽</ci><apply id="A3.Ex15.m1.7.7.6.8.3.cmml" xref="A3.Ex15.m1.7.7.6.8.3"><divide id="A3.Ex15.m1.7.7.6.8.3.1.cmml" xref="A3.Ex15.m1.7.7.6.8.3"></divide><cn type="integer" id="A3.Ex15.m1.7.7.6.8.3.2.cmml" xref="A3.Ex15.m1.7.7.6.8.3.2">1</cn><ci id="A3.Ex15.m1.7.7.6.8.3.3.cmml" xref="A3.Ex15.m1.7.7.6.8.3.3">𝐾</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex15.m1.8c">\displaystyle=\int d\bm{\theta}\ s^{(t)}(\bm{\theta})\log\frac{s_{i}(\bm{\theta})s^{(t)}(\bm{\theta})}{s^{(t)}(\bm{\theta})p(\bm{\theta})^{\frac{1}{K}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.Ex16.m1.5" class="ltx_Math" alttext="\displaystyle\hskip 8.5359pt+\int d\bm{\phi}_{i}\ c^{(t)}_{i}(\bm{\phi}_{i})\log\frac{c_{i}^{(t)}(\bm{\phi}_{i})}{p(\bm{\phi}_{i})}+" display="inline"><semantics id="A3.Ex16.m1.5a"><mrow id="A3.Ex16.m1.5.5" xref="A3.Ex16.m1.5.5.cmml"><mrow id="A3.Ex16.m1.5.5.1" xref="A3.Ex16.m1.5.5.1.cmml"><mo id="A3.Ex16.m1.5.5.1a" xref="A3.Ex16.m1.5.5.1.cmml">+</mo><mstyle displaystyle="true" id="A3.Ex16.m1.5.5.1.1" xref="A3.Ex16.m1.5.5.1.1.cmml"><mrow id="A3.Ex16.m1.5.5.1.1a" xref="A3.Ex16.m1.5.5.1.1.cmml"><mo id="A3.Ex16.m1.5.5.1.1.2" xref="A3.Ex16.m1.5.5.1.1.2.cmml">∫</mo><mrow id="A3.Ex16.m1.5.5.1.1.1" xref="A3.Ex16.m1.5.5.1.1.1.cmml"><mrow id="A3.Ex16.m1.5.5.1.1.1.3" xref="A3.Ex16.m1.5.5.1.1.1.3.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex16.m1.5.5.1.1.1.3.1" xref="A3.Ex16.m1.5.5.1.1.1.3.1.cmml">𝑑</mo><msub id="A3.Ex16.m1.5.5.1.1.1.3.2" xref="A3.Ex16.m1.5.5.1.1.1.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex16.m1.5.5.1.1.1.3.2.2" xref="A3.Ex16.m1.5.5.1.1.1.3.2.2.cmml">ϕ</mi><mi id="A3.Ex16.m1.5.5.1.1.1.3.2.3" xref="A3.Ex16.m1.5.5.1.1.1.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.Ex16.m1.5.5.1.1.1.2" xref="A3.Ex16.m1.5.5.1.1.1.2.cmml">​</mo><msubsup id="A3.Ex16.m1.5.5.1.1.1.4" xref="A3.Ex16.m1.5.5.1.1.1.4.cmml"><mi id="A3.Ex16.m1.5.5.1.1.1.4.2.2" xref="A3.Ex16.m1.5.5.1.1.1.4.2.2.cmml">c</mi><mi id="A3.Ex16.m1.5.5.1.1.1.4.3" xref="A3.Ex16.m1.5.5.1.1.1.4.3.cmml">i</mi><mrow id="A3.Ex16.m1.1.1.1.3" xref="A3.Ex16.m1.5.5.1.1.1.4.cmml"><mo stretchy="false" id="A3.Ex16.m1.1.1.1.3.1" xref="A3.Ex16.m1.5.5.1.1.1.4.cmml">(</mo><mi id="A3.Ex16.m1.1.1.1.1" xref="A3.Ex16.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex16.m1.1.1.1.3.2" xref="A3.Ex16.m1.5.5.1.1.1.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A3.Ex16.m1.5.5.1.1.1.2a" xref="A3.Ex16.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="A3.Ex16.m1.5.5.1.1.1.1.1" xref="A3.Ex16.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.Ex16.m1.5.5.1.1.1.1.1.2" xref="A3.Ex16.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex16.m1.5.5.1.1.1.1.1.1" xref="A3.Ex16.m1.5.5.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex16.m1.5.5.1.1.1.1.1.1.2" xref="A3.Ex16.m1.5.5.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="A3.Ex16.m1.5.5.1.1.1.1.1.1.3" xref="A3.Ex16.m1.5.5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.Ex16.m1.5.5.1.1.1.1.1.3" xref="A3.Ex16.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A3.Ex16.m1.5.5.1.1.1.2b" xref="A3.Ex16.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="A3.Ex16.m1.5.5.1.1.1.5" xref="A3.Ex16.m1.5.5.1.1.1.5.cmml"><mi id="A3.Ex16.m1.5.5.1.1.1.5.1" xref="A3.Ex16.m1.5.5.1.1.1.5.1.cmml">log</mi><mo lspace="0.167em" id="A3.Ex16.m1.5.5.1.1.1.5a" xref="A3.Ex16.m1.5.5.1.1.1.5.cmml">⁡</mo><mfrac id="A3.Ex16.m1.4.4" xref="A3.Ex16.m1.4.4.cmml"><mrow id="A3.Ex16.m1.3.3.2" xref="A3.Ex16.m1.3.3.2.cmml"><msubsup id="A3.Ex16.m1.3.3.2.4" xref="A3.Ex16.m1.3.3.2.4.cmml"><mi id="A3.Ex16.m1.3.3.2.4.2.2" xref="A3.Ex16.m1.3.3.2.4.2.2.cmml">c</mi><mi id="A3.Ex16.m1.3.3.2.4.2.3" xref="A3.Ex16.m1.3.3.2.4.2.3.cmml">i</mi><mrow id="A3.Ex16.m1.2.2.1.1.1.3" xref="A3.Ex16.m1.3.3.2.4.cmml"><mo stretchy="false" id="A3.Ex16.m1.2.2.1.1.1.3.1" xref="A3.Ex16.m1.3.3.2.4.cmml">(</mo><mi id="A3.Ex16.m1.2.2.1.1.1.1" xref="A3.Ex16.m1.2.2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex16.m1.2.2.1.1.1.3.2" xref="A3.Ex16.m1.3.3.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A3.Ex16.m1.3.3.2.3" xref="A3.Ex16.m1.3.3.2.3.cmml">​</mo><mrow id="A3.Ex16.m1.3.3.2.2.1" xref="A3.Ex16.m1.3.3.2.2.1.1.cmml"><mo stretchy="false" id="A3.Ex16.m1.3.3.2.2.1.2" xref="A3.Ex16.m1.3.3.2.2.1.1.cmml">(</mo><msub id="A3.Ex16.m1.3.3.2.2.1.1" xref="A3.Ex16.m1.3.3.2.2.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex16.m1.3.3.2.2.1.1.2" xref="A3.Ex16.m1.3.3.2.2.1.1.2.cmml">ϕ</mi><mi id="A3.Ex16.m1.3.3.2.2.1.1.3" xref="A3.Ex16.m1.3.3.2.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.Ex16.m1.3.3.2.2.1.3" xref="A3.Ex16.m1.3.3.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A3.Ex16.m1.4.4.3" xref="A3.Ex16.m1.4.4.3.cmml"><mi id="A3.Ex16.m1.4.4.3.3" xref="A3.Ex16.m1.4.4.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.Ex16.m1.4.4.3.2" xref="A3.Ex16.m1.4.4.3.2.cmml">​</mo><mrow id="A3.Ex16.m1.4.4.3.1.1" xref="A3.Ex16.m1.4.4.3.1.1.1.cmml"><mo stretchy="false" id="A3.Ex16.m1.4.4.3.1.1.2" xref="A3.Ex16.m1.4.4.3.1.1.1.cmml">(</mo><msub id="A3.Ex16.m1.4.4.3.1.1.1" xref="A3.Ex16.m1.4.4.3.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex16.m1.4.4.3.1.1.1.2" xref="A3.Ex16.m1.4.4.3.1.1.1.2.cmml">ϕ</mi><mi id="A3.Ex16.m1.4.4.3.1.1.1.3" xref="A3.Ex16.m1.4.4.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.Ex16.m1.4.4.3.1.1.3" xref="A3.Ex16.m1.4.4.3.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow></mstyle></mrow><mo id="A3.Ex16.m1.5.5.3" xref="A3.Ex16.m1.5.5.3.cmml">+</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex16.m1.5b"><apply id="A3.Ex16.m1.5.5.cmml" xref="A3.Ex16.m1.5.5"><csymbol cd="latexml" id="A3.Ex16.m1.5.5.2.cmml" xref="A3.Ex16.m1.5.5">limit-from</csymbol><apply id="A3.Ex16.m1.5.5.1.cmml" xref="A3.Ex16.m1.5.5.1"><plus id="A3.Ex16.m1.5.5.1.2.cmml" xref="A3.Ex16.m1.5.5.1"></plus><apply id="A3.Ex16.m1.5.5.1.1.cmml" xref="A3.Ex16.m1.5.5.1.1"><int id="A3.Ex16.m1.5.5.1.1.2.cmml" xref="A3.Ex16.m1.5.5.1.1.2"></int><apply id="A3.Ex16.m1.5.5.1.1.1.cmml" xref="A3.Ex16.m1.5.5.1.1.1"><times id="A3.Ex16.m1.5.5.1.1.1.2.cmml" xref="A3.Ex16.m1.5.5.1.1.1.2"></times><apply id="A3.Ex16.m1.5.5.1.1.1.3.cmml" xref="A3.Ex16.m1.5.5.1.1.1.3"><csymbol cd="latexml" id="A3.Ex16.m1.5.5.1.1.1.3.1.cmml" xref="A3.Ex16.m1.5.5.1.1.1.3.1">differential-d</csymbol><apply id="A3.Ex16.m1.5.5.1.1.1.3.2.cmml" xref="A3.Ex16.m1.5.5.1.1.1.3.2"><csymbol cd="ambiguous" id="A3.Ex16.m1.5.5.1.1.1.3.2.1.cmml" xref="A3.Ex16.m1.5.5.1.1.1.3.2">subscript</csymbol><ci id="A3.Ex16.m1.5.5.1.1.1.3.2.2.cmml" xref="A3.Ex16.m1.5.5.1.1.1.3.2.2">bold-italic-ϕ</ci><ci id="A3.Ex16.m1.5.5.1.1.1.3.2.3.cmml" xref="A3.Ex16.m1.5.5.1.1.1.3.2.3">𝑖</ci></apply></apply><apply id="A3.Ex16.m1.5.5.1.1.1.4.cmml" xref="A3.Ex16.m1.5.5.1.1.1.4"><csymbol cd="ambiguous" id="A3.Ex16.m1.5.5.1.1.1.4.1.cmml" xref="A3.Ex16.m1.5.5.1.1.1.4">subscript</csymbol><apply id="A3.Ex16.m1.5.5.1.1.1.4.2.cmml" xref="A3.Ex16.m1.5.5.1.1.1.4"><csymbol cd="ambiguous" id="A3.Ex16.m1.5.5.1.1.1.4.2.1.cmml" xref="A3.Ex16.m1.5.5.1.1.1.4">superscript</csymbol><ci id="A3.Ex16.m1.5.5.1.1.1.4.2.2.cmml" xref="A3.Ex16.m1.5.5.1.1.1.4.2.2">𝑐</ci><ci id="A3.Ex16.m1.1.1.1.1.cmml" xref="A3.Ex16.m1.1.1.1.1">𝑡</ci></apply><ci id="A3.Ex16.m1.5.5.1.1.1.4.3.cmml" xref="A3.Ex16.m1.5.5.1.1.1.4.3">𝑖</ci></apply><apply id="A3.Ex16.m1.5.5.1.1.1.1.1.1.cmml" xref="A3.Ex16.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex16.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A3.Ex16.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex16.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A3.Ex16.m1.5.5.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.Ex16.m1.5.5.1.1.1.1.1.1.3.cmml" xref="A3.Ex16.m1.5.5.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A3.Ex16.m1.5.5.1.1.1.5.cmml" xref="A3.Ex16.m1.5.5.1.1.1.5"><log id="A3.Ex16.m1.5.5.1.1.1.5.1.cmml" xref="A3.Ex16.m1.5.5.1.1.1.5.1"></log><apply id="A3.Ex16.m1.4.4.cmml" xref="A3.Ex16.m1.4.4"><divide id="A3.Ex16.m1.4.4.4.cmml" xref="A3.Ex16.m1.4.4"></divide><apply id="A3.Ex16.m1.3.3.2.cmml" xref="A3.Ex16.m1.3.3.2"><times id="A3.Ex16.m1.3.3.2.3.cmml" xref="A3.Ex16.m1.3.3.2.3"></times><apply id="A3.Ex16.m1.3.3.2.4.cmml" xref="A3.Ex16.m1.3.3.2.4"><csymbol cd="ambiguous" id="A3.Ex16.m1.3.3.2.4.1.cmml" xref="A3.Ex16.m1.3.3.2.4">superscript</csymbol><apply id="A3.Ex16.m1.3.3.2.4.2.cmml" xref="A3.Ex16.m1.3.3.2.4"><csymbol cd="ambiguous" id="A3.Ex16.m1.3.3.2.4.2.1.cmml" xref="A3.Ex16.m1.3.3.2.4">subscript</csymbol><ci id="A3.Ex16.m1.3.3.2.4.2.2.cmml" xref="A3.Ex16.m1.3.3.2.4.2.2">𝑐</ci><ci id="A3.Ex16.m1.3.3.2.4.2.3.cmml" xref="A3.Ex16.m1.3.3.2.4.2.3">𝑖</ci></apply><ci id="A3.Ex16.m1.2.2.1.1.1.1.cmml" xref="A3.Ex16.m1.2.2.1.1.1.1">𝑡</ci></apply><apply id="A3.Ex16.m1.3.3.2.2.1.1.cmml" xref="A3.Ex16.m1.3.3.2.2.1"><csymbol cd="ambiguous" id="A3.Ex16.m1.3.3.2.2.1.1.1.cmml" xref="A3.Ex16.m1.3.3.2.2.1">subscript</csymbol><ci id="A3.Ex16.m1.3.3.2.2.1.1.2.cmml" xref="A3.Ex16.m1.3.3.2.2.1.1.2">bold-italic-ϕ</ci><ci id="A3.Ex16.m1.3.3.2.2.1.1.3.cmml" xref="A3.Ex16.m1.3.3.2.2.1.1.3">𝑖</ci></apply></apply><apply id="A3.Ex16.m1.4.4.3.cmml" xref="A3.Ex16.m1.4.4.3"><times id="A3.Ex16.m1.4.4.3.2.cmml" xref="A3.Ex16.m1.4.4.3.2"></times><ci id="A3.Ex16.m1.4.4.3.3.cmml" xref="A3.Ex16.m1.4.4.3.3">𝑝</ci><apply id="A3.Ex16.m1.4.4.3.1.1.1.cmml" xref="A3.Ex16.m1.4.4.3.1.1"><csymbol cd="ambiguous" id="A3.Ex16.m1.4.4.3.1.1.1.1.cmml" xref="A3.Ex16.m1.4.4.3.1.1">subscript</csymbol><ci id="A3.Ex16.m1.4.4.3.1.1.1.2.cmml" xref="A3.Ex16.m1.4.4.3.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.Ex16.m1.4.4.3.1.1.1.3.cmml" xref="A3.Ex16.m1.4.4.3.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply><plus id="A3.Ex16.m1.5.5.3.cmml" xref="A3.Ex16.m1.5.5.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex16.m1.5c">\displaystyle\hskip 8.5359pt+\int d\bm{\phi}_{i}\ c^{(t)}_{i}(\bm{\phi}_{i})\log\frac{c_{i}^{(t)}(\bm{\phi}_{i})}{p(\bm{\phi}_{i})}+</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A3.Ex17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A3.Ex17.m1.6" class="ltx_Math" alttext="\displaystyle\hskip 8.5359pt-\int d\bm{\theta}\ s^{(t)}(\bm{\theta})\int d\bm{\phi}_{i}\ c^{(t)}_{i}(\bm{\phi}_{i})\log p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi}_{i})" display="inline"><semantics id="A3.Ex17.m1.6a"><mrow id="A3.Ex17.m1.6.6" xref="A3.Ex17.m1.6.6.cmml"><mo id="A3.Ex17.m1.6.6a" xref="A3.Ex17.m1.6.6.cmml">−</mo><mstyle displaystyle="true" id="A3.Ex17.m1.6.6.2" xref="A3.Ex17.m1.6.6.2.cmml"><mrow id="A3.Ex17.m1.6.6.2a" xref="A3.Ex17.m1.6.6.2.cmml"><mo id="A3.Ex17.m1.6.6.2.3" xref="A3.Ex17.m1.6.6.2.3.cmml">∫</mo><mrow id="A3.Ex17.m1.6.6.2.2" xref="A3.Ex17.m1.6.6.2.2.cmml"><mrow id="A3.Ex17.m1.6.6.2.2.4" xref="A3.Ex17.m1.6.6.2.2.4.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.4.1" xref="A3.Ex17.m1.6.6.2.2.4.1.cmml">𝑑</mo><mi id="A3.Ex17.m1.6.6.2.2.4.2" xref="A3.Ex17.m1.6.6.2.2.4.2.cmml">𝜽</mi></mrow><mo lspace="0.500em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.3" xref="A3.Ex17.m1.6.6.2.2.3.cmml">​</mo><msup id="A3.Ex17.m1.6.6.2.2.5" xref="A3.Ex17.m1.6.6.2.2.5.cmml"><mi id="A3.Ex17.m1.6.6.2.2.5.2" xref="A3.Ex17.m1.6.6.2.2.5.2.cmml">s</mi><mrow id="A3.Ex17.m1.1.1.1.3" xref="A3.Ex17.m1.6.6.2.2.5.cmml"><mo stretchy="false" id="A3.Ex17.m1.1.1.1.3.1" xref="A3.Ex17.m1.6.6.2.2.5.cmml">(</mo><mi id="A3.Ex17.m1.1.1.1.1" xref="A3.Ex17.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex17.m1.1.1.1.3.2" xref="A3.Ex17.m1.6.6.2.2.5.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.3a" xref="A3.Ex17.m1.6.6.2.2.3.cmml">​</mo><mrow id="A3.Ex17.m1.6.6.2.2.6.2" xref="A3.Ex17.m1.6.6.2.2.cmml"><mo stretchy="false" id="A3.Ex17.m1.6.6.2.2.6.2.1" xref="A3.Ex17.m1.6.6.2.2.cmml">(</mo><mi id="A3.Ex17.m1.3.3" xref="A3.Ex17.m1.3.3.cmml">𝜽</mi><mo stretchy="false" id="A3.Ex17.m1.6.6.2.2.6.2.2" xref="A3.Ex17.m1.6.6.2.2.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.3b" xref="A3.Ex17.m1.6.6.2.2.3.cmml">​</mo><mrow id="A3.Ex17.m1.6.6.2.2.2" xref="A3.Ex17.m1.6.6.2.2.2.cmml"><mo id="A3.Ex17.m1.6.6.2.2.2.3" xref="A3.Ex17.m1.6.6.2.2.2.3.cmml">∫</mo><mrow id="A3.Ex17.m1.6.6.2.2.2.2" xref="A3.Ex17.m1.6.6.2.2.2.2.cmml"><mrow id="A3.Ex17.m1.6.6.2.2.2.2.4" xref="A3.Ex17.m1.6.6.2.2.2.2.4.cmml"><mo lspace="0em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.2.2.4.1" xref="A3.Ex17.m1.6.6.2.2.2.2.4.1.cmml">𝑑</mo><msub id="A3.Ex17.m1.6.6.2.2.2.2.4.2" xref="A3.Ex17.m1.6.6.2.2.2.2.4.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex17.m1.6.6.2.2.2.2.4.2.2" xref="A3.Ex17.m1.6.6.2.2.2.2.4.2.2.cmml">ϕ</mi><mi id="A3.Ex17.m1.6.6.2.2.2.2.4.2.3" xref="A3.Ex17.m1.6.6.2.2.2.2.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.2.2.3" xref="A3.Ex17.m1.6.6.2.2.2.2.3.cmml">​</mo><msubsup id="A3.Ex17.m1.6.6.2.2.2.2.5" xref="A3.Ex17.m1.6.6.2.2.2.2.5.cmml"><mi id="A3.Ex17.m1.6.6.2.2.2.2.5.2.2" xref="A3.Ex17.m1.6.6.2.2.2.2.5.2.2.cmml">c</mi><mi id="A3.Ex17.m1.6.6.2.2.2.2.5.3" xref="A3.Ex17.m1.6.6.2.2.2.2.5.3.cmml">i</mi><mrow id="A3.Ex17.m1.2.2.1.3" xref="A3.Ex17.m1.6.6.2.2.2.2.5.cmml"><mo stretchy="false" id="A3.Ex17.m1.2.2.1.3.1" xref="A3.Ex17.m1.6.6.2.2.2.2.5.cmml">(</mo><mi id="A3.Ex17.m1.2.2.1.1" xref="A3.Ex17.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="A3.Ex17.m1.2.2.1.3.2" xref="A3.Ex17.m1.6.6.2.2.2.2.5.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.2.2.3a" xref="A3.Ex17.m1.6.6.2.2.2.2.3.cmml">​</mo><mrow id="A3.Ex17.m1.5.5.1.1.1.1.1.1" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.Ex17.m1.5.5.1.1.1.1.1.1.2" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.Ex17.m1.5.5.1.1.1.1.1.1.1" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.2" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.3" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.Ex17.m1.5.5.1.1.1.1.1.1.3" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.2.2.3b" xref="A3.Ex17.m1.6.6.2.2.2.2.3.cmml">​</mo><mrow id="A3.Ex17.m1.6.6.2.2.2.2.6" xref="A3.Ex17.m1.6.6.2.2.2.2.6.cmml"><mi id="A3.Ex17.m1.6.6.2.2.2.2.6.1" xref="A3.Ex17.m1.6.6.2.2.2.2.6.1.cmml">log</mi><mo lspace="0.167em" id="A3.Ex17.m1.6.6.2.2.2.2.6a" xref="A3.Ex17.m1.6.6.2.2.2.2.6.cmml">⁡</mo><mi id="A3.Ex17.m1.6.6.2.2.2.2.6.2" xref="A3.Ex17.m1.6.6.2.2.2.2.6.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="A3.Ex17.m1.6.6.2.2.2.2.3c" xref="A3.Ex17.m1.6.6.2.2.2.2.3.cmml">​</mo><mrow id="A3.Ex17.m1.6.6.2.2.2.2.2.1" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A3.Ex17.m1.6.6.2.2.2.2.2.1.2" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.cmml">(</mo><mrow id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.cmml"><msub id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.2" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.2.cmml">𝒟</mi><mi id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.3" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.2" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.2.cmml">|</mo><mrow id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.2.cmml"><mi id="A3.Ex17.m1.4.4" xref="A3.Ex17.m1.4.4.cmml">𝜽</mi><mo id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.2" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.2.cmml">,</mo><msub id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.2" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.2.cmml">ϕ</mi><mi id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.3" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="A3.Ex17.m1.6.6.2.2.2.2.2.1.3" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="A3.Ex17.m1.6b"><apply id="A3.Ex17.m1.6.6.cmml" xref="A3.Ex17.m1.6.6"><minus id="A3.Ex17.m1.6.6.3.cmml" xref="A3.Ex17.m1.6.6"></minus><apply id="A3.Ex17.m1.6.6.2.cmml" xref="A3.Ex17.m1.6.6.2"><int id="A3.Ex17.m1.6.6.2.3.cmml" xref="A3.Ex17.m1.6.6.2.3"></int><apply id="A3.Ex17.m1.6.6.2.2.cmml" xref="A3.Ex17.m1.6.6.2.2"><times id="A3.Ex17.m1.6.6.2.2.3.cmml" xref="A3.Ex17.m1.6.6.2.2.3"></times><apply id="A3.Ex17.m1.6.6.2.2.4.cmml" xref="A3.Ex17.m1.6.6.2.2.4"><csymbol cd="latexml" id="A3.Ex17.m1.6.6.2.2.4.1.cmml" xref="A3.Ex17.m1.6.6.2.2.4.1">differential-d</csymbol><ci id="A3.Ex17.m1.6.6.2.2.4.2.cmml" xref="A3.Ex17.m1.6.6.2.2.4.2">𝜽</ci></apply><apply id="A3.Ex17.m1.6.6.2.2.5.cmml" xref="A3.Ex17.m1.6.6.2.2.5"><csymbol cd="ambiguous" id="A3.Ex17.m1.6.6.2.2.5.1.cmml" xref="A3.Ex17.m1.6.6.2.2.5">superscript</csymbol><ci id="A3.Ex17.m1.6.6.2.2.5.2.cmml" xref="A3.Ex17.m1.6.6.2.2.5.2">𝑠</ci><ci id="A3.Ex17.m1.1.1.1.1.cmml" xref="A3.Ex17.m1.1.1.1.1">𝑡</ci></apply><ci id="A3.Ex17.m1.3.3.cmml" xref="A3.Ex17.m1.3.3">𝜽</ci><apply id="A3.Ex17.m1.6.6.2.2.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2"><int id="A3.Ex17.m1.6.6.2.2.2.3.cmml" xref="A3.Ex17.m1.6.6.2.2.2.3"></int><apply id="A3.Ex17.m1.6.6.2.2.2.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2"><times id="A3.Ex17.m1.6.6.2.2.2.2.3.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.3"></times><apply id="A3.Ex17.m1.6.6.2.2.2.2.4.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.4"><csymbol cd="latexml" id="A3.Ex17.m1.6.6.2.2.2.2.4.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.4.1">differential-d</csymbol><apply id="A3.Ex17.m1.6.6.2.2.2.2.4.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.4.2"><csymbol cd="ambiguous" id="A3.Ex17.m1.6.6.2.2.2.2.4.2.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.4.2">subscript</csymbol><ci id="A3.Ex17.m1.6.6.2.2.2.2.4.2.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.4.2.2">bold-italic-ϕ</ci><ci id="A3.Ex17.m1.6.6.2.2.2.2.4.2.3.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.4.2.3">𝑖</ci></apply></apply><apply id="A3.Ex17.m1.6.6.2.2.2.2.5.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.5"><csymbol cd="ambiguous" id="A3.Ex17.m1.6.6.2.2.2.2.5.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.5">subscript</csymbol><apply id="A3.Ex17.m1.6.6.2.2.2.2.5.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.5"><csymbol cd="ambiguous" id="A3.Ex17.m1.6.6.2.2.2.2.5.2.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.5">superscript</csymbol><ci id="A3.Ex17.m1.6.6.2.2.2.2.5.2.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.5.2.2">𝑐</ci><ci id="A3.Ex17.m1.2.2.1.1.cmml" xref="A3.Ex17.m1.2.2.1.1">𝑡</ci></apply><ci id="A3.Ex17.m1.6.6.2.2.2.2.5.3.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.5.3">𝑖</ci></apply><apply id="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="A3.Ex17.m1.5.5.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A3.Ex17.m1.6.6.2.2.2.2.6.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.6"><log id="A3.Ex17.m1.6.6.2.2.2.2.6.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.6.1"></log><ci id="A3.Ex17.m1.6.6.2.2.2.2.6.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.6.2">𝑝</ci></apply><apply id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1"><csymbol cd="latexml" id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.2">conditional</csymbol><apply id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.2">𝒟</ci><ci id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.3.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.3.3">𝑖</ci></apply><list id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1"><ci id="A3.Ex17.m1.4.4.cmml" xref="A3.Ex17.m1.4.4">𝜽</ci><apply id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.3.cmml" xref="A3.Ex17.m1.6.6.2.2.2.2.2.1.1.1.1.1.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.Ex17.m1.6c">\displaystyle\hskip 8.5359pt-\int d\bm{\theta}\ s^{(t)}(\bm{\theta})\int d\bm{\phi}_{i}\ c^{(t)}_{i}(\bm{\phi}_{i})\log p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A3.1.p1.7" class="ltx_p">where the second equality comes from the normalization of client and server pdfs and from Bayes rule <math id="A3.1.p1.6.m1.6" class="ltx_Math" alttext="p(\bm{\theta},\bm{\phi}_{i}|\mathcal{D}_{i})\propto p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi}_{i})p(\bm{\phi}_{i})p(\bm{\theta})" display="inline"><semantics id="A3.1.p1.6.m1.6a"><mrow id="A3.1.p1.6.m1.6.6" xref="A3.1.p1.6.m1.6.6.cmml"><mrow id="A3.1.p1.6.m1.4.4.1" xref="A3.1.p1.6.m1.4.4.1.cmml"><mi id="A3.1.p1.6.m1.4.4.1.3" xref="A3.1.p1.6.m1.4.4.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.1.p1.6.m1.4.4.1.2" xref="A3.1.p1.6.m1.4.4.1.2.cmml">​</mo><mrow id="A3.1.p1.6.m1.4.4.1.1.1" xref="A3.1.p1.6.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="A3.1.p1.6.m1.4.4.1.1.1.2" xref="A3.1.p1.6.m1.4.4.1.1.2.cmml">(</mo><mi id="A3.1.p1.6.m1.1.1" xref="A3.1.p1.6.m1.1.1.cmml">𝜽</mi><mo id="A3.1.p1.6.m1.4.4.1.1.1.3" xref="A3.1.p1.6.m1.4.4.1.1.2.cmml">,</mo><mrow id="A3.1.p1.6.m1.4.4.1.1.1.1" xref="A3.1.p1.6.m1.4.4.1.1.1.1.cmml"><msub id="A3.1.p1.6.m1.4.4.1.1.1.1.2" xref="A3.1.p1.6.m1.4.4.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.1.p1.6.m1.4.4.1.1.1.1.2.2" xref="A3.1.p1.6.m1.4.4.1.1.1.1.2.2.cmml">ϕ</mi><mi id="A3.1.p1.6.m1.4.4.1.1.1.1.2.3" xref="A3.1.p1.6.m1.4.4.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="A3.1.p1.6.m1.4.4.1.1.1.1.1" xref="A3.1.p1.6.m1.4.4.1.1.1.1.1.cmml">|</mo><msub id="A3.1.p1.6.m1.4.4.1.1.1.1.3" xref="A3.1.p1.6.m1.4.4.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.1.p1.6.m1.4.4.1.1.1.1.3.2" xref="A3.1.p1.6.m1.4.4.1.1.1.1.3.2.cmml">𝒟</mi><mi id="A3.1.p1.6.m1.4.4.1.1.1.1.3.3" xref="A3.1.p1.6.m1.4.4.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A3.1.p1.6.m1.4.4.1.1.1.4" xref="A3.1.p1.6.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="A3.1.p1.6.m1.6.6.4" xref="A3.1.p1.6.m1.6.6.4.cmml">∝</mo><mrow id="A3.1.p1.6.m1.6.6.3" xref="A3.1.p1.6.m1.6.6.3.cmml"><mi id="A3.1.p1.6.m1.6.6.3.4" xref="A3.1.p1.6.m1.6.6.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.1.p1.6.m1.6.6.3.3" xref="A3.1.p1.6.m1.6.6.3.3.cmml">​</mo><mrow id="A3.1.p1.6.m1.5.5.2.1.1" xref="A3.1.p1.6.m1.5.5.2.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.6.m1.5.5.2.1.1.2" xref="A3.1.p1.6.m1.5.5.2.1.1.1.cmml">(</mo><mrow id="A3.1.p1.6.m1.5.5.2.1.1.1" xref="A3.1.p1.6.m1.5.5.2.1.1.1.cmml"><msub id="A3.1.p1.6.m1.5.5.2.1.1.1.3" xref="A3.1.p1.6.m1.5.5.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A3.1.p1.6.m1.5.5.2.1.1.1.3.2" xref="A3.1.p1.6.m1.5.5.2.1.1.1.3.2.cmml">𝒟</mi><mi id="A3.1.p1.6.m1.5.5.2.1.1.1.3.3" xref="A3.1.p1.6.m1.5.5.2.1.1.1.3.3.cmml">i</mi></msub><mo fence="false" id="A3.1.p1.6.m1.5.5.2.1.1.1.2" xref="A3.1.p1.6.m1.5.5.2.1.1.1.2.cmml">|</mo><mrow id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.2.cmml"><mi id="A3.1.p1.6.m1.2.2" xref="A3.1.p1.6.m1.2.2.cmml">𝜽</mi><mo id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.2" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.2.cmml">,</mo><msub id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.2" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.3" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="A3.1.p1.6.m1.5.5.2.1.1.3" xref="A3.1.p1.6.m1.5.5.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.1.p1.6.m1.6.6.3.3a" xref="A3.1.p1.6.m1.6.6.3.3.cmml">​</mo><mi id="A3.1.p1.6.m1.6.6.3.5" xref="A3.1.p1.6.m1.6.6.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.1.p1.6.m1.6.6.3.3b" xref="A3.1.p1.6.m1.6.6.3.3.cmml">​</mo><mrow id="A3.1.p1.6.m1.6.6.3.2.1" xref="A3.1.p1.6.m1.6.6.3.2.1.1.cmml"><mo stretchy="false" id="A3.1.p1.6.m1.6.6.3.2.1.2" xref="A3.1.p1.6.m1.6.6.3.2.1.1.cmml">(</mo><msub id="A3.1.p1.6.m1.6.6.3.2.1.1" xref="A3.1.p1.6.m1.6.6.3.2.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A3.1.p1.6.m1.6.6.3.2.1.1.2" xref="A3.1.p1.6.m1.6.6.3.2.1.1.2.cmml">ϕ</mi><mi id="A3.1.p1.6.m1.6.6.3.2.1.1.3" xref="A3.1.p1.6.m1.6.6.3.2.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.1.p1.6.m1.6.6.3.2.1.3" xref="A3.1.p1.6.m1.6.6.3.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A3.1.p1.6.m1.6.6.3.3c" xref="A3.1.p1.6.m1.6.6.3.3.cmml">​</mo><mi id="A3.1.p1.6.m1.6.6.3.6" xref="A3.1.p1.6.m1.6.6.3.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.1.p1.6.m1.6.6.3.3d" xref="A3.1.p1.6.m1.6.6.3.3.cmml">​</mo><mrow id="A3.1.p1.6.m1.6.6.3.7.2" xref="A3.1.p1.6.m1.6.6.3.cmml"><mo stretchy="false" id="A3.1.p1.6.m1.6.6.3.7.2.1" xref="A3.1.p1.6.m1.6.6.3.cmml">(</mo><mi id="A3.1.p1.6.m1.3.3" xref="A3.1.p1.6.m1.3.3.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.6.m1.6.6.3.7.2.2" xref="A3.1.p1.6.m1.6.6.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.6.m1.6b"><apply id="A3.1.p1.6.m1.6.6.cmml" xref="A3.1.p1.6.m1.6.6"><csymbol cd="latexml" id="A3.1.p1.6.m1.6.6.4.cmml" xref="A3.1.p1.6.m1.6.6.4">proportional-to</csymbol><apply id="A3.1.p1.6.m1.4.4.1.cmml" xref="A3.1.p1.6.m1.4.4.1"><times id="A3.1.p1.6.m1.4.4.1.2.cmml" xref="A3.1.p1.6.m1.4.4.1.2"></times><ci id="A3.1.p1.6.m1.4.4.1.3.cmml" xref="A3.1.p1.6.m1.4.4.1.3">𝑝</ci><interval closure="open" id="A3.1.p1.6.m1.4.4.1.1.2.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1"><ci id="A3.1.p1.6.m1.1.1.cmml" xref="A3.1.p1.6.m1.1.1">𝜽</ci><apply id="A3.1.p1.6.m1.4.4.1.1.1.1.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1"><csymbol cd="latexml" id="A3.1.p1.6.m1.4.4.1.1.1.1.1.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.1">conditional</csymbol><apply id="A3.1.p1.6.m1.4.4.1.1.1.1.2.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.1.p1.6.m1.4.4.1.1.1.1.2.1.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="A3.1.p1.6.m1.4.4.1.1.1.1.2.2.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="A3.1.p1.6.m1.4.4.1.1.1.1.2.3.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.2.3">𝑖</ci></apply><apply id="A3.1.p1.6.m1.4.4.1.1.1.1.3.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.1.p1.6.m1.4.4.1.1.1.1.3.1.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="A3.1.p1.6.m1.4.4.1.1.1.1.3.2.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.3.2">𝒟</ci><ci id="A3.1.p1.6.m1.4.4.1.1.1.1.3.3.cmml" xref="A3.1.p1.6.m1.4.4.1.1.1.1.3.3">𝑖</ci></apply></apply></interval></apply><apply id="A3.1.p1.6.m1.6.6.3.cmml" xref="A3.1.p1.6.m1.6.6.3"><times id="A3.1.p1.6.m1.6.6.3.3.cmml" xref="A3.1.p1.6.m1.6.6.3.3"></times><ci id="A3.1.p1.6.m1.6.6.3.4.cmml" xref="A3.1.p1.6.m1.6.6.3.4">𝑝</ci><apply id="A3.1.p1.6.m1.5.5.2.1.1.1.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1"><csymbol cd="latexml" id="A3.1.p1.6.m1.5.5.2.1.1.1.2.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.2">conditional</csymbol><apply id="A3.1.p1.6.m1.5.5.2.1.1.1.3.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="A3.1.p1.6.m1.5.5.2.1.1.1.3.1.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.3">subscript</csymbol><ci id="A3.1.p1.6.m1.5.5.2.1.1.1.3.2.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.3.2">𝒟</ci><ci id="A3.1.p1.6.m1.5.5.2.1.1.1.3.3.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.3.3">𝑖</ci></apply><list id="A3.1.p1.6.m1.5.5.2.1.1.1.1.2.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.1"><ci id="A3.1.p1.6.m1.2.2.cmml" xref="A3.1.p1.6.m1.2.2">𝜽</ci><apply id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1">subscript</csymbol><ci id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.2.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.3.cmml" xref="A3.1.p1.6.m1.5.5.2.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><ci id="A3.1.p1.6.m1.6.6.3.5.cmml" xref="A3.1.p1.6.m1.6.6.3.5">𝑝</ci><apply id="A3.1.p1.6.m1.6.6.3.2.1.1.cmml" xref="A3.1.p1.6.m1.6.6.3.2.1"><csymbol cd="ambiguous" id="A3.1.p1.6.m1.6.6.3.2.1.1.1.cmml" xref="A3.1.p1.6.m1.6.6.3.2.1">subscript</csymbol><ci id="A3.1.p1.6.m1.6.6.3.2.1.1.2.cmml" xref="A3.1.p1.6.m1.6.6.3.2.1.1.2">bold-italic-ϕ</ci><ci id="A3.1.p1.6.m1.6.6.3.2.1.1.3.cmml" xref="A3.1.p1.6.m1.6.6.3.2.1.1.3">𝑖</ci></apply><ci id="A3.1.p1.6.m1.6.6.3.6.cmml" xref="A3.1.p1.6.m1.6.6.3.6">𝑝</ci><ci id="A3.1.p1.6.m1.3.3.cmml" xref="A3.1.p1.6.m1.3.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.6.m1.6c">p(\bm{\theta},\bm{\phi}_{i}|\mathcal{D}_{i})\propto p(\mathcal{D}_{i}|\bm{\theta},\bm{\phi}_{i})p(\bm{\phi}_{i})p(\bm{\theta})</annotation></semantics></math>. Notice also that <math id="A3.1.p1.7.m2.7" class="ltx_Math" alttext="\frac{s_{i}(\bm{\theta})}{s^{(t)}(\bm{\theta})}=\frac{s_{i}^{(t-1)}(\bm{\theta})}{s^{(t-1)}(\bm{\theta})}" display="inline"><semantics id="A3.1.p1.7.m2.7a"><mrow id="A3.1.p1.7.m2.7.8" xref="A3.1.p1.7.m2.7.8.cmml"><mfrac id="A3.1.p1.7.m2.3.3" xref="A3.1.p1.7.m2.3.3.cmml"><mrow id="A3.1.p1.7.m2.1.1.1" xref="A3.1.p1.7.m2.1.1.1.cmml"><msub id="A3.1.p1.7.m2.1.1.1.3" xref="A3.1.p1.7.m2.1.1.1.3.cmml"><mi id="A3.1.p1.7.m2.1.1.1.3.2" xref="A3.1.p1.7.m2.1.1.1.3.2.cmml">s</mi><mi id="A3.1.p1.7.m2.1.1.1.3.3" xref="A3.1.p1.7.m2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A3.1.p1.7.m2.1.1.1.2" xref="A3.1.p1.7.m2.1.1.1.2.cmml">​</mo><mrow id="A3.1.p1.7.m2.1.1.1.4.2" xref="A3.1.p1.7.m2.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.7.m2.1.1.1.4.2.1" xref="A3.1.p1.7.m2.1.1.1.cmml">(</mo><mi id="A3.1.p1.7.m2.1.1.1.1" xref="A3.1.p1.7.m2.1.1.1.1.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.7.m2.1.1.1.4.2.2" xref="A3.1.p1.7.m2.1.1.1.cmml">)</mo></mrow></mrow><mrow id="A3.1.p1.7.m2.3.3.3" xref="A3.1.p1.7.m2.3.3.3.cmml"><msup id="A3.1.p1.7.m2.3.3.3.4" xref="A3.1.p1.7.m2.3.3.3.4.cmml"><mi id="A3.1.p1.7.m2.3.3.3.4.2" xref="A3.1.p1.7.m2.3.3.3.4.2.cmml">s</mi><mrow id="A3.1.p1.7.m2.2.2.2.1.1.3" xref="A3.1.p1.7.m2.3.3.3.4.cmml"><mo stretchy="false" id="A3.1.p1.7.m2.2.2.2.1.1.3.1" xref="A3.1.p1.7.m2.3.3.3.4.cmml">(</mo><mi id="A3.1.p1.7.m2.2.2.2.1.1.1" xref="A3.1.p1.7.m2.2.2.2.1.1.1.cmml">t</mi><mo stretchy="false" id="A3.1.p1.7.m2.2.2.2.1.1.3.2" xref="A3.1.p1.7.m2.3.3.3.4.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.1.p1.7.m2.3.3.3.3" xref="A3.1.p1.7.m2.3.3.3.3.cmml">​</mo><mrow id="A3.1.p1.7.m2.3.3.3.5.2" xref="A3.1.p1.7.m2.3.3.3.cmml"><mo stretchy="false" id="A3.1.p1.7.m2.3.3.3.5.2.1" xref="A3.1.p1.7.m2.3.3.3.cmml">(</mo><mi id="A3.1.p1.7.m2.3.3.3.2" xref="A3.1.p1.7.m2.3.3.3.2.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.7.m2.3.3.3.5.2.2" xref="A3.1.p1.7.m2.3.3.3.cmml">)</mo></mrow></mrow></mfrac><mo id="A3.1.p1.7.m2.7.8.1" xref="A3.1.p1.7.m2.7.8.1.cmml">=</mo><mfrac id="A3.1.p1.7.m2.7.7" xref="A3.1.p1.7.m2.7.7.cmml"><mrow id="A3.1.p1.7.m2.5.5.2" xref="A3.1.p1.7.m2.5.5.2.cmml"><msubsup id="A3.1.p1.7.m2.5.5.2.4" xref="A3.1.p1.7.m2.5.5.2.4.cmml"><mi id="A3.1.p1.7.m2.5.5.2.4.2.2" xref="A3.1.p1.7.m2.5.5.2.4.2.2.cmml">s</mi><mi id="A3.1.p1.7.m2.5.5.2.4.2.3" xref="A3.1.p1.7.m2.5.5.2.4.2.3.cmml">i</mi><mrow id="A3.1.p1.7.m2.4.4.1.1.1.1" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.7.m2.4.4.1.1.1.1.2" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.cmml">(</mo><mrow id="A3.1.p1.7.m2.4.4.1.1.1.1.1" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.cmml"><mi id="A3.1.p1.7.m2.4.4.1.1.1.1.1.2" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.2.cmml">t</mi><mo id="A3.1.p1.7.m2.4.4.1.1.1.1.1.1" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.1.cmml">−</mo><mn id="A3.1.p1.7.m2.4.4.1.1.1.1.1.3" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A3.1.p1.7.m2.4.4.1.1.1.1.3" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="A3.1.p1.7.m2.5.5.2.3" xref="A3.1.p1.7.m2.5.5.2.3.cmml">​</mo><mrow id="A3.1.p1.7.m2.5.5.2.5.2" xref="A3.1.p1.7.m2.5.5.2.cmml"><mo stretchy="false" id="A3.1.p1.7.m2.5.5.2.5.2.1" xref="A3.1.p1.7.m2.5.5.2.cmml">(</mo><mi id="A3.1.p1.7.m2.5.5.2.2" xref="A3.1.p1.7.m2.5.5.2.2.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.7.m2.5.5.2.5.2.2" xref="A3.1.p1.7.m2.5.5.2.cmml">)</mo></mrow></mrow><mrow id="A3.1.p1.7.m2.7.7.4" xref="A3.1.p1.7.m2.7.7.4.cmml"><msup id="A3.1.p1.7.m2.7.7.4.4" xref="A3.1.p1.7.m2.7.7.4.4.cmml"><mi id="A3.1.p1.7.m2.7.7.4.4.2" xref="A3.1.p1.7.m2.7.7.4.4.2.cmml">s</mi><mrow id="A3.1.p1.7.m2.6.6.3.1.1.1" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.cmml"><mo stretchy="false" id="A3.1.p1.7.m2.6.6.3.1.1.1.2" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.cmml">(</mo><mrow id="A3.1.p1.7.m2.6.6.3.1.1.1.1" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.cmml"><mi id="A3.1.p1.7.m2.6.6.3.1.1.1.1.2" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.2.cmml">t</mi><mo id="A3.1.p1.7.m2.6.6.3.1.1.1.1.1" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.1.cmml">−</mo><mn id="A3.1.p1.7.m2.6.6.3.1.1.1.1.3" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A3.1.p1.7.m2.6.6.3.1.1.1.3" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="A3.1.p1.7.m2.7.7.4.3" xref="A3.1.p1.7.m2.7.7.4.3.cmml">​</mo><mrow id="A3.1.p1.7.m2.7.7.4.5.2" xref="A3.1.p1.7.m2.7.7.4.cmml"><mo stretchy="false" id="A3.1.p1.7.m2.7.7.4.5.2.1" xref="A3.1.p1.7.m2.7.7.4.cmml">(</mo><mi id="A3.1.p1.7.m2.7.7.4.2" xref="A3.1.p1.7.m2.7.7.4.2.cmml">𝜽</mi><mo stretchy="false" id="A3.1.p1.7.m2.7.7.4.5.2.2" xref="A3.1.p1.7.m2.7.7.4.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A3.1.p1.7.m2.7b"><apply id="A3.1.p1.7.m2.7.8.cmml" xref="A3.1.p1.7.m2.7.8"><eq id="A3.1.p1.7.m2.7.8.1.cmml" xref="A3.1.p1.7.m2.7.8.1"></eq><apply id="A3.1.p1.7.m2.3.3.cmml" xref="A3.1.p1.7.m2.3.3"><divide id="A3.1.p1.7.m2.3.3.4.cmml" xref="A3.1.p1.7.m2.3.3"></divide><apply id="A3.1.p1.7.m2.1.1.1.cmml" xref="A3.1.p1.7.m2.1.1.1"><times id="A3.1.p1.7.m2.1.1.1.2.cmml" xref="A3.1.p1.7.m2.1.1.1.2"></times><apply id="A3.1.p1.7.m2.1.1.1.3.cmml" xref="A3.1.p1.7.m2.1.1.1.3"><csymbol cd="ambiguous" id="A3.1.p1.7.m2.1.1.1.3.1.cmml" xref="A3.1.p1.7.m2.1.1.1.3">subscript</csymbol><ci id="A3.1.p1.7.m2.1.1.1.3.2.cmml" xref="A3.1.p1.7.m2.1.1.1.3.2">𝑠</ci><ci id="A3.1.p1.7.m2.1.1.1.3.3.cmml" xref="A3.1.p1.7.m2.1.1.1.3.3">𝑖</ci></apply><ci id="A3.1.p1.7.m2.1.1.1.1.cmml" xref="A3.1.p1.7.m2.1.1.1.1">𝜽</ci></apply><apply id="A3.1.p1.7.m2.3.3.3.cmml" xref="A3.1.p1.7.m2.3.3.3"><times id="A3.1.p1.7.m2.3.3.3.3.cmml" xref="A3.1.p1.7.m2.3.3.3.3"></times><apply id="A3.1.p1.7.m2.3.3.3.4.cmml" xref="A3.1.p1.7.m2.3.3.3.4"><csymbol cd="ambiguous" id="A3.1.p1.7.m2.3.3.3.4.1.cmml" xref="A3.1.p1.7.m2.3.3.3.4">superscript</csymbol><ci id="A3.1.p1.7.m2.3.3.3.4.2.cmml" xref="A3.1.p1.7.m2.3.3.3.4.2">𝑠</ci><ci id="A3.1.p1.7.m2.2.2.2.1.1.1.cmml" xref="A3.1.p1.7.m2.2.2.2.1.1.1">𝑡</ci></apply><ci id="A3.1.p1.7.m2.3.3.3.2.cmml" xref="A3.1.p1.7.m2.3.3.3.2">𝜽</ci></apply></apply><apply id="A3.1.p1.7.m2.7.7.cmml" xref="A3.1.p1.7.m2.7.7"><divide id="A3.1.p1.7.m2.7.7.5.cmml" xref="A3.1.p1.7.m2.7.7"></divide><apply id="A3.1.p1.7.m2.5.5.2.cmml" xref="A3.1.p1.7.m2.5.5.2"><times id="A3.1.p1.7.m2.5.5.2.3.cmml" xref="A3.1.p1.7.m2.5.5.2.3"></times><apply id="A3.1.p1.7.m2.5.5.2.4.cmml" xref="A3.1.p1.7.m2.5.5.2.4"><csymbol cd="ambiguous" id="A3.1.p1.7.m2.5.5.2.4.1.cmml" xref="A3.1.p1.7.m2.5.5.2.4">superscript</csymbol><apply id="A3.1.p1.7.m2.5.5.2.4.2.cmml" xref="A3.1.p1.7.m2.5.5.2.4"><csymbol cd="ambiguous" id="A3.1.p1.7.m2.5.5.2.4.2.1.cmml" xref="A3.1.p1.7.m2.5.5.2.4">subscript</csymbol><ci id="A3.1.p1.7.m2.5.5.2.4.2.2.cmml" xref="A3.1.p1.7.m2.5.5.2.4.2.2">𝑠</ci><ci id="A3.1.p1.7.m2.5.5.2.4.2.3.cmml" xref="A3.1.p1.7.m2.5.5.2.4.2.3">𝑖</ci></apply><apply id="A3.1.p1.7.m2.4.4.1.1.1.1.1.cmml" xref="A3.1.p1.7.m2.4.4.1.1.1.1"><minus id="A3.1.p1.7.m2.4.4.1.1.1.1.1.1.cmml" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.1"></minus><ci id="A3.1.p1.7.m2.4.4.1.1.1.1.1.2.cmml" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="A3.1.p1.7.m2.4.4.1.1.1.1.1.3.cmml" xref="A3.1.p1.7.m2.4.4.1.1.1.1.1.3">1</cn></apply></apply><ci id="A3.1.p1.7.m2.5.5.2.2.cmml" xref="A3.1.p1.7.m2.5.5.2.2">𝜽</ci></apply><apply id="A3.1.p1.7.m2.7.7.4.cmml" xref="A3.1.p1.7.m2.7.7.4"><times id="A3.1.p1.7.m2.7.7.4.3.cmml" xref="A3.1.p1.7.m2.7.7.4.3"></times><apply id="A3.1.p1.7.m2.7.7.4.4.cmml" xref="A3.1.p1.7.m2.7.7.4.4"><csymbol cd="ambiguous" id="A3.1.p1.7.m2.7.7.4.4.1.cmml" xref="A3.1.p1.7.m2.7.7.4.4">superscript</csymbol><ci id="A3.1.p1.7.m2.7.7.4.4.2.cmml" xref="A3.1.p1.7.m2.7.7.4.4.2">𝑠</ci><apply id="A3.1.p1.7.m2.6.6.3.1.1.1.1.cmml" xref="A3.1.p1.7.m2.6.6.3.1.1.1"><minus id="A3.1.p1.7.m2.6.6.3.1.1.1.1.1.cmml" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.1"></minus><ci id="A3.1.p1.7.m2.6.6.3.1.1.1.1.2.cmml" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.2">𝑡</ci><cn type="integer" id="A3.1.p1.7.m2.6.6.3.1.1.1.1.3.cmml" xref="A3.1.p1.7.m2.6.6.3.1.1.1.1.3">1</cn></apply></apply><ci id="A3.1.p1.7.m2.7.7.4.2.cmml" xref="A3.1.p1.7.m2.7.7.4.2">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.1.p1.7.m2.7c">\frac{s_{i}(\bm{\theta})}{s^{(t)}(\bm{\theta})}=\frac{s_{i}^{(t-1)}(\bm{\theta})}{s^{(t-1)}(\bm{\theta})}</annotation></semantics></math> because of the factorization in <a href="#S2.E2" title="In II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Equation</span> <span class="ltx_text ltx_ref_tag">2</span></a>, and hence <a href="#S2.Ex2" title="Proposition 1. ‣ II-B The optimization procedure ‣ II The VIRTUAL algorithm ‣ Variational Federated Multi-Task Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Proposition</span> <span class="ltx_text ltx_ref_tag">1</span></a> is proved.
∎</p>
</div>
</div>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Full experiment details</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.10" class="ltx_p">In all experiments reported here and in the main text we use a batch size <math id="A4.p1.1.m1.1" class="ltx_Math" alttext="B=20" display="inline"><semantics id="A4.p1.1.m1.1a"><mrow id="A4.p1.1.m1.1.1" xref="A4.p1.1.m1.1.1.cmml"><mi id="A4.p1.1.m1.1.1.2" xref="A4.p1.1.m1.1.1.2.cmml">B</mi><mo id="A4.p1.1.m1.1.1.1" xref="A4.p1.1.m1.1.1.1.cmml">=</mo><mn id="A4.p1.1.m1.1.1.3" xref="A4.p1.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.1.m1.1b"><apply id="A4.p1.1.m1.1.1.cmml" xref="A4.p1.1.m1.1.1"><eq id="A4.p1.1.m1.1.1.1.cmml" xref="A4.p1.1.m1.1.1.1"></eq><ci id="A4.p1.1.m1.1.1.2.cmml" xref="A4.p1.1.m1.1.1.2">𝐵</ci><cn type="integer" id="A4.p1.1.m1.1.1.3.cmml" xref="A4.p1.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.1.m1.1c">B=20</annotation></semantics></math>, except for the Shakespeare dataset, where <math id="A4.p1.2.m2.1" class="ltx_Math" alttext="B=10" display="inline"><semantics id="A4.p1.2.m2.1a"><mrow id="A4.p1.2.m2.1.1" xref="A4.p1.2.m2.1.1.cmml"><mi id="A4.p1.2.m2.1.1.2" xref="A4.p1.2.m2.1.1.2.cmml">B</mi><mo id="A4.p1.2.m2.1.1.1" xref="A4.p1.2.m2.1.1.1.cmml">=</mo><mn id="A4.p1.2.m2.1.1.3" xref="A4.p1.2.m2.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.2.m2.1b"><apply id="A4.p1.2.m2.1.1.cmml" xref="A4.p1.2.m2.1.1"><eq id="A4.p1.2.m2.1.1.1.cmml" xref="A4.p1.2.m2.1.1.1"></eq><ci id="A4.p1.2.m2.1.1.2.cmml" xref="A4.p1.2.m2.1.1.2">𝐵</ci><cn type="integer" id="A4.p1.2.m2.1.1.3.cmml" xref="A4.p1.2.m2.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.2.m2.1c">B=10</annotation></semantics></math>. For both baselines and Virtual we perform a careful log spaced grid-search over 5 values of the regularization multiplier <math id="A4.p1.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A4.p1.3.m3.1a"><mi id="A4.p1.3.m3.1.1" xref="A4.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A4.p1.3.m3.1b"><ci id="A4.p1.3.m3.1.1.cmml" xref="A4.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.3.m3.1c">\beta</annotation></semantics></math> and of the <em id="A4.p1.10.1" class="ltx_emph ltx_font_italic">client</em> learning rate <math id="A4.p1.4.m4.1" class="ltx_Math" alttext="\eta_{c}" display="inline"><semantics id="A4.p1.4.m4.1a"><msub id="A4.p1.4.m4.1.1" xref="A4.p1.4.m4.1.1.cmml"><mi id="A4.p1.4.m4.1.1.2" xref="A4.p1.4.m4.1.1.2.cmml">η</mi><mi id="A4.p1.4.m4.1.1.3" xref="A4.p1.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p1.4.m4.1b"><apply id="A4.p1.4.m4.1.1.cmml" xref="A4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A4.p1.4.m4.1.1.1.cmml" xref="A4.p1.4.m4.1.1">subscript</csymbol><ci id="A4.p1.4.m4.1.1.2.cmml" xref="A4.p1.4.m4.1.1.2">𝜂</ci><ci id="A4.p1.4.m4.1.1.3.cmml" xref="A4.p1.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.4.m4.1c">\eta_{c}</annotation></semantics></math>, verifying that optimal values do not lie at the boundaries of the grid. Similarly we use a linearly spaced grid for the <em id="A4.p1.10.2" class="ltx_emph ltx_font_italic">server</em> learning rate <math id="A4.p1.5.m5.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="A4.p1.5.m5.1a"><msub id="A4.p1.5.m5.1.1" xref="A4.p1.5.m5.1.1.cmml"><mi id="A4.p1.5.m5.1.1.2" xref="A4.p1.5.m5.1.1.2.cmml">η</mi><mi id="A4.p1.5.m5.1.1.3" xref="A4.p1.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A4.p1.5.m5.1b"><apply id="A4.p1.5.m5.1.1.cmml" xref="A4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A4.p1.5.m5.1.1.1.cmml" xref="A4.p1.5.m5.1.1">subscript</csymbol><ci id="A4.p1.5.m5.1.1.2.cmml" xref="A4.p1.5.m5.1.1.2">𝜂</ci><ci id="A4.p1.5.m5.1.1.3.cmml" xref="A4.p1.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.5.m5.1c">\eta_{s}</annotation></semantics></math> of the type <math id="A4.p1.6.m6.2" class="ltx_math_unparsed" alttext="\{0.2,0.4\dots,1.\}" display="inline"><semantics id="A4.p1.6.m6.2a"><mrow id="A4.p1.6.m6.2b"><mo stretchy="false" id="A4.p1.6.m6.2.3">{</mo><mn id="A4.p1.6.m6.1.1">0.2</mn><mo id="A4.p1.6.m6.2.4">,</mo><mn id="A4.p1.6.m6.2.5">0.4</mn><mi mathvariant="normal" id="A4.p1.6.m6.2.6">…</mi><mo id="A4.p1.6.m6.2.7">,</mo><mn id="A4.p1.6.m6.2.2">1</mn><mo lspace="0em" rspace="0.167em" id="A4.p1.6.m6.2.8">.</mo><mo stretchy="false" id="A4.p1.6.m6.2.9">}</mo></mrow><annotation encoding="application/x-tex" id="A4.p1.6.m6.2c">\{0.2,0.4\dots,1.\}</annotation></semantics></math>. In the case of Virtual, we use an additional damping factor <math id="A4.p1.7.m7.2" class="ltx_Math" alttext="\gamma\in[0,1]" display="inline"><semantics id="A4.p1.7.m7.2a"><mrow id="A4.p1.7.m7.2.3" xref="A4.p1.7.m7.2.3.cmml"><mi id="A4.p1.7.m7.2.3.2" xref="A4.p1.7.m7.2.3.2.cmml">γ</mi><mo id="A4.p1.7.m7.2.3.1" xref="A4.p1.7.m7.2.3.1.cmml">∈</mo><mrow id="A4.p1.7.m7.2.3.3.2" xref="A4.p1.7.m7.2.3.3.1.cmml"><mo stretchy="false" id="A4.p1.7.m7.2.3.3.2.1" xref="A4.p1.7.m7.2.3.3.1.cmml">[</mo><mn id="A4.p1.7.m7.1.1" xref="A4.p1.7.m7.1.1.cmml">0</mn><mo id="A4.p1.7.m7.2.3.3.2.2" xref="A4.p1.7.m7.2.3.3.1.cmml">,</mo><mn id="A4.p1.7.m7.2.2" xref="A4.p1.7.m7.2.2.cmml">1</mn><mo stretchy="false" id="A4.p1.7.m7.2.3.3.2.3" xref="A4.p1.7.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.7.m7.2b"><apply id="A4.p1.7.m7.2.3.cmml" xref="A4.p1.7.m7.2.3"><in id="A4.p1.7.m7.2.3.1.cmml" xref="A4.p1.7.m7.2.3.1"></in><ci id="A4.p1.7.m7.2.3.2.cmml" xref="A4.p1.7.m7.2.3.2">𝛾</ci><interval closure="closed" id="A4.p1.7.m7.2.3.3.1.cmml" xref="A4.p1.7.m7.2.3.3.2"><cn type="integer" id="A4.p1.7.m7.1.1.cmml" xref="A4.p1.7.m7.1.1">0</cn><cn type="integer" id="A4.p1.7.m7.2.2.cmml" xref="A4.p1.7.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.7.m7.2c">\gamma\in[0,1]</annotation></semantics></math>, frequently used in the case of message passing algorithms (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>), to prevent oscillations. The damping factor acts on the client updates as <math id="A4.p1.8.m8.3" class="ltx_Math" alttext="s_{i}(\theta)_{t+1}\leftarrow s_{i}(\theta)_{t+1}^{\gamma}s_{i}(\theta)_{t}^{1-\gamma}" display="inline"><semantics id="A4.p1.8.m8.3a"><mrow id="A4.p1.8.m8.3.4" xref="A4.p1.8.m8.3.4.cmml"><mrow id="A4.p1.8.m8.3.4.2" xref="A4.p1.8.m8.3.4.2.cmml"><msub id="A4.p1.8.m8.3.4.2.2" xref="A4.p1.8.m8.3.4.2.2.cmml"><mi id="A4.p1.8.m8.3.4.2.2.2" xref="A4.p1.8.m8.3.4.2.2.2.cmml">s</mi><mi id="A4.p1.8.m8.3.4.2.2.3" xref="A4.p1.8.m8.3.4.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A4.p1.8.m8.3.4.2.1" xref="A4.p1.8.m8.3.4.2.1.cmml">​</mo><msub id="A4.p1.8.m8.3.4.2.3" xref="A4.p1.8.m8.3.4.2.3.cmml"><mrow id="A4.p1.8.m8.3.4.2.3.2.2" xref="A4.p1.8.m8.3.4.2.3.cmml"><mo stretchy="false" id="A4.p1.8.m8.3.4.2.3.2.2.1" xref="A4.p1.8.m8.3.4.2.3.cmml">(</mo><mi id="A4.p1.8.m8.1.1" xref="A4.p1.8.m8.1.1.cmml">θ</mi><mo stretchy="false" id="A4.p1.8.m8.3.4.2.3.2.2.2" xref="A4.p1.8.m8.3.4.2.3.cmml">)</mo></mrow><mrow id="A4.p1.8.m8.3.4.2.3.3" xref="A4.p1.8.m8.3.4.2.3.3.cmml"><mi id="A4.p1.8.m8.3.4.2.3.3.2" xref="A4.p1.8.m8.3.4.2.3.3.2.cmml">t</mi><mo id="A4.p1.8.m8.3.4.2.3.3.1" xref="A4.p1.8.m8.3.4.2.3.3.1.cmml">+</mo><mn id="A4.p1.8.m8.3.4.2.3.3.3" xref="A4.p1.8.m8.3.4.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="A4.p1.8.m8.3.4.1" xref="A4.p1.8.m8.3.4.1.cmml">←</mo><mrow id="A4.p1.8.m8.3.4.3" xref="A4.p1.8.m8.3.4.3.cmml"><msub id="A4.p1.8.m8.3.4.3.2" xref="A4.p1.8.m8.3.4.3.2.cmml"><mi id="A4.p1.8.m8.3.4.3.2.2" xref="A4.p1.8.m8.3.4.3.2.2.cmml">s</mi><mi id="A4.p1.8.m8.3.4.3.2.3" xref="A4.p1.8.m8.3.4.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A4.p1.8.m8.3.4.3.1" xref="A4.p1.8.m8.3.4.3.1.cmml">​</mo><msubsup id="A4.p1.8.m8.3.4.3.3" xref="A4.p1.8.m8.3.4.3.3.cmml"><mrow id="A4.p1.8.m8.3.4.3.3.2.2.2" xref="A4.p1.8.m8.3.4.3.3.cmml"><mo stretchy="false" id="A4.p1.8.m8.3.4.3.3.2.2.2.1" xref="A4.p1.8.m8.3.4.3.3.cmml">(</mo><mi id="A4.p1.8.m8.2.2" xref="A4.p1.8.m8.2.2.cmml">θ</mi><mo stretchy="false" id="A4.p1.8.m8.3.4.3.3.2.2.2.2" xref="A4.p1.8.m8.3.4.3.3.cmml">)</mo></mrow><mrow id="A4.p1.8.m8.3.4.3.3.2.3" xref="A4.p1.8.m8.3.4.3.3.2.3.cmml"><mi id="A4.p1.8.m8.3.4.3.3.2.3.2" xref="A4.p1.8.m8.3.4.3.3.2.3.2.cmml">t</mi><mo id="A4.p1.8.m8.3.4.3.3.2.3.1" xref="A4.p1.8.m8.3.4.3.3.2.3.1.cmml">+</mo><mn id="A4.p1.8.m8.3.4.3.3.2.3.3" xref="A4.p1.8.m8.3.4.3.3.2.3.3.cmml">1</mn></mrow><mi id="A4.p1.8.m8.3.4.3.3.3" xref="A4.p1.8.m8.3.4.3.3.3.cmml">γ</mi></msubsup><mo lspace="0em" rspace="0em" id="A4.p1.8.m8.3.4.3.1a" xref="A4.p1.8.m8.3.4.3.1.cmml">​</mo><msub id="A4.p1.8.m8.3.4.3.4" xref="A4.p1.8.m8.3.4.3.4.cmml"><mi id="A4.p1.8.m8.3.4.3.4.2" xref="A4.p1.8.m8.3.4.3.4.2.cmml">s</mi><mi id="A4.p1.8.m8.3.4.3.4.3" xref="A4.p1.8.m8.3.4.3.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="A4.p1.8.m8.3.4.3.1b" xref="A4.p1.8.m8.3.4.3.1.cmml">​</mo><msubsup id="A4.p1.8.m8.3.4.3.5" xref="A4.p1.8.m8.3.4.3.5.cmml"><mrow id="A4.p1.8.m8.3.4.3.5.2.2.2" xref="A4.p1.8.m8.3.4.3.5.cmml"><mo stretchy="false" id="A4.p1.8.m8.3.4.3.5.2.2.2.1" xref="A4.p1.8.m8.3.4.3.5.cmml">(</mo><mi id="A4.p1.8.m8.3.3" xref="A4.p1.8.m8.3.3.cmml">θ</mi><mo stretchy="false" id="A4.p1.8.m8.3.4.3.5.2.2.2.2" xref="A4.p1.8.m8.3.4.3.5.cmml">)</mo></mrow><mi id="A4.p1.8.m8.3.4.3.5.2.3" xref="A4.p1.8.m8.3.4.3.5.2.3.cmml">t</mi><mrow id="A4.p1.8.m8.3.4.3.5.3" xref="A4.p1.8.m8.3.4.3.5.3.cmml"><mn id="A4.p1.8.m8.3.4.3.5.3.2" xref="A4.p1.8.m8.3.4.3.5.3.2.cmml">1</mn><mo id="A4.p1.8.m8.3.4.3.5.3.1" xref="A4.p1.8.m8.3.4.3.5.3.1.cmml">−</mo><mi id="A4.p1.8.m8.3.4.3.5.3.3" xref="A4.p1.8.m8.3.4.3.5.3.3.cmml">γ</mi></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.8.m8.3b"><apply id="A4.p1.8.m8.3.4.cmml" xref="A4.p1.8.m8.3.4"><ci id="A4.p1.8.m8.3.4.1.cmml" xref="A4.p1.8.m8.3.4.1">←</ci><apply id="A4.p1.8.m8.3.4.2.cmml" xref="A4.p1.8.m8.3.4.2"><times id="A4.p1.8.m8.3.4.2.1.cmml" xref="A4.p1.8.m8.3.4.2.1"></times><apply id="A4.p1.8.m8.3.4.2.2.cmml" xref="A4.p1.8.m8.3.4.2.2"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.4.2.2.1.cmml" xref="A4.p1.8.m8.3.4.2.2">subscript</csymbol><ci id="A4.p1.8.m8.3.4.2.2.2.cmml" xref="A4.p1.8.m8.3.4.2.2.2">𝑠</ci><ci id="A4.p1.8.m8.3.4.2.2.3.cmml" xref="A4.p1.8.m8.3.4.2.2.3">𝑖</ci></apply><apply id="A4.p1.8.m8.3.4.2.3.cmml" xref="A4.p1.8.m8.3.4.2.3"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.4.2.3.1.cmml" xref="A4.p1.8.m8.3.4.2.3">subscript</csymbol><ci id="A4.p1.8.m8.1.1.cmml" xref="A4.p1.8.m8.1.1">𝜃</ci><apply id="A4.p1.8.m8.3.4.2.3.3.cmml" xref="A4.p1.8.m8.3.4.2.3.3"><plus id="A4.p1.8.m8.3.4.2.3.3.1.cmml" xref="A4.p1.8.m8.3.4.2.3.3.1"></plus><ci id="A4.p1.8.m8.3.4.2.3.3.2.cmml" xref="A4.p1.8.m8.3.4.2.3.3.2">𝑡</ci><cn type="integer" id="A4.p1.8.m8.3.4.2.3.3.3.cmml" xref="A4.p1.8.m8.3.4.2.3.3.3">1</cn></apply></apply></apply><apply id="A4.p1.8.m8.3.4.3.cmml" xref="A4.p1.8.m8.3.4.3"><times id="A4.p1.8.m8.3.4.3.1.cmml" xref="A4.p1.8.m8.3.4.3.1"></times><apply id="A4.p1.8.m8.3.4.3.2.cmml" xref="A4.p1.8.m8.3.4.3.2"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.4.3.2.1.cmml" xref="A4.p1.8.m8.3.4.3.2">subscript</csymbol><ci id="A4.p1.8.m8.3.4.3.2.2.cmml" xref="A4.p1.8.m8.3.4.3.2.2">𝑠</ci><ci id="A4.p1.8.m8.3.4.3.2.3.cmml" xref="A4.p1.8.m8.3.4.3.2.3">𝑖</ci></apply><apply id="A4.p1.8.m8.3.4.3.3.cmml" xref="A4.p1.8.m8.3.4.3.3"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.4.3.3.1.cmml" xref="A4.p1.8.m8.3.4.3.3">superscript</csymbol><apply id="A4.p1.8.m8.3.4.3.3.2.cmml" xref="A4.p1.8.m8.3.4.3.3"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.4.3.3.2.1.cmml" xref="A4.p1.8.m8.3.4.3.3">subscript</csymbol><ci id="A4.p1.8.m8.2.2.cmml" xref="A4.p1.8.m8.2.2">𝜃</ci><apply id="A4.p1.8.m8.3.4.3.3.2.3.cmml" xref="A4.p1.8.m8.3.4.3.3.2.3"><plus id="A4.p1.8.m8.3.4.3.3.2.3.1.cmml" xref="A4.p1.8.m8.3.4.3.3.2.3.1"></plus><ci id="A4.p1.8.m8.3.4.3.3.2.3.2.cmml" xref="A4.p1.8.m8.3.4.3.3.2.3.2">𝑡</ci><cn type="integer" id="A4.p1.8.m8.3.4.3.3.2.3.3.cmml" xref="A4.p1.8.m8.3.4.3.3.2.3.3">1</cn></apply></apply><ci id="A4.p1.8.m8.3.4.3.3.3.cmml" xref="A4.p1.8.m8.3.4.3.3.3">𝛾</ci></apply><apply id="A4.p1.8.m8.3.4.3.4.cmml" xref="A4.p1.8.m8.3.4.3.4"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.4.3.4.1.cmml" xref="A4.p1.8.m8.3.4.3.4">subscript</csymbol><ci id="A4.p1.8.m8.3.4.3.4.2.cmml" xref="A4.p1.8.m8.3.4.3.4.2">𝑠</ci><ci id="A4.p1.8.m8.3.4.3.4.3.cmml" xref="A4.p1.8.m8.3.4.3.4.3">𝑖</ci></apply><apply id="A4.p1.8.m8.3.4.3.5.cmml" xref="A4.p1.8.m8.3.4.3.5"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.4.3.5.1.cmml" xref="A4.p1.8.m8.3.4.3.5">superscript</csymbol><apply id="A4.p1.8.m8.3.4.3.5.2.cmml" xref="A4.p1.8.m8.3.4.3.5"><csymbol cd="ambiguous" id="A4.p1.8.m8.3.4.3.5.2.1.cmml" xref="A4.p1.8.m8.3.4.3.5">subscript</csymbol><ci id="A4.p1.8.m8.3.3.cmml" xref="A4.p1.8.m8.3.3">𝜃</ci><ci id="A4.p1.8.m8.3.4.3.5.2.3.cmml" xref="A4.p1.8.m8.3.4.3.5.2.3">𝑡</ci></apply><apply id="A4.p1.8.m8.3.4.3.5.3.cmml" xref="A4.p1.8.m8.3.4.3.5.3"><minus id="A4.p1.8.m8.3.4.3.5.3.1.cmml" xref="A4.p1.8.m8.3.4.3.5.3.1"></minus><cn type="integer" id="A4.p1.8.m8.3.4.3.5.3.2.cmml" xref="A4.p1.8.m8.3.4.3.5.3.2">1</cn><ci id="A4.p1.8.m8.3.4.3.5.3.3.cmml" xref="A4.p1.8.m8.3.4.3.5.3.3">𝛾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.8.m8.3c">s_{i}(\theta)_{t+1}\leftarrow s_{i}(\theta)_{t+1}^{\gamma}s_{i}(\theta)_{t}^{1-\gamma}</annotation></semantics></math>. In order to retain the same number of hyper-parameters as the baselines FedProx and FedAvg we fix the value of the damping factor <math id="A4.p1.9.m9.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A4.p1.9.m9.1a"><mi id="A4.p1.9.m9.1.1" xref="A4.p1.9.m9.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A4.p1.9.m9.1b"><ci id="A4.p1.9.m9.1.1.cmml" xref="A4.p1.9.m9.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.9.m9.1c">\gamma</annotation></semantics></math> as <math id="A4.p1.10.m10.1" class="ltx_Math" alttext="1-\eta_{s}" display="inline"><semantics id="A4.p1.10.m10.1a"><mrow id="A4.p1.10.m10.1.1" xref="A4.p1.10.m10.1.1.cmml"><mn id="A4.p1.10.m10.1.1.2" xref="A4.p1.10.m10.1.1.2.cmml">1</mn><mo id="A4.p1.10.m10.1.1.1" xref="A4.p1.10.m10.1.1.1.cmml">−</mo><msub id="A4.p1.10.m10.1.1.3" xref="A4.p1.10.m10.1.1.3.cmml"><mi id="A4.p1.10.m10.1.1.3.2" xref="A4.p1.10.m10.1.1.3.2.cmml">η</mi><mi id="A4.p1.10.m10.1.1.3.3" xref="A4.p1.10.m10.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="A4.p1.10.m10.1b"><apply id="A4.p1.10.m10.1.1.cmml" xref="A4.p1.10.m10.1.1"><minus id="A4.p1.10.m10.1.1.1.cmml" xref="A4.p1.10.m10.1.1.1"></minus><cn type="integer" id="A4.p1.10.m10.1.1.2.cmml" xref="A4.p1.10.m10.1.1.2">1</cn><apply id="A4.p1.10.m10.1.1.3.cmml" xref="A4.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="A4.p1.10.m10.1.1.3.1.cmml" xref="A4.p1.10.m10.1.1.3">subscript</csymbol><ci id="A4.p1.10.m10.1.1.3.2.cmml" xref="A4.p1.10.m10.1.1.3.2">𝜂</ci><ci id="A4.p1.10.m10.1.1.3.3.cmml" xref="A4.p1.10.m10.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.p1.10.m10.1c">1-\eta_{s}</annotation></semantics></math> that resulted in good performance of the overall method.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Martín Abadi, Paul Barham, Jianmin Chen, Zhifeng Chen, Andy Davis, Jeffrey
Dean, Matthieu Devin, Sanjay Ghemawat, Geoffrey Irving, Michael Isard, et al.

</span>
<span class="ltx_bibblock">Tensorflow: A system for large-scale machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.4.4" class="ltx_text ltx_font_italic">12th <math id="bib.bib1.1.1.m1.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib1.1.1.m1.1a"><mo stretchy="false" id="bib.bib1.1.1.m1.1.1" xref="bib.bib1.1.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.1.1.m1.1b"><ci id="bib.bib1.1.1.m1.1.1.cmml" xref="bib.bib1.1.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.1.1.m1.1c">\{</annotation></semantics></math>USENIX<math id="bib.bib1.2.2.m2.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib1.2.2.m2.1a"><mo stretchy="false" id="bib.bib1.2.2.m2.1.1" xref="bib.bib1.2.2.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.2.2.m2.1b"><ci id="bib.bib1.2.2.m2.1.1.cmml" xref="bib.bib1.2.2.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.2.2.m2.1c">\}</annotation></semantics></math> Symposium on Operating Systems Design and
Implementation (<math id="bib.bib1.3.3.m3.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="bib.bib1.3.3.m3.1a"><mo stretchy="false" id="bib.bib1.3.3.m3.1.1" xref="bib.bib1.3.3.m3.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.3.3.m3.1b"><ci id="bib.bib1.3.3.m3.1.1.cmml" xref="bib.bib1.3.3.m3.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.3.3.m3.1c">\{</annotation></semantics></math>OSDI<math id="bib.bib1.4.4.m4.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="bib.bib1.4.4.m4.1a"><mo stretchy="false" id="bib.bib1.4.4.m4.1.1" xref="bib.bib1.4.4.m4.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.4.4.m4.1b"><ci id="bib.bib1.4.4.m4.1.1.cmml" xref="bib.bib1.4.4.m4.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.4.4.m4.1c">\}</annotation></semantics></math> 16)</span>, pages 265–283, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Muhammad Ammad-ud din, Elena Ivannikova, Suleiman A Khan, Were Oyomno, Qiang
Fu, Kuan Eeik Tan, and Adrian Flanagan.

</span>
<span class="ltx_bibblock">Federated collaborative filtering for privacy-preserving personalized
recommendation system.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1901.09888</span>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
D Anguita, A Ghio, L Oneto, X Parra, and JL Reyes-Ortiz.

</span>
<span class="ltx_bibblock">A public domain dataset for human activity recognition using
smartphones.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">21th European Symposium on Artificial Neural Networks,
Computational Intelligence and Machine Learning (ESANN)</span>, pages 437–442.
CIACO, 2013.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Christopher M Bishop.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Pattern recognition and machine learning</span>.

</span>
<span class="ltx_bibblock">springer, 2006.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Charles Blundell, Julien Cornebise, Koray Kavukcuoglu, and Daan Wierstra.

</span>
<span class="ltx_bibblock">Weight uncertainty in neural network.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
1613–1622, 2015.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Tamara Broderick, Nicholas Boyd, Andre Wibisono, Ashia C Wilson, and Michael I
Jordan.

</span>
<span class="ltx_bibblock">Streaming variational bayes.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages
1727–1735, 2013.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Thang D Bui, Cuong V Nguyen, Siddharth Swaroop, and Richard E Turner.

</span>
<span class="ltx_bibblock">Partitioned variational inference: A unified framework encompassing
federated and continual learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1811.11206</span>, 2018.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Sebastian Caldas, Peter Wu, Tian Li, Jakub Konečnỳ, H Brendan
McMahan, Virginia Smith, and Ameet Talwalkar.

</span>
<span class="ltx_bibblock">Leaf: A benchmark for federated settings.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.01097</span>, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Gregory Cohen, Saeed Afshar, Jonathan Tapson, and André van Schaik.

</span>
<span class="ltx_bibblock">Emnist: an extension of mnist to handwritten letters.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1702.05373</span>, 2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Ronan Collobert and Jason Weston.

</span>
<span class="ltx_bibblock">A unified architecture for natural language processing: Deep neural
networks with multitask learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the 25th international conference on Machine
learning</span>, pages 160–167. ACM, 2008.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Jeffrey Dean, Greg Corrado, Rajat Monga, Kai Chen, Matthieu Devin, Mark Mao,
Andrew Senior, Paul Tucker, Ke Yang, Quoc V Le, et al.

</span>
<span class="ltx_bibblock">Large scale distributed deep networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
1223–1231, 2012.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Joshua V Dillon, Ian Langmore, Dustin Tran, Eugene Brevdo, Srinivas Vasudevan,
Dave Moore, Brian Patton, Alex Alemi, Matt Hoffman, and Rif A Saurous.

</span>
<span class="ltx_bibblock">Tensorflow distributions.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1711.10604</span>, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Marco F Duarte and Yu Hen Hu.

</span>
<span class="ltx_bibblock">Vehicle classification in distributed sensor networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Journal of Parallel and Distributed Computing</span>, 64(7):826–838,
2004.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Meire Fortunato, Charles Blundell, and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Bayesian recurrent neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1704.02798</span>, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Jonathan Frankle and Michael Carbin.

</span>
<span class="ltx_bibblock">The lottery ticket hypothesis: Finding sparse, trainable neural
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Robert M French.

</span>
<span class="ltx_bibblock">Catastrophic forgetting in connectionist networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">Trends in cognitive sciences</span>, 3(4):128–135, 1999.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Robin Geyer, Luca Corinzia, and Viktor Wegmayr.

</span>
<span class="ltx_bibblock">Transfer learning by adaptive merging of multiple models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">International Conference on Medical Imaging with Deep
Learning</span>, pages 185–196, 2019.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Ian J Goodfellow, Mehdi Mirza, Da Xiao, Aaron Courville, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">An empirical investigation of catastrophic forgetting in
gradient-based neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1312.6211</span>, 2013.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Song Han, Jeff Pool, John Tran, and William Dally.

</span>
<span class="ltx_bibblock">Learning both weights and connections for efficient neural network.

</span>
<span class="ltx_bibblock">In <span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
1135–1143, 2015.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Leonard Hasenclever, Stefan Webb, Thibaut Lienart, Sebastian Vollmer, Balaji
Lakshminarayanan, Charles Blundell, and Yee Whye Teh.

</span>
<span class="ltx_bibblock">Distributed bayesian learning with stochastic natural gradient
expectation propagation and the posterior server.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">The Journal of Machine Learning Research</span>, 18(1):3744–3780,
2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
I. Higgins, Loïc Matthey, A. Pal, C. Burgess, Xavier Glorot, M. Botvinick,
S. Mohamed, and Alexander Lerchner.

</span>
<span class="ltx_bibblock">beta-vae: Learning basic visual concepts with a constrained
variational framework.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol Vinyals, and Jeff Dean.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1503.02531</span>, 2015.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Geoffrey E Hinton and Ruslan R Salakhutdinov.

</span>
<span class="ltx_bibblock">Reducing the dimensionality of data with neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">science</span>, 313(5786):504–507, 2006.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
White House.

</span>
<span class="ltx_bibblock">Consumer data privacy in a networked world: A framework for
protecting privacy and promoting innovation in the global digital economy.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">White House, Washington, DC</span>, pages 1–62, 2012.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Martin Jaggi, Virginia Smith, Martin Takác, Jonathan Terhorst, Sanjay
Krishnan, Thomas Hofmann, and Michael I Jordan.

</span>
<span class="ltx_bibblock">Communication-efficient distributed dual coordinate ascent.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
3068–3076, 2014.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Eunjeong Jeong, Seungeun Oh, Hyesung Kim, Jihong Park, Mehdi Bennis, and
Seong-Lyun Kim.

</span>
<span class="ltx_bibblock">Communication-efficient on-device machine learning: Federated
distillation and augmentation under non-iid private data.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1811.11479</span>, 2018.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Andrej Karpathy.

</span>
<span class="ltx_bibblock">The unreasonable effectiveness of recurrent neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Andrej Karpathy blog</span>, 21:23, 2015.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Max Welling.

</span>
<span class="ltx_bibblock">Auto-encoding variational bayes.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1312.6114</span>, 2013.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Durk P Kingma, Tim Salimans, and Max Welling.

</span>
<span class="ltx_bibblock">Variational dropout and the local reparameterization trick.

</span>
<span class="ltx_bibblock">In <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
2575–2583, 2015.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
James Kirkpatrick, Razvan Pascanu, Neil Rabinowitz, Joel Veness, Guillaume
Desjardins, Andrei A Rusu, Kieran Milan, John Quan, Tiago Ramalho, Agnieszka
Grabska-Barwinska, et al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">Proceedings of the national academy of sciences</span>,
114(13):3521–3526, 2017.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Jakub Konečny, H Brendan McMahan, Daniel Ramage, and Peter
Richtárik.

</span>
<span class="ltx_bibblock">Federated optimization: Distributed machine learning for on-device
intelligence.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1610.02527</span>, 2016.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Yann LeCun, Léon Bottou, Yoshua Bengio, Patrick Haffner, et al.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, 86(11):2278–2324, 1998.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Sang-Woo Lee, Jin-Hwa Kim, Jaehyun Jun, Jung-Woo Ha, and Byoung-Tak Zhang.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting by incremental moment matching.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, pages
4652–4662, 2017.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Min Lin, Qiang Chen, and Shuicheng Yan.

</span>
<span class="ltx_bibblock">Network in network.

</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1312.4400</span>, 2013.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Chenxin Ma, Virginia Smith, Martin Jaggi, Michael I Jordan, Peter
Richtárik, and Martin Takáč.

</span>
<span class="ltx_bibblock">Adding vs. averaging in distributed primal-dual optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Proceedings of the 32nd International Conference on
International Conference on Machine Learning-Volume 37</span>, pages 1973–1982.
JMLR. org, 2015.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Ryan McDonald, Keith Hall, and Gideon Mann.

</span>
<span class="ltx_bibblock">Distributed training strategies for the structured perceptron.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">Human Language Technologies: The 2010 Annual Conference of
the North American Chapter of the Association for Computational Linguistics</span>,
pages 456–464. Association for Computational Linguistics, 2010.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">Artificial Intelligence and Statistics</span>, pages 1273–1282,
2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Thomas Minka.

</span>
<span class="ltx_bibblock">Power ep.

</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">Dep. Statistics, Carnegie Mellon University, Pittsburgh, PA,
Tech. Rep</span>, 2004.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Thomas P Minka.

</span>
<span class="ltx_bibblock">Expectation propagation for approximate bayesian inference.

</span>
<span class="ltx_bibblock">In <span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">Proceedings of the Seventeenth conference on Uncertainty in
artificial intelligence</span>, pages 362–369. Morgan Kaufmann Publishers Inc.,
2001.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Cuong V Nguyen, Yingzhen Li, Thang D Bui, and Richard E Turner.

</span>
<span class="ltx_bibblock">Variational continual learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1710.10628</span>, 2017.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Adrian Nilsson, Simon Smith, Gregor Ulm, Emil Gustavsson, and Mats Jirstrand.

</span>
<span class="ltx_bibblock">A performance evaluation of federated learning algorithms.

</span>
<span class="ltx_bibblock">In <span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">Proceedings of the Second Workshop on Distributed
Infrastructures for Deep Learning (New York, NY, USA, 2018), DIDL</span>,
volume 18, pages 1–8, 2018.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
KB Petersen, MS Pedersen, et al.

</span>
<span class="ltx_bibblock">The matrix cookbook, vol. 7.

</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text ltx_font_italic">Technical University of Denmark</span>, 15, 2008.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Daniel Povey, Xiaohui Zhang, and Sanjeev Khudanpur.

</span>
<span class="ltx_bibblock">Parallel training of deep neural networks with natural gradient and
parameter averaging.

</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1410.7455</span>, 2014.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Sebastian Ruder.

</span>
<span class="ltx_bibblock">An overview of multi-task learning in deep neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1706.05098</span>, 2017.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Andrei A Rusu, Neil C Rabinowitz, Guillaume Desjardins, Hubert Soyer, James
Kirkpatrick, Koray Kavukcuoglu, Razvan Pascanu, and Raia Hadsell.

</span>
<span class="ltx_bibblock">Progressive neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1606.04671</span>, 2016.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Anit Kumar Sahu, Tian Li, Maziar Sanjabi, Manzil Zaheer, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">On the convergence of federated optimization in heterogeneous
networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.06127</span>, 2018.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Jonathan Schwarz, Wojciech Czarnecki, Jelena Luketina, Agnieszka
Grabska-Barwinska, Yee Whye Teh, Razvan Pascanu, and Raia Hadsell.

</span>
<span class="ltx_bibblock">Progress &amp; compress: A scalable framework for continual learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
4535–4544, 2018.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Sidak Pal Singh and Martin Jaggi.

</span>
<span class="ltx_bibblock">Model fusion via optimal transport.

</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, 33, 2020.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet S Talwalkar.

</span>
<span class="ltx_bibblock">Federated multi-task learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages
4424–4434, 2017.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Virginia Smith, Simone Forte, Ma Chenxin, Martin Takáč, Michael I
Jordan, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Cocoa: A general framework for communication-efficient distributed
optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text ltx_font_italic">Journal of Machine Learning Research</span>, 18:230, 2018.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Alexander J Smola, Vishy Vishwanathan, and Eleazar Eskin.

</span>
<span class="ltx_bibblock">Laplace propagation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">NIPS</span>, pages 441–448, 2003.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Alexander V Terekhov, Guglielmo Montone, and J Kevin O’Regan.

</span>
<span class="ltx_bibblock">Knowledge transfer in deep block-modular neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib52.1.1" class="ltx_text ltx_font_italic">Conference on Biomimetic and Biohybrid Systems</span>, pages
268–279. Springer, 2015.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Aki Vehtari, Andrew Gelman, Tuomas Sivula, Pasi Jylänki, Dustin Tran,
Swupnil Sahai, Paul Blomstedt, John P Cunningham, David Schiminovich, and
Christian P Robert.

</span>
<span class="ltx_bibblock">Expectation propagation as a way of life: A framework for bayesian
inference on partitioned data.

</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text ltx_font_italic">Journal of Machine Learning Research</span>, 21(17):1–53, 2020.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Luke Vilnis and Andrew McCallum.

</span>
<span class="ltx_bibblock">Word representations via gaussian embedding.

</span>
<span class="ltx_bibblock">In <span id="bib.bib54.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2015.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
Paul Voigt and Axel Von dem Bussche.

</span>
<span class="ltx_bibblock">The eu general data protection regulation (gdpr).

</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text ltx_font_italic">A Practical Guide, 1st Ed., Cham: Springer International
Publishing</span>, 2017.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
Hongyi Wang, Mikhail Yurochkin, Yuekai Sun, Dimitris Papailiopoulos, and
Yasaman Khazaeni.

</span>
<span class="ltx_bibblock">Federated learning with matched averaging.

</span>
<span class="ltx_bibblock">In <span id="bib.bib56.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Chenshen Wu, Luis Herranz, Xialei Liu, Yaxing Wang, Joost van de Weijer, and
Bogdan Raducanu.

</span>
<span class="ltx_bibblock">Memory replay gans: learning to generate images from new categories
without forgetting.

</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1809.02058</span>, 2018.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
Timothy Yang, Galen Andrew, Hubert Eichner, Haicheng Sun, Wei Li, Nicholas
Kong, Daniel Ramage, and Françoise Beaufays.

</span>
<span class="ltx_bibblock">Applied federated learning: Improving google keyboard query
suggestions.

</span>
<span class="ltx_bibblock"><span id="bib.bib58.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.02903</span>, 2018.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
Jaehong Yoon, Saehoon Kim, Eunho Yang, and Sung Ju Hwang.

</span>
<span class="ltx_bibblock">Oracle: Order robust adaptive continual learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1902.09432</span>, 2019.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
Mikhail Yurochkin, Mayank Agarwal, Soumya Ghosh, Kristjan Greenewald, Nghia
Hoang, and Yasaman Khazaeni.

</span>
<span class="ltx_bibblock">Bayesian nonparametric federated learning of neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib60.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
7252–7261, 2019.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
Friedemann Zenke, Ben Poole, and Surya Ganguli.

</span>
<span class="ltx_bibblock">Continual learning through synaptic intelligence.

</span>
<span class="ltx_bibblock">In <span id="bib.bib61.1.1" class="ltx_text ltx_font_italic">Proceedings of the 34th International Conference on Machine
Learning-Volume 70</span>, pages 3987–3995. JMLR. org, 2017.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
Sixin Zhang, Anna E Choromanska, and Yann LeCun.

</span>
<span class="ltx_bibblock">Deep learning with elastic averaging sgd.

</span>
<span class="ltx_bibblock">In <span id="bib.bib62.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages
685–693, 2015.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib63.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1806.00582</span>, 2018.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</section>
</div>
</div>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1906.06267" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1906.06268" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1906.06268">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1906.06268" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1906.06269" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar  6 13:44:33 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
