<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2205.09305] FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data</title><meta property="og:description" content="Federated learning is a distributed machine learning approach which enables a shared server model to learn by aggregating the locally-computed parameter updates with the training data from spatially-distributed client …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2205.09305">

<!--Generated on Tue Feb 27 05:46:06 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mike He Zhu 
<br class="ltx_break">McGill University 
<br class="ltx_break">Mila - Quebec AI Institute
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">he.zhu@mila.quebec</span> 
<br class="ltx_break">&amp;Léna Néhale Ezzine 
<br class="ltx_break">Mila - Quebec AI Institute
<br class="ltx_break"><span id="id2.2.id2" class="ltx_text ltx_font_typewriter">lena-nehale.ezzine@mila.quebec</span> 
<br class="ltx_break">&amp;Dianbo Liu 
<br class="ltx_break">Mila - Quebec AI Institute
<br class="ltx_break"><span id="id3.3.id3" class="ltx_text ltx_font_typewriter">dianbo.liu@mila.quebec</span> 
<br class="ltx_break">&amp;Yoshua Bengio 
<br class="ltx_break">Université de Montréal 
<br class="ltx_break">Mila - Quebec AI Institute
<br class="ltx_break"><span id="id4.4.id4" class="ltx_text ltx_font_typewriter">yoshua.bengio@mila.quebec</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.id1" class="ltx_p">Federated learning is a distributed machine learning approach which enables a shared server model to learn by aggregating the locally-computed parameter updates with the training data from spatially-distributed client silos. Though successfully possessing advantages in both scale and privacy, federated learning is hurt by domain shift problems, where the learning models are unable to generalize to unseen domains whose data distribution is non-i.i.d. with respect to the training domains. In this study, we propose the Federated Invariant Learning Consistency (FedILC) approach, which leverages the gradient covariance and the geometric mean of Hessians to capture both inter-silo and intra-silo consistencies of environments and unravel the domain shift problems in federated networks. The benchmark and real-world dataset experiments bring evidence that our proposed algorithm outperforms conventional baselines and similar federated learning algorithms. This is relevant to various fields such as medical healthcare, computer vision, and the Internet of Things (IoT). The code is released at <a target="_blank" href="https://github.com/mikemikezhu/FedILC" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/mikemikezhu/FedILC</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning is a machine learning paradigm where the local clients collaboratively train a model under the orchestration of a central server <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>; <a href="#bib.bib2" title="" class="ltx_ref">2</a>; <a href="#bib.bib3" title="" class="ltx_ref">3</a>)</cite>. Keeping the training data spatially-distributed, federated learning remarkably mitigates the privacy risks engendered by the centralized machine learning approaches <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>; <a href="#bib.bib4" title="" class="ltx_ref">4</a>; <a href="#bib.bib5" title="" class="ltx_ref">5</a>; <a href="#bib.bib6" title="" class="ltx_ref">6</a>)</cite>. Stupendous achievements though it has obtained, federated learning has been suffocated with the domain shift problems, which occurs when the labelled data collected by the source node statistically differs from the target node’s unlabelled data, thus the learning models are unable to generalize to unseen domains with inconsistent data distributions <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib7" title="" class="ltx_ref">7</a>)</cite>. In a real-world scenario, for example, although the medical radiology images collected in different hospitals have uniformly distributed labels, the image appearance (e.g. contrast and saturation) may vary due to different imaging machines and protocols used in hospitals. Consequently, the disease detection model collaboratively trained in these hospitals might be unable to effectively generalize to other hospitals with heterogeneity in the feature distributions.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Recently, a slew of researchers endeavoured to devise a methodology to disentangle the domain shift problems by training an invariant model that could successfully adapt to out of domain distributions. The topic of research, also known as "Domain Generalization" or "Out-of-Distribution (OOD) Generalization", aims at lubricating the process of learning invariant features that are generalizable out of domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib8" title="" class="ltx_ref">8</a>; <a href="#bib.bib9" title="" class="ltx_ref">9</a>; <a href="#bib.bib10" title="" class="ltx_ref">10</a>; <a href="#bib.bib11" title="" class="ltx_ref">11</a>; <a href="#bib.bib12" title="" class="ltx_ref">12</a>)</cite>. Further, most recent works promote invariance via a regularization criterion at either representation level or gradient level. The former enforces the agreement by generating latent variables that efficaciously represent all the training domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib13" title="" class="ltx_ref">13</a>; <a href="#bib.bib14" title="" class="ltx_ref">14</a>; <a href="#bib.bib15" title="" class="ltx_ref">15</a>; <a href="#bib.bib16" title="" class="ltx_ref">16</a>)</cite>, whereas the latter promotes the agreement among the gradients from different domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>; <a href="#bib.bib18" title="" class="ltx_ref">18</a>; <a href="#bib.bib19" title="" class="ltx_ref">19</a>; <a href="#bib.bib20" title="" class="ltx_ref">20</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Since the conventional federated learning algorithm involves averaging the model parameters or gradient updates to approximate the optimal global model, our research focuses on facilitating the invariance of gradients among different federated clients. Recently, Parascandolo unearthed that the arithmetic averaging of Hessians is unable to capture the consistencies, thus proposing the geometric mean to encourage the agreements of environments. As opposed to arithmetic mean that performs a "logical OR" on the Hessians, geometric mean serves as a "logical AND" operator, mandating complete consistency among different training domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>)</cite>. Albeit the geometric mean of gradients theoretically promotes consistency, it is still circumscribed with several quandaries. One conspicuous predicament is that the geometric mean becomes legitimate only when all the signs are consistent - either all gradients are positive or negative. Thus, it is unattainable to calculate the geometric mean with <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">inconsistent signs</span>, which commonly exist in non-convex settings. To forestall this issue, Parascandolo, based on his algorithm implementation <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The code implementation of Learning explanations that are hard to vary: <a target="_blank" href="https://github.com/gibipara92/learning-explanations-hard-to-vary/blob/main/and_mask/and_mask_utils.py" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/gibipara92/learning-explanations-hard-to-vary/blob/main/and_mask/and_mask_utils.py</a></span></span></span>, takes <span id="S1.p3.1.2" class="ltx_text ltx_font_bold">the absolute values</span> of all the gradients to calculate the geometric mean, which largely overlooks the inconsistency of signs for the gradients, thus engendering bias during the training process. Meanwhile, Parascandolo also presented a new strategy, namely "AND-Mask", which takes a discrete mask to zero out the gradients with inconsistent signs across environments and ensures the network parameters are updated only if all the gradients from different domains agree on a certain direction. This masking strategy is analogous to applying a logical AND operator on the direction of gradients. Though proved advantageous in some curated test conditions, their proposed mechanism is intrinsically using arithmetic averaging of Hessians. Furthermore, AND-masking on the average loss landscape might induce "dead zones", where the gradients from different environments are sometimes unable to update the parameters unless their directions strictly match with each other <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib19" title="" class="ltx_ref">19</a>)</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Likewise, Rame <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">et al.</span> proposed Fishr to approximate the domain-level gradient covariance, which forces the model to have similar domain-level Hessians, thus promoting invariance across domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib20" title="" class="ltx_ref">20</a>)</cite>. However, Fishr could be flawed, especially in a centralized way of training. It requires knowing the number of environments beforehand to calculate gradient covariance, which is unfeasible in an intra-silo training environment. Fortunately, the number of domains is accessible in federated networks, allowing Fishr to capture the inter-silo consistencies in federated learning settings. Shoham et al. proposed a federated curvature (FedCurv) algorithm. Similar to the Fishr method, while applying in a decentralized way, FedCurv employs the diagonal of the Fisher information matrix to mitigate the domain shift problem in federated learning <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib21" title="" class="ltx_ref">21</a>)</cite>.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Inspired by geometric mean, Fishr, and FedCurv algorithms, we introduce a new regularization, the Federated Invariant Learning Consistency (FedILC), which leverages the domain-level gradient covariance and the geometric averaging of Hessians to promote both inter-silo and intra-silo consistencies in federated networks. Moreover, we also propose a novel weighted geometric mean mechanism to calculate geometric mean with inconsistent signs. The benchmark and real-world dataset experiments manifest that our proposed algorithm outperforms both the conventional and the state-of-the-art federated learning algorithms.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In a nutshell, the paper purveys the following contributions:</p>
</div>
<div id="S1.p7" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce a novel regularization methodology, FedILC, employing the gradient covariance and weighted geometric mean of gradients to capture both inter-silo and intra-silo consistencies in federated networks.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose the weighted geometric mean to unravel the issue of geometric mean calculation with inconsistent signs on gradients.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We proffer a scalable yet straightforward implementation of our algorithm, and the experiments evince that FedILC outperforms both the conventional baselines and other similar federated learning algorithms.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Strategies of Domain Adaptation</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p"><span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_bold">(1) Representation-level agreement:</span> This approach strives for finding invariant representations at feature level <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib13" title="" class="ltx_ref">13</a>; <a href="#bib.bib14" title="" class="ltx_ref">14</a>; <a href="#bib.bib15" title="" class="ltx_ref">15</a>; <a href="#bib.bib16" title="" class="ltx_ref">16</a>)</cite> by yielding consonant representations for all training domains, thus training models to map different domains into a single statistical distributions. This could be achieved by matching the mean and variance of representations across different domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib22" title="" class="ltx_ref">22</a>)</cite>, or the distribution of the representations in different domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib23" title="" class="ltx_ref">23</a>)</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p"><span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_bold">(2) Gradient-level agreement:</span> Another approach, on the contrary, works at gradient level, which intends to find local or global minimums commonly shared across all the environments in the loss space <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>; <a href="#bib.bib19" title="" class="ltx_ref">19</a>; <a href="#bib.bib18" title="" class="ltx_ref">18</a>)</cite>. In other words, the goal minimums are agreements among the gradients backpropagated in the network, and allow it to share similar Hessians for different domains. Specifically, Parascandolo <span id="S2.SS1.p2.1.2" class="ltx_text ltx_font_italic">el al.</span> proposed geometric averaging of Hessians to capture the invariance among different domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>)</cite>. Compared with arithmetic mean, which operates "logical OR" on the Hessians, geometric mean performs a "logical AND" operation, and achieves better outcomes in finding consistencies among environments. Nonetheless, the geometric mean is intrinsically blemished when the signs are inconsistent, which can be prevalent in non-convex settings. Furthermore, he also applied an AND-masking strategy to the arithmetic mean, which defines a peculiar agreement threshold as a hyper-parameter, and allows the parameters of network to be updated only if all the gradients flowing in that parameter agree on a certain direction based on the threshold. Nevertheless, the masking strategy requires the direction to which the gradients from different environments point strictly match with each other in order to allow the gradients to update that particular parameter. To address this issue, Soroosh proposed a smoothed AND-masking algorithm (SAND-mask), which not only validates the invariance in the direction of gradients, but also promotes the agreement among the gradient magnitudes <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib19" title="" class="ltx_ref">19</a>)</cite>. Yet, regarding their experiment results, the proposed masking strategy barely competes the performance of other algorithms, including AND-masking strategy. Moreover, Rame proposed Fishr in his paper to leverage the domain-level gradient covariance to promote invariances across domains <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib20" title="" class="ltx_ref">20</a>)</cite>. However, it is paramount to know the number of environments beforehand to calculate gradient covariance across domains, which is intractable in the centralized way of training.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Domain Shift in Federated Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Federated learning aims to train a global model by aggregating the updates from a slew of client models spatially distributed on different devices while preserving privacy. In 2017, McMahan et al., for the first time, presented the notion of federated learning based on data parallelism and proposed both FedSGD and FedAvg algorithms. <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>)</cite>. FedSGD algorithm updates the global model by averaging the gradients uploaded by the clients, whilst the FedAvg methodology employs the averages of clients’ model parameters to update the global model’s weights. While federated learning provides a nascent methodology in privacy preservation, many challenges arise in terms of the domain shift problem engendered by the non-i.i.d data. Although the authors in <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>)</cite> contend that FedAvg can mitigate the domain adaptation issue to a certain degree, myriads of research have evinced that a deterioration in the federated model’s accuracy is almost inevitable on the heterogeneous data <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib24" title="" class="ltx_ref">24</a>)</cite>. The state-of-the-art approaches to alleviate the non-i.i.d. problems in federated learning can be categorized into the data-based <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib25" title="" class="ltx_ref">25</a>; <a href="#bib.bib26" title="" class="ltx_ref">26</a>; <a href="#bib.bib27" title="" class="ltx_ref">27</a>; <a href="#bib.bib28" title="" class="ltx_ref">28</a>)</cite>, algorithm-based <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib29" title="" class="ltx_ref">29</a>; <a href="#bib.bib30" title="" class="ltx_ref">30</a>; <a href="#bib.bib31" title="" class="ltx_ref">31</a>; <a href="#bib.bib32" title="" class="ltx_ref">32</a>; <a href="#bib.bib33" title="" class="ltx_ref">33</a>; <a href="#bib.bib21" title="" class="ltx_ref">21</a>)</cite>, and system-based approaches <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib34" title="" class="ltx_ref">34</a>; <a href="#bib.bib35" title="" class="ltx_ref">35</a>; <a href="#bib.bib36" title="" class="ltx_ref">36</a>; <a href="#bib.bib37" title="" class="ltx_ref">37</a>)</cite>. Precisely, among the algorithm-based methodology, Shoham et al. proposed a federated curvature (FedCurv) algorithm, which is similar to the Fishr paper, while in a decentralized way to disentangle the non-i.i.d issue in federated learning <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib21" title="" class="ltx_ref">21</a>)</cite>. During each round, participants transmit updated models together with the diagonal of the Fisher information matrix, which represents the most informative features for the current task. A penalty term is added to the loss function for each participant to promote the convergence towards a globally shared optimum.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The domain shift problems engendered by the non-i.i.d. data significantly hinder the training of federated models. Moreover, although the dataset within each client is theoretically homogeneous in distributions, in the real world cases, however, non-i.i.d. data may still exist even within one federated client. Motivated by ILC, Fishr, and FedCurv, we propose two innovative methodologies: (1) Fishr+Inter-Geo, and (2) Fishr+Intra-Geo, to mitigate the inter-silo and intra-silo domain shift problems. Furthermore, we also introduce a novel weighted geometric mean method to calculate the geometric mean of gradients with inconsistent signs. The server-client communication protocol of our proposed methods are further demonstrated in Figure <a href="#S3.F1" title="Figure 1 ‣ 3.3 Fishr+Intra-Geo: Fishr and Intra-silo Weighted Geometric Mean ‣ 3 Methodology ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and <a href="#S7.F4" title="Figure 4 ‣ 7 Appendix ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.6" class="ltx_p"><span id="S3.p2.6.1" class="ltx_text ltx_font_bold">Problem Formulation:</span> To begin with, we define our problem in the following formulations. We assume there are <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathcal{E}</annotation></semantics></math> accessible clients in the federated learning settings. Each client <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="e\in\mathcal{E}" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">e</mi><mo id="S3.p2.2.m2.1.1.1" xref="S3.p2.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><in id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1"></in><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑒</ci><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">e\in\mathcal{E}</annotation></semantics></math> has private training dataset <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="\{\mathcal{D}_{e}\}_{e\in\mathcal{E}}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mrow id="S3.p2.3.m3.1.1.1.1" xref="S3.p2.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.3.m3.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.2.cmml">{</mo><msub id="S3.p2.3.m3.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.p2.3.m3.1.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.3.cmml">e</mi></msub><mo stretchy="false" id="S3.p2.3.m3.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml"><mi id="S3.p2.3.m3.1.1.3.2" xref="S3.p2.3.m3.1.1.3.2.cmml">e</mi><mo id="S3.p2.3.m3.1.1.3.1" xref="S3.p2.3.m3.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1.3.3" xref="S3.p2.3.m3.1.1.3.3.cmml">ℰ</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><set id="S3.p2.3.m3.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1"><apply id="S3.p2.3.m3.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.2">𝒟</ci><ci id="S3.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.1.1.3">𝑒</ci></apply></set><apply id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3"><in id="S3.p2.3.m3.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.3.1"></in><ci id="S3.p2.3.m3.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.3.2">𝑒</ci><ci id="S3.p2.3.m3.1.1.3.3.cmml" xref="S3.p2.3.m3.1.1.3.3">ℰ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\{\mathcal{D}_{e}\}_{e\in\mathcal{E}}</annotation></semantics></math> sampled from <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\mathcal{E}</annotation></semantics></math> distinct distributions. Let <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">w</annotation></semantics></math> be the parameters of the global model shared across clients. Our goal is to learn <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.p2.6.m6.1a"><mi id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">w</annotation></semantics></math> such that the model captures invariant features across different federated clients and generalises well to unseen domains.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Weighted Geometric Mean</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Parascandolo introduced geometric averaging of Hessians in his paper <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>)</cite>. Although the element-wise geometric mean of gradients successfully promotes consistency in convex quadratic cases, it is still circumscribed with several quandaries. One of the significant encumbrances is that <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_bold">geometric mean is only defined when all the signs are consistent</span>, and it is barely feasible to calculate geometric mean with inconsistent signs, which pervasively exists in non-convex settings. Based on Parascandolo’s code implementation, they take <span id="S3.SS1.p1.1.2" class="ltx_text ltx_font_bold">the absolute values</span> of all the gradients to calculate the geometric mean. Though applied with a list of binary masks, the gradients calculated by geometric mean with absolute values might still introduce bias during the training process. Therefore, this method can be further improvable.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">In this paper, we introduce <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_bold">weighted geometric mean</span>, which remedies the conventional geometric mean method to compute when the signs are inconsistent.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.4" class="ltx_p">Let our global model be parametrised by <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="w\in\mathbf{R}^{n}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">w</mi><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mi id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">𝐑</mi><mi id="S3.SS1.p3.1.m1.1.1.3.3" xref="S3.SS1.p3.1.m1.1.1.3.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><in id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></in><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑤</ci><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.3.2.cmml" xref="S3.SS1.p3.1.m1.1.1.3.2">𝐑</ci><ci id="S3.SS1.p3.1.m1.1.1.3.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">w\in\mathbf{R}^{n}</annotation></semantics></math>. Let <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="F_{e}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">F</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝐹</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">F_{e}</annotation></semantics></math> be the loss obtained for client <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">e</annotation></semantics></math>, with its corresponding gradient <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="\nabla F_{e}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mo rspace="0.167em" id="S3.SS1.p3.4.m4.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.cmml">∇</mo><msub id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2.2" xref="S3.SS1.p3.4.m4.1.1.2.2.cmml">F</mi><mi id="S3.SS1.p3.4.m4.1.1.2.3" xref="S3.SS1.p3.4.m4.1.1.2.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><ci id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1">∇</ci><apply id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2">𝐹</ci><ci id="S3.SS1.p3.4.m4.1.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">\nabla F_{e}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.4" class="ltx_p">Let <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\left[\nabla F_{e}\right]_{k}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mrow id="S3.SS1.p4.1.m1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p4.1.m1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p4.1.m1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS1.p4.1.m1.1.1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml">∇</mo><msub id="S3.SS1.p4.1.m1.1.1.1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.2.cmml">F</mi><mi id="S3.SS1.p4.1.m1.1.1.1.1.1.2.3" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo id="S3.SS1.p4.1.m1.1.1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><apply id="S3.SS1.p4.1.m1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p4.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1"><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.1">∇</ci><apply id="S3.SS1.p4.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.2">𝐹</ci><ci id="S3.SS1.p4.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1.1.2.3">𝑒</ci></apply></apply></apply><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\left[\nabla F_{e}\right]_{k}</annotation></semantics></math> denote the k-th coordinate of <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="\nabla F_{e}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mo rspace="0.167em" id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">∇</mo><msub id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2.2" xref="S3.SS1.p4.2.m2.1.1.2.2.cmml">F</mi><mi id="S3.SS1.p4.2.m2.1.1.2.3" xref="S3.SS1.p4.2.m2.1.1.2.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><ci id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1">∇</ci><apply id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.2.1.cmml" xref="S3.SS1.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2.2">𝐹</ci><ci id="S3.SS1.p4.2.m2.1.1.2.3.cmml" xref="S3.SS1.p4.2.m2.1.1.2.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\nabla F_{e}</annotation></semantics></math>, <math id="S3.SS1.p4.3.m3.1" class="ltx_math_unparsed" alttext="k\in\{0,..,n-1\}" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mrow id="S3.SS1.p4.3.m3.1b"><mi id="S3.SS1.p4.3.m3.1.1">k</mi><mo id="S3.SS1.p4.3.m3.1.2">∈</mo><mrow id="S3.SS1.p4.3.m3.1.3"><mo stretchy="false" id="S3.SS1.p4.3.m3.1.3.1">{</mo><mn id="S3.SS1.p4.3.m3.1.3.2">0</mn><mo id="S3.SS1.p4.3.m3.1.3.3">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.SS1.p4.3.m3.1.3.4">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.SS1.p4.3.m3.1.3.5">.</mo><mo id="S3.SS1.p4.3.m3.1.3.6">,</mo><mi id="S3.SS1.p4.3.m3.1.3.7">n</mi><mo id="S3.SS1.p4.3.m3.1.3.8">−</mo><mn id="S3.SS1.p4.3.m3.1.3.9">1</mn><mo stretchy="false" id="S3.SS1.p4.3.m3.1.3.10">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">k\in\{0,..,n-1\}</annotation></semantics></math> (<math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="\left[\nabla F_{e}\right]_{k}=\frac{\partial F_{e}}{\partial\theta_{k}}" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><mrow id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml"><msub id="S3.SS1.p4.4.m4.1.1.1" xref="S3.SS1.p4.4.m4.1.1.1.cmml"><mrow id="S3.SS1.p4.4.m4.1.1.1.1.1" xref="S3.SS1.p4.4.m4.1.1.1.1.2.cmml"><mo id="S3.SS1.p4.4.m4.1.1.1.1.1.2" xref="S3.SS1.p4.4.m4.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p4.4.m4.1.1.1.1.1.1" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS1.p4.4.m4.1.1.1.1.1.1.1" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.1.cmml">∇</mo><msub id="S3.SS1.p4.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.2" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.2.cmml">F</mi><mi id="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.3" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo id="S3.SS1.p4.4.m4.1.1.1.1.1.3" xref="S3.SS1.p4.4.m4.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.SS1.p4.4.m4.1.1.1.3" xref="S3.SS1.p4.4.m4.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.p4.4.m4.1.1.2" xref="S3.SS1.p4.4.m4.1.1.2.cmml">=</mo><mfrac id="S3.SS1.p4.4.m4.1.1.3" xref="S3.SS1.p4.4.m4.1.1.3.cmml"><mrow id="S3.SS1.p4.4.m4.1.1.3.2" xref="S3.SS1.p4.4.m4.1.1.3.2.cmml"><mo rspace="0em" id="S3.SS1.p4.4.m4.1.1.3.2.1" xref="S3.SS1.p4.4.m4.1.1.3.2.1.cmml">∂</mo><msub id="S3.SS1.p4.4.m4.1.1.3.2.2" xref="S3.SS1.p4.4.m4.1.1.3.2.2.cmml"><mi id="S3.SS1.p4.4.m4.1.1.3.2.2.2" xref="S3.SS1.p4.4.m4.1.1.3.2.2.2.cmml">F</mi><mi id="S3.SS1.p4.4.m4.1.1.3.2.2.3" xref="S3.SS1.p4.4.m4.1.1.3.2.2.3.cmml">e</mi></msub></mrow><mrow id="S3.SS1.p4.4.m4.1.1.3.3" xref="S3.SS1.p4.4.m4.1.1.3.3.cmml"><mo rspace="0em" id="S3.SS1.p4.4.m4.1.1.3.3.1" xref="S3.SS1.p4.4.m4.1.1.3.3.1.cmml">∂</mo><msub id="S3.SS1.p4.4.m4.1.1.3.3.2" xref="S3.SS1.p4.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS1.p4.4.m4.1.1.3.3.2.2" xref="S3.SS1.p4.4.m4.1.1.3.3.2.2.cmml">θ</mi><mi id="S3.SS1.p4.4.m4.1.1.3.3.2.3" xref="S3.SS1.p4.4.m4.1.1.3.3.2.3.cmml">k</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><apply id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1"><eq id="S3.SS1.p4.4.m4.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.2"></eq><apply id="S3.SS1.p4.4.m4.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.1">subscript</csymbol><apply id="S3.SS1.p4.4.m4.1.1.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p4.4.m4.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p4.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1"><ci id="S3.SS1.p4.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.1">∇</ci><apply id="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.2">𝐹</ci><ci id="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.1.2.3">𝑒</ci></apply></apply></apply><ci id="S3.SS1.p4.4.m4.1.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.p4.4.m4.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3"><divide id="S3.SS1.p4.4.m4.1.1.3.1.cmml" xref="S3.SS1.p4.4.m4.1.1.3"></divide><apply id="S3.SS1.p4.4.m4.1.1.3.2.cmml" xref="S3.SS1.p4.4.m4.1.1.3.2"><partialdiff id="S3.SS1.p4.4.m4.1.1.3.2.1.cmml" xref="S3.SS1.p4.4.m4.1.1.3.2.1"></partialdiff><apply id="S3.SS1.p4.4.m4.1.1.3.2.2.cmml" xref="S3.SS1.p4.4.m4.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.3.2.2.1.cmml" xref="S3.SS1.p4.4.m4.1.1.3.2.2">subscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.3.2.2.2.cmml" xref="S3.SS1.p4.4.m4.1.1.3.2.2.2">𝐹</ci><ci id="S3.SS1.p4.4.m4.1.1.3.2.2.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3.2.2.3">𝑒</ci></apply></apply><apply id="S3.SS1.p4.4.m4.1.1.3.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3"><partialdiff id="S3.SS1.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3.1"></partialdiff><apply id="S3.SS1.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p4.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3.2.2">𝜃</ci><ci id="S3.SS1.p4.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS1.p4.4.m4.1.1.3.3.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">\left[\nabla F_{e}\right]_{k}=\frac{\partial F_{e}}{\partial\theta_{k}}</annotation></semantics></math>).</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.4" class="ltx_p">For simplicity, let us denote <math id="S3.SS1.p5.1.m1.1" class="ltx_Math" alttext="\left[\nabla F_{e}\right]_{k}" display="inline"><semantics id="S3.SS1.p5.1.m1.1a"><msub id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml"><mrow id="S3.SS1.p5.1.m1.1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p5.1.m1.1.1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p5.1.m1.1.1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS1.p5.1.m1.1.1.1.1.1.1" xref="S3.SS1.p5.1.m1.1.1.1.1.1.1.cmml">∇</mo><msub id="S3.SS1.p5.1.m1.1.1.1.1.1.2" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p5.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2.2.cmml">F</mi><mi id="S3.SS1.p5.1.m1.1.1.1.1.1.2.3" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo id="S3.SS1.p5.1.m1.1.1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.SS1.p5.1.m1.1.1.3" xref="S3.SS1.p5.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><apply id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1">subscript</csymbol><apply id="S3.SS1.p5.1.m1.1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p5.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p5.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1"><ci id="S3.SS1.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1.1">∇</ci><apply id="S3.SS1.p5.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p5.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2.2">𝐹</ci><ci id="S3.SS1.p5.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p5.1.m1.1.1.1.1.1.2.3">𝑒</ci></apply></apply></apply><ci id="S3.SS1.p5.1.m1.1.1.3.cmml" xref="S3.SS1.p5.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">\left[\nabla F_{e}\right]_{k}</annotation></semantics></math> with <math id="S3.SS1.p5.2.m2.1" class="ltx_Math" alttext="G_{e}" display="inline"><semantics id="S3.SS1.p5.2.m2.1a"><msub id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml"><mi id="S3.SS1.p5.2.m2.1.1.2" xref="S3.SS1.p5.2.m2.1.1.2.cmml">G</mi><mi id="S3.SS1.p5.2.m2.1.1.3" xref="S3.SS1.p5.2.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><apply id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.2.m2.1.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p5.2.m2.1.1.2.cmml" xref="S3.SS1.p5.2.m2.1.1.2">𝐺</ci><ci id="S3.SS1.p5.2.m2.1.1.3.cmml" xref="S3.SS1.p5.2.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">G_{e}</annotation></semantics></math>. And let <math id="S3.SS1.p5.3.m3.2" class="ltx_Math" alttext="G=\{G_{e},e\in\mathcal{E}\}" display="inline"><semantics id="S3.SS1.p5.3.m3.2a"><mrow id="S3.SS1.p5.3.m3.2.2" xref="S3.SS1.p5.3.m3.2.2.cmml"><mi id="S3.SS1.p5.3.m3.2.2.3" xref="S3.SS1.p5.3.m3.2.2.3.cmml">G</mi><mo id="S3.SS1.p5.3.m3.2.2.2" xref="S3.SS1.p5.3.m3.2.2.2.cmml">=</mo><mrow id="S3.SS1.p5.3.m3.2.2.1.1" xref="S3.SS1.p5.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p5.3.m3.2.2.1.1.2" xref="S3.SS1.p5.3.m3.2.2.1.2.cmml">{</mo><mrow id="S3.SS1.p5.3.m3.2.2.1.1.1" xref="S3.SS1.p5.3.m3.2.2.1.1.1.cmml"><mrow id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.2.cmml"><msub id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.2" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.2.cmml">G</mi><mi id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.3" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.2" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.2.cmml">,</mo><mi id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml">e</mi></mrow><mo id="S3.SS1.p5.3.m3.2.2.1.1.1.2" xref="S3.SS1.p5.3.m3.2.2.1.1.1.2.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.3.m3.2.2.1.1.1.3" xref="S3.SS1.p5.3.m3.2.2.1.1.1.3.cmml">ℰ</mi></mrow><mo stretchy="false" id="S3.SS1.p5.3.m3.2.2.1.1.3" xref="S3.SS1.p5.3.m3.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.2b"><apply id="S3.SS1.p5.3.m3.2.2.cmml" xref="S3.SS1.p5.3.m3.2.2"><eq id="S3.SS1.p5.3.m3.2.2.2.cmml" xref="S3.SS1.p5.3.m3.2.2.2"></eq><ci id="S3.SS1.p5.3.m3.2.2.3.cmml" xref="S3.SS1.p5.3.m3.2.2.3">𝐺</ci><set id="S3.SS1.p5.3.m3.2.2.1.2.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1"><apply id="S3.SS1.p5.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1.1"><in id="S3.SS1.p5.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1.1.2"></in><list id="S3.SS1.p5.3.m3.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.1"><apply id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.2">𝐺</ci><ci id="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1.1.1.1.1.3">𝑒</ci></apply><ci id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">𝑒</ci></list><ci id="S3.SS1.p5.3.m3.2.2.1.1.1.3.cmml" xref="S3.SS1.p5.3.m3.2.2.1.1.1.3">ℰ</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.2c">G=\{G_{e},e\in\mathcal{E}\}</annotation></semantics></math>. We want to define the weighted geometric mean for <math id="S3.SS1.p5.4.m4.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS1.p5.4.m4.1a"><mi id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><ci id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">G</annotation></semantics></math>, by considering separately its positive and negative coordinates.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.2" class="ltx_p">Let <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{E}^{+}=\{e\in\mathcal{E},G_{e}\geq 0\}" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mrow id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml"><msup id="S3.SS1.p6.1.m1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.1.m1.1.1.3.2" xref="S3.SS1.p6.1.m1.1.1.3.2.cmml">ℰ</mi><mo id="S3.SS1.p6.1.m1.1.1.3.3" xref="S3.SS1.p6.1.m1.1.1.3.3.cmml">+</mo></msup><mo id="S3.SS1.p6.1.m1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS1.p6.1.m1.1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.1.m1.1.1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p6.1.m1.1.1.1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.1.1.1.3.cmml"><mrow id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.2.cmml">e</mi><mo id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.3.cmml">ℰ</mi></mrow><mo id="S3.SS1.p6.1.m1.1.1.1.1.1.2.3" xref="S3.SS1.p6.1.m1.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.cmml"><msub id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.2.cmml">G</mi><mi id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.3.cmml">e</mi></msub><mo id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.1" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.1.cmml">≥</mo><mn id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.3" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.3.cmml">0</mn></mrow></mrow><mo stretchy="false" id="S3.SS1.p6.1.m1.1.1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1"><eq id="S3.SS1.p6.1.m1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.2"></eq><apply id="S3.SS1.p6.1.m1.1.1.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.3.1.cmml" xref="S3.SS1.p6.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.3.2.cmml" xref="S3.SS1.p6.1.m1.1.1.3.2">ℰ</ci><plus id="S3.SS1.p6.1.m1.1.1.3.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3"></plus></apply><set id="S3.SS1.p6.1.m1.1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1"><apply id="S3.SS1.p6.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.1.1.1.3a.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.1"><in id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.1"></in><ci id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.2">𝑒</ci><ci id="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.1.1.3">ℰ</ci></apply><apply id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2"><geq id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.1"></geq><apply id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.2">𝐺</ci><ci id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.2.3">𝑒</ci></apply><cn type="integer" id="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p6.1.m1.1.1.1.1.1.2.2.3">0</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\mathcal{E}^{+}=\{e\in\mathcal{E},G_{e}\geq 0\}</annotation></semantics></math> , and <math id="S3.SS1.p6.2.m2.1" class="ltx_Math" alttext="\mathcal{E}^{-}=\{e\in\mathcal{E},G_{e}\leq 0\}" display="inline"><semantics id="S3.SS1.p6.2.m2.1a"><mrow id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml"><msup id="S3.SS1.p6.2.m2.1.1.3" xref="S3.SS1.p6.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.2.m2.1.1.3.2" xref="S3.SS1.p6.2.m2.1.1.3.2.cmml">ℰ</mi><mo id="S3.SS1.p6.2.m2.1.1.3.3" xref="S3.SS1.p6.2.m2.1.1.3.3.cmml">−</mo></msup><mo id="S3.SS1.p6.2.m2.1.1.2" xref="S3.SS1.p6.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS1.p6.2.m2.1.1.1.1" xref="S3.SS1.p6.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p6.2.m2.1.1.1.1.2" xref="S3.SS1.p6.2.m2.1.1.1.2.cmml">{</mo><mrow id="S3.SS1.p6.2.m2.1.1.1.1.1.2" xref="S3.SS1.p6.2.m2.1.1.1.1.1.3.cmml"><mrow id="S3.SS1.p6.2.m2.1.1.1.1.1.1.1" xref="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.2.cmml">e</mi><mo id="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.1" xref="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.3.cmml">ℰ</mi></mrow><mo id="S3.SS1.p6.2.m2.1.1.1.1.1.2.3" xref="S3.SS1.p6.2.m2.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.cmml"><msub id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.2" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.2.cmml">G</mi><mi id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.3.cmml">e</mi></msub><mo id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.1" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.1.cmml">≤</mo><mn id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.3" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.3.cmml">0</mn></mrow></mrow><mo stretchy="false" id="S3.SS1.p6.2.m2.1.1.1.1.3" xref="S3.SS1.p6.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><apply id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1"><eq id="S3.SS1.p6.2.m2.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.2"></eq><apply id="S3.SS1.p6.2.m2.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.3.1.cmml" xref="S3.SS1.p6.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p6.2.m2.1.1.3.2.cmml" xref="S3.SS1.p6.2.m2.1.1.3.2">ℰ</ci><minus id="S3.SS1.p6.2.m2.1.1.3.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3.3"></minus></apply><set id="S3.SS1.p6.2.m2.1.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1"><apply id="S3.SS1.p6.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.1.1.3a.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.1.1"><in id="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.1"></in><ci id="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.2">𝑒</ci><ci id="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.1.1.3">ℰ</ci></apply><apply id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2"><leq id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.1"></leq><apply id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.2">𝐺</ci><ci id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.2.3">𝑒</ci></apply><cn type="integer" id="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p6.2.m2.1.1.1.1.1.2.2.3">0</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">\mathcal{E}^{-}=\{e\in\mathcal{E},G_{e}\leq 0\}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p7" class="ltx_para">
<p id="S3.SS1.p7.1" class="ltx_p">The arithmetic mean of <math id="S3.SS1.p7.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS1.p7.1.m1.1a"><mi id="S3.SS1.p7.1.m1.1.1" xref="S3.SS1.p7.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><ci id="S3.SS1.p7.1.m1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">G</annotation></semantics></math> satisfies:</p>
</div>
<div id="S3.SS1.p8" class="ltx_para">
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.3" class="ltx_Math" alttext="arithmean(G)=\frac{\mathcal{E}^{+}}{\mathcal{E}}\frac{\sum_{e\in\mathcal{E^{+}}}\left|G_{e}\right|}{\mathcal{E}^{+}}-\frac{\mathcal{E}^{-}}{\mathcal{E}}\frac{\sum_{e\in\mathcal{E^{-}}}\left|G_{e}\right|}{\mathcal{E}^{-}}" display="block"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.4" xref="S3.Ex1.m1.3.4.cmml"><mrow id="S3.Ex1.m1.3.4.2" xref="S3.Ex1.m1.3.4.2.cmml"><mi id="S3.Ex1.m1.3.4.2.2" xref="S3.Ex1.m1.3.4.2.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mi id="S3.Ex1.m1.3.4.2.3" xref="S3.Ex1.m1.3.4.2.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1a" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mi id="S3.Ex1.m1.3.4.2.4" xref="S3.Ex1.m1.3.4.2.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1b" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mi id="S3.Ex1.m1.3.4.2.5" xref="S3.Ex1.m1.3.4.2.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1c" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mi id="S3.Ex1.m1.3.4.2.6" xref="S3.Ex1.m1.3.4.2.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1d" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mi id="S3.Ex1.m1.3.4.2.7" xref="S3.Ex1.m1.3.4.2.7.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1e" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mi id="S3.Ex1.m1.3.4.2.8" xref="S3.Ex1.m1.3.4.2.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1f" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mi id="S3.Ex1.m1.3.4.2.9" xref="S3.Ex1.m1.3.4.2.9.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1g" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mi id="S3.Ex1.m1.3.4.2.10" xref="S3.Ex1.m1.3.4.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.2.1h" xref="S3.Ex1.m1.3.4.2.1.cmml">​</mo><mrow id="S3.Ex1.m1.3.4.2.11.2" xref="S3.Ex1.m1.3.4.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.3.4.2.11.2.1" xref="S3.Ex1.m1.3.4.2.cmml">(</mo><mi id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml">G</mi><mo stretchy="false" id="S3.Ex1.m1.3.4.2.11.2.2" xref="S3.Ex1.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.3.4.1" xref="S3.Ex1.m1.3.4.1.cmml">=</mo><mrow id="S3.Ex1.m1.3.4.3" xref="S3.Ex1.m1.3.4.3.cmml"><mrow id="S3.Ex1.m1.3.4.3.2" xref="S3.Ex1.m1.3.4.3.2.cmml"><mfrac id="S3.Ex1.m1.3.4.3.2.2" xref="S3.Ex1.m1.3.4.3.2.2.cmml"><msup id="S3.Ex1.m1.3.4.3.2.2.2" xref="S3.Ex1.m1.3.4.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.3.4.3.2.2.2.2" xref="S3.Ex1.m1.3.4.3.2.2.2.2.cmml">ℰ</mi><mo id="S3.Ex1.m1.3.4.3.2.2.2.3" xref="S3.Ex1.m1.3.4.3.2.2.2.3.cmml">+</mo></msup><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.3.4.3.2.2.3" xref="S3.Ex1.m1.3.4.3.2.2.3.cmml">ℰ</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.3.2.1" xref="S3.Ex1.m1.3.4.3.2.1.cmml">​</mo><mfrac id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><msub id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.2.cmml"><mo id="S3.Ex1.m1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m1.1.1.1.2.3.2" xref="S3.Ex1.m1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.Ex1.m1.1.1.1.2.3.1" xref="S3.Ex1.m1.1.1.1.2.3.1.cmml">∈</mo><msup id="S3.Ex1.m1.1.1.1.2.3.3" xref="S3.Ex1.m1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.1.2.3.3.2" xref="S3.Ex1.m1.1.1.1.2.3.3.2.cmml">ℰ</mi><mo id="S3.Ex1.m1.1.1.1.2.3.3.3" xref="S3.Ex1.m1.1.1.1.2.3.3.3.cmml">+</mo></msup></mrow></msub><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.2.cmml"><mo lspace="0em" id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml">G</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><msup id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml">ℰ</mi><mo id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml">+</mo></msup></mfrac></mrow><mo id="S3.Ex1.m1.3.4.3.1" xref="S3.Ex1.m1.3.4.3.1.cmml">−</mo><mrow id="S3.Ex1.m1.3.4.3.3" xref="S3.Ex1.m1.3.4.3.3.cmml"><mfrac id="S3.Ex1.m1.3.4.3.3.2" xref="S3.Ex1.m1.3.4.3.3.2.cmml"><msup id="S3.Ex1.m1.3.4.3.3.2.2" xref="S3.Ex1.m1.3.4.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.3.4.3.3.2.2.2" xref="S3.Ex1.m1.3.4.3.3.2.2.2.cmml">ℰ</mi><mo id="S3.Ex1.m1.3.4.3.3.2.2.3" xref="S3.Ex1.m1.3.4.3.3.2.2.3.cmml">−</mo></msup><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.3.4.3.3.2.3" xref="S3.Ex1.m1.3.4.3.3.2.3.cmml">ℰ</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.3.4.3.3.1" xref="S3.Ex1.m1.3.4.3.3.1.cmml">​</mo><mfrac id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml"><mrow id="S3.Ex1.m1.2.2.1" xref="S3.Ex1.m1.2.2.1.cmml"><msub id="S3.Ex1.m1.2.2.1.2" xref="S3.Ex1.m1.2.2.1.2.cmml"><mo id="S3.Ex1.m1.2.2.1.2.2" xref="S3.Ex1.m1.2.2.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.2.2.1.2.3" xref="S3.Ex1.m1.2.2.1.2.3.cmml"><mi id="S3.Ex1.m1.2.2.1.2.3.2" xref="S3.Ex1.m1.2.2.1.2.3.2.cmml">e</mi><mo id="S3.Ex1.m1.2.2.1.2.3.1" xref="S3.Ex1.m1.2.2.1.2.3.1.cmml">∈</mo><msup id="S3.Ex1.m1.2.2.1.2.3.3" xref="S3.Ex1.m1.2.2.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.2.2.1.2.3.3.2" xref="S3.Ex1.m1.2.2.1.2.3.3.2.cmml">ℰ</mi><mo id="S3.Ex1.m1.2.2.1.2.3.3.3" xref="S3.Ex1.m1.2.2.1.2.3.3.3.cmml">−</mo></msup></mrow></msub><mrow id="S3.Ex1.m1.2.2.1.1.1" xref="S3.Ex1.m1.2.2.1.1.2.cmml"><mo lspace="0em" id="S3.Ex1.m1.2.2.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.2.1.cmml">|</mo><msub id="S3.Ex1.m1.2.2.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml">G</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.Ex1.m1.2.2.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.2.1.cmml">|</mo></mrow></mrow><msup id="S3.Ex1.m1.2.2.3" xref="S3.Ex1.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.2.2.3.2" xref="S3.Ex1.m1.2.2.3.2.cmml">ℰ</mi><mo id="S3.Ex1.m1.2.2.3.3" xref="S3.Ex1.m1.2.2.3.3.cmml">−</mo></msup></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.4.cmml" xref="S3.Ex1.m1.3.4"><eq id="S3.Ex1.m1.3.4.1.cmml" xref="S3.Ex1.m1.3.4.1"></eq><apply id="S3.Ex1.m1.3.4.2.cmml" xref="S3.Ex1.m1.3.4.2"><times id="S3.Ex1.m1.3.4.2.1.cmml" xref="S3.Ex1.m1.3.4.2.1"></times><ci id="S3.Ex1.m1.3.4.2.2.cmml" xref="S3.Ex1.m1.3.4.2.2">𝑎</ci><ci id="S3.Ex1.m1.3.4.2.3.cmml" xref="S3.Ex1.m1.3.4.2.3">𝑟</ci><ci id="S3.Ex1.m1.3.4.2.4.cmml" xref="S3.Ex1.m1.3.4.2.4">𝑖</ci><ci id="S3.Ex1.m1.3.4.2.5.cmml" xref="S3.Ex1.m1.3.4.2.5">𝑡</ci><ci id="S3.Ex1.m1.3.4.2.6.cmml" xref="S3.Ex1.m1.3.4.2.6">ℎ</ci><ci id="S3.Ex1.m1.3.4.2.7.cmml" xref="S3.Ex1.m1.3.4.2.7">𝑚</ci><ci id="S3.Ex1.m1.3.4.2.8.cmml" xref="S3.Ex1.m1.3.4.2.8">𝑒</ci><ci id="S3.Ex1.m1.3.4.2.9.cmml" xref="S3.Ex1.m1.3.4.2.9">𝑎</ci><ci id="S3.Ex1.m1.3.4.2.10.cmml" xref="S3.Ex1.m1.3.4.2.10">𝑛</ci><ci id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3">𝐺</ci></apply><apply id="S3.Ex1.m1.3.4.3.cmml" xref="S3.Ex1.m1.3.4.3"><minus id="S3.Ex1.m1.3.4.3.1.cmml" xref="S3.Ex1.m1.3.4.3.1"></minus><apply id="S3.Ex1.m1.3.4.3.2.cmml" xref="S3.Ex1.m1.3.4.3.2"><times id="S3.Ex1.m1.3.4.3.2.1.cmml" xref="S3.Ex1.m1.3.4.3.2.1"></times><apply id="S3.Ex1.m1.3.4.3.2.2.cmml" xref="S3.Ex1.m1.3.4.3.2.2"><divide id="S3.Ex1.m1.3.4.3.2.2.1.cmml" xref="S3.Ex1.m1.3.4.3.2.2"></divide><apply id="S3.Ex1.m1.3.4.3.2.2.2.cmml" xref="S3.Ex1.m1.3.4.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.4.3.2.2.2.1.cmml" xref="S3.Ex1.m1.3.4.3.2.2.2">superscript</csymbol><ci id="S3.Ex1.m1.3.4.3.2.2.2.2.cmml" xref="S3.Ex1.m1.3.4.3.2.2.2.2">ℰ</ci><plus id="S3.Ex1.m1.3.4.3.2.2.2.3.cmml" xref="S3.Ex1.m1.3.4.3.2.2.2.3"></plus></apply><ci id="S3.Ex1.m1.3.4.3.2.2.3.cmml" xref="S3.Ex1.m1.3.4.3.2.2.3">ℰ</ci></apply><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><divide id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1"></divide><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><apply id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1.m1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.2.2"></sum><apply id="S3.Ex1.m1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.2.3"><in id="S3.Ex1.m1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m1.1.1.1.2.3.1"></in><ci id="S3.Ex1.m1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m1.1.1.1.2.3.2">𝑒</ci><apply id="S3.Ex1.m1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.2.3.3.1.cmml" xref="S3.Ex1.m1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.2.3.3.2.cmml" xref="S3.Ex1.m1.1.1.1.2.3.3.2">ℰ</ci><plus id="S3.Ex1.m1.1.1.1.2.3.3.3.cmml" xref="S3.Ex1.m1.1.1.1.2.3.3.3"></plus></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><abs id="S3.Ex1.m1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.2"></abs><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2">𝐺</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">𝑒</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2">ℰ</ci><plus id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3"></plus></apply></apply></apply><apply id="S3.Ex1.m1.3.4.3.3.cmml" xref="S3.Ex1.m1.3.4.3.3"><times id="S3.Ex1.m1.3.4.3.3.1.cmml" xref="S3.Ex1.m1.3.4.3.3.1"></times><apply id="S3.Ex1.m1.3.4.3.3.2.cmml" xref="S3.Ex1.m1.3.4.3.3.2"><divide id="S3.Ex1.m1.3.4.3.3.2.1.cmml" xref="S3.Ex1.m1.3.4.3.3.2"></divide><apply id="S3.Ex1.m1.3.4.3.3.2.2.cmml" xref="S3.Ex1.m1.3.4.3.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.4.3.3.2.2.1.cmml" xref="S3.Ex1.m1.3.4.3.3.2.2">superscript</csymbol><ci id="S3.Ex1.m1.3.4.3.3.2.2.2.cmml" xref="S3.Ex1.m1.3.4.3.3.2.2.2">ℰ</ci><minus id="S3.Ex1.m1.3.4.3.3.2.2.3.cmml" xref="S3.Ex1.m1.3.4.3.3.2.2.3"></minus></apply><ci id="S3.Ex1.m1.3.4.3.3.2.3.cmml" xref="S3.Ex1.m1.3.4.3.3.2.3">ℰ</ci></apply><apply id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2"><divide id="S3.Ex1.m1.2.2.2.cmml" xref="S3.Ex1.m1.2.2"></divide><apply id="S3.Ex1.m1.2.2.1.cmml" xref="S3.Ex1.m1.2.2.1"><apply id="S3.Ex1.m1.2.2.1.2.cmml" xref="S3.Ex1.m1.2.2.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.2">subscript</csymbol><sum id="S3.Ex1.m1.2.2.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.2.2"></sum><apply id="S3.Ex1.m1.2.2.1.2.3.cmml" xref="S3.Ex1.m1.2.2.1.2.3"><in id="S3.Ex1.m1.2.2.1.2.3.1.cmml" xref="S3.Ex1.m1.2.2.1.2.3.1"></in><ci id="S3.Ex1.m1.2.2.1.2.3.2.cmml" xref="S3.Ex1.m1.2.2.1.2.3.2">𝑒</ci><apply id="S3.Ex1.m1.2.2.1.2.3.3.cmml" xref="S3.Ex1.m1.2.2.1.2.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.2.3.3.1.cmml" xref="S3.Ex1.m1.2.2.1.2.3.3">superscript</csymbol><ci id="S3.Ex1.m1.2.2.1.2.3.3.2.cmml" xref="S3.Ex1.m1.2.2.1.2.3.3.2">ℰ</ci><minus id="S3.Ex1.m1.2.2.1.2.3.3.3.cmml" xref="S3.Ex1.m1.2.2.1.2.3.3.3"></minus></apply></apply></apply><apply id="S3.Ex1.m1.2.2.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1"><abs id="S3.Ex1.m1.2.2.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2"></abs><apply id="S3.Ex1.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2">𝐺</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.3">𝑒</ci></apply></apply></apply><apply id="S3.Ex1.m1.2.2.3.cmml" xref="S3.Ex1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.3.1.cmml" xref="S3.Ex1.m1.2.2.3">superscript</csymbol><ci id="S3.Ex1.m1.2.2.3.2.cmml" xref="S3.Ex1.m1.2.2.3.2">ℰ</ci><minus id="S3.Ex1.m1.2.2.3.3.cmml" xref="S3.Ex1.m1.2.2.3.3"></minus></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">arithmean(G)=\frac{\mathcal{E}^{+}}{\mathcal{E}}\frac{\sum_{e\in\mathcal{E^{+}}}\left|G_{e}\right|}{\mathcal{E}^{+}}-\frac{\mathcal{E}^{-}}{\mathcal{E}}\frac{\sum_{e\in\mathcal{E^{-}}}\left|G_{e}\right|}{\mathcal{E}^{-}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p9" class="ltx_para">
<p id="S3.SS1.p9.1" class="ltx_p">Similarly, We define the weighted geometric mean of <math id="S3.SS1.p9.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS1.p9.1.m1.1a"><mi id="S3.SS1.p9.1.m1.1.1" xref="S3.SS1.p9.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.1.m1.1b"><ci id="S3.SS1.p9.1.m1.1.1.cmml" xref="S3.SS1.p9.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.1.m1.1c">G</annotation></semantics></math> as :</p>
</div>
<div id="S3.SS1.p10" class="ltx_para">
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1.3" class="ltx_Math" alttext="weightedgeo(G)=\frac{\mathcal{E}^{+}}{\mathcal{E}}\left(\prod_{e\in\mathcal{E^{+}}}\left|G_{e}\right|\right)^{\frac{1}{\mathcal{E}^{+}}}-\frac{\mathcal{E}^{-}}{\mathcal{E}}\left(\prod_{e\in\mathcal{E^{-}}}\left|G_{e}\right|\right)^{\frac{1}{\mathcal{E}^{-}}}" display="block"><semantics id="S3.Ex2.m1.3a"><mrow id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml"><mrow id="S3.Ex2.m1.3.3.4" xref="S3.Ex2.m1.3.3.4.cmml"><mi id="S3.Ex2.m1.3.3.4.2" xref="S3.Ex2.m1.3.3.4.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.3" xref="S3.Ex2.m1.3.3.4.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1a" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.4" xref="S3.Ex2.m1.3.3.4.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1b" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.5" xref="S3.Ex2.m1.3.3.4.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1c" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.6" xref="S3.Ex2.m1.3.3.4.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1d" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.7" xref="S3.Ex2.m1.3.3.4.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1e" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.8" xref="S3.Ex2.m1.3.3.4.8.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1f" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.9" xref="S3.Ex2.m1.3.3.4.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1g" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.10" xref="S3.Ex2.m1.3.3.4.10.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1h" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.11" xref="S3.Ex2.m1.3.3.4.11.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1i" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mi id="S3.Ex2.m1.3.3.4.12" xref="S3.Ex2.m1.3.3.4.12.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.4.1j" xref="S3.Ex2.m1.3.3.4.1.cmml">​</mo><mrow id="S3.Ex2.m1.3.3.4.13.2" xref="S3.Ex2.m1.3.3.4.cmml"><mo stretchy="false" id="S3.Ex2.m1.3.3.4.13.2.1" xref="S3.Ex2.m1.3.3.4.cmml">(</mo><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">G</mi><mo stretchy="false" id="S3.Ex2.m1.3.3.4.13.2.2" xref="S3.Ex2.m1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.3.3.3" xref="S3.Ex2.m1.3.3.3.cmml">=</mo><mrow id="S3.Ex2.m1.3.3.2" xref="S3.Ex2.m1.3.3.2.cmml"><mrow id="S3.Ex2.m1.2.2.1.1" xref="S3.Ex2.m1.2.2.1.1.cmml"><mfrac id="S3.Ex2.m1.2.2.1.1.3" xref="S3.Ex2.m1.2.2.1.1.3.cmml"><msup id="S3.Ex2.m1.2.2.1.1.3.2" xref="S3.Ex2.m1.2.2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.2.2.1.1.3.2.2" xref="S3.Ex2.m1.2.2.1.1.3.2.2.cmml">ℰ</mi><mo id="S3.Ex2.m1.2.2.1.1.3.2.3" xref="S3.Ex2.m1.2.2.1.1.3.2.3.cmml">+</mo></msup><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.2.2.1.1.3.3" xref="S3.Ex2.m1.2.2.1.1.3.3.cmml">ℰ</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.2.2.1.1.2" xref="S3.Ex2.m1.2.2.1.1.2.cmml">​</mo><msup id="S3.Ex2.m1.2.2.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.cmml"><mrow id="S3.Ex2.m1.2.2.1.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.2.2.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.cmml"><munder id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.1.cmml">∈</mo><msup id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.2.cmml">ℰ</mi><mo id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.3.cmml">+</mo></msup></mrow></munder><mrow id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">G</mi><mi id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.Ex2.m1.2.2.1.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mfrac id="S3.Ex2.m1.2.2.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.3.cmml"><mn id="S3.Ex2.m1.2.2.1.1.1.3.2" xref="S3.Ex2.m1.2.2.1.1.1.3.2.cmml">1</mn><msup id="S3.Ex2.m1.2.2.1.1.1.3.3" xref="S3.Ex2.m1.2.2.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.2.2.1.1.1.3.3.2" xref="S3.Ex2.m1.2.2.1.1.1.3.3.2.cmml">ℰ</mi><mo id="S3.Ex2.m1.2.2.1.1.1.3.3.3" xref="S3.Ex2.m1.2.2.1.1.1.3.3.3.cmml">+</mo></msup></mfrac></msup></mrow><mo id="S3.Ex2.m1.3.3.2.3" xref="S3.Ex2.m1.3.3.2.3.cmml">−</mo><mrow id="S3.Ex2.m1.3.3.2.2" xref="S3.Ex2.m1.3.3.2.2.cmml"><mfrac id="S3.Ex2.m1.3.3.2.2.3" xref="S3.Ex2.m1.3.3.2.2.3.cmml"><msup id="S3.Ex2.m1.3.3.2.2.3.2" xref="S3.Ex2.m1.3.3.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.3.3.2.2.3.2.2" xref="S3.Ex2.m1.3.3.2.2.3.2.2.cmml">ℰ</mi><mo id="S3.Ex2.m1.3.3.2.2.3.2.3" xref="S3.Ex2.m1.3.3.2.2.3.2.3.cmml">−</mo></msup><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.3.3.2.2.3.3" xref="S3.Ex2.m1.3.3.2.2.3.3.cmml">ℰ</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.3.3.2.2.2" xref="S3.Ex2.m1.3.3.2.2.2.cmml">​</mo><msup id="S3.Ex2.m1.3.3.2.2.1" xref="S3.Ex2.m1.3.3.2.2.1.cmml"><mrow id="S3.Ex2.m1.3.3.2.2.1.1.1" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.cmml"><mo id="S3.Ex2.m1.3.3.2.2.1.1.1.2" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.3.3.2.2.1.1.1.1" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.cmml"><munder id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.2" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.cmml"><mi id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.2" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.1" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.1.cmml">∈</mo><msup id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.2" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.2.cmml">ℰ</mi><mo id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.3" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.3.cmml">−</mo></msup></mrow></munder><mrow id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.2.cmml"><mo id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.2" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml">G</mi><mi id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.3" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.Ex2.m1.3.3.2.2.1.1.1.3" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow><mfrac id="S3.Ex2.m1.3.3.2.2.1.3" xref="S3.Ex2.m1.3.3.2.2.1.3.cmml"><mn id="S3.Ex2.m1.3.3.2.2.1.3.2" xref="S3.Ex2.m1.3.3.2.2.1.3.2.cmml">1</mn><msup id="S3.Ex2.m1.3.3.2.2.1.3.3" xref="S3.Ex2.m1.3.3.2.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.3.3.2.2.1.3.3.2" xref="S3.Ex2.m1.3.3.2.2.1.3.3.2.cmml">ℰ</mi><mo id="S3.Ex2.m1.3.3.2.2.1.3.3.3" xref="S3.Ex2.m1.3.3.2.2.1.3.3.3.cmml">−</mo></msup></mfrac></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.3b"><apply id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3"><eq id="S3.Ex2.m1.3.3.3.cmml" xref="S3.Ex2.m1.3.3.3"></eq><apply id="S3.Ex2.m1.3.3.4.cmml" xref="S3.Ex2.m1.3.3.4"><times id="S3.Ex2.m1.3.3.4.1.cmml" xref="S3.Ex2.m1.3.3.4.1"></times><ci id="S3.Ex2.m1.3.3.4.2.cmml" xref="S3.Ex2.m1.3.3.4.2">𝑤</ci><ci id="S3.Ex2.m1.3.3.4.3.cmml" xref="S3.Ex2.m1.3.3.4.3">𝑒</ci><ci id="S3.Ex2.m1.3.3.4.4.cmml" xref="S3.Ex2.m1.3.3.4.4">𝑖</ci><ci id="S3.Ex2.m1.3.3.4.5.cmml" xref="S3.Ex2.m1.3.3.4.5">𝑔</ci><ci id="S3.Ex2.m1.3.3.4.6.cmml" xref="S3.Ex2.m1.3.3.4.6">ℎ</ci><ci id="S3.Ex2.m1.3.3.4.7.cmml" xref="S3.Ex2.m1.3.3.4.7">𝑡</ci><ci id="S3.Ex2.m1.3.3.4.8.cmml" xref="S3.Ex2.m1.3.3.4.8">𝑒</ci><ci id="S3.Ex2.m1.3.3.4.9.cmml" xref="S3.Ex2.m1.3.3.4.9">𝑑</ci><ci id="S3.Ex2.m1.3.3.4.10.cmml" xref="S3.Ex2.m1.3.3.4.10">𝑔</ci><ci id="S3.Ex2.m1.3.3.4.11.cmml" xref="S3.Ex2.m1.3.3.4.11">𝑒</ci><ci id="S3.Ex2.m1.3.3.4.12.cmml" xref="S3.Ex2.m1.3.3.4.12">𝑜</ci><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝐺</ci></apply><apply id="S3.Ex2.m1.3.3.2.cmml" xref="S3.Ex2.m1.3.3.2"><minus id="S3.Ex2.m1.3.3.2.3.cmml" xref="S3.Ex2.m1.3.3.2.3"></minus><apply id="S3.Ex2.m1.2.2.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1"><times id="S3.Ex2.m1.2.2.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.2"></times><apply id="S3.Ex2.m1.2.2.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3"><divide id="S3.Ex2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.3"></divide><apply id="S3.Ex2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.3.2.1.cmml" xref="S3.Ex2.m1.2.2.1.1.3.2">superscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.3.2.2.cmml" xref="S3.Ex2.m1.2.2.1.1.3.2.2">ℰ</ci><plus id="S3.Ex2.m1.2.2.1.1.3.2.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3.2.3"></plus></apply><ci id="S3.Ex2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3">ℰ</ci></apply><apply id="S3.Ex2.m1.2.2.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.Ex2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1"><apply id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.2">product</csymbol><apply id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3"><in id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.1"></in><ci id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.2">𝑒</ci><apply id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.2">ℰ</ci><plus id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.2.3.3.3"></plus></apply></apply></apply><apply id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1"><abs id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.2"></abs><apply id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝐺</ci><ci id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑒</ci></apply></apply></apply><apply id="S3.Ex2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3"><divide id="S3.Ex2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3"></divide><cn type="integer" id="S3.Ex2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3.2">1</cn><apply id="S3.Ex2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3.3">superscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3.3.2">ℰ</ci><plus id="S3.Ex2.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3.3.3"></plus></apply></apply></apply></apply><apply id="S3.Ex2.m1.3.3.2.2.cmml" xref="S3.Ex2.m1.3.3.2.2"><times id="S3.Ex2.m1.3.3.2.2.2.cmml" xref="S3.Ex2.m1.3.3.2.2.2"></times><apply id="S3.Ex2.m1.3.3.2.2.3.cmml" xref="S3.Ex2.m1.3.3.2.2.3"><divide id="S3.Ex2.m1.3.3.2.2.3.1.cmml" xref="S3.Ex2.m1.3.3.2.2.3"></divide><apply id="S3.Ex2.m1.3.3.2.2.3.2.cmml" xref="S3.Ex2.m1.3.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.2.2.3.2.1.cmml" xref="S3.Ex2.m1.3.3.2.2.3.2">superscript</csymbol><ci id="S3.Ex2.m1.3.3.2.2.3.2.2.cmml" xref="S3.Ex2.m1.3.3.2.2.3.2.2">ℰ</ci><minus id="S3.Ex2.m1.3.3.2.2.3.2.3.cmml" xref="S3.Ex2.m1.3.3.2.2.3.2.3"></minus></apply><ci id="S3.Ex2.m1.3.3.2.2.3.3.cmml" xref="S3.Ex2.m1.3.3.2.2.3.3">ℰ</ci></apply><apply id="S3.Ex2.m1.3.3.2.2.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.2.2.1.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1">superscript</csymbol><apply id="S3.Ex2.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1"><apply id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.2">product</csymbol><apply id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3"><in id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.1"></in><ci id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.2">𝑒</ci><apply id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.2">ℰ</ci><minus id="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.3.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.2.3.3.3"></minus></apply></apply></apply><apply id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1"><abs id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.2"></abs><apply id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.2">𝐺</ci><ci id="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.3">𝑒</ci></apply></apply></apply><apply id="S3.Ex2.m1.3.3.2.2.1.3.cmml" xref="S3.Ex2.m1.3.3.2.2.1.3"><divide id="S3.Ex2.m1.3.3.2.2.1.3.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.3"></divide><cn type="integer" id="S3.Ex2.m1.3.3.2.2.1.3.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1.3.2">1</cn><apply id="S3.Ex2.m1.3.3.2.2.1.3.3.cmml" xref="S3.Ex2.m1.3.3.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.2.2.1.3.3.1.cmml" xref="S3.Ex2.m1.3.3.2.2.1.3.3">superscript</csymbol><ci id="S3.Ex2.m1.3.3.2.2.1.3.3.2.cmml" xref="S3.Ex2.m1.3.3.2.2.1.3.3.2">ℰ</ci><minus id="S3.Ex2.m1.3.3.2.2.1.3.3.3.cmml" xref="S3.Ex2.m1.3.3.2.2.1.3.3.3"></minus></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.3c">weightedgeo(G)=\frac{\mathcal{E}^{+}}{\mathcal{E}}\left(\prod_{e\in\mathcal{E^{+}}}\left|G_{e}\right|\right)^{\frac{1}{\mathcal{E}^{+}}}-\frac{\mathcal{E}^{-}}{\mathcal{E}}\left(\prod_{e\in\mathcal{E^{-}}}\left|G_{e}\right|\right)^{\frac{1}{\mathcal{E}^{-}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p11" class="ltx_para">
<p id="S3.SS1.p11.1" class="ltx_p">This definition allows us to circumvent the problem of sign inconsistency for geometric mean.</p>
</div>
<div id="S3.SS1.p12" class="ltx_para">
<p id="S3.SS1.p12.1" class="ltx_p">Therefore, the weighted geometric mean of the gradient <math id="S3.SS1.p12.1.m1.1" class="ltx_Math" alttext="\left[\nabla^{\wedge}F\right]_{k}" display="inline"><semantics id="S3.SS1.p12.1.m1.1a"><msub id="S3.SS1.p12.1.m1.1.1" xref="S3.SS1.p12.1.m1.1.1.cmml"><mrow id="S3.SS1.p12.1.m1.1.1.1.1" xref="S3.SS1.p12.1.m1.1.1.1.2.cmml"><mo id="S3.SS1.p12.1.m1.1.1.1.1.2" xref="S3.SS1.p12.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p12.1.m1.1.1.1.1.1" xref="S3.SS1.p12.1.m1.1.1.1.1.1.cmml"><msup id="S3.SS1.p12.1.m1.1.1.1.1.1.1" xref="S3.SS1.p12.1.m1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS1.p12.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p12.1.m1.1.1.1.1.1.1.2.cmml">∇</mo><mo id="S3.SS1.p12.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p12.1.m1.1.1.1.1.1.1.3.cmml">∧</mo></msup><mi id="S3.SS1.p12.1.m1.1.1.1.1.1.2" xref="S3.SS1.p12.1.m1.1.1.1.1.1.2.cmml">F</mi></mrow><mo id="S3.SS1.p12.1.m1.1.1.1.1.3" xref="S3.SS1.p12.1.m1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.SS1.p12.1.m1.1.1.3" xref="S3.SS1.p12.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p12.1.m1.1b"><apply id="S3.SS1.p12.1.m1.1.1.cmml" xref="S3.SS1.p12.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p12.1.m1.1.1.2.cmml" xref="S3.SS1.p12.1.m1.1.1">subscript</csymbol><apply id="S3.SS1.p12.1.m1.1.1.1.2.cmml" xref="S3.SS1.p12.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p12.1.m1.1.1.1.2.1.cmml" xref="S3.SS1.p12.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p12.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p12.1.m1.1.1.1.1.1"><apply id="S3.SS1.p12.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p12.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p12.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p12.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p12.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p12.1.m1.1.1.1.1.1.1.2">∇</ci><and id="S3.SS1.p12.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p12.1.m1.1.1.1.1.1.1.3"></and></apply><ci id="S3.SS1.p12.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p12.1.m1.1.1.1.1.1.2">𝐹</ci></apply></apply><ci id="S3.SS1.p12.1.m1.1.1.3.cmml" xref="S3.SS1.p12.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p12.1.m1.1c">\left[\nabla^{\wedge}F\right]_{k}</annotation></semantics></math> for the k-th parameter of the global model is calculated as follows:</p>
</div>
<div id="S3.SS1.p13" class="ltx_para">
<table id="S3.Ex3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex3.m1.3" class="ltx_Math" alttext="\left[\nabla^{\wedge}F\right]_{k}=\frac{\mathcal{E}^{+}}{\mathcal{E}}\left(\prod_{e\in\mathcal{E^{+}}}\left|\left[\nabla F_{e}\right]_{k}\right|\right)^{\frac{1}{\mathcal{E}^{+}}}-\frac{\mathcal{E}^{-}}{\mathcal{E}}\left(\prod_{e\in\mathcal{E^{-}}}\left|\left[\nabla F_{e}\right]_{k}\right|\right)^{\frac{1}{\mathcal{E}^{-}}}" display="block"><semantics id="S3.Ex3.m1.3a"><mrow id="S3.Ex3.m1.3.3" xref="S3.Ex3.m1.3.3.cmml"><msub id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.2.cmml"><mo id="S3.Ex3.m1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><msup id="S3.Ex3.m1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.Ex3.m1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.2.cmml">∇</mo><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.3.cmml">∧</mo></msup><mi id="S3.Ex3.m1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.cmml">F</mi></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml">k</mi></msub><mo id="S3.Ex3.m1.3.3.4" xref="S3.Ex3.m1.3.3.4.cmml">=</mo><mrow id="S3.Ex3.m1.3.3.3" xref="S3.Ex3.m1.3.3.3.cmml"><mrow id="S3.Ex3.m1.2.2.2.1" xref="S3.Ex3.m1.2.2.2.1.cmml"><mfrac id="S3.Ex3.m1.2.2.2.1.3" xref="S3.Ex3.m1.2.2.2.1.3.cmml"><msup id="S3.Ex3.m1.2.2.2.1.3.2" xref="S3.Ex3.m1.2.2.2.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.2.2.2.1.3.2.2" xref="S3.Ex3.m1.2.2.2.1.3.2.2.cmml">ℰ</mi><mo id="S3.Ex3.m1.2.2.2.1.3.2.3" xref="S3.Ex3.m1.2.2.2.1.3.2.3.cmml">+</mo></msup><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.2.2.2.1.3.3" xref="S3.Ex3.m1.2.2.2.1.3.3.cmml">ℰ</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.2.2.2.1.2" xref="S3.Ex3.m1.2.2.2.1.2.cmml">​</mo><msup id="S3.Ex3.m1.2.2.2.1.1" xref="S3.Ex3.m1.2.2.2.1.1.cmml"><mrow id="S3.Ex3.m1.2.2.2.1.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.2.2.2.1.1.1.1.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.2.2.2.1.1.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.cmml"><munder id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.1.cmml">∈</mo><msup id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.2.cmml">ℰ</mi><mo id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.3" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.3.cmml">+</mo></msup></mrow></munder><mrow id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">∇</mo><msub id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">F</mi><mi id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.Ex3.m1.2.2.2.1.1.1.1.3" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mfrac id="S3.Ex3.m1.2.2.2.1.1.3" xref="S3.Ex3.m1.2.2.2.1.1.3.cmml"><mn id="S3.Ex3.m1.2.2.2.1.1.3.2" xref="S3.Ex3.m1.2.2.2.1.1.3.2.cmml">1</mn><msup id="S3.Ex3.m1.2.2.2.1.1.3.3" xref="S3.Ex3.m1.2.2.2.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.2.2.2.1.1.3.3.2" xref="S3.Ex3.m1.2.2.2.1.1.3.3.2.cmml">ℰ</mi><mo id="S3.Ex3.m1.2.2.2.1.1.3.3.3" xref="S3.Ex3.m1.2.2.2.1.1.3.3.3.cmml">+</mo></msup></mfrac></msup></mrow><mo id="S3.Ex3.m1.3.3.3.3" xref="S3.Ex3.m1.3.3.3.3.cmml">−</mo><mrow id="S3.Ex3.m1.3.3.3.2" xref="S3.Ex3.m1.3.3.3.2.cmml"><mfrac id="S3.Ex3.m1.3.3.3.2.3" xref="S3.Ex3.m1.3.3.3.2.3.cmml"><msup id="S3.Ex3.m1.3.3.3.2.3.2" xref="S3.Ex3.m1.3.3.3.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.3.3.3.2.3.2.2" xref="S3.Ex3.m1.3.3.3.2.3.2.2.cmml">ℰ</mi><mo id="S3.Ex3.m1.3.3.3.2.3.2.3" xref="S3.Ex3.m1.3.3.3.2.3.2.3.cmml">−</mo></msup><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.3.3.3.2.3.3" xref="S3.Ex3.m1.3.3.3.2.3.3.cmml">ℰ</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex3.m1.3.3.3.2.2" xref="S3.Ex3.m1.3.3.3.2.2.cmml">​</mo><msup id="S3.Ex3.m1.3.3.3.2.1" xref="S3.Ex3.m1.3.3.3.2.1.cmml"><mrow id="S3.Ex3.m1.3.3.3.2.1.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.cmml"><mo id="S3.Ex3.m1.3.3.3.2.1.1.1.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.3.3.3.2.1.1.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.cmml"><munder id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.cmml"><mi id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.2.cmml">e</mi><mo id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.1.cmml">∈</mo><msup id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.2.cmml">ℰ</mi><mo id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.3" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.3.cmml">−</mo></msup></mrow></munder><mrow id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.2.cmml"><mo id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.1.cmml">∇</mo><msub id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">F</mi><mi id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.3" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S3.Ex3.m1.3.3.3.2.1.1.1.3" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.cmml">)</mo></mrow><mfrac id="S3.Ex3.m1.3.3.3.2.1.3" xref="S3.Ex3.m1.3.3.3.2.1.3.cmml"><mn id="S3.Ex3.m1.3.3.3.2.1.3.2" xref="S3.Ex3.m1.3.3.3.2.1.3.2.cmml">1</mn><msup id="S3.Ex3.m1.3.3.3.2.1.3.3" xref="S3.Ex3.m1.3.3.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.3.3.3.2.1.3.3.2" xref="S3.Ex3.m1.3.3.3.2.1.3.3.2.cmml">ℰ</mi><mo id="S3.Ex3.m1.3.3.3.2.1.3.3.3" xref="S3.Ex3.m1.3.3.3.2.1.3.3.3.cmml">−</mo></msup></mfrac></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.3b"><apply id="S3.Ex3.m1.3.3.cmml" xref="S3.Ex3.m1.3.3"><eq id="S3.Ex3.m1.3.3.4.cmml" xref="S3.Ex3.m1.3.3.4"></eq><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1">subscript</csymbol><apply id="S3.Ex3.m1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1"><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.2">∇</ci><and id="S3.Ex3.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.3"></and></apply><ci id="S3.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2">𝐹</ci></apply></apply><ci id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3">𝑘</ci></apply><apply id="S3.Ex3.m1.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3"><minus id="S3.Ex3.m1.3.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3.3"></minus><apply id="S3.Ex3.m1.2.2.2.1.cmml" xref="S3.Ex3.m1.2.2.2.1"><times id="S3.Ex3.m1.2.2.2.1.2.cmml" xref="S3.Ex3.m1.2.2.2.1.2"></times><apply id="S3.Ex3.m1.2.2.2.1.3.cmml" xref="S3.Ex3.m1.2.2.2.1.3"><divide id="S3.Ex3.m1.2.2.2.1.3.1.cmml" xref="S3.Ex3.m1.2.2.2.1.3"></divide><apply id="S3.Ex3.m1.2.2.2.1.3.2.cmml" xref="S3.Ex3.m1.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.1.3.2.1.cmml" xref="S3.Ex3.m1.2.2.2.1.3.2">superscript</csymbol><ci id="S3.Ex3.m1.2.2.2.1.3.2.2.cmml" xref="S3.Ex3.m1.2.2.2.1.3.2.2">ℰ</ci><plus id="S3.Ex3.m1.2.2.2.1.3.2.3.cmml" xref="S3.Ex3.m1.2.2.2.1.3.2.3"></plus></apply><ci id="S3.Ex3.m1.2.2.2.1.3.3.cmml" xref="S3.Ex3.m1.2.2.2.1.3.3">ℰ</ci></apply><apply id="S3.Ex3.m1.2.2.2.1.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1">superscript</csymbol><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1"><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.2">product</csymbol><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3"><in id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.1"></in><ci id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.2">𝑒</ci><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.2">ℰ</ci><plus id="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.2.3.3.3"></plus></apply></apply></apply><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1"><abs id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.2"></abs><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1">∇</ci><apply id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐹</ci><ci id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑒</ci></apply></apply></apply><ci id="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S3.Ex3.m1.2.2.2.1.1.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.3"><divide id="S3.Ex3.m1.2.2.2.1.1.3.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.3"></divide><cn type="integer" id="S3.Ex3.m1.2.2.2.1.1.3.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.3.2">1</cn><apply id="S3.Ex3.m1.2.2.2.1.1.3.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.2.2.2.1.1.3.3.1.cmml" xref="S3.Ex3.m1.2.2.2.1.1.3.3">superscript</csymbol><ci id="S3.Ex3.m1.2.2.2.1.1.3.3.2.cmml" xref="S3.Ex3.m1.2.2.2.1.1.3.3.2">ℰ</ci><plus id="S3.Ex3.m1.2.2.2.1.1.3.3.3.cmml" xref="S3.Ex3.m1.2.2.2.1.1.3.3.3"></plus></apply></apply></apply></apply><apply id="S3.Ex3.m1.3.3.3.2.cmml" xref="S3.Ex3.m1.3.3.3.2"><times id="S3.Ex3.m1.3.3.3.2.2.cmml" xref="S3.Ex3.m1.3.3.3.2.2"></times><apply id="S3.Ex3.m1.3.3.3.2.3.cmml" xref="S3.Ex3.m1.3.3.3.2.3"><divide id="S3.Ex3.m1.3.3.3.2.3.1.cmml" xref="S3.Ex3.m1.3.3.3.2.3"></divide><apply id="S3.Ex3.m1.3.3.3.2.3.2.cmml" xref="S3.Ex3.m1.3.3.3.2.3.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.2.3.2.1.cmml" xref="S3.Ex3.m1.3.3.3.2.3.2">superscript</csymbol><ci id="S3.Ex3.m1.3.3.3.2.3.2.2.cmml" xref="S3.Ex3.m1.3.3.3.2.3.2.2">ℰ</ci><minus id="S3.Ex3.m1.3.3.3.2.3.2.3.cmml" xref="S3.Ex3.m1.3.3.3.2.3.2.3"></minus></apply><ci id="S3.Ex3.m1.3.3.3.2.3.3.cmml" xref="S3.Ex3.m1.3.3.3.2.3.3">ℰ</ci></apply><apply id="S3.Ex3.m1.3.3.3.2.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.2.1.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1">superscript</csymbol><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1"><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.2">product</csymbol><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3"><in id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.1"></in><ci id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.2">𝑒</ci><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3">superscript</csymbol><ci id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.2">ℰ</ci><minus id="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.2.3.3.3"></minus></apply></apply></apply><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1"><abs id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.2"></abs><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1"><ci id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.1">∇</ci><apply id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.2">𝐹</ci><ci id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑒</ci></apply></apply></apply><ci id="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S3.Ex3.m1.3.3.3.2.1.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.3"><divide id="S3.Ex3.m1.3.3.3.2.1.3.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.3"></divide><cn type="integer" id="S3.Ex3.m1.3.3.3.2.1.3.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.3.2">1</cn><apply id="S3.Ex3.m1.3.3.3.2.1.3.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.3.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.3.3.3.2.1.3.3.1.cmml" xref="S3.Ex3.m1.3.3.3.2.1.3.3">superscript</csymbol><ci id="S3.Ex3.m1.3.3.3.2.1.3.3.2.cmml" xref="S3.Ex3.m1.3.3.3.2.1.3.3.2">ℰ</ci><minus id="S3.Ex3.m1.3.3.3.2.1.3.3.3.cmml" xref="S3.Ex3.m1.3.3.3.2.1.3.3.3"></minus></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.3c">\left[\nabla^{\wedge}F\right]_{k}=\frac{\mathcal{E}^{+}}{\mathcal{E}}\left(\prod_{e\in\mathcal{E^{+}}}\left|\left[\nabla F_{e}\right]_{k}\right|\right)^{\frac{1}{\mathcal{E}^{+}}}-\frac{\mathcal{E}^{-}}{\mathcal{E}}\left(\prod_{e\in\mathcal{E^{-}}}\left|\left[\nabla F_{e}\right]_{k}\right|\right)^{\frac{1}{\mathcal{E}^{-}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p14" class="ltx_para">
<p id="S3.SS1.p14.2" class="ltx_p">Then we update the global model in the federated networks based on the calculated geometric mean of gradients: <math id="S3.SS1.p14.1.m1.1" class="ltx_Math" alttext="w\leftarrow w-\eta\nabla^{\wedge}F" display="inline"><semantics id="S3.SS1.p14.1.m1.1a"><mrow id="S3.SS1.p14.1.m1.1.1" xref="S3.SS1.p14.1.m1.1.1.cmml"><mi id="S3.SS1.p14.1.m1.1.1.2" xref="S3.SS1.p14.1.m1.1.1.2.cmml">w</mi><mo stretchy="false" id="S3.SS1.p14.1.m1.1.1.1" xref="S3.SS1.p14.1.m1.1.1.1.cmml">←</mo><mrow id="S3.SS1.p14.1.m1.1.1.3" xref="S3.SS1.p14.1.m1.1.1.3.cmml"><mi id="S3.SS1.p14.1.m1.1.1.3.2" xref="S3.SS1.p14.1.m1.1.1.3.2.cmml">w</mi><mo id="S3.SS1.p14.1.m1.1.1.3.1" xref="S3.SS1.p14.1.m1.1.1.3.1.cmml">−</mo><mrow id="S3.SS1.p14.1.m1.1.1.3.3" xref="S3.SS1.p14.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p14.1.m1.1.1.3.3.2" xref="S3.SS1.p14.1.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.SS1.p14.1.m1.1.1.3.3.1" xref="S3.SS1.p14.1.m1.1.1.3.3.1.cmml">​</mo><mrow id="S3.SS1.p14.1.m1.1.1.3.3.3" xref="S3.SS1.p14.1.m1.1.1.3.3.3.cmml"><msup id="S3.SS1.p14.1.m1.1.1.3.3.3.1" xref="S3.SS1.p14.1.m1.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.SS1.p14.1.m1.1.1.3.3.3.1.2" xref="S3.SS1.p14.1.m1.1.1.3.3.3.1.2.cmml">∇</mo><mo id="S3.SS1.p14.1.m1.1.1.3.3.3.1.3" xref="S3.SS1.p14.1.m1.1.1.3.3.3.1.3.cmml">∧</mo></msup><mi id="S3.SS1.p14.1.m1.1.1.3.3.3.2" xref="S3.SS1.p14.1.m1.1.1.3.3.3.2.cmml">F</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p14.1.m1.1b"><apply id="S3.SS1.p14.1.m1.1.1.cmml" xref="S3.SS1.p14.1.m1.1.1"><ci id="S3.SS1.p14.1.m1.1.1.1.cmml" xref="S3.SS1.p14.1.m1.1.1.1">←</ci><ci id="S3.SS1.p14.1.m1.1.1.2.cmml" xref="S3.SS1.p14.1.m1.1.1.2">𝑤</ci><apply id="S3.SS1.p14.1.m1.1.1.3.cmml" xref="S3.SS1.p14.1.m1.1.1.3"><minus id="S3.SS1.p14.1.m1.1.1.3.1.cmml" xref="S3.SS1.p14.1.m1.1.1.3.1"></minus><ci id="S3.SS1.p14.1.m1.1.1.3.2.cmml" xref="S3.SS1.p14.1.m1.1.1.3.2">𝑤</ci><apply id="S3.SS1.p14.1.m1.1.1.3.3.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3"><times id="S3.SS1.p14.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p14.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3.2">𝜂</ci><apply id="S3.SS1.p14.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3.3"><apply id="S3.SS1.p14.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p14.1.m1.1.1.3.3.3.1.1.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3.3.1">superscript</csymbol><ci id="S3.SS1.p14.1.m1.1.1.3.3.3.1.2.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3.3.1.2">∇</ci><and id="S3.SS1.p14.1.m1.1.1.3.3.3.1.3.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3.3.1.3"></and></apply><ci id="S3.SS1.p14.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS1.p14.1.m1.1.1.3.3.3.2">𝐹</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p14.1.m1.1c">w\leftarrow w-\eta\nabla^{\wedge}F</annotation></semantics></math>, where <math id="S3.SS1.p14.2.m2.1" class="ltx_math_unparsed" alttext="\nabla^{\wedge}F=\{\nabla^{\wedge}F_{k},k\in\{0,..,n-1\}\}" display="inline"><semantics id="S3.SS1.p14.2.m2.1a"><mrow id="S3.SS1.p14.2.m2.1b"><msup id="S3.SS1.p14.2.m2.1.2"><mo id="S3.SS1.p14.2.m2.1.2.2">∇</mo><mo id="S3.SS1.p14.2.m2.1.2.3">∧</mo></msup><mi id="S3.SS1.p14.2.m2.1.3">F</mi><mo id="S3.SS1.p14.2.m2.1.4">=</mo><mrow id="S3.SS1.p14.2.m2.1.5"><mo stretchy="false" id="S3.SS1.p14.2.m2.1.5.1">{</mo><msup id="S3.SS1.p14.2.m2.1.5.2"><mo rspace="0.167em" id="S3.SS1.p14.2.m2.1.5.2.2">∇</mo><mo id="S3.SS1.p14.2.m2.1.5.2.3">∧</mo></msup><msub id="S3.SS1.p14.2.m2.1.5.3"><mi id="S3.SS1.p14.2.m2.1.5.3.2">F</mi><mi id="S3.SS1.p14.2.m2.1.5.3.3">k</mi></msub><mo id="S3.SS1.p14.2.m2.1.5.4">,</mo><mi id="S3.SS1.p14.2.m2.1.1">k</mi><mo id="S3.SS1.p14.2.m2.1.5.5">∈</mo><mrow id="S3.SS1.p14.2.m2.1.5.6"><mo stretchy="false" id="S3.SS1.p14.2.m2.1.5.6.1">{</mo><mn id="S3.SS1.p14.2.m2.1.5.6.2">0</mn><mo id="S3.SS1.p14.2.m2.1.5.6.3">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.SS1.p14.2.m2.1.5.6.4">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.SS1.p14.2.m2.1.5.6.5">.</mo><mo id="S3.SS1.p14.2.m2.1.5.6.6">,</mo><mi id="S3.SS1.p14.2.m2.1.5.6.7">n</mi><mo id="S3.SS1.p14.2.m2.1.5.6.8">−</mo><mn id="S3.SS1.p14.2.m2.1.5.6.9">1</mn><mo stretchy="false" id="S3.SS1.p14.2.m2.1.5.6.10">}</mo></mrow><mo stretchy="false" id="S3.SS1.p14.2.m2.1.5.7">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p14.2.m2.1c">\nabla^{\wedge}F=\{\nabla^{\wedge}F_{k},k\in\{0,..,n-1\}\}</annotation></semantics></math>. The implementation of weighted geometric mean implementation is further illustrated at
<a target="_blank" href="https://colab.research.google.com/drive/17y6ZuwiRE3iHVhFxaXz1b9eSZP7x25Om?usp=sharing" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://colab.research.google.com/drive/17y6ZuwiRE3iHVhFxaXz1b9eSZP7x25Om?usp=sharing</a>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Fishr+Inter-Geo: Fishr and Inter-silo Weighted Geometric Mean</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Rame proposed another gradient-based regularization method for domain generalization, <span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_bold">Fishr</span>, which matches the second-order information of gradient distributions - gradient covariance across different environments <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib20" title="" class="ltx_ref">20</a>)</cite>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">However, since it is of paramount importance to know the number of environments beforehand for gradient covariance calculation, Rame hypothesized that <span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_bold">the number of domains is accessible</span> during training, which is barely tractable in a centralized way of training. However, we could utilize Fishr in the <span id="S3.SS2.p2.1.2" class="ltx_text ltx_font_bold">federated learning</span> settings, where the number of federated clients <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{E}</annotation></semantics></math> are antecedently accessible.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.5" class="ltx_p">To compute Fishr in a federated way, we first define the gradient covariance matrix, where <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\nabla F_{e}^{i}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mo rspace="0.167em" id="S3.SS2.p3.1.m1.1.1.1" xref="S3.SS2.p3.1.m1.1.1.1.cmml">∇</mo><msubsup id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2.2.2" xref="S3.SS2.p3.1.m1.1.1.2.2.2.cmml">F</mi><mi id="S3.SS2.p3.1.m1.1.1.2.2.3" xref="S3.SS2.p3.1.m1.1.1.2.2.3.cmml">e</mi><mi id="S3.SS2.p3.1.m1.1.1.2.3" xref="S3.SS2.p3.1.m1.1.1.2.3.cmml">i</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><ci id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1.1">∇</ci><apply id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.2.1.cmml" xref="S3.SS2.p3.1.m1.1.1.2">superscript</csymbol><apply id="S3.SS2.p3.1.m1.1.1.2.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.2.2.1.cmml" xref="S3.SS2.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.2.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2.2.2">𝐹</ci><ci id="S3.SS2.p3.1.m1.1.1.2.2.3.cmml" xref="S3.SS2.p3.1.m1.1.1.2.2.3">𝑒</ci></apply><ci id="S3.SS2.p3.1.m1.1.1.2.3.cmml" xref="S3.SS2.p3.1.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\nabla F_{e}^{i}</annotation></semantics></math> denotes the first-order derivative for the <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mi id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><ci id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">i</annotation></semantics></math>-th data example from client <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="e\in\mathcal{E}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mrow id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml"><mi id="S3.SS2.p3.3.m3.1.1.2" xref="S3.SS2.p3.3.m3.1.1.2.cmml">e</mi><mo id="S3.SS2.p3.3.m3.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p3.3.m3.1.1.3" xref="S3.SS2.p3.3.m3.1.1.3.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><apply id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1"><in id="S3.SS2.p3.3.m3.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1"></in><ci id="S3.SS2.p3.3.m3.1.1.2.cmml" xref="S3.SS2.p3.3.m3.1.1.2">𝑒</ci><ci id="S3.SS2.p3.3.m3.1.1.3.cmml" xref="S3.SS2.p3.3.m3.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">e\in\mathcal{E}</annotation></semantics></math>, and <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="\overset{-}{\nabla F_{e}}=\frac{1}{n_{e}}\sum_{i=1}^{n_{e}}\nabla F_{e}^{i}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mrow id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.p3.4.m4.1.1.2" xref="S3.SS2.p3.4.m4.1.1.2.cmml"><mrow id="S3.SS2.p3.4.m4.1.1.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.cmml"><mo rspace="0.167em" id="S3.SS2.p3.4.m4.1.1.2.2.1" xref="S3.SS2.p3.4.m4.1.1.2.2.1.cmml">∇</mo><msub id="S3.SS2.p3.4.m4.1.1.2.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.2.cmml"><mi id="S3.SS2.p3.4.m4.1.1.2.2.2.2" xref="S3.SS2.p3.4.m4.1.1.2.2.2.2.cmml">F</mi><mi id="S3.SS2.p3.4.m4.1.1.2.2.2.3" xref="S3.SS2.p3.4.m4.1.1.2.2.2.3.cmml">e</mi></msub></mrow><mo id="S3.SS2.p3.4.m4.1.1.2.1" xref="S3.SS2.p3.4.m4.1.1.2.1.cmml">-</mo></mover><mo id="S3.SS2.p3.4.m4.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.cmml">=</mo><mrow id="S3.SS2.p3.4.m4.1.1.3" xref="S3.SS2.p3.4.m4.1.1.3.cmml"><mfrac id="S3.SS2.p3.4.m4.1.1.3.2" xref="S3.SS2.p3.4.m4.1.1.3.2.cmml"><mn id="S3.SS2.p3.4.m4.1.1.3.2.2" xref="S3.SS2.p3.4.m4.1.1.3.2.2.cmml">1</mn><msub id="S3.SS2.p3.4.m4.1.1.3.2.3" xref="S3.SS2.p3.4.m4.1.1.3.2.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.3.2.3.2" xref="S3.SS2.p3.4.m4.1.1.3.2.3.2.cmml">n</mi><mi id="S3.SS2.p3.4.m4.1.1.3.2.3.3" xref="S3.SS2.p3.4.m4.1.1.3.2.3.3.cmml">e</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.1.1.3.1" xref="S3.SS2.p3.4.m4.1.1.3.1.cmml">​</mo><mrow id="S3.SS2.p3.4.m4.1.1.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.cmml"><msubsup id="S3.SS2.p3.4.m4.1.1.3.3.1" xref="S3.SS2.p3.4.m4.1.1.3.3.1.cmml"><mo id="S3.SS2.p3.4.m4.1.1.3.3.1.2.2" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p3.4.m4.1.1.3.3.1.2.3" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.2" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.1" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S3.SS2.p3.4.m4.1.1.3.3.1.3" xref="S3.SS2.p3.4.m4.1.1.3.3.1.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.3.3.1.3.2" xref="S3.SS2.p3.4.m4.1.1.3.3.1.3.2.cmml">n</mi><mi id="S3.SS2.p3.4.m4.1.1.3.3.1.3.3" xref="S3.SS2.p3.4.m4.1.1.3.3.1.3.3.cmml">e</mi></msub></msubsup><mrow id="S3.SS2.p3.4.m4.1.1.3.3.2" xref="S3.SS2.p3.4.m4.1.1.3.3.2.cmml"><mo rspace="0.167em" id="S3.SS2.p3.4.m4.1.1.3.3.2.1" xref="S3.SS2.p3.4.m4.1.1.3.3.2.1.cmml">∇</mo><msubsup id="S3.SS2.p3.4.m4.1.1.3.3.2.2" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2.cmml"><mi id="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.2" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.2.cmml">F</mi><mi id="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.3" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.3.cmml">e</mi><mi id="S3.SS2.p3.4.m4.1.1.3.3.2.2.3" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2.3.cmml">i</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><apply id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1"><eq id="S3.SS2.p3.4.m4.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1"></eq><apply id="S3.SS2.p3.4.m4.1.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2"><minus id="S3.SS2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2.1"></minus><apply id="S3.SS2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2"><ci id="S3.SS2.p3.4.m4.1.1.2.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2.1">∇</ci><apply id="S3.SS2.p3.4.m4.1.1.2.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.2.2.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2.2.2">𝐹</ci><ci id="S3.SS2.p3.4.m4.1.1.2.2.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.2.2.2.3">𝑒</ci></apply></apply></apply><apply id="S3.SS2.p3.4.m4.1.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3"><times id="S3.SS2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.1"></times><apply id="S3.SS2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2"><divide id="S3.SS2.p3.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2"></divide><cn type="integer" id="S3.SS2.p3.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2.2">1</cn><apply id="S3.SS2.p3.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.2.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2.3">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.3.2.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2.3.2">𝑛</ci><ci id="S3.SS2.p3.4.m4.1.1.3.2.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.2.3.3">𝑒</ci></apply></apply><apply id="S3.SS2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3"><apply id="S3.SS2.p3.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.3.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1">superscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.3.3.1.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.3.1.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1">subscript</csymbol><sum id="S3.SS2.p3.4.m4.1.1.3.3.1.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.2"></sum><apply id="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.3"><eq id="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.1"></eq><ci id="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p3.4.m4.1.1.3.3.1.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.3.1.3.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.3.3.1.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.3.2">𝑛</ci><ci id="S3.SS2.p3.4.m4.1.1.3.3.1.3.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.1.3.3">𝑒</ci></apply></apply><apply id="S3.SS2.p3.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2"><ci id="S3.SS2.p3.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.1">∇</ci><apply id="S3.SS2.p3.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.3.2.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2">superscript</csymbol><apply id="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.1.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.2">𝐹</ci><ci id="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2.2.3">𝑒</ci></apply><ci id="S3.SS2.p3.4.m4.1.1.3.3.2.2.3.cmml" xref="S3.SS2.p3.4.m4.1.1.3.3.2.2.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\overset{-}{\nabla F_{e}}=\frac{1}{n_{e}}\sum_{i=1}^{n_{e}}\nabla F_{e}^{i}</annotation></semantics></math> denotes the gradient means of client <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">e</annotation></semantics></math>. The computed gradient covariance will be uploaded to server through RESTful APIs in each federated training round.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<table id="S3.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex4.m1.2" class="ltx_Math" alttext="C_{e}=\frac{1}{n_{e}}\sum_{i=1}^{n_{e}}\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)^{\top}" display="block"><semantics id="S3.Ex4.m1.2a"><mrow id="S3.Ex4.m1.2.2" xref="S3.Ex4.m1.2.2.cmml"><msub id="S3.Ex4.m1.2.2.4" xref="S3.Ex4.m1.2.2.4.cmml"><mi id="S3.Ex4.m1.2.2.4.2" xref="S3.Ex4.m1.2.2.4.2.cmml">C</mi><mi id="S3.Ex4.m1.2.2.4.3" xref="S3.Ex4.m1.2.2.4.3.cmml">e</mi></msub><mo id="S3.Ex4.m1.2.2.3" xref="S3.Ex4.m1.2.2.3.cmml">=</mo><mrow id="S3.Ex4.m1.2.2.2" xref="S3.Ex4.m1.2.2.2.cmml"><mfrac id="S3.Ex4.m1.2.2.2.4" xref="S3.Ex4.m1.2.2.2.4.cmml"><mn id="S3.Ex4.m1.2.2.2.4.2" xref="S3.Ex4.m1.2.2.2.4.2.cmml">1</mn><msub id="S3.Ex4.m1.2.2.2.4.3" xref="S3.Ex4.m1.2.2.2.4.3.cmml"><mi id="S3.Ex4.m1.2.2.2.4.3.2" xref="S3.Ex4.m1.2.2.2.4.3.2.cmml">n</mi><mi id="S3.Ex4.m1.2.2.2.4.3.3" xref="S3.Ex4.m1.2.2.2.4.3.3.cmml">e</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.2.2.2.3" xref="S3.Ex4.m1.2.2.2.3.cmml">​</mo><mrow id="S3.Ex4.m1.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.cmml"><munderover id="S3.Ex4.m1.2.2.2.2.3" xref="S3.Ex4.m1.2.2.2.2.3.cmml"><mo movablelimits="false" rspace="0em" id="S3.Ex4.m1.2.2.2.2.3.2.2" xref="S3.Ex4.m1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.Ex4.m1.2.2.2.2.3.2.3" xref="S3.Ex4.m1.2.2.2.2.3.2.3.cmml"><mi id="S3.Ex4.m1.2.2.2.2.3.2.3.2" xref="S3.Ex4.m1.2.2.2.2.3.2.3.2.cmml">i</mi><mo id="S3.Ex4.m1.2.2.2.2.3.2.3.1" xref="S3.Ex4.m1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.Ex4.m1.2.2.2.2.3.2.3.3" xref="S3.Ex4.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.Ex4.m1.2.2.2.2.3.3" xref="S3.Ex4.m1.2.2.2.2.3.3.cmml"><mi id="S3.Ex4.m1.2.2.2.2.3.3.2" xref="S3.Ex4.m1.2.2.2.2.3.3.2.cmml">n</mi><mi id="S3.Ex4.m1.2.2.2.2.3.3.3" xref="S3.Ex4.m1.2.2.2.2.3.3.3.cmml">e</mi></msub></munderover><mrow id="S3.Ex4.m1.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.cmml"><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.1.cmml">∇</mo><msubsup id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">F</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">e</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mo rspace="0.167em" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">∇</mo><msub id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">F</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">e</mi></msub></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.1.cmml">-</mo></mover></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex4.m1.2.2.2.2.2.3" xref="S3.Ex4.m1.2.2.2.2.2.3.cmml">​</mo><msup id="S3.Ex4.m1.2.2.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.cmml"><mrow id="S3.Ex4.m1.2.2.2.2.2.2.1.1" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="S3.Ex4.m1.2.2.2.2.2.2.1.1.2" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.cmml"><mo rspace="0.167em" id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.1" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.1.cmml">∇</mo><msubsup id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.cmml"><mi id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.2.cmml">F</mi><mi id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.3" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.3.cmml">e</mi><mi id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.3" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.3.cmml">i</mi></msubsup></mrow><mo id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.1" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.cmml"><mrow id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.cmml"><mo rspace="0.167em" id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.1" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml">∇</mo><msub id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml"><mi id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.2" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.2.cmml">F</mi><mi id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.3" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.3.cmml">e</mi></msub></mrow><mo id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.1" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.1.cmml">-</mo></mover></mrow><mo id="S3.Ex4.m1.2.2.2.2.2.2.1.1.3" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.Ex4.m1.2.2.2.2.2.2.3" xref="S3.Ex4.m1.2.2.2.2.2.2.3.cmml">⊤</mo></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.2b"><apply id="S3.Ex4.m1.2.2.cmml" xref="S3.Ex4.m1.2.2"><eq id="S3.Ex4.m1.2.2.3.cmml" xref="S3.Ex4.m1.2.2.3"></eq><apply id="S3.Ex4.m1.2.2.4.cmml" xref="S3.Ex4.m1.2.2.4"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.4.1.cmml" xref="S3.Ex4.m1.2.2.4">subscript</csymbol><ci id="S3.Ex4.m1.2.2.4.2.cmml" xref="S3.Ex4.m1.2.2.4.2">𝐶</ci><ci id="S3.Ex4.m1.2.2.4.3.cmml" xref="S3.Ex4.m1.2.2.4.3">𝑒</ci></apply><apply id="S3.Ex4.m1.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2"><times id="S3.Ex4.m1.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.3"></times><apply id="S3.Ex4.m1.2.2.2.4.cmml" xref="S3.Ex4.m1.2.2.2.4"><divide id="S3.Ex4.m1.2.2.2.4.1.cmml" xref="S3.Ex4.m1.2.2.2.4"></divide><cn type="integer" id="S3.Ex4.m1.2.2.2.4.2.cmml" xref="S3.Ex4.m1.2.2.2.4.2">1</cn><apply id="S3.Ex4.m1.2.2.2.4.3.cmml" xref="S3.Ex4.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.4.3.1.cmml" xref="S3.Ex4.m1.2.2.2.4.3">subscript</csymbol><ci id="S3.Ex4.m1.2.2.2.4.3.2.cmml" xref="S3.Ex4.m1.2.2.2.4.3.2">𝑛</ci><ci id="S3.Ex4.m1.2.2.2.4.3.3.cmml" xref="S3.Ex4.m1.2.2.2.4.3.3">𝑒</ci></apply></apply><apply id="S3.Ex4.m1.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2"><apply id="S3.Ex4.m1.2.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.3.1.cmml" xref="S3.Ex4.m1.2.2.2.2.3">superscript</csymbol><apply id="S3.Ex4.m1.2.2.2.2.3.2.cmml" xref="S3.Ex4.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.3.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.3">subscript</csymbol><sum id="S3.Ex4.m1.2.2.2.2.3.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.3.2.2"></sum><apply id="S3.Ex4.m1.2.2.2.2.3.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.3.2.3"><eq id="S3.Ex4.m1.2.2.2.2.3.2.3.1.cmml" xref="S3.Ex4.m1.2.2.2.2.3.2.3.1"></eq><ci id="S3.Ex4.m1.2.2.2.2.3.2.3.2.cmml" xref="S3.Ex4.m1.2.2.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.Ex4.m1.2.2.2.2.3.2.3.3.cmml" xref="S3.Ex4.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.Ex4.m1.2.2.2.2.3.3.cmml" xref="S3.Ex4.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.3.3.1.cmml" xref="S3.Ex4.m1.2.2.2.2.3.3">subscript</csymbol><ci id="S3.Ex4.m1.2.2.2.2.3.3.2.cmml" xref="S3.Ex4.m1.2.2.2.2.3.3.2">𝑛</ci><ci id="S3.Ex4.m1.2.2.2.2.3.3.3.cmml" xref="S3.Ex4.m1.2.2.2.2.3.3.3">𝑒</ci></apply></apply><apply id="S3.Ex4.m1.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2"><times id="S3.Ex4.m1.2.2.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.3"></times><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1"><minus id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2"><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.1">∇</ci><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝐹</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.2.3">𝑒</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3"><minus id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.1"></minus><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.1">∇</ci><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.2">𝐹</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.3.2.2.3">𝑒</ci></apply></apply></apply></apply><apply id="S3.Ex4.m1.2.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1"><minus id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.1"></minus><apply id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2"><ci id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.1">∇</ci><apply id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2">superscript</csymbol><apply id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.2">𝐹</ci><ci id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.2.3">𝑒</ci></apply><ci id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3"><minus id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.1"></minus><apply id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2"><ci id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.1">∇</ci><apply id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.1.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2">subscript</csymbol><ci id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.2.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.2">𝐹</ci><ci id="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.1.1.1.3.2.2.3">𝑒</ci></apply></apply></apply></apply><csymbol cd="latexml" id="S3.Ex4.m1.2.2.2.2.2.2.3.cmml" xref="S3.Ex4.m1.2.2.2.2.2.2.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.2c">C_{e}=\frac{1}{n_{e}}\sum_{i=1}^{n_{e}}\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)^{\top}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Then we compute the Fishr loss on the centralized server, where the mean covariance matrix is <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="\overset{-}{C}=\frac{1}{\mathcal{E}}\sum_{e\in\mathcal{E}}C_{e}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2.2" xref="S3.SS2.p5.1.m1.1.1.2.2.cmml">C</mi><mo id="S3.SS2.p5.1.m1.1.1.2.1" xref="S3.SS2.p5.1.m1.1.1.2.1.cmml">-</mo></mover><mo id="S3.SS2.p5.1.m1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml"><mfrac id="S3.SS2.p5.1.m1.1.1.3.2" xref="S3.SS2.p5.1.m1.1.1.3.2.cmml"><mn id="S3.SS2.p5.1.m1.1.1.3.2.2" xref="S3.SS2.p5.1.m1.1.1.3.2.2.cmml">1</mn><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.1.1.3.2.3" xref="S3.SS2.p5.1.m1.1.1.3.2.3.cmml">ℰ</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.1.3.1" xref="S3.SS2.p5.1.m1.1.1.3.1.cmml">​</mo><mrow id="S3.SS2.p5.1.m1.1.1.3.3" xref="S3.SS2.p5.1.m1.1.1.3.3.cmml"><msub id="S3.SS2.p5.1.m1.1.1.3.3.1" xref="S3.SS2.p5.1.m1.1.1.3.3.1.cmml"><mo id="S3.SS2.p5.1.m1.1.1.3.3.1.2" xref="S3.SS2.p5.1.m1.1.1.3.3.1.2.cmml">∑</mo><mrow id="S3.SS2.p5.1.m1.1.1.3.3.1.3" xref="S3.SS2.p5.1.m1.1.1.3.3.1.3.cmml"><mi id="S3.SS2.p5.1.m1.1.1.3.3.1.3.2" xref="S3.SS2.p5.1.m1.1.1.3.3.1.3.2.cmml">e</mi><mo id="S3.SS2.p5.1.m1.1.1.3.3.1.3.1" xref="S3.SS2.p5.1.m1.1.1.3.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.1.1.3.3.1.3.3" xref="S3.SS2.p5.1.m1.1.1.3.3.1.3.3.cmml">ℰ</mi></mrow></msub><msub id="S3.SS2.p5.1.m1.1.1.3.3.2" xref="S3.SS2.p5.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.p5.1.m1.1.1.3.3.2.2" xref="S3.SS2.p5.1.m1.1.1.3.3.2.2.cmml">C</mi><mi id="S3.SS2.p5.1.m1.1.1.3.3.2.3" xref="S3.SS2.p5.1.m1.1.1.3.3.2.3.cmml">e</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><eq id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1"></eq><apply id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2"><minus id="S3.SS2.p5.1.m1.1.1.2.1.cmml" xref="S3.SS2.p5.1.m1.1.1.2.1"></minus><ci id="S3.SS2.p5.1.m1.1.1.2.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2.2">𝐶</ci></apply><apply id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3"><times id="S3.SS2.p5.1.m1.1.1.3.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.1"></times><apply id="S3.SS2.p5.1.m1.1.1.3.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.2"><divide id="S3.SS2.p5.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.2"></divide><cn type="integer" id="S3.SS2.p5.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.2.2">1</cn><ci id="S3.SS2.p5.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.2.3">ℰ</ci></apply><apply id="S3.SS2.p5.1.m1.1.1.3.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3"><apply id="S3.SS2.p5.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.3.3.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.1">subscript</csymbol><sum id="S3.SS2.p5.1.m1.1.1.3.3.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.1.2"></sum><apply id="S3.SS2.p5.1.m1.1.1.3.3.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.1.3"><in id="S3.SS2.p5.1.m1.1.1.3.3.1.3.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.1.3.1"></in><ci id="S3.SS2.p5.1.m1.1.1.3.3.1.3.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.1.3.2">𝑒</ci><ci id="S3.SS2.p5.1.m1.1.1.3.3.1.3.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.1.3.3">ℰ</ci></apply></apply><apply id="S3.SS2.p5.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.2.2">𝐶</ci><ci id="S3.SS2.p5.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3.3.2.3">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\overset{-}{C}=\frac{1}{\mathcal{E}}\sum_{e\in\mathcal{E}}C_{e}</annotation></semantics></math>:</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<table id="S3.Ex5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex5.m1.1" class="ltx_math_unparsed" alttext="L_{Fishr}=\frac{1}{\mathcal{E}}\sum_{e\in\mathcal{E}}\|C_{e}-\overset{-}{C}\rVert^{2}" display="block"><semantics id="S3.Ex5.m1.1a"><mrow id="S3.Ex5.m1.1b"><msub id="S3.Ex5.m1.1.1"><mi id="S3.Ex5.m1.1.1.2">L</mi><mrow id="S3.Ex5.m1.1.1.3"><mi id="S3.Ex5.m1.1.1.3.2">F</mi><mo lspace="0em" rspace="0em" id="S3.Ex5.m1.1.1.3.1">​</mo><mi id="S3.Ex5.m1.1.1.3.3">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex5.m1.1.1.3.1a">​</mo><mi id="S3.Ex5.m1.1.1.3.4">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex5.m1.1.1.3.1b">​</mo><mi id="S3.Ex5.m1.1.1.3.5">h</mi><mo lspace="0em" rspace="0em" id="S3.Ex5.m1.1.1.3.1c">​</mo><mi id="S3.Ex5.m1.1.1.3.6">r</mi></mrow></msub><mo id="S3.Ex5.m1.1.2">=</mo><mfrac id="S3.Ex5.m1.1.3"><mn id="S3.Ex5.m1.1.3.2">1</mn><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.1.3.3">ℰ</mi></mfrac><munder id="S3.Ex5.m1.1.4"><mo movablelimits="false" rspace="0em" id="S3.Ex5.m1.1.4.2">∑</mo><mrow id="S3.Ex5.m1.1.4.3"><mi id="S3.Ex5.m1.1.4.3.2">e</mi><mo id="S3.Ex5.m1.1.4.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.1.4.3.3">ℰ</mi></mrow></munder><mo lspace="0em" rspace="0.167em" id="S3.Ex5.m1.1.5">∥</mo><msub id="S3.Ex5.m1.1.6"><mi id="S3.Ex5.m1.1.6.2">C</mi><mi id="S3.Ex5.m1.1.6.3">e</mi></msub><mo id="S3.Ex5.m1.1.7">−</mo><mover accent="true" id="S3.Ex5.m1.1.8"><mi id="S3.Ex5.m1.1.8.2">C</mi><mo id="S3.Ex5.m1.1.8.1">-</mo></mover><mo fence="true" lspace="0em" rspace="0em" id="S3.Ex5.m1.1.9">∥</mo><msup id="S3.Ex5.m1.1.10"><mi id="S3.Ex5.m1.1.10a"></mi><mn id="S3.Ex5.m1.1.10.1">2</mn></msup></mrow><annotation encoding="application/x-tex" id="S3.Ex5.m1.1c">L_{Fishr}=\frac{1}{\mathcal{E}}\sum_{e\in\mathcal{E}}\|C_{e}-\overset{-}{C}\rVert^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.2" class="ltx_p">Ultimately, we further ameliorate our Federated Fishr method with weighted geometric mean <math id="S3.SS2.p7.1.m1.1" class="ltx_Math" alttext="\nabla^{\wedge}F_{t}" display="inline"><semantics id="S3.SS2.p7.1.m1.1a"><mrow id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml"><msup id="S3.SS2.p7.1.m1.1.1.1" xref="S3.SS2.p7.1.m1.1.1.1.cmml"><mo id="S3.SS2.p7.1.m1.1.1.1.2" xref="S3.SS2.p7.1.m1.1.1.1.2.cmml">∇</mo><mo id="S3.SS2.p7.1.m1.1.1.1.3" xref="S3.SS2.p7.1.m1.1.1.1.3.cmml">∧</mo></msup><msub id="S3.SS2.p7.1.m1.1.1.2" xref="S3.SS2.p7.1.m1.1.1.2.cmml"><mi id="S3.SS2.p7.1.m1.1.1.2.2" xref="S3.SS2.p7.1.m1.1.1.2.2.cmml">F</mi><mi id="S3.SS2.p7.1.m1.1.1.2.3" xref="S3.SS2.p7.1.m1.1.1.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.1b"><apply id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1"><apply id="S3.SS2.p7.1.m1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1.1">superscript</csymbol><ci id="S3.SS2.p7.1.m1.1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1.1.2">∇</ci><and id="S3.SS2.p7.1.m1.1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.1.1.1.3"></and></apply><apply id="S3.SS2.p7.1.m1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.1.1.2.1.cmml" xref="S3.SS2.p7.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p7.1.m1.1.1.2.2.cmml" xref="S3.SS2.p7.1.m1.1.1.2.2">𝐹</ci><ci id="S3.SS2.p7.1.m1.1.1.2.3.cmml" xref="S3.SS2.p7.1.m1.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.1c">\nabla^{\wedge}F_{t}</annotation></semantics></math> in lieu of arithmetic averaging of gradients <math id="S3.SS2.p7.2.m2.1" class="ltx_Math" alttext="\nabla^{+}F_{t}" display="inline"><semantics id="S3.SS2.p7.2.m2.1a"><mrow id="S3.SS2.p7.2.m2.1.1" xref="S3.SS2.p7.2.m2.1.1.cmml"><msup id="S3.SS2.p7.2.m2.1.1.1" xref="S3.SS2.p7.2.m2.1.1.1.cmml"><mo id="S3.SS2.p7.2.m2.1.1.1.2" xref="S3.SS2.p7.2.m2.1.1.1.2.cmml">∇</mo><mo id="S3.SS2.p7.2.m2.1.1.1.3" xref="S3.SS2.p7.2.m2.1.1.1.3.cmml">+</mo></msup><msub id="S3.SS2.p7.2.m2.1.1.2" xref="S3.SS2.p7.2.m2.1.1.2.cmml"><mi id="S3.SS2.p7.2.m2.1.1.2.2" xref="S3.SS2.p7.2.m2.1.1.2.2.cmml">F</mi><mi id="S3.SS2.p7.2.m2.1.1.2.3" xref="S3.SS2.p7.2.m2.1.1.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.2.m2.1b"><apply id="S3.SS2.p7.2.m2.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1"><apply id="S3.SS2.p7.2.m2.1.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.1.1.1.cmml" xref="S3.SS2.p7.2.m2.1.1.1">superscript</csymbol><ci id="S3.SS2.p7.2.m2.1.1.1.2.cmml" xref="S3.SS2.p7.2.m2.1.1.1.2">∇</ci><plus id="S3.SS2.p7.2.m2.1.1.1.3.cmml" xref="S3.SS2.p7.2.m2.1.1.1.3"></plus></apply><apply id="S3.SS2.p7.2.m2.1.1.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p7.2.m2.1.1.2.1.cmml" xref="S3.SS2.p7.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p7.2.m2.1.1.2.2.cmml" xref="S3.SS2.p7.2.m2.1.1.2.2">𝐹</ci><ci id="S3.SS2.p7.2.m2.1.1.2.3.cmml" xref="S3.SS2.p7.2.m2.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.2.m2.1c">\nabla^{+}F_{t}</annotation></semantics></math> uploaded by clients. Specifically, we utilise both inter-silo gradient covariance and domain-level weighted geometric mean to update the global model with the gradient descent algorithm. Given that both the Fishr and geometric averaging of Hessians are potent in capturing domain-level invariance, our proposed method, as proved in our experiments, further enforces the consistencies among federated clients. The pseudo-code is demonstrated in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 7 Appendix ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<table id="S3.Ex6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex6.m1.1" class="ltx_Math" alttext="w_{t+1}=w_{t}-\eta\left(\nabla^{\wedge}F_{t}+\lambda\nabla L_{Fishr_{t}}\right)" display="block"><semantics id="S3.Ex6.m1.1a"><mrow id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml"><msub id="S3.Ex6.m1.1.1.3" xref="S3.Ex6.m1.1.1.3.cmml"><mi id="S3.Ex6.m1.1.1.3.2" xref="S3.Ex6.m1.1.1.3.2.cmml">w</mi><mrow id="S3.Ex6.m1.1.1.3.3" xref="S3.Ex6.m1.1.1.3.3.cmml"><mi id="S3.Ex6.m1.1.1.3.3.2" xref="S3.Ex6.m1.1.1.3.3.2.cmml">t</mi><mo id="S3.Ex6.m1.1.1.3.3.1" xref="S3.Ex6.m1.1.1.3.3.1.cmml">+</mo><mn id="S3.Ex6.m1.1.1.3.3.3" xref="S3.Ex6.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.Ex6.m1.1.1.2" xref="S3.Ex6.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex6.m1.1.1.1" xref="S3.Ex6.m1.1.1.1.cmml"><msub id="S3.Ex6.m1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.3.cmml"><mi id="S3.Ex6.m1.1.1.1.3.2" xref="S3.Ex6.m1.1.1.1.3.2.cmml">w</mi><mi id="S3.Ex6.m1.1.1.1.3.3" xref="S3.Ex6.m1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.Ex6.m1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.2.cmml">−</mo><mrow id="S3.Ex6.m1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.cmml"><msup id="S3.Ex6.m1.1.1.1.1.1.1.1.2.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.cmml"><mo rspace="0.167em" id="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.2.cmml">∇</mo><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.3.cmml">∧</mo></msup><msub id="S3.Ex6.m1.1.1.1.1.1.1.1.2.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.2.cmml">F</mi><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msub></mrow><mo id="S3.Ex6.m1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.3.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mo lspace="0.167em" rspace="0em" id="S3.Ex6.m1.1.1.1.1.1.1.1.3.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.cmml"><mo rspace="0.167em" id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.1.cmml">∇</mo><msub id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">L</mi><mrow id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1a" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.4" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1b" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.5" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1c" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><msub id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.cmml"><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.2" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.2.cmml">r</mi><mi id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.3.cmml">t</mi></msub></mrow></msub></mrow></mrow></mrow><mo id="S3.Ex6.m1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.1b"><apply id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1"><eq id="S3.Ex6.m1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.2"></eq><apply id="S3.Ex6.m1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.3.1.cmml" xref="S3.Ex6.m1.1.1.3">subscript</csymbol><ci id="S3.Ex6.m1.1.1.3.2.cmml" xref="S3.Ex6.m1.1.1.3.2">𝑤</ci><apply id="S3.Ex6.m1.1.1.3.3.cmml" xref="S3.Ex6.m1.1.1.3.3"><plus id="S3.Ex6.m1.1.1.3.3.1.cmml" xref="S3.Ex6.m1.1.1.3.3.1"></plus><ci id="S3.Ex6.m1.1.1.3.3.2.cmml" xref="S3.Ex6.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.Ex6.m1.1.1.3.3.3.cmml" xref="S3.Ex6.m1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.Ex6.m1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1"><minus id="S3.Ex6.m1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.2"></minus><apply id="S3.Ex6.m1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.1.1.1.3">subscript</csymbol><ci id="S3.Ex6.m1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.1.1.1.3.2">𝑤</ci><ci id="S3.Ex6.m1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.Ex6.m1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1"><times id="S3.Ex6.m1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.2"></times><ci id="S3.Ex6.m1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.3">𝜂</ci><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1"><plus id="S3.Ex6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.1"></plus><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2"><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.1">superscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.2">∇</ci><and id="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.1.3"></and></apply><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.2">𝐹</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply></apply><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3"><times id="S3.Ex6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.2">𝜆</ci><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3"><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.1">∇</ci><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.2">𝐿</ci><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3"><times id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.1"></times><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.2">𝐹</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.3">𝑖</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.4.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.4">𝑠</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.5.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.5">ℎ</ci><apply id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6"><csymbol cd="ambiguous" id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.1.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6">subscript</csymbol><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.2.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.2">𝑟</ci><ci id="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.3.cmml" xref="S3.Ex6.m1.1.1.1.1.1.1.1.3.3.2.3.6.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.1c">w_{t+1}=w_{t}-\eta\left(\nabla^{\wedge}F_{t}+\lambda\nabla L_{Fishr_{t}}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Fishr+Intra-Geo: Fishr and Intra-silo Weighted Geometric Mean</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Theoretically, the dataset within each client is more statistically homogeneous. In the real world cases, however, it is prevalent that <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_bold">non-i.i.d. data may exist within one federated client</span>, which could potentially hamper the effective training of federated models. For example, the patients’ clinical data, such as age or race, may significantly vary in different distributions, even within one hospital. To the best of our knowledge, this issue has not been solved by any previous federated learning research works.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.2" class="ltx_p">Therefore, we further integrate <span id="S3.SS3.p2.2.1" class="ltx_text ltx_font_bold">intra-silo weighted geometric mean</span> with inter-silo gradient covariance to mitigate this issue. Specifically, we calculate intra-silo weighted geometric mean of gradients by treating each data example <math id="S3.SS3.p2.1.m1.2" class="ltx_Math" alttext="\left(x_{e}^{i},y_{e}^{i}\right)" display="inline"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.2.2" xref="S3.SS3.p2.1.m1.2.2.3.cmml"><mo id="S3.SS3.p2.1.m1.2.2.2.3" xref="S3.SS3.p2.1.m1.2.2.3.cmml">(</mo><msubsup id="S3.SS3.p2.1.m1.1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.1.1.2.2" xref="S3.SS3.p2.1.m1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS3.p2.1.m1.1.1.1.1.2.3" xref="S3.SS3.p2.1.m1.1.1.1.1.2.3.cmml">e</mi><mi id="S3.SS3.p2.1.m1.1.1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS3.p2.1.m1.2.2.2.4" xref="S3.SS3.p2.1.m1.2.2.3.cmml">,</mo><msubsup id="S3.SS3.p2.1.m1.2.2.2.2" xref="S3.SS3.p2.1.m1.2.2.2.2.cmml"><mi id="S3.SS3.p2.1.m1.2.2.2.2.2.2" xref="S3.SS3.p2.1.m1.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS3.p2.1.m1.2.2.2.2.2.3" xref="S3.SS3.p2.1.m1.2.2.2.2.2.3.cmml">e</mi><mi id="S3.SS3.p2.1.m1.2.2.2.2.3" xref="S3.SS3.p2.1.m1.2.2.2.2.3.cmml">i</mi></msubsup><mo id="S3.SS3.p2.1.m1.2.2.2.5" xref="S3.SS3.p2.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><interval closure="open" id="S3.SS3.p2.1.m1.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.2"><apply id="S3.SS3.p2.1.m1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS3.p2.1.m1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.2.3">𝑒</ci></apply><ci id="S3.SS3.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p2.1.m1.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2">superscript</csymbol><apply id="S3.SS3.p2.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS3.p2.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2.2.3">𝑒</ci></apply><ci id="S3.SS3.p2.1.m1.2.2.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.2.2.3">𝑖</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">\left(x_{e}^{i},y_{e}^{i}\right)</annotation></semantics></math> as an independent environment in client <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">e</annotation></semantics></math>. Meanwhile, we compute gradient covariance in the same federated client. Later, each client collaboratively uploads the computed gradients and covariance information to the orchestration of the central server to update the global model’s parameters. The pseudo-code is demonstrated in Algorithm <a href="#alg2" title="Algorithm 2 ‣ 7 Appendix ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S3.F1" class="ltx_figure">
<p id="S3.F1.1" class="ltx_p ltx_align_center"><span id="S3.F1.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2205.09305/assets/fedilc.png" id="S3.F1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="589" height="197" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S3.F1.4.2" class="ltx_text" style="font-size:90%;">Server-client communication of Fishr+Inter-Geo and Fishr+Intra-Geo in the federated learning settings.</span></figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Theoretical Analysis</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.5" class="ltx_p">Parascandolo’s paper introduces the Inconsistency Score <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>)</cite>. Suppose we have two clients <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">A</annotation></semantics></math> and <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">B</annotation></semantics></math> with distinct training distributions, then the Inconsistency Score <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="I\left(\theta^{*}\right)" display="inline"><semantics id="S4.p1.3.m3.1a"><mrow id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><mi id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S4.p1.3.m3.1.1.1.1" xref="S4.p1.3.m3.1.1.1.1.1.cmml"><mo id="S4.p1.3.m3.1.1.1.1.2" xref="S4.p1.3.m3.1.1.1.1.1.cmml">(</mo><msup id="S4.p1.3.m3.1.1.1.1.1" xref="S4.p1.3.m3.1.1.1.1.1.cmml"><mi id="S4.p1.3.m3.1.1.1.1.1.2" xref="S4.p1.3.m3.1.1.1.1.1.2.cmml">θ</mi><mo id="S4.p1.3.m3.1.1.1.1.1.3" xref="S4.p1.3.m3.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S4.p1.3.m3.1.1.1.1.3" xref="S4.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><times id="S4.p1.3.m3.1.1.2.cmml" xref="S4.p1.3.m3.1.1.2"></times><ci id="S4.p1.3.m3.1.1.3.cmml" xref="S4.p1.3.m3.1.1.3">𝐼</ci><apply id="S4.p1.3.m3.1.1.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1.1">superscript</csymbol><ci id="S4.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.p1.3.m3.1.1.1.1.1.2">𝜃</ci><times id="S4.p1.3.m3.1.1.1.1.1.3.cmml" xref="S4.p1.3.m3.1.1.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">I\left(\theta^{*}\right)</annotation></semantics></math> is defined as follows, where <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="\theta^{*}" display="inline"><semantics id="S4.p1.4.m4.1a"><msup id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml"><mi id="S4.p1.4.m4.1.1.2" xref="S4.p1.4.m4.1.1.2.cmml">θ</mi><mo id="S4.p1.4.m4.1.1.3" xref="S4.p1.4.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><apply id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p1.4.m4.1.1.1.cmml" xref="S4.p1.4.m4.1.1">superscript</csymbol><ci id="S4.p1.4.m4.1.1.2.cmml" xref="S4.p1.4.m4.1.1.2">𝜃</ci><times id="S4.p1.4.m4.1.1.3.cmml" xref="S4.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">\theta^{*}</annotation></semantics></math> denotes the local minimum of the loss space <math id="S4.p1.5.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.p1.5.m5.1a"><mi id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><ci id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">L</annotation></semantics></math>.</p>
</div>
<div id="S4.p2" class="ltx_para">
<table id="S4.Ex7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex7.m1.8" class="ltx_math_unparsed" alttext="I\left(\theta^{*}\right)=max\left\{\underset{\lvert L_{A}(\theta)-L_{A}(\theta^{*})\rvert\leq\epsilon}{max}\lvert L_{B}\left(\theta\right)-L_{A}\left(\theta^{*}\right)\rvert,\underset{\lvert L_{B}(\theta)-L_{B}(\theta^{*})\leq\epsilon}{max}\lvert L_{A}\left(\theta\right)-L_{B}\left(\theta^{*}\right)\rvert\right\}" display="block"><semantics id="S4.Ex7.m1.8a"><mrow id="S4.Ex7.m1.8.8"><mrow id="S4.Ex7.m1.6.6.1"><mi id="S4.Ex7.m1.6.6.1.3">I</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.6.6.1.2">​</mo><mrow id="S4.Ex7.m1.6.6.1.1.1"><mo id="S4.Ex7.m1.6.6.1.1.1.2">(</mo><msup id="S4.Ex7.m1.6.6.1.1.1.1"><mi id="S4.Ex7.m1.6.6.1.1.1.1.2">θ</mi><mo id="S4.Ex7.m1.6.6.1.1.1.1.3">∗</mo></msup><mo id="S4.Ex7.m1.6.6.1.1.1.3">)</mo></mrow></mrow><mo id="S4.Ex7.m1.8.8.4">=</mo><mrow id="S4.Ex7.m1.8.8.3"><mi id="S4.Ex7.m1.8.8.3.4">m</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.8.8.3.3">​</mo><mi id="S4.Ex7.m1.8.8.3.5">a</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.8.8.3.3a">​</mo><mi id="S4.Ex7.m1.8.8.3.6">x</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.8.8.3.3b">​</mo><mrow id="S4.Ex7.m1.8.8.3.2.2"><mo id="S4.Ex7.m1.8.8.3.2.2.3">{</mo><mrow id="S4.Ex7.m1.7.7.2.1.1.1"><munder accentunder="true" id="S4.Ex7.m1.2.2"><mrow id="S4.Ex7.m1.2.2.3"><mi id="S4.Ex7.m1.2.2.3.2">m</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.2.2.3.1">​</mo><mi id="S4.Ex7.m1.2.2.3.3">a</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.2.2.3.1a">​</mo><mi id="S4.Ex7.m1.2.2.3.4">x</mi></mrow><mrow id="S4.Ex7.m1.2.2.2"><mrow id="S4.Ex7.m1.2.2.2.2.1"><mo stretchy="false" id="S4.Ex7.m1.2.2.2.2.1.2">|</mo><mrow id="S4.Ex7.m1.2.2.2.2.1.1"><mrow id="S4.Ex7.m1.2.2.2.2.1.1.3"><msub id="S4.Ex7.m1.2.2.2.2.1.1.3.2"><mi id="S4.Ex7.m1.2.2.2.2.1.1.3.2.2">L</mi><mi id="S4.Ex7.m1.2.2.2.2.1.1.3.2.3">A</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.2.2.2.2.1.1.3.1">​</mo><mrow id="S4.Ex7.m1.2.2.2.2.1.1.3.3.2"><mo stretchy="false" id="S4.Ex7.m1.2.2.2.2.1.1.3.3.2.1">(</mo><mi id="S4.Ex7.m1.1.1.1.1">θ</mi><mo stretchy="false" id="S4.Ex7.m1.2.2.2.2.1.1.3.3.2.2">)</mo></mrow></mrow><mo id="S4.Ex7.m1.2.2.2.2.1.1.2">−</mo><mrow id="S4.Ex7.m1.2.2.2.2.1.1.1"><msub id="S4.Ex7.m1.2.2.2.2.1.1.1.3"><mi id="S4.Ex7.m1.2.2.2.2.1.1.1.3.2">L</mi><mi id="S4.Ex7.m1.2.2.2.2.1.1.1.3.3">A</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.2.2.2.2.1.1.1.2">​</mo><mrow id="S4.Ex7.m1.2.2.2.2.1.1.1.1.1"><mo stretchy="false" id="S4.Ex7.m1.2.2.2.2.1.1.1.1.1.2">(</mo><msup id="S4.Ex7.m1.2.2.2.2.1.1.1.1.1.1"><mi id="S4.Ex7.m1.2.2.2.2.1.1.1.1.1.1.2">θ</mi><mo id="S4.Ex7.m1.2.2.2.2.1.1.1.1.1.1.3">∗</mo></msup><mo stretchy="false" id="S4.Ex7.m1.2.2.2.2.1.1.1.1.1.3">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.Ex7.m1.2.2.2.2.1.3">|</mo></mrow><mo id="S4.Ex7.m1.2.2.2.3">≤</mo><mi id="S4.Ex7.m1.2.2.2.4">ϵ</mi></mrow></munder><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.7.7.2.1.1.1.2">​</mo><mrow id="S4.Ex7.m1.7.7.2.1.1.1.1.1"><mo stretchy="false" id="S4.Ex7.m1.7.7.2.1.1.1.1.1.2">|</mo><mrow id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1"><mrow id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.3"><msub id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.3.2"><mi id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.3.2.2">L</mi><mi id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.3.2.3">B</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.3.1">​</mo><mrow id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.3.3.2"><mo id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.3.3.2.1">(</mo><mi id="S4.Ex7.m1.4.4">θ</mi><mo id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.3.3.2.2">)</mo></mrow></mrow><mo id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.2">−</mo><mrow id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1"><msub id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.3"><mi id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.3.2">L</mi><mi id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.3.3">A</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.2">​</mo><mrow id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.1.1"><mo id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.1.1.2">(</mo><msup id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1"><mi id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.2">θ</mi><mo id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.3">∗</mo></msup><mo id="S4.Ex7.m1.7.7.2.1.1.1.1.1.1.1.1.1.3">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.Ex7.m1.7.7.2.1.1.1.1.1.3">|</mo></mrow></mrow><mo id="S4.Ex7.m1.8.8.3.2.2.4">,</mo><mrow id="S4.Ex7.m1.8.8.3.2.2.2"><munder accentunder="true" id="S4.Ex7.m1.3.3"><mrow id="S4.Ex7.m1.3.3.2"><mi id="S4.Ex7.m1.3.3.2.2">m</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.3.3.2.1">​</mo><mi id="S4.Ex7.m1.3.3.2.3">a</mi><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.3.3.2.1a">​</mo><mi id="S4.Ex7.m1.3.3.2.4">x</mi></mrow><mrow id="S4.Ex7.m1.3.3.1"><mo stretchy="false" id="S4.Ex7.m1.3.3.1.2">|</mo><msub id="S4.Ex7.m1.3.3.1.3"><mi id="S4.Ex7.m1.3.3.1.3.2">L</mi><mi id="S4.Ex7.m1.3.3.1.3.3">B</mi></msub><mrow id="S4.Ex7.m1.3.3.1.4"><mo stretchy="false" id="S4.Ex7.m1.3.3.1.4.1">(</mo><mi id="S4.Ex7.m1.3.3.1.1">θ</mi><mo stretchy="false" id="S4.Ex7.m1.3.3.1.4.2">)</mo></mrow><mo id="S4.Ex7.m1.3.3.1.5">−</mo><msub id="S4.Ex7.m1.3.3.1.6"><mi id="S4.Ex7.m1.3.3.1.6.2">L</mi><mi id="S4.Ex7.m1.3.3.1.6.3">B</mi></msub><mrow id="S4.Ex7.m1.3.3.1.7"><mo stretchy="false" id="S4.Ex7.m1.3.3.1.7.1">(</mo><msup id="S4.Ex7.m1.3.3.1.7.2"><mi id="S4.Ex7.m1.3.3.1.7.2.2">θ</mi><mo id="S4.Ex7.m1.3.3.1.7.2.3">∗</mo></msup><mo stretchy="false" id="S4.Ex7.m1.3.3.1.7.3">)</mo></mrow><mo id="S4.Ex7.m1.3.3.1.8">≤</mo><mi id="S4.Ex7.m1.3.3.1.9">ϵ</mi></mrow></munder><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.8.8.3.2.2.2.2">​</mo><mrow id="S4.Ex7.m1.8.8.3.2.2.2.1.1"><mo stretchy="false" id="S4.Ex7.m1.8.8.3.2.2.2.1.1.2">|</mo><mrow id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1"><mrow id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.3"><msub id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.3.2"><mi id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.3.2.2">L</mi><mi id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.3.2.3">A</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.3.1">​</mo><mrow id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.3.3.2"><mo id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.3.3.2.1">(</mo><mi id="S4.Ex7.m1.5.5">θ</mi><mo id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.3.3.2.2">)</mo></mrow></mrow><mo id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.2">−</mo><mrow id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1"><msub id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.3"><mi id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.3.2">L</mi><mi id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.3.3">B</mi></msub><mo lspace="0em" rspace="0em" id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.2">​</mo><mrow id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.1.1"><mo id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.1.1.2">(</mo><msup id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.1.1.1"><mi id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.1.1.1.2">θ</mi><mo id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.1.1.1.3">∗</mo></msup><mo id="S4.Ex7.m1.8.8.3.2.2.2.1.1.1.1.1.1.3">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.Ex7.m1.8.8.3.2.2.2.1.1.3">|</mo></mrow></mrow><mo id="S4.Ex7.m1.8.8.3.2.2.5">}</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.Ex7.m1.8b">I\left(\theta^{*}\right)=max\left\{\underset{\lvert L_{A}(\theta)-L_{A}(\theta^{*})\rvert\leq\epsilon}{max}\lvert L_{B}\left(\theta\right)-L_{A}\left(\theta^{*}\right)\rvert,\underset{\lvert L_{B}(\theta)-L_{B}(\theta^{*})\leq\epsilon}{max}\lvert L_{A}\left(\theta\right)-L_{B}\left(\theta^{*}\right)\rvert\right\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.5" class="ltx_p">Based on the proof in Parascandolo’s paper <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>)</cite>, the Inconsistency Score is lowest when both <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">A</annotation></semantics></math> and <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.p3.2.m2.1a"><mi id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><ci id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">B</annotation></semantics></math> have the same curvature in Hessians: <math id="S4.p3.3.m3.3" class="ltx_Math" alttext="I\left(\theta^{*}\right)=\epsilon\cdot max\underset{i}{max}\left\{\frac{\lambda_{i}^{B}}{\lambda_{i}^{A}},\frac{\lambda_{i}^{A}}{\lambda_{i}^{B}}\right\}" display="inline"><semantics id="S4.p3.3.m3.3a"><mrow id="S4.p3.3.m3.3.3" xref="S4.p3.3.m3.3.3.cmml"><mrow id="S4.p3.3.m3.3.3.1" xref="S4.p3.3.m3.3.3.1.cmml"><mi id="S4.p3.3.m3.3.3.1.3" xref="S4.p3.3.m3.3.3.1.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.3.3.1.2" xref="S4.p3.3.m3.3.3.1.2.cmml">​</mo><mrow id="S4.p3.3.m3.3.3.1.1.1" xref="S4.p3.3.m3.3.3.1.1.1.1.cmml"><mo id="S4.p3.3.m3.3.3.1.1.1.2" xref="S4.p3.3.m3.3.3.1.1.1.1.cmml">(</mo><msup id="S4.p3.3.m3.3.3.1.1.1.1" xref="S4.p3.3.m3.3.3.1.1.1.1.cmml"><mi id="S4.p3.3.m3.3.3.1.1.1.1.2" xref="S4.p3.3.m3.3.3.1.1.1.1.2.cmml">θ</mi><mo id="S4.p3.3.m3.3.3.1.1.1.1.3" xref="S4.p3.3.m3.3.3.1.1.1.1.3.cmml">∗</mo></msup><mo id="S4.p3.3.m3.3.3.1.1.1.3" xref="S4.p3.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.p3.3.m3.3.3.2" xref="S4.p3.3.m3.3.3.2.cmml">=</mo><mrow id="S4.p3.3.m3.3.3.3" xref="S4.p3.3.m3.3.3.3.cmml"><mrow id="S4.p3.3.m3.3.3.3.2" xref="S4.p3.3.m3.3.3.3.2.cmml"><mi id="S4.p3.3.m3.3.3.3.2.2" xref="S4.p3.3.m3.3.3.3.2.2.cmml">ϵ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.p3.3.m3.3.3.3.2.1" xref="S4.p3.3.m3.3.3.3.2.1.cmml">⋅</mo><mi id="S4.p3.3.m3.3.3.3.2.3" xref="S4.p3.3.m3.3.3.3.2.3.cmml">m</mi></mrow><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.3.3.3.1" xref="S4.p3.3.m3.3.3.3.1.cmml">​</mo><mi id="S4.p3.3.m3.3.3.3.3" xref="S4.p3.3.m3.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.3.3.3.1a" xref="S4.p3.3.m3.3.3.3.1.cmml">​</mo><mi id="S4.p3.3.m3.3.3.3.4" xref="S4.p3.3.m3.3.3.3.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.3.3.3.1b" xref="S4.p3.3.m3.3.3.3.1.cmml">​</mo><munder accentunder="true" id="S4.p3.3.m3.3.3.3.5" xref="S4.p3.3.m3.3.3.3.5.cmml"><mrow id="S4.p3.3.m3.3.3.3.5.2" xref="S4.p3.3.m3.3.3.3.5.2.cmml"><mi id="S4.p3.3.m3.3.3.3.5.2.2" xref="S4.p3.3.m3.3.3.3.5.2.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.3.3.3.5.2.1" xref="S4.p3.3.m3.3.3.3.5.2.1.cmml">​</mo><mi id="S4.p3.3.m3.3.3.3.5.2.3" xref="S4.p3.3.m3.3.3.3.5.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.3.3.3.5.2.1a" xref="S4.p3.3.m3.3.3.3.5.2.1.cmml">​</mo><mi id="S4.p3.3.m3.3.3.3.5.2.4" xref="S4.p3.3.m3.3.3.3.5.2.4.cmml">x</mi></mrow><mo id="S4.p3.3.m3.3.3.3.5.1" xref="S4.p3.3.m3.3.3.3.5.1.cmml">𝑖</mo></munder><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.3.3.3.1c" xref="S4.p3.3.m3.3.3.3.1.cmml">​</mo><mrow id="S4.p3.3.m3.3.3.3.6.2" xref="S4.p3.3.m3.3.3.3.6.1.cmml"><mo id="S4.p3.3.m3.3.3.3.6.2.1" xref="S4.p3.3.m3.3.3.3.6.1.cmml">{</mo><mfrac id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><msubsup id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml"><mi id="S4.p3.3.m3.1.1.2.2.2" xref="S4.p3.3.m3.1.1.2.2.2.cmml">λ</mi><mi id="S4.p3.3.m3.1.1.2.2.3" xref="S4.p3.3.m3.1.1.2.2.3.cmml">i</mi><mi id="S4.p3.3.m3.1.1.2.3" xref="S4.p3.3.m3.1.1.2.3.cmml">B</mi></msubsup><msubsup id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml"><mi id="S4.p3.3.m3.1.1.3.2.2" xref="S4.p3.3.m3.1.1.3.2.2.cmml">λ</mi><mi id="S4.p3.3.m3.1.1.3.2.3" xref="S4.p3.3.m3.1.1.3.2.3.cmml">i</mi><mi id="S4.p3.3.m3.1.1.3.3" xref="S4.p3.3.m3.1.1.3.3.cmml">A</mi></msubsup></mfrac><mo id="S4.p3.3.m3.3.3.3.6.2.2" xref="S4.p3.3.m3.3.3.3.6.1.cmml">,</mo><mfrac id="S4.p3.3.m3.2.2" xref="S4.p3.3.m3.2.2.cmml"><msubsup id="S4.p3.3.m3.2.2.2" xref="S4.p3.3.m3.2.2.2.cmml"><mi id="S4.p3.3.m3.2.2.2.2.2" xref="S4.p3.3.m3.2.2.2.2.2.cmml">λ</mi><mi id="S4.p3.3.m3.2.2.2.2.3" xref="S4.p3.3.m3.2.2.2.2.3.cmml">i</mi><mi id="S4.p3.3.m3.2.2.2.3" xref="S4.p3.3.m3.2.2.2.3.cmml">A</mi></msubsup><msubsup id="S4.p3.3.m3.2.2.3" xref="S4.p3.3.m3.2.2.3.cmml"><mi id="S4.p3.3.m3.2.2.3.2.2" xref="S4.p3.3.m3.2.2.3.2.2.cmml">λ</mi><mi id="S4.p3.3.m3.2.2.3.2.3" xref="S4.p3.3.m3.2.2.3.2.3.cmml">i</mi><mi id="S4.p3.3.m3.2.2.3.3" xref="S4.p3.3.m3.2.2.3.3.cmml">B</mi></msubsup></mfrac><mo id="S4.p3.3.m3.3.3.3.6.2.3" xref="S4.p3.3.m3.3.3.3.6.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.3b"><apply id="S4.p3.3.m3.3.3.cmml" xref="S4.p3.3.m3.3.3"><eq id="S4.p3.3.m3.3.3.2.cmml" xref="S4.p3.3.m3.3.3.2"></eq><apply id="S4.p3.3.m3.3.3.1.cmml" xref="S4.p3.3.m3.3.3.1"><times id="S4.p3.3.m3.3.3.1.2.cmml" xref="S4.p3.3.m3.3.3.1.2"></times><ci id="S4.p3.3.m3.3.3.1.3.cmml" xref="S4.p3.3.m3.3.3.1.3">𝐼</ci><apply id="S4.p3.3.m3.3.3.1.1.1.1.cmml" xref="S4.p3.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.p3.3.m3.3.3.1.1.1.1.1.cmml" xref="S4.p3.3.m3.3.3.1.1.1">superscript</csymbol><ci id="S4.p3.3.m3.3.3.1.1.1.1.2.cmml" xref="S4.p3.3.m3.3.3.1.1.1.1.2">𝜃</ci><times id="S4.p3.3.m3.3.3.1.1.1.1.3.cmml" xref="S4.p3.3.m3.3.3.1.1.1.1.3"></times></apply></apply><apply id="S4.p3.3.m3.3.3.3.cmml" xref="S4.p3.3.m3.3.3.3"><times id="S4.p3.3.m3.3.3.3.1.cmml" xref="S4.p3.3.m3.3.3.3.1"></times><apply id="S4.p3.3.m3.3.3.3.2.cmml" xref="S4.p3.3.m3.3.3.3.2"><ci id="S4.p3.3.m3.3.3.3.2.1.cmml" xref="S4.p3.3.m3.3.3.3.2.1">⋅</ci><ci id="S4.p3.3.m3.3.3.3.2.2.cmml" xref="S4.p3.3.m3.3.3.3.2.2">italic-ϵ</ci><ci id="S4.p3.3.m3.3.3.3.2.3.cmml" xref="S4.p3.3.m3.3.3.3.2.3">𝑚</ci></apply><ci id="S4.p3.3.m3.3.3.3.3.cmml" xref="S4.p3.3.m3.3.3.3.3">𝑎</ci><ci id="S4.p3.3.m3.3.3.3.4.cmml" xref="S4.p3.3.m3.3.3.3.4">𝑥</ci><apply id="S4.p3.3.m3.3.3.3.5.cmml" xref="S4.p3.3.m3.3.3.3.5"><ci id="S4.p3.3.m3.3.3.3.5.1.cmml" xref="S4.p3.3.m3.3.3.3.5.1">𝑖</ci><apply id="S4.p3.3.m3.3.3.3.5.2.cmml" xref="S4.p3.3.m3.3.3.3.5.2"><times id="S4.p3.3.m3.3.3.3.5.2.1.cmml" xref="S4.p3.3.m3.3.3.3.5.2.1"></times><ci id="S4.p3.3.m3.3.3.3.5.2.2.cmml" xref="S4.p3.3.m3.3.3.3.5.2.2">𝑚</ci><ci id="S4.p3.3.m3.3.3.3.5.2.3.cmml" xref="S4.p3.3.m3.3.3.3.5.2.3">𝑎</ci><ci id="S4.p3.3.m3.3.3.3.5.2.4.cmml" xref="S4.p3.3.m3.3.3.3.5.2.4">𝑥</ci></apply></apply><set id="S4.p3.3.m3.3.3.3.6.1.cmml" xref="S4.p3.3.m3.3.3.3.6.2"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><divide id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1"></divide><apply id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.2.1.cmml" xref="S4.p3.3.m3.1.1.2">superscript</csymbol><apply id="S4.p3.3.m3.1.1.2.2.cmml" xref="S4.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.2.2.1.cmml" xref="S4.p3.3.m3.1.1.2">subscript</csymbol><ci id="S4.p3.3.m3.1.1.2.2.2.cmml" xref="S4.p3.3.m3.1.1.2.2.2">𝜆</ci><ci id="S4.p3.3.m3.1.1.2.2.3.cmml" xref="S4.p3.3.m3.1.1.2.2.3">𝑖</ci></apply><ci id="S4.p3.3.m3.1.1.2.3.cmml" xref="S4.p3.3.m3.1.1.2.3">𝐵</ci></apply><apply id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.3.1.cmml" xref="S4.p3.3.m3.1.1.3">superscript</csymbol><apply id="S4.p3.3.m3.1.1.3.2.cmml" xref="S4.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.3.2.1.cmml" xref="S4.p3.3.m3.1.1.3">subscript</csymbol><ci id="S4.p3.3.m3.1.1.3.2.2.cmml" xref="S4.p3.3.m3.1.1.3.2.2">𝜆</ci><ci id="S4.p3.3.m3.1.1.3.2.3.cmml" xref="S4.p3.3.m3.1.1.3.2.3">𝑖</ci></apply><ci id="S4.p3.3.m3.1.1.3.3.cmml" xref="S4.p3.3.m3.1.1.3.3">𝐴</ci></apply></apply><apply id="S4.p3.3.m3.2.2.cmml" xref="S4.p3.3.m3.2.2"><divide id="S4.p3.3.m3.2.2.1.cmml" xref="S4.p3.3.m3.2.2"></divide><apply id="S4.p3.3.m3.2.2.2.cmml" xref="S4.p3.3.m3.2.2.2"><csymbol cd="ambiguous" id="S4.p3.3.m3.2.2.2.1.cmml" xref="S4.p3.3.m3.2.2.2">superscript</csymbol><apply id="S4.p3.3.m3.2.2.2.2.cmml" xref="S4.p3.3.m3.2.2.2"><csymbol cd="ambiguous" id="S4.p3.3.m3.2.2.2.2.1.cmml" xref="S4.p3.3.m3.2.2.2">subscript</csymbol><ci id="S4.p3.3.m3.2.2.2.2.2.cmml" xref="S4.p3.3.m3.2.2.2.2.2">𝜆</ci><ci id="S4.p3.3.m3.2.2.2.2.3.cmml" xref="S4.p3.3.m3.2.2.2.2.3">𝑖</ci></apply><ci id="S4.p3.3.m3.2.2.2.3.cmml" xref="S4.p3.3.m3.2.2.2.3">𝐴</ci></apply><apply id="S4.p3.3.m3.2.2.3.cmml" xref="S4.p3.3.m3.2.2.3"><csymbol cd="ambiguous" id="S4.p3.3.m3.2.2.3.1.cmml" xref="S4.p3.3.m3.2.2.3">superscript</csymbol><apply id="S4.p3.3.m3.2.2.3.2.cmml" xref="S4.p3.3.m3.2.2.3"><csymbol cd="ambiguous" id="S4.p3.3.m3.2.2.3.2.1.cmml" xref="S4.p3.3.m3.2.2.3">subscript</csymbol><ci id="S4.p3.3.m3.2.2.3.2.2.cmml" xref="S4.p3.3.m3.2.2.3.2.2">𝜆</ci><ci id="S4.p3.3.m3.2.2.3.2.3.cmml" xref="S4.p3.3.m3.2.2.3.2.3">𝑖</ci></apply><ci id="S4.p3.3.m3.2.2.3.3.cmml" xref="S4.p3.3.m3.2.2.3.3">𝐵</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.3c">I\left(\theta^{*}\right)=\epsilon\cdot max\underset{i}{max}\left\{\frac{\lambda_{i}^{B}}{\lambda_{i}^{A}},\frac{\lambda_{i}^{A}}{\lambda_{i}^{B}}\right\}</annotation></semantics></math> where <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="H_{A}" display="inline"><semantics id="S4.p3.4.m4.1a"><msub id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml"><mi id="S4.p3.4.m4.1.1.2" xref="S4.p3.4.m4.1.1.2.cmml">H</mi><mi id="S4.p3.4.m4.1.1.3" xref="S4.p3.4.m4.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><apply id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p3.4.m4.1.1.1.cmml" xref="S4.p3.4.m4.1.1">subscript</csymbol><ci id="S4.p3.4.m4.1.1.2.cmml" xref="S4.p3.4.m4.1.1.2">𝐻</ci><ci id="S4.p3.4.m4.1.1.3.cmml" xref="S4.p3.4.m4.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">H_{A}</annotation></semantics></math> and <math id="S4.p3.5.m5.1" class="ltx_Math" alttext="H_{B}" display="inline"><semantics id="S4.p3.5.m5.1a"><msub id="S4.p3.5.m5.1.1" xref="S4.p3.5.m5.1.1.cmml"><mi id="S4.p3.5.m5.1.1.2" xref="S4.p3.5.m5.1.1.2.cmml">H</mi><mi id="S4.p3.5.m5.1.1.3" xref="S4.p3.5.m5.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.5.m5.1b"><apply id="S4.p3.5.m5.1.1.cmml" xref="S4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p3.5.m5.1.1.1.cmml" xref="S4.p3.5.m5.1.1">subscript</csymbol><ci id="S4.p3.5.m5.1.1.2.cmml" xref="S4.p3.5.m5.1.1.2">𝐻</ci><ci id="S4.p3.5.m5.1.1.3.cmml" xref="S4.p3.5.m5.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m5.1c">H_{B}</annotation></semantics></math> have the similar eigenvalues.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">Our proposed methods, including both Fishr+Inter-Geo and Fishr+Intra-Geo, successfully reduces the Inconsistency Score <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="I\left(\theta^{*}\right)" display="inline"><semantics id="S4.p4.1.m1.1a"><mrow id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mi id="S4.p4.1.m1.1.1.3" xref="S4.p4.1.m1.1.1.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml">​</mo><mrow id="S4.p4.1.m1.1.1.1.1" xref="S4.p4.1.m1.1.1.1.1.1.cmml"><mo id="S4.p4.1.m1.1.1.1.1.2" xref="S4.p4.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.p4.1.m1.1.1.1.1.1" xref="S4.p4.1.m1.1.1.1.1.1.cmml"><mi id="S4.p4.1.m1.1.1.1.1.1.2" xref="S4.p4.1.m1.1.1.1.1.1.2.cmml">θ</mi><mo id="S4.p4.1.m1.1.1.1.1.1.3" xref="S4.p4.1.m1.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S4.p4.1.m1.1.1.1.1.3" xref="S4.p4.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><times id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2"></times><ci id="S4.p4.1.m1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.3">𝐼</ci><apply id="S4.p4.1.m1.1.1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.p4.1.m1.1.1.1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.1.1.1.2">𝜃</ci><times id="S4.p4.1.m1.1.1.1.1.1.3.cmml" xref="S4.p4.1.m1.1.1.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">I\left(\theta^{*}\right)</annotation></semantics></math>, thus promotes the consistencies across different environments. The justifications are as follows:</p>
</div>
<div id="S4.p5" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.5" class="ltx_p">Based on Parascandolo’s paper, by employing the geometric mean <math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="H^{\wedge}" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><msup id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">H</mi><mo id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">∧</mo></msup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">superscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝐻</ci><and id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3"></and></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">H^{\wedge}</annotation></semantics></math> in lieu of the arithmetic mean <math id="S4.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="H^{+}" display="inline"><semantics id="S4.I1.i1.p1.2.m2.1a"><msup id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml"><mi id="S4.I1.i1.p1.2.m2.1.1.2" xref="S4.I1.i1.p1.2.m2.1.1.2.cmml">H</mi><mo id="S4.I1.i1.p1.2.m2.1.1.3" xref="S4.I1.i1.p1.2.m2.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><apply id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.2.m2.1.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">superscript</csymbol><ci id="S4.I1.i1.p1.2.m2.1.1.2.cmml" xref="S4.I1.i1.p1.2.m2.1.1.2">𝐻</ci><plus id="S4.I1.i1.p1.2.m2.1.1.3.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">H^{+}</annotation></semantics></math> of Hessians, we can <span id="S4.I1.i1.p1.5.1" class="ltx_text ltx_font_bold">reduce the training speed</span> of convergence on directions where landscapes with different curvatures might lead to a high inconsistency in Hessians <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>)</cite>. Therefore, the model is more likely to find the consistent minimizers, where their Hessians have similar eigenvalues <math id="S4.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="\lambda_{i}^{A}" display="inline"><semantics id="S4.I1.i1.p1.3.m3.1a"><msubsup id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml"><mi id="S4.I1.i1.p1.3.m3.1.1.2.2" xref="S4.I1.i1.p1.3.m3.1.1.2.2.cmml">λ</mi><mi id="S4.I1.i1.p1.3.m3.1.1.2.3" xref="S4.I1.i1.p1.3.m3.1.1.2.3.cmml">i</mi><mi id="S4.I1.i1.p1.3.m3.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.3.cmml">A</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><apply id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.3.m3.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.2.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.3.m3.1.1.2.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.2.2">𝜆</ci><ci id="S4.I1.i1.p1.3.m3.1.1.2.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S4.I1.i1.p1.3.m3.1.1.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">\lambda_{i}^{A}</annotation></semantics></math> and <math id="S4.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="\lambda_{i}^{B}" display="inline"><semantics id="S4.I1.i1.p1.4.m4.1a"><msubsup id="S4.I1.i1.p1.4.m4.1.1" xref="S4.I1.i1.p1.4.m4.1.1.cmml"><mi id="S4.I1.i1.p1.4.m4.1.1.2.2" xref="S4.I1.i1.p1.4.m4.1.1.2.2.cmml">λ</mi><mi id="S4.I1.i1.p1.4.m4.1.1.2.3" xref="S4.I1.i1.p1.4.m4.1.1.2.3.cmml">i</mi><mi id="S4.I1.i1.p1.4.m4.1.1.3" xref="S4.I1.i1.p1.4.m4.1.1.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.4.m4.1b"><apply id="S4.I1.i1.p1.4.m4.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.1.1.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1">superscript</csymbol><apply id="S4.I1.i1.p1.4.m4.1.1.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.4.m4.1.1.2.1.cmml" xref="S4.I1.i1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.4.m4.1.1.2.2.cmml" xref="S4.I1.i1.p1.4.m4.1.1.2.2">𝜆</ci><ci id="S4.I1.i1.p1.4.m4.1.1.2.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S4.I1.i1.p1.4.m4.1.1.3.cmml" xref="S4.I1.i1.p1.4.m4.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.4.m4.1c">\lambda_{i}^{B}</annotation></semantics></math>, thus minimizing the Inconsistency Score <math id="S4.I1.i1.p1.5.m5.1" class="ltx_Math" alttext="I\left(\theta^{*}\right)" display="inline"><semantics id="S4.I1.i1.p1.5.m5.1a"><mrow id="S4.I1.i1.p1.5.m5.1.1" xref="S4.I1.i1.p1.5.m5.1.1.cmml"><mi id="S4.I1.i1.p1.5.m5.1.1.3" xref="S4.I1.i1.p1.5.m5.1.1.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.I1.i1.p1.5.m5.1.1.2" xref="S4.I1.i1.p1.5.m5.1.1.2.cmml">​</mo><mrow id="S4.I1.i1.p1.5.m5.1.1.1.1" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml"><mo id="S4.I1.i1.p1.5.m5.1.1.1.1.2" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml">(</mo><msup id="S4.I1.i1.p1.5.m5.1.1.1.1.1" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml"><mi id="S4.I1.i1.p1.5.m5.1.1.1.1.1.2" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.cmml">θ</mi><mo id="S4.I1.i1.p1.5.m5.1.1.1.1.1.3" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S4.I1.i1.p1.5.m5.1.1.1.1.3" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.5.m5.1b"><apply id="S4.I1.i1.p1.5.m5.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1"><times id="S4.I1.i1.p1.5.m5.1.1.2.cmml" xref="S4.I1.i1.p1.5.m5.1.1.2"></times><ci id="S4.I1.i1.p1.5.m5.1.1.3.cmml" xref="S4.I1.i1.p1.5.m5.1.1.3">𝐼</ci><apply id="S4.I1.i1.p1.5.m5.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1">superscript</csymbol><ci id="S4.I1.i1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.2">𝜃</ci><times id="S4.I1.i1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S4.I1.i1.p1.5.m5.1.1.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.5.m5.1c">I\left(\theta^{*}\right)</annotation></semantics></math>.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.11" class="ltx_p">Based on Fishr paper, the gradient covariance <math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">C</annotation></semantics></math> is equivalent to the Fishr Information Matrix <math id="S4.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="\tilde{F}" display="inline"><semantics id="S4.I1.i2.p1.2.m2.1a"><mover accent="true" id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.2" xref="S4.I1.i2.p1.2.m2.1.1.2.cmml">F</mi><mo id="S4.I1.i2.p1.2.m2.1.1.1" xref="S4.I1.i2.p1.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><ci id="S4.I1.i2.p1.2.m2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1.1">~</ci><ci id="S4.I1.i2.p1.2.m2.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">\tilde{F}</annotation></semantics></math> at any first-order stationary point: <math id="S4.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="C{\propto}\tilde{F}" display="inline"><semantics id="S4.I1.i2.p1.3.m3.1a"><mrow id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml">C</mi><mo id="S4.I1.i2.p1.3.m3.1.1.1" xref="S4.I1.i2.p1.3.m3.1.1.1.cmml">∝</mo><mover accent="true" id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.3.2" xref="S4.I1.i2.p1.3.m3.1.1.3.2.cmml">F</mi><mo id="S4.I1.i2.p1.3.m3.1.1.3.1" xref="S4.I1.i2.p1.3.m3.1.1.3.1.cmml">~</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1">proportional-to</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">𝐶</ci><apply id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3"><ci id="S4.I1.i2.p1.3.m3.1.1.3.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.1">~</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.2">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">C{\propto}\tilde{F}</annotation></semantics></math>. Further, many research works have proved that the Fishr Information Matrix <math id="S4.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="\tilde{F}" display="inline"><semantics id="S4.I1.i2.p1.4.m4.1a"><mover accent="true" id="S4.I1.i2.p1.4.m4.1.1" xref="S4.I1.i2.p1.4.m4.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.1.1.2" xref="S4.I1.i2.p1.4.m4.1.1.2.cmml">F</mi><mo id="S4.I1.i2.p1.4.m4.1.1.1" xref="S4.I1.i2.p1.4.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.1b"><apply id="S4.I1.i2.p1.4.m4.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1"><ci id="S4.I1.i2.p1.4.m4.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1.1">~</ci><ci id="S4.I1.i2.p1.4.m4.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.1c">\tilde{F}</annotation></semantics></math> and Hessians <math id="S4.I1.i2.p1.5.m5.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S4.I1.i2.p1.5.m5.1a"><mi id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><ci id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">H</annotation></semantics></math> share the same structure and are similar up to a scalar factor: <math id="S4.I1.i2.p1.6.m6.1" class="ltx_Math" alttext="\tilde{F}{\propto}H" display="inline"><semantics id="S4.I1.i2.p1.6.m6.1a"><mrow id="S4.I1.i2.p1.6.m6.1.1" xref="S4.I1.i2.p1.6.m6.1.1.cmml"><mover accent="true" id="S4.I1.i2.p1.6.m6.1.1.2" xref="S4.I1.i2.p1.6.m6.1.1.2.cmml"><mi id="S4.I1.i2.p1.6.m6.1.1.2.2" xref="S4.I1.i2.p1.6.m6.1.1.2.2.cmml">F</mi><mo id="S4.I1.i2.p1.6.m6.1.1.2.1" xref="S4.I1.i2.p1.6.m6.1.1.2.1.cmml">~</mo></mover><mo id="S4.I1.i2.p1.6.m6.1.1.1" xref="S4.I1.i2.p1.6.m6.1.1.1.cmml">∝</mo><mi id="S4.I1.i2.p1.6.m6.1.1.3" xref="S4.I1.i2.p1.6.m6.1.1.3.cmml">H</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.6.m6.1b"><apply id="S4.I1.i2.p1.6.m6.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.6.m6.1.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1.1">proportional-to</csymbol><apply id="S4.I1.i2.p1.6.m6.1.1.2.cmml" xref="S4.I1.i2.p1.6.m6.1.1.2"><ci id="S4.I1.i2.p1.6.m6.1.1.2.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1.2.1">~</ci><ci id="S4.I1.i2.p1.6.m6.1.1.2.2.cmml" xref="S4.I1.i2.p1.6.m6.1.1.2.2">𝐹</ci></apply><ci id="S4.I1.i2.p1.6.m6.1.1.3.cmml" xref="S4.I1.i2.p1.6.m6.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.6.m6.1c">\tilde{F}{\propto}H</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib38" title="" class="ltx_ref">38</a>; <a href="#bib.bib39" title="" class="ltx_ref">39</a>; <a href="#bib.bib40" title="" class="ltx_ref">40</a>)</cite>. Therefore, <span id="S4.I1.i2.p1.8.2" class="ltx_text ltx_font_bold">the gradient covariance <math id="S4.I1.i2.p1.7.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.I1.i2.p1.7.1.m1.1a"><mi id="S4.I1.i2.p1.7.1.m1.1.1" xref="S4.I1.i2.p1.7.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.7.1.m1.1b"><ci id="S4.I1.i2.p1.7.1.m1.1.1.cmml" xref="S4.I1.i2.p1.7.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.7.1.m1.1c">C</annotation></semantics></math> is closely related to Hessians <math id="S4.I1.i2.p1.8.2.m2.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S4.I1.i2.p1.8.2.m2.1a"><mi id="S4.I1.i2.p1.8.2.m2.1.1" xref="S4.I1.i2.p1.8.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.8.2.m2.1b"><ci id="S4.I1.i2.p1.8.2.m2.1.1.cmml" xref="S4.I1.i2.p1.8.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.8.2.m2.1c">H</annotation></semantics></math> </span>: <math id="S4.I1.i2.p1.9.m7.1" class="ltx_Math" alttext="C{\propto}H" display="inline"><semantics id="S4.I1.i2.p1.9.m7.1a"><mrow id="S4.I1.i2.p1.9.m7.1.1" xref="S4.I1.i2.p1.9.m7.1.1.cmml"><mi id="S4.I1.i2.p1.9.m7.1.1.2" xref="S4.I1.i2.p1.9.m7.1.1.2.cmml">C</mi><mo id="S4.I1.i2.p1.9.m7.1.1.1" xref="S4.I1.i2.p1.9.m7.1.1.1.cmml">∝</mo><mi id="S4.I1.i2.p1.9.m7.1.1.3" xref="S4.I1.i2.p1.9.m7.1.1.3.cmml">H</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.9.m7.1b"><apply id="S4.I1.i2.p1.9.m7.1.1.cmml" xref="S4.I1.i2.p1.9.m7.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.9.m7.1.1.1.cmml" xref="S4.I1.i2.p1.9.m7.1.1.1">proportional-to</csymbol><ci id="S4.I1.i2.p1.9.m7.1.1.2.cmml" xref="S4.I1.i2.p1.9.m7.1.1.2">𝐶</ci><ci id="S4.I1.i2.p1.9.m7.1.1.3.cmml" xref="S4.I1.i2.p1.9.m7.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.9.m7.1c">C{\propto}H</annotation></semantics></math>. Therefore, employing Fishr loss can further enforce Hessians <math id="S4.I1.i2.p1.10.m8.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S4.I1.i2.p1.10.m8.1a"><mi id="S4.I1.i2.p1.10.m8.1.1" xref="S4.I1.i2.p1.10.m8.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.10.m8.1b"><ci id="S4.I1.i2.p1.10.m8.1.1.cmml" xref="S4.I1.i2.p1.10.m8.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.10.m8.1c">H</annotation></semantics></math> to be similar, thus minimizing the Inconsistency Score <math id="S4.I1.i2.p1.11.m9.1" class="ltx_Math" alttext="I\left(\theta^{*}\right)" display="inline"><semantics id="S4.I1.i2.p1.11.m9.1a"><mrow id="S4.I1.i2.p1.11.m9.1.1" xref="S4.I1.i2.p1.11.m9.1.1.cmml"><mi id="S4.I1.i2.p1.11.m9.1.1.3" xref="S4.I1.i2.p1.11.m9.1.1.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.I1.i2.p1.11.m9.1.1.2" xref="S4.I1.i2.p1.11.m9.1.1.2.cmml">​</mo><mrow id="S4.I1.i2.p1.11.m9.1.1.1.1" xref="S4.I1.i2.p1.11.m9.1.1.1.1.1.cmml"><mo id="S4.I1.i2.p1.11.m9.1.1.1.1.2" xref="S4.I1.i2.p1.11.m9.1.1.1.1.1.cmml">(</mo><msup id="S4.I1.i2.p1.11.m9.1.1.1.1.1" xref="S4.I1.i2.p1.11.m9.1.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.11.m9.1.1.1.1.1.2" xref="S4.I1.i2.p1.11.m9.1.1.1.1.1.2.cmml">θ</mi><mo id="S4.I1.i2.p1.11.m9.1.1.1.1.1.3" xref="S4.I1.i2.p1.11.m9.1.1.1.1.1.3.cmml">∗</mo></msup><mo id="S4.I1.i2.p1.11.m9.1.1.1.1.3" xref="S4.I1.i2.p1.11.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.11.m9.1b"><apply id="S4.I1.i2.p1.11.m9.1.1.cmml" xref="S4.I1.i2.p1.11.m9.1.1"><times id="S4.I1.i2.p1.11.m9.1.1.2.cmml" xref="S4.I1.i2.p1.11.m9.1.1.2"></times><ci id="S4.I1.i2.p1.11.m9.1.1.3.cmml" xref="S4.I1.i2.p1.11.m9.1.1.3">𝐼</ci><apply id="S4.I1.i2.p1.11.m9.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.11.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.11.m9.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.11.m9.1.1.1.1">superscript</csymbol><ci id="S4.I1.i2.p1.11.m9.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.11.m9.1.1.1.1.1.2">𝜃</ci><times id="S4.I1.i2.p1.11.m9.1.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.11.m9.1.1.1.1.1.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.11.m9.1c">I\left(\theta^{*}\right)</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We conduct extensive experiments of FedILC on the Color-MNIST dataset <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib13" title="" class="ltx_ref">13</a>)</cite>, Rotated-CIFAR10 dataset, and the real-world eICU dataset. Further, we compare the performance of six different methodologies, including the conventional baseline algorithm FedSGD, the state-of-the-art baseline algorithm FedCurv, two baseline algorithms developed by ourselves, and our nascently proposed algorithms Fishr+Inter-Geo and Fishr+Intra-Geo:</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Baseline methods:</span></p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">FedSGD: the baseline federated learning algorithm which performs the arithmetic mean of the uploaded clients’ gradients.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">FedCurv: the state-of-the-art baseline federated learning algorithm which integrates with vanilla Fishr regularization.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">Geometric: the federated learning algorithm which performs the weighted geometric mean of the uploaded clients’ gradients.</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p">Fishr+Intra-Arith: Fishr and intra-silo arithmetic mean algorithm for comparison purpose.</p>
</div>
</li>
</ul>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">Proposed methods:</span></p>
<ul id="S5.I2" class="ltx_itemize">
<li id="S5.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i1.p1" class="ltx_para">
<p id="S5.I2.i1.p1.1" class="ltx_p">Fishr+Inter-Geo: Fishr and inter-silo weighted geometric mean algorithm.</p>
</div>
</li>
<li id="S5.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I2.i2.p1" class="ltx_para">
<p id="S5.I2.i2.p1.1" class="ltx_p">Fishr+Intra-Geo: Fishr and intra-silo weighted geometric mean algorithm.</p>
</div>
</li>
</ul>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.2" class="ltx_p">Notably, as suggested by Rame in his paper, it is sufficient to calculate Fishr with the gradients in the final linear classifier, which essentially reduces the memory overhead <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib20" title="" class="ltx_ref">20</a>)</cite>. Furthermore, research has manifested that low-level layers are paramount to domain-dependent peculiarities, and the final layers of a neural network are most prone to overfit to the client distribution <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib41" title="" class="ltx_ref">41</a>)</cite>. Rame also mentioned that we could further scale down the computational cost by applying the gradient variance, the diagonal of the covariance matrix <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="Diag(C)" display="inline"><semantics id="S5.p4.1.m1.1a"><mrow id="S5.p4.1.m1.1.2" xref="S5.p4.1.m1.1.2.cmml"><mi id="S5.p4.1.m1.1.2.2" xref="S5.p4.1.m1.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S5.p4.1.m1.1.2.1" xref="S5.p4.1.m1.1.2.1.cmml">​</mo><mi id="S5.p4.1.m1.1.2.3" xref="S5.p4.1.m1.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.p4.1.m1.1.2.1a" xref="S5.p4.1.m1.1.2.1.cmml">​</mo><mi id="S5.p4.1.m1.1.2.4" xref="S5.p4.1.m1.1.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.p4.1.m1.1.2.1b" xref="S5.p4.1.m1.1.2.1.cmml">​</mo><mi id="S5.p4.1.m1.1.2.5" xref="S5.p4.1.m1.1.2.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.p4.1.m1.1.2.1c" xref="S5.p4.1.m1.1.2.1.cmml">​</mo><mrow id="S5.p4.1.m1.1.2.6.2" xref="S5.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S5.p4.1.m1.1.2.6.2.1" xref="S5.p4.1.m1.1.2.cmml">(</mo><mi id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">C</mi><mo stretchy="false" id="S5.p4.1.m1.1.2.6.2.2" xref="S5.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><apply id="S5.p4.1.m1.1.2.cmml" xref="S5.p4.1.m1.1.2"><times id="S5.p4.1.m1.1.2.1.cmml" xref="S5.p4.1.m1.1.2.1"></times><ci id="S5.p4.1.m1.1.2.2.cmml" xref="S5.p4.1.m1.1.2.2">𝐷</ci><ci id="S5.p4.1.m1.1.2.3.cmml" xref="S5.p4.1.m1.1.2.3">𝑖</ci><ci id="S5.p4.1.m1.1.2.4.cmml" xref="S5.p4.1.m1.1.2.4">𝑎</ci><ci id="S5.p4.1.m1.1.2.5.cmml" xref="S5.p4.1.m1.1.2.5">𝑔</ci><ci id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">Diag(C)</annotation></semantics></math>, because the empirical evidence has unveiled that the diagonal of Hessians <math id="S5.p4.2.m2.1" class="ltx_Math" alttext="Diag(H)" display="inline"><semantics id="S5.p4.2.m2.1a"><mrow id="S5.p4.2.m2.1.2" xref="S5.p4.2.m2.1.2.cmml"><mi id="S5.p4.2.m2.1.2.2" xref="S5.p4.2.m2.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S5.p4.2.m2.1.2.1" xref="S5.p4.2.m2.1.2.1.cmml">​</mo><mi id="S5.p4.2.m2.1.2.3" xref="S5.p4.2.m2.1.2.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S5.p4.2.m2.1.2.1a" xref="S5.p4.2.m2.1.2.1.cmml">​</mo><mi id="S5.p4.2.m2.1.2.4" xref="S5.p4.2.m2.1.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.p4.2.m2.1.2.1b" xref="S5.p4.2.m2.1.2.1.cmml">​</mo><mi id="S5.p4.2.m2.1.2.5" xref="S5.p4.2.m2.1.2.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.p4.2.m2.1.2.1c" xref="S5.p4.2.m2.1.2.1.cmml">​</mo><mrow id="S5.p4.2.m2.1.2.6.2" xref="S5.p4.2.m2.1.2.cmml"><mo stretchy="false" id="S5.p4.2.m2.1.2.6.2.1" xref="S5.p4.2.m2.1.2.cmml">(</mo><mi id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml">H</mi><mo stretchy="false" id="S5.p4.2.m2.1.2.6.2.2" xref="S5.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p4.2.m2.1b"><apply id="S5.p4.2.m2.1.2.cmml" xref="S5.p4.2.m2.1.2"><times id="S5.p4.2.m2.1.2.1.cmml" xref="S5.p4.2.m2.1.2.1"></times><ci id="S5.p4.2.m2.1.2.2.cmml" xref="S5.p4.2.m2.1.2.2">𝐷</ci><ci id="S5.p4.2.m2.1.2.3.cmml" xref="S5.p4.2.m2.1.2.3">𝑖</ci><ci id="S5.p4.2.m2.1.2.4.cmml" xref="S5.p4.2.m2.1.2.4">𝑎</ci><ci id="S5.p4.2.m2.1.2.5.cmml" xref="S5.p4.2.m2.1.2.5">𝑔</ci><ci id="S5.p4.2.m2.1.1.cmml" xref="S5.p4.2.m2.1.1">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.2.m2.1c">Diag(H)</annotation></semantics></math> are prominent at the end of training <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib42" title="" class="ltx_ref">42</a>; <a href="#bib.bib43" title="" class="ltx_ref">43</a>; <a href="#bib.bib44" title="" class="ltx_ref">44</a>)</cite>. Therefore, in our implementation of Fishr, we only consider the gradient variance in lieu of covariance in the final linear classifier of each client’s model. Moreover, regarding the Fishr and inter-silo weighted geometric mean algorithm (Fishr+Inter-Geo), computing per-sample weighted geometric mean may also become computationally expensive, especially when the federated client has a copious amount of data. Therefore, we purvey a scalable solution by calculating the weighted geometric mean of mini-batch gradients within each client, which largely mitigates the computational overhead.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Environment Setup</h3>

<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1 </span>Color-MNIST</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.p1.1" class="ltx_p">In the Color-MNIST dataset <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib13" title="" class="ltx_ref">13</a>)</cite>, the color of digits is spuriously pertinent to the labels. We assume five clients in the federated networks with different feature heterogeneity, whose color of digits is randomly flipped with a probability of 15%, 30%, 45%, 60%, and 75%, respectively. We also create an OOD test set with a color flipping probability of 90% and a label flipping probability of 15% to evaluate the generalizability of the global model. The goal is to solve a binary classification problem and predict whether a given digit is below or above 5. Therefore, we create a 3-layer MLP model with 390, 390, and 1 neuron in the corresponding layer. We also adopt the Adam optimizer with a fixed learning rate of 0.0003 and weight decay of 0.01. Critically, we choose the coefficient <math id="S5.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\lambda=15.0" display="inline"><semantics id="S5.SS1.SSS1.p1.1.m1.1a"><mrow id="S5.SS1.SSS1.p1.1.m1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS1.p1.1.m1.1.1.2" xref="S5.SS1.SSS1.p1.1.m1.1.1.2.cmml">λ</mi><mo id="S5.SS1.SSS1.p1.1.m1.1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS1.p1.1.m1.1.1.3" xref="S5.SS1.SSS1.p1.1.m1.1.1.3.cmml">15.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.1.m1.1b"><apply id="S5.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1"><eq id="S5.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1.1"></eq><ci id="S5.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1.2">𝜆</ci><cn type="float" id="S5.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1.3">15.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.1.m1.1c">\lambda=15.0</annotation></semantics></math> to control the Fishr regularization strength.</p>
</div>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2 </span>Rotated-CIFAR10</h4>

<figure id="S5.T1" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S5.T1.3.2" class="ltx_text" style="font-size:90%;">Experiment setup of Rotated-CIFAR10 involves three clients with distinct rotation degrees. Each client also contains three sub-environments to simulate intra-silo feature heterogeneity.</span></figcaption>
<table id="S5.T1.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.4.1.1" class="ltx_tr">
<td id="S5.T1.4.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S5.T1.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Sub Env 1</th>
<th id="S5.T1.4.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Sub Env 2</th>
<th id="S5.T1.4.1.1.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt">Sub Env 3</th>
</tr>
<tr id="S5.T1.4.2.2" class="ltx_tr">
<td id="S5.T1.4.2.2.1" class="ltx_td ltx_align_left ltx_border_t">Client 1</td>
<td id="S5.T1.4.2.2.2" class="ltx_td ltx_align_left ltx_border_t">10°</td>
<td id="S5.T1.4.2.2.3" class="ltx_td ltx_align_left ltx_border_t">25°</td>
<td id="S5.T1.4.2.2.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">40°</td>
</tr>
<tr id="S5.T1.4.3.3" class="ltx_tr">
<td id="S5.T1.4.3.3.1" class="ltx_td ltx_align_left">Client 2</td>
<td id="S5.T1.4.3.3.2" class="ltx_td ltx_align_left">60°</td>
<td id="S5.T1.4.3.3.3" class="ltx_td ltx_align_left">75°</td>
<td id="S5.T1.4.3.3.4" class="ltx_td ltx_nopad_r ltx_align_left">90°</td>
</tr>
<tr id="S5.T1.4.4.4" class="ltx_tr">
<td id="S5.T1.4.4.4.1" class="ltx_td ltx_align_left ltx_border_bb">Client 3</td>
<td id="S5.T1.4.4.4.2" class="ltx_td ltx_align_left ltx_border_bb">-10°</td>
<td id="S5.T1.4.4.4.3" class="ltx_td ltx_align_left ltx_border_bb">-40°</td>
<td id="S5.T1.4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">-90°</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.SSS2.p1" class="ltx_para">
<p id="S5.SS1.SSS2.p1.1" class="ltx_p">Based on the conventional CIFAR10 dataset <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib45" title="" class="ltx_ref">45</a>)</cite>, we also develop our own synthetic dataset - Rotated-CIFAR10 as our benchmark dataset. We rotate CIFAR10 images with different angles to simulate the non-i.i.d. data in the federated networks. In our federated learning settings, there are three clients with distinct data distributions. Further, we also establish three sub-environments in each client to simulate intra-silo feature heterogeneity. The experiment setup is demonstrated in Table <a href="#S5.T1" title="Table 1 ‣ 5.1.2 Rotated-CIFAR10 ‣ 5.1 Environment Setup ‣ 5 Experiments ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Moreover, the OOD test set is configured with a rotation degree from -90° to 90° to evaluate the performance of the global model. Our goal is to correctly classify the 32x32 RGB colored images with 10 classes. Therefore, we adopt a 3-layer CNN architecture as our classification model. We also use the Adam optimizer with a fixed learning rate of 0.0001 and a weight decay of 0.001. Particularly, we select <math id="S5.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\lambda=1.0" display="inline"><semantics id="S5.SS1.SSS2.p1.1.m1.1a"><mrow id="S5.SS1.SSS2.p1.1.m1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS2.p1.1.m1.1.1.2" xref="S5.SS1.SSS2.p1.1.m1.1.1.2.cmml">λ</mi><mo id="S5.SS1.SSS2.p1.1.m1.1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS2.p1.1.m1.1.1.3" xref="S5.SS1.SSS2.p1.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.1.m1.1b"><apply id="S5.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1"><eq id="S5.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1.1"></eq><ci id="S5.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1.2">𝜆</ci><cn type="float" id="S5.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.1.m1.1c">\lambda=1.0</annotation></semantics></math> as the Fishr hyperparameter.</p>
</div>
</section>
<section id="S5.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3 </span>eICU</h4>

<div id="S5.SS1.SSS3.p1" class="ltx_para">
<p id="S5.SS1.SSS3.p1.1" class="ltx_p">The eICU Collaborative Research Database is an extensive real-world medical dataset created by Philips Healthcare in partnership with the MIT Laboratory for Computational Physiology <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib46" title="" class="ltx_ref">46</a>)</cite>. The dataset is spatially distributed in 58 hospitals, with 30,760 patients’ information about the medicines taken and the mortality of each patient. Furthermore, the dataset is imbalanced, with 30.5% of patients recorded as dead in our dataset while others recorded as alive. We also select 20 among the hospitals with the most data to participate in the training process, whilst the rest are the OOD test set to evaluate the global model. Moreover, we create a training set in each training hospital with 70% of its data. Meanwhile, the rest of 30% of the data becomes the validation set. Our objective is to predict a patient’s mortality based on the 1399 kinds of medicines taken in as input features. Therefore, we construct a 4-layer MLP with 1024, 1024, 512, and 1 neuron to perform a binary classification task. We also use the Adam optimizer with a fixed learning rate of 0.0002 and a weight decay of 0.001. Besides, the Fishr regularizer <math id="S5.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS1.SSS3.p1.1.m1.1a"><mi id="S5.SS1.SSS3.p1.1.m1.1.1" xref="S5.SS1.SSS3.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS3.p1.1.m1.1b"><ci id="S5.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS3.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS3.p1.1.m1.1c">\lambda</annotation></semantics></math> we choose is 0.1 during the training process.</p>
</div>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Result and Analysis</h3>

<figure id="S5.F2" class="ltx_figure ltx_align_floatright">
<p id="S5.F2.1" class="ltx_p ltx_align_center"><span id="S5.F2.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2205.09305/assets/lambda_compare.png" id="S5.F2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="157" height="118" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.5.2.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S5.F2.3.1" class="ltx_text" style="font-size:90%;">The OOD test loss with different Fishr regularizer <math id="S5.F2.3.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.F2.3.1.m1.1b"><mi id="S5.F2.3.1.m1.1.1" xref="S5.F2.3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.F2.3.1.m1.1c"><ci id="S5.F2.3.1.m1.1.1.cmml" xref="S5.F2.3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.3.1.m1.1d">\lambda</annotation></semantics></math> on the eICU dataset.</span></figcaption>
</figure>
<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We run each algorithm for five different seeds, then average their loss, the AUCROC, AUCPR, as well as the accuracy on the OOD test set when the OOD test loss is lowest, which are demonstrated in Table <a href="#S6.T2" title="Table 2 ‣ 6 Conclusion ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, Table <a href="#S6.T4" title="Table 4 ‣ 6 Conclusion ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> Table <a href="#S7.T6" title="Table 6 ‣ 7 Appendix ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, and Figure <a href="#S6.F3" title="Figure 3 ‣ 6 Conclusion ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Further, we also conduct the inter-silo and intra-silo accuracy comparison among each sub environment on the Rotated-CIFAR10 dataset when the OOD test loss is lowest <a href="#S7.T5" title="Table 5 ‣ 7 Appendix ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Specifically, we also experiment with the model’s performance regarding different Fishr regularizer <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\lambda</annotation></semantics></math> on the eICU dataset <a href="#S5.F2" title="Figure 2 ‣ 5.2 Result and Analysis ‣ 5 Experiments ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Moreover, we also plot the training loss, validation loss, and OOD test loss among different algorithms, which are demonstrated in Figure <a href="#S7.F5" title="Figure 5 ‣ 7 Appendix ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, Figure <a href="#S7.F6" title="Figure 6 ‣ 7 Appendix ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, and Figure <a href="#S7.F7" title="Figure 7 ‣ 7 Appendix ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> in the Appendix section. From the figures, our proposed methods, Fishr+Inter-Geo and Fishr+Intra-Geo, significantly outperform other methods in domain adaptation, including the baseline algorithm FedSGD and the state-of-the-art algorithm FedCurv.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">Last but not least, we also measure the fairness of our proposed algorithm by evaluating (1) the variance of the accuracy distribution and (2) the KL-divergence between the normalized accuracy and the uniform distribution, which can be directly translated to the entropy of accuracy defined in the paper <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib47" title="" class="ltx_ref">47</a>)</cite>. The result of our experiments is demonstrated in Table <a href="#S6.T3" title="Table 3 ‣ 6 Conclusion ‣ FedILC: Weighted Geometric Mean and Invariant Gradient Covariance for Federated Learning on Non-IID Data" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In conclusion, to mitigate the domain shift problem engendered by the non-i.i.d. data in the federated learning settings, we propose the Federated Invariant Learning Consistency (FedILC), including both Fishr+Inter-Geo and Fishr+Intra-Geo methodologies. Furthermore, we also introduce a novel weighted geometric mean strategy to calculate the geometric mean of gradients with inconsistent signs. The benchmark and real-world dataset experiments demonstrate that our proposed algorithm outperforms both the conventional and the state-of-the-art federated learning algorithms in capturing both inter-silo and intra-silo consistencies in federated networks.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="S6.F3" class="ltx_figure">
<p id="S6.F3.1" class="ltx_p ltx_align_center"><span id="S6.F3.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2205.09305/assets/experiment_loss_compare.png" id="S6.F3.1.1.g1" class="ltx_graphics ltx_img_landscape" width="530" height="133" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S6.F3.3.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S6.F3.4.2" class="ltx_text" style="font-size:90%;">The OOD test loss comparison among different algorithms on the Color-MNIST, Rotated-CIFAR10, and eICU dataset.</span></figcaption>
</figure>
<figure id="S6.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S6.T2.3.2" class="ltx_text" style="font-size:90%;">The OOD test loss comparison among different algorithms on the Color-MNIST, Rotated-CIFAR10, and eICU dataset. </span></figcaption>
<table id="S6.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T2.4.1.1" class="ltx_tr">
<td id="S6.T2.4.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S6.T2.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Color-MNIST</th>
<th id="S6.T2.4.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Rotated-CIFAR10</th>
<th id="S6.T2.4.1.1.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt">eICU</th>
</tr>
<tr id="S6.T2.4.2.2" class="ltx_tr">
<td id="S6.T2.4.2.2.1" class="ltx_td ltx_align_left ltx_border_tt">FedSGD</td>
<td id="S6.T2.4.2.2.2" class="ltx_td ltx_align_left ltx_border_tt">0.566±0.009</td>
<td id="S6.T2.4.2.2.3" class="ltx_td ltx_align_left ltx_border_tt">1.681±0.010</td>
<td id="S6.T2.4.2.2.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt">0.302±0.017</td>
</tr>
<tr id="S6.T2.4.3.3" class="ltx_tr">
<td id="S6.T2.4.3.3.1" class="ltx_td ltx_align_left ltx_border_t">Geometric</td>
<td id="S6.T2.4.3.3.2" class="ltx_td ltx_align_left ltx_border_t">0.562±0.006</td>
<td id="S6.T2.4.3.3.3" class="ltx_td ltx_align_left ltx_border_t">1.681±0.006</td>
<td id="S6.T2.4.3.3.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S6.T2.4.3.3.4.1" class="ltx_text ltx_font_bold">0.289±0.009</span></td>
</tr>
<tr id="S6.T2.4.4.4" class="ltx_tr">
<td id="S6.T2.4.4.4.1" class="ltx_td ltx_align_left ltx_border_t">FedCurv</td>
<td id="S6.T2.4.4.4.2" class="ltx_td ltx_align_left ltx_border_t">0.559±0.003</td>
<td id="S6.T2.4.4.4.3" class="ltx_td ltx_align_left ltx_border_t">1.666±0.024</td>
<td id="S6.T2.4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.298±0.009</td>
</tr>
<tr id="S6.T2.4.5.5" class="ltx_tr">
<td id="S6.T2.4.5.5.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T2.4.5.5.1.1" class="ltx_text ltx_font_bold">Fishr+Inter-Geo</span></td>
<td id="S6.T2.4.5.5.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T2.4.5.5.2.1" class="ltx_text ltx_font_bold">0.542±0.006</span></td>
<td id="S6.T2.4.5.5.3" class="ltx_td ltx_align_left ltx_border_t">1.658±0.004</td>
<td id="S6.T2.4.5.5.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.293±0.009</td>
</tr>
<tr id="S6.T2.4.6.6" class="ltx_tr">
<td id="S6.T2.4.6.6.1" class="ltx_td ltx_align_left ltx_border_t">Fishr+Intra-Arith</td>
<td id="S6.T2.4.6.6.2" class="ltx_td ltx_align_left ltx_border_t">0.555±0.004</td>
<td id="S6.T2.4.6.6.3" class="ltx_td ltx_align_left ltx_border_t">1.655±0.007</td>
<td id="S6.T2.4.6.6.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.302±0.009</td>
</tr>
<tr id="S6.T2.4.7.7" class="ltx_tr">
<td id="S6.T2.4.7.7.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S6.T2.4.7.7.1.1" class="ltx_text ltx_font_bold">Fishr+Intra-Geo</span></td>
<td id="S6.T2.4.7.7.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.552±0.005</td>
<td id="S6.T2.4.7.7.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S6.T2.4.7.7.3.1" class="ltx_text ltx_font_bold">1.648±0.006</span></td>
<td id="S6.T2.4.7.7.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t"><span id="S6.T2.4.7.7.4.1" class="ltx_text ltx_font_bold">0.289±0.008</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S6.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S6.T3.3.2" class="ltx_text" style="font-size:90%;">The variance of the accuracy distribution and KL-divergence between the normalized accuracy vector and the uniform distribution (which can be directly translated to the entropy of accuracy) on the Rotated-CIFAR10 dataset when the OOD test loss is lowest.</span></figcaption>
<table id="S6.T3.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T3.4.1.1" class="ltx_tr">
<td id="S6.T3.4.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S6.T3.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Variance (x1000)</th>
<th id="S6.T3.4.1.1.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt">Entropy (x10)</th>
</tr>
<tr id="S6.T3.4.2.2" class="ltx_tr">
<td id="S6.T3.4.2.2.1" class="ltx_td ltx_align_left ltx_border_tt">FedSGD</td>
<td id="S6.T3.4.2.2.2" class="ltx_td ltx_align_left ltx_border_tt">0.809±0.251</td>
<td id="S6.T3.4.2.2.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt">21.948±0.007</td>
</tr>
<tr id="S6.T3.4.3.3" class="ltx_tr">
<td id="S6.T3.4.3.3.1" class="ltx_td ltx_align_left ltx_border_t">FedCurv</td>
<td id="S6.T3.4.3.3.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T3.4.3.3.2.1" class="ltx_text ltx_font_bold">0.606±0.093</span></td>
<td id="S6.T3.4.3.3.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">21.955±0.003</td>
</tr>
<tr id="S6.T3.4.4.4" class="ltx_tr">
<td id="S6.T3.4.4.4.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T3.4.4.4.1.1" class="ltx_text ltx_font_bold">Fishr+Inter-Geo</span></td>
<td id="S6.T3.4.4.4.2" class="ltx_td ltx_align_left ltx_border_t">0.687±0.234</td>
<td id="S6.T3.4.4.4.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">21.953±0.007</td>
</tr>
<tr id="S6.T3.4.5.5" class="ltx_tr">
<td id="S6.T3.4.5.5.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S6.T3.4.5.5.1.1" class="ltx_text ltx_font_bold">Fishr+Intra-Geo</span></td>
<td id="S6.T3.4.5.5.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.611±0.120</td>
<td id="S6.T3.4.5.5.3" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t"><span id="S6.T3.4.5.5.3.1" class="ltx_text ltx_font_bold">21.956±0.003</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S6.T4" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T4.2.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S6.T4.3.2" class="ltx_text" style="font-size:90%;">The AUCROC and AUCPR comparison among different algorithms on the Color-MNIST, Rotated-CIFAR10, and eICU dataset when the OOD test loss is lowest.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.T4.st1" class="ltx_table ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T4.st1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S6.T4.st1.3.2" class="ltx_text" style="font-size:90%;">AUCROC</span></figcaption>
<table id="S6.T4.st1.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T4.st1.4.1.1" class="ltx_tr">
<td id="S6.T4.st1.4.1.1.1" class="ltx_td ltx_border_t"></td>
<th id="S6.T4.st1.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Color-MNIST</th>
<th id="S6.T4.st1.4.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">eICU</th>
</tr>
<tr id="S6.T4.st1.4.2.2" class="ltx_tr">
<td id="S6.T4.st1.4.2.2.1" class="ltx_td ltx_align_left ltx_border_tt">FedSGD</td>
<td id="S6.T4.st1.4.2.2.2" class="ltx_td ltx_align_left ltx_border_tt">0.780±0.001</td>
<td id="S6.T4.st1.4.2.2.3" class="ltx_td ltx_align_left ltx_border_tt">0.556±0.004</td>
</tr>
<tr id="S6.T4.st1.4.3.3" class="ltx_tr">
<td id="S6.T4.st1.4.3.3.1" class="ltx_td ltx_align_left ltx_border_t">Geometric</td>
<td id="S6.T4.st1.4.3.3.2" class="ltx_td ltx_align_left ltx_border_t">0.781±0.003</td>
<td id="S6.T4.st1.4.3.3.3" class="ltx_td ltx_align_left ltx_border_t">0.575±0.004</td>
</tr>
<tr id="S6.T4.st1.4.4.4" class="ltx_tr">
<td id="S6.T4.st1.4.4.4.1" class="ltx_td ltx_align_left ltx_border_t">FedCurv</td>
<td id="S6.T4.st1.4.4.4.2" class="ltx_td ltx_align_left ltx_border_t">0.780±0.003</td>
<td id="S6.T4.st1.4.4.4.3" class="ltx_td ltx_align_left ltx_border_t">0.556±0.005</td>
</tr>
<tr id="S6.T4.st1.4.5.5" class="ltx_tr">
<td id="S6.T4.st1.4.5.5.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T4.st1.4.5.5.1.1" class="ltx_text ltx_font_bold">Fishr+Inter-Geo</span></td>
<td id="S6.T4.st1.4.5.5.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T4.st1.4.5.5.2.1" class="ltx_text ltx_font_bold">0.789±0.002</span></td>
<td id="S6.T4.st1.4.5.5.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T4.st1.4.5.5.3.1" class="ltx_text ltx_font_bold">0.577±0.005</span></td>
</tr>
<tr id="S6.T4.st1.4.6.6" class="ltx_tr">
<td id="S6.T4.st1.4.6.6.1" class="ltx_td ltx_align_left ltx_border_t">Fishr+Intra-Arith</td>
<td id="S6.T4.st1.4.6.6.2" class="ltx_td ltx_align_left ltx_border_t">0.782±0.005</td>
<td id="S6.T4.st1.4.6.6.3" class="ltx_td ltx_align_left ltx_border_t">0.553±0.002</td>
</tr>
<tr id="S6.T4.st1.4.7.7" class="ltx_tr">
<td id="S6.T4.st1.4.7.7.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S6.T4.st1.4.7.7.1.1" class="ltx_text ltx_font_bold">Fishr+Intra-Geo</span></td>
<td id="S6.T4.st1.4.7.7.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.778±0.002</td>
<td id="S6.T4.st1.4.7.7.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.567±0.004</td>
</tr>
</tbody>
</table>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S6.T4.st2" class="ltx_table ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T4.st2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S6.T4.st2.3.2" class="ltx_text" style="font-size:90%;">AUCPR</span></figcaption>
<table id="S6.T4.st2.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T4.st2.4.1.1" class="ltx_tr">
<td id="S6.T4.st2.4.1.1.1" class="ltx_td ltx_border_t"></td>
<th id="S6.T4.st2.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Color-MNIST</th>
<th id="S6.T4.st2.4.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">eICU</th>
</tr>
<tr id="S6.T4.st2.4.2.2" class="ltx_tr">
<td id="S6.T4.st2.4.2.2.1" class="ltx_td ltx_align_left ltx_border_tt">FedSGD</td>
<td id="S6.T4.st2.4.2.2.2" class="ltx_td ltx_align_left ltx_border_tt">0.837±0.002</td>
<td id="S6.T4.st2.4.2.2.3" class="ltx_td ltx_align_left ltx_border_tt">0.209±0.010</td>
</tr>
<tr id="S6.T4.st2.4.3.3" class="ltx_tr">
<td id="S6.T4.st2.4.3.3.1" class="ltx_td ltx_align_left ltx_border_t">Geometric</td>
<td id="S6.T4.st2.4.3.3.2" class="ltx_td ltx_align_left ltx_border_t">0.838±0.004</td>
<td id="S6.T4.st2.4.3.3.3" class="ltx_td ltx_align_left ltx_border_t">0.214±0.008</td>
</tr>
<tr id="S6.T4.st2.4.4.4" class="ltx_tr">
<td id="S6.T4.st2.4.4.4.1" class="ltx_td ltx_align_left ltx_border_t">FedCurv</td>
<td id="S6.T4.st2.4.4.4.2" class="ltx_td ltx_align_left ltx_border_t">0.838±0.004</td>
<td id="S6.T4.st2.4.4.4.3" class="ltx_td ltx_align_left ltx_border_t">0.217±0.018</td>
</tr>
<tr id="S6.T4.st2.4.5.5" class="ltx_tr">
<td id="S6.T4.st2.4.5.5.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T4.st2.4.5.5.1.1" class="ltx_text ltx_font_bold">Fishr+Inter-Geo</span></td>
<td id="S6.T4.st2.4.5.5.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T4.st2.4.5.5.2.1" class="ltx_text ltx_font_bold">0.845±0.002</span></td>
<td id="S6.T4.st2.4.5.5.3" class="ltx_td ltx_align_left ltx_border_t">0.218±0.009</td>
</tr>
<tr id="S6.T4.st2.4.6.6" class="ltx_tr">
<td id="S6.T4.st2.4.6.6.1" class="ltx_td ltx_align_left ltx_border_t">Fishr+Intra-Arith</td>
<td id="S6.T4.st2.4.6.6.2" class="ltx_td ltx_align_left ltx_border_t">0.839±0.004</td>
<td id="S6.T4.st2.4.6.6.3" class="ltx_td ltx_align_left ltx_border_t">0.216±0.016</td>
</tr>
<tr id="S6.T4.st2.4.7.7" class="ltx_tr">
<td id="S6.T4.st2.4.7.7.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S6.T4.st2.4.7.7.1.1" class="ltx_text ltx_font_bold">Fishr+Intra-Geo</span></td>
<td id="S6.T4.st2.4.7.7.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.836±0.001</td>
<td id="S6.T4.st2.4.7.7.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S6.T4.st2.4.7.7.3.1" class="ltx_text ltx_font_bold">0.221±0.013</span></td>
</tr>
</tbody>
</table>
</figure>
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. Agüera,
“Communication-efficient learning of deep networks from decentralized
data,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20 th International Conference on Artificial
Intelligence and Statistics (AISTATS)</em>, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(2)</span>
<span class="ltx_bibblock">
J. Konečný, B. McMahan, and D. Ramage, “Federated optimization:distributed
optimization beyond the datacenter,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1511.03575</em>,
2015.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(3)</span>
<span class="ltx_bibblock">
J. Konečný, B. McMahan, F. Yu, P. Richtarik, A. Suresh, and S. Bacon,
“Federated learning: Strategies for im- proving communication efficiency,”
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>, 2016.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(4)</span>
<span class="ltx_bibblock">
N. Carlini, C. Liu, U. Erlingsson, J. Kos, and D. Song, “The secret sharer:
Evaluating and testing unintended memorization in neural networks,”
<em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1802.08232</em>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(5)</span>
<span class="ltx_bibblock">
J. Duchi, M. Jordan, and M. Wainwright, “Privacy aware learning,”
<em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2012.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(6)</span>
<span class="ltx_bibblock">
C. Dwork and A. Roth, “The algorithmic foundations of differential privacy,”
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends in Theoretical Computer Science</em>, 2014.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(7)</span>
<span class="ltx_bibblock">
T. Li, A. Sahu, A. Talwalkar, and V. Smith, “Federated learning: Challenges,
methods, and future directions,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>,
2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(8)</span>
<span class="ltx_bibblock">
J. Candela, M. Sugiyama, A. Schwaighofer, and N. Lawrence, <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Dataset Shift
in Machine Learning</em>.   The MIT Press,
2009.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(9)</span>
<span class="ltx_bibblock">
S. David, J. Blitzer, K. Crammer, A. Kulesza, F. Pereira, and J. Vaughan, “A
theory of learning from different domains,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Machine Learning</em>, 2010.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(10)</span>
<span class="ltx_bibblock">
C. Koby, M. Kearns, and J. Wortman, “Learning from multiple sources,”
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Journal of Machine Learning Research</em>, 2008.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(11)</span>
<span class="ltx_bibblock">
W. Kouw and M. Loog, “An introduction to domain adaptation and transfer
learning,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.11806</em>, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(12)</span>
<span class="ltx_bibblock">
H. Daume, “Frustratingly easy domain adaptation,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:0907.1815</em>, 2009.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(13)</span>
<span class="ltx_bibblock">
M. Arjovsky, L. Bottou, I. Gulrajani, and D. Lopez-Paz, “Invariant risk
minimization,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1907.02893</em>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(14)</span>
<span class="ltx_bibblock">
H. Bai, R. Sun, L. Hong, F. Zhou, N. Ye, H.-J. Ye, G. Chan, and Z. Li,
“Decaug: Out-of-distribution generalization via decomposed feature
representation and semantic augmentation,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2012.09382</em>, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(15)</span>
<span class="ltx_bibblock">
M. Pezeshki, S. OumarKaba, Y. Bengio, A. Courville, D. Precup, and G. Lajoie,
“Gradient starvation: A learning proclivity in neural networks,”
<em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">NeurIPS 2021</em>, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(16)</span>
<span class="ltx_bibblock">
M. Koyama and S. Yamaguchi, “Out-of-distribution generalization with maximal
invariant predictor,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2008.01883</em>, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(17)</span>
<span class="ltx_bibblock">
G. Parascandolo, A. Neitz, A. Orvieto, L. Gresele, and B. Schölkopf,
“Learning explanations that are hard to vary,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">ICLR 2021</em>, 2021.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(18)</span>
<span class="ltx_bibblock">
Y. Shi, J. Seely, T. Philip, Siddharth, A. Hannun, N. Usunier, and G. Synnaeve,
“Gradient matching for domain generalization,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2104.09937</em>, 2021.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(19)</span>
<span class="ltx_bibblock">
S. Shahtalebi, J.-C. Gagnon-Audet, T. Laleh, M. Faramarzi, K. Ahuja, and
I. Rish, “Sand-mask: An enhanced gradient masking strategy for the discovery
of invariances in domain generalization,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2106.02266</em>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(20)</span>
<span class="ltx_bibblock">
A. Rame, C. Dancette, and M. Cord, “Fishr: Invariant gradient variances for
out-of-distribution generalization,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.02934</em>,
2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(21)</span>
<span class="ltx_bibblock">
N. Shoham, T. Avidor, A. Keren, N. Israel, D. Benditkis, L. Mor-Yosef, and
I. Zeitak, “Overcoming forgetting in federated learning on non-iid data,”
<em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">NeurIPS 2019 Workshop on Federated Learning for Data Privacy and
Confidentiality</em>, 2019.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(22)</span>
<span class="ltx_bibblock">
B. Sun and K. Saenko, “Deep coral: Correlation alignment for deep domain
adaptation,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">European conference on computer vision</em>, 2016.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(23)</span>
<span class="ltx_bibblock">
H. Li, S. Pan, S. Wang, and A. Kot, “Domain generalization with adversarial
feature learning,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition</em>, 2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(24)</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(25)</span>
<span class="ltx_bibblock">
T. Tuor, S. Wang, B. J. Ko, C. Liu, and K. K. Leung, “Overcoming noisy and
irrelevant data in federated learning,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">The 25th International
Conference on Pattern Recognition (ICPR)</em>, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(26)</span>
<span class="ltx_bibblock">
N. Yoshida, T. Nishio, M. Morikura, K. Yamamoto, and R. Yonetani, “Hybrid-fl
for wireless networks: Cooperative learning mechanism using non-iid data,”
<em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Communications (ICC)</em>, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(27)</span>
<span class="ltx_bibblock">
M. Duan, D. Liu, X. Chen, Y. Tan, J. Ren, L. Qiao, and L. Liang, “Astraea:
Self-balancing federated learning for improving classification accuracy of
mobile deep learning applications,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">IEEE 37th International Conference
on Computer Design (ICCD)</em>, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(28)</span>
<span class="ltx_bibblock">
M. Shin, C. Hwang, J. Kim, J. Park, M. Bennis, and S.-L. Kim, “Xor mixup:
Privacy-preserving data augmentation for one-shot federated learning,”
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.05148</em>, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(29)</span>
<span class="ltx_bibblock">
F. Alireza, A. Mokhtari, and A. Ozdaglar, “Personalized federated learning
with theoretical guarantees: A model-agnostic meta-learning approach,”
<em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 33 (NeurIPS 2020)</em>,
2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(30)</span>
<span class="ltx_bibblock">
F. Chen, M. Luo, Z. Dong, Z. Li, and X. He, “Federated meta-learning with fast
convergence and efficient communication,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1802.07876</em>, 2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(31)</span>
<span class="ltx_bibblock">
F. Hanzely and P. Richtárik, “Federated learning of a mixture of global and
local models,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>, 2021.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(32)</span>
<span class="ltx_bibblock">
C. T. Dinh, N. Tran, and J. Nguyen, “Personalized federated learning with
moreau envelopes,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems
33 (NeurIPS 2020)</em>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(33)</span>
<span class="ltx_bibblock">
M. G. Arivazhagan, V. Aggarwal, A. K. Singh, and S. Choudhary, “Federated
learning with personalization layers,” <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1912.00818</em>, 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(34)</span>
<span class="ltx_bibblock">
Y. Mansour, M. Mohri, J. Ro, and A. T. Suresh, “Three approaches for
personalization with applications to federated learning,” <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2002.10619</em>, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(35)</span>
<span class="ltx_bibblock">
K. Kopparapu and E. Lin, “Fedfmc: Sequential efficient federated learning on
non-iid data,” <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.1093</em>, 2020.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(36)</span>
<span class="ltx_bibblock">
A. Ghosh, J. Hong, D. Yin, and K. Ramchandran, “Robust federated learning in a
heterogeneous environment,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.06629</em>, 2020.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(37)</span>
<span class="ltx_bibblock">
A. Ghosh, J. Chung, D. Yin, and K. Ramchandran, “An efficient framework for
clustered federated learning,” <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems 33 (NeurIPS 2020)</em>, 2020.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(38)</span>
<span class="ltx_bibblock">
E. Frantar, E. Kurtic, and D. Alistarh, “Efficient matrix-free approximations
of second-order information, with applications to pruning and optimization,”
<em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.03356</em>, 2021.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(39)</span>
<span class="ltx_bibblock">
L. Liu, S. Zhang, Z. Kuang, A. Zhou, J.-H. Xue, X. Wang, Y. Chen, W. Yang,
Q. Liao, and W. Zhang, “Group fisher pruning for practical network
compression,” <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">The 38th International Conference on Machine Learning
(ICML 2021)</em>, 2021.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(40)</span>
<span class="ltx_bibblock">
F. Dangel, L. Tatzel, and P. Hennig, “Curvature access through the generalized
gauss-newton’s low-rank structure,” <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2106.02624</em>, 2021.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(41)</span>
<span class="ltx_bibblock">
M. Luo, F. Chen, D. Hu, Y. Zhang, and J. Feng, “No fear of heterogeneity:
Classifier calibration for federated learning with non-iid data,” <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">35th
Conference on Neural Information Processing Systems (NeurIPS 2021)</em>, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(42)</span>
<span class="ltx_bibblock">
B. Sue and L. C. Yann, “Improving the convergence of back-propagation learning
with second order methods,” <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Connectionist models summer school</em>, 1988.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(43)</span>
<span class="ltx_bibblock">
L. Adolphs, J. Kohler, and A. Lucchi, “Ellipsoidal trust region methods and
the marginal value of hessian information for neural network training,”
<em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1905.09201</em>, 2020.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(44)</span>
<span class="ltx_bibblock">
S. P. Singh and D. Alistarh, “Woodfisher: Efficient second-order approximation
for neural network compression,” <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">34th Conference on Neural Information
Processing Systems (NeurIPS 2020)</em>, 2020.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(45)</span>
<span class="ltx_bibblock">
A. Krizhevsky, “Learning multiple layers of features from tiny images,”
<em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Tech Report</em>, 2009.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(46)</span>
<span class="ltx_bibblock">
T. Pollard, A. Johnson, J. Raffa, L. Celi, R. Mark, and O. Badawi, “The eicu
collaborative research database, a freely available multi-center database for
critical care research,” <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Scientific Data</em>, 2018.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(47)</span>
<span class="ltx_bibblock">
T. Li, M. Sanjabi, A. Beirami, and V. Smith, “Fair resource allocation in
federated learning,” <em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">ICLR 2020</em>, 2020.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Appendix</h2>

<figure id="S7.12" class="ltx_table">
<table id="S7.12.12" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S7.12.12.13.1" class="ltx_tr">
<th id="S7.12.12.13.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt">Notation</th>
<th id="S7.12.12.13.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt">Description</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S7.1.1.1" class="ltx_tr">
<th id="S7.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><math id="S7.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{E}" display="inline"><semantics id="S7.1.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.1.1.1.1.m1.1.1" xref="S7.1.1.1.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S7.1.1.1.1.m1.1b"><ci id="S7.1.1.1.1.m1.1.1.cmml" xref="S7.1.1.1.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.1.1.1.1.m1.1c">\mathcal{E}</annotation></semantics></math></th>
<td id="S7.1.1.1.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">Total number of clients in the federated networks</td>
</tr>
<tr id="S7.2.2.2" class="ltx_tr">
<th id="S7.2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S7.2.2.2.1.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="S7.2.2.2.1.m1.1a"><mi id="S7.2.2.2.1.m1.1.1" xref="S7.2.2.2.1.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="S7.2.2.2.1.m1.1b"><ci id="S7.2.2.2.1.m1.1.1.cmml" xref="S7.2.2.2.1.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.2.2.2.1.m1.1c">e</annotation></semantics></math></th>
<td id="S7.2.2.2.2" class="ltx_td ltx_nopad_r ltx_align_left">An individual federated client in the federated networks</td>
</tr>
<tr id="S7.3.3.3" class="ltx_tr">
<th id="S7.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S7.3.3.3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S7.3.3.3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.3.3.3.1.m1.1.1" xref="S7.3.3.3.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S7.3.3.3.1.m1.1b"><ci id="S7.3.3.3.1.m1.1.1.cmml" xref="S7.3.3.3.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.3.3.3.1.m1.1c">\mathcal{D}</annotation></semantics></math></th>
<td id="S7.3.3.3.2" class="ltx_td ltx_nopad_r ltx_align_left">Local dataset of client</td>
</tr>
<tr id="S7.4.4.4" class="ltx_tr">
<th id="S7.4.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S7.4.4.4.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S7.4.4.4.1.m1.1a"><mi id="S7.4.4.4.1.m1.1.1" xref="S7.4.4.4.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S7.4.4.4.1.m1.1b"><ci id="S7.4.4.4.1.m1.1.1.cmml" xref="S7.4.4.4.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.4.4.4.1.m1.1c">w</annotation></semantics></math></th>
<td id="S7.4.4.4.2" class="ltx_td ltx_nopad_r ltx_align_left">Global weights of server</td>
</tr>
<tr id="S7.7.7.7" class="ltx_tr">
<th id="S7.6.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">
<math id="S7.5.5.5.1.m1.1" class="ltx_Math" alttext="\left[\mathcal{E}^{+}\right]_{i}" display="inline"><semantics id="S7.5.5.5.1.m1.1a"><msub id="S7.5.5.5.1.m1.1.1" xref="S7.5.5.5.1.m1.1.1.cmml"><mrow id="S7.5.5.5.1.m1.1.1.1.1" xref="S7.5.5.5.1.m1.1.1.1.2.cmml"><mo id="S7.5.5.5.1.m1.1.1.1.1.2" xref="S7.5.5.5.1.m1.1.1.1.2.1.cmml">[</mo><msup id="S7.5.5.5.1.m1.1.1.1.1.1" xref="S7.5.5.5.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.5.5.5.1.m1.1.1.1.1.1.2" xref="S7.5.5.5.1.m1.1.1.1.1.1.2.cmml">ℰ</mi><mo id="S7.5.5.5.1.m1.1.1.1.1.1.3" xref="S7.5.5.5.1.m1.1.1.1.1.1.3.cmml">+</mo></msup><mo id="S7.5.5.5.1.m1.1.1.1.1.3" xref="S7.5.5.5.1.m1.1.1.1.2.1.cmml">]</mo></mrow><mi id="S7.5.5.5.1.m1.1.1.3" xref="S7.5.5.5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S7.5.5.5.1.m1.1b"><apply id="S7.5.5.5.1.m1.1.1.cmml" xref="S7.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S7.5.5.5.1.m1.1.1.2.cmml" xref="S7.5.5.5.1.m1.1.1">subscript</csymbol><apply id="S7.5.5.5.1.m1.1.1.1.2.cmml" xref="S7.5.5.5.1.m1.1.1.1.1"><csymbol cd="latexml" id="S7.5.5.5.1.m1.1.1.1.2.1.cmml" xref="S7.5.5.5.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S7.5.5.5.1.m1.1.1.1.1.1.cmml" xref="S7.5.5.5.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.5.5.5.1.m1.1.1.1.1.1.1.cmml" xref="S7.5.5.5.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S7.5.5.5.1.m1.1.1.1.1.1.2.cmml" xref="S7.5.5.5.1.m1.1.1.1.1.1.2">ℰ</ci><plus id="S7.5.5.5.1.m1.1.1.1.1.1.3.cmml" xref="S7.5.5.5.1.m1.1.1.1.1.1.3"></plus></apply></apply><ci id="S7.5.5.5.1.m1.1.1.3.cmml" xref="S7.5.5.5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.5.5.5.1.m1.1c">\left[\mathcal{E}^{+}\right]_{i}</annotation></semantics></math> / <math id="S7.6.6.6.2.m2.1" class="ltx_Math" alttext="\left[\mathcal{E}^{-}\right]_{i}" display="inline"><semantics id="S7.6.6.6.2.m2.1a"><msub id="S7.6.6.6.2.m2.1.1" xref="S7.6.6.6.2.m2.1.1.cmml"><mrow id="S7.6.6.6.2.m2.1.1.1.1" xref="S7.6.6.6.2.m2.1.1.1.2.cmml"><mo id="S7.6.6.6.2.m2.1.1.1.1.2" xref="S7.6.6.6.2.m2.1.1.1.2.1.cmml">[</mo><msup id="S7.6.6.6.2.m2.1.1.1.1.1" xref="S7.6.6.6.2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.6.6.6.2.m2.1.1.1.1.1.2" xref="S7.6.6.6.2.m2.1.1.1.1.1.2.cmml">ℰ</mi><mo id="S7.6.6.6.2.m2.1.1.1.1.1.3" xref="S7.6.6.6.2.m2.1.1.1.1.1.3.cmml">−</mo></msup><mo id="S7.6.6.6.2.m2.1.1.1.1.3" xref="S7.6.6.6.2.m2.1.1.1.2.1.cmml">]</mo></mrow><mi id="S7.6.6.6.2.m2.1.1.3" xref="S7.6.6.6.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S7.6.6.6.2.m2.1b"><apply id="S7.6.6.6.2.m2.1.1.cmml" xref="S7.6.6.6.2.m2.1.1"><csymbol cd="ambiguous" id="S7.6.6.6.2.m2.1.1.2.cmml" xref="S7.6.6.6.2.m2.1.1">subscript</csymbol><apply id="S7.6.6.6.2.m2.1.1.1.2.cmml" xref="S7.6.6.6.2.m2.1.1.1.1"><csymbol cd="latexml" id="S7.6.6.6.2.m2.1.1.1.2.1.cmml" xref="S7.6.6.6.2.m2.1.1.1.1.2">delimited-[]</csymbol><apply id="S7.6.6.6.2.m2.1.1.1.1.1.cmml" xref="S7.6.6.6.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S7.6.6.6.2.m2.1.1.1.1.1.1.cmml" xref="S7.6.6.6.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S7.6.6.6.2.m2.1.1.1.1.1.2.cmml" xref="S7.6.6.6.2.m2.1.1.1.1.1.2">ℰ</ci><minus id="S7.6.6.6.2.m2.1.1.1.1.1.3.cmml" xref="S7.6.6.6.2.m2.1.1.1.1.1.3"></minus></apply></apply><ci id="S7.6.6.6.2.m2.1.1.3.cmml" xref="S7.6.6.6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.6.6.6.2.m2.1c">\left[\mathcal{E}^{-}\right]_{i}</annotation></semantics></math>
</th>
<td id="S7.7.7.7.3" class="ltx_td ltx_nopad_r ltx_align_left">The number of clients with positive / negative gradients for <math id="S7.7.7.7.3.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S7.7.7.7.3.m1.1a"><mi id="S7.7.7.7.3.m1.1.1" xref="S7.7.7.7.3.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S7.7.7.7.3.m1.1b"><ci id="S7.7.7.7.3.m1.1.1.cmml" xref="S7.7.7.7.3.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.7.7.7.3.m1.1c">i</annotation></semantics></math>-th data example</td>
</tr>
<tr id="S7.8.8.8" class="ltx_tr">
<th id="S7.8.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S7.8.8.8.1.m1.1" class="ltx_Math" alttext="\nabla^{\wedge}F" display="inline"><semantics id="S7.8.8.8.1.m1.1a"><mrow id="S7.8.8.8.1.m1.1.1" xref="S7.8.8.8.1.m1.1.1.cmml"><msup id="S7.8.8.8.1.m1.1.1.1" xref="S7.8.8.8.1.m1.1.1.1.cmml"><mo id="S7.8.8.8.1.m1.1.1.1.2" xref="S7.8.8.8.1.m1.1.1.1.2.cmml">∇</mo><mo id="S7.8.8.8.1.m1.1.1.1.3" xref="S7.8.8.8.1.m1.1.1.1.3.cmml">∧</mo></msup><mi id="S7.8.8.8.1.m1.1.1.2" xref="S7.8.8.8.1.m1.1.1.2.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S7.8.8.8.1.m1.1b"><apply id="S7.8.8.8.1.m1.1.1.cmml" xref="S7.8.8.8.1.m1.1.1"><apply id="S7.8.8.8.1.m1.1.1.1.cmml" xref="S7.8.8.8.1.m1.1.1.1"><csymbol cd="ambiguous" id="S7.8.8.8.1.m1.1.1.1.1.cmml" xref="S7.8.8.8.1.m1.1.1.1">superscript</csymbol><ci id="S7.8.8.8.1.m1.1.1.1.2.cmml" xref="S7.8.8.8.1.m1.1.1.1.2">∇</ci><and id="S7.8.8.8.1.m1.1.1.1.3.cmml" xref="S7.8.8.8.1.m1.1.1.1.3"></and></apply><ci id="S7.8.8.8.1.m1.1.1.2.cmml" xref="S7.8.8.8.1.m1.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.8.8.8.1.m1.1c">\nabla^{\wedge}F</annotation></semantics></math></th>
<td id="S7.8.8.8.2" class="ltx_td ltx_nopad_r ltx_align_left">Weighted geometric mean of gradients</td>
</tr>
<tr id="S7.9.9.9" class="ltx_tr">
<th id="S7.9.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S7.9.9.9.1.m1.1" class="ltx_Math" alttext="\nabla^{+}F" display="inline"><semantics id="S7.9.9.9.1.m1.1a"><mrow id="S7.9.9.9.1.m1.1.1" xref="S7.9.9.9.1.m1.1.1.cmml"><msup id="S7.9.9.9.1.m1.1.1.1" xref="S7.9.9.9.1.m1.1.1.1.cmml"><mo id="S7.9.9.9.1.m1.1.1.1.2" xref="S7.9.9.9.1.m1.1.1.1.2.cmml">∇</mo><mo id="S7.9.9.9.1.m1.1.1.1.3" xref="S7.9.9.9.1.m1.1.1.1.3.cmml">+</mo></msup><mi id="S7.9.9.9.1.m1.1.1.2" xref="S7.9.9.9.1.m1.1.1.2.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S7.9.9.9.1.m1.1b"><apply id="S7.9.9.9.1.m1.1.1.cmml" xref="S7.9.9.9.1.m1.1.1"><apply id="S7.9.9.9.1.m1.1.1.1.cmml" xref="S7.9.9.9.1.m1.1.1.1"><csymbol cd="ambiguous" id="S7.9.9.9.1.m1.1.1.1.1.cmml" xref="S7.9.9.9.1.m1.1.1.1">superscript</csymbol><ci id="S7.9.9.9.1.m1.1.1.1.2.cmml" xref="S7.9.9.9.1.m1.1.1.1.2">∇</ci><plus id="S7.9.9.9.1.m1.1.1.1.3.cmml" xref="S7.9.9.9.1.m1.1.1.1.3"></plus></apply><ci id="S7.9.9.9.1.m1.1.1.2.cmml" xref="S7.9.9.9.1.m1.1.1.2">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.9.9.9.1.m1.1c">\nabla^{+}F</annotation></semantics></math></th>
<td id="S7.9.9.9.2" class="ltx_td ltx_nopad_r ltx_align_left">Arithmetic mean of gradients</td>
</tr>
<tr id="S7.10.10.10" class="ltx_tr">
<th id="S7.10.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S7.10.10.10.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S7.10.10.10.1.m1.1a"><mi id="S7.10.10.10.1.m1.1.1" xref="S7.10.10.10.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S7.10.10.10.1.m1.1b"><ci id="S7.10.10.10.1.m1.1.1.cmml" xref="S7.10.10.10.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.10.10.10.1.m1.1c">\eta</annotation></semantics></math></th>
<td id="S7.10.10.10.2" class="ltx_td ltx_nopad_r ltx_align_left">Learning rate</td>
</tr>
<tr id="S7.11.11.11" class="ltx_tr">
<th id="S7.11.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S7.11.11.11.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S7.11.11.11.1.m1.1a"><mi id="S7.11.11.11.1.m1.1.1" xref="S7.11.11.11.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S7.11.11.11.1.m1.1b"><ci id="S7.11.11.11.1.m1.1.1.cmml" xref="S7.11.11.11.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.11.11.11.1.m1.1c">\lambda</annotation></semantics></math></th>
<td id="S7.11.11.11.2" class="ltx_td ltx_nopad_r ltx_align_left">Hyper-parameter to control the Fishr regularization strength</td>
</tr>
<tr id="S7.12.12.12" class="ltx_tr">
<th id="S7.12.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><math id="S7.12.12.12.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S7.12.12.12.1.m1.1a"><mi id="S7.12.12.12.1.m1.1.1" xref="S7.12.12.12.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S7.12.12.12.1.m1.1b"><ci id="S7.12.12.12.1.m1.1.1.cmml" xref="S7.12.12.12.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S7.12.12.12.1.m1.1c">C</annotation></semantics></math></th>
<td id="S7.12.12.12.2" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">Gradient covariance matrix</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S7.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S7.T5.2.1.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S7.T5.3.2" class="ltx_text" style="font-size:90%;">The inter-silo and intra-silo accuracy comparison on the Rotated-CIFAR10 dataset when the OOD test loss is lowest. </span></figcaption>
<table id="S7.T5.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S7.T5.4.1.1" class="ltx_tr">
<td id="S7.T5.4.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S7.T5.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">FedSGD</th>
<th id="S7.T5.4.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">FedCurv</th>
<th id="S7.T5.4.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S7.T5.4.1.1.4.1" class="ltx_text ltx_font_bold">Fishr+Inter-Geo</span></th>
<th id="S7.T5.4.1.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="S7.T5.4.1.1.5.1" class="ltx_text ltx_font_bold">Fishr+Intra-Geo</span></th>
</tr>
<tr id="S7.T5.4.2.2" class="ltx_tr">
<td id="S7.T5.4.2.2.1" class="ltx_td ltx_align_left ltx_border_tt">Client 1 Sub Env 1</td>
<td id="S7.T5.4.2.2.2" class="ltx_td ltx_align_left ltx_border_tt">0.443±0.010</td>
<td id="S7.T5.4.2.2.3" class="ltx_td ltx_align_left ltx_border_tt">0.435±0.013</td>
<td id="S7.T5.4.2.2.4" class="ltx_td ltx_align_left ltx_border_tt">0.446±0.020</td>
<td id="S7.T5.4.2.2.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt"><span id="S7.T5.4.2.2.5.1" class="ltx_text ltx_font_bold">0.456±0.017</span></td>
</tr>
<tr id="S7.T5.4.3.3" class="ltx_tr">
<td id="S7.T5.4.3.3.1" class="ltx_td ltx_align_left ltx_border_t">Client 1 Sub Env 2</td>
<td id="S7.T5.4.3.3.2" class="ltx_td ltx_align_left ltx_border_t">0.434±0.017</td>
<td id="S7.T5.4.3.3.3" class="ltx_td ltx_align_left ltx_border_t">0.448±0.008</td>
<td id="S7.T5.4.3.3.4" class="ltx_td ltx_align_left ltx_border_t">0.438±0.009</td>
<td id="S7.T5.4.3.3.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S7.T5.4.3.3.5.1" class="ltx_text ltx_font_bold">0.451±0.011</span></td>
</tr>
<tr id="S7.T5.4.4.4" class="ltx_tr">
<td id="S7.T5.4.4.4.1" class="ltx_td ltx_align_left ltx_border_t">Client 1 Sub Env 3</td>
<td id="S7.T5.4.4.4.2" class="ltx_td ltx_align_left ltx_border_t">0.428±0.008</td>
<td id="S7.T5.4.4.4.3" class="ltx_td ltx_align_left ltx_border_t">0.424±0.006</td>
<td id="S7.T5.4.4.4.4" class="ltx_td ltx_align_left ltx_border_t">0.442±0.013</td>
<td id="S7.T5.4.4.4.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S7.T5.4.4.4.5.1" class="ltx_text ltx_font_bold">0.444±0.009</span></td>
</tr>
<tr id="S7.T5.4.5.5" class="ltx_tr">
<td id="S7.T5.4.5.5.1" class="ltx_td ltx_align_left ltx_border_t">Client 2 Sub Env 1</td>
<td id="S7.T5.4.5.5.2" class="ltx_td ltx_align_left ltx_border_t">0.420±0.020</td>
<td id="S7.T5.4.5.5.3" class="ltx_td ltx_align_left ltx_border_t">0.425±0.004</td>
<td id="S7.T5.4.5.5.4" class="ltx_td ltx_align_left ltx_border_t">0.435±0.004</td>
<td id="S7.T5.4.5.5.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S7.T5.4.5.5.5.1" class="ltx_text ltx_font_bold">0.441±0.008</span></td>
</tr>
<tr id="S7.T5.4.6.6" class="ltx_tr">
<td id="S7.T5.4.6.6.1" class="ltx_td ltx_align_left ltx_border_t">Client 2 Sub Env 2</td>
<td id="S7.T5.4.6.6.2" class="ltx_td ltx_align_left ltx_border_t">0.440±0.009</td>
<td id="S7.T5.4.6.6.3" class="ltx_td ltx_align_left ltx_border_t">0.437±0.011</td>
<td id="S7.T5.4.6.6.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S7.T5.4.6.6.4.1" class="ltx_text ltx_font_bold">0.443±0.009</span></td>
<td id="S7.T5.4.6.6.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.438±0.008</td>
</tr>
<tr id="S7.T5.4.7.7" class="ltx_tr">
<td id="S7.T5.4.7.7.1" class="ltx_td ltx_align_left ltx_border_t">Client 2 Sub Env 3</td>
<td id="S7.T5.4.7.7.2" class="ltx_td ltx_align_left ltx_border_t">0.411±0.007</td>
<td id="S7.T5.4.7.7.3" class="ltx_td ltx_align_left ltx_border_t">0.409±0.005</td>
<td id="S7.T5.4.7.7.4" class="ltx_td ltx_align_left ltx_border_t">0.404±0.008</td>
<td id="S7.T5.4.7.7.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S7.T5.4.7.7.5.1" class="ltx_text ltx_font_bold">0.419±0.011</span></td>
</tr>
<tr id="S7.T5.4.8.8" class="ltx_tr">
<td id="S7.T5.4.8.8.1" class="ltx_td ltx_align_left ltx_border_t">Client 3 Sub Env 1</td>
<td id="S7.T5.4.8.8.2" class="ltx_td ltx_align_left ltx_border_t">0.413±0.014</td>
<td id="S7.T5.4.8.8.3" class="ltx_td ltx_align_left ltx_border_t">0.431±0.011</td>
<td id="S7.T5.4.8.8.4" class="ltx_td ltx_align_left ltx_border_t">0.427±0.017</td>
<td id="S7.T5.4.8.8.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S7.T5.4.8.8.5.1" class="ltx_text ltx_font_bold">0.443±0.004</span></td>
</tr>
<tr id="S7.T5.4.9.9" class="ltx_tr">
<td id="S7.T5.4.9.9.1" class="ltx_td ltx_align_left ltx_border_t">Client 3 Sub Env 2</td>
<td id="S7.T5.4.9.9.2" class="ltx_td ltx_align_left ltx_border_t">0.367±0.010</td>
<td id="S7.T5.4.9.9.3" class="ltx_td ltx_align_left ltx_border_t">0.379±0.014</td>
<td id="S7.T5.4.9.9.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S7.T5.4.9.9.4.1" class="ltx_text ltx_font_bold">0.392±0.012</span></td>
<td id="S7.T5.4.9.9.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.388±0.012</td>
</tr>
<tr id="S7.T5.4.10.10" class="ltx_tr">
<td id="S7.T5.4.10.10.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Client 3 Sub Env 3</td>
<td id="S7.T5.4.10.10.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.371±0.010</td>
<td id="S7.T5.4.10.10.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.380±0.010</td>
<td id="S7.T5.4.10.10.4" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.381±0.016</td>
<td id="S7.T5.4.10.10.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t"><span id="S7.T5.4.10.10.5.1" class="ltx_text ltx_font_bold">0.396±0.010</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S7.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S7.T6.2.1.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="S7.T6.3.2" class="ltx_text" style="font-size:90%;">The accuracy comparison among different algorithms on the Color-MNIST, Rotated-CIFAR10, and eICU dataset when the OOD test loss is lowest. Since the eICU dataset is highly imbalanced, the accuracy on the eICU dataset is not fully informative.</span></figcaption>
<table id="S7.T6.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S7.T6.4.1.1" class="ltx_tr">
<td id="S7.T6.4.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S7.T6.4.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Color-MNIST</th>
<th id="S7.T6.4.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Rotated-CIFAR10</th>
<th id="S7.T6.4.1.1.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt">eICU</th>
</tr>
<tr id="S7.T6.4.2.2" class="ltx_tr">
<td id="S7.T6.4.2.2.1" class="ltx_td ltx_align_left ltx_border_tt">FedSGD</td>
<td id="S7.T6.4.2.2.2" class="ltx_td ltx_align_left ltx_border_tt">0.781±0.001</td>
<td id="S7.T6.4.2.2.3" class="ltx_td ltx_align_left ltx_border_tt">0.404±0.004</td>
<td id="S7.T6.4.2.2.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_tt">0.919±0.008</td>
</tr>
<tr id="S7.T6.4.3.3" class="ltx_tr">
<td id="S7.T6.4.3.3.1" class="ltx_td ltx_align_left ltx_border_t">Geometric</td>
<td id="S7.T6.4.3.3.2" class="ltx_td ltx_align_left ltx_border_t">0.781±0.003</td>
<td id="S7.T6.4.3.3.3" class="ltx_td ltx_align_left ltx_border_t">0.405±0.003</td>
<td id="S7.T6.4.3.3.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.900±0.005</td>
</tr>
<tr id="S7.T6.4.4.4" class="ltx_tr">
<td id="S7.T6.4.4.4.1" class="ltx_td ltx_align_left ltx_border_t">FedCurv</td>
<td id="S7.T6.4.4.4.2" class="ltx_td ltx_align_left ltx_border_t">0.780±0.004</td>
<td id="S7.T6.4.4.4.3" class="ltx_td ltx_align_left ltx_border_t">0.408±0.010</td>
<td id="S7.T6.4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S7.T6.4.4.4.4.1" class="ltx_text ltx_font_bold">0.923±0.005</span></td>
</tr>
<tr id="S7.T6.4.5.5" class="ltx_tr">
<td id="S7.T6.4.5.5.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S7.T6.4.5.5.1.1" class="ltx_text ltx_font_bold">Fishr+Inter-Geo</span></td>
<td id="S7.T6.4.5.5.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S7.T6.4.5.5.2.1" class="ltx_text ltx_font_bold">0.790±0.002</span></td>
<td id="S7.T6.4.5.5.3" class="ltx_td ltx_align_left ltx_border_t">0.414±0.003</td>
<td id="S7.T6.4.5.5.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.907±0.003</td>
</tr>
<tr id="S7.T6.4.6.6" class="ltx_tr">
<td id="S7.T6.4.6.6.1" class="ltx_td ltx_align_left ltx_border_t">Fishr+Intra-Arith</td>
<td id="S7.T6.4.6.6.2" class="ltx_td ltx_align_left ltx_border_t">0.783±0.005</td>
<td id="S7.T6.4.6.6.3" class="ltx_td ltx_align_left ltx_border_t">0.414±0.003</td>
<td id="S7.T6.4.6.6.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t"><span id="S7.T6.4.6.6.4.1" class="ltx_text ltx_font_bold">0.923±0.006</span></td>
</tr>
<tr id="S7.T6.4.7.7" class="ltx_tr">
<td id="S7.T6.4.7.7.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S7.T6.4.7.7.1.1" class="ltx_text ltx_font_bold">Fishr+Intra-Geo</span></td>
<td id="S7.T6.4.7.7.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">0.779±0.002</td>
<td id="S7.T6.4.7.7.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S7.T6.4.7.7.3.1" class="ltx_text ltx_font_bold">0.419±0.004</span></td>
<td id="S7.T6.4.7.7.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb ltx_border_t">0.917±0.006</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Fishr+Inter-Geo: Fishr and Inter-silo Weighted Geometric Mean.</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="algx1.l1" class="ltx_listingline">
<span id="algx1.l1.1" class="ltx_text ltx_font_bold">function</span> <span id="algx1.l1.2" class="ltx_text ltx_font_smallcaps">ServerExecutes</span>(<span id="algx1.l1.3" class="ltx_text"></span>)

</div>
<div id="algx1.l2" class="ltx_listingline">     initialize <math id="algx1.l2.m1.1" class="ltx_Math" alttext="w=w_{0}\in\mathbf{R}^{n}" display="inline"><semantics id="algx1.l2.m1.1a"><mrow id="algx1.l2.m1.1.1" xref="algx1.l2.m1.1.1.cmml"><mi id="algx1.l2.m1.1.1.2" xref="algx1.l2.m1.1.1.2.cmml">w</mi><mo id="algx1.l2.m1.1.1.3" xref="algx1.l2.m1.1.1.3.cmml">=</mo><msub id="algx1.l2.m1.1.1.4" xref="algx1.l2.m1.1.1.4.cmml"><mi id="algx1.l2.m1.1.1.4.2" xref="algx1.l2.m1.1.1.4.2.cmml">w</mi><mn id="algx1.l2.m1.1.1.4.3" xref="algx1.l2.m1.1.1.4.3.cmml">0</mn></msub><mo id="algx1.l2.m1.1.1.5" xref="algx1.l2.m1.1.1.5.cmml">∈</mo><msup id="algx1.l2.m1.1.1.6" xref="algx1.l2.m1.1.1.6.cmml"><mi id="algx1.l2.m1.1.1.6.2" xref="algx1.l2.m1.1.1.6.2.cmml">𝐑</mi><mi id="algx1.l2.m1.1.1.6.3" xref="algx1.l2.m1.1.1.6.3.cmml">n</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algx1.l2.m1.1b"><apply id="algx1.l2.m1.1.1.cmml" xref="algx1.l2.m1.1.1"><and id="algx1.l2.m1.1.1a.cmml" xref="algx1.l2.m1.1.1"></and><apply id="algx1.l2.m1.1.1b.cmml" xref="algx1.l2.m1.1.1"><eq id="algx1.l2.m1.1.1.3.cmml" xref="algx1.l2.m1.1.1.3"></eq><ci id="algx1.l2.m1.1.1.2.cmml" xref="algx1.l2.m1.1.1.2">𝑤</ci><apply id="algx1.l2.m1.1.1.4.cmml" xref="algx1.l2.m1.1.1.4"><csymbol cd="ambiguous" id="algx1.l2.m1.1.1.4.1.cmml" xref="algx1.l2.m1.1.1.4">subscript</csymbol><ci id="algx1.l2.m1.1.1.4.2.cmml" xref="algx1.l2.m1.1.1.4.2">𝑤</ci><cn type="integer" id="algx1.l2.m1.1.1.4.3.cmml" xref="algx1.l2.m1.1.1.4.3">0</cn></apply></apply><apply id="algx1.l2.m1.1.1c.cmml" xref="algx1.l2.m1.1.1"><in id="algx1.l2.m1.1.1.5.cmml" xref="algx1.l2.m1.1.1.5"></in><share href="#algx1.l2.m1.1.1.4.cmml" id="algx1.l2.m1.1.1d.cmml" xref="algx1.l2.m1.1.1"></share><apply id="algx1.l2.m1.1.1.6.cmml" xref="algx1.l2.m1.1.1.6"><csymbol cd="ambiguous" id="algx1.l2.m1.1.1.6.1.cmml" xref="algx1.l2.m1.1.1.6">superscript</csymbol><ci id="algx1.l2.m1.1.1.6.2.cmml" xref="algx1.l2.m1.1.1.6.2">𝐑</ci><ci id="algx1.l2.m1.1.1.6.3.cmml" xref="algx1.l2.m1.1.1.6.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l2.m1.1c">w=w_{0}\in\mathbf{R}^{n}</annotation></semantics></math>

</div>
<div id="algx1.l3" class="ltx_listingline">     <span id="algx1.l3.1" class="ltx_text ltx_font_bold">for</span> each round <math id="algx1.l3.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="algx1.l3.m1.1a"><mi id="algx1.l3.m1.1.1" xref="algx1.l3.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="algx1.l3.m1.1b"><ci id="algx1.l3.m1.1.1.cmml" xref="algx1.l3.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m1.1c">t</annotation></semantics></math> = 0, 1, 2, … <span id="algx1.l3.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="algx1.l4" class="ltx_listingline">         <span id="algx1.l4.1" class="ltx_text ltx_font_bold">for</span> each client <math id="algx1.l4.m1.1" class="ltx_Math" alttext="e\in\mathcal{E}" display="inline"><semantics id="algx1.l4.m1.1a"><mrow id="algx1.l4.m1.1.1" xref="algx1.l4.m1.1.1.cmml"><mi id="algx1.l4.m1.1.1.2" xref="algx1.l4.m1.1.1.2.cmml">e</mi><mo id="algx1.l4.m1.1.1.1" xref="algx1.l4.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="algx1.l4.m1.1.1.3" xref="algx1.l4.m1.1.1.3.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l4.m1.1b"><apply id="algx1.l4.m1.1.1.cmml" xref="algx1.l4.m1.1.1"><in id="algx1.l4.m1.1.1.1.cmml" xref="algx1.l4.m1.1.1.1"></in><ci id="algx1.l4.m1.1.1.2.cmml" xref="algx1.l4.m1.1.1.2">𝑒</ci><ci id="algx1.l4.m1.1.1.3.cmml" xref="algx1.l4.m1.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m1.1c">e\in\mathcal{E}</annotation></semantics></math> <span id="algx1.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="algx1.l5" class="ltx_listingline">              <math id="algx1.l5.m1.2" class="ltx_Math" alttext="\nabla F_{e},C_{e}\leftarrow" display="inline"><semantics id="algx1.l5.m1.2a"><mrow id="algx1.l5.m1.2.2" xref="algx1.l5.m1.2.2.cmml"><mrow id="algx1.l5.m1.2.2.2.2" xref="algx1.l5.m1.2.2.2.3.cmml"><mrow id="algx1.l5.m1.1.1.1.1.1" xref="algx1.l5.m1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="algx1.l5.m1.1.1.1.1.1.1" xref="algx1.l5.m1.1.1.1.1.1.1.cmml">∇</mo><msub id="algx1.l5.m1.1.1.1.1.1.2" xref="algx1.l5.m1.1.1.1.1.1.2.cmml"><mi id="algx1.l5.m1.1.1.1.1.1.2.2" xref="algx1.l5.m1.1.1.1.1.1.2.2.cmml">F</mi><mi id="algx1.l5.m1.1.1.1.1.1.2.3" xref="algx1.l5.m1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo id="algx1.l5.m1.2.2.2.2.3" xref="algx1.l5.m1.2.2.2.3.cmml">,</mo><msub id="algx1.l5.m1.2.2.2.2.2" xref="algx1.l5.m1.2.2.2.2.2.cmml"><mi id="algx1.l5.m1.2.2.2.2.2.2" xref="algx1.l5.m1.2.2.2.2.2.2.cmml">C</mi><mi id="algx1.l5.m1.2.2.2.2.2.3" xref="algx1.l5.m1.2.2.2.2.2.3.cmml">e</mi></msub></mrow><mo stretchy="false" id="algx1.l5.m1.2.2.3" xref="algx1.l5.m1.2.2.3.cmml">←</mo><mi id="algx1.l5.m1.2.2.4" xref="algx1.l5.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l5.m1.2b"><apply id="algx1.l5.m1.2.2.cmml" xref="algx1.l5.m1.2.2"><ci id="algx1.l5.m1.2.2.3.cmml" xref="algx1.l5.m1.2.2.3">←</ci><list id="algx1.l5.m1.2.2.2.3.cmml" xref="algx1.l5.m1.2.2.2.2"><apply id="algx1.l5.m1.1.1.1.1.1.cmml" xref="algx1.l5.m1.1.1.1.1.1"><ci id="algx1.l5.m1.1.1.1.1.1.1.cmml" xref="algx1.l5.m1.1.1.1.1.1.1">∇</ci><apply id="algx1.l5.m1.1.1.1.1.1.2.cmml" xref="algx1.l5.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algx1.l5.m1.1.1.1.1.1.2.1.cmml" xref="algx1.l5.m1.1.1.1.1.1.2">subscript</csymbol><ci id="algx1.l5.m1.1.1.1.1.1.2.2.cmml" xref="algx1.l5.m1.1.1.1.1.1.2.2">𝐹</ci><ci id="algx1.l5.m1.1.1.1.1.1.2.3.cmml" xref="algx1.l5.m1.1.1.1.1.1.2.3">𝑒</ci></apply></apply><apply id="algx1.l5.m1.2.2.2.2.2.cmml" xref="algx1.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l5.m1.2.2.2.2.2.1.cmml" xref="algx1.l5.m1.2.2.2.2.2">subscript</csymbol><ci id="algx1.l5.m1.2.2.2.2.2.2.cmml" xref="algx1.l5.m1.2.2.2.2.2.2">𝐶</ci><ci id="algx1.l5.m1.2.2.2.2.2.3.cmml" xref="algx1.l5.m1.2.2.2.2.2.3">𝑒</ci></apply></list><csymbol cd="latexml" id="algx1.l5.m1.2.2.4.cmml" xref="algx1.l5.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m1.2c">\nabla F_{e},C_{e}\leftarrow</annotation></semantics></math> ClientUpdates(<math id="algx1.l5.m2.1" class="ltx_Math" alttext="e" display="inline"><semantics id="algx1.l5.m2.1a"><mi id="algx1.l5.m2.1.1" xref="algx1.l5.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.m2.1b"><ci id="algx1.l5.m2.1.1.cmml" xref="algx1.l5.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m2.1c">e</annotation></semantics></math>, <math id="algx1.l5.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="algx1.l5.m3.1a"><mi id="algx1.l5.m3.1.1" xref="algx1.l5.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="algx1.l5.m3.1b"><ci id="algx1.l5.m3.1.1.cmml" xref="algx1.l5.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l5.m3.1c">w</annotation></semantics></math>)

</div>
<div id="algx1.l6" class="ltx_listingline">         <span id="algx1.l6.1" class="ltx_text ltx_font_bold">end</span> <span id="algx1.l6.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="algx1.l7" class="ltx_listingline">         <math id="algx1.l7.m1.2" class="ltx_math_unparsed" alttext="G_{k}\leftarrow\{[\nabla F_{e}]_{k},e\in\mathcal{E}\},k\in[0..n-1]" display="inline"><semantics id="algx1.l7.m1.2a"><mrow id="algx1.l7.m1.2b"><msub id="algx1.l7.m1.2.3"><mi id="algx1.l7.m1.2.3.2">G</mi><mi id="algx1.l7.m1.2.3.3">k</mi></msub><mo stretchy="false" id="algx1.l7.m1.2.4">←</mo><mrow id="algx1.l7.m1.2.5"><mo stretchy="false" id="algx1.l7.m1.2.5.1">{</mo><msub id="algx1.l7.m1.2.5.2"><mrow id="algx1.l7.m1.2.5.2.2"><mo stretchy="false" id="algx1.l7.m1.2.5.2.2.1">[</mo><mo rspace="0.167em" id="algx1.l7.m1.2.5.2.2.2">∇</mo><msub id="algx1.l7.m1.2.5.2.2.3"><mi id="algx1.l7.m1.2.5.2.2.3.2">F</mi><mi id="algx1.l7.m1.2.5.2.2.3.3">e</mi></msub><mo stretchy="false" id="algx1.l7.m1.2.5.2.2.4">]</mo></mrow><mi id="algx1.l7.m1.2.5.2.3">k</mi></msub><mo id="algx1.l7.m1.2.5.3">,</mo><mi id="algx1.l7.m1.1.1">e</mi><mo id="algx1.l7.m1.2.5.4">∈</mo><mi class="ltx_font_mathcaligraphic" id="algx1.l7.m1.2.5.5">ℰ</mi><mo stretchy="false" id="algx1.l7.m1.2.5.6">}</mo></mrow><mo id="algx1.l7.m1.2.6">,</mo><mi id="algx1.l7.m1.2.2">k</mi><mo id="algx1.l7.m1.2.7">∈</mo><mrow id="algx1.l7.m1.2.8"><mo stretchy="false" id="algx1.l7.m1.2.8.1">[</mo><mn id="algx1.l7.m1.2.8.2">0</mn><mo lspace="0em" rspace="0.0835em" id="algx1.l7.m1.2.8.3">.</mo><mo lspace="0.0835em" rspace="0.167em" id="algx1.l7.m1.2.8.4">.</mo><mi id="algx1.l7.m1.2.8.5">n</mi><mo id="algx1.l7.m1.2.8.6">−</mo><mn id="algx1.l7.m1.2.8.7">1</mn><mo stretchy="false" id="algx1.l7.m1.2.8.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algx1.l7.m1.2c">G_{k}\leftarrow\{[\nabla F_{e}]_{k},e\in\mathcal{E}\},k\in[0..n-1]</annotation></semantics></math>

</div>
<div id="algx1.l8" class="ltx_listingline">         <math id="algx1.l8.m1.1" class="ltx_math_unparsed" alttext="\left[\nabla^{\wedge}F\right]_{k}\leftarrow weightedgeo(G_{k}),k\in[0..n-1]" display="inline"><semantics id="algx1.l8.m1.1a"><mrow id="algx1.l8.m1.1b"><msub id="algx1.l8.m1.1.2"><mrow id="algx1.l8.m1.1.2.2"><mo id="algx1.l8.m1.1.2.2.1">[</mo><msup id="algx1.l8.m1.1.2.2.2"><mo rspace="0.167em" id="algx1.l8.m1.1.2.2.2.2">∇</mo><mo id="algx1.l8.m1.1.2.2.2.3">∧</mo></msup><mi id="algx1.l8.m1.1.2.2.3">F</mi><mo id="algx1.l8.m1.1.2.2.4">]</mo></mrow><mi id="algx1.l8.m1.1.2.3">k</mi></msub><mo stretchy="false" id="algx1.l8.m1.1.3">←</mo><mi id="algx1.l8.m1.1.4">w</mi><mi id="algx1.l8.m1.1.5">e</mi><mi id="algx1.l8.m1.1.6">i</mi><mi id="algx1.l8.m1.1.7">g</mi><mi id="algx1.l8.m1.1.8">h</mi><mi id="algx1.l8.m1.1.9">t</mi><mi id="algx1.l8.m1.1.10">e</mi><mi id="algx1.l8.m1.1.11">d</mi><mi id="algx1.l8.m1.1.12">g</mi><mi id="algx1.l8.m1.1.13">e</mi><mi id="algx1.l8.m1.1.14">o</mi><mrow id="algx1.l8.m1.1.15"><mo stretchy="false" id="algx1.l8.m1.1.15.1">(</mo><msub id="algx1.l8.m1.1.15.2"><mi id="algx1.l8.m1.1.15.2.2">G</mi><mi id="algx1.l8.m1.1.15.2.3">k</mi></msub><mo stretchy="false" id="algx1.l8.m1.1.15.3">)</mo></mrow><mo id="algx1.l8.m1.1.16">,</mo><mi id="algx1.l8.m1.1.1">k</mi><mo id="algx1.l8.m1.1.17">∈</mo><mrow id="algx1.l8.m1.1.18"><mo stretchy="false" id="algx1.l8.m1.1.18.1">[</mo><mn id="algx1.l8.m1.1.18.2">0</mn><mo lspace="0em" rspace="0.0835em" id="algx1.l8.m1.1.18.3">.</mo><mo lspace="0.0835em" rspace="0.167em" id="algx1.l8.m1.1.18.4">.</mo><mi id="algx1.l8.m1.1.18.5">n</mi><mo id="algx1.l8.m1.1.18.6">−</mo><mn id="algx1.l8.m1.1.18.7">1</mn><mo stretchy="false" id="algx1.l8.m1.1.18.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algx1.l8.m1.1c">\left[\nabla^{\wedge}F\right]_{k}\leftarrow weightedgeo(G_{k}),k\in[0..n-1]</annotation></semantics></math> <span id="algx1.l8.1" class="ltx_text" style="float:right;"><math id="algx1.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algx1.l8.1.m1.1a"><mo id="algx1.l8.1.m1.1.1" xref="algx1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l8.1.m1.1b"><ci id="algx1.l8.1.m1.1.1.cmml" xref="algx1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l8.1.m1.1c">\triangleright</annotation></semantics></math> Weighted geometric mean
</span>
</div>
<div id="algx1.l9" class="ltx_listingline">         <math id="algx1.l9.m1.1" class="ltx_math_unparsed" alttext="L_{Fishr}\leftarrow\frac{1}{\mathcal{E}}\sum_{e\in\mathcal{E}}\|C_{e}-\overset{-}{C}\rVert^{2}" display="inline"><semantics id="algx1.l9.m1.1a"><mrow id="algx1.l9.m1.1b"><msub id="algx1.l9.m1.1.1"><mi id="algx1.l9.m1.1.1.2">L</mi><mrow id="algx1.l9.m1.1.1.3"><mi id="algx1.l9.m1.1.1.3.2">F</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.1.1.3.1">​</mo><mi id="algx1.l9.m1.1.1.3.3">i</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.1.1.3.1a">​</mo><mi id="algx1.l9.m1.1.1.3.4">s</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.1.1.3.1b">​</mo><mi id="algx1.l9.m1.1.1.3.5">h</mi><mo lspace="0em" rspace="0em" id="algx1.l9.m1.1.1.3.1c">​</mo><mi id="algx1.l9.m1.1.1.3.6">r</mi></mrow></msub><mo stretchy="false" id="algx1.l9.m1.1.2">←</mo><mfrac id="algx1.l9.m1.1.3"><mn id="algx1.l9.m1.1.3.2">1</mn><mi class="ltx_font_mathcaligraphic" id="algx1.l9.m1.1.3.3">ℰ</mi></mfrac><msub id="algx1.l9.m1.1.4"><mo rspace="0em" id="algx1.l9.m1.1.4.2">∑</mo><mrow id="algx1.l9.m1.1.4.3"><mi id="algx1.l9.m1.1.4.3.2">e</mi><mo id="algx1.l9.m1.1.4.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="algx1.l9.m1.1.4.3.3">ℰ</mi></mrow></msub><mo lspace="0em" rspace="0.167em" id="algx1.l9.m1.1.5">∥</mo><msub id="algx1.l9.m1.1.6"><mi id="algx1.l9.m1.1.6.2">C</mi><mi id="algx1.l9.m1.1.6.3">e</mi></msub><mo id="algx1.l9.m1.1.7">−</mo><mover accent="true" id="algx1.l9.m1.1.8"><mi id="algx1.l9.m1.1.8.2">C</mi><mo id="algx1.l9.m1.1.8.1">-</mo></mover><mo fence="true" lspace="0em" rspace="0em" id="algx1.l9.m1.1.9">∥</mo><msup id="algx1.l9.m1.1.10"><mi id="algx1.l9.m1.1.10a"></mi><mn id="algx1.l9.m1.1.10.1">2</mn></msup></mrow><annotation encoding="application/x-tex" id="algx1.l9.m1.1c">L_{Fishr}\leftarrow\frac{1}{\mathcal{E}}\sum_{e\in\mathcal{E}}\|C_{e}-\overset{-}{C}\rVert^{2}</annotation></semantics></math> <span id="algx1.l9.1" class="ltx_text" style="float:right;"><math id="algx1.l9.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algx1.l9.1.m1.1a"><mo id="algx1.l9.1.m1.1.1" xref="algx1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l9.1.m1.1b"><ci id="algx1.l9.1.m1.1.1.cmml" xref="algx1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.1.m1.1c">\triangleright</annotation></semantics></math> Fishr loss
</span>
</div>
<div id="algx1.l10" class="ltx_listingline">         <math id="algx1.l10.m1.1" class="ltx_Math" alttext="w\leftarrow w-\eta\left(\nabla^{\wedge}F+\lambda\nabla L_{Fishr}\right)" display="inline"><semantics id="algx1.l10.m1.1a"><mrow id="algx1.l10.m1.1.1" xref="algx1.l10.m1.1.1.cmml"><mi id="algx1.l10.m1.1.1.3" xref="algx1.l10.m1.1.1.3.cmml">w</mi><mo stretchy="false" id="algx1.l10.m1.1.1.2" xref="algx1.l10.m1.1.1.2.cmml">←</mo><mrow id="algx1.l10.m1.1.1.1" xref="algx1.l10.m1.1.1.1.cmml"><mi id="algx1.l10.m1.1.1.1.3" xref="algx1.l10.m1.1.1.1.3.cmml">w</mi><mo id="algx1.l10.m1.1.1.1.2" xref="algx1.l10.m1.1.1.1.2.cmml">−</mo><mrow id="algx1.l10.m1.1.1.1.1" xref="algx1.l10.m1.1.1.1.1.cmml"><mi id="algx1.l10.m1.1.1.1.1.3" xref="algx1.l10.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="algx1.l10.m1.1.1.1.1.2" xref="algx1.l10.m1.1.1.1.1.2.cmml">​</mo><mrow id="algx1.l10.m1.1.1.1.1.1.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.cmml"><mo id="algx1.l10.m1.1.1.1.1.1.1.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l10.m1.1.1.1.1.1.1.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.cmml"><mrow id="algx1.l10.m1.1.1.1.1.1.1.1.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.cmml"><msup id="algx1.l10.m1.1.1.1.1.1.1.1.2.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1.cmml"><mo rspace="0.167em" id="algx1.l10.m1.1.1.1.1.1.1.1.2.1.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1.2.cmml">∇</mo><mo id="algx1.l10.m1.1.1.1.1.1.1.1.2.1.3" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1.3.cmml">∧</mo></msup><mi id="algx1.l10.m1.1.1.1.1.1.1.1.2.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.2.cmml">F</mi></mrow><mo id="algx1.l10.m1.1.1.1.1.1.1.1.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="algx1.l10.m1.1.1.1.1.1.1.1.3" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.cmml"><mi id="algx1.l10.m1.1.1.1.1.1.1.1.3.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mo lspace="0.167em" rspace="0em" id="algx1.l10.m1.1.1.1.1.1.1.1.3.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="algx1.l10.m1.1.1.1.1.1.1.1.3.3" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.cmml"><mo rspace="0.167em" id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.1.cmml">∇</mo><msub id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">L</mi><mrow id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.2" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.3" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1a" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.4" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1b" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.5" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1c" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.6" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.6.cmml">r</mi></mrow></msub></mrow></mrow></mrow><mo id="algx1.l10.m1.1.1.1.1.1.1.3" xref="algx1.l10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l10.m1.1b"><apply id="algx1.l10.m1.1.1.cmml" xref="algx1.l10.m1.1.1"><ci id="algx1.l10.m1.1.1.2.cmml" xref="algx1.l10.m1.1.1.2">←</ci><ci id="algx1.l10.m1.1.1.3.cmml" xref="algx1.l10.m1.1.1.3">𝑤</ci><apply id="algx1.l10.m1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1"><minus id="algx1.l10.m1.1.1.1.2.cmml" xref="algx1.l10.m1.1.1.1.2"></minus><ci id="algx1.l10.m1.1.1.1.3.cmml" xref="algx1.l10.m1.1.1.1.3">𝑤</ci><apply id="algx1.l10.m1.1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1.1"><times id="algx1.l10.m1.1.1.1.1.2.cmml" xref="algx1.l10.m1.1.1.1.1.2"></times><ci id="algx1.l10.m1.1.1.1.1.3.cmml" xref="algx1.l10.m1.1.1.1.1.3">𝜂</ci><apply id="algx1.l10.m1.1.1.1.1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1"><plus id="algx1.l10.m1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.1"></plus><apply id="algx1.l10.m1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2"><apply id="algx1.l10.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="algx1.l10.m1.1.1.1.1.1.1.1.2.1.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1">superscript</csymbol><ci id="algx1.l10.m1.1.1.1.1.1.1.1.2.1.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1.2">∇</ci><and id="algx1.l10.m1.1.1.1.1.1.1.1.2.1.3.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.1.3"></and></apply><ci id="algx1.l10.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.2.2">𝐹</ci></apply><apply id="algx1.l10.m1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3"><times id="algx1.l10.m1.1.1.1.1.1.1.1.3.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.1"></times><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.2">𝜆</ci><apply id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3"><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.1">∇</ci><apply id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.2">𝐿</ci><apply id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3"><times id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.1"></times><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.2">𝐹</ci><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.3">𝑖</ci><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.4.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.4">𝑠</ci><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.5.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.5">ℎ</ci><ci id="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.6.cmml" xref="algx1.l10.m1.1.1.1.1.1.1.1.3.3.2.3.6">𝑟</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l10.m1.1c">w\leftarrow w-\eta\left(\nabla^{\wedge}F+\lambda\nabla L_{Fishr}\right)</annotation></semantics></math>

</div>
<div id="algx1.l11" class="ltx_listingline">     <span id="algx1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="algx1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="algx1.l12" class="ltx_listingline">
<span id="algx1.l12.1" class="ltx_text ltx_font_bold">end</span> <span id="algx1.l12.2" class="ltx_text ltx_font_bold">function</span>
</div>
<div id="algx1.l13" class="ltx_listingline">
</div>
<div id="algx1.l14" class="ltx_listingline">
<span id="algx1.l14.1" class="ltx_text ltx_font_bold">function</span> <span id="algx1.l14.2" class="ltx_text ltx_font_smallcaps">ClientUpdates</span>(<math id="algx1.l14.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="algx1.l14.m1.1a"><mi id="algx1.l14.m1.1.1" xref="algx1.l14.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="algx1.l14.m1.1b"><ci id="algx1.l14.m1.1.1.cmml" xref="algx1.l14.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l14.m1.1c">e</annotation></semantics></math>, <math id="algx1.l14.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="algx1.l14.m2.1a"><mi id="algx1.l14.m2.1.1" xref="algx1.l14.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="algx1.l14.m2.1b"><ci id="algx1.l14.m2.1.1.cmml" xref="algx1.l14.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l14.m2.1c">w</annotation></semantics></math>)

</div>
<div id="algx1.l15" class="ltx_listingline">     <math id="algx1.l15.m1.1" class="ltx_Math" alttext="\nabla F_{e}\leftarrow" display="inline"><semantics id="algx1.l15.m1.1a"><mrow id="algx1.l15.m1.1.1" xref="algx1.l15.m1.1.1.cmml"><mrow id="algx1.l15.m1.1.1.2" xref="algx1.l15.m1.1.1.2.cmml"><mo rspace="0.167em" id="algx1.l15.m1.1.1.2.1" xref="algx1.l15.m1.1.1.2.1.cmml">∇</mo><msub id="algx1.l15.m1.1.1.2.2" xref="algx1.l15.m1.1.1.2.2.cmml"><mi id="algx1.l15.m1.1.1.2.2.2" xref="algx1.l15.m1.1.1.2.2.2.cmml">F</mi><mi id="algx1.l15.m1.1.1.2.2.3" xref="algx1.l15.m1.1.1.2.2.3.cmml">e</mi></msub></mrow><mo stretchy="false" id="algx1.l15.m1.1.1.1" xref="algx1.l15.m1.1.1.1.cmml">←</mo><mi id="algx1.l15.m1.1.1.3" xref="algx1.l15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algx1.l15.m1.1b"><apply id="algx1.l15.m1.1.1.cmml" xref="algx1.l15.m1.1.1"><ci id="algx1.l15.m1.1.1.1.cmml" xref="algx1.l15.m1.1.1.1">←</ci><apply id="algx1.l15.m1.1.1.2.cmml" xref="algx1.l15.m1.1.1.2"><ci id="algx1.l15.m1.1.1.2.1.cmml" xref="algx1.l15.m1.1.1.2.1">∇</ci><apply id="algx1.l15.m1.1.1.2.2.cmml" xref="algx1.l15.m1.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l15.m1.1.1.2.2.1.cmml" xref="algx1.l15.m1.1.1.2.2">subscript</csymbol><ci id="algx1.l15.m1.1.1.2.2.2.cmml" xref="algx1.l15.m1.1.1.2.2.2">𝐹</ci><ci id="algx1.l15.m1.1.1.2.2.3.cmml" xref="algx1.l15.m1.1.1.2.2.3">𝑒</ci></apply></apply><csymbol cd="latexml" id="algx1.l15.m1.1.1.3.cmml" xref="algx1.l15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l15.m1.1c">\nabla F_{e}\leftarrow</annotation></semantics></math> backwards(<math id="algx1.l15.m2.1" class="ltx_Math" alttext="F_{e}" display="inline"><semantics id="algx1.l15.m2.1a"><msub id="algx1.l15.m2.1.1" xref="algx1.l15.m2.1.1.cmml"><mi id="algx1.l15.m2.1.1.2" xref="algx1.l15.m2.1.1.2.cmml">F</mi><mi id="algx1.l15.m2.1.1.3" xref="algx1.l15.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l15.m2.1b"><apply id="algx1.l15.m2.1.1.cmml" xref="algx1.l15.m2.1.1"><csymbol cd="ambiguous" id="algx1.l15.m2.1.1.1.cmml" xref="algx1.l15.m2.1.1">subscript</csymbol><ci id="algx1.l15.m2.1.1.2.cmml" xref="algx1.l15.m2.1.1.2">𝐹</ci><ci id="algx1.l15.m2.1.1.3.cmml" xref="algx1.l15.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l15.m2.1c">F_{e}</annotation></semantics></math>, <math id="algx1.l15.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="algx1.l15.m3.1a"><mi id="algx1.l15.m3.1.1" xref="algx1.l15.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="algx1.l15.m3.1b"><ci id="algx1.l15.m3.1.1.cmml" xref="algx1.l15.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l15.m3.1c">w</annotation></semantics></math>)

</div>
<div id="algx1.l16" class="ltx_listingline">     <math id="algx1.l16.m1.2" class="ltx_Math" alttext="C_{e}\leftarrow\frac{1}{n_{e}}\sum_{i=1}^{n_{e}}\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)^{\top}" display="inline"><semantics id="algx1.l16.m1.2a"><mrow id="algx1.l16.m1.2.2" xref="algx1.l16.m1.2.2.cmml"><msub id="algx1.l16.m1.2.2.4" xref="algx1.l16.m1.2.2.4.cmml"><mi id="algx1.l16.m1.2.2.4.2" xref="algx1.l16.m1.2.2.4.2.cmml">C</mi><mi id="algx1.l16.m1.2.2.4.3" xref="algx1.l16.m1.2.2.4.3.cmml">e</mi></msub><mo stretchy="false" id="algx1.l16.m1.2.2.3" xref="algx1.l16.m1.2.2.3.cmml">←</mo><mrow id="algx1.l16.m1.2.2.2" xref="algx1.l16.m1.2.2.2.cmml"><mfrac id="algx1.l16.m1.2.2.2.4" xref="algx1.l16.m1.2.2.2.4.cmml"><mn id="algx1.l16.m1.2.2.2.4.2" xref="algx1.l16.m1.2.2.2.4.2.cmml">1</mn><msub id="algx1.l16.m1.2.2.2.4.3" xref="algx1.l16.m1.2.2.2.4.3.cmml"><mi id="algx1.l16.m1.2.2.2.4.3.2" xref="algx1.l16.m1.2.2.2.4.3.2.cmml">n</mi><mi id="algx1.l16.m1.2.2.2.4.3.3" xref="algx1.l16.m1.2.2.2.4.3.3.cmml">e</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="algx1.l16.m1.2.2.2.3" xref="algx1.l16.m1.2.2.2.3.cmml">​</mo><mrow id="algx1.l16.m1.2.2.2.2" xref="algx1.l16.m1.2.2.2.2.cmml"><msubsup id="algx1.l16.m1.2.2.2.2.3" xref="algx1.l16.m1.2.2.2.2.3.cmml"><mo rspace="0em" id="algx1.l16.m1.2.2.2.2.3.2.2" xref="algx1.l16.m1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="algx1.l16.m1.2.2.2.2.3.2.3" xref="algx1.l16.m1.2.2.2.2.3.2.3.cmml"><mi id="algx1.l16.m1.2.2.2.2.3.2.3.2" xref="algx1.l16.m1.2.2.2.2.3.2.3.2.cmml">i</mi><mo id="algx1.l16.m1.2.2.2.2.3.2.3.1" xref="algx1.l16.m1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="algx1.l16.m1.2.2.2.2.3.2.3.3" xref="algx1.l16.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="algx1.l16.m1.2.2.2.2.3.3" xref="algx1.l16.m1.2.2.2.2.3.3.cmml"><mi id="algx1.l16.m1.2.2.2.2.3.3.2" xref="algx1.l16.m1.2.2.2.2.3.3.2.cmml">n</mi><mi id="algx1.l16.m1.2.2.2.2.3.3.3" xref="algx1.l16.m1.2.2.2.2.3.3.3.cmml">e</mi></msub></msubsup><mrow id="algx1.l16.m1.2.2.2.2.2" xref="algx1.l16.m1.2.2.2.2.2.cmml"><mrow id="algx1.l16.m1.1.1.1.1.1.1.1" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.cmml"><mo id="algx1.l16.m1.1.1.1.1.1.1.1.2" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx1.l16.m1.1.1.1.1.1.1.1.1" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="algx1.l16.m1.1.1.1.1.1.1.1.1.2" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.1" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.1.cmml">∇</mo><msubsup id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">F</mi><mi id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">e</mi><mi id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.3" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup></mrow><mo id="algx1.l16.m1.1.1.1.1.1.1.1.1.1" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="algx1.l16.m1.1.1.1.1.1.1.1.1.3" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mo rspace="0.167em" id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.1" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">∇</mo><msub id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.2" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">F</mi><mi id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.3" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">e</mi></msub></mrow><mo id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.1" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.1.cmml">-</mo></mover></mrow><mo id="algx1.l16.m1.1.1.1.1.1.1.1.3" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="algx1.l16.m1.2.2.2.2.2.3" xref="algx1.l16.m1.2.2.2.2.2.3.cmml">​</mo><msup id="algx1.l16.m1.2.2.2.2.2.2" xref="algx1.l16.m1.2.2.2.2.2.2.cmml"><mrow id="algx1.l16.m1.2.2.2.2.2.2.1.1" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="algx1.l16.m1.2.2.2.2.2.2.1.1.2" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="algx1.l16.m1.2.2.2.2.2.2.1.1.1" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.cmml"><mrow id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.cmml"><mo rspace="0.167em" id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.1" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.1.cmml">∇</mo><msubsup id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.cmml"><mi id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.2" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.2.cmml">F</mi><mi id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.3" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.3.cmml">e</mi><mi id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.3" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.3.cmml">i</mi></msubsup></mrow><mo id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.1" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.cmml"><mrow id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.cmml"><mo rspace="0.167em" id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.1" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml">∇</mo><msub id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml"><mi id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.2" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.2.cmml">F</mi><mi id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.3" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.3.cmml">e</mi></msub></mrow><mo id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.1" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.1.cmml">-</mo></mover></mrow><mo id="algx1.l16.m1.2.2.2.2.2.2.1.1.3" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="algx1.l16.m1.2.2.2.2.2.2.3" xref="algx1.l16.m1.2.2.2.2.2.2.3.cmml">⊤</mo></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx1.l16.m1.2b"><apply id="algx1.l16.m1.2.2.cmml" xref="algx1.l16.m1.2.2"><ci id="algx1.l16.m1.2.2.3.cmml" xref="algx1.l16.m1.2.2.3">←</ci><apply id="algx1.l16.m1.2.2.4.cmml" xref="algx1.l16.m1.2.2.4"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.4.1.cmml" xref="algx1.l16.m1.2.2.4">subscript</csymbol><ci id="algx1.l16.m1.2.2.4.2.cmml" xref="algx1.l16.m1.2.2.4.2">𝐶</ci><ci id="algx1.l16.m1.2.2.4.3.cmml" xref="algx1.l16.m1.2.2.4.3">𝑒</ci></apply><apply id="algx1.l16.m1.2.2.2.cmml" xref="algx1.l16.m1.2.2.2"><times id="algx1.l16.m1.2.2.2.3.cmml" xref="algx1.l16.m1.2.2.2.3"></times><apply id="algx1.l16.m1.2.2.2.4.cmml" xref="algx1.l16.m1.2.2.2.4"><divide id="algx1.l16.m1.2.2.2.4.1.cmml" xref="algx1.l16.m1.2.2.2.4"></divide><cn type="integer" id="algx1.l16.m1.2.2.2.4.2.cmml" xref="algx1.l16.m1.2.2.2.4.2">1</cn><apply id="algx1.l16.m1.2.2.2.4.3.cmml" xref="algx1.l16.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.4.3.1.cmml" xref="algx1.l16.m1.2.2.2.4.3">subscript</csymbol><ci id="algx1.l16.m1.2.2.2.4.3.2.cmml" xref="algx1.l16.m1.2.2.2.4.3.2">𝑛</ci><ci id="algx1.l16.m1.2.2.2.4.3.3.cmml" xref="algx1.l16.m1.2.2.2.4.3.3">𝑒</ci></apply></apply><apply id="algx1.l16.m1.2.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2"><apply id="algx1.l16.m1.2.2.2.2.3.cmml" xref="algx1.l16.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.2.3.1.cmml" xref="algx1.l16.m1.2.2.2.2.3">superscript</csymbol><apply id="algx1.l16.m1.2.2.2.2.3.2.cmml" xref="algx1.l16.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.2.3.2.1.cmml" xref="algx1.l16.m1.2.2.2.2.3">subscript</csymbol><sum id="algx1.l16.m1.2.2.2.2.3.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.3.2.2"></sum><apply id="algx1.l16.m1.2.2.2.2.3.2.3.cmml" xref="algx1.l16.m1.2.2.2.2.3.2.3"><eq id="algx1.l16.m1.2.2.2.2.3.2.3.1.cmml" xref="algx1.l16.m1.2.2.2.2.3.2.3.1"></eq><ci id="algx1.l16.m1.2.2.2.2.3.2.3.2.cmml" xref="algx1.l16.m1.2.2.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="algx1.l16.m1.2.2.2.2.3.2.3.3.cmml" xref="algx1.l16.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="algx1.l16.m1.2.2.2.2.3.3.cmml" xref="algx1.l16.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.2.3.3.1.cmml" xref="algx1.l16.m1.2.2.2.2.3.3">subscript</csymbol><ci id="algx1.l16.m1.2.2.2.2.3.3.2.cmml" xref="algx1.l16.m1.2.2.2.2.3.3.2">𝑛</ci><ci id="algx1.l16.m1.2.2.2.2.3.3.3.cmml" xref="algx1.l16.m1.2.2.2.2.3.3.3">𝑒</ci></apply></apply><apply id="algx1.l16.m1.2.2.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2"><times id="algx1.l16.m1.2.2.2.2.2.3.cmml" xref="algx1.l16.m1.2.2.2.2.2.3"></times><apply id="algx1.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1"><minus id="algx1.l16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2"><ci id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.1">∇</ci><apply id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝐹</ci><ci id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.2.3">𝑒</ci></apply><ci id="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3"><minus id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.1"></minus><apply id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2"><ci id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.1">∇</ci><apply id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.2">𝐹</ci><ci id="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="algx1.l16.m1.1.1.1.1.1.1.1.1.3.2.2.3">𝑒</ci></apply></apply></apply></apply><apply id="algx1.l16.m1.2.2.2.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.2.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2">superscript</csymbol><apply id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1"><minus id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.1"></minus><apply id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2"><ci id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.1">∇</ci><apply id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2">superscript</csymbol><apply id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2">subscript</csymbol><ci id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.2">𝐹</ci><ci id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.2.3">𝑒</ci></apply><ci id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3"><minus id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.1"></minus><apply id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2"><ci id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.1">∇</ci><apply id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2"><csymbol cd="ambiguous" id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.1.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2">subscript</csymbol><ci id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.2.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.2">𝐹</ci><ci id="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.3.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.1.1.1.3.2.2.3">𝑒</ci></apply></apply></apply></apply><csymbol cd="latexml" id="algx1.l16.m1.2.2.2.2.2.2.3.cmml" xref="algx1.l16.m1.2.2.2.2.2.2.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.m1.2c">C_{e}\leftarrow\frac{1}{n_{e}}\sum_{i=1}^{n_{e}}\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)^{\top}</annotation></semantics></math> <span id="algx1.l16.1" class="ltx_text" style="float:right;"><math id="algx1.l16.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algx1.l16.1.m1.1a"><mo id="algx1.l16.1.m1.1.1" xref="algx1.l16.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx1.l16.1.m1.1b"><ci id="algx1.l16.1.m1.1.1.cmml" xref="algx1.l16.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l16.1.m1.1c">\triangleright</annotation></semantics></math> Gradient covariance
</span>
</div>
<div id="algx1.l17" class="ltx_listingline">     <span id="algx1.l17.1" class="ltx_text ltx_font_bold">return</span> <math id="algx1.l17.m1.1" class="ltx_Math" alttext="\nabla F_{e}" display="inline"><semantics id="algx1.l17.m1.1a"><mrow id="algx1.l17.m1.1.1" xref="algx1.l17.m1.1.1.cmml"><mo rspace="0.167em" id="algx1.l17.m1.1.1.1" xref="algx1.l17.m1.1.1.1.cmml">∇</mo><msub id="algx1.l17.m1.1.1.2" xref="algx1.l17.m1.1.1.2.cmml"><mi id="algx1.l17.m1.1.1.2.2" xref="algx1.l17.m1.1.1.2.2.cmml">F</mi><mi id="algx1.l17.m1.1.1.2.3" xref="algx1.l17.m1.1.1.2.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l17.m1.1b"><apply id="algx1.l17.m1.1.1.cmml" xref="algx1.l17.m1.1.1"><ci id="algx1.l17.m1.1.1.1.cmml" xref="algx1.l17.m1.1.1.1">∇</ci><apply id="algx1.l17.m1.1.1.2.cmml" xref="algx1.l17.m1.1.1.2"><csymbol cd="ambiguous" id="algx1.l17.m1.1.1.2.1.cmml" xref="algx1.l17.m1.1.1.2">subscript</csymbol><ci id="algx1.l17.m1.1.1.2.2.cmml" xref="algx1.l17.m1.1.1.2.2">𝐹</ci><ci id="algx1.l17.m1.1.1.2.3.cmml" xref="algx1.l17.m1.1.1.2.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l17.m1.1c">\nabla F_{e}</annotation></semantics></math>, <math id="algx1.l17.m2.1" class="ltx_Math" alttext="C_{e}" display="inline"><semantics id="algx1.l17.m2.1a"><msub id="algx1.l17.m2.1.1" xref="algx1.l17.m2.1.1.cmml"><mi id="algx1.l17.m2.1.1.2" xref="algx1.l17.m2.1.1.2.cmml">C</mi><mi id="algx1.l17.m2.1.1.3" xref="algx1.l17.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l17.m2.1b"><apply id="algx1.l17.m2.1.1.cmml" xref="algx1.l17.m2.1.1"><csymbol cd="ambiguous" id="algx1.l17.m2.1.1.1.cmml" xref="algx1.l17.m2.1.1">subscript</csymbol><ci id="algx1.l17.m2.1.1.2.cmml" xref="algx1.l17.m2.1.1.2">𝐶</ci><ci id="algx1.l17.m2.1.1.3.cmml" xref="algx1.l17.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l17.m2.1c">C_{e}</annotation></semantics></math>

</div>
<div id="algx1.l18" class="ltx_listingline">
<span id="algx1.l18.1" class="ltx_text ltx_font_bold">end</span> <span id="algx1.l18.2" class="ltx_text ltx_font_bold">function</span>
</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Fishr+Intra-Geo: Fishr and Intra-silo Weighted Geometric Mean.</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="algx2.l1" class="ltx_listingline">
<span id="algx2.l1.1" class="ltx_text ltx_font_bold">function</span> <span id="algx2.l1.2" class="ltx_text ltx_font_smallcaps">ServerExecutes</span>(<span id="algx2.l1.3" class="ltx_text"></span>)

</div>
<div id="algx2.l2" class="ltx_listingline">     initialize <math id="algx2.l2.m1.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="algx2.l2.m1.1a"><msub id="algx2.l2.m1.1.1" xref="algx2.l2.m1.1.1.cmml"><mi id="algx2.l2.m1.1.1.2" xref="algx2.l2.m1.1.1.2.cmml">w</mi><mn id="algx2.l2.m1.1.1.3" xref="algx2.l2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algx2.l2.m1.1b"><apply id="algx2.l2.m1.1.1.cmml" xref="algx2.l2.m1.1.1"><csymbol cd="ambiguous" id="algx2.l2.m1.1.1.1.cmml" xref="algx2.l2.m1.1.1">subscript</csymbol><ci id="algx2.l2.m1.1.1.2.cmml" xref="algx2.l2.m1.1.1.2">𝑤</ci><cn type="integer" id="algx2.l2.m1.1.1.3.cmml" xref="algx2.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l2.m1.1c">w_{0}</annotation></semantics></math>

</div>
<div id="algx2.l3" class="ltx_listingline">     <span id="algx2.l3.1" class="ltx_text ltx_font_bold">for</span> each round <math id="algx2.l3.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="algx2.l3.m1.1a"><mi id="algx2.l3.m1.1.1" xref="algx2.l3.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="algx2.l3.m1.1b"><ci id="algx2.l3.m1.1.1.cmml" xref="algx2.l3.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l3.m1.1c">t</annotation></semantics></math> = 0, 1, 2, … <span id="algx2.l3.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="algx2.l4" class="ltx_listingline">         <span id="algx2.l4.1" class="ltx_text ltx_font_bold">for</span> each client <math id="algx2.l4.m1.1" class="ltx_Math" alttext="e\in\mathcal{E}" display="inline"><semantics id="algx2.l4.m1.1a"><mrow id="algx2.l4.m1.1.1" xref="algx2.l4.m1.1.1.cmml"><mi id="algx2.l4.m1.1.1.2" xref="algx2.l4.m1.1.1.2.cmml">e</mi><mo id="algx2.l4.m1.1.1.1" xref="algx2.l4.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="algx2.l4.m1.1.1.3" xref="algx2.l4.m1.1.1.3.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="algx2.l4.m1.1b"><apply id="algx2.l4.m1.1.1.cmml" xref="algx2.l4.m1.1.1"><in id="algx2.l4.m1.1.1.1.cmml" xref="algx2.l4.m1.1.1.1"></in><ci id="algx2.l4.m1.1.1.2.cmml" xref="algx2.l4.m1.1.1.2">𝑒</ci><ci id="algx2.l4.m1.1.1.3.cmml" xref="algx2.l4.m1.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l4.m1.1c">e\in\mathcal{E}</annotation></semantics></math> <span id="algx2.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="algx2.l5" class="ltx_listingline">              <math id="algx2.l5.m1.2" class="ltx_Math" alttext="\nabla^{\wedge}F_{e},C_{e}\leftarrow" display="inline"><semantics id="algx2.l5.m1.2a"><mrow id="algx2.l5.m1.2.2" xref="algx2.l5.m1.2.2.cmml"><mrow id="algx2.l5.m1.2.2.2.2" xref="algx2.l5.m1.2.2.2.3.cmml"><mrow id="algx2.l5.m1.1.1.1.1.1" xref="algx2.l5.m1.1.1.1.1.1.cmml"><msup id="algx2.l5.m1.1.1.1.1.1.1" xref="algx2.l5.m1.1.1.1.1.1.1.cmml"><mo id="algx2.l5.m1.1.1.1.1.1.1.2" xref="algx2.l5.m1.1.1.1.1.1.1.2.cmml">∇</mo><mo id="algx2.l5.m1.1.1.1.1.1.1.3" xref="algx2.l5.m1.1.1.1.1.1.1.3.cmml">∧</mo></msup><msub id="algx2.l5.m1.1.1.1.1.1.2" xref="algx2.l5.m1.1.1.1.1.1.2.cmml"><mi id="algx2.l5.m1.1.1.1.1.1.2.2" xref="algx2.l5.m1.1.1.1.1.1.2.2.cmml">F</mi><mi id="algx2.l5.m1.1.1.1.1.1.2.3" xref="algx2.l5.m1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo id="algx2.l5.m1.2.2.2.2.3" xref="algx2.l5.m1.2.2.2.3.cmml">,</mo><msub id="algx2.l5.m1.2.2.2.2.2" xref="algx2.l5.m1.2.2.2.2.2.cmml"><mi id="algx2.l5.m1.2.2.2.2.2.2" xref="algx2.l5.m1.2.2.2.2.2.2.cmml">C</mi><mi id="algx2.l5.m1.2.2.2.2.2.3" xref="algx2.l5.m1.2.2.2.2.2.3.cmml">e</mi></msub></mrow><mo stretchy="false" id="algx2.l5.m1.2.2.3" xref="algx2.l5.m1.2.2.3.cmml">←</mo><mi id="algx2.l5.m1.2.2.4" xref="algx2.l5.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algx2.l5.m1.2b"><apply id="algx2.l5.m1.2.2.cmml" xref="algx2.l5.m1.2.2"><ci id="algx2.l5.m1.2.2.3.cmml" xref="algx2.l5.m1.2.2.3">←</ci><list id="algx2.l5.m1.2.2.2.3.cmml" xref="algx2.l5.m1.2.2.2.2"><apply id="algx2.l5.m1.1.1.1.1.1.cmml" xref="algx2.l5.m1.1.1.1.1.1"><apply id="algx2.l5.m1.1.1.1.1.1.1.cmml" xref="algx2.l5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l5.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l5.m1.1.1.1.1.1.1">superscript</csymbol><ci id="algx2.l5.m1.1.1.1.1.1.1.2.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.2">∇</ci><and id="algx2.l5.m1.1.1.1.1.1.1.3.cmml" xref="algx2.l5.m1.1.1.1.1.1.1.3"></and></apply><apply id="algx2.l5.m1.1.1.1.1.1.2.cmml" xref="algx2.l5.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algx2.l5.m1.1.1.1.1.1.2.1.cmml" xref="algx2.l5.m1.1.1.1.1.1.2">subscript</csymbol><ci id="algx2.l5.m1.1.1.1.1.1.2.2.cmml" xref="algx2.l5.m1.1.1.1.1.1.2.2">𝐹</ci><ci id="algx2.l5.m1.1.1.1.1.1.2.3.cmml" xref="algx2.l5.m1.1.1.1.1.1.2.3">𝑒</ci></apply></apply><apply id="algx2.l5.m1.2.2.2.2.2.cmml" xref="algx2.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l5.m1.2.2.2.2.2.1.cmml" xref="algx2.l5.m1.2.2.2.2.2">subscript</csymbol><ci id="algx2.l5.m1.2.2.2.2.2.2.cmml" xref="algx2.l5.m1.2.2.2.2.2.2">𝐶</ci><ci id="algx2.l5.m1.2.2.2.2.2.3.cmml" xref="algx2.l5.m1.2.2.2.2.2.3">𝑒</ci></apply></list><csymbol cd="latexml" id="algx2.l5.m1.2.2.4.cmml" xref="algx2.l5.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l5.m1.2c">\nabla^{\wedge}F_{e},C_{e}\leftarrow</annotation></semantics></math> ClientUpdates(<math id="algx2.l5.m2.1" class="ltx_Math" alttext="e" display="inline"><semantics id="algx2.l5.m2.1a"><mi id="algx2.l5.m2.1.1" xref="algx2.l5.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="algx2.l5.m2.1b"><ci id="algx2.l5.m2.1.1.cmml" xref="algx2.l5.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l5.m2.1c">e</annotation></semantics></math>, <math id="algx2.l5.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="algx2.l5.m3.1a"><mi id="algx2.l5.m3.1.1" xref="algx2.l5.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="algx2.l5.m3.1b"><ci id="algx2.l5.m3.1.1.cmml" xref="algx2.l5.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l5.m3.1c">w</annotation></semantics></math>)

</div>
<div id="algx2.l6" class="ltx_listingline">         <span id="algx2.l6.1" class="ltx_text ltx_font_bold">end</span> <span id="algx2.l6.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="algx2.l7" class="ltx_listingline">         <math id="algx2.l7.m1.2" class="ltx_Math" alttext="\nabla F\leftarrow arithmean(\nabla^{\wedge}F_{e},e\in\mathcal{E})" display="inline"><semantics id="algx2.l7.m1.2a"><mrow id="algx2.l7.m1.2.2" xref="algx2.l7.m1.2.2.cmml"><mrow id="algx2.l7.m1.2.2.3" xref="algx2.l7.m1.2.2.3.cmml"><mo rspace="0.167em" id="algx2.l7.m1.2.2.3.1" xref="algx2.l7.m1.2.2.3.1.cmml">∇</mo><mi id="algx2.l7.m1.2.2.3.2" xref="algx2.l7.m1.2.2.3.2.cmml">F</mi></mrow><mo stretchy="false" id="algx2.l7.m1.2.2.2" xref="algx2.l7.m1.2.2.2.cmml">←</mo><mrow id="algx2.l7.m1.2.2.1" xref="algx2.l7.m1.2.2.1.cmml"><mi id="algx2.l7.m1.2.2.1.3" xref="algx2.l7.m1.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mi id="algx2.l7.m1.2.2.1.4" xref="algx2.l7.m1.2.2.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2a" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mi id="algx2.l7.m1.2.2.1.5" xref="algx2.l7.m1.2.2.1.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2b" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mi id="algx2.l7.m1.2.2.1.6" xref="algx2.l7.m1.2.2.1.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2c" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mi id="algx2.l7.m1.2.2.1.7" xref="algx2.l7.m1.2.2.1.7.cmml">h</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2d" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mi id="algx2.l7.m1.2.2.1.8" xref="algx2.l7.m1.2.2.1.8.cmml">m</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2e" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mi id="algx2.l7.m1.2.2.1.9" xref="algx2.l7.m1.2.2.1.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2f" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mi id="algx2.l7.m1.2.2.1.10" xref="algx2.l7.m1.2.2.1.10.cmml">a</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2g" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mi id="algx2.l7.m1.2.2.1.11" xref="algx2.l7.m1.2.2.1.11.cmml">n</mi><mo lspace="0em" rspace="0em" id="algx2.l7.m1.2.2.1.2h" xref="algx2.l7.m1.2.2.1.2.cmml">​</mo><mrow id="algx2.l7.m1.2.2.1.1.1" xref="algx2.l7.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="algx2.l7.m1.2.2.1.1.1.2" xref="algx2.l7.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="algx2.l7.m1.2.2.1.1.1.1" xref="algx2.l7.m1.2.2.1.1.1.1.cmml"><mrow id="algx2.l7.m1.2.2.1.1.1.1.1.1" xref="algx2.l7.m1.2.2.1.1.1.1.1.2.cmml"><mrow id="algx2.l7.m1.2.2.1.1.1.1.1.1.1" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.cmml"><msup id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.2" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">∇</mo><mo id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.3" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">∧</mo></msup><msub id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.2" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.2.cmml">F</mi><mi id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.3" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">e</mi></msub></mrow><mo id="algx2.l7.m1.2.2.1.1.1.1.1.1.2" xref="algx2.l7.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="algx2.l7.m1.1.1" xref="algx2.l7.m1.1.1.cmml">e</mi></mrow><mo id="algx2.l7.m1.2.2.1.1.1.1.2" xref="algx2.l7.m1.2.2.1.1.1.1.2.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="algx2.l7.m1.2.2.1.1.1.1.3" xref="algx2.l7.m1.2.2.1.1.1.1.3.cmml">ℰ</mi></mrow><mo stretchy="false" id="algx2.l7.m1.2.2.1.1.1.3" xref="algx2.l7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l7.m1.2b"><apply id="algx2.l7.m1.2.2.cmml" xref="algx2.l7.m1.2.2"><ci id="algx2.l7.m1.2.2.2.cmml" xref="algx2.l7.m1.2.2.2">←</ci><apply id="algx2.l7.m1.2.2.3.cmml" xref="algx2.l7.m1.2.2.3"><ci id="algx2.l7.m1.2.2.3.1.cmml" xref="algx2.l7.m1.2.2.3.1">∇</ci><ci id="algx2.l7.m1.2.2.3.2.cmml" xref="algx2.l7.m1.2.2.3.2">𝐹</ci></apply><apply id="algx2.l7.m1.2.2.1.cmml" xref="algx2.l7.m1.2.2.1"><times id="algx2.l7.m1.2.2.1.2.cmml" xref="algx2.l7.m1.2.2.1.2"></times><ci id="algx2.l7.m1.2.2.1.3.cmml" xref="algx2.l7.m1.2.2.1.3">𝑎</ci><ci id="algx2.l7.m1.2.2.1.4.cmml" xref="algx2.l7.m1.2.2.1.4">𝑟</ci><ci id="algx2.l7.m1.2.2.1.5.cmml" xref="algx2.l7.m1.2.2.1.5">𝑖</ci><ci id="algx2.l7.m1.2.2.1.6.cmml" xref="algx2.l7.m1.2.2.1.6">𝑡</ci><ci id="algx2.l7.m1.2.2.1.7.cmml" xref="algx2.l7.m1.2.2.1.7">ℎ</ci><ci id="algx2.l7.m1.2.2.1.8.cmml" xref="algx2.l7.m1.2.2.1.8">𝑚</ci><ci id="algx2.l7.m1.2.2.1.9.cmml" xref="algx2.l7.m1.2.2.1.9">𝑒</ci><ci id="algx2.l7.m1.2.2.1.10.cmml" xref="algx2.l7.m1.2.2.1.10">𝑎</ci><ci id="algx2.l7.m1.2.2.1.11.cmml" xref="algx2.l7.m1.2.2.1.11">𝑛</ci><apply id="algx2.l7.m1.2.2.1.1.1.1.cmml" xref="algx2.l7.m1.2.2.1.1.1"><in id="algx2.l7.m1.2.2.1.1.1.1.2.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.2"></in><list id="algx2.l7.m1.2.2.1.1.1.1.1.2.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1"><apply id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1"><apply id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.2">∇</ci><and id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.1.3"></and></apply><apply id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.2">𝐹</ci><ci id="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.1.1.1.2.3">𝑒</ci></apply></apply><ci id="algx2.l7.m1.1.1.cmml" xref="algx2.l7.m1.1.1">𝑒</ci></list><ci id="algx2.l7.m1.2.2.1.1.1.1.3.cmml" xref="algx2.l7.m1.2.2.1.1.1.1.3">ℰ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l7.m1.2c">\nabla F\leftarrow arithmean(\nabla^{\wedge}F_{e},e\in\mathcal{E})</annotation></semantics></math>

</div>
<div id="algx2.l8" class="ltx_listingline">         <math id="algx2.l8.m1.1" class="ltx_math_unparsed" alttext="L_{Fishr}\leftarrow\frac{1}{\mathcal{E}}\sum_{e\in\mathcal{E}}\|C_{e}-\overset{-}{C}\rVert^{2}" display="inline"><semantics id="algx2.l8.m1.1a"><mrow id="algx2.l8.m1.1b"><msub id="algx2.l8.m1.1.1"><mi id="algx2.l8.m1.1.1.2">L</mi><mrow id="algx2.l8.m1.1.1.3"><mi id="algx2.l8.m1.1.1.3.2">F</mi><mo lspace="0em" rspace="0em" id="algx2.l8.m1.1.1.3.1">​</mo><mi id="algx2.l8.m1.1.1.3.3">i</mi><mo lspace="0em" rspace="0em" id="algx2.l8.m1.1.1.3.1a">​</mo><mi id="algx2.l8.m1.1.1.3.4">s</mi><mo lspace="0em" rspace="0em" id="algx2.l8.m1.1.1.3.1b">​</mo><mi id="algx2.l8.m1.1.1.3.5">h</mi><mo lspace="0em" rspace="0em" id="algx2.l8.m1.1.1.3.1c">​</mo><mi id="algx2.l8.m1.1.1.3.6">r</mi></mrow></msub><mo stretchy="false" id="algx2.l8.m1.1.2">←</mo><mfrac id="algx2.l8.m1.1.3"><mn id="algx2.l8.m1.1.3.2">1</mn><mi class="ltx_font_mathcaligraphic" id="algx2.l8.m1.1.3.3">ℰ</mi></mfrac><msub id="algx2.l8.m1.1.4"><mo rspace="0em" id="algx2.l8.m1.1.4.2">∑</mo><mrow id="algx2.l8.m1.1.4.3"><mi id="algx2.l8.m1.1.4.3.2">e</mi><mo id="algx2.l8.m1.1.4.3.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="algx2.l8.m1.1.4.3.3">ℰ</mi></mrow></msub><mo lspace="0em" rspace="0.167em" id="algx2.l8.m1.1.5">∥</mo><msub id="algx2.l8.m1.1.6"><mi id="algx2.l8.m1.1.6.2">C</mi><mi id="algx2.l8.m1.1.6.3">e</mi></msub><mo id="algx2.l8.m1.1.7">−</mo><mover accent="true" id="algx2.l8.m1.1.8"><mi id="algx2.l8.m1.1.8.2">C</mi><mo id="algx2.l8.m1.1.8.1">-</mo></mover><mo fence="true" lspace="0em" rspace="0em" id="algx2.l8.m1.1.9">∥</mo><msup id="algx2.l8.m1.1.10"><mi id="algx2.l8.m1.1.10a"></mi><mn id="algx2.l8.m1.1.10.1">2</mn></msup></mrow><annotation encoding="application/x-tex" id="algx2.l8.m1.1c">L_{Fishr}\leftarrow\frac{1}{\mathcal{E}}\sum_{e\in\mathcal{E}}\|C_{e}-\overset{-}{C}\rVert^{2}</annotation></semantics></math> <span id="algx2.l8.1" class="ltx_text" style="float:right;"><math id="algx2.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algx2.l8.1.m1.1a"><mo id="algx2.l8.1.m1.1.1" xref="algx2.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx2.l8.1.m1.1b"><ci id="algx2.l8.1.m1.1.1.cmml" xref="algx2.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l8.1.m1.1c">\triangleright</annotation></semantics></math> Fishr loss
</span>
</div>
<div id="algx2.l9" class="ltx_listingline">         <math id="algx2.l9.m1.1" class="ltx_Math" alttext="w\leftarrow w-\eta\left(\nabla F+\lambda\nabla L_{Fishr}\right)" display="inline"><semantics id="algx2.l9.m1.1a"><mrow id="algx2.l9.m1.1.1" xref="algx2.l9.m1.1.1.cmml"><mi id="algx2.l9.m1.1.1.3" xref="algx2.l9.m1.1.1.3.cmml">w</mi><mo stretchy="false" id="algx2.l9.m1.1.1.2" xref="algx2.l9.m1.1.1.2.cmml">←</mo><mrow id="algx2.l9.m1.1.1.1" xref="algx2.l9.m1.1.1.1.cmml"><mi id="algx2.l9.m1.1.1.1.3" xref="algx2.l9.m1.1.1.1.3.cmml">w</mi><mo id="algx2.l9.m1.1.1.1.2" xref="algx2.l9.m1.1.1.1.2.cmml">−</mo><mrow id="algx2.l9.m1.1.1.1.1" xref="algx2.l9.m1.1.1.1.1.cmml"><mi id="algx2.l9.m1.1.1.1.1.3" xref="algx2.l9.m1.1.1.1.1.3.cmml">η</mi><mo lspace="0em" rspace="0em" id="algx2.l9.m1.1.1.1.1.2" xref="algx2.l9.m1.1.1.1.1.2.cmml">​</mo><mrow id="algx2.l9.m1.1.1.1.1.1.1" xref="algx2.l9.m1.1.1.1.1.1.1.1.cmml"><mo id="algx2.l9.m1.1.1.1.1.1.1.2" xref="algx2.l9.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx2.l9.m1.1.1.1.1.1.1.1" xref="algx2.l9.m1.1.1.1.1.1.1.1.cmml"><mrow id="algx2.l9.m1.1.1.1.1.1.1.1.2" xref="algx2.l9.m1.1.1.1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="algx2.l9.m1.1.1.1.1.1.1.1.2.1" xref="algx2.l9.m1.1.1.1.1.1.1.1.2.1.cmml">∇</mo><mi id="algx2.l9.m1.1.1.1.1.1.1.1.2.2" xref="algx2.l9.m1.1.1.1.1.1.1.1.2.2.cmml">F</mi></mrow><mo id="algx2.l9.m1.1.1.1.1.1.1.1.1" xref="algx2.l9.m1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="algx2.l9.m1.1.1.1.1.1.1.1.3" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.cmml"><mi id="algx2.l9.m1.1.1.1.1.1.1.1.3.2" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mo lspace="0.167em" rspace="0em" id="algx2.l9.m1.1.1.1.1.1.1.1.3.1" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mrow id="algx2.l9.m1.1.1.1.1.1.1.1.3.3" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.cmml"><mo rspace="0.167em" id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.1" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.1.cmml">∇</mo><msub id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.2" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.2.cmml">L</mi><mrow id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.2" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.3" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1a" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.4" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1b" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.5" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.5.cmml">h</mi><mo lspace="0em" rspace="0em" id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1c" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.6" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.6.cmml">r</mi></mrow></msub></mrow></mrow></mrow><mo id="algx2.l9.m1.1.1.1.1.1.1.3" xref="algx2.l9.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l9.m1.1b"><apply id="algx2.l9.m1.1.1.cmml" xref="algx2.l9.m1.1.1"><ci id="algx2.l9.m1.1.1.2.cmml" xref="algx2.l9.m1.1.1.2">←</ci><ci id="algx2.l9.m1.1.1.3.cmml" xref="algx2.l9.m1.1.1.3">𝑤</ci><apply id="algx2.l9.m1.1.1.1.cmml" xref="algx2.l9.m1.1.1.1"><minus id="algx2.l9.m1.1.1.1.2.cmml" xref="algx2.l9.m1.1.1.1.2"></minus><ci id="algx2.l9.m1.1.1.1.3.cmml" xref="algx2.l9.m1.1.1.1.3">𝑤</ci><apply id="algx2.l9.m1.1.1.1.1.cmml" xref="algx2.l9.m1.1.1.1.1"><times id="algx2.l9.m1.1.1.1.1.2.cmml" xref="algx2.l9.m1.1.1.1.1.2"></times><ci id="algx2.l9.m1.1.1.1.1.3.cmml" xref="algx2.l9.m1.1.1.1.1.3">𝜂</ci><apply id="algx2.l9.m1.1.1.1.1.1.1.1.cmml" xref="algx2.l9.m1.1.1.1.1.1.1"><plus id="algx2.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.1"></plus><apply id="algx2.l9.m1.1.1.1.1.1.1.1.2.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.2"><ci id="algx2.l9.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.2.1">∇</ci><ci id="algx2.l9.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.2.2">𝐹</ci></apply><apply id="algx2.l9.m1.1.1.1.1.1.1.1.3.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3"><times id="algx2.l9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.1"></times><ci id="algx2.l9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.2">𝜆</ci><apply id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3"><ci id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.1">∇</ci><apply id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.2">𝐿</ci><apply id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3"><times id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.1"></times><ci id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.2">𝐹</ci><ci id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.3.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.3">𝑖</ci><ci id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.4.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.4">𝑠</ci><ci id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.5.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.5">ℎ</ci><ci id="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.6.cmml" xref="algx2.l9.m1.1.1.1.1.1.1.1.3.3.2.3.6">𝑟</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l9.m1.1c">w\leftarrow w-\eta\left(\nabla F+\lambda\nabla L_{Fishr}\right)</annotation></semantics></math>

</div>
<div id="algx2.l10" class="ltx_listingline">     <span id="algx2.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="algx2.l10.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="algx2.l11" class="ltx_listingline">
<span id="algx2.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="algx2.l11.2" class="ltx_text ltx_font_bold">function</span>
</div>
<div id="algx2.l12" class="ltx_listingline">
</div>
<div id="algx2.l13" class="ltx_listingline">
<span id="algx2.l13.1" class="ltx_text ltx_font_bold">function</span> <span id="algx2.l13.2" class="ltx_text ltx_font_smallcaps">ClientUpdates</span>(<math id="algx2.l13.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="algx2.l13.m1.1a"><mi id="algx2.l13.m1.1.1" xref="algx2.l13.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="algx2.l13.m1.1b"><ci id="algx2.l13.m1.1.1.cmml" xref="algx2.l13.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l13.m1.1c">e</annotation></semantics></math>, <math id="algx2.l13.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="algx2.l13.m2.1a"><mi id="algx2.l13.m2.1.1" xref="algx2.l13.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="algx2.l13.m2.1b"><ci id="algx2.l13.m2.1.1.cmml" xref="algx2.l13.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l13.m2.1c">w</annotation></semantics></math>)

</div>
<div id="algx2.l14" class="ltx_listingline">     <span id="algx2.l14.1" class="ltx_text ltx_font_bold">for</span> each data example <math id="algx2.l14.m1.2" class="ltx_Math" alttext="\left(x_{e}^{i},y_{e}^{i}\right)\in\mathcal{D}_{e}" display="inline"><semantics id="algx2.l14.m1.2a"><mrow id="algx2.l14.m1.2.2" xref="algx2.l14.m1.2.2.cmml"><mrow id="algx2.l14.m1.2.2.2.2" xref="algx2.l14.m1.2.2.2.3.cmml"><mo id="algx2.l14.m1.2.2.2.2.3" xref="algx2.l14.m1.2.2.2.3.cmml">(</mo><msubsup id="algx2.l14.m1.1.1.1.1.1" xref="algx2.l14.m1.1.1.1.1.1.cmml"><mi id="algx2.l14.m1.1.1.1.1.1.2.2" xref="algx2.l14.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="algx2.l14.m1.1.1.1.1.1.2.3" xref="algx2.l14.m1.1.1.1.1.1.2.3.cmml">e</mi><mi id="algx2.l14.m1.1.1.1.1.1.3" xref="algx2.l14.m1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="algx2.l14.m1.2.2.2.2.4" xref="algx2.l14.m1.2.2.2.3.cmml">,</mo><msubsup id="algx2.l14.m1.2.2.2.2.2" xref="algx2.l14.m1.2.2.2.2.2.cmml"><mi id="algx2.l14.m1.2.2.2.2.2.2.2" xref="algx2.l14.m1.2.2.2.2.2.2.2.cmml">y</mi><mi id="algx2.l14.m1.2.2.2.2.2.2.3" xref="algx2.l14.m1.2.2.2.2.2.2.3.cmml">e</mi><mi id="algx2.l14.m1.2.2.2.2.2.3" xref="algx2.l14.m1.2.2.2.2.2.3.cmml">i</mi></msubsup><mo id="algx2.l14.m1.2.2.2.2.5" xref="algx2.l14.m1.2.2.2.3.cmml">)</mo></mrow><mo id="algx2.l14.m1.2.2.3" xref="algx2.l14.m1.2.2.3.cmml">∈</mo><msub id="algx2.l14.m1.2.2.4" xref="algx2.l14.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="algx2.l14.m1.2.2.4.2" xref="algx2.l14.m1.2.2.4.2.cmml">𝒟</mi><mi id="algx2.l14.m1.2.2.4.3" xref="algx2.l14.m1.2.2.4.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx2.l14.m1.2b"><apply id="algx2.l14.m1.2.2.cmml" xref="algx2.l14.m1.2.2"><in id="algx2.l14.m1.2.2.3.cmml" xref="algx2.l14.m1.2.2.3"></in><interval closure="open" id="algx2.l14.m1.2.2.2.3.cmml" xref="algx2.l14.m1.2.2.2.2"><apply id="algx2.l14.m1.1.1.1.1.1.cmml" xref="algx2.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l14.m1.1.1.1.1.1.1.cmml" xref="algx2.l14.m1.1.1.1.1.1">superscript</csymbol><apply id="algx2.l14.m1.1.1.1.1.1.2.cmml" xref="algx2.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algx2.l14.m1.1.1.1.1.1.2.1.cmml" xref="algx2.l14.m1.1.1.1.1.1">subscript</csymbol><ci id="algx2.l14.m1.1.1.1.1.1.2.2.cmml" xref="algx2.l14.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="algx2.l14.m1.1.1.1.1.1.2.3.cmml" xref="algx2.l14.m1.1.1.1.1.1.2.3">𝑒</ci></apply><ci id="algx2.l14.m1.1.1.1.1.1.3.cmml" xref="algx2.l14.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="algx2.l14.m1.2.2.2.2.2.cmml" xref="algx2.l14.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l14.m1.2.2.2.2.2.1.cmml" xref="algx2.l14.m1.2.2.2.2.2">superscript</csymbol><apply id="algx2.l14.m1.2.2.2.2.2.2.cmml" xref="algx2.l14.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l14.m1.2.2.2.2.2.2.1.cmml" xref="algx2.l14.m1.2.2.2.2.2">subscript</csymbol><ci id="algx2.l14.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.2">𝑦</ci><ci id="algx2.l14.m1.2.2.2.2.2.2.3.cmml" xref="algx2.l14.m1.2.2.2.2.2.2.3">𝑒</ci></apply><ci id="algx2.l14.m1.2.2.2.2.2.3.cmml" xref="algx2.l14.m1.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="algx2.l14.m1.2.2.4.cmml" xref="algx2.l14.m1.2.2.4"><csymbol cd="ambiguous" id="algx2.l14.m1.2.2.4.1.cmml" xref="algx2.l14.m1.2.2.4">subscript</csymbol><ci id="algx2.l14.m1.2.2.4.2.cmml" xref="algx2.l14.m1.2.2.4.2">𝒟</ci><ci id="algx2.l14.m1.2.2.4.3.cmml" xref="algx2.l14.m1.2.2.4.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l14.m1.2c">\left(x_{e}^{i},y_{e}^{i}\right)\in\mathcal{D}_{e}</annotation></semantics></math> <span id="algx2.l14.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="algx2.l15" class="ltx_listingline">         <math id="algx2.l15.m1.1" class="ltx_Math" alttext="\nabla F_{e}^{i}\leftarrow" display="inline"><semantics id="algx2.l15.m1.1a"><mrow id="algx2.l15.m1.1.1" xref="algx2.l15.m1.1.1.cmml"><mrow id="algx2.l15.m1.1.1.2" xref="algx2.l15.m1.1.1.2.cmml"><mo rspace="0.167em" id="algx2.l15.m1.1.1.2.1" xref="algx2.l15.m1.1.1.2.1.cmml">∇</mo><msubsup id="algx2.l15.m1.1.1.2.2" xref="algx2.l15.m1.1.1.2.2.cmml"><mi id="algx2.l15.m1.1.1.2.2.2.2" xref="algx2.l15.m1.1.1.2.2.2.2.cmml">F</mi><mi id="algx2.l15.m1.1.1.2.2.2.3" xref="algx2.l15.m1.1.1.2.2.2.3.cmml">e</mi><mi id="algx2.l15.m1.1.1.2.2.3" xref="algx2.l15.m1.1.1.2.2.3.cmml">i</mi></msubsup></mrow><mo stretchy="false" id="algx2.l15.m1.1.1.1" xref="algx2.l15.m1.1.1.1.cmml">←</mo><mi id="algx2.l15.m1.1.1.3" xref="algx2.l15.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algx2.l15.m1.1b"><apply id="algx2.l15.m1.1.1.cmml" xref="algx2.l15.m1.1.1"><ci id="algx2.l15.m1.1.1.1.cmml" xref="algx2.l15.m1.1.1.1">←</ci><apply id="algx2.l15.m1.1.1.2.cmml" xref="algx2.l15.m1.1.1.2"><ci id="algx2.l15.m1.1.1.2.1.cmml" xref="algx2.l15.m1.1.1.2.1">∇</ci><apply id="algx2.l15.m1.1.1.2.2.cmml" xref="algx2.l15.m1.1.1.2.2"><csymbol cd="ambiguous" id="algx2.l15.m1.1.1.2.2.1.cmml" xref="algx2.l15.m1.1.1.2.2">superscript</csymbol><apply id="algx2.l15.m1.1.1.2.2.2.cmml" xref="algx2.l15.m1.1.1.2.2"><csymbol cd="ambiguous" id="algx2.l15.m1.1.1.2.2.2.1.cmml" xref="algx2.l15.m1.1.1.2.2">subscript</csymbol><ci id="algx2.l15.m1.1.1.2.2.2.2.cmml" xref="algx2.l15.m1.1.1.2.2.2.2">𝐹</ci><ci id="algx2.l15.m1.1.1.2.2.2.3.cmml" xref="algx2.l15.m1.1.1.2.2.2.3">𝑒</ci></apply><ci id="algx2.l15.m1.1.1.2.2.3.cmml" xref="algx2.l15.m1.1.1.2.2.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="algx2.l15.m1.1.1.3.cmml" xref="algx2.l15.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l15.m1.1c">\nabla F_{e}^{i}\leftarrow</annotation></semantics></math> backwards(<math id="algx2.l15.m2.1" class="ltx_Math" alttext="F_{e}^{i}" display="inline"><semantics id="algx2.l15.m2.1a"><msubsup id="algx2.l15.m2.1.1" xref="algx2.l15.m2.1.1.cmml"><mi id="algx2.l15.m2.1.1.2.2" xref="algx2.l15.m2.1.1.2.2.cmml">F</mi><mi id="algx2.l15.m2.1.1.2.3" xref="algx2.l15.m2.1.1.2.3.cmml">e</mi><mi id="algx2.l15.m2.1.1.3" xref="algx2.l15.m2.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="algx2.l15.m2.1b"><apply id="algx2.l15.m2.1.1.cmml" xref="algx2.l15.m2.1.1"><csymbol cd="ambiguous" id="algx2.l15.m2.1.1.1.cmml" xref="algx2.l15.m2.1.1">superscript</csymbol><apply id="algx2.l15.m2.1.1.2.cmml" xref="algx2.l15.m2.1.1"><csymbol cd="ambiguous" id="algx2.l15.m2.1.1.2.1.cmml" xref="algx2.l15.m2.1.1">subscript</csymbol><ci id="algx2.l15.m2.1.1.2.2.cmml" xref="algx2.l15.m2.1.1.2.2">𝐹</ci><ci id="algx2.l15.m2.1.1.2.3.cmml" xref="algx2.l15.m2.1.1.2.3">𝑒</ci></apply><ci id="algx2.l15.m2.1.1.3.cmml" xref="algx2.l15.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l15.m2.1c">F_{e}^{i}</annotation></semantics></math>, <math id="algx2.l15.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="algx2.l15.m3.1a"><mi id="algx2.l15.m3.1.1" xref="algx2.l15.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="algx2.l15.m3.1b"><ci id="algx2.l15.m3.1.1.cmml" xref="algx2.l15.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l15.m3.1c">w</annotation></semantics></math>)

</div>
<div id="algx2.l16" class="ltx_listingline">     <span id="algx2.l16.1" class="ltx_text ltx_font_bold">end</span> <span id="algx2.l16.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="algx2.l17" class="ltx_listingline">     <math id="algx2.l17.m1.4" class="ltx_math_unparsed" alttext="G_{e,k}\leftarrow\{[\nabla F_{e}^{i}]_{k},i\in n_{e}\},k\in[0..n-1]" display="inline"><semantics id="algx2.l17.m1.4a"><mrow id="algx2.l17.m1.4b"><msub id="algx2.l17.m1.4.5"><mi id="algx2.l17.m1.4.5.2">G</mi><mrow id="algx2.l17.m1.2.2.2.4"><mi id="algx2.l17.m1.1.1.1.1">e</mi><mo id="algx2.l17.m1.2.2.2.4.1">,</mo><mi id="algx2.l17.m1.2.2.2.2">k</mi></mrow></msub><mo stretchy="false" id="algx2.l17.m1.4.6">←</mo><mrow id="algx2.l17.m1.4.7"><mo stretchy="false" id="algx2.l17.m1.4.7.1">{</mo><msub id="algx2.l17.m1.4.7.2"><mrow id="algx2.l17.m1.4.7.2.2"><mo stretchy="false" id="algx2.l17.m1.4.7.2.2.1">[</mo><mo rspace="0.167em" id="algx2.l17.m1.4.7.2.2.2">∇</mo><msubsup id="algx2.l17.m1.4.7.2.2.3"><mi id="algx2.l17.m1.4.7.2.2.3.2.2">F</mi><mi id="algx2.l17.m1.4.7.2.2.3.2.3">e</mi><mi id="algx2.l17.m1.4.7.2.2.3.3">i</mi></msubsup><mo stretchy="false" id="algx2.l17.m1.4.7.2.2.4">]</mo></mrow><mi id="algx2.l17.m1.4.7.2.3">k</mi></msub><mo id="algx2.l17.m1.4.7.3">,</mo><mi id="algx2.l17.m1.3.3">i</mi><mo id="algx2.l17.m1.4.7.4">∈</mo><msub id="algx2.l17.m1.4.7.5"><mi id="algx2.l17.m1.4.7.5.2">n</mi><mi id="algx2.l17.m1.4.7.5.3">e</mi></msub><mo stretchy="false" id="algx2.l17.m1.4.7.6">}</mo></mrow><mo id="algx2.l17.m1.4.8">,</mo><mi id="algx2.l17.m1.4.4">k</mi><mo id="algx2.l17.m1.4.9">∈</mo><mrow id="algx2.l17.m1.4.10"><mo stretchy="false" id="algx2.l17.m1.4.10.1">[</mo><mn id="algx2.l17.m1.4.10.2">0</mn><mo lspace="0em" rspace="0.0835em" id="algx2.l17.m1.4.10.3">.</mo><mo lspace="0.0835em" rspace="0.167em" id="algx2.l17.m1.4.10.4">.</mo><mi id="algx2.l17.m1.4.10.5">n</mi><mo id="algx2.l17.m1.4.10.6">−</mo><mn id="algx2.l17.m1.4.10.7">1</mn><mo stretchy="false" id="algx2.l17.m1.4.10.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algx2.l17.m1.4c">G_{e,k}\leftarrow\{[\nabla F_{e}^{i}]_{k},i\in n_{e}\},k\in[0..n-1]</annotation></semantics></math>

</div>
<div id="algx2.l18" class="ltx_listingline">     <math id="algx2.l18.m1.3" class="ltx_math_unparsed" alttext="[\nabla^{\wedge}F_{e}]_{k}\leftarrow weightedgeo(G_{e,k}),k\in[0..n-1]" display="inline"><semantics id="algx2.l18.m1.3a"><mrow id="algx2.l18.m1.3b"><msub id="algx2.l18.m1.3.4"><mrow id="algx2.l18.m1.3.4.2"><mo stretchy="false" id="algx2.l18.m1.3.4.2.1">[</mo><msup id="algx2.l18.m1.3.4.2.2"><mo rspace="0.167em" id="algx2.l18.m1.3.4.2.2.2">∇</mo><mo id="algx2.l18.m1.3.4.2.2.3">∧</mo></msup><msub id="algx2.l18.m1.3.4.2.3"><mi id="algx2.l18.m1.3.4.2.3.2">F</mi><mi id="algx2.l18.m1.3.4.2.3.3">e</mi></msub><mo stretchy="false" id="algx2.l18.m1.3.4.2.4">]</mo></mrow><mi id="algx2.l18.m1.3.4.3">k</mi></msub><mo stretchy="false" id="algx2.l18.m1.3.5">←</mo><mi id="algx2.l18.m1.3.6">w</mi><mi id="algx2.l18.m1.3.7">e</mi><mi id="algx2.l18.m1.3.8">i</mi><mi id="algx2.l18.m1.3.9">g</mi><mi id="algx2.l18.m1.3.10">h</mi><mi id="algx2.l18.m1.3.11">t</mi><mi id="algx2.l18.m1.3.12">e</mi><mi id="algx2.l18.m1.3.13">d</mi><mi id="algx2.l18.m1.3.14">g</mi><mi id="algx2.l18.m1.3.15">e</mi><mi id="algx2.l18.m1.3.16">o</mi><mrow id="algx2.l18.m1.3.17"><mo stretchy="false" id="algx2.l18.m1.3.17.1">(</mo><msub id="algx2.l18.m1.3.17.2"><mi id="algx2.l18.m1.3.17.2.2">G</mi><mrow id="algx2.l18.m1.2.2.2.4"><mi id="algx2.l18.m1.1.1.1.1">e</mi><mo id="algx2.l18.m1.2.2.2.4.1">,</mo><mi id="algx2.l18.m1.2.2.2.2">k</mi></mrow></msub><mo stretchy="false" id="algx2.l18.m1.3.17.3">)</mo></mrow><mo id="algx2.l18.m1.3.18">,</mo><mi id="algx2.l18.m1.3.3">k</mi><mo id="algx2.l18.m1.3.19">∈</mo><mrow id="algx2.l18.m1.3.20"><mo stretchy="false" id="algx2.l18.m1.3.20.1">[</mo><mn id="algx2.l18.m1.3.20.2">0</mn><mo lspace="0em" rspace="0.0835em" id="algx2.l18.m1.3.20.3">.</mo><mo lspace="0.0835em" rspace="0.167em" id="algx2.l18.m1.3.20.4">.</mo><mi id="algx2.l18.m1.3.20.5">n</mi><mo id="algx2.l18.m1.3.20.6">−</mo><mn id="algx2.l18.m1.3.20.7">1</mn><mo stretchy="false" id="algx2.l18.m1.3.20.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="algx2.l18.m1.3c">[\nabla^{\wedge}F_{e}]_{k}\leftarrow weightedgeo(G_{e,k}),k\in[0..n-1]</annotation></semantics></math> <span id="algx2.l18.1" class="ltx_text" style="float:right;"><math id="algx2.l18.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algx2.l18.1.m1.1a"><mo id="algx2.l18.1.m1.1.1" xref="algx2.l18.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx2.l18.1.m1.1b"><ci id="algx2.l18.1.m1.1.1.cmml" xref="algx2.l18.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l18.1.m1.1c">\triangleright</annotation></semantics></math> Weighted geometric mean
</span>
</div>
<div id="algx2.l19" class="ltx_listingline">     <math id="algx2.l19.m1.2" class="ltx_Math" alttext="C_{e}\leftarrow\frac{1}{n_{e}}\sum_{i=1}^{n_{e}}\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)^{\top}" display="inline"><semantics id="algx2.l19.m1.2a"><mrow id="algx2.l19.m1.2.2" xref="algx2.l19.m1.2.2.cmml"><msub id="algx2.l19.m1.2.2.4" xref="algx2.l19.m1.2.2.4.cmml"><mi id="algx2.l19.m1.2.2.4.2" xref="algx2.l19.m1.2.2.4.2.cmml">C</mi><mi id="algx2.l19.m1.2.2.4.3" xref="algx2.l19.m1.2.2.4.3.cmml">e</mi></msub><mo stretchy="false" id="algx2.l19.m1.2.2.3" xref="algx2.l19.m1.2.2.3.cmml">←</mo><mrow id="algx2.l19.m1.2.2.2" xref="algx2.l19.m1.2.2.2.cmml"><mfrac id="algx2.l19.m1.2.2.2.4" xref="algx2.l19.m1.2.2.2.4.cmml"><mn id="algx2.l19.m1.2.2.2.4.2" xref="algx2.l19.m1.2.2.2.4.2.cmml">1</mn><msub id="algx2.l19.m1.2.2.2.4.3" xref="algx2.l19.m1.2.2.2.4.3.cmml"><mi id="algx2.l19.m1.2.2.2.4.3.2" xref="algx2.l19.m1.2.2.2.4.3.2.cmml">n</mi><mi id="algx2.l19.m1.2.2.2.4.3.3" xref="algx2.l19.m1.2.2.2.4.3.3.cmml">e</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="algx2.l19.m1.2.2.2.3" xref="algx2.l19.m1.2.2.2.3.cmml">​</mo><mrow id="algx2.l19.m1.2.2.2.2" xref="algx2.l19.m1.2.2.2.2.cmml"><msubsup id="algx2.l19.m1.2.2.2.2.3" xref="algx2.l19.m1.2.2.2.2.3.cmml"><mo rspace="0em" id="algx2.l19.m1.2.2.2.2.3.2.2" xref="algx2.l19.m1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="algx2.l19.m1.2.2.2.2.3.2.3" xref="algx2.l19.m1.2.2.2.2.3.2.3.cmml"><mi id="algx2.l19.m1.2.2.2.2.3.2.3.2" xref="algx2.l19.m1.2.2.2.2.3.2.3.2.cmml">i</mi><mo id="algx2.l19.m1.2.2.2.2.3.2.3.1" xref="algx2.l19.m1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="algx2.l19.m1.2.2.2.2.3.2.3.3" xref="algx2.l19.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="algx2.l19.m1.2.2.2.2.3.3" xref="algx2.l19.m1.2.2.2.2.3.3.cmml"><mi id="algx2.l19.m1.2.2.2.2.3.3.2" xref="algx2.l19.m1.2.2.2.2.3.3.2.cmml">n</mi><mi id="algx2.l19.m1.2.2.2.2.3.3.3" xref="algx2.l19.m1.2.2.2.2.3.3.3.cmml">e</mi></msub></msubsup><mrow id="algx2.l19.m1.2.2.2.2.2" xref="algx2.l19.m1.2.2.2.2.2.cmml"><mrow id="algx2.l19.m1.1.1.1.1.1.1.1" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.cmml"><mo id="algx2.l19.m1.1.1.1.1.1.1.1.2" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algx2.l19.m1.1.1.1.1.1.1.1.1" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="algx2.l19.m1.1.1.1.1.1.1.1.1.2" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.cmml"><mo rspace="0.167em" id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.1" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.1.cmml">∇</mo><msubsup id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">F</mi><mi id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">e</mi><mi id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.3" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msubsup></mrow><mo id="algx2.l19.m1.1.1.1.1.1.1.1.1.1" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="algx2.l19.m1.1.1.1.1.1.1.1.1.3" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mo rspace="0.167em" id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.1" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">∇</mo><msub id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.2" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">F</mi><mi id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.3" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml">e</mi></msub></mrow><mo id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.1" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.1.cmml">-</mo></mover></mrow><mo id="algx2.l19.m1.1.1.1.1.1.1.1.3" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="algx2.l19.m1.2.2.2.2.2.3" xref="algx2.l19.m1.2.2.2.2.2.3.cmml">​</mo><msup id="algx2.l19.m1.2.2.2.2.2.2" xref="algx2.l19.m1.2.2.2.2.2.2.cmml"><mrow id="algx2.l19.m1.2.2.2.2.2.2.1.1" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="algx2.l19.m1.2.2.2.2.2.2.1.1.2" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="algx2.l19.m1.2.2.2.2.2.2.1.1.1" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.cmml"><mrow id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.cmml"><mo rspace="0.167em" id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.1" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.1.cmml">∇</mo><msubsup id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.cmml"><mi id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.2" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.2.cmml">F</mi><mi id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.3" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.3.cmml">e</mi><mi id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.3" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.3.cmml">i</mi></msubsup></mrow><mo id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.1" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.cmml"><mrow id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.cmml"><mo rspace="0.167em" id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.1" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml">∇</mo><msub id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml"><mi id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.2" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.2.cmml">F</mi><mi id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.3" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.3.cmml">e</mi></msub></mrow><mo id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.1" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.1.cmml">-</mo></mover></mrow><mo id="algx2.l19.m1.2.2.2.2.2.2.1.1.3" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="algx2.l19.m1.2.2.2.2.2.2.3" xref="algx2.l19.m1.2.2.2.2.2.2.3.cmml">⊤</mo></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l19.m1.2b"><apply id="algx2.l19.m1.2.2.cmml" xref="algx2.l19.m1.2.2"><ci id="algx2.l19.m1.2.2.3.cmml" xref="algx2.l19.m1.2.2.3">←</ci><apply id="algx2.l19.m1.2.2.4.cmml" xref="algx2.l19.m1.2.2.4"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.4.1.cmml" xref="algx2.l19.m1.2.2.4">subscript</csymbol><ci id="algx2.l19.m1.2.2.4.2.cmml" xref="algx2.l19.m1.2.2.4.2">𝐶</ci><ci id="algx2.l19.m1.2.2.4.3.cmml" xref="algx2.l19.m1.2.2.4.3">𝑒</ci></apply><apply id="algx2.l19.m1.2.2.2.cmml" xref="algx2.l19.m1.2.2.2"><times id="algx2.l19.m1.2.2.2.3.cmml" xref="algx2.l19.m1.2.2.2.3"></times><apply id="algx2.l19.m1.2.2.2.4.cmml" xref="algx2.l19.m1.2.2.2.4"><divide id="algx2.l19.m1.2.2.2.4.1.cmml" xref="algx2.l19.m1.2.2.2.4"></divide><cn type="integer" id="algx2.l19.m1.2.2.2.4.2.cmml" xref="algx2.l19.m1.2.2.2.4.2">1</cn><apply id="algx2.l19.m1.2.2.2.4.3.cmml" xref="algx2.l19.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.2.4.3.1.cmml" xref="algx2.l19.m1.2.2.2.4.3">subscript</csymbol><ci id="algx2.l19.m1.2.2.2.4.3.2.cmml" xref="algx2.l19.m1.2.2.2.4.3.2">𝑛</ci><ci id="algx2.l19.m1.2.2.2.4.3.3.cmml" xref="algx2.l19.m1.2.2.2.4.3.3">𝑒</ci></apply></apply><apply id="algx2.l19.m1.2.2.2.2.cmml" xref="algx2.l19.m1.2.2.2.2"><apply id="algx2.l19.m1.2.2.2.2.3.cmml" xref="algx2.l19.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.2.2.3.1.cmml" xref="algx2.l19.m1.2.2.2.2.3">superscript</csymbol><apply id="algx2.l19.m1.2.2.2.2.3.2.cmml" xref="algx2.l19.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.2.2.3.2.1.cmml" xref="algx2.l19.m1.2.2.2.2.3">subscript</csymbol><sum id="algx2.l19.m1.2.2.2.2.3.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.3.2.2"></sum><apply id="algx2.l19.m1.2.2.2.2.3.2.3.cmml" xref="algx2.l19.m1.2.2.2.2.3.2.3"><eq id="algx2.l19.m1.2.2.2.2.3.2.3.1.cmml" xref="algx2.l19.m1.2.2.2.2.3.2.3.1"></eq><ci id="algx2.l19.m1.2.2.2.2.3.2.3.2.cmml" xref="algx2.l19.m1.2.2.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="algx2.l19.m1.2.2.2.2.3.2.3.3.cmml" xref="algx2.l19.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="algx2.l19.m1.2.2.2.2.3.3.cmml" xref="algx2.l19.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.2.2.3.3.1.cmml" xref="algx2.l19.m1.2.2.2.2.3.3">subscript</csymbol><ci id="algx2.l19.m1.2.2.2.2.3.3.2.cmml" xref="algx2.l19.m1.2.2.2.2.3.3.2">𝑛</ci><ci id="algx2.l19.m1.2.2.2.2.3.3.3.cmml" xref="algx2.l19.m1.2.2.2.2.3.3.3">𝑒</ci></apply></apply><apply id="algx2.l19.m1.2.2.2.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.2"><times id="algx2.l19.m1.2.2.2.2.2.3.cmml" xref="algx2.l19.m1.2.2.2.2.2.3"></times><apply id="algx2.l19.m1.1.1.1.1.1.1.1.1.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1"><minus id="algx2.l19.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2"><ci id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.1">∇</ci><apply id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝐹</ci><ci id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.2.3">𝑒</ci></apply><ci id="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3"><minus id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.1"></minus><apply id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2"><ci id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.1">∇</ci><apply id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.2">𝐹</ci><ci id="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="algx2.l19.m1.1.1.1.1.1.1.1.1.3.2.2.3">𝑒</ci></apply></apply></apply></apply><apply id="algx2.l19.m1.2.2.2.2.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.2.2.2.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2">superscript</csymbol><apply id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1"><minus id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.1"></minus><apply id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2"><ci id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.1">∇</ci><apply id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.1.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2">superscript</csymbol><apply id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.1.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2">subscript</csymbol><ci id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.2">𝐹</ci><ci id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.3.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.2.3">𝑒</ci></apply><ci id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.3.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.2.2.3">𝑖</ci></apply></apply><apply id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3"><minus id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.1"></minus><apply id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2"><ci id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.1.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.1">∇</ci><apply id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2"><csymbol cd="ambiguous" id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.1.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2">subscript</csymbol><ci id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.2.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.2">𝐹</ci><ci id="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.3.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.1.1.1.3.2.2.3">𝑒</ci></apply></apply></apply></apply><csymbol cd="latexml" id="algx2.l19.m1.2.2.2.2.2.2.3.cmml" xref="algx2.l19.m1.2.2.2.2.2.2.3">top</csymbol></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l19.m1.2c">C_{e}\leftarrow\frac{1}{n_{e}}\sum_{i=1}^{n_{e}}\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)\left(\nabla F_{e}^{i}-\overset{-}{\nabla F_{e}}\right)^{\top}</annotation></semantics></math> <span id="algx2.l19.1" class="ltx_text" style="float:right;"><math id="algx2.l19.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algx2.l19.1.m1.1a"><mo id="algx2.l19.1.m1.1.1" xref="algx2.l19.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algx2.l19.1.m1.1b"><ci id="algx2.l19.1.m1.1.1.cmml" xref="algx2.l19.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l19.1.m1.1c">\triangleright</annotation></semantics></math> Gradient covariance
</span>
</div>
<div id="algx2.l20" class="ltx_listingline">     <span id="algx2.l20.1" class="ltx_text ltx_font_bold">return</span> <math id="algx2.l20.m1.1" class="ltx_Math" alttext="\nabla^{\wedge}F_{e}" display="inline"><semantics id="algx2.l20.m1.1a"><mrow id="algx2.l20.m1.1.1" xref="algx2.l20.m1.1.1.cmml"><msup id="algx2.l20.m1.1.1.1" xref="algx2.l20.m1.1.1.1.cmml"><mo id="algx2.l20.m1.1.1.1.2" xref="algx2.l20.m1.1.1.1.2.cmml">∇</mo><mo id="algx2.l20.m1.1.1.1.3" xref="algx2.l20.m1.1.1.1.3.cmml">∧</mo></msup><msub id="algx2.l20.m1.1.1.2" xref="algx2.l20.m1.1.1.2.cmml"><mi id="algx2.l20.m1.1.1.2.2" xref="algx2.l20.m1.1.1.2.2.cmml">F</mi><mi id="algx2.l20.m1.1.1.2.3" xref="algx2.l20.m1.1.1.2.3.cmml">e</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx2.l20.m1.1b"><apply id="algx2.l20.m1.1.1.cmml" xref="algx2.l20.m1.1.1"><apply id="algx2.l20.m1.1.1.1.cmml" xref="algx2.l20.m1.1.1.1"><csymbol cd="ambiguous" id="algx2.l20.m1.1.1.1.1.cmml" xref="algx2.l20.m1.1.1.1">superscript</csymbol><ci id="algx2.l20.m1.1.1.1.2.cmml" xref="algx2.l20.m1.1.1.1.2">∇</ci><and id="algx2.l20.m1.1.1.1.3.cmml" xref="algx2.l20.m1.1.1.1.3"></and></apply><apply id="algx2.l20.m1.1.1.2.cmml" xref="algx2.l20.m1.1.1.2"><csymbol cd="ambiguous" id="algx2.l20.m1.1.1.2.1.cmml" xref="algx2.l20.m1.1.1.2">subscript</csymbol><ci id="algx2.l20.m1.1.1.2.2.cmml" xref="algx2.l20.m1.1.1.2.2">𝐹</ci><ci id="algx2.l20.m1.1.1.2.3.cmml" xref="algx2.l20.m1.1.1.2.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l20.m1.1c">\nabla^{\wedge}F_{e}</annotation></semantics></math>, <math id="algx2.l20.m2.1" class="ltx_Math" alttext="C_{e}" display="inline"><semantics id="algx2.l20.m2.1a"><msub id="algx2.l20.m2.1.1" xref="algx2.l20.m2.1.1.cmml"><mi id="algx2.l20.m2.1.1.2" xref="algx2.l20.m2.1.1.2.cmml">C</mi><mi id="algx2.l20.m2.1.1.3" xref="algx2.l20.m2.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="algx2.l20.m2.1b"><apply id="algx2.l20.m2.1.1.cmml" xref="algx2.l20.m2.1.1"><csymbol cd="ambiguous" id="algx2.l20.m2.1.1.1.cmml" xref="algx2.l20.m2.1.1">subscript</csymbol><ci id="algx2.l20.m2.1.1.2.cmml" xref="algx2.l20.m2.1.1.2">𝐶</ci><ci id="algx2.l20.m2.1.1.3.cmml" xref="algx2.l20.m2.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l20.m2.1c">C_{e}</annotation></semantics></math>

</div>
<div id="algx2.l21" class="ltx_listingline">
<span id="algx2.l21.1" class="ltx_text ltx_font_bold">end</span> <span id="algx2.l21.2" class="ltx_text ltx_font_bold">function</span>
</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="S7.F4" class="ltx_figure">
<p id="S7.F4.1" class="ltx_p ltx_align_center"><span id="S7.F4.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2205.09305/assets/sequence.png" id="S7.F4.1.1.g1" class="ltx_graphics ltx_img_portrait" width="491" height="785" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F4.3.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S7.F4.4.2" class="ltx_text" style="font-size:90%;">Sequence diagram to calculate either Fishr+Inter-Geo or Fishr+Intra-Geo algorithm.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<figure id="S7.F5" class="ltx_figure">
<p id="S7.F5.1" class="ltx_p ltx_align_center"><span id="S7.F5.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2205.09305/assets/mnist_loss.png" id="S7.F5.1.1.g1" class="ltx_graphics ltx_img_landscape" width="452" height="216" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F5.3.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S7.F5.4.2" class="ltx_text" style="font-size:90%;">The training loss, validation loss, and OOD test loss comparison among different algorithms on the Color-MNIST dataset.</span></figcaption>
</figure>
<figure id="S7.F6" class="ltx_figure">
<p id="S7.F6.1" class="ltx_p ltx_align_center"><span id="S7.F6.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2205.09305/assets/saifa_loss.png" id="S7.F6.1.1.g1" class="ltx_graphics ltx_img_landscape" width="452" height="216" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F6.3.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="S7.F6.4.2" class="ltx_text" style="font-size:90%;">The training loss, validation loss, and OOD test loss comparison among different algorithms on the Rotated-CIFAR10 dataset.</span></figcaption>
</figure>
<figure id="S7.F7" class="ltx_figure">
<p id="S7.F7.1" class="ltx_p ltx_align_center"><span id="S7.F7.1.1" class="ltx_text ltx_framed ltx_framed_rectangle" style="border-color: #000000;padding:0.0pt;"><img src="/html/2205.09305/assets/icu_loss.png" id="S7.F7.1.1.g1" class="ltx_graphics ltx_img_landscape" width="452" height="216" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F7.3.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="S7.F7.4.2" class="ltx_text" style="font-size:90%;">The training loss, validation loss, and OOD test loss comparison among different algorithms on the eICU dataset.</span></figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2205.09304" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2205.09305" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2205.09305">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2205.09305" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2205.09306" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 05:46:06 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
