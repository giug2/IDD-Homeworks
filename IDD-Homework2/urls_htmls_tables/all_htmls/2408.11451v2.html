<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Bidirectional Gated Mamba for Sequential Recommendation</title>
<!--Generated on Fri Aug 23 01:56:10 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Sequential Recommender Systems,  State Space Model,  Gate Mechanism" lang="en" name="keywords"/>
<base href="/html/2408.11451v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S1" title="In Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2" title="In Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.SS1" title="In 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Framework Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.SS2" title="In 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Embedding Layer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.SS3" title="In 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>G-Mamba Block</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.SS3.SSS1" title="In 2.3. G-Mamba Block ‣ 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.1 </span>Partially Flipped Mamba</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.SS3.SSS2" title="In 2.3. G-Mamba Block ‣ 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.2 </span>Dense Selective Gate</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.SS3.SSS3" title="In 2.3. G-Mamba Block ‣ 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.3 </span>Feature Extract GRU</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.SS4" title="In 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.4 </span>PFFN Network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.SS5" title="In 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.5 </span>Train and Inference</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3" title="In Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS1" title="In 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Experiment Setting</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS1.SSS1" title="In 3.1. Experiment Setting ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS1.SSS2" title="In 3.1. Experiment Setting ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS1.SSS3" title="In 3.1. Experiment Setting ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.3 </span>Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS1.SSS4" title="In 3.1. Experiment Setting ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.4 </span>Baselines</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS2" title="In 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Overall Performance Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS3" title="In 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Efficiency Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS4" title="In 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Grouped Users Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS5" title="In 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS6" title="In 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Hyperparameter Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.SS7" title="In 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.7 </span>Case Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S4" title="In Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S4.SS1" title="In 4. Related Work ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S4.SS2" title="In 4. Related Work ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Selective State Space Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S5" title="In Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6" title="In Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS1" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>A. Complexity Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS2" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>B. Dataset Information</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS3" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>C. Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS4" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>D. Implementation Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS5" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>E. Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS6" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.6 </span>F. Efficiency Comparison</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS7" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.7 </span>G. Grouped Users Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS8" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.8 </span>H. Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.SS9" title="In 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.9 </span>I. Guideline for reproducibility</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\pdfcolInitStack</span>
<p class="ltx_p" id="p1.2">tcb@breakable






















































 










</p>
</div>
<h1 class="ltx_title ltx_title_document">Bidirectional Gated Mamba for Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ziwei Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:ziwliu8-c@my.cityu.edu.hk">ziwliu8-c@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qidong Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Xi’an Jiaotong University
<br class="ltx_break"/>City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Xi’an</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liuqidong@stu.xjtu.edu.cn">liuqidong@stu.xjtu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yejing Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yejing.wang@my.cityu.edu.hk">yejing.wang@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wanyu Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wanyuwang4-c@my.cityu.edu.hk">wanyuwang4-c@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pengyue Jia
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jia.pengyue@my.cityu.edu.hk">jia.pengyue@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Maolin Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:Morin.wang@my.cityu.edu.hk%0A">Morin.wang@my.cityu.edu.hk
</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zitao Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.1.id1">Jinan University</span><span class="ltx_text ltx_affiliation_city" id="id20.2.id2">Guang Zhou</span><span class="ltx_text ltx_affiliation_country" id="id21.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liuzitao@jnu.edu.cn">liuzitao@jnu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yi Chang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id22.1.id1">Jilin University</span><span class="ltx_text ltx_affiliation_city" id="id23.2.id2">Ji Lin</span><span class="ltx_text ltx_affiliation_country" id="id24.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yichang@jlu.edu.cn">yichang@jlu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiangyu Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id25.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id26.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id27.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xianzhao@cityu.edu.hk">xianzhao@cityu.edu.hk</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id28.id1">In various domains, Sequential Recommender Systems (SRS) have become essential due to their superior capability to discern intricate user preferences. Typically, SRS utilize transformer-based architectures to forecast the subsequent item within a sequence. Nevertheless, the quadratic computational complexity inherent in these models often leads to inefficiencies, hindering the achievement of real-time recommendations. Mamba, a recent advancement, has exhibited exceptional performance in time series prediction, significantly enhancing both efficiency and accuracy. However, integrating Mamba directly into SRS poses several challenges. Its inherently unidirectional nature may constrain the model’s capacity to capture the full context of user-item interactions, while its instability in state estimation can compromise its ability to detect short-term patterns within interaction sequences.</p>
<p class="ltx_p" id="id29.id2">To overcome these issues, we introduce a new framework named <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id29.id2.1">S</span>elect<span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id29.id2.2">I</span>ve <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id29.id2.3">G</span>ated <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="id29.id2.4">MA</span>mba (SIGMA). This framework leverages a Partially Flipped Mamba (PF-Mamba) to construct a bidirectional architecture specifically tailored to improve contextual modeling. Additionally, an input-sensitive Dense Selective Gate (DS Gate) is employed to optimize directional weights and enhance the processing of sequential information in PF-Mamba. For short sequence modeling, we have also developed a Feature Extract GRU (FE-GRU) to efficiently capture short-term dependencies. Empirical results indicate that SIGMA outperforms current models on five real-world datasets. Our implementation code is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/ziwliu-cityu/SIMGA" title="">https://github.com/ziwliu-cityu/SIMGA</a> to ease reproducibility.</p>
</div>
<div class="ltx_keywords">Sequential Recommender Systems, State Space Model, Gate Mechanism
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Over the past decade, sequential recommender systems (SRS) have demonstrated promising potential across various domains, including content streaming platforms <cite class="ltx_cite ltx_citemacro_citep">(Rappaz et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib33" title="">2021</a>)</cite> and e-commerce <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib37" title="">2020</a>)</cite>. To harness this potential and meet the demand for accurate next-item predictions <cite class="ltx_cite ltx_citemacro_citep">(Fang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib7" title="">2020</a>)</cite>, an increasing number of researchers are focusing on refining existing architectures and proposing novel approaches <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib38" title="">2019</a>; Miller et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib30" title="">2024</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="451" id="S1.F1.g1" src="x1.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">The illustration for long-tail user problem.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recently, Transformer-based models have emerged as the leading approach in sequential recommendation due to their outstanding performance <cite class="ltx_cite ltx_citemacro_citep">(de Souza Pereira Moreira et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib5" title="">2021</a>)</cite>. By leveraging the powerful self-attention mechanism <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib36" title="">2017</a>; Keles et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib16" title="">2023</a>)</cite>, these models have demonstrated a remarkable ability to deliver accurate predictions. However, despite their impressive performance, current transformer-based models are proven inefficient since the amount of computation grows quadratically as the length of the input sequence increases <cite class="ltx_cite ltx_citemacro_citep">(Keles et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib16" title="">2023</a>)</cite>. Other approaches, such as RNN-based models <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">e.g.,</em> GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(Jannach and Ludewig, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib13" title="">2017</a>)</cite> and MLP-based models <em class="ltx_emph ltx_font_italic" id="S1.p2.1.2">e.g.,</em> MLP4Rec <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib22" title="">2022a</a>)</cite>, are proven to be efficient due to their linear complexity. Nevertheless, they have struggled with handling long and complex patterns <cite class="ltx_cite ltx_citemacro_citep">(Yoon and Jang, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib41" title="">2023</a>)</cite>. All these methods above seem to have suffered from a significant trade-off between effectiveness and efficiency. Consequently, a specially designed State Space Model (SSM) called Mamba <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib9" title="">2023</a>)</cite> has been proposed. By employing simple input-dependent selection on the original SSM <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib25" title="">2024a</a>; Hamilton, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib10" title="">1994</a>)</cite>, it has demonstrated remarkable efficiency and effectiveness.</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="316" id="S1.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S1.F2.3.2" style="font-size:90%;">Framework of proposed SIGMA. The core part of this framework is the G-Mamba Block, which can directly tackle the context modeling and short sequence modeling challenges when introducing Mamba to SRS.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">However, two significant challenges hinder the direct adoption of Mamba in SRS:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">Context Modeling</span>:
While previous research has demonstrated Mamba’s reliability in capturing sequential information <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib9" title="">2023</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib40" title="">2024</a>)</cite>, its unidirectional architecture imposes significant limitations in SRS applications. By only capturing users’ past behaviors, Mamba cannot leverage future contextual information, potentially leading to an incomplete understanding of user preferences  <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib25" title="">2024a</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib35" title="">2019</a>)</cite>.
For instance, if a user consistently purchases household items but begins to show interest in sports equipment, a model that does not consider future contexts may struggle to recognize this shift, resulting in sub-optimal next-item predictions <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib14" title="">2024</a>; Kweon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib20" title="">2021</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">Short Sequence Modeling</span>:
This challenge is primarily driven by the long-tail user problem, a common issue in sequential recommendation. Long-tail users refer to such users who interact with only a few items but typically receive lower-quality recommendations compared to the normal ones <cite class="ltx_cite ltx_citemacro_citep">(Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib17" title="">2019a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib18" title="">b</a>)</cite>. Furthermore, the instability in state estimation caused by limited data in short sequences <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib9" title="">2023</a>; Smith et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib34" title="">2022</a>; Yu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib42" title="">2024</a>)</cite> exacerbates this problem when Mamba is directly applied to SRS, highlighting the need for effective short sequence modeling. For illustration, we compare two leading baselines, Mamba4Rec <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib25" title="">2024a</a>)</cite> and SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib15" title="">2018</a>)</cite>, against our proposed framework on the Beauty dataset. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, the histogram depicts the number of users in each group, while the line represents recommendation performance in terms of Hit@10. SASRec outperforms Mamba4Rec in the first three groups, demonstrating Mamba4Rec’s exacerbation of the long-tail user problem.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S1.p3.2">To address these challenges and better leverage Mamba’s strengths, we propose an innovative framework called <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.p3.2.1">S</span>elect<span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.p3.2.2">I</span>ve <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.p3.2.3">G</span>ated <span class="ltx_text ltx_font_bold ltx_framed ltx_framed_underline" id="S1.p3.2.4">MA</span>mba for Sequential Recommendation (SIGMA). Our approach introduces the Partially Flipped Mamba (PF-Mamba), a specialized bidirectional structure that captures contextual information <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib25" title="">2024a</a>; Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib14" title="">2024</a>)</cite>. We then introduce an input-dependent Dense Selective Gate (DS Gate) to allocate the weights of the two directions and further filter the information. Additionally, we develop a Feature Extract GRU (FE-GRU) to better model short-term patterns in interaction sequences <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib12" title="">2015</a>)</cite>, offering a possible solution to the long-tail user problem.
Our contributions are summarized as follows::</p>
<ul class="ltx_itemize" id="S1.I2">
<li class="ltx_item" id="S1.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i1.p1">
<p class="ltx_p" id="S1.I2.i1.p1.1">We identify the limitations of Mamba when applied to SRS, attributing them to its unidirectional structure and instability in state estimation for short sequences.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i2.p1">
<p class="ltx_p" id="S1.I2.i2.p1.1">We introduce SIGMA, a novel framework featuring a Partially Flipped Mamba with a Dense Selective Gate and a Feature Extract GRU, which respectively address the challenges of context modeling and short sequence modeling.</p>
</div>
</li>
<li class="ltx_item" id="S1.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I2.i3.p1">
<p class="ltx_p" id="S1.I2.i3.p1.1">We validate SIGMA’s performance on five public real-world datasets, demonstrating its superiority.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Methodology</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we will introduce a novel framework, SIGMA, which effectively addresses the aforementioned problems by adopting PF-Mamba with a Dense Selective Gate and a Feature Extract GRU. We will first present the overview of our proposed framework; then detail the important components of our architecture; and lastly introduce how we conduct our training and inference procedures.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Framework Overview</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In this section, we present an overview of our proposed framework in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Firstly, we employ an embedding layer to learn the representation for input items. After getting the high-dimensional interaction representation, we propose a G-Mamba block to selectively extract the information.
Specifically, the G-Mamba block consists of a bidirectional Mamba path and a GRU path, which respectively address challenges in context modeling and short sequence modeling.
Then, a Position-wise Feed-Forward Network (PFFN) is adopted to improve the modeling ability of user actions in the hidden representation. Finally, processed by the prediction layer, we can get an accurate next-item prediction.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Embedding Layer </h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.10">For existing SRSs, It is necessary to map the sequential information in user-item interaction to a high-dimensional space <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib26" title="">2023a</a>)</cite> to effectively capture the temporal dependencies. In our framework, we choose a commonly used method for constructing the item embedding.
Here, we denote the user set as <math alttext="\mathcal{U}=\left\{{u}_{1},{u}_{2},\cdots,{u}_{\left|\mathcal{U}\right|}\right\}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.5"><semantics id="S2.SS2.p1.1.m1.5a"><mrow id="S2.SS2.p1.1.m1.5.5" xref="S2.SS2.p1.1.m1.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.5.5.5" xref="S2.SS2.p1.1.m1.5.5.5.cmml">𝒰</mi><mo id="S2.SS2.p1.1.m1.5.5.4" xref="S2.SS2.p1.1.m1.5.5.4.cmml">=</mo><mrow id="S2.SS2.p1.1.m1.5.5.3.3" xref="S2.SS2.p1.1.m1.5.5.3.4.cmml"><mo id="S2.SS2.p1.1.m1.5.5.3.3.4" xref="S2.SS2.p1.1.m1.5.5.3.4.cmml">{</mo><msub id="S2.SS2.p1.1.m1.3.3.1.1.1" xref="S2.SS2.p1.1.m1.3.3.1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.3.3.1.1.1.2" xref="S2.SS2.p1.1.m1.3.3.1.1.1.2.cmml">u</mi><mn id="S2.SS2.p1.1.m1.3.3.1.1.1.3" xref="S2.SS2.p1.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.1.m1.5.5.3.3.5" xref="S2.SS2.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S2.SS2.p1.1.m1.4.4.2.2.2" xref="S2.SS2.p1.1.m1.4.4.2.2.2.cmml"><mi id="S2.SS2.p1.1.m1.4.4.2.2.2.2" xref="S2.SS2.p1.1.m1.4.4.2.2.2.2.cmml">u</mi><mn id="S2.SS2.p1.1.m1.4.4.2.2.2.3" xref="S2.SS2.p1.1.m1.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS2.p1.1.m1.5.5.3.3.6" xref="S2.SS2.p1.1.m1.5.5.3.4.cmml">,</mo><mi id="S2.SS2.p1.1.m1.2.2" mathvariant="normal" xref="S2.SS2.p1.1.m1.2.2.cmml">⋯</mi><mo id="S2.SS2.p1.1.m1.5.5.3.3.7" xref="S2.SS2.p1.1.m1.5.5.3.4.cmml">,</mo><msub id="S2.SS2.p1.1.m1.5.5.3.3.3" xref="S2.SS2.p1.1.m1.5.5.3.3.3.cmml"><mi id="S2.SS2.p1.1.m1.5.5.3.3.3.2" xref="S2.SS2.p1.1.m1.5.5.3.3.3.2.cmml">u</mi><mrow id="S2.SS2.p1.1.m1.1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.1.2.cmml"><mo id="S2.SS2.p1.1.m1.1.1.1.3.1" xref="S2.SS2.p1.1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.1.cmml">𝒰</mi><mo id="S2.SS2.p1.1.m1.1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S2.SS2.p1.1.m1.5.5.3.3.8" xref="S2.SS2.p1.1.m1.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.5b"><apply id="S2.SS2.p1.1.m1.5.5.cmml" xref="S2.SS2.p1.1.m1.5.5"><eq id="S2.SS2.p1.1.m1.5.5.4.cmml" xref="S2.SS2.p1.1.m1.5.5.4"></eq><ci id="S2.SS2.p1.1.m1.5.5.5.cmml" xref="S2.SS2.p1.1.m1.5.5.5">𝒰</ci><set id="S2.SS2.p1.1.m1.5.5.3.4.cmml" xref="S2.SS2.p1.1.m1.5.5.3.3"><apply id="S2.SS2.p1.1.m1.3.3.1.1.1.cmml" xref="S2.SS2.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.3.3.1.1.1.2">𝑢</ci><cn id="S2.SS2.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.1.m1.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS2.p1.1.m1.4.4.2.2.2.cmml" xref="S2.SS2.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.4.4.2.2.2.1.cmml" xref="S2.SS2.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.4.4.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.4.4.2.2.2.2">𝑢</ci><cn id="S2.SS2.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.1.m1.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS2.p1.1.m1.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2">⋯</ci><apply id="S2.SS2.p1.1.m1.5.5.3.3.3.cmml" xref="S2.SS2.p1.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.5.5.3.3.3.1.cmml" xref="S2.SS2.p1.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S2.SS2.p1.1.m1.5.5.3.3.3.2.cmml" xref="S2.SS2.p1.1.m1.5.5.3.3.3.2">𝑢</ci><apply id="S2.SS2.p1.1.m1.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.1.3"><abs id="S2.SS2.p1.1.m1.1.1.1.2.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.3.1"></abs><ci id="S2.SS2.p1.1.m1.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1.1">𝒰</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.5c">\mathcal{U}=\left\{{u}_{1},{u}_{2},\cdots,{u}_{\left|\mathcal{U}\right|}\right\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.5d">caligraphic_U = { italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_u start_POSTSUBSCRIPT | caligraphic_U | end_POSTSUBSCRIPT }</annotation></semantics></math> and the item set as <math alttext="\mathcal{V}=\left\{{v}_{1},{v}_{2},\cdots,{v}_{\left|\mathcal{V}\right|}\right\}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.5"><semantics id="S2.SS2.p1.2.m2.5a"><mrow id="S2.SS2.p1.2.m2.5.5" xref="S2.SS2.p1.2.m2.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.5.5.5" xref="S2.SS2.p1.2.m2.5.5.5.cmml">𝒱</mi><mo id="S2.SS2.p1.2.m2.5.5.4" xref="S2.SS2.p1.2.m2.5.5.4.cmml">=</mo><mrow id="S2.SS2.p1.2.m2.5.5.3.3" xref="S2.SS2.p1.2.m2.5.5.3.4.cmml"><mo id="S2.SS2.p1.2.m2.5.5.3.3.4" xref="S2.SS2.p1.2.m2.5.5.3.4.cmml">{</mo><msub id="S2.SS2.p1.2.m2.3.3.1.1.1" xref="S2.SS2.p1.2.m2.3.3.1.1.1.cmml"><mi id="S2.SS2.p1.2.m2.3.3.1.1.1.2" xref="S2.SS2.p1.2.m2.3.3.1.1.1.2.cmml">v</mi><mn id="S2.SS2.p1.2.m2.3.3.1.1.1.3" xref="S2.SS2.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.2.m2.5.5.3.3.5" xref="S2.SS2.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S2.SS2.p1.2.m2.4.4.2.2.2" xref="S2.SS2.p1.2.m2.4.4.2.2.2.cmml"><mi id="S2.SS2.p1.2.m2.4.4.2.2.2.2" xref="S2.SS2.p1.2.m2.4.4.2.2.2.2.cmml">v</mi><mn id="S2.SS2.p1.2.m2.4.4.2.2.2.3" xref="S2.SS2.p1.2.m2.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS2.p1.2.m2.5.5.3.3.6" xref="S2.SS2.p1.2.m2.5.5.3.4.cmml">,</mo><mi id="S2.SS2.p1.2.m2.2.2" mathvariant="normal" xref="S2.SS2.p1.2.m2.2.2.cmml">⋯</mi><mo id="S2.SS2.p1.2.m2.5.5.3.3.7" xref="S2.SS2.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S2.SS2.p1.2.m2.5.5.3.3.3" xref="S2.SS2.p1.2.m2.5.5.3.3.3.cmml"><mi id="S2.SS2.p1.2.m2.5.5.3.3.3.2" xref="S2.SS2.p1.2.m2.5.5.3.3.3.2.cmml">v</mi><mrow id="S2.SS2.p1.2.m2.1.1.1.3" xref="S2.SS2.p1.2.m2.1.1.1.2.cmml"><mo id="S2.SS2.p1.2.m2.1.1.1.3.1" xref="S2.SS2.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.1.1.1.1" xref="S2.SS2.p1.2.m2.1.1.1.1.cmml">𝒱</mi><mo id="S2.SS2.p1.2.m2.1.1.1.3.2" xref="S2.SS2.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S2.SS2.p1.2.m2.5.5.3.3.8" xref="S2.SS2.p1.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.5b"><apply id="S2.SS2.p1.2.m2.5.5.cmml" xref="S2.SS2.p1.2.m2.5.5"><eq id="S2.SS2.p1.2.m2.5.5.4.cmml" xref="S2.SS2.p1.2.m2.5.5.4"></eq><ci id="S2.SS2.p1.2.m2.5.5.5.cmml" xref="S2.SS2.p1.2.m2.5.5.5">𝒱</ci><set id="S2.SS2.p1.2.m2.5.5.3.4.cmml" xref="S2.SS2.p1.2.m2.5.5.3.3"><apply id="S2.SS2.p1.2.m2.3.3.1.1.1.cmml" xref="S2.SS2.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.3.3.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.3.3.1.1.1.2">𝑣</ci><cn id="S2.SS2.p1.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS2.p1.2.m2.4.4.2.2.2.cmml" xref="S2.SS2.p1.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.4.4.2.2.2.1.cmml" xref="S2.SS2.p1.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.2.m2.4.4.2.2.2.2.cmml" xref="S2.SS2.p1.2.m2.4.4.2.2.2.2">𝑣</ci><cn id="S2.SS2.p1.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS2.p1.2.m2.2.2.cmml" xref="S2.SS2.p1.2.m2.2.2">⋯</ci><apply id="S2.SS2.p1.2.m2.5.5.3.3.3.cmml" xref="S2.SS2.p1.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.5.5.3.3.3.1.cmml" xref="S2.SS2.p1.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S2.SS2.p1.2.m2.5.5.3.3.3.2.cmml" xref="S2.SS2.p1.2.m2.5.5.3.3.3.2">𝑣</ci><apply id="S2.SS2.p1.2.m2.1.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.1.3"><abs id="S2.SS2.p1.2.m2.1.1.1.2.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.3.1"></abs><ci id="S2.SS2.p1.2.m2.1.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1.1.1">𝒱</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.5c">\mathcal{V}=\left\{{v}_{1},{v}_{2},\cdots,{v}_{\left|\mathcal{V}\right|}\right\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.5d">caligraphic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT | caligraphic_V | end_POSTSUBSCRIPT }</annotation></semantics></math>. So for a chronologically ordered interaction sequence, it can be expressed as <math alttext="\boldsymbol{S}_{u}=\left[{s}_{1},{s}_{2},\cdots,{s}_{{n}_{u}}\right]" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.4"><semantics id="S2.SS2.p1.3.m3.4a"><mrow id="S2.SS2.p1.3.m3.4.4" xref="S2.SS2.p1.3.m3.4.4.cmml"><msub id="S2.SS2.p1.3.m3.4.4.5" xref="S2.SS2.p1.3.m3.4.4.5.cmml"><mi id="S2.SS2.p1.3.m3.4.4.5.2" xref="S2.SS2.p1.3.m3.4.4.5.2.cmml">𝑺</mi><mi id="S2.SS2.p1.3.m3.4.4.5.3" xref="S2.SS2.p1.3.m3.4.4.5.3.cmml">u</mi></msub><mo id="S2.SS2.p1.3.m3.4.4.4" xref="S2.SS2.p1.3.m3.4.4.4.cmml">=</mo><mrow id="S2.SS2.p1.3.m3.4.4.3.3" xref="S2.SS2.p1.3.m3.4.4.3.4.cmml"><mo id="S2.SS2.p1.3.m3.4.4.3.3.4" xref="S2.SS2.p1.3.m3.4.4.3.4.cmml">[</mo><msub id="S2.SS2.p1.3.m3.2.2.1.1.1" xref="S2.SS2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.3.m3.2.2.1.1.1.2" xref="S2.SS2.p1.3.m3.2.2.1.1.1.2.cmml">s</mi><mn id="S2.SS2.p1.3.m3.2.2.1.1.1.3" xref="S2.SS2.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.3.m3.4.4.3.3.5" xref="S2.SS2.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S2.SS2.p1.3.m3.3.3.2.2.2" xref="S2.SS2.p1.3.m3.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.3.m3.3.3.2.2.2.2" xref="S2.SS2.p1.3.m3.3.3.2.2.2.2.cmml">s</mi><mn id="S2.SS2.p1.3.m3.3.3.2.2.2.3" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS2.p1.3.m3.4.4.3.3.6" xref="S2.SS2.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S2.SS2.p1.3.m3.1.1" mathvariant="normal" xref="S2.SS2.p1.3.m3.1.1.cmml">⋯</mi><mo id="S2.SS2.p1.3.m3.4.4.3.3.7" xref="S2.SS2.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S2.SS2.p1.3.m3.4.4.3.3.3" xref="S2.SS2.p1.3.m3.4.4.3.3.3.cmml"><mi id="S2.SS2.p1.3.m3.4.4.3.3.3.2" xref="S2.SS2.p1.3.m3.4.4.3.3.3.2.cmml">s</mi><msub id="S2.SS2.p1.3.m3.4.4.3.3.3.3" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3.cmml"><mi id="S2.SS2.p1.3.m3.4.4.3.3.3.3.2" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3.2.cmml">n</mi><mi id="S2.SS2.p1.3.m3.4.4.3.3.3.3.3" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3.3.cmml">u</mi></msub></msub><mo id="S2.SS2.p1.3.m3.4.4.3.3.8" xref="S2.SS2.p1.3.m3.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.4b"><apply id="S2.SS2.p1.3.m3.4.4.cmml" xref="S2.SS2.p1.3.m3.4.4"><eq id="S2.SS2.p1.3.m3.4.4.4.cmml" xref="S2.SS2.p1.3.m3.4.4.4"></eq><apply id="S2.SS2.p1.3.m3.4.4.5.cmml" xref="S2.SS2.p1.3.m3.4.4.5"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.4.4.5.1.cmml" xref="S2.SS2.p1.3.m3.4.4.5">subscript</csymbol><ci id="S2.SS2.p1.3.m3.4.4.5.2.cmml" xref="S2.SS2.p1.3.m3.4.4.5.2">𝑺</ci><ci id="S2.SS2.p1.3.m3.4.4.5.3.cmml" xref="S2.SS2.p1.3.m3.4.4.5.3">𝑢</ci></apply><list id="S2.SS2.p1.3.m3.4.4.3.4.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3"><apply id="S2.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1.2">𝑠</ci><cn id="S2.SS2.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS2.p1.3.m3.3.3.2.2.2.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2.2">𝑠</ci><cn id="S2.SS2.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">⋯</ci><apply id="S2.SS2.p1.3.m3.4.4.3.3.3.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.4.4.3.3.3.1.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S2.SS2.p1.3.m3.4.4.3.3.3.2.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3.2">𝑠</ci><apply id="S2.SS2.p1.3.m3.4.4.3.3.3.3.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.4.4.3.3.3.3.1.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3">subscript</csymbol><ci id="S2.SS2.p1.3.m3.4.4.3.3.3.3.2.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3.2">𝑛</ci><ci id="S2.SS2.p1.3.m3.4.4.3.3.3.3.3.cmml" xref="S2.SS2.p1.3.m3.4.4.3.3.3.3.3">𝑢</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.4c">\boldsymbol{S}_{u}=\left[{s}_{1},{s}_{2},\cdots,{s}_{{n}_{u}}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.4d">bold_italic_S start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT = [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_s start_POSTSUBSCRIPT italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>,
where <math alttext="{n}_{u}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.1"><semantics id="S2.SS2.p1.4.m4.1a"><msub id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">n</mi><mi id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝑛</ci><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">{n}_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.1d">italic_n start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> represents the length of the sequence for user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.1"><semantics id="S2.SS2.p1.5.m5.1a"><mrow id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">u</mi><mo id="S2.SS2.p1.5.m5.1.1.1" xref="S2.SS2.p1.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><in id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1.1"></in><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">𝑢</ci><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.1d">italic_u ∈ caligraphic_U</annotation></semantics></math>. For simplicity, we omit the mark <math alttext="\left(u\right)" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1"><semantics id="S2.SS2.p1.6.m6.1a"><mrow id="S2.SS2.p1.6.m6.1.2.2"><mo id="S2.SS2.p1.6.m6.1.2.2.1">(</mo><mi id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml">u</mi><mo id="S2.SS2.p1.6.m6.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><ci id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\left(u\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">( italic_u )</annotation></semantics></math> in the following sections.
Regarding this interaction sequence as the input tensor, we denote <math alttext="D" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.1"><semantics id="S2.SS2.p1.7.m7.1a"><mi id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.1d">italic_D</annotation></semantics></math> as the embedding dimension and use a learnable item embedding matrix
<math alttext="\boldsymbol{E}\in\mathbb{{R}^{\mathit{\left|\mathcal{V}\right|\times D}}}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.1"><semantics id="S2.SS2.p1.8.m8.1a"><mrow id="S2.SS2.p1.8.m8.1.2" xref="S2.SS2.p1.8.m8.1.2.cmml"><mi id="S2.SS2.p1.8.m8.1.2.2" xref="S2.SS2.p1.8.m8.1.2.2.cmml">𝑬</mi><mo id="S2.SS2.p1.8.m8.1.2.1" xref="S2.SS2.p1.8.m8.1.2.1.cmml">∈</mo><msup id="S2.SS2.p1.8.m8.1.2.3" xref="S2.SS2.p1.8.m8.1.2.3.cmml"><mi id="S2.SS2.p1.8.m8.1.2.3.2" xref="S2.SS2.p1.8.m8.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p1.8.m8.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.cmml"><mrow id="S2.SS2.p1.8.m8.1.1.1.3.2" xref="S2.SS2.p1.8.m8.1.1.1.3.1.cmml"><mo id="S2.SS2.p1.8.m8.1.1.1.3.2.1" xref="S2.SS2.p1.8.m8.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.8.m8.1.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.1.cmml">𝒱</mi><mo id="S2.SS2.p1.8.m8.1.1.1.3.2.2" rspace="0.055em" xref="S2.SS2.p1.8.m8.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S2.SS2.p1.8.m8.1.1.1.2" rspace="0.222em" xref="S2.SS2.p1.8.m8.1.1.1.2.cmml">×</mo><mi id="S2.SS2.p1.8.m8.1.1.1.4" xref="S2.SS2.p1.8.m8.1.1.1.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><apply id="S2.SS2.p1.8.m8.1.2.cmml" xref="S2.SS2.p1.8.m8.1.2"><in id="S2.SS2.p1.8.m8.1.2.1.cmml" xref="S2.SS2.p1.8.m8.1.2.1"></in><ci id="S2.SS2.p1.8.m8.1.2.2.cmml" xref="S2.SS2.p1.8.m8.1.2.2">𝑬</ci><apply id="S2.SS2.p1.8.m8.1.2.3.cmml" xref="S2.SS2.p1.8.m8.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.8.m8.1.2.3.1.cmml" xref="S2.SS2.p1.8.m8.1.2.3">superscript</csymbol><ci id="S2.SS2.p1.8.m8.1.2.3.2.cmml" xref="S2.SS2.p1.8.m8.1.2.3.2">ℝ</ci><apply id="S2.SS2.p1.8.m8.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1"><times id="S2.SS2.p1.8.m8.1.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.1.2"></times><apply id="S2.SS2.p1.8.m8.1.1.1.3.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1.3.2"><abs id="S2.SS2.p1.8.m8.1.1.1.3.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1.3.2.1"></abs><ci id="S2.SS2.p1.8.m8.1.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1.1">𝒱</ci></apply><ci id="S2.SS2.p1.8.m8.1.1.1.4.cmml" xref="S2.SS2.p1.8.m8.1.1.1.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">\boldsymbol{E}\in\mathbb{{R}^{\mathit{\left|\mathcal{V}\right|\times D}}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.1d">bold_italic_E ∈ blackboard_R start_POSTSUPERSCRIPT | caligraphic_V | × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> to adaptively projected <math alttext="{s}_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m9.1"><semantics id="S2.SS2.p1.9.m9.1a"><msub id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml"><mi id="S2.SS2.p1.9.m9.1.1.2" xref="S2.SS2.p1.9.m9.1.1.2.cmml">s</mi><mi id="S2.SS2.p1.9.m9.1.1.3" xref="S2.SS2.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><apply id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.9.m9.1.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS2.p1.9.m9.1.1.2.cmml" xref="S2.SS2.p1.9.m9.1.1.2">𝑠</ci><ci id="S2.SS2.p1.9.m9.1.1.3.cmml" xref="S2.SS2.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">{s}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m9.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> into the representation <math alttext="\boldsymbol{h}_{i}" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m10.1"><semantics id="S2.SS2.p1.10.m10.1a"><msub id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml"><mi id="S2.SS2.p1.10.m10.1.1.2" xref="S2.SS2.p1.10.m10.1.1.2.cmml">𝒉</mi><mi id="S2.SS2.p1.10.m10.1.1.3" xref="S2.SS2.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><apply id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.10.m10.1.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.p1.10.m10.1.1.2.cmml" xref="S2.SS2.p1.10.m10.1.1.2">𝒉</ci><ci id="S2.SS2.p1.10.m10.1.1.3.cmml" xref="S2.SS2.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">\boldsymbol{h}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m10.1d">bold_italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. The whole interaction sequence can be output as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{H}_{0}=\left[\boldsymbol{{h}}_{1},\boldsymbol{h}_{2},\cdots,%
\boldsymbol{h}_{N}\right]" class="ltx_Math" display="block" id="S2.E1.m1.4"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><msub id="S2.E1.m1.4.4.5" xref="S2.E1.m1.4.4.5.cmml"><mi id="S2.E1.m1.4.4.5.2" xref="S2.E1.m1.4.4.5.2.cmml">𝑯</mi><mn id="S2.E1.m1.4.4.5.3" xref="S2.E1.m1.4.4.5.3.cmml">0</mn></msub><mo id="S2.E1.m1.4.4.4" xref="S2.E1.m1.4.4.4.cmml">=</mo><mrow id="S2.E1.m1.4.4.3.3" xref="S2.E1.m1.4.4.3.4.cmml"><mo id="S2.E1.m1.4.4.3.3.4" xref="S2.E1.m1.4.4.3.4.cmml">[</mo><msub id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.2.cmml">𝒉</mi><mn id="S2.E1.m1.2.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.E1.m1.4.4.3.3.5" xref="S2.E1.m1.4.4.3.4.cmml">,</mo><msub id="S2.E1.m1.3.3.2.2.2" xref="S2.E1.m1.3.3.2.2.2.cmml"><mi id="S2.E1.m1.3.3.2.2.2.2" xref="S2.E1.m1.3.3.2.2.2.2.cmml">𝒉</mi><mn id="S2.E1.m1.3.3.2.2.2.3" xref="S2.E1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.E1.m1.4.4.3.3.6" xref="S2.E1.m1.4.4.3.4.cmml">,</mo><mi id="S2.E1.m1.1.1" mathvariant="normal" xref="S2.E1.m1.1.1.cmml">⋯</mi><mo id="S2.E1.m1.4.4.3.3.7" xref="S2.E1.m1.4.4.3.4.cmml">,</mo><msub id="S2.E1.m1.4.4.3.3.3" xref="S2.E1.m1.4.4.3.3.3.cmml"><mi id="S2.E1.m1.4.4.3.3.3.2" xref="S2.E1.m1.4.4.3.3.3.2.cmml">𝒉</mi><mi id="S2.E1.m1.4.4.3.3.3.3" xref="S2.E1.m1.4.4.3.3.3.3.cmml">N</mi></msub><mo id="S2.E1.m1.4.4.3.3.8" xref="S2.E1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><eq id="S2.E1.m1.4.4.4.cmml" xref="S2.E1.m1.4.4.4"></eq><apply id="S2.E1.m1.4.4.5.cmml" xref="S2.E1.m1.4.4.5"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.5.1.cmml" xref="S2.E1.m1.4.4.5">subscript</csymbol><ci id="S2.E1.m1.4.4.5.2.cmml" xref="S2.E1.m1.4.4.5.2">𝑯</ci><cn id="S2.E1.m1.4.4.5.3.cmml" type="integer" xref="S2.E1.m1.4.4.5.3">0</cn></apply><list id="S2.E1.m1.4.4.3.4.cmml" xref="S2.E1.m1.4.4.3.3"><apply id="S2.E1.m1.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.2">𝒉</ci><cn id="S2.E1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.E1.m1.3.3.2.2.2.cmml" xref="S2.E1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.2.2.2.1.cmml" xref="S2.E1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.2.2.2.2.cmml" xref="S2.E1.m1.3.3.2.2.2.2">𝒉</ci><cn id="S2.E1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.E1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">⋯</ci><apply id="S2.E1.m1.4.4.3.3.3.cmml" xref="S2.E1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.3.3.3.1.cmml" xref="S2.E1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.E1.m1.4.4.3.3.3.2.cmml" xref="S2.E1.m1.4.4.3.3.3.2">𝒉</ci><ci id="S2.E1.m1.4.4.3.3.3.3.cmml" xref="S2.E1.m1.4.4.3.3.3.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\boldsymbol{H}_{0}=\left[\boldsymbol{{h}}_{1},\boldsymbol{h}_{2},\cdots,%
\boldsymbol{h}_{N}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.4d">bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = [ bold_italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p1.11">where <math alttext="N" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m1.1"><semantics id="S2.SS2.p1.11.m1.1a"><mi id="S2.SS2.p1.11.m1.1.1" xref="S2.SS2.p1.11.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m1.1b"><ci id="S2.SS2.p1.11.m1.1.1.cmml" xref="S2.SS2.p1.11.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m1.1d">italic_N</annotation></semantics></math> denotes the length of user-item interactions.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>G-Mamba Block</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In this section, we will detail the design of our proposed G-Mamba Block. Starting with the input sequence processed by the Embedding Layer, this block introduces two paralleling paths <em class="ltx_emph ltx_font_italic" id="S2.SS3.p1.1.1">i.e.,</em> PF-Mamba and FE-GRU, which respectively address the context modeling challenge and short sequence modeling challenge. Specifically, for the contextual information loss caused by the unidirectional structure of Mamba <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib9" title="">2023</a>; Kweon et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib20" title="">2021</a>)</cite>, we introduce the Partially Flipped Mamba. It modifies the original unidirectional structure to a bi-directional one by employing a reverse block that partially flips the first <math alttext="r" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_r</annotation></semantics></math> items in the interaction sequence. Next, a Dense Selective Gate is proposed to properly allocate the weights of the two directions depending on the input sequence <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib32" title="">2024</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib44" title="">2024</a>)</cite>. Additionally, for the long-tail user problem, we introduce the Feature Extract GRU, effectively capturing short-term preferences <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib12" title="">2015</a>; Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib18" title="">2019b</a>)</cite>.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.1. </span>Partially Flipped Mamba</h4>
<div class="ltx_para" id="S2.SS3.SSS1.p1">
<p class="ltx_p" id="S2.SS3.SSS1.p1.7">This module is proposed to address the context modeling challenge by leveraging the bi-directional structure.
Current bi-directional methods like Dual-path Mamba <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib14" title="">2024</a>)</cite> or Vision Mamba <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib46" title="">2024</a>)</cite> usually just flip the whole input sentence to enable the global capturing capability. Although it allows the model to have a better understanding of the context, it significantly reduces the influence of short-term patterns in interaction sequences, leading to the loss of important interest dependencies.
To address this issue, we introduce a partial flip method and integrate it with the Mamba block to construct a bi-directional structure. Followed by embedding sequence <math alttext="\boldsymbol{H}_{0}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.1.m1.1"><semantics id="S2.SS3.SSS1.p1.1.m1.1a"><msub id="S2.SS3.SSS1.p1.1.m1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS3.SSS1.p1.1.m1.1.1.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.cmml">𝑯</mi><mn id="S2.SS3.SSS1.p1.1.m1.1.1.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.1.m1.1b"><apply id="S2.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2">𝑯</ci><cn id="S2.SS3.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.1.m1.1c">\boldsymbol{H}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.1.m1.1d">bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.E1" title="In 2.2. Embedding Layer ‣ 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>), the partially flip function adaptively reverses the first <math alttext="n" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.2.m2.1"><semantics id="S2.SS3.SSS1.p1.2.m2.1a"><mi id="S2.SS3.SSS1.p1.2.m2.1.1" xref="S2.SS3.SSS1.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.2.m2.1b"><ci id="S2.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.2.m2.1d">italic_n</annotation></semantics></math> items while remaining the last <math alttext="r" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.3.m3.1"><semantics id="S2.SS3.SSS1.p1.3.m3.1a"><mi id="S2.SS3.SSS1.p1.3.m3.1.1" xref="S2.SS3.SSS1.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.3.m3.1b"><ci id="S2.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.3.m3.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.3.m3.1d">italic_r</annotation></semantics></math> items in the input tensor from <math alttext="\boldsymbol{H}_{0}=\left[\boldsymbol{h}_{1},\boldsymbol{h}_{2},\cdots,%
\boldsymbol{h}_{n},\boldsymbol{h}_{n+1}\cdots,\boldsymbol{h}_{N}\right]" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.4.m4.6"><semantics id="S2.SS3.SSS1.p1.4.m4.6a"><mrow id="S2.SS3.SSS1.p1.4.m4.6.6" xref="S2.SS3.SSS1.p1.4.m4.6.6.cmml"><msub id="S2.SS3.SSS1.p1.4.m4.6.6.7" xref="S2.SS3.SSS1.p1.4.m4.6.6.7.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.6.6.7.2" xref="S2.SS3.SSS1.p1.4.m4.6.6.7.2.cmml">𝑯</mi><mn id="S2.SS3.SSS1.p1.4.m4.6.6.7.3" xref="S2.SS3.SSS1.p1.4.m4.6.6.7.3.cmml">0</mn></msub><mo id="S2.SS3.SSS1.p1.4.m4.6.6.6" xref="S2.SS3.SSS1.p1.4.m4.6.6.6.cmml">=</mo><mrow id="S2.SS3.SSS1.p1.4.m4.6.6.5.5" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml"><mo id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.6" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml">[</mo><msub id="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1" xref="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.2" xref="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.2.cmml">𝒉</mi><mn id="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.3" xref="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.7" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml">,</mo><msub id="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2" xref="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.2" xref="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.2.cmml">𝒉</mi><mn id="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.3" xref="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.8" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml">,</mo><mi id="S2.SS3.SSS1.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS3.SSS1.p1.4.m4.1.1.cmml">⋯</mi><mo id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.9" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml">,</mo><msub id="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3" xref="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.2" xref="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.2.cmml">𝒉</mi><mi id="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.3" xref="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.10" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml">,</mo><mrow id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.cmml"><msub id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.2" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.2.cmml">𝒉</mi><mrow id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.2" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.2.cmml">n</mi><mo id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.1" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.1.cmml">+</mo><mn id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.3" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.1" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.1.cmml">⁢</mo><mi id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.3" mathvariant="normal" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.3.cmml">⋯</mi></mrow><mo id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.11" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml">,</mo><msub id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.2" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.2.cmml">𝒉</mi><mi id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.3" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.3.cmml">N</mi></msub><mo id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.12" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.4.m4.6b"><apply id="S2.SS3.SSS1.p1.4.m4.6.6.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6"><eq id="S2.SS3.SSS1.p1.4.m4.6.6.6.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.6"></eq><apply id="S2.SS3.SSS1.p1.4.m4.6.6.7.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.7"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.4.m4.6.6.7.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.7">subscript</csymbol><ci id="S2.SS3.SSS1.p1.4.m4.6.6.7.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.7.2">𝑯</ci><cn id="S2.SS3.SSS1.p1.4.m4.6.6.7.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.4.m4.6.6.7.3">0</cn></apply><list id="S2.SS3.SSS1.p1.4.m4.6.6.5.6.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.5"><apply id="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.2">𝒉</ci><cn id="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.4.m4.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.2">𝒉</ci><cn id="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1">⋯</ci><apply id="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.cmml" xref="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.2">𝒉</ci><ci id="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.3.cmml" xref="S2.SS3.SSS1.p1.4.m4.4.4.3.3.3.3">𝑛</ci></apply><apply id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4"><times id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.1"></times><apply id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.2">𝒉</ci><apply id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3"><plus id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.1"></plus><ci id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.2">𝑛</ci><cn id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.2.3.3">1</cn></apply></apply><ci id="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.3.cmml" xref="S2.SS3.SSS1.p1.4.m4.5.5.4.4.4.3">⋯</ci></apply><apply id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5">subscript</csymbol><ci id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.2">𝒉</ci><ci id="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.3.cmml" xref="S2.SS3.SSS1.p1.4.m4.6.6.5.5.5.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.4.m4.6c">\boldsymbol{H}_{0}=\left[\boldsymbol{h}_{1},\boldsymbol{h}_{2},\cdots,%
\boldsymbol{h}_{n},\boldsymbol{h}_{n+1}\cdots,\boldsymbol{h}_{N}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.4.m4.6d">bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = [ bold_italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_italic_h start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , bold_italic_h start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT ⋯ , bold_italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ]</annotation></semantics></math> to <math alttext="\boldsymbol{H}_{0}^{f}=\left[\boldsymbol{h}_{n},\cdots,\boldsymbol{h}_{2},%
\boldsymbol{h}_{1},\boldsymbol{h}_{n+1},\cdots,\boldsymbol{h}_{N}\right]" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.5.m5.7"><semantics id="S2.SS3.SSS1.p1.5.m5.7a"><mrow id="S2.SS3.SSS1.p1.5.m5.7.7" xref="S2.SS3.SSS1.p1.5.m5.7.7.cmml"><msubsup id="S2.SS3.SSS1.p1.5.m5.7.7.7" xref="S2.SS3.SSS1.p1.5.m5.7.7.7.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.7.7.7.2.2" xref="S2.SS3.SSS1.p1.5.m5.7.7.7.2.2.cmml">𝑯</mi><mn id="S2.SS3.SSS1.p1.5.m5.7.7.7.2.3" xref="S2.SS3.SSS1.p1.5.m5.7.7.7.2.3.cmml">0</mn><mi id="S2.SS3.SSS1.p1.5.m5.7.7.7.3" xref="S2.SS3.SSS1.p1.5.m5.7.7.7.3.cmml">f</mi></msubsup><mo id="S2.SS3.SSS1.p1.5.m5.7.7.6" xref="S2.SS3.SSS1.p1.5.m5.7.7.6.cmml">=</mo><mrow id="S2.SS3.SSS1.p1.5.m5.7.7.5.5" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml"><mo id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.6" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml">[</mo><msub id="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1" xref="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.2" xref="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.2.cmml">𝒉</mi><mi id="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.3" xref="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.3.cmml">n</mi></msub><mo id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.7" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml">,</mo><mi id="S2.SS3.SSS1.p1.5.m5.1.1" mathvariant="normal" xref="S2.SS3.SSS1.p1.5.m5.1.1.cmml">⋯</mi><mo id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.8" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml">,</mo><msub id="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2" xref="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.2" xref="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.2.cmml">𝒉</mi><mn id="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.3" xref="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.9" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml">,</mo><msub id="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3" xref="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.2" xref="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.2.cmml">𝒉</mi><mn id="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.3" xref="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.3.cmml">1</mn></msub><mo id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.10" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml">,</mo><msub id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.2" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.2.cmml">𝒉</mi><mrow id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.2" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.2.cmml">n</mi><mo id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.1" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.1.cmml">+</mo><mn id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.3" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.11" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml">,</mo><mi id="S2.SS3.SSS1.p1.5.m5.2.2" mathvariant="normal" xref="S2.SS3.SSS1.p1.5.m5.2.2.cmml">⋯</mi><mo id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.12" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml">,</mo><msub id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.2" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.2.cmml">𝒉</mi><mi id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.3" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.3.cmml">N</mi></msub><mo id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.13" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.5.m5.7b"><apply id="S2.SS3.SSS1.p1.5.m5.7.7.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7"><eq id="S2.SS3.SSS1.p1.5.m5.7.7.6.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.6"></eq><apply id="S2.SS3.SSS1.p1.5.m5.7.7.7.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.7"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.7.7.7.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.7">superscript</csymbol><apply id="S2.SS3.SSS1.p1.5.m5.7.7.7.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.7"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.7.7.7.2.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.7">subscript</csymbol><ci id="S2.SS3.SSS1.p1.5.m5.7.7.7.2.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.7.2.2">𝑯</ci><cn id="S2.SS3.SSS1.p1.5.m5.7.7.7.2.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.5.m5.7.7.7.2.3">0</cn></apply><ci id="S2.SS3.SSS1.p1.5.m5.7.7.7.3.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.7.3">𝑓</ci></apply><list id="S2.SS3.SSS1.p1.5.m5.7.7.5.6.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.5"><apply id="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.2">𝒉</ci><ci id="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.5.m5.3.3.1.1.1.3">𝑛</ci></apply><ci id="S2.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1">⋯</ci><apply id="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.2">𝒉</ci><cn id="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.5.m5.4.4.2.2.2.3">2</cn></apply><apply id="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.cmml" xref="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.2">𝒉</ci><cn id="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.5.m5.5.5.3.3.3.3">1</cn></apply><apply id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.cmml" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4">subscript</csymbol><ci id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.2">𝒉</ci><apply id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.cmml" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3"><plus id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.1"></plus><ci id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.2">𝑛</ci><cn id="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.5.m5.6.6.4.4.4.3.3">1</cn></apply></apply><ci id="S2.SS3.SSS1.p1.5.m5.2.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.2.2">⋯</ci><apply id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5">subscript</csymbol><ci id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.2">𝒉</ci><ci id="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.3.cmml" xref="S2.SS3.SSS1.p1.5.m5.7.7.5.5.5.3">𝑁</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.5.m5.7c">\boldsymbol{H}_{0}^{f}=\left[\boldsymbol{h}_{n},\cdots,\boldsymbol{h}_{2},%
\boldsymbol{h}_{1},\boldsymbol{h}_{n+1},\cdots,\boldsymbol{h}_{N}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.5.m5.7d">bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT = [ bold_italic_h start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , ⋯ , bold_italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , bold_italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_h start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT , ⋯ , bold_italic_h start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ]</annotation></semantics></math>. <math alttext="r" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.6.m6.1"><semantics id="S2.SS3.SSS1.p1.6.m6.1a"><mi id="S2.SS3.SSS1.p1.6.m6.1.1" xref="S2.SS3.SSS1.p1.6.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.6.m6.1b"><ci id="S2.SS3.SSS1.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS1.p1.6.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.6.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.6.m6.1d">italic_r</annotation></semantics></math> is a pre-defined hyperparameter that equals <math alttext="N-n" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.7.m7.1"><semantics id="S2.SS3.SSS1.p1.7.m7.1a"><mrow id="S2.SS3.SSS1.p1.7.m7.1.1" xref="S2.SS3.SSS1.p1.7.m7.1.1.cmml"><mi id="S2.SS3.SSS1.p1.7.m7.1.1.2" xref="S2.SS3.SSS1.p1.7.m7.1.1.2.cmml">N</mi><mo id="S2.SS3.SSS1.p1.7.m7.1.1.1" xref="S2.SS3.SSS1.p1.7.m7.1.1.1.cmml">−</mo><mi id="S2.SS3.SSS1.p1.7.m7.1.1.3" xref="S2.SS3.SSS1.p1.7.m7.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.7.m7.1b"><apply id="S2.SS3.SSS1.p1.7.m7.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1"><minus id="S2.SS3.SSS1.p1.7.m7.1.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.1"></minus><ci id="S2.SS3.SSS1.p1.7.m7.1.1.2.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.2">𝑁</ci><ci id="S2.SS3.SSS1.p1.7.m7.1.1.3.cmml" xref="S2.SS3.SSS1.p1.7.m7.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.7.m7.1c">N-n</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.7.m7.1d">italic_N - italic_n</annotation></semantics></math>, which determines the range of the remaining items, <em class="ltx_emph ltx_font_italic" id="S2.SS3.SSS1.p1.7.1">i.e.,</em> what extent we focus on the short-term preferences.
After processing the input sequence, we utilize two Mamba blocks to construct a bi-directional architecture and process these two sequences as follows:
</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E2X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{{M}}_{0}" class="ltx_Math" display="inline" id="S2.E2X.2.1.1.m1.1"><semantics id="S2.E2X.2.1.1.m1.1a"><msub id="S2.E2X.2.1.1.m1.1.1" xref="S2.E2X.2.1.1.m1.1.1.cmml"><mi id="S2.E2X.2.1.1.m1.1.1.2" xref="S2.E2X.2.1.1.m1.1.1.2.cmml">𝑴</mi><mn id="S2.E2X.2.1.1.m1.1.1.3" xref="S2.E2X.2.1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.E2X.2.1.1.m1.1b"><apply id="S2.E2X.2.1.1.m1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.1.1.2">𝑴</ci><cn id="S2.E2X.2.1.1.m1.1.1.3.cmml" type="integer" xref="S2.E2X.2.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.2.1.1.m1.1c">\displaystyle\boldsymbol{{M}}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.E2X.2.1.1.m1.1d">bold_italic_M start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Mamba}\left(\boldsymbol{H}_{0}\right)\in\mathbb{R}%
^{L\times D}" class="ltx_Math" display="inline" id="S2.E2X.3.2.2.m1.2"><semantics id="S2.E2X.3.2.2.m1.2a"><mrow id="S2.E2X.3.2.2.m1.2.2" xref="S2.E2X.3.2.2.m1.2.2.cmml"><mi id="S2.E2X.3.2.2.m1.2.2.3" xref="S2.E2X.3.2.2.m1.2.2.3.cmml"></mi><mo id="S2.E2X.3.2.2.m1.2.2.4" xref="S2.E2X.3.2.2.m1.2.2.4.cmml">=</mo><mrow id="S2.E2X.3.2.2.m1.2.2.1.1" xref="S2.E2X.3.2.2.m1.2.2.1.2.cmml"><mi id="S2.E2X.3.2.2.m1.1.1" xref="S2.E2X.3.2.2.m1.1.1.cmml">Mamba</mi><mo id="S2.E2X.3.2.2.m1.2.2.1.1a" xref="S2.E2X.3.2.2.m1.2.2.1.2.cmml">⁡</mo><mrow id="S2.E2X.3.2.2.m1.2.2.1.1.1" xref="S2.E2X.3.2.2.m1.2.2.1.2.cmml"><mo id="S2.E2X.3.2.2.m1.2.2.1.1.1.2" xref="S2.E2X.3.2.2.m1.2.2.1.2.cmml">(</mo><msub id="S2.E2X.3.2.2.m1.2.2.1.1.1.1" xref="S2.E2X.3.2.2.m1.2.2.1.1.1.1.cmml"><mi id="S2.E2X.3.2.2.m1.2.2.1.1.1.1.2" xref="S2.E2X.3.2.2.m1.2.2.1.1.1.1.2.cmml">𝑯</mi><mn id="S2.E2X.3.2.2.m1.2.2.1.1.1.1.3" xref="S2.E2X.3.2.2.m1.2.2.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E2X.3.2.2.m1.2.2.1.1.1.3" xref="S2.E2X.3.2.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2X.3.2.2.m1.2.2.5" xref="S2.E2X.3.2.2.m1.2.2.5.cmml">∈</mo><msup id="S2.E2X.3.2.2.m1.2.2.6" xref="S2.E2X.3.2.2.m1.2.2.6.cmml"><mi id="S2.E2X.3.2.2.m1.2.2.6.2" xref="S2.E2X.3.2.2.m1.2.2.6.2.cmml">ℝ</mi><mrow id="S2.E2X.3.2.2.m1.2.2.6.3" xref="S2.E2X.3.2.2.m1.2.2.6.3.cmml"><mi id="S2.E2X.3.2.2.m1.2.2.6.3.2" xref="S2.E2X.3.2.2.m1.2.2.6.3.2.cmml">L</mi><mo id="S2.E2X.3.2.2.m1.2.2.6.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E2X.3.2.2.m1.2.2.6.3.1.cmml">×</mo><mi id="S2.E2X.3.2.2.m1.2.2.6.3.3" xref="S2.E2X.3.2.2.m1.2.2.6.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.3.2.2.m1.2b"><apply id="S2.E2X.3.2.2.m1.2.2.cmml" xref="S2.E2X.3.2.2.m1.2.2"><and id="S2.E2X.3.2.2.m1.2.2a.cmml" xref="S2.E2X.3.2.2.m1.2.2"></and><apply id="S2.E2X.3.2.2.m1.2.2b.cmml" xref="S2.E2X.3.2.2.m1.2.2"><eq id="S2.E2X.3.2.2.m1.2.2.4.cmml" xref="S2.E2X.3.2.2.m1.2.2.4"></eq><csymbol cd="latexml" id="S2.E2X.3.2.2.m1.2.2.3.cmml" xref="S2.E2X.3.2.2.m1.2.2.3">absent</csymbol><apply id="S2.E2X.3.2.2.m1.2.2.1.2.cmml" xref="S2.E2X.3.2.2.m1.2.2.1.1"><ci id="S2.E2X.3.2.2.m1.1.1.cmml" xref="S2.E2X.3.2.2.m1.1.1">Mamba</ci><apply id="S2.E2X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2X.3.2.2.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E2X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2X.3.2.2.m1.2.2.1.1.1.1.2">𝑯</ci><cn id="S2.E2X.3.2.2.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.E2X.3.2.2.m1.2.2.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S2.E2X.3.2.2.m1.2.2c.cmml" xref="S2.E2X.3.2.2.m1.2.2"><in id="S2.E2X.3.2.2.m1.2.2.5.cmml" xref="S2.E2X.3.2.2.m1.2.2.5"></in><share href="https://arxiv.org/html/2408.11451v2#S2.E2X.3.2.2.m1.2.2.1.cmml" id="S2.E2X.3.2.2.m1.2.2d.cmml" xref="S2.E2X.3.2.2.m1.2.2"></share><apply id="S2.E2X.3.2.2.m1.2.2.6.cmml" xref="S2.E2X.3.2.2.m1.2.2.6"><csymbol cd="ambiguous" id="S2.E2X.3.2.2.m1.2.2.6.1.cmml" xref="S2.E2X.3.2.2.m1.2.2.6">superscript</csymbol><ci id="S2.E2X.3.2.2.m1.2.2.6.2.cmml" xref="S2.E2X.3.2.2.m1.2.2.6.2">ℝ</ci><apply id="S2.E2X.3.2.2.m1.2.2.6.3.cmml" xref="S2.E2X.3.2.2.m1.2.2.6.3"><times id="S2.E2X.3.2.2.m1.2.2.6.3.1.cmml" xref="S2.E2X.3.2.2.m1.2.2.6.3.1"></times><ci id="S2.E2X.3.2.2.m1.2.2.6.3.2.cmml" xref="S2.E2X.3.2.2.m1.2.2.6.3.2">𝐿</ci><ci id="S2.E2X.3.2.2.m1.2.2.6.3.3.cmml" xref="S2.E2X.3.2.2.m1.2.2.6.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.3.2.2.m1.2c">\displaystyle=\operatorname{Mamba}\left(\boldsymbol{H}_{0}\right)\in\mathbb{R}%
^{L\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.E2X.3.2.2.m1.2d">= roman_Mamba ( bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E2Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{{M}}_{0}^{f}" class="ltx_Math" display="inline" id="S2.E2Xa.2.1.1.m1.1"><semantics id="S2.E2Xa.2.1.1.m1.1a"><msubsup id="S2.E2Xa.2.1.1.m1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.1.1.2.2" xref="S2.E2Xa.2.1.1.m1.1.1.2.2.cmml">𝑴</mi><mn id="S2.E2Xa.2.1.1.m1.1.1.2.3" xref="S2.E2Xa.2.1.1.m1.1.1.2.3.cmml">0</mn><mi id="S2.E2Xa.2.1.1.m1.1.1.3" xref="S2.E2Xa.2.1.1.m1.1.1.3.cmml">f</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E2Xa.2.1.1.m1.1b"><apply id="S2.E2Xa.2.1.1.m1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1">superscript</csymbol><apply id="S2.E2Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.1.1.2.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.1.1.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.2.2">𝑴</ci><cn id="S2.E2Xa.2.1.1.m1.1.1.2.3.cmml" type="integer" xref="S2.E2Xa.2.1.1.m1.1.1.2.3">0</cn></apply><ci id="S2.E2Xa.2.1.1.m1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xa.2.1.1.m1.1c">\displaystyle\boldsymbol{{M}}_{0}^{f}</annotation><annotation encoding="application/x-llamapun" id="S2.E2Xa.2.1.1.m1.1d">bold_italic_M start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Mamba}\left(\boldsymbol{H}_{0}^{f}\right)\in%
\mathbb{R}^{L\times D}" class="ltx_Math" display="inline" id="S2.E2Xa.3.2.2.m1.2"><semantics id="S2.E2Xa.3.2.2.m1.2a"><mrow id="S2.E2Xa.3.2.2.m1.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.cmml"><mi id="S2.E2Xa.3.2.2.m1.2.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.3.cmml"></mi><mo id="S2.E2Xa.3.2.2.m1.2.2.4" xref="S2.E2Xa.3.2.2.m1.2.2.4.cmml">=</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml"><mi id="S2.E2Xa.3.2.2.m1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.cmml">Mamba</mi><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1a" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml">⁡</mo><mrow id="S2.E2Xa.3.2.2.m1.2.2.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml"><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml">(</mo><msubsup id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.cmml"><mi id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.2.cmml">𝑯</mi><mn id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.3.cmml">0</mn><mi id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml">f</mi></msubsup><mo id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2Xa.3.2.2.m1.2.2.5" xref="S2.E2Xa.3.2.2.m1.2.2.5.cmml">∈</mo><msup id="S2.E2Xa.3.2.2.m1.2.2.6" xref="S2.E2Xa.3.2.2.m1.2.2.6.cmml"><mi id="S2.E2Xa.3.2.2.m1.2.2.6.2" xref="S2.E2Xa.3.2.2.m1.2.2.6.2.cmml">ℝ</mi><mrow id="S2.E2Xa.3.2.2.m1.2.2.6.3" xref="S2.E2Xa.3.2.2.m1.2.2.6.3.cmml"><mi id="S2.E2Xa.3.2.2.m1.2.2.6.3.2" xref="S2.E2Xa.3.2.2.m1.2.2.6.3.2.cmml">L</mi><mo id="S2.E2Xa.3.2.2.m1.2.2.6.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E2Xa.3.2.2.m1.2.2.6.3.1.cmml">×</mo><mi id="S2.E2Xa.3.2.2.m1.2.2.6.3.3" xref="S2.E2Xa.3.2.2.m1.2.2.6.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xa.3.2.2.m1.2b"><apply id="S2.E2Xa.3.2.2.m1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2"><and id="S2.E2Xa.3.2.2.m1.2.2a.cmml" xref="S2.E2Xa.3.2.2.m1.2.2"></and><apply id="S2.E2Xa.3.2.2.m1.2.2b.cmml" xref="S2.E2Xa.3.2.2.m1.2.2"><eq id="S2.E2Xa.3.2.2.m1.2.2.4.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.4"></eq><csymbol cd="latexml" id="S2.E2Xa.3.2.2.m1.2.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.3">absent</csymbol><apply id="S2.E2Xa.3.2.2.m1.2.2.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1"><ci id="S2.E2Xa.3.2.2.m1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1">Mamba</ci><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.2">𝑯</ci><cn id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.2.3">0</cn></apply><ci id="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.1.1.1.1.3">𝑓</ci></apply></apply></apply><apply id="S2.E2Xa.3.2.2.m1.2.2c.cmml" xref="S2.E2Xa.3.2.2.m1.2.2"><in id="S2.E2Xa.3.2.2.m1.2.2.5.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.5"></in><share href="https://arxiv.org/html/2408.11451v2#S2.E2Xa.3.2.2.m1.2.2.1.cmml" id="S2.E2Xa.3.2.2.m1.2.2d.cmml" xref="S2.E2Xa.3.2.2.m1.2.2"></share><apply id="S2.E2Xa.3.2.2.m1.2.2.6.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.6"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.2.2.6.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.6">superscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.2.2.6.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.6.2">ℝ</ci><apply id="S2.E2Xa.3.2.2.m1.2.2.6.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.6.3"><times id="S2.E2Xa.3.2.2.m1.2.2.6.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.6.3.1"></times><ci id="S2.E2Xa.3.2.2.m1.2.2.6.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.6.3.2">𝐿</ci><ci id="S2.E2Xa.3.2.2.m1.2.2.6.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.6.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xa.3.2.2.m1.2c">\displaystyle=\operatorname{Mamba}\left(\boldsymbol{H}_{0}^{f}\right)\in%
\mathbb{R}^{L\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.E2Xa.3.2.2.m1.2d">= roman_Mamba ( bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS1.p1.9">where <math alttext="{L}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.8.m1.1"><semantics id="S2.SS3.SSS1.p1.8.m1.1a"><mi id="S2.SS3.SSS1.p1.8.m1.1.1" xref="S2.SS3.SSS1.p1.8.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.8.m1.1b"><ci id="S2.SS3.SSS1.p1.8.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.8.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.8.m1.1c">{L}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.8.m1.1d">italic_L</annotation></semantics></math> and <math alttext="{D}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.9.m2.1"><semantics id="S2.SS3.SSS1.p1.9.m2.1a"><mi id="S2.SS3.SSS1.p1.9.m2.1.1" xref="S2.SS3.SSS1.p1.9.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.9.m2.1b"><ci id="S2.SS3.SSS1.p1.9.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.9.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.9.m2.1c">{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.9.m2.1d">italic_D</annotation></semantics></math> respectively represent the sequence length and hidden dimension at each time step.
These two feature representations will then get a dot product with an input-dependent DS Gate to further learn the user preferences.
</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\boldsymbol{M}}_{0}=\mathcal{G}_{1}\left(\boldsymbol{H}_{0}\right)\cdot%
\boldsymbol{M}_{0}+\mathcal{G}_{1}\left(\boldsymbol{H}_{0}^{f}\right)\cdot%
\boldsymbol{M}_{0}^{f}" class="ltx_Math" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><msub id="S2.E3.m1.2.2.4" xref="S2.E3.m1.2.2.4.cmml"><mover accent="true" id="S2.E3.m1.2.2.4.2" xref="S2.E3.m1.2.2.4.2.cmml"><mi id="S2.E3.m1.2.2.4.2.2" xref="S2.E3.m1.2.2.4.2.2.cmml">𝑴</mi><mo id="S2.E3.m1.2.2.4.2.1" xref="S2.E3.m1.2.2.4.2.1.cmml">^</mo></mover><mn id="S2.E3.m1.2.2.4.3" xref="S2.E3.m1.2.2.4.3.cmml">0</mn></msub><mo id="S2.E3.m1.2.2.3" xref="S2.E3.m1.2.2.3.cmml">=</mo><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.3.2.cmml">𝒢</mi><mn id="S2.E3.m1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml">𝑯</mi><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E3.m1.1.1.1.1.1.1.1.3" rspace="0.055em" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.2" rspace="0.222em" xref="S2.E3.m1.1.1.1.1.2.cmml">⋅</mo><msub id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">𝑴</mi><mn id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S2.E3.m1.2.2.2.3" xref="S2.E3.m1.2.2.2.3.cmml">+</mo><mrow id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml"><mrow id="S2.E3.m1.2.2.2.2.1" xref="S2.E3.m1.2.2.2.2.1.cmml"><msub id="S2.E3.m1.2.2.2.2.1.3" xref="S2.E3.m1.2.2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.2.2.1.3.2" xref="S2.E3.m1.2.2.2.2.1.3.2.cmml">𝒢</mi><mn id="S2.E3.m1.2.2.2.2.1.3.3" xref="S2.E3.m1.2.2.2.2.1.3.3.cmml">1</mn></msub><mo id="S2.E3.m1.2.2.2.2.1.2" xref="S2.E3.m1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.2.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.2.2.1.1.1.2" xref="S2.E3.m1.2.2.2.2.1.1.1.1.cmml">(</mo><msubsup id="S2.E3.m1.2.2.2.2.1.1.1.1" xref="S2.E3.m1.2.2.2.2.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.2.2.1.1.1.1.2.2" xref="S2.E3.m1.2.2.2.2.1.1.1.1.2.2.cmml">𝑯</mi><mn id="S2.E3.m1.2.2.2.2.1.1.1.1.2.3" xref="S2.E3.m1.2.2.2.2.1.1.1.1.2.3.cmml">0</mn><mi id="S2.E3.m1.2.2.2.2.1.1.1.1.3" xref="S2.E3.m1.2.2.2.2.1.1.1.1.3.cmml">f</mi></msubsup><mo id="S2.E3.m1.2.2.2.2.1.1.1.3" rspace="0.055em" xref="S2.E3.m1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.2.2.2.2.2" rspace="0.222em" xref="S2.E3.m1.2.2.2.2.2.cmml">⋅</mo><msubsup id="S2.E3.m1.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.3.cmml"><mi id="S2.E3.m1.2.2.2.2.3.2.2" xref="S2.E3.m1.2.2.2.2.3.2.2.cmml">𝑴</mi><mn id="S2.E3.m1.2.2.2.2.3.2.3" xref="S2.E3.m1.2.2.2.2.3.2.3.cmml">0</mn><mi id="S2.E3.m1.2.2.2.2.3.3" xref="S2.E3.m1.2.2.2.2.3.3.cmml">f</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><eq id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2.3"></eq><apply id="S2.E3.m1.2.2.4.cmml" xref="S2.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.4.1.cmml" xref="S2.E3.m1.2.2.4">subscript</csymbol><apply id="S2.E3.m1.2.2.4.2.cmml" xref="S2.E3.m1.2.2.4.2"><ci id="S2.E3.m1.2.2.4.2.1.cmml" xref="S2.E3.m1.2.2.4.2.1">^</ci><ci id="S2.E3.m1.2.2.4.2.2.cmml" xref="S2.E3.m1.2.2.4.2.2">𝑴</ci></apply><cn id="S2.E3.m1.2.2.4.3.cmml" type="integer" xref="S2.E3.m1.2.2.4.3">0</cn></apply><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><plus id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.3"></plus><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1"><ci id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2">⋅</ci><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.3.2">𝒢</ci><cn id="S2.E3.m1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.3.3">1</cn></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">𝑯</ci><cn id="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">𝑴</ci><cn id="S2.E3.m1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E3.m1.1.1.1.1.3.3">0</cn></apply></apply><apply id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"><ci id="S2.E3.m1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2">⋅</ci><apply id="S2.E3.m1.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2.1"><times id="S2.E3.m1.2.2.2.2.1.2.cmml" xref="S2.E3.m1.2.2.2.2.1.2"></times><apply id="S2.E3.m1.2.2.2.2.1.3.cmml" xref="S2.E3.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.3.1.cmml" xref="S2.E3.m1.2.2.2.2.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.1.3.2.cmml" xref="S2.E3.m1.2.2.2.2.1.3.2">𝒢</ci><cn id="S2.E3.m1.2.2.2.2.1.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.2.2.1.3.3">1</cn></apply><apply id="S2.E3.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1">superscript</csymbol><apply id="S2.E3.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.1.2.2">𝑯</ci><cn id="S2.E3.m1.2.2.2.2.1.1.1.1.2.3.cmml" type="integer" xref="S2.E3.m1.2.2.2.2.1.1.1.1.2.3">0</cn></apply><ci id="S2.E3.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1.1.3">𝑓</ci></apply></apply><apply id="S2.E3.m1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.3">superscript</csymbol><apply id="S2.E3.m1.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.3.2.1.cmml" xref="S2.E3.m1.2.2.2.2.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.3.2.2.cmml" xref="S2.E3.m1.2.2.2.2.3.2.2">𝑴</ci><cn id="S2.E3.m1.2.2.2.2.3.2.3.cmml" type="integer" xref="S2.E3.m1.2.2.2.2.3.2.3">0</cn></apply><ci id="S2.E3.m1.2.2.2.2.3.3.cmml" xref="S2.E3.m1.2.2.2.2.3.3">𝑓</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\hat{\boldsymbol{M}}_{0}=\mathcal{G}_{1}\left(\boldsymbol{H}_{0}\right)\cdot%
\boldsymbol{M}_{0}+\mathcal{G}_{1}\left(\boldsymbol{H}_{0}^{f}\right)\cdot%
\boldsymbol{M}_{0}^{f}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">over^ start_ARG bold_italic_M end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = caligraphic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ⋅ bold_italic_M start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + caligraphic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT ) ⋅ bold_italic_M start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_f end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS1.p1.11">where <math alttext="\mathcal{G}_{1}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.10.m1.1"><semantics id="S2.SS3.SSS1.p1.10.m1.1a"><msub id="S2.SS3.SSS1.p1.10.m1.1.1" xref="S2.SS3.SSS1.p1.10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS1.p1.10.m1.1.1.2" xref="S2.SS3.SSS1.p1.10.m1.1.1.2.cmml">𝒢</mi><mn id="S2.SS3.SSS1.p1.10.m1.1.1.3" xref="S2.SS3.SSS1.p1.10.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.10.m1.1b"><apply id="S2.SS3.SSS1.p1.10.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.10.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.10.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.10.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.10.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.10.m1.1.1.2">𝒢</ci><cn id="S2.SS3.SSS1.p1.10.m1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.10.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.10.m1.1c">\mathcal{G}_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.10.m1.1d">caligraphic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> represents the designed DS Gate and <math alttext="\hat{\boldsymbol{M}}_{0}={\left[\boldsymbol{m}_{1},\boldsymbol{m}_{2},\cdots,%
\boldsymbol{m}_{N}\right]}^{T}" class="ltx_Math" display="inline" id="S2.SS3.SSS1.p1.11.m2.4"><semantics id="S2.SS3.SSS1.p1.11.m2.4a"><mrow id="S2.SS3.SSS1.p1.11.m2.4.4" xref="S2.SS3.SSS1.p1.11.m2.4.4.cmml"><msub id="S2.SS3.SSS1.p1.11.m2.4.4.5" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.cmml"><mover accent="true" id="S2.SS3.SSS1.p1.11.m2.4.4.5.2" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.2.cmml"><mi id="S2.SS3.SSS1.p1.11.m2.4.4.5.2.2" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.2.2.cmml">𝑴</mi><mo id="S2.SS3.SSS1.p1.11.m2.4.4.5.2.1" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.2.1.cmml">^</mo></mover><mn id="S2.SS3.SSS1.p1.11.m2.4.4.5.3" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.3.cmml">0</mn></msub><mo id="S2.SS3.SSS1.p1.11.m2.4.4.4" xref="S2.SS3.SSS1.p1.11.m2.4.4.4.cmml">=</mo><msup id="S2.SS3.SSS1.p1.11.m2.4.4.3" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.cmml"><mrow id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.4.cmml"><mo id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.4" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.4.cmml">[</mo><msub id="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1" xref="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.cmml"><mi id="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.2" xref="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.2.cmml">𝒎</mi><mn id="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.3" xref="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.5" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.4.cmml">,</mo><msub id="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2" xref="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.cmml"><mi id="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.2" xref="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.2.cmml">𝒎</mi><mn id="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.3" xref="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.6" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.4.cmml">,</mo><mi id="S2.SS3.SSS1.p1.11.m2.1.1" mathvariant="normal" xref="S2.SS3.SSS1.p1.11.m2.1.1.cmml">⋯</mi><mo id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.7" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.4.cmml">,</mo><msub id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.cmml"><mi id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.2" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.2.cmml">𝒎</mi><mi id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.3" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.3.cmml">N</mi></msub><mo id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.8" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.4.cmml">]</mo></mrow><mi id="S2.SS3.SSS1.p1.11.m2.4.4.3.5" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.5.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.11.m2.4b"><apply id="S2.SS3.SSS1.p1.11.m2.4.4.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4"><eq id="S2.SS3.SSS1.p1.11.m2.4.4.4.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.4"></eq><apply id="S2.SS3.SSS1.p1.11.m2.4.4.5.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.5"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m2.4.4.5.1.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.5">subscript</csymbol><apply id="S2.SS3.SSS1.p1.11.m2.4.4.5.2.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.2"><ci id="S2.SS3.SSS1.p1.11.m2.4.4.5.2.1.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.2.1">^</ci><ci id="S2.SS3.SSS1.p1.11.m2.4.4.5.2.2.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.2.2">𝑴</ci></apply><cn id="S2.SS3.SSS1.p1.11.m2.4.4.5.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.11.m2.4.4.5.3">0</cn></apply><apply id="S2.SS3.SSS1.p1.11.m2.4.4.3.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m2.4.4.3.4.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.3">superscript</csymbol><list id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.4.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3"><apply id="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.2">𝒎</ci><cn id="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.11.m2.2.2.1.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.1.cmml" xref="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.2">𝒎</ci><cn id="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS1.p1.11.m2.3.3.2.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS1.p1.11.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.11.m2.1.1">⋯</ci><apply id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.1.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.2.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.2">𝒎</ci><ci id="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.3.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.3.3.3.3">𝑁</ci></apply></list><ci id="S2.SS3.SSS1.p1.11.m2.4.4.3.5.cmml" xref="S2.SS3.SSS1.p1.11.m2.4.4.3.5">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.11.m2.4c">\hat{\boldsymbol{M}}_{0}={\left[\boldsymbol{m}_{1},\boldsymbol{m}_{2},\cdots,%
\boldsymbol{m}_{N}\right]}^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS1.p1.11.m2.4d">over^ start_ARG bold_italic_M end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = [ bold_italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_italic_m start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the output from PF-Mamba.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.2. </span>Dense Selective Gate</h4>
<div class="ltx_para" id="S2.SS3.SSS2.p1">
<p class="ltx_p" id="S2.SS3.SSS2.p1.11">To allocate the weights of two Mamba blocks and further filter the information according to the input sequence, we design an input-dependent Dense Selective Gate. It starts with a dense layer and a Conv1d layer to extract the original sequential information from the context, which can be formalized as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{G}_{0}=\operatorname{Conv1d}\left(\boldsymbol{H}_{0}\boldsymbol{W}%
_{\sigma}^{\mathit{(1)}}+b_{\sigma}^{\mathit{(1)}}\right)" class="ltx_Math" display="block" id="S2.E4.m1.4"><semantics id="S2.E4.m1.4a"><mrow id="S2.E4.m1.4.4" xref="S2.E4.m1.4.4.cmml"><msub id="S2.E4.m1.4.4.3" xref="S2.E4.m1.4.4.3.cmml"><mi id="S2.E4.m1.4.4.3.2" xref="S2.E4.m1.4.4.3.2.cmml">𝑮</mi><mn id="S2.E4.m1.4.4.3.3" xref="S2.E4.m1.4.4.3.3.cmml">0</mn></msub><mo id="S2.E4.m1.4.4.2" xref="S2.E4.m1.4.4.2.cmml">=</mo><mrow id="S2.E4.m1.4.4.1.1" xref="S2.E4.m1.4.4.1.2.cmml"><mi id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml">Conv1d</mi><mo id="S2.E4.m1.4.4.1.1a" xref="S2.E4.m1.4.4.1.2.cmml">⁡</mo><mrow id="S2.E4.m1.4.4.1.1.1" xref="S2.E4.m1.4.4.1.2.cmml"><mo id="S2.E4.m1.4.4.1.1.1.2" xref="S2.E4.m1.4.4.1.2.cmml">(</mo><mrow id="S2.E4.m1.4.4.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.2.cmml"><msub id="S2.E4.m1.4.4.1.1.1.1.2.2" xref="S2.E4.m1.4.4.1.1.1.1.2.2.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.2.2.2" xref="S2.E4.m1.4.4.1.1.1.1.2.2.2.cmml">𝑯</mi><mn id="S2.E4.m1.4.4.1.1.1.1.2.2.3" xref="S2.E4.m1.4.4.1.1.1.1.2.2.3.cmml">0</mn></msub><mo id="S2.E4.m1.4.4.1.1.1.1.2.1" xref="S2.E4.m1.4.4.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S2.E4.m1.4.4.1.1.1.1.2.3" xref="S2.E4.m1.4.4.1.1.1.1.2.3.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.2.3.2.2" xref="S2.E4.m1.4.4.1.1.1.1.2.3.2.2.cmml">𝑾</mi><mi id="S2.E4.m1.4.4.1.1.1.1.2.3.2.3" xref="S2.E4.m1.4.4.1.1.1.1.2.3.2.3.cmml">σ</mi><mrow id="S2.E4.m1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.2.3.cmml"><mo id="S2.E4.m1.1.1.1.3.1" stretchy="false" xref="S2.E4.m1.4.4.1.1.1.1.2.3.cmml">(</mo><mn class="ltx_mathvariant_italic" id="S2.E4.m1.1.1.1.1" mathvariant="italic" xref="S2.E4.m1.1.1.1.1.cmml">1</mn><mo id="S2.E4.m1.1.1.1.3.2" stretchy="false" xref="S2.E4.m1.4.4.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E4.m1.4.4.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.cmml">+</mo><msubsup id="S2.E4.m1.4.4.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.3.2.2" xref="S2.E4.m1.4.4.1.1.1.1.3.2.2.cmml">b</mi><mi id="S2.E4.m1.4.4.1.1.1.1.3.2.3" xref="S2.E4.m1.4.4.1.1.1.1.3.2.3.cmml">σ</mi><mrow id="S2.E4.m1.2.2.1.3" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml"><mo id="S2.E4.m1.2.2.1.3.1" stretchy="false" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml">(</mo><mn class="ltx_mathvariant_italic" id="S2.E4.m1.2.2.1.1" mathvariant="italic" xref="S2.E4.m1.2.2.1.1.cmml">1</mn><mo id="S2.E4.m1.2.2.1.3.2" stretchy="false" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E4.m1.4.4.1.1.1.3" xref="S2.E4.m1.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.4b"><apply id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4"><eq id="S2.E4.m1.4.4.2.cmml" xref="S2.E4.m1.4.4.2"></eq><apply id="S2.E4.m1.4.4.3.cmml" xref="S2.E4.m1.4.4.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.3.1.cmml" xref="S2.E4.m1.4.4.3">subscript</csymbol><ci id="S2.E4.m1.4.4.3.2.cmml" xref="S2.E4.m1.4.4.3.2">𝑮</ci><cn id="S2.E4.m1.4.4.3.3.cmml" type="integer" xref="S2.E4.m1.4.4.3.3">0</cn></apply><apply id="S2.E4.m1.4.4.1.2.cmml" xref="S2.E4.m1.4.4.1.1"><ci id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3">Conv1d</ci><apply id="S2.E4.m1.4.4.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1"><plus id="S2.E4.m1.4.4.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1"></plus><apply id="S2.E4.m1.4.4.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2"><times id="S2.E4.m1.4.4.1.1.1.1.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.1"></times><apply id="S2.E4.m1.4.4.1.1.1.1.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.2.2">𝑯</ci><cn id="S2.E4.m1.4.4.1.1.1.1.2.2.3.cmml" type="integer" xref="S2.E4.m1.4.4.1.1.1.1.2.2.3">0</cn></apply><apply id="S2.E4.m1.4.4.1.1.1.1.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.2.3.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E4.m1.4.4.1.1.1.1.2.3.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.2.3.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.2.3.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.3.2.2">𝑾</ci><ci id="S2.E4.m1.4.4.1.1.1.1.2.3.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2.3.2.3">𝜎</ci></apply><cn id="S2.E4.m1.1.1.1.1.cmml" type="integer" xref="S2.E4.m1.1.1.1.1">1</cn></apply></apply><apply id="S2.E4.m1.4.4.1.1.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3">superscript</csymbol><apply id="S2.E4.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3.2.2">𝑏</ci><ci id="S2.E4.m1.4.4.1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3.2.3">𝜎</ci></apply><cn id="S2.E4.m1.2.2.1.1.cmml" type="integer" xref="S2.E4.m1.2.2.1.1">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.4c">\boldsymbol{G}_{0}=\operatorname{Conv1d}\left(\boldsymbol{H}_{0}\boldsymbol{W}%
_{\sigma}^{\mathit{(1)}}+b_{\sigma}^{\mathit{(1)}}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.4d">bold_italic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = Conv1d ( bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT bold_italic_W start_POSTSUBSCRIPT italic_σ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_1 ) end_POSTSUPERSCRIPT + italic_b start_POSTSUBSCRIPT italic_σ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_1 ) end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS2.p1.2">where <math alttext="\boldsymbol{H}_{0}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.1.m1.1"><semantics id="S2.SS3.SSS2.p1.1.m1.1a"><msub id="S2.SS3.SSS2.p1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p1.1.m1.1.1.2" xref="S2.SS3.SSS2.p1.1.m1.1.1.2.cmml">𝑯</mi><mn id="S2.SS3.SSS2.p1.1.m1.1.1.3" xref="S2.SS3.SSS2.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.m1.1b"><apply id="S2.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1.2">𝑯</ci><cn id="S2.SS3.SSS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.m1.1c">\boldsymbol{H}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.1.m1.1d">bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is denoted as the output of embedding layer followed by Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.E1" title="In 2.2. Embedding Layer ‣ 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>).
Then, we introduce a forget gate and a <math alttext="\operatorname{SiLU}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.2.m2.1"><semantics id="S2.SS3.SSS2.p1.2.m2.1a"><mi id="S2.SS3.SSS2.p1.2.m2.1.1" xref="S2.SS3.SSS2.p1.2.m2.1.1.cmml">SiLU</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.2.m2.1b"><ci id="S2.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1">SiLU</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.2.m2.1c">\operatorname{SiLU}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.2.m2.1d">roman_SiLU</annotation></semantics></math> gate <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib32" title="">2024</a>)</cite> to generate the weights from the interaction sequence:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E5">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{\delta}_{1}\left(\boldsymbol{{G}}_{0}\right)" class="ltx_Math" display="inline" id="S2.E5X.2.1.1.m1.1"><semantics id="S2.E5X.2.1.1.m1.1a"><mrow id="S2.E5X.2.1.1.m1.1.1" xref="S2.E5X.2.1.1.m1.1.1.cmml"><msub id="S2.E5X.2.1.1.m1.1.1.3" xref="S2.E5X.2.1.1.m1.1.1.3.cmml"><mi id="S2.E5X.2.1.1.m1.1.1.3.2" xref="S2.E5X.2.1.1.m1.1.1.3.2.cmml">𝜹</mi><mn id="S2.E5X.2.1.1.m1.1.1.3.3" xref="S2.E5X.2.1.1.m1.1.1.3.3.cmml">1</mn></msub><mo id="S2.E5X.2.1.1.m1.1.1.2" xref="S2.E5X.2.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.E5X.2.1.1.m1.1.1.1.1" xref="S2.E5X.2.1.1.m1.1.1.1.1.1.cmml"><mo id="S2.E5X.2.1.1.m1.1.1.1.1.2" xref="S2.E5X.2.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.E5X.2.1.1.m1.1.1.1.1.1" xref="S2.E5X.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S2.E5X.2.1.1.m1.1.1.1.1.1.2" xref="S2.E5X.2.1.1.m1.1.1.1.1.1.2.cmml">𝑮</mi><mn id="S2.E5X.2.1.1.m1.1.1.1.1.1.3" xref="S2.E5X.2.1.1.m1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E5X.2.1.1.m1.1.1.1.1.3" xref="S2.E5X.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5X.2.1.1.m1.1b"><apply id="S2.E5X.2.1.1.m1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1"><times id="S2.E5X.2.1.1.m1.1.1.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.2"></times><apply id="S2.E5X.2.1.1.m1.1.1.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.1.1.3.1.cmml" xref="S2.E5X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S2.E5X.2.1.1.m1.1.1.3.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.3.2">𝜹</ci><cn id="S2.E5X.2.1.1.m1.1.1.3.3.cmml" type="integer" xref="S2.E5X.2.1.1.m1.1.1.3.3">1</cn></apply><apply id="S2.E5X.2.1.1.m1.1.1.1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.E5X.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.1.1.1.2">𝑮</ci><cn id="S2.E5X.2.1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E5X.2.1.1.m1.1.1.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.2.1.1.m1.1c">\displaystyle\boldsymbol{\delta}_{1}\left(\boldsymbol{{G}}_{0}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E5X.2.1.1.m1.1d">bold_italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_italic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\boldsymbol{{G}}_{0}\boldsymbol{W}_{\delta}^{(1)}+b_{\delta}^{(1)}" class="ltx_Math" display="inline" id="S2.E5X.3.2.2.m1.2"><semantics id="S2.E5X.3.2.2.m1.2a"><mrow id="S2.E5X.3.2.2.m1.2.3" xref="S2.E5X.3.2.2.m1.2.3.cmml"><mi id="S2.E5X.3.2.2.m1.2.3.2" xref="S2.E5X.3.2.2.m1.2.3.2.cmml"></mi><mo id="S2.E5X.3.2.2.m1.2.3.1" xref="S2.E5X.3.2.2.m1.2.3.1.cmml">=</mo><mrow id="S2.E5X.3.2.2.m1.2.3.3" xref="S2.E5X.3.2.2.m1.2.3.3.cmml"><mrow id="S2.E5X.3.2.2.m1.2.3.3.2" xref="S2.E5X.3.2.2.m1.2.3.3.2.cmml"><msub id="S2.E5X.3.2.2.m1.2.3.3.2.2" xref="S2.E5X.3.2.2.m1.2.3.3.2.2.cmml"><mi id="S2.E5X.3.2.2.m1.2.3.3.2.2.2" xref="S2.E5X.3.2.2.m1.2.3.3.2.2.2.cmml">𝑮</mi><mn id="S2.E5X.3.2.2.m1.2.3.3.2.2.3" xref="S2.E5X.3.2.2.m1.2.3.3.2.2.3.cmml">0</mn></msub><mo id="S2.E5X.3.2.2.m1.2.3.3.2.1" xref="S2.E5X.3.2.2.m1.2.3.3.2.1.cmml">⁢</mo><msubsup id="S2.E5X.3.2.2.m1.2.3.3.2.3" xref="S2.E5X.3.2.2.m1.2.3.3.2.3.cmml"><mi id="S2.E5X.3.2.2.m1.2.3.3.2.3.2.2" xref="S2.E5X.3.2.2.m1.2.3.3.2.3.2.2.cmml">𝑾</mi><mi id="S2.E5X.3.2.2.m1.2.3.3.2.3.2.3" xref="S2.E5X.3.2.2.m1.2.3.3.2.3.2.3.cmml">δ</mi><mrow id="S2.E5X.3.2.2.m1.1.1.1.3" xref="S2.E5X.3.2.2.m1.2.3.3.2.3.cmml"><mo id="S2.E5X.3.2.2.m1.1.1.1.3.1" stretchy="false" xref="S2.E5X.3.2.2.m1.2.3.3.2.3.cmml">(</mo><mn id="S2.E5X.3.2.2.m1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.cmml">1</mn><mo id="S2.E5X.3.2.2.m1.1.1.1.3.2" stretchy="false" xref="S2.E5X.3.2.2.m1.2.3.3.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E5X.3.2.2.m1.2.3.3.1" xref="S2.E5X.3.2.2.m1.2.3.3.1.cmml">+</mo><msubsup id="S2.E5X.3.2.2.m1.2.3.3.3" xref="S2.E5X.3.2.2.m1.2.3.3.3.cmml"><mi id="S2.E5X.3.2.2.m1.2.3.3.3.2.2" xref="S2.E5X.3.2.2.m1.2.3.3.3.2.2.cmml">b</mi><mi id="S2.E5X.3.2.2.m1.2.3.3.3.2.3" xref="S2.E5X.3.2.2.m1.2.3.3.3.2.3.cmml">δ</mi><mrow id="S2.E5X.3.2.2.m1.2.2.1.3" xref="S2.E5X.3.2.2.m1.2.3.3.3.cmml"><mo id="S2.E5X.3.2.2.m1.2.2.1.3.1" stretchy="false" xref="S2.E5X.3.2.2.m1.2.3.3.3.cmml">(</mo><mn id="S2.E5X.3.2.2.m1.2.2.1.1" xref="S2.E5X.3.2.2.m1.2.2.1.1.cmml">1</mn><mo id="S2.E5X.3.2.2.m1.2.2.1.3.2" stretchy="false" xref="S2.E5X.3.2.2.m1.2.3.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5X.3.2.2.m1.2b"><apply id="S2.E5X.3.2.2.m1.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.3"><eq id="S2.E5X.3.2.2.m1.2.3.1.cmml" xref="S2.E5X.3.2.2.m1.2.3.1"></eq><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.2.3.2.cmml" xref="S2.E5X.3.2.2.m1.2.3.2">absent</csymbol><apply id="S2.E5X.3.2.2.m1.2.3.3.cmml" xref="S2.E5X.3.2.2.m1.2.3.3"><plus id="S2.E5X.3.2.2.m1.2.3.3.1.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.1"></plus><apply id="S2.E5X.3.2.2.m1.2.3.3.2.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2"><times id="S2.E5X.3.2.2.m1.2.3.3.2.1.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.1"></times><apply id="S2.E5X.3.2.2.m1.2.3.3.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.2.3.3.2.2.1.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.2">subscript</csymbol><ci id="S2.E5X.3.2.2.m1.2.3.3.2.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.2.2">𝑮</ci><cn id="S2.E5X.3.2.2.m1.2.3.3.2.2.3.cmml" type="integer" xref="S2.E5X.3.2.2.m1.2.3.3.2.2.3">0</cn></apply><apply id="S2.E5X.3.2.2.m1.2.3.3.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.2.3.3.2.3.1.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.3">superscript</csymbol><apply id="S2.E5X.3.2.2.m1.2.3.3.2.3.2.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.2.3.3.2.3.2.1.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.3">subscript</csymbol><ci id="S2.E5X.3.2.2.m1.2.3.3.2.3.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.3.2.2">𝑾</ci><ci id="S2.E5X.3.2.2.m1.2.3.3.2.3.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.2.3.2.3">𝛿</ci></apply><cn id="S2.E5X.3.2.2.m1.1.1.1.1.cmml" type="integer" xref="S2.E5X.3.2.2.m1.1.1.1.1">1</cn></apply></apply><apply id="S2.E5X.3.2.2.m1.2.3.3.3.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.2.3.3.3.1.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.3">superscript</csymbol><apply id="S2.E5X.3.2.2.m1.2.3.3.3.2.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.2.3.3.3.2.1.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.3">subscript</csymbol><ci id="S2.E5X.3.2.2.m1.2.3.3.3.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.3.2.2">𝑏</ci><ci id="S2.E5X.3.2.2.m1.2.3.3.3.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.3.3.3.2.3">𝛿</ci></apply><cn id="S2.E5X.3.2.2.m1.2.2.1.1.cmml" type="integer" xref="S2.E5X.3.2.2.m1.2.2.1.1">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.3.2.2.m1.2c">\displaystyle=\boldsymbol{{G}}_{0}\boldsymbol{W}_{\delta}^{(1)}+b_{\delta}^{(1)}</annotation><annotation encoding="application/x-llamapun" id="S2.E5X.3.2.2.m1.2d">= bold_italic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT bold_italic_W start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT + italic_b start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E5Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{G}_{0}(\boldsymbol{{G}_{0}})" class="ltx_Math" display="inline" id="S2.E5Xa.2.1.1.m1.1"><semantics id="S2.E5Xa.2.1.1.m1.1a"><mrow id="S2.E5Xa.2.1.1.m1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.cmml"><msub id="S2.E5Xa.2.1.1.m1.1.1.3" xref="S2.E5Xa.2.1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5Xa.2.1.1.m1.1.1.3.2" xref="S2.E5Xa.2.1.1.m1.1.1.3.2.cmml">𝒢</mi><mn id="S2.E5Xa.2.1.1.m1.1.1.3.3" xref="S2.E5Xa.2.1.1.m1.1.1.3.3.cmml">0</mn></msub><mo id="S2.E5Xa.2.1.1.m1.1.1.2" xref="S2.E5Xa.2.1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xa.2.1.1.m1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.cmml"><mo id="S2.E5Xa.2.1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.E5Xa.2.1.1.m1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.2.cmml">𝑮</mi><mn id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.3.cmml">𝟎</mn></msub><mo id="S2.E5Xa.2.1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xa.2.1.1.m1.1b"><apply id="S2.E5Xa.2.1.1.m1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1"><times id="S2.E5Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.2"></times><apply id="S2.E5Xa.2.1.1.m1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.1.1.3.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.1.1.3.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.3.2">𝒢</ci><cn id="S2.E5Xa.2.1.1.m1.1.1.3.3.cmml" type="integer" xref="S2.E5Xa.2.1.1.m1.1.1.3.3">0</cn></apply><apply id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.2">𝑮</ci><cn id="S2.E5Xa.2.1.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xa.2.1.1.m1.1c">\displaystyle\mathcal{G}_{0}(\boldsymbol{{G}_{0}})</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xa.2.1.1.m1.1d">caligraphic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_G start_POSTSUBSCRIPT bold_0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma\left(\boldsymbol{\delta}_{1}\left({\boldsymbol{G}}_{0}%
\right)\right)" class="ltx_Math" display="inline" id="S2.E5Xa.3.2.2.m1.1"><semantics id="S2.E5Xa.3.2.2.m1.1a"><mrow id="S2.E5Xa.3.2.2.m1.1.1" xref="S2.E5Xa.3.2.2.m1.1.1.cmml"><mi id="S2.E5Xa.3.2.2.m1.1.1.3" xref="S2.E5Xa.3.2.2.m1.1.1.3.cmml"></mi><mo id="S2.E5Xa.3.2.2.m1.1.1.2" xref="S2.E5Xa.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S2.E5Xa.3.2.2.m1.1.1.1" xref="S2.E5Xa.3.2.2.m1.1.1.1.cmml"><mi id="S2.E5Xa.3.2.2.m1.1.1.1.3" xref="S2.E5Xa.3.2.2.m1.1.1.1.3.cmml">σ</mi><mo id="S2.E5Xa.3.2.2.m1.1.1.1.2" xref="S2.E5Xa.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xa.3.2.2.m1.1.1.1.1.1" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.2" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">𝜹</mi><mn id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝑮</mi><mn id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.3" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xa.3.2.2.m1.1b"><apply id="S2.E5Xa.3.2.2.m1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.1.1"><eq id="S2.E5Xa.3.2.2.m1.1.1.2.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S2.E5Xa.3.2.2.m1.1.1.3.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.3">absent</csymbol><apply id="S2.E5Xa.3.2.2.m1.1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1"><times id="S2.E5Xa.3.2.2.m1.1.1.1.2.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.2"></times><ci id="S2.E5Xa.3.2.2.m1.1.1.1.3.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.3">𝜎</ci><apply id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1"><times id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.2"></times><apply id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝜹</ci><cn id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.3.3">1</cn></apply><apply id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.2">𝑮</ci><cn id="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xa.3.2.2.m1.1c">\displaystyle=\sigma\left(\boldsymbol{\delta}_{1}\left({\boldsymbol{G}}_{0}%
\right)\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E5Xa.3.2.2.m1.1d">= italic_σ ( bold_italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_italic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS2.p1.10">where <math alttext="W_{\delta}^{(1)}\in\mathbb{R}^{D\times D}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.3.m1.1"><semantics id="S2.SS3.SSS2.p1.3.m1.1a"><mrow id="S2.SS3.SSS2.p1.3.m1.1.2" xref="S2.SS3.SSS2.p1.3.m1.1.2.cmml"><msubsup id="S2.SS3.SSS2.p1.3.m1.1.2.2" xref="S2.SS3.SSS2.p1.3.m1.1.2.2.cmml"><mi id="S2.SS3.SSS2.p1.3.m1.1.2.2.2.2" xref="S2.SS3.SSS2.p1.3.m1.1.2.2.2.2.cmml">W</mi><mi id="S2.SS3.SSS2.p1.3.m1.1.2.2.2.3" xref="S2.SS3.SSS2.p1.3.m1.1.2.2.2.3.cmml">δ</mi><mrow id="S2.SS3.SSS2.p1.3.m1.1.1.1.3" xref="S2.SS3.SSS2.p1.3.m1.1.2.2.cmml"><mo id="S2.SS3.SSS2.p1.3.m1.1.1.1.3.1" stretchy="false" xref="S2.SS3.SSS2.p1.3.m1.1.2.2.cmml">(</mo><mn id="S2.SS3.SSS2.p1.3.m1.1.1.1.1" xref="S2.SS3.SSS2.p1.3.m1.1.1.1.1.cmml">1</mn><mo id="S2.SS3.SSS2.p1.3.m1.1.1.1.3.2" stretchy="false" xref="S2.SS3.SSS2.p1.3.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS3.SSS2.p1.3.m1.1.2.1" xref="S2.SS3.SSS2.p1.3.m1.1.2.1.cmml">∈</mo><msup id="S2.SS3.SSS2.p1.3.m1.1.2.3" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.cmml"><mi id="S2.SS3.SSS2.p1.3.m1.1.2.3.2" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS2.p1.3.m1.1.2.3.3" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.3.cmml"><mi id="S2.SS3.SSS2.p1.3.m1.1.2.3.3.2" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.3.2.cmml">D</mi><mo id="S2.SS3.SSS2.p1.3.m1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.3.1.cmml">×</mo><mi id="S2.SS3.SSS2.p1.3.m1.1.2.3.3.3" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.3.m1.1b"><apply id="S2.SS3.SSS2.p1.3.m1.1.2.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2"><in id="S2.SS3.SSS2.p1.3.m1.1.2.1.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.1"></in><apply id="S2.SS3.SSS2.p1.3.m1.1.2.2.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.3.m1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.2">superscript</csymbol><apply id="S2.SS3.SSS2.p1.3.m1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.3.m1.1.2.2.2.1.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.2">subscript</csymbol><ci id="S2.SS3.SSS2.p1.3.m1.1.2.2.2.2.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.2.2.2">𝑊</ci><ci id="S2.SS3.SSS2.p1.3.m1.1.2.2.2.3.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.2.2.3">𝛿</ci></apply><cn id="S2.SS3.SSS2.p1.3.m1.1.1.1.1.cmml" type="integer" xref="S2.SS3.SSS2.p1.3.m1.1.1.1.1">1</cn></apply><apply id="S2.SS3.SSS2.p1.3.m1.1.2.3.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.3.m1.1.2.3.1.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.3">superscript</csymbol><ci id="S2.SS3.SSS2.p1.3.m1.1.2.3.2.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.2">ℝ</ci><apply id="S2.SS3.SSS2.p1.3.m1.1.2.3.3.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.3"><times id="S2.SS3.SSS2.p1.3.m1.1.2.3.3.1.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.3.1"></times><ci id="S2.SS3.SSS2.p1.3.m1.1.2.3.3.2.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.3.2">𝐷</ci><ci id="S2.SS3.SSS2.p1.3.m1.1.2.3.3.3.cmml" xref="S2.SS3.SSS2.p1.3.m1.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.3.m1.1c">W_{\delta}^{(1)}\in\mathbb{R}^{D\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.3.m1.1d">italic_W start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the weight, <math alttext="\boldsymbol{b}_{\delta}^{(1)}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.4.m2.1"><semantics id="S2.SS3.SSS2.p1.4.m2.1a"><mrow id="S2.SS3.SSS2.p1.4.m2.1.2" xref="S2.SS3.SSS2.p1.4.m2.1.2.cmml"><msubsup id="S2.SS3.SSS2.p1.4.m2.1.2.2" xref="S2.SS3.SSS2.p1.4.m2.1.2.2.cmml"><mi id="S2.SS3.SSS2.p1.4.m2.1.2.2.2.2" xref="S2.SS3.SSS2.p1.4.m2.1.2.2.2.2.cmml">𝒃</mi><mi id="S2.SS3.SSS2.p1.4.m2.1.2.2.2.3" xref="S2.SS3.SSS2.p1.4.m2.1.2.2.2.3.cmml">δ</mi><mrow id="S2.SS3.SSS2.p1.4.m2.1.1.1.3" xref="S2.SS3.SSS2.p1.4.m2.1.2.2.cmml"><mo id="S2.SS3.SSS2.p1.4.m2.1.1.1.3.1" stretchy="false" xref="S2.SS3.SSS2.p1.4.m2.1.2.2.cmml">(</mo><mn id="S2.SS3.SSS2.p1.4.m2.1.1.1.1" xref="S2.SS3.SSS2.p1.4.m2.1.1.1.1.cmml">1</mn><mo id="S2.SS3.SSS2.p1.4.m2.1.1.1.3.2" stretchy="false" xref="S2.SS3.SSS2.p1.4.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS3.SSS2.p1.4.m2.1.2.1" xref="S2.SS3.SSS2.p1.4.m2.1.2.1.cmml">∈</mo><msup id="S2.SS3.SSS2.p1.4.m2.1.2.3" xref="S2.SS3.SSS2.p1.4.m2.1.2.3.cmml"><mi id="S2.SS3.SSS2.p1.4.m2.1.2.3.2" xref="S2.SS3.SSS2.p1.4.m2.1.2.3.2.cmml">ℝ</mi><mi id="S2.SS3.SSS2.p1.4.m2.1.2.3.3" xref="S2.SS3.SSS2.p1.4.m2.1.2.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.4.m2.1b"><apply id="S2.SS3.SSS2.p1.4.m2.1.2.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2"><in id="S2.SS3.SSS2.p1.4.m2.1.2.1.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.1"></in><apply id="S2.SS3.SSS2.p1.4.m2.1.2.2.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.4.m2.1.2.2.1.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.2">superscript</csymbol><apply id="S2.SS3.SSS2.p1.4.m2.1.2.2.2.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.4.m2.1.2.2.2.1.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.2">subscript</csymbol><ci id="S2.SS3.SSS2.p1.4.m2.1.2.2.2.2.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.2.2.2">𝒃</ci><ci id="S2.SS3.SSS2.p1.4.m2.1.2.2.2.3.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.2.2.3">𝛿</ci></apply><cn id="S2.SS3.SSS2.p1.4.m2.1.1.1.1.cmml" type="integer" xref="S2.SS3.SSS2.p1.4.m2.1.1.1.1">1</cn></apply><apply id="S2.SS3.SSS2.p1.4.m2.1.2.3.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.4.m2.1.2.3.1.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.3">superscript</csymbol><ci id="S2.SS3.SSS2.p1.4.m2.1.2.3.2.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.3.2">ℝ</ci><ci id="S2.SS3.SSS2.p1.4.m2.1.2.3.3.cmml" xref="S2.SS3.SSS2.p1.4.m2.1.2.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.4.m2.1c">\boldsymbol{b}_{\delta}^{(1)}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.4.m2.1d">bold_italic_b start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is bias; <math alttext="\mathcal{G}_{0}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.5.m3.1"><semantics id="S2.SS3.SSS2.p1.5.m3.1a"><msub id="S2.SS3.SSS2.p1.5.m3.1.1" xref="S2.SS3.SSS2.p1.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS2.p1.5.m3.1.1.2" xref="S2.SS3.SSS2.p1.5.m3.1.1.2.cmml">𝒢</mi><mn id="S2.SS3.SSS2.p1.5.m3.1.1.3" xref="S2.SS3.SSS2.p1.5.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.5.m3.1b"><apply id="S2.SS3.SSS2.p1.5.m3.1.1.cmml" xref="S2.SS3.SSS2.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.5.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p1.5.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.5.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p1.5.m3.1.1.2">𝒢</ci><cn id="S2.SS3.SSS2.p1.5.m3.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p1.5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.5.m3.1c">\mathcal{G}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.5.m3.1d">caligraphic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> denoted as the symbol of forget gate; <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.6.m4.1"><semantics id="S2.SS3.SSS2.p1.6.m4.1a"><mrow id="S2.SS3.SSS2.p1.6.m4.1.2" xref="S2.SS3.SSS2.p1.6.m4.1.2.cmml"><mi id="S2.SS3.SSS2.p1.6.m4.1.2.2" xref="S2.SS3.SSS2.p1.6.m4.1.2.2.cmml">σ</mi><mo id="S2.SS3.SSS2.p1.6.m4.1.2.1" xref="S2.SS3.SSS2.p1.6.m4.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.SSS2.p1.6.m4.1.2.3.2" xref="S2.SS3.SSS2.p1.6.m4.1.2.cmml"><mo id="S2.SS3.SSS2.p1.6.m4.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS2.p1.6.m4.1.2.cmml">(</mo><mo id="S2.SS3.SSS2.p1.6.m4.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS2.p1.6.m4.1.1.cmml">⋅</mo><mo id="S2.SS3.SSS2.p1.6.m4.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS2.p1.6.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.6.m4.1b"><apply id="S2.SS3.SSS2.p1.6.m4.1.2.cmml" xref="S2.SS3.SSS2.p1.6.m4.1.2"><times id="S2.SS3.SSS2.p1.6.m4.1.2.1.cmml" xref="S2.SS3.SSS2.p1.6.m4.1.2.1"></times><ci id="S2.SS3.SSS2.p1.6.m4.1.2.2.cmml" xref="S2.SS3.SSS2.p1.6.m4.1.2.2">𝜎</ci><ci id="S2.SS3.SSS2.p1.6.m4.1.1.cmml" xref="S2.SS3.SSS2.p1.6.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.6.m4.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.6.m4.1d">italic_σ ( ⋅ )</annotation></semantics></math> represents the Sigmoid activation function <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib11" title="">2018</a>)</cite>.
By employing this <math alttext="\mathcal{G}_{0}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.7.m5.1"><semantics id="S2.SS3.SSS2.p1.7.m5.1a"><msub id="S2.SS3.SSS2.p1.7.m5.1.1" xref="S2.SS3.SSS2.p1.7.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS2.p1.7.m5.1.1.2" xref="S2.SS3.SSS2.p1.7.m5.1.1.2.cmml">𝒢</mi><mn id="S2.SS3.SSS2.p1.7.m5.1.1.3" xref="S2.SS3.SSS2.p1.7.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.7.m5.1b"><apply id="S2.SS3.SSS2.p1.7.m5.1.1.cmml" xref="S2.SS3.SSS2.p1.7.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.7.m5.1.1.1.cmml" xref="S2.SS3.SSS2.p1.7.m5.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.7.m5.1.1.2.cmml" xref="S2.SS3.SSS2.p1.7.m5.1.1.2">𝒢</ci><cn id="S2.SS3.SSS2.p1.7.m5.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p1.7.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.7.m5.1c">\mathcal{G}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.7.m5.1d">caligraphic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, we can control the information flow in <math alttext="\boldsymbol{G}_{0}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.8.m6.1"><semantics id="S2.SS3.SSS2.p1.8.m6.1a"><msub id="S2.SS3.SSS2.p1.8.m6.1.1" xref="S2.SS3.SSS2.p1.8.m6.1.1.cmml"><mi id="S2.SS3.SSS2.p1.8.m6.1.1.2" xref="S2.SS3.SSS2.p1.8.m6.1.1.2.cmml">𝑮</mi><mn id="S2.SS3.SSS2.p1.8.m6.1.1.3" xref="S2.SS3.SSS2.p1.8.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.8.m6.1b"><apply id="S2.SS3.SSS2.p1.8.m6.1.1.cmml" xref="S2.SS3.SSS2.p1.8.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.8.m6.1.1.1.cmml" xref="S2.SS3.SSS2.p1.8.m6.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.8.m6.1.1.2.cmml" xref="S2.SS3.SSS2.p1.8.m6.1.1.2">𝑮</ci><cn id="S2.SS3.SSS2.p1.8.m6.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p1.8.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.8.m6.1c">\boldsymbol{G}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.8.m6.1d">bold_italic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to selectively retain or suppress certain information <cite class="ltx_cite ltx_citemacro_citep">(De et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib4" title="">2024</a>)</cite>.
Apart from the <math alttext="\mathcal{G}_{0}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.9.m7.1"><semantics id="S2.SS3.SSS2.p1.9.m7.1a"><msub id="S2.SS3.SSS2.p1.9.m7.1.1" xref="S2.SS3.SSS2.p1.9.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS2.p1.9.m7.1.1.2" xref="S2.SS3.SSS2.p1.9.m7.1.1.2.cmml">𝒢</mi><mn id="S2.SS3.SSS2.p1.9.m7.1.1.3" xref="S2.SS3.SSS2.p1.9.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.9.m7.1b"><apply id="S2.SS3.SSS2.p1.9.m7.1.1.cmml" xref="S2.SS3.SSS2.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.9.m7.1.1.1.cmml" xref="S2.SS3.SSS2.p1.9.m7.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.9.m7.1.1.2.cmml" xref="S2.SS3.SSS2.p1.9.m7.1.1.2">𝒢</ci><cn id="S2.SS3.SSS2.p1.9.m7.1.1.3.cmml" type="integer" xref="S2.SS3.SSS2.p1.9.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.9.m7.1c">\mathcal{G}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.9.m7.1d">caligraphic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, we also employ a <math alttext="\operatorname{SiLU}" class="ltx_Math" display="inline" id="S2.SS3.SSS2.p1.10.m8.1"><semantics id="S2.SS3.SSS2.p1.10.m8.1a"><mi id="S2.SS3.SSS2.p1.10.m8.1.1" xref="S2.SS3.SSS2.p1.10.m8.1.1.cmml">SiLU</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.10.m8.1b"><ci id="S2.SS3.SSS2.p1.10.m8.1.1.cmml" xref="S2.SS3.SSS2.p1.10.m8.1.1">SiLU</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.10.m8.1c">\operatorname{SiLU}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS2.p1.10.m8.1d">roman_SiLU</annotation></semantics></math> function to further improve the capability for capturing more complex patterns and features <cite class="ltx_cite ltx_citemacro_citep">(Nwankpa et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib31" title="">2018</a>)</cite>.
Therefore, We can conclude our DS Gate as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{G}_{1}(\boldsymbol{H}_{0})=\operatorname{SiLU}\left(\boldsymbol{%
\delta}_{1}(\boldsymbol{G}_{0})\right)+\mathcal{G}_{0}(\boldsymbol{G}_{0})" class="ltx_Math" display="block" id="S2.E6.m1.4"><semantics id="S2.E6.m1.4a"><mrow id="S2.E6.m1.4.4" xref="S2.E6.m1.4.4.cmml"><mrow id="S2.E6.m1.2.2.1" xref="S2.E6.m1.2.2.1.cmml"><msub id="S2.E6.m1.2.2.1.3" xref="S2.E6.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.2.2.1.3.2" xref="S2.E6.m1.2.2.1.3.2.cmml">𝒢</mi><mn id="S2.E6.m1.2.2.1.3.3" xref="S2.E6.m1.2.2.1.3.3.cmml">1</mn></msub><mo id="S2.E6.m1.2.2.1.2" xref="S2.E6.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.cmml"><mo id="S2.E6.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E6.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S2.E6.m1.2.2.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.2.cmml">𝑯</mi><mn id="S2.E6.m1.2.2.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E6.m1.2.2.1.1.1.3" stretchy="false" xref="S2.E6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.4.4.4" xref="S2.E6.m1.4.4.4.cmml">=</mo><mrow id="S2.E6.m1.4.4.3" xref="S2.E6.m1.4.4.3.cmml"><mrow id="S2.E6.m1.3.3.2.1.1" xref="S2.E6.m1.3.3.2.1.2.cmml"><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">SiLU</mi><mo id="S2.E6.m1.3.3.2.1.1a" xref="S2.E6.m1.3.3.2.1.2.cmml">⁡</mo><mrow id="S2.E6.m1.3.3.2.1.1.1" xref="S2.E6.m1.3.3.2.1.2.cmml"><mo id="S2.E6.m1.3.3.2.1.1.1.2" xref="S2.E6.m1.3.3.2.1.2.cmml">(</mo><mrow id="S2.E6.m1.3.3.2.1.1.1.1" xref="S2.E6.m1.3.3.2.1.1.1.1.cmml"><msub id="S2.E6.m1.3.3.2.1.1.1.1.3" xref="S2.E6.m1.3.3.2.1.1.1.1.3.cmml"><mi id="S2.E6.m1.3.3.2.1.1.1.1.3.2" xref="S2.E6.m1.3.3.2.1.1.1.1.3.2.cmml">𝜹</mi><mn id="S2.E6.m1.3.3.2.1.1.1.1.3.3" xref="S2.E6.m1.3.3.2.1.1.1.1.3.3.cmml">1</mn></msub><mo id="S2.E6.m1.3.3.2.1.1.1.1.2" xref="S2.E6.m1.3.3.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.2.1.1.1.1.1.1" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.3.3.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E6.m1.3.3.2.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.2.cmml">𝑮</mi><mn id="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E6.m1.3.3.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.3.3.2.1.1.1.3" xref="S2.E6.m1.3.3.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.4.4.3.3" xref="S2.E6.m1.4.4.3.3.cmml">+</mo><mrow id="S2.E6.m1.4.4.3.2" xref="S2.E6.m1.4.4.3.2.cmml"><msub id="S2.E6.m1.4.4.3.2.3" xref="S2.E6.m1.4.4.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.4.4.3.2.3.2" xref="S2.E6.m1.4.4.3.2.3.2.cmml">𝒢</mi><mn id="S2.E6.m1.4.4.3.2.3.3" xref="S2.E6.m1.4.4.3.2.3.3.cmml">0</mn></msub><mo id="S2.E6.m1.4.4.3.2.2" xref="S2.E6.m1.4.4.3.2.2.cmml">⁢</mo><mrow id="S2.E6.m1.4.4.3.2.1.1" xref="S2.E6.m1.4.4.3.2.1.1.1.cmml"><mo id="S2.E6.m1.4.4.3.2.1.1.2" stretchy="false" xref="S2.E6.m1.4.4.3.2.1.1.1.cmml">(</mo><msub id="S2.E6.m1.4.4.3.2.1.1.1" xref="S2.E6.m1.4.4.3.2.1.1.1.cmml"><mi id="S2.E6.m1.4.4.3.2.1.1.1.2" xref="S2.E6.m1.4.4.3.2.1.1.1.2.cmml">𝑮</mi><mn id="S2.E6.m1.4.4.3.2.1.1.1.3" xref="S2.E6.m1.4.4.3.2.1.1.1.3.cmml">0</mn></msub><mo id="S2.E6.m1.4.4.3.2.1.1.3" stretchy="false" xref="S2.E6.m1.4.4.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.4b"><apply id="S2.E6.m1.4.4.cmml" xref="S2.E6.m1.4.4"><eq id="S2.E6.m1.4.4.4.cmml" xref="S2.E6.m1.4.4.4"></eq><apply id="S2.E6.m1.2.2.1.cmml" xref="S2.E6.m1.2.2.1"><times id="S2.E6.m1.2.2.1.2.cmml" xref="S2.E6.m1.2.2.1.2"></times><apply id="S2.E6.m1.2.2.1.3.cmml" xref="S2.E6.m1.2.2.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.3.1.cmml" xref="S2.E6.m1.2.2.1.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.3.2.cmml" xref="S2.E6.m1.2.2.1.3.2">𝒢</ci><cn id="S2.E6.m1.2.2.1.3.3.cmml" type="integer" xref="S2.E6.m1.2.2.1.3.3">1</cn></apply><apply id="S2.E6.m1.2.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2">𝑯</ci><cn id="S2.E6.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.E6.m1.2.2.1.1.1.1.3">0</cn></apply></apply><apply id="S2.E6.m1.4.4.3.cmml" xref="S2.E6.m1.4.4.3"><plus id="S2.E6.m1.4.4.3.3.cmml" xref="S2.E6.m1.4.4.3.3"></plus><apply id="S2.E6.m1.3.3.2.1.2.cmml" xref="S2.E6.m1.3.3.2.1.1"><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">SiLU</ci><apply id="S2.E6.m1.3.3.2.1.1.1.1.cmml" xref="S2.E6.m1.3.3.2.1.1.1.1"><times id="S2.E6.m1.3.3.2.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.2.1.1.1.1.2"></times><apply id="S2.E6.m1.3.3.2.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.2.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.3.3.2.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.2.1.1.1.1.3.2">𝜹</ci><cn id="S2.E6.m1.3.3.2.1.1.1.1.3.3.cmml" type="integer" xref="S2.E6.m1.3.3.2.1.1.1.1.3.3">1</cn></apply><apply id="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.2">𝑮</ci><cn id="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E6.m1.3.3.2.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S2.E6.m1.4.4.3.2.cmml" xref="S2.E6.m1.4.4.3.2"><times id="S2.E6.m1.4.4.3.2.2.cmml" xref="S2.E6.m1.4.4.3.2.2"></times><apply id="S2.E6.m1.4.4.3.2.3.cmml" xref="S2.E6.m1.4.4.3.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.3.2.3.1.cmml" xref="S2.E6.m1.4.4.3.2.3">subscript</csymbol><ci id="S2.E6.m1.4.4.3.2.3.2.cmml" xref="S2.E6.m1.4.4.3.2.3.2">𝒢</ci><cn id="S2.E6.m1.4.4.3.2.3.3.cmml" type="integer" xref="S2.E6.m1.4.4.3.2.3.3">0</cn></apply><apply id="S2.E6.m1.4.4.3.2.1.1.1.cmml" xref="S2.E6.m1.4.4.3.2.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.3.2.1.1.1.1.cmml" xref="S2.E6.m1.4.4.3.2.1.1">subscript</csymbol><ci id="S2.E6.m1.4.4.3.2.1.1.1.2.cmml" xref="S2.E6.m1.4.4.3.2.1.1.1.2">𝑮</ci><cn id="S2.E6.m1.4.4.3.2.1.1.1.3.cmml" type="integer" xref="S2.E6.m1.4.4.3.2.1.1.1.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.4c">\mathcal{G}_{1}(\boldsymbol{H}_{0})=\operatorname{SiLU}\left(\boldsymbol{%
\delta}_{1}(\boldsymbol{G}_{0})\right)+\mathcal{G}_{0}(\boldsymbol{G}_{0})</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.4d">caligraphic_G start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = roman_SiLU ( bold_italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( bold_italic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ) + caligraphic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_G start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS2.p1.12">This method allows the PF-Mamba to balance two directions of the input sequence and produce a global representation.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.3. </span>Feature Extract GRU</h4>
<div class="ltx_para" id="S2.SS3.SSS3.p1">
<p class="ltx_p" id="S2.SS3.SSS3.p1.15">To handle Mamba’s undesirable performance on short sequence modeling, we introduce one more GRU path called Feature Extract GRU in our SIGMA framework. Considering efficiency and effectiveness, we only introduce one more convolution function before the GRU cell to extract and mix the features <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib43" title="">2019</a>)</cite>.
By employing this one-dimensional convolution with a well-designed kernel size, we can aggregate and extract information from the short-term pattern of the input embedding sequence.
Then, we can extract the hidden representation by utilizing GRU’s impressive capability in capturing short-term dependencies. The whole processing procedure can then be formalized as follows:
</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E7">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E7X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="5"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{C}" class="ltx_Math" display="inline" id="S2.E7X.2.1.1.m1.1"><semantics id="S2.E7X.2.1.1.m1.1a"><mi id="S2.E7X.2.1.1.m1.1.1" xref="S2.E7X.2.1.1.m1.1.1.cmml">𝑪</mi><annotation-xml encoding="MathML-Content" id="S2.E7X.2.1.1.m1.1b"><ci id="S2.E7X.2.1.1.m1.1.1.cmml" xref="S2.E7X.2.1.1.m1.1.1">𝑪</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.E7X.2.1.1.m1.1c">\displaystyle\boldsymbol{C}</annotation><annotation encoding="application/x-llamapun" id="S2.E7X.2.1.1.m1.1d">bold_italic_C</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\operatorname{Conv1d}\left(\boldsymbol{H}_{0}\right)=\left[%
\boldsymbol{c}_{1},\boldsymbol{c}_{2},\cdots,\boldsymbol{c}_{n}\right]" class="ltx_Math" display="inline" id="S2.E7X.3.2.2.m1.6"><semantics id="S2.E7X.3.2.2.m1.6a"><mrow id="S2.E7X.3.2.2.m1.6.6" xref="S2.E7X.3.2.2.m1.6.6.cmml"><mi id="S2.E7X.3.2.2.m1.6.6.6" xref="S2.E7X.3.2.2.m1.6.6.6.cmml"></mi><mo id="S2.E7X.3.2.2.m1.6.6.7" xref="S2.E7X.3.2.2.m1.6.6.7.cmml">=</mo><mrow id="S2.E7X.3.2.2.m1.3.3.1.1" xref="S2.E7X.3.2.2.m1.3.3.1.2.cmml"><mi id="S2.E7X.3.2.2.m1.1.1" xref="S2.E7X.3.2.2.m1.1.1.cmml">Conv1d</mi><mo id="S2.E7X.3.2.2.m1.3.3.1.1a" xref="S2.E7X.3.2.2.m1.3.3.1.2.cmml">⁡</mo><mrow id="S2.E7X.3.2.2.m1.3.3.1.1.1" xref="S2.E7X.3.2.2.m1.3.3.1.2.cmml"><mo id="S2.E7X.3.2.2.m1.3.3.1.1.1.2" xref="S2.E7X.3.2.2.m1.3.3.1.2.cmml">(</mo><msub id="S2.E7X.3.2.2.m1.3.3.1.1.1.1" xref="S2.E7X.3.2.2.m1.3.3.1.1.1.1.cmml"><mi id="S2.E7X.3.2.2.m1.3.3.1.1.1.1.2" xref="S2.E7X.3.2.2.m1.3.3.1.1.1.1.2.cmml">𝑯</mi><mn id="S2.E7X.3.2.2.m1.3.3.1.1.1.1.3" xref="S2.E7X.3.2.2.m1.3.3.1.1.1.1.3.cmml">0</mn></msub><mo id="S2.E7X.3.2.2.m1.3.3.1.1.1.3" xref="S2.E7X.3.2.2.m1.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E7X.3.2.2.m1.6.6.8" xref="S2.E7X.3.2.2.m1.6.6.8.cmml">=</mo><mrow id="S2.E7X.3.2.2.m1.6.6.4.3" xref="S2.E7X.3.2.2.m1.6.6.4.4.cmml"><mo id="S2.E7X.3.2.2.m1.6.6.4.3.4" xref="S2.E7X.3.2.2.m1.6.6.4.4.cmml">[</mo><msub id="S2.E7X.3.2.2.m1.4.4.2.1.1" xref="S2.E7X.3.2.2.m1.4.4.2.1.1.cmml"><mi id="S2.E7X.3.2.2.m1.4.4.2.1.1.2" xref="S2.E7X.3.2.2.m1.4.4.2.1.1.2.cmml">𝒄</mi><mn id="S2.E7X.3.2.2.m1.4.4.2.1.1.3" xref="S2.E7X.3.2.2.m1.4.4.2.1.1.3.cmml">1</mn></msub><mo id="S2.E7X.3.2.2.m1.6.6.4.3.5" xref="S2.E7X.3.2.2.m1.6.6.4.4.cmml">,</mo><msub id="S2.E7X.3.2.2.m1.5.5.3.2.2" xref="S2.E7X.3.2.2.m1.5.5.3.2.2.cmml"><mi id="S2.E7X.3.2.2.m1.5.5.3.2.2.2" xref="S2.E7X.3.2.2.m1.5.5.3.2.2.2.cmml">𝒄</mi><mn id="S2.E7X.3.2.2.m1.5.5.3.2.2.3" xref="S2.E7X.3.2.2.m1.5.5.3.2.2.3.cmml">2</mn></msub><mo id="S2.E7X.3.2.2.m1.6.6.4.3.6" xref="S2.E7X.3.2.2.m1.6.6.4.4.cmml">,</mo><mi id="S2.E7X.3.2.2.m1.2.2" mathvariant="normal" xref="S2.E7X.3.2.2.m1.2.2.cmml">⋯</mi><mo id="S2.E7X.3.2.2.m1.6.6.4.3.7" xref="S2.E7X.3.2.2.m1.6.6.4.4.cmml">,</mo><msub id="S2.E7X.3.2.2.m1.6.6.4.3.3" xref="S2.E7X.3.2.2.m1.6.6.4.3.3.cmml"><mi id="S2.E7X.3.2.2.m1.6.6.4.3.3.2" xref="S2.E7X.3.2.2.m1.6.6.4.3.3.2.cmml">𝒄</mi><mi id="S2.E7X.3.2.2.m1.6.6.4.3.3.3" xref="S2.E7X.3.2.2.m1.6.6.4.3.3.3.cmml">n</mi></msub><mo id="S2.E7X.3.2.2.m1.6.6.4.3.8" xref="S2.E7X.3.2.2.m1.6.6.4.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7X.3.2.2.m1.6b"><apply id="S2.E7X.3.2.2.m1.6.6.cmml" xref="S2.E7X.3.2.2.m1.6.6"><and id="S2.E7X.3.2.2.m1.6.6a.cmml" xref="S2.E7X.3.2.2.m1.6.6"></and><apply id="S2.E7X.3.2.2.m1.6.6b.cmml" xref="S2.E7X.3.2.2.m1.6.6"><eq id="S2.E7X.3.2.2.m1.6.6.7.cmml" xref="S2.E7X.3.2.2.m1.6.6.7"></eq><csymbol cd="latexml" id="S2.E7X.3.2.2.m1.6.6.6.cmml" xref="S2.E7X.3.2.2.m1.6.6.6">absent</csymbol><apply id="S2.E7X.3.2.2.m1.3.3.1.2.cmml" xref="S2.E7X.3.2.2.m1.3.3.1.1"><ci id="S2.E7X.3.2.2.m1.1.1.cmml" xref="S2.E7X.3.2.2.m1.1.1">Conv1d</ci><apply id="S2.E7X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S2.E7X.3.2.2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S2.E7X.3.2.2.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S2.E7X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S2.E7X.3.2.2.m1.3.3.1.1.1.1.2">𝑯</ci><cn id="S2.E7X.3.2.2.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S2.E7X.3.2.2.m1.3.3.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S2.E7X.3.2.2.m1.6.6c.cmml" xref="S2.E7X.3.2.2.m1.6.6"><eq id="S2.E7X.3.2.2.m1.6.6.8.cmml" xref="S2.E7X.3.2.2.m1.6.6.8"></eq><share href="https://arxiv.org/html/2408.11451v2#S2.E7X.3.2.2.m1.3.3.1.cmml" id="S2.E7X.3.2.2.m1.6.6d.cmml" xref="S2.E7X.3.2.2.m1.6.6"></share><list id="S2.E7X.3.2.2.m1.6.6.4.4.cmml" xref="S2.E7X.3.2.2.m1.6.6.4.3"><apply id="S2.E7X.3.2.2.m1.4.4.2.1.1.cmml" xref="S2.E7X.3.2.2.m1.4.4.2.1.1"><csymbol cd="ambiguous" id="S2.E7X.3.2.2.m1.4.4.2.1.1.1.cmml" xref="S2.E7X.3.2.2.m1.4.4.2.1.1">subscript</csymbol><ci id="S2.E7X.3.2.2.m1.4.4.2.1.1.2.cmml" xref="S2.E7X.3.2.2.m1.4.4.2.1.1.2">𝒄</ci><cn id="S2.E7X.3.2.2.m1.4.4.2.1.1.3.cmml" type="integer" xref="S2.E7X.3.2.2.m1.4.4.2.1.1.3">1</cn></apply><apply id="S2.E7X.3.2.2.m1.5.5.3.2.2.cmml" xref="S2.E7X.3.2.2.m1.5.5.3.2.2"><csymbol cd="ambiguous" id="S2.E7X.3.2.2.m1.5.5.3.2.2.1.cmml" xref="S2.E7X.3.2.2.m1.5.5.3.2.2">subscript</csymbol><ci id="S2.E7X.3.2.2.m1.5.5.3.2.2.2.cmml" xref="S2.E7X.3.2.2.m1.5.5.3.2.2.2">𝒄</ci><cn id="S2.E7X.3.2.2.m1.5.5.3.2.2.3.cmml" type="integer" xref="S2.E7X.3.2.2.m1.5.5.3.2.2.3">2</cn></apply><ci id="S2.E7X.3.2.2.m1.2.2.cmml" xref="S2.E7X.3.2.2.m1.2.2">⋯</ci><apply id="S2.E7X.3.2.2.m1.6.6.4.3.3.cmml" xref="S2.E7X.3.2.2.m1.6.6.4.3.3"><csymbol cd="ambiguous" id="S2.E7X.3.2.2.m1.6.6.4.3.3.1.cmml" xref="S2.E7X.3.2.2.m1.6.6.4.3.3">subscript</csymbol><ci id="S2.E7X.3.2.2.m1.6.6.4.3.3.2.cmml" xref="S2.E7X.3.2.2.m1.6.6.4.3.3.2">𝒄</ci><ci id="S2.E7X.3.2.2.m1.6.6.4.3.3.3.cmml" xref="S2.E7X.3.2.2.m1.6.6.4.3.3.3">𝑛</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7X.3.2.2.m1.6c">\displaystyle=\operatorname{Conv1d}\left(\boldsymbol{H}_{0}\right)=\left[%
\boldsymbol{c}_{1},\boldsymbol{c}_{2},\cdots,\boldsymbol{c}_{n}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E7X.3.2.2.m1.6d">= Conv1d ( bold_italic_H start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = [ bold_italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_italic_c start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E7Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{z}_{t}" class="ltx_Math" display="inline" id="S2.E7Xa.2.1.1.m1.1"><semantics id="S2.E7Xa.2.1.1.m1.1a"><msub id="S2.E7Xa.2.1.1.m1.1.1" xref="S2.E7Xa.2.1.1.m1.1.1.cmml"><mi id="S2.E7Xa.2.1.1.m1.1.1.2" xref="S2.E7Xa.2.1.1.m1.1.1.2.cmml">𝒛</mi><mi id="S2.E7Xa.2.1.1.m1.1.1.3" xref="S2.E7Xa.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E7Xa.2.1.1.m1.1b"><apply id="S2.E7Xa.2.1.1.m1.1.1.cmml" xref="S2.E7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E7Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E7Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E7Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E7Xa.2.1.1.m1.1.1.2">𝒛</ci><ci id="S2.E7Xa.2.1.1.m1.1.1.3.cmml" xref="S2.E7Xa.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xa.2.1.1.m1.1c">\displaystyle\boldsymbol{z}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xa.2.1.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma\left(\boldsymbol{W}_{z}\cdot\left[\boldsymbol{f}_{t-1},%
\boldsymbol{c}_{t}\right]+\boldsymbol{b}_{z}\right)" class="ltx_Math" display="inline" id="S2.E7Xa.3.2.2.m1.1"><semantics id="S2.E7Xa.3.2.2.m1.1a"><mrow id="S2.E7Xa.3.2.2.m1.1.1" xref="S2.E7Xa.3.2.2.m1.1.1.cmml"><mi id="S2.E7Xa.3.2.2.m1.1.1.3" xref="S2.E7Xa.3.2.2.m1.1.1.3.cmml"></mi><mo id="S2.E7Xa.3.2.2.m1.1.1.2" xref="S2.E7Xa.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S2.E7Xa.3.2.2.m1.1.1.1" xref="S2.E7Xa.3.2.2.m1.1.1.1.cmml"><mi id="S2.E7Xa.3.2.2.m1.1.1.1.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.3.cmml">σ</mi><mo id="S2.E7Xa.3.2.2.m1.1.1.1.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7Xa.3.2.2.m1.1.1.1.1.1" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml"><msub id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.cmml"><mi id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.2.cmml">𝑾</mi><mi id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.3.cmml">z</mi></msub><mo id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.3" lspace="0.222em" rspace="0.222em" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">⋅</mo><mrow id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml">[</mo><msub id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒇</mi><mrow id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.4" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝒄</mi><mi id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.5" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml">]</mo></mrow></mrow><mo id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml">+</mo><msub id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml"><mi id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.2" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.2.cmml">𝒃</mi><mi id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.3.cmml">z</mi></msub></mrow><mo id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.3" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7Xa.3.2.2.m1.1b"><apply id="S2.E7Xa.3.2.2.m1.1.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1"><eq id="S2.E7Xa.3.2.2.m1.1.1.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S2.E7Xa.3.2.2.m1.1.1.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.3">absent</csymbol><apply id="S2.E7Xa.3.2.2.m1.1.1.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1"><times id="S2.E7Xa.3.2.2.m1.1.1.1.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.2"></times><ci id="S2.E7Xa.3.2.2.m1.1.1.1.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.3">𝜎</ci><apply id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1"><plus id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.3"></plus><apply id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2"><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.3">⋅</ci><apply id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.2">𝑾</ci><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.4.3">𝑧</ci></apply><interval closure="closed" id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2"><apply id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2">𝒇</ci><apply id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2">𝒄</ci><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.2">𝒃</ci><ci id="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.3.cmml" xref="S2.E7Xa.3.2.2.m1.1.1.1.1.1.1.4.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xa.3.2.2.m1.1c">\displaystyle=\sigma\left(\boldsymbol{W}_{z}\cdot\left[\boldsymbol{f}_{t-1},%
\boldsymbol{c}_{t}\right]+\boldsymbol{b}_{z}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xa.3.2.2.m1.1d">= italic_σ ( bold_italic_W start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ⋅ [ bold_italic_f start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , bold_italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] + bold_italic_b start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E7Xb">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{r}_{t}" class="ltx_Math" display="inline" id="S2.E7Xb.2.1.1.m1.1"><semantics id="S2.E7Xb.2.1.1.m1.1a"><msub id="S2.E7Xb.2.1.1.m1.1.1" xref="S2.E7Xb.2.1.1.m1.1.1.cmml"><mi id="S2.E7Xb.2.1.1.m1.1.1.2" xref="S2.E7Xb.2.1.1.m1.1.1.2.cmml">𝒓</mi><mi id="S2.E7Xb.2.1.1.m1.1.1.3" xref="S2.E7Xb.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E7Xb.2.1.1.m1.1b"><apply id="S2.E7Xb.2.1.1.m1.1.1.cmml" xref="S2.E7Xb.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E7Xb.2.1.1.m1.1.1.1.cmml" xref="S2.E7Xb.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E7Xb.2.1.1.m1.1.1.2.cmml" xref="S2.E7Xb.2.1.1.m1.1.1.2">𝒓</ci><ci id="S2.E7Xb.2.1.1.m1.1.1.3.cmml" xref="S2.E7Xb.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xb.2.1.1.m1.1c">\displaystyle\boldsymbol{r}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xb.2.1.1.m1.1d">bold_italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma\left(\boldsymbol{W}_{r}\cdot\left[\boldsymbol{f}_{t-1},%
\boldsymbol{c}_{t}\right]+\boldsymbol{b}_{r}\right)" class="ltx_Math" display="inline" id="S2.E7Xb.3.2.2.m1.1"><semantics id="S2.E7Xb.3.2.2.m1.1a"><mrow id="S2.E7Xb.3.2.2.m1.1.1" xref="S2.E7Xb.3.2.2.m1.1.1.cmml"><mi id="S2.E7Xb.3.2.2.m1.1.1.3" xref="S2.E7Xb.3.2.2.m1.1.1.3.cmml"></mi><mo id="S2.E7Xb.3.2.2.m1.1.1.2" xref="S2.E7Xb.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S2.E7Xb.3.2.2.m1.1.1.1" xref="S2.E7Xb.3.2.2.m1.1.1.1.cmml"><mi id="S2.E7Xb.3.2.2.m1.1.1.1.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.3.cmml">σ</mi><mo id="S2.E7Xb.3.2.2.m1.1.1.1.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7Xb.3.2.2.m1.1.1.1.1.1" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.cmml"><msub id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.cmml"><mi id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.2.cmml">𝑾</mi><mi id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.3.cmml">r</mi></msub><mo id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.3" lspace="0.222em" rspace="0.222em" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">⋅</mo><mrow id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml">[</mo><msub id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒇</mi><mrow id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.4" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝒄</mi><mi id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.5" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml">]</mo></mrow></mrow><mo id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml">+</mo><msub id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.cmml"><mi id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.2" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.2.cmml">𝒃</mi><mi id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.3.cmml">r</mi></msub></mrow><mo id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.3" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7Xb.3.2.2.m1.1b"><apply id="S2.E7Xb.3.2.2.m1.1.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1"><eq id="S2.E7Xb.3.2.2.m1.1.1.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S2.E7Xb.3.2.2.m1.1.1.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.3">absent</csymbol><apply id="S2.E7Xb.3.2.2.m1.1.1.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1"><times id="S2.E7Xb.3.2.2.m1.1.1.1.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.2"></times><ci id="S2.E7Xb.3.2.2.m1.1.1.1.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.3">𝜎</ci><apply id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1"><plus id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.3"></plus><apply id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2"><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.3">⋅</ci><apply id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.2">𝑾</ci><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.4.3">𝑟</ci></apply><interval closure="closed" id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2"><apply id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.2">𝒇</ci><apply id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.2">𝒄</ci><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.2">𝒃</ci><ci id="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.3.cmml" xref="S2.E7Xb.3.2.2.m1.1.1.1.1.1.1.4.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xb.3.2.2.m1.1c">\displaystyle=\sigma\left(\boldsymbol{W}_{r}\cdot\left[\boldsymbol{f}_{t-1},%
\boldsymbol{c}_{t}\right]+\boldsymbol{b}_{r}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xb.3.2.2.m1.1d">= italic_σ ( bold_italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT ⋅ [ bold_italic_f start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , bold_italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] + bold_italic_b start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E7Xc">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{\boldsymbol{f}}_{t}" class="ltx_Math" display="inline" id="S2.E7Xc.2.1.1.m1.1"><semantics id="S2.E7Xc.2.1.1.m1.1a"><msub id="S2.E7Xc.2.1.1.m1.1.1" xref="S2.E7Xc.2.1.1.m1.1.1.cmml"><mover accent="true" id="S2.E7Xc.2.1.1.m1.1.1.2" xref="S2.E7Xc.2.1.1.m1.1.1.2.cmml"><mi id="S2.E7Xc.2.1.1.m1.1.1.2.2" xref="S2.E7Xc.2.1.1.m1.1.1.2.2.cmml">𝒇</mi><mo id="S2.E7Xc.2.1.1.m1.1.1.2.1" xref="S2.E7Xc.2.1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S2.E7Xc.2.1.1.m1.1.1.3" xref="S2.E7Xc.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E7Xc.2.1.1.m1.1b"><apply id="S2.E7Xc.2.1.1.m1.1.1.cmml" xref="S2.E7Xc.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E7Xc.2.1.1.m1.1.1.1.cmml" xref="S2.E7Xc.2.1.1.m1.1.1">subscript</csymbol><apply id="S2.E7Xc.2.1.1.m1.1.1.2.cmml" xref="S2.E7Xc.2.1.1.m1.1.1.2"><ci id="S2.E7Xc.2.1.1.m1.1.1.2.1.cmml" xref="S2.E7Xc.2.1.1.m1.1.1.2.1">~</ci><ci id="S2.E7Xc.2.1.1.m1.1.1.2.2.cmml" xref="S2.E7Xc.2.1.1.m1.1.1.2.2">𝒇</ci></apply><ci id="S2.E7Xc.2.1.1.m1.1.1.3.cmml" xref="S2.E7Xc.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xc.2.1.1.m1.1c">\displaystyle\tilde{\boldsymbol{f}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xc.2.1.1.m1.1d">over~ start_ARG bold_italic_f end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\tanh\left(\boldsymbol{W}\cdot\left[\boldsymbol{r}_{t}\odot%
\boldsymbol{f}_{t-1},\boldsymbol{c}_{t}\right]+\boldsymbol{b}\right)" class="ltx_Math" display="inline" id="S2.E7Xc.3.2.2.m1.2"><semantics id="S2.E7Xc.3.2.2.m1.2a"><mrow id="S2.E7Xc.3.2.2.m1.2.2" xref="S2.E7Xc.3.2.2.m1.2.2.cmml"><mi id="S2.E7Xc.3.2.2.m1.2.2.3" xref="S2.E7Xc.3.2.2.m1.2.2.3.cmml"></mi><mo id="S2.E7Xc.3.2.2.m1.2.2.2" xref="S2.E7Xc.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S2.E7Xc.3.2.2.m1.2.2.1.1" xref="S2.E7Xc.3.2.2.m1.2.2.1.2.cmml"><mi id="S2.E7Xc.3.2.2.m1.1.1" xref="S2.E7Xc.3.2.2.m1.1.1.cmml">tanh</mi><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1a" xref="S2.E7Xc.3.2.2.m1.2.2.1.2.cmml">⁡</mo><mrow id="S2.E7Xc.3.2.2.m1.2.2.1.1.1" xref="S2.E7Xc.3.2.2.m1.2.2.1.2.cmml"><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.2.cmml">(</mo><mrow id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.cmml"><mrow id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.cmml"><mi id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.4" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.4.cmml">𝑾</mi><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.3" lspace="0.222em" rspace="0.222em" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.3.cmml">⋅</mo><mrow id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.3.cmml"><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.3" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.3.cmml">[</mo><mrow id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝒓</mi><mi id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">⊙</mo><msub id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">𝒇</mi><mrow id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.4" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.3.cmml">,</mo><msub id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.2" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.2.cmml">𝒄</mi><mi id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.3" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.5" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.3.cmml">]</mo></mrow></mrow><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.3" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.3.cmml">+</mo><mi id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.4" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.4.cmml">𝒃</mi></mrow><mo id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.3" xref="S2.E7Xc.3.2.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7Xc.3.2.2.m1.2b"><apply id="S2.E7Xc.3.2.2.m1.2.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2"><eq id="S2.E7Xc.3.2.2.m1.2.2.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S2.E7Xc.3.2.2.m1.2.2.3.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.3">absent</csymbol><apply id="S2.E7Xc.3.2.2.m1.2.2.1.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1"><tanh id="S2.E7Xc.3.2.2.m1.1.1.cmml" xref="S2.E7Xc.3.2.2.m1.1.1"></tanh><apply id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1"><plus id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.3"></plus><apply id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2"><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.3">⋅</ci><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.4.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.4">𝑾</ci><interval closure="closed" id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2"><apply id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1">direct-product</csymbol><apply id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝒓</ci><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝒇</ci><apply id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3"><minus id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.2">𝒄</ci><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><ci id="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.4.cmml" xref="S2.E7Xc.3.2.2.m1.2.2.1.1.1.1.4">𝒃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xc.3.2.2.m1.2c">\displaystyle=\tanh\left(\boldsymbol{W}\cdot\left[\boldsymbol{r}_{t}\odot%
\boldsymbol{f}_{t-1},\boldsymbol{c}_{t}\right]+\boldsymbol{b}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xc.3.2.2.m1.2d">= roman_tanh ( bold_italic_W ⋅ [ bold_italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ bold_italic_f start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , bold_italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] + bold_italic_b )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E7Xd">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\boldsymbol{f}_{t}" class="ltx_Math" display="inline" id="S2.E7Xd.2.1.1.m1.1"><semantics id="S2.E7Xd.2.1.1.m1.1a"><msub id="S2.E7Xd.2.1.1.m1.1.1" xref="S2.E7Xd.2.1.1.m1.1.1.cmml"><mi id="S2.E7Xd.2.1.1.m1.1.1.2" xref="S2.E7Xd.2.1.1.m1.1.1.2.cmml">𝒇</mi><mi id="S2.E7Xd.2.1.1.m1.1.1.3" xref="S2.E7Xd.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E7Xd.2.1.1.m1.1b"><apply id="S2.E7Xd.2.1.1.m1.1.1.cmml" xref="S2.E7Xd.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E7Xd.2.1.1.m1.1.1.1.cmml" xref="S2.E7Xd.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E7Xd.2.1.1.m1.1.1.2.cmml" xref="S2.E7Xd.2.1.1.m1.1.1.2">𝒇</ci><ci id="S2.E7Xd.2.1.1.m1.1.1.3.cmml" xref="S2.E7Xd.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xd.2.1.1.m1.1c">\displaystyle\boldsymbol{f}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xd.2.1.1.m1.1d">bold_italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\boldsymbol{z}_{t}\odot\boldsymbol{f}_{t-1}+\left(1-\boldsymbol{%
z}_{t}\right)\odot\tilde{\boldsymbol{f}}_{t}" class="ltx_Math" display="inline" id="S2.E7Xd.3.2.2.m1.1"><semantics id="S2.E7Xd.3.2.2.m1.1a"><mrow id="S2.E7Xd.3.2.2.m1.1.1" xref="S2.E7Xd.3.2.2.m1.1.1.cmml"><mi id="S2.E7Xd.3.2.2.m1.1.1.3" xref="S2.E7Xd.3.2.2.m1.1.1.3.cmml"></mi><mo id="S2.E7Xd.3.2.2.m1.1.1.2" xref="S2.E7Xd.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S2.E7Xd.3.2.2.m1.1.1.1" xref="S2.E7Xd.3.2.2.m1.1.1.1.cmml"><mrow id="S2.E7Xd.3.2.2.m1.1.1.1.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.cmml"><msub id="S2.E7Xd.3.2.2.m1.1.1.1.3.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.2.cmml"><mi id="S2.E7Xd.3.2.2.m1.1.1.1.3.2.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.2.2.cmml">𝒛</mi><mi id="S2.E7Xd.3.2.2.m1.1.1.1.3.2.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S2.E7Xd.3.2.2.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.1.cmml">⊙</mo><msub id="S2.E7Xd.3.2.2.m1.1.1.1.3.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.cmml"><mi id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.2.cmml">𝒇</mi><mrow id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.cmml"><mi id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.1" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.E7Xd.3.2.2.m1.1.1.1.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.2.cmml">+</mo><mrow id="S2.E7Xd.3.2.2.m1.1.1.1.1" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.cmml"><mrow id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml"><mn id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.3" rspace="0.055em" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E7Xd.3.2.2.m1.1.1.1.1.2" rspace="0.222em" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.2.cmml">⊙</mo><msub id="S2.E7Xd.3.2.2.m1.1.1.1.1.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.cmml"><mi id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.2" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.2.cmml">𝒇</mi><mo id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.1" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.1.cmml">~</mo></mover><mi id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.3" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7Xd.3.2.2.m1.1b"><apply id="S2.E7Xd.3.2.2.m1.1.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1"><eq id="S2.E7Xd.3.2.2.m1.1.1.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S2.E7Xd.3.2.2.m1.1.1.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.3">absent</csymbol><apply id="S2.E7Xd.3.2.2.m1.1.1.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1"><plus id="S2.E7Xd.3.2.2.m1.1.1.1.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.2"></plus><apply id="S2.E7Xd.3.2.2.m1.1.1.1.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3"><csymbol cd="latexml" id="S2.E7Xd.3.2.2.m1.1.1.1.3.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.1">direct-product</csymbol><apply id="S2.E7Xd.3.2.2.m1.1.1.1.3.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7Xd.3.2.2.m1.1.1.1.3.2.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.2">subscript</csymbol><ci id="S2.E7Xd.3.2.2.m1.1.1.1.3.2.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.2.2">𝒛</ci><ci id="S2.E7Xd.3.2.2.m1.1.1.1.3.2.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3">subscript</csymbol><ci id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.2">𝒇</ci><apply id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3"><minus id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.1"></minus><ci id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.2">𝑡</ci><cn id="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.3.cmml" type="integer" xref="S2.E7Xd.3.2.2.m1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S2.E7Xd.3.2.2.m1.1.1.1.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E7Xd.3.2.2.m1.1.1.1.1.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.2">direct-product</csymbol><apply id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1"><minus id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.1"></minus><cn id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.2">1</cn><apply id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.2">𝒛</ci><ci id="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2"><ci id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.1">~</ci><ci id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.2.2">𝒇</ci></apply><ci id="S2.E7Xd.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S2.E7Xd.3.2.2.m1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7Xd.3.2.2.m1.1c">\displaystyle=\boldsymbol{z}_{t}\odot\boldsymbol{f}_{t-1}+\left(1-\boldsymbol{%
z}_{t}\right)\odot\tilde{\boldsymbol{f}}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E7Xd.3.2.2.m1.1d">= bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ bold_italic_f start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + ( 1 - bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ⊙ over~ start_ARG bold_italic_f end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p1.14">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.1.m1.1"><semantics id="S2.SS3.SSS3.p1.1.m1.1a"><mrow id="S2.SS3.SSS3.p1.1.m1.1.2" xref="S2.SS3.SSS3.p1.1.m1.1.2.cmml"><mi id="S2.SS3.SSS3.p1.1.m1.1.2.2" xref="S2.SS3.SSS3.p1.1.m1.1.2.2.cmml">σ</mi><mo id="S2.SS3.SSS3.p1.1.m1.1.2.1" xref="S2.SS3.SSS3.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.SSS3.p1.1.m1.1.2.3.2" xref="S2.SS3.SSS3.p1.1.m1.1.2.cmml"><mo id="S2.SS3.SSS3.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S2.SS3.SSS3.p1.1.m1.1.2.cmml">(</mo><mo id="S2.SS3.SSS3.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="S2.SS3.SSS3.p1.1.m1.1.1.cmml">⋅</mo><mo id="S2.SS3.SSS3.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S2.SS3.SSS3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.1.m1.1b"><apply id="S2.SS3.SSS3.p1.1.m1.1.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.2"><times id="S2.SS3.SSS3.p1.1.m1.1.2.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.2.1"></times><ci id="S2.SS3.SSS3.p1.1.m1.1.2.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.2.2">𝜎</ci><ci id="S2.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.1.m1.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.1.m1.1d">italic_σ ( ⋅ )</annotation></semantics></math> is the sigmoid activation function, <math alttext="\boldsymbol{c}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.2.m2.1"><semantics id="S2.SS3.SSS3.p1.2.m2.1a"><msub id="S2.SS3.SSS3.p1.2.m2.1.1" xref="S2.SS3.SSS3.p1.2.m2.1.1.cmml"><mi id="S2.SS3.SSS3.p1.2.m2.1.1.2" xref="S2.SS3.SSS3.p1.2.m2.1.1.2.cmml">𝒄</mi><mi id="S2.SS3.SSS3.p1.2.m2.1.1.3" xref="S2.SS3.SSS3.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.2.m2.1b"><apply id="S2.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.2">𝒄</ci><ci id="S2.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.2.m2.1c">\boldsymbol{c}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.2.m2.1d">bold_italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the input of GRU module in <math alttext="t^{th}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.3.m3.1"><semantics id="S2.SS3.SSS3.p1.3.m3.1a"><msup id="S2.SS3.SSS3.p1.3.m3.1.1" xref="S2.SS3.SSS3.p1.3.m3.1.1.cmml"><mi id="S2.SS3.SSS3.p1.3.m3.1.1.2" xref="S2.SS3.SSS3.p1.3.m3.1.1.2.cmml">t</mi><mrow id="S2.SS3.SSS3.p1.3.m3.1.1.3" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.cmml"><mi id="S2.SS3.SSS3.p1.3.m3.1.1.3.2" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.2.cmml">t</mi><mo id="S2.SS3.SSS3.p1.3.m3.1.1.3.1" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS3.p1.3.m3.1.1.3.3" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.3.m3.1b"><apply id="S2.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.2">𝑡</ci><apply id="S2.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.3"><times id="S2.SS3.SSS3.p1.3.m3.1.1.3.1.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.1"></times><ci id="S2.SS3.SSS3.p1.3.m3.1.1.3.2.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S2.SS3.SSS3.p1.3.m3.1.1.3.3.cmml" xref="S2.SS3.SSS3.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.3.m3.1c">t^{th}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.3.m3.1d">italic_t start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> time step, <math alttext="\boldsymbol{f}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.4.m4.1"><semantics id="S2.SS3.SSS3.p1.4.m4.1a"><msub id="S2.SS3.SSS3.p1.4.m4.1.1" xref="S2.SS3.SSS3.p1.4.m4.1.1.cmml"><mi id="S2.SS3.SSS3.p1.4.m4.1.1.2" xref="S2.SS3.SSS3.p1.4.m4.1.1.2.cmml">𝒇</mi><mi id="S2.SS3.SSS3.p1.4.m4.1.1.3" xref="S2.SS3.SSS3.p1.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.4.m4.1b"><apply id="S2.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.4.m4.1.1.1.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.4.m4.1.1.2.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.2">𝒇</ci><ci id="S2.SS3.SSS3.p1.4.m4.1.1.3.cmml" xref="S2.SS3.SSS3.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.4.m4.1c">\boldsymbol{f}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.4.m4.1d">bold_italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the <math alttext="t^{th}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.5.m5.1"><semantics id="S2.SS3.SSS3.p1.5.m5.1a"><msup id="S2.SS3.SSS3.p1.5.m5.1.1" xref="S2.SS3.SSS3.p1.5.m5.1.1.cmml"><mi id="S2.SS3.SSS3.p1.5.m5.1.1.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.2.cmml">t</mi><mrow id="S2.SS3.SSS3.p1.5.m5.1.1.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.cmml"><mi id="S2.SS3.SSS3.p1.5.m5.1.1.3.2" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.2.cmml">t</mi><mo id="S2.SS3.SSS3.p1.5.m5.1.1.3.1" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S2.SS3.SSS3.p1.5.m5.1.1.3.3" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.5.m5.1b"><apply id="S2.SS3.SSS3.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.5.m5.1.1.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS3.SSS3.p1.5.m5.1.1.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.2">𝑡</ci><apply id="S2.SS3.SSS3.p1.5.m5.1.1.3.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3"><times id="S2.SS3.SSS3.p1.5.m5.1.1.3.1.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.1"></times><ci id="S2.SS3.SSS3.p1.5.m5.1.1.3.2.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.2">𝑡</ci><ci id="S2.SS3.SSS3.p1.5.m5.1.1.3.3.cmml" xref="S2.SS3.SSS3.p1.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.5.m5.1c">t^{th}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.5.m5.1d">italic_t start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> hidden states, <math alttext="\boldsymbol{z}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.6.m6.1"><semantics id="S2.SS3.SSS3.p1.6.m6.1a"><msub id="S2.SS3.SSS3.p1.6.m6.1.1" xref="S2.SS3.SSS3.p1.6.m6.1.1.cmml"><mi id="S2.SS3.SSS3.p1.6.m6.1.1.2" xref="S2.SS3.SSS3.p1.6.m6.1.1.2.cmml">𝒛</mi><mi id="S2.SS3.SSS3.p1.6.m6.1.1.3" xref="S2.SS3.SSS3.p1.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.6.m6.1b"><apply id="S2.SS3.SSS3.p1.6.m6.1.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.6.m6.1.1.1.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.6.m6.1.1.2.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1.2">𝒛</ci><ci id="S2.SS3.SSS3.p1.6.m6.1.1.3.cmml" xref="S2.SS3.SSS3.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.6.m6.1c">\boldsymbol{z}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.6.m6.1d">bold_italic_z start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\boldsymbol{r}_{t}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.7.m7.1"><semantics id="S2.SS3.SSS3.p1.7.m7.1a"><msub id="S2.SS3.SSS3.p1.7.m7.1.1" xref="S2.SS3.SSS3.p1.7.m7.1.1.cmml"><mi id="S2.SS3.SSS3.p1.7.m7.1.1.2" xref="S2.SS3.SSS3.p1.7.m7.1.1.2.cmml">𝒓</mi><mi id="S2.SS3.SSS3.p1.7.m7.1.1.3" xref="S2.SS3.SSS3.p1.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.7.m7.1b"><apply id="S2.SS3.SSS3.p1.7.m7.1.1.cmml" xref="S2.SS3.SSS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.7.m7.1.1.1.cmml" xref="S2.SS3.SSS3.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.7.m7.1.1.2.cmml" xref="S2.SS3.SSS3.p1.7.m7.1.1.2">𝒓</ci><ci id="S2.SS3.SSS3.p1.7.m7.1.1.3.cmml" xref="S2.SS3.SSS3.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.7.m7.1c">\boldsymbol{r}_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.7.m7.1d">bold_italic_r start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are the update gate and the reset gate, respectively. <math alttext="\boldsymbol{b}_{z}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.8.m8.1"><semantics id="S2.SS3.SSS3.p1.8.m8.1a"><msub id="S2.SS3.SSS3.p1.8.m8.1.1" xref="S2.SS3.SSS3.p1.8.m8.1.1.cmml"><mi id="S2.SS3.SSS3.p1.8.m8.1.1.2" xref="S2.SS3.SSS3.p1.8.m8.1.1.2.cmml">𝒃</mi><mi id="S2.SS3.SSS3.p1.8.m8.1.1.3" xref="S2.SS3.SSS3.p1.8.m8.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.8.m8.1b"><apply id="S2.SS3.SSS3.p1.8.m8.1.1.cmml" xref="S2.SS3.SSS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.8.m8.1.1.1.cmml" xref="S2.SS3.SSS3.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.8.m8.1.1.2.cmml" xref="S2.SS3.SSS3.p1.8.m8.1.1.2">𝒃</ci><ci id="S2.SS3.SSS3.p1.8.m8.1.1.3.cmml" xref="S2.SS3.SSS3.p1.8.m8.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.8.m8.1c">\boldsymbol{b}_{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.8.m8.1d">bold_italic_b start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\boldsymbol{{b}_{r}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.9.m9.1"><semantics id="S2.SS3.SSS3.p1.9.m9.1a"><msub id="S2.SS3.SSS3.p1.9.m9.1.1" xref="S2.SS3.SSS3.p1.9.m9.1.1.cmml"><mi id="S2.SS3.SSS3.p1.9.m9.1.1.2" xref="S2.SS3.SSS3.p1.9.m9.1.1.2.cmml">𝒃</mi><mi id="S2.SS3.SSS3.p1.9.m9.1.1.3" xref="S2.SS3.SSS3.p1.9.m9.1.1.3.cmml">𝒓</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.9.m9.1b"><apply id="S2.SS3.SSS3.p1.9.m9.1.1.cmml" xref="S2.SS3.SSS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.9.m9.1.1.1.cmml" xref="S2.SS3.SSS3.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.9.m9.1.1.2.cmml" xref="S2.SS3.SSS3.p1.9.m9.1.1.2">𝒃</ci><ci id="S2.SS3.SSS3.p1.9.m9.1.1.3.cmml" xref="S2.SS3.SSS3.p1.9.m9.1.1.3">𝒓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.9.m9.1c">\boldsymbol{{b}_{r}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.9.m9.1d">bold_italic_b start_POSTSUBSCRIPT bold_italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\boldsymbol{b}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.10.m10.1"><semantics id="S2.SS3.SSS3.p1.10.m10.1a"><mi id="S2.SS3.SSS3.p1.10.m10.1.1" xref="S2.SS3.SSS3.p1.10.m10.1.1.cmml">𝒃</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.10.m10.1b"><ci id="S2.SS3.SSS3.p1.10.m10.1.1.cmml" xref="S2.SS3.SSS3.p1.10.m10.1.1">𝒃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.10.m10.1c">\boldsymbol{b}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.10.m10.1d">bold_italic_b</annotation></semantics></math> are bias, <math alttext="\boldsymbol{W}_{z}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.11.m11.1"><semantics id="S2.SS3.SSS3.p1.11.m11.1a"><msub id="S2.SS3.SSS3.p1.11.m11.1.1" xref="S2.SS3.SSS3.p1.11.m11.1.1.cmml"><mi id="S2.SS3.SSS3.p1.11.m11.1.1.2" xref="S2.SS3.SSS3.p1.11.m11.1.1.2.cmml">𝑾</mi><mi id="S2.SS3.SSS3.p1.11.m11.1.1.3" xref="S2.SS3.SSS3.p1.11.m11.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.11.m11.1b"><apply id="S2.SS3.SSS3.p1.11.m11.1.1.cmml" xref="S2.SS3.SSS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.11.m11.1.1.1.cmml" xref="S2.SS3.SSS3.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.11.m11.1.1.2.cmml" xref="S2.SS3.SSS3.p1.11.m11.1.1.2">𝑾</ci><ci id="S2.SS3.SSS3.p1.11.m11.1.1.3.cmml" xref="S2.SS3.SSS3.p1.11.m11.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.11.m11.1c">\boldsymbol{W}_{z}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.11.m11.1d">bold_italic_W start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\boldsymbol{W}_{r}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.12.m12.1"><semantics id="S2.SS3.SSS3.p1.12.m12.1a"><msub id="S2.SS3.SSS3.p1.12.m12.1.1" xref="S2.SS3.SSS3.p1.12.m12.1.1.cmml"><mi id="S2.SS3.SSS3.p1.12.m12.1.1.2" xref="S2.SS3.SSS3.p1.12.m12.1.1.2.cmml">𝑾</mi><mi id="S2.SS3.SSS3.p1.12.m12.1.1.3" xref="S2.SS3.SSS3.p1.12.m12.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.12.m12.1b"><apply id="S2.SS3.SSS3.p1.12.m12.1.1.cmml" xref="S2.SS3.SSS3.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.12.m12.1.1.1.cmml" xref="S2.SS3.SSS3.p1.12.m12.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.12.m12.1.1.2.cmml" xref="S2.SS3.SSS3.p1.12.m12.1.1.2">𝑾</ci><ci id="S2.SS3.SSS3.p1.12.m12.1.1.3.cmml" xref="S2.SS3.SSS3.p1.12.m12.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.12.m12.1c">\boldsymbol{W}_{r}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.12.m12.1d">bold_italic_W start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\boldsymbol{W}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.13.m13.1"><semantics id="S2.SS3.SSS3.p1.13.m13.1a"><mi id="S2.SS3.SSS3.p1.13.m13.1.1" xref="S2.SS3.SSS3.p1.13.m13.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.13.m13.1b"><ci id="S2.SS3.SSS3.p1.13.m13.1.1.cmml" xref="S2.SS3.SSS3.p1.13.m13.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.13.m13.1c">\boldsymbol{W}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.13.m13.1d">bold_italic_W</annotation></semantics></math> are trainable weight matrices. The final output of FE-GRU can be denoted as <math alttext="\boldsymbol{F}_{0}=\left[\boldsymbol{f}_{1},\boldsymbol{f}_{2},\cdots,%
\boldsymbol{f}_{N}\right]\in\mathbb{R}^{\mathit{L\times D}}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p1.14.m14.4"><semantics id="S2.SS3.SSS3.p1.14.m14.4a"><mrow id="S2.SS3.SSS3.p1.14.m14.4.4" xref="S2.SS3.SSS3.p1.14.m14.4.4.cmml"><msub id="S2.SS3.SSS3.p1.14.m14.4.4.5" xref="S2.SS3.SSS3.p1.14.m14.4.4.5.cmml"><mi id="S2.SS3.SSS3.p1.14.m14.4.4.5.2" xref="S2.SS3.SSS3.p1.14.m14.4.4.5.2.cmml">𝑭</mi><mn id="S2.SS3.SSS3.p1.14.m14.4.4.5.3" xref="S2.SS3.SSS3.p1.14.m14.4.4.5.3.cmml">0</mn></msub><mo id="S2.SS3.SSS3.p1.14.m14.4.4.6" xref="S2.SS3.SSS3.p1.14.m14.4.4.6.cmml">=</mo><mrow id="S2.SS3.SSS3.p1.14.m14.4.4.3.3" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.4.cmml"><mo id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.4" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.4.cmml">[</mo><msub id="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1" xref="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.cmml"><mi id="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.2" xref="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.2.cmml">𝒇</mi><mn id="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.3" xref="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.5" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.4.cmml">,</mo><msub id="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2" xref="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.cmml"><mi id="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.2" xref="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.2.cmml">𝒇</mi><mn id="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.3" xref="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.6" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.4.cmml">,</mo><mi id="S2.SS3.SSS3.p1.14.m14.1.1" mathvariant="normal" xref="S2.SS3.SSS3.p1.14.m14.1.1.cmml">⋯</mi><mo id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.7" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.4.cmml">,</mo><msub id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.cmml"><mi id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.2" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.2.cmml">𝒇</mi><mi id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.3" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.3.cmml">N</mi></msub><mo id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.8" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.4.cmml">]</mo></mrow><mo id="S2.SS3.SSS3.p1.14.m14.4.4.7" xref="S2.SS3.SSS3.p1.14.m14.4.4.7.cmml">∈</mo><msup id="S2.SS3.SSS3.p1.14.m14.4.4.8" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.cmml"><mi id="S2.SS3.SSS3.p1.14.m14.4.4.8.2" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS3.p1.14.m14.4.4.8.3" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.3.cmml"><mi id="S2.SS3.SSS3.p1.14.m14.4.4.8.3.2" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.3.2.cmml">L</mi><mo id="S2.SS3.SSS3.p1.14.m14.4.4.8.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.3.1.cmml">×</mo><mi id="S2.SS3.SSS3.p1.14.m14.4.4.8.3.3" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.14.m14.4b"><apply id="S2.SS3.SSS3.p1.14.m14.4.4.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4"><and id="S2.SS3.SSS3.p1.14.m14.4.4a.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4"></and><apply id="S2.SS3.SSS3.p1.14.m14.4.4b.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4"><eq id="S2.SS3.SSS3.p1.14.m14.4.4.6.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.6"></eq><apply id="S2.SS3.SSS3.p1.14.m14.4.4.5.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.5"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.14.m14.4.4.5.1.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.5">subscript</csymbol><ci id="S2.SS3.SSS3.p1.14.m14.4.4.5.2.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.5.2">𝑭</ci><cn id="S2.SS3.SSS3.p1.14.m14.4.4.5.3.cmml" type="integer" xref="S2.SS3.SSS3.p1.14.m14.4.4.5.3">0</cn></apply><list id="S2.SS3.SSS3.p1.14.m14.4.4.3.4.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.3"><apply id="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.cmml" xref="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.2">𝒇</ci><cn id="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS3.p1.14.m14.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.cmml" xref="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.1.cmml" xref="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.2.cmml" xref="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.2">𝒇</ci><cn id="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS3.p1.14.m14.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS3.SSS3.p1.14.m14.1.1.cmml" xref="S2.SS3.SSS3.p1.14.m14.1.1">⋯</ci><apply id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.1.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3">subscript</csymbol><ci id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.2.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.2">𝒇</ci><ci id="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.3.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.3.3.3.3">𝑁</ci></apply></list></apply><apply id="S2.SS3.SSS3.p1.14.m14.4.4c.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4"><in id="S2.SS3.SSS3.p1.14.m14.4.4.7.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.7"></in><share href="https://arxiv.org/html/2408.11451v2#S2.SS3.SSS3.p1.14.m14.4.4.3.cmml" id="S2.SS3.SSS3.p1.14.m14.4.4d.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4"></share><apply id="S2.SS3.SSS3.p1.14.m14.4.4.8.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.8"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.14.m14.4.4.8.1.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.8">superscript</csymbol><ci id="S2.SS3.SSS3.p1.14.m14.4.4.8.2.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.2">ℝ</ci><apply id="S2.SS3.SSS3.p1.14.m14.4.4.8.3.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.3"><times id="S2.SS3.SSS3.p1.14.m14.4.4.8.3.1.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.3.1"></times><ci id="S2.SS3.SSS3.p1.14.m14.4.4.8.3.2.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.3.2">𝐿</ci><ci id="S2.SS3.SSS3.p1.14.m14.4.4.8.3.3.cmml" xref="S2.SS3.SSS3.p1.14.m14.4.4.8.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.14.m14.4c">\boldsymbol{F}_{0}=\left[\boldsymbol{f}_{1},\boldsymbol{f}_{2},\cdots,%
\boldsymbol{f}_{N}\right]\in\mathbb{R}^{\mathit{L\times D}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p1.14.m14.4d">bold_italic_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = [ bold_italic_f start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_italic_f start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_italic_f start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.SSS3.p2">
<p class="ltx_p" id="S2.SS3.SSS3.p2.4"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S2.SS3.SSS3.p2.4.1">Mixing Layer.</span>
To capture user-item interactions globally and get the comprehensive hidden representation, we introduce another layer to mix the outputs of the FE-GRU and PF-Mamba for the next-item prediction. The procedure can be formalized as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{Z}_{0}={a}_{1}\boldsymbol{{M}}+{a}_{2}\boldsymbol{F}_{0}\in\mathbb%
{R}^{\mathit{L\times D}}" class="ltx_Math" display="block" id="S2.E8.m1.1"><semantics id="S2.E8.m1.1a"><mrow id="S2.E8.m1.1.1" xref="S2.E8.m1.1.1.cmml"><msub id="S2.E8.m1.1.1.2" xref="S2.E8.m1.1.1.2.cmml"><mi id="S2.E8.m1.1.1.2.2" xref="S2.E8.m1.1.1.2.2.cmml">𝒁</mi><mn id="S2.E8.m1.1.1.2.3" xref="S2.E8.m1.1.1.2.3.cmml">0</mn></msub><mo id="S2.E8.m1.1.1.3" xref="S2.E8.m1.1.1.3.cmml">=</mo><mrow id="S2.E8.m1.1.1.4" xref="S2.E8.m1.1.1.4.cmml"><mrow id="S2.E8.m1.1.1.4.2" xref="S2.E8.m1.1.1.4.2.cmml"><msub id="S2.E8.m1.1.1.4.2.2" xref="S2.E8.m1.1.1.4.2.2.cmml"><mi id="S2.E8.m1.1.1.4.2.2.2" xref="S2.E8.m1.1.1.4.2.2.2.cmml">a</mi><mn id="S2.E8.m1.1.1.4.2.2.3" xref="S2.E8.m1.1.1.4.2.2.3.cmml">1</mn></msub><mo id="S2.E8.m1.1.1.4.2.1" xref="S2.E8.m1.1.1.4.2.1.cmml">⁢</mo><mi id="S2.E8.m1.1.1.4.2.3" xref="S2.E8.m1.1.1.4.2.3.cmml">𝑴</mi></mrow><mo id="S2.E8.m1.1.1.4.1" xref="S2.E8.m1.1.1.4.1.cmml">+</mo><mrow id="S2.E8.m1.1.1.4.3" xref="S2.E8.m1.1.1.4.3.cmml"><msub id="S2.E8.m1.1.1.4.3.2" xref="S2.E8.m1.1.1.4.3.2.cmml"><mi id="S2.E8.m1.1.1.4.3.2.2" xref="S2.E8.m1.1.1.4.3.2.2.cmml">a</mi><mn id="S2.E8.m1.1.1.4.3.2.3" xref="S2.E8.m1.1.1.4.3.2.3.cmml">2</mn></msub><mo id="S2.E8.m1.1.1.4.3.1" xref="S2.E8.m1.1.1.4.3.1.cmml">⁢</mo><msub id="S2.E8.m1.1.1.4.3.3" xref="S2.E8.m1.1.1.4.3.3.cmml"><mi id="S2.E8.m1.1.1.4.3.3.2" xref="S2.E8.m1.1.1.4.3.3.2.cmml">𝑭</mi><mn id="S2.E8.m1.1.1.4.3.3.3" xref="S2.E8.m1.1.1.4.3.3.3.cmml">0</mn></msub></mrow></mrow><mo id="S2.E8.m1.1.1.5" xref="S2.E8.m1.1.1.5.cmml">∈</mo><msup id="S2.E8.m1.1.1.6" xref="S2.E8.m1.1.1.6.cmml"><mi id="S2.E8.m1.1.1.6.2" xref="S2.E8.m1.1.1.6.2.cmml">ℝ</mi><mrow id="S2.E8.m1.1.1.6.3" xref="S2.E8.m1.1.1.6.3.cmml"><mi id="S2.E8.m1.1.1.6.3.2" xref="S2.E8.m1.1.1.6.3.2.cmml">L</mi><mo id="S2.E8.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E8.m1.1.1.6.3.1.cmml">×</mo><mi id="S2.E8.m1.1.1.6.3.3" xref="S2.E8.m1.1.1.6.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><apply id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1"><and id="S2.E8.m1.1.1a.cmml" xref="S2.E8.m1.1.1"></and><apply id="S2.E8.m1.1.1b.cmml" xref="S2.E8.m1.1.1"><eq id="S2.E8.m1.1.1.3.cmml" xref="S2.E8.m1.1.1.3"></eq><apply id="S2.E8.m1.1.1.2.cmml" xref="S2.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.2">subscript</csymbol><ci id="S2.E8.m1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.2.2">𝒁</ci><cn id="S2.E8.m1.1.1.2.3.cmml" type="integer" xref="S2.E8.m1.1.1.2.3">0</cn></apply><apply id="S2.E8.m1.1.1.4.cmml" xref="S2.E8.m1.1.1.4"><plus id="S2.E8.m1.1.1.4.1.cmml" xref="S2.E8.m1.1.1.4.1"></plus><apply id="S2.E8.m1.1.1.4.2.cmml" xref="S2.E8.m1.1.1.4.2"><times id="S2.E8.m1.1.1.4.2.1.cmml" xref="S2.E8.m1.1.1.4.2.1"></times><apply id="S2.E8.m1.1.1.4.2.2.cmml" xref="S2.E8.m1.1.1.4.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.4.2.2.1.cmml" xref="S2.E8.m1.1.1.4.2.2">subscript</csymbol><ci id="S2.E8.m1.1.1.4.2.2.2.cmml" xref="S2.E8.m1.1.1.4.2.2.2">𝑎</ci><cn id="S2.E8.m1.1.1.4.2.2.3.cmml" type="integer" xref="S2.E8.m1.1.1.4.2.2.3">1</cn></apply><ci id="S2.E8.m1.1.1.4.2.3.cmml" xref="S2.E8.m1.1.1.4.2.3">𝑴</ci></apply><apply id="S2.E8.m1.1.1.4.3.cmml" xref="S2.E8.m1.1.1.4.3"><times id="S2.E8.m1.1.1.4.3.1.cmml" xref="S2.E8.m1.1.1.4.3.1"></times><apply id="S2.E8.m1.1.1.4.3.2.cmml" xref="S2.E8.m1.1.1.4.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.4.3.2.1.cmml" xref="S2.E8.m1.1.1.4.3.2">subscript</csymbol><ci id="S2.E8.m1.1.1.4.3.2.2.cmml" xref="S2.E8.m1.1.1.4.3.2.2">𝑎</ci><cn id="S2.E8.m1.1.1.4.3.2.3.cmml" type="integer" xref="S2.E8.m1.1.1.4.3.2.3">2</cn></apply><apply id="S2.E8.m1.1.1.4.3.3.cmml" xref="S2.E8.m1.1.1.4.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.4.3.3.1.cmml" xref="S2.E8.m1.1.1.4.3.3">subscript</csymbol><ci id="S2.E8.m1.1.1.4.3.3.2.cmml" xref="S2.E8.m1.1.1.4.3.3.2">𝑭</ci><cn id="S2.E8.m1.1.1.4.3.3.3.cmml" type="integer" xref="S2.E8.m1.1.1.4.3.3.3">0</cn></apply></apply></apply></apply><apply id="S2.E8.m1.1.1c.cmml" xref="S2.E8.m1.1.1"><in id="S2.E8.m1.1.1.5.cmml" xref="S2.E8.m1.1.1.5"></in><share href="https://arxiv.org/html/2408.11451v2#S2.E8.m1.1.1.4.cmml" id="S2.E8.m1.1.1d.cmml" xref="S2.E8.m1.1.1"></share><apply id="S2.E8.m1.1.1.6.cmml" xref="S2.E8.m1.1.1.6"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.6.1.cmml" xref="S2.E8.m1.1.1.6">superscript</csymbol><ci id="S2.E8.m1.1.1.6.2.cmml" xref="S2.E8.m1.1.1.6.2">ℝ</ci><apply id="S2.E8.m1.1.1.6.3.cmml" xref="S2.E8.m1.1.1.6.3"><times id="S2.E8.m1.1.1.6.3.1.cmml" xref="S2.E8.m1.1.1.6.3.1"></times><ci id="S2.E8.m1.1.1.6.3.2.cmml" xref="S2.E8.m1.1.1.6.3.2">𝐿</ci><ci id="S2.E8.m1.1.1.6.3.3.cmml" xref="S2.E8.m1.1.1.6.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">\boldsymbol{Z}_{0}={a}_{1}\boldsymbol{{M}}+{a}_{2}\boldsymbol{F}_{0}\in\mathbb%
{R}^{\mathit{L\times D}}</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.1d">bold_italic_Z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT bold_italic_M + italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT bold_italic_F start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p2.1">where <math alttext="{a}_{1},{a}_{2}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.1.m1.2"><semantics id="S2.SS3.SSS3.p2.1.m1.2a"><mrow id="S2.SS3.SSS3.p2.1.m1.2.2.2" xref="S2.SS3.SSS3.p2.1.m1.2.2.3.cmml"><msub id="S2.SS3.SSS3.p2.1.m1.1.1.1.1" xref="S2.SS3.SSS3.p2.1.m1.1.1.1.1.cmml"><mi id="S2.SS3.SSS3.p2.1.m1.1.1.1.1.2" xref="S2.SS3.SSS3.p2.1.m1.1.1.1.1.2.cmml">a</mi><mn id="S2.SS3.SSS3.p2.1.m1.1.1.1.1.3" xref="S2.SS3.SSS3.p2.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.SSS3.p2.1.m1.2.2.2.3" xref="S2.SS3.SSS3.p2.1.m1.2.2.3.cmml">,</mo><msub id="S2.SS3.SSS3.p2.1.m1.2.2.2.2" xref="S2.SS3.SSS3.p2.1.m1.2.2.2.2.cmml"><mi id="S2.SS3.SSS3.p2.1.m1.2.2.2.2.2" xref="S2.SS3.SSS3.p2.1.m1.2.2.2.2.2.cmml">a</mi><mn id="S2.SS3.SSS3.p2.1.m1.2.2.2.2.3" xref="S2.SS3.SSS3.p2.1.m1.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.1.m1.2b"><list id="S2.SS3.SSS3.p2.1.m1.2.2.3.cmml" xref="S2.SS3.SSS3.p2.1.m1.2.2.2"><apply id="S2.SS3.SSS3.p2.1.m1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.1.m1.1.1.1.1.1.cmml" xref="S2.SS3.SSS3.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p2.1.m1.1.1.1.1.2.cmml" xref="S2.SS3.SSS3.p2.1.m1.1.1.1.1.2">𝑎</ci><cn id="S2.SS3.SSS3.p2.1.m1.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.SSS3.p2.1.m1.1.1.1.1.3">1</cn></apply><apply id="S2.SS3.SSS3.p2.1.m1.2.2.2.2.cmml" xref="S2.SS3.SSS3.p2.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.1.m1.2.2.2.2.1.cmml" xref="S2.SS3.SSS3.p2.1.m1.2.2.2.2">subscript</csymbol><ci id="S2.SS3.SSS3.p2.1.m1.2.2.2.2.2.cmml" xref="S2.SS3.SSS3.p2.1.m1.2.2.2.2.2">𝑎</ci><cn id="S2.SS3.SSS3.p2.1.m1.2.2.2.2.3.cmml" type="integer" xref="S2.SS3.SSS3.p2.1.m1.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.1.m1.2c">{a}_{1},{a}_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.1.m1.2d">italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> are all trainable parameters.
Then, we employ a linear layer to capture complex relationships:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{\boldsymbol{Z}}_{0}=\boldsymbol{{Z}}_{0}\boldsymbol{W}_{\delta}^{(2)}+%
\boldsymbol{b}_{\delta}^{(2)}" class="ltx_Math" display="block" id="S2.E9.m1.2"><semantics id="S2.E9.m1.2a"><mrow id="S2.E9.m1.2.3" xref="S2.E9.m1.2.3.cmml"><msub id="S2.E9.m1.2.3.2" xref="S2.E9.m1.2.3.2.cmml"><mover accent="true" id="S2.E9.m1.2.3.2.2" xref="S2.E9.m1.2.3.2.2.cmml"><mi id="S2.E9.m1.2.3.2.2.2" xref="S2.E9.m1.2.3.2.2.2.cmml">𝒁</mi><mo id="S2.E9.m1.2.3.2.2.1" xref="S2.E9.m1.2.3.2.2.1.cmml">^</mo></mover><mn id="S2.E9.m1.2.3.2.3" xref="S2.E9.m1.2.3.2.3.cmml">0</mn></msub><mo id="S2.E9.m1.2.3.1" xref="S2.E9.m1.2.3.1.cmml">=</mo><mrow id="S2.E9.m1.2.3.3" xref="S2.E9.m1.2.3.3.cmml"><mrow id="S2.E9.m1.2.3.3.2" xref="S2.E9.m1.2.3.3.2.cmml"><msub id="S2.E9.m1.2.3.3.2.2" xref="S2.E9.m1.2.3.3.2.2.cmml"><mi id="S2.E9.m1.2.3.3.2.2.2" xref="S2.E9.m1.2.3.3.2.2.2.cmml">𝒁</mi><mn id="S2.E9.m1.2.3.3.2.2.3" xref="S2.E9.m1.2.3.3.2.2.3.cmml">0</mn></msub><mo id="S2.E9.m1.2.3.3.2.1" xref="S2.E9.m1.2.3.3.2.1.cmml">⁢</mo><msubsup id="S2.E9.m1.2.3.3.2.3" xref="S2.E9.m1.2.3.3.2.3.cmml"><mi id="S2.E9.m1.2.3.3.2.3.2.2" xref="S2.E9.m1.2.3.3.2.3.2.2.cmml">𝑾</mi><mi id="S2.E9.m1.2.3.3.2.3.2.3" xref="S2.E9.m1.2.3.3.2.3.2.3.cmml">δ</mi><mrow id="S2.E9.m1.1.1.1.3" xref="S2.E9.m1.2.3.3.2.3.cmml"><mo id="S2.E9.m1.1.1.1.3.1" stretchy="false" xref="S2.E9.m1.2.3.3.2.3.cmml">(</mo><mn id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml">2</mn><mo id="S2.E9.m1.1.1.1.3.2" stretchy="false" xref="S2.E9.m1.2.3.3.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E9.m1.2.3.3.1" xref="S2.E9.m1.2.3.3.1.cmml">+</mo><msubsup id="S2.E9.m1.2.3.3.3" xref="S2.E9.m1.2.3.3.3.cmml"><mi id="S2.E9.m1.2.3.3.3.2.2" xref="S2.E9.m1.2.3.3.3.2.2.cmml">𝒃</mi><mi id="S2.E9.m1.2.3.3.3.2.3" xref="S2.E9.m1.2.3.3.3.2.3.cmml">δ</mi><mrow id="S2.E9.m1.2.2.1.3" xref="S2.E9.m1.2.3.3.3.cmml"><mo id="S2.E9.m1.2.2.1.3.1" stretchy="false" xref="S2.E9.m1.2.3.3.3.cmml">(</mo><mn id="S2.E9.m1.2.2.1.1" xref="S2.E9.m1.2.2.1.1.cmml">2</mn><mo id="S2.E9.m1.2.2.1.3.2" stretchy="false" xref="S2.E9.m1.2.3.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.2b"><apply id="S2.E9.m1.2.3.cmml" xref="S2.E9.m1.2.3"><eq id="S2.E9.m1.2.3.1.cmml" xref="S2.E9.m1.2.3.1"></eq><apply id="S2.E9.m1.2.3.2.cmml" xref="S2.E9.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.3.2.1.cmml" xref="S2.E9.m1.2.3.2">subscript</csymbol><apply id="S2.E9.m1.2.3.2.2.cmml" xref="S2.E9.m1.2.3.2.2"><ci id="S2.E9.m1.2.3.2.2.1.cmml" xref="S2.E9.m1.2.3.2.2.1">^</ci><ci id="S2.E9.m1.2.3.2.2.2.cmml" xref="S2.E9.m1.2.3.2.2.2">𝒁</ci></apply><cn id="S2.E9.m1.2.3.2.3.cmml" type="integer" xref="S2.E9.m1.2.3.2.3">0</cn></apply><apply id="S2.E9.m1.2.3.3.cmml" xref="S2.E9.m1.2.3.3"><plus id="S2.E9.m1.2.3.3.1.cmml" xref="S2.E9.m1.2.3.3.1"></plus><apply id="S2.E9.m1.2.3.3.2.cmml" xref="S2.E9.m1.2.3.3.2"><times id="S2.E9.m1.2.3.3.2.1.cmml" xref="S2.E9.m1.2.3.3.2.1"></times><apply id="S2.E9.m1.2.3.3.2.2.cmml" xref="S2.E9.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.3.3.2.2.1.cmml" xref="S2.E9.m1.2.3.3.2.2">subscript</csymbol><ci id="S2.E9.m1.2.3.3.2.2.2.cmml" xref="S2.E9.m1.2.3.3.2.2.2">𝒁</ci><cn id="S2.E9.m1.2.3.3.2.2.3.cmml" type="integer" xref="S2.E9.m1.2.3.3.2.2.3">0</cn></apply><apply id="S2.E9.m1.2.3.3.2.3.cmml" xref="S2.E9.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.3.3.2.3.1.cmml" xref="S2.E9.m1.2.3.3.2.3">superscript</csymbol><apply id="S2.E9.m1.2.3.3.2.3.2.cmml" xref="S2.E9.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.3.3.2.3.2.1.cmml" xref="S2.E9.m1.2.3.3.2.3">subscript</csymbol><ci id="S2.E9.m1.2.3.3.2.3.2.2.cmml" xref="S2.E9.m1.2.3.3.2.3.2.2">𝑾</ci><ci id="S2.E9.m1.2.3.3.2.3.2.3.cmml" xref="S2.E9.m1.2.3.3.2.3.2.3">𝛿</ci></apply><cn id="S2.E9.m1.1.1.1.1.cmml" type="integer" xref="S2.E9.m1.1.1.1.1">2</cn></apply></apply><apply id="S2.E9.m1.2.3.3.3.cmml" xref="S2.E9.m1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.3.3.3.1.cmml" xref="S2.E9.m1.2.3.3.3">superscript</csymbol><apply id="S2.E9.m1.2.3.3.3.2.cmml" xref="S2.E9.m1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.3.3.3.2.1.cmml" xref="S2.E9.m1.2.3.3.3">subscript</csymbol><ci id="S2.E9.m1.2.3.3.3.2.2.cmml" xref="S2.E9.m1.2.3.3.3.2.2">𝒃</ci><ci id="S2.E9.m1.2.3.3.3.2.3.cmml" xref="S2.E9.m1.2.3.3.3.2.3">𝛿</ci></apply><cn id="S2.E9.m1.2.2.1.1.cmml" type="integer" xref="S2.E9.m1.2.2.1.1">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.2c">\hat{\boldsymbol{Z}}_{0}=\boldsymbol{{Z}}_{0}\boldsymbol{W}_{\delta}^{(2)}+%
\boldsymbol{b}_{\delta}^{(2)}</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.2d">over^ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = bold_italic_Z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT bold_italic_W start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT + bold_italic_b start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.SSS3.p2.3">where <math alttext="\boldsymbol{W}_{\delta}^{(2)}\in\mathbb{R}^{D\times D}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.2.m1.1"><semantics id="S2.SS3.SSS3.p2.2.m1.1a"><mrow id="S2.SS3.SSS3.p2.2.m1.1.2" xref="S2.SS3.SSS3.p2.2.m1.1.2.cmml"><msubsup id="S2.SS3.SSS3.p2.2.m1.1.2.2" xref="S2.SS3.SSS3.p2.2.m1.1.2.2.cmml"><mi id="S2.SS3.SSS3.p2.2.m1.1.2.2.2.2" xref="S2.SS3.SSS3.p2.2.m1.1.2.2.2.2.cmml">𝑾</mi><mi id="S2.SS3.SSS3.p2.2.m1.1.2.2.2.3" xref="S2.SS3.SSS3.p2.2.m1.1.2.2.2.3.cmml">δ</mi><mrow id="S2.SS3.SSS3.p2.2.m1.1.1.1.3" xref="S2.SS3.SSS3.p2.2.m1.1.2.2.cmml"><mo id="S2.SS3.SSS3.p2.2.m1.1.1.1.3.1" stretchy="false" xref="S2.SS3.SSS3.p2.2.m1.1.2.2.cmml">(</mo><mn id="S2.SS3.SSS3.p2.2.m1.1.1.1.1" xref="S2.SS3.SSS3.p2.2.m1.1.1.1.1.cmml">2</mn><mo id="S2.SS3.SSS3.p2.2.m1.1.1.1.3.2" stretchy="false" xref="S2.SS3.SSS3.p2.2.m1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS3.SSS3.p2.2.m1.1.2.1" xref="S2.SS3.SSS3.p2.2.m1.1.2.1.cmml">∈</mo><msup id="S2.SS3.SSS3.p2.2.m1.1.2.3" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.cmml"><mi id="S2.SS3.SSS3.p2.2.m1.1.2.3.2" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S2.SS3.SSS3.p2.2.m1.1.2.3.3" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.3.cmml"><mi id="S2.SS3.SSS3.p2.2.m1.1.2.3.3.2" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.3.2.cmml">D</mi><mo id="S2.SS3.SSS3.p2.2.m1.1.2.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.3.1.cmml">×</mo><mi id="S2.SS3.SSS3.p2.2.m1.1.2.3.3.3" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.2.m1.1b"><apply id="S2.SS3.SSS3.p2.2.m1.1.2.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2"><in id="S2.SS3.SSS3.p2.2.m1.1.2.1.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.1"></in><apply id="S2.SS3.SSS3.p2.2.m1.1.2.2.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.2.m1.1.2.2.1.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.2">superscript</csymbol><apply id="S2.SS3.SSS3.p2.2.m1.1.2.2.2.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.2.m1.1.2.2.2.1.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.2">subscript</csymbol><ci id="S2.SS3.SSS3.p2.2.m1.1.2.2.2.2.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.2.2.2">𝑾</ci><ci id="S2.SS3.SSS3.p2.2.m1.1.2.2.2.3.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.2.2.3">𝛿</ci></apply><cn id="S2.SS3.SSS3.p2.2.m1.1.1.1.1.cmml" type="integer" xref="S2.SS3.SSS3.p2.2.m1.1.1.1.1">2</cn></apply><apply id="S2.SS3.SSS3.p2.2.m1.1.2.3.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.2.m1.1.2.3.1.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.3">superscript</csymbol><ci id="S2.SS3.SSS3.p2.2.m1.1.2.3.2.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.2">ℝ</ci><apply id="S2.SS3.SSS3.p2.2.m1.1.2.3.3.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.3"><times id="S2.SS3.SSS3.p2.2.m1.1.2.3.3.1.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.3.1"></times><ci id="S2.SS3.SSS3.p2.2.m1.1.2.3.3.2.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.3.2">𝐷</ci><ci id="S2.SS3.SSS3.p2.2.m1.1.2.3.3.3.cmml" xref="S2.SS3.SSS3.p2.2.m1.1.2.3.3.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.2.m1.1c">\boldsymbol{W}_{\delta}^{(2)}\in\mathbb{R}^{D\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.2.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is the weight, <math alttext="\boldsymbol{b}_{\delta}^{(2)}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS3.SSS3.p2.3.m2.1"><semantics id="S2.SS3.SSS3.p2.3.m2.1a"><mrow id="S2.SS3.SSS3.p2.3.m2.1.2" xref="S2.SS3.SSS3.p2.3.m2.1.2.cmml"><msubsup id="S2.SS3.SSS3.p2.3.m2.1.2.2" xref="S2.SS3.SSS3.p2.3.m2.1.2.2.cmml"><mi id="S2.SS3.SSS3.p2.3.m2.1.2.2.2.2" xref="S2.SS3.SSS3.p2.3.m2.1.2.2.2.2.cmml">𝒃</mi><mi id="S2.SS3.SSS3.p2.3.m2.1.2.2.2.3" xref="S2.SS3.SSS3.p2.3.m2.1.2.2.2.3.cmml">δ</mi><mrow id="S2.SS3.SSS3.p2.3.m2.1.1.1.3" xref="S2.SS3.SSS3.p2.3.m2.1.2.2.cmml"><mo id="S2.SS3.SSS3.p2.3.m2.1.1.1.3.1" stretchy="false" xref="S2.SS3.SSS3.p2.3.m2.1.2.2.cmml">(</mo><mn id="S2.SS3.SSS3.p2.3.m2.1.1.1.1" xref="S2.SS3.SSS3.p2.3.m2.1.1.1.1.cmml">2</mn><mo id="S2.SS3.SSS3.p2.3.m2.1.1.1.3.2" stretchy="false" xref="S2.SS3.SSS3.p2.3.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS3.SSS3.p2.3.m2.1.2.1" xref="S2.SS3.SSS3.p2.3.m2.1.2.1.cmml">∈</mo><msup id="S2.SS3.SSS3.p2.3.m2.1.2.3" xref="S2.SS3.SSS3.p2.3.m2.1.2.3.cmml"><mi id="S2.SS3.SSS3.p2.3.m2.1.2.3.2" xref="S2.SS3.SSS3.p2.3.m2.1.2.3.2.cmml">ℝ</mi><mi id="S2.SS3.SSS3.p2.3.m2.1.2.3.3" xref="S2.SS3.SSS3.p2.3.m2.1.2.3.3.cmml">D</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p2.3.m2.1b"><apply id="S2.SS3.SSS3.p2.3.m2.1.2.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2"><in id="S2.SS3.SSS3.p2.3.m2.1.2.1.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.1"></in><apply id="S2.SS3.SSS3.p2.3.m2.1.2.2.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.3.m2.1.2.2.1.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.2">superscript</csymbol><apply id="S2.SS3.SSS3.p2.3.m2.1.2.2.2.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.3.m2.1.2.2.2.1.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.2">subscript</csymbol><ci id="S2.SS3.SSS3.p2.3.m2.1.2.2.2.2.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.2.2.2">𝒃</ci><ci id="S2.SS3.SSS3.p2.3.m2.1.2.2.2.3.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.2.2.3">𝛿</ci></apply><cn id="S2.SS3.SSS3.p2.3.m2.1.1.1.1.cmml" type="integer" xref="S2.SS3.SSS3.p2.3.m2.1.1.1.1">2</cn></apply><apply id="S2.SS3.SSS3.p2.3.m2.1.2.3.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p2.3.m2.1.2.3.1.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.3">superscript</csymbol><ci id="S2.SS3.SSS3.p2.3.m2.1.2.3.2.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.3.2">ℝ</ci><ci id="S2.SS3.SSS3.p2.3.m2.1.2.3.3.cmml" xref="S2.SS3.SSS3.p2.3.m2.1.2.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p2.3.m2.1c">\boldsymbol{b}_{\delta}^{(2)}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.SSS3.p2.3.m2.1d">bold_italic_b start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 2 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> is bias.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4. </span>PFFN Network</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.5">To capture the complex features, we further leverage a position-wise feed-forward network (PFFN Net) <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib25" title="">2024a</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib15" title="">2018</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{R}_{0}=\operatorname{GELU}\left(\hat{\boldsymbol{Z}}_{0}%
\boldsymbol{W}_{\delta}^{(3)}+b_{\delta}^{(3)}\right)\boldsymbol{W}_{\delta}^{%
(4)}+b_{\delta}^{(4)}" class="ltx_Math" display="block" id="S2.E10.m1.6"><semantics id="S2.E10.m1.6a"><mrow id="S2.E10.m1.6.6" xref="S2.E10.m1.6.6.cmml"><msub id="S2.E10.m1.6.6.3" xref="S2.E10.m1.6.6.3.cmml"><mi id="S2.E10.m1.6.6.3.2" xref="S2.E10.m1.6.6.3.2.cmml">𝑹</mi><mn id="S2.E10.m1.6.6.3.3" xref="S2.E10.m1.6.6.3.3.cmml">0</mn></msub><mo id="S2.E10.m1.6.6.2" xref="S2.E10.m1.6.6.2.cmml">=</mo><mrow id="S2.E10.m1.6.6.1" xref="S2.E10.m1.6.6.1.cmml"><mrow id="S2.E10.m1.6.6.1.1" xref="S2.E10.m1.6.6.1.1.cmml"><mrow id="S2.E10.m1.6.6.1.1.1.1" xref="S2.E10.m1.6.6.1.1.1.2.cmml"><mi id="S2.E10.m1.5.5" xref="S2.E10.m1.5.5.cmml">GELU</mi><mo id="S2.E10.m1.6.6.1.1.1.1a" xref="S2.E10.m1.6.6.1.1.1.2.cmml">⁡</mo><mrow id="S2.E10.m1.6.6.1.1.1.1.1" xref="S2.E10.m1.6.6.1.1.1.2.cmml"><mo id="S2.E10.m1.6.6.1.1.1.1.1.2" xref="S2.E10.m1.6.6.1.1.1.2.cmml">(</mo><mrow id="S2.E10.m1.6.6.1.1.1.1.1.1" xref="S2.E10.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="S2.E10.m1.6.6.1.1.1.1.1.1.2" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.cmml"><msub id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.2" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml">𝒁</mi><mo id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.1" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mn id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.3" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.3.cmml">0</mn></msub><mo id="S2.E10.m1.6.6.1.1.1.1.1.1.2.1" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.1.cmml">⁢</mo><msubsup id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.2" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.2.cmml">𝑾</mi><mi id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.3" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.3.cmml">δ</mi><mrow id="S2.E10.m1.1.1.1.3" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.cmml"><mo id="S2.E10.m1.1.1.1.3.1" stretchy="false" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.cmml">(</mo><mn id="S2.E10.m1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml">3</mn><mo id="S2.E10.m1.1.1.1.3.2" stretchy="false" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E10.m1.6.6.1.1.1.1.1.1.1" xref="S2.E10.m1.6.6.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S2.E10.m1.6.6.1.1.1.1.1.1.3" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.2" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.2.cmml">b</mi><mi id="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.3" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.3.cmml">δ</mi><mrow id="S2.E10.m1.2.2.1.3" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3.cmml"><mo id="S2.E10.m1.2.2.1.3.1" stretchy="false" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3.cmml">(</mo><mn id="S2.E10.m1.2.2.1.1" xref="S2.E10.m1.2.2.1.1.cmml">3</mn><mo id="S2.E10.m1.2.2.1.3.2" stretchy="false" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E10.m1.6.6.1.1.1.1.1.3" xref="S2.E10.m1.6.6.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E10.m1.6.6.1.1.2" xref="S2.E10.m1.6.6.1.1.2.cmml">⁢</mo><msubsup id="S2.E10.m1.6.6.1.1.3" xref="S2.E10.m1.6.6.1.1.3.cmml"><mi id="S2.E10.m1.6.6.1.1.3.2.2" xref="S2.E10.m1.6.6.1.1.3.2.2.cmml">𝑾</mi><mi id="S2.E10.m1.6.6.1.1.3.2.3" xref="S2.E10.m1.6.6.1.1.3.2.3.cmml">δ</mi><mrow id="S2.E10.m1.3.3.1.3" xref="S2.E10.m1.6.6.1.1.3.cmml"><mo id="S2.E10.m1.3.3.1.3.1" stretchy="false" xref="S2.E10.m1.6.6.1.1.3.cmml">(</mo><mn id="S2.E10.m1.3.3.1.1" xref="S2.E10.m1.3.3.1.1.cmml">4</mn><mo id="S2.E10.m1.3.3.1.3.2" stretchy="false" xref="S2.E10.m1.6.6.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S2.E10.m1.6.6.1.2" xref="S2.E10.m1.6.6.1.2.cmml">+</mo><msubsup id="S2.E10.m1.6.6.1.3" xref="S2.E10.m1.6.6.1.3.cmml"><mi id="S2.E10.m1.6.6.1.3.2.2" xref="S2.E10.m1.6.6.1.3.2.2.cmml">b</mi><mi id="S2.E10.m1.6.6.1.3.2.3" xref="S2.E10.m1.6.6.1.3.2.3.cmml">δ</mi><mrow id="S2.E10.m1.4.4.1.3" xref="S2.E10.m1.6.6.1.3.cmml"><mo id="S2.E10.m1.4.4.1.3.1" stretchy="false" xref="S2.E10.m1.6.6.1.3.cmml">(</mo><mn id="S2.E10.m1.4.4.1.1" xref="S2.E10.m1.4.4.1.1.cmml">4</mn><mo id="S2.E10.m1.4.4.1.3.2" stretchy="false" xref="S2.E10.m1.6.6.1.3.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.6b"><apply id="S2.E10.m1.6.6.cmml" xref="S2.E10.m1.6.6"><eq id="S2.E10.m1.6.6.2.cmml" xref="S2.E10.m1.6.6.2"></eq><apply id="S2.E10.m1.6.6.3.cmml" xref="S2.E10.m1.6.6.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.3.1.cmml" xref="S2.E10.m1.6.6.3">subscript</csymbol><ci id="S2.E10.m1.6.6.3.2.cmml" xref="S2.E10.m1.6.6.3.2">𝑹</ci><cn id="S2.E10.m1.6.6.3.3.cmml" type="integer" xref="S2.E10.m1.6.6.3.3">0</cn></apply><apply id="S2.E10.m1.6.6.1.cmml" xref="S2.E10.m1.6.6.1"><plus id="S2.E10.m1.6.6.1.2.cmml" xref="S2.E10.m1.6.6.1.2"></plus><apply id="S2.E10.m1.6.6.1.1.cmml" xref="S2.E10.m1.6.6.1.1"><times id="S2.E10.m1.6.6.1.1.2.cmml" xref="S2.E10.m1.6.6.1.1.2"></times><apply id="S2.E10.m1.6.6.1.1.1.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1"><ci id="S2.E10.m1.5.5.cmml" xref="S2.E10.m1.5.5">GELU</ci><apply id="S2.E10.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1"><plus id="S2.E10.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.1"></plus><apply id="S2.E10.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2"><times id="S2.E10.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.1"></times><apply id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2"><ci id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.2.2">𝒁</ci></apply><cn id="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.3.cmml" type="integer" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.2.3">0</cn></apply><apply id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.2">𝑾</ci><ci id="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.3.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.2.3.2.3">𝛿</ci></apply><cn id="S2.E10.m1.1.1.1.1.cmml" type="integer" xref="S2.E10.m1.1.1.1.1">3</cn></apply></apply><apply id="S2.E10.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.2">𝑏</ci><ci id="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E10.m1.6.6.1.1.1.1.1.1.3.2.3">𝛿</ci></apply><cn id="S2.E10.m1.2.2.1.1.cmml" type="integer" xref="S2.E10.m1.2.2.1.1">3</cn></apply></apply></apply><apply id="S2.E10.m1.6.6.1.1.3.cmml" xref="S2.E10.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.1.3.1.cmml" xref="S2.E10.m1.6.6.1.1.3">superscript</csymbol><apply id="S2.E10.m1.6.6.1.1.3.2.cmml" xref="S2.E10.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.1.3.2.1.cmml" xref="S2.E10.m1.6.6.1.1.3">subscript</csymbol><ci id="S2.E10.m1.6.6.1.1.3.2.2.cmml" xref="S2.E10.m1.6.6.1.1.3.2.2">𝑾</ci><ci id="S2.E10.m1.6.6.1.1.3.2.3.cmml" xref="S2.E10.m1.6.6.1.1.3.2.3">𝛿</ci></apply><cn id="S2.E10.m1.3.3.1.1.cmml" type="integer" xref="S2.E10.m1.3.3.1.1">4</cn></apply></apply><apply id="S2.E10.m1.6.6.1.3.cmml" xref="S2.E10.m1.6.6.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.3.1.cmml" xref="S2.E10.m1.6.6.1.3">superscript</csymbol><apply id="S2.E10.m1.6.6.1.3.2.cmml" xref="S2.E10.m1.6.6.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.6.6.1.3.2.1.cmml" xref="S2.E10.m1.6.6.1.3">subscript</csymbol><ci id="S2.E10.m1.6.6.1.3.2.2.cmml" xref="S2.E10.m1.6.6.1.3.2.2">𝑏</ci><ci id="S2.E10.m1.6.6.1.3.2.3.cmml" xref="S2.E10.m1.6.6.1.3.2.3">𝛿</ci></apply><cn id="S2.E10.m1.4.4.1.1.cmml" type="integer" xref="S2.E10.m1.4.4.1.1">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.6c">\boldsymbol{R}_{0}=\operatorname{GELU}\left(\hat{\boldsymbol{Z}}_{0}%
\boldsymbol{W}_{\delta}^{(3)}+b_{\delta}^{(3)}\right)\boldsymbol{W}_{\delta}^{%
(4)}+b_{\delta}^{(4)}</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.6d">bold_italic_R start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = roman_GELU ( over^ start_ARG bold_italic_Z end_ARG start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT bold_italic_W start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 3 ) end_POSTSUPERSCRIPT + italic_b start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 3 ) end_POSTSUPERSCRIPT ) bold_italic_W start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 4 ) end_POSTSUPERSCRIPT + italic_b start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 4 ) end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p1.4">where <math alttext="\boldsymbol{W}_{\delta}^{(3)}\in\mathbb{R}^{D\times 4D},\boldsymbol{W}_{\delta%
}^{(4)}\in\mathbb{R}^{4D\times D},b_{\delta}^{(3)}\in\mathbb{R}^{4D},b_{\delta%
}^{(4)}\in\mathbb{R}^{D}" class="ltx_Math" display="inline" id="S2.SS4.p1.1.m1.6"><semantics id="S2.SS4.p1.1.m1.6a"><mrow id="S2.SS4.p1.1.m1.6.6.2" xref="S2.SS4.p1.1.m1.6.6.3.cmml"><mrow id="S2.SS4.p1.1.m1.5.5.1.1" xref="S2.SS4.p1.1.m1.5.5.1.1.cmml"><msubsup id="S2.SS4.p1.1.m1.5.5.1.1.2" xref="S2.SS4.p1.1.m1.5.5.1.1.2.cmml"><mi id="S2.SS4.p1.1.m1.5.5.1.1.2.2.2" xref="S2.SS4.p1.1.m1.5.5.1.1.2.2.2.cmml">𝑾</mi><mi id="S2.SS4.p1.1.m1.5.5.1.1.2.2.3" xref="S2.SS4.p1.1.m1.5.5.1.1.2.2.3.cmml">δ</mi><mrow id="S2.SS4.p1.1.m1.1.1.1.3" xref="S2.SS4.p1.1.m1.5.5.1.1.2.cmml"><mo id="S2.SS4.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.SS4.p1.1.m1.5.5.1.1.2.cmml">(</mo><mn id="S2.SS4.p1.1.m1.1.1.1.1" xref="S2.SS4.p1.1.m1.1.1.1.1.cmml">3</mn><mo id="S2.SS4.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.SS4.p1.1.m1.5.5.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS4.p1.1.m1.5.5.1.1.1" xref="S2.SS4.p1.1.m1.5.5.1.1.1.cmml">∈</mo><msup id="S2.SS4.p1.1.m1.5.5.1.1.3" xref="S2.SS4.p1.1.m1.5.5.1.1.3.cmml"><mi id="S2.SS4.p1.1.m1.5.5.1.1.3.2" xref="S2.SS4.p1.1.m1.5.5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p1.1.m1.5.5.1.1.3.3" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.cmml"><mrow id="S2.SS4.p1.1.m1.5.5.1.1.3.3.2" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.cmml"><mi id="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.2" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.2.cmml">D</mi><mo id="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.1.cmml">×</mo><mn id="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.3" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.3.cmml">4</mn></mrow><mo id="S2.SS4.p1.1.m1.5.5.1.1.3.3.1" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.1.m1.5.5.1.1.3.3.3" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><mo id="S2.SS4.p1.1.m1.6.6.2.3" xref="S2.SS4.p1.1.m1.6.6.3a.cmml">,</mo><mrow id="S2.SS4.p1.1.m1.6.6.2.2.2" xref="S2.SS4.p1.1.m1.6.6.2.2.3.cmml"><mrow id="S2.SS4.p1.1.m1.6.6.2.2.1.1" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.cmml"><msubsup id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.cmml"><mi id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.2" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.2.cmml">𝑾</mi><mi id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.3" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.3.cmml">δ</mi><mrow id="S2.SS4.p1.1.m1.2.2.1.3" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.cmml"><mo id="S2.SS4.p1.1.m1.2.2.1.3.1" stretchy="false" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.cmml">(</mo><mn id="S2.SS4.p1.1.m1.2.2.1.1" xref="S2.SS4.p1.1.m1.2.2.1.1.cmml">4</mn><mo id="S2.SS4.p1.1.m1.2.2.1.3.2" stretchy="false" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS4.p1.1.m1.6.6.2.2.1.1.1" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.1.cmml">∈</mo><msup id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.cmml"><mi id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.2" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.cmml"><mrow id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.cmml"><mn id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.2" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.2.cmml">4</mn><mo id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.1" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.3" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.3.cmml">D</mi></mrow><mo id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.3" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><mo id="S2.SS4.p1.1.m1.6.6.2.2.2.3" xref="S2.SS4.p1.1.m1.6.6.2.2.3a.cmml">,</mo><mrow id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.3.cmml"><mrow id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.cmml"><msubsup id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.cmml"><mi id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.2.cmml">b</mi><mi id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.3.cmml">δ</mi><mrow id="S2.SS4.p1.1.m1.3.3.1.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.cmml"><mo id="S2.SS4.p1.1.m1.3.3.1.3.1" stretchy="false" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.cmml">(</mo><mn id="S2.SS4.p1.1.m1.3.3.1.1" xref="S2.SS4.p1.1.m1.3.3.1.1.cmml">3</mn><mo id="S2.SS4.p1.1.m1.3.3.1.3.2" stretchy="false" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.1" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.1.cmml">∈</mo><msup id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.cmml"><mi id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.cmml"><mn id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.2.cmml">4</mn><mo id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.1" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.3.cmml">D</mi></mrow></msup></mrow><mo id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.3a.cmml">,</mo><mrow id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.cmml"><msubsup id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.cmml"><mi id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.2.cmml">b</mi><mi id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.3.cmml">δ</mi><mrow id="S2.SS4.p1.1.m1.4.4.1.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.cmml"><mo id="S2.SS4.p1.1.m1.4.4.1.3.1" stretchy="false" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.cmml">(</mo><mn id="S2.SS4.p1.1.m1.4.4.1.1" xref="S2.SS4.p1.1.m1.4.4.1.1.cmml">4</mn><mo id="S2.SS4.p1.1.m1.4.4.1.3.2" stretchy="false" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.1" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.1.cmml">∈</mo><msup id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.cmml"><mi id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.2" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.2.cmml">ℝ</mi><mi id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.3" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.3.cmml">D</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.1.m1.6b"><apply id="S2.SS4.p1.1.m1.6.6.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.3a.cmml" xref="S2.SS4.p1.1.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S2.SS4.p1.1.m1.5.5.1.1.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1"><in id="S2.SS4.p1.1.m1.5.5.1.1.1.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.1"></in><apply id="S2.SS4.p1.1.m1.5.5.1.1.2.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.5.5.1.1.2.1.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.2">superscript</csymbol><apply id="S2.SS4.p1.1.m1.5.5.1.1.2.2.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.5.5.1.1.2.2.1.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.2">subscript</csymbol><ci id="S2.SS4.p1.1.m1.5.5.1.1.2.2.2.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.2.2.2">𝑾</ci><ci id="S2.SS4.p1.1.m1.5.5.1.1.2.2.3.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.2.2.3">𝛿</ci></apply><cn id="S2.SS4.p1.1.m1.1.1.1.1.cmml" type="integer" xref="S2.SS4.p1.1.m1.1.1.1.1">3</cn></apply><apply id="S2.SS4.p1.1.m1.5.5.1.1.3.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.5.5.1.1.3.1.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3">superscript</csymbol><ci id="S2.SS4.p1.1.m1.5.5.1.1.3.2.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3.2">ℝ</ci><apply id="S2.SS4.p1.1.m1.5.5.1.1.3.3.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3"><times id="S2.SS4.p1.1.m1.5.5.1.1.3.3.1.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.1"></times><apply id="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.2"><times id="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.1.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.1"></times><ci id="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.2.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.2">𝐷</ci><cn id="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.3.cmml" type="integer" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.2.3">4</cn></apply><ci id="S2.SS4.p1.1.m1.5.5.1.1.3.3.3.cmml" xref="S2.SS4.p1.1.m1.5.5.1.1.3.3.3">𝐷</ci></apply></apply></apply><apply id="S2.SS4.p1.1.m1.6.6.2.2.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.3a.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS4.p1.1.m1.6.6.2.2.1.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1"><in id="S2.SS4.p1.1.m1.6.6.2.2.1.1.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.1"></in><apply id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2">superscript</csymbol><apply id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2">subscript</csymbol><ci id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.2">𝑾</ci><ci id="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.2.2.3">𝛿</ci></apply><cn id="S2.SS4.p1.1.m1.2.2.1.1.cmml" type="integer" xref="S2.SS4.p1.1.m1.2.2.1.1">4</cn></apply><apply id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3">superscript</csymbol><ci id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.2">ℝ</ci><apply id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3"><times id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.1"></times><apply id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2"><times id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.1"></times><cn id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.2.cmml" type="integer" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.2">4</cn><ci id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.2.3">𝐷</ci></apply><ci id="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.1.1.3.3.3">𝐷</ci></apply></apply></apply><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.2.2.3a.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1"><in id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.1"></in><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2">superscript</csymbol><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.2">𝑏</ci><ci id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.2.2.3">𝛿</ci></apply><cn id="S2.SS4.p1.1.m1.3.3.1.1.cmml" type="integer" xref="S2.SS4.p1.1.m1.3.3.1.1">3</cn></apply><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3">superscript</csymbol><ci id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.2">ℝ</ci><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3"><times id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.1"></times><cn id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.2.cmml" type="integer" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.2">4</cn><ci id="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.1.1.3.3.3">𝐷</ci></apply></apply></apply><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2"><in id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.1"></in><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2">superscript</csymbol><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.2">𝑏</ci><ci id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.2.2.3">𝛿</ci></apply><cn id="S2.SS4.p1.1.m1.4.4.1.1.cmml" type="integer" xref="S2.SS4.p1.1.m1.4.4.1.1">4</cn></apply><apply id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.1.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3">superscript</csymbol><ci id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.2.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.2">ℝ</ci><ci id="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.3.cmml" xref="S2.SS4.p1.1.m1.6.6.2.2.2.2.2.2.3.3">𝐷</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.1.m1.6c">\boldsymbol{W}_{\delta}^{(3)}\in\mathbb{R}^{D\times 4D},\boldsymbol{W}_{\delta%
}^{(4)}\in\mathbb{R}^{4D\times D},b_{\delta}^{(3)}\in\mathbb{R}^{4D},b_{\delta%
}^{(4)}\in\mathbb{R}^{D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.1.m1.6d">bold_italic_W start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 3 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D × 4 italic_D end_POSTSUPERSCRIPT , bold_italic_W start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 4 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 4 italic_D × italic_D end_POSTSUPERSCRIPT , italic_b start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 3 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT 4 italic_D end_POSTSUPERSCRIPT , italic_b start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 4 ) end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> are parameters of two dense layers, <math alttext="\boldsymbol{R}_{0}" class="ltx_Math" display="inline" id="S2.SS4.p1.2.m2.1"><semantics id="S2.SS4.p1.2.m2.1a"><msub id="S2.SS4.p1.2.m2.1.1" xref="S2.SS4.p1.2.m2.1.1.cmml"><mi id="S2.SS4.p1.2.m2.1.1.2" xref="S2.SS4.p1.2.m2.1.1.2.cmml">𝑹</mi><mn id="S2.SS4.p1.2.m2.1.1.3" xref="S2.SS4.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.2.m2.1b"><apply id="S2.SS4.p1.2.m2.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p1.2.m2.1.1.1.cmml" xref="S2.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS4.p1.2.m2.1.1.2.cmml" xref="S2.SS4.p1.2.m2.1.1.2">𝑹</ci><cn id="S2.SS4.p1.2.m2.1.1.3.cmml" type="integer" xref="S2.SS4.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.2.m2.1c">\boldsymbol{R}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.2.m2.1d">bold_italic_R start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> represents the user representation. After that, we employ a layer normalization and a residual path to stabilize the training process and ensure that the gradients flow more effectively through the network. To maintain generality, the subscript <math alttext="\left(0\right)" class="ltx_Math" display="inline" id="S2.SS4.p1.3.m3.1"><semantics id="S2.SS4.p1.3.m3.1a"><mrow id="S2.SS4.p1.3.m3.1.2.2"><mo id="S2.SS4.p1.3.m3.1.2.2.1">(</mo><mn id="S2.SS4.p1.3.m3.1.1" xref="S2.SS4.p1.3.m3.1.1.cmml">0</mn><mo id="S2.SS4.p1.3.m3.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.3.m3.1b"><cn id="S2.SS4.p1.3.m3.1.1.cmml" type="integer" xref="S2.SS4.p1.3.m3.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.3.m3.1c">\left(0\right)</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.3.m3.1d">( 0 )</annotation></semantics></math> here only denotes that the final user representation is obtained by <math alttext="1" class="ltx_Math" display="inline" id="S2.SS4.p1.4.m4.1"><semantics id="S2.SS4.p1.4.m4.1a"><mn id="S2.SS4.p1.4.m4.1.1" xref="S2.SS4.p1.4.m4.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S2.SS4.p1.4.m4.1b"><cn id="S2.SS4.p1.4.m4.1.1.cmml" type="integer" xref="S2.SS4.p1.4.m4.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p1.4.m4.1c">1</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p1.4.m4.1d">1</annotation></semantics></math> SIGMA layer. Actually, we can stack more such layers to better capture complex user preferences.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5. </span>Train and Inference</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.3">In this subsection, we will present some details about the training and inference progress in our framework. As mentioned in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.E10" title="In 2.4. PFFN Network ‣ 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">10</span></a>), we get the mixed hidden state representation <math alttext="\boldsymbol{R}_{0}" class="ltx_Math" display="inline" id="S2.SS5.p1.1.m1.1"><semantics id="S2.SS5.p1.1.m1.1a"><msub id="S2.SS5.p1.1.m1.1.1" xref="S2.SS5.p1.1.m1.1.1.cmml"><mi id="S2.SS5.p1.1.m1.1.1.2" xref="S2.SS5.p1.1.m1.1.1.2.cmml">𝑹</mi><mn id="S2.SS5.p1.1.m1.1.1.3" xref="S2.SS5.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.1b"><apply id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.1.m1.1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS5.p1.1.m1.1.1.2.cmml" xref="S2.SS5.p1.1.m1.1.1.2">𝑹</ci><cn id="S2.SS5.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.SS5.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.1c">\boldsymbol{R}_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.1.m1.1d">bold_italic_R start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, which involves the sequential information for the first <math alttext="{N}" class="ltx_Math" display="inline" id="S2.SS5.p1.2.m2.1"><semantics id="S2.SS5.p1.2.m2.1a"><mi id="S2.SS5.p1.2.m2.1.1" xref="S2.SS5.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.2.m2.1b"><ci id="S2.SS5.p1.2.m2.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.2.m2.1c">{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.2.m2.1d">italic_N</annotation></semantics></math> items. Assuming the embedding for items as <math alttext="\mathbf{H}^{item}=\left[\mathbf{h}_{1}^{item},\mathbf{h}_{2}^{item},\cdots,%
\mathbf{h}_{K}^{item}\right]\in\mathbb{R}^{K\times D}" class="ltx_Math" display="inline" id="S2.SS5.p1.3.m3.4"><semantics id="S2.SS5.p1.3.m3.4a"><mrow id="S2.SS5.p1.3.m3.4.4" xref="S2.SS5.p1.3.m3.4.4.cmml"><msup id="S2.SS5.p1.3.m3.4.4.5" xref="S2.SS5.p1.3.m3.4.4.5.cmml"><mi id="S2.SS5.p1.3.m3.4.4.5.2" xref="S2.SS5.p1.3.m3.4.4.5.2.cmml">𝐇</mi><mrow id="S2.SS5.p1.3.m3.4.4.5.3" xref="S2.SS5.p1.3.m3.4.4.5.3.cmml"><mi id="S2.SS5.p1.3.m3.4.4.5.3.2" xref="S2.SS5.p1.3.m3.4.4.5.3.2.cmml">i</mi><mo id="S2.SS5.p1.3.m3.4.4.5.3.1" xref="S2.SS5.p1.3.m3.4.4.5.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.4.4.5.3.3" xref="S2.SS5.p1.3.m3.4.4.5.3.3.cmml">t</mi><mo id="S2.SS5.p1.3.m3.4.4.5.3.1a" xref="S2.SS5.p1.3.m3.4.4.5.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.4.4.5.3.4" xref="S2.SS5.p1.3.m3.4.4.5.3.4.cmml">e</mi><mo id="S2.SS5.p1.3.m3.4.4.5.3.1b" xref="S2.SS5.p1.3.m3.4.4.5.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.4.4.5.3.5" xref="S2.SS5.p1.3.m3.4.4.5.3.5.cmml">m</mi></mrow></msup><mo id="S2.SS5.p1.3.m3.4.4.6" xref="S2.SS5.p1.3.m3.4.4.6.cmml">=</mo><mrow id="S2.SS5.p1.3.m3.4.4.3.3" xref="S2.SS5.p1.3.m3.4.4.3.4.cmml"><mo id="S2.SS5.p1.3.m3.4.4.3.3.4" xref="S2.SS5.p1.3.m3.4.4.3.4.cmml">[</mo><msubsup id="S2.SS5.p1.3.m3.2.2.1.1.1" xref="S2.SS5.p1.3.m3.2.2.1.1.1.cmml"><mi id="S2.SS5.p1.3.m3.2.2.1.1.1.2.2" xref="S2.SS5.p1.3.m3.2.2.1.1.1.2.2.cmml">𝐡</mi><mn id="S2.SS5.p1.3.m3.2.2.1.1.1.2.3" xref="S2.SS5.p1.3.m3.2.2.1.1.1.2.3.cmml">1</mn><mrow id="S2.SS5.p1.3.m3.2.2.1.1.1.3" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.cmml"><mi id="S2.SS5.p1.3.m3.2.2.1.1.1.3.2" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.2.cmml">i</mi><mo id="S2.SS5.p1.3.m3.2.2.1.1.1.3.1" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.2.2.1.1.1.3.3" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.3.cmml">t</mi><mo id="S2.SS5.p1.3.m3.2.2.1.1.1.3.1a" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.2.2.1.1.1.3.4" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.4.cmml">e</mi><mo id="S2.SS5.p1.3.m3.2.2.1.1.1.3.1b" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.2.2.1.1.1.3.5" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.5.cmml">m</mi></mrow></msubsup><mo id="S2.SS5.p1.3.m3.4.4.3.3.5" xref="S2.SS5.p1.3.m3.4.4.3.4.cmml">,</mo><msubsup id="S2.SS5.p1.3.m3.3.3.2.2.2" xref="S2.SS5.p1.3.m3.3.3.2.2.2.cmml"><mi id="S2.SS5.p1.3.m3.3.3.2.2.2.2.2" xref="S2.SS5.p1.3.m3.3.3.2.2.2.2.2.cmml">𝐡</mi><mn id="S2.SS5.p1.3.m3.3.3.2.2.2.2.3" xref="S2.SS5.p1.3.m3.3.3.2.2.2.2.3.cmml">2</mn><mrow id="S2.SS5.p1.3.m3.3.3.2.2.2.3" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.cmml"><mi id="S2.SS5.p1.3.m3.3.3.2.2.2.3.2" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.2.cmml">i</mi><mo id="S2.SS5.p1.3.m3.3.3.2.2.2.3.1" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.3.3.2.2.2.3.3" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.3.cmml">t</mi><mo id="S2.SS5.p1.3.m3.3.3.2.2.2.3.1a" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.3.3.2.2.2.3.4" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.4.cmml">e</mi><mo id="S2.SS5.p1.3.m3.3.3.2.2.2.3.1b" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.3.3.2.2.2.3.5" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.5.cmml">m</mi></mrow></msubsup><mo id="S2.SS5.p1.3.m3.4.4.3.3.6" xref="S2.SS5.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S2.SS5.p1.3.m3.1.1" mathvariant="normal" xref="S2.SS5.p1.3.m3.1.1.cmml">⋯</mi><mo id="S2.SS5.p1.3.m3.4.4.3.3.7" xref="S2.SS5.p1.3.m3.4.4.3.4.cmml">,</mo><msubsup id="S2.SS5.p1.3.m3.4.4.3.3.3" xref="S2.SS5.p1.3.m3.4.4.3.3.3.cmml"><mi id="S2.SS5.p1.3.m3.4.4.3.3.3.2.2" xref="S2.SS5.p1.3.m3.4.4.3.3.3.2.2.cmml">𝐡</mi><mi id="S2.SS5.p1.3.m3.4.4.3.3.3.2.3" xref="S2.SS5.p1.3.m3.4.4.3.3.3.2.3.cmml">K</mi><mrow id="S2.SS5.p1.3.m3.4.4.3.3.3.3" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.cmml"><mi id="S2.SS5.p1.3.m3.4.4.3.3.3.3.2" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.2.cmml">i</mi><mo id="S2.SS5.p1.3.m3.4.4.3.3.3.3.1" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.4.4.3.3.3.3.3" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.3.cmml">t</mi><mo id="S2.SS5.p1.3.m3.4.4.3.3.3.3.1a" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.4.4.3.3.3.3.4" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.4.cmml">e</mi><mo id="S2.SS5.p1.3.m3.4.4.3.3.3.3.1b" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.3.m3.4.4.3.3.3.3.5" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.5.cmml">m</mi></mrow></msubsup><mo id="S2.SS5.p1.3.m3.4.4.3.3.8" xref="S2.SS5.p1.3.m3.4.4.3.4.cmml">]</mo></mrow><mo id="S2.SS5.p1.3.m3.4.4.7" xref="S2.SS5.p1.3.m3.4.4.7.cmml">∈</mo><msup id="S2.SS5.p1.3.m3.4.4.8" xref="S2.SS5.p1.3.m3.4.4.8.cmml"><mi id="S2.SS5.p1.3.m3.4.4.8.2" xref="S2.SS5.p1.3.m3.4.4.8.2.cmml">ℝ</mi><mrow id="S2.SS5.p1.3.m3.4.4.8.3" xref="S2.SS5.p1.3.m3.4.4.8.3.cmml"><mi id="S2.SS5.p1.3.m3.4.4.8.3.2" xref="S2.SS5.p1.3.m3.4.4.8.3.2.cmml">K</mi><mo id="S2.SS5.p1.3.m3.4.4.8.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS5.p1.3.m3.4.4.8.3.1.cmml">×</mo><mi id="S2.SS5.p1.3.m3.4.4.8.3.3" xref="S2.SS5.p1.3.m3.4.4.8.3.3.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.3.m3.4b"><apply id="S2.SS5.p1.3.m3.4.4.cmml" xref="S2.SS5.p1.3.m3.4.4"><and id="S2.SS5.p1.3.m3.4.4a.cmml" xref="S2.SS5.p1.3.m3.4.4"></and><apply id="S2.SS5.p1.3.m3.4.4b.cmml" xref="S2.SS5.p1.3.m3.4.4"><eq id="S2.SS5.p1.3.m3.4.4.6.cmml" xref="S2.SS5.p1.3.m3.4.4.6"></eq><apply id="S2.SS5.p1.3.m3.4.4.5.cmml" xref="S2.SS5.p1.3.m3.4.4.5"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.4.4.5.1.cmml" xref="S2.SS5.p1.3.m3.4.4.5">superscript</csymbol><ci id="S2.SS5.p1.3.m3.4.4.5.2.cmml" xref="S2.SS5.p1.3.m3.4.4.5.2">𝐇</ci><apply id="S2.SS5.p1.3.m3.4.4.5.3.cmml" xref="S2.SS5.p1.3.m3.4.4.5.3"><times id="S2.SS5.p1.3.m3.4.4.5.3.1.cmml" xref="S2.SS5.p1.3.m3.4.4.5.3.1"></times><ci id="S2.SS5.p1.3.m3.4.4.5.3.2.cmml" xref="S2.SS5.p1.3.m3.4.4.5.3.2">𝑖</ci><ci id="S2.SS5.p1.3.m3.4.4.5.3.3.cmml" xref="S2.SS5.p1.3.m3.4.4.5.3.3">𝑡</ci><ci id="S2.SS5.p1.3.m3.4.4.5.3.4.cmml" xref="S2.SS5.p1.3.m3.4.4.5.3.4">𝑒</ci><ci id="S2.SS5.p1.3.m3.4.4.5.3.5.cmml" xref="S2.SS5.p1.3.m3.4.4.5.3.5">𝑚</ci></apply></apply><list id="S2.SS5.p1.3.m3.4.4.3.4.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3"><apply id="S2.SS5.p1.3.m3.2.2.1.1.1.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1">superscript</csymbol><apply id="S2.SS5.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.2.2.1.1.1.2.1.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S2.SS5.p1.3.m3.2.2.1.1.1.2.2.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1.2.2">𝐡</ci><cn id="S2.SS5.p1.3.m3.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS5.p1.3.m3.2.2.1.1.1.2.3">1</cn></apply><apply id="S2.SS5.p1.3.m3.2.2.1.1.1.3.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3"><times id="S2.SS5.p1.3.m3.2.2.1.1.1.3.1.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.1"></times><ci id="S2.SS5.p1.3.m3.2.2.1.1.1.3.2.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.2">𝑖</ci><ci id="S2.SS5.p1.3.m3.2.2.1.1.1.3.3.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.3">𝑡</ci><ci id="S2.SS5.p1.3.m3.2.2.1.1.1.3.4.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.4">𝑒</ci><ci id="S2.SS5.p1.3.m3.2.2.1.1.1.3.5.cmml" xref="S2.SS5.p1.3.m3.2.2.1.1.1.3.5">𝑚</ci></apply></apply><apply id="S2.SS5.p1.3.m3.3.3.2.2.2.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.3.3.2.2.2.1.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2">superscript</csymbol><apply id="S2.SS5.p1.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.3.3.2.2.2.2.1.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S2.SS5.p1.3.m3.3.3.2.2.2.2.2.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2.2.2">𝐡</ci><cn id="S2.SS5.p1.3.m3.3.3.2.2.2.2.3.cmml" type="integer" xref="S2.SS5.p1.3.m3.3.3.2.2.2.2.3">2</cn></apply><apply id="S2.SS5.p1.3.m3.3.3.2.2.2.3.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3"><times id="S2.SS5.p1.3.m3.3.3.2.2.2.3.1.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.1"></times><ci id="S2.SS5.p1.3.m3.3.3.2.2.2.3.2.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.2">𝑖</ci><ci id="S2.SS5.p1.3.m3.3.3.2.2.2.3.3.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.3">𝑡</ci><ci id="S2.SS5.p1.3.m3.3.3.2.2.2.3.4.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.4">𝑒</ci><ci id="S2.SS5.p1.3.m3.3.3.2.2.2.3.5.cmml" xref="S2.SS5.p1.3.m3.3.3.2.2.2.3.5">𝑚</ci></apply></apply><ci id="S2.SS5.p1.3.m3.1.1.cmml" xref="S2.SS5.p1.3.m3.1.1">⋯</ci><apply id="S2.SS5.p1.3.m3.4.4.3.3.3.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.4.4.3.3.3.1.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3">superscript</csymbol><apply id="S2.SS5.p1.3.m3.4.4.3.3.3.2.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.4.4.3.3.3.2.1.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S2.SS5.p1.3.m3.4.4.3.3.3.2.2.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3.2.2">𝐡</ci><ci id="S2.SS5.p1.3.m3.4.4.3.3.3.2.3.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3.2.3">𝐾</ci></apply><apply id="S2.SS5.p1.3.m3.4.4.3.3.3.3.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3"><times id="S2.SS5.p1.3.m3.4.4.3.3.3.3.1.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.1"></times><ci id="S2.SS5.p1.3.m3.4.4.3.3.3.3.2.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.2">𝑖</ci><ci id="S2.SS5.p1.3.m3.4.4.3.3.3.3.3.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.3">𝑡</ci><ci id="S2.SS5.p1.3.m3.4.4.3.3.3.3.4.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.4">𝑒</ci><ci id="S2.SS5.p1.3.m3.4.4.3.3.3.3.5.cmml" xref="S2.SS5.p1.3.m3.4.4.3.3.3.3.5">𝑚</ci></apply></apply></list></apply><apply id="S2.SS5.p1.3.m3.4.4c.cmml" xref="S2.SS5.p1.3.m3.4.4"><in id="S2.SS5.p1.3.m3.4.4.7.cmml" xref="S2.SS5.p1.3.m3.4.4.7"></in><share href="https://arxiv.org/html/2408.11451v2#S2.SS5.p1.3.m3.4.4.3.cmml" id="S2.SS5.p1.3.m3.4.4d.cmml" xref="S2.SS5.p1.3.m3.4.4"></share><apply id="S2.SS5.p1.3.m3.4.4.8.cmml" xref="S2.SS5.p1.3.m3.4.4.8"><csymbol cd="ambiguous" id="S2.SS5.p1.3.m3.4.4.8.1.cmml" xref="S2.SS5.p1.3.m3.4.4.8">superscript</csymbol><ci id="S2.SS5.p1.3.m3.4.4.8.2.cmml" xref="S2.SS5.p1.3.m3.4.4.8.2">ℝ</ci><apply id="S2.SS5.p1.3.m3.4.4.8.3.cmml" xref="S2.SS5.p1.3.m3.4.4.8.3"><times id="S2.SS5.p1.3.m3.4.4.8.3.1.cmml" xref="S2.SS5.p1.3.m3.4.4.8.3.1"></times><ci id="S2.SS5.p1.3.m3.4.4.8.3.2.cmml" xref="S2.SS5.p1.3.m3.4.4.8.3.2">𝐾</ci><ci id="S2.SS5.p1.3.m3.4.4.8.3.3.cmml" xref="S2.SS5.p1.3.m3.4.4.8.3.3">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.3.m3.4c">\mathbf{H}^{item}=\left[\mathbf{h}_{1}^{item},\mathbf{h}_{2}^{item},\cdots,%
\mathbf{h}_{K}^{item}\right]\in\mathbb{R}^{K\times D}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.3.m3.4d">bold_H start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT = [ bold_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT , bold_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT , ⋯ , bold_h start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT ] ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, where K denotes the total number of items. The details for the next-item prediction can be formalized as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S2.E11">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E11X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{logits}_{ik}=\sum_{j=1}^{d}\mathbf{R}_{ij}\cdot\mathbf{H}_{%
kj}^{item}" class="ltx_Math" display="inline" id="S2.E11X.2.1.1.m1.1"><semantics id="S2.E11X.2.1.1.m1.1a"><mrow id="S2.E11X.2.1.1.m1.1.1" xref="S2.E11X.2.1.1.m1.1.1.cmml"><msub id="S2.E11X.2.1.1.m1.1.1.2" xref="S2.E11X.2.1.1.m1.1.1.2.cmml"><mtext id="S2.E11X.2.1.1.m1.1.1.2.2" xref="S2.E11X.2.1.1.m1.1.1.2.2a.cmml">logits</mtext><mrow id="S2.E11X.2.1.1.m1.1.1.2.3" xref="S2.E11X.2.1.1.m1.1.1.2.3.cmml"><mi id="S2.E11X.2.1.1.m1.1.1.2.3.2" xref="S2.E11X.2.1.1.m1.1.1.2.3.2.cmml">i</mi><mo id="S2.E11X.2.1.1.m1.1.1.2.3.1" xref="S2.E11X.2.1.1.m1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.E11X.2.1.1.m1.1.1.2.3.3" xref="S2.E11X.2.1.1.m1.1.1.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.E11X.2.1.1.m1.1.1.1" xref="S2.E11X.2.1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.E11X.2.1.1.m1.1.1.3" xref="S2.E11X.2.1.1.m1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.E11X.2.1.1.m1.1.1.3.1" xref="S2.E11X.2.1.1.m1.1.1.3.1.cmml"><munderover id="S2.E11X.2.1.1.m1.1.1.3.1a" xref="S2.E11X.2.1.1.m1.1.1.3.1.cmml"><mo id="S2.E11X.2.1.1.m1.1.1.3.1.2.2" movablelimits="false" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S2.E11X.2.1.1.m1.1.1.3.1.2.3" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.3.cmml"><mi id="S2.E11X.2.1.1.m1.1.1.3.1.2.3.2" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.3.2.cmml">j</mi><mo id="S2.E11X.2.1.1.m1.1.1.3.1.2.3.1" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S2.E11X.2.1.1.m1.1.1.3.1.2.3.3" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E11X.2.1.1.m1.1.1.3.1.3" xref="S2.E11X.2.1.1.m1.1.1.3.1.3.cmml">d</mi></munderover></mstyle><mrow id="S2.E11X.2.1.1.m1.1.1.3.2" xref="S2.E11X.2.1.1.m1.1.1.3.2.cmml"><msub id="S2.E11X.2.1.1.m1.1.1.3.2.2" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.cmml"><mi id="S2.E11X.2.1.1.m1.1.1.3.2.2.2" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.2.cmml">𝐑</mi><mrow id="S2.E11X.2.1.1.m1.1.1.3.2.2.3" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.3.cmml"><mi id="S2.E11X.2.1.1.m1.1.1.3.2.2.3.2" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.3.2.cmml">i</mi><mo id="S2.E11X.2.1.1.m1.1.1.3.2.2.3.1" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.3.1.cmml">⁢</mo><mi id="S2.E11X.2.1.1.m1.1.1.3.2.2.3.3" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S2.E11X.2.1.1.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E11X.2.1.1.m1.1.1.3.2.1.cmml">⋅</mo><msubsup id="S2.E11X.2.1.1.m1.1.1.3.2.3" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.cmml"><mi id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.2" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.2.cmml">𝐇</mi><mrow id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.cmml"><mi id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.2" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.2.cmml">k</mi><mo id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.1" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.1.cmml">⁢</mo><mi id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.3" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.3.cmml">j</mi></mrow><mrow id="S2.E11X.2.1.1.m1.1.1.3.2.3.3" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.cmml"><mi id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.2" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.2.cmml">i</mi><mo id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.1" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.3" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.3.cmml">t</mi><mo id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.1a" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.4" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.4.cmml">e</mi><mo id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.1b" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.1.cmml">⁢</mo><mi id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.5" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.5.cmml">m</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E11X.2.1.1.m1.1b"><apply id="S2.E11X.2.1.1.m1.1.1.cmml" xref="S2.E11X.2.1.1.m1.1.1"><eq id="S2.E11X.2.1.1.m1.1.1.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.1"></eq><apply id="S2.E11X.2.1.1.m1.1.1.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E11X.2.1.1.m1.1.1.2.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S2.E11X.2.1.1.m1.1.1.2.2a.cmml" xref="S2.E11X.2.1.1.m1.1.1.2.2"><mtext id="S2.E11X.2.1.1.m1.1.1.2.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.2.2">logits</mtext></ci><apply id="S2.E11X.2.1.1.m1.1.1.2.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.2.3"><times id="S2.E11X.2.1.1.m1.1.1.2.3.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.2.3.1"></times><ci id="S2.E11X.2.1.1.m1.1.1.2.3.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.2.3.2">𝑖</ci><ci id="S2.E11X.2.1.1.m1.1.1.2.3.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S2.E11X.2.1.1.m1.1.1.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3"><apply id="S2.E11X.2.1.1.m1.1.1.3.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E11X.2.1.1.m1.1.1.3.1.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1">superscript</csymbol><apply id="S2.E11X.2.1.1.m1.1.1.3.1.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E11X.2.1.1.m1.1.1.3.1.2.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1">subscript</csymbol><sum id="S2.E11X.2.1.1.m1.1.1.3.1.2.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.2"></sum><apply id="S2.E11X.2.1.1.m1.1.1.3.1.2.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.3"><eq id="S2.E11X.2.1.1.m1.1.1.3.1.2.3.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.3.1"></eq><ci id="S2.E11X.2.1.1.m1.1.1.3.1.2.3.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.3.2">𝑗</ci><cn id="S2.E11X.2.1.1.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S2.E11X.2.1.1.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E11X.2.1.1.m1.1.1.3.1.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.1.3">𝑑</ci></apply><apply id="S2.E11X.2.1.1.m1.1.1.3.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2"><ci id="S2.E11X.2.1.1.m1.1.1.3.2.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.1">⋅</ci><apply id="S2.E11X.2.1.1.m1.1.1.3.2.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E11X.2.1.1.m1.1.1.3.2.2.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E11X.2.1.1.m1.1.1.3.2.2.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.2">𝐑</ci><apply id="S2.E11X.2.1.1.m1.1.1.3.2.2.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.3"><times id="S2.E11X.2.1.1.m1.1.1.3.2.2.3.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.3.1"></times><ci id="S2.E11X.2.1.1.m1.1.1.3.2.2.3.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.3.2">𝑖</ci><ci id="S2.E11X.2.1.1.m1.1.1.3.2.2.3.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.2.3.3">𝑗</ci></apply></apply><apply id="S2.E11X.2.1.1.m1.1.1.3.2.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E11X.2.1.1.m1.1.1.3.2.3.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3">superscript</csymbol><apply id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.2">𝐇</ci><apply id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3"><times id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.1"></times><ci id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.2">𝑘</ci><ci id="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.2.3.3">𝑗</ci></apply></apply><apply id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3"><times id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.1.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.1"></times><ci id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.2.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.2">𝑖</ci><ci id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.3.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.3">𝑡</ci><ci id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.4.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.4">𝑒</ci><ci id="S2.E11X.2.1.1.m1.1.1.3.2.3.3.5.cmml" xref="S2.E11X.2.1.1.m1.1.1.3.2.3.3.5">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11X.2.1.1.m1.1c">\displaystyle\text{logits}_{ik}=\sum_{j=1}^{d}\mathbf{R}_{ij}\cdot\mathbf{H}_{%
kj}^{item}</annotation><annotation encoding="application/x-llamapun" id="S2.E11X.2.1.1.m1.1d">logits start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT bold_R start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ⋅ bold_H start_POSTSUBSCRIPT italic_k italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i italic_t italic_e italic_m end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S2.E11Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle{P_{ik}}=\frac{\exp(\text{logits}_{ik})}{\sum_{l=1}^{M}\exp(\text%
{logits}_{il})}" class="ltx_Math" display="inline" id="S2.E11Xa.2.1.1.m1.4"><semantics id="S2.E11Xa.2.1.1.m1.4a"><mrow id="S2.E11Xa.2.1.1.m1.4.5" xref="S2.E11Xa.2.1.1.m1.4.5.cmml"><msub id="S2.E11Xa.2.1.1.m1.4.5.2" xref="S2.E11Xa.2.1.1.m1.4.5.2.cmml"><mi id="S2.E11Xa.2.1.1.m1.4.5.2.2" xref="S2.E11Xa.2.1.1.m1.4.5.2.2.cmml">P</mi><mrow id="S2.E11Xa.2.1.1.m1.4.5.2.3" xref="S2.E11Xa.2.1.1.m1.4.5.2.3.cmml"><mi id="S2.E11Xa.2.1.1.m1.4.5.2.3.2" xref="S2.E11Xa.2.1.1.m1.4.5.2.3.2.cmml">i</mi><mo id="S2.E11Xa.2.1.1.m1.4.5.2.3.1" xref="S2.E11Xa.2.1.1.m1.4.5.2.3.1.cmml">⁢</mo><mi id="S2.E11Xa.2.1.1.m1.4.5.2.3.3" xref="S2.E11Xa.2.1.1.m1.4.5.2.3.3.cmml">k</mi></mrow></msub><mo id="S2.E11Xa.2.1.1.m1.4.5.1" xref="S2.E11Xa.2.1.1.m1.4.5.1.cmml">=</mo><mstyle displaystyle="true" id="S2.E11Xa.2.1.1.m1.4.4" xref="S2.E11Xa.2.1.1.m1.4.4.cmml"><mfrac id="S2.E11Xa.2.1.1.m1.4.4a" xref="S2.E11Xa.2.1.1.m1.4.4.cmml"><mrow id="S2.E11Xa.2.1.1.m1.2.2.2.2" xref="S2.E11Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S2.E11Xa.2.1.1.m1.1.1.1.1" xref="S2.E11Xa.2.1.1.m1.1.1.1.1.cmml">exp</mi><mo id="S2.E11Xa.2.1.1.m1.2.2.2.2a" xref="S2.E11Xa.2.1.1.m1.2.2.2.3.cmml">⁡</mo><mrow id="S2.E11Xa.2.1.1.m1.2.2.2.2.1" xref="S2.E11Xa.2.1.1.m1.2.2.2.3.cmml"><mo id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.2" stretchy="false" xref="S2.E11Xa.2.1.1.m1.2.2.2.3.cmml">(</mo><msub id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.cmml"><mtext id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.2" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.2a.cmml">logits</mtext><mrow id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.2" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.2.cmml">i</mi><mo id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.1" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.3" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.3" stretchy="false" xref="S2.E11Xa.2.1.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S2.E11Xa.2.1.1.m1.4.4.4" xref="S2.E11Xa.2.1.1.m1.4.4.4.cmml"><msubsup id="S2.E11Xa.2.1.1.m1.4.4.4.3" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.cmml"><mo id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.2" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.cmml"><mi id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.2" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.2.cmml">l</mi><mo id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.1" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.3" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E11Xa.2.1.1.m1.4.4.4.3.3" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.3.cmml">M</mi></msubsup><mrow id="S2.E11Xa.2.1.1.m1.4.4.4.2.1" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.2.cmml"><mi id="S2.E11Xa.2.1.1.m1.3.3.3.1" xref="S2.E11Xa.2.1.1.m1.3.3.3.1.cmml">exp</mi><mo id="S2.E11Xa.2.1.1.m1.4.4.4.2.1a" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.2.cmml"><mo id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.2" stretchy="false" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.2.cmml">(</mo><msub id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.cmml"><mtext id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.2" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.2a.cmml">logits</mtext><mrow id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.cmml"><mi id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.2" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.2.cmml">i</mi><mo id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.1" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.3" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.3.cmml">l</mi></mrow></msub><mo id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.3" stretchy="false" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.E11Xa.2.1.1.m1.4b"><apply id="S2.E11Xa.2.1.1.m1.4.5.cmml" xref="S2.E11Xa.2.1.1.m1.4.5"><eq id="S2.E11Xa.2.1.1.m1.4.5.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.5.1"></eq><apply id="S2.E11Xa.2.1.1.m1.4.5.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.5.2"><csymbol cd="ambiguous" id="S2.E11Xa.2.1.1.m1.4.5.2.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.5.2">subscript</csymbol><ci id="S2.E11Xa.2.1.1.m1.4.5.2.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.5.2.2">𝑃</ci><apply id="S2.E11Xa.2.1.1.m1.4.5.2.3.cmml" xref="S2.E11Xa.2.1.1.m1.4.5.2.3"><times id="S2.E11Xa.2.1.1.m1.4.5.2.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.5.2.3.1"></times><ci id="S2.E11Xa.2.1.1.m1.4.5.2.3.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.5.2.3.2">𝑖</ci><ci id="S2.E11Xa.2.1.1.m1.4.5.2.3.3.cmml" xref="S2.E11Xa.2.1.1.m1.4.5.2.3.3">𝑘</ci></apply></apply><apply id="S2.E11Xa.2.1.1.m1.4.4.cmml" xref="S2.E11Xa.2.1.1.m1.4.4"><divide id="S2.E11Xa.2.1.1.m1.4.4.5.cmml" xref="S2.E11Xa.2.1.1.m1.4.4"></divide><apply id="S2.E11Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2"><exp id="S2.E11Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.1.1.1.1"></exp><apply id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.2a.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.2"><mtext id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.2">logits</mtext></ci><apply id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3"><times id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.1"></times><ci id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.2">𝑖</ci><ci id="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E11Xa.2.1.1.m1.2.2.2.2.1.1.3.3">𝑘</ci></apply></apply></apply><apply id="S2.E11Xa.2.1.1.m1.4.4.4.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4"><apply id="S2.E11Xa.2.1.1.m1.4.4.4.3.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E11Xa.2.1.1.m1.4.4.4.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3">superscript</csymbol><apply id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3"><csymbol cd="ambiguous" id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3">subscript</csymbol><sum id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.2"></sum><apply id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3"><eq id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.1"></eq><ci id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.2">𝑙</ci><cn id="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S2.E11Xa.2.1.1.m1.4.4.4.3.3.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.3.3">𝑀</ci></apply><apply id="S2.E11Xa.2.1.1.m1.4.4.4.2.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1"><exp id="S2.E11Xa.2.1.1.m1.3.3.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.3.3.3.1"></exp><apply id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1">subscript</csymbol><ci id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.2a.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.2"><mtext id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.2">logits</mtext></ci><apply id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3"><times id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.1.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.1"></times><ci id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.2.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.2">𝑖</ci><ci id="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.3.cmml" xref="S2.E11Xa.2.1.1.m1.4.4.4.2.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11Xa.2.1.1.m1.4c">\displaystyle{P_{ik}}=\frac{\exp(\text{logits}_{ik})}{\sum_{l=1}^{M}\exp(\text%
{logits}_{il})}</annotation><annotation encoding="application/x-llamapun" id="S2.E11Xa.2.1.1.m1.4d">italic_P start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT = divide start_ARG roman_exp ( logits start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_l = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT roman_exp ( logits start_POSTSUBSCRIPT italic_i italic_l end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S2.SS5.p1.5">Where <math alttext="\text{logits}_{ik}" class="ltx_Math" display="inline" id="S2.SS5.p1.4.m1.1"><semantics id="S2.SS5.p1.4.m1.1a"><msub id="S2.SS5.p1.4.m1.1.1" xref="S2.SS5.p1.4.m1.1.1.cmml"><mtext id="S2.SS5.p1.4.m1.1.1.2" xref="S2.SS5.p1.4.m1.1.1.2a.cmml">logits</mtext><mrow id="S2.SS5.p1.4.m1.1.1.3" xref="S2.SS5.p1.4.m1.1.1.3.cmml"><mi id="S2.SS5.p1.4.m1.1.1.3.2" xref="S2.SS5.p1.4.m1.1.1.3.2.cmml">i</mi><mo id="S2.SS5.p1.4.m1.1.1.3.1" xref="S2.SS5.p1.4.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.4.m1.1.1.3.3" xref="S2.SS5.p1.4.m1.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.4.m1.1b"><apply id="S2.SS5.p1.4.m1.1.1.cmml" xref="S2.SS5.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.4.m1.1.1.1.cmml" xref="S2.SS5.p1.4.m1.1.1">subscript</csymbol><ci id="S2.SS5.p1.4.m1.1.1.2a.cmml" xref="S2.SS5.p1.4.m1.1.1.2"><mtext id="S2.SS5.p1.4.m1.1.1.2.cmml" xref="S2.SS5.p1.4.m1.1.1.2">logits</mtext></ci><apply id="S2.SS5.p1.4.m1.1.1.3.cmml" xref="S2.SS5.p1.4.m1.1.1.3"><times id="S2.SS5.p1.4.m1.1.1.3.1.cmml" xref="S2.SS5.p1.4.m1.1.1.3.1"></times><ci id="S2.SS5.p1.4.m1.1.1.3.2.cmml" xref="S2.SS5.p1.4.m1.1.1.3.2">𝑖</ci><ci id="S2.SS5.p1.4.m1.1.1.3.3.cmml" xref="S2.SS5.p1.4.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.4.m1.1c">\text{logits}_{ik}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.4.m1.1d">logits start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\text{P}_{ik}" class="ltx_Math" display="inline" id="S2.SS5.p1.5.m2.1"><semantics id="S2.SS5.p1.5.m2.1a"><msub id="S2.SS5.p1.5.m2.1.1" xref="S2.SS5.p1.5.m2.1.1.cmml"><mtext id="S2.SS5.p1.5.m2.1.1.2" xref="S2.SS5.p1.5.m2.1.1.2a.cmml">P</mtext><mrow id="S2.SS5.p1.5.m2.1.1.3" xref="S2.SS5.p1.5.m2.1.1.3.cmml"><mi id="S2.SS5.p1.5.m2.1.1.3.2" xref="S2.SS5.p1.5.m2.1.1.3.2.cmml">i</mi><mo id="S2.SS5.p1.5.m2.1.1.3.1" xref="S2.SS5.p1.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p1.5.m2.1.1.3.3" xref="S2.SS5.p1.5.m2.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.5.m2.1b"><apply id="S2.SS5.p1.5.m2.1.1.cmml" xref="S2.SS5.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.5.m2.1.1.1.cmml" xref="S2.SS5.p1.5.m2.1.1">subscript</csymbol><ci id="S2.SS5.p1.5.m2.1.1.2a.cmml" xref="S2.SS5.p1.5.m2.1.1.2"><mtext id="S2.SS5.p1.5.m2.1.1.2.cmml" xref="S2.SS5.p1.5.m2.1.1.2">P</mtext></ci><apply id="S2.SS5.p1.5.m2.1.1.3.cmml" xref="S2.SS5.p1.5.m2.1.1.3"><times id="S2.SS5.p1.5.m2.1.1.3.1.cmml" xref="S2.SS5.p1.5.m2.1.1.3.1"></times><ci id="S2.SS5.p1.5.m2.1.1.3.2.cmml" xref="S2.SS5.p1.5.m2.1.1.3.2">𝑖</ci><ci id="S2.SS5.p1.5.m2.1.1.3.3.cmml" xref="S2.SS5.p1.5.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.5.m2.1c">\text{P}_{ik}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.5.m2.1d">P start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT</annotation></semantics></math> respectively represent the prediction scores and corresponding probability of the i-th sample for the k-th item.
And we can formulate our Cross Entropy Loss (CE) <cite class="ltx_cite ltx_citemacro_citep">(Zhang and Sabuncu, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib45" title="">2018</a>)</cite> and minimize it as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{CE}=-\frac{1}{B}\sum_{i=1}^{B}\log P_{i,y_{i}}" class="ltx_Math" display="block" id="S2.E12.m1.2"><semantics id="S2.E12.m1.2a"><mrow id="S2.E12.m1.2.3" xref="S2.E12.m1.2.3.cmml"><msub id="S2.E12.m1.2.3.2" xref="S2.E12.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E12.m1.2.3.2.2" xref="S2.E12.m1.2.3.2.2.cmml">ℒ</mi><mrow id="S2.E12.m1.2.3.2.3" xref="S2.E12.m1.2.3.2.3.cmml"><mi id="S2.E12.m1.2.3.2.3.2" xref="S2.E12.m1.2.3.2.3.2.cmml">C</mi><mo id="S2.E12.m1.2.3.2.3.1" xref="S2.E12.m1.2.3.2.3.1.cmml">⁢</mo><mi id="S2.E12.m1.2.3.2.3.3" xref="S2.E12.m1.2.3.2.3.3.cmml">E</mi></mrow></msub><mo id="S2.E12.m1.2.3.1" xref="S2.E12.m1.2.3.1.cmml">=</mo><mrow id="S2.E12.m1.2.3.3" xref="S2.E12.m1.2.3.3.cmml"><mo id="S2.E12.m1.2.3.3a" xref="S2.E12.m1.2.3.3.cmml">−</mo><mrow id="S2.E12.m1.2.3.3.2" xref="S2.E12.m1.2.3.3.2.cmml"><mfrac id="S2.E12.m1.2.3.3.2.2" xref="S2.E12.m1.2.3.3.2.2.cmml"><mn id="S2.E12.m1.2.3.3.2.2.2" xref="S2.E12.m1.2.3.3.2.2.2.cmml">1</mn><mi id="S2.E12.m1.2.3.3.2.2.3" xref="S2.E12.m1.2.3.3.2.2.3.cmml">B</mi></mfrac><mo id="S2.E12.m1.2.3.3.2.1" xref="S2.E12.m1.2.3.3.2.1.cmml">⁢</mo><mrow id="S2.E12.m1.2.3.3.2.3" xref="S2.E12.m1.2.3.3.2.3.cmml"><munderover id="S2.E12.m1.2.3.3.2.3.1" xref="S2.E12.m1.2.3.3.2.3.1.cmml"><mo id="S2.E12.m1.2.3.3.2.3.1.2.2" movablelimits="false" xref="S2.E12.m1.2.3.3.2.3.1.2.2.cmml">∑</mo><mrow id="S2.E12.m1.2.3.3.2.3.1.2.3" xref="S2.E12.m1.2.3.3.2.3.1.2.3.cmml"><mi id="S2.E12.m1.2.3.3.2.3.1.2.3.2" xref="S2.E12.m1.2.3.3.2.3.1.2.3.2.cmml">i</mi><mo id="S2.E12.m1.2.3.3.2.3.1.2.3.1" xref="S2.E12.m1.2.3.3.2.3.1.2.3.1.cmml">=</mo><mn id="S2.E12.m1.2.3.3.2.3.1.2.3.3" xref="S2.E12.m1.2.3.3.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E12.m1.2.3.3.2.3.1.3" xref="S2.E12.m1.2.3.3.2.3.1.3.cmml">B</mi></munderover><mrow id="S2.E12.m1.2.3.3.2.3.2" xref="S2.E12.m1.2.3.3.2.3.2.cmml"><mi id="S2.E12.m1.2.3.3.2.3.2.1" xref="S2.E12.m1.2.3.3.2.3.2.1.cmml">log</mi><mo id="S2.E12.m1.2.3.3.2.3.2a" lspace="0.167em" xref="S2.E12.m1.2.3.3.2.3.2.cmml">⁡</mo><msub id="S2.E12.m1.2.3.3.2.3.2.2" xref="S2.E12.m1.2.3.3.2.3.2.2.cmml"><mi id="S2.E12.m1.2.3.3.2.3.2.2.2" xref="S2.E12.m1.2.3.3.2.3.2.2.2.cmml">P</mi><mrow id="S2.E12.m1.2.2.2.2" xref="S2.E12.m1.2.2.2.3.cmml"><mi id="S2.E12.m1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.cmml">i</mi><mo id="S2.E12.m1.2.2.2.2.2" xref="S2.E12.m1.2.2.2.3.cmml">,</mo><msub id="S2.E12.m1.2.2.2.2.1" xref="S2.E12.m1.2.2.2.2.1.cmml"><mi id="S2.E12.m1.2.2.2.2.1.2" xref="S2.E12.m1.2.2.2.2.1.2.cmml">y</mi><mi id="S2.E12.m1.2.2.2.2.1.3" xref="S2.E12.m1.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.2b"><apply id="S2.E12.m1.2.3.cmml" xref="S2.E12.m1.2.3"><eq id="S2.E12.m1.2.3.1.cmml" xref="S2.E12.m1.2.3.1"></eq><apply id="S2.E12.m1.2.3.2.cmml" xref="S2.E12.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E12.m1.2.3.2.1.cmml" xref="S2.E12.m1.2.3.2">subscript</csymbol><ci id="S2.E12.m1.2.3.2.2.cmml" xref="S2.E12.m1.2.3.2.2">ℒ</ci><apply id="S2.E12.m1.2.3.2.3.cmml" xref="S2.E12.m1.2.3.2.3"><times id="S2.E12.m1.2.3.2.3.1.cmml" xref="S2.E12.m1.2.3.2.3.1"></times><ci id="S2.E12.m1.2.3.2.3.2.cmml" xref="S2.E12.m1.2.3.2.3.2">𝐶</ci><ci id="S2.E12.m1.2.3.2.3.3.cmml" xref="S2.E12.m1.2.3.2.3.3">𝐸</ci></apply></apply><apply id="S2.E12.m1.2.3.3.cmml" xref="S2.E12.m1.2.3.3"><minus id="S2.E12.m1.2.3.3.1.cmml" xref="S2.E12.m1.2.3.3"></minus><apply id="S2.E12.m1.2.3.3.2.cmml" xref="S2.E12.m1.2.3.3.2"><times id="S2.E12.m1.2.3.3.2.1.cmml" xref="S2.E12.m1.2.3.3.2.1"></times><apply id="S2.E12.m1.2.3.3.2.2.cmml" xref="S2.E12.m1.2.3.3.2.2"><divide id="S2.E12.m1.2.3.3.2.2.1.cmml" xref="S2.E12.m1.2.3.3.2.2"></divide><cn id="S2.E12.m1.2.3.3.2.2.2.cmml" type="integer" xref="S2.E12.m1.2.3.3.2.2.2">1</cn><ci id="S2.E12.m1.2.3.3.2.2.3.cmml" xref="S2.E12.m1.2.3.3.2.2.3">𝐵</ci></apply><apply id="S2.E12.m1.2.3.3.2.3.cmml" xref="S2.E12.m1.2.3.3.2.3"><apply id="S2.E12.m1.2.3.3.2.3.1.cmml" xref="S2.E12.m1.2.3.3.2.3.1"><csymbol cd="ambiguous" id="S2.E12.m1.2.3.3.2.3.1.1.cmml" xref="S2.E12.m1.2.3.3.2.3.1">superscript</csymbol><apply id="S2.E12.m1.2.3.3.2.3.1.2.cmml" xref="S2.E12.m1.2.3.3.2.3.1"><csymbol cd="ambiguous" id="S2.E12.m1.2.3.3.2.3.1.2.1.cmml" xref="S2.E12.m1.2.3.3.2.3.1">subscript</csymbol><sum id="S2.E12.m1.2.3.3.2.3.1.2.2.cmml" xref="S2.E12.m1.2.3.3.2.3.1.2.2"></sum><apply id="S2.E12.m1.2.3.3.2.3.1.2.3.cmml" xref="S2.E12.m1.2.3.3.2.3.1.2.3"><eq id="S2.E12.m1.2.3.3.2.3.1.2.3.1.cmml" xref="S2.E12.m1.2.3.3.2.3.1.2.3.1"></eq><ci id="S2.E12.m1.2.3.3.2.3.1.2.3.2.cmml" xref="S2.E12.m1.2.3.3.2.3.1.2.3.2">𝑖</ci><cn id="S2.E12.m1.2.3.3.2.3.1.2.3.3.cmml" type="integer" xref="S2.E12.m1.2.3.3.2.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E12.m1.2.3.3.2.3.1.3.cmml" xref="S2.E12.m1.2.3.3.2.3.1.3">𝐵</ci></apply><apply id="S2.E12.m1.2.3.3.2.3.2.cmml" xref="S2.E12.m1.2.3.3.2.3.2"><log id="S2.E12.m1.2.3.3.2.3.2.1.cmml" xref="S2.E12.m1.2.3.3.2.3.2.1"></log><apply id="S2.E12.m1.2.3.3.2.3.2.2.cmml" xref="S2.E12.m1.2.3.3.2.3.2.2"><csymbol cd="ambiguous" id="S2.E12.m1.2.3.3.2.3.2.2.1.cmml" xref="S2.E12.m1.2.3.3.2.3.2.2">subscript</csymbol><ci id="S2.E12.m1.2.3.3.2.3.2.2.2.cmml" xref="S2.E12.m1.2.3.3.2.3.2.2.2">𝑃</ci><list id="S2.E12.m1.2.2.2.3.cmml" xref="S2.E12.m1.2.2.2.2"><ci id="S2.E12.m1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1">𝑖</ci><apply id="S2.E12.m1.2.2.2.2.1.cmml" xref="S2.E12.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.E12.m1.2.2.2.2.1.1.cmml" xref="S2.E12.m1.2.2.2.2.1">subscript</csymbol><ci id="S2.E12.m1.2.2.2.2.1.2.cmml" xref="S2.E12.m1.2.2.2.2.1.2">𝑦</ci><ci id="S2.E12.m1.2.2.2.2.1.3.cmml" xref="S2.E12.m1.2.2.2.2.1.3">𝑖</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.2c">\mathcal{L}_{CE}=-\frac{1}{B}\sum_{i=1}^{B}\log P_{i,y_{i}}</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_C italic_E end_POSTSUBSCRIPT = - divide start_ARG 1 end_ARG start_ARG italic_B end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT roman_log italic_P start_POSTSUBSCRIPT italic_i , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p1.7">Where <math alttext="{y}_{i}" class="ltx_Math" display="inline" id="S2.SS5.p1.6.m1.1"><semantics id="S2.SS5.p1.6.m1.1a"><msub id="S2.SS5.p1.6.m1.1.1" xref="S2.SS5.p1.6.m1.1.1.cmml"><mi id="S2.SS5.p1.6.m1.1.1.2" xref="S2.SS5.p1.6.m1.1.1.2.cmml">y</mi><mi id="S2.SS5.p1.6.m1.1.1.3" xref="S2.SS5.p1.6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.6.m1.1b"><apply id="S2.SS5.p1.6.m1.1.1.cmml" xref="S2.SS5.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.6.m1.1.1.1.cmml" xref="S2.SS5.p1.6.m1.1.1">subscript</csymbol><ci id="S2.SS5.p1.6.m1.1.1.2.cmml" xref="S2.SS5.p1.6.m1.1.1.2">𝑦</ci><ci id="S2.SS5.p1.6.m1.1.1.3.cmml" xref="S2.SS5.p1.6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.6.m1.1c">{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.6.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the actual positive sample for i-th sample and <math alttext="{B}" class="ltx_Math" display="inline" id="S2.SS5.p1.7.m2.1"><semantics id="S2.SS5.p1.7.m2.1a"><mi id="S2.SS5.p1.7.m2.1.1" xref="S2.SS5.p1.7.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.7.m2.1b"><ci id="S2.SS5.p1.7.m2.1.1.cmml" xref="S2.SS5.p1.7.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.7.m2.1c">{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.7.m2.1d">italic_B</annotation></semantics></math> represents the batch size following the previous formulas. By constantly updating the loss in each epoch, we can obtain the optimal weighting parameters and correspondingly get an accurate next-item prediction.</p>
</div>
<figure class="ltx_table" id="S2.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S2.T1.2.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S2.T1.3.2" style="font-size:90%;">The Statistics of Datasets</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S2.T1.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S2.T1.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T1.4.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T1.4.1.1.2"># Users</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T1.4.1.1.3"># Items</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T1.4.1.1.4">Sparsity</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T1.4.1.1.5">Avg.length</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T1.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.4.2.1.1">Yelp</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.4.2.1.2">82,900</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.4.2.1.3">64,210</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.4.2.1.4">99.98%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T1.4.2.1.5">9.68</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.3.2">
<td class="ltx_td ltx_align_center" id="S2.T1.4.3.2.1">Sports</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.3.2.2">75,185</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.3.2.3">48,567</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.3.2.4">99.98%</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.3.2.5">8.07</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.4.3">
<td class="ltx_td ltx_align_center" id="S2.T1.4.4.3.1">Beauty</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.4.3.2">22,364</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.4.3.3">12,102</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.4.3.4">99.93%</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.4.3.5">8.88</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.5.4">
<td class="ltx_td ltx_align_center" id="S2.T1.4.5.4.1">ML-1M</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.5.4.2">6,041</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.5.4.3">3,417</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.5.4.4">95.53%</td>
<td class="ltx_td ltx_align_center" id="S2.T1.4.5.4.5">165.60</td>
</tr>
<tr class="ltx_tr" id="S2.T1.4.6.5">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.4.6.5.1">Games</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.4.6.5.2">55,145</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.4.6.5.3">17,287</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.4.6.5.4">99.94%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T1.4.6.5.5">9.01</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S2.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S2.T2.18.2.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S2.T2.2.1" style="font-size:90%;">Overall performance comparison between SIGMA and other baselines. The best results are bold, and the second-best are underlined. “*” indicates the improvements are statistically significant (i.e., two-sided t-test with <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="S2.T2.2.1.m1.1"><semantics id="S2.T2.2.1.m1.1b"><mrow id="S2.T2.2.1.m1.1.1" xref="S2.T2.2.1.m1.1.1.cmml"><mi id="S2.T2.2.1.m1.1.1.2" xref="S2.T2.2.1.m1.1.1.2.cmml">p</mi><mo id="S2.T2.2.1.m1.1.1.1" xref="S2.T2.2.1.m1.1.1.1.cmml">&lt;</mo><mn id="S2.T2.2.1.m1.1.1.3" xref="S2.T2.2.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.T2.2.1.m1.1c"><apply id="S2.T2.2.1.m1.1.1.cmml" xref="S2.T2.2.1.m1.1.1"><lt id="S2.T2.2.1.m1.1.1.1.cmml" xref="S2.T2.2.1.m1.1.1.1"></lt><ci id="S2.T2.2.1.m1.1.1.2.cmml" xref="S2.T2.2.1.m1.1.1.2">𝑝</ci><cn id="S2.T2.2.1.m1.1.1.3.cmml" type="float" xref="S2.T2.2.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T2.2.1.m1.1d">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S2.T2.2.1.m1.1e">italic_p &lt; 0.05</annotation></semantics></math> ) over baselines).</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S2.T2.16" style="width:433.6pt;height:288pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S2.T2.16.14">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S2.T2.16.14.15.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S2.T2.16.14.15.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">Datasets</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S2.T2.16.14.15.1.2" style="padding-left:4.0pt;padding-right:4.0pt;">Eval Metrics</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T2.16.14.15.1.3" style="padding-left:4.0pt;padding-right:4.0pt;">GRU4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T2.16.14.15.1.4" style="padding-left:4.0pt;padding-right:4.0pt;">BERT4Rec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T2.16.14.15.1.5" style="padding-left:4.0pt;padding-right:4.0pt;">SASRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T2.16.14.15.1.6" style="padding-left:4.0pt;padding-right:4.0pt;">LinRec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T2.16.14.15.1.7" style="padding-left:4.0pt;padding-right:4.0pt;">FEARec</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T2.16.14.15.1.8" style="padding-left:4.0pt;padding-right:4.0pt;">Mamba</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T2.16.14.15.1.9" style="padding-left:4.0pt;padding-right:4.0pt;">ECHO</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S2.T2.16.14.15.1.10" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.16.14.15.1.10.1">SIGMA</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S2.T2.16.14.15.1.11" style="padding-left:4.0pt;padding-right:4.0pt;">Improv.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T2.3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.3.1.1.2" rowspan="3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S2.T2.3.1.1.2.1">Yelp</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.3.1.1.3" style="padding-left:4.0pt;padding-right:4.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.3.1.1.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0441</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.3.1.1.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0489</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.3.1.1.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0551</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.3.1.1.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.3.1.1.7.1">0.0579</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.3.1.1.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.0554</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.3.1.1.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.0552</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.3.1.1.10" style="padding-left:4.0pt;padding-right:4.0pt;">0.0578</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T2.3.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.3.1.1.1.1">0.0629<sup class="ltx_sup" id="S2.T2.3.1.1.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.3.1.1.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S2.T2.3.1.1.11" style="padding-left:4.0pt;padding-right:4.0pt;">8.82%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.4.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.4.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.4.2.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0296</td>
<td class="ltx_td ltx_align_center" id="S2.T2.4.2.2.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0317</td>
<td class="ltx_td ltx_align_center" id="S2.T2.4.2.2.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0354</td>
<td class="ltx_td ltx_align_center" id="S2.T2.4.2.2.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0382</td>
<td class="ltx_td ltx_align_center" id="S2.T2.4.2.2.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.4.2.2.7.1">0.0391</span></td>
<td class="ltx_td ltx_align_center" id="S2.T2.4.2.2.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.0344</td>
<td class="ltx_td ltx_align_center" id="S2.T2.4.2.2.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.0389</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.4.2.2.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.4.2.2.1.1">0.0412<sup class="ltx_sup" id="S2.T2.4.2.2.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.4.2.2.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.4.2.2.10" style="padding-left:4.0pt;padding-right:4.0pt;">5.37%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.5.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.5.3.3.2" style="padding-left:4.0pt;padding-right:4.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.5.3.3.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0218</td>
<td class="ltx_td ltx_align_center" id="S2.T2.5.3.3.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0243</td>
<td class="ltx_td ltx_align_center" id="S2.T2.5.3.3.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0297</td>
<td class="ltx_td ltx_align_center" id="S2.T2.5.3.3.6" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.5.3.3.6.1">0.0322</span></td>
<td class="ltx_td ltx_align_center" id="S2.T2.5.3.3.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.0321</td>
<td class="ltx_td ltx_align_center" id="S2.T2.5.3.3.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.0290</td>
<td class="ltx_td ltx_align_center" id="S2.T2.5.3.3.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.0302</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.5.3.3.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.5.3.3.1.1">0.0346<sup class="ltx_sup" id="S2.T2.5.3.3.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.5.3.3.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.5.3.3.10" style="padding-left:4.0pt;padding-right:4.0pt;">7.45%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.16.14.16.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.16.14.16.1.1" rowspan="3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S2.T2.16.14.16.1.1.1">Sports</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.16.14.16.1.2" style="padding-left:4.0pt;padding-right:4.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.16.14.16.1.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0523</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.16.14.16.1.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0579</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.16.14.16.1.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0721</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.16.14.16.1.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0709</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.16.14.16.1.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.16.14.16.1.7.1">0.0746</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.16.14.16.1.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.0676</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.16.14.16.1.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.0689</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T2.16.14.16.1.10" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.16.14.16.1.10.1">0.0735</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S2.T2.16.14.16.1.11" style="padding-left:4.0pt;padding-right:4.0pt;">-1.47%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.6.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.6.4.4.2" style="padding-left:4.0pt;padding-right:4.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.6.4.4.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0486</td>
<td class="ltx_td ltx_align_center" id="S2.T2.6.4.4.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0501</td>
<td class="ltx_td ltx_align_center" id="S2.T2.6.4.4.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0546</td>
<td class="ltx_td ltx_align_center" id="S2.T2.6.4.4.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0541</td>
<td class="ltx_td ltx_align_center" id="S2.T2.6.4.4.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.6.4.4.7.1">0.0575</span></td>
<td class="ltx_td ltx_align_center" id="S2.T2.6.4.4.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.0563</td>
<td class="ltx_td ltx_align_center" id="S2.T2.6.4.4.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.0569</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.6.4.4.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.6.4.4.1.1">0.0590<sup class="ltx_sup" id="S2.T2.6.4.4.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.6.4.4.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.6.4.4.10" style="padding-left:4.0pt;padding-right:4.0pt;">2.62%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.7.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.7.5.5.2" style="padding-left:4.0pt;padding-right:4.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.7.5.5.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0453</td>
<td class="ltx_td ltx_align_center" id="S2.T2.7.5.5.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0477</td>
<td class="ltx_td ltx_align_center" id="S2.T2.7.5.5.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0513</td>
<td class="ltx_td ltx_align_center" id="S2.T2.7.5.5.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0501</td>
<td class="ltx_td ltx_align_center" id="S2.T2.7.5.5.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.0521</td>
<td class="ltx_td ltx_align_center" id="S2.T2.7.5.5.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.0527</td>
<td class="ltx_td ltx_align_center" id="S2.T2.7.5.5.9" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.7.5.5.9.1">0.0534</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.7.5.5.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.7.5.5.1.1">0.0556<sup class="ltx_sup" id="S2.T2.7.5.5.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.7.5.5.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.7.5.5.10" style="padding-left:4.0pt;padding-right:4.0pt;">4.12%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.8.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.8.6.6.2" rowspan="3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S2.T2.8.6.6.2.1">Beauty</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.8.6.6.3" style="padding-left:4.0pt;padding-right:4.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.8.6.6.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0612</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.8.6.6.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0764</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.8.6.6.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0852</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.8.6.6.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.0837</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.8.6.6.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.8.6.6.8.1">0.0967</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.8.6.6.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.0880</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.8.6.6.10" style="padding-left:4.0pt;padding-right:4.0pt;">0.0903</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T2.8.6.6.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.8.6.6.1.1">0.0986<sup class="ltx_sup" id="S2.T2.8.6.6.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.8.6.6.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S2.T2.8.6.6.11" style="padding-left:4.0pt;padding-right:4.0pt;">1.96%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.9.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.9.7.7.2" style="padding-left:4.0pt;padding-right:4.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.9.7.7.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0334</td>
<td class="ltx_td ltx_align_center" id="S2.T2.9.7.7.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0395</td>
<td class="ltx_td ltx_align_center" id="S2.T2.9.7.7.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0532</td>
<td class="ltx_td ltx_align_center" id="S2.T2.9.7.7.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0519</td>
<td class="ltx_td ltx_align_center" id="S2.T2.9.7.7.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.0530</td>
<td class="ltx_td ltx_align_center" id="S2.T2.9.7.7.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.0540</td>
<td class="ltx_td ltx_align_center" id="S2.T2.9.7.7.9" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.9.7.7.9.1">0.0567</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.9.7.7.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.9.7.7.1.1">0.0604<sup class="ltx_sup" id="S2.T2.9.7.7.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.9.7.7.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.9.7.7.10" style="padding-left:4.0pt;padding-right:4.0pt;">6.53%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.10.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.10.8.8.2" style="padding-left:4.0pt;padding-right:4.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.10.8.8.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0242</td>
<td class="ltx_td ltx_align_center" id="S2.T2.10.8.8.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0285</td>
<td class="ltx_td ltx_align_center" id="S2.T2.10.8.8.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0392</td>
<td class="ltx_td ltx_align_center" id="S2.T2.10.8.8.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0371</td>
<td class="ltx_td ltx_align_center" id="S2.T2.10.8.8.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.0410</td>
<td class="ltx_td ltx_align_center" id="S2.T2.10.8.8.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.0436</td>
<td class="ltx_td ltx_align_center" id="S2.T2.10.8.8.9" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.10.8.8.9.1">0.0447</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.10.8.8.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.10.8.8.1.1">0.0488<sup class="ltx_sup" id="S2.T2.10.8.8.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.10.8.8.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.10.8.8.10" style="padding-left:4.0pt;padding-right:4.0pt;">7.83%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.11.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.11.9.9.2" rowspan="3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S2.T2.11.9.9.2.1">ML-1M</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.11.9.9.3" style="padding-left:4.0pt;padding-right:4.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.11.9.9.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.2944</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.11.9.9.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.2977</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.11.9.9.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.2998</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.11.9.9.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.3102</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.11.9.9.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.11.9.9.8.1">0.3283</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.11.9.9.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.3253</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.11.9.9.10" style="padding-left:4.0pt;padding-right:4.0pt;">0.3239</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T2.11.9.9.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.11.9.9.1.1">0.3308<sup class="ltx_sup" id="S2.T2.11.9.9.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.11.9.9.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S2.T2.11.9.9.11" style="padding-left:4.0pt;padding-right:4.0pt;">0.76%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.12.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.12.10.10.2" style="padding-left:4.0pt;padding-right:4.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.12.10.10.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.1652</td>
<td class="ltx_td ltx_align_center" id="S2.T2.12.10.10.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.1687</td>
<td class="ltx_td ltx_align_center" id="S2.T2.12.10.10.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.1692</td>
<td class="ltx_td ltx_align_center" id="S2.T2.12.10.10.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.1764</td>
<td class="ltx_td ltx_align_center" id="S2.T2.12.10.10.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.1843</td>
<td class="ltx_td ltx_align_center" id="S2.T2.12.10.10.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.12.10.10.8.1">0.1868</span></td>
<td class="ltx_td ltx_align_center" id="S2.T2.12.10.10.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.1848</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.12.10.10.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.12.10.10.1.1">0.1906<sup class="ltx_sup" id="S2.T2.12.10.10.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.12.10.10.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.12.10.10.10" style="padding-left:4.0pt;padding-right:4.0pt;">2.03%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.13.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.13.11.11.2" style="padding-left:4.0pt;padding-right:4.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.13.11.11.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.1252</td>
<td class="ltx_td ltx_align_center" id="S2.T2.13.11.11.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.1294</td>
<td class="ltx_td ltx_align_center" id="S2.T2.13.11.11.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.1279</td>
<td class="ltx_td ltx_align_center" id="S2.T2.13.11.11.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.1357</td>
<td class="ltx_td ltx_align_center" id="S2.T2.13.11.11.7" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.13.11.11.7.1">0.1459</span></td>
<td class="ltx_td ltx_align_center" id="S2.T2.13.11.11.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.1413</td>
<td class="ltx_td ltx_align_center" id="S2.T2.13.11.11.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.1429</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.13.11.11.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.13.11.11.1.1">0.1479<sup class="ltx_sup" id="S2.T2.13.11.11.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.13.11.11.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.13.11.11.10" style="padding-left:4.0pt;padding-right:4.0pt;">1.37%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.14.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S2.T2.14.12.12.2" rowspan="3" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S2.T2.14.12.12.2.1">Games</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S2.T2.14.12.12.3" style="padding-left:4.0pt;padding-right:4.0pt;">HR@10</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.14.12.12.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.1484</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.14.12.12.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.1502</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.14.12.12.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.1592</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.14.12.12.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.1604</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.14.12.12.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.14.12.12.8.1">0.1616</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.14.12.12.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.1564</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T2.14.12.12.10" style="padding-left:4.0pt;padding-right:4.0pt;">0.1578</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T2.14.12.12.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.14.12.12.1.1">0.1627<sup class="ltx_sup" id="S2.T2.14.12.12.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.14.12.12.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S2.T2.14.12.12.11" style="padding-left:4.0pt;padding-right:4.0pt;">0.681%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.15.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S2.T2.15.13.13.2" style="padding-left:4.0pt;padding-right:4.0pt;">NDCG@10</th>
<td class="ltx_td ltx_align_center" id="S2.T2.15.13.13.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0964</td>
<td class="ltx_td ltx_align_center" id="S2.T2.15.13.13.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0978</td>
<td class="ltx_td ltx_align_center" id="S2.T2.15.13.13.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.1002</td>
<td class="ltx_td ltx_align_center" id="S2.T2.15.13.13.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.1021</td>
<td class="ltx_td ltx_align_center" id="S2.T2.15.13.13.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.1032</td>
<td class="ltx_td ltx_align_center" id="S2.T2.15.13.13.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.15.13.13.8.1">0.1050</span></td>
<td class="ltx_td ltx_align_center" id="S2.T2.15.13.13.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.1044</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T2.15.13.13.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.15.13.13.1.1">0.1088<sup class="ltx_sup" id="S2.T2.15.13.13.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.15.13.13.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S2.T2.15.13.13.10" style="padding-left:4.0pt;padding-right:4.0pt;">3.62%</td>
</tr>
<tr class="ltx_tr" id="S2.T2.16.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S2.T2.16.14.14.2" style="padding-left:4.0pt;padding-right:4.0pt;">MRR@10</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T2.16.14.14.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.0735</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T2.16.14.14.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.0728</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T2.16.14.14.5" style="padding-left:4.0pt;padding-right:4.0pt;">0.0794</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T2.16.14.14.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.0824</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T2.16.14.14.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.0843</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T2.16.14.14.8" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S2.T2.16.14.14.8.1">0.0894</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S2.T2.16.14.14.9" style="padding-left:4.0pt;padding-right:4.0pt;">0.0887</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S2.T2.16.14.14.1" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S2.T2.16.14.14.1.1">0.0924<sup class="ltx_sup" id="S2.T2.16.14.14.1.1.1"><span class="ltx_text ltx_font_medium" id="S2.T2.16.14.14.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S2.T2.16.14.14.10" style="padding-left:4.0pt;padding-right:4.0pt;">3.36%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Experiment</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, first we introduce the experiment setting. Then we present extensive experiments to evaluate the effectiveness of our proposed SIGMA.
All reported experimental results are the average values obtained from five independent runs of the algorithm</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Experiment Setting</h3>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1. </span>Dataset</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.3">We conduct comprehensive experiments on five representative real-world datasets <em class="ltx_emph ltx_font_italic" id="S3.SS1.SSS1.p1.3.1">i.e.,</em> Yelp<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.yelp.com/dataset" title="">https://www.yelp.com/dataset</a></span></span></span>, Amazon-based<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cseweb.ucsd.edu/jmcauley/datasets.html#amazon_reviews" title="">https://cseweb.ucsd.edu/jmcauley/datasets.html#amazon_reviews</a></span></span></span> (Beauty, Sports and Games) and MovieLens-1M<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://grouplens.org/datasets/movielens/" title="">https://grouplens.org/datasets/movielens/</a></span></span></span>. The statistics of datasets after preprocessing are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.T1" title="Table 1 ‣ 2.5. Train and Inference ‣ 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. For the grouped user analysis, all datasets are categorized into three subsets based on user interaction length: “Short” (<math alttext="0-5" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.1.m1.1"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mrow id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml"><mn id="S3.SS1.SSS1.p1.1.m1.1.1.2" xref="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml">0</mn><mo id="S3.SS1.SSS1.p1.1.m1.1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml">−</mo><mn id="S3.SS1.SSS1.p1.1.m1.1.1.3" xref="S3.SS1.SSS1.p1.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><apply id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1"><minus id="S3.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1.1"></minus><cn id="S3.SS1.SSS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.SSS1.p1.1.m1.1.1.2">0</cn><cn id="S3.SS1.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">0-5</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.1.m1.1d">0 - 5</annotation></semantics></math>), “Medium” (<math alttext="5-20" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.2.m2.1"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><mrow id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml"><mn id="S3.SS1.SSS1.p1.2.m2.1.1.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml">5</mn><mo id="S3.SS1.SSS1.p1.2.m2.1.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml">−</mo><mn id="S3.SS1.SSS1.p1.2.m2.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><apply id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1"><minus id="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1"></minus><cn id="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S3.SS1.SSS1.p1.2.m2.1.1.2">5</cn><cn id="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.SSS1.p1.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">5-20</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.2.m2.1d">5 - 20</annotation></semantics></math>), and “Long” (<math alttext="20-inf" class="ltx_Math" display="inline" id="S3.SS1.SSS1.p1.3.m3.1"><semantics id="S3.SS1.SSS1.p1.3.m3.1a"><mrow id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml"><mn id="S3.SS1.SSS1.p1.3.m3.1.1.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml">20</mn><mo id="S3.SS1.SSS1.p1.3.m3.1.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml">−</mo><mrow id="S3.SS1.SSS1.p1.3.m3.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.2" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2.cmml">i</mi><mo id="S3.SS1.SSS1.p1.3.m3.1.1.3.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.3" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.3.cmml">n</mi><mo id="S3.SS1.SSS1.p1.3.m3.1.1.3.1a" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.SSS1.p1.3.m3.1.1.3.4" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.4.cmml">f</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.1b"><apply id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1"><minus id="S3.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.1"></minus><cn id="S3.SS1.SSS1.p1.3.m3.1.1.2.cmml" type="integer" xref="S3.SS1.SSS1.p1.3.m3.1.1.2">20</cn><apply id="S3.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3"><times id="S3.SS1.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.1"></times><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.3">𝑛</ci><ci id="S3.SS1.SSS1.p1.3.m3.1.1.3.4.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1.3.4">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.1c">20-inf</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS1.p1.3.m3.1d">20 - italic_i italic_n italic_f</annotation></semantics></math>). Additionally, we arrange user interactions sequentially by time across all datasets and use the leave-one-out method for data splitting.
The detailed description and preprocessing procedures can be found in <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS1.p1.3.2">Appendix B</span>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2. </span>Evaluation Metrics</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">To assess performance, we use Top-10 Hit Rate (HR@10), Top-10 Normalized Discounted Cumulative Gain (NDCG@10), and Top-10 Mean Reciprocal Rank (MRR@10) as evaluation metrics, all of which are widely used in related studies <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib9" title="">2023</a>; Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib14" title="">2024</a>; De et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib4" title="">2024</a>)</cite>. These metrics offer a comprehensive evaluation of the SRS’s performance. For more details, please refer to the description and calculation methods in <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS2.p1.1.1">Appdendix C</span>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3. </span>Implementation Details</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.1">In this section, we provide a detailed description of our framework’s implementation. The code can be found in <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS3.p1.1.1">Supplementary Material</span>. For GPU selection, all experiments are conducted on a single NVIDIA L4 GPU. The Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib19" title="">2014</a>)</cite> is used with a learning rate of 0.001. For a fair comparison, the embedding dimension for all tested models is set to 64. Other implementation details are the same as original papers <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib25" title="">2024a</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib39" title="">2024</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib15" title="">2018</a>)</cite>, which are presented in <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS3.p1.1.2">Appendix D</span>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4. </span>Baselines</h4>
<div class="ltx_para" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.1">To demonstrate the effectiveness and efficiency of our proposed framework, we compare SIGMA with state-of-the-art transformer-based models (<span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.p1.1.1">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib35" title="">2019</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.p1.1.2">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib15" title="">2018</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.p1.1.3">LinRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib26" title="">2023a</a>)</cite>, <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.p1.1.4">FEARec</span> <cite class="ltx_cite ltx_citemacro_citep">(Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib6" title="">2023</a>)</cite>), RNN-based models (<span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.p1.1.5">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Jannach and Ludewig, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib13" title="">2017</a>)</cite>), and SSM-based models (<span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.p1.1.6">Mamba4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib25" title="">2024a</a>)</cite>, denoted as Mamba, <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.p1.1.7">ECHOMamba4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib39" title="">2024</a>)</cite>), denoted as ECHO. Additional details are provided in <span class="ltx_text ltx_font_bold" id="S3.SS1.SSS4.p1.1.8">Appendix E</span>.</p>
</div>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T3.2.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S3.T3.3.2" style="font-size:90%;">Efficiency comparison of inference time per batch (ms) and GPU memory usage (GB).</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T3.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T3.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T3.4.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T3.4.1.1.2">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T3.4.1.1.3">Inf. Time</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T3.4.1.1.4">GPU Mem.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.2.1.1" rowspan="6"><span class="ltx_text" id="S3.T3.4.2.1.1.1">Beauty</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.2.1.2">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.2.1.3">123ms</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.2.1.4">7.58G</td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.3.2">
<td class="ltx_td ltx_align_center" id="S3.T3.4.3.2.1">FEARec</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.3.2.2">129ms</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.3.2.3">8.11G</td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.4.3">
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.3.1">LinRec</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.3.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.4.4.3.2.1">72ms</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.4.3.3">3.08G</td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.5.4">
<td class="ltx_td ltx_align_center" id="S3.T3.4.5.4.1">Mamba</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.5.4.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.4.5.4.2.1">72ms</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.5.4.3"><span class="ltx_text ltx_font_bold" id="S3.T3.4.5.4.3.1">2.58G</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.6.5">
<td class="ltx_td ltx_align_center" id="S3.T3.4.6.5.1">ECHO</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.6.5.2">78ms</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.6.5.3">3.01G</td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.7.6">
<td class="ltx_td ltx_align_center" id="S3.T3.4.7.6.1">SIGMA</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.7.6.2"><span class="ltx_text ltx_font_bold" id="S3.T3.4.7.6.2.1">68ms</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.7.6.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.4.7.6.3.1">2.89G</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.8.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T3.4.8.7.1" rowspan="6"><span class="ltx_text" id="S3.T3.4.8.7.1.1">Games</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.8.7.2">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.8.7.3">189ms</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.4.8.7.4">7.23G</td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.9.8">
<td class="ltx_td ltx_align_center" id="S3.T3.4.9.8.1">FEARec</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.9.8.2">260ms</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.9.8.3">7.98G</td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.10.9">
<td class="ltx_td ltx_align_center" id="S3.T3.4.10.9.1">LinRec</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.10.9.2">173ms</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.10.9.3">3.68G</td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.11.10">
<td class="ltx_td ltx_align_center" id="S3.T3.4.11.10.1">Mamba</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.11.10.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.4.11.10.2.1">174ms</span></td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.11.10.3">3.40G</td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.12.11">
<td class="ltx_td ltx_align_center" id="S3.T3.4.12.11.1">ECHO</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.12.11.2">178ms</td>
<td class="ltx_td ltx_align_center" id="S3.T3.4.12.11.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T3.4.12.11.3.1">3.19G</span></td>
</tr>
<tr class="ltx_tr" id="S3.T3.4.13.12">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.4.13.12.1">SIGMA</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.4.13.12.2"><span class="ltx_text ltx_font_bold" id="S3.T3.4.13.12.2.1">171ms</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.4.13.12.3"><span class="ltx_text ltx_font_bold" id="S3.T3.4.13.12.3.1">3.11G</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Overall Performance Comparison</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S2.T2" title="Table 2 ‣ 2.5. Train and Inference ‣ 2. Methodology ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, we present a performance comparison on five datasets. The results show that our SIGMA framework outperforms all competing transformer-based, RNN-based, and SSM-based baselines, with significant improvements ranging from 0.76% to 8.82%. Such a comparison highlights the effectiveness of our unique design for combining Mamba with the sequential recommendation.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">From the results, RNN-based models struggle with complex dependencies, resulting in relatively inferior performance.
Besides, transformer-based models often show comparable performance, suggesting their powerful capacities in sequence modeling by self-attention. However, they still slightly lag behind our SIGMA because of the short sequence modeling problem they are facing and Mamba’s more powerful abilities in capturing long-term dependency <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib40" title="">2024</a>)</cite>.
In terms of the SSM-based models, we find that they also underperform our SIGMA consistently, because of the context modeling and short sequence modeling problems mentioned before. Especially, Mamba4Rec and ECHOMamba4Rec show inferior performance in the Sports and Beauty datasets, whose average lengths are relatively shorter. Such a phenomenon emphasizes their weaknesses in long-tail users by direct adaptation of Mamba for the sequential recommendation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Efficiency Comparison</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">In this section, we analyze the efficiency of SIGMA compared to other baselines by examining the inference time per batch and GPU memory usage during inference. The results, presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.T3" title="Table 3 ‣ 3.1.4. Baselines ‣ 3.1. Experiment Setting ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, offer several valuable insights.
First, we can find that the Mamba-based methods, including our SIGMA, can achieve higher efficiency remarkably compared with the transformer-based methods, except for LinRec. The reason lies in the simple input-dependent selection mechanism of Mamba.
Then, though the efficiency-specified LinRec also owns comparable efficiency, it slightly downgrades the effectiveness of the transformer. By comparison, our SIGMA can achieve a better efficiency-effectiveness trade-off.
To further analyze the efficiency of our SIGMA from a theoretical view, we refer to the complexity analysis in <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.1.1">Appendix A</span>.
Besides, Additional experiments on the other three datasets are provided in <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.1.2">Appendix F</span>.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="361" id="S3.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">User group analysis on Beauty and Sports.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Grouped Users Analysis</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">This section presents the recommendation quality for users with different number of interactions to figure out the effctiveness of SIGMA on enhancing long-tail users’ experience. We illustrate the results on Beauty and Sports in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.F3" title="Figure 3 ‣ 3.3. Efficiency Comparison ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>. More results on other datasets are in <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.1">Appendix G</span>. From this figure, we can find that:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1">Mamba4Rec (denoted as Mamba in the figure) that adopts the vanilla Mamba structures for SRS presents the poor performance for ‘short’ and ‘medium’ users. While ECHO, which designs a bi-directional modeling module for SRS, achieves a slightly better results while is still worse than SASRec, a SRS baseline.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1">Our SIGMA defeat all baselines on all groups, where FE-GRU contributes to the short-sequence modeling and PF-Mamba boosts the overall performance.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Ablation Study</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.3">In this section, we analyze the efficacy of three key components within SIGMA, including PF-Mamba (partial flipping and DS gate), and FE-GRU. We design three variants: (1) <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.SS5.p1.3.1">w/o partial flipping</span>: this variant uses the original interaction sequence without partial flipping; (2) <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.SS5.p1.3.2">w/o DS gate</span>: the second variant linearly combines the output of two Mamba blocks; (3) <span class="ltx_text ltx_markedasmath ltx_font_italic" id="S3.SS5.p1.3.3">w/o FE-GRU</span>: this variant drops the Feature Extract GRU. We test these variants on Beauty and present results in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.T4" title="Table 4 ‣ 3.5. Ablation Study ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.F4" title="Figure 4 ‣ 3.5. Ablation Study ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. Results on other datasets are included in <span class="ltx_text ltx_font_bold" id="S3.SS5.p1.3.4">Appendix H</span>.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">From Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.T4" title="Table 4 ‣ 3.5. Ablation Study ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> and Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.F4" title="Figure 4 ‣ 3.5. Ablation Study ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>, we can conclude that:</p>
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1">With the bi-directional interaction sequences, partial flipping contributes to improve the recommendation performance for all users.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1">DS gate significantly boosts the SIGMA by balancing the information from two directions.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i3.p1">
<p class="ltx_p" id="S3.I2.i3.p1.1">FE-GRU is crucial for enhancing the experience of users with few interactions with strong short sequence modeling ability. And it has a huge impact on the overall performance, highlighting the importance of tackling the long-tail user problem.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="352" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Ablation analysis on Beauty.</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T4.2.1.1" style="font-size:90%;">Table 4</span>. </span><span class="ltx_text" id="S3.T4.3.2" style="font-size:90%;">Ablation study on Beauty.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T4.4" style="width:433.6pt;height:152.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(88.7pt,-31.2pt) scale(1.69281477101175,1.69281477101175) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T4.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T4.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.4.1.1.1.1">Model Components</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.4.1.1.1.2">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.4.1.1.1.3">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T4.4.1.1.1.4">MRR@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T4.4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.1.2.1.1">Default</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S3.T4.4.1.2.1.2.1">0.0986</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S3.T4.4.1.2.1.3.1">0.0604</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T4.4.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S3.T4.4.1.2.1.4.1">0.0488</span></td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.1.3.2">
<td class="ltx_td ltx_align_center" id="S3.T4.4.1.3.2.1">w/o partial flipping</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.1.3.2.2">0.0953</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.1.3.2.3">0.0586</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.1.3.2.4">0.0473</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.1.4.3">
<td class="ltx_td ltx_align_center" id="S3.T4.4.1.4.3.1">w/o DS gate</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.1.4.3.2">0.0954</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.1.4.3.3">0.0571</td>
<td class="ltx_td ltx_align_center" id="S3.T4.4.1.4.3.4">0.0455</td>
</tr>
<tr class="ltx_tr" id="S3.T4.4.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.4.1.5.4.1">w/o FE-GRU</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.4.1.5.4.2">0.0750</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.4.1.5.4.3">0.0470</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T4.4.1.5.4.4">0.0382</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6. </span>Hyperparameter Analysis</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.2">In this section, we conduct experiments on Beauty to analyze the influence of two significant hyperparameters: (i) <math alttext="r" class="ltx_Math" display="inline" id="S3.SS6.p1.1.m1.1"><semantics id="S3.SS6.p1.1.m1.1a"><mi id="S3.SS6.p1.1.m1.1.1" xref="S3.SS6.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.1.m1.1b"><ci id="S3.SS6.p1.1.m1.1.1.cmml" xref="S3.SS6.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.1.m1.1d">italic_r</annotation></semantics></math>, the remaining range in the partial flipping method; (ii) <math alttext="L" class="ltx_Math" display="inline" id="S3.SS6.p1.2.m2.1"><semantics id="S3.SS6.p1.2.m2.1a"><mi id="S3.SS6.p1.2.m2.1.1" xref="S3.SS6.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p1.2.m2.1b"><ci id="S3.SS6.p1.2.m2.1.1.cmml" xref="S3.SS6.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p1.2.m2.1d">italic_L</annotation></semantics></math>, the number of stacked SIGMA layers. The results are respectively visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.F5" title="Figure 5 ‣ 3.6. Hyperparameter Analysis ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.T5" title="Table 5 ‣ 3.6. Hyperparameter Analysis ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.7">From Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.F5" title="Figure 5 ‣ 3.6. Hyperparameter Analysis ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, we can find that our proposed SIGMA framework achieves the best results when <math alttext="r=5" class="ltx_Math" display="inline" id="S3.SS6.p2.1.m1.1"><semantics id="S3.SS6.p2.1.m1.1a"><mrow id="S3.SS6.p2.1.m1.1.1" xref="S3.SS6.p2.1.m1.1.1.cmml"><mi id="S3.SS6.p2.1.m1.1.1.2" xref="S3.SS6.p2.1.m1.1.1.2.cmml">r</mi><mo id="S3.SS6.p2.1.m1.1.1.1" xref="S3.SS6.p2.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS6.p2.1.m1.1.1.3" xref="S3.SS6.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.1.m1.1b"><apply id="S3.SS6.p2.1.m1.1.1.cmml" xref="S3.SS6.p2.1.m1.1.1"><eq id="S3.SS6.p2.1.m1.1.1.1.cmml" xref="S3.SS6.p2.1.m1.1.1.1"></eq><ci id="S3.SS6.p2.1.m1.1.1.2.cmml" xref="S3.SS6.p2.1.m1.1.1.2">𝑟</ci><cn id="S3.SS6.p2.1.m1.1.1.3.cmml" type="integer" xref="S3.SS6.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.1.m1.1c">r=5</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.1.m1.1d">italic_r = 5</annotation></semantics></math>, offering two valuable insights as follows: (i) when <math alttext="r" class="ltx_Math" display="inline" id="S3.SS6.p2.2.m2.1"><semantics id="S3.SS6.p2.2.m2.1a"><mi id="S3.SS6.p2.2.m2.1.1" xref="S3.SS6.p2.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.2.m2.1b"><ci id="S3.SS6.p2.2.m2.1.1.cmml" xref="S3.SS6.p2.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.2.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.2.m2.1d">italic_r</annotation></semantics></math> is relatively large (<math alttext="r=N" class="ltx_Math" display="inline" id="S3.SS6.p2.3.m3.1"><semantics id="S3.SS6.p2.3.m3.1a"><mrow id="S3.SS6.p2.3.m3.1.1" xref="S3.SS6.p2.3.m3.1.1.cmml"><mi id="S3.SS6.p2.3.m3.1.1.2" xref="S3.SS6.p2.3.m3.1.1.2.cmml">r</mi><mo id="S3.SS6.p2.3.m3.1.1.1" xref="S3.SS6.p2.3.m3.1.1.1.cmml">=</mo><mi id="S3.SS6.p2.3.m3.1.1.3" xref="S3.SS6.p2.3.m3.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.3.m3.1b"><apply id="S3.SS6.p2.3.m3.1.1.cmml" xref="S3.SS6.p2.3.m3.1.1"><eq id="S3.SS6.p2.3.m3.1.1.1.cmml" xref="S3.SS6.p2.3.m3.1.1.1"></eq><ci id="S3.SS6.p2.3.m3.1.1.2.cmml" xref="S3.SS6.p2.3.m3.1.1.2">𝑟</ci><ci id="S3.SS6.p2.3.m3.1.1.3.cmml" xref="S3.SS6.p2.3.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.3.m3.1c">r=N</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.3.m3.1d">italic_r = italic_N</annotation></semantics></math> represents “w/o flipping” ), it is challenging for SIGMA to leverage the limited bi-directional information (<math alttext="N-r" class="ltx_Math" display="inline" id="S3.SS6.p2.4.m4.1"><semantics id="S3.SS6.p2.4.m4.1a"><mrow id="S3.SS6.p2.4.m4.1.1" xref="S3.SS6.p2.4.m4.1.1.cmml"><mi id="S3.SS6.p2.4.m4.1.1.2" xref="S3.SS6.p2.4.m4.1.1.2.cmml">N</mi><mo id="S3.SS6.p2.4.m4.1.1.1" xref="S3.SS6.p2.4.m4.1.1.1.cmml">−</mo><mi id="S3.SS6.p2.4.m4.1.1.3" xref="S3.SS6.p2.4.m4.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.4.m4.1b"><apply id="S3.SS6.p2.4.m4.1.1.cmml" xref="S3.SS6.p2.4.m4.1.1"><minus id="S3.SS6.p2.4.m4.1.1.1.cmml" xref="S3.SS6.p2.4.m4.1.1.1"></minus><ci id="S3.SS6.p2.4.m4.1.1.2.cmml" xref="S3.SS6.p2.4.m4.1.1.2">𝑁</ci><ci id="S3.SS6.p2.4.m4.1.1.3.cmml" xref="S3.SS6.p2.4.m4.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.4.m4.1c">N-r</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.4.m4.1d">italic_N - italic_r</annotation></semantics></math> items are flipped); (ii) when <math alttext="r" class="ltx_Math" display="inline" id="S3.SS6.p2.5.m5.1"><semantics id="S3.SS6.p2.5.m5.1a"><mi id="S3.SS6.p2.5.m5.1.1" xref="S3.SS6.p2.5.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.5.m5.1b"><ci id="S3.SS6.p2.5.m5.1.1.cmml" xref="S3.SS6.p2.5.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.5.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.5.m5.1d">italic_r</annotation></semantics></math> is relatively small (<math alttext="r=0" class="ltx_Math" display="inline" id="S3.SS6.p2.6.m6.1"><semantics id="S3.SS6.p2.6.m6.1a"><mrow id="S3.SS6.p2.6.m6.1.1" xref="S3.SS6.p2.6.m6.1.1.cmml"><mi id="S3.SS6.p2.6.m6.1.1.2" xref="S3.SS6.p2.6.m6.1.1.2.cmml">r</mi><mo id="S3.SS6.p2.6.m6.1.1.1" xref="S3.SS6.p2.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS6.p2.6.m6.1.1.3" xref="S3.SS6.p2.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.6.m6.1b"><apply id="S3.SS6.p2.6.m6.1.1.cmml" xref="S3.SS6.p2.6.m6.1.1"><eq id="S3.SS6.p2.6.m6.1.1.1.cmml" xref="S3.SS6.p2.6.m6.1.1.1"></eq><ci id="S3.SS6.p2.6.m6.1.1.2.cmml" xref="S3.SS6.p2.6.m6.1.1.2">𝑟</ci><cn id="S3.SS6.p2.6.m6.1.1.3.cmml" type="integer" xref="S3.SS6.p2.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.6.m6.1c">r=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.6.m6.1d">italic_r = 0</annotation></semantics></math> represents “whole flipping” ), users may lose the short-term preference due to the exceeding flipping range, which is reflected as a varied Hit@10 and NDCG@10 performance in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.F5" title="Figure 5 ‣ 3.6. Hyperparameter Analysis ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>. These phenomenons justify the significance of partial flipping with a proper <math alttext="r" class="ltx_Math" display="inline" id="S3.SS6.p2.7.m7.1"><semantics id="S3.SS6.p2.7.m7.1a"><mi id="S3.SS6.p2.7.m7.1.1" xref="S3.SS6.p2.7.m7.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.p2.7.m7.1b"><ci id="S3.SS6.p2.7.m7.1.1.cmml" xref="S3.SS6.p2.7.m7.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p2.7.m7.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p2.7.m7.1d">italic_r</annotation></semantics></math>, defending the effectiveness of SIGMA.</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="333" id="S3.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.4.2.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S3.F5.2.1" style="font-size:90%;">Parameter study for <math alttext="r" class="ltx_Math" display="inline" id="S3.F5.2.1.m1.1"><semantics id="S3.F5.2.1.m1.1b"><mi id="S3.F5.2.1.m1.1.1" xref="S3.F5.2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.F5.2.1.m1.1c"><ci id="S3.F5.2.1.m1.1.1.cmml" xref="S3.F5.2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.2.1.m1.1d">r</annotation><annotation encoding="application/x-llamapun" id="S3.F5.2.1.m1.1e">italic_r</annotation></semantics></math> on Beauty.</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T5.7.2.1" style="font-size:90%;">Table 5</span>. </span><span class="ltx_text" id="S3.T5.2.1" style="font-size:90%;">Parameter study for <math alttext="\mathit{L}" class="ltx_Math" display="inline" id="S3.T5.2.1.m1.1"><semantics id="S3.T5.2.1.m1.1b"><mi id="S3.T5.2.1.m1.1.1" xref="S3.T5.2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.T5.2.1.m1.1c"><ci id="S3.T5.2.1.m1.1.1.cmml" xref="S3.T5.2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.2.1.m1.1d">\mathit{L}</annotation><annotation encoding="application/x-llamapun" id="S3.T5.2.1.m1.1e">italic_L</annotation></semantics></math> on Beauty.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T5.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T5.5.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T5.5.4.1.1"><span class="ltx_text" id="S3.T5.5.4.1.1.1" style="font-size:80%;">#layers</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.5.4.1.2"><span class="ltx_text" id="S3.T5.5.4.1.2.1" style="font-size:80%;">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.5.4.1.3"><span class="ltx_text" id="S3.T5.5.4.1.3.1" style="font-size:80%;">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.5.4.1.4"><span class="ltx_text" id="S3.T5.5.4.1.4.1" style="font-size:80%;">Inf Time</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T5.5.4.1.5"><span class="ltx_text" id="S3.T5.5.4.1.5.1" style="font-size:80%;">GPU Mem</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T5.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T5.3.1.1"><math alttext="1" class="ltx_Math" display="inline" id="S3.T5.3.1.1.m1.1"><semantics id="S3.T5.3.1.1.m1.1a"><mn id="S3.T5.3.1.1.m1.1.1" mathsize="80%" xref="S3.T5.3.1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.T5.3.1.1.m1.1b"><cn id="S3.T5.3.1.1.m1.1.1.cmml" type="integer" xref="S3.T5.3.1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.3.1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.T5.3.1.1.m1.1d">1</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.3.1.2"><span class="ltx_text" id="S3.T5.3.1.2.1" style="font-size:80%;">0.0986</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.3.1.3"><span class="ltx_text" id="S3.T5.3.1.3.1" style="font-size:80%;">0.0604</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.3.1.4"><span class="ltx_text" id="S3.T5.3.1.4.1" style="font-size:80%;">66ms</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T5.3.1.5"><span class="ltx_text" id="S3.T5.3.1.5.1" style="font-size:80%;">3.03G</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T5.4.2.1"><math alttext="2" class="ltx_Math" display="inline" id="S3.T5.4.2.1.m1.1"><semantics id="S3.T5.4.2.1.m1.1a"><mn id="S3.T5.4.2.1.m1.1.1" mathsize="80%" xref="S3.T5.4.2.1.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.T5.4.2.1.m1.1b"><cn id="S3.T5.4.2.1.m1.1.1.cmml" type="integer" xref="S3.T5.4.2.1.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.4.2.1.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="S3.T5.4.2.1.m1.1d">2</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T5.4.2.2"><span class="ltx_text" id="S3.T5.4.2.2.1" style="font-size:80%;">0.0994</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.4.2.3"><span class="ltx_text" id="S3.T5.4.2.3.1" style="font-size:80%;">0.0611</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.4.2.4"><span class="ltx_text" id="S3.T5.4.2.4.1" style="font-size:80%;">122ms</span></td>
<td class="ltx_td ltx_align_center" id="S3.T5.4.2.5"><span class="ltx_text" id="S3.T5.4.2.5.1" style="font-size:80%;">4.30G</span></td>
</tr>
<tr class="ltx_tr" id="S3.T5.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T5.5.3.1"><math alttext="4" class="ltx_Math" display="inline" id="S3.T5.5.3.1.m1.1"><semantics id="S3.T5.5.3.1.m1.1a"><mn id="S3.T5.5.3.1.m1.1.1" mathsize="80%" xref="S3.T5.5.3.1.m1.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.T5.5.3.1.m1.1b"><cn id="S3.T5.5.3.1.m1.1.1.cmml" type="integer" xref="S3.T5.5.3.1.m1.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T5.5.3.1.m1.1c">4</annotation><annotation encoding="application/x-llamapun" id="S3.T5.5.3.1.m1.1d">4</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.5.3.2"><span class="ltx_text" id="S3.T5.5.3.2.1" style="font-size:80%;">0.0963</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.5.3.3"><span class="ltx_text" id="S3.T5.5.3.3.1" style="font-size:80%;">0.0589</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.5.3.4"><span class="ltx_text" id="S3.T5.5.3.4.1" style="font-size:80%;">227ms</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T5.5.3.5"><span class="ltx_text" id="S3.T5.5.3.5.1" style="font-size:80%;">6.83G</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS6.p3">
<p class="ltx_p" id="S3.SS6.p3.1">From Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.T5" title="Table 5 ‣ 3.6. Hyperparameter Analysis ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, we observe that increasing the number of SIGMA layers does not guarantee the improvement of recommendation performance, but significantly impairs the inference efficiency, which can be attributed to the overfitting problem of multiple SIGMA layers. In addition, it is noteworthy that the performance of a single SIGMA layer is very close to the optimal one, indicating the strong modeling ability and superior efficiency of SIGMA.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.7. </span>Case Study </h3>
<div class="ltx_para" id="S3.SS7.p1">
<p class="ltx_p" id="S3.SS7.p1.2">In this section, we leverage a specific example in ML-1M to illustrate the effectiveness of partial flipping in SIGMA. Specifically, we choose a user (ID: 5050) and present the interaction sequence before and after the partial flipping in the left part of Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.F6" title="Figure 6 ‣ 3.7. Case Study ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>. With <math alttext="r=1" class="ltx_Math" display="inline" id="S3.SS7.p1.1.m1.1"><semantics id="S3.SS7.p1.1.m1.1a"><mrow id="S3.SS7.p1.1.m1.1.1" xref="S3.SS7.p1.1.m1.1.1.cmml"><mi id="S3.SS7.p1.1.m1.1.1.2" xref="S3.SS7.p1.1.m1.1.1.2.cmml">r</mi><mo id="S3.SS7.p1.1.m1.1.1.1" xref="S3.SS7.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS7.p1.1.m1.1.1.3" xref="S3.SS7.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS7.p1.1.m1.1b"><apply id="S3.SS7.p1.1.m1.1.1.cmml" xref="S3.SS7.p1.1.m1.1.1"><eq id="S3.SS7.p1.1.m1.1.1.1.cmml" xref="S3.SS7.p1.1.m1.1.1.1"></eq><ci id="S3.SS7.p1.1.m1.1.1.2.cmml" xref="S3.SS7.p1.1.m1.1.1.2">𝑟</ci><cn id="S3.SS7.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS7.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p1.1.m1.1c">r=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p1.1.m1.1d">italic_r = 1</annotation></semantics></math>, only the last item <math alttext="2762" class="ltx_Math" display="inline" id="S3.SS7.p1.2.m2.1"><semantics id="S3.SS7.p1.2.m2.1a"><mn id="S3.SS7.p1.2.m2.1.1" xref="S3.SS7.p1.2.m2.1.1.cmml">2762</mn><annotation-xml encoding="MathML-Content" id="S3.SS7.p1.2.m2.1b"><cn id="S3.SS7.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS7.p1.2.m2.1.1">2762</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS7.p1.2.m2.1c">2762</annotation><annotation encoding="application/x-llamapun" id="S3.SS7.p1.2.m2.1d">2762</annotation></semantics></math> is remained at the original position and other items are flipped. From this example, we can find that this user prefers comedy and romance movies (pink balls), as well as action and thriller movies (blue balls). Without the flipping, baselines focus on the most recent interactions on action and thriller movies and provide incorrect recommendations of the same genres (movie 3753 and 2028). While our SIGMA, with PF-Mamba, notices the previous preference on comedy and romance movies, makes the accurate recommendation of movie 539. Furthermore, we also present the overall performance for user-5050 in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S3.T6" title="Table 6 ‣ 3.7. Case Study ‣ 3. Experiment ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>, where SIGMA significantly defeat baselines.</p>
</div>
<figure class="ltx_figure" id="S3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="364" id="S3.F6.g1" src="x6.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F6.4.2.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S3.F6.2.1" style="font-size:90%;">Case study for User-<math alttext="5050" class="ltx_Math" display="inline" id="S3.F6.2.1.m1.1"><semantics id="S3.F6.2.1.m1.1b"><mn id="S3.F6.2.1.m1.1.1" xref="S3.F6.2.1.m1.1.1.cmml">5050</mn><annotation-xml encoding="MathML-Content" id="S3.F6.2.1.m1.1c"><cn id="S3.F6.2.1.m1.1.1.cmml" type="integer" xref="S3.F6.2.1.m1.1.1">5050</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.2.1.m1.1d">5050</annotation><annotation encoding="application/x-llamapun" id="S3.F6.2.1.m1.1e">5050</annotation></semantics></math> in ML-1M.</span></figcaption>
</figure>
<figure class="ltx_table" id="S3.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T6.4.2.1" style="font-size:90%;">Table 6</span>. </span><span class="ltx_text" id="S3.T6.2.1" style="font-size:90%;">Performance comparison on User-<math alttext="5050" class="ltx_Math" display="inline" id="S3.T6.2.1.m1.1"><semantics id="S3.T6.2.1.m1.1b"><mn id="S3.T6.2.1.m1.1.1" xref="S3.T6.2.1.m1.1.1.cmml">5050</mn><annotation-xml encoding="MathML-Content" id="S3.T6.2.1.m1.1c"><cn id="S3.T6.2.1.m1.1.1.cmml" type="integer" xref="S3.T6.2.1.m1.1.1">5050</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T6.2.1.m1.1d">5050</annotation><annotation encoding="application/x-llamapun" id="S3.T6.2.1.m1.1e">5050</annotation></semantics></math>.</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T6.5">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T6.5.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T6.5.1.1.1"><span class="ltx_text" id="S3.T6.5.1.1.1.1" style="font-size:80%;">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T6.5.1.1.2"><span class="ltx_text" id="S3.T6.5.1.1.2.1" style="font-size:80%;">HR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T6.5.1.1.3"><span class="ltx_text" id="S3.T6.5.1.1.3.1" style="font-size:80%;">NDCG@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T6.5.1.1.4"><span class="ltx_text" id="S3.T6.5.1.1.4.1" style="font-size:80%;">MRR@10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T6.5.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.5.2.1.1"><span class="ltx_text" id="S3.T6.5.2.1.1.1" style="font-size:80%;">Mamba</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.5.2.1.2"><span class="ltx_text" id="S3.T6.5.2.1.2.1" style="font-size:80%;">0.2998</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.5.2.1.3"><span class="ltx_text" id="S3.T6.5.2.1.3.1" style="font-size:80%;">0.1776</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T6.5.2.1.4"><span class="ltx_text" id="S3.T6.5.2.1.4.1" style="font-size:80%;">0.1391</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.5.3.2">
<td class="ltx_td ltx_align_center" id="S3.T6.5.3.2.1"><span class="ltx_text" id="S3.T6.5.3.2.1.1" style="font-size:80%;">ECHO</span></td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.3.2.2"><span class="ltx_text" id="S3.T6.5.3.2.2.1" style="font-size:80%;">0.3041</span></td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.3.2.3"><span class="ltx_text" id="S3.T6.5.3.2.3.1" style="font-size:80%;">0.1799</span></td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.3.2.4"><span class="ltx_text" id="S3.T6.5.3.2.4.1" style="font-size:80%;">0.1403</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.5.4.3">
<td class="ltx_td ltx_align_center" id="S3.T6.5.4.3.1"><span class="ltx_text" id="S3.T6.5.4.3.1.1" style="font-size:80%;">SIGMA</span></td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.4.3.2"><span class="ltx_text ltx_font_bold" id="S3.T6.5.4.3.2.1" style="font-size:80%;">0.3139</span></td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.4.3.3"><span class="ltx_text ltx_font_bold" id="S3.T6.5.4.3.3.1" style="font-size:80%;">0.1825</span></td>
<td class="ltx_td ltx_align_center" id="S3.T6.5.4.3.4"><span class="ltx_text ltx_font_bold" id="S3.T6.5.4.3.4.1" style="font-size:80%;">0.1423</span></td>
</tr>
<tr class="ltx_tr" id="S3.T6.5.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T6.5.5.4.1"><span class="ltx_text" id="S3.T6.5.5.4.1.1" style="font-size:80%;">Improv.</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T6.5.5.4.2"><span class="ltx_text" id="S3.T6.5.5.4.2.1" style="font-size:80%;">3.22%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T6.5.5.4.3"><span class="ltx_text" id="S3.T6.5.5.4.3.1" style="font-size:80%;">1.44%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T6.5.5.4.4"><span class="ltx_text" id="S3.T6.5.5.4.4.1" style="font-size:80%;">1.42%</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Related Work</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Sequential Recommendation</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Advancements in deep learning have transformed recommendation systems, making them more personalized and accurate in next-item prediction <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib29" title="">2023c</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib27" title="">b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib28" title="">2024b</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib23" title="">2022b</a>; Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib8" title="">2024</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib24" title="">2023a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib21" title="">b</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib2" title="">2023</a>; Cui et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib3" title="">2024</a>)</cite>. Early sequential recommendation frameworks have adopted CNNs and RNNs to capture users’ preferences but faced issues like catastrophic forgetting when dealing with long-term dependencies <cite class="ltx_cite ltx_citemacro_citep">(de Souza Pereira Moreira et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib5" title="">2021</a>; Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib17" title="">2019a</a>)</cite>. Then, the transformer-based models have emerged as powerful methods with their self-attention mechanism, significantly improving performance by selectively capturing the complex user-item interactions <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib15" title="">2018</a>)</cite>. However, they have suffered from inefficiency due to the quadratic computational complexity <cite class="ltx_cite ltx_citemacro_citep">(Keles et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib16" title="">2023</a>)</cite>. Therefore, to address the trade-off between effectiveness and efficiency, we propose SIGMA, a novel framework that achieves remarkable performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Selective State Space Model</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Currently, SSM-based models have been proven effective in time-series prediction due to their ability to capture the hidden dynamics <cite class="ltx_cite ltx_citemacro_citep">(Hamilton, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib10" title="">1994</a>)</cite>. To further address the issues of catastrophic forgetting and long-term dependency in sequential processing, a special SSM called Mamba was introduced. Originating from the structured state space model (S4)<cite class="ltx_cite ltx_citemacro_citep">(Smith et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib34" title="">2022</a>; Hamilton, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib10" title="">1994</a>)</cite>, Mamba has been proven to provide Transformer-level performance with better efficiency, particularly for long sequences <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib40" title="">2024</a>)</cite>. However, it still suffers from some challenges when adopted in the realm of recommendation <em class="ltx_emph ltx_font_italic" id="S4.SS2.p1.1.1">i.e.,</em> context modeling and short sequence modeling, which are mainly caused by Mamba’s original structure and the inflexibility in hidden state transferring. Correspondingly, we introduce a special bi-directional module called Partially Flipped Mamba and a Feature Extract GRU in our SIGMA framework, which somewhat addresses these problems and explores a novel way to leverage Mamba in SRS.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we analyze the challenges of applying Mamba to SRS and propose a novel framework, SIGMA, to address these challenges. We introduce a bidirectional PF-Mamba, featuring a well-designed DS gate, to allocate the weights of each direction and address the context modeling challenge, enabling our framework to leverage information from both past and future user-item interactions. Furthermore, to address the challenge of short sequence modeling, we propose FE-GRU to enhance the hidden representations for interaction sequences, mitigating the impact of long-tail users to some extent. Finally, we conduct extensive experiments on five real-world datasets, verifying SIGMA’s superiority and validating the effectiveness of each module.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xiong-Hui Chen, Bowei He, Yang Yu, Qingyang Li, Zhiwei Qin, Wenjie Shang, Jieping Ye, and Chen Ma. 2023.

</span>
<span class="ltx_bibblock">Sim2rec: A simulator-based decision-making approach to optimize real-world long-term user engagement in sequential recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">2023 IEEE 39th International Conference on Data Engineering (ICDE)</em>. IEEE, 3389–3402.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Ziqiang Cui, Haolun Wu, Bowei He, Ji Cheng, and Chen Ma. 2024.

</span>
<span class="ltx_bibblock">Diffusion-based Contrastive Learning for Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">arXiv preprint arXiv:2405.09369</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">De et al<span class="ltx_text" id="bib.bib4.3.3.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Soham De, Samuel L Smith, Anushan Fernando, Aleksandar Botev, George Cristian-Muraru, Albert Gu, Ruba Haroun, Leonard Berrada, Yutian Chen, Srivatsan Srinivasan, et al<span class="ltx_text" id="bib.bib4.4.1">.</span> 2024.

</span>
<span class="ltx_bibblock">Griffin: Mixing gated linear recurrences with local attention for efficient language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.5.1">arXiv preprint arXiv:2402.19427</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">de Souza Pereira Moreira et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Gabriel de Souza Pereira Moreira, Sara Rabhi, Jeong Min Lee, Ronay Ak, and Even Oldridge. 2021.

</span>
<span class="ltx_bibblock">Transformers4rec: Bridging the gap between nlp and sequential/session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 15th ACM conference on recommender systems</em>. 143–153.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xinyu Du, Huanhuan Yuan, Pengpeng Zhao, Jianfeng Qu, Fuzhen Zhuang, Guanfeng Liu, Yanchi Liu, and Victor S Sheng. 2023.

</span>
<span class="ltx_bibblock">Frequency enhanced hybrid attention network for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 78–88.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Hui Fang, Danning Zhang, Yiheng Shu, and Guibing Guo. 2020.

</span>
<span class="ltx_bibblock">Deep learning for sequential recommendation: Algorithms, influential factors, and evaluations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">ACM Transactions on Information Systems (TOIS)</em> 39, 1 (2020), 1–42.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jingtong Gao, Xiangyu Zhao, Muyang Li, Minghao Zhao, Runze Wu, Ruocheng Guo, Yiding Liu, and Dawei Yin. 2024.

</span>
<span class="ltx_bibblock">SMLP4Rec: An Efficient all-MLP Architecture for Sequential Recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">ACM Transactions on Information Systems</em> 42, 3 (2024), 1–23.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu and Dao (2023)</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao. 2023.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:2312.00752</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamilton (1994)</span>
<span class="ltx_bibblock">
James D Hamilton. 1994.

</span>
<span class="ltx_bibblock">State-space models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Handbook of econometrics</em> 4 (1994), 3039–3080.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Juncai He, Lin Li, Jinchao Xu, and Chunyue Zheng. 2018.

</span>
<span class="ltx_bibblock">ReLU deep neural networks and linear finite elements.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">arXiv preprint arXiv:1807.03973</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2015.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">arXiv preprint arXiv:1511.06939</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jannach and Ludewig (2017)</span>
<span class="ltx_bibblock">
Dietmar Jannach and Malte Ludewig. 2017.

</span>
<span class="ltx_bibblock">When recurrent neural networks meet the neighborhood for session-based recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the eleventh ACM conference on recommender systems</em>. 306–310.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Xilin Jiang, Cong Han, and Nima Mesgarani. 2024.

</span>
<span class="ltx_bibblock">Dual-path mamba: Short and long-term bidirectional selective structured state space models for speech separation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">arXiv preprint arXiv:2403.18257</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">2018 IEEE international conference on data mining (ICDM)</em>. IEEE, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Keles et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Feyza Duman Keles, Pruthuvi Mahesakya Wijewardena, and Chinmay Hegde. 2023.

</span>
<span class="ltx_bibblock">On the computational complexity of self-attention. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">International Conference on Algorithmic Learning Theory</em>. PMLR, 597–619.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Yejin Kim, Kwangseob Kim, Chanyoung Park, and Hwanjo Yu. 2019a.

</span>
<span class="ltx_bibblock">Sequential and Diverse Recommendation with Long Tail.. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">IJCAI</em>, Vol. 19. 2740–2746.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Yejin Kim, Kwangseob Kim, Chanyoung Park, and Hwanjo Yu. 2019b.

</span>
<span class="ltx_bibblock">Sequential and Diverse Recommendation with Long Tail.. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">IJCAI</em>, Vol. 19. 2740–2746.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:1412.6980</em> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kweon et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Wonbin Kweon, SeongKu Kang, and Hwanjo Yu. 2021.

</span>
<span class="ltx_bibblock">Bidirectional distillation for top-K recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the Web Conference 2021</em>. 3861–3871.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Chengxi Li, Yejing Wang, Qidong Liu, Xiangyu Zhao, Wanyu Wang, Yiqi Wang, Lixin Zou, Wenqi Fan, and Qing Li. 2023b.

</span>
<span class="ltx_bibblock">STRec: Sparse transformer for sequential recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>. 101–111.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Muyang Li, Xiangyu Zhao, Chuan Lyu, Minghao Zhao, Runze Wu, and Ruocheng Guo. 2022a.

</span>
<span class="ltx_bibblock">MLP4Rec: A pure MLP architecture for sequential recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">arXiv preprint arXiv:2204.11510</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Muyang Li, Xiangyu Zhao, Chuan Lyu, Minghao Zhao, Runze Wu, and Ruocheng Guo. 2022b.

</span>
<span class="ltx_bibblock">MLP4Rec: A pure MLP architecture for sequential recommendations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">arXiv preprint arXiv:2204.11510</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Xinhang Li, Chong Chen, Xiangyu Zhao, Yong Zhang, and Chunxiao Xing. 2023a.

</span>
<span class="ltx_bibblock">E4srec: An elegant effective efficient extensible solution of large language models for sequential recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">arXiv preprint arXiv:2312.02443</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Chengkai Liu, Jianghao Lin, Jianling Wang, Hanzhou Liu, and James Caverlee. 2024a.

</span>
<span class="ltx_bibblock">Mamba4rec: Towards efficient sequential recommendation with selective state space models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">arXiv preprint arXiv:2403.03900</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib26.3.3.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Langming Liu, Liu Cai, Chi Zhang, Xiangyu Zhao, Jingtong Gao, Wanyu Wang, Yifu Lv, Wenqi Fan, Yiqi Wang, Ming He, et al<span class="ltx_text" id="bib.bib26.4.1">.</span> 2023a.

</span>
<span class="ltx_bibblock">Linrec: Linear attention mechanism for long-term sequential recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.5.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 289–299.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Qidong Liu, Feng Tian, Qinghua Zheng, and Qianying Wang. 2023b.

</span>
<span class="ltx_bibblock">Disentangling interest and conformity for eliminating popularity bias in session-based recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Knowledge and Information Systems</em> 65, 6 (2023), 2645–2664.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Qidong Liu, Xian Wu, Xiangyu Zhao, Yejing Wang, Zijian Zhang, Feng Tian, and Yefeng Zheng. 2024b.

</span>
<span class="ltx_bibblock">Large Language Models Enhanced Sequential Recommendation for Long-tail User and Item.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">arXiv preprint arXiv:2405.20646</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Qidong Liu, Fan Yan, Xiangyu Zhao, Zhaocheng Du, Huifeng Guo, Ruiming Tang, and Feng Tian. 2023c.

</span>
<span class="ltx_bibblock">Diffusion augmentation for sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em>. 1576–1586.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miller et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
John A Miller, Mohammed Aldosari, Farah Saeed, Nasid Habib Barna, Subas Rana, I Budak Arpinar, and Ninghao Liu. 2024.

</span>
<span class="ltx_bibblock">A survey of deep learning and foundation models for time series forecasting.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">arXiv preprint arXiv:2401.13912</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nwankpa et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Chigozie Nwankpa, Winifred Ijomah, Anthony Gachagan, and Stephen Marshall. 2018.

</span>
<span class="ltx_bibblock">Activation functions: Comparison of trends in practice and research for deep learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">arXiv preprint arXiv:1811.03378</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhen Qin, Songlin Yang, and Yiran Zhong. 2024.

</span>
<span class="ltx_bibblock">Hierarchically gated recurrent neural network for sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Advances in Neural Information Processing Systems</em> 36 (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rappaz et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jérémie Rappaz, Julian McAuley, and Karl Aberer. 2021.

</span>
<span class="ltx_bibblock">Recommendation on live-streaming platforms: Dynamic availability and repeat consumption. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the 15th ACM Conference on Recommender Systems</em>. 390–399.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smith et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jimmy TH Smith, Andrew Warrington, and Scott W Linderman. 2022.

</span>
<span class="ltx_bibblock">Simplified state space layers for sequence modeling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">arXiv preprint arXiv:2208.04933</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jianling Wang, Raphael Louca, Diane Hu, Caitlin Cellier, James Caverlee, and Liangjie Hong. 2020.

</span>
<span class="ltx_bibblock">Time to Shop for Valentine’s Day: Shopping Occasions and Sequential Recommendation in E-commerce. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Proceedings of the 13th International Conference on Web Search and Data Mining</em>. 645–653.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shoujin Wang, Liang Hu, Yan Wang, Longbing Cao, Quan Z Sheng, and Mehmet Orgun. 2019.

</span>
<span class="ltx_bibblock">Sequential recommender systems: challenges, progress and prospects.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">arXiv preprint arXiv:2001.04830</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yuda Wang, Xuxin He, and Shengxin Zhu. 2024.

</span>
<span class="ltx_bibblock">EchoMamba4Rec: Harmonizing Bidirectional State Space Models with Spectral Filtering for Advanced Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">arXiv preprint arXiv:2406.02638</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib40.3.3.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jiyuan Yang, Yuanzi Li, Jingyu Zhao, Hanbing Wang, Muyang Ma, Jun Ma, Zhaochun Ren, Mengqi Zhang, Xin Xin, Zhumin Chen, et al<span class="ltx_text" id="bib.bib40.4.1">.</span> 2024.

</span>
<span class="ltx_bibblock">Uncovering Selective State Space Model’s Capabilities in Lifelong Sequential Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.5.1">arXiv preprint arXiv:2403.16371</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yoon and Jang (2023)</span>
<span class="ltx_bibblock">
Ji Hyung Yoon and Beakcheol Jang. 2023.

</span>
<span class="ltx_bibblock">Evolution of deep learning-based sequential recommender systems: from current trends to new perspectives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">IEEE Access</em> 11 (2023), 54265–54279.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Annan Yu, Michael W Mahoney, and N Benjamin Erichson. 2024.

</span>
<span class="ltx_bibblock">There is HOPE to Avoid HiPPOs for Long-memory State Space Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">arXiv preprint arXiv:2405.13975</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fajie Yuan, Alexandros Karatzoglou, Ioannis Arapakis, Joemon M Jose, and Xiangnan He. 2019.

</span>
<span class="ltx_bibblock">A simple convolutional generative network for next item recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Proceedings of the twelfth ACM international conference on web search and data mining</em>. 582–590.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Sheng Zhang, Maolin Wang, and Xiangyu Zhao. 2024.

</span>
<span class="ltx_bibblock">GLINT-RU: Gated Lightweight Intelligent Recurrent Units for Sequential Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">arXiv preprint arXiv:2406.10244</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Sabuncu (2018)</span>
<span class="ltx_bibblock">
Zhilu Zhang and Mert Sabuncu. 2018.

</span>
<span class="ltx_bibblock">Generalized cross entropy loss for training deep neural networks with noisy labels.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Advances in neural information processing systems</em> 31 (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Lianghui Zhu, Bencheng Liao, Qian Zhang, Xinlong Wang, Wenyu Liu, and Xinggang Wang. 2024.

</span>
<span class="ltx_bibblock">Vision mamba: Efficient visual representation learning with bidirectional state space model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">arXiv preprint arXiv:2401.09417</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Appendix</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1. </span>A. Complexity Analysis</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.12">In this section, we will analyze the time complexity of our proposed SIGMA framework.
We denote training iteration as <math alttext="{I}" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.1"><semantics id="S6.SS1.p1.1.m1.1a"><mi id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><ci id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">{I}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.1d">italic_I</annotation></semantics></math>, the sequence length as <math alttext="{N}" class="ltx_Math" display="inline" id="S6.SS1.p1.2.m2.1"><semantics id="S6.SS1.p1.2.m2.1a"><mi id="S6.SS1.p1.2.m2.1.1" xref="S6.SS1.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.2.m2.1b"><ci id="S6.SS1.p1.2.m2.1.1.cmml" xref="S6.SS1.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.2.m2.1c">{N}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.2.m2.1d">italic_N</annotation></semantics></math>, the embedding size as <math alttext="{D}" class="ltx_Math" display="inline" id="S6.SS1.p1.3.m3.1"><semantics id="S6.SS1.p1.3.m3.1a"><mi id="S6.SS1.p1.3.m3.1.1" xref="S6.SS1.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.3.m3.1b"><ci id="S6.SS1.p1.3.m3.1.1.cmml" xref="S6.SS1.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.3.m3.1c">{D}</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.3.m3.1d">italic_D</annotation></semantics></math> and the kernel size of Conv1d as <math alttext="k" class="ltx_Math" display="inline" id="S6.SS1.p1.4.m4.1"><semantics id="S6.SS1.p1.4.m4.1a"><mi id="S6.SS1.p1.4.m4.1.1" xref="S6.SS1.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.4.m4.1b"><ci id="S6.SS1.p1.4.m4.1.1.cmml" xref="S6.SS1.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.4.m4.1d">italic_k</annotation></semantics></math>. Following the previous formulas, we analyze the time complexity of the key components: (i) Firstly, since our DS Gate consists of several linear layers and one Conv1d Layer, the computation cost of it can be calculated as <math alttext="\mathcal{O}\left(3\times N\times D^{2}+N\times D\times k\right)" class="ltx_Math" display="inline" id="S6.SS1.p1.5.m5.1"><semantics id="S6.SS1.p1.5.m5.1a"><mrow id="S6.SS1.p1.5.m5.1.1" xref="S6.SS1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.5.m5.1.1.3" xref="S6.SS1.p1.5.m5.1.1.3.cmml">𝒪</mi><mo id="S6.SS1.p1.5.m5.1.1.2" xref="S6.SS1.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p1.5.m5.1.1.1.1" xref="S6.SS1.p1.5.m5.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.5.m5.1.1.1.1.2" xref="S6.SS1.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.5.m5.1.1.1.1.1" xref="S6.SS1.p1.5.m5.1.1.1.1.1.cmml"><mrow id="S6.SS1.p1.5.m5.1.1.1.1.1.2" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.cmml"><mn id="S6.SS1.p1.5.m5.1.1.1.1.1.2.2" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.2.cmml">3</mn><mo id="S6.SS1.p1.5.m5.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.1.cmml">×</mo><mi id="S6.SS1.p1.5.m5.1.1.1.1.1.2.3" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.3.cmml">N</mi><mo id="S6.SS1.p1.5.m5.1.1.1.1.1.2.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.1.cmml">×</mo><msup id="S6.SS1.p1.5.m5.1.1.1.1.1.2.4" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.cmml"><mi id="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.2" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.2.cmml">D</mi><mn id="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.3" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.3.cmml">2</mn></msup></mrow><mo id="S6.SS1.p1.5.m5.1.1.1.1.1.1" xref="S6.SS1.p1.5.m5.1.1.1.1.1.1.cmml">+</mo><mrow id="S6.SS1.p1.5.m5.1.1.1.1.1.3" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.cmml"><mi id="S6.SS1.p1.5.m5.1.1.1.1.1.3.2" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.2.cmml">N</mi><mo id="S6.SS1.p1.5.m5.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.1.cmml">×</mo><mi id="S6.SS1.p1.5.m5.1.1.1.1.1.3.3" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.3.cmml">D</mi><mo id="S6.SS1.p1.5.m5.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.1.cmml">×</mo><mi id="S6.SS1.p1.5.m5.1.1.1.1.1.3.4" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.4.cmml">k</mi></mrow></mrow><mo id="S6.SS1.p1.5.m5.1.1.1.1.3" xref="S6.SS1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.5.m5.1b"><apply id="S6.SS1.p1.5.m5.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1"><times id="S6.SS1.p1.5.m5.1.1.2.cmml" xref="S6.SS1.p1.5.m5.1.1.2"></times><ci id="S6.SS1.p1.5.m5.1.1.3.cmml" xref="S6.SS1.p1.5.m5.1.1.3">𝒪</ci><apply id="S6.SS1.p1.5.m5.1.1.1.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1"><plus id="S6.SS1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.1"></plus><apply id="S6.SS1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2"><times id="S6.SS1.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.1"></times><cn id="S6.SS1.p1.5.m5.1.1.1.1.1.2.2.cmml" type="integer" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.2">3</cn><ci id="S6.SS1.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.3">𝑁</ci><apply id="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.1.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.4">superscript</csymbol><ci id="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.2.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.2">𝐷</ci><cn id="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.3.cmml" type="integer" xref="S6.SS1.p1.5.m5.1.1.1.1.1.2.4.3">2</cn></apply></apply><apply id="S6.SS1.p1.5.m5.1.1.1.1.1.3.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3"><times id="S6.SS1.p1.5.m5.1.1.1.1.1.3.1.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.1"></times><ci id="S6.SS1.p1.5.m5.1.1.1.1.1.3.2.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.2">𝑁</ci><ci id="S6.SS1.p1.5.m5.1.1.1.1.1.3.3.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.3">𝐷</ci><ci id="S6.SS1.p1.5.m5.1.1.1.1.1.3.4.cmml" xref="S6.SS1.p1.5.m5.1.1.1.1.1.3.4">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.5.m5.1c">\mathcal{O}\left(3\times N\times D^{2}+N\times D\times k\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.5.m5.1d">caligraphic_O ( 3 × italic_N × italic_D start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_N × italic_D × italic_k )</annotation></semantics></math>. (ii) Secondly, the time complexity of Mamba is known as <math alttext="\mathcal{O}\left(N\times D\right)" class="ltx_Math" display="inline" id="S6.SS1.p1.6.m6.1"><semantics id="S6.SS1.p1.6.m6.1a"><mrow id="S6.SS1.p1.6.m6.1.1" xref="S6.SS1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.6.m6.1.1.3" xref="S6.SS1.p1.6.m6.1.1.3.cmml">𝒪</mi><mo id="S6.SS1.p1.6.m6.1.1.2" xref="S6.SS1.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p1.6.m6.1.1.1.1" xref="S6.SS1.p1.6.m6.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.6.m6.1.1.1.1.2" xref="S6.SS1.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.6.m6.1.1.1.1.1" xref="S6.SS1.p1.6.m6.1.1.1.1.1.cmml"><mi id="S6.SS1.p1.6.m6.1.1.1.1.1.2" xref="S6.SS1.p1.6.m6.1.1.1.1.1.2.cmml">N</mi><mo id="S6.SS1.p1.6.m6.1.1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.6.m6.1.1.1.1.1.1.cmml">×</mo><mi id="S6.SS1.p1.6.m6.1.1.1.1.1.3" xref="S6.SS1.p1.6.m6.1.1.1.1.1.3.cmml">D</mi></mrow><mo id="S6.SS1.p1.6.m6.1.1.1.1.3" xref="S6.SS1.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.6.m6.1b"><apply id="S6.SS1.p1.6.m6.1.1.cmml" xref="S6.SS1.p1.6.m6.1.1"><times id="S6.SS1.p1.6.m6.1.1.2.cmml" xref="S6.SS1.p1.6.m6.1.1.2"></times><ci id="S6.SS1.p1.6.m6.1.1.3.cmml" xref="S6.SS1.p1.6.m6.1.1.3">𝒪</ci><apply id="S6.SS1.p1.6.m6.1.1.1.1.1.cmml" xref="S6.SS1.p1.6.m6.1.1.1.1"><times id="S6.SS1.p1.6.m6.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.6.m6.1.1.1.1.1.1"></times><ci id="S6.SS1.p1.6.m6.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.6.m6.1.1.1.1.1.2">𝑁</ci><ci id="S6.SS1.p1.6.m6.1.1.1.1.1.3.cmml" xref="S6.SS1.p1.6.m6.1.1.1.1.1.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.6.m6.1c">\mathcal{O}\left(N\times D\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.6.m6.1d">caligraphic_O ( italic_N × italic_D )</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Gu and Dao, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib9" title="">2023</a>)</cite>. In the PF-Mamba, we add one more reverse direction and several linear layers, therefore, the total complexity can be calculated as <math alttext="\mathcal{O}\left(3\times N\times D^{2}+N\times D\times(k+2)\right)" class="ltx_Math" display="inline" id="S6.SS1.p1.7.m7.1"><semantics id="S6.SS1.p1.7.m7.1a"><mrow id="S6.SS1.p1.7.m7.1.1" xref="S6.SS1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.7.m7.1.1.3" xref="S6.SS1.p1.7.m7.1.1.3.cmml">𝒪</mi><mo id="S6.SS1.p1.7.m7.1.1.2" xref="S6.SS1.p1.7.m7.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p1.7.m7.1.1.1.1" xref="S6.SS1.p1.7.m7.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.7.m7.1.1.1.1.2" xref="S6.SS1.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.7.m7.1.1.1.1.1" xref="S6.SS1.p1.7.m7.1.1.1.1.1.cmml"><mrow id="S6.SS1.p1.7.m7.1.1.1.1.1.3" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.cmml"><mn id="S6.SS1.p1.7.m7.1.1.1.1.1.3.2" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.2.cmml">3</mn><mo id="S6.SS1.p1.7.m7.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.1.cmml">×</mo><mi id="S6.SS1.p1.7.m7.1.1.1.1.1.3.3" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.3.cmml">N</mi><mo id="S6.SS1.p1.7.m7.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.1.cmml">×</mo><msup id="S6.SS1.p1.7.m7.1.1.1.1.1.3.4" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.cmml"><mi id="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.2" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.2.cmml">D</mi><mn id="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.3" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.3.cmml">2</mn></msup></mrow><mo id="S6.SS1.p1.7.m7.1.1.1.1.1.2" xref="S6.SS1.p1.7.m7.1.1.1.1.1.2.cmml">+</mo><mrow id="S6.SS1.p1.7.m7.1.1.1.1.1.1" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.cmml"><mi id="S6.SS1.p1.7.m7.1.1.1.1.1.1.3" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.3.cmml">N</mi><mo id="S6.SS1.p1.7.m7.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.2.cmml">×</mo><mi id="S6.SS1.p1.7.m7.1.1.1.1.1.1.4" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.4.cmml">D</mi><mo id="S6.SS1.p1.7.m7.1.1.1.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.2.cmml">×</mo><mrow id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.2" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.2.cmml">k</mi><mo id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.3" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.SS1.p1.7.m7.1.1.1.1.3" xref="S6.SS1.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.7.m7.1b"><apply id="S6.SS1.p1.7.m7.1.1.cmml" xref="S6.SS1.p1.7.m7.1.1"><times id="S6.SS1.p1.7.m7.1.1.2.cmml" xref="S6.SS1.p1.7.m7.1.1.2"></times><ci id="S6.SS1.p1.7.m7.1.1.3.cmml" xref="S6.SS1.p1.7.m7.1.1.3">𝒪</ci><apply id="S6.SS1.p1.7.m7.1.1.1.1.1.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1"><plus id="S6.SS1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.2"></plus><apply id="S6.SS1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3"><times id="S6.SS1.p1.7.m7.1.1.1.1.1.3.1.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.1"></times><cn id="S6.SS1.p1.7.m7.1.1.1.1.1.3.2.cmml" type="integer" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.2">3</cn><ci id="S6.SS1.p1.7.m7.1.1.1.1.1.3.3.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.3">𝑁</ci><apply id="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.1.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.4">superscript</csymbol><ci id="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.2.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.2">𝐷</ci><cn id="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.3.cmml" type="integer" xref="S6.SS1.p1.7.m7.1.1.1.1.1.3.4.3">2</cn></apply></apply><apply id="S6.SS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1"><times id="S6.SS1.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.2"></times><ci id="S6.SS1.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.3">𝑁</ci><ci id="S6.SS1.p1.7.m7.1.1.1.1.1.1.4.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.4">𝐷</ci><apply id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1"><plus id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.2">𝑘</ci><cn id="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS1.p1.7.m7.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.7.m7.1c">\mathcal{O}\left(3\times N\times D^{2}+N\times D\times(k+2)\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.7.m7.1d">caligraphic_O ( 3 × italic_N × italic_D start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_N × italic_D × ( italic_k + 2 ) )</annotation></semantics></math>. (iii) Thirdly, for the FE-GRU, which consists of Conv1d and GRU cell, the computational complexity can be calculated by simply adding GRU and Conv1d together: <math alttext="\mathcal{O}\left(N\times D^{2}+N\times D\times k\right)" class="ltx_Math" display="inline" id="S6.SS1.p1.8.m8.1"><semantics id="S6.SS1.p1.8.m8.1a"><mrow id="S6.SS1.p1.8.m8.1.1" xref="S6.SS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.8.m8.1.1.3" xref="S6.SS1.p1.8.m8.1.1.3.cmml">𝒪</mi><mo id="S6.SS1.p1.8.m8.1.1.2" xref="S6.SS1.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p1.8.m8.1.1.1.1" xref="S6.SS1.p1.8.m8.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.8.m8.1.1.1.1.2" xref="S6.SS1.p1.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.8.m8.1.1.1.1.1" xref="S6.SS1.p1.8.m8.1.1.1.1.1.cmml"><mrow id="S6.SS1.p1.8.m8.1.1.1.1.1.2" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.cmml"><mi id="S6.SS1.p1.8.m8.1.1.1.1.1.2.2" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.2.cmml">N</mi><mo id="S6.SS1.p1.8.m8.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.1.cmml">×</mo><msup id="S6.SS1.p1.8.m8.1.1.1.1.1.2.3" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.cmml"><mi id="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.2" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.2.cmml">D</mi><mn id="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.3" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.3.cmml">2</mn></msup></mrow><mo id="S6.SS1.p1.8.m8.1.1.1.1.1.1" xref="S6.SS1.p1.8.m8.1.1.1.1.1.1.cmml">+</mo><mrow id="S6.SS1.p1.8.m8.1.1.1.1.1.3" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.cmml"><mi id="S6.SS1.p1.8.m8.1.1.1.1.1.3.2" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.2.cmml">N</mi><mo id="S6.SS1.p1.8.m8.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.1.cmml">×</mo><mi id="S6.SS1.p1.8.m8.1.1.1.1.1.3.3" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.3.cmml">D</mi><mo id="S6.SS1.p1.8.m8.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.1.cmml">×</mo><mi id="S6.SS1.p1.8.m8.1.1.1.1.1.3.4" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.4.cmml">k</mi></mrow></mrow><mo id="S6.SS1.p1.8.m8.1.1.1.1.3" xref="S6.SS1.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.8.m8.1b"><apply id="S6.SS1.p1.8.m8.1.1.cmml" xref="S6.SS1.p1.8.m8.1.1"><times id="S6.SS1.p1.8.m8.1.1.2.cmml" xref="S6.SS1.p1.8.m8.1.1.2"></times><ci id="S6.SS1.p1.8.m8.1.1.3.cmml" xref="S6.SS1.p1.8.m8.1.1.3">𝒪</ci><apply id="S6.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1"><plus id="S6.SS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.1"></plus><apply id="S6.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2"><times id="S6.SS1.p1.8.m8.1.1.1.1.1.2.1.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.1"></times><ci id="S6.SS1.p1.8.m8.1.1.1.1.1.2.2.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.2">𝑁</ci><apply id="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.1.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.3">superscript</csymbol><ci id="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.2.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.2">𝐷</ci><cn id="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S6.SS1.p1.8.m8.1.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="S6.SS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3"><times id="S6.SS1.p1.8.m8.1.1.1.1.1.3.1.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.1"></times><ci id="S6.SS1.p1.8.m8.1.1.1.1.1.3.2.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.2">𝑁</ci><ci id="S6.SS1.p1.8.m8.1.1.1.1.1.3.3.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.3">𝐷</ci><ci id="S6.SS1.p1.8.m8.1.1.1.1.1.3.4.cmml" xref="S6.SS1.p1.8.m8.1.1.1.1.1.3.4">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.8.m8.1c">\mathcal{O}\left(N\times D^{2}+N\times D\times k\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.8.m8.1d">caligraphic_O ( italic_N × italic_D start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_N × italic_D × italic_k )</annotation></semantics></math>. In conclusion, the whole time complexity of SIGMA is <math alttext="\mathcal{O}\left(13\times N\times D^{2}+N\times D\times(2k+2)\right)" class="ltx_Math" display="inline" id="S6.SS1.p1.9.m9.1"><semantics id="S6.SS1.p1.9.m9.1a"><mrow id="S6.SS1.p1.9.m9.1.1" xref="S6.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.9.m9.1.1.3" xref="S6.SS1.p1.9.m9.1.1.3.cmml">𝒪</mi><mo id="S6.SS1.p1.9.m9.1.1.2" xref="S6.SS1.p1.9.m9.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p1.9.m9.1.1.1.1" xref="S6.SS1.p1.9.m9.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.9.m9.1.1.1.1.2" xref="S6.SS1.p1.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.9.m9.1.1.1.1.1" xref="S6.SS1.p1.9.m9.1.1.1.1.1.cmml"><mrow id="S6.SS1.p1.9.m9.1.1.1.1.1.3" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.cmml"><mn id="S6.SS1.p1.9.m9.1.1.1.1.1.3.2" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.2.cmml">13</mn><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.1.cmml">×</mo><mi id="S6.SS1.p1.9.m9.1.1.1.1.1.3.3" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.3.cmml">N</mi><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.1.cmml">×</mo><msup id="S6.SS1.p1.9.m9.1.1.1.1.1.3.4" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.cmml"><mi id="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.2" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.2.cmml">D</mi><mn id="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.3" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.3.cmml">2</mn></msup></mrow><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.2" xref="S6.SS1.p1.9.m9.1.1.1.1.1.2.cmml">+</mo><mrow id="S6.SS1.p1.9.m9.1.1.1.1.1.1" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.cmml"><mi id="S6.SS1.p1.9.m9.1.1.1.1.1.1.3" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.3.cmml">N</mi><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.2.cmml">×</mo><mi id="S6.SS1.p1.9.m9.1.1.1.1.1.1.4" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.4.cmml">D</mi><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.2.cmml">×</mo><mrow id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.cmml"><mn id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.2" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.2.cmml">2</mn><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.1" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.3" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi></mrow><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.1" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mn id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.3" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.3.cmml">2</mn></mrow><mo id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S6.SS1.p1.9.m9.1.1.1.1.3" xref="S6.SS1.p1.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.9.m9.1b"><apply id="S6.SS1.p1.9.m9.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1"><times id="S6.SS1.p1.9.m9.1.1.2.cmml" xref="S6.SS1.p1.9.m9.1.1.2"></times><ci id="S6.SS1.p1.9.m9.1.1.3.cmml" xref="S6.SS1.p1.9.m9.1.1.3">𝒪</ci><apply id="S6.SS1.p1.9.m9.1.1.1.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1"><plus id="S6.SS1.p1.9.m9.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.2"></plus><apply id="S6.SS1.p1.9.m9.1.1.1.1.1.3.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3"><times id="S6.SS1.p1.9.m9.1.1.1.1.1.3.1.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.1"></times><cn id="S6.SS1.p1.9.m9.1.1.1.1.1.3.2.cmml" type="integer" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.2">13</cn><ci id="S6.SS1.p1.9.m9.1.1.1.1.1.3.3.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.3">𝑁</ci><apply id="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.1.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.4">superscript</csymbol><ci id="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.2.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.2">𝐷</ci><cn id="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.3.cmml" type="integer" xref="S6.SS1.p1.9.m9.1.1.1.1.1.3.4.3">2</cn></apply></apply><apply id="S6.SS1.p1.9.m9.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1"><times id="S6.SS1.p1.9.m9.1.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.2"></times><ci id="S6.SS1.p1.9.m9.1.1.1.1.1.1.3.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.3">𝑁</ci><ci id="S6.SS1.p1.9.m9.1.1.1.1.1.1.4.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.4">𝐷</ci><apply id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1"><plus id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2"><times id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.1"></times><cn id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.2">2</cn><ci id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><cn id="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS1.p1.9.m9.1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.9.m9.1c">\mathcal{O}\left(13\times N\times D^{2}+N\times D\times(2k+2)\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.9.m9.1d">caligraphic_O ( 13 × italic_N × italic_D start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + italic_N × italic_D × ( 2 italic_k + 2 ) )</annotation></semantics></math>. Considering the extreme situation when dealing with quite long sequences (<math alttext="\left(N\gg D\right)" class="ltx_Math" display="inline" id="S6.SS1.p1.10.m10.1"><semantics id="S6.SS1.p1.10.m10.1a"><mrow id="S6.SS1.p1.10.m10.1.1.1" xref="S6.SS1.p1.10.m10.1.1.1.1.cmml"><mo id="S6.SS1.p1.10.m10.1.1.1.2" xref="S6.SS1.p1.10.m10.1.1.1.1.cmml">(</mo><mrow id="S6.SS1.p1.10.m10.1.1.1.1" xref="S6.SS1.p1.10.m10.1.1.1.1.cmml"><mi id="S6.SS1.p1.10.m10.1.1.1.1.2" xref="S6.SS1.p1.10.m10.1.1.1.1.2.cmml">N</mi><mo id="S6.SS1.p1.10.m10.1.1.1.1.1" xref="S6.SS1.p1.10.m10.1.1.1.1.1.cmml">≫</mo><mi id="S6.SS1.p1.10.m10.1.1.1.1.3" xref="S6.SS1.p1.10.m10.1.1.1.1.3.cmml">D</mi></mrow><mo id="S6.SS1.p1.10.m10.1.1.1.3" xref="S6.SS1.p1.10.m10.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.10.m10.1b"><apply id="S6.SS1.p1.10.m10.1.1.1.1.cmml" xref="S6.SS1.p1.10.m10.1.1.1"><csymbol cd="latexml" id="S6.SS1.p1.10.m10.1.1.1.1.1.cmml" xref="S6.SS1.p1.10.m10.1.1.1.1.1">much-greater-than</csymbol><ci id="S6.SS1.p1.10.m10.1.1.1.1.2.cmml" xref="S6.SS1.p1.10.m10.1.1.1.1.2">𝑁</ci><ci id="S6.SS1.p1.10.m10.1.1.1.1.3.cmml" xref="S6.SS1.p1.10.m10.1.1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.10.m10.1c">\left(N\gg D\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.10.m10.1d">( italic_N ≫ italic_D )</annotation></semantics></math>), it can be further simplified to <math alttext="\mathcal{O}\left(N\right)" class="ltx_Math" display="inline" id="S6.SS1.p1.11.m11.1"><semantics id="S6.SS1.p1.11.m11.1a"><mrow id="S6.SS1.p1.11.m11.1.2" xref="S6.SS1.p1.11.m11.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.11.m11.1.2.2" xref="S6.SS1.p1.11.m11.1.2.2.cmml">𝒪</mi><mo id="S6.SS1.p1.11.m11.1.2.1" xref="S6.SS1.p1.11.m11.1.2.1.cmml">⁢</mo><mrow id="S6.SS1.p1.11.m11.1.2.3.2" xref="S6.SS1.p1.11.m11.1.2.cmml"><mo id="S6.SS1.p1.11.m11.1.2.3.2.1" xref="S6.SS1.p1.11.m11.1.2.cmml">(</mo><mi id="S6.SS1.p1.11.m11.1.1" xref="S6.SS1.p1.11.m11.1.1.cmml">N</mi><mo id="S6.SS1.p1.11.m11.1.2.3.2.2" xref="S6.SS1.p1.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.11.m11.1b"><apply id="S6.SS1.p1.11.m11.1.2.cmml" xref="S6.SS1.p1.11.m11.1.2"><times id="S6.SS1.p1.11.m11.1.2.1.cmml" xref="S6.SS1.p1.11.m11.1.2.1"></times><ci id="S6.SS1.p1.11.m11.1.2.2.cmml" xref="S6.SS1.p1.11.m11.1.2.2">𝒪</ci><ci id="S6.SS1.p1.11.m11.1.1.cmml" xref="S6.SS1.p1.11.m11.1.1">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.11.m11.1c">\mathcal{O}\left(N\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.11.m11.1d">caligraphic_O ( italic_N )</annotation></semantics></math>, compared to the <math alttext="\mathcal{O}\left({N}^{2}\right)" class="ltx_Math" display="inline" id="S6.SS1.p1.12.m12.1"><semantics id="S6.SS1.p1.12.m12.1a"><mrow id="S6.SS1.p1.12.m12.1.1" xref="S6.SS1.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS1.p1.12.m12.1.1.3" xref="S6.SS1.p1.12.m12.1.1.3.cmml">𝒪</mi><mo id="S6.SS1.p1.12.m12.1.1.2" xref="S6.SS1.p1.12.m12.1.1.2.cmml">⁢</mo><mrow id="S6.SS1.p1.12.m12.1.1.1.1" xref="S6.SS1.p1.12.m12.1.1.1.1.1.cmml"><mo id="S6.SS1.p1.12.m12.1.1.1.1.2" xref="S6.SS1.p1.12.m12.1.1.1.1.1.cmml">(</mo><msup id="S6.SS1.p1.12.m12.1.1.1.1.1" xref="S6.SS1.p1.12.m12.1.1.1.1.1.cmml"><mi id="S6.SS1.p1.12.m12.1.1.1.1.1.2" xref="S6.SS1.p1.12.m12.1.1.1.1.1.2.cmml">N</mi><mn id="S6.SS1.p1.12.m12.1.1.1.1.1.3" xref="S6.SS1.p1.12.m12.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S6.SS1.p1.12.m12.1.1.1.1.3" xref="S6.SS1.p1.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.12.m12.1b"><apply id="S6.SS1.p1.12.m12.1.1.cmml" xref="S6.SS1.p1.12.m12.1.1"><times id="S6.SS1.p1.12.m12.1.1.2.cmml" xref="S6.SS1.p1.12.m12.1.1.2"></times><ci id="S6.SS1.p1.12.m12.1.1.3.cmml" xref="S6.SS1.p1.12.m12.1.1.3">𝒪</ci><apply id="S6.SS1.p1.12.m12.1.1.1.1.1.cmml" xref="S6.SS1.p1.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS1.p1.12.m12.1.1.1.1.1.1.cmml" xref="S6.SS1.p1.12.m12.1.1.1.1">superscript</csymbol><ci id="S6.SS1.p1.12.m12.1.1.1.1.1.2.cmml" xref="S6.SS1.p1.12.m12.1.1.1.1.1.2">𝑁</ci><cn id="S6.SS1.p1.12.m12.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS1.p1.12.m12.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.12.m12.1c">\mathcal{O}\left({N}^{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.12.m12.1d">caligraphic_O ( italic_N start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> complexity of transformer-based models <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib25" title="">2024a</a>)</cite>, showing its superiority in efficiency, which also support by the experimental results on ML-1M dataset.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2. </span>B. Dataset Information</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">We mainly evaluate our framework on five real-world datasets, <em class="ltx_emph ltx_font_italic" id="S6.SS2.p1.1.1">i.e.,</em> Beauty, Sports, Games, Yelp and ML-1M, which are all large-scale public datasets that have been widely used as benchmarks in the next-item prediction task <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib40" title="">2024</a>)</cite>.</p>
<ul class="ltx_itemize" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S6.I1.i1.p1.2.1">Yelp<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote4.1.1.1">4</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://www.yelp.com/dataset" title="">https://www.yelp.com/dataset</a></span></span></span></span>: This dataset is released by Yelp as part of their Dataset Challenge. The data source includes user reviews, business information, and user interactions on Yelp. It contains over <math alttext="6.9" class="ltx_Math" display="inline" id="S6.I1.i1.p1.1.m1.1"><semantics id="S6.I1.i1.p1.1.m1.1a"><mn id="S6.I1.i1.p1.1.m1.1.1" xref="S6.I1.i1.p1.1.m1.1.1.cmml">6.9</mn><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.1.m1.1b"><cn id="S6.I1.i1.p1.1.m1.1.1.cmml" type="float" xref="S6.I1.i1.p1.1.m1.1.1">6.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.1.m1.1c">6.9</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.1.m1.1d">6.9</annotation></semantics></math> million reviews, details on more than <math alttext="150,000" class="ltx_Math" display="inline" id="S6.I1.i1.p1.2.m2.2"><semantics id="S6.I1.i1.p1.2.m2.2a"><mrow id="S6.I1.i1.p1.2.m2.2.3.2" xref="S6.I1.i1.p1.2.m2.2.3.1.cmml"><mn id="S6.I1.i1.p1.2.m2.1.1" xref="S6.I1.i1.p1.2.m2.1.1.cmml">150</mn><mo id="S6.I1.i1.p1.2.m2.2.3.2.1" xref="S6.I1.i1.p1.2.m2.2.3.1.cmml">,</mo><mn id="S6.I1.i1.p1.2.m2.2.2" xref="S6.I1.i1.p1.2.m2.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.I1.i1.p1.2.m2.2b"><list id="S6.I1.i1.p1.2.m2.2.3.1.cmml" xref="S6.I1.i1.p1.2.m2.2.3.2"><cn id="S6.I1.i1.p1.2.m2.1.1.cmml" type="integer" xref="S6.I1.i1.p1.2.m2.1.1">150</cn><cn id="S6.I1.i1.p1.2.m2.2.2.cmml" type="integer" xref="S6.I1.i1.p1.2.m2.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i1.p1.2.m2.2c">150,000</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i1.p1.2.m2.2d">150 , 000</annotation></semantics></math> businesses, and user interaction data like check-ins and tips.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i2.p1.1.1">Amazon based<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote5.1.1.1">5</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://cseweb.ucsd.edu/jmcauley/datasets.html#amazon_reviews" title="">https://cseweb.ucsd.edu/jmcauley/datasets.html#amazon_reviews</a></span></span></span></span>: These three datasets, provided by Amazon, include customer reviews and metadata from the Beauty, Sports, and Games categories which feature millions of reviews, with attributes such as review text, ratings, product IDs, and reviewer information.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.2"><span class="ltx_text ltx_font_bold" id="S6.I1.i3.p1.2.1">MovieLens-1M<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote6.1.1.1">6</span></span><a class="ltx_ref ltx_url ltx_font_typewriter ltx_font_medium" href="https://grouplens.org/datasets/movielens/" title="">https://grouplens.org/datasets/movielens/</a></span></span></span></span>: The MovieLens 1M dataset is released by GroupLens Research. It comprises 1 million movie ratings from <math alttext="6,041" class="ltx_Math" display="inline" id="S6.I1.i3.p1.1.m1.2"><semantics id="S6.I1.i3.p1.1.m1.2a"><mrow id="S6.I1.i3.p1.1.m1.2.3.2" xref="S6.I1.i3.p1.1.m1.2.3.1.cmml"><mn id="S6.I1.i3.p1.1.m1.1.1" xref="S6.I1.i3.p1.1.m1.1.1.cmml">6</mn><mo id="S6.I1.i3.p1.1.m1.2.3.2.1" xref="S6.I1.i3.p1.1.m1.2.3.1.cmml">,</mo><mn id="S6.I1.i3.p1.1.m1.2.2" xref="S6.I1.i3.p1.1.m1.2.2.cmml">041</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.I1.i3.p1.1.m1.2b"><list id="S6.I1.i3.p1.1.m1.2.3.1.cmml" xref="S6.I1.i3.p1.1.m1.2.3.2"><cn id="S6.I1.i3.p1.1.m1.1.1.cmml" type="integer" xref="S6.I1.i3.p1.1.m1.1.1">6</cn><cn id="S6.I1.i3.p1.1.m1.2.2.cmml" type="integer" xref="S6.I1.i3.p1.1.m1.2.2">041</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i3.p1.1.m1.2c">6,041</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i3.p1.1.m1.2d">6 , 041</annotation></semantics></math> users on <math alttext="3417" class="ltx_Math" display="inline" id="S6.I1.i3.p1.2.m2.1"><semantics id="S6.I1.i3.p1.2.m2.1a"><mn id="S6.I1.i3.p1.2.m2.1.1" xref="S6.I1.i3.p1.2.m2.1.1.cmml">3417</mn><annotation-xml encoding="MathML-Content" id="S6.I1.i3.p1.2.m2.1b"><cn id="S6.I1.i3.p1.2.m2.1.1.cmml" type="integer" xref="S6.I1.i3.p1.2.m2.1.1">3417</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.I1.i3.p1.2.m2.1c">3417</annotation><annotation encoding="application/x-llamapun" id="S6.I1.i3.p1.2.m2.1d">3417</annotation></semantics></math> movies with attributes like user demographics, movie titles, genres, and timestamps.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.2">In the experiments, we employ a leave-one-out method for splitting the datasets and arrange all the user interactions sequentially by time. Moreover, for each user and item, we construct an interaction sequence by simply sorting their interaction records based on timestamps and ratings. Considering the average length and total samples of each dataset vary, we filter users and items with less than five recorded interactions for ML-1M, Beauty, and Games, following the setting in original papers <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib32" title="">2024</a>)</cite>. For Yelp and Sports, we also added upper bounds (<math alttext="100" class="ltx_Math" display="inline" id="S6.SS2.p2.1.m1.1"><semantics id="S6.SS2.p2.1.m1.1a"><mn id="S6.SS2.p2.1.m1.1.1" xref="S6.SS2.p2.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.1.m1.1b"><cn id="S6.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S6.SS2.p2.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.1.m1.1c">100</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.1.m1.1d">100</annotation></semantics></math> for Yelp and <math alttext="200" class="ltx_Math" display="inline" id="S6.SS2.p2.2.m2.1"><semantics id="S6.SS2.p2.2.m2.1a"><mn id="S6.SS2.p2.2.m2.1.1" xref="S6.SS2.p2.2.m2.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S6.SS2.p2.2.m2.1b"><cn id="S6.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S6.SS2.p2.2.m2.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p2.2.m2.1c">200</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.p2.2.m2.1d">200</annotation></semantics></math> for Sports).</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3. </span>C. Evaluation Metrics</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">In this section, we will detail the information and calculations of our selected evaluation metrics.</p>
<ul class="ltx_itemize" id="S6.I2">
<li class="ltx_item" id="S6.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I2.i1.p1">
<p class="ltx_p" id="S6.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I2.i1.p1.1.1">HR@10</span>: HR@10 represents Hit Rate truncated at 10, which measures the fraction of users for whom the correct item is ranked within the top 10 predictions. Specifically, for a user <math alttext="u" class="ltx_Math" display="inline" id="S6.I2.i1.p1.1.m1.1"><semantics id="S6.I2.i1.p1.1.m1.1a"><mi id="S6.I2.i1.p1.1.m1.1.1" xref="S6.I2.i1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S6.I2.i1.p1.1.m1.1b"><ci id="S6.I2.i1.p1.1.m1.1.1.cmml" xref="S6.I2.i1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i1.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i1.p1.1.m1.1d">italic_u</annotation></semantics></math>, it is calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S6.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{HR@10}=\frac{1}{|\mathcal{U}|}\sum_{u\in\mathcal{U}}\mathbb{1}\left(%
\text{rank}_{\text{correct}}(v_{u})\leq 10\right)" class="ltx_Math" display="block" id="S6.E13.m1.2"><semantics id="S6.E13.m1.2a"><mrow id="S6.E13.m1.2.2" xref="S6.E13.m1.2.2.cmml"><mtext id="S6.E13.m1.2.2.3" xref="S6.E13.m1.2.2.3a.cmml">HR@10</mtext><mo id="S6.E13.m1.2.2.2" xref="S6.E13.m1.2.2.2.cmml">=</mo><mrow id="S6.E13.m1.2.2.1" xref="S6.E13.m1.2.2.1.cmml"><mfrac id="S6.E13.m1.1.1" xref="S6.E13.m1.1.1.cmml"><mn id="S6.E13.m1.1.1.3" xref="S6.E13.m1.1.1.3.cmml">1</mn><mrow id="S6.E13.m1.1.1.1.3" xref="S6.E13.m1.1.1.1.2.cmml"><mo id="S6.E13.m1.1.1.1.3.1" stretchy="false" xref="S6.E13.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S6.E13.m1.1.1.1.1" xref="S6.E13.m1.1.1.1.1.cmml">𝒰</mi><mo id="S6.E13.m1.1.1.1.3.2" stretchy="false" xref="S6.E13.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S6.E13.m1.2.2.1.2" xref="S6.E13.m1.2.2.1.2.cmml">⁢</mo><mrow id="S6.E13.m1.2.2.1.1" xref="S6.E13.m1.2.2.1.1.cmml"><munder id="S6.E13.m1.2.2.1.1.2" xref="S6.E13.m1.2.2.1.1.2.cmml"><mo id="S6.E13.m1.2.2.1.1.2.2" movablelimits="false" xref="S6.E13.m1.2.2.1.1.2.2.cmml">∑</mo><mrow id="S6.E13.m1.2.2.1.1.2.3" xref="S6.E13.m1.2.2.1.1.2.3.cmml"><mi id="S6.E13.m1.2.2.1.1.2.3.2" xref="S6.E13.m1.2.2.1.1.2.3.2.cmml">u</mi><mo id="S6.E13.m1.2.2.1.1.2.3.1" xref="S6.E13.m1.2.2.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S6.E13.m1.2.2.1.1.2.3.3" xref="S6.E13.m1.2.2.1.1.2.3.3.cmml">𝒰</mi></mrow></munder><mrow id="S6.E13.m1.2.2.1.1.1" xref="S6.E13.m1.2.2.1.1.1.cmml"><mn id="S6.E13.m1.2.2.1.1.1.3" xref="S6.E13.m1.2.2.1.1.1.3.cmml">𝟙</mn><mo id="S6.E13.m1.2.2.1.1.1.2" xref="S6.E13.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S6.E13.m1.2.2.1.1.1.1.1" xref="S6.E13.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S6.E13.m1.2.2.1.1.1.1.1.2" xref="S6.E13.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S6.E13.m1.2.2.1.1.1.1.1.1" xref="S6.E13.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S6.E13.m1.2.2.1.1.1.1.1.1.1" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mtext id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.2a.cmml">rank</mtext><mtext id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.3a.cmml">correct</mtext></msub><mo id="S6.E13.m1.2.2.1.1.1.1.1.1.1.2" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S6.E13.m1.2.2.1.1.1.1.1.1.2" xref="S6.E13.m1.2.2.1.1.1.1.1.1.2.cmml">≤</mo><mn id="S6.E13.m1.2.2.1.1.1.1.1.1.3" xref="S6.E13.m1.2.2.1.1.1.1.1.1.3.cmml">10</mn></mrow><mo id="S6.E13.m1.2.2.1.1.1.1.1.3" xref="S6.E13.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E13.m1.2b"><apply id="S6.E13.m1.2.2.cmml" xref="S6.E13.m1.2.2"><eq id="S6.E13.m1.2.2.2.cmml" xref="S6.E13.m1.2.2.2"></eq><ci id="S6.E13.m1.2.2.3a.cmml" xref="S6.E13.m1.2.2.3"><mtext id="S6.E13.m1.2.2.3.cmml" xref="S6.E13.m1.2.2.3">HR@10</mtext></ci><apply id="S6.E13.m1.2.2.1.cmml" xref="S6.E13.m1.2.2.1"><times id="S6.E13.m1.2.2.1.2.cmml" xref="S6.E13.m1.2.2.1.2"></times><apply id="S6.E13.m1.1.1.cmml" xref="S6.E13.m1.1.1"><divide id="S6.E13.m1.1.1.2.cmml" xref="S6.E13.m1.1.1"></divide><cn id="S6.E13.m1.1.1.3.cmml" type="integer" xref="S6.E13.m1.1.1.3">1</cn><apply id="S6.E13.m1.1.1.1.2.cmml" xref="S6.E13.m1.1.1.1.3"><abs id="S6.E13.m1.1.1.1.2.1.cmml" xref="S6.E13.m1.1.1.1.3.1"></abs><ci id="S6.E13.m1.1.1.1.1.cmml" xref="S6.E13.m1.1.1.1.1">𝒰</ci></apply></apply><apply id="S6.E13.m1.2.2.1.1.cmml" xref="S6.E13.m1.2.2.1.1"><apply id="S6.E13.m1.2.2.1.1.2.cmml" xref="S6.E13.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S6.E13.m1.2.2.1.1.2.1.cmml" xref="S6.E13.m1.2.2.1.1.2">subscript</csymbol><sum id="S6.E13.m1.2.2.1.1.2.2.cmml" xref="S6.E13.m1.2.2.1.1.2.2"></sum><apply id="S6.E13.m1.2.2.1.1.2.3.cmml" xref="S6.E13.m1.2.2.1.1.2.3"><in id="S6.E13.m1.2.2.1.1.2.3.1.cmml" xref="S6.E13.m1.2.2.1.1.2.3.1"></in><ci id="S6.E13.m1.2.2.1.1.2.3.2.cmml" xref="S6.E13.m1.2.2.1.1.2.3.2">𝑢</ci><ci id="S6.E13.m1.2.2.1.1.2.3.3.cmml" xref="S6.E13.m1.2.2.1.1.2.3.3">𝒰</ci></apply></apply><apply id="S6.E13.m1.2.2.1.1.1.cmml" xref="S6.E13.m1.2.2.1.1.1"><times id="S6.E13.m1.2.2.1.1.1.2.cmml" xref="S6.E13.m1.2.2.1.1.1.2"></times><cn id="S6.E13.m1.2.2.1.1.1.3.cmml" type="integer" xref="S6.E13.m1.2.2.1.1.1.3">1</cn><apply id="S6.E13.m1.2.2.1.1.1.1.1.1.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1"><leq id="S6.E13.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.2"></leq><apply id="S6.E13.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1"><times id="S6.E13.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.2a.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.2"><mtext id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.2">rank</mtext></ci><ci id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.3a.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.3"><mtext id="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.3.3">correct</mtext></ci></apply><apply id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply><cn id="S6.E13.m1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S6.E13.m1.2.2.1.1.1.1.1.1.3">10</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E13.m1.2c">\text{HR@10}=\frac{1}{|\mathcal{U}|}\sum_{u\in\mathcal{U}}\mathbb{1}\left(%
\text{rank}_{\text{correct}}(v_{u})\leq 10\right)</annotation><annotation encoding="application/x-llamapun" id="S6.E13.m1.2d">HR@10 = divide start_ARG 1 end_ARG start_ARG | caligraphic_U | end_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ caligraphic_U end_POSTSUBSCRIPT blackboard_1 ( rank start_POSTSUBSCRIPT correct end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) ≤ 10 )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.I2.i1.p1.4">where <math alttext="v_{u}" class="ltx_Math" display="inline" id="S6.I2.i1.p1.2.m1.1"><semantics id="S6.I2.i1.p1.2.m1.1a"><msub id="S6.I2.i1.p1.2.m1.1.1" xref="S6.I2.i1.p1.2.m1.1.1.cmml"><mi id="S6.I2.i1.p1.2.m1.1.1.2" xref="S6.I2.i1.p1.2.m1.1.1.2.cmml">v</mi><mi id="S6.I2.i1.p1.2.m1.1.1.3" xref="S6.I2.i1.p1.2.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S6.I2.i1.p1.2.m1.1b"><apply id="S6.I2.i1.p1.2.m1.1.1.cmml" xref="S6.I2.i1.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S6.I2.i1.p1.2.m1.1.1.1.cmml" xref="S6.I2.i1.p1.2.m1.1.1">subscript</csymbol><ci id="S6.I2.i1.p1.2.m1.1.1.2.cmml" xref="S6.I2.i1.p1.2.m1.1.1.2">𝑣</ci><ci id="S6.I2.i1.p1.2.m1.1.1.3.cmml" xref="S6.I2.i1.p1.2.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i1.p1.2.m1.1c">v_{u}</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i1.p1.2.m1.1d">italic_v start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the correct item for user <math alttext="u" class="ltx_Math" display="inline" id="S6.I2.i1.p1.3.m2.1"><semantics id="S6.I2.i1.p1.3.m2.1a"><mi id="S6.I2.i1.p1.3.m2.1.1" xref="S6.I2.i1.p1.3.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S6.I2.i1.p1.3.m2.1b"><ci id="S6.I2.i1.p1.3.m2.1.1.cmml" xref="S6.I2.i1.p1.3.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i1.p1.3.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i1.p1.3.m2.1d">italic_u</annotation></semantics></math> and <math alttext="\mathbb{1}(\cdot)" class="ltx_Math" display="inline" id="S6.I2.i1.p1.4.m3.1"><semantics id="S6.I2.i1.p1.4.m3.1a"><mrow id="S6.I2.i1.p1.4.m3.1.2" xref="S6.I2.i1.p1.4.m3.1.2.cmml"><mn id="S6.I2.i1.p1.4.m3.1.2.2" xref="S6.I2.i1.p1.4.m3.1.2.2.cmml">𝟙</mn><mo id="S6.I2.i1.p1.4.m3.1.2.1" xref="S6.I2.i1.p1.4.m3.1.2.1.cmml">⁢</mo><mrow id="S6.I2.i1.p1.4.m3.1.2.3.2" xref="S6.I2.i1.p1.4.m3.1.2.cmml"><mo id="S6.I2.i1.p1.4.m3.1.2.3.2.1" stretchy="false" xref="S6.I2.i1.p1.4.m3.1.2.cmml">(</mo><mo id="S6.I2.i1.p1.4.m3.1.1" lspace="0em" rspace="0em" xref="S6.I2.i1.p1.4.m3.1.1.cmml">⋅</mo><mo id="S6.I2.i1.p1.4.m3.1.2.3.2.2" stretchy="false" xref="S6.I2.i1.p1.4.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.I2.i1.p1.4.m3.1b"><apply id="S6.I2.i1.p1.4.m3.1.2.cmml" xref="S6.I2.i1.p1.4.m3.1.2"><times id="S6.I2.i1.p1.4.m3.1.2.1.cmml" xref="S6.I2.i1.p1.4.m3.1.2.1"></times><cn id="S6.I2.i1.p1.4.m3.1.2.2.cmml" type="integer" xref="S6.I2.i1.p1.4.m3.1.2.2">1</cn><ci id="S6.I2.i1.p1.4.m3.1.1.cmml" xref="S6.I2.i1.p1.4.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i1.p1.4.m3.1c">\mathbb{1}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i1.p1.4.m3.1d">blackboard_1 ( ⋅ )</annotation></semantics></math> is an indicator function that equals 1 if the condition is true and 0 otherwise.</p>
</div>
</li>
<li class="ltx_item" id="S6.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I2.i2.p1">
<p class="ltx_p" id="S6.I2.i2.p1.7"><span class="ltx_text ltx_font_bold" id="S6.I2.i2.p1.7.1">NDCG@10</span>: NDCG@10 represents Normalized Discounted Cumulative Gain truncated at 10 which evaluates the ranking quality by giving higher importance to items ranked at the top. It is defined as:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S6.E14">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S6.E14X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="S6.E14X.2.1.1.1">IDCG@10</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{k=1}^{10}\frac{2^{\text{rel}^{\ast}(v_{uk})}-1}{\log_{2}(k%
+1)}" class="ltx_Math" display="inline" id="S6.E14X.3.2.2.m1.3"><semantics id="S6.E14X.3.2.2.m1.3a"><mrow id="S6.E14X.3.2.2.m1.3.4" xref="S6.E14X.3.2.2.m1.3.4.cmml"><mi id="S6.E14X.3.2.2.m1.3.4.2" xref="S6.E14X.3.2.2.m1.3.4.2.cmml"></mi><mo id="S6.E14X.3.2.2.m1.3.4.1" xref="S6.E14X.3.2.2.m1.3.4.1.cmml">=</mo><mrow id="S6.E14X.3.2.2.m1.3.4.3" xref="S6.E14X.3.2.2.m1.3.4.3.cmml"><mstyle displaystyle="true" id="S6.E14X.3.2.2.m1.3.4.3.1" xref="S6.E14X.3.2.2.m1.3.4.3.1.cmml"><munderover id="S6.E14X.3.2.2.m1.3.4.3.1a" xref="S6.E14X.3.2.2.m1.3.4.3.1.cmml"><mo id="S6.E14X.3.2.2.m1.3.4.3.1.2.2" movablelimits="false" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.2.cmml">∑</mo><mrow id="S6.E14X.3.2.2.m1.3.4.3.1.2.3" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.3.cmml"><mi id="S6.E14X.3.2.2.m1.3.4.3.1.2.3.2" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.3.2.cmml">k</mi><mo id="S6.E14X.3.2.2.m1.3.4.3.1.2.3.1" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.3.1.cmml">=</mo><mn id="S6.E14X.3.2.2.m1.3.4.3.1.2.3.3" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.3.3.cmml">1</mn></mrow><mn id="S6.E14X.3.2.2.m1.3.4.3.1.3" xref="S6.E14X.3.2.2.m1.3.4.3.1.3.cmml">10</mn></munderover></mstyle><mstyle displaystyle="true" id="S6.E14X.3.2.2.m1.3.3" xref="S6.E14X.3.2.2.m1.3.3.cmml"><mfrac id="S6.E14X.3.2.2.m1.3.3a" xref="S6.E14X.3.2.2.m1.3.3.cmml"><mrow id="S6.E14X.3.2.2.m1.1.1.1" xref="S6.E14X.3.2.2.m1.1.1.1.cmml"><msup id="S6.E14X.3.2.2.m1.1.1.1.3" xref="S6.E14X.3.2.2.m1.1.1.1.3.cmml"><mn id="S6.E14X.3.2.2.m1.1.1.1.3.2" xref="S6.E14X.3.2.2.m1.1.1.1.3.2.cmml">2</mn><mrow id="S6.E14X.3.2.2.m1.1.1.1.1.1" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.cmml"><msup id="S6.E14X.3.2.2.m1.1.1.1.1.1.3" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.3.cmml"><mtext id="S6.E14X.3.2.2.m1.1.1.1.1.1.3.2" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.3.2a.cmml">rel</mtext><mo id="S6.E14X.3.2.2.m1.1.1.1.1.1.3.3" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.3.3.cmml">∗</mo></msup><mo id="S6.E14X.3.2.2.m1.1.1.1.1.1.2" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mrow id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml">u</mi><mo id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo id="S6.E14X.3.2.2.m1.1.1.1.2" xref="S6.E14X.3.2.2.m1.1.1.1.2.cmml">−</mo><mn id="S6.E14X.3.2.2.m1.1.1.1.4" xref="S6.E14X.3.2.2.m1.1.1.1.4.cmml">1</mn></mrow><mrow id="S6.E14X.3.2.2.m1.3.3.3.2" xref="S6.E14X.3.2.2.m1.3.3.3.3.cmml"><msub id="S6.E14X.3.2.2.m1.2.2.2.1.1" xref="S6.E14X.3.2.2.m1.2.2.2.1.1.cmml"><mi id="S6.E14X.3.2.2.m1.2.2.2.1.1.2" xref="S6.E14X.3.2.2.m1.2.2.2.1.1.2.cmml">log</mi><mn id="S6.E14X.3.2.2.m1.2.2.2.1.1.3" xref="S6.E14X.3.2.2.m1.2.2.2.1.1.3.cmml">2</mn></msub><mo id="S6.E14X.3.2.2.m1.3.3.3.2a" xref="S6.E14X.3.2.2.m1.3.3.3.3.cmml">⁡</mo><mrow id="S6.E14X.3.2.2.m1.3.3.3.2.2" xref="S6.E14X.3.2.2.m1.3.3.3.3.cmml"><mo id="S6.E14X.3.2.2.m1.3.3.3.2.2.2" stretchy="false" xref="S6.E14X.3.2.2.m1.3.3.3.3.cmml">(</mo><mrow id="S6.E14X.3.2.2.m1.3.3.3.2.2.1" xref="S6.E14X.3.2.2.m1.3.3.3.2.2.1.cmml"><mi id="S6.E14X.3.2.2.m1.3.3.3.2.2.1.2" xref="S6.E14X.3.2.2.m1.3.3.3.2.2.1.2.cmml">k</mi><mo id="S6.E14X.3.2.2.m1.3.3.3.2.2.1.1" xref="S6.E14X.3.2.2.m1.3.3.3.2.2.1.1.cmml">+</mo><mn id="S6.E14X.3.2.2.m1.3.3.3.2.2.1.3" xref="S6.E14X.3.2.2.m1.3.3.3.2.2.1.3.cmml">1</mn></mrow><mo id="S6.E14X.3.2.2.m1.3.3.3.2.2.3" stretchy="false" xref="S6.E14X.3.2.2.m1.3.3.3.3.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E14X.3.2.2.m1.3b"><apply id="S6.E14X.3.2.2.m1.3.4.cmml" xref="S6.E14X.3.2.2.m1.3.4"><eq id="S6.E14X.3.2.2.m1.3.4.1.cmml" xref="S6.E14X.3.2.2.m1.3.4.1"></eq><csymbol cd="latexml" id="S6.E14X.3.2.2.m1.3.4.2.cmml" xref="S6.E14X.3.2.2.m1.3.4.2">absent</csymbol><apply id="S6.E14X.3.2.2.m1.3.4.3.cmml" xref="S6.E14X.3.2.2.m1.3.4.3"><apply id="S6.E14X.3.2.2.m1.3.4.3.1.cmml" xref="S6.E14X.3.2.2.m1.3.4.3.1"><csymbol cd="ambiguous" id="S6.E14X.3.2.2.m1.3.4.3.1.1.cmml" xref="S6.E14X.3.2.2.m1.3.4.3.1">superscript</csymbol><apply id="S6.E14X.3.2.2.m1.3.4.3.1.2.cmml" xref="S6.E14X.3.2.2.m1.3.4.3.1"><csymbol cd="ambiguous" id="S6.E14X.3.2.2.m1.3.4.3.1.2.1.cmml" xref="S6.E14X.3.2.2.m1.3.4.3.1">subscript</csymbol><sum id="S6.E14X.3.2.2.m1.3.4.3.1.2.2.cmml" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.2"></sum><apply id="S6.E14X.3.2.2.m1.3.4.3.1.2.3.cmml" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.3"><eq id="S6.E14X.3.2.2.m1.3.4.3.1.2.3.1.cmml" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.3.1"></eq><ci id="S6.E14X.3.2.2.m1.3.4.3.1.2.3.2.cmml" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.3.2">𝑘</ci><cn id="S6.E14X.3.2.2.m1.3.4.3.1.2.3.3.cmml" type="integer" xref="S6.E14X.3.2.2.m1.3.4.3.1.2.3.3">1</cn></apply></apply><cn id="S6.E14X.3.2.2.m1.3.4.3.1.3.cmml" type="integer" xref="S6.E14X.3.2.2.m1.3.4.3.1.3">10</cn></apply><apply id="S6.E14X.3.2.2.m1.3.3.cmml" xref="S6.E14X.3.2.2.m1.3.3"><divide id="S6.E14X.3.2.2.m1.3.3.4.cmml" xref="S6.E14X.3.2.2.m1.3.3"></divide><apply id="S6.E14X.3.2.2.m1.1.1.1.cmml" xref="S6.E14X.3.2.2.m1.1.1.1"><minus id="S6.E14X.3.2.2.m1.1.1.1.2.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.2"></minus><apply id="S6.E14X.3.2.2.m1.1.1.1.3.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E14X.3.2.2.m1.1.1.1.3.1.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.3">superscript</csymbol><cn id="S6.E14X.3.2.2.m1.1.1.1.3.2.cmml" type="integer" xref="S6.E14X.3.2.2.m1.1.1.1.3.2">2</cn><apply id="S6.E14X.3.2.2.m1.1.1.1.1.1.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1"><times id="S6.E14X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.2"></times><apply id="S6.E14X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.E14X.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S6.E14X.3.2.2.m1.1.1.1.1.1.3.2a.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.3.2"><mtext id="S6.E14X.3.2.2.m1.1.1.1.1.1.3.2.cmml" mathsize="70%" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.3.2">rel</mtext></ci><ci id="S6.E14X.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.3.3">∗</ci></apply><apply id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.2">𝑣</ci><apply id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3"><times id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.2">𝑢</ci><ci id="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S6.E14X.3.2.2.m1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply><cn id="S6.E14X.3.2.2.m1.1.1.1.4.cmml" type="integer" xref="S6.E14X.3.2.2.m1.1.1.1.4">1</cn></apply><apply id="S6.E14X.3.2.2.m1.3.3.3.3.cmml" xref="S6.E14X.3.2.2.m1.3.3.3.2"><apply id="S6.E14X.3.2.2.m1.2.2.2.1.1.cmml" xref="S6.E14X.3.2.2.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S6.E14X.3.2.2.m1.2.2.2.1.1.1.cmml" xref="S6.E14X.3.2.2.m1.2.2.2.1.1">subscript</csymbol><log id="S6.E14X.3.2.2.m1.2.2.2.1.1.2.cmml" xref="S6.E14X.3.2.2.m1.2.2.2.1.1.2"></log><cn id="S6.E14X.3.2.2.m1.2.2.2.1.1.3.cmml" type="integer" xref="S6.E14X.3.2.2.m1.2.2.2.1.1.3">2</cn></apply><apply id="S6.E14X.3.2.2.m1.3.3.3.2.2.1.cmml" xref="S6.E14X.3.2.2.m1.3.3.3.2.2.1"><plus id="S6.E14X.3.2.2.m1.3.3.3.2.2.1.1.cmml" xref="S6.E14X.3.2.2.m1.3.3.3.2.2.1.1"></plus><ci id="S6.E14X.3.2.2.m1.3.3.3.2.2.1.2.cmml" xref="S6.E14X.3.2.2.m1.3.3.3.2.2.1.2">𝑘</ci><cn id="S6.E14X.3.2.2.m1.3.3.3.2.2.1.3.cmml" type="integer" xref="S6.E14X.3.2.2.m1.3.3.3.2.2.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E14X.3.2.2.m1.3c">\displaystyle=\sum_{k=1}^{10}\frac{2^{\text{rel}^{\ast}(v_{uk})}-1}{\log_{2}(k%
+1)}</annotation><annotation encoding="application/x-llamapun" id="S6.E14X.3.2.2.m1.3d">= ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT divide start_ARG 2 start_POSTSUPERSCRIPT rel start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_v start_POSTSUBSCRIPT italic_u italic_k end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT - 1 end_ARG start_ARG roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_k + 1 ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S6.E14Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><span class="ltx_text ltx_markedasmath ltx_font_italic" id="S6.E14Xa.2.1.1.1">NDCG@10</span></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\frac{1}{|\mathcal{U}|}\sum_{u\in\mathcal{U}}\frac{1}{\text{IDCG%
@10}(v_{u})}\sum_{k=1}^{10}\frac{2^{\text{rel}(v_{uk})}-1}{\log_{2}(k+1)}" class="ltx_Math" display="inline" id="S6.E14Xa.3.2.2.m1.5"><semantics id="S6.E14Xa.3.2.2.m1.5a"><mrow id="S6.E14Xa.3.2.2.m1.5.6" xref="S6.E14Xa.3.2.2.m1.5.6.cmml"><mi id="S6.E14Xa.3.2.2.m1.5.6.2" xref="S6.E14Xa.3.2.2.m1.5.6.2.cmml"></mi><mo id="S6.E14Xa.3.2.2.m1.5.6.1" xref="S6.E14Xa.3.2.2.m1.5.6.1.cmml">=</mo><mrow id="S6.E14Xa.3.2.2.m1.5.6.3" xref="S6.E14Xa.3.2.2.m1.5.6.3.cmml"><mstyle displaystyle="true" id="S6.E14Xa.3.2.2.m1.1.1" xref="S6.E14Xa.3.2.2.m1.1.1.cmml"><mfrac id="S6.E14Xa.3.2.2.m1.1.1a" xref="S6.E14Xa.3.2.2.m1.1.1.cmml"><mn id="S6.E14Xa.3.2.2.m1.1.1.3" xref="S6.E14Xa.3.2.2.m1.1.1.3.cmml">1</mn><mrow id="S6.E14Xa.3.2.2.m1.1.1.1.3" xref="S6.E14Xa.3.2.2.m1.1.1.1.2.cmml"><mo id="S6.E14Xa.3.2.2.m1.1.1.1.3.1" stretchy="false" xref="S6.E14Xa.3.2.2.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S6.E14Xa.3.2.2.m1.1.1.1.1" xref="S6.E14Xa.3.2.2.m1.1.1.1.1.cmml">𝒰</mi><mo id="S6.E14Xa.3.2.2.m1.1.1.1.3.2" stretchy="false" xref="S6.E14Xa.3.2.2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo id="S6.E14Xa.3.2.2.m1.5.6.3.1" xref="S6.E14Xa.3.2.2.m1.5.6.3.1.cmml">⁢</mo><mrow id="S6.E14Xa.3.2.2.m1.5.6.3.2" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.cmml"><mstyle displaystyle="true" id="S6.E14Xa.3.2.2.m1.5.6.3.2.1" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.cmml"><munder id="S6.E14Xa.3.2.2.m1.5.6.3.2.1a" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.cmml"><mo id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.2" movablelimits="false" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.2.cmml">∑</mo><mrow id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.cmml"><mi id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.2" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.2.cmml">u</mi><mo id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.1" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.3" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.3.cmml">𝒰</mi></mrow></munder></mstyle><mrow id="S6.E14Xa.3.2.2.m1.5.6.3.2.2" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.cmml"><mstyle displaystyle="true" id="S6.E14Xa.3.2.2.m1.2.2" xref="S6.E14Xa.3.2.2.m1.2.2.cmml"><mfrac id="S6.E14Xa.3.2.2.m1.2.2a" xref="S6.E14Xa.3.2.2.m1.2.2.cmml"><mn id="S6.E14Xa.3.2.2.m1.2.2.3" xref="S6.E14Xa.3.2.2.m1.2.2.3.cmml">1</mn><mrow id="S6.E14Xa.3.2.2.m1.2.2.1" xref="S6.E14Xa.3.2.2.m1.2.2.1.cmml"><mtext id="S6.E14Xa.3.2.2.m1.2.2.1.3" xref="S6.E14Xa.3.2.2.m1.2.2.1.3a.cmml">IDCG@10</mtext><mo id="S6.E14Xa.3.2.2.m1.2.2.1.2" xref="S6.E14Xa.3.2.2.m1.2.2.1.2.cmml">⁢</mo><mrow id="S6.E14Xa.3.2.2.m1.2.2.1.1.1" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.cmml"><mo id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.2" stretchy="false" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.cmml"><mi id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.2" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml">v</mi><mi id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.3" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml">u</mi></msub><mo id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.3" stretchy="false" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle><mo id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.1" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.1.cmml">⁢</mo><mrow id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.cmml"><mstyle displaystyle="true" id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.cmml"><munderover id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1a" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.cmml"><mo id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.2" movablelimits="false" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.2.cmml">∑</mo><mrow id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.cmml"><mi id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.2" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.2.cmml">k</mi><mo id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.1" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.1.cmml">=</mo><mn id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.3" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.3.cmml">1</mn></mrow><mn id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.3" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.3.cmml">10</mn></munderover></mstyle><mstyle displaystyle="true" id="S6.E14Xa.3.2.2.m1.5.5" xref="S6.E14Xa.3.2.2.m1.5.5.cmml"><mfrac id="S6.E14Xa.3.2.2.m1.5.5a" xref="S6.E14Xa.3.2.2.m1.5.5.cmml"><mrow id="S6.E14Xa.3.2.2.m1.3.3.1" xref="S6.E14Xa.3.2.2.m1.3.3.1.cmml"><msup id="S6.E14Xa.3.2.2.m1.3.3.1.3" xref="S6.E14Xa.3.2.2.m1.3.3.1.3.cmml"><mn id="S6.E14Xa.3.2.2.m1.3.3.1.3.2" xref="S6.E14Xa.3.2.2.m1.3.3.1.3.2.cmml">2</mn><mrow id="S6.E14Xa.3.2.2.m1.3.3.1.1.1" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.cmml"><mtext id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.3" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.3a.cmml">rel</mtext><mo id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.2" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">v</mi><mrow id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.cmml">u</mi><mo id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo id="S6.E14Xa.3.2.2.m1.3.3.1.2" xref="S6.E14Xa.3.2.2.m1.3.3.1.2.cmml">−</mo><mn id="S6.E14Xa.3.2.2.m1.3.3.1.4" xref="S6.E14Xa.3.2.2.m1.3.3.1.4.cmml">1</mn></mrow><mrow id="S6.E14Xa.3.2.2.m1.5.5.3.2" xref="S6.E14Xa.3.2.2.m1.5.5.3.3.cmml"><msub id="S6.E14Xa.3.2.2.m1.4.4.2.1.1" xref="S6.E14Xa.3.2.2.m1.4.4.2.1.1.cmml"><mi id="S6.E14Xa.3.2.2.m1.4.4.2.1.1.2" xref="S6.E14Xa.3.2.2.m1.4.4.2.1.1.2.cmml">log</mi><mn id="S6.E14Xa.3.2.2.m1.4.4.2.1.1.3" xref="S6.E14Xa.3.2.2.m1.4.4.2.1.1.3.cmml">2</mn></msub><mo id="S6.E14Xa.3.2.2.m1.5.5.3.2a" xref="S6.E14Xa.3.2.2.m1.5.5.3.3.cmml">⁡</mo><mrow id="S6.E14Xa.3.2.2.m1.5.5.3.2.2" xref="S6.E14Xa.3.2.2.m1.5.5.3.3.cmml"><mo id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.2" stretchy="false" xref="S6.E14Xa.3.2.2.m1.5.5.3.3.cmml">(</mo><mrow id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1" xref="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.cmml"><mi id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.2" xref="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.2.cmml">k</mi><mo id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.1" xref="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.1.cmml">+</mo><mn id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.3" xref="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.3.cmml">1</mn></mrow><mo id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.3" stretchy="false" xref="S6.E14Xa.3.2.2.m1.5.5.3.3.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E14Xa.3.2.2.m1.5b"><apply id="S6.E14Xa.3.2.2.m1.5.6.cmml" xref="S6.E14Xa.3.2.2.m1.5.6"><eq id="S6.E14Xa.3.2.2.m1.5.6.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.1"></eq><csymbol cd="latexml" id="S6.E14Xa.3.2.2.m1.5.6.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.2">absent</csymbol><apply id="S6.E14Xa.3.2.2.m1.5.6.3.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3"><times id="S6.E14Xa.3.2.2.m1.5.6.3.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.1"></times><apply id="S6.E14Xa.3.2.2.m1.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.1.1"><divide id="S6.E14Xa.3.2.2.m1.1.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.1.1"></divide><cn id="S6.E14Xa.3.2.2.m1.1.1.3.cmml" type="integer" xref="S6.E14Xa.3.2.2.m1.1.1.3">1</cn><apply id="S6.E14Xa.3.2.2.m1.1.1.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.1.1.1.3"><abs id="S6.E14Xa.3.2.2.m1.1.1.1.2.1.cmml" xref="S6.E14Xa.3.2.2.m1.1.1.1.3.1"></abs><ci id="S6.E14Xa.3.2.2.m1.1.1.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.1.1.1.1">𝒰</ci></apply></apply><apply id="S6.E14Xa.3.2.2.m1.5.6.3.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2"><apply id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1"><csymbol cd="ambiguous" id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1">subscript</csymbol><sum id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.2"></sum><apply id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3"><in id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.1"></in><ci id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.2">𝑢</ci><ci id="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.3.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.1.3.3">𝒰</ci></apply></apply><apply id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2"><times id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.1"></times><apply id="S6.E14Xa.3.2.2.m1.2.2.cmml" xref="S6.E14Xa.3.2.2.m1.2.2"><divide id="S6.E14Xa.3.2.2.m1.2.2.2.cmml" xref="S6.E14Xa.3.2.2.m1.2.2"></divide><cn id="S6.E14Xa.3.2.2.m1.2.2.3.cmml" type="integer" xref="S6.E14Xa.3.2.2.m1.2.2.3">1</cn><apply id="S6.E14Xa.3.2.2.m1.2.2.1.cmml" xref="S6.E14Xa.3.2.2.m1.2.2.1"><times id="S6.E14Xa.3.2.2.m1.2.2.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.2.2.1.2"></times><ci id="S6.E14Xa.3.2.2.m1.2.2.1.3a.cmml" xref="S6.E14Xa.3.2.2.m1.2.2.1.3"><mtext id="S6.E14Xa.3.2.2.m1.2.2.1.3.cmml" xref="S6.E14Xa.3.2.2.m1.2.2.1.3">IDCG@10</mtext></ci><apply id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1">subscript</csymbol><ci id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.2">𝑣</ci><ci id="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S6.E14Xa.3.2.2.m1.2.2.1.1.1.1.3">𝑢</ci></apply></apply></apply><apply id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2"><apply id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1"><csymbol cd="ambiguous" id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1">superscript</csymbol><apply id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1"><csymbol cd="ambiguous" id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1">subscript</csymbol><sum id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.2"></sum><apply id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3"><eq id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.1"></eq><ci id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.2">𝑘</ci><cn id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.3.cmml" type="integer" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.2.3.3">1</cn></apply></apply><cn id="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.3.cmml" type="integer" xref="S6.E14Xa.3.2.2.m1.5.6.3.2.2.2.1.3">10</cn></apply><apply id="S6.E14Xa.3.2.2.m1.5.5.cmml" xref="S6.E14Xa.3.2.2.m1.5.5"><divide id="S6.E14Xa.3.2.2.m1.5.5.4.cmml" xref="S6.E14Xa.3.2.2.m1.5.5"></divide><apply id="S6.E14Xa.3.2.2.m1.3.3.1.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1"><minus id="S6.E14Xa.3.2.2.m1.3.3.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.2"></minus><apply id="S6.E14Xa.3.2.2.m1.3.3.1.3.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.3"><csymbol cd="ambiguous" id="S6.E14Xa.3.2.2.m1.3.3.1.3.1.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.3">superscript</csymbol><cn id="S6.E14Xa.3.2.2.m1.3.3.1.3.2.cmml" type="integer" xref="S6.E14Xa.3.2.2.m1.3.3.1.3.2">2</cn><apply id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1"><times id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.2"></times><ci id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.3a.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.3"><mtext id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.3.cmml" mathsize="70%" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.3">rel</mtext></ci><apply id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2">𝑣</ci><apply id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3"><times id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.1"></times><ci id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.2">𝑢</ci><ci id="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S6.E14Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply><cn id="S6.E14Xa.3.2.2.m1.3.3.1.4.cmml" type="integer" xref="S6.E14Xa.3.2.2.m1.3.3.1.4">1</cn></apply><apply id="S6.E14Xa.3.2.2.m1.5.5.3.3.cmml" xref="S6.E14Xa.3.2.2.m1.5.5.3.2"><apply id="S6.E14Xa.3.2.2.m1.4.4.2.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.4.4.2.1.1"><csymbol cd="ambiguous" id="S6.E14Xa.3.2.2.m1.4.4.2.1.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.4.4.2.1.1">subscript</csymbol><log id="S6.E14Xa.3.2.2.m1.4.4.2.1.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.4.4.2.1.1.2"></log><cn id="S6.E14Xa.3.2.2.m1.4.4.2.1.1.3.cmml" type="integer" xref="S6.E14Xa.3.2.2.m1.4.4.2.1.1.3">2</cn></apply><apply id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1"><plus id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.1.cmml" xref="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.1"></plus><ci id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.2.cmml" xref="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.2">𝑘</ci><cn id="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.3.cmml" type="integer" xref="S6.E14Xa.3.2.2.m1.5.5.3.2.2.1.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E14Xa.3.2.2.m1.5c">\displaystyle=\frac{1}{|\mathcal{U}|}\sum_{u\in\mathcal{U}}\frac{1}{\text{IDCG%
@10}(v_{u})}\sum_{k=1}^{10}\frac{2^{\text{rel}(v_{uk})}-1}{\log_{2}(k+1)}</annotation><annotation encoding="application/x-llamapun" id="S6.E14Xa.3.2.2.m1.5d">= divide start_ARG 1 end_ARG start_ARG | caligraphic_U | end_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ caligraphic_U end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG IDCG@10 ( italic_v start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 10 end_POSTSUPERSCRIPT divide start_ARG 2 start_POSTSUPERSCRIPT rel ( italic_v start_POSTSUBSCRIPT italic_u italic_k end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT - 1 end_ARG start_ARG roman_log start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_k + 1 ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S6.I2.i2.p1.6">where <math alttext="\text{rel}(v_{uk})" class="ltx_Math" display="inline" id="S6.I2.i2.p1.1.m1.1"><semantics id="S6.I2.i2.p1.1.m1.1a"><mrow id="S6.I2.i2.p1.1.m1.1.1" xref="S6.I2.i2.p1.1.m1.1.1.cmml"><mtext id="S6.I2.i2.p1.1.m1.1.1.3" xref="S6.I2.i2.p1.1.m1.1.1.3a.cmml">rel</mtext><mo id="S6.I2.i2.p1.1.m1.1.1.2" xref="S6.I2.i2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S6.I2.i2.p1.1.m1.1.1.1.1" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S6.I2.i2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S6.I2.i2.p1.1.m1.1.1.1.1.1" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S6.I2.i2.p1.1.m1.1.1.1.1.1.2" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.2.cmml">v</mi><mrow id="S6.I2.i2.p1.1.m1.1.1.1.1.1.3" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.cmml"><mi id="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.2" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.2.cmml">u</mi><mo id="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.1" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.3" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S6.I2.i2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.I2.i2.p1.1.m1.1b"><apply id="S6.I2.i2.p1.1.m1.1.1.cmml" xref="S6.I2.i2.p1.1.m1.1.1"><times id="S6.I2.i2.p1.1.m1.1.1.2.cmml" xref="S6.I2.i2.p1.1.m1.1.1.2"></times><ci id="S6.I2.i2.p1.1.m1.1.1.3a.cmml" xref="S6.I2.i2.p1.1.m1.1.1.3"><mtext id="S6.I2.i2.p1.1.m1.1.1.3.cmml" xref="S6.I2.i2.p1.1.m1.1.1.3">rel</mtext></ci><apply id="S6.I2.i2.p1.1.m1.1.1.1.1.1.cmml" xref="S6.I2.i2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S6.I2.i2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S6.I2.i2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S6.I2.i2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.2">𝑣</ci><apply id="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.3"><times id="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.1.cmml" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.1"></times><ci id="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.2.cmml" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.2">𝑢</ci><ci id="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.3.cmml" xref="S6.I2.i2.p1.1.m1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i2.p1.1.m1.1c">\text{rel}(v_{uk})</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i2.p1.1.m1.1d">rel ( italic_v start_POSTSUBSCRIPT italic_u italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> represents the relevance score of item <math alttext="v_{uk}" class="ltx_Math" display="inline" id="S6.I2.i2.p1.2.m2.1"><semantics id="S6.I2.i2.p1.2.m2.1a"><msub id="S6.I2.i2.p1.2.m2.1.1" xref="S6.I2.i2.p1.2.m2.1.1.cmml"><mi id="S6.I2.i2.p1.2.m2.1.1.2" xref="S6.I2.i2.p1.2.m2.1.1.2.cmml">v</mi><mrow id="S6.I2.i2.p1.2.m2.1.1.3" xref="S6.I2.i2.p1.2.m2.1.1.3.cmml"><mi id="S6.I2.i2.p1.2.m2.1.1.3.2" xref="S6.I2.i2.p1.2.m2.1.1.3.2.cmml">u</mi><mo id="S6.I2.i2.p1.2.m2.1.1.3.1" xref="S6.I2.i2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S6.I2.i2.p1.2.m2.1.1.3.3" xref="S6.I2.i2.p1.2.m2.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S6.I2.i2.p1.2.m2.1b"><apply id="S6.I2.i2.p1.2.m2.1.1.cmml" xref="S6.I2.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S6.I2.i2.p1.2.m2.1.1.1.cmml" xref="S6.I2.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S6.I2.i2.p1.2.m2.1.1.2.cmml" xref="S6.I2.i2.p1.2.m2.1.1.2">𝑣</ci><apply id="S6.I2.i2.p1.2.m2.1.1.3.cmml" xref="S6.I2.i2.p1.2.m2.1.1.3"><times id="S6.I2.i2.p1.2.m2.1.1.3.1.cmml" xref="S6.I2.i2.p1.2.m2.1.1.3.1"></times><ci id="S6.I2.i2.p1.2.m2.1.1.3.2.cmml" xref="S6.I2.i2.p1.2.m2.1.1.3.2">𝑢</ci><ci id="S6.I2.i2.p1.2.m2.1.1.3.3.cmml" xref="S6.I2.i2.p1.2.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i2.p1.2.m2.1c">v_{uk}</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i2.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_u italic_k end_POSTSUBSCRIPT</annotation></semantics></math> for user <math alttext="u" class="ltx_Math" display="inline" id="S6.I2.i2.p1.3.m3.1"><semantics id="S6.I2.i2.p1.3.m3.1a"><mi id="S6.I2.i2.p1.3.m3.1.1" xref="S6.I2.i2.p1.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S6.I2.i2.p1.3.m3.1b"><ci id="S6.I2.i2.p1.3.m3.1.1.cmml" xref="S6.I2.i2.p1.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i2.p1.3.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i2.p1.3.m3.1d">italic_u</annotation></semantics></math>, <math alttext="\text{rel}^{*}(v_{uk})" class="ltx_Math" display="inline" id="S6.I2.i2.p1.4.m4.1"><semantics id="S6.I2.i2.p1.4.m4.1a"><mrow id="S6.I2.i2.p1.4.m4.1.1" xref="S6.I2.i2.p1.4.m4.1.1.cmml"><msup id="S6.I2.i2.p1.4.m4.1.1.3" xref="S6.I2.i2.p1.4.m4.1.1.3.cmml"><mtext id="S6.I2.i2.p1.4.m4.1.1.3.2" xref="S6.I2.i2.p1.4.m4.1.1.3.2a.cmml">rel</mtext><mo id="S6.I2.i2.p1.4.m4.1.1.3.3" xref="S6.I2.i2.p1.4.m4.1.1.3.3.cmml">∗</mo></msup><mo id="S6.I2.i2.p1.4.m4.1.1.2" xref="S6.I2.i2.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="S6.I2.i2.p1.4.m4.1.1.1.1" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.cmml"><mo id="S6.I2.i2.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S6.I2.i2.p1.4.m4.1.1.1.1.1" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S6.I2.i2.p1.4.m4.1.1.1.1.1.2" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.2.cmml">v</mi><mrow id="S6.I2.i2.p1.4.m4.1.1.1.1.1.3" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.2" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.2.cmml">u</mi><mo id="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.1" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.3" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S6.I2.i2.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.I2.i2.p1.4.m4.1b"><apply id="S6.I2.i2.p1.4.m4.1.1.cmml" xref="S6.I2.i2.p1.4.m4.1.1"><times id="S6.I2.i2.p1.4.m4.1.1.2.cmml" xref="S6.I2.i2.p1.4.m4.1.1.2"></times><apply id="S6.I2.i2.p1.4.m4.1.1.3.cmml" xref="S6.I2.i2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S6.I2.i2.p1.4.m4.1.1.3.1.cmml" xref="S6.I2.i2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S6.I2.i2.p1.4.m4.1.1.3.2a.cmml" xref="S6.I2.i2.p1.4.m4.1.1.3.2"><mtext id="S6.I2.i2.p1.4.m4.1.1.3.2.cmml" xref="S6.I2.i2.p1.4.m4.1.1.3.2">rel</mtext></ci><times id="S6.I2.i2.p1.4.m4.1.1.3.3.cmml" xref="S6.I2.i2.p1.4.m4.1.1.3.3"></times></apply><apply id="S6.I2.i2.p1.4.m4.1.1.1.1.1.cmml" xref="S6.I2.i2.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S6.I2.i2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S6.I2.i2.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S6.I2.i2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.2">𝑣</ci><apply id="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.cmml" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.3"><times id="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.1"></times><ci id="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.2">𝑢</ci><ci id="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S6.I2.i2.p1.4.m4.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i2.p1.4.m4.1c">\text{rel}^{*}(v_{uk})</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i2.p1.4.m4.1d">rel start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_v start_POSTSUBSCRIPT italic_u italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> represents the ideal relevance score of the k-th item in the list, assuming that the most relevant items are ranked highest. And <math alttext="\text{IDCG@10}(v_{u})" class="ltx_Math" display="inline" id="S6.I2.i2.p1.5.m5.1"><semantics id="S6.I2.i2.p1.5.m5.1a"><mrow id="S6.I2.i2.p1.5.m5.1.1" xref="S6.I2.i2.p1.5.m5.1.1.cmml"><mtext id="S6.I2.i2.p1.5.m5.1.1.3" xref="S6.I2.i2.p1.5.m5.1.1.3a.cmml">IDCG@10</mtext><mo id="S6.I2.i2.p1.5.m5.1.1.2" xref="S6.I2.i2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S6.I2.i2.p1.5.m5.1.1.1.1" xref="S6.I2.i2.p1.5.m5.1.1.1.1.1.cmml"><mo id="S6.I2.i2.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S6.I2.i2.p1.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S6.I2.i2.p1.5.m5.1.1.1.1.1" xref="S6.I2.i2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S6.I2.i2.p1.5.m5.1.1.1.1.1.2" xref="S6.I2.i2.p1.5.m5.1.1.1.1.1.2.cmml">v</mi><mi id="S6.I2.i2.p1.5.m5.1.1.1.1.1.3" xref="S6.I2.i2.p1.5.m5.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S6.I2.i2.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S6.I2.i2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.I2.i2.p1.5.m5.1b"><apply id="S6.I2.i2.p1.5.m5.1.1.cmml" xref="S6.I2.i2.p1.5.m5.1.1"><times id="S6.I2.i2.p1.5.m5.1.1.2.cmml" xref="S6.I2.i2.p1.5.m5.1.1.2"></times><ci id="S6.I2.i2.p1.5.m5.1.1.3a.cmml" xref="S6.I2.i2.p1.5.m5.1.1.3"><mtext id="S6.I2.i2.p1.5.m5.1.1.3.cmml" xref="S6.I2.i2.p1.5.m5.1.1.3">IDCG@10</mtext></ci><apply id="S6.I2.i2.p1.5.m5.1.1.1.1.1.cmml" xref="S6.I2.i2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S6.I2.i2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S6.I2.i2.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S6.I2.i2.p1.5.m5.1.1.1.1.1.2.cmml" xref="S6.I2.i2.p1.5.m5.1.1.1.1.1.2">𝑣</ci><ci id="S6.I2.i2.p1.5.m5.1.1.1.1.1.3.cmml" xref="S6.I2.i2.p1.5.m5.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i2.p1.5.m5.1c">\text{IDCG@10}(v_{u})</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i2.p1.5.m5.1d">IDCG@10 ( italic_v start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT )</annotation></semantics></math> is the ideal DCG, which is the maximum possible DCG@10 for the correct item <math alttext="v_{u}" class="ltx_Math" display="inline" id="S6.I2.i2.p1.6.m6.1"><semantics id="S6.I2.i2.p1.6.m6.1a"><msub id="S6.I2.i2.p1.6.m6.1.1" xref="S6.I2.i2.p1.6.m6.1.1.cmml"><mi id="S6.I2.i2.p1.6.m6.1.1.2" xref="S6.I2.i2.p1.6.m6.1.1.2.cmml">v</mi><mi id="S6.I2.i2.p1.6.m6.1.1.3" xref="S6.I2.i2.p1.6.m6.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S6.I2.i2.p1.6.m6.1b"><apply id="S6.I2.i2.p1.6.m6.1.1.cmml" xref="S6.I2.i2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S6.I2.i2.p1.6.m6.1.1.1.cmml" xref="S6.I2.i2.p1.6.m6.1.1">subscript</csymbol><ci id="S6.I2.i2.p1.6.m6.1.1.2.cmml" xref="S6.I2.i2.p1.6.m6.1.1.2">𝑣</ci><ci id="S6.I2.i2.p1.6.m6.1.1.3.cmml" xref="S6.I2.i2.p1.6.m6.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i2.p1.6.m6.1c">v_{u}</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i2.p1.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S6.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I2.i3.p1">
<p class="ltx_p" id="S6.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I2.i3.p1.1.1">MRR@10</span>: MRR@10 represents Mean Reciprocal Rank truncated at 10, which measures the average rank position of the first relevant item. For user <math alttext="u" class="ltx_Math" display="inline" id="S6.I2.i3.p1.1.m1.1"><semantics id="S6.I2.i3.p1.1.m1.1a"><mi id="S6.I2.i3.p1.1.m1.1.1" xref="S6.I2.i3.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S6.I2.i3.p1.1.m1.1b"><ci id="S6.I2.i3.p1.1.m1.1.1.cmml" xref="S6.I2.i3.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i3.p1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i3.p1.1.m1.1d">italic_u</annotation></semantics></math>, it is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S6.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MRR@10}=\frac{1}{|\mathcal{U}|}\sum_{u\in\mathcal{U}}\frac{1}{\text{rank%
}_{\text{correct}}(v_{u})}" class="ltx_Math" display="block" id="S6.E15.m1.2"><semantics id="S6.E15.m1.2a"><mrow id="S6.E15.m1.2.3" xref="S6.E15.m1.2.3.cmml"><mtext id="S6.E15.m1.2.3.2" xref="S6.E15.m1.2.3.2a.cmml">MRR@10</mtext><mo id="S6.E15.m1.2.3.1" xref="S6.E15.m1.2.3.1.cmml">=</mo><mrow id="S6.E15.m1.2.3.3" xref="S6.E15.m1.2.3.3.cmml"><mfrac id="S6.E15.m1.1.1" xref="S6.E15.m1.1.1.cmml"><mn id="S6.E15.m1.1.1.3" xref="S6.E15.m1.1.1.3.cmml">1</mn><mrow id="S6.E15.m1.1.1.1.3" xref="S6.E15.m1.1.1.1.2.cmml"><mo id="S6.E15.m1.1.1.1.3.1" stretchy="false" xref="S6.E15.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S6.E15.m1.1.1.1.1" xref="S6.E15.m1.1.1.1.1.cmml">𝒰</mi><mo id="S6.E15.m1.1.1.1.3.2" stretchy="false" xref="S6.E15.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S6.E15.m1.2.3.3.1" xref="S6.E15.m1.2.3.3.1.cmml">⁢</mo><mrow id="S6.E15.m1.2.3.3.2" xref="S6.E15.m1.2.3.3.2.cmml"><munder id="S6.E15.m1.2.3.3.2.1" xref="S6.E15.m1.2.3.3.2.1.cmml"><mo id="S6.E15.m1.2.3.3.2.1.2" movablelimits="false" xref="S6.E15.m1.2.3.3.2.1.2.cmml">∑</mo><mrow id="S6.E15.m1.2.3.3.2.1.3" xref="S6.E15.m1.2.3.3.2.1.3.cmml"><mi id="S6.E15.m1.2.3.3.2.1.3.2" xref="S6.E15.m1.2.3.3.2.1.3.2.cmml">u</mi><mo id="S6.E15.m1.2.3.3.2.1.3.1" xref="S6.E15.m1.2.3.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S6.E15.m1.2.3.3.2.1.3.3" xref="S6.E15.m1.2.3.3.2.1.3.3.cmml">𝒰</mi></mrow></munder><mfrac id="S6.E15.m1.2.2" xref="S6.E15.m1.2.2.cmml"><mn id="S6.E15.m1.2.2.3" xref="S6.E15.m1.2.2.3.cmml">1</mn><mrow id="S6.E15.m1.2.2.1" xref="S6.E15.m1.2.2.1.cmml"><msub id="S6.E15.m1.2.2.1.3" xref="S6.E15.m1.2.2.1.3.cmml"><mtext id="S6.E15.m1.2.2.1.3.2" xref="S6.E15.m1.2.2.1.3.2a.cmml">rank</mtext><mtext id="S6.E15.m1.2.2.1.3.3" xref="S6.E15.m1.2.2.1.3.3a.cmml">correct</mtext></msub><mo id="S6.E15.m1.2.2.1.2" xref="S6.E15.m1.2.2.1.2.cmml">⁢</mo><mrow id="S6.E15.m1.2.2.1.1.1" xref="S6.E15.m1.2.2.1.1.1.1.cmml"><mo id="S6.E15.m1.2.2.1.1.1.2" stretchy="false" xref="S6.E15.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S6.E15.m1.2.2.1.1.1.1" xref="S6.E15.m1.2.2.1.1.1.1.cmml"><mi id="S6.E15.m1.2.2.1.1.1.1.2" xref="S6.E15.m1.2.2.1.1.1.1.2.cmml">v</mi><mi id="S6.E15.m1.2.2.1.1.1.1.3" xref="S6.E15.m1.2.2.1.1.1.1.3.cmml">u</mi></msub><mo id="S6.E15.m1.2.2.1.1.1.3" stretchy="false" xref="S6.E15.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.E15.m1.2b"><apply id="S6.E15.m1.2.3.cmml" xref="S6.E15.m1.2.3"><eq id="S6.E15.m1.2.3.1.cmml" xref="S6.E15.m1.2.3.1"></eq><ci id="S6.E15.m1.2.3.2a.cmml" xref="S6.E15.m1.2.3.2"><mtext id="S6.E15.m1.2.3.2.cmml" xref="S6.E15.m1.2.3.2">MRR@10</mtext></ci><apply id="S6.E15.m1.2.3.3.cmml" xref="S6.E15.m1.2.3.3"><times id="S6.E15.m1.2.3.3.1.cmml" xref="S6.E15.m1.2.3.3.1"></times><apply id="S6.E15.m1.1.1.cmml" xref="S6.E15.m1.1.1"><divide id="S6.E15.m1.1.1.2.cmml" xref="S6.E15.m1.1.1"></divide><cn id="S6.E15.m1.1.1.3.cmml" type="integer" xref="S6.E15.m1.1.1.3">1</cn><apply id="S6.E15.m1.1.1.1.2.cmml" xref="S6.E15.m1.1.1.1.3"><abs id="S6.E15.m1.1.1.1.2.1.cmml" xref="S6.E15.m1.1.1.1.3.1"></abs><ci id="S6.E15.m1.1.1.1.1.cmml" xref="S6.E15.m1.1.1.1.1">𝒰</ci></apply></apply><apply id="S6.E15.m1.2.3.3.2.cmml" xref="S6.E15.m1.2.3.3.2"><apply id="S6.E15.m1.2.3.3.2.1.cmml" xref="S6.E15.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S6.E15.m1.2.3.3.2.1.1.cmml" xref="S6.E15.m1.2.3.3.2.1">subscript</csymbol><sum id="S6.E15.m1.2.3.3.2.1.2.cmml" xref="S6.E15.m1.2.3.3.2.1.2"></sum><apply id="S6.E15.m1.2.3.3.2.1.3.cmml" xref="S6.E15.m1.2.3.3.2.1.3"><in id="S6.E15.m1.2.3.3.2.1.3.1.cmml" xref="S6.E15.m1.2.3.3.2.1.3.1"></in><ci id="S6.E15.m1.2.3.3.2.1.3.2.cmml" xref="S6.E15.m1.2.3.3.2.1.3.2">𝑢</ci><ci id="S6.E15.m1.2.3.3.2.1.3.3.cmml" xref="S6.E15.m1.2.3.3.2.1.3.3">𝒰</ci></apply></apply><apply id="S6.E15.m1.2.2.cmml" xref="S6.E15.m1.2.2"><divide id="S6.E15.m1.2.2.2.cmml" xref="S6.E15.m1.2.2"></divide><cn id="S6.E15.m1.2.2.3.cmml" type="integer" xref="S6.E15.m1.2.2.3">1</cn><apply id="S6.E15.m1.2.2.1.cmml" xref="S6.E15.m1.2.2.1"><times id="S6.E15.m1.2.2.1.2.cmml" xref="S6.E15.m1.2.2.1.2"></times><apply id="S6.E15.m1.2.2.1.3.cmml" xref="S6.E15.m1.2.2.1.3"><csymbol cd="ambiguous" id="S6.E15.m1.2.2.1.3.1.cmml" xref="S6.E15.m1.2.2.1.3">subscript</csymbol><ci id="S6.E15.m1.2.2.1.3.2a.cmml" xref="S6.E15.m1.2.2.1.3.2"><mtext id="S6.E15.m1.2.2.1.3.2.cmml" xref="S6.E15.m1.2.2.1.3.2">rank</mtext></ci><ci id="S6.E15.m1.2.2.1.3.3a.cmml" xref="S6.E15.m1.2.2.1.3.3"><mtext id="S6.E15.m1.2.2.1.3.3.cmml" mathsize="70%" xref="S6.E15.m1.2.2.1.3.3">correct</mtext></ci></apply><apply id="S6.E15.m1.2.2.1.1.1.1.cmml" xref="S6.E15.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S6.E15.m1.2.2.1.1.1.1.1.cmml" xref="S6.E15.m1.2.2.1.1.1">subscript</csymbol><ci id="S6.E15.m1.2.2.1.1.1.1.2.cmml" xref="S6.E15.m1.2.2.1.1.1.1.2">𝑣</ci><ci id="S6.E15.m1.2.2.1.1.1.1.3.cmml" xref="S6.E15.m1.2.2.1.1.1.1.3">𝑢</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.E15.m1.2c">\text{MRR@10}=\frac{1}{|\mathcal{U}|}\sum_{u\in\mathcal{U}}\frac{1}{\text{rank%
}_{\text{correct}}(v_{u})}</annotation><annotation encoding="application/x-llamapun" id="S6.E15.m1.2d">MRR@10 = divide start_ARG 1 end_ARG start_ARG | caligraphic_U | end_ARG ∑ start_POSTSUBSCRIPT italic_u ∈ caligraphic_U end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG rank start_POSTSUBSCRIPT correct end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S6.I2.i3.p1.4">where <math alttext="\text{rank}_{\text{correct}}(v_{u})" class="ltx_Math" display="inline" id="S6.I2.i3.p1.2.m1.1"><semantics id="S6.I2.i3.p1.2.m1.1a"><mrow id="S6.I2.i3.p1.2.m1.1.1" xref="S6.I2.i3.p1.2.m1.1.1.cmml"><msub id="S6.I2.i3.p1.2.m1.1.1.3" xref="S6.I2.i3.p1.2.m1.1.1.3.cmml"><mtext id="S6.I2.i3.p1.2.m1.1.1.3.2" xref="S6.I2.i3.p1.2.m1.1.1.3.2a.cmml">rank</mtext><mtext id="S6.I2.i3.p1.2.m1.1.1.3.3" xref="S6.I2.i3.p1.2.m1.1.1.3.3a.cmml">correct</mtext></msub><mo id="S6.I2.i3.p1.2.m1.1.1.2" xref="S6.I2.i3.p1.2.m1.1.1.2.cmml">⁢</mo><mrow id="S6.I2.i3.p1.2.m1.1.1.1.1" xref="S6.I2.i3.p1.2.m1.1.1.1.1.1.cmml"><mo id="S6.I2.i3.p1.2.m1.1.1.1.1.2" stretchy="false" xref="S6.I2.i3.p1.2.m1.1.1.1.1.1.cmml">(</mo><msub id="S6.I2.i3.p1.2.m1.1.1.1.1.1" xref="S6.I2.i3.p1.2.m1.1.1.1.1.1.cmml"><mi id="S6.I2.i3.p1.2.m1.1.1.1.1.1.2" xref="S6.I2.i3.p1.2.m1.1.1.1.1.1.2.cmml">v</mi><mi id="S6.I2.i3.p1.2.m1.1.1.1.1.1.3" xref="S6.I2.i3.p1.2.m1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S6.I2.i3.p1.2.m1.1.1.1.1.3" stretchy="false" xref="S6.I2.i3.p1.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.I2.i3.p1.2.m1.1b"><apply id="S6.I2.i3.p1.2.m1.1.1.cmml" xref="S6.I2.i3.p1.2.m1.1.1"><times id="S6.I2.i3.p1.2.m1.1.1.2.cmml" xref="S6.I2.i3.p1.2.m1.1.1.2"></times><apply id="S6.I2.i3.p1.2.m1.1.1.3.cmml" xref="S6.I2.i3.p1.2.m1.1.1.3"><csymbol cd="ambiguous" id="S6.I2.i3.p1.2.m1.1.1.3.1.cmml" xref="S6.I2.i3.p1.2.m1.1.1.3">subscript</csymbol><ci id="S6.I2.i3.p1.2.m1.1.1.3.2a.cmml" xref="S6.I2.i3.p1.2.m1.1.1.3.2"><mtext id="S6.I2.i3.p1.2.m1.1.1.3.2.cmml" xref="S6.I2.i3.p1.2.m1.1.1.3.2">rank</mtext></ci><ci id="S6.I2.i3.p1.2.m1.1.1.3.3a.cmml" xref="S6.I2.i3.p1.2.m1.1.1.3.3"><mtext id="S6.I2.i3.p1.2.m1.1.1.3.3.cmml" mathsize="70%" xref="S6.I2.i3.p1.2.m1.1.1.3.3">correct</mtext></ci></apply><apply id="S6.I2.i3.p1.2.m1.1.1.1.1.1.cmml" xref="S6.I2.i3.p1.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S6.I2.i3.p1.2.m1.1.1.1.1.1.1.cmml" xref="S6.I2.i3.p1.2.m1.1.1.1.1">subscript</csymbol><ci id="S6.I2.i3.p1.2.m1.1.1.1.1.1.2.cmml" xref="S6.I2.i3.p1.2.m1.1.1.1.1.1.2">𝑣</ci><ci id="S6.I2.i3.p1.2.m1.1.1.1.1.1.3.cmml" xref="S6.I2.i3.p1.2.m1.1.1.1.1.1.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i3.p1.2.m1.1c">\text{rank}_{\text{correct}}(v_{u})</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i3.p1.2.m1.1d">rank start_POSTSUBSCRIPT correct end_POSTSUBSCRIPT ( italic_v start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT )</annotation></semantics></math> is the rank position of the correct item <math alttext="v_{u}" class="ltx_Math" display="inline" id="S6.I2.i3.p1.3.m2.1"><semantics id="S6.I2.i3.p1.3.m2.1a"><msub id="S6.I2.i3.p1.3.m2.1.1" xref="S6.I2.i3.p1.3.m2.1.1.cmml"><mi id="S6.I2.i3.p1.3.m2.1.1.2" xref="S6.I2.i3.p1.3.m2.1.1.2.cmml">v</mi><mi id="S6.I2.i3.p1.3.m2.1.1.3" xref="S6.I2.i3.p1.3.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S6.I2.i3.p1.3.m2.1b"><apply id="S6.I2.i3.p1.3.m2.1.1.cmml" xref="S6.I2.i3.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S6.I2.i3.p1.3.m2.1.1.1.cmml" xref="S6.I2.i3.p1.3.m2.1.1">subscript</csymbol><ci id="S6.I2.i3.p1.3.m2.1.1.2.cmml" xref="S6.I2.i3.p1.3.m2.1.1.2">𝑣</ci><ci id="S6.I2.i3.p1.3.m2.1.1.3.cmml" xref="S6.I2.i3.p1.3.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i3.p1.3.m2.1c">v_{u}</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i3.p1.3.m2.1d">italic_v start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> in the top 10 predictions for user <math alttext="u" class="ltx_Math" display="inline" id="S6.I2.i3.p1.4.m3.1"><semantics id="S6.I2.i3.p1.4.m3.1a"><mi id="S6.I2.i3.p1.4.m3.1.1" xref="S6.I2.i3.p1.4.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S6.I2.i3.p1.4.m3.1b"><ci id="S6.I2.i3.p1.4.m3.1.1.cmml" xref="S6.I2.i3.p1.4.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.I2.i3.p1.4.m3.1c">u</annotation><annotation encoding="application/x-llamapun" id="S6.I2.i3.p1.4.m3.1d">italic_u</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4. </span>D. Implementation Details </h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">In this section, we present the details about the implementation of our SIGMA framework. The corresponding code can be found in the <span class="ltx_text ltx_font_bold" id="S6.SS4.p1.1.1">Supplementary Materials</span>.
The Mamba block is one of the most important components of the SSM-based model (including SIGMA). So for fair comparison, we set the SSM state expansion factor to 32, the local convolution width to 4, and the block expansion factor to 2 for all models that include Mamba blocks. For the number of stacked layers, we set it to the defaulted 2 for all the selected RNN-based, transformer-based models and Mamba4Rec, comparing them with ECHO and our SIGMA with 1 layer.
Moreover, to address the sparsity of Amazon datasets and Yelp dataset, a dropout rate of 0.3 is used, compared to 0.2 for MovieLens-1M.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5. </span>E. Baselines</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">(a) <span class="ltx_text ltx_font_bold" id="S6.SS5.p1.1.1">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib36" title="">2017</a>)</cite>: GRU4Rec utilizes Gated Recurrent Units (GRUs) to capture sequential dependencies within user interaction data. It is particularly effective for session-based recommendations, allowing the model to focus on the most recent and relevant user interactions to make accurate predictions. The model is known for its efficiency in handling session-based data, particularly in capturing user intent during a session <cite class="ltx_cite ltx_citemacro_citep">(Keles et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib16" title="">2023</a>)</cite>.
(b) <span class="ltx_text ltx_font_bold" id="S6.SS5.p1.1.2">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib15" title="">2018</a>)</cite>: BERT4Rec adapts the BERT (Bidirectional Encoder Representations from Transformers) architecture for personalized recommendations. Unlike traditional sequential models, BERT4Rec considers both past and future contexts of user behavior by employing a bidirectional self-attention mechanism, which enhances the representation of user interaction sequences. This allows the model to predict items in a more context-aware manner.
(c) <span class="ltx_text ltx_font_bold" id="S6.SS5.p1.1.3">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib32" title="">2024</a>)</cite>: SASRec applies a multi-head self-attention mechanism to capture both long-term and short-term user preferences from interaction sequences. It constructs user representations by focusing on relevant parts of the interaction history, thereby improving the quality of recommendations, especially in scenarios where user preferences vary over time.
(d) <span class="ltx_text ltx_font_bold" id="S6.SS5.p1.1.4">LinRec</span> <cite class="ltx_cite ltx_citemacro_citep">(de Souza Pereira Moreira et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib5" title="">2021</a>)</cite>: LinRec simplifies the computational complexity of the traditional transformer models by modifying the dot product in the attention mechanism. This reduction in complexity makes LinRec particularly suitable for large-scale recommendation tasks where efficiency is crucial, without significantly sacrificing performance.
(e) <span class="ltx_text ltx_font_bold" id="S6.SS5.p1.1.5">FEARec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib17" title="">2019a</a>)</cite>: FEARec enhances traditional attention mechanisms by incorporating information from the frequency domain. This hybrid approach allows the model to better capture periodic patterns and long-range dependencies in user interaction sequences, leading to more powerful and accurate recommendations.
(f) <span class="ltx_text ltx_font_bold" id="S6.SS5.p1.1.6">Mamba4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Jannach and Ludewig, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib13" title="">2017</a>)</cite>: Mamba4Rec leverages Selective State Space Models (SSMs) to address the effectiveness-efficiency trade-off in sequential recommendation. By using SSMs, Mamba4Rec efficiently handles long behavior sequences, capturing complex dependencies while maintaining low computational costs. It outperforms traditional self-attention mechanisms, especially in scenarios involving long user interaction histories.
(g) <span class="ltx_text ltx_font_bold" id="S6.SS5.p1.1.7">EchoMamba4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">12</span>)</cite>: Building on Mamba4Rec, EchoMamba4Rec introduces a frequency domain filter to remove noise and enhance the signal in sequential data. This bi-directional model processes sequences both forward and backward, providing a more comprehensive understanding of user behavior. The Fourier Transform-based filtering further improves the model’s robustness and accuracy in predicting user preferences.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.6. </span>F. Efficiency Comparison</h3>
<div class="ltx_para" id="S6.SS6.p1">
<p class="ltx_p" id="S6.SS6.p1.1">In this section, We will present and analyze the efficiency comparison on other datasets with our proposed SIGMA.
From Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.T9" title="Table 9 ‣ 6.8. H. Ablation Study ‣ 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>, we can see that the SSM-based models (including our SIGMA) show consistent efficiency in the other three datasets (Yelp, Sports, and ML-1M). Although for ML-1M, our SIMGA shows an increase in GPU Memory due to our partial flipping method, which means we need to store and compute a new sequence for the reverse direction, our method still achieves higher efficiency remarkably compared with the transformer-based methods, except for LinRec. The experimental results present the fact that our SIGMA can achieve a better efficiency-effectiveness trade-off.</p>
</div>
<figure class="ltx_table" id="S6.T7">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T7.2.1.1" style="font-size:90%;">Table 7</span>. </span><span class="ltx_text" id="S6.T7.3.2" style="font-size:90%;">Efficiency Comparison: Inference time (ms) per batch and GPU memory (GB).</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T7.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T7.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.4.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.4.1.1.2">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.4.1.1.3">Infer.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T7.4.1.1.4">GPU Memory</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T7.4.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.2.1.1" rowspan="6"><span class="ltx_text" id="S6.T7.4.2.1.1.1">Yelp</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.2.1.2">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.2.1.3">443ms</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.2.1.4">9.28G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.3.2">
<td class="ltx_td ltx_align_center" id="S6.T7.4.3.2.1">FEARec</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.3.2.2">483ms</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.3.2.3">10.01G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.4.3">
<td class="ltx_td ltx_align_center" id="S6.T7.4.4.3.1">LinRec</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.4.3.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T7.4.4.3.2.1">353ms</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.4.3.3">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T7.4.4.3.3.1"></span>7.46G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.5.4">
<td class="ltx_td ltx_align_center" id="S6.T7.4.5.4.1">Mamba</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.5.4.2">361ms</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.5.4.3"><span class="ltx_text ltx_font_bold" id="S6.T7.4.5.4.3.1">7.32G</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.6.5">
<td class="ltx_td ltx_align_center" id="S6.T7.4.6.5.1">ECHO</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.6.5.2">368ms</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.6.5.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T7.4.6.5.3.1">8.46G</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.7.6">
<td class="ltx_td ltx_align_center" id="S6.T7.4.7.6.1">SIGMA</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.7.6.2"><span class="ltx_text ltx_font_bold" id="S6.T7.4.7.6.2.1">352ms</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.7.6.3">8.27G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.8.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.8.7.1" rowspan="6"><span class="ltx_text" id="S6.T7.4.8.7.1.1">Sports</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.8.7.2">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.8.7.3">398ms</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.8.7.4">7.27G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.9.8">
<td class="ltx_td ltx_align_center" id="S6.T7.4.9.8.1">FEARec</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.9.8.2">416ms</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.9.8.3">7.84G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.10.9">
<td class="ltx_td ltx_align_center" id="S6.T7.4.10.9.1">LinRec</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.10.9.2">294ms</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.10.9.3">6.07G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.11.10">
<td class="ltx_td ltx_align_center" id="S6.T7.4.11.10.1">Mamba</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.11.10.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T7.4.11.10.2.1">293ms</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.11.10.3"><span class="ltx_text ltx_font_bold" id="S6.T7.4.11.10.3.1">5.89G</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.12.11">
<td class="ltx_td ltx_align_center" id="S6.T7.4.12.11.1">ECHO</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.12.11.2">291ms</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.12.11.3">5.99G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.13.12">
<td class="ltx_td ltx_align_center" id="S6.T7.4.13.12.1">SIGMA</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.13.12.2"><span class="ltx_text ltx_font_bold" id="S6.T7.4.13.12.2.1">283ms</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.13.12.3">6.03G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.14.13">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T7.4.14.13.1" rowspan="6"><span class="ltx_text" id="S6.T7.4.14.13.1.1">ML-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.14.13.2">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.14.13.3">87ms</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T7.4.14.13.4">21.51G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.15.14">
<td class="ltx_td ltx_align_center" id="S6.T7.4.15.14.1">FEARec</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.15.14.2">109ms</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.15.14.3">21.28G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.16.15">
<td class="ltx_td ltx_align_center" id="S6.T7.4.16.15.1">LinRec</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.16.15.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T7.4.16.15.2.1">59ms</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.16.15.3">11.79G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.17.16">
<td class="ltx_td ltx_align_center" id="S6.T7.4.17.16.1">Mamba</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.17.16.2"><span class="ltx_text ltx_font_bold" id="S6.T7.4.17.16.2.1">55ms</span></td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.17.16.3"><span class="ltx_text ltx_font_bold" id="S6.T7.4.17.16.3.1">6.89G</span></td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.18.17">
<td class="ltx_td ltx_align_center" id="S6.T7.4.18.17.1">ECHO</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.18.17.2">63ms</td>
<td class="ltx_td ltx_align_center" id="S6.T7.4.18.17.3">9.92G</td>
</tr>
<tr class="ltx_tr" id="S6.T7.4.19.18">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.4.19.18.1">SIGMA</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.4.19.18.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T7.4.19.18.2.1">59ms</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T7.4.19.18.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S6.T7.4.19.18.3.1">9.89G</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.7. </span>G. Grouped Users Analysis</h3>
<div class="ltx_para" id="S6.SS7.p1">
<p class="ltx_p" id="S6.SS7.p1.1">In this section, we will present the grouped user analysis on the other three datasets <em class="ltx_emph ltx_font_italic" id="S6.SS7.p1.1.1">i.e.,</em> ML-1M, Yelp and Games.
We also group the user by their interaction length, followed by our experiment setting. The detailed distribution is listed in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.T8" title="Table 8 ‣ 6.7. G. Grouped Users Analysis ‣ 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>. The performance of the selected models is presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.F7" title="Figure 7 ‣ 6.7. G. Grouped Users Analysis ‣ 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>. Noted that, as illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#S6.T8" title="Table 8 ‣ 6.7. G. Grouped Users Analysis ‣ 6. Appendix ‣ Bidirectional Gated Mamba for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">8</span></a>, the interaction length of users in ML-1M are all longer than 5, so the performance for the “short” group in ML-1M is reasonably empty. All the experiments above further prove the superiority of our proposed SIGMA framework on all groups, showing the effectiveness of our FE-GRU and PF-Mamba in dealing with context modeling and short sequence modeling, respectively.</p>
</div>
<figure class="ltx_figure" id="S6.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="261" id="S6.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F7.2.1.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text" id="S6.F7.3.2" style="font-size:90%;">Grouped Users Analysis on ML-1M, Yelp and Games.</span></figcaption>
</figure>
<figure class="ltx_table" id="S6.T8">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T8.2.1.1" style="font-size:90%;">Table 8</span>. </span><span class="ltx_text" id="S6.T8.3.2" style="font-size:90%;">User sample distribution</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S6.T8.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T8.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S6.T8.4.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.4.1.1.2">Short(0-5)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.4.1.1.3">Medium(5-20)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T8.4.1.1.4">Long(20-inf)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T8.4.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S6.T8.4.2.1.1">Games</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.4.2.1.2">27631</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.4.2.1.3">25084</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T8.4.2.1.4">2426</td>
</tr>
<tr class="ltx_tr" id="S6.T8.4.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S6.T8.4.3.2.1">Yelp</th>
<td class="ltx_td ltx_align_center" id="S6.T8.4.3.2.2">34659</td>
<td class="ltx_td ltx_align_center" id="S6.T8.4.3.2.3">42934</td>
<td class="ltx_td ltx_align_center" id="S6.T8.4.3.2.4">5306</td>
</tr>
<tr class="ltx_tr" id="S6.T8.4.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S6.T8.4.4.3.1">ML-1M</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.4.4.3.2">0</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.4.4.3.3">177</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T8.4.4.3.4">5863</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.8. </span>H. Ablation Study</h3>
<div class="ltx_para" id="S6.SS8.p1">
<p class="ltx_p" id="S6.SS8.p1.1">In this section, we will analyze the efficacy of three key components with SIGMA on other datasets <em class="ltx_emph ltx_font_italic" id="S6.SS8.p1.1.1">i.e.,</em> Sports, Games, Yelp and ML-1M. According to the data statistics in the experiment setting, we can clearly see that Yelp, Sports, Beauty, and Games have similar average interaction lengths. Correspondingly, the ablation study on Sports, Games, and Yelp datasets shows a similar tendency to the one on Beauty. But for ML-1M, due to the relatively long sequence, we can find that FE-GRU contributes the least since it mainly focuses on enhancing the hidden representation for short sequences, while the other two components show a remarkable drop when removing them, proving the effectiveness of our designed PF-Mamba in contextual information modeling.</p>
</div>
<figure class="ltx_table" id="S6.T9">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T9.2.1.1" style="font-size:90%;">Table 9</span>. </span><span class="ltx_text" id="S6.T9.3.2" style="font-size:90%;">Ablation study on other datasets.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S6.T9.4" style="width:216.8pt;height:219.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-42.6pt,43.1pt) scale(0.718011704984583,0.718011704984583) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S6.T9.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S6.T9.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.4.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.4.1.1.1.2">Methods</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.4.1.1.1.3">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.4.1.1.1.4">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S6.T9.4.1.1.1.5">MRR@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S6.T9.4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.2.1.1" rowspan="4"><span class="ltx_text" id="S6.T9.4.1.2.1.1.1">Sports</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.2.1.2">Default</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.2.1.3.1">0.0735</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.2.1.4.1">0.0590</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.2.1.5"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.2.1.5.1">0.0556</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.3.2">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.3.2.1">w/o partial flipping</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.3.2.2">0.0711</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.3.2.3">0.0582</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.3.2.4">0.0544</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.4.3">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.4.3.1">w/o DS gate</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.4.3.2">0.0713</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.4.3.3">0.0577</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.4.3.4">0.0529</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.5.4">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.5.4.1">w/o FE-GRU</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.5.4.2">0.0622</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.5.4.3">0.0481</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.5.4.4">0.0473</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.6.5.1" rowspan="4"><span class="ltx_text" id="S6.T9.4.1.6.5.1.1">Games</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.6.5.2">Default</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.6.5.3.1">0.1627</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.6.5.4.1">0.1088</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.6.5.5.1">0.0924</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.7.6">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.7.6.1">w/o partial flipping</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.7.6.2">0.1601</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.7.6.3">0.1067</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.7.6.4">0.0911</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.8.7">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.8.7.1">w/o DS gate</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.8.7.2">0.1597</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.8.7.3">0.1054</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.8.7.4">0.0889</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.9.8">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.9.8.1">w/o FE-GRU</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.9.8.2">0.1562</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.9.8.3">0.0978</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.9.8.4">0.0861</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.10.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.10.9.1" rowspan="4"><span class="ltx_text" id="S6.T9.4.1.10.9.1.1">Yelp</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.10.9.2">Default</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.10.9.3"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.10.9.3.1">0.0629</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.10.9.4"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.10.9.4.1">0.0412</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.10.9.5"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.10.9.5.1">0.0346</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.11.10">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.11.10.1">w/o partial flipping</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.11.10.2">0.0611</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.11.10.3">0.0402</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.11.10.4">0.0327</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.12.11">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.12.11.1">w/o DS gate</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.12.11.2">0.0613</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.12.11.3">0.0389</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.12.11.4">0.0314</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.13.12">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.13.12.1">w/o FE-GRU</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.13.12.2">0.0595</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.13.12.3">0.0377</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.13.12.4">0.0301</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.14.13">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T9.4.1.14.13.1" rowspan="4"><span class="ltx_text" id="S6.T9.4.1.14.13.1.1">ML-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.14.13.2">Default</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.14.13.3"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.14.13.3.1">0.3308</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.14.13.4"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.14.13.4.1">0.1906</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T9.4.1.14.13.5"><span class="ltx_text ltx_font_bold" id="S6.T9.4.1.14.13.5.1">0.1479</span></td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.15.14">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.15.14.1">w/o partial flipping</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.15.14.2">0.3289</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.15.14.3">0.1887</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.15.14.4">0.1459</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.16.15">
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.16.15.1">w/o DS gate</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.16.15.2">0.3288</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.16.15.3">0.1866</td>
<td class="ltx_td ltx_align_center" id="S6.T9.4.1.16.15.4">0.1443</td>
</tr>
<tr class="ltx_tr" id="S6.T9.4.1.17.16">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.4.1.17.16.1">w/o FE-GRU</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.4.1.17.16.2">0.3304</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.4.1.17.16.3">0.1901</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S6.T9.4.1.17.16.4">0.1471</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS9">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.9. </span>I. Guideline for reproducibility</h3>
<div class="ltx_para" id="S6.SS9.p1">
<p class="ltx_p" id="S6.SS9.p1.1">In this section, we will detail a guideline for reproducing our results.
In the model file we released, we have <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.1">baseline</span> and <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.2">baseline_config</span> folders, which respectively contain almost all the baseline methods (others can be easily found in recbole’s original models) and corresponding configurations mentioned in the overall experiment; <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.3">datasets</span> folder storing the chosen datasets (Beauty, Sports, Games, Yelp and ML-1M) in atomic files to fit the recbole framework <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2408.11451v2#bib.bib39" title="">2024</a>)</cite>; <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.4">model</span> file containing the <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.5">gated_mamba.py</span>, which is the main structure of our SIGMA. To reproduce our proposed SIGMA framework, you can directly run the <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.6">run.py</span> file with the proper command. It is noteworthy that the environment and version of <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.7">mamba_ssm</span> are quite important in reproducing the experimental results, so please check your environment referencing the <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.8">requirements.yaml</span> file.
Specifically, you are recommended to run <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.9">run.py</span> for successful reproduction, which contains the calls to <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.10">gated_mamba.py</span>. For the relevant parameters to perform the experiments in hyperparameter analysis, you can directly set it in <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.11">config.yaml</span> with other dataset settings and model settings. We also attach the <span class="ltx_text ltx_font_bold" id="S6.SS9.p1.1.12">RecMamba.ipynb</span> to show the raw training procedure in Colab.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Aug 23 01:56:10 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
