<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1608.08974] Towards Transparent AI Systems: Interpreting Visual Question Answering Models</title><meta property="og:description" content="Deep neural networks have shown striking progress and obtained state-of-the-art results in many AI research fields in the recent years.
However, it is often unsatisfying to not know why they predict what they do.
In th…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Towards Transparent AI Systems: Interpreting Visual Question Answering Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Towards Transparent AI Systems: Interpreting Visual Question Answering Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1608.08974">

<!--Generated on Fri Mar  1 20:40:50 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Towards Transparent AI Systems: 
<br class="ltx_break">Interpreting Visual Question Answering Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yash Goyal, Akrit Mohapatra, Devi Parikh, Dhruv Batra 
<br class="ltx_break">Virginia Tech 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{ygoyal, akrit, parikh, dbatra}@vt.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Deep neural networks have shown striking progress and obtained state-of-the-art results in many AI research fields in the recent years.
However, it is often unsatisfying to not know why they predict what they do.
In this paper, we address the problem of interpreting Visual Question Answering (VQA) models.
Specifically, we are interested in finding what part of the input (pixels in images or words in questions) the VQA model focuses on while answering the question.
To tackle this problem, we use two visualization techniques – guided backpropagation and occlusion – to find important words in the question and important regions in the image.
We then present qualitative and quantitative analyses of these importance maps.
We found that even without explicit attention mechanisms, VQA models may sometimes be implicitly attending to relevant regions in the image, and often to appropriate words in the question.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">We are witnessing an excitement in the research community and frenzy in media regarding advances in AI.
Fueled by a combination of massive datasets and advances in deep neural networks (DNNs), the community has made remarkable progress
in the past few years
on a variety of ‘low-level’ AI tasks such as image classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx18" title="" class="ltx_ref">Szegedy et al., 2015</a>]</cite>
machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx5" title="" class="ltx_ref">Brea et al., 2011</a>, <a href="#bib.bibx17" title="" class="ltx_ref">Sutskever et al., 2014</a>]</cite>
and speech recognition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx8" title="" class="ltx_ref">Hinton et al., 2012</a>]</cite>.
Neural networks are also demonstrating potential in ‘high-level’ AI tasks such as
learning to play
Go <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx14" title="" class="ltx_ref">Silver et al., 2016</a>]</cite>,
answering reading comprehension questions by understanding short stories <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx4" title="" class="ltx_ref">Bordes et al., 2015</a>, <a href="#bib.bibx19" title="" class="ltx_ref">Weston et al., 2015</a>]</cite>,
and even answering questions about images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx2" title="" class="ltx_ref">Antol et al., 2015</a>, <a href="#bib.bibx12" title="" class="ltx_ref">Ren et al., 2015</a>, <a href="#bib.bibx11" title="" class="ltx_ref">Malinowski et al., 2015</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Unfortunately, when today’s machine perception and intelligent systems fail, they fail in a spectacularly disgraceful manner, without warning or explanation, leaving the user staring at an incoherent output, wondering why the system did what it did.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1608.08974/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="210" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.4.2" class="ltx_text" style="font-size:90%;">The goal of this work is to interpret Visual Question Answering (VQA) models. We are interested in answering the question– <em id="S1.F1.4.2.1" class="ltx_emph ltx_font_italic">why does a VQA model predict what it does?</em> Our approach here is to find the evidence in the test input on which the model focuses while answering the question. In this example, “whole” is the most important word in the question for the model while predicting the answer “no”.
</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, we focus on
Visual Question Answering, where given an image and a free-form natural language question about the image,
(e.g., “What color are the girl’s shoes?”, or “Is the boy jumping?”),
the machine has to produce a natural language answer as its output
(e.g. “blue”, or “yes”).
Specifically, we try to interpret a recent state-of-art VQA model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx10" title="" class="ltx_ref">Lu et al., 2015</a>]</cite> trained on recently released VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx2" title="" class="ltx_ref">Antol et al., 2015</a>]</cite> dataset.
This VQA model uses Convolutional Neural Network (CNN) based embedding of the image, Long-Short Term Memory (LSTM) based embedding of the question, combines these two embeddings, and uses a multi-layer perceptron as a classifier to predict a probability distribution over answers.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Sustained interactions<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Demo available here: <a target="_blank" href="http://cloudcv.org/vqa/" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://cloudcv.org/vqa/</a> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx1" title="" class="ltx_ref">Agrawal et al., 2015</a>]</cite></span></span></span> with the system make it clear that the system has a non-trivial level of intelligence (e.g., it is able to recognize people, objects, <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">etc</em>.<span id="S1.p4.1.2" class="ltx_text"></span> in the image). However, it is deeply unsatisfying to not know why the system predicts what it does (especially the glaring mistakes).
The root cause is <em id="S1.p4.1.3" class="ltx_emph ltx_font_italic">lack of transparency or interpretability</em>.
With a few rare exceptions, the emphasis in machine learning, computer vision, and AI communities today is on building systems with good predictive performance, not <em id="S1.p4.1.4" class="ltx_emph ltx_font_italic">transparency</em>. As a result, the users of these intelligent systems perceive them as inscrutable black boxes that cannot be understood or trusted.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We are interested in the question of transparency –
<span id="S1.p5.1.1" class="ltx_text ltx_font_italic">why does a VQA system do what it does?</span> (See Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Towards Transparent AI Systems: Interpreting Visual Question Answering Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).
Specifically, <em id="S1.p5.1.2" class="ltx_emph ltx_font_italic">what evidence in the test input (image and question) supports a particular prediction?</em> In the context of VQA, this question can be expressed as two subproblems:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span id="S1.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">What words in the question does the model “listen to” in order to answer the question? </span></p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">What pixels in the image does the model “look at” while answering the question?</span></p>
</div>
</li>
</ul>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In this work, we use two visualization methods to tackle the above problems.
The first method (Sec. <a href="#S3.SS1" title="3.1 Guided Backpropagation ‣ 3 Approach ‣ Towards Transparent AI Systems: Interpreting Visual Question Answering Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>) uses guided backpropagation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">Springenberg et al., 2015</a>]</cite> to analyze important words in the question and important regions in the image.
In the second method (Sec. <a href="#S3.SS2" title="3.2 Discrete Derivatives ‣ 3 Approach ‣ Towards Transparent AI Systems: Interpreting Visual Question Answering Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>), we occlude portions of input and observe the change in prediction probabilities of the model, to compute importance of question words and image regions.
In Sec. <a href="#S4" title="4 Results ‣ Towards Transparent AI Systems: Interpreting Visual Question Answering Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we present qualitative and quantitative analyses of these image/question ‘importance maps’ – question importance maps are analyzed using their Part-of-Speech (POS) tags; image importance maps are compared to ‘human attention maps’ or maps showing where humans look for answering a question about the image <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx6" title="" class="ltx_ref">Das et al., 2016</a>]</cite>.
We found that even without explicit attention mechanisms, VQA models may sometimes be implicitly attending to relevant regions in the image, and often to appropriate words in the question.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Many gradient based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx20" title="" class="ltx_ref">Zeiler and Fergus, 2014</a>, <a href="#bib.bibx15" title="" class="ltx_ref">Simonyan et al., 2014</a>, <a href="#bib.bibx16" title="" class="ltx_ref">Springenberg et al., 2015</a>]</cite> have been proposed in recent years in the field of computer vision to visualize deep convolutional neural networks.
But most of them focused on the task of image classification on iconic images where the main object occupies most of the image.
Our work differs in 2 ways – 1) we also compute gradients w.r.t.<span id="S2.p1.1.1" class="ltx_text"></span> the input question, and 2) we use guided backpropagation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">Springenberg et al., 2015</a>]</cite> for the task of VQA, where the model can look at different regions in the same image for different questions. As per our literature review, we are the first to study this problem for VQA.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Our occlusion experiment is inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx20" title="" class="ltx_ref">Zeiler and Fergus, 2014</a>]</cite> who mask small regions in the image with a gray patch, and observe the output of an image classification model.
We evaluate if the model looks at the same regions in the image as humans do, while answering a question about the image.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">A few recent works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx13" title="" class="ltx_ref">Ribeiro et al., 2016</a>, <a href="#bib.bibx3" title="" class="ltx_ref">Baehrens et al., 2010</a>, <a href="#bib.bibx9" title="" class="ltx_ref">Liu and Wang, 2012</a>]</cite>
have begun to study the task of providing interpretable post-hoc explanations for classifier predictions.
Such methods typically involve fitting or training a secondary interpretable mechanism on top of the base ‘black-box’ classifier predictions. In contrast, our work directly computes importance maps from the model of interest without another layer of training (which could obfuscate the analysis).</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Approach</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/1608.08974/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="500" height="176" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.3.2" class="ltx_text" style="font-size:90%;">Results for Discrete Derivatives experiment. (a) shows heat maps for questions showing the importance of words in the questions. Encouragingly, “vegetable” is the most important word in the first question for the predicted answer “broccoli”.
(b) shows the importance of different regions in images. In the top image, the region containing the parrot affects the model’s prediction the most.
Both visualization provide justifications for the predictions, resulting in increased transparency in the inner working of the VQA model. Best viewed in color.</span></figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.9" class="ltx_p">At a high level, we view a VQA model as a learned function <math id="S3.p1.1.m1.2" class="ltx_Math" alttext="a=f_{w}(i,q)" display="inline"><semantics id="S3.p1.1.m1.2a"><mrow id="S3.p1.1.m1.2.3" xref="S3.p1.1.m1.2.3.cmml"><mi id="S3.p1.1.m1.2.3.2" xref="S3.p1.1.m1.2.3.2.cmml">a</mi><mo id="S3.p1.1.m1.2.3.1" xref="S3.p1.1.m1.2.3.1.cmml">=</mo><mrow id="S3.p1.1.m1.2.3.3" xref="S3.p1.1.m1.2.3.3.cmml"><msub id="S3.p1.1.m1.2.3.3.2" xref="S3.p1.1.m1.2.3.3.2.cmml"><mi id="S3.p1.1.m1.2.3.3.2.2" xref="S3.p1.1.m1.2.3.3.2.2.cmml">f</mi><mi id="S3.p1.1.m1.2.3.3.2.3" xref="S3.p1.1.m1.2.3.3.2.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.2.3.3.1" xref="S3.p1.1.m1.2.3.3.1.cmml">​</mo><mrow id="S3.p1.1.m1.2.3.3.3.2" xref="S3.p1.1.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.p1.1.m1.2.3.3.3.2.1" xref="S3.p1.1.m1.2.3.3.3.1.cmml">(</mo><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">i</mi><mo id="S3.p1.1.m1.2.3.3.3.2.2" xref="S3.p1.1.m1.2.3.3.3.1.cmml">,</mo><mi id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml">q</mi><mo stretchy="false" id="S3.p1.1.m1.2.3.3.3.2.3" xref="S3.p1.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.2b"><apply id="S3.p1.1.m1.2.3.cmml" xref="S3.p1.1.m1.2.3"><eq id="S3.p1.1.m1.2.3.1.cmml" xref="S3.p1.1.m1.2.3.1"></eq><ci id="S3.p1.1.m1.2.3.2.cmml" xref="S3.p1.1.m1.2.3.2">𝑎</ci><apply id="S3.p1.1.m1.2.3.3.cmml" xref="S3.p1.1.m1.2.3.3"><times id="S3.p1.1.m1.2.3.3.1.cmml" xref="S3.p1.1.m1.2.3.3.1"></times><apply id="S3.p1.1.m1.2.3.3.2.cmml" xref="S3.p1.1.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.2.3.3.2.1.cmml" xref="S3.p1.1.m1.2.3.3.2">subscript</csymbol><ci id="S3.p1.1.m1.2.3.3.2.2.cmml" xref="S3.p1.1.m1.2.3.3.2.2">𝑓</ci><ci id="S3.p1.1.m1.2.3.3.2.3.cmml" xref="S3.p1.1.m1.2.3.3.2.3">𝑤</ci></apply><interval closure="open" id="S3.p1.1.m1.2.3.3.3.1.cmml" xref="S3.p1.1.m1.2.3.3.3.2"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑖</ci><ci id="S3.p1.1.m1.2.2.cmml" xref="S3.p1.1.m1.2.2">𝑞</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.2c">a=f_{w}(i,q)</annotation></semantics></math> that takes in an input image <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">i</annotation></semantics></math> and a question about the image <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">q</annotation></semantics></math>, is parameterized by parameters <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">w</annotation></semantics></math>, and produces an answer <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">a</annotation></semantics></math>. In order to gauge the importance of components of <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">i</annotation></semantics></math> and <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S3.p1.7.m7.1a"><mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">q</annotation></semantics></math> (<em id="S3.p1.9.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.p1.9.2" class="ltx_text"></span> pixels and words), we consider the <em id="S3.p1.9.3" class="ltx_emph ltx_font_italic">best linear approximation</em> to <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.p1.8.m8.1a"><mi id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">f</annotation></semantics></math> around each test point <math id="S3.p1.9.m9.2" class="ltx_Math" alttext="(i_{test},q_{test})" display="inline"><semantics id="S3.p1.9.m9.2a"><mrow id="S3.p1.9.m9.2.2.2" xref="S3.p1.9.m9.2.2.3.cmml"><mo stretchy="false" id="S3.p1.9.m9.2.2.2.3" xref="S3.p1.9.m9.2.2.3.cmml">(</mo><msub id="S3.p1.9.m9.1.1.1.1" xref="S3.p1.9.m9.1.1.1.1.cmml"><mi id="S3.p1.9.m9.1.1.1.1.2" xref="S3.p1.9.m9.1.1.1.1.2.cmml">i</mi><mrow id="S3.p1.9.m9.1.1.1.1.3" xref="S3.p1.9.m9.1.1.1.1.3.cmml"><mi id="S3.p1.9.m9.1.1.1.1.3.2" xref="S3.p1.9.m9.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p1.9.m9.1.1.1.1.3.1" xref="S3.p1.9.m9.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.9.m9.1.1.1.1.3.3" xref="S3.p1.9.m9.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p1.9.m9.1.1.1.1.3.1a" xref="S3.p1.9.m9.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.9.m9.1.1.1.1.3.4" xref="S3.p1.9.m9.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.9.m9.1.1.1.1.3.1b" xref="S3.p1.9.m9.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.9.m9.1.1.1.1.3.5" xref="S3.p1.9.m9.1.1.1.1.3.5.cmml">t</mi></mrow></msub><mo id="S3.p1.9.m9.2.2.2.4" xref="S3.p1.9.m9.2.2.3.cmml">,</mo><msub id="S3.p1.9.m9.2.2.2.2" xref="S3.p1.9.m9.2.2.2.2.cmml"><mi id="S3.p1.9.m9.2.2.2.2.2" xref="S3.p1.9.m9.2.2.2.2.2.cmml">q</mi><mrow id="S3.p1.9.m9.2.2.2.2.3" xref="S3.p1.9.m9.2.2.2.2.3.cmml"><mi id="S3.p1.9.m9.2.2.2.2.3.2" xref="S3.p1.9.m9.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p1.9.m9.2.2.2.2.3.1" xref="S3.p1.9.m9.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.9.m9.2.2.2.2.3.3" xref="S3.p1.9.m9.2.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p1.9.m9.2.2.2.2.3.1a" xref="S3.p1.9.m9.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.9.m9.2.2.2.2.3.4" xref="S3.p1.9.m9.2.2.2.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.9.m9.2.2.2.2.3.1b" xref="S3.p1.9.m9.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.9.m9.2.2.2.2.3.5" xref="S3.p1.9.m9.2.2.2.2.3.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.p1.9.m9.2.2.2.5" xref="S3.p1.9.m9.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.2b"><interval closure="open" id="S3.p1.9.m9.2.2.3.cmml" xref="S3.p1.9.m9.2.2.2"><apply id="S3.p1.9.m9.1.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.9.m9.1.1.1.1.1.cmml" xref="S3.p1.9.m9.1.1.1.1">subscript</csymbol><ci id="S3.p1.9.m9.1.1.1.1.2.cmml" xref="S3.p1.9.m9.1.1.1.1.2">𝑖</ci><apply id="S3.p1.9.m9.1.1.1.1.3.cmml" xref="S3.p1.9.m9.1.1.1.1.3"><times id="S3.p1.9.m9.1.1.1.1.3.1.cmml" xref="S3.p1.9.m9.1.1.1.1.3.1"></times><ci id="S3.p1.9.m9.1.1.1.1.3.2.cmml" xref="S3.p1.9.m9.1.1.1.1.3.2">𝑡</ci><ci id="S3.p1.9.m9.1.1.1.1.3.3.cmml" xref="S3.p1.9.m9.1.1.1.1.3.3">𝑒</ci><ci id="S3.p1.9.m9.1.1.1.1.3.4.cmml" xref="S3.p1.9.m9.1.1.1.1.3.4">𝑠</ci><ci id="S3.p1.9.m9.1.1.1.1.3.5.cmml" xref="S3.p1.9.m9.1.1.1.1.3.5">𝑡</ci></apply></apply><apply id="S3.p1.9.m9.2.2.2.2.cmml" xref="S3.p1.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.9.m9.2.2.2.2.1.cmml" xref="S3.p1.9.m9.2.2.2.2">subscript</csymbol><ci id="S3.p1.9.m9.2.2.2.2.2.cmml" xref="S3.p1.9.m9.2.2.2.2.2">𝑞</ci><apply id="S3.p1.9.m9.2.2.2.2.3.cmml" xref="S3.p1.9.m9.2.2.2.2.3"><times id="S3.p1.9.m9.2.2.2.2.3.1.cmml" xref="S3.p1.9.m9.2.2.2.2.3.1"></times><ci id="S3.p1.9.m9.2.2.2.2.3.2.cmml" xref="S3.p1.9.m9.2.2.2.2.3.2">𝑡</ci><ci id="S3.p1.9.m9.2.2.2.2.3.3.cmml" xref="S3.p1.9.m9.2.2.2.2.3.3">𝑒</ci><ci id="S3.p1.9.m9.2.2.2.2.3.4.cmml" xref="S3.p1.9.m9.2.2.2.2.3.4">𝑠</ci><ci id="S3.p1.9.m9.2.2.2.2.3.5.cmml" xref="S3.p1.9.m9.2.2.2.2.3.5">𝑡</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.2c">(i_{test},q_{test})</annotation></semantics></math>:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.45" class="ltx_Math" alttext="\begin{split}f(i,q)\underbrace{\simeq}_{\text{best linear fit}}f(i_{test},q_{test})\qquad\qquad\qquad\\
+[i-i_{test},q-q_{test}]^{\intercal}\nabla f(i_{test},q_{test})&amp;\end{split}" display="block"><semantics id="S3.E1.m1.45a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E1.m1.45.45.7"><mtr id="S3.E1.m1.45.45.7a"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.45.45.7b"><mrow id="S3.E1.m1.41.41.3.39.17.17.17"><mrow id="S3.E1.m1.41.41.3.39.17.17.17.1"><mi id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.41.41.3.39.17.17.17.1.3" xref="S3.E1.m1.40.40.2.3.cmml">​</mo><mrow id="S3.E1.m1.41.41.3.39.17.17.17.1.4"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.40.40.2.3.cmml">(</mo><mi id="S3.E1.m1.3.3.3.3.3.3" xref="S3.E1.m1.3.3.3.3.3.3.cmml">i</mi><mo id="S3.E1.m1.4.4.4.4.4.4" xref="S3.E1.m1.40.40.2.3.cmml">,</mo><mi id="S3.E1.m1.5.5.5.5.5.5" xref="S3.E1.m1.5.5.5.5.5.5.cmml">q</mi><mo stretchy="false" id="S3.E1.m1.6.6.6.6.6.6" xref="S3.E1.m1.40.40.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.41.41.3.39.17.17.17.1.3a" xref="S3.E1.m1.40.40.2.3.cmml">​</mo><munder id="S3.E1.m1.41.41.3.39.17.17.17.1.5"><munder accentunder="true" id="S3.E1.m1.7.7.7.7.7.7" xref="S3.E1.m1.7.7.7.7.7.7.cmml"><mo id="S3.E1.m1.7.7.7.7.7.7.2" xref="S3.E1.m1.7.7.7.7.7.7.2.cmml">≃</mo><mo id="S3.E1.m1.7.7.7.7.7.7.1" xref="S3.E1.m1.7.7.7.7.7.7.1.cmml">⏟</mo></munder><mtext id="S3.E1.m1.8.8.8.8.8.8.1" xref="S3.E1.m1.8.8.8.8.8.8.1a.cmml">best linear fit</mtext></munder><mo lspace="0em" rspace="0em" id="S3.E1.m1.41.41.3.39.17.17.17.1.3b" xref="S3.E1.m1.40.40.2.3.cmml">​</mo><mi id="S3.E1.m1.9.9.9.9.9.9" xref="S3.E1.m1.9.9.9.9.9.9.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.41.41.3.39.17.17.17.1.3c" xref="S3.E1.m1.40.40.2.3.cmml">​</mo><mrow id="S3.E1.m1.41.41.3.39.17.17.17.1.2.2"><mo stretchy="false" id="S3.E1.m1.10.10.10.10.10.10" xref="S3.E1.m1.40.40.2.3.cmml">(</mo><msub id="S3.E1.m1.41.41.3.39.17.17.17.1.1.1.1"><mi id="S3.E1.m1.11.11.11.11.11.11" xref="S3.E1.m1.11.11.11.11.11.11.cmml">i</mi><mrow id="S3.E1.m1.12.12.12.12.12.12.1" xref="S3.E1.m1.12.12.12.12.12.12.1.cmml"><mi id="S3.E1.m1.12.12.12.12.12.12.1.2" xref="S3.E1.m1.12.12.12.12.12.12.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.12.12.12.12.12.12.1.1" xref="S3.E1.m1.12.12.12.12.12.12.1.1.cmml">​</mo><mi id="S3.E1.m1.12.12.12.12.12.12.1.3" xref="S3.E1.m1.12.12.12.12.12.12.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.12.12.12.12.12.12.1.1a" xref="S3.E1.m1.12.12.12.12.12.12.1.1.cmml">​</mo><mi id="S3.E1.m1.12.12.12.12.12.12.1.4" xref="S3.E1.m1.12.12.12.12.12.12.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.12.12.12.12.12.12.1.1b" xref="S3.E1.m1.12.12.12.12.12.12.1.1.cmml">​</mo><mi id="S3.E1.m1.12.12.12.12.12.12.1.5" xref="S3.E1.m1.12.12.12.12.12.12.1.5.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.13.13.13.13.13.13" xref="S3.E1.m1.40.40.2.3.cmml">,</mo><msub id="S3.E1.m1.41.41.3.39.17.17.17.1.2.2.2"><mi id="S3.E1.m1.14.14.14.14.14.14" xref="S3.E1.m1.14.14.14.14.14.14.cmml">q</mi><mrow id="S3.E1.m1.15.15.15.15.15.15.1" xref="S3.E1.m1.15.15.15.15.15.15.1.cmml"><mi id="S3.E1.m1.15.15.15.15.15.15.1.2" xref="S3.E1.m1.15.15.15.15.15.15.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.15.15.15.15.15.15.1.1" xref="S3.E1.m1.15.15.15.15.15.15.1.1.cmml">​</mo><mi id="S3.E1.m1.15.15.15.15.15.15.1.3" xref="S3.E1.m1.15.15.15.15.15.15.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.15.15.15.15.15.15.1.1a" xref="S3.E1.m1.15.15.15.15.15.15.1.1.cmml">​</mo><mi id="S3.E1.m1.15.15.15.15.15.15.1.4" xref="S3.E1.m1.15.15.15.15.15.15.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.15.15.15.15.15.15.1.1b" xref="S3.E1.m1.15.15.15.15.15.15.1.1.cmml">​</mo><mi id="S3.E1.m1.15.15.15.15.15.15.1.5" xref="S3.E1.m1.15.15.15.15.15.15.1.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.16.16.16.16.16.16" xref="S3.E1.m1.40.40.2.3.cmml">)</mo></mrow></mrow><mspace width="6em" id="S3.E1.m1.41.41.3.39.17.17.17.2" xref="S3.E1.m1.40.40.2.3.cmml"></mspace></mrow></mtd></mtr><mtr id="S3.E1.m1.45.45.7c"><mtd class="ltx_align_right" columnalign="right" id="S3.E1.m1.45.45.7d"><mrow id="S3.E1.m1.45.45.7.43.26.26"><mo id="S3.E1.m1.45.45.7.43.26.26a" xref="S3.E1.m1.40.40.2.3.cmml">+</mo><mrow id="S3.E1.m1.45.45.7.43.26.26.26"><msup id="S3.E1.m1.43.43.5.41.24.24.24.2"><mrow id="S3.E1.m1.43.43.5.41.24.24.24.2.2.2"><mo stretchy="false" id="S3.E1.m1.18.18.18.2.2.2" xref="S3.E1.m1.40.40.2.3.cmml">[</mo><mrow id="S3.E1.m1.42.42.4.40.23.23.23.1.1.1.1"><mi id="S3.E1.m1.19.19.19.3.3.3" xref="S3.E1.m1.19.19.19.3.3.3.cmml">i</mi><mo id="S3.E1.m1.20.20.20.4.4.4" xref="S3.E1.m1.20.20.20.4.4.4.cmml">−</mo><msub id="S3.E1.m1.42.42.4.40.23.23.23.1.1.1.1.1"><mi id="S3.E1.m1.21.21.21.5.5.5" xref="S3.E1.m1.21.21.21.5.5.5.cmml">i</mi><mrow id="S3.E1.m1.22.22.22.6.6.6.1" xref="S3.E1.m1.22.22.22.6.6.6.1.cmml"><mi id="S3.E1.m1.22.22.22.6.6.6.1.2" xref="S3.E1.m1.22.22.22.6.6.6.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.22.22.22.6.6.6.1.1" xref="S3.E1.m1.22.22.22.6.6.6.1.1.cmml">​</mo><mi id="S3.E1.m1.22.22.22.6.6.6.1.3" xref="S3.E1.m1.22.22.22.6.6.6.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.22.22.22.6.6.6.1.1a" xref="S3.E1.m1.22.22.22.6.6.6.1.1.cmml">​</mo><mi id="S3.E1.m1.22.22.22.6.6.6.1.4" xref="S3.E1.m1.22.22.22.6.6.6.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.22.22.22.6.6.6.1.1b" xref="S3.E1.m1.22.22.22.6.6.6.1.1.cmml">​</mo><mi id="S3.E1.m1.22.22.22.6.6.6.1.5" xref="S3.E1.m1.22.22.22.6.6.6.1.5.cmml">t</mi></mrow></msub></mrow><mo id="S3.E1.m1.23.23.23.7.7.7" xref="S3.E1.m1.40.40.2.3.cmml">,</mo><mrow id="S3.E1.m1.43.43.5.41.24.24.24.2.2.2.2"><mi id="S3.E1.m1.24.24.24.8.8.8" xref="S3.E1.m1.24.24.24.8.8.8.cmml">q</mi><mo id="S3.E1.m1.25.25.25.9.9.9" xref="S3.E1.m1.25.25.25.9.9.9.cmml">−</mo><msub id="S3.E1.m1.43.43.5.41.24.24.24.2.2.2.2.1"><mi id="S3.E1.m1.26.26.26.10.10.10" xref="S3.E1.m1.26.26.26.10.10.10.cmml">q</mi><mrow id="S3.E1.m1.27.27.27.11.11.11.1" xref="S3.E1.m1.27.27.27.11.11.11.1.cmml"><mi id="S3.E1.m1.27.27.27.11.11.11.1.2" xref="S3.E1.m1.27.27.27.11.11.11.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.27.27.27.11.11.11.1.1" xref="S3.E1.m1.27.27.27.11.11.11.1.1.cmml">​</mo><mi id="S3.E1.m1.27.27.27.11.11.11.1.3" xref="S3.E1.m1.27.27.27.11.11.11.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.27.27.27.11.11.11.1.1a" xref="S3.E1.m1.27.27.27.11.11.11.1.1.cmml">​</mo><mi id="S3.E1.m1.27.27.27.11.11.11.1.4" xref="S3.E1.m1.27.27.27.11.11.11.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.27.27.27.11.11.11.1.1b" xref="S3.E1.m1.27.27.27.11.11.11.1.1.cmml">​</mo><mi id="S3.E1.m1.27.27.27.11.11.11.1.5" xref="S3.E1.m1.27.27.27.11.11.11.1.5.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E1.m1.28.28.28.12.12.12" xref="S3.E1.m1.40.40.2.3.cmml">]</mo></mrow><mo id="S3.E1.m1.29.29.29.13.13.13.1" xref="S3.E1.m1.29.29.29.13.13.13.1.cmml">⊺</mo></msup><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.45.45.7.43.26.26.26.5" xref="S3.E1.m1.40.40.2.3.cmml">​</mo><mrow id="S3.E1.m1.45.45.7.43.26.26.26.6"><mo rspace="0.167em" id="S3.E1.m1.30.30.30.14.14.14" xref="S3.E1.m1.30.30.30.14.14.14.cmml">∇</mo><mi id="S3.E1.m1.31.31.31.15.15.15" xref="S3.E1.m1.31.31.31.15.15.15.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.45.45.7.43.26.26.26.5a" xref="S3.E1.m1.40.40.2.3.cmml">​</mo><mrow id="S3.E1.m1.45.45.7.43.26.26.26.4.2"><mo stretchy="false" id="S3.E1.m1.32.32.32.16.16.16" xref="S3.E1.m1.40.40.2.3.cmml">(</mo><msub id="S3.E1.m1.44.44.6.42.25.25.25.3.1.1"><mi id="S3.E1.m1.33.33.33.17.17.17" xref="S3.E1.m1.33.33.33.17.17.17.cmml">i</mi><mrow id="S3.E1.m1.34.34.34.18.18.18.1" xref="S3.E1.m1.34.34.34.18.18.18.1.cmml"><mi id="S3.E1.m1.34.34.34.18.18.18.1.2" xref="S3.E1.m1.34.34.34.18.18.18.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.34.18.18.18.1.1" xref="S3.E1.m1.34.34.34.18.18.18.1.1.cmml">​</mo><mi id="S3.E1.m1.34.34.34.18.18.18.1.3" xref="S3.E1.m1.34.34.34.18.18.18.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.34.18.18.18.1.1a" xref="S3.E1.m1.34.34.34.18.18.18.1.1.cmml">​</mo><mi id="S3.E1.m1.34.34.34.18.18.18.1.4" xref="S3.E1.m1.34.34.34.18.18.18.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.34.34.34.18.18.18.1.1b" xref="S3.E1.m1.34.34.34.18.18.18.1.1.cmml">​</mo><mi id="S3.E1.m1.34.34.34.18.18.18.1.5" xref="S3.E1.m1.34.34.34.18.18.18.1.5.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.35.35.35.19.19.19" xref="S3.E1.m1.40.40.2.3.cmml">,</mo><msub id="S3.E1.m1.45.45.7.43.26.26.26.4.2.2"><mi id="S3.E1.m1.36.36.36.20.20.20" xref="S3.E1.m1.36.36.36.20.20.20.cmml">q</mi><mrow id="S3.E1.m1.37.37.37.21.21.21.1" xref="S3.E1.m1.37.37.37.21.21.21.1.cmml"><mi id="S3.E1.m1.37.37.37.21.21.21.1.2" xref="S3.E1.m1.37.37.37.21.21.21.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.37.37.37.21.21.21.1.1" xref="S3.E1.m1.37.37.37.21.21.21.1.1.cmml">​</mo><mi id="S3.E1.m1.37.37.37.21.21.21.1.3" xref="S3.E1.m1.37.37.37.21.21.21.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.37.37.37.21.21.21.1.1a" xref="S3.E1.m1.37.37.37.21.21.21.1.1.cmml">​</mo><mi id="S3.E1.m1.37.37.37.21.21.21.1.4" xref="S3.E1.m1.37.37.37.21.21.21.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.37.37.37.21.21.21.1.1b" xref="S3.E1.m1.37.37.37.21.21.21.1.1.cmml">​</mo><mi id="S3.E1.m1.37.37.37.21.21.21.1.5" xref="S3.E1.m1.37.37.37.21.21.21.1.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.E1.m1.38.38.38.22.22.22" xref="S3.E1.m1.40.40.2.3.cmml">)</mo></mrow></mrow></mrow></mtd><mtd id="S3.E1.m1.45.45.7e" xref="S3.E1.m1.40.40.2.3.cmml"></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E1.m1.45b"><list id="S3.E1.m1.40.40.2.3.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><apply id="S3.E1.m1.39.39.1.1.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><times id="S3.E1.m1.39.39.1.1.1.3.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"></times><ci id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">𝑓</ci><interval closure="open" id="S3.E1.m1.39.39.1.1.1.5.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><ci id="S3.E1.m1.3.3.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3.3.3">𝑖</ci><ci id="S3.E1.m1.5.5.5.5.5.5.cmml" xref="S3.E1.m1.5.5.5.5.5.5">𝑞</ci></interval><apply id="S3.E1.m1.39.39.1.1.1.6.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.39.39.1.1.1.6.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3">subscript</csymbol><apply id="S3.E1.m1.7.7.7.7.7.7.cmml" xref="S3.E1.m1.7.7.7.7.7.7"><ci id="S3.E1.m1.7.7.7.7.7.7.1.cmml" xref="S3.E1.m1.7.7.7.7.7.7.1">⏟</ci><csymbol cd="latexml" id="S3.E1.m1.7.7.7.7.7.7.2.cmml" xref="S3.E1.m1.7.7.7.7.7.7.2">similar-to-or-equals</csymbol></apply><ci id="S3.E1.m1.8.8.8.8.8.8.1a.cmml" xref="S3.E1.m1.8.8.8.8.8.8.1"><mtext mathsize="70%" id="S3.E1.m1.8.8.8.8.8.8.1.cmml" xref="S3.E1.m1.8.8.8.8.8.8.1">best linear fit</mtext></ci></apply><ci id="S3.E1.m1.9.9.9.9.9.9.cmml" xref="S3.E1.m1.9.9.9.9.9.9">𝑓</ci><interval closure="open" id="S3.E1.m1.39.39.1.1.1.2.3.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><apply id="S3.E1.m1.39.39.1.1.1.1.1.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.39.39.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3">subscript</csymbol><ci id="S3.E1.m1.11.11.11.11.11.11.cmml" xref="S3.E1.m1.11.11.11.11.11.11">𝑖</ci><apply id="S3.E1.m1.12.12.12.12.12.12.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1"><times id="S3.E1.m1.12.12.12.12.12.12.1.1.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.1"></times><ci id="S3.E1.m1.12.12.12.12.12.12.1.2.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.2">𝑡</ci><ci id="S3.E1.m1.12.12.12.12.12.12.1.3.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.3">𝑒</ci><ci id="S3.E1.m1.12.12.12.12.12.12.1.4.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.4">𝑠</ci><ci id="S3.E1.m1.12.12.12.12.12.12.1.5.cmml" xref="S3.E1.m1.12.12.12.12.12.12.1.5">𝑡</ci></apply></apply><apply id="S3.E1.m1.39.39.1.1.1.2.2.2.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.39.39.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3">subscript</csymbol><ci id="S3.E1.m1.14.14.14.14.14.14.cmml" xref="S3.E1.m1.14.14.14.14.14.14">𝑞</ci><apply id="S3.E1.m1.15.15.15.15.15.15.1.cmml" xref="S3.E1.m1.15.15.15.15.15.15.1"><times id="S3.E1.m1.15.15.15.15.15.15.1.1.cmml" xref="S3.E1.m1.15.15.15.15.15.15.1.1"></times><ci id="S3.E1.m1.15.15.15.15.15.15.1.2.cmml" xref="S3.E1.m1.15.15.15.15.15.15.1.2">𝑡</ci><ci id="S3.E1.m1.15.15.15.15.15.15.1.3.cmml" xref="S3.E1.m1.15.15.15.15.15.15.1.3">𝑒</ci><ci id="S3.E1.m1.15.15.15.15.15.15.1.4.cmml" xref="S3.E1.m1.15.15.15.15.15.15.1.4">𝑠</ci><ci id="S3.E1.m1.15.15.15.15.15.15.1.5.cmml" xref="S3.E1.m1.15.15.15.15.15.15.1.5">𝑡</ci></apply></apply></interval></apply><apply id="S3.E1.m1.40.40.2.2.2.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><plus id="S3.E1.m1.17.17.17.1.1.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"></plus><apply id="S3.E1.m1.40.40.2.2.2.4.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><times id="S3.E1.m1.40.40.2.2.2.4.5.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"></times><apply id="S3.E1.m1.40.40.2.2.2.2.2.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.40.40.2.2.2.2.2.3.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3">superscript</csymbol><interval closure="closed" id="S3.E1.m1.40.40.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><apply id="S3.E1.m1.40.40.2.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><minus id="S3.E1.m1.20.20.20.4.4.4.cmml" xref="S3.E1.m1.20.20.20.4.4.4"></minus><ci id="S3.E1.m1.19.19.19.3.3.3.cmml" xref="S3.E1.m1.19.19.19.3.3.3">𝑖</ci><apply id="S3.E1.m1.40.40.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.40.40.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3">subscript</csymbol><ci id="S3.E1.m1.21.21.21.5.5.5.cmml" xref="S3.E1.m1.21.21.21.5.5.5">𝑖</ci><apply id="S3.E1.m1.22.22.22.6.6.6.1.cmml" xref="S3.E1.m1.22.22.22.6.6.6.1"><times id="S3.E1.m1.22.22.22.6.6.6.1.1.cmml" xref="S3.E1.m1.22.22.22.6.6.6.1.1"></times><ci id="S3.E1.m1.22.22.22.6.6.6.1.2.cmml" xref="S3.E1.m1.22.22.22.6.6.6.1.2">𝑡</ci><ci id="S3.E1.m1.22.22.22.6.6.6.1.3.cmml" xref="S3.E1.m1.22.22.22.6.6.6.1.3">𝑒</ci><ci id="S3.E1.m1.22.22.22.6.6.6.1.4.cmml" xref="S3.E1.m1.22.22.22.6.6.6.1.4">𝑠</ci><ci id="S3.E1.m1.22.22.22.6.6.6.1.5.cmml" xref="S3.E1.m1.22.22.22.6.6.6.1.5">𝑡</ci></apply></apply></apply><apply id="S3.E1.m1.40.40.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><minus id="S3.E1.m1.25.25.25.9.9.9.cmml" xref="S3.E1.m1.25.25.25.9.9.9"></minus><ci id="S3.E1.m1.24.24.24.8.8.8.cmml" xref="S3.E1.m1.24.24.24.8.8.8">𝑞</ci><apply id="S3.E1.m1.40.40.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.40.40.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3">subscript</csymbol><ci id="S3.E1.m1.26.26.26.10.10.10.cmml" xref="S3.E1.m1.26.26.26.10.10.10">𝑞</ci><apply id="S3.E1.m1.27.27.27.11.11.11.1.cmml" xref="S3.E1.m1.27.27.27.11.11.11.1"><times id="S3.E1.m1.27.27.27.11.11.11.1.1.cmml" xref="S3.E1.m1.27.27.27.11.11.11.1.1"></times><ci id="S3.E1.m1.27.27.27.11.11.11.1.2.cmml" xref="S3.E1.m1.27.27.27.11.11.11.1.2">𝑡</ci><ci id="S3.E1.m1.27.27.27.11.11.11.1.3.cmml" xref="S3.E1.m1.27.27.27.11.11.11.1.3">𝑒</ci><ci id="S3.E1.m1.27.27.27.11.11.11.1.4.cmml" xref="S3.E1.m1.27.27.27.11.11.11.1.4">𝑠</ci><ci id="S3.E1.m1.27.27.27.11.11.11.1.5.cmml" xref="S3.E1.m1.27.27.27.11.11.11.1.5">𝑡</ci></apply></apply></apply></interval><ci id="S3.E1.m1.29.29.29.13.13.13.1.cmml" xref="S3.E1.m1.29.29.29.13.13.13.1">⊺</ci></apply><apply id="S3.E1.m1.40.40.2.2.2.4.6.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><ci id="S3.E1.m1.30.30.30.14.14.14.cmml" xref="S3.E1.m1.30.30.30.14.14.14">∇</ci><ci id="S3.E1.m1.31.31.31.15.15.15.cmml" xref="S3.E1.m1.31.31.31.15.15.15">𝑓</ci></apply><interval closure="open" id="S3.E1.m1.40.40.2.2.2.4.4.3.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><apply id="S3.E1.m1.40.40.2.2.2.3.3.1.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.40.40.2.2.2.3.3.1.1.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3">subscript</csymbol><ci id="S3.E1.m1.33.33.33.17.17.17.cmml" xref="S3.E1.m1.33.33.33.17.17.17">𝑖</ci><apply id="S3.E1.m1.34.34.34.18.18.18.1.cmml" xref="S3.E1.m1.34.34.34.18.18.18.1"><times id="S3.E1.m1.34.34.34.18.18.18.1.1.cmml" xref="S3.E1.m1.34.34.34.18.18.18.1.1"></times><ci id="S3.E1.m1.34.34.34.18.18.18.1.2.cmml" xref="S3.E1.m1.34.34.34.18.18.18.1.2">𝑡</ci><ci id="S3.E1.m1.34.34.34.18.18.18.1.3.cmml" xref="S3.E1.m1.34.34.34.18.18.18.1.3">𝑒</ci><ci id="S3.E1.m1.34.34.34.18.18.18.1.4.cmml" xref="S3.E1.m1.34.34.34.18.18.18.1.4">𝑠</ci><ci id="S3.E1.m1.34.34.34.18.18.18.1.5.cmml" xref="S3.E1.m1.34.34.34.18.18.18.1.5">𝑡</ci></apply></apply><apply id="S3.E1.m1.40.40.2.2.2.4.4.2.2.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.40.40.2.2.2.4.4.2.2.1.cmml" xref="S3.E1.m1.41.41.3.39.17.17.17.1.3">subscript</csymbol><ci id="S3.E1.m1.36.36.36.20.20.20.cmml" xref="S3.E1.m1.36.36.36.20.20.20">𝑞</ci><apply id="S3.E1.m1.37.37.37.21.21.21.1.cmml" xref="S3.E1.m1.37.37.37.21.21.21.1"><times id="S3.E1.m1.37.37.37.21.21.21.1.1.cmml" xref="S3.E1.m1.37.37.37.21.21.21.1.1"></times><ci id="S3.E1.m1.37.37.37.21.21.21.1.2.cmml" xref="S3.E1.m1.37.37.37.21.21.21.1.2">𝑡</ci><ci id="S3.E1.m1.37.37.37.21.21.21.1.3.cmml" xref="S3.E1.m1.37.37.37.21.21.21.1.3">𝑒</ci><ci id="S3.E1.m1.37.37.37.21.21.21.1.4.cmml" xref="S3.E1.m1.37.37.37.21.21.21.1.4">𝑠</ci><ci id="S3.E1.m1.37.37.37.21.21.21.1.5.cmml" xref="S3.E1.m1.37.37.37.21.21.21.1.5">𝑡</ci></apply></apply></interval></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.45c">\begin{split}f(i,q)\underbrace{\simeq}_{\text{best linear fit}}f(i_{test},q_{test})\qquad\qquad\qquad\\
+[i-i_{test},q-q_{test}]^{\intercal}\nabla f(i_{test},q_{test})&amp;\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.11" class="ltx_p">Intuitively, the two key quantities we need to compute are
<math id="S3.p1.10.m1.2" class="ltx_Math" alttext="\partial f(i_{test},q_{test})/\partial i" display="inline"><semantics id="S3.p1.10.m1.2a"><mrow id="S3.p1.10.m1.2.2" xref="S3.p1.10.m1.2.2.cmml"><mo rspace="0em" id="S3.p1.10.m1.2.2.3" xref="S3.p1.10.m1.2.2.3.cmml">∂</mo><mrow id="S3.p1.10.m1.2.2.2" xref="S3.p1.10.m1.2.2.2.cmml"><mrow id="S3.p1.10.m1.2.2.2.2" xref="S3.p1.10.m1.2.2.2.2.cmml"><mi id="S3.p1.10.m1.2.2.2.2.4" xref="S3.p1.10.m1.2.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m1.2.2.2.2.3" xref="S3.p1.10.m1.2.2.2.2.3.cmml">​</mo><mrow id="S3.p1.10.m1.2.2.2.2.2.2" xref="S3.p1.10.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p1.10.m1.2.2.2.2.2.2.3" xref="S3.p1.10.m1.2.2.2.2.2.3.cmml">(</mo><msub id="S3.p1.10.m1.1.1.1.1.1.1.1" xref="S3.p1.10.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.10.m1.1.1.1.1.1.1.1.2" xref="S3.p1.10.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mrow id="S3.p1.10.m1.1.1.1.1.1.1.1.3" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.10.m1.1.1.1.1.1.1.1.3.2" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m1.1.1.1.1.1.1.1.3.1" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.10.m1.1.1.1.1.1.1.1.3.3" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m1.1.1.1.1.1.1.1.3.1a" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.10.m1.1.1.1.1.1.1.1.3.4" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m1.1.1.1.1.1.1.1.3.1b" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.10.m1.1.1.1.1.1.1.1.3.5" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.5.cmml">t</mi></mrow></msub><mo id="S3.p1.10.m1.2.2.2.2.2.2.4" xref="S3.p1.10.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S3.p1.10.m1.2.2.2.2.2.2.2" xref="S3.p1.10.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.p1.10.m1.2.2.2.2.2.2.2.2" xref="S3.p1.10.m1.2.2.2.2.2.2.2.2.cmml">q</mi><mrow id="S3.p1.10.m1.2.2.2.2.2.2.2.3" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S3.p1.10.m1.2.2.2.2.2.2.2.3.2" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m1.2.2.2.2.2.2.2.3.1" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.10.m1.2.2.2.2.2.2.2.3.3" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m1.2.2.2.2.2.2.2.3.1a" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.10.m1.2.2.2.2.2.2.2.3.4" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.10.m1.2.2.2.2.2.2.2.3.1b" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.10.m1.2.2.2.2.2.2.2.3.5" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.p1.10.m1.2.2.2.2.2.2.5" xref="S3.p1.10.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.p1.10.m1.2.2.2.3" xref="S3.p1.10.m1.2.2.2.3.cmml">/</mo><mrow id="S3.p1.10.m1.2.2.2.4" xref="S3.p1.10.m1.2.2.2.4.cmml"><mo lspace="0em" rspace="0em" id="S3.p1.10.m1.2.2.2.4.1" xref="S3.p1.10.m1.2.2.2.4.1.cmml">∂</mo><mi id="S3.p1.10.m1.2.2.2.4.2" xref="S3.p1.10.m1.2.2.2.4.2.cmml">i</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.10.m1.2b"><apply id="S3.p1.10.m1.2.2.cmml" xref="S3.p1.10.m1.2.2"><partialdiff id="S3.p1.10.m1.2.2.3.cmml" xref="S3.p1.10.m1.2.2.3"></partialdiff><apply id="S3.p1.10.m1.2.2.2.cmml" xref="S3.p1.10.m1.2.2.2"><divide id="S3.p1.10.m1.2.2.2.3.cmml" xref="S3.p1.10.m1.2.2.2.3"></divide><apply id="S3.p1.10.m1.2.2.2.2.cmml" xref="S3.p1.10.m1.2.2.2.2"><times id="S3.p1.10.m1.2.2.2.2.3.cmml" xref="S3.p1.10.m1.2.2.2.2.3"></times><ci id="S3.p1.10.m1.2.2.2.2.4.cmml" xref="S3.p1.10.m1.2.2.2.2.4">𝑓</ci><interval closure="open" id="S3.p1.10.m1.2.2.2.2.2.3.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2"><apply id="S3.p1.10.m1.1.1.1.1.1.1.1.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.p1.10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3"><times id="S3.p1.10.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.p1.10.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S3.p1.10.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S3.p1.10.m1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.4">𝑠</ci><ci id="S3.p1.10.m1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.p1.10.m1.1.1.1.1.1.1.1.3.5">𝑡</ci></apply></apply><apply id="S3.p1.10.m1.2.2.2.2.2.2.2.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.10.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.10.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2.2">𝑞</ci><apply id="S3.p1.10.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3"><times id="S3.p1.10.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.1"></times><ci id="S3.p1.10.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.2">𝑡</ci><ci id="S3.p1.10.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.3">𝑒</ci><ci id="S3.p1.10.m1.2.2.2.2.2.2.2.3.4.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.4">𝑠</ci><ci id="S3.p1.10.m1.2.2.2.2.2.2.2.3.5.cmml" xref="S3.p1.10.m1.2.2.2.2.2.2.2.3.5">𝑡</ci></apply></apply></interval></apply><apply id="S3.p1.10.m1.2.2.2.4.cmml" xref="S3.p1.10.m1.2.2.2.4"><partialdiff id="S3.p1.10.m1.2.2.2.4.1.cmml" xref="S3.p1.10.m1.2.2.2.4.1"></partialdiff><ci id="S3.p1.10.m1.2.2.2.4.2.cmml" xref="S3.p1.10.m1.2.2.2.4.2">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m1.2c">\partial f(i_{test},q_{test})/\partial i</annotation></semantics></math>
and
<math id="S3.p1.11.m2.2" class="ltx_Math" alttext="\partial f(i_{test},q_{test})/\partial q" display="inline"><semantics id="S3.p1.11.m2.2a"><mrow id="S3.p1.11.m2.2.2" xref="S3.p1.11.m2.2.2.cmml"><mo rspace="0em" id="S3.p1.11.m2.2.2.3" xref="S3.p1.11.m2.2.2.3.cmml">∂</mo><mrow id="S3.p1.11.m2.2.2.2" xref="S3.p1.11.m2.2.2.2.cmml"><mrow id="S3.p1.11.m2.2.2.2.2" xref="S3.p1.11.m2.2.2.2.2.cmml"><mi id="S3.p1.11.m2.2.2.2.2.4" xref="S3.p1.11.m2.2.2.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p1.11.m2.2.2.2.2.3" xref="S3.p1.11.m2.2.2.2.2.3.cmml">​</mo><mrow id="S3.p1.11.m2.2.2.2.2.2.2" xref="S3.p1.11.m2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p1.11.m2.2.2.2.2.2.2.3" xref="S3.p1.11.m2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.p1.11.m2.1.1.1.1.1.1.1" xref="S3.p1.11.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.p1.11.m2.1.1.1.1.1.1.1.2" xref="S3.p1.11.m2.1.1.1.1.1.1.1.2.cmml">i</mi><mrow id="S3.p1.11.m2.1.1.1.1.1.1.1.3" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.11.m2.1.1.1.1.1.1.1.3.2" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p1.11.m2.1.1.1.1.1.1.1.3.1" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.11.m2.1.1.1.1.1.1.1.3.3" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p1.11.m2.1.1.1.1.1.1.1.3.1a" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.11.m2.1.1.1.1.1.1.1.3.4" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.11.m2.1.1.1.1.1.1.1.3.1b" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p1.11.m2.1.1.1.1.1.1.1.3.5" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.5.cmml">t</mi></mrow></msub><mo id="S3.p1.11.m2.2.2.2.2.2.2.4" xref="S3.p1.11.m2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.p1.11.m2.2.2.2.2.2.2.2" xref="S3.p1.11.m2.2.2.2.2.2.2.2.cmml"><mi id="S3.p1.11.m2.2.2.2.2.2.2.2.2" xref="S3.p1.11.m2.2.2.2.2.2.2.2.2.cmml">q</mi><mrow id="S3.p1.11.m2.2.2.2.2.2.2.2.3" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.p1.11.m2.2.2.2.2.2.2.2.3.2" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p1.11.m2.2.2.2.2.2.2.2.3.1" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.11.m2.2.2.2.2.2.2.2.3.3" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p1.11.m2.2.2.2.2.2.2.2.3.1a" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.11.m2.2.2.2.2.2.2.2.3.4" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.11.m2.2.2.2.2.2.2.2.3.1b" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.p1.11.m2.2.2.2.2.2.2.2.3.5" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.p1.11.m2.2.2.2.2.2.2.5" xref="S3.p1.11.m2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.p1.11.m2.2.2.2.3" xref="S3.p1.11.m2.2.2.2.3.cmml">/</mo><mrow id="S3.p1.11.m2.2.2.2.4" xref="S3.p1.11.m2.2.2.2.4.cmml"><mo lspace="0em" rspace="0em" id="S3.p1.11.m2.2.2.2.4.1" xref="S3.p1.11.m2.2.2.2.4.1.cmml">∂</mo><mi id="S3.p1.11.m2.2.2.2.4.2" xref="S3.p1.11.m2.2.2.2.4.2.cmml">q</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.11.m2.2b"><apply id="S3.p1.11.m2.2.2.cmml" xref="S3.p1.11.m2.2.2"><partialdiff id="S3.p1.11.m2.2.2.3.cmml" xref="S3.p1.11.m2.2.2.3"></partialdiff><apply id="S3.p1.11.m2.2.2.2.cmml" xref="S3.p1.11.m2.2.2.2"><divide id="S3.p1.11.m2.2.2.2.3.cmml" xref="S3.p1.11.m2.2.2.2.3"></divide><apply id="S3.p1.11.m2.2.2.2.2.cmml" xref="S3.p1.11.m2.2.2.2.2"><times id="S3.p1.11.m2.2.2.2.2.3.cmml" xref="S3.p1.11.m2.2.2.2.2.3"></times><ci id="S3.p1.11.m2.2.2.2.2.4.cmml" xref="S3.p1.11.m2.2.2.2.2.4">𝑓</ci><interval closure="open" id="S3.p1.11.m2.2.2.2.2.2.3.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2"><apply id="S3.p1.11.m2.1.1.1.1.1.1.1.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.11.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.11.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.p1.11.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3"><times id="S3.p1.11.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.1"></times><ci id="S3.p1.11.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.2">𝑡</ci><ci id="S3.p1.11.m2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.3">𝑒</ci><ci id="S3.p1.11.m2.1.1.1.1.1.1.1.3.4.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.4">𝑠</ci><ci id="S3.p1.11.m2.1.1.1.1.1.1.1.3.5.cmml" xref="S3.p1.11.m2.1.1.1.1.1.1.1.3.5">𝑡</ci></apply></apply><apply id="S3.p1.11.m2.2.2.2.2.2.2.2.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.11.m2.2.2.2.2.2.2.2.1.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p1.11.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2.2">𝑞</ci><apply id="S3.p1.11.m2.2.2.2.2.2.2.2.3.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3"><times id="S3.p1.11.m2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.1"></times><ci id="S3.p1.11.m2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.2">𝑡</ci><ci id="S3.p1.11.m2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.3">𝑒</ci><ci id="S3.p1.11.m2.2.2.2.2.2.2.2.3.4.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.4">𝑠</ci><ci id="S3.p1.11.m2.2.2.2.2.2.2.2.3.5.cmml" xref="S3.p1.11.m2.2.2.2.2.2.2.2.3.5">𝑡</ci></apply></apply></interval></apply><apply id="S3.p1.11.m2.2.2.2.4.cmml" xref="S3.p1.11.m2.2.2.2.4"><partialdiff id="S3.p1.11.m2.2.2.2.4.1.cmml" xref="S3.p1.11.m2.2.2.2.4.1"></partialdiff><ci id="S3.p1.11.m2.2.2.2.4.2.cmml" xref="S3.p1.11.m2.2.2.2.4.2">𝑞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m2.2c">\partial f(i_{test},q_{test})/\partial q</annotation></semantics></math>,
<em id="S3.p1.11.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.p1.11.2" class="ltx_text"></span> the partial derivatives of the function w.r.t.<span id="S3.p1.11.3" class="ltx_text"></span> each of the inputs (image and question). These expressions superficially look similar to gradients computed in backpropagation-based training of neural networks. However, there are two key differences – (i) we compute partial derivatives of the probability of <em id="S3.p1.11.4" class="ltx_emph ltx_font_italic">predicted output</em>, not the ground-truth output; and (ii) we compute partial derivatives w.r.t.<span id="S3.p1.11.5" class="ltx_text"></span> <em id="S3.p1.11.6" class="ltx_emph ltx_font_italic">inputs</em> (<em id="S3.p1.11.7" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.p1.11.8" class="ltx_text"></span> image pixel intensities and word embeddings), not parameters.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">Due to linearization above, elements of these partial derivatives tell us the effect of those pixels/words on the final prediction. These may be computed in the following two ways.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Guided Backpropagation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Guided backpropagation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">Springenberg et al., 2015</a>]</cite> is a gradient-based visualization technique used to visualize activations of neurons in different layers in CNNs.
It has been shown to perform better than its counterparts such as deconvolution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx20" title="" class="ltx_ref">Zeiler and Fergus, 2014</a>]</cite> especially for visualizing higher order layers.
Intuitively speaking, it is a modified version of backpropagation that restricts negative gradients from flowing backwards towards input layer, resulting in sharper image visualizations.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.5" class="ltx_p">Specifically, Guided BP is identical to classical BP except in the way the backward pass is computed in Rectified Linear Units (ReLUs). Let <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="h^{l}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msup id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">h</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">ℎ</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">h^{l}</annotation></semantics></math> denote the input to layer <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">l</annotation></semantics></math> and <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="h^{l+1}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msup id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">h</mi><mrow id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml"><mi id="S3.SS1.p2.3.m3.1.1.3.2" xref="S3.SS1.p2.3.m3.1.1.3.2.cmml">l</mi><mo id="S3.SS1.p2.3.m3.1.1.3.1" xref="S3.SS1.p2.3.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS1.p2.3.m3.1.1.3.3" xref="S3.SS1.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">ℎ</ci><apply id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3"><plus id="S3.SS1.p2.3.m3.1.1.3.1.cmml" xref="S3.SS1.p2.3.m3.1.1.3.1"></plus><ci id="S3.SS1.p2.3.m3.1.1.3.2.cmml" xref="S3.SS1.p2.3.m3.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.3.m3.1.1.3.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">h^{l+1}</annotation></semantics></math> denote the output. Recall that a ReLU is defined as <math id="S3.SS1.p2.4.m4.4" class="ltx_Math" alttext="h^{l+1}=relu(h^{l})=\max(h^{l},0)" display="inline"><semantics id="S3.SS1.p2.4.m4.4a"><mrow id="S3.SS1.p2.4.m4.4.4" xref="S3.SS1.p2.4.m4.4.4.cmml"><msup id="S3.SS1.p2.4.m4.4.4.4" xref="S3.SS1.p2.4.m4.4.4.4.cmml"><mi id="S3.SS1.p2.4.m4.4.4.4.2" xref="S3.SS1.p2.4.m4.4.4.4.2.cmml">h</mi><mrow id="S3.SS1.p2.4.m4.4.4.4.3" xref="S3.SS1.p2.4.m4.4.4.4.3.cmml"><mi id="S3.SS1.p2.4.m4.4.4.4.3.2" xref="S3.SS1.p2.4.m4.4.4.4.3.2.cmml">l</mi><mo id="S3.SS1.p2.4.m4.4.4.4.3.1" xref="S3.SS1.p2.4.m4.4.4.4.3.1.cmml">+</mo><mn id="S3.SS1.p2.4.m4.4.4.4.3.3" xref="S3.SS1.p2.4.m4.4.4.4.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS1.p2.4.m4.4.4.5" xref="S3.SS1.p2.4.m4.4.4.5.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.3.3.1" xref="S3.SS1.p2.4.m4.3.3.1.cmml"><mi id="S3.SS1.p2.4.m4.3.3.1.3" xref="S3.SS1.p2.4.m4.3.3.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.3.3.1.2" xref="S3.SS1.p2.4.m4.3.3.1.2.cmml">​</mo><mi id="S3.SS1.p2.4.m4.3.3.1.4" xref="S3.SS1.p2.4.m4.3.3.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.3.3.1.2a" xref="S3.SS1.p2.4.m4.3.3.1.2.cmml">​</mo><mi id="S3.SS1.p2.4.m4.3.3.1.5" xref="S3.SS1.p2.4.m4.3.3.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.3.3.1.2b" xref="S3.SS1.p2.4.m4.3.3.1.2.cmml">​</mo><mi id="S3.SS1.p2.4.m4.3.3.1.6" xref="S3.SS1.p2.4.m4.3.3.1.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m4.3.3.1.2c" xref="S3.SS1.p2.4.m4.3.3.1.2.cmml">​</mo><mrow id="S3.SS1.p2.4.m4.3.3.1.1.1" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.3.3.1.1.1.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.cmml">(</mo><msup id="S3.SS1.p2.4.m4.3.3.1.1.1.1" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.3.3.1.1.1.1.2" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.2.cmml">h</mi><mi id="S3.SS1.p2.4.m4.3.3.1.1.1.1.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S3.SS1.p2.4.m4.3.3.1.1.1.3" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.4.m4.4.4.6" xref="S3.SS1.p2.4.m4.4.4.6.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.4.4.2.1" xref="S3.SS1.p2.4.m4.4.4.2.2.cmml"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">max</mi><mo id="S3.SS1.p2.4.m4.4.4.2.1a" xref="S3.SS1.p2.4.m4.4.4.2.2.cmml">⁡</mo><mrow id="S3.SS1.p2.4.m4.4.4.2.1.1" xref="S3.SS1.p2.4.m4.4.4.2.2.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.4.4.2.1.1.2" xref="S3.SS1.p2.4.m4.4.4.2.2.cmml">(</mo><msup id="S3.SS1.p2.4.m4.4.4.2.1.1.1" xref="S3.SS1.p2.4.m4.4.4.2.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.4.4.2.1.1.1.2" xref="S3.SS1.p2.4.m4.4.4.2.1.1.1.2.cmml">h</mi><mi id="S3.SS1.p2.4.m4.4.4.2.1.1.1.3" xref="S3.SS1.p2.4.m4.4.4.2.1.1.1.3.cmml">l</mi></msup><mo id="S3.SS1.p2.4.m4.4.4.2.1.1.3" xref="S3.SS1.p2.4.m4.4.4.2.2.cmml">,</mo><mn id="S3.SS1.p2.4.m4.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml">0</mn><mo stretchy="false" id="S3.SS1.p2.4.m4.4.4.2.1.1.4" xref="S3.SS1.p2.4.m4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.4b"><apply id="S3.SS1.p2.4.m4.4.4.cmml" xref="S3.SS1.p2.4.m4.4.4"><and id="S3.SS1.p2.4.m4.4.4a.cmml" xref="S3.SS1.p2.4.m4.4.4"></and><apply id="S3.SS1.p2.4.m4.4.4b.cmml" xref="S3.SS1.p2.4.m4.4.4"><eq id="S3.SS1.p2.4.m4.4.4.5.cmml" xref="S3.SS1.p2.4.m4.4.4.5"></eq><apply id="S3.SS1.p2.4.m4.4.4.4.cmml" xref="S3.SS1.p2.4.m4.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.4.4.4.1.cmml" xref="S3.SS1.p2.4.m4.4.4.4">superscript</csymbol><ci id="S3.SS1.p2.4.m4.4.4.4.2.cmml" xref="S3.SS1.p2.4.m4.4.4.4.2">ℎ</ci><apply id="S3.SS1.p2.4.m4.4.4.4.3.cmml" xref="S3.SS1.p2.4.m4.4.4.4.3"><plus id="S3.SS1.p2.4.m4.4.4.4.3.1.cmml" xref="S3.SS1.p2.4.m4.4.4.4.3.1"></plus><ci id="S3.SS1.p2.4.m4.4.4.4.3.2.cmml" xref="S3.SS1.p2.4.m4.4.4.4.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.4.m4.4.4.4.3.3.cmml" xref="S3.SS1.p2.4.m4.4.4.4.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.4.m4.3.3.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1"><times id="S3.SS1.p2.4.m4.3.3.1.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.2"></times><ci id="S3.SS1.p2.4.m4.3.3.1.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.3">𝑟</ci><ci id="S3.SS1.p2.4.m4.3.3.1.4.cmml" xref="S3.SS1.p2.4.m4.3.3.1.4">𝑒</ci><ci id="S3.SS1.p2.4.m4.3.3.1.5.cmml" xref="S3.SS1.p2.4.m4.3.3.1.5">𝑙</ci><ci id="S3.SS1.p2.4.m4.3.3.1.6.cmml" xref="S3.SS1.p2.4.m4.3.3.1.6">𝑢</ci><apply id="S3.SS1.p2.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.2">ℎ</ci><ci id="S3.SS1.p2.4.m4.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.3.3.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S3.SS1.p2.4.m4.4.4c.cmml" xref="S3.SS1.p2.4.m4.4.4"><eq id="S3.SS1.p2.4.m4.4.4.6.cmml" xref="S3.SS1.p2.4.m4.4.4.6"></eq><share href="#S3.SS1.p2.4.m4.3.3.1.cmml" id="S3.SS1.p2.4.m4.4.4d.cmml" xref="S3.SS1.p2.4.m4.4.4"></share><apply id="S3.SS1.p2.4.m4.4.4.2.2.cmml" xref="S3.SS1.p2.4.m4.4.4.2.1"><max id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"></max><apply id="S3.SS1.p2.4.m4.4.4.2.1.1.1.cmml" xref="S3.SS1.p2.4.m4.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.4.4.2.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.4.4.2.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m4.4.4.2.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.4.4.2.1.1.1.2">ℎ</ci><ci id="S3.SS1.p2.4.m4.4.4.2.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.4.4.2.1.1.1.3">𝑙</ci></apply><cn type="integer" id="S3.SS1.p2.4.m4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.4c">h^{l+1}=relu(h^{l})=\max(h^{l},0)</annotation></semantics></math>.
Let <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="G^{l+1}=\nicefrac{{\partial f}}{{\partial h^{l+1}}}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><msup id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2.2" xref="S3.SS1.p2.5.m5.1.1.2.2.cmml">G</mi><mrow id="S3.SS1.p2.5.m5.1.1.2.3" xref="S3.SS1.p2.5.m5.1.1.2.3.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2.3.2" xref="S3.SS1.p2.5.m5.1.1.2.3.2.cmml">l</mi><mo id="S3.SS1.p2.5.m5.1.1.2.3.1" xref="S3.SS1.p2.5.m5.1.1.2.3.1.cmml">+</mo><mn id="S3.SS1.p2.5.m5.1.1.2.3.3" xref="S3.SS1.p2.5.m5.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">=</mo><mrow id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml"><mpadded voffset="0.3em" id="S3.SS1.p2.5.m5.1.1.3.2" xref="S3.SS1.p2.5.m5.1.1.3.2.cmml"><mo mathsize="70%" rspace="0em" id="S3.SS1.p2.5.m5.1.1.3.2.1" xref="S3.SS1.p2.5.m5.1.1.3.2.1.cmml">∂</mo><mi mathsize="70%" id="S3.SS1.p2.5.m5.1.1.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.2.2.cmml">f</mi></mpadded><mpadded lspace="-0.1em" width="-0.15em" id="S3.SS1.p2.5.m5.1.1.3.1" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml"><mo stretchy="true" symmetric="true" id="S3.SS1.p2.5.m5.1.1.3.1a" xref="S3.SS1.p2.5.m5.1.1.3.1.cmml">/</mo></mpadded><mrow id="S3.SS1.p2.5.m5.1.1.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.cmml"><mo lspace="0.222em" mathsize="70%" rspace="0em" id="S3.SS1.p2.5.m5.1.1.3.3.1" xref="S3.SS1.p2.5.m5.1.1.3.3.1.cmml">∂</mo><msup id="S3.SS1.p2.5.m5.1.1.3.3.2" xref="S3.SS1.p2.5.m5.1.1.3.3.2.cmml"><mi mathsize="70%" id="S3.SS1.p2.5.m5.1.1.3.3.2.2" xref="S3.SS1.p2.5.m5.1.1.3.3.2.2.cmml">h</mi><mrow id="S3.SS1.p2.5.m5.1.1.3.3.2.3" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.cmml"><mi mathsize="71%" id="S3.SS1.p2.5.m5.1.1.3.3.2.3.2" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.2.cmml">l</mi><mo mathsize="71%" id="S3.SS1.p2.5.m5.1.1.3.3.2.3.1" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.1.cmml">+</mo><mn mathsize="71%" id="S3.SS1.p2.5.m5.1.1.3.3.2.3.3" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.3.cmml">1</mn></mrow></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><eq id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1"></eq><apply id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2.2">𝐺</ci><apply id="S3.SS1.p2.5.m5.1.1.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.2.3"><plus id="S3.SS1.p2.5.m5.1.1.2.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.2.3.1"></plus><ci id="S3.SS1.p2.5.m5.1.1.2.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.5.m5.1.1.2.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3"><divide id="S3.SS1.p2.5.m5.1.1.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.1"></divide><apply id="S3.SS1.p2.5.m5.1.1.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2"><partialdiff id="S3.SS1.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.1"></partialdiff><ci id="S3.SS1.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.2.2">𝑓</ci></apply><apply id="S3.SS1.p2.5.m5.1.1.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3"><partialdiff id="S3.SS1.p2.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.1"></partialdiff><apply id="S3.SS1.p2.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.3.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2">superscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.3.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.2">ℎ</ci><apply id="S3.SS1.p2.5.m5.1.1.3.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3"><plus id="S3.SS1.p2.5.m5.1.1.3.3.2.3.1.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.1"></plus><ci id="S3.SS1.p2.5.m5.1.1.3.3.2.3.2.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.5.m5.1.1.3.3.2.3.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">G^{l+1}=\nicefrac{{\partial f}}{{\partial h^{l+1}}}</annotation></semantics></math>
denote the partial derivative w.r.t.<span id="S3.SS1.p2.5.1" class="ltx_text"></span> the output of the ReLU (received as input in the backward pass). The key difference between the two backprops (BP) is:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="G^{l}=[[h^{l}&gt;0]]\cdot G^{l+1}\qquad\qquad\text{ [Classical BP]}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><msup id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml"><mi id="S3.E2.m1.2.2.3.2" xref="S3.E2.m1.2.2.3.2.cmml">G</mi><mi id="S3.E2.m1.2.2.3.3" xref="S3.E2.m1.2.2.3.3.cmml">l</mi></msup><mo id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.2.cmml"><mrow id="S3.E2.m1.2.2.1.1.1" xref="S3.E2.m1.2.2.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msup><mo id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">&gt;</mo><mn id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow><mo rspace="0.222em" id="S3.E2.m1.2.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.2.cmml">⋅</mo><msup id="S3.E2.m1.2.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.3.2.cmml">G</mi><mrow id="S3.E2.m1.2.2.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.3.3.2" xref="S3.E2.m1.2.2.1.1.1.3.3.2.cmml">l</mi><mo id="S3.E2.m1.2.2.1.1.1.3.3.1" xref="S3.E2.m1.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S3.E2.m1.2.2.1.1.1.3.3.3" xref="S3.E2.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msup></mrow><mspace width="4em" id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.2.cmml"></mspace><mtext id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1a.cmml"> [Classical BP]</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><eq id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"></eq><apply id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.3.1.cmml" xref="S3.E2.m1.2.2.3">superscript</csymbol><ci id="S3.E2.m1.2.2.3.2.cmml" xref="S3.E2.m1.2.2.3.2">𝐺</ci><ci id="S3.E2.m1.2.2.3.3.cmml" xref="S3.E2.m1.2.2.3.3">𝑙</ci></apply><list id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.1"><apply id="S3.E2.m1.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1"><ci id="S3.E2.m1.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.2">⋅</ci><apply id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1"><gt id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.1"></gt><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S3.E2.m1.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.2">𝐺</ci><apply id="S3.E2.m1.2.2.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3"><plus id="S3.E2.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3.1"></plus><ci id="S3.E2.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3.2">𝑙</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S3.E2.m1.1.1a.cmml" xref="S3.E2.m1.1.1"><mtext id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"> [Classical BP]</mtext></ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">G^{l}=[[h^{l}&gt;0]]\cdot G^{l+1}\qquad\qquad\text{ [Classical BP]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="G^{l}=[[h^{l}&gt;0]]\cdot[[G^{l+1}&gt;0]]\cdot G^{l+1}\text{[Guided BP]}" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><msup id="S3.E3.m1.2.2.4" xref="S3.E3.m1.2.2.4.cmml"><mi id="S3.E3.m1.2.2.4.2" xref="S3.E3.m1.2.2.4.2.cmml">G</mi><mi id="S3.E3.m1.2.2.4.3" xref="S3.E3.m1.2.2.4.3.cmml">l</mi></msup><mo id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">=</mo><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><mrow id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msup><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml">&gt;</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo rspace="0.055em" stretchy="false" id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo rspace="0.222em" id="S3.E3.m1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.3.cmml">⋅</mo><mrow id="S3.E3.m1.2.2.2.2.2.1" xref="S3.E3.m1.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.2.2.1.2" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">[</mo><mrow id="S3.E3.m1.2.2.2.2.2.1.1.1" xref="S3.E3.m1.2.2.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.2.2.1.1.1.2" xref="S3.E3.m1.2.2.2.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.2.2.2.2.2.1.1.1.1" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.cmml"><msup id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.2" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.2.cmml">G</mi><mrow id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.2" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.2.cmml">l</mi><mo id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.1" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.3" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S3.E3.m1.2.2.2.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.1.cmml">&gt;</mo><mn id="S3.E3.m1.2.2.2.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="S3.E3.m1.2.2.2.2.2.1.1.1.3" xref="S3.E3.m1.2.2.2.2.2.1.1.2.1.cmml">]</mo></mrow><mo rspace="0.055em" stretchy="false" id="S3.E3.m1.2.2.2.2.2.1.3" xref="S3.E3.m1.2.2.2.2.2.2.1.cmml">]</mo></mrow><mo rspace="0.222em" id="S3.E3.m1.2.2.2.2.3a" xref="S3.E3.m1.2.2.2.2.3.cmml">⋅</mo><msup id="S3.E3.m1.2.2.2.2.4" xref="S3.E3.m1.2.2.2.2.4.cmml"><mi id="S3.E3.m1.2.2.2.2.4.2" xref="S3.E3.m1.2.2.2.2.4.2.cmml">G</mi><mrow id="S3.E3.m1.2.2.2.2.4.3" xref="S3.E3.m1.2.2.2.2.4.3.cmml"><mi id="S3.E3.m1.2.2.2.2.4.3.2" xref="S3.E3.m1.2.2.2.2.4.3.2.cmml">l</mi><mo id="S3.E3.m1.2.2.2.2.4.3.1" xref="S3.E3.m1.2.2.2.2.4.3.1.cmml">+</mo><mn id="S3.E3.m1.2.2.2.2.4.3.3" xref="S3.E3.m1.2.2.2.2.4.3.3.cmml">1</mn></mrow></msup></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><mtext id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.4a.cmml">[Guided BP]</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3"></eq><apply id="S3.E3.m1.2.2.4.cmml" xref="S3.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.4.1.cmml" xref="S3.E3.m1.2.2.4">superscript</csymbol><ci id="S3.E3.m1.2.2.4.2.cmml" xref="S3.E3.m1.2.2.4.2">𝐺</ci><ci id="S3.E3.m1.2.2.4.3.cmml" xref="S3.E3.m1.2.2.4.3">𝑙</ci></apply><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><times id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></times><apply id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2"><ci id="S3.E3.m1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.3">⋅</ci><apply id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1"><gt id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1"></gt><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.2.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.2.2.2.2.2.1.1.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1"><gt id="S3.E3.m1.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.1"></gt><apply id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.2">𝐺</ci><apply id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3"><plus id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.1"></plus><ci id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.2">𝑙</ci><cn type="integer" id="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.2.3.3">1</cn></apply></apply><cn type="integer" id="S3.E3.m1.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.2.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S3.E3.m1.2.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.2.4">superscript</csymbol><ci id="S3.E3.m1.2.2.2.2.4.2.cmml" xref="S3.E3.m1.2.2.2.2.4.2">𝐺</ci><apply id="S3.E3.m1.2.2.2.2.4.3.cmml" xref="S3.E3.m1.2.2.2.2.4.3"><plus id="S3.E3.m1.2.2.2.2.4.3.1.cmml" xref="S3.E3.m1.2.2.2.2.4.3.1"></plus><ci id="S3.E3.m1.2.2.2.2.4.3.2.cmml" xref="S3.E3.m1.2.2.2.2.4.3.2">𝑙</ci><cn type="integer" id="S3.E3.m1.2.2.2.2.4.3.3.cmml" xref="S3.E3.m1.2.2.2.2.4.3.3">1</cn></apply></apply></apply><ci id="S3.E3.m1.2.2.2.4a.cmml" xref="S3.E3.m1.2.2.2.4"><mtext id="S3.E3.m1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.4">[Guided BP]</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">G^{l}=[[h^{l}&gt;0]]\cdot[[G^{l+1}&gt;0]]\cdot G^{l+1}\text{[Guided BP]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.6" class="ltx_p"><em id="S3.SS1.p2.6.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS1.p2.6.2" class="ltx_text"></span> guided BP blocks negative gradients from flowing back in ReLUs.
For more details, please refer to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx16" title="" class="ltx_ref">Springenberg et al., 2015</a>]</cite>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">We use guided BP to compute ‘gradients’ of the probability of predicted answer w.r.t.<span id="S3.SS1.p3.1.1" class="ltx_text"></span> inputs (image and question). Note that the language pathway in the models we typically use, does not contain ReLUs, thus these are true gradients (not just gradient-based visualizations) on the language side. We interpret the words/pixels with the highest (magnitude) gradients received as the most important for the model since small changes in these lead to largest changes in the model’s confidence in the predicted answer.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Discrete Derivatives</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In this method, we systematically occlude subsets of the input, forward propagate the masked input through the VQA model, and compute the change in the probability of the answer predicted with the unmasked original input.
Since there are 2 inputs to the model, we focus on one input at a time, keeping the other input fixed (mimicing partial derivatives).
Specifically, to compute importance of a question word, we mask that word by dropping it from the question, and feed the masked question with original image as inputs to the model.
The importance score of the question word is computed as the change in probability of the original predicted answer.
</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">We follow the same procedure on the images to compute importance of image regions. We divide the image into a grid of size 16 x 16, occlude one cell at a time with a gray patch<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>a gray patch of intensities (R, G, B) = (123.68, 116.779, 103.939), mean RGB pixel values across a large image dataset ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx7" title="" class="ltx_ref">Deng et al., 2009</a>]</cite> on which the CNN is trained.</span></span></span>, feed in the perturbed image with the entire question to the model, and compute the decrease in the probability of the original predicted answer.
The generated importance maps are shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Approach ‣ Towards Transparent AI Systems: Interpreting Visual Question Answering Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">More results and interactive visualizations can be found on authors’ webpages.<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Question importance maps: <a target="_blank" href="https://mlp.ece.vt.edu/masked_ques_vis/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://mlp.ece.vt.edu/masked_ques_vis/</a>. Image importance maps: <a target="_blank" href="https://mlp.ece.vt.edu/masked_image_vis/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://mlp.ece.vt.edu/masked_image_vis/</a></span></span></span></p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">While image/question importance maps on individual inputs provide crucial insight into the inner-workings of a model (<em id="S4.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.p1.1.2" class="ltx_text"></span>, see Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Approach ‣ Towards Transparent AI Systems: Interpreting Visual Question Answering Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), what do the aggregate statistics of these maps tell us about the model?</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Analyzing Image Importance</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx6" title="" class="ltx_ref">Das et al., 2016</a>]</cite> recently collected human attention annotations for (question, image) pairs from VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx2" title="" class="ltx_ref">Antol et al., 2015</a>]</cite>.
Given a blurry image and a question, humans were asked to deblur the regions in the image that were helpful in answering the question.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<table id="S4.T1.4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.4.4.5.1" class="ltx_tr">
<th id="S4.T1.4.4.5.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"></th>
<th id="S4.T1.4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.5.1.2.1" class="ltx_text" style="font-size:90%;">Rank-correlation</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.1.1.1.2.1" class="ltx_text" style="font-size:90%;">Random</span></th>
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">0.000 </span><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mo mathsize="90%" id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.1.1.1.1.2" class="ltx_text" style="font-size:90%;"> 0.001</span>
</td>
</tr>
<tr id="S4.T1.2.2.2" class="ltx_tr">
<th id="S4.T1.2.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.2.2.2.2.1" class="ltx_text" style="font-size:90%;">Occlusion</span></th>
<td id="S4.T1.2.2.2.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T1.2.2.2.1.1" class="ltx_text" style="font-size:90%;">0.173 </span><math id="S4.T1.2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.2.2.2.1.m1.1a"><mo mathsize="90%" id="S4.T1.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T1.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.2.2.2.1.2" class="ltx_text" style="font-size:90%;"> 0.004</span>
</td>
</tr>
<tr id="S4.T1.3.3.3" class="ltx_tr">
<th id="S4.T1.3.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.3.3.3.2.1" class="ltx_text" style="font-size:90%;">Guided backpropagation</span></th>
<td id="S4.T1.3.3.3.1" class="ltx_td ltx_align_center" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T1.3.3.3.1.1" class="ltx_text" style="font-size:90%;">0.292 </span><math id="S4.T1.3.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.3.3.3.1.m1.1a"><mo mathsize="90%" id="S4.T1.3.3.3.1.m1.1.1" xref="S4.T1.3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T1.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.3.3.3.1.2" class="ltx_text" style="font-size:90%;"> 0.004</span>
</td>
</tr>
<tr id="S4.T1.4.4.4" class="ltx_tr">
<th id="S4.T1.4.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T1.4.4.4.2.1" class="ltx_text" style="font-size:90%;">Human</span></th>
<td id="S4.T1.4.4.4.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;">
<span id="S4.T1.4.4.4.1.1" class="ltx_text" style="font-size:90%;">0.623 </span><math id="S4.T1.4.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.4.4.4.1.m1.1a"><mo mathsize="90%" id="S4.T1.4.4.4.1.m1.1.1" xref="S4.T1.4.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T1.4.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.4.4.4.1.2" class="ltx_text" style="font-size:90%;"> 0.003</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.6.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.7.2" class="ltx_text" style="font-size:90%;">Rank-correlation of importance maps with human attention maps (higher is better). The last row represents inter-human agreement.</span></figcaption>
</figure>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We evaluate the quality of image importance maps obtained from the two methods (guided backpropagation and occlusion) by comparing them to the human attention maps.
The human attention dataset contains annotations for 1374 (question, image) pairs from VQA
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx2" title="" class="ltx_ref">Antol et al., 2015</a>]</cite>
validation set.
Following the evaluation protocol in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bibx6" title="" class="ltx_ref">Das et al., 2016</a>]</cite>,
we take the absolute value of the importance maps and compute their mean rank-correlation with the human attention maps.
Specifically, we first scale both the image importance and human attention
maps to 14x14, normalize them spatially and
rank the pixels according to their spatial attention,
and then compute correlation between these two
ranked lists.
The results are shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Analyzing Image Importance ‣ 4 Results ‣ Towards Transparent AI Systems: Interpreting Visual Question Answering Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
We find that both importance maps (occlusion and guided BP) are weakly positively correlated with human attention maps, although it is far from inter-human correlation.
Thus, our techniques revealed an interesting finding – that even without attention mechanisms, VQA models may be implicitly attending to relevant regions in the image.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Analyzing Question Importance</h3>

<figure id="S4.F3" class="ltx_figure"><img src="/html/1608.08974/assets/images/question_importance_histogram.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="318" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Probability of a word being most important in a question given that it has a certain POS tag. POS tags are sorted in the decreasing order of their frequency in the entire dataset.
</span></figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Since there is no human attention dataset for questions, we instead analyze the importance maps for questions using their POS tags.
Our hypothesis is that wh-words and nouns should matter most to a ‘sensible’ model’s prediction.
We plot the probability of a word being most important in a question given that it has a certain POS tag.
To get reliable statistics, we picked 15 most frequent POS tags from the VQA validation dataset, and grouped similar tags into one category, <em id="S4.SS2.p1.1.1" class="ltx_emph ltx_font_italic">e.g</em>.<span id="S4.SS2.p1.1.2" class="ltx_text"></span> WDT, WP, WRB are grouped as wh-words.
The histogram can be seen in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2 Analyzing Question Importance ‣ 4 Results ‣ Towards Transparent AI Systems: Interpreting Visual Question Answering Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.
Indeed, wh-words are most important followed by adjectives and nouns.
Adjectives and nouns rank high because many questions tend to ask about characteristics of objects, or objects themselves.
This finding suggests that the language model part of the VQA model is strong and is able to learn to focus on appropriate words without any explicit attention procedure.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Note that for many occlusions, the model’s predicted answer is different from the original predicted answer.
In fact, we found that the number of times the predicted answer changes
correlates with the model’s accuracy. It is able to predict success/failure accurately 72% of the times.
This suggests that features that characterize these importance maps can provide useful signals for predicting the model’s oncoming failures.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we experimented with two visualization methods – guided backpropagation and occlusion – to interpret deep learning models for the task of Visual Question Answering.
Although we focus on only one VQA model in this work, the methods are generalizable to all other end-to-end VQA models.
The occlusion method can even be applied to any (non-end-to-end) VQA model considering it as a black box.
We believe that these methods and results can be helpful in interpreting the current VQA models, and designing the next generation of VQA models.
</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Acknowledgements.</span>
This work was supported in part by the following:
National Science Foundation CAREER awards to DB and DP,
Army Research Office YIP awards to DB and DP,
ICTAS Junior Faculty awards to DB and DP,
Army Research Lab grant W911NF-15-2-0080 to DP and DB,
Office of Naval Research grant N00014-14-1-0679 to DB,
Paul G. Allen Family Foundation Allen Distinguished Investigator award to DP,
Google Faculty Research award to DP and DB,
AWS in Education Research grant to DB, and NVIDIA GPU donation to DB.
The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of the U.S. Government or any sponsor.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bibx1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Agrawal et al., 2015] </span>
<span class="ltx_bibblock">
Harsh Agrawal, Clint Solomon Mathialagan, Yash Goyal, Neelima Chavali, Prakriti
Banik, Akrit Mohapatra, Ahmed Osman, and Dhruv Batra.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Cloudcv: Large-scale distributed computer vision as a cloud service.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx1.1.1" class="ltx_text ltx_font_italic">Mobile Cloud Visual Media Computing</span>, pages 265–290.
Springer International Publishing.

</span>
</li>
<li id="bib.bibx2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Antol et al., 2015] </span>
<span class="ltx_bibblock">
Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra,
C. Lawrence Zitnick, and Devi Parikh.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">VQA: Visual Question Answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx2.1.1" class="ltx_text ltx_font_italic">ICCV</span>.

</span>
</li>
<li id="bib.bibx3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Baehrens et al., 2010] </span>
<span class="ltx_bibblock">
David Baehrens, Timon Schroeter, Stefan Harmeling, Motoaki Kawanabe, Katja
Hansen, and Klaus-Robert Müller.

</span>
<span class="ltx_bibblock">2010.

</span>
<span class="ltx_bibblock">How to explain individual classification decisions.

</span>
<span class="ltx_bibblock"><span id="bib.bibx3.1.1" class="ltx_text ltx_font_italic">J. Mach. Learn. Res.</span>, 11:1803–1831, August.

</span>
</li>
<li id="bib.bibx4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Bordes et al., 2015] </span>
<span class="ltx_bibblock">
Antoine Bordes, Nicolas Usunier, Sumit Chopra, and Jason Weston.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Large-scale simple question answering with memory networks.

</span>
<span class="ltx_bibblock"><span id="bib.bibx4.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1506.02075.

</span>
</li>
<li id="bib.bibx5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Brea et al., 2011] </span>
<span class="ltx_bibblock">
Johanni Brea, Walter Senn, and Jean-Pascal Pfister.

</span>
<span class="ltx_bibblock">2011.

</span>
<span class="ltx_bibblock">Sequence learning with hidden units in spiking neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx5.1.1" class="ltx_text ltx_font_italic">NIPS</span>.

</span>
</li>
<li id="bib.bibx6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Das et al., 2016] </span>
<span class="ltx_bibblock">
Abhishek Das, Harsh Agrawal, C. Lawrence Zitnick, Devi Parikh, and Dhruv Batra.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Human Attention in Visual Question Answering: Do Humans and Deep
Networks Look at the Same Regions?

</span>
<span class="ltx_bibblock">In <span id="bib.bibx6.1.1" class="ltx_text ltx_font_italic">EMNLP</span>.

</span>
</li>
<li id="bib.bibx7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Deng et al., 2009] </span>
<span class="ltx_bibblock">
J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei.

</span>
<span class="ltx_bibblock">2009.

</span>
<span class="ltx_bibblock">ImageNet: A Large-Scale Hierarchical Image Database.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx7.1.1" class="ltx_text ltx_font_italic">CVPR</span>.

</span>
</li>
<li id="bib.bibx8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Hinton et al., 2012] </span>
<span class="ltx_bibblock">
Geoffrey Hinton, Li Deng, Dong Yu, George E Dahl, Abdel-rahman Mohamed, Navdeep
Jaitly, Andrew Senior, Vincent Vanhoucke, Patrick Nguyen, Tara N Sainath,
et al.

</span>
<span class="ltx_bibblock">2012.

</span>
<span class="ltx_bibblock">Deep neural networks for acoustic modeling in speech recognition: The
shared views of four research groups.

</span>
<span class="ltx_bibblock"><span id="bib.bibx8.1.1" class="ltx_text ltx_font_italic">Signal Processing Magazine, IEEE</span>, 29(6):82–97.

</span>
</li>
<li id="bib.bibx9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Liu and Wang, 2012] </span>
<span class="ltx_bibblock">
L. Liu and L. Wang.

</span>
<span class="ltx_bibblock">2012.

</span>
<span class="ltx_bibblock">What has my classifier learned? Visualizing the classification rules
of bag-of-feature model by support region detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx9.1.1" class="ltx_text ltx_font_italic">CVPR</span>.

</span>
</li>
<li id="bib.bibx10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Lu et al., 2015] </span>
<span class="ltx_bibblock">
Jiasen Lu, Xiao Lin, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Deeper LSTM and normalized CNN Visual Question Answering model.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/VT-vision-lab/VQA_LSTM_CNN" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/VT-vision-lab/VQA_LSTM_CNN</a>.

</span>
</li>
<li id="bib.bibx11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Malinowski et al., 2015] </span>
<span class="ltx_bibblock">
Mateusz Malinowski, Marcus Rohrbach, and Mario Fritz.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Ask your neurons: A neural-based approach to answering questions
about images.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx11.1.1" class="ltx_text ltx_font_italic">ICCV</span>.

</span>
</li>
<li id="bib.bibx12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Ren et al., 2015] </span>
<span class="ltx_bibblock">
Mengye Ren, Ryan Kiros, and Richard Zemel.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Exploring models and data for image question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx12.1.1" class="ltx_text ltx_font_italic">NIPS</span>.

</span>
</li>
<li id="bib.bibx13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Ribeiro et al., 2016] </span>
<span class="ltx_bibblock">
Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">”Why Should I Trust You?”: Explaining the Predictions of Any
Classifier.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx13.1.1" class="ltx_text ltx_font_italic">Knowledge Discovery and Data Mining (KDD)</span>.

</span>
</li>
<li id="bib.bibx14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Silver et al., 2016] </span>
<span class="ltx_bibblock">
David Silver, Aja Huang, Chris J Maddison, Arthur Guez, Laurent Sifre, George
Van Den Driessche, Julian Schrittwieser, Ioannis Antonoglou, Veda
Panneershelvam, Marc Lanctot, et al.

</span>
<span class="ltx_bibblock">2016.

</span>
<span class="ltx_bibblock">Mastering the game of Go with deep neural networks and tree search.

</span>
<span class="ltx_bibblock"><span id="bib.bibx14.1.1" class="ltx_text ltx_font_italic">Nature</span>, 529(7587):484–489.

</span>
</li>
<li id="bib.bibx15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Simonyan et al., 2014] </span>
<span class="ltx_bibblock">
Karen Simonyan, Andrea Vedaldi, and Andrew Zisserman.

</span>
<span class="ltx_bibblock">2014.

</span>
<span class="ltx_bibblock">Deep Inside Convolutional Networks: Visualising Image Classification
Models and Saliency Maps.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx15.1.1" class="ltx_text ltx_font_italic">ICLR Workshop Track</span>.

</span>
</li>
<li id="bib.bibx16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Springenberg et al., 2015] </span>
<span class="ltx_bibblock">
J. T. Springenberg, A. Dosovitskiy, T. Brox, and M. Riedmiller.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Striving for Simplicity: The All Convolutional Net.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx16.1.1" class="ltx_text ltx_font_italic">ICLR Workshop Track</span>.

</span>
</li>
<li id="bib.bibx17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Sutskever et al., 2014] </span>
<span class="ltx_bibblock">
Ilya Sutskever, Oriol Vinyals, and Quoc Le.

</span>
<span class="ltx_bibblock">2014.

</span>
<span class="ltx_bibblock">Sequence to Sequence Learning with Neural Networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx17.1.1" class="ltx_text ltx_font_italic">NIPS</span>.

</span>
</li>
<li id="bib.bibx18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Szegedy et al., 2015] </span>
<span class="ltx_bibblock">
Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet, Scott E. Reed,
Dragomir Anguelov, Dumitru Erhan, Vincent Vanhoucke, and Andrew Rabinovich.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Going deeper with convolutions.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx18.1.1" class="ltx_text ltx_font_italic">CVPR</span>.

</span>
</li>
<li id="bib.bibx19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Weston et al., 2015] </span>
<span class="ltx_bibblock">
Jason Weston, Antoine Bordes, Sumit Chopra, and Tomas Mikolov.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">Towards AI-Complete Question Answering: A Set of Prerequisite Toy
Tasks.

</span>
<span class="ltx_bibblock"><span id="bib.bibx19.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1502.05698.

</span>
</li>
<li id="bib.bibx20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[Zeiler and Fergus, 2014] </span>
<span class="ltx_bibblock">
Matthew D. Zeiler and Rob Fergus.

</span>
<span class="ltx_bibblock">2014.

</span>
<span class="ltx_bibblock">Visualizing and Understanding Convolutional Networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bibx20.1.1" class="ltx_text ltx_font_italic">ECCV</span>.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1608.08973" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1608.08974" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1608.08974">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1608.08974" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1608.08975" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 20:40:50 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
