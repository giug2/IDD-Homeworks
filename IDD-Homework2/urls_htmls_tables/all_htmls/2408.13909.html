<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task</title>
<!--Generated on Sun Aug 25 17:53:31 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2408.13909v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S1" title="In LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S2" title="In LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Literature Review</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S2.SS1" title="In 2 Literature Review ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Introduction to Multimodal Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S2.SS2" title="In 2 Literature Review ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>History of Image Retrieval Techniques</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S2.SS3" title="In 2 Literature Review ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Dataset Development and Challenges</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3" title="In LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Research Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS1" title="In 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Method</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS2" title="In 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Dataset and Preprocessing</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS2.SSS1" title="In 3.2 Dataset and Preprocessing ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Generated Dataset for Azerbaijani Language</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS3" title="In 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Image Encoders</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS4" title="In 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Text Encoder</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS4.SSS1" title="In 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.1 </span>Projection Head</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS4.SSS2" title="In 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.2 </span>Contrastive Learning Loss</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS4.SSS3" title="In 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.3 </span>Enhancing Feature Extraction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS4.SSS4" title="In 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4.4 </span>Training Procedure</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS5" title="In 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Image Retrieval Process</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS6" title="In 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>Evaluation Metrics</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS6.SSS1" title="In 3.6 Evaluation Metrics ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6.1 </span>Mean Average Precision (MAP)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS6.SSS2" title="In 3.6 Evaluation Metrics ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6.2 </span>Mean Average Recall (MAR)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS6.SSS3" title="In 3.6 Evaluation Metrics ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6.3 </span>Mean Average F1 Score (MAF1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.SS6.SSS4" title="In 3.6 Evaluation Metrics ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6.4 </span>Mean Average Accuracy (Top-k Accuracy)</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S4" title="In LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Implementation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S4.SS1" title="In 4 Implementation ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experiment Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S4.SS2" title="In 4 Implementation ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Controlled Variables and Their Impact on Model Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S4.SS3" title="In 4 Implementation ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Analysis of Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S5" title="In LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S6" title="In LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Future Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#A1" title="In LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Implementation</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text ltx_font_bold" id="id1.1.id1">Ali Asgarov<sup class="ltx_sup" id="id1.1.id1.1">1</sup></span>,
<span class="ltx_text ltx_font_bold" id="id2.2.id2">Samir Rustamov<sup class="ltx_sup" id="id2.2.id2.1">1,2</sup></span>,

<br class="ltx_break"/>
<br class="ltx_break"/><sup class="ltx_sup" id="id3.3.id3">1</sup>George Washington University,
<sup class="ltx_sup" id="id4.4.id4">2</sup>ADA University

<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">This research explores the development of multimodal vision-language models for image retrieval in low-resource languages, specifically Azerbaijani. Existing vision-language models primarily support high-resource languages and fine-tuning them remains computationally demanding. To address challenges in vision-language retrieval for low-resource languages, we integrated the CLIP model architecture and employed several techniques to balance computational efficiency with performance. These techniques include synthetic data generation through machine translation, image augmentation, and further training the attention mechanisms of transformer-based models with domain-specific data. We integrated Multilingual BERT as a text encoder with image encoders like ResNet50, EfficientNet0, Vision Transformer (ViT), and Tiny Swin Transformer. Our study found that models like EfficientNet0 and Tiny Swin Transformer perform best on the datasets they were trained on, such as COCO, Flickr30k, and Flickr8k. Augmentation techniques boosted EfficientNet0’s MAP on Flickr30k from 0.84 to 0.87 and ResNet50’s MAP on MSCOCO from 0.70 to 0.80, contributing to a new state-of-the-art (SOTA) in vision-language retrieval. We share our configurations and results to support further research. Code and pre-trained models are available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/aliasgerovs/azclip" title="">https://github.com/aliasgerovs/azclip</a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.1">
<p class="ltx_p" id="p1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1.1">LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.1.2" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.1.2.1" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.1.2.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="p1.1.2.1.1.1.1">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.2.1.1.1.1.1.1">
Ali Asgarov<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.1.1">1</sup>,
Samir Rustamov<sup class="ltx_sup" id="p1.1.2.1.1.1.1.1.1.2">1,2</sup>,</span></span></span>
<span class="ltx_tr" id="p1.1.2.1.1.2.2">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.2.2.1"><sup class="ltx_sup" id="p1.1.2.1.1.2.2.1.1">1</sup>George Washington University,
<sup class="ltx_sup" id="p1.1.2.1.1.2.2.1.2">2</sup>ADA University</span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The digital world is overflowing with vast amounts of information. Text, images, and videos are produced at an exceptionally high rate, and traditional search systems, designed for textual queries, struggle to keep pace. Keyword-based searches often yield extensive results that fail to capture the user’s intent or the richness of multimedia data, creating barriers to accessing the needed information. Ideally, information retrieval systems should allow users to find what they need, regardless of their native language or preferred mode of interaction.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="342" id="S1.F1.g1" src="extracted/5812574/Figure/sample_1.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S1.F1.2.1">Model Inference Example 1</span>. The query posed is "Young couple cycling" and the model returned relevant images from the database for the query.</figcaption>
</figure>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">This is where multimodal image retrieval becomes essential, as it enables searches using not only text but also pictures, spoken words, or a combination of different input modalities. This approach significantly improves search capabilities, making information more accessible to people, regardless of the language they speak or how they prefer to search. For instance, in an image-to-image search, one could point a camera at a building to search for its architectural style or use a drawing to find clothes online. These examples illustrate how multimodal data search can help people search more efficiently. However, a significant challenge exists, most multimodal data retrieval systems depend on large, complex models trained on vast datasets. These models are resource-intensive and require extensive training data in specific languages, creating a challenge for languages with limited digital resources. This research aims to close that gap, making the benefits of such models accessible to all. By making these systems more memory and computation-efficient and leveraging the vast amount of available image data in all languages, we can unlock the potential of multimodal retrieval for all languages. Most recent multimodal systems suffer from deficiencies in low-resource linguistic settings where they are less efficient in scalability with high volume and high dimensional data. The imbalance in data types’ availability complicates the combination of such data for researching or training multimodal systems in languages with limited digital products. Additionally, the computational requirements of advanced models like CLIP are very high and cannot be adjusted for limited computational resources. Consequently, systems built on CLIP or similar models with billions of parameters are not widely applicable for low-resource languages. The primary objective of this research is to develop a multimodal vision-language retrieval system adapted for the Azerbaijani language, balancing computational efficiency and scalability in low-resource settings. An important part of this research is to analyze ways of training the model’s performance across different domains, focusing on the constrained availability of data. The aim is to create a model that performs well within the Azerbaijani language and represents a scalable skeleton for other similar low-resource languages, such as Kazakh or Uzbek. This approach aims to expand the use of powerful AI technologies into various linguistically diverse and low-resource settings, making computationally challenging problems accessible to a broader audience.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Our main contributions are:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Development and extensive validation of a multimodal vision-language retrieval model specifically for the Azerbaijani language, creating a custom image retrieval model that can effectively perform in a low-resourced linguistic environment.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Contribution to the field of computational efficiency of model designs. The model can be easily replicated for other low-resource languages, and its high computational efficiency decreases operational demands and allows for operational deployment.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Comparative analysis of visual encoder and text decoder models and their performance on in-domain and out-of-domain data to estimate the process of generalization and scaling, expanding on the concept by assessing how they adapt to new, unseen environments.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Literature Review</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Introduction to Multimodal Retrieval</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Multimodal retrieval systems have become an important study area in artificial intelligence as they are concerned with the analysis of data across multiple modalities, such as vision and text or speech etc. One of the foundational contributions to this field is the Deep Visual-Semantic Embedding model by Frome et al <cite class="ltx_cite ltx_citemacro_cite">Frome et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib5" title="">2013</a>)</cite>. This model is crucial, since it combines visual and textual data within a single representation space and it has inspired many upcoming works in this area. Then, Radford developed CLIP <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib15" title="">2021</a>)</cite> – Contrastive Language Image Pretraining, that translates into using descriptions in natural language to recognize visual concepts. Later, newer architectures were developed, which enabled better interaction of textual and visual data. Both of VisualBERT <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib10" title="">2019</a>)</cite> and ViLBERT <cite class="ltx_cite ltx_citemacro_cite">Lu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib12" title="">2019</a>)</cite> use transformer design as a part of their architecture to receive input in both visual and text views. LXMERT <cite class="ltx_cite ltx_citemacro_cite">Tan and Bansal (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib18" title="">2019</a>)</cite> is another example of the recent models, that suited to the more general-purpose multimodal tasks that involve better understanding of images and texts, such as visual question answering. One of the most recent works in this direction was the integration of multimodal data processing with object detection by use of MDETR <cite class="ltx_cite ltx_citemacro_cite">Kamath et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib8" title="">2021</a>)</cite>. It has very unique architecture, as it uses the attention mechanism in such an architecture to take control of the object detection process based on the textual description provided. Overall, the systems mentioned follow the trend of integrating visual and textual data that began with the very early models like DeViSE <cite class="ltx_cite ltx_citemacro_cite">Frome et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib5" title="">2013</a>)</cite> and CLIP <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib15" title="">2021</a>)</cite> and has expanded to include increasingly diverse tasks, from object recognition to translation.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>History of Image Retrieval Techniques</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Recent advancements in image retrieval have been significantly influenced by the integration of deep learning techniques, particularly with the shift from keyword-based methods to more advanced contextual analysis. Early approaches, such as Swain and Ballard’s color indexing, represented a move away from external keyword reliance towards leveraging intrinsic image features. Convolutional Neural Networks (CNNs) enabled the extraction of complex image features, improving the retrieval process by recognizing higher-level content within images. Multimodal learning, as explored by Srivastava and Salakhutdinov <cite class="ltx_cite ltx_citemacro_cite">Srivastava and Salakhutdinov (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib17" title="">2012</a>)</cite>, further developed the field by using both text and image data to learn deep representations. Models like AlexNet and more recent transformer-based architectures have refined the extraction and matching of image features with visual vocabularies, significantly enhancing task efficiency and enabling real-time processing, as shown by Joulin et al. (2016) <cite class="ltx_cite ltx_citemacro_cite">Joulin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib7" title="">2016</a>)</cite> and Radford et al. (2021) <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib15" title="">2021</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Dataset Development and Challenges</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">The creation of large-scale datasets such as COCO, Flickr 8k/30k, and ROCO has been essential for training and evaluating multimodal models, despite some criticisms regarding representativeness and cultural bias <cite class="ltx_cite ltx_citemacro_cite">Sharma et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib16" title="">2018</a>)</cite>. COCO, with its extensive collection of images and object categories, has played a key role in object detection tasks <cite class="ltx_cite ltx_citemacro_cite">Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib11" title="">2014</a>)</cite>, while specialized datasets like ROCO have addressed specific needs in medical imaging <cite class="ltx_cite ltx_citemacro_cite">Pino et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib14" title="">2019</a>)</cite>. However, challenges remain, particularly in low-resource language contexts where data scarcity and computational limitations reduce the effectiveness of multimodal models <cite class="ltx_cite ltx_citemacro_cite">Agić and Vulić (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib1" title="">2020</a>); Lewis and Denoyer (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib9" title="">2020</a>)</cite>. Recent developments in image and text encoding methods, including ResNet <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib6" title="">2016</a>)</cite>, Vision Transformers <cite class="ltx_cite ltx_citemacro_cite">Dosovitskiy et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib4" title="">2021</a>)</cite>, and BERT <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib2" title="">2019a</a>)</cite>, have advanced feature extraction and understanding. However, these advancements also highlight the need for efficient, adaptable models in environments with limited resources. Synthetic data generation, as demonstrated by Varol et al. (2017) <cite class="ltx_cite ltx_citemacro_cite">Varol et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib19" title="">2017</a>)</cite>, offers a valuable approach to addressing these challenges by providing high-quality training data where real data is scarce or sensitive.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Research Methodology</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Method</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The core of the system is based on two main components: an image encoder and a text encoder, which together process and compare visual and textual data. The image encoder uses a pretrained network (for example, ResNet50), which is adapted to ignore the final classification layer and instead focus on extracting feature representations of images. The text encoder is built around a BERT model that has been pretrained to understand multiple languages, making it suitable for processing text in various languages (BertModel from Hugging Face). To establish the connection between the image and text representations, we use a projection head on both encoders’ outputs. Accordingly, the component’s focus is to decrease the dimensionality of the outputs to the similar size. Meanwhile, the technique that allows to carry out the actual comparison of image and text features is contrastive loss, which also assists the model in understanding which images and texts it has been learned to relate.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Training a CLIP Model</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg1.l1.1">Input:</span> Training and validation datasets

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>Initialize tokenizer, image and text encoders, projection heads

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Load datasets and data loaders

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span> <span class="ltx_text ltx_font_typewriter" id="alg1.l4.2">epoch = 1, 2, ..., NumEpochs</span> <span class="ltx_text ltx_font_bold" id="alg1.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l5.1">for</span> <span class="ltx_text ltx_font_typewriter" id="alg1.l5.2">images, input_ids, attention_mask in train_loader</span> <span class="ltx_text ltx_font_bold" id="alg1.l5.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>         Move images, input_ids, attention_mask to device

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>         Zero the gradients

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>         Compute image and text embeddings

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>         Calculate contrastive loss

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>         Backpropagate error and update model weights

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>         Update learning rate

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>         Log loss and other metrics

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l13.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l13.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l14.2">if</span> <span class="ltx_text ltx_font_typewriter" id="alg1.l14.1">current loss <math alttext="&lt;" class="ltx_Math" display="inline" id="alg1.l14.1.m1.1"><semantics id="alg1.l14.1.m1.1a"><mo id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><lt id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.1.m1.1d">&lt;</annotation></semantics></math> best loss</span> <span class="ltx_text ltx_font_bold" id="alg1.l14.3">then</span>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>         Update best loss

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>         Save model checkpoint

</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l17.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l17.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span><span class="ltx_text ltx_font_bold" id="alg1.l18.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l18.2">for</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection ltx_pruned_first" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Dataset and Preprocessing</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">This research is based on multiple existing and recently collected datasets, enriched with Azerbaijani translations to facilitate more effective training in a less studied language in machine learning. A critical dataset is the MS COCO dataset, used for detailed image comprehension and object recognition. It contains a vast amount of visual information, with thorough descriptions and detailed segmentation, making it valuable for training models to understand complex scenes in natural settings (Lin et al., 2014) <cite class="ltx_cite ltx_citemacro_cite">Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib11" title="">2014</a>)</cite>. Another one is the Flickr30k dataset that comprises 31,000 images from Flickr, each described by five different captions detailing the scenes, objects, and activities depicted, enhancing the model’s ability to interpret and generate nuanced text about images (Young et al., 2014) <cite class="ltx_cite ltx_citemacro_cite">Young et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib20" title="">2014</a>)</cite>. The ROCO (Radiology Objects in Context) dataset includes medical imaging data, such as radiological scans paired with descriptive texts, extending the model’s capability to process and understand medical imagery (Pelka et al., 2018) <cite class="ltx_cite ltx_citemacro_cite">Pelka et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib13" title="">2018</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="429" id="S3.F2.g1" src="extracted/5812574/Figure/teaser.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S3.F2.2.1"> COCO Dataset</span>. Example images and captions from the Microsoft COCO Caption dataset <cite class="ltx_cite ltx_citemacro_cite">Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib11" title="">2014</a>)</cite>.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Generated Dataset for Azerbaijani Language</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">To support the Azerbaijani language, as it is low resource language, this study incorporates image-text pairs in Azerbaijani. What we have done is, we have translated more than half a million captions from COCO dataset from English to Azerbaijani, and 90% of Flickr30k captions (Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.F3" title="Figure 3 ‣ 3.2.1 Generated Dataset for Azerbaijani Language ‣ 3.2 Dataset and Preprocessing ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="348" id="S3.F3.g1" src="extracted/5812574/Figure/translation.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="ltx_text ltx_font_bold" id="S3.F3.2.1">Translation of Captions from Datasets</span>. Translation of Captions from COCO, Flickr30k and ROCO datasets.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">The datasets underwent several preprocessing steps to ensure high-quality data for model training:</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.SSS1.p3.1.1">Data Cleaning:</span> The main steps in preparing datasets involved the exclusion and removal of corrupt or irrelevant captions from ther dataset. There were some images that did not have 5 captions available for the, we needed to remove those samples since it creates bias in the dataset. We have also used other types of data cleaning techniques, to be sure that we do not have special characters and also noise in our dataset.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p4">
<p class="ltx_p" id="S3.SS2.SSS1.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.SSS1.p4.1.1">Text Translation:</span> Texts associated with images from the Microsoft COCO dataset, with over 500,000 captions, more than 40,000 captions from the Flickr dataset, and over 2,500 captions from the ROCO dataset, were translated into Azerbaijani to build a dataset that supports this language, broadening the model’s usability.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Image Encoders</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The architecture depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.F5" title="Figure 5 ‣ 3.4.1 Projection Head ‣ 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">5</span></a> efficiently processes both visual and textual data, enhancing performance on tasks involving both vision and language, especially in low-resource settings due to reduced data and computational needs. By integrating image encodings and text embeddings, and using smaller models, it avoids extensive fine-tuning while enhancing encoding capabilities through image augmentation and domain-specific text data, improving the attention mechanism within a multi-language BERT model. The image encoder utilizes pre-trained CNN models with the final layer modified to an identity mapping for rich image representation. Various CNN architectures, such as ResNet-50, EfficientNet-B0, Vision Transformer (ViT), Swin Transformer, and ConvNeXt, were tested for their feature extraction capabilities in multimodal retrieval tasks. Each model was evaluated on metrics such as top-1 and top-5 accuracy on ImageNet-1K, number of parameters, GFLOPS, and model file size, providing a basis for selecting the appropriate architecture based on specific application requirements.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.7">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.7.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.7.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.7.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.2.1">Top-1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.7.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.3.1">Top-5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.7.1.1.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.4.1">Params</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.7.1.1.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.5.1">GFLOPs</span></th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.7.1.1.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.7.1.1.6.1">Size</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.7.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.7.2.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">ResNet-50</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.2.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">76.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.2.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">92.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.2.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">25.6M</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.2.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">4.09</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S3.T1.7.2.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">97.8</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.3.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">EffNet-B0</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">77.69</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">93.53</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">5.29M</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.3.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.39</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.3.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">20.5</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.4.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">ViT Base</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.4.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">81.07</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.4.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">95.32</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.4.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">86.6M</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.4.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">17.56</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.4.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">330.3</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S3.T1.7.5.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">Swin-Tiny</th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.5.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">81.47</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.5.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">95.78</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.5.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">28.3M</td>
<td class="ltx_td ltx_align_center" id="S3.T1.7.5.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">4.49</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.7.5.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">108.2</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S3.T1.7.6.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">ConvNeXt T</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.6.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">82.52</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.6.5.3" style="padding-left:3.0pt;padding-right:3.0pt;">96.15</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.6.5.4" style="padding-left:3.0pt;padding-right:3.0pt;">28.6M</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.7.6.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">4.46</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S3.T1.7.6.5.6" style="padding-left:3.0pt;padding-right:3.0pt;">109.1</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Specs of DL Models on ImageNet-1K (1K categories). Top-1 and Top-5 are accuracy percentages. Size is in MB. Minimum input size: ResNet-50 and EffNet-B0: 1<math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.4.m1.1"><semantics id="S3.T1.4.m1.1b"><mo id="S3.T1.4.m1.1.1" xref="S3.T1.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.m1.1c"><times id="S3.T1.4.m1.1.1.cmml" xref="S3.T1.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.m1.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.m1.1e">×</annotation></semantics></math>1, ViT Base and Swin-Tiny: 224<math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.5.m2.1"><semantics id="S3.T1.5.m2.1b"><mo id="S3.T1.5.m2.1.1" xref="S3.T1.5.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T1.5.m2.1c"><times id="S3.T1.5.m2.1.1.cmml" xref="S3.T1.5.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.m2.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.m2.1e">×</annotation></semantics></math>224, ConvNeXt Tiny: 32<math alttext="\times" class="ltx_Math" display="inline" id="S3.T1.6.m3.1"><semantics id="S3.T1.6.m3.1b"><mo id="S3.T1.6.m3.1.1" xref="S3.T1.6.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.T1.6.m3.1c"><times id="S3.T1.6.m3.1.1.cmml" xref="S3.T1.6.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.m3.1d">\times</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.m3.1e">×</annotation></semantics></math>32.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Text Encoder</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">We employed a multilingual BERT <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib3" title="">2019b</a>)</cite> as our text encoder, optimized for low-resource languages with tokenization support for over 104 languages, ideal for applications requiring diverse linguistic support (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.F4" title="Figure 4 ‣ 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="320" id="S3.F4.g1" src="extracted/5812574/Figure/mbert.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S3.F4.2.1">Multilingual BERT training approach using masked language modeling</span>. <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib3" title="">2019b</a>)</cite></figcaption>
</figure>
<section class="ltx_subsubsection" id="S3.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.1 </span>Projection Head</h4>
<div class="ltx_para" id="S3.SS4.SSS1.p1">
<p class="ltx_p" id="S3.SS4.SSS1.p1.1">The image and text encoders feature a projection head to map high-dimensional features into a shared embedding space, enhancing contrastive learning efficiency (Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.F5" title="Figure 5 ‣ 3.4.1 Projection Head ‣ 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">5</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="305" id="S3.F5.g1" src="extracted/5812574/Figure/transformerr.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S3.F5.2.1">Projection Head:</span> Framework for computing compatibility scores for image-text pairs. <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#bib.bib15" title="">2021</a>)</cite></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.2 </span>Contrastive Learning Loss</h4>
<div class="ltx_para" id="S3.SS4.SSS2.p1">
<p class="ltx_p" id="S3.SS4.SSS2.p1.1">The model utilizes a contrastive learning loss, structured to maximize the similarity of correct image-text pairs while minimizing the similarity of incorrect ones, incorporating a margin-based penalty for better discrimination. (Equations (<a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.E1" title="In 3.4.2 Contrastive Learning Loss ‣ 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">1</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.E2" title="In 3.4.2 Contrastive Learning Loss ‣ 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">2</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.E3" title="In 3.4.2 Contrastive Learning Loss ‣ 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.E4" title="In 3.4.2 Contrastive Learning Loss ‣ 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div class="ltx_para" id="S3.SS4.SSS2.p2">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L" class="ltx_Math" display="inline" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle L</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_L</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=-\sum_{i=1}^{N}\left(L_{1}+L_{2}\right)" class="ltx_Math" display="inline" id="S3.E1.m2.1"><semantics id="S3.E1.m2.1a"><mrow id="S3.E1.m2.1.1" xref="S3.E1.m2.1.1.cmml"><mi id="S3.E1.m2.1.1.3" xref="S3.E1.m2.1.1.3.cmml"></mi><mo id="S3.E1.m2.1.1.2" xref="S3.E1.m2.1.1.2.cmml">=</mo><mrow id="S3.E1.m2.1.1.1" xref="S3.E1.m2.1.1.1.cmml"><mo id="S3.E1.m2.1.1.1a" xref="S3.E1.m2.1.1.1.cmml">−</mo><mrow id="S3.E1.m2.1.1.1.1" xref="S3.E1.m2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E1.m2.1.1.1.1.2" xref="S3.E1.m2.1.1.1.1.2.cmml"><munderover id="S3.E1.m2.1.1.1.1.2a" xref="S3.E1.m2.1.1.1.1.2.cmml"><mo id="S3.E1.m2.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E1.m2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m2.1.1.1.1.2.2.3" xref="S3.E1.m2.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m2.1.1.1.1.2.2.3.2" xref="S3.E1.m2.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m2.1.1.1.1.2.2.3.1" xref="S3.E1.m2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m2.1.1.1.1.2.2.3.3" xref="S3.E1.m2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m2.1.1.1.1.2.3" xref="S3.E1.m2.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E1.m2.1.1.1.1.1.1" xref="S3.E1.m2.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m2.1.1.1.1.1.1.2" xref="S3.E1.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m2.1.1.1.1.1.1.1" xref="S3.E1.m2.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m2.1.1.1.1.1.1.1.2" xref="S3.E1.m2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m2.1.1.1.1.1.1.1.2.2" xref="S3.E1.m2.1.1.1.1.1.1.1.2.2.cmml">L</mi><mn id="S3.E1.m2.1.1.1.1.1.1.1.2.3" xref="S3.E1.m2.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E1.m2.1.1.1.1.1.1.1.1" xref="S3.E1.m2.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E1.m2.1.1.1.1.1.1.1.3" xref="S3.E1.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m2.1.1.1.1.1.1.1.3.2" xref="S3.E1.m2.1.1.1.1.1.1.1.3.2.cmml">L</mi><mn id="S3.E1.m2.1.1.1.1.1.1.1.3.3" xref="S3.E1.m2.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S3.E1.m2.1.1.1.1.1.1.3" xref="S3.E1.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m2.1b"><apply id="S3.E1.m2.1.1.cmml" xref="S3.E1.m2.1.1"><eq id="S3.E1.m2.1.1.2.cmml" xref="S3.E1.m2.1.1.2"></eq><csymbol cd="latexml" id="S3.E1.m2.1.1.3.cmml" xref="S3.E1.m2.1.1.3">absent</csymbol><apply id="S3.E1.m2.1.1.1.cmml" xref="S3.E1.m2.1.1.1"><minus id="S3.E1.m2.1.1.1.2.cmml" xref="S3.E1.m2.1.1.1"></minus><apply id="S3.E1.m2.1.1.1.1.cmml" xref="S3.E1.m2.1.1.1.1"><apply id="S3.E1.m2.1.1.1.1.2.cmml" xref="S3.E1.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m2.1.1.1.1.2.1.cmml" xref="S3.E1.m2.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m2.1.1.1.1.2.2.cmml" xref="S3.E1.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m2.1.1.1.1.2.2.1.cmml" xref="S3.E1.m2.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m2.1.1.1.1.2.2.2.cmml" xref="S3.E1.m2.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m2.1.1.1.1.2.2.3.cmml" xref="S3.E1.m2.1.1.1.1.2.2.3"><eq id="S3.E1.m2.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m2.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m2.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m2.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E1.m2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m2.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m2.1.1.1.1.2.3.cmml" xref="S3.E1.m2.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E1.m2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m2.1.1.1.1.1.1"><plus id="S3.E1.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m2.1.1.1.1.1.1.1.1"></plus><apply id="S3.E1.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m2.1.1.1.1.1.1.1.2.2">𝐿</ci><cn id="S3.E1.m2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E1.m2.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E1.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m2.1.1.1.1.1.1.1.3.2">𝐿</ci><cn id="S3.E1.m2.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E1.m2.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m2.1c">\displaystyle=-\sum_{i=1}^{N}\left(L_{1}+L_{2}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m2.1d">= - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{1}" class="ltx_Math" display="inline" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><msub id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">L</mi><mn id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝐿</ci><cn id="S3.E2.m1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle L_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">italic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\log\frac{e^{s_{ii}}}{\sum_{j}e^{s_{ij}}}" class="ltx_Math" display="inline" id="S3.E2.m2.1"><semantics id="S3.E2.m2.1a"><mrow id="S3.E2.m2.1.1" xref="S3.E2.m2.1.1.cmml"><mi id="S3.E2.m2.1.1.2" xref="S3.E2.m2.1.1.2.cmml"></mi><mo id="S3.E2.m2.1.1.1" xref="S3.E2.m2.1.1.1.cmml">=</mo><mrow id="S3.E2.m2.1.1.3" xref="S3.E2.m2.1.1.3.cmml"><mi id="S3.E2.m2.1.1.3.1" xref="S3.E2.m2.1.1.3.1.cmml">log</mi><mo id="S3.E2.m2.1.1.3a" lspace="0.167em" xref="S3.E2.m2.1.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E2.m2.1.1.3.2" xref="S3.E2.m2.1.1.3.2.cmml"><mfrac id="S3.E2.m2.1.1.3.2a" xref="S3.E2.m2.1.1.3.2.cmml"><msup id="S3.E2.m2.1.1.3.2.2" xref="S3.E2.m2.1.1.3.2.2.cmml"><mi id="S3.E2.m2.1.1.3.2.2.2" xref="S3.E2.m2.1.1.3.2.2.2.cmml">e</mi><msub id="S3.E2.m2.1.1.3.2.2.3" xref="S3.E2.m2.1.1.3.2.2.3.cmml"><mi id="S3.E2.m2.1.1.3.2.2.3.2" xref="S3.E2.m2.1.1.3.2.2.3.2.cmml">s</mi><mrow id="S3.E2.m2.1.1.3.2.2.3.3" xref="S3.E2.m2.1.1.3.2.2.3.3.cmml"><mi id="S3.E2.m2.1.1.3.2.2.3.3.2" xref="S3.E2.m2.1.1.3.2.2.3.3.2.cmml">i</mi><mo id="S3.E2.m2.1.1.3.2.2.3.3.1" xref="S3.E2.m2.1.1.3.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E2.m2.1.1.3.2.2.3.3.3" xref="S3.E2.m2.1.1.3.2.2.3.3.3.cmml">i</mi></mrow></msub></msup><mrow id="S3.E2.m2.1.1.3.2.3" xref="S3.E2.m2.1.1.3.2.3.cmml"><msub id="S3.E2.m2.1.1.3.2.3.1" xref="S3.E2.m2.1.1.3.2.3.1.cmml"><mo id="S3.E2.m2.1.1.3.2.3.1.2" xref="S3.E2.m2.1.1.3.2.3.1.2.cmml">∑</mo><mi id="S3.E2.m2.1.1.3.2.3.1.3" xref="S3.E2.m2.1.1.3.2.3.1.3.cmml">j</mi></msub><msup id="S3.E2.m2.1.1.3.2.3.2" xref="S3.E2.m2.1.1.3.2.3.2.cmml"><mi id="S3.E2.m2.1.1.3.2.3.2.2" xref="S3.E2.m2.1.1.3.2.3.2.2.cmml">e</mi><msub id="S3.E2.m2.1.1.3.2.3.2.3" xref="S3.E2.m2.1.1.3.2.3.2.3.cmml"><mi id="S3.E2.m2.1.1.3.2.3.2.3.2" xref="S3.E2.m2.1.1.3.2.3.2.3.2.cmml">s</mi><mrow id="S3.E2.m2.1.1.3.2.3.2.3.3" xref="S3.E2.m2.1.1.3.2.3.2.3.3.cmml"><mi id="S3.E2.m2.1.1.3.2.3.2.3.3.2" xref="S3.E2.m2.1.1.3.2.3.2.3.3.2.cmml">i</mi><mo id="S3.E2.m2.1.1.3.2.3.2.3.3.1" xref="S3.E2.m2.1.1.3.2.3.2.3.3.1.cmml">⁢</mo><mi id="S3.E2.m2.1.1.3.2.3.2.3.3.3" xref="S3.E2.m2.1.1.3.2.3.2.3.3.3.cmml">j</mi></mrow></msub></msup></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.1b"><apply id="S3.E2.m2.1.1.cmml" xref="S3.E2.m2.1.1"><eq id="S3.E2.m2.1.1.1.cmml" xref="S3.E2.m2.1.1.1"></eq><csymbol cd="latexml" id="S3.E2.m2.1.1.2.cmml" xref="S3.E2.m2.1.1.2">absent</csymbol><apply id="S3.E2.m2.1.1.3.cmml" xref="S3.E2.m2.1.1.3"><log id="S3.E2.m2.1.1.3.1.cmml" xref="S3.E2.m2.1.1.3.1"></log><apply id="S3.E2.m2.1.1.3.2.cmml" xref="S3.E2.m2.1.1.3.2"><divide id="S3.E2.m2.1.1.3.2.1.cmml" xref="S3.E2.m2.1.1.3.2"></divide><apply id="S3.E2.m2.1.1.3.2.2.cmml" xref="S3.E2.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.3.2.2.1.cmml" xref="S3.E2.m2.1.1.3.2.2">superscript</csymbol><ci id="S3.E2.m2.1.1.3.2.2.2.cmml" xref="S3.E2.m2.1.1.3.2.2.2">𝑒</ci><apply id="S3.E2.m2.1.1.3.2.2.3.cmml" xref="S3.E2.m2.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.3.2.2.3.1.cmml" xref="S3.E2.m2.1.1.3.2.2.3">subscript</csymbol><ci id="S3.E2.m2.1.1.3.2.2.3.2.cmml" xref="S3.E2.m2.1.1.3.2.2.3.2">𝑠</ci><apply id="S3.E2.m2.1.1.3.2.2.3.3.cmml" xref="S3.E2.m2.1.1.3.2.2.3.3"><times id="S3.E2.m2.1.1.3.2.2.3.3.1.cmml" xref="S3.E2.m2.1.1.3.2.2.3.3.1"></times><ci id="S3.E2.m2.1.1.3.2.2.3.3.2.cmml" xref="S3.E2.m2.1.1.3.2.2.3.3.2">𝑖</ci><ci id="S3.E2.m2.1.1.3.2.2.3.3.3.cmml" xref="S3.E2.m2.1.1.3.2.2.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m2.1.1.3.2.3.cmml" xref="S3.E2.m2.1.1.3.2.3"><apply id="S3.E2.m2.1.1.3.2.3.1.cmml" xref="S3.E2.m2.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.3.2.3.1.1.cmml" xref="S3.E2.m2.1.1.3.2.3.1">subscript</csymbol><sum id="S3.E2.m2.1.1.3.2.3.1.2.cmml" xref="S3.E2.m2.1.1.3.2.3.1.2"></sum><ci id="S3.E2.m2.1.1.3.2.3.1.3.cmml" xref="S3.E2.m2.1.1.3.2.3.1.3">𝑗</ci></apply><apply id="S3.E2.m2.1.1.3.2.3.2.cmml" xref="S3.E2.m2.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.3.2.3.2.1.cmml" xref="S3.E2.m2.1.1.3.2.3.2">superscript</csymbol><ci id="S3.E2.m2.1.1.3.2.3.2.2.cmml" xref="S3.E2.m2.1.1.3.2.3.2.2">𝑒</ci><apply id="S3.E2.m2.1.1.3.2.3.2.3.cmml" xref="S3.E2.m2.1.1.3.2.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.3.2.3.2.3.1.cmml" xref="S3.E2.m2.1.1.3.2.3.2.3">subscript</csymbol><ci id="S3.E2.m2.1.1.3.2.3.2.3.2.cmml" xref="S3.E2.m2.1.1.3.2.3.2.3.2">𝑠</ci><apply id="S3.E2.m2.1.1.3.2.3.2.3.3.cmml" xref="S3.E2.m2.1.1.3.2.3.2.3.3"><times id="S3.E2.m2.1.1.3.2.3.2.3.3.1.cmml" xref="S3.E2.m2.1.1.3.2.3.2.3.3.1"></times><ci id="S3.E2.m2.1.1.3.2.3.2.3.3.2.cmml" xref="S3.E2.m2.1.1.3.2.3.2.3.3.2">𝑖</ci><ci id="S3.E2.m2.1.1.3.2.3.2.3.3.3.cmml" xref="S3.E2.m2.1.1.3.2.3.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.1c">\displaystyle=\log\frac{e^{s_{ii}}}{\sum_{j}e^{s_{ij}}}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m2.1d">= roman_log divide start_ARG italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle L_{2}" class="ltx_Math" display="inline" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><msub id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mi id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">L</mi><mn id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2">𝐿</ci><cn id="S3.E3.m1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\displaystyle L_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">italic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\lambda\cdot\left[\max(0,m-M_{ij})\right]^{2}" class="ltx_Math" display="inline" id="S3.E3.m2.3"><semantics id="S3.E3.m2.3a"><mrow id="S3.E3.m2.3.3" xref="S3.E3.m2.3.3.cmml"><mi id="S3.E3.m2.3.3.3" xref="S3.E3.m2.3.3.3.cmml"></mi><mo id="S3.E3.m2.3.3.2" xref="S3.E3.m2.3.3.2.cmml">=</mo><mrow id="S3.E3.m2.3.3.1" xref="S3.E3.m2.3.3.1.cmml"><mi id="S3.E3.m2.3.3.1.3" xref="S3.E3.m2.3.3.1.3.cmml">λ</mi><mo id="S3.E3.m2.3.3.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E3.m2.3.3.1.2.cmml">⋅</mo><msup id="S3.E3.m2.3.3.1.1" xref="S3.E3.m2.3.3.1.1.cmml"><mrow id="S3.E3.m2.3.3.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.2.cmml"><mo id="S3.E3.m2.3.3.1.1.1.1.2" xref="S3.E3.m2.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E3.m2.1.1" xref="S3.E3.m2.1.1.cmml">max</mi><mo id="S3.E3.m2.3.3.1.1.1.1.1.1a" xref="S3.E3.m2.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E3.m2.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m2.3.3.1.1.1.1.1.2.cmml">(</mo><mn id="S3.E3.m2.2.2" xref="S3.E3.m2.2.2.cmml">0</mn><mo id="S3.E3.m2.3.3.1.1.1.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2.cmml">m</mi><mo id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml">M</mi><mrow id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S3.E3.m2.3.3.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E3.m2.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m2.3.3.1.1.1.1.3" xref="S3.E3.m2.3.3.1.1.1.2.1.cmml">]</mo></mrow><mn id="S3.E3.m2.3.3.1.1.3" xref="S3.E3.m2.3.3.1.1.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m2.3b"><apply id="S3.E3.m2.3.3.cmml" xref="S3.E3.m2.3.3"><eq id="S3.E3.m2.3.3.2.cmml" xref="S3.E3.m2.3.3.2"></eq><csymbol cd="latexml" id="S3.E3.m2.3.3.3.cmml" xref="S3.E3.m2.3.3.3">absent</csymbol><apply id="S3.E3.m2.3.3.1.cmml" xref="S3.E3.m2.3.3.1"><ci id="S3.E3.m2.3.3.1.2.cmml" xref="S3.E3.m2.3.3.1.2">⋅</ci><ci id="S3.E3.m2.3.3.1.3.cmml" xref="S3.E3.m2.3.3.1.3">𝜆</ci><apply id="S3.E3.m2.3.3.1.1.cmml" xref="S3.E3.m2.3.3.1.1"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1">superscript</csymbol><apply id="S3.E3.m2.3.3.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m2.3.3.1.1.1.2.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1"><max id="S3.E3.m2.1.1.cmml" xref="S3.E3.m2.1.1"></max><cn id="S3.E3.m2.2.2.cmml" type="integer" xref="S3.E3.m2.2.2">0</cn><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1"><minus id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.2">𝑚</ci><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.2">𝑀</ci><apply id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3"><times id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m2.3.3.1.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><cn id="S3.E3.m2.3.3.1.1.3.cmml" type="integer" xref="S3.E3.m2.3.3.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m2.3c">\displaystyle=\lambda\cdot\left[\max(0,m-M_{ij})\right]^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m2.3d">= italic_λ ⋅ [ roman_max ( 0 , italic_m - italic_M start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) ] start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle M_{ij}" class="ltx_Math" display="inline" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><msub id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mi id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">M</mi><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">i</mi><mo id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2">𝑀</ci><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><times id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1"></times><ci id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">𝑖</ci><ci id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\displaystyle M_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">italic_M start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\min_{j\neq i}s_{ij}" class="ltx_Math" display="inline" id="S3.E4.m2.1"><semantics id="S3.E4.m2.1a"><mrow id="S3.E4.m2.1.1" xref="S3.E4.m2.1.1.cmml"><mi id="S3.E4.m2.1.1.2" xref="S3.E4.m2.1.1.2.cmml"></mi><mo id="S3.E4.m2.1.1.1" xref="S3.E4.m2.1.1.1.cmml">=</mo><mrow id="S3.E4.m2.1.1.3" xref="S3.E4.m2.1.1.3.cmml"><munder id="S3.E4.m2.1.1.3.1" xref="S3.E4.m2.1.1.3.1.cmml"><mi id="S3.E4.m2.1.1.3.1.2" xref="S3.E4.m2.1.1.3.1.2.cmml">min</mi><mrow id="S3.E4.m2.1.1.3.1.3" xref="S3.E4.m2.1.1.3.1.3.cmml"><mi id="S3.E4.m2.1.1.3.1.3.2" xref="S3.E4.m2.1.1.3.1.3.2.cmml">j</mi><mo id="S3.E4.m2.1.1.3.1.3.1" xref="S3.E4.m2.1.1.3.1.3.1.cmml">≠</mo><mi id="S3.E4.m2.1.1.3.1.3.3" xref="S3.E4.m2.1.1.3.1.3.3.cmml">i</mi></mrow></munder><mo id="S3.E4.m2.1.1.3a" lspace="0.167em" xref="S3.E4.m2.1.1.3.cmml">⁡</mo><msub id="S3.E4.m2.1.1.3.2" xref="S3.E4.m2.1.1.3.2.cmml"><mi id="S3.E4.m2.1.1.3.2.2" xref="S3.E4.m2.1.1.3.2.2.cmml">s</mi><mrow id="S3.E4.m2.1.1.3.2.3" xref="S3.E4.m2.1.1.3.2.3.cmml"><mi id="S3.E4.m2.1.1.3.2.3.2" xref="S3.E4.m2.1.1.3.2.3.2.cmml">i</mi><mo id="S3.E4.m2.1.1.3.2.3.1" xref="S3.E4.m2.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E4.m2.1.1.3.2.3.3" xref="S3.E4.m2.1.1.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m2.1b"><apply id="S3.E4.m2.1.1.cmml" xref="S3.E4.m2.1.1"><eq id="S3.E4.m2.1.1.1.cmml" xref="S3.E4.m2.1.1.1"></eq><csymbol cd="latexml" id="S3.E4.m2.1.1.2.cmml" xref="S3.E4.m2.1.1.2">absent</csymbol><apply id="S3.E4.m2.1.1.3.cmml" xref="S3.E4.m2.1.1.3"><apply id="S3.E4.m2.1.1.3.1.cmml" xref="S3.E4.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.3.1.1.cmml" xref="S3.E4.m2.1.1.3.1">subscript</csymbol><min id="S3.E4.m2.1.1.3.1.2.cmml" xref="S3.E4.m2.1.1.3.1.2"></min><apply id="S3.E4.m2.1.1.3.1.3.cmml" xref="S3.E4.m2.1.1.3.1.3"><neq id="S3.E4.m2.1.1.3.1.3.1.cmml" xref="S3.E4.m2.1.1.3.1.3.1"></neq><ci id="S3.E4.m2.1.1.3.1.3.2.cmml" xref="S3.E4.m2.1.1.3.1.3.2">𝑗</ci><ci id="S3.E4.m2.1.1.3.1.3.3.cmml" xref="S3.E4.m2.1.1.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m2.1.1.3.2.cmml" xref="S3.E4.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m2.1.1.3.2.1.cmml" xref="S3.E4.m2.1.1.3.2">subscript</csymbol><ci id="S3.E4.m2.1.1.3.2.2.cmml" xref="S3.E4.m2.1.1.3.2.2">𝑠</ci><apply id="S3.E4.m2.1.1.3.2.3.cmml" xref="S3.E4.m2.1.1.3.2.3"><times id="S3.E4.m2.1.1.3.2.3.1.cmml" xref="S3.E4.m2.1.1.3.2.3.1"></times><ci id="S3.E4.m2.1.1.3.2.3.2.cmml" xref="S3.E4.m2.1.1.3.2.3.2">𝑖</ci><ci id="S3.E4.m2.1.1.3.2.3.3.cmml" xref="S3.E4.m2.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m2.1c">\displaystyle=\min_{j\neq i}s_{ij}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m2.1d">= roman_min start_POSTSUBSCRIPT italic_j ≠ italic_i end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.3 </span>Enhancing Feature Extraction</h4>
<div class="ltx_para" id="S3.SS4.SSS3.p1">
<p class="ltx_p" id="S3.SS4.SSS3.p1.1">Adaptive Feature Learning and Multi-Resolution Feature Extraction techniques were introduced to optimize feature extraction from images, adjusting the network’s response based on the image content and processing images at various scales. Retraining Multilingual BERT with domain-specific data from Wikipedia and employing Hierarchical Attention Networks improve the model’s text feature extraction capabilities, allowing it to handle complex multi-modal inputs more efficiently. By integrating these techniques for both image and text feature extraction, the system achieves a more robust and adaptive feature extraction process, enhancing its overall performance in multi-modal tasks.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS4.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.4.4 </span>Training Procedure</h4>
<div class="ltx_para" id="S3.SS4.SSS4.p1">
<p class="ltx_p" id="S3.SS4.SSS4.p1.1">The training leverages AdamW optimizer and dynamic learning rate scheduling to optimize model performance. Regularization techniques such as dropout and data augmentation were implemented to combat overfitting (Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.13909v1#S3.F7" title="Figure 7 ‣ 3.4.4 Training Procedure ‣ 3.4 Text Encoder ‣ 3 Research Methodology ‣ LowCLIP: Adapting the CLIP Model Architecture for Low-Resource Languages in Multimodal Image Retrieval Task"><span class="ltx_text ltx_ref_tag">7</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F7.1" style="width:208.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="315" id="S3.F7.1.g1" src="extracted/5812574/Figure/base_model_loss.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text ltx_font_bold" id="S3.F7.1.2.1">Base Model (AzClip) Training Loss</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S3.F7.2" style="width:208.1pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="315" id="S3.F7.2.g1" src="extracted/5812574/Figure/epochs.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="ltx_text ltx_font_bold" id="S3.F7.2.2.1">Base Model (AzClip) Epochs</span></figcaption>
</figure>
</div>
</div>
</figure>
<figure class="ltx_table" id="S3.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1">Parameter</span></th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.2.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.2.2.1">Total number of parameters</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.2.2.2">192,309,312</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.3.3.1">Total number of trainable parameters</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.3.3.2">192,309,312</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.4.4.1">Total number of epochs</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.4.4.2">7</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.5.5.1">Used GPU</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.1.5.5.2">Nvidia T4</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S3.T2.1.6.6.1">Total number of training hours</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T2.1.6.6.2">37</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Summary of Base Model Training (Resnet50 + mBERT) Parameters</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Image Retrieval Process</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">The retrieval process begins by loading precomputed image embeddings, which are tensor representations of visual content from the MSCOCO dataset. We have pre computed the image embeddings and saved it on the local repository, this is one time task which helps to increase the speed and avoiding the waste of computation resources in each query. The trained model is then set to evaluation mode, which is disabling training specific operations such as dropout to maintain consistency during inference. Then the given input text, query is tokenized, padded, and truncated to ensure uniform length, and converted into a text embedding using a pre trained text encoder. Then the next task is projection of this embedding using a linear layer to align with the dimensions of the image embeddings, and normalizing to facilitate scale invariant comparisons. The similarity between the text and image embeddings is being calculated using the cosine similarity metric, which is mathematically represented as:</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Cosine Sim}(\mathbf{A},\mathbf{B})=\frac{\sum_{i=1}^{n}A_{i}\times B_{i}%
}{\sqrt{\sum_{i=1}^{n}A_{i}^{2}}\times\sqrt{\sum_{i=1}^{n}B_{i}^{2}}}" class="ltx_Math" display="block" id="S3.Ex1.m1.2"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.3" xref="S3.Ex1.m1.2.3.cmml"><mrow id="S3.Ex1.m1.2.3.2" xref="S3.Ex1.m1.2.3.2.cmml"><mtext id="S3.Ex1.m1.2.3.2.2" xref="S3.Ex1.m1.2.3.2.2a.cmml">Cosine Sim</mtext><mo id="S3.Ex1.m1.2.3.2.1" xref="S3.Ex1.m1.2.3.2.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.2.3.2.3.2" xref="S3.Ex1.m1.2.3.2.3.1.cmml"><mo id="S3.Ex1.m1.2.3.2.3.2.1" stretchy="false" xref="S3.Ex1.m1.2.3.2.3.1.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">𝐀</mi><mo id="S3.Ex1.m1.2.3.2.3.2.2" xref="S3.Ex1.m1.2.3.2.3.1.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">𝐁</mi><mo id="S3.Ex1.m1.2.3.2.3.2.3" stretchy="false" xref="S3.Ex1.m1.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.2.3.1" xref="S3.Ex1.m1.2.3.1.cmml">=</mo><mfrac id="S3.Ex1.m1.2.3.3" xref="S3.Ex1.m1.2.3.3.cmml"><mrow id="S3.Ex1.m1.2.3.3.2" xref="S3.Ex1.m1.2.3.3.2.cmml"><msubsup id="S3.Ex1.m1.2.3.3.2.1" xref="S3.Ex1.m1.2.3.3.2.1.cmml"><mo id="S3.Ex1.m1.2.3.3.2.1.2.2" xref="S3.Ex1.m1.2.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.2.3.3.2.1.2.3" xref="S3.Ex1.m1.2.3.3.2.1.2.3.cmml"><mi id="S3.Ex1.m1.2.3.3.2.1.2.3.2" xref="S3.Ex1.m1.2.3.3.2.1.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.2.3.3.2.1.2.3.1" xref="S3.Ex1.m1.2.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.2.3.3.2.1.2.3.3" xref="S3.Ex1.m1.2.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.2.3.3.2.1.3" xref="S3.Ex1.m1.2.3.3.2.1.3.cmml">n</mi></msubsup><mrow id="S3.Ex1.m1.2.3.3.2.2" xref="S3.Ex1.m1.2.3.3.2.2.cmml"><msub id="S3.Ex1.m1.2.3.3.2.2.2" xref="S3.Ex1.m1.2.3.3.2.2.2.cmml"><mi id="S3.Ex1.m1.2.3.3.2.2.2.2" xref="S3.Ex1.m1.2.3.3.2.2.2.2.cmml">A</mi><mi id="S3.Ex1.m1.2.3.3.2.2.2.3" xref="S3.Ex1.m1.2.3.3.2.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1.m1.2.3.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.2.3.3.2.2.1.cmml">×</mo><msub id="S3.Ex1.m1.2.3.3.2.2.3" xref="S3.Ex1.m1.2.3.3.2.2.3.cmml"><mi id="S3.Ex1.m1.2.3.3.2.2.3.2" xref="S3.Ex1.m1.2.3.3.2.2.3.2.cmml">B</mi><mi id="S3.Ex1.m1.2.3.3.2.2.3.3" xref="S3.Ex1.m1.2.3.3.2.2.3.3.cmml">i</mi></msub></mrow></mrow><mrow id="S3.Ex1.m1.2.3.3.3" xref="S3.Ex1.m1.2.3.3.3.cmml"><msqrt id="S3.Ex1.m1.2.3.3.3.2" xref="S3.Ex1.m1.2.3.3.3.2.cmml"><mrow id="S3.Ex1.m1.2.3.3.3.2.2" xref="S3.Ex1.m1.2.3.3.3.2.2.cmml"><msubsup id="S3.Ex1.m1.2.3.3.3.2.2.1" xref="S3.Ex1.m1.2.3.3.3.2.2.1.cmml"><mo id="S3.Ex1.m1.2.3.3.3.2.2.1.2.2" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.2.3.3.3.2.2.1.2.3" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.cmml"><mi id="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.2" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.1" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.3" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.2.3.3.3.2.2.1.3" xref="S3.Ex1.m1.2.3.3.3.2.2.1.3.cmml">n</mi></msubsup><msubsup id="S3.Ex1.m1.2.3.3.3.2.2.2" xref="S3.Ex1.m1.2.3.3.3.2.2.2.cmml"><mi id="S3.Ex1.m1.2.3.3.3.2.2.2.2.2" xref="S3.Ex1.m1.2.3.3.3.2.2.2.2.2.cmml">A</mi><mi id="S3.Ex1.m1.2.3.3.3.2.2.2.2.3" xref="S3.Ex1.m1.2.3.3.3.2.2.2.2.3.cmml">i</mi><mn id="S3.Ex1.m1.2.3.3.3.2.2.2.3" xref="S3.Ex1.m1.2.3.3.3.2.2.2.3.cmml">2</mn></msubsup></mrow></msqrt><mo id="S3.Ex1.m1.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.2.3.3.3.1.cmml">×</mo><msqrt id="S3.Ex1.m1.2.3.3.3.3" xref="S3.Ex1.m1.2.3.3.3.3.cmml"><mrow id="S3.Ex1.m1.2.3.3.3.3.2" xref="S3.Ex1.m1.2.3.3.3.3.2.cmml"><msubsup id="S3.Ex1.m1.2.3.3.3.3.2.1" xref="S3.Ex1.m1.2.3.3.3.3.2.1.cmml"><mo id="S3.Ex1.m1.2.3.3.3.3.2.1.2.2" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.Ex1.m1.2.3.3.3.3.2.1.2.3" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.cmml"><mi id="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.2" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.2.cmml">i</mi><mo id="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.1" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.3" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex1.m1.2.3.3.3.3.2.1.3" xref="S3.Ex1.m1.2.3.3.3.3.2.1.3.cmml">n</mi></msubsup><msubsup id="S3.Ex1.m1.2.3.3.3.3.2.2" xref="S3.Ex1.m1.2.3.3.3.3.2.2.cmml"><mi id="S3.Ex1.m1.2.3.3.3.3.2.2.2.2" xref="S3.Ex1.m1.2.3.3.3.3.2.2.2.2.cmml">B</mi><mi id="S3.Ex1.m1.2.3.3.3.3.2.2.2.3" xref="S3.Ex1.m1.2.3.3.3.3.2.2.2.3.cmml">i</mi><mn id="S3.Ex1.m1.2.3.3.3.3.2.2.3" xref="S3.Ex1.m1.2.3.3.3.3.2.2.3.cmml">2</mn></msubsup></mrow></msqrt></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.3.cmml" xref="S3.Ex1.m1.2.3"><eq id="S3.Ex1.m1.2.3.1.cmml" xref="S3.Ex1.m1.2.3.1"></eq><apply id="S3.Ex1.m1.2.3.2.cmml" xref="S3.Ex1.m1.2.3.2"><times id="S3.Ex1.m1.2.3.2.1.cmml" xref="S3.Ex1.m1.2.3.2.1"></times><ci id="S3.Ex1.m1.2.3.2.2a.cmml" xref="S3.Ex1.m1.2.3.2.2"><mtext id="S3.Ex1.m1.2.3.2.2.cmml" xref="S3.Ex1.m1.2.3.2.2">Cosine Sim</mtext></ci><interval closure="open" id="S3.Ex1.m1.2.3.2.3.1.cmml" xref="S3.Ex1.m1.2.3.2.3.2"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝐀</ci><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝐁</ci></interval></apply><apply id="S3.Ex1.m1.2.3.3.cmml" xref="S3.Ex1.m1.2.3.3"><divide id="S3.Ex1.m1.2.3.3.1.cmml" xref="S3.Ex1.m1.2.3.3"></divide><apply id="S3.Ex1.m1.2.3.3.2.cmml" xref="S3.Ex1.m1.2.3.3.2"><apply id="S3.Ex1.m1.2.3.3.2.1.cmml" xref="S3.Ex1.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.2.1.1.cmml" xref="S3.Ex1.m1.2.3.3.2.1">superscript</csymbol><apply id="S3.Ex1.m1.2.3.3.2.1.2.cmml" xref="S3.Ex1.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.2.1.2.1.cmml" xref="S3.Ex1.m1.2.3.3.2.1">subscript</csymbol><sum id="S3.Ex1.m1.2.3.3.2.1.2.2.cmml" xref="S3.Ex1.m1.2.3.3.2.1.2.2"></sum><apply id="S3.Ex1.m1.2.3.3.2.1.2.3.cmml" xref="S3.Ex1.m1.2.3.3.2.1.2.3"><eq id="S3.Ex1.m1.2.3.3.2.1.2.3.1.cmml" xref="S3.Ex1.m1.2.3.3.2.1.2.3.1"></eq><ci id="S3.Ex1.m1.2.3.3.2.1.2.3.2.cmml" xref="S3.Ex1.m1.2.3.3.2.1.2.3.2">𝑖</ci><cn id="S3.Ex1.m1.2.3.3.2.1.2.3.3.cmml" type="integer" xref="S3.Ex1.m1.2.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.2.3.3.2.1.3.cmml" xref="S3.Ex1.m1.2.3.3.2.1.3">𝑛</ci></apply><apply id="S3.Ex1.m1.2.3.3.2.2.cmml" xref="S3.Ex1.m1.2.3.3.2.2"><times id="S3.Ex1.m1.2.3.3.2.2.1.cmml" xref="S3.Ex1.m1.2.3.3.2.2.1"></times><apply id="S3.Ex1.m1.2.3.3.2.2.2.cmml" xref="S3.Ex1.m1.2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.2.2.2.1.cmml" xref="S3.Ex1.m1.2.3.3.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.2.3.3.2.2.2.2.cmml" xref="S3.Ex1.m1.2.3.3.2.2.2.2">𝐴</ci><ci id="S3.Ex1.m1.2.3.3.2.2.2.3.cmml" xref="S3.Ex1.m1.2.3.3.2.2.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.2.3.3.2.2.3.cmml" xref="S3.Ex1.m1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.2.2.3.1.cmml" xref="S3.Ex1.m1.2.3.3.2.2.3">subscript</csymbol><ci id="S3.Ex1.m1.2.3.3.2.2.3.2.cmml" xref="S3.Ex1.m1.2.3.3.2.2.3.2">𝐵</ci><ci id="S3.Ex1.m1.2.3.3.2.2.3.3.cmml" xref="S3.Ex1.m1.2.3.3.2.2.3.3">𝑖</ci></apply></apply></apply><apply id="S3.Ex1.m1.2.3.3.3.cmml" xref="S3.Ex1.m1.2.3.3.3"><times id="S3.Ex1.m1.2.3.3.3.1.cmml" xref="S3.Ex1.m1.2.3.3.3.1"></times><apply id="S3.Ex1.m1.2.3.3.3.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2"><root id="S3.Ex1.m1.2.3.3.3.2a.cmml" xref="S3.Ex1.m1.2.3.3.3.2"></root><apply id="S3.Ex1.m1.2.3.3.3.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2"><apply id="S3.Ex1.m1.2.3.3.3.2.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.2.2.1.1.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1">superscript</csymbol><apply id="S3.Ex1.m1.2.3.3.3.2.2.1.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.2.2.1.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1">subscript</csymbol><sum id="S3.Ex1.m1.2.3.3.3.2.2.1.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.2"></sum><apply id="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.3"><eq id="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.1.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.1"></eq><ci id="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.2">𝑖</ci><cn id="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.3.cmml" type="integer" xref="S3.Ex1.m1.2.3.3.3.2.2.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.2.3.3.3.2.2.1.3.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.1.3">𝑛</ci></apply><apply id="S3.Ex1.m1.2.3.3.3.2.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.2.2.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.2">superscript</csymbol><apply id="S3.Ex1.m1.2.3.3.3.2.2.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.2.2.2.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.2.3.3.3.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.2.2.2">𝐴</ci><ci id="S3.Ex1.m1.2.3.3.3.2.2.2.2.3.cmml" xref="S3.Ex1.m1.2.3.3.3.2.2.2.2.3">𝑖</ci></apply><cn id="S3.Ex1.m1.2.3.3.3.2.2.2.3.cmml" type="integer" xref="S3.Ex1.m1.2.3.3.3.2.2.2.3">2</cn></apply></apply></apply><apply id="S3.Ex1.m1.2.3.3.3.3.cmml" xref="S3.Ex1.m1.2.3.3.3.3"><root id="S3.Ex1.m1.2.3.3.3.3a.cmml" xref="S3.Ex1.m1.2.3.3.3.3"></root><apply id="S3.Ex1.m1.2.3.3.3.3.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2"><apply id="S3.Ex1.m1.2.3.3.3.3.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.3.2.1.1.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1">superscript</csymbol><apply id="S3.Ex1.m1.2.3.3.3.3.2.1.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.3.2.1.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1">subscript</csymbol><sum id="S3.Ex1.m1.2.3.3.3.3.2.1.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.2"></sum><apply id="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.3"><eq id="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.1.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.1"></eq><ci id="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.2">𝑖</ci><cn id="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.3.cmml" type="integer" xref="S3.Ex1.m1.2.3.3.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.Ex1.m1.2.3.3.3.3.2.1.3.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.1.3">𝑛</ci></apply><apply id="S3.Ex1.m1.2.3.3.3.3.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.3.2.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.2">superscript</csymbol><apply id="S3.Ex1.m1.2.3.3.3.3.2.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.3.3.3.3.2.2.2.1.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.2">subscript</csymbol><ci id="S3.Ex1.m1.2.3.3.3.3.2.2.2.2.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.2.2.2">𝐵</ci><ci id="S3.Ex1.m1.2.3.3.3.3.2.2.2.3.cmml" xref="S3.Ex1.m1.2.3.3.3.3.2.2.2.3">𝑖</ci></apply><cn id="S3.Ex1.m1.2.3.3.3.3.2.2.3.cmml" type="integer" xref="S3.Ex1.m1.2.3.3.3.3.2.2.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">\text{Cosine Sim}(\mathbf{A},\mathbf{B})=\frac{\sum_{i=1}^{n}A_{i}\times B_{i}%
}{\sqrt{\sum_{i=1}^{n}A_{i}^{2}}\times\sqrt{\sum_{i=1}^{n}B_{i}^{2}}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.2d">Cosine Sim ( bold_A , bold_B ) = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG × square-root start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.1">where:</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.3"><math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1"><semantics id="S3.I1.i1.p1.1.m1.1a"><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.1d">bold_A</annotation></semantics></math> and <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.1"><semantics id="S3.I1.i1.p1.2.m2.1a"><mi id="S3.I1.i1.p1.2.m2.1.1" xref="S3.I1.i1.p1.2.m2.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.1b"><ci id="S3.I1.i1.p1.2.m2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.2.m2.1d">bold_B</annotation></semantics></math> are two vectors of length <math alttext="n" class="ltx_Math" display="inline" id="S3.I1.i1.p1.3.m3.1"><semantics id="S3.I1.i1.p1.3.m3.1a"><mi id="S3.I1.i1.p1.3.m3.1.1" xref="S3.I1.i1.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.3.m3.1b"><ci id="S3.I1.i1.p1.3.m3.1.1.cmml" xref="S3.I1.i1.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.3.m3.1d">italic_n</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.4"><math alttext="A_{i}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><msub id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">A</mi><mi id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">𝐴</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">A_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_A start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="B_{i}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1"><semantics id="S3.I1.i2.p1.2.m2.1a"><msub id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml">B</mi><mi id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">𝐵</ci><ci id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">B_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.1d">italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are components of vectors <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.3.m3.1"><semantics id="S3.I1.i2.p1.3.m3.1a"><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.1b"><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.3.m3.1d">bold_A</annotation></semantics></math> and <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.4.m4.1"><semantics id="S3.I1.i2.p1.4.m4.1a"><mi id="S3.I1.i2.p1.4.m4.1.1" xref="S3.I1.i2.p1.4.m4.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.4.m4.1b"><ci id="S3.I1.i2.p1.4.m4.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.4.m4.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.4.m4.1d">bold_B</annotation></semantics></math> respectively.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS5.p4">
<p class="ltx_p" id="S3.SS5.p4.1">The indices of the top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS5.p4.1.m1.1"><semantics id="S3.SS5.p4.1.m1.1a"><mi id="S3.SS5.p4.1.m1.1.1" xref="S3.SS5.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p4.1.m1.1b"><ci id="S3.SS5.p4.1.m1.1.1.cmml" xref="S3.SS5.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p4.1.m1.1d">italic_k</annotation></semantics></math> images with the highest similarity scores are being identified. These indices are used to retrieve the corresponding image IDs from the dataset, which represent the images most similar to the given text description. The retrieval process concludes by outputting the image IDs of the images that best match the text query, demonstrating the effectiveness of the used text-to-image matching algorithm.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6 </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">For the evaluation of image retrieval tasks, it is important that metrics be chosen for use that effectively capture both accuracy and relevance to the query of the retrieved images. The following metrics have been used to quantify the performance of the image retrieval systems:

<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS6.p2.1.1">Precision</span>: Precision (P) measures the proportion of retrieved images that are relevant to the query. It is calculated using the formula:</p>
</div>
<div class="ltx_para" id="S3.SS6.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{P}=\frac{\text{Number of relevant images retrieved}}{\text{Total number %
of images retrieved}}" class="ltx_Math" display="block" id="S3.Ex2.m1.1"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml"><mtext id="S3.Ex2.m1.1.1.2" xref="S3.Ex2.m1.1.1.2a.cmml">P</mtext><mo id="S3.Ex2.m1.1.1.1" xref="S3.Ex2.m1.1.1.1.cmml">=</mo><mfrac id="S3.Ex2.m1.1.1.3" xref="S3.Ex2.m1.1.1.3.cmml"><mtext id="S3.Ex2.m1.1.1.3.2" xref="S3.Ex2.m1.1.1.3.2a.cmml">Number of relevant images retrieved</mtext><mtext id="S3.Ex2.m1.1.1.3.3" xref="S3.Ex2.m1.1.1.3.3a.cmml">Total number of images retrieved</mtext></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"><eq id="S3.Ex2.m1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1"></eq><ci id="S3.Ex2.m1.1.1.2a.cmml" xref="S3.Ex2.m1.1.1.2"><mtext id="S3.Ex2.m1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.2">P</mtext></ci><apply id="S3.Ex2.m1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.3"><divide id="S3.Ex2.m1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.3"></divide><ci id="S3.Ex2.m1.1.1.3.2a.cmml" xref="S3.Ex2.m1.1.1.3.2"><mtext id="S3.Ex2.m1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.3.2">Number of relevant images retrieved</mtext></ci><ci id="S3.Ex2.m1.1.1.3.3a.cmml" xref="S3.Ex2.m1.1.1.3.3"><mtext id="S3.Ex2.m1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.3.3">Total number of images retrieved</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\text{P}=\frac{\text{Number of relevant images retrieved}}{\text{Total number %
of images retrieved}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.1d">P = divide start_ARG Number of relevant images retrieved end_ARG start_ARG Total number of images retrieved end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS6.p4">
<p class="ltx_p" id="S3.SS6.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS6.p4.1.1">Recall</span>
Recall (R) quantifies the proportion of relevant images that are successfully retrieved. It is given by the formula:</p>
</div>
<div class="ltx_para" id="S3.SS6.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{R}=\frac{\text{Number of relevant images retrieved}}{\text{Total number %
of relevant images}}" class="ltx_Math" display="block" id="S3.Ex3.m1.1"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><mtext id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2a.cmml">R</mtext><mo id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml">=</mo><mfrac id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml"><mtext id="S3.Ex3.m1.1.1.3.2" xref="S3.Ex3.m1.1.1.3.2a.cmml">Number of relevant images retrieved</mtext><mtext id="S3.Ex3.m1.1.1.3.3" xref="S3.Ex3.m1.1.1.3.3a.cmml">Total number of relevant images</mtext></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><eq id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"></eq><ci id="S3.Ex3.m1.1.1.2a.cmml" xref="S3.Ex3.m1.1.1.2"><mtext id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2">R</mtext></ci><apply id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3"><divide id="S3.Ex3.m1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.3"></divide><ci id="S3.Ex3.m1.1.1.3.2a.cmml" xref="S3.Ex3.m1.1.1.3.2"><mtext id="S3.Ex3.m1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.3.2">Number of relevant images retrieved</mtext></ci><ci id="S3.Ex3.m1.1.1.3.3a.cmml" xref="S3.Ex3.m1.1.1.3.3"><mtext id="S3.Ex3.m1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.3.3">Total number of relevant images</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\text{R}=\frac{\text{Number of relevant images retrieved}}{\text{Total number %
of relevant images}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1d">R = divide start_ARG Number of relevant images retrieved end_ARG start_ARG Total number of relevant images end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<section class="ltx_subsubsection" id="S3.SS6.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.6.1 </span>Mean Average Precision (MAP)</h4>
<div class="ltx_para" id="S3.SS6.SSS1.p1">
<p class="ltx_p" id="S3.SS6.SSS1.p1.6">The mean average precision is a metric that collects average precision scores, after every relevant image retrieved, over all query images. This provides a compositional measure of how well all multiple retrievals do. The formula for MAP is:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MAP}=\frac{1}{Q}\sum_{q=1}^{Q}\left(\frac{1}{m_{q}}\sum_{k=1}^{m_{q}}%
\text{Precision}_{k}\right)" class="ltx_Math" display="block" id="S3.E5.m1.1"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mtext id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3a.cmml">MAP</mtext><mo id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mfrac id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml"><mn id="S3.E5.m1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.3.2.cmml">1</mn><mi id="S3.E5.m1.1.1.1.3.3" xref="S3.E5.m1.1.1.1.3.3.cmml">Q</mi></mfrac><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><munderover id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E5.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.1.1.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2.3.2" xref="S3.E5.m1.1.1.1.1.2.2.3.2.cmml">q</mi><mo id="S3.E5.m1.1.1.1.1.2.2.3.1" xref="S3.E5.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.1.1.1.1.2.2.3.3" xref="S3.E5.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.2.3.cmml">Q</mi></munderover><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml"><mfrac id="S3.E5.m1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.cmml"><mn id="S3.E5.m1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.2.cmml">1</mn><msub id="S3.E5.m1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3.3.cmml">q</mi></msub></mfrac><mo id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.cmml"><munderover id="S3.E5.m1.1.1.1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E5.m1.1.1.1.1.1.1.1.3.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.2.cmml">m</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.3.cmml">q</mi></msub></munderover><msub id="S3.E5.m1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2.cmml"><mtext id="S3.E5.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2.2a.cmml">Precision</mtext><mi id="S3.E5.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"></eq><ci id="S3.E5.m1.1.1.3a.cmml" xref="S3.E5.m1.1.1.3"><mtext id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3">MAP</mtext></ci><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><times id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></times><apply id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3"><divide id="S3.E5.m1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.3"></divide><cn id="S3.E5.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E5.m1.1.1.1.3.2">1</cn><ci id="S3.E5.m1.1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.1.3.3">𝑄</ci></apply><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2">subscript</csymbol><sum id="S3.E5.m1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2"></sum><apply id="S3.E5.m1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3"><eq id="S3.E5.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E5.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.3.2">𝑞</ci><cn id="S3.E5.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"></times><apply id="S3.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2"><divide id="S3.E5.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2"></divide><cn id="S3.E5.m1.1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.1.1.2.2">1</cn><apply id="S3.E5.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.2.3.3">𝑞</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3"><apply id="S3.E5.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.2">𝑘</ci><cn id="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.2">𝑚</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.1.3.3">𝑞</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.2.2a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2.2"><mtext id="S3.E5.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2.2">Precision</mtext></ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">\text{MAP}=\frac{1}{Q}\sum_{q=1}^{Q}\left(\frac{1}{m_{q}}\sum_{k=1}^{m_{q}}%
\text{Precision}_{k}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.1d">MAP = divide start_ARG 1 end_ARG start_ARG italic_Q end_ARG ∑ start_POSTSUBSCRIPT italic_q = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_m start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT Precision start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS6.SSS1.p1.5">where <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS6.SSS1.p1.1.m1.1"><semantics id="S3.SS6.SSS1.p1.1.m1.1a"><mi id="S3.SS6.SSS1.p1.1.m1.1.1" xref="S3.SS6.SSS1.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.p1.1.m1.1b"><ci id="S3.SS6.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS1.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.p1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.p1.1.m1.1d">italic_Q</annotation></semantics></math> is the number of queries, <math alttext="m_{q}" class="ltx_Math" display="inline" id="S3.SS6.SSS1.p1.2.m2.1"><semantics id="S3.SS6.SSS1.p1.2.m2.1a"><msub id="S3.SS6.SSS1.p1.2.m2.1.1" xref="S3.SS6.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS6.SSS1.p1.2.m2.1.1.2" xref="S3.SS6.SSS1.p1.2.m2.1.1.2.cmml">m</mi><mi id="S3.SS6.SSS1.p1.2.m2.1.1.3" xref="S3.SS6.SSS1.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.p1.2.m2.1b"><apply id="S3.SS6.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS6.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS6.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS6.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS6.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS6.SSS1.p1.2.m2.1.1.2">𝑚</ci><ci id="S3.SS6.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS6.SSS1.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.p1.2.m2.1c">m_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.p1.2.m2.1d">italic_m start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is the number of relevant images for query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS6.SSS1.p1.3.m3.1"><semantics id="S3.SS6.SSS1.p1.3.m3.1a"><mi id="S3.SS6.SSS1.p1.3.m3.1.1" xref="S3.SS6.SSS1.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.p1.3.m3.1b"><ci id="S3.SS6.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS6.SSS1.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.p1.3.m3.1d">italic_q</annotation></semantics></math>, and <math alttext="\text{Precision}_{k}" class="ltx_Math" display="inline" id="S3.SS6.SSS1.p1.4.m4.1"><semantics id="S3.SS6.SSS1.p1.4.m4.1a"><msub id="S3.SS6.SSS1.p1.4.m4.1.1" xref="S3.SS6.SSS1.p1.4.m4.1.1.cmml"><mtext id="S3.SS6.SSS1.p1.4.m4.1.1.2" xref="S3.SS6.SSS1.p1.4.m4.1.1.2a.cmml">Precision</mtext><mi id="S3.SS6.SSS1.p1.4.m4.1.1.3" xref="S3.SS6.SSS1.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.p1.4.m4.1b"><apply id="S3.SS6.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS6.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS6.SSS1.p1.4.m4.1.1.1.cmml" xref="S3.SS6.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS6.SSS1.p1.4.m4.1.1.2a.cmml" xref="S3.SS6.SSS1.p1.4.m4.1.1.2"><mtext id="S3.SS6.SSS1.p1.4.m4.1.1.2.cmml" xref="S3.SS6.SSS1.p1.4.m4.1.1.2">Precision</mtext></ci><ci id="S3.SS6.SSS1.p1.4.m4.1.1.3.cmml" xref="S3.SS6.SSS1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.p1.4.m4.1c">\text{Precision}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.p1.4.m4.1d">Precision start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the precision calculated at the cutoff <math alttext="k" class="ltx_Math" display="inline" id="S3.SS6.SSS1.p1.5.m5.1"><semantics id="S3.SS6.SSS1.p1.5.m5.1a"><mi id="S3.SS6.SSS1.p1.5.m5.1.1" xref="S3.SS6.SSS1.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS1.p1.5.m5.1b"><ci id="S3.SS6.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS6.SSS1.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS1.p1.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS1.p1.5.m5.1d">italic_k</annotation></semantics></math>, the point at which each relevant image is retrieved.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS6.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.6.2 </span>Mean Average Recall (MAR)</h4>
<div class="ltx_para" id="S3.SS6.SSS2.p1">
<p class="ltx_p" id="S3.SS6.SSS2.p1.6">Mean Average Recall (MAR) is a comprehensive metric that averages the recall scores after each relevant image is retrieved, across all queries. It provides an aggregated measure of performance across multiple query images. The formula for MAR is:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MAR}=\frac{1}{Q}\sum_{q=1}^{Q}\left(\frac{1}{m_{q}}\sum_{k=1}^{m_{q}}%
\text{Recall}_{k}\right)" class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mtext id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3a.cmml">MAR</mtext><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mfrac id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml"><mn id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.3.2.cmml">1</mn><mi id="S3.E6.m1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.3.3.cmml">Q</mi></mfrac><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><munderover id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E6.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.3.2" xref="S3.E6.m1.1.1.1.1.2.2.3.2.cmml">q</mi><mo id="S3.E6.m1.1.1.1.1.2.2.3.1" xref="S3.E6.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.1.1.1.1.2.2.3.3" xref="S3.E6.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3.cmml">Q</mi></munderover><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mfrac id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml"><mn id="S3.E6.m1.1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.2.cmml">1</mn><msub id="S3.E6.m1.1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.2.3.3.cmml">q</mi></msub></mfrac><mo id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.cmml"><munderover id="S3.E6.m1.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E6.m1.1.1.1.1.1.1.1.3.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.2.cmml">m</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.3.cmml">q</mi></msub></munderover><msub id="S3.E6.m1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2.cmml"><mtext id="S3.E6.m1.1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2.2a.cmml">Recall</mtext><mi id="S3.E6.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></eq><ci id="S3.E6.m1.1.1.3a.cmml" xref="S3.E6.m1.1.1.3"><mtext id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">MAR</mtext></ci><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><times id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3"><divide id="S3.E6.m1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.3"></divide><cn id="S3.E6.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E6.m1.1.1.1.3.2">1</cn><ci id="S3.E6.m1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3">𝑄</ci></apply><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2"></sum><apply id="S3.E6.m1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.3"><eq id="S3.E6.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.3.2">𝑞</ci><cn id="S3.E6.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2"><divide id="S3.E6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2"></divide><cn id="S3.E6.m1.1.1.1.1.1.1.1.2.2.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.1.1.2.2">1</cn><apply id="S3.E6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2.3.3">𝑞</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3"><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.2">𝑘</ci><cn id="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.2">𝑚</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.1.3.3">𝑞</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.2.2a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2.2"><mtext id="S3.E6.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2.2">Recall</mtext></ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\text{MAR}=\frac{1}{Q}\sum_{q=1}^{Q}\left(\frac{1}{m_{q}}\sum_{k=1}^{m_{q}}%
\text{Recall}_{k}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">MAR = divide start_ARG 1 end_ARG start_ARG italic_Q end_ARG ∑ start_POSTSUBSCRIPT italic_q = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ( divide start_ARG 1 end_ARG start_ARG italic_m start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_POSTSUPERSCRIPT Recall start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS6.SSS2.p1.5">where <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS6.SSS2.p1.1.m1.1"><semantics id="S3.SS6.SSS2.p1.1.m1.1a"><mi id="S3.SS6.SSS2.p1.1.m1.1.1" xref="S3.SS6.SSS2.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.p1.1.m1.1b"><ci id="S3.SS6.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS2.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.p1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.p1.1.m1.1d">italic_Q</annotation></semantics></math> is the number of queries, <math alttext="m_{q}" class="ltx_Math" display="inline" id="S3.SS6.SSS2.p1.2.m2.1"><semantics id="S3.SS6.SSS2.p1.2.m2.1a"><msub id="S3.SS6.SSS2.p1.2.m2.1.1" xref="S3.SS6.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS6.SSS2.p1.2.m2.1.1.2" xref="S3.SS6.SSS2.p1.2.m2.1.1.2.cmml">m</mi><mi id="S3.SS6.SSS2.p1.2.m2.1.1.3" xref="S3.SS6.SSS2.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.p1.2.m2.1b"><apply id="S3.SS6.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS6.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS6.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS6.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS6.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS6.SSS2.p1.2.m2.1.1.2">𝑚</ci><ci id="S3.SS6.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS6.SSS2.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.p1.2.m2.1c">m_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.p1.2.m2.1d">italic_m start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is the number of relevant images for query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS6.SSS2.p1.3.m3.1"><semantics id="S3.SS6.SSS2.p1.3.m3.1a"><mi id="S3.SS6.SSS2.p1.3.m3.1.1" xref="S3.SS6.SSS2.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.p1.3.m3.1b"><ci id="S3.SS6.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS6.SSS2.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.p1.3.m3.1d">italic_q</annotation></semantics></math>, and <math alttext="\text{Recall}_{k}" class="ltx_Math" display="inline" id="S3.SS6.SSS2.p1.4.m4.1"><semantics id="S3.SS6.SSS2.p1.4.m4.1a"><msub id="S3.SS6.SSS2.p1.4.m4.1.1" xref="S3.SS6.SSS2.p1.4.m4.1.1.cmml"><mtext id="S3.SS6.SSS2.p1.4.m4.1.1.2" xref="S3.SS6.SSS2.p1.4.m4.1.1.2a.cmml">Recall</mtext><mi id="S3.SS6.SSS2.p1.4.m4.1.1.3" xref="S3.SS6.SSS2.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.p1.4.m4.1b"><apply id="S3.SS6.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS6.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS6.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS6.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS6.SSS2.p1.4.m4.1.1.2a.cmml" xref="S3.SS6.SSS2.p1.4.m4.1.1.2"><mtext id="S3.SS6.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS6.SSS2.p1.4.m4.1.1.2">Recall</mtext></ci><ci id="S3.SS6.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS6.SSS2.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.p1.4.m4.1c">\text{Recall}_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.p1.4.m4.1d">Recall start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the recall calculated at the cutoff <math alttext="k" class="ltx_Math" display="inline" id="S3.SS6.SSS2.p1.5.m5.1"><semantics id="S3.SS6.SSS2.p1.5.m5.1a"><mi id="S3.SS6.SSS2.p1.5.m5.1.1" xref="S3.SS6.SSS2.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS2.p1.5.m5.1b"><ci id="S3.SS6.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS6.SSS2.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS2.p1.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS2.p1.5.m5.1d">italic_k</annotation></semantics></math>, the point at which each relevant image is retrieved.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS6.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.6.3 </span>Mean Average F1 Score (MAF1)</h4>
<div class="ltx_para" id="S3.SS6.SSS3.p1">
<p class="ltx_p" id="S3.SS6.SSS3.p1.6">The Mean Average F1 Score (MAF1) is a comprehensive metric that averages the F1 scores after each relevant image is retrieved, across all queries. It is particularly useful in balancing the consideration of both precision and recall, especially in scenarios with an uneven distribution of relevant and irrelevant images. The formula for MAF1 is:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MAF1}=\frac{1}{Q}\sum_{q=1}^{Q}\left(F1_{q}\right)" class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mtext id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3a.cmml">MAF1</mtext><mo id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mfrac id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml"><mn id="S3.E7.m1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.3.2.cmml">1</mn><mi id="S3.E7.m1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.3.3.cmml">Q</mi></mfrac><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><munderover id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E7.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E7.m1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.2.2.3.2" xref="S3.E7.m1.1.1.1.1.2.2.3.2.cmml">q</mi><mo id="S3.E7.m1.1.1.1.1.2.2.3.1" xref="S3.E7.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E7.m1.1.1.1.1.2.2.3.3" xref="S3.E7.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.2.3.cmml">Q</mi></munderover><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.cmml">F</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E7.m1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E7.m1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3.cmml">q</mi></msub></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"></eq><ci id="S3.E7.m1.1.1.3a.cmml" xref="S3.E7.m1.1.1.3"><mtext id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3">MAF1</mtext></ci><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><times id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3"><divide id="S3.E7.m1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.3"></divide><cn id="S3.E7.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E7.m1.1.1.1.3.2">1</cn><ci id="S3.E7.m1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.3.3">𝑄</ci></apply><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.2"></sum><apply id="S3.E7.m1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.2.3"><eq id="S3.E7.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E7.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.2.2.3.2">𝑞</ci><cn id="S3.E7.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1"></times><ci id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.2">𝐹</ci><apply id="S3.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3">subscript</csymbol><cn id="S3.E7.m1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.1.1.1.3.2">1</cn><ci id="S3.E7.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\text{MAF1}=\frac{1}{Q}\sum_{q=1}^{Q}\left(F1_{q}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">MAF1 = divide start_ARG 1 end_ARG start_ARG italic_Q end_ARG ∑ start_POSTSUBSCRIPT italic_q = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ( italic_F 1 start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS6.SSS3.p1.3">where <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS6.SSS3.p1.1.m1.1"><semantics id="S3.SS6.SSS3.p1.1.m1.1a"><mi id="S3.SS6.SSS3.p1.1.m1.1.1" xref="S3.SS6.SSS3.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS3.p1.1.m1.1b"><ci id="S3.SS6.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS3.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS3.p1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS3.p1.1.m1.1d">italic_Q</annotation></semantics></math> is the number of queries, and <math alttext="F1_{q}" class="ltx_Math" display="inline" id="S3.SS6.SSS3.p1.2.m2.1"><semantics id="S3.SS6.SSS3.p1.2.m2.1a"><mrow id="S3.SS6.SSS3.p1.2.m2.1.1" xref="S3.SS6.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS6.SSS3.p1.2.m2.1.1.2" xref="S3.SS6.SSS3.p1.2.m2.1.1.2.cmml">F</mi><mo id="S3.SS6.SSS3.p1.2.m2.1.1.1" xref="S3.SS6.SSS3.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S3.SS6.SSS3.p1.2.m2.1.1.3" xref="S3.SS6.SSS3.p1.2.m2.1.1.3.cmml"><mn id="S3.SS6.SSS3.p1.2.m2.1.1.3.2" xref="S3.SS6.SSS3.p1.2.m2.1.1.3.2.cmml">1</mn><mi id="S3.SS6.SSS3.p1.2.m2.1.1.3.3" xref="S3.SS6.SSS3.p1.2.m2.1.1.3.3.cmml">q</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS3.p1.2.m2.1b"><apply id="S3.SS6.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS6.SSS3.p1.2.m2.1.1"><times id="S3.SS6.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS6.SSS3.p1.2.m2.1.1.1"></times><ci id="S3.SS6.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS6.SSS3.p1.2.m2.1.1.2">𝐹</ci><apply id="S3.SS6.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS6.SSS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS6.SSS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS6.SSS3.p1.2.m2.1.1.3">subscript</csymbol><cn id="S3.SS6.SSS3.p1.2.m2.1.1.3.2.cmml" type="integer" xref="S3.SS6.SSS3.p1.2.m2.1.1.3.2">1</cn><ci id="S3.SS6.SSS3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS6.SSS3.p1.2.m2.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS3.p1.2.m2.1c">F1_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS3.p1.2.m2.1d">italic_F 1 start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> is the F1-score for query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS6.SSS3.p1.3.m3.1"><semantics id="S3.SS6.SSS3.p1.3.m3.1a"><mi id="S3.SS6.SSS3.p1.3.m3.1.1" xref="S3.SS6.SSS3.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS3.p1.3.m3.1b"><ci id="S3.SS6.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS6.SSS3.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS3.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS3.p1.3.m3.1d">italic_q</annotation></semantics></math>, calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="F1_{q}=2\cdot\frac{\text{Precision}_{q}\cdot\text{Recall}_{q}}{\text{Precision%
}_{q}+\text{Recall}_{q}}" class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mrow id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml"><mi id="S3.E8.m1.1.1.2.2" xref="S3.E8.m1.1.1.2.2.cmml">F</mi><mo id="S3.E8.m1.1.1.2.1" xref="S3.E8.m1.1.1.2.1.cmml">⁢</mo><msub id="S3.E8.m1.1.1.2.3" xref="S3.E8.m1.1.1.2.3.cmml"><mn id="S3.E8.m1.1.1.2.3.2" xref="S3.E8.m1.1.1.2.3.2.cmml">1</mn><mi id="S3.E8.m1.1.1.2.3.3" xref="S3.E8.m1.1.1.2.3.3.cmml">q</mi></msub></mrow><mo id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><mn id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml">2</mn><mo id="S3.E8.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8.m1.1.1.3.1.cmml">⋅</mo><mfrac id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml"><mrow id="S3.E8.m1.1.1.3.3.2" xref="S3.E8.m1.1.1.3.3.2.cmml"><msub id="S3.E8.m1.1.1.3.3.2.2" xref="S3.E8.m1.1.1.3.3.2.2.cmml"><mtext id="S3.E8.m1.1.1.3.3.2.2.2" xref="S3.E8.m1.1.1.3.3.2.2.2a.cmml">Precision</mtext><mi id="S3.E8.m1.1.1.3.3.2.2.3" xref="S3.E8.m1.1.1.3.3.2.2.3.cmml">q</mi></msub><mo id="S3.E8.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E8.m1.1.1.3.3.2.1.cmml">⋅</mo><msub id="S3.E8.m1.1.1.3.3.2.3" xref="S3.E8.m1.1.1.3.3.2.3.cmml"><mtext id="S3.E8.m1.1.1.3.3.2.3.2" xref="S3.E8.m1.1.1.3.3.2.3.2a.cmml">Recall</mtext><mi id="S3.E8.m1.1.1.3.3.2.3.3" xref="S3.E8.m1.1.1.3.3.2.3.3.cmml">q</mi></msub></mrow><mrow id="S3.E8.m1.1.1.3.3.3" xref="S3.E8.m1.1.1.3.3.3.cmml"><msub id="S3.E8.m1.1.1.3.3.3.2" xref="S3.E8.m1.1.1.3.3.3.2.cmml"><mtext id="S3.E8.m1.1.1.3.3.3.2.2" xref="S3.E8.m1.1.1.3.3.3.2.2a.cmml">Precision</mtext><mi id="S3.E8.m1.1.1.3.3.3.2.3" xref="S3.E8.m1.1.1.3.3.3.2.3.cmml">q</mi></msub><mo id="S3.E8.m1.1.1.3.3.3.1" xref="S3.E8.m1.1.1.3.3.3.1.cmml">+</mo><msub id="S3.E8.m1.1.1.3.3.3.3" xref="S3.E8.m1.1.1.3.3.3.3.cmml"><mtext id="S3.E8.m1.1.1.3.3.3.3.2" xref="S3.E8.m1.1.1.3.3.3.3.2a.cmml">Recall</mtext><mi id="S3.E8.m1.1.1.3.3.3.3.3" xref="S3.E8.m1.1.1.3.3.3.3.3.cmml">q</mi></msub></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"></eq><apply id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"><times id="S3.E8.m1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.2.1"></times><ci id="S3.E8.m1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.2.2">𝐹</ci><apply id="S3.E8.m1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.3.1.cmml" xref="S3.E8.m1.1.1.2.3">subscript</csymbol><cn id="S3.E8.m1.1.1.2.3.2.cmml" type="integer" xref="S3.E8.m1.1.1.2.3.2">1</cn><ci id="S3.E8.m1.1.1.2.3.3.cmml" xref="S3.E8.m1.1.1.2.3.3">𝑞</ci></apply></apply><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><ci id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3.1">⋅</ci><cn id="S3.E8.m1.1.1.3.2.cmml" type="integer" xref="S3.E8.m1.1.1.3.2">2</cn><apply id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3"><divide id="S3.E8.m1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.3.3"></divide><apply id="S3.E8.m1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.3.3.2"><ci id="S3.E8.m1.1.1.3.3.2.1.cmml" xref="S3.E8.m1.1.1.3.3.2.1">⋅</ci><apply id="S3.E8.m1.1.1.3.3.2.2.cmml" xref="S3.E8.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.2.2.1.cmml" xref="S3.E8.m1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E8.m1.1.1.3.3.2.2.2a.cmml" xref="S3.E8.m1.1.1.3.3.2.2.2"><mtext id="S3.E8.m1.1.1.3.3.2.2.2.cmml" xref="S3.E8.m1.1.1.3.3.2.2.2">Precision</mtext></ci><ci id="S3.E8.m1.1.1.3.3.2.2.3.cmml" xref="S3.E8.m1.1.1.3.3.2.2.3">𝑞</ci></apply><apply id="S3.E8.m1.1.1.3.3.2.3.cmml" xref="S3.E8.m1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.2.3.1.cmml" xref="S3.E8.m1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.3.2.3.2a.cmml" xref="S3.E8.m1.1.1.3.3.2.3.2"><mtext id="S3.E8.m1.1.1.3.3.2.3.2.cmml" xref="S3.E8.m1.1.1.3.3.2.3.2">Recall</mtext></ci><ci id="S3.E8.m1.1.1.3.3.2.3.3.cmml" xref="S3.E8.m1.1.1.3.3.2.3.3">𝑞</ci></apply></apply><apply id="S3.E8.m1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.3.3.3"><plus id="S3.E8.m1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.1.1.3.3.3.1"></plus><apply id="S3.E8.m1.1.1.3.3.3.2.cmml" xref="S3.E8.m1.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.3.2.1.cmml" xref="S3.E8.m1.1.1.3.3.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.3.3.3.2.2a.cmml" xref="S3.E8.m1.1.1.3.3.3.2.2"><mtext id="S3.E8.m1.1.1.3.3.3.2.2.cmml" xref="S3.E8.m1.1.1.3.3.3.2.2">Precision</mtext></ci><ci id="S3.E8.m1.1.1.3.3.3.2.3.cmml" xref="S3.E8.m1.1.1.3.3.3.2.3">𝑞</ci></apply><apply id="S3.E8.m1.1.1.3.3.3.3.cmml" xref="S3.E8.m1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.3.3.1.cmml" xref="S3.E8.m1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.3.3.3.2a.cmml" xref="S3.E8.m1.1.1.3.3.3.3.2"><mtext id="S3.E8.m1.1.1.3.3.3.3.2.cmml" xref="S3.E8.m1.1.1.3.3.3.3.2">Recall</mtext></ci><ci id="S3.E8.m1.1.1.3.3.3.3.3.cmml" xref="S3.E8.m1.1.1.3.3.3.3.3">𝑞</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">F1_{q}=2\cdot\frac{\text{Precision}_{q}\cdot\text{Recall}_{q}}{\text{Precision%
}_{q}+\text{Recall}_{q}}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">italic_F 1 start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = 2 ⋅ divide start_ARG Precision start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ⋅ Recall start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG start_ARG Precision start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT + Recall start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS6.SSS3.p1.5">Precision<sub class="ltx_sub" id="S3.SS6.SSS3.p1.5.1"><span class="ltx_text ltx_font_italic" id="S3.SS6.SSS3.p1.5.1.1">q</span></sub> and Recall<sub class="ltx_sub" id="S3.SS6.SSS3.p1.5.2"><span class="ltx_text ltx_font_italic" id="S3.SS6.SSS3.p1.5.2.1">q</span></sub> are calculated at the point of each relevant retrieval, ensuring that the metric reflects the balance of retrieval effectiveness across all queries.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS6.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.6.4 </span>Mean Average Accuracy (Top-k Accuracy)</h4>
<div class="ltx_para" id="S3.SS6.SSS4.p1">
<p class="ltx_p" id="S3.SS6.SSS4.p1.2">The Mean Average Accuracy for Top-k (where <math alttext="k" class="ltx_Math" display="inline" id="S3.SS6.SSS4.p1.1.m1.1"><semantics id="S3.SS6.SSS4.p1.1.m1.1a"><mi id="S3.SS6.SSS4.p1.1.m1.1.1" xref="S3.SS6.SSS4.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS4.p1.1.m1.1b"><ci id="S3.SS6.SSS4.p1.1.m1.1.1.cmml" xref="S3.SS6.SSS4.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS4.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS4.p1.1.m1.1d">italic_k</annotation></semantics></math> is 1, 5, or 10) is a critical metric that measures the accuracy of a model in identifying the correct answer within the top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS6.SSS4.p1.2.m2.1"><semantics id="S3.SS6.SSS4.p1.2.m2.1a"><mi id="S3.SS6.SSS4.p1.2.m2.1.1" xref="S3.SS6.SSS4.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS4.p1.2.m2.1b"><ci id="S3.SS6.SSS4.p1.2.m2.1.1.cmml" xref="S3.SS6.SSS4.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS4.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS4.p1.2.m2.1d">italic_k</annotation></semantics></math> predictions across all queries. This metric is particularly significant in scenarios where multiple potential correct answers are acceptable, but the precise ranking of those answers is less critical. The formulas for Mean Average Top-1, Top-5, and Top-10 Accuracy is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Mean Avg Top-}k\text{-Accuracy}=\begin{aligned} &amp;\frac{1}{Q}\sum_{q=1}^{%
Q}\left(\text{Accuracy}_{q}^{(k)}\right)\end{aligned}" class="ltx_Math" display="block" id="S3.E9.m1.2"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.3" xref="S3.E9.m1.2.3.cmml"><mrow id="S3.E9.m1.2.3.2" xref="S3.E9.m1.2.3.2.cmml"><mtext id="S3.E9.m1.2.3.2.2" xref="S3.E9.m1.2.3.2.2a.cmml">Mean Avg Top-</mtext><mo id="S3.E9.m1.2.3.2.1" xref="S3.E9.m1.2.3.2.1.cmml">⁢</mo><mi id="S3.E9.m1.2.3.2.3" xref="S3.E9.m1.2.3.2.3.cmml">k</mi><mo id="S3.E9.m1.2.3.2.1a" xref="S3.E9.m1.2.3.2.1.cmml">⁢</mo><mtext id="S3.E9.m1.2.3.2.4" xref="S3.E9.m1.2.3.2.4a.cmml">-Accuracy</mtext></mrow><mo id="S3.E9.m1.2.3.1" xref="S3.E9.m1.2.3.1.cmml">=</mo><mtable columnspacing="0pt" displaystyle="true" id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mtr id="S3.E9.m1.2.2a" xref="S3.E9.m1.2.2.cmml"><mtd id="S3.E9.m1.2.2b" xref="S3.E9.m1.2.2.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.2.2c" xref="S3.E9.m1.2.2.cmml"><mrow id="S3.E9.m1.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.cmml"><mfrac id="S3.E9.m1.2.2.2.2.2.4" xref="S3.E9.m1.2.2.2.2.2.4.cmml"><mn id="S3.E9.m1.2.2.2.2.2.4.2" xref="S3.E9.m1.2.2.2.2.2.4.2.cmml">1</mn><mi id="S3.E9.m1.2.2.2.2.2.4.3" xref="S3.E9.m1.2.2.2.2.2.4.3.cmml">Q</mi></mfrac><mo id="S3.E9.m1.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.3.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.cmml"><munderover id="S3.E9.m1.2.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.2.cmml"><mo id="S3.E9.m1.2.2.2.2.2.2.2.2.2" movablelimits="false" rspace="0em" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E9.m1.2.2.2.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.2.2.2.3.cmml"><mi id="S3.E9.m1.2.2.2.2.2.2.2.2.3.2" xref="S3.E9.m1.2.2.2.2.2.2.2.2.3.2.cmml">q</mi><mo id="S3.E9.m1.2.2.2.2.2.2.2.2.3.1" xref="S3.E9.m1.2.2.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E9.m1.2.2.2.2.2.2.2.2.3.3" xref="S3.E9.m1.2.2.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E9.m1.2.2.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.2.2.3.cmml">Q</mi></munderover><mrow id="S3.E9.m1.2.2.2.2.2.2.1.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="S3.E9.m1.2.2.2.2.2.2.1.1.2" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S3.E9.m1.2.2.2.2.2.2.1.1.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.cmml"><mtext id="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.2" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.2a.cmml">Accuracy</mtext><mi id="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.3" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.3.cmml">q</mi><mrow id="S3.E9.m1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="S3.E9.m1.1.1.1.1.1.1.1.3.1" stretchy="false" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">k</mi><mo id="S3.E9.m1.1.1.1.1.1.1.1.3.2" stretchy="false" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E9.m1.2.2.2.2.2.2.1.1.3" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr></mtable></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.3.cmml" xref="S3.E9.m1.2.3"><eq id="S3.E9.m1.2.3.1.cmml" xref="S3.E9.m1.2.3.1"></eq><apply id="S3.E9.m1.2.3.2.cmml" xref="S3.E9.m1.2.3.2"><times id="S3.E9.m1.2.3.2.1.cmml" xref="S3.E9.m1.2.3.2.1"></times><ci id="S3.E9.m1.2.3.2.2a.cmml" xref="S3.E9.m1.2.3.2.2"><mtext id="S3.E9.m1.2.3.2.2.cmml" xref="S3.E9.m1.2.3.2.2">Mean Avg Top-</mtext></ci><ci id="S3.E9.m1.2.3.2.3.cmml" xref="S3.E9.m1.2.3.2.3">𝑘</ci><ci id="S3.E9.m1.2.3.2.4a.cmml" xref="S3.E9.m1.2.3.2.4"><mtext id="S3.E9.m1.2.3.2.4.cmml" xref="S3.E9.m1.2.3.2.4">-Accuracy</mtext></ci></apply><matrix id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2"><matrixrow id="S3.E9.m1.2.2a.cmml" xref="S3.E9.m1.2.2"><cerror id="S3.E9.m1.2.2b.cmml" xref="S3.E9.m1.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2c.cmml" xref="S3.E9.m1.2.2">missing-subexpression</csymbol></cerror><apply id="S3.E9.m1.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2"><times id="S3.E9.m1.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.3"></times><apply id="S3.E9.m1.2.2.2.2.2.4.cmml" xref="S3.E9.m1.2.2.2.2.2.4"><divide id="S3.E9.m1.2.2.2.2.2.4.1.cmml" xref="S3.E9.m1.2.2.2.2.2.4"></divide><cn id="S3.E9.m1.2.2.2.2.2.4.2.cmml" type="integer" xref="S3.E9.m1.2.2.2.2.2.4.2">1</cn><ci id="S3.E9.m1.2.2.2.2.2.4.3.cmml" xref="S3.E9.m1.2.2.2.2.2.4.3">𝑄</ci></apply><apply id="S3.E9.m1.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2"><apply id="S3.E9.m1.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E9.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2">subscript</csymbol><sum id="S3.E9.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2.2"></sum><apply id="S3.E9.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2.3"><eq id="S3.E9.m1.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2.3.1"></eq><ci id="S3.E9.m1.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.2.3.2">𝑞</ci><cn id="S3.E9.m1.2.2.2.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E9.m1.2.2.2.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E9.m1.2.2.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2.3">𝑄</ci></apply><apply id="S3.E9.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1">superscript</csymbol><apply id="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.2a.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.2"><mtext id="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.2">Accuracy</mtext></ci><ci id="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.2.3">𝑞</ci></apply><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1">𝑘</ci></apply></apply></apply></matrixrow></matrix></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">\text{Mean Avg Top-}k\text{-Accuracy}=\begin{aligned} &amp;\frac{1}{Q}\sum_{q=1}^{%
Q}\left(\text{Accuracy}_{q}^{(k)}\right)\end{aligned}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.2d">Mean Avg Top- italic_k -Accuracy = start_ROW start_CELL end_CELL start_CELL divide start_ARG 1 end_ARG start_ARG italic_Q end_ARG ∑ start_POSTSUBSCRIPT italic_q = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT ( Accuracy start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ) end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS6.SSS4.p2">
<p class="ltx_p" id="S3.SS6.SSS4.p2.4">where <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS6.SSS4.p2.1.m1.1"><semantics id="S3.SS6.SSS4.p2.1.m1.1a"><mi id="S3.SS6.SSS4.p2.1.m1.1.1" xref="S3.SS6.SSS4.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS4.p2.1.m1.1b"><ci id="S3.SS6.SSS4.p2.1.m1.1.1.cmml" xref="S3.SS6.SSS4.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS4.p2.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS4.p2.1.m1.1d">italic_Q</annotation></semantics></math> is the number of queries, and <math alttext="\text{Accuracy}_{q}^{(k)}" class="ltx_Math" display="inline" id="S3.SS6.SSS4.p2.2.m2.1"><semantics id="S3.SS6.SSS4.p2.2.m2.1a"><msubsup id="S3.SS6.SSS4.p2.2.m2.1.2" xref="S3.SS6.SSS4.p2.2.m2.1.2.cmml"><mtext id="S3.SS6.SSS4.p2.2.m2.1.2.2.2" xref="S3.SS6.SSS4.p2.2.m2.1.2.2.2a.cmml">Accuracy</mtext><mi id="S3.SS6.SSS4.p2.2.m2.1.2.2.3" xref="S3.SS6.SSS4.p2.2.m2.1.2.2.3.cmml">q</mi><mrow id="S3.SS6.SSS4.p2.2.m2.1.1.1.3" xref="S3.SS6.SSS4.p2.2.m2.1.2.cmml"><mo id="S3.SS6.SSS4.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS6.SSS4.p2.2.m2.1.2.cmml">(</mo><mi id="S3.SS6.SSS4.p2.2.m2.1.1.1.1" xref="S3.SS6.SSS4.p2.2.m2.1.1.1.1.cmml">k</mi><mo id="S3.SS6.SSS4.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS6.SSS4.p2.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS4.p2.2.m2.1b"><apply id="S3.SS6.SSS4.p2.2.m2.1.2.cmml" xref="S3.SS6.SSS4.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS6.SSS4.p2.2.m2.1.2.1.cmml" xref="S3.SS6.SSS4.p2.2.m2.1.2">superscript</csymbol><apply id="S3.SS6.SSS4.p2.2.m2.1.2.2.cmml" xref="S3.SS6.SSS4.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS6.SSS4.p2.2.m2.1.2.2.1.cmml" xref="S3.SS6.SSS4.p2.2.m2.1.2">subscript</csymbol><ci id="S3.SS6.SSS4.p2.2.m2.1.2.2.2a.cmml" xref="S3.SS6.SSS4.p2.2.m2.1.2.2.2"><mtext id="S3.SS6.SSS4.p2.2.m2.1.2.2.2.cmml" xref="S3.SS6.SSS4.p2.2.m2.1.2.2.2">Accuracy</mtext></ci><ci id="S3.SS6.SSS4.p2.2.m2.1.2.2.3.cmml" xref="S3.SS6.SSS4.p2.2.m2.1.2.2.3">𝑞</ci></apply><ci id="S3.SS6.SSS4.p2.2.m2.1.1.1.1.cmml" xref="S3.SS6.SSS4.p2.2.m2.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS4.p2.2.m2.1c">\text{Accuracy}_{q}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS4.p2.2.m2.1d">Accuracy start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> indicates whether the correct answer appears within the top <math alttext="k" class="ltx_Math" display="inline" id="S3.SS6.SSS4.p2.3.m3.1"><semantics id="S3.SS6.SSS4.p2.3.m3.1a"><mi id="S3.SS6.SSS4.p2.3.m3.1.1" xref="S3.SS6.SSS4.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS4.p2.3.m3.1b"><ci id="S3.SS6.SSS4.p2.3.m3.1.1.cmml" xref="S3.SS6.SSS4.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS4.p2.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS4.p2.3.m3.1d">italic_k</annotation></semantics></math> results for query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS6.SSS4.p2.4.m4.1"><semantics id="S3.SS6.SSS4.p2.4.m4.1a"><mi id="S3.SS6.SSS4.p2.4.m4.1.1" xref="S3.SS6.SSS4.p2.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS6.SSS4.p2.4.m4.1b"><ci id="S3.SS6.SSS4.p2.4.m4.1.1.cmml" xref="S3.SS6.SSS4.p2.4.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.SSS4.p2.4.m4.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.SSS4.p2.4.m4.1d">italic_q</annotation></semantics></math>, defined as:</p>
</div>
<div class="ltx_para" id="S3.SS6.SSS4.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Accuracy}_{q}^{(k)}=\begin{cases}1&amp;\text{if correct answer is in top }k,%
\\
0&amp;\text{otherwise.}\end{cases}" class="ltx_Math" display="block" id="S3.E10.m1.5"><semantics id="S3.E10.m1.5a"><mrow id="S3.E10.m1.5.6" xref="S3.E10.m1.5.6.cmml"><msubsup id="S3.E10.m1.5.6.2" xref="S3.E10.m1.5.6.2.cmml"><mtext id="S3.E10.m1.5.6.2.2.2" xref="S3.E10.m1.5.6.2.2.2a.cmml">Accuracy</mtext><mi id="S3.E10.m1.5.6.2.2.3" xref="S3.E10.m1.5.6.2.2.3.cmml">q</mi><mrow id="S3.E10.m1.5.5.1.3" xref="S3.E10.m1.5.6.2.cmml"><mo id="S3.E10.m1.5.5.1.3.1" stretchy="false" xref="S3.E10.m1.5.6.2.cmml">(</mo><mi id="S3.E10.m1.5.5.1.1" xref="S3.E10.m1.5.5.1.1.cmml">k</mi><mo id="S3.E10.m1.5.5.1.3.2" stretchy="false" xref="S3.E10.m1.5.6.2.cmml">)</mo></mrow></msubsup><mo id="S3.E10.m1.5.6.1" xref="S3.E10.m1.5.6.1.cmml">=</mo><mrow id="S3.E10.m1.4.4" xref="S3.E10.m1.5.6.3.1.cmml"><mo id="S3.E10.m1.4.4.5" xref="S3.E10.m1.5.6.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E10.m1.4.4.4" rowspacing="0pt" xref="S3.E10.m1.5.6.3.1.cmml"><mtr id="S3.E10.m1.4.4.4a" xref="S3.E10.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4b" xref="S3.E10.m1.5.6.3.1.cmml"><mn id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml">1</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4c" xref="S3.E10.m1.5.6.3.1.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.1.1.1" xref="S3.E10.m1.2.2.2.2.2.1.1.1.cmml"><mtext id="S3.E10.m1.2.2.2.2.2.1.1.1.2" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2a.cmml">if correct answer is in top </mtext><mo id="S3.E10.m1.2.2.2.2.2.1.1.1.1" xref="S3.E10.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E10.m1.2.2.2.2.2.1.1.1.3" xref="S3.E10.m1.2.2.2.2.2.1.1.1.3.cmml">k</mi></mrow><mo id="S3.E10.m1.2.2.2.2.2.1.1.2" xref="S3.E10.m1.2.2.2.2.2.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E10.m1.4.4.4d" xref="S3.E10.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4e" xref="S3.E10.m1.5.6.3.1.cmml"><mn id="S3.E10.m1.3.3.3.3.1.1" xref="S3.E10.m1.3.3.3.3.1.1.cmml">0</mn></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.4.4.4f" xref="S3.E10.m1.5.6.3.1.cmml"><mtext id="S3.E10.m1.4.4.4.4.2.1" xref="S3.E10.m1.4.4.4.4.2.1a.cmml">otherwise.</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.5b"><apply id="S3.E10.m1.5.6.cmml" xref="S3.E10.m1.5.6"><eq id="S3.E10.m1.5.6.1.cmml" xref="S3.E10.m1.5.6.1"></eq><apply id="S3.E10.m1.5.6.2.cmml" xref="S3.E10.m1.5.6.2"><csymbol cd="ambiguous" id="S3.E10.m1.5.6.2.1.cmml" xref="S3.E10.m1.5.6.2">superscript</csymbol><apply id="S3.E10.m1.5.6.2.2.cmml" xref="S3.E10.m1.5.6.2"><csymbol cd="ambiguous" id="S3.E10.m1.5.6.2.2.1.cmml" xref="S3.E10.m1.5.6.2">subscript</csymbol><ci id="S3.E10.m1.5.6.2.2.2a.cmml" xref="S3.E10.m1.5.6.2.2.2"><mtext id="S3.E10.m1.5.6.2.2.2.cmml" xref="S3.E10.m1.5.6.2.2.2">Accuracy</mtext></ci><ci id="S3.E10.m1.5.6.2.2.3.cmml" xref="S3.E10.m1.5.6.2.2.3">𝑞</ci></apply><ci id="S3.E10.m1.5.5.1.1.cmml" xref="S3.E10.m1.5.5.1.1">𝑘</ci></apply><apply id="S3.E10.m1.5.6.3.1.cmml" xref="S3.E10.m1.4.4"><csymbol cd="latexml" id="S3.E10.m1.5.6.3.1.1.cmml" xref="S3.E10.m1.4.4.5">cases</csymbol><cn id="S3.E10.m1.1.1.1.1.1.1.cmml" type="integer" xref="S3.E10.m1.1.1.1.1.1.1">1</cn><apply id="S3.E10.m1.2.2.2.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1"><times id="S3.E10.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.1"></times><ci id="S3.E10.m1.2.2.2.2.2.1.1.1.2a.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2"><mtext id="S3.E10.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.2">if correct answer is in top </mtext></ci><ci id="S3.E10.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.2.1.1.1.3">𝑘</ci></apply><cn id="S3.E10.m1.3.3.3.3.1.1.cmml" type="integer" xref="S3.E10.m1.3.3.3.3.1.1">0</cn><ci id="S3.E10.m1.4.4.4.4.2.1a.cmml" xref="S3.E10.m1.4.4.4.4.2.1"><mtext id="S3.E10.m1.4.4.4.4.2.1.cmml" xref="S3.E10.m1.4.4.4.4.2.1">otherwise.</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.5c">\text{Accuracy}_{q}^{(k)}=\begin{cases}1&amp;\text{if correct answer is in top }k,%
\\
0&amp;\text{otherwise.}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.5d">Accuracy start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT = { start_ROW start_CELL 1 end_CELL start_CELL if correct answer is in top italic_k , end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL otherwise. end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS6.SSS4.p4">
<p class="ltx_p" id="S3.SS6.SSS4.p4.1">This measurement underscores the model’s effectiveness in presenting highly relevant results at the top of its output list, which is especially useful in search and recommendation systems where immediate relevance is paramount.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Implementation</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment Design</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">This section shows how we evaluated the vision-language models that we developed. We designed the evaluation to test the ability of the models to work well over different datasets. This would help us see how they will work when presented with data they were never presented with before and also how they would do on the completely new data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">In Domain Testing:</span> Evaluation of models on the dataset they were trained on, focusing on how well they perform in a familiar data environment.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Out Domain Testing:</span> Evaluation of models on datasets other than those they were trained on to assess their generalizability and robustness across different data distributions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">Our experiments utilize a diverse array of models coupled with a Base Multilingual BERT to handle text in the Azerbaijani language:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p5.1.1">Architectures:</span> ResNet50, EfficientNet0, Vision Transformer (ViT), Tiny Swin Transformer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p6.1.1">Datasets:</span> MSCOCO, Flickr8k, Flickr30k. Synthetic datasets were also generated using machine translation and augmentation techniques to simulate low-resource conditions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p7">
<p class="ltx_p" id="S4.SS1.p7.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p7.1.1">Metrics</span>: , Mean Average Precision (MAP), Mean Average Recall (MAR), Mean Average F1-Score (MAF1), Top-K Accuracy Metrics (Top1, Top5, Top10)</p>
</div>
<div class="ltx_para" id="S4.SS1.p8">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">ResNet50 + Multilingual BERT:</span> Evaluated on MSCOCO with generalization to Flickr8k and Flickr30k.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">Augmented Data with ResNet50 + Multilingual BERT:</span> Assessed the impact of image augmentation on Flickr30k, with generalization to MSCOCO and Flickr8k.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">EfficientNet0 + Multilingual BERT:</span> Baseline performance evaluated on Flickr30k, extended to MSCOCO and Flickr8k.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">Augmented Data with EfficientNet0 + Enhanced Multilingual BERT:</span> Explored the effects of image augmentation and enhanced BERT techniques on Flickr30k.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i5.p1.1.1">ViT + Multilingual BERT:</span> Tested on Flickr8k with generalization to Flickr30k and MSCOCO.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i6.p1">
<p class="ltx_p" id="S4.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i6.p1.1.1">Tiny Swin Transformer + Multilingual BERT:</span> Evaluated on Flickr8k with cross-dataset adaptability to MSCOCO and Flickr30k.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Controlled Variables and Their Impact on Model Performance</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">In this section, we describe the variables that were different in each experiment in a systematic manner and how they have been changed with an intent and aim to study their impacts on performance. All of these variables have provided insights into optimization and scalling of the model in different settings, especially in low-resource and different domains.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Model Configurations</span>: Different configurations of text and image encoding models, like different number of layers, activation functions, and fine-tuning depths, were experimented with to find the best combinations of these features that would balance performance with computational efficiency. This included both comparisons of the standard BERT architecture against its multilingual version and experimentation with different backbone architectures for the image encoder, including ResNet-50 versus other alternatives. This was done with the view of examining various setups offering tradeoff between accuracy and computational load.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p3.1.1">Data Volume and Quality</span>: Sensitivity to the quality and quantity of the data was assessed by training and testing the models on datasets of different sizes and conditions, on the datasets such as MSCOCO and Flickr30k, Flickr8k. The influence of data augmentation techniques on enhancing data quality and improving the performance of models was tested to get insights into how the models might perform in unexpected real-world environment datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p4.1.1">Computational Constraints: </span>Performance measurement in experiments was targeted towards real-world deployments, especially in low-resource settings. In this regard, the performance of the models under different computational constraints was important and that is why we have chosen entry-level GPUs like the Nvidia T4. The efficiency of various model configurations tested to obtain the best trade off between the accuracy obtained and the computational demand, something that is more crucial in practice due to the computational constraints.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">When these different parameters that have been changed during different experiments could be understood, that helps in building the model not just for optimal performance in ideal conditions but also ensuring its practical applicability in diverse and challenging environments and domains. For example, if there is need to deploy the model to the another domain where no or few captions available to further train the model, model itself should be much adaptable to other domains.</p>
</div>
<div class="ltx_para" id="S4.SS2.p6">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1">Richer annotations and diverse image content in datasets like MSCOCO lead to better model performance.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1">Augmentation of data sources consistently improves model accuracy across different settings.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1">The performance gap between in-domain and out-domain highlights the need for models to better generalize across diverse datasets.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.1">A careful balance between computational efficiency and accuracy is crucial, especially in resource-constrained environments.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p7">
<p class="ltx_p" id="S4.SS2.p7.1">These findings emphasize the importance of dataset quality, the benefits of augmentation, and the challenges posed by model and data heterogeneity. Addressing these challenges is key to advancing the state-of-the-art in vision-language models.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance Metrics for Various Models Across Different Datasets</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.1" style="width:433.6pt;height:89.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-174.0pt,36.1pt) scale(0.554736657952191,0.554736657952191) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.1">Model</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.2">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T3.1.1.1.1.3">MAP</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T3.1.1.1.1.4">MAR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T3.1.1.1.1.5">MAF1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1.6">Top1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.2.1">
<td class="ltx_td" id="S4.T3.1.1.2.1.1"></td>
<th class="ltx_td ltx_th ltx_th_column" id="S4.T3.1.1.2.1.2"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.3">MSCOCO</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.4">Flickr8k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.5">Flickr30k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.6">MSCOCO</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.7">Flickr8k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.8">Flickr30k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.9">MSCOCO</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.10">Flickr8k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.1.11">Flickr30k</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S4.T3.1.1.2.1.12">In-domain</th>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.3.2.1">ResNet50 + MultiBERT (Base Loss)</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.1.1.3.2.2">MSCOCO</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.3.1">0.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.4">0.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.5">0.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.6.1">0.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.7">0.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.8">0.58</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.9"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.3.2.9.1">0.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.10">0.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.11">0.60</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.2.12">0.55</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.4.3">
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.4.3.1">ResNet50 + MultiBERT</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.4.3.2">MSCOCO</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.3.1">0.80</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.4">0.76</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.5">0.73</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.6.1">0.74</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.7">0.70</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.8">0.67</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.9"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.3.9.1">0.77</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.10">0.73</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.11">0.70</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.3.12">0.62</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.5.4">
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.5.4.1">ResNet50 + MultiBERT (Augmented)</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.5.4.2">Flickr30k</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.3">0.82</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.4">0.84</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.5.1">0.82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.6">0.76</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.7">0.78</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.8"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.8.1">0.75</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.9">0.79</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.10">0.81</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.11"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.4.11.1">0.78</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.4.12">0.64</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.6.5">
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.6.5.1">EfficientNet0 + MultiBERT</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.6.5.2">Flickr30k</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.3">0.78</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.4">0.82</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.5.1">0.84</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.6">0.77</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.7">0.79</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.8"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.8.1">0.81</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.9">0.76</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.10">0.80</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.11"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.5.11.1">0.82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.5.12">0.67</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.7.6">
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.7.6.1">EfficientNet0 + MultiBERT (Augmented)</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.7.6.2">Flickr30k</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.3">0.81</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.4">0.85</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.5.1">0.87</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.6">0.80</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.7">0.82</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.8"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.8.1">0.84</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.9">0.79</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.10">0.83</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.11"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.6.11.1">0.85</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.6.12">0.70</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.8.7">
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.8.7.1">ViT + MultiBERT (Base Loss)</td>
<td class="ltx_td ltx_align_left" id="S4.T3.1.1.8.7.2">Flickr8k</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.3">0.71</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.7.4.1">0.80</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.5">0.70</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.6">0.74</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.7"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.7.7.1">0.82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.8">0.69</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.9">0.72</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.10"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.7.10.1">0.81</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.11">0.70</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.8.7.12">0.72</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.9.8">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.1.1.9.8.1">Tiny Swin + MultiBERT (Base Loss)</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.1.1.9.8.2">Flickr8k</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.3">0.80</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.9.8.4.1">0.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.5">0.79</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.6">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.7"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.9.8.7.1">0.78</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.8">0.72</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.9">0.77</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.10"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.9.8.10.1">0.81</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.11">0.76</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.1.9.8.12">0.75</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering">Note: Bold values indicate in-domain performance. MultiBERT refers to Base Multilingual BERT.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Analysis of Results</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Our investigations into the performance of various model architectures across datasets like COCO, Flickr30k, and Flickr8k reveal the complexities of model generalization in diverse data environments. We evaluated models such as ResNet50, EfficientNet0, Vision Transformer, Tiny Swin Transformer, and Base Multilingual BERT, observing better results when models were tested on the datasets they were trained on compared to out-of-domain datasets. Key evaluation metrics like MAP, MAR, and MAF1 were used to assess model performance in multimodal image retrieval tasks. For example, ResNet50 showed a MAP increase from 0.70 to 0.80 on the MSCOCO dataset under base loss conditions. Augmentation techniques further improved performance, with a MAP of 0.82 on the Flickr30k dataset. EfficientNet0 achieved a MAP of 0.84 on Flickr30k, improving to 0.87 with data augmentation. The Vision Transformer and Tiny Swin Transformer also demonstrated strong performance, with MAPs of 0.80 and 0.84 on Flickr8k, respectively. These findings highlight the significant impact of architecture variation and data augmentation on model generalization across domains, showing that careful data enhancement and loss function optimization can balance performance and computational efficiency.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Limitations</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Our study on multimodal vision-language retrieval systems for low-resource languages has identified key limitations:</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Synthetic Data Quality</span>: The performance heavily depends on the accuracy of synthetic data, such as translated captions from English to Azerbaijani. Ensuring high-quality data, potentially through human validation, is critical to avoid inaccuracies and biases.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">Scalability and Generalization</span>: While transitioning from one language to another can be made relatively smooth, moving from one domain to another within the same language remains a significant challenge. Models trained in one domain often struggle to generalize across others without extensive tuning.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Future Work</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This work developed an application of multimodal vision-language models for image retrieval in low-resource languages, with a focus on Azerbaijani. By using synthetic datasets—translated sentences from English to Azerbaijani via machine translation and data augmentation—the research demonstrated improved retrieval accuracy over traditional models. Key future directions include:</p>
</div>
<div class="ltx_para" id="S6.p2">
<ul class="ltx_itemize" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i1.p1.1.1">Expansion to Additional Low-Resource Languages and Enhanced Data Augmentation:</span> Extending the approach to other low-resource languages, incorporating advanced data augmentation, and involving human review to improve synthetic dataset quality could enhance model performance.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i2.p1.1.1">Evaluation of Architectures Across Domains:</span> Testing various architectures on the translated ROCO dataset, especially in diverse domains like medical imaging, could offer valuable insights.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i3.p1.1.1">Image Captioning and Energy Efficiency Optimization:</span> Exploring the reverse task of image captioning and optimizing model efficiency for resource-limited settings could enable deployment on mobile devices.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i4.p1">
<p class="ltx_p" id="S6.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.i4.p1.1.1">Interactive User Feedback Systems:</span> Developing systems that incorporate user feedback to refine model outputs could improve retrieval accuracy and user satisfaction.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Further research in these areas will enhance the accessibility and applicability of AI technologies globally, with the ongoing release of configurations and collaborative advancements.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agić and Vulić (2020)</span>
<span class="ltx_bibblock">
Željko Agić and Ivan Vulić. 2020.

</span>
<span class="ltx_bibblock">Data availability and quality in multimodal translation: Challenging data scarcity in low-resource scenarios.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2004.00767</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019a)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019a.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019b)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2019b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/1810.04805" title="">Bert: Pre-training of deep bidirectional transformers for language understanding</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Preprint</em>, arXiv:1810.04805.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2021)</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al. 2021.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frome et al. (2013)</span>
<span class="ltx_bibblock">
Andrea Frome, Greg S. Corrado, Jonathon Shlens, Samy Bengio, Jeffrey Dean, Marc’Aurelio Ranzato, and Tomas Mikolov. 2013.

</span>
<span class="ltx_bibblock">Devise: a deep visual-semantic embedding model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 26th International Conference on Neural Information Processing Systems - Volume 2</em>, NIPS’13, page 2121–2129, Red Hook, NY, USA. Curran Associates Inc.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2016)</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. 2016.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pages 770–778.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joulin et al. (2016)</span>
<span class="ltx_bibblock">
Armand Joulin, Laurens van der Maaten, Allan Jabri, and Nicolas Vasilache. 2016.

</span>
<span class="ltx_bibblock">Learning visual features from large weakly supervised data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">European conference on computer vision</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kamath et al. (2021)</span>
<span class="ltx_bibblock">
Aishwarya Kamath, Mannat Singh, Mark Yatskar, Nikhil Goyal, Armand Joulin, Nicolas Carion, Piotr Bojanowski, Ishan Misra, C. Lawrence Zitnick, Carl Vondrick, et al. 2021.

</span>
<span class="ltx_bibblock">Mdetr–modulated detection for end-to-end multi-modal understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, pages 1780–1790.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis and Denoyer (2020)</span>
<span class="ltx_bibblock">
Mike Lewis and Ludovic Denoyer. 2020.

</span>
<span class="ltx_bibblock">Pre-training is a hot topic: Contextualized document embeddings improve topic coherence.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics</em>, pages 672–686. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Liunian Harold Li, Mark Yatskar, Da Yin, Cho-Jui Hsieh, and Kai-Wei Chang. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/1908.03557" title="">Visualbert: A simple and performant baseline for vision and language</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Preprint</em>, arXiv:1908.03557.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2014)</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva Ramanan, Piotr Dollár, and C Lawrence Zitnick. 2014.

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">European conference on computer vision</em>, pages 740–755. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2019)</span>
<span class="ltx_bibblock">
Jiasen Lu, Dhruv Batra, Devi Parikh, and Stefan Lee. 2019.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/1908.02265" title="">Vilbert: Pretraining task-agnostic visiolinguistic representations for vision-and-language tasks</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Preprint</em>, arXiv:1908.02265.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pelka et al. (2018)</span>
<span class="ltx_bibblock">
Oskar Pelka, Sven Koitka, Julius Rückert, Felix Nensa, and Christoph M Friedrich. 2018.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1007/978-3-030-01364-6_20" title="">Radiology objects in context (roco): A multimodal image dataset</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Intravascular Imaging and Computer Assisted Stenting, and Large-Scale Annotation of Biomedical Data and Expert Label Synthesis</em>, volume 11043 of <em class="ltx_emph ltx_font_italic" id="bib.bib13.2.2">Lecture Notes in Computer Science</em>, pages 180–189, Cham. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pino et al. (2019)</span>
<span class="ltx_bibblock">
Jesus Pino, Jason Min, Keith Herman, and Valentin Borocas. 2019.

</span>
<span class="ltx_bibblock">Roco: a rich optical character recognition dataset for improving reading systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1909.01745</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, Gretchen Krueger, and Ilya Sutskever. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://arxiv.org/abs/2103.00020" title="">Learning transferable visual models from natural language supervision</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Preprint</em>, arXiv:2103.00020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sharma et al. (2018)</span>
<span class="ltx_bibblock">
Piyush Sharma, Nan Ding, Sebastian Goodman, and Radu Soricut. 2018.

</span>
<span class="ltx_bibblock">Conceptual captions: A new dataset and challenge for image captioning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the ACL 2018, Conference of the Association for Computational Linguistics</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava and Salakhutdinov (2012)</span>
<span class="ltx_bibblock">
Nitish Srivastava and Ruslan Salakhutdinov. 2012.

</span>
<span class="ltx_bibblock">Multimodal learning with deep boltzmann machines.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Advances in neural information processing systems</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan and Bansal (2019)</span>
<span class="ltx_bibblock">
Hao Tan and Mohit Bansal. 2019.

</span>
<span class="ltx_bibblock">Lxmert: Learning cross-modality encoder representations from transformers.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 2019 Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on Natural Language Processing (EMNLP-IJCNLP)</em>, pages 5103–5114.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Varol et al. (2017)</span>
<span class="ltx_bibblock">
Gül Varol, Javier Romero, Xavier Martin, Naureen Mahmood, Michael J Black, Ivan Laptev, and Cordelia Schmid. 2017.

</span>
<span class="ltx_bibblock">Learning from synthetic humans.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, pages 109–117.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Young et al. (2014)</span>
<span class="ltx_bibblock">
Peter Young, Alice Lai, Micah Hodosh, and Julia Hockenmaier. 2014.

</span>
<span class="ltx_bibblock">From image descriptions to visual denotations: New similarity metrics for semantic inference over event descriptions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Transactions of the Association for Computational Linguistics</em>, volume 2, pages 67–78.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix ltx_pruned_first" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation</h2>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Dataset Preparation</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><math alttext="df,img\_dir,tokenizer,transform" class="ltx_Math" display="inline" id="alg2.l1.m1.4"><semantics id="alg2.l1.m1.4a"><mrow id="alg2.l1.m1.4.4.4" xref="alg2.l1.m1.4.4.5.cmml"><mrow id="alg2.l1.m1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.cmml"><mi id="alg2.l1.m1.1.1.1.1.2" xref="alg2.l1.m1.1.1.1.1.2.cmml">d</mi><mo id="alg2.l1.m1.1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l1.m1.1.1.1.1.3" xref="alg2.l1.m1.1.1.1.1.3.cmml">f</mi></mrow><mo id="alg2.l1.m1.4.4.4.5" xref="alg2.l1.m1.4.4.5.cmml">,</mo><mrow id="alg2.l1.m1.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.cmml"><mi id="alg2.l1.m1.2.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.2.cmml">i</mi><mo id="alg2.l1.m1.2.2.2.2.1" xref="alg2.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l1.m1.2.2.2.2.3" xref="alg2.l1.m1.2.2.2.2.3.cmml">m</mi><mo id="alg2.l1.m1.2.2.2.2.1a" xref="alg2.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l1.m1.2.2.2.2.4" xref="alg2.l1.m1.2.2.2.2.4.cmml">g</mi><mo id="alg2.l1.m1.2.2.2.2.1b" xref="alg2.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l1.m1.2.2.2.2.5" mathvariant="normal" xref="alg2.l1.m1.2.2.2.2.5.cmml">_</mi><mo id="alg2.l1.m1.2.2.2.2.1c" xref="alg2.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l1.m1.2.2.2.2.6" xref="alg2.l1.m1.2.2.2.2.6.cmml">d</mi><mo id="alg2.l1.m1.2.2.2.2.1d" xref="alg2.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l1.m1.2.2.2.2.7" xref="alg2.l1.m1.2.2.2.2.7.cmml">i</mi><mo id="alg2.l1.m1.2.2.2.2.1e" xref="alg2.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l1.m1.2.2.2.2.8" xref="alg2.l1.m1.2.2.2.2.8.cmml">r</mi></mrow><mo id="alg2.l1.m1.4.4.4.6" xref="alg2.l1.m1.4.4.5.cmml">,</mo><mrow id="alg2.l1.m1.3.3.3.3" xref="alg2.l1.m1.3.3.3.3.cmml"><mi id="alg2.l1.m1.3.3.3.3.2" xref="alg2.l1.m1.3.3.3.3.2.cmml">t</mi><mo id="alg2.l1.m1.3.3.3.3.1" xref="alg2.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m1.3.3.3.3.3" xref="alg2.l1.m1.3.3.3.3.3.cmml">o</mi><mo id="alg2.l1.m1.3.3.3.3.1a" xref="alg2.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m1.3.3.3.3.4" xref="alg2.l1.m1.3.3.3.3.4.cmml">k</mi><mo id="alg2.l1.m1.3.3.3.3.1b" xref="alg2.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m1.3.3.3.3.5" xref="alg2.l1.m1.3.3.3.3.5.cmml">e</mi><mo id="alg2.l1.m1.3.3.3.3.1c" xref="alg2.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m1.3.3.3.3.6" xref="alg2.l1.m1.3.3.3.3.6.cmml">n</mi><mo id="alg2.l1.m1.3.3.3.3.1d" xref="alg2.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m1.3.3.3.3.7" xref="alg2.l1.m1.3.3.3.3.7.cmml">i</mi><mo id="alg2.l1.m1.3.3.3.3.1e" xref="alg2.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m1.3.3.3.3.8" xref="alg2.l1.m1.3.3.3.3.8.cmml">z</mi><mo id="alg2.l1.m1.3.3.3.3.1f" xref="alg2.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m1.3.3.3.3.9" xref="alg2.l1.m1.3.3.3.3.9.cmml">e</mi><mo id="alg2.l1.m1.3.3.3.3.1g" xref="alg2.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l1.m1.3.3.3.3.10" xref="alg2.l1.m1.3.3.3.3.10.cmml">r</mi></mrow><mo id="alg2.l1.m1.4.4.4.7" xref="alg2.l1.m1.4.4.5.cmml">,</mo><mrow id="alg2.l1.m1.4.4.4.4" xref="alg2.l1.m1.4.4.4.4.cmml"><mi id="alg2.l1.m1.4.4.4.4.2" xref="alg2.l1.m1.4.4.4.4.2.cmml">t</mi><mo id="alg2.l1.m1.4.4.4.4.1" xref="alg2.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l1.m1.4.4.4.4.3" xref="alg2.l1.m1.4.4.4.4.3.cmml">r</mi><mo id="alg2.l1.m1.4.4.4.4.1a" xref="alg2.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l1.m1.4.4.4.4.4" xref="alg2.l1.m1.4.4.4.4.4.cmml">a</mi><mo id="alg2.l1.m1.4.4.4.4.1b" xref="alg2.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l1.m1.4.4.4.4.5" xref="alg2.l1.m1.4.4.4.4.5.cmml">n</mi><mo id="alg2.l1.m1.4.4.4.4.1c" xref="alg2.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l1.m1.4.4.4.4.6" xref="alg2.l1.m1.4.4.4.4.6.cmml">s</mi><mo id="alg2.l1.m1.4.4.4.4.1d" xref="alg2.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l1.m1.4.4.4.4.7" xref="alg2.l1.m1.4.4.4.4.7.cmml">f</mi><mo id="alg2.l1.m1.4.4.4.4.1e" xref="alg2.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l1.m1.4.4.4.4.8" xref="alg2.l1.m1.4.4.4.4.8.cmml">o</mi><mo id="alg2.l1.m1.4.4.4.4.1f" xref="alg2.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l1.m1.4.4.4.4.9" xref="alg2.l1.m1.4.4.4.4.9.cmml">r</mi><mo id="alg2.l1.m1.4.4.4.4.1g" xref="alg2.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l1.m1.4.4.4.4.10" xref="alg2.l1.m1.4.4.4.4.10.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.4b"><list id="alg2.l1.m1.4.4.5.cmml" xref="alg2.l1.m1.4.4.4"><apply id="alg2.l1.m1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1"><times id="alg2.l1.m1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1.1"></times><ci id="alg2.l1.m1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.2">𝑑</ci><ci id="alg2.l1.m1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.3">𝑓</ci></apply><apply id="alg2.l1.m1.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2"><times id="alg2.l1.m1.2.2.2.2.1.cmml" xref="alg2.l1.m1.2.2.2.2.1"></times><ci id="alg2.l1.m1.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.2">𝑖</ci><ci id="alg2.l1.m1.2.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.3">𝑚</ci><ci id="alg2.l1.m1.2.2.2.2.4.cmml" xref="alg2.l1.m1.2.2.2.2.4">𝑔</ci><ci id="alg2.l1.m1.2.2.2.2.5.cmml" xref="alg2.l1.m1.2.2.2.2.5">_</ci><ci id="alg2.l1.m1.2.2.2.2.6.cmml" xref="alg2.l1.m1.2.2.2.2.6">𝑑</ci><ci id="alg2.l1.m1.2.2.2.2.7.cmml" xref="alg2.l1.m1.2.2.2.2.7">𝑖</ci><ci id="alg2.l1.m1.2.2.2.2.8.cmml" xref="alg2.l1.m1.2.2.2.2.8">𝑟</ci></apply><apply id="alg2.l1.m1.3.3.3.3.cmml" xref="alg2.l1.m1.3.3.3.3"><times id="alg2.l1.m1.3.3.3.3.1.cmml" xref="alg2.l1.m1.3.3.3.3.1"></times><ci id="alg2.l1.m1.3.3.3.3.2.cmml" xref="alg2.l1.m1.3.3.3.3.2">𝑡</ci><ci id="alg2.l1.m1.3.3.3.3.3.cmml" xref="alg2.l1.m1.3.3.3.3.3">𝑜</ci><ci id="alg2.l1.m1.3.3.3.3.4.cmml" xref="alg2.l1.m1.3.3.3.3.4">𝑘</ci><ci id="alg2.l1.m1.3.3.3.3.5.cmml" xref="alg2.l1.m1.3.3.3.3.5">𝑒</ci><ci id="alg2.l1.m1.3.3.3.3.6.cmml" xref="alg2.l1.m1.3.3.3.3.6">𝑛</ci><ci id="alg2.l1.m1.3.3.3.3.7.cmml" xref="alg2.l1.m1.3.3.3.3.7">𝑖</ci><ci id="alg2.l1.m1.3.3.3.3.8.cmml" xref="alg2.l1.m1.3.3.3.3.8">𝑧</ci><ci id="alg2.l1.m1.3.3.3.3.9.cmml" xref="alg2.l1.m1.3.3.3.3.9">𝑒</ci><ci id="alg2.l1.m1.3.3.3.3.10.cmml" xref="alg2.l1.m1.3.3.3.3.10">𝑟</ci></apply><apply id="alg2.l1.m1.4.4.4.4.cmml" xref="alg2.l1.m1.4.4.4.4"><times id="alg2.l1.m1.4.4.4.4.1.cmml" xref="alg2.l1.m1.4.4.4.4.1"></times><ci id="alg2.l1.m1.4.4.4.4.2.cmml" xref="alg2.l1.m1.4.4.4.4.2">𝑡</ci><ci id="alg2.l1.m1.4.4.4.4.3.cmml" xref="alg2.l1.m1.4.4.4.4.3">𝑟</ci><ci id="alg2.l1.m1.4.4.4.4.4.cmml" xref="alg2.l1.m1.4.4.4.4.4">𝑎</ci><ci id="alg2.l1.m1.4.4.4.4.5.cmml" xref="alg2.l1.m1.4.4.4.4.5">𝑛</ci><ci id="alg2.l1.m1.4.4.4.4.6.cmml" xref="alg2.l1.m1.4.4.4.4.6">𝑠</ci><ci id="alg2.l1.m1.4.4.4.4.7.cmml" xref="alg2.l1.m1.4.4.4.4.7">𝑓</ci><ci id="alg2.l1.m1.4.4.4.4.8.cmml" xref="alg2.l1.m1.4.4.4.4.8">𝑜</ci><ci id="alg2.l1.m1.4.4.4.4.9.cmml" xref="alg2.l1.m1.4.4.4.4.9">𝑟</ci><ci id="alg2.l1.m1.4.4.4.4.10.cmml" xref="alg2.l1.m1.4.4.4.4.10">𝑚</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.4c">df,img\_dir,tokenizer,transform</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.4d">italic_d italic_f , italic_i italic_m italic_g _ italic_d italic_i italic_r , italic_t italic_o italic_k italic_e italic_n italic_i italic_z italic_e italic_r , italic_t italic_r italic_a italic_n italic_s italic_f italic_o italic_r italic_m</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg2.l2.1">procedure</span> <span class="ltx_text ltx_font_smallcaps" id="alg2.l2.2">CLIPDataset</span>(<math alttext="df,img\_dir,tokenizer,transform" class="ltx_Math" display="inline" id="alg2.l2.m1.4"><semantics id="alg2.l2.m1.4a"><mrow id="alg2.l2.m1.4.4.4" xref="alg2.l2.m1.4.4.5.cmml"><mrow id="alg2.l2.m1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.cmml"><mi id="alg2.l2.m1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.2.cmml">d</mi><mo id="alg2.l2.m1.1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l2.m1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.3.cmml">f</mi></mrow><mo id="alg2.l2.m1.4.4.4.5" xref="alg2.l2.m1.4.4.5.cmml">,</mo><mrow id="alg2.l2.m1.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.cmml"><mi id="alg2.l2.m1.2.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.2.cmml">i</mi><mo id="alg2.l2.m1.2.2.2.2.1" xref="alg2.l2.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l2.m1.2.2.2.2.3" xref="alg2.l2.m1.2.2.2.2.3.cmml">m</mi><mo id="alg2.l2.m1.2.2.2.2.1a" xref="alg2.l2.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l2.m1.2.2.2.2.4" xref="alg2.l2.m1.2.2.2.2.4.cmml">g</mi><mo id="alg2.l2.m1.2.2.2.2.1b" xref="alg2.l2.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l2.m1.2.2.2.2.5" mathvariant="normal" xref="alg2.l2.m1.2.2.2.2.5.cmml">_</mi><mo id="alg2.l2.m1.2.2.2.2.1c" xref="alg2.l2.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l2.m1.2.2.2.2.6" xref="alg2.l2.m1.2.2.2.2.6.cmml">d</mi><mo id="alg2.l2.m1.2.2.2.2.1d" xref="alg2.l2.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l2.m1.2.2.2.2.7" xref="alg2.l2.m1.2.2.2.2.7.cmml">i</mi><mo id="alg2.l2.m1.2.2.2.2.1e" xref="alg2.l2.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l2.m1.2.2.2.2.8" xref="alg2.l2.m1.2.2.2.2.8.cmml">r</mi></mrow><mo id="alg2.l2.m1.4.4.4.6" xref="alg2.l2.m1.4.4.5.cmml">,</mo><mrow id="alg2.l2.m1.3.3.3.3" xref="alg2.l2.m1.3.3.3.3.cmml"><mi id="alg2.l2.m1.3.3.3.3.2" xref="alg2.l2.m1.3.3.3.3.2.cmml">t</mi><mo id="alg2.l2.m1.3.3.3.3.1" xref="alg2.l2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.3.3.3.3.3" xref="alg2.l2.m1.3.3.3.3.3.cmml">o</mi><mo id="alg2.l2.m1.3.3.3.3.1a" xref="alg2.l2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.3.3.3.3.4" xref="alg2.l2.m1.3.3.3.3.4.cmml">k</mi><mo id="alg2.l2.m1.3.3.3.3.1b" xref="alg2.l2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.3.3.3.3.5" xref="alg2.l2.m1.3.3.3.3.5.cmml">e</mi><mo id="alg2.l2.m1.3.3.3.3.1c" xref="alg2.l2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.3.3.3.3.6" xref="alg2.l2.m1.3.3.3.3.6.cmml">n</mi><mo id="alg2.l2.m1.3.3.3.3.1d" xref="alg2.l2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.3.3.3.3.7" xref="alg2.l2.m1.3.3.3.3.7.cmml">i</mi><mo id="alg2.l2.m1.3.3.3.3.1e" xref="alg2.l2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.3.3.3.3.8" xref="alg2.l2.m1.3.3.3.3.8.cmml">z</mi><mo id="alg2.l2.m1.3.3.3.3.1f" xref="alg2.l2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.3.3.3.3.9" xref="alg2.l2.m1.3.3.3.3.9.cmml">e</mi><mo id="alg2.l2.m1.3.3.3.3.1g" xref="alg2.l2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg2.l2.m1.3.3.3.3.10" xref="alg2.l2.m1.3.3.3.3.10.cmml">r</mi></mrow><mo id="alg2.l2.m1.4.4.4.7" xref="alg2.l2.m1.4.4.5.cmml">,</mo><mrow id="alg2.l2.m1.4.4.4.4" xref="alg2.l2.m1.4.4.4.4.cmml"><mi id="alg2.l2.m1.4.4.4.4.2" xref="alg2.l2.m1.4.4.4.4.2.cmml">t</mi><mo id="alg2.l2.m1.4.4.4.4.1" xref="alg2.l2.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l2.m1.4.4.4.4.3" xref="alg2.l2.m1.4.4.4.4.3.cmml">r</mi><mo id="alg2.l2.m1.4.4.4.4.1a" xref="alg2.l2.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l2.m1.4.4.4.4.4" xref="alg2.l2.m1.4.4.4.4.4.cmml">a</mi><mo id="alg2.l2.m1.4.4.4.4.1b" xref="alg2.l2.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l2.m1.4.4.4.4.5" xref="alg2.l2.m1.4.4.4.4.5.cmml">n</mi><mo id="alg2.l2.m1.4.4.4.4.1c" xref="alg2.l2.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l2.m1.4.4.4.4.6" xref="alg2.l2.m1.4.4.4.4.6.cmml">s</mi><mo id="alg2.l2.m1.4.4.4.4.1d" xref="alg2.l2.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l2.m1.4.4.4.4.7" xref="alg2.l2.m1.4.4.4.4.7.cmml">f</mi><mo id="alg2.l2.m1.4.4.4.4.1e" xref="alg2.l2.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l2.m1.4.4.4.4.8" xref="alg2.l2.m1.4.4.4.4.8.cmml">o</mi><mo id="alg2.l2.m1.4.4.4.4.1f" xref="alg2.l2.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l2.m1.4.4.4.4.9" xref="alg2.l2.m1.4.4.4.4.9.cmml">r</mi><mo id="alg2.l2.m1.4.4.4.4.1g" xref="alg2.l2.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg2.l2.m1.4.4.4.4.10" xref="alg2.l2.m1.4.4.4.4.10.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.4b"><list id="alg2.l2.m1.4.4.5.cmml" xref="alg2.l2.m1.4.4.4"><apply id="alg2.l2.m1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1"><times id="alg2.l2.m1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1.1"></times><ci id="alg2.l2.m1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1.1.2">𝑑</ci><ci id="alg2.l2.m1.1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.1.3">𝑓</ci></apply><apply id="alg2.l2.m1.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2"><times id="alg2.l2.m1.2.2.2.2.1.cmml" xref="alg2.l2.m1.2.2.2.2.1"></times><ci id="alg2.l2.m1.2.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2.2">𝑖</ci><ci id="alg2.l2.m1.2.2.2.2.3.cmml" xref="alg2.l2.m1.2.2.2.2.3">𝑚</ci><ci id="alg2.l2.m1.2.2.2.2.4.cmml" xref="alg2.l2.m1.2.2.2.2.4">𝑔</ci><ci id="alg2.l2.m1.2.2.2.2.5.cmml" xref="alg2.l2.m1.2.2.2.2.5">_</ci><ci id="alg2.l2.m1.2.2.2.2.6.cmml" xref="alg2.l2.m1.2.2.2.2.6">𝑑</ci><ci id="alg2.l2.m1.2.2.2.2.7.cmml" xref="alg2.l2.m1.2.2.2.2.7">𝑖</ci><ci id="alg2.l2.m1.2.2.2.2.8.cmml" xref="alg2.l2.m1.2.2.2.2.8">𝑟</ci></apply><apply id="alg2.l2.m1.3.3.3.3.cmml" xref="alg2.l2.m1.3.3.3.3"><times id="alg2.l2.m1.3.3.3.3.1.cmml" xref="alg2.l2.m1.3.3.3.3.1"></times><ci id="alg2.l2.m1.3.3.3.3.2.cmml" xref="alg2.l2.m1.3.3.3.3.2">𝑡</ci><ci id="alg2.l2.m1.3.3.3.3.3.cmml" xref="alg2.l2.m1.3.3.3.3.3">𝑜</ci><ci id="alg2.l2.m1.3.3.3.3.4.cmml" xref="alg2.l2.m1.3.3.3.3.4">𝑘</ci><ci id="alg2.l2.m1.3.3.3.3.5.cmml" xref="alg2.l2.m1.3.3.3.3.5">𝑒</ci><ci id="alg2.l2.m1.3.3.3.3.6.cmml" xref="alg2.l2.m1.3.3.3.3.6">𝑛</ci><ci id="alg2.l2.m1.3.3.3.3.7.cmml" xref="alg2.l2.m1.3.3.3.3.7">𝑖</ci><ci id="alg2.l2.m1.3.3.3.3.8.cmml" xref="alg2.l2.m1.3.3.3.3.8">𝑧</ci><ci id="alg2.l2.m1.3.3.3.3.9.cmml" xref="alg2.l2.m1.3.3.3.3.9">𝑒</ci><ci id="alg2.l2.m1.3.3.3.3.10.cmml" xref="alg2.l2.m1.3.3.3.3.10">𝑟</ci></apply><apply id="alg2.l2.m1.4.4.4.4.cmml" xref="alg2.l2.m1.4.4.4.4"><times id="alg2.l2.m1.4.4.4.4.1.cmml" xref="alg2.l2.m1.4.4.4.4.1"></times><ci id="alg2.l2.m1.4.4.4.4.2.cmml" xref="alg2.l2.m1.4.4.4.4.2">𝑡</ci><ci id="alg2.l2.m1.4.4.4.4.3.cmml" xref="alg2.l2.m1.4.4.4.4.3">𝑟</ci><ci id="alg2.l2.m1.4.4.4.4.4.cmml" xref="alg2.l2.m1.4.4.4.4.4">𝑎</ci><ci id="alg2.l2.m1.4.4.4.4.5.cmml" xref="alg2.l2.m1.4.4.4.4.5">𝑛</ci><ci id="alg2.l2.m1.4.4.4.4.6.cmml" xref="alg2.l2.m1.4.4.4.4.6">𝑠</ci><ci id="alg2.l2.m1.4.4.4.4.7.cmml" xref="alg2.l2.m1.4.4.4.4.7">𝑓</ci><ci id="alg2.l2.m1.4.4.4.4.8.cmml" xref="alg2.l2.m1.4.4.4.4.8">𝑜</ci><ci id="alg2.l2.m1.4.4.4.4.9.cmml" xref="alg2.l2.m1.4.4.4.4.9">𝑟</ci><ci id="alg2.l2.m1.4.4.4.4.10.cmml" xref="alg2.l2.m1.4.4.4.4.10">𝑚</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.4c">df,img\_dir,tokenizer,transform</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.4d">italic_d italic_f , italic_i italic_m italic_g _ italic_d italic_i italic_r , italic_t italic_o italic_k italic_e italic_n italic_i italic_z italic_e italic_r , italic_t italic_r italic_a italic_n italic_s italic_f italic_o italic_r italic_m</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <math alttext="self.dataframe\leftarrow dataframe" class="ltx_Math" display="inline" id="alg2.l3.m1.2"><semantics id="alg2.l3.m1.2a"><mrow id="alg2.l3.m1.2.2.2" xref="alg2.l3.m1.2.2.3.cmml"><mrow id="alg2.l3.m1.1.1.1.1" xref="alg2.l3.m1.1.1.1.1.cmml"><mi id="alg2.l3.m1.1.1.1.1.2" xref="alg2.l3.m1.1.1.1.1.2.cmml">s</mi><mo id="alg2.l3.m1.1.1.1.1.1" xref="alg2.l3.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l3.m1.1.1.1.1.3" xref="alg2.l3.m1.1.1.1.1.3.cmml">e</mi><mo id="alg2.l3.m1.1.1.1.1.1a" xref="alg2.l3.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l3.m1.1.1.1.1.4" xref="alg2.l3.m1.1.1.1.1.4.cmml">l</mi><mo id="alg2.l3.m1.1.1.1.1.1b" xref="alg2.l3.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l3.m1.1.1.1.1.5" xref="alg2.l3.m1.1.1.1.1.5.cmml">f</mi></mrow><mo id="alg2.l3.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg2.l3.m1.2.2.3a.cmml">.</mo><mrow id="alg2.l3.m1.2.2.2.2" xref="alg2.l3.m1.2.2.2.2.cmml"><mrow id="alg2.l3.m1.2.2.2.2.2" xref="alg2.l3.m1.2.2.2.2.2.cmml"><mi id="alg2.l3.m1.2.2.2.2.2.2" xref="alg2.l3.m1.2.2.2.2.2.2.cmml">d</mi><mo id="alg2.l3.m1.2.2.2.2.2.1" xref="alg2.l3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.2.3" xref="alg2.l3.m1.2.2.2.2.2.3.cmml">a</mi><mo id="alg2.l3.m1.2.2.2.2.2.1a" xref="alg2.l3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.2.4" xref="alg2.l3.m1.2.2.2.2.2.4.cmml">t</mi><mo id="alg2.l3.m1.2.2.2.2.2.1b" xref="alg2.l3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.2.5" xref="alg2.l3.m1.2.2.2.2.2.5.cmml">a</mi><mo id="alg2.l3.m1.2.2.2.2.2.1c" xref="alg2.l3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.2.6" xref="alg2.l3.m1.2.2.2.2.2.6.cmml">f</mi><mo id="alg2.l3.m1.2.2.2.2.2.1d" xref="alg2.l3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.2.7" xref="alg2.l3.m1.2.2.2.2.2.7.cmml">r</mi><mo id="alg2.l3.m1.2.2.2.2.2.1e" xref="alg2.l3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.2.8" xref="alg2.l3.m1.2.2.2.2.2.8.cmml">a</mi><mo id="alg2.l3.m1.2.2.2.2.2.1f" xref="alg2.l3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.2.9" xref="alg2.l3.m1.2.2.2.2.2.9.cmml">m</mi><mo id="alg2.l3.m1.2.2.2.2.2.1g" xref="alg2.l3.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.2.10" xref="alg2.l3.m1.2.2.2.2.2.10.cmml">e</mi></mrow><mo id="alg2.l3.m1.2.2.2.2.1" stretchy="false" xref="alg2.l3.m1.2.2.2.2.1.cmml">←</mo><mrow id="alg2.l3.m1.2.2.2.2.3" xref="alg2.l3.m1.2.2.2.2.3.cmml"><mi id="alg2.l3.m1.2.2.2.2.3.2" xref="alg2.l3.m1.2.2.2.2.3.2.cmml">d</mi><mo id="alg2.l3.m1.2.2.2.2.3.1" xref="alg2.l3.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.3.3" xref="alg2.l3.m1.2.2.2.2.3.3.cmml">a</mi><mo id="alg2.l3.m1.2.2.2.2.3.1a" xref="alg2.l3.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.3.4" xref="alg2.l3.m1.2.2.2.2.3.4.cmml">t</mi><mo id="alg2.l3.m1.2.2.2.2.3.1b" xref="alg2.l3.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.3.5" xref="alg2.l3.m1.2.2.2.2.3.5.cmml">a</mi><mo id="alg2.l3.m1.2.2.2.2.3.1c" xref="alg2.l3.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.3.6" xref="alg2.l3.m1.2.2.2.2.3.6.cmml">f</mi><mo id="alg2.l3.m1.2.2.2.2.3.1d" xref="alg2.l3.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.3.7" xref="alg2.l3.m1.2.2.2.2.3.7.cmml">r</mi><mo id="alg2.l3.m1.2.2.2.2.3.1e" xref="alg2.l3.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.3.8" xref="alg2.l3.m1.2.2.2.2.3.8.cmml">a</mi><mo id="alg2.l3.m1.2.2.2.2.3.1f" xref="alg2.l3.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.3.9" xref="alg2.l3.m1.2.2.2.2.3.9.cmml">m</mi><mo id="alg2.l3.m1.2.2.2.2.3.1g" xref="alg2.l3.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l3.m1.2.2.2.2.3.10" xref="alg2.l3.m1.2.2.2.2.3.10.cmml">e</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.2.3.cmml" xref="alg2.l3.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.3a.cmml" xref="alg2.l3.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.l3.m1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1"><times id="alg2.l3.m1.1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1.1"></times><ci id="alg2.l3.m1.1.1.1.1.2.cmml" xref="alg2.l3.m1.1.1.1.1.2">𝑠</ci><ci id="alg2.l3.m1.1.1.1.1.3.cmml" xref="alg2.l3.m1.1.1.1.1.3">𝑒</ci><ci id="alg2.l3.m1.1.1.1.1.4.cmml" xref="alg2.l3.m1.1.1.1.1.4">𝑙</ci><ci id="alg2.l3.m1.1.1.1.1.5.cmml" xref="alg2.l3.m1.1.1.1.1.5">𝑓</ci></apply><apply id="alg2.l3.m1.2.2.2.2.cmml" xref="alg2.l3.m1.2.2.2.2"><ci id="alg2.l3.m1.2.2.2.2.1.cmml" xref="alg2.l3.m1.2.2.2.2.1">←</ci><apply id="alg2.l3.m1.2.2.2.2.2.cmml" xref="alg2.l3.m1.2.2.2.2.2"><times id="alg2.l3.m1.2.2.2.2.2.1.cmml" xref="alg2.l3.m1.2.2.2.2.2.1"></times><ci id="alg2.l3.m1.2.2.2.2.2.2.cmml" xref="alg2.l3.m1.2.2.2.2.2.2">𝑑</ci><ci id="alg2.l3.m1.2.2.2.2.2.3.cmml" xref="alg2.l3.m1.2.2.2.2.2.3">𝑎</ci><ci id="alg2.l3.m1.2.2.2.2.2.4.cmml" xref="alg2.l3.m1.2.2.2.2.2.4">𝑡</ci><ci id="alg2.l3.m1.2.2.2.2.2.5.cmml" xref="alg2.l3.m1.2.2.2.2.2.5">𝑎</ci><ci id="alg2.l3.m1.2.2.2.2.2.6.cmml" xref="alg2.l3.m1.2.2.2.2.2.6">𝑓</ci><ci id="alg2.l3.m1.2.2.2.2.2.7.cmml" xref="alg2.l3.m1.2.2.2.2.2.7">𝑟</ci><ci id="alg2.l3.m1.2.2.2.2.2.8.cmml" xref="alg2.l3.m1.2.2.2.2.2.8">𝑎</ci><ci id="alg2.l3.m1.2.2.2.2.2.9.cmml" xref="alg2.l3.m1.2.2.2.2.2.9">𝑚</ci><ci id="alg2.l3.m1.2.2.2.2.2.10.cmml" xref="alg2.l3.m1.2.2.2.2.2.10">𝑒</ci></apply><apply id="alg2.l3.m1.2.2.2.2.3.cmml" xref="alg2.l3.m1.2.2.2.2.3"><times id="alg2.l3.m1.2.2.2.2.3.1.cmml" xref="alg2.l3.m1.2.2.2.2.3.1"></times><ci id="alg2.l3.m1.2.2.2.2.3.2.cmml" xref="alg2.l3.m1.2.2.2.2.3.2">𝑑</ci><ci id="alg2.l3.m1.2.2.2.2.3.3.cmml" xref="alg2.l3.m1.2.2.2.2.3.3">𝑎</ci><ci id="alg2.l3.m1.2.2.2.2.3.4.cmml" xref="alg2.l3.m1.2.2.2.2.3.4">𝑡</ci><ci id="alg2.l3.m1.2.2.2.2.3.5.cmml" xref="alg2.l3.m1.2.2.2.2.3.5">𝑎</ci><ci id="alg2.l3.m1.2.2.2.2.3.6.cmml" xref="alg2.l3.m1.2.2.2.2.3.6">𝑓</ci><ci id="alg2.l3.m1.2.2.2.2.3.7.cmml" xref="alg2.l3.m1.2.2.2.2.3.7">𝑟</ci><ci id="alg2.l3.m1.2.2.2.2.3.8.cmml" xref="alg2.l3.m1.2.2.2.2.3.8">𝑎</ci><ci id="alg2.l3.m1.2.2.2.2.3.9.cmml" xref="alg2.l3.m1.2.2.2.2.3.9">𝑚</ci><ci id="alg2.l3.m1.2.2.2.2.3.10.cmml" xref="alg2.l3.m1.2.2.2.2.3.10">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">self.dataframe\leftarrow dataframe</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.2d">italic_s italic_e italic_l italic_f . italic_d italic_a italic_t italic_a italic_f italic_r italic_a italic_m italic_e ← italic_d italic_a italic_t italic_a italic_f italic_r italic_a italic_m italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <math alttext="self.img\_dir\leftarrow img\_dir" class="ltx_Math" display="inline" id="alg2.l4.m1.2"><semantics id="alg2.l4.m1.2a"><mrow id="alg2.l4.m1.2.2.2" xref="alg2.l4.m1.2.2.3.cmml"><mrow id="alg2.l4.m1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.cmml"><mi id="alg2.l4.m1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.2.cmml">s</mi><mo id="alg2.l4.m1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.3.cmml">e</mi><mo id="alg2.l4.m1.1.1.1.1.1a" xref="alg2.l4.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m1.1.1.1.1.4" xref="alg2.l4.m1.1.1.1.1.4.cmml">l</mi><mo id="alg2.l4.m1.1.1.1.1.1b" xref="alg2.l4.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l4.m1.1.1.1.1.5" xref="alg2.l4.m1.1.1.1.1.5.cmml">f</mi></mrow><mo id="alg2.l4.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg2.l4.m1.2.2.3a.cmml">.</mo><mrow id="alg2.l4.m1.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.cmml"><mrow id="alg2.l4.m1.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.2.cmml"><mi id="alg2.l4.m1.2.2.2.2.2.2" xref="alg2.l4.m1.2.2.2.2.2.2.cmml">i</mi><mo id="alg2.l4.m1.2.2.2.2.2.1" xref="alg2.l4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.2.3.cmml">m</mi><mo id="alg2.l4.m1.2.2.2.2.2.1a" xref="alg2.l4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.2.4" xref="alg2.l4.m1.2.2.2.2.2.4.cmml">g</mi><mo id="alg2.l4.m1.2.2.2.2.2.1b" xref="alg2.l4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.2.5" mathvariant="normal" xref="alg2.l4.m1.2.2.2.2.2.5.cmml">_</mi><mo id="alg2.l4.m1.2.2.2.2.2.1c" xref="alg2.l4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.2.6" xref="alg2.l4.m1.2.2.2.2.2.6.cmml">d</mi><mo id="alg2.l4.m1.2.2.2.2.2.1d" xref="alg2.l4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.2.7" xref="alg2.l4.m1.2.2.2.2.2.7.cmml">i</mi><mo id="alg2.l4.m1.2.2.2.2.2.1e" xref="alg2.l4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.2.8" xref="alg2.l4.m1.2.2.2.2.2.8.cmml">r</mi></mrow><mo id="alg2.l4.m1.2.2.2.2.1" stretchy="false" xref="alg2.l4.m1.2.2.2.2.1.cmml">←</mo><mrow id="alg2.l4.m1.2.2.2.2.3" xref="alg2.l4.m1.2.2.2.2.3.cmml"><mi id="alg2.l4.m1.2.2.2.2.3.2" xref="alg2.l4.m1.2.2.2.2.3.2.cmml">i</mi><mo id="alg2.l4.m1.2.2.2.2.3.1" xref="alg2.l4.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.3.3" xref="alg2.l4.m1.2.2.2.2.3.3.cmml">m</mi><mo id="alg2.l4.m1.2.2.2.2.3.1a" xref="alg2.l4.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.3.4" xref="alg2.l4.m1.2.2.2.2.3.4.cmml">g</mi><mo id="alg2.l4.m1.2.2.2.2.3.1b" xref="alg2.l4.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.3.5" mathvariant="normal" xref="alg2.l4.m1.2.2.2.2.3.5.cmml">_</mi><mo id="alg2.l4.m1.2.2.2.2.3.1c" xref="alg2.l4.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.3.6" xref="alg2.l4.m1.2.2.2.2.3.6.cmml">d</mi><mo id="alg2.l4.m1.2.2.2.2.3.1d" xref="alg2.l4.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.3.7" xref="alg2.l4.m1.2.2.2.2.3.7.cmml">i</mi><mo id="alg2.l4.m1.2.2.2.2.3.1e" xref="alg2.l4.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l4.m1.2.2.2.2.3.8" xref="alg2.l4.m1.2.2.2.2.3.8.cmml">r</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.2b"><apply id="alg2.l4.m1.2.2.3.cmml" xref="alg2.l4.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.3a.cmml" xref="alg2.l4.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.l4.m1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1"><times id="alg2.l4.m1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1"></times><ci id="alg2.l4.m1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.2">𝑠</ci><ci id="alg2.l4.m1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.3">𝑒</ci><ci id="alg2.l4.m1.1.1.1.1.4.cmml" xref="alg2.l4.m1.1.1.1.1.4">𝑙</ci><ci id="alg2.l4.m1.1.1.1.1.5.cmml" xref="alg2.l4.m1.1.1.1.1.5">𝑓</ci></apply><apply id="alg2.l4.m1.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2"><ci id="alg2.l4.m1.2.2.2.2.1.cmml" xref="alg2.l4.m1.2.2.2.2.1">←</ci><apply id="alg2.l4.m1.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2.2"><times id="alg2.l4.m1.2.2.2.2.2.1.cmml" xref="alg2.l4.m1.2.2.2.2.2.1"></times><ci id="alg2.l4.m1.2.2.2.2.2.2.cmml" xref="alg2.l4.m1.2.2.2.2.2.2">𝑖</ci><ci id="alg2.l4.m1.2.2.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.2.2.3">𝑚</ci><ci id="alg2.l4.m1.2.2.2.2.2.4.cmml" xref="alg2.l4.m1.2.2.2.2.2.4">𝑔</ci><ci id="alg2.l4.m1.2.2.2.2.2.5.cmml" xref="alg2.l4.m1.2.2.2.2.2.5">_</ci><ci id="alg2.l4.m1.2.2.2.2.2.6.cmml" xref="alg2.l4.m1.2.2.2.2.2.6">𝑑</ci><ci id="alg2.l4.m1.2.2.2.2.2.7.cmml" xref="alg2.l4.m1.2.2.2.2.2.7">𝑖</ci><ci id="alg2.l4.m1.2.2.2.2.2.8.cmml" xref="alg2.l4.m1.2.2.2.2.2.8">𝑟</ci></apply><apply id="alg2.l4.m1.2.2.2.2.3.cmml" xref="alg2.l4.m1.2.2.2.2.3"><times id="alg2.l4.m1.2.2.2.2.3.1.cmml" xref="alg2.l4.m1.2.2.2.2.3.1"></times><ci id="alg2.l4.m1.2.2.2.2.3.2.cmml" xref="alg2.l4.m1.2.2.2.2.3.2">𝑖</ci><ci id="alg2.l4.m1.2.2.2.2.3.3.cmml" xref="alg2.l4.m1.2.2.2.2.3.3">𝑚</ci><ci id="alg2.l4.m1.2.2.2.2.3.4.cmml" xref="alg2.l4.m1.2.2.2.2.3.4">𝑔</ci><ci id="alg2.l4.m1.2.2.2.2.3.5.cmml" xref="alg2.l4.m1.2.2.2.2.3.5">_</ci><ci id="alg2.l4.m1.2.2.2.2.3.6.cmml" xref="alg2.l4.m1.2.2.2.2.3.6">𝑑</ci><ci id="alg2.l4.m1.2.2.2.2.3.7.cmml" xref="alg2.l4.m1.2.2.2.2.3.7">𝑖</ci><ci id="alg2.l4.m1.2.2.2.2.3.8.cmml" xref="alg2.l4.m1.2.2.2.2.3.8">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.2c">self.img\_dir\leftarrow img\_dir</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.2d">italic_s italic_e italic_l italic_f . italic_i italic_m italic_g _ italic_d italic_i italic_r ← italic_i italic_m italic_g _ italic_d italic_i italic_r</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math alttext="self.tokenizer\leftarrow tokenizer" class="ltx_Math" display="inline" id="alg2.l5.m1.2"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2.2.2" xref="alg2.l5.m1.2.2.3.cmml"><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.cmml"><mi id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.2.cmml">s</mi><mo id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.3.cmml">e</mi><mo id="alg2.l5.m1.1.1.1.1.1a" xref="alg2.l5.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l5.m1.1.1.1.1.4" xref="alg2.l5.m1.1.1.1.1.4.cmml">l</mi><mo id="alg2.l5.m1.1.1.1.1.1b" xref="alg2.l5.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l5.m1.1.1.1.1.5" xref="alg2.l5.m1.1.1.1.1.5.cmml">f</mi></mrow><mo id="alg2.l5.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg2.l5.m1.2.2.3a.cmml">.</mo><mrow id="alg2.l5.m1.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.cmml"><mrow id="alg2.l5.m1.2.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.2.cmml"><mi id="alg2.l5.m1.2.2.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.2.2.cmml">t</mi><mo id="alg2.l5.m1.2.2.2.2.2.1" xref="alg2.l5.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.2.3" xref="alg2.l5.m1.2.2.2.2.2.3.cmml">o</mi><mo id="alg2.l5.m1.2.2.2.2.2.1a" xref="alg2.l5.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.2.4" xref="alg2.l5.m1.2.2.2.2.2.4.cmml">k</mi><mo id="alg2.l5.m1.2.2.2.2.2.1b" xref="alg2.l5.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.2.5" xref="alg2.l5.m1.2.2.2.2.2.5.cmml">e</mi><mo id="alg2.l5.m1.2.2.2.2.2.1c" xref="alg2.l5.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.2.6" xref="alg2.l5.m1.2.2.2.2.2.6.cmml">n</mi><mo id="alg2.l5.m1.2.2.2.2.2.1d" xref="alg2.l5.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.2.7" xref="alg2.l5.m1.2.2.2.2.2.7.cmml">i</mi><mo id="alg2.l5.m1.2.2.2.2.2.1e" xref="alg2.l5.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.2.8" xref="alg2.l5.m1.2.2.2.2.2.8.cmml">z</mi><mo id="alg2.l5.m1.2.2.2.2.2.1f" xref="alg2.l5.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.2.9" xref="alg2.l5.m1.2.2.2.2.2.9.cmml">e</mi><mo id="alg2.l5.m1.2.2.2.2.2.1g" xref="alg2.l5.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.2.10" xref="alg2.l5.m1.2.2.2.2.2.10.cmml">r</mi></mrow><mo id="alg2.l5.m1.2.2.2.2.1" stretchy="false" xref="alg2.l5.m1.2.2.2.2.1.cmml">←</mo><mrow id="alg2.l5.m1.2.2.2.2.3" xref="alg2.l5.m1.2.2.2.2.3.cmml"><mi id="alg2.l5.m1.2.2.2.2.3.2" xref="alg2.l5.m1.2.2.2.2.3.2.cmml">t</mi><mo id="alg2.l5.m1.2.2.2.2.3.1" xref="alg2.l5.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.3.3" xref="alg2.l5.m1.2.2.2.2.3.3.cmml">o</mi><mo id="alg2.l5.m1.2.2.2.2.3.1a" xref="alg2.l5.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.3.4" xref="alg2.l5.m1.2.2.2.2.3.4.cmml">k</mi><mo id="alg2.l5.m1.2.2.2.2.3.1b" xref="alg2.l5.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.3.5" xref="alg2.l5.m1.2.2.2.2.3.5.cmml">e</mi><mo id="alg2.l5.m1.2.2.2.2.3.1c" xref="alg2.l5.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.3.6" xref="alg2.l5.m1.2.2.2.2.3.6.cmml">n</mi><mo id="alg2.l5.m1.2.2.2.2.3.1d" xref="alg2.l5.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.3.7" xref="alg2.l5.m1.2.2.2.2.3.7.cmml">i</mi><mo id="alg2.l5.m1.2.2.2.2.3.1e" xref="alg2.l5.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.3.8" xref="alg2.l5.m1.2.2.2.2.3.8.cmml">z</mi><mo id="alg2.l5.m1.2.2.2.2.3.1f" xref="alg2.l5.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.3.9" xref="alg2.l5.m1.2.2.2.2.3.9.cmml">e</mi><mo id="alg2.l5.m1.2.2.2.2.3.1g" xref="alg2.l5.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l5.m1.2.2.2.2.3.10" xref="alg2.l5.m1.2.2.2.2.3.10.cmml">r</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.2.3.cmml" xref="alg2.l5.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.3a.cmml" xref="alg2.l5.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.l5.m1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1"><times id="alg2.l5.m1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1"></times><ci id="alg2.l5.m1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.2">𝑠</ci><ci id="alg2.l5.m1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.3">𝑒</ci><ci id="alg2.l5.m1.1.1.1.1.4.cmml" xref="alg2.l5.m1.1.1.1.1.4">𝑙</ci><ci id="alg2.l5.m1.1.1.1.1.5.cmml" xref="alg2.l5.m1.1.1.1.1.5">𝑓</ci></apply><apply id="alg2.l5.m1.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2"><ci id="alg2.l5.m1.2.2.2.2.1.cmml" xref="alg2.l5.m1.2.2.2.2.1">←</ci><apply id="alg2.l5.m1.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2"><times id="alg2.l5.m1.2.2.2.2.2.1.cmml" xref="alg2.l5.m1.2.2.2.2.2.1"></times><ci id="alg2.l5.m1.2.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2.2">𝑡</ci><ci id="alg2.l5.m1.2.2.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.2.2.3">𝑜</ci><ci id="alg2.l5.m1.2.2.2.2.2.4.cmml" xref="alg2.l5.m1.2.2.2.2.2.4">𝑘</ci><ci id="alg2.l5.m1.2.2.2.2.2.5.cmml" xref="alg2.l5.m1.2.2.2.2.2.5">𝑒</ci><ci id="alg2.l5.m1.2.2.2.2.2.6.cmml" xref="alg2.l5.m1.2.2.2.2.2.6">𝑛</ci><ci id="alg2.l5.m1.2.2.2.2.2.7.cmml" xref="alg2.l5.m1.2.2.2.2.2.7">𝑖</ci><ci id="alg2.l5.m1.2.2.2.2.2.8.cmml" xref="alg2.l5.m1.2.2.2.2.2.8">𝑧</ci><ci id="alg2.l5.m1.2.2.2.2.2.9.cmml" xref="alg2.l5.m1.2.2.2.2.2.9">𝑒</ci><ci id="alg2.l5.m1.2.2.2.2.2.10.cmml" xref="alg2.l5.m1.2.2.2.2.2.10">𝑟</ci></apply><apply id="alg2.l5.m1.2.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.2.3"><times id="alg2.l5.m1.2.2.2.2.3.1.cmml" xref="alg2.l5.m1.2.2.2.2.3.1"></times><ci id="alg2.l5.m1.2.2.2.2.3.2.cmml" xref="alg2.l5.m1.2.2.2.2.3.2">𝑡</ci><ci id="alg2.l5.m1.2.2.2.2.3.3.cmml" xref="alg2.l5.m1.2.2.2.2.3.3">𝑜</ci><ci id="alg2.l5.m1.2.2.2.2.3.4.cmml" xref="alg2.l5.m1.2.2.2.2.3.4">𝑘</ci><ci id="alg2.l5.m1.2.2.2.2.3.5.cmml" xref="alg2.l5.m1.2.2.2.2.3.5">𝑒</ci><ci id="alg2.l5.m1.2.2.2.2.3.6.cmml" xref="alg2.l5.m1.2.2.2.2.3.6">𝑛</ci><ci id="alg2.l5.m1.2.2.2.2.3.7.cmml" xref="alg2.l5.m1.2.2.2.2.3.7">𝑖</ci><ci id="alg2.l5.m1.2.2.2.2.3.8.cmml" xref="alg2.l5.m1.2.2.2.2.3.8">𝑧</ci><ci id="alg2.l5.m1.2.2.2.2.3.9.cmml" xref="alg2.l5.m1.2.2.2.2.3.9">𝑒</ci><ci id="alg2.l5.m1.2.2.2.2.3.10.cmml" xref="alg2.l5.m1.2.2.2.2.3.10">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">self.tokenizer\leftarrow tokenizer</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.2d">italic_s italic_e italic_l italic_f . italic_t italic_o italic_k italic_e italic_n italic_i italic_z italic_e italic_r ← italic_t italic_o italic_k italic_e italic_n italic_i italic_z italic_e italic_r</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math alttext="self.transform\leftarrow transform" class="ltx_Math" display="inline" id="alg2.l6.m1.2"><semantics id="alg2.l6.m1.2a"><mrow id="alg2.l6.m1.2.2.2" xref="alg2.l6.m1.2.2.3.cmml"><mrow id="alg2.l6.m1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.cmml"><mi id="alg2.l6.m1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.2.cmml">s</mi><mo id="alg2.l6.m1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.3.cmml">e</mi><mo id="alg2.l6.m1.1.1.1.1.1a" xref="alg2.l6.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.1.1.4" xref="alg2.l6.m1.1.1.1.1.4.cmml">l</mi><mo id="alg2.l6.m1.1.1.1.1.1b" xref="alg2.l6.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l6.m1.1.1.1.1.5" xref="alg2.l6.m1.1.1.1.1.5.cmml">f</mi></mrow><mo id="alg2.l6.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg2.l6.m1.2.2.3a.cmml">.</mo><mrow id="alg2.l6.m1.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.cmml"><mrow id="alg2.l6.m1.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.cmml"><mi id="alg2.l6.m1.2.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.2.cmml">t</mi><mo id="alg2.l6.m1.2.2.2.2.2.1" xref="alg2.l6.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.2.3.cmml">r</mi><mo id="alg2.l6.m1.2.2.2.2.2.1a" xref="alg2.l6.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.2.4" xref="alg2.l6.m1.2.2.2.2.2.4.cmml">a</mi><mo id="alg2.l6.m1.2.2.2.2.2.1b" xref="alg2.l6.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.2.5" xref="alg2.l6.m1.2.2.2.2.2.5.cmml">n</mi><mo id="alg2.l6.m1.2.2.2.2.2.1c" xref="alg2.l6.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.2.6" xref="alg2.l6.m1.2.2.2.2.2.6.cmml">s</mi><mo id="alg2.l6.m1.2.2.2.2.2.1d" xref="alg2.l6.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.2.7" xref="alg2.l6.m1.2.2.2.2.2.7.cmml">f</mi><mo id="alg2.l6.m1.2.2.2.2.2.1e" xref="alg2.l6.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.2.8" xref="alg2.l6.m1.2.2.2.2.2.8.cmml">o</mi><mo id="alg2.l6.m1.2.2.2.2.2.1f" xref="alg2.l6.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.2.9" xref="alg2.l6.m1.2.2.2.2.2.9.cmml">r</mi><mo id="alg2.l6.m1.2.2.2.2.2.1g" xref="alg2.l6.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.2.10" xref="alg2.l6.m1.2.2.2.2.2.10.cmml">m</mi></mrow><mo id="alg2.l6.m1.2.2.2.2.1" stretchy="false" xref="alg2.l6.m1.2.2.2.2.1.cmml">←</mo><mrow id="alg2.l6.m1.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.3.cmml"><mi id="alg2.l6.m1.2.2.2.2.3.2" xref="alg2.l6.m1.2.2.2.2.3.2.cmml">t</mi><mo id="alg2.l6.m1.2.2.2.2.3.1" xref="alg2.l6.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.3.3" xref="alg2.l6.m1.2.2.2.2.3.3.cmml">r</mi><mo id="alg2.l6.m1.2.2.2.2.3.1a" xref="alg2.l6.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.3.4" xref="alg2.l6.m1.2.2.2.2.3.4.cmml">a</mi><mo id="alg2.l6.m1.2.2.2.2.3.1b" xref="alg2.l6.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.3.5" xref="alg2.l6.m1.2.2.2.2.3.5.cmml">n</mi><mo id="alg2.l6.m1.2.2.2.2.3.1c" xref="alg2.l6.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.3.6" xref="alg2.l6.m1.2.2.2.2.3.6.cmml">s</mi><mo id="alg2.l6.m1.2.2.2.2.3.1d" xref="alg2.l6.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.3.7" xref="alg2.l6.m1.2.2.2.2.3.7.cmml">f</mi><mo id="alg2.l6.m1.2.2.2.2.3.1e" xref="alg2.l6.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.3.8" xref="alg2.l6.m1.2.2.2.2.3.8.cmml">o</mi><mo id="alg2.l6.m1.2.2.2.2.3.1f" xref="alg2.l6.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.3.9" xref="alg2.l6.m1.2.2.2.2.3.9.cmml">r</mi><mo id="alg2.l6.m1.2.2.2.2.3.1g" xref="alg2.l6.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg2.l6.m1.2.2.2.2.3.10" xref="alg2.l6.m1.2.2.2.2.3.10.cmml">m</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><apply id="alg2.l6.m1.2.2.3.cmml" xref="alg2.l6.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.3a.cmml" xref="alg2.l6.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.l6.m1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1"><times id="alg2.l6.m1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1"></times><ci id="alg2.l6.m1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.2">𝑠</ci><ci id="alg2.l6.m1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.3">𝑒</ci><ci id="alg2.l6.m1.1.1.1.1.4.cmml" xref="alg2.l6.m1.1.1.1.1.4">𝑙</ci><ci id="alg2.l6.m1.1.1.1.1.5.cmml" xref="alg2.l6.m1.1.1.1.1.5">𝑓</ci></apply><apply id="alg2.l6.m1.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2"><ci id="alg2.l6.m1.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.2.1">←</ci><apply id="alg2.l6.m1.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2"><times id="alg2.l6.m1.2.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.2.2.1"></times><ci id="alg2.l6.m1.2.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2">𝑡</ci><ci id="alg2.l6.m1.2.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.2.3">𝑟</ci><ci id="alg2.l6.m1.2.2.2.2.2.4.cmml" xref="alg2.l6.m1.2.2.2.2.2.4">𝑎</ci><ci id="alg2.l6.m1.2.2.2.2.2.5.cmml" xref="alg2.l6.m1.2.2.2.2.2.5">𝑛</ci><ci id="alg2.l6.m1.2.2.2.2.2.6.cmml" xref="alg2.l6.m1.2.2.2.2.2.6">𝑠</ci><ci id="alg2.l6.m1.2.2.2.2.2.7.cmml" xref="alg2.l6.m1.2.2.2.2.2.7">𝑓</ci><ci id="alg2.l6.m1.2.2.2.2.2.8.cmml" xref="alg2.l6.m1.2.2.2.2.2.8">𝑜</ci><ci id="alg2.l6.m1.2.2.2.2.2.9.cmml" xref="alg2.l6.m1.2.2.2.2.2.9">𝑟</ci><ci id="alg2.l6.m1.2.2.2.2.2.10.cmml" xref="alg2.l6.m1.2.2.2.2.2.10">𝑚</ci></apply><apply id="alg2.l6.m1.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.3"><times id="alg2.l6.m1.2.2.2.2.3.1.cmml" xref="alg2.l6.m1.2.2.2.2.3.1"></times><ci id="alg2.l6.m1.2.2.2.2.3.2.cmml" xref="alg2.l6.m1.2.2.2.2.3.2">𝑡</ci><ci id="alg2.l6.m1.2.2.2.2.3.3.cmml" xref="alg2.l6.m1.2.2.2.2.3.3">𝑟</ci><ci id="alg2.l6.m1.2.2.2.2.3.4.cmml" xref="alg2.l6.m1.2.2.2.2.3.4">𝑎</ci><ci id="alg2.l6.m1.2.2.2.2.3.5.cmml" xref="alg2.l6.m1.2.2.2.2.3.5">𝑛</ci><ci id="alg2.l6.m1.2.2.2.2.3.6.cmml" xref="alg2.l6.m1.2.2.2.2.3.6">𝑠</ci><ci id="alg2.l6.m1.2.2.2.2.3.7.cmml" xref="alg2.l6.m1.2.2.2.2.3.7">𝑓</ci><ci id="alg2.l6.m1.2.2.2.2.3.8.cmml" xref="alg2.l6.m1.2.2.2.2.3.8">𝑜</ci><ci id="alg2.l6.m1.2.2.2.2.3.9.cmml" xref="alg2.l6.m1.2.2.2.2.3.9">𝑟</ci><ci id="alg2.l6.m1.2.2.2.2.3.10.cmml" xref="alg2.l6.m1.2.2.2.2.3.10">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">self.transform\leftarrow transform</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.2d">italic_s italic_e italic_l italic_f . italic_t italic_r italic_a italic_n italic_s italic_f italic_o italic_r italic_m ← italic_t italic_r italic_a italic_n italic_s italic_f italic_o italic_r italic_m</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span><span class="ltx_text ltx_font_bold" id="alg2.l7.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l7.2">procedure</span>
</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.2.1.1">Algorithm 3</span> </span> Model Initialization</figcaption>
<div class="ltx_listing ltx_listing" id="alg3.3">
<div class="ltx_listingline" id="alg3.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg3.l1.1">procedure</span> <span class="ltx_text ltx_font_smallcaps" id="alg3.l1.2">ImageEncoder</span>(type, pretrained)

</div>
<div class="ltx_listingline" id="alg3.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>     <math alttext="encoder\_type\leftarrow type" class="ltx_Math" display="inline" id="alg3.l2.m1.1"><semantics id="alg3.l2.m1.1a"><mrow id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml"><mrow id="alg3.l2.m1.1.1.2" xref="alg3.l2.m1.1.1.2.cmml"><mi id="alg3.l2.m1.1.1.2.2" xref="alg3.l2.m1.1.1.2.2.cmml">e</mi><mo id="alg3.l2.m1.1.1.2.1" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.3" xref="alg3.l2.m1.1.1.2.3.cmml">n</mi><mo id="alg3.l2.m1.1.1.2.1a" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.4" xref="alg3.l2.m1.1.1.2.4.cmml">c</mi><mo id="alg3.l2.m1.1.1.2.1b" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.5" xref="alg3.l2.m1.1.1.2.5.cmml">o</mi><mo id="alg3.l2.m1.1.1.2.1c" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.6" xref="alg3.l2.m1.1.1.2.6.cmml">d</mi><mo id="alg3.l2.m1.1.1.2.1d" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.7" xref="alg3.l2.m1.1.1.2.7.cmml">e</mi><mo id="alg3.l2.m1.1.1.2.1e" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.8" xref="alg3.l2.m1.1.1.2.8.cmml">r</mi><mo id="alg3.l2.m1.1.1.2.1f" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.9" mathvariant="normal" xref="alg3.l2.m1.1.1.2.9.cmml">_</mi><mo id="alg3.l2.m1.1.1.2.1g" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.10" xref="alg3.l2.m1.1.1.2.10.cmml">t</mi><mo id="alg3.l2.m1.1.1.2.1h" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.11" xref="alg3.l2.m1.1.1.2.11.cmml">y</mi><mo id="alg3.l2.m1.1.1.2.1i" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.12" xref="alg3.l2.m1.1.1.2.12.cmml">p</mi><mo id="alg3.l2.m1.1.1.2.1j" xref="alg3.l2.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.2.13" xref="alg3.l2.m1.1.1.2.13.cmml">e</mi></mrow><mo id="alg3.l2.m1.1.1.1" stretchy="false" xref="alg3.l2.m1.1.1.1.cmml">←</mo><mrow id="alg3.l2.m1.1.1.3" xref="alg3.l2.m1.1.1.3.cmml"><mi id="alg3.l2.m1.1.1.3.2" xref="alg3.l2.m1.1.1.3.2.cmml">t</mi><mo id="alg3.l2.m1.1.1.3.1" xref="alg3.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.3.3" xref="alg3.l2.m1.1.1.3.3.cmml">y</mi><mo id="alg3.l2.m1.1.1.3.1a" xref="alg3.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.3.4" xref="alg3.l2.m1.1.1.3.4.cmml">p</mi><mo id="alg3.l2.m1.1.1.3.1b" xref="alg3.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg3.l2.m1.1.1.3.5" xref="alg3.l2.m1.1.1.3.5.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><apply id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1"><ci id="alg3.l2.m1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1">←</ci><apply id="alg3.l2.m1.1.1.2.cmml" xref="alg3.l2.m1.1.1.2"><times id="alg3.l2.m1.1.1.2.1.cmml" xref="alg3.l2.m1.1.1.2.1"></times><ci id="alg3.l2.m1.1.1.2.2.cmml" xref="alg3.l2.m1.1.1.2.2">𝑒</ci><ci id="alg3.l2.m1.1.1.2.3.cmml" xref="alg3.l2.m1.1.1.2.3">𝑛</ci><ci id="alg3.l2.m1.1.1.2.4.cmml" xref="alg3.l2.m1.1.1.2.4">𝑐</ci><ci id="alg3.l2.m1.1.1.2.5.cmml" xref="alg3.l2.m1.1.1.2.5">𝑜</ci><ci id="alg3.l2.m1.1.1.2.6.cmml" xref="alg3.l2.m1.1.1.2.6">𝑑</ci><ci id="alg3.l2.m1.1.1.2.7.cmml" xref="alg3.l2.m1.1.1.2.7">𝑒</ci><ci id="alg3.l2.m1.1.1.2.8.cmml" xref="alg3.l2.m1.1.1.2.8">𝑟</ci><ci id="alg3.l2.m1.1.1.2.9.cmml" xref="alg3.l2.m1.1.1.2.9">_</ci><ci id="alg3.l2.m1.1.1.2.10.cmml" xref="alg3.l2.m1.1.1.2.10">𝑡</ci><ci id="alg3.l2.m1.1.1.2.11.cmml" xref="alg3.l2.m1.1.1.2.11">𝑦</ci><ci id="alg3.l2.m1.1.1.2.12.cmml" xref="alg3.l2.m1.1.1.2.12">𝑝</ci><ci id="alg3.l2.m1.1.1.2.13.cmml" xref="alg3.l2.m1.1.1.2.13">𝑒</ci></apply><apply id="alg3.l2.m1.1.1.3.cmml" xref="alg3.l2.m1.1.1.3"><times id="alg3.l2.m1.1.1.3.1.cmml" xref="alg3.l2.m1.1.1.3.1"></times><ci id="alg3.l2.m1.1.1.3.2.cmml" xref="alg3.l2.m1.1.1.3.2">𝑡</ci><ci id="alg3.l2.m1.1.1.3.3.cmml" xref="alg3.l2.m1.1.1.3.3">𝑦</ci><ci id="alg3.l2.m1.1.1.3.4.cmml" xref="alg3.l2.m1.1.1.3.4">𝑝</ci><ci id="alg3.l2.m1.1.1.3.5.cmml" xref="alg3.l2.m1.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">encoder\_type\leftarrow type</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m1.1d">italic_e italic_n italic_c italic_o italic_d italic_e italic_r _ italic_t italic_y italic_p italic_e ← italic_t italic_y italic_p italic_e</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l3.1">if</span> <math alttext="encoder\_type=\text{'resnet50'}" class="ltx_Math" display="inline" id="alg3.l3.m1.1"><semantics id="alg3.l3.m1.1a"><mrow id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml"><mrow id="alg3.l3.m1.1.1.2" xref="alg3.l3.m1.1.1.2.cmml"><mi id="alg3.l3.m1.1.1.2.2" xref="alg3.l3.m1.1.1.2.2.cmml">e</mi><mo id="alg3.l3.m1.1.1.2.1" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.3" xref="alg3.l3.m1.1.1.2.3.cmml">n</mi><mo id="alg3.l3.m1.1.1.2.1a" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.4" xref="alg3.l3.m1.1.1.2.4.cmml">c</mi><mo id="alg3.l3.m1.1.1.2.1b" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.5" xref="alg3.l3.m1.1.1.2.5.cmml">o</mi><mo id="alg3.l3.m1.1.1.2.1c" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.6" xref="alg3.l3.m1.1.1.2.6.cmml">d</mi><mo id="alg3.l3.m1.1.1.2.1d" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.7" xref="alg3.l3.m1.1.1.2.7.cmml">e</mi><mo id="alg3.l3.m1.1.1.2.1e" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.8" xref="alg3.l3.m1.1.1.2.8.cmml">r</mi><mo id="alg3.l3.m1.1.1.2.1f" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.9" mathvariant="normal" xref="alg3.l3.m1.1.1.2.9.cmml">_</mi><mo id="alg3.l3.m1.1.1.2.1g" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.10" xref="alg3.l3.m1.1.1.2.10.cmml">t</mi><mo id="alg3.l3.m1.1.1.2.1h" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.11" xref="alg3.l3.m1.1.1.2.11.cmml">y</mi><mo id="alg3.l3.m1.1.1.2.1i" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.12" xref="alg3.l3.m1.1.1.2.12.cmml">p</mi><mo id="alg3.l3.m1.1.1.2.1j" xref="alg3.l3.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l3.m1.1.1.2.13" xref="alg3.l3.m1.1.1.2.13.cmml">e</mi></mrow><mo id="alg3.l3.m1.1.1.1" xref="alg3.l3.m1.1.1.1.cmml">=</mo><mtext id="alg3.l3.m1.1.1.3" xref="alg3.l3.m1.1.1.3a.cmml">’resnet50’</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.1b"><apply id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1"><eq id="alg3.l3.m1.1.1.1.cmml" xref="alg3.l3.m1.1.1.1"></eq><apply id="alg3.l3.m1.1.1.2.cmml" xref="alg3.l3.m1.1.1.2"><times id="alg3.l3.m1.1.1.2.1.cmml" xref="alg3.l3.m1.1.1.2.1"></times><ci id="alg3.l3.m1.1.1.2.2.cmml" xref="alg3.l3.m1.1.1.2.2">𝑒</ci><ci id="alg3.l3.m1.1.1.2.3.cmml" xref="alg3.l3.m1.1.1.2.3">𝑛</ci><ci id="alg3.l3.m1.1.1.2.4.cmml" xref="alg3.l3.m1.1.1.2.4">𝑐</ci><ci id="alg3.l3.m1.1.1.2.5.cmml" xref="alg3.l3.m1.1.1.2.5">𝑜</ci><ci id="alg3.l3.m1.1.1.2.6.cmml" xref="alg3.l3.m1.1.1.2.6">𝑑</ci><ci id="alg3.l3.m1.1.1.2.7.cmml" xref="alg3.l3.m1.1.1.2.7">𝑒</ci><ci id="alg3.l3.m1.1.1.2.8.cmml" xref="alg3.l3.m1.1.1.2.8">𝑟</ci><ci id="alg3.l3.m1.1.1.2.9.cmml" xref="alg3.l3.m1.1.1.2.9">_</ci><ci id="alg3.l3.m1.1.1.2.10.cmml" xref="alg3.l3.m1.1.1.2.10">𝑡</ci><ci id="alg3.l3.m1.1.1.2.11.cmml" xref="alg3.l3.m1.1.1.2.11">𝑦</ci><ci id="alg3.l3.m1.1.1.2.12.cmml" xref="alg3.l3.m1.1.1.2.12">𝑝</ci><ci id="alg3.l3.m1.1.1.2.13.cmml" xref="alg3.l3.m1.1.1.2.13">𝑒</ci></apply><ci id="alg3.l3.m1.1.1.3a.cmml" xref="alg3.l3.m1.1.1.3"><mtext id="alg3.l3.m1.1.1.3.cmml" xref="alg3.l3.m1.1.1.3">’resnet50’</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.1c">encoder\_type=\text{'resnet50'}</annotation><annotation encoding="application/x-llamapun" id="alg3.l3.m1.1d">italic_e italic_n italic_c italic_o italic_d italic_e italic_r _ italic_t italic_y italic_p italic_e = ’resnet50’</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l3.2">then</span>
</div>
<div class="ltx_listingline" id="alg3.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>         Initialize ResNet50

</div>
<div class="ltx_listingline" id="alg3.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l5.1">else</span> <span class="ltx_text ltx_font_bold" id="alg3.l5.2">if</span> <math alttext="encoder\_type=\text{'efficientnet'}" class="ltx_Math" display="inline" id="alg3.l5.m1.1"><semantics id="alg3.l5.m1.1a"><mrow id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml"><mrow id="alg3.l5.m1.1.1.2" xref="alg3.l5.m1.1.1.2.cmml"><mi id="alg3.l5.m1.1.1.2.2" xref="alg3.l5.m1.1.1.2.2.cmml">e</mi><mo id="alg3.l5.m1.1.1.2.1" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.3" xref="alg3.l5.m1.1.1.2.3.cmml">n</mi><mo id="alg3.l5.m1.1.1.2.1a" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.4" xref="alg3.l5.m1.1.1.2.4.cmml">c</mi><mo id="alg3.l5.m1.1.1.2.1b" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.5" xref="alg3.l5.m1.1.1.2.5.cmml">o</mi><mo id="alg3.l5.m1.1.1.2.1c" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.6" xref="alg3.l5.m1.1.1.2.6.cmml">d</mi><mo id="alg3.l5.m1.1.1.2.1d" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.7" xref="alg3.l5.m1.1.1.2.7.cmml">e</mi><mo id="alg3.l5.m1.1.1.2.1e" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.8" xref="alg3.l5.m1.1.1.2.8.cmml">r</mi><mo id="alg3.l5.m1.1.1.2.1f" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.9" mathvariant="normal" xref="alg3.l5.m1.1.1.2.9.cmml">_</mi><mo id="alg3.l5.m1.1.1.2.1g" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.10" xref="alg3.l5.m1.1.1.2.10.cmml">t</mi><mo id="alg3.l5.m1.1.1.2.1h" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.11" xref="alg3.l5.m1.1.1.2.11.cmml">y</mi><mo id="alg3.l5.m1.1.1.2.1i" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.12" xref="alg3.l5.m1.1.1.2.12.cmml">p</mi><mo id="alg3.l5.m1.1.1.2.1j" xref="alg3.l5.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l5.m1.1.1.2.13" xref="alg3.l5.m1.1.1.2.13.cmml">e</mi></mrow><mo id="alg3.l5.m1.1.1.1" xref="alg3.l5.m1.1.1.1.cmml">=</mo><mtext id="alg3.l5.m1.1.1.3" xref="alg3.l5.m1.1.1.3a.cmml">’efficientnet’</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><apply id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1"><eq id="alg3.l5.m1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1"></eq><apply id="alg3.l5.m1.1.1.2.cmml" xref="alg3.l5.m1.1.1.2"><times id="alg3.l5.m1.1.1.2.1.cmml" xref="alg3.l5.m1.1.1.2.1"></times><ci id="alg3.l5.m1.1.1.2.2.cmml" xref="alg3.l5.m1.1.1.2.2">𝑒</ci><ci id="alg3.l5.m1.1.1.2.3.cmml" xref="alg3.l5.m1.1.1.2.3">𝑛</ci><ci id="alg3.l5.m1.1.1.2.4.cmml" xref="alg3.l5.m1.1.1.2.4">𝑐</ci><ci id="alg3.l5.m1.1.1.2.5.cmml" xref="alg3.l5.m1.1.1.2.5">𝑜</ci><ci id="alg3.l5.m1.1.1.2.6.cmml" xref="alg3.l5.m1.1.1.2.6">𝑑</ci><ci id="alg3.l5.m1.1.1.2.7.cmml" xref="alg3.l5.m1.1.1.2.7">𝑒</ci><ci id="alg3.l5.m1.1.1.2.8.cmml" xref="alg3.l5.m1.1.1.2.8">𝑟</ci><ci id="alg3.l5.m1.1.1.2.9.cmml" xref="alg3.l5.m1.1.1.2.9">_</ci><ci id="alg3.l5.m1.1.1.2.10.cmml" xref="alg3.l5.m1.1.1.2.10">𝑡</ci><ci id="alg3.l5.m1.1.1.2.11.cmml" xref="alg3.l5.m1.1.1.2.11">𝑦</ci><ci id="alg3.l5.m1.1.1.2.12.cmml" xref="alg3.l5.m1.1.1.2.12">𝑝</ci><ci id="alg3.l5.m1.1.1.2.13.cmml" xref="alg3.l5.m1.1.1.2.13">𝑒</ci></apply><ci id="alg3.l5.m1.1.1.3a.cmml" xref="alg3.l5.m1.1.1.3"><mtext id="alg3.l5.m1.1.1.3.cmml" xref="alg3.l5.m1.1.1.3">’efficientnet’</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">encoder\_type=\text{'efficientnet'}</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.m1.1d">italic_e italic_n italic_c italic_o italic_d italic_e italic_r _ italic_t italic_y italic_p italic_e = ’efficientnet’</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l5.3">then</span>
</div>
<div class="ltx_listingline" id="alg3.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>         Initialize EfficientNet-B0

</div>
<div class="ltx_listingline" id="alg3.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l7.1">else</span> <span class="ltx_text ltx_font_bold" id="alg3.l7.2">if</span> <math alttext="encoder\_type=\text{'vit'}" class="ltx_Math" display="inline" id="alg3.l7.m1.1"><semantics id="alg3.l7.m1.1a"><mrow id="alg3.l7.m1.1.1" xref="alg3.l7.m1.1.1.cmml"><mrow id="alg3.l7.m1.1.1.2" xref="alg3.l7.m1.1.1.2.cmml"><mi id="alg3.l7.m1.1.1.2.2" xref="alg3.l7.m1.1.1.2.2.cmml">e</mi><mo id="alg3.l7.m1.1.1.2.1" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.3" xref="alg3.l7.m1.1.1.2.3.cmml">n</mi><mo id="alg3.l7.m1.1.1.2.1a" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.4" xref="alg3.l7.m1.1.1.2.4.cmml">c</mi><mo id="alg3.l7.m1.1.1.2.1b" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.5" xref="alg3.l7.m1.1.1.2.5.cmml">o</mi><mo id="alg3.l7.m1.1.1.2.1c" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.6" xref="alg3.l7.m1.1.1.2.6.cmml">d</mi><mo id="alg3.l7.m1.1.1.2.1d" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.7" xref="alg3.l7.m1.1.1.2.7.cmml">e</mi><mo id="alg3.l7.m1.1.1.2.1e" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.8" xref="alg3.l7.m1.1.1.2.8.cmml">r</mi><mo id="alg3.l7.m1.1.1.2.1f" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.9" mathvariant="normal" xref="alg3.l7.m1.1.1.2.9.cmml">_</mi><mo id="alg3.l7.m1.1.1.2.1g" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.10" xref="alg3.l7.m1.1.1.2.10.cmml">t</mi><mo id="alg3.l7.m1.1.1.2.1h" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.11" xref="alg3.l7.m1.1.1.2.11.cmml">y</mi><mo id="alg3.l7.m1.1.1.2.1i" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.12" xref="alg3.l7.m1.1.1.2.12.cmml">p</mi><mo id="alg3.l7.m1.1.1.2.1j" xref="alg3.l7.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l7.m1.1.1.2.13" xref="alg3.l7.m1.1.1.2.13.cmml">e</mi></mrow><mo id="alg3.l7.m1.1.1.1" xref="alg3.l7.m1.1.1.1.cmml">=</mo><mtext id="alg3.l7.m1.1.1.3" xref="alg3.l7.m1.1.1.3a.cmml">’vit’</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.m1.1b"><apply id="alg3.l7.m1.1.1.cmml" xref="alg3.l7.m1.1.1"><eq id="alg3.l7.m1.1.1.1.cmml" xref="alg3.l7.m1.1.1.1"></eq><apply id="alg3.l7.m1.1.1.2.cmml" xref="alg3.l7.m1.1.1.2"><times id="alg3.l7.m1.1.1.2.1.cmml" xref="alg3.l7.m1.1.1.2.1"></times><ci id="alg3.l7.m1.1.1.2.2.cmml" xref="alg3.l7.m1.1.1.2.2">𝑒</ci><ci id="alg3.l7.m1.1.1.2.3.cmml" xref="alg3.l7.m1.1.1.2.3">𝑛</ci><ci id="alg3.l7.m1.1.1.2.4.cmml" xref="alg3.l7.m1.1.1.2.4">𝑐</ci><ci id="alg3.l7.m1.1.1.2.5.cmml" xref="alg3.l7.m1.1.1.2.5">𝑜</ci><ci id="alg3.l7.m1.1.1.2.6.cmml" xref="alg3.l7.m1.1.1.2.6">𝑑</ci><ci id="alg3.l7.m1.1.1.2.7.cmml" xref="alg3.l7.m1.1.1.2.7">𝑒</ci><ci id="alg3.l7.m1.1.1.2.8.cmml" xref="alg3.l7.m1.1.1.2.8">𝑟</ci><ci id="alg3.l7.m1.1.1.2.9.cmml" xref="alg3.l7.m1.1.1.2.9">_</ci><ci id="alg3.l7.m1.1.1.2.10.cmml" xref="alg3.l7.m1.1.1.2.10">𝑡</ci><ci id="alg3.l7.m1.1.1.2.11.cmml" xref="alg3.l7.m1.1.1.2.11">𝑦</ci><ci id="alg3.l7.m1.1.1.2.12.cmml" xref="alg3.l7.m1.1.1.2.12">𝑝</ci><ci id="alg3.l7.m1.1.1.2.13.cmml" xref="alg3.l7.m1.1.1.2.13">𝑒</ci></apply><ci id="alg3.l7.m1.1.1.3a.cmml" xref="alg3.l7.m1.1.1.3"><mtext id="alg3.l7.m1.1.1.3.cmml" xref="alg3.l7.m1.1.1.3">’vit’</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.m1.1c">encoder\_type=\text{'vit'}</annotation><annotation encoding="application/x-llamapun" id="alg3.l7.m1.1d">italic_e italic_n italic_c italic_o italic_d italic_e italic_r _ italic_t italic_y italic_p italic_e = ’vit’</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l7.3">then</span>
</div>
<div class="ltx_listingline" id="alg3.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>         Initialize Vision Transformer (ViT)

</div>
<div class="ltx_listingline" id="alg3.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l9.1">else</span> <span class="ltx_text ltx_font_bold" id="alg3.l9.2">if</span> <math alttext="encoder\_type=\text{'swin\_transformer'}" class="ltx_Math" display="inline" id="alg3.l9.m1.1"><semantics id="alg3.l9.m1.1a"><mrow id="alg3.l9.m1.1.1" xref="alg3.l9.m1.1.1.cmml"><mrow id="alg3.l9.m1.1.1.2" xref="alg3.l9.m1.1.1.2.cmml"><mi id="alg3.l9.m1.1.1.2.2" xref="alg3.l9.m1.1.1.2.2.cmml">e</mi><mo id="alg3.l9.m1.1.1.2.1" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.3" xref="alg3.l9.m1.1.1.2.3.cmml">n</mi><mo id="alg3.l9.m1.1.1.2.1a" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.4" xref="alg3.l9.m1.1.1.2.4.cmml">c</mi><mo id="alg3.l9.m1.1.1.2.1b" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.5" xref="alg3.l9.m1.1.1.2.5.cmml">o</mi><mo id="alg3.l9.m1.1.1.2.1c" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.6" xref="alg3.l9.m1.1.1.2.6.cmml">d</mi><mo id="alg3.l9.m1.1.1.2.1d" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.7" xref="alg3.l9.m1.1.1.2.7.cmml">e</mi><mo id="alg3.l9.m1.1.1.2.1e" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.8" xref="alg3.l9.m1.1.1.2.8.cmml">r</mi><mo id="alg3.l9.m1.1.1.2.1f" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.9" mathvariant="normal" xref="alg3.l9.m1.1.1.2.9.cmml">_</mi><mo id="alg3.l9.m1.1.1.2.1g" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.10" xref="alg3.l9.m1.1.1.2.10.cmml">t</mi><mo id="alg3.l9.m1.1.1.2.1h" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.11" xref="alg3.l9.m1.1.1.2.11.cmml">y</mi><mo id="alg3.l9.m1.1.1.2.1i" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.12" xref="alg3.l9.m1.1.1.2.12.cmml">p</mi><mo id="alg3.l9.m1.1.1.2.1j" xref="alg3.l9.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l9.m1.1.1.2.13" xref="alg3.l9.m1.1.1.2.13.cmml">e</mi></mrow><mo id="alg3.l9.m1.1.1.1" xref="alg3.l9.m1.1.1.1.cmml">=</mo><mtext id="alg3.l9.m1.1.1.3" xref="alg3.l9.m1.1.1.3a.cmml">’swin_transformer’</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg3.l9.m1.1b"><apply id="alg3.l9.m1.1.1.cmml" xref="alg3.l9.m1.1.1"><eq id="alg3.l9.m1.1.1.1.cmml" xref="alg3.l9.m1.1.1.1"></eq><apply id="alg3.l9.m1.1.1.2.cmml" xref="alg3.l9.m1.1.1.2"><times id="alg3.l9.m1.1.1.2.1.cmml" xref="alg3.l9.m1.1.1.2.1"></times><ci id="alg3.l9.m1.1.1.2.2.cmml" xref="alg3.l9.m1.1.1.2.2">𝑒</ci><ci id="alg3.l9.m1.1.1.2.3.cmml" xref="alg3.l9.m1.1.1.2.3">𝑛</ci><ci id="alg3.l9.m1.1.1.2.4.cmml" xref="alg3.l9.m1.1.1.2.4">𝑐</ci><ci id="alg3.l9.m1.1.1.2.5.cmml" xref="alg3.l9.m1.1.1.2.5">𝑜</ci><ci id="alg3.l9.m1.1.1.2.6.cmml" xref="alg3.l9.m1.1.1.2.6">𝑑</ci><ci id="alg3.l9.m1.1.1.2.7.cmml" xref="alg3.l9.m1.1.1.2.7">𝑒</ci><ci id="alg3.l9.m1.1.1.2.8.cmml" xref="alg3.l9.m1.1.1.2.8">𝑟</ci><ci id="alg3.l9.m1.1.1.2.9.cmml" xref="alg3.l9.m1.1.1.2.9">_</ci><ci id="alg3.l9.m1.1.1.2.10.cmml" xref="alg3.l9.m1.1.1.2.10">𝑡</ci><ci id="alg3.l9.m1.1.1.2.11.cmml" xref="alg3.l9.m1.1.1.2.11">𝑦</ci><ci id="alg3.l9.m1.1.1.2.12.cmml" xref="alg3.l9.m1.1.1.2.12">𝑝</ci><ci id="alg3.l9.m1.1.1.2.13.cmml" xref="alg3.l9.m1.1.1.2.13">𝑒</ci></apply><ci id="alg3.l9.m1.1.1.3a.cmml" xref="alg3.l9.m1.1.1.3"><mtext id="alg3.l9.m1.1.1.3.cmml" xref="alg3.l9.m1.1.1.3">’swin_transformer’</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l9.m1.1c">encoder\_type=\text{'swin\_transformer'}</annotation><annotation encoding="application/x-llamapun" id="alg3.l9.m1.1d">italic_e italic_n italic_c italic_o italic_d italic_e italic_r _ italic_t italic_y italic_p italic_e = ’swin_transformer’</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l9.3">then</span>
</div>
<div class="ltx_listingline" id="alg3.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>         Initialize Swin Transformer

</div>
<div class="ltx_listingline" id="alg3.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l11.1">else</span> <span class="ltx_text ltx_font_bold" id="alg3.l11.2">if</span> <math alttext="encoder\_type=\text{'convnext'}" class="ltx_Math" display="inline" id="alg3.l11.m1.1"><semantics id="alg3.l11.m1.1a"><mrow id="alg3.l11.m1.1.1" xref="alg3.l11.m1.1.1.cmml"><mrow id="alg3.l11.m1.1.1.2" xref="alg3.l11.m1.1.1.2.cmml"><mi id="alg3.l11.m1.1.1.2.2" xref="alg3.l11.m1.1.1.2.2.cmml">e</mi><mo id="alg3.l11.m1.1.1.2.1" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.3" xref="alg3.l11.m1.1.1.2.3.cmml">n</mi><mo id="alg3.l11.m1.1.1.2.1a" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.4" xref="alg3.l11.m1.1.1.2.4.cmml">c</mi><mo id="alg3.l11.m1.1.1.2.1b" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.5" xref="alg3.l11.m1.1.1.2.5.cmml">o</mi><mo id="alg3.l11.m1.1.1.2.1c" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.6" xref="alg3.l11.m1.1.1.2.6.cmml">d</mi><mo id="alg3.l11.m1.1.1.2.1d" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.7" xref="alg3.l11.m1.1.1.2.7.cmml">e</mi><mo id="alg3.l11.m1.1.1.2.1e" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.8" xref="alg3.l11.m1.1.1.2.8.cmml">r</mi><mo id="alg3.l11.m1.1.1.2.1f" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.9" mathvariant="normal" xref="alg3.l11.m1.1.1.2.9.cmml">_</mi><mo id="alg3.l11.m1.1.1.2.1g" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.10" xref="alg3.l11.m1.1.1.2.10.cmml">t</mi><mo id="alg3.l11.m1.1.1.2.1h" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.11" xref="alg3.l11.m1.1.1.2.11.cmml">y</mi><mo id="alg3.l11.m1.1.1.2.1i" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.12" xref="alg3.l11.m1.1.1.2.12.cmml">p</mi><mo id="alg3.l11.m1.1.1.2.1j" xref="alg3.l11.m1.1.1.2.1.cmml">⁢</mo><mi id="alg3.l11.m1.1.1.2.13" xref="alg3.l11.m1.1.1.2.13.cmml">e</mi></mrow><mo id="alg3.l11.m1.1.1.1" xref="alg3.l11.m1.1.1.1.cmml">=</mo><mtext id="alg3.l11.m1.1.1.3" xref="alg3.l11.m1.1.1.3a.cmml">’convnext’</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.1b"><apply id="alg3.l11.m1.1.1.cmml" xref="alg3.l11.m1.1.1"><eq id="alg3.l11.m1.1.1.1.cmml" xref="alg3.l11.m1.1.1.1"></eq><apply id="alg3.l11.m1.1.1.2.cmml" xref="alg3.l11.m1.1.1.2"><times id="alg3.l11.m1.1.1.2.1.cmml" xref="alg3.l11.m1.1.1.2.1"></times><ci id="alg3.l11.m1.1.1.2.2.cmml" xref="alg3.l11.m1.1.1.2.2">𝑒</ci><ci id="alg3.l11.m1.1.1.2.3.cmml" xref="alg3.l11.m1.1.1.2.3">𝑛</ci><ci id="alg3.l11.m1.1.1.2.4.cmml" xref="alg3.l11.m1.1.1.2.4">𝑐</ci><ci id="alg3.l11.m1.1.1.2.5.cmml" xref="alg3.l11.m1.1.1.2.5">𝑜</ci><ci id="alg3.l11.m1.1.1.2.6.cmml" xref="alg3.l11.m1.1.1.2.6">𝑑</ci><ci id="alg3.l11.m1.1.1.2.7.cmml" xref="alg3.l11.m1.1.1.2.7">𝑒</ci><ci id="alg3.l11.m1.1.1.2.8.cmml" xref="alg3.l11.m1.1.1.2.8">𝑟</ci><ci id="alg3.l11.m1.1.1.2.9.cmml" xref="alg3.l11.m1.1.1.2.9">_</ci><ci id="alg3.l11.m1.1.1.2.10.cmml" xref="alg3.l11.m1.1.1.2.10">𝑡</ci><ci id="alg3.l11.m1.1.1.2.11.cmml" xref="alg3.l11.m1.1.1.2.11">𝑦</ci><ci id="alg3.l11.m1.1.1.2.12.cmml" xref="alg3.l11.m1.1.1.2.12">𝑝</ci><ci id="alg3.l11.m1.1.1.2.13.cmml" xref="alg3.l11.m1.1.1.2.13">𝑒</ci></apply><ci id="alg3.l11.m1.1.1.3a.cmml" xref="alg3.l11.m1.1.1.3"><mtext id="alg3.l11.m1.1.1.3.cmml" xref="alg3.l11.m1.1.1.3">’convnext’</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.1c">encoder\_type=\text{'convnext'}</annotation><annotation encoding="application/x-llamapun" id="alg3.l11.m1.1d">italic_e italic_n italic_c italic_o italic_d italic_e italic_r _ italic_t italic_y italic_p italic_e = ’convnext’</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg3.l11.3">then</span>
</div>
<div class="ltx_listingline" id="alg3.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>         Initialize ConvNeXt

</div>
<div class="ltx_listingline" id="alg3.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span class="ltx_text ltx_font_bold" id="alg3.l13.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l13.2">if</span>
</div>
<div class="ltx_listingline" id="alg3.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>     Load pretrained weights if applicable

</div>
<div class="ltx_listingline" id="alg3.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span><span class="ltx_text ltx_font_bold" id="alg3.l15.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l15.2">procedure</span>
</div>
<div class="ltx_listingline" id="alg3.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span><span class="ltx_text ltx_font_bold" id="alg3.l16.1">procedure</span> <span class="ltx_text ltx_font_smallcaps" id="alg3.l16.2">TextEncoder</span>(model_name, pretrained)

</div>
<div class="ltx_listingline" id="alg3.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>     Initialize text encoder (BERT-like)

</div>
<div class="ltx_listingline" id="alg3.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>     Load pretrained weights if applicable

</div>
<div class="ltx_listingline" id="alg3.l19">
<span class="ltx_tag ltx_tag_listingline">19:</span><span class="ltx_text ltx_font_bold" id="alg3.l19.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l19.2">procedure</span>
</div>
<div class="ltx_listingline" id="alg3.l20">
<span class="ltx_tag ltx_tag_listingline">20:</span><span class="ltx_text ltx_font_bold" id="alg3.l20.1">procedure</span> <span class="ltx_text ltx_font_smallcaps" id="alg3.l20.2">CLIPModel</span>(image_encoder, text_encoder, output_dim)

</div>
<div class="ltx_listingline" id="alg3.l21">
<span class="ltx_tag ltx_tag_listingline">21:</span>     Initialize encoders

</div>
<div class="ltx_listingline" id="alg3.l22">
<span class="ltx_tag ltx_tag_listingline">22:</span>     Attach projection heads

</div>
<div class="ltx_listingline" id="alg3.l23">
<span class="ltx_tag ltx_tag_listingline">23:</span><span class="ltx_text ltx_font_bold" id="alg3.l23.1">end</span> <span class="ltx_text ltx_font_bold" id="alg3.l23.2">procedure</span>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="206" id="A1.F8.g1" src="extracted/5812574/Figure/sample_3_lq.png" width="359"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span><span class="ltx_text ltx_font_bold" id="A1.F8.2.1">Model Inference Example 2.</span> The query posed is "A girl eating on the street".</figcaption>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg4.2.1.1">Algorithm 4</span> </span> Training Loop</figcaption>
<div class="ltx_listing ltx_listing" id="alg4.3">
<div class="ltx_listingline" id="alg4.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><math alttext="train\_loader,model,optimizer,scheduler" class="ltx_Math" display="inline" id="alg4.l1.m1.4"><semantics id="alg4.l1.m1.4a"><mrow id="alg4.l1.m1.4.4.4" xref="alg4.l1.m1.4.4.5.cmml"><mrow id="alg4.l1.m1.1.1.1.1" xref="alg4.l1.m1.1.1.1.1.cmml"><mi id="alg4.l1.m1.1.1.1.1.2" xref="alg4.l1.m1.1.1.1.1.2.cmml">t</mi><mo id="alg4.l1.m1.1.1.1.1.1" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.3" xref="alg4.l1.m1.1.1.1.1.3.cmml">r</mi><mo id="alg4.l1.m1.1.1.1.1.1a" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.4" xref="alg4.l1.m1.1.1.1.1.4.cmml">a</mi><mo id="alg4.l1.m1.1.1.1.1.1b" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.5" xref="alg4.l1.m1.1.1.1.1.5.cmml">i</mi><mo id="alg4.l1.m1.1.1.1.1.1c" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.6" xref="alg4.l1.m1.1.1.1.1.6.cmml">n</mi><mo id="alg4.l1.m1.1.1.1.1.1d" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.7" mathvariant="normal" xref="alg4.l1.m1.1.1.1.1.7.cmml">_</mi><mo id="alg4.l1.m1.1.1.1.1.1e" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.8" xref="alg4.l1.m1.1.1.1.1.8.cmml">l</mi><mo id="alg4.l1.m1.1.1.1.1.1f" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.9" xref="alg4.l1.m1.1.1.1.1.9.cmml">o</mi><mo id="alg4.l1.m1.1.1.1.1.1g" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.10" xref="alg4.l1.m1.1.1.1.1.10.cmml">a</mi><mo id="alg4.l1.m1.1.1.1.1.1h" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.11" xref="alg4.l1.m1.1.1.1.1.11.cmml">d</mi><mo id="alg4.l1.m1.1.1.1.1.1i" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.12" xref="alg4.l1.m1.1.1.1.1.12.cmml">e</mi><mo id="alg4.l1.m1.1.1.1.1.1j" xref="alg4.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l1.m1.1.1.1.1.13" xref="alg4.l1.m1.1.1.1.1.13.cmml">r</mi></mrow><mo id="alg4.l1.m1.4.4.4.5" xref="alg4.l1.m1.4.4.5.cmml">,</mo><mrow id="alg4.l1.m1.2.2.2.2" xref="alg4.l1.m1.2.2.2.2.cmml"><mi id="alg4.l1.m1.2.2.2.2.2" xref="alg4.l1.m1.2.2.2.2.2.cmml">m</mi><mo id="alg4.l1.m1.2.2.2.2.1" xref="alg4.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l1.m1.2.2.2.2.3" xref="alg4.l1.m1.2.2.2.2.3.cmml">o</mi><mo id="alg4.l1.m1.2.2.2.2.1a" xref="alg4.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l1.m1.2.2.2.2.4" xref="alg4.l1.m1.2.2.2.2.4.cmml">d</mi><mo id="alg4.l1.m1.2.2.2.2.1b" xref="alg4.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l1.m1.2.2.2.2.5" xref="alg4.l1.m1.2.2.2.2.5.cmml">e</mi><mo id="alg4.l1.m1.2.2.2.2.1c" xref="alg4.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l1.m1.2.2.2.2.6" xref="alg4.l1.m1.2.2.2.2.6.cmml">l</mi></mrow><mo id="alg4.l1.m1.4.4.4.6" xref="alg4.l1.m1.4.4.5.cmml">,</mo><mrow id="alg4.l1.m1.3.3.3.3" xref="alg4.l1.m1.3.3.3.3.cmml"><mi id="alg4.l1.m1.3.3.3.3.2" xref="alg4.l1.m1.3.3.3.3.2.cmml">o</mi><mo id="alg4.l1.m1.3.3.3.3.1" xref="alg4.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l1.m1.3.3.3.3.3" xref="alg4.l1.m1.3.3.3.3.3.cmml">p</mi><mo id="alg4.l1.m1.3.3.3.3.1a" xref="alg4.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l1.m1.3.3.3.3.4" xref="alg4.l1.m1.3.3.3.3.4.cmml">t</mi><mo id="alg4.l1.m1.3.3.3.3.1b" xref="alg4.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l1.m1.3.3.3.3.5" xref="alg4.l1.m1.3.3.3.3.5.cmml">i</mi><mo id="alg4.l1.m1.3.3.3.3.1c" xref="alg4.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l1.m1.3.3.3.3.6" xref="alg4.l1.m1.3.3.3.3.6.cmml">m</mi><mo id="alg4.l1.m1.3.3.3.3.1d" xref="alg4.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l1.m1.3.3.3.3.7" xref="alg4.l1.m1.3.3.3.3.7.cmml">i</mi><mo id="alg4.l1.m1.3.3.3.3.1e" xref="alg4.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l1.m1.3.3.3.3.8" xref="alg4.l1.m1.3.3.3.3.8.cmml">z</mi><mo id="alg4.l1.m1.3.3.3.3.1f" xref="alg4.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l1.m1.3.3.3.3.9" xref="alg4.l1.m1.3.3.3.3.9.cmml">e</mi><mo id="alg4.l1.m1.3.3.3.3.1g" xref="alg4.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l1.m1.3.3.3.3.10" xref="alg4.l1.m1.3.3.3.3.10.cmml">r</mi></mrow><mo id="alg4.l1.m1.4.4.4.7" xref="alg4.l1.m1.4.4.5.cmml">,</mo><mrow id="alg4.l1.m1.4.4.4.4" xref="alg4.l1.m1.4.4.4.4.cmml"><mi id="alg4.l1.m1.4.4.4.4.2" xref="alg4.l1.m1.4.4.4.4.2.cmml">s</mi><mo id="alg4.l1.m1.4.4.4.4.1" xref="alg4.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg4.l1.m1.4.4.4.4.3" xref="alg4.l1.m1.4.4.4.4.3.cmml">c</mi><mo id="alg4.l1.m1.4.4.4.4.1a" xref="alg4.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg4.l1.m1.4.4.4.4.4" xref="alg4.l1.m1.4.4.4.4.4.cmml">h</mi><mo id="alg4.l1.m1.4.4.4.4.1b" xref="alg4.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg4.l1.m1.4.4.4.4.5" xref="alg4.l1.m1.4.4.4.4.5.cmml">e</mi><mo id="alg4.l1.m1.4.4.4.4.1c" xref="alg4.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg4.l1.m1.4.4.4.4.6" xref="alg4.l1.m1.4.4.4.4.6.cmml">d</mi><mo id="alg4.l1.m1.4.4.4.4.1d" xref="alg4.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg4.l1.m1.4.4.4.4.7" xref="alg4.l1.m1.4.4.4.4.7.cmml">u</mi><mo id="alg4.l1.m1.4.4.4.4.1e" xref="alg4.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg4.l1.m1.4.4.4.4.8" xref="alg4.l1.m1.4.4.4.4.8.cmml">l</mi><mo id="alg4.l1.m1.4.4.4.4.1f" xref="alg4.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg4.l1.m1.4.4.4.4.9" xref="alg4.l1.m1.4.4.4.4.9.cmml">e</mi><mo id="alg4.l1.m1.4.4.4.4.1g" xref="alg4.l1.m1.4.4.4.4.1.cmml">⁢</mo><mi id="alg4.l1.m1.4.4.4.4.10" xref="alg4.l1.m1.4.4.4.4.10.cmml">r</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l1.m1.4b"><list id="alg4.l1.m1.4.4.5.cmml" xref="alg4.l1.m1.4.4.4"><apply id="alg4.l1.m1.1.1.1.1.cmml" xref="alg4.l1.m1.1.1.1.1"><times id="alg4.l1.m1.1.1.1.1.1.cmml" xref="alg4.l1.m1.1.1.1.1.1"></times><ci id="alg4.l1.m1.1.1.1.1.2.cmml" xref="alg4.l1.m1.1.1.1.1.2">𝑡</ci><ci id="alg4.l1.m1.1.1.1.1.3.cmml" xref="alg4.l1.m1.1.1.1.1.3">𝑟</ci><ci id="alg4.l1.m1.1.1.1.1.4.cmml" xref="alg4.l1.m1.1.1.1.1.4">𝑎</ci><ci id="alg4.l1.m1.1.1.1.1.5.cmml" xref="alg4.l1.m1.1.1.1.1.5">𝑖</ci><ci id="alg4.l1.m1.1.1.1.1.6.cmml" xref="alg4.l1.m1.1.1.1.1.6">𝑛</ci><ci id="alg4.l1.m1.1.1.1.1.7.cmml" xref="alg4.l1.m1.1.1.1.1.7">_</ci><ci id="alg4.l1.m1.1.1.1.1.8.cmml" xref="alg4.l1.m1.1.1.1.1.8">𝑙</ci><ci id="alg4.l1.m1.1.1.1.1.9.cmml" xref="alg4.l1.m1.1.1.1.1.9">𝑜</ci><ci id="alg4.l1.m1.1.1.1.1.10.cmml" xref="alg4.l1.m1.1.1.1.1.10">𝑎</ci><ci id="alg4.l1.m1.1.1.1.1.11.cmml" xref="alg4.l1.m1.1.1.1.1.11">𝑑</ci><ci id="alg4.l1.m1.1.1.1.1.12.cmml" xref="alg4.l1.m1.1.1.1.1.12">𝑒</ci><ci id="alg4.l1.m1.1.1.1.1.13.cmml" xref="alg4.l1.m1.1.1.1.1.13">𝑟</ci></apply><apply id="alg4.l1.m1.2.2.2.2.cmml" xref="alg4.l1.m1.2.2.2.2"><times id="alg4.l1.m1.2.2.2.2.1.cmml" xref="alg4.l1.m1.2.2.2.2.1"></times><ci id="alg4.l1.m1.2.2.2.2.2.cmml" xref="alg4.l1.m1.2.2.2.2.2">𝑚</ci><ci id="alg4.l1.m1.2.2.2.2.3.cmml" xref="alg4.l1.m1.2.2.2.2.3">𝑜</ci><ci id="alg4.l1.m1.2.2.2.2.4.cmml" xref="alg4.l1.m1.2.2.2.2.4">𝑑</ci><ci id="alg4.l1.m1.2.2.2.2.5.cmml" xref="alg4.l1.m1.2.2.2.2.5">𝑒</ci><ci id="alg4.l1.m1.2.2.2.2.6.cmml" xref="alg4.l1.m1.2.2.2.2.6">𝑙</ci></apply><apply id="alg4.l1.m1.3.3.3.3.cmml" xref="alg4.l1.m1.3.3.3.3"><times id="alg4.l1.m1.3.3.3.3.1.cmml" xref="alg4.l1.m1.3.3.3.3.1"></times><ci id="alg4.l1.m1.3.3.3.3.2.cmml" xref="alg4.l1.m1.3.3.3.3.2">𝑜</ci><ci id="alg4.l1.m1.3.3.3.3.3.cmml" xref="alg4.l1.m1.3.3.3.3.3">𝑝</ci><ci id="alg4.l1.m1.3.3.3.3.4.cmml" xref="alg4.l1.m1.3.3.3.3.4">𝑡</ci><ci id="alg4.l1.m1.3.3.3.3.5.cmml" xref="alg4.l1.m1.3.3.3.3.5">𝑖</ci><ci id="alg4.l1.m1.3.3.3.3.6.cmml" xref="alg4.l1.m1.3.3.3.3.6">𝑚</ci><ci id="alg4.l1.m1.3.3.3.3.7.cmml" xref="alg4.l1.m1.3.3.3.3.7">𝑖</ci><ci id="alg4.l1.m1.3.3.3.3.8.cmml" xref="alg4.l1.m1.3.3.3.3.8">𝑧</ci><ci id="alg4.l1.m1.3.3.3.3.9.cmml" xref="alg4.l1.m1.3.3.3.3.9">𝑒</ci><ci id="alg4.l1.m1.3.3.3.3.10.cmml" xref="alg4.l1.m1.3.3.3.3.10">𝑟</ci></apply><apply id="alg4.l1.m1.4.4.4.4.cmml" xref="alg4.l1.m1.4.4.4.4"><times id="alg4.l1.m1.4.4.4.4.1.cmml" xref="alg4.l1.m1.4.4.4.4.1"></times><ci id="alg4.l1.m1.4.4.4.4.2.cmml" xref="alg4.l1.m1.4.4.4.4.2">𝑠</ci><ci id="alg4.l1.m1.4.4.4.4.3.cmml" xref="alg4.l1.m1.4.4.4.4.3">𝑐</ci><ci id="alg4.l1.m1.4.4.4.4.4.cmml" xref="alg4.l1.m1.4.4.4.4.4">ℎ</ci><ci id="alg4.l1.m1.4.4.4.4.5.cmml" xref="alg4.l1.m1.4.4.4.4.5">𝑒</ci><ci id="alg4.l1.m1.4.4.4.4.6.cmml" xref="alg4.l1.m1.4.4.4.4.6">𝑑</ci><ci id="alg4.l1.m1.4.4.4.4.7.cmml" xref="alg4.l1.m1.4.4.4.4.7">𝑢</ci><ci id="alg4.l1.m1.4.4.4.4.8.cmml" xref="alg4.l1.m1.4.4.4.4.8">𝑙</ci><ci id="alg4.l1.m1.4.4.4.4.9.cmml" xref="alg4.l1.m1.4.4.4.4.9">𝑒</ci><ci id="alg4.l1.m1.4.4.4.4.10.cmml" xref="alg4.l1.m1.4.4.4.4.10">𝑟</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m1.4c">train\_loader,model,optimizer,scheduler</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m1.4d">italic_t italic_r italic_a italic_i italic_n _ italic_l italic_o italic_a italic_d italic_e italic_r , italic_m italic_o italic_d italic_e italic_l , italic_o italic_p italic_t italic_i italic_m italic_i italic_z italic_e italic_r , italic_s italic_c italic_h italic_e italic_d italic_u italic_l italic_e italic_r</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>Initialize GPU setup (e.g., Nvidia T4)

</div>
<div class="ltx_listingline" id="alg4.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><span class="ltx_text ltx_font_bold" id="alg4.l3.1">while</span> not converged <span class="ltx_text ltx_font_bold" id="alg4.l3.2">do</span>
</div>
<div class="ltx_listingline" id="alg4.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span class="ltx_text ltx_font_bold" id="alg4.l4.1">for</span> images, input_ids, attention_masks in train_loader <span class="ltx_text ltx_font_bold" id="alg4.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg4.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>         Forward pass with <math alttext="images,input\_ids,attention\_masks" class="ltx_Math" display="inline" id="alg4.l5.m1.3"><semantics id="alg4.l5.m1.3a"><mrow id="alg4.l5.m1.3.3.3" xref="alg4.l5.m1.3.3.4.cmml"><mrow id="alg4.l5.m1.1.1.1.1" xref="alg4.l5.m1.1.1.1.1.cmml"><mi id="alg4.l5.m1.1.1.1.1.2" xref="alg4.l5.m1.1.1.1.1.2.cmml">i</mi><mo id="alg4.l5.m1.1.1.1.1.1" xref="alg4.l5.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.1.1.3" xref="alg4.l5.m1.1.1.1.1.3.cmml">m</mi><mo id="alg4.l5.m1.1.1.1.1.1a" xref="alg4.l5.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.1.1.4" xref="alg4.l5.m1.1.1.1.1.4.cmml">a</mi><mo id="alg4.l5.m1.1.1.1.1.1b" xref="alg4.l5.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.1.1.5" xref="alg4.l5.m1.1.1.1.1.5.cmml">g</mi><mo id="alg4.l5.m1.1.1.1.1.1c" xref="alg4.l5.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.1.1.6" xref="alg4.l5.m1.1.1.1.1.6.cmml">e</mi><mo id="alg4.l5.m1.1.1.1.1.1d" xref="alg4.l5.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg4.l5.m1.1.1.1.1.7" xref="alg4.l5.m1.1.1.1.1.7.cmml">s</mi></mrow><mo id="alg4.l5.m1.3.3.3.4" xref="alg4.l5.m1.3.3.4.cmml">,</mo><mrow id="alg4.l5.m1.2.2.2.2" xref="alg4.l5.m1.2.2.2.2.cmml"><mi id="alg4.l5.m1.2.2.2.2.2" xref="alg4.l5.m1.2.2.2.2.2.cmml">i</mi><mo id="alg4.l5.m1.2.2.2.2.1" xref="alg4.l5.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l5.m1.2.2.2.2.3" xref="alg4.l5.m1.2.2.2.2.3.cmml">n</mi><mo id="alg4.l5.m1.2.2.2.2.1a" xref="alg4.l5.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l5.m1.2.2.2.2.4" xref="alg4.l5.m1.2.2.2.2.4.cmml">p</mi><mo id="alg4.l5.m1.2.2.2.2.1b" xref="alg4.l5.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l5.m1.2.2.2.2.5" xref="alg4.l5.m1.2.2.2.2.5.cmml">u</mi><mo id="alg4.l5.m1.2.2.2.2.1c" xref="alg4.l5.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l5.m1.2.2.2.2.6" xref="alg4.l5.m1.2.2.2.2.6.cmml">t</mi><mo id="alg4.l5.m1.2.2.2.2.1d" xref="alg4.l5.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l5.m1.2.2.2.2.7" mathvariant="normal" xref="alg4.l5.m1.2.2.2.2.7.cmml">_</mi><mo id="alg4.l5.m1.2.2.2.2.1e" xref="alg4.l5.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l5.m1.2.2.2.2.8" xref="alg4.l5.m1.2.2.2.2.8.cmml">i</mi><mo id="alg4.l5.m1.2.2.2.2.1f" xref="alg4.l5.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l5.m1.2.2.2.2.9" xref="alg4.l5.m1.2.2.2.2.9.cmml">d</mi><mo id="alg4.l5.m1.2.2.2.2.1g" xref="alg4.l5.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg4.l5.m1.2.2.2.2.10" xref="alg4.l5.m1.2.2.2.2.10.cmml">s</mi></mrow><mo id="alg4.l5.m1.3.3.3.5" xref="alg4.l5.m1.3.3.4.cmml">,</mo><mrow id="alg4.l5.m1.3.3.3.3" xref="alg4.l5.m1.3.3.3.3.cmml"><mi id="alg4.l5.m1.3.3.3.3.2" xref="alg4.l5.m1.3.3.3.3.2.cmml">a</mi><mo id="alg4.l5.m1.3.3.3.3.1" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.3" xref="alg4.l5.m1.3.3.3.3.3.cmml">t</mi><mo id="alg4.l5.m1.3.3.3.3.1a" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.4" xref="alg4.l5.m1.3.3.3.3.4.cmml">t</mi><mo id="alg4.l5.m1.3.3.3.3.1b" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.5" xref="alg4.l5.m1.3.3.3.3.5.cmml">e</mi><mo id="alg4.l5.m1.3.3.3.3.1c" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.6" xref="alg4.l5.m1.3.3.3.3.6.cmml">n</mi><mo id="alg4.l5.m1.3.3.3.3.1d" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.7" xref="alg4.l5.m1.3.3.3.3.7.cmml">t</mi><mo id="alg4.l5.m1.3.3.3.3.1e" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.8" xref="alg4.l5.m1.3.3.3.3.8.cmml">i</mi><mo id="alg4.l5.m1.3.3.3.3.1f" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.9" xref="alg4.l5.m1.3.3.3.3.9.cmml">o</mi><mo id="alg4.l5.m1.3.3.3.3.1g" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.10" xref="alg4.l5.m1.3.3.3.3.10.cmml">n</mi><mo id="alg4.l5.m1.3.3.3.3.1h" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.11" mathvariant="normal" xref="alg4.l5.m1.3.3.3.3.11.cmml">_</mi><mo id="alg4.l5.m1.3.3.3.3.1i" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.12" xref="alg4.l5.m1.3.3.3.3.12.cmml">m</mi><mo id="alg4.l5.m1.3.3.3.3.1j" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.13" xref="alg4.l5.m1.3.3.3.3.13.cmml">a</mi><mo id="alg4.l5.m1.3.3.3.3.1k" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.14" xref="alg4.l5.m1.3.3.3.3.14.cmml">s</mi><mo id="alg4.l5.m1.3.3.3.3.1l" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.15" xref="alg4.l5.m1.3.3.3.3.15.cmml">k</mi><mo id="alg4.l5.m1.3.3.3.3.1m" xref="alg4.l5.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg4.l5.m1.3.3.3.3.16" xref="alg4.l5.m1.3.3.3.3.16.cmml">s</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l5.m1.3b"><list id="alg4.l5.m1.3.3.4.cmml" xref="alg4.l5.m1.3.3.3"><apply id="alg4.l5.m1.1.1.1.1.cmml" xref="alg4.l5.m1.1.1.1.1"><times id="alg4.l5.m1.1.1.1.1.1.cmml" xref="alg4.l5.m1.1.1.1.1.1"></times><ci id="alg4.l5.m1.1.1.1.1.2.cmml" xref="alg4.l5.m1.1.1.1.1.2">𝑖</ci><ci id="alg4.l5.m1.1.1.1.1.3.cmml" xref="alg4.l5.m1.1.1.1.1.3">𝑚</ci><ci id="alg4.l5.m1.1.1.1.1.4.cmml" xref="alg4.l5.m1.1.1.1.1.4">𝑎</ci><ci id="alg4.l5.m1.1.1.1.1.5.cmml" xref="alg4.l5.m1.1.1.1.1.5">𝑔</ci><ci id="alg4.l5.m1.1.1.1.1.6.cmml" xref="alg4.l5.m1.1.1.1.1.6">𝑒</ci><ci id="alg4.l5.m1.1.1.1.1.7.cmml" xref="alg4.l5.m1.1.1.1.1.7">𝑠</ci></apply><apply id="alg4.l5.m1.2.2.2.2.cmml" xref="alg4.l5.m1.2.2.2.2"><times id="alg4.l5.m1.2.2.2.2.1.cmml" xref="alg4.l5.m1.2.2.2.2.1"></times><ci id="alg4.l5.m1.2.2.2.2.2.cmml" xref="alg4.l5.m1.2.2.2.2.2">𝑖</ci><ci id="alg4.l5.m1.2.2.2.2.3.cmml" xref="alg4.l5.m1.2.2.2.2.3">𝑛</ci><ci id="alg4.l5.m1.2.2.2.2.4.cmml" xref="alg4.l5.m1.2.2.2.2.4">𝑝</ci><ci id="alg4.l5.m1.2.2.2.2.5.cmml" xref="alg4.l5.m1.2.2.2.2.5">𝑢</ci><ci id="alg4.l5.m1.2.2.2.2.6.cmml" xref="alg4.l5.m1.2.2.2.2.6">𝑡</ci><ci id="alg4.l5.m1.2.2.2.2.7.cmml" xref="alg4.l5.m1.2.2.2.2.7">_</ci><ci id="alg4.l5.m1.2.2.2.2.8.cmml" xref="alg4.l5.m1.2.2.2.2.8">𝑖</ci><ci id="alg4.l5.m1.2.2.2.2.9.cmml" xref="alg4.l5.m1.2.2.2.2.9">𝑑</ci><ci id="alg4.l5.m1.2.2.2.2.10.cmml" xref="alg4.l5.m1.2.2.2.2.10">𝑠</ci></apply><apply id="alg4.l5.m1.3.3.3.3.cmml" xref="alg4.l5.m1.3.3.3.3"><times id="alg4.l5.m1.3.3.3.3.1.cmml" xref="alg4.l5.m1.3.3.3.3.1"></times><ci id="alg4.l5.m1.3.3.3.3.2.cmml" xref="alg4.l5.m1.3.3.3.3.2">𝑎</ci><ci id="alg4.l5.m1.3.3.3.3.3.cmml" xref="alg4.l5.m1.3.3.3.3.3">𝑡</ci><ci id="alg4.l5.m1.3.3.3.3.4.cmml" xref="alg4.l5.m1.3.3.3.3.4">𝑡</ci><ci id="alg4.l5.m1.3.3.3.3.5.cmml" xref="alg4.l5.m1.3.3.3.3.5">𝑒</ci><ci id="alg4.l5.m1.3.3.3.3.6.cmml" xref="alg4.l5.m1.3.3.3.3.6">𝑛</ci><ci id="alg4.l5.m1.3.3.3.3.7.cmml" xref="alg4.l5.m1.3.3.3.3.7">𝑡</ci><ci id="alg4.l5.m1.3.3.3.3.8.cmml" xref="alg4.l5.m1.3.3.3.3.8">𝑖</ci><ci id="alg4.l5.m1.3.3.3.3.9.cmml" xref="alg4.l5.m1.3.3.3.3.9">𝑜</ci><ci id="alg4.l5.m1.3.3.3.3.10.cmml" xref="alg4.l5.m1.3.3.3.3.10">𝑛</ci><ci id="alg4.l5.m1.3.3.3.3.11.cmml" xref="alg4.l5.m1.3.3.3.3.11">_</ci><ci id="alg4.l5.m1.3.3.3.3.12.cmml" xref="alg4.l5.m1.3.3.3.3.12">𝑚</ci><ci id="alg4.l5.m1.3.3.3.3.13.cmml" xref="alg4.l5.m1.3.3.3.3.13">𝑎</ci><ci id="alg4.l5.m1.3.3.3.3.14.cmml" xref="alg4.l5.m1.3.3.3.3.14">𝑠</ci><ci id="alg4.l5.m1.3.3.3.3.15.cmml" xref="alg4.l5.m1.3.3.3.3.15">𝑘</ci><ci id="alg4.l5.m1.3.3.3.3.16.cmml" xref="alg4.l5.m1.3.3.3.3.16">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.m1.3c">images,input\_ids,attention\_masks</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.m1.3d">italic_i italic_m italic_a italic_g italic_e italic_s , italic_i italic_n italic_p italic_u italic_t _ italic_i italic_d italic_s , italic_a italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n _ italic_m italic_a italic_s italic_k italic_s</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>         Calculate contrastive loss

</div>
<div class="ltx_listingline" id="alg4.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>         Backpropagate loss and update model parameters

</div>
<div class="ltx_listingline" id="alg4.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>         Update learning rate with scheduler

</div>
<div class="ltx_listingline" id="alg4.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <span class="ltx_text ltx_font_bold" id="alg4.l9.1">end</span> <span class="ltx_text ltx_font_bold" id="alg4.l9.2">for</span>
</div>
<div class="ltx_listingline" id="alg4.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span><span class="ltx_text ltx_font_bold" id="alg4.l10.1">end</span> <span class="ltx_text ltx_font_bold" id="alg4.l10.2">while</span>
</div>
</div>
</figure>
<figure class="ltx_table" id="A1.T4">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.T4.1.1.1.1.1">Image ID</span></th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T4.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.1.1.2.1">
<span class="ltx_p" id="A1.T4.1.1.1.2.1.1"><span class="ltx_text ltx_font_bold" id="A1.T4.1.1.1.2.1.1.1">English Caption</span></span>
</span>
</th>
<th class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A1.T4.1.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.1.1.3.1">
<span class="ltx_p" id="A1.T4.1.1.1.3.1.1"><span class="ltx_text ltx_font_bold" id="A1.T4.1.1.1.3.1.1.1">Azerbaijani Translation</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.1.2.1.1">203564</th>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T4.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.2.1.2.1">
<span class="ltx_p" id="A1.T4.1.2.1.2.1.1">A bicycle replica with a clock as the front wheel.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T4.1.2.1.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.2.1.3.1">
<span class="ltx_p" id="A1.T4.1.2.1.3.1.1">Ön teker kimi saat olan velosiped nüsxesi.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.1.3.2.1">322141</th>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T4.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.3.2.2.1">
<span class="ltx_p" id="A1.T4.1.3.2.2.1.1">A room with blue walls and a white sink and door.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T4.1.3.2.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.3.2.3.1">
<span class="ltx_p" id="A1.T4.1.3.2.3.1.1">Mavi divarları, ağ lavabo ve qapısı olan otaq.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.1.4.3.1">16977</th>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T4.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.4.3.2.1">
<span class="ltx_p" id="A1.T4.1.4.3.2.1.1">A car that seems to be parked illegally behind a legally parked car.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T4.1.4.3.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.4.3.3.1">
<span class="ltx_p" id="A1.T4.1.4.3.3.1.1">Qanuni park edilmiş avtomobilin arxasında qeyri-qanuni dayanmış kimi görünen avtomobil.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.1.5.4.1">106140</th>
<td class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.5.4.2.1">
<span class="ltx_p" id="A1.T4.1.5.4.2.1.1">A large passenger airplane flying through the air.</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.1.5.4.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T4.1.5.4.3.1">
<span class="ltx_p" id="A1.T4.1.5.4.3.1.1">Havada uçan böyük bir sernişin teyyaresi.</span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Sample from the training dataset.</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="240" id="A1.F9.g1" src="extracted/5812574/Figure/sample_4_lq.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span><span class="ltx_text ltx_font_bold" id="A1.F9.2.1">Model Inference Example 3.</span> The query posed is "School children are playing football".</figcaption>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Aug 25 17:53:31 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
