<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author</title>
<!--Generated on Wed Sep 18 04:23:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Next basket recommendation,  price-aware,  basket-augmentation,  heterogeneous hypergraph
" lang="en" name="keywords"/>
<base href="/html/2409.11695v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S1" title="In Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S2" title="In Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Methodology</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S2.SS1" title="In II Methodology ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-A</span> </span><span class="ltx_text ltx_font_italic">Problem Formulation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S2.SS2" title="In II Methodology ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-B</span> </span><span class="ltx_text ltx_font_italic">Heterogeneous Hypergraph Construction Module</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S2.SS3" title="In II Methodology ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span> </span><span class="ltx_text ltx_font_italic">Unified Global Hybrid Encoder</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S2.SS4" title="In II Methodology ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-D</span> </span><span class="ltx_text ltx_font_italic">Basket-guided Dynamic Augmentation Networks</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S2.SS5" title="In II Methodology ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-E</span> </span><span class="ltx_text ltx_font_italic">User Behavior Modeling</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S2.SS6" title="In II Methodology ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-F</span> </span><span class="ltx_text ltx_font_italic">Training Setup</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S3" title="In Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S3.SS1" title="In III Experiments ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Experiments Setup</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S3.SS2" title="In III Experiments ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Performance Analysis</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S3.SS3" title="In III Experiments ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Ablation Study</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S4" title="In Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Conclusions and Future Work</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation
<span class="ltx_note ltx_role_thanks" id="id1.id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span><sup class="ltx_sup" id="id1.id1.1">†</sup> These authors contributed equally to this work.
<sup class="ltx_sup" id="id1.id1.2">*</sup> Corresponding Author
</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuening Zhou<sup class="ltx_sup" id="id2.1.id1">†</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id3.2.id1">Department of Marketing</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="id4.3.id2">The Chinese University of Hong Kong
<br class="ltx_break"/></span>Hong Kong, China 
<br class="ltx_break"/>yueningzhou@cuhk.edu.hk
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yulin Wang<sup class="ltx_sup" id="id5.1.id1">†</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id6.2.id1">School of Computer Science and Technology</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="id7.3.id2">Dalian University of Technology
<br class="ltx_break"/></span>Dalian, China 
<br class="ltx_break"/>15683911223@163.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qian Cui
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id8.1.id1">The Data Intelligence Team</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="id9.2.id2">Maoyan
<br class="ltx_break"/></span>Beijing, China 
<br class="ltx_break"/>brown3qqq@foxmail.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xinyu Guan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id10.1.id1">The Security Platform Department</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="id11.2.id2">Tencent
<br class="ltx_break"/></span>Shenzhen, China 
<br class="ltx_break"/>xinyu_guan1998@outlook.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Francisco Cisternas<sup class="ltx_sup" id="id12.1.id1">*</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id13.2.id1">Department of Marketing</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="id14.3.id2">The Chinese University of Hong Kong
<br class="ltx_break"/></span>Hong Kong, China 
<br class="ltx_break"/>fcisternas@cuhk.edu.hk
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id15.id1">Next Basket Recommendation (NBR) is a new type of recommender system that predicts combinations of items users are likely to purchase together. Existing NBR models often overlook a crucial factor, which is price, and do not fully capture item-basket-user interactions. To address these limitations, we propose a novel method called Basket-augmented Dynamic Heterogeneous Hypergraph (BDHH). BDHH utilizes a heterogeneous multi-relational graph to capture the intricate relationships among item features, with price as a critical factor. Moreover, our approach includes a basket-guided dynamic augmentation network that could dynamically enhances item-basket-user interactions. Experiments on real-world datasets demonstrate that BDHH significantly improves recommendation accuracy, providing a more comprehensive understanding of user behavior.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Next basket recommendation, price-aware, basket-augmentation, heterogeneous hypergraph

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommender systems process vast data to provide personalized recommendations, enhancing user experience by offering tailored suggestions. While traditional systems mainly recommend individual items <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib2" title="">2</a>]</cite>, real-world shopping often involves purchasing multiple items in one transaction. This makes recommending item combinations, known as Next Basket Recommendation (NBR) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib3" title="">3</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">A key difficulty in recommender systems is capturing the relationship between historical transactions and future recommendations. Existing NBR models can be classified into two main categories: item-level connections and basket-level connections. Item-level models focus on the relationships among items within a basket, incorporating purchase patterns such as co-purchases <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib5" title="">5</a>]</cite> and repeat purchases <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib8" title="">8</a>]</cite>. Basket-level models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib12" title="">12</a>]</cite>, often based on recurrent neural networks (RNNs) and attention mechanisms, capture users’ sequential purchasing behavior across different transactions. Despite significant advancements, most of these models have not fully developed item-basket-user interactions and overlook a critical factor (i.e., price) in consumer decision, focusing solely on product choice.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In real-world recommendation scenarios, a user’s purchasing behavior is driven by their multi-aspect interests, with both product preferences and price sensitivity playing crucial roles. Price influences not only the likelihood of a purchase <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib13" title="">13</a>]</cite> but also reflect individual consumption budget. Incorporating price into recommender systems is challenging due to its complexity, which varies across consumers and product categories <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib14" title="">14</a>]</cite>. While some early studies have acknowledged its importance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib18" title="">18</a>]</cite>, none have specifically addressed NBR, making the first gap. Moreover, NBR considers items in a basket as interdependent, where item combinations better capture a user’s overall preferences and sequences of baskets reflect evolving tastes over time. So it is desirable to identify potential products from semantically similar users by building relationships among items, baskets and users, while considering multi-aspects interest factors. Specifically, multiple items within a same basket reflect the user’s broader preferences, including price sensitivity and product choices. Then the presence of the same item in different users’ baskets indicates shared preferences, suggesting that items preferred by one user could be recommended to others with similar tastes, as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S1.F1" title="Figure 1 ‣ I Introduction ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_tag">1</span></a>. This process highlights the need for models to consider these relationships comprehensively while most existing works focus solely on item-item or basket-basket interactions, which is the second gap.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="263" id="S1.F1.g1" src="extracted/5862209/BDHH_illustration.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example of BDHH illustration. </figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we propose a novel method named <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">B</span>asket-augmented <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">D</span>ynamic <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">H</span>eterogeneous <span class="ltx_text ltx_font_bold" id="S1.p4.1.4">H</span>ypergraph (BDHH) for NBR. To address the first research gap mentioned above in current research, we employ a heterogeneous multi-relational graph with different types of nodes, including item ID, price and category, and then explore the interactions between these nodes in a coarse-to-fine manner. After that, we design a unified global hybrid encoder to extract cross-associations between multiple features from the global sequence. To address the second gap, we develop a basket-guided dynamic augmentation network to establish an item-basket-item learning mechanism enhancing the relationships among items, baskets and users. This method incorporate more types of items features and achieve personalized item representation enhancement without losing global feature information. Finally, based on the semantics-enhanced node embeddings, we model user behavior through Item-ID and Item-Price hyperedges.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In summary, our contributions are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We build a model considering various user interests (i.e., price sensitivity and product preference) and emphasize identifying similar semantic neighbours to connect items, baskets and users. To the best of our knowledge, we are the first to incorporate price into the NBR problem.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a novel method called Basket-augmented Dynamic Heterogeneous Hypergraph (BDHH), which enhances user behavior representation for better performance.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Extensive experiments on two real-word datasets demonstrate the effectiveness of our proposed approach.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Methodology</span>
</h2>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="167" id="S2.F2.g1" src="extracted/5862209/BDHH_v2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The framework of the proposed BDHH model.</figcaption>
</figure>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we first outline the problem formulation for the NBR and then introduce our proposed model BDHH. As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S2.F2" title="Figure 2 ‣ II Methodology ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_tag">2</span></a>, we begin by constructing a heterogeneous hypergraph network to capture item features <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib20" title="">20</a>]</cite>. To effectively improve node representations, we design a basket-augmented mechanism, that could dynamically capture the relationships between baskets and items. Finally, we make predictions based on user’s behaviors. We then describe the proposed BDHH model in detail.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS1.4.1.1">II-A</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS1.5.2">Problem Formulation</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.7">In the NBR task, each user’s purchase history is represented as a sequence of baskets <math alttext="B=\{B_{1}^{u},B_{2}^{u},...,B_{n}^{u}\}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.4"><semantics id="S2.SS1.p1.1.m1.4a"><mrow id="S2.SS1.p1.1.m1.4.4" xref="S2.SS1.p1.1.m1.4.4.cmml"><mi id="S2.SS1.p1.1.m1.4.4.5" xref="S2.SS1.p1.1.m1.4.4.5.cmml">B</mi><mo id="S2.SS1.p1.1.m1.4.4.4" xref="S2.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.4.4.3.3" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml"><mo id="S2.SS1.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msubsup id="S2.SS1.p1.1.m1.2.2.1.1.1" xref="S2.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.2.2.1.1.1.2.2" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2.2.cmml">B</mi><mn id="S2.SS1.p1.1.m1.2.2.1.1.1.2.3" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2.3.cmml">1</mn><mi id="S2.SS1.p1.1.m1.2.2.1.1.1.3" xref="S2.SS1.p1.1.m1.2.2.1.1.1.3.cmml">u</mi></msubsup><mo id="S2.SS1.p1.1.m1.4.4.3.3.5" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S2.SS1.p1.1.m1.3.3.2.2.2" xref="S2.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS1.p1.1.m1.3.3.2.2.2.2.2" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2.2.cmml">B</mi><mn id="S2.SS1.p1.1.m1.3.3.2.2.2.2.3" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2.3.cmml">2</mn><mi id="S2.SS1.p1.1.m1.3.3.2.2.2.3" xref="S2.SS1.p1.1.m1.3.3.2.2.2.3.cmml">u</mi></msubsup><mo id="S2.SS1.p1.1.m1.4.4.3.3.6" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S2.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S2.SS1.p1.1.m1.4.4.3.3.7" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msubsup id="S2.SS1.p1.1.m1.4.4.3.3.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.2.2" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2.2.cmml">B</mi><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.2.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2.3.cmml">n</mi><mi id="S2.SS1.p1.1.m1.4.4.3.3.3.3" xref="S2.SS1.p1.1.m1.4.4.3.3.3.3.cmml">u</mi></msubsup><mo id="S2.SS1.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S2.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.4b"><apply id="S2.SS1.p1.1.m1.4.4.cmml" xref="S2.SS1.p1.1.m1.4.4"><eq id="S2.SS1.p1.1.m1.4.4.4.cmml" xref="S2.SS1.p1.1.m1.4.4.4"></eq><ci id="S2.SS1.p1.1.m1.4.4.5.cmml" xref="S2.SS1.p1.1.m1.4.4.5">𝐵</ci><set id="S2.SS1.p1.1.m1.4.4.3.4.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3"><apply id="S2.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2.2">𝐵</ci><cn id="S2.SS1.p1.1.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.2.2.1.1.1.2.3">1</cn></apply><ci id="S2.SS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.2.2.1.1.1.3">𝑢</ci></apply><apply id="S2.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S2.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2.2">𝐵</ci><cn id="S2.SS1.p1.1.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S2.SS1.p1.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS1.p1.1.m1.3.3.2.2.2.3">𝑢</ci></apply><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">…</ci><apply id="S2.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3">superscript</csymbol><apply id="S2.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.4.4.3.3.3.2.1.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.2.2.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2.2">𝐵</ci><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.2.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.2.3">𝑛</ci></apply><ci id="S2.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S2.SS1.p1.1.m1.4.4.3.3.3.3">𝑢</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.4c">B=\{B_{1}^{u},B_{2}^{u},...,B_{n}^{u}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.4d">italic_B = { italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , italic_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT , … , italic_B start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT }</annotation></semantics></math>, where <math alttext="B_{i}^{u}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><msubsup id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.2.2.cmml">B</mi><mi id="S2.SS1.p1.2.m2.1.1.2.3" xref="S2.SS1.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">superscript</csymbol><apply id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2.2">𝐵</ci><ci id="S2.SS1.p1.2.m2.1.1.2.3.cmml" xref="S2.SS1.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">B_{i}^{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_i</annotation></semantics></math>-th basket of user <math alttext="u\in U" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">u</mi><mo id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">∈</mo><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">U</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><in id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1"></in><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑢</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">u\in U</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_u ∈ italic_U</annotation></semantics></math>. Each basket typically contains a set of items <math alttext="x_{i}\in X" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mrow id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><msub id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2.2" xref="S2.SS1.p1.5.m5.1.1.2.2.cmml">x</mi><mi id="S2.SS1.p1.5.m5.1.1.2.3" xref="S2.SS1.p1.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS1.p1.5.m5.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.cmml">∈</mo><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><in id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1"></in><apply id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.2.1.cmml" xref="S2.SS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2.2">𝑥</ci><ci id="S2.SS1.p1.5.m5.1.1.2.3.cmml" xref="S2.SS1.p1.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">x_{i}\in X</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_X</annotation></semantics></math>, with each item <math alttext="x_{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">x</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝑥</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> characterized by attributes such as item ID, price and category. The goal of the NBR task is to predict a ranked list of items for each user at a given time, specifically for the next basket <math alttext="B_{n+1}^{u}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><msubsup id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2.2" xref="S2.SS1.p1.7.m7.1.1.2.2.cmml">B</mi><mrow id="S2.SS1.p1.7.m7.1.1.2.3" xref="S2.SS1.p1.7.m7.1.1.2.3.cmml"><mi id="S2.SS1.p1.7.m7.1.1.2.3.2" xref="S2.SS1.p1.7.m7.1.1.2.3.2.cmml">n</mi><mo id="S2.SS1.p1.7.m7.1.1.2.3.1" xref="S2.SS1.p1.7.m7.1.1.2.3.1.cmml">+</mo><mn id="S2.SS1.p1.7.m7.1.1.2.3.3" xref="S2.SS1.p1.7.m7.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">superscript</csymbol><apply id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.2.1.cmml" xref="S2.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2.2">𝐵</ci><apply id="S2.SS1.p1.7.m7.1.1.2.3.cmml" xref="S2.SS1.p1.7.m7.1.1.2.3"><plus id="S2.SS1.p1.7.m7.1.1.2.3.1.cmml" xref="S2.SS1.p1.7.m7.1.1.2.3.1"></plus><ci id="S2.SS1.p1.7.m7.1.1.2.3.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2.3.2">𝑛</ci><cn id="S2.SS1.p1.7.m7.1.1.2.3.3.cmml" type="integer" xref="S2.SS1.p1.7.m7.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">B_{n+1}^{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">italic_B start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT</annotation></semantics></math>, based on their historical transaction data.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS2.4.1.1">II-B</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS2.5.2">Heterogeneous Hypergraph Construction Module</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.11">In this paper, we define a heterogeneous hypergraph as <math alttext="\mathcal{G}=\{\mathcal{V},\mathcal{E},\mathcal{T}_{v},\mathcal{T}_{e}\}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.4"><semantics id="S2.SS2.p1.1.m1.4a"><mrow id="S2.SS2.p1.1.m1.4.4" xref="S2.SS2.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.4.4.4" xref="S2.SS2.p1.1.m1.4.4.4.cmml">𝒢</mi><mo id="S2.SS2.p1.1.m1.4.4.3" xref="S2.SS2.p1.1.m1.4.4.3.cmml">=</mo><mrow id="S2.SS2.p1.1.m1.4.4.2.2" xref="S2.SS2.p1.1.m1.4.4.2.3.cmml"><mo id="S2.SS2.p1.1.m1.4.4.2.2.3" stretchy="false" xref="S2.SS2.p1.1.m1.4.4.2.3.cmml">{</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">𝒱</mi><mo id="S2.SS2.p1.1.m1.4.4.2.2.4" xref="S2.SS2.p1.1.m1.4.4.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.2.2" xref="S2.SS2.p1.1.m1.2.2.cmml">ℰ</mi><mo id="S2.SS2.p1.1.m1.4.4.2.2.5" xref="S2.SS2.p1.1.m1.4.4.2.3.cmml">,</mo><msub id="S2.SS2.p1.1.m1.3.3.1.1.1" xref="S2.SS2.p1.1.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.3.3.1.1.1.2" xref="S2.SS2.p1.1.m1.3.3.1.1.1.2.cmml">𝒯</mi><mi id="S2.SS2.p1.1.m1.3.3.1.1.1.3" xref="S2.SS2.p1.1.m1.3.3.1.1.1.3.cmml">v</mi></msub><mo id="S2.SS2.p1.1.m1.4.4.2.2.6" xref="S2.SS2.p1.1.m1.4.4.2.3.cmml">,</mo><msub id="S2.SS2.p1.1.m1.4.4.2.2.2" xref="S2.SS2.p1.1.m1.4.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.1.m1.4.4.2.2.2.2" xref="S2.SS2.p1.1.m1.4.4.2.2.2.2.cmml">𝒯</mi><mi id="S2.SS2.p1.1.m1.4.4.2.2.2.3" xref="S2.SS2.p1.1.m1.4.4.2.2.2.3.cmml">e</mi></msub><mo id="S2.SS2.p1.1.m1.4.4.2.2.7" stretchy="false" xref="S2.SS2.p1.1.m1.4.4.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.4b"><apply id="S2.SS2.p1.1.m1.4.4.cmml" xref="S2.SS2.p1.1.m1.4.4"><eq id="S2.SS2.p1.1.m1.4.4.3.cmml" xref="S2.SS2.p1.1.m1.4.4.3"></eq><ci id="S2.SS2.p1.1.m1.4.4.4.cmml" xref="S2.SS2.p1.1.m1.4.4.4">𝒢</ci><set id="S2.SS2.p1.1.m1.4.4.2.3.cmml" xref="S2.SS2.p1.1.m1.4.4.2.2"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝒱</ci><ci id="S2.SS2.p1.1.m1.2.2.cmml" xref="S2.SS2.p1.1.m1.2.2">ℰ</ci><apply id="S2.SS2.p1.1.m1.3.3.1.1.1.cmml" xref="S2.SS2.p1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.3.3.1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.3.3.1.1.1.2">𝒯</ci><ci id="S2.SS2.p1.1.m1.3.3.1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.3.3.1.1.1.3">𝑣</ci></apply><apply id="S2.SS2.p1.1.m1.4.4.2.2.2.cmml" xref="S2.SS2.p1.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.4.4.2.2.2.1.cmml" xref="S2.SS2.p1.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.1.m1.4.4.2.2.2.2.cmml" xref="S2.SS2.p1.1.m1.4.4.2.2.2.2">𝒯</ci><ci id="S2.SS2.p1.1.m1.4.4.2.2.2.3.cmml" xref="S2.SS2.p1.1.m1.4.4.2.2.2.3">𝑒</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.4c">\mathcal{G}=\{\mathcal{V},\mathcal{E},\mathcal{T}_{v},\mathcal{T}_{e}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.4d">caligraphic_G = { caligraphic_V , caligraphic_E , caligraphic_T start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , caligraphic_T start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT }</annotation></semantics></math>. Here <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><ci id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">caligraphic_V</annotation></semantics></math> represents the set of all vertex features, including item IDs <math alttext="D=\{d_{1},\ldots,d_{m_{d}}\}" class="ltx_Math" display="inline" id="S2.SS2.p1.3.m3.3"><semantics id="S2.SS2.p1.3.m3.3a"><mrow id="S2.SS2.p1.3.m3.3.3" xref="S2.SS2.p1.3.m3.3.3.cmml"><mi id="S2.SS2.p1.3.m3.3.3.4" xref="S2.SS2.p1.3.m3.3.3.4.cmml">D</mi><mo id="S2.SS2.p1.3.m3.3.3.3" xref="S2.SS2.p1.3.m3.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.3.m3.3.3.2.2" xref="S2.SS2.p1.3.m3.3.3.2.3.cmml"><mo id="S2.SS2.p1.3.m3.3.3.2.2.3" stretchy="false" xref="S2.SS2.p1.3.m3.3.3.2.3.cmml">{</mo><msub id="S2.SS2.p1.3.m3.2.2.1.1.1" xref="S2.SS2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.3.m3.2.2.1.1.1.2" xref="S2.SS2.p1.3.m3.2.2.1.1.1.2.cmml">d</mi><mn id="S2.SS2.p1.3.m3.2.2.1.1.1.3" xref="S2.SS2.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.3.m3.3.3.2.2.4" xref="S2.SS2.p1.3.m3.3.3.2.3.cmml">,</mo><mi id="S2.SS2.p1.3.m3.1.1" mathvariant="normal" xref="S2.SS2.p1.3.m3.1.1.cmml">…</mi><mo id="S2.SS2.p1.3.m3.3.3.2.2.5" xref="S2.SS2.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.3.m3.3.3.2.2.2" xref="S2.SS2.p1.3.m3.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.3.m3.3.3.2.2.2.2" xref="S2.SS2.p1.3.m3.3.3.2.2.2.2.cmml">d</mi><msub id="S2.SS2.p1.3.m3.3.3.2.2.2.3" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3.cmml"><mi id="S2.SS2.p1.3.m3.3.3.2.2.2.3.2" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3.2.cmml">m</mi><mi id="S2.SS2.p1.3.m3.3.3.2.2.2.3.3" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3.3.cmml">d</mi></msub></msub><mo id="S2.SS2.p1.3.m3.3.3.2.2.6" stretchy="false" xref="S2.SS2.p1.3.m3.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.3b"><apply id="S2.SS2.p1.3.m3.3.3.cmml" xref="S2.SS2.p1.3.m3.3.3"><eq id="S2.SS2.p1.3.m3.3.3.3.cmml" xref="S2.SS2.p1.3.m3.3.3.3"></eq><ci id="S2.SS2.p1.3.m3.3.3.4.cmml" xref="S2.SS2.p1.3.m3.3.3.4">𝐷</ci><set id="S2.SS2.p1.3.m3.3.3.2.3.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2"><apply id="S2.SS2.p1.3.m3.2.2.1.1.1.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.3.m3.2.2.1.1.1.2">𝑑</ci><cn id="S2.SS2.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">…</ci><apply id="S2.SS2.p1.3.m3.3.3.2.2.2.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2.2">𝑑</ci><apply id="S2.SS2.p1.3.m3.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p1.3.m3.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3.2">𝑚</ci><ci id="S2.SS2.p1.3.m3.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.3.m3.3.3.2.2.2.3.3">𝑑</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.3c">D=\{d_{1},\ldots,d_{m_{d}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.3.m3.3d">italic_D = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_d start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math>, prices <math alttext="P=\{p_{1},\dots,p_{m_{p}}\}" class="ltx_Math" display="inline" id="S2.SS2.p1.4.m4.3"><semantics id="S2.SS2.p1.4.m4.3a"><mrow id="S2.SS2.p1.4.m4.3.3" xref="S2.SS2.p1.4.m4.3.3.cmml"><mi id="S2.SS2.p1.4.m4.3.3.4" xref="S2.SS2.p1.4.m4.3.3.4.cmml">P</mi><mo id="S2.SS2.p1.4.m4.3.3.3" xref="S2.SS2.p1.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.4.m4.3.3.2.2" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml"><mo id="S2.SS2.p1.4.m4.3.3.2.2.3" stretchy="false" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">{</mo><msub id="S2.SS2.p1.4.m4.2.2.1.1.1" xref="S2.SS2.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.4.m4.2.2.1.1.1.2" xref="S2.SS2.p1.4.m4.2.2.1.1.1.2.cmml">p</mi><mn id="S2.SS2.p1.4.m4.2.2.1.1.1.3" xref="S2.SS2.p1.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.4.m4.3.3.2.2.4" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">,</mo><mi id="S2.SS2.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS2.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS2.p1.4.m4.3.3.2.2.5" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.4.m4.3.3.2.2.2" xref="S2.SS2.p1.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.4.m4.3.3.2.2.2.2" xref="S2.SS2.p1.4.m4.3.3.2.2.2.2.cmml">p</mi><msub id="S2.SS2.p1.4.m4.3.3.2.2.2.3" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3.cmml"><mi id="S2.SS2.p1.4.m4.3.3.2.2.2.3.2" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3.2.cmml">m</mi><mi id="S2.SS2.p1.4.m4.3.3.2.2.2.3.3" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3.3.cmml">p</mi></msub></msub><mo id="S2.SS2.p1.4.m4.3.3.2.2.6" stretchy="false" xref="S2.SS2.p1.4.m4.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.3b"><apply id="S2.SS2.p1.4.m4.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3"><eq id="S2.SS2.p1.4.m4.3.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3.3"></eq><ci id="S2.SS2.p1.4.m4.3.3.4.cmml" xref="S2.SS2.p1.4.m4.3.3.4">𝑃</ci><set id="S2.SS2.p1.4.m4.3.3.2.3.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2"><apply id="S2.SS2.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.4.m4.2.2.1.1.1.2">𝑝</ci><cn id="S2.SS2.p1.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.4.m4.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">…</ci><apply id="S2.SS2.p1.4.m4.3.3.2.2.2.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.2">𝑝</ci><apply id="S2.SS2.p1.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p1.4.m4.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3.2">𝑚</ci><ci id="S2.SS2.p1.4.m4.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.4.m4.3.3.2.2.2.3.3">𝑝</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.3c">P=\{p_{1},\dots,p_{m_{p}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.4.m4.3d">italic_P = { italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_p start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math> and categories <math alttext="C=\{c_{1},\dots,c_{m_{c}}\}" class="ltx_Math" display="inline" id="S2.SS2.p1.5.m5.3"><semantics id="S2.SS2.p1.5.m5.3a"><mrow id="S2.SS2.p1.5.m5.3.3" xref="S2.SS2.p1.5.m5.3.3.cmml"><mi id="S2.SS2.p1.5.m5.3.3.4" xref="S2.SS2.p1.5.m5.3.3.4.cmml">C</mi><mo id="S2.SS2.p1.5.m5.3.3.3" xref="S2.SS2.p1.5.m5.3.3.3.cmml">=</mo><mrow id="S2.SS2.p1.5.m5.3.3.2.2" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml"><mo id="S2.SS2.p1.5.m5.3.3.2.2.3" stretchy="false" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml">{</mo><msub id="S2.SS2.p1.5.m5.2.2.1.1.1" xref="S2.SS2.p1.5.m5.2.2.1.1.1.cmml"><mi id="S2.SS2.p1.5.m5.2.2.1.1.1.2" xref="S2.SS2.p1.5.m5.2.2.1.1.1.2.cmml">c</mi><mn id="S2.SS2.p1.5.m5.2.2.1.1.1.3" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS2.p1.5.m5.3.3.2.2.4" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml">,</mo><mi id="S2.SS2.p1.5.m5.1.1" mathvariant="normal" xref="S2.SS2.p1.5.m5.1.1.cmml">…</mi><mo id="S2.SS2.p1.5.m5.3.3.2.2.5" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml">,</mo><msub id="S2.SS2.p1.5.m5.3.3.2.2.2" xref="S2.SS2.p1.5.m5.3.3.2.2.2.cmml"><mi id="S2.SS2.p1.5.m5.3.3.2.2.2.2" xref="S2.SS2.p1.5.m5.3.3.2.2.2.2.cmml">c</mi><msub id="S2.SS2.p1.5.m5.3.3.2.2.2.3" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.cmml"><mi id="S2.SS2.p1.5.m5.3.3.2.2.2.3.2" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.2.cmml">m</mi><mi id="S2.SS2.p1.5.m5.3.3.2.2.2.3.3" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.3.cmml">c</mi></msub></msub><mo id="S2.SS2.p1.5.m5.3.3.2.2.6" stretchy="false" xref="S2.SS2.p1.5.m5.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.3b"><apply id="S2.SS2.p1.5.m5.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3"><eq id="S2.SS2.p1.5.m5.3.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3.3"></eq><ci id="S2.SS2.p1.5.m5.3.3.4.cmml" xref="S2.SS2.p1.5.m5.3.3.4">𝐶</ci><set id="S2.SS2.p1.5.m5.3.3.2.3.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2"><apply id="S2.SS2.p1.5.m5.2.2.1.1.1.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.2.2.1.1.1.1.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.2.2.1.1.1.2.cmml" xref="S2.SS2.p1.5.m5.2.2.1.1.1.2">𝑐</ci><cn id="S2.SS2.p1.5.m5.2.2.1.1.1.3.cmml" type="integer" xref="S2.SS2.p1.5.m5.2.2.1.1.1.3">1</cn></apply><ci id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">…</ci><apply id="S2.SS2.p1.5.m5.3.3.2.2.2.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.3.3.2.2.2.1.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S2.SS2.p1.5.m5.3.3.2.2.2.2.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.2">𝑐</ci><apply id="S2.SS2.p1.5.m5.3.3.2.2.2.3.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.3.3.2.2.2.3.1.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p1.5.m5.3.3.2.2.2.3.2.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.2">𝑚</ci><ci id="S2.SS2.p1.5.m5.3.3.2.2.2.3.3.cmml" xref="S2.SS2.p1.5.m5.3.3.2.2.2.3.3">𝑐</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.3c">C=\{c_{1},\dots,c_{m_{c}}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.5.m5.3d">italic_C = { italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT }</annotation></semantics></math>, so <math alttext="\mathcal{V}=D\cup P\cup C" class="ltx_Math" display="inline" id="S2.SS2.p1.6.m6.1"><semantics id="S2.SS2.p1.6.m6.1a"><mrow id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">𝒱</mi><mo id="S2.SS2.p1.6.m6.1.1.1" xref="S2.SS2.p1.6.m6.1.1.1.cmml">=</mo><mrow id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml"><mi id="S2.SS2.p1.6.m6.1.1.3.2" xref="S2.SS2.p1.6.m6.1.1.3.2.cmml">D</mi><mo id="S2.SS2.p1.6.m6.1.1.3.1" xref="S2.SS2.p1.6.m6.1.1.3.1.cmml">∪</mo><mi id="S2.SS2.p1.6.m6.1.1.3.3" xref="S2.SS2.p1.6.m6.1.1.3.3.cmml">P</mi><mo id="S2.SS2.p1.6.m6.1.1.3.1a" xref="S2.SS2.p1.6.m6.1.1.3.1.cmml">∪</mo><mi id="S2.SS2.p1.6.m6.1.1.3.4" xref="S2.SS2.p1.6.m6.1.1.3.4.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><eq id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1.1"></eq><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">𝒱</ci><apply id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3"><union id="S2.SS2.p1.6.m6.1.1.3.1.cmml" xref="S2.SS2.p1.6.m6.1.1.3.1"></union><ci id="S2.SS2.p1.6.m6.1.1.3.2.cmml" xref="S2.SS2.p1.6.m6.1.1.3.2">𝐷</ci><ci id="S2.SS2.p1.6.m6.1.1.3.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3.3">𝑃</ci><ci id="S2.SS2.p1.6.m6.1.1.3.4.cmml" xref="S2.SS2.p1.6.m6.1.1.3.4">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">\mathcal{V}=D\cup P\cup C</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.6.m6.1d">caligraphic_V = italic_D ∪ italic_P ∪ italic_C</annotation></semantics></math>. Note that we use price discretization to obtain relative price instead of absolute price according to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib14" title="">14</a>]</cite>. The set of hyperedges <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S2.SS2.p1.7.m7.1"><semantics id="S2.SS2.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><ci id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.7.m7.1d">caligraphic_E</annotation></semantics></math>, includes connections where each hyperedge <math alttext="\epsilon\in\mathcal{E}" class="ltx_Math" display="inline" id="S2.SS2.p1.8.m8.1"><semantics id="S2.SS2.p1.8.m8.1a"><mrow id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml"><mi id="S2.SS2.p1.8.m8.1.1.2" xref="S2.SS2.p1.8.m8.1.1.2.cmml">ϵ</mi><mo id="S2.SS2.p1.8.m8.1.1.1" xref="S2.SS2.p1.8.m8.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.8.m8.1.1.3" xref="S2.SS2.p1.8.m8.1.1.3.cmml">ℰ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><apply id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1"><in id="S2.SS2.p1.8.m8.1.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1.1"></in><ci id="S2.SS2.p1.8.m8.1.1.2.cmml" xref="S2.SS2.p1.8.m8.1.1.2">italic-ϵ</ci><ci id="S2.SS2.p1.8.m8.1.1.3.cmml" xref="S2.SS2.p1.8.m8.1.1.3">ℰ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">\epsilon\in\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.8.m8.1d">italic_ϵ ∈ caligraphic_E</annotation></semantics></math> can link multiple nodes. The graph consists of three types of hyperedges: an item-feature hypergraph connecting all features of an item, an item-ID hypergraph linking all item IDs within a basket, and an item-price hypergraph connecting all item price within a basket. <math alttext="\mathcal{T}_{v}" class="ltx_Math" display="inline" id="S2.SS2.p1.9.m9.1"><semantics id="S2.SS2.p1.9.m9.1a"><msub id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.9.m9.1.1.2" xref="S2.SS2.p1.9.m9.1.1.2.cmml">𝒯</mi><mi id="S2.SS2.p1.9.m9.1.1.3" xref="S2.SS2.p1.9.m9.1.1.3.cmml">v</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><apply id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.9.m9.1.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS2.p1.9.m9.1.1.2.cmml" xref="S2.SS2.p1.9.m9.1.1.2">𝒯</ci><ci id="S2.SS2.p1.9.m9.1.1.3.cmml" xref="S2.SS2.p1.9.m9.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">\mathcal{T}_{v}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.9.m9.1d">caligraphic_T start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> is the set of node features and <math alttext="\mathcal{T}_{e}" class="ltx_Math" display="inline" id="S2.SS2.p1.10.m10.1"><semantics id="S2.SS2.p1.10.m10.1a"><msub id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.10.m10.1.1.2" xref="S2.SS2.p1.10.m10.1.1.2.cmml">𝒯</mi><mi id="S2.SS2.p1.10.m10.1.1.3" xref="S2.SS2.p1.10.m10.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><apply id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.10.m10.1.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.p1.10.m10.1.1.2.cmml" xref="S2.SS2.p1.10.m10.1.1.2">𝒯</ci><ci id="S2.SS2.p1.10.m10.1.1.3.cmml" xref="S2.SS2.p1.10.m10.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">\mathcal{T}_{e}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.10.m10.1d">caligraphic_T start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> is the set of hyperedge types. Since <math alttext="\lvert\mathcal{T}_{v}\rvert+\lvert\mathcal{T}_{e}\rvert&gt;2" class="ltx_Math" display="inline" id="S2.SS2.p1.11.m11.2"><semantics id="S2.SS2.p1.11.m11.2a"><mrow id="S2.SS2.p1.11.m11.2.2" xref="S2.SS2.p1.11.m11.2.2.cmml"><mrow id="S2.SS2.p1.11.m11.2.2.2" xref="S2.SS2.p1.11.m11.2.2.2.cmml"><mrow id="S2.SS2.p1.11.m11.1.1.1.1.1" xref="S2.SS2.p1.11.m11.1.1.1.1.2.cmml"><mo id="S2.SS2.p1.11.m11.1.1.1.1.1.2" stretchy="false" xref="S2.SS2.p1.11.m11.1.1.1.1.2.1.cmml">|</mo><msub id="S2.SS2.p1.11.m11.1.1.1.1.1.1" xref="S2.SS2.p1.11.m11.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.11.m11.1.1.1.1.1.1.2" xref="S2.SS2.p1.11.m11.1.1.1.1.1.1.2.cmml">𝒯</mi><mi id="S2.SS2.p1.11.m11.1.1.1.1.1.1.3" xref="S2.SS2.p1.11.m11.1.1.1.1.1.1.3.cmml">v</mi></msub><mo id="S2.SS2.p1.11.m11.1.1.1.1.1.3" stretchy="false" xref="S2.SS2.p1.11.m11.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.SS2.p1.11.m11.2.2.2.3" xref="S2.SS2.p1.11.m11.2.2.2.3.cmml">+</mo><mrow id="S2.SS2.p1.11.m11.2.2.2.2.1" xref="S2.SS2.p1.11.m11.2.2.2.2.2.cmml"><mo id="S2.SS2.p1.11.m11.2.2.2.2.1.2" stretchy="false" xref="S2.SS2.p1.11.m11.2.2.2.2.2.1.cmml">|</mo><msub id="S2.SS2.p1.11.m11.2.2.2.2.1.1" xref="S2.SS2.p1.11.m11.2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.11.m11.2.2.2.2.1.1.2" xref="S2.SS2.p1.11.m11.2.2.2.2.1.1.2.cmml">𝒯</mi><mi id="S2.SS2.p1.11.m11.2.2.2.2.1.1.3" xref="S2.SS2.p1.11.m11.2.2.2.2.1.1.3.cmml">e</mi></msub><mo id="S2.SS2.p1.11.m11.2.2.2.2.1.3" stretchy="false" xref="S2.SS2.p1.11.m11.2.2.2.2.2.1.cmml">|</mo></mrow></mrow><mo id="S2.SS2.p1.11.m11.2.2.3" xref="S2.SS2.p1.11.m11.2.2.3.cmml">&gt;</mo><mn id="S2.SS2.p1.11.m11.2.2.4" xref="S2.SS2.p1.11.m11.2.2.4.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m11.2b"><apply id="S2.SS2.p1.11.m11.2.2.cmml" xref="S2.SS2.p1.11.m11.2.2"><gt id="S2.SS2.p1.11.m11.2.2.3.cmml" xref="S2.SS2.p1.11.m11.2.2.3"></gt><apply id="S2.SS2.p1.11.m11.2.2.2.cmml" xref="S2.SS2.p1.11.m11.2.2.2"><plus id="S2.SS2.p1.11.m11.2.2.2.3.cmml" xref="S2.SS2.p1.11.m11.2.2.2.3"></plus><apply id="S2.SS2.p1.11.m11.1.1.1.1.2.cmml" xref="S2.SS2.p1.11.m11.1.1.1.1.1"><abs id="S2.SS2.p1.11.m11.1.1.1.1.2.1.cmml" xref="S2.SS2.p1.11.m11.1.1.1.1.1.2"></abs><apply id="S2.SS2.p1.11.m11.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.11.m11.1.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.11.m11.1.1.1.1.1.1.2">𝒯</ci><ci id="S2.SS2.p1.11.m11.1.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.11.m11.1.1.1.1.1.1.3">𝑣</ci></apply></apply><apply id="S2.SS2.p1.11.m11.2.2.2.2.2.cmml" xref="S2.SS2.p1.11.m11.2.2.2.2.1"><abs id="S2.SS2.p1.11.m11.2.2.2.2.2.1.cmml" xref="S2.SS2.p1.11.m11.2.2.2.2.1.2"></abs><apply id="S2.SS2.p1.11.m11.2.2.2.2.1.1.cmml" xref="S2.SS2.p1.11.m11.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.11.m11.2.2.2.2.1.1.1.cmml" xref="S2.SS2.p1.11.m11.2.2.2.2.1.1">subscript</csymbol><ci id="S2.SS2.p1.11.m11.2.2.2.2.1.1.2.cmml" xref="S2.SS2.p1.11.m11.2.2.2.2.1.1.2">𝒯</ci><ci id="S2.SS2.p1.11.m11.2.2.2.2.1.1.3.cmml" xref="S2.SS2.p1.11.m11.2.2.2.2.1.1.3">𝑒</ci></apply></apply></apply><cn id="S2.SS2.p1.11.m11.2.2.4.cmml" type="integer" xref="S2.SS2.p1.11.m11.2.2.4">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m11.2c">\lvert\mathcal{T}_{v}\rvert+\lvert\mathcal{T}_{e}\rvert&gt;2</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.11.m11.2d">| caligraphic_T start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT | + | caligraphic_T start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT | &gt; 2</annotation></semantics></math>, the hypergraph is considered heterogeneous.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS3.4.1.1">II-C</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS3.5.2">Unified Global Hybrid Encoder</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.2">For a specific node, different neighbouring nodes may have different impacts on it. To integrate neighbouring homogeneous nodes and leverage heterogeneous information between different types of nodes, we introduce a unified global hybrid node embedding update method. Given a specific node <math alttext="z^{t}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><msup id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2.2" xref="S2.SS3.p1.1.m1.1.1.2.2.cmml">z</mi><mi id="S2.SS3.p1.1.m1.1.1.2.3" xref="S2.SS3.p1.1.m1.1.1.2.3.cmml">t</mi></msup><mo id="S2.SS3.p1.1.m1.1.1.1" xref="S2.SS3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml"><mi id="S2.SS3.p1.1.m1.1.1.3.2" xref="S2.SS3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S2.SS3.p1.1.m1.1.1.3.3" xref="S2.SS3.p1.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><in id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1"></in><apply id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.2.1.cmml" xref="S2.SS3.p1.1.m1.1.1.2">superscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.2.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2.2">𝑧</ci><ci id="S2.SS3.p1.1.m1.1.1.2.3.cmml" xref="S2.SS3.p1.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.3.1.cmml" xref="S2.SS3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.3.2.cmml" xref="S2.SS3.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S2.SS3.p1.1.m1.1.1.3.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">z^{t}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> with feature <math alttext="t" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">italic_t</annotation></semantics></math>, we could represent the semantics-enhanced embeddings of this node as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h^{t}=\gamma_{t}\odot f_{t}^{\delta 1}+(1-\gamma_{t})\odot f_{t}^{\delta 2}+z^%
{t}" class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><msup id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.3.2" xref="S2.E1.m1.1.1.3.2.cmml">h</mi><mi id="S2.E1.m1.1.1.3.3" xref="S2.E1.m1.1.1.3.3.cmml">t</mi></msup><mo id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3.cmml"><msub id="S2.E1.m1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.3.2.2.cmml">γ</mi><mi id="S2.E1.m1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S2.E1.m1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E1.m1.1.1.1.3.1.cmml">⊙</mo><msubsup id="S2.E1.m1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.3.3.2.2" xref="S2.E1.m1.1.1.1.3.3.2.2.cmml">f</mi><mi id="S2.E1.m1.1.1.1.3.3.2.3" xref="S2.E1.m1.1.1.1.3.3.2.3.cmml">t</mi><mrow id="S2.E1.m1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.3.3.3.cmml"><mi id="S2.E1.m1.1.1.1.3.3.3.2" xref="S2.E1.m1.1.1.1.3.3.3.2.cmml">δ</mi><mo id="S2.E1.m1.1.1.1.3.3.3.1" xref="S2.E1.m1.1.1.1.3.3.3.1.cmml">⁢</mo><mn id="S2.E1.m1.1.1.1.3.3.3.3" xref="S2.E1.m1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">+</mo><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml"><mn id="S2.E1.m1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.3.2.cmml">γ</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.1.1.1.1.2" rspace="0.222em" xref="S2.E1.m1.1.1.1.1.2.cmml">⊙</mo><msubsup id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.1.3.2.2.cmml">f</mi><mi id="S2.E1.m1.1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.1.3.2.3.cmml">t</mi><mrow id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.3.3.2.cmml">δ</mi><mo id="S2.E1.m1.1.1.1.1.3.3.1" xref="S2.E1.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mn id="S2.E1.m1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.3.3.3.cmml">2</mn></mrow></msubsup></mrow><mo id="S2.E1.m1.1.1.1.2a" xref="S2.E1.m1.1.1.1.2.cmml">+</mo><msup id="S2.E1.m1.1.1.1.4" xref="S2.E1.m1.1.1.1.4.cmml"><mi id="S2.E1.m1.1.1.1.4.2" xref="S2.E1.m1.1.1.1.4.2.cmml">z</mi><mi id="S2.E1.m1.1.1.1.4.3" xref="S2.E1.m1.1.1.1.4.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><eq id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"></eq><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3.2">ℎ</ci><ci id="S2.E1.m1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.3.3">𝑡</ci></apply><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><plus id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></plus><apply id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.3.1">direct-product</csymbol><apply id="S2.E1.m1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.3.2.2">𝛾</ci><ci id="S2.E1.m1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E1.m1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.3.3">superscript</csymbol><apply id="S2.E1.m1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.3.3.2.1.cmml" xref="S2.E1.m1.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.3.3.2.2.cmml" xref="S2.E1.m1.1.1.1.3.3.2.2">𝑓</ci><ci id="S2.E1.m1.1.1.1.3.3.2.3.cmml" xref="S2.E1.m1.1.1.1.3.3.2.3">𝑡</ci></apply><apply id="S2.E1.m1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.3.3.3"><times id="S2.E1.m1.1.1.1.3.3.3.1.cmml" xref="S2.E1.m1.1.1.1.3.3.3.1"></times><ci id="S2.E1.m1.1.1.1.3.3.3.2.cmml" xref="S2.E1.m1.1.1.1.3.3.3.2">𝛿</ci><cn id="S2.E1.m1.1.1.1.3.3.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2">direct-product</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><minus id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1"></minus><cn id="S2.E1.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.1.1.1.2">1</cn><apply id="S2.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.3.2">𝛾</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2">𝑓</ci><ci id="S2.E1.m1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3"><times id="S2.E1.m1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.3.1"></times><ci id="S2.E1.m1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.3.2">𝛿</ci><cn id="S2.E1.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S2.E1.m1.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S2.E1.m1.1.1.1.4.cmml" xref="S2.E1.m1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.4.1.cmml" xref="S2.E1.m1.1.1.1.4">superscript</csymbol><ci id="S2.E1.m1.1.1.1.4.2.cmml" xref="S2.E1.m1.1.1.1.4.2">𝑧</ci><ci id="S2.E1.m1.1.1.1.4.3.cmml" xref="S2.E1.m1.1.1.1.4.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">h^{t}=\gamma_{t}\odot f_{t}^{\delta 1}+(1-\gamma_{t})\odot f_{t}^{\delta 2}+z^%
{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_h start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = italic_γ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⊙ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ 1 end_POSTSUPERSCRIPT + ( 1 - italic_γ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ⊙ italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ 2 end_POSTSUPERSCRIPT + italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p1.11">This equation sums the neighbouring node feature embeddings <math alttext="f_{t}^{\delta}" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m1.1"><semantics id="S2.SS3.p1.3.m1.1a"><msubsup id="S2.SS3.p1.3.m1.1.1" xref="S2.SS3.p1.3.m1.1.1.cmml"><mi id="S2.SS3.p1.3.m1.1.1.2.2" xref="S2.SS3.p1.3.m1.1.1.2.2.cmml">f</mi><mi id="S2.SS3.p1.3.m1.1.1.2.3" xref="S2.SS3.p1.3.m1.1.1.2.3.cmml">t</mi><mi id="S2.SS3.p1.3.m1.1.1.3" xref="S2.SS3.p1.3.m1.1.1.3.cmml">δ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m1.1b"><apply id="S2.SS3.p1.3.m1.1.1.cmml" xref="S2.SS3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.1.1.1.cmml" xref="S2.SS3.p1.3.m1.1.1">superscript</csymbol><apply id="S2.SS3.p1.3.m1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.1.1.2.1.cmml" xref="S2.SS3.p1.3.m1.1.1">subscript</csymbol><ci id="S2.SS3.p1.3.m1.1.1.2.2.cmml" xref="S2.SS3.p1.3.m1.1.1.2.2">𝑓</ci><ci id="S2.SS3.p1.3.m1.1.1.2.3.cmml" xref="S2.SS3.p1.3.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p1.3.m1.1.1.3.cmml" xref="S2.SS3.p1.3.m1.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m1.1c">f_{t}^{\delta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m1.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT</annotation></semantics></math> with the current node embedding <math alttext="z^{t}" class="ltx_Math" display="inline" id="S2.SS3.p1.4.m2.1"><semantics id="S2.SS3.p1.4.m2.1a"><msup id="S2.SS3.p1.4.m2.1.1" xref="S2.SS3.p1.4.m2.1.1.cmml"><mi id="S2.SS3.p1.4.m2.1.1.2" xref="S2.SS3.p1.4.m2.1.1.2.cmml">z</mi><mi id="S2.SS3.p1.4.m2.1.1.3" xref="S2.SS3.p1.4.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m2.1b"><apply id="S2.SS3.p1.4.m2.1.1.cmml" xref="S2.SS3.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m2.1.1.1.cmml" xref="S2.SS3.p1.4.m2.1.1">superscript</csymbol><ci id="S2.SS3.p1.4.m2.1.1.2.cmml" xref="S2.SS3.p1.4.m2.1.1.2">𝑧</ci><ci id="S2.SS3.p1.4.m2.1.1.3.cmml" xref="S2.SS3.p1.4.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m2.1c">z^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.4.m2.1d">italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="\delta=\{\delta_{1},\delta_{2}\}" class="ltx_Math" display="inline" id="S2.SS3.p1.5.m3.2"><semantics id="S2.SS3.p1.5.m3.2a"><mrow id="S2.SS3.p1.5.m3.2.2" xref="S2.SS3.p1.5.m3.2.2.cmml"><mi id="S2.SS3.p1.5.m3.2.2.4" xref="S2.SS3.p1.5.m3.2.2.4.cmml">δ</mi><mo id="S2.SS3.p1.5.m3.2.2.3" xref="S2.SS3.p1.5.m3.2.2.3.cmml">=</mo><mrow id="S2.SS3.p1.5.m3.2.2.2.2" xref="S2.SS3.p1.5.m3.2.2.2.3.cmml"><mo id="S2.SS3.p1.5.m3.2.2.2.2.3" stretchy="false" xref="S2.SS3.p1.5.m3.2.2.2.3.cmml">{</mo><msub id="S2.SS3.p1.5.m3.1.1.1.1.1" xref="S2.SS3.p1.5.m3.1.1.1.1.1.cmml"><mi id="S2.SS3.p1.5.m3.1.1.1.1.1.2" xref="S2.SS3.p1.5.m3.1.1.1.1.1.2.cmml">δ</mi><mn id="S2.SS3.p1.5.m3.1.1.1.1.1.3" xref="S2.SS3.p1.5.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS3.p1.5.m3.2.2.2.2.4" xref="S2.SS3.p1.5.m3.2.2.2.3.cmml">,</mo><msub id="S2.SS3.p1.5.m3.2.2.2.2.2" xref="S2.SS3.p1.5.m3.2.2.2.2.2.cmml"><mi id="S2.SS3.p1.5.m3.2.2.2.2.2.2" xref="S2.SS3.p1.5.m3.2.2.2.2.2.2.cmml">δ</mi><mn id="S2.SS3.p1.5.m3.2.2.2.2.2.3" xref="S2.SS3.p1.5.m3.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS3.p1.5.m3.2.2.2.2.5" stretchy="false" xref="S2.SS3.p1.5.m3.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m3.2b"><apply id="S2.SS3.p1.5.m3.2.2.cmml" xref="S2.SS3.p1.5.m3.2.2"><eq id="S2.SS3.p1.5.m3.2.2.3.cmml" xref="S2.SS3.p1.5.m3.2.2.3"></eq><ci id="S2.SS3.p1.5.m3.2.2.4.cmml" xref="S2.SS3.p1.5.m3.2.2.4">𝛿</ci><set id="S2.SS3.p1.5.m3.2.2.2.3.cmml" xref="S2.SS3.p1.5.m3.2.2.2.2"><apply id="S2.SS3.p1.5.m3.1.1.1.1.1.cmml" xref="S2.SS3.p1.5.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m3.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.5.m3.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.5.m3.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.5.m3.1.1.1.1.1.2">𝛿</ci><cn id="S2.SS3.p1.5.m3.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS3.p1.5.m3.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS3.p1.5.m3.2.2.2.2.2.cmml" xref="S2.SS3.p1.5.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m3.2.2.2.2.2.1.cmml" xref="S2.SS3.p1.5.m3.2.2.2.2.2">subscript</csymbol><ci id="S2.SS3.p1.5.m3.2.2.2.2.2.2.cmml" xref="S2.SS3.p1.5.m3.2.2.2.2.2.2">𝛿</ci><cn id="S2.SS3.p1.5.m3.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS3.p1.5.m3.2.2.2.2.2.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m3.2c">\delta=\{\delta_{1},\delta_{2}\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.5.m3.2d">italic_δ = { italic_δ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_δ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT }</annotation></semantics></math>, <math alttext="t,\delta\in\{p,c,d\}" class="ltx_Math" display="inline" id="S2.SS3.p1.6.m4.5"><semantics id="S2.SS3.p1.6.m4.5a"><mrow id="S2.SS3.p1.6.m4.5.6" xref="S2.SS3.p1.6.m4.5.6.cmml"><mrow id="S2.SS3.p1.6.m4.5.6.2.2" xref="S2.SS3.p1.6.m4.5.6.2.1.cmml"><mi id="S2.SS3.p1.6.m4.4.4" xref="S2.SS3.p1.6.m4.4.4.cmml">t</mi><mo id="S2.SS3.p1.6.m4.5.6.2.2.1" xref="S2.SS3.p1.6.m4.5.6.2.1.cmml">,</mo><mi id="S2.SS3.p1.6.m4.5.5" xref="S2.SS3.p1.6.m4.5.5.cmml">δ</mi></mrow><mo id="S2.SS3.p1.6.m4.5.6.1" xref="S2.SS3.p1.6.m4.5.6.1.cmml">∈</mo><mrow id="S2.SS3.p1.6.m4.5.6.3.2" xref="S2.SS3.p1.6.m4.5.6.3.1.cmml"><mo id="S2.SS3.p1.6.m4.5.6.3.2.1" stretchy="false" xref="S2.SS3.p1.6.m4.5.6.3.1.cmml">{</mo><mi id="S2.SS3.p1.6.m4.1.1" xref="S2.SS3.p1.6.m4.1.1.cmml">p</mi><mo id="S2.SS3.p1.6.m4.5.6.3.2.2" xref="S2.SS3.p1.6.m4.5.6.3.1.cmml">,</mo><mi id="S2.SS3.p1.6.m4.2.2" xref="S2.SS3.p1.6.m4.2.2.cmml">c</mi><mo id="S2.SS3.p1.6.m4.5.6.3.2.3" xref="S2.SS3.p1.6.m4.5.6.3.1.cmml">,</mo><mi id="S2.SS3.p1.6.m4.3.3" xref="S2.SS3.p1.6.m4.3.3.cmml">d</mi><mo id="S2.SS3.p1.6.m4.5.6.3.2.4" stretchy="false" xref="S2.SS3.p1.6.m4.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m4.5b"><apply id="S2.SS3.p1.6.m4.5.6.cmml" xref="S2.SS3.p1.6.m4.5.6"><in id="S2.SS3.p1.6.m4.5.6.1.cmml" xref="S2.SS3.p1.6.m4.5.6.1"></in><list id="S2.SS3.p1.6.m4.5.6.2.1.cmml" xref="S2.SS3.p1.6.m4.5.6.2.2"><ci id="S2.SS3.p1.6.m4.4.4.cmml" xref="S2.SS3.p1.6.m4.4.4">𝑡</ci><ci id="S2.SS3.p1.6.m4.5.5.cmml" xref="S2.SS3.p1.6.m4.5.5">𝛿</ci></list><set id="S2.SS3.p1.6.m4.5.6.3.1.cmml" xref="S2.SS3.p1.6.m4.5.6.3.2"><ci id="S2.SS3.p1.6.m4.1.1.cmml" xref="S2.SS3.p1.6.m4.1.1">𝑝</ci><ci id="S2.SS3.p1.6.m4.2.2.cmml" xref="S2.SS3.p1.6.m4.2.2">𝑐</ci><ci id="S2.SS3.p1.6.m4.3.3.cmml" xref="S2.SS3.p1.6.m4.3.3">𝑑</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m4.5c">t,\delta\in\{p,c,d\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.6.m4.5d">italic_t , italic_δ ∈ { italic_p , italic_c , italic_d }</annotation></semantics></math> such that <math alttext="t\neq\delta" class="ltx_Math" display="inline" id="S2.SS3.p1.7.m5.1"><semantics id="S2.SS3.p1.7.m5.1a"><mrow id="S2.SS3.p1.7.m5.1.1" xref="S2.SS3.p1.7.m5.1.1.cmml"><mi id="S2.SS3.p1.7.m5.1.1.2" xref="S2.SS3.p1.7.m5.1.1.2.cmml">t</mi><mo id="S2.SS3.p1.7.m5.1.1.1" xref="S2.SS3.p1.7.m5.1.1.1.cmml">≠</mo><mi id="S2.SS3.p1.7.m5.1.1.3" xref="S2.SS3.p1.7.m5.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m5.1b"><apply id="S2.SS3.p1.7.m5.1.1.cmml" xref="S2.SS3.p1.7.m5.1.1"><neq id="S2.SS3.p1.7.m5.1.1.1.cmml" xref="S2.SS3.p1.7.m5.1.1.1"></neq><ci id="S2.SS3.p1.7.m5.1.1.2.cmml" xref="S2.SS3.p1.7.m5.1.1.2">𝑡</ci><ci id="S2.SS3.p1.7.m5.1.1.3.cmml" xref="S2.SS3.p1.7.m5.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.7.m5.1c">t\neq\delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.7.m5.1d">italic_t ≠ italic_δ</annotation></semantics></math>. Here <math alttext="\odot" class="ltx_Math" display="inline" id="S2.SS3.p1.8.m6.1"><semantics id="S2.SS3.p1.8.m6.1a"><mo id="S2.SS3.p1.8.m6.1.1" xref="S2.SS3.p1.8.m6.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m6.1b"><csymbol cd="latexml" id="S2.SS3.p1.8.m6.1.1.cmml" xref="S2.SS3.p1.8.m6.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.8.m6.1c">\odot</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.8.m6.1d">⊙</annotation></semantics></math> is element-wise product and <math alttext="\gamma_{t}" class="ltx_Math" display="inline" id="S2.SS3.p1.9.m7.1"><semantics id="S2.SS3.p1.9.m7.1a"><msub id="S2.SS3.p1.9.m7.1.1" xref="S2.SS3.p1.9.m7.1.1.cmml"><mi id="S2.SS3.p1.9.m7.1.1.2" xref="S2.SS3.p1.9.m7.1.1.2.cmml">γ</mi><mi id="S2.SS3.p1.9.m7.1.1.3" xref="S2.SS3.p1.9.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.9.m7.1b"><apply id="S2.SS3.p1.9.m7.1.1.cmml" xref="S2.SS3.p1.9.m7.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.9.m7.1.1.1.cmml" xref="S2.SS3.p1.9.m7.1.1">subscript</csymbol><ci id="S2.SS3.p1.9.m7.1.1.2.cmml" xref="S2.SS3.p1.9.m7.1.1.2">𝛾</ci><ci id="S2.SS3.p1.9.m7.1.1.3.cmml" xref="S2.SS3.p1.9.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.9.m7.1c">\gamma_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.9.m7.1d">italic_γ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are feature attention scores based on the current node embedding <math alttext="z^{t}" class="ltx_Math" display="inline" id="S2.SS3.p1.10.m8.1"><semantics id="S2.SS3.p1.10.m8.1a"><msup id="S2.SS3.p1.10.m8.1.1" xref="S2.SS3.p1.10.m8.1.1.cmml"><mi id="S2.SS3.p1.10.m8.1.1.2" xref="S2.SS3.p1.10.m8.1.1.2.cmml">z</mi><mi id="S2.SS3.p1.10.m8.1.1.3" xref="S2.SS3.p1.10.m8.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.10.m8.1b"><apply id="S2.SS3.p1.10.m8.1.1.cmml" xref="S2.SS3.p1.10.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m8.1.1.1.cmml" xref="S2.SS3.p1.10.m8.1.1">superscript</csymbol><ci id="S2.SS3.p1.10.m8.1.1.2.cmml" xref="S2.SS3.p1.10.m8.1.1.2">𝑧</ci><ci id="S2.SS3.p1.10.m8.1.1.3.cmml" xref="S2.SS3.p1.10.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.10.m8.1c">z^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.10.m8.1d">italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> and the features embedding <math alttext="f_{t}^{\delta}" class="ltx_Math" display="inline" id="S2.SS3.p1.11.m9.1"><semantics id="S2.SS3.p1.11.m9.1a"><msubsup id="S2.SS3.p1.11.m9.1.1" xref="S2.SS3.p1.11.m9.1.1.cmml"><mi id="S2.SS3.p1.11.m9.1.1.2.2" xref="S2.SS3.p1.11.m9.1.1.2.2.cmml">f</mi><mi id="S2.SS3.p1.11.m9.1.1.2.3" xref="S2.SS3.p1.11.m9.1.1.2.3.cmml">t</mi><mi id="S2.SS3.p1.11.m9.1.1.3" xref="S2.SS3.p1.11.m9.1.1.3.cmml">δ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.11.m9.1b"><apply id="S2.SS3.p1.11.m9.1.1.cmml" xref="S2.SS3.p1.11.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m9.1.1.1.cmml" xref="S2.SS3.p1.11.m9.1.1">superscript</csymbol><apply id="S2.SS3.p1.11.m9.1.1.2.cmml" xref="S2.SS3.p1.11.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.11.m9.1.1.2.1.cmml" xref="S2.SS3.p1.11.m9.1.1">subscript</csymbol><ci id="S2.SS3.p1.11.m9.1.1.2.2.cmml" xref="S2.SS3.p1.11.m9.1.1.2.2">𝑓</ci><ci id="S2.SS3.p1.11.m9.1.1.2.3.cmml" xref="S2.SS3.p1.11.m9.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p1.11.m9.1.1.3.cmml" xref="S2.SS3.p1.11.m9.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.11.m9.1c">f_{t}^{\delta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.11.m9.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\gamma_{t}=\sigma(W_{t}\cdot concat[z^{t},f_{t}^{\delta}]+\sum\limits_{\delta%
\neq t}W_{t}^{\delta}f_{t}^{\delta})" class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml">γ</mi><mi id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml">t</mi></msub><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml">σ</mi><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.2.4" xref="S2.E2.m1.1.1.1.1.1.1.2.4.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.2.4.2" xref="S2.E2.m1.1.1.1.1.1.1.2.4.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.4.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.4.2.2.cmml">W</mi><mi id="S2.E2.m1.1.1.1.1.1.1.2.4.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.4.2.3.cmml">t</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.1.2.4.1" lspace="0.222em" rspace="0.222em" xref="S2.E2.m1.1.1.1.1.1.1.2.4.1.cmml">⋅</mo><mi id="S2.E2.m1.1.1.1.1.1.1.2.4.3" xref="S2.E2.m1.1.1.1.1.1.1.2.4.3.cmml">c</mi></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.1.2.5" xref="S2.E2.m1.1.1.1.1.1.1.2.5.cmml">o</mi><mo id="S2.E2.m1.1.1.1.1.1.1.2.3a" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.1.2.6" xref="S2.E2.m1.1.1.1.1.1.1.2.6.cmml">n</mi><mo id="S2.E2.m1.1.1.1.1.1.1.2.3b" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.1.2.7" xref="S2.E2.m1.1.1.1.1.1.1.2.7.cmml">c</mi><mo id="S2.E2.m1.1.1.1.1.1.1.2.3c" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.1.2.8" xref="S2.E2.m1.1.1.1.1.1.1.2.8.cmml">a</mi><mo id="S2.E2.m1.1.1.1.1.1.1.2.3d" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.1.2.9" xref="S2.E2.m1.1.1.1.1.1.1.2.9.cmml">t</mi><mo id="S2.E2.m1.1.1.1.1.1.1.2.3e" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.cmml">[</mo><msup id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msup><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.4" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.cmml">f</mi><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.3.cmml">t</mi><mi id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml">δ</mi></msubsup><mo id="S2.E2.m1.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.2.2.3.cmml">]</mo></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.1.1.3" rspace="0.055em" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.1.1.4.cmml"><munder id="S2.E2.m1.1.1.1.1.1.1.4.1" xref="S2.E2.m1.1.1.1.1.1.1.4.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.1.4.1.2" movablelimits="false" xref="S2.E2.m1.1.1.1.1.1.1.4.1.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.4.1.3" xref="S2.E2.m1.1.1.1.1.1.1.4.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.4.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.4.1.3.2.cmml">δ</mi><mo id="S2.E2.m1.1.1.1.1.1.1.4.1.3.1" xref="S2.E2.m1.1.1.1.1.1.1.4.1.3.1.cmml">≠</mo><mi id="S2.E2.m1.1.1.1.1.1.1.4.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.4.1.3.3.cmml">t</mi></mrow></munder><mrow id="S2.E2.m1.1.1.1.1.1.1.4.2" xref="S2.E2.m1.1.1.1.1.1.1.4.2.cmml"><msubsup id="S2.E2.m1.1.1.1.1.1.1.4.2.2" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.2.cmml">W</mi><mi id="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.3.cmml">t</mi><mi id="S2.E2.m1.1.1.1.1.1.1.4.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2.3.cmml">δ</mi></msubsup><mo id="S2.E2.m1.1.1.1.1.1.1.4.2.1" xref="S2.E2.m1.1.1.1.1.1.1.4.2.1.cmml">⁢</mo><msubsup id="S2.E2.m1.1.1.1.1.1.1.4.2.3" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.2" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.2.cmml">f</mi><mi id="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.3" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.3.cmml">t</mi><mi id="S2.E2.m1.1.1.1.1.1.1.4.2.3.3" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3.3.cmml">δ</mi></msubsup></mrow></mrow></mrow><mo id="S2.E2.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></eq><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2">𝛾</ci><ci id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3">𝑡</ci></apply><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3">𝜎</ci><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><plus id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"></plus><apply id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2"><times id="S2.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.3"></times><apply id="S2.E2.m1.1.1.1.1.1.1.2.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.4"><ci id="S2.E2.m1.1.1.1.1.1.1.2.4.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.4.1">⋅</ci><apply id="S2.E2.m1.1.1.1.1.1.1.2.4.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.4.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.4.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.4.2.2">𝑊</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.4.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.4.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.2.4.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.4.3">𝑐</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.2.5.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.5">𝑜</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.6.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.6">𝑛</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.7.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.7">𝑐</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.8.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.8">𝑎</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.9.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.9">𝑡</ci><interval closure="closed" id="S2.E2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2"><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.2">𝑓</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2.2.2.3">𝛿</ci></apply></interval></apply><apply id="S2.E2.m1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4"><apply id="S2.E2.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.4.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.1">subscript</csymbol><sum id="S2.E2.m1.1.1.1.1.1.1.4.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.1.2"></sum><apply id="S2.E2.m1.1.1.1.1.1.1.4.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.1.3"><neq id="S2.E2.m1.1.1.1.1.1.1.4.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.1.3.1"></neq><ci id="S2.E2.m1.1.1.1.1.1.1.4.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.1.3.2">𝛿</ci><ci id="S2.E2.m1.1.1.1.1.1.1.4.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.1.3.3">𝑡</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2"><times id="S2.E2.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.1"></times><apply id="S2.E2.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.4.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.2">𝑊</ci><ci id="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.4.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.2.3">𝛿</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.4.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.2">𝑓</ci><ci id="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3.2.3">𝑡</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.4.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4.2.3.3">𝛿</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\gamma_{t}=\sigma(W_{t}\cdot concat[z^{t},f_{t}^{\delta}]+\sum\limits_{\delta%
\neq t}W_{t}^{\delta}f_{t}^{\delta})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_γ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = italic_σ ( italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ⋅ italic_c italic_o italic_n italic_c italic_a italic_t [ italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT ] + ∑ start_POSTSUBSCRIPT italic_δ ≠ italic_t end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p1.13">where <math alttext="W_{t}\in\mathbb{R}^{d\times 3d}" class="ltx_Math" display="inline" id="S2.SS3.p1.12.m1.1"><semantics id="S2.SS3.p1.12.m1.1a"><mrow id="S2.SS3.p1.12.m1.1.1" xref="S2.SS3.p1.12.m1.1.1.cmml"><msub id="S2.SS3.p1.12.m1.1.1.2" xref="S2.SS3.p1.12.m1.1.1.2.cmml"><mi id="S2.SS3.p1.12.m1.1.1.2.2" xref="S2.SS3.p1.12.m1.1.1.2.2.cmml">W</mi><mi id="S2.SS3.p1.12.m1.1.1.2.3" xref="S2.SS3.p1.12.m1.1.1.2.3.cmml">t</mi></msub><mo id="S2.SS3.p1.12.m1.1.1.1" xref="S2.SS3.p1.12.m1.1.1.1.cmml">∈</mo><msup id="S2.SS3.p1.12.m1.1.1.3" xref="S2.SS3.p1.12.m1.1.1.3.cmml"><mi id="S2.SS3.p1.12.m1.1.1.3.2" xref="S2.SS3.p1.12.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.p1.12.m1.1.1.3.3" xref="S2.SS3.p1.12.m1.1.1.3.3.cmml"><mrow id="S2.SS3.p1.12.m1.1.1.3.3.2" xref="S2.SS3.p1.12.m1.1.1.3.3.2.cmml"><mi id="S2.SS3.p1.12.m1.1.1.3.3.2.2" xref="S2.SS3.p1.12.m1.1.1.3.3.2.2.cmml">d</mi><mo id="S2.SS3.p1.12.m1.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p1.12.m1.1.1.3.3.2.1.cmml">×</mo><mn id="S2.SS3.p1.12.m1.1.1.3.3.2.3" xref="S2.SS3.p1.12.m1.1.1.3.3.2.3.cmml">3</mn></mrow><mo id="S2.SS3.p1.12.m1.1.1.3.3.1" xref="S2.SS3.p1.12.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS3.p1.12.m1.1.1.3.3.3" xref="S2.SS3.p1.12.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.12.m1.1b"><apply id="S2.SS3.p1.12.m1.1.1.cmml" xref="S2.SS3.p1.12.m1.1.1"><in id="S2.SS3.p1.12.m1.1.1.1.cmml" xref="S2.SS3.p1.12.m1.1.1.1"></in><apply id="S2.SS3.p1.12.m1.1.1.2.cmml" xref="S2.SS3.p1.12.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.12.m1.1.1.2.1.cmml" xref="S2.SS3.p1.12.m1.1.1.2">subscript</csymbol><ci id="S2.SS3.p1.12.m1.1.1.2.2.cmml" xref="S2.SS3.p1.12.m1.1.1.2.2">𝑊</ci><ci id="S2.SS3.p1.12.m1.1.1.2.3.cmml" xref="S2.SS3.p1.12.m1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS3.p1.12.m1.1.1.3.cmml" xref="S2.SS3.p1.12.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.12.m1.1.1.3.1.cmml" xref="S2.SS3.p1.12.m1.1.1.3">superscript</csymbol><ci id="S2.SS3.p1.12.m1.1.1.3.2.cmml" xref="S2.SS3.p1.12.m1.1.1.3.2">ℝ</ci><apply id="S2.SS3.p1.12.m1.1.1.3.3.cmml" xref="S2.SS3.p1.12.m1.1.1.3.3"><times id="S2.SS3.p1.12.m1.1.1.3.3.1.cmml" xref="S2.SS3.p1.12.m1.1.1.3.3.1"></times><apply id="S2.SS3.p1.12.m1.1.1.3.3.2.cmml" xref="S2.SS3.p1.12.m1.1.1.3.3.2"><times id="S2.SS3.p1.12.m1.1.1.3.3.2.1.cmml" xref="S2.SS3.p1.12.m1.1.1.3.3.2.1"></times><ci id="S2.SS3.p1.12.m1.1.1.3.3.2.2.cmml" xref="S2.SS3.p1.12.m1.1.1.3.3.2.2">𝑑</ci><cn id="S2.SS3.p1.12.m1.1.1.3.3.2.3.cmml" type="integer" xref="S2.SS3.p1.12.m1.1.1.3.3.2.3">3</cn></apply><ci id="S2.SS3.p1.12.m1.1.1.3.3.3.cmml" xref="S2.SS3.p1.12.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.12.m1.1c">W_{t}\in\mathbb{R}^{d\times 3d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.12.m1.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × 3 italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="W_{t}^{\delta}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S2.SS3.p1.13.m2.1"><semantics id="S2.SS3.p1.13.m2.1a"><mrow id="S2.SS3.p1.13.m2.1.1" xref="S2.SS3.p1.13.m2.1.1.cmml"><msubsup id="S2.SS3.p1.13.m2.1.1.2" xref="S2.SS3.p1.13.m2.1.1.2.cmml"><mi id="S2.SS3.p1.13.m2.1.1.2.2.2" xref="S2.SS3.p1.13.m2.1.1.2.2.2.cmml">W</mi><mi id="S2.SS3.p1.13.m2.1.1.2.2.3" xref="S2.SS3.p1.13.m2.1.1.2.2.3.cmml">t</mi><mi id="S2.SS3.p1.13.m2.1.1.2.3" xref="S2.SS3.p1.13.m2.1.1.2.3.cmml">δ</mi></msubsup><mo id="S2.SS3.p1.13.m2.1.1.1" xref="S2.SS3.p1.13.m2.1.1.1.cmml">∈</mo><msup id="S2.SS3.p1.13.m2.1.1.3" xref="S2.SS3.p1.13.m2.1.1.3.cmml"><mi id="S2.SS3.p1.13.m2.1.1.3.2" xref="S2.SS3.p1.13.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS3.p1.13.m2.1.1.3.3" xref="S2.SS3.p1.13.m2.1.1.3.3.cmml"><mi id="S2.SS3.p1.13.m2.1.1.3.3.2" xref="S2.SS3.p1.13.m2.1.1.3.3.2.cmml">d</mi><mo id="S2.SS3.p1.13.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p1.13.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS3.p1.13.m2.1.1.3.3.3" xref="S2.SS3.p1.13.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.13.m2.1b"><apply id="S2.SS3.p1.13.m2.1.1.cmml" xref="S2.SS3.p1.13.m2.1.1"><in id="S2.SS3.p1.13.m2.1.1.1.cmml" xref="S2.SS3.p1.13.m2.1.1.1"></in><apply id="S2.SS3.p1.13.m2.1.1.2.cmml" xref="S2.SS3.p1.13.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m2.1.1.2.1.cmml" xref="S2.SS3.p1.13.m2.1.1.2">superscript</csymbol><apply id="S2.SS3.p1.13.m2.1.1.2.2.cmml" xref="S2.SS3.p1.13.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m2.1.1.2.2.1.cmml" xref="S2.SS3.p1.13.m2.1.1.2">subscript</csymbol><ci id="S2.SS3.p1.13.m2.1.1.2.2.2.cmml" xref="S2.SS3.p1.13.m2.1.1.2.2.2">𝑊</ci><ci id="S2.SS3.p1.13.m2.1.1.2.2.3.cmml" xref="S2.SS3.p1.13.m2.1.1.2.2.3">𝑡</ci></apply><ci id="S2.SS3.p1.13.m2.1.1.2.3.cmml" xref="S2.SS3.p1.13.m2.1.1.2.3">𝛿</ci></apply><apply id="S2.SS3.p1.13.m2.1.1.3.cmml" xref="S2.SS3.p1.13.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.13.m2.1.1.3.1.cmml" xref="S2.SS3.p1.13.m2.1.1.3">superscript</csymbol><ci id="S2.SS3.p1.13.m2.1.1.3.2.cmml" xref="S2.SS3.p1.13.m2.1.1.3.2">ℝ</ci><apply id="S2.SS3.p1.13.m2.1.1.3.3.cmml" xref="S2.SS3.p1.13.m2.1.1.3.3"><times id="S2.SS3.p1.13.m2.1.1.3.3.1.cmml" xref="S2.SS3.p1.13.m2.1.1.3.3.1"></times><ci id="S2.SS3.p1.13.m2.1.1.3.3.2.cmml" xref="S2.SS3.p1.13.m2.1.1.3.3.2">𝑑</ci><ci id="S2.SS3.p1.13.m2.1.1.3.3.3.cmml" xref="S2.SS3.p1.13.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.13.m2.1c">W_{t}^{\delta}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.13.m2.1d">italic_W start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are learnable parameters.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.3">In order to obtain feature embeddings <math alttext="f_{t}^{\delta}" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><msubsup id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2.2" xref="S2.SS3.p2.1.m1.1.1.2.2.cmml">f</mi><mi id="S2.SS3.p2.1.m1.1.1.2.3" xref="S2.SS3.p2.1.m1.1.1.2.3.cmml">t</mi><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">δ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">superscript</csymbol><apply id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.2.1.cmml" xref="S2.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.2.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2.2">𝑓</ci><ci id="S2.SS3.p2.1.m1.1.1.2.3.cmml" xref="S2.SS3.p2.1.m1.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">f_{t}^{\delta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT</annotation></semantics></math> for the given node <math alttext="z^{t}" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><msup id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">z</mi><mi id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">𝑧</ci><ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">z^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">italic_z start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math>, we integrate homogeneous information from nodes with the same feature, as neighbouring nodes of the same feature can have varying levels of importance. The weights of each node for feature <math alttext="\delta" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><mi id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><ci id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">\delta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">italic_δ</annotation></semantics></math> are defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu_{i}=\frac{exp(\alpha_{\delta}^{\top}z_{i}^{\delta})}{\sum\limits_{z_{i}^{%
\delta}\in\mathcal{A}_{t}^{\delta}}exp(\alpha_{\delta}^{\top}z_{i}^{\delta})}" class="ltx_Math" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.3" xref="S2.E3.m1.2.3.cmml"><msub id="S2.E3.m1.2.3.2" xref="S2.E3.m1.2.3.2.cmml"><mi id="S2.E3.m1.2.3.2.2" xref="S2.E3.m1.2.3.2.2.cmml">μ</mi><mi id="S2.E3.m1.2.3.2.3" xref="S2.E3.m1.2.3.2.3.cmml">i</mi></msub><mo id="S2.E3.m1.2.3.1" xref="S2.E3.m1.2.3.1.cmml">=</mo><mfrac id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml">e</mi><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.4" xref="S2.E3.m1.1.1.1.4.cmml">x</mi><mo id="S2.E3.m1.1.1.1.2a" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.5" xref="S2.E3.m1.1.1.1.5.cmml">p</mi><mo id="S2.E3.m1.1.1.1.2b" xref="S2.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml"><msubsup id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2.cmml">α</mi><mi id="S2.E3.m1.1.1.1.1.1.1.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.2.2.3.cmml">δ</mi><mo id="S2.E3.m1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.3.2.2.cmml">z</mi><mi id="S2.E3.m1.1.1.1.1.1.1.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S2.E3.m1.1.1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.1.1.3.3.cmml">δ</mi></msubsup></mrow><mo id="S2.E3.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><munder id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml"><mo id="S2.E3.m1.2.2.2.2.2" movablelimits="false" xref="S2.E3.m1.2.2.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.3.cmml"><msubsup id="S2.E3.m1.2.2.2.2.3.2" xref="S2.E3.m1.2.2.2.2.3.2.cmml"><mi id="S2.E3.m1.2.2.2.2.3.2.2.2" xref="S2.E3.m1.2.2.2.2.3.2.2.2.cmml">z</mi><mi id="S2.E3.m1.2.2.2.2.3.2.2.3" xref="S2.E3.m1.2.2.2.2.3.2.2.3.cmml">i</mi><mi id="S2.E3.m1.2.2.2.2.3.2.3" xref="S2.E3.m1.2.2.2.2.3.2.3.cmml">δ</mi></msubsup><mo id="S2.E3.m1.2.2.2.2.3.1" xref="S2.E3.m1.2.2.2.2.3.1.cmml">∈</mo><msubsup id="S2.E3.m1.2.2.2.2.3.3" xref="S2.E3.m1.2.2.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.2.2.3.3.2.2" xref="S2.E3.m1.2.2.2.2.3.3.2.2.cmml">𝒜</mi><mi id="S2.E3.m1.2.2.2.2.3.3.2.3" xref="S2.E3.m1.2.2.2.2.3.3.2.3.cmml">t</mi><mi id="S2.E3.m1.2.2.2.2.3.3.3" xref="S2.E3.m1.2.2.2.2.3.3.3.cmml">δ</mi></msubsup></mrow></munder><mrow id="S2.E3.m1.2.2.2.1" xref="S2.E3.m1.2.2.2.1.cmml"><mi id="S2.E3.m1.2.2.2.1.3" xref="S2.E3.m1.2.2.2.1.3.cmml">e</mi><mo id="S2.E3.m1.2.2.2.1.2" xref="S2.E3.m1.2.2.2.1.2.cmml">⁢</mo><mi id="S2.E3.m1.2.2.2.1.4" xref="S2.E3.m1.2.2.2.1.4.cmml">x</mi><mo id="S2.E3.m1.2.2.2.1.2a" xref="S2.E3.m1.2.2.2.1.2.cmml">⁢</mo><mi id="S2.E3.m1.2.2.2.1.5" xref="S2.E3.m1.2.2.2.1.5.cmml">p</mi><mo id="S2.E3.m1.2.2.2.1.2b" xref="S2.E3.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.2.1.1.1.2" stretchy="false" xref="S2.E3.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.1.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.cmml"><msubsup id="S2.E3.m1.2.2.2.1.1.1.1.2" xref="S2.E3.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S2.E3.m1.2.2.2.1.1.1.1.2.2.2" xref="S2.E3.m1.2.2.2.1.1.1.1.2.2.2.cmml">α</mi><mi id="S2.E3.m1.2.2.2.1.1.1.1.2.2.3" xref="S2.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml">δ</mi><mo id="S2.E3.m1.2.2.2.1.1.1.1.2.3" xref="S2.E3.m1.2.2.2.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S2.E3.m1.2.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E3.m1.2.2.2.1.1.1.1.3" xref="S2.E3.m1.2.2.2.1.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.2.1.1.1.1.3.2.2" xref="S2.E3.m1.2.2.2.1.1.1.1.3.2.2.cmml">z</mi><mi id="S2.E3.m1.2.2.2.1.1.1.1.3.2.3" xref="S2.E3.m1.2.2.2.1.1.1.1.3.2.3.cmml">i</mi><mi id="S2.E3.m1.2.2.2.1.1.1.1.3.3" xref="S2.E3.m1.2.2.2.1.1.1.1.3.3.cmml">δ</mi></msubsup></mrow><mo id="S2.E3.m1.2.2.2.1.1.1.3" stretchy="false" xref="S2.E3.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.3.cmml" xref="S2.E3.m1.2.3"><eq id="S2.E3.m1.2.3.1.cmml" xref="S2.E3.m1.2.3.1"></eq><apply id="S2.E3.m1.2.3.2.cmml" xref="S2.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.3.2.1.cmml" xref="S2.E3.m1.2.3.2">subscript</csymbol><ci id="S2.E3.m1.2.3.2.2.cmml" xref="S2.E3.m1.2.3.2.2">𝜇</ci><ci id="S2.E3.m1.2.3.2.3.cmml" xref="S2.E3.m1.2.3.2.3">𝑖</ci></apply><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><divide id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2"></divide><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><times id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3">𝑒</ci><ci id="S2.E3.m1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.4">𝑥</ci><ci id="S2.E3.m1.1.1.1.5.cmml" xref="S2.E3.m1.1.1.1.5">𝑝</ci><apply id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"></times><apply id="S2.E3.m1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2.2">𝛼</ci><ci id="S2.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.2.3">𝛿</ci></apply><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2.3">top</csymbol></apply><apply id="S2.E3.m1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.2.2">𝑧</ci><ci id="S2.E3.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.3.3">𝛿</ci></apply></apply></apply><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><apply id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2">subscript</csymbol><sum id="S2.E3.m1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2"></sum><apply id="S2.E3.m1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3"><in id="S2.E3.m1.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.3.1"></in><apply id="S2.E3.m1.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.3.2.1.cmml" xref="S2.E3.m1.2.2.2.2.3.2">superscript</csymbol><apply id="S2.E3.m1.2.2.2.2.3.2.2.cmml" xref="S2.E3.m1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.3.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2.3.2">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.3.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.3.2.2.2">𝑧</ci><ci id="S2.E3.m1.2.2.2.2.3.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3.2.2.3">𝑖</ci></apply><ci id="S2.E3.m1.2.2.2.2.3.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3.2.3">𝛿</ci></apply><apply id="S2.E3.m1.2.2.2.2.3.3.cmml" xref="S2.E3.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.3.3.1.cmml" xref="S2.E3.m1.2.2.2.2.3.3">superscript</csymbol><apply id="S2.E3.m1.2.2.2.2.3.3.2.cmml" xref="S2.E3.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.3.3.2.1.cmml" xref="S2.E3.m1.2.2.2.2.3.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.3.3.2.2.cmml" xref="S2.E3.m1.2.2.2.2.3.3.2.2">𝒜</ci><ci id="S2.E3.m1.2.2.2.2.3.3.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3.3.2.3">𝑡</ci></apply><ci id="S2.E3.m1.2.2.2.2.3.3.3.cmml" xref="S2.E3.m1.2.2.2.2.3.3.3">𝛿</ci></apply></apply></apply><apply id="S2.E3.m1.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.1"><times id="S2.E3.m1.2.2.2.1.2.cmml" xref="S2.E3.m1.2.2.2.1.2"></times><ci id="S2.E3.m1.2.2.2.1.3.cmml" xref="S2.E3.m1.2.2.2.1.3">𝑒</ci><ci id="S2.E3.m1.2.2.2.1.4.cmml" xref="S2.E3.m1.2.2.2.1.4">𝑥</ci><ci id="S2.E3.m1.2.2.2.1.5.cmml" xref="S2.E3.m1.2.2.2.1.5">𝑝</ci><apply id="S2.E3.m1.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1"><times id="S2.E3.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.1"></times><apply id="S2.E3.m1.2.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2.2.2">𝛼</ci><ci id="S2.E3.m1.2.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2.2.3">𝛿</ci></apply><csymbol cd="latexml" id="S2.E3.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.2.3">top</csymbol></apply><apply id="S2.E3.m1.2.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3">superscript</csymbol><apply id="S2.E3.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3.2.2">𝑧</ci><ci id="S2.E3.m1.2.2.2.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E3.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.2.1.1.1.1.3.3">𝛿</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\mu_{i}=\frac{exp(\alpha_{\delta}^{\top}z_{i}^{\delta})}{\sum\limits_{z_{i}^{%
\delta}\in\mathcal{A}_{t}^{\delta}}exp(\alpha_{\delta}^{\top}z_{i}^{\delta})}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">italic_μ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = divide start_ARG italic_e italic_x italic_p ( italic_α start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT ∈ caligraphic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_e italic_x italic_p ( italic_α start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p2.6">where <math alttext="\alpha_{\delta}^{\top}" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m1.1"><semantics id="S2.SS3.p2.4.m1.1a"><msubsup id="S2.SS3.p2.4.m1.1.1" xref="S2.SS3.p2.4.m1.1.1.cmml"><mi id="S2.SS3.p2.4.m1.1.1.2.2" xref="S2.SS3.p2.4.m1.1.1.2.2.cmml">α</mi><mi id="S2.SS3.p2.4.m1.1.1.2.3" xref="S2.SS3.p2.4.m1.1.1.2.3.cmml">δ</mi><mo id="S2.SS3.p2.4.m1.1.1.3" xref="S2.SS3.p2.4.m1.1.1.3.cmml">⊤</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m1.1b"><apply id="S2.SS3.p2.4.m1.1.1.cmml" xref="S2.SS3.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m1.1.1.1.cmml" xref="S2.SS3.p2.4.m1.1.1">superscript</csymbol><apply id="S2.SS3.p2.4.m1.1.1.2.cmml" xref="S2.SS3.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m1.1.1.2.1.cmml" xref="S2.SS3.p2.4.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.4.m1.1.1.2.2.cmml" xref="S2.SS3.p2.4.m1.1.1.2.2">𝛼</ci><ci id="S2.SS3.p2.4.m1.1.1.2.3.cmml" xref="S2.SS3.p2.4.m1.1.1.2.3">𝛿</ci></apply><csymbol cd="latexml" id="S2.SS3.p2.4.m1.1.1.3.cmml" xref="S2.SS3.p2.4.m1.1.1.3">top</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m1.1c">\alpha_{\delta}^{\top}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m1.1d">italic_α start_POSTSUBSCRIPT italic_δ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math> is the attention vector, and <math alttext="\mathcal{A}_{t}^{\delta}" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m2.1"><semantics id="S2.SS3.p2.5.m2.1a"><msubsup id="S2.SS3.p2.5.m2.1.1" xref="S2.SS3.p2.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.5.m2.1.1.2.2" xref="S2.SS3.p2.5.m2.1.1.2.2.cmml">𝒜</mi><mi id="S2.SS3.p2.5.m2.1.1.2.3" xref="S2.SS3.p2.5.m2.1.1.2.3.cmml">t</mi><mi id="S2.SS3.p2.5.m2.1.1.3" xref="S2.SS3.p2.5.m2.1.1.3.cmml">δ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m2.1b"><apply id="S2.SS3.p2.5.m2.1.1.cmml" xref="S2.SS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m2.1.1.1.cmml" xref="S2.SS3.p2.5.m2.1.1">superscript</csymbol><apply id="S2.SS3.p2.5.m2.1.1.2.cmml" xref="S2.SS3.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.5.m2.1.1.2.1.cmml" xref="S2.SS3.p2.5.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.5.m2.1.1.2.2.cmml" xref="S2.SS3.p2.5.m2.1.1.2.2">𝒜</ci><ci id="S2.SS3.p2.5.m2.1.1.2.3.cmml" xref="S2.SS3.p2.5.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p2.5.m2.1.1.3.cmml" xref="S2.SS3.p2.5.m2.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m2.1c">\mathcal{A}_{t}^{\delta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m2.1d">caligraphic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT</annotation></semantics></math> represents each feature set. Then feature embeddings <math alttext="f_{t}^{\delta}" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m3.1"><semantics id="S2.SS3.p2.6.m3.1a"><msubsup id="S2.SS3.p2.6.m3.1.1" xref="S2.SS3.p2.6.m3.1.1.cmml"><mi id="S2.SS3.p2.6.m3.1.1.2.2" xref="S2.SS3.p2.6.m3.1.1.2.2.cmml">f</mi><mi id="S2.SS3.p2.6.m3.1.1.2.3" xref="S2.SS3.p2.6.m3.1.1.2.3.cmml">t</mi><mi id="S2.SS3.p2.6.m3.1.1.3" xref="S2.SS3.p2.6.m3.1.1.3.cmml">δ</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m3.1b"><apply id="S2.SS3.p2.6.m3.1.1.cmml" xref="S2.SS3.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m3.1.1.1.cmml" xref="S2.SS3.p2.6.m3.1.1">superscript</csymbol><apply id="S2.SS3.p2.6.m3.1.1.2.cmml" xref="S2.SS3.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.6.m3.1.1.2.1.cmml" xref="S2.SS3.p2.6.m3.1.1">subscript</csymbol><ci id="S2.SS3.p2.6.m3.1.1.2.2.cmml" xref="S2.SS3.p2.6.m3.1.1.2.2">𝑓</ci><ci id="S2.SS3.p2.6.m3.1.1.2.3.cmml" xref="S2.SS3.p2.6.m3.1.1.2.3">𝑡</ci></apply><ci id="S2.SS3.p2.6.m3.1.1.3.cmml" xref="S2.SS3.p2.6.m3.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.6.m3.1c">f_{t}^{\delta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.6.m3.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT</annotation></semantics></math> can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{t}^{\delta}=\sum_{i=1}^{\lvert\mathcal{A}_{t}^{\delta}\rvert}\mu_{i}z_{i}^{\delta}" class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.2" xref="S2.E4.m1.1.2.cmml"><msubsup id="S2.E4.m1.1.2.2" xref="S2.E4.m1.1.2.2.cmml"><mi id="S2.E4.m1.1.2.2.2.2" xref="S2.E4.m1.1.2.2.2.2.cmml">f</mi><mi id="S2.E4.m1.1.2.2.2.3" xref="S2.E4.m1.1.2.2.2.3.cmml">t</mi><mi id="S2.E4.m1.1.2.2.3" xref="S2.E4.m1.1.2.2.3.cmml">δ</mi></msubsup><mo id="S2.E4.m1.1.2.1" rspace="0.111em" xref="S2.E4.m1.1.2.1.cmml">=</mo><mrow id="S2.E4.m1.1.2.3" xref="S2.E4.m1.1.2.3.cmml"><munderover id="S2.E4.m1.1.2.3.1" xref="S2.E4.m1.1.2.3.1.cmml"><mo id="S2.E4.m1.1.2.3.1.2.2" movablelimits="false" xref="S2.E4.m1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S2.E4.m1.1.2.3.1.2.3" xref="S2.E4.m1.1.2.3.1.2.3.cmml"><mi id="S2.E4.m1.1.2.3.1.2.3.2" xref="S2.E4.m1.1.2.3.1.2.3.2.cmml">i</mi><mo id="S2.E4.m1.1.2.3.1.2.3.1" xref="S2.E4.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S2.E4.m1.1.2.3.1.2.3.3" xref="S2.E4.m1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.2.cmml"><mo id="S2.E4.m1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.2.1.cmml">|</mo><msubsup id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.1.2.2.cmml">𝒜</mi><mi id="S2.E4.m1.1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.1.2.3.cmml">t</mi><mi id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml">δ</mi></msubsup><mo id="S2.E4.m1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S2.E4.m1.1.2.3.2" xref="S2.E4.m1.1.2.3.2.cmml"><msub id="S2.E4.m1.1.2.3.2.2" xref="S2.E4.m1.1.2.3.2.2.cmml"><mi id="S2.E4.m1.1.2.3.2.2.2" xref="S2.E4.m1.1.2.3.2.2.2.cmml">μ</mi><mi id="S2.E4.m1.1.2.3.2.2.3" xref="S2.E4.m1.1.2.3.2.2.3.cmml">i</mi></msub><mo id="S2.E4.m1.1.2.3.2.1" xref="S2.E4.m1.1.2.3.2.1.cmml">⁢</mo><msubsup id="S2.E4.m1.1.2.3.2.3" xref="S2.E4.m1.1.2.3.2.3.cmml"><mi id="S2.E4.m1.1.2.3.2.3.2.2" xref="S2.E4.m1.1.2.3.2.3.2.2.cmml">z</mi><mi id="S2.E4.m1.1.2.3.2.3.2.3" xref="S2.E4.m1.1.2.3.2.3.2.3.cmml">i</mi><mi id="S2.E4.m1.1.2.3.2.3.3" xref="S2.E4.m1.1.2.3.2.3.3.cmml">δ</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.2.cmml" xref="S2.E4.m1.1.2"><eq id="S2.E4.m1.1.2.1.cmml" xref="S2.E4.m1.1.2.1"></eq><apply id="S2.E4.m1.1.2.2.cmml" xref="S2.E4.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.2.1.cmml" xref="S2.E4.m1.1.2.2">superscript</csymbol><apply id="S2.E4.m1.1.2.2.2.cmml" xref="S2.E4.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.2.2.1.cmml" xref="S2.E4.m1.1.2.2">subscript</csymbol><ci id="S2.E4.m1.1.2.2.2.2.cmml" xref="S2.E4.m1.1.2.2.2.2">𝑓</ci><ci id="S2.E4.m1.1.2.2.2.3.cmml" xref="S2.E4.m1.1.2.2.2.3">𝑡</ci></apply><ci id="S2.E4.m1.1.2.2.3.cmml" xref="S2.E4.m1.1.2.2.3">𝛿</ci></apply><apply id="S2.E4.m1.1.2.3.cmml" xref="S2.E4.m1.1.2.3"><apply id="S2.E4.m1.1.2.3.1.cmml" xref="S2.E4.m1.1.2.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.3.1.1.cmml" xref="S2.E4.m1.1.2.3.1">superscript</csymbol><apply id="S2.E4.m1.1.2.3.1.2.cmml" xref="S2.E4.m1.1.2.3.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.3.1.2.1.cmml" xref="S2.E4.m1.1.2.3.1">subscript</csymbol><sum id="S2.E4.m1.1.2.3.1.2.2.cmml" xref="S2.E4.m1.1.2.3.1.2.2"></sum><apply id="S2.E4.m1.1.2.3.1.2.3.cmml" xref="S2.E4.m1.1.2.3.1.2.3"><eq id="S2.E4.m1.1.2.3.1.2.3.1.cmml" xref="S2.E4.m1.1.2.3.1.2.3.1"></eq><ci id="S2.E4.m1.1.2.3.1.2.3.2.cmml" xref="S2.E4.m1.1.2.3.1.2.3.2">𝑖</ci><cn id="S2.E4.m1.1.2.3.1.2.3.3.cmml" type="integer" xref="S2.E4.m1.1.2.3.1.2.3.3">1</cn></apply></apply><apply id="S2.E4.m1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1"><abs id="S2.E4.m1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2"></abs><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2.2">𝒜</ci><ci id="S2.E4.m1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3">𝛿</ci></apply></apply></apply><apply id="S2.E4.m1.1.2.3.2.cmml" xref="S2.E4.m1.1.2.3.2"><times id="S2.E4.m1.1.2.3.2.1.cmml" xref="S2.E4.m1.1.2.3.2.1"></times><apply id="S2.E4.m1.1.2.3.2.2.cmml" xref="S2.E4.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.3.2.2.1.cmml" xref="S2.E4.m1.1.2.3.2.2">subscript</csymbol><ci id="S2.E4.m1.1.2.3.2.2.2.cmml" xref="S2.E4.m1.1.2.3.2.2.2">𝜇</ci><ci id="S2.E4.m1.1.2.3.2.2.3.cmml" xref="S2.E4.m1.1.2.3.2.2.3">𝑖</ci></apply><apply id="S2.E4.m1.1.2.3.2.3.cmml" xref="S2.E4.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.3.2.3.1.cmml" xref="S2.E4.m1.1.2.3.2.3">superscript</csymbol><apply id="S2.E4.m1.1.2.3.2.3.2.cmml" xref="S2.E4.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.2.3.2.3.2.1.cmml" xref="S2.E4.m1.1.2.3.2.3">subscript</csymbol><ci id="S2.E4.m1.1.2.3.2.3.2.2.cmml" xref="S2.E4.m1.1.2.3.2.3.2.2">𝑧</ci><ci id="S2.E4.m1.1.2.3.2.3.2.3.cmml" xref="S2.E4.m1.1.2.3.2.3.2.3">𝑖</ci></apply><ci id="S2.E4.m1.1.2.3.2.3.3.cmml" xref="S2.E4.m1.1.2.3.2.3.3">𝛿</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">f_{t}^{\delta}=\sum_{i=1}^{\lvert\mathcal{A}_{t}^{\delta}\rvert}\mu_{i}z_{i}^{\delta}</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">italic_f start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_A start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT | end_POSTSUPERSCRIPT italic_μ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_δ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.4">This module finally produces the semantics-enhanced feature embeddings, including price embedding set <math alttext="H_{p}=[h_{1}^{p},\ldots,h_{m_{p}}^{p}]" class="ltx_Math" display="inline" id="S2.SS3.p3.1.m1.3"><semantics id="S2.SS3.p3.1.m1.3a"><mrow id="S2.SS3.p3.1.m1.3.3" xref="S2.SS3.p3.1.m1.3.3.cmml"><msub id="S2.SS3.p3.1.m1.3.3.4" xref="S2.SS3.p3.1.m1.3.3.4.cmml"><mi id="S2.SS3.p3.1.m1.3.3.4.2" xref="S2.SS3.p3.1.m1.3.3.4.2.cmml">H</mi><mi id="S2.SS3.p3.1.m1.3.3.4.3" xref="S2.SS3.p3.1.m1.3.3.4.3.cmml">p</mi></msub><mo id="S2.SS3.p3.1.m1.3.3.3" xref="S2.SS3.p3.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS3.p3.1.m1.3.3.2.2" xref="S2.SS3.p3.1.m1.3.3.2.3.cmml"><mo id="S2.SS3.p3.1.m1.3.3.2.2.3" stretchy="false" xref="S2.SS3.p3.1.m1.3.3.2.3.cmml">[</mo><msubsup id="S2.SS3.p3.1.m1.2.2.1.1.1" xref="S2.SS3.p3.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS3.p3.1.m1.2.2.1.1.1.2.2" xref="S2.SS3.p3.1.m1.2.2.1.1.1.2.2.cmml">h</mi><mn id="S2.SS3.p3.1.m1.2.2.1.1.1.2.3" xref="S2.SS3.p3.1.m1.2.2.1.1.1.2.3.cmml">1</mn><mi id="S2.SS3.p3.1.m1.2.2.1.1.1.3" xref="S2.SS3.p3.1.m1.2.2.1.1.1.3.cmml">p</mi></msubsup><mo id="S2.SS3.p3.1.m1.3.3.2.2.4" xref="S2.SS3.p3.1.m1.3.3.2.3.cmml">,</mo><mi id="S2.SS3.p3.1.m1.1.1" mathvariant="normal" xref="S2.SS3.p3.1.m1.1.1.cmml">…</mi><mo id="S2.SS3.p3.1.m1.3.3.2.2.5" xref="S2.SS3.p3.1.m1.3.3.2.3.cmml">,</mo><msubsup id="S2.SS3.p3.1.m1.3.3.2.2.2" xref="S2.SS3.p3.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS3.p3.1.m1.3.3.2.2.2.2.2" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.2.cmml">h</mi><msub id="S2.SS3.p3.1.m1.3.3.2.2.2.2.3" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.cmml"><mi id="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.2" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.2.cmml">m</mi><mi id="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.3" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.3.cmml">p</mi></msub><mi id="S2.SS3.p3.1.m1.3.3.2.2.2.3" xref="S2.SS3.p3.1.m1.3.3.2.2.2.3.cmml">p</mi></msubsup><mo id="S2.SS3.p3.1.m1.3.3.2.2.6" stretchy="false" xref="S2.SS3.p3.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.3b"><apply id="S2.SS3.p3.1.m1.3.3.cmml" xref="S2.SS3.p3.1.m1.3.3"><eq id="S2.SS3.p3.1.m1.3.3.3.cmml" xref="S2.SS3.p3.1.m1.3.3.3"></eq><apply id="S2.SS3.p3.1.m1.3.3.4.cmml" xref="S2.SS3.p3.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.3.4.1.cmml" xref="S2.SS3.p3.1.m1.3.3.4">subscript</csymbol><ci id="S2.SS3.p3.1.m1.3.3.4.2.cmml" xref="S2.SS3.p3.1.m1.3.3.4.2">𝐻</ci><ci id="S2.SS3.p3.1.m1.3.3.4.3.cmml" xref="S2.SS3.p3.1.m1.3.3.4.3">𝑝</ci></apply><list id="S2.SS3.p3.1.m1.3.3.2.3.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2"><apply id="S2.SS3.p3.1.m1.2.2.1.1.1.cmml" xref="S2.SS3.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.p3.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S2.SS3.p3.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS3.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p3.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS3.p3.1.m1.2.2.1.1.1.2.2">ℎ</ci><cn id="S2.SS3.p3.1.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS3.p3.1.m1.2.2.1.1.1.2.3">1</cn></apply><ci id="S2.SS3.p3.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS3.p3.1.m1.2.2.1.1.1.3">𝑝</ci></apply><ci id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">…</ci><apply id="S2.SS3.p3.1.m1.3.3.2.2.2.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S2.SS3.p3.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p3.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.2">ℎ</ci><apply id="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.1.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.3">subscript</csymbol><ci id="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.2.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.2">𝑚</ci><ci id="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.3.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2.2.3.3">𝑝</ci></apply></apply><ci id="S2.SS3.p3.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS3.p3.1.m1.3.3.2.2.2.3">𝑝</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.3c">H_{p}=[h_{1}^{p},\ldots,h_{m_{p}}^{p}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.m1.3d">italic_H start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = [ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ]</annotation></semantics></math>, the ID embedding set <math alttext="H_{d}=[h_{1}^{d},\ldots,h_{m_{d}}^{d}]" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m2.3"><semantics id="S2.SS3.p3.2.m2.3a"><mrow id="S2.SS3.p3.2.m2.3.3" xref="S2.SS3.p3.2.m2.3.3.cmml"><msub id="S2.SS3.p3.2.m2.3.3.4" xref="S2.SS3.p3.2.m2.3.3.4.cmml"><mi id="S2.SS3.p3.2.m2.3.3.4.2" xref="S2.SS3.p3.2.m2.3.3.4.2.cmml">H</mi><mi id="S2.SS3.p3.2.m2.3.3.4.3" xref="S2.SS3.p3.2.m2.3.3.4.3.cmml">d</mi></msub><mo id="S2.SS3.p3.2.m2.3.3.3" xref="S2.SS3.p3.2.m2.3.3.3.cmml">=</mo><mrow id="S2.SS3.p3.2.m2.3.3.2.2" xref="S2.SS3.p3.2.m2.3.3.2.3.cmml"><mo id="S2.SS3.p3.2.m2.3.3.2.2.3" stretchy="false" xref="S2.SS3.p3.2.m2.3.3.2.3.cmml">[</mo><msubsup id="S2.SS3.p3.2.m2.2.2.1.1.1" xref="S2.SS3.p3.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS3.p3.2.m2.2.2.1.1.1.2.2" xref="S2.SS3.p3.2.m2.2.2.1.1.1.2.2.cmml">h</mi><mn id="S2.SS3.p3.2.m2.2.2.1.1.1.2.3" xref="S2.SS3.p3.2.m2.2.2.1.1.1.2.3.cmml">1</mn><mi id="S2.SS3.p3.2.m2.2.2.1.1.1.3" xref="S2.SS3.p3.2.m2.2.2.1.1.1.3.cmml">d</mi></msubsup><mo id="S2.SS3.p3.2.m2.3.3.2.2.4" xref="S2.SS3.p3.2.m2.3.3.2.3.cmml">,</mo><mi id="S2.SS3.p3.2.m2.1.1" mathvariant="normal" xref="S2.SS3.p3.2.m2.1.1.cmml">…</mi><mo id="S2.SS3.p3.2.m2.3.3.2.2.5" xref="S2.SS3.p3.2.m2.3.3.2.3.cmml">,</mo><msubsup id="S2.SS3.p3.2.m2.3.3.2.2.2" xref="S2.SS3.p3.2.m2.3.3.2.2.2.cmml"><mi id="S2.SS3.p3.2.m2.3.3.2.2.2.2.2" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.2.cmml">h</mi><msub id="S2.SS3.p3.2.m2.3.3.2.2.2.2.3" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.cmml"><mi id="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.2" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.2.cmml">m</mi><mi id="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.3" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.3.cmml">d</mi></msub><mi id="S2.SS3.p3.2.m2.3.3.2.2.2.3" xref="S2.SS3.p3.2.m2.3.3.2.2.2.3.cmml">d</mi></msubsup><mo id="S2.SS3.p3.2.m2.3.3.2.2.6" stretchy="false" xref="S2.SS3.p3.2.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.3b"><apply id="S2.SS3.p3.2.m2.3.3.cmml" xref="S2.SS3.p3.2.m2.3.3"><eq id="S2.SS3.p3.2.m2.3.3.3.cmml" xref="S2.SS3.p3.2.m2.3.3.3"></eq><apply id="S2.SS3.p3.2.m2.3.3.4.cmml" xref="S2.SS3.p3.2.m2.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.3.3.4.1.cmml" xref="S2.SS3.p3.2.m2.3.3.4">subscript</csymbol><ci id="S2.SS3.p3.2.m2.3.3.4.2.cmml" xref="S2.SS3.p3.2.m2.3.3.4.2">𝐻</ci><ci id="S2.SS3.p3.2.m2.3.3.4.3.cmml" xref="S2.SS3.p3.2.m2.3.3.4.3">𝑑</ci></apply><list id="S2.SS3.p3.2.m2.3.3.2.3.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2"><apply id="S2.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S2.SS3.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS3.p3.2.m2.2.2.1.1.1">superscript</csymbol><apply id="S2.SS3.p3.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS3.p3.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.2.2.1.1.1.2.1.cmml" xref="S2.SS3.p3.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p3.2.m2.2.2.1.1.1.2.2.cmml" xref="S2.SS3.p3.2.m2.2.2.1.1.1.2.2">ℎ</ci><cn id="S2.SS3.p3.2.m2.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS3.p3.2.m2.2.2.1.1.1.2.3">1</cn></apply><ci id="S2.SS3.p3.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS3.p3.2.m2.2.2.1.1.1.3">𝑑</ci></apply><ci id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">…</ci><apply id="S2.SS3.p3.2.m2.3.3.2.2.2.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2">superscript</csymbol><apply id="S2.SS3.p3.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.3.3.2.2.2.2.1.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p3.2.m2.3.3.2.2.2.2.2.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.2">ℎ</ci><apply id="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.1.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.3">subscript</csymbol><ci id="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.2.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.2">𝑚</ci><ci id="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.3.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2.2.3.3">𝑑</ci></apply></apply><ci id="S2.SS3.p3.2.m2.3.3.2.2.2.3.cmml" xref="S2.SS3.p3.2.m2.3.3.2.2.2.3">𝑑</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.3c">H_{d}=[h_{1}^{d},\ldots,h_{m_{d}}^{d}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m2.3d">italic_H start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = [ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ]</annotation></semantics></math>, and the category embedding set <math alttext="H_{c}=[h_{1}^{c},\ldots,h_{m_{c}}^{c}]" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m3.3"><semantics id="S2.SS3.p3.3.m3.3a"><mrow id="S2.SS3.p3.3.m3.3.3" xref="S2.SS3.p3.3.m3.3.3.cmml"><msub id="S2.SS3.p3.3.m3.3.3.4" xref="S2.SS3.p3.3.m3.3.3.4.cmml"><mi id="S2.SS3.p3.3.m3.3.3.4.2" xref="S2.SS3.p3.3.m3.3.3.4.2.cmml">H</mi><mi id="S2.SS3.p3.3.m3.3.3.4.3" xref="S2.SS3.p3.3.m3.3.3.4.3.cmml">c</mi></msub><mo id="S2.SS3.p3.3.m3.3.3.3" xref="S2.SS3.p3.3.m3.3.3.3.cmml">=</mo><mrow id="S2.SS3.p3.3.m3.3.3.2.2" xref="S2.SS3.p3.3.m3.3.3.2.3.cmml"><mo id="S2.SS3.p3.3.m3.3.3.2.2.3" stretchy="false" xref="S2.SS3.p3.3.m3.3.3.2.3.cmml">[</mo><msubsup id="S2.SS3.p3.3.m3.2.2.1.1.1" xref="S2.SS3.p3.3.m3.2.2.1.1.1.cmml"><mi id="S2.SS3.p3.3.m3.2.2.1.1.1.2.2" xref="S2.SS3.p3.3.m3.2.2.1.1.1.2.2.cmml">h</mi><mn id="S2.SS3.p3.3.m3.2.2.1.1.1.2.3" xref="S2.SS3.p3.3.m3.2.2.1.1.1.2.3.cmml">1</mn><mi id="S2.SS3.p3.3.m3.2.2.1.1.1.3" xref="S2.SS3.p3.3.m3.2.2.1.1.1.3.cmml">c</mi></msubsup><mo id="S2.SS3.p3.3.m3.3.3.2.2.4" xref="S2.SS3.p3.3.m3.3.3.2.3.cmml">,</mo><mi id="S2.SS3.p3.3.m3.1.1" mathvariant="normal" xref="S2.SS3.p3.3.m3.1.1.cmml">…</mi><mo id="S2.SS3.p3.3.m3.3.3.2.2.5" xref="S2.SS3.p3.3.m3.3.3.2.3.cmml">,</mo><msubsup id="S2.SS3.p3.3.m3.3.3.2.2.2" xref="S2.SS3.p3.3.m3.3.3.2.2.2.cmml"><mi id="S2.SS3.p3.3.m3.3.3.2.2.2.2.2" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.2.cmml">h</mi><msub id="S2.SS3.p3.3.m3.3.3.2.2.2.2.3" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.cmml"><mi id="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.2" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.2.cmml">m</mi><mi id="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.3" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.3.cmml">c</mi></msub><mi id="S2.SS3.p3.3.m3.3.3.2.2.2.3" xref="S2.SS3.p3.3.m3.3.3.2.2.2.3.cmml">c</mi></msubsup><mo id="S2.SS3.p3.3.m3.3.3.2.2.6" stretchy="false" xref="S2.SS3.p3.3.m3.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.3b"><apply id="S2.SS3.p3.3.m3.3.3.cmml" xref="S2.SS3.p3.3.m3.3.3"><eq id="S2.SS3.p3.3.m3.3.3.3.cmml" xref="S2.SS3.p3.3.m3.3.3.3"></eq><apply id="S2.SS3.p3.3.m3.3.3.4.cmml" xref="S2.SS3.p3.3.m3.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.3.3.4.1.cmml" xref="S2.SS3.p3.3.m3.3.3.4">subscript</csymbol><ci id="S2.SS3.p3.3.m3.3.3.4.2.cmml" xref="S2.SS3.p3.3.m3.3.3.4.2">𝐻</ci><ci id="S2.SS3.p3.3.m3.3.3.4.3.cmml" xref="S2.SS3.p3.3.m3.3.3.4.3">𝑐</ci></apply><list id="S2.SS3.p3.3.m3.3.3.2.3.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2"><apply id="S2.SS3.p3.3.m3.2.2.1.1.1.cmml" xref="S2.SS3.p3.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.2.2.1.1.1.1.cmml" xref="S2.SS3.p3.3.m3.2.2.1.1.1">superscript</csymbol><apply id="S2.SS3.p3.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS3.p3.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.2.2.1.1.1.2.1.cmml" xref="S2.SS3.p3.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p3.3.m3.2.2.1.1.1.2.2.cmml" xref="S2.SS3.p3.3.m3.2.2.1.1.1.2.2">ℎ</ci><cn id="S2.SS3.p3.3.m3.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS3.p3.3.m3.2.2.1.1.1.2.3">1</cn></apply><ci id="S2.SS3.p3.3.m3.2.2.1.1.1.3.cmml" xref="S2.SS3.p3.3.m3.2.2.1.1.1.3">𝑐</ci></apply><ci id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">…</ci><apply id="S2.SS3.p3.3.m3.3.3.2.2.2.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.3.3.2.2.2.1.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2">superscript</csymbol><apply id="S2.SS3.p3.3.m3.3.3.2.2.2.2.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.3.3.2.2.2.2.1.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p3.3.m3.3.3.2.2.2.2.2.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.2">ℎ</ci><apply id="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.1.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.3">subscript</csymbol><ci id="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.2.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.2">𝑚</ci><ci id="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.3.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2.2.3.3">𝑐</ci></apply></apply><ci id="S2.SS3.p3.3.m3.3.3.2.2.2.3.cmml" xref="S2.SS3.p3.3.m3.3.3.2.2.2.3">𝑐</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.3c">H_{c}=[h_{1}^{c},\ldots,h_{m_{c}}^{c}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m3.3d">italic_H start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = [ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_m start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_c end_POSTSUPERSCRIPT ]</annotation></semantics></math>. For simplicity, we use <math alttext="H_{t}=[h_{1}^{t},\ldots,h_{l}^{t}]" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m4.3"><semantics id="S2.SS3.p3.4.m4.3a"><mrow id="S2.SS3.p3.4.m4.3.3" xref="S2.SS3.p3.4.m4.3.3.cmml"><msub id="S2.SS3.p3.4.m4.3.3.4" xref="S2.SS3.p3.4.m4.3.3.4.cmml"><mi id="S2.SS3.p3.4.m4.3.3.4.2" xref="S2.SS3.p3.4.m4.3.3.4.2.cmml">H</mi><mi id="S2.SS3.p3.4.m4.3.3.4.3" xref="S2.SS3.p3.4.m4.3.3.4.3.cmml">t</mi></msub><mo id="S2.SS3.p3.4.m4.3.3.3" xref="S2.SS3.p3.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS3.p3.4.m4.3.3.2.2" xref="S2.SS3.p3.4.m4.3.3.2.3.cmml"><mo id="S2.SS3.p3.4.m4.3.3.2.2.3" stretchy="false" xref="S2.SS3.p3.4.m4.3.3.2.3.cmml">[</mo><msubsup id="S2.SS3.p3.4.m4.2.2.1.1.1" xref="S2.SS3.p3.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS3.p3.4.m4.2.2.1.1.1.2.2" xref="S2.SS3.p3.4.m4.2.2.1.1.1.2.2.cmml">h</mi><mn id="S2.SS3.p3.4.m4.2.2.1.1.1.2.3" xref="S2.SS3.p3.4.m4.2.2.1.1.1.2.3.cmml">1</mn><mi id="S2.SS3.p3.4.m4.2.2.1.1.1.3" xref="S2.SS3.p3.4.m4.2.2.1.1.1.3.cmml">t</mi></msubsup><mo id="S2.SS3.p3.4.m4.3.3.2.2.4" xref="S2.SS3.p3.4.m4.3.3.2.3.cmml">,</mo><mi id="S2.SS3.p3.4.m4.1.1" mathvariant="normal" xref="S2.SS3.p3.4.m4.1.1.cmml">…</mi><mo id="S2.SS3.p3.4.m4.3.3.2.2.5" xref="S2.SS3.p3.4.m4.3.3.2.3.cmml">,</mo><msubsup id="S2.SS3.p3.4.m4.3.3.2.2.2" xref="S2.SS3.p3.4.m4.3.3.2.2.2.cmml"><mi id="S2.SS3.p3.4.m4.3.3.2.2.2.2.2" xref="S2.SS3.p3.4.m4.3.3.2.2.2.2.2.cmml">h</mi><mi id="S2.SS3.p3.4.m4.3.3.2.2.2.2.3" xref="S2.SS3.p3.4.m4.3.3.2.2.2.2.3.cmml">l</mi><mi id="S2.SS3.p3.4.m4.3.3.2.2.2.3" xref="S2.SS3.p3.4.m4.3.3.2.2.2.3.cmml">t</mi></msubsup><mo id="S2.SS3.p3.4.m4.3.3.2.2.6" stretchy="false" xref="S2.SS3.p3.4.m4.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.3b"><apply id="S2.SS3.p3.4.m4.3.3.cmml" xref="S2.SS3.p3.4.m4.3.3"><eq id="S2.SS3.p3.4.m4.3.3.3.cmml" xref="S2.SS3.p3.4.m4.3.3.3"></eq><apply id="S2.SS3.p3.4.m4.3.3.4.cmml" xref="S2.SS3.p3.4.m4.3.3.4"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.3.3.4.1.cmml" xref="S2.SS3.p3.4.m4.3.3.4">subscript</csymbol><ci id="S2.SS3.p3.4.m4.3.3.4.2.cmml" xref="S2.SS3.p3.4.m4.3.3.4.2">𝐻</ci><ci id="S2.SS3.p3.4.m4.3.3.4.3.cmml" xref="S2.SS3.p3.4.m4.3.3.4.3">𝑡</ci></apply><list id="S2.SS3.p3.4.m4.3.3.2.3.cmml" xref="S2.SS3.p3.4.m4.3.3.2.2"><apply id="S2.SS3.p3.4.m4.2.2.1.1.1.cmml" xref="S2.SS3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS3.p3.4.m4.2.2.1.1.1">superscript</csymbol><apply id="S2.SS3.p3.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.2.2.1.1.1.2.1.cmml" xref="S2.SS3.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p3.4.m4.2.2.1.1.1.2.2.cmml" xref="S2.SS3.p3.4.m4.2.2.1.1.1.2.2">ℎ</ci><cn id="S2.SS3.p3.4.m4.2.2.1.1.1.2.3.cmml" type="integer" xref="S2.SS3.p3.4.m4.2.2.1.1.1.2.3">1</cn></apply><ci id="S2.SS3.p3.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS3.p3.4.m4.2.2.1.1.1.3">𝑡</ci></apply><ci id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">…</ci><apply id="S2.SS3.p3.4.m4.3.3.2.2.2.cmml" xref="S2.SS3.p3.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS3.p3.4.m4.3.3.2.2.2">superscript</csymbol><apply id="S2.SS3.p3.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS3.p3.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.3.3.2.2.2.2.1.cmml" xref="S2.SS3.p3.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S2.SS3.p3.4.m4.3.3.2.2.2.2.2.cmml" xref="S2.SS3.p3.4.m4.3.3.2.2.2.2.2">ℎ</ci><ci id="S2.SS3.p3.4.m4.3.3.2.2.2.2.3.cmml" xref="S2.SS3.p3.4.m4.3.3.2.2.2.2.3">𝑙</ci></apply><ci id="S2.SS3.p3.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS3.p3.4.m4.3.3.2.2.2.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.3c">H_{t}=[h_{1}^{t},\ldots,h_{l}^{t}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m4.3d">italic_H start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = [ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ]</annotation></semantics></math> for subsequent operations.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS4.4.1.1">II-D</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS4.5.2">Basket-guided Dynamic Augmentation Networks</span>
</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1">The unified hybrid encoder captures complex global node relationships but struggles with dynamic user behavior. To address this, we introduce a basket-guided dynamic learning mechanism to enhance node embeddings. This approach maintains the global context while effectively learning local information, better adapting to individual basket sequences and user preferences.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.3">Given that items within the same basket can reflect user preferences in general, we apply average pooling to aggregate their feature embeddings in each basket:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="v_{B_{i}}^{t}=tanh(\frac{1}{l}\sum_{t=1}^{l}concat[h_{1}^{t},...,h_{l}^{t}])" class="ltx_Math" display="block" id="S2.E5.m1.2"><semantics id="S2.E5.m1.2a"><mrow id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml"><msubsup id="S2.E5.m1.2.2.3" xref="S2.E5.m1.2.2.3.cmml"><mi id="S2.E5.m1.2.2.3.2.2" xref="S2.E5.m1.2.2.3.2.2.cmml">v</mi><msub id="S2.E5.m1.2.2.3.2.3" xref="S2.E5.m1.2.2.3.2.3.cmml"><mi id="S2.E5.m1.2.2.3.2.3.2" xref="S2.E5.m1.2.2.3.2.3.2.cmml">B</mi><mi id="S2.E5.m1.2.2.3.2.3.3" xref="S2.E5.m1.2.2.3.2.3.3.cmml">i</mi></msub><mi id="S2.E5.m1.2.2.3.3" xref="S2.E5.m1.2.2.3.3.cmml">t</mi></msubsup><mo id="S2.E5.m1.2.2.2" xref="S2.E5.m1.2.2.2.cmml">=</mo><mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.cmml"><mi id="S2.E5.m1.2.2.1.3" xref="S2.E5.m1.2.2.1.3.cmml">t</mi><mo id="S2.E5.m1.2.2.1.2" xref="S2.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S2.E5.m1.2.2.1.4" xref="S2.E5.m1.2.2.1.4.cmml">a</mi><mo id="S2.E5.m1.2.2.1.2a" xref="S2.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S2.E5.m1.2.2.1.5" xref="S2.E5.m1.2.2.1.5.cmml">n</mi><mo id="S2.E5.m1.2.2.1.2b" xref="S2.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S2.E5.m1.2.2.1.6" xref="S2.E5.m1.2.2.1.6.cmml">h</mi><mo id="S2.E5.m1.2.2.1.2c" xref="S2.E5.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mo id="S2.E5.m1.2.2.1.1.1.2" stretchy="false" xref="S2.E5.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.2.2.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.cmml"><mfrac id="S2.E5.m1.2.2.1.1.1.1.4" xref="S2.E5.m1.2.2.1.1.1.1.4.cmml"><mn id="S2.E5.m1.2.2.1.1.1.1.4.2" xref="S2.E5.m1.2.2.1.1.1.1.4.2.cmml">1</mn><mi id="S2.E5.m1.2.2.1.1.1.1.4.3" xref="S2.E5.m1.2.2.1.1.1.1.4.3.cmml">l</mi></mfrac><mo id="S2.E5.m1.2.2.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.1.1.1.1.2" xref="S2.E5.m1.2.2.1.1.1.1.2.cmml"><munderover id="S2.E5.m1.2.2.1.1.1.1.2.3" xref="S2.E5.m1.2.2.1.1.1.1.2.3.cmml"><mo id="S2.E5.m1.2.2.1.1.1.1.2.3.2.2" movablelimits="false" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S2.E5.m1.2.2.1.1.1.1.2.3.2.3" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.cmml"><mi id="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.2" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.2.cmml">t</mi><mo id="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.1" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.3" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E5.m1.2.2.1.1.1.1.2.3.3" xref="S2.E5.m1.2.2.1.1.1.1.2.3.3.cmml">l</mi></munderover><mrow id="S2.E5.m1.2.2.1.1.1.1.2.2" xref="S2.E5.m1.2.2.1.1.1.1.2.2.cmml"><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.4" xref="S2.E5.m1.2.2.1.1.1.1.2.2.4.cmml">c</mi><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.3" xref="S2.E5.m1.2.2.1.1.1.1.2.2.3.cmml">⁢</mo><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.5" xref="S2.E5.m1.2.2.1.1.1.1.2.2.5.cmml">o</mi><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.3a" xref="S2.E5.m1.2.2.1.1.1.1.2.2.3.cmml">⁢</mo><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.6" xref="S2.E5.m1.2.2.1.1.1.1.2.2.6.cmml">n</mi><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.3b" xref="S2.E5.m1.2.2.1.1.1.1.2.2.3.cmml">⁢</mo><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.7" xref="S2.E5.m1.2.2.1.1.1.1.2.2.7.cmml">c</mi><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.3c" xref="S2.E5.m1.2.2.1.1.1.1.2.2.3.cmml">⁢</mo><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.8" xref="S2.E5.m1.2.2.1.1.1.1.2.2.8.cmml">a</mi><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.3d" xref="S2.E5.m1.2.2.1.1.1.1.2.2.3.cmml">⁢</mo><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.9" xref="S2.E5.m1.2.2.1.1.1.1.2.2.9.cmml">t</mi><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.3e" xref="S2.E5.m1.2.2.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.3.cmml"><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.3.cmml">[</mo><msubsup id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">h</mi><mn id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">1</mn><mi id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.4" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.3.cmml">,</mo><mi id="S2.E5.m1.1.1" mathvariant="normal" xref="S2.E5.m1.1.1.cmml">…</mi><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.5" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.cmml"><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.2.cmml">h</mi><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.3" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.3.cmml">l</mi><mi id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.3" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.6" stretchy="false" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.3.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.2.2.1.1.1.3" stretchy="false" xref="S2.E5.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"><eq id="S2.E5.m1.2.2.2.cmml" xref="S2.E5.m1.2.2.2"></eq><apply id="S2.E5.m1.2.2.3.cmml" xref="S2.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.3.1.cmml" xref="S2.E5.m1.2.2.3">superscript</csymbol><apply id="S2.E5.m1.2.2.3.2.cmml" xref="S2.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.3.2.1.cmml" xref="S2.E5.m1.2.2.3">subscript</csymbol><ci id="S2.E5.m1.2.2.3.2.2.cmml" xref="S2.E5.m1.2.2.3.2.2">𝑣</ci><apply id="S2.E5.m1.2.2.3.2.3.cmml" xref="S2.E5.m1.2.2.3.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.3.2.3.1.cmml" xref="S2.E5.m1.2.2.3.2.3">subscript</csymbol><ci id="S2.E5.m1.2.2.3.2.3.2.cmml" xref="S2.E5.m1.2.2.3.2.3.2">𝐵</ci><ci id="S2.E5.m1.2.2.3.2.3.3.cmml" xref="S2.E5.m1.2.2.3.2.3.3">𝑖</ci></apply></apply><ci id="S2.E5.m1.2.2.3.3.cmml" xref="S2.E5.m1.2.2.3.3">𝑡</ci></apply><apply id="S2.E5.m1.2.2.1.cmml" xref="S2.E5.m1.2.2.1"><times id="S2.E5.m1.2.2.1.2.cmml" xref="S2.E5.m1.2.2.1.2"></times><ci id="S2.E5.m1.2.2.1.3.cmml" xref="S2.E5.m1.2.2.1.3">𝑡</ci><ci id="S2.E5.m1.2.2.1.4.cmml" xref="S2.E5.m1.2.2.1.4">𝑎</ci><ci id="S2.E5.m1.2.2.1.5.cmml" xref="S2.E5.m1.2.2.1.5">𝑛</ci><ci id="S2.E5.m1.2.2.1.6.cmml" xref="S2.E5.m1.2.2.1.6">ℎ</ci><apply id="S2.E5.m1.2.2.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"><times id="S2.E5.m1.2.2.1.1.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.3"></times><apply id="S2.E5.m1.2.2.1.1.1.1.4.cmml" xref="S2.E5.m1.2.2.1.1.1.1.4"><divide id="S2.E5.m1.2.2.1.1.1.1.4.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.4"></divide><cn id="S2.E5.m1.2.2.1.1.1.1.4.2.cmml" type="integer" xref="S2.E5.m1.2.2.1.1.1.1.4.2">1</cn><ci id="S2.E5.m1.2.2.1.1.1.1.4.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.4.3">𝑙</ci></apply><apply id="S2.E5.m1.2.2.1.1.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2"><apply id="S2.E5.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.2.3.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E5.m1.2.2.1.1.1.1.2.3.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.2.3.2.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3">subscript</csymbol><sum id="S2.E5.m1.2.2.1.1.1.1.2.3.2.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.2"></sum><apply id="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.3"><eq id="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.1"></eq><ci id="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.2">𝑡</ci><cn id="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.3.cmml" type="integer" xref="S2.E5.m1.2.2.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E5.m1.2.2.1.1.1.1.2.3.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.3.3">𝑙</ci></apply><apply id="S2.E5.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2"><times id="S2.E5.m1.2.2.1.1.1.1.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.3"></times><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.4.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.4">𝑐</ci><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.5.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.5">𝑜</ci><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.6.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.6">𝑛</ci><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.7.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.7">𝑐</ci><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.8.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.8">𝑎</ci><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.9.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.9">𝑡</ci><list id="S2.E5.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2"><apply id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">ℎ</ci><cn id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">1</cn></apply><ci id="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">…</ci><apply id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.2">ℎ</ci><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.2.3">𝑙</ci></apply><ci id="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E5.m1.2.2.1.1.1.1.2.2.2.2.2.3">𝑡</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">v_{B_{i}}^{t}=tanh(\frac{1}{l}\sum_{t=1}^{l}concat[h_{1}^{t},...,h_{l}^{t}])</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.2d">italic_v start_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = italic_t italic_a italic_n italic_h ( divide start_ARG 1 end_ARG start_ARG italic_l end_ARG ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT italic_c italic_o italic_n italic_c italic_a italic_t [ italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ] )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p2.2">Then we compile the feature vector
<math alttext="V^{t}=[v_{B_{1}}^{t},...,v_{B_{n}}^{t}]" class="ltx_Math" display="inline" id="S2.SS4.p2.1.m1.3"><semantics id="S2.SS4.p2.1.m1.3a"><mrow id="S2.SS4.p2.1.m1.3.3" xref="S2.SS4.p2.1.m1.3.3.cmml"><msup id="S2.SS4.p2.1.m1.3.3.4" xref="S2.SS4.p2.1.m1.3.3.4.cmml"><mi id="S2.SS4.p2.1.m1.3.3.4.2" xref="S2.SS4.p2.1.m1.3.3.4.2.cmml">V</mi><mi id="S2.SS4.p2.1.m1.3.3.4.3" xref="S2.SS4.p2.1.m1.3.3.4.3.cmml">t</mi></msup><mo id="S2.SS4.p2.1.m1.3.3.3" xref="S2.SS4.p2.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS4.p2.1.m1.3.3.2.2" xref="S2.SS4.p2.1.m1.3.3.2.3.cmml"><mo id="S2.SS4.p2.1.m1.3.3.2.2.3" stretchy="false" xref="S2.SS4.p2.1.m1.3.3.2.3.cmml">[</mo><msubsup id="S2.SS4.p2.1.m1.2.2.1.1.1" xref="S2.SS4.p2.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS4.p2.1.m1.2.2.1.1.1.2.2" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.2.cmml">v</mi><msub id="S2.SS4.p2.1.m1.2.2.1.1.1.2.3" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.cmml"><mi id="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.2" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.2.cmml">B</mi><mn id="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.3" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.3.cmml">1</mn></msub><mi id="S2.SS4.p2.1.m1.2.2.1.1.1.3" xref="S2.SS4.p2.1.m1.2.2.1.1.1.3.cmml">t</mi></msubsup><mo id="S2.SS4.p2.1.m1.3.3.2.2.4" xref="S2.SS4.p2.1.m1.3.3.2.3.cmml">,</mo><mi id="S2.SS4.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS4.p2.1.m1.1.1.cmml">…</mi><mo id="S2.SS4.p2.1.m1.3.3.2.2.5" xref="S2.SS4.p2.1.m1.3.3.2.3.cmml">,</mo><msubsup id="S2.SS4.p2.1.m1.3.3.2.2.2" xref="S2.SS4.p2.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS4.p2.1.m1.3.3.2.2.2.2.2" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.2.cmml">v</mi><msub id="S2.SS4.p2.1.m1.3.3.2.2.2.2.3" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.cmml"><mi id="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.2" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.2.cmml">B</mi><mi id="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.3" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.3.cmml">n</mi></msub><mi id="S2.SS4.p2.1.m1.3.3.2.2.2.3" xref="S2.SS4.p2.1.m1.3.3.2.2.2.3.cmml">t</mi></msubsup><mo id="S2.SS4.p2.1.m1.3.3.2.2.6" stretchy="false" xref="S2.SS4.p2.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.1.m1.3b"><apply id="S2.SS4.p2.1.m1.3.3.cmml" xref="S2.SS4.p2.1.m1.3.3"><eq id="S2.SS4.p2.1.m1.3.3.3.cmml" xref="S2.SS4.p2.1.m1.3.3.3"></eq><apply id="S2.SS4.p2.1.m1.3.3.4.cmml" xref="S2.SS4.p2.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.3.3.4.1.cmml" xref="S2.SS4.p2.1.m1.3.3.4">superscript</csymbol><ci id="S2.SS4.p2.1.m1.3.3.4.2.cmml" xref="S2.SS4.p2.1.m1.3.3.4.2">𝑉</ci><ci id="S2.SS4.p2.1.m1.3.3.4.3.cmml" xref="S2.SS4.p2.1.m1.3.3.4.3">𝑡</ci></apply><list id="S2.SS4.p2.1.m1.3.3.2.3.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2"><apply id="S2.SS4.p2.1.m1.2.2.1.1.1.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S2.SS4.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS4.p2.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.2">𝑣</ci><apply id="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.1.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.3">subscript</csymbol><ci id="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.2.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.2">𝐵</ci><cn id="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S2.SS4.p2.1.m1.2.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS4.p2.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS4.p2.1.m1.2.2.1.1.1.3">𝑡</ci></apply><ci id="S2.SS4.p2.1.m1.1.1.cmml" xref="S2.SS4.p2.1.m1.1.1">…</ci><apply id="S2.SS4.p2.1.m1.3.3.2.2.2.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S2.SS4.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS4.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.2">𝑣</ci><apply id="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.1.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.3">subscript</csymbol><ci id="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.2.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.2">𝐵</ci><ci id="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.3.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2.2.3.3">𝑛</ci></apply></apply><ci id="S2.SS4.p2.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS4.p2.1.m1.3.3.2.2.2.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.1.m1.3c">V^{t}=[v_{B_{1}}^{t},...,v_{B_{n}}^{t}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.1.m1.3d">italic_V start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = [ italic_v start_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ]</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S2.SS4.p2.2.m2.1"><semantics id="S2.SS4.p2.2.m2.1a"><mi id="S2.SS4.p2.2.m2.1.1" xref="S2.SS4.p2.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p2.2.m2.1b"><ci id="S2.SS4.p2.2.m2.1.1.cmml" xref="S2.SS4.p2.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p2.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p2.2.m2.1d">italic_n</annotation></semantics></math> is the total number of baskets across all users in the batch.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.3">After generating the basket-level representations, we identify the relevant baskets for a specific item. The presence of the same item in different baskets reflects its adaptability to various users needs or situations. Therefore, we construct item-to-basket correspondence matrices <math alttext="\hat{V}_{i}^{t}=[v_{B_{1}}^{t},...,v_{B_{j}}^{t}]" class="ltx_Math" display="inline" id="S2.SS4.p3.1.m1.3"><semantics id="S2.SS4.p3.1.m1.3a"><mrow id="S2.SS4.p3.1.m1.3.3" xref="S2.SS4.p3.1.m1.3.3.cmml"><msubsup id="S2.SS4.p3.1.m1.3.3.4" xref="S2.SS4.p3.1.m1.3.3.4.cmml"><mover accent="true" id="S2.SS4.p3.1.m1.3.3.4.2.2" xref="S2.SS4.p3.1.m1.3.3.4.2.2.cmml"><mi id="S2.SS4.p3.1.m1.3.3.4.2.2.2" xref="S2.SS4.p3.1.m1.3.3.4.2.2.2.cmml">V</mi><mo id="S2.SS4.p3.1.m1.3.3.4.2.2.1" xref="S2.SS4.p3.1.m1.3.3.4.2.2.1.cmml">^</mo></mover><mi id="S2.SS4.p3.1.m1.3.3.4.2.3" xref="S2.SS4.p3.1.m1.3.3.4.2.3.cmml">i</mi><mi id="S2.SS4.p3.1.m1.3.3.4.3" xref="S2.SS4.p3.1.m1.3.3.4.3.cmml">t</mi></msubsup><mo id="S2.SS4.p3.1.m1.3.3.3" xref="S2.SS4.p3.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS4.p3.1.m1.3.3.2.2" xref="S2.SS4.p3.1.m1.3.3.2.3.cmml"><mo id="S2.SS4.p3.1.m1.3.3.2.2.3" stretchy="false" xref="S2.SS4.p3.1.m1.3.3.2.3.cmml">[</mo><msubsup id="S2.SS4.p3.1.m1.2.2.1.1.1" xref="S2.SS4.p3.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS4.p3.1.m1.2.2.1.1.1.2.2" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.2.cmml">v</mi><msub id="S2.SS4.p3.1.m1.2.2.1.1.1.2.3" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.cmml"><mi id="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.2" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.2.cmml">B</mi><mn id="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.3" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.3.cmml">1</mn></msub><mi id="S2.SS4.p3.1.m1.2.2.1.1.1.3" xref="S2.SS4.p3.1.m1.2.2.1.1.1.3.cmml">t</mi></msubsup><mo id="S2.SS4.p3.1.m1.3.3.2.2.4" xref="S2.SS4.p3.1.m1.3.3.2.3.cmml">,</mo><mi id="S2.SS4.p3.1.m1.1.1" mathvariant="normal" xref="S2.SS4.p3.1.m1.1.1.cmml">…</mi><mo id="S2.SS4.p3.1.m1.3.3.2.2.5" xref="S2.SS4.p3.1.m1.3.3.2.3.cmml">,</mo><msubsup id="S2.SS4.p3.1.m1.3.3.2.2.2" xref="S2.SS4.p3.1.m1.3.3.2.2.2.cmml"><mi id="S2.SS4.p3.1.m1.3.3.2.2.2.2.2" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.2.cmml">v</mi><msub id="S2.SS4.p3.1.m1.3.3.2.2.2.2.3" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.cmml"><mi id="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.2" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.2.cmml">B</mi><mi id="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.3" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.3.cmml">j</mi></msub><mi id="S2.SS4.p3.1.m1.3.3.2.2.2.3" xref="S2.SS4.p3.1.m1.3.3.2.2.2.3.cmml">t</mi></msubsup><mo id="S2.SS4.p3.1.m1.3.3.2.2.6" stretchy="false" xref="S2.SS4.p3.1.m1.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.1.m1.3b"><apply id="S2.SS4.p3.1.m1.3.3.cmml" xref="S2.SS4.p3.1.m1.3.3"><eq id="S2.SS4.p3.1.m1.3.3.3.cmml" xref="S2.SS4.p3.1.m1.3.3.3"></eq><apply id="S2.SS4.p3.1.m1.3.3.4.cmml" xref="S2.SS4.p3.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.3.3.4.1.cmml" xref="S2.SS4.p3.1.m1.3.3.4">superscript</csymbol><apply id="S2.SS4.p3.1.m1.3.3.4.2.cmml" xref="S2.SS4.p3.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.3.3.4.2.1.cmml" xref="S2.SS4.p3.1.m1.3.3.4">subscript</csymbol><apply id="S2.SS4.p3.1.m1.3.3.4.2.2.cmml" xref="S2.SS4.p3.1.m1.3.3.4.2.2"><ci id="S2.SS4.p3.1.m1.3.3.4.2.2.1.cmml" xref="S2.SS4.p3.1.m1.3.3.4.2.2.1">^</ci><ci id="S2.SS4.p3.1.m1.3.3.4.2.2.2.cmml" xref="S2.SS4.p3.1.m1.3.3.4.2.2.2">𝑉</ci></apply><ci id="S2.SS4.p3.1.m1.3.3.4.2.3.cmml" xref="S2.SS4.p3.1.m1.3.3.4.2.3">𝑖</ci></apply><ci id="S2.SS4.p3.1.m1.3.3.4.3.cmml" xref="S2.SS4.p3.1.m1.3.3.4.3">𝑡</ci></apply><list id="S2.SS4.p3.1.m1.3.3.2.3.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2"><apply id="S2.SS4.p3.1.m1.2.2.1.1.1.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1">superscript</csymbol><apply id="S2.SS4.p3.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS4.p3.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.2">𝑣</ci><apply id="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.1.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.3">subscript</csymbol><ci id="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.2.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.2">𝐵</ci><cn id="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S2.SS4.p3.1.m1.2.2.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.SS4.p3.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS4.p3.1.m1.2.2.1.1.1.3">𝑡</ci></apply><ci id="S2.SS4.p3.1.m1.1.1.cmml" xref="S2.SS4.p3.1.m1.1.1">…</ci><apply id="S2.SS4.p3.1.m1.3.3.2.2.2.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.3.3.2.2.2.1.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2">superscript</csymbol><apply id="S2.SS4.p3.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.SS4.p3.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.2">𝑣</ci><apply id="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.1.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.3">subscript</csymbol><ci id="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.2.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.2">𝐵</ci><ci id="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.3.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.SS4.p3.1.m1.3.3.2.2.2.3.cmml" xref="S2.SS4.p3.1.m1.3.3.2.2.2.3">𝑡</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.1.m1.3c">\hat{V}_{i}^{t}=[v_{B_{1}}^{t},...,v_{B_{j}}^{t}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.1.m1.3d">over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = [ italic_v start_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_B start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ]</annotation></semantics></math>, where <math alttext="j" class="ltx_Math" display="inline" id="S2.SS4.p3.2.m2.1"><semantics id="S2.SS4.p3.2.m2.1a"><mi id="S2.SS4.p3.2.m2.1.1" xref="S2.SS4.p3.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.2.m2.1b"><ci id="S2.SS4.p3.2.m2.1.1.cmml" xref="S2.SS4.p3.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.2.m2.1d">italic_j</annotation></semantics></math> represents the number of baskets in which item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.p3.3.m3.1"><semantics id="S2.SS4.p3.3.m3.1a"><mi id="S2.SS4.p3.3.m3.1.1" xref="S2.SS4.p3.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p3.3.m3.1b"><ci id="S2.SS4.p3.3.m3.1.1.cmml" xref="S2.SS4.p3.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p3.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p3.3.m3.1d">italic_i</annotation></semantics></math> appears.</p>
</div>
<div class="ltx_para" id="S2.SS4.p4">
<p class="ltx_p" id="S2.SS4.p4.1">However, not all baskets containing the same item contribute equally to the recommendation task, some may contain irrelevant information or noise. To address this, we employ a self-attention mechanism to evaluate the impact of each basket and refine the overall preference for the item <math alttext="i" class="ltx_Math" display="inline" id="S2.SS4.p4.1.m1.1"><semantics id="S2.SS4.p4.1.m1.1a"><mi id="S2.SS4.p4.1.m1.1.1" xref="S2.SS4.p4.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.1.m1.1b"><ci id="S2.SS4.p4.1.m1.1.1.cmml" xref="S2.SS4.p4.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.1.m1.1d">italic_i</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="v_{\widetilde{i}}^{t}=\hat{V}_{i}^{t}\cdot\alpha^{t}" class="ltx_Math" display="block" id="S2.E6.m1.1"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml"><msubsup id="S2.E6.m1.1.1.2" xref="S2.E6.m1.1.1.2.cmml"><mi id="S2.E6.m1.1.1.2.2.2" xref="S2.E6.m1.1.1.2.2.2.cmml">v</mi><mover accent="true" id="S2.E6.m1.1.1.2.2.3" xref="S2.E6.m1.1.1.2.2.3.cmml"><mi id="S2.E6.m1.1.1.2.2.3.2" xref="S2.E6.m1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E6.m1.1.1.2.2.3.1" xref="S2.E6.m1.1.1.2.2.3.1.cmml">~</mo></mover><mi id="S2.E6.m1.1.1.2.3" xref="S2.E6.m1.1.1.2.3.cmml">t</mi></msubsup><mo id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.cmml">=</mo><mrow id="S2.E6.m1.1.1.3" xref="S2.E6.m1.1.1.3.cmml"><msubsup id="S2.E6.m1.1.1.3.2" xref="S2.E6.m1.1.1.3.2.cmml"><mover accent="true" id="S2.E6.m1.1.1.3.2.2.2" xref="S2.E6.m1.1.1.3.2.2.2.cmml"><mi id="S2.E6.m1.1.1.3.2.2.2.2" xref="S2.E6.m1.1.1.3.2.2.2.2.cmml">V</mi><mo id="S2.E6.m1.1.1.3.2.2.2.1" xref="S2.E6.m1.1.1.3.2.2.2.1.cmml">^</mo></mover><mi id="S2.E6.m1.1.1.3.2.2.3" xref="S2.E6.m1.1.1.3.2.2.3.cmml">i</mi><mi id="S2.E6.m1.1.1.3.2.3" xref="S2.E6.m1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S2.E6.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E6.m1.1.1.3.1.cmml">⋅</mo><msup id="S2.E6.m1.1.1.3.3" xref="S2.E6.m1.1.1.3.3.cmml"><mi id="S2.E6.m1.1.1.3.3.2" xref="S2.E6.m1.1.1.3.3.2.cmml">α</mi><mi id="S2.E6.m1.1.1.3.3.3" xref="S2.E6.m1.1.1.3.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"><eq id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"></eq><apply id="S2.E6.m1.1.1.2.cmml" xref="S2.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.2">superscript</csymbol><apply id="S2.E6.m1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.2.2.1.cmml" xref="S2.E6.m1.1.1.2">subscript</csymbol><ci id="S2.E6.m1.1.1.2.2.2.cmml" xref="S2.E6.m1.1.1.2.2.2">𝑣</ci><apply id="S2.E6.m1.1.1.2.2.3.cmml" xref="S2.E6.m1.1.1.2.2.3"><ci id="S2.E6.m1.1.1.2.2.3.1.cmml" xref="S2.E6.m1.1.1.2.2.3.1">~</ci><ci id="S2.E6.m1.1.1.2.2.3.2.cmml" xref="S2.E6.m1.1.1.2.2.3.2">𝑖</ci></apply></apply><ci id="S2.E6.m1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.2.3">𝑡</ci></apply><apply id="S2.E6.m1.1.1.3.cmml" xref="S2.E6.m1.1.1.3"><ci id="S2.E6.m1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.3.1">⋅</ci><apply id="S2.E6.m1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.3.2">superscript</csymbol><apply id="S2.E6.m1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.3.2.2.1.cmml" xref="S2.E6.m1.1.1.3.2">subscript</csymbol><apply id="S2.E6.m1.1.1.3.2.2.2.cmml" xref="S2.E6.m1.1.1.3.2.2.2"><ci id="S2.E6.m1.1.1.3.2.2.2.1.cmml" xref="S2.E6.m1.1.1.3.2.2.2.1">^</ci><ci id="S2.E6.m1.1.1.3.2.2.2.2.cmml" xref="S2.E6.m1.1.1.3.2.2.2.2">𝑉</ci></apply><ci id="S2.E6.m1.1.1.3.2.2.3.cmml" xref="S2.E6.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S2.E6.m1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E6.m1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.3.3.1.cmml" xref="S2.E6.m1.1.1.3.3">superscript</csymbol><ci id="S2.E6.m1.1.1.3.3.2.cmml" xref="S2.E6.m1.1.1.3.3.2">𝛼</ci><ci id="S2.E6.m1.1.1.3.3.3.cmml" xref="S2.E6.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">v_{\widetilde{i}}^{t}=\hat{V}_{i}^{t}\cdot\alpha^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">italic_v start_POSTSUBSCRIPT over~ start_ARG italic_i end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ⋅ italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha^{t}=softmax(b^{\top}\cdot tanh(W_{\alpha}\hat{V}_{i}^{t}))" class="ltx_Math" display="block" id="S2.E7.m1.1"><semantics id="S2.E7.m1.1a"><mrow id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml"><msup id="S2.E7.m1.1.1.3" xref="S2.E7.m1.1.1.3.cmml"><mi id="S2.E7.m1.1.1.3.2" xref="S2.E7.m1.1.1.3.2.cmml">α</mi><mi id="S2.E7.m1.1.1.3.3" xref="S2.E7.m1.1.1.3.3.cmml">t</mi></msup><mo id="S2.E7.m1.1.1.2" xref="S2.E7.m1.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.1.1.1" xref="S2.E7.m1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.3" xref="S2.E7.m1.1.1.1.3.cmml">s</mi><mo id="S2.E7.m1.1.1.1.2" xref="S2.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.4" xref="S2.E7.m1.1.1.1.4.cmml">o</mi><mo id="S2.E7.m1.1.1.1.2a" xref="S2.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.5" xref="S2.E7.m1.1.1.1.5.cmml">f</mi><mo id="S2.E7.m1.1.1.1.2b" xref="S2.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.6" xref="S2.E7.m1.1.1.1.6.cmml">t</mi><mo id="S2.E7.m1.1.1.1.2c" xref="S2.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.7" xref="S2.E7.m1.1.1.1.7.cmml">m</mi><mo id="S2.E7.m1.1.1.1.2d" xref="S2.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.8" xref="S2.E7.m1.1.1.1.8.cmml">a</mi><mo id="S2.E7.m1.1.1.1.2e" xref="S2.E7.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.9" xref="S2.E7.m1.1.1.1.9.cmml">x</mi><mo id="S2.E7.m1.1.1.1.2f" xref="S2.E7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7.m1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.3.cmml"><msup id="S2.E7.m1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.3.2.2" xref="S2.E7.m1.1.1.1.1.1.1.3.2.2.cmml">b</mi><mo id="S2.E7.m1.1.1.1.1.1.1.3.2.3" xref="S2.E7.m1.1.1.1.1.1.1.3.2.3.cmml">⊤</mo></msup><mo id="S2.E7.m1.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.E7.m1.1.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="S2.E7.m1.1.1.1.1.1.1.3.3" xref="S2.E7.m1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow><mo id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.1.1.1.4" xref="S2.E7.m1.1.1.1.1.1.1.4.cmml">a</mi><mo id="S2.E7.m1.1.1.1.1.1.1.2a" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.1.1.1.5" xref="S2.E7.m1.1.1.1.1.1.1.5.cmml">n</mi><mo id="S2.E7.m1.1.1.1.1.1.1.2b" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E7.m1.1.1.1.1.1.1.6" xref="S2.E7.m1.1.1.1.1.1.1.6.cmml">h</mi><mo id="S2.E7.m1.1.1.1.1.1.1.2c" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7.m1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mi id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">α</mi></msub><mo id="S2.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msubsup id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">V</mi><mo id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo id="S2.E7.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.1b"><apply id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1"><eq id="S2.E7.m1.1.1.2.cmml" xref="S2.E7.m1.1.1.2"></eq><apply id="S2.E7.m1.1.1.3.cmml" xref="S2.E7.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.3">superscript</csymbol><ci id="S2.E7.m1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.3.2">𝛼</ci><ci id="S2.E7.m1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.3.3">𝑡</ci></apply><apply id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"><times id="S2.E7.m1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.2"></times><ci id="S2.E7.m1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.3">𝑠</ci><ci id="S2.E7.m1.1.1.1.4.cmml" xref="S2.E7.m1.1.1.1.4">𝑜</ci><ci id="S2.E7.m1.1.1.1.5.cmml" xref="S2.E7.m1.1.1.1.5">𝑓</ci><ci id="S2.E7.m1.1.1.1.6.cmml" xref="S2.E7.m1.1.1.1.6">𝑡</ci><ci id="S2.E7.m1.1.1.1.7.cmml" xref="S2.E7.m1.1.1.1.7">𝑚</ci><ci id="S2.E7.m1.1.1.1.8.cmml" xref="S2.E7.m1.1.1.1.8">𝑎</ci><ci id="S2.E7.m1.1.1.1.9.cmml" xref="S2.E7.m1.1.1.1.9">𝑥</ci><apply id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1"><times id="S2.E7.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2"></times><apply id="S2.E7.m1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3"><ci id="S2.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.1">⋅</ci><apply id="S2.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.2">superscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.2.2">𝑏</ci><csymbol cd="latexml" id="S2.E7.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.2.3">top</csymbol></apply><ci id="S2.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply><ci id="S2.E7.m1.1.1.1.1.1.1.4.cmml" xref="S2.E7.m1.1.1.1.1.1.1.4">𝑎</ci><ci id="S2.E7.m1.1.1.1.1.1.1.5.cmml" xref="S2.E7.m1.1.1.1.1.1.1.5">𝑛</ci><ci id="S2.E7.m1.1.1.1.1.1.1.6.cmml" xref="S2.E7.m1.1.1.1.1.1.1.6">ℎ</ci><apply id="S2.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1"><times id="S2.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.2.3">𝛼</ci></apply><apply id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑉</ci></apply><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.1c">\alpha^{t}=softmax(b^{\top}\cdot tanh(W_{\alpha}\hat{V}_{i}^{t}))</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.1d">italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( italic_b start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ⋅ italic_t italic_a italic_n italic_h ( italic_W start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT over^ start_ARG italic_V end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS4.p4.4">where <math alttext="\alpha^{t}" class="ltx_Math" display="inline" id="S2.SS4.p4.2.m1.1"><semantics id="S2.SS4.p4.2.m1.1a"><msup id="S2.SS4.p4.2.m1.1.1" xref="S2.SS4.p4.2.m1.1.1.cmml"><mi id="S2.SS4.p4.2.m1.1.1.2" xref="S2.SS4.p4.2.m1.1.1.2.cmml">α</mi><mi id="S2.SS4.p4.2.m1.1.1.3" xref="S2.SS4.p4.2.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.2.m1.1b"><apply id="S2.SS4.p4.2.m1.1.1.cmml" xref="S2.SS4.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.2.m1.1.1.1.cmml" xref="S2.SS4.p4.2.m1.1.1">superscript</csymbol><ci id="S2.SS4.p4.2.m1.1.1.2.cmml" xref="S2.SS4.p4.2.m1.1.1.2">𝛼</ci><ci id="S2.SS4.p4.2.m1.1.1.3.cmml" xref="S2.SS4.p4.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.2.m1.1c">\alpha^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.2.m1.1d">italic_α start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math> is attention weight vectors indicating the importance of each basket. <math alttext="W_{\alpha}" class="ltx_Math" display="inline" id="S2.SS4.p4.3.m2.1"><semantics id="S2.SS4.p4.3.m2.1a"><msub id="S2.SS4.p4.3.m2.1.1" xref="S2.SS4.p4.3.m2.1.1.cmml"><mi id="S2.SS4.p4.3.m2.1.1.2" xref="S2.SS4.p4.3.m2.1.1.2.cmml">W</mi><mi id="S2.SS4.p4.3.m2.1.1.3" xref="S2.SS4.p4.3.m2.1.1.3.cmml">α</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.3.m2.1b"><apply id="S2.SS4.p4.3.m2.1.1.cmml" xref="S2.SS4.p4.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS4.p4.3.m2.1.1.1.cmml" xref="S2.SS4.p4.3.m2.1.1">subscript</csymbol><ci id="S2.SS4.p4.3.m2.1.1.2.cmml" xref="S2.SS4.p4.3.m2.1.1.2">𝑊</ci><ci id="S2.SS4.p4.3.m2.1.1.3.cmml" xref="S2.SS4.p4.3.m2.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.3.m2.1c">W_{\alpha}</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.3.m2.1d">italic_W start_POSTSUBSCRIPT italic_α end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="b" class="ltx_Math" display="inline" id="S2.SS4.p4.4.m3.1"><semantics id="S2.SS4.p4.4.m3.1a"><mi id="S2.SS4.p4.4.m3.1.1" xref="S2.SS4.p4.4.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S2.SS4.p4.4.m3.1b"><ci id="S2.SS4.p4.4.m3.1.1.cmml" xref="S2.SS4.p4.4.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS4.p4.4.m3.1c">b</annotation><annotation encoding="application/x-llamapun" id="S2.SS4.p4.4.m3.1d">italic_b</annotation></semantics></math> are learnable parameters that adjust the model to the specific characteristics of the data. With the basket-guided dynamic augmentation network, we update the node embeddings as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widetilde{h}_{i}^{t}=h_{i}^{t}+v_{\widetilde{i}}^{t}" class="ltx_Math" display="block" id="S2.E8.m1.1"><semantics id="S2.E8.m1.1a"><mrow id="S2.E8.m1.1.1" xref="S2.E8.m1.1.1.cmml"><msubsup id="S2.E8.m1.1.1.2" xref="S2.E8.m1.1.1.2.cmml"><mover accent="true" id="S2.E8.m1.1.1.2.2.2" xref="S2.E8.m1.1.1.2.2.2.cmml"><mi id="S2.E8.m1.1.1.2.2.2.2" xref="S2.E8.m1.1.1.2.2.2.2.cmml">h</mi><mo id="S2.E8.m1.1.1.2.2.2.1" xref="S2.E8.m1.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S2.E8.m1.1.1.2.2.3" xref="S2.E8.m1.1.1.2.2.3.cmml">i</mi><mi id="S2.E8.m1.1.1.2.3" xref="S2.E8.m1.1.1.2.3.cmml">t</mi></msubsup><mo id="S2.E8.m1.1.1.1" xref="S2.E8.m1.1.1.1.cmml">=</mo><mrow id="S2.E8.m1.1.1.3" xref="S2.E8.m1.1.1.3.cmml"><msubsup id="S2.E8.m1.1.1.3.2" xref="S2.E8.m1.1.1.3.2.cmml"><mi id="S2.E8.m1.1.1.3.2.2.2" xref="S2.E8.m1.1.1.3.2.2.2.cmml">h</mi><mi id="S2.E8.m1.1.1.3.2.2.3" xref="S2.E8.m1.1.1.3.2.2.3.cmml">i</mi><mi id="S2.E8.m1.1.1.3.2.3" xref="S2.E8.m1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S2.E8.m1.1.1.3.1" xref="S2.E8.m1.1.1.3.1.cmml">+</mo><msubsup id="S2.E8.m1.1.1.3.3" xref="S2.E8.m1.1.1.3.3.cmml"><mi id="S2.E8.m1.1.1.3.3.2.2" xref="S2.E8.m1.1.1.3.3.2.2.cmml">v</mi><mover accent="true" id="S2.E8.m1.1.1.3.3.2.3" xref="S2.E8.m1.1.1.3.3.2.3.cmml"><mi id="S2.E8.m1.1.1.3.3.2.3.2" xref="S2.E8.m1.1.1.3.3.2.3.2.cmml">i</mi><mo id="S2.E8.m1.1.1.3.3.2.3.1" xref="S2.E8.m1.1.1.3.3.2.3.1.cmml">~</mo></mover><mi id="S2.E8.m1.1.1.3.3.3" xref="S2.E8.m1.1.1.3.3.3.cmml">t</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><apply id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1"><eq id="S2.E8.m1.1.1.1.cmml" xref="S2.E8.m1.1.1.1"></eq><apply id="S2.E8.m1.1.1.2.cmml" xref="S2.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.2">superscript</csymbol><apply id="S2.E8.m1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.2.2.1.cmml" xref="S2.E8.m1.1.1.2">subscript</csymbol><apply id="S2.E8.m1.1.1.2.2.2.cmml" xref="S2.E8.m1.1.1.2.2.2"><ci id="S2.E8.m1.1.1.2.2.2.1.cmml" xref="S2.E8.m1.1.1.2.2.2.1">~</ci><ci id="S2.E8.m1.1.1.2.2.2.2.cmml" xref="S2.E8.m1.1.1.2.2.2.2">ℎ</ci></apply><ci id="S2.E8.m1.1.1.2.2.3.cmml" xref="S2.E8.m1.1.1.2.2.3">𝑖</ci></apply><ci id="S2.E8.m1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.2.3">𝑡</ci></apply><apply id="S2.E8.m1.1.1.3.cmml" xref="S2.E8.m1.1.1.3"><plus id="S2.E8.m1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.3.1"></plus><apply id="S2.E8.m1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.3.2.1.cmml" xref="S2.E8.m1.1.1.3.2">superscript</csymbol><apply id="S2.E8.m1.1.1.3.2.2.cmml" xref="S2.E8.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.3.2.2.1.cmml" xref="S2.E8.m1.1.1.3.2">subscript</csymbol><ci id="S2.E8.m1.1.1.3.2.2.2.cmml" xref="S2.E8.m1.1.1.3.2.2.2">ℎ</ci><ci id="S2.E8.m1.1.1.3.2.2.3.cmml" xref="S2.E8.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S2.E8.m1.1.1.3.2.3.cmml" xref="S2.E8.m1.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E8.m1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.3.3.1.cmml" xref="S2.E8.m1.1.1.3.3">superscript</csymbol><apply id="S2.E8.m1.1.1.3.3.2.cmml" xref="S2.E8.m1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.3.3.2.1.cmml" xref="S2.E8.m1.1.1.3.3">subscript</csymbol><ci id="S2.E8.m1.1.1.3.3.2.2.cmml" xref="S2.E8.m1.1.1.3.3.2.2">𝑣</ci><apply id="S2.E8.m1.1.1.3.3.2.3.cmml" xref="S2.E8.m1.1.1.3.3.2.3"><ci id="S2.E8.m1.1.1.3.3.2.3.1.cmml" xref="S2.E8.m1.1.1.3.3.2.3.1">~</ci><ci id="S2.E8.m1.1.1.3.3.2.3.2.cmml" xref="S2.E8.m1.1.1.3.3.2.3.2">𝑖</ci></apply></apply><ci id="S2.E8.m1.1.1.3.3.3.cmml" xref="S2.E8.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">\widetilde{h}_{i}^{t}=h_{i}^{t}+v_{\widetilde{i}}^{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.1d">over~ start_ARG italic_h end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT = italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT + italic_v start_POSTSUBSCRIPT over~ start_ARG italic_i end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S2.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS5.4.1.1">II-E</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS5.5.2">User Behavior Modeling</span>
</h3>
<div class="ltx_para" id="S2.SS5.p1">
<p class="ltx_p" id="S2.SS5.p1.2">After obtaining the basket-augmented price embeddings <math alttext="\widetilde{h}^{p}" class="ltx_Math" display="inline" id="S2.SS5.p1.1.m1.1"><semantics id="S2.SS5.p1.1.m1.1a"><msup id="S2.SS5.p1.1.m1.1.1" xref="S2.SS5.p1.1.m1.1.1.cmml"><mover accent="true" id="S2.SS5.p1.1.m1.1.1.2" xref="S2.SS5.p1.1.m1.1.1.2.cmml"><mi id="S2.SS5.p1.1.m1.1.1.2.2" xref="S2.SS5.p1.1.m1.1.1.2.2.cmml">h</mi><mo id="S2.SS5.p1.1.m1.1.1.2.1" xref="S2.SS5.p1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S2.SS5.p1.1.m1.1.1.3" xref="S2.SS5.p1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.1.m1.1b"><apply id="S2.SS5.p1.1.m1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.1.m1.1.1.1.cmml" xref="S2.SS5.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS5.p1.1.m1.1.1.2.cmml" xref="S2.SS5.p1.1.m1.1.1.2"><ci id="S2.SS5.p1.1.m1.1.1.2.1.cmml" xref="S2.SS5.p1.1.m1.1.1.2.1">~</ci><ci id="S2.SS5.p1.1.m1.1.1.2.2.cmml" xref="S2.SS5.p1.1.m1.1.1.2.2">ℎ</ci></apply><ci id="S2.SS5.p1.1.m1.1.1.3.cmml" xref="S2.SS5.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.1.m1.1c">\widetilde{h}^{p}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.1.m1.1d">over~ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT</annotation></semantics></math> and ID embeddings <math alttext="\widetilde{h}^{d}" class="ltx_Math" display="inline" id="S2.SS5.p1.2.m2.1"><semantics id="S2.SS5.p1.2.m2.1a"><msup id="S2.SS5.p1.2.m2.1.1" xref="S2.SS5.p1.2.m2.1.1.cmml"><mover accent="true" id="S2.SS5.p1.2.m2.1.1.2" xref="S2.SS5.p1.2.m2.1.1.2.cmml"><mi id="S2.SS5.p1.2.m2.1.1.2.2" xref="S2.SS5.p1.2.m2.1.1.2.2.cmml">h</mi><mo id="S2.SS5.p1.2.m2.1.1.2.1" xref="S2.SS5.p1.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="S2.SS5.p1.2.m2.1.1.3" xref="S2.SS5.p1.2.m2.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS5.p1.2.m2.1b"><apply id="S2.SS5.p1.2.m2.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p1.2.m2.1.1.1.cmml" xref="S2.SS5.p1.2.m2.1.1">superscript</csymbol><apply id="S2.SS5.p1.2.m2.1.1.2.cmml" xref="S2.SS5.p1.2.m2.1.1.2"><ci id="S2.SS5.p1.2.m2.1.1.2.1.cmml" xref="S2.SS5.p1.2.m2.1.1.2.1">~</ci><ci id="S2.SS5.p1.2.m2.1.1.2.2.cmml" xref="S2.SS5.p1.2.m2.1.1.2.2">ℎ</ci></apply><ci id="S2.SS5.p1.2.m2.1.1.3.cmml" xref="S2.SS5.p1.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p1.2.m2.1c">\widetilde{h}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p1.2.m2.1d">over~ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, we build models to identify users’ purchase decision-making behaviors (i.e., price sensitivities and product preferences). This approach enables the model to analyze diverse patterns in transaction data.</p>
</div>
<div class="ltx_para" id="S2.SS5.p2">
<p class="ltx_p" id="S2.SS5.p2.3">Using multi-head self-attention, we capture different attention patterns from the concatenated price embeddings <math alttext="\widetilde{H}_{p}=concat[\widetilde{h}^{p}_{1},\dots,\widetilde{h}^{p}_{m}]" class="ltx_Math" display="inline" id="S2.SS5.p2.1.m1.3"><semantics id="S2.SS5.p2.1.m1.3a"><mrow id="S2.SS5.p2.1.m1.3.3" xref="S2.SS5.p2.1.m1.3.3.cmml"><msub id="S2.SS5.p2.1.m1.3.3.4" xref="S2.SS5.p2.1.m1.3.3.4.cmml"><mover accent="true" id="S2.SS5.p2.1.m1.3.3.4.2" xref="S2.SS5.p2.1.m1.3.3.4.2.cmml"><mi id="S2.SS5.p2.1.m1.3.3.4.2.2" xref="S2.SS5.p2.1.m1.3.3.4.2.2.cmml">H</mi><mo id="S2.SS5.p2.1.m1.3.3.4.2.1" xref="S2.SS5.p2.1.m1.3.3.4.2.1.cmml">~</mo></mover><mi id="S2.SS5.p2.1.m1.3.3.4.3" xref="S2.SS5.p2.1.m1.3.3.4.3.cmml">p</mi></msub><mo id="S2.SS5.p2.1.m1.3.3.3" xref="S2.SS5.p2.1.m1.3.3.3.cmml">=</mo><mrow id="S2.SS5.p2.1.m1.3.3.2" xref="S2.SS5.p2.1.m1.3.3.2.cmml"><mi id="S2.SS5.p2.1.m1.3.3.2.4" xref="S2.SS5.p2.1.m1.3.3.2.4.cmml">c</mi><mo id="S2.SS5.p2.1.m1.3.3.2.3" xref="S2.SS5.p2.1.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.3.3.2.5" xref="S2.SS5.p2.1.m1.3.3.2.5.cmml">o</mi><mo id="S2.SS5.p2.1.m1.3.3.2.3a" xref="S2.SS5.p2.1.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.3.3.2.6" xref="S2.SS5.p2.1.m1.3.3.2.6.cmml">n</mi><mo id="S2.SS5.p2.1.m1.3.3.2.3b" xref="S2.SS5.p2.1.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.3.3.2.7" xref="S2.SS5.p2.1.m1.3.3.2.7.cmml">c</mi><mo id="S2.SS5.p2.1.m1.3.3.2.3c" xref="S2.SS5.p2.1.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.3.3.2.8" xref="S2.SS5.p2.1.m1.3.3.2.8.cmml">a</mi><mo id="S2.SS5.p2.1.m1.3.3.2.3d" xref="S2.SS5.p2.1.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p2.1.m1.3.3.2.9" xref="S2.SS5.p2.1.m1.3.3.2.9.cmml">t</mi><mo id="S2.SS5.p2.1.m1.3.3.2.3e" xref="S2.SS5.p2.1.m1.3.3.2.3.cmml">⁢</mo><mrow id="S2.SS5.p2.1.m1.3.3.2.2.2" xref="S2.SS5.p2.1.m1.3.3.2.2.3.cmml"><mo id="S2.SS5.p2.1.m1.3.3.2.2.2.3" stretchy="false" xref="S2.SS5.p2.1.m1.3.3.2.2.3.cmml">[</mo><msubsup id="S2.SS5.p2.1.m1.2.2.1.1.1.1" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.cmml"><mover accent="true" id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.cmml"><mi id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.2" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.2.cmml">h</mi><mo id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.1" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.1.cmml">~</mo></mover><mn id="S2.SS5.p2.1.m1.2.2.1.1.1.1.3" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.3.cmml">1</mn><mi id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.3" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.3.cmml">p</mi></msubsup><mo id="S2.SS5.p2.1.m1.3.3.2.2.2.4" xref="S2.SS5.p2.1.m1.3.3.2.2.3.cmml">,</mo><mi id="S2.SS5.p2.1.m1.1.1" mathvariant="normal" xref="S2.SS5.p2.1.m1.1.1.cmml">…</mi><mo id="S2.SS5.p2.1.m1.3.3.2.2.2.5" xref="S2.SS5.p2.1.m1.3.3.2.2.3.cmml">,</mo><msubsup id="S2.SS5.p2.1.m1.3.3.2.2.2.2" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.cmml"><mover accent="true" id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.2" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.2.cmml">h</mi><mo id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.1" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S2.SS5.p2.1.m1.3.3.2.2.2.2.3" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.3.cmml">m</mi><mi id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.3" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.3.cmml">p</mi></msubsup><mo id="S2.SS5.p2.1.m1.3.3.2.2.2.6" stretchy="false" xref="S2.SS5.p2.1.m1.3.3.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.1.m1.3b"><apply id="S2.SS5.p2.1.m1.3.3.cmml" xref="S2.SS5.p2.1.m1.3.3"><eq id="S2.SS5.p2.1.m1.3.3.3.cmml" xref="S2.SS5.p2.1.m1.3.3.3"></eq><apply id="S2.SS5.p2.1.m1.3.3.4.cmml" xref="S2.SS5.p2.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.3.3.4.1.cmml" xref="S2.SS5.p2.1.m1.3.3.4">subscript</csymbol><apply id="S2.SS5.p2.1.m1.3.3.4.2.cmml" xref="S2.SS5.p2.1.m1.3.3.4.2"><ci id="S2.SS5.p2.1.m1.3.3.4.2.1.cmml" xref="S2.SS5.p2.1.m1.3.3.4.2.1">~</ci><ci id="S2.SS5.p2.1.m1.3.3.4.2.2.cmml" xref="S2.SS5.p2.1.m1.3.3.4.2.2">𝐻</ci></apply><ci id="S2.SS5.p2.1.m1.3.3.4.3.cmml" xref="S2.SS5.p2.1.m1.3.3.4.3">𝑝</ci></apply><apply id="S2.SS5.p2.1.m1.3.3.2.cmml" xref="S2.SS5.p2.1.m1.3.3.2"><times id="S2.SS5.p2.1.m1.3.3.2.3.cmml" xref="S2.SS5.p2.1.m1.3.3.2.3"></times><ci id="S2.SS5.p2.1.m1.3.3.2.4.cmml" xref="S2.SS5.p2.1.m1.3.3.2.4">𝑐</ci><ci id="S2.SS5.p2.1.m1.3.3.2.5.cmml" xref="S2.SS5.p2.1.m1.3.3.2.5">𝑜</ci><ci id="S2.SS5.p2.1.m1.3.3.2.6.cmml" xref="S2.SS5.p2.1.m1.3.3.2.6">𝑛</ci><ci id="S2.SS5.p2.1.m1.3.3.2.7.cmml" xref="S2.SS5.p2.1.m1.3.3.2.7">𝑐</ci><ci id="S2.SS5.p2.1.m1.3.3.2.8.cmml" xref="S2.SS5.p2.1.m1.3.3.2.8">𝑎</ci><ci id="S2.SS5.p2.1.m1.3.3.2.9.cmml" xref="S2.SS5.p2.1.m1.3.3.2.9">𝑡</ci><list id="S2.SS5.p2.1.m1.3.3.2.2.3.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2"><apply id="S2.SS5.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1">subscript</csymbol><apply id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.cmml" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2"><ci id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.1">~</ci><ci id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.2.2">ℎ</ci></apply><ci id="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.2.3">𝑝</ci></apply><cn id="S2.SS5.p2.1.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.SS5.p2.1.m1.2.2.1.1.1.1.3">1</cn></apply><ci id="S2.SS5.p2.1.m1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1">…</ci><apply id="S2.SS5.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.3.3.2.2.2.2.1.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2">subscript</csymbol><apply id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.1.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2">superscript</csymbol><apply id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2"><ci id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.1">~</ci><ci id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.2.2">ℎ</ci></apply><ci id="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.3.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.2.3">𝑝</ci></apply><ci id="S2.SS5.p2.1.m1.3.3.2.2.2.2.3.cmml" xref="S2.SS5.p2.1.m1.3.3.2.2.2.2.3">𝑚</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.1.m1.3c">\widetilde{H}_{p}=concat[\widetilde{h}^{p}_{1},\dots,\widetilde{h}^{p}_{m}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.1.m1.3d">over~ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = italic_c italic_o italic_n italic_c italic_a italic_t [ over~ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , over~ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ]</annotation></semantics></math> and weight matrices <math alttext="W_{n}^{Q},W_{n}^{K},W_{n}^{V}\in\mathbb{R}^{d\times\frac{d}{h}}" class="ltx_Math" display="inline" id="S2.SS5.p2.2.m2.3"><semantics id="S2.SS5.p2.2.m2.3a"><mrow id="S2.SS5.p2.2.m2.3.3" xref="S2.SS5.p2.2.m2.3.3.cmml"><mrow id="S2.SS5.p2.2.m2.3.3.3.3" xref="S2.SS5.p2.2.m2.3.3.3.4.cmml"><msubsup id="S2.SS5.p2.2.m2.1.1.1.1.1" xref="S2.SS5.p2.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS5.p2.2.m2.1.1.1.1.1.2.2" xref="S2.SS5.p2.2.m2.1.1.1.1.1.2.2.cmml">W</mi><mi id="S2.SS5.p2.2.m2.1.1.1.1.1.2.3" xref="S2.SS5.p2.2.m2.1.1.1.1.1.2.3.cmml">n</mi><mi id="S2.SS5.p2.2.m2.1.1.1.1.1.3" xref="S2.SS5.p2.2.m2.1.1.1.1.1.3.cmml">Q</mi></msubsup><mo id="S2.SS5.p2.2.m2.3.3.3.3.4" xref="S2.SS5.p2.2.m2.3.3.3.4.cmml">,</mo><msubsup id="S2.SS5.p2.2.m2.2.2.2.2.2" xref="S2.SS5.p2.2.m2.2.2.2.2.2.cmml"><mi id="S2.SS5.p2.2.m2.2.2.2.2.2.2.2" xref="S2.SS5.p2.2.m2.2.2.2.2.2.2.2.cmml">W</mi><mi id="S2.SS5.p2.2.m2.2.2.2.2.2.2.3" xref="S2.SS5.p2.2.m2.2.2.2.2.2.2.3.cmml">n</mi><mi id="S2.SS5.p2.2.m2.2.2.2.2.2.3" xref="S2.SS5.p2.2.m2.2.2.2.2.2.3.cmml">K</mi></msubsup><mo id="S2.SS5.p2.2.m2.3.3.3.3.5" xref="S2.SS5.p2.2.m2.3.3.3.4.cmml">,</mo><msubsup id="S2.SS5.p2.2.m2.3.3.3.3.3" xref="S2.SS5.p2.2.m2.3.3.3.3.3.cmml"><mi id="S2.SS5.p2.2.m2.3.3.3.3.3.2.2" xref="S2.SS5.p2.2.m2.3.3.3.3.3.2.2.cmml">W</mi><mi id="S2.SS5.p2.2.m2.3.3.3.3.3.2.3" xref="S2.SS5.p2.2.m2.3.3.3.3.3.2.3.cmml">n</mi><mi id="S2.SS5.p2.2.m2.3.3.3.3.3.3" xref="S2.SS5.p2.2.m2.3.3.3.3.3.3.cmml">V</mi></msubsup></mrow><mo id="S2.SS5.p2.2.m2.3.3.4" xref="S2.SS5.p2.2.m2.3.3.4.cmml">∈</mo><msup id="S2.SS5.p2.2.m2.3.3.5" xref="S2.SS5.p2.2.m2.3.3.5.cmml"><mi id="S2.SS5.p2.2.m2.3.3.5.2" xref="S2.SS5.p2.2.m2.3.3.5.2.cmml">ℝ</mi><mrow id="S2.SS5.p2.2.m2.3.3.5.3" xref="S2.SS5.p2.2.m2.3.3.5.3.cmml"><mi id="S2.SS5.p2.2.m2.3.3.5.3.2" xref="S2.SS5.p2.2.m2.3.3.5.3.2.cmml">d</mi><mo id="S2.SS5.p2.2.m2.3.3.5.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS5.p2.2.m2.3.3.5.3.1.cmml">×</mo><mfrac id="S2.SS5.p2.2.m2.3.3.5.3.3" xref="S2.SS5.p2.2.m2.3.3.5.3.3.cmml"><mi id="S2.SS5.p2.2.m2.3.3.5.3.3.2" xref="S2.SS5.p2.2.m2.3.3.5.3.3.2.cmml">d</mi><mi id="S2.SS5.p2.2.m2.3.3.5.3.3.3" xref="S2.SS5.p2.2.m2.3.3.5.3.3.3.cmml">h</mi></mfrac></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.2.m2.3b"><apply id="S2.SS5.p2.2.m2.3.3.cmml" xref="S2.SS5.p2.2.m2.3.3"><in id="S2.SS5.p2.2.m2.3.3.4.cmml" xref="S2.SS5.p2.2.m2.3.3.4"></in><list id="S2.SS5.p2.2.m2.3.3.3.4.cmml" xref="S2.SS5.p2.2.m2.3.3.3.3"><apply id="S2.SS5.p2.2.m2.1.1.1.1.1.cmml" xref="S2.SS5.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS5.p2.2.m2.1.1.1.1.1">superscript</csymbol><apply id="S2.SS5.p2.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS5.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S2.SS5.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS5.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS5.p2.2.m2.1.1.1.1.1.2.2">𝑊</ci><ci id="S2.SS5.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S2.SS5.p2.2.m2.1.1.1.1.1.2.3">𝑛</ci></apply><ci id="S2.SS5.p2.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS5.p2.2.m2.1.1.1.1.1.3">𝑄</ci></apply><apply id="S2.SS5.p2.2.m2.2.2.2.2.2.cmml" xref="S2.SS5.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.2.2.2.2.2.1.cmml" xref="S2.SS5.p2.2.m2.2.2.2.2.2">superscript</csymbol><apply id="S2.SS5.p2.2.m2.2.2.2.2.2.2.cmml" xref="S2.SS5.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.2.2.2.2.2.2.1.cmml" xref="S2.SS5.p2.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS5.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S2.SS5.p2.2.m2.2.2.2.2.2.2.2">𝑊</ci><ci id="S2.SS5.p2.2.m2.2.2.2.2.2.2.3.cmml" xref="S2.SS5.p2.2.m2.2.2.2.2.2.2.3">𝑛</ci></apply><ci id="S2.SS5.p2.2.m2.2.2.2.2.2.3.cmml" xref="S2.SS5.p2.2.m2.2.2.2.2.2.3">𝐾</ci></apply><apply id="S2.SS5.p2.2.m2.3.3.3.3.3.cmml" xref="S2.SS5.p2.2.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.3.3.3.3.3.1.cmml" xref="S2.SS5.p2.2.m2.3.3.3.3.3">superscript</csymbol><apply id="S2.SS5.p2.2.m2.3.3.3.3.3.2.cmml" xref="S2.SS5.p2.2.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.3.3.3.3.3.2.1.cmml" xref="S2.SS5.p2.2.m2.3.3.3.3.3">subscript</csymbol><ci id="S2.SS5.p2.2.m2.3.3.3.3.3.2.2.cmml" xref="S2.SS5.p2.2.m2.3.3.3.3.3.2.2">𝑊</ci><ci id="S2.SS5.p2.2.m2.3.3.3.3.3.2.3.cmml" xref="S2.SS5.p2.2.m2.3.3.3.3.3.2.3">𝑛</ci></apply><ci id="S2.SS5.p2.2.m2.3.3.3.3.3.3.cmml" xref="S2.SS5.p2.2.m2.3.3.3.3.3.3">𝑉</ci></apply></list><apply id="S2.SS5.p2.2.m2.3.3.5.cmml" xref="S2.SS5.p2.2.m2.3.3.5"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.3.3.5.1.cmml" xref="S2.SS5.p2.2.m2.3.3.5">superscript</csymbol><ci id="S2.SS5.p2.2.m2.3.3.5.2.cmml" xref="S2.SS5.p2.2.m2.3.3.5.2">ℝ</ci><apply id="S2.SS5.p2.2.m2.3.3.5.3.cmml" xref="S2.SS5.p2.2.m2.3.3.5.3"><times id="S2.SS5.p2.2.m2.3.3.5.3.1.cmml" xref="S2.SS5.p2.2.m2.3.3.5.3.1"></times><ci id="S2.SS5.p2.2.m2.3.3.5.3.2.cmml" xref="S2.SS5.p2.2.m2.3.3.5.3.2">𝑑</ci><apply id="S2.SS5.p2.2.m2.3.3.5.3.3.cmml" xref="S2.SS5.p2.2.m2.3.3.5.3.3"><divide id="S2.SS5.p2.2.m2.3.3.5.3.3.1.cmml" xref="S2.SS5.p2.2.m2.3.3.5.3.3"></divide><ci id="S2.SS5.p2.2.m2.3.3.5.3.3.2.cmml" xref="S2.SS5.p2.2.m2.3.3.5.3.3.2">𝑑</ci><ci id="S2.SS5.p2.2.m2.3.3.5.3.3.3.cmml" xref="S2.SS5.p2.2.m2.3.3.5.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.2.m2.3c">W_{n}^{Q},W_{n}^{K},W_{n}^{V}\in\mathbb{R}^{d\times\frac{d}{h}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.2.m2.3d">italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × divide start_ARG italic_d end_ARG start_ARG italic_h end_ARG end_POSTSUPERSCRIPT</annotation></semantics></math> where <math alttext="h" class="ltx_Math" display="inline" id="S2.SS5.p2.3.m3.1"><semantics id="S2.SS5.p2.3.m3.1a"><mi id="S2.SS5.p2.3.m3.1.1" xref="S2.SS5.p2.3.m3.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.3.m3.1b"><ci id="S2.SS5.p2.3.m3.1.1.cmml" xref="S2.SS5.p2.3.m3.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.3.m3.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.3.m3.1d">italic_h</annotation></semantics></math> is the number of heads, we generate the attention components:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q^{n}=\widetilde{H}_{p}W_{n}^{Q},\quad K^{n}=\widetilde{H}_{p}W_{n}^{K},\quad V%
^{n}=\widetilde{H}_{p}W_{n}^{V}" class="ltx_Math" display="block" id="S2.E9.m1.2"><semantics id="S2.E9.m1.2a"><mrow id="S2.E9.m1.2.2.2" xref="S2.E9.m1.2.2.3.cmml"><mrow id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml"><msup id="S2.E9.m1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.2.cmml"><mi id="S2.E9.m1.1.1.1.1.2.2" xref="S2.E9.m1.1.1.1.1.2.2.cmml">Q</mi><mi id="S2.E9.m1.1.1.1.1.2.3" xref="S2.E9.m1.1.1.1.1.2.3.cmml">n</mi></msup><mo id="S2.E9.m1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E9.m1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.3.cmml"><msub id="S2.E9.m1.1.1.1.1.3.2" xref="S2.E9.m1.1.1.1.1.3.2.cmml"><mover accent="true" id="S2.E9.m1.1.1.1.1.3.2.2" xref="S2.E9.m1.1.1.1.1.3.2.2.cmml"><mi id="S2.E9.m1.1.1.1.1.3.2.2.2" xref="S2.E9.m1.1.1.1.1.3.2.2.2.cmml">H</mi><mo id="S2.E9.m1.1.1.1.1.3.2.2.1" xref="S2.E9.m1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S2.E9.m1.1.1.1.1.3.2.3" xref="S2.E9.m1.1.1.1.1.3.2.3.cmml">p</mi></msub><mo id="S2.E9.m1.1.1.1.1.3.1" xref="S2.E9.m1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="S2.E9.m1.1.1.1.1.3.3" xref="S2.E9.m1.1.1.1.1.3.3.cmml"><mi id="S2.E9.m1.1.1.1.1.3.3.2.2" xref="S2.E9.m1.1.1.1.1.3.3.2.2.cmml">W</mi><mi id="S2.E9.m1.1.1.1.1.3.3.2.3" xref="S2.E9.m1.1.1.1.1.3.3.2.3.cmml">n</mi><mi id="S2.E9.m1.1.1.1.1.3.3.3" xref="S2.E9.m1.1.1.1.1.3.3.3.cmml">Q</mi></msubsup></mrow></mrow><mo id="S2.E9.m1.2.2.2.3" rspace="1.167em" xref="S2.E9.m1.2.2.3a.cmml">,</mo><mrow id="S2.E9.m1.2.2.2.2.2" xref="S2.E9.m1.2.2.2.2.3.cmml"><mrow id="S2.E9.m1.2.2.2.2.1.1" xref="S2.E9.m1.2.2.2.2.1.1.cmml"><msup id="S2.E9.m1.2.2.2.2.1.1.2" xref="S2.E9.m1.2.2.2.2.1.1.2.cmml"><mi id="S2.E9.m1.2.2.2.2.1.1.2.2" xref="S2.E9.m1.2.2.2.2.1.1.2.2.cmml">K</mi><mi id="S2.E9.m1.2.2.2.2.1.1.2.3" xref="S2.E9.m1.2.2.2.2.1.1.2.3.cmml">n</mi></msup><mo id="S2.E9.m1.2.2.2.2.1.1.1" xref="S2.E9.m1.2.2.2.2.1.1.1.cmml">=</mo><mrow id="S2.E9.m1.2.2.2.2.1.1.3" xref="S2.E9.m1.2.2.2.2.1.1.3.cmml"><msub id="S2.E9.m1.2.2.2.2.1.1.3.2" xref="S2.E9.m1.2.2.2.2.1.1.3.2.cmml"><mover accent="true" id="S2.E9.m1.2.2.2.2.1.1.3.2.2" xref="S2.E9.m1.2.2.2.2.1.1.3.2.2.cmml"><mi id="S2.E9.m1.2.2.2.2.1.1.3.2.2.2" xref="S2.E9.m1.2.2.2.2.1.1.3.2.2.2.cmml">H</mi><mo id="S2.E9.m1.2.2.2.2.1.1.3.2.2.1" xref="S2.E9.m1.2.2.2.2.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S2.E9.m1.2.2.2.2.1.1.3.2.3" xref="S2.E9.m1.2.2.2.2.1.1.3.2.3.cmml">p</mi></msub><mo id="S2.E9.m1.2.2.2.2.1.1.3.1" xref="S2.E9.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><msubsup id="S2.E9.m1.2.2.2.2.1.1.3.3" xref="S2.E9.m1.2.2.2.2.1.1.3.3.cmml"><mi id="S2.E9.m1.2.2.2.2.1.1.3.3.2.2" xref="S2.E9.m1.2.2.2.2.1.1.3.3.2.2.cmml">W</mi><mi id="S2.E9.m1.2.2.2.2.1.1.3.3.2.3" xref="S2.E9.m1.2.2.2.2.1.1.3.3.2.3.cmml">n</mi><mi id="S2.E9.m1.2.2.2.2.1.1.3.3.3" xref="S2.E9.m1.2.2.2.2.1.1.3.3.3.cmml">K</mi></msubsup></mrow></mrow><mo id="S2.E9.m1.2.2.2.2.2.3" rspace="1.167em" xref="S2.E9.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S2.E9.m1.2.2.2.2.2.2" xref="S2.E9.m1.2.2.2.2.2.2.cmml"><msup id="S2.E9.m1.2.2.2.2.2.2.2" xref="S2.E9.m1.2.2.2.2.2.2.2.cmml"><mi id="S2.E9.m1.2.2.2.2.2.2.2.2" xref="S2.E9.m1.2.2.2.2.2.2.2.2.cmml">V</mi><mi id="S2.E9.m1.2.2.2.2.2.2.2.3" xref="S2.E9.m1.2.2.2.2.2.2.2.3.cmml">n</mi></msup><mo id="S2.E9.m1.2.2.2.2.2.2.1" xref="S2.E9.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="S2.E9.m1.2.2.2.2.2.2.3" xref="S2.E9.m1.2.2.2.2.2.2.3.cmml"><msub id="S2.E9.m1.2.2.2.2.2.2.3.2" xref="S2.E9.m1.2.2.2.2.2.2.3.2.cmml"><mover accent="true" id="S2.E9.m1.2.2.2.2.2.2.3.2.2" xref="S2.E9.m1.2.2.2.2.2.2.3.2.2.cmml"><mi id="S2.E9.m1.2.2.2.2.2.2.3.2.2.2" xref="S2.E9.m1.2.2.2.2.2.2.3.2.2.2.cmml">H</mi><mo id="S2.E9.m1.2.2.2.2.2.2.3.2.2.1" xref="S2.E9.m1.2.2.2.2.2.2.3.2.2.1.cmml">~</mo></mover><mi id="S2.E9.m1.2.2.2.2.2.2.3.2.3" xref="S2.E9.m1.2.2.2.2.2.2.3.2.3.cmml">p</mi></msub><mo id="S2.E9.m1.2.2.2.2.2.2.3.1" xref="S2.E9.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><msubsup id="S2.E9.m1.2.2.2.2.2.2.3.3" xref="S2.E9.m1.2.2.2.2.2.2.3.3.cmml"><mi id="S2.E9.m1.2.2.2.2.2.2.3.3.2.2" xref="S2.E9.m1.2.2.2.2.2.2.3.3.2.2.cmml">W</mi><mi id="S2.E9.m1.2.2.2.2.2.2.3.3.2.3" xref="S2.E9.m1.2.2.2.2.2.2.3.3.2.3.cmml">n</mi><mi id="S2.E9.m1.2.2.2.2.2.2.3.3.3" xref="S2.E9.m1.2.2.2.2.2.2.3.3.3.cmml">V</mi></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.2b"><apply id="S2.E9.m1.2.2.3.cmml" xref="S2.E9.m1.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.3a.cmml" xref="S2.E9.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1"><eq id="S2.E9.m1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1"></eq><apply id="S2.E9.m1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.1.1.1.1.2">superscript</csymbol><ci id="S2.E9.m1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.2">𝑄</ci><ci id="S2.E9.m1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S2.E9.m1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.3"><times id="S2.E9.m1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.1.1.1.1.3.1"></times><apply id="S2.E9.m1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.3.2.1.cmml" xref="S2.E9.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S2.E9.m1.1.1.1.1.3.2.2.cmml" xref="S2.E9.m1.1.1.1.1.3.2.2"><ci id="S2.E9.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E9.m1.1.1.1.1.3.2.2.1">~</ci><ci id="S2.E9.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.3.2.2.2">𝐻</ci></apply><ci id="S2.E9.m1.1.1.1.1.3.2.3.cmml" xref="S2.E9.m1.1.1.1.1.3.2.3">𝑝</ci></apply><apply id="S2.E9.m1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S2.E9.m1.1.1.1.1.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.E9.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E9.m1.1.1.1.1.3.3.2.2">𝑊</ci><ci id="S2.E9.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.E9.m1.1.1.1.1.3.3.2.3">𝑛</ci></apply><ci id="S2.E9.m1.1.1.1.1.3.3.3.cmml" xref="S2.E9.m1.1.1.1.1.3.3.3">𝑄</ci></apply></apply></apply><apply id="S2.E9.m1.2.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.3a.cmml" xref="S2.E9.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E9.m1.2.2.2.2.1.1.cmml" xref="S2.E9.m1.2.2.2.2.1.1"><eq id="S2.E9.m1.2.2.2.2.1.1.1.cmml" xref="S2.E9.m1.2.2.2.2.1.1.1"></eq><apply id="S2.E9.m1.2.2.2.2.1.1.2.cmml" xref="S2.E9.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E9.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="S2.E9.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E9.m1.2.2.2.2.1.1.2.2">𝐾</ci><ci id="S2.E9.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E9.m1.2.2.2.2.1.1.2.3">𝑛</ci></apply><apply id="S2.E9.m1.2.2.2.2.1.1.3.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3"><times id="S2.E9.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.1"></times><apply id="S2.E9.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.2">subscript</csymbol><apply id="S2.E9.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.2.2"><ci id="S2.E9.m1.2.2.2.2.1.1.3.2.2.1.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.2.2.1">~</ci><ci id="S2.E9.m1.2.2.2.2.1.1.3.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.2.2.2">𝐻</ci></apply><ci id="S2.E9.m1.2.2.2.2.1.1.3.2.3.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.2.3">𝑝</ci></apply><apply id="S2.E9.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.1.1.3.3.1.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.3">superscript</csymbol><apply id="S2.E9.m1.2.2.2.2.1.1.3.3.2.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.1.1.3.3.2.1.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.3">subscript</csymbol><ci id="S2.E9.m1.2.2.2.2.1.1.3.3.2.2.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.3.2.2">𝑊</ci><ci id="S2.E9.m1.2.2.2.2.1.1.3.3.2.3.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.3.2.3">𝑛</ci></apply><ci id="S2.E9.m1.2.2.2.2.1.1.3.3.3.cmml" xref="S2.E9.m1.2.2.2.2.1.1.3.3.3">𝐾</ci></apply></apply></apply><apply id="S2.E9.m1.2.2.2.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2"><eq id="S2.E9.m1.2.2.2.2.2.2.1.cmml" xref="S2.E9.m1.2.2.2.2.2.2.1"></eq><apply id="S2.E9.m1.2.2.2.2.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.E9.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="S2.E9.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2.2.2">𝑉</ci><ci id="S2.E9.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.2.2.2.2.3">𝑛</ci></apply><apply id="S2.E9.m1.2.2.2.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3"><times id="S2.E9.m1.2.2.2.2.2.2.3.1.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.1"></times><apply id="S2.E9.m1.2.2.2.2.2.2.3.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.2.2.3.2.1.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.2">subscript</csymbol><apply id="S2.E9.m1.2.2.2.2.2.2.3.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.2.2"><ci id="S2.E9.m1.2.2.2.2.2.2.3.2.2.1.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.2.2.1">~</ci><ci id="S2.E9.m1.2.2.2.2.2.2.3.2.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.2.2.2">𝐻</ci></apply><ci id="S2.E9.m1.2.2.2.2.2.2.3.2.3.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.2.3">𝑝</ci></apply><apply id="S2.E9.m1.2.2.2.2.2.2.3.3.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.2.2.3.3.1.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.3">superscript</csymbol><apply id="S2.E9.m1.2.2.2.2.2.2.3.3.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.2.2.3.3.2.1.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.3">subscript</csymbol><ci id="S2.E9.m1.2.2.2.2.2.2.3.3.2.2.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.3.2.2">𝑊</ci><ci id="S2.E9.m1.2.2.2.2.2.2.3.3.2.3.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.3.2.3">𝑛</ci></apply><ci id="S2.E9.m1.2.2.2.2.2.2.3.3.3.cmml" xref="S2.E9.m1.2.2.2.2.2.2.3.3.3">𝑉</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.2c">Q^{n}=\widetilde{H}_{p}W_{n}^{Q},\quad K^{n}=\widetilde{H}_{p}W_{n}^{K},\quad V%
^{n}=\widetilde{H}_{p}W_{n}^{V}</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.2d">italic_Q start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT = over~ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , italic_K start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT = over~ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT , italic_V start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT = over~ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT italic_W start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p2.4">We compute attention scores for each head and the final output <math alttext="\varphi_{p}\in\mathbb{R}^{m\times d}" class="ltx_Math" display="inline" id="S2.SS5.p2.4.m1.1"><semantics id="S2.SS5.p2.4.m1.1a"><mrow id="S2.SS5.p2.4.m1.1.1" xref="S2.SS5.p2.4.m1.1.1.cmml"><msub id="S2.SS5.p2.4.m1.1.1.2" xref="S2.SS5.p2.4.m1.1.1.2.cmml"><mi id="S2.SS5.p2.4.m1.1.1.2.2" xref="S2.SS5.p2.4.m1.1.1.2.2.cmml">φ</mi><mi id="S2.SS5.p2.4.m1.1.1.2.3" xref="S2.SS5.p2.4.m1.1.1.2.3.cmml">p</mi></msub><mo id="S2.SS5.p2.4.m1.1.1.1" xref="S2.SS5.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S2.SS5.p2.4.m1.1.1.3" xref="S2.SS5.p2.4.m1.1.1.3.cmml"><mi id="S2.SS5.p2.4.m1.1.1.3.2" xref="S2.SS5.p2.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS5.p2.4.m1.1.1.3.3" xref="S2.SS5.p2.4.m1.1.1.3.3.cmml"><mi id="S2.SS5.p2.4.m1.1.1.3.3.2" xref="S2.SS5.p2.4.m1.1.1.3.3.2.cmml">m</mi><mo id="S2.SS5.p2.4.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS5.p2.4.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS5.p2.4.m1.1.1.3.3.3" xref="S2.SS5.p2.4.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.4.m1.1b"><apply id="S2.SS5.p2.4.m1.1.1.cmml" xref="S2.SS5.p2.4.m1.1.1"><in id="S2.SS5.p2.4.m1.1.1.1.cmml" xref="S2.SS5.p2.4.m1.1.1.1"></in><apply id="S2.SS5.p2.4.m1.1.1.2.cmml" xref="S2.SS5.p2.4.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.p2.4.m1.1.1.2.1.cmml" xref="S2.SS5.p2.4.m1.1.1.2">subscript</csymbol><ci id="S2.SS5.p2.4.m1.1.1.2.2.cmml" xref="S2.SS5.p2.4.m1.1.1.2.2">𝜑</ci><ci id="S2.SS5.p2.4.m1.1.1.2.3.cmml" xref="S2.SS5.p2.4.m1.1.1.2.3">𝑝</ci></apply><apply id="S2.SS5.p2.4.m1.1.1.3.cmml" xref="S2.SS5.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p2.4.m1.1.1.3.1.cmml" xref="S2.SS5.p2.4.m1.1.1.3">superscript</csymbol><ci id="S2.SS5.p2.4.m1.1.1.3.2.cmml" xref="S2.SS5.p2.4.m1.1.1.3.2">ℝ</ci><apply id="S2.SS5.p2.4.m1.1.1.3.3.cmml" xref="S2.SS5.p2.4.m1.1.1.3.3"><times id="S2.SS5.p2.4.m1.1.1.3.3.1.cmml" xref="S2.SS5.p2.4.m1.1.1.3.3.1"></times><ci id="S2.SS5.p2.4.m1.1.1.3.3.2.cmml" xref="S2.SS5.p2.4.m1.1.1.3.3.2">𝑚</ci><ci id="S2.SS5.p2.4.m1.1.1.3.3.3.cmml" xref="S2.SS5.p2.4.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.4.m1.1c">\varphi_{p}\in\mathbb{R}^{m\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.4.m1.1d">italic_φ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_m × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> is obtained by concatenating all heads:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="head_{i}=softmax(\frac{Q^{n}(K^{n})^{\top}}{\sqrt{d/h}})V^{n}" class="ltx_Math" display="block" id="S2.E10.m1.1"><semantics id="S2.E10.m1.1a"><mrow id="S2.E10.m1.1.2" xref="S2.E10.m1.1.2.cmml"><mrow id="S2.E10.m1.1.2.2" xref="S2.E10.m1.1.2.2.cmml"><mi id="S2.E10.m1.1.2.2.2" xref="S2.E10.m1.1.2.2.2.cmml">h</mi><mo id="S2.E10.m1.1.2.2.1" xref="S2.E10.m1.1.2.2.1.cmml">⁢</mo><mi id="S2.E10.m1.1.2.2.3" xref="S2.E10.m1.1.2.2.3.cmml">e</mi><mo id="S2.E10.m1.1.2.2.1a" xref="S2.E10.m1.1.2.2.1.cmml">⁢</mo><mi id="S2.E10.m1.1.2.2.4" xref="S2.E10.m1.1.2.2.4.cmml">a</mi><mo id="S2.E10.m1.1.2.2.1b" xref="S2.E10.m1.1.2.2.1.cmml">⁢</mo><msub id="S2.E10.m1.1.2.2.5" xref="S2.E10.m1.1.2.2.5.cmml"><mi id="S2.E10.m1.1.2.2.5.2" xref="S2.E10.m1.1.2.2.5.2.cmml">d</mi><mi id="S2.E10.m1.1.2.2.5.3" xref="S2.E10.m1.1.2.2.5.3.cmml">i</mi></msub></mrow><mo id="S2.E10.m1.1.2.1" xref="S2.E10.m1.1.2.1.cmml">=</mo><mrow id="S2.E10.m1.1.2.3" xref="S2.E10.m1.1.2.3.cmml"><mi id="S2.E10.m1.1.2.3.2" xref="S2.E10.m1.1.2.3.2.cmml">s</mi><mo id="S2.E10.m1.1.2.3.1" xref="S2.E10.m1.1.2.3.1.cmml">⁢</mo><mi id="S2.E10.m1.1.2.3.3" xref="S2.E10.m1.1.2.3.3.cmml">o</mi><mo id="S2.E10.m1.1.2.3.1a" xref="S2.E10.m1.1.2.3.1.cmml">⁢</mo><mi id="S2.E10.m1.1.2.3.4" xref="S2.E10.m1.1.2.3.4.cmml">f</mi><mo id="S2.E10.m1.1.2.3.1b" xref="S2.E10.m1.1.2.3.1.cmml">⁢</mo><mi id="S2.E10.m1.1.2.3.5" xref="S2.E10.m1.1.2.3.5.cmml">t</mi><mo id="S2.E10.m1.1.2.3.1c" xref="S2.E10.m1.1.2.3.1.cmml">⁢</mo><mi id="S2.E10.m1.1.2.3.6" xref="S2.E10.m1.1.2.3.6.cmml">m</mi><mo id="S2.E10.m1.1.2.3.1d" xref="S2.E10.m1.1.2.3.1.cmml">⁢</mo><mi id="S2.E10.m1.1.2.3.7" xref="S2.E10.m1.1.2.3.7.cmml">a</mi><mo id="S2.E10.m1.1.2.3.1e" xref="S2.E10.m1.1.2.3.1.cmml">⁢</mo><mi id="S2.E10.m1.1.2.3.8" xref="S2.E10.m1.1.2.3.8.cmml">x</mi><mo id="S2.E10.m1.1.2.3.1f" xref="S2.E10.m1.1.2.3.1.cmml">⁢</mo><mrow id="S2.E10.m1.1.2.3.9.2" xref="S2.E10.m1.1.1.cmml"><mo id="S2.E10.m1.1.2.3.9.2.1" stretchy="false" xref="S2.E10.m1.1.1.cmml">(</mo><mfrac id="S2.E10.m1.1.1" xref="S2.E10.m1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1" xref="S2.E10.m1.1.1.1.cmml"><msup id="S2.E10.m1.1.1.1.3" xref="S2.E10.m1.1.1.1.3.cmml"><mi id="S2.E10.m1.1.1.1.3.2" xref="S2.E10.m1.1.1.1.3.2.cmml">Q</mi><mi id="S2.E10.m1.1.1.1.3.3" xref="S2.E10.m1.1.1.1.3.3.cmml">n</mi></msup><mo id="S2.E10.m1.1.1.1.2" xref="S2.E10.m1.1.1.1.2.cmml">⁢</mo><msup id="S2.E10.m1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E10.m1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E10.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S2.E10.m1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.E10.m1.1.1.1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.1.1.1.2.cmml">K</mi><mi id="S2.E10.m1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.1.1.3.cmml">n</mi></msup><mo id="S2.E10.m1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E10.m1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.3.cmml">⊤</mo></msup></mrow><msqrt id="S2.E10.m1.1.1.3" xref="S2.E10.m1.1.1.3.cmml"><mrow id="S2.E10.m1.1.1.3.2" xref="S2.E10.m1.1.1.3.2.cmml"><mi id="S2.E10.m1.1.1.3.2.2" xref="S2.E10.m1.1.1.3.2.2.cmml">d</mi><mo id="S2.E10.m1.1.1.3.2.1" xref="S2.E10.m1.1.1.3.2.1.cmml">/</mo><mi id="S2.E10.m1.1.1.3.2.3" xref="S2.E10.m1.1.1.3.2.3.cmml">h</mi></mrow></msqrt></mfrac><mo id="S2.E10.m1.1.2.3.9.2.2" stretchy="false" xref="S2.E10.m1.1.1.cmml">)</mo></mrow><mo id="S2.E10.m1.1.2.3.1g" xref="S2.E10.m1.1.2.3.1.cmml">⁢</mo><msup id="S2.E10.m1.1.2.3.10" xref="S2.E10.m1.1.2.3.10.cmml"><mi id="S2.E10.m1.1.2.3.10.2" xref="S2.E10.m1.1.2.3.10.2.cmml">V</mi><mi id="S2.E10.m1.1.2.3.10.3" xref="S2.E10.m1.1.2.3.10.3.cmml">n</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.1b"><apply id="S2.E10.m1.1.2.cmml" xref="S2.E10.m1.1.2"><eq id="S2.E10.m1.1.2.1.cmml" xref="S2.E10.m1.1.2.1"></eq><apply id="S2.E10.m1.1.2.2.cmml" xref="S2.E10.m1.1.2.2"><times id="S2.E10.m1.1.2.2.1.cmml" xref="S2.E10.m1.1.2.2.1"></times><ci id="S2.E10.m1.1.2.2.2.cmml" xref="S2.E10.m1.1.2.2.2">ℎ</ci><ci id="S2.E10.m1.1.2.2.3.cmml" xref="S2.E10.m1.1.2.2.3">𝑒</ci><ci id="S2.E10.m1.1.2.2.4.cmml" xref="S2.E10.m1.1.2.2.4">𝑎</ci><apply id="S2.E10.m1.1.2.2.5.cmml" xref="S2.E10.m1.1.2.2.5"><csymbol cd="ambiguous" id="S2.E10.m1.1.2.2.5.1.cmml" xref="S2.E10.m1.1.2.2.5">subscript</csymbol><ci id="S2.E10.m1.1.2.2.5.2.cmml" xref="S2.E10.m1.1.2.2.5.2">𝑑</ci><ci id="S2.E10.m1.1.2.2.5.3.cmml" xref="S2.E10.m1.1.2.2.5.3">𝑖</ci></apply></apply><apply id="S2.E10.m1.1.2.3.cmml" xref="S2.E10.m1.1.2.3"><times id="S2.E10.m1.1.2.3.1.cmml" xref="S2.E10.m1.1.2.3.1"></times><ci id="S2.E10.m1.1.2.3.2.cmml" xref="S2.E10.m1.1.2.3.2">𝑠</ci><ci id="S2.E10.m1.1.2.3.3.cmml" xref="S2.E10.m1.1.2.3.3">𝑜</ci><ci id="S2.E10.m1.1.2.3.4.cmml" xref="S2.E10.m1.1.2.3.4">𝑓</ci><ci id="S2.E10.m1.1.2.3.5.cmml" xref="S2.E10.m1.1.2.3.5">𝑡</ci><ci id="S2.E10.m1.1.2.3.6.cmml" xref="S2.E10.m1.1.2.3.6">𝑚</ci><ci id="S2.E10.m1.1.2.3.7.cmml" xref="S2.E10.m1.1.2.3.7">𝑎</ci><ci id="S2.E10.m1.1.2.3.8.cmml" xref="S2.E10.m1.1.2.3.8">𝑥</ci><apply id="S2.E10.m1.1.1.cmml" xref="S2.E10.m1.1.2.3.9.2"><divide id="S2.E10.m1.1.1.2.cmml" xref="S2.E10.m1.1.2.3.9.2"></divide><apply id="S2.E10.m1.1.1.1.cmml" xref="S2.E10.m1.1.1.1"><times id="S2.E10.m1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.2"></times><apply id="S2.E10.m1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.3.1.cmml" xref="S2.E10.m1.1.1.1.3">superscript</csymbol><ci id="S2.E10.m1.1.1.1.3.2.cmml" xref="S2.E10.m1.1.1.1.3.2">𝑄</ci><ci id="S2.E10.m1.1.1.1.3.3.cmml" xref="S2.E10.m1.1.1.1.3.3">𝑛</ci></apply><apply id="S2.E10.m1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1">superscript</csymbol><apply id="S2.E10.m1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.2">𝐾</ci><ci id="S2.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.3">𝑛</ci></apply><csymbol cd="latexml" id="S2.E10.m1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.3">top</csymbol></apply></apply><apply id="S2.E10.m1.1.1.3.cmml" xref="S2.E10.m1.1.1.3"><root id="S2.E10.m1.1.1.3a.cmml" xref="S2.E10.m1.1.1.3"></root><apply id="S2.E10.m1.1.1.3.2.cmml" xref="S2.E10.m1.1.1.3.2"><divide id="S2.E10.m1.1.1.3.2.1.cmml" xref="S2.E10.m1.1.1.3.2.1"></divide><ci id="S2.E10.m1.1.1.3.2.2.cmml" xref="S2.E10.m1.1.1.3.2.2">𝑑</ci><ci id="S2.E10.m1.1.1.3.2.3.cmml" xref="S2.E10.m1.1.1.3.2.3">ℎ</ci></apply></apply></apply><apply id="S2.E10.m1.1.2.3.10.cmml" xref="S2.E10.m1.1.2.3.10"><csymbol cd="ambiguous" id="S2.E10.m1.1.2.3.10.1.cmml" xref="S2.E10.m1.1.2.3.10">superscript</csymbol><ci id="S2.E10.m1.1.2.3.10.2.cmml" xref="S2.E10.m1.1.2.3.10.2">𝑉</ci><ci id="S2.E10.m1.1.2.3.10.3.cmml" xref="S2.E10.m1.1.2.3.10.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.1c">head_{i}=softmax(\frac{Q^{n}(K^{n})^{\top}}{\sqrt{d/h}})V^{n}</annotation><annotation encoding="application/x-llamapun" id="S2.E10.m1.1d">italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( divide start_ARG italic_Q start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ( italic_K start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d / italic_h end_ARG end_ARG ) italic_V start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\varphi_{p}=concat[head_{1},...,head_{h}]w^{o}" class="ltx_Math" display="block" id="S2.E11.m1.3"><semantics id="S2.E11.m1.3a"><mrow id="S2.E11.m1.3.3" xref="S2.E11.m1.3.3.cmml"><msub id="S2.E11.m1.3.3.4" xref="S2.E11.m1.3.3.4.cmml"><mi id="S2.E11.m1.3.3.4.2" xref="S2.E11.m1.3.3.4.2.cmml">φ</mi><mi id="S2.E11.m1.3.3.4.3" xref="S2.E11.m1.3.3.4.3.cmml">p</mi></msub><mo id="S2.E11.m1.3.3.3" xref="S2.E11.m1.3.3.3.cmml">=</mo><mrow id="S2.E11.m1.3.3.2" xref="S2.E11.m1.3.3.2.cmml"><mi id="S2.E11.m1.3.3.2.4" xref="S2.E11.m1.3.3.2.4.cmml">c</mi><mo id="S2.E11.m1.3.3.2.3" xref="S2.E11.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.E11.m1.3.3.2.5" xref="S2.E11.m1.3.3.2.5.cmml">o</mi><mo id="S2.E11.m1.3.3.2.3a" xref="S2.E11.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.E11.m1.3.3.2.6" xref="S2.E11.m1.3.3.2.6.cmml">n</mi><mo id="S2.E11.m1.3.3.2.3b" xref="S2.E11.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.E11.m1.3.3.2.7" xref="S2.E11.m1.3.3.2.7.cmml">c</mi><mo id="S2.E11.m1.3.3.2.3c" xref="S2.E11.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.E11.m1.3.3.2.8" xref="S2.E11.m1.3.3.2.8.cmml">a</mi><mo id="S2.E11.m1.3.3.2.3d" xref="S2.E11.m1.3.3.2.3.cmml">⁢</mo><mi id="S2.E11.m1.3.3.2.9" xref="S2.E11.m1.3.3.2.9.cmml">t</mi><mo id="S2.E11.m1.3.3.2.3e" xref="S2.E11.m1.3.3.2.3.cmml">⁢</mo><mrow id="S2.E11.m1.3.3.2.2.2" xref="S2.E11.m1.3.3.2.2.3.cmml"><mo id="S2.E11.m1.3.3.2.2.2.3" stretchy="false" xref="S2.E11.m1.3.3.2.2.3.cmml">[</mo><mrow id="S2.E11.m1.2.2.1.1.1.1" xref="S2.E11.m1.2.2.1.1.1.1.cmml"><mi id="S2.E11.m1.2.2.1.1.1.1.2" xref="S2.E11.m1.2.2.1.1.1.1.2.cmml">h</mi><mo id="S2.E11.m1.2.2.1.1.1.1.1" xref="S2.E11.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E11.m1.2.2.1.1.1.1.3" xref="S2.E11.m1.2.2.1.1.1.1.3.cmml">e</mi><mo id="S2.E11.m1.2.2.1.1.1.1.1a" xref="S2.E11.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E11.m1.2.2.1.1.1.1.4" xref="S2.E11.m1.2.2.1.1.1.1.4.cmml">a</mi><mo id="S2.E11.m1.2.2.1.1.1.1.1b" xref="S2.E11.m1.2.2.1.1.1.1.1.cmml">⁢</mo><msub id="S2.E11.m1.2.2.1.1.1.1.5" xref="S2.E11.m1.2.2.1.1.1.1.5.cmml"><mi id="S2.E11.m1.2.2.1.1.1.1.5.2" xref="S2.E11.m1.2.2.1.1.1.1.5.2.cmml">d</mi><mn id="S2.E11.m1.2.2.1.1.1.1.5.3" xref="S2.E11.m1.2.2.1.1.1.1.5.3.cmml">1</mn></msub></mrow><mo id="S2.E11.m1.3.3.2.2.2.4" xref="S2.E11.m1.3.3.2.2.3.cmml">,</mo><mi id="S2.E11.m1.1.1" mathvariant="normal" xref="S2.E11.m1.1.1.cmml">…</mi><mo id="S2.E11.m1.3.3.2.2.2.5" xref="S2.E11.m1.3.3.2.2.3.cmml">,</mo><mrow id="S2.E11.m1.3.3.2.2.2.2" xref="S2.E11.m1.3.3.2.2.2.2.cmml"><mi id="S2.E11.m1.3.3.2.2.2.2.2" xref="S2.E11.m1.3.3.2.2.2.2.2.cmml">h</mi><mo id="S2.E11.m1.3.3.2.2.2.2.1" xref="S2.E11.m1.3.3.2.2.2.2.1.cmml">⁢</mo><mi id="S2.E11.m1.3.3.2.2.2.2.3" xref="S2.E11.m1.3.3.2.2.2.2.3.cmml">e</mi><mo id="S2.E11.m1.3.3.2.2.2.2.1a" xref="S2.E11.m1.3.3.2.2.2.2.1.cmml">⁢</mo><mi id="S2.E11.m1.3.3.2.2.2.2.4" xref="S2.E11.m1.3.3.2.2.2.2.4.cmml">a</mi><mo id="S2.E11.m1.3.3.2.2.2.2.1b" xref="S2.E11.m1.3.3.2.2.2.2.1.cmml">⁢</mo><msub id="S2.E11.m1.3.3.2.2.2.2.5" xref="S2.E11.m1.3.3.2.2.2.2.5.cmml"><mi id="S2.E11.m1.3.3.2.2.2.2.5.2" xref="S2.E11.m1.3.3.2.2.2.2.5.2.cmml">d</mi><mi id="S2.E11.m1.3.3.2.2.2.2.5.3" xref="S2.E11.m1.3.3.2.2.2.2.5.3.cmml">h</mi></msub></mrow><mo id="S2.E11.m1.3.3.2.2.2.6" stretchy="false" xref="S2.E11.m1.3.3.2.2.3.cmml">]</mo></mrow><mo id="S2.E11.m1.3.3.2.3f" xref="S2.E11.m1.3.3.2.3.cmml">⁢</mo><msup id="S2.E11.m1.3.3.2.10" xref="S2.E11.m1.3.3.2.10.cmml"><mi id="S2.E11.m1.3.3.2.10.2" xref="S2.E11.m1.3.3.2.10.2.cmml">w</mi><mi id="S2.E11.m1.3.3.2.10.3" xref="S2.E11.m1.3.3.2.10.3.cmml">o</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m1.3b"><apply id="S2.E11.m1.3.3.cmml" xref="S2.E11.m1.3.3"><eq id="S2.E11.m1.3.3.3.cmml" xref="S2.E11.m1.3.3.3"></eq><apply id="S2.E11.m1.3.3.4.cmml" xref="S2.E11.m1.3.3.4"><csymbol cd="ambiguous" id="S2.E11.m1.3.3.4.1.cmml" xref="S2.E11.m1.3.3.4">subscript</csymbol><ci id="S2.E11.m1.3.3.4.2.cmml" xref="S2.E11.m1.3.3.4.2">𝜑</ci><ci id="S2.E11.m1.3.3.4.3.cmml" xref="S2.E11.m1.3.3.4.3">𝑝</ci></apply><apply id="S2.E11.m1.3.3.2.cmml" xref="S2.E11.m1.3.3.2"><times id="S2.E11.m1.3.3.2.3.cmml" xref="S2.E11.m1.3.3.2.3"></times><ci id="S2.E11.m1.3.3.2.4.cmml" xref="S2.E11.m1.3.3.2.4">𝑐</ci><ci id="S2.E11.m1.3.3.2.5.cmml" xref="S2.E11.m1.3.3.2.5">𝑜</ci><ci id="S2.E11.m1.3.3.2.6.cmml" xref="S2.E11.m1.3.3.2.6">𝑛</ci><ci id="S2.E11.m1.3.3.2.7.cmml" xref="S2.E11.m1.3.3.2.7">𝑐</ci><ci id="S2.E11.m1.3.3.2.8.cmml" xref="S2.E11.m1.3.3.2.8">𝑎</ci><ci id="S2.E11.m1.3.3.2.9.cmml" xref="S2.E11.m1.3.3.2.9">𝑡</ci><list id="S2.E11.m1.3.3.2.2.3.cmml" xref="S2.E11.m1.3.3.2.2.2"><apply id="S2.E11.m1.2.2.1.1.1.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1"><times id="S2.E11.m1.2.2.1.1.1.1.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.1"></times><ci id="S2.E11.m1.2.2.1.1.1.1.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.2">ℎ</ci><ci id="S2.E11.m1.2.2.1.1.1.1.3.cmml" xref="S2.E11.m1.2.2.1.1.1.1.3">𝑒</ci><ci id="S2.E11.m1.2.2.1.1.1.1.4.cmml" xref="S2.E11.m1.2.2.1.1.1.1.4">𝑎</ci><apply id="S2.E11.m1.2.2.1.1.1.1.5.cmml" xref="S2.E11.m1.2.2.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.E11.m1.2.2.1.1.1.1.5.1.cmml" xref="S2.E11.m1.2.2.1.1.1.1.5">subscript</csymbol><ci id="S2.E11.m1.2.2.1.1.1.1.5.2.cmml" xref="S2.E11.m1.2.2.1.1.1.1.5.2">𝑑</ci><cn id="S2.E11.m1.2.2.1.1.1.1.5.3.cmml" type="integer" xref="S2.E11.m1.2.2.1.1.1.1.5.3">1</cn></apply></apply><ci id="S2.E11.m1.1.1.cmml" xref="S2.E11.m1.1.1">…</ci><apply id="S2.E11.m1.3.3.2.2.2.2.cmml" xref="S2.E11.m1.3.3.2.2.2.2"><times id="S2.E11.m1.3.3.2.2.2.2.1.cmml" xref="S2.E11.m1.3.3.2.2.2.2.1"></times><ci id="S2.E11.m1.3.3.2.2.2.2.2.cmml" xref="S2.E11.m1.3.3.2.2.2.2.2">ℎ</ci><ci id="S2.E11.m1.3.3.2.2.2.2.3.cmml" xref="S2.E11.m1.3.3.2.2.2.2.3">𝑒</ci><ci id="S2.E11.m1.3.3.2.2.2.2.4.cmml" xref="S2.E11.m1.3.3.2.2.2.2.4">𝑎</ci><apply id="S2.E11.m1.3.3.2.2.2.2.5.cmml" xref="S2.E11.m1.3.3.2.2.2.2.5"><csymbol cd="ambiguous" id="S2.E11.m1.3.3.2.2.2.2.5.1.cmml" xref="S2.E11.m1.3.3.2.2.2.2.5">subscript</csymbol><ci id="S2.E11.m1.3.3.2.2.2.2.5.2.cmml" xref="S2.E11.m1.3.3.2.2.2.2.5.2">𝑑</ci><ci id="S2.E11.m1.3.3.2.2.2.2.5.3.cmml" xref="S2.E11.m1.3.3.2.2.2.2.5.3">ℎ</ci></apply></apply></list><apply id="S2.E11.m1.3.3.2.10.cmml" xref="S2.E11.m1.3.3.2.10"><csymbol cd="ambiguous" id="S2.E11.m1.3.3.2.10.1.cmml" xref="S2.E11.m1.3.3.2.10">superscript</csymbol><ci id="S2.E11.m1.3.3.2.10.2.cmml" xref="S2.E11.m1.3.3.2.10.2">𝑤</ci><ci id="S2.E11.m1.3.3.2.10.3.cmml" xref="S2.E11.m1.3.3.2.10.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.3c">\varphi_{p}=concat[head_{1},...,head_{h}]w^{o}</annotation><annotation encoding="application/x-llamapun" id="S2.E11.m1.3d">italic_φ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT = italic_c italic_o italic_n italic_c italic_a italic_t [ italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ] italic_w start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p2.5">where <math alttext="w^{o}\in\mathbb{R}^{d\times d}" class="ltx_Math" display="inline" id="S2.SS5.p2.5.m1.1"><semantics id="S2.SS5.p2.5.m1.1a"><mrow id="S2.SS5.p2.5.m1.1.1" xref="S2.SS5.p2.5.m1.1.1.cmml"><msup id="S2.SS5.p2.5.m1.1.1.2" xref="S2.SS5.p2.5.m1.1.1.2.cmml"><mi id="S2.SS5.p2.5.m1.1.1.2.2" xref="S2.SS5.p2.5.m1.1.1.2.2.cmml">w</mi><mi id="S2.SS5.p2.5.m1.1.1.2.3" xref="S2.SS5.p2.5.m1.1.1.2.3.cmml">o</mi></msup><mo id="S2.SS5.p2.5.m1.1.1.1" xref="S2.SS5.p2.5.m1.1.1.1.cmml">∈</mo><msup id="S2.SS5.p2.5.m1.1.1.3" xref="S2.SS5.p2.5.m1.1.1.3.cmml"><mi id="S2.SS5.p2.5.m1.1.1.3.2" xref="S2.SS5.p2.5.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS5.p2.5.m1.1.1.3.3" xref="S2.SS5.p2.5.m1.1.1.3.3.cmml"><mi id="S2.SS5.p2.5.m1.1.1.3.3.2" xref="S2.SS5.p2.5.m1.1.1.3.3.2.cmml">d</mi><mo id="S2.SS5.p2.5.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS5.p2.5.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.SS5.p2.5.m1.1.1.3.3.3" xref="S2.SS5.p2.5.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.5.m1.1b"><apply id="S2.SS5.p2.5.m1.1.1.cmml" xref="S2.SS5.p2.5.m1.1.1"><in id="S2.SS5.p2.5.m1.1.1.1.cmml" xref="S2.SS5.p2.5.m1.1.1.1"></in><apply id="S2.SS5.p2.5.m1.1.1.2.cmml" xref="S2.SS5.p2.5.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.p2.5.m1.1.1.2.1.cmml" xref="S2.SS5.p2.5.m1.1.1.2">superscript</csymbol><ci id="S2.SS5.p2.5.m1.1.1.2.2.cmml" xref="S2.SS5.p2.5.m1.1.1.2.2">𝑤</ci><ci id="S2.SS5.p2.5.m1.1.1.2.3.cmml" xref="S2.SS5.p2.5.m1.1.1.2.3">𝑜</ci></apply><apply id="S2.SS5.p2.5.m1.1.1.3.cmml" xref="S2.SS5.p2.5.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS5.p2.5.m1.1.1.3.1.cmml" xref="S2.SS5.p2.5.m1.1.1.3">superscript</csymbol><ci id="S2.SS5.p2.5.m1.1.1.3.2.cmml" xref="S2.SS5.p2.5.m1.1.1.3.2">ℝ</ci><apply id="S2.SS5.p2.5.m1.1.1.3.3.cmml" xref="S2.SS5.p2.5.m1.1.1.3.3"><times id="S2.SS5.p2.5.m1.1.1.3.3.1.cmml" xref="S2.SS5.p2.5.m1.1.1.3.3.1"></times><ci id="S2.SS5.p2.5.m1.1.1.3.3.2.cmml" xref="S2.SS5.p2.5.m1.1.1.3.3.2">𝑑</ci><ci id="S2.SS5.p2.5.m1.1.1.3.3.3.cmml" xref="S2.SS5.p2.5.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.5.m1.1c">w^{o}\in\mathbb{R}^{d\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p2.5.m1.1d">italic_w start_POSTSUPERSCRIPT italic_o end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS5.p3">
<p class="ltx_p" id="S2.SS5.p3.4">For product choice preferences, we utilize the Gated Linear Unit (GLU). We derive positional embeddings <math alttext="E_{pos}" class="ltx_Math" display="inline" id="S2.SS5.p3.1.m1.1"><semantics id="S2.SS5.p3.1.m1.1a"><msub id="S2.SS5.p3.1.m1.1.1" xref="S2.SS5.p3.1.m1.1.1.cmml"><mi id="S2.SS5.p3.1.m1.1.1.2" xref="S2.SS5.p3.1.m1.1.1.2.cmml">E</mi><mrow id="S2.SS5.p3.1.m1.1.1.3" xref="S2.SS5.p3.1.m1.1.1.3.cmml"><mi id="S2.SS5.p3.1.m1.1.1.3.2" xref="S2.SS5.p3.1.m1.1.1.3.2.cmml">p</mi><mo id="S2.SS5.p3.1.m1.1.1.3.1" xref="S2.SS5.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p3.1.m1.1.1.3.3" xref="S2.SS5.p3.1.m1.1.1.3.3.cmml">o</mi><mo id="S2.SS5.p3.1.m1.1.1.3.1a" xref="S2.SS5.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p3.1.m1.1.1.3.4" xref="S2.SS5.p3.1.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p3.1.m1.1b"><apply id="S2.SS5.p3.1.m1.1.1.cmml" xref="S2.SS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.1.m1.1.1.1.cmml" xref="S2.SS5.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS5.p3.1.m1.1.1.2.cmml" xref="S2.SS5.p3.1.m1.1.1.2">𝐸</ci><apply id="S2.SS5.p3.1.m1.1.1.3.cmml" xref="S2.SS5.p3.1.m1.1.1.3"><times id="S2.SS5.p3.1.m1.1.1.3.1.cmml" xref="S2.SS5.p3.1.m1.1.1.3.1"></times><ci id="S2.SS5.p3.1.m1.1.1.3.2.cmml" xref="S2.SS5.p3.1.m1.1.1.3.2">𝑝</ci><ci id="S2.SS5.p3.1.m1.1.1.3.3.cmml" xref="S2.SS5.p3.1.m1.1.1.3.3">𝑜</ci><ci id="S2.SS5.p3.1.m1.1.1.3.4.cmml" xref="S2.SS5.p3.1.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p3.1.m1.1c">E_{pos}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p3.1.m1.1d">italic_E start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, reversed item embeddings <math alttext="\widetilde{H}^{\prime}_{d}" class="ltx_Math" display="inline" id="S2.SS5.p3.2.m2.1"><semantics id="S2.SS5.p3.2.m2.1a"><msubsup id="S2.SS5.p3.2.m2.1.1" xref="S2.SS5.p3.2.m2.1.1.cmml"><mover accent="true" id="S2.SS5.p3.2.m2.1.1.2.2" xref="S2.SS5.p3.2.m2.1.1.2.2.cmml"><mi id="S2.SS5.p3.2.m2.1.1.2.2.2" xref="S2.SS5.p3.2.m2.1.1.2.2.2.cmml">H</mi><mo id="S2.SS5.p3.2.m2.1.1.2.2.1" xref="S2.SS5.p3.2.m2.1.1.2.2.1.cmml">~</mo></mover><mi id="S2.SS5.p3.2.m2.1.1.3" xref="S2.SS5.p3.2.m2.1.1.3.cmml">d</mi><mo id="S2.SS5.p3.2.m2.1.1.2.3" xref="S2.SS5.p3.2.m2.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS5.p3.2.m2.1b"><apply id="S2.SS5.p3.2.m2.1.1.cmml" xref="S2.SS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.2.m2.1.1.1.cmml" xref="S2.SS5.p3.2.m2.1.1">subscript</csymbol><apply id="S2.SS5.p3.2.m2.1.1.2.cmml" xref="S2.SS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.2.m2.1.1.2.1.cmml" xref="S2.SS5.p3.2.m2.1.1">superscript</csymbol><apply id="S2.SS5.p3.2.m2.1.1.2.2.cmml" xref="S2.SS5.p3.2.m2.1.1.2.2"><ci id="S2.SS5.p3.2.m2.1.1.2.2.1.cmml" xref="S2.SS5.p3.2.m2.1.1.2.2.1">~</ci><ci id="S2.SS5.p3.2.m2.1.1.2.2.2.cmml" xref="S2.SS5.p3.2.m2.1.1.2.2.2">𝐻</ci></apply><ci id="S2.SS5.p3.2.m2.1.1.2.3.cmml" xref="S2.SS5.p3.2.m2.1.1.2.3">′</ci></apply><ci id="S2.SS5.p3.2.m2.1.1.3.cmml" xref="S2.SS5.p3.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p3.2.m2.1c">\widetilde{H}^{\prime}_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p3.2.m2.1d">over~ start_ARG italic_H end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib1" title="">1</a>]</cite>, and basket-level aggregated embeddings <math alttext="H_{bask}" class="ltx_Math" display="inline" id="S2.SS5.p3.3.m3.1"><semantics id="S2.SS5.p3.3.m3.1a"><msub id="S2.SS5.p3.3.m3.1.1" xref="S2.SS5.p3.3.m3.1.1.cmml"><mi id="S2.SS5.p3.3.m3.1.1.2" xref="S2.SS5.p3.3.m3.1.1.2.cmml">H</mi><mrow id="S2.SS5.p3.3.m3.1.1.3" xref="S2.SS5.p3.3.m3.1.1.3.cmml"><mi id="S2.SS5.p3.3.m3.1.1.3.2" xref="S2.SS5.p3.3.m3.1.1.3.2.cmml">b</mi><mo id="S2.SS5.p3.3.m3.1.1.3.1" xref="S2.SS5.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p3.3.m3.1.1.3.3" xref="S2.SS5.p3.3.m3.1.1.3.3.cmml">a</mi><mo id="S2.SS5.p3.3.m3.1.1.3.1a" xref="S2.SS5.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p3.3.m3.1.1.3.4" xref="S2.SS5.p3.3.m3.1.1.3.4.cmml">s</mi><mo id="S2.SS5.p3.3.m3.1.1.3.1b" xref="S2.SS5.p3.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS5.p3.3.m3.1.1.3.5" xref="S2.SS5.p3.3.m3.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p3.3.m3.1b"><apply id="S2.SS5.p3.3.m3.1.1.cmml" xref="S2.SS5.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.3.m3.1.1.1.cmml" xref="S2.SS5.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS5.p3.3.m3.1.1.2.cmml" xref="S2.SS5.p3.3.m3.1.1.2">𝐻</ci><apply id="S2.SS5.p3.3.m3.1.1.3.cmml" xref="S2.SS5.p3.3.m3.1.1.3"><times id="S2.SS5.p3.3.m3.1.1.3.1.cmml" xref="S2.SS5.p3.3.m3.1.1.3.1"></times><ci id="S2.SS5.p3.3.m3.1.1.3.2.cmml" xref="S2.SS5.p3.3.m3.1.1.3.2">𝑏</ci><ci id="S2.SS5.p3.3.m3.1.1.3.3.cmml" xref="S2.SS5.p3.3.m3.1.1.3.3">𝑎</ci><ci id="S2.SS5.p3.3.m3.1.1.3.4.cmml" xref="S2.SS5.p3.3.m3.1.1.3.4">𝑠</ci><ci id="S2.SS5.p3.3.m3.1.1.3.5.cmml" xref="S2.SS5.p3.3.m3.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p3.3.m3.1c">H_{bask}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p3.3.m3.1d">italic_H start_POSTSUBSCRIPT italic_b italic_a italic_s italic_k end_POSTSUBSCRIPT</annotation></semantics></math> that are derived from the original item embeddings <math alttext="\widetilde{H}_{d}=concat[\widetilde{h}^{d}_{1},\dots,\widetilde{h}^{d}_{m}]" class="ltx_Math" display="inline" id="S2.SS5.p3.4.m4.3"><semantics id="S2.SS5.p3.4.m4.3a"><mrow id="S2.SS5.p3.4.m4.3.3" xref="S2.SS5.p3.4.m4.3.3.cmml"><msub id="S2.SS5.p3.4.m4.3.3.4" xref="S2.SS5.p3.4.m4.3.3.4.cmml"><mover accent="true" id="S2.SS5.p3.4.m4.3.3.4.2" xref="S2.SS5.p3.4.m4.3.3.4.2.cmml"><mi id="S2.SS5.p3.4.m4.3.3.4.2.2" xref="S2.SS5.p3.4.m4.3.3.4.2.2.cmml">H</mi><mo id="S2.SS5.p3.4.m4.3.3.4.2.1" xref="S2.SS5.p3.4.m4.3.3.4.2.1.cmml">~</mo></mover><mi id="S2.SS5.p3.4.m4.3.3.4.3" xref="S2.SS5.p3.4.m4.3.3.4.3.cmml">d</mi></msub><mo id="S2.SS5.p3.4.m4.3.3.3" xref="S2.SS5.p3.4.m4.3.3.3.cmml">=</mo><mrow id="S2.SS5.p3.4.m4.3.3.2" xref="S2.SS5.p3.4.m4.3.3.2.cmml"><mi id="S2.SS5.p3.4.m4.3.3.2.4" xref="S2.SS5.p3.4.m4.3.3.2.4.cmml">c</mi><mo id="S2.SS5.p3.4.m4.3.3.2.3" xref="S2.SS5.p3.4.m4.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p3.4.m4.3.3.2.5" xref="S2.SS5.p3.4.m4.3.3.2.5.cmml">o</mi><mo id="S2.SS5.p3.4.m4.3.3.2.3a" xref="S2.SS5.p3.4.m4.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p3.4.m4.3.3.2.6" xref="S2.SS5.p3.4.m4.3.3.2.6.cmml">n</mi><mo id="S2.SS5.p3.4.m4.3.3.2.3b" xref="S2.SS5.p3.4.m4.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p3.4.m4.3.3.2.7" xref="S2.SS5.p3.4.m4.3.3.2.7.cmml">c</mi><mo id="S2.SS5.p3.4.m4.3.3.2.3c" xref="S2.SS5.p3.4.m4.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p3.4.m4.3.3.2.8" xref="S2.SS5.p3.4.m4.3.3.2.8.cmml">a</mi><mo id="S2.SS5.p3.4.m4.3.3.2.3d" xref="S2.SS5.p3.4.m4.3.3.2.3.cmml">⁢</mo><mi id="S2.SS5.p3.4.m4.3.3.2.9" xref="S2.SS5.p3.4.m4.3.3.2.9.cmml">t</mi><mo id="S2.SS5.p3.4.m4.3.3.2.3e" xref="S2.SS5.p3.4.m4.3.3.2.3.cmml">⁢</mo><mrow id="S2.SS5.p3.4.m4.3.3.2.2.2" xref="S2.SS5.p3.4.m4.3.3.2.2.3.cmml"><mo id="S2.SS5.p3.4.m4.3.3.2.2.2.3" stretchy="false" xref="S2.SS5.p3.4.m4.3.3.2.2.3.cmml">[</mo><msubsup id="S2.SS5.p3.4.m4.2.2.1.1.1.1" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.cmml"><mover accent="true" id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.cmml"><mi id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.2" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.2.cmml">h</mi><mo id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.1" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.1.cmml">~</mo></mover><mn id="S2.SS5.p3.4.m4.2.2.1.1.1.1.3" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.3.cmml">1</mn><mi id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.3" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="S2.SS5.p3.4.m4.3.3.2.2.2.4" xref="S2.SS5.p3.4.m4.3.3.2.2.3.cmml">,</mo><mi id="S2.SS5.p3.4.m4.1.1" mathvariant="normal" xref="S2.SS5.p3.4.m4.1.1.cmml">…</mi><mo id="S2.SS5.p3.4.m4.3.3.2.2.2.5" xref="S2.SS5.p3.4.m4.3.3.2.2.3.cmml">,</mo><msubsup id="S2.SS5.p3.4.m4.3.3.2.2.2.2" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.cmml"><mover accent="true" id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.cmml"><mi id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.2" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.2.cmml">h</mi><mo id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.1" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S2.SS5.p3.4.m4.3.3.2.2.2.2.3" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.3.cmml">m</mi><mi id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.3" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.3.cmml">d</mi></msubsup><mo id="S2.SS5.p3.4.m4.3.3.2.2.2.6" stretchy="false" xref="S2.SS5.p3.4.m4.3.3.2.2.3.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS5.p3.4.m4.3b"><apply id="S2.SS5.p3.4.m4.3.3.cmml" xref="S2.SS5.p3.4.m4.3.3"><eq id="S2.SS5.p3.4.m4.3.3.3.cmml" xref="S2.SS5.p3.4.m4.3.3.3"></eq><apply id="S2.SS5.p3.4.m4.3.3.4.cmml" xref="S2.SS5.p3.4.m4.3.3.4"><csymbol cd="ambiguous" id="S2.SS5.p3.4.m4.3.3.4.1.cmml" xref="S2.SS5.p3.4.m4.3.3.4">subscript</csymbol><apply id="S2.SS5.p3.4.m4.3.3.4.2.cmml" xref="S2.SS5.p3.4.m4.3.3.4.2"><ci id="S2.SS5.p3.4.m4.3.3.4.2.1.cmml" xref="S2.SS5.p3.4.m4.3.3.4.2.1">~</ci><ci id="S2.SS5.p3.4.m4.3.3.4.2.2.cmml" xref="S2.SS5.p3.4.m4.3.3.4.2.2">𝐻</ci></apply><ci id="S2.SS5.p3.4.m4.3.3.4.3.cmml" xref="S2.SS5.p3.4.m4.3.3.4.3">𝑑</ci></apply><apply id="S2.SS5.p3.4.m4.3.3.2.cmml" xref="S2.SS5.p3.4.m4.3.3.2"><times id="S2.SS5.p3.4.m4.3.3.2.3.cmml" xref="S2.SS5.p3.4.m4.3.3.2.3"></times><ci id="S2.SS5.p3.4.m4.3.3.2.4.cmml" xref="S2.SS5.p3.4.m4.3.3.2.4">𝑐</ci><ci id="S2.SS5.p3.4.m4.3.3.2.5.cmml" xref="S2.SS5.p3.4.m4.3.3.2.5">𝑜</ci><ci id="S2.SS5.p3.4.m4.3.3.2.6.cmml" xref="S2.SS5.p3.4.m4.3.3.2.6">𝑛</ci><ci id="S2.SS5.p3.4.m4.3.3.2.7.cmml" xref="S2.SS5.p3.4.m4.3.3.2.7">𝑐</ci><ci id="S2.SS5.p3.4.m4.3.3.2.8.cmml" xref="S2.SS5.p3.4.m4.3.3.2.8">𝑎</ci><ci id="S2.SS5.p3.4.m4.3.3.2.9.cmml" xref="S2.SS5.p3.4.m4.3.3.2.9">𝑡</ci><list id="S2.SS5.p3.4.m4.3.3.2.2.3.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2"><apply id="S2.SS5.p3.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.4.m4.2.2.1.1.1.1.1.cmml" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1">subscript</csymbol><apply id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.cmml" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.1.cmml" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1">superscript</csymbol><apply id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.cmml" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2"><ci id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.1.cmml" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.1">~</ci><ci id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.2.cmml" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.2.2">ℎ</ci></apply><ci id="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.3.cmml" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.2.3">𝑑</ci></apply><cn id="S2.SS5.p3.4.m4.2.2.1.1.1.1.3.cmml" type="integer" xref="S2.SS5.p3.4.m4.2.2.1.1.1.1.3">1</cn></apply><ci id="S2.SS5.p3.4.m4.1.1.cmml" xref="S2.SS5.p3.4.m4.1.1">…</ci><apply id="S2.SS5.p3.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p3.4.m4.3.3.2.2.2.2.1.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2">subscript</csymbol><apply id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.1.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2">superscript</csymbol><apply id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2"><ci id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.1.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.1">~</ci><ci id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.2.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.2.2">ℎ</ci></apply><ci id="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.3.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.2.3">𝑑</ci></apply><ci id="S2.SS5.p3.4.m4.3.3.2.2.2.2.3.cmml" xref="S2.SS5.p3.4.m4.3.3.2.2.2.2.3">𝑚</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p3.4.m4.3c">\widetilde{H}_{d}=concat[\widetilde{h}^{d}_{1},\dots,\widetilde{h}^{d}_{m}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p3.4.m4.3d">over~ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = italic_c italic_o italic_n italic_c italic_a italic_t [ over~ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , over~ start_ARG italic_h end_ARG start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ]</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="H_{bask}=\frac{1}{L_{b}}\sum_{j=1}^{L_{b}}\widetilde{H}^{\prime}_{d}[j]" class="ltx_Math" display="block" id="S2.E12.m1.1"><semantics id="S2.E12.m1.1a"><mrow id="S2.E12.m1.1.2" xref="S2.E12.m1.1.2.cmml"><msub id="S2.E12.m1.1.2.2" xref="S2.E12.m1.1.2.2.cmml"><mi id="S2.E12.m1.1.2.2.2" xref="S2.E12.m1.1.2.2.2.cmml">H</mi><mrow id="S2.E12.m1.1.2.2.3" xref="S2.E12.m1.1.2.2.3.cmml"><mi id="S2.E12.m1.1.2.2.3.2" xref="S2.E12.m1.1.2.2.3.2.cmml">b</mi><mo id="S2.E12.m1.1.2.2.3.1" xref="S2.E12.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E12.m1.1.2.2.3.3" xref="S2.E12.m1.1.2.2.3.3.cmml">a</mi><mo id="S2.E12.m1.1.2.2.3.1a" xref="S2.E12.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E12.m1.1.2.2.3.4" xref="S2.E12.m1.1.2.2.3.4.cmml">s</mi><mo id="S2.E12.m1.1.2.2.3.1b" xref="S2.E12.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S2.E12.m1.1.2.2.3.5" xref="S2.E12.m1.1.2.2.3.5.cmml">k</mi></mrow></msub><mo id="S2.E12.m1.1.2.1" xref="S2.E12.m1.1.2.1.cmml">=</mo><mrow id="S2.E12.m1.1.2.3" xref="S2.E12.m1.1.2.3.cmml"><mfrac id="S2.E12.m1.1.2.3.2" xref="S2.E12.m1.1.2.3.2.cmml"><mn id="S2.E12.m1.1.2.3.2.2" xref="S2.E12.m1.1.2.3.2.2.cmml">1</mn><msub id="S2.E12.m1.1.2.3.2.3" xref="S2.E12.m1.1.2.3.2.3.cmml"><mi id="S2.E12.m1.1.2.3.2.3.2" xref="S2.E12.m1.1.2.3.2.3.2.cmml">L</mi><mi id="S2.E12.m1.1.2.3.2.3.3" xref="S2.E12.m1.1.2.3.2.3.3.cmml">b</mi></msub></mfrac><mo id="S2.E12.m1.1.2.3.1" xref="S2.E12.m1.1.2.3.1.cmml">⁢</mo><mrow id="S2.E12.m1.1.2.3.3" xref="S2.E12.m1.1.2.3.3.cmml"><munderover id="S2.E12.m1.1.2.3.3.1" xref="S2.E12.m1.1.2.3.3.1.cmml"><mo id="S2.E12.m1.1.2.3.3.1.2.2" movablelimits="false" xref="S2.E12.m1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S2.E12.m1.1.2.3.3.1.2.3" xref="S2.E12.m1.1.2.3.3.1.2.3.cmml"><mi id="S2.E12.m1.1.2.3.3.1.2.3.2" xref="S2.E12.m1.1.2.3.3.1.2.3.2.cmml">j</mi><mo id="S2.E12.m1.1.2.3.3.1.2.3.1" xref="S2.E12.m1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S2.E12.m1.1.2.3.3.1.2.3.3" xref="S2.E12.m1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S2.E12.m1.1.2.3.3.1.3" xref="S2.E12.m1.1.2.3.3.1.3.cmml"><mi id="S2.E12.m1.1.2.3.3.1.3.2" xref="S2.E12.m1.1.2.3.3.1.3.2.cmml">L</mi><mi id="S2.E12.m1.1.2.3.3.1.3.3" xref="S2.E12.m1.1.2.3.3.1.3.3.cmml">b</mi></msub></munderover><mrow id="S2.E12.m1.1.2.3.3.2" xref="S2.E12.m1.1.2.3.3.2.cmml"><msubsup id="S2.E12.m1.1.2.3.3.2.2" xref="S2.E12.m1.1.2.3.3.2.2.cmml"><mover accent="true" id="S2.E12.m1.1.2.3.3.2.2.2.2" xref="S2.E12.m1.1.2.3.3.2.2.2.2.cmml"><mi id="S2.E12.m1.1.2.3.3.2.2.2.2.2" xref="S2.E12.m1.1.2.3.3.2.2.2.2.2.cmml">H</mi><mo id="S2.E12.m1.1.2.3.3.2.2.2.2.1" xref="S2.E12.m1.1.2.3.3.2.2.2.2.1.cmml">~</mo></mover><mi id="S2.E12.m1.1.2.3.3.2.2.3" xref="S2.E12.m1.1.2.3.3.2.2.3.cmml">d</mi><mo id="S2.E12.m1.1.2.3.3.2.2.2.3" xref="S2.E12.m1.1.2.3.3.2.2.2.3.cmml">′</mo></msubsup><mo id="S2.E12.m1.1.2.3.3.2.1" xref="S2.E12.m1.1.2.3.3.2.1.cmml">⁢</mo><mrow id="S2.E12.m1.1.2.3.3.2.3.2" xref="S2.E12.m1.1.2.3.3.2.3.1.cmml"><mo id="S2.E12.m1.1.2.3.3.2.3.2.1" stretchy="false" xref="S2.E12.m1.1.2.3.3.2.3.1.1.cmml">[</mo><mi id="S2.E12.m1.1.1" xref="S2.E12.m1.1.1.cmml">j</mi><mo id="S2.E12.m1.1.2.3.3.2.3.2.2" stretchy="false" xref="S2.E12.m1.1.2.3.3.2.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.1b"><apply id="S2.E12.m1.1.2.cmml" xref="S2.E12.m1.1.2"><eq id="S2.E12.m1.1.2.1.cmml" xref="S2.E12.m1.1.2.1"></eq><apply id="S2.E12.m1.1.2.2.cmml" xref="S2.E12.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.2.1.cmml" xref="S2.E12.m1.1.2.2">subscript</csymbol><ci id="S2.E12.m1.1.2.2.2.cmml" xref="S2.E12.m1.1.2.2.2">𝐻</ci><apply id="S2.E12.m1.1.2.2.3.cmml" xref="S2.E12.m1.1.2.2.3"><times id="S2.E12.m1.1.2.2.3.1.cmml" xref="S2.E12.m1.1.2.2.3.1"></times><ci id="S2.E12.m1.1.2.2.3.2.cmml" xref="S2.E12.m1.1.2.2.3.2">𝑏</ci><ci id="S2.E12.m1.1.2.2.3.3.cmml" xref="S2.E12.m1.1.2.2.3.3">𝑎</ci><ci id="S2.E12.m1.1.2.2.3.4.cmml" xref="S2.E12.m1.1.2.2.3.4">𝑠</ci><ci id="S2.E12.m1.1.2.2.3.5.cmml" xref="S2.E12.m1.1.2.2.3.5">𝑘</ci></apply></apply><apply id="S2.E12.m1.1.2.3.cmml" xref="S2.E12.m1.1.2.3"><times id="S2.E12.m1.1.2.3.1.cmml" xref="S2.E12.m1.1.2.3.1"></times><apply id="S2.E12.m1.1.2.3.2.cmml" xref="S2.E12.m1.1.2.3.2"><divide id="S2.E12.m1.1.2.3.2.1.cmml" xref="S2.E12.m1.1.2.3.2"></divide><cn id="S2.E12.m1.1.2.3.2.2.cmml" type="integer" xref="S2.E12.m1.1.2.3.2.2">1</cn><apply id="S2.E12.m1.1.2.3.2.3.cmml" xref="S2.E12.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.3.2.3.1.cmml" xref="S2.E12.m1.1.2.3.2.3">subscript</csymbol><ci id="S2.E12.m1.1.2.3.2.3.2.cmml" xref="S2.E12.m1.1.2.3.2.3.2">𝐿</ci><ci id="S2.E12.m1.1.2.3.2.3.3.cmml" xref="S2.E12.m1.1.2.3.2.3.3">𝑏</ci></apply></apply><apply id="S2.E12.m1.1.2.3.3.cmml" xref="S2.E12.m1.1.2.3.3"><apply id="S2.E12.m1.1.2.3.3.1.cmml" xref="S2.E12.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.3.3.1.1.cmml" xref="S2.E12.m1.1.2.3.3.1">superscript</csymbol><apply id="S2.E12.m1.1.2.3.3.1.2.cmml" xref="S2.E12.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.3.3.1.2.1.cmml" xref="S2.E12.m1.1.2.3.3.1">subscript</csymbol><sum id="S2.E12.m1.1.2.3.3.1.2.2.cmml" xref="S2.E12.m1.1.2.3.3.1.2.2"></sum><apply id="S2.E12.m1.1.2.3.3.1.2.3.cmml" xref="S2.E12.m1.1.2.3.3.1.2.3"><eq id="S2.E12.m1.1.2.3.3.1.2.3.1.cmml" xref="S2.E12.m1.1.2.3.3.1.2.3.1"></eq><ci id="S2.E12.m1.1.2.3.3.1.2.3.2.cmml" xref="S2.E12.m1.1.2.3.3.1.2.3.2">𝑗</ci><cn id="S2.E12.m1.1.2.3.3.1.2.3.3.cmml" type="integer" xref="S2.E12.m1.1.2.3.3.1.2.3.3">1</cn></apply></apply><apply id="S2.E12.m1.1.2.3.3.1.3.cmml" xref="S2.E12.m1.1.2.3.3.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.3.3.1.3.1.cmml" xref="S2.E12.m1.1.2.3.3.1.3">subscript</csymbol><ci id="S2.E12.m1.1.2.3.3.1.3.2.cmml" xref="S2.E12.m1.1.2.3.3.1.3.2">𝐿</ci><ci id="S2.E12.m1.1.2.3.3.1.3.3.cmml" xref="S2.E12.m1.1.2.3.3.1.3.3">𝑏</ci></apply></apply><apply id="S2.E12.m1.1.2.3.3.2.cmml" xref="S2.E12.m1.1.2.3.3.2"><times id="S2.E12.m1.1.2.3.3.2.1.cmml" xref="S2.E12.m1.1.2.3.3.2.1"></times><apply id="S2.E12.m1.1.2.3.3.2.2.cmml" xref="S2.E12.m1.1.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.3.3.2.2.1.cmml" xref="S2.E12.m1.1.2.3.3.2.2">subscript</csymbol><apply id="S2.E12.m1.1.2.3.3.2.2.2.cmml" xref="S2.E12.m1.1.2.3.3.2.2"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.3.3.2.2.2.1.cmml" xref="S2.E12.m1.1.2.3.3.2.2">superscript</csymbol><apply id="S2.E12.m1.1.2.3.3.2.2.2.2.cmml" xref="S2.E12.m1.1.2.3.3.2.2.2.2"><ci id="S2.E12.m1.1.2.3.3.2.2.2.2.1.cmml" xref="S2.E12.m1.1.2.3.3.2.2.2.2.1">~</ci><ci id="S2.E12.m1.1.2.3.3.2.2.2.2.2.cmml" xref="S2.E12.m1.1.2.3.3.2.2.2.2.2">𝐻</ci></apply><ci id="S2.E12.m1.1.2.3.3.2.2.2.3.cmml" xref="S2.E12.m1.1.2.3.3.2.2.2.3">′</ci></apply><ci id="S2.E12.m1.1.2.3.3.2.2.3.cmml" xref="S2.E12.m1.1.2.3.3.2.2.3">𝑑</ci></apply><apply id="S2.E12.m1.1.2.3.3.2.3.1.cmml" xref="S2.E12.m1.1.2.3.3.2.3.2"><csymbol cd="latexml" id="S2.E12.m1.1.2.3.3.2.3.1.1.cmml" xref="S2.E12.m1.1.2.3.3.2.3.2.1">delimited-[]</csymbol><ci id="S2.E12.m1.1.1.cmml" xref="S2.E12.m1.1.1">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.1c">H_{bask}=\frac{1}{L_{b}}\sum_{j=1}^{L_{b}}\widetilde{H}^{\prime}_{d}[j]</annotation><annotation encoding="application/x-llamapun" id="S2.E12.m1.1d">italic_H start_POSTSUBSCRIPT italic_b italic_a italic_s italic_k end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_L start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT over~ start_ARG italic_H end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT [ italic_j ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="GLU\_N=GLU(E_{pos},\widetilde{H}^{\prime}_{d},H_{bask})" class="ltx_Math" display="block" id="S2.E13.m1.3"><semantics id="S2.E13.m1.3a"><mrow id="S2.E13.m1.3.3" xref="S2.E13.m1.3.3.cmml"><mrow id="S2.E13.m1.3.3.5" xref="S2.E13.m1.3.3.5.cmml"><mi id="S2.E13.m1.3.3.5.2" xref="S2.E13.m1.3.3.5.2.cmml">G</mi><mo id="S2.E13.m1.3.3.5.1" xref="S2.E13.m1.3.3.5.1.cmml">⁢</mo><mi id="S2.E13.m1.3.3.5.3" xref="S2.E13.m1.3.3.5.3.cmml">L</mi><mo id="S2.E13.m1.3.3.5.1a" xref="S2.E13.m1.3.3.5.1.cmml">⁢</mo><mi id="S2.E13.m1.3.3.5.4" xref="S2.E13.m1.3.3.5.4.cmml">U</mi><mo id="S2.E13.m1.3.3.5.1b" xref="S2.E13.m1.3.3.5.1.cmml">⁢</mo><mi id="S2.E13.m1.3.3.5.5" mathvariant="normal" xref="S2.E13.m1.3.3.5.5.cmml">_</mi><mo id="S2.E13.m1.3.3.5.1c" xref="S2.E13.m1.3.3.5.1.cmml">⁢</mo><mi id="S2.E13.m1.3.3.5.6" xref="S2.E13.m1.3.3.5.6.cmml">N</mi></mrow><mo id="S2.E13.m1.3.3.4" xref="S2.E13.m1.3.3.4.cmml">=</mo><mrow id="S2.E13.m1.3.3.3" xref="S2.E13.m1.3.3.3.cmml"><mi id="S2.E13.m1.3.3.3.5" xref="S2.E13.m1.3.3.3.5.cmml">G</mi><mo id="S2.E13.m1.3.3.3.4" xref="S2.E13.m1.3.3.3.4.cmml">⁢</mo><mi id="S2.E13.m1.3.3.3.6" xref="S2.E13.m1.3.3.3.6.cmml">L</mi><mo id="S2.E13.m1.3.3.3.4a" xref="S2.E13.m1.3.3.3.4.cmml">⁢</mo><mi id="S2.E13.m1.3.3.3.7" xref="S2.E13.m1.3.3.3.7.cmml">U</mi><mo id="S2.E13.m1.3.3.3.4b" xref="S2.E13.m1.3.3.3.4.cmml">⁢</mo><mrow id="S2.E13.m1.3.3.3.3.3" xref="S2.E13.m1.3.3.3.3.4.cmml"><mo id="S2.E13.m1.3.3.3.3.3.4" stretchy="false" xref="S2.E13.m1.3.3.3.3.4.cmml">(</mo><msub id="S2.E13.m1.1.1.1.1.1.1" xref="S2.E13.m1.1.1.1.1.1.1.cmml"><mi id="S2.E13.m1.1.1.1.1.1.1.2" xref="S2.E13.m1.1.1.1.1.1.1.2.cmml">E</mi><mrow id="S2.E13.m1.1.1.1.1.1.1.3" xref="S2.E13.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E13.m1.1.1.1.1.1.1.3.2" xref="S2.E13.m1.1.1.1.1.1.1.3.2.cmml">p</mi><mo id="S2.E13.m1.1.1.1.1.1.1.3.1" xref="S2.E13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E13.m1.1.1.1.1.1.1.3.3" xref="S2.E13.m1.1.1.1.1.1.1.3.3.cmml">o</mi><mo id="S2.E13.m1.1.1.1.1.1.1.3.1a" xref="S2.E13.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E13.m1.1.1.1.1.1.1.3.4" xref="S2.E13.m1.1.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo id="S2.E13.m1.3.3.3.3.3.5" xref="S2.E13.m1.3.3.3.3.4.cmml">,</mo><msubsup id="S2.E13.m1.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.cmml"><mover accent="true" id="S2.E13.m1.2.2.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E13.m1.2.2.2.2.2.2.2.2.2" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2.cmml">H</mi><mo id="S2.E13.m1.2.2.2.2.2.2.2.2.1" xref="S2.E13.m1.2.2.2.2.2.2.2.2.1.cmml">~</mo></mover><mi id="S2.E13.m1.2.2.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.2.2.3.cmml">d</mi><mo id="S2.E13.m1.2.2.2.2.2.2.2.3" xref="S2.E13.m1.2.2.2.2.2.2.2.3.cmml">′</mo></msubsup><mo id="S2.E13.m1.3.3.3.3.3.6" xref="S2.E13.m1.3.3.3.3.4.cmml">,</mo><msub id="S2.E13.m1.3.3.3.3.3.3" xref="S2.E13.m1.3.3.3.3.3.3.cmml"><mi id="S2.E13.m1.3.3.3.3.3.3.2" xref="S2.E13.m1.3.3.3.3.3.3.2.cmml">H</mi><mrow id="S2.E13.m1.3.3.3.3.3.3.3" xref="S2.E13.m1.3.3.3.3.3.3.3.cmml"><mi id="S2.E13.m1.3.3.3.3.3.3.3.2" xref="S2.E13.m1.3.3.3.3.3.3.3.2.cmml">b</mi><mo id="S2.E13.m1.3.3.3.3.3.3.3.1" xref="S2.E13.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E13.m1.3.3.3.3.3.3.3.3" xref="S2.E13.m1.3.3.3.3.3.3.3.3.cmml">a</mi><mo id="S2.E13.m1.3.3.3.3.3.3.3.1a" xref="S2.E13.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E13.m1.3.3.3.3.3.3.3.4" xref="S2.E13.m1.3.3.3.3.3.3.3.4.cmml">s</mi><mo id="S2.E13.m1.3.3.3.3.3.3.3.1b" xref="S2.E13.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="S2.E13.m1.3.3.3.3.3.3.3.5" xref="S2.E13.m1.3.3.3.3.3.3.3.5.cmml">k</mi></mrow></msub><mo id="S2.E13.m1.3.3.3.3.3.7" stretchy="false" xref="S2.E13.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E13.m1.3b"><apply id="S2.E13.m1.3.3.cmml" xref="S2.E13.m1.3.3"><eq id="S2.E13.m1.3.3.4.cmml" xref="S2.E13.m1.3.3.4"></eq><apply id="S2.E13.m1.3.3.5.cmml" xref="S2.E13.m1.3.3.5"><times id="S2.E13.m1.3.3.5.1.cmml" xref="S2.E13.m1.3.3.5.1"></times><ci id="S2.E13.m1.3.3.5.2.cmml" xref="S2.E13.m1.3.3.5.2">𝐺</ci><ci id="S2.E13.m1.3.3.5.3.cmml" xref="S2.E13.m1.3.3.5.3">𝐿</ci><ci id="S2.E13.m1.3.3.5.4.cmml" xref="S2.E13.m1.3.3.5.4">𝑈</ci><ci id="S2.E13.m1.3.3.5.5.cmml" xref="S2.E13.m1.3.3.5.5">_</ci><ci id="S2.E13.m1.3.3.5.6.cmml" xref="S2.E13.m1.3.3.5.6">𝑁</ci></apply><apply id="S2.E13.m1.3.3.3.cmml" xref="S2.E13.m1.3.3.3"><times id="S2.E13.m1.3.3.3.4.cmml" xref="S2.E13.m1.3.3.3.4"></times><ci id="S2.E13.m1.3.3.3.5.cmml" xref="S2.E13.m1.3.3.3.5">𝐺</ci><ci id="S2.E13.m1.3.3.3.6.cmml" xref="S2.E13.m1.3.3.3.6">𝐿</ci><ci id="S2.E13.m1.3.3.3.7.cmml" xref="S2.E13.m1.3.3.3.7">𝑈</ci><vector id="S2.E13.m1.3.3.3.3.4.cmml" xref="S2.E13.m1.3.3.3.3.3"><apply id="S2.E13.m1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E13.m1.1.1.1.1.1.1.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E13.m1.1.1.1.1.1.1.2.cmml" xref="S2.E13.m1.1.1.1.1.1.1.2">𝐸</ci><apply id="S2.E13.m1.1.1.1.1.1.1.3.cmml" xref="S2.E13.m1.1.1.1.1.1.1.3"><times id="S2.E13.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E13.m1.1.1.1.1.1.1.3.1"></times><ci id="S2.E13.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E13.m1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S2.E13.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E13.m1.1.1.1.1.1.1.3.3">𝑜</ci><ci id="S2.E13.m1.1.1.1.1.1.1.3.4.cmml" xref="S2.E13.m1.1.1.1.1.1.1.3.4">𝑠</ci></apply></apply><apply id="S2.E13.m1.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S2.E13.m1.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E13.m1.2.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E13.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2"><ci id="S2.E13.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.1">~</ci><ci id="S2.E13.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.2.2">𝐻</ci></apply><ci id="S2.E13.m1.2.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2.2.2.3">′</ci></apply><ci id="S2.E13.m1.2.2.2.2.2.2.3.cmml" xref="S2.E13.m1.2.2.2.2.2.2.3">𝑑</ci></apply><apply id="S2.E13.m1.3.3.3.3.3.3.cmml" xref="S2.E13.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.E13.m1.3.3.3.3.3.3.1.cmml" xref="S2.E13.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S2.E13.m1.3.3.3.3.3.3.2.cmml" xref="S2.E13.m1.3.3.3.3.3.3.2">𝐻</ci><apply id="S2.E13.m1.3.3.3.3.3.3.3.cmml" xref="S2.E13.m1.3.3.3.3.3.3.3"><times id="S2.E13.m1.3.3.3.3.3.3.3.1.cmml" xref="S2.E13.m1.3.3.3.3.3.3.3.1"></times><ci id="S2.E13.m1.3.3.3.3.3.3.3.2.cmml" xref="S2.E13.m1.3.3.3.3.3.3.3.2">𝑏</ci><ci id="S2.E13.m1.3.3.3.3.3.3.3.3.cmml" xref="S2.E13.m1.3.3.3.3.3.3.3.3">𝑎</ci><ci id="S2.E13.m1.3.3.3.3.3.3.3.4.cmml" xref="S2.E13.m1.3.3.3.3.3.3.3.4">𝑠</ci><ci id="S2.E13.m1.3.3.3.3.3.3.3.5.cmml" xref="S2.E13.m1.3.3.3.3.3.3.3.5">𝑘</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E13.m1.3c">GLU\_N=GLU(E_{pos},\widetilde{H}^{\prime}_{d},H_{bask})</annotation><annotation encoding="application/x-llamapun" id="S2.E13.m1.3d">italic_G italic_L italic_U _ italic_N = italic_G italic_L italic_U ( italic_E start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT , over~ start_ARG italic_H end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_H start_POSTSUBSCRIPT italic_b italic_a italic_s italic_k end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p3.6">where <math alttext="L_{b}" class="ltx_Math" display="inline" id="S2.SS5.p3.5.m1.1"><semantics id="S2.SS5.p3.5.m1.1a"><msub id="S2.SS5.p3.5.m1.1.1" xref="S2.SS5.p3.5.m1.1.1.cmml"><mi id="S2.SS5.p3.5.m1.1.1.2" xref="S2.SS5.p3.5.m1.1.1.2.cmml">L</mi><mi id="S2.SS5.p3.5.m1.1.1.3" xref="S2.SS5.p3.5.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p3.5.m1.1b"><apply id="S2.SS5.p3.5.m1.1.1.cmml" xref="S2.SS5.p3.5.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.5.m1.1.1.1.cmml" xref="S2.SS5.p3.5.m1.1.1">subscript</csymbol><ci id="S2.SS5.p3.5.m1.1.1.2.cmml" xref="S2.SS5.p3.5.m1.1.1.2">𝐿</ci><ci id="S2.SS5.p3.5.m1.1.1.3.cmml" xref="S2.SS5.p3.5.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p3.5.m1.1c">L_{b}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p3.5.m1.1d">italic_L start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> is the length of the basket. User’s general interest embedding <math alttext="\varphi_{d}" class="ltx_Math" display="inline" id="S2.SS5.p3.6.m2.1"><semantics id="S2.SS5.p3.6.m2.1a"><msub id="S2.SS5.p3.6.m2.1.1" xref="S2.SS5.p3.6.m2.1.1.cmml"><mi id="S2.SS5.p3.6.m2.1.1.2" xref="S2.SS5.p3.6.m2.1.1.2.cmml">φ</mi><mi id="S2.SS5.p3.6.m2.1.1.3" xref="S2.SS5.p3.6.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p3.6.m2.1b"><apply id="S2.SS5.p3.6.m2.1.1.cmml" xref="S2.SS5.p3.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.6.m2.1.1.1.cmml" xref="S2.SS5.p3.6.m2.1.1">subscript</csymbol><ci id="S2.SS5.p3.6.m2.1.1.2.cmml" xref="S2.SS5.p3.6.m2.1.1.2">𝜑</ci><ci id="S2.SS5.p3.6.m2.1.1.3.cmml" xref="S2.SS5.p3.6.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p3.6.m2.1c">\varphi_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p3.6.m2.1d">italic_φ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\beta=W_{\beta}\cdot GLU\_N" class="ltx_Math" display="block" id="S2.E14.m1.1"><semantics id="S2.E14.m1.1a"><mrow id="S2.E14.m1.1.1" xref="S2.E14.m1.1.1.cmml"><mi id="S2.E14.m1.1.1.2" xref="S2.E14.m1.1.1.2.cmml">β</mi><mo id="S2.E14.m1.1.1.1" xref="S2.E14.m1.1.1.1.cmml">=</mo><mrow id="S2.E14.m1.1.1.3" xref="S2.E14.m1.1.1.3.cmml"><mrow id="S2.E14.m1.1.1.3.2" xref="S2.E14.m1.1.1.3.2.cmml"><msub id="S2.E14.m1.1.1.3.2.2" xref="S2.E14.m1.1.1.3.2.2.cmml"><mi id="S2.E14.m1.1.1.3.2.2.2" xref="S2.E14.m1.1.1.3.2.2.2.cmml">W</mi><mi id="S2.E14.m1.1.1.3.2.2.3" xref="S2.E14.m1.1.1.3.2.2.3.cmml">β</mi></msub><mo id="S2.E14.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E14.m1.1.1.3.2.1.cmml">⋅</mo><mi id="S2.E14.m1.1.1.3.2.3" xref="S2.E14.m1.1.1.3.2.3.cmml">G</mi></mrow><mo id="S2.E14.m1.1.1.3.1" xref="S2.E14.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E14.m1.1.1.3.3" xref="S2.E14.m1.1.1.3.3.cmml">L</mi><mo id="S2.E14.m1.1.1.3.1a" xref="S2.E14.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E14.m1.1.1.3.4" xref="S2.E14.m1.1.1.3.4.cmml">U</mi><mo id="S2.E14.m1.1.1.3.1b" xref="S2.E14.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E14.m1.1.1.3.5" mathvariant="normal" xref="S2.E14.m1.1.1.3.5.cmml">_</mi><mo id="S2.E14.m1.1.1.3.1c" xref="S2.E14.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.E14.m1.1.1.3.6" xref="S2.E14.m1.1.1.3.6.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E14.m1.1b"><apply id="S2.E14.m1.1.1.cmml" xref="S2.E14.m1.1.1"><eq id="S2.E14.m1.1.1.1.cmml" xref="S2.E14.m1.1.1.1"></eq><ci id="S2.E14.m1.1.1.2.cmml" xref="S2.E14.m1.1.1.2">𝛽</ci><apply id="S2.E14.m1.1.1.3.cmml" xref="S2.E14.m1.1.1.3"><times id="S2.E14.m1.1.1.3.1.cmml" xref="S2.E14.m1.1.1.3.1"></times><apply id="S2.E14.m1.1.1.3.2.cmml" xref="S2.E14.m1.1.1.3.2"><ci id="S2.E14.m1.1.1.3.2.1.cmml" xref="S2.E14.m1.1.1.3.2.1">⋅</ci><apply id="S2.E14.m1.1.1.3.2.2.cmml" xref="S2.E14.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E14.m1.1.1.3.2.2.1.cmml" xref="S2.E14.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E14.m1.1.1.3.2.2.2.cmml" xref="S2.E14.m1.1.1.3.2.2.2">𝑊</ci><ci id="S2.E14.m1.1.1.3.2.2.3.cmml" xref="S2.E14.m1.1.1.3.2.2.3">𝛽</ci></apply><ci id="S2.E14.m1.1.1.3.2.3.cmml" xref="S2.E14.m1.1.1.3.2.3">𝐺</ci></apply><ci id="S2.E14.m1.1.1.3.3.cmml" xref="S2.E14.m1.1.1.3.3">𝐿</ci><ci id="S2.E14.m1.1.1.3.4.cmml" xref="S2.E14.m1.1.1.3.4">𝑈</ci><ci id="S2.E14.m1.1.1.3.5.cmml" xref="S2.E14.m1.1.1.3.5">_</ci><ci id="S2.E14.m1.1.1.3.6.cmml" xref="S2.E14.m1.1.1.3.6">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E14.m1.1c">\beta=W_{\beta}\cdot GLU\_N</annotation><annotation encoding="application/x-llamapun" id="S2.E14.m1.1d">italic_β = italic_W start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT ⋅ italic_G italic_L italic_U _ italic_N</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\varphi_{d}=\sum_{i=1}^{L_{b}}\beta^{(i)}\cdot\widetilde{H}^{\prime}_{d}" class="ltx_Math" display="block" id="S2.E15.m1.1"><semantics id="S2.E15.m1.1a"><mrow id="S2.E15.m1.1.2" xref="S2.E15.m1.1.2.cmml"><msub id="S2.E15.m1.1.2.2" xref="S2.E15.m1.1.2.2.cmml"><mi id="S2.E15.m1.1.2.2.2" xref="S2.E15.m1.1.2.2.2.cmml">φ</mi><mi id="S2.E15.m1.1.2.2.3" xref="S2.E15.m1.1.2.2.3.cmml">d</mi></msub><mo id="S2.E15.m1.1.2.1" rspace="0.111em" xref="S2.E15.m1.1.2.1.cmml">=</mo><mrow id="S2.E15.m1.1.2.3" xref="S2.E15.m1.1.2.3.cmml"><munderover id="S2.E15.m1.1.2.3.1" xref="S2.E15.m1.1.2.3.1.cmml"><mo id="S2.E15.m1.1.2.3.1.2.2" movablelimits="false" xref="S2.E15.m1.1.2.3.1.2.2.cmml">∑</mo><mrow id="S2.E15.m1.1.2.3.1.2.3" xref="S2.E15.m1.1.2.3.1.2.3.cmml"><mi id="S2.E15.m1.1.2.3.1.2.3.2" xref="S2.E15.m1.1.2.3.1.2.3.2.cmml">i</mi><mo id="S2.E15.m1.1.2.3.1.2.3.1" xref="S2.E15.m1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S2.E15.m1.1.2.3.1.2.3.3" xref="S2.E15.m1.1.2.3.1.2.3.3.cmml">1</mn></mrow><msub id="S2.E15.m1.1.2.3.1.3" xref="S2.E15.m1.1.2.3.1.3.cmml"><mi id="S2.E15.m1.1.2.3.1.3.2" xref="S2.E15.m1.1.2.3.1.3.2.cmml">L</mi><mi id="S2.E15.m1.1.2.3.1.3.3" xref="S2.E15.m1.1.2.3.1.3.3.cmml">b</mi></msub></munderover><mrow id="S2.E15.m1.1.2.3.2" xref="S2.E15.m1.1.2.3.2.cmml"><msup id="S2.E15.m1.1.2.3.2.2" xref="S2.E15.m1.1.2.3.2.2.cmml"><mi id="S2.E15.m1.1.2.3.2.2.2" xref="S2.E15.m1.1.2.3.2.2.2.cmml">β</mi><mrow id="S2.E15.m1.1.1.1.3" xref="S2.E15.m1.1.2.3.2.2.cmml"><mo id="S2.E15.m1.1.1.1.3.1" stretchy="false" xref="S2.E15.m1.1.2.3.2.2.cmml">(</mo><mi id="S2.E15.m1.1.1.1.1" xref="S2.E15.m1.1.1.1.1.cmml">i</mi><mo id="S2.E15.m1.1.1.1.3.2" stretchy="false" xref="S2.E15.m1.1.2.3.2.2.cmml">)</mo></mrow></msup><mo id="S2.E15.m1.1.2.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.E15.m1.1.2.3.2.1.cmml">⋅</mo><msubsup id="S2.E15.m1.1.2.3.2.3" xref="S2.E15.m1.1.2.3.2.3.cmml"><mover accent="true" id="S2.E15.m1.1.2.3.2.3.2.2" xref="S2.E15.m1.1.2.3.2.3.2.2.cmml"><mi id="S2.E15.m1.1.2.3.2.3.2.2.2" xref="S2.E15.m1.1.2.3.2.3.2.2.2.cmml">H</mi><mo id="S2.E15.m1.1.2.3.2.3.2.2.1" xref="S2.E15.m1.1.2.3.2.3.2.2.1.cmml">~</mo></mover><mi id="S2.E15.m1.1.2.3.2.3.3" xref="S2.E15.m1.1.2.3.2.3.3.cmml">d</mi><mo id="S2.E15.m1.1.2.3.2.3.2.3" xref="S2.E15.m1.1.2.3.2.3.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E15.m1.1b"><apply id="S2.E15.m1.1.2.cmml" xref="S2.E15.m1.1.2"><eq id="S2.E15.m1.1.2.1.cmml" xref="S2.E15.m1.1.2.1"></eq><apply id="S2.E15.m1.1.2.2.cmml" xref="S2.E15.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E15.m1.1.2.2.1.cmml" xref="S2.E15.m1.1.2.2">subscript</csymbol><ci id="S2.E15.m1.1.2.2.2.cmml" xref="S2.E15.m1.1.2.2.2">𝜑</ci><ci id="S2.E15.m1.1.2.2.3.cmml" xref="S2.E15.m1.1.2.2.3">𝑑</ci></apply><apply id="S2.E15.m1.1.2.3.cmml" xref="S2.E15.m1.1.2.3"><apply id="S2.E15.m1.1.2.3.1.cmml" xref="S2.E15.m1.1.2.3.1"><csymbol cd="ambiguous" id="S2.E15.m1.1.2.3.1.1.cmml" xref="S2.E15.m1.1.2.3.1">superscript</csymbol><apply id="S2.E15.m1.1.2.3.1.2.cmml" xref="S2.E15.m1.1.2.3.1"><csymbol cd="ambiguous" id="S2.E15.m1.1.2.3.1.2.1.cmml" xref="S2.E15.m1.1.2.3.1">subscript</csymbol><sum id="S2.E15.m1.1.2.3.1.2.2.cmml" xref="S2.E15.m1.1.2.3.1.2.2"></sum><apply id="S2.E15.m1.1.2.3.1.2.3.cmml" xref="S2.E15.m1.1.2.3.1.2.3"><eq id="S2.E15.m1.1.2.3.1.2.3.1.cmml" xref="S2.E15.m1.1.2.3.1.2.3.1"></eq><ci id="S2.E15.m1.1.2.3.1.2.3.2.cmml" xref="S2.E15.m1.1.2.3.1.2.3.2">𝑖</ci><cn id="S2.E15.m1.1.2.3.1.2.3.3.cmml" type="integer" xref="S2.E15.m1.1.2.3.1.2.3.3">1</cn></apply></apply><apply id="S2.E15.m1.1.2.3.1.3.cmml" xref="S2.E15.m1.1.2.3.1.3"><csymbol cd="ambiguous" id="S2.E15.m1.1.2.3.1.3.1.cmml" xref="S2.E15.m1.1.2.3.1.3">subscript</csymbol><ci id="S2.E15.m1.1.2.3.1.3.2.cmml" xref="S2.E15.m1.1.2.3.1.3.2">𝐿</ci><ci id="S2.E15.m1.1.2.3.1.3.3.cmml" xref="S2.E15.m1.1.2.3.1.3.3">𝑏</ci></apply></apply><apply id="S2.E15.m1.1.2.3.2.cmml" xref="S2.E15.m1.1.2.3.2"><ci id="S2.E15.m1.1.2.3.2.1.cmml" xref="S2.E15.m1.1.2.3.2.1">⋅</ci><apply id="S2.E15.m1.1.2.3.2.2.cmml" xref="S2.E15.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S2.E15.m1.1.2.3.2.2.1.cmml" xref="S2.E15.m1.1.2.3.2.2">superscript</csymbol><ci id="S2.E15.m1.1.2.3.2.2.2.cmml" xref="S2.E15.m1.1.2.3.2.2.2">𝛽</ci><ci id="S2.E15.m1.1.1.1.1.cmml" xref="S2.E15.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.E15.m1.1.2.3.2.3.cmml" xref="S2.E15.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S2.E15.m1.1.2.3.2.3.1.cmml" xref="S2.E15.m1.1.2.3.2.3">subscript</csymbol><apply id="S2.E15.m1.1.2.3.2.3.2.cmml" xref="S2.E15.m1.1.2.3.2.3"><csymbol cd="ambiguous" id="S2.E15.m1.1.2.3.2.3.2.1.cmml" xref="S2.E15.m1.1.2.3.2.3">superscript</csymbol><apply id="S2.E15.m1.1.2.3.2.3.2.2.cmml" xref="S2.E15.m1.1.2.3.2.3.2.2"><ci id="S2.E15.m1.1.2.3.2.3.2.2.1.cmml" xref="S2.E15.m1.1.2.3.2.3.2.2.1">~</ci><ci id="S2.E15.m1.1.2.3.2.3.2.2.2.cmml" xref="S2.E15.m1.1.2.3.2.3.2.2.2">𝐻</ci></apply><ci id="S2.E15.m1.1.2.3.2.3.2.3.cmml" xref="S2.E15.m1.1.2.3.2.3.2.3">′</ci></apply><ci id="S2.E15.m1.1.2.3.2.3.3.cmml" xref="S2.E15.m1.1.2.3.2.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E15.m1.1c">\varphi_{d}=\sum_{i=1}^{L_{b}}\beta^{(i)}\cdot\widetilde{H}^{\prime}_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.E15.m1.1d">italic_φ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_β start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ⋅ over~ start_ARG italic_H end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS5.p3.7">where <math alttext="W_{\beta}" class="ltx_Math" display="inline" id="S2.SS5.p3.7.m1.1"><semantics id="S2.SS5.p3.7.m1.1a"><msub id="S2.SS5.p3.7.m1.1.1" xref="S2.SS5.p3.7.m1.1.1.cmml"><mi id="S2.SS5.p3.7.m1.1.1.2" xref="S2.SS5.p3.7.m1.1.1.2.cmml">W</mi><mi id="S2.SS5.p3.7.m1.1.1.3" xref="S2.SS5.p3.7.m1.1.1.3.cmml">β</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p3.7.m1.1b"><apply id="S2.SS5.p3.7.m1.1.1.cmml" xref="S2.SS5.p3.7.m1.1.1"><csymbol cd="ambiguous" id="S2.SS5.p3.7.m1.1.1.1.cmml" xref="S2.SS5.p3.7.m1.1.1">subscript</csymbol><ci id="S2.SS5.p3.7.m1.1.1.2.cmml" xref="S2.SS5.p3.7.m1.1.1.2">𝑊</ci><ci id="S2.SS5.p3.7.m1.1.1.3.cmml" xref="S2.SS5.p3.7.m1.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p3.7.m1.1c">W_{\beta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS5.p3.7.m1.1d">italic_W start_POSTSUBSCRIPT italic_β end_POSTSUBSCRIPT</annotation></semantics></math> is learnable parameter.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS6.4.1.1">II-F</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS6.5.2">Training Setup</span>
</h3>
<div class="ltx_para" id="S2.SS6.p1">
<p class="ltx_p" id="S2.SS6.p1.2">To compute the scores <math alttext="y_{i}" class="ltx_Math" display="inline" id="S2.SS6.p1.1.m1.1"><semantics id="S2.SS6.p1.1.m1.1a"><msub id="S2.SS6.p1.1.m1.1.1" xref="S2.SS6.p1.1.m1.1.1.cmml"><mi id="S2.SS6.p1.1.m1.1.1.2" xref="S2.SS6.p1.1.m1.1.1.2.cmml">y</mi><mi id="S2.SS6.p1.1.m1.1.1.3" xref="S2.SS6.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.1.m1.1b"><apply id="S2.SS6.p1.1.m1.1.1.cmml" xref="S2.SS6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS6.p1.1.m1.1.1.1.cmml" xref="S2.SS6.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS6.p1.1.m1.1.1.2.cmml" xref="S2.SS6.p1.1.m1.1.1.2">𝑦</ci><ci id="S2.SS6.p1.1.m1.1.1.3.cmml" xref="S2.SS6.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.1.m1.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> for all items <math alttext="x_{i}\in I" class="ltx_Math" display="inline" id="S2.SS6.p1.2.m2.1"><semantics id="S2.SS6.p1.2.m2.1a"><mrow id="S2.SS6.p1.2.m2.1.1" xref="S2.SS6.p1.2.m2.1.1.cmml"><msub id="S2.SS6.p1.2.m2.1.1.2" xref="S2.SS6.p1.2.m2.1.1.2.cmml"><mi id="S2.SS6.p1.2.m2.1.1.2.2" xref="S2.SS6.p1.2.m2.1.1.2.2.cmml">x</mi><mi id="S2.SS6.p1.2.m2.1.1.2.3" xref="S2.SS6.p1.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S2.SS6.p1.2.m2.1.1.1" xref="S2.SS6.p1.2.m2.1.1.1.cmml">∈</mo><mi id="S2.SS6.p1.2.m2.1.1.3" xref="S2.SS6.p1.2.m2.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS6.p1.2.m2.1b"><apply id="S2.SS6.p1.2.m2.1.1.cmml" xref="S2.SS6.p1.2.m2.1.1"><in id="S2.SS6.p1.2.m2.1.1.1.cmml" xref="S2.SS6.p1.2.m2.1.1.1"></in><apply id="S2.SS6.p1.2.m2.1.1.2.cmml" xref="S2.SS6.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS6.p1.2.m2.1.1.2.1.cmml" xref="S2.SS6.p1.2.m2.1.1.2">subscript</csymbol><ci id="S2.SS6.p1.2.m2.1.1.2.2.cmml" xref="S2.SS6.p1.2.m2.1.1.2.2">𝑥</ci><ci id="S2.SS6.p1.2.m2.1.1.2.3.cmml" xref="S2.SS6.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S2.SS6.p1.2.m2.1.1.3.cmml" xref="S2.SS6.p1.2.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p1.2.m2.1c">x_{i}\in I</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_I</annotation></semantics></math>, we perform an inner product between the user preference, learned from heterogeneous hypergraph and item features. We then apply a softmax function to derive the probabilities of each item being selected for the next basket:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y_{i}=\varphi_{p}^{\top}z_{i}^{p}+\varphi_{d}^{\top}z_{i}^{d}" class="ltx_Math" display="block" id="S2.E16.m1.1"><semantics id="S2.E16.m1.1a"><mrow id="S2.E16.m1.1.1" xref="S2.E16.m1.1.1.cmml"><msub id="S2.E16.m1.1.1.2" xref="S2.E16.m1.1.1.2.cmml"><mi id="S2.E16.m1.1.1.2.2" xref="S2.E16.m1.1.1.2.2.cmml">y</mi><mi id="S2.E16.m1.1.1.2.3" xref="S2.E16.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.E16.m1.1.1.1" xref="S2.E16.m1.1.1.1.cmml">=</mo><mrow id="S2.E16.m1.1.1.3" xref="S2.E16.m1.1.1.3.cmml"><mrow id="S2.E16.m1.1.1.3.2" xref="S2.E16.m1.1.1.3.2.cmml"><msubsup id="S2.E16.m1.1.1.3.2.2" xref="S2.E16.m1.1.1.3.2.2.cmml"><mi id="S2.E16.m1.1.1.3.2.2.2.2" xref="S2.E16.m1.1.1.3.2.2.2.2.cmml">φ</mi><mi id="S2.E16.m1.1.1.3.2.2.2.3" xref="S2.E16.m1.1.1.3.2.2.2.3.cmml">p</mi><mo id="S2.E16.m1.1.1.3.2.2.3" xref="S2.E16.m1.1.1.3.2.2.3.cmml">⊤</mo></msubsup><mo id="S2.E16.m1.1.1.3.2.1" xref="S2.E16.m1.1.1.3.2.1.cmml">⁢</mo><msubsup id="S2.E16.m1.1.1.3.2.3" xref="S2.E16.m1.1.1.3.2.3.cmml"><mi id="S2.E16.m1.1.1.3.2.3.2.2" xref="S2.E16.m1.1.1.3.2.3.2.2.cmml">z</mi><mi id="S2.E16.m1.1.1.3.2.3.2.3" xref="S2.E16.m1.1.1.3.2.3.2.3.cmml">i</mi><mi id="S2.E16.m1.1.1.3.2.3.3" xref="S2.E16.m1.1.1.3.2.3.3.cmml">p</mi></msubsup></mrow><mo id="S2.E16.m1.1.1.3.1" xref="S2.E16.m1.1.1.3.1.cmml">+</mo><mrow id="S2.E16.m1.1.1.3.3" xref="S2.E16.m1.1.1.3.3.cmml"><msubsup id="S2.E16.m1.1.1.3.3.2" xref="S2.E16.m1.1.1.3.3.2.cmml"><mi id="S2.E16.m1.1.1.3.3.2.2.2" xref="S2.E16.m1.1.1.3.3.2.2.2.cmml">φ</mi><mi id="S2.E16.m1.1.1.3.3.2.2.3" xref="S2.E16.m1.1.1.3.3.2.2.3.cmml">d</mi><mo id="S2.E16.m1.1.1.3.3.2.3" xref="S2.E16.m1.1.1.3.3.2.3.cmml">⊤</mo></msubsup><mo id="S2.E16.m1.1.1.3.3.1" xref="S2.E16.m1.1.1.3.3.1.cmml">⁢</mo><msubsup id="S2.E16.m1.1.1.3.3.3" xref="S2.E16.m1.1.1.3.3.3.cmml"><mi id="S2.E16.m1.1.1.3.3.3.2.2" xref="S2.E16.m1.1.1.3.3.3.2.2.cmml">z</mi><mi id="S2.E16.m1.1.1.3.3.3.2.3" xref="S2.E16.m1.1.1.3.3.3.2.3.cmml">i</mi><mi id="S2.E16.m1.1.1.3.3.3.3" xref="S2.E16.m1.1.1.3.3.3.3.cmml">d</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E16.m1.1b"><apply id="S2.E16.m1.1.1.cmml" xref="S2.E16.m1.1.1"><eq id="S2.E16.m1.1.1.1.cmml" xref="S2.E16.m1.1.1.1"></eq><apply id="S2.E16.m1.1.1.2.cmml" xref="S2.E16.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.2.1.cmml" xref="S2.E16.m1.1.1.2">subscript</csymbol><ci id="S2.E16.m1.1.1.2.2.cmml" xref="S2.E16.m1.1.1.2.2">𝑦</ci><ci id="S2.E16.m1.1.1.2.3.cmml" xref="S2.E16.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.E16.m1.1.1.3.cmml" xref="S2.E16.m1.1.1.3"><plus id="S2.E16.m1.1.1.3.1.cmml" xref="S2.E16.m1.1.1.3.1"></plus><apply id="S2.E16.m1.1.1.3.2.cmml" xref="S2.E16.m1.1.1.3.2"><times id="S2.E16.m1.1.1.3.2.1.cmml" xref="S2.E16.m1.1.1.3.2.1"></times><apply id="S2.E16.m1.1.1.3.2.2.cmml" xref="S2.E16.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.3.2.2.1.cmml" xref="S2.E16.m1.1.1.3.2.2">superscript</csymbol><apply id="S2.E16.m1.1.1.3.2.2.2.cmml" xref="S2.E16.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.3.2.2.2.1.cmml" xref="S2.E16.m1.1.1.3.2.2">subscript</csymbol><ci id="S2.E16.m1.1.1.3.2.2.2.2.cmml" xref="S2.E16.m1.1.1.3.2.2.2.2">𝜑</ci><ci id="S2.E16.m1.1.1.3.2.2.2.3.cmml" xref="S2.E16.m1.1.1.3.2.2.2.3">𝑝</ci></apply><csymbol cd="latexml" id="S2.E16.m1.1.1.3.2.2.3.cmml" xref="S2.E16.m1.1.1.3.2.2.3">top</csymbol></apply><apply id="S2.E16.m1.1.1.3.2.3.cmml" xref="S2.E16.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.3.2.3.1.cmml" xref="S2.E16.m1.1.1.3.2.3">superscript</csymbol><apply id="S2.E16.m1.1.1.3.2.3.2.cmml" xref="S2.E16.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.3.2.3.2.1.cmml" xref="S2.E16.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.E16.m1.1.1.3.2.3.2.2.cmml" xref="S2.E16.m1.1.1.3.2.3.2.2">𝑧</ci><ci id="S2.E16.m1.1.1.3.2.3.2.3.cmml" xref="S2.E16.m1.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="S2.E16.m1.1.1.3.2.3.3.cmml" xref="S2.E16.m1.1.1.3.2.3.3">𝑝</ci></apply></apply><apply id="S2.E16.m1.1.1.3.3.cmml" xref="S2.E16.m1.1.1.3.3"><times id="S2.E16.m1.1.1.3.3.1.cmml" xref="S2.E16.m1.1.1.3.3.1"></times><apply id="S2.E16.m1.1.1.3.3.2.cmml" xref="S2.E16.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.3.3.2.1.cmml" xref="S2.E16.m1.1.1.3.3.2">superscript</csymbol><apply id="S2.E16.m1.1.1.3.3.2.2.cmml" xref="S2.E16.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.3.3.2.2.1.cmml" xref="S2.E16.m1.1.1.3.3.2">subscript</csymbol><ci id="S2.E16.m1.1.1.3.3.2.2.2.cmml" xref="S2.E16.m1.1.1.3.3.2.2.2">𝜑</ci><ci id="S2.E16.m1.1.1.3.3.2.2.3.cmml" xref="S2.E16.m1.1.1.3.3.2.2.3">𝑑</ci></apply><csymbol cd="latexml" id="S2.E16.m1.1.1.3.3.2.3.cmml" xref="S2.E16.m1.1.1.3.3.2.3">top</csymbol></apply><apply id="S2.E16.m1.1.1.3.3.3.cmml" xref="S2.E16.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.3.3.3.1.cmml" xref="S2.E16.m1.1.1.3.3.3">superscript</csymbol><apply id="S2.E16.m1.1.1.3.3.3.2.cmml" xref="S2.E16.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E16.m1.1.1.3.3.3.2.1.cmml" xref="S2.E16.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.E16.m1.1.1.3.3.3.2.2.cmml" xref="S2.E16.m1.1.1.3.3.3.2.2">𝑧</ci><ci id="S2.E16.m1.1.1.3.3.3.2.3.cmml" xref="S2.E16.m1.1.1.3.3.3.2.3">𝑖</ci></apply><ci id="S2.E16.m1.1.1.3.3.3.3.cmml" xref="S2.E16.m1.1.1.3.3.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E16.m1.1c">y_{i}=\varphi_{p}^{\top}z_{i}^{p}+\varphi_{d}^{\top}z_{i}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.E16.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_φ start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT + italic_φ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S2.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}=softmax(y_{i})" class="ltx_Math" display="block" id="S2.E17.m1.1"><semantics id="S2.E17.m1.1a"><mrow id="S2.E17.m1.1.1" xref="S2.E17.m1.1.1.cmml"><mover accent="true" id="S2.E17.m1.1.1.3" xref="S2.E17.m1.1.1.3.cmml"><mi id="S2.E17.m1.1.1.3.2" xref="S2.E17.m1.1.1.3.2.cmml">y</mi><mo id="S2.E17.m1.1.1.3.1" xref="S2.E17.m1.1.1.3.1.cmml">^</mo></mover><mo id="S2.E17.m1.1.1.2" xref="S2.E17.m1.1.1.2.cmml">=</mo><mrow id="S2.E17.m1.1.1.1" xref="S2.E17.m1.1.1.1.cmml"><mi id="S2.E17.m1.1.1.1.3" xref="S2.E17.m1.1.1.1.3.cmml">s</mi><mo id="S2.E17.m1.1.1.1.2" xref="S2.E17.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E17.m1.1.1.1.4" xref="S2.E17.m1.1.1.1.4.cmml">o</mi><mo id="S2.E17.m1.1.1.1.2a" xref="S2.E17.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E17.m1.1.1.1.5" xref="S2.E17.m1.1.1.1.5.cmml">f</mi><mo id="S2.E17.m1.1.1.1.2b" xref="S2.E17.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E17.m1.1.1.1.6" xref="S2.E17.m1.1.1.1.6.cmml">t</mi><mo id="S2.E17.m1.1.1.1.2c" xref="S2.E17.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E17.m1.1.1.1.7" xref="S2.E17.m1.1.1.1.7.cmml">m</mi><mo id="S2.E17.m1.1.1.1.2d" xref="S2.E17.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E17.m1.1.1.1.8" xref="S2.E17.m1.1.1.1.8.cmml">a</mi><mo id="S2.E17.m1.1.1.1.2e" xref="S2.E17.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E17.m1.1.1.1.9" xref="S2.E17.m1.1.1.1.9.cmml">x</mi><mo id="S2.E17.m1.1.1.1.2f" xref="S2.E17.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E17.m1.1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.1.1.cmml"><mo id="S2.E17.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E17.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E17.m1.1.1.1.1.1.1" xref="S2.E17.m1.1.1.1.1.1.1.cmml"><mi id="S2.E17.m1.1.1.1.1.1.1.2" xref="S2.E17.m1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.E17.m1.1.1.1.1.1.1.3" xref="S2.E17.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E17.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E17.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E17.m1.1b"><apply id="S2.E17.m1.1.1.cmml" xref="S2.E17.m1.1.1"><eq id="S2.E17.m1.1.1.2.cmml" xref="S2.E17.m1.1.1.2"></eq><apply id="S2.E17.m1.1.1.3.cmml" xref="S2.E17.m1.1.1.3"><ci id="S2.E17.m1.1.1.3.1.cmml" xref="S2.E17.m1.1.1.3.1">^</ci><ci id="S2.E17.m1.1.1.3.2.cmml" xref="S2.E17.m1.1.1.3.2">𝑦</ci></apply><apply id="S2.E17.m1.1.1.1.cmml" xref="S2.E17.m1.1.1.1"><times id="S2.E17.m1.1.1.1.2.cmml" xref="S2.E17.m1.1.1.1.2"></times><ci id="S2.E17.m1.1.1.1.3.cmml" xref="S2.E17.m1.1.1.1.3">𝑠</ci><ci id="S2.E17.m1.1.1.1.4.cmml" xref="S2.E17.m1.1.1.1.4">𝑜</ci><ci id="S2.E17.m1.1.1.1.5.cmml" xref="S2.E17.m1.1.1.1.5">𝑓</ci><ci id="S2.E17.m1.1.1.1.6.cmml" xref="S2.E17.m1.1.1.1.6">𝑡</ci><ci id="S2.E17.m1.1.1.1.7.cmml" xref="S2.E17.m1.1.1.1.7">𝑚</ci><ci id="S2.E17.m1.1.1.1.8.cmml" xref="S2.E17.m1.1.1.1.8">𝑎</ci><ci id="S2.E17.m1.1.1.1.9.cmml" xref="S2.E17.m1.1.1.1.9">𝑥</ci><apply id="S2.E17.m1.1.1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E17.m1.1.1.1.1.1.1.1.cmml" xref="S2.E17.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E17.m1.1.1.1.1.1.1.2.cmml" xref="S2.E17.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E17.m1.1.1.1.1.1.1.3.cmml" xref="S2.E17.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E17.m1.1c">\hat{y}=softmax(y_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.E17.m1.1d">over^ start_ARG italic_y end_ARG = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS6.p2">
<p class="ltx_p" id="S2.SS6.p2.2">The model is trained using a cross-entropy loss function, commonly employed in recommendation systems:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{r}=-\sum_{i=1}^{n}\alpha_{i}log(\hat{y}_{i})+(1-\alpha_{i})log(1-%
\hat{y}_{i})" class="ltx_Math" display="block" id="S2.E18.m1.3"><semantics id="S2.E18.m1.3a"><mrow id="S2.E18.m1.3.3" xref="S2.E18.m1.3.3.cmml"><msub id="S2.E18.m1.3.3.5" xref="S2.E18.m1.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E18.m1.3.3.5.2" xref="S2.E18.m1.3.3.5.2.cmml">ℒ</mi><mi id="S2.E18.m1.3.3.5.3" xref="S2.E18.m1.3.3.5.3.cmml">r</mi></msub><mo id="S2.E18.m1.3.3.4" xref="S2.E18.m1.3.3.4.cmml">=</mo><mrow id="S2.E18.m1.3.3.3" xref="S2.E18.m1.3.3.3.cmml"><mrow id="S2.E18.m1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.cmml"><mo id="S2.E18.m1.1.1.1.1a" xref="S2.E18.m1.1.1.1.1.cmml">−</mo><mrow id="S2.E18.m1.1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.1.cmml"><munderover id="S2.E18.m1.1.1.1.1.1.2" xref="S2.E18.m1.1.1.1.1.1.2.cmml"><mo id="S2.E18.m1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E18.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E18.m1.1.1.1.1.1.2.2.3" xref="S2.E18.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E18.m1.1.1.1.1.1.2.2.3.2" xref="S2.E18.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E18.m1.1.1.1.1.1.2.2.3.1" xref="S2.E18.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E18.m1.1.1.1.1.1.2.2.3.3" xref="S2.E18.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E18.m1.1.1.1.1.1.2.3" xref="S2.E18.m1.1.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S2.E18.m1.1.1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.1.1.cmml"><msub id="S2.E18.m1.1.1.1.1.1.1.3" xref="S2.E18.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E18.m1.1.1.1.1.1.1.3.2" xref="S2.E18.m1.1.1.1.1.1.1.3.2.cmml">α</mi><mi id="S2.E18.m1.1.1.1.1.1.1.3.3" xref="S2.E18.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.E18.m1.1.1.1.1.1.1.2" xref="S2.E18.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E18.m1.1.1.1.1.1.1.4" xref="S2.E18.m1.1.1.1.1.1.1.4.cmml">l</mi><mo id="S2.E18.m1.1.1.1.1.1.1.2a" xref="S2.E18.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E18.m1.1.1.1.1.1.1.5" xref="S2.E18.m1.1.1.1.1.1.1.5.cmml">o</mi><mo id="S2.E18.m1.1.1.1.1.1.1.2b" xref="S2.E18.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E18.m1.1.1.1.1.1.1.6" xref="S2.E18.m1.1.1.1.1.1.1.6.cmml">g</mi><mo id="S2.E18.m1.1.1.1.1.1.1.2c" xref="S2.E18.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E18.m1.1.1.1.1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E18.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E18.m1.1.1.1.1.1.1.1.1.1" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E18.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E18.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E18.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E18.m1.3.3.3.4" xref="S2.E18.m1.3.3.3.4.cmml">+</mo><mrow id="S2.E18.m1.3.3.3.3" xref="S2.E18.m1.3.3.3.3.cmml"><mrow id="S2.E18.m1.2.2.2.2.1.1" xref="S2.E18.m1.2.2.2.2.1.1.1.cmml"><mo id="S2.E18.m1.2.2.2.2.1.1.2" stretchy="false" xref="S2.E18.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E18.m1.2.2.2.2.1.1.1" xref="S2.E18.m1.2.2.2.2.1.1.1.cmml"><mn id="S2.E18.m1.2.2.2.2.1.1.1.2" xref="S2.E18.m1.2.2.2.2.1.1.1.2.cmml">1</mn><mo id="S2.E18.m1.2.2.2.2.1.1.1.1" xref="S2.E18.m1.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="S2.E18.m1.2.2.2.2.1.1.1.3" xref="S2.E18.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E18.m1.2.2.2.2.1.1.1.3.2" xref="S2.E18.m1.2.2.2.2.1.1.1.3.2.cmml">α</mi><mi id="S2.E18.m1.2.2.2.2.1.1.1.3.3" xref="S2.E18.m1.2.2.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.E18.m1.2.2.2.2.1.1.3" stretchy="false" xref="S2.E18.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S2.E18.m1.3.3.3.3.3" xref="S2.E18.m1.3.3.3.3.3.cmml">⁢</mo><mi id="S2.E18.m1.3.3.3.3.4" xref="S2.E18.m1.3.3.3.3.4.cmml">l</mi><mo id="S2.E18.m1.3.3.3.3.3a" xref="S2.E18.m1.3.3.3.3.3.cmml">⁢</mo><mi id="S2.E18.m1.3.3.3.3.5" xref="S2.E18.m1.3.3.3.3.5.cmml">o</mi><mo id="S2.E18.m1.3.3.3.3.3b" xref="S2.E18.m1.3.3.3.3.3.cmml">⁢</mo><mi id="S2.E18.m1.3.3.3.3.6" xref="S2.E18.m1.3.3.3.3.6.cmml">g</mi><mo id="S2.E18.m1.3.3.3.3.3c" xref="S2.E18.m1.3.3.3.3.3.cmml">⁢</mo><mrow id="S2.E18.m1.3.3.3.3.2.1" xref="S2.E18.m1.3.3.3.3.2.1.1.cmml"><mo id="S2.E18.m1.3.3.3.3.2.1.2" stretchy="false" xref="S2.E18.m1.3.3.3.3.2.1.1.cmml">(</mo><mrow id="S2.E18.m1.3.3.3.3.2.1.1" xref="S2.E18.m1.3.3.3.3.2.1.1.cmml"><mn id="S2.E18.m1.3.3.3.3.2.1.1.2" xref="S2.E18.m1.3.3.3.3.2.1.1.2.cmml">1</mn><mo id="S2.E18.m1.3.3.3.3.2.1.1.1" xref="S2.E18.m1.3.3.3.3.2.1.1.1.cmml">−</mo><msub id="S2.E18.m1.3.3.3.3.2.1.1.3" xref="S2.E18.m1.3.3.3.3.2.1.1.3.cmml"><mover accent="true" id="S2.E18.m1.3.3.3.3.2.1.1.3.2" xref="S2.E18.m1.3.3.3.3.2.1.1.3.2.cmml"><mi id="S2.E18.m1.3.3.3.3.2.1.1.3.2.2" xref="S2.E18.m1.3.3.3.3.2.1.1.3.2.2.cmml">y</mi><mo id="S2.E18.m1.3.3.3.3.2.1.1.3.2.1" xref="S2.E18.m1.3.3.3.3.2.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E18.m1.3.3.3.3.2.1.1.3.3" xref="S2.E18.m1.3.3.3.3.2.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.E18.m1.3.3.3.3.2.1.3" stretchy="false" xref="S2.E18.m1.3.3.3.3.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E18.m1.3b"><apply id="S2.E18.m1.3.3.cmml" xref="S2.E18.m1.3.3"><eq id="S2.E18.m1.3.3.4.cmml" xref="S2.E18.m1.3.3.4"></eq><apply id="S2.E18.m1.3.3.5.cmml" xref="S2.E18.m1.3.3.5"><csymbol cd="ambiguous" id="S2.E18.m1.3.3.5.1.cmml" xref="S2.E18.m1.3.3.5">subscript</csymbol><ci id="S2.E18.m1.3.3.5.2.cmml" xref="S2.E18.m1.3.3.5.2">ℒ</ci><ci id="S2.E18.m1.3.3.5.3.cmml" xref="S2.E18.m1.3.3.5.3">𝑟</ci></apply><apply id="S2.E18.m1.3.3.3.cmml" xref="S2.E18.m1.3.3.3"><plus id="S2.E18.m1.3.3.3.4.cmml" xref="S2.E18.m1.3.3.3.4"></plus><apply id="S2.E18.m1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1"><minus id="S2.E18.m1.1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.1"></minus><apply id="S2.E18.m1.1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1.1"><apply id="S2.E18.m1.1.1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.1.2.1.cmml" xref="S2.E18.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E18.m1.1.1.1.1.1.2.2.cmml" xref="S2.E18.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.1.2.2.1.cmml" xref="S2.E18.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E18.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.E18.m1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E18.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.E18.m1.1.1.1.1.1.2.2.3"><eq id="S2.E18.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E18.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E18.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E18.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.E18.m1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E18.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E18.m1.1.1.1.1.1.2.3.cmml" xref="S2.E18.m1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S2.E18.m1.1.1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1.1.1"><times id="S2.E18.m1.1.1.1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.1.1.1.2"></times><apply id="S2.E18.m1.1.1.1.1.1.1.3.cmml" xref="S2.E18.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E18.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E18.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E18.m1.1.1.1.1.1.1.3.2">𝛼</ci><ci id="S2.E18.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E18.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply><ci id="S2.E18.m1.1.1.1.1.1.1.4.cmml" xref="S2.E18.m1.1.1.1.1.1.1.4">𝑙</ci><ci id="S2.E18.m1.1.1.1.1.1.1.5.cmml" xref="S2.E18.m1.1.1.1.1.1.1.5">𝑜</ci><ci id="S2.E18.m1.1.1.1.1.1.1.6.cmml" xref="S2.E18.m1.1.1.1.1.1.1.6">𝑔</ci><apply id="S2.E18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E18.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.2"><ci id="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S2.E18.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E18.m1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S2.E18.m1.3.3.3.3.cmml" xref="S2.E18.m1.3.3.3.3"><times id="S2.E18.m1.3.3.3.3.3.cmml" xref="S2.E18.m1.3.3.3.3.3"></times><apply id="S2.E18.m1.2.2.2.2.1.1.1.cmml" xref="S2.E18.m1.2.2.2.2.1.1"><minus id="S2.E18.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E18.m1.2.2.2.2.1.1.1.1"></minus><cn id="S2.E18.m1.2.2.2.2.1.1.1.2.cmml" type="integer" xref="S2.E18.m1.2.2.2.2.1.1.1.2">1</cn><apply id="S2.E18.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E18.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E18.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E18.m1.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E18.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E18.m1.2.2.2.2.1.1.1.3.2">𝛼</ci><ci id="S2.E18.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E18.m1.2.2.2.2.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S2.E18.m1.3.3.3.3.4.cmml" xref="S2.E18.m1.3.3.3.3.4">𝑙</ci><ci id="S2.E18.m1.3.3.3.3.5.cmml" xref="S2.E18.m1.3.3.3.3.5">𝑜</ci><ci id="S2.E18.m1.3.3.3.3.6.cmml" xref="S2.E18.m1.3.3.3.3.6">𝑔</ci><apply id="S2.E18.m1.3.3.3.3.2.1.1.cmml" xref="S2.E18.m1.3.3.3.3.2.1"><minus id="S2.E18.m1.3.3.3.3.2.1.1.1.cmml" xref="S2.E18.m1.3.3.3.3.2.1.1.1"></minus><cn id="S2.E18.m1.3.3.3.3.2.1.1.2.cmml" type="integer" xref="S2.E18.m1.3.3.3.3.2.1.1.2">1</cn><apply id="S2.E18.m1.3.3.3.3.2.1.1.3.cmml" xref="S2.E18.m1.3.3.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S2.E18.m1.3.3.3.3.2.1.1.3.1.cmml" xref="S2.E18.m1.3.3.3.3.2.1.1.3">subscript</csymbol><apply id="S2.E18.m1.3.3.3.3.2.1.1.3.2.cmml" xref="S2.E18.m1.3.3.3.3.2.1.1.3.2"><ci id="S2.E18.m1.3.3.3.3.2.1.1.3.2.1.cmml" xref="S2.E18.m1.3.3.3.3.2.1.1.3.2.1">^</ci><ci id="S2.E18.m1.3.3.3.3.2.1.1.3.2.2.cmml" xref="S2.E18.m1.3.3.3.3.2.1.1.3.2.2">𝑦</ci></apply><ci id="S2.E18.m1.3.3.3.3.2.1.1.3.3.cmml" xref="S2.E18.m1.3.3.3.3.2.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E18.m1.3c">\mathcal{L}_{r}=-\sum_{i=1}^{n}\alpha_{i}log(\hat{y}_{i})+(1-\alpha_{i})log(1-%
\hat{y}_{i})</annotation><annotation encoding="application/x-llamapun" id="S2.E18.m1.3d">caligraphic_L start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_l italic_o italic_g ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) italic_l italic_o italic_g ( 1 - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS6.p2.1">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS6.p2.1.m1.1"><semantics id="S2.SS6.p2.1.m1.1a"><mi id="S2.SS6.p2.1.m1.1.1" xref="S2.SS6.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS6.p2.1.m1.1b"><ci id="S2.SS6.p2.1.m1.1.1.cmml" xref="S2.SS6.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.SS6.p2.1.m1.1d">italic_α</annotation></semantics></math> is the one-hot encoding vector of the ground truth.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Experiments</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.4.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.5.2">Experiments Setup</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.1">Datasets.</span> We use two public datasets: Dunhumby<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.dunnhumby.com/source-files/</span></span></span> and Valuedshopper<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://www.kaggle.com/c/acquire-valued-shoppers-challenge/overview</span></span></span>, which are widely used for evaluating next basket recommendation algorithms. In Valuedshopper, we treated all items which were bought by same user in the same day as a basket, and then extracted 10k users sampled data. The characteristics of datasets after pre-processing is shown in the Table <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S3.T1" title="TABLE I ‣ III-A Experiments Setup ‣ III Experiments ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_tag">I</span></a>.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Statistical information of datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T1.1">
<tr class="ltx_tr" id="S3.T1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T1.1.1.1">Dataset</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S3.T1.1.1.2">Dunnhumby</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S3.T1.1.1.3">Valuedshopper</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.1.2.1">#Users</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.1.2.2">2,462</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T1.1.2.3">9,992</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3">
<td class="ltx_td ltx_align_left" id="S3.T1.1.3.1">#Items</td>
<td class="ltx_td ltx_align_right" id="S3.T1.1.3.2">12,150</td>
<td class="ltx_td ltx_align_right" id="S3.T1.1.3.3">6,739</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4">
<td class="ltx_td ltx_align_left" id="S3.T1.1.4.1">#Price</td>
<td class="ltx_td ltx_align_right" id="S3.T1.1.4.2">10</td>
<td class="ltx_td ltx_align_right" id="S3.T1.1.4.3">10</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5">
<td class="ltx_td ltx_align_left" id="S3.T1.1.5.1">#Categories</td>
<td class="ltx_td ltx_align_right" id="S3.T1.1.5.2">235</td>
<td class="ltx_td ltx_align_right" id="S3.T1.1.5.3">490</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6">
<td class="ltx_td ltx_align_left" id="S3.T1.1.6.1">#Baskets</td>
<td class="ltx_td ltx_align_right" id="S3.T1.1.6.2">23,435</td>
<td class="ltx_td ltx_align_right" id="S3.T1.1.6.3">99,771</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T1.1.7.1">Avg. items per basket</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.1.7.2">9.6</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S3.T1.1.7.3">9.7</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">Evaluation Metrics.</span> Following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib22" title="">22</a>]</cite>, we choose the top K (i.e., K = 5, 10, 15) items in the ranking list of all items as the recommended set. To evaluate the performance of our model, we also adopt the widely used Normalized Discounted Cumulative Gain (NDCG) and Hit Rate (Hit).</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Overall performance comparison between the baselines and our model. The bold is the best result and the underline is the second-best.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T2.1">
<tr class="ltx_tr" id="S3.T2.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.1">Dataset</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.2">Metric</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.3">FPMC</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.4">GRU4Rec</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.5">BERT4Rec</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.6">SASRec</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.7">CoHHN</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.8">TIFU-KNN</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T2.1.1.9"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.9.1">BDHH</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.10">Improve.</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.1" rowspan="6"><span class="ltx_text" id="S3.T2.1.2.1.1">Dunnhumby</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2">NDCG@5</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.3">0.0656</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.4">0.0525</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.5">0.0206</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.6">0.0620</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.2.7.1">0.1084</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.8">0.0841</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.1.2.9"><span class="ltx_text ltx_font_bold" id="S3.T2.1.2.9.1">0.1570</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.10">44.8%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3">
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.1">NDCG@10</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.2">0.0738</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.3">0.0597</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.4">0.0261</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.5">0.0699</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.6">0.0994</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.3.7.1">0.1019</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.3.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.3.8.1">0.1469</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.3.9">44.2%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4">
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.1">NDCG@15</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.2">0.0788</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.3">0.0637</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4">0.0279</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.5">0.0749</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.6">0.0980</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.4.7.1">0.1127</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.4.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.4.8.1">0.1428</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.9">26.7%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5">
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.1">Hit@5</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.2">0.0881</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.3">0.0731</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.4">0.0300</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.5">0.0893</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.6">0.3199</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.5.7.1">0.3387</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.5.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.5.8.1">0.4109</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.5.9">21.3%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6">
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.1">Hit@10</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.2">0.1133</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.3">0.0954</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.4">0.0471</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.5">0.1137</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6">0.3967</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.6.7.1">0.4320</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.6.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.6.8.1">0.4758</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.9">10.1%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.7">
<td class="ltx_td ltx_align_left" id="S3.T2.1.7.1">Hit@15</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.7.2">0.1324</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.7.3">0.1108</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.7.4">0.0540</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.7.5">0.1328</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.7.6">0.4442</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.7.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.7.7.1">0.4787</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.7.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.7.8.1">0.5059</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.7.9">5.7%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.8">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S3.T2.1.8.1" rowspan="6"><span class="ltx_text" id="S3.T2.1.8.1.1">Valuedshopper</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.8.2">NDCG@5</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.8.3">0.0571</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.8.4">0.0703</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.8.5">0.0614</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.8.6">0.0675</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.8.7">0.0702</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.8.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.8.8.1">0.1209</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T2.1.8.9"><span class="ltx_text ltx_font_bold" id="S3.T2.1.8.9.1">0.1684</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.8.10">39.3%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.9">
<td class="ltx_td ltx_align_left" id="S3.T2.1.9.1">NDCG@10</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.9.2">0.0702</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.9.3">0.0843</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.9.4">0.0745</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.9.5">0.0810</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.9.6">0.0847</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.9.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.9.7.1">0.1516</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.9.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.9.8.1">0.1637</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.9.9">8.0%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.10">
<td class="ltx_td ltx_align_left" id="S3.T2.1.10.1">NDCG@15</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.10.2">0.0778</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.10.3">0.0928</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.10.4">0.0820</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.10.5">0.0890</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.10.6">0.0998</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.10.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.10.7.1">0.1612</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.10.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.10.8.1">0.1655</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.10.9">2.7%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.11">
<td class="ltx_td ltx_align_left" id="S3.T2.1.11.1">Hit@5</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.11.2">0.0833</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.11.3">0.1002</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.11.4">0.0897</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.11.5">0.1008</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.11.6">0.1029</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.11.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.11.7.1">0.4524</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.11.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.11.8.1">0.4823</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.11.9">6.6%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.12">
<td class="ltx_td ltx_align_left" id="S3.T2.1.12.1">Hit@10</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.12.2">0.1239</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.12.3">0.1439</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.12.4">0.1304</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.12.5">0.1427</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.12.6">0.1478</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.12.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.12.7.1">0.5831</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S3.T2.1.12.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.12.8.1">0.5857</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.12.9">0.4%</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.13">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.13.1">Hit@15</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.13.2">0.1526</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.13.3">0.1760</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.13.4">0.1589</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.13.5">0.1729</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.13.6">0.2084</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.13.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.13.7.1">0.6486</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T2.1.13.8"><span class="ltx_text ltx_font_bold" id="S3.T2.1.13.8.1">0.6576</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.13.9">1.4%</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.2.1">Baselines and Implementation Details.</span> We compared our model BDHH with the following recommendation models including both the conventional baselines and up-to-date deep methods that are often used for predicting items in recommender systems: FPMC <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib3" title="">3</a>]</cite>, GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib23" title="">23</a>]</cite>, BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib24" title="">24</a>]</cite>, SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib25" title="">25</a>]</cite>, CoHHN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib18" title="">18</a>]</cite> and TIFU-KNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#bib.bib8" title="">8</a>]</cite>. Our code and dataset are available at https://github.com/HiYuening/BDHH.
The embedding size is set to 128, the learning rate is <math alttext="1e-5" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mrow id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml"><mn id="S3.SS1.p3.1.m1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.2.2.cmml">1</mn><mo id="S3.SS1.p3.1.m1.1.1.2.1" xref="S3.SS1.p3.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p3.1.m1.1.1.2.3" xref="S3.SS1.p3.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="S3.SS1.p3.1.m1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.cmml">−</mo><mn id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><minus id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1"></minus><apply id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2"><times id="S3.SS1.p3.1.m1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.2.1"></times><cn id="S3.SS1.p3.1.m1.1.1.2.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.2.2">1</cn><ci id="S3.SS1.p3.1.m1.1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.1.2.3">𝑒</ci></apply><cn id="S3.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">1e-5</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">1 italic_e - 5</annotation></semantics></math>, the L2 regularizer is <math alttext="1e-3" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mrow id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mrow id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml"><mn id="S3.SS1.p3.2.m2.1.1.2.2" xref="S3.SS1.p3.2.m2.1.1.2.2.cmml">1</mn><mo id="S3.SS1.p3.2.m2.1.1.2.1" xref="S3.SS1.p3.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS1.p3.2.m2.1.1.2.3" xref="S3.SS1.p3.2.m2.1.1.2.3.cmml">e</mi></mrow><mo id="S3.SS1.p3.2.m2.1.1.1" xref="S3.SS1.p3.2.m2.1.1.1.cmml">−</mo><mn id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><minus id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1.1"></minus><apply id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2"><times id="S3.SS1.p3.2.m2.1.1.2.1.cmml" xref="S3.SS1.p3.2.m2.1.1.2.1"></times><cn id="S3.SS1.p3.2.m2.1.1.2.2.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1.2.2">1</cn><ci id="S3.SS1.p3.2.m2.1.1.2.3.cmml" xref="S3.SS1.p3.2.m2.1.1.2.3">𝑒</ci></apply><cn id="S3.SS1.p3.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p3.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">1e-3</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">1 italic_e - 3</annotation></semantics></math>, the number of self-attention heads is 4, the batch size is set to 8 and 2 respectively, and all parameters in the model are optimized using the Adam optimizer.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.4.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.5.2">Performance Analysis</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">We compare the proposed BDHH with baseline methods on two real-world datasets. The results are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S3.T2" title="TABLE II ‣ III-A Experiments Setup ‣ III Experiments ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_tag">II</span></a>. We can observe that: (1) Models that focus on modeling sequential patterns, including SASRec, BERT4Rec, and GRU4Rec, are the weakest baselines on the Dunnhumby dataset because they only consider the sequential relationships of adjacent items and ignore the complex relationships between items within the basket. Specifically, SASRec outperforms GRU4Rec because they use self-attention mechanisms to capture long-term dependencies in user historical behaviors. In contrast, GRU4Rec uses gated recurrent units (GRUs) to focus on short-term dependencies of sequences. In particular, comparing the experimental results on Dunnhumby and Valuedshopper, we find that SASRec and GRU4Rec perform better than BERT4Rec. (2) CoHHN outperforms SASRec, BERT4Rec, GRU4Rec and FPMC because CoHHN constructs a hypergraph network to learn the impacts of item price. Moreover, FPMC is relatively competitive because it considers adjacent basket relationships. TIFU-KNN performs the best among baseline models on both datasets, demonstrate that the importance of incorporating within-basket items correlation. (3) Our proposed BDHH achieves the best performance in all datasets, with relative improvements ranging from 0.4% to 44.8%. Based on the comparison with the above baselines, we attribute the improvement to two key factors: first, we introduce multiple features of items to build a multi-feature heterogeneous hypergraph network to accurately model the universal representation of items, and second, we build a basket-guided dynamic enhancement network by considering the correlation between baskets and items to enhance the representation of item features in order to more effectively model user preferences.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.4.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.5.2">Ablation Study</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.4">In this section, we analyze how different components of BDHH affect the final performance. We compare two ablation variants, including (1) <math alttext="\underline{w/o\hskip 2.84544pt\mathrm{A}}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><munder accentunder="true" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mrow id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml"><mrow id="S3.SS3.p1.1.m1.1.1.2.2" xref="S3.SS3.p1.1.m1.1.1.2.2.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2.2.2" xref="S3.SS3.p1.1.m1.1.1.2.2.2.cmml">w</mi><mo id="S3.SS3.p1.1.m1.1.1.2.2.1" xref="S3.SS3.p1.1.m1.1.1.2.2.1.cmml">/</mo><mi id="S3.SS3.p1.1.m1.1.1.2.2.3" xref="S3.SS3.p1.1.m1.1.1.2.2.3.cmml">o</mi></mrow><mo id="S3.SS3.p1.1.m1.1.1.2.1" lspace="0.280em" xref="S3.SS3.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p1.1.m1.1.1.2.3" mathvariant="normal" xref="S3.SS3.p1.1.m1.1.1.2.3.cmml">A</mi></mrow><mo id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">¯</mo></munder><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><ci id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1">¯</ci><apply id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2"><times id="S3.SS3.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.1.2.1"></times><apply id="S3.SS3.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2.2"><divide id="S3.SS3.p1.1.m1.1.1.2.2.1.cmml" xref="S3.SS3.p1.1.m1.1.1.2.2.1"></divide><ci id="S3.SS3.p1.1.m1.1.1.2.2.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.p1.1.m1.1.1.2.2.3.cmml" xref="S3.SS3.p1.1.m1.1.1.2.2.3">𝑜</ci></apply><ci id="S3.SS3.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.1.2.3">A</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\underline{w/o\hskip 2.84544pt\mathrm{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">under¯ start_ARG italic_w / italic_o roman_A end_ARG</annotation></semantics></math> removing the basket-guided dynamic augmentation module, and (2) <math alttext="\underline{w/o\hskip 2.84544pt\mathrm{P}}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><munder accentunder="true" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mrow id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml"><mrow id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.2.cmml">w</mi><mo id="S3.SS3.p1.2.m2.1.1.2.2.1" xref="S3.SS3.p1.2.m2.1.1.2.2.1.cmml">/</mo><mi id="S3.SS3.p1.2.m2.1.1.2.2.3" xref="S3.SS3.p1.2.m2.1.1.2.2.3.cmml">o</mi></mrow><mo id="S3.SS3.p1.2.m2.1.1.2.1" lspace="0.280em" xref="S3.SS3.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p1.2.m2.1.1.2.3" mathvariant="normal" xref="S3.SS3.p1.2.m2.1.1.2.3.cmml">P</mi></mrow><mo id="S3.SS3.p1.2.m2.1.1.1" xref="S3.SS3.p1.2.m2.1.1.1.cmml">¯</mo></munder><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><ci id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1.1">¯</ci><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2"><times id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.1"></times><apply id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2"><divide id="S3.SS3.p1.2.m2.1.1.2.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.1"></divide><ci id="S3.SS3.p1.2.m2.1.1.2.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.p1.2.m2.1.1.2.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2.3">𝑜</ci></apply><ci id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3">P</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\underline{w/o\hskip 2.84544pt\mathrm{P}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">under¯ start_ARG italic_w / italic_o roman_P end_ARG</annotation></semantics></math> removing price-based user behavior model. The experimental results of the proposed BDHH and its variants are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.11695v1#S3.T3" title="TABLE III ‣ III-C Ablation Study ‣ III Experiments ‣ Basket-Enhanced Heterogenous Hypergraph for Price-Sensitive Next Basket Recommendation † These authors contributed equally to this work. * Corresponding Author"><span class="ltx_text ltx_ref_tag">III</span></a>. We can observe that each component is effective in significantly improving performance. Notably, <math alttext="\underline{w/o\hskip 2.84544pt\mathrm{A}}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><munder accentunder="true" id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mrow id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml"><mrow id="S3.SS3.p1.3.m3.1.1.2.2" xref="S3.SS3.p1.3.m3.1.1.2.2.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2.2.2" xref="S3.SS3.p1.3.m3.1.1.2.2.2.cmml">w</mi><mo id="S3.SS3.p1.3.m3.1.1.2.2.1" xref="S3.SS3.p1.3.m3.1.1.2.2.1.cmml">/</mo><mi id="S3.SS3.p1.3.m3.1.1.2.2.3" xref="S3.SS3.p1.3.m3.1.1.2.2.3.cmml">o</mi></mrow><mo id="S3.SS3.p1.3.m3.1.1.2.1" lspace="0.280em" xref="S3.SS3.p1.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p1.3.m3.1.1.2.3" mathvariant="normal" xref="S3.SS3.p1.3.m3.1.1.2.3.cmml">A</mi></mrow><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">¯</mo></munder><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><ci id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1">¯</ci><apply id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2"><times id="S3.SS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.2.1"></times><apply id="S3.SS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2.2"><divide id="S3.SS3.p1.3.m3.1.1.2.2.1.cmml" xref="S3.SS3.p1.3.m3.1.1.2.2.1"></divide><ci id="S3.SS3.p1.3.m3.1.1.2.2.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.p1.3.m3.1.1.2.2.3.cmml" xref="S3.SS3.p1.3.m3.1.1.2.2.3">𝑜</ci></apply><ci id="S3.SS3.p1.3.m3.1.1.2.3.cmml" xref="S3.SS3.p1.3.m3.1.1.2.3">A</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\underline{w/o\hskip 2.84544pt\mathrm{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">under¯ start_ARG italic_w / italic_o roman_A end_ARG</annotation></semantics></math> has the worst performance across both datasets and metrics except NDCG, which highlights the importance of learning item-basket-user relationships. Besides, <math alttext="\underline{w/o\hskip 2.84544pt\mathrm{P}}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><munder accentunder="true" id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mrow id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml"><mrow id="S3.SS3.p1.4.m4.1.1.2.2" xref="S3.SS3.p1.4.m4.1.1.2.2.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2.2.2" xref="S3.SS3.p1.4.m4.1.1.2.2.2.cmml">w</mi><mo id="S3.SS3.p1.4.m4.1.1.2.2.1" xref="S3.SS3.p1.4.m4.1.1.2.2.1.cmml">/</mo><mi id="S3.SS3.p1.4.m4.1.1.2.2.3" xref="S3.SS3.p1.4.m4.1.1.2.2.3.cmml">o</mi></mrow><mo id="S3.SS3.p1.4.m4.1.1.2.1" lspace="0.280em" xref="S3.SS3.p1.4.m4.1.1.2.1.cmml">⁢</mo><mi id="S3.SS3.p1.4.m4.1.1.2.3" mathvariant="normal" xref="S3.SS3.p1.4.m4.1.1.2.3.cmml">P</mi></mrow><mo id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml">¯</mo></munder><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><ci id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1">¯</ci><apply id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2"><times id="S3.SS3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.2.1"></times><apply id="S3.SS3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2"><divide id="S3.SS3.p1.4.m4.1.1.2.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2.1"></divide><ci id="S3.SS3.p1.4.m4.1.1.2.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2.2">𝑤</ci><ci id="S3.SS3.p1.4.m4.1.1.2.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2.3">𝑜</ci></apply><ci id="S3.SS3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3">P</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\underline{w/o\hskip 2.84544pt\mathrm{P}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">under¯ start_ARG italic_w / italic_o roman_P end_ARG</annotation></semantics></math> shows a significant performance drop, ranging from 12.7% to 28.3%, confirming the crucial role of price information in capturing user behavior patterns and validating the effectiveness of price-based user preference modeling.</p>
</div>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Ablation study of BDHH variants on Dunnhumby and ValueShopper datasets with K=10.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T3.2">
<tr class="ltx_tr" id="S3.T3.2.3">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T3.2.3.1" rowspan="2"><span class="ltx_text" id="S3.T3.2.3.1.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T3.2.3.2">Dunhumby</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T3.2.3.3">Valuedshopper</td>
</tr>
<tr class="ltx_tr" id="S3.T3.2.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.4.1">NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.4.2">Hit</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.4.3">NDCG</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.4.4">Hit</td>
</tr>
<tr class="ltx_tr" id="S3.T3.2.5">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.2.5.1">BDHH</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.5.2">0.1469</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.5.3">0.4758</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.5.4">0.1637</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T3.2.5.5">0.5857</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.1">
<td class="ltx_td ltx_align_left" id="S3.T3.1.1.1"><math alttext="\underline{w/o\hskip 2.84544pt\mathrm{A}}" class="ltx_Math" display="inline" id="S3.T3.1.1.1.m1.1"><semantics id="S3.T3.1.1.1.m1.1a"><munder accentunder="true" id="S3.T3.1.1.1.m1.1.1" xref="S3.T3.1.1.1.m1.1.1.cmml"><mrow id="S3.T3.1.1.1.m1.1.1.2" xref="S3.T3.1.1.1.m1.1.1.2.cmml"><mrow id="S3.T3.1.1.1.m1.1.1.2.2" xref="S3.T3.1.1.1.m1.1.1.2.2.cmml"><mi id="S3.T3.1.1.1.m1.1.1.2.2.2" xref="S3.T3.1.1.1.m1.1.1.2.2.2.cmml">w</mi><mo id="S3.T3.1.1.1.m1.1.1.2.2.1" xref="S3.T3.1.1.1.m1.1.1.2.2.1.cmml">/</mo><mi id="S3.T3.1.1.1.m1.1.1.2.2.3" xref="S3.T3.1.1.1.m1.1.1.2.2.3.cmml">o</mi></mrow><mo id="S3.T3.1.1.1.m1.1.1.2.1" lspace="0.280em" xref="S3.T3.1.1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.1.1.1.m1.1.1.2.3" mathvariant="normal" xref="S3.T3.1.1.1.m1.1.1.2.3.cmml">A</mi></mrow><mo id="S3.T3.1.1.1.m1.1.1.1" xref="S3.T3.1.1.1.m1.1.1.1.cmml">¯</mo></munder><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.m1.1b"><apply id="S3.T3.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.m1.1.1"><ci id="S3.T3.1.1.1.m1.1.1.1.cmml" xref="S3.T3.1.1.1.m1.1.1.1">¯</ci><apply id="S3.T3.1.1.1.m1.1.1.2.cmml" xref="S3.T3.1.1.1.m1.1.1.2"><times id="S3.T3.1.1.1.m1.1.1.2.1.cmml" xref="S3.T3.1.1.1.m1.1.1.2.1"></times><apply id="S3.T3.1.1.1.m1.1.1.2.2.cmml" xref="S3.T3.1.1.1.m1.1.1.2.2"><divide id="S3.T3.1.1.1.m1.1.1.2.2.1.cmml" xref="S3.T3.1.1.1.m1.1.1.2.2.1"></divide><ci id="S3.T3.1.1.1.m1.1.1.2.2.2.cmml" xref="S3.T3.1.1.1.m1.1.1.2.2.2">𝑤</ci><ci id="S3.T3.1.1.1.m1.1.1.2.2.3.cmml" xref="S3.T3.1.1.1.m1.1.1.2.2.3">𝑜</ci></apply><ci id="S3.T3.1.1.1.m1.1.1.2.3.cmml" xref="S3.T3.1.1.1.m1.1.1.2.3">A</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.m1.1c">\underline{w/o\hskip 2.84544pt\mathrm{A}}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.1.1.1.m1.1d">under¯ start_ARG italic_w / italic_o roman_A end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.2">0.1123</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.3">0.4044</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.4">0.1210</td>
<td class="ltx_td ltx_align_center" id="S3.T3.1.1.5">0.5071</td>
</tr>
<tr class="ltx_tr" id="S3.T3.2.2">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T3.2.2.1"><math alttext="\underline{w/o\hskip 2.84544pt\mathrm{P}}" class="ltx_Math" display="inline" id="S3.T3.2.2.1.m1.1"><semantics id="S3.T3.2.2.1.m1.1a"><munder accentunder="true" id="S3.T3.2.2.1.m1.1.1" xref="S3.T3.2.2.1.m1.1.1.cmml"><mrow id="S3.T3.2.2.1.m1.1.1.2" xref="S3.T3.2.2.1.m1.1.1.2.cmml"><mrow id="S3.T3.2.2.1.m1.1.1.2.2" xref="S3.T3.2.2.1.m1.1.1.2.2.cmml"><mi id="S3.T3.2.2.1.m1.1.1.2.2.2" xref="S3.T3.2.2.1.m1.1.1.2.2.2.cmml">w</mi><mo id="S3.T3.2.2.1.m1.1.1.2.2.1" xref="S3.T3.2.2.1.m1.1.1.2.2.1.cmml">/</mo><mi id="S3.T3.2.2.1.m1.1.1.2.2.3" xref="S3.T3.2.2.1.m1.1.1.2.2.3.cmml">o</mi></mrow><mo id="S3.T3.2.2.1.m1.1.1.2.1" lspace="0.280em" xref="S3.T3.2.2.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.T3.2.2.1.m1.1.1.2.3" mathvariant="normal" xref="S3.T3.2.2.1.m1.1.1.2.3.cmml">P</mi></mrow><mo id="S3.T3.2.2.1.m1.1.1.1" xref="S3.T3.2.2.1.m1.1.1.1.cmml">¯</mo></munder><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.1.m1.1b"><apply id="S3.T3.2.2.1.m1.1.1.cmml" xref="S3.T3.2.2.1.m1.1.1"><ci id="S3.T3.2.2.1.m1.1.1.1.cmml" xref="S3.T3.2.2.1.m1.1.1.1">¯</ci><apply id="S3.T3.2.2.1.m1.1.1.2.cmml" xref="S3.T3.2.2.1.m1.1.1.2"><times id="S3.T3.2.2.1.m1.1.1.2.1.cmml" xref="S3.T3.2.2.1.m1.1.1.2.1"></times><apply id="S3.T3.2.2.1.m1.1.1.2.2.cmml" xref="S3.T3.2.2.1.m1.1.1.2.2"><divide id="S3.T3.2.2.1.m1.1.1.2.2.1.cmml" xref="S3.T3.2.2.1.m1.1.1.2.2.1"></divide><ci id="S3.T3.2.2.1.m1.1.1.2.2.2.cmml" xref="S3.T3.2.2.1.m1.1.1.2.2.2">𝑤</ci><ci id="S3.T3.2.2.1.m1.1.1.2.2.3.cmml" xref="S3.T3.2.2.1.m1.1.1.2.2.3">𝑜</ci></apply><ci id="S3.T3.2.2.1.m1.1.1.2.3.cmml" xref="S3.T3.2.2.1.m1.1.1.2.3">P</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.1.m1.1c">\underline{w/o\hskip 2.84544pt\mathrm{P}}</annotation><annotation encoding="application/x-llamapun" id="S3.T3.2.2.1.m1.1d">under¯ start_ARG italic_w / italic_o roman_P end_ARG</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.2.2.2">0.1053</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.2.2.3">0.4084</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.2.2.4">0.1235</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T3.2.2.5">0.5111</td>
</tr>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Conclusions and Future Work</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this work, we propose a novel NBR model Basket-augmented Dynamic Heterogeneous Hypergraph (BDHH), which employs a heterogeneous hypergraph to explore the intricate relationships within the recommendations process, and develop a dynamic basket-augmentation network to strengthen the connections among items, baskets and users, incorporating price and other essential item factors. Experimental results on real-world datasets demonstrated that our model outperforms competitive baselines and could provide more accurate item combinations prediction. Furthermore, we have studied the contribution of each component in our model through an ablation study. This study confirmed that all components, specifically designed to address the identified research gaps, are essential for achieving optimal performance. In the future, we aim to investigate deeper correlations among item features and to explore the broader influence of price on users’ purchase decisions.
</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
C. Desrosiers and G. Karypis, “A comprehensive survey of neighborhood-based recommendation methods,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Recommender systems handbook</em>, pp. 107–144, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
S. Wu, Y. Tang, Y. Zhu, L. Wang, X. Xie, and T. Tan, “Session-based recommendation with graph neural networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, vol. 33, no. 01, 2019, pp. 346–353.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
S. Rendle, C. Freudenthaler, and L. Schmidt-Thieme, “Factorizing personalized markov chains for next-basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 19th international conference on World wide web</em>, 2010, pp. 811–820.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
D.-T. Le, H. W. Lauw, and Y. Fang, “Correlation-sensitive next-basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 28th International Joint Conference on Artificial Intelligence</em>, 2019, pp. 2808–2814.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Y. H. Chou and P. J. Cheng, “Incorporating co-purchase correlation for next-basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em>, 2023, pp. 3823–3827.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M. Ariannezhad, S. Jullien, M. Li, M. Fang, S. Schelter, and M. de Rijke, “Recanet: A repeat consumption-aware neural network for next basket recommendation in grocery shopping,” in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 45th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2022, pp. 1240–1250.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
A. Romanov, O. Lashinin, M. Ananyeva, and S. Kolesnikov, “Time-aware item weighting for the next basket recommendations,” in <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>, 2023, pp. 985–992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
H. Hu, X. He, J. Gao, and Z.-L. Zhang, “Modeling personalized item frequency information for next-basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 43rd international ACM SIGIR conference on research and development in information retrieval</em>, 2020, pp. 1071–1080.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
T. Bai, J.-Y. Nie, W. X. Zhao, Y. Zhu, P. Du, and J.-R. Wen, “An attribute-aware neural attentive model for next basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">The 41st International ACM SIGIR Conference on Research &amp; Development in Information Retrieval</em>, 2018, pp. 1201–1204.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
F. Yu, Q. Liu, S. Wu, L. Wang, and T. Tan, “A dynamic recurrent model for next basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 39th International ACM SIGIR conference on Research and Development in Information Retrieval</em>, 2016, pp. 729–732.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
W. Sun, R. Xie, J. Zhang, W. X. Zhao, L. Lin, and J.-R. Wen, “Generative next-basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>, 2023, pp. 737–743.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
G. Faggioli, M. Polato, and F. Aiolli, “Recency aware collaborative filtering for next basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 28th ACM Conference on User Modeling, Adaptation and Personalization</em>, 2020, pp. 80–87.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
J. B. Schafer, J. Konstan, and J. Riedl, “Recommender systems in e-commerce,” in <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 1st ACM conference on Electronic commerce</em>, 1999, pp. 158–166.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y. Zheng, C. Gao, X. He, Y. Li, and D. Jin, “Price-aware recommendation with graph convolutional networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">2020 IEEE 36th International Conference on Data Engineering (ICDE)</em>.   IEEE, 2020, pp. 133–144.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
T. Kamishima and S. Akaho, “Personalized pricing recommender system: Multi-stage epsilon-greedy approach,” in <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 2nd International Workshop on Information Heterogeneity and Fusion in Recommender Systems</em>, 2011, pp. 57–64.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
J. Chen, Q. Jin, S. Zhao, S. Bao, L. Zhang, Z. Su, and Y. Yu, “Does product recommendation meet its waterloo in unexplored categories? no, price comes to help,” in <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 37th international ACM SIGIR conference on Research &amp; development in information retrieval</em>, 2014, pp. 667–676.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
P. Umberto, “Developing a price-sensitive recommender system to improve accuracy and business performance of ecommerce applications,” <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">International Journal of Electronic Commerce Studies</em>, vol. 6, no. 1, pp. 1–18, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
X. Zhang, B. Xu, L. Yang, C. Li, F. Ma, H. Liu, and H. Lin, “Price does matter! modeling price and interest preferences in session-based recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 45th international ACM SIGIR conference on research and development in information retrieval</em>, 2022, pp. 1684–1693.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
X. Sun, H. Yin, B. Liu, H. Chen, J. Cao, Y. Shao, and N. Q. Viet Hung, “Heterogeneous hypergraph embedding for graph classification,” in <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 14th ACM international conference on web search and data mining</em>, 2021, pp. 725–733.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. Linmei, T. Yang, C. Shi, H. Ji, and X. Li, “Heterogeneous graph attention networks for semi-supervised short text classification,” in <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 2019 conference on empirical methods in natural language processing and the 9th international joint conference on natural language processing (EMNLP-IJCNLP)</em>, 2019, pp. 4821–4830.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
M. Ariannezhad, M. Li, S. Schelter, and M. De Rijke, “A personalized neighborhood-based model for within-basket recommendation in grocery shopping,” in <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining</em>, 2023, pp. 87–95.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Z. Deng, J. Li, Z. Guo, and G. Li, “Multi-aspect interest neighbor-augmented network for next-basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">ICASSP 2023-2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>.   IEEE, 2023, pp. 1–5.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
B. Hidasi, A. Karatzoglou, L. Baltrunas, and D. Tikk, “Session-based recommendations with recurrent neural networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:1511.06939</em>, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
F. Sun, J. Liu, J. Wu, C. Pei, X. Lin, W. Ou, and P. Jiang, “Bert4rec: Sequential recommendation with bidirectional encoder representations from transformer,” in <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>, 2019, pp. 1441–1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
W.-C. Kang and J. McAuley, “Self-attentive sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">2018 IEEE international conference on data mining (ICDM)</em>.   IEEE, 2018, pp. 197–206.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 18 04:23:32 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
