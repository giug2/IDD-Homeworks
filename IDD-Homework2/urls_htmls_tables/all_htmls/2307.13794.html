<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2307.13794] Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things</title><meta property="og:description" content="In the present era of advanced technology, the Internet of Things (IoT) plays a crucial role in enabling smart connected environments. This includes various domains such as smart homes, smart healthcare, smart cities, …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2307.13794">

<!--Generated on Wed Feb 28 16:22:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Vehicular Internet of Things,  Hierarchical Federated Learning,  Digital Twin,  Anomaly Detection Model">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Deepti Gupta
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">Texas A&amp;M University - Central Texas</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_streetaddress">1001 Leadership Pl,</span><span id="id3.3.id3" class="ltx_text ltx_affiliation_city"></span><span id="id4.4.id4" class="ltx_text ltx_affiliation_state">Texas, USA</span><span id="id5.5.id5" class="ltx_text ltx_affiliation_country"></span><span id="id6.6.id6" class="ltx_text ltx_affiliation_postcode">76549</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:deepti.mrt@gmail.com">deepti.mrt@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shafika Showkat Moni
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id7.1.id1" class="ltx_text ltx_affiliation_institution">Embry-Riddle Aeronautical University</span><span id="id8.2.id2" class="ltx_text ltx_affiliation_streetaddress">P.O. Box 1212</span><span id="id9.3.id3" class="ltx_text ltx_affiliation_city">Daytona Beach</span><span id="id10.4.id4" class="ltx_text ltx_affiliation_state">Florida, USA</span><span id="id11.5.id5" class="ltx_text ltx_affiliation_country"></span><span id="id12.6.id6" class="ltx_text ltx_affiliation_postcode">43017-6221</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:shafika1403@gmail.com">shafika1403@gmail.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ali Saman Tosun
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id13.1.id1" class="ltx_text ltx_affiliation_institution">University of North Carolina at Pembroke</span><span id="id14.2.id2" class="ltx_text ltx_affiliation_city">North Carolina, USA</span><span id="id15.3.id3" class="ltx_text ltx_affiliation_country"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:ali.tosun@uncp.edu">ali.tosun@uncp.edu</a>
</span></span></span>
</div>
<div class="ltx_dates">(2023)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id16.id1" class="ltx_p">In the present era of advanced technology, the Internet of Things (IoT) plays a crucial role in enabling smart connected environments. This includes various domains such as smart homes, smart healthcare, smart cities, smart vehicles, and many others. The IoT facilitates the integration and interconnection of devices, enabling them to communicate, share data, and work together to create intelligent and efficient systems. With ubiquitous smart connected devices and systems, a large amount of data associated with them is at a prime risk from malicious entities (e.g., users, devices, applications) in these systems. Innovative technologies, including cloud computing, Machine Learning (ML), and data analytics, support the development of anomaly detection models for the Vehicular Internet of Things (V-IoT), which encompasses collaborative automatic driving and enhanced transportation systems. However, traditional centralized anomaly detection models fail to provide better services for connected vehicles due to issues such as high latency, privacy leakage, performance overhead, and model drift.</p>
<p id="id17.id2" class="ltx_p">Recently, Federated Learning (FL) has gained significant recognition for its ability to address data privacy concerns in the IoT domain. In the context of V-IoT, which involves autonomous vehicles and intelligent transportation systems with connected vehicles communicating with various sensors and devices, FL is used to develop an anomaly detection model. Current technology, the Digital Twin (DT), proves beneficial in addressing uncertain crises and data security issues by creating a virtual replica that simulates various factors, including traffic trajectories, city policies, and vehicle utilization. This enables the system to facilitate efficient and inclusive decision-making. However, the effectiveness of a V-IoT DT system heavily relies on the collection of long-term and high-quality data to make appropriate decisions. Consequently, its advantages may be limited when confronted with urgent crises like the COVID-19 pandemic.</p>
<p id="id18.id3" class="ltx_p">This paper introduces a Hierarchical Federated Learning (HFL) based anomaly detection model for V-IoT, aiming to enhance the accuracy of the model. Our proposed model integrates both DT and HFL approaches to create a comprehensive system for detecting malicious activities using an anomaly detection model. Additionally, real-world V-IoT use case scenarios are presented to demonstrate the application of the proposed model.</p>
</div>
<div class="ltx_keywords">Vehicular Internet of Things, Hierarchical Federated Learning, Digital Twin, Anomaly Detection Model
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2023</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>International Conference on Research in Adaptive and Convergent Systems; August 6–10, 2023; Gdansk, Poland</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_booktitle"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>International Conference on Research in Adaptive and Convergent Systems (RACS ’23), August 6–10, 2023, Gdansk, Poland</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_price"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span id="id7" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3599957.3606250</span></span></span><span id="id8" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0228-0/23/08</span></span></span><span id="id9" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computer systems organization Embedded systems</span></span></span><span id="id10" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computer systems organization Redundancy</span></span></span><span id="id11" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computer systems organization Robotics</span></span></span><span id="id12" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Networks Network reliability</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The proliferation of Internet of Things (IoT) technology has become increasingly prevalent in our daily lives, primarily driven by the advancements in low latency and high-speed cellular networks. This technological progress has facilitated seamless connectivity and communication between various smart devices, enabling them to exchange data and interact in real-time. As a result, IoT has found widespread applications in diverse domains such as smart homes, healthcare, transportation, industrial automation, and more, enhancing efficiency, convenience, and automation in our day-to-day activities. As a result of such enormous growth, the number of IoT and connected devices is expected to increase to 60 billion by 2025 <cite class="ltx_cite ltx_citemacro_citep">(Moni and
Manivannan, <a href="#bib.bib17" title="" class="ltx_ref">2021</a>)</cite>. A significant part of this rapid increase is likely linked to the Vehicular Internet of Things (V-IoT). V-IoT comprises connected vehicles, Road Side Units (RSUs), sensors, base stations, edge servers, cloud servers, and other devices capable of data sharing and communication with humans. This information generated through V-IoT will play a vital role in traffic management, traffic safety, infotainment services, smart city, and Intelligent Transportation Systems (ITSs), as shown in Figure<a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated Learning (FL) is an innovative approach to Machine Learning (ML) that emphasizes collaborative learning and privacy preservation by avoiding the need to share raw data with a centralized server. In FL, multiple learning agents can efficiently and securely collaborate their computing capabilities to achieve an improved quality of services. The deployment of FL for V-IoT enables vehicles, Roadside Units (RSUs), base stations, and other connected devices to enhance learning efficiency in various aspects such as intelligent environment sensing, intelligent networking, cooperative autonomous driving, and intelligent processing of large volumes of vehicular data. By leveraging FL, V-IoT can benefit from collective intelligence while preserving data privacy and promoting efficient knowledge sharing among the connected entities.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2307.13794/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_landscape" width="207" height="161" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>. </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Applications of Smart Connected Automotive System.</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Recent research studies <cite class="ltx_cite ltx_citemacro_citep">(Du
et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2023</a>; Pokhrel and Choi, <a href="#bib.bib22" title="" class="ltx_ref">2020</a>; Chai
et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2020</a>; Lu
et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> have made significant contributions in securing V-IoT environment from anomalies and malicious entities. These studies have proposed and developed various methods and techniques, leveraging the power of FL, to enhance the security and privacy of the V-IoT systems. Additionally, energy-efficient models have been designed, utilizing the FL approach, to optimize energy consumption in V-IoT deployments. The collective findings of these research works contribute to the ongoing efforts in establishing robust security mechanisms and energy efficiency strategies in the V-IoT domain. Despite advances in FL based models for V-IoT system, there are still growing concerns about safety, security and privacy of users. Therefore, this system requires a comprehensive and robust anomaly detection approach to detect anomalous behavior of various entities effectively.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">A Digital Twin (DT) enables connectivity, interaction, and synchronization between the physical entity and its virtual representation in real time. The DT is considered to be one of the most promising technology due to its advanced capabilities, intelligent services, and bridging the gap between the digital model and its physical counterpart. A digital model of a vehicle can be placed at the edge computing node that can serve as an edge middleware in the V-IoT. With the help of this cloud-edge computing paradigm, large-scale data analysis, storage, and modeling are made possible. In addition to that, a huge volume of geographically dispersed information shared by many DTs can be aggregated to derive synthesized information with effectiveness. By creating a virtual replica that mimics real-world conditions, the DT of V-IoT enables simulations and analysis of crucial factors like traffic trajectories, city policies, and vehicle utilization. This virtual representation enhances decision-making processes and assists in developing effective strategies for managing crises while ensuring the security of data within the V-IoT system.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this paper, we integrate both DT and FL technologies into the V-IoT framework. Our objective is to harness the advanced computing capabilities offered by DT and leverage the collaborative learning potential of FL to address the security and privacy challenges present in V-IoT systems. By combining these technologies, we aim to enhance the overall performance, efficiency, and privacy preservation in the V-IoT environments. The utilization of DT technology can significantly enhance the efficiency of the anomaly detection model by incorporating data from various sources such as smart sensors, traffic light data, weather statistics, vehicle data, and city policies. The integration of data from multiple vendors enables the provision of more accurate and expedited service delivery for the V-IoT system. In our proposed model, DT facilitates data synchronization and weight aggregation in a synchronous manner, reducing the wait time during FL process. This streamlined approach allows participants to efficiently share their data with the model, ultimately improving the overall performance and effectiveness of the FL-based anomaly detection system.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">In our research, we have implemented a Hierarchical Federated Learning (HFL) approach to develop an anomaly detection model. For example, in <span id="S1.p6.1.1" class="ltx_text ltx_font_italic">region-1</span>, where <span id="S1.p6.1.2" class="ltx_text ltx_font_italic">vendor-1</span> operates with two smart vehicles, these vehicles collaborate to build their local anomaly detection model. Similarly, in <span id="S1.p6.1.3" class="ltx_text ltx_font_italic">region-2</span>, where Vendor-2 operates with five smart vehicles, those vehicles collaborate to construct their own local anomaly detection model. This hierarchical approach allows smart vehicles from multiple regions to collaborate at different levels, enabling the development of robust anomaly detection models for the V-IoT within the same smart city.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">By leveraging this HFL approach, our research aims to identify anomalies and enhance the security of the V-IoT systems. Through collaborative learning and data aggregation at different levels, we can improve the accuracy and reliability of the anomaly detection models, ultimately ensuring the integrity and safety of the V-IoT ecosystem. The main contribution of this paper are as follows-</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">In our research, we have identified a research gap in the development of FL based anomaly detection models specifically tailored for the V-IoT domain.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We present the concept of a Hierarchical Federated Learning (HFL) based anomaly detection model.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We propose a system model where we integrate both the emerging DT and FL technologies. This approach provides a powerful framework for enhanced collaboration, learning, and decision-making in the V-IoT domain, ultimately leading to improved performance, efficiency, and security.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We also present a use case scenario to demonstrate the feasibility of our proposed model.</p>
</div>
</li>
</ul>
<p id="S1.p7.2" class="ltx_p">The remainder of this paper is organized as follows. Section <a href="#S2" title="2. Related Work and Background ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents the literature review on DT and FL technologies in vehicular internet domains. We also discuss about the V-IoT, DT, and FL in this section. The concept of a Hierarchical Federated Learning (HFL) based anomaly detection model is presented in Section <a href="#S3" title="3. Hierarchical Federated Learning based Anomaly Detection Model ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Section <a href="#S4" title="4. System Model ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> presents the proposed system model for identifying anomalies and securing V-IoT. We discuss a use case scenario to demonstrate the practical application of our proposed model in Section <a href="#S5" title="5. Use Case Scenario ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Conclusion and future work are discussed in Section <a href="#S6" title="6. Conclusion and Future Work ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work and Background</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">This section provides an in-depth discussion of fundamental concepts and background information that are essential to understand the research contributions. It covers key topics such as the concept of the V-IoT, security and privacy concerns, as well as FL models and DT.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Recently, there has been a growing interest in various technologies such as cloud computing, edge computing, ML, FL, and DT in both academic and industrial sectors. These technologies are seen as promising solutions for enabling smart cities and ITSs. Lu et al. <cite class="ltx_cite ltx_citemacro_citep">(Lu
et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> proposed an asynchronous federated framework to implement secure and effective data sharing in the Internet of Vehicles (IoV). In this approach, each vehicle serves as FL client and shares data with an aggregation server at macro BS (MBS). Vehicles can request a variety of services, including traffic prediction and path selection to the MBS. The MBS develops a shared global model based on accumulated vehicular datasets. Next, the MBS transforms the sharing process into a computing task and resolves the sharing request of vehicles by using an actor-critic reinforcement learning framework.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Chai et al. <cite class="ltx_cite ltx_citemacro_citep">(Chai
et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite> proposed a hierarchical blockchain-enabled FL scheme for IoV. They presented a feasibility analysis of adapting the hierarchical model to manage large-scale vehicles. In this scheme, each vehicle serves as an FL client and uses its hardware resources to implement local learning. Road side units (RSUs) are responsible for collecting transactions from vehicles within their communication region in a blockchain framework. Each RSU compute the FL model and append into the blockchain framework to ensure security. The blockchain framework is shared to all RSUs and vehicles in IoV. Shrivastava et al. <cite class="ltx_cite ltx_citemacro_citep">(Shrivastava and
Dwivedi, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite> presented a brief survey on Security in V-Iot using blockchain. In addition, several security models for protecting IoT devices in other domains are discussed in <cite class="ltx_cite ltx_citemacro_citep">(Gupta
et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2020a</a>, <a href="#bib.bib10" title="" class="ltx_ref">b</a>, <a href="#bib.bib6" title="" class="ltx_ref">2021a</a>, <a href="#bib.bib8" title="" class="ltx_ref">2021b</a>; Aslan
et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2021</a>; Ozkan-Okay et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2021</a>; Gupta
et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2021c</a>, <a href="#bib.bib11" title="" class="ltx_ref">d</a>; Akbarfam et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2023</a>; Moni and Gupta, <a href="#bib.bib15" title="" class="ltx_ref">2022</a>; Pei
et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Vehicular Internet of Things</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">V-IoT can be described as a platform that enables the exchange of information between vehicles and their surroundings. This communication is facilitated through various channels, including vehicle-to-vehicle (V2V), vehicle-to-infrastructure (V2I), and vehicle-to-everything (V2X) communication. These interactions allow vehicles to connect with other vehicles, infrastructure elements, and various entities in their environment, creating a networked ecosystem that enhances safety, efficiency, and overall driving experience. Yang et al. <cite class="ltx_cite ltx_citemacro_citep">(Yang
et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2014</a>)</cite> put forward an abstract network model for the IoV. Their research focuses on discussing the necessary technologies to establish the IoV framework. They explore various applications that can be built upon existing technologies, highlighting the potential of IoV in different domains. V-IoT enables drivers, pedestrians, and other vehicles to utilize the data produced by vehicular ad hoc networks (VANETs) with the aid of roadside infrastructure  <cite class="ltx_cite ltx_citemacro_citep">(Moni and
Manivannan, <a href="#bib.bib16" title="" class="ltx_ref">2020</a>, <a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite>. V-IoT integrates the IoT technology with ITSs to improve transportation efficiency and security. It is anticipated that the V-IoT will play a vital role in enabling connected, shared, autonomous, and electric future mobility. This article <cite class="ltx_cite ltx_citemacro_citep">(Ji
et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> conducted an extensive literature review focusing on the fundamental aspects of the IoV. They covered essential information related to IoV, including basic VANET technology, different network architectures employed in IoV systems, and typical applications of IoV.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2307.13794/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_img_landscape" width="230" height="150" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>. </span><span id="S2.F2.3.2" class="ltx_text" style="font-size:90%;">Overview of Federated Learning Model.</span></figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Federated Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">FL is an approach that places a strong emphasis on privacy by allowing ML models to be trained locally on individual devices, without the need to share the underlying data with a centralized server. This decentralized training process, depicted in Figure <a href="#S2.F2" title="Figure 2 ‣ 2.1. Vehicular Internet of Things ‣ 2. Related Work and Background ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, ensures that sensitive data remains on the devices where it is generated, reducing the risk of privacy breaches. By adopting FL, these privacy risks can be mitigated, as the data remains securely stored on the local devices, and only aggregated model updates are shared with the central server. This way, FL strikes a balance between data privacy and the need for accurate model training, making it a reliable solution for privacy-preserving ML in various applications. Du et al. <cite class="ltx_cite ltx_citemacro_citep">(Du
et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite> conducted a comprehensive survey of existing studies on FL and its use in wireless IoT. Then, they highlighted the potential benefits of FL in addressing the unique requirements and complexities of vehicular IoT environments.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Mothukuri et al. <cite class="ltx_cite ltx_citemacro_citep">(Mothukuri et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite> introduced a novel approach for anomaly detection in IoT networks using FL. Their proposed method leverages decentralized on-device data to proactively identify intrusions in IoT networks.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Digital Twin</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">DT is referred to as a virtual representation of the real-world entity, devices, machines, process, or other abstraction. Physical sensors, computer programs, machine learning algorithms, and software models are used to simulate real-time digital models of the physical entity. Tao et al. <cite class="ltx_cite ltx_citemacro_citep">(Tao
et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite> mentioned that It is considered as one of the most promising enabling technologies for realizing smart manufacturing and Industry 4.0. Wang et al. <cite class="ltx_cite ltx_citemacro_citep">(Wang
et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite> conducted a comprehensive review of the Internet of Digital Twins (IoDT), focusing on various aspects such as system architecture, enabling technologies, and security/privacy concerns. It facilitates real-time interaction, close monitoring, and reliable communication between the digital model and its physical counterpart. DT is considered to be one of the most promising technology due to its advanced capabilities, intelligent services, and bridging the gap between the digital model and its physical counterpart. For instance, the DT of a vehicle can observe the driving pattern of the driver and communicate, interact, and share this information with other DTs to notify the driver about possible issues or emergencies on road.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">Previous research has introduced several anomaly detection models based on FL in various domains. These models have been deployed either on centralized cloud servers or edge devices. Additionally, the concept of digital twins (DT) has been utilized to identify anomalies in the industrial domain. However, as mentioned earlier, these anomaly detection models often suffer from low accuracy rates due to limited volumes of data available for training. Consequently, a robust anomaly detection model that can provide effective security and privacy solutions for protecting V-IoT systems is still lacking. To bridge this gap, our proposed integrated approach-based anomaly detection model offers a novel perspective for detecting anomalies in the vehicular domain. By combining the strengths of different technologies, such as FL and DT, we aim to enhance the accuracy and effectiveness of anomaly detection in the V-IoT systems. Our approach provides a comprehensive solution that leverages collaborative learning among distributed entities and utilizes the virtual replicas created by digital twins to simulate and analyze various factors contributing to anomalies. We strongly believe that our integrated approach presents a promising solution to address the challenges of anomaly detection in the vehicular domain.</p>
</div>
<figure id="S2.F3" class="ltx_figure"><img src="/html/2307.13794/assets/x3.png" id="S2.F3.g1" class="ltx_graphics ltx_img_landscape" width="230" height="140" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>. </span><span id="S2.F3.3.2" class="ltx_text" style="font-size:90%;">Overview of Hierarchical Federated Learning Model.</span></figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Hierarchical Federated Learning based Anomaly Detection Model</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">FL can be widely adopted in the V-IoT domain to train various ML models, such as prediction analysis and anomaly detection, by collecting data from vehicles in a privacy-preserving environment. This approach offers several advantages, including low latency, high efficiency, data privacy, and improved security mechanisms. For RPM use case, a FL-based anomaly detection model <cite class="ltx_cite ltx_citemacro_citep">(Gupta
et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2021d</a>)</cite> is proposed. This model leverages edge computing to execute the anomaly detection models locally on the edge devices without sharing patients’ data with a centralized server. To further enhance the capabilities of the FL model for multi-user scenarios, HFL approach is developed. HFL allows the aggregation of gradients at multiple levels, enabling the participation of multiple entities while leveraging edge computing and DT technologies. Figure <a href="#S2.F3" title="Figure 3 ‣ 2.3. Digital Twin ‣ 2. Related Work and Background ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> provides an overview of this approach. In this research, HFL approach is used to develop anomaly detection model for the V-IoT systems.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">In the connected automotive environment, there are various types of anomalies, such as traffic congestion, collision detection, malicious attacks, vehicle breakdown, traffic violations and driver fatigue or distraction. The detection and timely response to these anomalies can contribute to improving safety, efficiency, and overall performance in connected vehicle environments. Detecting and understanding anomalies in the V-IoT can lead to enhanced safety, security, performance optimization, and better management of traffic and resources. It allows for proactive decision-making and timely interventions to ensure a smoother and more efficient functioning of the connected vehicle ecosystem.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">To develop a HFL based anomaly detection model for the V-IoT, we define the objectives, performance metrics, and requirements for the anomaly detection model. Then, gather relevant data from vehicles in the V-IoT, which may include sensor data, vehicle telemetry, weather statistics, traffic light data and historical records. Ensure that the data collection process preserves privacy and follows ethical guidelines, which is provided by city policies. After that, clean and preprocess the collected data to remove noise, handle missing values, and normalize the features. This step is crucial for preparing the data for further analysis and training. In next step, design the hierarchical architecture for FL in the V-IoT. Where, we need to determine the levels of aggregation such as vehicle-level, region-level, or vendor-level, based on the collaboration requirements and privacy considerations.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">To train the data, we utilize the FedTimeDis LSTM <cite class="ltx_cite ltx_citemacro_citep">(Gupta
et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2021d</a>)</cite> approach, which is specifically designed for the connected automotive environment. Now, each smart vehicle performs local training using their own data. This training is done in a privacy-preserving manner, where data remains on the local device and only model updates (e.g., gradients) are shared. To perform gradient aggregation at each level of the hierarchy to combine the model updates from different participants. This aggregation process ensures that the collective knowledge of the participating entities is utilized to improve the overall anomaly detection model. After developing the model, evaluate the performance of the aggregated anomaly detection model using evaluation metrics such as accuracy, precision, recall, or F1-score. Refine the model if necessary by adjusting hyperparameters, incorporating feedback, or retraining with additional data. This developed HFL-based anomaly detection model can be deployed in a real-world V-IoT environment and the performance of the deployed model can be monitored continuously. Incorporate new data, update the model periodically, and iterate on the anomaly detection process to enhance its accuracy, efficiency, and robustness.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Anomaly Detection of all data nodes <math id="alg1.2.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.2.m1.1b"><mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c"><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1d">N</annotation></semantics></math></figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Collect vehicular the data <math id="alg1.l1.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">D</mi><mi id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝐷</ci><ci id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">D_{i}</annotation></semantics></math> from all data nodes <math id="alg1.l1.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">N</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Preparing the data <math id="alg1.l2.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">D</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐷</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">D_{i}</annotation></semantics></math> by converting into numerical form

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  Normalize the data <math id="alg1.l3.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">D</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐷</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">D_{i}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  Create the sequences sets <math id="alg1.l4.m1.2" class="ltx_Math" alttext="(X^{n},y^{n})" display="inline"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.2.2" xref="alg1.l4.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.l4.m1.2.2.2.3" xref="alg1.l4.m1.2.2.3.cmml">(</mo><msup id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.2.cmml">X</mi><mi id="alg1.l4.m1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.3.cmml">n</mi></msup><mo id="alg1.l4.m1.2.2.2.4" xref="alg1.l4.m1.2.2.3.cmml">,</mo><msup id="alg1.l4.m1.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.cmml"><mi id="alg1.l4.m1.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.cmml">y</mi><mi id="alg1.l4.m1.2.2.2.2.3" xref="alg1.l4.m1.2.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="alg1.l4.m1.2.2.2.5" xref="alg1.l4.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><interval closure="open" id="alg1.l4.m1.2.2.3.cmml" xref="alg1.l4.m1.2.2.2"><apply id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.2">𝑋</ci><ci id="alg1.l4.m1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.l4.m1.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.2.2.1.cmml" xref="alg1.l4.m1.2.2.2.2">superscript</csymbol><ci id="alg1.l4.m1.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2">𝑦</ci><ci id="alg1.l4.m1.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.3">𝑛</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">(X^{n},y^{n})</annotation></semantics></math> of data based on correlations
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>  Take these input sequence sets <math id="alg1.l5.m1.2" class="ltx_Math" alttext="(X^{n},y^{n})" display="inline"><semantics id="alg1.l5.m1.2a"><mrow id="alg1.l5.m1.2.2.2" xref="alg1.l5.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.l5.m1.2.2.2.3" xref="alg1.l5.m1.2.2.3.cmml">(</mo><msup id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.2.cmml">X</mi><mi id="alg1.l5.m1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.3.cmml">n</mi></msup><mo id="alg1.l5.m1.2.2.2.4" xref="alg1.l5.m1.2.2.3.cmml">,</mo><msup id="alg1.l5.m1.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.cmml"><mi id="alg1.l5.m1.2.2.2.2.2" xref="alg1.l5.m1.2.2.2.2.2.cmml">y</mi><mi id="alg1.l5.m1.2.2.2.2.3" xref="alg1.l5.m1.2.2.2.2.3.cmml">n</mi></msup><mo stretchy="false" id="alg1.l5.m1.2.2.2.5" xref="alg1.l5.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.2b"><interval closure="open" id="alg1.l5.m1.2.2.3.cmml" xref="alg1.l5.m1.2.2.2"><apply id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.2">𝑋</ci><ci id="alg1.l5.m1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.3">𝑛</ci></apply><apply id="alg1.l5.m1.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.2.2.2.2.1.cmml" xref="alg1.l5.m1.2.2.2.2">superscript</csymbol><ci id="alg1.l5.m1.2.2.2.2.2.cmml" xref="alg1.l5.m1.2.2.2.2.2">𝑦</ci><ci id="alg1.l5.m1.2.2.2.2.3.cmml" xref="alg1.l5.m1.2.2.2.2.3">𝑛</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.2c">(X^{n},y^{n})</annotation></semantics></math>, where <math id="alg1.l5.m2.3" class="ltx_Math" alttext="n=1,2," display="inline"><semantics id="alg1.l5.m2.3a"><mrow id="alg1.l5.m2.3.3.1" xref="alg1.l5.m2.3.3.1.1.cmml"><mrow id="alg1.l5.m2.3.3.1.1" xref="alg1.l5.m2.3.3.1.1.cmml"><mi id="alg1.l5.m2.3.3.1.1.2" xref="alg1.l5.m2.3.3.1.1.2.cmml">n</mi><mo id="alg1.l5.m2.3.3.1.1.1" xref="alg1.l5.m2.3.3.1.1.1.cmml">=</mo><mrow id="alg1.l5.m2.3.3.1.1.3.2" xref="alg1.l5.m2.3.3.1.1.3.1.cmml"><mn id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">1</mn><mo id="alg1.l5.m2.3.3.1.1.3.2.1" xref="alg1.l5.m2.3.3.1.1.3.1.cmml">,</mo><mn id="alg1.l5.m2.2.2" xref="alg1.l5.m2.2.2.cmml">2</mn></mrow></mrow><mo id="alg1.l5.m2.3.3.1.2" xref="alg1.l5.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.3b"><apply id="alg1.l5.m2.3.3.1.1.cmml" xref="alg1.l5.m2.3.3.1"><eq id="alg1.l5.m2.3.3.1.1.1.cmml" xref="alg1.l5.m2.3.3.1.1.1"></eq><ci id="alg1.l5.m2.3.3.1.1.2.cmml" xref="alg1.l5.m2.3.3.1.1.2">𝑛</ci><list id="alg1.l5.m2.3.3.1.1.3.1.cmml" xref="alg1.l5.m2.3.3.1.1.3.2"><cn type="integer" id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">1</cn><cn type="integer" id="alg1.l5.m2.2.2.cmml" xref="alg1.l5.m2.2.2">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.3c">n=1,2,</annotation></semantics></math>…<math id="alg1.l5.m3.1" class="ltx_math_unparsed" alttext=",N" display="inline"><semantics id="alg1.l5.m3.1a"><mrow id="alg1.l5.m3.1b"><mo id="alg1.l5.m3.1.1">,</mo><mi id="alg1.l5.m3.1.2">N</mi></mrow><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">,N</annotation></semantics></math> from <math id="alg1.l5.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l5.m4.1a"><mi id="alg1.l5.m4.1.1" xref="alg1.l5.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m4.1b"><ci id="alg1.l5.m4.1.1.cmml" xref="alg1.l5.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m4.1c">N</annotation></semantics></math> data nodes, initial model parameter <math id="alg1.l5.m5.1" class="ltx_Math" alttext="w_{z}" display="inline"><semantics id="alg1.l5.m5.1a"><msub id="alg1.l5.m5.1.1" xref="alg1.l5.m5.1.1.cmml"><mi id="alg1.l5.m5.1.1.2" xref="alg1.l5.m5.1.1.2.cmml">w</mi><mi id="alg1.l5.m5.1.1.3" xref="alg1.l5.m5.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l5.m5.1b"><apply id="alg1.l5.m5.1.1.cmml" xref="alg1.l5.m5.1.1"><csymbol cd="ambiguous" id="alg1.l5.m5.1.1.1.cmml" xref="alg1.l5.m5.1.1">subscript</csymbol><ci id="alg1.l5.m5.1.1.2.cmml" xref="alg1.l5.m5.1.1.2">𝑤</ci><ci id="alg1.l5.m5.1.1.3.cmml" xref="alg1.l5.m5.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m5.1c">w_{z}</annotation></semantics></math>, local minibatch size <math id="alg1.l5.m6.1" class="ltx_Math" alttext="J" display="inline"><semantics id="alg1.l5.m6.1a"><mi id="alg1.l5.m6.1.1" xref="alg1.l5.m6.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m6.1b"><ci id="alg1.l5.m6.1.1.cmml" xref="alg1.l5.m6.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m6.1c">J</annotation></semantics></math>, number of local epochs <math id="alg1.l5.m7.1" class="ltx_Math" alttext="H" display="inline"><semantics id="alg1.l5.m7.1a"><mi id="alg1.l5.m7.1.1" xref="alg1.l5.m7.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m7.1b"><ci id="alg1.l5.m7.1.1.cmml" xref="alg1.l5.m7.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m7.1c">H</annotation></semantics></math>, learning rate <math id="alg1.l5.m8.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg1.l5.m8.1a"><mi id="alg1.l5.m8.1.1" xref="alg1.l5.m8.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m8.1b"><ci id="alg1.l5.m8.1.1.cmml" xref="alg1.l5.m8.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m8.1c">\alpha</annotation></semantics></math>, number of rounds <math id="alg1.l5.m9.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="alg1.l5.m9.1a"><mi id="alg1.l5.m9.1.1" xref="alg1.l5.m9.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m9.1b"><ci id="alg1.l5.m9.1.1.cmml" xref="alg1.l5.m9.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m9.1c">Q</annotation></semantics></math>, <math id="alg1.l5.m10.1" class="ltx_Math" alttext="h" display="inline"><semantics id="alg1.l5.m10.1a"><mi id="alg1.l5.m10.1.1" xref="alg1.l5.m10.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m10.1b"><ci id="alg1.l5.m10.1.1.cmml" xref="alg1.l5.m10.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m10.1c">h</annotation></semantics></math> hidden layer.

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>  Split local dataset <math id="alg1.l6.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">D</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝐷</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">D_{i}</annotation></semantics></math> to mini batches of size <math id="alg1.l6.m2.1" class="ltx_Math" alttext="J" display="inline"><semantics id="alg1.l6.m2.1a"><mi id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">J</annotation></semantics></math> which are included into the set <math id="alg1.l6.m3.1" class="ltx_Math" alttext="J_{i}" display="inline"><semantics id="alg1.l6.m3.1a"><msub id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml"><mi id="alg1.l6.m3.1.1.2" xref="alg1.l6.m3.1.1.2.cmml">J</mi><mi id="alg1.l6.m3.1.1.3" xref="alg1.l6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><apply id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.1.1.1.cmml" xref="alg1.l6.m3.1.1">subscript</csymbol><ci id="alg1.l6.m3.1.1.2.cmml" xref="alg1.l6.m3.1.1.2">𝐽</ci><ci id="alg1.l6.m3.1.1.3.cmml" xref="alg1.l6.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">J_{i}</annotation></semantics></math> and fed horizontally to four LSTM cells.

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  <span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg1.l7.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">j</annotation></semantics></math> from 1 to <math id="alg1.l7.m2.1" class="ltx_Math" alttext="H" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">H</annotation></semantics></math> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l8.m1.2" class="ltx_Math" alttext="(X,y)" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.3.2" xref="alg1.l8.m1.2.3.1.cmml"><mo stretchy="false" id="alg1.l8.m1.2.3.2.1" xref="alg1.l8.m1.2.3.1.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">X</mi><mo id="alg1.l8.m1.2.3.2.2" xref="alg1.l8.m1.2.3.1.cmml">,</mo><mi id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l8.m1.2.3.2.3" xref="alg1.l8.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><interval closure="open" id="alg1.l8.m1.2.3.1.cmml" xref="alg1.l8.m1.2.3.2"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑋</ci><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">(X,y)</annotation></semantics></math> <math id="alg1.l8.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg1.l8.m2.1a"><mo id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><in id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\in</annotation></semantics></math> <math id="alg1.l8.m3.1" class="ltx_Math" alttext="J" display="inline"><semantics id="alg1.l8.m3.1a"><mi id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b"><ci id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m3.1c">J</annotation></semantics></math> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        <math id="alg1.l9.m1.3" class="ltx_Math" alttext="{h\textsubscript{t}=LSTM(h\textsubscript{t-1},x\textsubscript{t},w\textsuperscript{n})}" display="inline"><semantics id="alg1.l9.m1.3a"><mrow id="alg1.l9.m1.3.3" xref="alg1.l9.m1.3.3.cmml"><mrow id="alg1.l9.m1.3.3.5" xref="alg1.l9.m1.3.3.5.cmml"><mi id="alg1.l9.m1.3.3.5.2" xref="alg1.l9.m1.3.3.5.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.5.1" xref="alg1.l9.m1.3.3.5.1.cmml">​</mo><mtext id="alg1.l9.m1.3.3.5.3" xref="alg1.l9.m1.3.3.5.3b.cmml"><sub id="alg1.l9.m1.3.3.5.3.1nest" class="ltx_sub">t</sub></mtext></mrow><mo id="alg1.l9.m1.3.3.4" xref="alg1.l9.m1.3.3.4.cmml">=</mo><mrow id="alg1.l9.m1.3.3.3" xref="alg1.l9.m1.3.3.3.cmml"><mi id="alg1.l9.m1.3.3.3.5" xref="alg1.l9.m1.3.3.3.5.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.3.4" xref="alg1.l9.m1.3.3.3.4.cmml">​</mo><mi id="alg1.l9.m1.3.3.3.6" xref="alg1.l9.m1.3.3.3.6.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.3.4a" xref="alg1.l9.m1.3.3.3.4.cmml">​</mo><mi id="alg1.l9.m1.3.3.3.7" xref="alg1.l9.m1.3.3.3.7.cmml">T</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.3.4b" xref="alg1.l9.m1.3.3.3.4.cmml">​</mo><mi id="alg1.l9.m1.3.3.3.8" xref="alg1.l9.m1.3.3.3.8.cmml">M</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.3.4c" xref="alg1.l9.m1.3.3.3.4.cmml">​</mo><mrow id="alg1.l9.m1.3.3.3.3.3" xref="alg1.l9.m1.3.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l9.m1.3.3.3.3.3.4" xref="alg1.l9.m1.3.3.3.3.4.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">​</mo><mtext id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.3b.cmml"><sub id="alg1.l9.m1.1.1.1.1.1.1.3.1nest" class="ltx_sub">t-1</sub></mtext></mrow><mo id="alg1.l9.m1.3.3.3.3.3.5" xref="alg1.l9.m1.3.3.3.3.4.cmml">,</mo><mrow id="alg1.l9.m1.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.cmml">x</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.2.2.2.2.2.2.1" xref="alg1.l9.m1.2.2.2.2.2.2.1.cmml">​</mo><mtext id="alg1.l9.m1.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.3b.cmml"><sub id="alg1.l9.m1.2.2.2.2.2.2.3.1nest" class="ltx_sub">t</sub></mtext></mrow><mo id="alg1.l9.m1.3.3.3.3.3.6" xref="alg1.l9.m1.3.3.3.3.4.cmml">,</mo><mrow id="alg1.l9.m1.3.3.3.3.3.3" xref="alg1.l9.m1.3.3.3.3.3.3.cmml"><mi id="alg1.l9.m1.3.3.3.3.3.3.2" xref="alg1.l9.m1.3.3.3.3.3.3.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m1.3.3.3.3.3.3.1" xref="alg1.l9.m1.3.3.3.3.3.3.1.cmml">​</mo><mtext id="alg1.l9.m1.3.3.3.3.3.3.3" xref="alg1.l9.m1.3.3.3.3.3.3.3b.cmml"><sup id="alg1.l9.m1.3.3.3.3.3.3.3.1nest" class="ltx_sup">n</sup></mtext></mrow><mo stretchy="false" id="alg1.l9.m1.3.3.3.3.3.7" xref="alg1.l9.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.3b"><apply id="alg1.l9.m1.3.3.cmml" xref="alg1.l9.m1.3.3"><eq id="alg1.l9.m1.3.3.4.cmml" xref="alg1.l9.m1.3.3.4"></eq><apply id="alg1.l9.m1.3.3.5.cmml" xref="alg1.l9.m1.3.3.5"><times id="alg1.l9.m1.3.3.5.1.cmml" xref="alg1.l9.m1.3.3.5.1"></times><ci id="alg1.l9.m1.3.3.5.2.cmml" xref="alg1.l9.m1.3.3.5.2">ℎ</ci><ci id="alg1.l9.m1.3.3.5.3b.cmml" xref="alg1.l9.m1.3.3.5.3"><mtext id="alg1.l9.m1.3.3.5.3.cmml" xref="alg1.l9.m1.3.3.5.3"><sub id="alg1.l9.m1.3.3.5.3.1anest" class="ltx_sub">t</sub></mtext></ci></apply><apply id="alg1.l9.m1.3.3.3.cmml" xref="alg1.l9.m1.3.3.3"><times id="alg1.l9.m1.3.3.3.4.cmml" xref="alg1.l9.m1.3.3.3.4"></times><ci id="alg1.l9.m1.3.3.3.5.cmml" xref="alg1.l9.m1.3.3.3.5">𝐿</ci><ci id="alg1.l9.m1.3.3.3.6.cmml" xref="alg1.l9.m1.3.3.3.6">𝑆</ci><ci id="alg1.l9.m1.3.3.3.7.cmml" xref="alg1.l9.m1.3.3.3.7">𝑇</ci><ci id="alg1.l9.m1.3.3.3.8.cmml" xref="alg1.l9.m1.3.3.3.8">𝑀</ci><vector id="alg1.l9.m1.3.3.3.3.4.cmml" xref="alg1.l9.m1.3.3.3.3.3"><apply id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"><times id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2">ℎ</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.3b.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3"><mtext id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3"><sub id="alg1.l9.m1.1.1.1.1.1.1.3.1anest" class="ltx_sub">t-1</sub></mtext></ci></apply><apply id="alg1.l9.m1.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2"><times id="alg1.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.1"></times><ci id="alg1.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2">𝑥</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.3b.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3"><mtext id="alg1.l9.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3"><sub id="alg1.l9.m1.2.2.2.2.2.2.3.1anest" class="ltx_sub">t</sub></mtext></ci></apply><apply id="alg1.l9.m1.3.3.3.3.3.3.cmml" xref="alg1.l9.m1.3.3.3.3.3.3"><times id="alg1.l9.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l9.m1.3.3.3.3.3.3.1"></times><ci id="alg1.l9.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l9.m1.3.3.3.3.3.3.2">𝑤</ci><ci id="alg1.l9.m1.3.3.3.3.3.3.3b.cmml" xref="alg1.l9.m1.3.3.3.3.3.3.3"><mtext id="alg1.l9.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l9.m1.3.3.3.3.3.3.3"><sup id="alg1.l9.m1.3.3.3.3.3.3.3.1anest" class="ltx_sup">n</sup></mtext></ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.3c">{h\textsubscript{t}=LSTM(h\textsubscript{t-1},x\textsubscript{t},w\textsuperscript{n})}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>        <math id="alg1.l10.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="alg1.l10.m1.1a"><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">y</annotation></semantics></math><sup id="alg1.l10.2" class="ltx_sup">n</sup> = <math id="alg1.l10.m2.1" class="ltx_Math" alttext="{\sigma(W\textsuperscript{FC}h\textsubscript{2nd}+Bias)}" display="inline"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.2" xref="alg1.l10.m2.1.1.2.cmml">​</mo><mrow id="alg1.l10.m2.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m2.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m2.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.cmml"><mrow id="alg1.l10.m2.1.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.1.2.cmml"><mi id="alg1.l10.m2.1.1.1.1.1.2.2" xref="alg1.l10.m2.1.1.1.1.1.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.1.1.1.2.1" xref="alg1.l10.m2.1.1.1.1.1.2.1.cmml">​</mo><mtext id="alg1.l10.m2.1.1.1.1.1.2.3" xref="alg1.l10.m2.1.1.1.1.1.2.3b.cmml"><sup id="alg1.l10.m2.1.1.1.1.1.2.3.1nest" class="ltx_sup">FC</sup></mtext><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.1.1.1.2.1a" xref="alg1.l10.m2.1.1.1.1.1.2.1.cmml">​</mo><mi id="alg1.l10.m2.1.1.1.1.1.2.4" xref="alg1.l10.m2.1.1.1.1.1.2.4.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.1.1.1.2.1b" xref="alg1.l10.m2.1.1.1.1.1.2.1.cmml">​</mo><mtext id="alg1.l10.m2.1.1.1.1.1.2.5" xref="alg1.l10.m2.1.1.1.1.1.2.5b.cmml"><sub id="alg1.l10.m2.1.1.1.1.1.2.5.1nest" class="ltx_sub">2nd</sub></mtext></mrow><mo id="alg1.l10.m2.1.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l10.m2.1.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m2.1.1.1.1.1.3.2" xref="alg1.l10.m2.1.1.1.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.1.1.1.3.1" xref="alg1.l10.m2.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m2.1.1.1.1.1.3.3" xref="alg1.l10.m2.1.1.1.1.1.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.1.1.1.3.1a" xref="alg1.l10.m2.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m2.1.1.1.1.1.3.4" xref="alg1.l10.m2.1.1.1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m2.1.1.1.1.1.3.1b" xref="alg1.l10.m2.1.1.1.1.1.3.1.cmml">​</mo><mi id="alg1.l10.m2.1.1.1.1.1.3.5" xref="alg1.l10.m2.1.1.1.1.1.3.5.cmml">s</mi></mrow></mrow><mo stretchy="false" id="alg1.l10.m2.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><times id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2"></times><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝜎</ci><apply id="alg1.l10.m2.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1"><plus id="alg1.l10.m2.1.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1.1.1"></plus><apply id="alg1.l10.m2.1.1.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.1.1.2"><times id="alg1.l10.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l10.m2.1.1.1.1.1.2.1"></times><ci id="alg1.l10.m2.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m2.1.1.1.1.1.2.2">𝑊</ci><ci id="alg1.l10.m2.1.1.1.1.1.2.3b.cmml" xref="alg1.l10.m2.1.1.1.1.1.2.3"><mtext id="alg1.l10.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l10.m2.1.1.1.1.1.2.3"><sup id="alg1.l10.m2.1.1.1.1.1.2.3.1anest" class="ltx_sup">FC</sup></mtext></ci><ci id="alg1.l10.m2.1.1.1.1.1.2.4.cmml" xref="alg1.l10.m2.1.1.1.1.1.2.4">ℎ</ci><ci id="alg1.l10.m2.1.1.1.1.1.2.5b.cmml" xref="alg1.l10.m2.1.1.1.1.1.2.5"><mtext id="alg1.l10.m2.1.1.1.1.1.2.5.cmml" xref="alg1.l10.m2.1.1.1.1.1.2.5"><sub id="alg1.l10.m2.1.1.1.1.1.2.5.1anest" class="ltx_sub">2nd</sub></mtext></ci></apply><apply id="alg1.l10.m2.1.1.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.1.1.3"><times id="alg1.l10.m2.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m2.1.1.1.1.1.3.1"></times><ci id="alg1.l10.m2.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m2.1.1.1.1.1.3.2">𝐵</ci><ci id="alg1.l10.m2.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m2.1.1.1.1.1.3.3">𝑖</ci><ci id="alg1.l10.m2.1.1.1.1.1.3.4.cmml" xref="alg1.l10.m2.1.1.1.1.1.3.4">𝑎</ci><ci id="alg1.l10.m2.1.1.1.1.1.3.5.cmml" xref="alg1.l10.m2.1.1.1.1.1.3.5">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">{\sigma(W\textsuperscript{FC}h\textsubscript{2nd}+Bias)}</annotation></semantics></math>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>        <math id="alg1.l11.m1.1" class="ltx_Math" alttext="u" display="inline"><semantics id="alg1.l11.m1.1a"><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">u</annotation></semantics></math><sup id="alg1.l11.2" class="ltx_sup">n</sup> = <math id="alg1.l11.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l11.m2.1a"><mi id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b"><ci id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m2.1c">w</annotation></semantics></math><sup id="alg1.l11.3" class="ltx_sup">n</sup> - <math id="alg1.l11.m3.1" class="ltx_Math" alttext="{w_{z}^{n}}" display="inline"><semantics id="alg1.l11.m3.1a"><msubsup id="alg1.l11.m3.1.1" xref="alg1.l11.m3.1.1.cmml"><mi id="alg1.l11.m3.1.1.2.2" xref="alg1.l11.m3.1.1.2.2.cmml">w</mi><mi id="alg1.l11.m3.1.1.2.3" xref="alg1.l11.m3.1.1.2.3.cmml">z</mi><mi id="alg1.l11.m3.1.1.3" xref="alg1.l11.m3.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l11.m3.1b"><apply id="alg1.l11.m3.1.1.cmml" xref="alg1.l11.m3.1.1"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.1.cmml" xref="alg1.l11.m3.1.1">superscript</csymbol><apply id="alg1.l11.m3.1.1.2.cmml" xref="alg1.l11.m3.1.1"><csymbol cd="ambiguous" id="alg1.l11.m3.1.1.2.1.cmml" xref="alg1.l11.m3.1.1">subscript</csymbol><ci id="alg1.l11.m3.1.1.2.2.cmml" xref="alg1.l11.m3.1.1.2.2">𝑤</ci><ci id="alg1.l11.m3.1.1.2.3.cmml" xref="alg1.l11.m3.1.1.2.3">𝑧</ci></apply><ci id="alg1.l11.m3.1.1.3.cmml" xref="alg1.l11.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m3.1c">{w_{z}^{n}}</annotation></semantics></math> 
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>        <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w_{z}^{n}" display="inline"><semantics id="alg1.l12.m1.1a"><msubsup id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">z</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝑤</ci><ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">𝑧</ci></apply><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w_{z}^{n}</annotation></semantics></math> <math id="alg1.l12.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l12.m2.1a"><mo stretchy="false" id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg1.l12.m3.1" class="ltx_Math" alttext="w_{z}^{n}" display="inline"><semantics id="alg1.l12.m3.1a"><msubsup id="alg1.l12.m3.1.1" xref="alg1.l12.m3.1.1.cmml"><mi id="alg1.l12.m3.1.1.2.2" xref="alg1.l12.m3.1.1.2.2.cmml">w</mi><mi id="alg1.l12.m3.1.1.2.3" xref="alg1.l12.m3.1.1.2.3.cmml">z</mi><mi id="alg1.l12.m3.1.1.3" xref="alg1.l12.m3.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m3.1b"><apply id="alg1.l12.m3.1.1.cmml" xref="alg1.l12.m3.1.1"><csymbol cd="ambiguous" id="alg1.l12.m3.1.1.1.cmml" xref="alg1.l12.m3.1.1">superscript</csymbol><apply id="alg1.l12.m3.1.1.2.cmml" xref="alg1.l12.m3.1.1"><csymbol cd="ambiguous" id="alg1.l12.m3.1.1.2.1.cmml" xref="alg1.l12.m3.1.1">subscript</csymbol><ci id="alg1.l12.m3.1.1.2.2.cmml" xref="alg1.l12.m3.1.1.2.2">𝑤</ci><ci id="alg1.l12.m3.1.1.2.3.cmml" xref="alg1.l12.m3.1.1.2.3">𝑧</ci></apply><ci id="alg1.l12.m3.1.1.3.cmml" xref="alg1.l12.m3.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m3.1c">w_{z}^{n}</annotation></semantics></math> + <math id="alg1.l12.m4.1" class="ltx_Math" alttext="\frac{\alpha}{N}" display="inline"><semantics id="alg1.l12.m4.1a"><mfrac id="alg1.l12.m4.1.1" xref="alg1.l12.m4.1.1.cmml"><mi id="alg1.l12.m4.1.1.2" xref="alg1.l12.m4.1.1.2.cmml">α</mi><mi id="alg1.l12.m4.1.1.3" xref="alg1.l12.m4.1.1.3.cmml">N</mi></mfrac><annotation-xml encoding="MathML-Content" id="alg1.l12.m4.1b"><apply id="alg1.l12.m4.1.1.cmml" xref="alg1.l12.m4.1.1"><divide id="alg1.l12.m4.1.1.1.cmml" xref="alg1.l12.m4.1.1"></divide><ci id="alg1.l12.m4.1.1.2.cmml" xref="alg1.l12.m4.1.1.2">𝛼</ci><ci id="alg1.l12.m4.1.1.3.cmml" xref="alg1.l12.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m4.1c">\frac{\alpha}{N}</annotation></semantics></math> <math id="alg1.l12.m5.3" class="ltx_Math" alttext="{{\sum}}\textsubscript{$n$ $\in$ $D_{i}$}u\textsuperscript{n}" display="inline"><semantics id="alg1.l12.m5.3a"><mrow id="alg1.l12.m5.3.4" xref="alg1.l12.m5.3.4.cmml"><mo maxsize="120%" minsize="120%" stretchy="true" id="alg1.l12.m5.3.4.1" xref="alg1.l12.m5.3.4.1.cmml">∑</mo><mrow id="alg1.l12.m5.3.4.2" xref="alg1.l12.m5.3.4.2.cmml"><mtext id="alg1.l12.m5.3.3" xref="alg1.l12.m5.3.3n.cmml"><sub id="alg1.l12.m5.3.3.3nest" class="ltx_sub"><XMath xmlns="http://dlmf.nist.gov/LaTeXML" id="alg1.l12.m5.3.3c" fragid="alg1.l12.m5.1.1.1.m1.1nest" xref="alg1.l12.m5.3.3n.cmml"><XMTok role="UNKNOWN" font="italic" id="alg1.l12.m5.3.3d" fragid="alg1.l12.m5.1.1.1.m1.1.1nest" xref="alg1.l12.m5.3.3n.cmml">n</XMTok></XMath> <XMath xmlns="http://dlmf.nist.gov/LaTeXML" id="alg1.l12.m5.3.3f" fragid="alg1.l12.m5.2.2.2.m2.1nest" xref="alg1.l12.m5.3.3n.cmml"><XMTok meaning="element-of" name="in" role="RELOP" id="alg1.l12.m5.3.3g" fragid="alg1.l12.m5.2.2.2.m2.1.1nest" xref="alg1.l12.m5.3.3n.cmml">∈</XMTok></XMath> <XMath xmlns="http://dlmf.nist.gov/LaTeXML" id="alg1.l12.m5.3.3i" fragid="alg1.l12.m5.3.3.3.m3.1nest" xref="alg1.l12.m5.3.3n.cmml"><XMApp id="alg1.l12.m5.3.3j" fragid="alg1.l12.m5.3.3.3.m3.1.1nest" xref="alg1.l12.m5.3.3n.cmml"><XMTok role="SUBSCRIPTOP" scriptpos="post1" id="alg1.l12.m5.3.3k" fragid="alg1.l12.m5.3.3.3.m3.1.1.1nest" xref="alg1.l12.m5.3.3n.cmml"></XMTok><XMTok role="UNKNOWN" font="italic" id="alg1.l12.m5.3.3l" fragid="alg1.l12.m5.3.3.3.m3.1.1.2nest" xref="alg1.l12.m5.3.3n.cmml">D</XMTok><XMTok role="UNKNOWN" fontsize="70%" font="italic" id="alg1.l12.m5.3.3m" fragid="alg1.l12.m5.3.3.3.m3.1.1.3nest" xref="alg1.l12.m5.3.3n.cmml">i</XMTok></XMApp></XMath></sub></mtext><mo lspace="0em" rspace="0em" id="alg1.l12.m5.3.4.2.1" xref="alg1.l12.m5.3.4.2.1.cmml">​</mo><mi id="alg1.l12.m5.3.4.2.2" xref="alg1.l12.m5.3.4.2.2.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m5.3.4.2.1a" xref="alg1.l12.m5.3.4.2.1.cmml">​</mo><mtext id="alg1.l12.m5.3.4.2.3" xref="alg1.l12.m5.3.4.2.3b.cmml"><sup id="alg1.l12.m5.3.4.2.3.1nest" class="ltx_sup">n</sup></mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m5.3b"><apply id="alg1.l12.m5.3.4.cmml" xref="alg1.l12.m5.3.4"><sum id="alg1.l12.m5.3.4.1.cmml" xref="alg1.l12.m5.3.4.1"></sum><apply id="alg1.l12.m5.3.4.2.cmml" xref="alg1.l12.m5.3.4.2"><times id="alg1.l12.m5.3.4.2.1.cmml" xref="alg1.l12.m5.3.4.2.1"></times><ci id="alg1.l12.m5.3.3n.cmml" xref="alg1.l12.m5.3.3"><mtext id="alg1.l12.m5.3.3.cmml" xref="alg1.l12.m5.3.3"><sub id="alg1.l12.m5.3.3.3anest" class="ltx_sub"><XMath xmlns="http://dlmf.nist.gov/LaTeXML" id="alg1.l12.m5.3.3c.cmml" fragid="alg1.l12.m5.1.1.1.m1.1anest" xref="alg1.l12.m5.3.3"><XMTok role="UNKNOWN" font="italic" id="alg1.l12.m5.3.3d.cmml" fragid="alg1.l12.m5.1.1.1.m1.1.1anest" xref="alg1.l12.m5.3.3">n</XMTok></XMath> <XMath xmlns="http://dlmf.nist.gov/LaTeXML" id="alg1.l12.m5.3.3f.cmml" fragid="alg1.l12.m5.2.2.2.m2.1anest" xref="alg1.l12.m5.3.3"><XMTok meaning="element-of" name="in" role="RELOP" id="alg1.l12.m5.3.3g.cmml" fragid="alg1.l12.m5.2.2.2.m2.1.1anest" xref="alg1.l12.m5.3.3">∈</XMTok></XMath> <XMath xmlns="http://dlmf.nist.gov/LaTeXML" id="alg1.l12.m5.3.3i.cmml" fragid="alg1.l12.m5.3.3.3.m3.1anest" xref="alg1.l12.m5.3.3"><XMApp id="alg1.l12.m5.3.3j.cmml" fragid="alg1.l12.m5.3.3.3.m3.1.1anest" xref="alg1.l12.m5.3.3"><XMTok role="SUBSCRIPTOP" scriptpos="post1" id="alg1.l12.m5.3.3k.cmml" fragid="alg1.l12.m5.3.3.3.m3.1.1.1anest" xref="alg1.l12.m5.3.3"></XMTok><XMTok role="UNKNOWN" font="italic" id="alg1.l12.m5.3.3l.cmml" fragid="alg1.l12.m5.3.3.3.m3.1.1.2anest" xref="alg1.l12.m5.3.3">D</XMTok><XMTok role="UNKNOWN" fontsize="70%" font="italic" id="alg1.l12.m5.3.3m.cmml" fragid="alg1.l12.m5.3.3.3.m3.1.1.3anest" xref="alg1.l12.m5.3.3">i</XMTok></XMApp></XMath></sub></mtext></ci><ci id="alg1.l12.m5.3.4.2.2.cmml" xref="alg1.l12.m5.3.4.2.2">𝑢</ci><ci id="alg1.l12.m5.3.4.2.3b.cmml" xref="alg1.l12.m5.3.4.2.3"><mtext id="alg1.l12.m5.3.4.2.3.cmml" xref="alg1.l12.m5.3.4.2.3"><sup id="alg1.l12.m5.3.4.2.3.1anest" class="ltx_sup">n</sup></mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m5.3c">{{\sum}}\textsubscript{$n$ $\in$ $D_{i}$}u\textsuperscript{n}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  <span id="alg1.l14.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>  Update weights <math id="alg1.l15.m1.1" class="ltx_Math" alttext="w_{z}^{n}" display="inline"><semantics id="alg1.l15.m1.1a"><msubsup id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml">z</mi><mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1">superscript</csymbol><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">𝑤</ci><ci id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3">𝑧</ci></apply><ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">w_{z}^{n}</annotation></semantics></math> to federated cloudlet server and start training again until minimizing the error to build the anomaly detection model.

</div>
</div>
<br class="ltx_break ltx_break">
</figure>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2307.13794/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_img_landscape" width="461" height="236" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>. </span><span id="S3.F4.3.2" class="ltx_text" style="font-size:90%;">System Model for V-IoT System.</span></figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>System Model</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we introduce our proposed model, which aims to identify anomalies and enhance the security of the V-IoT systems. The model comprises six distinct phases, each involving data exchange and collaboration among different entities. The overall system architecture is illustrated in Figure <a href="#S3.F4" title="Figure 4 ‣ 3. Hierarchical Federated Learning based Anomaly Detection Model ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, providing a visual representation of the data flow and interaction between the components.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2307.13794/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_img_landscape" width="461" height="236" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>. </span><span id="S4.F5.3.2" class="ltx_text" style="font-size:90%;">Use Case for Vehicular IoT for Anomaly Detection in Federated Setting.</span></figcaption>
</figure>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">The six phases of our proposed model are as follows:</p>
</div>
<div id="S4.p3" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">Initial Phase</span>: During the initial phase of our proposed model, the smart vehicle begins collecting various types of data, including manufacturing data, driver perception data, and external entities data. By collecting these various types of data, the smart vehicle aims to gather comprehensive information about its own performance, the driver’s behavior, and the external environment.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">Functional Phase</span>: During the functional phase of our model, the entities within the V-IoT system transition into operational mode. This phase is divided into two sub-phases, each serving specific purposes. In the first sub-phase, the focus is on collecting data from the vehicle IoT sensors. These sensors, which are activated and operational, capture various types of information such as vehicle diagnostics, and performance metrics. The collected data is then transmitted to the vendor cloudlet, a cloud-based infrastructure specifically designed to handle V-IoT data. Simultaneously, in the second sub-phase, additional data is collected on the vendor cloudlet. This includes a wide range of data sources such as weather statistics, city regulations and policies, traffic light information, and camera data. These supplementary data sources provide contextual information about the external environment in which the vehicles operate.</p>
</div>
<div id="S4.I1.i2.p2" class="ltx_para">
<p id="S4.I1.i2.p2.1" class="ltx_p">By collecting data from both the vehicle IoT sensors and other relevant sources on the vendor cloudlet, a comprehensive and multi-dimensional dataset is created.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_italic">Analytic Phase</span>: Once the data is collected from the V-IoT system, it is transmitted to the simulated environment for further analysis. This phase involves the transition of data from the physical space to the simulated space, where advanced data analytics techniques are applied. In the simulated environment, a DT is developed for each entity within the V-IoT system. A DT is a virtual representation of a physical entity, in this case, the vehicles and other components of the V-IoT system. The DT is created based on the generated data collected from the previous phases. The data analytics process is then performed on the vehicle DT. Various analytical techniques and algorithms are applied to gain insights and extract valuable information from the data. These analytics help in understanding the behavior, performance, and patterns within the V-IoT system.</p>
</div>
<div id="S4.I1.i3.p2" class="ltx_para">
<p id="S4.I1.i3.p2.1" class="ltx_p">By leveraging the DT and conducting data analytics, it becomes possible to identify and understand anomalies within the V-IoT system. Anomalies can include unusual behavior, deviations from normal patterns, or any abnormal activities that may indicate potential security or operational issues.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p"><span id="S4.I1.i4.p1.1.1" class="ltx_text ltx_font_italic">Identifying Anomaly Phase</span>: In this phase, the simulated data <math id="S4.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S4.I1.i4.p1.1.m1.1a"><msub id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.2" xref="S4.I1.i4.p1.1.m1.1.1.2.cmml">D</mi><mi id="S4.I1.i4.p1.1.m1.1.1.3" xref="S4.I1.i4.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><apply id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.1.m1.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.2">𝐷</ci><ci id="S4.I1.i4.p1.1.m1.1.1.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">D_{i}</annotation></semantics></math> from all the data nodes that has been processed and prepared in the previous phase is passed through a pipeline to feed the anomaly detection model. The data is carefully curated and transformed to be compatible with the model’s input requirements. The anomaly detection model is developed using suitable machine learning algorithms and follows the Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3. Hierarchical Federated Learning based Anomaly Detection Model ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. These algorithms are trained on the prepared data to learn the patterns and characteristics of normal behavior within the V-IoT system. The model aims to distinguish between normal and anomalous patterns based on the input data. During the training process, the model undergoes iterations to optimize its performance and enhance its ability to accurately detect anomalies. This involves adjusting the model’s parameters, fine-tuning the algorithms, and validating the model’s performance using appropriate evaluation metrics. Once the training is completed, the anomaly detection model is ready to be deployed and utilized. It collaborates with other models that are part of the subsequent phases, working together to enhance the accuracy and effectiveness of anomaly detection in the V-IoT system.</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p"><span id="S4.I1.i5.p1.1.1" class="ltx_text ltx_font_italic">Collaborative Phase</span>: Indeed, in this phase, the collaboration of multiple anomaly detection models take place to improve the accuracy rate of anomaly detection in the V-IoT system. By combining the weights of multiple ADM models, the overall effectiveness of anomaly detection can be significantly enhanced. Each model may have its own unique approach, algorithm, or specialization in detecting specific types of anomalies. By leveraging the strengths and capabilities of different models, a more comprehensive and robust anomaly detection system can be established. The collaboration among anomaly detection models involves exchanging information, sharing insights, and aggregating their detection results. This collaborative process allows for a holistic analysis of the system’s behavior and the identification of anomalies from multiple perspectives.</p>
</div>
</li>
<li id="S4.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i6.p1" class="ltx_para">
<p id="S4.I1.i6.p1.1" class="ltx_p"><span id="S4.I1.i6.p1.1.1" class="ltx_text ltx_font_italic">Reporting and Decision Phase</span>: After an anomalous scenario is detected by the anomaly detection model, it is crucial to report the anomaly to the relevant stakeholders, including the user, vendor, and device. This phase plays a vital role in facilitating informed decision-making and taking necessary actions to ensure the safety and security of the automotive connected environment. Reporting the anomaly to the user is essential as it enables them to be aware of the detected anomaly and take appropriate measures. This could involve alerting the user through notifications, messages, or visual indicators, providing them with information about the anomaly and any recommended actions they should take. Notifying the vendor is also crucial as it allows them to be aware of the anomaly and take the necessary steps to address the issue. This could involve investigating the root cause of the anomaly, analyzing the data collected, and implementing corrective measures to prevent similar anomalies in the future.</p>
</div>
<div id="S4.I1.i6.p2" class="ltx_para">
<p id="S4.I1.i6.p2.1" class="ltx_p">Overall, this phase of reporting anomalies is a critical component of the anomaly detection process in the V-IoT system. It helps to minimize the risks associated with anomalous events, enables proactive decision-making, and contributes to maintaining a safe and reliable automotive ecosystem.</p>
</div>
</li>
</ul>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">By employing our proposed system model, the V-IoT environment can detect anomalies in real-time and enable prompt responses to the system. This improves overall security and privacy, enhances the efficiency of the transportation system, and improves the driving experience for individuals.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p">The following section presents a use case scenario of V-IoT, where our proposed system model is employed to detect anomalies.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Use Case Scenario</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">V-IoT is unfolding in many ways where users receive better services and take advantage of autonomous vehicle. The proposed system model where we present the integration of FL and DT, which can be used to secure V-IoT applications, for example, ITSs, cooperative autonomous driving, connected car services, smart city integration, collision avoidance systems and intelligent traffic control etc. In this section, we present a use-case scenario for securing V-IoT by developing an anomaly detection model. The Figure <a href="#S4.F5" title="Figure 5 ‣ 4. System Model ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows the use case based on our proposed system model, which is discussed in Section <a href="#S4" title="4. System Model ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">In a smart city, the adoption of IoT technologies and the deployment of smart vehicles are guided by common city policies and regulations. These policies ensure uniformity and standardization across different regions within the smart city. Each region within the smart city may have multiple vendors launching their smart vehicles, contributing to the overall intelligent transportation ecosystem. The presence of multiple vendors in different regions allows for a diverse range of smart vehicles with varying features, technologies, and capabilities. These vehicles may be equipped with advanced sensors, communication systems, and intelligent algorithms to enhance their functionality and contribute to the overall smart city objectives.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">In Figure <a href="#S4.F5" title="Figure 5 ‣ 4. System Model ‣ Integration of Digital Twin and Federated Learning for Securing Vehicular Internet of Things" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, the depicted scenario showcases the presence of two different vendors, namely <span id="S5.p3.1.1" class="ltx_text ltx_font_italic">vendor-1</span> and <span id="S5.p3.1.2" class="ltx_text ltx_font_italic">vendor-2</span>, operating within <span id="S5.p3.1.3" class="ltx_text ltx_font_italic">region-1</span> of the V-IoT system. <span id="S5.p3.1.4" class="ltx_text ltx_font_italic">Vendor-1</span> has two smart vehicles, SV-1 and SV-3, while <span id="S5.p3.1.5" class="ltx_text ltx_font_italic">vendor-2</span> has one smart vehicle, SV-2. Additionally, <span id="S5.p3.1.6" class="ltx_text ltx_font_italic">region-1</span> consists of various data points, including sensor data, city policies and regulations, traffic lights, and weather statistics. To enable efficient data processing and anomaly detection in <span id="S5.p3.1.7" class="ltx_text ltx_font_italic">region-1</span>, a cloudlet is launched specifically for this region. The cloudlet serves as a localized computing resource that can host and deploy DTs of each smart vehicle within the region. These DTs not only receive data from their respective smart vehicles (SV-1, SV-2, and SV-3) but also incorporate data from other sources within the region, such as sensor data, city policies and regulations, traffic lights, and weather statistics.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.1" class="ltx_p">In this use case, we deploy DTs on the cloudlet to reduce the gap between physical objects and their digital representations which are generally hosted in the cloud servers. These cloudlets are hosted by the regions and basically a regional cloud that can better cloud services nearer to the user. Cloudlets <cite class="ltx_cite ltx_citemacro_citep">(Saini and Raj, <a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite> are small-scale, mobility-enhanced cloud data centers that sit at the network’s edge. The cloudlet’s primary goal is to support furious resource and interactive mobile applications by delivering strong computing resources to mobile devices with reduced latency. A wireless local area network with single hop at comparatively higher speed, allows User Equipments (UEs) to connect to the computing resources in the neighboring cloudlet. By leveraging the cloudlet in <span id="S5.p4.1.1" class="ltx_text ltx_font_italic">region-1</span>, the DTs can effectively analyze and process the combined data from multiple sources. This integration of data from various entities allows for a holistic understanding of the V-IoT environment within <span id="S5.p4.1.2" class="ltx_text ltx_font_italic">region-1</span>. The DTs can leverage this comprehensive data to enhance anomaly detection capabilities, identify patterns, and detect any deviations or anomalies in the behavior of the smart vehicles or the overall V-IoT system. The deployment of DTs within the cloudlet of <span id="S5.p4.1.3" class="ltx_text ltx_font_italic">region-1</span> enables localized processing and analysis, reducing latency and enhancing real-time anomaly detection. The collaboration of the DTs with the cloudlet infrastructure facilitates efficient information exchange and enables timely response to any detected anomalies.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.1" class="ltx_p">DT of SV-1 within <span id="S5.p5.1.1" class="ltx_text ltx_font_italic">region-1</span> plays a crucial role in the development of the anomaly detection model. The data collected by SV-1’s DT is utilized to train the initial anomaly detection model specific to <span id="S5.p5.1.2" class="ltx_text ltx_font_italic">region-1</span>. This model focuses on detecting anomalies within the local context and behavior of the vehicles and infrastructure within <span id="S5.p5.1.3" class="ltx_text ltx_font_italic">region-1</span>. To enhance the accuracy and effectiveness of the anomaly detection model, collaboration is encouraged among multiple models. In this case, the anomaly detection models of <span id="S5.p5.1.4" class="ltx_text ltx_font_italic">region-1</span> have the capability to collaborate with each other using the concept of FL. FL allows the models to share their knowledge and insights while maintaining data privacy and security. By aggregating the local models’ learnings through weight aggregation techniques, a more robust and accurate anomaly detection model can be obtained.</p>
</div>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.1" class="ltx_p">Moreover, collaboration is not limited to models within the same region. The anomaly detection model of <span id="S5.p6.1.1" class="ltx_text ltx_font_italic">region-1</span> can also collaborate with the anomaly detection model of <span id="S5.p6.1.2" class="ltx_text ltx_font_italic">region-2</span> by using HFL concept. This collaboration is facilitated by exchanging gradients on a federated multi-cloud server. The gradients represent the model parameters that are shared and utilized to improve the models’ performance collectively. By leveraging the collaboration capabilities of FL and the exchange of gradients on the federated multi-cloud server, the anomaly detection models of different regions can benefit from each other’s insights and experiences. This cross-region collaboration enhances the overall effectiveness of anomaly detection in the V-IoT system by incorporating knowledge from diverse geographical areas and vehicle behaviors.</p>
</div>
<div id="S5.p7" class="ltx_para">
<p id="S5.p7.1" class="ltx_p">In summary, the integration of FL and the exchange of gradients enable collaboration among anomaly detection models at different levels by utilizing DT. This collaboration improves the accuracy and robustness of the models, both within the same region and across different regions, leading to more effective anomaly detection in the V-IoT system.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion and Future Work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we have discussed the relevance of FL in V-IoT environments and its potential impact. We started by providing background information on V-IoT, FL, and DT technologies. We emphasized the importance of anomaly detection models in the V-IoT domain and also presented the outline of HFL based anomaly detection model. To address the challenges and opportunities in the V-IoT, we proposed a system model that integrates DT and FL. This model leverages the collaborative learning capabilities of FL and the bridging capabilities of DT between the physical system and its virtual representation. We outlined the key components and phases of our proposed model, emphasizing data exchange, anomaly detection, and security.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">To illustrate the practical application of our proposed model, we presented a use case scenario in which the model is employed to detect anomalies in the V-IoT environment. The scenario showcased the data collection, processing, anomaly detection, and collaborative response aspects of our model, highlighting its potential benefits in ensuring safety and efficiency in the V-IoT systems.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">Overall, this work aims to contribute to the advancement of FL, DT, and V-IoT research. By introducing our proposed model and presenting a use case scenario, we provide a foundation for further exploration, development, and practical implementation of HFL and DT in the V-IoT environments. We believe that this paper will facilitate the progress of these fields and stimulate further research in the area of HFL-based anomaly detection by utilizing DT in the V-IoT.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akbarfam et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Asma Jodeiri Akbarfam,
Sina Barazandeh, Hoda Maleki, and
Deepti Gupta. 2023.

</span>
<span class="ltx_bibblock">DLACB: Deep Learning Based Access Control Using
Blockchain.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2303.14758</span>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aslan
et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Ömer Aslan, Merve
Ozkan-Okay, and Deepti Gupta.
2021.

</span>
<span class="ltx_bibblock">Intelligent behavior-based malware detection system
on cloud computing environment.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text ltx_font_italic">IEEE Access</span> 9
(2021), 83252–83271.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chai
et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Haoye Chai, Supeng Leng,
Yijin Chen, and Ke Zhang.
2020.

</span>
<span class="ltx_bibblock">A hierarchical blockchain-enabled federated
learning algorithm for knowledge sharing in internet of vehicles.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Intelligent
Transportation Systems</span> 22, 7
(2020), 3975–3986.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du
et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Zhaoyang Du, Celimuge Wu,
Tsutomu Yoshinaga, Kok-Lim Alvin Yau,
Yusheng Ji, and Jie Li.
2020.

</span>
<span class="ltx_bibblock">Federated learning for vehicular internet of
things: Recent advances and open issues.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic">IEEE Open Journal of the Computer Society</span>
1 (2020), 45–61.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta
et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2021a)</span>
<span class="ltx_bibblock">
Deepti Gupta, Smriti
Bhatt, Paras Bhatt, Maanak Gupta, and
Ali Saman Tosun. 2021a.

</span>
<span class="ltx_bibblock">Game Theory Based Privacy Preserving Approach for
Collaborative Deep Learning in IoT.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.3.1" class="ltx_text ltx_font_italic">Deep Learning for Security and Privacy
Preservation in IoT</span>. Springer,
127–149.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta
et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2020a)</span>
<span class="ltx_bibblock">
Deepti Gupta, Smriti
Bhatt, Maanak Gupta, Olumide Kayode,
and Ali Saman Tosun. 2020a.

</span>
<span class="ltx_bibblock">Access control model for google cloud iot. In
<span id="bib.bib7.3.1" class="ltx_text ltx_font_italic">2020 IEEE 6th Intl conference on big data security
on cloud (BigDataSecurity), IEEE Intl conference on high performance and
smart computing,(HPSC) and IEEE Intl conference on intelligent data and
security (IDS)</span>. IEEE, 198–208.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta
et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2021b)</span>
<span class="ltx_bibblock">
Deepti Gupta, Smriti
Bhatt, Maanak Gupta, and Ali Saman
Tosun. 2021b.

</span>
<span class="ltx_bibblock">Future smart connected communities to fight
covid-19 outbreak.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text ltx_font_italic">Internet of Things</span> 13
(2021), 100342.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta
et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2021c)</span>
<span class="ltx_bibblock">
Deepti Gupta, Maanak
Gupta, Smriti Bhatt, and Ali Saman
Tosun. 2021c.

</span>
<span class="ltx_bibblock">Detecting anomalous user behavior in remote patient
monitoring. In <span id="bib.bib9.3.1" class="ltx_text ltx_font_italic">2021 IEEE 22nd International
Conference on Information Reuse and Integration for Data Science (IRI)</span>.
IEEE, 33–40.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta
et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2020b)</span>
<span class="ltx_bibblock">
Deepti Gupta, Olumide
Kayode, Smriti Bhatt, Maanak Gupta,
and Ali Saman Tosun. 2020b.

</span>
<span class="ltx_bibblock">Learner’s dilemma: IoT devices training
strategies in collaborative deep learning. In <span id="bib.bib10.3.1" class="ltx_text ltx_font_italic">2020
IEEE 6th World Forum on Internet of Things (WF-IoT)</span>. IEEE,
1–6.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta
et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2021d)</span>
<span class="ltx_bibblock">
Deepti Gupta, Olumide
Kayode, Smriti Bhatt, Maanak Gupta,
and Ali Saman Tosun. 2021d.

</span>
<span class="ltx_bibblock">Hierarchical federated learning based anomaly
detection using digital twins for smart healthcare. In
<span id="bib.bib11.3.1" class="ltx_text ltx_font_italic">2021 IEEE 7th International Conference on
Collaboration and Internet Computing (CIC)</span>. IEEE, 16–25.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji
et al<span id="bib.bib12.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Baofeng Ji, Xueru Zhang,
Shahid Mumtaz, Congzheng Han,
Chunguo Li, Hong Wen, and
Dan Wang. 2020.

</span>
<span class="ltx_bibblock">Survey on the internet of vehicles: Network
architectures and applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic">IEEE Communications Standards Magazine</span>
4, 1 (2020),
34–41.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Yuchen Li, Weifa Liang,
Jing Li, Xiuzhen Cheng,
Dongxiao Yu, Albert Y Zomaya, and
Song Guo. 2023.

</span>
<span class="ltx_bibblock">Energy-Aware, Device-to-Device Assisted Federated
Learning in Edge Computing.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Parallel and Distributed
Systems</span> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu
et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Yunlong Lu, Xiaohong
Huang, Ke Zhang, Sabita Maharjan, and
Yan Zhang. 2020.

</span>
<span class="ltx_bibblock">Blockchain empowered asynchronous federated
learning for secure data sharing in internet of vehicles.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on Vehicular Technology</span>
69, 4 (2020),
4298–4311.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moni and Gupta (2022)</span>
<span class="ltx_bibblock">
Shafika Showkat Moni and
Deepti Gupta. 2022.

</span>
<span class="ltx_bibblock">Secure and Efficient Privacy-preserving
Authentication Scheme using Cuckoo Filter in Remote Patient Monitoring
Network.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">The Fourth IEEE International Conference on
Trust, Privacy and Security in Intelligent Systems, and Applications</span>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moni and
Manivannan (2020)</span>
<span class="ltx_bibblock">
Shafika Showkat Moni and
D Manivannan. 2020.

</span>
<span class="ltx_bibblock">An efficient RSU authentication scheme based on
Merkle Hash Tree for VANETs. In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">ICC 2020-2020 IEEE
International Conference on Communications (ICC)</span>. IEEE,
1–7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moni and
Manivannan (2021)</span>
<span class="ltx_bibblock">
Shafika Showkat Moni and
D Manivannan. 2021.

</span>
<span class="ltx_bibblock">A scalable and distributed architecture for secure
and privacy-preserving authentication and message dissemination in VANETs.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Internet of Things</span> 13
(2021), 100350.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moni and
Manivannan (2022)</span>
<span class="ltx_bibblock">
Shafika Showkat Moni and
D Manivannan. 2022.

</span>
<span class="ltx_bibblock">CREASE: Certificateless and REused-pseudonym based
Authentication Scheme for Enabling security and privacy in VANETs.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Internet of Things</span> 20
(2022), 100605.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mothukuri et al<span id="bib.bib19.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Viraaji Mothukuri, Prachi
Khare, Reza M Parizi, Seyedamin
Pouriyeh, Ali Dehghantanha, and Gautam
Srivastava. 2021.

</span>
<span class="ltx_bibblock">Federated-learning-based anomaly detection for iot
security attacks.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic">IEEE Internet of Things Journal</span>
9, 4 (2021),
2545–2554.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ozkan-Okay et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Merve Ozkan-Okay, Refik
Samet, Ömer Aslan, and Deepti
Gupta. 2021.

</span>
<span class="ltx_bibblock">A Comprehensive Systematic Literature Review on
Intrusion Detection Systems.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic">IEEE Access</span> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pei
et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Jiaming Pei, Kaiyang
Zhong, Mian Ahmad Jan, and Jinhai Li.
2022.

</span>
<span class="ltx_bibblock">Personalized federated learning framework for
network traffic anomaly detection.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic">Computer Networks</span> 209
(2022), 108906.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pokhrel and Choi (2020)</span>
<span class="ltx_bibblock">
Shiva Raj Pokhrel and
Jinho Choi. 2020.

</span>
<span class="ltx_bibblock">Federated learning with blockchain for autonomous
vehicles: Analysis and design challenges.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Communications</span>
68, 8 (2020),
4734–4746.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saini and Raj (2022)</span>
<span class="ltx_bibblock">
Kavita Saini and Pethuru
Raj. 2022.

</span>
<span class="ltx_bibblock">Chapter Eight-Edge platforms, frameworks and
applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Adv. Comput.</span> 127
(2022), 237–258.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shrivastava and
Dwivedi (2021)</span>
<span class="ltx_bibblock">
Atul Lal Shrivastava and
Rajendra Kumar Dwivedi. 2021.

</span>
<span class="ltx_bibblock">Designing A Secure Vehicular Internet of Things
(IoT) using Blockchain: A Review. In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">2021 First
International Conference on Advances in Computing and Future Communication
Technologies (ICACFCT)</span>. IEEE, 225–230.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tao
et al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Fei Tao, He Zhang,
Ang Liu, and Andrew YC Nee.
2018.

</span>
<span class="ltx_bibblock">Digital twin in industry: State-of-the-art.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic">IEEE Transactions on industrial
informatics</span> 15, 4
(2018), 2405–2415.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang
et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Yuntao Wang, Zhou Su,
Shaolong Guo, Minghui Dai,
Tom H Luan, and Yiliang Liu.
2023.

</span>
<span class="ltx_bibblock">A survey on digital twins: architecture, enabling
technologies, security and privacy, and future prospects.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text ltx_font_italic">IEEE Internet of Things Journal</span>
(2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang
et al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2014)</span>
<span class="ltx_bibblock">
Fangchun Yang, Shangguang
Wang, Jinglin Li, Zhihan Liu, and
Qibo Sun. 2014.

</span>
<span class="ltx_bibblock">An overview of internet of vehicles.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text ltx_font_italic">China communications</span> 11,
10 (2014), 1–15.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2307.13793" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2307.13794" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2307.13794">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2307.13794" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2307.13795" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 16:22:12 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
