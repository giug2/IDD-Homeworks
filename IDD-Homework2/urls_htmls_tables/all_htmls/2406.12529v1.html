<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation</title>
<!--Generated on Tue Jun 18 11:50:14 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Large Language Model,  Multi-Domain,  Multi-Scenario Recommendation,  Click-Through Rate Prediction" lang="en" name="keywords"/>
<base href="/html/2406.12529v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S1" title="In LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2" title="In LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.SS1" title="In 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Multi-Scenario CTR Prediction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.SS2" title="In 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Multi-Scenario Backbone Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.SS3" title="In 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Large Language Model</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3" title="In LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Proposed Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3.SS1" title="In 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overall Framework</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3.SS2" title="In 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Multi-Scenario Knowledge Reasoning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3.SS3" title="In 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Multi-Level Knowledge Fusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3.SS4" title="In 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4" title="In LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS1" title="In 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Settings</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS1.SSS1" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span><span class="ltx_text ltx_font_bold">Datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS1.SSS2" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span><span class="ltx_text ltx_font_bold">Evaluation Metrics</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS1.SSS3" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span><span class="ltx_text ltx_font_bold">Backbone Models</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS1.SSS4" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.4 </span><span class="ltx_text ltx_font_bold">Baselines</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS1.SSS5" title="In 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.5 </span><span class="ltx_text ltx_font_bold">Implementation Details</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS2" title="In 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Overall Performance (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS3" title="In 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation &amp; Component Study (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS4" title="In 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Hyper-parameter Analysis (RQ3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS5" title="In 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Efficiency Analysis (RQ4)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS6" title="In 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Case Study (RQ5)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S5" title="In LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S5.SS1" title="In 5. Related Work ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Multi-Scenario Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S5.SS2" title="In 5. Related Work ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Language Model for CTR Prediction</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S6" title="In LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#A1" title="In LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>EXPERIMENTAL SETTINGS</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#A2" title="In LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Prompt template</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\useunder</span>
<p class="ltx_p" id="p1.2"><span class="ltx_text ltx_ulem_uline" id="p1.2.1"></span><span class="ltx_ERROR undefined" id="p1.2.2">\ul</span>
<span class="ltx_ERROR undefined" id="p1.2.3">\pdfcolInitStack</span>tcb@breakable






















































 

 
 






















 

 






</p>
</div>
<h1 class="ltx_title ltx_title_document">LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuhao Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yhwang25-c@my.cityu.edu.hk">yhwang25-c@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yichao Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wangyichao5@huawei.com">wangyichao5@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zichuan Fu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zichuanfu2-c@my.cityu.edu.hk">zichuanfu2-c@my.cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiangyang Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lixiangyang34@huawei.com">lixiangyang34@huawei.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiangyu Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">City University of Hong Kong</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Hong Kong</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:xianzhao@cityu.edu.hk">xianzhao@cityu.edu.hk</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Huifeng Guo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:huifeng.guo@huawei.com">huifeng.guo@huawei.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ruiming Tang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.1.id1">Huawei Noah’s Ark Lab</span><span class="ltx_text ltx_affiliation_city" id="id20.2.id2">Shenzhen</span><span class="ltx_text ltx_affiliation_country" id="id21.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:tangruiming@huawei.com">tangruiming@huawei.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id22.id1">As the demand for more personalized recommendation grows and a dramatic boom in commercial scenarios arises, the study on multi-scenario recommendation (MSR) has attracted much attention, which uses the data from all scenarios to simultaneously improve their recommendation performance.
However, existing methods tend to integrate insufficient scenario knowledge and neglect learning personalized cross-scenario preferences, thus leading to sub-optimal performance and inadequate interpretability.
Meanwhile, though large language model (LLM) has shown great capability of reasoning and capturing semantic information, the high inference latency and high computation cost of tuning hinder its implementation in industrial recommender systems.
To fill these gaps, we propose an effective efficient interpretable LLM-enhanced paradigm LLM4MSR in this work.
Specifically, we first leverage LLM to uncover multi-level knowledge including scenario correlations and users’ cross-scenario interests from the designed scenario- and user-level prompt without fine-tuning the LLM, then adopt hierarchical meta networks to generate multi-level meta layers
to explicitly improves the scenario-aware and personalized recommendation capability.
Our experiments on KuaiSAR-small, KuaiSAR, and Amazon datasets validate two significant advantages of LLM4MSR: (i) the effectiveness and compatibility with different multi-scenario backbone models (achieving 1.5%, 1%, and 40% AUC improvement on three datasets), (ii) high efficiency and deployability on industrial recommender systems, and (iii) improved interpretability.
The implemented code and data is available to ease reproduction<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://anonymous.4open.science/r/LLM4MSR/" title="">https://anonymous.4open.science/r/LLM4MSR/</a></span></span></span>.</p>
</div>
<div class="ltx_keywords">Large Language Model, Multi-Domain, Multi-Scenario Recommendation, Click-Through Rate Prediction
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmcopyright</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The research on recommender system (RS) has been a hot spot in the past few years which targets at mining users’ interests from the vast amount of historical interaction data.
In order to provide services in a more personalized manner and make profits, an explosive growth of business scenarios (also known as domains) are emerging in commercial RSs such as the search and recommendation services on mobile apps <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib14" title="">2023</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib24" title="">2023</a>)</cite> and different product categories on the e-commerce platform <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib21" title="">2019</a>)</cite>.
Therefore, as a group of efficient joint modeling approach, multi-scenario recommendation (MSR) has drawn attention increasingly, which exploits all data to improve the recommendation accuracy on all these scenarios, thus addressing the data sparsity issue <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib39" title="">2021</a>)</cite> and reducing computation cost.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Nevertheless, existing MSR methods usually suffer from the following two limitations:
<span class="ltx_text ltx_font_bold" id="S1.p2.1.1">(i)</span> Insufficient scenario knowledge is incorporated. Specifically, domain indicator is usually the only scenario knowledge leveraged to capture the domain distinction in practice <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib4" title="">2023</a>)</cite>, while the abundant semantic information such as the description of scenario is neglected.
Consequently, the correlations among scenarios are not adequately established.
<span class="ltx_text ltx_font_bold" id="S1.p2.1.2">(ii)</span> Users’ personalized preferences across scenarios tend to be ignored, since most MSR models merely rely on different parameter sharing patterns in multi-task learning <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib29" title="">2023a</a>)</cite> and the collaborative signal learned in conventional RSs to conduct recommendation.
However, these deficiencies are still overlooked even if they would lead to the sub-optimal performance of multi-scenario recommender system.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To tackle these drawbacks of conventional MSR models, we resort to large language model (LLM) which is known for its remarkable capability of language understanding and reasoning <cite class="ltx_cite ltx_citemacro_citep">(Fan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib11" title="">2023</a>)</cite>. Although there have been some attempts to enhance RSs harnessing LLM <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib14" title="">2023</a>; Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib34" title="">2023</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>)</cite>, there are some key challenges.
The first is high inference latency of LLM since the existing methods conduct training and inference with LLM through sample level alignment <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib26" title="">2023b</a>)</cite>.
Second, the information generated from LLM is usually in natural language format. In other words, it requires filling the gap between semantic and recommendation space like employing additional knowledge encoder <cite class="ltx_cite ltx_citemacro_citep">(Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib32" title="">2023</a>)</cite> and instruction tuning on LLM <cite class="ltx_cite ltx_citemacro_citep">(Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib34" title="">2023</a>)</cite> which brings high computation cost. Moreover, both conventional RS and LLM-based recommendation methods lack interpretability.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To this end, we propose an LLM-based paradigm to enhance conventional multi-scenario recommendation, which leverages LLM and hierarchical meta networks to explicitly improve the performance of the backbone model on all scenarios. To be specific, on the one hand, LLM helps grasping the cross-scenario correlation and personalized preferences, while the meta networks act as a flexible and adaptive bridge connecting the semantic space in LLM and the recommendation space in the multi-scenario backbone model. On the other hand, to tackle the efficiency of LLM (see Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3.SS4" title="3.4. Discussion ‣ 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">3.4</span></a>), a frozen LLM is used without tuning and high level of user- &amp; scenario knowledge is reasoned about through prompt design.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The main contributions of this paper are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose an effective efficient interpretable paradigm LLM4MSR for multi-scenario recommendation enhancement by exploiting LLM. To the best of our knowledge, it is the first practical solution to reasoning about multi-scenario knowledge
through LLM and bring information gain in recommender systems.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">The scenario commonality and heterogeneity, and users’ cross-scenario preferences are explicitly captured by LLM through the designed scenario- and user-level prompt. Furthermore, they are leveraged by the hierarchical meta networks which generate meta layers to explicitly enhance the scenario-aware and personalized recommendation capability of multi-scenario backbones.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Extensive experiments on three real-world datasets show that LLM4MSR is an effective paradigm compared with state-of-the-art multi-scenario enhancement methods and compatible with various MSR backbone models. Besides, it is efficient to deploy on industrial recommender systems and enables real-time recommendation <span class="ltx_text ltx_font_bold" id="S1.I1.i3.p1.1.1">without fine-tuning LLM</span>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Preliminary</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This section first introduces the problem formulation of multi-scenario CTR prediction and the typical architecture of multi-scenario backbone models. Then, large language model is illustrated.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Multi-Scenario CTR Prediction</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.24">The Click-Trough Rate (CTR) prediction task is essential in recommendation which is a binary classification problem. Specifically, in a multi-scenario recommender system, the historical interaction sample <math alttext="(d,\bm{x})" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.2"><semantics id="S2.SS1.p1.1.m1.2a"><mrow id="S2.SS1.p1.1.m1.2.3.2" xref="S2.SS1.p1.1.m1.2.3.1.cmml"><mo id="S2.SS1.p1.1.m1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.1.m1.2.3.1.cmml">(</mo><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">d</mi><mo id="S2.SS1.p1.1.m1.2.3.2.2" xref="S2.SS1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S2.SS1.p1.1.m1.2.2" xref="S2.SS1.p1.1.m1.2.2.cmml">𝒙</mi><mo id="S2.SS1.p1.1.m1.2.3.2.3" stretchy="false" xref="S2.SS1.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.2b"><interval closure="open" id="S2.SS1.p1.1.m1.2.3.1.cmml" xref="S2.SS1.p1.1.m1.2.3.2"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑑</ci><ci id="S2.SS1.p1.1.m1.2.2.cmml" xref="S2.SS1.p1.1.m1.2.2">𝒙</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.2c">(d,\bm{x})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.2d">( italic_d , bold_italic_x )</annotation></semantics></math> is taken as input to predict the ground truth label <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_y</annotation></semantics></math> where <math alttext="y=1" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">y</mi><mo id="S2.SS1.p1.3.m3.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><eq id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1"></eq><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝑦</ci><cn id="S2.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S2.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">y=1</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_y = 1</annotation></semantics></math> and <math alttext="y=0" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">y</mi><mo id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><eq id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1"></eq><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝑦</ci><cn id="S2.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S2.SS1.p1.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">y=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_y = 0</annotation></semantics></math> denote click and unclick, respectively. <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_d</annotation></semantics></math> represents the domain indicator <math alttext="d\in\{1,2,\dots,D\}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.4"><semantics id="S2.SS1.p1.6.m6.4a"><mrow id="S2.SS1.p1.6.m6.4.5" xref="S2.SS1.p1.6.m6.4.5.cmml"><mi id="S2.SS1.p1.6.m6.4.5.2" xref="S2.SS1.p1.6.m6.4.5.2.cmml">d</mi><mo id="S2.SS1.p1.6.m6.4.5.1" xref="S2.SS1.p1.6.m6.4.5.1.cmml">∈</mo><mrow id="S2.SS1.p1.6.m6.4.5.3.2" xref="S2.SS1.p1.6.m6.4.5.3.1.cmml"><mo id="S2.SS1.p1.6.m6.4.5.3.2.1" stretchy="false" xref="S2.SS1.p1.6.m6.4.5.3.1.cmml">{</mo><mn id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">1</mn><mo id="S2.SS1.p1.6.m6.4.5.3.2.2" xref="S2.SS1.p1.6.m6.4.5.3.1.cmml">,</mo><mn id="S2.SS1.p1.6.m6.2.2" xref="S2.SS1.p1.6.m6.2.2.cmml">2</mn><mo id="S2.SS1.p1.6.m6.4.5.3.2.3" xref="S2.SS1.p1.6.m6.4.5.3.1.cmml">,</mo><mi id="S2.SS1.p1.6.m6.3.3" mathvariant="normal" xref="S2.SS1.p1.6.m6.3.3.cmml">…</mi><mo id="S2.SS1.p1.6.m6.4.5.3.2.4" xref="S2.SS1.p1.6.m6.4.5.3.1.cmml">,</mo><mi id="S2.SS1.p1.6.m6.4.4" xref="S2.SS1.p1.6.m6.4.4.cmml">D</mi><mo id="S2.SS1.p1.6.m6.4.5.3.2.5" stretchy="false" xref="S2.SS1.p1.6.m6.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.4b"><apply id="S2.SS1.p1.6.m6.4.5.cmml" xref="S2.SS1.p1.6.m6.4.5"><in id="S2.SS1.p1.6.m6.4.5.1.cmml" xref="S2.SS1.p1.6.m6.4.5.1"></in><ci id="S2.SS1.p1.6.m6.4.5.2.cmml" xref="S2.SS1.p1.6.m6.4.5.2">𝑑</ci><set id="S2.SS1.p1.6.m6.4.5.3.1.cmml" xref="S2.SS1.p1.6.m6.4.5.3.2"><cn id="S2.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S2.SS1.p1.6.m6.1.1">1</cn><cn id="S2.SS1.p1.6.m6.2.2.cmml" type="integer" xref="S2.SS1.p1.6.m6.2.2">2</cn><ci id="S2.SS1.p1.6.m6.3.3.cmml" xref="S2.SS1.p1.6.m6.3.3">…</ci><ci id="S2.SS1.p1.6.m6.4.4.cmml" xref="S2.SS1.p1.6.m6.4.4">𝐷</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.4c">d\in\{1,2,\dots,D\}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.4d">italic_d ∈ { 1 , 2 , … , italic_D }</annotation></semantics></math> indicating the origin of sample. <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">bold_italic_x</annotation></semantics></math> denotes the feature fields including user and item attributes. For simplicity, suppose there are <math alttext="M" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">italic_M</annotation></semantics></math> categorical features, then <math alttext="\bm{x}=[\bm{x}_{1},\ldots,\bm{x}_{m},\ldots,\bm{x}_{M}]" class="ltx_Math" display="inline" id="S2.SS1.p1.9.m9.5"><semantics id="S2.SS1.p1.9.m9.5a"><mrow id="S2.SS1.p1.9.m9.5.5" xref="S2.SS1.p1.9.m9.5.5.cmml"><mi id="S2.SS1.p1.9.m9.5.5.5" xref="S2.SS1.p1.9.m9.5.5.5.cmml">𝒙</mi><mo id="S2.SS1.p1.9.m9.5.5.4" xref="S2.SS1.p1.9.m9.5.5.4.cmml">=</mo><mrow id="S2.SS1.p1.9.m9.5.5.3.3" xref="S2.SS1.p1.9.m9.5.5.3.4.cmml"><mo id="S2.SS1.p1.9.m9.5.5.3.3.4" stretchy="false" xref="S2.SS1.p1.9.m9.5.5.3.4.cmml">[</mo><msub id="S2.SS1.p1.9.m9.3.3.1.1.1" xref="S2.SS1.p1.9.m9.3.3.1.1.1.cmml"><mi id="S2.SS1.p1.9.m9.3.3.1.1.1.2" xref="S2.SS1.p1.9.m9.3.3.1.1.1.2.cmml">𝒙</mi><mn id="S2.SS1.p1.9.m9.3.3.1.1.1.3" xref="S2.SS1.p1.9.m9.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.9.m9.5.5.3.3.5" xref="S2.SS1.p1.9.m9.5.5.3.4.cmml">,</mo><mi id="S2.SS1.p1.9.m9.1.1" mathvariant="normal" xref="S2.SS1.p1.9.m9.1.1.cmml">…</mi><mo id="S2.SS1.p1.9.m9.5.5.3.3.6" xref="S2.SS1.p1.9.m9.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.9.m9.4.4.2.2.2" xref="S2.SS1.p1.9.m9.4.4.2.2.2.cmml"><mi id="S2.SS1.p1.9.m9.4.4.2.2.2.2" xref="S2.SS1.p1.9.m9.4.4.2.2.2.2.cmml">𝒙</mi><mi id="S2.SS1.p1.9.m9.4.4.2.2.2.3" xref="S2.SS1.p1.9.m9.4.4.2.2.2.3.cmml">m</mi></msub><mo id="S2.SS1.p1.9.m9.5.5.3.3.7" xref="S2.SS1.p1.9.m9.5.5.3.4.cmml">,</mo><mi id="S2.SS1.p1.9.m9.2.2" mathvariant="normal" xref="S2.SS1.p1.9.m9.2.2.cmml">…</mi><mo id="S2.SS1.p1.9.m9.5.5.3.3.8" xref="S2.SS1.p1.9.m9.5.5.3.4.cmml">,</mo><msub id="S2.SS1.p1.9.m9.5.5.3.3.3" xref="S2.SS1.p1.9.m9.5.5.3.3.3.cmml"><mi id="S2.SS1.p1.9.m9.5.5.3.3.3.2" xref="S2.SS1.p1.9.m9.5.5.3.3.3.2.cmml">𝒙</mi><mi id="S2.SS1.p1.9.m9.5.5.3.3.3.3" xref="S2.SS1.p1.9.m9.5.5.3.3.3.3.cmml">M</mi></msub><mo id="S2.SS1.p1.9.m9.5.5.3.3.9" stretchy="false" xref="S2.SS1.p1.9.m9.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.5b"><apply id="S2.SS1.p1.9.m9.5.5.cmml" xref="S2.SS1.p1.9.m9.5.5"><eq id="S2.SS1.p1.9.m9.5.5.4.cmml" xref="S2.SS1.p1.9.m9.5.5.4"></eq><ci id="S2.SS1.p1.9.m9.5.5.5.cmml" xref="S2.SS1.p1.9.m9.5.5.5">𝒙</ci><list id="S2.SS1.p1.9.m9.5.5.3.4.cmml" xref="S2.SS1.p1.9.m9.5.5.3.3"><apply id="S2.SS1.p1.9.m9.3.3.1.1.1.cmml" xref="S2.SS1.p1.9.m9.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.9.m9.3.3.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m9.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.9.m9.3.3.1.1.1.2">𝒙</ci><cn id="S2.SS1.p1.9.m9.3.3.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.9.m9.3.3.1.1.1.3">1</cn></apply><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">…</ci><apply id="S2.SS1.p1.9.m9.4.4.2.2.2.cmml" xref="S2.SS1.p1.9.m9.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.4.4.2.2.2.1.cmml" xref="S2.SS1.p1.9.m9.4.4.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.9.m9.4.4.2.2.2.2.cmml" xref="S2.SS1.p1.9.m9.4.4.2.2.2.2">𝒙</ci><ci id="S2.SS1.p1.9.m9.4.4.2.2.2.3.cmml" xref="S2.SS1.p1.9.m9.4.4.2.2.2.3">𝑚</ci></apply><ci id="S2.SS1.p1.9.m9.2.2.cmml" xref="S2.SS1.p1.9.m9.2.2">…</ci><apply id="S2.SS1.p1.9.m9.5.5.3.3.3.cmml" xref="S2.SS1.p1.9.m9.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m9.5.5.3.3.3.1.cmml" xref="S2.SS1.p1.9.m9.5.5.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.9.m9.5.5.3.3.3.2.cmml" xref="S2.SS1.p1.9.m9.5.5.3.3.3.2">𝒙</ci><ci id="S2.SS1.p1.9.m9.5.5.3.3.3.3.cmml" xref="S2.SS1.p1.9.m9.5.5.3.3.3.3">𝑀</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.5c">\bm{x}=[\bm{x}_{1},\ldots,\bm{x}_{m},\ldots,\bm{x}_{M}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.9.m9.5d">bold_italic_x = [ bold_italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , … , bold_italic_x start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ]</annotation></semantics></math> where <math alttext="\bm{x}_{m}" class="ltx_Math" display="inline" id="S2.SS1.p1.10.m10.1"><semantics id="S2.SS1.p1.10.m10.1a"><msub id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2" xref="S2.SS1.p1.10.m10.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2">𝒙</ci><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\bm{x}_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.10.m10.1d">bold_italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> indicates the one-hot encoding of the <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p1.11.m11.1"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.11.m11.1d">italic_m</annotation></semantics></math>-th feature. Next, <math alttext="\bm{x}" class="ltx_Math" display="inline" id="S2.SS1.p1.12.m12.1"><semantics id="S2.SS1.p1.12.m12.1a"><mi id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.12.m12.1d">bold_italic_x</annotation></semantics></math> is mapped into a dense vector <math alttext="\bm{e}=[\bm{e}_{1}\|\ldots\|\bm{e}_{m}\|\ldots\|\bm{e}_{M}]" class="ltx_Math" display="inline" id="S2.SS1.p1.13.m13.3"><semantics id="S2.SS1.p1.13.m13.3a"><mrow id="S2.SS1.p1.13.m13.3.3" xref="S2.SS1.p1.13.m13.3.3.cmml"><mi id="S2.SS1.p1.13.m13.3.3.3" xref="S2.SS1.p1.13.m13.3.3.3.cmml">𝒆</mi><mo id="S2.SS1.p1.13.m13.3.3.2" xref="S2.SS1.p1.13.m13.3.3.2.cmml">=</mo><mrow id="S2.SS1.p1.13.m13.3.3.1.1" xref="S2.SS1.p1.13.m13.3.3.1.2.cmml"><mo id="S2.SS1.p1.13.m13.3.3.1.1.2" stretchy="false" xref="S2.SS1.p1.13.m13.3.3.1.2.1.cmml">[</mo><mrow id="S2.SS1.p1.13.m13.3.3.1.1.1" xref="S2.SS1.p1.13.m13.3.3.1.1.1.cmml"><msub id="S2.SS1.p1.13.m13.3.3.1.1.1.2" xref="S2.SS1.p1.13.m13.3.3.1.1.1.2.cmml"><mi id="S2.SS1.p1.13.m13.3.3.1.1.1.2.2" xref="S2.SS1.p1.13.m13.3.3.1.1.1.2.2.cmml">𝒆</mi><mn id="S2.SS1.p1.13.m13.3.3.1.1.1.2.3" xref="S2.SS1.p1.13.m13.3.3.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS1.p1.13.m13.3.3.1.1.1.1" xref="S2.SS1.p1.13.m13.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS1.p1.13.m13.3.3.1.1.1.3.2" xref="S2.SS1.p1.13.m13.3.3.1.1.1.3.1.cmml"><mo id="S2.SS1.p1.13.m13.3.3.1.1.1.3.2.1" stretchy="false" xref="S2.SS1.p1.13.m13.3.3.1.1.1.3.1.1.cmml">‖</mo><mi id="S2.SS1.p1.13.m13.1.1" mathvariant="normal" xref="S2.SS1.p1.13.m13.1.1.cmml">…</mi><mo id="S2.SS1.p1.13.m13.3.3.1.1.1.3.2.2" stretchy="false" xref="S2.SS1.p1.13.m13.3.3.1.1.1.3.1.1.cmml">‖</mo></mrow><mo id="S2.SS1.p1.13.m13.3.3.1.1.1.1a" xref="S2.SS1.p1.13.m13.3.3.1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.p1.13.m13.3.3.1.1.1.4" xref="S2.SS1.p1.13.m13.3.3.1.1.1.4.cmml"><mi id="S2.SS1.p1.13.m13.3.3.1.1.1.4.2" xref="S2.SS1.p1.13.m13.3.3.1.1.1.4.2.cmml">𝒆</mi><mi id="S2.SS1.p1.13.m13.3.3.1.1.1.4.3" xref="S2.SS1.p1.13.m13.3.3.1.1.1.4.3.cmml">m</mi></msub><mo id="S2.SS1.p1.13.m13.3.3.1.1.1.1b" xref="S2.SS1.p1.13.m13.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S2.SS1.p1.13.m13.3.3.1.1.1.5.2" xref="S2.SS1.p1.13.m13.3.3.1.1.1.5.1.cmml"><mo id="S2.SS1.p1.13.m13.3.3.1.1.1.5.2.1" stretchy="false" xref="S2.SS1.p1.13.m13.3.3.1.1.1.5.1.1.cmml">‖</mo><mi id="S2.SS1.p1.13.m13.2.2" mathvariant="normal" xref="S2.SS1.p1.13.m13.2.2.cmml">…</mi><mo id="S2.SS1.p1.13.m13.3.3.1.1.1.5.2.2" stretchy="false" xref="S2.SS1.p1.13.m13.3.3.1.1.1.5.1.1.cmml">‖</mo></mrow><mo id="S2.SS1.p1.13.m13.3.3.1.1.1.1c" xref="S2.SS1.p1.13.m13.3.3.1.1.1.1.cmml">⁢</mo><msub id="S2.SS1.p1.13.m13.3.3.1.1.1.6" xref="S2.SS1.p1.13.m13.3.3.1.1.1.6.cmml"><mi id="S2.SS1.p1.13.m13.3.3.1.1.1.6.2" xref="S2.SS1.p1.13.m13.3.3.1.1.1.6.2.cmml">𝒆</mi><mi id="S2.SS1.p1.13.m13.3.3.1.1.1.6.3" xref="S2.SS1.p1.13.m13.3.3.1.1.1.6.3.cmml">M</mi></msub></mrow><mo id="S2.SS1.p1.13.m13.3.3.1.1.3" stretchy="false" xref="S2.SS1.p1.13.m13.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.3b"><apply id="S2.SS1.p1.13.m13.3.3.cmml" xref="S2.SS1.p1.13.m13.3.3"><eq id="S2.SS1.p1.13.m13.3.3.2.cmml" xref="S2.SS1.p1.13.m13.3.3.2"></eq><ci id="S2.SS1.p1.13.m13.3.3.3.cmml" xref="S2.SS1.p1.13.m13.3.3.3">𝒆</ci><apply id="S2.SS1.p1.13.m13.3.3.1.2.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1"><csymbol cd="latexml" id="S2.SS1.p1.13.m13.3.3.1.2.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p1.13.m13.3.3.1.1.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1"><times id="S2.SS1.p1.13.m13.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.1"></times><apply id="S2.SS1.p1.13.m13.3.3.1.1.1.2.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.3.3.1.1.1.2.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.13.m13.3.3.1.1.1.2.2.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.2.2">𝒆</ci><cn id="S2.SS1.p1.13.m13.3.3.1.1.1.2.3.cmml" type="integer" xref="S2.SS1.p1.13.m13.3.3.1.1.1.2.3">1</cn></apply><apply id="S2.SS1.p1.13.m13.3.3.1.1.1.3.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.3.2"><csymbol cd="latexml" id="S2.SS1.p1.13.m13.3.3.1.1.1.3.1.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.3.2.1">norm</csymbol><ci id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">…</ci></apply><apply id="S2.SS1.p1.13.m13.3.3.1.1.1.4.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.3.3.1.1.1.4.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.13.m13.3.3.1.1.1.4.2.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.4.2">𝒆</ci><ci id="S2.SS1.p1.13.m13.3.3.1.1.1.4.3.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.4.3">𝑚</ci></apply><apply id="S2.SS1.p1.13.m13.3.3.1.1.1.5.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.5.2"><csymbol cd="latexml" id="S2.SS1.p1.13.m13.3.3.1.1.1.5.1.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.5.2.1">norm</csymbol><ci id="S2.SS1.p1.13.m13.2.2.cmml" xref="S2.SS1.p1.13.m13.2.2">…</ci></apply><apply id="S2.SS1.p1.13.m13.3.3.1.1.1.6.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.6"><csymbol cd="ambiguous" id="S2.SS1.p1.13.m13.3.3.1.1.1.6.1.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.6">subscript</csymbol><ci id="S2.SS1.p1.13.m13.3.3.1.1.1.6.2.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.6.2">𝒆</ci><ci id="S2.SS1.p1.13.m13.3.3.1.1.1.6.3.cmml" xref="S2.SS1.p1.13.m13.3.3.1.1.1.6.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.3c">\bm{e}=[\bm{e}_{1}\|\ldots\|\bm{e}_{m}\|\ldots\|\bm{e}_{M}]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.13.m13.3d">bold_italic_e = [ bold_italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ∥ … ∥ bold_italic_e start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∥ … ∥ bold_italic_e start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ]</annotation></semantics></math> through an embedding layer where <math alttext="\|" class="ltx_Math" display="inline" id="S2.SS1.p1.14.m14.1"><semantics id="S2.SS1.p1.14.m14.1a"><mo id="S2.SS1.p1.14.m14.1.1" xref="S2.SS1.p1.14.m14.1.1.cmml">∥</mo><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.14.m14.1b"><ci id="S2.SS1.p1.14.m14.1.1.cmml" xref="S2.SS1.p1.14.m14.1.1">∥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.14.m14.1c">\|</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.14.m14.1d">∥</annotation></semantics></math> denotes the concatenation operation. For the <math alttext="m" class="ltx_Math" display="inline" id="S2.SS1.p1.15.m15.1"><semantics id="S2.SS1.p1.15.m15.1a"><mi id="S2.SS1.p1.15.m15.1.1" xref="S2.SS1.p1.15.m15.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.15.m15.1b"><ci id="S2.SS1.p1.15.m15.1.1.cmml" xref="S2.SS1.p1.15.m15.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.15.m15.1c">m</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.15.m15.1d">italic_m</annotation></semantics></math>-th feature, we calculate <math alttext="\bm{e}_{m}" class="ltx_Math" display="inline" id="S2.SS1.p1.16.m16.1"><semantics id="S2.SS1.p1.16.m16.1a"><msub id="S2.SS1.p1.16.m16.1.1" xref="S2.SS1.p1.16.m16.1.1.cmml"><mi id="S2.SS1.p1.16.m16.1.1.2" xref="S2.SS1.p1.16.m16.1.1.2.cmml">𝒆</mi><mi id="S2.SS1.p1.16.m16.1.1.3" xref="S2.SS1.p1.16.m16.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.16.m16.1b"><apply id="S2.SS1.p1.16.m16.1.1.cmml" xref="S2.SS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.16.m16.1.1.1.cmml" xref="S2.SS1.p1.16.m16.1.1">subscript</csymbol><ci id="S2.SS1.p1.16.m16.1.1.2.cmml" xref="S2.SS1.p1.16.m16.1.1.2">𝒆</ci><ci id="S2.SS1.p1.16.m16.1.1.3.cmml" xref="S2.SS1.p1.16.m16.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.16.m16.1c">\bm{e}_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.16.m16.1d">bold_italic_e start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> through a look-up operation <math alttext="\bm{e}_{m}=\bm{E}_{m}\cdot\bm{x}_{m}" class="ltx_Math" display="inline" id="S2.SS1.p1.17.m17.1"><semantics id="S2.SS1.p1.17.m17.1a"><mrow id="S2.SS1.p1.17.m17.1.1" xref="S2.SS1.p1.17.m17.1.1.cmml"><msub id="S2.SS1.p1.17.m17.1.1.2" xref="S2.SS1.p1.17.m17.1.1.2.cmml"><mi id="S2.SS1.p1.17.m17.1.1.2.2" xref="S2.SS1.p1.17.m17.1.1.2.2.cmml">𝒆</mi><mi id="S2.SS1.p1.17.m17.1.1.2.3" xref="S2.SS1.p1.17.m17.1.1.2.3.cmml">m</mi></msub><mo id="S2.SS1.p1.17.m17.1.1.1" xref="S2.SS1.p1.17.m17.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.17.m17.1.1.3" xref="S2.SS1.p1.17.m17.1.1.3.cmml"><msub id="S2.SS1.p1.17.m17.1.1.3.2" xref="S2.SS1.p1.17.m17.1.1.3.2.cmml"><mi id="S2.SS1.p1.17.m17.1.1.3.2.2" xref="S2.SS1.p1.17.m17.1.1.3.2.2.cmml">𝑬</mi><mi id="S2.SS1.p1.17.m17.1.1.3.2.3" xref="S2.SS1.p1.17.m17.1.1.3.2.3.cmml">m</mi></msub><mo id="S2.SS1.p1.17.m17.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.17.m17.1.1.3.1.cmml">⋅</mo><msub id="S2.SS1.p1.17.m17.1.1.3.3" xref="S2.SS1.p1.17.m17.1.1.3.3.cmml"><mi id="S2.SS1.p1.17.m17.1.1.3.3.2" xref="S2.SS1.p1.17.m17.1.1.3.3.2.cmml">𝒙</mi><mi id="S2.SS1.p1.17.m17.1.1.3.3.3" xref="S2.SS1.p1.17.m17.1.1.3.3.3.cmml">m</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.17.m17.1b"><apply id="S2.SS1.p1.17.m17.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1"><eq id="S2.SS1.p1.17.m17.1.1.1.cmml" xref="S2.SS1.p1.17.m17.1.1.1"></eq><apply id="S2.SS1.p1.17.m17.1.1.2.cmml" xref="S2.SS1.p1.17.m17.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.17.m17.1.1.2.1.cmml" xref="S2.SS1.p1.17.m17.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.17.m17.1.1.2.2.cmml" xref="S2.SS1.p1.17.m17.1.1.2.2">𝒆</ci><ci id="S2.SS1.p1.17.m17.1.1.2.3.cmml" xref="S2.SS1.p1.17.m17.1.1.2.3">𝑚</ci></apply><apply id="S2.SS1.p1.17.m17.1.1.3.cmml" xref="S2.SS1.p1.17.m17.1.1.3"><ci id="S2.SS1.p1.17.m17.1.1.3.1.cmml" xref="S2.SS1.p1.17.m17.1.1.3.1">⋅</ci><apply id="S2.SS1.p1.17.m17.1.1.3.2.cmml" xref="S2.SS1.p1.17.m17.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.17.m17.1.1.3.2.1.cmml" xref="S2.SS1.p1.17.m17.1.1.3.2">subscript</csymbol><ci id="S2.SS1.p1.17.m17.1.1.3.2.2.cmml" xref="S2.SS1.p1.17.m17.1.1.3.2.2">𝑬</ci><ci id="S2.SS1.p1.17.m17.1.1.3.2.3.cmml" xref="S2.SS1.p1.17.m17.1.1.3.2.3">𝑚</ci></apply><apply id="S2.SS1.p1.17.m17.1.1.3.3.cmml" xref="S2.SS1.p1.17.m17.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.17.m17.1.1.3.3.1.cmml" xref="S2.SS1.p1.17.m17.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p1.17.m17.1.1.3.3.2.cmml" xref="S2.SS1.p1.17.m17.1.1.3.3.2">𝒙</ci><ci id="S2.SS1.p1.17.m17.1.1.3.3.3.cmml" xref="S2.SS1.p1.17.m17.1.1.3.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.17.m17.1c">\bm{e}_{m}=\bm{E}_{m}\cdot\bm{x}_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.17.m17.1d">bold_italic_e start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = bold_italic_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ⋅ bold_italic_x start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> in which <math alttext="\bm{E}_{m}\in\mathbb{R}^{u_{m}\times Dim}" class="ltx_Math" display="inline" id="S2.SS1.p1.18.m18.1"><semantics id="S2.SS1.p1.18.m18.1a"><mrow id="S2.SS1.p1.18.m18.1.1" xref="S2.SS1.p1.18.m18.1.1.cmml"><msub id="S2.SS1.p1.18.m18.1.1.2" xref="S2.SS1.p1.18.m18.1.1.2.cmml"><mi id="S2.SS1.p1.18.m18.1.1.2.2" xref="S2.SS1.p1.18.m18.1.1.2.2.cmml">𝑬</mi><mi id="S2.SS1.p1.18.m18.1.1.2.3" xref="S2.SS1.p1.18.m18.1.1.2.3.cmml">m</mi></msub><mo id="S2.SS1.p1.18.m18.1.1.1" xref="S2.SS1.p1.18.m18.1.1.1.cmml">∈</mo><msup id="S2.SS1.p1.18.m18.1.1.3" xref="S2.SS1.p1.18.m18.1.1.3.cmml"><mi id="S2.SS1.p1.18.m18.1.1.3.2" xref="S2.SS1.p1.18.m18.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS1.p1.18.m18.1.1.3.3" xref="S2.SS1.p1.18.m18.1.1.3.3.cmml"><mrow id="S2.SS1.p1.18.m18.1.1.3.3.2" xref="S2.SS1.p1.18.m18.1.1.3.3.2.cmml"><msub id="S2.SS1.p1.18.m18.1.1.3.3.2.2" xref="S2.SS1.p1.18.m18.1.1.3.3.2.2.cmml"><mi id="S2.SS1.p1.18.m18.1.1.3.3.2.2.2" xref="S2.SS1.p1.18.m18.1.1.3.3.2.2.2.cmml">u</mi><mi id="S2.SS1.p1.18.m18.1.1.3.3.2.2.3" xref="S2.SS1.p1.18.m18.1.1.3.3.2.2.3.cmml">m</mi></msub><mo id="S2.SS1.p1.18.m18.1.1.3.3.2.1" lspace="0.222em" rspace="0.222em" xref="S2.SS1.p1.18.m18.1.1.3.3.2.1.cmml">×</mo><mi id="S2.SS1.p1.18.m18.1.1.3.3.2.3" xref="S2.SS1.p1.18.m18.1.1.3.3.2.3.cmml">D</mi></mrow><mo id="S2.SS1.p1.18.m18.1.1.3.3.1" xref="S2.SS1.p1.18.m18.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.18.m18.1.1.3.3.3" xref="S2.SS1.p1.18.m18.1.1.3.3.3.cmml">i</mi><mo id="S2.SS1.p1.18.m18.1.1.3.3.1a" xref="S2.SS1.p1.18.m18.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.18.m18.1.1.3.3.4" xref="S2.SS1.p1.18.m18.1.1.3.3.4.cmml">m</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.18.m18.1b"><apply id="S2.SS1.p1.18.m18.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1"><in id="S2.SS1.p1.18.m18.1.1.1.cmml" xref="S2.SS1.p1.18.m18.1.1.1"></in><apply id="S2.SS1.p1.18.m18.1.1.2.cmml" xref="S2.SS1.p1.18.m18.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.1.1.2.1.cmml" xref="S2.SS1.p1.18.m18.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.18.m18.1.1.2.2.cmml" xref="S2.SS1.p1.18.m18.1.1.2.2">𝑬</ci><ci id="S2.SS1.p1.18.m18.1.1.2.3.cmml" xref="S2.SS1.p1.18.m18.1.1.2.3">𝑚</ci></apply><apply id="S2.SS1.p1.18.m18.1.1.3.cmml" xref="S2.SS1.p1.18.m18.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.1.1.3.1.cmml" xref="S2.SS1.p1.18.m18.1.1.3">superscript</csymbol><ci id="S2.SS1.p1.18.m18.1.1.3.2.cmml" xref="S2.SS1.p1.18.m18.1.1.3.2">ℝ</ci><apply id="S2.SS1.p1.18.m18.1.1.3.3.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3"><times id="S2.SS1.p1.18.m18.1.1.3.3.1.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.1"></times><apply id="S2.SS1.p1.18.m18.1.1.3.3.2.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.2"><times id="S2.SS1.p1.18.m18.1.1.3.3.2.1.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.2.1"></times><apply id="S2.SS1.p1.18.m18.1.1.3.3.2.2.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.18.m18.1.1.3.3.2.2.1.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.18.m18.1.1.3.3.2.2.2.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.2.2.2">𝑢</ci><ci id="S2.SS1.p1.18.m18.1.1.3.3.2.2.3.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.2.2.3">𝑚</ci></apply><ci id="S2.SS1.p1.18.m18.1.1.3.3.2.3.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.2.3">𝐷</ci></apply><ci id="S2.SS1.p1.18.m18.1.1.3.3.3.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.3">𝑖</ci><ci id="S2.SS1.p1.18.m18.1.1.3.3.4.cmml" xref="S2.SS1.p1.18.m18.1.1.3.3.4">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.18.m18.1c">\bm{E}_{m}\in\mathbb{R}^{u_{m}\times Dim}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.18.m18.1d">bold_italic_E start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_u start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT × italic_D italic_i italic_m end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the embedding table, <math alttext="u_{m}" class="ltx_Math" display="inline" id="S2.SS1.p1.19.m19.1"><semantics id="S2.SS1.p1.19.m19.1a"><msub id="S2.SS1.p1.19.m19.1.1" xref="S2.SS1.p1.19.m19.1.1.cmml"><mi id="S2.SS1.p1.19.m19.1.1.2" xref="S2.SS1.p1.19.m19.1.1.2.cmml">u</mi><mi id="S2.SS1.p1.19.m19.1.1.3" xref="S2.SS1.p1.19.m19.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.19.m19.1b"><apply id="S2.SS1.p1.19.m19.1.1.cmml" xref="S2.SS1.p1.19.m19.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.19.m19.1.1.1.cmml" xref="S2.SS1.p1.19.m19.1.1">subscript</csymbol><ci id="S2.SS1.p1.19.m19.1.1.2.cmml" xref="S2.SS1.p1.19.m19.1.1.2">𝑢</ci><ci id="S2.SS1.p1.19.m19.1.1.3.cmml" xref="S2.SS1.p1.19.m19.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.19.m19.1c">u_{m}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.19.m19.1d">italic_u start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> denotes the value counts of feature, and <math alttext="Dim" class="ltx_Math" display="inline" id="S2.SS1.p1.20.m20.1"><semantics id="S2.SS1.p1.20.m20.1a"><mrow id="S2.SS1.p1.20.m20.1.1" xref="S2.SS1.p1.20.m20.1.1.cmml"><mi id="S2.SS1.p1.20.m20.1.1.2" xref="S2.SS1.p1.20.m20.1.1.2.cmml">D</mi><mo id="S2.SS1.p1.20.m20.1.1.1" xref="S2.SS1.p1.20.m20.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p1.20.m20.1.1.3" xref="S2.SS1.p1.20.m20.1.1.3.cmml">i</mi><mo id="S2.SS1.p1.20.m20.1.1.1a" xref="S2.SS1.p1.20.m20.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p1.20.m20.1.1.4" xref="S2.SS1.p1.20.m20.1.1.4.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.20.m20.1b"><apply id="S2.SS1.p1.20.m20.1.1.cmml" xref="S2.SS1.p1.20.m20.1.1"><times id="S2.SS1.p1.20.m20.1.1.1.cmml" xref="S2.SS1.p1.20.m20.1.1.1"></times><ci id="S2.SS1.p1.20.m20.1.1.2.cmml" xref="S2.SS1.p1.20.m20.1.1.2">𝐷</ci><ci id="S2.SS1.p1.20.m20.1.1.3.cmml" xref="S2.SS1.p1.20.m20.1.1.3">𝑖</ci><ci id="S2.SS1.p1.20.m20.1.1.4.cmml" xref="S2.SS1.p1.20.m20.1.1.4">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.20.m20.1c">Dim</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.20.m20.1d">italic_D italic_i italic_m</annotation></semantics></math> is the embedding size. Finally, the prediction result <math alttext="\hat{y}" class="ltx_Math" display="inline" id="S2.SS1.p1.21.m21.1"><semantics id="S2.SS1.p1.21.m21.1a"><mover accent="true" id="S2.SS1.p1.21.m21.1.1" xref="S2.SS1.p1.21.m21.1.1.cmml"><mi id="S2.SS1.p1.21.m21.1.1.2" xref="S2.SS1.p1.21.m21.1.1.2.cmml">y</mi><mo id="S2.SS1.p1.21.m21.1.1.1" xref="S2.SS1.p1.21.m21.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.21.m21.1b"><apply id="S2.SS1.p1.21.m21.1.1.cmml" xref="S2.SS1.p1.21.m21.1.1"><ci id="S2.SS1.p1.21.m21.1.1.1.cmml" xref="S2.SS1.p1.21.m21.1.1.1">^</ci><ci id="S2.SS1.p1.21.m21.1.1.2.cmml" xref="S2.SS1.p1.21.m21.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.21.m21.1c">\hat{y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.21.m21.1d">over^ start_ARG italic_y end_ARG</annotation></semantics></math> is obtained via <math alttext="\hat{y}=f_{d}(\bm{e})" class="ltx_Math" display="inline" id="S2.SS1.p1.22.m22.1"><semantics id="S2.SS1.p1.22.m22.1a"><mrow id="S2.SS1.p1.22.m22.1.2" xref="S2.SS1.p1.22.m22.1.2.cmml"><mover accent="true" id="S2.SS1.p1.22.m22.1.2.2" xref="S2.SS1.p1.22.m22.1.2.2.cmml"><mi id="S2.SS1.p1.22.m22.1.2.2.2" xref="S2.SS1.p1.22.m22.1.2.2.2.cmml">y</mi><mo id="S2.SS1.p1.22.m22.1.2.2.1" xref="S2.SS1.p1.22.m22.1.2.2.1.cmml">^</mo></mover><mo id="S2.SS1.p1.22.m22.1.2.1" xref="S2.SS1.p1.22.m22.1.2.1.cmml">=</mo><mrow id="S2.SS1.p1.22.m22.1.2.3" xref="S2.SS1.p1.22.m22.1.2.3.cmml"><msub id="S2.SS1.p1.22.m22.1.2.3.2" xref="S2.SS1.p1.22.m22.1.2.3.2.cmml"><mi id="S2.SS1.p1.22.m22.1.2.3.2.2" xref="S2.SS1.p1.22.m22.1.2.3.2.2.cmml">f</mi><mi id="S2.SS1.p1.22.m22.1.2.3.2.3" xref="S2.SS1.p1.22.m22.1.2.3.2.3.cmml">d</mi></msub><mo id="S2.SS1.p1.22.m22.1.2.3.1" xref="S2.SS1.p1.22.m22.1.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.p1.22.m22.1.2.3.3.2" xref="S2.SS1.p1.22.m22.1.2.3.cmml"><mo id="S2.SS1.p1.22.m22.1.2.3.3.2.1" stretchy="false" xref="S2.SS1.p1.22.m22.1.2.3.cmml">(</mo><mi id="S2.SS1.p1.22.m22.1.1" xref="S2.SS1.p1.22.m22.1.1.cmml">𝒆</mi><mo id="S2.SS1.p1.22.m22.1.2.3.3.2.2" stretchy="false" xref="S2.SS1.p1.22.m22.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.22.m22.1b"><apply id="S2.SS1.p1.22.m22.1.2.cmml" xref="S2.SS1.p1.22.m22.1.2"><eq id="S2.SS1.p1.22.m22.1.2.1.cmml" xref="S2.SS1.p1.22.m22.1.2.1"></eq><apply id="S2.SS1.p1.22.m22.1.2.2.cmml" xref="S2.SS1.p1.22.m22.1.2.2"><ci id="S2.SS1.p1.22.m22.1.2.2.1.cmml" xref="S2.SS1.p1.22.m22.1.2.2.1">^</ci><ci id="S2.SS1.p1.22.m22.1.2.2.2.cmml" xref="S2.SS1.p1.22.m22.1.2.2.2">𝑦</ci></apply><apply id="S2.SS1.p1.22.m22.1.2.3.cmml" xref="S2.SS1.p1.22.m22.1.2.3"><times id="S2.SS1.p1.22.m22.1.2.3.1.cmml" xref="S2.SS1.p1.22.m22.1.2.3.1"></times><apply id="S2.SS1.p1.22.m22.1.2.3.2.cmml" xref="S2.SS1.p1.22.m22.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.p1.22.m22.1.2.3.2.1.cmml" xref="S2.SS1.p1.22.m22.1.2.3.2">subscript</csymbol><ci id="S2.SS1.p1.22.m22.1.2.3.2.2.cmml" xref="S2.SS1.p1.22.m22.1.2.3.2.2">𝑓</ci><ci id="S2.SS1.p1.22.m22.1.2.3.2.3.cmml" xref="S2.SS1.p1.22.m22.1.2.3.2.3">𝑑</ci></apply><ci id="S2.SS1.p1.22.m22.1.1.cmml" xref="S2.SS1.p1.22.m22.1.1">𝒆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.22.m22.1c">\hat{y}=f_{d}(\bm{e})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.22.m22.1d">over^ start_ARG italic_y end_ARG = italic_f start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ( bold_italic_e )</annotation></semantics></math> where <math alttext="f_{d}" class="ltx_Math" display="inline" id="S2.SS1.p1.23.m23.1"><semantics id="S2.SS1.p1.23.m23.1a"><msub id="S2.SS1.p1.23.m23.1.1" xref="S2.SS1.p1.23.m23.1.1.cmml"><mi id="S2.SS1.p1.23.m23.1.1.2" xref="S2.SS1.p1.23.m23.1.1.2.cmml">f</mi><mi id="S2.SS1.p1.23.m23.1.1.3" xref="S2.SS1.p1.23.m23.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.23.m23.1b"><apply id="S2.SS1.p1.23.m23.1.1.cmml" xref="S2.SS1.p1.23.m23.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.23.m23.1.1.1.cmml" xref="S2.SS1.p1.23.m23.1.1">subscript</csymbol><ci id="S2.SS1.p1.23.m23.1.1.2.cmml" xref="S2.SS1.p1.23.m23.1.1.2">𝑓</ci><ci id="S2.SS1.p1.23.m23.1.1.3.cmml" xref="S2.SS1.p1.23.m23.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.23.m23.1c">f_{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.23.m23.1d">italic_f start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> represents the recommendation model applied to the <math alttext="d" class="ltx_Math" display="inline" id="S2.SS1.p1.24.m24.1"><semantics id="S2.SS1.p1.24.m24.1a"><mi id="S2.SS1.p1.24.m24.1.1" xref="S2.SS1.p1.24.m24.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.24.m24.1b"><ci id="S2.SS1.p1.24.m24.1.1.cmml" xref="S2.SS1.p1.24.m24.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.24.m24.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.24.m24.1d">italic_d</annotation></semantics></math>-th scenario. The loss function is binary cross entropy loss or the so-called Logloss <cite class="ltx_cite ltx_citemacro_citep">(Berkson, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib2" title="">1944</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{\Theta}{\min}\mathcal{L}=-\frac{1}{B}\sum_{i=1}^{B}y_{i}\log\left(%
\hat{y}_{i}\right)+\left(1-y_{i}\right)\log\left(1-\hat{y}_{i}\right)," class="ltx_Math" display="block" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.5" xref="S2.E1.m1.3.3.1.1.5.cmml"><munder accentunder="true" id="S2.E1.m1.3.3.1.1.5.2" xref="S2.E1.m1.3.3.1.1.5.2.cmml"><mi id="S2.E1.m1.3.3.1.1.5.2.2" xref="S2.E1.m1.3.3.1.1.5.2.2.cmml">min</mi><mo id="S2.E1.m1.3.3.1.1.5.2.1" xref="S2.E1.m1.3.3.1.1.5.2.1.cmml">Θ</mo></munder><mo id="S2.E1.m1.3.3.1.1.5.1" lspace="0.167em" xref="S2.E1.m1.3.3.1.1.5.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.5.3" xref="S2.E1.m1.3.3.1.1.5.3.cmml">ℒ</mi></mrow><mo id="S2.E1.m1.3.3.1.1.4" xref="S2.E1.m1.3.3.1.1.4.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml"><mrow id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1a" xref="S2.E1.m1.3.3.1.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.cmml"><mfrac id="S2.E1.m1.3.3.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.3.cmml"><mn id="S2.E1.m1.3.3.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.3.2.cmml">1</mn><mi id="S2.E1.m1.3.3.1.1.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.3.3.cmml">B</mi></mfrac><mo id="S2.E1.m1.3.3.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.cmml"><munderover id="S2.E1.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml">B</mi></munderover><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2" lspace="0.167em" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">log</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1a" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.3.4" xref="S2.E1.m1.3.3.1.1.3.4.cmml">+</mo><mrow id="S2.E1.m1.3.3.1.1.3.3" xref="S2.E1.m1.3.3.1.1.3.3.cmml"><mrow id="S2.E1.m1.3.3.1.1.2.2.1.1" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.2.2.1.1.2" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.1.1.1" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.cmml"><mn id="S2.E1.m1.3.3.1.1.2.2.1.1.1.2" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S2.E1.m1.3.3.1.1.2.2.1.1.1.1" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="S2.E1.m1.3.3.1.1.2.2.1.1.1.3" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.2.cmml">y</mi><mi id="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.E1.m1.3.3.1.1.2.2.1.1.3" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.cmml">)</mo></mrow><mo id="S2.E1.m1.3.3.1.1.3.3.3" lspace="0.167em" xref="S2.E1.m1.3.3.1.1.3.3.3.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.3.3.2.1" xref="S2.E1.m1.3.3.1.1.3.3.2.2.cmml"><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">log</mi><mo id="S2.E1.m1.3.3.1.1.3.3.2.1a" xref="S2.E1.m1.3.3.1.1.3.3.2.2.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.1.1.3.3.2.1.1" xref="S2.E1.m1.3.3.1.1.3.3.2.2.cmml"><mo id="S2.E1.m1.3.3.1.1.3.3.2.1.1.2" xref="S2.E1.m1.3.3.1.1.3.3.2.2.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.cmml"><mn id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.2" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.2.cmml">1</mn><mo id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.1" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.1.cmml">−</mo><msub id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.cmml"><mover accent="true" id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.2.cmml">y</mi><mo id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.1" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S2.E1.m1.3.3.1.1.3.3.2.1.1.3" xref="S2.E1.m1.3.3.1.1.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.4.cmml" xref="S2.E1.m1.3.3.1.1.4"></eq><apply id="S2.E1.m1.3.3.1.1.5.cmml" xref="S2.E1.m1.3.3.1.1.5"><times id="S2.E1.m1.3.3.1.1.5.1.cmml" xref="S2.E1.m1.3.3.1.1.5.1"></times><apply id="S2.E1.m1.3.3.1.1.5.2.cmml" xref="S2.E1.m1.3.3.1.1.5.2"><ci id="S2.E1.m1.3.3.1.1.5.2.1.cmml" xref="S2.E1.m1.3.3.1.1.5.2.1">Θ</ci><min id="S2.E1.m1.3.3.1.1.5.2.2.cmml" xref="S2.E1.m1.3.3.1.1.5.2.2"></min></apply><ci id="S2.E1.m1.3.3.1.1.5.3.cmml" xref="S2.E1.m1.3.3.1.1.5.3">ℒ</ci></apply><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"><plus id="S2.E1.m1.3.3.1.1.3.4.cmml" xref="S2.E1.m1.3.3.1.1.3.4"></plus><apply id="S2.E1.m1.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1"><minus id="S2.E1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1"></minus><apply id="S2.E1.m1.3.3.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.2"></times><apply id="S2.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.3"><divide id="S2.E1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.3"></divide><cn id="S2.E1.m1.3.3.1.1.1.1.1.3.2.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.1.1.1.3.2">1</cn><ci id="S2.E1.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.3.3">𝐵</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1"><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3"><eq id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.2.3">𝐵</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><log id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"></log><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3"><times id="S2.E1.m1.3.3.1.1.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.3"></times><apply id="S2.E1.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1.1"><minus id="S2.E1.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.1"></minus><cn id="S2.E1.m1.3.3.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.2">1</cn><apply id="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.2">𝑦</ci><ci id="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.3.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1"><log id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"></log><apply id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1"><minus id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.1"></minus><cn id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.2.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.2">1</cn><apply id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3">subscript</csymbol><apply id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2"><ci id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.1">^</ci><ci id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.2.2">𝑦</ci></apply><ci id="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\underset{\Theta}{\min}\mathcal{L}=-\frac{1}{B}\sum_{i=1}^{B}y_{i}\log\left(%
\hat{y}_{i}\right)+\left(1-y_{i}\right)\log\left(1-\hat{y}_{i}\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">underroman_Θ start_ARG roman_min end_ARG caligraphic_L = - divide start_ARG 1 end_ARG start_ARG italic_B end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log ( 1 - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.29">where <math alttext="\Theta" class="ltx_Math" display="inline" id="S2.SS1.p1.25.m1.1"><semantics id="S2.SS1.p1.25.m1.1a"><mi id="S2.SS1.p1.25.m1.1.1" mathvariant="normal" xref="S2.SS1.p1.25.m1.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.25.m1.1b"><ci id="S2.SS1.p1.25.m1.1.1.cmml" xref="S2.SS1.p1.25.m1.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.25.m1.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.25.m1.1d">roman_Θ</annotation></semantics></math> is the set of parameters learned, <math alttext="B" class="ltx_Math" display="inline" id="S2.SS1.p1.26.m2.1"><semantics id="S2.SS1.p1.26.m2.1a"><mi id="S2.SS1.p1.26.m2.1.1" xref="S2.SS1.p1.26.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.26.m2.1b"><ci id="S2.SS1.p1.26.m2.1.1.cmml" xref="S2.SS1.p1.26.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.26.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.26.m2.1d">italic_B</annotation></semantics></math> represents the number of batch samples, and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.27.m3.1"><semantics id="S2.SS1.p1.27.m3.1a"><msub id="S2.SS1.p1.27.m3.1.1" xref="S2.SS1.p1.27.m3.1.1.cmml"><mi id="S2.SS1.p1.27.m3.1.1.2" xref="S2.SS1.p1.27.m3.1.1.2.cmml">y</mi><mi id="S2.SS1.p1.27.m3.1.1.3" xref="S2.SS1.p1.27.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.27.m3.1b"><apply id="S2.SS1.p1.27.m3.1.1.cmml" xref="S2.SS1.p1.27.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.27.m3.1.1.1.cmml" xref="S2.SS1.p1.27.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.27.m3.1.1.2.cmml" xref="S2.SS1.p1.27.m3.1.1.2">𝑦</ci><ci id="S2.SS1.p1.27.m3.1.1.3.cmml" xref="S2.SS1.p1.27.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.27.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.27.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\hat{y}_{i}" class="ltx_Math" display="inline" id="S2.SS1.p1.28.m4.1"><semantics id="S2.SS1.p1.28.m4.1a"><msub id="S2.SS1.p1.28.m4.1.1" xref="S2.SS1.p1.28.m4.1.1.cmml"><mover accent="true" id="S2.SS1.p1.28.m4.1.1.2" xref="S2.SS1.p1.28.m4.1.1.2.cmml"><mi id="S2.SS1.p1.28.m4.1.1.2.2" xref="S2.SS1.p1.28.m4.1.1.2.2.cmml">y</mi><mo id="S2.SS1.p1.28.m4.1.1.2.1" xref="S2.SS1.p1.28.m4.1.1.2.1.cmml">^</mo></mover><mi id="S2.SS1.p1.28.m4.1.1.3" xref="S2.SS1.p1.28.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.28.m4.1b"><apply id="S2.SS1.p1.28.m4.1.1.cmml" xref="S2.SS1.p1.28.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.28.m4.1.1.1.cmml" xref="S2.SS1.p1.28.m4.1.1">subscript</csymbol><apply id="S2.SS1.p1.28.m4.1.1.2.cmml" xref="S2.SS1.p1.28.m4.1.1.2"><ci id="S2.SS1.p1.28.m4.1.1.2.1.cmml" xref="S2.SS1.p1.28.m4.1.1.2.1">^</ci><ci id="S2.SS1.p1.28.m4.1.1.2.2.cmml" xref="S2.SS1.p1.28.m4.1.1.2.2">𝑦</ci></apply><ci id="S2.SS1.p1.28.m4.1.1.3.cmml" xref="S2.SS1.p1.28.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.28.m4.1c">\hat{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.28.m4.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denote the true label and prediction of the <math alttext="i" class="ltx_Math" display="inline" id="S2.SS1.p1.29.m5.1"><semantics id="S2.SS1.p1.29.m5.1a"><mi id="S2.SS1.p1.29.m5.1.1" xref="S2.SS1.p1.29.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.29.m5.1b"><ci id="S2.SS1.p1.29.m5.1.1.cmml" xref="S2.SS1.p1.29.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.29.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.29.m5.1d">italic_i</annotation></semantics></math>-th sample, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Multi-Scenario Backbone Models</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.2">In the recommendation community, multi-task learning (MTL) technique is first developed targeting at leveraging a unified framework to learn the inter-related tasks like click and conversion, which would lead to mutual enhancement among tasks and higher efficiency <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib29" title="">2023a</a>)</cite>. Specifically, a mainstream solution is to design various parameter sharing mechanisms with shared and specific parameters in multi-task modeling.
Afterward, most multi-scenario recommendation models adopt a similar approach when modeling scenario correlations by simply regarding scenarios as tasks.
They model the commonality and distinction among scenarios through explicitly maintaining domain-shared parameters <math alttext="\Theta_{s}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" mathvariant="normal" xref="S2.SS2.p1.1.m1.1.1.2.cmml">Θ</mi><mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">Θ</ci><ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">\Theta_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">roman_Θ start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and domain-specific parameters <math alttext="\Theta_{u}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" mathvariant="normal" xref="S2.SS2.p1.2.m2.1.1.2.cmml">Θ</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">Θ</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">\Theta_{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.2.m2.1d">roman_Θ start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>.
As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.F1" title="Figure 1 ‣ 2.2. Multi-Scenario Backbone Models ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, the feature embedding is first fed into the shared parameters like the experts in MMoE <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib20" title="">2018</a>)</cite> and the centered network in STAR <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>)</cite> to extract common knowledge.
Then the scenario-specific parameters like gates <cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib25" title="">2020</a>)</cite> and towers are employed to generate the prediction result.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="115" id="S2.F1.g1" src="x1.png" width="319"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S2.F1.3.2" style="font-size:90%;">Demonstration of multi-scenario recommender system. The blue part represents shared parameters while red and yellow denote scenario-specific parameters.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Large Language Model</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.4">Unlike Pre-trained Language Models (PLMs) like BERT trained with masked language modeling task, most popular Large Language Models like GPT <cite class="ltx_cite ltx_citemacro_citep">(Brown et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib3" title="">2020</a>)</cite> and ChatGLM2 <cite class="ltx_cite ltx_citemacro_citep">(Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib10" title="">2022</a>)</cite> adopt the decoder-only architecture and they are trained with next token prediction objective in a self-supervised manner, i.e., a sequence of text is taken as input to predict the next token for each token in the sequence:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\theta}=-\sum_{i=1}^{N}\log P_{\theta}\left(\bm{u}_{i}~{}|~{}\bm{%
u}_{1},\dots,\bm{u}_{i-1}\right)" class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><msub id="S2.E2.m1.2.2.3" xref="S2.E2.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.2.2.3.2" xref="S2.E2.m1.2.2.3.2.cmml">ℒ</mi><mi id="S2.E2.m1.2.2.3.3" xref="S2.E2.m1.2.2.3.3.cmml">θ</mi></msub><mo id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1" xref="S2.E2.m1.2.2.1.cmml"><mo id="S2.E2.m1.2.2.1a" xref="S2.E2.m1.2.2.1.cmml">−</mo><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><munderover id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml"><mo id="S2.E2.m1.2.2.1.1.2.2.2" movablelimits="false" xref="S2.E2.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.2.2.1.1.2.2.3" xref="S2.E2.m1.2.2.1.1.2.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.2.2.3.2" xref="S2.E2.m1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E2.m1.2.2.1.1.2.2.3.1" xref="S2.E2.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.2.2.1.1.2.2.3.3" xref="S2.E2.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.2.2.1.1.2.3" xref="S2.E2.m1.2.2.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.3.1" xref="S2.E2.m1.2.2.1.1.1.3.1.cmml">log</mi><mo id="S2.E2.m1.2.2.1.1.1.3a" lspace="0.167em" xref="S2.E2.m1.2.2.1.1.1.3.cmml">⁡</mo><msub id="S2.E2.m1.2.2.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.1.3.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.3.2.2" xref="S2.E2.m1.2.2.1.1.1.3.2.2.cmml">P</mi><mi id="S2.E2.m1.2.2.1.1.1.3.2.3" xref="S2.E2.m1.2.2.1.1.1.3.2.3.cmml">θ</mi></msub></mrow><mo id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.1.1.1.1.4" xref="S2.E2.m1.2.2.1.1.1.1.1.1.4.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.4.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.4.2.cmml">𝒖</mi><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.4.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S2.E2.m1.2.2.1.1.1.1.1.1.3" rspace="0.608em" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝒖</mi><mn id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S2.E2.m1.1.1" mathvariant="normal" xref="S2.E2.m1.1.1.cmml">…</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.4" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml">𝒖</mi><mrow id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml">−</mo><mn id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><eq id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"></eq><apply id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.3.1.cmml" xref="S2.E2.m1.2.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.3.2.cmml" xref="S2.E2.m1.2.2.3.2">ℒ</ci><ci id="S2.E2.m1.2.2.3.3.cmml" xref="S2.E2.m1.2.2.3.3">𝜃</ci></apply><apply id="S2.E2.m1.2.2.1.cmml" xref="S2.E2.m1.2.2.1"><minus id="S2.E2.m1.2.2.1.2.cmml" xref="S2.E2.m1.2.2.1"></minus><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1.1"><apply id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2">superscript</csymbol><apply id="S2.E2.m1.2.2.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2">subscript</csymbol><sum id="S2.E2.m1.2.2.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2.2"></sum><apply id="S2.E2.m1.2.2.1.1.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.2.3"><eq id="S2.E2.m1.2.2.1.1.2.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.2.2.1.1.2.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2.3.2">𝑖</ci><cn id="S2.E2.m1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.2.2.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.3">𝑁</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2"></times><apply id="S2.E2.m1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3"><log id="S2.E2.m1.2.2.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.3.1"></log><apply id="S2.E2.m1.2.2.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.3.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.3.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.3.2.2">𝑃</ci><ci id="S2.E2.m1.2.2.1.1.1.3.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3.2.3">𝜃</ci></apply></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.4.2">𝒖</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.4.3">𝑖</ci></apply><list id="S2.E2.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2"><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝒖</ci><cn id="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.1.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">…</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.2">𝒖</ci><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3"><minus id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.1"></minus><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.2">𝑖</ci><cn id="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\mathcal{L}_{\theta}=-\sum_{i=1}^{N}\log P_{\theta}\left(\bm{u}_{i}~{}|~{}\bm{%
u}_{1},\dots,\bm{u}_{i-1}\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_log italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , bold_italic_u start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p1.3">where <math alttext="\bm{u}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">𝒖</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝒖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">\bm{u}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">bold_italic_u</annotation></semantics></math> is the input text with <math alttext="N" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">italic_N</annotation></semantics></math> tokens and <math alttext="\theta" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m3.1"><semantics id="S2.SS3.p1.3.m3.1a"><mi id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><ci id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m3.1d">italic_θ</annotation></semantics></math> is the parameters of LLM.
The probability distribution of future tokens conditioned on the previous ones are maximized, which is equivalent to minimizing the negative
log-likelihood above.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="287" id="S2.F2.g1" src="x2.png" width="704"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S2.F2.3.2" style="font-size:90%;">Overall framework of LLM4MSR. Different colors of solid arrows indicate different data flow. In multi-scenario knowledge reasoning step, an LLM captures scenario correlation and cross-scenario preferences from scenario- and user-level prompt without fine-tuning. In multi-level knowledge fusion step, two hierarchical meta networks, which adaptively generate scenario- and user-level meta layers in parallel and at bottom, are end-to-end trained with the multi-scenario backbone model.</span></figcaption>
</figure>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.4">Meanwhile, it adopts masked self-attention or the so-called causal self-attention preventing accessing future tokens, which enables to understand the text data and generate proper results.
Specifically, a query (Q), a key (K), and a value (V) vector are obtained multiplying the input token vector <math alttext="\bm{X}" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1"><semantics id="S2.SS3.p2.1.m1.1a"><mi id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><ci id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">\bm{X}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.m1.1d">bold_italic_X</annotation></semantics></math> by weight matrices <math alttext="\bm{W}^{Q}" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1"><semantics id="S2.SS3.p2.2.m2.1a"><msup id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml"><mi id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">𝑾</mi><mi id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">Q</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">𝑾</ci><ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">\bm{W}^{Q}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m2.1d">bold_italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="\bm{W}^{K}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1"><semantics id="S2.SS3.p2.3.m3.1a"><msup id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">𝑾</mi><mi id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">K</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2">𝑾</ci><ci id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">\bm{W}^{K}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m3.1d">bold_italic_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, and <math alttext="\bm{W}^{V}" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.1"><semantics id="S2.SS3.p2.4.m4.1a"><msup id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2" xref="S2.SS3.p2.4.m4.1.1.2.cmml">𝑾</mi><mi id="S2.SS3.p2.4.m4.1.1.3" xref="S2.SS3.p2.4.m4.1.1.3.cmml">V</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><apply id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">superscript</csymbol><ci id="S2.SS3.p2.4.m4.1.1.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2">𝑾</ci><ci id="S2.SS3.p2.4.m4.1.1.3.cmml" xref="S2.SS3.p2.4.m4.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">\bm{W}^{V}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m4.1d">bold_italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT</annotation></semantics></math>. Then a score is calculated multiplying the current query vector and key vector, which is further multiplied by the value vector and summed up:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\operatorname{Attenion}(\bm{X})=\bm{W}^{V}\bm{X}\cdot\operatorname{Softmax}%
\left[\frac{\left(\bm{W}^{K}\bm{X}\right)^{\top}\left(\bm{W}^{Q}\bm{X}\right)}%
{\sqrt{d_{k}}}+\bm{M}\right]" class="ltx_Math" display="block" id="S2.E3.m1.6"><semantics id="S2.E3.m1.6a"><mrow id="S2.E3.m1.6.6" xref="S2.E3.m1.6.6.cmml"><mrow id="S2.E3.m1.6.6.3.2" xref="S2.E3.m1.6.6.3.1.cmml"><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">Attenion</mi><mo id="S2.E3.m1.6.6.3.2a" xref="S2.E3.m1.6.6.3.1.cmml">⁡</mo><mrow id="S2.E3.m1.6.6.3.2.1" xref="S2.E3.m1.6.6.3.1.cmml"><mo id="S2.E3.m1.6.6.3.2.1.1" stretchy="false" xref="S2.E3.m1.6.6.3.1.cmml">(</mo><mi id="S2.E3.m1.4.4" xref="S2.E3.m1.4.4.cmml">𝑿</mi><mo id="S2.E3.m1.6.6.3.2.1.2" stretchy="false" xref="S2.E3.m1.6.6.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.6.6.2" xref="S2.E3.m1.6.6.2.cmml">=</mo><mrow id="S2.E3.m1.6.6.1" xref="S2.E3.m1.6.6.1.cmml"><mrow id="S2.E3.m1.6.6.1.3" xref="S2.E3.m1.6.6.1.3.cmml"><msup id="S2.E3.m1.6.6.1.3.2" xref="S2.E3.m1.6.6.1.3.2.cmml"><mi id="S2.E3.m1.6.6.1.3.2.2" xref="S2.E3.m1.6.6.1.3.2.2.cmml">𝑾</mi><mi id="S2.E3.m1.6.6.1.3.2.3" xref="S2.E3.m1.6.6.1.3.2.3.cmml">V</mi></msup><mo id="S2.E3.m1.6.6.1.3.1" xref="S2.E3.m1.6.6.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.6.6.1.3.3" xref="S2.E3.m1.6.6.1.3.3.cmml">𝑿</mi></mrow><mo id="S2.E3.m1.6.6.1.2" lspace="0.222em" rspace="0.222em" xref="S2.E3.m1.6.6.1.2.cmml">⋅</mo><mrow id="S2.E3.m1.6.6.1.1.1" xref="S2.E3.m1.6.6.1.1.2.cmml"><mi id="S2.E3.m1.5.5" xref="S2.E3.m1.5.5.cmml">Softmax</mi><mo id="S2.E3.m1.6.6.1.1.1a" xref="S2.E3.m1.6.6.1.1.2.cmml">⁡</mo><mrow id="S2.E3.m1.6.6.1.1.1.1" xref="S2.E3.m1.6.6.1.1.2.cmml"><mo id="S2.E3.m1.6.6.1.1.1.1.2" xref="S2.E3.m1.6.6.1.1.2.cmml">[</mo><mrow id="S2.E3.m1.6.6.1.1.1.1.1" xref="S2.E3.m1.6.6.1.1.1.1.1.cmml"><mfrac id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><msup id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.cmml"><msup id="S2.E3.m1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3.cmml">K</mi></msup><mo id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.3.cmml">𝑿</mi></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml">⊤</mo></msup><mo id="S2.E3.m1.2.2.2.3" xref="S2.E3.m1.2.2.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.2.2.1" xref="S2.E3.m1.2.2.2.2.1.1.cmml"><mo id="S2.E3.m1.2.2.2.2.1.2" xref="S2.E3.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.2.1.1" xref="S2.E3.m1.2.2.2.2.1.1.cmml"><msup id="S2.E3.m1.2.2.2.2.1.1.2" xref="S2.E3.m1.2.2.2.2.1.1.2.cmml"><mi id="S2.E3.m1.2.2.2.2.1.1.2.2" xref="S2.E3.m1.2.2.2.2.1.1.2.2.cmml">𝑾</mi><mi id="S2.E3.m1.2.2.2.2.1.1.2.3" xref="S2.E3.m1.2.2.2.2.1.1.2.3.cmml">Q</mi></msup><mo id="S2.E3.m1.2.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.2.1.1.1.cmml">⁢</mo><mi id="S2.E3.m1.2.2.2.2.1.1.3" xref="S2.E3.m1.2.2.2.2.1.1.3.cmml">𝑿</mi></mrow><mo id="S2.E3.m1.2.2.2.2.1.3" xref="S2.E3.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><msqrt id="S2.E3.m1.2.2.4" xref="S2.E3.m1.2.2.4.cmml"><msub id="S2.E3.m1.2.2.4.2" xref="S2.E3.m1.2.2.4.2.cmml"><mi id="S2.E3.m1.2.2.4.2.2" xref="S2.E3.m1.2.2.4.2.2.cmml">d</mi><mi id="S2.E3.m1.2.2.4.2.3" xref="S2.E3.m1.2.2.4.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S2.E3.m1.6.6.1.1.1.1.1.1" xref="S2.E3.m1.6.6.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E3.m1.6.6.1.1.1.1.1.2" xref="S2.E3.m1.6.6.1.1.1.1.1.2.cmml">𝑴</mi></mrow><mo id="S2.E3.m1.6.6.1.1.1.1.3" xref="S2.E3.m1.6.6.1.1.2.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.6b"><apply id="S2.E3.m1.6.6.cmml" xref="S2.E3.m1.6.6"><eq id="S2.E3.m1.6.6.2.cmml" xref="S2.E3.m1.6.6.2"></eq><apply id="S2.E3.m1.6.6.3.1.cmml" xref="S2.E3.m1.6.6.3.2"><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">Attenion</ci><ci id="S2.E3.m1.4.4.cmml" xref="S2.E3.m1.4.4">𝑿</ci></apply><apply id="S2.E3.m1.6.6.1.cmml" xref="S2.E3.m1.6.6.1"><ci id="S2.E3.m1.6.6.1.2.cmml" xref="S2.E3.m1.6.6.1.2">⋅</ci><apply id="S2.E3.m1.6.6.1.3.cmml" xref="S2.E3.m1.6.6.1.3"><times id="S2.E3.m1.6.6.1.3.1.cmml" xref="S2.E3.m1.6.6.1.3.1"></times><apply id="S2.E3.m1.6.6.1.3.2.cmml" xref="S2.E3.m1.6.6.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.6.6.1.3.2.1.cmml" xref="S2.E3.m1.6.6.1.3.2">superscript</csymbol><ci id="S2.E3.m1.6.6.1.3.2.2.cmml" xref="S2.E3.m1.6.6.1.3.2.2">𝑾</ci><ci id="S2.E3.m1.6.6.1.3.2.3.cmml" xref="S2.E3.m1.6.6.1.3.2.3">𝑉</ci></apply><ci id="S2.E3.m1.6.6.1.3.3.cmml" xref="S2.E3.m1.6.6.1.3.3">𝑿</ci></apply><apply id="S2.E3.m1.6.6.1.1.2.cmml" xref="S2.E3.m1.6.6.1.1.1"><ci id="S2.E3.m1.5.5.cmml" xref="S2.E3.m1.5.5">Softmax</ci><apply id="S2.E3.m1.6.6.1.1.1.1.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1"><plus id="S2.E3.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.1"></plus><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><divide id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2"></divide><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><times id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.3"></times><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2">𝑾</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3">𝐾</ci></apply><ci id="S2.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.3">𝑿</ci></apply><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3">top</csymbol></apply><apply id="S2.E3.m1.2.2.2.2.1.1.cmml" xref="S2.E3.m1.2.2.2.2.1"><times id="S2.E3.m1.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.1"></times><apply id="S2.E3.m1.2.2.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2">superscript</csymbol><ci id="S2.E3.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2.2">𝑾</ci><ci id="S2.E3.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.2.3">𝑄</ci></apply><ci id="S2.E3.m1.2.2.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.2.2.1.1.3">𝑿</ci></apply></apply><apply id="S2.E3.m1.2.2.4.cmml" xref="S2.E3.m1.2.2.4"><root id="S2.E3.m1.2.2.4a.cmml" xref="S2.E3.m1.2.2.4"></root><apply id="S2.E3.m1.2.2.4.2.cmml" xref="S2.E3.m1.2.2.4.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.4.2.1.cmml" xref="S2.E3.m1.2.2.4.2">subscript</csymbol><ci id="S2.E3.m1.2.2.4.2.2.cmml" xref="S2.E3.m1.2.2.4.2.2">𝑑</ci><ci id="S2.E3.m1.2.2.4.2.3.cmml" xref="S2.E3.m1.2.2.4.2.3">𝑘</ci></apply></apply></apply><ci id="S2.E3.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E3.m1.6.6.1.1.1.1.1.2">𝑴</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.6c">\operatorname{Attenion}(\bm{X})=\bm{W}^{V}\bm{X}\cdot\operatorname{Softmax}%
\left[\frac{\left(\bm{W}^{K}\bm{X}\right)^{\top}\left(\bm{W}^{Q}\bm{X}\right)}%
{\sqrt{d_{k}}}+\bm{M}\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.6d">roman_Attenion ( bold_italic_X ) = bold_italic_W start_POSTSUPERSCRIPT italic_V end_POSTSUPERSCRIPT bold_italic_X ⋅ roman_Softmax [ divide start_ARG ( bold_italic_W start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT bold_italic_X ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ( bold_italic_W start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT bold_italic_X ) end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG + bold_italic_M ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p2.5">where <math alttext="\bm{M}" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m1.1"><semantics id="S2.SS3.p2.5.m1.1a"><mi id="S2.SS3.p2.5.m1.1.1" xref="S2.SS3.p2.5.m1.1.1.cmml">𝑴</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m1.1b"><ci id="S2.SS3.p2.5.m1.1.1.cmml" xref="S2.SS3.p2.5.m1.1.1">𝑴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m1.1c">\bm{M}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.5.m1.1d">bold_italic_M</annotation></semantics></math> is the mask matrix.
In practice, the raw text sequence is passed through the tokenizer to obtain tokens, which are embeded and passed into the decoder-only transformer with several feed-forward and masked self-attention blocks. Then the hidden vectors with the maximum probability are produced and decoded to generate the results in an auto-regressive fashion.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Proposed Method</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We first illustrate the overall framework of the proposed LLM4MSR paradigm. Next, it is further detailed in the multi-scenario knowledge reasoning and multi-level knowledge fusion step. Finally, we discuss the idea and characteristics of LLM4MSR compared with the existing multi-scenario and LLM-based recommendation methods, and illustrate the necessity of LLMs versus PLMs.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Overall Framework</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">To tackle the limitations of the existing MSR methods, i.e., insufficient scenario knowledge incorporation and ignoring personalized cross-scenario interest, we propose a paradigm LLM4MSR for multi-scenario enhancement which is compatible with different multi-scenario backbone models.
Specifically, it is equipped with an LLM with frozen parameters and two learnable meta networks.
Meanwhile, the general procedure of LLM4MSR is summarized in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#alg1" title="In 3.1. Overall Framework ‣ 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.
It is comprised of two steps:
<span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.1">(i)</span> multi-scenario knowledge reasoning (from Line 1 to 10) including scenario correlation and cross-scenario interests inference, and
<span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.2">(ii)</span> multi-level knowledge fusion (from Line 11 to 15) to adaptively fuse with backbone.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.6">
<div class="ltx_listingline" id="alg1.6.7">
<span class="ltx_tag ltx_tag_listingline">1</span>
</div>
<div class="ltx_listingline" id="alg1.6.8">
<span class="ltx_tag ltx_tag_listingline">2</span>
</div>
<div class="ltx_listingline" id="alg1.4.4">
<span class="ltx_text" id="alg1.4.4.1"><span class="ltx_text ltx_font_bold" id="alg1.4.4.1.1">Input:</span> </span>Domain ID <math alttext="d\in\{1,2,\dots,D\}" class="ltx_Math" display="inline" id="alg1.1.1.m1.4"><semantics id="alg1.1.1.m1.4a"><mrow id="alg1.1.1.m1.4.5" xref="alg1.1.1.m1.4.5.cmml"><mi id="alg1.1.1.m1.4.5.2" xref="alg1.1.1.m1.4.5.2.cmml">d</mi><mo id="alg1.1.1.m1.4.5.1" xref="alg1.1.1.m1.4.5.1.cmml">∈</mo><mrow id="alg1.1.1.m1.4.5.3.2" xref="alg1.1.1.m1.4.5.3.1.cmml"><mo id="alg1.1.1.m1.4.5.3.2.1" stretchy="false" xref="alg1.1.1.m1.4.5.3.1.cmml">{</mo><mn id="alg1.1.1.m1.1.1" xref="alg1.1.1.m1.1.1.cmml">1</mn><mo id="alg1.1.1.m1.4.5.3.2.2" xref="alg1.1.1.m1.4.5.3.1.cmml">,</mo><mn id="alg1.1.1.m1.2.2" xref="alg1.1.1.m1.2.2.cmml">2</mn><mo id="alg1.1.1.m1.4.5.3.2.3" xref="alg1.1.1.m1.4.5.3.1.cmml">,</mo><mi id="alg1.1.1.m1.3.3" mathvariant="normal" xref="alg1.1.1.m1.3.3.cmml">…</mi><mo id="alg1.1.1.m1.4.5.3.2.4" xref="alg1.1.1.m1.4.5.3.1.cmml">,</mo><mi id="alg1.1.1.m1.4.4" xref="alg1.1.1.m1.4.4.cmml">D</mi><mo id="alg1.1.1.m1.4.5.3.2.5" stretchy="false" xref="alg1.1.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.1.m1.4b"><apply id="alg1.1.1.m1.4.5.cmml" xref="alg1.1.1.m1.4.5"><in id="alg1.1.1.m1.4.5.1.cmml" xref="alg1.1.1.m1.4.5.1"></in><ci id="alg1.1.1.m1.4.5.2.cmml" xref="alg1.1.1.m1.4.5.2">𝑑</ci><set id="alg1.1.1.m1.4.5.3.1.cmml" xref="alg1.1.1.m1.4.5.3.2"><cn id="alg1.1.1.m1.1.1.cmml" type="integer" xref="alg1.1.1.m1.1.1">1</cn><cn id="alg1.1.1.m1.2.2.cmml" type="integer" xref="alg1.1.1.m1.2.2">2</cn><ci id="alg1.1.1.m1.3.3.cmml" xref="alg1.1.1.m1.3.3">…</ci><ci id="alg1.1.1.m1.4.4.cmml" xref="alg1.1.1.m1.4.4">𝐷</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.m1.4c">d\in\{1,2,\dots,D\}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.m1.4d">italic_d ∈ { 1 , 2 , … , italic_D }</annotation></semantics></math>; set of user <math alttext="u\in\{1,2,\dots,U\}" class="ltx_Math" display="inline" id="alg1.2.2.m2.4"><semantics id="alg1.2.2.m2.4a"><mrow id="alg1.2.2.m2.4.5" xref="alg1.2.2.m2.4.5.cmml"><mi id="alg1.2.2.m2.4.5.2" xref="alg1.2.2.m2.4.5.2.cmml">u</mi><mo id="alg1.2.2.m2.4.5.1" xref="alg1.2.2.m2.4.5.1.cmml">∈</mo><mrow id="alg1.2.2.m2.4.5.3.2" xref="alg1.2.2.m2.4.5.3.1.cmml"><mo id="alg1.2.2.m2.4.5.3.2.1" stretchy="false" xref="alg1.2.2.m2.4.5.3.1.cmml">{</mo><mn id="alg1.2.2.m2.1.1" xref="alg1.2.2.m2.1.1.cmml">1</mn><mo id="alg1.2.2.m2.4.5.3.2.2" xref="alg1.2.2.m2.4.5.3.1.cmml">,</mo><mn id="alg1.2.2.m2.2.2" xref="alg1.2.2.m2.2.2.cmml">2</mn><mo id="alg1.2.2.m2.4.5.3.2.3" xref="alg1.2.2.m2.4.5.3.1.cmml">,</mo><mi id="alg1.2.2.m2.3.3" mathvariant="normal" xref="alg1.2.2.m2.3.3.cmml">…</mi><mo id="alg1.2.2.m2.4.5.3.2.4" xref="alg1.2.2.m2.4.5.3.1.cmml">,</mo><mi id="alg1.2.2.m2.4.4" xref="alg1.2.2.m2.4.4.cmml">U</mi><mo id="alg1.2.2.m2.4.5.3.2.5" stretchy="false" xref="alg1.2.2.m2.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.2.m2.4b"><apply id="alg1.2.2.m2.4.5.cmml" xref="alg1.2.2.m2.4.5"><in id="alg1.2.2.m2.4.5.1.cmml" xref="alg1.2.2.m2.4.5.1"></in><ci id="alg1.2.2.m2.4.5.2.cmml" xref="alg1.2.2.m2.4.5.2">𝑢</ci><set id="alg1.2.2.m2.4.5.3.1.cmml" xref="alg1.2.2.m2.4.5.3.2"><cn id="alg1.2.2.m2.1.1.cmml" type="integer" xref="alg1.2.2.m2.1.1">1</cn><cn id="alg1.2.2.m2.2.2.cmml" type="integer" xref="alg1.2.2.m2.2.2">2</cn><ci id="alg1.2.2.m2.3.3.cmml" xref="alg1.2.2.m2.3.3">…</ci><ci id="alg1.2.2.m2.4.4.cmml" xref="alg1.2.2.m2.4.4">𝑈</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.m2.4c">u\in\{1,2,\dots,U\}</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.m2.4d">italic_u ∈ { 1 , 2 , … , italic_U }</annotation></semantics></math>; features <math alttext="\bm{x}" class="ltx_Math" display="inline" id="alg1.3.3.m3.1"><semantics id="alg1.3.3.m3.1a"><mi id="alg1.3.3.m3.1.1" xref="alg1.3.3.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="alg1.3.3.m3.1b"><ci id="alg1.3.3.m3.1.1.cmml" xref="alg1.3.3.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.m3.1c">\bm{x}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.m3.1d">bold_italic_x</annotation></semantics></math>; true label <math alttext="y" class="ltx_Math" display="inline" id="alg1.4.4.m4.1"><semantics id="alg1.4.4.m4.1a"><mi id="alg1.4.4.m4.1.1" xref="alg1.4.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="alg1.4.4.m4.1b"><ci id="alg1.4.4.m4.1.1.cmml" xref="alg1.4.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.m4.1d">italic_y</annotation></semantics></math>; a pre-trained large language model (LLM)
</div>
<div class="ltx_listingline" id="alg1.6.9">
<span class="ltx_text" id="alg1.6.9.1"><span class="ltx_text ltx_font_bold" id="alg1.6.9.1.1">Output:</span> </span>A well trained model for all scenarios
</div>
<div class="ltx_listingline" id="alg1.6.10">
<span class="ltx_tag ltx_tag_listingline">3</span>
</div>
<div class="ltx_listingline" id="alg1.6.11">Step 1: Multi-scenario Knowledge Reasoning 
</div>
<div class="ltx_listingline" id="alg1.5.5">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_text ltx_font_bold" id="alg1.5.5.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.5.5.1"><math alttext="d\in\{1,2,\dots,D\}" class="ltx_Math" display="inline" id="alg1.5.5.1.m1.4"><semantics id="alg1.5.5.1.m1.4a"><mrow id="alg1.5.5.1.m1.4.5" xref="alg1.5.5.1.m1.4.5.cmml"><mi id="alg1.5.5.1.m1.4.5.2" xref="alg1.5.5.1.m1.4.5.2.cmml">d</mi><mo id="alg1.5.5.1.m1.4.5.1" xref="alg1.5.5.1.m1.4.5.1.cmml">∈</mo><mrow id="alg1.5.5.1.m1.4.5.3.2" xref="alg1.5.5.1.m1.4.5.3.1.cmml"><mo id="alg1.5.5.1.m1.4.5.3.2.1" stretchy="false" xref="alg1.5.5.1.m1.4.5.3.1.cmml">{</mo><mn id="alg1.5.5.1.m1.1.1" xref="alg1.5.5.1.m1.1.1.cmml">1</mn><mo id="alg1.5.5.1.m1.4.5.3.2.2" xref="alg1.5.5.1.m1.4.5.3.1.cmml">,</mo><mn id="alg1.5.5.1.m1.2.2" xref="alg1.5.5.1.m1.2.2.cmml">2</mn><mo id="alg1.5.5.1.m1.4.5.3.2.3" xref="alg1.5.5.1.m1.4.5.3.1.cmml">,</mo><mi id="alg1.5.5.1.m1.3.3" mathvariant="normal" xref="alg1.5.5.1.m1.3.3.cmml">…</mi><mo id="alg1.5.5.1.m1.4.5.3.2.4" xref="alg1.5.5.1.m1.4.5.3.1.cmml">,</mo><mi id="alg1.5.5.1.m1.4.4" xref="alg1.5.5.1.m1.4.4.cmml">D</mi><mo id="alg1.5.5.1.m1.4.5.3.2.5" stretchy="false" xref="alg1.5.5.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.5.5.1.m1.4b"><apply id="alg1.5.5.1.m1.4.5.cmml" xref="alg1.5.5.1.m1.4.5"><in id="alg1.5.5.1.m1.4.5.1.cmml" xref="alg1.5.5.1.m1.4.5.1"></in><ci id="alg1.5.5.1.m1.4.5.2.cmml" xref="alg1.5.5.1.m1.4.5.2">𝑑</ci><set id="alg1.5.5.1.m1.4.5.3.1.cmml" xref="alg1.5.5.1.m1.4.5.3.2"><cn id="alg1.5.5.1.m1.1.1.cmml" type="integer" xref="alg1.5.5.1.m1.1.1">1</cn><cn id="alg1.5.5.1.m1.2.2.cmml" type="integer" xref="alg1.5.5.1.m1.2.2">2</cn><ci id="alg1.5.5.1.m1.3.3.cmml" xref="alg1.5.5.1.m1.3.3">…</ci><ci id="alg1.5.5.1.m1.4.4.cmml" xref="alg1.5.5.1.m1.4.4">𝐷</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.1.m1.4c">d\in\{1,2,\dots,D\}</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.1.m1.4d">italic_d ∈ { 1 , 2 , … , italic_D }</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.5.5.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.6.12">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Generate scenario-level prompt;
</div>
<div class="ltx_listingline" id="alg1.6.13">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Feed into LLM;
</div>
<div class="ltx_listingline" id="alg1.6.14">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Obtain the last hidden state of scenario-level output;
</div>
<div class="ltx_listingline" id="alg1.6.15">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.6.16">
<span class="ltx_tag ltx_tag_listingline">9</span> end for
</div>
<div class="ltx_listingline" id="alg1.6.17">
<span class="ltx_tag ltx_tag_listingline">10</span>
</div>
<div class="ltx_listingline" id="alg1.6.6">
<span class="ltx_tag ltx_tag_listingline">11</span><span class="ltx_text ltx_font_bold" id="alg1.6.6.2">for</span> <em class="ltx_emph ltx_font_italic" id="alg1.6.6.1"><math alttext="u\in\{1,2,\dots,U\}" class="ltx_Math" display="inline" id="alg1.6.6.1.m1.4"><semantics id="alg1.6.6.1.m1.4a"><mrow id="alg1.6.6.1.m1.4.5" xref="alg1.6.6.1.m1.4.5.cmml"><mi id="alg1.6.6.1.m1.4.5.2" xref="alg1.6.6.1.m1.4.5.2.cmml">u</mi><mo id="alg1.6.6.1.m1.4.5.1" xref="alg1.6.6.1.m1.4.5.1.cmml">∈</mo><mrow id="alg1.6.6.1.m1.4.5.3.2" xref="alg1.6.6.1.m1.4.5.3.1.cmml"><mo id="alg1.6.6.1.m1.4.5.3.2.1" stretchy="false" xref="alg1.6.6.1.m1.4.5.3.1.cmml">{</mo><mn id="alg1.6.6.1.m1.1.1" xref="alg1.6.6.1.m1.1.1.cmml">1</mn><mo id="alg1.6.6.1.m1.4.5.3.2.2" xref="alg1.6.6.1.m1.4.5.3.1.cmml">,</mo><mn id="alg1.6.6.1.m1.2.2" xref="alg1.6.6.1.m1.2.2.cmml">2</mn><mo id="alg1.6.6.1.m1.4.5.3.2.3" xref="alg1.6.6.1.m1.4.5.3.1.cmml">,</mo><mi id="alg1.6.6.1.m1.3.3" mathvariant="normal" xref="alg1.6.6.1.m1.3.3.cmml">…</mi><mo id="alg1.6.6.1.m1.4.5.3.2.4" xref="alg1.6.6.1.m1.4.5.3.1.cmml">,</mo><mi id="alg1.6.6.1.m1.4.4" xref="alg1.6.6.1.m1.4.4.cmml">U</mi><mo id="alg1.6.6.1.m1.4.5.3.2.5" stretchy="false" xref="alg1.6.6.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.6.1.m1.4b"><apply id="alg1.6.6.1.m1.4.5.cmml" xref="alg1.6.6.1.m1.4.5"><in id="alg1.6.6.1.m1.4.5.1.cmml" xref="alg1.6.6.1.m1.4.5.1"></in><ci id="alg1.6.6.1.m1.4.5.2.cmml" xref="alg1.6.6.1.m1.4.5.2">𝑢</ci><set id="alg1.6.6.1.m1.4.5.3.1.cmml" xref="alg1.6.6.1.m1.4.5.3.2"><cn id="alg1.6.6.1.m1.1.1.cmml" type="integer" xref="alg1.6.6.1.m1.1.1">1</cn><cn id="alg1.6.6.1.m1.2.2.cmml" type="integer" xref="alg1.6.6.1.m1.2.2">2</cn><ci id="alg1.6.6.1.m1.3.3.cmml" xref="alg1.6.6.1.m1.3.3">…</ci><ci id="alg1.6.6.1.m1.4.4.cmml" xref="alg1.6.6.1.m1.4.4">𝑈</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.1.m1.4c">u\in\{1,2,\dots,U\}</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.1.m1.4d">italic_u ∈ { 1 , 2 , … , italic_U }</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="alg1.6.6.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.6.18">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Generate user-level prompt;
</div>
<div class="ltx_listingline" id="alg1.6.19">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Feed into LLM;
</div>
<div class="ltx_listingline" id="alg1.6.20">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Obtain the last hidden state of user-level output;
</div>
<div class="ltx_listingline" id="alg1.6.21">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.6.22">
<span class="ltx_tag ltx_tag_listingline">16</span> end for
</div>
<div class="ltx_listingline" id="alg1.6.23">
<span class="ltx_tag ltx_tag_listingline">17</span>
</div>
<div class="ltx_listingline" id="alg1.6.24">Step 2: Multi-level Knowledge Fusion 
</div>
<div class="ltx_listingline" id="alg1.6.25">
<span class="ltx_tag ltx_tag_listingline">18</span><span class="ltx_text ltx_font_bold" id="alg1.6.25.1">while</span> <em class="ltx_emph ltx_font_italic" id="alg1.6.25.2">not converge</em> <span class="ltx_text ltx_font_bold" id="alg1.6.25.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.6.26">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Sample a mini-batch data from all scenarios;
</div>
<div class="ltx_listingline" id="alg1.6.27">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.6.28">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Calculate the corresponding scenario- and user-level meta layers via Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3.E5" title="In 3.3. Multi-Level Knowledge Fusion ‣ 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3.E6" title="In 3.3. Multi-Level Knowledge Fusion ‣ 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>);
</div>
<div class="ltx_listingline" id="alg1.6.29">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Calculate the prediction result via Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S3.E9" title="In 3.3. Multi-Level Knowledge Fusion ‣ 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">9</span></a>);
</div>
<div class="ltx_listingline" id="alg1.6.30">
<span class="ltx_tag ltx_tag_listingline">23</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Calculate the loss via Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.E1" title="In 2.1. Multi-Scenario CTR Prediction ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>);
</div>
<div class="ltx_listingline" id="alg1.6.31">
<span class="ltx_tag ltx_tag_listingline">24</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Take the gradient and update parameters;
</div>
<div class="ltx_listingline" id="alg1.6.32">
<span class="ltx_tag ltx_tag_listingline">25</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="alg1.6.33">
<span class="ltx_tag ltx_tag_listingline">26</span> end while
</div>
<div class="ltx_listingline" id="alg1.6.34">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.8.1.1">Algorithm 1</span> </span>LLM4MSR paradigm taking multi-scenario CTR prediction as an example</figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">The illustration of LLM4MSR is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.F2" title="Figure 2 ‣ 2.3. Large Language Model ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>. Specifically, the scenario-level prompt is generated from the scenario statistics, semantic descriptions, and expert knowledge while the user-level prompt is constructed using historical interactions.
Afterward, they are fed into LLM to generate scenario correlation and personalized cross-scenario interest respectively.
Notably, only <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">the last hidden state</span> of LLM output (i.e., the hidden state of the last token generated) is chosen as representative and stored which is a high-dimensional dense vector, i.e., in 4096 dimensions taking ChatGLM2-6B <cite class="ltx_cite ltx_citemacro_citep">(Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib10" title="">2022</a>)</cite> as an example. It is common because the generation of the last token is based on all previous ones and contains overall information.
Finally, the hierarchical meta networks produce meta layers in scenario- and user-level, and they are trained with the MSR backbone model to enhance its all-scenario performance.
Overall, the final enhanced model can be obtained in a simple yet efficient end-to-end training manner by optimizing Equation (<a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.E1" title="In 2.1. Multi-Scenario CTR Prediction ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Multi-Scenario Knowledge Reasoning</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">On the one hand, it is difficult for the mainstream MSR models to grasp the complex scenarios correlations because in practice the domain indicator distinguishing data origin is usually the only scenario-related knowledge <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>; Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib4" title="">2023</a>; Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib12" title="">2023</a>)</cite>, thus their scenario representation is only learned from the implicit collaborative signals.
Therefore, we design a scenario-level prompt to explicitly capture the commonality and distinction of scenarios from their statistics and semantic descriptions.
For example, as shown in the purple box in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.F2" title="Figure 2 ‣ 2.3. Large Language Model ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, the statistics like the number of interactions, users, items, and overlaps on KuaiSAR-small together with the background semantic information are given to uncover both similarity and heterogeneity of the recommendation and search scenario.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">On the other hand, existing MSR models tend to neglect modeling personalized interest and it is challenging to capture user’s cross-scenario preferences in a disentangled manner. To this end, we design a user-level prompt to explicitly explore personalized common and distinct interests among all the scenarios from the abundant historical interaction.
Intuitively, positive interaction behavior tend to better reflect user’s interest than negative behavior.
Meanwhile, the proportion of negative samples is usually large and they contain much noise information due to the biases and uncertainty in data collection and user interaction.
Consequently, the positive interaction data (i.e., samples with positive interaction behavior such as click, forward, and like) are filtered and leveraged in the user-level prompt.
As shown in the blue box in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.F2" title="Figure 2 ‣ 2.3. Large Language Model ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(a), LLM helps explicitly capturing user’s preferences in the search and recommendation scenario considering both the interaction frequency and the semantic relationships, e.g., in the category and title of item. The specific prompt template are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#A2" title="Appendix B Prompt template ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">After obtaining the scenario- and user-level prompt, they are passed into LLM to reason about the multi-scenario knowledge. Moreover, we conduct a case study in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS6" title="4.6. Case Study (RQ5) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4.6</span></a> to investigate what multi-scenario knowledge can LLM obtain and how it contributes to enhancing the MSR backbone model.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Multi-Level Knowledge Fusion</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Existing methods either choose to directly leverage the augmented information from LLM as additional input features in the RS <cite class="ltx_cite ltx_citemacro_citep">(Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib32" title="">2023</a>)</cite>, adopt a linear projection or a fully connected network to conduct dimension transformation and align instance representation <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>)</cite>, or fine-tune the LLM <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib38" title="">2023</a>)</cite>.
However, we argue that these are sub-optimal solutions <cite class="ltx_cite ltx_citemacro_citep">(Su et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib23" title="">2023</a>)</cite>.
First, since the LLM-augmented information is treated as a common feature by recommender system, it is unable to play a significant role as expected because the number of feature fields is usually large <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib37" title="">2021</a>)</cite>.
Second, simply aligning the dimension would result in loss of information <cite class="ltx_cite ltx_citemacro_citep">(Zebari et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib35" title="">2020</a>)</cite>.
Third, tuning LLM brings high cost <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib5" title="">2023b</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib6" title="">a</a>)</cite> and it requires consistent update.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">Therefore, after obtaining the informative multi-scenario knowledge which is in the form of high-dimensional hidden vectors from LLM, our proposed LLM4MSR adopts a new and efficient approach leveraging hierarchical meta networks to bring information gain.
To be specific, the meta networks dynamically generate meta layers to adaptively fuse the scenario- and user-level knowledge with the collaborative information in the MSR backbone model.
Intuitively, on the one hand, the scenario-level knowledge usually plays a more general role like the domain distinction captured by auxiliary network in STAR <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>)</cite>.
On the other hand, the user-level information tends to be more personalized and significant <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib4" title="">2023</a>)</cite> because it breaks the boundary of scenarios and contains a complete user profile across all scenarios.
Consequently, we propose a hierarchical <span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">‘bottom + parallel’</span> structure, in which the user-level
meta layers are placed at the bottom while the scenario-level meta layers are implemented in parallel to the MSR backbone, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.F2" title="Figure 2 ‣ 2.3. Large Language Model ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>(b).
Notably, They target at improving scenario-aware recommendation and
cross-scenario personalization capability respectively, thus contributing to knowledge fusion and enhancement in different levels and granularity.
We will empirically investigate this architecture of LLM4MSR through experiments in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS3" title="4.3. Ablation &amp; Component Study (RQ2) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4.3</span></a> where we also observe that user-level meta layers at bottom and scenario-level meta layers in parallel is the optimal combination.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.4">Specifically, denote the last hidden state of LLM output as <math alttext="\bm{h}_{LLM}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">𝒉</mi><mrow id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml"><mi id="S3.SS3.p3.1.m1.1.1.3.2" xref="S3.SS3.p3.1.m1.1.1.3.2.cmml">L</mi><mo id="S3.SS3.p3.1.m1.1.1.3.1" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.1.m1.1.1.3.3" xref="S3.SS3.p3.1.m1.1.1.3.3.cmml">L</mi><mo id="S3.SS3.p3.1.m1.1.1.3.1a" xref="S3.SS3.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.1.m1.1.1.3.4" xref="S3.SS3.p3.1.m1.1.1.3.4.cmml">M</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝒉</ci><apply id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3"><times id="S3.SS3.p3.1.m1.1.1.3.1.cmml" xref="S3.SS3.p3.1.m1.1.1.3.1"></times><ci id="S3.SS3.p3.1.m1.1.1.3.2.cmml" xref="S3.SS3.p3.1.m1.1.1.3.2">𝐿</ci><ci id="S3.SS3.p3.1.m1.1.1.3.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3.3">𝐿</ci><ci id="S3.SS3.p3.1.m1.1.1.3.4.cmml" xref="S3.SS3.p3.1.m1.1.1.3.4">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\bm{h}_{LLM}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">bold_italic_h start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT</annotation></semantics></math>, the meta work takes it as input and outputs <math alttext="\bm{h}_{mw}\in\mathbb{R}^{Dim_{mw}}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mrow id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><msub id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2.2" xref="S3.SS3.p3.2.m2.1.1.2.2.cmml">𝒉</mi><mrow id="S3.SS3.p3.2.m2.1.1.2.3" xref="S3.SS3.p3.2.m2.1.1.2.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2.3.2" xref="S3.SS3.p3.2.m2.1.1.2.3.2.cmml">m</mi><mo id="S3.SS3.p3.2.m2.1.1.2.3.1" xref="S3.SS3.p3.2.m2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.1.1.2.3.3" xref="S3.SS3.p3.2.m2.1.1.2.3.3.cmml">w</mi></mrow></msub><mo id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.2.m2.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.3.2" xref="S3.SS3.p3.2.m2.1.1.3.3.2.cmml">D</mi><mo id="S3.SS3.p3.2.m2.1.1.3.3.1" xref="S3.SS3.p3.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.1.1.3.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.3.cmml">i</mi><mo id="S3.SS3.p3.2.m2.1.1.3.3.1a" xref="S3.SS3.p3.2.m2.1.1.3.3.1.cmml">⁢</mo><msub id="S3.SS3.p3.2.m2.1.1.3.3.4" xref="S3.SS3.p3.2.m2.1.1.3.3.4.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.3.4.2" xref="S3.SS3.p3.2.m2.1.1.3.3.4.2.cmml">m</mi><mrow id="S3.SS3.p3.2.m2.1.1.3.3.4.3" xref="S3.SS3.p3.2.m2.1.1.3.3.4.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.3.4.3.2" xref="S3.SS3.p3.2.m2.1.1.3.3.4.3.2.cmml">m</mi><mo id="S3.SS3.p3.2.m2.1.1.3.3.4.3.1" xref="S3.SS3.p3.2.m2.1.1.3.3.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.2.m2.1.1.3.3.4.3.3" xref="S3.SS3.p3.2.m2.1.1.3.3.4.3.3.cmml">w</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><in id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1"></in><apply id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.2.1.cmml" xref="S3.SS3.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2.2">𝒉</ci><apply id="S3.SS3.p3.2.m2.1.1.2.3.cmml" xref="S3.SS3.p3.2.m2.1.1.2.3"><times id="S3.SS3.p3.2.m2.1.1.2.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.2.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.2.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2.3.2">𝑚</ci><ci id="S3.SS3.p3.2.m2.1.1.2.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.2.3.3">𝑤</ci></apply></apply><apply id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS3.p3.2.m2.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3"><times id="S3.SS3.p3.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.2">𝐷</ci><ci id="S3.SS3.p3.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.3">𝑖</ci><apply id="S3.SS3.p3.2.m2.1.1.3.3.4.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.3.4.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.4">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.3.3.4.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.4.2">𝑚</ci><apply id="S3.SS3.p3.2.m2.1.1.3.3.4.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.4.3"><times id="S3.SS3.p3.2.m2.1.1.3.3.4.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.4.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.3.3.4.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.4.3.2">𝑚</ci><ci id="S3.SS3.p3.2.m2.1.1.3.3.4.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.3.4.3.3">𝑤</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\bm{h}_{mw}\in\mathbb{R}^{Dim_{mw}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">bold_italic_h start_POSTSUBSCRIPT italic_m italic_w end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D italic_i italic_m start_POSTSUBSCRIPT italic_m italic_w end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\bm{h}_{mb}\in\mathbb{R}^{Dim_{mb}}" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><msub id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml">𝒉</mi><mrow id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.3.2" xref="S3.SS3.p3.3.m3.1.1.2.3.2.cmml">m</mi><mo id="S3.SS3.p3.3.m3.1.1.2.3.1" xref="S3.SS3.p3.3.m3.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.3.m3.1.1.2.3.3" xref="S3.SS3.p3.3.m3.1.1.2.3.3.cmml">b</mi></mrow></msub><mo id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.3.2" xref="S3.SS3.p3.3.m3.1.1.3.3.2.cmml">D</mi><mo id="S3.SS3.p3.3.m3.1.1.3.3.1" xref="S3.SS3.p3.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.3.m3.1.1.3.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.3.cmml">i</mi><mo id="S3.SS3.p3.3.m3.1.1.3.3.1a" xref="S3.SS3.p3.3.m3.1.1.3.3.1.cmml">⁢</mo><msub id="S3.SS3.p3.3.m3.1.1.3.3.4" xref="S3.SS3.p3.3.m3.1.1.3.3.4.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.3.4.2" xref="S3.SS3.p3.3.m3.1.1.3.3.4.2.cmml">m</mi><mrow id="S3.SS3.p3.3.m3.1.1.3.3.4.3" xref="S3.SS3.p3.3.m3.1.1.3.3.4.3.cmml"><mi id="S3.SS3.p3.3.m3.1.1.3.3.4.3.2" xref="S3.SS3.p3.3.m3.1.1.3.3.4.3.2.cmml">m</mi><mo id="S3.SS3.p3.3.m3.1.1.3.3.4.3.1" xref="S3.SS3.p3.3.m3.1.1.3.3.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.3.m3.1.1.3.3.4.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.4.3.3.cmml">b</mi></mrow></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><in id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1"></in><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2">𝒉</ci><apply id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3"><times id="S3.SS3.p3.3.m3.1.1.2.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3.1"></times><ci id="S3.SS3.p3.3.m3.1.1.2.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3.2">𝑚</ci><ci id="S3.SS3.p3.3.m3.1.1.2.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3.3">𝑏</ci></apply></apply><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3"><times id="S3.SS3.p3.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.p3.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.2">𝐷</ci><ci id="S3.SS3.p3.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.3">𝑖</ci><apply id="S3.SS3.p3.3.m3.1.1.3.3.4.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.3.3.4.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.4">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.3.3.4.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.4.2">𝑚</ci><apply id="S3.SS3.p3.3.m3.1.1.3.3.4.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.4.3"><times id="S3.SS3.p3.3.m3.1.1.3.3.4.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.4.3.1"></times><ci id="S3.SS3.p3.3.m3.1.1.3.3.4.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.4.3.2">𝑚</ci><ci id="S3.SS3.p3.3.m3.1.1.3.3.4.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3.4.3.3">𝑏</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\bm{h}_{mb}\in\mathbb{R}^{Dim_{mb}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">bold_italic_h start_POSTSUBSCRIPT italic_m italic_b end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_D italic_i italic_m start_POSTSUBSCRIPT italic_m italic_b end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, then a reshape operation is employed to obtain <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.p3.4.m4.1"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.4.m4.1d">italic_K</annotation></semantics></math> meta layers in total:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{h}_{mw},\bm{h}_{mb}=\operatorname{Meta~{}Network}(\bm{h}_{LLM})," class="ltx_Math" display="block" id="S3.E4.m1.2"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1.2.2" xref="S3.E4.m1.2.2.1.1.2.3.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.cmml">𝒉</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.1.3.2.cmml">m</mi><mo id="S3.E4.m1.2.2.1.1.1.1.1.3.1" xref="S3.E4.m1.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.1.3.3.cmml">w</mi></mrow></msub><mo id="S3.E4.m1.2.2.1.1.2.2.3" xref="S3.E4.m1.2.2.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.2.2.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.2.2.2.2" xref="S3.E4.m1.2.2.1.1.2.2.2.2.cmml">𝒉</mi><mrow id="S3.E4.m1.2.2.1.1.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S3.E4.m1.2.2.1.1.2.2.2.3.2" xref="S3.E4.m1.2.2.1.1.2.2.2.3.2.cmml">m</mi><mo id="S3.E4.m1.2.2.1.1.2.2.2.3.1" xref="S3.E4.m1.2.2.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.2.2.2.3.3" xref="S3.E4.m1.2.2.1.1.2.2.2.3.3.cmml">b</mi></mrow></msub></mrow><mo id="S3.E4.m1.2.2.1.1.4" xref="S3.E4.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.3.1" xref="S3.E4.m1.2.2.1.1.3.2.cmml"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mi id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">Meta</mi><mo id="S3.E4.m1.1.1.1" lspace="0.330em" xref="S3.E4.m1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml">Network</mi></mrow><mo id="S3.E4.m1.2.2.1.1.3.1a" xref="S3.E4.m1.2.2.1.1.3.2.cmml">⁡</mo><mrow id="S3.E4.m1.2.2.1.1.3.1.1" xref="S3.E4.m1.2.2.1.1.3.2.cmml"><mo id="S3.E4.m1.2.2.1.1.3.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.3.2.cmml">(</mo><msub id="S3.E4.m1.2.2.1.1.3.1.1.1" xref="S3.E4.m1.2.2.1.1.3.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.3.1.1.1.2" xref="S3.E4.m1.2.2.1.1.3.1.1.1.2.cmml">𝒉</mi><mrow id="S3.E4.m1.2.2.1.1.3.1.1.1.3" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.3.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.2.cmml">L</mi><mo id="S3.E4.m1.2.2.1.1.3.1.1.1.3.1" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.3.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.3.cmml">L</mi><mo id="S3.E4.m1.2.2.1.1.3.1.1.1.3.1a" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.1.1.3.1.1.1.3.4" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.4.cmml">M</mi></mrow></msub><mo id="S3.E4.m1.2.2.1.1.3.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.3.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.4"></eq><list id="S3.E4.m1.2.2.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2"><apply id="S3.E4.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.2">𝒉</ci><apply id="S3.E4.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.3"><times id="S3.E4.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.3.1"></times><ci id="S3.E4.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.3.2">𝑚</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.3.3">𝑤</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2">𝒉</ci><apply id="S3.E4.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.3"><times id="S3.E4.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.3.1"></times><ci id="S3.E4.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.3.2">𝑚</ci><ci id="S3.E4.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.3.3">𝑏</ci></apply></apply></list><apply id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.1"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><times id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></times><ci id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2">Meta</ci><ci id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3">Network</ci></apply><apply id="S3.E4.m1.2.2.1.1.3.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.3.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.2">𝒉</ci><apply id="S3.E4.m1.2.2.1.1.3.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3"><times id="S3.E4.m1.2.2.1.1.3.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.1"></times><ci id="S3.E4.m1.2.2.1.1.3.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.2">𝐿</ci><ci id="S3.E4.m1.2.2.1.1.3.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.3">𝐿</ci><ci id="S3.E4.m1.2.2.1.1.3.1.1.1.3.4.cmml" xref="S3.E4.m1.2.2.1.1.3.1.1.1.3.4">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\bm{h}_{mw},\bm{h}_{mb}=\operatorname{Meta~{}Network}(\bm{h}_{LLM}),</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.2d">bold_italic_h start_POSTSUBSCRIPT italic_m italic_w end_POSTSUBSCRIPT , bold_italic_h start_POSTSUBSCRIPT italic_m italic_b end_POSTSUBSCRIPT = start_OPFUNCTION roman_Meta roman_Network end_OPFUNCTION ( bold_italic_h start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{W}_{l}^{(i)}=Reshape(\bm{h}_{mw})" class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><msubsup id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml"><mi id="S3.E5.m1.2.2.3.2.2" xref="S3.E5.m1.2.2.3.2.2.cmml">𝑾</mi><mi id="S3.E5.m1.2.2.3.2.3" xref="S3.E5.m1.2.2.3.2.3.cmml">l</mi><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.2.2.3.cmml"><mo id="S3.E5.m1.1.1.1.3.1" stretchy="false" xref="S3.E5.m1.2.2.3.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">i</mi><mo id="S3.E5.m1.1.1.1.3.2" stretchy="false" xref="S3.E5.m1.2.2.3.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.cmml"><mi id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.2.2.1.3.cmml">R</mi><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.4" xref="S3.E5.m1.2.2.1.4.cmml">e</mi><mo id="S3.E5.m1.2.2.1.2a" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.5" xref="S3.E5.m1.2.2.1.5.cmml">s</mi><mo id="S3.E5.m1.2.2.1.2b" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.6" xref="S3.E5.m1.2.2.1.6.cmml">h</mi><mo id="S3.E5.m1.2.2.1.2c" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.7" xref="S3.E5.m1.2.2.1.7.cmml">a</mi><mo id="S3.E5.m1.2.2.1.2d" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.8" xref="S3.E5.m1.2.2.1.8.cmml">p</mi><mo id="S3.E5.m1.2.2.1.2e" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.9" xref="S3.E5.m1.2.2.1.9.cmml">e</mi><mo id="S3.E5.m1.2.2.1.2f" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">𝒉</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.2.cmml">m</mi><mo id="S3.E5.m1.2.2.1.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.cmml">w</mi></mrow></msub><mo id="S3.E5.m1.2.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"></eq><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.3">superscript</csymbol><apply id="S3.E5.m1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.2.1.cmml" xref="S3.E5.m1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.3.2.2.cmml" xref="S3.E5.m1.2.2.3.2.2">𝑾</ci><ci id="S3.E5.m1.2.2.3.2.3.cmml" xref="S3.E5.m1.2.2.3.2.3">𝑙</ci></apply><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2.1"><times id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.2"></times><ci id="S3.E5.m1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3">𝑅</ci><ci id="S3.E5.m1.2.2.1.4.cmml" xref="S3.E5.m1.2.2.1.4">𝑒</ci><ci id="S3.E5.m1.2.2.1.5.cmml" xref="S3.E5.m1.2.2.1.5">𝑠</ci><ci id="S3.E5.m1.2.2.1.6.cmml" xref="S3.E5.m1.2.2.1.6">ℎ</ci><ci id="S3.E5.m1.2.2.1.7.cmml" xref="S3.E5.m1.2.2.1.7">𝑎</ci><ci id="S3.E5.m1.2.2.1.8.cmml" xref="S3.E5.m1.2.2.1.8">𝑝</ci><ci id="S3.E5.m1.2.2.1.9.cmml" xref="S3.E5.m1.2.2.1.9">𝑒</ci><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2">𝒉</ci><apply id="S3.E5.m1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3"><times id="S3.E5.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.2">𝑚</ci><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\bm{W}_{l}^{(i)}=Reshape(\bm{h}_{mw})</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">bold_italic_W start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_R italic_e italic_s italic_h italic_a italic_p italic_e ( bold_italic_h start_POSTSUBSCRIPT italic_m italic_w end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{b}_{l}^{(i)}=Reshape(\bm{h}_{mb}),i\in\{1,2,\ldots,K\}" class="ltx_Math" display="block" id="S3.E6.m1.7"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7.2" xref="S3.E6.m1.7.7.3.cmml"><mrow id="S3.E6.m1.6.6.1.1" xref="S3.E6.m1.6.6.1.1.cmml"><msubsup id="S3.E6.m1.6.6.1.1.3" xref="S3.E6.m1.6.6.1.1.3.cmml"><mi id="S3.E6.m1.6.6.1.1.3.2.2" xref="S3.E6.m1.6.6.1.1.3.2.2.cmml">𝒃</mi><mi id="S3.E6.m1.6.6.1.1.3.2.3" xref="S3.E6.m1.6.6.1.1.3.2.3.cmml">l</mi><mrow id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.3.cmml"><mo id="S3.E6.m1.1.1.1.3.1" stretchy="false" xref="S3.E6.m1.6.6.1.1.3.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">i</mi><mo id="S3.E6.m1.1.1.1.3.2" stretchy="false" xref="S3.E6.m1.6.6.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S3.E6.m1.6.6.1.1.2" xref="S3.E6.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.6.6.1.1.1" xref="S3.E6.m1.6.6.1.1.1.cmml"><mi id="S3.E6.m1.6.6.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.3.cmml">R</mi><mo id="S3.E6.m1.6.6.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.6.6.1.1.1.4" xref="S3.E6.m1.6.6.1.1.1.4.cmml">e</mi><mo id="S3.E6.m1.6.6.1.1.1.2a" xref="S3.E6.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.6.6.1.1.1.5" xref="S3.E6.m1.6.6.1.1.1.5.cmml">s</mi><mo id="S3.E6.m1.6.6.1.1.1.2b" xref="S3.E6.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.6.6.1.1.1.6" xref="S3.E6.m1.6.6.1.1.1.6.cmml">h</mi><mo id="S3.E6.m1.6.6.1.1.1.2c" xref="S3.E6.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.6.6.1.1.1.7" xref="S3.E6.m1.6.6.1.1.1.7.cmml">a</mi><mo id="S3.E6.m1.6.6.1.1.1.2d" xref="S3.E6.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.6.6.1.1.1.8" xref="S3.E6.m1.6.6.1.1.1.8.cmml">p</mi><mo id="S3.E6.m1.6.6.1.1.1.2e" xref="S3.E6.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.E6.m1.6.6.1.1.1.9" xref="S3.E6.m1.6.6.1.1.1.9.cmml">e</mi><mo id="S3.E6.m1.6.6.1.1.1.2f" xref="S3.E6.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.6.6.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.cmml">𝒉</mi><mrow id="S3.E6.m1.6.6.1.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.2.cmml">m</mi><mo id="S3.E6.m1.6.6.1.1.1.1.1.1.3.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.3.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.3.cmml">b</mi></mrow></msub><mo id="S3.E6.m1.6.6.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.7.7.2.3" xref="S3.E6.m1.7.7.3a.cmml">,</mo><mrow id="S3.E6.m1.7.7.2.2" xref="S3.E6.m1.7.7.2.2.cmml"><mi id="S3.E6.m1.7.7.2.2.2" xref="S3.E6.m1.7.7.2.2.2.cmml">i</mi><mo id="S3.E6.m1.7.7.2.2.1" xref="S3.E6.m1.7.7.2.2.1.cmml">∈</mo><mrow id="S3.E6.m1.7.7.2.2.3.2" xref="S3.E6.m1.7.7.2.2.3.1.cmml"><mo id="S3.E6.m1.7.7.2.2.3.2.1" stretchy="false" xref="S3.E6.m1.7.7.2.2.3.1.cmml">{</mo><mn id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">1</mn><mo id="S3.E6.m1.7.7.2.2.3.2.2" xref="S3.E6.m1.7.7.2.2.3.1.cmml">,</mo><mn id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">2</mn><mo id="S3.E6.m1.7.7.2.2.3.2.3" xref="S3.E6.m1.7.7.2.2.3.1.cmml">,</mo><mi id="S3.E6.m1.4.4" mathvariant="normal" xref="S3.E6.m1.4.4.cmml">…</mi><mo id="S3.E6.m1.7.7.2.2.3.2.4" xref="S3.E6.m1.7.7.2.2.3.1.cmml">,</mo><mi id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">K</mi><mo id="S3.E6.m1.7.7.2.2.3.2.5" stretchy="false" xref="S3.E6.m1.7.7.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.3.cmml" xref="S3.E6.m1.7.7.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.3a.cmml" xref="S3.E6.m1.7.7.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.6.6.1.1.cmml" xref="S3.E6.m1.6.6.1.1"><eq id="S3.E6.m1.6.6.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2"></eq><apply id="S3.E6.m1.6.6.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.3">superscript</csymbol><apply id="S3.E6.m1.6.6.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.3.2.1.cmml" xref="S3.E6.m1.6.6.1.1.3">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.3.2.2.cmml" xref="S3.E6.m1.6.6.1.1.3.2.2">𝒃</ci><ci id="S3.E6.m1.6.6.1.1.3.2.3.cmml" xref="S3.E6.m1.6.6.1.1.3.2.3">𝑙</ci></apply><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E6.m1.6.6.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1"><times id="S3.E6.m1.6.6.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.2"></times><ci id="S3.E6.m1.6.6.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.1.3">𝑅</ci><ci id="S3.E6.m1.6.6.1.1.1.4.cmml" xref="S3.E6.m1.6.6.1.1.1.4">𝑒</ci><ci id="S3.E6.m1.6.6.1.1.1.5.cmml" xref="S3.E6.m1.6.6.1.1.1.5">𝑠</ci><ci id="S3.E6.m1.6.6.1.1.1.6.cmml" xref="S3.E6.m1.6.6.1.1.1.6">ℎ</ci><ci id="S3.E6.m1.6.6.1.1.1.7.cmml" xref="S3.E6.m1.6.6.1.1.1.7">𝑎</ci><ci id="S3.E6.m1.6.6.1.1.1.8.cmml" xref="S3.E6.m1.6.6.1.1.1.8">𝑝</ci><ci id="S3.E6.m1.6.6.1.1.1.9.cmml" xref="S3.E6.m1.6.6.1.1.1.9">𝑒</ci><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2">𝒉</ci><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3"><times id="S3.E6.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.1"></times><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.3">𝑏</ci></apply></apply></apply></apply><apply id="S3.E6.m1.7.7.2.2.cmml" xref="S3.E6.m1.7.7.2.2"><in id="S3.E6.m1.7.7.2.2.1.cmml" xref="S3.E6.m1.7.7.2.2.1"></in><ci id="S3.E6.m1.7.7.2.2.2.cmml" xref="S3.E6.m1.7.7.2.2.2">𝑖</ci><set id="S3.E6.m1.7.7.2.2.3.1.cmml" xref="S3.E6.m1.7.7.2.2.3.2"><cn id="S3.E6.m1.2.2.cmml" type="integer" xref="S3.E6.m1.2.2">1</cn><cn id="S3.E6.m1.3.3.cmml" type="integer" xref="S3.E6.m1.3.3">2</cn><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">…</ci><ci id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5">𝐾</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">\bm{b}_{l}^{(i)}=Reshape(\bm{h}_{mb}),i\in\{1,2,\ldots,K\}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.7d">bold_italic_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_R italic_e italic_s italic_h italic_a italic_p italic_e ( bold_italic_h start_POSTSUBSCRIPT italic_m italic_b end_POSTSUBSCRIPT ) , italic_i ∈ { 1 , 2 , … , italic_K }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.15">where <math alttext="\bm{W}_{l}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p3.5.m1.1"><semantics id="S3.SS3.p3.5.m1.1a"><msubsup id="S3.SS3.p3.5.m1.1.2" xref="S3.SS3.p3.5.m1.1.2.cmml"><mi id="S3.SS3.p3.5.m1.1.2.2.2" xref="S3.SS3.p3.5.m1.1.2.2.2.cmml">𝑾</mi><mi id="S3.SS3.p3.5.m1.1.2.2.3" xref="S3.SS3.p3.5.m1.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.p3.5.m1.1.1.1.3" xref="S3.SS3.p3.5.m1.1.2.cmml"><mo id="S3.SS3.p3.5.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.5.m1.1.2.cmml">(</mo><mi id="S3.SS3.p3.5.m1.1.1.1.1" xref="S3.SS3.p3.5.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.5.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.5.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m1.1b"><apply id="S3.SS3.p3.5.m1.1.2.cmml" xref="S3.SS3.p3.5.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.1.2.1.cmml" xref="S3.SS3.p3.5.m1.1.2">superscript</csymbol><apply id="S3.SS3.p3.5.m1.1.2.2.cmml" xref="S3.SS3.p3.5.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.1.2.2.1.cmml" xref="S3.SS3.p3.5.m1.1.2">subscript</csymbol><ci id="S3.SS3.p3.5.m1.1.2.2.2.cmml" xref="S3.SS3.p3.5.m1.1.2.2.2">𝑾</ci><ci id="S3.SS3.p3.5.m1.1.2.2.3.cmml" xref="S3.SS3.p3.5.m1.1.2.2.3">𝑙</ci></apply><ci id="S3.SS3.p3.5.m1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m1.1c">\bm{W}_{l}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.5.m1.1d">bold_italic_W start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\bm{b}_{l}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p3.6.m2.1"><semantics id="S3.SS3.p3.6.m2.1a"><msubsup id="S3.SS3.p3.6.m2.1.2" xref="S3.SS3.p3.6.m2.1.2.cmml"><mi id="S3.SS3.p3.6.m2.1.2.2.2" xref="S3.SS3.p3.6.m2.1.2.2.2.cmml">𝒃</mi><mi id="S3.SS3.p3.6.m2.1.2.2.3" xref="S3.SS3.p3.6.m2.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.p3.6.m2.1.1.1.3" xref="S3.SS3.p3.6.m2.1.2.cmml"><mo id="S3.SS3.p3.6.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.6.m2.1.2.cmml">(</mo><mi id="S3.SS3.p3.6.m2.1.1.1.1" xref="S3.SS3.p3.6.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.6.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.6.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m2.1b"><apply id="S3.SS3.p3.6.m2.1.2.cmml" xref="S3.SS3.p3.6.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m2.1.2.1.cmml" xref="S3.SS3.p3.6.m2.1.2">superscript</csymbol><apply id="S3.SS3.p3.6.m2.1.2.2.cmml" xref="S3.SS3.p3.6.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m2.1.2.2.1.cmml" xref="S3.SS3.p3.6.m2.1.2">subscript</csymbol><ci id="S3.SS3.p3.6.m2.1.2.2.2.cmml" xref="S3.SS3.p3.6.m2.1.2.2.2">𝒃</ci><ci id="S3.SS3.p3.6.m2.1.2.2.3.cmml" xref="S3.SS3.p3.6.m2.1.2.2.3">𝑙</ci></apply><ci id="S3.SS3.p3.6.m2.1.1.1.1.cmml" xref="S3.SS3.p3.6.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m2.1c">\bm{b}_{l}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.6.m2.1d">bold_italic_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> indicate the weight and bias matrix of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.7.m3.1"><semantics id="S3.SS3.p3.7.m3.1a"><mi id="S3.SS3.p3.7.m3.1.1" xref="S3.SS3.p3.7.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m3.1b"><ci id="S3.SS3.p3.7.m3.1.1.cmml" xref="S3.SS3.p3.7.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.7.m3.1d">italic_i</annotation></semantics></math>-th meta layer. Notably, <math alttext="Dim_{mw}" class="ltx_Math" display="inline" id="S3.SS3.p3.8.m4.1"><semantics id="S3.SS3.p3.8.m4.1a"><mrow id="S3.SS3.p3.8.m4.1.1" xref="S3.SS3.p3.8.m4.1.1.cmml"><mi id="S3.SS3.p3.8.m4.1.1.2" xref="S3.SS3.p3.8.m4.1.1.2.cmml">D</mi><mo id="S3.SS3.p3.8.m4.1.1.1" xref="S3.SS3.p3.8.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p3.8.m4.1.1.3" xref="S3.SS3.p3.8.m4.1.1.3.cmml">i</mi><mo id="S3.SS3.p3.8.m4.1.1.1a" xref="S3.SS3.p3.8.m4.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p3.8.m4.1.1.4" xref="S3.SS3.p3.8.m4.1.1.4.cmml"><mi id="S3.SS3.p3.8.m4.1.1.4.2" xref="S3.SS3.p3.8.m4.1.1.4.2.cmml">m</mi><mrow id="S3.SS3.p3.8.m4.1.1.4.3" xref="S3.SS3.p3.8.m4.1.1.4.3.cmml"><mi id="S3.SS3.p3.8.m4.1.1.4.3.2" xref="S3.SS3.p3.8.m4.1.1.4.3.2.cmml">m</mi><mo id="S3.SS3.p3.8.m4.1.1.4.3.1" xref="S3.SS3.p3.8.m4.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.8.m4.1.1.4.3.3" xref="S3.SS3.p3.8.m4.1.1.4.3.3.cmml">w</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m4.1b"><apply id="S3.SS3.p3.8.m4.1.1.cmml" xref="S3.SS3.p3.8.m4.1.1"><times id="S3.SS3.p3.8.m4.1.1.1.cmml" xref="S3.SS3.p3.8.m4.1.1.1"></times><ci id="S3.SS3.p3.8.m4.1.1.2.cmml" xref="S3.SS3.p3.8.m4.1.1.2">𝐷</ci><ci id="S3.SS3.p3.8.m4.1.1.3.cmml" xref="S3.SS3.p3.8.m4.1.1.3">𝑖</ci><apply id="S3.SS3.p3.8.m4.1.1.4.cmml" xref="S3.SS3.p3.8.m4.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m4.1.1.4.1.cmml" xref="S3.SS3.p3.8.m4.1.1.4">subscript</csymbol><ci id="S3.SS3.p3.8.m4.1.1.4.2.cmml" xref="S3.SS3.p3.8.m4.1.1.4.2">𝑚</ci><apply id="S3.SS3.p3.8.m4.1.1.4.3.cmml" xref="S3.SS3.p3.8.m4.1.1.4.3"><times id="S3.SS3.p3.8.m4.1.1.4.3.1.cmml" xref="S3.SS3.p3.8.m4.1.1.4.3.1"></times><ci id="S3.SS3.p3.8.m4.1.1.4.3.2.cmml" xref="S3.SS3.p3.8.m4.1.1.4.3.2">𝑚</ci><ci id="S3.SS3.p3.8.m4.1.1.4.3.3.cmml" xref="S3.SS3.p3.8.m4.1.1.4.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m4.1c">Dim_{mw}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.8.m4.1d">italic_D italic_i italic_m start_POSTSUBSCRIPT italic_m italic_w end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="Dim_{mb}" class="ltx_Math" display="inline" id="S3.SS3.p3.9.m5.1"><semantics id="S3.SS3.p3.9.m5.1a"><mrow id="S3.SS3.p3.9.m5.1.1" xref="S3.SS3.p3.9.m5.1.1.cmml"><mi id="S3.SS3.p3.9.m5.1.1.2" xref="S3.SS3.p3.9.m5.1.1.2.cmml">D</mi><mo id="S3.SS3.p3.9.m5.1.1.1" xref="S3.SS3.p3.9.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS3.p3.9.m5.1.1.3" xref="S3.SS3.p3.9.m5.1.1.3.cmml">i</mi><mo id="S3.SS3.p3.9.m5.1.1.1a" xref="S3.SS3.p3.9.m5.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p3.9.m5.1.1.4" xref="S3.SS3.p3.9.m5.1.1.4.cmml"><mi id="S3.SS3.p3.9.m5.1.1.4.2" xref="S3.SS3.p3.9.m5.1.1.4.2.cmml">m</mi><mrow id="S3.SS3.p3.9.m5.1.1.4.3" xref="S3.SS3.p3.9.m5.1.1.4.3.cmml"><mi id="S3.SS3.p3.9.m5.1.1.4.3.2" xref="S3.SS3.p3.9.m5.1.1.4.3.2.cmml">m</mi><mo id="S3.SS3.p3.9.m5.1.1.4.3.1" xref="S3.SS3.p3.9.m5.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.9.m5.1.1.4.3.3" xref="S3.SS3.p3.9.m5.1.1.4.3.3.cmml">b</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m5.1b"><apply id="S3.SS3.p3.9.m5.1.1.cmml" xref="S3.SS3.p3.9.m5.1.1"><times id="S3.SS3.p3.9.m5.1.1.1.cmml" xref="S3.SS3.p3.9.m5.1.1.1"></times><ci id="S3.SS3.p3.9.m5.1.1.2.cmml" xref="S3.SS3.p3.9.m5.1.1.2">𝐷</ci><ci id="S3.SS3.p3.9.m5.1.1.3.cmml" xref="S3.SS3.p3.9.m5.1.1.3">𝑖</ci><apply id="S3.SS3.p3.9.m5.1.1.4.cmml" xref="S3.SS3.p3.9.m5.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m5.1.1.4.1.cmml" xref="S3.SS3.p3.9.m5.1.1.4">subscript</csymbol><ci id="S3.SS3.p3.9.m5.1.1.4.2.cmml" xref="S3.SS3.p3.9.m5.1.1.4.2">𝑚</ci><apply id="S3.SS3.p3.9.m5.1.1.4.3.cmml" xref="S3.SS3.p3.9.m5.1.1.4.3"><times id="S3.SS3.p3.9.m5.1.1.4.3.1.cmml" xref="S3.SS3.p3.9.m5.1.1.4.3.1"></times><ci id="S3.SS3.p3.9.m5.1.1.4.3.2.cmml" xref="S3.SS3.p3.9.m5.1.1.4.3.2">𝑚</ci><ci id="S3.SS3.p3.9.m5.1.1.4.3.3.cmml" xref="S3.SS3.p3.9.m5.1.1.4.3.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m5.1c">Dim_{mb}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.9.m5.1d">italic_D italic_i italic_m start_POSTSUBSCRIPT italic_m italic_b end_POSTSUBSCRIPT</annotation></semantics></math> equals to the sum of dimensions of all <math alttext="\bm{W}_{l}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p3.10.m6.1"><semantics id="S3.SS3.p3.10.m6.1a"><msubsup id="S3.SS3.p3.10.m6.1.2" xref="S3.SS3.p3.10.m6.1.2.cmml"><mi id="S3.SS3.p3.10.m6.1.2.2.2" xref="S3.SS3.p3.10.m6.1.2.2.2.cmml">𝑾</mi><mi id="S3.SS3.p3.10.m6.1.2.2.3" xref="S3.SS3.p3.10.m6.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.p3.10.m6.1.1.1.3" xref="S3.SS3.p3.10.m6.1.2.cmml"><mo id="S3.SS3.p3.10.m6.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.10.m6.1.2.cmml">(</mo><mi id="S3.SS3.p3.10.m6.1.1.1.1" xref="S3.SS3.p3.10.m6.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.10.m6.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.10.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m6.1b"><apply id="S3.SS3.p3.10.m6.1.2.cmml" xref="S3.SS3.p3.10.m6.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m6.1.2.1.cmml" xref="S3.SS3.p3.10.m6.1.2">superscript</csymbol><apply id="S3.SS3.p3.10.m6.1.2.2.cmml" xref="S3.SS3.p3.10.m6.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m6.1.2.2.1.cmml" xref="S3.SS3.p3.10.m6.1.2">subscript</csymbol><ci id="S3.SS3.p3.10.m6.1.2.2.2.cmml" xref="S3.SS3.p3.10.m6.1.2.2.2">𝑾</ci><ci id="S3.SS3.p3.10.m6.1.2.2.3.cmml" xref="S3.SS3.p3.10.m6.1.2.2.3">𝑙</ci></apply><ci id="S3.SS3.p3.10.m6.1.1.1.1.cmml" xref="S3.SS3.p3.10.m6.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m6.1c">\bm{W}_{l}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.10.m6.1d">bold_italic_W start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\bm{b}_{l}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p3.11.m7.1"><semantics id="S3.SS3.p3.11.m7.1a"><msubsup id="S3.SS3.p3.11.m7.1.2" xref="S3.SS3.p3.11.m7.1.2.cmml"><mi id="S3.SS3.p3.11.m7.1.2.2.2" xref="S3.SS3.p3.11.m7.1.2.2.2.cmml">𝒃</mi><mi id="S3.SS3.p3.11.m7.1.2.2.3" xref="S3.SS3.p3.11.m7.1.2.2.3.cmml">l</mi><mrow id="S3.SS3.p3.11.m7.1.1.1.3" xref="S3.SS3.p3.11.m7.1.2.cmml"><mo id="S3.SS3.p3.11.m7.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.11.m7.1.2.cmml">(</mo><mi id="S3.SS3.p3.11.m7.1.1.1.1" xref="S3.SS3.p3.11.m7.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.11.m7.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.11.m7.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m7.1b"><apply id="S3.SS3.p3.11.m7.1.2.cmml" xref="S3.SS3.p3.11.m7.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m7.1.2.1.cmml" xref="S3.SS3.p3.11.m7.1.2">superscript</csymbol><apply id="S3.SS3.p3.11.m7.1.2.2.cmml" xref="S3.SS3.p3.11.m7.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.11.m7.1.2.2.1.cmml" xref="S3.SS3.p3.11.m7.1.2">subscript</csymbol><ci id="S3.SS3.p3.11.m7.1.2.2.2.cmml" xref="S3.SS3.p3.11.m7.1.2.2.2">𝒃</ci><ci id="S3.SS3.p3.11.m7.1.2.2.3.cmml" xref="S3.SS3.p3.11.m7.1.2.2.3">𝑙</ci></apply><ci id="S3.SS3.p3.11.m7.1.1.1.1.cmml" xref="S3.SS3.p3.11.m7.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m7.1c">\bm{b}_{l}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.11.m7.1d">bold_italic_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>, respectively. For example, <math alttext="\bm{h}_{mw}" class="ltx_Math" display="inline" id="S3.SS3.p3.12.m8.1"><semantics id="S3.SS3.p3.12.m8.1a"><msub id="S3.SS3.p3.12.m8.1.1" xref="S3.SS3.p3.12.m8.1.1.cmml"><mi id="S3.SS3.p3.12.m8.1.1.2" xref="S3.SS3.p3.12.m8.1.1.2.cmml">𝒉</mi><mrow id="S3.SS3.p3.12.m8.1.1.3" xref="S3.SS3.p3.12.m8.1.1.3.cmml"><mi id="S3.SS3.p3.12.m8.1.1.3.2" xref="S3.SS3.p3.12.m8.1.1.3.2.cmml">m</mi><mo id="S3.SS3.p3.12.m8.1.1.3.1" xref="S3.SS3.p3.12.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p3.12.m8.1.1.3.3" xref="S3.SS3.p3.12.m8.1.1.3.3.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.12.m8.1b"><apply id="S3.SS3.p3.12.m8.1.1.cmml" xref="S3.SS3.p3.12.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.12.m8.1.1.1.cmml" xref="S3.SS3.p3.12.m8.1.1">subscript</csymbol><ci id="S3.SS3.p3.12.m8.1.1.2.cmml" xref="S3.SS3.p3.12.m8.1.1.2">𝒉</ci><apply id="S3.SS3.p3.12.m8.1.1.3.cmml" xref="S3.SS3.p3.12.m8.1.1.3"><times id="S3.SS3.p3.12.m8.1.1.3.1.cmml" xref="S3.SS3.p3.12.m8.1.1.3.1"></times><ci id="S3.SS3.p3.12.m8.1.1.3.2.cmml" xref="S3.SS3.p3.12.m8.1.1.3.2">𝑚</ci><ci id="S3.SS3.p3.12.m8.1.1.3.3.cmml" xref="S3.SS3.p3.12.m8.1.1.3.3">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.12.m8.1c">\bm{h}_{mw}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.12.m8.1d">bold_italic_h start_POSTSUBSCRIPT italic_m italic_w end_POSTSUBSCRIPT</annotation></semantics></math> with the dimension of 8256 can be reshaped into a weight matrix with dimension 128<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS3.p3.13.m9.1"><semantics id="S3.SS3.p3.13.m9.1a"><mo id="S3.SS3.p3.13.m9.1.1" xref="S3.SS3.p3.13.m9.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.13.m9.1b"><times id="S3.SS3.p3.13.m9.1.1.cmml" xref="S3.SS3.p3.13.m9.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.13.m9.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.13.m9.1d">×</annotation></semantics></math>64 plus a weight matrix with dimension 64<math alttext="\times" class="ltx_Math" display="inline" id="S3.SS3.p3.14.m10.1"><semantics id="S3.SS3.p3.14.m10.1a"><mo id="S3.SS3.p3.14.m10.1.1" xref="S3.SS3.p3.14.m10.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.14.m10.1b"><times id="S3.SS3.p3.14.m10.1.1.cmml" xref="S3.SS3.p3.14.m10.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.14.m10.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.14.m10.1d">×</annotation></semantics></math>1 (bias matrix is similar). Then each meta layer is followed by an activation function <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS3.p3.15.m11.1"><semantics id="S3.SS3.p3.15.m11.1a"><mi id="S3.SS3.p3.15.m11.1.1" xref="S3.SS3.p3.15.m11.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.15.m11.1b"><ci id="S3.SS3.p3.15.m11.1.1.cmml" xref="S3.SS3.p3.15.m11.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.15.m11.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.15.m11.1d">italic_σ</annotation></semantics></math> like ReLU:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{h}^{(i)}=\sigma(\bm{W}_{l}^{(i)}\bm{h}^{(i-1)}+\bm{b}_{l}^{(i)}),i\in\{1,2%
,\ldots,K\}" class="ltx_Math" display="block" id="S3.E7.m1.10"><semantics id="S3.E7.m1.10a"><mrow id="S3.E7.m1.10.10.2" xref="S3.E7.m1.10.10.3.cmml"><mrow id="S3.E7.m1.9.9.1.1" xref="S3.E7.m1.9.9.1.1.cmml"><msup id="S3.E7.m1.9.9.1.1.3" xref="S3.E7.m1.9.9.1.1.3.cmml"><mi id="S3.E7.m1.9.9.1.1.3.2" xref="S3.E7.m1.9.9.1.1.3.2.cmml">𝒉</mi><mrow id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.9.9.1.1.3.cmml"><mo id="S3.E7.m1.1.1.1.3.1" stretchy="false" xref="S3.E7.m1.9.9.1.1.3.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.1.1.1.3.2" stretchy="false" xref="S3.E7.m1.9.9.1.1.3.cmml">)</mo></mrow></msup><mo id="S3.E7.m1.9.9.1.1.2" xref="S3.E7.m1.9.9.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.9.9.1.1.1" xref="S3.E7.m1.9.9.1.1.1.cmml"><mi id="S3.E7.m1.9.9.1.1.1.3" xref="S3.E7.m1.9.9.1.1.1.3.cmml">σ</mi><mo id="S3.E7.m1.9.9.1.1.1.2" xref="S3.E7.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.9.9.1.1.1.1.1" xref="S3.E7.m1.9.9.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.9.9.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.9.9.1.1.1.1.1.1" xref="S3.E7.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.9.9.1.1.1.1.1.1.2" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.2" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.2.cmml">𝑾</mi><mi id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.3" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.3.cmml">l</mi><mrow id="S3.E7.m1.2.2.1.3" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.cmml"><mo id="S3.E7.m1.2.2.1.3.1" stretchy="false" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.cmml">(</mo><mi id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml">i</mi><mo id="S3.E7.m1.2.2.1.3.2" stretchy="false" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.E7.m1.9.9.1.1.1.1.1.1.2.1" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.1.cmml">⁢</mo><msup id="S3.E7.m1.9.9.1.1.1.1.1.1.2.3" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.9.9.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.3.2.cmml">𝒉</mi><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.1.cmml"><mo id="S3.E7.m1.3.3.1.1.2" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.2.cmml">i</mi><mo id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml">−</mo><mn id="S3.E7.m1.3.3.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S3.E7.m1.3.3.1.1.3" stretchy="false" xref="S3.E7.m1.3.3.1.1.1.cmml">)</mo></mrow></msup></mrow><mo id="S3.E7.m1.9.9.1.1.1.1.1.1.1" xref="S3.E7.m1.9.9.1.1.1.1.1.1.1.cmml">+</mo><msubsup id="S3.E7.m1.9.9.1.1.1.1.1.1.3" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.2" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.2.cmml">𝒃</mi><mi id="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.3" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.3.cmml">l</mi><mrow id="S3.E7.m1.4.4.1.3" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3.cmml"><mo id="S3.E7.m1.4.4.1.3.1" stretchy="false" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E7.m1.4.4.1.1" xref="S3.E7.m1.4.4.1.1.cmml">i</mi><mo id="S3.E7.m1.4.4.1.3.2" stretchy="false" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E7.m1.9.9.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.10.10.2.3" xref="S3.E7.m1.10.10.3a.cmml">,</mo><mrow id="S3.E7.m1.10.10.2.2" xref="S3.E7.m1.10.10.2.2.cmml"><mi id="S3.E7.m1.10.10.2.2.2" xref="S3.E7.m1.10.10.2.2.2.cmml">i</mi><mo id="S3.E7.m1.10.10.2.2.1" xref="S3.E7.m1.10.10.2.2.1.cmml">∈</mo><mrow id="S3.E7.m1.10.10.2.2.3.2" xref="S3.E7.m1.10.10.2.2.3.1.cmml"><mo id="S3.E7.m1.10.10.2.2.3.2.1" stretchy="false" xref="S3.E7.m1.10.10.2.2.3.1.cmml">{</mo><mn id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml">1</mn><mo id="S3.E7.m1.10.10.2.2.3.2.2" xref="S3.E7.m1.10.10.2.2.3.1.cmml">,</mo><mn id="S3.E7.m1.6.6" xref="S3.E7.m1.6.6.cmml">2</mn><mo id="S3.E7.m1.10.10.2.2.3.2.3" xref="S3.E7.m1.10.10.2.2.3.1.cmml">,</mo><mi id="S3.E7.m1.7.7" mathvariant="normal" xref="S3.E7.m1.7.7.cmml">…</mi><mo id="S3.E7.m1.10.10.2.2.3.2.4" xref="S3.E7.m1.10.10.2.2.3.1.cmml">,</mo><mi id="S3.E7.m1.8.8" xref="S3.E7.m1.8.8.cmml">K</mi><mo id="S3.E7.m1.10.10.2.2.3.2.5" stretchy="false" xref="S3.E7.m1.10.10.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.10b"><apply id="S3.E7.m1.10.10.3.cmml" xref="S3.E7.m1.10.10.2"><csymbol cd="ambiguous" id="S3.E7.m1.10.10.3a.cmml" xref="S3.E7.m1.10.10.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.9.9.1.1.cmml" xref="S3.E7.m1.9.9.1.1"><eq id="S3.E7.m1.9.9.1.1.2.cmml" xref="S3.E7.m1.9.9.1.1.2"></eq><apply id="S3.E7.m1.9.9.1.1.3.cmml" xref="S3.E7.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.1.1.3.1.cmml" xref="S3.E7.m1.9.9.1.1.3">superscript</csymbol><ci id="S3.E7.m1.9.9.1.1.3.2.cmml" xref="S3.E7.m1.9.9.1.1.3.2">𝒉</ci><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E7.m1.9.9.1.1.1.cmml" xref="S3.E7.m1.9.9.1.1.1"><times id="S3.E7.m1.9.9.1.1.1.2.cmml" xref="S3.E7.m1.9.9.1.1.1.2"></times><ci id="S3.E7.m1.9.9.1.1.1.3.cmml" xref="S3.E7.m1.9.9.1.1.1.3">𝜎</ci><apply id="S3.E7.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1"><plus id="S3.E7.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.1"></plus><apply id="S3.E7.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2"><times id="S3.E7.m1.9.9.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.1"></times><apply id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.2">𝑾</ci><ci id="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply><ci id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.E7.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.3">superscript</csymbol><ci id="S3.E7.m1.9.9.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.2.3.2">𝒉</ci><apply id="S3.E7.m1.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1"><minus id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"></minus><ci id="S3.E7.m1.3.3.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.2">𝑖</ci><cn id="S3.E7.m1.3.3.1.1.1.3.cmml" type="integer" xref="S3.E7.m1.3.3.1.1.1.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.2">𝒃</ci><ci id="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.9.9.1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.E7.m1.4.4.1.1.cmml" xref="S3.E7.m1.4.4.1.1">𝑖</ci></apply></apply></apply></apply><apply id="S3.E7.m1.10.10.2.2.cmml" xref="S3.E7.m1.10.10.2.2"><in id="S3.E7.m1.10.10.2.2.1.cmml" xref="S3.E7.m1.10.10.2.2.1"></in><ci id="S3.E7.m1.10.10.2.2.2.cmml" xref="S3.E7.m1.10.10.2.2.2">𝑖</ci><set id="S3.E7.m1.10.10.2.2.3.1.cmml" xref="S3.E7.m1.10.10.2.2.3.2"><cn id="S3.E7.m1.5.5.cmml" type="integer" xref="S3.E7.m1.5.5">1</cn><cn id="S3.E7.m1.6.6.cmml" type="integer" xref="S3.E7.m1.6.6">2</cn><ci id="S3.E7.m1.7.7.cmml" xref="S3.E7.m1.7.7">…</ci><ci id="S3.E7.m1.8.8.cmml" xref="S3.E7.m1.8.8">𝐾</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.10c">\bm{h}^{(i)}=\sigma(\bm{W}_{l}^{(i)}\bm{h}^{(i-1)}+\bm{b}_{l}^{(i)}),i\in\{1,2%
,\ldots,K\}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.10d">bold_italic_h start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_σ ( bold_italic_W start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT bold_italic_h start_POSTSUPERSCRIPT ( italic_i - 1 ) end_POSTSUPERSCRIPT + bold_italic_b start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ) , italic_i ∈ { 1 , 2 , … , italic_K }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.19">where <math alttext="\bm{h}^{(i)}" class="ltx_Math" display="inline" id="S3.SS3.p3.16.m1.1"><semantics id="S3.SS3.p3.16.m1.1a"><msup id="S3.SS3.p3.16.m1.1.2" xref="S3.SS3.p3.16.m1.1.2.cmml"><mi id="S3.SS3.p3.16.m1.1.2.2" xref="S3.SS3.p3.16.m1.1.2.2.cmml">𝒉</mi><mrow id="S3.SS3.p3.16.m1.1.1.1.3" xref="S3.SS3.p3.16.m1.1.2.cmml"><mo id="S3.SS3.p3.16.m1.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.16.m1.1.2.cmml">(</mo><mi id="S3.SS3.p3.16.m1.1.1.1.1" xref="S3.SS3.p3.16.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p3.16.m1.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.16.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.16.m1.1b"><apply id="S3.SS3.p3.16.m1.1.2.cmml" xref="S3.SS3.p3.16.m1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.16.m1.1.2.1.cmml" xref="S3.SS3.p3.16.m1.1.2">superscript</csymbol><ci id="S3.SS3.p3.16.m1.1.2.2.cmml" xref="S3.SS3.p3.16.m1.1.2.2">𝒉</ci><ci id="S3.SS3.p3.16.m1.1.1.1.1.cmml" xref="S3.SS3.p3.16.m1.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.16.m1.1c">\bm{h}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.16.m1.1d">bold_italic_h start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.17.m2.1"><semantics id="S3.SS3.p3.17.m2.1a"><mi id="S3.SS3.p3.17.m2.1.1" xref="S3.SS3.p3.17.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.17.m2.1b"><ci id="S3.SS3.p3.17.m2.1.1.cmml" xref="S3.SS3.p3.17.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.17.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.17.m2.1d">italic_i</annotation></semantics></math>-th meta layer.
Afterward, the feature embedding <math alttext="\bm{e}" class="ltx_Math" display="inline" id="S3.SS3.p3.18.m3.1"><semantics id="S3.SS3.p3.18.m3.1a"><mi id="S3.SS3.p3.18.m3.1.1" xref="S3.SS3.p3.18.m3.1.1.cmml">𝒆</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.18.m3.1b"><ci id="S3.SS3.p3.18.m3.1.1.cmml" xref="S3.SS3.p3.18.m3.1.1">𝒆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.18.m3.1c">\bm{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.18.m3.1d">bold_italic_e</annotation></semantics></math>, which is exactly <math alttext="\bm{h}^{(0)}" class="ltx_Math" display="inline" id="S3.SS3.p3.19.m4.1"><semantics id="S3.SS3.p3.19.m4.1a"><msup id="S3.SS3.p3.19.m4.1.2" xref="S3.SS3.p3.19.m4.1.2.cmml"><mi id="S3.SS3.p3.19.m4.1.2.2" xref="S3.SS3.p3.19.m4.1.2.2.cmml">𝒉</mi><mrow id="S3.SS3.p3.19.m4.1.1.1.3" xref="S3.SS3.p3.19.m4.1.2.cmml"><mo id="S3.SS3.p3.19.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.p3.19.m4.1.2.cmml">(</mo><mn id="S3.SS3.p3.19.m4.1.1.1.1" xref="S3.SS3.p3.19.m4.1.1.1.1.cmml">0</mn><mo id="S3.SS3.p3.19.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.p3.19.m4.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.19.m4.1b"><apply id="S3.SS3.p3.19.m4.1.2.cmml" xref="S3.SS3.p3.19.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.19.m4.1.2.1.cmml" xref="S3.SS3.p3.19.m4.1.2">superscript</csymbol><ci id="S3.SS3.p3.19.m4.1.2.2.cmml" xref="S3.SS3.p3.19.m4.1.2.2">𝒉</ci><cn id="S3.SS3.p3.19.m4.1.1.1.1.cmml" type="integer" xref="S3.SS3.p3.19.m4.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.19.m4.1c">\bm{h}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.19.m4.1d">bold_italic_h start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math>, is transferred into the obtained meta layers. Finally, the prediction result is calculated by combining the output of the parallel scenario-level meta layers and the result from MSR backbone
in an adaptive manner:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\bm{h}=\operatorname{MSR}(\bm{h}_{u}^{(K)})," class="ltx_Math" display="block" id="S3.E8.m1.3"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.3" xref="S3.E8.m1.3.3.1.1.3.cmml">𝒉</mi><mo id="S3.E8.m1.3.3.1.1.2" xref="S3.E8.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.3.3.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.2.cmml"><mi id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml">MSR</mi><mo id="S3.E8.m1.3.3.1.1.1.1a" xref="S3.E8.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.2.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.2.cmml">(</mo><msubsup id="S3.E8.m1.3.3.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.2.cmml">𝒉</mi><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.cmml">u</mi><mrow id="S3.E8.m1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.1.1.1.3.1" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">K</mi><mo id="S3.E8.m1.1.1.1.3.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.E8.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.2" xref="S3.E8.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1"><eq id="S3.E8.m1.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2"></eq><ci id="S3.E8.m1.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.3">𝒉</ci><apply id="S3.E8.m1.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1"><ci id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2">MSR</ci><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.2">𝒉</ci><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\bm{h}=\operatorname{MSR}(\bm{h}_{u}^{(K)}),</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.3d">bold_italic_h = roman_MSR ( bold_italic_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_K ) end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}=\sigma^{\prime}(\alpha\cdot\bm{h}_{s}^{(K)}+(1-\alpha)\cdot\bm{h})," class="ltx_Math" display="block" id="S3.E9.m1.2"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.2.1" xref="S3.E9.m1.2.2.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1" xref="S3.E9.m1.2.2.1.1.cmml"><mover accent="true" id="S3.E9.m1.2.2.1.1.3" xref="S3.E9.m1.2.2.1.1.3.cmml"><mi id="S3.E9.m1.2.2.1.1.3.2" xref="S3.E9.m1.2.2.1.1.3.2.cmml">y</mi><mo id="S3.E9.m1.2.2.1.1.3.1" xref="S3.E9.m1.2.2.1.1.3.1.cmml">^</mo></mover><mo id="S3.E9.m1.2.2.1.1.2" xref="S3.E9.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.2.2.1.1.1" xref="S3.E9.m1.2.2.1.1.1.cmml"><msup id="S3.E9.m1.2.2.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.3.cmml"><mi id="S3.E9.m1.2.2.1.1.1.3.2" xref="S3.E9.m1.2.2.1.1.1.3.2.cmml">σ</mi><mo id="S3.E9.m1.2.2.1.1.1.3.3" xref="S3.E9.m1.2.2.1.1.1.3.3.cmml">′</mo></msup><mo id="S3.E9.m1.2.2.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.2.cmml">α</mi><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.1.cmml">⋅</mo><msubsup id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.2.cmml">𝒉</mi><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.3.cmml">s</mi><mrow id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mo id="S3.E9.m1.1.1.1.3.1" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml">(</mo><mi id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml">K</mi><mo id="S3.E9.m1.1.1.1.3.2" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E9.m1.2.2.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.2.cmml">⋅</mo><mi id="S3.E9.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.3.cmml">𝒉</mi></mrow></mrow><mo id="S3.E9.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m1.2.2.1.2" xref="S3.E9.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.2.1.1.cmml" xref="S3.E9.m1.2.2.1"><eq id="S3.E9.m1.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.2"></eq><apply id="S3.E9.m1.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.3"><ci id="S3.E9.m1.2.2.1.1.3.1.cmml" xref="S3.E9.m1.2.2.1.1.3.1">^</ci><ci id="S3.E9.m1.2.2.1.1.3.2.cmml" xref="S3.E9.m1.2.2.1.1.3.2">𝑦</ci></apply><apply id="S3.E9.m1.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1"><times id="S3.E9.m1.2.2.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.2"></times><apply id="S3.E9.m1.2.2.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.3.1.cmml" xref="S3.E9.m1.2.2.1.1.1.3">superscript</csymbol><ci id="S3.E9.m1.2.2.1.1.1.3.2.cmml" xref="S3.E9.m1.2.2.1.1.1.3.2">𝜎</ci><ci id="S3.E9.m1.2.2.1.1.1.3.3.cmml" xref="S3.E9.m1.2.2.1.1.1.3.3">′</ci></apply><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1"><plus id="S3.E9.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.2"></plus><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3"><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.1">⋅</ci><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.2">𝛼</ci><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.2">𝒉</ci><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.3.3.2.3">𝑠</ci></apply><ci id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1">𝐾</ci></apply></apply><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1"><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1"><minus id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝛼</ci></apply><ci id="S3.E9.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.1.1.3">𝒉</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">\hat{y}=\sigma^{\prime}(\alpha\cdot\bm{h}_{s}^{(K)}+(1-\alpha)\cdot\bm{h}),</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.2d">over^ start_ARG italic_y end_ARG = italic_σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_α ⋅ bold_italic_h start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_K ) end_POSTSUPERSCRIPT + ( 1 - italic_α ) ⋅ bold_italic_h ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.7">where <math alttext="\bm{h}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.m1.1"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">𝒉</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝒉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\bm{h}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.m1.1d">bold_italic_h</annotation></semantics></math> is the output hidden vector of the MSR backbone model, <math alttext="\bm{h}_{u}^{(K)}" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m2.1"><semantics id="S3.SS3.p4.2.m2.1a"><msubsup id="S3.SS3.p4.2.m2.1.2" xref="S3.SS3.p4.2.m2.1.2.cmml"><mi id="S3.SS3.p4.2.m2.1.2.2.2" xref="S3.SS3.p4.2.m2.1.2.2.2.cmml">𝒉</mi><mi id="S3.SS3.p4.2.m2.1.2.2.3" xref="S3.SS3.p4.2.m2.1.2.2.3.cmml">u</mi><mrow id="S3.SS3.p4.2.m2.1.1.1.3" xref="S3.SS3.p4.2.m2.1.2.cmml"><mo id="S3.SS3.p4.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.2.m2.1.2.cmml">(</mo><mi id="S3.SS3.p4.2.m2.1.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.1.cmml">K</mi><mo id="S3.SS3.p4.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.2.cmml" xref="S3.SS3.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.2.1.cmml" xref="S3.SS3.p4.2.m2.1.2">superscript</csymbol><apply id="S3.SS3.p4.2.m2.1.2.2.cmml" xref="S3.SS3.p4.2.m2.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m2.1.2.2.1.cmml" xref="S3.SS3.p4.2.m2.1.2">subscript</csymbol><ci id="S3.SS3.p4.2.m2.1.2.2.2.cmml" xref="S3.SS3.p4.2.m2.1.2.2.2">𝒉</ci><ci id="S3.SS3.p4.2.m2.1.2.2.3.cmml" xref="S3.SS3.p4.2.m2.1.2.2.3">𝑢</ci></apply><ci id="S3.SS3.p4.2.m2.1.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1.1">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\bm{h}_{u}^{(K)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m2.1d">bold_italic_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_K ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of the <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m3.1"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m3.1d">italic_K</annotation></semantics></math>-th user-level meta layer, <math alttext="\bm{h}_{s}^{(K)}" class="ltx_Math" display="inline" id="S3.SS3.p4.4.m4.1"><semantics id="S3.SS3.p4.4.m4.1a"><msubsup id="S3.SS3.p4.4.m4.1.2" xref="S3.SS3.p4.4.m4.1.2.cmml"><mi id="S3.SS3.p4.4.m4.1.2.2.2" xref="S3.SS3.p4.4.m4.1.2.2.2.cmml">𝒉</mi><mi id="S3.SS3.p4.4.m4.1.2.2.3" xref="S3.SS3.p4.4.m4.1.2.2.3.cmml">s</mi><mrow id="S3.SS3.p4.4.m4.1.1.1.3" xref="S3.SS3.p4.4.m4.1.2.cmml"><mo id="S3.SS3.p4.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.p4.4.m4.1.2.cmml">(</mo><mi id="S3.SS3.p4.4.m4.1.1.1.1" xref="S3.SS3.p4.4.m4.1.1.1.1.cmml">K</mi><mo id="S3.SS3.p4.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.p4.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><apply id="S3.SS3.p4.4.m4.1.2.cmml" xref="S3.SS3.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.2.1.cmml" xref="S3.SS3.p4.4.m4.1.2">superscript</csymbol><apply id="S3.SS3.p4.4.m4.1.2.2.cmml" xref="S3.SS3.p4.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS3.p4.4.m4.1.2.2.1.cmml" xref="S3.SS3.p4.4.m4.1.2">subscript</csymbol><ci id="S3.SS3.p4.4.m4.1.2.2.2.cmml" xref="S3.SS3.p4.4.m4.1.2.2.2">𝒉</ci><ci id="S3.SS3.p4.4.m4.1.2.2.3.cmml" xref="S3.SS3.p4.4.m4.1.2.2.3">𝑠</ci></apply><ci id="S3.SS3.p4.4.m4.1.1.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1.1.1">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">\bm{h}_{s}^{(K)}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.4.m4.1d">bold_italic_h start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_K ) end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of the <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.p4.5.m5.1"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.5.m5.1d">italic_K</annotation></semantics></math>-th scenario-level meta layer, <math alttext="\sigma^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.p4.6.m6.1"><semantics id="S3.SS3.p4.6.m6.1a"><msup id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml"><mi id="S3.SS3.p4.6.m6.1.1.2" xref="S3.SS3.p4.6.m6.1.1.2.cmml">σ</mi><mo id="S3.SS3.p4.6.m6.1.1.3" xref="S3.SS3.p4.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><apply id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.6.m6.1.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">superscript</csymbol><ci id="S3.SS3.p4.6.m6.1.1.2.cmml" xref="S3.SS3.p4.6.m6.1.1.2">𝜎</ci><ci id="S3.SS3.p4.6.m6.1.1.3.cmml" xref="S3.SS3.p4.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">\sigma^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.6.m6.1d">italic_σ start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the activation function for the final task (e.g., sigmoid function for CTR prediction task), and <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS3.p4.7.m7.1"><semantics id="S3.SS3.p4.7.m7.1a"><mi id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><ci id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.7.m7.1d">italic_α</annotation></semantics></math> is a learnable parameter.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Discussion</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">In the following part, we first illustrate the idea of the proposed LLM4MSR paradigm, then compare it with the mainstream multi-scenario RSs and the LLM-based recommendation methods, and finally demonstrate the necessity of LLM here compared with PLM.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">Basically, rather than designing a specific multi-scenario recommendation model architecture, our goal is to propose a general multi-scenario enhancement paradigm.
Specifically, considering the model architecture and optimization, LLM4MSR does not impose any restrictions on the multi-scenario backbone models, thus being model-agnostic.
Meanwhile, for LLM the most two significant questions are: (i) <span class="ltx_text ltx_font_bold" id="S3.SS4.p2.1.1">WHAT</span> information can be obtained from LLM and (ii) <span class="ltx_text ltx_font_bold" id="S3.SS4.p2.1.2">HOW</span> to use it to bring information gain, which correspond to the multi-scenario knowledge reasoning and multi-level knowledge fusion steps proposed in our LLM4MSR.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p3.1.1">LLM4MSR v.s. multi-scenario RS.</span>
Conventional multi-scenario RSs treat the domain indicator either as a distinct feature <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>)</cite> or as the only scenario knowledge to generate scenario-specific module <cite class="ltx_cite ltx_citemacro_citep">(Gao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib12" title="">2023</a>)</cite>, and adopt different parameter sharing patterns to model scenario correlations where only the collaborative signal is learned.
By contrast, LLM4MSR generates LLM-enhanced scenario- and user-level representation from the semantic space, then it dynamically generates meta layers to effectively and efficiently combine with the multi-scenario RS based on these representations.
Consequently, the LLM-augmented information is flexibly fused with the collaborative signal in conventional RS, thus achieving enhancement.
</p>
</div>
<div class="ltx_para" id="S3.SS4.p4">
<p class="ltx_p" id="S3.SS4.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p4.1.1">LLM4MSR v.s. LLM-based RS.</span>
Existing LLM-based recommender systems can be categorized into two groups, i.e., using LLM as the knowledge enhancer <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib26" title="">2023b</a>; Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib18" title="">2023</a>; Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib14" title="">2023</a>)</cite> and directly as the recommender <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib13" title="">2022</a>; Cui et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib9" title="">2022</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib19" title="">2023</a>)</cite>.
However, the former models possess low efficiency since they require aligning the information from LLM and RS in the instance level.
Meanwhile, the latter methods lack scenario knowledge, thus achieving unsatisfying recommendation performance and suffering from high inference latency of LLM.</p>
</div>
<div class="ltx_para" id="S3.SS4.p5">
<p class="ltx_p" id="S3.SS4.p5.1">By contrast, LLM4MSR can efficiently and effectively tackle these problems.
First, thanks to the zero-shot capability <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib27" title="">2022b</a>)</cite>, an LLM with fixed parameters is leveraged free from tuning in <cite class="ltx_cite ltx_citemacro_citep">(Yin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib34" title="">2023</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib26" title="">2023b</a>)</cite>.
Meanwhile, the way of obtaining information from LLM is shifted from the low <span class="ltx_text ltx_font_bold" id="S3.SS4.p5.1.1">‘instance-level’</span> (e.g., in <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib26" title="">2023b</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib38" title="">2023</a>)</cite>) to the high <span class="ltx_text ltx_font_bold" id="S3.SS4.p5.1.2">‘user- &amp; scenario-level’</span>, thus improving efficiency.
Besides, through hierarchical meta networks, the multi-level scenario knowledge is adaptively injected and lead to enhancement.
Moreover, apart from distinct scenario-specific and user-specific features, it also enables to incorporate expert scenario knowledge through the prompt design, which is more universal and advanced than simply extracting invariant features and aligning the heterogeneous ones in <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib14" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS4.p6">
<p class="ltx_p" id="S3.SS4.p6.1"><span class="ltx_text ltx_font_bold" id="S3.SS4.p6.1.1">Necessity of LLMs v.s. PLMs.</span> As illustrated in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.SS3" title="2.3. Large Language Model ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">2.3</span></a>, Different training objectives of Large Language Models (LLMs) and Pre-trained Language Models (PLMs) determine their roles. Specifically, rather than simply deriving a representation of existing (old) information by adopting PLMs as <span class="ltx_text ltx_font_bold" id="S3.SS4.p6.1.2">encoder</span> (like BERT in CTRL <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>)</cite>), the key of leveraging LLM as <span class="ltx_text ltx_font_bold" id="S3.SS4.p6.1.3">reasoner</span> in LLM4MSR is to further infer useful (new) knowledge like analyzing user’s cross-scenario preference. This knowledge (in the form of hidden vectors) could potentially help enhancing conventional recommender systems. Besides, a case study is conducted in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS6" title="4.6. Case Study (RQ5) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4.6</span></a> and the knowledge (in the form of text) from ChatGLM2-6B is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.F5" title="Figure 5 ‣ 4.6. Case Study (RQ5) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>, which helps improving interpretability.</p>
</div>
<div class="ltx_para" id="S3.SS4.p7">
<p class="ltx_p" id="S3.SS4.p7.1">By contrast, we also adopt GPT-2 (a typical PLM) to reason about user_1’s interest given the same input prompt as in ChatGLM2-6B, and it generates the following nonsense text:</p>
</div>
<div class="ltx_para" id="S3.SS4.p8">
<pre class="ltx_verbatim ltx_font_typewriter" id="S3.SS4.p8.1">
"The main strategy of this study was to combine two
scenarios into a two-way analysis. The primary strategies
are presented in Table I. If the main scenario is presented
as a list of stories, then..."
</pre>
<p class="ltx_p" id="S3.SS4.p8.2">In that case, such information could not bring information gain and improve the recommendation performance.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Extensive experiments are conducted on three public datasets to verify the effectiveness and efficiency of our proposed LLM4MSR paradigm, and the following five questions are answered:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">RQ1:</span> Is LLM4MSR an effective paradigm and compatible with different multi-scenario backbone models?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">RQ2:</span> What is the effect of the scenario-level and user-level prompt? What is their optimal architecture correspondingly?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">RQ3:</span> What is the impact of interaction threshold and the number of neural network layers generated by the meta network?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.1.1">RQ4:</span> What is the efficiency of LLM4MSR compared with the original multi-scenario backbone models?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i5.p1">
<p class="ltx_p" id="S4.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i5.p1.1.1">RQ5:</span> How does LLM help improving the multi-scenario backbone models through our proposed LLM4MSR?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Experimental Settings</h3>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS1.1.1">Datasets</span>
</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">Our experiments are conducted on three datasets: KuaiSAR-small, KuaiSAR <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib24" title="">2023</a>)</cite>, and Amazon <cite class="ltx_cite ltx_citemacro_citep">(Ni et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib21" title="">2019</a>)</cite>. To be specific, there is a search and a recommendation scenario on KuaiSAR-small and KuaiSAR while there are three correlated recommendation scenarios selected on Amazon. Furthermore, their statistics and detailed descriptions are
summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.T1" title="Table 1 ‣ 4.1.1. Datasets ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. To be specific, we divide the original data into training, validation, and test set with the ratio of 8:1:1 by chronological order. Besides, the sparsity metric denotes the proportion of unclicked samples with label <math alttext="y=0" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.1.m1.1"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mrow id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml">y</mi><mo id="S4.SS1.SSS1.p1.1.m1.1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.SSS1.p1.1.m1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><eq id="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2">𝑦</ci><cn id="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">y=0</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.1.m1.1d">italic_y = 0</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">KuaiSAR-small &amp; KuaiSAR<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote2.1.1.1">2</span></span><span class="ltx_text ltx_font_medium" id="footnote2.5">https://kuaisar.github.io/</span></span></span></span></span> datasets are both crawled from the short-video platform Kuaishou. The only difference is KuaiSAR-small is a smaller version of data in 9 days while KuaiSAR is in 19 days. Specifically, all users are overlapped in the recommendation and search scenario. Meanwhile, there are 97981 and 181849 items overlapped on KuaiSAR-small and KuaiSAR, respectively.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">Amazon<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnote3.1.1.1">3</span></span><span class="ltx_text ltx_font_medium" id="footnote3.5">https://cseweb.ucsd.edu/~jmcauley/datasets/amazon_v2/</span></span></span></span></span> is collected from Amazon. Following <cite class="ltx_cite ltx_citemacro_citep">(Cui et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib8" title="">2020</a>)</cite>, we select three connected
scenarios: All Beauty, Clothing Shoes and Jewelry, and Luxury Beauty and we also filter the overlapped users among these scenarios without overlapped items.
The goal is to predict whether a user would give a rating (from 1 to 5) higher than 3 to an item.
</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>The statistics of KuaiSAR-small, KuaiSAR, and Amazon, where Rec denotes recommendation.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.3" style="width:206.0pt;height:69.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-56.3pt,19.1pt) scale(0.646491502490162,0.646491502490162) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.3.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.3.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T1.3.3.4.1.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.4.1.1.1" style="font-size:90%;">Dataset</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.3.3.4.1.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.4.1.2.1" style="font-size:90%;">KuaiSAR-small</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.3.3.4.1.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.4.1.3.1" style="font-size:90%;">KuaiSAR</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T1.3.3.4.1.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.4.1.4.1" style="font-size:90%;">Amazon</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.3.3.3.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.3.4.1" style="font-size:90%;">Scenarios</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.3.5.1" style="font-size:90%;">Rec</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.3.6.1" style="font-size:90%;">Search</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.3.7.1" style="font-size:90%;">Rec</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.3.8.1" style="font-size:90%;">Search</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text" id="S4.T1.1.1.1.1.1" style="font-size:90%;">Rec</span><math alttext="\#1" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mi id="S4.T1.1.1.1.1.m1.1.1.2" mathsize="90%" mathvariant="normal" xref="S4.T1.1.1.1.1.m1.1.1.2.cmml">#</mi><mo id="S4.T1.1.1.1.1.m1.1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.1.cmml">⁢</mo><mn id="S4.T1.1.1.1.1.m1.1.1.3" mathsize="90%" xref="S4.T1.1.1.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><times id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1.1"></times><ci id="S4.T1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2">#</ci><cn id="S4.T1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T1.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\#1</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d"># 1</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.2.2.2.2" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text" id="S4.T1.2.2.2.2.1" style="font-size:90%;">Rec</span><math alttext="\#2" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.2.m1.1a"><mrow id="S4.T1.2.2.2.2.m1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.cmml"><mi id="S4.T1.2.2.2.2.m1.1.1.2" mathsize="90%" mathvariant="normal" xref="S4.T1.2.2.2.2.m1.1.1.2.cmml">#</mi><mo id="S4.T1.2.2.2.2.m1.1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.1.cmml">⁢</mo><mn id="S4.T1.2.2.2.2.m1.1.1.3" mathsize="90%" xref="S4.T1.2.2.2.2.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1"><times id="S4.T1.2.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1.1"></times><ci id="S4.T1.2.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.2.m1.1.1.2">#</ci><cn id="S4.T1.2.2.2.2.m1.1.1.3.cmml" type="integer" xref="S4.T1.2.2.2.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.1c">\#2</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.m1.1d"># 2</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.3.3.3.3" style="padding-left:2.8pt;padding-right:2.8pt;">
<span class="ltx_text" id="S4.T1.3.3.3.3.1" style="font-size:90%;">Rec</span><math alttext="\#3" class="ltx_Math" display="inline" id="S4.T1.3.3.3.3.m1.1"><semantics id="S4.T1.3.3.3.3.m1.1a"><mrow id="S4.T1.3.3.3.3.m1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.cmml"><mi id="S4.T1.3.3.3.3.m1.1.1.2" mathsize="90%" mathvariant="normal" xref="S4.T1.3.3.3.3.m1.1.1.2.cmml">#</mi><mo id="S4.T1.3.3.3.3.m1.1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.1.cmml">⁢</mo><mn id="S4.T1.3.3.3.3.m1.1.1.3" mathsize="90%" xref="S4.T1.3.3.3.3.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.m1.1b"><apply id="S4.T1.3.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1"><times id="S4.T1.3.3.3.3.m1.1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1.1"></times><ci id="S4.T1.3.3.3.3.m1.1.1.2.cmml" xref="S4.T1.3.3.3.3.m1.1.1.2">#</ci><cn id="S4.T1.3.3.3.3.m1.1.1.3.cmml" type="integer" xref="S4.T1.3.3.3.3.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.m1.1c">\#3</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.3.m1.1d"># 3</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.5.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.3.3.5.2.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.5.2.1.1" style="font-size:90%;">Users</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5.2.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.5.2.2.1" style="font-size:90%;">25877</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5.2.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.5.2.3.1" style="font-size:90%;">25877</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5.2.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.5.2.4.1" style="font-size:90%;">25877</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5.2.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.5.2.5.1" style="font-size:90%;">25877</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5.2.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.5.2.6.1" style="font-size:90%;">24752</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5.2.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.5.2.7.1" style="font-size:90%;">24752</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5.2.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.5.2.8.1" style="font-size:90%;">24752</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.6.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.3.3.6.3.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.6.3.1.1" style="font-size:90%;">Items</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.6.3.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.6.3.2.1" style="font-size:90%;">2281034</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.6.3.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.6.3.3.1" style="font-size:90%;">1974165</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.6.3.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.6.3.4.1" style="font-size:90%;">4046363</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.6.3.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.6.3.5.1" style="font-size:90%;">2974596</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.6.3.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.6.3.6.1" style="font-size:90%;">8788</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.6.3.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.6.3.7.1" style="font-size:90%;">193304</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.6.3.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.6.3.8.1" style="font-size:90%;">6980</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.7.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.3.3.7.4.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.7.4.1.1" style="font-size:90%;">Interactions</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.4.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.7.4.2.1" style="font-size:90%;">7493101</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.4.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.7.4.3.1" style="font-size:90%;">3038362</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.4.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.7.4.4.1" style="font-size:90%;">14605712</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.4.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.7.4.5.1" style="font-size:90%;">4828690</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.4.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.7.4.6.1" style="font-size:90%;">33929</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.4.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.7.4.7.1" style="font-size:90%;">370840</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7.4.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.7.4.8.1" style="font-size:90%;">56356</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.8.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T1.3.3.8.5.1" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.8.5.1.1" style="font-size:90%;">Sparsity</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.8.5.2" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.8.5.2.1" style="font-size:90%;">50.49%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.8.5.3" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.8.5.3.1" style="font-size:90%;">87.87%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.8.5.4" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.8.5.4.1" style="font-size:90%;">50.40%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.8.5.5" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.8.5.5.1" style="font-size:90%;">87.88%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.8.5.6" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.8.5.6.1" style="font-size:90%;">21.50%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.8.5.7" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.8.5.7.1" style="font-size:90%;">19.61%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.3.3.8.5.8" style="padding-left:2.8pt;padding-right:2.8pt;"><span class="ltx_text" id="S4.T1.3.3.8.5.8.1" style="font-size:90%;">20.67%</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS2.1.1">Evaluation Metrics</span>
</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">Area Under the ROC curve (AUC) is adopted to conduct evaluation on the test set, where a higher AUC value at 0.001 level usually denotes significant enhancement <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib7" title="">2016</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib30" title="">2023c</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3. </span><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS3.1.1">Backbone Models</span>
</h4>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.1">We implement LLM4MSR on the following representative multi-scenario backbone models commonly deployed in industrial recommender system:</p>
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.1.1">STAR</span> <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>)</cite> proposes a star topology architecture with a shared centered network multiplied by many domain-specific networks.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.1.1">OMoE</span> <cite class="ltx_cite ltx_citemacro_citep">(Jacobs et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib15" title="">1991</a>)</cite> leverages a group of expert networks and a gating network learned to ensemble the results from these experts.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i3.p1">
<p class="ltx_p" id="S4.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i3.p1.1.1">MMoE</span> <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib20" title="">2018</a>)</cite> explicitly learns a gating network for each task to assemble task-specific information compared with OMoE.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i4.p1">
<p class="ltx_p" id="S4.I3.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i4.p1.1.1">PLE</span> <cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib25" title="">2020</a>)</cite> proposes Customized Gate Control (CGC) which separates shared and specific expert networks and employs multi-level extraction network with a progressive routing mechanism.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i5.p1">
<p class="ltx_p" id="S4.I3.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i5.p1.1.1">AITM</span> <cite class="ltx_cite ltx_citemacro_citep">(Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib31" title="">2021</a>)</cite> adaptively learns to transfer information for different tasks with sequential dependence.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i6.p1">
<p class="ltx_p" id="S4.I3.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I3.i6.p1.1.1">Shared Bottom</span> is a multi-task model where the embedding layer is usually shared on which task-specific networks are built.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.58.5.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S4.T2.8.4" style="font-size:90%;">Overall performance comparison of AUC on KuaiSAR-small, KuaiSAR, and Amazon dataset. The suffix ‘DN’, ‘EP’, and ‘ours’ denote Dynamic Network, EPNet, and LLM4MSR. Boldface denotes the highest value while underline indicates the second best result. <math alttext="\star" class="ltx_Math" display="inline" id="S4.T2.5.1.m1.1"><semantics id="S4.T2.5.1.m1.1b"><mo id="S4.T2.5.1.m1.1.1" xref="S4.T2.5.1.m1.1.1.cmml">⋆</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.1.m1.1c"><ci id="S4.T2.5.1.m1.1.1.cmml" xref="S4.T2.5.1.m1.1.1">⋆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.1.m1.1d">\star</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.1.m1.1e">⋆</annotation></semantics></math> represents statistical significance with <math alttext="p" class="ltx_Math" display="inline" id="S4.T2.6.2.m2.1"><semantics id="S4.T2.6.2.m2.1b"><mi id="S4.T2.6.2.m2.1.1" xref="S4.T2.6.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T2.6.2.m2.1c"><ci id="S4.T2.6.2.m2.1.1.cmml" xref="S4.T2.6.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.2.m2.1d">p</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.2.m2.1e">italic_p</annotation></semantics></math>-value <math alttext="&lt;0.05" class="ltx_Math" display="inline" id="S4.T2.7.3.m3.1"><semantics id="S4.T2.7.3.m3.1b"><mrow id="S4.T2.7.3.m3.1.1" xref="S4.T2.7.3.m3.1.1.cmml"><mi id="S4.T2.7.3.m3.1.1.2" xref="S4.T2.7.3.m3.1.1.2.cmml"></mi><mo id="S4.T2.7.3.m3.1.1.1" xref="S4.T2.7.3.m3.1.1.1.cmml">&lt;</mo><mn id="S4.T2.7.3.m3.1.1.3" xref="S4.T2.7.3.m3.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.7.3.m3.1c"><apply id="S4.T2.7.3.m3.1.1.cmml" xref="S4.T2.7.3.m3.1.1"><lt id="S4.T2.7.3.m3.1.1.1.cmml" xref="S4.T2.7.3.m3.1.1.1"></lt><csymbol cd="latexml" id="S4.T2.7.3.m3.1.1.2.cmml" xref="S4.T2.7.3.m3.1.1.2">absent</csymbol><cn id="S4.T2.7.3.m3.1.1.3.cmml" type="float" xref="S4.T2.7.3.m3.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.3.m3.1d">&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.3.m3.1e">&lt; 0.05</annotation></semantics></math> in <math alttext="t" class="ltx_Math" display="inline" id="S4.T2.8.4.m4.1"><semantics id="S4.T2.8.4.m4.1b"><mi id="S4.T2.8.4.m4.1.1" xref="S4.T2.8.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.T2.8.4.m4.1c"><ci id="S4.T2.8.4.m4.1.1.cmml" xref="S4.T2.8.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.4.m4.1d">t</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.4.m4.1e">italic_t</annotation></semantics></math>-test compared with the backbone model.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.56" style="width:303.5pt;height:324.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-66.8pt,71.5pt) scale(0.694237190250625,0.694237190250625) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.56.48">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.56.48.49.1">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.56.48.49.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.56.48.49.1.1.1">Backbones</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.56.48.49.1.2">KuaiSAR-small</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T2.56.48.49.1.3">KuaiSAR</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.56.48.49.1.4">Amazon</td>
</tr>
<tr class="ltx_tr" id="S4.T2.11.3.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.3.3.4">Rec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.3.3.5">Search</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.3.3.6">Rec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.11.3.3.7">Search</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.9.1.1.1">Rec<math alttext="\#1" class="ltx_Math" display="inline" id="S4.T2.9.1.1.1.m1.1"><semantics id="S4.T2.9.1.1.1.m1.1a"><mrow id="S4.T2.9.1.1.1.m1.1.1" xref="S4.T2.9.1.1.1.m1.1.1.cmml"><mi id="S4.T2.9.1.1.1.m1.1.1.2" mathvariant="normal" xref="S4.T2.9.1.1.1.m1.1.1.2.cmml">#</mi><mo id="S4.T2.9.1.1.1.m1.1.1.1" xref="S4.T2.9.1.1.1.m1.1.1.1.cmml">⁢</mo><mn id="S4.T2.9.1.1.1.m1.1.1.3" xref="S4.T2.9.1.1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.9.1.1.1.m1.1b"><apply id="S4.T2.9.1.1.1.m1.1.1.cmml" xref="S4.T2.9.1.1.1.m1.1.1"><times id="S4.T2.9.1.1.1.m1.1.1.1.cmml" xref="S4.T2.9.1.1.1.m1.1.1.1"></times><ci id="S4.T2.9.1.1.1.m1.1.1.2.cmml" xref="S4.T2.9.1.1.1.m1.1.1.2">#</ci><cn id="S4.T2.9.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T2.9.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.1.1.1.m1.1c">\#1</annotation><annotation encoding="application/x-llamapun" id="S4.T2.9.1.1.1.m1.1d"># 1</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.10.2.2.2">Rec<math alttext="\#2" class="ltx_Math" display="inline" id="S4.T2.10.2.2.2.m1.1"><semantics id="S4.T2.10.2.2.2.m1.1a"><mrow id="S4.T2.10.2.2.2.m1.1.1" xref="S4.T2.10.2.2.2.m1.1.1.cmml"><mi id="S4.T2.10.2.2.2.m1.1.1.2" mathvariant="normal" xref="S4.T2.10.2.2.2.m1.1.1.2.cmml">#</mi><mo id="S4.T2.10.2.2.2.m1.1.1.1" xref="S4.T2.10.2.2.2.m1.1.1.1.cmml">⁢</mo><mn id="S4.T2.10.2.2.2.m1.1.1.3" xref="S4.T2.10.2.2.2.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.10.2.2.2.m1.1b"><apply id="S4.T2.10.2.2.2.m1.1.1.cmml" xref="S4.T2.10.2.2.2.m1.1.1"><times id="S4.T2.10.2.2.2.m1.1.1.1.cmml" xref="S4.T2.10.2.2.2.m1.1.1.1"></times><ci id="S4.T2.10.2.2.2.m1.1.1.2.cmml" xref="S4.T2.10.2.2.2.m1.1.1.2">#</ci><cn id="S4.T2.10.2.2.2.m1.1.1.3.cmml" type="integer" xref="S4.T2.10.2.2.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.2.2.2.m1.1c">\#2</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.2.2.2.m1.1d"># 2</annotation></semantics></math>
</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.11.3.3.3">Rec<math alttext="\#3" class="ltx_Math" display="inline" id="S4.T2.11.3.3.3.m1.1"><semantics id="S4.T2.11.3.3.3.m1.1a"><mrow id="S4.T2.11.3.3.3.m1.1.1" xref="S4.T2.11.3.3.3.m1.1.1.cmml"><mi id="S4.T2.11.3.3.3.m1.1.1.2" mathvariant="normal" xref="S4.T2.11.3.3.3.m1.1.1.2.cmml">#</mi><mo id="S4.T2.11.3.3.3.m1.1.1.1" xref="S4.T2.11.3.3.3.m1.1.1.1.cmml">⁢</mo><mn id="S4.T2.11.3.3.3.m1.1.1.3" xref="S4.T2.11.3.3.3.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.11.3.3.3.m1.1b"><apply id="S4.T2.11.3.3.3.m1.1.1.cmml" xref="S4.T2.11.3.3.3.m1.1.1"><times id="S4.T2.11.3.3.3.m1.1.1.1.cmml" xref="S4.T2.11.3.3.3.m1.1.1.1"></times><ci id="S4.T2.11.3.3.3.m1.1.1.2.cmml" xref="S4.T2.11.3.3.3.m1.1.1.2">#</ci><cn id="S4.T2.11.3.3.3.m1.1.1.3.cmml" type="integer" xref="S4.T2.11.3.3.3.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.3.3.3.m1.1c">\#3</annotation><annotation encoding="application/x-llamapun" id="S4.T2.11.3.3.3.m1.1d"># 3</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.50.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.50.2.1">STAR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.50.2.2">0.7225</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.50.2.3">0.6089</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.50.2.4">0.7387</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.50.2.5">0.6268</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.50.2.6">0.6156</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.50.2.7">0.6320</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.56.48.50.2.8">0.6225</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.51.3">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.51.3.1">STAR_DN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.51.3.2">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.51.3.2.1">\ul</span>0.7241</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.51.3.3">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.51.3.3.1">\ul</span>0.6116</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.51.3.4">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.51.3.4.1">\ul</span>0.7404</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.51.3.5">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.51.3.5.1">\ul</span>0.6270</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.51.3.6">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.51.3.6.1">\ul</span>0.6306</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.51.3.7">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.51.3.7.1">\ul</span>0.6350</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.51.3.8">0.6355</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.52.4">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.52.4.1">STAR_EP</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.52.4.2">0.7230</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.52.4.3">0.6082</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.52.4.4">0.7388</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.52.4.5">0.6266</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.52.4.6">0.6211</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.52.4.7">0.6302</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.52.4.8">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.52.4.8.1">\ul</span>0.6378</td>
</tr>
<tr class="ltx_tr" id="S4.T2.18.10.10">
<td class="ltx_td ltx_align_center" id="S4.T2.18.10.10.8">STAR_ours</td>
<td class="ltx_td ltx_align_center" id="S4.T2.12.4.4.1"><math alttext="0.7276^{\star}" class="ltx_Math" display="inline" id="S4.T2.12.4.4.1.m1.1"><semantics id="S4.T2.12.4.4.1.m1.1a"><msup id="S4.T2.12.4.4.1.m1.1.1" xref="S4.T2.12.4.4.1.m1.1.1.cmml"><mn id="S4.T2.12.4.4.1.m1.1.1.2" xref="S4.T2.12.4.4.1.m1.1.1.2.cmml">0.7276</mn><mo id="S4.T2.12.4.4.1.m1.1.1.3" xref="S4.T2.12.4.4.1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.12.4.4.1.m1.1b"><apply id="S4.T2.12.4.4.1.m1.1.1.cmml" xref="S4.T2.12.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.12.4.4.1.m1.1.1.1.cmml" xref="S4.T2.12.4.4.1.m1.1.1">superscript</csymbol><cn id="S4.T2.12.4.4.1.m1.1.1.2.cmml" type="float" xref="S4.T2.12.4.4.1.m1.1.1.2">0.7276</cn><ci id="S4.T2.12.4.4.1.m1.1.1.3.cmml" xref="S4.T2.12.4.4.1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.4.4.1.m1.1c">0.7276^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.12.4.4.1.m1.1d">0.7276 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.13.5.5.2"><math alttext="0.6181^{\star}" class="ltx_Math" display="inline" id="S4.T2.13.5.5.2.m1.1"><semantics id="S4.T2.13.5.5.2.m1.1a"><msup id="S4.T2.13.5.5.2.m1.1.1" xref="S4.T2.13.5.5.2.m1.1.1.cmml"><mn id="S4.T2.13.5.5.2.m1.1.1.2" xref="S4.T2.13.5.5.2.m1.1.1.2.cmml">0.6181</mn><mo id="S4.T2.13.5.5.2.m1.1.1.3" xref="S4.T2.13.5.5.2.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.13.5.5.2.m1.1b"><apply id="S4.T2.13.5.5.2.m1.1.1.cmml" xref="S4.T2.13.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.13.5.5.2.m1.1.1.1.cmml" xref="S4.T2.13.5.5.2.m1.1.1">superscript</csymbol><cn id="S4.T2.13.5.5.2.m1.1.1.2.cmml" type="float" xref="S4.T2.13.5.5.2.m1.1.1.2">0.6181</cn><ci id="S4.T2.13.5.5.2.m1.1.1.3.cmml" xref="S4.T2.13.5.5.2.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.13.5.5.2.m1.1c">0.6181^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.13.5.5.2.m1.1d">0.6181 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.14.6.6.3"><math alttext="0.7408^{\star}" class="ltx_Math" display="inline" id="S4.T2.14.6.6.3.m1.1"><semantics id="S4.T2.14.6.6.3.m1.1a"><msup id="S4.T2.14.6.6.3.m1.1.1" xref="S4.T2.14.6.6.3.m1.1.1.cmml"><mn id="S4.T2.14.6.6.3.m1.1.1.2" xref="S4.T2.14.6.6.3.m1.1.1.2.cmml">0.7408</mn><mo id="S4.T2.14.6.6.3.m1.1.1.3" xref="S4.T2.14.6.6.3.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.14.6.6.3.m1.1b"><apply id="S4.T2.14.6.6.3.m1.1.1.cmml" xref="S4.T2.14.6.6.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.14.6.6.3.m1.1.1.1.cmml" xref="S4.T2.14.6.6.3.m1.1.1">superscript</csymbol><cn id="S4.T2.14.6.6.3.m1.1.1.2.cmml" type="float" xref="S4.T2.14.6.6.3.m1.1.1.2">0.7408</cn><ci id="S4.T2.14.6.6.3.m1.1.1.3.cmml" xref="S4.T2.14.6.6.3.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.14.6.6.3.m1.1c">0.7408^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.14.6.6.3.m1.1d">0.7408 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.15.7.7.4"><math alttext="0.6332^{\star}" class="ltx_Math" display="inline" id="S4.T2.15.7.7.4.m1.1"><semantics id="S4.T2.15.7.7.4.m1.1a"><msup id="S4.T2.15.7.7.4.m1.1.1" xref="S4.T2.15.7.7.4.m1.1.1.cmml"><mn id="S4.T2.15.7.7.4.m1.1.1.2" xref="S4.T2.15.7.7.4.m1.1.1.2.cmml">0.6332</mn><mo id="S4.T2.15.7.7.4.m1.1.1.3" xref="S4.T2.15.7.7.4.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.15.7.7.4.m1.1b"><apply id="S4.T2.15.7.7.4.m1.1.1.cmml" xref="S4.T2.15.7.7.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.15.7.7.4.m1.1.1.1.cmml" xref="S4.T2.15.7.7.4.m1.1.1">superscript</csymbol><cn id="S4.T2.15.7.7.4.m1.1.1.2.cmml" type="float" xref="S4.T2.15.7.7.4.m1.1.1.2">0.6332</cn><ci id="S4.T2.15.7.7.4.m1.1.1.3.cmml" xref="S4.T2.15.7.7.4.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.15.7.7.4.m1.1c">0.6332^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.15.7.7.4.m1.1d">0.6332 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.16.8.8.5"><math alttext="0.8720^{\star}" class="ltx_Math" display="inline" id="S4.T2.16.8.8.5.m1.1"><semantics id="S4.T2.16.8.8.5.m1.1a"><msup id="S4.T2.16.8.8.5.m1.1.1" xref="S4.T2.16.8.8.5.m1.1.1.cmml"><mn id="S4.T2.16.8.8.5.m1.1.1.2" xref="S4.T2.16.8.8.5.m1.1.1.2.cmml">0.8720</mn><mo id="S4.T2.16.8.8.5.m1.1.1.3" xref="S4.T2.16.8.8.5.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.16.8.8.5.m1.1b"><apply id="S4.T2.16.8.8.5.m1.1.1.cmml" xref="S4.T2.16.8.8.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.16.8.8.5.m1.1.1.1.cmml" xref="S4.T2.16.8.8.5.m1.1.1">superscript</csymbol><cn id="S4.T2.16.8.8.5.m1.1.1.2.cmml" type="float" xref="S4.T2.16.8.8.5.m1.1.1.2">0.8720</cn><ci id="S4.T2.16.8.8.5.m1.1.1.3.cmml" xref="S4.T2.16.8.8.5.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.16.8.8.5.m1.1c">0.8720^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.16.8.8.5.m1.1d">0.8720 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.17.9.9.6"><math alttext="0.6364^{\star}" class="ltx_Math" display="inline" id="S4.T2.17.9.9.6.m1.1"><semantics id="S4.T2.17.9.9.6.m1.1a"><msup id="S4.T2.17.9.9.6.m1.1.1" xref="S4.T2.17.9.9.6.m1.1.1.cmml"><mn id="S4.T2.17.9.9.6.m1.1.1.2" xref="S4.T2.17.9.9.6.m1.1.1.2.cmml">0.6364</mn><mo id="S4.T2.17.9.9.6.m1.1.1.3" xref="S4.T2.17.9.9.6.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.17.9.9.6.m1.1b"><apply id="S4.T2.17.9.9.6.m1.1.1.cmml" xref="S4.T2.17.9.9.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.17.9.9.6.m1.1.1.1.cmml" xref="S4.T2.17.9.9.6.m1.1.1">superscript</csymbol><cn id="S4.T2.17.9.9.6.m1.1.1.2.cmml" type="float" xref="S4.T2.17.9.9.6.m1.1.1.2">0.6364</cn><ci id="S4.T2.17.9.9.6.m1.1.1.3.cmml" xref="S4.T2.17.9.9.6.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.17.9.9.6.m1.1c">0.6364^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.17.9.9.6.m1.1d">0.6364 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.18.10.10.7"><math alttext="0.7543^{\star}" class="ltx_Math" display="inline" id="S4.T2.18.10.10.7.m1.1"><semantics id="S4.T2.18.10.10.7.m1.1a"><msup id="S4.T2.18.10.10.7.m1.1.1" xref="S4.T2.18.10.10.7.m1.1.1.cmml"><mn id="S4.T2.18.10.10.7.m1.1.1.2" xref="S4.T2.18.10.10.7.m1.1.1.2.cmml">0.7543</mn><mo id="S4.T2.18.10.10.7.m1.1.1.3" xref="S4.T2.18.10.10.7.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.18.10.10.7.m1.1b"><apply id="S4.T2.18.10.10.7.m1.1.1.cmml" xref="S4.T2.18.10.10.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.18.10.10.7.m1.1.1.1.cmml" xref="S4.T2.18.10.10.7.m1.1.1">superscript</csymbol><cn id="S4.T2.18.10.10.7.m1.1.1.2.cmml" type="float" xref="S4.T2.18.10.10.7.m1.1.1.2">0.7543</cn><ci id="S4.T2.18.10.10.7.m1.1.1.3.cmml" xref="S4.T2.18.10.10.7.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.18.10.10.7.m1.1c">0.7543^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.18.10.10.7.m1.1d">0.7543 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.53.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.53.5.1">OMoE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.53.5.2">0.7241</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.53.5.3">0.6163</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.53.5.4">0.7394</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.53.5.5">0.6310</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.53.5.6">0.5995</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.53.5.7">0.6043</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.56.48.53.5.8">0.6252</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.54.6">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.54.6.1">OMoE_DN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.54.6.2">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.54.6.2.1">\ul</span>0.7249</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.54.6.3">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.54.6.3.1">\ul</span>0.6183</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.54.6.4">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.54.6.4.1">\ul</span>0.7402</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.54.6.5">0.6319</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.54.6.6">0.6027</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.54.6.7">0.6171</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.54.6.8">0.6289</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.55.7">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.55.7.1">OMoE_EP</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.55.7.2">0.7246</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.55.7.3">0.6179</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.55.7.4">0.7392</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.55.7.5">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.55.7.5.1">\ul</span>0.6330</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.55.7.6">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.55.7.6.1">\ul</span>0.6143</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.55.7.7">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.55.7.7.1">\ul</span>0.6176</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.55.7.8">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.55.7.8.1">\ul</span>0.6312</td>
</tr>
<tr class="ltx_tr" id="S4.T2.25.17.17">
<td class="ltx_td ltx_align_center" id="S4.T2.25.17.17.8">OMoE_ours</td>
<td class="ltx_td ltx_align_center" id="S4.T2.19.11.11.1"><math alttext="0.7265^{\star}" class="ltx_Math" display="inline" id="S4.T2.19.11.11.1.m1.1"><semantics id="S4.T2.19.11.11.1.m1.1a"><msup id="S4.T2.19.11.11.1.m1.1.1" xref="S4.T2.19.11.11.1.m1.1.1.cmml"><mn id="S4.T2.19.11.11.1.m1.1.1.2" xref="S4.T2.19.11.11.1.m1.1.1.2.cmml">0.7265</mn><mo id="S4.T2.19.11.11.1.m1.1.1.3" xref="S4.T2.19.11.11.1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.19.11.11.1.m1.1b"><apply id="S4.T2.19.11.11.1.m1.1.1.cmml" xref="S4.T2.19.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.19.11.11.1.m1.1.1.1.cmml" xref="S4.T2.19.11.11.1.m1.1.1">superscript</csymbol><cn id="S4.T2.19.11.11.1.m1.1.1.2.cmml" type="float" xref="S4.T2.19.11.11.1.m1.1.1.2">0.7265</cn><ci id="S4.T2.19.11.11.1.m1.1.1.3.cmml" xref="S4.T2.19.11.11.1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.19.11.11.1.m1.1c">0.7265^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.19.11.11.1.m1.1d">0.7265 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.20.12.12.2"><math alttext="0.6186^{\star}" class="ltx_Math" display="inline" id="S4.T2.20.12.12.2.m1.1"><semantics id="S4.T2.20.12.12.2.m1.1a"><msup id="S4.T2.20.12.12.2.m1.1.1" xref="S4.T2.20.12.12.2.m1.1.1.cmml"><mn id="S4.T2.20.12.12.2.m1.1.1.2" xref="S4.T2.20.12.12.2.m1.1.1.2.cmml">0.6186</mn><mo id="S4.T2.20.12.12.2.m1.1.1.3" xref="S4.T2.20.12.12.2.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.20.12.12.2.m1.1b"><apply id="S4.T2.20.12.12.2.m1.1.1.cmml" xref="S4.T2.20.12.12.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.20.12.12.2.m1.1.1.1.cmml" xref="S4.T2.20.12.12.2.m1.1.1">superscript</csymbol><cn id="S4.T2.20.12.12.2.m1.1.1.2.cmml" type="float" xref="S4.T2.20.12.12.2.m1.1.1.2">0.6186</cn><ci id="S4.T2.20.12.12.2.m1.1.1.3.cmml" xref="S4.T2.20.12.12.2.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.20.12.12.2.m1.1c">0.6186^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.20.12.12.2.m1.1d">0.6186 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.21.13.13.3"><math alttext="0.7413^{\star}" class="ltx_Math" display="inline" id="S4.T2.21.13.13.3.m1.1"><semantics id="S4.T2.21.13.13.3.m1.1a"><msup id="S4.T2.21.13.13.3.m1.1.1" xref="S4.T2.21.13.13.3.m1.1.1.cmml"><mn id="S4.T2.21.13.13.3.m1.1.1.2" xref="S4.T2.21.13.13.3.m1.1.1.2.cmml">0.7413</mn><mo id="S4.T2.21.13.13.3.m1.1.1.3" xref="S4.T2.21.13.13.3.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.21.13.13.3.m1.1b"><apply id="S4.T2.21.13.13.3.m1.1.1.cmml" xref="S4.T2.21.13.13.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.21.13.13.3.m1.1.1.1.cmml" xref="S4.T2.21.13.13.3.m1.1.1">superscript</csymbol><cn id="S4.T2.21.13.13.3.m1.1.1.2.cmml" type="float" xref="S4.T2.21.13.13.3.m1.1.1.2">0.7413</cn><ci id="S4.T2.21.13.13.3.m1.1.1.3.cmml" xref="S4.T2.21.13.13.3.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.21.13.13.3.m1.1c">0.7413^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.21.13.13.3.m1.1d">0.7413 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.22.14.14.4"><math alttext="0.6332^{\star}" class="ltx_Math" display="inline" id="S4.T2.22.14.14.4.m1.1"><semantics id="S4.T2.22.14.14.4.m1.1a"><msup id="S4.T2.22.14.14.4.m1.1.1" xref="S4.T2.22.14.14.4.m1.1.1.cmml"><mn id="S4.T2.22.14.14.4.m1.1.1.2" xref="S4.T2.22.14.14.4.m1.1.1.2.cmml">0.6332</mn><mo id="S4.T2.22.14.14.4.m1.1.1.3" xref="S4.T2.22.14.14.4.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.22.14.14.4.m1.1b"><apply id="S4.T2.22.14.14.4.m1.1.1.cmml" xref="S4.T2.22.14.14.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.22.14.14.4.m1.1.1.1.cmml" xref="S4.T2.22.14.14.4.m1.1.1">superscript</csymbol><cn id="S4.T2.22.14.14.4.m1.1.1.2.cmml" type="float" xref="S4.T2.22.14.14.4.m1.1.1.2">0.6332</cn><ci id="S4.T2.22.14.14.4.m1.1.1.3.cmml" xref="S4.T2.22.14.14.4.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.22.14.14.4.m1.1c">0.6332^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.22.14.14.4.m1.1d">0.6332 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.23.15.15.5"><math alttext="0.8182^{\star}" class="ltx_Math" display="inline" id="S4.T2.23.15.15.5.m1.1"><semantics id="S4.T2.23.15.15.5.m1.1a"><msup id="S4.T2.23.15.15.5.m1.1.1" xref="S4.T2.23.15.15.5.m1.1.1.cmml"><mn id="S4.T2.23.15.15.5.m1.1.1.2" xref="S4.T2.23.15.15.5.m1.1.1.2.cmml">0.8182</mn><mo id="S4.T2.23.15.15.5.m1.1.1.3" xref="S4.T2.23.15.15.5.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.23.15.15.5.m1.1b"><apply id="S4.T2.23.15.15.5.m1.1.1.cmml" xref="S4.T2.23.15.15.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.23.15.15.5.m1.1.1.1.cmml" xref="S4.T2.23.15.15.5.m1.1.1">superscript</csymbol><cn id="S4.T2.23.15.15.5.m1.1.1.2.cmml" type="float" xref="S4.T2.23.15.15.5.m1.1.1.2">0.8182</cn><ci id="S4.T2.23.15.15.5.m1.1.1.3.cmml" xref="S4.T2.23.15.15.5.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.23.15.15.5.m1.1c">0.8182^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.23.15.15.5.m1.1d">0.8182 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.24.16.16.6"><math alttext="0.6180^{\star}" class="ltx_Math" display="inline" id="S4.T2.24.16.16.6.m1.1"><semantics id="S4.T2.24.16.16.6.m1.1a"><msup id="S4.T2.24.16.16.6.m1.1.1" xref="S4.T2.24.16.16.6.m1.1.1.cmml"><mn id="S4.T2.24.16.16.6.m1.1.1.2" xref="S4.T2.24.16.16.6.m1.1.1.2.cmml">0.6180</mn><mo id="S4.T2.24.16.16.6.m1.1.1.3" xref="S4.T2.24.16.16.6.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.24.16.16.6.m1.1b"><apply id="S4.T2.24.16.16.6.m1.1.1.cmml" xref="S4.T2.24.16.16.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.24.16.16.6.m1.1.1.1.cmml" xref="S4.T2.24.16.16.6.m1.1.1">superscript</csymbol><cn id="S4.T2.24.16.16.6.m1.1.1.2.cmml" type="float" xref="S4.T2.24.16.16.6.m1.1.1.2">0.6180</cn><ci id="S4.T2.24.16.16.6.m1.1.1.3.cmml" xref="S4.T2.24.16.16.6.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.24.16.16.6.m1.1c">0.6180^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.24.16.16.6.m1.1d">0.6180 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.25.17.17.7"><math alttext="0.6823^{\star}" class="ltx_Math" display="inline" id="S4.T2.25.17.17.7.m1.1"><semantics id="S4.T2.25.17.17.7.m1.1a"><msup id="S4.T2.25.17.17.7.m1.1.1" xref="S4.T2.25.17.17.7.m1.1.1.cmml"><mn id="S4.T2.25.17.17.7.m1.1.1.2" xref="S4.T2.25.17.17.7.m1.1.1.2.cmml">0.6823</mn><mo id="S4.T2.25.17.17.7.m1.1.1.3" xref="S4.T2.25.17.17.7.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.25.17.17.7.m1.1b"><apply id="S4.T2.25.17.17.7.m1.1.1.cmml" xref="S4.T2.25.17.17.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.25.17.17.7.m1.1.1.1.cmml" xref="S4.T2.25.17.17.7.m1.1.1">superscript</csymbol><cn id="S4.T2.25.17.17.7.m1.1.1.2.cmml" type="float" xref="S4.T2.25.17.17.7.m1.1.1.2">0.6823</cn><ci id="S4.T2.25.17.17.7.m1.1.1.3.cmml" xref="S4.T2.25.17.17.7.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.25.17.17.7.m1.1c">0.6823^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.25.17.17.7.m1.1d">0.6823 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.56.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.56.8.1">MMoE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.56.8.2">0.7235</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.56.8.3">0.6150</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.56.8.4">0.7392</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.56.8.5">0.6313</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.56.8.6">0.5907</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.56.8.7">0.5999</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.56.48.56.8.8">0.6032</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.57.9">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.57.9.1">MMoE_DN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.57.9.2">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.57.9.2.1">\ul</span>0.7246</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.57.9.3">0.6164</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.57.9.4">0.7394</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.57.9.5">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.57.9.5.1">\ul</span>0.6330</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.57.9.6">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.57.9.6.1">\ul</span>0.6310</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.57.9.7">0.6201</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.57.9.8">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.57.9.8.1">\ul</span>0.6371</td>
</tr>
<tr class="ltx_tr" id="S4.T2.26.18.18">
<td class="ltx_td ltx_align_center" id="S4.T2.26.18.18.2">MMoE_EP</td>
<td class="ltx_td ltx_align_center" id="S4.T2.26.18.18.3">0.7245</td>
<td class="ltx_td ltx_align_center" id="S4.T2.26.18.18.1"><math alttext="0.6178" class="ltx_Math" display="inline" id="S4.T2.26.18.18.1.m1.1"><semantics id="S4.T2.26.18.18.1.m1.1a"><mn id="S4.T2.26.18.18.1.m1.1.1" xref="S4.T2.26.18.18.1.m1.1.1.cmml">0.6178</mn><annotation-xml encoding="MathML-Content" id="S4.T2.26.18.18.1.m1.1b"><cn id="S4.T2.26.18.18.1.m1.1.1.cmml" type="float" xref="S4.T2.26.18.18.1.m1.1.1">0.6178</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.26.18.18.1.m1.1c">0.6178</annotation><annotation encoding="application/x-llamapun" id="S4.T2.26.18.18.1.m1.1d">0.6178</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.26.18.18.4">
<span class="ltx_ERROR undefined" id="S4.T2.26.18.18.4.1">\ul</span>0.7397</td>
<td class="ltx_td ltx_align_center" id="S4.T2.26.18.18.5">0.6326</td>
<td class="ltx_td ltx_align_center" id="S4.T2.26.18.18.6">0.6218</td>
<td class="ltx_td ltx_align_center" id="S4.T2.26.18.18.7">
<span class="ltx_ERROR undefined" id="S4.T2.26.18.18.7.1">\ul</span>0.6221</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.26.18.18.8">0.6315</td>
</tr>
<tr class="ltx_tr" id="S4.T2.33.25.25">
<td class="ltx_td ltx_align_center" id="S4.T2.33.25.25.8">MMoE_ours</td>
<td class="ltx_td ltx_align_center" id="S4.T2.27.19.19.1"><math alttext="0.7264^{\star}" class="ltx_Math" display="inline" id="S4.T2.27.19.19.1.m1.1"><semantics id="S4.T2.27.19.19.1.m1.1a"><msup id="S4.T2.27.19.19.1.m1.1.1" xref="S4.T2.27.19.19.1.m1.1.1.cmml"><mn id="S4.T2.27.19.19.1.m1.1.1.2" xref="S4.T2.27.19.19.1.m1.1.1.2.cmml">0.7264</mn><mo id="S4.T2.27.19.19.1.m1.1.1.3" xref="S4.T2.27.19.19.1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.27.19.19.1.m1.1b"><apply id="S4.T2.27.19.19.1.m1.1.1.cmml" xref="S4.T2.27.19.19.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.27.19.19.1.m1.1.1.1.cmml" xref="S4.T2.27.19.19.1.m1.1.1">superscript</csymbol><cn id="S4.T2.27.19.19.1.m1.1.1.2.cmml" type="float" xref="S4.T2.27.19.19.1.m1.1.1.2">0.7264</cn><ci id="S4.T2.27.19.19.1.m1.1.1.3.cmml" xref="S4.T2.27.19.19.1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.27.19.19.1.m1.1c">0.7264^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.27.19.19.1.m1.1d">0.7264 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.28.20.20.2">
<span class="ltx_ERROR undefined" id="S4.T2.28.20.20.2.1">\ul</span><math alttext="0.6166^{\bm{\star}}" class="ltx_Math" display="inline" id="S4.T2.28.20.20.2.m1.1"><semantics id="S4.T2.28.20.20.2.m1.1a"><msup id="S4.T2.28.20.20.2.m1.1.1" xref="S4.T2.28.20.20.2.m1.1.1.cmml"><mn id="S4.T2.28.20.20.2.m1.1.1.2" xref="S4.T2.28.20.20.2.m1.1.1.2.cmml">0.6166</mn><mo class="ltx_mathvariant_bold" id="S4.T2.28.20.20.2.m1.1.1.3" mathvariant="bold" xref="S4.T2.28.20.20.2.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.28.20.20.2.m1.1b"><apply id="S4.T2.28.20.20.2.m1.1.1.cmml" xref="S4.T2.28.20.20.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.28.20.20.2.m1.1.1.1.cmml" xref="S4.T2.28.20.20.2.m1.1.1">superscript</csymbol><cn id="S4.T2.28.20.20.2.m1.1.1.2.cmml" type="float" xref="S4.T2.28.20.20.2.m1.1.1.2">0.6166</cn><ci id="S4.T2.28.20.20.2.m1.1.1.3.cmml" xref="S4.T2.28.20.20.2.m1.1.1.3">bold-⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.28.20.20.2.m1.1c">0.6166^{\bm{\star}}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.28.20.20.2.m1.1d">0.6166 start_POSTSUPERSCRIPT bold_⋆ end_POSTSUPERSCRIPT</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.29.21.21.3"><math alttext="0.7410^{\star}" class="ltx_Math" display="inline" id="S4.T2.29.21.21.3.m1.1"><semantics id="S4.T2.29.21.21.3.m1.1a"><msup id="S4.T2.29.21.21.3.m1.1.1" xref="S4.T2.29.21.21.3.m1.1.1.cmml"><mn id="S4.T2.29.21.21.3.m1.1.1.2" xref="S4.T2.29.21.21.3.m1.1.1.2.cmml">0.7410</mn><mo id="S4.T2.29.21.21.3.m1.1.1.3" xref="S4.T2.29.21.21.3.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.29.21.21.3.m1.1b"><apply id="S4.T2.29.21.21.3.m1.1.1.cmml" xref="S4.T2.29.21.21.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.29.21.21.3.m1.1.1.1.cmml" xref="S4.T2.29.21.21.3.m1.1.1">superscript</csymbol><cn id="S4.T2.29.21.21.3.m1.1.1.2.cmml" type="float" xref="S4.T2.29.21.21.3.m1.1.1.2">0.7410</cn><ci id="S4.T2.29.21.21.3.m1.1.1.3.cmml" xref="S4.T2.29.21.21.3.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.29.21.21.3.m1.1c">0.7410^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.29.21.21.3.m1.1d">0.7410 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.30.22.22.4"><math alttext="0.6341^{\star}" class="ltx_Math" display="inline" id="S4.T2.30.22.22.4.m1.1"><semantics id="S4.T2.30.22.22.4.m1.1a"><msup id="S4.T2.30.22.22.4.m1.1.1" xref="S4.T2.30.22.22.4.m1.1.1.cmml"><mn id="S4.T2.30.22.22.4.m1.1.1.2" xref="S4.T2.30.22.22.4.m1.1.1.2.cmml">0.6341</mn><mo id="S4.T2.30.22.22.4.m1.1.1.3" xref="S4.T2.30.22.22.4.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.30.22.22.4.m1.1b"><apply id="S4.T2.30.22.22.4.m1.1.1.cmml" xref="S4.T2.30.22.22.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.30.22.22.4.m1.1.1.1.cmml" xref="S4.T2.30.22.22.4.m1.1.1">superscript</csymbol><cn id="S4.T2.30.22.22.4.m1.1.1.2.cmml" type="float" xref="S4.T2.30.22.22.4.m1.1.1.2">0.6341</cn><ci id="S4.T2.30.22.22.4.m1.1.1.3.cmml" xref="S4.T2.30.22.22.4.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.30.22.22.4.m1.1c">0.6341^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.30.22.22.4.m1.1d">0.6341 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.31.23.23.5"><math alttext="0.7860^{\star}" class="ltx_Math" display="inline" id="S4.T2.31.23.23.5.m1.1"><semantics id="S4.T2.31.23.23.5.m1.1a"><msup id="S4.T2.31.23.23.5.m1.1.1" xref="S4.T2.31.23.23.5.m1.1.1.cmml"><mn id="S4.T2.31.23.23.5.m1.1.1.2" xref="S4.T2.31.23.23.5.m1.1.1.2.cmml">0.7860</mn><mo id="S4.T2.31.23.23.5.m1.1.1.3" xref="S4.T2.31.23.23.5.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.31.23.23.5.m1.1b"><apply id="S4.T2.31.23.23.5.m1.1.1.cmml" xref="S4.T2.31.23.23.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.31.23.23.5.m1.1.1.1.cmml" xref="S4.T2.31.23.23.5.m1.1.1">superscript</csymbol><cn id="S4.T2.31.23.23.5.m1.1.1.2.cmml" type="float" xref="S4.T2.31.23.23.5.m1.1.1.2">0.7860</cn><ci id="S4.T2.31.23.23.5.m1.1.1.3.cmml" xref="S4.T2.31.23.23.5.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.31.23.23.5.m1.1c">0.7860^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.31.23.23.5.m1.1d">0.7860 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.32.24.24.6"><math alttext="0.6222^{\star}" class="ltx_Math" display="inline" id="S4.T2.32.24.24.6.m1.1"><semantics id="S4.T2.32.24.24.6.m1.1a"><msup id="S4.T2.32.24.24.6.m1.1.1" xref="S4.T2.32.24.24.6.m1.1.1.cmml"><mn id="S4.T2.32.24.24.6.m1.1.1.2" xref="S4.T2.32.24.24.6.m1.1.1.2.cmml">0.6222</mn><mo id="S4.T2.32.24.24.6.m1.1.1.3" xref="S4.T2.32.24.24.6.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.32.24.24.6.m1.1b"><apply id="S4.T2.32.24.24.6.m1.1.1.cmml" xref="S4.T2.32.24.24.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.32.24.24.6.m1.1.1.1.cmml" xref="S4.T2.32.24.24.6.m1.1.1">superscript</csymbol><cn id="S4.T2.32.24.24.6.m1.1.1.2.cmml" type="float" xref="S4.T2.32.24.24.6.m1.1.1.2">0.6222</cn><ci id="S4.T2.32.24.24.6.m1.1.1.3.cmml" xref="S4.T2.32.24.24.6.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.32.24.24.6.m1.1c">0.6222^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.32.24.24.6.m1.1d">0.6222 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.33.25.25.7"><math alttext="0.6854^{\star}" class="ltx_Math" display="inline" id="S4.T2.33.25.25.7.m1.1"><semantics id="S4.T2.33.25.25.7.m1.1a"><msup id="S4.T2.33.25.25.7.m1.1.1" xref="S4.T2.33.25.25.7.m1.1.1.cmml"><mn id="S4.T2.33.25.25.7.m1.1.1.2" xref="S4.T2.33.25.25.7.m1.1.1.2.cmml">0.6854</mn><mo id="S4.T2.33.25.25.7.m1.1.1.3" xref="S4.T2.33.25.25.7.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.33.25.25.7.m1.1b"><apply id="S4.T2.33.25.25.7.m1.1.1.cmml" xref="S4.T2.33.25.25.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.33.25.25.7.m1.1.1.1.cmml" xref="S4.T2.33.25.25.7.m1.1.1">superscript</csymbol><cn id="S4.T2.33.25.25.7.m1.1.1.2.cmml" type="float" xref="S4.T2.33.25.25.7.m1.1.1.2">0.6854</cn><ci id="S4.T2.33.25.25.7.m1.1.1.3.cmml" xref="S4.T2.33.25.25.7.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.33.25.25.7.m1.1c">0.6854^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.33.25.25.7.m1.1d">0.6854 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.58.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.58.10.1">PLE</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.58.10.2">0.7249</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.58.10.3">0.6149</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.58.10.4">0.7396</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.58.10.5">0.6313</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.58.10.6">0.6059</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.58.10.7">0.6127</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.56.48.58.10.8">0.5995</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.59.11">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.59.11.1">PLE_DN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.59.11.2">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.59.11.2.1">\ul</span>0.7258</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.59.11.3">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.59.11.3.1">\ul</span>0.6165</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.59.11.4">0.7400</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.59.11.5">0.6333</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.59.11.6">0.6066</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.59.11.7">0.6195</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.59.11.8">0.6162</td>
</tr>
<tr class="ltx_tr" id="S4.T2.34.26.26">
<td class="ltx_td ltx_align_center" id="S4.T2.34.26.26.2">PLE_EP</td>
<td class="ltx_td ltx_align_center" id="S4.T2.34.26.26.3">0.7252</td>
<td class="ltx_td ltx_align_center" id="S4.T2.34.26.26.1"><math alttext="0.6184" class="ltx_Math" display="inline" id="S4.T2.34.26.26.1.m1.1"><semantics id="S4.T2.34.26.26.1.m1.1a"><mn id="S4.T2.34.26.26.1.m1.1.1" xref="S4.T2.34.26.26.1.m1.1.1.cmml">0.6184</mn><annotation-xml encoding="MathML-Content" id="S4.T2.34.26.26.1.m1.1b"><cn id="S4.T2.34.26.26.1.m1.1.1.cmml" type="float" xref="S4.T2.34.26.26.1.m1.1.1">0.6184</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.34.26.26.1.m1.1c">0.6184</annotation><annotation encoding="application/x-llamapun" id="S4.T2.34.26.26.1.m1.1d">0.6184</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.34.26.26.4">
<span class="ltx_ERROR undefined" id="S4.T2.34.26.26.4.1">\ul</span>0.7402</td>
<td class="ltx_td ltx_align_center" id="S4.T2.34.26.26.5">
<span class="ltx_ERROR undefined" id="S4.T2.34.26.26.5.1">\ul</span>0.6339</td>
<td class="ltx_td ltx_align_center" id="S4.T2.34.26.26.6">
<span class="ltx_ERROR undefined" id="S4.T2.34.26.26.6.1">\ul</span>0.6173</td>
<td class="ltx_td ltx_align_center" id="S4.T2.34.26.26.7">
<span class="ltx_ERROR undefined" id="S4.T2.34.26.26.7.1">\ul</span>0.6229</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.34.26.26.8">
<span class="ltx_ERROR undefined" id="S4.T2.34.26.26.8.1">\ul</span>0.6263</td>
</tr>
<tr class="ltx_tr" id="S4.T2.41.33.33">
<td class="ltx_td ltx_align_center" id="S4.T2.41.33.33.8">PLE_ours</td>
<td class="ltx_td ltx_align_center" id="S4.T2.35.27.27.1"><math alttext="0.7269^{\star}" class="ltx_Math" display="inline" id="S4.T2.35.27.27.1.m1.1"><semantics id="S4.T2.35.27.27.1.m1.1a"><msup id="S4.T2.35.27.27.1.m1.1.1" xref="S4.T2.35.27.27.1.m1.1.1.cmml"><mn id="S4.T2.35.27.27.1.m1.1.1.2" xref="S4.T2.35.27.27.1.m1.1.1.2.cmml">0.7269</mn><mo id="S4.T2.35.27.27.1.m1.1.1.3" xref="S4.T2.35.27.27.1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.35.27.27.1.m1.1b"><apply id="S4.T2.35.27.27.1.m1.1.1.cmml" xref="S4.T2.35.27.27.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.35.27.27.1.m1.1.1.1.cmml" xref="S4.T2.35.27.27.1.m1.1.1">superscript</csymbol><cn id="S4.T2.35.27.27.1.m1.1.1.2.cmml" type="float" xref="S4.T2.35.27.27.1.m1.1.1.2">0.7269</cn><ci id="S4.T2.35.27.27.1.m1.1.1.3.cmml" xref="S4.T2.35.27.27.1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.35.27.27.1.m1.1c">0.7269^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.35.27.27.1.m1.1d">0.7269 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.36.28.28.2"><math alttext="0.6184^{\star}" class="ltx_Math" display="inline" id="S4.T2.36.28.28.2.m1.1"><semantics id="S4.T2.36.28.28.2.m1.1a"><msup id="S4.T2.36.28.28.2.m1.1.1" xref="S4.T2.36.28.28.2.m1.1.1.cmml"><mn id="S4.T2.36.28.28.2.m1.1.1.2" xref="S4.T2.36.28.28.2.m1.1.1.2.cmml">0.6184</mn><mo id="S4.T2.36.28.28.2.m1.1.1.3" xref="S4.T2.36.28.28.2.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.36.28.28.2.m1.1b"><apply id="S4.T2.36.28.28.2.m1.1.1.cmml" xref="S4.T2.36.28.28.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.36.28.28.2.m1.1.1.1.cmml" xref="S4.T2.36.28.28.2.m1.1.1">superscript</csymbol><cn id="S4.T2.36.28.28.2.m1.1.1.2.cmml" type="float" xref="S4.T2.36.28.28.2.m1.1.1.2">0.6184</cn><ci id="S4.T2.36.28.28.2.m1.1.1.3.cmml" xref="S4.T2.36.28.28.2.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.36.28.28.2.m1.1c">0.6184^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.36.28.28.2.m1.1d">0.6184 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.37.29.29.3"><math alttext="0.7408^{\star}" class="ltx_Math" display="inline" id="S4.T2.37.29.29.3.m1.1"><semantics id="S4.T2.37.29.29.3.m1.1a"><msup id="S4.T2.37.29.29.3.m1.1.1" xref="S4.T2.37.29.29.3.m1.1.1.cmml"><mn id="S4.T2.37.29.29.3.m1.1.1.2" xref="S4.T2.37.29.29.3.m1.1.1.2.cmml">0.7408</mn><mo id="S4.T2.37.29.29.3.m1.1.1.3" xref="S4.T2.37.29.29.3.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.37.29.29.3.m1.1b"><apply id="S4.T2.37.29.29.3.m1.1.1.cmml" xref="S4.T2.37.29.29.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.37.29.29.3.m1.1.1.1.cmml" xref="S4.T2.37.29.29.3.m1.1.1">superscript</csymbol><cn id="S4.T2.37.29.29.3.m1.1.1.2.cmml" type="float" xref="S4.T2.37.29.29.3.m1.1.1.2">0.7408</cn><ci id="S4.T2.37.29.29.3.m1.1.1.3.cmml" xref="S4.T2.37.29.29.3.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.37.29.29.3.m1.1c">0.7408^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.37.29.29.3.m1.1d">0.7408 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.38.30.30.4"><math alttext="0.6343^{\star}" class="ltx_Math" display="inline" id="S4.T2.38.30.30.4.m1.1"><semantics id="S4.T2.38.30.30.4.m1.1a"><msup id="S4.T2.38.30.30.4.m1.1.1" xref="S4.T2.38.30.30.4.m1.1.1.cmml"><mn id="S4.T2.38.30.30.4.m1.1.1.2" xref="S4.T2.38.30.30.4.m1.1.1.2.cmml">0.6343</mn><mo id="S4.T2.38.30.30.4.m1.1.1.3" xref="S4.T2.38.30.30.4.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.38.30.30.4.m1.1b"><apply id="S4.T2.38.30.30.4.m1.1.1.cmml" xref="S4.T2.38.30.30.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.38.30.30.4.m1.1.1.1.cmml" xref="S4.T2.38.30.30.4.m1.1.1">superscript</csymbol><cn id="S4.T2.38.30.30.4.m1.1.1.2.cmml" type="float" xref="S4.T2.38.30.30.4.m1.1.1.2">0.6343</cn><ci id="S4.T2.38.30.30.4.m1.1.1.3.cmml" xref="S4.T2.38.30.30.4.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.38.30.30.4.m1.1c">0.6343^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.38.30.30.4.m1.1d">0.6343 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.39.31.31.5"><math alttext="0.8265^{\star}" class="ltx_Math" display="inline" id="S4.T2.39.31.31.5.m1.1"><semantics id="S4.T2.39.31.31.5.m1.1a"><msup id="S4.T2.39.31.31.5.m1.1.1" xref="S4.T2.39.31.31.5.m1.1.1.cmml"><mn id="S4.T2.39.31.31.5.m1.1.1.2" xref="S4.T2.39.31.31.5.m1.1.1.2.cmml">0.8265</mn><mo id="S4.T2.39.31.31.5.m1.1.1.3" xref="S4.T2.39.31.31.5.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.39.31.31.5.m1.1b"><apply id="S4.T2.39.31.31.5.m1.1.1.cmml" xref="S4.T2.39.31.31.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.39.31.31.5.m1.1.1.1.cmml" xref="S4.T2.39.31.31.5.m1.1.1">superscript</csymbol><cn id="S4.T2.39.31.31.5.m1.1.1.2.cmml" type="float" xref="S4.T2.39.31.31.5.m1.1.1.2">0.8265</cn><ci id="S4.T2.39.31.31.5.m1.1.1.3.cmml" xref="S4.T2.39.31.31.5.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.39.31.31.5.m1.1c">0.8265^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.39.31.31.5.m1.1d">0.8265 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.40.32.32.6"><math alttext="0.6250^{\star}" class="ltx_Math" display="inline" id="S4.T2.40.32.32.6.m1.1"><semantics id="S4.T2.40.32.32.6.m1.1a"><msup id="S4.T2.40.32.32.6.m1.1.1" xref="S4.T2.40.32.32.6.m1.1.1.cmml"><mn id="S4.T2.40.32.32.6.m1.1.1.2" xref="S4.T2.40.32.32.6.m1.1.1.2.cmml">0.6250</mn><mo id="S4.T2.40.32.32.6.m1.1.1.3" xref="S4.T2.40.32.32.6.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.40.32.32.6.m1.1b"><apply id="S4.T2.40.32.32.6.m1.1.1.cmml" xref="S4.T2.40.32.32.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.40.32.32.6.m1.1.1.1.cmml" xref="S4.T2.40.32.32.6.m1.1.1">superscript</csymbol><cn id="S4.T2.40.32.32.6.m1.1.1.2.cmml" type="float" xref="S4.T2.40.32.32.6.m1.1.1.2">0.6250</cn><ci id="S4.T2.40.32.32.6.m1.1.1.3.cmml" xref="S4.T2.40.32.32.6.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.40.32.32.6.m1.1c">0.6250^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.40.32.32.6.m1.1d">0.6250 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.41.33.33.7"><math alttext="0.7074^{\star}" class="ltx_Math" display="inline" id="S4.T2.41.33.33.7.m1.1"><semantics id="S4.T2.41.33.33.7.m1.1a"><msup id="S4.T2.41.33.33.7.m1.1.1" xref="S4.T2.41.33.33.7.m1.1.1.cmml"><mn id="S4.T2.41.33.33.7.m1.1.1.2" xref="S4.T2.41.33.33.7.m1.1.1.2.cmml">0.7074</mn><mo id="S4.T2.41.33.33.7.m1.1.1.3" xref="S4.T2.41.33.33.7.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.41.33.33.7.m1.1b"><apply id="S4.T2.41.33.33.7.m1.1.1.cmml" xref="S4.T2.41.33.33.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.41.33.33.7.m1.1.1.1.cmml" xref="S4.T2.41.33.33.7.m1.1.1">superscript</csymbol><cn id="S4.T2.41.33.33.7.m1.1.1.2.cmml" type="float" xref="S4.T2.41.33.33.7.m1.1.1.2">0.7074</cn><ci id="S4.T2.41.33.33.7.m1.1.1.3.cmml" xref="S4.T2.41.33.33.7.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.41.33.33.7.m1.1c">0.7074^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.41.33.33.7.m1.1d">0.7074 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.60.12">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.60.12.1">AITM</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.60.12.2">0.7236</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.60.12.3">0.6154</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.60.12.4">0.7398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.60.12.5">0.6329</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.60.12.6">0.6039</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.60.12.7">0.6126</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.56.48.60.12.8">0.6046</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.61.13">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.61.13.1">AITM_DN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.61.13.2">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.61.13.2.1">\ul</span>0.7243</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.61.13.3">0.6172</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.61.13.4">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.61.13.4.1">\ul</span>0.7398</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.61.13.5">0.6318</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.61.13.6">0.6057</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.61.13.7">0.6151</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.61.13.8">0.6166</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.62.14">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.62.14.1">AITM_EP</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.62.14.2">0.7237</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.62.14.3">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.62.14.3.1">\ul</span>0.6177</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.62.14.4">0.7389</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.62.14.5">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.62.14.5.1">\ul</span>0.6337</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.62.14.6">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.62.14.6.1">\ul</span>0.6064</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.62.14.7">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.62.14.7.1">\ul</span>0.6163</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.62.14.8">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.62.14.8.1">\ul</span>0.6238</td>
</tr>
<tr class="ltx_tr" id="S4.T2.48.40.40">
<td class="ltx_td ltx_align_center" id="S4.T2.48.40.40.8">AITM_ours</td>
<td class="ltx_td ltx_align_center" id="S4.T2.42.34.34.1"><math alttext="0.7273^{\star}" class="ltx_Math" display="inline" id="S4.T2.42.34.34.1.m1.1"><semantics id="S4.T2.42.34.34.1.m1.1a"><msup id="S4.T2.42.34.34.1.m1.1.1" xref="S4.T2.42.34.34.1.m1.1.1.cmml"><mn id="S4.T2.42.34.34.1.m1.1.1.2" xref="S4.T2.42.34.34.1.m1.1.1.2.cmml">0.7273</mn><mo id="S4.T2.42.34.34.1.m1.1.1.3" xref="S4.T2.42.34.34.1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.42.34.34.1.m1.1b"><apply id="S4.T2.42.34.34.1.m1.1.1.cmml" xref="S4.T2.42.34.34.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.42.34.34.1.m1.1.1.1.cmml" xref="S4.T2.42.34.34.1.m1.1.1">superscript</csymbol><cn id="S4.T2.42.34.34.1.m1.1.1.2.cmml" type="float" xref="S4.T2.42.34.34.1.m1.1.1.2">0.7273</cn><ci id="S4.T2.42.34.34.1.m1.1.1.3.cmml" xref="S4.T2.42.34.34.1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.42.34.34.1.m1.1c">0.7273^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.42.34.34.1.m1.1d">0.7273 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.43.35.35.2"><math alttext="0.6178^{\star}" class="ltx_Math" display="inline" id="S4.T2.43.35.35.2.m1.1"><semantics id="S4.T2.43.35.35.2.m1.1a"><msup id="S4.T2.43.35.35.2.m1.1.1" xref="S4.T2.43.35.35.2.m1.1.1.cmml"><mn id="S4.T2.43.35.35.2.m1.1.1.2" xref="S4.T2.43.35.35.2.m1.1.1.2.cmml">0.6178</mn><mo id="S4.T2.43.35.35.2.m1.1.1.3" xref="S4.T2.43.35.35.2.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.43.35.35.2.m1.1b"><apply id="S4.T2.43.35.35.2.m1.1.1.cmml" xref="S4.T2.43.35.35.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.43.35.35.2.m1.1.1.1.cmml" xref="S4.T2.43.35.35.2.m1.1.1">superscript</csymbol><cn id="S4.T2.43.35.35.2.m1.1.1.2.cmml" type="float" xref="S4.T2.43.35.35.2.m1.1.1.2">0.6178</cn><ci id="S4.T2.43.35.35.2.m1.1.1.3.cmml" xref="S4.T2.43.35.35.2.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.43.35.35.2.m1.1c">0.6178^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.43.35.35.2.m1.1d">0.6178 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.44.36.36.3"><math alttext="0.7407^{\star}" class="ltx_Math" display="inline" id="S4.T2.44.36.36.3.m1.1"><semantics id="S4.T2.44.36.36.3.m1.1a"><msup id="S4.T2.44.36.36.3.m1.1.1" xref="S4.T2.44.36.36.3.m1.1.1.cmml"><mn id="S4.T2.44.36.36.3.m1.1.1.2" xref="S4.T2.44.36.36.3.m1.1.1.2.cmml">0.7407</mn><mo id="S4.T2.44.36.36.3.m1.1.1.3" xref="S4.T2.44.36.36.3.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.44.36.36.3.m1.1b"><apply id="S4.T2.44.36.36.3.m1.1.1.cmml" xref="S4.T2.44.36.36.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.44.36.36.3.m1.1.1.1.cmml" xref="S4.T2.44.36.36.3.m1.1.1">superscript</csymbol><cn id="S4.T2.44.36.36.3.m1.1.1.2.cmml" type="float" xref="S4.T2.44.36.36.3.m1.1.1.2">0.7407</cn><ci id="S4.T2.44.36.36.3.m1.1.1.3.cmml" xref="S4.T2.44.36.36.3.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.44.36.36.3.m1.1c">0.7407^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.44.36.36.3.m1.1d">0.7407 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.45.37.37.4"><math alttext="0.6349^{\star}" class="ltx_Math" display="inline" id="S4.T2.45.37.37.4.m1.1"><semantics id="S4.T2.45.37.37.4.m1.1a"><msup id="S4.T2.45.37.37.4.m1.1.1" xref="S4.T2.45.37.37.4.m1.1.1.cmml"><mn id="S4.T2.45.37.37.4.m1.1.1.2" xref="S4.T2.45.37.37.4.m1.1.1.2.cmml">0.6349</mn><mo id="S4.T2.45.37.37.4.m1.1.1.3" xref="S4.T2.45.37.37.4.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.45.37.37.4.m1.1b"><apply id="S4.T2.45.37.37.4.m1.1.1.cmml" xref="S4.T2.45.37.37.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.45.37.37.4.m1.1.1.1.cmml" xref="S4.T2.45.37.37.4.m1.1.1">superscript</csymbol><cn id="S4.T2.45.37.37.4.m1.1.1.2.cmml" type="float" xref="S4.T2.45.37.37.4.m1.1.1.2">0.6349</cn><ci id="S4.T2.45.37.37.4.m1.1.1.3.cmml" xref="S4.T2.45.37.37.4.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.45.37.37.4.m1.1c">0.6349^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.45.37.37.4.m1.1d">0.6349 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.46.38.38.5"><math alttext="0.8196^{\star}" class="ltx_Math" display="inline" id="S4.T2.46.38.38.5.m1.1"><semantics id="S4.T2.46.38.38.5.m1.1a"><msup id="S4.T2.46.38.38.5.m1.1.1" xref="S4.T2.46.38.38.5.m1.1.1.cmml"><mn id="S4.T2.46.38.38.5.m1.1.1.2" xref="S4.T2.46.38.38.5.m1.1.1.2.cmml">0.8196</mn><mo id="S4.T2.46.38.38.5.m1.1.1.3" xref="S4.T2.46.38.38.5.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.46.38.38.5.m1.1b"><apply id="S4.T2.46.38.38.5.m1.1.1.cmml" xref="S4.T2.46.38.38.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.46.38.38.5.m1.1.1.1.cmml" xref="S4.T2.46.38.38.5.m1.1.1">superscript</csymbol><cn id="S4.T2.46.38.38.5.m1.1.1.2.cmml" type="float" xref="S4.T2.46.38.38.5.m1.1.1.2">0.8196</cn><ci id="S4.T2.46.38.38.5.m1.1.1.3.cmml" xref="S4.T2.46.38.38.5.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.46.38.38.5.m1.1c">0.8196^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.46.38.38.5.m1.1d">0.8196 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.47.39.39.6"><math alttext="0.6178^{\star}" class="ltx_Math" display="inline" id="S4.T2.47.39.39.6.m1.1"><semantics id="S4.T2.47.39.39.6.m1.1a"><msup id="S4.T2.47.39.39.6.m1.1.1" xref="S4.T2.47.39.39.6.m1.1.1.cmml"><mn id="S4.T2.47.39.39.6.m1.1.1.2" xref="S4.T2.47.39.39.6.m1.1.1.2.cmml">0.6178</mn><mo id="S4.T2.47.39.39.6.m1.1.1.3" xref="S4.T2.47.39.39.6.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.47.39.39.6.m1.1b"><apply id="S4.T2.47.39.39.6.m1.1.1.cmml" xref="S4.T2.47.39.39.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.47.39.39.6.m1.1.1.1.cmml" xref="S4.T2.47.39.39.6.m1.1.1">superscript</csymbol><cn id="S4.T2.47.39.39.6.m1.1.1.2.cmml" type="float" xref="S4.T2.47.39.39.6.m1.1.1.2">0.6178</cn><ci id="S4.T2.47.39.39.6.m1.1.1.3.cmml" xref="S4.T2.47.39.39.6.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.47.39.39.6.m1.1c">0.6178^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.47.39.39.6.m1.1d">0.6178 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.48.40.40.7"><math alttext="0.7089^{\star}" class="ltx_Math" display="inline" id="S4.T2.48.40.40.7.m1.1"><semantics id="S4.T2.48.40.40.7.m1.1a"><msup id="S4.T2.48.40.40.7.m1.1.1" xref="S4.T2.48.40.40.7.m1.1.1.cmml"><mn id="S4.T2.48.40.40.7.m1.1.1.2" xref="S4.T2.48.40.40.7.m1.1.1.2.cmml">0.7089</mn><mo id="S4.T2.48.40.40.7.m1.1.1.3" xref="S4.T2.48.40.40.7.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.48.40.40.7.m1.1b"><apply id="S4.T2.48.40.40.7.m1.1.1.cmml" xref="S4.T2.48.40.40.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.48.40.40.7.m1.1.1.1.cmml" xref="S4.T2.48.40.40.7.m1.1.1">superscript</csymbol><cn id="S4.T2.48.40.40.7.m1.1.1.2.cmml" type="float" xref="S4.T2.48.40.40.7.m1.1.1.2">0.7089</cn><ci id="S4.T2.48.40.40.7.m1.1.1.3.cmml" xref="S4.T2.48.40.40.7.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.48.40.40.7.m1.1c">0.7089^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.48.40.40.7.m1.1d">0.7089 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.63.15">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.63.15.1">Shared Bottom</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.63.15.2">0.7228</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.63.15.3">0.6169</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.63.15.4">0.7389</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.63.15.5">0.6321</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.63.15.6">0.6073</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.56.48.63.15.7">0.6077</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T2.56.48.63.15.8">0.6268</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.64.16">
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.64.16.1">Shared Bottom_DN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.64.16.2">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.64.16.2.1">\ul</span>0.7250</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.64.16.3">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.64.16.3.1">\ul</span>0.6176</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.64.16.4">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.64.16.4.1">\ul</span>0.7396</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.64.16.5">0.6323</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.64.16.6">0.6081</td>
<td class="ltx_td ltx_align_center" id="S4.T2.56.48.64.16.7">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.64.16.7.1">\ul</span>0.6253</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.56.48.64.16.8">
<span class="ltx_ERROR undefined" id="S4.T2.56.48.64.16.8.1">\ul</span>0.6294</td>
</tr>
<tr class="ltx_tr" id="S4.T2.49.41.41">
<td class="ltx_td ltx_align_center" id="S4.T2.49.41.41.2">Shared Bottom_EP</td>
<td class="ltx_td ltx_align_center" id="S4.T2.49.41.41.3">0.7243</td>
<td class="ltx_td ltx_align_center" id="S4.T2.49.41.41.1"><math alttext="0.6182" class="ltx_Math" display="inline" id="S4.T2.49.41.41.1.m1.1"><semantics id="S4.T2.49.41.41.1.m1.1a"><mn id="S4.T2.49.41.41.1.m1.1.1" xref="S4.T2.49.41.41.1.m1.1.1.cmml">0.6182</mn><annotation-xml encoding="MathML-Content" id="S4.T2.49.41.41.1.m1.1b"><cn id="S4.T2.49.41.41.1.m1.1.1.cmml" type="float" xref="S4.T2.49.41.41.1.m1.1.1">0.6182</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.49.41.41.1.m1.1c">0.6182</annotation><annotation encoding="application/x-llamapun" id="S4.T2.49.41.41.1.m1.1d">0.6182</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T2.49.41.41.4">0.7392</td>
<td class="ltx_td ltx_align_center" id="S4.T2.49.41.41.5">
<span class="ltx_ERROR undefined" id="S4.T2.49.41.41.5.1">\ul</span>0.6331</td>
<td class="ltx_td ltx_align_center" id="S4.T2.49.41.41.6">
<span class="ltx_ERROR undefined" id="S4.T2.49.41.41.6.1">\ul</span>0.6268</td>
<td class="ltx_td ltx_align_center" id="S4.T2.49.41.41.7">0.6174</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S4.T2.49.41.41.8">0.6233</td>
</tr>
<tr class="ltx_tr" id="S4.T2.56.48.48">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.56.48.48.8">Shared Bottom_ours</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.50.42.42.1"><math alttext="0.7269^{\star}" class="ltx_Math" display="inline" id="S4.T2.50.42.42.1.m1.1"><semantics id="S4.T2.50.42.42.1.m1.1a"><msup id="S4.T2.50.42.42.1.m1.1.1" xref="S4.T2.50.42.42.1.m1.1.1.cmml"><mn id="S4.T2.50.42.42.1.m1.1.1.2" xref="S4.T2.50.42.42.1.m1.1.1.2.cmml">0.7269</mn><mo id="S4.T2.50.42.42.1.m1.1.1.3" xref="S4.T2.50.42.42.1.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.50.42.42.1.m1.1b"><apply id="S4.T2.50.42.42.1.m1.1.1.cmml" xref="S4.T2.50.42.42.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.50.42.42.1.m1.1.1.1.cmml" xref="S4.T2.50.42.42.1.m1.1.1">superscript</csymbol><cn id="S4.T2.50.42.42.1.m1.1.1.2.cmml" type="float" xref="S4.T2.50.42.42.1.m1.1.1.2">0.7269</cn><ci id="S4.T2.50.42.42.1.m1.1.1.3.cmml" xref="S4.T2.50.42.42.1.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.50.42.42.1.m1.1c">0.7269^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.50.42.42.1.m1.1d">0.7269 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.51.43.43.2"><math alttext="0.6182^{\star}" class="ltx_Math" display="inline" id="S4.T2.51.43.43.2.m1.1"><semantics id="S4.T2.51.43.43.2.m1.1a"><msup id="S4.T2.51.43.43.2.m1.1.1" xref="S4.T2.51.43.43.2.m1.1.1.cmml"><mn id="S4.T2.51.43.43.2.m1.1.1.2" xref="S4.T2.51.43.43.2.m1.1.1.2.cmml">0.6182</mn><mo id="S4.T2.51.43.43.2.m1.1.1.3" xref="S4.T2.51.43.43.2.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.51.43.43.2.m1.1b"><apply id="S4.T2.51.43.43.2.m1.1.1.cmml" xref="S4.T2.51.43.43.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.51.43.43.2.m1.1.1.1.cmml" xref="S4.T2.51.43.43.2.m1.1.1">superscript</csymbol><cn id="S4.T2.51.43.43.2.m1.1.1.2.cmml" type="float" xref="S4.T2.51.43.43.2.m1.1.1.2">0.6182</cn><ci id="S4.T2.51.43.43.2.m1.1.1.3.cmml" xref="S4.T2.51.43.43.2.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.51.43.43.2.m1.1c">0.6182^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.51.43.43.2.m1.1d">0.6182 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.52.44.44.3"><math alttext="0.7400^{\star}" class="ltx_Math" display="inline" id="S4.T2.52.44.44.3.m1.1"><semantics id="S4.T2.52.44.44.3.m1.1a"><msup id="S4.T2.52.44.44.3.m1.1.1" xref="S4.T2.52.44.44.3.m1.1.1.cmml"><mn id="S4.T2.52.44.44.3.m1.1.1.2" xref="S4.T2.52.44.44.3.m1.1.1.2.cmml">0.7400</mn><mo id="S4.T2.52.44.44.3.m1.1.1.3" xref="S4.T2.52.44.44.3.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.52.44.44.3.m1.1b"><apply id="S4.T2.52.44.44.3.m1.1.1.cmml" xref="S4.T2.52.44.44.3.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.52.44.44.3.m1.1.1.1.cmml" xref="S4.T2.52.44.44.3.m1.1.1">superscript</csymbol><cn id="S4.T2.52.44.44.3.m1.1.1.2.cmml" type="float" xref="S4.T2.52.44.44.3.m1.1.1.2">0.7400</cn><ci id="S4.T2.52.44.44.3.m1.1.1.3.cmml" xref="S4.T2.52.44.44.3.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.52.44.44.3.m1.1c">0.7400^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.52.44.44.3.m1.1d">0.7400 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.53.45.45.4"><math alttext="0.6341^{\star}" class="ltx_Math" display="inline" id="S4.T2.53.45.45.4.m1.1"><semantics id="S4.T2.53.45.45.4.m1.1a"><msup id="S4.T2.53.45.45.4.m1.1.1" xref="S4.T2.53.45.45.4.m1.1.1.cmml"><mn id="S4.T2.53.45.45.4.m1.1.1.2" xref="S4.T2.53.45.45.4.m1.1.1.2.cmml">0.6341</mn><mo id="S4.T2.53.45.45.4.m1.1.1.3" xref="S4.T2.53.45.45.4.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.53.45.45.4.m1.1b"><apply id="S4.T2.53.45.45.4.m1.1.1.cmml" xref="S4.T2.53.45.45.4.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.53.45.45.4.m1.1.1.1.cmml" xref="S4.T2.53.45.45.4.m1.1.1">superscript</csymbol><cn id="S4.T2.53.45.45.4.m1.1.1.2.cmml" type="float" xref="S4.T2.53.45.45.4.m1.1.1.2">0.6341</cn><ci id="S4.T2.53.45.45.4.m1.1.1.3.cmml" xref="S4.T2.53.45.45.4.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.53.45.45.4.m1.1c">0.6341^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.53.45.45.4.m1.1d">0.6341 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.54.46.46.5"><math alttext="0.8323^{\star}" class="ltx_Math" display="inline" id="S4.T2.54.46.46.5.m1.1"><semantics id="S4.T2.54.46.46.5.m1.1a"><msup id="S4.T2.54.46.46.5.m1.1.1" xref="S4.T2.54.46.46.5.m1.1.1.cmml"><mn id="S4.T2.54.46.46.5.m1.1.1.2" xref="S4.T2.54.46.46.5.m1.1.1.2.cmml">0.8323</mn><mo id="S4.T2.54.46.46.5.m1.1.1.3" xref="S4.T2.54.46.46.5.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.54.46.46.5.m1.1b"><apply id="S4.T2.54.46.46.5.m1.1.1.cmml" xref="S4.T2.54.46.46.5.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.54.46.46.5.m1.1.1.1.cmml" xref="S4.T2.54.46.46.5.m1.1.1">superscript</csymbol><cn id="S4.T2.54.46.46.5.m1.1.1.2.cmml" type="float" xref="S4.T2.54.46.46.5.m1.1.1.2">0.8323</cn><ci id="S4.T2.54.46.46.5.m1.1.1.3.cmml" xref="S4.T2.54.46.46.5.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.54.46.46.5.m1.1c">0.8323^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.54.46.46.5.m1.1d">0.8323 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.55.47.47.6"><math alttext="0.6262^{\star}" class="ltx_Math" display="inline" id="S4.T2.55.47.47.6.m1.1"><semantics id="S4.T2.55.47.47.6.m1.1a"><msup id="S4.T2.55.47.47.6.m1.1.1" xref="S4.T2.55.47.47.6.m1.1.1.cmml"><mn id="S4.T2.55.47.47.6.m1.1.1.2" xref="S4.T2.55.47.47.6.m1.1.1.2.cmml">0.6262</mn><mo id="S4.T2.55.47.47.6.m1.1.1.3" xref="S4.T2.55.47.47.6.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.55.47.47.6.m1.1b"><apply id="S4.T2.55.47.47.6.m1.1.1.cmml" xref="S4.T2.55.47.47.6.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.55.47.47.6.m1.1.1.1.cmml" xref="S4.T2.55.47.47.6.m1.1.1">superscript</csymbol><cn id="S4.T2.55.47.47.6.m1.1.1.2.cmml" type="float" xref="S4.T2.55.47.47.6.m1.1.1.2">0.6262</cn><ci id="S4.T2.55.47.47.6.m1.1.1.3.cmml" xref="S4.T2.55.47.47.6.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.55.47.47.6.m1.1c">0.6262^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.55.47.47.6.m1.1d">0.6262 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T2.56.48.48.7"><math alttext="0.7182^{\star}" class="ltx_Math" display="inline" id="S4.T2.56.48.48.7.m1.1"><semantics id="S4.T2.56.48.48.7.m1.1a"><msup id="S4.T2.56.48.48.7.m1.1.1" xref="S4.T2.56.48.48.7.m1.1.1.cmml"><mn id="S4.T2.56.48.48.7.m1.1.1.2" xref="S4.T2.56.48.48.7.m1.1.1.2.cmml">0.7182</mn><mo id="S4.T2.56.48.48.7.m1.1.1.3" xref="S4.T2.56.48.48.7.m1.1.1.3.cmml">⋆</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T2.56.48.48.7.m1.1b"><apply id="S4.T2.56.48.48.7.m1.1.1.cmml" xref="S4.T2.56.48.48.7.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.56.48.48.7.m1.1.1.1.cmml" xref="S4.T2.56.48.48.7.m1.1.1">superscript</csymbol><cn id="S4.T2.56.48.48.7.m1.1.1.2.cmml" type="float" xref="S4.T2.56.48.48.7.m1.1.1.2">0.7182</cn><ci id="S4.T2.56.48.48.7.m1.1.1.3.cmml" xref="S4.T2.56.48.48.7.m1.1.1.3">⋆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.56.48.48.7.m1.1c">0.7182^{\star}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.56.48.48.7.m1.1d">0.7182 start_POSTSUPERSCRIPT ⋆ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4. </span><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS4.1.1">Baselines</span>
</h4>
<div class="ltx_para" id="S4.SS1.SSS4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.p1.1">There are few works aimed at explicitly enhancing multi-scenario recommendation. Besides, previous LLM-based models are not applicable in the same setting (refer to Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S5.SS2" title="5.2. Language Model for CTR Prediction ‣ 5. Related Work ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">5.2</span></a>), e.g., LLM as recommender fails to meet real-time inference requirement. Consequently, we compare LLM4MSR with two
typical paradigm as baseline methods:
</p>
<ul class="ltx_itemize" id="S4.I4">
<li class="ltx_item" id="S4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i1.p1">
<p class="ltx_p" id="S4.I4.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i1.p1.1.1">Dynamic Network</span>. It targets at adaptively generating model parameters in a fine-grained manner <cite class="ltx_cite ltx_citemacro_citep">(Yan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib33" title="">2022</a>)</cite>. In multi-scenario modeling <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib36" title="">2022</a>)</cite>, the scenario knowledge is employed to generate scenario-specific attention and tower module.</p>
</div>
</li>
<li class="ltx_item" id="S4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I4.i2.p1">
<p class="ltx_p" id="S4.I4.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I4.i2.p1.1.1">EPNet</span>. It is a gate structure proposed in PEPNet <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib4" title="">2023</a>)</cite>. Specifically, it takes domain-side information as input and produce scenario-specific gates to transform embedding.
</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.5. </span><span class="ltx_text ltx_font_bold" id="S4.SS1.SSS5.1.1">Implementation Details</span>
</h4>
<div class="ltx_para" id="S4.SS1.SSS5.p1">
<p class="ltx_p" id="S4.SS1.SSS5.p1.1">The implementation details of the experiments conducted are summarized in <span class="ltx_text ltx_font_bold" id="S4.SS1.SSS5.p1.1.1">Appendix <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#A1" title="Appendix A EXPERIMENTAL SETTINGS ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">A</span></a></span>
and the code is available to ease reproduction<sup class="ltx_sup" id="S4.SS1.SSS5.p1.1.2"><a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#footnote1" title="footnote 1 ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a></sup>. Specifically, for the open-source LLM we choose ChatGLM2-6B<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/THUDM/chatglm2-6b" title="">https://huggingface.co/THUDM/chatglm2-6b</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Du et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib10" title="">2022</a>)</cite> as an example.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Overall Performance (RQ1)</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">To answer <span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">RQ1</span>, we verify LLM4MSR’s compatibility with various multi-scenario backbone models introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS1.SSS3" title="4.1.3. Backbone Models ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4.1.3</span></a>. Meanwhile, LLM4MSR is compared with two methods for multi-scenario recommendation enhancement as the baseline methods detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS1.SSS4" title="4.1.4. Baselines ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4.1.4</span></a>. The overall performance of AUC on KuaiSAR-small, KuaiSAR, and Amazon dataset is shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.T2" title="Table 2 ‣ 4.1.3. Backbone Models ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">First, Dynamic Network and EPNet are able to simultaneously improve the recommendation accuracy on different scenarios in most cases, while there are exceptions like ‘AITM_DN’ on KuaiSAR and ‘STAR_EP’ on all datasets. By contrast, the proposed LLM4MSR significantly enhances the recommendation performance in all scenarios on the three datasets especially in Rec#1 and Rec#3 on Amazon. It also consistently outperforms the baseline methods except in the search scenario on KuaiSAR-small based on MMoE. The reason for its superiority is that,
on the one hand, both the multi-scenario backbone models and baseline methods incorporate insufficient scenario knowledge, i.e., domain id only, and lack personalized modeling.
On the other hand, LLM4MSR first utilizes LLM to explore domain correlation and infer personalized cross-scenario interest, then integrates meta network to explicitly enhance multi-scenario modeling capability.
Besides, we observe that compared with the significant enhancement on scenario Rec#1 and Rec#3, LLM4MSR results in relatively subtle improvement (around 0.7%) on scenario Rec#2 on Amazon. The reason is that Rec#1 and Rec#3 are relatively sparse where each user has 1.4 and 2.3 interactions on average as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.T1" title="Table 1 ‣ 4.1.1. Datasets ‣ 4.1. Experimental Settings ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. Therefore, less information of user preference on these two scenarios could be captured by LLM to enhance Rec#2.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">Overall, LLM4MSR achieves an increase of 1.5%, 1%, and 40% in AUC on three datasets.
To summarize, we can draw the conclusion that LLM4MSR serves as an effective and powerful enhancement paradigm, which possesses great compatibility and deployability on the mainstream multi-scenario recommendation backbone models.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Ablation &amp; Component Study (RQ2)</h3>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.1" style="width:149.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="383" id="S4.F3.1.1.g1" src="x3.png" width="595"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.2" style="width:137.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="419" id="S4.F3.2.1.g1" src="x4.png" width="595"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F3.3" style="width:137.5pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="634" id="S4.F3.3.1.g1" src="x5.png" width="827"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.5.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.6.2" style="font-size:90%;">Ablation and component study on KuaiSAR-small, KuaiSAR, and Amazon dataset. The prefix ‘user’ and ‘domain’ denotes user-level and domain-level prompt while the suffix ‘bottom’ and ‘parallel’ indicates the architecture applied. We adopt the ratio of improvement in AUC value compared with the original STAR model as the backbone.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To answer <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">RQ2</span>, we conduct ablation study and component analysis based on STAR considering the following variants.</p>
<ul class="ltx_itemize" id="S4.I5">
<li class="ltx_item" id="S4.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i1.p1">
<p class="ltx_p" id="S4.I5.i1.p1.1">user-bottom / user-parallel: It only adopts user-level meta layers at bottom / in parallel <span class="ltx_text ltx_font_bold" id="S4.I5.i1.p1.1.1">without</span> scenario knowledge as input.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i2.p1">
<p class="ltx_p" id="S4.I5.i2.p1.1">domain-bottom / domain-parallel: It only adopts scenario-level meta layers at bottom / in parallel <span class="ltx_text ltx_font_bold" id="S4.I5.i2.p1.1.1">without</span> user knowledge.</p>
</div>
</li>
<li class="ltx_item" id="S4.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I5.i3.p1">
<p class="ltx_p" id="S4.I5.i3.p1.1">LLM4MSR: Full model with both user-bottom and domain-parallel.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS3.p1.2">The results are depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.F3" title="Figure 3 ‣ 4.3. Ablation &amp; Component Study (RQ2) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>.
On the one hand, the full model LLM4MSR achieves the best result on all scenarios on all the three datasets. The reason is that it makes full use of both the informative multi-scenario knowledge and the collaborative signal learned from the LLM and MSR backbone model, respectively. Meanwhile, from ‘user - bottom’ and ‘domain - parallel’ it is seen that both user- and domain-level prompt contribute to the performance enhancement on the backbone model. Nonetheless, the domain-level prompt plays a more significant role on KuaiSAR-small and KuaiSAR dataset, while the user-level prompt is a more essential component on Amazon dataset.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">On the other hand, comparing ‘user - bottom’ and ‘user - parallel’ we can observe that the former is better while the latter structure even has a negative impact in many cases. Similarly, placing the layers generated from the domain-level prompt in parallel to the scenario tower of the backbone model is the better choice contrasting ‘domain - bottom’ and ‘domain - parallel’. Consequently, we can draw the conclusion that the combination of layers from user-level prompt at bottom and layers from domain-level prompt in parallel is the optimal architecture. A reasonable explanation is that the user-level multi-scenario information helps personalizing and modulating the general embedding better in a lower level. By contrast, the scenario-level information acts better in a higher level like the auxiliary network adopted in STAR <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>)</cite>.
Last but not least, it is intuitive to investigate the effect of LLM by replacing the obtained knowledge in the form of hidden states with <span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">randomly initialized</span> vectors. However, such enhancement is not observed.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Hyper-parameter Analysis (RQ3)</h3>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F4.1" style="width:214.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="363" id="S4.F4.1.1.g1" src="x6.png" width="595"/>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="S4.F4.2" style="width:214.6pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="363" id="S4.F4.2.1.g1" src="x7.png" width="595"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.4.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S4.F4.5.2" style="font-size:90%;">Analysis on the positive interaction threshold and meta layers evaluated by AUC on KuaiSAR-small dataset.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.4">We analyze the effect of two significant hyper-parameters, i.e., the threshold (<math alttext="T" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><mi id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><ci id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_T</annotation></semantics></math>) of positive interactions in the user-level prompt and the number of fully connected layers (<math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mi id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><ci id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_K</annotation></semantics></math>) generated by the meta network using STAR as the backbone model on KuaiSAR-small dataset.
Specifically, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.F4" title="Figure 4 ‣ 4.4. Hyper-parameter Analysis (RQ3) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>(a), the recommendation accuracy continuously increases as <math alttext="T" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_T</annotation></semantics></math> rises until the token limit of LLM is reached, since more information about cross-scenario preference of users is introduced and captured by LLM. Besides, from Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.F4" title="Figure 4 ‣ 4.4. Hyper-parameter Analysis (RQ3) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>(b) we can see that the best performance is obtained where <math alttext="K=2" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><mrow id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">K</mi><mo id="S4.SS4.p1.4.m4.1.1.1" xref="S4.SS4.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><eq id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1.1"></eq><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">𝐾</ci><cn id="S4.SS4.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS4.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">K=2</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">italic_K = 2</annotation></semantics></math>. Nevertheless, the results degrade as the network becomes deeper and a possible reason is overfitting.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Efficiency Analysis (RQ4)</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">To validate the efficiency of our proposed LLM4MSR paradigm, we take STAR as the backbone model and experiment on KuaiSAR-small dataset. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.T3" title="Table 3 ‣ 4.6. Case Study (RQ5) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, as an LLM-based method, LLM4MSR still enables real-time inference even if it requires more training and inference time than other baseline methods.
Besides, the real-world industrial system has a maximum latency specification (let’s say 0.1s), and the present inference time (0.05s in our method) will not undermine the effectiveness of system considering both latency and success rate, while significant improvement of performance is still achieved. Consequently, LLM4MSR possesses an <span class="ltx_text ltx_font_bold" id="S4.SS5.p1.1.1">excellent trade-off</span> in effectiveness and efficiency.</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<p class="ltx_p" id="S4.SS5.p2.1">In practice, the last hidden states generated from the user-level prompt can be stored before training, since inferring user preference is the most time-consuming step in LLM4MSR and it takes about 2 to 4 seconds per user on one single GPU. Besides, the architecture with scenario-level parameters only (i.e., ‘domain - parallel’ in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.SS3" title="4.3. Ablation &amp; Component Study (RQ2) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4.3</span></a>) can serve as an alternative approach because the scenario-level prompt does not require frequent updates or personalization, thus leading to higher efficiency.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6. </span>Case Study (RQ5)</h3>
<figure class="ltx_figure" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="562" id="S4.F5.g1" src="x8.png" width="694"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.2.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S4.F5.3.2" style="font-size:90%;">Case study of user_1 on KuaiSAR-small dataset. The purple and blue box denote the result on the scenario correlation and the inferred cross-scenario preferences from scenario- and user-level prompt by ChatGLM2-6B.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">To answer <span class="ltx_text ltx_font_bold" id="S4.SS6.p1.1.1">RQ5</span>, we conduct a case study on KuaiSAR-small dataset taking user_1 as an example and the results generated from the corresponding designed scenario- and user-level prompt by ChatGLM2-6B are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S4.F5" title="Figure 5 ‣ 4.6. Case Study (RQ5) ‣ 4. Experiments ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a>.
Specifically, we can see that ChatGLM2-6B not only explicitly captures the commonality and distinction between the recommendation and search scenario, but it also clearly infers user_1’s common and distinct interests among these two scenarios with an accurate user profile summary. Afterward, the generated information is integrated hierarchically by the meta network and meta layers. Consequently, the performance of the multi-scenario backbone model is enhanced. Meanwhile, this knowledge in different levels from LLM also helps improving the interpretability of the original recommender system.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3. </span>Efficiency comparison on KuaiSAR-small in seconds.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.4" style="width:206.0pt;height:42.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-27.4pt,5.7pt) scale(0.789996614949842,0.789996614949842) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.1.1"><span class="ltx_text" id="S4.T3.4.1.1.1.1.1" style="font-size:90%;">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.1.2"><span class="ltx_text" id="S4.T3.4.1.1.1.2.1" style="font-size:90%;">STAR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.1.3"><span class="ltx_text" id="S4.T3.4.1.1.1.3.1" style="font-size:90%;">STAR_DN</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.1.4"><span class="ltx_text" id="S4.T3.4.1.1.1.4.1" style="font-size:90%;">STAR_EP</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.1.5"><span class="ltx_text" id="S4.T3.4.1.1.1.5.1" style="font-size:90%;">STAR_ours</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.2.1.1"><span class="ltx_text" id="S4.T3.4.1.2.1.1.1" style="font-size:90%;">Training</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.2.1.2"><span class="ltx_text" id="S4.T3.4.1.2.1.2.1" style="font-size:90%;">2.8e-2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.2.1.3"><span class="ltx_text" id="S4.T3.4.1.2.1.3.1" style="font-size:90%;">2.9e-2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.2.1.4"><span class="ltx_text" id="S4.T3.4.1.2.1.4.1" style="font-size:90%;">2.9e-2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.4.1.2.1.5"><span class="ltx_text" id="S4.T3.4.1.2.1.5.1" style="font-size:90%;">1.5e-1</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.1.3.2.1"><span class="ltx_text" id="S4.T3.4.1.3.2.1.1" style="font-size:90%;">Inference</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.1.3.2.2"><span class="ltx_text" id="S4.T3.4.1.3.2.2.1" style="font-size:90%;">1.7e-2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.1.3.2.3"><span class="ltx_text" id="S4.T3.4.1.3.2.3.1" style="font-size:90%;">1.7e-2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.1.3.2.4"><span class="ltx_text" id="S4.T3.4.1.3.2.4.1" style="font-size:90%;">1.7e-2</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.4.1.3.2.5"><span class="ltx_text" id="S4.T3.4.1.3.2.5.1" style="font-size:90%;">5.2e-2</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Related Work</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This section brief summarizes the recent work on multi-scenario recommendation and adopting language model for CTR prediction.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Multi-Scenario Recommendation</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Multi-scenario recommendation <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib30" title="">2023c</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib28" title="">2022a</a>)</cite>, also known as multi-domain or multi-target cross-domain recommendation <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib39" title="">2021</a>)</cite>, uses the data from all scenarios to simultaneously improve their recommendation performance and tackle data sparsity problem. For example,
STAR <cite class="ltx_cite ltx_citemacro_citep">(Sheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib22" title="">2021</a>)</cite> adopts a star-like framework with a shared centered network and scenario-specific networks similar to the parameter sharing pattern design in multi-task modeling <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib29" title="">2023a</a>)</cite>.
M2M <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib36" title="">2022</a>)</cite> proposes a meta learning mechanism with hierarchically organized meta attention and meta tower module to grasp inter-scenario correlations and scenario-specific representation.
In addition, to address the imperfectly double seesaw phenomenon, PEPNet <cite class="ltx_cite ltx_citemacro_citep">(Chang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib4" title="">2023</a>)</cite> proposes embedding and parameter personalized network to dynamically scale the parameters based on the designed gate mechanism in a domain-specific and task-specific manner, respectively.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">Facing the drawbacks of the aforementioned methods introduced in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S1" title="1. Introduction ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, i.e., insufficient integration of scenario knowledge and neglecting personalized interest across different scenarios, our proposed framework leverages LLM to uncover domain commonality and distinction and infer users’ cross-scenario preference, which are further utilized to enhance the multi-scenario backbone model.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Language Model for CTR Prediction</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">Several works try to incorporate Language Models (LMs) including Large Language Models (LLMs) and Pre-trained Language Models (PLMs) as illustrated in Section <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.SS3" title="2.3. Large Language Model ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">2.3</span></a> with recommendation for Click-Through Rate (CTR) prediction <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>; Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib32" title="">2023</a>; Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib18" title="">2023</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib26" title="">2023b</a>; Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib14" title="">2023</a>)</cite> since they have the potential to bring information gain. Specifically, one of the solutions is to treat the semantic knowledge as cross-modal information and align with the collaborative signal in conventional recommender systems. For example, CTRL <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib17" title="">2023</a>)</cite> employs contrastive learning for knowledge alignment and integration. KAR <cite class="ltx_cite ltx_citemacro_citep">(Xi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib32" title="">2023</a>)</cite> first generates reasoning knowledge of user preferences and item factual information, then encodes and adapts them to the backbone recommendation models. Besides, S&amp;R Multi-domain Foundation Model <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib14" title="">2023</a>)</cite> simply adopts LLM to extract scenario-invariant text features and tackle item heterogeneity issue.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">However, on the one hand, these methods necessitate conducting both training and inference with LM in the sample level, leading to low efficiency of inference and poor deployability on industrial recommender systems. On the other hand, the connection between scenarios and personalized modeling are ignored.
In this paper, we investigate a new LLM-enhanced paradigm, which not only improves the performance of multi-scenario modeling through the inferred scenario-level correlation and user-level cross-scenario interest, but it also enables efficient training and real-time inference.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we propose an effective efficient interpretable paradigm LLM4MSR which first leverages LLM to reason about multi-scenario knowledge, including scenario commonality and distinction, and users’ cross-scenario preferences through the designed scenario- and user-level prompt. Then it adopts hierarchical meta networks which generate meta layers to adaptively fuse the multi-level knowledge and improve the conventional multi-scenario recommender systems. Extensive experiments on three public datasets validate that LLM4MSR is not only an effective paradigm compatible with various multi-scenario backbone models, but it is also efficient without fine-tuning LLM and enables real-time recommendation on industrial recommender systems. Besides, the interpretability of conventional recommender system is improved.

</p>
</div>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>EXPERIMENTAL SETTINGS</h2>
<figure class="ltx_table" id="A1.T4">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 4. </span>The hyper-parameter settings of experiments.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="A1.T4.4" style="width:206.0pt;height:59.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-53.8pt,15.4pt) scale(0.657007293688747,0.657007293688747) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="A1.T4.4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="A1.T4.4.1.1.1.1"><span class="ltx_text" id="A1.T4.4.1.1.1.1.1" style="font-size:90%;">Dataset</span></th>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T4.4.1.1.1.2"><span class="ltx_text" id="A1.T4.4.1.1.1.2.1" style="font-size:90%;">KuaiSAR-small</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T4.4.1.1.1.3"><span class="ltx_text" id="A1.T4.4.1.1.1.3.1" style="font-size:90%;">KuaiSAR</span></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T4.4.1.1.1.4"><span class="ltx_text" id="A1.T4.4.1.1.1.4.1" style="font-size:90%;">Amazon</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T4.4.1.2.2.1"><span class="ltx_text" id="A1.T4.4.1.2.2.1.1" style="font-size:90%;">Embedding dimension</span></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.4.1.2.2.2"><span class="ltx_text" id="A1.T4.4.1.2.2.2.1" style="font-size:90%;">16</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.4.1.2.2.3"><span class="ltx_text" id="A1.T4.4.1.2.2.3.1" style="font-size:90%;">16</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.4.1.2.2.4"><span class="ltx_text" id="A1.T4.4.1.2.2.4.1" style="font-size:90%;">16</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.4.1.3.3.1"><span class="ltx_text" id="A1.T4.4.1.3.3.1.1" style="font-size:90%;">Batch size</span></th>
<td class="ltx_td ltx_align_left" id="A1.T4.4.1.3.3.2"><span class="ltx_text" id="A1.T4.4.1.3.3.2.1" style="font-size:90%;">4096</span></td>
<td class="ltx_td ltx_align_left" id="A1.T4.4.1.3.3.3"><span class="ltx_text" id="A1.T4.4.1.3.3.3.1" style="font-size:90%;">4096</span></td>
<td class="ltx_td ltx_align_left" id="A1.T4.4.1.3.3.4"><span class="ltx_text" id="A1.T4.4.1.3.3.4.1" style="font-size:90%;">1024</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T4.4.1.4.4.1"><span class="ltx_text" id="A1.T4.4.1.4.4.1.1" style="font-size:90%;">Hidden layers of backbone</span></th>
<td class="ltx_td ltx_align_left" id="A1.T4.4.1.4.4.2"><span class="ltx_text" id="A1.T4.4.1.4.4.2.1" style="font-size:90%;">[256, 128, 64]</span></td>
<td class="ltx_td ltx_align_left" id="A1.T4.4.1.4.4.3"><span class="ltx_text" id="A1.T4.4.1.4.4.3.1" style="font-size:90%;">[256, 128, 64]</span></td>
<td class="ltx_td ltx_align_left" id="A1.T4.4.1.4.4.4"><span class="ltx_text" id="A1.T4.4.1.4.4.4.1" style="font-size:90%;">[64, 32, 16]</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T4.4.1.5.5.1"><span class="ltx_text" id="A1.T4.4.1.5.5.1.1" style="font-size:90%;">Learning rate</span></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T4.4.1.5.5.2"><span class="ltx_text" id="A1.T4.4.1.5.5.2.1" style="font-size:90%;">2e-4</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T4.4.1.5.5.3"><span class="ltx_text" id="A1.T4.4.1.5.5.3.1" style="font-size:90%;">2e-4</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T4.4.1.5.5.4"><span class="ltx_text" id="A1.T4.4.1.5.5.4.1" style="font-size:90%;">2e-3</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">The hyper-parameters are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#A1.T4" title="Table 4 ‣ Appendix A EXPERIMENTAL SETTINGS ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>. Meanwhile, the designed template of scenario- and user-level prompt are shown in the purple and blue box in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#S2.F2" title="Figure 2 ‣ 2.3. Large Language Model ‣ 2. Preliminary ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>, respectively. Specifically, the most recent 55, 55, and 35 positive interactions, i.e., with click, forward, and like behavior on each scenario are leveraged when constructing the user-level prompt on KuaiSAR-small, KuaiSAR, and Amazon dataset because the maximum context length of ChatGLM2-6B is 8K. Besides, the Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#bib.bib16" title="">2014</a>)</cite> optimizer is adopted. The meta network employed is simply a fully connected network.
Overall,
all the experimental results shown are averaged over 3 runs.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Prompt template</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">In this section, we provide the designed scenario-level and user-level prompt template, where the information in square brackets needs to be filled. Specifically, to capture the commonality among scenarios and emphasize distinction for each scenario, the present scenario-level prompts only differ in the instruction: ‘explicitly summarize the distinction of [scenario_i name]’, where [scenario_i name] is the name of each scenario like recommendation or search scenario in KuaiSAR. Meanwhile, other distinctive information of scenario like prior expert knowledge can be provided. That’s the reason why the prompts are constructed separately for each scenario in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2406.12529v1#alg1" title="In 3.1. Overall Framework ‣ 3. Proposed Method ‣ LLM4MSR: An LLM-Enhanced Paradigm for Multi-Scenario Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.
Prompts with the best performance are:

</p>
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i1.p1.1.1">Scenario-level Prompt:</span></p>
<pre class="ltx_verbatim ltx_font_typewriter" id="A2.I1.i1.p1.2">
"On platform [dataset name], [platform description],
suppose there are [specific number] interactions
in [scenario_1 name], [specific number] interactions
in [scenario_2 name]... Besides, in these scenarios there
are [specific number] users [user description] and
[specific number] items [item description] where
[specific number] users and [specific number] products
are overlapped. From the relationship among these
scenarios and statistics given, explicitly summarize
the scenario commonality among the three scenarios
and the distinction of [scenario name]."
</pre>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i2.p1.1.1">User-level Prompt:</span></p>
<pre class="ltx_verbatim ltx_font_typewriter" id="A2.I1.i2.p1.2">
"On platform [dataset name], suppose there are
[scenario_1 name], [scenario_2 name]... In [scenario_1
name], user_[id] [historical behavior + item_type
+ category]... Besides, in [scenario_2 name], this user
[historical behavior + item_type + category].
For this user, considering the interaction frequency
and item title plus description information, explicitly
summarize the common interest among the three scenarios
first, then summarize the distinct interest in
each scenario."
</pre>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berkson (1944)</span>
<span class="ltx_bibblock">
Joseph Berkson. 1944.

</span>
<span class="ltx_bibblock">Application of the logistic function to bio-assay.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Journal of the American statistical association</em> 39, 227 (1944), 357–365.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al<span class="ltx_text" id="bib.bib3.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.4.1">Advances in neural information processing systems</em> 33 (2020), 1877–1901.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jianxin Chang, Chenbin Zhang, Yiqun Hui, Dewei Leng, Yanan Niu, Yang Song, and Kun Gai. 2023.

</span>
<span class="ltx_bibblock">Pepnet: Parameter and embedding personalized network for infusing with personalized prior information. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 3795–3804.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Shouyuan Chen, Sherman Wong, Liangjian Chen, and Yuandong Tian. 2023b.

</span>
<span class="ltx_bibblock">Extending context window of large language models via positional interpolation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">arXiv preprint arXiv:2306.15595</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Yukang Chen, Shengju Qian, Haotian Tang, Xin Lai, Zhijian Liu, Song Han, and Jiaya Jia. 2023a.

</span>
<span class="ltx_bibblock">Longlora: Efficient fine-tuning of long-context large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">arXiv preprint arXiv:2309.12307</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Heng-Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra, Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, et al<span class="ltx_text" id="bib.bib7.3.1">.</span> 2016.

</span>
<span class="ltx_bibblock">Wide &amp; deep learning for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.4.1">Proceedings of the 1st workshop on deep learning for recommender systems</em>. 7–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Qiang Cui, Tao Wei, Yafeng Zhang, and Qing Zhang. 2020.

</span>
<span class="ltx_bibblock">HeroGRAPH: A Heterogeneous Graph Framework for Multi-Target Cross-Domain Recommendation.. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">ORSUM@ RecSys</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zeyu Cui, Jianxin Ma, Chang Zhou, Jingren Zhou, and Hongxia Yang. 2022.

</span>
<span class="ltx_bibblock">M6-rec: Generative pretrained language models are open-ended recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">arXiv preprint arXiv:2205.08084</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding, Jiezhong Qiu, Zhilin Yang, and Jie Tang. 2022.

</span>
<span class="ltx_bibblock">GLM: General Language Model Pretraining with Autoregressive Blank Infilling. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>. 320–335.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenqi Fan, Zihuai Zhao, Jiatong Li, Yunqing Liu, Xiaowei Mei, Yiqi Wang, Jiliang Tang, and Qing Li. 2023.

</span>
<span class="ltx_bibblock">Recommender systems in the era of large language models (llms).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">arXiv preprint arXiv:2307.02046</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jingtong Gao, Bo Chen, Menghui Zhu, Xiangyu Zhao, Xiaopeng Li, Yuhao Wang, Yichao Wang, Huifeng Guo, and Ruiming Tang. 2023.

</span>
<span class="ltx_bibblock">Scenario-Aware Hierarchical Dynamic Network for Multi-Scenario Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">arXiv preprint arXiv:2309.02061</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang. 2022.

</span>
<span class="ltx_bibblock">Recommendation as language processing (rlp): A unified pretrain, personalized prompt &amp; predict paradigm (p5). In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>. 299–315.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yuqi Gong, Xichen Ding, Yehui Su, Kaiming Shen, Zhongyi Liu, and Guannan Zhang. 2023.

</span>
<span class="ltx_bibblock">An Unified Search and Recommendation Foundation Model for Cold-Start Scenario. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 32nd ACM International Conference on Information and Knowledge Management</em>. 4595–4601.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jacobs et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (1991)</span>
<span class="ltx_bibblock">
Robert A Jacobs, Michael I Jordan, Steven J Nowlan, and Geoffrey E Hinton. 1991.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Neural computation</em> 3, 1 (1991), 79–87.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv:1412.6980</em> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Xiangyang Li, Bo Chen, Lu Hou, and Ruiming Tang. 2023.

</span>
<span class="ltx_bibblock">CTRL: Connect Tabular and Language Model for CTR Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">arXiv preprint arXiv:2306.02841</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jianghao Lin, Bo Chen, Hangyu Wang, Yunjia Xi, Yanru Qu, Xinyi Dai, Kangning Zhang, Ruiming Tang, Yong Yu, and Weinan Zhang. 2023.

</span>
<span class="ltx_bibblock">ClickPrompt: CTR Models are Strong Prompt Generators for Adapting Language Models to CTR Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">arXiv preprint arXiv:2310.09234</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Junling Liu, Chao Liu, Renjie Lv, Kang Zhou, and Yan Zhang. 2023.

</span>
<span class="ltx_bibblock">Is chatgpt a good recommender? a preliminary study.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">arXiv preprint arXiv:2304.10149</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jiaqi Ma, Zhe Zhao, Xinyang Yi, Jilin Chen, Lichan Hong, and Ed H Chi. 2018.

</span>
<span class="ltx_bibblock">Modeling task relationships in multi-task learning with multi-gate mixture-of-experts. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1930–1939.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Jianmo Ni, Jiacheng Li, and Julian McAuley. 2019.

</span>
<span class="ltx_bibblock">Justifying recommendations using distantly-labeled reviews and fine-grained aspects. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">Proceedings of the 2019 conference on empirical methods in natural language processing and the 9th international joint conference on natural language processing (EMNLP-IJCNLP)</em>. 188–197.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sheng et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiangrong Sheng, Liqin Zhao, Guorui Zhou, Xinyao Ding, Binding Dai, Qiang Luo, Siran Yang, Jingshan Lv, Chi Zhang, Hongbo Deng, et al<span class="ltx_text" id="bib.bib22.3.1">.</span> 2021.

</span>
<span class="ltx_bibblock">One model to serve all: Star topology adaptive recommender for multi-domain ctr prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.4.1">Proceedings of the 30th ACM International Conference on Information &amp; Knowledge Management</em>. 4104–4113.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Liangcai Su, Junwei Pan, Ximei Wang, Xi Xiao, Shijie Quan, Xihua Chen, and Jie Jiang. 2023.

</span>
<span class="ltx_bibblock">STEM: Unleashing the Power of Embeddings for Multi-task Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">arXiv preprint arXiv:2308.13537</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Zhongxiang Sun, Zihua Si, Xiaoxue Zang, Dewei Leng, Yanan Niu, Yang Song, Xiao Zhang, and Jun Xu. 2023.

</span>
<span class="ltx_bibblock">KuaiSAR: A Unified Search And Recommendation Dataset.

</span>
<span class="ltx_bibblock">(2023).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3583780.3615123" title="">https://doi.org/10.1145/3583780.3615123</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Hongyan Tang, Junning Liu, Ming Zhao, and Xudong Gong. 2020.

</span>
<span class="ltx_bibblock">Progressive layered extraction (ple): A novel multi-task learning (mtl) model for personalized recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Fourteenth ACM Conference on Recommender Systems</em>. 269–278.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2023b)</span>
<span class="ltx_bibblock">
Hangyu Wang, Jianghao Lin, Xiangyang Li, Bo Chen, Chenxu Zhu, Ruiming Tang, Weinan Zhang, and Yong Yu. 2023b.

</span>
<span class="ltx_bibblock">ALT: Towards Fine-grained Alignment between Language and CTR Models for Click-Through Rate Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">arXiv preprint arXiv:2310.19453</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Thomas Wang, Adam Roberts, Daniel Hesslow, Teven Le Scao, Hyung Won Chung, Iz Beltagy, Julien Launay, and Colin Raffel. 2022b.

</span>
<span class="ltx_bibblock">What language model architecture and pretraining objective works best for zero-shot generalization?. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">International Conference on Machine Learning</em>. PMLR, 22964–22984.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Yichao Wang, Huifeng Guo, Bo Chen, Weiwen Liu, Zhirong Liu, Qi Zhang, Zhicheng He, Hongkun Zheng, Weiwei Yao, Muyu Zhang, et al<span class="ltx_text" id="bib.bib28.3.1">.</span> 2022a.

</span>
<span class="ltx_bibblock">Causalint: Causal inspired intervention for multi-scenario recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.4.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 4090–4099.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023a)</span>
<span class="ltx_bibblock">
Yuhao Wang, Ha Tsz Lam, Yi Wong, Ziru Liu, Xiangyu Zhao, Yichao Wang, Bo Chen, Huifeng Guo, and Ruiming Tang. 2023a.

</span>
<span class="ltx_bibblock">Multi-Task Deep Recommender Systems: A Survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">arXiv preprint arXiv:2302.03525</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2023c)</span>
<span class="ltx_bibblock">
Yuhao Wang, Xiangyu Zhao, Bo Chen, Qidong Liu, Huifeng Guo, Huanshuo Liu, Yichao Wang, Rui Zhang, and Ruiming Tang. 2023c.

</span>
<span class="ltx_bibblock">PLATE: A Prompt-Enhanced Paradigm for Multi-Scenario Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 1498–1507.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Dongbo Xi, Zhen Chen, Peng Yan, Yinger Zhang, Yongchun Zhu, Fuzhen Zhuang, and Yu Chen. 2021.

</span>
<span class="ltx_bibblock">Modeling the sequential dependence among audience multi-step conversions with multi-task learning in targeted display advertising. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining</em>. 3745–3755.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xi et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunjia Xi, Weiwen Liu, Jianghao Lin, Jieming Zhu, Bo Chen, Ruiming Tang, Weinan Zhang, Rui Zhang, and Yong Yu. 2023.

</span>
<span class="ltx_bibblock">Towards Open-World Recommendation with Knowledge Augmentation from Large Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">arXiv preprint arXiv:2306.10933</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Bencheng Yan, Pengjie Wang, Kai Zhang, Feng Li, Hongbo Deng, Jian Xu, and Bo Zheng. 2022.

</span>
<span class="ltx_bibblock">Apg: Adaptive parameter generation network for click-through rate prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Advances in Neural Information Processing Systems</em> 35 (2022), 24740–24752.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Bin Yin, Junjie Xie, Yu Qin, Zixiang Ding, Zhichao Feng, Xiang Li, and Wei Lin. 2023.

</span>
<span class="ltx_bibblock">Heterogeneous knowledge fusion: A novel approach for personalized recommendation via llm. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>. 599–601.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zebari et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Rizgar Zebari, Adnan Abdulazeez, Diyar Zeebaree, Dilovan Zebari, and Jwan Saeed. 2020.

</span>
<span class="ltx_bibblock">A comprehensive review of dimensionality reduction techniques for feature selection and feature extraction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Journal of Applied Science and Technology Trends</em> 1, 2 (2020), 56–70.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Qianqian Zhang, Xinru Liao, Quan Liu, Jian Xu, and Bo Zheng. 2022.

</span>
<span class="ltx_bibblock">Leaving No One Behind: A Multi-Scenario Multi-Task Meta Learning Approach for Advertiser Modeling. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the Fifteenth ACM International Conference on Web Search and Data Mining</em>. 1368–1376.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiangyu Zhao, Haochen Liu, Hui Liu, Jiliang Tang, Weiwei Guo, Jun Shi, Sida Wang, Huiji Gao, and Bo Long. 2021.

</span>
<span class="ltx_bibblock">Autodim: Field-aware embedding dimension searchin recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Proceedings of the Web Conference 2021</em>. 3015–3022.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Bowen Zheng, Yupeng Hou, Hongyu Lu, Yu Chen, Wayne Xin Zhao, and Ji-Rong Wen. 2023.

</span>
<span class="ltx_bibblock">Adapting large language models by integrating collaborative semantics for recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">arXiv preprint arXiv:2311.09049</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Feng Zhu, Yan Wang, Chaochao Chen, Jun Zhou, Longfei Li, and Guanfeng Liu. 2021.

</span>
<span class="ltx_bibblock">Cross-domain recommendation: challenges, progress, and prospects.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">arXiv preprint arXiv:2103.01696</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Jun 18 11:50:14 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
