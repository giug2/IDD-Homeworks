<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation</title>
<!--Generated on Mon Sep  9 15:15:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.07500v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx1" title="In DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx2" title="In DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx2.SSx1" title="In Related Work ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Attack &amp; Defense on Federated Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx2.SSx2" title="In Related Work ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Sequential Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx3" title="In DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx3.SSx1" title="In Preliminaries ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Federated Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx3.SSx2" title="In Preliminaries ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Threat Model</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx3.SSx2.SSS0.Px1" title="In Threat Model ‣ Preliminaries ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Attack Goal.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx3.SSx2.SSS0.Px2" title="In Threat Model ‣ Preliminaries ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Attack Capability and knowledge.</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx4" title="In DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx4.SSx1" title="In Methodology ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">DV-FSR Framework Overview</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx4.SSx1.SSSx1" title="In DV-FSR Framework Overview ‣ Methodology ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Explicit Strategy.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx4.SSx1.SSSx2" title="In DV-FSR Framework Overview ‣ Methodology ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Implicit Strategy.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx4.SSx2" title="In Methodology ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Defense with Mixed-RFA</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5" title="In DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx1" title="In Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Datasets and Experiment Setting</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx1.SSSx2.Px1" title="In Datasets and Experiment Setting ‣ Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Dataset.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx1.SSSx2.Px2" title="In Datasets and Experiment Setting ‣ Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Experiment Setting.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx1.SSSx2.Px3" title="In Datasets and Experiment Setting ‣ Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Baseline Attacks.</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx2" title="In Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Attack Performance Evaluation (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx3" title="In Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Performance Under Attack (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx4" title="In Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">More Malicious Users Increase Attack Effectiveness (RQ3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx5" title="In Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Defense Performance Evaluation (RQ4)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx5.SSx6" title="In Experiments ‣ DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Ablation Study (RQ5)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#Sx6" title="In DV-FSR: A Dual-View Target Attack Framework for Federated Sequential Recommendation"><span class="ltx_text ltx_ref_title">Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document"> DV-FSR: A Dual-View Target Attack Framework for 
<br class="ltx_break"/>Federated Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Qitao Qin<sup class="ltx_sup" id="id1.1.id1">1</sup>,
Yucong Luo<sup class="ltx_sup" id="id2.2.id2">1</sup>,
Mingyue Cheng<sup class="ltx_sup" id="id3.3.id3">1</sup>,
Qingyang Mao<sup class="ltx_sup" id="id4.4.id4">1</sup>,
Chenyi Lei<sup class="ltx_sup" id="id5.5.id5">2</sup>
</span><span class="ltx_author_notes">Corresponding Author</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id6.id1">Federated recommendation (FedRec) preserves user privacy by enabling decentralized training of personalized models, but this architecture is inherently vulnerable to adversarial attacks. Significant research has been conducted on targeted attacks in FedRec systems, motivated by commercial and social influence considerations. However, much of this work has largely overlooked the differential robustness of recommendation models. Moreover, our empirical findings indicate that existing targeted attack methods achieve only limited effectiveness in Federated Sequential Recommendation (FSR) tasks. Driven by these observations, we focus on investigating targeted attacks in FSR and propose a novel dual-view attack framework, named DV-FSR. This attack method uniquely combines a sampling-based explicit strategy with a contrastive learning-based implicit gradient strategy to orchestrate a coordinated attack. Additionally, we introduce a specific defense mechanism tailored for targeted attacks in FSR, aiming to evaluate the mitigation effects of the attack method we proposed.
Extensive experiments validate the effectiveness of our proposed approach on representative sequential models. Our codes are publicly available<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/USTCAGI/DV-FSR</span></span></span>.</p>
</div>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Introduction</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">In recent years, as the performance of recommendation systems continues to thrive, their privacy issues have increasingly garnered attention.
Traditional recommendation systems are trained within a centralized environment, where a data breach can lead to significant economic losses and severe privacy leaks.
To address this problem, federated recommendation systems have emerged as a promising solution <cite class="ltx_cite ltx_citemacro_citep">(Ammad-Ud-Din et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib2" title="">2019</a>; Lin et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib19" title="">2020</a>; Liang, Pan, and Ming <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib18" title="">2021</a>)</cite>. These systems aim to protect user data by decentralizing the learning process. While federated learning (FL) introduces improvements in privacy for recommendation systems, it is not without vulnerabilities. Due to its decentralized training process <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib22" title="">2017</a>)</cite> , attackers can manipulate local training data or upload gradients to achieve certain malicious objectives <cite class="ltx_cite ltx_citemacro_citep">(Bhagoji et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib4" title="">2019</a>; Bagdasaryan et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib3" title="">2020</a>)</cite>.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.1">Thereby, over the past years, some attack methods aimed at federated recommendation systems have emerged. Based
on the goal of the attacker, poisoning attacks can be classified into targeted and untargeted attacks.
The targeted attacks aims to boost targeted item exposure, in several cases, it can even influence public opinion on social media and change the public’s views or attitudes on specific heat events, resulting substantial commercial and social impact.
However, in studies focusing on the robustness of federated recommendation systems especially in targeted item attack <cite class="ltx_cite ltx_citemacro_citep">(Rong et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib26" title="">2022</a>; Zhang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib36" title="">2022</a>; Rong, He, and Chen <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib25" title="">2022</a>)</cite>, experiments on sequential recommendation models are almost nonexistent. Instead, nearly all experimental efforts are concentrated on Matrix Factorization (MF) <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib15" title="">2016</a>)</cite> and
Neural Collaborative Filtering (NCF) <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib11" title="">2017</a>)</cite> models. Moreover, our empirical findings in Table 1 indicate
that existing targeted attack methods achieve only limited effectiveness in federated sequential recommendation (FSR) tasks. With an increasing number of studies <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib17" title="">2022</a>; Shi and Wang <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib27" title="">2024</a>; Zhang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib35" title="">2024</a>)</cite> in recent years linking sequential recommendations to federated learning in pursuit of data privacy, it is necessary to explore the security of FSR.</p>
</div>
<div class="ltx_para" id="Sx1.p3">
<p class="ltx_p" id="Sx1.p3.1">The targeted poisoning attack against FSR faces several critical challenges. (1) The attack must be effective even with a small fraction of malicious clients. Considering that a recommender system usually has million of users, it is impractical for the attacker to control a large number of clients. (2) The attacker can only access a small set of data stored on the malicious clients as the clients never share their local training data in FSR. Since existing poisoning attack methods against federated recommendation usually require a strong knowledge of the full training data, such as a part of public data <cite class="ltx_cite ltx_citemacro_citep">(Rong et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib26" title="">2022</a>)</cite> or popularity information <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib36" title="">2022</a>)</cite>, they are infeasible in the FedRec scenario. (3) Due to the complexity and temporal nature of sequential recommendation models, effectively increasing the recommendation frequency of target items with minimal information about attackers is a challenging task.</p>
</div>
<div class="ltx_para" id="Sx1.p4">
<p class="ltx_p" id="Sx1.p4.1">To address these challenges, in this paper, we first propose a novel dual-view targeted model poisoning attack method named DV-FSR. Our main idea is to fully leverage the interaction sequences in sequential recommendations from multiple perspectives. Initially, from the explicit perspective, we replace the item that most significantly affect the prediction of the target item, thereby uploading malicious gradients to maximize the score of the target item. Subsequently, from the implicit perspective, we enhance the similarity between the emebeddings of the target item and interacted items at the embeddding layer by employing a contrastive learning loss.
As the significant threat posed by this dual-view targeted attack, even when only a small number of users are compromised, we seek to explore defense mechanisms to mitigate this attack effect. We drew inspiration from the concept of the geometric median and proposed a hybrid robust weight aggregation algorithm to mitigate this formidable target item attack.
</p>
</div>
<div class="ltx_para" id="Sx1.p5">
<p class="ltx_p" id="Sx1.p5.1">The main contributions of our work are listed as follows:</p>
<ul class="ltx_itemize" id="Sx1.I1">
<li class="ltx_item" id="Sx1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i1.p1">
<p class="ltx_p" id="Sx1.I1.i1.p1.1">To our knowledge, this study is among the first to explore the robustness of sequential recommendation models in the context of federated target item attacks. Our findings suggest that existing attack methods may have limited effectiveness when applied to FSR.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i2.p1">
<p class="ltx_p" id="Sx1.I1.i2.p1.1">We propose DV-FSR, a novel dual-view targeted poisoning attack method, which reveals the security risk of FSR.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i3.p1">
<p class="ltx_p" id="Sx1.I1.i3.p1.1">To evaluate the mitigation effects of the DV-FSR attack, we propose the mixed-RFA defense strategy.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i4.p1">
<p class="ltx_p" id="Sx1.I1.i4.p1.1">Extensive experiments on two public datasets and models validate the effectiveness of our attack and defense.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Related Work</h2>
<div class="ltx_para" id="Sx2.p1">
<p class="ltx_p" id="Sx2.p1.1">In this section, we briefly introduce the related work from two categories: attack and defense on federated recommendations, sequential recommendation systems.</p>
</div>
<section class="ltx_subsection" id="Sx2.SSx1">
<h3 class="ltx_title ltx_title_subsection">Attack &amp; Defense on Federated Recommendation</h3>
<div class="ltx_para" id="Sx2.SSx1.p1">
<p class="ltx_p" id="Sx2.SSx1.p1.1">Poisoning attacks against recommender systems and their defense have been widely studied in the past decades <cite class="ltx_cite ltx_citemacro_citep">(Lam and Riedl <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib13" title="">2004</a>; Aktukmak, Yilmaz, and Uysal <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib1" title="">2019</a>)</cite>. However, these researches mainly focus on the centralized training of recommendation models. They require the attacker or the server to have strong knowledge of the full training data to perform effective attacks or defenses, such as all users profiles <cite class="ltx_cite ltx_citemacro_citep">(Burke et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib5" title="">2006</a>)</cite> and the entire rating matrix <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib15" title="">2016</a>)</cite>. These methods are infeasible under the federated learning (FL) setting since the server cannot access the data of clients. The defense of recommendation mainly include adversarial training <cite class="ltx_cite ltx_citemacro_citep">(Tang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib28" title="">2019</a>)</cite>, knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Papernot et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib23" title="">2016</a>)</cite>, and attack detection <cite class="ltx_cite ltx_citemacro_citep">(Lee and Zhu <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib14" title="">2012</a>)</cite>. However, virtually all defense methods for recommendation systems have not been applied in federated recommendation systems.</p>
</div>
<div class="ltx_para" id="Sx2.SSx1.p2">
<p class="ltx_p" id="Sx2.SSx1.p2.1">In the general FL domain, recently, several untargeted attacks have been proposed to degrade the overall performance of recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib33" title="">2023</a>; Wu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib31" title="">2022</a>; Yi et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib32" title="">2023</a>)</cite>. Simultaneously, several targeted poisoning attack methods have been proposed and can be directly applied to boost certain target items in FedRec scenario. For example, zhang <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib36" title="">2022</a>)</cite> proposes the method to improve the target item score and popularity by designing new loss function. Rong <cite class="ltx_cite ltx_citemacro_citep">(Rong et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib26" title="">2022</a>)</cite> needs a certain proportion of public interactions to increase the target item score. Rong <cite class="ltx_cite ltx_citemacro_citep">(Rong, He, and Chen <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib25" title="">2022</a>)</cite> proposes an model poisoning function using Binary Cross-Entropy (BCE) loss and approximating user’s embedding vectors.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx2.SSx2">
<h3 class="ltx_title ltx_title_subsection">Sequential Recommendation</h3>
<div class="ltx_para" id="Sx2.SSx2.p1">
<p class="ltx_p" id="Sx2.SSx2.p1.1">Sequential recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib21" title="">2022</a>)</cite> focus on modeling the sequential behavior of users as they interact with items over time. It primarily consists of two components: user-item interactions <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib7" title="">2021</a>)</cite> and sequence model <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib6" title="">2022</a>)</cite>. It exploits the interaction sequences between users and items to reveal the users’ next behavior <cite class="ltx_cite ltx_citemacro_citep">(Fang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib9" title="">2020</a>; Quadrana, Cremonesi, and Jannach <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib24" title="">2018</a>; Wang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib30" title="">2021</a>)</cite>. The attention mechanism can boost the sequential recommendation performances <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib16" title="">2017</a>; Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib20" title="">2018</a>)</cite>. For instance, the SASRec model employs a two-layer Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib29" title="">2017</a>)</cite> decoder to model user sequence, and BERT4Rec utilizes a bidirectional method to model the users’ sequential behaviors. But All of these methods adopt centralized training methods, which may cause the risk of data privacy leakage.</p>
</div>
<div class="ltx_para" id="Sx2.SSx2.p2">
<p class="ltx_p" id="Sx2.SSx2.p2.1">Despite the extensive research on attacks in the past, the robustness of recommendation models has been overlooked. In this paper, we focus on target item attacks in federated sequential recommendation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx3">
<h2 class="ltx_title ltx_title_section">Preliminaries</h2>
<div class="ltx_para" id="Sx3.p1">
<p class="ltx_p" id="Sx3.p1.1">In this section, we briefly introduce the framework of federated sequential recommendation (FSR) and threat model.</p>
</div>
<section class="ltx_subsection" id="Sx3.SSx1">
<h3 class="ltx_title ltx_title_subsection">Federated Sequential Recommendation</h3>
<div class="ltx_para" id="Sx3.SSx1.p1">
<p class="ltx_p" id="Sx3.SSx1.p1.20">Let <math alttext="I" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.1.m1.1"><semantics id="Sx3.SSx1.p1.1.m1.1a"><mi id="Sx3.SSx1.p1.1.m1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.1b"><ci id="Sx3.SSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.1.m1.1d">italic_I</annotation></semantics></math> and <math alttext="U" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.2.m2.1"><semantics id="Sx3.SSx1.p1.2.m2.1a"><mi id="Sx3.SSx1.p1.2.m2.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.1b"><ci id="Sx3.SSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.1c">U</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.2.m2.1d">italic_U</annotation></semantics></math> denotes the sets of M items and N users (clients) in a recommender system, respectively. These clients try to train a global model collaboratively without sharing their private data. We denote the sequential recommender with function <math alttext="f" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.3.m3.1"><semantics id="Sx3.SSx1.p1.3.m3.1a"><mi id="Sx3.SSx1.p1.3.m3.1.1" xref="Sx3.SSx1.p1.3.m3.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.3.m3.1b"><ci id="Sx3.SSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.3.m3.1c">f</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.3.m3.1d">italic_f</annotation></semantics></math>. Given an input sequence <math alttext="x" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.4.m4.1"><semantics id="Sx3.SSx1.p1.4.m4.1a"><mi id="Sx3.SSx1.p1.4.m4.1.1" xref="Sx3.SSx1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.4.m4.1b"><ci id="Sx3.SSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.4.m4.1d">italic_x</annotation></semantics></math>, <math alttext="f" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.5.m5.1"><semantics id="Sx3.SSx1.p1.5.m5.1a"><mi id="Sx3.SSx1.p1.5.m5.1.1" xref="Sx3.SSx1.p1.5.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.5.m5.1b"><ci id="Sx3.SSx1.p1.5.m5.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.5.m5.1c">f</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.5.m5.1d">italic_f</annotation></semantics></math> predicts a probability distribution over the item scope <math alttext="I" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.6.m6.1"><semantics id="Sx3.SSx1.p1.6.m6.1a"><mi id="Sx3.SSx1.p1.6.m6.1.1" xref="Sx3.SSx1.p1.6.m6.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.6.m6.1b"><ci id="Sx3.SSx1.p1.6.m6.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.6.m6.1c">I</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.6.m6.1d">italic_I</annotation></semantics></math>. The function <math alttext="f" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.7.m7.1"><semantics id="Sx3.SSx1.p1.7.m7.1a"><mi id="Sx3.SSx1.p1.7.m7.1.1" xref="Sx3.SSx1.p1.7.m7.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.7.m7.1b"><ci id="Sx3.SSx1.p1.7.m7.1.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.7.m7.1c">f</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.7.m7.1d">italic_f</annotation></semantics></math> comprises an embedding function <math alttext="f_{e}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.8.m8.1"><semantics id="Sx3.SSx1.p1.8.m8.1a"><msub id="Sx3.SSx1.p1.8.m8.1.1" xref="Sx3.SSx1.p1.8.m8.1.1.cmml"><mi id="Sx3.SSx1.p1.8.m8.1.1.2" xref="Sx3.SSx1.p1.8.m8.1.1.2.cmml">f</mi><mi id="Sx3.SSx1.p1.8.m8.1.1.3" xref="Sx3.SSx1.p1.8.m8.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.8.m8.1b"><apply id="Sx3.SSx1.p1.8.m8.1.1.cmml" xref="Sx3.SSx1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.8.m8.1.1.1.cmml" xref="Sx3.SSx1.p1.8.m8.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.8.m8.1.1.2.cmml" xref="Sx3.SSx1.p1.8.m8.1.1.2">𝑓</ci><ci id="Sx3.SSx1.p1.8.m8.1.1.3.cmml" xref="Sx3.SSx1.p1.8.m8.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.8.m8.1c">f_{e}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.8.m8.1d">italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and a sequential model <math alttext="f_{m}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.9.m9.1"><semantics id="Sx3.SSx1.p1.9.m9.1a"><msub id="Sx3.SSx1.p1.9.m9.1.1" xref="Sx3.SSx1.p1.9.m9.1.1.cmml"><mi id="Sx3.SSx1.p1.9.m9.1.1.2" xref="Sx3.SSx1.p1.9.m9.1.1.2.cmml">f</mi><mi id="Sx3.SSx1.p1.9.m9.1.1.3" xref="Sx3.SSx1.p1.9.m9.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.9.m9.1b"><apply id="Sx3.SSx1.p1.9.m9.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.9.m9.1.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.9.m9.1.1.2.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.2">𝑓</ci><ci id="Sx3.SSx1.p1.9.m9.1.1.3.cmml" xref="Sx3.SSx1.p1.9.m9.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.9.m9.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.9.m9.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, with <math alttext="f(x)=f_{m}(f_{e}(x))" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.10.m10.3"><semantics id="Sx3.SSx1.p1.10.m10.3a"><mrow id="Sx3.SSx1.p1.10.m10.3.3" xref="Sx3.SSx1.p1.10.m10.3.3.cmml"><mrow id="Sx3.SSx1.p1.10.m10.3.3.3" xref="Sx3.SSx1.p1.10.m10.3.3.3.cmml"><mi id="Sx3.SSx1.p1.10.m10.3.3.3.2" xref="Sx3.SSx1.p1.10.m10.3.3.3.2.cmml">f</mi><mo id="Sx3.SSx1.p1.10.m10.3.3.3.1" xref="Sx3.SSx1.p1.10.m10.3.3.3.1.cmml">⁢</mo><mrow id="Sx3.SSx1.p1.10.m10.3.3.3.3.2" xref="Sx3.SSx1.p1.10.m10.3.3.3.cmml"><mo id="Sx3.SSx1.p1.10.m10.3.3.3.3.2.1" stretchy="false" xref="Sx3.SSx1.p1.10.m10.3.3.3.cmml">(</mo><mi id="Sx3.SSx1.p1.10.m10.1.1" xref="Sx3.SSx1.p1.10.m10.1.1.cmml">x</mi><mo id="Sx3.SSx1.p1.10.m10.3.3.3.3.2.2" stretchy="false" xref="Sx3.SSx1.p1.10.m10.3.3.3.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx1.p1.10.m10.3.3.2" xref="Sx3.SSx1.p1.10.m10.3.3.2.cmml">=</mo><mrow id="Sx3.SSx1.p1.10.m10.3.3.1" xref="Sx3.SSx1.p1.10.m10.3.3.1.cmml"><msub id="Sx3.SSx1.p1.10.m10.3.3.1.3" xref="Sx3.SSx1.p1.10.m10.3.3.1.3.cmml"><mi id="Sx3.SSx1.p1.10.m10.3.3.1.3.2" xref="Sx3.SSx1.p1.10.m10.3.3.1.3.2.cmml">f</mi><mi id="Sx3.SSx1.p1.10.m10.3.3.1.3.3" xref="Sx3.SSx1.p1.10.m10.3.3.1.3.3.cmml">m</mi></msub><mo id="Sx3.SSx1.p1.10.m10.3.3.1.2" xref="Sx3.SSx1.p1.10.m10.3.3.1.2.cmml">⁢</mo><mrow id="Sx3.SSx1.p1.10.m10.3.3.1.1.1" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.cmml"><mo id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.2" stretchy="false" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.cmml">(</mo><mrow id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.cmml"><msub id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.cmml"><mi id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.2" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.2.cmml">f</mi><mi id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.3" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.3.cmml">e</mi></msub><mo id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.1" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.1.cmml">⁢</mo><mrow id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.3.2" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.cmml"><mo id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.3.2.1" stretchy="false" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.cmml">(</mo><mi id="Sx3.SSx1.p1.10.m10.2.2" xref="Sx3.SSx1.p1.10.m10.2.2.cmml">x</mi><mo id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.3.2.2" stretchy="false" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.3" stretchy="false" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.10.m10.3b"><apply id="Sx3.SSx1.p1.10.m10.3.3.cmml" xref="Sx3.SSx1.p1.10.m10.3.3"><eq id="Sx3.SSx1.p1.10.m10.3.3.2.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.2"></eq><apply id="Sx3.SSx1.p1.10.m10.3.3.3.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.3"><times id="Sx3.SSx1.p1.10.m10.3.3.3.1.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.3.1"></times><ci id="Sx3.SSx1.p1.10.m10.3.3.3.2.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.3.2">𝑓</ci><ci id="Sx3.SSx1.p1.10.m10.1.1.cmml" xref="Sx3.SSx1.p1.10.m10.1.1">𝑥</ci></apply><apply id="Sx3.SSx1.p1.10.m10.3.3.1.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1"><times id="Sx3.SSx1.p1.10.m10.3.3.1.2.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.2"></times><apply id="Sx3.SSx1.p1.10.m10.3.3.1.3.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.10.m10.3.3.1.3.1.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.3">subscript</csymbol><ci id="Sx3.SSx1.p1.10.m10.3.3.1.3.2.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.3.2">𝑓</ci><ci id="Sx3.SSx1.p1.10.m10.3.3.1.3.3.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.3.3">𝑚</ci></apply><apply id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1"><times id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.1"></times><apply id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2">subscript</csymbol><ci id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.2">𝑓</ci><ci id="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.10.m10.3.3.1.1.1.1.2.3">𝑒</ci></apply><ci id="Sx3.SSx1.p1.10.m10.2.2.cmml" xref="Sx3.SSx1.p1.10.m10.2.2">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.10.m10.3c">f(x)=f_{m}(f_{e}(x))</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.10.m10.3d">italic_f ( italic_x ) = italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_x ) )</annotation></semantics></math>. For a data pair <math alttext="(x,y)" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.11.m11.2"><semantics id="Sx3.SSx1.p1.11.m11.2a"><mrow id="Sx3.SSx1.p1.11.m11.2.3.2" xref="Sx3.SSx1.p1.11.m11.2.3.1.cmml"><mo id="Sx3.SSx1.p1.11.m11.2.3.2.1" stretchy="false" xref="Sx3.SSx1.p1.11.m11.2.3.1.cmml">(</mo><mi id="Sx3.SSx1.p1.11.m11.1.1" xref="Sx3.SSx1.p1.11.m11.1.1.cmml">x</mi><mo id="Sx3.SSx1.p1.11.m11.2.3.2.2" xref="Sx3.SSx1.p1.11.m11.2.3.1.cmml">,</mo><mi id="Sx3.SSx1.p1.11.m11.2.2" xref="Sx3.SSx1.p1.11.m11.2.2.cmml">y</mi><mo id="Sx3.SSx1.p1.11.m11.2.3.2.3" stretchy="false" xref="Sx3.SSx1.p1.11.m11.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.11.m11.2b"><interval closure="open" id="Sx3.SSx1.p1.11.m11.2.3.1.cmml" xref="Sx3.SSx1.p1.11.m11.2.3.2"><ci id="Sx3.SSx1.p1.11.m11.1.1.cmml" xref="Sx3.SSx1.p1.11.m11.1.1">𝑥</ci><ci id="Sx3.SSx1.p1.11.m11.2.2.cmml" xref="Sx3.SSx1.p1.11.m11.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.11.m11.2c">(x,y)</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.11.m11.2d">( italic_x , italic_y )</annotation></semantics></math>, ideally, <math alttext="f" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.12.m12.1"><semantics id="Sx3.SSx1.p1.12.m12.1a"><mi id="Sx3.SSx1.p1.12.m12.1.1" xref="Sx3.SSx1.p1.12.m12.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.12.m12.1b"><ci id="Sx3.SSx1.p1.12.m12.1.1.cmml" xref="Sx3.SSx1.p1.12.m12.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.12.m12.1c">f</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.12.m12.1d">italic_f</annotation></semantics></math> predicts <math alttext="y" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.13.m13.1"><semantics id="Sx3.SSx1.p1.13.m13.1a"><mi id="Sx3.SSx1.p1.13.m13.1.1" xref="Sx3.SSx1.p1.13.m13.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.13.m13.1b"><ci id="Sx3.SSx1.p1.13.m13.1.1.cmml" xref="Sx3.SSx1.p1.13.m13.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.13.m13.1c">y</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.13.m13.1d">italic_y</annotation></semantics></math> with the highest probability (i.e., <math alttext="y=\arg\max f(x)" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.14.m14.1"><semantics id="Sx3.SSx1.p1.14.m14.1a"><mrow id="Sx3.SSx1.p1.14.m14.1.2" xref="Sx3.SSx1.p1.14.m14.1.2.cmml"><mi id="Sx3.SSx1.p1.14.m14.1.2.2" xref="Sx3.SSx1.p1.14.m14.1.2.2.cmml">y</mi><mo id="Sx3.SSx1.p1.14.m14.1.2.1" xref="Sx3.SSx1.p1.14.m14.1.2.1.cmml">=</mo><mrow id="Sx3.SSx1.p1.14.m14.1.2.3" xref="Sx3.SSx1.p1.14.m14.1.2.3.cmml"><mrow id="Sx3.SSx1.p1.14.m14.1.2.3.2" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.cmml"><mi id="Sx3.SSx1.p1.14.m14.1.2.3.2.1" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.1.cmml">arg</mi><mo id="Sx3.SSx1.p1.14.m14.1.2.3.2a" lspace="0.167em" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.cmml">⁡</mo><mrow id="Sx3.SSx1.p1.14.m14.1.2.3.2.2" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.2.cmml"><mi id="Sx3.SSx1.p1.14.m14.1.2.3.2.2.1" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.2.1.cmml">max</mi><mo id="Sx3.SSx1.p1.14.m14.1.2.3.2.2a" lspace="0.167em" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.2.cmml">⁡</mo><mi id="Sx3.SSx1.p1.14.m14.1.2.3.2.2.2" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.2.2.cmml">f</mi></mrow></mrow><mo id="Sx3.SSx1.p1.14.m14.1.2.3.1" xref="Sx3.SSx1.p1.14.m14.1.2.3.1.cmml">⁢</mo><mrow id="Sx3.SSx1.p1.14.m14.1.2.3.3.2" xref="Sx3.SSx1.p1.14.m14.1.2.3.cmml"><mo id="Sx3.SSx1.p1.14.m14.1.2.3.3.2.1" stretchy="false" xref="Sx3.SSx1.p1.14.m14.1.2.3.cmml">(</mo><mi id="Sx3.SSx1.p1.14.m14.1.1" xref="Sx3.SSx1.p1.14.m14.1.1.cmml">x</mi><mo id="Sx3.SSx1.p1.14.m14.1.2.3.3.2.2" stretchy="false" xref="Sx3.SSx1.p1.14.m14.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.14.m14.1b"><apply id="Sx3.SSx1.p1.14.m14.1.2.cmml" xref="Sx3.SSx1.p1.14.m14.1.2"><eq id="Sx3.SSx1.p1.14.m14.1.2.1.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.1"></eq><ci id="Sx3.SSx1.p1.14.m14.1.2.2.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.2">𝑦</ci><apply id="Sx3.SSx1.p1.14.m14.1.2.3.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.3"><times id="Sx3.SSx1.p1.14.m14.1.2.3.1.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.3.1"></times><apply id="Sx3.SSx1.p1.14.m14.1.2.3.2.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.3.2"><arg id="Sx3.SSx1.p1.14.m14.1.2.3.2.1.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.1"></arg><apply id="Sx3.SSx1.p1.14.m14.1.2.3.2.2.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.2"><max id="Sx3.SSx1.p1.14.m14.1.2.3.2.2.1.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.2.1"></max><ci id="Sx3.SSx1.p1.14.m14.1.2.3.2.2.2.cmml" xref="Sx3.SSx1.p1.14.m14.1.2.3.2.2.2">𝑓</ci></apply></apply><ci id="Sx3.SSx1.p1.14.m14.1.1.cmml" xref="Sx3.SSx1.p1.14.m14.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.14.m14.1c">y=\arg\max f(x)</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.14.m14.1d">italic_y = roman_arg roman_max italic_f ( italic_x )</annotation></semantics></math>). The learning of a sequential recommender <math alttext="f" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.15.m15.1"><semantics id="Sx3.SSx1.p1.15.m15.1a"><mi id="Sx3.SSx1.p1.15.m15.1.1" xref="Sx3.SSx1.p1.15.m15.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.15.m15.1b"><ci id="Sx3.SSx1.p1.15.m15.1.1.cmml" xref="Sx3.SSx1.p1.15.m15.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.15.m15.1c">f</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.15.m15.1d">italic_f</annotation></semantics></math> is to maximize the probability of output item <math alttext="y" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.16.m16.1"><semantics id="Sx3.SSx1.p1.16.m16.1a"><mi id="Sx3.SSx1.p1.16.m16.1.1" xref="Sx3.SSx1.p1.16.m16.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.16.m16.1b"><ci id="Sx3.SSx1.p1.16.m16.1.1.cmml" xref="Sx3.SSx1.p1.16.m16.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.16.m16.1c">y</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.16.m16.1d">italic_y</annotation></semantics></math> upon input <math alttext="x" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.17.m17.1"><semantics id="Sx3.SSx1.p1.17.m17.1a"><mi id="Sx3.SSx1.p1.17.m17.1.1" xref="Sx3.SSx1.p1.17.m17.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.17.m17.1b"><ci id="Sx3.SSx1.p1.17.m17.1.1.cmml" xref="Sx3.SSx1.p1.17.m17.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.17.m17.1c">x</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.17.m17.1d">italic_x</annotation></semantics></math>. In other words, we minimize the expectation of loss <math alttext="L" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.18.m18.1"><semantics id="Sx3.SSx1.p1.18.m18.1a"><mi id="Sx3.SSx1.p1.18.m18.1.1" xref="Sx3.SSx1.p1.18.m18.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.18.m18.1b"><ci id="Sx3.SSx1.p1.18.m18.1.1.cmml" xref="Sx3.SSx1.p1.18.m18.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.18.m18.1c">L</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.18.m18.1d">italic_L</annotation></semantics></math> with respect to <math alttext="f" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.19.m19.1"><semantics id="Sx3.SSx1.p1.19.m19.1a"><mi id="Sx3.SSx1.p1.19.m19.1.1" xref="Sx3.SSx1.p1.19.m19.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.19.m19.1b"><ci id="Sx3.SSx1.p1.19.m19.1.1.cmml" xref="Sx3.SSx1.p1.19.m19.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.19.m19.1c">f</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.19.m19.1d">italic_f</annotation></semantics></math> over the data distribution <math alttext="X" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.20.m20.1"><semantics id="Sx3.SSx1.p1.20.m20.1a"><mi id="Sx3.SSx1.p1.20.m20.1.1" xref="Sx3.SSx1.p1.20.m20.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.20.m20.1b"><ci id="Sx3.SSx1.p1.20.m20.1.1.cmml" xref="Sx3.SSx1.p1.20.m20.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.20.m20.1c">X</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.20.m20.1d">italic_X</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{f}\mathbb{E}_{(x,y)\sim X}L(f(x),y)" class="ltx_Math" display="block" id="Sx3.Ex1.m1.5"><semantics id="Sx3.Ex1.m1.5a"><mrow id="Sx3.Ex1.m1.5.5" xref="Sx3.Ex1.m1.5.5.cmml"><mrow id="Sx3.Ex1.m1.5.5.3" xref="Sx3.Ex1.m1.5.5.3.cmml"><munder id="Sx3.Ex1.m1.5.5.3.1" xref="Sx3.Ex1.m1.5.5.3.1.cmml"><mi id="Sx3.Ex1.m1.5.5.3.1.2" xref="Sx3.Ex1.m1.5.5.3.1.2.cmml">min</mi><mi id="Sx3.Ex1.m1.5.5.3.1.3" xref="Sx3.Ex1.m1.5.5.3.1.3.cmml">f</mi></munder><mo id="Sx3.Ex1.m1.5.5.3a" lspace="0.167em" xref="Sx3.Ex1.m1.5.5.3.cmml">⁡</mo><mrow id="Sx3.Ex1.m1.5.5.3.2" xref="Sx3.Ex1.m1.5.5.3.2.cmml"><msub id="Sx3.Ex1.m1.5.5.3.2.2" xref="Sx3.Ex1.m1.5.5.3.2.2.cmml"><mi id="Sx3.Ex1.m1.5.5.3.2.2.2" xref="Sx3.Ex1.m1.5.5.3.2.2.2.cmml">𝔼</mi><mrow id="Sx3.Ex1.m1.2.2.2" xref="Sx3.Ex1.m1.2.2.2.cmml"><mrow id="Sx3.Ex1.m1.2.2.2.4.2" xref="Sx3.Ex1.m1.2.2.2.4.1.cmml"><mo id="Sx3.Ex1.m1.2.2.2.4.2.1" stretchy="false" xref="Sx3.Ex1.m1.2.2.2.4.1.cmml">(</mo><mi id="Sx3.Ex1.m1.1.1.1.1" xref="Sx3.Ex1.m1.1.1.1.1.cmml">x</mi><mo id="Sx3.Ex1.m1.2.2.2.4.2.2" xref="Sx3.Ex1.m1.2.2.2.4.1.cmml">,</mo><mi id="Sx3.Ex1.m1.2.2.2.2" xref="Sx3.Ex1.m1.2.2.2.2.cmml">y</mi><mo id="Sx3.Ex1.m1.2.2.2.4.2.3" stretchy="false" xref="Sx3.Ex1.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="Sx3.Ex1.m1.2.2.2.3" xref="Sx3.Ex1.m1.2.2.2.3.cmml">∼</mo><mi id="Sx3.Ex1.m1.2.2.2.5" xref="Sx3.Ex1.m1.2.2.2.5.cmml">X</mi></mrow></msub><mo id="Sx3.Ex1.m1.5.5.3.2.1" xref="Sx3.Ex1.m1.5.5.3.2.1.cmml">⁢</mo><mi id="Sx3.Ex1.m1.5.5.3.2.3" xref="Sx3.Ex1.m1.5.5.3.2.3.cmml">L</mi></mrow></mrow><mo id="Sx3.Ex1.m1.5.5.2" xref="Sx3.Ex1.m1.5.5.2.cmml">⁢</mo><mrow id="Sx3.Ex1.m1.5.5.1.1" xref="Sx3.Ex1.m1.5.5.1.2.cmml"><mo id="Sx3.Ex1.m1.5.5.1.1.2" stretchy="false" xref="Sx3.Ex1.m1.5.5.1.2.cmml">(</mo><mrow id="Sx3.Ex1.m1.5.5.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.1.cmml"><mi id="Sx3.Ex1.m1.5.5.1.1.1.2" xref="Sx3.Ex1.m1.5.5.1.1.1.2.cmml">f</mi><mo id="Sx3.Ex1.m1.5.5.1.1.1.1" xref="Sx3.Ex1.m1.5.5.1.1.1.1.cmml">⁢</mo><mrow id="Sx3.Ex1.m1.5.5.1.1.1.3.2" xref="Sx3.Ex1.m1.5.5.1.1.1.cmml"><mo id="Sx3.Ex1.m1.5.5.1.1.1.3.2.1" stretchy="false" xref="Sx3.Ex1.m1.5.5.1.1.1.cmml">(</mo><mi id="Sx3.Ex1.m1.3.3" xref="Sx3.Ex1.m1.3.3.cmml">x</mi><mo id="Sx3.Ex1.m1.5.5.1.1.1.3.2.2" stretchy="false" xref="Sx3.Ex1.m1.5.5.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.Ex1.m1.5.5.1.1.3" xref="Sx3.Ex1.m1.5.5.1.2.cmml">,</mo><mi id="Sx3.Ex1.m1.4.4" xref="Sx3.Ex1.m1.4.4.cmml">y</mi><mo id="Sx3.Ex1.m1.5.5.1.1.4" stretchy="false" xref="Sx3.Ex1.m1.5.5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex1.m1.5b"><apply id="Sx3.Ex1.m1.5.5.cmml" xref="Sx3.Ex1.m1.5.5"><times id="Sx3.Ex1.m1.5.5.2.cmml" xref="Sx3.Ex1.m1.5.5.2"></times><apply id="Sx3.Ex1.m1.5.5.3.cmml" xref="Sx3.Ex1.m1.5.5.3"><apply id="Sx3.Ex1.m1.5.5.3.1.cmml" xref="Sx3.Ex1.m1.5.5.3.1"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.3.1.1.cmml" xref="Sx3.Ex1.m1.5.5.3.1">subscript</csymbol><min id="Sx3.Ex1.m1.5.5.3.1.2.cmml" xref="Sx3.Ex1.m1.5.5.3.1.2"></min><ci id="Sx3.Ex1.m1.5.5.3.1.3.cmml" xref="Sx3.Ex1.m1.5.5.3.1.3">𝑓</ci></apply><apply id="Sx3.Ex1.m1.5.5.3.2.cmml" xref="Sx3.Ex1.m1.5.5.3.2"><times id="Sx3.Ex1.m1.5.5.3.2.1.cmml" xref="Sx3.Ex1.m1.5.5.3.2.1"></times><apply id="Sx3.Ex1.m1.5.5.3.2.2.cmml" xref="Sx3.Ex1.m1.5.5.3.2.2"><csymbol cd="ambiguous" id="Sx3.Ex1.m1.5.5.3.2.2.1.cmml" xref="Sx3.Ex1.m1.5.5.3.2.2">subscript</csymbol><ci id="Sx3.Ex1.m1.5.5.3.2.2.2.cmml" xref="Sx3.Ex1.m1.5.5.3.2.2.2">𝔼</ci><apply id="Sx3.Ex1.m1.2.2.2.cmml" xref="Sx3.Ex1.m1.2.2.2"><csymbol cd="latexml" id="Sx3.Ex1.m1.2.2.2.3.cmml" xref="Sx3.Ex1.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="Sx3.Ex1.m1.2.2.2.4.1.cmml" xref="Sx3.Ex1.m1.2.2.2.4.2"><ci id="Sx3.Ex1.m1.1.1.1.1.cmml" xref="Sx3.Ex1.m1.1.1.1.1">𝑥</ci><ci id="Sx3.Ex1.m1.2.2.2.2.cmml" xref="Sx3.Ex1.m1.2.2.2.2">𝑦</ci></interval><ci id="Sx3.Ex1.m1.2.2.2.5.cmml" xref="Sx3.Ex1.m1.2.2.2.5">𝑋</ci></apply></apply><ci id="Sx3.Ex1.m1.5.5.3.2.3.cmml" xref="Sx3.Ex1.m1.5.5.3.2.3">𝐿</ci></apply></apply><interval closure="open" id="Sx3.Ex1.m1.5.5.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1"><apply id="Sx3.Ex1.m1.5.5.1.1.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1"><times id="Sx3.Ex1.m1.5.5.1.1.1.1.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.1"></times><ci id="Sx3.Ex1.m1.5.5.1.1.1.2.cmml" xref="Sx3.Ex1.m1.5.5.1.1.1.2">𝑓</ci><ci id="Sx3.Ex1.m1.3.3.cmml" xref="Sx3.Ex1.m1.3.3">𝑥</ci></apply><ci id="Sx3.Ex1.m1.4.4.cmml" xref="Sx3.Ex1.m1.4.4">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex1.m1.5c">\min_{f}\mathbb{E}_{(x,y)\sim X}L(f(x),y)</annotation><annotation encoding="application/x-llamapun" id="Sx3.Ex1.m1.5d">roman_min start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y ) ∼ italic_X end_POSTSUBSCRIPT italic_L ( italic_f ( italic_x ) , italic_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx1.p1.30">where <math alttext="L" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.21.m1.1"><semantics id="Sx3.SSx1.p1.21.m1.1a"><mi id="Sx3.SSx1.p1.21.m1.1.1" xref="Sx3.SSx1.p1.21.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.21.m1.1b"><ci id="Sx3.SSx1.p1.21.m1.1.1.cmml" xref="Sx3.SSx1.p1.21.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.21.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.21.m1.1d">italic_L</annotation></semantics></math> represents the training loss function (i.e., ranking loss or cross entropy loss).
In FSR, every user’s item interaction is separated. Our sequential model is distributedly trained under the framework of federated recommendation. More specially, in federated learning (FL) scenarios, there is a central server and a large amount of individual user clients. As each user corresponds to one of the user clients, we use user to represent its client for convenience. In sequential recommendation, we assume that it all consists three parts: an item interaction sequence <math alttext="x" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.22.m2.1"><semantics id="Sx3.SSx1.p1.22.m2.1a"><mi id="Sx3.SSx1.p1.22.m2.1.1" xref="Sx3.SSx1.p1.22.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.22.m2.1b"><ci id="Sx3.SSx1.p1.22.m2.1.1.cmml" xref="Sx3.SSx1.p1.22.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.22.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.22.m2.1d">italic_x</annotation></semantics></math>, embedding function <math alttext="f_{e}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.23.m3.1"><semantics id="Sx3.SSx1.p1.23.m3.1a"><msub id="Sx3.SSx1.p1.23.m3.1.1" xref="Sx3.SSx1.p1.23.m3.1.1.cmml"><mi id="Sx3.SSx1.p1.23.m3.1.1.2" xref="Sx3.SSx1.p1.23.m3.1.1.2.cmml">f</mi><mi id="Sx3.SSx1.p1.23.m3.1.1.3" xref="Sx3.SSx1.p1.23.m3.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.23.m3.1b"><apply id="Sx3.SSx1.p1.23.m3.1.1.cmml" xref="Sx3.SSx1.p1.23.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.23.m3.1.1.1.cmml" xref="Sx3.SSx1.p1.23.m3.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.23.m3.1.1.2.cmml" xref="Sx3.SSx1.p1.23.m3.1.1.2">𝑓</ci><ci id="Sx3.SSx1.p1.23.m3.1.1.3.cmml" xref="Sx3.SSx1.p1.23.m3.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.23.m3.1c">f_{e}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.23.m3.1d">italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> and sequential model <math alttext="f_{m}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.24.m4.1"><semantics id="Sx3.SSx1.p1.24.m4.1a"><msub id="Sx3.SSx1.p1.24.m4.1.1" xref="Sx3.SSx1.p1.24.m4.1.1.cmml"><mi id="Sx3.SSx1.p1.24.m4.1.1.2" xref="Sx3.SSx1.p1.24.m4.1.1.2.cmml">f</mi><mi id="Sx3.SSx1.p1.24.m4.1.1.3" xref="Sx3.SSx1.p1.24.m4.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.24.m4.1b"><apply id="Sx3.SSx1.p1.24.m4.1.1.cmml" xref="Sx3.SSx1.p1.24.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.24.m4.1.1.1.cmml" xref="Sx3.SSx1.p1.24.m4.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.24.m4.1.1.2.cmml" xref="Sx3.SSx1.p1.24.m4.1.1.2">𝑓</ci><ci id="Sx3.SSx1.p1.24.m4.1.1.3.cmml" xref="Sx3.SSx1.p1.24.m4.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.24.m4.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.24.m4.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. In each training round, the server first distributes the current global parameters [<math alttext="f_{e}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.25.m5.1"><semantics id="Sx3.SSx1.p1.25.m5.1a"><msub id="Sx3.SSx1.p1.25.m5.1.1" xref="Sx3.SSx1.p1.25.m5.1.1.cmml"><mi id="Sx3.SSx1.p1.25.m5.1.1.2" xref="Sx3.SSx1.p1.25.m5.1.1.2.cmml">f</mi><mi id="Sx3.SSx1.p1.25.m5.1.1.3" xref="Sx3.SSx1.p1.25.m5.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.25.m5.1b"><apply id="Sx3.SSx1.p1.25.m5.1.1.cmml" xref="Sx3.SSx1.p1.25.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.25.m5.1.1.1.cmml" xref="Sx3.SSx1.p1.25.m5.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.25.m5.1.1.2.cmml" xref="Sx3.SSx1.p1.25.m5.1.1.2">𝑓</ci><ci id="Sx3.SSx1.p1.25.m5.1.1.3.cmml" xref="Sx3.SSx1.p1.25.m5.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.25.m5.1c">f_{e}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.25.m5.1d">italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>;<math alttext="f_{m}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.26.m6.1"><semantics id="Sx3.SSx1.p1.26.m6.1a"><msub id="Sx3.SSx1.p1.26.m6.1.1" xref="Sx3.SSx1.p1.26.m6.1.1.cmml"><mi id="Sx3.SSx1.p1.26.m6.1.1.2" xref="Sx3.SSx1.p1.26.m6.1.1.2.cmml">f</mi><mi id="Sx3.SSx1.p1.26.m6.1.1.3" xref="Sx3.SSx1.p1.26.m6.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.26.m6.1b"><apply id="Sx3.SSx1.p1.26.m6.1.1.cmml" xref="Sx3.SSx1.p1.26.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.26.m6.1.1.1.cmml" xref="Sx3.SSx1.p1.26.m6.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.26.m6.1.1.2.cmml" xref="Sx3.SSx1.p1.26.m6.1.1.2">𝑓</ci><ci id="Sx3.SSx1.p1.26.m6.1.1.3.cmml" xref="Sx3.SSx1.p1.26.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.26.m6.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.26.m6.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>] to <math alttext="n" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.27.m7.1"><semantics id="Sx3.SSx1.p1.27.m7.1a"><mi id="Sx3.SSx1.p1.27.m7.1.1" xref="Sx3.SSx1.p1.27.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.27.m7.1b"><ci id="Sx3.SSx1.p1.27.m7.1.1.cmml" xref="Sx3.SSx1.p1.27.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.27.m7.1c">n</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.27.m7.1d">italic_n</annotation></semantics></math> randomly selected clients. Then each selected client computes the update gradient g = [<math alttext="g_{embedding}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.28.m8.1"><semantics id="Sx3.SSx1.p1.28.m8.1a"><msub id="Sx3.SSx1.p1.28.m8.1.1" xref="Sx3.SSx1.p1.28.m8.1.1.cmml"><mi id="Sx3.SSx1.p1.28.m8.1.1.2" xref="Sx3.SSx1.p1.28.m8.1.1.2.cmml">g</mi><mrow id="Sx3.SSx1.p1.28.m8.1.1.3" xref="Sx3.SSx1.p1.28.m8.1.1.3.cmml"><mi id="Sx3.SSx1.p1.28.m8.1.1.3.2" xref="Sx3.SSx1.p1.28.m8.1.1.3.2.cmml">e</mi><mo id="Sx3.SSx1.p1.28.m8.1.1.3.1" xref="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.28.m8.1.1.3.3" xref="Sx3.SSx1.p1.28.m8.1.1.3.3.cmml">m</mi><mo id="Sx3.SSx1.p1.28.m8.1.1.3.1a" xref="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.28.m8.1.1.3.4" xref="Sx3.SSx1.p1.28.m8.1.1.3.4.cmml">b</mi><mo id="Sx3.SSx1.p1.28.m8.1.1.3.1b" xref="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.28.m8.1.1.3.5" xref="Sx3.SSx1.p1.28.m8.1.1.3.5.cmml">e</mi><mo id="Sx3.SSx1.p1.28.m8.1.1.3.1c" xref="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.28.m8.1.1.3.6" xref="Sx3.SSx1.p1.28.m8.1.1.3.6.cmml">d</mi><mo id="Sx3.SSx1.p1.28.m8.1.1.3.1d" xref="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.28.m8.1.1.3.7" xref="Sx3.SSx1.p1.28.m8.1.1.3.7.cmml">d</mi><mo id="Sx3.SSx1.p1.28.m8.1.1.3.1e" xref="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.28.m8.1.1.3.8" xref="Sx3.SSx1.p1.28.m8.1.1.3.8.cmml">i</mi><mo id="Sx3.SSx1.p1.28.m8.1.1.3.1f" xref="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.28.m8.1.1.3.9" xref="Sx3.SSx1.p1.28.m8.1.1.3.9.cmml">n</mi><mo id="Sx3.SSx1.p1.28.m8.1.1.3.1g" xref="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.28.m8.1.1.3.10" xref="Sx3.SSx1.p1.28.m8.1.1.3.10.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.28.m8.1b"><apply id="Sx3.SSx1.p1.28.m8.1.1.cmml" xref="Sx3.SSx1.p1.28.m8.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.28.m8.1.1.1.cmml" xref="Sx3.SSx1.p1.28.m8.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.28.m8.1.1.2.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.2">𝑔</ci><apply id="Sx3.SSx1.p1.28.m8.1.1.3.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3"><times id="Sx3.SSx1.p1.28.m8.1.1.3.1.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.1"></times><ci id="Sx3.SSx1.p1.28.m8.1.1.3.2.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.2">𝑒</ci><ci id="Sx3.SSx1.p1.28.m8.1.1.3.3.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.3">𝑚</ci><ci id="Sx3.SSx1.p1.28.m8.1.1.3.4.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.4">𝑏</ci><ci id="Sx3.SSx1.p1.28.m8.1.1.3.5.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.5">𝑒</ci><ci id="Sx3.SSx1.p1.28.m8.1.1.3.6.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.6">𝑑</ci><ci id="Sx3.SSx1.p1.28.m8.1.1.3.7.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.7">𝑑</ci><ci id="Sx3.SSx1.p1.28.m8.1.1.3.8.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.8">𝑖</ci><ci id="Sx3.SSx1.p1.28.m8.1.1.3.9.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.9">𝑛</ci><ci id="Sx3.SSx1.p1.28.m8.1.1.3.10.cmml" xref="Sx3.SSx1.p1.28.m8.1.1.3.10">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.28.m8.1c">g_{embedding}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.28.m8.1d">italic_g start_POSTSUBSCRIPT italic_e italic_m italic_b italic_e italic_d italic_d italic_i italic_n italic_g end_POSTSUBSCRIPT</annotation></semantics></math>; <math alttext="g_{model}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.29.m9.1"><semantics id="Sx3.SSx1.p1.29.m9.1a"><msub id="Sx3.SSx1.p1.29.m9.1.1" xref="Sx3.SSx1.p1.29.m9.1.1.cmml"><mi id="Sx3.SSx1.p1.29.m9.1.1.2" xref="Sx3.SSx1.p1.29.m9.1.1.2.cmml">g</mi><mrow id="Sx3.SSx1.p1.29.m9.1.1.3" xref="Sx3.SSx1.p1.29.m9.1.1.3.cmml"><mi id="Sx3.SSx1.p1.29.m9.1.1.3.2" xref="Sx3.SSx1.p1.29.m9.1.1.3.2.cmml">m</mi><mo id="Sx3.SSx1.p1.29.m9.1.1.3.1" xref="Sx3.SSx1.p1.29.m9.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.29.m9.1.1.3.3" xref="Sx3.SSx1.p1.29.m9.1.1.3.3.cmml">o</mi><mo id="Sx3.SSx1.p1.29.m9.1.1.3.1a" xref="Sx3.SSx1.p1.29.m9.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.29.m9.1.1.3.4" xref="Sx3.SSx1.p1.29.m9.1.1.3.4.cmml">d</mi><mo id="Sx3.SSx1.p1.29.m9.1.1.3.1b" xref="Sx3.SSx1.p1.29.m9.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.29.m9.1.1.3.5" xref="Sx3.SSx1.p1.29.m9.1.1.3.5.cmml">e</mi><mo id="Sx3.SSx1.p1.29.m9.1.1.3.1c" xref="Sx3.SSx1.p1.29.m9.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.29.m9.1.1.3.6" xref="Sx3.SSx1.p1.29.m9.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.29.m9.1b"><apply id="Sx3.SSx1.p1.29.m9.1.1.cmml" xref="Sx3.SSx1.p1.29.m9.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.29.m9.1.1.1.cmml" xref="Sx3.SSx1.p1.29.m9.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.29.m9.1.1.2.cmml" xref="Sx3.SSx1.p1.29.m9.1.1.2">𝑔</ci><apply id="Sx3.SSx1.p1.29.m9.1.1.3.cmml" xref="Sx3.SSx1.p1.29.m9.1.1.3"><times id="Sx3.SSx1.p1.29.m9.1.1.3.1.cmml" xref="Sx3.SSx1.p1.29.m9.1.1.3.1"></times><ci id="Sx3.SSx1.p1.29.m9.1.1.3.2.cmml" xref="Sx3.SSx1.p1.29.m9.1.1.3.2">𝑚</ci><ci id="Sx3.SSx1.p1.29.m9.1.1.3.3.cmml" xref="Sx3.SSx1.p1.29.m9.1.1.3.3">𝑜</ci><ci id="Sx3.SSx1.p1.29.m9.1.1.3.4.cmml" xref="Sx3.SSx1.p1.29.m9.1.1.3.4">𝑑</ci><ci id="Sx3.SSx1.p1.29.m9.1.1.3.5.cmml" xref="Sx3.SSx1.p1.29.m9.1.1.3.5">𝑒</ci><ci id="Sx3.SSx1.p1.29.m9.1.1.3.6.cmml" xref="Sx3.SSx1.p1.29.m9.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.29.m9.1c">g_{model}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.29.m9.1d">italic_g start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>] with their local sequence <math alttext="x" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.30.m10.1"><semantics id="Sx3.SSx1.p1.30.m10.1a"><mi id="Sx3.SSx1.p1.30.m10.1.1" xref="Sx3.SSx1.p1.30.m10.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.30.m10.1b"><ci id="Sx3.SSx1.p1.30.m10.1.1.cmml" xref="Sx3.SSx1.p1.30.m10.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.30.m10.1c">x</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.30.m10.1d">italic_x</annotation></semantics></math>. Following previous work <cite class="ltx_cite ltx_citemacro_citep">(Rong, He, and Chen <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib25" title="">2022</a>)</cite>, we use Binary Cross-Entropy (BCE) loss to train the local model. Specially, the gradient g is generated by optimizing the following loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=-\frac{1}{|D|}\left(\sum_{(x_{t},y_{t})\in D^{+}}\log\hat{y}_{t}+%
\sum_{(x_{t},y_{t})\in D^{-}}\log(1-\hat{y}_{t})\right)" class="ltx_Math" display="block" id="Sx3.Ex2.m1.7"><semantics id="Sx3.Ex2.m1.7a"><mrow id="Sx3.Ex2.m1.7.7" xref="Sx3.Ex2.m1.7.7.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.Ex2.m1.7.7.3" xref="Sx3.Ex2.m1.7.7.3.cmml">ℒ</mi><mo id="Sx3.Ex2.m1.7.7.2" xref="Sx3.Ex2.m1.7.7.2.cmml">=</mo><mrow id="Sx3.Ex2.m1.7.7.1" xref="Sx3.Ex2.m1.7.7.1.cmml"><mo id="Sx3.Ex2.m1.7.7.1a" xref="Sx3.Ex2.m1.7.7.1.cmml">−</mo><mrow id="Sx3.Ex2.m1.7.7.1.1" xref="Sx3.Ex2.m1.7.7.1.1.cmml"><mfrac id="Sx3.Ex2.m1.1.1" xref="Sx3.Ex2.m1.1.1.cmml"><mn id="Sx3.Ex2.m1.1.1.3" xref="Sx3.Ex2.m1.1.1.3.cmml">1</mn><mrow id="Sx3.Ex2.m1.1.1.1.3" xref="Sx3.Ex2.m1.1.1.1.2.cmml"><mo id="Sx3.Ex2.m1.1.1.1.3.1" stretchy="false" xref="Sx3.Ex2.m1.1.1.1.2.1.cmml">|</mo><mi id="Sx3.Ex2.m1.1.1.1.1" xref="Sx3.Ex2.m1.1.1.1.1.cmml">D</mi><mo id="Sx3.Ex2.m1.1.1.1.3.2" stretchy="false" xref="Sx3.Ex2.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="Sx3.Ex2.m1.7.7.1.1.2" xref="Sx3.Ex2.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="Sx3.Ex2.m1.7.7.1.1.1.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.cmml"><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.Ex2.m1.7.7.1.1.1.1.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.cmml"><mrow id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.cmml"><munder id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1.cmml"><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1.2" lspace="0em" movablelimits="false" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="Sx3.Ex2.m1.3.3.2" xref="Sx3.Ex2.m1.3.3.2.cmml"><mrow id="Sx3.Ex2.m1.3.3.2.2.2" xref="Sx3.Ex2.m1.3.3.2.2.3.cmml"><mo id="Sx3.Ex2.m1.3.3.2.2.2.3" stretchy="false" xref="Sx3.Ex2.m1.3.3.2.2.3.cmml">(</mo><msub id="Sx3.Ex2.m1.2.2.1.1.1.1" xref="Sx3.Ex2.m1.2.2.1.1.1.1.cmml"><mi id="Sx3.Ex2.m1.2.2.1.1.1.1.2" xref="Sx3.Ex2.m1.2.2.1.1.1.1.2.cmml">x</mi><mi id="Sx3.Ex2.m1.2.2.1.1.1.1.3" xref="Sx3.Ex2.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="Sx3.Ex2.m1.3.3.2.2.2.4" xref="Sx3.Ex2.m1.3.3.2.2.3.cmml">,</mo><msub id="Sx3.Ex2.m1.3.3.2.2.2.2" xref="Sx3.Ex2.m1.3.3.2.2.2.2.cmml"><mi id="Sx3.Ex2.m1.3.3.2.2.2.2.2" xref="Sx3.Ex2.m1.3.3.2.2.2.2.2.cmml">y</mi><mi id="Sx3.Ex2.m1.3.3.2.2.2.2.3" xref="Sx3.Ex2.m1.3.3.2.2.2.2.3.cmml">t</mi></msub><mo id="Sx3.Ex2.m1.3.3.2.2.2.5" stretchy="false" xref="Sx3.Ex2.m1.3.3.2.2.3.cmml">)</mo></mrow><mo id="Sx3.Ex2.m1.3.3.2.3" xref="Sx3.Ex2.m1.3.3.2.3.cmml">∈</mo><msup id="Sx3.Ex2.m1.3.3.2.4" xref="Sx3.Ex2.m1.3.3.2.4.cmml"><mi id="Sx3.Ex2.m1.3.3.2.4.2" xref="Sx3.Ex2.m1.3.3.2.4.2.cmml">D</mi><mo id="Sx3.Ex2.m1.3.3.2.4.3" xref="Sx3.Ex2.m1.3.3.2.4.3.cmml">+</mo></msup></mrow></munder><mrow id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.cmml"><mi id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.1.cmml">log</mi><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2a" lspace="0.167em" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.cmml">⁡</mo><msub id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.cmml"><mover accent="true" id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.cmml"><mi id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.2.cmml">y</mi><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.1.cmml">^</mo></mover><mi id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.3" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.3.cmml">t</mi></msub></mrow></mrow><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.2" rspace="0.055em" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.2.cmml">+</mo><mrow id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.cmml"><munder id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2.cmml"><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2.2" movablelimits="false" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="Sx3.Ex2.m1.5.5.2" xref="Sx3.Ex2.m1.5.5.2.cmml"><mrow id="Sx3.Ex2.m1.5.5.2.2.2" xref="Sx3.Ex2.m1.5.5.2.2.3.cmml"><mo id="Sx3.Ex2.m1.5.5.2.2.2.3" stretchy="false" xref="Sx3.Ex2.m1.5.5.2.2.3.cmml">(</mo><msub id="Sx3.Ex2.m1.4.4.1.1.1.1" xref="Sx3.Ex2.m1.4.4.1.1.1.1.cmml"><mi id="Sx3.Ex2.m1.4.4.1.1.1.1.2" xref="Sx3.Ex2.m1.4.4.1.1.1.1.2.cmml">x</mi><mi id="Sx3.Ex2.m1.4.4.1.1.1.1.3" xref="Sx3.Ex2.m1.4.4.1.1.1.1.3.cmml">t</mi></msub><mo id="Sx3.Ex2.m1.5.5.2.2.2.4" xref="Sx3.Ex2.m1.5.5.2.2.3.cmml">,</mo><msub id="Sx3.Ex2.m1.5.5.2.2.2.2" xref="Sx3.Ex2.m1.5.5.2.2.2.2.cmml"><mi id="Sx3.Ex2.m1.5.5.2.2.2.2.2" xref="Sx3.Ex2.m1.5.5.2.2.2.2.2.cmml">y</mi><mi id="Sx3.Ex2.m1.5.5.2.2.2.2.3" xref="Sx3.Ex2.m1.5.5.2.2.2.2.3.cmml">t</mi></msub><mo id="Sx3.Ex2.m1.5.5.2.2.2.5" stretchy="false" xref="Sx3.Ex2.m1.5.5.2.2.3.cmml">)</mo></mrow><mo id="Sx3.Ex2.m1.5.5.2.3" xref="Sx3.Ex2.m1.5.5.2.3.cmml">∈</mo><msup id="Sx3.Ex2.m1.5.5.2.4" xref="Sx3.Ex2.m1.5.5.2.4.cmml"><mi id="Sx3.Ex2.m1.5.5.2.4.2" xref="Sx3.Ex2.m1.5.5.2.4.2.cmml">D</mi><mo id="Sx3.Ex2.m1.5.5.2.4.3" xref="Sx3.Ex2.m1.5.5.2.4.3.cmml">−</mo></msup></mrow></munder><mrow id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.Ex2.m1.6.6" xref="Sx3.Ex2.m1.6.6.cmml">log</mi><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1a" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml">(</mo><mrow id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.Ex2.m1.7.7.1.1.1.1.3" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.Ex2.m1.7b"><apply id="Sx3.Ex2.m1.7.7.cmml" xref="Sx3.Ex2.m1.7.7"><eq id="Sx3.Ex2.m1.7.7.2.cmml" xref="Sx3.Ex2.m1.7.7.2"></eq><ci id="Sx3.Ex2.m1.7.7.3.cmml" xref="Sx3.Ex2.m1.7.7.3">ℒ</ci><apply id="Sx3.Ex2.m1.7.7.1.cmml" xref="Sx3.Ex2.m1.7.7.1"><minus id="Sx3.Ex2.m1.7.7.1.2.cmml" xref="Sx3.Ex2.m1.7.7.1"></minus><apply id="Sx3.Ex2.m1.7.7.1.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1"><times id="Sx3.Ex2.m1.7.7.1.1.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.2"></times><apply id="Sx3.Ex2.m1.1.1.cmml" xref="Sx3.Ex2.m1.1.1"><divide id="Sx3.Ex2.m1.1.1.2.cmml" xref="Sx3.Ex2.m1.1.1"></divide><cn id="Sx3.Ex2.m1.1.1.3.cmml" type="integer" xref="Sx3.Ex2.m1.1.1.3">1</cn><apply id="Sx3.Ex2.m1.1.1.1.2.cmml" xref="Sx3.Ex2.m1.1.1.1.3"><abs id="Sx3.Ex2.m1.1.1.1.2.1.cmml" xref="Sx3.Ex2.m1.1.1.1.3.1"></abs><ci id="Sx3.Ex2.m1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.1.1.1.1">𝐷</ci></apply></apply><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1"><plus id="Sx3.Ex2.m1.7.7.1.1.1.1.1.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.2"></plus><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3"><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1">subscript</csymbol><sum id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.1.2"></sum><apply id="Sx3.Ex2.m1.3.3.2.cmml" xref="Sx3.Ex2.m1.3.3.2"><in id="Sx3.Ex2.m1.3.3.2.3.cmml" xref="Sx3.Ex2.m1.3.3.2.3"></in><interval closure="open" id="Sx3.Ex2.m1.3.3.2.2.3.cmml" xref="Sx3.Ex2.m1.3.3.2.2.2"><apply id="Sx3.Ex2.m1.2.2.1.1.1.1.cmml" xref="Sx3.Ex2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.2.2.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.2.2.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex2.m1.2.2.1.1.1.1.2.cmml" xref="Sx3.Ex2.m1.2.2.1.1.1.1.2">𝑥</ci><ci id="Sx3.Ex2.m1.2.2.1.1.1.1.3.cmml" xref="Sx3.Ex2.m1.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="Sx3.Ex2.m1.3.3.2.2.2.2.cmml" xref="Sx3.Ex2.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.3.3.2.2.2.2.1.cmml" xref="Sx3.Ex2.m1.3.3.2.2.2.2">subscript</csymbol><ci id="Sx3.Ex2.m1.3.3.2.2.2.2.2.cmml" xref="Sx3.Ex2.m1.3.3.2.2.2.2.2">𝑦</ci><ci id="Sx3.Ex2.m1.3.3.2.2.2.2.3.cmml" xref="Sx3.Ex2.m1.3.3.2.2.2.2.3">𝑡</ci></apply></interval><apply id="Sx3.Ex2.m1.3.3.2.4.cmml" xref="Sx3.Ex2.m1.3.3.2.4"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.3.3.2.4.1.cmml" xref="Sx3.Ex2.m1.3.3.2.4">superscript</csymbol><ci id="Sx3.Ex2.m1.3.3.2.4.2.cmml" xref="Sx3.Ex2.m1.3.3.2.4.2">𝐷</ci><plus id="Sx3.Ex2.m1.3.3.2.4.3.cmml" xref="Sx3.Ex2.m1.3.3.2.4.3"></plus></apply></apply></apply><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2"><log id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.1"></log><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2">subscript</csymbol><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2"><ci id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.1">^</ci><ci id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.2.2">𝑦</ci></apply><ci id="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.3.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.3.2.2.3">𝑡</ci></apply></apply></apply><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1"><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2">subscript</csymbol><sum id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.2.2"></sum><apply id="Sx3.Ex2.m1.5.5.2.cmml" xref="Sx3.Ex2.m1.5.5.2"><in id="Sx3.Ex2.m1.5.5.2.3.cmml" xref="Sx3.Ex2.m1.5.5.2.3"></in><interval closure="open" id="Sx3.Ex2.m1.5.5.2.2.3.cmml" xref="Sx3.Ex2.m1.5.5.2.2.2"><apply id="Sx3.Ex2.m1.4.4.1.1.1.1.cmml" xref="Sx3.Ex2.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.4.4.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.4.4.1.1.1.1">subscript</csymbol><ci id="Sx3.Ex2.m1.4.4.1.1.1.1.2.cmml" xref="Sx3.Ex2.m1.4.4.1.1.1.1.2">𝑥</ci><ci id="Sx3.Ex2.m1.4.4.1.1.1.1.3.cmml" xref="Sx3.Ex2.m1.4.4.1.1.1.1.3">𝑡</ci></apply><apply id="Sx3.Ex2.m1.5.5.2.2.2.2.cmml" xref="Sx3.Ex2.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.5.5.2.2.2.2.1.cmml" xref="Sx3.Ex2.m1.5.5.2.2.2.2">subscript</csymbol><ci id="Sx3.Ex2.m1.5.5.2.2.2.2.2.cmml" xref="Sx3.Ex2.m1.5.5.2.2.2.2.2">𝑦</ci><ci id="Sx3.Ex2.m1.5.5.2.2.2.2.3.cmml" xref="Sx3.Ex2.m1.5.5.2.2.2.2.3">𝑡</ci></apply></interval><apply id="Sx3.Ex2.m1.5.5.2.4.cmml" xref="Sx3.Ex2.m1.5.5.2.4"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.5.5.2.4.1.cmml" xref="Sx3.Ex2.m1.5.5.2.4">superscript</csymbol><ci id="Sx3.Ex2.m1.5.5.2.4.2.cmml" xref="Sx3.Ex2.m1.5.5.2.4.2">𝐷</ci><minus id="Sx3.Ex2.m1.5.5.2.4.3.cmml" xref="Sx3.Ex2.m1.5.5.2.4.3"></minus></apply></apply></apply><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1"><log id="Sx3.Ex2.m1.6.6.cmml" xref="Sx3.Ex2.m1.6.6"></log><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1"><minus id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.Ex2.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.Ex2.m1.7c">\mathcal{L}=-\frac{1}{|D|}\left(\sum_{(x_{t},y_{t})\in D^{+}}\log\hat{y}_{t}+%
\sum_{(x_{t},y_{t})\in D^{-}}\log(1-\hat{y}_{t})\right)</annotation><annotation encoding="application/x-llamapun" id="Sx3.Ex2.m1.7d">caligraphic_L = - divide start_ARG 1 end_ARG start_ARG | italic_D | end_ARG ( ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∈ italic_D start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_log over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + ∑ start_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ∈ italic_D start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT end_POSTSUBSCRIPT roman_log ( 1 - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx3.SSx1.p1.36"><math alttext="D^{+}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.31.m1.1"><semantics id="Sx3.SSx1.p1.31.m1.1a"><msup id="Sx3.SSx1.p1.31.m1.1.1" xref="Sx3.SSx1.p1.31.m1.1.1.cmml"><mi id="Sx3.SSx1.p1.31.m1.1.1.2" xref="Sx3.SSx1.p1.31.m1.1.1.2.cmml">D</mi><mo id="Sx3.SSx1.p1.31.m1.1.1.3" xref="Sx3.SSx1.p1.31.m1.1.1.3.cmml">+</mo></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.31.m1.1b"><apply id="Sx3.SSx1.p1.31.m1.1.1.cmml" xref="Sx3.SSx1.p1.31.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.31.m1.1.1.1.cmml" xref="Sx3.SSx1.p1.31.m1.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.31.m1.1.1.2.cmml" xref="Sx3.SSx1.p1.31.m1.1.1.2">𝐷</ci><plus id="Sx3.SSx1.p1.31.m1.1.1.3.cmml" xref="Sx3.SSx1.p1.31.m1.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.31.m1.1c">D^{+}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.31.m1.1d">italic_D start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> represent all interacted items collection, <math alttext="D^{-}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.32.m2.1"><semantics id="Sx3.SSx1.p1.32.m2.1a"><msup id="Sx3.SSx1.p1.32.m2.1.1" xref="Sx3.SSx1.p1.32.m2.1.1.cmml"><mi id="Sx3.SSx1.p1.32.m2.1.1.2" xref="Sx3.SSx1.p1.32.m2.1.1.2.cmml">D</mi><mo id="Sx3.SSx1.p1.32.m2.1.1.3" xref="Sx3.SSx1.p1.32.m2.1.1.3.cmml">−</mo></msup><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.32.m2.1b"><apply id="Sx3.SSx1.p1.32.m2.1.1.cmml" xref="Sx3.SSx1.p1.32.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.32.m2.1.1.1.cmml" xref="Sx3.SSx1.p1.32.m2.1.1">superscript</csymbol><ci id="Sx3.SSx1.p1.32.m2.1.1.2.cmml" xref="Sx3.SSx1.p1.32.m2.1.1.2">𝐷</ci><minus id="Sx3.SSx1.p1.32.m2.1.1.3.cmml" xref="Sx3.SSx1.p1.32.m2.1.1.3"></minus></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.32.m2.1c">D^{-}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.32.m2.1d">italic_D start_POSTSUPERSCRIPT - end_POSTSUPERSCRIPT</annotation></semantics></math> represents all non-interacted items collection, <math alttext="\hat{y}_{t}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.33.m3.1"><semantics id="Sx3.SSx1.p1.33.m3.1a"><msub id="Sx3.SSx1.p1.33.m3.1.1" xref="Sx3.SSx1.p1.33.m3.1.1.cmml"><mover accent="true" id="Sx3.SSx1.p1.33.m3.1.1.2" xref="Sx3.SSx1.p1.33.m3.1.1.2.cmml"><mi id="Sx3.SSx1.p1.33.m3.1.1.2.2" xref="Sx3.SSx1.p1.33.m3.1.1.2.2.cmml">y</mi><mo id="Sx3.SSx1.p1.33.m3.1.1.2.1" xref="Sx3.SSx1.p1.33.m3.1.1.2.1.cmml">^</mo></mover><mi id="Sx3.SSx1.p1.33.m3.1.1.3" xref="Sx3.SSx1.p1.33.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.33.m3.1b"><apply id="Sx3.SSx1.p1.33.m3.1.1.cmml" xref="Sx3.SSx1.p1.33.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.33.m3.1.1.1.cmml" xref="Sx3.SSx1.p1.33.m3.1.1">subscript</csymbol><apply id="Sx3.SSx1.p1.33.m3.1.1.2.cmml" xref="Sx3.SSx1.p1.33.m3.1.1.2"><ci id="Sx3.SSx1.p1.33.m3.1.1.2.1.cmml" xref="Sx3.SSx1.p1.33.m3.1.1.2.1">^</ci><ci id="Sx3.SSx1.p1.33.m3.1.1.2.2.cmml" xref="Sx3.SSx1.p1.33.m3.1.1.2.2">𝑦</ci></apply><ci id="Sx3.SSx1.p1.33.m3.1.1.3.cmml" xref="Sx3.SSx1.p1.33.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.33.m3.1c">\hat{y}_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.33.m3.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represent the probability of model predicted sample <math alttext="x_{t}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.34.m4.1"><semantics id="Sx3.SSx1.p1.34.m4.1a"><msub id="Sx3.SSx1.p1.34.m4.1.1" xref="Sx3.SSx1.p1.34.m4.1.1.cmml"><mi id="Sx3.SSx1.p1.34.m4.1.1.2" xref="Sx3.SSx1.p1.34.m4.1.1.2.cmml">x</mi><mi id="Sx3.SSx1.p1.34.m4.1.1.3" xref="Sx3.SSx1.p1.34.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.34.m4.1b"><apply id="Sx3.SSx1.p1.34.m4.1.1.cmml" xref="Sx3.SSx1.p1.34.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.34.m4.1.1.1.cmml" xref="Sx3.SSx1.p1.34.m4.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.34.m4.1.1.2.cmml" xref="Sx3.SSx1.p1.34.m4.1.1.2">𝑥</ci><ci id="Sx3.SSx1.p1.34.m4.1.1.3.cmml" xref="Sx3.SSx1.p1.34.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.34.m4.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.34.m4.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Next, the client uploads [<math alttext="g_{embedding}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.35.m5.1"><semantics id="Sx3.SSx1.p1.35.m5.1a"><msub id="Sx3.SSx1.p1.35.m5.1.1" xref="Sx3.SSx1.p1.35.m5.1.1.cmml"><mi id="Sx3.SSx1.p1.35.m5.1.1.2" xref="Sx3.SSx1.p1.35.m5.1.1.2.cmml">g</mi><mrow id="Sx3.SSx1.p1.35.m5.1.1.3" xref="Sx3.SSx1.p1.35.m5.1.1.3.cmml"><mi id="Sx3.SSx1.p1.35.m5.1.1.3.2" xref="Sx3.SSx1.p1.35.m5.1.1.3.2.cmml">e</mi><mo id="Sx3.SSx1.p1.35.m5.1.1.3.1" xref="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.35.m5.1.1.3.3" xref="Sx3.SSx1.p1.35.m5.1.1.3.3.cmml">m</mi><mo id="Sx3.SSx1.p1.35.m5.1.1.3.1a" xref="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.35.m5.1.1.3.4" xref="Sx3.SSx1.p1.35.m5.1.1.3.4.cmml">b</mi><mo id="Sx3.SSx1.p1.35.m5.1.1.3.1b" xref="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.35.m5.1.1.3.5" xref="Sx3.SSx1.p1.35.m5.1.1.3.5.cmml">e</mi><mo id="Sx3.SSx1.p1.35.m5.1.1.3.1c" xref="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.35.m5.1.1.3.6" xref="Sx3.SSx1.p1.35.m5.1.1.3.6.cmml">d</mi><mo id="Sx3.SSx1.p1.35.m5.1.1.3.1d" xref="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.35.m5.1.1.3.7" xref="Sx3.SSx1.p1.35.m5.1.1.3.7.cmml">d</mi><mo id="Sx3.SSx1.p1.35.m5.1.1.3.1e" xref="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.35.m5.1.1.3.8" xref="Sx3.SSx1.p1.35.m5.1.1.3.8.cmml">i</mi><mo id="Sx3.SSx1.p1.35.m5.1.1.3.1f" xref="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.35.m5.1.1.3.9" xref="Sx3.SSx1.p1.35.m5.1.1.3.9.cmml">n</mi><mo id="Sx3.SSx1.p1.35.m5.1.1.3.1g" xref="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.35.m5.1.1.3.10" xref="Sx3.SSx1.p1.35.m5.1.1.3.10.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.35.m5.1b"><apply id="Sx3.SSx1.p1.35.m5.1.1.cmml" xref="Sx3.SSx1.p1.35.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.35.m5.1.1.1.cmml" xref="Sx3.SSx1.p1.35.m5.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.35.m5.1.1.2.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.2">𝑔</ci><apply id="Sx3.SSx1.p1.35.m5.1.1.3.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3"><times id="Sx3.SSx1.p1.35.m5.1.1.3.1.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.1"></times><ci id="Sx3.SSx1.p1.35.m5.1.1.3.2.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.2">𝑒</ci><ci id="Sx3.SSx1.p1.35.m5.1.1.3.3.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.3">𝑚</ci><ci id="Sx3.SSx1.p1.35.m5.1.1.3.4.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.4">𝑏</ci><ci id="Sx3.SSx1.p1.35.m5.1.1.3.5.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.5">𝑒</ci><ci id="Sx3.SSx1.p1.35.m5.1.1.3.6.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.6">𝑑</ci><ci id="Sx3.SSx1.p1.35.m5.1.1.3.7.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.7">𝑑</ci><ci id="Sx3.SSx1.p1.35.m5.1.1.3.8.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.8">𝑖</ci><ci id="Sx3.SSx1.p1.35.m5.1.1.3.9.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.9">𝑛</ci><ci id="Sx3.SSx1.p1.35.m5.1.1.3.10.cmml" xref="Sx3.SSx1.p1.35.m5.1.1.3.10">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.35.m5.1c">g_{embedding}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.35.m5.1d">italic_g start_POSTSUBSCRIPT italic_e italic_m italic_b italic_e italic_d italic_d italic_i italic_n italic_g end_POSTSUBSCRIPT</annotation></semantics></math>; <math alttext="g_{model}" class="ltx_Math" display="inline" id="Sx3.SSx1.p1.36.m6.1"><semantics id="Sx3.SSx1.p1.36.m6.1a"><msub id="Sx3.SSx1.p1.36.m6.1.1" xref="Sx3.SSx1.p1.36.m6.1.1.cmml"><mi id="Sx3.SSx1.p1.36.m6.1.1.2" xref="Sx3.SSx1.p1.36.m6.1.1.2.cmml">g</mi><mrow id="Sx3.SSx1.p1.36.m6.1.1.3" xref="Sx3.SSx1.p1.36.m6.1.1.3.cmml"><mi id="Sx3.SSx1.p1.36.m6.1.1.3.2" xref="Sx3.SSx1.p1.36.m6.1.1.3.2.cmml">m</mi><mo id="Sx3.SSx1.p1.36.m6.1.1.3.1" xref="Sx3.SSx1.p1.36.m6.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.36.m6.1.1.3.3" xref="Sx3.SSx1.p1.36.m6.1.1.3.3.cmml">o</mi><mo id="Sx3.SSx1.p1.36.m6.1.1.3.1a" xref="Sx3.SSx1.p1.36.m6.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.36.m6.1.1.3.4" xref="Sx3.SSx1.p1.36.m6.1.1.3.4.cmml">d</mi><mo id="Sx3.SSx1.p1.36.m6.1.1.3.1b" xref="Sx3.SSx1.p1.36.m6.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.36.m6.1.1.3.5" xref="Sx3.SSx1.p1.36.m6.1.1.3.5.cmml">e</mi><mo id="Sx3.SSx1.p1.36.m6.1.1.3.1c" xref="Sx3.SSx1.p1.36.m6.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx1.p1.36.m6.1.1.3.6" xref="Sx3.SSx1.p1.36.m6.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.36.m6.1b"><apply id="Sx3.SSx1.p1.36.m6.1.1.cmml" xref="Sx3.SSx1.p1.36.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.36.m6.1.1.1.cmml" xref="Sx3.SSx1.p1.36.m6.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.36.m6.1.1.2.cmml" xref="Sx3.SSx1.p1.36.m6.1.1.2">𝑔</ci><apply id="Sx3.SSx1.p1.36.m6.1.1.3.cmml" xref="Sx3.SSx1.p1.36.m6.1.1.3"><times id="Sx3.SSx1.p1.36.m6.1.1.3.1.cmml" xref="Sx3.SSx1.p1.36.m6.1.1.3.1"></times><ci id="Sx3.SSx1.p1.36.m6.1.1.3.2.cmml" xref="Sx3.SSx1.p1.36.m6.1.1.3.2">𝑚</ci><ci id="Sx3.SSx1.p1.36.m6.1.1.3.3.cmml" xref="Sx3.SSx1.p1.36.m6.1.1.3.3">𝑜</ci><ci id="Sx3.SSx1.p1.36.m6.1.1.3.4.cmml" xref="Sx3.SSx1.p1.36.m6.1.1.3.4">𝑑</ci><ci id="Sx3.SSx1.p1.36.m6.1.1.3.5.cmml" xref="Sx3.SSx1.p1.36.m6.1.1.3.5">𝑒</ci><ci id="Sx3.SSx1.p1.36.m6.1.1.3.6.cmml" xref="Sx3.SSx1.p1.36.m6.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.36.m6.1c">g_{model}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx1.p1.36.m6.1d">italic_g start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>] to the server. It is important to note that the user interaction sequence can not be uploaded due to its privacy sensitivity. Finally, the server aggregates all the received gradients with certain aggregation rules and updates the global model. Such training round proceeds iteratively until convergence.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx3.SSx2">
<h3 class="ltx_title ltx_title_subsection">Threat Model</h3>
<section class="ltx_paragraph" id="Sx3.SSx2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Attack Goal.</h5>
<div class="ltx_para" id="Sx3.SSx2.SSS0.Px1.p1">
<p class="ltx_p" id="Sx3.SSx2.SSS0.Px1.p1.1">The attacker aims to increase the target item’s exposure <math alttext="\epsilon" class="ltx_Math" display="inline" id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1"><semantics id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1a"><mi id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1.1" xref="Sx3.SSx2.SSS0.Px1.p1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1b"><ci id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px1.p1.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx2.SSS0.Px1.p1.1.m1.1d">italic_ϵ</annotation></semantics></math> of the FSR system on arbitrarily inputs.</p>
</div>
</section>
<section class="ltx_paragraph" id="Sx3.SSx2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Attack Capability and knowledge.</h5>
<div class="ltx_para" id="Sx3.SSx2.SSS0.Px2.p1">
<p class="ltx_p" id="Sx3.SSx2.SSS0.Px2.p1.5">The attacker controls a set of malicious clients <math alttext="\mathcal{U}_{mal}" class="ltx_Math" display="inline" id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1"><semantics id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1a"><msub id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.2" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.2.cmml">𝒰</mi><mrow id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.2" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">m</mi><mo id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.1" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.3" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">a</mi><mo id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.1a" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.4" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.4.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1b"><apply id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.2">𝒰</ci><apply id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3"><times id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.1"></times><ci id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.2">𝑚</ci><ci id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.3">𝑎</ci><ci id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.4.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.1.m1.1.1.3.4">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1c">\mathcal{U}_{mal}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx2.SSS0.Px2.p1.1.m1.1d">caligraphic_U start_POSTSUBSCRIPT italic_m italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math> which accounts for <math alttext="m" class="ltx_Math" display="inline" id="Sx3.SSx2.SSS0.Px2.p1.2.m2.1"><semantics id="Sx3.SSx2.SSS0.Px2.p1.2.m2.1a"><mi id="Sx3.SSx2.SSS0.Px2.p1.2.m2.1.1" xref="Sx3.SSx2.SSS0.Px2.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px2.p1.2.m2.1b"><ci id="Sx3.SSx2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px2.p1.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx2.SSS0.Px2.p1.2.m2.1d">italic_m</annotation></semantics></math>% of <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="Sx3.SSx2.SSS0.Px2.p1.3.m3.1"><semantics id="Sx3.SSx2.SSS0.Px2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx2.SSS0.Px2.p1.3.m3.1.1" xref="Sx3.SSx2.SSS0.Px2.p1.3.m3.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px2.p1.3.m3.1b"><ci id="Sx3.SSx2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.3.m3.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px2.p1.3.m3.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx2.SSS0.Px2.p1.3.m3.1d">caligraphic_U</annotation></semantics></math>. As there are usually millions of users in a recommender system, we assume that <math alttext="m" class="ltx_Math" display="inline" id="Sx3.SSx2.SSS0.Px2.p1.4.m4.1"><semantics id="Sx3.SSx2.SSS0.Px2.p1.4.m4.1a"><mi id="Sx3.SSx2.SSS0.Px2.p1.4.m4.1.1" xref="Sx3.SSx2.SSS0.Px2.p1.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px2.p1.4.m4.1b"><ci id="Sx3.SSx2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px2.p1.4.m4.1c">m</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx2.SSS0.Px2.p1.4.m4.1d">italic_m</annotation></semantics></math> should be small (e.g., <math alttext="m=0.1" class="ltx_Math" display="inline" id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1"><semantics id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1a"><mrow id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1" xref="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.2" xref="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.2.cmml">m</mi><mo id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.1" xref="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.1.cmml">=</mo><mn id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.3" xref="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1b"><apply id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1"><eq id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.1"></eq><ci id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.2">𝑚</ci><cn id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.3.cmml" type="float" xref="Sx3.SSx2.SSS0.Px2.p1.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1c">m=0.1</annotation><annotation encoding="application/x-llamapun" id="Sx3.SSx2.SSS0.Px2.p1.5.m5.1d">italic_m = 0.1</annotation></semantics></math>). Following previous works <cite class="ltx_cite ltx_citemacro_citep">(Wu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib31" title="">2022</a>; Zhang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib36" title="">2022</a>; Yu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib33" title="">2023</a>)</cite>, we assume that the attacker has access to the training code, local model, and user data on the devices of malicious clients while cannot access the data or gradients of other benign clients. The attacker can arbitrarily modify the gradients uploaded by the malicious clients. We also assume the attacker does not know the aggregation rule used by the server.</p>
</div>
<figure class="ltx_figure" id="Sx3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="467" id="Sx3.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The Procedure of Our DV-FSR Attack</figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="Sx4">
<h2 class="ltx_title ltx_title_section">Methodology</h2>
<div class="ltx_para" id="Sx4.p1">
<p class="ltx_p" id="Sx4.p1.1">In this section, we first provide a detailed description of the newly proposed DV-FSR framework. Subsequently, we also introduce a newly proposed defense mechanism.</p>
</div>
<section class="ltx_subsection" id="Sx4.SSx1">
<h3 class="ltx_title ltx_title_subsection">DV-FSR Framework Overview</h3>
<div class="ltx_para" id="Sx4.SSx1.p1">
<p class="ltx_p" id="Sx4.SSx1.p1.4">Following the previous works <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib33" title="">2023</a>; Rong, He, and Chen <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib25" title="">2022</a>)</cite>, we backdoor the target recommender model similarly by uploading a mix of clean gradients and poisoned gradients. Let <math alttext="\tilde{\mathcal{L}}" class="ltx_Math" display="inline" id="Sx4.SSx1.p1.1.m1.1"><semantics id="Sx4.SSx1.p1.1.m1.1a"><mover accent="true" id="Sx4.SSx1.p1.1.m1.1.1" xref="Sx4.SSx1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.SSx1.p1.1.m1.1.1.2" xref="Sx4.SSx1.p1.1.m1.1.1.2.cmml">ℒ</mi><mo id="Sx4.SSx1.p1.1.m1.1.1.1" xref="Sx4.SSx1.p1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.1.m1.1b"><apply id="Sx4.SSx1.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.p1.1.m1.1.1"><ci id="Sx4.SSx1.p1.1.m1.1.1.1.cmml" xref="Sx4.SSx1.p1.1.m1.1.1.1">~</ci><ci id="Sx4.SSx1.p1.1.m1.1.1.2.cmml" xref="Sx4.SSx1.p1.1.m1.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.1.m1.1c">\tilde{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.p1.1.m1.1d">over~ start_ARG caligraphic_L end_ARG</annotation></semantics></math> denote the loss function which can indicate the goal of our attack. In the t-th round of training, each selected benign user <math alttext="\mu" class="ltx_Math" display="inline" id="Sx4.SSx1.p1.2.m2.1"><semantics id="Sx4.SSx1.p1.2.m2.1a"><mi id="Sx4.SSx1.p1.2.m2.1.1" xref="Sx4.SSx1.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.2.m2.1b"><ci id="Sx4.SSx1.p1.2.m2.1.1.cmml" xref="Sx4.SSx1.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.2.m2.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.p1.2.m2.1d">italic_μ</annotation></semantics></math> uploads gradients of <math alttext="\mathcal{L}_{u}" class="ltx_Math" display="inline" id="Sx4.SSx1.p1.3.m3.1"><semantics id="Sx4.SSx1.p1.3.m3.1a"><msub id="Sx4.SSx1.p1.3.m3.1.1" xref="Sx4.SSx1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.SSx1.p1.3.m3.1.1.2" xref="Sx4.SSx1.p1.3.m3.1.1.2.cmml">ℒ</mi><mi id="Sx4.SSx1.p1.3.m3.1.1.3" xref="Sx4.SSx1.p1.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.3.m3.1b"><apply id="Sx4.SSx1.p1.3.m3.1.1.cmml" xref="Sx4.SSx1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.p1.3.m3.1.1.1.cmml" xref="Sx4.SSx1.p1.3.m3.1.1">subscript</csymbol><ci id="Sx4.SSx1.p1.3.m3.1.1.2.cmml" xref="Sx4.SSx1.p1.3.m3.1.1.2">ℒ</ci><ci id="Sx4.SSx1.p1.3.m3.1.1.3.cmml" xref="Sx4.SSx1.p1.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.3.m3.1c">\mathcal{L}_{u}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>(i.e. clean gradients). To achieve the goal of our attack, we manipulate the selected malicious users to upload gradients of <math alttext="\tilde{\mathcal{L}}" class="ltx_Math" display="inline" id="Sx4.SSx1.p1.4.m4.1"><semantics id="Sx4.SSx1.p1.4.m4.1a"><mover accent="true" id="Sx4.SSx1.p1.4.m4.1.1" xref="Sx4.SSx1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.SSx1.p1.4.m4.1.1.2" xref="Sx4.SSx1.p1.4.m4.1.1.2.cmml">ℒ</mi><mo id="Sx4.SSx1.p1.4.m4.1.1.1" xref="Sx4.SSx1.p1.4.m4.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.4.m4.1b"><apply id="Sx4.SSx1.p1.4.m4.1.1.cmml" xref="Sx4.SSx1.p1.4.m4.1.1"><ci id="Sx4.SSx1.p1.4.m4.1.1.1.cmml" xref="Sx4.SSx1.p1.4.m4.1.1.1">~</ci><ci id="Sx4.SSx1.p1.4.m4.1.1.2.cmml" xref="Sx4.SSx1.p1.4.m4.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.4.m4.1c">\tilde{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.p1.4.m4.1d">over~ start_ARG caligraphic_L end_ARG</annotation></semantics></math>(i.e. poisoned gradients). The actual loss function of the recommender model under our attack can be represented:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{server}=\sum_{u\in\mathcal{U}}\mathcal{L}_{u}+\alpha\tilde{%
\mathcal{L}}" class="ltx_Math" display="block" id="Sx4.Ex3.m1.1"><semantics id="Sx4.Ex3.m1.1a"><mrow id="Sx4.Ex3.m1.1.1" xref="Sx4.Ex3.m1.1.1.cmml"><msub id="Sx4.Ex3.m1.1.1.2" xref="Sx4.Ex3.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.Ex3.m1.1.1.2.2" xref="Sx4.Ex3.m1.1.1.2.2.cmml">ℒ</mi><mrow id="Sx4.Ex3.m1.1.1.2.3" xref="Sx4.Ex3.m1.1.1.2.3.cmml"><mi id="Sx4.Ex3.m1.1.1.2.3.2" xref="Sx4.Ex3.m1.1.1.2.3.2.cmml">s</mi><mo id="Sx4.Ex3.m1.1.1.2.3.1" xref="Sx4.Ex3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="Sx4.Ex3.m1.1.1.2.3.3" xref="Sx4.Ex3.m1.1.1.2.3.3.cmml">e</mi><mo id="Sx4.Ex3.m1.1.1.2.3.1a" xref="Sx4.Ex3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="Sx4.Ex3.m1.1.1.2.3.4" xref="Sx4.Ex3.m1.1.1.2.3.4.cmml">r</mi><mo id="Sx4.Ex3.m1.1.1.2.3.1b" xref="Sx4.Ex3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="Sx4.Ex3.m1.1.1.2.3.5" xref="Sx4.Ex3.m1.1.1.2.3.5.cmml">v</mi><mo id="Sx4.Ex3.m1.1.1.2.3.1c" xref="Sx4.Ex3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="Sx4.Ex3.m1.1.1.2.3.6" xref="Sx4.Ex3.m1.1.1.2.3.6.cmml">e</mi><mo id="Sx4.Ex3.m1.1.1.2.3.1d" xref="Sx4.Ex3.m1.1.1.2.3.1.cmml">⁢</mo><mi id="Sx4.Ex3.m1.1.1.2.3.7" xref="Sx4.Ex3.m1.1.1.2.3.7.cmml">r</mi></mrow></msub><mo id="Sx4.Ex3.m1.1.1.1" rspace="0.111em" xref="Sx4.Ex3.m1.1.1.1.cmml">=</mo><mrow id="Sx4.Ex3.m1.1.1.3" xref="Sx4.Ex3.m1.1.1.3.cmml"><mrow id="Sx4.Ex3.m1.1.1.3.2" xref="Sx4.Ex3.m1.1.1.3.2.cmml"><munder id="Sx4.Ex3.m1.1.1.3.2.1" xref="Sx4.Ex3.m1.1.1.3.2.1.cmml"><mo id="Sx4.Ex3.m1.1.1.3.2.1.2" movablelimits="false" xref="Sx4.Ex3.m1.1.1.3.2.1.2.cmml">∑</mo><mrow id="Sx4.Ex3.m1.1.1.3.2.1.3" xref="Sx4.Ex3.m1.1.1.3.2.1.3.cmml"><mi id="Sx4.Ex3.m1.1.1.3.2.1.3.2" xref="Sx4.Ex3.m1.1.1.3.2.1.3.2.cmml">u</mi><mo id="Sx4.Ex3.m1.1.1.3.2.1.3.1" xref="Sx4.Ex3.m1.1.1.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Sx4.Ex3.m1.1.1.3.2.1.3.3" xref="Sx4.Ex3.m1.1.1.3.2.1.3.3.cmml">𝒰</mi></mrow></munder><msub id="Sx4.Ex3.m1.1.1.3.2.2" xref="Sx4.Ex3.m1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.Ex3.m1.1.1.3.2.2.2" xref="Sx4.Ex3.m1.1.1.3.2.2.2.cmml">ℒ</mi><mi id="Sx4.Ex3.m1.1.1.3.2.2.3" xref="Sx4.Ex3.m1.1.1.3.2.2.3.cmml">u</mi></msub></mrow><mo id="Sx4.Ex3.m1.1.1.3.1" xref="Sx4.Ex3.m1.1.1.3.1.cmml">+</mo><mrow id="Sx4.Ex3.m1.1.1.3.3" xref="Sx4.Ex3.m1.1.1.3.3.cmml"><mi id="Sx4.Ex3.m1.1.1.3.3.2" xref="Sx4.Ex3.m1.1.1.3.3.2.cmml">α</mi><mo id="Sx4.Ex3.m1.1.1.3.3.1" xref="Sx4.Ex3.m1.1.1.3.3.1.cmml">⁢</mo><mover accent="true" id="Sx4.Ex3.m1.1.1.3.3.3" xref="Sx4.Ex3.m1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.Ex3.m1.1.1.3.3.3.2" xref="Sx4.Ex3.m1.1.1.3.3.3.2.cmml">ℒ</mi><mo id="Sx4.Ex3.m1.1.1.3.3.3.1" xref="Sx4.Ex3.m1.1.1.3.3.3.1.cmml">~</mo></mover></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex3.m1.1b"><apply id="Sx4.Ex3.m1.1.1.cmml" xref="Sx4.Ex3.m1.1.1"><eq id="Sx4.Ex3.m1.1.1.1.cmml" xref="Sx4.Ex3.m1.1.1.1"></eq><apply id="Sx4.Ex3.m1.1.1.2.cmml" xref="Sx4.Ex3.m1.1.1.2"><csymbol cd="ambiguous" id="Sx4.Ex3.m1.1.1.2.1.cmml" xref="Sx4.Ex3.m1.1.1.2">subscript</csymbol><ci id="Sx4.Ex3.m1.1.1.2.2.cmml" xref="Sx4.Ex3.m1.1.1.2.2">ℒ</ci><apply id="Sx4.Ex3.m1.1.1.2.3.cmml" xref="Sx4.Ex3.m1.1.1.2.3"><times id="Sx4.Ex3.m1.1.1.2.3.1.cmml" xref="Sx4.Ex3.m1.1.1.2.3.1"></times><ci id="Sx4.Ex3.m1.1.1.2.3.2.cmml" xref="Sx4.Ex3.m1.1.1.2.3.2">𝑠</ci><ci id="Sx4.Ex3.m1.1.1.2.3.3.cmml" xref="Sx4.Ex3.m1.1.1.2.3.3">𝑒</ci><ci id="Sx4.Ex3.m1.1.1.2.3.4.cmml" xref="Sx4.Ex3.m1.1.1.2.3.4">𝑟</ci><ci id="Sx4.Ex3.m1.1.1.2.3.5.cmml" xref="Sx4.Ex3.m1.1.1.2.3.5">𝑣</ci><ci id="Sx4.Ex3.m1.1.1.2.3.6.cmml" xref="Sx4.Ex3.m1.1.1.2.3.6">𝑒</ci><ci id="Sx4.Ex3.m1.1.1.2.3.7.cmml" xref="Sx4.Ex3.m1.1.1.2.3.7">𝑟</ci></apply></apply><apply id="Sx4.Ex3.m1.1.1.3.cmml" xref="Sx4.Ex3.m1.1.1.3"><plus id="Sx4.Ex3.m1.1.1.3.1.cmml" xref="Sx4.Ex3.m1.1.1.3.1"></plus><apply id="Sx4.Ex3.m1.1.1.3.2.cmml" xref="Sx4.Ex3.m1.1.1.3.2"><apply id="Sx4.Ex3.m1.1.1.3.2.1.cmml" xref="Sx4.Ex3.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="Sx4.Ex3.m1.1.1.3.2.1.1.cmml" xref="Sx4.Ex3.m1.1.1.3.2.1">subscript</csymbol><sum id="Sx4.Ex3.m1.1.1.3.2.1.2.cmml" xref="Sx4.Ex3.m1.1.1.3.2.1.2"></sum><apply id="Sx4.Ex3.m1.1.1.3.2.1.3.cmml" xref="Sx4.Ex3.m1.1.1.3.2.1.3"><in id="Sx4.Ex3.m1.1.1.3.2.1.3.1.cmml" xref="Sx4.Ex3.m1.1.1.3.2.1.3.1"></in><ci id="Sx4.Ex3.m1.1.1.3.2.1.3.2.cmml" xref="Sx4.Ex3.m1.1.1.3.2.1.3.2">𝑢</ci><ci id="Sx4.Ex3.m1.1.1.3.2.1.3.3.cmml" xref="Sx4.Ex3.m1.1.1.3.2.1.3.3">𝒰</ci></apply></apply><apply id="Sx4.Ex3.m1.1.1.3.2.2.cmml" xref="Sx4.Ex3.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx4.Ex3.m1.1.1.3.2.2.1.cmml" xref="Sx4.Ex3.m1.1.1.3.2.2">subscript</csymbol><ci id="Sx4.Ex3.m1.1.1.3.2.2.2.cmml" xref="Sx4.Ex3.m1.1.1.3.2.2.2">ℒ</ci><ci id="Sx4.Ex3.m1.1.1.3.2.2.3.cmml" xref="Sx4.Ex3.m1.1.1.3.2.2.3">𝑢</ci></apply></apply><apply id="Sx4.Ex3.m1.1.1.3.3.cmml" xref="Sx4.Ex3.m1.1.1.3.3"><times id="Sx4.Ex3.m1.1.1.3.3.1.cmml" xref="Sx4.Ex3.m1.1.1.3.3.1"></times><ci id="Sx4.Ex3.m1.1.1.3.3.2.cmml" xref="Sx4.Ex3.m1.1.1.3.3.2">𝛼</ci><apply id="Sx4.Ex3.m1.1.1.3.3.3.cmml" xref="Sx4.Ex3.m1.1.1.3.3.3"><ci id="Sx4.Ex3.m1.1.1.3.3.3.1.cmml" xref="Sx4.Ex3.m1.1.1.3.3.3.1">~</ci><ci id="Sx4.Ex3.m1.1.1.3.3.3.2.cmml" xref="Sx4.Ex3.m1.1.1.3.3.3.2">ℒ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex3.m1.1c">\mathcal{L}_{server}=\sum_{u\in\mathcal{U}}\mathcal{L}_{u}+\alpha\tilde{%
\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex3.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_s italic_e italic_r italic_v italic_e italic_r end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_u ∈ caligraphic_U end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT + italic_α over~ start_ARG caligraphic_L end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.SSx1.p1.6">where <math alttext="\alpha" class="ltx_Math" display="inline" id="Sx4.SSx1.p1.5.m1.1"><semantics id="Sx4.SSx1.p1.5.m1.1a"><mi id="Sx4.SSx1.p1.5.m1.1.1" xref="Sx4.SSx1.p1.5.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.5.m1.1b"><ci id="Sx4.SSx1.p1.5.m1.1.1.cmml" xref="Sx4.SSx1.p1.5.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.5.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.p1.5.m1.1d">italic_α</annotation></semantics></math> is a positive coefficient that trades off between the model validity and the attack effectiveness.
To address the problems, we adopt steps to design a proper loss function <math alttext="\tilde{\mathcal{L}}" class="ltx_Math" display="inline" id="Sx4.SSx1.p1.6.m2.1"><semantics id="Sx4.SSx1.p1.6.m2.1a"><mover accent="true" id="Sx4.SSx1.p1.6.m2.1.1" xref="Sx4.SSx1.p1.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.SSx1.p1.6.m2.1.1.2" xref="Sx4.SSx1.p1.6.m2.1.1.2.cmml">ℒ</mi><mo id="Sx4.SSx1.p1.6.m2.1.1.1" xref="Sx4.SSx1.p1.6.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.p1.6.m2.1b"><apply id="Sx4.SSx1.p1.6.m2.1.1.cmml" xref="Sx4.SSx1.p1.6.m2.1.1"><ci id="Sx4.SSx1.p1.6.m2.1.1.1.cmml" xref="Sx4.SSx1.p1.6.m2.1.1.1">~</ci><ci id="Sx4.SSx1.p1.6.m2.1.1.2.cmml" xref="Sx4.SSx1.p1.6.m2.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.p1.6.m2.1c">\tilde{\mathcal{L}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.p1.6.m2.1d">over~ start_ARG caligraphic_L end_ARG</annotation></semantics></math> for our attacks.
We utilized the algorithm steps in Figure 1 and Algorithm 1 to carry out the dual-view DV-FSR attack.
When selected for model training, the malicious client receives the latest global model from the server, which contains embedding and model (step 1).</p>
</div>
<section class="ltx_subsubsection" id="Sx4.SSx1.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Explicit Strategy.</h4>
<div class="ltx_para" id="Sx4.SSx1.SSSx1.p1">
<p class="ltx_p" id="Sx4.SSx1.SSSx1.p1.5">To better utilize the sequence, we run Substitution Algorithm, and choose one most vulnerable item to replace (step 2). We provide a detailed description of the Substitution Algorithm demonstrated in Algorithm 2.</p>
<ul class="ltx_itemize" id="Sx4.I2">
<li class="ltx_item" id="Sx4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i1.p1">
<p class="ltx_p" id="Sx4.I2.i1.p1.10"><span class="ltx_text ltx_font_bold" id="Sx4.I2.i1.p1.10.1">Forward and Compute Gradients</span>. First, we initialize <math alttext="x^{\prime}" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.1.m1.1"><semantics id="Sx4.I2.i1.p1.1.m1.1a"><msup id="Sx4.I2.i1.p1.1.m1.1.1" xref="Sx4.I2.i1.p1.1.m1.1.1.cmml"><mi id="Sx4.I2.i1.p1.1.m1.1.1.2" xref="Sx4.I2.i1.p1.1.m1.1.1.2.cmml">x</mi><mo id="Sx4.I2.i1.p1.1.m1.1.1.3" xref="Sx4.I2.i1.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.1.m1.1b"><apply id="Sx4.I2.i1.p1.1.m1.1.1.cmml" xref="Sx4.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.1.m1.1.1.1.cmml" xref="Sx4.I2.i1.p1.1.m1.1.1">superscript</csymbol><ci id="Sx4.I2.i1.p1.1.m1.1.1.2.cmml" xref="Sx4.I2.i1.p1.1.m1.1.1.2">𝑥</ci><ci id="Sx4.I2.i1.p1.1.m1.1.1.3.cmml" xref="Sx4.I2.i1.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.1.m1.1c">x^{\prime}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.1.m1.1d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> unchanged to <math alttext="x" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.2.m2.1"><semantics id="Sx4.I2.i1.p1.2.m2.1a"><mi id="Sx4.I2.i1.p1.2.m2.1.1" xref="Sx4.I2.i1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.2.m2.1b"><ci id="Sx4.I2.i1.p1.2.m2.1.1.cmml" xref="Sx4.I2.i1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.2.m2.1d">italic_x</annotation></semantics></math>, followed by computing the embedded sequence <math alttext="\tilde{x}^{\prime}" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.3.m3.1"><semantics id="Sx4.I2.i1.p1.3.m3.1a"><msup id="Sx4.I2.i1.p1.3.m3.1.1" xref="Sx4.I2.i1.p1.3.m3.1.1.cmml"><mover accent="true" id="Sx4.I2.i1.p1.3.m3.1.1.2" xref="Sx4.I2.i1.p1.3.m3.1.1.2.cmml"><mi id="Sx4.I2.i1.p1.3.m3.1.1.2.2" xref="Sx4.I2.i1.p1.3.m3.1.1.2.2.cmml">x</mi><mo id="Sx4.I2.i1.p1.3.m3.1.1.2.1" xref="Sx4.I2.i1.p1.3.m3.1.1.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i1.p1.3.m3.1.1.3" xref="Sx4.I2.i1.p1.3.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.3.m3.1b"><apply id="Sx4.I2.i1.p1.3.m3.1.1.cmml" xref="Sx4.I2.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.3.m3.1.1.1.cmml" xref="Sx4.I2.i1.p1.3.m3.1.1">superscript</csymbol><apply id="Sx4.I2.i1.p1.3.m3.1.1.2.cmml" xref="Sx4.I2.i1.p1.3.m3.1.1.2"><ci id="Sx4.I2.i1.p1.3.m3.1.1.2.1.cmml" xref="Sx4.I2.i1.p1.3.m3.1.1.2.1">~</ci><ci id="Sx4.I2.i1.p1.3.m3.1.1.2.2.cmml" xref="Sx4.I2.i1.p1.3.m3.1.1.2.2">𝑥</ci></apply><ci id="Sx4.I2.i1.p1.3.m3.1.1.3.cmml" xref="Sx4.I2.i1.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.3.m3.1c">\tilde{x}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.3.m3.1d">over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> using the embedding function <math alttext="f_{e}" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.4.m4.1"><semantics id="Sx4.I2.i1.p1.4.m4.1a"><msub id="Sx4.I2.i1.p1.4.m4.1.1" xref="Sx4.I2.i1.p1.4.m4.1.1.cmml"><mi id="Sx4.I2.i1.p1.4.m4.1.1.2" xref="Sx4.I2.i1.p1.4.m4.1.1.2.cmml">f</mi><mi id="Sx4.I2.i1.p1.4.m4.1.1.3" xref="Sx4.I2.i1.p1.4.m4.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.4.m4.1b"><apply id="Sx4.I2.i1.p1.4.m4.1.1.cmml" xref="Sx4.I2.i1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.4.m4.1.1.1.cmml" xref="Sx4.I2.i1.p1.4.m4.1.1">subscript</csymbol><ci id="Sx4.I2.i1.p1.4.m4.1.1.2.cmml" xref="Sx4.I2.i1.p1.4.m4.1.1.2">𝑓</ci><ci id="Sx4.I2.i1.p1.4.m4.1.1.3.cmml" xref="Sx4.I2.i1.p1.4.m4.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.4.m4.1c">f_{e}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math>. Then <math alttext="\tilde{x}^{\prime}" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.5.m5.1"><semantics id="Sx4.I2.i1.p1.5.m5.1a"><msup id="Sx4.I2.i1.p1.5.m5.1.1" xref="Sx4.I2.i1.p1.5.m5.1.1.cmml"><mover accent="true" id="Sx4.I2.i1.p1.5.m5.1.1.2" xref="Sx4.I2.i1.p1.5.m5.1.1.2.cmml"><mi id="Sx4.I2.i1.p1.5.m5.1.1.2.2" xref="Sx4.I2.i1.p1.5.m5.1.1.2.2.cmml">x</mi><mo id="Sx4.I2.i1.p1.5.m5.1.1.2.1" xref="Sx4.I2.i1.p1.5.m5.1.1.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i1.p1.5.m5.1.1.3" xref="Sx4.I2.i1.p1.5.m5.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.5.m5.1b"><apply id="Sx4.I2.i1.p1.5.m5.1.1.cmml" xref="Sx4.I2.i1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.5.m5.1.1.1.cmml" xref="Sx4.I2.i1.p1.5.m5.1.1">superscript</csymbol><apply id="Sx4.I2.i1.p1.5.m5.1.1.2.cmml" xref="Sx4.I2.i1.p1.5.m5.1.1.2"><ci id="Sx4.I2.i1.p1.5.m5.1.1.2.1.cmml" xref="Sx4.I2.i1.p1.5.m5.1.1.2.1">~</ci><ci id="Sx4.I2.i1.p1.5.m5.1.1.2.2.cmml" xref="Sx4.I2.i1.p1.5.m5.1.1.2.2">𝑥</ci></apply><ci id="Sx4.I2.i1.p1.5.m5.1.1.3.cmml" xref="Sx4.I2.i1.p1.5.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.5.m5.1c">\tilde{x}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.5.m5.1d">over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is fed through the recommender function <math alttext="f_{m}" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.6.m6.1"><semantics id="Sx4.I2.i1.p1.6.m6.1a"><msub id="Sx4.I2.i1.p1.6.m6.1.1" xref="Sx4.I2.i1.p1.6.m6.1.1.cmml"><mi id="Sx4.I2.i1.p1.6.m6.1.1.2" xref="Sx4.I2.i1.p1.6.m6.1.1.2.cmml">f</mi><mi id="Sx4.I2.i1.p1.6.m6.1.1.3" xref="Sx4.I2.i1.p1.6.m6.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.6.m6.1b"><apply id="Sx4.I2.i1.p1.6.m6.1.1.cmml" xref="Sx4.I2.i1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.6.m6.1.1.1.cmml" xref="Sx4.I2.i1.p1.6.m6.1.1">subscript</csymbol><ci id="Sx4.I2.i1.p1.6.m6.1.1.2.cmml" xref="Sx4.I2.i1.p1.6.m6.1.1.2">𝑓</ci><ci id="Sx4.I2.i1.p1.6.m6.1.1.3.cmml" xref="Sx4.I2.i1.p1.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.6.m6.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> to compute the cross entropy loss <math alttext="L_{ce}" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.7.m7.1"><semantics id="Sx4.I2.i1.p1.7.m7.1a"><msub id="Sx4.I2.i1.p1.7.m7.1.1" xref="Sx4.I2.i1.p1.7.m7.1.1.cmml"><mi id="Sx4.I2.i1.p1.7.m7.1.1.2" xref="Sx4.I2.i1.p1.7.m7.1.1.2.cmml">L</mi><mrow id="Sx4.I2.i1.p1.7.m7.1.1.3" xref="Sx4.I2.i1.p1.7.m7.1.1.3.cmml"><mi id="Sx4.I2.i1.p1.7.m7.1.1.3.2" xref="Sx4.I2.i1.p1.7.m7.1.1.3.2.cmml">c</mi><mo id="Sx4.I2.i1.p1.7.m7.1.1.3.1" xref="Sx4.I2.i1.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="Sx4.I2.i1.p1.7.m7.1.1.3.3" xref="Sx4.I2.i1.p1.7.m7.1.1.3.3.cmml">e</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.7.m7.1b"><apply id="Sx4.I2.i1.p1.7.m7.1.1.cmml" xref="Sx4.I2.i1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.7.m7.1.1.1.cmml" xref="Sx4.I2.i1.p1.7.m7.1.1">subscript</csymbol><ci id="Sx4.I2.i1.p1.7.m7.1.1.2.cmml" xref="Sx4.I2.i1.p1.7.m7.1.1.2">𝐿</ci><apply id="Sx4.I2.i1.p1.7.m7.1.1.3.cmml" xref="Sx4.I2.i1.p1.7.m7.1.1.3"><times id="Sx4.I2.i1.p1.7.m7.1.1.3.1.cmml" xref="Sx4.I2.i1.p1.7.m7.1.1.3.1"></times><ci id="Sx4.I2.i1.p1.7.m7.1.1.3.2.cmml" xref="Sx4.I2.i1.p1.7.m7.1.1.3.2">𝑐</ci><ci id="Sx4.I2.i1.p1.7.m7.1.1.3.3.cmml" xref="Sx4.I2.i1.p1.7.m7.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.7.m7.1c">L_{ce}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.7.m7.1d">italic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT</annotation></semantics></math> w.r.t target item t. Then, backward propagation is performed to retrieve the gradients <math alttext="\Delta_{\tilde{x}^{\prime}}" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.8.m8.1"><semantics id="Sx4.I2.i1.p1.8.m8.1a"><msub id="Sx4.I2.i1.p1.8.m8.1.1" xref="Sx4.I2.i1.p1.8.m8.1.1.cmml"><mi id="Sx4.I2.i1.p1.8.m8.1.1.2" mathvariant="normal" xref="Sx4.I2.i1.p1.8.m8.1.1.2.cmml">Δ</mi><msup id="Sx4.I2.i1.p1.8.m8.1.1.3" xref="Sx4.I2.i1.p1.8.m8.1.1.3.cmml"><mover accent="true" id="Sx4.I2.i1.p1.8.m8.1.1.3.2" xref="Sx4.I2.i1.p1.8.m8.1.1.3.2.cmml"><mi id="Sx4.I2.i1.p1.8.m8.1.1.3.2.2" xref="Sx4.I2.i1.p1.8.m8.1.1.3.2.2.cmml">x</mi><mo id="Sx4.I2.i1.p1.8.m8.1.1.3.2.1" xref="Sx4.I2.i1.p1.8.m8.1.1.3.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i1.p1.8.m8.1.1.3.3" xref="Sx4.I2.i1.p1.8.m8.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.8.m8.1b"><apply id="Sx4.I2.i1.p1.8.m8.1.1.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.8.m8.1.1.1.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1">subscript</csymbol><ci id="Sx4.I2.i1.p1.8.m8.1.1.2.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1.2">Δ</ci><apply id="Sx4.I2.i1.p1.8.m8.1.1.3.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.8.m8.1.1.3.1.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1.3">superscript</csymbol><apply id="Sx4.I2.i1.p1.8.m8.1.1.3.2.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1.3.2"><ci id="Sx4.I2.i1.p1.8.m8.1.1.3.2.1.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1.3.2.1">~</ci><ci id="Sx4.I2.i1.p1.8.m8.1.1.3.2.2.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1.3.2.2">𝑥</ci></apply><ci id="Sx4.I2.i1.p1.8.m8.1.1.3.3.cmml" xref="Sx4.I2.i1.p1.8.m8.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.8.m8.1c">\Delta_{\tilde{x}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.8.m8.1d">roman_Δ start_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>(i.e. <math alttext="\Delta_{\tilde{x}^{\prime}}" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.9.m9.1"><semantics id="Sx4.I2.i1.p1.9.m9.1a"><msub id="Sx4.I2.i1.p1.9.m9.1.1" xref="Sx4.I2.i1.p1.9.m9.1.1.cmml"><mi id="Sx4.I2.i1.p1.9.m9.1.1.2" mathvariant="normal" xref="Sx4.I2.i1.p1.9.m9.1.1.2.cmml">Δ</mi><msup id="Sx4.I2.i1.p1.9.m9.1.1.3" xref="Sx4.I2.i1.p1.9.m9.1.1.3.cmml"><mover accent="true" id="Sx4.I2.i1.p1.9.m9.1.1.3.2" xref="Sx4.I2.i1.p1.9.m9.1.1.3.2.cmml"><mi id="Sx4.I2.i1.p1.9.m9.1.1.3.2.2" xref="Sx4.I2.i1.p1.9.m9.1.1.3.2.2.cmml">x</mi><mo id="Sx4.I2.i1.p1.9.m9.1.1.3.2.1" xref="Sx4.I2.i1.p1.9.m9.1.1.3.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i1.p1.9.m9.1.1.3.3" xref="Sx4.I2.i1.p1.9.m9.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.9.m9.1b"><apply id="Sx4.I2.i1.p1.9.m9.1.1.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.9.m9.1.1.1.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1">subscript</csymbol><ci id="Sx4.I2.i1.p1.9.m9.1.1.2.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1.2">Δ</ci><apply id="Sx4.I2.i1.p1.9.m9.1.1.3.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1.3"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.9.m9.1.1.3.1.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1.3">superscript</csymbol><apply id="Sx4.I2.i1.p1.9.m9.1.1.3.2.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1.3.2"><ci id="Sx4.I2.i1.p1.9.m9.1.1.3.2.1.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1.3.2.1">~</ci><ci id="Sx4.I2.i1.p1.9.m9.1.1.3.2.2.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1.3.2.2">𝑥</ci></apply><ci id="Sx4.I2.i1.p1.9.m9.1.1.3.3.cmml" xref="Sx4.I2.i1.p1.9.m9.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.9.m9.1c">\Delta_{\tilde{x}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.9.m9.1d">roman_Δ start_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> = <math alttext="\Delta_{\tilde{x}^{\prime}}L_{ce}(f_{m}(\tilde{x}^{\prime},t))" class="ltx_Math" display="inline" id="Sx4.I2.i1.p1.10.m10.2"><semantics id="Sx4.I2.i1.p1.10.m10.2a"><mrow id="Sx4.I2.i1.p1.10.m10.2.2" xref="Sx4.I2.i1.p1.10.m10.2.2.cmml"><msub id="Sx4.I2.i1.p1.10.m10.2.2.3" xref="Sx4.I2.i1.p1.10.m10.2.2.3.cmml"><mi id="Sx4.I2.i1.p1.10.m10.2.2.3.2" mathvariant="normal" xref="Sx4.I2.i1.p1.10.m10.2.2.3.2.cmml">Δ</mi><msup id="Sx4.I2.i1.p1.10.m10.2.2.3.3" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.cmml"><mover accent="true" id="Sx4.I2.i1.p1.10.m10.2.2.3.3.2" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.cmml"><mi id="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.2" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.2.cmml">x</mi><mo id="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.1" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i1.p1.10.m10.2.2.3.3.3" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.3.cmml">′</mo></msup></msub><mo id="Sx4.I2.i1.p1.10.m10.2.2.2" xref="Sx4.I2.i1.p1.10.m10.2.2.2.cmml">⁢</mo><msub id="Sx4.I2.i1.p1.10.m10.2.2.4" xref="Sx4.I2.i1.p1.10.m10.2.2.4.cmml"><mi id="Sx4.I2.i1.p1.10.m10.2.2.4.2" xref="Sx4.I2.i1.p1.10.m10.2.2.4.2.cmml">L</mi><mrow id="Sx4.I2.i1.p1.10.m10.2.2.4.3" xref="Sx4.I2.i1.p1.10.m10.2.2.4.3.cmml"><mi id="Sx4.I2.i1.p1.10.m10.2.2.4.3.2" xref="Sx4.I2.i1.p1.10.m10.2.2.4.3.2.cmml">c</mi><mo id="Sx4.I2.i1.p1.10.m10.2.2.4.3.1" xref="Sx4.I2.i1.p1.10.m10.2.2.4.3.1.cmml">⁢</mo><mi id="Sx4.I2.i1.p1.10.m10.2.2.4.3.3" xref="Sx4.I2.i1.p1.10.m10.2.2.4.3.3.cmml">e</mi></mrow></msub><mo id="Sx4.I2.i1.p1.10.m10.2.2.2a" xref="Sx4.I2.i1.p1.10.m10.2.2.2.cmml">⁢</mo><mrow id="Sx4.I2.i1.p1.10.m10.2.2.1.1" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.cmml"><mo id="Sx4.I2.i1.p1.10.m10.2.2.1.1.2" stretchy="false" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.cmml">(</mo><mrow id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.cmml"><msub id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.cmml"><mi id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.2" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.2.cmml">f</mi><mi id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.3" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.3.cmml">m</mi></msub><mo id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.2" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.2.cmml">⁢</mo><mrow id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.2.cmml"><mo id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.2" stretchy="false" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.2.cmml">(</mo><msup id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.cmml"><mi id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.2" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.1" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.3" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.3" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.2.cmml">,</mo><mi id="Sx4.I2.i1.p1.10.m10.1.1" xref="Sx4.I2.i1.p1.10.m10.1.1.cmml">t</mi><mo id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.4" stretchy="false" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx4.I2.i1.p1.10.m10.2.2.1.1.3" stretchy="false" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.I2.i1.p1.10.m10.2b"><apply id="Sx4.I2.i1.p1.10.m10.2.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2"><times id="Sx4.I2.i1.p1.10.m10.2.2.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.2"></times><apply id="Sx4.I2.i1.p1.10.m10.2.2.3.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.10.m10.2.2.3.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3">subscript</csymbol><ci id="Sx4.I2.i1.p1.10.m10.2.2.3.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3.2">Δ</ci><apply id="Sx4.I2.i1.p1.10.m10.2.2.3.3.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.10.m10.2.2.3.3.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3">superscript</csymbol><apply id="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.2"><ci id="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.1">~</ci><ci id="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.2.2">𝑥</ci></apply><ci id="Sx4.I2.i1.p1.10.m10.2.2.3.3.3.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.3.3.3">′</ci></apply></apply><apply id="Sx4.I2.i1.p1.10.m10.2.2.4.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.4"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.10.m10.2.2.4.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.4">subscript</csymbol><ci id="Sx4.I2.i1.p1.10.m10.2.2.4.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.4.2">𝐿</ci><apply id="Sx4.I2.i1.p1.10.m10.2.2.4.3.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.4.3"><times id="Sx4.I2.i1.p1.10.m10.2.2.4.3.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.4.3.1"></times><ci id="Sx4.I2.i1.p1.10.m10.2.2.4.3.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.4.3.2">𝑐</ci><ci id="Sx4.I2.i1.p1.10.m10.2.2.4.3.3.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.4.3.3">𝑒</ci></apply></apply><apply id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1"><times id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.2"></times><apply id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3">subscript</csymbol><ci id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.2">𝑓</ci><ci id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.3.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.3.3">𝑚</ci></apply><interval closure="open" id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1"><apply id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2"><ci id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.1.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.1">~</ci><ci id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.2.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.3.cmml" xref="Sx4.I2.i1.p1.10.m10.2.2.1.1.1.1.1.1.3">′</ci></apply><ci id="Sx4.I2.i1.p1.10.m10.1.1.cmml" xref="Sx4.I2.i1.p1.10.m10.1.1">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i1.p1.10.m10.2c">\Delta_{\tilde{x}^{\prime}}L_{ce}(f_{m}(\tilde{x}^{\prime},t))</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i1.p1.10.m10.2d">roman_Δ start_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_t ) )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i2.p1">
<p class="ltx_p" id="Sx4.I2.i2.p1.2"><span class="ltx_text ltx_font_bold" id="Sx4.I2.i2.p1.2.1">Select Vulnerable Items to Attack</span>. In input sequence, items are of different vulnerability. We select only one vulnerable item and perform substitution on such items to achieve the best attack performance. We calculate importance scores using <math alttext="\Delta_{\tilde{x}^{\prime}}" class="ltx_Math" display="inline" id="Sx4.I2.i2.p1.1.m1.1"><semantics id="Sx4.I2.i2.p1.1.m1.1a"><msub id="Sx4.I2.i2.p1.1.m1.1.1" xref="Sx4.I2.i2.p1.1.m1.1.1.cmml"><mi id="Sx4.I2.i2.p1.1.m1.1.1.2" mathvariant="normal" xref="Sx4.I2.i2.p1.1.m1.1.1.2.cmml">Δ</mi><msup id="Sx4.I2.i2.p1.1.m1.1.1.3" xref="Sx4.I2.i2.p1.1.m1.1.1.3.cmml"><mover accent="true" id="Sx4.I2.i2.p1.1.m1.1.1.3.2" xref="Sx4.I2.i2.p1.1.m1.1.1.3.2.cmml"><mi id="Sx4.I2.i2.p1.1.m1.1.1.3.2.2" xref="Sx4.I2.i2.p1.1.m1.1.1.3.2.2.cmml">x</mi><mo id="Sx4.I2.i2.p1.1.m1.1.1.3.2.1" xref="Sx4.I2.i2.p1.1.m1.1.1.3.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i2.p1.1.m1.1.1.3.3" xref="Sx4.I2.i2.p1.1.m1.1.1.3.3.cmml">′</mo></msup></msub><annotation-xml encoding="MathML-Content" id="Sx4.I2.i2.p1.1.m1.1b"><apply id="Sx4.I2.i2.p1.1.m1.1.1.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i2.p1.1.m1.1.1.1.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1">subscript</csymbol><ci id="Sx4.I2.i2.p1.1.m1.1.1.2.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1.2">Δ</ci><apply id="Sx4.I2.i2.p1.1.m1.1.1.3.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx4.I2.i2.p1.1.m1.1.1.3.1.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1.3">superscript</csymbol><apply id="Sx4.I2.i2.p1.1.m1.1.1.3.2.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1.3.2"><ci id="Sx4.I2.i2.p1.1.m1.1.1.3.2.1.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1.3.2.1">~</ci><ci id="Sx4.I2.i2.p1.1.m1.1.1.3.2.2.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1.3.2.2">𝑥</ci></apply><ci id="Sx4.I2.i2.p1.1.m1.1.1.3.3.cmml" xref="Sx4.I2.i2.p1.1.m1.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i2.p1.1.m1.1c">\Delta_{\tilde{x}^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i2.p1.1.m1.1d">roman_Δ start_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> from the previous step. We choose the first one item from importance ranking <span class="ltx_text ltx_font_bold" id="Sx4.I2.i2.p1.2.2">r</span>. Based on the fast gradient sign method, the perturbed embedding <math alttext="\tilde{x}^{\prime}" class="ltx_Math" display="inline" id="Sx4.I2.i2.p1.2.m2.1"><semantics id="Sx4.I2.i2.p1.2.m2.1a"><msup id="Sx4.I2.i2.p1.2.m2.1.1" xref="Sx4.I2.i2.p1.2.m2.1.1.cmml"><mover accent="true" id="Sx4.I2.i2.p1.2.m2.1.1.2" xref="Sx4.I2.i2.p1.2.m2.1.1.2.cmml"><mi id="Sx4.I2.i2.p1.2.m2.1.1.2.2" xref="Sx4.I2.i2.p1.2.m2.1.1.2.2.cmml">x</mi><mo id="Sx4.I2.i2.p1.2.m2.1.1.2.1" xref="Sx4.I2.i2.p1.2.m2.1.1.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i2.p1.2.m2.1.1.3" xref="Sx4.I2.i2.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx4.I2.i2.p1.2.m2.1b"><apply id="Sx4.I2.i2.p1.2.m2.1.1.cmml" xref="Sx4.I2.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i2.p1.2.m2.1.1.1.cmml" xref="Sx4.I2.i2.p1.2.m2.1.1">superscript</csymbol><apply id="Sx4.I2.i2.p1.2.m2.1.1.2.cmml" xref="Sx4.I2.i2.p1.2.m2.1.1.2"><ci id="Sx4.I2.i2.p1.2.m2.1.1.2.1.cmml" xref="Sx4.I2.i2.p1.2.m2.1.1.2.1">~</ci><ci id="Sx4.I2.i2.p1.2.m2.1.1.2.2.cmml" xref="Sx4.I2.i2.p1.2.m2.1.1.2.2">𝑥</ci></apply><ci id="Sx4.I2.i2.p1.2.m2.1.1.3.cmml" xref="Sx4.I2.i2.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i2.p1.2.m2.1c">\tilde{x}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i2.p1.2.m2.1d">over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> can be computed.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i3.p1">
<p class="ltx_p" id="Sx4.I2.i3.p1.5"><span class="ltx_text ltx_font_bold" id="Sx4.I2.i3.p1.5.1">Project Embedding to Item</span>. We project the perturbed embedding <math alttext="\tilde{x}^{\prime}" class="ltx_Math" display="inline" id="Sx4.I2.i3.p1.1.m1.1"><semantics id="Sx4.I2.i3.p1.1.m1.1a"><msup id="Sx4.I2.i3.p1.1.m1.1.1" xref="Sx4.I2.i3.p1.1.m1.1.1.cmml"><mover accent="true" id="Sx4.I2.i3.p1.1.m1.1.1.2" xref="Sx4.I2.i3.p1.1.m1.1.1.2.cmml"><mi id="Sx4.I2.i3.p1.1.m1.1.1.2.2" xref="Sx4.I2.i3.p1.1.m1.1.1.2.2.cmml">x</mi><mo id="Sx4.I2.i3.p1.1.m1.1.1.2.1" xref="Sx4.I2.i3.p1.1.m1.1.1.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i3.p1.1.m1.1.1.3" xref="Sx4.I2.i3.p1.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx4.I2.i3.p1.1.m1.1b"><apply id="Sx4.I2.i3.p1.1.m1.1.1.cmml" xref="Sx4.I2.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i3.p1.1.m1.1.1.1.cmml" xref="Sx4.I2.i3.p1.1.m1.1.1">superscript</csymbol><apply id="Sx4.I2.i3.p1.1.m1.1.1.2.cmml" xref="Sx4.I2.i3.p1.1.m1.1.1.2"><ci id="Sx4.I2.i3.p1.1.m1.1.1.2.1.cmml" xref="Sx4.I2.i3.p1.1.m1.1.1.2.1">~</ci><ci id="Sx4.I2.i3.p1.1.m1.1.1.2.2.cmml" xref="Sx4.I2.i3.p1.1.m1.1.1.2.2">𝑥</ci></apply><ci id="Sx4.I2.i3.p1.1.m1.1.1.3.cmml" xref="Sx4.I2.i3.p1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i3.p1.1.m1.1c">\tilde{x}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i3.p1.1.m1.1d">over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> back to the item, we compute cosine similarity between <math alttext="\tilde{x}^{\prime}" class="ltx_Math" display="inline" id="Sx4.I2.i3.p1.2.m2.1"><semantics id="Sx4.I2.i3.p1.2.m2.1a"><msup id="Sx4.I2.i3.p1.2.m2.1.1" xref="Sx4.I2.i3.p1.2.m2.1.1.cmml"><mover accent="true" id="Sx4.I2.i3.p1.2.m2.1.1.2" xref="Sx4.I2.i3.p1.2.m2.1.1.2.cmml"><mi id="Sx4.I2.i3.p1.2.m2.1.1.2.2" xref="Sx4.I2.i3.p1.2.m2.1.1.2.2.cmml">x</mi><mo id="Sx4.I2.i3.p1.2.m2.1.1.2.1" xref="Sx4.I2.i3.p1.2.m2.1.1.2.1.cmml">~</mo></mover><mo id="Sx4.I2.i3.p1.2.m2.1.1.3" xref="Sx4.I2.i3.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="Sx4.I2.i3.p1.2.m2.1b"><apply id="Sx4.I2.i3.p1.2.m2.1.1.cmml" xref="Sx4.I2.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.I2.i3.p1.2.m2.1.1.1.cmml" xref="Sx4.I2.i3.p1.2.m2.1.1">superscript</csymbol><apply id="Sx4.I2.i3.p1.2.m2.1.1.2.cmml" xref="Sx4.I2.i3.p1.2.m2.1.1.2"><ci id="Sx4.I2.i3.p1.2.m2.1.1.2.1.cmml" xref="Sx4.I2.i3.p1.2.m2.1.1.2.1">~</ci><ci id="Sx4.I2.i3.p1.2.m2.1.1.2.2.cmml" xref="Sx4.I2.i3.p1.2.m2.1.1.2.2">𝑥</ci></apply><ci id="Sx4.I2.i3.p1.2.m2.1.1.3.cmml" xref="Sx4.I2.i3.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i3.p1.2.m2.1c">\tilde{x}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i3.p1.2.m2.1d">over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> and candidate items from <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="Sx4.I2.i3.p1.3.m3.1"><semantics id="Sx4.I2.i3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="Sx4.I2.i3.p1.3.m3.1.1" xref="Sx4.I2.i3.p1.3.m3.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="Sx4.I2.i3.p1.3.m3.1b"><ci id="Sx4.I2.i3.p1.3.m3.1.1.cmml" xref="Sx4.I2.i3.p1.3.m3.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i3.p1.3.m3.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i3.p1.3.m3.1d">caligraphic_I</annotation></semantics></math>, items with higher similarity values are favored as adversial substitutes. Here, we impose another constraint to enforce item similarity, where adversarial items are required to have a minimum cosine similarity (<math alttext="\tau" class="ltx_Math" display="inline" id="Sx4.I2.i3.p1.4.m4.1"><semantics id="Sx4.I2.i3.p1.4.m4.1a"><mi id="Sx4.I2.i3.p1.4.m4.1.1" xref="Sx4.I2.i3.p1.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="Sx4.I2.i3.p1.4.m4.1b"><ci id="Sx4.I2.i3.p1.4.m4.1.1.cmml" xref="Sx4.I2.i3.p1.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i3.p1.4.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i3.p1.4.m4.1d">italic_τ</annotation></semantics></math>) with the original items. We will select from the top <math alttext="T" class="ltx_Math" display="inline" id="Sx4.I2.i3.p1.5.m5.1"><semantics id="Sx4.I2.i3.p1.5.m5.1a"><mi id="Sx4.I2.i3.p1.5.m5.1.1" xref="Sx4.I2.i3.p1.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx4.I2.i3.p1.5.m5.1b"><ci id="Sx4.I2.i3.p1.5.m5.1.1.cmml" xref="Sx4.I2.i3.p1.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I2.i3.p1.5.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="Sx4.I2.i3.p1.5.m5.1d">italic_T</annotation></semantics></math> items with the highest cosine similarity, and replace the one item that predicts the highest score for the target.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="Sx4.SSx1.SSSx1.p1.4">After that, following previous work <cite class="ltx_cite ltx_citemacro_citep">(Rong, He, and Chen <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib25" title="">2022</a>)</cite>, instead of maximizing <math alttext="\sum_{i\in\tilde{I}}\epsilon_{i}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx1.p1.1.m1.1"><semantics id="Sx4.SSx1.SSSx1.p1.1.m1.1a"><mrow id="Sx4.SSx1.SSSx1.p1.1.m1.1.1" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.cmml"><msub id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.cmml"><mo id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.2" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.2.cmml">∑</mo><mrow id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.cmml"><mi id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.2" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.1" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.1.cmml">∈</mo><mover accent="true" id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.cmml"><mi id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.2" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.2.cmml">I</mi><mo id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.1" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.1.cmml">~</mo></mover></mrow></msub><msub id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.cmml"><mi id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.2" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.2.cmml">ϵ</mi><mi id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.3" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx1.p1.1.m1.1b"><apply id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1"><apply id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1">subscript</csymbol><sum id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.2"></sum><apply id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3"><in id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.1.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.1"></in><ci id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.2.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.2">𝑖</ci><apply id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3"><ci id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.1.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.1">~</ci><ci id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.2.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.1.3.3.2">𝐼</ci></apply></apply></apply><apply id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.1.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2">subscript</csymbol><ci id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.2.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.2">italic-ϵ</ci><ci id="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.3.cmml" xref="Sx4.SSx1.SSSx1.p1.1.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx1.p1.1.m1.1c">\sum_{i\in\tilde{I}}\epsilon_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx1.p1.1.m1.1d">∑ start_POSTSUBSCRIPT italic_i ∈ over~ start_ARG italic_I end_ARG end_POSTSUBSCRIPT italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we can change the goal of our attacks to maximizing <math alttext="\frac{1}{|U|}\sum_{i\in\tilde{I}}\sum_{u\in U}\hat{Y}_{ui}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx1.p1.2.m2.1"><semantics id="Sx4.SSx1.SSSx1.p1.2.m2.1a"><mrow id="Sx4.SSx1.SSSx1.p1.2.m2.1.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.cmml"><mfrac id="Sx4.SSx1.SSSx1.p1.2.m2.1.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.cmml"><mn id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.3" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.3.cmml">1</mn><mrow id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.3" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.2.cmml"><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.1.cmml">U</mi><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.cmml"><msub id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.cmml"><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.2" rspace="0em" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.2.cmml">∑</mo><mrow id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.cmml"><mi id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.2.cmml">i</mi><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.1.cmml">∈</mo><mover accent="true" id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.cmml"><mi id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.2.cmml">I</mi><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.1.cmml">~</mo></mover></mrow></msub><mrow id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.cmml"><msub id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.cmml"><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.2.cmml">∑</mo><mrow id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.cmml"><mi id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.2.cmml">u</mi><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.1.cmml">∈</mo><mi id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.3" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.3.cmml">U</mi></mrow></msub><msub id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.cmml"><mover accent="true" id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.cmml"><mi id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.2.cmml">Y</mi><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.cmml"><mi id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.2" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.2.cmml">u</mi><mo id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.1" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.3" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.3.cmml">i</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx1.p1.2.m2.1b"><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2"><times id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.1"></times><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1"><divide id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1"></divide><cn id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.3.cmml" type="integer" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.3">1</cn><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.3"><abs id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.2.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.3.1"></abs><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.1.1.1">𝑈</ci></apply></apply><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2"><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1">subscript</csymbol><sum id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.2"></sum><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3"><in id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.1"></in><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.2">𝑖</ci><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3"><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.1">~</ci><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.1.3.3.2">𝐼</ci></apply></apply></apply><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2"><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1">subscript</csymbol><sum id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.2"></sum><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3"><in id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.1"></in><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.2">𝑢</ci><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.3.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.1.3.3">𝑈</ci></apply></apply><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2">subscript</csymbol><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2"><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.1">^</ci><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.2.2">𝑌</ci></apply><apply id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3"><times id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.1.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.1"></times><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.2.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.2">𝑢</ci><ci id="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.3.cmml" xref="Sx4.SSx1.SSSx1.p1.2.m2.1.2.2.2.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx1.p1.2.m2.1c">\frac{1}{|U|}\sum_{i\in\tilde{I}}\sum_{u\in U}\hat{Y}_{ui}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx1.p1.2.m2.1d">divide start_ARG 1 end_ARG start_ARG | italic_U | end_ARG ∑ start_POSTSUBSCRIPT italic_i ∈ over~ start_ARG italic_I end_ARG end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_u ∈ italic_U end_POSTSUBSCRIPT over^ start_ARG italic_Y end_ARG start_POSTSUBSCRIPT italic_u italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. <math alttext="\tilde{I}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx1.p1.3.m3.1"><semantics id="Sx4.SSx1.SSSx1.p1.3.m3.1a"><mover accent="true" id="Sx4.SSx1.SSSx1.p1.3.m3.1.1" xref="Sx4.SSx1.SSSx1.p1.3.m3.1.1.cmml"><mi id="Sx4.SSx1.SSSx1.p1.3.m3.1.1.2" xref="Sx4.SSx1.SSSx1.p1.3.m3.1.1.2.cmml">I</mi><mo id="Sx4.SSx1.SSSx1.p1.3.m3.1.1.1" xref="Sx4.SSx1.SSSx1.p1.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx1.p1.3.m3.1b"><apply id="Sx4.SSx1.SSSx1.p1.3.m3.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.3.m3.1.1"><ci id="Sx4.SSx1.SSSx1.p1.3.m3.1.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.3.m3.1.1.1">~</ci><ci id="Sx4.SSx1.SSSx1.p1.3.m3.1.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.3.m3.1.1.2">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx1.p1.3.m3.1c">\tilde{I}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx1.p1.3.m3.1d">over~ start_ARG italic_I end_ARG</annotation></semantics></math> represents target item set. So we follow previous works, use BCE Loss to maxmize target item’s score and get <math alttext="L_{attack}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx1.p1.4.m4.1"><semantics id="Sx4.SSx1.SSSx1.p1.4.m4.1a"><msub id="Sx4.SSx1.SSSx1.p1.4.m4.1.1" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.cmml"><mi id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.2" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.2.cmml">L</mi><mrow id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.cmml"><mi id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.2" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.2.cmml">a</mi><mo id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.3" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.3.cmml">t</mi><mo id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1a" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.4" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.4.cmml">t</mi><mo id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1b" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.5" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.5.cmml">a</mi><mo id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1c" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.6" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.6.cmml">c</mi><mo id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1d" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.7" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.7.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx1.p1.4.m4.1b"><apply id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.1.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1">subscript</csymbol><ci id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.2.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.2">𝐿</ci><apply id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3"><times id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.1"></times><ci id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.2.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.2">𝑎</ci><ci id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.3.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.3">𝑡</ci><ci id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.4.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.4">𝑡</ci><ci id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.5.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.5">𝑎</ci><ci id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.6.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.6">𝑐</ci><ci id="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.7.cmml" xref="Sx4.SSx1.SSSx1.p1.4.m4.1.1.3.7">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx1.p1.4.m4.1c">L_{attack}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx1.p1.4.m4.1d">italic_L start_POSTSUBSCRIPT italic_a italic_t italic_t italic_a italic_c italic_k end_POSTSUBSCRIPT</annotation></semantics></math> (step 3):</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{attack}}=\text{BCE}(f(s^{\prime})[t],y)" class="ltx_Math" display="block" id="Sx4.Ex4.m1.3"><semantics id="Sx4.Ex4.m1.3a"><mrow id="Sx4.Ex4.m1.3.3" xref="Sx4.Ex4.m1.3.3.cmml"><msub id="Sx4.Ex4.m1.3.3.3" xref="Sx4.Ex4.m1.3.3.3.cmml"><mi id="Sx4.Ex4.m1.3.3.3.2" xref="Sx4.Ex4.m1.3.3.3.2.cmml">L</mi><mtext id="Sx4.Ex4.m1.3.3.3.3" xref="Sx4.Ex4.m1.3.3.3.3a.cmml">attack</mtext></msub><mo id="Sx4.Ex4.m1.3.3.2" xref="Sx4.Ex4.m1.3.3.2.cmml">=</mo><mrow id="Sx4.Ex4.m1.3.3.1" xref="Sx4.Ex4.m1.3.3.1.cmml"><mtext id="Sx4.Ex4.m1.3.3.1.3" xref="Sx4.Ex4.m1.3.3.1.3a.cmml">BCE</mtext><mo id="Sx4.Ex4.m1.3.3.1.2" xref="Sx4.Ex4.m1.3.3.1.2.cmml">⁢</mo><mrow id="Sx4.Ex4.m1.3.3.1.1.1" xref="Sx4.Ex4.m1.3.3.1.1.2.cmml"><mo id="Sx4.Ex4.m1.3.3.1.1.1.2" stretchy="false" xref="Sx4.Ex4.m1.3.3.1.1.2.cmml">(</mo><mrow id="Sx4.Ex4.m1.3.3.1.1.1.1" xref="Sx4.Ex4.m1.3.3.1.1.1.1.cmml"><mi id="Sx4.Ex4.m1.3.3.1.1.1.1.3" xref="Sx4.Ex4.m1.3.3.1.1.1.1.3.cmml">f</mi><mo id="Sx4.Ex4.m1.3.3.1.1.1.1.2" xref="Sx4.Ex4.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><msup id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.2" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.3" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.3" stretchy="false" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Sx4.Ex4.m1.3.3.1.1.1.1.2a" xref="Sx4.Ex4.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx4.Ex4.m1.3.3.1.1.1.1.4.2" xref="Sx4.Ex4.m1.3.3.1.1.1.1.4.1.cmml"><mo id="Sx4.Ex4.m1.3.3.1.1.1.1.4.2.1" stretchy="false" xref="Sx4.Ex4.m1.3.3.1.1.1.1.4.1.1.cmml">[</mo><mi id="Sx4.Ex4.m1.1.1" xref="Sx4.Ex4.m1.1.1.cmml">t</mi><mo id="Sx4.Ex4.m1.3.3.1.1.1.1.4.2.2" stretchy="false" xref="Sx4.Ex4.m1.3.3.1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow><mo id="Sx4.Ex4.m1.3.3.1.1.1.3" xref="Sx4.Ex4.m1.3.3.1.1.2.cmml">,</mo><mi id="Sx4.Ex4.m1.2.2" xref="Sx4.Ex4.m1.2.2.cmml">y</mi><mo id="Sx4.Ex4.m1.3.3.1.1.1.4" stretchy="false" xref="Sx4.Ex4.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex4.m1.3b"><apply id="Sx4.Ex4.m1.3.3.cmml" xref="Sx4.Ex4.m1.3.3"><eq id="Sx4.Ex4.m1.3.3.2.cmml" xref="Sx4.Ex4.m1.3.3.2"></eq><apply id="Sx4.Ex4.m1.3.3.3.cmml" xref="Sx4.Ex4.m1.3.3.3"><csymbol cd="ambiguous" id="Sx4.Ex4.m1.3.3.3.1.cmml" xref="Sx4.Ex4.m1.3.3.3">subscript</csymbol><ci id="Sx4.Ex4.m1.3.3.3.2.cmml" xref="Sx4.Ex4.m1.3.3.3.2">𝐿</ci><ci id="Sx4.Ex4.m1.3.3.3.3a.cmml" xref="Sx4.Ex4.m1.3.3.3.3"><mtext id="Sx4.Ex4.m1.3.3.3.3.cmml" mathsize="70%" xref="Sx4.Ex4.m1.3.3.3.3">attack</mtext></ci></apply><apply id="Sx4.Ex4.m1.3.3.1.cmml" xref="Sx4.Ex4.m1.3.3.1"><times id="Sx4.Ex4.m1.3.3.1.2.cmml" xref="Sx4.Ex4.m1.3.3.1.2"></times><ci id="Sx4.Ex4.m1.3.3.1.3a.cmml" xref="Sx4.Ex4.m1.3.3.1.3"><mtext id="Sx4.Ex4.m1.3.3.1.3.cmml" xref="Sx4.Ex4.m1.3.3.1.3">BCE</mtext></ci><interval closure="open" id="Sx4.Ex4.m1.3.3.1.1.2.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1"><apply id="Sx4.Ex4.m1.3.3.1.1.1.1.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1"><times id="Sx4.Ex4.m1.3.3.1.1.1.1.2.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1.2"></times><ci id="Sx4.Ex4.m1.3.3.1.1.1.1.3.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1.3">𝑓</ci><apply id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.2">𝑠</ci><ci id="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1.1.1.1.3">′</ci></apply><apply id="Sx4.Ex4.m1.3.3.1.1.1.1.4.1.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1.4.2"><csymbol cd="latexml" id="Sx4.Ex4.m1.3.3.1.1.1.1.4.1.1.cmml" xref="Sx4.Ex4.m1.3.3.1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="Sx4.Ex4.m1.1.1.cmml" xref="Sx4.Ex4.m1.1.1">𝑡</ci></apply></apply><ci id="Sx4.Ex4.m1.2.2.cmml" xref="Sx4.Ex4.m1.2.2">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex4.m1.3c">L_{\text{attack}}=\text{BCE}(f(s^{\prime})[t],y)</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex4.m1.3d">italic_L start_POSTSUBSCRIPT attack end_POSTSUBSCRIPT = BCE ( italic_f ( italic_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) [ italic_t ] , italic_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.SSx1.SSSx1.p1.6">It is noted that if the target item and test item in history interaction, it does not appear in next item prediction.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> DV-FSR Attack</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l1.1">Input:</span> Sequence <math alttext="{x}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">{x}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_x</annotation></semantics></math>, Target <math alttext="{t}" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_t</annotation></semantics></math>, Recommendation Model <math alttext="f_{s}(i.e.,f_{e},f_{m})" class="ltx_math_unparsed" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1b"><msub id="alg1.l1.m3.1.1"><mi id="alg1.l1.m3.1.1.2">f</mi><mi id="alg1.l1.m3.1.1.3">s</mi></msub><mrow id="alg1.l1.m3.1.2"><mo id="alg1.l1.m3.1.2.1" stretchy="false">(</mo><mi id="alg1.l1.m3.1.2.2">i</mi><mo id="alg1.l1.m3.1.2.3" lspace="0em" rspace="0.167em">.</mo><mi id="alg1.l1.m3.1.2.4">e</mi><mo id="alg1.l1.m3.1.2.5" lspace="0em" rspace="0.167em">.</mo><mo id="alg1.l1.m3.1.2.6">,</mo><msub id="alg1.l1.m3.1.2.7"><mi id="alg1.l1.m3.1.2.7.2">f</mi><mi id="alg1.l1.m3.1.2.7.3">e</mi></msub><mo id="alg1.l1.m3.1.2.8">,</mo><msub id="alg1.l1.m3.1.2.9"><mi id="alg1.l1.m3.1.2.9.2">f</mi><mi id="alg1.l1.m3.1.2.9.3">m</mi></msub><mo id="alg1.l1.m3.1.2.10" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">f_{s}(i.e.,f_{e},f_{m})</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_i . italic_e . , italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l2.1">Output:</span> malicious gradients <math alttext="\hat{g}_{embedding},\hat{g}_{model}" class="ltx_Math" display="inline" id="alg1.l2.m1.2"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.3.cmml"><msub id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml"><mover accent="true" id="alg1.l2.m1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.1.1.2.2" xref="alg1.l2.m1.1.1.1.1.2.2.cmml">g</mi><mo id="alg1.l2.m1.1.1.1.1.2.1" xref="alg1.l2.m1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="alg1.l2.m1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.1.1.3.2" xref="alg1.l2.m1.1.1.1.1.3.2.cmml">e</mi><mo id="alg1.l2.m1.1.1.1.1.3.1" xref="alg1.l2.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.3.3" xref="alg1.l2.m1.1.1.1.1.3.3.cmml">m</mi><mo id="alg1.l2.m1.1.1.1.1.3.1a" xref="alg1.l2.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.3.4" xref="alg1.l2.m1.1.1.1.1.3.4.cmml">b</mi><mo id="alg1.l2.m1.1.1.1.1.3.1b" xref="alg1.l2.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.3.5" xref="alg1.l2.m1.1.1.1.1.3.5.cmml">e</mi><mo id="alg1.l2.m1.1.1.1.1.3.1c" xref="alg1.l2.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.3.6" xref="alg1.l2.m1.1.1.1.1.3.6.cmml">d</mi><mo id="alg1.l2.m1.1.1.1.1.3.1d" xref="alg1.l2.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.3.7" xref="alg1.l2.m1.1.1.1.1.3.7.cmml">d</mi><mo id="alg1.l2.m1.1.1.1.1.3.1e" xref="alg1.l2.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.3.8" xref="alg1.l2.m1.1.1.1.1.3.8.cmml">i</mi><mo id="alg1.l2.m1.1.1.1.1.3.1f" xref="alg1.l2.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.3.9" xref="alg1.l2.m1.1.1.1.1.3.9.cmml">n</mi><mo id="alg1.l2.m1.1.1.1.1.3.1g" xref="alg1.l2.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.3.10" xref="alg1.l2.m1.1.1.1.1.3.10.cmml">g</mi></mrow></msub><mo id="alg1.l2.m1.2.2.2.3" xref="alg1.l2.m1.2.2.3.cmml">,</mo><msub id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.cmml"><mover accent="true" id="alg1.l2.m1.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.cmml"><mi id="alg1.l2.m1.2.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.2.cmml">g</mi><mo id="alg1.l2.m1.2.2.2.2.2.1" xref="alg1.l2.m1.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l2.m1.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.2.3.cmml"><mi id="alg1.l2.m1.2.2.2.2.3.2" xref="alg1.l2.m1.2.2.2.2.3.2.cmml">m</mi><mo id="alg1.l2.m1.2.2.2.2.3.1" xref="alg1.l2.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.2.2.2.2.3.3" xref="alg1.l2.m1.2.2.2.2.3.3.cmml">o</mi><mo id="alg1.l2.m1.2.2.2.2.3.1a" xref="alg1.l2.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.2.2.2.2.3.4" xref="alg1.l2.m1.2.2.2.2.3.4.cmml">d</mi><mo id="alg1.l2.m1.2.2.2.2.3.1b" xref="alg1.l2.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.2.2.2.2.3.5" xref="alg1.l2.m1.2.2.2.2.3.5.cmml">e</mi><mo id="alg1.l2.m1.2.2.2.2.3.1c" xref="alg1.l2.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.2.2.2.2.3.6" xref="alg1.l2.m1.2.2.2.2.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><list id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.2"><apply id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l2.m1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.2"><ci id="alg1.l2.m1.1.1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.1.1.2.1">^</ci><ci id="alg1.l2.m1.1.1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.1.1.2.2">𝑔</ci></apply><apply id="alg1.l2.m1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.3"><times id="alg1.l2.m1.1.1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.1.1.3.1"></times><ci id="alg1.l2.m1.1.1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.1.1.3.2">𝑒</ci><ci id="alg1.l2.m1.1.1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.1.1.3.3">𝑚</ci><ci id="alg1.l2.m1.1.1.1.1.3.4.cmml" xref="alg1.l2.m1.1.1.1.1.3.4">𝑏</ci><ci id="alg1.l2.m1.1.1.1.1.3.5.cmml" xref="alg1.l2.m1.1.1.1.1.3.5">𝑒</ci><ci id="alg1.l2.m1.1.1.1.1.3.6.cmml" xref="alg1.l2.m1.1.1.1.1.3.6">𝑑</ci><ci id="alg1.l2.m1.1.1.1.1.3.7.cmml" xref="alg1.l2.m1.1.1.1.1.3.7">𝑑</ci><ci id="alg1.l2.m1.1.1.1.1.3.8.cmml" xref="alg1.l2.m1.1.1.1.1.3.8">𝑖</ci><ci id="alg1.l2.m1.1.1.1.1.3.9.cmml" xref="alg1.l2.m1.1.1.1.1.3.9">𝑛</ci><ci id="alg1.l2.m1.1.1.1.1.3.10.cmml" xref="alg1.l2.m1.1.1.1.1.3.10">𝑔</ci></apply></apply><apply id="alg1.l2.m1.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2">subscript</csymbol><apply id="alg1.l2.m1.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2"><ci id="alg1.l2.m1.2.2.2.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.1">^</ci><ci id="alg1.l2.m1.2.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2">𝑔</ci></apply><apply id="alg1.l2.m1.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.3"><times id="alg1.l2.m1.2.2.2.2.3.1.cmml" xref="alg1.l2.m1.2.2.2.2.3.1"></times><ci id="alg1.l2.m1.2.2.2.2.3.2.cmml" xref="alg1.l2.m1.2.2.2.2.3.2">𝑚</ci><ci id="alg1.l2.m1.2.2.2.2.3.3.cmml" xref="alg1.l2.m1.2.2.2.2.3.3">𝑜</ci><ci id="alg1.l2.m1.2.2.2.2.3.4.cmml" xref="alg1.l2.m1.2.2.2.2.3.4">𝑑</ci><ci id="alg1.l2.m1.2.2.2.2.3.5.cmml" xref="alg1.l2.m1.2.2.2.2.3.5">𝑒</ci><ci id="alg1.l2.m1.2.2.2.2.3.6.cmml" xref="alg1.l2.m1.2.2.2.2.3.6">𝑙</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">\hat{g}_{embedding},\hat{g}_{model}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.2d">over^ start_ARG italic_g end_ARG start_POSTSUBSCRIPT italic_e italic_m italic_b italic_e italic_d italic_d italic_i italic_n italic_g end_POSTSUBSCRIPT , over^ start_ARG italic_g end_ARG start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math>
// Step 1: distribute model

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>  Initialize  client model <math alttext="f_{i}(f_{e},f_{m})\leftarrow" class="ltx_Math" display="inline" id="alg1.l3.m1.2"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml"><mrow id="alg1.l3.m1.2.2.2" xref="alg1.l3.m1.2.2.2.cmml"><msub id="alg1.l3.m1.2.2.2.4" xref="alg1.l3.m1.2.2.2.4.cmml"><mi id="alg1.l3.m1.2.2.2.4.2" xref="alg1.l3.m1.2.2.2.4.2.cmml">f</mi><mi id="alg1.l3.m1.2.2.2.4.3" xref="alg1.l3.m1.2.2.2.4.3.cmml">i</mi></msub><mo id="alg1.l3.m1.2.2.2.3" xref="alg1.l3.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l3.m1.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.3.cmml"><mo id="alg1.l3.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l3.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l3.m1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.1.2.cmml">f</mi><mi id="alg1.l3.m1.1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="alg1.l3.m1.2.2.2.2.2.4" xref="alg1.l3.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l3.m1.2.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l3.m1.2.2.2.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.2.2.2.cmml">f</mi><mi id="alg1.l3.m1.2.2.2.2.2.2.3" xref="alg1.l3.m1.2.2.2.2.2.2.3.cmml">m</mi></msub><mo id="alg1.l3.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l3.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l3.m1.2.2.3" stretchy="false" xref="alg1.l3.m1.2.2.3.cmml">←</mo><mi id="alg1.l3.m1.2.2.4" xref="alg1.l3.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2"><ci id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2.3">←</ci><apply id="alg1.l3.m1.2.2.2.cmml" xref="alg1.l3.m1.2.2.2"><times id="alg1.l3.m1.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.3"></times><apply id="alg1.l3.m1.2.2.2.4.cmml" xref="alg1.l3.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.4.1.cmml" xref="alg1.l3.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.4.2.cmml" xref="alg1.l3.m1.2.2.2.4.2">𝑓</ci><ci id="alg1.l3.m1.2.2.2.4.3.cmml" xref="alg1.l3.m1.2.2.2.4.3">𝑖</ci></apply><interval closure="open" id="alg1.l3.m1.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2"><apply id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.2">𝑓</ci><ci id="alg1.l3.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.3">𝑒</ci></apply><apply id="alg1.l3.m1.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.2">𝑓</ci><ci id="alg1.l3.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.2.2.2.3">𝑚</ci></apply></interval></apply><csymbol cd="latexml" id="alg1.l3.m1.2.2.4.cmml" xref="alg1.l3.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">f_{i}(f_{e},f_{m})\leftarrow</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.2d">italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) ←</annotation></semantics></math><math alttext="f_{s}(f_{e},f_{m})" class="ltx_Math" display="inline" id="alg1.l3.m2.2"><semantics id="alg1.l3.m2.2a"><mrow id="alg1.l3.m2.2.2" xref="alg1.l3.m2.2.2.cmml"><msub id="alg1.l3.m2.2.2.4" xref="alg1.l3.m2.2.2.4.cmml"><mi id="alg1.l3.m2.2.2.4.2" xref="alg1.l3.m2.2.2.4.2.cmml">f</mi><mi id="alg1.l3.m2.2.2.4.3" xref="alg1.l3.m2.2.2.4.3.cmml">s</mi></msub><mo id="alg1.l3.m2.2.2.3" xref="alg1.l3.m2.2.2.3.cmml">⁢</mo><mrow id="alg1.l3.m2.2.2.2.2" xref="alg1.l3.m2.2.2.2.3.cmml"><mo id="alg1.l3.m2.2.2.2.2.3" stretchy="false" xref="alg1.l3.m2.2.2.2.3.cmml">(</mo><msub id="alg1.l3.m2.1.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.1.cmml"><mi id="alg1.l3.m2.1.1.1.1.1.2" xref="alg1.l3.m2.1.1.1.1.1.2.cmml">f</mi><mi id="alg1.l3.m2.1.1.1.1.1.3" xref="alg1.l3.m2.1.1.1.1.1.3.cmml">e</mi></msub><mo id="alg1.l3.m2.2.2.2.2.4" xref="alg1.l3.m2.2.2.2.3.cmml">,</mo><msub id="alg1.l3.m2.2.2.2.2.2" xref="alg1.l3.m2.2.2.2.2.2.cmml"><mi id="alg1.l3.m2.2.2.2.2.2.2" xref="alg1.l3.m2.2.2.2.2.2.2.cmml">f</mi><mi id="alg1.l3.m2.2.2.2.2.2.3" xref="alg1.l3.m2.2.2.2.2.2.3.cmml">m</mi></msub><mo id="alg1.l3.m2.2.2.2.2.5" stretchy="false" xref="alg1.l3.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.2b"><apply id="alg1.l3.m2.2.2.cmml" xref="alg1.l3.m2.2.2"><times id="alg1.l3.m2.2.2.3.cmml" xref="alg1.l3.m2.2.2.3"></times><apply id="alg1.l3.m2.2.2.4.cmml" xref="alg1.l3.m2.2.2.4"><csymbol cd="ambiguous" id="alg1.l3.m2.2.2.4.1.cmml" xref="alg1.l3.m2.2.2.4">subscript</csymbol><ci id="alg1.l3.m2.2.2.4.2.cmml" xref="alg1.l3.m2.2.2.4.2">𝑓</ci><ci id="alg1.l3.m2.2.2.4.3.cmml" xref="alg1.l3.m2.2.2.4.3">𝑠</ci></apply><interval closure="open" id="alg1.l3.m2.2.2.2.3.cmml" xref="alg1.l3.m2.2.2.2.2"><apply id="alg1.l3.m2.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.1.1.1.2.cmml" xref="alg1.l3.m2.1.1.1.1.1.2">𝑓</ci><ci id="alg1.l3.m2.1.1.1.1.1.3.cmml" xref="alg1.l3.m2.1.1.1.1.1.3">𝑒</ci></apply><apply id="alg1.l3.m2.2.2.2.2.2.cmml" xref="alg1.l3.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l3.m2.2.2.2.2.2.1.cmml" xref="alg1.l3.m2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l3.m2.2.2.2.2.2.2.cmml" xref="alg1.l3.m2.2.2.2.2.2.2">𝑓</ci><ci id="alg1.l3.m2.2.2.2.2.2.3.cmml" xref="alg1.l3.m2.2.2.2.2.2.3">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.2c">f_{s}(f_{e},f_{m})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.2d">italic_f start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>
// Step 2: run Substitution Algorithm

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>  Compute Substituted Sequence in Algorithm 2      <math alttext="x^{\prime}\leftarrow substitution(f_{i}(f_{e},f_{m}),x,t)" class="ltx_Math" display="inline" id="alg1.l4.m1.3"><semantics id="alg1.l4.m1.3a"><mrow id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml"><msup id="alg1.l4.m1.3.3.3" xref="alg1.l4.m1.3.3.3.cmml"><mi id="alg1.l4.m1.3.3.3.2" xref="alg1.l4.m1.3.3.3.2.cmml">x</mi><mo id="alg1.l4.m1.3.3.3.3" xref="alg1.l4.m1.3.3.3.3.cmml">′</mo></msup><mo id="alg1.l4.m1.3.3.2" stretchy="false" xref="alg1.l4.m1.3.3.2.cmml">←</mo><mrow id="alg1.l4.m1.3.3.1" xref="alg1.l4.m1.3.3.1.cmml"><mi id="alg1.l4.m1.3.3.1.3" xref="alg1.l4.m1.3.3.1.3.cmml">s</mi><mo id="alg1.l4.m1.3.3.1.2" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.4" xref="alg1.l4.m1.3.3.1.4.cmml">u</mi><mo id="alg1.l4.m1.3.3.1.2a" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.5" xref="alg1.l4.m1.3.3.1.5.cmml">b</mi><mo id="alg1.l4.m1.3.3.1.2b" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.6" xref="alg1.l4.m1.3.3.1.6.cmml">s</mi><mo id="alg1.l4.m1.3.3.1.2c" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.7" xref="alg1.l4.m1.3.3.1.7.cmml">t</mi><mo id="alg1.l4.m1.3.3.1.2d" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.8" xref="alg1.l4.m1.3.3.1.8.cmml">i</mi><mo id="alg1.l4.m1.3.3.1.2e" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.9" xref="alg1.l4.m1.3.3.1.9.cmml">t</mi><mo id="alg1.l4.m1.3.3.1.2f" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.10" xref="alg1.l4.m1.3.3.1.10.cmml">u</mi><mo id="alg1.l4.m1.3.3.1.2g" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.11" xref="alg1.l4.m1.3.3.1.11.cmml">t</mi><mo id="alg1.l4.m1.3.3.1.2h" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.12" xref="alg1.l4.m1.3.3.1.12.cmml">i</mi><mo id="alg1.l4.m1.3.3.1.2i" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.13" xref="alg1.l4.m1.3.3.1.13.cmml">o</mi><mo id="alg1.l4.m1.3.3.1.2j" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mi id="alg1.l4.m1.3.3.1.14" xref="alg1.l4.m1.3.3.1.14.cmml">n</mi><mo id="alg1.l4.m1.3.3.1.2k" xref="alg1.l4.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.3.3.1.1.1" xref="alg1.l4.m1.3.3.1.1.2.cmml"><mo id="alg1.l4.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l4.m1.3.3.1.1.2.cmml">(</mo><mrow id="alg1.l4.m1.3.3.1.1.1.1" xref="alg1.l4.m1.3.3.1.1.1.1.cmml"><msub id="alg1.l4.m1.3.3.1.1.1.1.4" xref="alg1.l4.m1.3.3.1.1.1.1.4.cmml"><mi id="alg1.l4.m1.3.3.1.1.1.1.4.2" xref="alg1.l4.m1.3.3.1.1.1.1.4.2.cmml">f</mi><mi id="alg1.l4.m1.3.3.1.1.1.1.4.3" xref="alg1.l4.m1.3.3.1.1.1.1.4.3.cmml">i</mi></msub><mo id="alg1.l4.m1.3.3.1.1.1.1.3" xref="alg1.l4.m1.3.3.1.1.1.1.3.cmml">⁢</mo><mrow id="alg1.l4.m1.3.3.1.1.1.1.2.2" xref="alg1.l4.m1.3.3.1.1.1.1.2.3.cmml"><mo id="alg1.l4.m1.3.3.1.1.1.1.2.2.3" stretchy="false" xref="alg1.l4.m1.3.3.1.1.1.1.2.3.cmml">(</mo><msub id="alg1.l4.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l4.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l4.m1.3.3.1.1.1.1.1.1.1.2.cmml">f</mi><mi id="alg1.l4.m1.3.3.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.3.3.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="alg1.l4.m1.3.3.1.1.1.1.2.2.4" xref="alg1.l4.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l4.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l4.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="alg1.l4.m1.3.3.1.1.1.1.2.2.2.2" xref="alg1.l4.m1.3.3.1.1.1.1.2.2.2.2.cmml">f</mi><mi id="alg1.l4.m1.3.3.1.1.1.1.2.2.2.3" xref="alg1.l4.m1.3.3.1.1.1.1.2.2.2.3.cmml">m</mi></msub><mo id="alg1.l4.m1.3.3.1.1.1.1.2.2.5" stretchy="false" xref="alg1.l4.m1.3.3.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l4.m1.3.3.1.1.1.3" xref="alg1.l4.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">x</mi><mo id="alg1.l4.m1.3.3.1.1.1.4" xref="alg1.l4.m1.3.3.1.1.2.cmml">,</mo><mi id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">t</mi><mo id="alg1.l4.m1.3.3.1.1.1.5" stretchy="false" xref="alg1.l4.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.3b"><apply id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3"><ci id="alg1.l4.m1.3.3.2.cmml" xref="alg1.l4.m1.3.3.2">←</ci><apply id="alg1.l4.m1.3.3.3.cmml" xref="alg1.l4.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.3.1.cmml" xref="alg1.l4.m1.3.3.3">superscript</csymbol><ci id="alg1.l4.m1.3.3.3.2.cmml" xref="alg1.l4.m1.3.3.3.2">𝑥</ci><ci id="alg1.l4.m1.3.3.3.3.cmml" xref="alg1.l4.m1.3.3.3.3">′</ci></apply><apply id="alg1.l4.m1.3.3.1.cmml" xref="alg1.l4.m1.3.3.1"><times id="alg1.l4.m1.3.3.1.2.cmml" xref="alg1.l4.m1.3.3.1.2"></times><ci id="alg1.l4.m1.3.3.1.3.cmml" xref="alg1.l4.m1.3.3.1.3">𝑠</ci><ci id="alg1.l4.m1.3.3.1.4.cmml" xref="alg1.l4.m1.3.3.1.4">𝑢</ci><ci id="alg1.l4.m1.3.3.1.5.cmml" xref="alg1.l4.m1.3.3.1.5">𝑏</ci><ci id="alg1.l4.m1.3.3.1.6.cmml" xref="alg1.l4.m1.3.3.1.6">𝑠</ci><ci id="alg1.l4.m1.3.3.1.7.cmml" xref="alg1.l4.m1.3.3.1.7">𝑡</ci><ci id="alg1.l4.m1.3.3.1.8.cmml" xref="alg1.l4.m1.3.3.1.8">𝑖</ci><ci id="alg1.l4.m1.3.3.1.9.cmml" xref="alg1.l4.m1.3.3.1.9">𝑡</ci><ci id="alg1.l4.m1.3.3.1.10.cmml" xref="alg1.l4.m1.3.3.1.10">𝑢</ci><ci id="alg1.l4.m1.3.3.1.11.cmml" xref="alg1.l4.m1.3.3.1.11">𝑡</ci><ci id="alg1.l4.m1.3.3.1.12.cmml" xref="alg1.l4.m1.3.3.1.12">𝑖</ci><ci id="alg1.l4.m1.3.3.1.13.cmml" xref="alg1.l4.m1.3.3.1.13">𝑜</ci><ci id="alg1.l4.m1.3.3.1.14.cmml" xref="alg1.l4.m1.3.3.1.14">𝑛</ci><vector id="alg1.l4.m1.3.3.1.1.2.cmml" xref="alg1.l4.m1.3.3.1.1.1"><apply id="alg1.l4.m1.3.3.1.1.1.1.cmml" xref="alg1.l4.m1.3.3.1.1.1.1"><times id="alg1.l4.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.3"></times><apply id="alg1.l4.m1.3.3.1.1.1.1.4.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.1.1.1.1.4.1.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="alg1.l4.m1.3.3.1.1.1.1.4.2.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.4.2">𝑓</ci><ci id="alg1.l4.m1.3.3.1.1.1.1.4.3.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.4.3">𝑖</ci></apply><interval closure="open" id="alg1.l4.m1.3.3.1.1.1.1.2.3.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.2.2"><apply id="alg1.l4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.1.1.1.2">𝑓</ci><ci id="alg1.l4.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.1.1.1.3">𝑒</ci></apply><apply id="alg1.l4.m1.3.3.1.1.1.1.2.2.2.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.2.2.2.2">𝑓</ci><ci id="alg1.l4.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.2.2.2.3">𝑚</ci></apply></interval></apply><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑥</ci><ci id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">𝑡</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.3c">x^{\prime}\leftarrow substitution(f_{i}(f_{e},f_{m}),x,t)</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.3d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_s italic_u italic_b italic_s italic_t italic_i italic_t italic_u italic_t italic_i italic_o italic_n ( italic_f start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) , italic_x , italic_t )</annotation></semantics></math>
// Step 3: compute attack loss

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>  Compute <math alttext="L_{\text{attack}}\leftarrow\text{BCE}(f(\text{s'})[\text{t}],y)" class="ltx_Math" display="inline" id="alg1.l5.m1.4"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml"><msub id="alg1.l5.m1.4.4.3" xref="alg1.l5.m1.4.4.3.cmml"><mi id="alg1.l5.m1.4.4.3.2" xref="alg1.l5.m1.4.4.3.2.cmml">L</mi><mtext id="alg1.l5.m1.4.4.3.3" xref="alg1.l5.m1.4.4.3.3a.cmml">attack</mtext></msub><mo id="alg1.l5.m1.4.4.2" stretchy="false" xref="alg1.l5.m1.4.4.2.cmml">←</mo><mrow id="alg1.l5.m1.4.4.1" xref="alg1.l5.m1.4.4.1.cmml"><mtext id="alg1.l5.m1.4.4.1.3" xref="alg1.l5.m1.4.4.1.3a.cmml">BCE</mtext><mo id="alg1.l5.m1.4.4.1.2" xref="alg1.l5.m1.4.4.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.4.4.1.1.1" xref="alg1.l5.m1.4.4.1.1.2.cmml"><mo id="alg1.l5.m1.4.4.1.1.1.2" stretchy="false" xref="alg1.l5.m1.4.4.1.1.2.cmml">(</mo><mrow id="alg1.l5.m1.4.4.1.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.cmml"><mi id="alg1.l5.m1.4.4.1.1.1.1.2" xref="alg1.l5.m1.4.4.1.1.1.1.2.cmml">f</mi><mo id="alg1.l5.m1.4.4.1.1.1.1.1" xref="alg1.l5.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l5.m1.4.4.1.1.1.1.3.2" xref="alg1.l5.m1.1.1a.cmml"><mo id="alg1.l5.m1.4.4.1.1.1.1.3.2.1" stretchy="false" xref="alg1.l5.m1.1.1a.cmml">(</mo><mtext id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">s’</mtext><mo id="alg1.l5.m1.4.4.1.1.1.1.3.2.2" stretchy="false" xref="alg1.l5.m1.1.1a.cmml">)</mo></mrow><mo id="alg1.l5.m1.4.4.1.1.1.1.1a" xref="alg1.l5.m1.4.4.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l5.m1.4.4.1.1.1.1.4.2" xref="alg1.l5.m1.4.4.1.1.1.1.4.1.cmml"><mo id="alg1.l5.m1.4.4.1.1.1.1.4.2.1" stretchy="false" xref="alg1.l5.m1.4.4.1.1.1.1.4.1.1.cmml">[</mo><mtext id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2a.cmml">t</mtext><mo id="alg1.l5.m1.4.4.1.1.1.1.4.2.2" stretchy="false" xref="alg1.l5.m1.4.4.1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow><mo id="alg1.l5.m1.4.4.1.1.1.3" xref="alg1.l5.m1.4.4.1.1.2.cmml">,</mo><mi id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">y</mi><mo id="alg1.l5.m1.4.4.1.1.1.4" stretchy="false" xref="alg1.l5.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4"><ci id="alg1.l5.m1.4.4.2.cmml" xref="alg1.l5.m1.4.4.2">←</ci><apply id="alg1.l5.m1.4.4.3.cmml" xref="alg1.l5.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l5.m1.4.4.3.1.cmml" xref="alg1.l5.m1.4.4.3">subscript</csymbol><ci id="alg1.l5.m1.4.4.3.2.cmml" xref="alg1.l5.m1.4.4.3.2">𝐿</ci><ci id="alg1.l5.m1.4.4.3.3a.cmml" xref="alg1.l5.m1.4.4.3.3"><mtext id="alg1.l5.m1.4.4.3.3.cmml" mathsize="70%" xref="alg1.l5.m1.4.4.3.3">attack</mtext></ci></apply><apply id="alg1.l5.m1.4.4.1.cmml" xref="alg1.l5.m1.4.4.1"><times id="alg1.l5.m1.4.4.1.2.cmml" xref="alg1.l5.m1.4.4.1.2"></times><ci id="alg1.l5.m1.4.4.1.3a.cmml" xref="alg1.l5.m1.4.4.1.3"><mtext id="alg1.l5.m1.4.4.1.3.cmml" xref="alg1.l5.m1.4.4.1.3">BCE</mtext></ci><interval closure="open" id="alg1.l5.m1.4.4.1.1.2.cmml" xref="alg1.l5.m1.4.4.1.1.1"><apply id="alg1.l5.m1.4.4.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1"><times id="alg1.l5.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.1"></times><ci id="alg1.l5.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.2">𝑓</ci><ci id="alg1.l5.m1.1.1a.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.3.2"><mtext id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">s’</mtext></ci><apply id="alg1.l5.m1.4.4.1.1.1.1.4.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.4.2"><csymbol cd="latexml" id="alg1.l5.m1.4.4.1.1.1.1.4.1.1.cmml" xref="alg1.l5.m1.4.4.1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="alg1.l5.m1.2.2a.cmml" xref="alg1.l5.m1.2.2"><mtext id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">t</mtext></ci></apply></apply><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">L_{\text{attack}}\leftarrow\text{BCE}(f(\text{s'})[\text{t}],y)</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.4d">italic_L start_POSTSUBSCRIPT attack end_POSTSUBSCRIPT ← BCE ( italic_f ( s’ ) [ t ] , italic_y )</annotation></semantics></math>
// Step 4: compute contrastive loss

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>  Randomly sample n non-interacted item i. Compute negative vector <math alttext="\mathbf{n_{i}}\leftarrow f_{e}(i)" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><msub id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml"><mi id="alg1.l6.m1.1.2.2.2" xref="alg1.l6.m1.1.2.2.2.cmml">𝐧</mi><mi id="alg1.l6.m1.1.2.2.3" xref="alg1.l6.m1.1.2.2.3.cmml">𝐢</mi></msub><mo id="alg1.l6.m1.1.2.1" stretchy="false" xref="alg1.l6.m1.1.2.1.cmml">←</mo><mrow id="alg1.l6.m1.1.2.3" xref="alg1.l6.m1.1.2.3.cmml"><msub id="alg1.l6.m1.1.2.3.2" xref="alg1.l6.m1.1.2.3.2.cmml"><mi id="alg1.l6.m1.1.2.3.2.2" xref="alg1.l6.m1.1.2.3.2.2.cmml">f</mi><mi id="alg1.l6.m1.1.2.3.2.3" xref="alg1.l6.m1.1.2.3.2.3.cmml">e</mi></msub><mo id="alg1.l6.m1.1.2.3.1" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l6.m1.1.2.3.3.2" xref="alg1.l6.m1.1.2.3.cmml"><mo id="alg1.l6.m1.1.2.3.3.2.1" stretchy="false" xref="alg1.l6.m1.1.2.3.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">i</mi><mo id="alg1.l6.m1.1.2.3.3.2.2" stretchy="false" xref="alg1.l6.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><ci id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2.1">←</ci><apply id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.2.2.1.cmml" xref="alg1.l6.m1.1.2.2">subscript</csymbol><ci id="alg1.l6.m1.1.2.2.2.cmml" xref="alg1.l6.m1.1.2.2.2">𝐧</ci><ci id="alg1.l6.m1.1.2.2.3.cmml" xref="alg1.l6.m1.1.2.2.3">𝐢</ci></apply><apply id="alg1.l6.m1.1.2.3.cmml" xref="alg1.l6.m1.1.2.3"><times id="alg1.l6.m1.1.2.3.1.cmml" xref="alg1.l6.m1.1.2.3.1"></times><apply id="alg1.l6.m1.1.2.3.2.cmml" xref="alg1.l6.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.2.3.2.1.cmml" xref="alg1.l6.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l6.m1.1.2.3.2.2.cmml" xref="alg1.l6.m1.1.2.3.2.2">𝑓</ci><ci id="alg1.l6.m1.1.2.3.2.3.cmml" xref="alg1.l6.m1.1.2.3.2.3">𝑒</ci></apply><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathbf{n_{i}}\leftarrow f_{e}(i)</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">bold_n start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT ← italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_i )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>  Compute positive vector and anchor <math alttext="\mathbf{p}\leftarrow mean(f_{e}(x))" class="ltx_Math" display="inline" id="alg1.l7.m1.2"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><mi id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml">𝐩</mi><mo id="alg1.l7.m1.2.2.2" stretchy="false" xref="alg1.l7.m1.2.2.2.cmml">←</mo><mrow id="alg1.l7.m1.2.2.1" xref="alg1.l7.m1.2.2.1.cmml"><mi id="alg1.l7.m1.2.2.1.3" xref="alg1.l7.m1.2.2.1.3.cmml">m</mi><mo id="alg1.l7.m1.2.2.1.2" xref="alg1.l7.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.1.4" xref="alg1.l7.m1.2.2.1.4.cmml">e</mi><mo id="alg1.l7.m1.2.2.1.2a" xref="alg1.l7.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.1.5" xref="alg1.l7.m1.2.2.1.5.cmml">a</mi><mo id="alg1.l7.m1.2.2.1.2b" xref="alg1.l7.m1.2.2.1.2.cmml">⁢</mo><mi id="alg1.l7.m1.2.2.1.6" xref="alg1.l7.m1.2.2.1.6.cmml">n</mi><mo id="alg1.l7.m1.2.2.1.2c" xref="alg1.l7.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l7.m1.2.2.1.1.1" xref="alg1.l7.m1.2.2.1.1.1.1.cmml"><mo id="alg1.l7.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l7.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.2.2.1.1.1.1" xref="alg1.l7.m1.2.2.1.1.1.1.cmml"><msub id="alg1.l7.m1.2.2.1.1.1.1.2" xref="alg1.l7.m1.2.2.1.1.1.1.2.cmml"><mi id="alg1.l7.m1.2.2.1.1.1.1.2.2" xref="alg1.l7.m1.2.2.1.1.1.1.2.2.cmml">f</mi><mi id="alg1.l7.m1.2.2.1.1.1.1.2.3" xref="alg1.l7.m1.2.2.1.1.1.1.2.3.cmml">e</mi></msub><mo id="alg1.l7.m1.2.2.1.1.1.1.1" xref="alg1.l7.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="alg1.l7.m1.2.2.1.1.1.1.3.2" xref="alg1.l7.m1.2.2.1.1.1.1.cmml"><mo id="alg1.l7.m1.2.2.1.1.1.1.3.2.1" stretchy="false" xref="alg1.l7.m1.2.2.1.1.1.1.cmml">(</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">x</mi><mo id="alg1.l7.m1.2.2.1.1.1.1.3.2.2" stretchy="false" xref="alg1.l7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.2.2.1.1.1.3" stretchy="false" xref="alg1.l7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.2.cmml" xref="alg1.l7.m1.2.2.2">←</ci><ci id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3">𝐩</ci><apply id="alg1.l7.m1.2.2.1.cmml" xref="alg1.l7.m1.2.2.1"><times id="alg1.l7.m1.2.2.1.2.cmml" xref="alg1.l7.m1.2.2.1.2"></times><ci id="alg1.l7.m1.2.2.1.3.cmml" xref="alg1.l7.m1.2.2.1.3">𝑚</ci><ci id="alg1.l7.m1.2.2.1.4.cmml" xref="alg1.l7.m1.2.2.1.4">𝑒</ci><ci id="alg1.l7.m1.2.2.1.5.cmml" xref="alg1.l7.m1.2.2.1.5">𝑎</ci><ci id="alg1.l7.m1.2.2.1.6.cmml" xref="alg1.l7.m1.2.2.1.6">𝑛</ci><apply id="alg1.l7.m1.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1"><times id="alg1.l7.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.1"></times><apply id="alg1.l7.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.2.2">𝑓</ci><ci id="alg1.l7.m1.2.2.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.2.3">𝑒</ci></apply><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">\mathbf{p}\leftarrow mean(f_{e}(x))</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.2d">bold_p ← italic_m italic_e italic_a italic_n ( italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_x ) )</annotation></semantics></math>  
<math alttext="\mathbf{a}\leftarrow f_{e}(t)" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><mrow id="alg1.l7.m2.1.2" xref="alg1.l7.m2.1.2.cmml"><mi id="alg1.l7.m2.1.2.2" xref="alg1.l7.m2.1.2.2.cmml">𝐚</mi><mo id="alg1.l7.m2.1.2.1" stretchy="false" xref="alg1.l7.m2.1.2.1.cmml">←</mo><mrow id="alg1.l7.m2.1.2.3" xref="alg1.l7.m2.1.2.3.cmml"><msub id="alg1.l7.m2.1.2.3.2" xref="alg1.l7.m2.1.2.3.2.cmml"><mi id="alg1.l7.m2.1.2.3.2.2" xref="alg1.l7.m2.1.2.3.2.2.cmml">f</mi><mi id="alg1.l7.m2.1.2.3.2.3" xref="alg1.l7.m2.1.2.3.2.3.cmml">e</mi></msub><mo id="alg1.l7.m2.1.2.3.1" xref="alg1.l7.m2.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l7.m2.1.2.3.3.2" xref="alg1.l7.m2.1.2.3.cmml"><mo id="alg1.l7.m2.1.2.3.3.2.1" stretchy="false" xref="alg1.l7.m2.1.2.3.cmml">(</mo><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">t</mi><mo id="alg1.l7.m2.1.2.3.3.2.2" stretchy="false" xref="alg1.l7.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.2.cmml" xref="alg1.l7.m2.1.2"><ci id="alg1.l7.m2.1.2.1.cmml" xref="alg1.l7.m2.1.2.1">←</ci><ci id="alg1.l7.m2.1.2.2.cmml" xref="alg1.l7.m2.1.2.2">𝐚</ci><apply id="alg1.l7.m2.1.2.3.cmml" xref="alg1.l7.m2.1.2.3"><times id="alg1.l7.m2.1.2.3.1.cmml" xref="alg1.l7.m2.1.2.3.1"></times><apply id="alg1.l7.m2.1.2.3.2.cmml" xref="alg1.l7.m2.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l7.m2.1.2.3.2.1.cmml" xref="alg1.l7.m2.1.2.3.2">subscript</csymbol><ci id="alg1.l7.m2.1.2.3.2.2.cmml" xref="alg1.l7.m2.1.2.3.2.2">𝑓</ci><ci id="alg1.l7.m2.1.2.3.2.3.cmml" xref="alg1.l7.m2.1.2.3.2.3">𝑒</ci></apply><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">\mathbf{a}\leftarrow f_{e}(t)</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">bold_a ← italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>  Compute <math alttext="L_{con}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><msub id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">L</mi><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">c</mi><mo id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml">o</mi><mo id="alg1.l8.m1.1.1.3.1a" xref="alg1.l8.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.3.4" xref="alg1.l8.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝐿</ci><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><times id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"></times><ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">𝑐</ci><ci id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3">𝑜</ci><ci id="alg1.l8.m1.1.1.3.4.cmml" xref="alg1.l8.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">L_{con}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_L start_POSTSUBSCRIPT italic_c italic_o italic_n end_POSTSUBSCRIPT</annotation></semantics></math> by equation (7)
// Step 5: compute total loss and malicious gradient

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>  Compute <math alttext="L_{total}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">L</mi><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">o</mi><mo id="alg1.l9.m1.1.1.3.1a" xref="alg1.l9.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.4" xref="alg1.l9.m1.1.1.3.4.cmml">t</mi><mo id="alg1.l9.m1.1.1.3.1b" xref="alg1.l9.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.5" xref="alg1.l9.m1.1.1.3.5.cmml">a</mi><mo id="alg1.l9.m1.1.1.3.1c" xref="alg1.l9.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.3.6" xref="alg1.l9.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝐿</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><times id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"></times><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑡</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝑜</ci><ci id="alg1.l9.m1.1.1.3.4.cmml" xref="alg1.l9.m1.1.1.3.4">𝑡</ci><ci id="alg1.l9.m1.1.1.3.5.cmml" xref="alg1.l9.m1.1.1.3.5">𝑎</ci><ci id="alg1.l9.m1.1.1.3.6.cmml" xref="alg1.l9.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">L_{total}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_L start_POSTSUBSCRIPT italic_t italic_o italic_t italic_a italic_l end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\hat{g}_{embedding},\hat{g}_{model}" class="ltx_Math" display="inline" id="alg1.l9.m2.2"><semantics id="alg1.l9.m2.2a"><mrow id="alg1.l9.m2.2.2.2" xref="alg1.l9.m2.2.2.3.cmml"><msub id="alg1.l9.m2.1.1.1.1" xref="alg1.l9.m2.1.1.1.1.cmml"><mover accent="true" id="alg1.l9.m2.1.1.1.1.2" xref="alg1.l9.m2.1.1.1.1.2.cmml"><mi id="alg1.l9.m2.1.1.1.1.2.2" xref="alg1.l9.m2.1.1.1.1.2.2.cmml">g</mi><mo id="alg1.l9.m2.1.1.1.1.2.1" xref="alg1.l9.m2.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="alg1.l9.m2.1.1.1.1.3" xref="alg1.l9.m2.1.1.1.1.3.cmml"><mi id="alg1.l9.m2.1.1.1.1.3.2" xref="alg1.l9.m2.1.1.1.1.3.2.cmml">e</mi><mo id="alg1.l9.m2.1.1.1.1.3.1" xref="alg1.l9.m2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.1.1.3.3" xref="alg1.l9.m2.1.1.1.1.3.3.cmml">m</mi><mo id="alg1.l9.m2.1.1.1.1.3.1a" xref="alg1.l9.m2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.1.1.3.4" xref="alg1.l9.m2.1.1.1.1.3.4.cmml">b</mi><mo id="alg1.l9.m2.1.1.1.1.3.1b" xref="alg1.l9.m2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.1.1.3.5" xref="alg1.l9.m2.1.1.1.1.3.5.cmml">e</mi><mo id="alg1.l9.m2.1.1.1.1.3.1c" xref="alg1.l9.m2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.1.1.3.6" xref="alg1.l9.m2.1.1.1.1.3.6.cmml">d</mi><mo id="alg1.l9.m2.1.1.1.1.3.1d" xref="alg1.l9.m2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.1.1.3.7" xref="alg1.l9.m2.1.1.1.1.3.7.cmml">d</mi><mo id="alg1.l9.m2.1.1.1.1.3.1e" xref="alg1.l9.m2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.1.1.3.8" xref="alg1.l9.m2.1.1.1.1.3.8.cmml">i</mi><mo id="alg1.l9.m2.1.1.1.1.3.1f" xref="alg1.l9.m2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.1.1.3.9" xref="alg1.l9.m2.1.1.1.1.3.9.cmml">n</mi><mo id="alg1.l9.m2.1.1.1.1.3.1g" xref="alg1.l9.m2.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.1.1.1.1.3.10" xref="alg1.l9.m2.1.1.1.1.3.10.cmml">g</mi></mrow></msub><mo id="alg1.l9.m2.2.2.2.3" xref="alg1.l9.m2.2.2.3.cmml">,</mo><msub id="alg1.l9.m2.2.2.2.2" xref="alg1.l9.m2.2.2.2.2.cmml"><mover accent="true" id="alg1.l9.m2.2.2.2.2.2" xref="alg1.l9.m2.2.2.2.2.2.cmml"><mi id="alg1.l9.m2.2.2.2.2.2.2" xref="alg1.l9.m2.2.2.2.2.2.2.cmml">g</mi><mo id="alg1.l9.m2.2.2.2.2.2.1" xref="alg1.l9.m2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l9.m2.2.2.2.2.3" xref="alg1.l9.m2.2.2.2.2.3.cmml"><mi id="alg1.l9.m2.2.2.2.2.3.2" xref="alg1.l9.m2.2.2.2.2.3.2.cmml">m</mi><mo id="alg1.l9.m2.2.2.2.2.3.1" xref="alg1.l9.m2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.2.2.2.2.3.3" xref="alg1.l9.m2.2.2.2.2.3.3.cmml">o</mi><mo id="alg1.l9.m2.2.2.2.2.3.1a" xref="alg1.l9.m2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.2.2.2.2.3.4" xref="alg1.l9.m2.2.2.2.2.3.4.cmml">d</mi><mo id="alg1.l9.m2.2.2.2.2.3.1b" xref="alg1.l9.m2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.2.2.2.2.3.5" xref="alg1.l9.m2.2.2.2.2.3.5.cmml">e</mi><mo id="alg1.l9.m2.2.2.2.2.3.1c" xref="alg1.l9.m2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m2.2.2.2.2.3.6" xref="alg1.l9.m2.2.2.2.2.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.2b"><list id="alg1.l9.m2.2.2.3.cmml" xref="alg1.l9.m2.2.2.2"><apply id="alg1.l9.m2.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.1.1.cmml" xref="alg1.l9.m2.1.1.1.1">subscript</csymbol><apply id="alg1.l9.m2.1.1.1.1.2.cmml" xref="alg1.l9.m2.1.1.1.1.2"><ci id="alg1.l9.m2.1.1.1.1.2.1.cmml" xref="alg1.l9.m2.1.1.1.1.2.1">^</ci><ci id="alg1.l9.m2.1.1.1.1.2.2.cmml" xref="alg1.l9.m2.1.1.1.1.2.2">𝑔</ci></apply><apply id="alg1.l9.m2.1.1.1.1.3.cmml" xref="alg1.l9.m2.1.1.1.1.3"><times id="alg1.l9.m2.1.1.1.1.3.1.cmml" xref="alg1.l9.m2.1.1.1.1.3.1"></times><ci id="alg1.l9.m2.1.1.1.1.3.2.cmml" xref="alg1.l9.m2.1.1.1.1.3.2">𝑒</ci><ci id="alg1.l9.m2.1.1.1.1.3.3.cmml" xref="alg1.l9.m2.1.1.1.1.3.3">𝑚</ci><ci id="alg1.l9.m2.1.1.1.1.3.4.cmml" xref="alg1.l9.m2.1.1.1.1.3.4">𝑏</ci><ci id="alg1.l9.m2.1.1.1.1.3.5.cmml" xref="alg1.l9.m2.1.1.1.1.3.5">𝑒</ci><ci id="alg1.l9.m2.1.1.1.1.3.6.cmml" xref="alg1.l9.m2.1.1.1.1.3.6">𝑑</ci><ci id="alg1.l9.m2.1.1.1.1.3.7.cmml" xref="alg1.l9.m2.1.1.1.1.3.7">𝑑</ci><ci id="alg1.l9.m2.1.1.1.1.3.8.cmml" xref="alg1.l9.m2.1.1.1.1.3.8">𝑖</ci><ci id="alg1.l9.m2.1.1.1.1.3.9.cmml" xref="alg1.l9.m2.1.1.1.1.3.9">𝑛</ci><ci id="alg1.l9.m2.1.1.1.1.3.10.cmml" xref="alg1.l9.m2.1.1.1.1.3.10">𝑔</ci></apply></apply><apply id="alg1.l9.m2.2.2.2.2.cmml" xref="alg1.l9.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m2.2.2.2.2.1.cmml" xref="alg1.l9.m2.2.2.2.2">subscript</csymbol><apply id="alg1.l9.m2.2.2.2.2.2.cmml" xref="alg1.l9.m2.2.2.2.2.2"><ci id="alg1.l9.m2.2.2.2.2.2.1.cmml" xref="alg1.l9.m2.2.2.2.2.2.1">^</ci><ci id="alg1.l9.m2.2.2.2.2.2.2.cmml" xref="alg1.l9.m2.2.2.2.2.2.2">𝑔</ci></apply><apply id="alg1.l9.m2.2.2.2.2.3.cmml" xref="alg1.l9.m2.2.2.2.2.3"><times id="alg1.l9.m2.2.2.2.2.3.1.cmml" xref="alg1.l9.m2.2.2.2.2.3.1"></times><ci id="alg1.l9.m2.2.2.2.2.3.2.cmml" xref="alg1.l9.m2.2.2.2.2.3.2">𝑚</ci><ci id="alg1.l9.m2.2.2.2.2.3.3.cmml" xref="alg1.l9.m2.2.2.2.2.3.3">𝑜</ci><ci id="alg1.l9.m2.2.2.2.2.3.4.cmml" xref="alg1.l9.m2.2.2.2.2.3.4">𝑑</ci><ci id="alg1.l9.m2.2.2.2.2.3.5.cmml" xref="alg1.l9.m2.2.2.2.2.3.5">𝑒</ci><ci id="alg1.l9.m2.2.2.2.2.3.6.cmml" xref="alg1.l9.m2.2.2.2.2.3.6">𝑙</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.2c">\hat{g}_{embedding},\hat{g}_{model}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.2d">over^ start_ARG italic_g end_ARG start_POSTSUBSCRIPT italic_e italic_m italic_b italic_e italic_d italic_d italic_i italic_n italic_g end_POSTSUBSCRIPT , over^ start_ARG italic_g end_ARG start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math> by equation (8)
// Step 6: Upload gradients

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>  Upload <math alttext="\hat{g}_{embedding},\hat{g}_{model}" class="ltx_Math" display="inline" id="alg1.l10.m1.2"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2.2" xref="alg1.l10.m1.2.2.3.cmml"><msub id="alg1.l10.m1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.cmml"><mover accent="true" id="alg1.l10.m1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.1.1.2.2" xref="alg1.l10.m1.1.1.1.1.2.2.cmml">g</mi><mo id="alg1.l10.m1.1.1.1.1.2.1" xref="alg1.l10.m1.1.1.1.1.2.1.cmml">^</mo></mover><mrow id="alg1.l10.m1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.1.1.3.2" xref="alg1.l10.m1.1.1.1.1.3.2.cmml">e</mi><mo id="alg1.l10.m1.1.1.1.1.3.1" xref="alg1.l10.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.3.3" xref="alg1.l10.m1.1.1.1.1.3.3.cmml">m</mi><mo id="alg1.l10.m1.1.1.1.1.3.1a" xref="alg1.l10.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.3.4" xref="alg1.l10.m1.1.1.1.1.3.4.cmml">b</mi><mo id="alg1.l10.m1.1.1.1.1.3.1b" xref="alg1.l10.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.3.5" xref="alg1.l10.m1.1.1.1.1.3.5.cmml">e</mi><mo id="alg1.l10.m1.1.1.1.1.3.1c" xref="alg1.l10.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.3.6" xref="alg1.l10.m1.1.1.1.1.3.6.cmml">d</mi><mo id="alg1.l10.m1.1.1.1.1.3.1d" xref="alg1.l10.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.3.7" xref="alg1.l10.m1.1.1.1.1.3.7.cmml">d</mi><mo id="alg1.l10.m1.1.1.1.1.3.1e" xref="alg1.l10.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.3.8" xref="alg1.l10.m1.1.1.1.1.3.8.cmml">i</mi><mo id="alg1.l10.m1.1.1.1.1.3.1f" xref="alg1.l10.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.3.9" xref="alg1.l10.m1.1.1.1.1.3.9.cmml">n</mi><mo id="alg1.l10.m1.1.1.1.1.3.1g" xref="alg1.l10.m1.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.3.10" xref="alg1.l10.m1.1.1.1.1.3.10.cmml">g</mi></mrow></msub><mo id="alg1.l10.m1.2.2.2.3" xref="alg1.l10.m1.2.2.3.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.cmml"><mover accent="true" id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml">g</mi><mo id="alg1.l10.m1.2.2.2.2.2.1" xref="alg1.l10.m1.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="alg1.l10.m1.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.3.cmml"><mi id="alg1.l10.m1.2.2.2.2.3.2" xref="alg1.l10.m1.2.2.2.2.3.2.cmml">m</mi><mo id="alg1.l10.m1.2.2.2.2.3.1" xref="alg1.l10.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.3.3" xref="alg1.l10.m1.2.2.2.2.3.3.cmml">o</mi><mo id="alg1.l10.m1.2.2.2.2.3.1a" xref="alg1.l10.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.3.4" xref="alg1.l10.m1.2.2.2.2.3.4.cmml">d</mi><mo id="alg1.l10.m1.2.2.2.2.3.1b" xref="alg1.l10.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.3.5" xref="alg1.l10.m1.2.2.2.2.3.5.cmml">e</mi><mo id="alg1.l10.m1.2.2.2.2.3.1c" xref="alg1.l10.m1.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.3.6" xref="alg1.l10.m1.2.2.2.2.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><list id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2.2"><apply id="alg1.l10.m1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1">subscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.2"><ci id="alg1.l10.m1.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.2.1">^</ci><ci id="alg1.l10.m1.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.2.2">𝑔</ci></apply><apply id="alg1.l10.m1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.3"><times id="alg1.l10.m1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.1.1.3.1"></times><ci id="alg1.l10.m1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.1.1.3.2">𝑒</ci><ci id="alg1.l10.m1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.1.1.3.3">𝑚</ci><ci id="alg1.l10.m1.1.1.1.1.3.4.cmml" xref="alg1.l10.m1.1.1.1.1.3.4">𝑏</ci><ci id="alg1.l10.m1.1.1.1.1.3.5.cmml" xref="alg1.l10.m1.1.1.1.1.3.5">𝑒</ci><ci id="alg1.l10.m1.1.1.1.1.3.6.cmml" xref="alg1.l10.m1.1.1.1.1.3.6">𝑑</ci><ci id="alg1.l10.m1.1.1.1.1.3.7.cmml" xref="alg1.l10.m1.1.1.1.1.3.7">𝑑</ci><ci id="alg1.l10.m1.1.1.1.1.3.8.cmml" xref="alg1.l10.m1.1.1.1.1.3.8">𝑖</ci><ci id="alg1.l10.m1.1.1.1.1.3.9.cmml" xref="alg1.l10.m1.1.1.1.1.3.9">𝑛</ci><ci id="alg1.l10.m1.1.1.1.1.3.10.cmml" xref="alg1.l10.m1.1.1.1.1.3.10">𝑔</ci></apply></apply><apply id="alg1.l10.m1.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2">subscript</csymbol><apply id="alg1.l10.m1.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2"><ci id="alg1.l10.m1.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.1">^</ci><ci id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2">𝑔</ci></apply><apply id="alg1.l10.m1.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.3"><times id="alg1.l10.m1.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.2.2.2.2.3.1"></times><ci id="alg1.l10.m1.2.2.2.2.3.2.cmml" xref="alg1.l10.m1.2.2.2.2.3.2">𝑚</ci><ci id="alg1.l10.m1.2.2.2.2.3.3.cmml" xref="alg1.l10.m1.2.2.2.2.3.3">𝑜</ci><ci id="alg1.l10.m1.2.2.2.2.3.4.cmml" xref="alg1.l10.m1.2.2.2.2.3.4">𝑑</ci><ci id="alg1.l10.m1.2.2.2.2.3.5.cmml" xref="alg1.l10.m1.2.2.2.2.3.5">𝑒</ci><ci id="alg1.l10.m1.2.2.2.2.3.6.cmml" xref="alg1.l10.m1.2.2.2.2.3.6">𝑙</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">\hat{g}_{embedding},\hat{g}_{model}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.2d">over^ start_ARG italic_g end_ARG start_POSTSUBSCRIPT italic_e italic_m italic_b italic_e italic_d italic_d italic_i italic_n italic_g end_POSTSUBSCRIPT , over^ start_ARG italic_g end_ARG start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math> to server

</div>
</div>
</figure>
</section>
<section class="ltx_subsubsection" id="Sx4.SSx1.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Implicit Strategy.</h4>
<div class="ltx_para" id="Sx4.SSx1.SSSx2.p1">
<p class="ltx_p" id="Sx4.SSx1.SSSx2.p1.6">Inspired by recent works on contrastive learning, we introduced an embedding contrastive loss to increase the score of the target item (step 4). This approach aims to enable the target item to learn useful features from interacted items. We use target item embedding as anchor <math alttext="\mathbf{a}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx2.p1.1.m1.1"><semantics id="Sx4.SSx1.SSSx2.p1.1.m1.1a"><mi id="Sx4.SSx1.SSSx2.p1.1.m1.1.1" xref="Sx4.SSx1.SSSx2.p1.1.m1.1.1.cmml">𝐚</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p1.1.m1.1b"><ci id="Sx4.SSx1.SSSx2.p1.1.m1.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.1.m1.1.1">𝐚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p1.1.m1.1c">\mathbf{a}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx2.p1.1.m1.1d">bold_a</annotation></semantics></math>, the mean of interacted item embedding as positive vector <math alttext="\mathbf{p}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx2.p1.2.m2.1"><semantics id="Sx4.SSx1.SSSx2.p1.2.m2.1a"><mi id="Sx4.SSx1.SSSx2.p1.2.m2.1.1" xref="Sx4.SSx1.SSSx2.p1.2.m2.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p1.2.m2.1b"><ci id="Sx4.SSx1.SSSx2.p1.2.m2.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.2.m2.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p1.2.m2.1c">\mathbf{p}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx2.p1.2.m2.1d">bold_p</annotation></semantics></math>, randomly sample <math alttext="n" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx2.p1.3.m3.1"><semantics id="Sx4.SSx1.SSSx2.p1.3.m3.1a"><mi id="Sx4.SSx1.SSSx2.p1.3.m3.1.1" xref="Sx4.SSx1.SSSx2.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p1.3.m3.1b"><ci id="Sx4.SSx1.SSSx2.p1.3.m3.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx2.p1.3.m3.1d">italic_n</annotation></semantics></math> non-interacted items as negative vector <math alttext="\mathbf{n}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx2.p1.4.m4.1"><semantics id="Sx4.SSx1.SSSx2.p1.4.m4.1a"><mi id="Sx4.SSx1.SSSx2.p1.4.m4.1.1" xref="Sx4.SSx1.SSSx2.p1.4.m4.1.1.cmml">𝐧</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p1.4.m4.1b"><ci id="Sx4.SSx1.SSSx2.p1.4.m4.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.4.m4.1.1">𝐧</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p1.4.m4.1c">\mathbf{n}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx2.p1.4.m4.1d">bold_n</annotation></semantics></math> (e.g. <math alttext="\mathbf{n_{1},n_{2}...}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx2.p1.5.m5.2"><semantics id="Sx4.SSx1.SSSx2.p1.5.m5.2a"><mrow id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.3.cmml"><msub id="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1" xref="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.cmml"><mi id="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.2" xref="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.2.cmml">𝐧</mi><mn id="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.3" xref="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.3.cmml">𝟏</mn></msub><mo id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.3" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.3.cmml">,</mo><mrow id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.cmml"><msub id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.cmml"><mi id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.2" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.2.cmml">𝐧</mi><mn id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.3" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.3.cmml">𝟐</mn></msub><mo id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.1" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.3" mathvariant="normal" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.3.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p1.5.m5.2b"><list id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.3.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2"><apply id="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.2.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.2">𝐧</ci><cn id="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.3.cmml" type="integer" xref="Sx4.SSx1.SSSx2.p1.5.m5.1.1.1.1.3">1</cn></apply><apply id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2"><times id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.1.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.1"></times><apply id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.1.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2">subscript</csymbol><ci id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.2.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.2">𝐧</ci><cn id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.3.cmml" type="integer" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.2.3">2</cn></apply><ci id="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.3.cmml" xref="Sx4.SSx1.SSSx2.p1.5.m5.2.2.2.2.3">…</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p1.5.m5.2c">\mathbf{n_{1},n_{2}...}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx2.p1.5.m5.2d">bold_n start_POSTSUBSCRIPT bold_1 end_POSTSUBSCRIPT , bold_n start_POSTSUBSCRIPT bold_2 end_POSTSUBSCRIPT …</annotation></semantics></math>) and use the cross-entropy loss function for loss calculation. Finally, we get <math alttext="L_{con}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx2.p1.6.m6.1"><semantics id="Sx4.SSx1.SSSx2.p1.6.m6.1a"><msub id="Sx4.SSx1.SSSx2.p1.6.m6.1.1" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.cmml"><mi id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.2" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.2.cmml">L</mi><mrow id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.cmml"><mi id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.2" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.2.cmml">c</mi><mo id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.1" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.3" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.3.cmml">o</mi><mo id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.1a" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.4" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p1.6.m6.1b"><apply id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.1.cmml" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1">subscript</csymbol><ci id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.2.cmml" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.2">𝐿</ci><apply id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.cmml" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3"><times id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.1.cmml" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.1"></times><ci id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.2.cmml" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.2">𝑐</ci><ci id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.3.cmml" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.3">𝑜</ci><ci id="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.4.cmml" xref="Sx4.SSx1.SSSx2.p1.6.m6.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p1.6.m6.1c">L_{con}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx2.p1.6.m6.1d">italic_L start_POSTSUBSCRIPT italic_c italic_o italic_n end_POSTSUBSCRIPT</annotation></semantics></math>. The specific contrastive learning calculation formula is shown as follows:</p>
<ul class="ltx_itemize" id="Sx4.I3">
<li class="ltx_item" id="Sx4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I3.i1.p1">
<p class="ltx_p" id="Sx4.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I3.i1.p1.1.1">Cosine Similarity Calculation:</span></p>
<ul class="ltx_itemize" id="Sx4.I3.i1.I1">
<li class="ltx_item" id="Sx4.I3.i1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="Sx4.I3.i1.I1.i1.1.1.1">–</span></span>
<div class="ltx_para" id="Sx4.I3.i1.I1.i1.p1">
<p class="ltx_p" id="Sx4.I3.i1.I1.i1.p1.3">Positive similarity: anchor and positive sample:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s_{\text{pos}}=\frac{\mathbf{a}\cdot\mathbf{p}}{\|\mathbf{a}\|\|\mathbf{p}\|}" class="ltx_Math" display="block" id="Sx4.Ex5.m1.2"><semantics id="Sx4.Ex5.m1.2a"><mrow id="Sx4.Ex5.m1.2.3" xref="Sx4.Ex5.m1.2.3.cmml"><msub id="Sx4.Ex5.m1.2.3.2" xref="Sx4.Ex5.m1.2.3.2.cmml"><mi id="Sx4.Ex5.m1.2.3.2.2" xref="Sx4.Ex5.m1.2.3.2.2.cmml">s</mi><mtext id="Sx4.Ex5.m1.2.3.2.3" xref="Sx4.Ex5.m1.2.3.2.3a.cmml">pos</mtext></msub><mo id="Sx4.Ex5.m1.2.3.1" xref="Sx4.Ex5.m1.2.3.1.cmml">=</mo><mfrac id="Sx4.Ex5.m1.2.2" xref="Sx4.Ex5.m1.2.2.cmml"><mrow id="Sx4.Ex5.m1.2.2.4" xref="Sx4.Ex5.m1.2.2.4.cmml"><mi id="Sx4.Ex5.m1.2.2.4.2" xref="Sx4.Ex5.m1.2.2.4.2.cmml">𝐚</mi><mo id="Sx4.Ex5.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="Sx4.Ex5.m1.2.2.4.1.cmml">⋅</mo><mi id="Sx4.Ex5.m1.2.2.4.3" xref="Sx4.Ex5.m1.2.2.4.3.cmml">𝐩</mi></mrow><mrow id="Sx4.Ex5.m1.2.2.2" xref="Sx4.Ex5.m1.2.2.2.cmml"><mrow id="Sx4.Ex5.m1.2.2.2.4.2" xref="Sx4.Ex5.m1.2.2.2.4.1.cmml"><mo id="Sx4.Ex5.m1.2.2.2.4.2.1" stretchy="false" xref="Sx4.Ex5.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="Sx4.Ex5.m1.1.1.1.1" xref="Sx4.Ex5.m1.1.1.1.1.cmml">𝐚</mi><mo id="Sx4.Ex5.m1.2.2.2.4.2.2" stretchy="false" xref="Sx4.Ex5.m1.2.2.2.4.1.1.cmml">‖</mo></mrow><mo id="Sx4.Ex5.m1.2.2.2.3" xref="Sx4.Ex5.m1.2.2.2.3.cmml">⁢</mo><mrow id="Sx4.Ex5.m1.2.2.2.5.2" xref="Sx4.Ex5.m1.2.2.2.5.1.cmml"><mo id="Sx4.Ex5.m1.2.2.2.5.2.1" stretchy="false" xref="Sx4.Ex5.m1.2.2.2.5.1.1.cmml">‖</mo><mi id="Sx4.Ex5.m1.2.2.2.2" xref="Sx4.Ex5.m1.2.2.2.2.cmml">𝐩</mi><mo id="Sx4.Ex5.m1.2.2.2.5.2.2" stretchy="false" xref="Sx4.Ex5.m1.2.2.2.5.1.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex5.m1.2b"><apply id="Sx4.Ex5.m1.2.3.cmml" xref="Sx4.Ex5.m1.2.3"><eq id="Sx4.Ex5.m1.2.3.1.cmml" xref="Sx4.Ex5.m1.2.3.1"></eq><apply id="Sx4.Ex5.m1.2.3.2.cmml" xref="Sx4.Ex5.m1.2.3.2"><csymbol cd="ambiguous" id="Sx4.Ex5.m1.2.3.2.1.cmml" xref="Sx4.Ex5.m1.2.3.2">subscript</csymbol><ci id="Sx4.Ex5.m1.2.3.2.2.cmml" xref="Sx4.Ex5.m1.2.3.2.2">𝑠</ci><ci id="Sx4.Ex5.m1.2.3.2.3a.cmml" xref="Sx4.Ex5.m1.2.3.2.3"><mtext id="Sx4.Ex5.m1.2.3.2.3.cmml" mathsize="70%" xref="Sx4.Ex5.m1.2.3.2.3">pos</mtext></ci></apply><apply id="Sx4.Ex5.m1.2.2.cmml" xref="Sx4.Ex5.m1.2.2"><divide id="Sx4.Ex5.m1.2.2.3.cmml" xref="Sx4.Ex5.m1.2.2"></divide><apply id="Sx4.Ex5.m1.2.2.4.cmml" xref="Sx4.Ex5.m1.2.2.4"><ci id="Sx4.Ex5.m1.2.2.4.1.cmml" xref="Sx4.Ex5.m1.2.2.4.1">⋅</ci><ci id="Sx4.Ex5.m1.2.2.4.2.cmml" xref="Sx4.Ex5.m1.2.2.4.2">𝐚</ci><ci id="Sx4.Ex5.m1.2.2.4.3.cmml" xref="Sx4.Ex5.m1.2.2.4.3">𝐩</ci></apply><apply id="Sx4.Ex5.m1.2.2.2.cmml" xref="Sx4.Ex5.m1.2.2.2"><times id="Sx4.Ex5.m1.2.2.2.3.cmml" xref="Sx4.Ex5.m1.2.2.2.3"></times><apply id="Sx4.Ex5.m1.2.2.2.4.1.cmml" xref="Sx4.Ex5.m1.2.2.2.4.2"><csymbol cd="latexml" id="Sx4.Ex5.m1.2.2.2.4.1.1.cmml" xref="Sx4.Ex5.m1.2.2.2.4.2.1">norm</csymbol><ci id="Sx4.Ex5.m1.1.1.1.1.cmml" xref="Sx4.Ex5.m1.1.1.1.1">𝐚</ci></apply><apply id="Sx4.Ex5.m1.2.2.2.5.1.cmml" xref="Sx4.Ex5.m1.2.2.2.5.2"><csymbol cd="latexml" id="Sx4.Ex5.m1.2.2.2.5.1.1.cmml" xref="Sx4.Ex5.m1.2.2.2.5.2.1">norm</csymbol><ci id="Sx4.Ex5.m1.2.2.2.2.cmml" xref="Sx4.Ex5.m1.2.2.2.2">𝐩</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex5.m1.2c">s_{\text{pos}}=\frac{\mathbf{a}\cdot\mathbf{p}}{\|\mathbf{a}\|\|\mathbf{p}\|}</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex5.m1.2d">italic_s start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT = divide start_ARG bold_a ⋅ bold_p end_ARG start_ARG ∥ bold_a ∥ ∥ bold_p ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.I3.i1.I1.i1.p1.2">where <math alttext="\mathbf{a}" class="ltx_Math" display="inline" id="Sx4.I3.i1.I1.i1.p1.1.m1.1"><semantics id="Sx4.I3.i1.I1.i1.p1.1.m1.1a"><mi id="Sx4.I3.i1.I1.i1.p1.1.m1.1.1" xref="Sx4.I3.i1.I1.i1.p1.1.m1.1.1.cmml">𝐚</mi><annotation-xml encoding="MathML-Content" id="Sx4.I3.i1.I1.i1.p1.1.m1.1b"><ci id="Sx4.I3.i1.I1.i1.p1.1.m1.1.1.cmml" xref="Sx4.I3.i1.I1.i1.p1.1.m1.1.1">𝐚</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I3.i1.I1.i1.p1.1.m1.1c">\mathbf{a}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I3.i1.I1.i1.p1.1.m1.1d">bold_a</annotation></semantics></math> is anchor vector and <math alttext="\mathbf{p}" class="ltx_Math" display="inline" id="Sx4.I3.i1.I1.i1.p1.2.m2.1"><semantics id="Sx4.I3.i1.I1.i1.p1.2.m2.1a"><mi id="Sx4.I3.i1.I1.i1.p1.2.m2.1.1" xref="Sx4.I3.i1.I1.i1.p1.2.m2.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="Sx4.I3.i1.I1.i1.p1.2.m2.1b"><ci id="Sx4.I3.i1.I1.i1.p1.2.m2.1.1.cmml" xref="Sx4.I3.i1.I1.i1.p1.2.m2.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I3.i1.I1.i1.p1.2.m2.1c">\mathbf{p}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I3.i1.I1.i1.p1.2.m2.1d">bold_p</annotation></semantics></math> is positive vector.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I3.i1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="Sx4.I3.i1.I1.i2.1.1.1">–</span></span>
<div class="ltx_para" id="Sx4.I3.i1.I1.i2.p1">
<p class="ltx_p" id="Sx4.I3.i1.I1.i2.p1.2">Negative similarities between the anchor and each negative sample:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s_{\text{neg}_{i}}=\frac{\mathbf{a}\cdot\mathbf{n}_{i}}{\|\mathbf{a}\|\|%
\mathbf{n}_{i}\|}" class="ltx_Math" display="block" id="Sx4.Ex6.m1.2"><semantics id="Sx4.Ex6.m1.2a"><mrow id="Sx4.Ex6.m1.2.3" xref="Sx4.Ex6.m1.2.3.cmml"><msub id="Sx4.Ex6.m1.2.3.2" xref="Sx4.Ex6.m1.2.3.2.cmml"><mi id="Sx4.Ex6.m1.2.3.2.2" xref="Sx4.Ex6.m1.2.3.2.2.cmml">s</mi><msub id="Sx4.Ex6.m1.2.3.2.3" xref="Sx4.Ex6.m1.2.3.2.3.cmml"><mtext id="Sx4.Ex6.m1.2.3.2.3.2" xref="Sx4.Ex6.m1.2.3.2.3.2a.cmml">neg</mtext><mi id="Sx4.Ex6.m1.2.3.2.3.3" xref="Sx4.Ex6.m1.2.3.2.3.3.cmml">i</mi></msub></msub><mo id="Sx4.Ex6.m1.2.3.1" xref="Sx4.Ex6.m1.2.3.1.cmml">=</mo><mfrac id="Sx4.Ex6.m1.2.2" xref="Sx4.Ex6.m1.2.2.cmml"><mrow id="Sx4.Ex6.m1.2.2.4" xref="Sx4.Ex6.m1.2.2.4.cmml"><mi id="Sx4.Ex6.m1.2.2.4.2" xref="Sx4.Ex6.m1.2.2.4.2.cmml">𝐚</mi><mo id="Sx4.Ex6.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="Sx4.Ex6.m1.2.2.4.1.cmml">⋅</mo><msub id="Sx4.Ex6.m1.2.2.4.3" xref="Sx4.Ex6.m1.2.2.4.3.cmml"><mi id="Sx4.Ex6.m1.2.2.4.3.2" xref="Sx4.Ex6.m1.2.2.4.3.2.cmml">𝐧</mi><mi id="Sx4.Ex6.m1.2.2.4.3.3" xref="Sx4.Ex6.m1.2.2.4.3.3.cmml">i</mi></msub></mrow><mrow id="Sx4.Ex6.m1.2.2.2" xref="Sx4.Ex6.m1.2.2.2.cmml"><mrow id="Sx4.Ex6.m1.2.2.2.4.2" xref="Sx4.Ex6.m1.2.2.2.4.1.cmml"><mo id="Sx4.Ex6.m1.2.2.2.4.2.1" stretchy="false" xref="Sx4.Ex6.m1.2.2.2.4.1.1.cmml">‖</mo><mi id="Sx4.Ex6.m1.1.1.1.1" xref="Sx4.Ex6.m1.1.1.1.1.cmml">𝐚</mi><mo id="Sx4.Ex6.m1.2.2.2.4.2.2" stretchy="false" xref="Sx4.Ex6.m1.2.2.2.4.1.1.cmml">‖</mo></mrow><mo id="Sx4.Ex6.m1.2.2.2.3" xref="Sx4.Ex6.m1.2.2.2.3.cmml">⁢</mo><mrow id="Sx4.Ex6.m1.2.2.2.2.1" xref="Sx4.Ex6.m1.2.2.2.2.2.cmml"><mo id="Sx4.Ex6.m1.2.2.2.2.1.2" stretchy="false" xref="Sx4.Ex6.m1.2.2.2.2.2.1.cmml">‖</mo><msub id="Sx4.Ex6.m1.2.2.2.2.1.1" xref="Sx4.Ex6.m1.2.2.2.2.1.1.cmml"><mi id="Sx4.Ex6.m1.2.2.2.2.1.1.2" xref="Sx4.Ex6.m1.2.2.2.2.1.1.2.cmml">𝐧</mi><mi id="Sx4.Ex6.m1.2.2.2.2.1.1.3" xref="Sx4.Ex6.m1.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="Sx4.Ex6.m1.2.2.2.2.1.3" stretchy="false" xref="Sx4.Ex6.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex6.m1.2b"><apply id="Sx4.Ex6.m1.2.3.cmml" xref="Sx4.Ex6.m1.2.3"><eq id="Sx4.Ex6.m1.2.3.1.cmml" xref="Sx4.Ex6.m1.2.3.1"></eq><apply id="Sx4.Ex6.m1.2.3.2.cmml" xref="Sx4.Ex6.m1.2.3.2"><csymbol cd="ambiguous" id="Sx4.Ex6.m1.2.3.2.1.cmml" xref="Sx4.Ex6.m1.2.3.2">subscript</csymbol><ci id="Sx4.Ex6.m1.2.3.2.2.cmml" xref="Sx4.Ex6.m1.2.3.2.2">𝑠</ci><apply id="Sx4.Ex6.m1.2.3.2.3.cmml" xref="Sx4.Ex6.m1.2.3.2.3"><csymbol cd="ambiguous" id="Sx4.Ex6.m1.2.3.2.3.1.cmml" xref="Sx4.Ex6.m1.2.3.2.3">subscript</csymbol><ci id="Sx4.Ex6.m1.2.3.2.3.2a.cmml" xref="Sx4.Ex6.m1.2.3.2.3.2"><mtext id="Sx4.Ex6.m1.2.3.2.3.2.cmml" mathsize="70%" xref="Sx4.Ex6.m1.2.3.2.3.2">neg</mtext></ci><ci id="Sx4.Ex6.m1.2.3.2.3.3.cmml" xref="Sx4.Ex6.m1.2.3.2.3.3">𝑖</ci></apply></apply><apply id="Sx4.Ex6.m1.2.2.cmml" xref="Sx4.Ex6.m1.2.2"><divide id="Sx4.Ex6.m1.2.2.3.cmml" xref="Sx4.Ex6.m1.2.2"></divide><apply id="Sx4.Ex6.m1.2.2.4.cmml" xref="Sx4.Ex6.m1.2.2.4"><ci id="Sx4.Ex6.m1.2.2.4.1.cmml" xref="Sx4.Ex6.m1.2.2.4.1">⋅</ci><ci id="Sx4.Ex6.m1.2.2.4.2.cmml" xref="Sx4.Ex6.m1.2.2.4.2">𝐚</ci><apply id="Sx4.Ex6.m1.2.2.4.3.cmml" xref="Sx4.Ex6.m1.2.2.4.3"><csymbol cd="ambiguous" id="Sx4.Ex6.m1.2.2.4.3.1.cmml" xref="Sx4.Ex6.m1.2.2.4.3">subscript</csymbol><ci id="Sx4.Ex6.m1.2.2.4.3.2.cmml" xref="Sx4.Ex6.m1.2.2.4.3.2">𝐧</ci><ci id="Sx4.Ex6.m1.2.2.4.3.3.cmml" xref="Sx4.Ex6.m1.2.2.4.3.3">𝑖</ci></apply></apply><apply id="Sx4.Ex6.m1.2.2.2.cmml" xref="Sx4.Ex6.m1.2.2.2"><times id="Sx4.Ex6.m1.2.2.2.3.cmml" xref="Sx4.Ex6.m1.2.2.2.3"></times><apply id="Sx4.Ex6.m1.2.2.2.4.1.cmml" xref="Sx4.Ex6.m1.2.2.2.4.2"><csymbol cd="latexml" id="Sx4.Ex6.m1.2.2.2.4.1.1.cmml" xref="Sx4.Ex6.m1.2.2.2.4.2.1">norm</csymbol><ci id="Sx4.Ex6.m1.1.1.1.1.cmml" xref="Sx4.Ex6.m1.1.1.1.1">𝐚</ci></apply><apply id="Sx4.Ex6.m1.2.2.2.2.2.cmml" xref="Sx4.Ex6.m1.2.2.2.2.1"><csymbol cd="latexml" id="Sx4.Ex6.m1.2.2.2.2.2.1.cmml" xref="Sx4.Ex6.m1.2.2.2.2.1.2">norm</csymbol><apply id="Sx4.Ex6.m1.2.2.2.2.1.1.cmml" xref="Sx4.Ex6.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx4.Ex6.m1.2.2.2.2.1.1.1.cmml" xref="Sx4.Ex6.m1.2.2.2.2.1.1">subscript</csymbol><ci id="Sx4.Ex6.m1.2.2.2.2.1.1.2.cmml" xref="Sx4.Ex6.m1.2.2.2.2.1.1.2">𝐧</ci><ci id="Sx4.Ex6.m1.2.2.2.2.1.1.3.cmml" xref="Sx4.Ex6.m1.2.2.2.2.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex6.m1.2c">s_{\text{neg}_{i}}=\frac{\mathbf{a}\cdot\mathbf{n}_{i}}{\|\mathbf{a}\|\|%
\mathbf{n}_{i}\|}</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex6.m1.2d">italic_s start_POSTSUBSCRIPT neg start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT = divide start_ARG bold_a ⋅ bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_a ∥ ∥ bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.I3.i1.I1.i2.p1.1">where <math alttext="\mathbf{n}_{i}" class="ltx_Math" display="inline" id="Sx4.I3.i1.I1.i2.p1.1.m1.1"><semantics id="Sx4.I3.i1.I1.i2.p1.1.m1.1a"><msub id="Sx4.I3.i1.I1.i2.p1.1.m1.1.1" xref="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.cmml"><mi id="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.2" xref="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.2.cmml">𝐧</mi><mi id="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.3" xref="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.I3.i1.I1.i2.p1.1.m1.1b"><apply id="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.cmml" xref="Sx4.I3.i1.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.1.cmml" xref="Sx4.I3.i1.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.2.cmml" xref="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.2">𝐧</ci><ci id="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.3.cmml" xref="Sx4.I3.i1.I1.i2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.I3.i1.I1.i2.p1.1.m1.1c">\mathbf{n}_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx4.I3.i1.I1.i2.p1.1.m1.1d">bold_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents each negative sample vector.</p>
</div>
</li>
</ul>
</div>
</li>
<li class="ltx_item" id="Sx4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I3.i2.p1">
<p class="ltx_p" id="Sx4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I3.i2.p1.1.1">Softmax Cross-Entropy Loss:</span>
The target label for the anchor is always the positive sample (index 0), so the cross-entropy loss function is:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{con}=-\log\left(\frac{e^{s_{\text{pos}}}}{e^{s_{\text{pos}}}+\sum_{i=1}^{n}%
e^{s_{\text{neg}_{i}}}}\right)" class="ltx_Math" display="block" id="Sx4.Ex7.m1.2"><semantics id="Sx4.Ex7.m1.2a"><mrow id="Sx4.Ex7.m1.2.3" xref="Sx4.Ex7.m1.2.3.cmml"><msub id="Sx4.Ex7.m1.2.3.2" xref="Sx4.Ex7.m1.2.3.2.cmml"><mi id="Sx4.Ex7.m1.2.3.2.2" xref="Sx4.Ex7.m1.2.3.2.2.cmml">L</mi><mrow id="Sx4.Ex7.m1.2.3.2.3" xref="Sx4.Ex7.m1.2.3.2.3.cmml"><mi id="Sx4.Ex7.m1.2.3.2.3.2" xref="Sx4.Ex7.m1.2.3.2.3.2.cmml">c</mi><mo id="Sx4.Ex7.m1.2.3.2.3.1" xref="Sx4.Ex7.m1.2.3.2.3.1.cmml">⁢</mo><mi id="Sx4.Ex7.m1.2.3.2.3.3" xref="Sx4.Ex7.m1.2.3.2.3.3.cmml">o</mi><mo id="Sx4.Ex7.m1.2.3.2.3.1a" xref="Sx4.Ex7.m1.2.3.2.3.1.cmml">⁢</mo><mi id="Sx4.Ex7.m1.2.3.2.3.4" xref="Sx4.Ex7.m1.2.3.2.3.4.cmml">n</mi></mrow></msub><mo id="Sx4.Ex7.m1.2.3.1" xref="Sx4.Ex7.m1.2.3.1.cmml">=</mo><mrow id="Sx4.Ex7.m1.2.3.3" xref="Sx4.Ex7.m1.2.3.3.cmml"><mo id="Sx4.Ex7.m1.2.3.3a" rspace="0.167em" xref="Sx4.Ex7.m1.2.3.3.cmml">−</mo><mrow id="Sx4.Ex7.m1.2.3.3.2.2" xref="Sx4.Ex7.m1.2.3.3.2.1.cmml"><mi id="Sx4.Ex7.m1.1.1" xref="Sx4.Ex7.m1.1.1.cmml">log</mi><mo id="Sx4.Ex7.m1.2.3.3.2.2a" xref="Sx4.Ex7.m1.2.3.3.2.1.cmml">⁡</mo><mrow id="Sx4.Ex7.m1.2.3.3.2.2.1" xref="Sx4.Ex7.m1.2.3.3.2.1.cmml"><mo id="Sx4.Ex7.m1.2.3.3.2.2.1.1" xref="Sx4.Ex7.m1.2.3.3.2.1.cmml">(</mo><mfrac id="Sx4.Ex7.m1.2.2" xref="Sx4.Ex7.m1.2.2.cmml"><msup id="Sx4.Ex7.m1.2.2.2" xref="Sx4.Ex7.m1.2.2.2.cmml"><mi id="Sx4.Ex7.m1.2.2.2.2" xref="Sx4.Ex7.m1.2.2.2.2.cmml">e</mi><msub id="Sx4.Ex7.m1.2.2.2.3" xref="Sx4.Ex7.m1.2.2.2.3.cmml"><mi id="Sx4.Ex7.m1.2.2.2.3.2" xref="Sx4.Ex7.m1.2.2.2.3.2.cmml">s</mi><mtext id="Sx4.Ex7.m1.2.2.2.3.3" xref="Sx4.Ex7.m1.2.2.2.3.3a.cmml">pos</mtext></msub></msup><mrow id="Sx4.Ex7.m1.2.2.3" xref="Sx4.Ex7.m1.2.2.3.cmml"><msup id="Sx4.Ex7.m1.2.2.3.2" xref="Sx4.Ex7.m1.2.2.3.2.cmml"><mi id="Sx4.Ex7.m1.2.2.3.2.2" xref="Sx4.Ex7.m1.2.2.3.2.2.cmml">e</mi><msub id="Sx4.Ex7.m1.2.2.3.2.3" xref="Sx4.Ex7.m1.2.2.3.2.3.cmml"><mi id="Sx4.Ex7.m1.2.2.3.2.3.2" xref="Sx4.Ex7.m1.2.2.3.2.3.2.cmml">s</mi><mtext id="Sx4.Ex7.m1.2.2.3.2.3.3" xref="Sx4.Ex7.m1.2.2.3.2.3.3a.cmml">pos</mtext></msub></msup><mo id="Sx4.Ex7.m1.2.2.3.1" rspace="0.055em" xref="Sx4.Ex7.m1.2.2.3.1.cmml">+</mo><mrow id="Sx4.Ex7.m1.2.2.3.3" xref="Sx4.Ex7.m1.2.2.3.3.cmml"><msubsup id="Sx4.Ex7.m1.2.2.3.3.1" xref="Sx4.Ex7.m1.2.2.3.3.1.cmml"><mo id="Sx4.Ex7.m1.2.2.3.3.1.2.2" xref="Sx4.Ex7.m1.2.2.3.3.1.2.2.cmml">∑</mo><mrow id="Sx4.Ex7.m1.2.2.3.3.1.2.3" xref="Sx4.Ex7.m1.2.2.3.3.1.2.3.cmml"><mi id="Sx4.Ex7.m1.2.2.3.3.1.2.3.2" xref="Sx4.Ex7.m1.2.2.3.3.1.2.3.2.cmml">i</mi><mo id="Sx4.Ex7.m1.2.2.3.3.1.2.3.1" xref="Sx4.Ex7.m1.2.2.3.3.1.2.3.1.cmml">=</mo><mn id="Sx4.Ex7.m1.2.2.3.3.1.2.3.3" xref="Sx4.Ex7.m1.2.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="Sx4.Ex7.m1.2.2.3.3.1.3" xref="Sx4.Ex7.m1.2.2.3.3.1.3.cmml">n</mi></msubsup><msup id="Sx4.Ex7.m1.2.2.3.3.2" xref="Sx4.Ex7.m1.2.2.3.3.2.cmml"><mi id="Sx4.Ex7.m1.2.2.3.3.2.2" xref="Sx4.Ex7.m1.2.2.3.3.2.2.cmml">e</mi><msub id="Sx4.Ex7.m1.2.2.3.3.2.3" xref="Sx4.Ex7.m1.2.2.3.3.2.3.cmml"><mi id="Sx4.Ex7.m1.2.2.3.3.2.3.2" xref="Sx4.Ex7.m1.2.2.3.3.2.3.2.cmml">s</mi><msub id="Sx4.Ex7.m1.2.2.3.3.2.3.3" xref="Sx4.Ex7.m1.2.2.3.3.2.3.3.cmml"><mtext id="Sx4.Ex7.m1.2.2.3.3.2.3.3.2" xref="Sx4.Ex7.m1.2.2.3.3.2.3.3.2a.cmml">neg</mtext><mi id="Sx4.Ex7.m1.2.2.3.3.2.3.3.3" xref="Sx4.Ex7.m1.2.2.3.3.2.3.3.3.cmml">i</mi></msub></msub></msup></mrow></mrow></mfrac><mo id="Sx4.Ex7.m1.2.3.3.2.2.1.2" xref="Sx4.Ex7.m1.2.3.3.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex7.m1.2b"><apply id="Sx4.Ex7.m1.2.3.cmml" xref="Sx4.Ex7.m1.2.3"><eq id="Sx4.Ex7.m1.2.3.1.cmml" xref="Sx4.Ex7.m1.2.3.1"></eq><apply id="Sx4.Ex7.m1.2.3.2.cmml" xref="Sx4.Ex7.m1.2.3.2"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.3.2.1.cmml" xref="Sx4.Ex7.m1.2.3.2">subscript</csymbol><ci id="Sx4.Ex7.m1.2.3.2.2.cmml" xref="Sx4.Ex7.m1.2.3.2.2">𝐿</ci><apply id="Sx4.Ex7.m1.2.3.2.3.cmml" xref="Sx4.Ex7.m1.2.3.2.3"><times id="Sx4.Ex7.m1.2.3.2.3.1.cmml" xref="Sx4.Ex7.m1.2.3.2.3.1"></times><ci id="Sx4.Ex7.m1.2.3.2.3.2.cmml" xref="Sx4.Ex7.m1.2.3.2.3.2">𝑐</ci><ci id="Sx4.Ex7.m1.2.3.2.3.3.cmml" xref="Sx4.Ex7.m1.2.3.2.3.3">𝑜</ci><ci id="Sx4.Ex7.m1.2.3.2.3.4.cmml" xref="Sx4.Ex7.m1.2.3.2.3.4">𝑛</ci></apply></apply><apply id="Sx4.Ex7.m1.2.3.3.cmml" xref="Sx4.Ex7.m1.2.3.3"><minus id="Sx4.Ex7.m1.2.3.3.1.cmml" xref="Sx4.Ex7.m1.2.3.3"></minus><apply id="Sx4.Ex7.m1.2.3.3.2.1.cmml" xref="Sx4.Ex7.m1.2.3.3.2.2"><log id="Sx4.Ex7.m1.1.1.cmml" xref="Sx4.Ex7.m1.1.1"></log><apply id="Sx4.Ex7.m1.2.2.cmml" xref="Sx4.Ex7.m1.2.2"><divide id="Sx4.Ex7.m1.2.2.1.cmml" xref="Sx4.Ex7.m1.2.2"></divide><apply id="Sx4.Ex7.m1.2.2.2.cmml" xref="Sx4.Ex7.m1.2.2.2"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.2.1.cmml" xref="Sx4.Ex7.m1.2.2.2">superscript</csymbol><ci id="Sx4.Ex7.m1.2.2.2.2.cmml" xref="Sx4.Ex7.m1.2.2.2.2">𝑒</ci><apply id="Sx4.Ex7.m1.2.2.2.3.cmml" xref="Sx4.Ex7.m1.2.2.2.3"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.2.3.1.cmml" xref="Sx4.Ex7.m1.2.2.2.3">subscript</csymbol><ci id="Sx4.Ex7.m1.2.2.2.3.2.cmml" xref="Sx4.Ex7.m1.2.2.2.3.2">𝑠</ci><ci id="Sx4.Ex7.m1.2.2.2.3.3a.cmml" xref="Sx4.Ex7.m1.2.2.2.3.3"><mtext id="Sx4.Ex7.m1.2.2.2.3.3.cmml" mathsize="50%" xref="Sx4.Ex7.m1.2.2.2.3.3">pos</mtext></ci></apply></apply><apply id="Sx4.Ex7.m1.2.2.3.cmml" xref="Sx4.Ex7.m1.2.2.3"><plus id="Sx4.Ex7.m1.2.2.3.1.cmml" xref="Sx4.Ex7.m1.2.2.3.1"></plus><apply id="Sx4.Ex7.m1.2.2.3.2.cmml" xref="Sx4.Ex7.m1.2.2.3.2"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.3.2.1.cmml" xref="Sx4.Ex7.m1.2.2.3.2">superscript</csymbol><ci id="Sx4.Ex7.m1.2.2.3.2.2.cmml" xref="Sx4.Ex7.m1.2.2.3.2.2">𝑒</ci><apply id="Sx4.Ex7.m1.2.2.3.2.3.cmml" xref="Sx4.Ex7.m1.2.2.3.2.3"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.3.2.3.1.cmml" xref="Sx4.Ex7.m1.2.2.3.2.3">subscript</csymbol><ci id="Sx4.Ex7.m1.2.2.3.2.3.2.cmml" xref="Sx4.Ex7.m1.2.2.3.2.3.2">𝑠</ci><ci id="Sx4.Ex7.m1.2.2.3.2.3.3a.cmml" xref="Sx4.Ex7.m1.2.2.3.2.3.3"><mtext id="Sx4.Ex7.m1.2.2.3.2.3.3.cmml" mathsize="50%" xref="Sx4.Ex7.m1.2.2.3.2.3.3">pos</mtext></ci></apply></apply><apply id="Sx4.Ex7.m1.2.2.3.3.cmml" xref="Sx4.Ex7.m1.2.2.3.3"><apply id="Sx4.Ex7.m1.2.2.3.3.1.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.3.3.1.1.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1">superscript</csymbol><apply id="Sx4.Ex7.m1.2.2.3.3.1.2.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.3.3.1.2.1.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1">subscript</csymbol><sum id="Sx4.Ex7.m1.2.2.3.3.1.2.2.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1.2.2"></sum><apply id="Sx4.Ex7.m1.2.2.3.3.1.2.3.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1.2.3"><eq id="Sx4.Ex7.m1.2.2.3.3.1.2.3.1.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1.2.3.1"></eq><ci id="Sx4.Ex7.m1.2.2.3.3.1.2.3.2.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1.2.3.2">𝑖</ci><cn id="Sx4.Ex7.m1.2.2.3.3.1.2.3.3.cmml" type="integer" xref="Sx4.Ex7.m1.2.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="Sx4.Ex7.m1.2.2.3.3.1.3.cmml" xref="Sx4.Ex7.m1.2.2.3.3.1.3">𝑛</ci></apply><apply id="Sx4.Ex7.m1.2.2.3.3.2.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.3.3.2.1.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2">superscript</csymbol><ci id="Sx4.Ex7.m1.2.2.3.3.2.2.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2.2">𝑒</ci><apply id="Sx4.Ex7.m1.2.2.3.3.2.3.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2.3"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.3.3.2.3.1.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2.3">subscript</csymbol><ci id="Sx4.Ex7.m1.2.2.3.3.2.3.2.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2.3.2">𝑠</ci><apply id="Sx4.Ex7.m1.2.2.3.3.2.3.3.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2.3.3"><csymbol cd="ambiguous" id="Sx4.Ex7.m1.2.2.3.3.2.3.3.1.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2.3.3">subscript</csymbol><ci id="Sx4.Ex7.m1.2.2.3.3.2.3.3.2a.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2.3.3.2"><mtext id="Sx4.Ex7.m1.2.2.3.3.2.3.3.2.cmml" mathsize="50%" xref="Sx4.Ex7.m1.2.2.3.3.2.3.3.2">neg</mtext></ci><ci id="Sx4.Ex7.m1.2.2.3.3.2.3.3.3.cmml" xref="Sx4.Ex7.m1.2.2.3.3.2.3.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex7.m1.2c">L_{con}=-\log\left(\frac{e^{s_{\text{pos}}}}{e^{s_{\text{pos}}}+\sum_{i=1}^{n}%
e^{s_{\text{neg}_{i}}}}\right)</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex7.m1.2d">italic_L start_POSTSUBSCRIPT italic_c italic_o italic_n end_POSTSUBSCRIPT = - roman_log ( divide start_ARG italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT end_POSTSUPERSCRIPT + ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_s start_POSTSUBSCRIPT neg start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
</li>
</ul>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Substitution Algorithm</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l1.1">Input:</span> Sequence <math alttext="{x}" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">{x}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">italic_x</annotation></semantics></math>, Target <math alttext="{t}" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">{t}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_t</annotation></semantics></math>, Recommendation Model <math alttext="f(i.e.,f_{e},f_{m})" class="ltx_math_unparsed" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><mrow id="alg2.l1.m3.1b"><mi id="alg2.l1.m3.1.1">f</mi><mrow id="alg2.l1.m3.1.2"><mo id="alg2.l1.m3.1.2.1" stretchy="false">(</mo><mi id="alg2.l1.m3.1.2.2">i</mi><mo id="alg2.l1.m3.1.2.3" lspace="0em" rspace="0.167em">.</mo><mi id="alg2.l1.m3.1.2.4">e</mi><mo id="alg2.l1.m3.1.2.5" lspace="0em" rspace="0.167em">.</mo><mo id="alg2.l1.m3.1.2.6">,</mo><msub id="alg2.l1.m3.1.2.7"><mi id="alg2.l1.m3.1.2.7.2">f</mi><mi id="alg2.l1.m3.1.2.7.3">e</mi></msub><mo id="alg2.l1.m3.1.2.8">,</mo><msub id="alg2.l1.m3.1.2.9"><mi id="alg2.l1.m3.1.2.9.2">f</mi><mi id="alg2.l1.m3.1.2.9.3">m</mi></msub><mo id="alg2.l1.m3.1.2.10" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">f(i.e.,f_{e},f_{m})</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_f ( italic_i . italic_e . , italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>, Search Time <math alttext="T" class="ltx_Math" display="inline" id="alg2.l1.m4.1"><semantics id="alg2.l1.m4.1a"><mi id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><ci id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m4.1d">italic_T</annotation></semantics></math> (default <math alttext="T=9" class="ltx_Math" display="inline" id="alg2.l1.m5.1"><semantics id="alg2.l1.m5.1a"><mrow id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml"><mi id="alg2.l1.m5.1.1.2" xref="alg2.l1.m5.1.1.2.cmml">T</mi><mo id="alg2.l1.m5.1.1.1" xref="alg2.l1.m5.1.1.1.cmml">=</mo><mn id="alg2.l1.m5.1.1.3" xref="alg2.l1.m5.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><apply id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1"><eq id="alg2.l1.m5.1.1.1.cmml" xref="alg2.l1.m5.1.1.1"></eq><ci id="alg2.l1.m5.1.1.2.cmml" xref="alg2.l1.m5.1.1.2">𝑇</ci><cn id="alg2.l1.m5.1.1.3.cmml" type="integer" xref="alg2.l1.m5.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">T=9</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m5.1d">italic_T = 9</annotation></semantics></math>)

</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l2.1">Output:</span> Sequence <math alttext="{x}^{\prime}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><msup id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">x</mi><mo id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">superscript</csymbol><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑥</ci><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">{x}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> with only one item replaced

</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>  Initialize polluted sequence <math alttext="x^{\prime}\leftarrow x" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><msup id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml"><mi id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">x</mi><mo id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">′</mo></msup><mo id="alg2.l3.m1.1.1.1" stretchy="false" xref="alg2.l3.m1.1.1.1.cmml">←</mo><mi id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">x</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><ci id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1">←</ci><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.2">superscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝑥</ci><ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">′</ci></apply><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">x^{\prime}\leftarrow x</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_x</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>  Compute sequence embeddings <math alttext="{\tilde{x}^{\prime}\leftarrow f_{e}(x^{\prime})}" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><msup id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mover accent="true" id="alg2.l4.m1.1.1.3.2" xref="alg2.l4.m1.1.1.3.2.cmml"><mi id="alg2.l4.m1.1.1.3.2.2" xref="alg2.l4.m1.1.1.3.2.2.cmml">x</mi><mo id="alg2.l4.m1.1.1.3.2.1" xref="alg2.l4.m1.1.1.3.2.1.cmml">~</mo></mover><mo id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">′</mo></msup><mo id="alg2.l4.m1.1.1.2" stretchy="false" xref="alg2.l4.m1.1.1.2.cmml">←</mo><mrow id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml"><msub id="alg2.l4.m1.1.1.1.3" xref="alg2.l4.m1.1.1.1.3.cmml"><mi id="alg2.l4.m1.1.1.1.3.2" xref="alg2.l4.m1.1.1.1.3.2.cmml">f</mi><mi id="alg2.l4.m1.1.1.1.3.3" xref="alg2.l4.m1.1.1.1.3.3.cmml">e</mi></msub><mo id="alg2.l4.m1.1.1.1.2" xref="alg2.l4.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l4.m1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.cmml"><mo id="alg2.l4.m1.1.1.1.1.1.2" stretchy="false" xref="alg2.l4.m1.1.1.1.1.1.1.cmml">(</mo><msup id="alg2.l4.m1.1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l4.m1.1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.1.1.2.cmml">x</mi><mo id="alg2.l4.m1.1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l4.m1.1.1.1.1.1.3" stretchy="false" xref="alg2.l4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">←</ci><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3">superscript</csymbol><apply id="alg2.l4.m1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.3.2"><ci id="alg2.l4.m1.1.1.3.2.1.cmml" xref="alg2.l4.m1.1.1.3.2.1">~</ci><ci id="alg2.l4.m1.1.1.3.2.2.cmml" xref="alg2.l4.m1.1.1.3.2.2">𝑥</ci></apply><ci id="alg2.l4.m1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.3.3">′</ci></apply><apply id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"><times id="alg2.l4.m1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.2"></times><apply id="alg2.l4.m1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.1.3.2">𝑓</ci><ci id="alg2.l4.m1.1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.1.3.3">𝑒</ci></apply><apply id="alg2.l4.m1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg2.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">{\tilde{x}^{\prime}\leftarrow f_{e}(x^{\prime})}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>  Compute gradients w.r.t. <math alttext="\tilde{x}^{\prime}" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><msup id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mover accent="true" id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mi id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">x</mi><mo id="alg2.l5.m1.1.1.2.1" xref="alg2.l5.m1.1.1.2.1.cmml">~</mo></mover><mo id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1">superscript</csymbol><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><ci id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2.1">~</ci><ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">𝑥</ci></apply><ci id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\tilde{x}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>:<math alttext="\Delta_{\tilde{x}^{\prime}}\leftarrow\Delta_{\tilde{x^{\prime}}}L_{ce}(f_{m}(%
\tilde{x}^{\prime}),t)" class="ltx_Math" display="inline" id="alg2.l5.m2.2"><semantics id="alg2.l5.m2.2a"><mrow id="alg2.l5.m2.2.2" xref="alg2.l5.m2.2.2.cmml"><msub id="alg2.l5.m2.2.2.3" xref="alg2.l5.m2.2.2.3.cmml"><mi id="alg2.l5.m2.2.2.3.2" mathvariant="normal" xref="alg2.l5.m2.2.2.3.2.cmml">Δ</mi><msup id="alg2.l5.m2.2.2.3.3" xref="alg2.l5.m2.2.2.3.3.cmml"><mover accent="true" id="alg2.l5.m2.2.2.3.3.2" xref="alg2.l5.m2.2.2.3.3.2.cmml"><mi id="alg2.l5.m2.2.2.3.3.2.2" xref="alg2.l5.m2.2.2.3.3.2.2.cmml">x</mi><mo id="alg2.l5.m2.2.2.3.3.2.1" xref="alg2.l5.m2.2.2.3.3.2.1.cmml">~</mo></mover><mo id="alg2.l5.m2.2.2.3.3.3" xref="alg2.l5.m2.2.2.3.3.3.cmml">′</mo></msup></msub><mo id="alg2.l5.m2.2.2.2" stretchy="false" xref="alg2.l5.m2.2.2.2.cmml">←</mo><mrow id="alg2.l5.m2.2.2.1" xref="alg2.l5.m2.2.2.1.cmml"><msub id="alg2.l5.m2.2.2.1.3" xref="alg2.l5.m2.2.2.1.3.cmml"><mi id="alg2.l5.m2.2.2.1.3.2" mathvariant="normal" xref="alg2.l5.m2.2.2.1.3.2.cmml">Δ</mi><mover accent="true" id="alg2.l5.m2.2.2.1.3.3" xref="alg2.l5.m2.2.2.1.3.3.cmml"><msup id="alg2.l5.m2.2.2.1.3.3.2" xref="alg2.l5.m2.2.2.1.3.3.2.cmml"><mi id="alg2.l5.m2.2.2.1.3.3.2.2" xref="alg2.l5.m2.2.2.1.3.3.2.2.cmml">x</mi><mo id="alg2.l5.m2.2.2.1.3.3.2.3" xref="alg2.l5.m2.2.2.1.3.3.2.3.cmml">′</mo></msup><mo id="alg2.l5.m2.2.2.1.3.3.1" xref="alg2.l5.m2.2.2.1.3.3.1.cmml">~</mo></mover></msub><mo id="alg2.l5.m2.2.2.1.2" xref="alg2.l5.m2.2.2.1.2.cmml">⁢</mo><msub id="alg2.l5.m2.2.2.1.4" xref="alg2.l5.m2.2.2.1.4.cmml"><mi id="alg2.l5.m2.2.2.1.4.2" xref="alg2.l5.m2.2.2.1.4.2.cmml">L</mi><mrow id="alg2.l5.m2.2.2.1.4.3" xref="alg2.l5.m2.2.2.1.4.3.cmml"><mi id="alg2.l5.m2.2.2.1.4.3.2" xref="alg2.l5.m2.2.2.1.4.3.2.cmml">c</mi><mo id="alg2.l5.m2.2.2.1.4.3.1" xref="alg2.l5.m2.2.2.1.4.3.1.cmml">⁢</mo><mi id="alg2.l5.m2.2.2.1.4.3.3" xref="alg2.l5.m2.2.2.1.4.3.3.cmml">e</mi></mrow></msub><mo id="alg2.l5.m2.2.2.1.2a" xref="alg2.l5.m2.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l5.m2.2.2.1.1.1" xref="alg2.l5.m2.2.2.1.1.2.cmml"><mo id="alg2.l5.m2.2.2.1.1.1.2" stretchy="false" xref="alg2.l5.m2.2.2.1.1.2.cmml">(</mo><mrow id="alg2.l5.m2.2.2.1.1.1.1" xref="alg2.l5.m2.2.2.1.1.1.1.cmml"><msub id="alg2.l5.m2.2.2.1.1.1.1.3" xref="alg2.l5.m2.2.2.1.1.1.1.3.cmml"><mi id="alg2.l5.m2.2.2.1.1.1.1.3.2" xref="alg2.l5.m2.2.2.1.1.1.1.3.2.cmml">f</mi><mi id="alg2.l5.m2.2.2.1.1.1.1.3.3" xref="alg2.l5.m2.2.2.1.1.1.1.3.3.cmml">m</mi></msub><mo id="alg2.l5.m2.2.2.1.1.1.1.2" xref="alg2.l5.m2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l5.m2.2.2.1.1.1.1.1.1" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="alg2.l5.m2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msup id="alg2.l5.m2.2.2.1.1.1.1.1.1.1" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.2" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.2.cmml">x</mi><mo id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.1" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mo id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.3" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="alg2.l5.m2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l5.m2.2.2.1.1.1.3" xref="alg2.l5.m2.2.2.1.1.2.cmml">,</mo><mi id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">t</mi><mo id="alg2.l5.m2.2.2.1.1.1.4" stretchy="false" xref="alg2.l5.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.2b"><apply id="alg2.l5.m2.2.2.cmml" xref="alg2.l5.m2.2.2"><ci id="alg2.l5.m2.2.2.2.cmml" xref="alg2.l5.m2.2.2.2">←</ci><apply id="alg2.l5.m2.2.2.3.cmml" xref="alg2.l5.m2.2.2.3"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.3.1.cmml" xref="alg2.l5.m2.2.2.3">subscript</csymbol><ci id="alg2.l5.m2.2.2.3.2.cmml" xref="alg2.l5.m2.2.2.3.2">Δ</ci><apply id="alg2.l5.m2.2.2.3.3.cmml" xref="alg2.l5.m2.2.2.3.3"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.3.3.1.cmml" xref="alg2.l5.m2.2.2.3.3">superscript</csymbol><apply id="alg2.l5.m2.2.2.3.3.2.cmml" xref="alg2.l5.m2.2.2.3.3.2"><ci id="alg2.l5.m2.2.2.3.3.2.1.cmml" xref="alg2.l5.m2.2.2.3.3.2.1">~</ci><ci id="alg2.l5.m2.2.2.3.3.2.2.cmml" xref="alg2.l5.m2.2.2.3.3.2.2">𝑥</ci></apply><ci id="alg2.l5.m2.2.2.3.3.3.cmml" xref="alg2.l5.m2.2.2.3.3.3">′</ci></apply></apply><apply id="alg2.l5.m2.2.2.1.cmml" xref="alg2.l5.m2.2.2.1"><times id="alg2.l5.m2.2.2.1.2.cmml" xref="alg2.l5.m2.2.2.1.2"></times><apply id="alg2.l5.m2.2.2.1.3.cmml" xref="alg2.l5.m2.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.1.3.1.cmml" xref="alg2.l5.m2.2.2.1.3">subscript</csymbol><ci id="alg2.l5.m2.2.2.1.3.2.cmml" xref="alg2.l5.m2.2.2.1.3.2">Δ</ci><apply id="alg2.l5.m2.2.2.1.3.3.cmml" xref="alg2.l5.m2.2.2.1.3.3"><ci id="alg2.l5.m2.2.2.1.3.3.1.cmml" xref="alg2.l5.m2.2.2.1.3.3.1">~</ci><apply id="alg2.l5.m2.2.2.1.3.3.2.cmml" xref="alg2.l5.m2.2.2.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.1.3.3.2.1.cmml" xref="alg2.l5.m2.2.2.1.3.3.2">superscript</csymbol><ci id="alg2.l5.m2.2.2.1.3.3.2.2.cmml" xref="alg2.l5.m2.2.2.1.3.3.2.2">𝑥</ci><ci id="alg2.l5.m2.2.2.1.3.3.2.3.cmml" xref="alg2.l5.m2.2.2.1.3.3.2.3">′</ci></apply></apply></apply><apply id="alg2.l5.m2.2.2.1.4.cmml" xref="alg2.l5.m2.2.2.1.4"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.1.4.1.cmml" xref="alg2.l5.m2.2.2.1.4">subscript</csymbol><ci id="alg2.l5.m2.2.2.1.4.2.cmml" xref="alg2.l5.m2.2.2.1.4.2">𝐿</ci><apply id="alg2.l5.m2.2.2.1.4.3.cmml" xref="alg2.l5.m2.2.2.1.4.3"><times id="alg2.l5.m2.2.2.1.4.3.1.cmml" xref="alg2.l5.m2.2.2.1.4.3.1"></times><ci id="alg2.l5.m2.2.2.1.4.3.2.cmml" xref="alg2.l5.m2.2.2.1.4.3.2">𝑐</ci><ci id="alg2.l5.m2.2.2.1.4.3.3.cmml" xref="alg2.l5.m2.2.2.1.4.3.3">𝑒</ci></apply></apply><interval closure="open" id="alg2.l5.m2.2.2.1.1.2.cmml" xref="alg2.l5.m2.2.2.1.1.1"><apply id="alg2.l5.m2.2.2.1.1.1.1.cmml" xref="alg2.l5.m2.2.2.1.1.1.1"><times id="alg2.l5.m2.2.2.1.1.1.1.2.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.2"></times><apply id="alg2.l5.m2.2.2.1.1.1.1.3.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.1.1.1.1.3.1.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="alg2.l5.m2.2.2.1.1.1.1.3.2.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.3.2">𝑓</ci><ci id="alg2.l5.m2.2.2.1.1.1.1.3.3.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.3.3">𝑚</ci></apply><apply id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2"><ci id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.1">~</ci><ci id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.2.2">𝑥</ci></apply><ci id="alg2.l5.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l5.m2.2.2.1.1.1.1.1.1.1.3">′</ci></apply></apply><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">𝑡</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.2c">\Delta_{\tilde{x}^{\prime}}\leftarrow\Delta_{\tilde{x^{\prime}}}L_{ce}(f_{m}(%
\tilde{x}^{\prime}),t)</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.2d">roman_Δ start_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ← roman_Δ start_POSTSUBSCRIPT over~ start_ARG italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_ARG end_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT italic_c italic_e end_POSTSUBSCRIPT ( italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) , italic_t )</annotation></semantics></math>;

</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>  select one most vulnerable items in <math alttext="x^{\prime}" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><msup id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml">x</mi><mo id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1">superscript</csymbol><ci id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2">𝑥</ci><ci id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">x^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>:      <math alttext="i\leftarrow argmax(||\Delta_{\tilde{x}^{\prime}}||)" class="ltx_Math" display="inline" id="alg2.l6.m2.1"><semantics id="alg2.l6.m2.1a"><mrow id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml"><mi id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml">i</mi><mo id="alg2.l6.m2.1.1.2" stretchy="false" xref="alg2.l6.m2.1.1.2.cmml">←</mo><mrow id="alg2.l6.m2.1.1.1" xref="alg2.l6.m2.1.1.1.cmml"><mi id="alg2.l6.m2.1.1.1.3" xref="alg2.l6.m2.1.1.1.3.cmml">a</mi><mo id="alg2.l6.m2.1.1.1.2" xref="alg2.l6.m2.1.1.1.2.cmml">⁢</mo><mi id="alg2.l6.m2.1.1.1.4" xref="alg2.l6.m2.1.1.1.4.cmml">r</mi><mo id="alg2.l6.m2.1.1.1.2a" xref="alg2.l6.m2.1.1.1.2.cmml">⁢</mo><mi id="alg2.l6.m2.1.1.1.5" xref="alg2.l6.m2.1.1.1.5.cmml">g</mi><mo id="alg2.l6.m2.1.1.1.2b" xref="alg2.l6.m2.1.1.1.2.cmml">⁢</mo><mi id="alg2.l6.m2.1.1.1.6" xref="alg2.l6.m2.1.1.1.6.cmml">m</mi><mo id="alg2.l6.m2.1.1.1.2c" xref="alg2.l6.m2.1.1.1.2.cmml">⁢</mo><mi id="alg2.l6.m2.1.1.1.7" xref="alg2.l6.m2.1.1.1.7.cmml">a</mi><mo id="alg2.l6.m2.1.1.1.2d" xref="alg2.l6.m2.1.1.1.2.cmml">⁢</mo><mi id="alg2.l6.m2.1.1.1.8" xref="alg2.l6.m2.1.1.1.8.cmml">x</mi><mo id="alg2.l6.m2.1.1.1.2e" xref="alg2.l6.m2.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l6.m2.1.1.1.1.1" xref="alg2.l6.m2.1.1.1.cmml"><mo id="alg2.l6.m2.1.1.1.1.1.2" stretchy="false" xref="alg2.l6.m2.1.1.1.cmml">(</mo><mrow id="alg2.l6.m2.1.1.1.1.1.1.1" xref="alg2.l6.m2.1.1.1.1.1.1.2.cmml"><mo id="alg2.l6.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="alg2.l6.m2.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="alg2.l6.m2.1.1.1.1.1.1.1.1" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l6.m2.1.1.1.1.1.1.1.1.2" mathvariant="normal" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.2.cmml">Δ</mi><msup id="alg2.l6.m2.1.1.1.1.1.1.1.1.3" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.2" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.2.cmml">x</mi><mo id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.1" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.1.cmml">~</mo></mover><mo id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.3" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo id="alg2.l6.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="alg2.l6.m2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="alg2.l6.m2.1.1.1.1.1.3" stretchy="false" xref="alg2.l6.m2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"><ci id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2">←</ci><ci id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3">𝑖</ci><apply id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1.1"><times id="alg2.l6.m2.1.1.1.2.cmml" xref="alg2.l6.m2.1.1.1.2"></times><ci id="alg2.l6.m2.1.1.1.3.cmml" xref="alg2.l6.m2.1.1.1.3">𝑎</ci><ci id="alg2.l6.m2.1.1.1.4.cmml" xref="alg2.l6.m2.1.1.1.4">𝑟</ci><ci id="alg2.l6.m2.1.1.1.5.cmml" xref="alg2.l6.m2.1.1.1.5">𝑔</ci><ci id="alg2.l6.m2.1.1.1.6.cmml" xref="alg2.l6.m2.1.1.1.6">𝑚</ci><ci id="alg2.l6.m2.1.1.1.7.cmml" xref="alg2.l6.m2.1.1.1.7">𝑎</ci><ci id="alg2.l6.m2.1.1.1.8.cmml" xref="alg2.l6.m2.1.1.1.8">𝑥</ci><apply id="alg2.l6.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="alg2.l6.m2.1.1.1.1.1.1.2.1.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="alg2.l6.m2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m2.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.2">Δ</ci><apply id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2"><ci id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.1">~</ci><ci id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.2.2">𝑥</ci></apply><ci id="alg2.l6.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l6.m2.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">i\leftarrow argmax(||\Delta_{\tilde{x}^{\prime}}||)</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m2.1d">italic_i ← italic_a italic_r italic_g italic_m italic_a italic_x ( | | roman_Δ start_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT | | )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>  Compute cosine similarity <math alttext="s" class="ltx_Math" display="inline" id="alg2.l7.m1.1"><semantics id="alg2.l7.m1.1a"><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="alg2.l7.m1.1d">italic_s</annotation></semantics></math>:

<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="s\leftarrow\text{CosSim}\left(\tilde{x}_{i}^{\prime}-\text{sign}(\nabla_{%
\tilde{x}_{i}^{\prime}}),f_{e}(c)\right)\quad\forall c\in\mathcal{I}" class="ltx_Math" display="block" id="Sx4.Ex8.m1.3"><semantics id="Sx4.Ex8.m1.3a"><mrow id="Sx4.Ex8.m1.3.3.2" xref="Sx4.Ex8.m1.3.3.3.cmml"><mrow id="Sx4.Ex8.m1.2.2.1.1" xref="Sx4.Ex8.m1.2.2.1.1.cmml"><mi id="Sx4.Ex8.m1.2.2.1.1.4" xref="Sx4.Ex8.m1.2.2.1.1.4.cmml">s</mi><mo id="Sx4.Ex8.m1.2.2.1.1.3" stretchy="false" xref="Sx4.Ex8.m1.2.2.1.1.3.cmml">←</mo><mrow id="Sx4.Ex8.m1.2.2.1.1.2" xref="Sx4.Ex8.m1.2.2.1.1.2.cmml"><mtext id="Sx4.Ex8.m1.2.2.1.1.2.4" xref="Sx4.Ex8.m1.2.2.1.1.2.4a.cmml">CosSim</mtext><mo id="Sx4.Ex8.m1.2.2.1.1.2.3" xref="Sx4.Ex8.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="Sx4.Ex8.m1.2.2.1.1.2.2.2" xref="Sx4.Ex8.m1.2.2.1.1.2.2.3.cmml"><mo id="Sx4.Ex8.m1.2.2.1.1.2.2.2.3" xref="Sx4.Ex8.m1.2.2.1.1.2.2.3.cmml">(</mo><mrow id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.cmml"><msubsup id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.cmml"><mover accent="true" id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.cmml"><mi id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.2" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.2.cmml">x</mi><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.1" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.3" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.3" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.3.cmml">′</mo></msubsup><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.2" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.2.cmml">−</mo><mrow id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.cmml"><mtext id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.3" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.3a.cmml">sign</mtext><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.2" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">∇</mo><msubsup id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.2" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml">x</mi><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.1" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">′</mo></msubsup></msub><mo id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx4.Ex8.m1.2.2.1.1.2.2.2.4" xref="Sx4.Ex8.m1.2.2.1.1.2.2.3.cmml">,</mo><mrow id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.cmml"><msub id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.cmml"><mi id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.2" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.2.cmml">f</mi><mi id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.3" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.3.cmml">e</mi></msub><mo id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.1" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.3.2" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.cmml"><mo id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.3.2.1" stretchy="false" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.cmml">(</mo><mi id="Sx4.Ex8.m1.1.1" xref="Sx4.Ex8.m1.1.1.cmml">c</mi><mo id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.3.2.2" stretchy="false" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="Sx4.Ex8.m1.2.2.1.1.2.2.2.5" xref="Sx4.Ex8.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mspace id="Sx4.Ex8.m1.3.3.2.3" width="1.167em" xref="Sx4.Ex8.m1.3.3.3a.cmml"></mspace><mrow id="Sx4.Ex8.m1.3.3.2.2" xref="Sx4.Ex8.m1.3.3.2.2.cmml"><mrow id="Sx4.Ex8.m1.3.3.2.2.2" xref="Sx4.Ex8.m1.3.3.2.2.2.cmml"><mo id="Sx4.Ex8.m1.3.3.2.2.2.1" rspace="0.167em" xref="Sx4.Ex8.m1.3.3.2.2.2.1.cmml">∀</mo><mi id="Sx4.Ex8.m1.3.3.2.2.2.2" xref="Sx4.Ex8.m1.3.3.2.2.2.2.cmml">c</mi></mrow><mo id="Sx4.Ex8.m1.3.3.2.2.1" xref="Sx4.Ex8.m1.3.3.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="Sx4.Ex8.m1.3.3.2.2.3" xref="Sx4.Ex8.m1.3.3.2.2.3.cmml">ℐ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex8.m1.3b"><apply id="Sx4.Ex8.m1.3.3.3.cmml" xref="Sx4.Ex8.m1.3.3.2"><csymbol cd="ambiguous" id="Sx4.Ex8.m1.3.3.3a.cmml" xref="Sx4.Ex8.m1.3.3.2.3">formulae-sequence</csymbol><apply id="Sx4.Ex8.m1.2.2.1.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1"><ci id="Sx4.Ex8.m1.2.2.1.1.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.3">←</ci><ci id="Sx4.Ex8.m1.2.2.1.1.4.cmml" xref="Sx4.Ex8.m1.2.2.1.1.4">𝑠</ci><apply id="Sx4.Ex8.m1.2.2.1.1.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2"><times id="Sx4.Ex8.m1.2.2.1.1.2.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.3"></times><ci id="Sx4.Ex8.m1.2.2.1.1.2.4a.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.4"><mtext id="Sx4.Ex8.m1.2.2.1.1.2.4.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.4">CosSim</mtext></ci><interval closure="open" id="Sx4.Ex8.m1.2.2.1.1.2.2.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2"><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1"><minus id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.2"></minus><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2"><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.1">~</ci><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.2.2">𝑥</ci></apply><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.3.3">′</ci></apply><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1"><times id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.2"></times><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.3a.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.3"><mtext id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.3">sign</mtext></ci><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">∇</ci><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2"><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.1">~</ci><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.2.2">𝑥</ci></apply><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3">′</ci></apply></apply></apply></apply><apply id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2"><times id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.1"></times><apply id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2">subscript</csymbol><ci id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.2">𝑓</ci><ci id="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="Sx4.Ex8.m1.2.2.1.1.2.2.2.2.2.3">𝑒</ci></apply><ci id="Sx4.Ex8.m1.1.1.cmml" xref="Sx4.Ex8.m1.1.1">𝑐</ci></apply></interval></apply></apply><apply id="Sx4.Ex8.m1.3.3.2.2.cmml" xref="Sx4.Ex8.m1.3.3.2.2"><in id="Sx4.Ex8.m1.3.3.2.2.1.cmml" xref="Sx4.Ex8.m1.3.3.2.2.1"></in><apply id="Sx4.Ex8.m1.3.3.2.2.2.cmml" xref="Sx4.Ex8.m1.3.3.2.2.2"><csymbol cd="latexml" id="Sx4.Ex8.m1.3.3.2.2.2.1.cmml" xref="Sx4.Ex8.m1.3.3.2.2.2.1">for-all</csymbol><ci id="Sx4.Ex8.m1.3.3.2.2.2.2.cmml" xref="Sx4.Ex8.m1.3.3.2.2.2.2">𝑐</ci></apply><ci id="Sx4.Ex8.m1.3.3.2.2.3.cmml" xref="Sx4.Ex8.m1.3.3.2.2.3">ℐ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex8.m1.3c">s\leftarrow\text{CosSim}\left(\tilde{x}_{i}^{\prime}-\text{sign}(\nabla_{%
\tilde{x}_{i}^{\prime}}),f_{e}(c)\right)\quad\forall c\in\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex8.m1.3d">italic_s ← CosSim ( over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT - sign ( ∇ start_POSTSUBSCRIPT over~ start_ARG italic_x end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ) , italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( italic_c ) ) ∀ italic_c ∈ caligraphic_I</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>  <span class="ltx_text" id="alg2.l8.1">Impose similarity constraint </span> <math alttext="s_{c}:" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mrow id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><msub id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml"><mi id="alg2.l8.m1.1.1.2.2" xref="alg2.l8.m1.1.1.2.2.cmml">s</mi><mi id="alg2.l8.m1.1.1.2.3" xref="alg2.l8.m1.1.1.2.3.cmml">c</mi></msub><mo id="alg2.l8.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="alg2.l8.m1.1.1.1.cmml">:</mo><mi id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><ci id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1">:</ci><apply id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.2.1.cmml" xref="alg2.l8.m1.1.1.2">subscript</csymbol><ci id="alg2.l8.m1.1.1.2.2.cmml" xref="alg2.l8.m1.1.1.2.2">𝑠</ci><ci id="alg2.l8.m1.1.1.2.3.cmml" xref="alg2.l8.m1.1.1.2.3">𝑐</ci></apply><csymbol cd="latexml" id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">s_{c}:</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">italic_s start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT :</annotation></semantics></math>      <math alttext="s_{c}\leftarrow\mathbf{1}\left(\text{CosSim}(\mathbf{x}_{i}^{\prime},f_{e}(%
\mathbf{c}))\geq\tau\right)\quad\forall\mathbf{c}\in\mathcal{I}" class="ltx_Math" display="inline" id="alg2.l8.m2.3"><semantics id="alg2.l8.m2.3a"><mrow id="alg2.l8.m2.3.3.2" xref="alg2.l8.m2.3.3.3.cmml"><mrow id="alg2.l8.m2.2.2.1.1" xref="alg2.l8.m2.2.2.1.1.cmml"><msub id="alg2.l8.m2.2.2.1.1.3" xref="alg2.l8.m2.2.2.1.1.3.cmml"><mi id="alg2.l8.m2.2.2.1.1.3.2" xref="alg2.l8.m2.2.2.1.1.3.2.cmml">s</mi><mi id="alg2.l8.m2.2.2.1.1.3.3" xref="alg2.l8.m2.2.2.1.1.3.3.cmml">c</mi></msub><mo id="alg2.l8.m2.2.2.1.1.2" stretchy="false" xref="alg2.l8.m2.2.2.1.1.2.cmml">←</mo><mrow id="alg2.l8.m2.2.2.1.1.1" xref="alg2.l8.m2.2.2.1.1.1.cmml"><mn id="alg2.l8.m2.2.2.1.1.1.3" xref="alg2.l8.m2.2.2.1.1.1.3.cmml">𝟏</mn><mo id="alg2.l8.m2.2.2.1.1.1.2" xref="alg2.l8.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l8.m2.2.2.1.1.1.1.1" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.cmml"><mo id="alg2.l8.m2.2.2.1.1.1.1.1.2" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l8.m2.2.2.1.1.1.1.1.1" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.cmml"><mrow id="alg2.l8.m2.2.2.1.1.1.1.1.1.2" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.cmml"><mtext id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.4" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.4a.cmml">CosSim</mtext><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.3" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.3.cmml"><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.4" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml"><msub id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.2" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.2.cmml">f</mi><mi id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.3" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.3.cmml">e</mi></msub><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.1" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.2" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml"><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.2.1" stretchy="false" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="alg2.l8.m2.1.1" xref="alg2.l8.m2.1.1.cmml">𝐜</mi><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.2.2" stretchy="false" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.5" stretchy="false" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg2.l8.m2.2.2.1.1.1.1.1.1.3" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.3.cmml">≥</mo><mi id="alg2.l8.m2.2.2.1.1.1.1.1.1.4" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.4.cmml">τ</mi></mrow><mo id="alg2.l8.m2.2.2.1.1.1.1.1.3" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="alg2.l8.m2.3.3.2.3" width="1.167em" xref="alg2.l8.m2.3.3.3a.cmml"></mspace><mrow id="alg2.l8.m2.3.3.2.2" xref="alg2.l8.m2.3.3.2.2.cmml"><mrow id="alg2.l8.m2.3.3.2.2.2" xref="alg2.l8.m2.3.3.2.2.2.cmml"><mo id="alg2.l8.m2.3.3.2.2.2.1" rspace="0.167em" xref="alg2.l8.m2.3.3.2.2.2.1.cmml">∀</mo><mi id="alg2.l8.m2.3.3.2.2.2.2" xref="alg2.l8.m2.3.3.2.2.2.2.cmml">𝐜</mi></mrow><mo id="alg2.l8.m2.3.3.2.2.1" xref="alg2.l8.m2.3.3.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m2.3.3.2.2.3" xref="alg2.l8.m2.3.3.2.2.3.cmml">ℐ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.3b"><apply id="alg2.l8.m2.3.3.3.cmml" xref="alg2.l8.m2.3.3.2"><csymbol cd="ambiguous" id="alg2.l8.m2.3.3.3a.cmml" xref="alg2.l8.m2.3.3.2.3">formulae-sequence</csymbol><apply id="alg2.l8.m2.2.2.1.1.cmml" xref="alg2.l8.m2.2.2.1.1"><ci id="alg2.l8.m2.2.2.1.1.2.cmml" xref="alg2.l8.m2.2.2.1.1.2">←</ci><apply id="alg2.l8.m2.2.2.1.1.3.cmml" xref="alg2.l8.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="alg2.l8.m2.2.2.1.1.3.1.cmml" xref="alg2.l8.m2.2.2.1.1.3">subscript</csymbol><ci id="alg2.l8.m2.2.2.1.1.3.2.cmml" xref="alg2.l8.m2.2.2.1.1.3.2">𝑠</ci><ci id="alg2.l8.m2.2.2.1.1.3.3.cmml" xref="alg2.l8.m2.2.2.1.1.3.3">𝑐</ci></apply><apply id="alg2.l8.m2.2.2.1.1.1.cmml" xref="alg2.l8.m2.2.2.1.1.1"><times id="alg2.l8.m2.2.2.1.1.1.2.cmml" xref="alg2.l8.m2.2.2.1.1.1.2"></times><cn id="alg2.l8.m2.2.2.1.1.1.3.cmml" type="integer" xref="alg2.l8.m2.2.2.1.1.1.3">1</cn><apply id="alg2.l8.m2.2.2.1.1.1.1.1.1.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1"><geq id="alg2.l8.m2.2.2.1.1.1.1.1.1.3.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.3"></geq><apply id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2"><times id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.3"></times><ci id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.4a.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.4"><mtext id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.4.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.4">CosSim</mtext></ci><interval closure="open" id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2"><apply id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2"><times id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.1"></times><apply id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.2">𝑓</ci><ci id="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.3">𝑒</ci></apply><ci id="alg2.l8.m2.1.1.cmml" xref="alg2.l8.m2.1.1">𝐜</ci></apply></interval></apply><ci id="alg2.l8.m2.2.2.1.1.1.1.1.1.4.cmml" xref="alg2.l8.m2.2.2.1.1.1.1.1.1.4">𝜏</ci></apply></apply></apply><apply id="alg2.l8.m2.3.3.2.2.cmml" xref="alg2.l8.m2.3.3.2.2"><in id="alg2.l8.m2.3.3.2.2.1.cmml" xref="alg2.l8.m2.3.3.2.2.1"></in><apply id="alg2.l8.m2.3.3.2.2.2.cmml" xref="alg2.l8.m2.3.3.2.2.2"><csymbol cd="latexml" id="alg2.l8.m2.3.3.2.2.2.1.cmml" xref="alg2.l8.m2.3.3.2.2.2.1">for-all</csymbol><ci id="alg2.l8.m2.3.3.2.2.2.2.cmml" xref="alg2.l8.m2.3.3.2.2.2.2">𝐜</ci></apply><ci id="alg2.l8.m2.3.3.2.2.3.cmml" xref="alg2.l8.m2.3.3.2.2.3">ℐ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.3c">s_{c}\leftarrow\mathbf{1}\left(\text{CosSim}(\mathbf{x}_{i}^{\prime},f_{e}(%
\mathbf{c}))\geq\tau\right)\quad\forall\mathbf{c}\in\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m2.3d">italic_s start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT ← bold_1 ( CosSim ( bold_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_f start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ( bold_c ) ) ≥ italic_τ ) ∀ bold_c ∈ caligraphic_I</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>  Update cosine similarity <math alttext="s" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><mi id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><ci id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_s</annotation></semantics></math>: <math alttext="s\leftarrow s\odot s_{c}" class="ltx_Math" display="inline" id="alg2.l9.m2.1"><semantics id="alg2.l9.m2.1a"><mrow id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml"><mi id="alg2.l9.m2.1.1.2" xref="alg2.l9.m2.1.1.2.cmml">s</mi><mo id="alg2.l9.m2.1.1.1" stretchy="false" xref="alg2.l9.m2.1.1.1.cmml">←</mo><mrow id="alg2.l9.m2.1.1.3" xref="alg2.l9.m2.1.1.3.cmml"><mi id="alg2.l9.m2.1.1.3.2" xref="alg2.l9.m2.1.1.3.2.cmml">s</mi><mo id="alg2.l9.m2.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="alg2.l9.m2.1.1.3.1.cmml">⊙</mo><msub id="alg2.l9.m2.1.1.3.3" xref="alg2.l9.m2.1.1.3.3.cmml"><mi id="alg2.l9.m2.1.1.3.3.2" xref="alg2.l9.m2.1.1.3.3.2.cmml">s</mi><mi id="alg2.l9.m2.1.1.3.3.3" xref="alg2.l9.m2.1.1.3.3.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><apply id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1"><ci id="alg2.l9.m2.1.1.1.cmml" xref="alg2.l9.m2.1.1.1">←</ci><ci id="alg2.l9.m2.1.1.2.cmml" xref="alg2.l9.m2.1.1.2">𝑠</ci><apply id="alg2.l9.m2.1.1.3.cmml" xref="alg2.l9.m2.1.1.3"><csymbol cd="latexml" id="alg2.l9.m2.1.1.3.1.cmml" xref="alg2.l9.m2.1.1.3.1">direct-product</csymbol><ci id="alg2.l9.m2.1.1.3.2.cmml" xref="alg2.l9.m2.1.1.3.2">𝑠</ci><apply id="alg2.l9.m2.1.1.3.3.cmml" xref="alg2.l9.m2.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.3.3.1.cmml" xref="alg2.l9.m2.1.1.3.3">subscript</csymbol><ci id="alg2.l9.m2.1.1.3.3.2.cmml" xref="alg2.l9.m2.1.1.3.3.2">𝑠</ci><ci id="alg2.l9.m2.1.1.3.3.3.cmml" xref="alg2.l9.m2.1.1.3.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">s\leftarrow s\odot s_{c}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m2.1d">italic_s ← italic_s ⊙ italic_s start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>  Compute similarity ranking indice:     <math alttext="s_{indice}\leftarrow argsort(s,descending)" class="ltx_Math" display="inline" id="alg2.l10.m1.2"><semantics id="alg2.l10.m1.2a"><mrow id="alg2.l10.m1.2.2" xref="alg2.l10.m1.2.2.cmml"><msub id="alg2.l10.m1.2.2.3" xref="alg2.l10.m1.2.2.3.cmml"><mi id="alg2.l10.m1.2.2.3.2" xref="alg2.l10.m1.2.2.3.2.cmml">s</mi><mrow id="alg2.l10.m1.2.2.3.3" xref="alg2.l10.m1.2.2.3.3.cmml"><mi id="alg2.l10.m1.2.2.3.3.2" xref="alg2.l10.m1.2.2.3.3.2.cmml">i</mi><mo id="alg2.l10.m1.2.2.3.3.1" xref="alg2.l10.m1.2.2.3.3.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.3.3.3" xref="alg2.l10.m1.2.2.3.3.3.cmml">n</mi><mo id="alg2.l10.m1.2.2.3.3.1a" xref="alg2.l10.m1.2.2.3.3.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.3.3.4" xref="alg2.l10.m1.2.2.3.3.4.cmml">d</mi><mo id="alg2.l10.m1.2.2.3.3.1b" xref="alg2.l10.m1.2.2.3.3.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.3.3.5" xref="alg2.l10.m1.2.2.3.3.5.cmml">i</mi><mo id="alg2.l10.m1.2.2.3.3.1c" xref="alg2.l10.m1.2.2.3.3.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.3.3.6" xref="alg2.l10.m1.2.2.3.3.6.cmml">c</mi><mo id="alg2.l10.m1.2.2.3.3.1d" xref="alg2.l10.m1.2.2.3.3.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.3.3.7" xref="alg2.l10.m1.2.2.3.3.7.cmml">e</mi></mrow></msub><mo id="alg2.l10.m1.2.2.2" stretchy="false" xref="alg2.l10.m1.2.2.2.cmml">←</mo><mrow id="alg2.l10.m1.2.2.1" xref="alg2.l10.m1.2.2.1.cmml"><mi id="alg2.l10.m1.2.2.1.3" xref="alg2.l10.m1.2.2.1.3.cmml">a</mi><mo id="alg2.l10.m1.2.2.1.2" xref="alg2.l10.m1.2.2.1.2.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.4" xref="alg2.l10.m1.2.2.1.4.cmml">r</mi><mo id="alg2.l10.m1.2.2.1.2a" xref="alg2.l10.m1.2.2.1.2.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.5" xref="alg2.l10.m1.2.2.1.5.cmml">g</mi><mo id="alg2.l10.m1.2.2.1.2b" xref="alg2.l10.m1.2.2.1.2.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.6" xref="alg2.l10.m1.2.2.1.6.cmml">s</mi><mo id="alg2.l10.m1.2.2.1.2c" xref="alg2.l10.m1.2.2.1.2.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.7" xref="alg2.l10.m1.2.2.1.7.cmml">o</mi><mo id="alg2.l10.m1.2.2.1.2d" xref="alg2.l10.m1.2.2.1.2.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.8" xref="alg2.l10.m1.2.2.1.8.cmml">r</mi><mo id="alg2.l10.m1.2.2.1.2e" xref="alg2.l10.m1.2.2.1.2.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.9" xref="alg2.l10.m1.2.2.1.9.cmml">t</mi><mo id="alg2.l10.m1.2.2.1.2f" xref="alg2.l10.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l10.m1.2.2.1.1.1" xref="alg2.l10.m1.2.2.1.1.2.cmml"><mo id="alg2.l10.m1.2.2.1.1.1.2" stretchy="false" xref="alg2.l10.m1.2.2.1.1.2.cmml">(</mo><mi id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">s</mi><mo id="alg2.l10.m1.2.2.1.1.1.3" xref="alg2.l10.m1.2.2.1.1.2.cmml">,</mo><mrow id="alg2.l10.m1.2.2.1.1.1.1" xref="alg2.l10.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l10.m1.2.2.1.1.1.1.2" xref="alg2.l10.m1.2.2.1.1.1.1.2.cmml">d</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.3" xref="alg2.l10.m1.2.2.1.1.1.1.3.cmml">e</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1a" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.4" xref="alg2.l10.m1.2.2.1.1.1.1.4.cmml">s</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1b" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.5" xref="alg2.l10.m1.2.2.1.1.1.1.5.cmml">c</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1c" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.6" xref="alg2.l10.m1.2.2.1.1.1.1.6.cmml">e</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1d" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.7" xref="alg2.l10.m1.2.2.1.1.1.1.7.cmml">n</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1e" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.8" xref="alg2.l10.m1.2.2.1.1.1.1.8.cmml">d</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1f" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.9" xref="alg2.l10.m1.2.2.1.1.1.1.9.cmml">i</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1g" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.10" xref="alg2.l10.m1.2.2.1.1.1.1.10.cmml">n</mi><mo id="alg2.l10.m1.2.2.1.1.1.1.1h" xref="alg2.l10.m1.2.2.1.1.1.1.1.cmml">⁢</mo><mi id="alg2.l10.m1.2.2.1.1.1.1.11" xref="alg2.l10.m1.2.2.1.1.1.1.11.cmml">g</mi></mrow><mo id="alg2.l10.m1.2.2.1.1.1.4" stretchy="false" xref="alg2.l10.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.2b"><apply id="alg2.l10.m1.2.2.cmml" xref="alg2.l10.m1.2.2"><ci id="alg2.l10.m1.2.2.2.cmml" xref="alg2.l10.m1.2.2.2">←</ci><apply id="alg2.l10.m1.2.2.3.cmml" xref="alg2.l10.m1.2.2.3"><csymbol cd="ambiguous" id="alg2.l10.m1.2.2.3.1.cmml" xref="alg2.l10.m1.2.2.3">subscript</csymbol><ci id="alg2.l10.m1.2.2.3.2.cmml" xref="alg2.l10.m1.2.2.3.2">𝑠</ci><apply id="alg2.l10.m1.2.2.3.3.cmml" xref="alg2.l10.m1.2.2.3.3"><times id="alg2.l10.m1.2.2.3.3.1.cmml" xref="alg2.l10.m1.2.2.3.3.1"></times><ci id="alg2.l10.m1.2.2.3.3.2.cmml" xref="alg2.l10.m1.2.2.3.3.2">𝑖</ci><ci id="alg2.l10.m1.2.2.3.3.3.cmml" xref="alg2.l10.m1.2.2.3.3.3">𝑛</ci><ci id="alg2.l10.m1.2.2.3.3.4.cmml" xref="alg2.l10.m1.2.2.3.3.4">𝑑</ci><ci id="alg2.l10.m1.2.2.3.3.5.cmml" xref="alg2.l10.m1.2.2.3.3.5">𝑖</ci><ci id="alg2.l10.m1.2.2.3.3.6.cmml" xref="alg2.l10.m1.2.2.3.3.6">𝑐</ci><ci id="alg2.l10.m1.2.2.3.3.7.cmml" xref="alg2.l10.m1.2.2.3.3.7">𝑒</ci></apply></apply><apply id="alg2.l10.m1.2.2.1.cmml" xref="alg2.l10.m1.2.2.1"><times id="alg2.l10.m1.2.2.1.2.cmml" xref="alg2.l10.m1.2.2.1.2"></times><ci id="alg2.l10.m1.2.2.1.3.cmml" xref="alg2.l10.m1.2.2.1.3">𝑎</ci><ci id="alg2.l10.m1.2.2.1.4.cmml" xref="alg2.l10.m1.2.2.1.4">𝑟</ci><ci id="alg2.l10.m1.2.2.1.5.cmml" xref="alg2.l10.m1.2.2.1.5">𝑔</ci><ci id="alg2.l10.m1.2.2.1.6.cmml" xref="alg2.l10.m1.2.2.1.6">𝑠</ci><ci id="alg2.l10.m1.2.2.1.7.cmml" xref="alg2.l10.m1.2.2.1.7">𝑜</ci><ci id="alg2.l10.m1.2.2.1.8.cmml" xref="alg2.l10.m1.2.2.1.8">𝑟</ci><ci id="alg2.l10.m1.2.2.1.9.cmml" xref="alg2.l10.m1.2.2.1.9">𝑡</ci><interval closure="open" id="alg2.l10.m1.2.2.1.1.2.cmml" xref="alg2.l10.m1.2.2.1.1.1"><ci id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">𝑠</ci><apply id="alg2.l10.m1.2.2.1.1.1.1.cmml" xref="alg2.l10.m1.2.2.1.1.1.1"><times id="alg2.l10.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.1"></times><ci id="alg2.l10.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.2">𝑑</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.3">𝑒</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.4.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.4">𝑠</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.5.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.5">𝑐</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.6.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.6">𝑒</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.7.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.7">𝑛</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.8.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.8">𝑑</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.9.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.9">𝑖</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.10.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.10">𝑛</ci><ci id="alg2.l10.m1.2.2.1.1.1.1.11.cmml" xref="alg2.l10.m1.2.2.1.1.1.1.11">𝑔</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.2c">s_{indice}\leftarrow argsort(s,descending)</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.2d">italic_s start_POSTSUBSCRIPT italic_i italic_n italic_d italic_i italic_c italic_e end_POSTSUBSCRIPT ← italic_a italic_r italic_g italic_s italic_o italic_r italic_t ( italic_s , italic_d italic_e italic_s italic_c italic_e italic_n italic_d italic_i italic_n italic_g )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>  Set target scores <math alttext="target_{scores}\leftarrow-np.inf" class="ltx_Math" display="inline" id="alg2.l11.m1.2"><semantics id="alg2.l11.m1.2a"><mrow id="alg2.l11.m1.2.2.2" xref="alg2.l11.m1.2.2.3.cmml"><mrow id="alg2.l11.m1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.cmml"><mrow id="alg2.l11.m1.1.1.1.1.2" xref="alg2.l11.m1.1.1.1.1.2.cmml"><mi id="alg2.l11.m1.1.1.1.1.2.2" xref="alg2.l11.m1.1.1.1.1.2.2.cmml">t</mi><mo id="alg2.l11.m1.1.1.1.1.2.1" xref="alg2.l11.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.3" xref="alg2.l11.m1.1.1.1.1.2.3.cmml">a</mi><mo id="alg2.l11.m1.1.1.1.1.2.1a" xref="alg2.l11.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.4" xref="alg2.l11.m1.1.1.1.1.2.4.cmml">r</mi><mo id="alg2.l11.m1.1.1.1.1.2.1b" xref="alg2.l11.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.5" xref="alg2.l11.m1.1.1.1.1.2.5.cmml">g</mi><mo id="alg2.l11.m1.1.1.1.1.2.1c" xref="alg2.l11.m1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.6" xref="alg2.l11.m1.1.1.1.1.2.6.cmml">e</mi><mo id="alg2.l11.m1.1.1.1.1.2.1d" xref="alg2.l11.m1.1.1.1.1.2.1.cmml">⁢</mo><msub id="alg2.l11.m1.1.1.1.1.2.7" xref="alg2.l11.m1.1.1.1.1.2.7.cmml"><mi id="alg2.l11.m1.1.1.1.1.2.7.2" xref="alg2.l11.m1.1.1.1.1.2.7.2.cmml">t</mi><mrow id="alg2.l11.m1.1.1.1.1.2.7.3" xref="alg2.l11.m1.1.1.1.1.2.7.3.cmml"><mi id="alg2.l11.m1.1.1.1.1.2.7.3.2" xref="alg2.l11.m1.1.1.1.1.2.7.3.2.cmml">s</mi><mo id="alg2.l11.m1.1.1.1.1.2.7.3.1" xref="alg2.l11.m1.1.1.1.1.2.7.3.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.7.3.3" xref="alg2.l11.m1.1.1.1.1.2.7.3.3.cmml">c</mi><mo id="alg2.l11.m1.1.1.1.1.2.7.3.1a" xref="alg2.l11.m1.1.1.1.1.2.7.3.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.7.3.4" xref="alg2.l11.m1.1.1.1.1.2.7.3.4.cmml">o</mi><mo id="alg2.l11.m1.1.1.1.1.2.7.3.1b" xref="alg2.l11.m1.1.1.1.1.2.7.3.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.7.3.5" xref="alg2.l11.m1.1.1.1.1.2.7.3.5.cmml">r</mi><mo id="alg2.l11.m1.1.1.1.1.2.7.3.1c" xref="alg2.l11.m1.1.1.1.1.2.7.3.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.7.3.6" xref="alg2.l11.m1.1.1.1.1.2.7.3.6.cmml">e</mi><mo id="alg2.l11.m1.1.1.1.1.2.7.3.1d" xref="alg2.l11.m1.1.1.1.1.2.7.3.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.2.7.3.7" xref="alg2.l11.m1.1.1.1.1.2.7.3.7.cmml">s</mi></mrow></msub></mrow><mo id="alg2.l11.m1.1.1.1.1.1" stretchy="false" xref="alg2.l11.m1.1.1.1.1.1.cmml">←</mo><mrow id="alg2.l11.m1.1.1.1.1.3" xref="alg2.l11.m1.1.1.1.1.3.cmml"><mo id="alg2.l11.m1.1.1.1.1.3a" xref="alg2.l11.m1.1.1.1.1.3.cmml">−</mo><mrow id="alg2.l11.m1.1.1.1.1.3.2" xref="alg2.l11.m1.1.1.1.1.3.2.cmml"><mi id="alg2.l11.m1.1.1.1.1.3.2.2" xref="alg2.l11.m1.1.1.1.1.3.2.2.cmml">n</mi><mo id="alg2.l11.m1.1.1.1.1.3.2.1" xref="alg2.l11.m1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.1.1.1.1.3.2.3" xref="alg2.l11.m1.1.1.1.1.3.2.3.cmml">p</mi></mrow></mrow></mrow><mo id="alg2.l11.m1.2.2.2.3" lspace="0em" rspace="0.167em" xref="alg2.l11.m1.2.2.3a.cmml">.</mo><mrow id="alg2.l11.m1.2.2.2.2" xref="alg2.l11.m1.2.2.2.2.cmml"><mi id="alg2.l11.m1.2.2.2.2.2" xref="alg2.l11.m1.2.2.2.2.2.cmml">i</mi><mo id="alg2.l11.m1.2.2.2.2.1" xref="alg2.l11.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.2.2.2.2.3" xref="alg2.l11.m1.2.2.2.2.3.cmml">n</mi><mo id="alg2.l11.m1.2.2.2.2.1a" xref="alg2.l11.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg2.l11.m1.2.2.2.2.4" xref="alg2.l11.m1.2.2.2.2.4.cmml">f</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.2b"><apply id="alg2.l11.m1.2.2.3.cmml" xref="alg2.l11.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l11.m1.2.2.3a.cmml" xref="alg2.l11.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.l11.m1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1"><ci id="alg2.l11.m1.1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1.1">←</ci><apply id="alg2.l11.m1.1.1.1.1.2.cmml" xref="alg2.l11.m1.1.1.1.1.2"><times id="alg2.l11.m1.1.1.1.1.2.1.cmml" xref="alg2.l11.m1.1.1.1.1.2.1"></times><ci id="alg2.l11.m1.1.1.1.1.2.2.cmml" xref="alg2.l11.m1.1.1.1.1.2.2">𝑡</ci><ci id="alg2.l11.m1.1.1.1.1.2.3.cmml" xref="alg2.l11.m1.1.1.1.1.2.3">𝑎</ci><ci id="alg2.l11.m1.1.1.1.1.2.4.cmml" xref="alg2.l11.m1.1.1.1.1.2.4">𝑟</ci><ci id="alg2.l11.m1.1.1.1.1.2.5.cmml" xref="alg2.l11.m1.1.1.1.1.2.5">𝑔</ci><ci id="alg2.l11.m1.1.1.1.1.2.6.cmml" xref="alg2.l11.m1.1.1.1.1.2.6">𝑒</ci><apply id="alg2.l11.m1.1.1.1.1.2.7.cmml" xref="alg2.l11.m1.1.1.1.1.2.7"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.1.2.7.1.cmml" xref="alg2.l11.m1.1.1.1.1.2.7">subscript</csymbol><ci id="alg2.l11.m1.1.1.1.1.2.7.2.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.2">𝑡</ci><apply id="alg2.l11.m1.1.1.1.1.2.7.3.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.3"><times id="alg2.l11.m1.1.1.1.1.2.7.3.1.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.3.1"></times><ci id="alg2.l11.m1.1.1.1.1.2.7.3.2.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.3.2">𝑠</ci><ci id="alg2.l11.m1.1.1.1.1.2.7.3.3.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.3.3">𝑐</ci><ci id="alg2.l11.m1.1.1.1.1.2.7.3.4.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.3.4">𝑜</ci><ci id="alg2.l11.m1.1.1.1.1.2.7.3.5.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.3.5">𝑟</ci><ci id="alg2.l11.m1.1.1.1.1.2.7.3.6.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.3.6">𝑒</ci><ci id="alg2.l11.m1.1.1.1.1.2.7.3.7.cmml" xref="alg2.l11.m1.1.1.1.1.2.7.3.7">𝑠</ci></apply></apply></apply><apply id="alg2.l11.m1.1.1.1.1.3.cmml" xref="alg2.l11.m1.1.1.1.1.3"><minus id="alg2.l11.m1.1.1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.1.1.3"></minus><apply id="alg2.l11.m1.1.1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.1.1.3.2"><times id="alg2.l11.m1.1.1.1.1.3.2.1.cmml" xref="alg2.l11.m1.1.1.1.1.3.2.1"></times><ci id="alg2.l11.m1.1.1.1.1.3.2.2.cmml" xref="alg2.l11.m1.1.1.1.1.3.2.2">𝑛</ci><ci id="alg2.l11.m1.1.1.1.1.3.2.3.cmml" xref="alg2.l11.m1.1.1.1.1.3.2.3">𝑝</ci></apply></apply></apply><apply id="alg2.l11.m1.2.2.2.2.cmml" xref="alg2.l11.m1.2.2.2.2"><times id="alg2.l11.m1.2.2.2.2.1.cmml" xref="alg2.l11.m1.2.2.2.2.1"></times><ci id="alg2.l11.m1.2.2.2.2.2.cmml" xref="alg2.l11.m1.2.2.2.2.2">𝑖</ci><ci id="alg2.l11.m1.2.2.2.2.3.cmml" xref="alg2.l11.m1.2.2.2.2.3">𝑛</ci><ci id="alg2.l11.m1.2.2.2.2.4.cmml" xref="alg2.l11.m1.2.2.2.2.4">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.2c">target_{scores}\leftarrow-np.inf</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.2d">italic_t italic_a italic_r italic_g italic_e italic_t start_POSTSUBSCRIPT italic_s italic_c italic_o italic_r italic_e italic_s end_POSTSUBSCRIPT ← - italic_n italic_p . italic_i italic_n italic_f</annotation></semantics></math>Copy <math alttext="x^{\prime}" class="ltx_Math" display="inline" id="alg2.l11.m2.1"><semantics id="alg2.l11.m2.1a"><msup id="alg2.l11.m2.1.1" xref="alg2.l11.m2.1.1.cmml"><mi id="alg2.l11.m2.1.1.2" xref="alg2.l11.m2.1.1.2.cmml">x</mi><mo id="alg2.l11.m2.1.1.3" xref="alg2.l11.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><apply id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1"><csymbol cd="ambiguous" id="alg2.l11.m2.1.1.1.cmml" xref="alg2.l11.m2.1.1">superscript</csymbol><ci id="alg2.l11.m2.1.1.2.cmml" xref="alg2.l11.m2.1.1.2">𝑥</ci><ci id="alg2.l11.m2.1.1.3.cmml" xref="alg2.l11.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">x^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m2.1d">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="x^{\prime\prime}" class="ltx_Math" display="inline" id="alg2.l11.m3.1"><semantics id="alg2.l11.m3.1a"><msup id="alg2.l11.m3.1.1" xref="alg2.l11.m3.1.1.cmml"><mi id="alg2.l11.m3.1.1.2" xref="alg2.l11.m3.1.1.2.cmml">x</mi><mo id="alg2.l11.m3.1.1.3" xref="alg2.l11.m3.1.1.3.cmml">′′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l11.m3.1b"><apply id="alg2.l11.m3.1.1.cmml" xref="alg2.l11.m3.1.1"><csymbol cd="ambiguous" id="alg2.l11.m3.1.1.1.cmml" xref="alg2.l11.m3.1.1">superscript</csymbol><ci id="alg2.l11.m3.1.1.2.cmml" xref="alg2.l11.m3.1.1.2">𝑥</ci><ci id="alg2.l11.m3.1.1.3.cmml" xref="alg2.l11.m3.1.1.3">′′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m3.1c">x^{\prime\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m3.1d">italic_x start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="x^{\prime\prime}\leftarrow x^{\prime}" class="ltx_Math" display="inline" id="alg2.l11.m4.1"><semantics id="alg2.l11.m4.1a"><mrow id="alg2.l11.m4.1.1" xref="alg2.l11.m4.1.1.cmml"><msup id="alg2.l11.m4.1.1.2" xref="alg2.l11.m4.1.1.2.cmml"><mi id="alg2.l11.m4.1.1.2.2" xref="alg2.l11.m4.1.1.2.2.cmml">x</mi><mo id="alg2.l11.m4.1.1.2.3" xref="alg2.l11.m4.1.1.2.3.cmml">′′</mo></msup><mo id="alg2.l11.m4.1.1.1" stretchy="false" xref="alg2.l11.m4.1.1.1.cmml">←</mo><msup id="alg2.l11.m4.1.1.3" xref="alg2.l11.m4.1.1.3.cmml"><mi id="alg2.l11.m4.1.1.3.2" xref="alg2.l11.m4.1.1.3.2.cmml">x</mi><mo id="alg2.l11.m4.1.1.3.3" xref="alg2.l11.m4.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m4.1b"><apply id="alg2.l11.m4.1.1.cmml" xref="alg2.l11.m4.1.1"><ci id="alg2.l11.m4.1.1.1.cmml" xref="alg2.l11.m4.1.1.1">←</ci><apply id="alg2.l11.m4.1.1.2.cmml" xref="alg2.l11.m4.1.1.2"><csymbol cd="ambiguous" id="alg2.l11.m4.1.1.2.1.cmml" xref="alg2.l11.m4.1.1.2">superscript</csymbol><ci id="alg2.l11.m4.1.1.2.2.cmml" xref="alg2.l11.m4.1.1.2.2">𝑥</ci><ci id="alg2.l11.m4.1.1.2.3.cmml" xref="alg2.l11.m4.1.1.2.3">′′</ci></apply><apply id="alg2.l11.m4.1.1.3.cmml" xref="alg2.l11.m4.1.1.3"><csymbol cd="ambiguous" id="alg2.l11.m4.1.1.3.1.cmml" xref="alg2.l11.m4.1.1.3">superscript</csymbol><ci id="alg2.l11.m4.1.1.3.2.cmml" xref="alg2.l11.m4.1.1.3.2">𝑥</ci><ci id="alg2.l11.m4.1.1.3.3.cmml" xref="alg2.l11.m4.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m4.1c">x^{\prime\prime}\leftarrow x^{\prime}</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m4.1d">italic_x start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ← italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l12.1">for</span> <math alttext="j" class="ltx_Math" display="inline" id="alg2.l12.m1.1"><semantics id="alg2.l12.m1.1a"><mi id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><ci id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m1.1d">italic_j</annotation></semantics></math> in <math alttext="T" class="ltx_Math" display="inline" id="alg2.l12.m2.1"><semantics id="alg2.l12.m2.1a"><mi id="alg2.l12.m2.1.1" xref="alg2.l12.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l12.m2.1b"><ci id="alg2.l12.m2.1.1.cmml" xref="alg2.l12.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg2.l12.m2.1d">italic_T</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l12.2">do</span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>     Replace <math alttext="x_{i}^{\prime\prime}\hskip 5.69046ptin\hskip 5.69046ptx^{\prime\prime}:{x}_{i}%
^{\prime\prime}\leftarrow s_{indice}[j]" class="ltx_Math" display="inline" id="alg2.l13.m1.1"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.2" xref="alg2.l13.m1.1.2.cmml"><mrow id="alg2.l13.m1.1.2.2" xref="alg2.l13.m1.1.2.2.cmml"><msubsup id="alg2.l13.m1.1.2.2.2" xref="alg2.l13.m1.1.2.2.2.cmml"><mi id="alg2.l13.m1.1.2.2.2.2.2" xref="alg2.l13.m1.1.2.2.2.2.2.cmml">x</mi><mi id="alg2.l13.m1.1.2.2.2.2.3" xref="alg2.l13.m1.1.2.2.2.2.3.cmml">i</mi><mo id="alg2.l13.m1.1.2.2.2.3" xref="alg2.l13.m1.1.2.2.2.3.cmml">′′</mo></msubsup><mo id="alg2.l13.m1.1.2.2.1" lspace="0.570em" xref="alg2.l13.m1.1.2.2.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.2.2.3" xref="alg2.l13.m1.1.2.2.3.cmml">i</mi><mo id="alg2.l13.m1.1.2.2.1a" xref="alg2.l13.m1.1.2.2.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.2.2.4" xref="alg2.l13.m1.1.2.2.4.cmml">n</mi><mo id="alg2.l13.m1.1.2.2.1b" lspace="0.570em" xref="alg2.l13.m1.1.2.2.1.cmml">⁢</mo><msup id="alg2.l13.m1.1.2.2.5" xref="alg2.l13.m1.1.2.2.5.cmml"><mi id="alg2.l13.m1.1.2.2.5.2" xref="alg2.l13.m1.1.2.2.5.2.cmml">x</mi><mo id="alg2.l13.m1.1.2.2.5.3" xref="alg2.l13.m1.1.2.2.5.3.cmml">′′</mo></msup></mrow><mo id="alg2.l13.m1.1.2.1" lspace="0.278em" rspace="0.278em" xref="alg2.l13.m1.1.2.1.cmml">:</mo><mrow id="alg2.l13.m1.1.2.3" xref="alg2.l13.m1.1.2.3.cmml"><msubsup id="alg2.l13.m1.1.2.3.2" xref="alg2.l13.m1.1.2.3.2.cmml"><mi id="alg2.l13.m1.1.2.3.2.2.2" xref="alg2.l13.m1.1.2.3.2.2.2.cmml">x</mi><mi id="alg2.l13.m1.1.2.3.2.2.3" xref="alg2.l13.m1.1.2.3.2.2.3.cmml">i</mi><mo id="alg2.l13.m1.1.2.3.2.3" xref="alg2.l13.m1.1.2.3.2.3.cmml">′′</mo></msubsup><mo id="alg2.l13.m1.1.2.3.1" stretchy="false" xref="alg2.l13.m1.1.2.3.1.cmml">←</mo><mrow id="alg2.l13.m1.1.2.3.3" xref="alg2.l13.m1.1.2.3.3.cmml"><msub id="alg2.l13.m1.1.2.3.3.2" xref="alg2.l13.m1.1.2.3.3.2.cmml"><mi id="alg2.l13.m1.1.2.3.3.2.2" xref="alg2.l13.m1.1.2.3.3.2.2.cmml">s</mi><mrow id="alg2.l13.m1.1.2.3.3.2.3" xref="alg2.l13.m1.1.2.3.3.2.3.cmml"><mi id="alg2.l13.m1.1.2.3.3.2.3.2" xref="alg2.l13.m1.1.2.3.3.2.3.2.cmml">i</mi><mo id="alg2.l13.m1.1.2.3.3.2.3.1" xref="alg2.l13.m1.1.2.3.3.2.3.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.2.3.3.2.3.3" xref="alg2.l13.m1.1.2.3.3.2.3.3.cmml">n</mi><mo id="alg2.l13.m1.1.2.3.3.2.3.1a" xref="alg2.l13.m1.1.2.3.3.2.3.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.2.3.3.2.3.4" xref="alg2.l13.m1.1.2.3.3.2.3.4.cmml">d</mi><mo id="alg2.l13.m1.1.2.3.3.2.3.1b" xref="alg2.l13.m1.1.2.3.3.2.3.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.2.3.3.2.3.5" xref="alg2.l13.m1.1.2.3.3.2.3.5.cmml">i</mi><mo id="alg2.l13.m1.1.2.3.3.2.3.1c" xref="alg2.l13.m1.1.2.3.3.2.3.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.2.3.3.2.3.6" xref="alg2.l13.m1.1.2.3.3.2.3.6.cmml">c</mi><mo id="alg2.l13.m1.1.2.3.3.2.3.1d" xref="alg2.l13.m1.1.2.3.3.2.3.1.cmml">⁢</mo><mi id="alg2.l13.m1.1.2.3.3.2.3.7" xref="alg2.l13.m1.1.2.3.3.2.3.7.cmml">e</mi></mrow></msub><mo id="alg2.l13.m1.1.2.3.3.1" xref="alg2.l13.m1.1.2.3.3.1.cmml">⁢</mo><mrow id="alg2.l13.m1.1.2.3.3.3.2" xref="alg2.l13.m1.1.2.3.3.3.1.cmml"><mo id="alg2.l13.m1.1.2.3.3.3.2.1" stretchy="false" xref="alg2.l13.m1.1.2.3.3.3.1.1.cmml">[</mo><mi id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">j</mi><mo id="alg2.l13.m1.1.2.3.3.3.2.2" stretchy="false" xref="alg2.l13.m1.1.2.3.3.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.2.cmml" xref="alg2.l13.m1.1.2"><ci id="alg2.l13.m1.1.2.1.cmml" xref="alg2.l13.m1.1.2.1">:</ci><apply id="alg2.l13.m1.1.2.2.cmml" xref="alg2.l13.m1.1.2.2"><times id="alg2.l13.m1.1.2.2.1.cmml" xref="alg2.l13.m1.1.2.2.1"></times><apply id="alg2.l13.m1.1.2.2.2.cmml" xref="alg2.l13.m1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.2.2.2.1.cmml" xref="alg2.l13.m1.1.2.2.2">superscript</csymbol><apply id="alg2.l13.m1.1.2.2.2.2.cmml" xref="alg2.l13.m1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.2.2.2.2.1.cmml" xref="alg2.l13.m1.1.2.2.2">subscript</csymbol><ci id="alg2.l13.m1.1.2.2.2.2.2.cmml" xref="alg2.l13.m1.1.2.2.2.2.2">𝑥</ci><ci id="alg2.l13.m1.1.2.2.2.2.3.cmml" xref="alg2.l13.m1.1.2.2.2.2.3">𝑖</ci></apply><ci id="alg2.l13.m1.1.2.2.2.3.cmml" xref="alg2.l13.m1.1.2.2.2.3">′′</ci></apply><ci id="alg2.l13.m1.1.2.2.3.cmml" xref="alg2.l13.m1.1.2.2.3">𝑖</ci><ci id="alg2.l13.m1.1.2.2.4.cmml" xref="alg2.l13.m1.1.2.2.4">𝑛</ci><apply id="alg2.l13.m1.1.2.2.5.cmml" xref="alg2.l13.m1.1.2.2.5"><csymbol cd="ambiguous" id="alg2.l13.m1.1.2.2.5.1.cmml" xref="alg2.l13.m1.1.2.2.5">superscript</csymbol><ci id="alg2.l13.m1.1.2.2.5.2.cmml" xref="alg2.l13.m1.1.2.2.5.2">𝑥</ci><ci id="alg2.l13.m1.1.2.2.5.3.cmml" xref="alg2.l13.m1.1.2.2.5.3">′′</ci></apply></apply><apply id="alg2.l13.m1.1.2.3.cmml" xref="alg2.l13.m1.1.2.3"><ci id="alg2.l13.m1.1.2.3.1.cmml" xref="alg2.l13.m1.1.2.3.1">←</ci><apply id="alg2.l13.m1.1.2.3.2.cmml" xref="alg2.l13.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.2.3.2.1.cmml" xref="alg2.l13.m1.1.2.3.2">superscript</csymbol><apply id="alg2.l13.m1.1.2.3.2.2.cmml" xref="alg2.l13.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.2.3.2.2.1.cmml" xref="alg2.l13.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l13.m1.1.2.3.2.2.2.cmml" xref="alg2.l13.m1.1.2.3.2.2.2">𝑥</ci><ci id="alg2.l13.m1.1.2.3.2.2.3.cmml" xref="alg2.l13.m1.1.2.3.2.2.3">𝑖</ci></apply><ci id="alg2.l13.m1.1.2.3.2.3.cmml" xref="alg2.l13.m1.1.2.3.2.3">′′</ci></apply><apply id="alg2.l13.m1.1.2.3.3.cmml" xref="alg2.l13.m1.1.2.3.3"><times id="alg2.l13.m1.1.2.3.3.1.cmml" xref="alg2.l13.m1.1.2.3.3.1"></times><apply id="alg2.l13.m1.1.2.3.3.2.cmml" xref="alg2.l13.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.2.3.3.2.1.cmml" xref="alg2.l13.m1.1.2.3.3.2">subscript</csymbol><ci id="alg2.l13.m1.1.2.3.3.2.2.cmml" xref="alg2.l13.m1.1.2.3.3.2.2">𝑠</ci><apply id="alg2.l13.m1.1.2.3.3.2.3.cmml" xref="alg2.l13.m1.1.2.3.3.2.3"><times id="alg2.l13.m1.1.2.3.3.2.3.1.cmml" xref="alg2.l13.m1.1.2.3.3.2.3.1"></times><ci id="alg2.l13.m1.1.2.3.3.2.3.2.cmml" xref="alg2.l13.m1.1.2.3.3.2.3.2">𝑖</ci><ci id="alg2.l13.m1.1.2.3.3.2.3.3.cmml" xref="alg2.l13.m1.1.2.3.3.2.3.3">𝑛</ci><ci id="alg2.l13.m1.1.2.3.3.2.3.4.cmml" xref="alg2.l13.m1.1.2.3.3.2.3.4">𝑑</ci><ci id="alg2.l13.m1.1.2.3.3.2.3.5.cmml" xref="alg2.l13.m1.1.2.3.3.2.3.5">𝑖</ci><ci id="alg2.l13.m1.1.2.3.3.2.3.6.cmml" xref="alg2.l13.m1.1.2.3.3.2.3.6">𝑐</ci><ci id="alg2.l13.m1.1.2.3.3.2.3.7.cmml" xref="alg2.l13.m1.1.2.3.3.2.3.7">𝑒</ci></apply></apply><apply id="alg2.l13.m1.1.2.3.3.3.1.cmml" xref="alg2.l13.m1.1.2.3.3.3.2"><csymbol cd="latexml" id="alg2.l13.m1.1.2.3.3.3.1.1.cmml" xref="alg2.l13.m1.1.2.3.3.3.2.1">delimited-[]</csymbol><ci id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">x_{i}^{\prime\prime}\hskip 5.69046ptin\hskip 5.69046ptx^{\prime\prime}:{x}_{i}%
^{\prime\prime}\leftarrow s_{indice}[j]</annotation><annotation encoding="application/x-llamapun" id="alg2.l13.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT italic_i italic_n italic_x start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT : italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ← italic_s start_POSTSUBSCRIPT italic_i italic_n italic_d italic_i italic_c italic_e end_POSTSUBSCRIPT [ italic_j ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>     <span class="ltx_text ltx_font_bold" id="alg2.l14.1">if</span> <math alttext="f(x^{\prime\prime})[t]&gt;target_{scores}" class="ltx_Math" display="inline" id="alg2.l14.m1.2"><semantics id="alg2.l14.m1.2a"><mrow id="alg2.l14.m1.2.2" xref="alg2.l14.m1.2.2.cmml"><mrow id="alg2.l14.m1.2.2.1" xref="alg2.l14.m1.2.2.1.cmml"><mi id="alg2.l14.m1.2.2.1.3" xref="alg2.l14.m1.2.2.1.3.cmml">f</mi><mo id="alg2.l14.m1.2.2.1.2" xref="alg2.l14.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l14.m1.2.2.1.1.1" xref="alg2.l14.m1.2.2.1.1.1.1.cmml"><mo id="alg2.l14.m1.2.2.1.1.1.2" stretchy="false" xref="alg2.l14.m1.2.2.1.1.1.1.cmml">(</mo><msup id="alg2.l14.m1.2.2.1.1.1.1" xref="alg2.l14.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l14.m1.2.2.1.1.1.1.2" xref="alg2.l14.m1.2.2.1.1.1.1.2.cmml">x</mi><mo id="alg2.l14.m1.2.2.1.1.1.1.3" xref="alg2.l14.m1.2.2.1.1.1.1.3.cmml">′′</mo></msup><mo id="alg2.l14.m1.2.2.1.1.1.3" stretchy="false" xref="alg2.l14.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l14.m1.2.2.1.2a" xref="alg2.l14.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l14.m1.2.2.1.4.2" xref="alg2.l14.m1.2.2.1.4.1.cmml"><mo id="alg2.l14.m1.2.2.1.4.2.1" stretchy="false" xref="alg2.l14.m1.2.2.1.4.1.1.cmml">[</mo><mi id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml">t</mi><mo id="alg2.l14.m1.2.2.1.4.2.2" stretchy="false" xref="alg2.l14.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow><mo id="alg2.l14.m1.2.2.2" xref="alg2.l14.m1.2.2.2.cmml">&gt;</mo><mrow id="alg2.l14.m1.2.2.3" xref="alg2.l14.m1.2.2.3.cmml"><mi id="alg2.l14.m1.2.2.3.2" xref="alg2.l14.m1.2.2.3.2.cmml">t</mi><mo id="alg2.l14.m1.2.2.3.1" xref="alg2.l14.m1.2.2.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.3" xref="alg2.l14.m1.2.2.3.3.cmml">a</mi><mo id="alg2.l14.m1.2.2.3.1a" xref="alg2.l14.m1.2.2.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.4" xref="alg2.l14.m1.2.2.3.4.cmml">r</mi><mo id="alg2.l14.m1.2.2.3.1b" xref="alg2.l14.m1.2.2.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.5" xref="alg2.l14.m1.2.2.3.5.cmml">g</mi><mo id="alg2.l14.m1.2.2.3.1c" xref="alg2.l14.m1.2.2.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.6" xref="alg2.l14.m1.2.2.3.6.cmml">e</mi><mo id="alg2.l14.m1.2.2.3.1d" xref="alg2.l14.m1.2.2.3.1.cmml">⁢</mo><msub id="alg2.l14.m1.2.2.3.7" xref="alg2.l14.m1.2.2.3.7.cmml"><mi id="alg2.l14.m1.2.2.3.7.2" xref="alg2.l14.m1.2.2.3.7.2.cmml">t</mi><mrow id="alg2.l14.m1.2.2.3.7.3" xref="alg2.l14.m1.2.2.3.7.3.cmml"><mi id="alg2.l14.m1.2.2.3.7.3.2" xref="alg2.l14.m1.2.2.3.7.3.2.cmml">s</mi><mo id="alg2.l14.m1.2.2.3.7.3.1" xref="alg2.l14.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.7.3.3" xref="alg2.l14.m1.2.2.3.7.3.3.cmml">c</mi><mo id="alg2.l14.m1.2.2.3.7.3.1a" xref="alg2.l14.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.7.3.4" xref="alg2.l14.m1.2.2.3.7.3.4.cmml">o</mi><mo id="alg2.l14.m1.2.2.3.7.3.1b" xref="alg2.l14.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.7.3.5" xref="alg2.l14.m1.2.2.3.7.3.5.cmml">r</mi><mo id="alg2.l14.m1.2.2.3.7.3.1c" xref="alg2.l14.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.7.3.6" xref="alg2.l14.m1.2.2.3.7.3.6.cmml">e</mi><mo id="alg2.l14.m1.2.2.3.7.3.1d" xref="alg2.l14.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l14.m1.2.2.3.7.3.7" xref="alg2.l14.m1.2.2.3.7.3.7.cmml">s</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.2b"><apply id="alg2.l14.m1.2.2.cmml" xref="alg2.l14.m1.2.2"><gt id="alg2.l14.m1.2.2.2.cmml" xref="alg2.l14.m1.2.2.2"></gt><apply id="alg2.l14.m1.2.2.1.cmml" xref="alg2.l14.m1.2.2.1"><times id="alg2.l14.m1.2.2.1.2.cmml" xref="alg2.l14.m1.2.2.1.2"></times><ci id="alg2.l14.m1.2.2.1.3.cmml" xref="alg2.l14.m1.2.2.1.3">𝑓</ci><apply id="alg2.l14.m1.2.2.1.1.1.1.cmml" xref="alg2.l14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l14.m1.2.2.1.1.1">superscript</csymbol><ci id="alg2.l14.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.2">𝑥</ci><ci id="alg2.l14.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.3">′′</ci></apply><apply id="alg2.l14.m1.2.2.1.4.1.cmml" xref="alg2.l14.m1.2.2.1.4.2"><csymbol cd="latexml" id="alg2.l14.m1.2.2.1.4.1.1.cmml" xref="alg2.l14.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1">𝑡</ci></apply></apply><apply id="alg2.l14.m1.2.2.3.cmml" xref="alg2.l14.m1.2.2.3"><times id="alg2.l14.m1.2.2.3.1.cmml" xref="alg2.l14.m1.2.2.3.1"></times><ci id="alg2.l14.m1.2.2.3.2.cmml" xref="alg2.l14.m1.2.2.3.2">𝑡</ci><ci id="alg2.l14.m1.2.2.3.3.cmml" xref="alg2.l14.m1.2.2.3.3">𝑎</ci><ci id="alg2.l14.m1.2.2.3.4.cmml" xref="alg2.l14.m1.2.2.3.4">𝑟</ci><ci id="alg2.l14.m1.2.2.3.5.cmml" xref="alg2.l14.m1.2.2.3.5">𝑔</ci><ci id="alg2.l14.m1.2.2.3.6.cmml" xref="alg2.l14.m1.2.2.3.6">𝑒</ci><apply id="alg2.l14.m1.2.2.3.7.cmml" xref="alg2.l14.m1.2.2.3.7"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.3.7.1.cmml" xref="alg2.l14.m1.2.2.3.7">subscript</csymbol><ci id="alg2.l14.m1.2.2.3.7.2.cmml" xref="alg2.l14.m1.2.2.3.7.2">𝑡</ci><apply id="alg2.l14.m1.2.2.3.7.3.cmml" xref="alg2.l14.m1.2.2.3.7.3"><times id="alg2.l14.m1.2.2.3.7.3.1.cmml" xref="alg2.l14.m1.2.2.3.7.3.1"></times><ci id="alg2.l14.m1.2.2.3.7.3.2.cmml" xref="alg2.l14.m1.2.2.3.7.3.2">𝑠</ci><ci id="alg2.l14.m1.2.2.3.7.3.3.cmml" xref="alg2.l14.m1.2.2.3.7.3.3">𝑐</ci><ci id="alg2.l14.m1.2.2.3.7.3.4.cmml" xref="alg2.l14.m1.2.2.3.7.3.4">𝑜</ci><ci id="alg2.l14.m1.2.2.3.7.3.5.cmml" xref="alg2.l14.m1.2.2.3.7.3.5">𝑟</ci><ci id="alg2.l14.m1.2.2.3.7.3.6.cmml" xref="alg2.l14.m1.2.2.3.7.3.6">𝑒</ci><ci id="alg2.l14.m1.2.2.3.7.3.7.cmml" xref="alg2.l14.m1.2.2.3.7.3.7">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.2c">f(x^{\prime\prime})[t]&gt;target_{scores}</annotation><annotation encoding="application/x-llamapun" id="alg2.l14.m1.2d">italic_f ( italic_x start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) [ italic_t ] &gt; italic_t italic_a italic_r italic_g italic_e italic_t start_POSTSUBSCRIPT italic_s italic_c italic_o italic_r italic_e italic_s end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l14.2">then</span>
</div>
<div class="ltx_listingline" id="alg2.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math alttext="{x}_{i}^{\prime}\leftarrow s_{indice}[j]" class="ltx_Math" display="inline" id="alg2.l15.m1.1"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.2" xref="alg2.l15.m1.1.2.cmml"><msubsup id="alg2.l15.m1.1.2.2" xref="alg2.l15.m1.1.2.2.cmml"><mi id="alg2.l15.m1.1.2.2.2.2" xref="alg2.l15.m1.1.2.2.2.2.cmml">x</mi><mi id="alg2.l15.m1.1.2.2.2.3" xref="alg2.l15.m1.1.2.2.2.3.cmml">i</mi><mo id="alg2.l15.m1.1.2.2.3" xref="alg2.l15.m1.1.2.2.3.cmml">′</mo></msubsup><mo id="alg2.l15.m1.1.2.1" stretchy="false" xref="alg2.l15.m1.1.2.1.cmml">←</mo><mrow id="alg2.l15.m1.1.2.3" xref="alg2.l15.m1.1.2.3.cmml"><msub id="alg2.l15.m1.1.2.3.2" xref="alg2.l15.m1.1.2.3.2.cmml"><mi id="alg2.l15.m1.1.2.3.2.2" xref="alg2.l15.m1.1.2.3.2.2.cmml">s</mi><mrow id="alg2.l15.m1.1.2.3.2.3" xref="alg2.l15.m1.1.2.3.2.3.cmml"><mi id="alg2.l15.m1.1.2.3.2.3.2" xref="alg2.l15.m1.1.2.3.2.3.2.cmml">i</mi><mo id="alg2.l15.m1.1.2.3.2.3.1" xref="alg2.l15.m1.1.2.3.2.3.1.cmml">⁢</mo><mi id="alg2.l15.m1.1.2.3.2.3.3" xref="alg2.l15.m1.1.2.3.2.3.3.cmml">n</mi><mo id="alg2.l15.m1.1.2.3.2.3.1a" xref="alg2.l15.m1.1.2.3.2.3.1.cmml">⁢</mo><mi id="alg2.l15.m1.1.2.3.2.3.4" xref="alg2.l15.m1.1.2.3.2.3.4.cmml">d</mi><mo id="alg2.l15.m1.1.2.3.2.3.1b" xref="alg2.l15.m1.1.2.3.2.3.1.cmml">⁢</mo><mi id="alg2.l15.m1.1.2.3.2.3.5" xref="alg2.l15.m1.1.2.3.2.3.5.cmml">i</mi><mo id="alg2.l15.m1.1.2.3.2.3.1c" xref="alg2.l15.m1.1.2.3.2.3.1.cmml">⁢</mo><mi id="alg2.l15.m1.1.2.3.2.3.6" xref="alg2.l15.m1.1.2.3.2.3.6.cmml">c</mi><mo id="alg2.l15.m1.1.2.3.2.3.1d" xref="alg2.l15.m1.1.2.3.2.3.1.cmml">⁢</mo><mi id="alg2.l15.m1.1.2.3.2.3.7" xref="alg2.l15.m1.1.2.3.2.3.7.cmml">e</mi></mrow></msub><mo id="alg2.l15.m1.1.2.3.1" xref="alg2.l15.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg2.l15.m1.1.2.3.3.2" xref="alg2.l15.m1.1.2.3.3.1.cmml"><mo id="alg2.l15.m1.1.2.3.3.2.1" stretchy="false" xref="alg2.l15.m1.1.2.3.3.1.1.cmml">[</mo><mi id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml">j</mi><mo id="alg2.l15.m1.1.2.3.3.2.2" stretchy="false" xref="alg2.l15.m1.1.2.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.2.cmml" xref="alg2.l15.m1.1.2"><ci id="alg2.l15.m1.1.2.1.cmml" xref="alg2.l15.m1.1.2.1">←</ci><apply id="alg2.l15.m1.1.2.2.cmml" xref="alg2.l15.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l15.m1.1.2.2.1.cmml" xref="alg2.l15.m1.1.2.2">superscript</csymbol><apply id="alg2.l15.m1.1.2.2.2.cmml" xref="alg2.l15.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l15.m1.1.2.2.2.1.cmml" xref="alg2.l15.m1.1.2.2">subscript</csymbol><ci id="alg2.l15.m1.1.2.2.2.2.cmml" xref="alg2.l15.m1.1.2.2.2.2">𝑥</ci><ci id="alg2.l15.m1.1.2.2.2.3.cmml" xref="alg2.l15.m1.1.2.2.2.3">𝑖</ci></apply><ci id="alg2.l15.m1.1.2.2.3.cmml" xref="alg2.l15.m1.1.2.2.3">′</ci></apply><apply id="alg2.l15.m1.1.2.3.cmml" xref="alg2.l15.m1.1.2.3"><times id="alg2.l15.m1.1.2.3.1.cmml" xref="alg2.l15.m1.1.2.3.1"></times><apply id="alg2.l15.m1.1.2.3.2.cmml" xref="alg2.l15.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l15.m1.1.2.3.2.1.cmml" xref="alg2.l15.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l15.m1.1.2.3.2.2.cmml" xref="alg2.l15.m1.1.2.3.2.2">𝑠</ci><apply id="alg2.l15.m1.1.2.3.2.3.cmml" xref="alg2.l15.m1.1.2.3.2.3"><times id="alg2.l15.m1.1.2.3.2.3.1.cmml" xref="alg2.l15.m1.1.2.3.2.3.1"></times><ci id="alg2.l15.m1.1.2.3.2.3.2.cmml" xref="alg2.l15.m1.1.2.3.2.3.2">𝑖</ci><ci id="alg2.l15.m1.1.2.3.2.3.3.cmml" xref="alg2.l15.m1.1.2.3.2.3.3">𝑛</ci><ci id="alg2.l15.m1.1.2.3.2.3.4.cmml" xref="alg2.l15.m1.1.2.3.2.3.4">𝑑</ci><ci id="alg2.l15.m1.1.2.3.2.3.5.cmml" xref="alg2.l15.m1.1.2.3.2.3.5">𝑖</ci><ci id="alg2.l15.m1.1.2.3.2.3.6.cmml" xref="alg2.l15.m1.1.2.3.2.3.6">𝑐</ci><ci id="alg2.l15.m1.1.2.3.2.3.7.cmml" xref="alg2.l15.m1.1.2.3.2.3.7">𝑒</ci></apply></apply><apply id="alg2.l15.m1.1.2.3.3.1.cmml" xref="alg2.l15.m1.1.2.3.3.2"><csymbol cd="latexml" id="alg2.l15.m1.1.2.3.3.1.1.cmml" xref="alg2.l15.m1.1.2.3.3.2.1">delimited-[]</csymbol><ci id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">{x}_{i}^{\prime}\leftarrow s_{indice}[j]</annotation><annotation encoding="application/x-llamapun" id="alg2.l15.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ← italic_s start_POSTSUBSCRIPT italic_i italic_n italic_d italic_i italic_c italic_e end_POSTSUBSCRIPT [ italic_j ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>        <math alttext="target_{scores}\leftarrow f(x^{\prime\prime})[t]" class="ltx_Math" display="inline" id="alg2.l16.m1.2"><semantics id="alg2.l16.m1.2a"><mrow id="alg2.l16.m1.2.2" xref="alg2.l16.m1.2.2.cmml"><mrow id="alg2.l16.m1.2.2.3" xref="alg2.l16.m1.2.2.3.cmml"><mi id="alg2.l16.m1.2.2.3.2" xref="alg2.l16.m1.2.2.3.2.cmml">t</mi><mo id="alg2.l16.m1.2.2.3.1" xref="alg2.l16.m1.2.2.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.3" xref="alg2.l16.m1.2.2.3.3.cmml">a</mi><mo id="alg2.l16.m1.2.2.3.1a" xref="alg2.l16.m1.2.2.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.4" xref="alg2.l16.m1.2.2.3.4.cmml">r</mi><mo id="alg2.l16.m1.2.2.3.1b" xref="alg2.l16.m1.2.2.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.5" xref="alg2.l16.m1.2.2.3.5.cmml">g</mi><mo id="alg2.l16.m1.2.2.3.1c" xref="alg2.l16.m1.2.2.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.6" xref="alg2.l16.m1.2.2.3.6.cmml">e</mi><mo id="alg2.l16.m1.2.2.3.1d" xref="alg2.l16.m1.2.2.3.1.cmml">⁢</mo><msub id="alg2.l16.m1.2.2.3.7" xref="alg2.l16.m1.2.2.3.7.cmml"><mi id="alg2.l16.m1.2.2.3.7.2" xref="alg2.l16.m1.2.2.3.7.2.cmml">t</mi><mrow id="alg2.l16.m1.2.2.3.7.3" xref="alg2.l16.m1.2.2.3.7.3.cmml"><mi id="alg2.l16.m1.2.2.3.7.3.2" xref="alg2.l16.m1.2.2.3.7.3.2.cmml">s</mi><mo id="alg2.l16.m1.2.2.3.7.3.1" xref="alg2.l16.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.7.3.3" xref="alg2.l16.m1.2.2.3.7.3.3.cmml">c</mi><mo id="alg2.l16.m1.2.2.3.7.3.1a" xref="alg2.l16.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.7.3.4" xref="alg2.l16.m1.2.2.3.7.3.4.cmml">o</mi><mo id="alg2.l16.m1.2.2.3.7.3.1b" xref="alg2.l16.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.7.3.5" xref="alg2.l16.m1.2.2.3.7.3.5.cmml">r</mi><mo id="alg2.l16.m1.2.2.3.7.3.1c" xref="alg2.l16.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.7.3.6" xref="alg2.l16.m1.2.2.3.7.3.6.cmml">e</mi><mo id="alg2.l16.m1.2.2.3.7.3.1d" xref="alg2.l16.m1.2.2.3.7.3.1.cmml">⁢</mo><mi id="alg2.l16.m1.2.2.3.7.3.7" xref="alg2.l16.m1.2.2.3.7.3.7.cmml">s</mi></mrow></msub></mrow><mo id="alg2.l16.m1.2.2.2" stretchy="false" xref="alg2.l16.m1.2.2.2.cmml">←</mo><mrow id="alg2.l16.m1.2.2.1" xref="alg2.l16.m1.2.2.1.cmml"><mi id="alg2.l16.m1.2.2.1.3" xref="alg2.l16.m1.2.2.1.3.cmml">f</mi><mo id="alg2.l16.m1.2.2.1.2" xref="alg2.l16.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l16.m1.2.2.1.1.1" xref="alg2.l16.m1.2.2.1.1.1.1.cmml"><mo id="alg2.l16.m1.2.2.1.1.1.2" stretchy="false" xref="alg2.l16.m1.2.2.1.1.1.1.cmml">(</mo><msup id="alg2.l16.m1.2.2.1.1.1.1" xref="alg2.l16.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l16.m1.2.2.1.1.1.1.2" xref="alg2.l16.m1.2.2.1.1.1.1.2.cmml">x</mi><mo id="alg2.l16.m1.2.2.1.1.1.1.3" xref="alg2.l16.m1.2.2.1.1.1.1.3.cmml">′′</mo></msup><mo id="alg2.l16.m1.2.2.1.1.1.3" stretchy="false" xref="alg2.l16.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l16.m1.2.2.1.2a" xref="alg2.l16.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg2.l16.m1.2.2.1.4.2" xref="alg2.l16.m1.2.2.1.4.1.cmml"><mo id="alg2.l16.m1.2.2.1.4.2.1" stretchy="false" xref="alg2.l16.m1.2.2.1.4.1.1.cmml">[</mo><mi id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml">t</mi><mo id="alg2.l16.m1.2.2.1.4.2.2" stretchy="false" xref="alg2.l16.m1.2.2.1.4.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.2b"><apply id="alg2.l16.m1.2.2.cmml" xref="alg2.l16.m1.2.2"><ci id="alg2.l16.m1.2.2.2.cmml" xref="alg2.l16.m1.2.2.2">←</ci><apply id="alg2.l16.m1.2.2.3.cmml" xref="alg2.l16.m1.2.2.3"><times id="alg2.l16.m1.2.2.3.1.cmml" xref="alg2.l16.m1.2.2.3.1"></times><ci id="alg2.l16.m1.2.2.3.2.cmml" xref="alg2.l16.m1.2.2.3.2">𝑡</ci><ci id="alg2.l16.m1.2.2.3.3.cmml" xref="alg2.l16.m1.2.2.3.3">𝑎</ci><ci id="alg2.l16.m1.2.2.3.4.cmml" xref="alg2.l16.m1.2.2.3.4">𝑟</ci><ci id="alg2.l16.m1.2.2.3.5.cmml" xref="alg2.l16.m1.2.2.3.5">𝑔</ci><ci id="alg2.l16.m1.2.2.3.6.cmml" xref="alg2.l16.m1.2.2.3.6">𝑒</ci><apply id="alg2.l16.m1.2.2.3.7.cmml" xref="alg2.l16.m1.2.2.3.7"><csymbol cd="ambiguous" id="alg2.l16.m1.2.2.3.7.1.cmml" xref="alg2.l16.m1.2.2.3.7">subscript</csymbol><ci id="alg2.l16.m1.2.2.3.7.2.cmml" xref="alg2.l16.m1.2.2.3.7.2">𝑡</ci><apply id="alg2.l16.m1.2.2.3.7.3.cmml" xref="alg2.l16.m1.2.2.3.7.3"><times id="alg2.l16.m1.2.2.3.7.3.1.cmml" xref="alg2.l16.m1.2.2.3.7.3.1"></times><ci id="alg2.l16.m1.2.2.3.7.3.2.cmml" xref="alg2.l16.m1.2.2.3.7.3.2">𝑠</ci><ci id="alg2.l16.m1.2.2.3.7.3.3.cmml" xref="alg2.l16.m1.2.2.3.7.3.3">𝑐</ci><ci id="alg2.l16.m1.2.2.3.7.3.4.cmml" xref="alg2.l16.m1.2.2.3.7.3.4">𝑜</ci><ci id="alg2.l16.m1.2.2.3.7.3.5.cmml" xref="alg2.l16.m1.2.2.3.7.3.5">𝑟</ci><ci id="alg2.l16.m1.2.2.3.7.3.6.cmml" xref="alg2.l16.m1.2.2.3.7.3.6">𝑒</ci><ci id="alg2.l16.m1.2.2.3.7.3.7.cmml" xref="alg2.l16.m1.2.2.3.7.3.7">𝑠</ci></apply></apply></apply><apply id="alg2.l16.m1.2.2.1.cmml" xref="alg2.l16.m1.2.2.1"><times id="alg2.l16.m1.2.2.1.2.cmml" xref="alg2.l16.m1.2.2.1.2"></times><ci id="alg2.l16.m1.2.2.1.3.cmml" xref="alg2.l16.m1.2.2.1.3">𝑓</ci><apply id="alg2.l16.m1.2.2.1.1.1.1.cmml" xref="alg2.l16.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l16.m1.2.2.1.1.1">superscript</csymbol><ci id="alg2.l16.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.2">𝑥</ci><ci id="alg2.l16.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.3">′′</ci></apply><apply id="alg2.l16.m1.2.2.1.4.1.cmml" xref="alg2.l16.m1.2.2.1.4.2"><csymbol cd="latexml" id="alg2.l16.m1.2.2.1.4.1.1.cmml" xref="alg2.l16.m1.2.2.1.4.2.1">delimited-[]</csymbol><ci id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.2c">target_{scores}\leftarrow f(x^{\prime\prime})[t]</annotation><annotation encoding="application/x-llamapun" id="alg2.l16.m1.2d">italic_t italic_a italic_r italic_g italic_e italic_t start_POSTSUBSCRIPT italic_s italic_c italic_o italic_r italic_e italic_s end_POSTSUBSCRIPT ← italic_f ( italic_x start_POSTSUPERSCRIPT ′ ′ end_POSTSUPERSCRIPT ) [ italic_t ]</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>     <span class="ltx_text ltx_font_bold" id="alg2.l17.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l17.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l18">
<span class="ltx_tag ltx_tag_listingline">18:</span>  <span class="ltx_text ltx_font_bold" id="alg2.l18.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l18.2">for</span>
</div>
</div>
</figure>
<div class="ltx_para" id="Sx4.SSx1.SSSx2.p2">
<p class="ltx_p" id="Sx4.SSx1.SSSx2.p2.3">The final loss function formula is as follows (step 5):</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{total}}=L_{\text{attack}}+L_{\text{con}}" class="ltx_Math" display="block" id="Sx4.Ex9.m1.1"><semantics id="Sx4.Ex9.m1.1a"><mrow id="Sx4.Ex9.m1.1.1" xref="Sx4.Ex9.m1.1.1.cmml"><msub id="Sx4.Ex9.m1.1.1.2" xref="Sx4.Ex9.m1.1.1.2.cmml"><mi id="Sx4.Ex9.m1.1.1.2.2" xref="Sx4.Ex9.m1.1.1.2.2.cmml">L</mi><mtext id="Sx4.Ex9.m1.1.1.2.3" xref="Sx4.Ex9.m1.1.1.2.3a.cmml">total</mtext></msub><mo id="Sx4.Ex9.m1.1.1.1" xref="Sx4.Ex9.m1.1.1.1.cmml">=</mo><mrow id="Sx4.Ex9.m1.1.1.3" xref="Sx4.Ex9.m1.1.1.3.cmml"><msub id="Sx4.Ex9.m1.1.1.3.2" xref="Sx4.Ex9.m1.1.1.3.2.cmml"><mi id="Sx4.Ex9.m1.1.1.3.2.2" xref="Sx4.Ex9.m1.1.1.3.2.2.cmml">L</mi><mtext id="Sx4.Ex9.m1.1.1.3.2.3" xref="Sx4.Ex9.m1.1.1.3.2.3a.cmml">attack</mtext></msub><mo id="Sx4.Ex9.m1.1.1.3.1" xref="Sx4.Ex9.m1.1.1.3.1.cmml">+</mo><msub id="Sx4.Ex9.m1.1.1.3.3" xref="Sx4.Ex9.m1.1.1.3.3.cmml"><mi id="Sx4.Ex9.m1.1.1.3.3.2" xref="Sx4.Ex9.m1.1.1.3.3.2.cmml">L</mi><mtext id="Sx4.Ex9.m1.1.1.3.3.3" xref="Sx4.Ex9.m1.1.1.3.3.3a.cmml">con</mtext></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex9.m1.1b"><apply id="Sx4.Ex9.m1.1.1.cmml" xref="Sx4.Ex9.m1.1.1"><eq id="Sx4.Ex9.m1.1.1.1.cmml" xref="Sx4.Ex9.m1.1.1.1"></eq><apply id="Sx4.Ex9.m1.1.1.2.cmml" xref="Sx4.Ex9.m1.1.1.2"><csymbol cd="ambiguous" id="Sx4.Ex9.m1.1.1.2.1.cmml" xref="Sx4.Ex9.m1.1.1.2">subscript</csymbol><ci id="Sx4.Ex9.m1.1.1.2.2.cmml" xref="Sx4.Ex9.m1.1.1.2.2">𝐿</ci><ci id="Sx4.Ex9.m1.1.1.2.3a.cmml" xref="Sx4.Ex9.m1.1.1.2.3"><mtext id="Sx4.Ex9.m1.1.1.2.3.cmml" mathsize="70%" xref="Sx4.Ex9.m1.1.1.2.3">total</mtext></ci></apply><apply id="Sx4.Ex9.m1.1.1.3.cmml" xref="Sx4.Ex9.m1.1.1.3"><plus id="Sx4.Ex9.m1.1.1.3.1.cmml" xref="Sx4.Ex9.m1.1.1.3.1"></plus><apply id="Sx4.Ex9.m1.1.1.3.2.cmml" xref="Sx4.Ex9.m1.1.1.3.2"><csymbol cd="ambiguous" id="Sx4.Ex9.m1.1.1.3.2.1.cmml" xref="Sx4.Ex9.m1.1.1.3.2">subscript</csymbol><ci id="Sx4.Ex9.m1.1.1.3.2.2.cmml" xref="Sx4.Ex9.m1.1.1.3.2.2">𝐿</ci><ci id="Sx4.Ex9.m1.1.1.3.2.3a.cmml" xref="Sx4.Ex9.m1.1.1.3.2.3"><mtext id="Sx4.Ex9.m1.1.1.3.2.3.cmml" mathsize="70%" xref="Sx4.Ex9.m1.1.1.3.2.3">attack</mtext></ci></apply><apply id="Sx4.Ex9.m1.1.1.3.3.cmml" xref="Sx4.Ex9.m1.1.1.3.3"><csymbol cd="ambiguous" id="Sx4.Ex9.m1.1.1.3.3.1.cmml" xref="Sx4.Ex9.m1.1.1.3.3">subscript</csymbol><ci id="Sx4.Ex9.m1.1.1.3.3.2.cmml" xref="Sx4.Ex9.m1.1.1.3.3.2">𝐿</ci><ci id="Sx4.Ex9.m1.1.1.3.3.3a.cmml" xref="Sx4.Ex9.m1.1.1.3.3.3"><mtext id="Sx4.Ex9.m1.1.1.3.3.3.cmml" mathsize="70%" xref="Sx4.Ex9.m1.1.1.3.3.3">con</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex9.m1.1c">L_{\text{total}}=L_{\text{attack}}+L_{\text{con}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex9.m1.1d">italic_L start_POSTSUBSCRIPT total end_POSTSUBSCRIPT = italic_L start_POSTSUBSCRIPT attack end_POSTSUBSCRIPT + italic_L start_POSTSUBSCRIPT con end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.SSx1.SSSx2.p2.2">Finally, compute the gradients of the embedding <math alttext="\hat{g}_{embedding}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx2.p2.1.m1.1"><semantics id="Sx4.SSx1.SSSx2.p2.1.m1.1a"><msub id="Sx4.SSx1.SSSx2.p2.1.m1.1.1" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.cmml"><mover accent="true" id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.cmml"><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.2" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.2.cmml">g</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.1" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mrow id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.cmml"><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.2" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.2.cmml">e</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.3" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.3.cmml">m</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1a" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.4" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.4.cmml">b</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1b" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.5" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.5.cmml">e</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1c" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.6" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.6.cmml">d</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1d" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.7" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.7.cmml">d</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1e" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.8" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.8.cmml">i</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1f" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.9" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.9.cmml">n</mi><mo id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1g" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.10" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.10.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p2.1.m1.1b"><apply id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.1.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1">subscript</csymbol><apply id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2"><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.1.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.1">^</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.2.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.2.2">𝑔</ci></apply><apply id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3"><times id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.1"></times><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.2.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.2">𝑒</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.3.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.3">𝑚</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.4.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.4">𝑏</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.5.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.5">𝑒</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.6.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.6">𝑑</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.7.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.7">𝑑</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.8.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.8">𝑖</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.9.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.9">𝑛</ci><ci id="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.10.cmml" xref="Sx4.SSx1.SSSx2.p2.1.m1.1.1.3.10">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p2.1.m1.1c">\hat{g}_{embedding}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx2.p2.1.m1.1d">over^ start_ARG italic_g end_ARG start_POSTSUBSCRIPT italic_e italic_m italic_b italic_e italic_d italic_d italic_i italic_n italic_g end_POSTSUBSCRIPT</annotation></semantics></math> and model <math alttext="\hat{g}_{model}" class="ltx_Math" display="inline" id="Sx4.SSx1.SSSx2.p2.2.m2.1"><semantics id="Sx4.SSx1.SSSx2.p2.2.m2.1a"><msub id="Sx4.SSx1.SSSx2.p2.2.m2.1.1" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.cmml"><mover accent="true" id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.cmml"><mi id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.2" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.2.cmml">g</mi><mo id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.1" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.cmml"><mi id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.2" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.2.cmml">m</mi><mo id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.3" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.3.cmml">o</mi><mo id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1a" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.4" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.4.cmml">d</mi><mo id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1b" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.5" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.5.cmml">e</mi><mo id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1c" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.6" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx1.SSSx2.p2.2.m2.1b"><apply id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.1.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1">subscript</csymbol><apply id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2"><ci id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.1.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.1">^</ci><ci id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.2.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.2.2">𝑔</ci></apply><apply id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3"><times id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.1"></times><ci id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.2.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.2">𝑚</ci><ci id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.3.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.3">𝑜</ci><ci id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.4.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.4">𝑑</ci><ci id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.5.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.5">𝑒</ci><ci id="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.6.cmml" xref="Sx4.SSx1.SSSx2.p2.2.m2.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx1.SSSx2.p2.2.m2.1c">\hat{g}_{model}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx1.SSSx2.p2.2.m2.1d">over^ start_ARG italic_g end_ARG start_POSTSUBSCRIPT italic_m italic_o italic_d italic_e italic_l end_POSTSUBSCRIPT</annotation></semantics></math> based on the loss function, and upload them to the server(step 5 &amp; 6).</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="Sx4.SSx2">
<h3 class="ltx_title ltx_title_subsection">Defense with Mixed-RFA</h3>
<div class="ltx_para" id="Sx4.SSx2.p1">
<p class="ltx_p" id="Sx4.SSx2.p1.4">In federated learning systems, particularly those applied to recommendation systems, robust aggregation strategies are crucial for performance and security. The geometric median (GM) of vectors <math alttext="w_{1},\ldots,w_{m}" class="ltx_Math" display="inline" id="Sx4.SSx2.p1.1.m1.3"><semantics id="Sx4.SSx2.p1.1.m1.3a"><mrow id="Sx4.SSx2.p1.1.m1.3.3.2" xref="Sx4.SSx2.p1.1.m1.3.3.3.cmml"><msub id="Sx4.SSx2.p1.1.m1.2.2.1.1" xref="Sx4.SSx2.p1.1.m1.2.2.1.1.cmml"><mi id="Sx4.SSx2.p1.1.m1.2.2.1.1.2" xref="Sx4.SSx2.p1.1.m1.2.2.1.1.2.cmml">w</mi><mn id="Sx4.SSx2.p1.1.m1.2.2.1.1.3" xref="Sx4.SSx2.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="Sx4.SSx2.p1.1.m1.3.3.2.3" xref="Sx4.SSx2.p1.1.m1.3.3.3.cmml">,</mo><mi id="Sx4.SSx2.p1.1.m1.1.1" mathvariant="normal" xref="Sx4.SSx2.p1.1.m1.1.1.cmml">…</mi><mo id="Sx4.SSx2.p1.1.m1.3.3.2.4" xref="Sx4.SSx2.p1.1.m1.3.3.3.cmml">,</mo><msub id="Sx4.SSx2.p1.1.m1.3.3.2.2" xref="Sx4.SSx2.p1.1.m1.3.3.2.2.cmml"><mi id="Sx4.SSx2.p1.1.m1.3.3.2.2.2" xref="Sx4.SSx2.p1.1.m1.3.3.2.2.2.cmml">w</mi><mi id="Sx4.SSx2.p1.1.m1.3.3.2.2.3" xref="Sx4.SSx2.p1.1.m1.3.3.2.2.3.cmml">m</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p1.1.m1.3b"><list id="Sx4.SSx2.p1.1.m1.3.3.3.cmml" xref="Sx4.SSx2.p1.1.m1.3.3.2"><apply id="Sx4.SSx2.p1.1.m1.2.2.1.1.cmml" xref="Sx4.SSx2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p1.1.m1.2.2.1.1.1.cmml" xref="Sx4.SSx2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="Sx4.SSx2.p1.1.m1.2.2.1.1.2.cmml" xref="Sx4.SSx2.p1.1.m1.2.2.1.1.2">𝑤</ci><cn id="Sx4.SSx2.p1.1.m1.2.2.1.1.3.cmml" type="integer" xref="Sx4.SSx2.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="Sx4.SSx2.p1.1.m1.1.1.cmml" xref="Sx4.SSx2.p1.1.m1.1.1">…</ci><apply id="Sx4.SSx2.p1.1.m1.3.3.2.2.cmml" xref="Sx4.SSx2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="Sx4.SSx2.p1.1.m1.3.3.2.2.1.cmml" xref="Sx4.SSx2.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="Sx4.SSx2.p1.1.m1.3.3.2.2.2.cmml" xref="Sx4.SSx2.p1.1.m1.3.3.2.2.2">𝑤</ci><ci id="Sx4.SSx2.p1.1.m1.3.3.2.2.3.cmml" xref="Sx4.SSx2.p1.1.m1.3.3.2.2.3">𝑚</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p1.1.m1.3c">w_{1},\ldots,w_{m}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx2.p1.1.m1.3d">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> in <math alttext="\mathbb{R}^{d}" class="ltx_Math" display="inline" id="Sx4.SSx2.p1.2.m2.1"><semantics id="Sx4.SSx2.p1.2.m2.1a"><msup id="Sx4.SSx2.p1.2.m2.1.1" xref="Sx4.SSx2.p1.2.m2.1.1.cmml"><mi id="Sx4.SSx2.p1.2.m2.1.1.2" xref="Sx4.SSx2.p1.2.m2.1.1.2.cmml">ℝ</mi><mi id="Sx4.SSx2.p1.2.m2.1.1.3" xref="Sx4.SSx2.p1.2.m2.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p1.2.m2.1b"><apply id="Sx4.SSx2.p1.2.m2.1.1.cmml" xref="Sx4.SSx2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p1.2.m2.1.1.1.cmml" xref="Sx4.SSx2.p1.2.m2.1.1">superscript</csymbol><ci id="Sx4.SSx2.p1.2.m2.1.1.2.cmml" xref="Sx4.SSx2.p1.2.m2.1.1.2">ℝ</ci><ci id="Sx4.SSx2.p1.2.m2.1.1.3.cmml" xref="Sx4.SSx2.p1.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p1.2.m2.1c">\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx2.p1.2.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> with weights <math alttext="\alpha_{1},\ldots,\alpha_{m}&gt;0" class="ltx_Math" display="inline" id="Sx4.SSx2.p1.3.m3.3"><semantics id="Sx4.SSx2.p1.3.m3.3a"><mrow id="Sx4.SSx2.p1.3.m3.3.3" xref="Sx4.SSx2.p1.3.m3.3.3.cmml"><mrow id="Sx4.SSx2.p1.3.m3.3.3.2.2" xref="Sx4.SSx2.p1.3.m3.3.3.2.3.cmml"><msub id="Sx4.SSx2.p1.3.m3.2.2.1.1.1" xref="Sx4.SSx2.p1.3.m3.2.2.1.1.1.cmml"><mi id="Sx4.SSx2.p1.3.m3.2.2.1.1.1.2" xref="Sx4.SSx2.p1.3.m3.2.2.1.1.1.2.cmml">α</mi><mn id="Sx4.SSx2.p1.3.m3.2.2.1.1.1.3" xref="Sx4.SSx2.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Sx4.SSx2.p1.3.m3.3.3.2.2.3" xref="Sx4.SSx2.p1.3.m3.3.3.2.3.cmml">,</mo><mi id="Sx4.SSx2.p1.3.m3.1.1" mathvariant="normal" xref="Sx4.SSx2.p1.3.m3.1.1.cmml">…</mi><mo id="Sx4.SSx2.p1.3.m3.3.3.2.2.4" xref="Sx4.SSx2.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="Sx4.SSx2.p1.3.m3.3.3.2.2.2" xref="Sx4.SSx2.p1.3.m3.3.3.2.2.2.cmml"><mi id="Sx4.SSx2.p1.3.m3.3.3.2.2.2.2" xref="Sx4.SSx2.p1.3.m3.3.3.2.2.2.2.cmml">α</mi><mi id="Sx4.SSx2.p1.3.m3.3.3.2.2.2.3" xref="Sx4.SSx2.p1.3.m3.3.3.2.2.2.3.cmml">m</mi></msub></mrow><mo id="Sx4.SSx2.p1.3.m3.3.3.3" xref="Sx4.SSx2.p1.3.m3.3.3.3.cmml">&gt;</mo><mn id="Sx4.SSx2.p1.3.m3.3.3.4" xref="Sx4.SSx2.p1.3.m3.3.3.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p1.3.m3.3b"><apply id="Sx4.SSx2.p1.3.m3.3.3.cmml" xref="Sx4.SSx2.p1.3.m3.3.3"><gt id="Sx4.SSx2.p1.3.m3.3.3.3.cmml" xref="Sx4.SSx2.p1.3.m3.3.3.3"></gt><list id="Sx4.SSx2.p1.3.m3.3.3.2.3.cmml" xref="Sx4.SSx2.p1.3.m3.3.3.2.2"><apply id="Sx4.SSx2.p1.3.m3.2.2.1.1.1.cmml" xref="Sx4.SSx2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx2.p1.3.m3.2.2.1.1.1.1.cmml" xref="Sx4.SSx2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="Sx4.SSx2.p1.3.m3.2.2.1.1.1.2.cmml" xref="Sx4.SSx2.p1.3.m3.2.2.1.1.1.2">𝛼</ci><cn id="Sx4.SSx2.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="Sx4.SSx2.p1.3.m3.2.2.1.1.1.3">1</cn></apply><ci id="Sx4.SSx2.p1.3.m3.1.1.cmml" xref="Sx4.SSx2.p1.3.m3.1.1">…</ci><apply id="Sx4.SSx2.p1.3.m3.3.3.2.2.2.cmml" xref="Sx4.SSx2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx2.p1.3.m3.3.3.2.2.2.1.cmml" xref="Sx4.SSx2.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="Sx4.SSx2.p1.3.m3.3.3.2.2.2.2.cmml" xref="Sx4.SSx2.p1.3.m3.3.3.2.2.2.2">𝛼</ci><ci id="Sx4.SSx2.p1.3.m3.3.3.2.2.2.3.cmml" xref="Sx4.SSx2.p1.3.m3.3.3.2.2.2.3">𝑚</ci></apply></list><cn id="Sx4.SSx2.p1.3.m3.3.3.4.cmml" type="integer" xref="Sx4.SSx2.p1.3.m3.3.3.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p1.3.m3.3c">\alpha_{1},\ldots,\alpha_{m}&gt;0</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx2.p1.3.m3.3d">italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_α start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT &gt; 0</annotation></semantics></math> provides a robust statistic, as it is defined as the minimizer <math alttext="v" class="ltx_Math" display="inline" id="Sx4.SSx2.p1.4.m4.1"><semantics id="Sx4.SSx2.p1.4.m4.1a"><mi id="Sx4.SSx2.p1.4.m4.1.1" xref="Sx4.SSx2.p1.4.m4.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p1.4.m4.1b"><ci id="Sx4.SSx2.p1.4.m4.1.1.cmml" xref="Sx4.SSx2.p1.4.m4.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p1.4.m4.1c">v</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx2.p1.4.m4.1d">italic_v</annotation></semantics></math> of the function:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="g(v)=\sum_{i=1}^{m}\alpha_{i}\|v-w_{i}\|" class="ltx_Math" display="block" id="Sx4.Ex10.m1.2"><semantics id="Sx4.Ex10.m1.2a"><mrow id="Sx4.Ex10.m1.2.2" xref="Sx4.Ex10.m1.2.2.cmml"><mrow id="Sx4.Ex10.m1.2.2.3" xref="Sx4.Ex10.m1.2.2.3.cmml"><mi id="Sx4.Ex10.m1.2.2.3.2" xref="Sx4.Ex10.m1.2.2.3.2.cmml">g</mi><mo id="Sx4.Ex10.m1.2.2.3.1" xref="Sx4.Ex10.m1.2.2.3.1.cmml">⁢</mo><mrow id="Sx4.Ex10.m1.2.2.3.3.2" xref="Sx4.Ex10.m1.2.2.3.cmml"><mo id="Sx4.Ex10.m1.2.2.3.3.2.1" stretchy="false" xref="Sx4.Ex10.m1.2.2.3.cmml">(</mo><mi id="Sx4.Ex10.m1.1.1" xref="Sx4.Ex10.m1.1.1.cmml">v</mi><mo id="Sx4.Ex10.m1.2.2.3.3.2.2" stretchy="false" xref="Sx4.Ex10.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx4.Ex10.m1.2.2.2" rspace="0.111em" xref="Sx4.Ex10.m1.2.2.2.cmml">=</mo><mrow id="Sx4.Ex10.m1.2.2.1" xref="Sx4.Ex10.m1.2.2.1.cmml"><munderover id="Sx4.Ex10.m1.2.2.1.2" xref="Sx4.Ex10.m1.2.2.1.2.cmml"><mo id="Sx4.Ex10.m1.2.2.1.2.2.2" movablelimits="false" xref="Sx4.Ex10.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="Sx4.Ex10.m1.2.2.1.2.2.3" xref="Sx4.Ex10.m1.2.2.1.2.2.3.cmml"><mi id="Sx4.Ex10.m1.2.2.1.2.2.3.2" xref="Sx4.Ex10.m1.2.2.1.2.2.3.2.cmml">i</mi><mo id="Sx4.Ex10.m1.2.2.1.2.2.3.1" xref="Sx4.Ex10.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="Sx4.Ex10.m1.2.2.1.2.2.3.3" xref="Sx4.Ex10.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx4.Ex10.m1.2.2.1.2.3" xref="Sx4.Ex10.m1.2.2.1.2.3.cmml">m</mi></munderover><mrow id="Sx4.Ex10.m1.2.2.1.1" xref="Sx4.Ex10.m1.2.2.1.1.cmml"><msub id="Sx4.Ex10.m1.2.2.1.1.3" xref="Sx4.Ex10.m1.2.2.1.1.3.cmml"><mi id="Sx4.Ex10.m1.2.2.1.1.3.2" xref="Sx4.Ex10.m1.2.2.1.1.3.2.cmml">α</mi><mi id="Sx4.Ex10.m1.2.2.1.1.3.3" xref="Sx4.Ex10.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="Sx4.Ex10.m1.2.2.1.1.2" xref="Sx4.Ex10.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="Sx4.Ex10.m1.2.2.1.1.1.1" xref="Sx4.Ex10.m1.2.2.1.1.1.2.cmml"><mo id="Sx4.Ex10.m1.2.2.1.1.1.1.2" stretchy="false" xref="Sx4.Ex10.m1.2.2.1.1.1.2.1.cmml">‖</mo><mrow id="Sx4.Ex10.m1.2.2.1.1.1.1.1" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.cmml"><mi id="Sx4.Ex10.m1.2.2.1.1.1.1.1.2" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.2.cmml">v</mi><mo id="Sx4.Ex10.m1.2.2.1.1.1.1.1.1" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="Sx4.Ex10.m1.2.2.1.1.1.1.1.3" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.cmml"><mi id="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.2" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.2.cmml">w</mi><mi id="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.3" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="Sx4.Ex10.m1.2.2.1.1.1.1.3" stretchy="false" xref="Sx4.Ex10.m1.2.2.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex10.m1.2b"><apply id="Sx4.Ex10.m1.2.2.cmml" xref="Sx4.Ex10.m1.2.2"><eq id="Sx4.Ex10.m1.2.2.2.cmml" xref="Sx4.Ex10.m1.2.2.2"></eq><apply id="Sx4.Ex10.m1.2.2.3.cmml" xref="Sx4.Ex10.m1.2.2.3"><times id="Sx4.Ex10.m1.2.2.3.1.cmml" xref="Sx4.Ex10.m1.2.2.3.1"></times><ci id="Sx4.Ex10.m1.2.2.3.2.cmml" xref="Sx4.Ex10.m1.2.2.3.2">𝑔</ci><ci id="Sx4.Ex10.m1.1.1.cmml" xref="Sx4.Ex10.m1.1.1">𝑣</ci></apply><apply id="Sx4.Ex10.m1.2.2.1.cmml" xref="Sx4.Ex10.m1.2.2.1"><apply id="Sx4.Ex10.m1.2.2.1.2.cmml" xref="Sx4.Ex10.m1.2.2.1.2"><csymbol cd="ambiguous" id="Sx4.Ex10.m1.2.2.1.2.1.cmml" xref="Sx4.Ex10.m1.2.2.1.2">superscript</csymbol><apply id="Sx4.Ex10.m1.2.2.1.2.2.cmml" xref="Sx4.Ex10.m1.2.2.1.2"><csymbol cd="ambiguous" id="Sx4.Ex10.m1.2.2.1.2.2.1.cmml" xref="Sx4.Ex10.m1.2.2.1.2">subscript</csymbol><sum id="Sx4.Ex10.m1.2.2.1.2.2.2.cmml" xref="Sx4.Ex10.m1.2.2.1.2.2.2"></sum><apply id="Sx4.Ex10.m1.2.2.1.2.2.3.cmml" xref="Sx4.Ex10.m1.2.2.1.2.2.3"><eq id="Sx4.Ex10.m1.2.2.1.2.2.3.1.cmml" xref="Sx4.Ex10.m1.2.2.1.2.2.3.1"></eq><ci id="Sx4.Ex10.m1.2.2.1.2.2.3.2.cmml" xref="Sx4.Ex10.m1.2.2.1.2.2.3.2">𝑖</ci><cn id="Sx4.Ex10.m1.2.2.1.2.2.3.3.cmml" type="integer" xref="Sx4.Ex10.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="Sx4.Ex10.m1.2.2.1.2.3.cmml" xref="Sx4.Ex10.m1.2.2.1.2.3">𝑚</ci></apply><apply id="Sx4.Ex10.m1.2.2.1.1.cmml" xref="Sx4.Ex10.m1.2.2.1.1"><times id="Sx4.Ex10.m1.2.2.1.1.2.cmml" xref="Sx4.Ex10.m1.2.2.1.1.2"></times><apply id="Sx4.Ex10.m1.2.2.1.1.3.cmml" xref="Sx4.Ex10.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="Sx4.Ex10.m1.2.2.1.1.3.1.cmml" xref="Sx4.Ex10.m1.2.2.1.1.3">subscript</csymbol><ci id="Sx4.Ex10.m1.2.2.1.1.3.2.cmml" xref="Sx4.Ex10.m1.2.2.1.1.3.2">𝛼</ci><ci id="Sx4.Ex10.m1.2.2.1.1.3.3.cmml" xref="Sx4.Ex10.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="Sx4.Ex10.m1.2.2.1.1.1.2.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="Sx4.Ex10.m1.2.2.1.1.1.2.1.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1.2">norm</csymbol><apply id="Sx4.Ex10.m1.2.2.1.1.1.1.1.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1"><minus id="Sx4.Ex10.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.1"></minus><ci id="Sx4.Ex10.m1.2.2.1.1.1.1.1.2.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.2">𝑣</ci><apply id="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.1.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.2.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.2">𝑤</ci><ci id="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.3.cmml" xref="Sx4.Ex10.m1.2.2.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex10.m1.2c">g(v)=\sum_{i=1}^{m}\alpha_{i}\|v-w_{i}\|</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex10.m1.2d">italic_g ( italic_v ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ italic_v - italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.SSx2.p1.5">The minimization of this function leads to a central point that minimizes the weighted Euclidean distance to all other points in the dataset, thereby enhancing the system’s resistance to outliers and adversarial attacks that might skew the aggregated results.</p>
</div>
<div class="ltx_para" id="Sx4.SSx2.p2">
<p class="ltx_p" id="Sx4.SSx2.p2.1">Despite its robustness, the geometric median often results in a significant degradation in the performance of recommendation systems. This degradation can occur because the GM may overly penalize the system’s ability to leverage informative but non-central local models, which are crucial for capturing diverse user preferences and behaviors effectively.</p>
</div>
<figure class="ltx_table" id="Sx4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Performance Metrics of Different Federated Learning Models Under Various Attack Vectors</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="Sx4.T1.1" style="width:438.5pt;height:360.8pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-54.8pt,45.0pt) scale(0.8,0.8) ;">
<table class="ltx_tabular ltx_align_middle" id="Sx4.T1.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx4.T1.1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.1" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.1.1">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.2.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.3.1">Attack</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.4.1">Mal. Client</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.5.1">HR@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.6" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.6.1">NDCG@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.7" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.7.1">ER@5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.8" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.8.1">ER@10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.9" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.9.1">ER@20</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.1.1.10" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.1.1.10.1">ER@30</span></td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.1" rowspan="12" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx4.T1.1.1.2.2.1.1">SASRec</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.2" rowspan="6" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx4.T1.1.1.2.2.2.1">ML-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.3" style="padding:1.5pt 8.5pt;">None</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.4" style="padding:1.5pt 8.5pt;">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.5" style="padding:1.5pt 8.5pt;">0.1061</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.6" style="padding:1.5pt 8.5pt;">0.0505</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.8" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.9" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.2.2.10" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.3.3">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.3.3.1" style="padding:1.5pt 8.5pt;">RA</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.3.3.2" style="padding:1.5pt 8.5pt;">0.1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.3.3.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.3.3.3.1">0.1061</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.3.3.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.3.3.4.1">0.0508</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.3.3.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.3.3.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.3.3.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.3.3.8" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.4.4">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.4.4.1" style="padding:1.5pt 8.5pt;">EB</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.4.4.2" style="padding:1.5pt 8.5pt;">0.1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.4.4.3" style="padding:1.5pt 8.5pt;">0.1038</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.4.4.4" style="padding:1.5pt 8.5pt;">0.0499</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.4.4.5" style="padding:1.5pt 8.5pt;">0.0023</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.4.4.6" style="padding:1.5pt 8.5pt;">0.0161</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.4.4.7" style="padding:1.5pt 8.5pt;">0.1068</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.4.4.8" style="padding:1.5pt 8.5pt;">0.2916</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.5.5">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.5.5.1" style="padding:1.5pt 8.5pt;">A-ra</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.5.5.2" style="padding:1.5pt 8.5pt;">0.1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.5.5.3" style="padding:1.5pt 8.5pt;">0.1050</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.5.5.4" style="padding:1.5pt 8.5pt;">0.0499</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.5.5.5" style="padding:1.5pt 8.5pt;">0.0028</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.5.5.6" style="padding:1.5pt 8.5pt;">0.1062</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.5.5.7" style="padding:1.5pt 8.5pt;">0.1111</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.5.5.8" style="padding:1.5pt 8.5pt;">0.3031</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.6.6.1" rowspan="2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.6.6.1.1">DV-FSR</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.6.6.2" style="padding:1.5pt 8.5pt;">0.1%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.6.6.3" style="padding:1.5pt 8.5pt;">0.0929</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.6.6.4" style="padding:1.5pt 8.5pt;">0.0372</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.6.6.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.6.6.5.1">0.9890</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.6.6.6" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.6.6.6.1">0.9981</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.6.6.7" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.6.6.7.1">1.0000</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.6.6.8" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.6.6.8.1">1.0000</span></td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.7.7">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.7.7.1" style="padding:1.5pt 8.5pt;">0.05%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.7.7.2" style="padding:1.5pt 8.5pt;">0.0969</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.7.7.3" style="padding:1.5pt 8.5pt;">0.0421</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.7.7.4" style="padding:1.5pt 8.5pt;">0.9701</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.7.7.5" style="padding:1.5pt 8.5pt;">0.9851</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.7.7.6" style="padding:1.5pt 8.5pt;">1.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.7.7.7" style="padding:1.5pt 8.5pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.1" rowspan="6" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx4.T1.1.1.8.8.1.1">Steam</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.2" style="padding:1.5pt 8.5pt;">None</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.3" style="padding:1.5pt 8.5pt;">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.4" style="padding:1.5pt 8.5pt;">0.3141</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.5" style="padding:1.5pt 8.5pt;">0.1546</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.8" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.8.8.9" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.9.9">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.9.9.1" style="padding:1.5pt 8.5pt;">RA</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.9.9.2" style="padding:1.5pt 8.5pt;">0.1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.9.9.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.9.9.3.1">0.3307</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.9.9.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.9.9.4.1">0.1732</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.9.9.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.9.9.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.9.9.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.9.9.8" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.10.10">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.10.10.1" style="padding:1.5pt 8.5pt;">EB</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.10.10.2" style="padding:1.5pt 8.5pt;">0.1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.10.10.3" style="padding:1.5pt 8.5pt;">0.3109</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.10.10.4" style="padding:1.5pt 8.5pt;">0.1591</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.10.10.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.10.10.6" style="padding:1.5pt 8.5pt;">0.0003</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.10.10.7" style="padding:1.5pt 8.5pt;">0.0144</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.10.10.8" style="padding:1.5pt 8.5pt;">0.1148</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.11.11">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.11.11.1" style="padding:1.5pt 8.5pt;">A-ra</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.11.11.2" style="padding:1.5pt 8.5pt;">0.1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.11.11.3" style="padding:1.5pt 8.5pt;">0.3131</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.11.11.4" style="padding:1.5pt 8.5pt;">0.1590</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.11.11.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.11.11.6" style="padding:1.5pt 8.5pt;">0.0003</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.11.11.7" style="padding:1.5pt 8.5pt;">0.0160</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.11.11.8" style="padding:1.5pt 8.5pt;">0.1156</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.12.12">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.12.12.1" rowspan="2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.12.12.1.1">DV-FSR</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.12.12.2" style="padding:1.5pt 8.5pt;">0.1%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.12.12.3" style="padding:1.5pt 8.5pt;">0.2944</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.12.12.4" style="padding:1.5pt 8.5pt;">0.1411</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.12.12.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.12.12.5.1">0.9169</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.12.12.6" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.12.12.6.1">0.9997</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.12.12.7" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.12.12.7.1">1.0000</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.12.12.8" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.12.12.8.1">1.0000</span></td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.13.13">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.13.13.1" style="padding:1.5pt 8.5pt;">0.05%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.13.13.2" style="padding:1.5pt 8.5pt;">0.3131</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.13.13.3" style="padding:1.5pt 8.5pt;">0.1623</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.13.13.4" style="padding:1.5pt 8.5pt;">0.0011</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.13.13.5" style="padding:1.5pt 8.5pt;">0.0117</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.13.13.6" style="padding:1.5pt 8.5pt;">0.2950</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.13.13.7" style="padding:1.5pt 8.5pt;">0.8311</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.14.14">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="Sx4.T1.1.1.14.14.1" rowspan="12" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx4.T1.1.1.14.14.1.1">BERT4Rec</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.2" rowspan="6" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx4.T1.1.1.14.14.2.1">ML-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.3" style="padding:1.5pt 8.5pt;">None</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.4" style="padding:1.5pt 8.5pt;">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.5" style="padding:1.5pt 8.5pt;">0.1174</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.6" style="padding:1.5pt 8.5pt;">0.0564</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.8" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.9" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.14.14.10" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.15.15">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.15.15.1" style="padding:1.5pt 8.5pt;">RA</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.15.15.2" style="padding:1.5pt 8.5pt;">1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.15.15.3" style="padding:1.5pt 8.5pt;">0.1184</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.15.15.4" style="padding:1.5pt 8.5pt;">0.0567</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.15.15.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.15.15.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.15.15.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.15.15.8" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.16.16">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.16.16.1" style="padding:1.5pt 8.5pt;">EB</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.16.16.2" style="padding:1.5pt 8.5pt;">1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.16.16.3" style="padding:1.5pt 8.5pt;">0.1172</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.16.16.4" style="padding:1.5pt 8.5pt;">0.0571</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.16.16.5" style="padding:1.5pt 8.5pt;">0.0018</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.16.16.6" style="padding:1.5pt 8.5pt;">0.0086</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.16.16.7" style="padding:1.5pt 8.5pt;">0.0526</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.16.16.8" style="padding:1.5pt 8.5pt;">0.1879</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.17.17">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.17.17.1" style="padding:1.5pt 8.5pt;">A-ra</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.17.17.2" style="padding:1.5pt 8.5pt;">1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.17.17.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.17.17.3.1">0.1189</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.17.17.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.17.17.4.1">0.0577</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.17.17.5" style="padding:1.5pt 8.5pt;">0.0012</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.17.17.6" style="padding:1.5pt 8.5pt;">0.0084</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.17.17.7" style="padding:1.5pt 8.5pt;">0.0553</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.17.17.8" style="padding:1.5pt 8.5pt;">0.1930</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.18.18">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.18.18.1" rowspan="2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.18.18.1.1">DV-FSR</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.18.18.2" style="padding:1.5pt 8.5pt;">1%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.18.18.3" style="padding:1.5pt 8.5pt;">0.1058</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.18.18.4" style="padding:1.5pt 8.5pt;">0.0422</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.18.18.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.18.18.5.1">0.9531</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.18.18.6" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.18.18.6.1">0.9872</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.18.18.7" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.18.18.7.1">1.0000</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.18.18.8" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.18.18.8.1">1.0000</span></td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.19.19">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.19.19.1" style="padding:1.5pt 8.5pt;">0.2%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.19.19.2" style="padding:1.5pt 8.5pt;">0.1132</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.19.19.3" style="padding:1.5pt 8.5pt;">0.0554</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.19.19.4" style="padding:1.5pt 8.5pt;">0.1152</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.19.19.5" style="padding:1.5pt 8.5pt;">0.4518</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.19.19.6" style="padding:1.5pt 8.5pt;">0.9767</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.19.19.7" style="padding:1.5pt 8.5pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.20.20">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="Sx4.T1.1.1.20.20.1" rowspan="6" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx4.T1.1.1.20.20.1.1">Steam</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.20.20.2" style="padding:1.5pt 8.5pt;">None</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.20.20.3" style="padding:1.5pt 8.5pt;">0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.20.20.4" style="padding:1.5pt 8.5pt;">0.3293</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.20.20.5" style="padding:1.5pt 8.5pt;">0.1697</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.20.20.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.20.20.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.20.20.8" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.20.20.9" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.21.21">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.21.21.1" style="padding:1.5pt 8.5pt;">RA</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.21.21.2" style="padding:1.5pt 8.5pt;">1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.21.21.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.21.21.3.1">0.3339</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.21.21.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.21.21.4.1">0.1737</span></td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.21.21.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.21.21.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.21.21.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.21.21.8" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.22.22">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.22.22.1" style="padding:1.5pt 8.5pt;">EB</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.22.22.2" style="padding:1.5pt 8.5pt;">1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.22.22.3" style="padding:1.5pt 8.5pt;">0.3304</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.22.22.4" style="padding:1.5pt 8.5pt;">0.1700</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.22.22.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.22.22.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.22.22.7" style="padding:1.5pt 8.5pt;">0.0037</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.22.22.8" style="padding:1.5pt 8.5pt;">0.1423</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.23.23">
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.23.23.1" style="padding:1.5pt 8.5pt;">A-ra</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.23.23.2" style="padding:1.5pt 8.5pt;">1%</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.23.23.3" style="padding:1.5pt 8.5pt;">0.3312</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.23.23.4" style="padding:1.5pt 8.5pt;">0.1705</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.23.23.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.23.23.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.23.23.7" style="padding:1.5pt 8.5pt;">0.0035</td>
<td class="ltx_td ltx_align_center" id="Sx4.T1.1.1.23.23.8" style="padding:1.5pt 8.5pt;">0.1335</td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.24.24">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="Sx4.T1.1.1.24.24.1" rowspan="2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.24.24.1.1">DV-FSR</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.24.24.2" style="padding:1.5pt 8.5pt;">1%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.24.24.3" style="padding:1.5pt 8.5pt;">0.3128</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.24.24.4" style="padding:1.5pt 8.5pt;">0.1417</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.24.24.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.24.24.5.1">0.9324</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.24.24.6" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.24.24.6.1">0.9892</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.24.24.7" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.24.24.7.1">1.0000</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T1.1.1.24.24.8" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx4.T1.1.1.24.24.8.1">1.0000</span></td>
</tr>
<tr class="ltx_tr" id="Sx4.T1.1.1.25.25">
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.1.1.25.25.1" style="padding:1.5pt 8.5pt;">0.2%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.1.1.25.25.2" style="padding:1.5pt 8.5pt;">0.3304</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.1.1.25.25.3" style="padding:1.5pt 8.5pt;">0.1699</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.1.1.25.25.4" style="padding:1.5pt 8.5pt;">0.0059</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.1.1.25.25.5" style="padding:1.5pt 8.5pt;">0.1492</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.1.1.25.25.6" style="padding:1.5pt 8.5pt;">0.9379</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx4.T1.1.1.25.25.7" style="padding:1.5pt 8.5pt;">1.0000</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="Sx4.SSx2.p3">
<p class="ltx_p" id="Sx4.SSx2.p3.3">To address these limitations, we propose a novel hybrid federated aggregation algorithm that combines the robustness of the geometric median with the performance efficiency of traditional averaging methods. The proposed method can be formalized as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.Ex11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="v=\lambda\left(\sum_{i=1}^{m}\alpha_{i}w_{i}\right)+(1-\lambda)\cdot\text{GM}(%
w_{1},...,w_{m};\alpha_{1},...,\alpha_{m})" class="ltx_Math" display="block" id="Sx4.Ex11.m1.8"><semantics id="Sx4.Ex11.m1.8a"><mrow id="Sx4.Ex11.m1.8.8" xref="Sx4.Ex11.m1.8.8.cmml"><mi id="Sx4.Ex11.m1.8.8.8" xref="Sx4.Ex11.m1.8.8.8.cmml">v</mi><mo id="Sx4.Ex11.m1.8.8.7" xref="Sx4.Ex11.m1.8.8.7.cmml">=</mo><mrow id="Sx4.Ex11.m1.8.8.6" xref="Sx4.Ex11.m1.8.8.6.cmml"><mrow id="Sx4.Ex11.m1.3.3.1.1" xref="Sx4.Ex11.m1.3.3.1.1.cmml"><mi id="Sx4.Ex11.m1.3.3.1.1.3" xref="Sx4.Ex11.m1.3.3.1.1.3.cmml">λ</mi><mo id="Sx4.Ex11.m1.3.3.1.1.2" xref="Sx4.Ex11.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="Sx4.Ex11.m1.3.3.1.1.1.1" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.cmml"><mo id="Sx4.Ex11.m1.3.3.1.1.1.1.2" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.Ex11.m1.3.3.1.1.1.1.1" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.cmml"><munderover id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.cmml"><mo id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.2" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.1" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.3" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.3" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.3.cmml">m</mi></munderover><mrow id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.cmml"><msub id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.cmml"><mi id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.2" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.2.cmml">α</mi><mi id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.3" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.1" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.cmml"><mi id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.2" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.2.cmml">w</mi><mi id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.3" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="Sx4.Ex11.m1.3.3.1.1.1.1.3" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx4.Ex11.m1.8.8.6.7" xref="Sx4.Ex11.m1.8.8.6.7.cmml">+</mo><mrow id="Sx4.Ex11.m1.8.8.6.6" xref="Sx4.Ex11.m1.8.8.6.6.cmml"><mrow id="Sx4.Ex11.m1.4.4.2.2.1" xref="Sx4.Ex11.m1.4.4.2.2.1.cmml"><mrow id="Sx4.Ex11.m1.4.4.2.2.1.1.1" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.cmml"><mo id="Sx4.Ex11.m1.4.4.2.2.1.1.1.2" stretchy="false" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.cmml">(</mo><mrow id="Sx4.Ex11.m1.4.4.2.2.1.1.1.1" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.cmml"><mn id="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.2" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.2.cmml">1</mn><mo id="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.1" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.1.cmml">−</mo><mi id="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.3" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.3.cmml">λ</mi></mrow><mo id="Sx4.Ex11.m1.4.4.2.2.1.1.1.3" rspace="0.055em" stretchy="false" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="Sx4.Ex11.m1.4.4.2.2.1.2" rspace="0.222em" xref="Sx4.Ex11.m1.4.4.2.2.1.2.cmml">⋅</mo><mtext id="Sx4.Ex11.m1.4.4.2.2.1.3" xref="Sx4.Ex11.m1.4.4.2.2.1.3a.cmml">GM</mtext></mrow><mo id="Sx4.Ex11.m1.8.8.6.6.6" xref="Sx4.Ex11.m1.8.8.6.6.6.cmml">⁢</mo><mrow id="Sx4.Ex11.m1.8.8.6.6.5.4" xref="Sx4.Ex11.m1.8.8.6.6.5.5.cmml"><mo id="Sx4.Ex11.m1.8.8.6.6.5.4.5" stretchy="false" xref="Sx4.Ex11.m1.8.8.6.6.5.5.cmml">(</mo><msub id="Sx4.Ex11.m1.5.5.3.3.2.1.1" xref="Sx4.Ex11.m1.5.5.3.3.2.1.1.cmml"><mi id="Sx4.Ex11.m1.5.5.3.3.2.1.1.2" xref="Sx4.Ex11.m1.5.5.3.3.2.1.1.2.cmml">w</mi><mn id="Sx4.Ex11.m1.5.5.3.3.2.1.1.3" xref="Sx4.Ex11.m1.5.5.3.3.2.1.1.3.cmml">1</mn></msub><mo id="Sx4.Ex11.m1.8.8.6.6.5.4.6" xref="Sx4.Ex11.m1.8.8.6.6.5.5.cmml">,</mo><mi id="Sx4.Ex11.m1.1.1" mathvariant="normal" xref="Sx4.Ex11.m1.1.1.cmml">…</mi><mo id="Sx4.Ex11.m1.8.8.6.6.5.4.7" xref="Sx4.Ex11.m1.8.8.6.6.5.5.cmml">,</mo><msub id="Sx4.Ex11.m1.6.6.4.4.3.2.2" xref="Sx4.Ex11.m1.6.6.4.4.3.2.2.cmml"><mi id="Sx4.Ex11.m1.6.6.4.4.3.2.2.2" xref="Sx4.Ex11.m1.6.6.4.4.3.2.2.2.cmml">w</mi><mi id="Sx4.Ex11.m1.6.6.4.4.3.2.2.3" xref="Sx4.Ex11.m1.6.6.4.4.3.2.2.3.cmml">m</mi></msub><mo id="Sx4.Ex11.m1.8.8.6.6.5.4.8" xref="Sx4.Ex11.m1.8.8.6.6.5.5.cmml">;</mo><msub id="Sx4.Ex11.m1.7.7.5.5.4.3.3" xref="Sx4.Ex11.m1.7.7.5.5.4.3.3.cmml"><mi id="Sx4.Ex11.m1.7.7.5.5.4.3.3.2" xref="Sx4.Ex11.m1.7.7.5.5.4.3.3.2.cmml">α</mi><mn id="Sx4.Ex11.m1.7.7.5.5.4.3.3.3" xref="Sx4.Ex11.m1.7.7.5.5.4.3.3.3.cmml">1</mn></msub><mo id="Sx4.Ex11.m1.8.8.6.6.5.4.9" xref="Sx4.Ex11.m1.8.8.6.6.5.5.cmml">,</mo><mi id="Sx4.Ex11.m1.2.2" mathvariant="normal" xref="Sx4.Ex11.m1.2.2.cmml">…</mi><mo id="Sx4.Ex11.m1.8.8.6.6.5.4.10" xref="Sx4.Ex11.m1.8.8.6.6.5.5.cmml">,</mo><msub id="Sx4.Ex11.m1.8.8.6.6.5.4.4" xref="Sx4.Ex11.m1.8.8.6.6.5.4.4.cmml"><mi id="Sx4.Ex11.m1.8.8.6.6.5.4.4.2" xref="Sx4.Ex11.m1.8.8.6.6.5.4.4.2.cmml">α</mi><mi id="Sx4.Ex11.m1.8.8.6.6.5.4.4.3" xref="Sx4.Ex11.m1.8.8.6.6.5.4.4.3.cmml">m</mi></msub><mo id="Sx4.Ex11.m1.8.8.6.6.5.4.11" stretchy="false" xref="Sx4.Ex11.m1.8.8.6.6.5.5.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.Ex11.m1.8b"><apply id="Sx4.Ex11.m1.8.8.cmml" xref="Sx4.Ex11.m1.8.8"><eq id="Sx4.Ex11.m1.8.8.7.cmml" xref="Sx4.Ex11.m1.8.8.7"></eq><ci id="Sx4.Ex11.m1.8.8.8.cmml" xref="Sx4.Ex11.m1.8.8.8">𝑣</ci><apply id="Sx4.Ex11.m1.8.8.6.cmml" xref="Sx4.Ex11.m1.8.8.6"><plus id="Sx4.Ex11.m1.8.8.6.7.cmml" xref="Sx4.Ex11.m1.8.8.6.7"></plus><apply id="Sx4.Ex11.m1.3.3.1.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1"><times id="Sx4.Ex11.m1.3.3.1.1.2.cmml" xref="Sx4.Ex11.m1.3.3.1.1.2"></times><ci id="Sx4.Ex11.m1.3.3.1.1.3.cmml" xref="Sx4.Ex11.m1.3.3.1.1.3">𝜆</ci><apply id="Sx4.Ex11.m1.3.3.1.1.1.1.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1"><apply id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1">superscript</csymbol><apply id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1">subscript</csymbol><sum id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.2"></sum><apply id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3"><eq id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.1"></eq><ci id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.2">𝑖</ci><cn id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.3.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2"><times id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.1"></times><apply id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2">subscript</csymbol><ci id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.2">𝛼</ci><ci id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.1.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3">subscript</csymbol><ci id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.2.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.2">𝑤</ci><ci id="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.3.cmml" xref="Sx4.Ex11.m1.3.3.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="Sx4.Ex11.m1.8.8.6.6.cmml" xref="Sx4.Ex11.m1.8.8.6.6"><times id="Sx4.Ex11.m1.8.8.6.6.6.cmml" xref="Sx4.Ex11.m1.8.8.6.6.6"></times><apply id="Sx4.Ex11.m1.4.4.2.2.1.cmml" xref="Sx4.Ex11.m1.4.4.2.2.1"><ci id="Sx4.Ex11.m1.4.4.2.2.1.2.cmml" xref="Sx4.Ex11.m1.4.4.2.2.1.2">⋅</ci><apply id="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.cmml" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1"><minus id="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.1.cmml" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.1"></minus><cn id="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.2.cmml" type="integer" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.2">1</cn><ci id="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.3.cmml" xref="Sx4.Ex11.m1.4.4.2.2.1.1.1.1.3">𝜆</ci></apply><ci id="Sx4.Ex11.m1.4.4.2.2.1.3a.cmml" xref="Sx4.Ex11.m1.4.4.2.2.1.3"><mtext id="Sx4.Ex11.m1.4.4.2.2.1.3.cmml" xref="Sx4.Ex11.m1.4.4.2.2.1.3">GM</mtext></ci></apply><vector id="Sx4.Ex11.m1.8.8.6.6.5.5.cmml" xref="Sx4.Ex11.m1.8.8.6.6.5.4"><apply id="Sx4.Ex11.m1.5.5.3.3.2.1.1.cmml" xref="Sx4.Ex11.m1.5.5.3.3.2.1.1"><csymbol cd="ambiguous" id="Sx4.Ex11.m1.5.5.3.3.2.1.1.1.cmml" xref="Sx4.Ex11.m1.5.5.3.3.2.1.1">subscript</csymbol><ci id="Sx4.Ex11.m1.5.5.3.3.2.1.1.2.cmml" xref="Sx4.Ex11.m1.5.5.3.3.2.1.1.2">𝑤</ci><cn id="Sx4.Ex11.m1.5.5.3.3.2.1.1.3.cmml" type="integer" xref="Sx4.Ex11.m1.5.5.3.3.2.1.1.3">1</cn></apply><ci id="Sx4.Ex11.m1.1.1.cmml" xref="Sx4.Ex11.m1.1.1">…</ci><apply id="Sx4.Ex11.m1.6.6.4.4.3.2.2.cmml" xref="Sx4.Ex11.m1.6.6.4.4.3.2.2"><csymbol cd="ambiguous" id="Sx4.Ex11.m1.6.6.4.4.3.2.2.1.cmml" xref="Sx4.Ex11.m1.6.6.4.4.3.2.2">subscript</csymbol><ci id="Sx4.Ex11.m1.6.6.4.4.3.2.2.2.cmml" xref="Sx4.Ex11.m1.6.6.4.4.3.2.2.2">𝑤</ci><ci id="Sx4.Ex11.m1.6.6.4.4.3.2.2.3.cmml" xref="Sx4.Ex11.m1.6.6.4.4.3.2.2.3">𝑚</ci></apply><apply id="Sx4.Ex11.m1.7.7.5.5.4.3.3.cmml" xref="Sx4.Ex11.m1.7.7.5.5.4.3.3"><csymbol cd="ambiguous" id="Sx4.Ex11.m1.7.7.5.5.4.3.3.1.cmml" xref="Sx4.Ex11.m1.7.7.5.5.4.3.3">subscript</csymbol><ci id="Sx4.Ex11.m1.7.7.5.5.4.3.3.2.cmml" xref="Sx4.Ex11.m1.7.7.5.5.4.3.3.2">𝛼</ci><cn id="Sx4.Ex11.m1.7.7.5.5.4.3.3.3.cmml" type="integer" xref="Sx4.Ex11.m1.7.7.5.5.4.3.3.3">1</cn></apply><ci id="Sx4.Ex11.m1.2.2.cmml" xref="Sx4.Ex11.m1.2.2">…</ci><apply id="Sx4.Ex11.m1.8.8.6.6.5.4.4.cmml" xref="Sx4.Ex11.m1.8.8.6.6.5.4.4"><csymbol cd="ambiguous" id="Sx4.Ex11.m1.8.8.6.6.5.4.4.1.cmml" xref="Sx4.Ex11.m1.8.8.6.6.5.4.4">subscript</csymbol><ci id="Sx4.Ex11.m1.8.8.6.6.5.4.4.2.cmml" xref="Sx4.Ex11.m1.8.8.6.6.5.4.4.2">𝛼</ci><ci id="Sx4.Ex11.m1.8.8.6.6.5.4.4.3.cmml" xref="Sx4.Ex11.m1.8.8.6.6.5.4.4.3">𝑚</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.Ex11.m1.8c">v=\lambda\left(\sum_{i=1}^{m}\alpha_{i}w_{i}\right)+(1-\lambda)\cdot\text{GM}(%
w_{1},...,w_{m};\alpha_{1},...,\alpha_{m})</annotation><annotation encoding="application/x-llamapun" id="Sx4.Ex11.m1.8d">italic_v = italic_λ ( ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + ( 1 - italic_λ ) ⋅ GM ( italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_w start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ; italic_α start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_α start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.SSx2.p3.2">Here, <math alttext="\lambda" class="ltx_Math" display="inline" id="Sx4.SSx2.p3.1.m1.1"><semantics id="Sx4.SSx2.p3.1.m1.1a"><mi id="Sx4.SSx2.p3.1.m1.1.1" xref="Sx4.SSx2.p3.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.1.m1.1b"><ci id="Sx4.SSx2.p3.1.m1.1.1.cmml" xref="Sx4.SSx2.p3.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx2.p3.1.m1.1d">italic_λ</annotation></semantics></math> is a tuning parameter that balances the influence of the simple weighted average and the geometric median in the final aggregation. By adjusting <math alttext="\lambda" class="ltx_Math" display="inline" id="Sx4.SSx2.p3.2.m2.1"><semantics id="Sx4.SSx2.p3.2.m2.1a"><mi id="Sx4.SSx2.p3.2.m2.1.1" xref="Sx4.SSx2.p3.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx2.p3.2.m2.1b"><ci id="Sx4.SSx2.p3.2.m2.1.1.cmml" xref="Sx4.SSx2.p3.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx2.p3.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx2.p3.2.m2.1d">italic_λ</annotation></semantics></math>, the system can be tailored to prioritize either robustness or performance according to the specific needs and threat models of the federated environment.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx5">
<h2 class="ltx_title ltx_title_section">Experiments</h2>
<div class="ltx_para" id="Sx5.p1">
<p class="ltx_p" id="Sx5.p1.1">In this section, we conduct several experiments to answer the following research questions(RQs):</p>
<ul class="ltx_itemize" id="Sx5.I4">
<li class="ltx_item" id="Sx5.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx5.I4.i1.p1">
<p class="ltx_p" id="Sx5.I4.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx5.I4.i1.p1.1.1">RQ1:</span> How is the effectiveness of our attack compared to that of existing attacks?</p>
</div>
</li>
<li class="ltx_item" id="Sx5.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx5.I4.i2.p1">
<p class="ltx_p" id="Sx5.I4.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Sx5.I4.i2.p1.1.1">RQ2:</span> Does the architecture of different models significantly impact their susceptibility to attacks in federeated sequential recommendation?</p>
</div>
</li>
<li class="ltx_item" id="Sx5.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx5.I4.i3.p1">
<p class="ltx_p" id="Sx5.I4.i3.p1.1"><span class="ltx_text ltx_font_bold" id="Sx5.I4.i3.p1.1.1">RQ3:</span> How does the ratio of malicious clients affect the performance of our attack methods?</p>
</div>
</li>
<li class="ltx_item" id="Sx5.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx5.I4.i4.p1">
<p class="ltx_p" id="Sx5.I4.i4.p1.1"><span class="ltx_text ltx_font_bold" id="Sx5.I4.i4.p1.1.1">RQ4:</span> How does our attack method DV-FSR perform under defensive mechanisms mixed-RFA?</p>
</div>
</li>
<li class="ltx_item" id="Sx5.I4.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx5.I4.i5.p1">
<p class="ltx_p" id="Sx5.I4.i5.p1.1"><span class="ltx_text ltx_font_bold" id="Sx5.I4.i5.p1.1.1">RQ5:</span> Are the implicit and explicit strategy in our attack method truly effective?</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="Sx5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span> Sizes of Datasets</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="Sx5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Sx5.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="Sx5.T2.1.1.1.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T2.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="Sx5.T2.1.1.1.2" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T2.1.1.1.2.1">#Users</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="Sx5.T2.1.1.1.3" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T2.1.1.1.3.1">#Items</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="Sx5.T2.1.1.1.4" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T2.1.1.1.4.1">#Interactions</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="Sx5.T2.1.1.1.5" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T2.1.1.1.5.1">#Sparsity</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx5.T2.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="Sx5.T2.1.2.1.1" style="padding-left:5.0pt;padding-right:5.0pt;">ML-1M</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T2.1.2.1.2" style="padding-left:5.0pt;padding-right:5.0pt;">6,040</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T2.1.2.1.3" style="padding-left:5.0pt;padding-right:5.0pt;">3,706</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T2.1.2.1.4" style="padding-left:5.0pt;padding-right:5.0pt;">1,000,209</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T2.1.2.1.5" style="padding-left:5.0pt;padding-right:5.0pt;">95.53%</td>
</tr>
<tr class="ltx_tr" id="Sx5.T2.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="Sx5.T2.1.3.2.1" style="padding-left:5.0pt;padding-right:5.0pt;">Steam</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="Sx5.T2.1.3.2.2" style="padding-left:5.0pt;padding-right:5.0pt;">3,753</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="Sx5.T2.1.3.2.3" style="padding-left:5.0pt;padding-right:5.0pt;">5,134</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="Sx5.T2.1.3.2.4" style="padding-left:5.0pt;padding-right:5.0pt;">114,713</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="Sx5.T2.1.3.2.5" style="padding-left:5.0pt;padding-right:5.0pt;">99.40%</td>
</tr>
</tbody>
</table>
</figure>
<section class="ltx_subsection" id="Sx5.SSx1">
<h3 class="ltx_title ltx_title_subsection">Datasets and Experiment Setting</h3>
<section class="ltx_paragraph" id="Sx5.SSx1.SSSx2.Px1">
<h5 class="ltx_title ltx_title_paragraph">Dataset.</h5>
<div class="ltx_para" id="Sx5.SSx1.SSSx2.Px1.p1">
<p class="ltx_p" id="Sx5.SSx1.SSSx2.Px1.p1.1">We use two real-world datasets in two completely different scenarios (movie recommendation and game recommendation) for our experiments. The two datasets are: <span class="ltx_text ltx_font_bold" id="Sx5.SSx1.SSSx2.Px1.p1.1.1">MovieLens-1M</span> (ML-1M) <cite class="ltx_cite ltx_citemacro_citep">(Harper and Konstan <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib10" title="">2015</a>)</cite> and <span class="ltx_text ltx_font_bold" id="Sx5.SSx1.SSSx2.Px1.p1.1.2">Steam-200K</span> (Steam) <cite class="ltx_cite ltx_citemacro_citep">(Cheuque, Guzmán, and Parra <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib8" title="">2019</a>)</cite>. Their sizes are show in Table 2. Following previous works, we adopt the leave-one-out approach and hold out the latest interacted item of each user as the test data. We use the item before the last one for training.</p>
</div>
</section>
<section class="ltx_paragraph" id="Sx5.SSx1.SSSx2.Px2">
<h5 class="ltx_title ltx_title_paragraph">Experiment Setting.</h5>
<div class="ltx_para" id="Sx5.SSx1.SSSx2.Px2.p1">
<p class="ltx_p" id="Sx5.SSx1.SSSx2.Px2.p1.2">In our experiment, we choose the widely used SASRec and BERT4Rec as the recommendation model. We used FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib22" title="">2017</a>)</cite> as the federated learning (FL) framework. Each user is treated as a client in the FedRec system. We randomly select 0.1%, 0.2%, 0.3%, 0.4%, 0.5%, 1% of users from the entire user set <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1"><semantics id="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1.1" xref="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1b"><ci id="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1.1.cmml" xref="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="Sx5.SSx1.SSSx2.Px2.p1.1.m1.1d">caligraphic_U</annotation></semantics></math> and take them as malicious clients. Following <cite class="ltx_cite ltx_citemacro_citep">(Rong et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib26" title="">2022</a>)</cite>, we use the <span class="ltx_text ltx_font_italic" id="Sx5.SSx1.SSSx2.Px2.p1.2.1">Hit Ratio(HR)</span> and the <span class="ltx_text ltx_font_italic" id="Sx5.SSx1.SSSx2.Px2.p1.2.2">Normalized Discounted Cumulative Gain(NDCG)</span> over the top 10 ranked items for test item to measure the performance of the recommendation model. We adopt average <span class="ltx_text ltx_font_italic" id="Sx5.SSx1.SSSx2.Px2.p1.2.3">Exposure Ratio at K (ER@K)</span> of target items as our metric to measure the target item attack effectiveness. In our experiments, to observe the attack effects from various scales, we set <span class="ltx_text ltx_font_italic" id="Sx5.SSx1.SSSx2.Px2.p1.2.4">K</span> = 5, 10, 20, 30 respectively.
For the defense strategy <span class="ltx_text ltx_font_italic" id="Sx5.SSx1.SSSx2.Px2.p1.2.5">mixed-RFA</span>, we set the hyperparameter <math alttext="\lambda" class="ltx_Math" display="inline" id="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1"><semantics id="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1a"><mi id="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1.1" xref="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1b"><ci id="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1.1.cmml" xref="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="Sx5.SSx1.SSSx2.Px2.p1.2.m2.1d">italic_λ</annotation></semantics></math> to 0.3.</p>
</div>
</section>
<section class="ltx_paragraph" id="Sx5.SSx1.SSSx2.Px3">
<h5 class="ltx_title ltx_title_paragraph">Baseline Attacks.</h5>
<div class="ltx_para" id="Sx5.SSx1.SSSx2.Px3.p1">
<p class="ltx_p" id="Sx5.SSx1.SSSx2.Px3.p1.1">Following the common setting for federated recommendation, we assume that attacker does not have any prior knowledge at all. Bandwagon attack <cite class="ltx_cite ltx_citemacro_citep">(Kapoor, Kapoor, and Kumar <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib12" title="">2017</a>)</cite>, Pipattack <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib36" title="">2022</a>)</cite> and FedRecAttack rely on side information of items’ popularity or public interactions, cluster attack <cite class="ltx_cite ltx_citemacro_citep">(Yu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib33" title="">2023</a>)</cite> and fedAttack <cite class="ltx_cite ltx_citemacro_citep">(Wu et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib31" title="">2022</a>)</cite> focus on untargeted items attack, hence they are not applicable under such circumstances. We choose the attacks which are still practical under such circumstances as our baseline attacks:</p>
<ul class="ltx_itemize" id="Sx5.I5">
<li class="ltx_item" id="Sx5.I5.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx5.I5.i1.p1">
<p class="ltx_p" id="Sx5.I5.i1.p1.1">Random Attack (RA) <cite class="ltx_cite ltx_citemacro_citep">(Kapoor, Kapoor, and Kumar <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib12" title="">2017</a>)</cite>. It injects fake users as malicious users, and manipulates them to interact with both target items and randomly selected items.</p>
</div>
</li>
<li class="ltx_item" id="Sx5.I5.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx5.I5.i2.p1">
<p class="ltx_p" id="Sx5.I5.i2.p1.1">Explicit Boosting (EB) <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib36" title="">2022</a>)</cite>. EB is one component of PipAttack which does not rely on attacker’s knowledge. It explicitly boosts the predicted scores of target items for malicious users.</p>
</div>
</li>
<li class="ltx_item" id="Sx5.I5.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx5.I5.i3.p1">
<p class="ltx_p" id="Sx5.I5.i3.p1.1">A-ra <cite class="ltx_cite ltx_citemacro_citep">(Rong, He, and Chen <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib25" title="">2022</a>)</cite>. A-ra a variant of the original A-ra which does not approximate user’s embedding vectors with normal distribution, because in sequential recommendation models, interaction sequences are used instead of user embedding.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="Sx5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Different Models under 0.1% Malicious Client</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="Sx5.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Sx5.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T3.1.1.1.1" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T3.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T3.1.1.1.2" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T3.1.1.1.2.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T3.1.1.1.3" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T3.1.1.1.3.1">ER@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T3.1.1.1.4" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T3.1.1.1.4.1">ER@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T3.1.1.1.5" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T3.1.1.1.5.1">ER@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T3.1.1.1.6" style="padding:1pt 4.3pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T3.1.1.1.6.1">ER@30</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx5.T3.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.2.1.1" rowspan="2" style="padding:1pt 4.3pt;"><span class="ltx_text" id="Sx5.T3.1.2.1.1.1">ML-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.2.1.2" style="padding:1pt 4.3pt;">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.2.1.3" style="padding:1pt 4.3pt;">0.9890</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.2.1.4" style="padding:1pt 4.3pt;">0.9981</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.2.1.5" style="padding:1pt 4.3pt;">1.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.2.1.6" style="padding:1pt 4.3pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T3.1.3.2">
<td class="ltx_td ltx_align_center" id="Sx5.T3.1.3.2.1" style="padding:1pt 4.3pt;">BERT4Rec</td>
<td class="ltx_td ltx_align_center" id="Sx5.T3.1.3.2.2" style="padding:1pt 4.3pt;">0.0007</td>
<td class="ltx_td ltx_align_center" id="Sx5.T3.1.3.2.3" style="padding:1pt 4.3pt;">0.0046</td>
<td class="ltx_td ltx_align_center" id="Sx5.T3.1.3.2.4" style="padding:1pt 4.3pt;">0.0396</td>
<td class="ltx_td ltx_align_center" id="Sx5.T3.1.3.2.5" style="padding:1pt 4.3pt;">0.1262</td>
</tr>
<tr class="ltx_tr" id="Sx5.T3.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="Sx5.T3.1.4.3.1" rowspan="2" style="padding:1pt 4.3pt;"><span class="ltx_text" id="Sx5.T3.1.4.3.1.1">Steam</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.4.3.2" style="padding:1pt 4.3pt;">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.4.3.3" style="padding:1pt 4.3pt;">0.9169</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.4.3.4" style="padding:1pt 4.3pt;">0.9997</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.4.3.5" style="padding:1pt 4.3pt;">1.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T3.1.4.3.6" style="padding:1pt 4.3pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T3.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T3.1.5.4.1" style="padding:1pt 4.3pt;">BERT4Rec</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T3.1.5.4.2" style="padding:1pt 4.3pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T3.1.5.4.3" style="padding:1pt 4.3pt;">0.0003</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T3.1.5.4.4" style="padding:1pt 4.3pt;">0.0059</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T3.1.5.4.5" style="padding:1pt 4.3pt;">0.2190</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_subsection" id="Sx5.SSx2">
<h3 class="ltx_title ltx_title_subsection">Attack Performance Evaluation (RQ1)</h3>
<div class="ltx_para" id="Sx5.SSx2.p1">
<p class="ltx_p" id="Sx5.SSx2.p1.1">We compare the effectiveness of baseline attacks and ours. The experimental results are presented in Table 1, from which we have several findings. First, due to the proportion of malicious users is too small for the
naive data poisoning attack RA, it has no effects. Second, the baseline model poisoning attacks (EB and A-ra) show only slight improvements in attack performance. This is likely because these methods, although designed for model poisoning, are less effective when the number of malicious users is minimal, thereby struggling to compromise sequential models. Third, our proposed dual-view DV-FSR method significantly outperforms the baseline approaches. By effectively narrowing the distance between the target item’s embedding and the embeddings of interacted items, while modifying only a minimal number of interactions (just one), our method demonstrates exceptional attack performance. Notably, even with a substantial reduction in available user information (as indicated in the last line of Table 1), DV-FSR remains highly effective, underscoring its robustness and efficiency in comparison to other methods.</p>
</div>
<figure class="ltx_table" id="Sx5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>The Effectiveness of Attacks Under Defenses</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="Sx5.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Sx5.T4.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T4.1.1.1.1" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T4.1.1.1.2" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.1.1.2.1">Mal. Client</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T4.1.1.1.3" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.1.1.3.1">Defense</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T4.1.1.1.4" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.1.1.4.1">ER@5</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T4.1.1.1.5" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.1.1.5.1">ER@10</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T4.1.1.1.6" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.1.1.6.1">ER@20</span></th>
<th class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T4.1.1.1.7" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.1.1.7.1">ER@30</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx5.T4.1.2.1">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.2.1.1" rowspan="9" style="padding:1.5pt 1.7pt;"><span class="ltx_text" id="Sx5.T4.1.2.1.1.1">ML-1M</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.2.1.2" rowspan="3" style="padding:1.5pt 1.7pt;"><span class="ltx_text" id="Sx5.T4.1.2.1.2.1">0.05%</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.2.1.3" style="padding:1.5pt 1.7pt;">none</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.2.1.4" style="padding:1.5pt 1.7pt;">0.9701</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.2.1.5" style="padding:1.5pt 1.7pt;">0.9851</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.2.1.6" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.2.1.7" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.3.2">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.3.2.1" style="padding:1.5pt 1.7pt;">adv_train</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.3.2.2" style="padding:1.5pt 1.7pt;">0.9698</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.3.2.3" style="padding:1.5pt 1.7pt;">0.9838</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.3.2.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.3.2.5" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.4.3">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.4.3.1" style="padding:1.5pt 1.7pt;">mixed-RFA</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.4.3.2" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.4.3.2.1">0.0000</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.4.3.3" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.4.3.3.1">0.0000</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.4.3.4" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.4.3.4.1">0.0000</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.4.3.5" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.4.3.5.1">0.0000</span></td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.5.4">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.5.4.1" rowspan="3" style="padding:1.5pt 1.7pt;"><span class="ltx_text" id="Sx5.T4.1.5.4.1.1">0.1%</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.5.4.2" style="padding:1.5pt 1.7pt;">none</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.5.4.3" style="padding:1.5pt 1.7pt;">0.9890</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.5.4.4" style="padding:1.5pt 1.7pt;">0.9981</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.5.4.5" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.5.4.6" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.6.5">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.6.5.1" style="padding:1.5pt 1.7pt;">adv_train</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.6.5.2" style="padding:1.5pt 1.7pt;">0.9834</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.6.5.3" style="padding:1.5pt 1.7pt;">0.9950</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.6.5.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.6.5.5" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.7.6">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.7.6.1" style="padding:1.5pt 1.7pt;">mixed-RFA</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.7.6.2" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.7.6.2.1">0.3935</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.7.6.3" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.7.6.3.1">0.8457</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.7.6.4" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.7.6.4.1">0.9997</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.7.6.5" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.8.7">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.8.7.1" rowspan="3" style="padding:1.5pt 1.7pt;"><span class="ltx_text" id="Sx5.T4.1.8.7.1.1">0.2%</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.8.7.2" style="padding:1.5pt 1.7pt;">none</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.8.7.3" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.8.7.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.8.7.5" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.8.7.6" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.9.8">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.9.8.1" style="padding:1.5pt 1.7pt;">adv_train</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.9.8.2" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.9.8.3" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.9.8.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.9.8.5" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.10.9">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.10.9.1" style="padding:1.5pt 1.7pt;">mixed-RFA</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.10.9.2" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.10.9.3" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.10.9.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.10.9.5" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.11.10">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" id="Sx5.T4.1.11.10.1" rowspan="9" style="padding:1.5pt 1.7pt;"><span class="ltx_text" id="Sx5.T4.1.11.10.1.1">Steam</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.11.10.2" rowspan="3" style="padding:1.5pt 1.7pt;"><span class="ltx_text" id="Sx5.T4.1.11.10.2.1">0.05%</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.11.10.3" style="padding:1.5pt 1.7pt;">none</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.11.10.4" style="padding:1.5pt 1.7pt;">0.0011</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.11.10.5" style="padding:1.5pt 1.7pt;">0.0117</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.11.10.6" style="padding:1.5pt 1.7pt;">0.2950</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.11.10.7" style="padding:1.5pt 1.7pt;">0.8311</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.12.11">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.12.11.1" style="padding:1.5pt 1.7pt;">adv_train</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.12.11.2" style="padding:1.5pt 1.7pt;">0.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.12.11.3" style="padding:1.5pt 1.7pt;">0.0080</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.12.11.4" style="padding:1.5pt 1.7pt;">0.2241</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.12.11.5" style="padding:1.5pt 1.7pt;">0.7445</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.13.12">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.13.12.1" style="padding:1.5pt 1.7pt;">mixed-RFA</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.13.12.2" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.13.12.2.1">0.0000</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.13.12.3" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.13.12.3.1">0.0000</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.13.12.4" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.13.12.4.1">0.0000</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.13.12.5" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.13.12.5.1">0.0005</span></td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.14.13">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.14.13.1" rowspan="3" style="padding:1.5pt 1.7pt;"><span class="ltx_text" id="Sx5.T4.1.14.13.1.1">0.1%</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.14.13.2" style="padding:1.5pt 1.7pt;">none</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.14.13.3" style="padding:1.5pt 1.7pt;">0.9169</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.14.13.4" style="padding:1.5pt 1.7pt;">0.9997</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.14.13.5" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.14.13.6" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.15.14">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.15.14.1" style="padding:1.5pt 1.7pt;">adv_train</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.15.14.2" style="padding:1.5pt 1.7pt;">0.9217</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.15.14.3" style="padding:1.5pt 1.7pt;">0.9992</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.15.14.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.15.14.5" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.16.15">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.16.15.1" style="padding:1.5pt 1.7pt;">mixed-RFA</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.16.15.2" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.16.15.2.1">0.0578</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.16.15.3" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.16.15.3.1">0.4391</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.16.15.4" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.16.15.4.1">0.9739</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.16.15.5" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.16.15.5.1">0.9995</span></td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.17.16">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b ltx_border_t" id="Sx5.T4.1.17.16.1" rowspan="3" style="padding:1.5pt 1.7pt;"><span class="ltx_text" id="Sx5.T4.1.17.16.1.1">0.2%</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.17.16.2" style="padding:1.5pt 1.7pt;">none</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.17.16.3" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.17.16.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.17.16.5" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" id="Sx5.T4.1.17.16.6" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.18.17">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.18.17.1" style="padding:1.5pt 1.7pt;">adv_train</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.18.17.2" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.18.17.3" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.18.17.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="Sx5.T4.1.18.17.5" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T4.1.19.18">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="Sx5.T4.1.19.18.1" style="padding:1.5pt 1.7pt;">mixed-RFA</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="Sx5.T4.1.19.18.2" style="padding:1.5pt 1.7pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T4.1.19.18.2.1">0.9526</span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="Sx5.T4.1.19.18.3" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="Sx5.T4.1.19.18.4" style="padding:1.5pt 1.7pt;">1.0000</td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" id="Sx5.T4.1.19.18.5" style="padding:1.5pt 1.7pt;">1.0000</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="Sx5.SSx3">
<h3 class="ltx_title ltx_title_subsection">Performance Under Attack (RQ2)</h3>
<div class="ltx_para" id="Sx5.SSx3.p1">
<p class="ltx_p" id="Sx5.SSx3.p1.1">Although both are sequential recommendation system models, BERT4Rec demonstrates remarkable robustness compared to SASRec. As shown in Table 3, in scenarios where the proportion of malicious users is 0.1%, even under our attack method DV-FSR, while the exposure rate (ER) of SASRec is significantly impacted, the ER of BERT4Rec remains almost unaffected. Under the same attack method, only 0.1% of malicious users are needed to significantly increase the ER of the target item in SASRec, whereas BERT4Rec requires 0.5% or even 1% of malicious users to impact the model. We attribute this difference to the bidirectional nature of the model, which enhances its ability to correct errors and supplement information by leveraging contextual data from both preceding and subsequent sequences when faced with missing or incorrect inputs.</p>
</div>
<figure class="ltx_figure" id="Sx5.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="394" id="Sx5.F2.g1" src="x2.png" width="789"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="394" id="Sx5.F2.g2" src="x3.png" width="789"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Changes in ER@5 Under DV-FSR</figcaption>
</figure>
<figure class="ltx_table" id="Sx5.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablation Study for Module in Attack</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="Sx5.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="Sx5.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T5.1.1.1.1" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T5.1.1.1.2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.1.1.2.1">Mal.client</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T5.1.1.1.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.1.1.3.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T5.1.1.1.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.1.1.4.1">Attack</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T5.1.1.1.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.1.1.5.1">ER@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T5.1.1.1.6" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.1.1.6.1">ER@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T5.1.1.1.7" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.1.1.7.1">ER@20</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="Sx5.T5.1.1.1.8" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.1.1.8.1">ER@30</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="Sx5.T5.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.2.1.1" rowspan="6" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx5.T5.1.2.1.1.1">SASRec</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.2.1.2" rowspan="6" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx5.T5.1.2.1.2.1">0.05%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.2.1.3" rowspan="3" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx5.T5.1.2.1.3.1">ML-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.2.1.4" style="padding:1.5pt 8.5pt;">C-FSR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.2.1.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.2.1.6" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.2.1.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.2.1.8" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.3.2">
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.3.2.1" style="padding:1.5pt 8.5pt;">S-FSR</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.3.2.2" style="padding:1.5pt 8.5pt;">0.7661</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.3.2.3" style="padding:1.5pt 8.5pt;">0.9396</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.3.2.4" style="padding:1.5pt 8.5pt;">1.0000</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.3.2.5" style="padding:1.5pt 8.5pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.4.3">
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.4.3.1" style="padding:1.5pt 8.5pt;">DV-FSR</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.4.3.2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.4.3.2.1">0.9701</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.4.3.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.4.3.3.1">0.9851</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.4.3.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.4.3.4.1">1.0000</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.4.3.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.4.3.5.1">1.0000</span></td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.5.4.1" rowspan="3" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx5.T5.1.5.4.1.1">Steam</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.5.4.2" style="padding:1.5pt 8.5pt;">C-FSR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.5.4.3" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.5.4.4" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.5.4.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.5.4.6" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.6.5">
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.6.5.1" style="padding:1.5pt 8.5pt;">S-FSR</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.6.5.2" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.6.5.3" style="padding:1.5pt 8.5pt;">0.0013</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.6.5.4" style="padding:1.5pt 8.5pt;">0.0184</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.6.5.5" style="padding:1.5pt 8.5pt;">0.1010</td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.7.6">
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.7.6.1" style="padding:1.5pt 8.5pt;">DV-FSR</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.7.6.2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.7.6.2.1">0.0011</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.7.6.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.7.6.3.1">0.0117</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.7.6.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.7.6.4.1">0.2950</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.7.6.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.7.6.5.1">0.8311</span></td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.8.7">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="Sx5.T5.1.8.7.1" rowspan="6" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx5.T5.1.8.7.1.1">BERT4Rec</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="Sx5.T5.1.8.7.2" rowspan="6" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx5.T5.1.8.7.2.1">0.2%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.8.7.3" rowspan="3" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx5.T5.1.8.7.3.1">ML-1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.8.7.4" style="padding:1.5pt 8.5pt;">C-FSR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.8.7.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.8.7.6" style="padding:1.5pt 8.5pt;">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.8.7.7" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.8.7.8" style="padding:1.5pt 8.5pt;">0.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.9.8">
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.9.8.1" style="padding:1.5pt 8.5pt;">S-FSR</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.9.8.2" style="padding:1.5pt 8.5pt;">0.0978</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.9.8.3" style="padding:1.5pt 8.5pt;">0.4081</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.9.8.4" style="padding:1.5pt 8.5pt;">0.9644</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.9.8.5" style="padding:1.5pt 8.5pt;">1.0000</td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.10.9">
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.10.9.1" style="padding:1.5pt 8.5pt;">DV-FSR</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.10.9.2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.10.9.2.1">0.1152</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.10.9.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.10.9.3.1">0.4518</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.10.9.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.10.9.4.1">0.9767</span></td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.10.9.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.10.9.5.1">1.0000</span></td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.11.10">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_t" id="Sx5.T5.1.11.10.1" rowspan="3" style="padding:1.5pt 8.5pt;"><span class="ltx_text" id="Sx5.T5.1.11.10.1.1">Steam</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.11.10.2" style="padding:1.5pt 8.5pt;">C-FSR</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.11.10.3" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.11.10.4" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.11.10.5" style="padding:1.5pt 8.5pt;">0.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="Sx5.T5.1.11.10.6" style="padding:1.5pt 8.5pt;">0.0003</td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.12.11">
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.12.11.1" style="padding:1.5pt 8.5pt;">S-FSR</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.12.11.2" style="padding:1.5pt 8.5pt;">0.0037</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.12.11.3" style="padding:1.5pt 8.5pt;">0.1276</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.12.11.4" style="padding:1.5pt 8.5pt;">0.9233</td>
<td class="ltx_td ltx_align_center" id="Sx5.T5.1.12.11.5" style="padding:1.5pt 8.5pt;">0.9997</td>
</tr>
<tr class="ltx_tr" id="Sx5.T5.1.13.12">
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T5.1.13.12.1" style="padding:1.5pt 8.5pt;">DV-FSR</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T5.1.13.12.2" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.13.12.2.1">0.0059</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T5.1.13.12.3" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.13.12.3.1">0.1492</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T5.1.13.12.4" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.13.12.4.1">0.9379</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="Sx5.T5.1.13.12.5" style="padding:1.5pt 8.5pt;"><span class="ltx_text ltx_font_bold" id="Sx5.T5.1.13.12.5.1">1.0000</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="Sx5.SSx4">
<h3 class="ltx_title ltx_title_subsection">More Malicious Users Increase Attack Effectiveness (RQ3)</h3>
<div class="ltx_para" id="Sx5.SSx4.p1">
<p class="ltx_p" id="Sx5.SSx4.p1.1">To rigorously evaluate the robustness of our targeted attack across various scenarios, we conducted a detailed assessment using different proportions of the DV-FSR attack, specifically at rates of 1%, 0.5%, 0.4%, 0.3%, 0.2%, and 0.1%. This evaluation was carried out on two datasets, ml-1m and steam. As depicted in Figure 2, a clear trend emerged: with an increasing percentage of malicious users within the system, the attack not only reach its peak effectiveness more rapidly but also sustain this level of impact over time, showing minimal signs of diminishing potency. Moreover, as highlighted in Table 1, our attack method achieves superior effectiveness while requiring significantly less user information—demonstrating its efficiency, as seen with a requirement of only 0.05% user data compared to 0.1% in other methods. This further underscores the distinct advantages of our approach.
</p>
</div>
</section>
<section class="ltx_subsection" id="Sx5.SSx5">
<h3 class="ltx_title ltx_title_subsection">Defense Performance Evaluation (RQ4)</h3>
<div class="ltx_para" id="Sx5.SSx5.p1">
<p class="ltx_p" id="Sx5.SSx5.p1.1">In this subsection, we evaluate the mitigation effectiveness of our mixed-RFA defense strategy on SASrec. We use a relatively general sequential recommendation adv_train defense <cite class="ltx_cite ltx_citemacro_citep">(Yue et al. <a class="ltx_ref" href="https://arxiv.org/html/2409.07500v1#bib.bib34" title="">2022</a>)</cite> method to counter gradient training as our defense baseline. Although adv_train has shown commendable defensive effects under sequential recommendation, its efficacy is significantly diminished in federated learning scenarios. In light of this, We have adopted a method of mixed robust gradient ensemble to mitigate target item attacks. As shown in Table 4, our defense strategy effectively mitigates target item attacks when the proportion of malicious users is low (e.g., 0.05%, 0.1%). However, as the proportion of malicious users increases (reaching 0.2%), our defense strategy gradually becomes ineffective. Therefore, protecting users’ personal information is crucial. If sufficient user information is leaked, defense strategies may also fail to effectively prevent the attacker’s marketing attacks.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx5.SSx6">
<h3 class="ltx_title ltx_title_subsection">Ablation Study (RQ5)</h3>
<div class="ltx_para" id="Sx5.SSx6.p1">
<p class="ltx_p" id="Sx5.SSx6.p1.1">We have developed variations of the original DV-FSR method by selectively omitting specific components to evaluate their individual contributions to the overall effectiveness of the attack strategy. The first variation, C-FSR, excludes the explicit strategy (step 3), while the second variation, S-FSR, omits the implicit strategy (step 2). These modifications allow us to isolate and understand the impact of each component within the DV-FSR framework. The results of our ablation study, detailed in Table 5, demonstrate that the original DV-FSR method consistently outperforms its derived variants, C-FSR and S-FSR, across various proportions of malicious users. This indicates that each component plays a crucial role in maximizing the precision and impact of the attack, offering valuable insights into how item ranking manipulation can be most effectively achieved.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx6">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>
<div class="ltx_para" id="Sx6.p1">
<p class="ltx_p" id="Sx6.p1.1">In this study, we investigated the problem of target attack on Federated Sequential Recommendation (FSR) with the main consideration that there exists great difference in terms of the robustness of recommendation models. To address this, we proposed a dual-view target attack framework, DV-FSR, which effectively orchestrates explicit and implicit strategies to achieve coordinated attacks. Our extensive experiments demonstrate that DV-FSR successfully compromises the system’s robustness under both standard settings and our newly developed defense mechanisms. We hope that our research will spark further interest in exploring recommendation model-aware attacks within federated recommendation frameworks, encouraging the development of more sophisticated approaches to enhance system security.</p>
</div>
<div class="ltx_para" id="Sx6.p2">
<br class="ltx_break"/>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aktukmak, Yilmaz, and Uysal (2019)</span>
<span class="ltx_bibblock">
Aktukmak, M.; Yilmaz, Y.; and Uysal, I. 2019.

</span>
<span class="ltx_bibblock">Quick and accurate attack detection in recommender systems through user attributes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the 13th ACM Conference on Recommender Systems</em>, 348–352.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ammad-Ud-Din et al. (2019)</span>
<span class="ltx_bibblock">
Ammad-Ud-Din, M.; Ivannikova, E.; Khan, S. A.; Oyomno, W.; Fu, Q.; Tan, K. E.; and Flanagan, A. 2019.

</span>
<span class="ltx_bibblock">Federated collaborative filtering for privacy-preserving personalized recommendation system.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:1901.09888</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bagdasaryan et al. (2020)</span>
<span class="ltx_bibblock">
Bagdasaryan, E.; Veit, A.; Hua, Y.; Estrin, D.; and Shmatikov, V. 2020.

</span>
<span class="ltx_bibblock">How to backdoor federated learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">International conference on artificial intelligence and statistics</em>, 2938–2948. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhagoji et al. (2019)</span>
<span class="ltx_bibblock">
Bhagoji, A. N.; Chakraborty, S.; Mittal, P.; and Calo, S. 2019.

</span>
<span class="ltx_bibblock">Analyzing federated learning through an adversarial lens.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">International conference on machine learning</em>, 634–643. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Burke et al. (2006)</span>
<span class="ltx_bibblock">
Burke, R.; Mobasher, B.; Williams, C.; and Bhaumik, R. 2006.

</span>
<span class="ltx_bibblock">Classification features for attack detection in collaborative recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 12th ACM SIGKDD international conference on Knowledge discovery and data mining</em>, 542–547.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2022)</span>
<span class="ltx_bibblock">
Cheng, M.; Liu, Z.; Liu, Q.; Ge, S.; and Chen, E. 2022.

</span>
<span class="ltx_bibblock">Towards automatic discovering of deep hybrid network architecture for sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the ACM Web Conference 2022</em>, 1923–1932.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al. (2021)</span>
<span class="ltx_bibblock">
Cheng, M.; Yuan, F.; Liu, Q.; Xin, X.; and Chen, E. 2021.

</span>
<span class="ltx_bibblock">Learning transferable user representations with sequential behaviors via contrastive pre-training.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">2021 IEEE International Conference on Data Mining (ICDM)</em>, 51–60. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheuque, Guzmán, and Parra (2019)</span>
<span class="ltx_bibblock">
Cheuque, G.; Guzmán, J.; and Parra, D. 2019.

</span>
<span class="ltx_bibblock">Recommender systems for online video game platforms: The case of steam.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Companion Proceedings of The 2019 World Wide Web Conference</em>, 763–771.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al. (2020)</span>
<span class="ltx_bibblock">
Fang, H.; Zhang, D.; Shu, Y.; and Guo, G. 2020.

</span>
<span class="ltx_bibblock">Deep learning for sequential recommendation: Algorithms, influential factors, and evaluations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">ACM Transactions on Information Systems (TOIS)</em>, 39(1): 1–42.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and Konstan (2015)</span>
<span class="ltx_bibblock">
Harper, F. M.; and Konstan, J. A. 2015.

</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Acm transactions on interactive intelligent systems (tiis)</em>, 5(4): 1–19.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2017)</span>
<span class="ltx_bibblock">
He, X.; Liao, L.; Zhang, H.; Nie, L.; Hu, X.; and Chua, T.-S. 2017.

</span>
<span class="ltx_bibblock">Neural collaborative filtering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 26th international conference on world wide web</em>, 173–182.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kapoor, Kapoor, and Kumar (2017)</span>
<span class="ltx_bibblock">
Kapoor, S.; Kapoor, V.; and Kumar, R. 2017.

</span>
<span class="ltx_bibblock">A REVIEW OF ATTACKS AND ITS DETECTION ATTRIBUTES ON COLLABORATIVE RECOMMENDER SYSTEMS.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">International Journal of Advanced Research in Computer Science</em>, 8(7).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lam and Riedl (2004)</span>
<span class="ltx_bibblock">
Lam, S. K.; and Riedl, J. 2004.

</span>
<span class="ltx_bibblock">Shilling recommender systems for fun and profit.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the 13th international conference on World Wide Web</em>, 393–402.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee and Zhu (2012)</span>
<span class="ltx_bibblock">
Lee, J.-S.; and Zhu, D. 2012.

</span>
<span class="ltx_bibblock">Shilling attack detection—a new approach for a trustworthy recommender system.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">INFORMS Journal on Computing</em>, 24(1): 117–131.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2016)</span>
<span class="ltx_bibblock">
Li, B.; Wang, Y.; Singh, A.; and Vorobeychik, Y. 2016.

</span>
<span class="ltx_bibblock">Data poisoning attacks on factorization-based collaborative filtering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in neural information processing systems</em>, 29.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2017)</span>
<span class="ltx_bibblock">
Li, J.; Ren, P.; Chen, Z.; Ren, Z.; Lian, T.; and Ma, J. 2017.

</span>
<span class="ltx_bibblock">Neural attentive session-based recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 2017 ACM on Conference on Information and Knowledge Management</em>, 1419–1428.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Li, L.; Lin, F.; Xiahou, J.; Lin, Y.; Wu, P.; and Liu, Y. 2022.

</span>
<span class="ltx_bibblock">Federated low-rank tensor projections for sequential recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Knowledge-Based Systems</em>, 255: 109483.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang, Pan, and Ming (2021)</span>
<span class="ltx_bibblock">
Liang, F.; Pan, W.; and Ming, Z. 2021.

</span>
<span class="ltx_bibblock">Fedrec++: Lossless federated recommendation with explicit feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, volume 35, 4224–4231.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2020)</span>
<span class="ltx_bibblock">
Lin, G.; Liang, F.; Pan, W.; and Ming, Z. 2020.

</span>
<span class="ltx_bibblock">Fedrec: Federated recommendation with explicit feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">IEEE Intelligent Systems</em>, 36(5): 21–30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2018)</span>
<span class="ltx_bibblock">
Liu, Q.; Zeng, Y.; Mokhosi, R.; and Zhang, H. 2018.

</span>
<span class="ltx_bibblock">STAMP: short-term attention/memory priority model for session-based recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>, 1831–1839.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022)</span>
<span class="ltx_bibblock">
Liu, Z.; Cheng, M.; Li, Z.; Liu, Q.; and Chen, E. 2022.

</span>
<span class="ltx_bibblock">One person, one model—learning compound router for sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">2022 IEEE International Conference on Data Mining (ICDM)</em>, 289–298. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B.; Moore, E.; Ramage, D.; Hampson, S.; and y Arcas, B. A. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Artificial intelligence and statistics</em>, 1273–1282. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Papernot et al. (2016)</span>
<span class="ltx_bibblock">
Papernot, N.; McDaniel, P.; Wu, X.; Jha, S.; and Swami, A. 2016.

</span>
<span class="ltx_bibblock">Distillation as a defense to adversarial perturbations against deep neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">2016 IEEE symposium on security and privacy (SP)</em>, 582–597. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quadrana, Cremonesi, and Jannach (2018)</span>
<span class="ltx_bibblock">
Quadrana, M.; Cremonesi, P.; and Jannach, D. 2018.

</span>
<span class="ltx_bibblock">Sequence-aware recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">ACM computing surveys (CSUR)</em>, 51(4): 1–36.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rong, He, and Chen (2022)</span>
<span class="ltx_bibblock">
Rong, D.; He, Q.; and Chen, J. 2022.

</span>
<span class="ltx_bibblock">Poisoning deep learning based recommender model in federated learning scenarios.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2204.13594</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rong et al. (2022)</span>
<span class="ltx_bibblock">
Rong, D.; Ye, S.; Zhao, R.; Yuen, H. N.; Chen, J.; and He, Q. 2022.

</span>
<span class="ltx_bibblock">Fedrecattack: Model poisoning attack to federated recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">2022 IEEE 38th International Conference on Data Engineering (ICDE)</em>, 2643–2655. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi and Wang (2024)</span>
<span class="ltx_bibblock">
Shi, Y.; and Wang, B. 2024.

</span>
<span class="ltx_bibblock">A Privacy-Preserving Method for Sequential Recommendation in Vertical Federated Learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">2024 27th International Conference on Computer Supported Cooperative Work in Design (CSCWD)</em>, 2221–2226. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al. (2019)</span>
<span class="ltx_bibblock">
Tang, J.; Du, X.; He, X.; Yuan, F.; Tian, Q.; and Chua, T.-S. 2019.

</span>
<span class="ltx_bibblock">Adversarial training towards robust multimedia recommender system.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 32(5): 855–867.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani (2017)</span>
<span class="ltx_bibblock">
Vaswani, A. 2017.

</span>
<span class="ltx_bibblock">Attention is All You Need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:1706.03762</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, S.; Cao, L.; Wang, Y.; Sheng, Q. Z.; Orgun, M. A.; and Lian, D. 2021.

</span>
<span class="ltx_bibblock">A survey on session-based recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">ACM Computing Surveys (CSUR)</em>, 54(7): 1–38.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2022)</span>
<span class="ltx_bibblock">
Wu, C.; Wu, F.; Qi, T.; Huang, Y.; and Xie, X. 2022.

</span>
<span class="ltx_bibblock">FedAttack: Effective and covert poisoning attack on federated recommendation via hard sampling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, 4164–4172.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yi et al. (2023)</span>
<span class="ltx_bibblock">
Yi, J.; Wu, F.; Zhu, B.; Yao, J.; Tao, Z.; Sun, G.; and Xie, X. 2023.

</span>
<span class="ltx_bibblock">UA-FedRec: untargeted attack on federated news recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, 5428–5438.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
<span class="ltx_bibblock">
Yu, Y.; Liu, Q.; Wu, L.; Yu, R.; Yu, S. L.; and Zhang, Z. 2023.

</span>
<span class="ltx_bibblock">Untargeted attack against federated recommendation systems via poisonous item embeddings and the defense.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, volume 37, 4854–4863.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. (2022)</span>
<span class="ltx_bibblock">
Yue, Z.; Zeng, H.; Kou, Z.; Shang, L.; and Wang, D. 2022.

</span>
<span class="ltx_bibblock">Defending substitution-based profile pollution attacks on sequential recommenders.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>, 59–70.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Zhang, H.; Zheng, D.; Yang, X.; Feng, J.; and Liao, Q. 2024.

</span>
<span class="ltx_bibblock">FedDCSR: Federated cross-domain sequential recommendation via disentangled representation learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the 2024 SIAM International Conference on Data Mining (SDM)</em>, 535–543. SIAM.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Zhang, S.; Yin, H.; Chen, T.; Huang, Z.; Nguyen, Q. V. H.; and Cui, L. 2022.

</span>
<span class="ltx_bibblock">Pipattack: Poisoning federated recommender systems for manipulating item promotion.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the Fifteenth ACM International Conference on Web Search and Data Mining</em>, 1415–1423.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep  9 15:15:11 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
