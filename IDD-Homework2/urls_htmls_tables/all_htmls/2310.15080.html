<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.15080] Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization</title><meta property="og:description" content="Federated learning (FL) is a promising paradigm to enable collaborative model training with decentralized data. However, the training process of Large Language Models (LLMs) generally incurs the update of significant p…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.15080">

<!--Generated on Tue Feb 27 22:21:42 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

Tianshi Che<sup id="id15.15.id1" class="ltx_sup">1</sup>,

Ji Liu<sup id="id16.16.id2" class="ltx_sup"><span id="id16.16.id2.1" class="ltx_text ltx_font_italic">2†</span></sup>,
Yang Zhou<sup id="id17.17.id3" class="ltx_sup"><span id="id17.17.id3.1" class="ltx_text ltx_font_italic">1∗</span></sup>,
Jiaxiang Ren<sup id="id18.18.id4" class="ltx_sup">1</sup>, 
<br class="ltx_break"><span id="id9.9.5" class="ltx_text ltx_font_bold">Jiwen Zhou<sup id="id9.9.5.1" class="ltx_sup"><span id="id9.9.5.1.1" class="ltx_text ltx_font_medium">3</span></sup>,
Victor S. Sheng<sup id="id9.9.5.2" class="ltx_sup"><span id="id9.9.5.2.1" class="ltx_text ltx_font_medium">4</span></sup>,
Huaiyu Dai<sup id="id9.9.5.3" class="ltx_sup"><span id="id9.9.5.3.1" class="ltx_text ltx_font_medium">5</span></sup>,
Dejing Dou<sup id="id9.9.5.4" class="ltx_sup"><span id="id9.9.5.4.1" class="ltx_text ltx_font_medium">6</span></sup>
<br class="ltx_break"><sup id="id9.9.5.5" class="ltx_sup"><span id="id9.9.5.5.1" class="ltx_text ltx_font_medium">1</span></sup></span>Auburn University, Auburn, United States,
<br class="ltx_break"><sup id="id19.19.id5" class="ltx_sup">2</sup>Hithink RoyalFlush Information Network Co., Ltd., Hangzhou, Zhejiang, China,
<br class="ltx_break"><sup id="id20.20.id6" class="ltx_sup">3</sup>Baidu Inc. Beijing, China,
<sup id="id21.21.id7" class="ltx_sup">4</sup>Texas Tech University, Lubbock, United States,
<br class="ltx_break"><sup id="id22.22.id8" class="ltx_sup">5</sup>North Carolina State University, United States,
<sup id="id23.23.id9" class="ltx_sup">6</sup>Boston Consulting Group, United States
</span><span class="ltx_author_notes">     Equal contribution. Corresponding author: jiliuwork@gmail.com, yangzhou@auburn.edu</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id24.id1" class="ltx_p">Federated learning (FL) is a promising paradigm to enable collaborative model training with decentralized data. However, the training process of Large Language Models (LLMs) generally incurs the update of significant parameters, which limits the applicability of FL techniques to tackle the LLMs in real scenarios. Prompt tuning can significantly reduce the number of parameters to update, but it either incurs performance degradation or low training efficiency. The straightforward utilization of prompt tuning in the FL often raises non-trivial communication costs and dramatically degrades performance. In addition, the decentralized data is generally non-Independent and Identically Distributed (non-IID), which brings client drift problems and thus poor performance. This paper proposes a Parameter-efficient prompt Tuning approach with Adaptive Optimization, i.e., FedPepTAO, to enable efficient and effective FL of LLMs. First, an efficient partial prompt tuning approach is proposed to improve performance and efficiency simultaneously. Second, a novel adaptive optimization method is developed to address the client drift problems on both the device and server sides to enhance performance further. Extensive experiments based on 10 datasets demonstrate the superb performance (up to 60.8% in terms of accuracy) and efficiency (up to 97.59% in terms of training time) of FedPepTAO compared with 9 baseline approaches. Our code is available at <a target="_blank" href="https://github.com/llm-eff/FedPepTAO" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/llm-eff/FedPepTAO</a>.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">As a promising paradigm to handle decentralized data, Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite">Kairouz et al. (<a href="#bib.bib31" title="" class="ltx_ref">2021</a>)</cite> enables collaborative model training without transferring the raw data across a massive number of devices. As a bunch of legal restrictions <cite class="ltx_cite ltx_citemacro_cite">Official Journal of the European Union (<a href="#bib.bib60" title="" class="ltx_ref">2016</a>); Californians for Consumer Privacy (<a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite> have been implemented, aggregating the decentralized data into a central server or data center becomes complicated or even impossible <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a href="#bib.bib87" title="" class="ltx_ref">2019</a>)</cite>. FL generally exploits a parameter server module <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib50" title="" class="ltx_ref">2023b</a>)</cite> to manage the distributed model updates in devices, which only exchanges the parameters of the updated models instead of the raw data, between the parameter server and devices.</p>
</div>
<div id="S1.p2" class="ltx_para">
<span id="S1.p2.1" class="ltx_ERROR undefined">{textblock*}</span>
<p id="S1.p2.2" class="ltx_p">8cm(-4cm,16cm) To appear in EMNLP 2023</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Large Language Models (LLMs) <cite class="ltx_cite ltx_citemacro_cite">Devlin et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018</a>); Liu et al. (<a href="#bib.bib56" title="" class="ltx_ref">2019b</a>); Brown et al. (<a href="#bib.bib3" title="" class="ltx_ref">2020</a>); Lewis et al. (<a href="#bib.bib41" title="" class="ltx_ref">2019</a>)</cite> have achieved major advances in Natural Language Processing (NLP) tasks. The scale of LLMs can range from 110 million parameters to 175 billion parameters, which correspond to huge communication and computation costs to update parameters during the pre-training process <cite class="ltx_cite ltx_citemacro_cite">Sanh et al. (<a href="#bib.bib68" title="" class="ltx_ref">2022</a>); Wang et al. (<a href="#bib.bib79" title="" class="ltx_ref">2022</a>)</cite> or fine-tuning process <cite class="ltx_cite ltx_citemacro_cite">Ding et al. (<a href="#bib.bib15" title="" class="ltx_ref">2023</a>)</cite>. Both pre-training and fine-tuning update the whole set of parameters of the language model. Thus, the application of FL in the pre-training or the fine-tuning process is almost impossible due to significant communication burden brought by large amount of parameters.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Prompt design <cite class="ltx_cite ltx_citemacro_cite">Brown et al. (<a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite> can lead to excellent performance while freezing the original LLMs. When the LLMs are frozen, only the prompts or prefix are updated during the tuning process, which can significantly reduce the number of parameters to update. For instance, for a sample from a sentiment analysis task (e.g., “beautiful place!”), a discrete prompt “It was [MASK].” for prompt tuning <cite class="ltx_cite ltx_citemacro_cite">Brown et al. (<a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite> and continuous task-specific vectors for prefix tuning <cite class="ltx_cite ltx_citemacro_cite">Li and Liang (<a href="#bib.bib43" title="" class="ltx_ref">2021</a>)</cite> can be concatenated to be sent to a LLM, which generates the label of the sample to be “terrible” or “great”.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Numerous parameter-efficient prompt or prefix tuning approaches have been proposed to tune the large language models through updating a few trainable parameters while achieving comparable performance compared with fine-tuning. In order to avoid human involvement in the prompt design, prompt tuning methods <cite class="ltx_cite ltx_citemacro_cite">Shin et al. (<a href="#bib.bib69" title="" class="ltx_ref">2020</a>)</cite> are proposed to search proper prompts within a discrete space of words, which corresponds to inferior performance compared with fine-tuning. Continuous prompts, i.e., prefix tuning, can be updated to achieve better performance <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib55" title="" class="ltx_ref">2021</a>); Lester et al. (<a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>. However, this approach leads to sub-optimal performance for the models with less than 10 billion parameters. Although P-tuning V2 <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib54" title="" class="ltx_ref">2022d</a>)</cite> achieves comparable performance compared with fine-tuning, it introduces more parameters, which may correspond to heavier communication costs in the setting of FL compared with other parameter-efficient tuning approaches. Some other parameter-efficient prompt tuning methods either suffer from low performance with the focus on low-rank hypercomplex adapter layers <cite class="ltx_cite ltx_citemacro_cite">Karimi Mahabadi et al. (<a href="#bib.bib32" title="" class="ltx_ref">2021a</a>)</cite> or prompt with a single layer <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib53" title="" class="ltx_ref">2022c</a>)</cite>, or introduce extra computation costs with attentions <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a href="#bib.bib1" title="" class="ltx_ref">2022</a>)</cite>. In addition, existing FL techniques for fine-tuning large language models typically incur performance degradation or low efficiency due to huge communication costs <cite class="ltx_cite ltx_citemacro_cite">Tian et al. (<a href="#bib.bib73" title="" class="ltx_ref">2022</a>); Sun et al. (<a href="#bib.bib71" title="" class="ltx_ref">2022</a>); Zhao et al. (<a href="#bib.bib94" title="" class="ltx_ref">2023</a>)</cite>.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Adaptive optimization methods, e.g., Adaptive Moment Estimation (Adam) and Stochastic Gradient Descent (SGD) with Momentum (SGDM) <cite class="ltx_cite ltx_citemacro_cite">Sutskever et al. (<a href="#bib.bib72" title="" class="ltx_ref">2013</a>)</cite>, have been utilized either on server side <cite class="ltx_cite ltx_citemacro_cite">Duchi et al. (<a href="#bib.bib17" title="" class="ltx_ref">2011</a>); Reddi et al. (<a href="#bib.bib66" title="" class="ltx_ref">2018a</a>)</cite> or on device side <cite class="ltx_cite ltx_citemacro_cite">Yuan et al. (<a href="#bib.bib89" title="" class="ltx_ref">2021</a>); Liu et al. (<a href="#bib.bib52" title="" class="ltx_ref">2020</a>); Gao et al. (<a href="#bib.bib19" title="" class="ltx_ref">2021a</a>); Wang et al. (<a href="#bib.bib77" title="" class="ltx_ref">2020</a>)</cite> to achieve superior performance in FL. However, the direct application of the adaptive optimization methods may incur problems of the convergence within the training process <cite class="ltx_cite ltx_citemacro_cite">Reddi et al. (<a href="#bib.bib67" title="" class="ltx_ref">2018b</a>)</cite>. Furthermore, the application of adaptive optimization on a single side, i.e., either device or server, may correspond to poor performance. However, when the adaptive optimization is exploited on both sides <cite class="ltx_cite ltx_citemacro_cite">Jin et al. (<a href="#bib.bib28" title="" class="ltx_ref">2022a</a>)</cite> may incur heavy communication costs. In addition, client drift <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib35" title="" class="ltx_ref">2020b</a>)</cite> may exist in terms of the adaptive optimization due to non-Independent and Identically Distributed (non-IID) data among devices.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In this paper, we propose a Parameter-efficient prompt Tuning approach with Adaptive Optimization, i.e., FedPepTAO, to tune large language models with FL. As transferring the whole set of parameters in all the prompt layers corresponds to heavy communication costs, we propose an efficient and effective method to choose proper layers of prompts based on the importance of each layer. We design a scoring method to identify the importance of each layer according to the tuning impact of the layer on the final convergence accuracy. In addition, we propose an adaptive optimization method on both server side and device side with control measures on each device to achieve superb accuracy. We summarize out major contributions as follows:</p>
</div>
<div id="S1.p8" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel parameter-efficient prompt tuning method with an efficient and effective method to choose proper layers of prompts for FL. The subset of layers of prompts can reduce both the communication and computation costs within FL.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We provide an original adaptive optimization method on both server side and device side with control measures on each device.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We carry out extensive experimentation based on 10 datasets, which demonstrates the advantages of FedPepTAO in terms of accuracy (up to 60.8% higher) and efficiency (up to 97.59% faster) compared with 9 baseline approaches.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">As updating all the parameters of a pre-trained LLM consumes a large amount of memory and computation resources, prompt tuning <cite class="ltx_cite ltx_citemacro_cite">Brown et al. (<a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite> or prefix tuning <cite class="ltx_cite ltx_citemacro_cite">Li and Liang (<a href="#bib.bib43" title="" class="ltx_ref">2021</a>)</cite> is proposed to update a few parameters with a frozen language model while achieving comparable performance compared with fine-tuning. While prompt tuning may correspond to inferior performance with discrete space of words <cite class="ltx_cite ltx_citemacro_cite">Shin et al. (<a href="#bib.bib69" title="" class="ltx_ref">2020</a>)</cite>, prefix tuning <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib55" title="" class="ltx_ref">2021</a>); Lester et al. (<a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite> can deal with continuous prompts to achieve better performance. Adapter modules <cite class="ltx_cite ltx_citemacro_cite">Houlsby et al. (<a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite> are exploited to tune large language models with prompts, which may incur heavy computation costs due to the calculation of feed-forward project and non-linearity or attention mechanism <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a href="#bib.bib1" title="" class="ltx_ref">2022</a>)</cite>. Although efficient low-rank hypercomplex mechanism <cite class="ltx_cite ltx_citemacro_cite">Karimi Mahabadi et al. (<a href="#bib.bib33" title="" class="ltx_ref">2021b</a>)</cite> can be utilized to reduce parameters to update, the performance may degrade. P-tuning V2 achieves comparable performance compared with fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib54" title="" class="ltx_ref">2022d</a>)</cite>, which the prompts added into each layer of the large language model. Prompts can be added at a single layer to further reduce the computation costs <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib53" title="" class="ltx_ref">2022c</a>)</cite>, which may incur performance degradation and depends on multiple trials with each layer. In addition, the selection of the layer may incur long execution time to verify the impact on the final accuracy. Although the NASWOT algorithm <cite class="ltx_cite ltx_citemacro_cite">Mellor et al. (<a href="#bib.bib58" title="" class="ltx_ref">2021</a>)</cite> can be exploited to analyze the performance of a neural network architecture, it is only compatible with the neural networks based on the ReLU activation function <cite class="ltx_cite ltx_citemacro_cite">Nair and Hinton (<a href="#bib.bib59" title="" class="ltx_ref">2010</a>); Glorot et al. (<a href="#bib.bib22" title="" class="ltx_ref">2011</a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Parallel, distributed, and federated learning have been extensively studied in recent years
 <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib46" title="" class="ltx_ref">2023a</a>); Chen et al. (<a href="#bib.bib10" title="" class="ltx_ref">2023b</a>, <a href="#bib.bib9" title="" class="ltx_ref">a</a>); Lee et al. (<a href="#bib.bib37" title="" class="ltx_ref">2019</a>); Wu et al. (<a href="#bib.bib82" title="" class="ltx_ref">2021</a>); Goswami et al. (<a href="#bib.bib23" title="" class="ltx_ref">2020</a>); Zhang et al. (<a href="#bib.bib93" title="" class="ltx_ref">2021</a>); Zhou et al. (<a href="#bib.bib96" title="" class="ltx_ref">2022</a>); Guo et al. (<a href="#bib.bib24" title="" class="ltx_ref">2022</a>); Jin et al. (<a href="#bib.bib28" title="" class="ltx_ref">2022a</a>); Che et al. (<a href="#bib.bib5" title="" class="ltx_ref">2022</a>); Yan et al. (<a href="#bib.bib84" title="" class="ltx_ref">2022a</a>); Liu et al. (<a href="#bib.bib45" title="" class="ltx_ref">2022b</a>); Yan et al. (<a href="#bib.bib85" title="" class="ltx_ref">2022b</a>, <a href="#bib.bib86" title="" class="ltx_ref">c</a>); Jin et al. (<a href="#bib.bib29" title="" class="ltx_ref">2022b</a>, <a href="#bib.bib30" title="" class="ltx_ref">2021</a>); Zhao et al. (<a href="#bib.bib95" title="" class="ltx_ref">2021</a>); Zhou and Liu (<a href="#bib.bib98" title="" class="ltx_ref">2013</a>); Lee et al. (<a href="#bib.bib39" title="" class="ltx_ref">2013</a>); Zhang et al. (<a href="#bib.bib92" title="" class="ltx_ref">2013</a>); Zhou et al. (<a href="#bib.bib101" title="" class="ltx_ref">2014</a>); Zhang et al. (<a href="#bib.bib91" title="" class="ltx_ref">2014</a>); Bao et al. (<a href="#bib.bib2" title="" class="ltx_ref">2015</a>); Zhou et al. (<a href="#bib.bib99" title="" class="ltx_ref">2015a</a>, <a href="#bib.bib100" title="" class="ltx_ref">b</a>); Lee et al. (<a href="#bib.bib38" title="" class="ltx_ref">2015</a>); Jiang et al. (<a href="#bib.bib27" title="" class="ltx_ref">2019</a>); Zhang et al. (<a href="#bib.bib90" title="" class="ltx_ref">2022</a>); Zhou (<a href="#bib.bib97" title="" class="ltx_ref">2017</a>); Hong et al. (<a href="#bib.bib25" title="" class="ltx_ref">2023</a>); Chen et al. (<a href="#bib.bib8" title="" class="ltx_ref">2018b</a>, <a href="#bib.bib7" title="" class="ltx_ref">a</a>); Gan et al. (<a href="#bib.bib18" title="" class="ltx_ref">2023</a>); Che et al. (<a href="#bib.bib6" title="" class="ltx_ref">2023</a>); Liu et al. (<a href="#bib.bib51" title="" class="ltx_ref">2023c</a>, <a href="#bib.bib44" title="" class="ltx_ref">2022a</a>); Li et al. (<a href="#bib.bib42" title="" class="ltx_ref">2023</a>); Oliveira et al. (<a href="#bib.bib61" title="" class="ltx_ref">2019</a>); Liu et al. (<a href="#bib.bib49" title="" class="ltx_ref">2019a</a>, <a href="#bib.bib47" title="" class="ltx_ref">2016</a>, <a href="#bib.bib48" title="" class="ltx_ref">2015</a>)</cite>.
Some existing FL techniques have been proposed to fine-tuning large language models, which may suffer from performance degradation or low efficiency due to huge communication costs <cite class="ltx_cite ltx_citemacro_cite">Tian et al. (<a href="#bib.bib73" title="" class="ltx_ref">2022</a>); Sun et al. (<a href="#bib.bib71" title="" class="ltx_ref">2022</a>); Zhao et al. (<a href="#bib.bib94" title="" class="ltx_ref">2023</a>)</cite>. FedBert <cite class="ltx_cite ltx_citemacro_cite">Tian et al. (<a href="#bib.bib73" title="" class="ltx_ref">2022</a>)</cite> exploits split learning to split a model into two parts, i.e., one with transformer and the other one with head and embedding. As the transformer is shared on the server, FedBert may correspond to inferior performance and huge communication costs compared with prompt-tuning or prefix-tuning. Some other FL methods only fine-tune a part of the model weights <cite class="ltx_cite ltx_citemacro_cite">Sun et al. (<a href="#bib.bib71" title="" class="ltx_ref">2022</a>)</cite>, which still suffer from heavy communication costs for big language models. FedPrompt <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib94" title="" class="ltx_ref">2023</a>)</cite> enable FL based on prompt tuning, which communicates the whole set of parameters in prompts corresponding to huge communication costs.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Adaptive Moment Estimation (Adam) and Stochastic Gradient Descent (SGD) with Momentum (SGDM) <cite class="ltx_cite ltx_citemacro_cite">Sutskever et al. (<a href="#bib.bib72" title="" class="ltx_ref">2013</a>)</cite> are exploited within FL on server side <cite class="ltx_cite ltx_citemacro_cite">Duchi et al. (<a href="#bib.bib17" title="" class="ltx_ref">2011</a>); Reddi et al. (<a href="#bib.bib66" title="" class="ltx_ref">2018a</a>)</cite> or on device side <cite class="ltx_cite ltx_citemacro_cite">Yuan et al. (<a href="#bib.bib89" title="" class="ltx_ref">2021</a>); Liu et al. (<a href="#bib.bib52" title="" class="ltx_ref">2020</a>); Gao et al. (<a href="#bib.bib19" title="" class="ltx_ref">2021a</a>); Wang et al. (<a href="#bib.bib77" title="" class="ltx_ref">2020</a>)</cite> to address the client drift problem brought by the non-IID data in FL <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib35" title="" class="ltx_ref">2020b</a>)</cite>. However, the direct application of adaptive optimization on devices may lead to convergence problem <cite class="ltx_cite ltx_citemacro_cite">Reddi et al. (<a href="#bib.bib67" title="" class="ltx_ref">2018b</a>)</cite>. In addition, the application of adaptive optimization on both server and device sides may incur heavy communication costs <cite class="ltx_cite ltx_citemacro_cite">Jin et al. (<a href="#bib.bib28" title="" class="ltx_ref">2022a</a>)</cite>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Different from the previous work, we propose a general scoring method to analyze the correlation of each layer and the output of the large language model, which can represent the importance of each layer. Then, we select the prompt parameters of proper layers to be updated with FL while leaving other prompt parameters of other layers to be adjusted locally with a lossless method so as to achieve superb performance with limited communication costs. In addition, we introduce control measures on each device to alleviate the client drift problem and propose a novel adaptive optimization method on both server and device sides to further improve the performance.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Formulation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.10" class="ltx_p">The problem to address in this paper is how to efficiently tune a large language model based on prompt tuning in FL. Given a large language model <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathcal{M}</annotation></semantics></math> with <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">L</annotation></semantics></math> layers, we add prompts for each layer in <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">\mathcal{M}</annotation></semantics></math> and denote the set of parameters to generate prompts by <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="P_{l}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">P</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝑃</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">P_{l}</annotation></semantics></math> with <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">l</annotation></semantics></math> representing the number of layer in <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\mathcal{M}</annotation></semantics></math>. The whole set of prompts is denoted by <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S3.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\mathcal{P}</annotation></semantics></math> During the tuning process, the parameters in <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><ci id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\mathcal{M}</annotation></semantics></math> are frozen and cannot be updated while the parameters in <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S3.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\mathcal{P}</annotation></semantics></math> are updated to improve the performance of <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">\mathcal{M}</annotation></semantics></math>.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2310.15080/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="183" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The system model of FedPepTAO.</figcaption>
</figure>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.21" class="ltx_p">We consider a FL setting with a parameter server and <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">M</annotation></semantics></math> devices. We assume that the data for the tuning process of <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\mathcal{M}</annotation></semantics></math> is distributed among multiple devices. On each Device <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">i</annotation></semantics></math>, a dataset <math id="S3.p2.4.m4.2" class="ltx_Math" alttext="D_{i}=\{s_{i},m_{i}\}^{n_{i}}" display="inline"><semantics id="S3.p2.4.m4.2a"><mrow id="S3.p2.4.m4.2.2" xref="S3.p2.4.m4.2.2.cmml"><msub id="S3.p2.4.m4.2.2.4" xref="S3.p2.4.m4.2.2.4.cmml"><mi id="S3.p2.4.m4.2.2.4.2" xref="S3.p2.4.m4.2.2.4.2.cmml">D</mi><mi id="S3.p2.4.m4.2.2.4.3" xref="S3.p2.4.m4.2.2.4.3.cmml">i</mi></msub><mo id="S3.p2.4.m4.2.2.3" xref="S3.p2.4.m4.2.2.3.cmml">=</mo><msup id="S3.p2.4.m4.2.2.2" xref="S3.p2.4.m4.2.2.2.cmml"><mrow id="S3.p2.4.m4.2.2.2.2.2" xref="S3.p2.4.m4.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p2.4.m4.2.2.2.2.2.3" xref="S3.p2.4.m4.2.2.2.2.3.cmml">{</mo><msub id="S3.p2.4.m4.1.1.1.1.1.1" xref="S3.p2.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.p2.4.m4.1.1.1.1.1.1.2" xref="S3.p2.4.m4.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.p2.4.m4.1.1.1.1.1.1.3" xref="S3.p2.4.m4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p2.4.m4.2.2.2.2.2.4" xref="S3.p2.4.m4.2.2.2.2.3.cmml">,</mo><msub id="S3.p2.4.m4.2.2.2.2.2.2" xref="S3.p2.4.m4.2.2.2.2.2.2.cmml"><mi id="S3.p2.4.m4.2.2.2.2.2.2.2" xref="S3.p2.4.m4.2.2.2.2.2.2.2.cmml">m</mi><mi id="S3.p2.4.m4.2.2.2.2.2.2.3" xref="S3.p2.4.m4.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.4.m4.2.2.2.2.2.5" xref="S3.p2.4.m4.2.2.2.2.3.cmml">}</mo></mrow><msub id="S3.p2.4.m4.2.2.2.4" xref="S3.p2.4.m4.2.2.2.4.cmml"><mi id="S3.p2.4.m4.2.2.2.4.2" xref="S3.p2.4.m4.2.2.2.4.2.cmml">n</mi><mi id="S3.p2.4.m4.2.2.2.4.3" xref="S3.p2.4.m4.2.2.2.4.3.cmml">i</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.2b"><apply id="S3.p2.4.m4.2.2.cmml" xref="S3.p2.4.m4.2.2"><eq id="S3.p2.4.m4.2.2.3.cmml" xref="S3.p2.4.m4.2.2.3"></eq><apply id="S3.p2.4.m4.2.2.4.cmml" xref="S3.p2.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.2.4.1.cmml" xref="S3.p2.4.m4.2.2.4">subscript</csymbol><ci id="S3.p2.4.m4.2.2.4.2.cmml" xref="S3.p2.4.m4.2.2.4.2">𝐷</ci><ci id="S3.p2.4.m4.2.2.4.3.cmml" xref="S3.p2.4.m4.2.2.4.3">𝑖</ci></apply><apply id="S3.p2.4.m4.2.2.2.cmml" xref="S3.p2.4.m4.2.2.2"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.2.2.3.cmml" xref="S3.p2.4.m4.2.2.2">superscript</csymbol><set id="S3.p2.4.m4.2.2.2.2.3.cmml" xref="S3.p2.4.m4.2.2.2.2.2"><apply id="S3.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.p2.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.p2.4.m4.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.p2.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.p2.4.m4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p2.4.m4.2.2.2.2.2.2.cmml" xref="S3.p2.4.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.2.2.2.2.2.1.cmml" xref="S3.p2.4.m4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.4.m4.2.2.2.2.2.2.2.cmml" xref="S3.p2.4.m4.2.2.2.2.2.2.2">𝑚</ci><ci id="S3.p2.4.m4.2.2.2.2.2.2.3.cmml" xref="S3.p2.4.m4.2.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="S3.p2.4.m4.2.2.2.4.cmml" xref="S3.p2.4.m4.2.2.2.4"><csymbol cd="ambiguous" id="S3.p2.4.m4.2.2.2.4.1.cmml" xref="S3.p2.4.m4.2.2.2.4">subscript</csymbol><ci id="S3.p2.4.m4.2.2.2.4.2.cmml" xref="S3.p2.4.m4.2.2.2.4.2">𝑛</ci><ci id="S3.p2.4.m4.2.2.2.4.3.cmml" xref="S3.p2.4.m4.2.2.2.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.2c">D_{i}=\{s_{i},m_{i}\}^{n_{i}}</annotation></semantics></math> is located with <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="S3.p2.5.m5.1a"><msub id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">s</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">𝑠</ci><ci id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">s_{i}</annotation></semantics></math>, <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="S3.p2.6.m6.1a"><msub id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">m</mi><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">𝑚</ci><ci id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">m_{i}</annotation></semantics></math>, and <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S3.p2.7.m7.1a"><msub id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">n</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝑛</ci><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">n_{i}</annotation></semantics></math> representing a sample, the corresponding label of <math id="S3.p2.8.m8.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="S3.p2.8.m8.1a"><msub id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml"><mi id="S3.p2.8.m8.1.1.2" xref="S3.p2.8.m8.1.1.2.cmml">s</mi><mi id="S3.p2.8.m8.1.1.3" xref="S3.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.1b"><apply id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m8.1.1.1.cmml" xref="S3.p2.8.m8.1.1">subscript</csymbol><ci id="S3.p2.8.m8.1.1.2.cmml" xref="S3.p2.8.m8.1.1.2">𝑠</ci><ci id="S3.p2.8.m8.1.1.3.cmml" xref="S3.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.1c">s_{i}</annotation></semantics></math>, and the number of samples in <math id="S3.p2.9.m9.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.p2.9.m9.1a"><msub id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml"><mi id="S3.p2.9.m9.1.1.2" xref="S3.p2.9.m9.1.1.2.cmml">D</mi><mi id="S3.p2.9.m9.1.1.3" xref="S3.p2.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><apply id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m9.1.1.1.cmml" xref="S3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.p2.9.m9.1.1.2.cmml" xref="S3.p2.9.m9.1.1.2">𝐷</ci><ci id="S3.p2.9.m9.1.1.3.cmml" xref="S3.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">D_{i}</annotation></semantics></math>. We denote the total number of the samples on all the devices by <math id="S3.p2.10.m10.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p2.10.m10.1a"><mi id="S3.p2.10.m10.1.1" xref="S3.p2.10.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p2.10.m10.1b"><ci id="S3.p2.10.m10.1.1.cmml" xref="S3.p2.10.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m10.1c">N</annotation></semantics></math>, the set of all the samples by <math id="S3.p2.11.m11.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.p2.11.m11.1a"><mi id="S3.p2.11.m11.1.1" xref="S3.p2.11.m11.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.p2.11.m11.1b"><ci id="S3.p2.11.m11.1.1.cmml" xref="S3.p2.11.m11.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m11.1c">S</annotation></semantics></math> and that of labels by <math id="S3.p2.12.m12.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.p2.12.m12.1a"><mi id="S3.p2.12.m12.1.1" xref="S3.p2.12.m12.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p2.12.m12.1b"><ci id="S3.p2.12.m12.1.1.cmml" xref="S3.p2.12.m12.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m12.1c">M</annotation></semantics></math>. Due to the limited computation capacity, each Device <math id="S3.p2.13.m13.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p2.13.m13.1a"><mi id="S3.p2.13.m13.1.1" xref="S3.p2.13.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.13.m13.1b"><ci id="S3.p2.13.m13.1.1.cmml" xref="S3.p2.13.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m13.1c">i</annotation></semantics></math> can only perform the inference of <math id="S3.p2.14.m14.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p2.14.m14.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.14.m14.1.1" xref="S3.p2.14.m14.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.14.m14.1b"><ci id="S3.p2.14.m14.1.1.cmml" xref="S3.p2.14.m14.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.14.m14.1c">\mathcal{M}</annotation></semantics></math> while updating <math id="S3.p2.15.m15.1" class="ltx_Math" alttext="\mathcal{P}_{i}" display="inline"><semantics id="S3.p2.15.m15.1a"><msub id="S3.p2.15.m15.1.1" xref="S3.p2.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.15.m15.1.1.2" xref="S3.p2.15.m15.1.1.2.cmml">𝒫</mi><mi id="S3.p2.15.m15.1.1.3" xref="S3.p2.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.15.m15.1b"><apply id="S3.p2.15.m15.1.1.cmml" xref="S3.p2.15.m15.1.1"><csymbol cd="ambiguous" id="S3.p2.15.m15.1.1.1.cmml" xref="S3.p2.15.m15.1.1">subscript</csymbol><ci id="S3.p2.15.m15.1.1.2.cmml" xref="S3.p2.15.m15.1.1.2">𝒫</ci><ci id="S3.p2.15.m15.1.1.3.cmml" xref="S3.p2.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.15.m15.1c">\mathcal{P}_{i}</annotation></semantics></math> with <math id="S3.p2.16.m16.1" class="ltx_Math" alttext="\mathcal{P}_{i}" display="inline"><semantics id="S3.p2.16.m16.1a"><msub id="S3.p2.16.m16.1.1" xref="S3.p2.16.m16.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m16.1.1.2" xref="S3.p2.16.m16.1.1.2.cmml">𝒫</mi><mi id="S3.p2.16.m16.1.1.3" xref="S3.p2.16.m16.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.16.m16.1b"><apply id="S3.p2.16.m16.1.1.cmml" xref="S3.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S3.p2.16.m16.1.1.1.cmml" xref="S3.p2.16.m16.1.1">subscript</csymbol><ci id="S3.p2.16.m16.1.1.2.cmml" xref="S3.p2.16.m16.1.1.2">𝒫</ci><ci id="S3.p2.16.m16.1.1.3.cmml" xref="S3.p2.16.m16.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.16.m16.1c">\mathcal{P}_{i}</annotation></semantics></math> representing the prompt parameters in Device <math id="S3.p2.17.m17.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p2.17.m17.1a"><mi id="S3.p2.17.m17.1.1" xref="S3.p2.17.m17.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.17.m17.1b"><ci id="S3.p2.17.m17.1.1.cmml" xref="S3.p2.17.m17.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.17.m17.1c">i</annotation></semantics></math>. In order to reduce communication costs, we enable the exchange the parameters of the prompts within a subset of selected layers <math id="S3.p2.18.m18.1" class="ltx_Math" alttext="SL_{i}" display="inline"><semantics id="S3.p2.18.m18.1a"><mrow id="S3.p2.18.m18.1.1" xref="S3.p2.18.m18.1.1.cmml"><mi id="S3.p2.18.m18.1.1.2" xref="S3.p2.18.m18.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.p2.18.m18.1.1.1" xref="S3.p2.18.m18.1.1.1.cmml">​</mo><msub id="S3.p2.18.m18.1.1.3" xref="S3.p2.18.m18.1.1.3.cmml"><mi id="S3.p2.18.m18.1.1.3.2" xref="S3.p2.18.m18.1.1.3.2.cmml">L</mi><mi id="S3.p2.18.m18.1.1.3.3" xref="S3.p2.18.m18.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.18.m18.1b"><apply id="S3.p2.18.m18.1.1.cmml" xref="S3.p2.18.m18.1.1"><times id="S3.p2.18.m18.1.1.1.cmml" xref="S3.p2.18.m18.1.1.1"></times><ci id="S3.p2.18.m18.1.1.2.cmml" xref="S3.p2.18.m18.1.1.2">𝑆</ci><apply id="S3.p2.18.m18.1.1.3.cmml" xref="S3.p2.18.m18.1.1.3"><csymbol cd="ambiguous" id="S3.p2.18.m18.1.1.3.1.cmml" xref="S3.p2.18.m18.1.1.3">subscript</csymbol><ci id="S3.p2.18.m18.1.1.3.2.cmml" xref="S3.p2.18.m18.1.1.3.2">𝐿</ci><ci id="S3.p2.18.m18.1.1.3.3.cmml" xref="S3.p2.18.m18.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.18.m18.1c">SL_{i}</annotation></semantics></math> between Device <math id="S3.p2.19.m19.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p2.19.m19.1a"><mi id="S3.p2.19.m19.1.1" xref="S3.p2.19.m19.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.19.m19.1b"><ci id="S3.p2.19.m19.1.1.cmml" xref="S3.p2.19.m19.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.19.m19.1c">i</annotation></semantics></math> and the parameter server while the other prompt parameters are only updated within each device. We denote the set of prompt parameters in all the devices by <math id="S3.p2.20.m20.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="S3.p2.20.m20.1a"><mi id="S3.p2.20.m20.1.1" xref="S3.p2.20.m20.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="S3.p2.20.m20.1b"><ci id="S3.p2.20.m20.1.1.cmml" xref="S3.p2.20.m20.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.20.m20.1c">\mathbf{P}</annotation></semantics></math>. The problem to address in this paper can be formulated as how to efficiently generate <math id="S3.p2.21.m21.1" class="ltx_Math" alttext="\mathbf{P}" display="inline"><semantics id="S3.p2.21.m21.1a"><mi id="S3.p2.21.m21.1.1" xref="S3.p2.21.m21.1.1.cmml">𝐏</mi><annotation-xml encoding="MathML-Content" id="S3.p2.21.m21.1b"><ci id="S3.p2.21.m21.1.1.cmml" xref="S3.p2.21.m21.1.1">𝐏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.21.m21.1c">\mathbf{P}</annotation></semantics></math> such that the global loss is minimized:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.6" class="ltx_Math" alttext="\min_{\mathbf{P}}\left[\mathcal{F}(\mathcal{M},\mathbf{P})\triangleq\frac{1}{N}\sum_{i=1,~{}p_{i}\in\mathbf{P}}^{M}n_{i}F_{i}(\mathcal{M},p_{i})\right]," display="block"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6.1"><mrow id="S3.E1.m1.6.6.1.1.2" xref="S3.E1.m1.6.6.1.1.3.cmml"><munder id="S3.E1.m1.6.6.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.1.2.cmml">min</mi><mi id="S3.E1.m1.6.6.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.3.cmml">𝐏</mi></munder><mo id="S3.E1.m1.6.6.1.1.2a" xref="S3.E1.m1.6.6.1.1.3.cmml">⁡</mo><mrow id="S3.E1.m1.6.6.1.1.2.2" xref="S3.E1.m1.6.6.1.1.3.cmml"><mo id="S3.E1.m1.6.6.1.1.2.2.2" xref="S3.E1.m1.6.6.1.1.3.cmml">[</mo><mrow id="S3.E1.m1.6.6.1.1.2.2.1" xref="S3.E1.m1.6.6.1.1.2.2.1.cmml"><mrow id="S3.E1.m1.6.6.1.1.2.2.1.3" xref="S3.E1.m1.6.6.1.1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.6.6.1.1.2.2.1.3.2" xref="S3.E1.m1.6.6.1.1.2.2.1.3.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.1.1.2.2.1.3.1" xref="S3.E1.m1.6.6.1.1.2.2.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.6.6.1.1.2.2.1.3.3.2" xref="S3.E1.m1.6.6.1.1.2.2.1.3.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.1.1.2.2.1.3.3.2.1" xref="S3.E1.m1.6.6.1.1.2.2.1.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">ℳ</mi><mo id="S3.E1.m1.6.6.1.1.2.2.1.3.3.2.2" xref="S3.E1.m1.6.6.1.1.2.2.1.3.3.1.cmml">,</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">𝐏</mi><mo stretchy="false" id="S3.E1.m1.6.6.1.1.2.2.1.3.3.2.3" xref="S3.E1.m1.6.6.1.1.2.2.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.1.1.2.2.1.2" xref="S3.E1.m1.6.6.1.1.2.2.1.2.cmml">≜</mo><mrow id="S3.E1.m1.6.6.1.1.2.2.1.1" xref="S3.E1.m1.6.6.1.1.2.2.1.1.cmml"><mfrac id="S3.E1.m1.6.6.1.1.2.2.1.1.3" xref="S3.E1.m1.6.6.1.1.2.2.1.1.3.cmml"><mn id="S3.E1.m1.6.6.1.1.2.2.1.1.3.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.3.2.cmml">1</mn><mi id="S3.E1.m1.6.6.1.1.2.2.1.1.3.3" xref="S3.E1.m1.6.6.1.1.2.2.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.1.1.2.2.1.1.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.6.6.1.1.2.2.1.1.1" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.cmml"><munderover id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.2.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml"><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.397em" id="S3.E1.m1.2.2.2.2.3" xref="S3.E1.m1.2.2.2.3a.cmml">,</mo><mrow id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.cmml"><msub id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml">p</mi><mi id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.1.cmml">∈</mo><mi id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml">𝐏</mi></mrow></mrow><mi id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.3" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.3.cmml">M</mi></munderover><mrow id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.cmml"><msub id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.2.cmml">n</mi><mi id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.3" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.2.cmml">​</mo><msub id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.cmml"><mi id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.2.cmml">F</mi><mi id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.3" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.2a" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">ℳ</mi><mo id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.4" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.6.6.1.1.2.2.3" xref="S3.E1.m1.6.6.1.1.3.cmml">]</mo></mrow></mrow><mo id="S3.E1.m1.6.6.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.2"><apply id="S3.E1.m1.6.6.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1">subscript</csymbol><min id="S3.E1.m1.6.6.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.2"></min><ci id="S3.E1.m1.6.6.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.3">𝐏</ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1"><ci id="S3.E1.m1.6.6.1.1.2.2.1.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.2">≜</ci><apply id="S3.E1.m1.6.6.1.1.2.2.1.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.3"><times id="S3.E1.m1.6.6.1.1.2.2.1.3.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.3.1"></times><ci id="S3.E1.m1.6.6.1.1.2.2.1.3.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.3.2">ℱ</ci><interval closure="open" id="S3.E1.m1.6.6.1.1.2.2.1.3.3.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.3.3.2"><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">ℳ</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝐏</ci></interval></apply><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1"><times id="S3.E1.m1.6.6.1.1.2.2.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.2"></times><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.3"><divide id="S3.E1.m1.6.6.1.1.2.2.1.1.3.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.3"></divide><cn type="integer" id="S3.E1.m1.6.6.1.1.2.2.1.1.3.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.3.2">1</cn><ci id="S3.E1.m1.6.6.1.1.2.2.1.1.3.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.3.3">𝑁</ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1"><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.2.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.3a.cmml" xref="S3.E1.m1.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2"><in id="S3.E1.m1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.1"></in><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">𝑝</ci><ci id="S3.E1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.3">𝐏</ci></apply></apply></apply><ci id="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.2.3">𝑀</ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1"><times id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.2"></times><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.2">𝑛</ci><ci id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.2">𝐹</ci><ci id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.4.3">𝑖</ci></apply><interval closure="open" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1"><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">ℳ</ci><apply id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\min_{\mathbf{P}}\left[\mathcal{F}(\mathcal{M},\mathbf{P})\triangleq\frac{1}{N}\sum_{i=1,~{}p_{i}\in\mathbf{P}}^{M}n_{i}F_{i}(\mathcal{M},p_{i})\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.28" class="ltx_p">where <math id="S3.p2.22.m1.2" class="ltx_Math" alttext="\mathcal{F}(\mathcal{M},\mathbf{P})" display="inline"><semantics id="S3.p2.22.m1.2a"><mrow id="S3.p2.22.m1.2.3" xref="S3.p2.22.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.22.m1.2.3.2" xref="S3.p2.22.m1.2.3.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S3.p2.22.m1.2.3.1" xref="S3.p2.22.m1.2.3.1.cmml">​</mo><mrow id="S3.p2.22.m1.2.3.3.2" xref="S3.p2.22.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.p2.22.m1.2.3.3.2.1" xref="S3.p2.22.m1.2.3.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.22.m1.1.1" xref="S3.p2.22.m1.1.1.cmml">ℳ</mi><mo id="S3.p2.22.m1.2.3.3.2.2" xref="S3.p2.22.m1.2.3.3.1.cmml">,</mo><mi id="S3.p2.22.m1.2.2" xref="S3.p2.22.m1.2.2.cmml">𝐏</mi><mo stretchy="false" id="S3.p2.22.m1.2.3.3.2.3" xref="S3.p2.22.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.22.m1.2b"><apply id="S3.p2.22.m1.2.3.cmml" xref="S3.p2.22.m1.2.3"><times id="S3.p2.22.m1.2.3.1.cmml" xref="S3.p2.22.m1.2.3.1"></times><ci id="S3.p2.22.m1.2.3.2.cmml" xref="S3.p2.22.m1.2.3.2">ℱ</ci><interval closure="open" id="S3.p2.22.m1.2.3.3.1.cmml" xref="S3.p2.22.m1.2.3.3.2"><ci id="S3.p2.22.m1.1.1.cmml" xref="S3.p2.22.m1.1.1">ℳ</ci><ci id="S3.p2.22.m1.2.2.cmml" xref="S3.p2.22.m1.2.2">𝐏</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.22.m1.2c">\mathcal{F}(\mathcal{M},\mathbf{P})</annotation></semantics></math> represents the global loss, <math id="S3.p2.23.m2.8" class="ltx_Math" alttext="F_{i}(\mathcal{M},p_{i})\triangleq\frac{1}{n_{i}}\sum_{\{s_{i},m_{i}\}\in\mathcal{D}_{i}}f(\mathcal{M},p_{i},s_{i},m_{i})" display="inline"><semantics id="S3.p2.23.m2.8a"><mrow id="S3.p2.23.m2.8.8" xref="S3.p2.23.m2.8.8.cmml"><mrow id="S3.p2.23.m2.5.5.1" xref="S3.p2.23.m2.5.5.1.cmml"><msub id="S3.p2.23.m2.5.5.1.3" xref="S3.p2.23.m2.5.5.1.3.cmml"><mi id="S3.p2.23.m2.5.5.1.3.2" xref="S3.p2.23.m2.5.5.1.3.2.cmml">F</mi><mi id="S3.p2.23.m2.5.5.1.3.3" xref="S3.p2.23.m2.5.5.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p2.23.m2.5.5.1.2" xref="S3.p2.23.m2.5.5.1.2.cmml">​</mo><mrow id="S3.p2.23.m2.5.5.1.1.1" xref="S3.p2.23.m2.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.p2.23.m2.5.5.1.1.1.2" xref="S3.p2.23.m2.5.5.1.1.2.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.23.m2.3.3" xref="S3.p2.23.m2.3.3.cmml">ℳ</mi><mo id="S3.p2.23.m2.5.5.1.1.1.3" xref="S3.p2.23.m2.5.5.1.1.2.cmml">,</mo><msub id="S3.p2.23.m2.5.5.1.1.1.1" xref="S3.p2.23.m2.5.5.1.1.1.1.cmml"><mi id="S3.p2.23.m2.5.5.1.1.1.1.2" xref="S3.p2.23.m2.5.5.1.1.1.1.2.cmml">p</mi><mi id="S3.p2.23.m2.5.5.1.1.1.1.3" xref="S3.p2.23.m2.5.5.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.23.m2.5.5.1.1.1.4" xref="S3.p2.23.m2.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.p2.23.m2.8.8.5" xref="S3.p2.23.m2.8.8.5.cmml">≜</mo><mrow id="S3.p2.23.m2.8.8.4" xref="S3.p2.23.m2.8.8.4.cmml"><mfrac id="S3.p2.23.m2.8.8.4.5" xref="S3.p2.23.m2.8.8.4.5.cmml"><mn id="S3.p2.23.m2.8.8.4.5.2" xref="S3.p2.23.m2.8.8.4.5.2.cmml">1</mn><msub id="S3.p2.23.m2.8.8.4.5.3" xref="S3.p2.23.m2.8.8.4.5.3.cmml"><mi id="S3.p2.23.m2.8.8.4.5.3.2" xref="S3.p2.23.m2.8.8.4.5.3.2.cmml">n</mi><mi id="S3.p2.23.m2.8.8.4.5.3.3" xref="S3.p2.23.m2.8.8.4.5.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.p2.23.m2.8.8.4.4" xref="S3.p2.23.m2.8.8.4.4.cmml">​</mo><mrow id="S3.p2.23.m2.8.8.4.3" xref="S3.p2.23.m2.8.8.4.3.cmml"><msub id="S3.p2.23.m2.8.8.4.3.4" xref="S3.p2.23.m2.8.8.4.3.4.cmml"><mo id="S3.p2.23.m2.8.8.4.3.4.2" xref="S3.p2.23.m2.8.8.4.3.4.2.cmml">∑</mo><mrow id="S3.p2.23.m2.2.2.2" xref="S3.p2.23.m2.2.2.2.cmml"><mrow id="S3.p2.23.m2.2.2.2.2.2" xref="S3.p2.23.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.p2.23.m2.2.2.2.2.2.3" xref="S3.p2.23.m2.2.2.2.2.3.cmml">{</mo><msub id="S3.p2.23.m2.1.1.1.1.1.1" xref="S3.p2.23.m2.1.1.1.1.1.1.cmml"><mi id="S3.p2.23.m2.1.1.1.1.1.1.2" xref="S3.p2.23.m2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.p2.23.m2.1.1.1.1.1.1.3" xref="S3.p2.23.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p2.23.m2.2.2.2.2.2.4" xref="S3.p2.23.m2.2.2.2.2.3.cmml">,</mo><msub id="S3.p2.23.m2.2.2.2.2.2.2" xref="S3.p2.23.m2.2.2.2.2.2.2.cmml"><mi id="S3.p2.23.m2.2.2.2.2.2.2.2" xref="S3.p2.23.m2.2.2.2.2.2.2.2.cmml">m</mi><mi id="S3.p2.23.m2.2.2.2.2.2.2.3" xref="S3.p2.23.m2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.23.m2.2.2.2.2.2.5" xref="S3.p2.23.m2.2.2.2.2.3.cmml">}</mo></mrow><mo id="S3.p2.23.m2.2.2.2.3" xref="S3.p2.23.m2.2.2.2.3.cmml">∈</mo><msub id="S3.p2.23.m2.2.2.2.4" xref="S3.p2.23.m2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.23.m2.2.2.2.4.2" xref="S3.p2.23.m2.2.2.2.4.2.cmml">𝒟</mi><mi id="S3.p2.23.m2.2.2.2.4.3" xref="S3.p2.23.m2.2.2.2.4.3.cmml">i</mi></msub></mrow></msub><mrow id="S3.p2.23.m2.8.8.4.3.3" xref="S3.p2.23.m2.8.8.4.3.3.cmml"><mi id="S3.p2.23.m2.8.8.4.3.3.5" xref="S3.p2.23.m2.8.8.4.3.3.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p2.23.m2.8.8.4.3.3.4" xref="S3.p2.23.m2.8.8.4.3.3.4.cmml">​</mo><mrow id="S3.p2.23.m2.8.8.4.3.3.3.3" xref="S3.p2.23.m2.8.8.4.3.3.3.4.cmml"><mo stretchy="false" id="S3.p2.23.m2.8.8.4.3.3.3.3.4" xref="S3.p2.23.m2.8.8.4.3.3.3.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.23.m2.4.4" xref="S3.p2.23.m2.4.4.cmml">ℳ</mi><mo id="S3.p2.23.m2.8.8.4.3.3.3.3.5" xref="S3.p2.23.m2.8.8.4.3.3.3.4.cmml">,</mo><msub id="S3.p2.23.m2.6.6.2.1.1.1.1.1" xref="S3.p2.23.m2.6.6.2.1.1.1.1.1.cmml"><mi id="S3.p2.23.m2.6.6.2.1.1.1.1.1.2" xref="S3.p2.23.m2.6.6.2.1.1.1.1.1.2.cmml">p</mi><mi id="S3.p2.23.m2.6.6.2.1.1.1.1.1.3" xref="S3.p2.23.m2.6.6.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.p2.23.m2.8.8.4.3.3.3.3.6" xref="S3.p2.23.m2.8.8.4.3.3.3.4.cmml">,</mo><msub id="S3.p2.23.m2.7.7.3.2.2.2.2.2" xref="S3.p2.23.m2.7.7.3.2.2.2.2.2.cmml"><mi id="S3.p2.23.m2.7.7.3.2.2.2.2.2.2" xref="S3.p2.23.m2.7.7.3.2.2.2.2.2.2.cmml">s</mi><mi id="S3.p2.23.m2.7.7.3.2.2.2.2.2.3" xref="S3.p2.23.m2.7.7.3.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.p2.23.m2.8.8.4.3.3.3.3.7" xref="S3.p2.23.m2.8.8.4.3.3.3.4.cmml">,</mo><msub id="S3.p2.23.m2.8.8.4.3.3.3.3.3" xref="S3.p2.23.m2.8.8.4.3.3.3.3.3.cmml"><mi id="S3.p2.23.m2.8.8.4.3.3.3.3.3.2" xref="S3.p2.23.m2.8.8.4.3.3.3.3.3.2.cmml">m</mi><mi id="S3.p2.23.m2.8.8.4.3.3.3.3.3.3" xref="S3.p2.23.m2.8.8.4.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.23.m2.8.8.4.3.3.3.3.8" xref="S3.p2.23.m2.8.8.4.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.23.m2.8b"><apply id="S3.p2.23.m2.8.8.cmml" xref="S3.p2.23.m2.8.8"><ci id="S3.p2.23.m2.8.8.5.cmml" xref="S3.p2.23.m2.8.8.5">≜</ci><apply id="S3.p2.23.m2.5.5.1.cmml" xref="S3.p2.23.m2.5.5.1"><times id="S3.p2.23.m2.5.5.1.2.cmml" xref="S3.p2.23.m2.5.5.1.2"></times><apply id="S3.p2.23.m2.5.5.1.3.cmml" xref="S3.p2.23.m2.5.5.1.3"><csymbol cd="ambiguous" id="S3.p2.23.m2.5.5.1.3.1.cmml" xref="S3.p2.23.m2.5.5.1.3">subscript</csymbol><ci id="S3.p2.23.m2.5.5.1.3.2.cmml" xref="S3.p2.23.m2.5.5.1.3.2">𝐹</ci><ci id="S3.p2.23.m2.5.5.1.3.3.cmml" xref="S3.p2.23.m2.5.5.1.3.3">𝑖</ci></apply><interval closure="open" id="S3.p2.23.m2.5.5.1.1.2.cmml" xref="S3.p2.23.m2.5.5.1.1.1"><ci id="S3.p2.23.m2.3.3.cmml" xref="S3.p2.23.m2.3.3">ℳ</ci><apply id="S3.p2.23.m2.5.5.1.1.1.1.cmml" xref="S3.p2.23.m2.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.23.m2.5.5.1.1.1.1.1.cmml" xref="S3.p2.23.m2.5.5.1.1.1.1">subscript</csymbol><ci id="S3.p2.23.m2.5.5.1.1.1.1.2.cmml" xref="S3.p2.23.m2.5.5.1.1.1.1.2">𝑝</ci><ci id="S3.p2.23.m2.5.5.1.1.1.1.3.cmml" xref="S3.p2.23.m2.5.5.1.1.1.1.3">𝑖</ci></apply></interval></apply><apply id="S3.p2.23.m2.8.8.4.cmml" xref="S3.p2.23.m2.8.8.4"><times id="S3.p2.23.m2.8.8.4.4.cmml" xref="S3.p2.23.m2.8.8.4.4"></times><apply id="S3.p2.23.m2.8.8.4.5.cmml" xref="S3.p2.23.m2.8.8.4.5"><divide id="S3.p2.23.m2.8.8.4.5.1.cmml" xref="S3.p2.23.m2.8.8.4.5"></divide><cn type="integer" id="S3.p2.23.m2.8.8.4.5.2.cmml" xref="S3.p2.23.m2.8.8.4.5.2">1</cn><apply id="S3.p2.23.m2.8.8.4.5.3.cmml" xref="S3.p2.23.m2.8.8.4.5.3"><csymbol cd="ambiguous" id="S3.p2.23.m2.8.8.4.5.3.1.cmml" xref="S3.p2.23.m2.8.8.4.5.3">subscript</csymbol><ci id="S3.p2.23.m2.8.8.4.5.3.2.cmml" xref="S3.p2.23.m2.8.8.4.5.3.2">𝑛</ci><ci id="S3.p2.23.m2.8.8.4.5.3.3.cmml" xref="S3.p2.23.m2.8.8.4.5.3.3">𝑖</ci></apply></apply><apply id="S3.p2.23.m2.8.8.4.3.cmml" xref="S3.p2.23.m2.8.8.4.3"><apply id="S3.p2.23.m2.8.8.4.3.4.cmml" xref="S3.p2.23.m2.8.8.4.3.4"><csymbol cd="ambiguous" id="S3.p2.23.m2.8.8.4.3.4.1.cmml" xref="S3.p2.23.m2.8.8.4.3.4">subscript</csymbol><sum id="S3.p2.23.m2.8.8.4.3.4.2.cmml" xref="S3.p2.23.m2.8.8.4.3.4.2"></sum><apply id="S3.p2.23.m2.2.2.2.cmml" xref="S3.p2.23.m2.2.2.2"><in id="S3.p2.23.m2.2.2.2.3.cmml" xref="S3.p2.23.m2.2.2.2.3"></in><set id="S3.p2.23.m2.2.2.2.2.3.cmml" xref="S3.p2.23.m2.2.2.2.2.2"><apply id="S3.p2.23.m2.1.1.1.1.1.1.cmml" xref="S3.p2.23.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.23.m2.1.1.1.1.1.1.1.cmml" xref="S3.p2.23.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.23.m2.1.1.1.1.1.1.2.cmml" xref="S3.p2.23.m2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.p2.23.m2.1.1.1.1.1.1.3.cmml" xref="S3.p2.23.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p2.23.m2.2.2.2.2.2.2.cmml" xref="S3.p2.23.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.23.m2.2.2.2.2.2.2.1.cmml" xref="S3.p2.23.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.23.m2.2.2.2.2.2.2.2.cmml" xref="S3.p2.23.m2.2.2.2.2.2.2.2">𝑚</ci><ci id="S3.p2.23.m2.2.2.2.2.2.2.3.cmml" xref="S3.p2.23.m2.2.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="S3.p2.23.m2.2.2.2.4.cmml" xref="S3.p2.23.m2.2.2.2.4"><csymbol cd="ambiguous" id="S3.p2.23.m2.2.2.2.4.1.cmml" xref="S3.p2.23.m2.2.2.2.4">subscript</csymbol><ci id="S3.p2.23.m2.2.2.2.4.2.cmml" xref="S3.p2.23.m2.2.2.2.4.2">𝒟</ci><ci id="S3.p2.23.m2.2.2.2.4.3.cmml" xref="S3.p2.23.m2.2.2.2.4.3">𝑖</ci></apply></apply></apply><apply id="S3.p2.23.m2.8.8.4.3.3.cmml" xref="S3.p2.23.m2.8.8.4.3.3"><times id="S3.p2.23.m2.8.8.4.3.3.4.cmml" xref="S3.p2.23.m2.8.8.4.3.3.4"></times><ci id="S3.p2.23.m2.8.8.4.3.3.5.cmml" xref="S3.p2.23.m2.8.8.4.3.3.5">𝑓</ci><vector id="S3.p2.23.m2.8.8.4.3.3.3.4.cmml" xref="S3.p2.23.m2.8.8.4.3.3.3.3"><ci id="S3.p2.23.m2.4.4.cmml" xref="S3.p2.23.m2.4.4">ℳ</ci><apply id="S3.p2.23.m2.6.6.2.1.1.1.1.1.cmml" xref="S3.p2.23.m2.6.6.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.23.m2.6.6.2.1.1.1.1.1.1.cmml" xref="S3.p2.23.m2.6.6.2.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.23.m2.6.6.2.1.1.1.1.1.2.cmml" xref="S3.p2.23.m2.6.6.2.1.1.1.1.1.2">𝑝</ci><ci id="S3.p2.23.m2.6.6.2.1.1.1.1.1.3.cmml" xref="S3.p2.23.m2.6.6.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.p2.23.m2.7.7.3.2.2.2.2.2.cmml" xref="S3.p2.23.m2.7.7.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.23.m2.7.7.3.2.2.2.2.2.1.cmml" xref="S3.p2.23.m2.7.7.3.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.23.m2.7.7.3.2.2.2.2.2.2.cmml" xref="S3.p2.23.m2.7.7.3.2.2.2.2.2.2">𝑠</ci><ci id="S3.p2.23.m2.7.7.3.2.2.2.2.2.3.cmml" xref="S3.p2.23.m2.7.7.3.2.2.2.2.2.3">𝑖</ci></apply><apply id="S3.p2.23.m2.8.8.4.3.3.3.3.3.cmml" xref="S3.p2.23.m2.8.8.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.p2.23.m2.8.8.4.3.3.3.3.3.1.cmml" xref="S3.p2.23.m2.8.8.4.3.3.3.3.3">subscript</csymbol><ci id="S3.p2.23.m2.8.8.4.3.3.3.3.3.2.cmml" xref="S3.p2.23.m2.8.8.4.3.3.3.3.3.2">𝑚</ci><ci id="S3.p2.23.m2.8.8.4.3.3.3.3.3.3.cmml" xref="S3.p2.23.m2.8.8.4.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.23.m2.8c">F_{i}(\mathcal{M},p_{i})\triangleq\frac{1}{n_{i}}\sum_{\{s_{i},m_{i}\}\in\mathcal{D}_{i}}f(\mathcal{M},p_{i},s_{i},m_{i})</annotation></semantics></math> refers to the loss function on Device <math id="S3.p2.24.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.p2.24.m3.1a"><mi id="S3.p2.24.m3.1.1" xref="S3.p2.24.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p2.24.m3.1b"><ci id="S3.p2.24.m3.1.1.cmml" xref="S3.p2.24.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.24.m3.1c">k</annotation></semantics></math> with <math id="S3.p2.25.m4.4" class="ltx_Math" alttext="f(\mathcal{M},p_{i},s_{i},m_{i})" display="inline"><semantics id="S3.p2.25.m4.4a"><mrow id="S3.p2.25.m4.4.4" xref="S3.p2.25.m4.4.4.cmml"><mi id="S3.p2.25.m4.4.4.5" xref="S3.p2.25.m4.4.4.5.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.p2.25.m4.4.4.4" xref="S3.p2.25.m4.4.4.4.cmml">​</mo><mrow id="S3.p2.25.m4.4.4.3.3" xref="S3.p2.25.m4.4.4.3.4.cmml"><mo stretchy="false" id="S3.p2.25.m4.4.4.3.3.4" xref="S3.p2.25.m4.4.4.3.4.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.25.m4.1.1" xref="S3.p2.25.m4.1.1.cmml">ℳ</mi><mo id="S3.p2.25.m4.4.4.3.3.5" xref="S3.p2.25.m4.4.4.3.4.cmml">,</mo><msub id="S3.p2.25.m4.2.2.1.1.1" xref="S3.p2.25.m4.2.2.1.1.1.cmml"><mi id="S3.p2.25.m4.2.2.1.1.1.2" xref="S3.p2.25.m4.2.2.1.1.1.2.cmml">p</mi><mi id="S3.p2.25.m4.2.2.1.1.1.3" xref="S3.p2.25.m4.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.p2.25.m4.4.4.3.3.6" xref="S3.p2.25.m4.4.4.3.4.cmml">,</mo><msub id="S3.p2.25.m4.3.3.2.2.2" xref="S3.p2.25.m4.3.3.2.2.2.cmml"><mi id="S3.p2.25.m4.3.3.2.2.2.2" xref="S3.p2.25.m4.3.3.2.2.2.2.cmml">s</mi><mi id="S3.p2.25.m4.3.3.2.2.2.3" xref="S3.p2.25.m4.3.3.2.2.2.3.cmml">i</mi></msub><mo id="S3.p2.25.m4.4.4.3.3.7" xref="S3.p2.25.m4.4.4.3.4.cmml">,</mo><msub id="S3.p2.25.m4.4.4.3.3.3" xref="S3.p2.25.m4.4.4.3.3.3.cmml"><mi id="S3.p2.25.m4.4.4.3.3.3.2" xref="S3.p2.25.m4.4.4.3.3.3.2.cmml">m</mi><mi id="S3.p2.25.m4.4.4.3.3.3.3" xref="S3.p2.25.m4.4.4.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.p2.25.m4.4.4.3.3.8" xref="S3.p2.25.m4.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.25.m4.4b"><apply id="S3.p2.25.m4.4.4.cmml" xref="S3.p2.25.m4.4.4"><times id="S3.p2.25.m4.4.4.4.cmml" xref="S3.p2.25.m4.4.4.4"></times><ci id="S3.p2.25.m4.4.4.5.cmml" xref="S3.p2.25.m4.4.4.5">𝑓</ci><vector id="S3.p2.25.m4.4.4.3.4.cmml" xref="S3.p2.25.m4.4.4.3.3"><ci id="S3.p2.25.m4.1.1.cmml" xref="S3.p2.25.m4.1.1">ℳ</ci><apply id="S3.p2.25.m4.2.2.1.1.1.cmml" xref="S3.p2.25.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.25.m4.2.2.1.1.1.1.cmml" xref="S3.p2.25.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.p2.25.m4.2.2.1.1.1.2.cmml" xref="S3.p2.25.m4.2.2.1.1.1.2">𝑝</ci><ci id="S3.p2.25.m4.2.2.1.1.1.3.cmml" xref="S3.p2.25.m4.2.2.1.1.1.3">𝑖</ci></apply><apply id="S3.p2.25.m4.3.3.2.2.2.cmml" xref="S3.p2.25.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.25.m4.3.3.2.2.2.1.cmml" xref="S3.p2.25.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.p2.25.m4.3.3.2.2.2.2.cmml" xref="S3.p2.25.m4.3.3.2.2.2.2">𝑠</ci><ci id="S3.p2.25.m4.3.3.2.2.2.3.cmml" xref="S3.p2.25.m4.3.3.2.2.2.3">𝑖</ci></apply><apply id="S3.p2.25.m4.4.4.3.3.3.cmml" xref="S3.p2.25.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p2.25.m4.4.4.3.3.3.1.cmml" xref="S3.p2.25.m4.4.4.3.3.3">subscript</csymbol><ci id="S3.p2.25.m4.4.4.3.3.3.2.cmml" xref="S3.p2.25.m4.4.4.3.3.3.2">𝑚</ci><ci id="S3.p2.25.m4.4.4.3.3.3.3.cmml" xref="S3.p2.25.m4.4.4.3.3.3.3">𝑖</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.25.m4.4c">f(\mathcal{M},p_{i},s_{i},m_{i})</annotation></semantics></math> calculating the local loss of the combination of the large language model <math id="S3.p2.26.m5.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.p2.26.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.26.m5.1.1" xref="S3.p2.26.m5.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.26.m5.1b"><ci id="S3.p2.26.m5.1.1.cmml" xref="S3.p2.26.m5.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.26.m5.1c">\mathcal{M}</annotation></semantics></math> and prompt parameters <math id="S3.p2.27.m6.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S3.p2.27.m6.1a"><msub id="S3.p2.27.m6.1.1" xref="S3.p2.27.m6.1.1.cmml"><mi id="S3.p2.27.m6.1.1.2" xref="S3.p2.27.m6.1.1.2.cmml">p</mi><mi id="S3.p2.27.m6.1.1.3" xref="S3.p2.27.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.27.m6.1b"><apply id="S3.p2.27.m6.1.1.cmml" xref="S3.p2.27.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.27.m6.1.1.1.cmml" xref="S3.p2.27.m6.1.1">subscript</csymbol><ci id="S3.p2.27.m6.1.1.2.cmml" xref="S3.p2.27.m6.1.1.2">𝑝</ci><ci id="S3.p2.27.m6.1.1.3.cmml" xref="S3.p2.27.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.27.m6.1c">p_{i}</annotation></semantics></math> on <math id="S3.p2.28.m7.2" class="ltx_Math" alttext="\{s_{k},m_{k}\}" display="inline"><semantics id="S3.p2.28.m7.2a"><mrow id="S3.p2.28.m7.2.2.2" xref="S3.p2.28.m7.2.2.3.cmml"><mo stretchy="false" id="S3.p2.28.m7.2.2.2.3" xref="S3.p2.28.m7.2.2.3.cmml">{</mo><msub id="S3.p2.28.m7.1.1.1.1" xref="S3.p2.28.m7.1.1.1.1.cmml"><mi id="S3.p2.28.m7.1.1.1.1.2" xref="S3.p2.28.m7.1.1.1.1.2.cmml">s</mi><mi id="S3.p2.28.m7.1.1.1.1.3" xref="S3.p2.28.m7.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.p2.28.m7.2.2.2.4" xref="S3.p2.28.m7.2.2.3.cmml">,</mo><msub id="S3.p2.28.m7.2.2.2.2" xref="S3.p2.28.m7.2.2.2.2.cmml"><mi id="S3.p2.28.m7.2.2.2.2.2" xref="S3.p2.28.m7.2.2.2.2.2.cmml">m</mi><mi id="S3.p2.28.m7.2.2.2.2.3" xref="S3.p2.28.m7.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S3.p2.28.m7.2.2.2.5" xref="S3.p2.28.m7.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.28.m7.2b"><set id="S3.p2.28.m7.2.2.3.cmml" xref="S3.p2.28.m7.2.2.2"><apply id="S3.p2.28.m7.1.1.1.1.cmml" xref="S3.p2.28.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.28.m7.1.1.1.1.1.cmml" xref="S3.p2.28.m7.1.1.1.1">subscript</csymbol><ci id="S3.p2.28.m7.1.1.1.1.2.cmml" xref="S3.p2.28.m7.1.1.1.1.2">𝑠</ci><ci id="S3.p2.28.m7.1.1.1.1.3.cmml" xref="S3.p2.28.m7.1.1.1.1.3">𝑘</ci></apply><apply id="S3.p2.28.m7.2.2.2.2.cmml" xref="S3.p2.28.m7.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.28.m7.2.2.2.2.1.cmml" xref="S3.p2.28.m7.2.2.2.2">subscript</csymbol><ci id="S3.p2.28.m7.2.2.2.2.2.cmml" xref="S3.p2.28.m7.2.2.2.2.2">𝑚</ci><ci id="S3.p2.28.m7.2.2.2.2.3.cmml" xref="S3.p2.28.m7.2.2.2.2.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.28.m7.2c">\{s_{k},m_{k}\}</annotation></semantics></math>.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.14" class="ltx_p">For NLP tasks, each sample <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="s_{k}\in S" display="inline"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><msub id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml"><mi id="S3.p3.1.m1.1.1.2.2" xref="S3.p3.1.m1.1.1.2.2.cmml">s</mi><mi id="S3.p3.1.m1.1.1.2.3" xref="S3.p3.1.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.p3.1.m1.1.1.1" xref="S3.p3.1.m1.1.1.1.cmml">∈</mo><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><in id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1"></in><apply id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.2.1.cmml" xref="S3.p3.1.m1.1.1.2">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.2.cmml" xref="S3.p3.1.m1.1.1.2.2">𝑠</ci><ci id="S3.p3.1.m1.1.1.2.3.cmml" xref="S3.p3.1.m1.1.1.2.3">𝑘</ci></apply><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">s_{k}\in S</annotation></semantics></math> is the input of the large language model and <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="m_{k}\in M" display="inline"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><msub id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml"><mi id="S3.p3.2.m2.1.1.2.2" xref="S3.p3.2.m2.1.1.2.2.cmml">m</mi><mi id="S3.p3.2.m2.1.1.2.3" xref="S3.p3.2.m2.1.1.2.3.cmml">k</mi></msub><mo id="S3.p3.2.m2.1.1.1" xref="S3.p3.2.m2.1.1.1.cmml">∈</mo><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><in id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1"></in><apply id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.2.1.cmml" xref="S3.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.2.cmml" xref="S3.p3.2.m2.1.1.2.2">𝑚</ci><ci id="S3.p3.2.m2.1.1.2.3.cmml" xref="S3.p3.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">m_{k}\in M</annotation></semantics></math> is the corresponding label. Each sample <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="s_{k}" display="inline"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">s</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝑠</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">s_{k}</annotation></semantics></math> is composed of multiple tokens, i.e., <math id="S3.p3.4.m4.4" class="ltx_Math" alttext="s_{k}=\{s_{k}^{1},s_{k}^{2},...,s_{k}^{t}\}" display="inline"><semantics id="S3.p3.4.m4.4a"><mrow id="S3.p3.4.m4.4.4" xref="S3.p3.4.m4.4.4.cmml"><msub id="S3.p3.4.m4.4.4.5" xref="S3.p3.4.m4.4.4.5.cmml"><mi id="S3.p3.4.m4.4.4.5.2" xref="S3.p3.4.m4.4.4.5.2.cmml">s</mi><mi id="S3.p3.4.m4.4.4.5.3" xref="S3.p3.4.m4.4.4.5.3.cmml">k</mi></msub><mo id="S3.p3.4.m4.4.4.4" xref="S3.p3.4.m4.4.4.4.cmml">=</mo><mrow id="S3.p3.4.m4.4.4.3.3" xref="S3.p3.4.m4.4.4.3.4.cmml"><mo stretchy="false" id="S3.p3.4.m4.4.4.3.3.4" xref="S3.p3.4.m4.4.4.3.4.cmml">{</mo><msubsup id="S3.p3.4.m4.2.2.1.1.1" xref="S3.p3.4.m4.2.2.1.1.1.cmml"><mi id="S3.p3.4.m4.2.2.1.1.1.2.2" xref="S3.p3.4.m4.2.2.1.1.1.2.2.cmml">s</mi><mi id="S3.p3.4.m4.2.2.1.1.1.2.3" xref="S3.p3.4.m4.2.2.1.1.1.2.3.cmml">k</mi><mn id="S3.p3.4.m4.2.2.1.1.1.3" xref="S3.p3.4.m4.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.p3.4.m4.4.4.3.3.5" xref="S3.p3.4.m4.4.4.3.4.cmml">,</mo><msubsup id="S3.p3.4.m4.3.3.2.2.2" xref="S3.p3.4.m4.3.3.2.2.2.cmml"><mi id="S3.p3.4.m4.3.3.2.2.2.2.2" xref="S3.p3.4.m4.3.3.2.2.2.2.2.cmml">s</mi><mi id="S3.p3.4.m4.3.3.2.2.2.2.3" xref="S3.p3.4.m4.3.3.2.2.2.2.3.cmml">k</mi><mn id="S3.p3.4.m4.3.3.2.2.2.3" xref="S3.p3.4.m4.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.p3.4.m4.4.4.3.3.6" xref="S3.p3.4.m4.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">…</mi><mo id="S3.p3.4.m4.4.4.3.3.7" xref="S3.p3.4.m4.4.4.3.4.cmml">,</mo><msubsup id="S3.p3.4.m4.4.4.3.3.3" xref="S3.p3.4.m4.4.4.3.3.3.cmml"><mi id="S3.p3.4.m4.4.4.3.3.3.2.2" xref="S3.p3.4.m4.4.4.3.3.3.2.2.cmml">s</mi><mi id="S3.p3.4.m4.4.4.3.3.3.2.3" xref="S3.p3.4.m4.4.4.3.3.3.2.3.cmml">k</mi><mi id="S3.p3.4.m4.4.4.3.3.3.3" xref="S3.p3.4.m4.4.4.3.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.p3.4.m4.4.4.3.3.8" xref="S3.p3.4.m4.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.4b"><apply id="S3.p3.4.m4.4.4.cmml" xref="S3.p3.4.m4.4.4"><eq id="S3.p3.4.m4.4.4.4.cmml" xref="S3.p3.4.m4.4.4.4"></eq><apply id="S3.p3.4.m4.4.4.5.cmml" xref="S3.p3.4.m4.4.4.5"><csymbol cd="ambiguous" id="S3.p3.4.m4.4.4.5.1.cmml" xref="S3.p3.4.m4.4.4.5">subscript</csymbol><ci id="S3.p3.4.m4.4.4.5.2.cmml" xref="S3.p3.4.m4.4.4.5.2">𝑠</ci><ci id="S3.p3.4.m4.4.4.5.3.cmml" xref="S3.p3.4.m4.4.4.5.3">𝑘</ci></apply><set id="S3.p3.4.m4.4.4.3.4.cmml" xref="S3.p3.4.m4.4.4.3.3"><apply id="S3.p3.4.m4.2.2.1.1.1.cmml" xref="S3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.2.2.1.1.1.1.cmml" xref="S3.p3.4.m4.2.2.1.1.1">superscript</csymbol><apply id="S3.p3.4.m4.2.2.1.1.1.2.cmml" xref="S3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.2.2.1.1.1.2.1.cmml" xref="S3.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.p3.4.m4.2.2.1.1.1.2.2.cmml" xref="S3.p3.4.m4.2.2.1.1.1.2.2">𝑠</ci><ci id="S3.p3.4.m4.2.2.1.1.1.2.3.cmml" xref="S3.p3.4.m4.2.2.1.1.1.2.3">𝑘</ci></apply><cn type="integer" id="S3.p3.4.m4.2.2.1.1.1.3.cmml" xref="S3.p3.4.m4.2.2.1.1.1.3">1</cn></apply><apply id="S3.p3.4.m4.3.3.2.2.2.cmml" xref="S3.p3.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p3.4.m4.3.3.2.2.2.1.cmml" xref="S3.p3.4.m4.3.3.2.2.2">superscript</csymbol><apply id="S3.p3.4.m4.3.3.2.2.2.2.cmml" xref="S3.p3.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p3.4.m4.3.3.2.2.2.2.1.cmml" xref="S3.p3.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.p3.4.m4.3.3.2.2.2.2.2.cmml" xref="S3.p3.4.m4.3.3.2.2.2.2.2">𝑠</ci><ci id="S3.p3.4.m4.3.3.2.2.2.2.3.cmml" xref="S3.p3.4.m4.3.3.2.2.2.2.3">𝑘</ci></apply><cn type="integer" id="S3.p3.4.m4.3.3.2.2.2.3.cmml" xref="S3.p3.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">…</ci><apply id="S3.p3.4.m4.4.4.3.3.3.cmml" xref="S3.p3.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p3.4.m4.4.4.3.3.3.1.cmml" xref="S3.p3.4.m4.4.4.3.3.3">superscript</csymbol><apply id="S3.p3.4.m4.4.4.3.3.3.2.cmml" xref="S3.p3.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p3.4.m4.4.4.3.3.3.2.1.cmml" xref="S3.p3.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S3.p3.4.m4.4.4.3.3.3.2.2.cmml" xref="S3.p3.4.m4.4.4.3.3.3.2.2">𝑠</ci><ci id="S3.p3.4.m4.4.4.3.3.3.2.3.cmml" xref="S3.p3.4.m4.4.4.3.3.3.2.3">𝑘</ci></apply><ci id="S3.p3.4.m4.4.4.3.3.3.3.cmml" xref="S3.p3.4.m4.4.4.3.3.3.3">𝑡</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.4c">s_{k}=\{s_{k}^{1},s_{k}^{2},...,s_{k}^{t}\}</annotation></semantics></math>, where <math id="S3.p3.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p3.5.m5.1a"><mi id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><ci id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">t</annotation></semantics></math> represents the length of the input. The prompt <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.p3.6.m6.1a"><mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">p</annotation></semantics></math> consists of multiple tokens <math id="S3.p3.7.m7.4" class="ltx_Math" alttext="p=\{p_{1},p_{2},...,p_{h}\}" display="inline"><semantics id="S3.p3.7.m7.4a"><mrow id="S3.p3.7.m7.4.4" xref="S3.p3.7.m7.4.4.cmml"><mi id="S3.p3.7.m7.4.4.5" xref="S3.p3.7.m7.4.4.5.cmml">p</mi><mo id="S3.p3.7.m7.4.4.4" xref="S3.p3.7.m7.4.4.4.cmml">=</mo><mrow id="S3.p3.7.m7.4.4.3.3" xref="S3.p3.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S3.p3.7.m7.4.4.3.3.4" xref="S3.p3.7.m7.4.4.3.4.cmml">{</mo><msub id="S3.p3.7.m7.2.2.1.1.1" xref="S3.p3.7.m7.2.2.1.1.1.cmml"><mi id="S3.p3.7.m7.2.2.1.1.1.2" xref="S3.p3.7.m7.2.2.1.1.1.2.cmml">p</mi><mn id="S3.p3.7.m7.2.2.1.1.1.3" xref="S3.p3.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p3.7.m7.4.4.3.3.5" xref="S3.p3.7.m7.4.4.3.4.cmml">,</mo><msub id="S3.p3.7.m7.3.3.2.2.2" xref="S3.p3.7.m7.3.3.2.2.2.cmml"><mi id="S3.p3.7.m7.3.3.2.2.2.2" xref="S3.p3.7.m7.3.3.2.2.2.2.cmml">p</mi><mn id="S3.p3.7.m7.3.3.2.2.2.3" xref="S3.p3.7.m7.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.p3.7.m7.4.4.3.3.6" xref="S3.p3.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">…</mi><mo id="S3.p3.7.m7.4.4.3.3.7" xref="S3.p3.7.m7.4.4.3.4.cmml">,</mo><msub id="S3.p3.7.m7.4.4.3.3.3" xref="S3.p3.7.m7.4.4.3.3.3.cmml"><mi id="S3.p3.7.m7.4.4.3.3.3.2" xref="S3.p3.7.m7.4.4.3.3.3.2.cmml">p</mi><mi id="S3.p3.7.m7.4.4.3.3.3.3" xref="S3.p3.7.m7.4.4.3.3.3.3.cmml">h</mi></msub><mo stretchy="false" id="S3.p3.7.m7.4.4.3.3.8" xref="S3.p3.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.4b"><apply id="S3.p3.7.m7.4.4.cmml" xref="S3.p3.7.m7.4.4"><eq id="S3.p3.7.m7.4.4.4.cmml" xref="S3.p3.7.m7.4.4.4"></eq><ci id="S3.p3.7.m7.4.4.5.cmml" xref="S3.p3.7.m7.4.4.5">𝑝</ci><set id="S3.p3.7.m7.4.4.3.4.cmml" xref="S3.p3.7.m7.4.4.3.3"><apply id="S3.p3.7.m7.2.2.1.1.1.cmml" xref="S3.p3.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.7.m7.2.2.1.1.1.1.cmml" xref="S3.p3.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.p3.7.m7.2.2.1.1.1.2.cmml" xref="S3.p3.7.m7.2.2.1.1.1.2">𝑝</ci><cn type="integer" id="S3.p3.7.m7.2.2.1.1.1.3.cmml" xref="S3.p3.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="S3.p3.7.m7.3.3.2.2.2.cmml" xref="S3.p3.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p3.7.m7.3.3.2.2.2.1.cmml" xref="S3.p3.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.p3.7.m7.3.3.2.2.2.2.cmml" xref="S3.p3.7.m7.3.3.2.2.2.2">𝑝</ci><cn type="integer" id="S3.p3.7.m7.3.3.2.2.2.3.cmml" xref="S3.p3.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">…</ci><apply id="S3.p3.7.m7.4.4.3.3.3.cmml" xref="S3.p3.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p3.7.m7.4.4.3.3.3.1.cmml" xref="S3.p3.7.m7.4.4.3.3.3">subscript</csymbol><ci id="S3.p3.7.m7.4.4.3.3.3.2.cmml" xref="S3.p3.7.m7.4.4.3.3.3.2">𝑝</ci><ci id="S3.p3.7.m7.4.4.3.3.3.3.cmml" xref="S3.p3.7.m7.4.4.3.3.3.3">ℎ</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.4c">p=\{p_{1},p_{2},...,p_{h}\}</annotation></semantics></math>, and the corresponding prompt parameters can be trained. The prompts differ according to layers. We denote the template by <math id="S3.p3.8.m8.1" class="ltx_Math" alttext="\mathcal{T}(\cdot)" display="inline"><semantics id="S3.p3.8.m8.1a"><mrow id="S3.p3.8.m8.1.2" xref="S3.p3.8.m8.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.8.m8.1.2.2" xref="S3.p3.8.m8.1.2.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.p3.8.m8.1.2.1" xref="S3.p3.8.m8.1.2.1.cmml">​</mo><mrow id="S3.p3.8.m8.1.2.3.2" xref="S3.p3.8.m8.1.2.cmml"><mo stretchy="false" id="S3.p3.8.m8.1.2.3.2.1" xref="S3.p3.8.m8.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p3.8.m8.1.2.3.2.2" xref="S3.p3.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><apply id="S3.p3.8.m8.1.2.cmml" xref="S3.p3.8.m8.1.2"><times id="S3.p3.8.m8.1.2.1.cmml" xref="S3.p3.8.m8.1.2.1"></times><ci id="S3.p3.8.m8.1.2.2.cmml" xref="S3.p3.8.m8.1.2.2">𝒯</ci><ci id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">\mathcal{T}(\cdot)</annotation></semantics></math>, which defines how to concatenate the input tokens with the prompt. For instance, <math id="S3.p3.9.m9.2" class="ltx_Math" alttext="s_{k}^{p}=\mathcal{T}(s_{k},p)" display="inline"><semantics id="S3.p3.9.m9.2a"><mrow id="S3.p3.9.m9.2.2" xref="S3.p3.9.m9.2.2.cmml"><msubsup id="S3.p3.9.m9.2.2.3" xref="S3.p3.9.m9.2.2.3.cmml"><mi id="S3.p3.9.m9.2.2.3.2.2" xref="S3.p3.9.m9.2.2.3.2.2.cmml">s</mi><mi id="S3.p3.9.m9.2.2.3.2.3" xref="S3.p3.9.m9.2.2.3.2.3.cmml">k</mi><mi id="S3.p3.9.m9.2.2.3.3" xref="S3.p3.9.m9.2.2.3.3.cmml">p</mi></msubsup><mo id="S3.p3.9.m9.2.2.2" xref="S3.p3.9.m9.2.2.2.cmml">=</mo><mrow id="S3.p3.9.m9.2.2.1" xref="S3.p3.9.m9.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.9.m9.2.2.1.3" xref="S3.p3.9.m9.2.2.1.3.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S3.p3.9.m9.2.2.1.2" xref="S3.p3.9.m9.2.2.1.2.cmml">​</mo><mrow id="S3.p3.9.m9.2.2.1.1.1" xref="S3.p3.9.m9.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.p3.9.m9.2.2.1.1.1.2" xref="S3.p3.9.m9.2.2.1.1.2.cmml">(</mo><msub id="S3.p3.9.m9.2.2.1.1.1.1" xref="S3.p3.9.m9.2.2.1.1.1.1.cmml"><mi id="S3.p3.9.m9.2.2.1.1.1.1.2" xref="S3.p3.9.m9.2.2.1.1.1.1.2.cmml">s</mi><mi id="S3.p3.9.m9.2.2.1.1.1.1.3" xref="S3.p3.9.m9.2.2.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.p3.9.m9.2.2.1.1.1.3" xref="S3.p3.9.m9.2.2.1.1.2.cmml">,</mo><mi id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml">p</mi><mo stretchy="false" id="S3.p3.9.m9.2.2.1.1.1.4" xref="S3.p3.9.m9.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.2b"><apply id="S3.p3.9.m9.2.2.cmml" xref="S3.p3.9.m9.2.2"><eq id="S3.p3.9.m9.2.2.2.cmml" xref="S3.p3.9.m9.2.2.2"></eq><apply id="S3.p3.9.m9.2.2.3.cmml" xref="S3.p3.9.m9.2.2.3"><csymbol cd="ambiguous" id="S3.p3.9.m9.2.2.3.1.cmml" xref="S3.p3.9.m9.2.2.3">superscript</csymbol><apply id="S3.p3.9.m9.2.2.3.2.cmml" xref="S3.p3.9.m9.2.2.3"><csymbol cd="ambiguous" id="S3.p3.9.m9.2.2.3.2.1.cmml" xref="S3.p3.9.m9.2.2.3">subscript</csymbol><ci id="S3.p3.9.m9.2.2.3.2.2.cmml" xref="S3.p3.9.m9.2.2.3.2.2">𝑠</ci><ci id="S3.p3.9.m9.2.2.3.2.3.cmml" xref="S3.p3.9.m9.2.2.3.2.3">𝑘</ci></apply><ci id="S3.p3.9.m9.2.2.3.3.cmml" xref="S3.p3.9.m9.2.2.3.3">𝑝</ci></apply><apply id="S3.p3.9.m9.2.2.1.cmml" xref="S3.p3.9.m9.2.2.1"><times id="S3.p3.9.m9.2.2.1.2.cmml" xref="S3.p3.9.m9.2.2.1.2"></times><ci id="S3.p3.9.m9.2.2.1.3.cmml" xref="S3.p3.9.m9.2.2.1.3">𝒯</ci><interval closure="open" id="S3.p3.9.m9.2.2.1.1.2.cmml" xref="S3.p3.9.m9.2.2.1.1.1"><apply id="S3.p3.9.m9.2.2.1.1.1.1.cmml" xref="S3.p3.9.m9.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m9.2.2.1.1.1.1.1.cmml" xref="S3.p3.9.m9.2.2.1.1.1.1">subscript</csymbol><ci id="S3.p3.9.m9.2.2.1.1.1.1.2.cmml" xref="S3.p3.9.m9.2.2.1.1.1.1.2">𝑠</ci><ci id="S3.p3.9.m9.2.2.1.1.1.1.3.cmml" xref="S3.p3.9.m9.2.2.1.1.1.1.3">𝑘</ci></apply><ci id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1">𝑝</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.2c">s_{k}^{p}=\mathcal{T}(s_{k},p)</annotation></semantics></math> represents the sample combined with the prompt, which contains one [MASK] token. The output of the large language model with the prompts predicts the label <math id="S3.p3.10.m10.1" class="ltx_Math" alttext="m_{k}" display="inline"><semantics id="S3.p3.10.m10.1a"><msub id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml"><mi id="S3.p3.10.m10.1.1.2" xref="S3.p3.10.m10.1.1.2.cmml">m</mi><mi id="S3.p3.10.m10.1.1.3" xref="S3.p3.10.m10.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><apply id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p3.10.m10.1.1.1.cmml" xref="S3.p3.10.m10.1.1">subscript</csymbol><ci id="S3.p3.10.m10.1.1.2.cmml" xref="S3.p3.10.m10.1.1.2">𝑚</ci><ci id="S3.p3.10.m10.1.1.3.cmml" xref="S3.p3.10.m10.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">m_{k}</annotation></semantics></math>, which corresponds to the [MASK] token after applying a verbalizer <math id="S3.p3.11.m11.1" class="ltx_Math" alttext="\mathcal{V}(\cdot)" display="inline"><semantics id="S3.p3.11.m11.1a"><mrow id="S3.p3.11.m11.1.2" xref="S3.p3.11.m11.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.11.m11.1.2.2" xref="S3.p3.11.m11.1.2.2.cmml">𝒱</mi><mo lspace="0em" rspace="0em" id="S3.p3.11.m11.1.2.1" xref="S3.p3.11.m11.1.2.1.cmml">​</mo><mrow id="S3.p3.11.m11.1.2.3.2" xref="S3.p3.11.m11.1.2.cmml"><mo stretchy="false" id="S3.p3.11.m11.1.2.3.2.1" xref="S3.p3.11.m11.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.p3.11.m11.1.1" xref="S3.p3.11.m11.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.p3.11.m11.1.2.3.2.2" xref="S3.p3.11.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.11.m11.1b"><apply id="S3.p3.11.m11.1.2.cmml" xref="S3.p3.11.m11.1.2"><times id="S3.p3.11.m11.1.2.1.cmml" xref="S3.p3.11.m11.1.2.1"></times><ci id="S3.p3.11.m11.1.2.2.cmml" xref="S3.p3.11.m11.1.2.2">𝒱</ci><ci id="S3.p3.11.m11.1.1.cmml" xref="S3.p3.11.m11.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m11.1c">\mathcal{V}(\cdot)</annotation></semantics></math>, i.e., <math id="S3.p3.12.m12.1" class="ltx_Math" alttext="\hat{m_{k}}=\mathcal{V}(o_{k})" display="inline"><semantics id="S3.p3.12.m12.1a"><mrow id="S3.p3.12.m12.1.1" xref="S3.p3.12.m12.1.1.cmml"><mover accent="true" id="S3.p3.12.m12.1.1.3" xref="S3.p3.12.m12.1.1.3.cmml"><msub id="S3.p3.12.m12.1.1.3.2" xref="S3.p3.12.m12.1.1.3.2.cmml"><mi id="S3.p3.12.m12.1.1.3.2.2" xref="S3.p3.12.m12.1.1.3.2.2.cmml">m</mi><mi id="S3.p3.12.m12.1.1.3.2.3" xref="S3.p3.12.m12.1.1.3.2.3.cmml">k</mi></msub><mo id="S3.p3.12.m12.1.1.3.1" xref="S3.p3.12.m12.1.1.3.1.cmml">^</mo></mover><mo id="S3.p3.12.m12.1.1.2" xref="S3.p3.12.m12.1.1.2.cmml">=</mo><mrow id="S3.p3.12.m12.1.1.1" xref="S3.p3.12.m12.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.12.m12.1.1.1.3" xref="S3.p3.12.m12.1.1.1.3.cmml">𝒱</mi><mo lspace="0em" rspace="0em" id="S3.p3.12.m12.1.1.1.2" xref="S3.p3.12.m12.1.1.1.2.cmml">​</mo><mrow id="S3.p3.12.m12.1.1.1.1.1" xref="S3.p3.12.m12.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p3.12.m12.1.1.1.1.1.2" xref="S3.p3.12.m12.1.1.1.1.1.1.cmml">(</mo><msub id="S3.p3.12.m12.1.1.1.1.1.1" xref="S3.p3.12.m12.1.1.1.1.1.1.cmml"><mi id="S3.p3.12.m12.1.1.1.1.1.1.2" xref="S3.p3.12.m12.1.1.1.1.1.1.2.cmml">o</mi><mi id="S3.p3.12.m12.1.1.1.1.1.1.3" xref="S3.p3.12.m12.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.p3.12.m12.1.1.1.1.1.3" xref="S3.p3.12.m12.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.12.m12.1b"><apply id="S3.p3.12.m12.1.1.cmml" xref="S3.p3.12.m12.1.1"><eq id="S3.p3.12.m12.1.1.2.cmml" xref="S3.p3.12.m12.1.1.2"></eq><apply id="S3.p3.12.m12.1.1.3.cmml" xref="S3.p3.12.m12.1.1.3"><ci id="S3.p3.12.m12.1.1.3.1.cmml" xref="S3.p3.12.m12.1.1.3.1">^</ci><apply id="S3.p3.12.m12.1.1.3.2.cmml" xref="S3.p3.12.m12.1.1.3.2"><csymbol cd="ambiguous" id="S3.p3.12.m12.1.1.3.2.1.cmml" xref="S3.p3.12.m12.1.1.3.2">subscript</csymbol><ci id="S3.p3.12.m12.1.1.3.2.2.cmml" xref="S3.p3.12.m12.1.1.3.2.2">𝑚</ci><ci id="S3.p3.12.m12.1.1.3.2.3.cmml" xref="S3.p3.12.m12.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S3.p3.12.m12.1.1.1.cmml" xref="S3.p3.12.m12.1.1.1"><times id="S3.p3.12.m12.1.1.1.2.cmml" xref="S3.p3.12.m12.1.1.1.2"></times><ci id="S3.p3.12.m12.1.1.1.3.cmml" xref="S3.p3.12.m12.1.1.1.3">𝒱</ci><apply id="S3.p3.12.m12.1.1.1.1.1.1.cmml" xref="S3.p3.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p3.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.p3.12.m12.1.1.1.1.1">subscript</csymbol><ci id="S3.p3.12.m12.1.1.1.1.1.1.2.cmml" xref="S3.p3.12.m12.1.1.1.1.1.1.2">𝑜</ci><ci id="S3.p3.12.m12.1.1.1.1.1.1.3.cmml" xref="S3.p3.12.m12.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m12.1c">\hat{m_{k}}=\mathcal{V}(o_{k})</annotation></semantics></math> with <math id="S3.p3.13.m13.1" class="ltx_Math" alttext="o_{k}" display="inline"><semantics id="S3.p3.13.m13.1a"><msub id="S3.p3.13.m13.1.1" xref="S3.p3.13.m13.1.1.cmml"><mi id="S3.p3.13.m13.1.1.2" xref="S3.p3.13.m13.1.1.2.cmml">o</mi><mi id="S3.p3.13.m13.1.1.3" xref="S3.p3.13.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.13.m13.1b"><apply id="S3.p3.13.m13.1.1.cmml" xref="S3.p3.13.m13.1.1"><csymbol cd="ambiguous" id="S3.p3.13.m13.1.1.1.cmml" xref="S3.p3.13.m13.1.1">subscript</csymbol><ci id="S3.p3.13.m13.1.1.2.cmml" xref="S3.p3.13.m13.1.1.2">𝑜</ci><ci id="S3.p3.13.m13.1.1.3.cmml" xref="S3.p3.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m13.1c">o_{k}</annotation></semantics></math> representing the output of the model and <math id="S3.p3.14.m14.1" class="ltx_Math" alttext="\hat{m_{k}}" display="inline"><semantics id="S3.p3.14.m14.1a"><mover accent="true" id="S3.p3.14.m14.1.1" xref="S3.p3.14.m14.1.1.cmml"><msub id="S3.p3.14.m14.1.1.2" xref="S3.p3.14.m14.1.1.2.cmml"><mi id="S3.p3.14.m14.1.1.2.2" xref="S3.p3.14.m14.1.1.2.2.cmml">m</mi><mi id="S3.p3.14.m14.1.1.2.3" xref="S3.p3.14.m14.1.1.2.3.cmml">k</mi></msub><mo id="S3.p3.14.m14.1.1.1" xref="S3.p3.14.m14.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.p3.14.m14.1b"><apply id="S3.p3.14.m14.1.1.cmml" xref="S3.p3.14.m14.1.1"><ci id="S3.p3.14.m14.1.1.1.cmml" xref="S3.p3.14.m14.1.1.1">^</ci><apply id="S3.p3.14.m14.1.1.2.cmml" xref="S3.p3.14.m14.1.1.2"><csymbol cd="ambiguous" id="S3.p3.14.m14.1.1.2.1.cmml" xref="S3.p3.14.m14.1.1.2">subscript</csymbol><ci id="S3.p3.14.m14.1.1.2.2.cmml" xref="S3.p3.14.m14.1.1.2.2">𝑚</ci><ci id="S3.p3.14.m14.1.1.2.3.cmml" xref="S3.p3.14.m14.1.1.2.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.14.m14.1c">\hat{m_{k}}</annotation></semantics></math> referring to the predicted label.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we first present the system model. Then, we propose the parameter-efficient prompt tuning module and the communication-efficient adaptive optimization module, respectively.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>System Model</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">As shown in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Problem Formulation ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we consider a parameter server and multiple devices for the tuning process of FedPepTAO. We assume that a large language model is deployed on each device. For each layer, we insert a prompt module. During the tuning process, the large language model only perform inference while the prompt modules of each layer perform both the inference of the input and the update of parameters. Within the FL tuning process, the prompt parameters of specific layers are communicated between the device and the server.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">During the FL tuning process of FedPepTAO, the prompt parameters in each device are updated with multiple rounds. Each round consists of five steps. First, a set of devices are selected to perform the update of prompt parameters. Second, these devices receive the corresponding updated prompt parameters of specific layers from the server (①). The selection of the specific layers is based on our parameter-efficient prompt tuning method (see details in Section <a href="#S4.SS2" title="4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>) (② - ③). Third, the prompt parameters are updated with our adaptive optimization method (see details in Section <a href="#S4.SS3" title="4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>) based on the data on each device (④). Fourth, the prompt parameters of specific layers are sent back to the server (⑤). Fifth, the prompt parameters are aggregated on the server with the adaptive optimization method (⑥ - ⑦).</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Parameter-efficient Prompt Tuning</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We propose a parameter-efficient prompt tuning method to efficiently tune the language model with FL. Instead of synchronizing the full set of prompt parameters, we select a proper set of layers for each device and only exchange the prompt parameters of these layers during the tuning process. In this section, we propose a scoring method to measure the importance of each layer. Then, we propose a lossless layer selection method to select the proper layers, which reduces the communication costs without performance degradation.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.10" class="ltx_p">Given the prompt parameters based on any activation function, we can calculate the hidden states of each parameter at each layer of the large language model. With a batch of local data samples <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="S_{i}={\{s_{i}\}}^{n_{i}}" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><msub id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.3.2.cmml">S</mi><mi id="S4.SS2.p2.1.m1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.3.3.cmml">i</mi></msub><mo id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">=</mo><msup id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m1.1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS2.p2.1.m1.1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.1.m1.1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p2.1.m1.1.1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.1.2.cmml">}</mo></mrow><msub id="S4.SS2.p2.1.m1.1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.1.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.3.2" xref="S4.SS2.p2.1.m1.1.1.1.3.2.cmml">n</mi><mi id="S4.SS2.p2.1.m1.1.1.1.3.3" xref="S4.SS2.p2.1.m1.1.1.1.3.3.cmml">i</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"></eq><apply id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.3.2">𝑆</ci><ci id="S4.SS2.p2.1.m1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3.3">𝑖</ci></apply><apply id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1">superscript</csymbol><set id="S4.SS2.p2.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1"><apply id="S4.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS2.p2.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS2.p2.1.m1.1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.1.3.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.1.3.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.3.2">𝑛</ci><ci id="S4.SS2.p2.1.m1.1.1.1.3.3.cmml" xref="S4.SS2.p2.1.m1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">S_{i}={\{s_{i}\}}^{n_{i}}</annotation></semantics></math> mapped through the large language model and the prompt parameters corresponding to the function <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="f_{p}(s_{i})" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><msub id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1.3.2" xref="S4.SS2.p2.2.m2.1.1.3.2.cmml">f</mi><mi id="S4.SS2.p2.2.m2.1.1.3.3" xref="S4.SS2.p2.2.m2.1.1.3.3.cmml">p</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">​</mo><mrow id="S4.SS2.p2.2.m2.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.2.m2.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p2.2.m2.1.1.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.2" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.2.m2.1.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p2.2.m2.1.1.1.1.3" xref="S4.SS2.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><times id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2"></times><apply id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS2.p2.2.m2.1.1.3.2">𝑓</ci><ci id="S4.SS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3.3">𝑝</ci></apply><apply id="S4.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">f_{p}(s_{i})</annotation></semantics></math>, the hidden state corresponding to Node <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">k</annotation></semantics></math> at <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><ci id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">l</annotation></semantics></math>-th layer is <math id="S4.SS2.p2.5.m5.3" class="ltx_Math" alttext="f_{p_{k,l}}(s_{i})" display="inline"><semantics id="S4.SS2.p2.5.m5.3a"><mrow id="S4.SS2.p2.5.m5.3.3" xref="S4.SS2.p2.5.m5.3.3.cmml"><msub id="S4.SS2.p2.5.m5.3.3.3" xref="S4.SS2.p2.5.m5.3.3.3.cmml"><mi id="S4.SS2.p2.5.m5.3.3.3.2" xref="S4.SS2.p2.5.m5.3.3.3.2.cmml">f</mi><msub id="S4.SS2.p2.5.m5.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.cmml"><mi id="S4.SS2.p2.5.m5.2.2.2.4" xref="S4.SS2.p2.5.m5.2.2.2.4.cmml">p</mi><mrow id="S4.SS2.p2.5.m5.2.2.2.2.2.4" xref="S4.SS2.p2.5.m5.2.2.2.2.2.3.cmml"><mi id="S4.SS2.p2.5.m5.1.1.1.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.1.1.1.cmml">k</mi><mo id="S4.SS2.p2.5.m5.2.2.2.2.2.4.1" xref="S4.SS2.p2.5.m5.2.2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.5.m5.2.2.2.2.2.2" xref="S4.SS2.p2.5.m5.2.2.2.2.2.2.cmml">l</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.5.m5.3.3.2" xref="S4.SS2.p2.5.m5.3.3.2.cmml">​</mo><mrow id="S4.SS2.p2.5.m5.3.3.1.1" xref="S4.SS2.p2.5.m5.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.3.3.1.1.2" xref="S4.SS2.p2.5.m5.3.3.1.1.1.cmml">(</mo><msub id="S4.SS2.p2.5.m5.3.3.1.1.1" xref="S4.SS2.p2.5.m5.3.3.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.3.3.1.1.1.2" xref="S4.SS2.p2.5.m5.3.3.1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.5.m5.3.3.1.1.1.3" xref="S4.SS2.p2.5.m5.3.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p2.5.m5.3.3.1.1.3" xref="S4.SS2.p2.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.3b"><apply id="S4.SS2.p2.5.m5.3.3.cmml" xref="S4.SS2.p2.5.m5.3.3"><times id="S4.SS2.p2.5.m5.3.3.2.cmml" xref="S4.SS2.p2.5.m5.3.3.2"></times><apply id="S4.SS2.p2.5.m5.3.3.3.cmml" xref="S4.SS2.p2.5.m5.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.3.1.cmml" xref="S4.SS2.p2.5.m5.3.3.3">subscript</csymbol><ci id="S4.SS2.p2.5.m5.3.3.3.2.cmml" xref="S4.SS2.p2.5.m5.3.3.3.2">𝑓</ci><apply id="S4.SS2.p2.5.m5.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.2.2.2.4.cmml" xref="S4.SS2.p2.5.m5.2.2.2.4">𝑝</ci><list id="S4.SS2.p2.5.m5.2.2.2.2.2.3.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2.4"><ci id="S4.SS2.p2.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1.1.1.1">𝑘</ci><ci id="S4.SS2.p2.5.m5.2.2.2.2.2.2.cmml" xref="S4.SS2.p2.5.m5.2.2.2.2.2.2">𝑙</ci></list></apply></apply><apply id="S4.SS2.p2.5.m5.3.3.1.1.1.cmml" xref="S4.SS2.p2.5.m5.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.3.3.1.1.1.1.cmml" xref="S4.SS2.p2.5.m5.3.3.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.3.3.1.1.1.2.cmml" xref="S4.SS2.p2.5.m5.3.3.1.1.1.2">𝑠</ci><ci id="S4.SS2.p2.5.m5.3.3.1.1.1.3.cmml" xref="S4.SS2.p2.5.m5.3.3.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.3c">f_{p_{k,l}}(s_{i})</annotation></semantics></math>. Then, the hidden states of Layer <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">l</annotation></semantics></math> corresponding to Sample <math id="S4.SS2.p2.7.m7.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="S4.SS2.p2.7.m7.1a"><msub id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml"><mi id="S4.SS2.p2.7.m7.1.1.2" xref="S4.SS2.p2.7.m7.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.7.m7.1.1.3" xref="S4.SS2.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><apply id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.7.m7.1.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p2.7.m7.1.1.2.cmml" xref="S4.SS2.p2.7.m7.1.1.2">𝑠</ci><ci id="S4.SS2.p2.7.m7.1.1.3.cmml" xref="S4.SS2.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">s_{i}</annotation></semantics></math> is <math id="S4.SS2.p2.8.m8.12" class="ltx_Math" alttext="\mathbf{h}_{i,l}=\{f_{p_{1,l}}(s_{i}),f_{p_{2,l}}(s_{i}),...,f_{p_{K_{l},l}}(s_{i})\}" display="inline"><semantics id="S4.SS2.p2.8.m8.12a"><mrow id="S4.SS2.p2.8.m8.12.12" xref="S4.SS2.p2.8.m8.12.12.cmml"><msub id="S4.SS2.p2.8.m8.12.12.5" xref="S4.SS2.p2.8.m8.12.12.5.cmml"><mi id="S4.SS2.p2.8.m8.12.12.5.2" xref="S4.SS2.p2.8.m8.12.12.5.2.cmml">𝐡</mi><mrow id="S4.SS2.p2.8.m8.2.2.2.4" xref="S4.SS2.p2.8.m8.2.2.2.3.cmml"><mi id="S4.SS2.p2.8.m8.1.1.1.1" xref="S4.SS2.p2.8.m8.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p2.8.m8.2.2.2.4.1" xref="S4.SS2.p2.8.m8.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.8.m8.2.2.2.2" xref="S4.SS2.p2.8.m8.2.2.2.2.cmml">l</mi></mrow></msub><mo id="S4.SS2.p2.8.m8.12.12.4" xref="S4.SS2.p2.8.m8.12.12.4.cmml">=</mo><mrow id="S4.SS2.p2.8.m8.12.12.3.3" xref="S4.SS2.p2.8.m8.12.12.3.4.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.12.12.3.3.4" xref="S4.SS2.p2.8.m8.12.12.3.4.cmml">{</mo><mrow id="S4.SS2.p2.8.m8.10.10.1.1.1" xref="S4.SS2.p2.8.m8.10.10.1.1.1.cmml"><msub id="S4.SS2.p2.8.m8.10.10.1.1.1.3" xref="S4.SS2.p2.8.m8.10.10.1.1.1.3.cmml"><mi id="S4.SS2.p2.8.m8.10.10.1.1.1.3.2" xref="S4.SS2.p2.8.m8.10.10.1.1.1.3.2.cmml">f</mi><msub id="S4.SS2.p2.8.m8.4.4.2" xref="S4.SS2.p2.8.m8.4.4.2.cmml"><mi id="S4.SS2.p2.8.m8.4.4.2.4" xref="S4.SS2.p2.8.m8.4.4.2.4.cmml">p</mi><mrow id="S4.SS2.p2.8.m8.4.4.2.2.2.4" xref="S4.SS2.p2.8.m8.4.4.2.2.2.3.cmml"><mn id="S4.SS2.p2.8.m8.3.3.1.1.1.1" xref="S4.SS2.p2.8.m8.3.3.1.1.1.1.cmml">1</mn><mo id="S4.SS2.p2.8.m8.4.4.2.2.2.4.1" xref="S4.SS2.p2.8.m8.4.4.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.8.m8.4.4.2.2.2.2" xref="S4.SS2.p2.8.m8.4.4.2.2.2.2.cmml">l</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.8.m8.10.10.1.1.1.2" xref="S4.SS2.p2.8.m8.10.10.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.2" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.2" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.3" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.3" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.8.m8.12.12.3.3.5" xref="S4.SS2.p2.8.m8.12.12.3.4.cmml">,</mo><mrow id="S4.SS2.p2.8.m8.11.11.2.2.2" xref="S4.SS2.p2.8.m8.11.11.2.2.2.cmml"><msub id="S4.SS2.p2.8.m8.11.11.2.2.2.3" xref="S4.SS2.p2.8.m8.11.11.2.2.2.3.cmml"><mi id="S4.SS2.p2.8.m8.11.11.2.2.2.3.2" xref="S4.SS2.p2.8.m8.11.11.2.2.2.3.2.cmml">f</mi><msub id="S4.SS2.p2.8.m8.6.6.2" xref="S4.SS2.p2.8.m8.6.6.2.cmml"><mi id="S4.SS2.p2.8.m8.6.6.2.4" xref="S4.SS2.p2.8.m8.6.6.2.4.cmml">p</mi><mrow id="S4.SS2.p2.8.m8.6.6.2.2.2.4" xref="S4.SS2.p2.8.m8.6.6.2.2.2.3.cmml"><mn id="S4.SS2.p2.8.m8.5.5.1.1.1.1" xref="S4.SS2.p2.8.m8.5.5.1.1.1.1.cmml">2</mn><mo id="S4.SS2.p2.8.m8.6.6.2.2.2.4.1" xref="S4.SS2.p2.8.m8.6.6.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.8.m8.6.6.2.2.2.2" xref="S4.SS2.p2.8.m8.6.6.2.2.2.2.cmml">l</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.8.m8.11.11.2.2.2.2" xref="S4.SS2.p2.8.m8.11.11.2.2.2.2.cmml">​</mo><mrow id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.2" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.cmml">(</mo><msub id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.cmml"><mi id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.2" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.3" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.3" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.8.m8.12.12.3.3.6" xref="S4.SS2.p2.8.m8.12.12.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.p2.8.m8.9.9" xref="S4.SS2.p2.8.m8.9.9.cmml">…</mi><mo id="S4.SS2.p2.8.m8.12.12.3.3.7" xref="S4.SS2.p2.8.m8.12.12.3.4.cmml">,</mo><mrow id="S4.SS2.p2.8.m8.12.12.3.3.3" xref="S4.SS2.p2.8.m8.12.12.3.3.3.cmml"><msub id="S4.SS2.p2.8.m8.12.12.3.3.3.3" xref="S4.SS2.p2.8.m8.12.12.3.3.3.3.cmml"><mi id="S4.SS2.p2.8.m8.12.12.3.3.3.3.2" xref="S4.SS2.p2.8.m8.12.12.3.3.3.3.2.cmml">f</mi><msub id="S4.SS2.p2.8.m8.8.8.2" xref="S4.SS2.p2.8.m8.8.8.2.cmml"><mi id="S4.SS2.p2.8.m8.8.8.2.4" xref="S4.SS2.p2.8.m8.8.8.2.4.cmml">p</mi><mrow id="S4.SS2.p2.8.m8.8.8.2.2.2.2" xref="S4.SS2.p2.8.m8.8.8.2.2.2.3.cmml"><msub id="S4.SS2.p2.8.m8.8.8.2.2.2.2.1" xref="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.cmml"><mi id="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.2" xref="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.2.cmml">K</mi><mi id="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.3" xref="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.3.cmml">l</mi></msub><mo id="S4.SS2.p2.8.m8.8.8.2.2.2.2.2" xref="S4.SS2.p2.8.m8.8.8.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.8.m8.7.7.1.1.1.1" xref="S4.SS2.p2.8.m8.7.7.1.1.1.1.cmml">l</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p2.8.m8.12.12.3.3.3.2" xref="S4.SS2.p2.8.m8.12.12.3.3.3.2.cmml">​</mo><mrow id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.2" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.cmml">(</mo><msub id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.cmml"><mi id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.2" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.3" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.3" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS2.p2.8.m8.12.12.3.3.8" xref="S4.SS2.p2.8.m8.12.12.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.12b"><apply id="S4.SS2.p2.8.m8.12.12.cmml" xref="S4.SS2.p2.8.m8.12.12"><eq id="S4.SS2.p2.8.m8.12.12.4.cmml" xref="S4.SS2.p2.8.m8.12.12.4"></eq><apply id="S4.SS2.p2.8.m8.12.12.5.cmml" xref="S4.SS2.p2.8.m8.12.12.5"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.12.12.5.1.cmml" xref="S4.SS2.p2.8.m8.12.12.5">subscript</csymbol><ci id="S4.SS2.p2.8.m8.12.12.5.2.cmml" xref="S4.SS2.p2.8.m8.12.12.5.2">𝐡</ci><list id="S4.SS2.p2.8.m8.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.2.2.2.4"><ci id="S4.SS2.p2.8.m8.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1.1.1">𝑖</ci><ci id="S4.SS2.p2.8.m8.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.2.2.2.2">𝑙</ci></list></apply><set id="S4.SS2.p2.8.m8.12.12.3.4.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3"><apply id="S4.SS2.p2.8.m8.10.10.1.1.1.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1"><times id="S4.SS2.p2.8.m8.10.10.1.1.1.2.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1.2"></times><apply id="S4.SS2.p2.8.m8.10.10.1.1.1.3.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.10.10.1.1.1.3.1.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p2.8.m8.10.10.1.1.1.3.2.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1.3.2">𝑓</ci><apply id="S4.SS2.p2.8.m8.4.4.2.cmml" xref="S4.SS2.p2.8.m8.4.4.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.4.4.2.3.cmml" xref="S4.SS2.p2.8.m8.4.4.2">subscript</csymbol><ci id="S4.SS2.p2.8.m8.4.4.2.4.cmml" xref="S4.SS2.p2.8.m8.4.4.2.4">𝑝</ci><list id="S4.SS2.p2.8.m8.4.4.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.4.4.2.2.2.4"><cn type="integer" id="S4.SS2.p2.8.m8.3.3.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.3.3.1.1.1.1">1</cn><ci id="S4.SS2.p2.8.m8.4.4.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.4.4.2.2.2.2">𝑙</ci></list></apply></apply><apply id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.2">𝑠</ci><ci id="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p2.8.m8.10.10.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.SS2.p2.8.m8.11.11.2.2.2.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2"><times id="S4.SS2.p2.8.m8.11.11.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2.2"></times><apply id="S4.SS2.p2.8.m8.11.11.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.11.11.2.2.2.3.1.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2.3">subscript</csymbol><ci id="S4.SS2.p2.8.m8.11.11.2.2.2.3.2.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2.3.2">𝑓</ci><apply id="S4.SS2.p2.8.m8.6.6.2.cmml" xref="S4.SS2.p2.8.m8.6.6.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.6.6.2.3.cmml" xref="S4.SS2.p2.8.m8.6.6.2">subscript</csymbol><ci id="S4.SS2.p2.8.m8.6.6.2.4.cmml" xref="S4.SS2.p2.8.m8.6.6.2.4">𝑝</ci><list id="S4.SS2.p2.8.m8.6.6.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.6.6.2.2.2.4"><cn type="integer" id="S4.SS2.p2.8.m8.5.5.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.5.5.1.1.1.1">2</cn><ci id="S4.SS2.p2.8.m8.6.6.2.2.2.2.cmml" xref="S4.SS2.p2.8.m8.6.6.2.2.2.2">𝑙</ci></list></apply></apply><apply id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.2.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.2">𝑠</ci><ci id="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.3.cmml" xref="S4.SS2.p2.8.m8.11.11.2.2.2.1.1.1.3">𝑖</ci></apply></apply><ci id="S4.SS2.p2.8.m8.9.9.cmml" xref="S4.SS2.p2.8.m8.9.9">…</ci><apply id="S4.SS2.p2.8.m8.12.12.3.3.3.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3"><times id="S4.SS2.p2.8.m8.12.12.3.3.3.2.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3.2"></times><apply id="S4.SS2.p2.8.m8.12.12.3.3.3.3.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.12.12.3.3.3.3.1.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3.3">subscript</csymbol><ci id="S4.SS2.p2.8.m8.12.12.3.3.3.3.2.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3.3.2">𝑓</ci><apply id="S4.SS2.p2.8.m8.8.8.2.cmml" xref="S4.SS2.p2.8.m8.8.8.2"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.8.8.2.3.cmml" xref="S4.SS2.p2.8.m8.8.8.2">subscript</csymbol><ci id="S4.SS2.p2.8.m8.8.8.2.4.cmml" xref="S4.SS2.p2.8.m8.8.8.2.4">𝑝</ci><list id="S4.SS2.p2.8.m8.8.8.2.2.2.3.cmml" xref="S4.SS2.p2.8.m8.8.8.2.2.2.2"><apply id="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.cmml" xref="S4.SS2.p2.8.m8.8.8.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.1.cmml" xref="S4.SS2.p2.8.m8.8.8.2.2.2.2.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.2.cmml" xref="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.2">𝐾</ci><ci id="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.3.cmml" xref="S4.SS2.p2.8.m8.8.8.2.2.2.2.1.3">𝑙</ci></apply><ci id="S4.SS2.p2.8.m8.7.7.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.7.7.1.1.1.1">𝑙</ci></list></apply></apply><apply id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.1.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.2.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.2">𝑠</ci><ci id="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.3.cmml" xref="S4.SS2.p2.8.m8.12.12.3.3.3.1.1.1.3">𝑖</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.12c">\mathbf{h}_{i,l}=\{f_{p_{1,l}}(s_{i}),f_{p_{2,l}}(s_{i}),...,f_{p_{K_{l},l}}(s_{i})\}</annotation></semantics></math>, with <math id="S4.SS2.p2.9.m9.1" class="ltx_Math" alttext="K_{l}" display="inline"><semantics id="S4.SS2.p2.9.m9.1a"><msub id="S4.SS2.p2.9.m9.1.1" xref="S4.SS2.p2.9.m9.1.1.cmml"><mi id="S4.SS2.p2.9.m9.1.1.2" xref="S4.SS2.p2.9.m9.1.1.2.cmml">K</mi><mi id="S4.SS2.p2.9.m9.1.1.3" xref="S4.SS2.p2.9.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m9.1b"><apply id="S4.SS2.p2.9.m9.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m9.1.1.1.cmml" xref="S4.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.p2.9.m9.1.1.2.cmml" xref="S4.SS2.p2.9.m9.1.1.2">𝐾</ci><ci id="S4.SS2.p2.9.m9.1.1.3.cmml" xref="S4.SS2.p2.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m9.1c">K_{l}</annotation></semantics></math> representing the number of nodes at Layer <math id="S4.SS2.p2.10.m10.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.SS2.p2.10.m10.1a"><mi id="S4.SS2.p2.10.m10.1.1" xref="S4.SS2.p2.10.m10.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m10.1b"><ci id="S4.SS2.p2.10.m10.1.1.cmml" xref="S4.SS2.p2.10.m10.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m10.1c">L</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.13" class="ltx_p">As the difficulty for a network to learn to separate the input samples has positive correlation with the similarity of the hidden states <cite class="ltx_cite ltx_citemacro_cite">Mellor et al. (<a href="#bib.bib58" title="" class="ltx_ref">2021</a>)</cite>, we examine the correlation between the hidden states of any two layers by computing the following kernel matrix:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.1" class="ltx_Math" alttext="\mathbf{K}_{h_{i}}=\begin{pmatrix}Cos(\mathbf{h}_{i,1},\mathbf{h}_{i,1})&amp;\cdots&amp;Cos(\mathbf{h}_{i,1},\mathbf{h}_{i,L})\\
\vdots&amp;\ddots&amp;\vdots\\
Cos(\mathbf{h}_{i,L},\mathbf{h}_{i,1})&amp;\cdots&amp;Cos(\mathbf{h}_{i,L},\mathbf{h}_{i,L})\\
\end{pmatrix}" display="block"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.2" xref="S4.E2.m1.1.2.cmml"><msub id="S4.E2.m1.1.2.2" xref="S4.E2.m1.1.2.2.cmml"><mi id="S4.E2.m1.1.2.2.2" xref="S4.E2.m1.1.2.2.2.cmml">𝐊</mi><msub id="S4.E2.m1.1.2.2.3" xref="S4.E2.m1.1.2.2.3.cmml"><mi id="S4.E2.m1.1.2.2.3.2" xref="S4.E2.m1.1.2.2.3.2.cmml">h</mi><mi id="S4.E2.m1.1.2.2.3.3" xref="S4.E2.m1.1.2.2.3.3.cmml">i</mi></msub></msub><mo id="S4.E2.m1.1.2.1" xref="S4.E2.m1.1.2.1.cmml">=</mo><mrow id="S4.E2.m1.1.1.3" xref="S4.E2.m1.1.1.2.cmml"><mo id="S4.E2.m1.1.1.3.1" xref="S4.E2.m1.1.1.2.1.cmml">(</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mtr id="S4.E2.m1.1.1.1.1a" xref="S4.E2.m1.1.1.1.1.cmml"><mtd id="S4.E2.m1.1.1.1.1b" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.6.6.6.6" xref="S4.E2.m1.1.1.1.1.6.6.6.6.cmml"><mi id="S4.E2.m1.1.1.1.1.6.6.6.6.8" xref="S4.E2.m1.1.1.1.1.6.6.6.6.8.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.6.6.6.6.7" xref="S4.E2.m1.1.1.1.1.6.6.6.6.7.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.6.6.6.6.9" xref="S4.E2.m1.1.1.1.1.6.6.6.6.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.6.6.6.6.7a" xref="S4.E2.m1.1.1.1.1.6.6.6.6.7.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.6.6.6.6.10" xref="S4.E2.m1.1.1.1.1.6.6.6.6.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.6.6.6.6.7b" xref="S4.E2.m1.1.1.1.1.6.6.6.6.7.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.3.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.3" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.3.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1" xref="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1.2" xref="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1.2.cmml">𝐡</mi><mrow id="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.4" xref="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.4.1" xref="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">,</mo><mn id="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.4" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.3.cmml">,</mo><msub id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2.cmml"><mi id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2.2" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2.2.cmml">𝐡</mi><mrow id="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.4" xref="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.3.3.3.3.3.1.1" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.1.1.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.4.1" xref="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.3.cmml">,</mo><mn id="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.2" xref="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.5" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.3.cmml">)</mo></mrow></mrow></mtd><mtd id="S4.E2.m1.1.1.1.1c" xref="S4.E2.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E2.m1.1.1.1.1.12.12.13.1" xref="S4.E2.m1.1.1.1.1.12.12.13.1.cmml">⋯</mi></mtd><mtd id="S4.E2.m1.1.1.1.1d" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.12.12.12.6" xref="S4.E2.m1.1.1.1.1.12.12.12.6.cmml"><mi id="S4.E2.m1.1.1.1.1.12.12.12.6.8" xref="S4.E2.m1.1.1.1.1.12.12.12.6.8.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.12.12.12.6.7" xref="S4.E2.m1.1.1.1.1.12.12.12.6.7.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.12.12.12.6.9" xref="S4.E2.m1.1.1.1.1.12.12.12.6.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.12.12.12.6.7a" xref="S4.E2.m1.1.1.1.1.12.12.12.6.7.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.12.12.12.6.10" xref="S4.E2.m1.1.1.1.1.12.12.12.6.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.12.12.12.6.7b" xref="S4.E2.m1.1.1.1.1.12.12.12.6.7.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.3.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.3" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.3.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1" xref="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1.2" xref="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1.2.cmml">𝐡</mi><mrow id="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.4" xref="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.7.7.7.1.1.1.1" xref="S4.E2.m1.1.1.1.1.7.7.7.1.1.1.1.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.4.1" xref="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.3.cmml">,</mo><mn id="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.2" xref="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.4" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.3.cmml">,</mo><msub id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2.cmml"><mi id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2.2" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2.2.cmml">𝐡</mi><mrow id="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.4" xref="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.9.9.9.3.3.1.1" xref="S4.E2.m1.1.1.1.1.9.9.9.3.3.1.1.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.4.1" xref="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.3.cmml">,</mo><mi id="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.2" xref="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.2.cmml">L</mi></mrow></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.5" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.3.cmml">)</mo></mrow></mrow></mtd></mtr><mtr id="S4.E2.m1.1.1.1.1e" xref="S4.E2.m1.1.1.1.1.cmml"><mtd id="S4.E2.m1.1.1.1.1f" xref="S4.E2.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E2.m1.1.1.1.1.25.1.1" xref="S4.E2.m1.1.1.1.1.25.1.1.cmml">⋮</mi></mtd><mtd id="S4.E2.m1.1.1.1.1g" xref="S4.E2.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E2.m1.1.1.1.1.25.2.1" xref="S4.E2.m1.1.1.1.1.25.2.1.cmml">⋱</mi></mtd><mtd id="S4.E2.m1.1.1.1.1h" xref="S4.E2.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E2.m1.1.1.1.1.25.3.1" xref="S4.E2.m1.1.1.1.1.25.3.1.cmml">⋮</mi></mtd></mtr><mtr id="S4.E2.m1.1.1.1.1i" xref="S4.E2.m1.1.1.1.1.cmml"><mtd id="S4.E2.m1.1.1.1.1j" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.18.18.6.6" xref="S4.E2.m1.1.1.1.1.18.18.6.6.cmml"><mi id="S4.E2.m1.1.1.1.1.18.18.6.6.8" xref="S4.E2.m1.1.1.1.1.18.18.6.6.8.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.18.18.6.6.7" xref="S4.E2.m1.1.1.1.1.18.18.6.6.7.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.18.18.6.6.9" xref="S4.E2.m1.1.1.1.1.18.18.6.6.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.18.18.6.6.7a" xref="S4.E2.m1.1.1.1.1.18.18.6.6.7.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.18.18.6.6.10" xref="S4.E2.m1.1.1.1.1.18.18.6.6.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.18.18.6.6.7b" xref="S4.E2.m1.1.1.1.1.18.18.6.6.7.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.3.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.3" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.3.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1" xref="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1.2" xref="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1.2.cmml">𝐡</mi><mrow id="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.4" xref="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.13.13.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.13.13.1.1.1.1.1.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.4.1" xref="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.3.cmml">,</mo><mi id="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.2" xref="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.2.cmml">L</mi></mrow></msub><mo id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.4" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.3.cmml">,</mo><msub id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2.cmml"><mi id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2.2" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2.2.cmml">𝐡</mi><mrow id="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.4" xref="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.15.15.3.3.3.1.1" xref="S4.E2.m1.1.1.1.1.15.15.3.3.3.1.1.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.4.1" xref="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.3.cmml">,</mo><mn id="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.2" xref="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.5" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.3.cmml">)</mo></mrow></mrow></mtd><mtd id="S4.E2.m1.1.1.1.1k" xref="S4.E2.m1.1.1.1.1.cmml"><mi mathvariant="normal" id="S4.E2.m1.1.1.1.1.24.24.13.1" xref="S4.E2.m1.1.1.1.1.24.24.13.1.cmml">⋯</mi></mtd><mtd id="S4.E2.m1.1.1.1.1l" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.24.24.12.6" xref="S4.E2.m1.1.1.1.1.24.24.12.6.cmml"><mi id="S4.E2.m1.1.1.1.1.24.24.12.6.8" xref="S4.E2.m1.1.1.1.1.24.24.12.6.8.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.24.24.12.6.7" xref="S4.E2.m1.1.1.1.1.24.24.12.6.7.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.24.24.12.6.9" xref="S4.E2.m1.1.1.1.1.24.24.12.6.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.24.24.12.6.7a" xref="S4.E2.m1.1.1.1.1.24.24.12.6.7.cmml">​</mo><mi id="S4.E2.m1.1.1.1.1.24.24.12.6.10" xref="S4.E2.m1.1.1.1.1.24.24.12.6.10.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.24.24.12.6.7b" xref="S4.E2.m1.1.1.1.1.24.24.12.6.7.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.3.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.3" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.3.cmml">(</mo><msub id="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1" xref="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1.2" xref="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1.2.cmml">𝐡</mi><mrow id="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.4" xref="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.19.19.7.1.1.1.1" xref="S4.E2.m1.1.1.1.1.19.19.7.1.1.1.1.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.4.1" xref="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.3.cmml">,</mo><mi id="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.2" xref="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.2.cmml">L</mi></mrow></msub><mo id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.4" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.3.cmml">,</mo><msub id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2.cmml"><mi id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2.2" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2.2.cmml">𝐡</mi><mrow id="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.4" xref="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.21.21.9.3.3.1.1" xref="S4.E2.m1.1.1.1.1.21.21.9.3.3.1.1.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.4.1" xref="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.3.cmml">,</mo><mi id="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.2" xref="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.2.cmml">L</mi></mrow></msub><mo stretchy="false" id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.5" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.3.cmml">)</mo></mrow></mrow></mtd></mtr></mtable><mo id="S4.E2.m1.1.1.3.2" xref="S4.E2.m1.1.1.2.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.2.cmml" xref="S4.E2.m1.1.2"><eq id="S4.E2.m1.1.2.1.cmml" xref="S4.E2.m1.1.2.1"></eq><apply id="S4.E2.m1.1.2.2.cmml" xref="S4.E2.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.2.2.1.cmml" xref="S4.E2.m1.1.2.2">subscript</csymbol><ci id="S4.E2.m1.1.2.2.2.cmml" xref="S4.E2.m1.1.2.2.2">𝐊</ci><apply id="S4.E2.m1.1.2.2.3.cmml" xref="S4.E2.m1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.2.2.3.1.cmml" xref="S4.E2.m1.1.2.2.3">subscript</csymbol><ci id="S4.E2.m1.1.2.2.3.2.cmml" xref="S4.E2.m1.1.2.2.3.2">ℎ</ci><ci id="S4.E2.m1.1.2.2.3.3.cmml" xref="S4.E2.m1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S4.E2.m1.1.1.2.cmml" xref="S4.E2.m1.1.1.3"><csymbol cd="latexml" id="S4.E2.m1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.3.1">matrix</csymbol><matrix id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1"><matrixrow id="S4.E2.m1.1.1.1.1a.cmml" xref="S4.E2.m1.1.1.1.1"><apply id="S4.E2.m1.1.1.1.1.6.6.6.6.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6"><times id="S4.E2.m1.1.1.1.1.6.6.6.6.7.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6.7"></times><ci id="S4.E2.m1.1.1.1.1.6.6.6.6.8.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6.8">𝐶</ci><ci id="S4.E2.m1.1.1.1.1.6.6.6.6.9.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6.9">𝑜</ci><ci id="S4.E2.m1.1.1.1.1.6.6.6.6.10.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6.10">𝑠</ci><interval closure="open" id="S4.E2.m1.1.1.1.1.6.6.6.6.6.3.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.2"><apply id="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1.cmml" xref="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.5.5.5.5.5.1.1.2">𝐡</ci><list id="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.4"><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.1.1">𝑖</ci><cn type="integer" id="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.2.2.2.2.2.2.2">1</cn></list></apply><apply id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.6.6.6.6.6.2.2.2">𝐡</ci><list id="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.3.cmml" xref="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.4"><ci id="S4.E2.m1.1.1.1.1.3.3.3.3.3.1.1.cmml" xref="S4.E2.m1.1.1.1.1.3.3.3.3.3.1.1">𝑖</ci><cn type="integer" id="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.2.cmml" xref="S4.E2.m1.1.1.1.1.4.4.4.4.4.2.2">1</cn></list></apply></interval></apply><ci id="S4.E2.m1.1.1.1.1.12.12.13.1.cmml" xref="S4.E2.m1.1.1.1.1.12.12.13.1">⋯</ci><apply id="S4.E2.m1.1.1.1.1.12.12.12.6.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6"><times id="S4.E2.m1.1.1.1.1.12.12.12.6.7.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6.7"></times><ci id="S4.E2.m1.1.1.1.1.12.12.12.6.8.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6.8">𝐶</ci><ci id="S4.E2.m1.1.1.1.1.12.12.12.6.9.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6.9">𝑜</ci><ci id="S4.E2.m1.1.1.1.1.12.12.12.6.10.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6.10">𝑠</ci><interval closure="open" id="S4.E2.m1.1.1.1.1.12.12.12.6.6.3.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.2"><apply id="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1.cmml" xref="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.11.11.11.5.5.1.1.2">𝐡</ci><list id="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.4"><ci id="S4.E2.m1.1.1.1.1.7.7.7.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.7.7.7.1.1.1.1">𝑖</ci><cn type="integer" id="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.8.8.8.2.2.2.2">1</cn></list></apply><apply id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.12.12.12.6.6.2.2.2">𝐡</ci><list id="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.3.cmml" xref="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.4"><ci id="S4.E2.m1.1.1.1.1.9.9.9.3.3.1.1.cmml" xref="S4.E2.m1.1.1.1.1.9.9.9.3.3.1.1">𝑖</ci><ci id="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.2.cmml" xref="S4.E2.m1.1.1.1.1.10.10.10.4.4.2.2">𝐿</ci></list></apply></interval></apply></matrixrow><matrixrow id="S4.E2.m1.1.1.1.1b.cmml" xref="S4.E2.m1.1.1.1.1"><ci id="S4.E2.m1.1.1.1.1.25.1.1.cmml" xref="S4.E2.m1.1.1.1.1.25.1.1">⋮</ci><ci id="S4.E2.m1.1.1.1.1.25.2.1.cmml" xref="S4.E2.m1.1.1.1.1.25.2.1">⋱</ci><ci id="S4.E2.m1.1.1.1.1.25.3.1.cmml" xref="S4.E2.m1.1.1.1.1.25.3.1">⋮</ci></matrixrow><matrixrow id="S4.E2.m1.1.1.1.1c.cmml" xref="S4.E2.m1.1.1.1.1"><apply id="S4.E2.m1.1.1.1.1.18.18.6.6.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6"><times id="S4.E2.m1.1.1.1.1.18.18.6.6.7.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6.7"></times><ci id="S4.E2.m1.1.1.1.1.18.18.6.6.8.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6.8">𝐶</ci><ci id="S4.E2.m1.1.1.1.1.18.18.6.6.9.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6.9">𝑜</ci><ci id="S4.E2.m1.1.1.1.1.18.18.6.6.10.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6.10">𝑠</ci><interval closure="open" id="S4.E2.m1.1.1.1.1.18.18.6.6.6.3.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.2"><apply id="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1.cmml" xref="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.17.17.5.5.5.1.1.2">𝐡</ci><list id="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.4"><ci id="S4.E2.m1.1.1.1.1.13.13.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.13.13.1.1.1.1.1">𝑖</ci><ci id="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.14.14.2.2.2.2.2">𝐿</ci></list></apply><apply id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.18.18.6.6.6.2.2.2">𝐡</ci><list id="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.3.cmml" xref="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.4"><ci id="S4.E2.m1.1.1.1.1.15.15.3.3.3.1.1.cmml" xref="S4.E2.m1.1.1.1.1.15.15.3.3.3.1.1">𝑖</ci><cn type="integer" id="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.2.cmml" xref="S4.E2.m1.1.1.1.1.16.16.4.4.4.2.2">1</cn></list></apply></interval></apply><ci id="S4.E2.m1.1.1.1.1.24.24.13.1.cmml" xref="S4.E2.m1.1.1.1.1.24.24.13.1">⋯</ci><apply id="S4.E2.m1.1.1.1.1.24.24.12.6.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6"><times id="S4.E2.m1.1.1.1.1.24.24.12.6.7.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6.7"></times><ci id="S4.E2.m1.1.1.1.1.24.24.12.6.8.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6.8">𝐶</ci><ci id="S4.E2.m1.1.1.1.1.24.24.12.6.9.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6.9">𝑜</ci><ci id="S4.E2.m1.1.1.1.1.24.24.12.6.10.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6.10">𝑠</ci><interval closure="open" id="S4.E2.m1.1.1.1.1.24.24.12.6.6.3.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.2"><apply id="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1.cmml" xref="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.23.23.11.5.5.1.1.2">𝐡</ci><list id="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.4"><ci id="S4.E2.m1.1.1.1.1.19.19.7.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.19.19.7.1.1.1.1">𝑖</ci><ci id="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.20.20.8.2.2.2.2">𝐿</ci></list></apply><apply id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.24.24.12.6.6.2.2.2">𝐡</ci><list id="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.3.cmml" xref="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.4"><ci id="S4.E2.m1.1.1.1.1.21.21.9.3.3.1.1.cmml" xref="S4.E2.m1.1.1.1.1.21.21.9.3.3.1.1">𝑖</ci><ci id="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.2.cmml" xref="S4.E2.m1.1.1.1.1.22.22.10.4.4.2.2">𝐿</ci></list></apply></interval></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\mathbf{K}_{h_{i}}=\begin{pmatrix}Cos(\mathbf{h}_{i,1},\mathbf{h}_{i,1})&amp;\cdots&amp;Cos(\mathbf{h}_{i,1},\mathbf{h}_{i,L})\\
\vdots&amp;\ddots&amp;\vdots\\
Cos(\mathbf{h}_{i,L},\mathbf{h}_{i,1})&amp;\cdots&amp;Cos(\mathbf{h}_{i,L},\mathbf{h}_{i,L})\\
\end{pmatrix}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.8" class="ltx_p">where <math id="S4.SS2.p3.1.m1.6" class="ltx_Math" alttext="Cos(\mathbf{h}_{i,L},\mathbf{h}_{i,1})" display="inline"><semantics id="S4.SS2.p3.1.m1.6a"><mrow id="S4.SS2.p3.1.m1.6.6" xref="S4.SS2.p3.1.m1.6.6.cmml"><mi id="S4.SS2.p3.1.m1.6.6.4" xref="S4.SS2.p3.1.m1.6.6.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.6.6.3" xref="S4.SS2.p3.1.m1.6.6.3.cmml">​</mo><mi id="S4.SS2.p3.1.m1.6.6.5" xref="S4.SS2.p3.1.m1.6.6.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.6.6.3a" xref="S4.SS2.p3.1.m1.6.6.3.cmml">​</mo><mi id="S4.SS2.p3.1.m1.6.6.6" xref="S4.SS2.p3.1.m1.6.6.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.6.6.3b" xref="S4.SS2.p3.1.m1.6.6.3.cmml">​</mo><mrow id="S4.SS2.p3.1.m1.6.6.2.2" xref="S4.SS2.p3.1.m1.6.6.2.3.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.6.6.2.2.3" xref="S4.SS2.p3.1.m1.6.6.2.3.cmml">(</mo><msub id="S4.SS2.p3.1.m1.5.5.1.1.1" xref="S4.SS2.p3.1.m1.5.5.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.5.5.1.1.1.2" xref="S4.SS2.p3.1.m1.5.5.1.1.1.2.cmml">𝐡</mi><mrow id="S4.SS2.p3.1.m1.2.2.2.4" xref="S4.SS2.p3.1.m1.2.2.2.3.cmml"><mi id="S4.SS2.p3.1.m1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.1.m1.2.2.2.4.1" xref="S4.SS2.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.1.m1.2.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.cmml">L</mi></mrow></msub><mo id="S4.SS2.p3.1.m1.6.6.2.2.4" xref="S4.SS2.p3.1.m1.6.6.2.3.cmml">,</mo><msub id="S4.SS2.p3.1.m1.6.6.2.2.2" xref="S4.SS2.p3.1.m1.6.6.2.2.2.cmml"><mi id="S4.SS2.p3.1.m1.6.6.2.2.2.2" xref="S4.SS2.p3.1.m1.6.6.2.2.2.2.cmml">𝐡</mi><mrow id="S4.SS2.p3.1.m1.4.4.2.4" xref="S4.SS2.p3.1.m1.4.4.2.3.cmml"><mi id="S4.SS2.p3.1.m1.3.3.1.1" xref="S4.SS2.p3.1.m1.3.3.1.1.cmml">i</mi><mo id="S4.SS2.p3.1.m1.4.4.2.4.1" xref="S4.SS2.p3.1.m1.4.4.2.3.cmml">,</mo><mn id="S4.SS2.p3.1.m1.4.4.2.2" xref="S4.SS2.p3.1.m1.4.4.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.SS2.p3.1.m1.6.6.2.2.5" xref="S4.SS2.p3.1.m1.6.6.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.6b"><apply id="S4.SS2.p3.1.m1.6.6.cmml" xref="S4.SS2.p3.1.m1.6.6"><times id="S4.SS2.p3.1.m1.6.6.3.cmml" xref="S4.SS2.p3.1.m1.6.6.3"></times><ci id="S4.SS2.p3.1.m1.6.6.4.cmml" xref="S4.SS2.p3.1.m1.6.6.4">𝐶</ci><ci id="S4.SS2.p3.1.m1.6.6.5.cmml" xref="S4.SS2.p3.1.m1.6.6.5">𝑜</ci><ci id="S4.SS2.p3.1.m1.6.6.6.cmml" xref="S4.SS2.p3.1.m1.6.6.6">𝑠</ci><interval closure="open" id="S4.SS2.p3.1.m1.6.6.2.3.cmml" xref="S4.SS2.p3.1.m1.6.6.2.2"><apply id="S4.SS2.p3.1.m1.5.5.1.1.1.cmml" xref="S4.SS2.p3.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.5.5.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.5.5.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.5.5.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.5.5.1.1.1.2">𝐡</ci><list id="S4.SS2.p3.1.m1.2.2.2.3.cmml" xref="S4.SS2.p3.1.m1.2.2.2.4"><ci id="S4.SS2.p3.1.m1.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.1.m1.2.2.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2.2.2">𝐿</ci></list></apply><apply id="S4.SS2.p3.1.m1.6.6.2.2.2.cmml" xref="S4.SS2.p3.1.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.6.6.2.2.2.1.cmml" xref="S4.SS2.p3.1.m1.6.6.2.2.2">subscript</csymbol><ci id="S4.SS2.p3.1.m1.6.6.2.2.2.2.cmml" xref="S4.SS2.p3.1.m1.6.6.2.2.2.2">𝐡</ci><list id="S4.SS2.p3.1.m1.4.4.2.3.cmml" xref="S4.SS2.p3.1.m1.4.4.2.4"><ci id="S4.SS2.p3.1.m1.3.3.1.1.cmml" xref="S4.SS2.p3.1.m1.3.3.1.1">𝑖</ci><cn type="integer" id="S4.SS2.p3.1.m1.4.4.2.2.cmml" xref="S4.SS2.p3.1.m1.4.4.2.2">1</cn></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.6c">Cos(\mathbf{h}_{i,L},\mathbf{h}_{i,1})</annotation></semantics></math> represents the cosine similarity between two vectors <cite class="ltx_cite ltx_citemacro_cite">Dehak et al. (<a href="#bib.bib13" title="" class="ltx_ref">2010</a>)</cite>. Then, we calculate the eigenvalues of the kernel matrix <math id="S4.SS2.p3.2.m2.6" class="ltx_math_unparsed" alttext="\Lambda_{i}=\{\lambda_{i,1},\lambda_{i,2},..,\lambda_{i,L}\}" display="inline"><semantics id="S4.SS2.p3.2.m2.6a"><mrow id="S4.SS2.p3.2.m2.6b"><msub id="S4.SS2.p3.2.m2.6.7"><mi mathvariant="normal" id="S4.SS2.p3.2.m2.6.7.2">Λ</mi><mi id="S4.SS2.p3.2.m2.6.7.3">i</mi></msub><mo id="S4.SS2.p3.2.m2.6.8">=</mo><mrow id="S4.SS2.p3.2.m2.6.9"><mo stretchy="false" id="S4.SS2.p3.2.m2.6.9.1">{</mo><msub id="S4.SS2.p3.2.m2.6.9.2"><mi id="S4.SS2.p3.2.m2.6.9.2.2">λ</mi><mrow id="S4.SS2.p3.2.m2.2.2.2.4"><mi id="S4.SS2.p3.2.m2.1.1.1.1">i</mi><mo id="S4.SS2.p3.2.m2.2.2.2.4.1">,</mo><mn id="S4.SS2.p3.2.m2.2.2.2.2">1</mn></mrow></msub><mo id="S4.SS2.p3.2.m2.6.9.3">,</mo><msub id="S4.SS2.p3.2.m2.6.9.4"><mi id="S4.SS2.p3.2.m2.6.9.4.2">λ</mi><mrow id="S4.SS2.p3.2.m2.4.4.2.4"><mi id="S4.SS2.p3.2.m2.3.3.1.1">i</mi><mo id="S4.SS2.p3.2.m2.4.4.2.4.1">,</mo><mn id="S4.SS2.p3.2.m2.4.4.2.2">2</mn></mrow></msub><mo id="S4.SS2.p3.2.m2.6.9.5">,</mo><mo lspace="0em" rspace="0.0835em" id="S4.SS2.p3.2.m2.6.9.6">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S4.SS2.p3.2.m2.6.9.7">.</mo><mo id="S4.SS2.p3.2.m2.6.9.8">,</mo><msub id="S4.SS2.p3.2.m2.6.9.9"><mi id="S4.SS2.p3.2.m2.6.9.9.2">λ</mi><mrow id="S4.SS2.p3.2.m2.6.6.2.4"><mi id="S4.SS2.p3.2.m2.5.5.1.1">i</mi><mo id="S4.SS2.p3.2.m2.6.6.2.4.1">,</mo><mi id="S4.SS2.p3.2.m2.6.6.2.2">L</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p3.2.m2.6.9.10">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.6c">\Lambda_{i}=\{\lambda_{i,1},\lambda_{i,2},..,\lambda_{i,L}\}</annotation></semantics></math>, with <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\lambda_{l}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msub id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">λ</mi><mi id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝜆</ci><ci id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\lambda_{l}</annotation></semantics></math> representing the distinction of Layer <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mi id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><ci id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">l</annotation></semantics></math> compared with other layers based on Sample <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="s_{i}" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><msub id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">s</mi><mi id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2">𝑠</ci><ci id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">s_{i}</annotation></semantics></math>. Afterward, we compute the score (<math id="S4.SS2.p3.6.m6.2" class="ltx_Math" alttext="\zeta_{i,l}" display="inline"><semantics id="S4.SS2.p3.6.m6.2a"><msub id="S4.SS2.p3.6.m6.2.3" xref="S4.SS2.p3.6.m6.2.3.cmml"><mi id="S4.SS2.p3.6.m6.2.3.2" xref="S4.SS2.p3.6.m6.2.3.2.cmml">ζ</mi><mrow id="S4.SS2.p3.6.m6.2.2.2.4" xref="S4.SS2.p3.6.m6.2.2.2.3.cmml"><mi id="S4.SS2.p3.6.m6.1.1.1.1" xref="S4.SS2.p3.6.m6.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.6.m6.2.2.2.4.1" xref="S4.SS2.p3.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.6.m6.2.2.2.2" xref="S4.SS2.p3.6.m6.2.2.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.2b"><apply id="S4.SS2.p3.6.m6.2.3.cmml" xref="S4.SS2.p3.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.3.1.cmml" xref="S4.SS2.p3.6.m6.2.3">subscript</csymbol><ci id="S4.SS2.p3.6.m6.2.3.2.cmml" xref="S4.SS2.p3.6.m6.2.3.2">𝜁</ci><list id="S4.SS2.p3.6.m6.2.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.2.4"><ci id="S4.SS2.p3.6.m6.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.6.m6.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.2c">\zeta_{i,l}</annotation></semantics></math>) of Layer <math id="S4.SS2.p3.7.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS2.p3.7.m7.1a"><mi id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><ci id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">l</annotation></semantics></math> with the local dataset on Device <math id="S4.SS2.p3.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p3.8.m8.1a"><mi id="S4.SS2.p3.8.m8.1.1" xref="S4.SS2.p3.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m8.1b"><ci id="S4.SS2.p3.8.m8.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m8.1c">i</annotation></semantics></math> using the Formula <a href="#S4.E3" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, which can avoid the possibility of unacceptable performance penalty due to abnormal eigenvalues <cite class="ltx_cite ltx_citemacro_cite">Gao et al. (<a href="#bib.bib20" title="" class="ltx_ref">2021b</a>)</cite>.</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.7" class="ltx_Math" alttext="\zeta_{i,l}=\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}log(\lambda_{j,l}+\epsilon)+(\lambda_{j,l}+\epsilon)^{-1}," display="block"><semantics id="S4.E3.m1.7a"><mrow id="S4.E3.m1.7.7.1" xref="S4.E3.m1.7.7.1.1.cmml"><mrow id="S4.E3.m1.7.7.1.1" xref="S4.E3.m1.7.7.1.1.cmml"><msub id="S4.E3.m1.7.7.1.1.4" xref="S4.E3.m1.7.7.1.1.4.cmml"><mi id="S4.E3.m1.7.7.1.1.4.2" xref="S4.E3.m1.7.7.1.1.4.2.cmml">ζ</mi><mrow id="S4.E3.m1.2.2.2.4" xref="S4.E3.m1.2.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">i</mi><mo id="S4.E3.m1.2.2.2.4.1" xref="S4.E3.m1.2.2.2.3.cmml">,</mo><mi id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml">l</mi></mrow></msub><mo id="S4.E3.m1.7.7.1.1.3" xref="S4.E3.m1.7.7.1.1.3.cmml">=</mo><mrow id="S4.E3.m1.7.7.1.1.2" xref="S4.E3.m1.7.7.1.1.2.cmml"><mrow id="S4.E3.m1.7.7.1.1.1.1" xref="S4.E3.m1.7.7.1.1.1.1.cmml"><mfrac id="S4.E3.m1.7.7.1.1.1.1.3" xref="S4.E3.m1.7.7.1.1.1.1.3.cmml"><mn id="S4.E3.m1.7.7.1.1.1.1.3.2" xref="S4.E3.m1.7.7.1.1.1.1.3.2.cmml">1</mn><msub id="S4.E3.m1.7.7.1.1.1.1.3.3" xref="S4.E3.m1.7.7.1.1.1.1.3.3.cmml"><mi id="S4.E3.m1.7.7.1.1.1.1.3.3.2" xref="S4.E3.m1.7.7.1.1.1.1.3.3.2.cmml">n</mi><mi id="S4.E3.m1.7.7.1.1.1.1.3.3.3" xref="S4.E3.m1.7.7.1.1.1.1.3.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.E3.m1.7.7.1.1.1.1.2" xref="S4.E3.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.7.7.1.1.1.1.1" xref="S4.E3.m1.7.7.1.1.1.1.1.cmml"><munderover id="S4.E3.m1.7.7.1.1.1.1.1.2" xref="S4.E3.m1.7.7.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E3.m1.7.7.1.1.1.1.1.2.2.2" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E3.m1.7.7.1.1.1.1.1.2.2.3" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.2" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.1" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.3" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S4.E3.m1.7.7.1.1.1.1.1.2.3" xref="S4.E3.m1.7.7.1.1.1.1.1.2.3.cmml"><mi id="S4.E3.m1.7.7.1.1.1.1.1.2.3.2" xref="S4.E3.m1.7.7.1.1.1.1.1.2.3.2.cmml">n</mi><mi id="S4.E3.m1.7.7.1.1.1.1.1.2.3.3" xref="S4.E3.m1.7.7.1.1.1.1.1.2.3.3.cmml">i</mi></msub></munderover><mrow id="S4.E3.m1.7.7.1.1.1.1.1.1" xref="S4.E3.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.7.7.1.1.1.1.1.1.3" xref="S4.E3.m1.7.7.1.1.1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.7.7.1.1.1.1.1.1.2" xref="S4.E3.m1.7.7.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E3.m1.7.7.1.1.1.1.1.1.4" xref="S4.E3.m1.7.7.1.1.1.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.7.7.1.1.1.1.1.1.2a" xref="S4.E3.m1.7.7.1.1.1.1.1.1.2.cmml">​</mo><mi id="S4.E3.m1.7.7.1.1.1.1.1.1.5" xref="S4.E3.m1.7.7.1.1.1.1.1.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.7.7.1.1.1.1.1.1.2b" xref="S4.E3.m1.7.7.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml">λ</mi><mrow id="S4.E3.m1.4.4.2.4" xref="S4.E3.m1.4.4.2.3.cmml"><mi id="S4.E3.m1.3.3.1.1" xref="S4.E3.m1.3.3.1.1.cmml">j</mi><mo id="S4.E3.m1.4.4.2.4.1" xref="S4.E3.m1.4.4.2.3.cmml">,</mo><mi id="S4.E3.m1.4.4.2.2" xref="S4.E3.m1.4.4.2.2.cmml">l</mi></mrow></msub><mo id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo stretchy="false" id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E3.m1.7.7.1.1.2.3" xref="S4.E3.m1.7.7.1.1.2.3.cmml">+</mo><msup id="S4.E3.m1.7.7.1.1.2.2" xref="S4.E3.m1.7.7.1.1.2.2.cmml"><mrow id="S4.E3.m1.7.7.1.1.2.2.1.1" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.7.7.1.1.2.2.1.1.2" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.7.7.1.1.2.2.1.1.1" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.cmml"><msub id="S4.E3.m1.7.7.1.1.2.2.1.1.1.2" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.2.cmml"><mi id="S4.E3.m1.7.7.1.1.2.2.1.1.1.2.2" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.2.2.cmml">λ</mi><mrow id="S4.E3.m1.6.6.2.4" xref="S4.E3.m1.6.6.2.3.cmml"><mi id="S4.E3.m1.5.5.1.1" xref="S4.E3.m1.5.5.1.1.cmml">j</mi><mo id="S4.E3.m1.6.6.2.4.1" xref="S4.E3.m1.6.6.2.3.cmml">,</mo><mi id="S4.E3.m1.6.6.2.2" xref="S4.E3.m1.6.6.2.2.cmml">l</mi></mrow></msub><mo id="S4.E3.m1.7.7.1.1.2.2.1.1.1.1" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.1.cmml">+</mo><mi id="S4.E3.m1.7.7.1.1.2.2.1.1.1.3" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.3.cmml">ϵ</mi></mrow><mo stretchy="false" id="S4.E3.m1.7.7.1.1.2.2.1.1.3" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.cmml">)</mo></mrow><mrow id="S4.E3.m1.7.7.1.1.2.2.3" xref="S4.E3.m1.7.7.1.1.2.2.3.cmml"><mo id="S4.E3.m1.7.7.1.1.2.2.3a" xref="S4.E3.m1.7.7.1.1.2.2.3.cmml">−</mo><mn id="S4.E3.m1.7.7.1.1.2.2.3.2" xref="S4.E3.m1.7.7.1.1.2.2.3.2.cmml">1</mn></mrow></msup></mrow></mrow><mo id="S4.E3.m1.7.7.1.2" xref="S4.E3.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.7b"><apply id="S4.E3.m1.7.7.1.1.cmml" xref="S4.E3.m1.7.7.1"><eq id="S4.E3.m1.7.7.1.1.3.cmml" xref="S4.E3.m1.7.7.1.1.3"></eq><apply id="S4.E3.m1.7.7.1.1.4.cmml" xref="S4.E3.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.1.1.4.1.cmml" xref="S4.E3.m1.7.7.1.1.4">subscript</csymbol><ci id="S4.E3.m1.7.7.1.1.4.2.cmml" xref="S4.E3.m1.7.7.1.1.4.2">𝜁</ci><list id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.4"><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝑖</ci><ci id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2">𝑙</ci></list></apply><apply id="S4.E3.m1.7.7.1.1.2.cmml" xref="S4.E3.m1.7.7.1.1.2"><plus id="S4.E3.m1.7.7.1.1.2.3.cmml" xref="S4.E3.m1.7.7.1.1.2.3"></plus><apply id="S4.E3.m1.7.7.1.1.1.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1"><times id="S4.E3.m1.7.7.1.1.1.1.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.2"></times><apply id="S4.E3.m1.7.7.1.1.1.1.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.3"><divide id="S4.E3.m1.7.7.1.1.1.1.3.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.3"></divide><cn type="integer" id="S4.E3.m1.7.7.1.1.1.1.3.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.3.2">1</cn><apply id="S4.E3.m1.7.7.1.1.1.1.3.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E3.m1.7.7.1.1.1.1.3.3.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.3.3.2">𝑛</ci><ci id="S4.E3.m1.7.7.1.1.1.1.3.3.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S4.E3.m1.7.7.1.1.1.1.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1"><apply id="S4.E3.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m1.7.7.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E3.m1.7.7.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.2"></sum><apply id="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.3"><eq id="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E3.m1.7.7.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.1.1.1.1.1.2.3.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E3.m1.7.7.1.1.1.1.1.2.3.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S4.E3.m1.7.7.1.1.1.1.1.2.3.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.E3.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1"><times id="S4.E3.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.2"></times><ci id="S4.E3.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.3">𝑙</ci><ci id="S4.E3.m1.7.7.1.1.1.1.1.1.4.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.4">𝑜</ci><ci id="S4.E3.m1.7.7.1.1.1.1.1.1.5.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.5">𝑔</ci><apply id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1"><plus id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.2.2">𝜆</ci><list id="S4.E3.m1.4.4.2.3.cmml" xref="S4.E3.m1.4.4.2.4"><ci id="S4.E3.m1.3.3.1.1.cmml" xref="S4.E3.m1.3.3.1.1">𝑗</ci><ci id="S4.E3.m1.4.4.2.2.cmml" xref="S4.E3.m1.4.4.2.2">𝑙</ci></list></apply><ci id="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.7.7.1.1.1.1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply></apply></apply><apply id="S4.E3.m1.7.7.1.1.2.2.cmml" xref="S4.E3.m1.7.7.1.1.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.1.1.2.2.2.cmml" xref="S4.E3.m1.7.7.1.1.2.2">superscript</csymbol><apply id="S4.E3.m1.7.7.1.1.2.2.1.1.1.cmml" xref="S4.E3.m1.7.7.1.1.2.2.1.1"><plus id="S4.E3.m1.7.7.1.1.2.2.1.1.1.1.cmml" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.1"></plus><apply id="S4.E3.m1.7.7.1.1.2.2.1.1.1.2.cmml" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.7.7.1.1.2.2.1.1.1.2.2.cmml" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.2.2">𝜆</ci><list id="S4.E3.m1.6.6.2.3.cmml" xref="S4.E3.m1.6.6.2.4"><ci id="S4.E3.m1.5.5.1.1.cmml" xref="S4.E3.m1.5.5.1.1">𝑗</ci><ci id="S4.E3.m1.6.6.2.2.cmml" xref="S4.E3.m1.6.6.2.2">𝑙</ci></list></apply><ci id="S4.E3.m1.7.7.1.1.2.2.1.1.1.3.cmml" xref="S4.E3.m1.7.7.1.1.2.2.1.1.1.3">italic-ϵ</ci></apply><apply id="S4.E3.m1.7.7.1.1.2.2.3.cmml" xref="S4.E3.m1.7.7.1.1.2.2.3"><minus id="S4.E3.m1.7.7.1.1.2.2.3.1.cmml" xref="S4.E3.m1.7.7.1.1.2.2.3"></minus><cn type="integer" id="S4.E3.m1.7.7.1.1.2.2.3.2.cmml" xref="S4.E3.m1.7.7.1.1.2.2.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.7c">\zeta_{i,l}=\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}log(\lambda_{j,l}+\epsilon)+(\lambda_{j,l}+\epsilon)^{-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.11" class="ltx_p">where <math id="S4.SS2.p3.9.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS2.p3.9.m1.1a"><mi id="S4.SS2.p3.9.m1.1.1" xref="S4.SS2.p3.9.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m1.1b"><ci id="S4.SS2.p3.9.m1.1.1.cmml" xref="S4.SS2.p3.9.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m1.1c">\epsilon</annotation></semantics></math> refers to a small positive value, e.g., <math id="S4.SS2.p3.10.m2.1" class="ltx_Math" alttext="1*e^{-5}" display="inline"><semantics id="S4.SS2.p3.10.m2.1a"><mrow id="S4.SS2.p3.10.m2.1.1" xref="S4.SS2.p3.10.m2.1.1.cmml"><mn id="S4.SS2.p3.10.m2.1.1.2" xref="S4.SS2.p3.10.m2.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p3.10.m2.1.1.1" xref="S4.SS2.p3.10.m2.1.1.1.cmml">∗</mo><msup id="S4.SS2.p3.10.m2.1.1.3" xref="S4.SS2.p3.10.m2.1.1.3.cmml"><mi id="S4.SS2.p3.10.m2.1.1.3.2" xref="S4.SS2.p3.10.m2.1.1.3.2.cmml">e</mi><mrow id="S4.SS2.p3.10.m2.1.1.3.3" xref="S4.SS2.p3.10.m2.1.1.3.3.cmml"><mo id="S4.SS2.p3.10.m2.1.1.3.3a" xref="S4.SS2.p3.10.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS2.p3.10.m2.1.1.3.3.2" xref="S4.SS2.p3.10.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m2.1b"><apply id="S4.SS2.p3.10.m2.1.1.cmml" xref="S4.SS2.p3.10.m2.1.1"><times id="S4.SS2.p3.10.m2.1.1.1.cmml" xref="S4.SS2.p3.10.m2.1.1.1"></times><cn type="integer" id="S4.SS2.p3.10.m2.1.1.2.cmml" xref="S4.SS2.p3.10.m2.1.1.2">1</cn><apply id="S4.SS2.p3.10.m2.1.1.3.cmml" xref="S4.SS2.p3.10.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.10.m2.1.1.3.1.cmml" xref="S4.SS2.p3.10.m2.1.1.3">superscript</csymbol><ci id="S4.SS2.p3.10.m2.1.1.3.2.cmml" xref="S4.SS2.p3.10.m2.1.1.3.2">𝑒</ci><apply id="S4.SS2.p3.10.m2.1.1.3.3.cmml" xref="S4.SS2.p3.10.m2.1.1.3.3"><minus id="S4.SS2.p3.10.m2.1.1.3.3.1.cmml" xref="S4.SS2.p3.10.m2.1.1.3.3"></minus><cn type="integer" id="S4.SS2.p3.10.m2.1.1.3.3.2.cmml" xref="S4.SS2.p3.10.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m2.1c">1*e^{-5}</annotation></semantics></math>.
We calculate the global score of each layer leveraging Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> with <math id="S4.SS2.p3.11.m3.2" class="ltx_Math" alttext="\gamma_{i}=\zeta_{i,l}" display="inline"><semantics id="S4.SS2.p3.11.m3.2a"><mrow id="S4.SS2.p3.11.m3.2.3" xref="S4.SS2.p3.11.m3.2.3.cmml"><msub id="S4.SS2.p3.11.m3.2.3.2" xref="S4.SS2.p3.11.m3.2.3.2.cmml"><mi id="S4.SS2.p3.11.m3.2.3.2.2" xref="S4.SS2.p3.11.m3.2.3.2.2.cmml">γ</mi><mi id="S4.SS2.p3.11.m3.2.3.2.3" xref="S4.SS2.p3.11.m3.2.3.2.3.cmml">i</mi></msub><mo id="S4.SS2.p3.11.m3.2.3.1" xref="S4.SS2.p3.11.m3.2.3.1.cmml">=</mo><msub id="S4.SS2.p3.11.m3.2.3.3" xref="S4.SS2.p3.11.m3.2.3.3.cmml"><mi id="S4.SS2.p3.11.m3.2.3.3.2" xref="S4.SS2.p3.11.m3.2.3.3.2.cmml">ζ</mi><mrow id="S4.SS2.p3.11.m3.2.2.2.4" xref="S4.SS2.p3.11.m3.2.2.2.3.cmml"><mi id="S4.SS2.p3.11.m3.1.1.1.1" xref="S4.SS2.p3.11.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p3.11.m3.2.2.2.4.1" xref="S4.SS2.p3.11.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p3.11.m3.2.2.2.2" xref="S4.SS2.p3.11.m3.2.2.2.2.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.11.m3.2b"><apply id="S4.SS2.p3.11.m3.2.3.cmml" xref="S4.SS2.p3.11.m3.2.3"><eq id="S4.SS2.p3.11.m3.2.3.1.cmml" xref="S4.SS2.p3.11.m3.2.3.1"></eq><apply id="S4.SS2.p3.11.m3.2.3.2.cmml" xref="S4.SS2.p3.11.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.11.m3.2.3.2.1.cmml" xref="S4.SS2.p3.11.m3.2.3.2">subscript</csymbol><ci id="S4.SS2.p3.11.m3.2.3.2.2.cmml" xref="S4.SS2.p3.11.m3.2.3.2.2">𝛾</ci><ci id="S4.SS2.p3.11.m3.2.3.2.3.cmml" xref="S4.SS2.p3.11.m3.2.3.2.3">𝑖</ci></apply><apply id="S4.SS2.p3.11.m3.2.3.3.cmml" xref="S4.SS2.p3.11.m3.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.11.m3.2.3.3.1.cmml" xref="S4.SS2.p3.11.m3.2.3.3">subscript</csymbol><ci id="S4.SS2.p3.11.m3.2.3.3.2.cmml" xref="S4.SS2.p3.11.m3.2.3.3.2">𝜁</ci><list id="S4.SS2.p3.11.m3.2.2.2.3.cmml" xref="S4.SS2.p3.11.m3.2.2.2.4"><ci id="S4.SS2.p3.11.m3.1.1.1.1.cmml" xref="S4.SS2.p3.11.m3.1.1.1.1">𝑖</ci><ci id="S4.SS2.p3.11.m3.2.2.2.2.cmml" xref="S4.SS2.p3.11.m3.2.2.2.2">𝑙</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.11.m3.2c">\gamma_{i}=\zeta_{i,l}</annotation></semantics></math>.</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\gamma=\sum_{i=1}^{N}\frac{n_{i}}{N}\gamma_{i}," display="block"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml">γ</mi><mo rspace="0.111em" id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml"><munderover id="S4.E4.m1.1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E4.m1.1.1.1.1.3.1.2.2" xref="S4.E4.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E4.m1.1.1.1.1.3.1.2.3" xref="S4.E4.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.3.1.2.3.2" xref="S4.E4.m1.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E4.m1.1.1.1.1.3.1.2.3.1" xref="S4.E4.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E4.m1.1.1.1.1.3.1.2.3.3" xref="S4.E4.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E4.m1.1.1.1.1.3.1.3" xref="S4.E4.m1.1.1.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S4.E4.m1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.3.2.cmml"><mfrac id="S4.E4.m1.1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.3.2.2.cmml"><msub id="S4.E4.m1.1.1.1.1.3.2.2.2" xref="S4.E4.m1.1.1.1.1.3.2.2.2.cmml"><mi id="S4.E4.m1.1.1.1.1.3.2.2.2.2" xref="S4.E4.m1.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S4.E4.m1.1.1.1.1.3.2.2.2.3" xref="S4.E4.m1.1.1.1.1.3.2.2.2.3.cmml">i</mi></msub><mi id="S4.E4.m1.1.1.1.1.3.2.2.3" xref="S4.E4.m1.1.1.1.1.3.2.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.3.2.1" xref="S4.E4.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S4.E4.m1.1.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.1.3.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.3.2.3.2" xref="S4.E4.m1.1.1.1.1.3.2.3.2.cmml">γ</mi><mi id="S4.E4.m1.1.1.1.1.3.2.3.3" xref="S4.E4.m1.1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"></eq><ci id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2">𝛾</ci><apply id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"><apply id="S4.E4.m1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.1.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.3.1.2.cmml" xref="S4.E4.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S4.E4.m1.1.1.1.1.3.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.2"></sum><apply id="S4.E4.m1.1.1.1.1.3.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.3"><eq id="S4.E4.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S4.E4.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E4.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E4.m1.1.1.1.1.3.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3.1.3">𝑁</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2"><times id="S4.E4.m1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.1"></times><apply id="S4.E4.m1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2"><divide id="S4.E4.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2"></divide><apply id="S4.E4.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S4.E4.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.2.3">𝑖</ci></apply><ci id="S4.E4.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2.3">𝑁</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3.2">𝛾</ci><ci id="S4.E4.m1.1.1.1.1.3.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\gamma=\sum_{i=1}^{N}\frac{n_{i}}{N}\gamma_{i},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.12" class="ltx_p">where <math id="S4.SS2.p3.12.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p3.12.m1.1a"><mi id="S4.SS2.p3.12.m1.1.1" xref="S4.SS2.p3.12.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.12.m1.1b"><ci id="S4.SS2.p3.12.m1.1.1.cmml" xref="S4.SS2.p3.12.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.12.m1.1c">\gamma</annotation></semantics></math> represents the variable.</p>
</div>
<figure id="S4.SS2.fig1" class="ltx_figure">
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated Parameter-efficient Prompt Tuning</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>   <math id="alg1.l0.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">L</annotation></semantics></math>: The list of layers in a large language model<math id="alg1.l0.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">M</annotation></semantics></math>: The set of devices<math id="alg1.l0.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">w</annotation></semantics></math>: The prompt parameters of the initial model<math id="alg1.l0.m4.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg1.l0.m4.1a"><msup id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml"><mi id="alg1.l0.m4.1.1.2" xref="alg1.l0.m4.1.1.2.cmml">w</mi><mi id="alg1.l0.m4.1.1.3" xref="alg1.l0.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><apply id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1"><csymbol cd="ambiguous" id="alg1.l0.m4.1.1.1.cmml" xref="alg1.l0.m4.1.1">superscript</csymbol><ci id="alg1.l0.m4.1.1.2.cmml" xref="alg1.l0.m4.1.1.2">𝑤</ci><ci id="alg1.l0.m4.1.1.3.cmml" xref="alg1.l0.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">w^{t}</annotation></semantics></math>: The prompt parameters of the current model in Round <math id="alg1.l0.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">t</annotation></semantics></math>
</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>   <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="SL" display="inline"><semantics id="alg1.l0a.m1.1a"><mrow id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml"><mi id="alg1.l0a.m1.1.1.2" xref="alg1.l0a.m1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l0a.m1.1.1.1" xref="alg1.l0a.m1.1.1.1.cmml">​</mo><mi id="alg1.l0a.m1.1.1.3" xref="alg1.l0a.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1"><times id="alg1.l0a.m1.1.1.1.cmml" xref="alg1.l0a.m1.1.1.1"></times><ci id="alg1.l0a.m1.1.1.2.cmml" xref="alg1.l0a.m1.1.1.2">𝑆</ci><ci id="alg1.l0a.m1.1.1.3.cmml" xref="alg1.l0a.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">SL</annotation></semantics></math>: The set of selected layers

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math id="alg1.l1.m1.1" class="ltx_Math" alttext="SL\leftarrow\emptyset" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mrow id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml"><mi id="alg1.l1.m1.1.1.2.2" xref="alg1.l1.m1.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.2.1" xref="alg1.l1.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">L</mi></mrow><mo stretchy="false" id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">←</mo><mi mathvariant="normal" id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">←</ci><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2"><times id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.2.1"></times><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝑆</ci><ci id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">𝐿</ci></apply><emptyset id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">SL\leftarrow\emptyset</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.1" class="ltx_Math" alttext="i\in M" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">i</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">∈</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><in id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></in><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑖</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">i\in M</annotation></semantics></math> (on each device) <span id="alg1.l2.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\Delta_{i}\leftarrow w-w^{t}" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msub id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi mathvariant="normal" id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">Δ</mi><mi id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">←</mo><mrow id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">w</mi><mo id="alg1.l3.m1.1.1.3.1" xref="alg1.l3.m1.1.1.3.1.cmml">−</mo><msup id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml"><mi id="alg1.l3.m1.1.1.3.3.2" xref="alg1.l3.m1.1.1.3.3.2.cmml">w</mi><mi id="alg1.l3.m1.1.1.3.3.3" xref="alg1.l3.m1.1.1.3.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">Δ</ci><ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><minus id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3.1"></minus><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝑤</ci><apply id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.3.1.cmml" xref="alg1.l3.m1.1.1.3.3">superscript</csymbol><ci id="alg1.l3.m1.1.1.3.3.2.cmml" xref="alg1.l3.m1.1.1.3.3.2">𝑤</ci><ci id="alg1.l3.m1.1.1.3.3.3.cmml" xref="alg1.l3.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\Delta_{i}\leftarrow w-w^{t}</annotation></semantics></math> 

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <math id="alg1.l4.m1.1" class="ltx_Math" alttext="H(w^{t}_{i})\leftarrow" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.3" xref="alg1.l4.m1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l4.m1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l4.m1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.2.2" xref="alg1.l4.m1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l4.m1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg1.l4.m1.1.1.1.1.1.1.2.3" xref="alg1.l4.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l4.m1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">←</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">←</ci><apply id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"><times id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.2"></times><ci id="alg1.l4.m1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.3">𝐻</ci><apply id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><csymbol cd="latexml" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">H(w^{t}_{i})\leftarrow</annotation></semantics></math> Get Hessian matrix of <math id="alg1.l4.m2.1" class="ltx_Math" alttext="w^{t}_{i}" display="inline"><semantics id="alg1.l4.m2.1a"><msubsup id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.2.2" xref="alg1.l4.m2.1.1.2.2.cmml">w</mi><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">i</mi><mi id="alg1.l4.m2.1.1.2.3" xref="alg1.l4.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1">subscript</csymbol><apply id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.2.1.cmml" xref="alg1.l4.m2.1.1">superscript</csymbol><ci id="alg1.l4.m2.1.1.2.2.cmml" xref="alg1.l4.m2.1.1.2.2">𝑤</ci><ci id="alg1.l4.m2.1.1.2.3.cmml" xref="alg1.l4.m2.1.1.2.3">𝑡</ci></apply><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">w^{t}_{i}</annotation></semantics></math> 

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\Lambda^{H(w^{t}_{i})}\leftarrow" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><msup id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml"><mi mathvariant="normal" id="alg1.l5.m1.1.2.2.2" xref="alg1.l5.m1.1.2.2.2.cmml">Λ</mi><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l5.m1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.2.3" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l5.m1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo stretchy="false" id="alg1.l5.m1.1.2.1" xref="alg1.l5.m1.1.2.1.cmml">←</mo><mi id="alg1.l5.m1.1.2.3" xref="alg1.l5.m1.1.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><ci id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1">←</ci><apply id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.2.2.1.cmml" xref="alg1.l5.m1.1.2.2">superscript</csymbol><ci id="alg1.l5.m1.1.2.2.2.cmml" xref="alg1.l5.m1.1.2.2.2">Λ</ci><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">𝐻</ci><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><csymbol cd="latexml" id="alg1.l5.m1.1.2.3.cmml" xref="alg1.l5.m1.1.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\Lambda^{H(w^{t}_{i})}\leftarrow</annotation></semantics></math> Eigenvalues(<math id="alg1.l5.m2.1" class="ltx_Math" alttext="H(w^{t}_{i})" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">​</mo><mrow id="alg1.l5.m2.1.1.1.1" xref="alg1.l5.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l5.m2.1.1.1.1.2" xref="alg1.l5.m2.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l5.m2.1.1.1.1.1" xref="alg1.l5.m2.1.1.1.1.1.cmml"><mi id="alg1.l5.m2.1.1.1.1.1.2.2" xref="alg1.l5.m2.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l5.m2.1.1.1.1.1.3" xref="alg1.l5.m2.1.1.1.1.1.3.cmml">i</mi><mi id="alg1.l5.m2.1.1.1.1.1.2.3" xref="alg1.l5.m2.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l5.m2.1.1.1.1.3" xref="alg1.l5.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><times id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"></times><ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">𝐻</ci><apply id="alg1.l5.m2.1.1.1.1.1.cmml" xref="alg1.l5.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.1.1.1.cmml" xref="alg1.l5.m2.1.1.1.1">subscript</csymbol><apply id="alg1.l5.m2.1.1.1.1.1.2.cmml" xref="alg1.l5.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l5.m2.1.1.1.1">superscript</csymbol><ci id="alg1.l5.m2.1.1.1.1.1.2.2.cmml" xref="alg1.l5.m2.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l5.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l5.m2.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l5.m2.1.1.1.1.1.3.cmml" xref="alg1.l5.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">H(w^{t}_{i})</annotation></semantics></math>) 

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg1.l6.m1.4" class="ltx_Math" alttext="\{\lambda^{H}_{1},\lambda^{H}_{2},...,\lambda^{H}_{K_{i}}\}\leftarrow" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml"><mrow id="alg1.l6.m1.4.4.3.3" xref="alg1.l6.m1.4.4.3.4.cmml"><mo stretchy="false" id="alg1.l6.m1.4.4.3.3.4" xref="alg1.l6.m1.4.4.3.4.cmml">{</mo><msubsup id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.2.2" xref="alg1.l6.m1.2.2.1.1.1.2.2.cmml">λ</mi><mn id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.3.cmml">1</mn><mi id="alg1.l6.m1.2.2.1.1.1.2.3" xref="alg1.l6.m1.2.2.1.1.1.2.3.cmml">H</mi></msubsup><mo id="alg1.l6.m1.4.4.3.3.5" xref="alg1.l6.m1.4.4.3.4.cmml">,</mo><msubsup id="alg1.l6.m1.3.3.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.cmml"><mi id="alg1.l6.m1.3.3.2.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.2.cmml">λ</mi><mn id="alg1.l6.m1.3.3.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.3.cmml">2</mn><mi id="alg1.l6.m1.3.3.2.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.2.3.cmml">H</mi></msubsup><mo id="alg1.l6.m1.4.4.3.3.6" xref="alg1.l6.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">…</mi><mo id="alg1.l6.m1.4.4.3.3.7" xref="alg1.l6.m1.4.4.3.4.cmml">,</mo><msubsup id="alg1.l6.m1.4.4.3.3.3" xref="alg1.l6.m1.4.4.3.3.3.cmml"><mi id="alg1.l6.m1.4.4.3.3.3.2.2" xref="alg1.l6.m1.4.4.3.3.3.2.2.cmml">λ</mi><msub id="alg1.l6.m1.4.4.3.3.3.3" xref="alg1.l6.m1.4.4.3.3.3.3.cmml"><mi id="alg1.l6.m1.4.4.3.3.3.3.2" xref="alg1.l6.m1.4.4.3.3.3.3.2.cmml">K</mi><mi id="alg1.l6.m1.4.4.3.3.3.3.3" xref="alg1.l6.m1.4.4.3.3.3.3.3.cmml">i</mi></msub><mi id="alg1.l6.m1.4.4.3.3.3.2.3" xref="alg1.l6.m1.4.4.3.3.3.2.3.cmml">H</mi></msubsup><mo stretchy="false" id="alg1.l6.m1.4.4.3.3.8" xref="alg1.l6.m1.4.4.3.4.cmml">}</mo></mrow><mo stretchy="false" id="alg1.l6.m1.4.4.4" xref="alg1.l6.m1.4.4.4.cmml">←</mo><mi id="alg1.l6.m1.4.4.5" xref="alg1.l6.m1.4.4.5.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4"><ci id="alg1.l6.m1.4.4.4.cmml" xref="alg1.l6.m1.4.4.4">←</ci><set id="alg1.l6.m1.4.4.3.4.cmml" xref="alg1.l6.m1.4.4.3.3"><apply id="alg1.l6.m1.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">superscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.2.2">𝜆</ci><ci id="alg1.l6.m1.2.2.1.1.1.2.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.2.3">𝐻</ci></apply><cn type="integer" id="alg1.l6.m1.2.2.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.3">1</cn></apply><apply id="alg1.l6.m1.3.3.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">subscript</csymbol><apply id="alg1.l6.m1.3.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">superscript</csymbol><ci id="alg1.l6.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2">𝜆</ci><ci id="alg1.l6.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.3">𝐻</ci></apply><cn type="integer" id="alg1.l6.m1.3.3.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.3">2</cn></apply><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">…</ci><apply id="alg1.l6.m1.4.4.3.3.3.cmml" xref="alg1.l6.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.3.3.1.cmml" xref="alg1.l6.m1.4.4.3.3.3">subscript</csymbol><apply id="alg1.l6.m1.4.4.3.3.3.2.cmml" xref="alg1.l6.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.3.3.2.1.cmml" xref="alg1.l6.m1.4.4.3.3.3">superscript</csymbol><ci id="alg1.l6.m1.4.4.3.3.3.2.2.cmml" xref="alg1.l6.m1.4.4.3.3.3.2.2">𝜆</ci><ci id="alg1.l6.m1.4.4.3.3.3.2.3.cmml" xref="alg1.l6.m1.4.4.3.3.3.2.3">𝐻</ci></apply><apply id="alg1.l6.m1.4.4.3.3.3.3.cmml" xref="alg1.l6.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.3.3.3.1.cmml" xref="alg1.l6.m1.4.4.3.3.3.3">subscript</csymbol><ci id="alg1.l6.m1.4.4.3.3.3.3.2.cmml" xref="alg1.l6.m1.4.4.3.3.3.3.2">𝐾</ci><ci id="alg1.l6.m1.4.4.3.3.3.3.3.cmml" xref="alg1.l6.m1.4.4.3.3.3.3.3">𝑖</ci></apply></apply></set><csymbol cd="latexml" id="alg1.l6.m1.4.4.5.cmml" xref="alg1.l6.m1.4.4.5">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">\{\lambda^{H}_{1},\lambda^{H}_{2},...,\lambda^{H}_{K_{i}}\}\leftarrow</annotation></semantics></math> Sort in ascending order of <math id="alg1.l6.m2.1" class="ltx_Math" alttext="\Lambda^{H(w^{t}_{i})}" display="inline"><semantics id="alg1.l6.m2.1a"><msup id="alg1.l6.m2.1.2" xref="alg1.l6.m2.1.2.cmml"><mi mathvariant="normal" id="alg1.l6.m2.1.2.2" xref="alg1.l6.m2.1.2.2.cmml">Λ</mi><mrow id="alg1.l6.m2.1.1.1" xref="alg1.l6.m2.1.1.1.cmml"><mi id="alg1.l6.m2.1.1.1.3" xref="alg1.l6.m2.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m2.1.1.1.2" xref="alg1.l6.m2.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m2.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m2.1.1.1.1.1.2" xref="alg1.l6.m2.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l6.m2.1.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m2.1.1.1.1.1.1.2.2" xref="alg1.l6.m2.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l6.m2.1.1.1.1.1.1.3" xref="alg1.l6.m2.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg1.l6.m2.1.1.1.1.1.1.2.3" xref="alg1.l6.m2.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l6.m2.1.1.1.1.1.3" xref="alg1.l6.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.2.cmml" xref="alg1.l6.m2.1.2"><csymbol cd="ambiguous" id="alg1.l6.m2.1.2.1.cmml" xref="alg1.l6.m2.1.2">superscript</csymbol><ci id="alg1.l6.m2.1.2.2.cmml" xref="alg1.l6.m2.1.2.2">Λ</ci><apply id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1.1"><times id="alg1.l6.m2.1.1.1.2.cmml" xref="alg1.l6.m2.1.1.1.2"></times><ci id="alg1.l6.m2.1.1.1.3.cmml" xref="alg1.l6.m2.1.1.1.3">𝐻</ci><apply id="alg1.l6.m2.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1.1">subscript</csymbol><apply id="alg1.l6.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l6.m2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l6.m2.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l6.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\Lambda^{H(w^{t}_{i})}</annotation></semantics></math> 

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math id="alg1.l7.m1.3" class="ltx_Math" alttext="\mathcal{B}(\Delta_{i})\leftarrow H(w^{t}_{i})-\triangledown F_{i}(\Delta_{i}+w^{t}_{i})" display="inline"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.3" xref="alg1.l7.m1.3.3.cmml"><mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3.cmml">ℬ</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l7.m1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.cmml">Δ</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l7.m1.3.3.4" xref="alg1.l7.m1.3.3.4.cmml">←</mo><mrow id="alg1.l7.m1.3.3.3" xref="alg1.l7.m1.3.3.3.cmml"><mrow id="alg1.l7.m1.2.2.2.1" xref="alg1.l7.m1.2.2.2.1.cmml"><mi id="alg1.l7.m1.2.2.2.1.3" xref="alg1.l7.m1.2.2.2.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.2.1.2" xref="alg1.l7.m1.2.2.2.1.2.cmml">​</mo><mrow id="alg1.l7.m1.2.2.2.1.1.1" xref="alg1.l7.m1.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.2.1.1.1.2" xref="alg1.l7.m1.2.2.2.1.1.1.1.cmml">(</mo><msubsup id="alg1.l7.m1.2.2.2.1.1.1.1" xref="alg1.l7.m1.2.2.2.1.1.1.1.cmml"><mi id="alg1.l7.m1.2.2.2.1.1.1.1.2.2" xref="alg1.l7.m1.2.2.2.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l7.m1.2.2.2.1.1.1.1.3" xref="alg1.l7.m1.2.2.2.1.1.1.1.3.cmml">i</mi><mi id="alg1.l7.m1.2.2.2.1.1.1.1.2.3" xref="alg1.l7.m1.2.2.2.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l7.m1.2.2.2.1.1.1.3" xref="alg1.l7.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l7.m1.3.3.3.3" xref="alg1.l7.m1.3.3.3.3.cmml">−</mo><mrow id="alg1.l7.m1.3.3.3.2" xref="alg1.l7.m1.3.3.3.2.cmml"><mi mathvariant="normal" id="alg1.l7.m1.3.3.3.2.3" xref="alg1.l7.m1.3.3.3.2.3.cmml">▽</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.3.3.2.2" xref="alg1.l7.m1.3.3.3.2.2.cmml">​</mo><msub id="alg1.l7.m1.3.3.3.2.4" xref="alg1.l7.m1.3.3.3.2.4.cmml"><mi id="alg1.l7.m1.3.3.3.2.4.2" xref="alg1.l7.m1.3.3.3.2.4.2.cmml">F</mi><mi id="alg1.l7.m1.3.3.3.2.4.3" xref="alg1.l7.m1.3.3.3.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.3.3.2.2a" xref="alg1.l7.m1.3.3.3.2.2.cmml">​</mo><mrow id="alg1.l7.m1.3.3.3.2.1.1" xref="alg1.l7.m1.3.3.3.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.3.2.1.1.2" xref="alg1.l7.m1.3.3.3.2.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.3.3.3.2.1.1.1" xref="alg1.l7.m1.3.3.3.2.1.1.1.cmml"><msub id="alg1.l7.m1.3.3.3.2.1.1.1.2" xref="alg1.l7.m1.3.3.3.2.1.1.1.2.cmml"><mi mathvariant="normal" id="alg1.l7.m1.3.3.3.2.1.1.1.2.2" xref="alg1.l7.m1.3.3.3.2.1.1.1.2.2.cmml">Δ</mi><mi id="alg1.l7.m1.3.3.3.2.1.1.1.2.3" xref="alg1.l7.m1.3.3.3.2.1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l7.m1.3.3.3.2.1.1.1.1" xref="alg1.l7.m1.3.3.3.2.1.1.1.1.cmml">+</mo><msubsup id="alg1.l7.m1.3.3.3.2.1.1.1.3" xref="alg1.l7.m1.3.3.3.2.1.1.1.3.cmml"><mi id="alg1.l7.m1.3.3.3.2.1.1.1.3.2.2" xref="alg1.l7.m1.3.3.3.2.1.1.1.3.2.2.cmml">w</mi><mi id="alg1.l7.m1.3.3.3.2.1.1.1.3.3" xref="alg1.l7.m1.3.3.3.2.1.1.1.3.3.cmml">i</mi><mi id="alg1.l7.m1.3.3.3.2.1.1.1.3.2.3" xref="alg1.l7.m1.3.3.3.2.1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="alg1.l7.m1.3.3.3.2.1.1.3" xref="alg1.l7.m1.3.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.3.cmml" xref="alg1.l7.m1.3.3"><ci id="alg1.l7.m1.3.3.4.cmml" xref="alg1.l7.m1.3.3.4">←</ci><apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"><times id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2"></times><ci id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3">ℬ</ci><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2">Δ</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l7.m1.3.3.3.cmml" xref="alg1.l7.m1.3.3.3"><minus id="alg1.l7.m1.3.3.3.3.cmml" xref="alg1.l7.m1.3.3.3.3"></minus><apply id="alg1.l7.m1.2.2.2.1.cmml" xref="alg1.l7.m1.2.2.2.1"><times id="alg1.l7.m1.2.2.2.1.2.cmml" xref="alg1.l7.m1.2.2.2.1.2"></times><ci id="alg1.l7.m1.2.2.2.1.3.cmml" xref="alg1.l7.m1.2.2.2.1.3">𝐻</ci><apply id="alg1.l7.m1.2.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.1.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.2.1.1.1">subscript</csymbol><apply id="alg1.l7.m1.2.2.2.1.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.2.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.2.2.2.1.1.1">superscript</csymbol><ci id="alg1.l7.m1.2.2.2.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.2.2.2.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l7.m1.2.2.2.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.2.2.2.1.1.1.1.2.3">𝑡</ci></apply><ci id="alg1.l7.m1.2.2.2.1.1.1.1.3.cmml" xref="alg1.l7.m1.2.2.2.1.1.1.1.3">𝑖</ci></apply></apply><apply id="alg1.l7.m1.3.3.3.2.cmml" xref="alg1.l7.m1.3.3.3.2"><times id="alg1.l7.m1.3.3.3.2.2.cmml" xref="alg1.l7.m1.3.3.3.2.2"></times><ci id="alg1.l7.m1.3.3.3.2.3.cmml" xref="alg1.l7.m1.3.3.3.2.3">▽</ci><apply id="alg1.l7.m1.3.3.3.2.4.cmml" xref="alg1.l7.m1.3.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.2.4.1.cmml" xref="alg1.l7.m1.3.3.3.2.4">subscript</csymbol><ci id="alg1.l7.m1.3.3.3.2.4.2.cmml" xref="alg1.l7.m1.3.3.3.2.4.2">𝐹</ci><ci id="alg1.l7.m1.3.3.3.2.4.3.cmml" xref="alg1.l7.m1.3.3.3.2.4.3">𝑖</ci></apply><apply id="alg1.l7.m1.3.3.3.2.1.1.1.cmml" xref="alg1.l7.m1.3.3.3.2.1.1"><plus id="alg1.l7.m1.3.3.3.2.1.1.1.1.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.1"></plus><apply id="alg1.l7.m1.3.3.3.2.1.1.1.2.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.2.1.1.1.2.1.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.3.3.3.2.1.1.1.2.2.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.2.2">Δ</ci><ci id="alg1.l7.m1.3.3.3.2.1.1.1.2.3.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l7.m1.3.3.3.2.1.1.1.3.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.2.1.1.1.3.1.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.3">subscript</csymbol><apply id="alg1.l7.m1.3.3.3.2.1.1.1.3.2.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.3.3.2.1.1.1.3.2.1.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.3">superscript</csymbol><ci id="alg1.l7.m1.3.3.3.2.1.1.1.3.2.2.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.3.2.2">𝑤</ci><ci id="alg1.l7.m1.3.3.3.2.1.1.1.3.2.3.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.3.2.3">𝑡</ci></apply><ci id="alg1.l7.m1.3.3.3.2.1.1.1.3.3.cmml" xref="alg1.l7.m1.3.3.3.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">\mathcal{B}(\Delta_{i})\leftarrow H(w^{t}_{i})-\triangledown F_{i}(\Delta_{i}+w^{t}_{i})</annotation></semantics></math> 

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\mathscr{L}_{i}\leftarrow" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi class="ltx_font_mathscript" id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">ℒ</mi><mi id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mi id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">ℒ</ci><ci id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3">𝑖</ci></apply><csymbol cd="latexml" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\mathscr{L}_{i}\leftarrow</annotation></semantics></math> Get Lipschitz constant of <math id="alg1.l8.m2.1" class="ltx_Math" alttext="\mathcal{B}(\Delta_{i})" display="inline"><semantics id="alg1.l8.m2.1a"><mrow id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">ℬ</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">​</mo><mrow id="alg1.l8.m2.1.1.1.1" xref="alg1.l8.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l8.m2.1.1.1.1.2" xref="alg1.l8.m2.1.1.1.1.1.cmml">(</mo><msub id="alg1.l8.m2.1.1.1.1.1" xref="alg1.l8.m2.1.1.1.1.1.cmml"><mi mathvariant="normal" id="alg1.l8.m2.1.1.1.1.1.2" xref="alg1.l8.m2.1.1.1.1.1.2.cmml">Δ</mi><mi id="alg1.l8.m2.1.1.1.1.1.3" xref="alg1.l8.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l8.m2.1.1.1.1.3" xref="alg1.l8.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1"><times id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2"></times><ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">ℬ</ci><apply id="alg1.l8.m2.1.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.1.1.1.cmml" xref="alg1.l8.m2.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m2.1.1.1.1.1.2.cmml" xref="alg1.l8.m2.1.1.1.1.1.2">Δ</ci><ci id="alg1.l8.m2.1.1.1.1.1.3.cmml" xref="alg1.l8.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\mathcal{B}(\Delta_{i})</annotation></semantics></math> 

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg1.l9.m1.1" class="ltx_Math" alttext="k_{i}\leftarrow" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">k</mi><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑘</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑖</ci></apply><csymbol cd="latexml" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">k_{i}\leftarrow</annotation></semantics></math> Get the first <math id="alg1.l9.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l9.m2.1a"><mi id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">k</annotation></semantics></math> that meets <math id="alg1.l9.m3.1" class="ltx_Math" alttext="\lambda^{H}_{k+1}-\lambda^{H}_{k}&gt;4\mathscr{L}_{i}" display="inline"><semantics id="alg1.l9.m3.1a"><mrow id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml"><mrow id="alg1.l9.m3.1.1.2" xref="alg1.l9.m3.1.1.2.cmml"><msubsup id="alg1.l9.m3.1.1.2.2" xref="alg1.l9.m3.1.1.2.2.cmml"><mi id="alg1.l9.m3.1.1.2.2.2.2" xref="alg1.l9.m3.1.1.2.2.2.2.cmml">λ</mi><mrow id="alg1.l9.m3.1.1.2.2.3" xref="alg1.l9.m3.1.1.2.2.3.cmml"><mi id="alg1.l9.m3.1.1.2.2.3.2" xref="alg1.l9.m3.1.1.2.2.3.2.cmml">k</mi><mo id="alg1.l9.m3.1.1.2.2.3.1" xref="alg1.l9.m3.1.1.2.2.3.1.cmml">+</mo><mn id="alg1.l9.m3.1.1.2.2.3.3" xref="alg1.l9.m3.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg1.l9.m3.1.1.2.2.2.3" xref="alg1.l9.m3.1.1.2.2.2.3.cmml">H</mi></msubsup><mo id="alg1.l9.m3.1.1.2.1" xref="alg1.l9.m3.1.1.2.1.cmml">−</mo><msubsup id="alg1.l9.m3.1.1.2.3" xref="alg1.l9.m3.1.1.2.3.cmml"><mi id="alg1.l9.m3.1.1.2.3.2.2" xref="alg1.l9.m3.1.1.2.3.2.2.cmml">λ</mi><mi id="alg1.l9.m3.1.1.2.3.3" xref="alg1.l9.m3.1.1.2.3.3.cmml">k</mi><mi id="alg1.l9.m3.1.1.2.3.2.3" xref="alg1.l9.m3.1.1.2.3.2.3.cmml">H</mi></msubsup></mrow><mo id="alg1.l9.m3.1.1.1" xref="alg1.l9.m3.1.1.1.cmml">&gt;</mo><mrow id="alg1.l9.m3.1.1.3" xref="alg1.l9.m3.1.1.3.cmml"><mn id="alg1.l9.m3.1.1.3.2" xref="alg1.l9.m3.1.1.3.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="alg1.l9.m3.1.1.3.1" xref="alg1.l9.m3.1.1.3.1.cmml">​</mo><msub id="alg1.l9.m3.1.1.3.3" xref="alg1.l9.m3.1.1.3.3.cmml"><mi class="ltx_font_mathscript" id="alg1.l9.m3.1.1.3.3.2" xref="alg1.l9.m3.1.1.3.3.2.cmml">ℒ</mi><mi id="alg1.l9.m3.1.1.3.3.3" xref="alg1.l9.m3.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.1b"><apply id="alg1.l9.m3.1.1.cmml" xref="alg1.l9.m3.1.1"><gt id="alg1.l9.m3.1.1.1.cmml" xref="alg1.l9.m3.1.1.1"></gt><apply id="alg1.l9.m3.1.1.2.cmml" xref="alg1.l9.m3.1.1.2"><minus id="alg1.l9.m3.1.1.2.1.cmml" xref="alg1.l9.m3.1.1.2.1"></minus><apply id="alg1.l9.m3.1.1.2.2.cmml" xref="alg1.l9.m3.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.2.2.1.cmml" xref="alg1.l9.m3.1.1.2.2">subscript</csymbol><apply id="alg1.l9.m3.1.1.2.2.2.cmml" xref="alg1.l9.m3.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.2.2.2.1.cmml" xref="alg1.l9.m3.1.1.2.2">superscript</csymbol><ci id="alg1.l9.m3.1.1.2.2.2.2.cmml" xref="alg1.l9.m3.1.1.2.2.2.2">𝜆</ci><ci id="alg1.l9.m3.1.1.2.2.2.3.cmml" xref="alg1.l9.m3.1.1.2.2.2.3">𝐻</ci></apply><apply id="alg1.l9.m3.1.1.2.2.3.cmml" xref="alg1.l9.m3.1.1.2.2.3"><plus id="alg1.l9.m3.1.1.2.2.3.1.cmml" xref="alg1.l9.m3.1.1.2.2.3.1"></plus><ci id="alg1.l9.m3.1.1.2.2.3.2.cmml" xref="alg1.l9.m3.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="alg1.l9.m3.1.1.2.2.3.3.cmml" xref="alg1.l9.m3.1.1.2.2.3.3">1</cn></apply></apply><apply id="alg1.l9.m3.1.1.2.3.cmml" xref="alg1.l9.m3.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.2.3.1.cmml" xref="alg1.l9.m3.1.1.2.3">subscript</csymbol><apply id="alg1.l9.m3.1.1.2.3.2.cmml" xref="alg1.l9.m3.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.2.3.2.1.cmml" xref="alg1.l9.m3.1.1.2.3">superscript</csymbol><ci id="alg1.l9.m3.1.1.2.3.2.2.cmml" xref="alg1.l9.m3.1.1.2.3.2.2">𝜆</ci><ci id="alg1.l9.m3.1.1.2.3.2.3.cmml" xref="alg1.l9.m3.1.1.2.3.2.3">𝐻</ci></apply><ci id="alg1.l9.m3.1.1.2.3.3.cmml" xref="alg1.l9.m3.1.1.2.3.3">𝑘</ci></apply></apply><apply id="alg1.l9.m3.1.1.3.cmml" xref="alg1.l9.m3.1.1.3"><times id="alg1.l9.m3.1.1.3.1.cmml" xref="alg1.l9.m3.1.1.3.1"></times><cn type="integer" id="alg1.l9.m3.1.1.3.2.cmml" xref="alg1.l9.m3.1.1.3.2">4</cn><apply id="alg1.l9.m3.1.1.3.3.cmml" xref="alg1.l9.m3.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.3.3.1.cmml" xref="alg1.l9.m3.1.1.3.3">subscript</csymbol><ci id="alg1.l9.m3.1.1.3.3.2.cmml" xref="alg1.l9.m3.1.1.3.3.2">ℒ</ci><ci id="alg1.l9.m3.1.1.3.3.3.cmml" xref="alg1.l9.m3.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.1c">\lambda^{H}_{k+1}-\lambda^{H}_{k}&gt;4\mathscr{L}_{i}</annotation></semantics></math> 

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <math id="alg1.l10.m1.1" class="ltx_Math" alttext="r_{i}\leftarrow\frac{K_{i}-k_{i}}{K_{i}}" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msub id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">r</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mfrac id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mrow id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml"><msub id="alg1.l10.m1.1.1.3.2.2" xref="alg1.l10.m1.1.1.3.2.2.cmml"><mi id="alg1.l10.m1.1.1.3.2.2.2" xref="alg1.l10.m1.1.1.3.2.2.2.cmml">K</mi><mi id="alg1.l10.m1.1.1.3.2.2.3" xref="alg1.l10.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo id="alg1.l10.m1.1.1.3.2.1" xref="alg1.l10.m1.1.1.3.2.1.cmml">−</mo><msub id="alg1.l10.m1.1.1.3.2.3" xref="alg1.l10.m1.1.1.3.2.3.cmml"><mi id="alg1.l10.m1.1.1.3.2.3.2" xref="alg1.l10.m1.1.1.3.2.3.2.cmml">k</mi><mi id="alg1.l10.m1.1.1.3.2.3.3" xref="alg1.l10.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow><msub id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml"><mi id="alg1.l10.m1.1.1.3.3.2" xref="alg1.l10.m1.1.1.3.3.2.cmml">K</mi><mi id="alg1.l10.m1.1.1.3.3.3" xref="alg1.l10.m1.1.1.3.3.3.cmml">i</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑟</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><divide id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3"></divide><apply id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2"><minus id="alg1.l10.m1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.3.2.1"></minus><apply id="alg1.l10.m1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.2.1.cmml" xref="alg1.l10.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2.2">𝐾</ci><ci id="alg1.l10.m1.1.1.3.2.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="alg1.l10.m1.1.1.3.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.3.1.cmml" xref="alg1.l10.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.2.3.2.cmml" xref="alg1.l10.m1.1.1.3.2.3.2">𝑘</ci><ci id="alg1.l10.m1.1.1.3.2.3.3.cmml" xref="alg1.l10.m1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.3.1.cmml" xref="alg1.l10.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l10.m1.1.1.3.3.2.cmml" xref="alg1.l10.m1.1.1.3.3.2">𝐾</ci><ci id="alg1.l10.m1.1.1.3.3.3.cmml" xref="alg1.l10.m1.1.1.3.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">r_{i}\leftarrow\frac{K_{i}-k_{i}}{K_{i}}</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <span id="alg1.l11.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l11.m1.1" class="ltx_Math" alttext="l\in L" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">l</mi><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">∈</mo><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><in id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></in><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑙</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">l\in L</annotation></semantics></math> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">do</span>

 

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>        Calculate <math id="alg1.l12.m1.2" class="ltx_Math" alttext="\zeta_{i,l}" display="inline"><semantics id="alg1.l12.m1.2a"><msub id="alg1.l12.m1.2.3" xref="alg1.l12.m1.2.3.cmml"><mi id="alg1.l12.m1.2.3.2" xref="alg1.l12.m1.2.3.2.cmml">ζ</mi><mrow id="alg1.l12.m1.2.2.2.4" xref="alg1.l12.m1.2.2.2.3.cmml"><mi id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l12.m1.2.2.2.4.1" xref="alg1.l12.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l12.m1.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><apply id="alg1.l12.m1.2.3.cmml" xref="alg1.l12.m1.2.3"><csymbol cd="ambiguous" id="alg1.l12.m1.2.3.1.cmml" xref="alg1.l12.m1.2.3">subscript</csymbol><ci id="alg1.l12.m1.2.3.2.cmml" xref="alg1.l12.m1.2.3.2">𝜁</ci><list id="alg1.l12.m1.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.4"><ci id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">𝑖</ci><ci id="alg1.l12.m1.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2">𝑙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">\zeta_{i,l}</annotation></semantics></math> according to Formula <a href="#S4.E3" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>  <span id="alg1.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>  Aggregate <math id="alg1.l15.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="alg1.l15.m1.1a"><mi id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">r</annotation></semantics></math> and each <math id="alg1.l15.m2.1" class="ltx_Math" alttext="\zeta_{l}" display="inline"><semantics id="alg1.l15.m2.1a"><msub id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml"><mi id="alg1.l15.m2.1.1.2" xref="alg1.l15.m2.1.1.2.cmml">ζ</mi><mi id="alg1.l15.m2.1.1.3" xref="alg1.l15.m2.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><apply id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1"><csymbol cd="ambiguous" id="alg1.l15.m2.1.1.1.cmml" xref="alg1.l15.m2.1.1">subscript</csymbol><ci id="alg1.l15.m2.1.1.2.cmml" xref="alg1.l15.m2.1.1.2">𝜁</ci><ci id="alg1.l15.m2.1.1.3.cmml" xref="alg1.l15.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">\zeta_{l}</annotation></semantics></math> based on Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> 

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>  <math id="alg1.l16.m1.1" class="ltx_Math" alttext="\zeta\leftarrow" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">ζ</mi><mo stretchy="false" id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml">←</mo><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1">←</ci><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">𝜁</ci><csymbol cd="latexml" id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\zeta\leftarrow</annotation></semantics></math> Sort <math id="alg1.l16.m2.4" class="ltx_Math" alttext="\{\zeta_{1},\zeta_{2},...,\zeta_{L}\}" display="inline"><semantics id="alg1.l16.m2.4a"><mrow id="alg1.l16.m2.4.4.3" xref="alg1.l16.m2.4.4.4.cmml"><mo stretchy="false" id="alg1.l16.m2.4.4.3.4" xref="alg1.l16.m2.4.4.4.cmml">{</mo><msub id="alg1.l16.m2.2.2.1.1" xref="alg1.l16.m2.2.2.1.1.cmml"><mi id="alg1.l16.m2.2.2.1.1.2" xref="alg1.l16.m2.2.2.1.1.2.cmml">ζ</mi><mn id="alg1.l16.m2.2.2.1.1.3" xref="alg1.l16.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l16.m2.4.4.3.5" xref="alg1.l16.m2.4.4.4.cmml">,</mo><msub id="alg1.l16.m2.3.3.2.2" xref="alg1.l16.m2.3.3.2.2.cmml"><mi id="alg1.l16.m2.3.3.2.2.2" xref="alg1.l16.m2.3.3.2.2.2.cmml">ζ</mi><mn id="alg1.l16.m2.3.3.2.2.3" xref="alg1.l16.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="alg1.l16.m2.4.4.3.6" xref="alg1.l16.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml">…</mi><mo id="alg1.l16.m2.4.4.3.7" xref="alg1.l16.m2.4.4.4.cmml">,</mo><msub id="alg1.l16.m2.4.4.3.3" xref="alg1.l16.m2.4.4.3.3.cmml"><mi id="alg1.l16.m2.4.4.3.3.2" xref="alg1.l16.m2.4.4.3.3.2.cmml">ζ</mi><mi id="alg1.l16.m2.4.4.3.3.3" xref="alg1.l16.m2.4.4.3.3.3.cmml">L</mi></msub><mo stretchy="false" id="alg1.l16.m2.4.4.3.8" xref="alg1.l16.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.4b"><set id="alg1.l16.m2.4.4.4.cmml" xref="alg1.l16.m2.4.4.3"><apply id="alg1.l16.m2.2.2.1.1.cmml" xref="alg1.l16.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.2.2.1.1.1.cmml" xref="alg1.l16.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l16.m2.2.2.1.1.2.cmml" xref="alg1.l16.m2.2.2.1.1.2">𝜁</ci><cn type="integer" id="alg1.l16.m2.2.2.1.1.3.cmml" xref="alg1.l16.m2.2.2.1.1.3">1</cn></apply><apply id="alg1.l16.m2.3.3.2.2.cmml" xref="alg1.l16.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l16.m2.3.3.2.2.1.cmml" xref="alg1.l16.m2.3.3.2.2">subscript</csymbol><ci id="alg1.l16.m2.3.3.2.2.2.cmml" xref="alg1.l16.m2.3.3.2.2.2">𝜁</ci><cn type="integer" id="alg1.l16.m2.3.3.2.2.3.cmml" xref="alg1.l16.m2.3.3.2.2.3">2</cn></apply><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">…</ci><apply id="alg1.l16.m2.4.4.3.3.cmml" xref="alg1.l16.m2.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l16.m2.4.4.3.3.1.cmml" xref="alg1.l16.m2.4.4.3.3">subscript</csymbol><ci id="alg1.l16.m2.4.4.3.3.2.cmml" xref="alg1.l16.m2.4.4.3.3.2">𝜁</ci><ci id="alg1.l16.m2.4.4.3.3.3.cmml" xref="alg1.l16.m2.4.4.3.3.3">𝐿</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.4c">\{\zeta_{1},\zeta_{2},...,\zeta_{L}\}</annotation></semantics></math> in descending order 

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>  <span id="alg1.l17.1" class="ltx_text ltx_font_bold">while</span> <math id="alg1.l17.m1.1" class="ltx_Math" alttext="l\in\zeta" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mi id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">l</mi><mo id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml">∈</mo><mi id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml">ζ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><in id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"></in><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">𝑙</ci><ci id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3">𝜁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">l\in\zeta</annotation></semantics></math> and <math id="alg1.l17.m2.2" class="ltx_Math" alttext="\frac{Para(SL)}{Para(L)}&lt;r" display="inline"><semantics id="alg1.l17.m2.2a"><mrow id="alg1.l17.m2.2.3" xref="alg1.l17.m2.2.3.cmml"><mfrac id="alg1.l17.m2.2.2" xref="alg1.l17.m2.2.2.cmml"><mrow id="alg1.l17.m2.1.1.1" xref="alg1.l17.m2.1.1.1.cmml"><mi id="alg1.l17.m2.1.1.1.3" xref="alg1.l17.m2.1.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.1.1.1.2" xref="alg1.l17.m2.1.1.1.2.cmml">​</mo><mi id="alg1.l17.m2.1.1.1.4" xref="alg1.l17.m2.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.1.1.1.2a" xref="alg1.l17.m2.1.1.1.2.cmml">​</mo><mi id="alg1.l17.m2.1.1.1.5" xref="alg1.l17.m2.1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.1.1.1.2b" xref="alg1.l17.m2.1.1.1.2.cmml">​</mo><mi id="alg1.l17.m2.1.1.1.6" xref="alg1.l17.m2.1.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.1.1.1.2c" xref="alg1.l17.m2.1.1.1.2.cmml">​</mo><mrow id="alg1.l17.m2.1.1.1.1.1" xref="alg1.l17.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l17.m2.1.1.1.1.1.2" xref="alg1.l17.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l17.m2.1.1.1.1.1.1" xref="alg1.l17.m2.1.1.1.1.1.1.cmml"><mi id="alg1.l17.m2.1.1.1.1.1.1.2" xref="alg1.l17.m2.1.1.1.1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.1.1.1.1.1.1.1" xref="alg1.l17.m2.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg1.l17.m2.1.1.1.1.1.1.3" xref="alg1.l17.m2.1.1.1.1.1.1.3.cmml">L</mi></mrow><mo stretchy="false" id="alg1.l17.m2.1.1.1.1.1.3" xref="alg1.l17.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="alg1.l17.m2.2.2.2" xref="alg1.l17.m2.2.2.2.cmml"><mi id="alg1.l17.m2.2.2.2.3" xref="alg1.l17.m2.2.2.2.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.2.2.2.2" xref="alg1.l17.m2.2.2.2.2.cmml">​</mo><mi id="alg1.l17.m2.2.2.2.4" xref="alg1.l17.m2.2.2.2.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.2.2.2.2a" xref="alg1.l17.m2.2.2.2.2.cmml">​</mo><mi id="alg1.l17.m2.2.2.2.5" xref="alg1.l17.m2.2.2.2.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.2.2.2.2b" xref="alg1.l17.m2.2.2.2.2.cmml">​</mo><mi id="alg1.l17.m2.2.2.2.6" xref="alg1.l17.m2.2.2.2.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l17.m2.2.2.2.2c" xref="alg1.l17.m2.2.2.2.2.cmml">​</mo><mrow id="alg1.l17.m2.2.2.2.7.2" xref="alg1.l17.m2.2.2.2.cmml"><mo stretchy="false" id="alg1.l17.m2.2.2.2.7.2.1" xref="alg1.l17.m2.2.2.2.cmml">(</mo><mi id="alg1.l17.m2.2.2.2.1" xref="alg1.l17.m2.2.2.2.1.cmml">L</mi><mo stretchy="false" id="alg1.l17.m2.2.2.2.7.2.2" xref="alg1.l17.m2.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="alg1.l17.m2.2.3.1" xref="alg1.l17.m2.2.3.1.cmml">&lt;</mo><mi id="alg1.l17.m2.2.3.2" xref="alg1.l17.m2.2.3.2.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m2.2b"><apply id="alg1.l17.m2.2.3.cmml" xref="alg1.l17.m2.2.3"><lt id="alg1.l17.m2.2.3.1.cmml" xref="alg1.l17.m2.2.3.1"></lt><apply id="alg1.l17.m2.2.2.cmml" xref="alg1.l17.m2.2.2"><divide id="alg1.l17.m2.2.2.3.cmml" xref="alg1.l17.m2.2.2"></divide><apply id="alg1.l17.m2.1.1.1.cmml" xref="alg1.l17.m2.1.1.1"><times id="alg1.l17.m2.1.1.1.2.cmml" xref="alg1.l17.m2.1.1.1.2"></times><ci id="alg1.l17.m2.1.1.1.3.cmml" xref="alg1.l17.m2.1.1.1.3">𝑃</ci><ci id="alg1.l17.m2.1.1.1.4.cmml" xref="alg1.l17.m2.1.1.1.4">𝑎</ci><ci id="alg1.l17.m2.1.1.1.5.cmml" xref="alg1.l17.m2.1.1.1.5">𝑟</ci><ci id="alg1.l17.m2.1.1.1.6.cmml" xref="alg1.l17.m2.1.1.1.6">𝑎</ci><apply id="alg1.l17.m2.1.1.1.1.1.1.cmml" xref="alg1.l17.m2.1.1.1.1.1"><times id="alg1.l17.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m2.1.1.1.1.1.1.1"></times><ci id="alg1.l17.m2.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m2.1.1.1.1.1.1.2">𝑆</ci><ci id="alg1.l17.m2.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m2.1.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="alg1.l17.m2.2.2.2.cmml" xref="alg1.l17.m2.2.2.2"><times id="alg1.l17.m2.2.2.2.2.cmml" xref="alg1.l17.m2.2.2.2.2"></times><ci id="alg1.l17.m2.2.2.2.3.cmml" xref="alg1.l17.m2.2.2.2.3">𝑃</ci><ci id="alg1.l17.m2.2.2.2.4.cmml" xref="alg1.l17.m2.2.2.2.4">𝑎</ci><ci id="alg1.l17.m2.2.2.2.5.cmml" xref="alg1.l17.m2.2.2.2.5">𝑟</ci><ci id="alg1.l17.m2.2.2.2.6.cmml" xref="alg1.l17.m2.2.2.2.6">𝑎</ci><ci id="alg1.l17.m2.2.2.2.1.cmml" xref="alg1.l17.m2.2.2.2.1">𝐿</ci></apply></apply><ci id="alg1.l17.m2.2.3.2.cmml" xref="alg1.l17.m2.2.3.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m2.2c">\frac{Para(SL)}{Para(L)}&lt;r</annotation></semantics></math> <span id="alg1.l17.2" class="ltx_text ltx_font_bold">do</span>

 

</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <math id="alg1.l18.m1.1" class="ltx_Math" alttext="SL\leftarrow SL\cup l" display="inline"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mrow id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.2.2" xref="alg1.l18.m1.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.2.1" xref="alg1.l18.m1.1.1.2.1.cmml">​</mo><mi id="alg1.l18.m1.1.1.2.3" xref="alg1.l18.m1.1.1.2.3.cmml">L</mi></mrow><mo stretchy="false" id="alg1.l18.m1.1.1.1" xref="alg1.l18.m1.1.1.1.cmml">←</mo><mrow id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"><mrow id="alg1.l18.m1.1.1.3.2" xref="alg1.l18.m1.1.1.3.2.cmml"><mi id="alg1.l18.m1.1.1.3.2.2" xref="alg1.l18.m1.1.1.3.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="alg1.l18.m1.1.1.3.2.1" xref="alg1.l18.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.l18.m1.1.1.3.2.3" xref="alg1.l18.m1.1.1.3.2.3.cmml">L</mi></mrow><mo id="alg1.l18.m1.1.1.3.1" xref="alg1.l18.m1.1.1.3.1.cmml">∪</mo><mi id="alg1.l18.m1.1.1.3.3" xref="alg1.l18.m1.1.1.3.3.cmml">l</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><ci id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1">←</ci><apply id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2"><times id="alg1.l18.m1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.2.1"></times><ci id="alg1.l18.m1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.2.2">𝑆</ci><ci id="alg1.l18.m1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.2.3">𝐿</ci></apply><apply id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"><union id="alg1.l18.m1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.3.1"></union><apply id="alg1.l18.m1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.3.2"><times id="alg1.l18.m1.1.1.3.2.1.cmml" xref="alg1.l18.m1.1.1.3.2.1"></times><ci id="alg1.l18.m1.1.1.3.2.2.cmml" xref="alg1.l18.m1.1.1.3.2.2">𝑆</ci><ci id="alg1.l18.m1.1.1.3.2.3.cmml" xref="alg1.l18.m1.1.1.3.2.3">𝐿</ci></apply><ci id="alg1.l18.m1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">SL\leftarrow SL\cup l</annotation></semantics></math>

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>  <span id="alg1.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.2" class="ltx_text ltx_font_bold">while</span>

</div>
</div>
</figure>
</figure>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.9" class="ltx_p">In order to efficiently tune the large language model without performance degradation, we exploit a lossless method as shown in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> to select the set of proper layers within FL. Within first <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><mi id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><ci id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">t</annotation></semantics></math> rounds, the prompt parameters of all the layers are communicated between the server and each device. <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">t</annotation></semantics></math> can be small, e.g., 5 or 10. At <math id="S4.SS2.p4.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS2.p4.3.m3.1a"><mi id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><ci id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">t</annotation></semantics></math>-th round, we perform the layer selection. First, we calculate <math id="S4.SS2.p4.4.m4.1" class="ltx_Math" alttext="\Delta_{i}" display="inline"><semantics id="S4.SS2.p4.4.m4.1a"><msub id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">Δ</mi><mi id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">Δ</ci><ci id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">\Delta_{i}</annotation></semantics></math> as the changement of the prompt parameters (Line <a href="#alg1.l3" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Then, we calculate the Hessian matrix (based an efficient PyHessian library <cite class="ltx_cite ltx_citemacro_cite">Yao et al. (<a href="#bib.bib88" title="" class="ltx_ref">2020</a>)</cite>) of the current model (Line <a href="#alg1.l4" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), the corresponding eigenvalues (Line <a href="#alg1.l5" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), and sort the eigenvalues in ascending order (Line <a href="#alg1.l6" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>). Afterward, we construct a base function in Line <a href="#alg1.l7" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> with <math id="S4.SS2.p4.5.m5.1" class="ltx_Math" alttext="\triangledown F_{i}" display="inline"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mi mathvariant="normal" id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">▽</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.5.m5.1.1.1" xref="S4.SS2.p4.5.m5.1.1.1.cmml">​</mo><msub id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml"><mi id="S4.SS2.p4.5.m5.1.1.3.2" xref="S4.SS2.p4.5.m5.1.1.3.2.cmml">F</mi><mi id="S4.SS2.p4.5.m5.1.1.3.3" xref="S4.SS2.p4.5.m5.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><times id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1.1"></times><ci id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">▽</ci><apply id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.5.m5.1.1.3.1.cmml" xref="S4.SS2.p4.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.5.m5.1.1.3.2.cmml" xref="S4.SS2.p4.5.m5.1.1.3.2">𝐹</ci><ci id="S4.SS2.p4.5.m5.1.1.3.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">\triangledown F_{i}</annotation></semantics></math> representing the gradients and calculate the Lipschitz constant of the base function <a href="#alg1.l8" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. We take the first <math id="S4.SS2.p4.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p4.6.m6.1a"><mi id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><ci id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">k</annotation></semantics></math> that can meet the constraint in Line <a href="#alg1.l9" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, and calculate the minimum remaining prompt parameter ratio in the selected layers <math id="S4.SS2.p4.7.m7.1" class="ltx_Math" alttext="\mathcal{R}_{i}" display="inline"><semantics id="S4.SS2.p4.7.m7.1a"><msub id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p4.7.m7.1.1.2" xref="S4.SS2.p4.7.m7.1.1.2.cmml">ℛ</mi><mi id="S4.SS2.p4.7.m7.1.1.3" xref="S4.SS2.p4.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><apply id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p4.7.m7.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1.2">ℛ</ci><ci id="S4.SS2.p4.7.m7.1.1.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">\mathcal{R}_{i}</annotation></semantics></math>, inspired by <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a href="#bib.bib93" title="" class="ltx_ref">2021</a>)</cite>, which can achieve lossless compared with those at all the layers. We calculate the score of each layer in Lines <a href="#alg1.l11" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> - <a href="#alg1.l13" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>. The execute of Lines <a href="#alg1.l3" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> - <a href="#alg1.l13" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> can be carried out in parallel on each device. We aggregate the prompt parameter ratio and the scores based on Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> from each device to the server (Line <a href="#alg1.l15" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>). Then, we sort the layers according to the scores in descending order (Line <a href="#alg1.l16" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a>). Finally, we add the layers into the selected layer set based on the scores in descending order (Lines <a href="#alg1.l17" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a> - <a href="#alg1.l19" title="In Algorithm 1 ‣ 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">19</span></a>), with <math id="S4.SS2.p4.8.m8.1" class="ltx_Math" alttext="Para(SL_{i})" display="inline"><semantics id="S4.SS2.p4.8.m8.1a"><mrow id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml"><mi id="S4.SS2.p4.8.m8.1.1.3" xref="S4.SS2.p4.8.m8.1.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.8.m8.1.1.2" xref="S4.SS2.p4.8.m8.1.1.2.cmml">​</mo><mi id="S4.SS2.p4.8.m8.1.1.4" xref="S4.SS2.p4.8.m8.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.8.m8.1.1.2a" xref="S4.SS2.p4.8.m8.1.1.2.cmml">​</mo><mi id="S4.SS2.p4.8.m8.1.1.5" xref="S4.SS2.p4.8.m8.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.8.m8.1.1.2b" xref="S4.SS2.p4.8.m8.1.1.2.cmml">​</mo><mi id="S4.SS2.p4.8.m8.1.1.6" xref="S4.SS2.p4.8.m8.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.8.m8.1.1.2c" xref="S4.SS2.p4.8.m8.1.1.2.cmml">​</mo><mrow id="S4.SS2.p4.8.m8.1.1.1.1" xref="S4.SS2.p4.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p4.8.m8.1.1.1.1.2" xref="S4.SS2.p4.8.m8.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p4.8.m8.1.1.1.1.1" xref="S4.SS2.p4.8.m8.1.1.1.1.1.cmml"><mi id="S4.SS2.p4.8.m8.1.1.1.1.1.2" xref="S4.SS2.p4.8.m8.1.1.1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.8.m8.1.1.1.1.1.1" xref="S4.SS2.p4.8.m8.1.1.1.1.1.1.cmml">​</mo><msub id="S4.SS2.p4.8.m8.1.1.1.1.1.3" xref="S4.SS2.p4.8.m8.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p4.8.m8.1.1.1.1.1.3.2" xref="S4.SS2.p4.8.m8.1.1.1.1.1.3.2.cmml">L</mi><mi id="S4.SS2.p4.8.m8.1.1.1.1.1.3.3" xref="S4.SS2.p4.8.m8.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S4.SS2.p4.8.m8.1.1.1.1.3" xref="S4.SS2.p4.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b"><apply id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1"><times id="S4.SS2.p4.8.m8.1.1.2.cmml" xref="S4.SS2.p4.8.m8.1.1.2"></times><ci id="S4.SS2.p4.8.m8.1.1.3.cmml" xref="S4.SS2.p4.8.m8.1.1.3">𝑃</ci><ci id="S4.SS2.p4.8.m8.1.1.4.cmml" xref="S4.SS2.p4.8.m8.1.1.4">𝑎</ci><ci id="S4.SS2.p4.8.m8.1.1.5.cmml" xref="S4.SS2.p4.8.m8.1.1.5">𝑟</ci><ci id="S4.SS2.p4.8.m8.1.1.6.cmml" xref="S4.SS2.p4.8.m8.1.1.6">𝑎</ci><apply id="S4.SS2.p4.8.m8.1.1.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1.1.1"><times id="S4.SS2.p4.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1.1.1.1.1"></times><ci id="S4.SS2.p4.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.8.m8.1.1.1.1.1.2">𝑆</ci><apply id="S4.SS2.p4.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.8.m8.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p4.8.m8.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.8.m8.1.1.1.1.1.3.2">𝐿</ci><ci id="S4.SS2.p4.8.m8.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p4.8.m8.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">Para(SL_{i})</annotation></semantics></math> representing the number of parameters in the selected layer set. In the following rounds, the prompt parameters in <math id="S4.SS2.p4.9.m9.1" class="ltx_Math" alttext="SL" display="inline"><semantics id="S4.SS2.p4.9.m9.1a"><mrow id="S4.SS2.p4.9.m9.1.1" xref="S4.SS2.p4.9.m9.1.1.cmml"><mi id="S4.SS2.p4.9.m9.1.1.2" xref="S4.SS2.p4.9.m9.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p4.9.m9.1.1.1" xref="S4.SS2.p4.9.m9.1.1.1.cmml">​</mo><mi id="S4.SS2.p4.9.m9.1.1.3" xref="S4.SS2.p4.9.m9.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m9.1b"><apply id="S4.SS2.p4.9.m9.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1"><times id="S4.SS2.p4.9.m9.1.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1.1"></times><ci id="S4.SS2.p4.9.m9.1.1.2.cmml" xref="S4.SS2.p4.9.m9.1.1.2">𝑆</ci><ci id="S4.SS2.p4.9.m9.1.1.3.cmml" xref="S4.SS2.p4.9.m9.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m9.1c">SL</annotation></semantics></math> are communicated between devices and the server.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Communication-Efficient Adaptive Optimization</h3>

<figure id="S4.SS3.fig1" class="ltx_figure">
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Communication-Efficient Adaptive Optimization </figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>   <math id="alg2.l0.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg2.l0.m1.1a"><mi id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><ci id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">M</annotation></semantics></math>: The set of devices<math id="alg2.l0.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg2.l0.m2.1a"><mi id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><ci id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">w</annotation></semantics></math>: The prompt parameters of the initial model<math id="alg2.l0.m3.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg2.l0.m3.1a"><mi id="alg2.l0.m3.1.1" xref="alg2.l0.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m3.1b"><ci id="alg2.l0.m3.1.1.cmml" xref="alg2.l0.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m3.1c">R</annotation></semantics></math>: The maximum number of global round<math id="alg2.l0.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg2.l0.m4.1a"><mi id="alg2.l0.m4.1.1" xref="alg2.l0.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m4.1b"><ci id="alg2.l0.m4.1.1.cmml" xref="alg2.l0.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m4.1c">\alpha</annotation></semantics></math>: The local step size<math id="alg2.l0.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg2.l0.m5.1a"><mi id="alg2.l0.m5.1.1" xref="alg2.l0.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m5.1b"><ci id="alg2.l0.m5.1.1.cmml" xref="alg2.l0.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m5.1c">\beta</annotation></semantics></math>: The momentum parameter<math id="alg2.l0.m6.4" class="ltx_Math" alttext="\eta=\{\eta^{1},\eta^{2},...,\eta^{R}\}" display="inline"><semantics id="alg2.l0.m6.4a"><mrow id="alg2.l0.m6.4.4" xref="alg2.l0.m6.4.4.cmml"><mi id="alg2.l0.m6.4.4.5" xref="alg2.l0.m6.4.4.5.cmml">η</mi><mo id="alg2.l0.m6.4.4.4" xref="alg2.l0.m6.4.4.4.cmml">=</mo><mrow id="alg2.l0.m6.4.4.3.3" xref="alg2.l0.m6.4.4.3.4.cmml"><mo stretchy="false" id="alg2.l0.m6.4.4.3.3.4" xref="alg2.l0.m6.4.4.3.4.cmml">{</mo><msup id="alg2.l0.m6.2.2.1.1.1" xref="alg2.l0.m6.2.2.1.1.1.cmml"><mi id="alg2.l0.m6.2.2.1.1.1.2" xref="alg2.l0.m6.2.2.1.1.1.2.cmml">η</mi><mn id="alg2.l0.m6.2.2.1.1.1.3" xref="alg2.l0.m6.2.2.1.1.1.3.cmml">1</mn></msup><mo id="alg2.l0.m6.4.4.3.3.5" xref="alg2.l0.m6.4.4.3.4.cmml">,</mo><msup id="alg2.l0.m6.3.3.2.2.2" xref="alg2.l0.m6.3.3.2.2.2.cmml"><mi id="alg2.l0.m6.3.3.2.2.2.2" xref="alg2.l0.m6.3.3.2.2.2.2.cmml">η</mi><mn id="alg2.l0.m6.3.3.2.2.2.3" xref="alg2.l0.m6.3.3.2.2.2.3.cmml">2</mn></msup><mo id="alg2.l0.m6.4.4.3.3.6" xref="alg2.l0.m6.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="alg2.l0.m6.1.1" xref="alg2.l0.m6.1.1.cmml">…</mi><mo id="alg2.l0.m6.4.4.3.3.7" xref="alg2.l0.m6.4.4.3.4.cmml">,</mo><msup id="alg2.l0.m6.4.4.3.3.3" xref="alg2.l0.m6.4.4.3.3.3.cmml"><mi id="alg2.l0.m6.4.4.3.3.3.2" xref="alg2.l0.m6.4.4.3.3.3.2.cmml">η</mi><mi id="alg2.l0.m6.4.4.3.3.3.3" xref="alg2.l0.m6.4.4.3.3.3.3.cmml">R</mi></msup><mo stretchy="false" id="alg2.l0.m6.4.4.3.3.8" xref="alg2.l0.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l0.m6.4b"><apply id="alg2.l0.m6.4.4.cmml" xref="alg2.l0.m6.4.4"><eq id="alg2.l0.m6.4.4.4.cmml" xref="alg2.l0.m6.4.4.4"></eq><ci id="alg2.l0.m6.4.4.5.cmml" xref="alg2.l0.m6.4.4.5">𝜂</ci><set id="alg2.l0.m6.4.4.3.4.cmml" xref="alg2.l0.m6.4.4.3.3"><apply id="alg2.l0.m6.2.2.1.1.1.cmml" xref="alg2.l0.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l0.m6.2.2.1.1.1.1.cmml" xref="alg2.l0.m6.2.2.1.1.1">superscript</csymbol><ci id="alg2.l0.m6.2.2.1.1.1.2.cmml" xref="alg2.l0.m6.2.2.1.1.1.2">𝜂</ci><cn type="integer" id="alg2.l0.m6.2.2.1.1.1.3.cmml" xref="alg2.l0.m6.2.2.1.1.1.3">1</cn></apply><apply id="alg2.l0.m6.3.3.2.2.2.cmml" xref="alg2.l0.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l0.m6.3.3.2.2.2.1.cmml" xref="alg2.l0.m6.3.3.2.2.2">superscript</csymbol><ci id="alg2.l0.m6.3.3.2.2.2.2.cmml" xref="alg2.l0.m6.3.3.2.2.2.2">𝜂</ci><cn type="integer" id="alg2.l0.m6.3.3.2.2.2.3.cmml" xref="alg2.l0.m6.3.3.2.2.2.3">2</cn></apply><ci id="alg2.l0.m6.1.1.cmml" xref="alg2.l0.m6.1.1">…</ci><apply id="alg2.l0.m6.4.4.3.3.3.cmml" xref="alg2.l0.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="alg2.l0.m6.4.4.3.3.3.1.cmml" xref="alg2.l0.m6.4.4.3.3.3">superscript</csymbol><ci id="alg2.l0.m6.4.4.3.3.3.2.cmml" xref="alg2.l0.m6.4.4.3.3.3.2">𝜂</ci><ci id="alg2.l0.m6.4.4.3.3.3.3.cmml" xref="alg2.l0.m6.4.4.3.3.3.3">𝑅</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m6.4c">\eta=\{\eta^{1},\eta^{2},...,\eta^{R}\}</annotation></semantics></math>: The set of global learning rates<math id="alg2.l0.m7.4" class="ltx_Math" alttext="T=\{T_{1},T_{2},...,T_{M}\}" display="inline"><semantics id="alg2.l0.m7.4a"><mrow id="alg2.l0.m7.4.4" xref="alg2.l0.m7.4.4.cmml"><mi id="alg2.l0.m7.4.4.5" xref="alg2.l0.m7.4.4.5.cmml">T</mi><mo id="alg2.l0.m7.4.4.4" xref="alg2.l0.m7.4.4.4.cmml">=</mo><mrow id="alg2.l0.m7.4.4.3.3" xref="alg2.l0.m7.4.4.3.4.cmml"><mo stretchy="false" id="alg2.l0.m7.4.4.3.3.4" xref="alg2.l0.m7.4.4.3.4.cmml">{</mo><msub id="alg2.l0.m7.2.2.1.1.1" xref="alg2.l0.m7.2.2.1.1.1.cmml"><mi id="alg2.l0.m7.2.2.1.1.1.2" xref="alg2.l0.m7.2.2.1.1.1.2.cmml">T</mi><mn id="alg2.l0.m7.2.2.1.1.1.3" xref="alg2.l0.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l0.m7.4.4.3.3.5" xref="alg2.l0.m7.4.4.3.4.cmml">,</mo><msub id="alg2.l0.m7.3.3.2.2.2" xref="alg2.l0.m7.3.3.2.2.2.cmml"><mi id="alg2.l0.m7.3.3.2.2.2.2" xref="alg2.l0.m7.3.3.2.2.2.2.cmml">T</mi><mn id="alg2.l0.m7.3.3.2.2.2.3" xref="alg2.l0.m7.3.3.2.2.2.3.cmml">2</mn></msub><mo id="alg2.l0.m7.4.4.3.3.6" xref="alg2.l0.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="alg2.l0.m7.1.1" xref="alg2.l0.m7.1.1.cmml">…</mi><mo id="alg2.l0.m7.4.4.3.3.7" xref="alg2.l0.m7.4.4.3.4.cmml">,</mo><msub id="alg2.l0.m7.4.4.3.3.3" xref="alg2.l0.m7.4.4.3.3.3.cmml"><mi id="alg2.l0.m7.4.4.3.3.3.2" xref="alg2.l0.m7.4.4.3.3.3.2.cmml">T</mi><mi id="alg2.l0.m7.4.4.3.3.3.3" xref="alg2.l0.m7.4.4.3.3.3.3.cmml">M</mi></msub><mo stretchy="false" id="alg2.l0.m7.4.4.3.3.8" xref="alg2.l0.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l0.m7.4b"><apply id="alg2.l0.m7.4.4.cmml" xref="alg2.l0.m7.4.4"><eq id="alg2.l0.m7.4.4.4.cmml" xref="alg2.l0.m7.4.4.4"></eq><ci id="alg2.l0.m7.4.4.5.cmml" xref="alg2.l0.m7.4.4.5">𝑇</ci><set id="alg2.l0.m7.4.4.3.4.cmml" xref="alg2.l0.m7.4.4.3.3"><apply id="alg2.l0.m7.2.2.1.1.1.cmml" xref="alg2.l0.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l0.m7.2.2.1.1.1.1.cmml" xref="alg2.l0.m7.2.2.1.1.1">subscript</csymbol><ci id="alg2.l0.m7.2.2.1.1.1.2.cmml" xref="alg2.l0.m7.2.2.1.1.1.2">𝑇</ci><cn type="integer" id="alg2.l0.m7.2.2.1.1.1.3.cmml" xref="alg2.l0.m7.2.2.1.1.1.3">1</cn></apply><apply id="alg2.l0.m7.3.3.2.2.2.cmml" xref="alg2.l0.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l0.m7.3.3.2.2.2.1.cmml" xref="alg2.l0.m7.3.3.2.2.2">subscript</csymbol><ci id="alg2.l0.m7.3.3.2.2.2.2.cmml" xref="alg2.l0.m7.3.3.2.2.2.2">𝑇</ci><cn type="integer" id="alg2.l0.m7.3.3.2.2.2.3.cmml" xref="alg2.l0.m7.3.3.2.2.2.3">2</cn></apply><ci id="alg2.l0.m7.1.1.cmml" xref="alg2.l0.m7.1.1">…</ci><apply id="alg2.l0.m7.4.4.3.3.3.cmml" xref="alg2.l0.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="alg2.l0.m7.4.4.3.3.3.1.cmml" xref="alg2.l0.m7.4.4.3.3.3">subscript</csymbol><ci id="alg2.l0.m7.4.4.3.3.3.2.cmml" xref="alg2.l0.m7.4.4.3.3.3.2">𝑇</ci><ci id="alg2.l0.m7.4.4.3.3.3.3.cmml" xref="alg2.l0.m7.4.4.3.3.3.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m7.4c">T=\{T_{1},T_{2},...,T_{M}\}</annotation></semantics></math>: The set of local epoch <math id="alg2.l0.m8.1" class="ltx_Math" alttext="T_{i}" display="inline"><semantics id="alg2.l0.m8.1a"><msub id="alg2.l0.m8.1.1" xref="alg2.l0.m8.1.1.cmml"><mi id="alg2.l0.m8.1.1.2" xref="alg2.l0.m8.1.1.2.cmml">T</mi><mi id="alg2.l0.m8.1.1.3" xref="alg2.l0.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m8.1b"><apply id="alg2.l0.m8.1.1.cmml" xref="alg2.l0.m8.1.1"><csymbol cd="ambiguous" id="alg2.l0.m8.1.1.1.cmml" xref="alg2.l0.m8.1.1">subscript</csymbol><ci id="alg2.l0.m8.1.1.2.cmml" xref="alg2.l0.m8.1.1.2">𝑇</ci><ci id="alg2.l0.m8.1.1.3.cmml" xref="alg2.l0.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m8.1c">T_{i}</annotation></semantics></math> on each Device <math id="alg2.l0.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l0.m9.1a"><mi id="alg2.l0.m9.1.1" xref="alg2.l0.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m9.1b"><ci id="alg2.l0.m9.1.1.cmml" xref="alg2.l0.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m9.1c">i</annotation></semantics></math>

</div>
<div id="alg2.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>   <math id="alg2.l0a.m1.1" class="ltx_Math" alttext="w^{R}" display="inline"><semantics id="alg2.l0a.m1.1a"><msup id="alg2.l0a.m1.1.1" xref="alg2.l0a.m1.1.1.cmml"><mi id="alg2.l0a.m1.1.1.2" xref="alg2.l0a.m1.1.1.2.cmml">w</mi><mi id="alg2.l0a.m1.1.1.3" xref="alg2.l0a.m1.1.1.3.cmml">R</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l0a.m1.1b"><apply id="alg2.l0a.m1.1.1.cmml" xref="alg2.l0a.m1.1.1"><csymbol cd="ambiguous" id="alg2.l0a.m1.1.1.1.cmml" xref="alg2.l0a.m1.1.1">superscript</csymbol><ci id="alg2.l0a.m1.1.1.2.cmml" xref="alg2.l0a.m1.1.1.2">𝑤</ci><ci id="alg2.l0a.m1.1.1.3.cmml" xref="alg2.l0a.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0a.m1.1c">w^{R}</annotation></semantics></math>: The final model

</div>
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math id="alg2.l1.m1.1" class="ltx_Math" alttext="w^{0}\leftarrow w" display="inline"><semantics id="alg2.l1.m1.1a"><mrow id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><msup id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml"><mi id="alg2.l1.m1.1.1.2.2" xref="alg2.l1.m1.1.1.2.2.cmml">w</mi><mn id="alg2.l1.m1.1.1.2.3" xref="alg2.l1.m1.1.1.2.3.cmml">0</mn></msup><mo stretchy="false" id="alg2.l1.m1.1.1.1" xref="alg2.l1.m1.1.1.1.cmml">←</mo><mi id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">w</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><ci id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1">←</ci><apply id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.2.1.cmml" xref="alg2.l1.m1.1.1.2">superscript</csymbol><ci id="alg2.l1.m1.1.1.2.2.cmml" xref="alg2.l1.m1.1.1.2.2">𝑤</ci><cn type="integer" id="alg2.l1.m1.1.1.2.3.cmml" xref="alg2.l1.m1.1.1.2.3">0</cn></apply><ci id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">w^{0}\leftarrow w</annotation></semantics></math>, <math id="alg2.l1.m2.1" class="ltx_Math" alttext="c_{i}^{0}\leftarrow 0" display="inline"><semantics id="alg2.l1.m2.1a"><mrow id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><msubsup id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml"><mi id="alg2.l1.m2.1.1.2.2.2" xref="alg2.l1.m2.1.1.2.2.2.cmml">c</mi><mi id="alg2.l1.m2.1.1.2.2.3" xref="alg2.l1.m2.1.1.2.2.3.cmml">i</mi><mn id="alg2.l1.m2.1.1.2.3" xref="alg2.l1.m2.1.1.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="alg2.l1.m2.1.1.1" xref="alg2.l1.m2.1.1.1.cmml">←</mo><mn id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><ci id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1.1">←</ci><apply id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.2.1.cmml" xref="alg2.l1.m2.1.1.2">superscript</csymbol><apply id="alg2.l1.m2.1.1.2.2.cmml" xref="alg2.l1.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.2.2.1.cmml" xref="alg2.l1.m2.1.1.2">subscript</csymbol><ci id="alg2.l1.m2.1.1.2.2.2.cmml" xref="alg2.l1.m2.1.1.2.2.2">𝑐</ci><ci id="alg2.l1.m2.1.1.2.2.3.cmml" xref="alg2.l1.m2.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l1.m2.1.1.2.3.cmml" xref="alg2.l1.m2.1.1.2.3">0</cn></apply><cn type="integer" id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">c_{i}^{0}\leftarrow 0</annotation></semantics></math>, <math id="alg2.l1.m3.1" class="ltx_Math" alttext="c_{g}^{0}\leftarrow 0" display="inline"><semantics id="alg2.l1.m3.1a"><mrow id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml"><msubsup id="alg2.l1.m3.1.1.2" xref="alg2.l1.m3.1.1.2.cmml"><mi id="alg2.l1.m3.1.1.2.2.2" xref="alg2.l1.m3.1.1.2.2.2.cmml">c</mi><mi id="alg2.l1.m3.1.1.2.2.3" xref="alg2.l1.m3.1.1.2.2.3.cmml">g</mi><mn id="alg2.l1.m3.1.1.2.3" xref="alg2.l1.m3.1.1.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="alg2.l1.m3.1.1.1" xref="alg2.l1.m3.1.1.1.cmml">←</mo><mn id="alg2.l1.m3.1.1.3" xref="alg2.l1.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1"><ci id="alg2.l1.m3.1.1.1.cmml" xref="alg2.l1.m3.1.1.1">←</ci><apply id="alg2.l1.m3.1.1.2.cmml" xref="alg2.l1.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m3.1.1.2.1.cmml" xref="alg2.l1.m3.1.1.2">superscript</csymbol><apply id="alg2.l1.m3.1.1.2.2.cmml" xref="alg2.l1.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m3.1.1.2.2.1.cmml" xref="alg2.l1.m3.1.1.2">subscript</csymbol><ci id="alg2.l1.m3.1.1.2.2.2.cmml" xref="alg2.l1.m3.1.1.2.2.2">𝑐</ci><ci id="alg2.l1.m3.1.1.2.2.3.cmml" xref="alg2.l1.m3.1.1.2.2.3">𝑔</ci></apply><cn type="integer" id="alg2.l1.m3.1.1.2.3.cmml" xref="alg2.l1.m3.1.1.2.3">0</cn></apply><cn type="integer" id="alg2.l1.m3.1.1.3.cmml" xref="alg2.l1.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">c_{g}^{0}\leftarrow 0</annotation></semantics></math>, <math id="alg2.l1.m4.1" class="ltx_Math" alttext="m_{i}^{0}\leftarrow 0" display="inline"><semantics id="alg2.l1.m4.1a"><mrow id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml"><msubsup id="alg2.l1.m4.1.1.2" xref="alg2.l1.m4.1.1.2.cmml"><mi id="alg2.l1.m4.1.1.2.2.2" xref="alg2.l1.m4.1.1.2.2.2.cmml">m</mi><mi id="alg2.l1.m4.1.1.2.2.3" xref="alg2.l1.m4.1.1.2.2.3.cmml">i</mi><mn id="alg2.l1.m4.1.1.2.3" xref="alg2.l1.m4.1.1.2.3.cmml">0</mn></msubsup><mo stretchy="false" id="alg2.l1.m4.1.1.1" xref="alg2.l1.m4.1.1.1.cmml">←</mo><mn id="alg2.l1.m4.1.1.3" xref="alg2.l1.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><apply id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1"><ci id="alg2.l1.m4.1.1.1.cmml" xref="alg2.l1.m4.1.1.1">←</ci><apply id="alg2.l1.m4.1.1.2.cmml" xref="alg2.l1.m4.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m4.1.1.2.1.cmml" xref="alg2.l1.m4.1.1.2">superscript</csymbol><apply id="alg2.l1.m4.1.1.2.2.cmml" xref="alg2.l1.m4.1.1.2"><csymbol cd="ambiguous" id="alg2.l1.m4.1.1.2.2.1.cmml" xref="alg2.l1.m4.1.1.2">subscript</csymbol><ci id="alg2.l1.m4.1.1.2.2.2.cmml" xref="alg2.l1.m4.1.1.2.2.2">𝑚</ci><ci id="alg2.l1.m4.1.1.2.2.3.cmml" xref="alg2.l1.m4.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l1.m4.1.1.2.3.cmml" xref="alg2.l1.m4.1.1.2.3">0</cn></apply><cn type="integer" id="alg2.l1.m4.1.1.3.cmml" xref="alg2.l1.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">m_{i}^{0}\leftarrow 0</annotation></semantics></math>, <math id="alg2.l1.m5.1" class="ltx_Math" alttext="\forall~{}i\in M" display="inline"><semantics id="alg2.l1.m5.1a"><mrow id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml"><mrow id="alg2.l1.m5.1.1.2" xref="alg2.l1.m5.1.1.2.cmml"><mo rspace="0.497em" id="alg2.l1.m5.1.1.2.1" xref="alg2.l1.m5.1.1.2.1.cmml">∀</mo><mi id="alg2.l1.m5.1.1.2.2" xref="alg2.l1.m5.1.1.2.2.cmml">i</mi></mrow><mo id="alg2.l1.m5.1.1.1" xref="alg2.l1.m5.1.1.1.cmml">∈</mo><mi id="alg2.l1.m5.1.1.3" xref="alg2.l1.m5.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><apply id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1"><in id="alg2.l1.m5.1.1.1.cmml" xref="alg2.l1.m5.1.1.1"></in><apply id="alg2.l1.m5.1.1.2.cmml" xref="alg2.l1.m5.1.1.2"><csymbol cd="latexml" id="alg2.l1.m5.1.1.2.1.cmml" xref="alg2.l1.m5.1.1.2.1">for-all</csymbol><ci id="alg2.l1.m5.1.1.2.2.cmml" xref="alg2.l1.m5.1.1.2.2">𝑖</ci></apply><ci id="alg2.l1.m5.1.1.3.cmml" xref="alg2.l1.m5.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">\forall~{}i\in M</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span id="alg2.l2.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l2.m1.3" class="ltx_Math" alttext="r=1,\cdots,R" display="inline"><semantics id="alg2.l2.m1.3a"><mrow id="alg2.l2.m1.3.4" xref="alg2.l2.m1.3.4.cmml"><mi id="alg2.l2.m1.3.4.2" xref="alg2.l2.m1.3.4.2.cmml">r</mi><mo id="alg2.l2.m1.3.4.1" xref="alg2.l2.m1.3.4.1.cmml">=</mo><mrow id="alg2.l2.m1.3.4.3.2" xref="alg2.l2.m1.3.4.3.1.cmml"><mn id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">1</mn><mo id="alg2.l2.m1.3.4.3.2.1" xref="alg2.l2.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l2.m1.2.2" xref="alg2.l2.m1.2.2.cmml">⋯</mi><mo id="alg2.l2.m1.3.4.3.2.2" xref="alg2.l2.m1.3.4.3.1.cmml">,</mo><mi id="alg2.l2.m1.3.3" xref="alg2.l2.m1.3.3.cmml">R</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.3b"><apply id="alg2.l2.m1.3.4.cmml" xref="alg2.l2.m1.3.4"><eq id="alg2.l2.m1.3.4.1.cmml" xref="alg2.l2.m1.3.4.1"></eq><ci id="alg2.l2.m1.3.4.2.cmml" xref="alg2.l2.m1.3.4.2">𝑟</ci><list id="alg2.l2.m1.3.4.3.1.cmml" xref="alg2.l2.m1.3.4.3.2"><cn type="integer" id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">1</cn><ci id="alg2.l2.m1.2.2.cmml" xref="alg2.l2.m1.2.2">⋯</ci><ci id="alg2.l2.m1.3.3.cmml" xref="alg2.l2.m1.3.3">𝑅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.3c">r=1,\cdots,R</annotation></semantics></math> <span id="alg2.l2.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>     Randomly sample a subset <math id="alg2.l3.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg2.l3.m1.1a"><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">S</annotation></semantics></math> of devices <math id="alg2.l3.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg2.l3.m2.1a"><mi id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><ci id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">M</annotation></semantics></math> 

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span id="alg2.l4.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l4.m1.1" class="ltx_Math" alttext="i\in S" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">i</mi><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">∈</mo><mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><in id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></in><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑖</ci><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">i\in S</annotation></semantics></math> (on each device) <span id="alg2.l4.2" class="ltx_text ltx_font_bold">do</span>

 

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>        <math id="alg2.l5.m1.2" class="ltx_Math" alttext="w_{i}^{r,0}\leftarrow w^{r-1}" display="inline"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2.3" xref="alg2.l5.m1.2.3.cmml"><msubsup id="alg2.l5.m1.2.3.2" xref="alg2.l5.m1.2.3.2.cmml"><mi id="alg2.l5.m1.2.3.2.2.2" xref="alg2.l5.m1.2.3.2.2.2.cmml">w</mi><mi id="alg2.l5.m1.2.3.2.2.3" xref="alg2.l5.m1.2.3.2.2.3.cmml">i</mi><mrow id="alg2.l5.m1.2.2.2.4" xref="alg2.l5.m1.2.2.2.3.cmml"><mi id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.cmml">r</mi><mo id="alg2.l5.m1.2.2.2.4.1" xref="alg2.l5.m1.2.2.2.3.cmml">,</mo><mn id="alg2.l5.m1.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.cmml">0</mn></mrow></msubsup><mo stretchy="false" id="alg2.l5.m1.2.3.1" xref="alg2.l5.m1.2.3.1.cmml">←</mo><msup id="alg2.l5.m1.2.3.3" xref="alg2.l5.m1.2.3.3.cmml"><mi id="alg2.l5.m1.2.3.3.2" xref="alg2.l5.m1.2.3.3.2.cmml">w</mi><mrow id="alg2.l5.m1.2.3.3.3" xref="alg2.l5.m1.2.3.3.3.cmml"><mi id="alg2.l5.m1.2.3.3.3.2" xref="alg2.l5.m1.2.3.3.3.2.cmml">r</mi><mo id="alg2.l5.m1.2.3.3.3.1" xref="alg2.l5.m1.2.3.3.3.1.cmml">−</mo><mn id="alg2.l5.m1.2.3.3.3.3" xref="alg2.l5.m1.2.3.3.3.3.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.3.cmml" xref="alg2.l5.m1.2.3"><ci id="alg2.l5.m1.2.3.1.cmml" xref="alg2.l5.m1.2.3.1">←</ci><apply id="alg2.l5.m1.2.3.2.cmml" xref="alg2.l5.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.3.2.1.cmml" xref="alg2.l5.m1.2.3.2">superscript</csymbol><apply id="alg2.l5.m1.2.3.2.2.cmml" xref="alg2.l5.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.3.2.2.1.cmml" xref="alg2.l5.m1.2.3.2">subscript</csymbol><ci id="alg2.l5.m1.2.3.2.2.2.cmml" xref="alg2.l5.m1.2.3.2.2.2">𝑤</ci><ci id="alg2.l5.m1.2.3.2.2.3.cmml" xref="alg2.l5.m1.2.3.2.2.3">𝑖</ci></apply><list id="alg2.l5.m1.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.4"><ci id="alg2.l5.m1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1">𝑟</ci><cn type="integer" id="alg2.l5.m1.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2">0</cn></list></apply><apply id="alg2.l5.m1.2.3.3.cmml" xref="alg2.l5.m1.2.3.3"><csymbol cd="ambiguous" id="alg2.l5.m1.2.3.3.1.cmml" xref="alg2.l5.m1.2.3.3">superscript</csymbol><ci id="alg2.l5.m1.2.3.3.2.cmml" xref="alg2.l5.m1.2.3.3.2">𝑤</ci><apply id="alg2.l5.m1.2.3.3.3.cmml" xref="alg2.l5.m1.2.3.3.3"><minus id="alg2.l5.m1.2.3.3.3.1.cmml" xref="alg2.l5.m1.2.3.3.3.1"></minus><ci id="alg2.l5.m1.2.3.3.3.2.cmml" xref="alg2.l5.m1.2.3.3.3.2">𝑟</ci><cn type="integer" id="alg2.l5.m1.2.3.3.3.3.cmml" xref="alg2.l5.m1.2.3.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">w_{i}^{r,0}\leftarrow w^{r-1}</annotation></semantics></math>, <math id="alg2.l5.m2.2" class="ltx_Math" alttext="m_{i}^{r,0}\leftarrow 0" display="inline"><semantics id="alg2.l5.m2.2a"><mrow id="alg2.l5.m2.2.3" xref="alg2.l5.m2.2.3.cmml"><msubsup id="alg2.l5.m2.2.3.2" xref="alg2.l5.m2.2.3.2.cmml"><mi id="alg2.l5.m2.2.3.2.2.2" xref="alg2.l5.m2.2.3.2.2.2.cmml">m</mi><mi id="alg2.l5.m2.2.3.2.2.3" xref="alg2.l5.m2.2.3.2.2.3.cmml">i</mi><mrow id="alg2.l5.m2.2.2.2.4" xref="alg2.l5.m2.2.2.2.3.cmml"><mi id="alg2.l5.m2.1.1.1.1" xref="alg2.l5.m2.1.1.1.1.cmml">r</mi><mo id="alg2.l5.m2.2.2.2.4.1" xref="alg2.l5.m2.2.2.2.3.cmml">,</mo><mn id="alg2.l5.m2.2.2.2.2" xref="alg2.l5.m2.2.2.2.2.cmml">0</mn></mrow></msubsup><mo stretchy="false" id="alg2.l5.m2.2.3.1" xref="alg2.l5.m2.2.3.1.cmml">←</mo><mn id="alg2.l5.m2.2.3.3" xref="alg2.l5.m2.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.2b"><apply id="alg2.l5.m2.2.3.cmml" xref="alg2.l5.m2.2.3"><ci id="alg2.l5.m2.2.3.1.cmml" xref="alg2.l5.m2.2.3.1">←</ci><apply id="alg2.l5.m2.2.3.2.cmml" xref="alg2.l5.m2.2.3.2"><csymbol cd="ambiguous" id="alg2.l5.m2.2.3.2.1.cmml" xref="alg2.l5.m2.2.3.2">superscript</csymbol><apply id="alg2.l5.m2.2.3.2.2.cmml" xref="alg2.l5.m2.2.3.2"><csymbol cd="ambiguous" id="alg2.l5.m2.2.3.2.2.1.cmml" xref="alg2.l5.m2.2.3.2">subscript</csymbol><ci id="alg2.l5.m2.2.3.2.2.2.cmml" xref="alg2.l5.m2.2.3.2.2.2">𝑚</ci><ci id="alg2.l5.m2.2.3.2.2.3.cmml" xref="alg2.l5.m2.2.3.2.2.3">𝑖</ci></apply><list id="alg2.l5.m2.2.2.2.3.cmml" xref="alg2.l5.m2.2.2.2.4"><ci id="alg2.l5.m2.1.1.1.1.cmml" xref="alg2.l5.m2.1.1.1.1">𝑟</ci><cn type="integer" id="alg2.l5.m2.2.2.2.2.cmml" xref="alg2.l5.m2.2.2.2.2">0</cn></list></apply><cn type="integer" id="alg2.l5.m2.2.3.3.cmml" xref="alg2.l5.m2.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.2c">m_{i}^{r,0}\leftarrow 0</annotation></semantics></math>, <math id="alg2.l5.m3.2" class="ltx_Math" alttext="v_{i}^{r,0}\leftarrow 0" display="inline"><semantics id="alg2.l5.m3.2a"><mrow id="alg2.l5.m3.2.3" xref="alg2.l5.m3.2.3.cmml"><msubsup id="alg2.l5.m3.2.3.2" xref="alg2.l5.m3.2.3.2.cmml"><mi id="alg2.l5.m3.2.3.2.2.2" xref="alg2.l5.m3.2.3.2.2.2.cmml">v</mi><mi id="alg2.l5.m3.2.3.2.2.3" xref="alg2.l5.m3.2.3.2.2.3.cmml">i</mi><mrow id="alg2.l5.m3.2.2.2.4" xref="alg2.l5.m3.2.2.2.3.cmml"><mi id="alg2.l5.m3.1.1.1.1" xref="alg2.l5.m3.1.1.1.1.cmml">r</mi><mo id="alg2.l5.m3.2.2.2.4.1" xref="alg2.l5.m3.2.2.2.3.cmml">,</mo><mn id="alg2.l5.m3.2.2.2.2" xref="alg2.l5.m3.2.2.2.2.cmml">0</mn></mrow></msubsup><mo stretchy="false" id="alg2.l5.m3.2.3.1" xref="alg2.l5.m3.2.3.1.cmml">←</mo><mn id="alg2.l5.m3.2.3.3" xref="alg2.l5.m3.2.3.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m3.2b"><apply id="alg2.l5.m3.2.3.cmml" xref="alg2.l5.m3.2.3"><ci id="alg2.l5.m3.2.3.1.cmml" xref="alg2.l5.m3.2.3.1">←</ci><apply id="alg2.l5.m3.2.3.2.cmml" xref="alg2.l5.m3.2.3.2"><csymbol cd="ambiguous" id="alg2.l5.m3.2.3.2.1.cmml" xref="alg2.l5.m3.2.3.2">superscript</csymbol><apply id="alg2.l5.m3.2.3.2.2.cmml" xref="alg2.l5.m3.2.3.2"><csymbol cd="ambiguous" id="alg2.l5.m3.2.3.2.2.1.cmml" xref="alg2.l5.m3.2.3.2">subscript</csymbol><ci id="alg2.l5.m3.2.3.2.2.2.cmml" xref="alg2.l5.m3.2.3.2.2.2">𝑣</ci><ci id="alg2.l5.m3.2.3.2.2.3.cmml" xref="alg2.l5.m3.2.3.2.2.3">𝑖</ci></apply><list id="alg2.l5.m3.2.2.2.3.cmml" xref="alg2.l5.m3.2.2.2.4"><ci id="alg2.l5.m3.1.1.1.1.cmml" xref="alg2.l5.m3.1.1.1.1">𝑟</ci><cn type="integer" id="alg2.l5.m3.2.2.2.2.cmml" xref="alg2.l5.m3.2.2.2.2">0</cn></list></apply><cn type="integer" id="alg2.l5.m3.2.3.3.cmml" xref="alg2.l5.m3.2.3.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m3.2c">v_{i}^{r,0}\leftarrow 0</annotation></semantics></math> 

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>        <span id="alg2.l6.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l6.m1.4" class="ltx_Math" alttext="t=1,2,\cdots,T_{i}" display="inline"><semantics id="alg2.l6.m1.4a"><mrow id="alg2.l6.m1.4.4" xref="alg2.l6.m1.4.4.cmml"><mi id="alg2.l6.m1.4.4.3" xref="alg2.l6.m1.4.4.3.cmml">t</mi><mo id="alg2.l6.m1.4.4.2" xref="alg2.l6.m1.4.4.2.cmml">=</mo><mrow id="alg2.l6.m1.4.4.1.1" xref="alg2.l6.m1.4.4.1.2.cmml"><mn id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">1</mn><mo id="alg2.l6.m1.4.4.1.1.2" xref="alg2.l6.m1.4.4.1.2.cmml">,</mo><mn id="alg2.l6.m1.2.2" xref="alg2.l6.m1.2.2.cmml">2</mn><mo id="alg2.l6.m1.4.4.1.1.3" xref="alg2.l6.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg2.l6.m1.3.3" xref="alg2.l6.m1.3.3.cmml">⋯</mi><mo id="alg2.l6.m1.4.4.1.1.4" xref="alg2.l6.m1.4.4.1.2.cmml">,</mo><msub id="alg2.l6.m1.4.4.1.1.1" xref="alg2.l6.m1.4.4.1.1.1.cmml"><mi id="alg2.l6.m1.4.4.1.1.1.2" xref="alg2.l6.m1.4.4.1.1.1.2.cmml">T</mi><mi id="alg2.l6.m1.4.4.1.1.1.3" xref="alg2.l6.m1.4.4.1.1.1.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.4b"><apply id="alg2.l6.m1.4.4.cmml" xref="alg2.l6.m1.4.4"><eq id="alg2.l6.m1.4.4.2.cmml" xref="alg2.l6.m1.4.4.2"></eq><ci id="alg2.l6.m1.4.4.3.cmml" xref="alg2.l6.m1.4.4.3">𝑡</ci><list id="alg2.l6.m1.4.4.1.2.cmml" xref="alg2.l6.m1.4.4.1.1"><cn type="integer" id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">1</cn><cn type="integer" id="alg2.l6.m1.2.2.cmml" xref="alg2.l6.m1.2.2">2</cn><ci id="alg2.l6.m1.3.3.cmml" xref="alg2.l6.m1.3.3">⋯</ci><apply id="alg2.l6.m1.4.4.1.1.1.cmml" xref="alg2.l6.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.4.4.1.1.1.1.cmml" xref="alg2.l6.m1.4.4.1.1.1">subscript</csymbol><ci id="alg2.l6.m1.4.4.1.1.1.2.cmml" xref="alg2.l6.m1.4.4.1.1.1.2">𝑇</ci><ci id="alg2.l6.m1.4.4.1.1.1.3.cmml" xref="alg2.l6.m1.4.4.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.4c">t=1,2,\cdots,T_{i}</annotation></semantics></math> <span id="alg2.l6.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>           <math id="alg2.l7.m1.7" class="ltx_Math" alttext="g_{i}^{r,t}\leftarrow\triangledown_{w_{i}^{r,t-1}}F_{i}(w_{i}^{r,t-1})" display="inline"><semantics id="alg2.l7.m1.7a"><mrow id="alg2.l7.m1.7.7" xref="alg2.l7.m1.7.7.cmml"><msubsup id="alg2.l7.m1.7.7.3" xref="alg2.l7.m1.7.7.3.cmml"><mi id="alg2.l7.m1.7.7.3.2.2" xref="alg2.l7.m1.7.7.3.2.2.cmml">g</mi><mi id="alg2.l7.m1.7.7.3.2.3" xref="alg2.l7.m1.7.7.3.2.3.cmml">i</mi><mrow id="alg2.l7.m1.2.2.2.4" xref="alg2.l7.m1.2.2.2.3.cmml"><mi id="alg2.l7.m1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.cmml">r</mi><mo id="alg2.l7.m1.2.2.2.4.1" xref="alg2.l7.m1.2.2.2.3.cmml">,</mo><mi id="alg2.l7.m1.2.2.2.2" xref="alg2.l7.m1.2.2.2.2.cmml">t</mi></mrow></msubsup><mo stretchy="false" id="alg2.l7.m1.7.7.2" xref="alg2.l7.m1.7.7.2.cmml">←</mo><mrow id="alg2.l7.m1.7.7.1" xref="alg2.l7.m1.7.7.1.cmml"><msub id="alg2.l7.m1.7.7.1.3" xref="alg2.l7.m1.7.7.1.3.cmml"><mi mathvariant="normal" id="alg2.l7.m1.7.7.1.3.2" xref="alg2.l7.m1.7.7.1.3.2.cmml">▽</mi><msubsup id="alg2.l7.m1.4.4.2" xref="alg2.l7.m1.4.4.2.cmml"><mi id="alg2.l7.m1.4.4.2.4.2" xref="alg2.l7.m1.4.4.2.4.2.cmml">w</mi><mi id="alg2.l7.m1.4.4.2.4.3" xref="alg2.l7.m1.4.4.2.4.3.cmml">i</mi><mrow id="alg2.l7.m1.4.4.2.2.2.2" xref="alg2.l7.m1.4.4.2.2.2.3.cmml"><mi id="alg2.l7.m1.3.3.1.1.1.1" xref="alg2.l7.m1.3.3.1.1.1.1.cmml">r</mi><mo id="alg2.l7.m1.4.4.2.2.2.2.2" xref="alg2.l7.m1.4.4.2.2.2.3.cmml">,</mo><mrow id="alg2.l7.m1.4.4.2.2.2.2.1" xref="alg2.l7.m1.4.4.2.2.2.2.1.cmml"><mi id="alg2.l7.m1.4.4.2.2.2.2.1.2" xref="alg2.l7.m1.4.4.2.2.2.2.1.2.cmml">t</mi><mo id="alg2.l7.m1.4.4.2.2.2.2.1.1" xref="alg2.l7.m1.4.4.2.2.2.2.1.1.cmml">−</mo><mn id="alg2.l7.m1.4.4.2.2.2.2.1.3" xref="alg2.l7.m1.4.4.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m1.7.7.1.2" xref="alg2.l7.m1.7.7.1.2.cmml">​</mo><msub id="alg2.l7.m1.7.7.1.4" xref="alg2.l7.m1.7.7.1.4.cmml"><mi id="alg2.l7.m1.7.7.1.4.2" xref="alg2.l7.m1.7.7.1.4.2.cmml">F</mi><mi id="alg2.l7.m1.7.7.1.4.3" xref="alg2.l7.m1.7.7.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m1.7.7.1.2a" xref="alg2.l7.m1.7.7.1.2.cmml">​</mo><mrow id="alg2.l7.m1.7.7.1.1.1" xref="alg2.l7.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l7.m1.7.7.1.1.1.2" xref="alg2.l7.m1.7.7.1.1.1.1.cmml">(</mo><msubsup id="alg2.l7.m1.7.7.1.1.1.1" xref="alg2.l7.m1.7.7.1.1.1.1.cmml"><mi id="alg2.l7.m1.7.7.1.1.1.1.2.2" xref="alg2.l7.m1.7.7.1.1.1.1.2.2.cmml">w</mi><mi id="alg2.l7.m1.7.7.1.1.1.1.2.3" xref="alg2.l7.m1.7.7.1.1.1.1.2.3.cmml">i</mi><mrow id="alg2.l7.m1.6.6.2.2" xref="alg2.l7.m1.6.6.2.3.cmml"><mi id="alg2.l7.m1.5.5.1.1" xref="alg2.l7.m1.5.5.1.1.cmml">r</mi><mo id="alg2.l7.m1.6.6.2.2.2" xref="alg2.l7.m1.6.6.2.3.cmml">,</mo><mrow id="alg2.l7.m1.6.6.2.2.1" xref="alg2.l7.m1.6.6.2.2.1.cmml"><mi id="alg2.l7.m1.6.6.2.2.1.2" xref="alg2.l7.m1.6.6.2.2.1.2.cmml">t</mi><mo id="alg2.l7.m1.6.6.2.2.1.1" xref="alg2.l7.m1.6.6.2.2.1.1.cmml">−</mo><mn id="alg2.l7.m1.6.6.2.2.1.3" xref="alg2.l7.m1.6.6.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><mo stretchy="false" id="alg2.l7.m1.7.7.1.1.1.3" xref="alg2.l7.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.7b"><apply id="alg2.l7.m1.7.7.cmml" xref="alg2.l7.m1.7.7"><ci id="alg2.l7.m1.7.7.2.cmml" xref="alg2.l7.m1.7.7.2">←</ci><apply id="alg2.l7.m1.7.7.3.cmml" xref="alg2.l7.m1.7.7.3"><csymbol cd="ambiguous" id="alg2.l7.m1.7.7.3.1.cmml" xref="alg2.l7.m1.7.7.3">superscript</csymbol><apply id="alg2.l7.m1.7.7.3.2.cmml" xref="alg2.l7.m1.7.7.3"><csymbol cd="ambiguous" id="alg2.l7.m1.7.7.3.2.1.cmml" xref="alg2.l7.m1.7.7.3">subscript</csymbol><ci id="alg2.l7.m1.7.7.3.2.2.cmml" xref="alg2.l7.m1.7.7.3.2.2">𝑔</ci><ci id="alg2.l7.m1.7.7.3.2.3.cmml" xref="alg2.l7.m1.7.7.3.2.3">𝑖</ci></apply><list id="alg2.l7.m1.2.2.2.3.cmml" xref="alg2.l7.m1.2.2.2.4"><ci id="alg2.l7.m1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1">𝑟</ci><ci id="alg2.l7.m1.2.2.2.2.cmml" xref="alg2.l7.m1.2.2.2.2">𝑡</ci></list></apply><apply id="alg2.l7.m1.7.7.1.cmml" xref="alg2.l7.m1.7.7.1"><times id="alg2.l7.m1.7.7.1.2.cmml" xref="alg2.l7.m1.7.7.1.2"></times><apply id="alg2.l7.m1.7.7.1.3.cmml" xref="alg2.l7.m1.7.7.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.7.7.1.3.1.cmml" xref="alg2.l7.m1.7.7.1.3">subscript</csymbol><ci id="alg2.l7.m1.7.7.1.3.2.cmml" xref="alg2.l7.m1.7.7.1.3.2">▽</ci><apply id="alg2.l7.m1.4.4.2.cmml" xref="alg2.l7.m1.4.4.2"><csymbol cd="ambiguous" id="alg2.l7.m1.4.4.2.3.cmml" xref="alg2.l7.m1.4.4.2">superscript</csymbol><apply id="alg2.l7.m1.4.4.2.4.cmml" xref="alg2.l7.m1.4.4.2"><csymbol cd="ambiguous" id="alg2.l7.m1.4.4.2.4.1.cmml" xref="alg2.l7.m1.4.4.2">subscript</csymbol><ci id="alg2.l7.m1.4.4.2.4.2.cmml" xref="alg2.l7.m1.4.4.2.4.2">𝑤</ci><ci id="alg2.l7.m1.4.4.2.4.3.cmml" xref="alg2.l7.m1.4.4.2.4.3">𝑖</ci></apply><list id="alg2.l7.m1.4.4.2.2.2.3.cmml" xref="alg2.l7.m1.4.4.2.2.2.2"><ci id="alg2.l7.m1.3.3.1.1.1.1.cmml" xref="alg2.l7.m1.3.3.1.1.1.1">𝑟</ci><apply id="alg2.l7.m1.4.4.2.2.2.2.1.cmml" xref="alg2.l7.m1.4.4.2.2.2.2.1"><minus id="alg2.l7.m1.4.4.2.2.2.2.1.1.cmml" xref="alg2.l7.m1.4.4.2.2.2.2.1.1"></minus><ci id="alg2.l7.m1.4.4.2.2.2.2.1.2.cmml" xref="alg2.l7.m1.4.4.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg2.l7.m1.4.4.2.2.2.2.1.3.cmml" xref="alg2.l7.m1.4.4.2.2.2.2.1.3">1</cn></apply></list></apply></apply><apply id="alg2.l7.m1.7.7.1.4.cmml" xref="alg2.l7.m1.7.7.1.4"><csymbol cd="ambiguous" id="alg2.l7.m1.7.7.1.4.1.cmml" xref="alg2.l7.m1.7.7.1.4">subscript</csymbol><ci id="alg2.l7.m1.7.7.1.4.2.cmml" xref="alg2.l7.m1.7.7.1.4.2">𝐹</ci><ci id="alg2.l7.m1.7.7.1.4.3.cmml" xref="alg2.l7.m1.7.7.1.4.3">𝑖</ci></apply><apply id="alg2.l7.m1.7.7.1.1.1.1.cmml" xref="alg2.l7.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.7.7.1.1.1.1.1.cmml" xref="alg2.l7.m1.7.7.1.1.1">superscript</csymbol><apply id="alg2.l7.m1.7.7.1.1.1.1.2.cmml" xref="alg2.l7.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.7.7.1.1.1.1.2.1.cmml" xref="alg2.l7.m1.7.7.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.7.7.1.1.1.1.2.2.cmml" xref="alg2.l7.m1.7.7.1.1.1.1.2.2">𝑤</ci><ci id="alg2.l7.m1.7.7.1.1.1.1.2.3.cmml" xref="alg2.l7.m1.7.7.1.1.1.1.2.3">𝑖</ci></apply><list id="alg2.l7.m1.6.6.2.3.cmml" xref="alg2.l7.m1.6.6.2.2"><ci id="alg2.l7.m1.5.5.1.1.cmml" xref="alg2.l7.m1.5.5.1.1">𝑟</ci><apply id="alg2.l7.m1.6.6.2.2.1.cmml" xref="alg2.l7.m1.6.6.2.2.1"><minus id="alg2.l7.m1.6.6.2.2.1.1.cmml" xref="alg2.l7.m1.6.6.2.2.1.1"></minus><ci id="alg2.l7.m1.6.6.2.2.1.2.cmml" xref="alg2.l7.m1.6.6.2.2.1.2">𝑡</ci><cn type="integer" id="alg2.l7.m1.6.6.2.2.1.3.cmml" xref="alg2.l7.m1.6.6.2.2.1.3">1</cn></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.7c">g_{i}^{r,t}\leftarrow\triangledown_{w_{i}^{r,t-1}}F_{i}(w_{i}^{r,t-1})</annotation></semantics></math> 

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>           <math id="alg2.l8.m1.9" class="ltx_Math" alttext="w_{i}^{r,t},m_{i}^{r,t},v_{i}^{r,t}\leftarrow" display="inline"><semantics id="alg2.l8.m1.9a"><mrow id="alg2.l8.m1.9.9" xref="alg2.l8.m1.9.9.cmml"><mrow id="alg2.l8.m1.9.9.3.3" xref="alg2.l8.m1.9.9.3.4.cmml"><msubsup id="alg2.l8.m1.7.7.1.1.1" xref="alg2.l8.m1.7.7.1.1.1.cmml"><mi id="alg2.l8.m1.7.7.1.1.1.2.2" xref="alg2.l8.m1.7.7.1.1.1.2.2.cmml">w</mi><mi id="alg2.l8.m1.7.7.1.1.1.2.3" xref="alg2.l8.m1.7.7.1.1.1.2.3.cmml">i</mi><mrow id="alg2.l8.m1.2.2.2.4" xref="alg2.l8.m1.2.2.2.3.cmml"><mi id="alg2.l8.m1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.cmml">r</mi><mo id="alg2.l8.m1.2.2.2.4.1" xref="alg2.l8.m1.2.2.2.3.cmml">,</mo><mi id="alg2.l8.m1.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.cmml">t</mi></mrow></msubsup><mo id="alg2.l8.m1.9.9.3.3.4" xref="alg2.l8.m1.9.9.3.4.cmml">,</mo><msubsup id="alg2.l8.m1.8.8.2.2.2" xref="alg2.l8.m1.8.8.2.2.2.cmml"><mi id="alg2.l8.m1.8.8.2.2.2.2.2" xref="alg2.l8.m1.8.8.2.2.2.2.2.cmml">m</mi><mi id="alg2.l8.m1.8.8.2.2.2.2.3" xref="alg2.l8.m1.8.8.2.2.2.2.3.cmml">i</mi><mrow id="alg2.l8.m1.4.4.2.4" xref="alg2.l8.m1.4.4.2.3.cmml"><mi id="alg2.l8.m1.3.3.1.1" xref="alg2.l8.m1.3.3.1.1.cmml">r</mi><mo id="alg2.l8.m1.4.4.2.4.1" xref="alg2.l8.m1.4.4.2.3.cmml">,</mo><mi id="alg2.l8.m1.4.4.2.2" xref="alg2.l8.m1.4.4.2.2.cmml">t</mi></mrow></msubsup><mo id="alg2.l8.m1.9.9.3.3.5" xref="alg2.l8.m1.9.9.3.4.cmml">,</mo><msubsup id="alg2.l8.m1.9.9.3.3.3" xref="alg2.l8.m1.9.9.3.3.3.cmml"><mi id="alg2.l8.m1.9.9.3.3.3.2.2" xref="alg2.l8.m1.9.9.3.3.3.2.2.cmml">v</mi><mi id="alg2.l8.m1.9.9.3.3.3.2.3" xref="alg2.l8.m1.9.9.3.3.3.2.3.cmml">i</mi><mrow id="alg2.l8.m1.6.6.2.4" xref="alg2.l8.m1.6.6.2.3.cmml"><mi id="alg2.l8.m1.5.5.1.1" xref="alg2.l8.m1.5.5.1.1.cmml">r</mi><mo id="alg2.l8.m1.6.6.2.4.1" xref="alg2.l8.m1.6.6.2.3.cmml">,</mo><mi id="alg2.l8.m1.6.6.2.2" xref="alg2.l8.m1.6.6.2.2.cmml">t</mi></mrow></msubsup></mrow><mo stretchy="false" id="alg2.l8.m1.9.9.4" xref="alg2.l8.m1.9.9.4.cmml">←</mo><mi id="alg2.l8.m1.9.9.5" xref="alg2.l8.m1.9.9.5.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.9b"><apply id="alg2.l8.m1.9.9.cmml" xref="alg2.l8.m1.9.9"><ci id="alg2.l8.m1.9.9.4.cmml" xref="alg2.l8.m1.9.9.4">←</ci><list id="alg2.l8.m1.9.9.3.4.cmml" xref="alg2.l8.m1.9.9.3.3"><apply id="alg2.l8.m1.7.7.1.1.1.cmml" xref="alg2.l8.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.7.7.1.1.1.1.cmml" xref="alg2.l8.m1.7.7.1.1.1">superscript</csymbol><apply id="alg2.l8.m1.7.7.1.1.1.2.cmml" xref="alg2.l8.m1.7.7.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.7.7.1.1.1.2.1.cmml" xref="alg2.l8.m1.7.7.1.1.1">subscript</csymbol><ci id="alg2.l8.m1.7.7.1.1.1.2.2.cmml" xref="alg2.l8.m1.7.7.1.1.1.2.2">𝑤</ci><ci id="alg2.l8.m1.7.7.1.1.1.2.3.cmml" xref="alg2.l8.m1.7.7.1.1.1.2.3">𝑖</ci></apply><list id="alg2.l8.m1.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.4"><ci id="alg2.l8.m1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1">𝑟</ci><ci id="alg2.l8.m1.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2">𝑡</ci></list></apply><apply id="alg2.l8.m1.8.8.2.2.2.cmml" xref="alg2.l8.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.8.8.2.2.2.1.cmml" xref="alg2.l8.m1.8.8.2.2.2">superscript</csymbol><apply id="alg2.l8.m1.8.8.2.2.2.2.cmml" xref="alg2.l8.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.8.8.2.2.2.2.1.cmml" xref="alg2.l8.m1.8.8.2.2.2">subscript</csymbol><ci id="alg2.l8.m1.8.8.2.2.2.2.2.cmml" xref="alg2.l8.m1.8.8.2.2.2.2.2">𝑚</ci><ci id="alg2.l8.m1.8.8.2.2.2.2.3.cmml" xref="alg2.l8.m1.8.8.2.2.2.2.3">𝑖</ci></apply><list id="alg2.l8.m1.4.4.2.3.cmml" xref="alg2.l8.m1.4.4.2.4"><ci id="alg2.l8.m1.3.3.1.1.cmml" xref="alg2.l8.m1.3.3.1.1">𝑟</ci><ci id="alg2.l8.m1.4.4.2.2.cmml" xref="alg2.l8.m1.4.4.2.2">𝑡</ci></list></apply><apply id="alg2.l8.m1.9.9.3.3.3.cmml" xref="alg2.l8.m1.9.9.3.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.9.9.3.3.3.1.cmml" xref="alg2.l8.m1.9.9.3.3.3">superscript</csymbol><apply id="alg2.l8.m1.9.9.3.3.3.2.cmml" xref="alg2.l8.m1.9.9.3.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.9.9.3.3.3.2.1.cmml" xref="alg2.l8.m1.9.9.3.3.3">subscript</csymbol><ci id="alg2.l8.m1.9.9.3.3.3.2.2.cmml" xref="alg2.l8.m1.9.9.3.3.3.2.2">𝑣</ci><ci id="alg2.l8.m1.9.9.3.3.3.2.3.cmml" xref="alg2.l8.m1.9.9.3.3.3.2.3">𝑖</ci></apply><list id="alg2.l8.m1.6.6.2.3.cmml" xref="alg2.l8.m1.6.6.2.4"><ci id="alg2.l8.m1.5.5.1.1.cmml" xref="alg2.l8.m1.5.5.1.1">𝑟</ci><ci id="alg2.l8.m1.6.6.2.2.cmml" xref="alg2.l8.m1.6.6.2.2">𝑡</ci></list></apply></list><csymbol cd="latexml" id="alg2.l8.m1.9.9.5.cmml" xref="alg2.l8.m1.9.9.5">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.9c">w_{i}^{r,t},m_{i}^{r,t},v_{i}^{r,t}\leftarrow</annotation></semantics></math> Adam update with <math id="alg2.l8.m2.2" class="ltx_Math" alttext="w_{i}^{r,t-1}" display="inline"><semantics id="alg2.l8.m2.2a"><msubsup id="alg2.l8.m2.2.3" xref="alg2.l8.m2.2.3.cmml"><mi id="alg2.l8.m2.2.3.2.2" xref="alg2.l8.m2.2.3.2.2.cmml">w</mi><mi id="alg2.l8.m2.2.3.2.3" xref="alg2.l8.m2.2.3.2.3.cmml">i</mi><mrow id="alg2.l8.m2.2.2.2.2" xref="alg2.l8.m2.2.2.2.3.cmml"><mi id="alg2.l8.m2.1.1.1.1" xref="alg2.l8.m2.1.1.1.1.cmml">r</mi><mo id="alg2.l8.m2.2.2.2.2.2" xref="alg2.l8.m2.2.2.2.3.cmml">,</mo><mrow id="alg2.l8.m2.2.2.2.2.1" xref="alg2.l8.m2.2.2.2.2.1.cmml"><mi id="alg2.l8.m2.2.2.2.2.1.2" xref="alg2.l8.m2.2.2.2.2.1.2.cmml">t</mi><mo id="alg2.l8.m2.2.2.2.2.1.1" xref="alg2.l8.m2.2.2.2.2.1.1.cmml">−</mo><mn id="alg2.l8.m2.2.2.2.2.1.3" xref="alg2.l8.m2.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l8.m2.2b"><apply id="alg2.l8.m2.2.3.cmml" xref="alg2.l8.m2.2.3"><csymbol cd="ambiguous" id="alg2.l8.m2.2.3.1.cmml" xref="alg2.l8.m2.2.3">superscript</csymbol><apply id="alg2.l8.m2.2.3.2.cmml" xref="alg2.l8.m2.2.3"><csymbol cd="ambiguous" id="alg2.l8.m2.2.3.2.1.cmml" xref="alg2.l8.m2.2.3">subscript</csymbol><ci id="alg2.l8.m2.2.3.2.2.cmml" xref="alg2.l8.m2.2.3.2.2">𝑤</ci><ci id="alg2.l8.m2.2.3.2.3.cmml" xref="alg2.l8.m2.2.3.2.3">𝑖</ci></apply><list id="alg2.l8.m2.2.2.2.3.cmml" xref="alg2.l8.m2.2.2.2.2"><ci id="alg2.l8.m2.1.1.1.1.cmml" xref="alg2.l8.m2.1.1.1.1">𝑟</ci><apply id="alg2.l8.m2.2.2.2.2.1.cmml" xref="alg2.l8.m2.2.2.2.2.1"><minus id="alg2.l8.m2.2.2.2.2.1.1.cmml" xref="alg2.l8.m2.2.2.2.2.1.1"></minus><ci id="alg2.l8.m2.2.2.2.2.1.2.cmml" xref="alg2.l8.m2.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg2.l8.m2.2.2.2.2.1.3.cmml" xref="alg2.l8.m2.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m2.2c">w_{i}^{r,t-1}</annotation></semantics></math>, <math id="alg2.l8.m3.2" class="ltx_Math" alttext="m_{i}^{r,t-1}" display="inline"><semantics id="alg2.l8.m3.2a"><msubsup id="alg2.l8.m3.2.3" xref="alg2.l8.m3.2.3.cmml"><mi id="alg2.l8.m3.2.3.2.2" xref="alg2.l8.m3.2.3.2.2.cmml">m</mi><mi id="alg2.l8.m3.2.3.2.3" xref="alg2.l8.m3.2.3.2.3.cmml">i</mi><mrow id="alg2.l8.m3.2.2.2.2" xref="alg2.l8.m3.2.2.2.3.cmml"><mi id="alg2.l8.m3.1.1.1.1" xref="alg2.l8.m3.1.1.1.1.cmml">r</mi><mo id="alg2.l8.m3.2.2.2.2.2" xref="alg2.l8.m3.2.2.2.3.cmml">,</mo><mrow id="alg2.l8.m3.2.2.2.2.1" xref="alg2.l8.m3.2.2.2.2.1.cmml"><mi id="alg2.l8.m3.2.2.2.2.1.2" xref="alg2.l8.m3.2.2.2.2.1.2.cmml">t</mi><mo id="alg2.l8.m3.2.2.2.2.1.1" xref="alg2.l8.m3.2.2.2.2.1.1.cmml">−</mo><mn id="alg2.l8.m3.2.2.2.2.1.3" xref="alg2.l8.m3.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l8.m3.2b"><apply id="alg2.l8.m3.2.3.cmml" xref="alg2.l8.m3.2.3"><csymbol cd="ambiguous" id="alg2.l8.m3.2.3.1.cmml" xref="alg2.l8.m3.2.3">superscript</csymbol><apply id="alg2.l8.m3.2.3.2.cmml" xref="alg2.l8.m3.2.3"><csymbol cd="ambiguous" id="alg2.l8.m3.2.3.2.1.cmml" xref="alg2.l8.m3.2.3">subscript</csymbol><ci id="alg2.l8.m3.2.3.2.2.cmml" xref="alg2.l8.m3.2.3.2.2">𝑚</ci><ci id="alg2.l8.m3.2.3.2.3.cmml" xref="alg2.l8.m3.2.3.2.3">𝑖</ci></apply><list id="alg2.l8.m3.2.2.2.3.cmml" xref="alg2.l8.m3.2.2.2.2"><ci id="alg2.l8.m3.1.1.1.1.cmml" xref="alg2.l8.m3.1.1.1.1">𝑟</ci><apply id="alg2.l8.m3.2.2.2.2.1.cmml" xref="alg2.l8.m3.2.2.2.2.1"><minus id="alg2.l8.m3.2.2.2.2.1.1.cmml" xref="alg2.l8.m3.2.2.2.2.1.1"></minus><ci id="alg2.l8.m3.2.2.2.2.1.2.cmml" xref="alg2.l8.m3.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg2.l8.m3.2.2.2.2.1.3.cmml" xref="alg2.l8.m3.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m3.2c">m_{i}^{r,t-1}</annotation></semantics></math>, <math id="alg2.l8.m4.2" class="ltx_Math" alttext="v_{i}^{r,t-1}" display="inline"><semantics id="alg2.l8.m4.2a"><msubsup id="alg2.l8.m4.2.3" xref="alg2.l8.m4.2.3.cmml"><mi id="alg2.l8.m4.2.3.2.2" xref="alg2.l8.m4.2.3.2.2.cmml">v</mi><mi id="alg2.l8.m4.2.3.2.3" xref="alg2.l8.m4.2.3.2.3.cmml">i</mi><mrow id="alg2.l8.m4.2.2.2.2" xref="alg2.l8.m4.2.2.2.3.cmml"><mi id="alg2.l8.m4.1.1.1.1" xref="alg2.l8.m4.1.1.1.1.cmml">r</mi><mo id="alg2.l8.m4.2.2.2.2.2" xref="alg2.l8.m4.2.2.2.3.cmml">,</mo><mrow id="alg2.l8.m4.2.2.2.2.1" xref="alg2.l8.m4.2.2.2.2.1.cmml"><mi id="alg2.l8.m4.2.2.2.2.1.2" xref="alg2.l8.m4.2.2.2.2.1.2.cmml">t</mi><mo id="alg2.l8.m4.2.2.2.2.1.1" xref="alg2.l8.m4.2.2.2.2.1.1.cmml">−</mo><mn id="alg2.l8.m4.2.2.2.2.1.3" xref="alg2.l8.m4.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l8.m4.2b"><apply id="alg2.l8.m4.2.3.cmml" xref="alg2.l8.m4.2.3"><csymbol cd="ambiguous" id="alg2.l8.m4.2.3.1.cmml" xref="alg2.l8.m4.2.3">superscript</csymbol><apply id="alg2.l8.m4.2.3.2.cmml" xref="alg2.l8.m4.2.3"><csymbol cd="ambiguous" id="alg2.l8.m4.2.3.2.1.cmml" xref="alg2.l8.m4.2.3">subscript</csymbol><ci id="alg2.l8.m4.2.3.2.2.cmml" xref="alg2.l8.m4.2.3.2.2">𝑣</ci><ci id="alg2.l8.m4.2.3.2.3.cmml" xref="alg2.l8.m4.2.3.2.3">𝑖</ci></apply><list id="alg2.l8.m4.2.2.2.3.cmml" xref="alg2.l8.m4.2.2.2.2"><ci id="alg2.l8.m4.1.1.1.1.cmml" xref="alg2.l8.m4.1.1.1.1">𝑟</ci><apply id="alg2.l8.m4.2.2.2.2.1.cmml" xref="alg2.l8.m4.2.2.2.2.1"><minus id="alg2.l8.m4.2.2.2.2.1.1.cmml" xref="alg2.l8.m4.2.2.2.2.1.1"></minus><ci id="alg2.l8.m4.2.2.2.2.1.2.cmml" xref="alg2.l8.m4.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg2.l8.m4.2.2.2.2.1.3.cmml" xref="alg2.l8.m4.2.2.2.2.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m4.2c">v_{i}^{r,t-1}</annotation></semantics></math>, and <math id="alg2.l8.m5.2" class="ltx_Math" alttext="g_{i}^{r,t}" display="inline"><semantics id="alg2.l8.m5.2a"><msubsup id="alg2.l8.m5.2.3" xref="alg2.l8.m5.2.3.cmml"><mi id="alg2.l8.m5.2.3.2.2" xref="alg2.l8.m5.2.3.2.2.cmml">g</mi><mi id="alg2.l8.m5.2.3.2.3" xref="alg2.l8.m5.2.3.2.3.cmml">i</mi><mrow id="alg2.l8.m5.2.2.2.4" xref="alg2.l8.m5.2.2.2.3.cmml"><mi id="alg2.l8.m5.1.1.1.1" xref="alg2.l8.m5.1.1.1.1.cmml">r</mi><mo id="alg2.l8.m5.2.2.2.4.1" xref="alg2.l8.m5.2.2.2.3.cmml">,</mo><mi id="alg2.l8.m5.2.2.2.2" xref="alg2.l8.m5.2.2.2.2.cmml">t</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l8.m5.2b"><apply id="alg2.l8.m5.2.3.cmml" xref="alg2.l8.m5.2.3"><csymbol cd="ambiguous" id="alg2.l8.m5.2.3.1.cmml" xref="alg2.l8.m5.2.3">superscript</csymbol><apply id="alg2.l8.m5.2.3.2.cmml" xref="alg2.l8.m5.2.3"><csymbol cd="ambiguous" id="alg2.l8.m5.2.3.2.1.cmml" xref="alg2.l8.m5.2.3">subscript</csymbol><ci id="alg2.l8.m5.2.3.2.2.cmml" xref="alg2.l8.m5.2.3.2.2">𝑔</ci><ci id="alg2.l8.m5.2.3.2.3.cmml" xref="alg2.l8.m5.2.3.2.3">𝑖</ci></apply><list id="alg2.l8.m5.2.2.2.3.cmml" xref="alg2.l8.m5.2.2.2.4"><ci id="alg2.l8.m5.1.1.1.1.cmml" xref="alg2.l8.m5.1.1.1.1">𝑟</ci><ci id="alg2.l8.m5.2.2.2.2.cmml" xref="alg2.l8.m5.2.2.2.2">𝑡</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m5.2c">g_{i}^{r,t}</annotation></semantics></math> 

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>        <span id="alg2.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>        <math id="alg2.l10.m1.4" class="ltx_Math" alttext="\Delta w_{i}^{r}=w_{i}^{r,T_{i}}-w_{i}^{r,0}" display="inline"><semantics id="alg2.l10.m1.4a"><mrow id="alg2.l10.m1.4.5" xref="alg2.l10.m1.4.5.cmml"><mrow id="alg2.l10.m1.4.5.2" xref="alg2.l10.m1.4.5.2.cmml"><mi mathvariant="normal" id="alg2.l10.m1.4.5.2.2" xref="alg2.l10.m1.4.5.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.4.5.2.1" xref="alg2.l10.m1.4.5.2.1.cmml">​</mo><msubsup id="alg2.l10.m1.4.5.2.3" xref="alg2.l10.m1.4.5.2.3.cmml"><mi id="alg2.l10.m1.4.5.2.3.2.2" xref="alg2.l10.m1.4.5.2.3.2.2.cmml">w</mi><mi id="alg2.l10.m1.4.5.2.3.2.3" xref="alg2.l10.m1.4.5.2.3.2.3.cmml">i</mi><mi id="alg2.l10.m1.4.5.2.3.3" xref="alg2.l10.m1.4.5.2.3.3.cmml">r</mi></msubsup></mrow><mo id="alg2.l10.m1.4.5.1" xref="alg2.l10.m1.4.5.1.cmml">=</mo><mrow id="alg2.l10.m1.4.5.3" xref="alg2.l10.m1.4.5.3.cmml"><msubsup id="alg2.l10.m1.4.5.3.2" xref="alg2.l10.m1.4.5.3.2.cmml"><mi id="alg2.l10.m1.4.5.3.2.2.2" xref="alg2.l10.m1.4.5.3.2.2.2.cmml">w</mi><mi id="alg2.l10.m1.4.5.3.2.2.3" xref="alg2.l10.m1.4.5.3.2.2.3.cmml">i</mi><mrow id="alg2.l10.m1.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml"><mi id="alg2.l10.m1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.cmml">r</mi><mo id="alg2.l10.m1.2.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml">,</mo><msub id="alg2.l10.m1.2.2.2.2.1" xref="alg2.l10.m1.2.2.2.2.1.cmml"><mi id="alg2.l10.m1.2.2.2.2.1.2" xref="alg2.l10.m1.2.2.2.2.1.2.cmml">T</mi><mi id="alg2.l10.m1.2.2.2.2.1.3" xref="alg2.l10.m1.2.2.2.2.1.3.cmml">i</mi></msub></mrow></msubsup><mo id="alg2.l10.m1.4.5.3.1" xref="alg2.l10.m1.4.5.3.1.cmml">−</mo><msubsup id="alg2.l10.m1.4.5.3.3" xref="alg2.l10.m1.4.5.3.3.cmml"><mi id="alg2.l10.m1.4.5.3.3.2.2" xref="alg2.l10.m1.4.5.3.3.2.2.cmml">w</mi><mi id="alg2.l10.m1.4.5.3.3.2.3" xref="alg2.l10.m1.4.5.3.3.2.3.cmml">i</mi><mrow id="alg2.l10.m1.4.4.2.4" xref="alg2.l10.m1.4.4.2.3.cmml"><mi id="alg2.l10.m1.3.3.1.1" xref="alg2.l10.m1.3.3.1.1.cmml">r</mi><mo id="alg2.l10.m1.4.4.2.4.1" xref="alg2.l10.m1.4.4.2.3.cmml">,</mo><mn id="alg2.l10.m1.4.4.2.2" xref="alg2.l10.m1.4.4.2.2.cmml">0</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.4b"><apply id="alg2.l10.m1.4.5.cmml" xref="alg2.l10.m1.4.5"><eq id="alg2.l10.m1.4.5.1.cmml" xref="alg2.l10.m1.4.5.1"></eq><apply id="alg2.l10.m1.4.5.2.cmml" xref="alg2.l10.m1.4.5.2"><times id="alg2.l10.m1.4.5.2.1.cmml" xref="alg2.l10.m1.4.5.2.1"></times><ci id="alg2.l10.m1.4.5.2.2.cmml" xref="alg2.l10.m1.4.5.2.2">Δ</ci><apply id="alg2.l10.m1.4.5.2.3.cmml" xref="alg2.l10.m1.4.5.2.3"><csymbol cd="ambiguous" id="alg2.l10.m1.4.5.2.3.1.cmml" xref="alg2.l10.m1.4.5.2.3">superscript</csymbol><apply id="alg2.l10.m1.4.5.2.3.2.cmml" xref="alg2.l10.m1.4.5.2.3"><csymbol cd="ambiguous" id="alg2.l10.m1.4.5.2.3.2.1.cmml" xref="alg2.l10.m1.4.5.2.3">subscript</csymbol><ci id="alg2.l10.m1.4.5.2.3.2.2.cmml" xref="alg2.l10.m1.4.5.2.3.2.2">𝑤</ci><ci id="alg2.l10.m1.4.5.2.3.2.3.cmml" xref="alg2.l10.m1.4.5.2.3.2.3">𝑖</ci></apply><ci id="alg2.l10.m1.4.5.2.3.3.cmml" xref="alg2.l10.m1.4.5.2.3.3">𝑟</ci></apply></apply><apply id="alg2.l10.m1.4.5.3.cmml" xref="alg2.l10.m1.4.5.3"><minus id="alg2.l10.m1.4.5.3.1.cmml" xref="alg2.l10.m1.4.5.3.1"></minus><apply id="alg2.l10.m1.4.5.3.2.cmml" xref="alg2.l10.m1.4.5.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.4.5.3.2.1.cmml" xref="alg2.l10.m1.4.5.3.2">superscript</csymbol><apply id="alg2.l10.m1.4.5.3.2.2.cmml" xref="alg2.l10.m1.4.5.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.4.5.3.2.2.1.cmml" xref="alg2.l10.m1.4.5.3.2">subscript</csymbol><ci id="alg2.l10.m1.4.5.3.2.2.2.cmml" xref="alg2.l10.m1.4.5.3.2.2.2">𝑤</ci><ci id="alg2.l10.m1.4.5.3.2.2.3.cmml" xref="alg2.l10.m1.4.5.3.2.2.3">𝑖</ci></apply><list id="alg2.l10.m1.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.2"><ci id="alg2.l10.m1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1">𝑟</ci><apply id="alg2.l10.m1.2.2.2.2.1.cmml" xref="alg2.l10.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="alg2.l10.m1.2.2.2.2.1.1.cmml" xref="alg2.l10.m1.2.2.2.2.1">subscript</csymbol><ci id="alg2.l10.m1.2.2.2.2.1.2.cmml" xref="alg2.l10.m1.2.2.2.2.1.2">𝑇</ci><ci id="alg2.l10.m1.2.2.2.2.1.3.cmml" xref="alg2.l10.m1.2.2.2.2.1.3">𝑖</ci></apply></list></apply><apply id="alg2.l10.m1.4.5.3.3.cmml" xref="alg2.l10.m1.4.5.3.3"><csymbol cd="ambiguous" id="alg2.l10.m1.4.5.3.3.1.cmml" xref="alg2.l10.m1.4.5.3.3">superscript</csymbol><apply id="alg2.l10.m1.4.5.3.3.2.cmml" xref="alg2.l10.m1.4.5.3.3"><csymbol cd="ambiguous" id="alg2.l10.m1.4.5.3.3.2.1.cmml" xref="alg2.l10.m1.4.5.3.3">subscript</csymbol><ci id="alg2.l10.m1.4.5.3.3.2.2.cmml" xref="alg2.l10.m1.4.5.3.3.2.2">𝑤</ci><ci id="alg2.l10.m1.4.5.3.3.2.3.cmml" xref="alg2.l10.m1.4.5.3.3.2.3">𝑖</ci></apply><list id="alg2.l10.m1.4.4.2.3.cmml" xref="alg2.l10.m1.4.4.2.4"><ci id="alg2.l10.m1.3.3.1.1.cmml" xref="alg2.l10.m1.3.3.1.1">𝑟</ci><cn type="integer" id="alg2.l10.m1.4.4.2.2.cmml" xref="alg2.l10.m1.4.4.2.2">0</cn></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.4c">\Delta w_{i}^{r}=w_{i}^{r,T_{i}}-w_{i}^{r,0}</annotation></semantics></math> 

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <span id="alg2.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>     Aggregate <math id="alg2.l12.m1.1" class="ltx_Math" alttext="\Delta w^{r}" display="inline"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi mathvariant="normal" id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml">​</mo><msup id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml"><mi id="alg2.l12.m1.1.1.3.2" xref="alg2.l12.m1.1.1.3.2.cmml">w</mi><mi id="alg2.l12.m1.1.1.3.3" xref="alg2.l12.m1.1.1.3.3.cmml">r</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><times id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"></times><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">Δ</ci><apply id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.3.1.cmml" xref="alg2.l12.m1.1.1.3">superscript</csymbol><ci id="alg2.l12.m1.1.1.3.2.cmml" xref="alg2.l12.m1.1.1.3.2">𝑤</ci><ci id="alg2.l12.m1.1.1.3.3.cmml" xref="alg2.l12.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">\Delta w^{r}</annotation></semantics></math> based on Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> 

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>     <span id="alg2.l13.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l13.m1.1" class="ltx_Math" alttext="i\in S" display="inline"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><mi id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml">i</mi><mo id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml">∈</mo><mi id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><in id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1"></in><ci id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2">𝑖</ci><ci id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">i\in S</annotation></semantics></math> (on the server) <span id="alg2.l13.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>        <math id="alg2.l14.m1.1" class="ltx_Math" alttext="c_{i}^{r}=c_{i}^{r-1}-c_{g}^{r-1}-\frac{1}{T^{i}\alpha}*\Delta w_{i}^{r}" display="inline"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msubsup id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml"><mi id="alg2.l14.m1.1.1.2.2.2" xref="alg2.l14.m1.1.1.2.2.2.cmml">c</mi><mi id="alg2.l14.m1.1.1.2.2.3" xref="alg2.l14.m1.1.1.2.2.3.cmml">i</mi><mi id="alg2.l14.m1.1.1.2.3" xref="alg2.l14.m1.1.1.2.3.cmml">r</mi></msubsup><mo id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml">=</mo><mrow id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml"><msubsup id="alg2.l14.m1.1.1.3.2" xref="alg2.l14.m1.1.1.3.2.cmml"><mi id="alg2.l14.m1.1.1.3.2.2.2" xref="alg2.l14.m1.1.1.3.2.2.2.cmml">c</mi><mi id="alg2.l14.m1.1.1.3.2.2.3" xref="alg2.l14.m1.1.1.3.2.2.3.cmml">i</mi><mrow id="alg2.l14.m1.1.1.3.2.3" xref="alg2.l14.m1.1.1.3.2.3.cmml"><mi id="alg2.l14.m1.1.1.3.2.3.2" xref="alg2.l14.m1.1.1.3.2.3.2.cmml">r</mi><mo id="alg2.l14.m1.1.1.3.2.3.1" xref="alg2.l14.m1.1.1.3.2.3.1.cmml">−</mo><mn id="alg2.l14.m1.1.1.3.2.3.3" xref="alg2.l14.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg2.l14.m1.1.1.3.1" xref="alg2.l14.m1.1.1.3.1.cmml">−</mo><msubsup id="alg2.l14.m1.1.1.3.3" xref="alg2.l14.m1.1.1.3.3.cmml"><mi id="alg2.l14.m1.1.1.3.3.2.2" xref="alg2.l14.m1.1.1.3.3.2.2.cmml">c</mi><mi id="alg2.l14.m1.1.1.3.3.2.3" xref="alg2.l14.m1.1.1.3.3.2.3.cmml">g</mi><mrow id="alg2.l14.m1.1.1.3.3.3" xref="alg2.l14.m1.1.1.3.3.3.cmml"><mi id="alg2.l14.m1.1.1.3.3.3.2" xref="alg2.l14.m1.1.1.3.3.3.2.cmml">r</mi><mo id="alg2.l14.m1.1.1.3.3.3.1" xref="alg2.l14.m1.1.1.3.3.3.1.cmml">−</mo><mn id="alg2.l14.m1.1.1.3.3.3.3" xref="alg2.l14.m1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup><mo id="alg2.l14.m1.1.1.3.1a" xref="alg2.l14.m1.1.1.3.1.cmml">−</mo><mrow id="alg2.l14.m1.1.1.3.4" xref="alg2.l14.m1.1.1.3.4.cmml"><mrow id="alg2.l14.m1.1.1.3.4.2" xref="alg2.l14.m1.1.1.3.4.2.cmml"><mfrac id="alg2.l14.m1.1.1.3.4.2.2" xref="alg2.l14.m1.1.1.3.4.2.2.cmml"><mn id="alg2.l14.m1.1.1.3.4.2.2.2" xref="alg2.l14.m1.1.1.3.4.2.2.2.cmml">1</mn><mrow id="alg2.l14.m1.1.1.3.4.2.2.3" xref="alg2.l14.m1.1.1.3.4.2.2.3.cmml"><msup id="alg2.l14.m1.1.1.3.4.2.2.3.2" xref="alg2.l14.m1.1.1.3.4.2.2.3.2.cmml"><mi id="alg2.l14.m1.1.1.3.4.2.2.3.2.2" xref="alg2.l14.m1.1.1.3.4.2.2.3.2.2.cmml">T</mi><mi id="alg2.l14.m1.1.1.3.4.2.2.3.2.3" xref="alg2.l14.m1.1.1.3.4.2.2.3.2.3.cmml">i</mi></msup><mo lspace="0em" rspace="0em" id="alg2.l14.m1.1.1.3.4.2.2.3.1" xref="alg2.l14.m1.1.1.3.4.2.2.3.1.cmml">​</mo><mi id="alg2.l14.m1.1.1.3.4.2.2.3.3" xref="alg2.l14.m1.1.1.3.4.2.2.3.3.cmml">α</mi></mrow></mfrac><mo lspace="0.222em" rspace="0.222em" id="alg2.l14.m1.1.1.3.4.2.1" xref="alg2.l14.m1.1.1.3.4.2.1.cmml">∗</mo><mi mathvariant="normal" id="alg2.l14.m1.1.1.3.4.2.3" xref="alg2.l14.m1.1.1.3.4.2.3.cmml">Δ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l14.m1.1.1.3.4.1" xref="alg2.l14.m1.1.1.3.4.1.cmml">​</mo><msubsup id="alg2.l14.m1.1.1.3.4.3" xref="alg2.l14.m1.1.1.3.4.3.cmml"><mi id="alg2.l14.m1.1.1.3.4.3.2.2" xref="alg2.l14.m1.1.1.3.4.3.2.2.cmml">w</mi><mi id="alg2.l14.m1.1.1.3.4.3.2.3" xref="alg2.l14.m1.1.1.3.4.3.2.3.cmml">i</mi><mi id="alg2.l14.m1.1.1.3.4.3.3" xref="alg2.l14.m1.1.1.3.4.3.3.cmml">r</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><eq id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1"></eq><apply id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.2">superscript</csymbol><apply id="alg2.l14.m1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.2.1.cmml" xref="alg2.l14.m1.1.1.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.2.2.cmml" xref="alg2.l14.m1.1.1.2.2.2">𝑐</ci><ci id="alg2.l14.m1.1.1.2.2.3.cmml" xref="alg2.l14.m1.1.1.2.2.3">𝑖</ci></apply><ci id="alg2.l14.m1.1.1.2.3.cmml" xref="alg2.l14.m1.1.1.2.3">𝑟</ci></apply><apply id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3"><minus id="alg2.l14.m1.1.1.3.1.cmml" xref="alg2.l14.m1.1.1.3.1"></minus><apply id="alg2.l14.m1.1.1.3.2.cmml" xref="alg2.l14.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.2.1.cmml" xref="alg2.l14.m1.1.1.3.2">superscript</csymbol><apply id="alg2.l14.m1.1.1.3.2.2.cmml" xref="alg2.l14.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.2.2.1.cmml" xref="alg2.l14.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.2.2.2.cmml" xref="alg2.l14.m1.1.1.3.2.2.2">𝑐</ci><ci id="alg2.l14.m1.1.1.3.2.2.3.cmml" xref="alg2.l14.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="alg2.l14.m1.1.1.3.2.3.cmml" xref="alg2.l14.m1.1.1.3.2.3"><minus id="alg2.l14.m1.1.1.3.2.3.1.cmml" xref="alg2.l14.m1.1.1.3.2.3.1"></minus><ci id="alg2.l14.m1.1.1.3.2.3.2.cmml" xref="alg2.l14.m1.1.1.3.2.3.2">𝑟</ci><cn type="integer" id="alg2.l14.m1.1.1.3.2.3.3.cmml" xref="alg2.l14.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg2.l14.m1.1.1.3.3.cmml" xref="alg2.l14.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.3.1.cmml" xref="alg2.l14.m1.1.1.3.3">superscript</csymbol><apply id="alg2.l14.m1.1.1.3.3.2.cmml" xref="alg2.l14.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.3.2.1.cmml" xref="alg2.l14.m1.1.1.3.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.3.2.2.cmml" xref="alg2.l14.m1.1.1.3.3.2.2">𝑐</ci><ci id="alg2.l14.m1.1.1.3.3.2.3.cmml" xref="alg2.l14.m1.1.1.3.3.2.3">𝑔</ci></apply><apply id="alg2.l14.m1.1.1.3.3.3.cmml" xref="alg2.l14.m1.1.1.3.3.3"><minus id="alg2.l14.m1.1.1.3.3.3.1.cmml" xref="alg2.l14.m1.1.1.3.3.3.1"></minus><ci id="alg2.l14.m1.1.1.3.3.3.2.cmml" xref="alg2.l14.m1.1.1.3.3.3.2">𝑟</ci><cn type="integer" id="alg2.l14.m1.1.1.3.3.3.3.cmml" xref="alg2.l14.m1.1.1.3.3.3.3">1</cn></apply></apply><apply id="alg2.l14.m1.1.1.3.4.cmml" xref="alg2.l14.m1.1.1.3.4"><times id="alg2.l14.m1.1.1.3.4.1.cmml" xref="alg2.l14.m1.1.1.3.4.1"></times><apply id="alg2.l14.m1.1.1.3.4.2.cmml" xref="alg2.l14.m1.1.1.3.4.2"><times id="alg2.l14.m1.1.1.3.4.2.1.cmml" xref="alg2.l14.m1.1.1.3.4.2.1"></times><apply id="alg2.l14.m1.1.1.3.4.2.2.cmml" xref="alg2.l14.m1.1.1.3.4.2.2"><divide id="alg2.l14.m1.1.1.3.4.2.2.1.cmml" xref="alg2.l14.m1.1.1.3.4.2.2"></divide><cn type="integer" id="alg2.l14.m1.1.1.3.4.2.2.2.cmml" xref="alg2.l14.m1.1.1.3.4.2.2.2">1</cn><apply id="alg2.l14.m1.1.1.3.4.2.2.3.cmml" xref="alg2.l14.m1.1.1.3.4.2.2.3"><times id="alg2.l14.m1.1.1.3.4.2.2.3.1.cmml" xref="alg2.l14.m1.1.1.3.4.2.2.3.1"></times><apply id="alg2.l14.m1.1.1.3.4.2.2.3.2.cmml" xref="alg2.l14.m1.1.1.3.4.2.2.3.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.4.2.2.3.2.1.cmml" xref="alg2.l14.m1.1.1.3.4.2.2.3.2">superscript</csymbol><ci id="alg2.l14.m1.1.1.3.4.2.2.3.2.2.cmml" xref="alg2.l14.m1.1.1.3.4.2.2.3.2.2">𝑇</ci><ci id="alg2.l14.m1.1.1.3.4.2.2.3.2.3.cmml" xref="alg2.l14.m1.1.1.3.4.2.2.3.2.3">𝑖</ci></apply><ci id="alg2.l14.m1.1.1.3.4.2.2.3.3.cmml" xref="alg2.l14.m1.1.1.3.4.2.2.3.3">𝛼</ci></apply></apply><ci id="alg2.l14.m1.1.1.3.4.2.3.cmml" xref="alg2.l14.m1.1.1.3.4.2.3">Δ</ci></apply><apply id="alg2.l14.m1.1.1.3.4.3.cmml" xref="alg2.l14.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.4.3.1.cmml" xref="alg2.l14.m1.1.1.3.4.3">superscript</csymbol><apply id="alg2.l14.m1.1.1.3.4.3.2.cmml" xref="alg2.l14.m1.1.1.3.4.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.4.3.2.1.cmml" xref="alg2.l14.m1.1.1.3.4.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.4.3.2.2.cmml" xref="alg2.l14.m1.1.1.3.4.3.2.2">𝑤</ci><ci id="alg2.l14.m1.1.1.3.4.3.2.3.cmml" xref="alg2.l14.m1.1.1.3.4.3.2.3">𝑖</ci></apply><ci id="alg2.l14.m1.1.1.3.4.3.3.cmml" xref="alg2.l14.m1.1.1.3.4.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">c_{i}^{r}=c_{i}^{r-1}-c_{g}^{r-1}-\frac{1}{T^{i}\alpha}*\Delta w_{i}^{r}</annotation></semantics></math> 

</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math id="alg2.l15.m1.1" class="ltx_Math" alttext="\Delta c_{i}^{r}=c_{i}^{r}-c_{i}^{r-1}" display="inline"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mrow id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml"><mi mathvariant="normal" id="alg2.l15.m1.1.1.2.2" xref="alg2.l15.m1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.2.1" xref="alg2.l15.m1.1.1.2.1.cmml">​</mo><msubsup id="alg2.l15.m1.1.1.2.3" xref="alg2.l15.m1.1.1.2.3.cmml"><mi id="alg2.l15.m1.1.1.2.3.2.2" xref="alg2.l15.m1.1.1.2.3.2.2.cmml">c</mi><mi id="alg2.l15.m1.1.1.2.3.2.3" xref="alg2.l15.m1.1.1.2.3.2.3.cmml">i</mi><mi id="alg2.l15.m1.1.1.2.3.3" xref="alg2.l15.m1.1.1.2.3.3.cmml">r</mi></msubsup></mrow><mo id="alg2.l15.m1.1.1.1" xref="alg2.l15.m1.1.1.1.cmml">=</mo><mrow id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml"><msubsup id="alg2.l15.m1.1.1.3.2" xref="alg2.l15.m1.1.1.3.2.cmml"><mi id="alg2.l15.m1.1.1.3.2.2.2" xref="alg2.l15.m1.1.1.3.2.2.2.cmml">c</mi><mi id="alg2.l15.m1.1.1.3.2.2.3" xref="alg2.l15.m1.1.1.3.2.2.3.cmml">i</mi><mi id="alg2.l15.m1.1.1.3.2.3" xref="alg2.l15.m1.1.1.3.2.3.cmml">r</mi></msubsup><mo id="alg2.l15.m1.1.1.3.1" xref="alg2.l15.m1.1.1.3.1.cmml">−</mo><msubsup id="alg2.l15.m1.1.1.3.3" xref="alg2.l15.m1.1.1.3.3.cmml"><mi id="alg2.l15.m1.1.1.3.3.2.2" xref="alg2.l15.m1.1.1.3.3.2.2.cmml">c</mi><mi id="alg2.l15.m1.1.1.3.3.2.3" xref="alg2.l15.m1.1.1.3.3.2.3.cmml">i</mi><mrow id="alg2.l15.m1.1.1.3.3.3" xref="alg2.l15.m1.1.1.3.3.3.cmml"><mi id="alg2.l15.m1.1.1.3.3.3.2" xref="alg2.l15.m1.1.1.3.3.3.2.cmml">r</mi><mo id="alg2.l15.m1.1.1.3.3.3.1" xref="alg2.l15.m1.1.1.3.3.3.1.cmml">−</mo><mn id="alg2.l15.m1.1.1.3.3.3.3" xref="alg2.l15.m1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><eq id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"></eq><apply id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2"><times id="alg2.l15.m1.1.1.2.1.cmml" xref="alg2.l15.m1.1.1.2.1"></times><ci id="alg2.l15.m1.1.1.2.2.cmml" xref="alg2.l15.m1.1.1.2.2">Δ</ci><apply id="alg2.l15.m1.1.1.2.3.cmml" xref="alg2.l15.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.2.3.1.cmml" xref="alg2.l15.m1.1.1.2.3">superscript</csymbol><apply id="alg2.l15.m1.1.1.2.3.2.cmml" xref="alg2.l15.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.2.3.2.1.cmml" xref="alg2.l15.m1.1.1.2.3">subscript</csymbol><ci id="alg2.l15.m1.1.1.2.3.2.2.cmml" xref="alg2.l15.m1.1.1.2.3.2.2">𝑐</ci><ci id="alg2.l15.m1.1.1.2.3.2.3.cmml" xref="alg2.l15.m1.1.1.2.3.2.3">𝑖</ci></apply><ci id="alg2.l15.m1.1.1.2.3.3.cmml" xref="alg2.l15.m1.1.1.2.3.3">𝑟</ci></apply></apply><apply id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3"><minus id="alg2.l15.m1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.3.1"></minus><apply id="alg2.l15.m1.1.1.3.2.cmml" xref="alg2.l15.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.2.1.cmml" xref="alg2.l15.m1.1.1.3.2">superscript</csymbol><apply id="alg2.l15.m1.1.1.3.2.2.cmml" xref="alg2.l15.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.2.2.1.cmml" xref="alg2.l15.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l15.m1.1.1.3.2.2.2.cmml" xref="alg2.l15.m1.1.1.3.2.2.2">𝑐</ci><ci id="alg2.l15.m1.1.1.3.2.2.3.cmml" xref="alg2.l15.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="alg2.l15.m1.1.1.3.2.3.cmml" xref="alg2.l15.m1.1.1.3.2.3">𝑟</ci></apply><apply id="alg2.l15.m1.1.1.3.3.cmml" xref="alg2.l15.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.3.1.cmml" xref="alg2.l15.m1.1.1.3.3">superscript</csymbol><apply id="alg2.l15.m1.1.1.3.3.2.cmml" xref="alg2.l15.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.3.2.1.cmml" xref="alg2.l15.m1.1.1.3.3">subscript</csymbol><ci id="alg2.l15.m1.1.1.3.3.2.2.cmml" xref="alg2.l15.m1.1.1.3.3.2.2">𝑐</ci><ci id="alg2.l15.m1.1.1.3.3.2.3.cmml" xref="alg2.l15.m1.1.1.3.3.2.3">𝑖</ci></apply><apply id="alg2.l15.m1.1.1.3.3.3.cmml" xref="alg2.l15.m1.1.1.3.3.3"><minus id="alg2.l15.m1.1.1.3.3.3.1.cmml" xref="alg2.l15.m1.1.1.3.3.3.1"></minus><ci id="alg2.l15.m1.1.1.3.3.3.2.cmml" xref="alg2.l15.m1.1.1.3.3.3.2">𝑟</ci><cn type="integer" id="alg2.l15.m1.1.1.3.3.3.3.cmml" xref="alg2.l15.m1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">\Delta c_{i}^{r}=c_{i}^{r}-c_{i}^{r-1}</annotation></semantics></math> 

</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <span id="alg2.l16.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l16.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>     Aggregate <math id="alg2.l17.m1.1" class="ltx_Math" alttext="\Delta c^{r}" display="inline"><semantics id="alg2.l17.m1.1a"><mrow id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml"><mi mathvariant="normal" id="alg2.l17.m1.1.1.2" xref="alg2.l17.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg2.l17.m1.1.1.1" xref="alg2.l17.m1.1.1.1.cmml">​</mo><msup id="alg2.l17.m1.1.1.3" xref="alg2.l17.m1.1.1.3.cmml"><mi id="alg2.l17.m1.1.1.3.2" xref="alg2.l17.m1.1.1.3.2.cmml">c</mi><mi id="alg2.l17.m1.1.1.3.3" xref="alg2.l17.m1.1.1.3.3.cmml">r</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.1b"><apply id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"><times id="alg2.l17.m1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1"></times><ci id="alg2.l17.m1.1.1.2.cmml" xref="alg2.l17.m1.1.1.2">Δ</ci><apply id="alg2.l17.m1.1.1.3.cmml" xref="alg2.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.3.1.cmml" xref="alg2.l17.m1.1.1.3">superscript</csymbol><ci id="alg2.l17.m1.1.1.3.2.cmml" xref="alg2.l17.m1.1.1.3.2">𝑐</ci><ci id="alg2.l17.m1.1.1.3.3.cmml" xref="alg2.l17.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">\Delta c^{r}</annotation></semantics></math> based on Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> 

</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>     <math id="alg2.l18.m1.2" class="ltx_Math" alttext="c_{g}^{r}=c_{g}^{r-1}+\Delta c^{r}*\frac{|S|}{|M|}" display="inline"><semantics id="alg2.l18.m1.2a"><mrow id="alg2.l18.m1.2.3" xref="alg2.l18.m1.2.3.cmml"><msubsup id="alg2.l18.m1.2.3.2" xref="alg2.l18.m1.2.3.2.cmml"><mi id="alg2.l18.m1.2.3.2.2.2" xref="alg2.l18.m1.2.3.2.2.2.cmml">c</mi><mi id="alg2.l18.m1.2.3.2.2.3" xref="alg2.l18.m1.2.3.2.2.3.cmml">g</mi><mi id="alg2.l18.m1.2.3.2.3" xref="alg2.l18.m1.2.3.2.3.cmml">r</mi></msubsup><mo id="alg2.l18.m1.2.3.1" xref="alg2.l18.m1.2.3.1.cmml">=</mo><mrow id="alg2.l18.m1.2.3.3" xref="alg2.l18.m1.2.3.3.cmml"><msubsup id="alg2.l18.m1.2.3.3.2" xref="alg2.l18.m1.2.3.3.2.cmml"><mi id="alg2.l18.m1.2.3.3.2.2.2" xref="alg2.l18.m1.2.3.3.2.2.2.cmml">c</mi><mi id="alg2.l18.m1.2.3.3.2.2.3" xref="alg2.l18.m1.2.3.3.2.2.3.cmml">g</mi><mrow id="alg2.l18.m1.2.3.3.2.3" xref="alg2.l18.m1.2.3.3.2.3.cmml"><mi id="alg2.l18.m1.2.3.3.2.3.2" xref="alg2.l18.m1.2.3.3.2.3.2.cmml">r</mi><mo id="alg2.l18.m1.2.3.3.2.3.1" xref="alg2.l18.m1.2.3.3.2.3.1.cmml">−</mo><mn id="alg2.l18.m1.2.3.3.2.3.3" xref="alg2.l18.m1.2.3.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg2.l18.m1.2.3.3.1" xref="alg2.l18.m1.2.3.3.1.cmml">+</mo><mrow id="alg2.l18.m1.2.3.3.3" xref="alg2.l18.m1.2.3.3.3.cmml"><mrow id="alg2.l18.m1.2.3.3.3.2" xref="alg2.l18.m1.2.3.3.3.2.cmml"><mi mathvariant="normal" id="alg2.l18.m1.2.3.3.3.2.2" xref="alg2.l18.m1.2.3.3.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg2.l18.m1.2.3.3.3.2.1" xref="alg2.l18.m1.2.3.3.3.2.1.cmml">​</mo><msup id="alg2.l18.m1.2.3.3.3.2.3" xref="alg2.l18.m1.2.3.3.3.2.3.cmml"><mi id="alg2.l18.m1.2.3.3.3.2.3.2" xref="alg2.l18.m1.2.3.3.3.2.3.2.cmml">c</mi><mi id="alg2.l18.m1.2.3.3.3.2.3.3" xref="alg2.l18.m1.2.3.3.3.2.3.3.cmml">r</mi></msup></mrow><mo lspace="0.222em" rspace="0.222em" id="alg2.l18.m1.2.3.3.3.1" xref="alg2.l18.m1.2.3.3.3.1.cmml">∗</mo><mfrac id="alg2.l18.m1.2.2" xref="alg2.l18.m1.2.2.cmml"><mrow id="alg2.l18.m1.1.1.1.3" xref="alg2.l18.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l18.m1.1.1.1.3.1" xref="alg2.l18.m1.1.1.1.2.1.cmml">|</mo><mi id="alg2.l18.m1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.cmml">S</mi><mo stretchy="false" id="alg2.l18.m1.1.1.1.3.2" xref="alg2.l18.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg2.l18.m1.2.2.2.3" xref="alg2.l18.m1.2.2.2.2.cmml"><mo stretchy="false" id="alg2.l18.m1.2.2.2.3.1" xref="alg2.l18.m1.2.2.2.2.1.cmml">|</mo><mi id="alg2.l18.m1.2.2.2.1" xref="alg2.l18.m1.2.2.2.1.cmml">M</mi><mo stretchy="false" id="alg2.l18.m1.2.2.2.3.2" xref="alg2.l18.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.2b"><apply id="alg2.l18.m1.2.3.cmml" xref="alg2.l18.m1.2.3"><eq id="alg2.l18.m1.2.3.1.cmml" xref="alg2.l18.m1.2.3.1"></eq><apply id="alg2.l18.m1.2.3.2.cmml" xref="alg2.l18.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.2.3.2.1.cmml" xref="alg2.l18.m1.2.3.2">superscript</csymbol><apply id="alg2.l18.m1.2.3.2.2.cmml" xref="alg2.l18.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.2.3.2.2.1.cmml" xref="alg2.l18.m1.2.3.2">subscript</csymbol><ci id="alg2.l18.m1.2.3.2.2.2.cmml" xref="alg2.l18.m1.2.3.2.2.2">𝑐</ci><ci id="alg2.l18.m1.2.3.2.2.3.cmml" xref="alg2.l18.m1.2.3.2.2.3">𝑔</ci></apply><ci id="alg2.l18.m1.2.3.2.3.cmml" xref="alg2.l18.m1.2.3.2.3">𝑟</ci></apply><apply id="alg2.l18.m1.2.3.3.cmml" xref="alg2.l18.m1.2.3.3"><plus id="alg2.l18.m1.2.3.3.1.cmml" xref="alg2.l18.m1.2.3.3.1"></plus><apply id="alg2.l18.m1.2.3.3.2.cmml" xref="alg2.l18.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.2.3.3.2.1.cmml" xref="alg2.l18.m1.2.3.3.2">superscript</csymbol><apply id="alg2.l18.m1.2.3.3.2.2.cmml" xref="alg2.l18.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.2.3.3.2.2.1.cmml" xref="alg2.l18.m1.2.3.3.2">subscript</csymbol><ci id="alg2.l18.m1.2.3.3.2.2.2.cmml" xref="alg2.l18.m1.2.3.3.2.2.2">𝑐</ci><ci id="alg2.l18.m1.2.3.3.2.2.3.cmml" xref="alg2.l18.m1.2.3.3.2.2.3">𝑔</ci></apply><apply id="alg2.l18.m1.2.3.3.2.3.cmml" xref="alg2.l18.m1.2.3.3.2.3"><minus id="alg2.l18.m1.2.3.3.2.3.1.cmml" xref="alg2.l18.m1.2.3.3.2.3.1"></minus><ci id="alg2.l18.m1.2.3.3.2.3.2.cmml" xref="alg2.l18.m1.2.3.3.2.3.2">𝑟</ci><cn type="integer" id="alg2.l18.m1.2.3.3.2.3.3.cmml" xref="alg2.l18.m1.2.3.3.2.3.3">1</cn></apply></apply><apply id="alg2.l18.m1.2.3.3.3.cmml" xref="alg2.l18.m1.2.3.3.3"><times id="alg2.l18.m1.2.3.3.3.1.cmml" xref="alg2.l18.m1.2.3.3.3.1"></times><apply id="alg2.l18.m1.2.3.3.3.2.cmml" xref="alg2.l18.m1.2.3.3.3.2"><times id="alg2.l18.m1.2.3.3.3.2.1.cmml" xref="alg2.l18.m1.2.3.3.3.2.1"></times><ci id="alg2.l18.m1.2.3.3.3.2.2.cmml" xref="alg2.l18.m1.2.3.3.3.2.2">Δ</ci><apply id="alg2.l18.m1.2.3.3.3.2.3.cmml" xref="alg2.l18.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="alg2.l18.m1.2.3.3.3.2.3.1.cmml" xref="alg2.l18.m1.2.3.3.3.2.3">superscript</csymbol><ci id="alg2.l18.m1.2.3.3.3.2.3.2.cmml" xref="alg2.l18.m1.2.3.3.3.2.3.2">𝑐</ci><ci id="alg2.l18.m1.2.3.3.3.2.3.3.cmml" xref="alg2.l18.m1.2.3.3.3.2.3.3">𝑟</ci></apply></apply><apply id="alg2.l18.m1.2.2.cmml" xref="alg2.l18.m1.2.2"><divide id="alg2.l18.m1.2.2.3.cmml" xref="alg2.l18.m1.2.2"></divide><apply id="alg2.l18.m1.1.1.1.2.cmml" xref="alg2.l18.m1.1.1.1.3"><abs id="alg2.l18.m1.1.1.1.2.1.cmml" xref="alg2.l18.m1.1.1.1.3.1"></abs><ci id="alg2.l18.m1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1">𝑆</ci></apply><apply id="alg2.l18.m1.2.2.2.2.cmml" xref="alg2.l18.m1.2.2.2.3"><abs id="alg2.l18.m1.2.2.2.2.1.cmml" xref="alg2.l18.m1.2.2.2.3.1"></abs><ci id="alg2.l18.m1.2.2.2.1.cmml" xref="alg2.l18.m1.2.2.2.1">𝑀</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.2c">c_{g}^{r}=c_{g}^{r-1}+\Delta c^{r}*\frac{|S|}{|M|}</annotation></semantics></math> 

</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>     <math id="alg2.l19.m1.1" class="ltx_Math" alttext="g_{g}^{r}=\Delta w^{r-1}-\Delta w^{r}" display="inline"><semantics id="alg2.l19.m1.1a"><mrow id="alg2.l19.m1.1.1" xref="alg2.l19.m1.1.1.cmml"><msubsup id="alg2.l19.m1.1.1.2" xref="alg2.l19.m1.1.1.2.cmml"><mi id="alg2.l19.m1.1.1.2.2.2" xref="alg2.l19.m1.1.1.2.2.2.cmml">g</mi><mi id="alg2.l19.m1.1.1.2.2.3" xref="alg2.l19.m1.1.1.2.2.3.cmml">g</mi><mi id="alg2.l19.m1.1.1.2.3" xref="alg2.l19.m1.1.1.2.3.cmml">r</mi></msubsup><mo id="alg2.l19.m1.1.1.1" xref="alg2.l19.m1.1.1.1.cmml">=</mo><mrow id="alg2.l19.m1.1.1.3" xref="alg2.l19.m1.1.1.3.cmml"><mrow id="alg2.l19.m1.1.1.3.2" xref="alg2.l19.m1.1.1.3.2.cmml"><mi mathvariant="normal" id="alg2.l19.m1.1.1.3.2.2" xref="alg2.l19.m1.1.1.3.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg2.l19.m1.1.1.3.2.1" xref="alg2.l19.m1.1.1.3.2.1.cmml">​</mo><msup id="alg2.l19.m1.1.1.3.2.3" xref="alg2.l19.m1.1.1.3.2.3.cmml"><mi id="alg2.l19.m1.1.1.3.2.3.2" xref="alg2.l19.m1.1.1.3.2.3.2.cmml">w</mi><mrow id="alg2.l19.m1.1.1.3.2.3.3" xref="alg2.l19.m1.1.1.3.2.3.3.cmml"><mi id="alg2.l19.m1.1.1.3.2.3.3.2" xref="alg2.l19.m1.1.1.3.2.3.3.2.cmml">r</mi><mo id="alg2.l19.m1.1.1.3.2.3.3.1" xref="alg2.l19.m1.1.1.3.2.3.3.1.cmml">−</mo><mn id="alg2.l19.m1.1.1.3.2.3.3.3" xref="alg2.l19.m1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="alg2.l19.m1.1.1.3.1" xref="alg2.l19.m1.1.1.3.1.cmml">−</mo><mrow id="alg2.l19.m1.1.1.3.3" xref="alg2.l19.m1.1.1.3.3.cmml"><mi mathvariant="normal" id="alg2.l19.m1.1.1.3.3.2" xref="alg2.l19.m1.1.1.3.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg2.l19.m1.1.1.3.3.1" xref="alg2.l19.m1.1.1.3.3.1.cmml">​</mo><msup id="alg2.l19.m1.1.1.3.3.3" xref="alg2.l19.m1.1.1.3.3.3.cmml"><mi id="alg2.l19.m1.1.1.3.3.3.2" xref="alg2.l19.m1.1.1.3.3.3.2.cmml">w</mi><mi id="alg2.l19.m1.1.1.3.3.3.3" xref="alg2.l19.m1.1.1.3.3.3.3.cmml">r</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l19.m1.1b"><apply id="alg2.l19.m1.1.1.cmml" xref="alg2.l19.m1.1.1"><eq id="alg2.l19.m1.1.1.1.cmml" xref="alg2.l19.m1.1.1.1"></eq><apply id="alg2.l19.m1.1.1.2.cmml" xref="alg2.l19.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.2.1.cmml" xref="alg2.l19.m1.1.1.2">superscript</csymbol><apply id="alg2.l19.m1.1.1.2.2.cmml" xref="alg2.l19.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.2.2.1.cmml" xref="alg2.l19.m1.1.1.2">subscript</csymbol><ci id="alg2.l19.m1.1.1.2.2.2.cmml" xref="alg2.l19.m1.1.1.2.2.2">𝑔</ci><ci id="alg2.l19.m1.1.1.2.2.3.cmml" xref="alg2.l19.m1.1.1.2.2.3">𝑔</ci></apply><ci id="alg2.l19.m1.1.1.2.3.cmml" xref="alg2.l19.m1.1.1.2.3">𝑟</ci></apply><apply id="alg2.l19.m1.1.1.3.cmml" xref="alg2.l19.m1.1.1.3"><minus id="alg2.l19.m1.1.1.3.1.cmml" xref="alg2.l19.m1.1.1.3.1"></minus><apply id="alg2.l19.m1.1.1.3.2.cmml" xref="alg2.l19.m1.1.1.3.2"><times id="alg2.l19.m1.1.1.3.2.1.cmml" xref="alg2.l19.m1.1.1.3.2.1"></times><ci id="alg2.l19.m1.1.1.3.2.2.cmml" xref="alg2.l19.m1.1.1.3.2.2">Δ</ci><apply id="alg2.l19.m1.1.1.3.2.3.cmml" xref="alg2.l19.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.3.2.3.1.cmml" xref="alg2.l19.m1.1.1.3.2.3">superscript</csymbol><ci id="alg2.l19.m1.1.1.3.2.3.2.cmml" xref="alg2.l19.m1.1.1.3.2.3.2">𝑤</ci><apply id="alg2.l19.m1.1.1.3.2.3.3.cmml" xref="alg2.l19.m1.1.1.3.2.3.3"><minus id="alg2.l19.m1.1.1.3.2.3.3.1.cmml" xref="alg2.l19.m1.1.1.3.2.3.3.1"></minus><ci id="alg2.l19.m1.1.1.3.2.3.3.2.cmml" xref="alg2.l19.m1.1.1.3.2.3.3.2">𝑟</ci><cn type="integer" id="alg2.l19.m1.1.1.3.2.3.3.3.cmml" xref="alg2.l19.m1.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="alg2.l19.m1.1.1.3.3.cmml" xref="alg2.l19.m1.1.1.3.3"><times id="alg2.l19.m1.1.1.3.3.1.cmml" xref="alg2.l19.m1.1.1.3.3.1"></times><ci id="alg2.l19.m1.1.1.3.3.2.cmml" xref="alg2.l19.m1.1.1.3.3.2">Δ</ci><apply id="alg2.l19.m1.1.1.3.3.3.cmml" xref="alg2.l19.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.3.3.3.1.cmml" xref="alg2.l19.m1.1.1.3.3.3">superscript</csymbol><ci id="alg2.l19.m1.1.1.3.3.3.2.cmml" xref="alg2.l19.m1.1.1.3.3.3.2">𝑤</ci><ci id="alg2.l19.m1.1.1.3.3.3.3.cmml" xref="alg2.l19.m1.1.1.3.3.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m1.1c">g_{g}^{r}=\Delta w^{r-1}-\Delta w^{r}</annotation></semantics></math> 

</div>
<div id="alg2.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>     <span id="alg2.l20.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l20.m1.1" class="ltx_Math" alttext="i\in S" display="inline"><semantics id="alg2.l20.m1.1a"><mrow id="alg2.l20.m1.1.1" xref="alg2.l20.m1.1.1.cmml"><mi id="alg2.l20.m1.1.1.2" xref="alg2.l20.m1.1.1.2.cmml">i</mi><mo id="alg2.l20.m1.1.1.1" xref="alg2.l20.m1.1.1.1.cmml">∈</mo><mi id="alg2.l20.m1.1.1.3" xref="alg2.l20.m1.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l20.m1.1b"><apply id="alg2.l20.m1.1.1.cmml" xref="alg2.l20.m1.1.1"><in id="alg2.l20.m1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1"></in><ci id="alg2.l20.m1.1.1.2.cmml" xref="alg2.l20.m1.1.1.2">𝑖</ci><ci id="alg2.l20.m1.1.1.3.cmml" xref="alg2.l20.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m1.1c">i\in S</annotation></semantics></math> (on the server) <span id="alg2.l20.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>        <math id="alg2.l21.m1.1" class="ltx_Math" alttext="m_{i}^{r}=\beta*m^{r-1}+(1-\beta)*g_{g}^{r}+c_{g}^{r}-c_{i}^{r}" display="inline"><semantics id="alg2.l21.m1.1a"><mrow id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml"><msubsup id="alg2.l21.m1.1.1.3" xref="alg2.l21.m1.1.1.3.cmml"><mi id="alg2.l21.m1.1.1.3.2.2" xref="alg2.l21.m1.1.1.3.2.2.cmml">m</mi><mi id="alg2.l21.m1.1.1.3.2.3" xref="alg2.l21.m1.1.1.3.2.3.cmml">i</mi><mi id="alg2.l21.m1.1.1.3.3" xref="alg2.l21.m1.1.1.3.3.cmml">r</mi></msubsup><mo id="alg2.l21.m1.1.1.2" xref="alg2.l21.m1.1.1.2.cmml">=</mo><mrow id="alg2.l21.m1.1.1.1" xref="alg2.l21.m1.1.1.1.cmml"><mrow id="alg2.l21.m1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.cmml"><mrow id="alg2.l21.m1.1.1.1.1.3" xref="alg2.l21.m1.1.1.1.1.3.cmml"><mi id="alg2.l21.m1.1.1.1.1.3.2" xref="alg2.l21.m1.1.1.1.1.3.2.cmml">β</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l21.m1.1.1.1.1.3.1" xref="alg2.l21.m1.1.1.1.1.3.1.cmml">∗</mo><msup id="alg2.l21.m1.1.1.1.1.3.3" xref="alg2.l21.m1.1.1.1.1.3.3.cmml"><mi id="alg2.l21.m1.1.1.1.1.3.3.2" xref="alg2.l21.m1.1.1.1.1.3.3.2.cmml">m</mi><mrow id="alg2.l21.m1.1.1.1.1.3.3.3" xref="alg2.l21.m1.1.1.1.1.3.3.3.cmml"><mi id="alg2.l21.m1.1.1.1.1.3.3.3.2" xref="alg2.l21.m1.1.1.1.1.3.3.3.2.cmml">r</mi><mo id="alg2.l21.m1.1.1.1.1.3.3.3.1" xref="alg2.l21.m1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="alg2.l21.m1.1.1.1.1.3.3.3.3" xref="alg2.l21.m1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="alg2.l21.m1.1.1.1.1.2" xref="alg2.l21.m1.1.1.1.1.2.cmml">+</mo><mrow id="alg2.l21.m1.1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.1.cmml"><mrow id="alg2.l21.m1.1.1.1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l21.m1.1.1.1.1.1.1.1.2" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l21.m1.1.1.1.1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.cmml"><mn id="alg2.l21.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg2.l21.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg2.l21.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo rspace="0.055em" stretchy="false" id="alg2.l21.m1.1.1.1.1.1.1.1.3" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="alg2.l21.m1.1.1.1.1.1.2" xref="alg2.l21.m1.1.1.1.1.1.2.cmml">∗</mo><msubsup id="alg2.l21.m1.1.1.1.1.1.3" xref="alg2.l21.m1.1.1.1.1.1.3.cmml"><mi id="alg2.l21.m1.1.1.1.1.1.3.2.2" xref="alg2.l21.m1.1.1.1.1.1.3.2.2.cmml">g</mi><mi id="alg2.l21.m1.1.1.1.1.1.3.2.3" xref="alg2.l21.m1.1.1.1.1.1.3.2.3.cmml">g</mi><mi id="alg2.l21.m1.1.1.1.1.1.3.3" xref="alg2.l21.m1.1.1.1.1.1.3.3.cmml">r</mi></msubsup></mrow><mo id="alg2.l21.m1.1.1.1.1.2a" xref="alg2.l21.m1.1.1.1.1.2.cmml">+</mo><msubsup id="alg2.l21.m1.1.1.1.1.4" xref="alg2.l21.m1.1.1.1.1.4.cmml"><mi id="alg2.l21.m1.1.1.1.1.4.2.2" xref="alg2.l21.m1.1.1.1.1.4.2.2.cmml">c</mi><mi id="alg2.l21.m1.1.1.1.1.4.2.3" xref="alg2.l21.m1.1.1.1.1.4.2.3.cmml">g</mi><mi id="alg2.l21.m1.1.1.1.1.4.3" xref="alg2.l21.m1.1.1.1.1.4.3.cmml">r</mi></msubsup></mrow><mo id="alg2.l21.m1.1.1.1.2" xref="alg2.l21.m1.1.1.1.2.cmml">−</mo><msubsup id="alg2.l21.m1.1.1.1.3" xref="alg2.l21.m1.1.1.1.3.cmml"><mi id="alg2.l21.m1.1.1.1.3.2.2" xref="alg2.l21.m1.1.1.1.3.2.2.cmml">c</mi><mi id="alg2.l21.m1.1.1.1.3.2.3" xref="alg2.l21.m1.1.1.1.3.2.3.cmml">i</mi><mi id="alg2.l21.m1.1.1.1.3.3" xref="alg2.l21.m1.1.1.1.3.3.cmml">r</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><apply id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1"><eq id="alg2.l21.m1.1.1.2.cmml" xref="alg2.l21.m1.1.1.2"></eq><apply id="alg2.l21.m1.1.1.3.cmml" xref="alg2.l21.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.3.1.cmml" xref="alg2.l21.m1.1.1.3">superscript</csymbol><apply id="alg2.l21.m1.1.1.3.2.cmml" xref="alg2.l21.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.3.2.1.cmml" xref="alg2.l21.m1.1.1.3">subscript</csymbol><ci id="alg2.l21.m1.1.1.3.2.2.cmml" xref="alg2.l21.m1.1.1.3.2.2">𝑚</ci><ci id="alg2.l21.m1.1.1.3.2.3.cmml" xref="alg2.l21.m1.1.1.3.2.3">𝑖</ci></apply><ci id="alg2.l21.m1.1.1.3.3.cmml" xref="alg2.l21.m1.1.1.3.3">𝑟</ci></apply><apply id="alg2.l21.m1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1"><minus id="alg2.l21.m1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.2"></minus><apply id="alg2.l21.m1.1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1.1"><plus id="alg2.l21.m1.1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.1.2"></plus><apply id="alg2.l21.m1.1.1.1.1.3.cmml" xref="alg2.l21.m1.1.1.1.1.3"><times id="alg2.l21.m1.1.1.1.1.3.1.cmml" xref="alg2.l21.m1.1.1.1.1.3.1"></times><ci id="alg2.l21.m1.1.1.1.1.3.2.cmml" xref="alg2.l21.m1.1.1.1.1.3.2">𝛽</ci><apply id="alg2.l21.m1.1.1.1.1.3.3.cmml" xref="alg2.l21.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.1.3.3.1.cmml" xref="alg2.l21.m1.1.1.1.1.3.3">superscript</csymbol><ci id="alg2.l21.m1.1.1.1.1.3.3.2.cmml" xref="alg2.l21.m1.1.1.1.1.3.3.2">𝑚</ci><apply id="alg2.l21.m1.1.1.1.1.3.3.3.cmml" xref="alg2.l21.m1.1.1.1.1.3.3.3"><minus id="alg2.l21.m1.1.1.1.1.3.3.3.1.cmml" xref="alg2.l21.m1.1.1.1.1.3.3.3.1"></minus><ci id="alg2.l21.m1.1.1.1.1.3.3.3.2.cmml" xref="alg2.l21.m1.1.1.1.1.3.3.3.2">𝑟</ci><cn type="integer" id="alg2.l21.m1.1.1.1.1.3.3.3.3.cmml" xref="alg2.l21.m1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="alg2.l21.m1.1.1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1.1.1"><times id="alg2.l21.m1.1.1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.1.1.2"></times><apply id="alg2.l21.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.1.1"><minus id="alg2.l21.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg2.l21.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.2">1</cn><ci id="alg2.l21.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l21.m1.1.1.1.1.1.1.1.1.3">𝛽</ci></apply><apply id="alg2.l21.m1.1.1.1.1.1.3.cmml" xref="alg2.l21.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.1.1.3.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.3">superscript</csymbol><apply id="alg2.l21.m1.1.1.1.1.1.3.2.cmml" xref="alg2.l21.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l21.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l21.m1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l21.m1.1.1.1.1.1.3.2.2">𝑔</ci><ci id="alg2.l21.m1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l21.m1.1.1.1.1.1.3.2.3">𝑔</ci></apply><ci id="alg2.l21.m1.1.1.1.1.1.3.3.cmml" xref="alg2.l21.m1.1.1.1.1.1.3.3">𝑟</ci></apply></apply><apply id="alg2.l21.m1.1.1.1.1.4.cmml" xref="alg2.l21.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.1.4.1.cmml" xref="alg2.l21.m1.1.1.1.1.4">superscript</csymbol><apply id="alg2.l21.m1.1.1.1.1.4.2.cmml" xref="alg2.l21.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.1.4.2.1.cmml" xref="alg2.l21.m1.1.1.1.1.4">subscript</csymbol><ci id="alg2.l21.m1.1.1.1.1.4.2.2.cmml" xref="alg2.l21.m1.1.1.1.1.4.2.2">𝑐</ci><ci id="alg2.l21.m1.1.1.1.1.4.2.3.cmml" xref="alg2.l21.m1.1.1.1.1.4.2.3">𝑔</ci></apply><ci id="alg2.l21.m1.1.1.1.1.4.3.cmml" xref="alg2.l21.m1.1.1.1.1.4.3">𝑟</ci></apply></apply><apply id="alg2.l21.m1.1.1.1.3.cmml" xref="alg2.l21.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.3.1.cmml" xref="alg2.l21.m1.1.1.1.3">superscript</csymbol><apply id="alg2.l21.m1.1.1.1.3.2.cmml" xref="alg2.l21.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.3.2.1.cmml" xref="alg2.l21.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l21.m1.1.1.1.3.2.2.cmml" xref="alg2.l21.m1.1.1.1.3.2.2">𝑐</ci><ci id="alg2.l21.m1.1.1.1.3.2.3.cmml" xref="alg2.l21.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="alg2.l21.m1.1.1.1.3.3.cmml" xref="alg2.l21.m1.1.1.1.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">m_{i}^{r}=\beta*m^{r-1}+(1-\beta)*g_{g}^{r}+c_{g}^{r}-c_{i}^{r}</annotation></semantics></math> 

</div>
<div id="alg2.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>        <math id="alg2.l22.m1.1" class="ltx_Math" alttext="w_{i}^{r}=w^{r-1}-\eta^{r}*m_{i}^{r}" display="inline"><semantics id="alg2.l22.m1.1a"><mrow id="alg2.l22.m1.1.1" xref="alg2.l22.m1.1.1.cmml"><msubsup id="alg2.l22.m1.1.1.2" xref="alg2.l22.m1.1.1.2.cmml"><mi id="alg2.l22.m1.1.1.2.2.2" xref="alg2.l22.m1.1.1.2.2.2.cmml">w</mi><mi id="alg2.l22.m1.1.1.2.2.3" xref="alg2.l22.m1.1.1.2.2.3.cmml">i</mi><mi id="alg2.l22.m1.1.1.2.3" xref="alg2.l22.m1.1.1.2.3.cmml">r</mi></msubsup><mo id="alg2.l22.m1.1.1.1" xref="alg2.l22.m1.1.1.1.cmml">=</mo><mrow id="alg2.l22.m1.1.1.3" xref="alg2.l22.m1.1.1.3.cmml"><msup id="alg2.l22.m1.1.1.3.2" xref="alg2.l22.m1.1.1.3.2.cmml"><mi id="alg2.l22.m1.1.1.3.2.2" xref="alg2.l22.m1.1.1.3.2.2.cmml">w</mi><mrow id="alg2.l22.m1.1.1.3.2.3" xref="alg2.l22.m1.1.1.3.2.3.cmml"><mi id="alg2.l22.m1.1.1.3.2.3.2" xref="alg2.l22.m1.1.1.3.2.3.2.cmml">r</mi><mo id="alg2.l22.m1.1.1.3.2.3.1" xref="alg2.l22.m1.1.1.3.2.3.1.cmml">−</mo><mn id="alg2.l22.m1.1.1.3.2.3.3" xref="alg2.l22.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msup><mo id="alg2.l22.m1.1.1.3.1" xref="alg2.l22.m1.1.1.3.1.cmml">−</mo><mrow id="alg2.l22.m1.1.1.3.3" xref="alg2.l22.m1.1.1.3.3.cmml"><msup id="alg2.l22.m1.1.1.3.3.2" xref="alg2.l22.m1.1.1.3.3.2.cmml"><mi id="alg2.l22.m1.1.1.3.3.2.2" xref="alg2.l22.m1.1.1.3.3.2.2.cmml">η</mi><mi id="alg2.l22.m1.1.1.3.3.2.3" xref="alg2.l22.m1.1.1.3.3.2.3.cmml">r</mi></msup><mo lspace="0.222em" rspace="0.222em" id="alg2.l22.m1.1.1.3.3.1" xref="alg2.l22.m1.1.1.3.3.1.cmml">∗</mo><msubsup id="alg2.l22.m1.1.1.3.3.3" xref="alg2.l22.m1.1.1.3.3.3.cmml"><mi id="alg2.l22.m1.1.1.3.3.3.2.2" xref="alg2.l22.m1.1.1.3.3.3.2.2.cmml">m</mi><mi id="alg2.l22.m1.1.1.3.3.3.2.3" xref="alg2.l22.m1.1.1.3.3.3.2.3.cmml">i</mi><mi id="alg2.l22.m1.1.1.3.3.3.3" xref="alg2.l22.m1.1.1.3.3.3.3.cmml">r</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l22.m1.1b"><apply id="alg2.l22.m1.1.1.cmml" xref="alg2.l22.m1.1.1"><eq id="alg2.l22.m1.1.1.1.cmml" xref="alg2.l22.m1.1.1.1"></eq><apply id="alg2.l22.m1.1.1.2.cmml" xref="alg2.l22.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.1.2.1.cmml" xref="alg2.l22.m1.1.1.2">superscript</csymbol><apply id="alg2.l22.m1.1.1.2.2.cmml" xref="alg2.l22.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.1.2.2.1.cmml" xref="alg2.l22.m1.1.1.2">subscript</csymbol><ci id="alg2.l22.m1.1.1.2.2.2.cmml" xref="alg2.l22.m1.1.1.2.2.2">𝑤</ci><ci id="alg2.l22.m1.1.1.2.2.3.cmml" xref="alg2.l22.m1.1.1.2.2.3">𝑖</ci></apply><ci id="alg2.l22.m1.1.1.2.3.cmml" xref="alg2.l22.m1.1.1.2.3">𝑟</ci></apply><apply id="alg2.l22.m1.1.1.3.cmml" xref="alg2.l22.m1.1.1.3"><minus id="alg2.l22.m1.1.1.3.1.cmml" xref="alg2.l22.m1.1.1.3.1"></minus><apply id="alg2.l22.m1.1.1.3.2.cmml" xref="alg2.l22.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.1.3.2.1.cmml" xref="alg2.l22.m1.1.1.3.2">superscript</csymbol><ci id="alg2.l22.m1.1.1.3.2.2.cmml" xref="alg2.l22.m1.1.1.3.2.2">𝑤</ci><apply id="alg2.l22.m1.1.1.3.2.3.cmml" xref="alg2.l22.m1.1.1.3.2.3"><minus id="alg2.l22.m1.1.1.3.2.3.1.cmml" xref="alg2.l22.m1.1.1.3.2.3.1"></minus><ci id="alg2.l22.m1.1.1.3.2.3.2.cmml" xref="alg2.l22.m1.1.1.3.2.3.2">𝑟</ci><cn type="integer" id="alg2.l22.m1.1.1.3.2.3.3.cmml" xref="alg2.l22.m1.1.1.3.2.3.3">1</cn></apply></apply><apply id="alg2.l22.m1.1.1.3.3.cmml" xref="alg2.l22.m1.1.1.3.3"><times id="alg2.l22.m1.1.1.3.3.1.cmml" xref="alg2.l22.m1.1.1.3.3.1"></times><apply id="alg2.l22.m1.1.1.3.3.2.cmml" xref="alg2.l22.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l22.m1.1.1.3.3.2.1.cmml" xref="alg2.l22.m1.1.1.3.3.2">superscript</csymbol><ci id="alg2.l22.m1.1.1.3.3.2.2.cmml" xref="alg2.l22.m1.1.1.3.3.2.2">𝜂</ci><ci id="alg2.l22.m1.1.1.3.3.2.3.cmml" xref="alg2.l22.m1.1.1.3.3.2.3">𝑟</ci></apply><apply id="alg2.l22.m1.1.1.3.3.3.cmml" xref="alg2.l22.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.l22.m1.1.1.3.3.3.1.cmml" xref="alg2.l22.m1.1.1.3.3.3">superscript</csymbol><apply id="alg2.l22.m1.1.1.3.3.3.2.cmml" xref="alg2.l22.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg2.l22.m1.1.1.3.3.3.2.1.cmml" xref="alg2.l22.m1.1.1.3.3.3">subscript</csymbol><ci id="alg2.l22.m1.1.1.3.3.3.2.2.cmml" xref="alg2.l22.m1.1.1.3.3.3.2.2">𝑚</ci><ci id="alg2.l22.m1.1.1.3.3.3.2.3.cmml" xref="alg2.l22.m1.1.1.3.3.3.2.3">𝑖</ci></apply><ci id="alg2.l22.m1.1.1.3.3.3.3.cmml" xref="alg2.l22.m1.1.1.3.3.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.m1.1c">w_{i}^{r}=w^{r-1}-\eta^{r}*m_{i}^{r}</annotation></semantics></math> 

</div>
<div id="alg2.l23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23:</span>     <span id="alg2.l23.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l23.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l24" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">24:</span>     Aggregate <math id="alg2.l24.m1.1" class="ltx_Math" alttext="w^{r}" display="inline"><semantics id="alg2.l24.m1.1a"><msup id="alg2.l24.m1.1.1" xref="alg2.l24.m1.1.1.cmml"><mi id="alg2.l24.m1.1.1.2" xref="alg2.l24.m1.1.1.2.cmml">w</mi><mi id="alg2.l24.m1.1.1.3" xref="alg2.l24.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l24.m1.1b"><apply id="alg2.l24.m1.1.1.cmml" xref="alg2.l24.m1.1.1"><csymbol cd="ambiguous" id="alg2.l24.m1.1.1.1.cmml" xref="alg2.l24.m1.1.1">superscript</csymbol><ci id="alg2.l24.m1.1.1.2.cmml" xref="alg2.l24.m1.1.1.2">𝑤</ci><ci id="alg2.l24.m1.1.1.3.cmml" xref="alg2.l24.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l24.m1.1c">w^{r}</annotation></semantics></math> based on Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> 

</div>
<div id="alg2.l25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">25:</span>     Aggregate <math id="alg2.l25.m1.1" class="ltx_Math" alttext="m^{r}" display="inline"><semantics id="alg2.l25.m1.1a"><msup id="alg2.l25.m1.1.1" xref="alg2.l25.m1.1.1.cmml"><mi id="alg2.l25.m1.1.1.2" xref="alg2.l25.m1.1.1.2.cmml">m</mi><mi id="alg2.l25.m1.1.1.3" xref="alg2.l25.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l25.m1.1b"><apply id="alg2.l25.m1.1.1.cmml" xref="alg2.l25.m1.1.1"><csymbol cd="ambiguous" id="alg2.l25.m1.1.1.1.cmml" xref="alg2.l25.m1.1.1">superscript</csymbol><ci id="alg2.l25.m1.1.1.2.cmml" xref="alg2.l25.m1.1.1.2">𝑚</ci><ci id="alg2.l25.m1.1.1.3.cmml" xref="alg2.l25.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l25.m1.1c">m^{r}</annotation></semantics></math> based on Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> 

</div>
<div id="alg2.l26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">26:</span>  <span id="alg2.l26.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l26.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
</figure>
<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">While data is generally non-IID, we propose a novel communication-efficient adaptive optimization to achieve superb performance without introducing extra communication costs. In order to achieve excellent performance, we propose applying adaptive optimization on both server based on momentum <cite class="ltx_cite ltx_citemacro_cite">Cutkosky and Mehta (<a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> and device sides based on Adam <cite class="ltx_cite ltx_citemacro_cite">Kingma and Ba (<a href="#bib.bib36" title="" class="ltx_ref">2015</a>)</cite>. We reset the first and the second momentum buffers to zero at the beginning of local update <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a href="#bib.bib78" title="" class="ltx_ref">2021</a>)</cite> to avoid extra communication of the momentum variables between the server and the device. In addition, we maintain a state for each device on the server to avoid possible client drift problem incurred by non-IID <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib35" title="" class="ltx_ref">2020b</a>)</cite>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<div id="S4.T1.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:150.3pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-70.4pt,24.3pt) scale(0.754849774303856,0.754849774303856) ;">
<table id="S4.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S4.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.2.1" class="ltx_text ltx_font_bold">Comm. Params</span></th>
<th id="S4.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.3.1" class="ltx_text ltx_font_bold">QNLI</span></th>
<th id="S4.T1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.4.1" class="ltx_text ltx_font_bold">SST-2</span></th>
<th id="S4.T1.1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.5.1" class="ltx_text ltx_font_bold">CoLA</span></th>
<th id="S4.T1.1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.6.1" class="ltx_text ltx_font_bold">MPRC</span></th>
<th id="S4.T1.1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.7.1" class="ltx_text ltx_font_bold">RTE</span></th>
<th id="S4.T1.1.1.1.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.8.1" class="ltx_text ltx_font_bold">BoolQ</span></th>
<th id="S4.T1.1.1.1.1.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.9.1" class="ltx_text ltx_font_bold">MPQA</span></th>
<th id="S4.T1.1.1.1.1.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.10.1" class="ltx_text ltx_font_bold">Subj</span></th>
<th id="S4.T1.1.1.1.1.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.11.1" class="ltx_text ltx_font_bold">Trec</span></th>
<th id="S4.T1.1.1.1.1.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.12.1" class="ltx_text ltx_font_bold">MR</span></th>
<th id="S4.T1.1.1.1.1.13" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T1.1.1.1.1.13.1" class="ltx_text ltx_font_bold">Avg</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.2.1" class="ltx_tr">
<td id="S4.T1.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">Adapter</td>
<td id="S4.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="background-color:#8C8C8C;"><span id="S4.T1.1.1.2.1.2.1" class="ltx_text" style="background-color:#8C8C8C;">7.4M</span></td>
<td id="S4.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">87.79</td>
<td id="S4.T1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">94.04</td>
<td id="S4.T1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">30.96</td>
<td id="S4.T1.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">71.81</td>
<td id="S4.T1.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">68.59</td>
<td id="S4.T1.1.1.2.1.8" class="ltx_td ltx_align_center ltx_border_t">75.11</td>
<td id="S4.T1.1.1.2.1.9" class="ltx_td ltx_align_center ltx_border_t">90.97</td>
<td id="S4.T1.1.1.2.1.10" class="ltx_td ltx_align_center ltx_border_t">94.6</td>
<td id="S4.T1.1.1.2.1.11" class="ltx_td ltx_align_center ltx_border_t">79</td>
<td id="S4.T1.1.1.2.1.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.2.1.12.1" class="ltx_text ltx_framed ltx_framed_underline">91.9</span></td>
<td id="S4.T1.1.1.2.1.13" class="ltx_td ltx_align_center ltx_border_t">75.36</td>
</tr>
<tr id="S4.T1.1.1.3.2" class="ltx_tr">
<td id="S4.T1.1.1.3.2.1" class="ltx_td ltx_align_center">FedPrompt</td>
<td id="S4.T1.1.1.3.2.2" class="ltx_td ltx_align_center" style="background-color:#F2F2F2;"><span id="S4.T1.1.1.3.2.2.1" class="ltx_text" style="background-color:#F2F2F2;">131K</span></td>
<td id="S4.T1.1.1.3.2.3" class="ltx_td ltx_align_center">85.91</td>
<td id="S4.T1.1.1.3.2.4" class="ltx_td ltx_align_center">94.84</td>
<td id="S4.T1.1.1.3.2.5" class="ltx_td ltx_align_center">33.05</td>
<td id="S4.T1.1.1.3.2.6" class="ltx_td ltx_align_center">77.87</td>
<td id="S4.T1.1.1.3.2.7" class="ltx_td ltx_align_center">61.73</td>
<td id="S4.T1.1.1.3.2.8" class="ltx_td ltx_align_center">74.77</td>
<td id="S4.T1.1.1.3.2.9" class="ltx_td ltx_align_center">90.45</td>
<td id="S4.T1.1.1.3.2.10" class="ltx_td ltx_align_center">94.25</td>
<td id="S4.T1.1.1.3.2.11" class="ltx_td ltx_align_center">95</td>
<td id="S4.T1.1.1.3.2.12" class="ltx_td ltx_align_center">91.65</td>
<td id="S4.T1.1.1.3.2.13" class="ltx_td ltx_align_center">76.85</td>
</tr>
<tr id="S4.T1.1.1.4.3" class="ltx_tr">
<td id="S4.T1.1.1.4.3.1" class="ltx_td ltx_align_center">P-tuning v2</td>
<td id="S4.T1.1.1.4.3.2" class="ltx_td ltx_align_center" style="background-color:#8C8C8C;"><span id="S4.T1.1.1.4.3.2.1" class="ltx_text" style="background-color:#8C8C8C;">6.3M</span></td>
<td id="S4.T1.1.1.4.3.3" class="ltx_td ltx_align_center">85.19</td>
<td id="S4.T1.1.1.4.3.4" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.4.3.4.1" class="ltx_text ltx_framed ltx_framed_underline">95.3</span></td>
<td id="S4.T1.1.1.4.3.5" class="ltx_td ltx_align_center">41.82</td>
<td id="S4.T1.1.1.4.3.6" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.4.3.6.1" class="ltx_text ltx_framed ltx_framed_underline">82.78</span></td>
<td id="S4.T1.1.1.4.3.7" class="ltx_td ltx_align_center">79.42</td>
<td id="S4.T1.1.1.4.3.8" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.4.3.8.1" class="ltx_text ltx_framed ltx_framed_underline">79.66</span></td>
<td id="S4.T1.1.1.4.3.9" class="ltx_td ltx_align_center">91</td>
<td id="S4.T1.1.1.4.3.10" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.4.3.10.1" class="ltx_text ltx_framed ltx_framed_underline">96.9</span></td>
<td id="S4.T1.1.1.4.3.11" class="ltx_td ltx_align_center">96.4</td>
<td id="S4.T1.1.1.4.3.12" class="ltx_td ltx_align_center">91.45</td>
<td id="S4.T1.1.1.4.3.13" class="ltx_td ltx_align_center">82.05</td>
</tr>
<tr id="S4.T1.1.1.5.4" class="ltx_tr">
<td id="S4.T1.1.1.5.4.1" class="ltx_td ltx_align_center">Prompt Tuning</td>
<td id="S4.T1.1.1.5.4.2" class="ltx_td ltx_align_center" style="background-color:#F2F2F2;"><span id="S4.T1.1.1.5.4.2.1" class="ltx_text" style="background-color:#F2F2F2;">20K</span></td>
<td id="S4.T1.1.1.5.4.3" class="ltx_td ltx_align_center">51.62</td>
<td id="S4.T1.1.1.5.4.4" class="ltx_td ltx_align_center">61.01</td>
<td id="S4.T1.1.1.5.4.5" class="ltx_td ltx_align_center">3.36</td>
<td id="S4.T1.1.1.5.4.6" class="ltx_td ltx_align_center">48.04</td>
<td id="S4.T1.1.1.5.4.7" class="ltx_td ltx_align_center">52.35</td>
<td id="S4.T1.1.1.5.4.8" class="ltx_td ltx_align_center">59.72</td>
<td id="S4.T1.1.1.5.4.9" class="ltx_td ltx_align_center">81.65</td>
<td id="S4.T1.1.1.5.4.10" class="ltx_td ltx_align_center">65.2</td>
<td id="S4.T1.1.1.5.4.11" class="ltx_td ltx_align_center">36.4</td>
<td id="S4.T1.1.1.5.4.12" class="ltx_td ltx_align_center">63.25</td>
<td id="S4.T1.1.1.5.4.13" class="ltx_td ltx_align_center">42.56</td>
</tr>
<tr id="S4.T1.1.1.6.5" class="ltx_tr">
<td id="S4.T1.1.1.6.5.1" class="ltx_td ltx_align_center">IDPG</td>
<td id="S4.T1.1.1.6.5.2" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><span id="S4.T1.1.1.6.5.2.1" class="ltx_text" style="background-color:#E6E6E6;">137K</span></td>
<td id="S4.T1.1.1.6.5.3" class="ltx_td ltx_align_center">72.2</td>
<td id="S4.T1.1.1.6.5.4" class="ltx_td ltx_align_center">93.01</td>
<td id="S4.T1.1.1.6.5.5" class="ltx_td ltx_align_center">4.59</td>
<td id="S4.T1.1.1.6.5.6" class="ltx_td ltx_align_center">70.83</td>
<td id="S4.T1.1.1.6.5.7" class="ltx_td ltx_align_center">70.4</td>
<td id="S4.T1.1.1.6.5.8" class="ltx_td ltx_align_center">71.96</td>
<td id="S4.T1.1.1.6.5.9" class="ltx_td ltx_align_center">90.07</td>
<td id="S4.T1.1.1.6.5.10" class="ltx_td ltx_align_center">94</td>
<td id="S4.T1.1.1.6.5.11" class="ltx_td ltx_align_center">78.4</td>
<td id="S4.T1.1.1.6.5.12" class="ltx_td ltx_align_center">91.4</td>
<td id="S4.T1.1.1.6.5.13" class="ltx_td ltx_align_center">60.63</td>
</tr>
<tr id="S4.T1.1.1.7.6" class="ltx_tr">
<td id="S4.T1.1.1.7.6.1" class="ltx_td ltx_align_center">ATTEMPT</td>
<td id="S4.T1.1.1.7.6.2" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><span id="S4.T1.1.1.7.6.2.1" class="ltx_text" style="background-color:#E6E6E6;">207k</span></td>
<td id="S4.T1.1.1.7.6.3" class="ltx_td ltx_align_center">54.93</td>
<td id="S4.T1.1.1.7.6.4" class="ltx_td ltx_align_center">85.89</td>
<td id="S4.T1.1.1.7.6.5" class="ltx_td ltx_align_center">4.63</td>
<td id="S4.T1.1.1.7.6.6" class="ltx_td ltx_align_center">78.65</td>
<td id="S4.T1.1.1.7.6.7" class="ltx_td ltx_align_center">58.48</td>
<td id="S4.T1.1.1.7.6.8" class="ltx_td ltx_align_center">73.49</td>
<td id="S4.T1.1.1.7.6.9" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.7.6.9.1" class="ltx_text ltx_framed ltx_framed_underline">91.05</span></td>
<td id="S4.T1.1.1.7.6.10" class="ltx_td ltx_align_center">88.95</td>
<td id="S4.T1.1.1.7.6.11" class="ltx_td ltx_align_center">82.2</td>
<td id="S4.T1.1.1.7.6.12" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.7.6.12.1" class="ltx_text ltx_framed ltx_framed_underline">91.9</span></td>
<td id="S4.T1.1.1.7.6.13" class="ltx_td ltx_align_center">58.28</td>
</tr>
<tr id="S4.T1.1.1.8.7" class="ltx_tr">
<td id="S4.T1.1.1.8.7.1" class="ltx_td ltx_align_center">LPT</td>
<td id="S4.T1.1.1.8.7.2" class="ltx_td ltx_align_center" style="background-color:#B3B3B3;"><span id="S4.T1.1.1.8.7.2.1" class="ltx_text" style="background-color:#B3B3B3;">792k</span></td>
<td id="S4.T1.1.1.8.7.3" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.8.7.3.1" class="ltx_text ltx_framed ltx_framed_underline">89.2</span></td>
<td id="S4.T1.1.1.8.7.4" class="ltx_td ltx_align_center">94.84</td>
<td id="S4.T1.1.1.8.7.5" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.8.7.5.1" class="ltx_text ltx_framed ltx_framed_underline">53.7</span></td>
<td id="S4.T1.1.1.8.7.6" class="ltx_td ltx_align_center">82.07</td>
<td id="S4.T1.1.1.8.7.7" class="ltx_td ltx_align_center">79.7</td>
<td id="S4.T1.1.1.8.7.8" class="ltx_td ltx_align_center">62.7</td>
<td id="S4.T1.1.1.8.7.9" class="ltx_td ltx_align_center">90.55</td>
<td id="S4.T1.1.1.8.7.10" class="ltx_td ltx_align_center">96.5</td>
<td id="S4.T1.1.1.8.7.11" class="ltx_td ltx_align_center">96.4</td>
<td id="S4.T1.1.1.8.7.12" class="ltx_td ltx_align_center">91.4</td>
<td id="S4.T1.1.1.8.7.13" class="ltx_td ltx_align_center">82.35</td>
</tr>
<tr id="S4.T1.1.1.9.8" class="ltx_tr">
<td id="S4.T1.1.1.9.8.1" class="ltx_td ltx_align_center">MomD</td>
<td id="S4.T1.1.1.9.8.2" class="ltx_td ltx_align_center" style="background-color:#8C8C8C;"><span id="S4.T1.1.1.9.8.2.1" class="ltx_text" style="background-color:#8C8C8C;">6.3M</span></td>
<td id="S4.T1.1.1.9.8.3" class="ltx_td ltx_align_center">67.42</td>
<td id="S4.T1.1.1.9.8.4" class="ltx_td ltx_align_center">93.92</td>
<td id="S4.T1.1.1.9.8.5" class="ltx_td ltx_align_center">1.64</td>
<td id="S4.T1.1.1.9.8.6" class="ltx_td ltx_align_center">75.17</td>
<td id="S4.T1.1.1.9.8.7" class="ltx_td ltx_align_center">75.45</td>
<td id="S4.T1.1.1.9.8.8" class="ltx_td ltx_align_center">62.02</td>
<td id="S4.T1.1.1.9.8.9" class="ltx_td ltx_align_center">89.05</td>
<td id="S4.T1.1.1.9.8.10" class="ltx_td ltx_align_center">49.95</td>
<td id="S4.T1.1.1.9.8.11" class="ltx_td ltx_align_center">38.6</td>
<td id="S4.T1.1.1.9.8.12" class="ltx_td ltx_align_center">83</td>
<td id="S4.T1.1.1.9.8.13" class="ltx_td ltx_align_center">63.62</td>
</tr>
<tr id="S4.T1.1.1.10.9" class="ltx_tr">
<td id="S4.T1.1.1.10.9.1" class="ltx_td ltx_align_center">MomS+AdamD</td>
<td id="S4.T1.1.1.10.9.2" class="ltx_td ltx_align_center" style="background-color:#8C8C8C;"><span id="S4.T1.1.1.10.9.2.1" class="ltx_text" style="background-color:#8C8C8C;">6.3M</span></td>
<td id="S4.T1.1.1.10.9.3" class="ltx_td ltx_align_center">87.85</td>
<td id="S4.T1.1.1.10.9.4" class="ltx_td ltx_align_center">95.18</td>
<td id="S4.T1.1.1.10.9.5" class="ltx_td ltx_align_center">42.96</td>
<td id="S4.T1.1.1.10.9.6" class="ltx_td ltx_align_center">80.15</td>
<td id="S4.T1.1.1.10.9.7" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.7.1" class="ltx_text ltx_framed ltx_framed_underline">82.31</span></td>
<td id="S4.T1.1.1.10.9.8" class="ltx_td ltx_align_center">78.1</td>
<td id="S4.T1.1.1.10.9.9" class="ltx_td ltx_align_center">90.95</td>
<td id="S4.T1.1.1.10.9.10" class="ltx_td ltx_align_center">96.75</td>
<td id="S4.T1.1.1.10.9.11" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.11.1" class="ltx_text ltx_framed ltx_framed_underline">96.8</span></td>
<td id="S4.T1.1.1.10.9.12" class="ltx_td ltx_align_center">91.55</td>
<td id="S4.T1.1.1.10.9.13" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.13.1" class="ltx_text ltx_framed ltx_framed_underline">84.26</span></td>
</tr>
<tr id="S4.T1.1.1.11.10" class="ltx_tr">
<td id="S4.T1.1.1.11.10.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T1.1.1.11.10.1.1" class="ltx_ERROR undefined">\hdashline</span>FedPepTAO</td>
<td id="S4.T1.1.1.11.10.2" class="ltx_td ltx_align_center ltx_border_bb" style="background-color:#E6E6E6;"><span id="S4.T1.1.1.11.10.2.1" class="ltx_text" style="background-color:#E6E6E6;">492K</span></td>
<td id="S4.T1.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.3.1" class="ltx_text ltx_font_bold">89.57</span></td>
<td id="S4.T1.1.1.11.10.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.4.1" class="ltx_text ltx_font_bold">95.87</span></td>
<td id="S4.T1.1.1.11.10.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.5.1" class="ltx_text ltx_font_bold">56.35</span></td>
<td id="S4.T1.1.1.11.10.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.6.1" class="ltx_text ltx_font_bold">87.52</span></td>
<td id="S4.T1.1.1.11.10.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.7.1" class="ltx_text ltx_font_bold">85.56</span></td>
<td id="S4.T1.1.1.11.10.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.8.1" class="ltx_text ltx_font_bold">79.72</span></td>
<td id="S4.T1.1.1.11.10.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.9.1" class="ltx_text ltx_font_bold">91.4</span></td>
<td id="S4.T1.1.1.11.10.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.10.1" class="ltx_text ltx_font_bold">97.1</span></td>
<td id="S4.T1.1.1.11.10.11" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.11.1" class="ltx_text ltx_font_bold">97.2</span></td>
<td id="S4.T1.1.1.11.10.12" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.12.1" class="ltx_text ltx_font_bold">93</span></td>
<td id="S4.T1.1.1.11.10.13" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T1.1.1.11.10.13.1" class="ltx_text ltx_font_bold">86.4</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>The accuracy with FedPepTAO and diverse baseline approaches. All the methods from GLUE benchmark are evaluated on development sets while other tasks are evaluated with test sets. The best results are highlighted in <span id="S4.T1.5.1" class="ltx_text ltx_font_bold">bold</span> and the second bests are marked with <span id="S4.T1.6.2" class="ltx_text ltx_framed ltx_framed_underline">underline</span>. All the results are obtained using RoBERTa<sub id="S4.T1.7.3" class="ltx_sub">LARGE</sub>.</figcaption>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.2" class="ltx_p">The algorithm of communication-efficient adaptive optimization for FL prompt tuning is shown in Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Within each round, we first randomly sample a subset of devices (Line <a href="#alg2.l3" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Then, the prompt parameters corresponding to the model in the last round is sent to each device (Line <a href="#alg2.l5" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), and each selected device perform local update based on Adam (Lines <a href="#alg2.l7" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> - <a href="#alg2.l8" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>). Afterward, each selected device returns the accumulated difference of the prompt parameters to the server (Line <a href="#alg2.l10" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>). Please note that the execution of Lines <a href="#alg2.l4" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> - <a href="#alg2.l11" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> can be performed in parallel on each selected device. We aggregate the differences based on Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (Line <a href="#alg2.l12" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>). Inspired by <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib35" title="" class="ltx_ref">2020b</a>)</cite>, we calculate the control variate <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="c_{i}^{r}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><msubsup id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2.2" xref="S4.SS3.p2.1.m1.1.1.2.2.cmml">c</mi><mi id="S4.SS3.p2.1.m1.1.1.2.3" xref="S4.SS3.p2.1.m1.1.1.2.3.cmml">i</mi><mi id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.2.1.cmml" xref="S4.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2.2">𝑐</ci><ci id="S4.SS3.p2.1.m1.1.1.2.3.cmml" xref="S4.SS3.p2.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">c_{i}^{r}</annotation></semantics></math> (Line <a href="#alg2.l14" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>) and the corresponding difference <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="\Delta c_{i}^{r}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi mathvariant="normal" id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">​</mo><msubsup id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml"><mi id="S4.SS3.p2.2.m2.1.1.3.2.2" xref="S4.SS3.p2.2.m2.1.1.3.2.2.cmml">c</mi><mi id="S4.SS3.p2.2.m2.1.1.3.2.3" xref="S4.SS3.p2.2.m2.1.1.3.2.3.cmml">i</mi><mi id="S4.SS3.p2.2.m2.1.1.3.3" xref="S4.SS3.p2.2.m2.1.1.3.3.cmml">r</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><times id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1"></times><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">Δ</ci><apply id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3">superscript</csymbol><apply id="S4.SS3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.3.2.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.3.2.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.2.2">𝑐</ci><ci id="S4.SS3.p2.2.m2.1.1.3.2.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3.2.3">𝑖</ci></apply><ci id="S4.SS3.p2.2.m2.1.1.3.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\Delta c_{i}^{r}</annotation></semantics></math> (Line <a href="#alg2.l15" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">15</span></a>) for each device on the server. We aggregate the control variate differences based on Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> (Line <a href="#alg2.l17" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a>), and calculate the global control variate (Line <a href="#alg2.l18" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">18</span></a>) and global gradients (Line <a href="#alg2.l19" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">19</span></a>). Afterword, we update the momentum (Line <a href="#alg2.l21" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">21</span></a>) and prompt parameters (Line <a href="#alg2.l22" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">22</span></a>) for each selected device. Finally, we aggregate the global prompt parameters (Line <a href="#alg2.l24" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">24</span></a>) and momentum (Line <a href="#alg2.l25" title="In Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">25</span></a>). The communication cost of Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> depends on the size of prompt parameters, which is similar to that of FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib57" title="" class="ltx_ref">2017</a>)</cite>, while achieving superb performance.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we present the experimental results over 9 baselines and 10 commonly-used tasks to demonstrate the advantages of FedPepTAO.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We consider an FL environment with 100 devices and a parameter server. In each epoch, we randomly sample 10 devices to perform the local update. We exploit 10 widely used NLP tasks including QNLI <cite class="ltx_cite ltx_citemacro_cite">Rajpurkar et al. (<a href="#bib.bib65" title="" class="ltx_ref">2016</a>)</cite>, SST-2 <cite class="ltx_cite ltx_citemacro_cite">Socher et al. (<a href="#bib.bib70" title="" class="ltx_ref">2013</a>)</cite>, CoLA <cite class="ltx_cite ltx_citemacro_cite">Warstadt et al. (<a href="#bib.bib80" title="" class="ltx_ref">2019</a>)</cite>, MRPC <cite class="ltx_cite ltx_citemacro_cite">Dolan and Brockett (<a href="#bib.bib16" title="" class="ltx_ref">2005</a>)</cite>, RTE <cite class="ltx_cite ltx_citemacro_cite">Giampiccolo et al. (<a href="#bib.bib21" title="" class="ltx_ref">2007</a>)</cite>, and BoolQ <cite class="ltx_cite ltx_citemacro_cite">Clark et al. (<a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite> from the GLUE benchmark, and 4 other tasks including MPQA <cite class="ltx_cite ltx_citemacro_cite">Wiebe et al. (<a href="#bib.bib81" title="" class="ltx_ref">2005</a>)</cite>, Subj <cite class="ltx_cite ltx_citemacro_cite">Pang and Lee (<a href="#bib.bib62" title="" class="ltx_ref">2004</a>)</cite>, TREC <cite class="ltx_cite ltx_citemacro_cite">Voorhees and Tice (<a href="#bib.bib75" title="" class="ltx_ref">2000</a>)</cite>, and MR <cite class="ltx_cite ltx_citemacro_cite">Pang and Lee (<a href="#bib.bib63" title="" class="ltx_ref">2005</a>)</cite> (Please see details in Appendix <a href="#A1.SS2" title="A.2 Details for Experimental Setup ‣ Appendix A Implementation Details ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>). We take 9 existing approaches as baselines, including an adapter-based method, i.e., Adapter <cite class="ltx_cite ltx_citemacro_cite">Houlsby et al. (<a href="#bib.bib26" title="" class="ltx_ref">2019</a>)</cite>, 6 prompt-based tuning methods, i.e., FedPrompt <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a href="#bib.bib94" title="" class="ltx_ref">2023</a>)</cite>, P-tuning v2 <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib54" title="" class="ltx_ref">2022d</a>)</cite>, Prompt Tuning <cite class="ltx_cite ltx_citemacro_cite">Lester et al. (<a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>, IDPG <cite class="ltx_cite ltx_citemacro_cite">Wu et al. (<a href="#bib.bib83" title="" class="ltx_ref">2022</a>)</cite>, ATTEMPT <cite class="ltx_cite ltx_citemacro_cite">Asai et al. (<a href="#bib.bib1" title="" class="ltx_ref">2022</a>)</cite>, LPT <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib53" title="" class="ltx_ref">2022c</a>)</cite>, and 2 optimization approaches, i.e., momentum on the device side with simple SGD on the server side (MomD) <cite class="ltx_cite ltx_citemacro_cite">Karimireddy et al. (<a href="#bib.bib34" title="" class="ltx_ref">2020a</a>)</cite> and momentum on the server side with Adam on the device side without control variate (MomS+AdamD). We adapt the centralized methods, i.e., Adapter, P-tuning v2, Prompt Tuning, IDPG (S-IDPG-PHM), ATTEMPT, and LPT, with FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib57" title="" class="ltx_ref">2017</a>)</cite> to the FL setting for a fair comparison.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">We evaluate FedPepTAO and all other methods on RoBERTa<sub id="S5.SS1.p2.1.1" class="ltx_sub">LARGE</sub> <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib56" title="" class="ltx_ref">2019b</a>)</cite>, which consists of 24 layers of transformers followed by a large language model head and 355M pre-trained parameters. To demonstrate the adaptability of FedPepTAO, we carried out extra experiments with three additional decoder-based models, i.e., GPT2<sub id="S5.SS1.p2.1.2" class="ltx_sub">LARGE</sub> model <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a href="#bib.bib64" title="" class="ltx_ref">2019</a>)</cite> with 774M parameters on MRPC, MR, SST-2 dataset, LLaMA 3B model <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a href="#bib.bib74" title="" class="ltx_ref">2023</a>)</cite> on RTE, MRPC dataset, and LLaMA 7B model <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a href="#bib.bib74" title="" class="ltx_ref">2023</a>)</cite> on MRPC dataset. The backbones of these models are frozen for all methods.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Evaluation of FedPepTAO</h3>

<figure id="S5.T2" class="ltx_table">
<div id="S5.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:325.2pt;height:142.8pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-64.0pt,28.0pt) scale(0.717516710239568,0.717516710239568) ;">
<table id="S5.T2.1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.1.1.1.1" class="ltx_tr">
<td id="S5.T2.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S5.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.2.1" class="ltx_text ltx_font_bold">QNLI</span></td>
<td id="S5.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.3.1" class="ltx_text ltx_font_bold">SST-2</span></td>
<td id="S5.T2.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.4.1" class="ltx_text ltx_font_bold">CoLA</span></td>
<td id="S5.T2.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.5.1" class="ltx_text ltx_font_bold">MPRC</span></td>
<td id="S5.T2.1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.6.1" class="ltx_text ltx_font_bold">RTE</span></td>
<td id="S5.T2.1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.7.1" class="ltx_text ltx_font_bold">BoolQ</span></td>
<td id="S5.T2.1.1.1.1.8" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.8.1" class="ltx_text ltx_font_bold">MPQA</span></td>
<td id="S5.T2.1.1.1.1.9" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.9.1" class="ltx_text ltx_font_bold">Subj</span></td>
<td id="S5.T2.1.1.1.1.10" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.10.1" class="ltx_text ltx_font_bold">Trec</span></td>
<td id="S5.T2.1.1.1.1.11" class="ltx_td ltx_align_center ltx_border_tt"><span id="S5.T2.1.1.1.1.11.1" class="ltx_text ltx_font_bold">MR</span></td>
</tr>
<tr id="S5.T2.1.1.2.2" class="ltx_tr">
<td id="S5.T2.1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_t">Adapter</td>
<td id="S5.T2.1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">8096</td>
<td id="S5.T2.1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">1065</td>
<td id="S5.T2.1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">2655</td>
<td id="S5.T2.1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">/</td>
<td id="S5.T2.1.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">2218</td>
<td id="S5.T2.1.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">937</td>
<td id="S5.T2.1.1.2.2.8" class="ltx_td ltx_align_center ltx_border_t">758</td>
<td id="S5.T2.1.1.2.2.9" class="ltx_td ltx_align_center ltx_border_t">1178</td>
<td id="S5.T2.1.1.2.2.10" class="ltx_td ltx_align_center ltx_border_t">1388</td>
<td id="S5.T2.1.1.2.2.11" class="ltx_td ltx_align_center ltx_border_t">1797</td>
</tr>
<tr id="S5.T2.1.1.3.3" class="ltx_tr">
<td id="S5.T2.1.1.3.3.1" class="ltx_td ltx_align_center">FedPrompt</td>
<td id="S5.T2.1.1.3.3.2" class="ltx_td ltx_align_center">12987</td>
<td id="S5.T2.1.1.3.3.3" class="ltx_td ltx_align_center">668</td>
<td id="S5.T2.1.1.3.3.4" class="ltx_td ltx_align_center">1471</td>
<td id="S5.T2.1.1.3.3.5" class="ltx_td ltx_align_center">1824</td>
<td id="S5.T2.1.1.3.3.6" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.3.3.7" class="ltx_td ltx_align_center">1485</td>
<td id="S5.T2.1.1.3.3.8" class="ltx_td ltx_align_center">412</td>
<td id="S5.T2.1.1.3.3.9" class="ltx_td ltx_align_center">1284</td>
<td id="S5.T2.1.1.3.3.10" class="ltx_td ltx_align_center">336</td>
<td id="S5.T2.1.1.3.3.11" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.3.3.11.1" class="ltx_text ltx_framed ltx_framed_underline">618</span></td>
</tr>
<tr id="S5.T2.1.1.4.4" class="ltx_tr">
<td id="S5.T2.1.1.4.4.1" class="ltx_td ltx_align_center">P-tuning v2</td>
<td id="S5.T2.1.1.4.4.2" class="ltx_td ltx_align_center">10780</td>
<td id="S5.T2.1.1.4.4.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.4.3.1" class="ltx_text ltx_font_bold">17</span></td>
<td id="S5.T2.1.1.4.4.4" class="ltx_td ltx_align_center">489</td>
<td id="S5.T2.1.1.4.4.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.4.5.1" class="ltx_text ltx_font_bold">154</span></td>
<td id="S5.T2.1.1.4.4.6" class="ltx_td ltx_align_center">201</td>
<td id="S5.T2.1.1.4.4.7" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.4.7.1" class="ltx_text ltx_framed ltx_framed_underline">135</span></td>
<td id="S5.T2.1.1.4.4.8" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.4.8.1" class="ltx_text ltx_framed ltx_framed_underline">105</span></td>
<td id="S5.T2.1.1.4.4.9" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.4.9.1" class="ltx_text ltx_framed ltx_framed_underline">132</span></td>
<td id="S5.T2.1.1.4.4.10" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.4.10.1" class="ltx_text ltx_framed ltx_framed_underline">95</span></td>
<td id="S5.T2.1.1.4.4.11" class="ltx_td ltx_align_center">748</td>
</tr>
<tr id="S5.T2.1.1.5.5" class="ltx_tr">
<td id="S5.T2.1.1.5.5.1" class="ltx_td ltx_align_center">Prompt Tuning</td>
<td id="S5.T2.1.1.5.5.2" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.3" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.4" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.5" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.6" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.7" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.8" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.9" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.10" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.5.5.11" class="ltx_td ltx_align_center">/</td>
</tr>
<tr id="S5.T2.1.1.6.6" class="ltx_tr">
<td id="S5.T2.1.1.6.6.1" class="ltx_td ltx_align_center">IDPG</td>
<td id="S5.T2.1.1.6.6.2" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.6.6.3" class="ltx_td ltx_align_center">3322</td>
<td id="S5.T2.1.1.6.6.4" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.6.6.5" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.6.6.6" class="ltx_td ltx_align_center">689</td>
<td id="S5.T2.1.1.6.6.7" class="ltx_td ltx_align_center">3254</td>
<td id="S5.T2.1.1.6.6.8" class="ltx_td ltx_align_center">908</td>
<td id="S5.T2.1.1.6.6.9" class="ltx_td ltx_align_center">1347</td>
<td id="S5.T2.1.1.6.6.10" class="ltx_td ltx_align_center">1220</td>
<td id="S5.T2.1.1.6.6.11" class="ltx_td ltx_align_center">1912</td>
</tr>
<tr id="S5.T2.1.1.7.7" class="ltx_tr">
<td id="S5.T2.1.1.7.7.1" class="ltx_td ltx_align_center">ATTEMPT</td>
<td id="S5.T2.1.1.7.7.2" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.7.7.3" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.7.7.4" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.7.7.5" class="ltx_td ltx_align_center">1774</td>
<td id="S5.T2.1.1.7.7.6" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.7.7.7" class="ltx_td ltx_align_center">973</td>
<td id="S5.T2.1.1.7.7.8" class="ltx_td ltx_align_center">438</td>
<td id="S5.T2.1.1.7.7.9" class="ltx_td ltx_align_center">2573</td>
<td id="S5.T2.1.1.7.7.10" class="ltx_td ltx_align_center">1028</td>
<td id="S5.T2.1.1.7.7.11" class="ltx_td ltx_align_center">1221</td>
</tr>
<tr id="S5.T2.1.1.8.8" class="ltx_tr">
<td id="S5.T2.1.1.8.8.1" class="ltx_td ltx_align_center">LPT</td>
<td id="S5.T2.1.1.8.8.2" class="ltx_td ltx_align_center">2918</td>
<td id="S5.T2.1.1.8.8.3" class="ltx_td ltx_align_center">650</td>
<td id="S5.T2.1.1.8.8.4" class="ltx_td ltx_align_center">733</td>
<td id="S5.T2.1.1.8.8.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.8.8.5.1" class="ltx_text ltx_framed ltx_framed_underline">156</span></td>
<td id="S5.T2.1.1.8.8.6" class="ltx_td ltx_align_center">270</td>
<td id="S5.T2.1.1.8.8.7" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.8.8.8" class="ltx_td ltx_align_center">162</td>
<td id="S5.T2.1.1.8.8.9" class="ltx_td ltx_align_center">155</td>
<td id="S5.T2.1.1.8.8.10" class="ltx_td ltx_align_center">112</td>
<td id="S5.T2.1.1.8.8.11" class="ltx_td ltx_align_center">860</td>
</tr>
<tr id="S5.T2.1.1.9.9" class="ltx_tr">
<td id="S5.T2.1.1.9.9.1" class="ltx_td ltx_align_center">MomD</td>
<td id="S5.T2.1.1.9.9.2" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.9.9.3" class="ltx_td ltx_align_center">1328</td>
<td id="S5.T2.1.1.9.9.4" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.9.9.5" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.9.9.6" class="ltx_td ltx_align_center">838</td>
<td id="S5.T2.1.1.9.9.7" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.9.9.8" class="ltx_td ltx_align_center">537</td>
<td id="S5.T2.1.1.9.9.9" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.9.9.10" class="ltx_td ltx_align_center">/</td>
<td id="S5.T2.1.1.9.9.11" class="ltx_td ltx_align_center">/</td>
</tr>
<tr id="S5.T2.1.1.10.10" class="ltx_tr">
<td id="S5.T2.1.1.10.10.1" class="ltx_td ltx_align_center">MomS+AdamD</td>
<td id="S5.T2.1.1.10.10.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.10.10.2.1" class="ltx_text ltx_font_bold">697</span></td>
<td id="S5.T2.1.1.10.10.3" class="ltx_td ltx_align_center">209</td>
<td id="S5.T2.1.1.10.10.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.10.10.4.1" class="ltx_text ltx_framed ltx_framed_underline">488</span></td>
<td id="S5.T2.1.1.10.10.5" class="ltx_td ltx_align_center">1178</td>
<td id="S5.T2.1.1.10.10.6" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.10.10.6.1" class="ltx_text ltx_framed ltx_framed_underline">192</span></td>
<td id="S5.T2.1.1.10.10.7" class="ltx_td ltx_align_center">139</td>
<td id="S5.T2.1.1.10.10.8" class="ltx_td ltx_align_center">141</td>
<td id="S5.T2.1.1.10.10.9" class="ltx_td ltx_align_center">166</td>
<td id="S5.T2.1.1.10.10.10" class="ltx_td ltx_align_center">100</td>
<td id="S5.T2.1.1.10.10.11" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.10.10.11.1" class="ltx_text ltx_font_bold">610</span></td>
</tr>
<tr id="S5.T2.1.1.11.11" class="ltx_tr">
<td id="S5.T2.1.1.11.11.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T2.1.1.11.11.1.1" class="ltx_ERROR undefined">\hdashline</span>FedPepTAO</td>
<td id="S5.T2.1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.2.1" class="ltx_text ltx_framed ltx_framed_underline">781</span></td>
<td id="S5.T2.1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.3.1" class="ltx_text ltx_framed ltx_framed_underline">97</span></td>
<td id="S5.T2.1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.4.1" class="ltx_text ltx_font_bold">219</span></td>
<td id="S5.T2.1.1.11.11.5" class="ltx_td ltx_align_center ltx_border_bb">230</td>
<td id="S5.T2.1.1.11.11.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.6.1" class="ltx_text ltx_font_bold">186</span></td>
<td id="S5.T2.1.1.11.11.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.7.1" class="ltx_text ltx_font_bold">129</span></td>
<td id="S5.T2.1.1.11.11.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.8.1" class="ltx_text ltx_font_bold">31</span></td>
<td id="S5.T2.1.1.11.11.9" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.9.1" class="ltx_text ltx_font_bold">62</span></td>
<td id="S5.T2.1.1.11.11.10" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.10.1" class="ltx_text ltx_font_bold">76</span></td>
<td id="S5.T2.1.1.11.11.11" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.1.11.11.11.1" class="ltx_text ltx_font_bold">610</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>The tuning time (s) to achieve a target accuracy (85% for QNLI, 92.5% for SST-2, 3% for CoLA, 77% for MRPC, 65% for RTE, 71% for BoolQ, 85% for MPQA, 88% for Subj, 78% for Trec, 91% for MR)with FedPepTAO and diverse baseline approaches. "/" represents that training does not achieve the target accuracy. The best results are highlighted in <span id="S5.T2.5.1" class="ltx_text ltx_font_bold">bold</span> and the second bests are marked with <span id="S5.T2.6.2" class="ltx_text ltx_framed ltx_framed_underline">underline</span>. All the results are obtained using RoBERTa<sub id="S5.T2.7.3" class="ltx_sub">LARGE</sub>.</figcaption>
</figure>
<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">As shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, FedPepTAO significantly outperforms baseline methods in terms of the best accuracy (up to 25.39%, 23.83%, 14.53%, 60.8%, 51.76%, 51.72%, 17.02%, 54.71%, 13.39% compared with Adapter, FedPrompt, P-tuning v2, Ptompt Tuning, IDPG, ATTEMPT, LTP, MomD, and MomS+AdamD, respectively). In addition, the average of the best accuracy (average accuracy) for each task is shown in the last column. The advantage of FedPepTAO is obvious in terms of the average accuracy as well, i.e., 11.04%, 9.55%, 4.35%, 43.84%, 25.77%, 28.12%, 4.05%, 58.6%, 13.39%, higher compared with Adapter, FedPrompt, P-tuning v2, Ptompt Tuning, IDPG, ATTEMPT, LTP, MomD, and MomS+AdamD, respectively. Although FedPrompt, Prompt Tuning, IDPG, and ATTEMPT exploit fewer parameters, the corresponding accuracy is inferior. FedPrompt, Prompt Tuning, and ATTEMPT only update the soft prompt for the first layer, which cannot optimize other important layers and incurs sub-optimal performance. IDPG shares a single generator for each layer, which cannot address the characteristics of diverse layers and leads to inferior accuracy. Different from these methods, FedPepTAO can well optimize the prompt parameters for each layer based on P-tuning v2, while choosing the proper layers for aggregation within FL so as to achieve excellent performance. In addition, we exploit the adaptive optimization on both server and device sides to achieve superb accuracy. Compared with Adapter (93.4%), P-tuning v2 (92.19%), and LPT (37.98%), our methods can well reduce the number of parameters to transfer between devices and the server because of the proper layer selection, which corresponds to smaller communication costs. As a result, the efficiency of FedPepTAO is significantly higher than baseline approaches (up to 95.91%, 95.17%, 92.76%, 99%, 97.28%, 97.59%, 85.8%, 94.23%, 80.48%, faster compared with Adapter, FedPrompt, P-tuning v2, Ptompt Tuning, IDPG, ATTEMPT, LTP, MomD, and MomS+AdamD, respectively).</p>
</div>
<figure id="S5.T3" class="ltx_table">
<div id="S5.T3.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:240.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(70.7pt,-39.2pt) scale(1.48400930018961,1.48400930018961) ;">
<table id="S5.T3.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.1.1.1.1" class="ltx_tr">
<th id="S5.T3.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" rowspan="2"><span id="S5.T3.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S5.T3.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S5.T3.1.1.1.1.2.1" class="ltx_text ltx_font_bold">MRPC</span></th>
<th id="S5.T3.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S5.T3.1.1.1.1.3.1" class="ltx_text ltx_font_bold">MR</span></th>
<th id="S5.T3.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="S5.T3.1.1.1.1.4.1" class="ltx_text ltx_font_bold">SST-2</span></th>
</tr>
<tr id="S5.T3.1.1.2.2" class="ltx_tr">
<th id="S5.T3.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.2.2.1.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="S5.T3.1.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.2.2.2.1" class="ltx_text ltx_font_bold">Time</span></th>
<th id="S5.T3.1.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.2.2.3.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="S5.T3.1.1.2.2.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.2.2.4.1" class="ltx_text ltx_font_bold">Time</span></th>
<th id="S5.T3.1.1.2.2.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.2.2.5.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="S5.T3.1.1.2.2.6" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S5.T3.1.1.2.2.6.1" class="ltx_text ltx_font_bold">Time</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.1.1.3.1" class="ltx_tr">
<th id="S5.T3.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedPrompt</th>
<td id="S5.T3.1.1.3.1.2" class="ltx_td ltx_align_left ltx_border_t">74.98</td>
<td id="S5.T3.1.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t">/</td>
<td id="S5.T3.1.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t">57.2</td>
<td id="S5.T3.1.1.3.1.5" class="ltx_td ltx_align_left ltx_border_t">/</td>
<td id="S5.T3.1.1.3.1.6" class="ltx_td ltx_align_left ltx_border_t">76.49</td>
<td id="S5.T3.1.1.3.1.7" class="ltx_td ltx_align_left ltx_border_t">/</td>
</tr>
<tr id="S5.T3.1.1.4.2" class="ltx_tr">
<th id="S5.T3.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">P-tuning v2</th>
<td id="S5.T3.1.1.4.2.2" class="ltx_td ltx_align_left">74.8</td>
<td id="S5.T3.1.1.4.2.3" class="ltx_td ltx_align_left">/</td>
<td id="S5.T3.1.1.4.2.4" class="ltx_td ltx_align_left">73</td>
<td id="S5.T3.1.1.4.2.5" class="ltx_td ltx_align_left">/</td>
<td id="S5.T3.1.1.4.2.6" class="ltx_td ltx_align_left">74.77</td>
<td id="S5.T3.1.1.4.2.7" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="S5.T3.1.1.5.3" class="ltx_tr">
<th id="S5.T3.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ATTEMPT</th>
<td id="S5.T3.1.1.5.3.2" class="ltx_td ltx_align_left">37.91</td>
<td id="S5.T3.1.1.5.3.3" class="ltx_td ltx_align_left">/</td>
<td id="S5.T3.1.1.5.3.4" class="ltx_td ltx_align_left">57.3</td>
<td id="S5.T3.1.1.5.3.5" class="ltx_td ltx_align_left">/</td>
<td id="S5.T3.1.1.5.3.6" class="ltx_td ltx_align_left">85.89</td>
<td id="S5.T3.1.1.5.3.7" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="S5.T3.1.1.6.4" class="ltx_tr">
<th id="S5.T3.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LPT</th>
<td id="S5.T3.1.1.6.4.2" class="ltx_td ltx_align_left">74.98</td>
<td id="S5.T3.1.1.6.4.3" class="ltx_td ltx_align_left">/</td>
<td id="S5.T3.1.1.6.4.4" class="ltx_td ltx_align_left">84.8</td>
<td id="S5.T3.1.1.6.4.5" class="ltx_td ltx_align_left">1455</td>
<td id="S5.T3.1.1.6.4.6" class="ltx_td ltx_align_left">77.06</td>
<td id="S5.T3.1.1.6.4.7" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="S5.T3.1.1.7.5" class="ltx_tr">
<th id="S5.T3.1.1.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MomD</th>
<td id="S5.T3.1.1.7.5.2" class="ltx_td ltx_align_left">77.23</td>
<td id="S5.T3.1.1.7.5.3" class="ltx_td ltx_align_left">503</td>
<td id="S5.T3.1.1.7.5.4" class="ltx_td ltx_align_left">85.7</td>
<td id="S5.T3.1.1.7.5.5" class="ltx_td ltx_align_left">1694</td>
<td id="S5.T3.1.1.7.5.6" class="ltx_td ltx_align_left">92.55</td>
<td id="S5.T3.1.1.7.5.7" class="ltx_td ltx_align_left">3638</td>
</tr>
<tr id="S5.T3.1.1.8.6" class="ltx_tr">
<th id="S5.T3.1.1.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MomS+AdamD</th>
<td id="S5.T3.1.1.8.6.2" class="ltx_td ltx_align_left">76.89</td>
<td id="S5.T3.1.1.8.6.3" class="ltx_td ltx_align_left">291</td>
<td id="S5.T3.1.1.8.6.4" class="ltx_td ltx_align_left">88.2</td>
<td id="S5.T3.1.1.8.6.5" class="ltx_td ltx_align_left">262</td>
<td id="S5.T3.1.1.8.6.6" class="ltx_td ltx_align_left">92.55</td>
<td id="S5.T3.1.1.8.6.7" class="ltx_td ltx_align_left">2488</td>
</tr>
<tr id="S5.T3.1.1.9.7" class="ltx_tr">
<th id="S5.T3.1.1.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">
<span id="S5.T3.1.1.9.7.1.1" class="ltx_ERROR undefined">\hdashline</span>FedPepTAO</th>
<td id="S5.T3.1.1.9.7.2" class="ltx_td ltx_align_left ltx_border_bb">81.23</td>
<td id="S5.T3.1.1.9.7.3" class="ltx_td ltx_align_left ltx_border_bb">273</td>
<td id="S5.T3.1.1.9.7.4" class="ltx_td ltx_align_left ltx_border_bb">89.5</td>
<td id="S5.T3.1.1.9.7.5" class="ltx_td ltx_align_left ltx_border_bb">222</td>
<td id="S5.T3.1.1.9.7.6" class="ltx_td ltx_align_left ltx_border_bb">93</td>
<td id="S5.T3.1.1.9.7.7" class="ltx_td ltx_align_left ltx_border_bb">2248</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Accuracy and tuning time (s) to achieve target accuracy (75% for MRPC, 81% for MR, and 92.5% for SST-2) on GPT2<sub id="S5.T3.3.1" class="ltx_sub">LARGE</sub> model. "/" represents that training does not achieve the target accuracy.</figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Evaluation of FedPepTAO on Extra LLMs</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">To demonstrate the adaptability of FedPepTAO, we carried out extra experiments with three additional decoder-based models, i.e., GPT2<sub id="S5.SS3.p1.1.1" class="ltx_sub">LARGE</sub> model (774M) on MRPC, MR, SST-2 dataset, LLaMA 3B model on RTE, MRPC dataset, and LLaMA 7B model on MRPC dataset.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">As shown in Table <a href="#S5.T3" title="Table 3 ‣ 5.2 Evaluation of FedPepTAO ‣ 5 Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> below, FedPepTAO significantly outperforms baseline methods in terms of the best accuracy on the decoder-based GPT2<sub id="S5.SS3.p2.1.1" class="ltx_sub">LARGE</sub> model (up to 32.3%, 18.23%, 43.32%, 15.94%, 4%, 4.34% higher compared to FedPrompt, P-tuning v2, ATTEMPT, LPT, MomD and MomS+AdamD, respectively). Furthermore, the efficiency of FedPepTAO is significantly higher than baseline approaches (up to 84.74%, 86.89%, and 15.27% faster compared to LPT, MomD, and MomS+AdamD, respectively).</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.1" class="ltx_p">When the model becomes larger, i.e., LLaMA 3B with 3 billion parameters, FedPepTAO still achieves the best accuracy (up to 4.6%, 11.29%, 5.28%, 6.69%, 6.2%, 10.88% higher compared to FedPrompt, P-tuning v2, ATTEMPT, LPT, MomD and MomS+AdamD, respectively) and better efficiency (up to 39.81%, 43.04%, 48.16%, 38.86%, 9.72% faster compared to FedPrompt, ATTEMPT, LPT, MomD, and MomS+AdamD, respectively) as illustrated in Table <a href="#S5.T4" title="Table 4 ‣ 5.3 Evaluation of FedPepTAO on Extra LLMs ‣ 5 Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.1.1.1" class="ltx_tr">
<td id="S5.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_border_tt" rowspan="2"><span id="S5.T4.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S5.T4.1.1.1.2.1" class="ltx_text ltx_font_bold">RTE</span></td>
<td id="S5.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S5.T4.1.1.1.3.1" class="ltx_text ltx_font_bold">MRPC</span></td>
</tr>
<tr id="S5.T4.1.2.2" class="ltx_tr">
<td id="S5.T4.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T4.1.2.2.1.1" class="ltx_text ltx_font_bold">Acc</span></td>
<td id="S5.T4.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T4.1.2.2.2.1" class="ltx_text ltx_font_bold">Time</span></td>
<td id="S5.T4.1.2.2.3" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T4.1.2.2.3.1" class="ltx_text ltx_font_bold">Acc</span></td>
<td id="S5.T4.1.2.2.4" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T4.1.2.2.4.1" class="ltx_text ltx_font_bold">Time</span></td>
</tr>
<tr id="S5.T4.1.3.3" class="ltx_tr">
<td id="S5.T4.1.3.3.1" class="ltx_td ltx_align_left ltx_border_t">FedPrompt</td>
<td id="S5.T4.1.3.3.2" class="ltx_td ltx_align_left ltx_border_t">78.34</td>
<td id="S5.T4.1.3.3.3" class="ltx_td ltx_align_left ltx_border_t">540</td>
<td id="S5.T4.1.3.3.4" class="ltx_td ltx_align_left ltx_border_t">81.86</td>
<td id="S5.T4.1.3.3.5" class="ltx_td ltx_align_left ltx_border_t">459</td>
</tr>
<tr id="S5.T4.1.4.4" class="ltx_tr">
<td id="S5.T4.1.4.4.1" class="ltx_td ltx_align_left">P-tuning v2</td>
<td id="S5.T4.1.4.4.2" class="ltx_td ltx_align_left">56.68</td>
<td id="S5.T4.1.4.4.3" class="ltx_td ltx_align_left">/</td>
<td id="S5.T4.1.4.4.4" class="ltx_td ltx_align_left">75.17</td>
<td id="S5.T4.1.4.4.5" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="S5.T4.1.5.5" class="ltx_tr">
<td id="S5.T4.1.5.5.1" class="ltx_td ltx_align_left">ATTEMPT</td>
<td id="S5.T4.1.5.5.2" class="ltx_td ltx_align_left">64.98</td>
<td id="S5.T4.1.5.5.3" class="ltx_td ltx_align_left">/</td>
<td id="S5.T4.1.5.5.4" class="ltx_td ltx_align_left">81.18</td>
<td id="S5.T4.1.5.5.5" class="ltx_td ltx_align_left">718</td>
</tr>
<tr id="S5.T4.1.6.6" class="ltx_tr">
<td id="S5.T4.1.6.6.1" class="ltx_td ltx_align_left">LPT</td>
<td id="S5.T4.1.6.6.2" class="ltx_td ltx_align_left">64.98</td>
<td id="S5.T4.1.6.6.3" class="ltx_td ltx_align_left">/</td>
<td id="S5.T4.1.6.6.4" class="ltx_td ltx_align_left">79.77</td>
<td id="S5.T4.1.6.6.5" class="ltx_td ltx_align_left">789</td>
</tr>
<tr id="S5.T4.1.7.7" class="ltx_tr">
<td id="S5.T4.1.7.7.1" class="ltx_td ltx_align_left">MomD</td>
<td id="S5.T4.1.7.7.2" class="ltx_td ltx_align_left">80.87</td>
<td id="S5.T4.1.7.7.3" class="ltx_td ltx_align_left">360</td>
<td id="S5.T4.1.7.7.4" class="ltx_td ltx_align_left">80.26</td>
<td id="S5.T4.1.7.7.5" class="ltx_td ltx_align_left">669</td>
</tr>
<tr id="S5.T4.1.8.8" class="ltx_tr">
<td id="S5.T4.1.8.8.1" class="ltx_td ltx_align_left">MomS+AdamD</td>
<td id="S5.T4.1.8.8.2" class="ltx_td ltx_align_left">80.87</td>
<td id="S5.T4.1.8.8.3" class="ltx_td ltx_align_left">360</td>
<td id="S5.T4.1.8.8.4" class="ltx_td ltx_align_left">75.58</td>
<td id="S5.T4.1.8.8.5" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="S5.T4.1.9.9" class="ltx_tr">
<td id="S5.T4.1.9.9.1" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S5.T4.1.9.9.1.1" class="ltx_ERROR undefined">\hdashline</span>FedPepTAO</td>
<td id="S5.T4.1.9.9.2" class="ltx_td ltx_align_left ltx_border_bb">83.39</td>
<td id="S5.T4.1.9.9.3" class="ltx_td ltx_align_left ltx_border_bb">325</td>
<td id="S5.T4.1.9.9.4" class="ltx_td ltx_align_left ltx_border_bb">86.46</td>
<td id="S5.T4.1.9.9.5" class="ltx_td ltx_align_left ltx_border_bb">409</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Accuracy and tuning time (s) to achieve target accuracy (75% for RTE, 81% for MRPC) on LLaMA 3B model. "/" represents that training does not achieve the target accuracy.</figcaption>
</figure>
<div id="S5.SS3.p4" class="ltx_para">
<p id="S5.SS3.p4.1" class="ltx_p">We verify the performance of our method with another large model, i.e., LLaMA 7B with 7 billion parameters. As shown in Table <a href="#S5.T5" title="Table 5 ‣ 5.4 Evaluation of Parameter-efficient Tuning ‣ 5 Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, FedPepTAO outperforms baseline methods in terms of accuracy (up to 5.05%, 26.71%, 18.41%, 18.41%, 6.2%, 10.88% higher compared to FedPrompt, P-tuning v2, ATTEMPT, LPT, MomD and MomS+AdamD, respectively) and efficiency (up to 15.77%, 75.14%, 32.06%, 67.04% faster compared to ATTEMPT, LPT, MomD, and MomS+AdamD, respectively), which demonstrates the scalability of FedPepTAO.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Evaluation of Parameter-efficient Tuning</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">Formula <a href="#S4.E4" title="In 4.2 Parameter-efficient Prompt Tuning ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> calculates the global score <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="\zeta_{l}" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><msub id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">ζ</mi><mi id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">𝜁</ci><ci id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\zeta_{l}</annotation></semantics></math> of each transformer layer in the model, based on which the proper layers are selected to enable the communication between devices and the server. The selection of layers is critical to the performance of FL. In this section, we compare our parameter-efficient prompt tuning (PEPT) with three other selection strategies, i.e., select with ascending order, descending order (<cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a href="#bib.bib54" title="" class="ltx_ref">2022d</a>)</cite>), and random order. Our PEPT method can significantly outperform ascending order (up to 5.78%), descending order (up to 1.81%), and random order (up to 2.89%) (see Figure <a href="#A2.F5" title="Figure 5 ‣ B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> in Appendix). In addition, we conduct experiments and demonstrate that our PEPT method outperforms random layer selection strategy by 2.93% on RTE, 4.73% on MRPC, and 7.29% on CoLA dataset (see Appendix <a href="#A2.SS6" title="B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.6</span></a> for details).</p>
</div>
<figure id="S5.T5" class="ltx_table">
<table id="S5.T5.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T5.1.1.1" class="ltx_tr">
<td id="S5.T5.1.1.1.1" class="ltx_td ltx_align_left ltx_border_tt" rowspan="2"><span id="S5.T5.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S5.T5.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S5.T5.1.1.1.2.1" class="ltx_text ltx_font_bold">MRPC</span></td>
</tr>
<tr id="S5.T5.1.2.2" class="ltx_tr">
<td id="S5.T5.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T5.1.2.2.1.1" class="ltx_text ltx_font_bold">Acc</span></td>
<td id="S5.T5.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T5.1.2.2.2.1" class="ltx_text ltx_font_bold">Time</span></td>
</tr>
<tr id="S5.T5.1.3.3" class="ltx_tr">
<td id="S5.T5.1.3.3.1" class="ltx_td ltx_align_left ltx_border_t">FedPrompt</td>
<td id="S5.T5.1.3.3.2" class="ltx_td ltx_align_left ltx_border_t">76.18</td>
<td id="S5.T5.1.3.3.3" class="ltx_td ltx_align_left ltx_border_t">/</td>
</tr>
<tr id="S5.T5.1.4.4" class="ltx_tr">
<td id="S5.T5.1.4.4.1" class="ltx_td ltx_align_left">P-tuning v2</td>
<td id="S5.T5.1.4.4.2" class="ltx_td ltx_align_left">74.98</td>
<td id="S5.T5.1.4.4.3" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="S5.T5.1.5.5" class="ltx_tr">
<td id="S5.T5.1.5.5.1" class="ltx_td ltx_align_left">ATTEMPT</td>
<td id="S5.T5.1.5.5.2" class="ltx_td ltx_align_left">81.52</td>
<td id="S5.T5.1.5.5.3" class="ltx_td ltx_align_left">317</td>
</tr>
<tr id="S5.T5.1.6.6" class="ltx_tr">
<td id="S5.T5.1.6.6.1" class="ltx_td ltx_align_left">LPT</td>
<td id="S5.T5.1.6.6.2" class="ltx_td ltx_align_left">81.95</td>
<td id="S5.T5.1.6.6.3" class="ltx_td ltx_align_left">1074</td>
</tr>
<tr id="S5.T5.1.7.7" class="ltx_tr">
<td id="S5.T5.1.7.7.1" class="ltx_td ltx_align_left">MomD</td>
<td id="S5.T5.1.7.7.2" class="ltx_td ltx_align_left">76.2</td>
<td id="S5.T5.1.7.7.3" class="ltx_td ltx_align_left">393</td>
</tr>
<tr id="S5.T5.1.8.8" class="ltx_tr">
<td id="S5.T5.1.8.8.1" class="ltx_td ltx_align_left">MomS+AdamD</td>
<td id="S5.T5.1.8.8.2" class="ltx_td ltx_align_left">75.75</td>
<td id="S5.T5.1.8.8.3" class="ltx_td ltx_align_left">810</td>
</tr>
<tr id="S5.T5.1.9.9" class="ltx_tr">
<td id="S5.T5.1.9.9.1" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S5.T5.1.9.9.1.1" class="ltx_ERROR undefined">\hdashline</span>FedPepTAO</td>
<td id="S5.T5.1.9.9.2" class="ltx_td ltx_align_left ltx_border_bb">82.34</td>
<td id="S5.T5.1.9.9.3" class="ltx_td ltx_align_left ltx_border_bb">267</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Accuracy and tuning time (s) to achieve target accuracy (75% for MRPC) on LLaMA 7B model. "/" represents that training does not achieve the target accuracy.</figcaption>
</figure>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span>Evaluation of Adaptive Optimization</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">To demonstrate the effectiveness of Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we compare our adaptive optimization method with six baseline methods, i.e., FedAvg <cite class="ltx_cite ltx_citemacro_cite">McMahan et al. (<a href="#bib.bib57" title="" class="ltx_ref">2017</a>)</cite>, MomD, momentum on the server side with SGD on the device side (MomS) <cite class="ltx_cite ltx_citemacro_cite">Reddi et al. (<a href="#bib.bib66" title="" class="ltx_ref">2018a</a>)</cite>, momentum on the server side with control variate and SGD on the device side (MomS+Con) <cite class="ltx_cite ltx_citemacro_cite">Reddi et al. (<a href="#bib.bib66" title="" class="ltx_ref">2018a</a>)</cite>, Adam on device side with simple SGD on the server side (AdamD), and MomS+AdamD, on the RTE task (see Figure <a href="#A2.F6" title="Figure 6 ‣ B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> in Appendix). FedPepTAO corresponds to the highest accuracy compared to baseline methods (up to 8.3% compared with MomD, 29.24% compared with MomS, 29.24% compared with MomS+Con, 2.16% compared with AdamD, 5.05% compared with MomS+AdamD, and 29.24% compared with FedAvg). The advantage of FedPepTAO is up to 5.05% compared with MomS+AdamD, which shows that the control variate can avoid client drift in FL settings and lead to excellent performance. In addition, please note that FedPepTAO calculates the control variate on the server with updated gradients (Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4.3 Communication-Efficient Adaptive Optimization ‣ 4 Method ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), without extra communication cost.</p>
</div>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span>Hyperparameter Evaluation</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.1" class="ltx_p">In this section, we evaluate the performance of FedPepTAO with divers hyperparameters. Additional experiments are in the Appendix <a href="#A2" title="Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div id="S5.SS6.p2" class="ltx_para">
<p id="S5.SS6.p2.6" class="ltx_p"><span id="S5.SS6.p2.6.1" class="ltx_text ltx_font_bold">Impact of server learning rate</span> Due to the high sensitivity of the hyperparameters in NLP tasks, we investigate the impact of divers server learning rates on the RTE dataset. We analyze the accuracy with the learning rates <math id="S5.SS6.p2.1.m1.1" class="ltx_Math" alttext="1e^{-2}" display="inline"><semantics id="S5.SS6.p2.1.m1.1a"><mrow id="S5.SS6.p2.1.m1.1.1" xref="S5.SS6.p2.1.m1.1.1.cmml"><mn id="S5.SS6.p2.1.m1.1.1.2" xref="S5.SS6.p2.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS6.p2.1.m1.1.1.1" xref="S5.SS6.p2.1.m1.1.1.1.cmml">​</mo><msup id="S5.SS6.p2.1.m1.1.1.3" xref="S5.SS6.p2.1.m1.1.1.3.cmml"><mi id="S5.SS6.p2.1.m1.1.1.3.2" xref="S5.SS6.p2.1.m1.1.1.3.2.cmml">e</mi><mrow id="S5.SS6.p2.1.m1.1.1.3.3" xref="S5.SS6.p2.1.m1.1.1.3.3.cmml"><mo id="S5.SS6.p2.1.m1.1.1.3.3a" xref="S5.SS6.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S5.SS6.p2.1.m1.1.1.3.3.2" xref="S5.SS6.p2.1.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.1.m1.1b"><apply id="S5.SS6.p2.1.m1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1"><times id="S5.SS6.p2.1.m1.1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1.1"></times><cn type="integer" id="S5.SS6.p2.1.m1.1.1.2.cmml" xref="S5.SS6.p2.1.m1.1.1.2">1</cn><apply id="S5.SS6.p2.1.m1.1.1.3.cmml" xref="S5.SS6.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p2.1.m1.1.1.3.1.cmml" xref="S5.SS6.p2.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS6.p2.1.m1.1.1.3.2.cmml" xref="S5.SS6.p2.1.m1.1.1.3.2">𝑒</ci><apply id="S5.SS6.p2.1.m1.1.1.3.3.cmml" xref="S5.SS6.p2.1.m1.1.1.3.3"><minus id="S5.SS6.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS6.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S5.SS6.p2.1.m1.1.1.3.3.2.cmml" xref="S5.SS6.p2.1.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.1.m1.1c">1e^{-2}</annotation></semantics></math>, <math id="S5.SS6.p2.2.m2.1" class="ltx_Math" alttext="5e^{-3}" display="inline"><semantics id="S5.SS6.p2.2.m2.1a"><mrow id="S5.SS6.p2.2.m2.1.1" xref="S5.SS6.p2.2.m2.1.1.cmml"><mn id="S5.SS6.p2.2.m2.1.1.2" xref="S5.SS6.p2.2.m2.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S5.SS6.p2.2.m2.1.1.1" xref="S5.SS6.p2.2.m2.1.1.1.cmml">​</mo><msup id="S5.SS6.p2.2.m2.1.1.3" xref="S5.SS6.p2.2.m2.1.1.3.cmml"><mi id="S5.SS6.p2.2.m2.1.1.3.2" xref="S5.SS6.p2.2.m2.1.1.3.2.cmml">e</mi><mrow id="S5.SS6.p2.2.m2.1.1.3.3" xref="S5.SS6.p2.2.m2.1.1.3.3.cmml"><mo id="S5.SS6.p2.2.m2.1.1.3.3a" xref="S5.SS6.p2.2.m2.1.1.3.3.cmml">−</mo><mn id="S5.SS6.p2.2.m2.1.1.3.3.2" xref="S5.SS6.p2.2.m2.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.2.m2.1b"><apply id="S5.SS6.p2.2.m2.1.1.cmml" xref="S5.SS6.p2.2.m2.1.1"><times id="S5.SS6.p2.2.m2.1.1.1.cmml" xref="S5.SS6.p2.2.m2.1.1.1"></times><cn type="integer" id="S5.SS6.p2.2.m2.1.1.2.cmml" xref="S5.SS6.p2.2.m2.1.1.2">5</cn><apply id="S5.SS6.p2.2.m2.1.1.3.cmml" xref="S5.SS6.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p2.2.m2.1.1.3.1.cmml" xref="S5.SS6.p2.2.m2.1.1.3">superscript</csymbol><ci id="S5.SS6.p2.2.m2.1.1.3.2.cmml" xref="S5.SS6.p2.2.m2.1.1.3.2">𝑒</ci><apply id="S5.SS6.p2.2.m2.1.1.3.3.cmml" xref="S5.SS6.p2.2.m2.1.1.3.3"><minus id="S5.SS6.p2.2.m2.1.1.3.3.1.cmml" xref="S5.SS6.p2.2.m2.1.1.3.3"></minus><cn type="integer" id="S5.SS6.p2.2.m2.1.1.3.3.2.cmml" xref="S5.SS6.p2.2.m2.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.2.m2.1c">5e^{-3}</annotation></semantics></math>, <math id="S5.SS6.p2.3.m3.1" class="ltx_Math" alttext="1e^{-3}" display="inline"><semantics id="S5.SS6.p2.3.m3.1a"><mrow id="S5.SS6.p2.3.m3.1.1" xref="S5.SS6.p2.3.m3.1.1.cmml"><mn id="S5.SS6.p2.3.m3.1.1.2" xref="S5.SS6.p2.3.m3.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS6.p2.3.m3.1.1.1" xref="S5.SS6.p2.3.m3.1.1.1.cmml">​</mo><msup id="S5.SS6.p2.3.m3.1.1.3" xref="S5.SS6.p2.3.m3.1.1.3.cmml"><mi id="S5.SS6.p2.3.m3.1.1.3.2" xref="S5.SS6.p2.3.m3.1.1.3.2.cmml">e</mi><mrow id="S5.SS6.p2.3.m3.1.1.3.3" xref="S5.SS6.p2.3.m3.1.1.3.3.cmml"><mo id="S5.SS6.p2.3.m3.1.1.3.3a" xref="S5.SS6.p2.3.m3.1.1.3.3.cmml">−</mo><mn id="S5.SS6.p2.3.m3.1.1.3.3.2" xref="S5.SS6.p2.3.m3.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.3.m3.1b"><apply id="S5.SS6.p2.3.m3.1.1.cmml" xref="S5.SS6.p2.3.m3.1.1"><times id="S5.SS6.p2.3.m3.1.1.1.cmml" xref="S5.SS6.p2.3.m3.1.1.1"></times><cn type="integer" id="S5.SS6.p2.3.m3.1.1.2.cmml" xref="S5.SS6.p2.3.m3.1.1.2">1</cn><apply id="S5.SS6.p2.3.m3.1.1.3.cmml" xref="S5.SS6.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p2.3.m3.1.1.3.1.cmml" xref="S5.SS6.p2.3.m3.1.1.3">superscript</csymbol><ci id="S5.SS6.p2.3.m3.1.1.3.2.cmml" xref="S5.SS6.p2.3.m3.1.1.3.2">𝑒</ci><apply id="S5.SS6.p2.3.m3.1.1.3.3.cmml" xref="S5.SS6.p2.3.m3.1.1.3.3"><minus id="S5.SS6.p2.3.m3.1.1.3.3.1.cmml" xref="S5.SS6.p2.3.m3.1.1.3.3"></minus><cn type="integer" id="S5.SS6.p2.3.m3.1.1.3.3.2.cmml" xref="S5.SS6.p2.3.m3.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.3.m3.1c">1e^{-3}</annotation></semantics></math>, <math id="S5.SS6.p2.4.m4.1" class="ltx_Math" alttext="5e^{-4}" display="inline"><semantics id="S5.SS6.p2.4.m4.1a"><mrow id="S5.SS6.p2.4.m4.1.1" xref="S5.SS6.p2.4.m4.1.1.cmml"><mn id="S5.SS6.p2.4.m4.1.1.2" xref="S5.SS6.p2.4.m4.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S5.SS6.p2.4.m4.1.1.1" xref="S5.SS6.p2.4.m4.1.1.1.cmml">​</mo><msup id="S5.SS6.p2.4.m4.1.1.3" xref="S5.SS6.p2.4.m4.1.1.3.cmml"><mi id="S5.SS6.p2.4.m4.1.1.3.2" xref="S5.SS6.p2.4.m4.1.1.3.2.cmml">e</mi><mrow id="S5.SS6.p2.4.m4.1.1.3.3" xref="S5.SS6.p2.4.m4.1.1.3.3.cmml"><mo id="S5.SS6.p2.4.m4.1.1.3.3a" xref="S5.SS6.p2.4.m4.1.1.3.3.cmml">−</mo><mn id="S5.SS6.p2.4.m4.1.1.3.3.2" xref="S5.SS6.p2.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.4.m4.1b"><apply id="S5.SS6.p2.4.m4.1.1.cmml" xref="S5.SS6.p2.4.m4.1.1"><times id="S5.SS6.p2.4.m4.1.1.1.cmml" xref="S5.SS6.p2.4.m4.1.1.1"></times><cn type="integer" id="S5.SS6.p2.4.m4.1.1.2.cmml" xref="S5.SS6.p2.4.m4.1.1.2">5</cn><apply id="S5.SS6.p2.4.m4.1.1.3.cmml" xref="S5.SS6.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p2.4.m4.1.1.3.1.cmml" xref="S5.SS6.p2.4.m4.1.1.3">superscript</csymbol><ci id="S5.SS6.p2.4.m4.1.1.3.2.cmml" xref="S5.SS6.p2.4.m4.1.1.3.2">𝑒</ci><apply id="S5.SS6.p2.4.m4.1.1.3.3.cmml" xref="S5.SS6.p2.4.m4.1.1.3.3"><minus id="S5.SS6.p2.4.m4.1.1.3.3.1.cmml" xref="S5.SS6.p2.4.m4.1.1.3.3"></minus><cn type="integer" id="S5.SS6.p2.4.m4.1.1.3.3.2.cmml" xref="S5.SS6.p2.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.4.m4.1c">5e^{-4}</annotation></semantics></math>. We find that the best performance was achieved when <math id="S5.SS6.p2.5.m5.1" class="ltx_Math" alttext="lr=1e^{-3}" display="inline"><semantics id="S5.SS6.p2.5.m5.1a"><mrow id="S5.SS6.p2.5.m5.1.1" xref="S5.SS6.p2.5.m5.1.1.cmml"><mrow id="S5.SS6.p2.5.m5.1.1.2" xref="S5.SS6.p2.5.m5.1.1.2.cmml"><mi id="S5.SS6.p2.5.m5.1.1.2.2" xref="S5.SS6.p2.5.m5.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS6.p2.5.m5.1.1.2.1" xref="S5.SS6.p2.5.m5.1.1.2.1.cmml">​</mo><mi id="S5.SS6.p2.5.m5.1.1.2.3" xref="S5.SS6.p2.5.m5.1.1.2.3.cmml">r</mi></mrow><mo id="S5.SS6.p2.5.m5.1.1.1" xref="S5.SS6.p2.5.m5.1.1.1.cmml">=</mo><mrow id="S5.SS6.p2.5.m5.1.1.3" xref="S5.SS6.p2.5.m5.1.1.3.cmml"><mn id="S5.SS6.p2.5.m5.1.1.3.2" xref="S5.SS6.p2.5.m5.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS6.p2.5.m5.1.1.3.1" xref="S5.SS6.p2.5.m5.1.1.3.1.cmml">​</mo><msup id="S5.SS6.p2.5.m5.1.1.3.3" xref="S5.SS6.p2.5.m5.1.1.3.3.cmml"><mi id="S5.SS6.p2.5.m5.1.1.3.3.2" xref="S5.SS6.p2.5.m5.1.1.3.3.2.cmml">e</mi><mrow id="S5.SS6.p2.5.m5.1.1.3.3.3" xref="S5.SS6.p2.5.m5.1.1.3.3.3.cmml"><mo id="S5.SS6.p2.5.m5.1.1.3.3.3a" xref="S5.SS6.p2.5.m5.1.1.3.3.3.cmml">−</mo><mn id="S5.SS6.p2.5.m5.1.1.3.3.3.2" xref="S5.SS6.p2.5.m5.1.1.3.3.3.2.cmml">3</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.5.m5.1b"><apply id="S5.SS6.p2.5.m5.1.1.cmml" xref="S5.SS6.p2.5.m5.1.1"><eq id="S5.SS6.p2.5.m5.1.1.1.cmml" xref="S5.SS6.p2.5.m5.1.1.1"></eq><apply id="S5.SS6.p2.5.m5.1.1.2.cmml" xref="S5.SS6.p2.5.m5.1.1.2"><times id="S5.SS6.p2.5.m5.1.1.2.1.cmml" xref="S5.SS6.p2.5.m5.1.1.2.1"></times><ci id="S5.SS6.p2.5.m5.1.1.2.2.cmml" xref="S5.SS6.p2.5.m5.1.1.2.2">𝑙</ci><ci id="S5.SS6.p2.5.m5.1.1.2.3.cmml" xref="S5.SS6.p2.5.m5.1.1.2.3">𝑟</ci></apply><apply id="S5.SS6.p2.5.m5.1.1.3.cmml" xref="S5.SS6.p2.5.m5.1.1.3"><times id="S5.SS6.p2.5.m5.1.1.3.1.cmml" xref="S5.SS6.p2.5.m5.1.1.3.1"></times><cn type="integer" id="S5.SS6.p2.5.m5.1.1.3.2.cmml" xref="S5.SS6.p2.5.m5.1.1.3.2">1</cn><apply id="S5.SS6.p2.5.m5.1.1.3.3.cmml" xref="S5.SS6.p2.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS6.p2.5.m5.1.1.3.3.1.cmml" xref="S5.SS6.p2.5.m5.1.1.3.3">superscript</csymbol><ci id="S5.SS6.p2.5.m5.1.1.3.3.2.cmml" xref="S5.SS6.p2.5.m5.1.1.3.3.2">𝑒</ci><apply id="S5.SS6.p2.5.m5.1.1.3.3.3.cmml" xref="S5.SS6.p2.5.m5.1.1.3.3.3"><minus id="S5.SS6.p2.5.m5.1.1.3.3.3.1.cmml" xref="S5.SS6.p2.5.m5.1.1.3.3.3"></minus><cn type="integer" id="S5.SS6.p2.5.m5.1.1.3.3.3.2.cmml" xref="S5.SS6.p2.5.m5.1.1.3.3.3.2">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.5.m5.1c">lr=1e^{-3}</annotation></semantics></math>, which only slightly outperforms <math id="S5.SS6.p2.6.m6.1" class="ltx_Math" alttext="lr=5e^{-4}" display="inline"><semantics id="S5.SS6.p2.6.m6.1a"><mrow id="S5.SS6.p2.6.m6.1.1" xref="S5.SS6.p2.6.m6.1.1.cmml"><mrow id="S5.SS6.p2.6.m6.1.1.2" xref="S5.SS6.p2.6.m6.1.1.2.cmml"><mi id="S5.SS6.p2.6.m6.1.1.2.2" xref="S5.SS6.p2.6.m6.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS6.p2.6.m6.1.1.2.1" xref="S5.SS6.p2.6.m6.1.1.2.1.cmml">​</mo><mi id="S5.SS6.p2.6.m6.1.1.2.3" xref="S5.SS6.p2.6.m6.1.1.2.3.cmml">r</mi></mrow><mo id="S5.SS6.p2.6.m6.1.1.1" xref="S5.SS6.p2.6.m6.1.1.1.cmml">=</mo><mrow id="S5.SS6.p2.6.m6.1.1.3" xref="S5.SS6.p2.6.m6.1.1.3.cmml"><mn id="S5.SS6.p2.6.m6.1.1.3.2" xref="S5.SS6.p2.6.m6.1.1.3.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S5.SS6.p2.6.m6.1.1.3.1" xref="S5.SS6.p2.6.m6.1.1.3.1.cmml">​</mo><msup id="S5.SS6.p2.6.m6.1.1.3.3" xref="S5.SS6.p2.6.m6.1.1.3.3.cmml"><mi id="S5.SS6.p2.6.m6.1.1.3.3.2" xref="S5.SS6.p2.6.m6.1.1.3.3.2.cmml">e</mi><mrow id="S5.SS6.p2.6.m6.1.1.3.3.3" xref="S5.SS6.p2.6.m6.1.1.3.3.3.cmml"><mo id="S5.SS6.p2.6.m6.1.1.3.3.3a" xref="S5.SS6.p2.6.m6.1.1.3.3.3.cmml">−</mo><mn id="S5.SS6.p2.6.m6.1.1.3.3.3.2" xref="S5.SS6.p2.6.m6.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.6.m6.1b"><apply id="S5.SS6.p2.6.m6.1.1.cmml" xref="S5.SS6.p2.6.m6.1.1"><eq id="S5.SS6.p2.6.m6.1.1.1.cmml" xref="S5.SS6.p2.6.m6.1.1.1"></eq><apply id="S5.SS6.p2.6.m6.1.1.2.cmml" xref="S5.SS6.p2.6.m6.1.1.2"><times id="S5.SS6.p2.6.m6.1.1.2.1.cmml" xref="S5.SS6.p2.6.m6.1.1.2.1"></times><ci id="S5.SS6.p2.6.m6.1.1.2.2.cmml" xref="S5.SS6.p2.6.m6.1.1.2.2">𝑙</ci><ci id="S5.SS6.p2.6.m6.1.1.2.3.cmml" xref="S5.SS6.p2.6.m6.1.1.2.3">𝑟</ci></apply><apply id="S5.SS6.p2.6.m6.1.1.3.cmml" xref="S5.SS6.p2.6.m6.1.1.3"><times id="S5.SS6.p2.6.m6.1.1.3.1.cmml" xref="S5.SS6.p2.6.m6.1.1.3.1"></times><cn type="integer" id="S5.SS6.p2.6.m6.1.1.3.2.cmml" xref="S5.SS6.p2.6.m6.1.1.3.2">5</cn><apply id="S5.SS6.p2.6.m6.1.1.3.3.cmml" xref="S5.SS6.p2.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S5.SS6.p2.6.m6.1.1.3.3.1.cmml" xref="S5.SS6.p2.6.m6.1.1.3.3">superscript</csymbol><ci id="S5.SS6.p2.6.m6.1.1.3.3.2.cmml" xref="S5.SS6.p2.6.m6.1.1.3.3.2">𝑒</ci><apply id="S5.SS6.p2.6.m6.1.1.3.3.3.cmml" xref="S5.SS6.p2.6.m6.1.1.3.3.3"><minus id="S5.SS6.p2.6.m6.1.1.3.3.3.1.cmml" xref="S5.SS6.p2.6.m6.1.1.3.3.3"></minus><cn type="integer" id="S5.SS6.p2.6.m6.1.1.3.3.3.2.cmml" xref="S5.SS6.p2.6.m6.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.6.m6.1c">lr=5e^{-4}</annotation></semantics></math> by 0.37% (see Figure <a href="#A2.F2" title="Figure 2 ‣ B.2 Impact of server learning rate ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> in the Appendix). This demonstrates that FedPepTAO is easy to fine-tune in practice.</p>
</div>
<div id="S5.SS6.p3" class="ltx_para">
<p id="S5.SS6.p3.2" class="ltx_p"><span id="S5.SS6.p3.2.1" class="ltx_text ltx_font_bold">Impact of heterogeneous data distribution</span>
Data heterogeneity has always been a common challenge in FL. To investigate the robustness of our approach to different degrees of non-IID data, we conduct experiments under various levels of non-IID degrees. We observe that the accuracy of FedPepTAO is the best with <math id="S5.SS6.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS6.p3.1.m1.1a"><mi id="S5.SS6.p3.1.m1.1.1" xref="S5.SS6.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.1.m1.1b"><ci id="S5.SS6.p3.1.m1.1.1.cmml" xref="S5.SS6.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.1.m1.1c">\alpha</annotation></semantics></math> ranging from 1.0 to 5.0 (see Figure <a href="#A2.F3" title="Figure 3 ‣ B.3 Impact of heterogeneous data distribution ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> in Appendix). A smaller <math id="S5.SS6.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS6.p3.2.m2.1a"><mi id="S5.SS6.p3.2.m2.1.1" xref="S5.SS6.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p3.2.m2.1b"><ci id="S5.SS6.p3.2.m2.1.1.cmml" xref="S5.SS6.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p3.2.m2.1c">\alpha</annotation></semantics></math> represents a higher degree of heterogeneity. This demonstrates that our approach is robust to different data heterogeneity.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we propose an original parameter-efficient prompt tuning with adaptive optimization approach for large language models with FL, i.e., FedPepTAO. We dynamically calculate the score of each layer to choose proper layers of prompts for FL without accuracy degradation. In addition, we provide a novel adaptive optimization method with control variate on the server to achieve superb performance without extra communication costs. We carry out extensive experiments based on 10 tasks and 9 state-of-the-art baseline approaches, which demonstrate significant advantages of FedPepTAO in terms of accuracy (up to 60.8% higher) and efficiency (up to 97.59% faster).</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Limitations</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">While our method can significantly enhance the performance and efficiency of federated prompt tuning in large language models (LLMs), we should acknowledge the sharing of prompts between clients and the server. Previous research has demonstrated that transferring additional sensitive information in Federated Learning (FL), such as predictions or embeddings, can lead to potential privacy concerns <cite class="ltx_cite ltx_citemacro_cite">Che et al. (<a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite>. These concerns can be even more critical in prompt tuning scenarios, as prompts are explicitly tuned with private local data. We anticipate that evaluating and mitigating privacy risks in federated LLM prompt tuning will be an intriguing research area in the future.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asai et al. (2022)</span>
<span class="ltx_bibblock">
Akari Asai, Mohammadreza Salehi, Matthew E Peters, and Hannaneh Hajishirzi.
2022.

</span>
<span class="ltx_bibblock">Attempt: Parameter-efficient multi-task tuning via attentional
mixtures of soft prompts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Conf. on Empirical Methods in Natural Language Processing
(EMNLP)</em>, pages 6655–6672.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al. (2015)</span>
<span class="ltx_bibblock">
Xianqiang Bao, Ling Liu, Nong Xiao, Yang Zhou, and Qi Zhang. 2015.

</span>
<span class="ltx_bibblock">Policy-driven autonomic configuration management for nosql.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. on Cloud Computing (CLOUD)</em>, pages
245–252.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2020)</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla
Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
et al. 2020.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems (NeurIPS)</em>,
33:1877–1901.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Californians for Consumer Privacy (2020)</span>
<span class="ltx_bibblock">
Californians for Consumer Privacy. 2020.

</span>
<span class="ltx_bibblock">California consumer privacy act home page.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://www.caprivacy.org/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.caprivacy.org/</a>.

</span>
<span class="ltx_bibblock">Online; accessed 09/05/2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Che et al. (2022)</span>
<span class="ltx_bibblock">
Tianshi Che, Zijie Zhang, Yang Zhou, Xin Zhao, Ji Liu, Zhe Jiang, Da Yan,
Ruoming Jin, and Dejing Dou. 2022.

</span>
<span class="ltx_bibblock">Federated fingerprint learning with heterogeneous architectures.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. on Data Mining (ICDM)</em>, pages 31–40.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Che et al. (2023)</span>
<span class="ltx_bibblock">
Tianshi Che, Yang Zhou, Zijie Zhang, Lingjuan Lyu, Ji Liu, Da Yan, Dejing Dou,
and Jun Huan. 2023.

</span>
<span class="ltx_bibblock">Fast federated machine unlearning with nonlinear functional theory.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, volume 202 of
<em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pages 4241–4268. PMLR.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2018a)</span>
<span class="ltx_bibblock">
Zhuo Chen, Gang Feng, Bei Liu, and Yang Zhou. 2018a.

</span>
<span class="ltx_bibblock">Construction policy of network service chain oriented to resource
fragmentation optimization in operator network.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">ournal of Electronics and Information Technology</em>,
40(4):763–769.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2018b)</span>
<span class="ltx_bibblock">
Zhuo Chen, Gang Feng, Bei Liu, and Yang Zhou. 2018b.

</span>
<span class="ltx_bibblock">Delay optimization oriented service function chain migration and
re-deployment in operator network.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Acta Electronica Sinica</em>, 46(9):2229–2237.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023a)</span>
<span class="ltx_bibblock">
Zhuo Chen, Xiaoxiang Tan, Zhiyuan Zhou, and Yang Zhou. 2023a.

</span>
<span class="ltx_bibblock">A channel aggregation based dynamic pruning method in federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE Global Communications Conference (GLOBECOM)</em>.

</span>
<span class="ltx_bibblock">To appear.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023b)</span>
<span class="ltx_bibblock">
Zhuo Chen, Chuan Zhou, and Yang Zhou. 2023b.

</span>
<span class="ltx_bibblock">A hierarchical federated learning model with adaptive model parameter
aggregation.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Computer Science and Information Systems</em>, 20(3):1037–1060.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clark et al. (2019)</span>
<span class="ltx_bibblock">
Christopher Clark, Kenton Lee, Ming-Wei Chang, Tom Kwiatkowski, Michael
Collins, and Kristina Toutanova. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://aclanthology.org/N19-1300" title="" class="ltx_ref ltx_href">BoolQ: Exploring the
surprising difficulty of natural yes/no questions</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 1 (Long and Short Papers)</em>, pages 2924–2936.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cutkosky and Mehta (2020)</span>
<span class="ltx_bibblock">
Ashok Cutkosky and Harsh Mehta. 2020.

</span>
<span class="ltx_bibblock">Momentum improves normalized SGD.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Int. Conf. Machine Learning (ICML)</em>, volume 119, pages
2260–2268. PMLR.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dehak et al. (2010)</span>
<span class="ltx_bibblock">
Najim Dehak, Reda Dehak, James R Glass, Douglas A Reynolds, Patrick Kenny,
et al. 2010.

</span>
<span class="ltx_bibblock">Cosine similarity scoring without score normalization techniques.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Odyssey</em>, page 15.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. 2018.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1810.04805</em>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al. (2023)</span>
<span class="ltx_bibblock">
Ning Ding, Yujia Qin, Guang Yang, Fuchao Wei, Zonghan Yang, Yusheng Su,
Shengding Hu, Yulin Chen, Chi-Min Chan, Weize Chen, et al. 2023.

</span>
<span class="ltx_bibblock">Parameter-efficient fine-tuning of large-scale pre-trained language
models.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Nature Machine Intelligence</em>, 5(3):220–235.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dolan and Brockett (2005)</span>
<span class="ltx_bibblock">
William B. Dolan and Chris Brockett. 2005.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://aclanthology.org/I05-5002" title="" class="ltx_ref ltx_href">Automatically constructing
a corpus of sentential paraphrases</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Third International Workshop on
Paraphrasing (IWP2005)</em>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Duchi et al. (2011)</span>
<span class="ltx_bibblock">
John Duchi, Elad Hazan, and Yoram Singer. 2011.

</span>
<span class="ltx_bibblock">Adaptive subgradient methods for online learning and stochastic
optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Journal of machine learning research</em>, 12(7).

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gan et al. (2023)</span>
<span class="ltx_bibblock">
Xinbiao Gan, Guang Wu, Ruigeng Zeng, Jiaqi Si, Ji Liu, Daxiang Dong, Chunye
Gong, Cong Liu, and Tiejun Li. 2023.

</span>
<span class="ltx_bibblock">Ft-topo: Architecture-driven folded-triangle partitioning for
communication-efficient graph processing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Supercomputing (ICS)</em>, page 240–250.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2021a)</span>
<span class="ltx_bibblock">
Hongchang Gao, An Xu, and Heng Huang. 2021a.

</span>
<span class="ltx_bibblock">On the convergence of communication-efficient local sgd for federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">AAAI Conf. on Artificial Intelligence</em>, 9, pages 7510–7518.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2021b)</span>
<span class="ltx_bibblock">
Wei Gao, Shangwei Guo, Tianwei Zhang, Han Qiu, Yonggang Wen, and Yang Liu.
2021b.

</span>
<span class="ltx_bibblock">Privacy-preserving collaborative learning with automatic
transformation search.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conf. on Computer Vision and Pattern Recognition
(CVPR)</em>, pages 114–123.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Giampiccolo et al. (2007)</span>
<span class="ltx_bibblock">
Danilo Giampiccolo, Bernardo Magnini, Ido Dagan, and Bill Dolan. 2007.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://aclanthology.org/W07-1401" title="" class="ltx_ref ltx_href">The third PASCAL
recognizing textual entailment challenge</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ACL-PASCAL Workshop on Textual
Entailment and Paraphrasing</em>, pages 1–9.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Glorot et al. (2011)</span>
<span class="ltx_bibblock">
Xavier Glorot, Antoine Bordes, and Yoshua Bengio. 2011.

</span>
<span class="ltx_bibblock">Deep sparse rectifier neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on artificial intelligence and statistics</em>, pages
315–323. JMLR Workshop and Conference Proceedings.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goswami et al. (2020)</span>
<span class="ltx_bibblock">
Sayan Goswami, Ayam Pokhrel, Kisung Lee, Ling Liu, Qi Zhang, and Yang Zhou.
2020.

</span>
<span class="ltx_bibblock">Lightwieight indexing and querying services for big spatial data.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">The Journal of Supercomputing (TJSC)</em>, 76(9):6619–6647.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2022)</span>
<span class="ltx_bibblock">
Guimu Guo, Da Yan, Lyuheng Yuan, Jalal Khalil, Cheng Long, Zhe Jiang, and Yang
Zhou. 2022.

</span>
<span class="ltx_bibblock">Maximal directed quasi-clique mining.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. on Data Engineering (ICDE)</em>, pages
1900–1913.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et al. (2023)</span>
<span class="ltx_bibblock">
Junyuan Hong, Zhuangdi Zhu, Lingjuan Lyu, Yang Zhou, Vishnu Naresh Boddeti, and
Jiayu Zhou. 2023.

</span>
<span class="ltx_bibblock">Int. workshop on federated learning for distributed data mining.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">ACM SIGKDD Conf. on Knowledge Discovery and Data Mining
(KDD)</em>, pages 5861–5862, Long Beach, CA.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Houlsby et al. (2019)</span>
<span class="ltx_bibblock">
Neil Houlsby, Andrei Giurgiu, Stanislaw Jastrzebski, Bruna Morrone, Quentin
De Laroussilhe, Andrea Gesmundo, Mona Attariyan, and Sylvain Gelly. 2019.

</span>
<span class="ltx_bibblock">Parameter-efficient transfer learning for nlp.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, pages 2790–2799.
PMLR.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2019)</span>
<span class="ltx_bibblock">
Yexi Jiang, Chang-Shing Perng, Anca Sailer, Ignacio Silva-Lepe, Yang Zhou, and
Tao Li. 2019.

</span>
<span class="ltx_bibblock">Csm: A cloud service marketplace for complex service acquisition.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and Technology
(TIST)</em>, 8(1):1–25.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2022a)</span>
<span class="ltx_bibblock">
Jiayin Jin, Jiaxiang Ren, Yang Zhou, Lingjuan Lyu, Ji Liu, and Dejing Dou.
2022a.

</span>
<span class="ltx_bibblock">Accelerated federated learning with decoupled adaptive optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, volume 162 of
<em id="bib.bib28.2.2" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning Research</em>, pages 10298–10322. PMLR.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2022b)</span>
<span class="ltx_bibblock">
Jiayin Jin, Zeru Zhang, Yang Zhou, and Lingfei Wu. 2022b.

</span>
<span class="ltx_bibblock">Input-agnostic certified group fairness via gaussian parameter
smoothing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, pages 10340–10361.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al. (2021)</span>
<span class="ltx_bibblock">
Ruoming Jin, Dong Li, Jing Gao, Zhi Liu, Li Chen, and Yang Zhou. 2021.

</span>
<span class="ltx_bibblock">Towards a better understanding of linear models for recommendation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">ACM SIGKDD Conf. on Knowledge Discovery and Data Mining
(KDD)</em>, pages 776–785.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Peter Kairouz, H. Brendan McMahan, Brendan Avent, Aurélien Bellet, and
Mehdi Bennis et al. 2021.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>,
14(1-2):1–210.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimi Mahabadi et al. (2021a)</span>
<span class="ltx_bibblock">
Rabeeh Karimi Mahabadi, James Henderson, and Sebastian Ruder.
2021a.

</span>
<span class="ltx_bibblock">Compacter: Efficient low-rank hypercomplex adapter layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>,
34:1022–1035.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimi Mahabadi et al. (2021b)</span>
<span class="ltx_bibblock">
Rabeeh Karimi Mahabadi, James Henderson, and Sebastian Ruder.
2021b.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://proceedings.neurips.cc/paper_files/paper/2021/file/081be9fdff07f3bc808f935906ef70c0-Paper.pdf" title="" class="ltx_ref ltx_href">Compacter: Efficient low-rank hypercomplex adapter layers</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, pages
1022–1035.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020a)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Martin Jaggi, Satyen Kale, Mehryar Mohri, Sashank J
Reddi, Sebastian U Stich, and Ananda Theertha Suresh. 2020a.

</span>
<span class="ltx_bibblock">Mime: Mimicking centralized stochastic algorithms in federated
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2008.03606</em>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020b)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh. 2020b.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, pages 5132–5143.
PMLR.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2015)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba. 2015.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Learning Representations (ICLR)</em>.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2019)</span>
<span class="ltx_bibblock">
Kisung Lee, Ling Liu, Raghu L. Ganti, Mudhakar Srivatsa, Qi Zhang, Yang Zhou,
and Qingyang Wang. 2019.

</span>
<span class="ltx_bibblock">Lightwieight indexing and querying services for big spatial data.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Services Computing (TSC)</em>,
12(3):343–355.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2015)</span>
<span class="ltx_bibblock">
Kisung Lee, Ling Liu, Karsten Schwan, Calton Pu, Qi Zhang, Yang Zhou, Emre
Yigitoglu, and Pingpeng Yuan. 2015.

</span>
<span class="ltx_bibblock">Scaling iterative graph computations with graphmap.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. for High Performance Computing, Networking,
Storage and Analysis (SC)</em>, pages 57:1–57:12.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2013)</span>
<span class="ltx_bibblock">
Kisung Lee, Ling Liu, Yuzhe Tang, Qi Zhang, and Yang Zhou. 2013.

</span>
<span class="ltx_bibblock">Efficient and customizable data partitioning framework for
distributed big rdf data processing in the cloud.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. on Cloud Computing (CLOUD)</em>, pages
327–334.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lester et al. (2021)</span>
<span class="ltx_bibblock">
Brian Lester, Rami Al-Rfou, and Noah Constant. 2021.

</span>
<span class="ltx_bibblock">The power of scale for parameter-efficient prompt tuning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Conf. on Empirical Methods in Natural Language Processing
(EMNLP)</em>, pages 3045–3059. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2019)</span>
<span class="ltx_bibblock">
Mike Lewis, Yinhan Liu, Naman Goyal, Marjan Ghazvininejad, Abdelrahman Mohamed,
Omer Levy, Ves Stoyanov, and Luke Zettlemoyer. 2019.

</span>
<span class="ltx_bibblock">Bart: Denoising sequence-to-sequence pre-training for natural
language generation, translation, and comprehension.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.13461</em>.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2023)</span>
<span class="ltx_bibblock">
Guanghao Li, Yue Hu, Miao Zhang, Ji Liu, Quanjun Yin, Yong Peng, and Dejing
Dou. 2023.

</span>
<span class="ltx_bibblock">Fedhisyn: A hierarchical synchronous federated learning framework for
resource and data heterogeneity.

</span>
<span class="ltx_bibblock">In <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Parallel Processing (ICPP)</em>, pages 1–11.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Liang (2021)</span>
<span class="ltx_bibblock">
Xiang Lisa Li and Percy Liang. 2021.

</span>
<span class="ltx_bibblock">Prefix-tuning: Optimizing continuous prompts for generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Annual Meeting of the Association for Computational
Linguistics and Int. Joint Conf. on Natural Language Processing
(ACL/IJCNLP)</em>, pages 4582–4597. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">Volume 1: Long Papers.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022a)</span>
<span class="ltx_bibblock">
Ji Liu, Daxiang Dong, Xi Wang, An Qin, Xingjian Li, Patrick Valduriez, Dejing
Dou, and Dianhai Yu. 2022a.

</span>
<span class="ltx_bibblock">Large-scale knowledge distillation with elastic heterogeneous
computing resources.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Concurrency and Computation: Practice and Experience</em>, pages
1–16.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022b)</span>
<span class="ltx_bibblock">
Ji Liu, Jizhou Huang, Yang Zhou, Xuhong Li, Shilei Ji, Haoyi Xiong, and Dejing
Dou. 2022b.

</span>
<span class="ltx_bibblock">From distributed machine learning to federated learning: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">Knowledge and Information Systems (KAIS)</em>, 64(4):885–917.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023a)</span>
<span class="ltx_bibblock">
Ji Liu, Juncheng Jia, Beichen Ma, Chendi Zhou, Jingbo Zhou, Yang Zhou, Huaiyu
Dai, and Dejing Dou. 2023a.

</span>
<span class="ltx_bibblock">Multi-job intelligent scheduling with cross-device federated
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems (TPDS)</em>,
34(2):535–551.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2016)</span>
<span class="ltx_bibblock">
Ji Liu, Esther Pacitti, Patrick Valduriez, Daniel de Oliveira, and Marta
Mattoso. 2016.

</span>
<span class="ltx_bibblock">Multi-objective scheduling of scientific workflows in multisite
clouds.

</span>
<span class="ltx_bibblock"><em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems (FGCS)</em>, 63:76–95.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2015)</span>
<span class="ltx_bibblock">
Ji Liu, Esther Pacitti, Patrick Valduriez, and Marta Mattoso. 2015.

</span>
<span class="ltx_bibblock">A survey of data-intensive scientific workflow management.

</span>
<span class="ltx_bibblock"><em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">Journal of Grid Computing</em>, 13(4):457–493.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2019a)</span>
<span class="ltx_bibblock">
Ji Liu, Luis Pineda-Morales, Esther Pacitti, Alexandru Costan, Patrick
Valduriez, Gabriel Antoniu, and Marta Mattoso. 2019a.

</span>
<span class="ltx_bibblock">Efficient scheduling of scientific workflows using hot metadata in a
multisite cloud.

</span>
<span class="ltx_bibblock"><em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Knowledge and Data Engineering
(TKDE)</em>, 31(10):1940–1953.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023b)</span>
<span class="ltx_bibblock">
Ji Liu, Zhihua Wu, Danlei Feng, Minxu Zhang, Xinxuan Wu, Xuefeng Yao, Dianhai
Yu, Yanjun Ma, Feng Zhao, and Dejing Dou. 2023b.

</span>
<span class="ltx_bibblock">Heterps: Distributed deep learning with reinforcement learning based
scheduling in heterogeneous environments.

</span>
<span class="ltx_bibblock"><em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems</em>, 148(C):106–117.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2023c)</span>
<span class="ltx_bibblock">
Ji Liu, Xuehai Zhou, Lei Mo, Shilei Ji, Yuan Liao, Zheng Li, Qin Gu, and Dejing
Dou. 2023c.

</span>
<span class="ltx_bibblock">Distributed and deep vertical federated learning with big data.

</span>
<span class="ltx_bibblock"><em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">Concurrency and Computation: Practice and Experience</em>,
35(21):1–17.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Wei Liu, Li Chen, Yunfei Chen, and Wenyi Zhang. 2020.

</span>
<span class="ltx_bibblock">Accelerating federated learning via momentum gradient descent.

</span>
<span class="ltx_bibblock"><em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems
(TPDS)</em>, 31(8):1754–1766.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022c)</span>
<span class="ltx_bibblock">
Xiangyang Liu, Tianxiang Sun, Xuanjing Huang, and Xipeng Qiu.
2022c.

</span>
<span class="ltx_bibblock">Late prompt tuning: A late prompt could be better than many
prompts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics:
(EMNLP)</em>, pages 1325–1338. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022d)</span>
<span class="ltx_bibblock">
Xiao Liu, Kaixuan Ji, Yicheng Fu, Weng Tam, Zhengxiao Du, Zhilin Yang, and Jie
Tang. 2022d.

</span>
<span class="ltx_bibblock">P-tuning: Prompt tuning can be comparable to fine-tuning across
scales and tasks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">Annual Meeting of the Association for Computational
Linguistics (ACL)</em>, pages 61–68.

</span>
<span class="ltx_bibblock">Volume 2: Short Papers.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Xiao Liu, Yanan Zheng, Zhengxiao Du, Ming Ding, Yujie Qian, Zhilin Yang, and
Jie Tang. 2021.

</span>
<span class="ltx_bibblock">Gpt understands, too.

</span>
<span class="ltx_bibblock"><em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2103.10385</em>.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2019b)</span>
<span class="ltx_bibblock">
Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer
Levy, Mike Lewis, Luke Zettlemoyer, and Veselin Stoyanov. 2019b.

</span>
<span class="ltx_bibblock">Roberta: A robustly optimized bert pretraining approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1907.11692</em>.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics (AISTATS)</em>, pages
1273–1282.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mellor et al. (2021)</span>
<span class="ltx_bibblock">
Joe Mellor, Jack Turner, Amos Storkey, and Elliot J Crowley. 2021.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://proceedings.mlr.press/v139/mellor21a.html" title="" class="ltx_ref ltx_href">Neural
architecture search without training</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on Machine
Learning</em>, volume 139, pages 7588–7598.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nair and Hinton (2010)</span>
<span class="ltx_bibblock">
Vinod Nair and Geoffrey E Hinton. 2010.

</span>
<span class="ltx_bibblock">Rectified linear units improve restricted boltzmann machines.

</span>
<span class="ltx_bibblock">In <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, pages 807–814.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Official Journal of the European Union (2016)</span>
<span class="ltx_bibblock">
Official Journal of the European Union. 2016.

</span>
<span class="ltx_bibblock">General data protection regulation.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://eur-lex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32016R0679" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://eur-lex.europa.eu/legal-content/EN/TXT/PDF/?uri=CELEX:32016R0679</a>.

</span>
<span class="ltx_bibblock">Online; accessed 09/05/2022.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oliveira et al. (2019)</span>
<span class="ltx_bibblock">
Daniel C. M. de Oliveira, Ji Liu, and Esther Pacitti. 2019.

</span>
<span class="ltx_bibblock"><em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">Data-Intensive Workflow Management: For Clouds and
Data-Intensive and Scalable Computing Environments</em>.

</span>
<span class="ltx_bibblock">Morgan &amp; Claypool.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang and Lee (2004)</span>
<span class="ltx_bibblock">
Bo Pang and Lillian Lee. 2004.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.3115/1218955.1218990" title="" class="ltx_ref ltx_href">A sentimental
education: Sentiment analysis using subjectivity summarization based on
minimum cuts</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 42nd Annual Meeting on Association for
Computational Linguistics</em>, page 271–es.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang and Lee (2005)</span>
<span class="ltx_bibblock">
Bo Pang and Lillian Lee. 2005.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.3115/1219840.1219855" title="" class="ltx_ref ltx_href">Seeing stars:
Exploiting class relationships for sentiment categorization with respect to
rating scales</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib63.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 43rd Annual Meeting on Association for
Computational Linguistics</em>, page 115–124.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2019)</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, and Ilya
Sutskever. 2019.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock"><em id="bib.bib64.1.1" class="ltx_emph ltx_font_italic">OpenAI blog</em>.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajpurkar et al. (2016)</span>
<span class="ltx_bibblock">
Pranav Rajpurkar, Jian Zhang, Konstantin Lopyrev, and Percy Liang. 2016.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://aclanthology.org/D16-1264" title="" class="ltx_ref ltx_href">SQuAD: 100,000+
questions for machine comprehension of text</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib65.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2016 Conference on Empirical Methods in
Natural Language Processing</em>.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2018a)</span>
<span class="ltx_bibblock">
S Reddi, Manzil Zaheer, Devendra Sachan, Satyen Kale, and Sanjiv Kumar.
2018a.

</span>
<span class="ltx_bibblock">Adaptive methods for nonconvex optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib66.1.1" class="ltx_emph ltx_font_italic">Annual Conf. on Neural Information Processing Systems
(NeurIPS)</em>, pages 1–17.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2018b)</span>
<span class="ltx_bibblock">
Sashank J. Reddi, Satyen Kale, and Sanjiv Kumar. 2018b.

</span>
<span class="ltx_bibblock">On the convergence of adam and beyond.

</span>
<span class="ltx_bibblock">In <em id="bib.bib67.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Learning Representations (ICLR)</em>.
OpenReview.net.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et al. (2022)</span>
<span class="ltx_bibblock">
Victor Sanh, Albert Webson, Colin Raffel, Stephen Bach, Lintang Sutawika, Zaid
Alyafeai, Antoine Chaffin, Arnaud Stiegler, Arun Raja, Manan Dey, M Saiful
Bari, Canwen Xu, Urmish Thakker, Shanya Sharma Sharma, Eliza Szczechla,
Taewoon Kim, Gunjan Chhablani, Nihal Nayak, Debajyoti Datta, Jonathan Chang,
Mike Tian-Jian Jiang, Han Wang, Matteo Manica, Sheng Shen, Zheng Xin Yong,
Harshit Pandey, Rachel Bawden, Thomas Wang, Trishala Neeraj, Jos Rozen,
Abheesht Sharma, Andrea Santilli, Thibault Fevry, Jason Alan Fries, Ryan
Teehan, Teven Le Scao, Stella Biderman, Leo Gao, Thomas Wolf, and Alexander M
Rush. 2022.

</span>
<span class="ltx_bibblock">Multitask prompted training enables zero-shot task generalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib68.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Learning Representations (ICLR)</em>, pages
1–216.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shin et al. (2020)</span>
<span class="ltx_bibblock">
Taylor Shin, Yasaman Razeghi, Robert L. Logan IV, Eric Wallace, and Sameer
Singh. 2020.

</span>
<span class="ltx_bibblock">Autoprompt: Eliciting knowledge from language models with
automatically generated prompts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib69.1.1" class="ltx_emph ltx_font_italic">Conf. on Empirical Methods in Natural Language Processing
(EMNLP)</em>, pages 4222–4235. Association for Computational Linguistics.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Socher et al. (2013)</span>
<span class="ltx_bibblock">
Richard Socher, Alex Perelygin, Jean Wu, Jason Chuang, Christopher D. Manning,
Andrew Ng, and Christopher Potts. 2013.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://aclanthology.org/D13-1170" title="" class="ltx_ref ltx_href">Recursive deep models for
semantic compositionality over a sentiment treebank</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib70.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2013 Conference on Empirical Methods in
Natural Language Processing</em>, pages 1631–1642.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2022)</span>
<span class="ltx_bibblock">
Guangyu Sun, Matias Mendieta, Taojiannan Yang, and Chen Chen. 2022.

</span>
<span class="ltx_bibblock">Exploring parameter-efficient fine-tuning for improving communication
efficiency in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib71.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.01708</em>.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sutskever et al. (2013)</span>
<span class="ltx_bibblock">
Ilya Sutskever, James Martens, George Dahl, and Geoffrey Hinton. 2013.

</span>
<span class="ltx_bibblock">On the importance of initialization and momentum in deep learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib72.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, pages 1139–1147.

</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2022)</span>
<span class="ltx_bibblock">
Yuanyishu Tian, Yao Wan, Lingjuan Lyu, Dezhong Yao, Hai Jin, and Lichao Sun.
2022.

</span>
<span class="ltx_bibblock">Fedbert: when federated learning meets pre-training.

</span>
<span class="ltx_bibblock"><em id="bib.bib73.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and Technology
(TIST)</em>, 13(4):1–26.

</span>
</li>
<li id="bib.bib74" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne
Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric
Hambro, Faisal Azhar, et al. 2023.

</span>
<span class="ltx_bibblock">LLama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em id="bib.bib74.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2302.13971</em>.

</span>
</li>
<li id="bib.bib75" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Voorhees and Tice (2000)</span>
<span class="ltx_bibblock">
Ellen M. Voorhees and Dawn M. Tice. 2000.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://doi.org/10.1145/345508.345577" title="" class="ltx_ref ltx_href">Building a question
answering test collection</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib75.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 23rd Annual International ACM SIGIR
Conference on Research and Development in Information Retrieval</em>, page
200–207.

</span>
</li>
<li id="bib.bib76" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Alex Wang, Amanpreet Singh, Julian Michael, Felix Hill, Omer Levy, and
Samuel R. Bowman. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://openreview.net/forum?id=rJ4km2R5t7" title="" class="ltx_ref ltx_href">GLUE: A
multi-task benchmark and analysis platform for natural language
understanding</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib76.1.1" class="ltx_emph ltx_font_italic">7th International Conference on Learning Representations,
ICLR 2019, New Orleans, LA, USA, May 6-9, 2019</em>.

</span>
</li>
<li id="bib.bib77" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Jianyu Wang, Vinayak Tantia, Nicolas Ballas, and Michael Rabbat. 2020.

</span>
<span class="ltx_bibblock">Slowmo: Improving communication-efficient distributed sgd with slow
momentum.

</span>
<span class="ltx_bibblock">In <em id="bib.bib77.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Learning Representations (ICLR)</em>, pages
1–27.

</span>
</li>
<li id="bib.bib78" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Jianyu Wang, Zheng Xu, Zachary Garrett, Zachary Charles, Luyang Liu, and Gauri
Joshi. 2021.

</span>
<span class="ltx_bibblock">Local adaptivity in federated learning: Convergence and consistency.

</span>
<span class="ltx_bibblock">In <em id="bib.bib78.1.1" class="ltx_emph ltx_font_italic">The Int. Workshop on Federated Learning for User Privacy and
Data Confidentiality in Conjunction with ICML (FL-ICML)</em>.

</span>
</li>
<li id="bib.bib79" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022)</span>
<span class="ltx_bibblock">
Thomas Wang, Adam Roberts, Daniel Hesslow, Teven Le Scao, Hyung Won Chung,
Iz Beltagy, Julien Launay, and Colin Raffel. 2022.

</span>
<span class="ltx_bibblock">What language model architecture and pretraining objective works best
for zero-shot generalization?

</span>
<span class="ltx_bibblock">In <em id="bib.bib79.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, pages
22964–22984. PMLR.

</span>
</li>
<li id="bib.bib80" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Warstadt et al. (2019)</span>
<span class="ltx_bibblock">
Alex Warstadt, Amanpreet Singh, and Samuel R. Bowman. 2019.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://aclanthology.org/Q19-1040" title="" class="ltx_ref ltx_href">Neural network
acceptability judgments</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib80.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>,
7:625–641.

</span>
</li>
<li id="bib.bib81" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wiebe et al. (2005)</span>
<span class="ltx_bibblock">
Janyce Wiebe, Theresa Wilson, and Claire Cardie. 2005.

</span>
<span class="ltx_bibblock">Annotating expressions of opinions and emotions in language.

</span>
<span class="ltx_bibblock"><em id="bib.bib81.1.1" class="ltx_emph ltx_font_italic">Language Resources and Evaluation</em>, 39:165–210.

</span>
</li>
<li id="bib.bib82" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2021)</span>
<span class="ltx_bibblock">
Sixing Wu, Ying Li, Dawei Zhang, Yang Zhou, and Zhonghai Wu. 2021.

</span>
<span class="ltx_bibblock">Topicka: Generating commonsense knowledge-aware dialogue responses
towards the recommended topic fact.

</span>
<span class="ltx_bibblock">In <em id="bib.bib82.1.1" class="ltx_emph ltx_font_italic">Int. Joint Conf. on Artificial Intelligence (IJCAI)</em>,
pages 3766–3772.

</span>
</li>
<li id="bib.bib83" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2022)</span>
<span class="ltx_bibblock">
Zhuofeng Wu, Sinong Wang, Jiatao Gu, Rui Hou, Yuxiao Dong, V.G.Vinod
Vydiswaran, and Hao Ma. 2022.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://aclanthology.org/2022.naacl-main.403" title="" class="ltx_ref ltx_href">IDPG: An
instance-dependent prompt generation method</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib83.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2022 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies</em>, pages 5507–5521.

</span>
</li>
<li id="bib.bib84" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2022a)</span>
<span class="ltx_bibblock">
Da Yan, Wenwen Qu, Guimu Guo, Xiaoling Wang, and Yang Zhou. 2022a.

</span>
<span class="ltx_bibblock">Prefixfpm: A parallel framework for general-purpose mining of
frequent and closed patterns.

</span>
<span class="ltx_bibblock"><em id="bib.bib84.1.1" class="ltx_emph ltx_font_italic">The VLDB Journal (VLDBJ)</em>, 31(2):253–286.

</span>
</li>
<li id="bib.bib85" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2022b)</span>
<span class="ltx_bibblock">
Da Yan, Yang Zhou, and Guimu Guo. 2022b.

</span>
<span class="ltx_bibblock">Think-like-a-task programming model.

</span>
<span class="ltx_bibblock"><em id="bib.bib85.1.1" class="ltx_emph ltx_font_italic">Encyclopedia of Big Data Technologies</em>.

</span>
</li>
<li id="bib.bib86" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yan et al. (2022c)</span>
<span class="ltx_bibblock">
Da Yan, Yang Zhou, Guimu Guo, and Hang Liu. 2022c.

</span>
<span class="ltx_bibblock">Parallel graph processing.

</span>
<span class="ltx_bibblock"><em id="bib.bib86.1.1" class="ltx_emph ltx_font_italic">Encyclopedia of Big Data Technologies</em>.

</span>
</li>
<li id="bib.bib87" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2019)</span>
<span class="ltx_bibblock">
Qiang Yang, Yang Liu, Tianjian Chen, and Yongxin Tong. 2019.

</span>
<span class="ltx_bibblock">Federated machine learning: Concept and applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib87.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and Technology (TIST)</em>,
10(2):1–19.

</span>
</li>
<li id="bib.bib88" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2020)</span>
<span class="ltx_bibblock">
Z. Yao, A. Gholami, K. Keutzer, and M. W. Mahoney. 2020.

</span>
<span class="ltx_bibblock">Pyhessian: Neural networks through the lens of the hessian.

</span>
<span class="ltx_bibblock">In <em id="bib.bib88.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. on Big Data (Big Data)</em>, pages 581–590.
IEEE Computer Society.

</span>
</li>
<li id="bib.bib89" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2021)</span>
<span class="ltx_bibblock">
Honglin Yuan, Manzil Zaheer, and Sashank Reddi. 2021.

</span>
<span class="ltx_bibblock">Federated composite optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib89.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, volume 139, pages
12253–12266.

</span>
</li>
<li id="bib.bib90" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Hong Zhang, Ji Liu, Juncheng Jia, Yang Zhou, Huaiyu Dai, and Dejing Dou. 2022.

</span>
<span class="ltx_bibblock">FedDUAP: Federated learning with dynamic update and adaptive
pruning using shared data on the server.

</span>
<span class="ltx_bibblock">In <em id="bib.bib90.1.1" class="ltx_emph ltx_font_italic">Int. Joint Conf. on Artificial Intelligence (IJCAI)</em>,
pages 2776–2782.

</span>
</li>
<li id="bib.bib91" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2014)</span>
<span class="ltx_bibblock">
Qi Zhang, Ling Liu, Kisung Lee, Yang Zhou, Aameek Singh, Nagapramod Mandagere,
Sandeep Gopisetty, and Gabriel Alatorre. 2014.

</span>
<span class="ltx_bibblock">Improving hadoop service provisioning in a geographically distributed
cloud.

</span>
<span class="ltx_bibblock">In <em id="bib.bib91.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. on Cloud Computing (CLOUD)</em>, pages
432–439.

</span>
</li>
<li id="bib.bib92" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2013)</span>
<span class="ltx_bibblock">
Qi Zhang, Ling Liu, Yi Ren, Kisung Lee, Yuzhe Tang, Xu Zhao, and Yang Zhou.
2013.

</span>
<span class="ltx_bibblock">Residency aware inter-vm communication in virtualized cloud:
Performance measurement and analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib92.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. on Cloud Computing (CLOUD)</em>, pages
204–211.

</span>
</li>
<li id="bib.bib93" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Zeru Zhang, Jiayin Jin, Zijie Zhang, Yang Zhou, Xin Zhao, Jiaxiang Ren, Ji Liu,
Lingfei Wu, Ruoming Jin, and Dejing Dou. 2021.

</span>
<span class="ltx_bibblock">Validating the lottery ticket hypothesis with inertial manifold
theory.

</span>
<span class="ltx_bibblock"><em id="bib.bib93.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>,
34.

</span>
</li>
<li id="bib.bib94" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2023)</span>
<span class="ltx_bibblock">
Haodong Zhao, Wei Du, Fangqi Li, Peixuan Li, and Gongshen Liu. 2023.

</span>
<span class="ltx_bibblock">Fedprompt: Communication-efficient and privacy-preserving prompt
tuning in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib94.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Conf. on Acoustics, Speech and Signal Processing
(ICASSP)</em>, pages 1–5.

</span>
</li>
<li id="bib.bib95" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2021)</span>
<span class="ltx_bibblock">
Xin Zhao, Zeru Zhang, Zijie Zhang, Lingfei Wu, Jiayin Jin, Yang Zhou, Ruoming
Jin, Dejing Dou, and Da Yan. 2021.

</span>
<span class="ltx_bibblock">Expressive 1-lipschitz neural networks for robust multiple graph
learning against adversarial attacks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib95.1.1" class="ltx_emph ltx_font_italic">Int. Conf. on Machine Learning (ICML)</em>, pages 12719–12735.

</span>
</li>
<li id="bib.bib96" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2022)</span>
<span class="ltx_bibblock">
Chendi Zhou, Ji Liu, Juncheng Jia, Jingbo Zhou, Yang Zhou, Huaiyu Dai, and
Dejing Dou. 2022.

</span>
<span class="ltx_bibblock">Efficient device scheduling with multi-job federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib96.1.1" class="ltx_emph ltx_font_italic">AAAI Conf. on Artificial Intelligence (AAAI)</em>, pages
9971–9979.

</span>
</li>
<li id="bib.bib97" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou (2017)</span>
<span class="ltx_bibblock">
Yang Zhou. 2017.

</span>
<span class="ltx_bibblock"><em id="bib.bib97.1.1" class="ltx_emph ltx_font_italic">Innovative Mining, Processing, and Application of Big Graphs</em>.

</span>
<span class="ltx_bibblock">Ph.D. thesis, Georgia Institute of Technology, Atlanta, GA, USA.

</span>
</li>
<li id="bib.bib98" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou and Liu (2013)</span>
<span class="ltx_bibblock">
Yang Zhou and Ling Liu. 2013.

</span>
<span class="ltx_bibblock">Social influence based clustering of heterogeneous information
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib98.1.1" class="ltx_emph ltx_font_italic">ACM SIGKDD Conf. on Knowledge Discovery and Data Mining
(KDD)</em>, pages 338–346.

</span>
</li>
<li id="bib.bib99" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2015a)</span>
<span class="ltx_bibblock">
Yang Zhou, Ling Liu, Kisung Lee, Calton Pu, and Qi Zhang. 2015a.

</span>
<span class="ltx_bibblock">Policy-driven autonomic configuration management for nosql.

</span>
<span class="ltx_bibblock">In <em id="bib.bib99.1.1" class="ltx_emph ltx_font_italic">ACM Symposium on High-Performance Parallel and Distributed
Computing (HPDC)</em>, pages 179–190.

</span>
</li>
<li id="bib.bib100" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2015b)</span>
<span class="ltx_bibblock">
Yang Zhou, Ling Liu, Kisung Lee, and Qi Zhang. 2015b.

</span>
<span class="ltx_bibblock">Graphtwist: Fast iterative graph computation with two-tier
optimizations.

</span>
<span class="ltx_bibblock"><em id="bib.bib100.1.1" class="ltx_emph ltx_font_italic">The VLDB Journal (VLDBJ)</em>, 8(11):1262–1273.

</span>
</li>
<li id="bib.bib101" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2014)</span>
<span class="ltx_bibblock">
Yang Zhou, Sangeetha Seshadri, Lawrence Chiu, and Ling Liu. 2014.

</span>
<span class="ltx_bibblock">Graphlens: Mining enterprise storage workloads using graph analytics.

</span>
<span class="ltx_bibblock">In <em id="bib.bib101.1.1" class="ltx_emph ltx_font_italic">IEEE Int. Congress on Big Data (BigData)</em>, pages 1–8.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Implementation Details</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Adam Update</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">The original Adam update <cite class="ltx_cite ltx_citemacro_cite">Kingma and Ba (<a href="#bib.bib36" title="" class="ltx_ref">2015</a>)</cite> is shown in Algorithm <a href="#alg3" title="Algorithm 3 ‣ A.1 Adam Update ‣ Appendix A Implementation Details ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="A1.SS1.fig1" class="ltx_figure">
<figure id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.2.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> Adam update</figcaption>
<div id="alg3.3" class="ltx_listing ltx_listing">
<div id="alg3.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>   <math id="alg3.l0.m1.1" class="ltx_Math" alttext="w^{t-1}" display="inline"><semantics id="alg3.l0.m1.1a"><msup id="alg3.l0.m1.1.1" xref="alg3.l0.m1.1.1.cmml"><mi id="alg3.l0.m1.1.1.2" xref="alg3.l0.m1.1.1.2.cmml">w</mi><mrow id="alg3.l0.m1.1.1.3" xref="alg3.l0.m1.1.1.3.cmml"><mi id="alg3.l0.m1.1.1.3.2" xref="alg3.l0.m1.1.1.3.2.cmml">t</mi><mo id="alg3.l0.m1.1.1.3.1" xref="alg3.l0.m1.1.1.3.1.cmml">−</mo><mn id="alg3.l0.m1.1.1.3.3" xref="alg3.l0.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l0.m1.1b"><apply id="alg3.l0.m1.1.1.cmml" xref="alg3.l0.m1.1.1"><csymbol cd="ambiguous" id="alg3.l0.m1.1.1.1.cmml" xref="alg3.l0.m1.1.1">superscript</csymbol><ci id="alg3.l0.m1.1.1.2.cmml" xref="alg3.l0.m1.1.1.2">𝑤</ci><apply id="alg3.l0.m1.1.1.3.cmml" xref="alg3.l0.m1.1.1.3"><minus id="alg3.l0.m1.1.1.3.1.cmml" xref="alg3.l0.m1.1.1.3.1"></minus><ci id="alg3.l0.m1.1.1.3.2.cmml" xref="alg3.l0.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg3.l0.m1.1.1.3.3.cmml" xref="alg3.l0.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m1.1c">w^{t-1}</annotation></semantics></math>: The prompt parameters of the model at Iteration <math id="alg3.l0.m2.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="alg3.l0.m2.1a"><mrow id="alg3.l0.m2.1.1" xref="alg3.l0.m2.1.1.cmml"><mi id="alg3.l0.m2.1.1.2" xref="alg3.l0.m2.1.1.2.cmml">t</mi><mo id="alg3.l0.m2.1.1.1" xref="alg3.l0.m2.1.1.1.cmml">−</mo><mn id="alg3.l0.m2.1.1.3" xref="alg3.l0.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l0.m2.1b"><apply id="alg3.l0.m2.1.1.cmml" xref="alg3.l0.m2.1.1"><minus id="alg3.l0.m2.1.1.1.cmml" xref="alg3.l0.m2.1.1.1"></minus><ci id="alg3.l0.m2.1.1.2.cmml" xref="alg3.l0.m2.1.1.2">𝑡</ci><cn type="integer" id="alg3.l0.m2.1.1.3.cmml" xref="alg3.l0.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m2.1c">t-1</annotation></semantics></math><math id="alg3.l0.m3.1" class="ltx_Math" alttext="m^{t-1}" display="inline"><semantics id="alg3.l0.m3.1a"><msup id="alg3.l0.m3.1.1" xref="alg3.l0.m3.1.1.cmml"><mi id="alg3.l0.m3.1.1.2" xref="alg3.l0.m3.1.1.2.cmml">m</mi><mrow id="alg3.l0.m3.1.1.3" xref="alg3.l0.m3.1.1.3.cmml"><mi id="alg3.l0.m3.1.1.3.2" xref="alg3.l0.m3.1.1.3.2.cmml">t</mi><mo id="alg3.l0.m3.1.1.3.1" xref="alg3.l0.m3.1.1.3.1.cmml">−</mo><mn id="alg3.l0.m3.1.1.3.3" xref="alg3.l0.m3.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l0.m3.1b"><apply id="alg3.l0.m3.1.1.cmml" xref="alg3.l0.m3.1.1"><csymbol cd="ambiguous" id="alg3.l0.m3.1.1.1.cmml" xref="alg3.l0.m3.1.1">superscript</csymbol><ci id="alg3.l0.m3.1.1.2.cmml" xref="alg3.l0.m3.1.1.2">𝑚</ci><apply id="alg3.l0.m3.1.1.3.cmml" xref="alg3.l0.m3.1.1.3"><minus id="alg3.l0.m3.1.1.3.1.cmml" xref="alg3.l0.m3.1.1.3.1"></minus><ci id="alg3.l0.m3.1.1.3.2.cmml" xref="alg3.l0.m3.1.1.3.2">𝑡</ci><cn type="integer" id="alg3.l0.m3.1.1.3.3.cmml" xref="alg3.l0.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m3.1c">m^{t-1}</annotation></semantics></math>: The <math id="alg3.l0.m4.1" class="ltx_Math" alttext="1^{st}" display="inline"><semantics id="alg3.l0.m4.1a"><msup id="alg3.l0.m4.1.1" xref="alg3.l0.m4.1.1.cmml"><mn id="alg3.l0.m4.1.1.2" xref="alg3.l0.m4.1.1.2.cmml">1</mn><mrow id="alg3.l0.m4.1.1.3" xref="alg3.l0.m4.1.1.3.cmml"><mi id="alg3.l0.m4.1.1.3.2" xref="alg3.l0.m4.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l0.m4.1.1.3.1" xref="alg3.l0.m4.1.1.3.1.cmml">​</mo><mi id="alg3.l0.m4.1.1.3.3" xref="alg3.l0.m4.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l0.m4.1b"><apply id="alg3.l0.m4.1.1.cmml" xref="alg3.l0.m4.1.1"><csymbol cd="ambiguous" id="alg3.l0.m4.1.1.1.cmml" xref="alg3.l0.m4.1.1">superscript</csymbol><cn type="integer" id="alg3.l0.m4.1.1.2.cmml" xref="alg3.l0.m4.1.1.2">1</cn><apply id="alg3.l0.m4.1.1.3.cmml" xref="alg3.l0.m4.1.1.3"><times id="alg3.l0.m4.1.1.3.1.cmml" xref="alg3.l0.m4.1.1.3.1"></times><ci id="alg3.l0.m4.1.1.3.2.cmml" xref="alg3.l0.m4.1.1.3.2">𝑠</ci><ci id="alg3.l0.m4.1.1.3.3.cmml" xref="alg3.l0.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m4.1c">1^{st}</annotation></semantics></math> momentum vector at Iteration <math id="alg3.l0.m5.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="alg3.l0.m5.1a"><mrow id="alg3.l0.m5.1.1" xref="alg3.l0.m5.1.1.cmml"><mi id="alg3.l0.m5.1.1.2" xref="alg3.l0.m5.1.1.2.cmml">t</mi><mo id="alg3.l0.m5.1.1.1" xref="alg3.l0.m5.1.1.1.cmml">−</mo><mn id="alg3.l0.m5.1.1.3" xref="alg3.l0.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l0.m5.1b"><apply id="alg3.l0.m5.1.1.cmml" xref="alg3.l0.m5.1.1"><minus id="alg3.l0.m5.1.1.1.cmml" xref="alg3.l0.m5.1.1.1"></minus><ci id="alg3.l0.m5.1.1.2.cmml" xref="alg3.l0.m5.1.1.2">𝑡</ci><cn type="integer" id="alg3.l0.m5.1.1.3.cmml" xref="alg3.l0.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m5.1c">t-1</annotation></semantics></math><math id="alg3.l0.m6.1" class="ltx_Math" alttext="v^{t-1}" display="inline"><semantics id="alg3.l0.m6.1a"><msup id="alg3.l0.m6.1.1" xref="alg3.l0.m6.1.1.cmml"><mi id="alg3.l0.m6.1.1.2" xref="alg3.l0.m6.1.1.2.cmml">v</mi><mrow id="alg3.l0.m6.1.1.3" xref="alg3.l0.m6.1.1.3.cmml"><mi id="alg3.l0.m6.1.1.3.2" xref="alg3.l0.m6.1.1.3.2.cmml">t</mi><mo id="alg3.l0.m6.1.1.3.1" xref="alg3.l0.m6.1.1.3.1.cmml">−</mo><mn id="alg3.l0.m6.1.1.3.3" xref="alg3.l0.m6.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l0.m6.1b"><apply id="alg3.l0.m6.1.1.cmml" xref="alg3.l0.m6.1.1"><csymbol cd="ambiguous" id="alg3.l0.m6.1.1.1.cmml" xref="alg3.l0.m6.1.1">superscript</csymbol><ci id="alg3.l0.m6.1.1.2.cmml" xref="alg3.l0.m6.1.1.2">𝑣</ci><apply id="alg3.l0.m6.1.1.3.cmml" xref="alg3.l0.m6.1.1.3"><minus id="alg3.l0.m6.1.1.3.1.cmml" xref="alg3.l0.m6.1.1.3.1"></minus><ci id="alg3.l0.m6.1.1.3.2.cmml" xref="alg3.l0.m6.1.1.3.2">𝑡</ci><cn type="integer" id="alg3.l0.m6.1.1.3.3.cmml" xref="alg3.l0.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m6.1c">v^{t-1}</annotation></semantics></math>: The <math id="alg3.l0.m7.1" class="ltx_Math" alttext="2^{st}" display="inline"><semantics id="alg3.l0.m7.1a"><msup id="alg3.l0.m7.1.1" xref="alg3.l0.m7.1.1.cmml"><mn id="alg3.l0.m7.1.1.2" xref="alg3.l0.m7.1.1.2.cmml">2</mn><mrow id="alg3.l0.m7.1.1.3" xref="alg3.l0.m7.1.1.3.cmml"><mi id="alg3.l0.m7.1.1.3.2" xref="alg3.l0.m7.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l0.m7.1.1.3.1" xref="alg3.l0.m7.1.1.3.1.cmml">​</mo><mi id="alg3.l0.m7.1.1.3.3" xref="alg3.l0.m7.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l0.m7.1b"><apply id="alg3.l0.m7.1.1.cmml" xref="alg3.l0.m7.1.1"><csymbol cd="ambiguous" id="alg3.l0.m7.1.1.1.cmml" xref="alg3.l0.m7.1.1">superscript</csymbol><cn type="integer" id="alg3.l0.m7.1.1.2.cmml" xref="alg3.l0.m7.1.1.2">2</cn><apply id="alg3.l0.m7.1.1.3.cmml" xref="alg3.l0.m7.1.1.3"><times id="alg3.l0.m7.1.1.3.1.cmml" xref="alg3.l0.m7.1.1.3.1"></times><ci id="alg3.l0.m7.1.1.3.2.cmml" xref="alg3.l0.m7.1.1.3.2">𝑠</ci><ci id="alg3.l0.m7.1.1.3.3.cmml" xref="alg3.l0.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m7.1c">2^{st}</annotation></semantics></math> momentum vector at Iteration <math id="alg3.l0.m8.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="alg3.l0.m8.1a"><mrow id="alg3.l0.m8.1.1" xref="alg3.l0.m8.1.1.cmml"><mi id="alg3.l0.m8.1.1.2" xref="alg3.l0.m8.1.1.2.cmml">t</mi><mo id="alg3.l0.m8.1.1.1" xref="alg3.l0.m8.1.1.1.cmml">−</mo><mn id="alg3.l0.m8.1.1.3" xref="alg3.l0.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg3.l0.m8.1b"><apply id="alg3.l0.m8.1.1.cmml" xref="alg3.l0.m8.1.1"><minus id="alg3.l0.m8.1.1.1.cmml" xref="alg3.l0.m8.1.1.1"></minus><ci id="alg3.l0.m8.1.1.2.cmml" xref="alg3.l0.m8.1.1.2">𝑡</ci><cn type="integer" id="alg3.l0.m8.1.1.3.cmml" xref="alg3.l0.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m8.1c">t-1</annotation></semantics></math><math id="alg3.l0.m9.1" class="ltx_Math" alttext="g^{t}" display="inline"><semantics id="alg3.l0.m9.1a"><msup id="alg3.l0.m9.1.1" xref="alg3.l0.m9.1.1.cmml"><mi id="alg3.l0.m9.1.1.2" xref="alg3.l0.m9.1.1.2.cmml">g</mi><mi id="alg3.l0.m9.1.1.3" xref="alg3.l0.m9.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg3.l0.m9.1b"><apply id="alg3.l0.m9.1.1.cmml" xref="alg3.l0.m9.1.1"><csymbol cd="ambiguous" id="alg3.l0.m9.1.1.1.cmml" xref="alg3.l0.m9.1.1">superscript</csymbol><ci id="alg3.l0.m9.1.1.2.cmml" xref="alg3.l0.m9.1.1.2">𝑔</ci><ci id="alg3.l0.m9.1.1.3.cmml" xref="alg3.l0.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m9.1c">g^{t}</annotation></semantics></math>: The gradients corresponding to <math id="alg3.l0.m10.1" class="ltx_Math" alttext="w^{t-1}" display="inline"><semantics id="alg3.l0.m10.1a"><msup id="alg3.l0.m10.1.1" xref="alg3.l0.m10.1.1.cmml"><mi id="alg3.l0.m10.1.1.2" xref="alg3.l0.m10.1.1.2.cmml">w</mi><mrow id="alg3.l0.m10.1.1.3" xref="alg3.l0.m10.1.1.3.cmml"><mi id="alg3.l0.m10.1.1.3.2" xref="alg3.l0.m10.1.1.3.2.cmml">t</mi><mo id="alg3.l0.m10.1.1.3.1" xref="alg3.l0.m10.1.1.3.1.cmml">−</mo><mn id="alg3.l0.m10.1.1.3.3" xref="alg3.l0.m10.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l0.m10.1b"><apply id="alg3.l0.m10.1.1.cmml" xref="alg3.l0.m10.1.1"><csymbol cd="ambiguous" id="alg3.l0.m10.1.1.1.cmml" xref="alg3.l0.m10.1.1">superscript</csymbol><ci id="alg3.l0.m10.1.1.2.cmml" xref="alg3.l0.m10.1.1.2">𝑤</ci><apply id="alg3.l0.m10.1.1.3.cmml" xref="alg3.l0.m10.1.1.3"><minus id="alg3.l0.m10.1.1.3.1.cmml" xref="alg3.l0.m10.1.1.3.1"></minus><ci id="alg3.l0.m10.1.1.3.2.cmml" xref="alg3.l0.m10.1.1.3.2">𝑡</ci><cn type="integer" id="alg3.l0.m10.1.1.3.3.cmml" xref="alg3.l0.m10.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m10.1c">w^{t-1}</annotation></semantics></math><math id="alg3.l0.m11.2" class="ltx_Math" alttext="\beta_{1},\beta_{2}" display="inline"><semantics id="alg3.l0.m11.2a"><mrow id="alg3.l0.m11.2.2.2" xref="alg3.l0.m11.2.2.3.cmml"><msub id="alg3.l0.m11.1.1.1.1" xref="alg3.l0.m11.1.1.1.1.cmml"><mi id="alg3.l0.m11.1.1.1.1.2" xref="alg3.l0.m11.1.1.1.1.2.cmml">β</mi><mn id="alg3.l0.m11.1.1.1.1.3" xref="alg3.l0.m11.1.1.1.1.3.cmml">1</mn></msub><mo id="alg3.l0.m11.2.2.2.3" xref="alg3.l0.m11.2.2.3.cmml">,</mo><msub id="alg3.l0.m11.2.2.2.2" xref="alg3.l0.m11.2.2.2.2.cmml"><mi id="alg3.l0.m11.2.2.2.2.2" xref="alg3.l0.m11.2.2.2.2.2.cmml">β</mi><mn id="alg3.l0.m11.2.2.2.2.3" xref="alg3.l0.m11.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg3.l0.m11.2b"><list id="alg3.l0.m11.2.2.3.cmml" xref="alg3.l0.m11.2.2.2"><apply id="alg3.l0.m11.1.1.1.1.cmml" xref="alg3.l0.m11.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l0.m11.1.1.1.1.1.cmml" xref="alg3.l0.m11.1.1.1.1">subscript</csymbol><ci id="alg3.l0.m11.1.1.1.1.2.cmml" xref="alg3.l0.m11.1.1.1.1.2">𝛽</ci><cn type="integer" id="alg3.l0.m11.1.1.1.1.3.cmml" xref="alg3.l0.m11.1.1.1.1.3">1</cn></apply><apply id="alg3.l0.m11.2.2.2.2.cmml" xref="alg3.l0.m11.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l0.m11.2.2.2.2.1.cmml" xref="alg3.l0.m11.2.2.2.2">subscript</csymbol><ci id="alg3.l0.m11.2.2.2.2.2.cmml" xref="alg3.l0.m11.2.2.2.2.2">𝛽</ci><cn type="integer" id="alg3.l0.m11.2.2.2.2.3.cmml" xref="alg3.l0.m11.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m11.2c">\beta_{1},\beta_{2}</annotation></semantics></math>: Decay rates for the momentum in Adam<math id="alg3.l0.m12.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg3.l0.m12.1a"><mi id="alg3.l0.m12.1.1" xref="alg3.l0.m12.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg3.l0.m12.1b"><ci id="alg3.l0.m12.1.1.cmml" xref="alg3.l0.m12.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0.m12.1c">\alpha</annotation></semantics></math>: The step size

</div>
<div id="alg3.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">0:</span>   <math id="alg3.l0a.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="alg3.l0a.m1.1a"><msup id="alg3.l0a.m1.1.1" xref="alg3.l0a.m1.1.1.cmml"><mi id="alg3.l0a.m1.1.1.2" xref="alg3.l0a.m1.1.1.2.cmml">w</mi><mi id="alg3.l0a.m1.1.1.3" xref="alg3.l0a.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg3.l0a.m1.1b"><apply id="alg3.l0a.m1.1.1.cmml" xref="alg3.l0a.m1.1.1"><csymbol cd="ambiguous" id="alg3.l0a.m1.1.1.1.cmml" xref="alg3.l0a.m1.1.1">superscript</csymbol><ci id="alg3.l0a.m1.1.1.2.cmml" xref="alg3.l0a.m1.1.1.2">𝑤</ci><ci id="alg3.l0a.m1.1.1.3.cmml" xref="alg3.l0a.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m1.1c">w^{t}</annotation></semantics></math>: The prompt parameters at Iteration <math id="alg3.l0a.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg3.l0a.m2.1a"><mi id="alg3.l0a.m2.1.1" xref="alg3.l0a.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg3.l0a.m2.1b"><ci id="alg3.l0a.m2.1.1.cmml" xref="alg3.l0a.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m2.1c">t</annotation></semantics></math><math id="alg3.l0a.m3.1" class="ltx_Math" alttext="m^{t}" display="inline"><semantics id="alg3.l0a.m3.1a"><msup id="alg3.l0a.m3.1.1" xref="alg3.l0a.m3.1.1.cmml"><mi id="alg3.l0a.m3.1.1.2" xref="alg3.l0a.m3.1.1.2.cmml">m</mi><mi id="alg3.l0a.m3.1.1.3" xref="alg3.l0a.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg3.l0a.m3.1b"><apply id="alg3.l0a.m3.1.1.cmml" xref="alg3.l0a.m3.1.1"><csymbol cd="ambiguous" id="alg3.l0a.m3.1.1.1.cmml" xref="alg3.l0a.m3.1.1">superscript</csymbol><ci id="alg3.l0a.m3.1.1.2.cmml" xref="alg3.l0a.m3.1.1.2">𝑚</ci><ci id="alg3.l0a.m3.1.1.3.cmml" xref="alg3.l0a.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m3.1c">m^{t}</annotation></semantics></math>: The <math id="alg3.l0a.m4.1" class="ltx_Math" alttext="1^{st}" display="inline"><semantics id="alg3.l0a.m4.1a"><msup id="alg3.l0a.m4.1.1" xref="alg3.l0a.m4.1.1.cmml"><mn id="alg3.l0a.m4.1.1.2" xref="alg3.l0a.m4.1.1.2.cmml">1</mn><mrow id="alg3.l0a.m4.1.1.3" xref="alg3.l0a.m4.1.1.3.cmml"><mi id="alg3.l0a.m4.1.1.3.2" xref="alg3.l0a.m4.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l0a.m4.1.1.3.1" xref="alg3.l0a.m4.1.1.3.1.cmml">​</mo><mi id="alg3.l0a.m4.1.1.3.3" xref="alg3.l0a.m4.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l0a.m4.1b"><apply id="alg3.l0a.m4.1.1.cmml" xref="alg3.l0a.m4.1.1"><csymbol cd="ambiguous" id="alg3.l0a.m4.1.1.1.cmml" xref="alg3.l0a.m4.1.1">superscript</csymbol><cn type="integer" id="alg3.l0a.m4.1.1.2.cmml" xref="alg3.l0a.m4.1.1.2">1</cn><apply id="alg3.l0a.m4.1.1.3.cmml" xref="alg3.l0a.m4.1.1.3"><times id="alg3.l0a.m4.1.1.3.1.cmml" xref="alg3.l0a.m4.1.1.3.1"></times><ci id="alg3.l0a.m4.1.1.3.2.cmml" xref="alg3.l0a.m4.1.1.3.2">𝑠</ci><ci id="alg3.l0a.m4.1.1.3.3.cmml" xref="alg3.l0a.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m4.1c">1^{st}</annotation></semantics></math> momentum vector at Iteration <math id="alg3.l0a.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg3.l0a.m5.1a"><mi id="alg3.l0a.m5.1.1" xref="alg3.l0a.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg3.l0a.m5.1b"><ci id="alg3.l0a.m5.1.1.cmml" xref="alg3.l0a.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m5.1c">t</annotation></semantics></math><math id="alg3.l0a.m6.1" class="ltx_Math" alttext="v^{t}" display="inline"><semantics id="alg3.l0a.m6.1a"><msup id="alg3.l0a.m6.1.1" xref="alg3.l0a.m6.1.1.cmml"><mi id="alg3.l0a.m6.1.1.2" xref="alg3.l0a.m6.1.1.2.cmml">v</mi><mi id="alg3.l0a.m6.1.1.3" xref="alg3.l0a.m6.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="alg3.l0a.m6.1b"><apply id="alg3.l0a.m6.1.1.cmml" xref="alg3.l0a.m6.1.1"><csymbol cd="ambiguous" id="alg3.l0a.m6.1.1.1.cmml" xref="alg3.l0a.m6.1.1">superscript</csymbol><ci id="alg3.l0a.m6.1.1.2.cmml" xref="alg3.l0a.m6.1.1.2">𝑣</ci><ci id="alg3.l0a.m6.1.1.3.cmml" xref="alg3.l0a.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m6.1c">v^{t}</annotation></semantics></math>: The <math id="alg3.l0a.m7.1" class="ltx_Math" alttext="2^{st}" display="inline"><semantics id="alg3.l0a.m7.1a"><msup id="alg3.l0a.m7.1.1" xref="alg3.l0a.m7.1.1.cmml"><mn id="alg3.l0a.m7.1.1.2" xref="alg3.l0a.m7.1.1.2.cmml">2</mn><mrow id="alg3.l0a.m7.1.1.3" xref="alg3.l0a.m7.1.1.3.cmml"><mi id="alg3.l0a.m7.1.1.3.2" xref="alg3.l0a.m7.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg3.l0a.m7.1.1.3.1" xref="alg3.l0a.m7.1.1.3.1.cmml">​</mo><mi id="alg3.l0a.m7.1.1.3.3" xref="alg3.l0a.m7.1.1.3.3.cmml">t</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="alg3.l0a.m7.1b"><apply id="alg3.l0a.m7.1.1.cmml" xref="alg3.l0a.m7.1.1"><csymbol cd="ambiguous" id="alg3.l0a.m7.1.1.1.cmml" xref="alg3.l0a.m7.1.1">superscript</csymbol><cn type="integer" id="alg3.l0a.m7.1.1.2.cmml" xref="alg3.l0a.m7.1.1.2">2</cn><apply id="alg3.l0a.m7.1.1.3.cmml" xref="alg3.l0a.m7.1.1.3"><times id="alg3.l0a.m7.1.1.3.1.cmml" xref="alg3.l0a.m7.1.1.3.1"></times><ci id="alg3.l0a.m7.1.1.3.2.cmml" xref="alg3.l0a.m7.1.1.3.2">𝑠</ci><ci id="alg3.l0a.m7.1.1.3.3.cmml" xref="alg3.l0a.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m7.1c">2^{st}</annotation></semantics></math> momentum vector at Iteration <math id="alg3.l0a.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg3.l0a.m8.1a"><mi id="alg3.l0a.m8.1.1" xref="alg3.l0a.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg3.l0a.m8.1b"><ci id="alg3.l0a.m8.1.1.cmml" xref="alg3.l0a.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l0a.m8.1c">t</annotation></semantics></math>
</div>
<div id="alg3.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math id="alg3.l1.m1.1" class="ltx_Math" alttext="m^{t}\leftarrow\beta_{1}m^{t-1}+(1-\beta_{1})g^{t}" display="inline"><semantics id="alg3.l1.m1.1a"><mrow id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml"><msup id="alg3.l1.m1.1.1.3" xref="alg3.l1.m1.1.1.3.cmml"><mi id="alg3.l1.m1.1.1.3.2" xref="alg3.l1.m1.1.1.3.2.cmml">m</mi><mi id="alg3.l1.m1.1.1.3.3" xref="alg3.l1.m1.1.1.3.3.cmml">t</mi></msup><mo stretchy="false" id="alg3.l1.m1.1.1.2" xref="alg3.l1.m1.1.1.2.cmml">←</mo><mrow id="alg3.l1.m1.1.1.1" xref="alg3.l1.m1.1.1.1.cmml"><mrow id="alg3.l1.m1.1.1.1.3" xref="alg3.l1.m1.1.1.1.3.cmml"><msub id="alg3.l1.m1.1.1.1.3.2" xref="alg3.l1.m1.1.1.1.3.2.cmml"><mi id="alg3.l1.m1.1.1.1.3.2.2" xref="alg3.l1.m1.1.1.1.3.2.2.cmml">β</mi><mn id="alg3.l1.m1.1.1.1.3.2.3" xref="alg3.l1.m1.1.1.1.3.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1.3.1" xref="alg3.l1.m1.1.1.1.3.1.cmml">​</mo><msup id="alg3.l1.m1.1.1.1.3.3" xref="alg3.l1.m1.1.1.1.3.3.cmml"><mi id="alg3.l1.m1.1.1.1.3.3.2" xref="alg3.l1.m1.1.1.1.3.3.2.cmml">m</mi><mrow id="alg3.l1.m1.1.1.1.3.3.3" xref="alg3.l1.m1.1.1.1.3.3.3.cmml"><mi id="alg3.l1.m1.1.1.1.3.3.3.2" xref="alg3.l1.m1.1.1.1.3.3.3.2.cmml">t</mi><mo id="alg3.l1.m1.1.1.1.3.3.3.1" xref="alg3.l1.m1.1.1.1.3.3.3.1.cmml">−</mo><mn id="alg3.l1.m1.1.1.1.3.3.3.3" xref="alg3.l1.m1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="alg3.l1.m1.1.1.1.2" xref="alg3.l1.m1.1.1.1.2.cmml">+</mo><mrow id="alg3.l1.m1.1.1.1.1" xref="alg3.l1.m1.1.1.1.1.cmml"><mrow id="alg3.l1.m1.1.1.1.1.1.1" xref="alg3.l1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l1.m1.1.1.1.1.1.1.2" xref="alg3.l1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l1.m1.1.1.1.1.1.1.1" xref="alg3.l1.m1.1.1.1.1.1.1.1.cmml"><mn id="alg3.l1.m1.1.1.1.1.1.1.1.2" xref="alg3.l1.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg3.l1.m1.1.1.1.1.1.1.1.1" xref="alg3.l1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg3.l1.m1.1.1.1.1.1.1.1.3" xref="alg3.l1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l1.m1.1.1.1.1.1.1.1.3.2" xref="alg3.l1.m1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mn id="alg3.l1.m1.1.1.1.1.1.1.1.3.3" xref="alg3.l1.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="alg3.l1.m1.1.1.1.1.1.1.3" xref="alg3.l1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg3.l1.m1.1.1.1.1.2" xref="alg3.l1.m1.1.1.1.1.2.cmml">​</mo><msup id="alg3.l1.m1.1.1.1.1.3" xref="alg3.l1.m1.1.1.1.1.3.cmml"><mi id="alg3.l1.m1.1.1.1.1.3.2" xref="alg3.l1.m1.1.1.1.1.3.2.cmml">g</mi><mi id="alg3.l1.m1.1.1.1.1.3.3" xref="alg3.l1.m1.1.1.1.1.3.3.cmml">t</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><apply id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1"><ci id="alg3.l1.m1.1.1.2.cmml" xref="alg3.l1.m1.1.1.2">←</ci><apply id="alg3.l1.m1.1.1.3.cmml" xref="alg3.l1.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.3.1.cmml" xref="alg3.l1.m1.1.1.3">superscript</csymbol><ci id="alg3.l1.m1.1.1.3.2.cmml" xref="alg3.l1.m1.1.1.3.2">𝑚</ci><ci id="alg3.l1.m1.1.1.3.3.cmml" xref="alg3.l1.m1.1.1.3.3">𝑡</ci></apply><apply id="alg3.l1.m1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1"><plus id="alg3.l1.m1.1.1.1.2.cmml" xref="alg3.l1.m1.1.1.1.2"></plus><apply id="alg3.l1.m1.1.1.1.3.cmml" xref="alg3.l1.m1.1.1.1.3"><times id="alg3.l1.m1.1.1.1.3.1.cmml" xref="alg3.l1.m1.1.1.1.3.1"></times><apply id="alg3.l1.m1.1.1.1.3.2.cmml" xref="alg3.l1.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.1.3.2.1.cmml" xref="alg3.l1.m1.1.1.1.3.2">subscript</csymbol><ci id="alg3.l1.m1.1.1.1.3.2.2.cmml" xref="alg3.l1.m1.1.1.1.3.2.2">𝛽</ci><cn type="integer" id="alg3.l1.m1.1.1.1.3.2.3.cmml" xref="alg3.l1.m1.1.1.1.3.2.3">1</cn></apply><apply id="alg3.l1.m1.1.1.1.3.3.cmml" xref="alg3.l1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.1.3.3.1.cmml" xref="alg3.l1.m1.1.1.1.3.3">superscript</csymbol><ci id="alg3.l1.m1.1.1.1.3.3.2.cmml" xref="alg3.l1.m1.1.1.1.3.3.2">𝑚</ci><apply id="alg3.l1.m1.1.1.1.3.3.3.cmml" xref="alg3.l1.m1.1.1.1.3.3.3"><minus id="alg3.l1.m1.1.1.1.3.3.3.1.cmml" xref="alg3.l1.m1.1.1.1.3.3.3.1"></minus><ci id="alg3.l1.m1.1.1.1.3.3.3.2.cmml" xref="alg3.l1.m1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="alg3.l1.m1.1.1.1.3.3.3.3.cmml" xref="alg3.l1.m1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="alg3.l1.m1.1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1.1"><times id="alg3.l1.m1.1.1.1.1.2.cmml" xref="alg3.l1.m1.1.1.1.1.2"></times><apply id="alg3.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1.1.1.1"><minus id="alg3.l1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l1.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg3.l1.m1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l1.m1.1.1.1.1.1.1.1.2">1</cn><apply id="alg3.l1.m1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg3.l1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l1.m1.1.1.1.1.1.1.1.3.2">𝛽</ci><cn type="integer" id="alg3.l1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg3.l1.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg3.l1.m1.1.1.1.1.3.cmml" xref="alg3.l1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l1.m1.1.1.1.1.3.1.cmml" xref="alg3.l1.m1.1.1.1.1.3">superscript</csymbol><ci id="alg3.l1.m1.1.1.1.1.3.2.cmml" xref="alg3.l1.m1.1.1.1.1.3.2">𝑔</ci><ci id="alg3.l1.m1.1.1.1.1.3.3.cmml" xref="alg3.l1.m1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">m^{t}\leftarrow\beta_{1}m^{t-1}+(1-\beta_{1})g^{t}</annotation></semantics></math>

</div>
<div id="alg3.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <math id="alg3.l2.m1.1" class="ltx_Math" alttext="\hat{m}^{t}\leftarrow\frac{m^{t}}{1-\beta_{1}^{t}}" display="inline"><semantics id="alg3.l2.m1.1a"><mrow id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml"><msup id="alg3.l2.m1.1.1.2" xref="alg3.l2.m1.1.1.2.cmml"><mover accent="true" id="alg3.l2.m1.1.1.2.2" xref="alg3.l2.m1.1.1.2.2.cmml"><mi id="alg3.l2.m1.1.1.2.2.2" xref="alg3.l2.m1.1.1.2.2.2.cmml">m</mi><mo id="alg3.l2.m1.1.1.2.2.1" xref="alg3.l2.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="alg3.l2.m1.1.1.2.3" xref="alg3.l2.m1.1.1.2.3.cmml">t</mi></msup><mo stretchy="false" id="alg3.l2.m1.1.1.1" xref="alg3.l2.m1.1.1.1.cmml">←</mo><mfrac id="alg3.l2.m1.1.1.3" xref="alg3.l2.m1.1.1.3.cmml"><msup id="alg3.l2.m1.1.1.3.2" xref="alg3.l2.m1.1.1.3.2.cmml"><mi id="alg3.l2.m1.1.1.3.2.2" xref="alg3.l2.m1.1.1.3.2.2.cmml">m</mi><mi id="alg3.l2.m1.1.1.3.2.3" xref="alg3.l2.m1.1.1.3.2.3.cmml">t</mi></msup><mrow id="alg3.l2.m1.1.1.3.3" xref="alg3.l2.m1.1.1.3.3.cmml"><mn id="alg3.l2.m1.1.1.3.3.2" xref="alg3.l2.m1.1.1.3.3.2.cmml">1</mn><mo id="alg3.l2.m1.1.1.3.3.1" xref="alg3.l2.m1.1.1.3.3.1.cmml">−</mo><msubsup id="alg3.l2.m1.1.1.3.3.3" xref="alg3.l2.m1.1.1.3.3.3.cmml"><mi id="alg3.l2.m1.1.1.3.3.3.2.2" xref="alg3.l2.m1.1.1.3.3.3.2.2.cmml">β</mi><mn id="alg3.l2.m1.1.1.3.3.3.2.3" xref="alg3.l2.m1.1.1.3.3.3.2.3.cmml">1</mn><mi id="alg3.l2.m1.1.1.3.3.3.3" xref="alg3.l2.m1.1.1.3.3.3.3.cmml">t</mi></msubsup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><apply id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1"><ci id="alg3.l2.m1.1.1.1.cmml" xref="alg3.l2.m1.1.1.1">←</ci><apply id="alg3.l2.m1.1.1.2.cmml" xref="alg3.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.2.1.cmml" xref="alg3.l2.m1.1.1.2">superscript</csymbol><apply id="alg3.l2.m1.1.1.2.2.cmml" xref="alg3.l2.m1.1.1.2.2"><ci id="alg3.l2.m1.1.1.2.2.1.cmml" xref="alg3.l2.m1.1.1.2.2.1">^</ci><ci id="alg3.l2.m1.1.1.2.2.2.cmml" xref="alg3.l2.m1.1.1.2.2.2">𝑚</ci></apply><ci id="alg3.l2.m1.1.1.2.3.cmml" xref="alg3.l2.m1.1.1.2.3">𝑡</ci></apply><apply id="alg3.l2.m1.1.1.3.cmml" xref="alg3.l2.m1.1.1.3"><divide id="alg3.l2.m1.1.1.3.1.cmml" xref="alg3.l2.m1.1.1.3"></divide><apply id="alg3.l2.m1.1.1.3.2.cmml" xref="alg3.l2.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.3.2.1.cmml" xref="alg3.l2.m1.1.1.3.2">superscript</csymbol><ci id="alg3.l2.m1.1.1.3.2.2.cmml" xref="alg3.l2.m1.1.1.3.2.2">𝑚</ci><ci id="alg3.l2.m1.1.1.3.2.3.cmml" xref="alg3.l2.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg3.l2.m1.1.1.3.3.cmml" xref="alg3.l2.m1.1.1.3.3"><minus id="alg3.l2.m1.1.1.3.3.1.cmml" xref="alg3.l2.m1.1.1.3.3.1"></minus><cn type="integer" id="alg3.l2.m1.1.1.3.3.2.cmml" xref="alg3.l2.m1.1.1.3.3.2">1</cn><apply id="alg3.l2.m1.1.1.3.3.3.cmml" xref="alg3.l2.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.3.3.3.1.cmml" xref="alg3.l2.m1.1.1.3.3.3">superscript</csymbol><apply id="alg3.l2.m1.1.1.3.3.3.2.cmml" xref="alg3.l2.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg3.l2.m1.1.1.3.3.3.2.1.cmml" xref="alg3.l2.m1.1.1.3.3.3">subscript</csymbol><ci id="alg3.l2.m1.1.1.3.3.3.2.2.cmml" xref="alg3.l2.m1.1.1.3.3.3.2.2">𝛽</ci><cn type="integer" id="alg3.l2.m1.1.1.3.3.3.2.3.cmml" xref="alg3.l2.m1.1.1.3.3.3.2.3">1</cn></apply><ci id="alg3.l2.m1.1.1.3.3.3.3.cmml" xref="alg3.l2.m1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">\hat{m}^{t}\leftarrow\frac{m^{t}}{1-\beta_{1}^{t}}</annotation></semantics></math>

</div>
<div id="alg3.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <math id="alg3.l3.m1.2" class="ltx_Math" alttext="v^{t}\leftarrow\beta_{2}v^{t-1}+(1-\beta_{2})(g^{t})^{2}" display="inline"><semantics id="alg3.l3.m1.2a"><mrow id="alg3.l3.m1.2.2" xref="alg3.l3.m1.2.2.cmml"><msup id="alg3.l3.m1.2.2.4" xref="alg3.l3.m1.2.2.4.cmml"><mi id="alg3.l3.m1.2.2.4.2" xref="alg3.l3.m1.2.2.4.2.cmml">v</mi><mi id="alg3.l3.m1.2.2.4.3" xref="alg3.l3.m1.2.2.4.3.cmml">t</mi></msup><mo stretchy="false" id="alg3.l3.m1.2.2.3" xref="alg3.l3.m1.2.2.3.cmml">←</mo><mrow id="alg3.l3.m1.2.2.2" xref="alg3.l3.m1.2.2.2.cmml"><mrow id="alg3.l3.m1.2.2.2.4" xref="alg3.l3.m1.2.2.2.4.cmml"><msub id="alg3.l3.m1.2.2.2.4.2" xref="alg3.l3.m1.2.2.2.4.2.cmml"><mi id="alg3.l3.m1.2.2.2.4.2.2" xref="alg3.l3.m1.2.2.2.4.2.2.cmml">β</mi><mn id="alg3.l3.m1.2.2.2.4.2.3" xref="alg3.l3.m1.2.2.2.4.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="alg3.l3.m1.2.2.2.4.1" xref="alg3.l3.m1.2.2.2.4.1.cmml">​</mo><msup id="alg3.l3.m1.2.2.2.4.3" xref="alg3.l3.m1.2.2.2.4.3.cmml"><mi id="alg3.l3.m1.2.2.2.4.3.2" xref="alg3.l3.m1.2.2.2.4.3.2.cmml">v</mi><mrow id="alg3.l3.m1.2.2.2.4.3.3" xref="alg3.l3.m1.2.2.2.4.3.3.cmml"><mi id="alg3.l3.m1.2.2.2.4.3.3.2" xref="alg3.l3.m1.2.2.2.4.3.3.2.cmml">t</mi><mo id="alg3.l3.m1.2.2.2.4.3.3.1" xref="alg3.l3.m1.2.2.2.4.3.3.1.cmml">−</mo><mn id="alg3.l3.m1.2.2.2.4.3.3.3" xref="alg3.l3.m1.2.2.2.4.3.3.3.cmml">1</mn></mrow></msup></mrow><mo id="alg3.l3.m1.2.2.2.3" xref="alg3.l3.m1.2.2.2.3.cmml">+</mo><mrow id="alg3.l3.m1.2.2.2.2" xref="alg3.l3.m1.2.2.2.2.cmml"><mrow id="alg3.l3.m1.1.1.1.1.1.1" xref="alg3.l3.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l3.m1.1.1.1.1.1.1.2" xref="alg3.l3.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l3.m1.1.1.1.1.1.1.1" xref="alg3.l3.m1.1.1.1.1.1.1.1.cmml"><mn id="alg3.l3.m1.1.1.1.1.1.1.1.2" xref="alg3.l3.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg3.l3.m1.1.1.1.1.1.1.1.1" xref="alg3.l3.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg3.l3.m1.1.1.1.1.1.1.1.3" xref="alg3.l3.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg3.l3.m1.1.1.1.1.1.1.1.3.2" xref="alg3.l3.m1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mn id="alg3.l3.m1.1.1.1.1.1.1.1.3.3" xref="alg3.l3.m1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="alg3.l3.m1.1.1.1.1.1.1.3" xref="alg3.l3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg3.l3.m1.2.2.2.2.3" xref="alg3.l3.m1.2.2.2.2.3.cmml">​</mo><msup id="alg3.l3.m1.2.2.2.2.2" xref="alg3.l3.m1.2.2.2.2.2.cmml"><mrow id="alg3.l3.m1.2.2.2.2.2.1.1" xref="alg3.l3.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="alg3.l3.m1.2.2.2.2.2.1.1.2" xref="alg3.l3.m1.2.2.2.2.2.1.1.1.cmml">(</mo><msup id="alg3.l3.m1.2.2.2.2.2.1.1.1" xref="alg3.l3.m1.2.2.2.2.2.1.1.1.cmml"><mi id="alg3.l3.m1.2.2.2.2.2.1.1.1.2" xref="alg3.l3.m1.2.2.2.2.2.1.1.1.2.cmml">g</mi><mi id="alg3.l3.m1.2.2.2.2.2.1.1.1.3" xref="alg3.l3.m1.2.2.2.2.2.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="alg3.l3.m1.2.2.2.2.2.1.1.3" xref="alg3.l3.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mn id="alg3.l3.m1.2.2.2.2.2.3" xref="alg3.l3.m1.2.2.2.2.2.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.2b"><apply id="alg3.l3.m1.2.2.cmml" xref="alg3.l3.m1.2.2"><ci id="alg3.l3.m1.2.2.3.cmml" xref="alg3.l3.m1.2.2.3">←</ci><apply id="alg3.l3.m1.2.2.4.cmml" xref="alg3.l3.m1.2.2.4"><csymbol cd="ambiguous" id="alg3.l3.m1.2.2.4.1.cmml" xref="alg3.l3.m1.2.2.4">superscript</csymbol><ci id="alg3.l3.m1.2.2.4.2.cmml" xref="alg3.l3.m1.2.2.4.2">𝑣</ci><ci id="alg3.l3.m1.2.2.4.3.cmml" xref="alg3.l3.m1.2.2.4.3">𝑡</ci></apply><apply id="alg3.l3.m1.2.2.2.cmml" xref="alg3.l3.m1.2.2.2"><plus id="alg3.l3.m1.2.2.2.3.cmml" xref="alg3.l3.m1.2.2.2.3"></plus><apply id="alg3.l3.m1.2.2.2.4.cmml" xref="alg3.l3.m1.2.2.2.4"><times id="alg3.l3.m1.2.2.2.4.1.cmml" xref="alg3.l3.m1.2.2.2.4.1"></times><apply id="alg3.l3.m1.2.2.2.4.2.cmml" xref="alg3.l3.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="alg3.l3.m1.2.2.2.4.2.1.cmml" xref="alg3.l3.m1.2.2.2.4.2">subscript</csymbol><ci id="alg3.l3.m1.2.2.2.4.2.2.cmml" xref="alg3.l3.m1.2.2.2.4.2.2">𝛽</ci><cn type="integer" id="alg3.l3.m1.2.2.2.4.2.3.cmml" xref="alg3.l3.m1.2.2.2.4.2.3">2</cn></apply><apply id="alg3.l3.m1.2.2.2.4.3.cmml" xref="alg3.l3.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="alg3.l3.m1.2.2.2.4.3.1.cmml" xref="alg3.l3.m1.2.2.2.4.3">superscript</csymbol><ci id="alg3.l3.m1.2.2.2.4.3.2.cmml" xref="alg3.l3.m1.2.2.2.4.3.2">𝑣</ci><apply id="alg3.l3.m1.2.2.2.4.3.3.cmml" xref="alg3.l3.m1.2.2.2.4.3.3"><minus id="alg3.l3.m1.2.2.2.4.3.3.1.cmml" xref="alg3.l3.m1.2.2.2.4.3.3.1"></minus><ci id="alg3.l3.m1.2.2.2.4.3.3.2.cmml" xref="alg3.l3.m1.2.2.2.4.3.3.2">𝑡</ci><cn type="integer" id="alg3.l3.m1.2.2.2.4.3.3.3.cmml" xref="alg3.l3.m1.2.2.2.4.3.3.3">1</cn></apply></apply></apply><apply id="alg3.l3.m1.2.2.2.2.cmml" xref="alg3.l3.m1.2.2.2.2"><times id="alg3.l3.m1.2.2.2.2.3.cmml" xref="alg3.l3.m1.2.2.2.2.3"></times><apply id="alg3.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg3.l3.m1.1.1.1.1.1.1"><minus id="alg3.l3.m1.1.1.1.1.1.1.1.1.cmml" xref="alg3.l3.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg3.l3.m1.1.1.1.1.1.1.1.2.cmml" xref="alg3.l3.m1.1.1.1.1.1.1.1.2">1</cn><apply id="alg3.l3.m1.1.1.1.1.1.1.1.3.cmml" xref="alg3.l3.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg3.l3.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg3.l3.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg3.l3.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg3.l3.m1.1.1.1.1.1.1.1.3.2">𝛽</ci><cn type="integer" id="alg3.l3.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg3.l3.m1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="alg3.l3.m1.2.2.2.2.2.cmml" xref="alg3.l3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l3.m1.2.2.2.2.2.2.cmml" xref="alg3.l3.m1.2.2.2.2.2">superscript</csymbol><apply id="alg3.l3.m1.2.2.2.2.2.1.1.1.cmml" xref="alg3.l3.m1.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg3.l3.m1.2.2.2.2.2.1.1.1.1.cmml" xref="alg3.l3.m1.2.2.2.2.2.1.1">superscript</csymbol><ci id="alg3.l3.m1.2.2.2.2.2.1.1.1.2.cmml" xref="alg3.l3.m1.2.2.2.2.2.1.1.1.2">𝑔</ci><ci id="alg3.l3.m1.2.2.2.2.2.1.1.1.3.cmml" xref="alg3.l3.m1.2.2.2.2.2.1.1.1.3">𝑡</ci></apply><cn type="integer" id="alg3.l3.m1.2.2.2.2.2.3.cmml" xref="alg3.l3.m1.2.2.2.2.2.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.2c">v^{t}\leftarrow\beta_{2}v^{t-1}+(1-\beta_{2})(g^{t})^{2}</annotation></semantics></math>

</div>
<div id="alg3.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <math id="alg3.l4.m1.1" class="ltx_Math" alttext="\hat{v}^{t}\leftarrow\frac{v^{t}}{1-\beta_{2}^{t}}" display="inline"><semantics id="alg3.l4.m1.1a"><mrow id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml"><msup id="alg3.l4.m1.1.1.2" xref="alg3.l4.m1.1.1.2.cmml"><mover accent="true" id="alg3.l4.m1.1.1.2.2" xref="alg3.l4.m1.1.1.2.2.cmml"><mi id="alg3.l4.m1.1.1.2.2.2" xref="alg3.l4.m1.1.1.2.2.2.cmml">v</mi><mo id="alg3.l4.m1.1.1.2.2.1" xref="alg3.l4.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="alg3.l4.m1.1.1.2.3" xref="alg3.l4.m1.1.1.2.3.cmml">t</mi></msup><mo stretchy="false" id="alg3.l4.m1.1.1.1" xref="alg3.l4.m1.1.1.1.cmml">←</mo><mfrac id="alg3.l4.m1.1.1.3" xref="alg3.l4.m1.1.1.3.cmml"><msup id="alg3.l4.m1.1.1.3.2" xref="alg3.l4.m1.1.1.3.2.cmml"><mi id="alg3.l4.m1.1.1.3.2.2" xref="alg3.l4.m1.1.1.3.2.2.cmml">v</mi><mi id="alg3.l4.m1.1.1.3.2.3" xref="alg3.l4.m1.1.1.3.2.3.cmml">t</mi></msup><mrow id="alg3.l4.m1.1.1.3.3" xref="alg3.l4.m1.1.1.3.3.cmml"><mn id="alg3.l4.m1.1.1.3.3.2" xref="alg3.l4.m1.1.1.3.3.2.cmml">1</mn><mo id="alg3.l4.m1.1.1.3.3.1" xref="alg3.l4.m1.1.1.3.3.1.cmml">−</mo><msubsup id="alg3.l4.m1.1.1.3.3.3" xref="alg3.l4.m1.1.1.3.3.3.cmml"><mi id="alg3.l4.m1.1.1.3.3.3.2.2" xref="alg3.l4.m1.1.1.3.3.3.2.2.cmml">β</mi><mn id="alg3.l4.m1.1.1.3.3.3.2.3" xref="alg3.l4.m1.1.1.3.3.3.2.3.cmml">2</mn><mi id="alg3.l4.m1.1.1.3.3.3.3" xref="alg3.l4.m1.1.1.3.3.3.3.cmml">t</mi></msubsup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><apply id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1"><ci id="alg3.l4.m1.1.1.1.cmml" xref="alg3.l4.m1.1.1.1">←</ci><apply id="alg3.l4.m1.1.1.2.cmml" xref="alg3.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.2.1.cmml" xref="alg3.l4.m1.1.1.2">superscript</csymbol><apply id="alg3.l4.m1.1.1.2.2.cmml" xref="alg3.l4.m1.1.1.2.2"><ci id="alg3.l4.m1.1.1.2.2.1.cmml" xref="alg3.l4.m1.1.1.2.2.1">^</ci><ci id="alg3.l4.m1.1.1.2.2.2.cmml" xref="alg3.l4.m1.1.1.2.2.2">𝑣</ci></apply><ci id="alg3.l4.m1.1.1.2.3.cmml" xref="alg3.l4.m1.1.1.2.3">𝑡</ci></apply><apply id="alg3.l4.m1.1.1.3.cmml" xref="alg3.l4.m1.1.1.3"><divide id="alg3.l4.m1.1.1.3.1.cmml" xref="alg3.l4.m1.1.1.3"></divide><apply id="alg3.l4.m1.1.1.3.2.cmml" xref="alg3.l4.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.2.1.cmml" xref="alg3.l4.m1.1.1.3.2">superscript</csymbol><ci id="alg3.l4.m1.1.1.3.2.2.cmml" xref="alg3.l4.m1.1.1.3.2.2">𝑣</ci><ci id="alg3.l4.m1.1.1.3.2.3.cmml" xref="alg3.l4.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg3.l4.m1.1.1.3.3.cmml" xref="alg3.l4.m1.1.1.3.3"><minus id="alg3.l4.m1.1.1.3.3.1.cmml" xref="alg3.l4.m1.1.1.3.3.1"></minus><cn type="integer" id="alg3.l4.m1.1.1.3.3.2.cmml" xref="alg3.l4.m1.1.1.3.3.2">1</cn><apply id="alg3.l4.m1.1.1.3.3.3.cmml" xref="alg3.l4.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.3.3.1.cmml" xref="alg3.l4.m1.1.1.3.3.3">superscript</csymbol><apply id="alg3.l4.m1.1.1.3.3.3.2.cmml" xref="alg3.l4.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg3.l4.m1.1.1.3.3.3.2.1.cmml" xref="alg3.l4.m1.1.1.3.3.3">subscript</csymbol><ci id="alg3.l4.m1.1.1.3.3.3.2.2.cmml" xref="alg3.l4.m1.1.1.3.3.3.2.2">𝛽</ci><cn type="integer" id="alg3.l4.m1.1.1.3.3.3.2.3.cmml" xref="alg3.l4.m1.1.1.3.3.3.2.3">2</cn></apply><ci id="alg3.l4.m1.1.1.3.3.3.3.cmml" xref="alg3.l4.m1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">\hat{v}^{t}\leftarrow\frac{v^{t}}{1-\beta_{2}^{t}}</annotation></semantics></math>

</div>
<div id="alg3.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>  <math id="alg3.l5.m1.1" class="ltx_Math" alttext="w^{t}\leftarrow w^{t-1}-\alpha\frac{\hat{m}^{t}}{(\sqrt{\hat{v}^{t}}+\epsilon)}" display="inline"><semantics id="alg3.l5.m1.1a"><mrow id="alg3.l5.m1.1.2" xref="alg3.l5.m1.1.2.cmml"><msup id="alg3.l5.m1.1.2.2" xref="alg3.l5.m1.1.2.2.cmml"><mi id="alg3.l5.m1.1.2.2.2" xref="alg3.l5.m1.1.2.2.2.cmml">w</mi><mi id="alg3.l5.m1.1.2.2.3" xref="alg3.l5.m1.1.2.2.3.cmml">t</mi></msup><mo stretchy="false" id="alg3.l5.m1.1.2.1" xref="alg3.l5.m1.1.2.1.cmml">←</mo><mrow id="alg3.l5.m1.1.2.3" xref="alg3.l5.m1.1.2.3.cmml"><msup id="alg3.l5.m1.1.2.3.2" xref="alg3.l5.m1.1.2.3.2.cmml"><mi id="alg3.l5.m1.1.2.3.2.2" xref="alg3.l5.m1.1.2.3.2.2.cmml">w</mi><mrow id="alg3.l5.m1.1.2.3.2.3" xref="alg3.l5.m1.1.2.3.2.3.cmml"><mi id="alg3.l5.m1.1.2.3.2.3.2" xref="alg3.l5.m1.1.2.3.2.3.2.cmml">t</mi><mo id="alg3.l5.m1.1.2.3.2.3.1" xref="alg3.l5.m1.1.2.3.2.3.1.cmml">−</mo><mn id="alg3.l5.m1.1.2.3.2.3.3" xref="alg3.l5.m1.1.2.3.2.3.3.cmml">1</mn></mrow></msup><mo id="alg3.l5.m1.1.2.3.1" xref="alg3.l5.m1.1.2.3.1.cmml">−</mo><mrow id="alg3.l5.m1.1.2.3.3" xref="alg3.l5.m1.1.2.3.3.cmml"><mi id="alg3.l5.m1.1.2.3.3.2" xref="alg3.l5.m1.1.2.3.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="alg3.l5.m1.1.2.3.3.1" xref="alg3.l5.m1.1.2.3.3.1.cmml">​</mo><mfrac id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml"><msup id="alg3.l5.m1.1.1.3" xref="alg3.l5.m1.1.1.3.cmml"><mover accent="true" id="alg3.l5.m1.1.1.3.2" xref="alg3.l5.m1.1.1.3.2.cmml"><mi id="alg3.l5.m1.1.1.3.2.2" xref="alg3.l5.m1.1.1.3.2.2.cmml">m</mi><mo id="alg3.l5.m1.1.1.3.2.1" xref="alg3.l5.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="alg3.l5.m1.1.1.3.3" xref="alg3.l5.m1.1.1.3.3.cmml">t</mi></msup><mrow id="alg3.l5.m1.1.1.1.1" xref="alg3.l5.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg3.l5.m1.1.1.1.1.2" xref="alg3.l5.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg3.l5.m1.1.1.1.1.1" xref="alg3.l5.m1.1.1.1.1.1.cmml"><msqrt id="alg3.l5.m1.1.1.1.1.1.2" xref="alg3.l5.m1.1.1.1.1.1.2.cmml"><msup id="alg3.l5.m1.1.1.1.1.1.2.2" xref="alg3.l5.m1.1.1.1.1.1.2.2.cmml"><mover accent="true" id="alg3.l5.m1.1.1.1.1.1.2.2.2" xref="alg3.l5.m1.1.1.1.1.1.2.2.2.cmml"><mi id="alg3.l5.m1.1.1.1.1.1.2.2.2.2" xref="alg3.l5.m1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mo id="alg3.l5.m1.1.1.1.1.1.2.2.2.1" xref="alg3.l5.m1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="alg3.l5.m1.1.1.1.1.1.2.2.3" xref="alg3.l5.m1.1.1.1.1.1.2.2.3.cmml">t</mi></msup></msqrt><mo id="alg3.l5.m1.1.1.1.1.1.1" xref="alg3.l5.m1.1.1.1.1.1.1.cmml">+</mo><mi id="alg3.l5.m1.1.1.1.1.1.3" xref="alg3.l5.m1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo stretchy="false" id="alg3.l5.m1.1.1.1.1.3" xref="alg3.l5.m1.1.1.1.1.1.cmml">)</mo></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><apply id="alg3.l5.m1.1.2.cmml" xref="alg3.l5.m1.1.2"><ci id="alg3.l5.m1.1.2.1.cmml" xref="alg3.l5.m1.1.2.1">←</ci><apply id="alg3.l5.m1.1.2.2.cmml" xref="alg3.l5.m1.1.2.2"><csymbol cd="ambiguous" id="alg3.l5.m1.1.2.2.1.cmml" xref="alg3.l5.m1.1.2.2">superscript</csymbol><ci id="alg3.l5.m1.1.2.2.2.cmml" xref="alg3.l5.m1.1.2.2.2">𝑤</ci><ci id="alg3.l5.m1.1.2.2.3.cmml" xref="alg3.l5.m1.1.2.2.3">𝑡</ci></apply><apply id="alg3.l5.m1.1.2.3.cmml" xref="alg3.l5.m1.1.2.3"><minus id="alg3.l5.m1.1.2.3.1.cmml" xref="alg3.l5.m1.1.2.3.1"></minus><apply id="alg3.l5.m1.1.2.3.2.cmml" xref="alg3.l5.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg3.l5.m1.1.2.3.2.1.cmml" xref="alg3.l5.m1.1.2.3.2">superscript</csymbol><ci id="alg3.l5.m1.1.2.3.2.2.cmml" xref="alg3.l5.m1.1.2.3.2.2">𝑤</ci><apply id="alg3.l5.m1.1.2.3.2.3.cmml" xref="alg3.l5.m1.1.2.3.2.3"><minus id="alg3.l5.m1.1.2.3.2.3.1.cmml" xref="alg3.l5.m1.1.2.3.2.3.1"></minus><ci id="alg3.l5.m1.1.2.3.2.3.2.cmml" xref="alg3.l5.m1.1.2.3.2.3.2">𝑡</ci><cn type="integer" id="alg3.l5.m1.1.2.3.2.3.3.cmml" xref="alg3.l5.m1.1.2.3.2.3.3">1</cn></apply></apply><apply id="alg3.l5.m1.1.2.3.3.cmml" xref="alg3.l5.m1.1.2.3.3"><times id="alg3.l5.m1.1.2.3.3.1.cmml" xref="alg3.l5.m1.1.2.3.3.1"></times><ci id="alg3.l5.m1.1.2.3.3.2.cmml" xref="alg3.l5.m1.1.2.3.3.2">𝛼</ci><apply id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1"><divide id="alg3.l5.m1.1.1.2.cmml" xref="alg3.l5.m1.1.1"></divide><apply id="alg3.l5.m1.1.1.3.cmml" xref="alg3.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.3.1.cmml" xref="alg3.l5.m1.1.1.3">superscript</csymbol><apply id="alg3.l5.m1.1.1.3.2.cmml" xref="alg3.l5.m1.1.1.3.2"><ci id="alg3.l5.m1.1.1.3.2.1.cmml" xref="alg3.l5.m1.1.1.3.2.1">^</ci><ci id="alg3.l5.m1.1.1.3.2.2.cmml" xref="alg3.l5.m1.1.1.3.2.2">𝑚</ci></apply><ci id="alg3.l5.m1.1.1.3.3.cmml" xref="alg3.l5.m1.1.1.3.3">𝑡</ci></apply><apply id="alg3.l5.m1.1.1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1.1"><plus id="alg3.l5.m1.1.1.1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.1"></plus><apply id="alg3.l5.m1.1.1.1.1.1.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.2"><root id="alg3.l5.m1.1.1.1.1.1.2a.cmml" xref="alg3.l5.m1.1.1.1.1.1.2"></root><apply id="alg3.l5.m1.1.1.1.1.1.2.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.1.1.1.2.2.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.2.2">superscript</csymbol><apply id="alg3.l5.m1.1.1.1.1.1.2.2.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.2.2.2"><ci id="alg3.l5.m1.1.1.1.1.1.2.2.2.1.cmml" xref="alg3.l5.m1.1.1.1.1.1.2.2.2.1">^</ci><ci id="alg3.l5.m1.1.1.1.1.1.2.2.2.2.cmml" xref="alg3.l5.m1.1.1.1.1.1.2.2.2.2">𝑣</ci></apply><ci id="alg3.l5.m1.1.1.1.1.1.2.2.3.cmml" xref="alg3.l5.m1.1.1.1.1.1.2.2.3">𝑡</ci></apply></apply><ci id="alg3.l5.m1.1.1.1.1.1.3.cmml" xref="alg3.l5.m1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">w^{t}\leftarrow w^{t-1}-\alpha\frac{\hat{m}^{t}}{(\sqrt{\hat{v}^{t}}+\epsilon)}</annotation></semantics></math>

</div>
</div>
<br class="ltx_break ltx_break">
</figure>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Details for Experimental Setup</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">The number of global training epochs is set to 100 and that of local training epochs is set to 2. We utilize the Dirichlet distribution (with 1.0 as the concentration parameter alpha) to partition the data into non-IID splits and assign a certain number of samples to each device according to the Dirichlet distribution (with 5.0 as the concentration parameter alpha). We exploit development sets for the evaluation of tasks in the GLUE benchmark since test sets are not labeled. For 4 other datasets, we select a certain number of samples from the training set as the development set, and the number of samples for each label is determined according to its proportion in the original training set. For datasets in GLUE benchmark <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib76" title="" class="ltx_ref">2019</a>)</cite>, we use their original data splits. For 4 other datasets with no default splits, we randomly divide the dataset into train, development, and test sets. The dataset statistics after the split are shown in Table <a href="#A2.T13" title="Table 13 ‣ B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a></p>
</div>
<div id="A1.SS2.p2" class="ltx_para">
<p id="A1.SS2.p2.1" class="ltx_p">We set prompt lengths for each method according to the original works, i.e., 128 for FedPrompt and P-tuning v2, 5 for LPT and IDPG, 100 for ATTEMPT, and 20 for Prompt tuning.
FedPrompt, Prompt tuning, and ATTEMPT insert prompts before the transformer layers. P-tuning v2 inserts prompts to the hidden states for all transformer layers. IDPG combines these two heuristics and inserts prompts to either the input or the hidden states of all layers. LPT searches for the single best layer by training all the possible positions for each layer. Similar to P-tuning v2, FedPepTAO inserts the hidden states for all transformer layers while the prompt parameters of properly selected layers are communicated between devices and the server.
</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Extra Experiments</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Epochs Required to Achieve the Target Accuracy</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">We conducted experiments with the number of epochs required to achieve the target accuracy and the communication overhead to demonstrate the performance of FedPepTAO on the RoBERTa<sub id="A2.SS1.p1.1.1" class="ltx_sub">LARGE</sub> model and 10 tasks. Below are the average epochs required to achieve the target accuracy.</p>
</div>
<figure id="A2.T6" class="ltx_table">
<table id="A2.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T6.1.1.1" class="ltx_tr">
<th id="A2.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="A2.T6.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<td id="A2.T6.1.1.1.2" class="ltx_td ltx_align_left ltx_border_tt"><span id="A2.T6.1.1.1.2.1" class="ltx_text ltx_font_bold">Epochs</span></td>
</tr>
<tr id="A2.T6.1.2.2" class="ltx_tr">
<th id="A2.T6.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Adapter</th>
<td id="A2.T6.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t">30.92</td>
</tr>
<tr id="A2.T6.1.3.3" class="ltx_tr">
<th id="A2.T6.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedPrompt</th>
<td id="A2.T6.1.3.3.2" class="ltx_td ltx_align_left">24.50</td>
</tr>
<tr id="A2.T6.1.4.4" class="ltx_tr">
<th id="A2.T6.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">P-tuning v2</th>
<td id="A2.T6.1.4.4.2" class="ltx_td ltx_align_left">5.99</td>
</tr>
<tr id="A2.T6.1.5.5" class="ltx_tr">
<th id="A2.T6.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Prompt Tuning</th>
<td id="A2.T6.1.5.5.2" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="A2.T6.1.6.6" class="ltx_tr">
<th id="A2.T6.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">IDPG</th>
<td id="A2.T6.1.6.6.2" class="ltx_td ltx_align_left">40.15</td>
</tr>
<tr id="A2.T6.1.7.7" class="ltx_tr">
<th id="A2.T6.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ATTEMPT</th>
<td id="A2.T6.1.7.7.2" class="ltx_td ltx_align_left">39.97</td>
</tr>
<tr id="A2.T6.1.8.8" class="ltx_tr">
<th id="A2.T6.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LPT</th>
<td id="A2.T6.1.8.8.2" class="ltx_td ltx_align_left">8.31</td>
</tr>
<tr id="A2.T6.1.9.9" class="ltx_tr">
<th id="A2.T6.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MomD</th>
<td id="A2.T6.1.9.9.2" class="ltx_td ltx_align_left">13.98</td>
</tr>
<tr id="A2.T6.1.10.10" class="ltx_tr">
<th id="A2.T6.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MomS+AdamD</th>
<td id="A2.T6.1.10.10.2" class="ltx_td ltx_align_left">5.99</td>
</tr>
<tr id="A2.T6.1.11.11" class="ltx_tr">
<th id="A2.T6.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">
<span id="A2.T6.1.11.11.1.1" class="ltx_ERROR undefined">\hdashline</span>FedPepTAO</th>
<td id="A2.T6.1.11.11.2" class="ltx_td ltx_align_left ltx_border_bb">3.88</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>The average number of epochs required to achieve the target accuracy (85% for QNLI, 92.5% for SST-2, 3% for CoLA, 77% for MRPC, 65% for RTE, 71% for BoolQ, 85% for MPQA, 88% for Subj, 78% for Trec, 91% for MR) on RoBERTa<sub id="A2.T6.3.1" class="ltx_sub">LARGE</sub> model. "/" represents that training does not achieve the target accuracy.</figcaption>
</figure>
<div id="A2.SS1.p2" class="ltx_para">
<p id="A2.SS1.p2.1" class="ltx_p">From Table <a href="#A2.T6" title="Table 6 ‣ B.1 Epochs Required to Achieve the Target Accuracy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we find that FedPepTAO requires the smallest amount of epochs to achieve the target accuracy (87.45%, 84.16%, 35.26%, 90.33%, 90.29%, 53.31%, 72.22%, 35.21% faster compared to Adapter, FedPrompt, P-tuning v2, IDPG, ATTEMPT, LPT, MomD, and MomS+AdamD respectively). Prompt Tuning failed to achieve the target accuracy since it only optimizes the first layer of soft prompts. FedPepTAO can also reduce the communication overhead from 40% to 41.55% (41.55%, 40%, 40%, 40% compared with Adapter, P-tuning v2, MomD, and MomS+AdamD, respectively) between devices and the server, as illustrated in Table <a href="#A2.T7" title="Table 7 ‣ B.1 Epochs Required to Achieve the Target Accuracy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. FedPrompt, Prompt-Tuning, IDPG, ATTEMPT, and LPT correspond to lower communication overhead (up to 13%) since they only select one layer during tuning, which results in significantly inferior accuracy (from 17.02% to 60.8% lower) compared with FedPepTAO.</p>
</div>
<figure id="A2.T7" class="ltx_table">
<table id="A2.T7.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T7.1.1.1" class="ltx_tr">
<th id="A2.T7.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="A2.T7.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<td id="A2.T7.1.1.1.2" class="ltx_td ltx_align_left ltx_border_tt"><span id="A2.T7.1.1.1.2.1" class="ltx_text ltx_font_bold">Time</span></td>
</tr>
<tr id="A2.T7.1.2.2" class="ltx_tr">
<th id="A2.T7.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Adapter</th>
<td id="A2.T7.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t">5.80</td>
</tr>
<tr id="A2.T7.1.3.3" class="ltx_tr">
<th id="A2.T7.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedPrompt</th>
<td id="A2.T7.1.3.3.2" class="ltx_td ltx_align_left">3.09</td>
</tr>
<tr id="A2.T7.1.4.4" class="ltx_tr">
<th id="A2.T7.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">P-tuning v2</th>
<td id="A2.T7.1.4.4.2" class="ltx_td ltx_align_left">5.65</td>
</tr>
<tr id="A2.T7.1.5.5" class="ltx_tr">
<th id="A2.T7.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Prompt Tuning</th>
<td id="A2.T7.1.5.5.2" class="ltx_td ltx_align_left">3.00</td>
</tr>
<tr id="A2.T7.1.6.6" class="ltx_tr">
<th id="A2.T7.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">IDPG</th>
<td id="A2.T7.1.6.6.2" class="ltx_td ltx_align_left">3.09</td>
</tr>
<tr id="A2.T7.1.7.7" class="ltx_tr">
<th id="A2.T7.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ATTEMPT</th>
<td id="A2.T7.1.7.7.2" class="ltx_td ltx_align_left">3.16</td>
</tr>
<tr id="A2.T7.1.8.8" class="ltx_tr">
<th id="A2.T7.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LPT</th>
<td id="A2.T7.1.8.8.2" class="ltx_td ltx_align_left">3.09</td>
</tr>
<tr id="A2.T7.1.9.9" class="ltx_tr">
<th id="A2.T7.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MomD</th>
<td id="A2.T7.1.9.9.2" class="ltx_td ltx_align_left">5.65</td>
</tr>
<tr id="A2.T7.1.10.10" class="ltx_tr">
<th id="A2.T7.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MomS+AdamD</th>
<td id="A2.T7.1.10.10.2" class="ltx_td ltx_align_left">5.65</td>
</tr>
<tr id="A2.T7.1.11.11" class="ltx_tr">
<th id="A2.T7.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">
<span id="A2.T7.1.11.11.1.1" class="ltx_ERROR undefined">\hdashline</span>FedPepTAO</th>
<td id="A2.T7.1.11.11.2" class="ltx_td ltx_align_left ltx_border_bb">3.39</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>The communication overhead (s) between devices and the server with RoBERTa<sub id="A2.T7.3.1" class="ltx_sub">LARGE</sub> model.</figcaption>
</figure>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Impact of server learning rate</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.6" class="ltx_p">Due to the high sensitivity of the hyperparameters in NLP tasks, we investigate the impact of divers server learning rates on the RTE dataset. We analyze the accuracy with the learning rates <math id="A2.SS2.p1.1.m1.1" class="ltx_Math" alttext="1e^{-2}" display="inline"><semantics id="A2.SS2.p1.1.m1.1a"><mrow id="A2.SS2.p1.1.m1.1.1" xref="A2.SS2.p1.1.m1.1.1.cmml"><mn id="A2.SS2.p1.1.m1.1.1.2" xref="A2.SS2.p1.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A2.SS2.p1.1.m1.1.1.1" xref="A2.SS2.p1.1.m1.1.1.1.cmml">​</mo><msup id="A2.SS2.p1.1.m1.1.1.3" xref="A2.SS2.p1.1.m1.1.1.3.cmml"><mi id="A2.SS2.p1.1.m1.1.1.3.2" xref="A2.SS2.p1.1.m1.1.1.3.2.cmml">e</mi><mrow id="A2.SS2.p1.1.m1.1.1.3.3" xref="A2.SS2.p1.1.m1.1.1.3.3.cmml"><mo id="A2.SS2.p1.1.m1.1.1.3.3a" xref="A2.SS2.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="A2.SS2.p1.1.m1.1.1.3.3.2" xref="A2.SS2.p1.1.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.1.m1.1b"><apply id="A2.SS2.p1.1.m1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1"><times id="A2.SS2.p1.1.m1.1.1.1.cmml" xref="A2.SS2.p1.1.m1.1.1.1"></times><cn type="integer" id="A2.SS2.p1.1.m1.1.1.2.cmml" xref="A2.SS2.p1.1.m1.1.1.2">1</cn><apply id="A2.SS2.p1.1.m1.1.1.3.cmml" xref="A2.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.SS2.p1.1.m1.1.1.3.1.cmml" xref="A2.SS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="A2.SS2.p1.1.m1.1.1.3.2.cmml" xref="A2.SS2.p1.1.m1.1.1.3.2">𝑒</ci><apply id="A2.SS2.p1.1.m1.1.1.3.3.cmml" xref="A2.SS2.p1.1.m1.1.1.3.3"><minus id="A2.SS2.p1.1.m1.1.1.3.3.1.cmml" xref="A2.SS2.p1.1.m1.1.1.3.3"></minus><cn type="integer" id="A2.SS2.p1.1.m1.1.1.3.3.2.cmml" xref="A2.SS2.p1.1.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.1.m1.1c">1e^{-2}</annotation></semantics></math>, <math id="A2.SS2.p1.2.m2.1" class="ltx_Math" alttext="5e^{-3}" display="inline"><semantics id="A2.SS2.p1.2.m2.1a"><mrow id="A2.SS2.p1.2.m2.1.1" xref="A2.SS2.p1.2.m2.1.1.cmml"><mn id="A2.SS2.p1.2.m2.1.1.2" xref="A2.SS2.p1.2.m2.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A2.SS2.p1.2.m2.1.1.1" xref="A2.SS2.p1.2.m2.1.1.1.cmml">​</mo><msup id="A2.SS2.p1.2.m2.1.1.3" xref="A2.SS2.p1.2.m2.1.1.3.cmml"><mi id="A2.SS2.p1.2.m2.1.1.3.2" xref="A2.SS2.p1.2.m2.1.1.3.2.cmml">e</mi><mrow id="A2.SS2.p1.2.m2.1.1.3.3" xref="A2.SS2.p1.2.m2.1.1.3.3.cmml"><mo id="A2.SS2.p1.2.m2.1.1.3.3a" xref="A2.SS2.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="A2.SS2.p1.2.m2.1.1.3.3.2" xref="A2.SS2.p1.2.m2.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.2.m2.1b"><apply id="A2.SS2.p1.2.m2.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1"><times id="A2.SS2.p1.2.m2.1.1.1.cmml" xref="A2.SS2.p1.2.m2.1.1.1"></times><cn type="integer" id="A2.SS2.p1.2.m2.1.1.2.cmml" xref="A2.SS2.p1.2.m2.1.1.2">5</cn><apply id="A2.SS2.p1.2.m2.1.1.3.cmml" xref="A2.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A2.SS2.p1.2.m2.1.1.3.1.cmml" xref="A2.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="A2.SS2.p1.2.m2.1.1.3.2.cmml" xref="A2.SS2.p1.2.m2.1.1.3.2">𝑒</ci><apply id="A2.SS2.p1.2.m2.1.1.3.3.cmml" xref="A2.SS2.p1.2.m2.1.1.3.3"><minus id="A2.SS2.p1.2.m2.1.1.3.3.1.cmml" xref="A2.SS2.p1.2.m2.1.1.3.3"></minus><cn type="integer" id="A2.SS2.p1.2.m2.1.1.3.3.2.cmml" xref="A2.SS2.p1.2.m2.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.2.m2.1c">5e^{-3}</annotation></semantics></math>, <math id="A2.SS2.p1.3.m3.1" class="ltx_Math" alttext="1e^{-3}" display="inline"><semantics id="A2.SS2.p1.3.m3.1a"><mrow id="A2.SS2.p1.3.m3.1.1" xref="A2.SS2.p1.3.m3.1.1.cmml"><mn id="A2.SS2.p1.3.m3.1.1.2" xref="A2.SS2.p1.3.m3.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A2.SS2.p1.3.m3.1.1.1" xref="A2.SS2.p1.3.m3.1.1.1.cmml">​</mo><msup id="A2.SS2.p1.3.m3.1.1.3" xref="A2.SS2.p1.3.m3.1.1.3.cmml"><mi id="A2.SS2.p1.3.m3.1.1.3.2" xref="A2.SS2.p1.3.m3.1.1.3.2.cmml">e</mi><mrow id="A2.SS2.p1.3.m3.1.1.3.3" xref="A2.SS2.p1.3.m3.1.1.3.3.cmml"><mo id="A2.SS2.p1.3.m3.1.1.3.3a" xref="A2.SS2.p1.3.m3.1.1.3.3.cmml">−</mo><mn id="A2.SS2.p1.3.m3.1.1.3.3.2" xref="A2.SS2.p1.3.m3.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.3.m3.1b"><apply id="A2.SS2.p1.3.m3.1.1.cmml" xref="A2.SS2.p1.3.m3.1.1"><times id="A2.SS2.p1.3.m3.1.1.1.cmml" xref="A2.SS2.p1.3.m3.1.1.1"></times><cn type="integer" id="A2.SS2.p1.3.m3.1.1.2.cmml" xref="A2.SS2.p1.3.m3.1.1.2">1</cn><apply id="A2.SS2.p1.3.m3.1.1.3.cmml" xref="A2.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="A2.SS2.p1.3.m3.1.1.3.1.cmml" xref="A2.SS2.p1.3.m3.1.1.3">superscript</csymbol><ci id="A2.SS2.p1.3.m3.1.1.3.2.cmml" xref="A2.SS2.p1.3.m3.1.1.3.2">𝑒</ci><apply id="A2.SS2.p1.3.m3.1.1.3.3.cmml" xref="A2.SS2.p1.3.m3.1.1.3.3"><minus id="A2.SS2.p1.3.m3.1.1.3.3.1.cmml" xref="A2.SS2.p1.3.m3.1.1.3.3"></minus><cn type="integer" id="A2.SS2.p1.3.m3.1.1.3.3.2.cmml" xref="A2.SS2.p1.3.m3.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.3.m3.1c">1e^{-3}</annotation></semantics></math>, <math id="A2.SS2.p1.4.m4.1" class="ltx_Math" alttext="5e^{-4}" display="inline"><semantics id="A2.SS2.p1.4.m4.1a"><mrow id="A2.SS2.p1.4.m4.1.1" xref="A2.SS2.p1.4.m4.1.1.cmml"><mn id="A2.SS2.p1.4.m4.1.1.2" xref="A2.SS2.p1.4.m4.1.1.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A2.SS2.p1.4.m4.1.1.1" xref="A2.SS2.p1.4.m4.1.1.1.cmml">​</mo><msup id="A2.SS2.p1.4.m4.1.1.3" xref="A2.SS2.p1.4.m4.1.1.3.cmml"><mi id="A2.SS2.p1.4.m4.1.1.3.2" xref="A2.SS2.p1.4.m4.1.1.3.2.cmml">e</mi><mrow id="A2.SS2.p1.4.m4.1.1.3.3" xref="A2.SS2.p1.4.m4.1.1.3.3.cmml"><mo id="A2.SS2.p1.4.m4.1.1.3.3a" xref="A2.SS2.p1.4.m4.1.1.3.3.cmml">−</mo><mn id="A2.SS2.p1.4.m4.1.1.3.3.2" xref="A2.SS2.p1.4.m4.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.4.m4.1b"><apply id="A2.SS2.p1.4.m4.1.1.cmml" xref="A2.SS2.p1.4.m4.1.1"><times id="A2.SS2.p1.4.m4.1.1.1.cmml" xref="A2.SS2.p1.4.m4.1.1.1"></times><cn type="integer" id="A2.SS2.p1.4.m4.1.1.2.cmml" xref="A2.SS2.p1.4.m4.1.1.2">5</cn><apply id="A2.SS2.p1.4.m4.1.1.3.cmml" xref="A2.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="A2.SS2.p1.4.m4.1.1.3.1.cmml" xref="A2.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="A2.SS2.p1.4.m4.1.1.3.2.cmml" xref="A2.SS2.p1.4.m4.1.1.3.2">𝑒</ci><apply id="A2.SS2.p1.4.m4.1.1.3.3.cmml" xref="A2.SS2.p1.4.m4.1.1.3.3"><minus id="A2.SS2.p1.4.m4.1.1.3.3.1.cmml" xref="A2.SS2.p1.4.m4.1.1.3.3"></minus><cn type="integer" id="A2.SS2.p1.4.m4.1.1.3.3.2.cmml" xref="A2.SS2.p1.4.m4.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.4.m4.1c">5e^{-4}</annotation></semantics></math>. As shown in Figure <a href="#A2.F2" title="Figure 2 ‣ B.2 Impact of server learning rate ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we find that the best performance was achieved when <math id="A2.SS2.p1.5.m5.1" class="ltx_Math" alttext="lr=1e^{-3}" display="inline"><semantics id="A2.SS2.p1.5.m5.1a"><mrow id="A2.SS2.p1.5.m5.1.1" xref="A2.SS2.p1.5.m5.1.1.cmml"><mrow id="A2.SS2.p1.5.m5.1.1.2" xref="A2.SS2.p1.5.m5.1.1.2.cmml"><mi id="A2.SS2.p1.5.m5.1.1.2.2" xref="A2.SS2.p1.5.m5.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.SS2.p1.5.m5.1.1.2.1" xref="A2.SS2.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="A2.SS2.p1.5.m5.1.1.2.3" xref="A2.SS2.p1.5.m5.1.1.2.3.cmml">r</mi></mrow><mo id="A2.SS2.p1.5.m5.1.1.1" xref="A2.SS2.p1.5.m5.1.1.1.cmml">=</mo><mrow id="A2.SS2.p1.5.m5.1.1.3" xref="A2.SS2.p1.5.m5.1.1.3.cmml"><mn id="A2.SS2.p1.5.m5.1.1.3.2" xref="A2.SS2.p1.5.m5.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A2.SS2.p1.5.m5.1.1.3.1" xref="A2.SS2.p1.5.m5.1.1.3.1.cmml">​</mo><msup id="A2.SS2.p1.5.m5.1.1.3.3" xref="A2.SS2.p1.5.m5.1.1.3.3.cmml"><mi id="A2.SS2.p1.5.m5.1.1.3.3.2" xref="A2.SS2.p1.5.m5.1.1.3.3.2.cmml">e</mi><mrow id="A2.SS2.p1.5.m5.1.1.3.3.3" xref="A2.SS2.p1.5.m5.1.1.3.3.3.cmml"><mo id="A2.SS2.p1.5.m5.1.1.3.3.3a" xref="A2.SS2.p1.5.m5.1.1.3.3.3.cmml">−</mo><mn id="A2.SS2.p1.5.m5.1.1.3.3.3.2" xref="A2.SS2.p1.5.m5.1.1.3.3.3.2.cmml">3</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.5.m5.1b"><apply id="A2.SS2.p1.5.m5.1.1.cmml" xref="A2.SS2.p1.5.m5.1.1"><eq id="A2.SS2.p1.5.m5.1.1.1.cmml" xref="A2.SS2.p1.5.m5.1.1.1"></eq><apply id="A2.SS2.p1.5.m5.1.1.2.cmml" xref="A2.SS2.p1.5.m5.1.1.2"><times id="A2.SS2.p1.5.m5.1.1.2.1.cmml" xref="A2.SS2.p1.5.m5.1.1.2.1"></times><ci id="A2.SS2.p1.5.m5.1.1.2.2.cmml" xref="A2.SS2.p1.5.m5.1.1.2.2">𝑙</ci><ci id="A2.SS2.p1.5.m5.1.1.2.3.cmml" xref="A2.SS2.p1.5.m5.1.1.2.3">𝑟</ci></apply><apply id="A2.SS2.p1.5.m5.1.1.3.cmml" xref="A2.SS2.p1.5.m5.1.1.3"><times id="A2.SS2.p1.5.m5.1.1.3.1.cmml" xref="A2.SS2.p1.5.m5.1.1.3.1"></times><cn type="integer" id="A2.SS2.p1.5.m5.1.1.3.2.cmml" xref="A2.SS2.p1.5.m5.1.1.3.2">1</cn><apply id="A2.SS2.p1.5.m5.1.1.3.3.cmml" xref="A2.SS2.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="A2.SS2.p1.5.m5.1.1.3.3.1.cmml" xref="A2.SS2.p1.5.m5.1.1.3.3">superscript</csymbol><ci id="A2.SS2.p1.5.m5.1.1.3.3.2.cmml" xref="A2.SS2.p1.5.m5.1.1.3.3.2">𝑒</ci><apply id="A2.SS2.p1.5.m5.1.1.3.3.3.cmml" xref="A2.SS2.p1.5.m5.1.1.3.3.3"><minus id="A2.SS2.p1.5.m5.1.1.3.3.3.1.cmml" xref="A2.SS2.p1.5.m5.1.1.3.3.3"></minus><cn type="integer" id="A2.SS2.p1.5.m5.1.1.3.3.3.2.cmml" xref="A2.SS2.p1.5.m5.1.1.3.3.3.2">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.5.m5.1c">lr=1e^{-3}</annotation></semantics></math>, which only slightly outperforms <math id="A2.SS2.p1.6.m6.1" class="ltx_Math" alttext="lr=5e^{-4}" display="inline"><semantics id="A2.SS2.p1.6.m6.1a"><mrow id="A2.SS2.p1.6.m6.1.1" xref="A2.SS2.p1.6.m6.1.1.cmml"><mrow id="A2.SS2.p1.6.m6.1.1.2" xref="A2.SS2.p1.6.m6.1.1.2.cmml"><mi id="A2.SS2.p1.6.m6.1.1.2.2" xref="A2.SS2.p1.6.m6.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="A2.SS2.p1.6.m6.1.1.2.1" xref="A2.SS2.p1.6.m6.1.1.2.1.cmml">​</mo><mi id="A2.SS2.p1.6.m6.1.1.2.3" xref="A2.SS2.p1.6.m6.1.1.2.3.cmml">r</mi></mrow><mo id="A2.SS2.p1.6.m6.1.1.1" xref="A2.SS2.p1.6.m6.1.1.1.cmml">=</mo><mrow id="A2.SS2.p1.6.m6.1.1.3" xref="A2.SS2.p1.6.m6.1.1.3.cmml"><mn id="A2.SS2.p1.6.m6.1.1.3.2" xref="A2.SS2.p1.6.m6.1.1.3.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A2.SS2.p1.6.m6.1.1.3.1" xref="A2.SS2.p1.6.m6.1.1.3.1.cmml">​</mo><msup id="A2.SS2.p1.6.m6.1.1.3.3" xref="A2.SS2.p1.6.m6.1.1.3.3.cmml"><mi id="A2.SS2.p1.6.m6.1.1.3.3.2" xref="A2.SS2.p1.6.m6.1.1.3.3.2.cmml">e</mi><mrow id="A2.SS2.p1.6.m6.1.1.3.3.3" xref="A2.SS2.p1.6.m6.1.1.3.3.3.cmml"><mo id="A2.SS2.p1.6.m6.1.1.3.3.3a" xref="A2.SS2.p1.6.m6.1.1.3.3.3.cmml">−</mo><mn id="A2.SS2.p1.6.m6.1.1.3.3.3.2" xref="A2.SS2.p1.6.m6.1.1.3.3.3.2.cmml">4</mn></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.SS2.p1.6.m6.1b"><apply id="A2.SS2.p1.6.m6.1.1.cmml" xref="A2.SS2.p1.6.m6.1.1"><eq id="A2.SS2.p1.6.m6.1.1.1.cmml" xref="A2.SS2.p1.6.m6.1.1.1"></eq><apply id="A2.SS2.p1.6.m6.1.1.2.cmml" xref="A2.SS2.p1.6.m6.1.1.2"><times id="A2.SS2.p1.6.m6.1.1.2.1.cmml" xref="A2.SS2.p1.6.m6.1.1.2.1"></times><ci id="A2.SS2.p1.6.m6.1.1.2.2.cmml" xref="A2.SS2.p1.6.m6.1.1.2.2">𝑙</ci><ci id="A2.SS2.p1.6.m6.1.1.2.3.cmml" xref="A2.SS2.p1.6.m6.1.1.2.3">𝑟</ci></apply><apply id="A2.SS2.p1.6.m6.1.1.3.cmml" xref="A2.SS2.p1.6.m6.1.1.3"><times id="A2.SS2.p1.6.m6.1.1.3.1.cmml" xref="A2.SS2.p1.6.m6.1.1.3.1"></times><cn type="integer" id="A2.SS2.p1.6.m6.1.1.3.2.cmml" xref="A2.SS2.p1.6.m6.1.1.3.2">5</cn><apply id="A2.SS2.p1.6.m6.1.1.3.3.cmml" xref="A2.SS2.p1.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="A2.SS2.p1.6.m6.1.1.3.3.1.cmml" xref="A2.SS2.p1.6.m6.1.1.3.3">superscript</csymbol><ci id="A2.SS2.p1.6.m6.1.1.3.3.2.cmml" xref="A2.SS2.p1.6.m6.1.1.3.3.2">𝑒</ci><apply id="A2.SS2.p1.6.m6.1.1.3.3.3.cmml" xref="A2.SS2.p1.6.m6.1.1.3.3.3"><minus id="A2.SS2.p1.6.m6.1.1.3.3.3.1.cmml" xref="A2.SS2.p1.6.m6.1.1.3.3.3"></minus><cn type="integer" id="A2.SS2.p1.6.m6.1.1.3.3.3.2.cmml" xref="A2.SS2.p1.6.m6.1.1.3.3.3.2">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS2.p1.6.m6.1c">lr=5e^{-4}</annotation></semantics></math> by 0.37%. This demonstrates that FedPepTAO is easy to fine-tune in practice.</p>
</div>
<figure id="A2.F2" class="ltx_figure"><img src="/html/2310.15080/assets/x2.png" id="A2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="207" height="155" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The impact of server learning rate.</figcaption>
</figure>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Impact of heterogeneous data distribution</h3>

<div id="A2.SS3.p1" class="ltx_para">
<p id="A2.SS3.p1.2" class="ltx_p">To investigate the robustness of our approach to different degrees of non-IID data, we conduct experiments under various levels of non-IID degrees. From Figure <a href="#A2.F3" title="Figure 3 ‣ B.3 Impact of heterogeneous data distribution ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we observe that the accuracy of FedPepTAO is the best with <math id="A2.SS3.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS3.p1.1.m1.1a"><mi id="A2.SS3.p1.1.m1.1.1" xref="A2.SS3.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.1.m1.1b"><ci id="A2.SS3.p1.1.m1.1.1.cmml" xref="A2.SS3.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.1.m1.1c">\alpha</annotation></semantics></math> ranging from 1.0 to 5.0. A smaller <math id="A2.SS3.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS3.p1.2.m2.1a"><mi id="A2.SS3.p1.2.m2.1.1" xref="A2.SS3.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.2.m2.1b"><ci id="A2.SS3.p1.2.m2.1.1.cmml" xref="A2.SS3.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.2.m2.1c">\alpha</annotation></semantics></math> represents a higher degree of heterogeneity. This demonstrates that our approach is robust to different data heterogeneity.</p>
</div>
<figure id="A2.F3" class="ltx_figure"><img src="/html/2310.15080/assets/x3.png" id="A2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="207" height="155" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The impact of various heterogeneity degrees.</figcaption>
</figure>
</section>
<section id="A2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.4 </span>Impact of device number</h3>

<div id="A2.SS4.p1" class="ltx_para">
<p id="A2.SS4.p1.1" class="ltx_p">To explore the scalability of our model, we conduct experiments with divers number of devices, i.e., 100, 150, and 200. Figure <a href="#A2.F4" title="Figure 4 ‣ B.4 Impact of device number ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the corresponding accuracy on the RTE dataset. The accuracy gap between the best and worst is only 0.73%, which demonstrates that FedPepTAO is scalable in FL settings.</p>
</div>
<figure id="A2.F4" class="ltx_figure"><img src="/html/2310.15080/assets/x4.png" id="A2.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="207" height="155" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Evaluation of divers number of devices.</figcaption>
</figure>
</section>
<section id="A2.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.5 </span>Impact of diverse bandwidth</h3>

<div id="A2.SS5.p1" class="ltx_para">
<p id="A2.SS5.p1.1" class="ltx_p">We carry out extra experimentation on two tasks, i.e., Subj and Trec with modest network bandwidth (reduced to 100 times smaller) on the RoBERTa<sub id="A2.SS5.p1.1.1" class="ltx_sub">LARGE</sub> model. We find that FedPepTAO maintains its advantages in this setting, i.e., up to 98.71%, 94.75%, 80.61%, 95%, 97.43%, 56.52%, 84.55% faster compared with Adapter, FedPrompt, P-tuning v2, IDPG, ATTEMPT, LPT, MomS+AdamD to achieve the target accuracy, as shown in Table <a href="#A2.T8" title="Table 8 ‣ B.5 Impact of diverse bandwidth ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure id="A2.T8" class="ltx_table">
<table id="A2.T8.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T8.1.1.1" class="ltx_tr">
<th id="A2.T8.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="A2.T8.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<td id="A2.T8.1.1.1.2" class="ltx_td ltx_align_left ltx_border_tt"><span id="A2.T8.1.1.1.2.1" class="ltx_text ltx_font_bold">Subj</span></td>
<td id="A2.T8.1.1.1.3" class="ltx_td ltx_align_left ltx_border_tt"><span id="A2.T8.1.1.1.3.1" class="ltx_text ltx_font_bold">Trec</span></td>
</tr>
<tr id="A2.T8.1.2.2" class="ltx_tr">
<th id="A2.T8.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Adapter</th>
<td id="A2.T8.1.2.2.2" class="ltx_td ltx_align_left ltx_border_t">3591</td>
<td id="A2.T8.1.2.2.3" class="ltx_td ltx_align_left ltx_border_t">7908</td>
</tr>
<tr id="A2.T8.1.3.3" class="ltx_tr">
<th id="A2.T8.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedPrompt</th>
<td id="A2.T8.1.3.3.2" class="ltx_td ltx_align_left">1333</td>
<td id="A2.T8.1.3.3.3" class="ltx_td ltx_align_left">368</td>
</tr>
<tr id="A2.T8.1.4.4" class="ltx_tr">
<th id="A2.T8.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">P-tuning v2</th>
<td id="A2.T8.1.4.4.2" class="ltx_td ltx_align_left">361</td>
<td id="A2.T8.1.4.4.3" class="ltx_td ltx_align_left">474</td>
</tr>
<tr id="A2.T8.1.5.5" class="ltx_tr">
<th id="A2.T8.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Promtp Tuning</th>
<td id="A2.T8.1.5.5.2" class="ltx_td ltx_align_left">/</td>
<td id="A2.T8.1.5.5.3" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="A2.T8.1.6.6" class="ltx_tr">
<th id="A2.T8.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">IDPG</th>
<td id="A2.T8.1.6.6.2" class="ltx_td ltx_align_left">1401</td>
<td id="A2.T8.1.6.6.3" class="ltx_td ltx_align_left">1345</td>
</tr>
<tr id="A2.T8.1.7.7" class="ltx_tr">
<th id="A2.T8.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">ATTEMPT</th>
<td id="A2.T8.1.7.7.2" class="ltx_td ltx_align_left">2726</td>
<td id="A2.T8.1.7.7.3" class="ltx_td ltx_align_left">1184</td>
</tr>
<tr id="A2.T8.1.8.8" class="ltx_tr">
<th id="A2.T8.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">LPT</th>
<td id="A2.T8.1.8.8.2" class="ltx_td ltx_align_left">161</td>
<td id="A2.T8.1.8.8.3" class="ltx_td ltx_align_left">123</td>
</tr>
<tr id="A2.T8.1.9.9" class="ltx_tr">
<th id="A2.T8.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MomD</th>
<td id="A2.T8.1.9.9.2" class="ltx_td ltx_align_left">/</td>
<td id="A2.T8.1.9.9.3" class="ltx_td ltx_align_left">/</td>
</tr>
<tr id="A2.T8.1.10.10" class="ltx_tr">
<th id="A2.T8.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">MomS+AdamD</th>
<td id="A2.T8.1.10.10.2" class="ltx_td ltx_align_left">453</td>
<td id="A2.T8.1.10.10.3" class="ltx_td ltx_align_left">496</td>
</tr>
<tr id="A2.T8.1.11.11" class="ltx_tr">
<th id="A2.T8.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">
<span id="A2.T8.1.11.11.1.1" class="ltx_ERROR undefined">\hdashline</span>FedPepTAO</th>
<td id="A2.T8.1.11.11.2" class="ltx_td ltx_align_left ltx_border_bb">70</td>
<td id="A2.T8.1.11.11.3" class="ltx_td ltx_align_left ltx_border_bb">102</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>The tuning time (s) to achieve a target accuracy (88% for Subj, 78% for Trec) on RoBERTa<sub id="A2.T8.3.1" class="ltx_sub">LARGE</sub> model. "/" represents that training does not achieve the target accuracy.</figcaption>
</figure>
</section>
<section id="A2.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.6 </span>Parameter-efficient Prompt Tuning and random layer selection strategy</h3>

<div id="A2.SS6.p1" class="ltx_para">
<p id="A2.SS6.p1.1" class="ltx_p">In order to clarify the impact of randomness in our experiments, we conduct three experiments with random layer selection strategy on RTE dataset. As shown in Table <a href="#A2.T9" title="Table 9 ‣ B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, FedPepTAO outperforms the random strategy with the accuracy gain of 2.53%, 2.89%, and 3.25% respectively, which demonstrates the superior performance of our FedPepTAO method.</p>
</div>
<figure id="A2.T9" class="ltx_table">
<table id="A2.T9.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T9.1.1.1" class="ltx_tr">
<th id="A2.T9.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T9.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="A2.T9.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T9.1.1.1.2.1" class="ltx_text ltx_font_bold">Seed 42 Acc</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T9.1.2.1" class="ltx_tr">
<td id="A2.T9.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">FedPepTAO</td>
<td id="A2.T9.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">85.56%</td>
</tr>
<tr id="A2.T9.1.3.2" class="ltx_tr">
<td id="A2.T9.1.3.2.1" class="ltx_td ltx_align_left">Random 1</td>
<td id="A2.T9.1.3.2.2" class="ltx_td ltx_align_left">83.03%</td>
</tr>
<tr id="A2.T9.1.4.3" class="ltx_tr">
<td id="A2.T9.1.4.3.1" class="ltx_td ltx_align_left">Random 2</td>
<td id="A2.T9.1.4.3.2" class="ltx_td ltx_align_left">82.67%</td>
</tr>
<tr id="A2.T9.1.5.4" class="ltx_tr">
<td id="A2.T9.1.5.4.1" class="ltx_td ltx_align_left">Random 3</td>
<td id="A2.T9.1.5.4.2" class="ltx_td ltx_align_left">82.31%</td>
</tr>
<tr id="A2.T9.1.6.5" class="ltx_tr">
<td id="A2.T9.1.6.5.1" class="ltx_td ltx_align_left ltx_border_bb">Avg acc gain</td>
<td id="A2.T9.1.6.5.2" class="ltx_td ltx_align_left ltx_border_bb">2.89%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>The performance of FedPepTAO and random layer choosing strategy on RTE dataset.</figcaption>
</figure>
<div id="A2.SS6.p2" class="ltx_para">
<p id="A2.SS6.p2.1" class="ltx_p">In addition, in order to further validate the impact of randomness on different datasets, we conducted additional experiments on three datasets (RTE, MRPC, and CoLA) with three randomly selected seeds (32, 35, and 37) to testify the strength of our Parameter-efficient Prompt Tuning method. Tables <a href="#A2.T10" title="Table 10 ‣ B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, <a href="#A2.T11" title="Table 11 ‣ B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>, and <a href="#A2.T12" title="Table 12 ‣ B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> exhibit that FedPepTAO outperforms the random strategy by 2.91%, 4.64%, and 7.29% on RTE, MRPC, and CoLA datasets, respectively. The above experiment results indicate that our FedPepTAO method can achieve substantial improvement compared with the random strategy.</p>
</div>
<figure id="A2.T10" class="ltx_table">
<table id="A2.T10.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T10.1.1.1" class="ltx_tr">
<th id="A2.T10.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="A2.T10.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="A2.T10.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T10.1.1.1.2.1" class="ltx_text ltx_font_bold">Seed 32</span></th>
<th id="A2.T10.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T10.1.1.1.3.1" class="ltx_text ltx_font_bold">Seed 35</span></th>
<th id="A2.T10.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T10.1.1.1.4.1" class="ltx_text ltx_font_bold">Seed 37</span></th>
</tr>
<tr id="A2.T10.1.2.2" class="ltx_tr">
<th id="A2.T10.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T10.1.2.2.1.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="A2.T10.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T10.1.2.2.2.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="A2.T10.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T10.1.2.2.3.1" class="ltx_text ltx_font_bold">Acc</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T10.1.3.1" class="ltx_tr">
<td id="A2.T10.1.3.1.1" class="ltx_td ltx_align_left ltx_border_t">FedPepTAO</td>
<td id="A2.T10.1.3.1.2" class="ltx_td ltx_align_left ltx_border_t">84.84%</td>
<td id="A2.T10.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t">85.56%</td>
<td id="A2.T10.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t">85.92%</td>
</tr>
<tr id="A2.T10.1.4.2" class="ltx_tr">
<td id="A2.T10.1.4.2.1" class="ltx_td ltx_align_left">Random 1</td>
<td id="A2.T10.1.4.2.2" class="ltx_td ltx_align_left">82.31%</td>
<td id="A2.T10.1.4.2.3" class="ltx_td ltx_align_left">82.31%</td>
<td id="A2.T10.1.4.2.4" class="ltx_td ltx_align_left">82.31%</td>
</tr>
<tr id="A2.T10.1.5.3" class="ltx_tr">
<td id="A2.T10.1.5.3.1" class="ltx_td ltx_align_left">Random 2</td>
<td id="A2.T10.1.5.3.2" class="ltx_td ltx_align_left">81.59%</td>
<td id="A2.T10.1.5.3.3" class="ltx_td ltx_align_left">81.23%</td>
<td id="A2.T10.1.5.3.4" class="ltx_td ltx_align_left">83.39%</td>
</tr>
<tr id="A2.T10.1.6.4" class="ltx_tr">
<td id="A2.T10.1.6.4.1" class="ltx_td ltx_align_left">Random 3</td>
<td id="A2.T10.1.6.4.2" class="ltx_td ltx_align_left">82.67%</td>
<td id="A2.T10.1.6.4.3" class="ltx_td ltx_align_left">83.03%</td>
<td id="A2.T10.1.6.4.4" class="ltx_td ltx_align_left">83.75%</td>
</tr>
<tr id="A2.T10.1.7.5" class="ltx_tr">
<td id="A2.T10.1.7.5.1" class="ltx_td ltx_align_left ltx_border_bb">Avg Acc Gain</td>
<td id="A2.T10.1.7.5.2" class="ltx_td ltx_align_left ltx_border_bb">2.65%</td>
<td id="A2.T10.1.7.5.3" class="ltx_td ltx_align_left ltx_border_bb">3.37%</td>
<td id="A2.T10.1.7.5.4" class="ltx_td ltx_align_left ltx_border_bb">2.77%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 10: </span>The performance of FedPepTAO and random layer choosing strategy on RTE dataset under different random seeds</figcaption>
</figure>
<figure id="A2.T11" class="ltx_table">
<table id="A2.T11.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T11.1.1.1" class="ltx_tr">
<th id="A2.T11.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="A2.T11.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="A2.T11.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T11.1.1.1.2.1" class="ltx_text ltx_font_bold">Seed 32</span></th>
<th id="A2.T11.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T11.1.1.1.3.1" class="ltx_text ltx_font_bold">Seed 35</span></th>
<th id="A2.T11.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T11.1.1.1.4.1" class="ltx_text ltx_font_bold">Seed 37</span></th>
</tr>
<tr id="A2.T11.1.2.2" class="ltx_tr">
<th id="A2.T11.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T11.1.2.2.1.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="A2.T11.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T11.1.2.2.2.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="A2.T11.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T11.1.2.2.3.1" class="ltx_text ltx_font_bold">Acc</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T11.1.3.1" class="ltx_tr">
<td id="A2.T11.1.3.1.1" class="ltx_td ltx_align_left ltx_border_t">FedPepTAO</td>
<td id="A2.T11.1.3.1.2" class="ltx_td ltx_align_left ltx_border_t">86.54%</td>
<td id="A2.T11.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t">87.09%</td>
<td id="A2.T11.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t">86.18%</td>
</tr>
<tr id="A2.T11.1.4.2" class="ltx_tr">
<td id="A2.T11.1.4.2.1" class="ltx_td ltx_align_left">Random 1</td>
<td id="A2.T11.1.4.2.2" class="ltx_td ltx_align_left">83.09%</td>
<td id="A2.T11.1.4.2.3" class="ltx_td ltx_align_left">81.86%</td>
<td id="A2.T11.1.4.2.4" class="ltx_td ltx_align_left">80.34%</td>
</tr>
<tr id="A2.T11.1.5.3" class="ltx_tr">
<td id="A2.T11.1.5.3.1" class="ltx_td ltx_align_left">Random 2</td>
<td id="A2.T11.1.5.3.2" class="ltx_td ltx_align_left">82.73%</td>
<td id="A2.T11.1.5.3.3" class="ltx_td ltx_align_left">82.03%</td>
<td id="A2.T11.1.5.3.4" class="ltx_td ltx_align_left">80.54%</td>
</tr>
<tr id="A2.T11.1.6.4" class="ltx_tr">
<td id="A2.T11.1.6.4.1" class="ltx_td ltx_align_left">Random 3</td>
<td id="A2.T11.1.6.4.2" class="ltx_td ltx_align_left">83.31%</td>
<td id="A2.T11.1.6.4.3" class="ltx_td ltx_align_left">81.83%</td>
<td id="A2.T11.1.6.4.4" class="ltx_td ltx_align_left">81.16%</td>
</tr>
<tr id="A2.T11.1.7.5" class="ltx_tr">
<td id="A2.T11.1.7.5.1" class="ltx_td ltx_align_left ltx_border_bb">Avg Acc Gain</td>
<td id="A2.T11.1.7.5.2" class="ltx_td ltx_align_left ltx_border_bb">3.5%</td>
<td id="A2.T11.1.7.5.3" class="ltx_td ltx_align_left ltx_border_bb">5.18%</td>
<td id="A2.T11.1.7.5.4" class="ltx_td ltx_align_left ltx_border_bb">5.5%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span>The performance of FedPepTAO and random layer choosing strategy on MRPC dataset under different random seeds</figcaption>
</figure>
<figure id="A2.T12" class="ltx_table">
<table id="A2.T12.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T12.1.1.1" class="ltx_tr">
<th id="A2.T12.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="A2.T12.1.1.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="A2.T12.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T12.1.1.1.2.1" class="ltx_text ltx_font_bold">Seed 32</span></th>
<th id="A2.T12.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T12.1.1.1.3.1" class="ltx_text ltx_font_bold">Seed 35</span></th>
<th id="A2.T12.1.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T12.1.1.1.4.1" class="ltx_text ltx_font_bold">Seed 37</span></th>
</tr>
<tr id="A2.T12.1.2.2" class="ltx_tr">
<th id="A2.T12.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T12.1.2.2.1.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="A2.T12.1.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T12.1.2.2.2.1" class="ltx_text ltx_font_bold">Acc</span></th>
<th id="A2.T12.1.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column"><span id="A2.T12.1.2.2.3.1" class="ltx_text ltx_font_bold">Acc</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T12.1.3.1" class="ltx_tr">
<td id="A2.T12.1.3.1.1" class="ltx_td ltx_align_left ltx_border_t">FedPepTAO</td>
<td id="A2.T12.1.3.1.2" class="ltx_td ltx_align_left ltx_border_t">56.94%</td>
<td id="A2.T12.1.3.1.3" class="ltx_td ltx_align_left ltx_border_t">58.92%</td>
<td id="A2.T12.1.3.1.4" class="ltx_td ltx_align_left ltx_border_t">56.49%</td>
</tr>
<tr id="A2.T12.1.4.2" class="ltx_tr">
<td id="A2.T12.1.4.2.1" class="ltx_td ltx_align_left">Random 1</td>
<td id="A2.T12.1.4.2.2" class="ltx_td ltx_align_left">46.45%</td>
<td id="A2.T12.1.4.2.3" class="ltx_td ltx_align_left">52.84%</td>
<td id="A2.T12.1.4.2.4" class="ltx_td ltx_align_left">49.58%</td>
</tr>
<tr id="A2.T12.1.5.3" class="ltx_tr">
<td id="A2.T12.1.5.3.1" class="ltx_td ltx_align_left">Random 2</td>
<td id="A2.T12.1.5.3.2" class="ltx_td ltx_align_left">51.57%</td>
<td id="A2.T12.1.5.3.3" class="ltx_td ltx_align_left">49.84%</td>
<td id="A2.T12.1.5.3.4" class="ltx_td ltx_align_left">45.71%</td>
</tr>
<tr id="A2.T12.1.6.4" class="ltx_tr">
<td id="A2.T12.1.6.4.1" class="ltx_td ltx_align_left">Random 3</td>
<td id="A2.T12.1.6.4.2" class="ltx_td ltx_align_left">50.77%</td>
<td id="A2.T12.1.6.4.3" class="ltx_td ltx_align_left">53.2%</td>
<td id="A2.T12.1.6.4.4" class="ltx_td ltx_align_left">51.45%</td>
</tr>
<tr id="A2.T12.1.7.5" class="ltx_tr">
<td id="A2.T12.1.7.5.1" class="ltx_td ltx_align_left ltx_border_bb">Avg Acc Gain</td>
<td id="A2.T12.1.7.5.2" class="ltx_td ltx_align_left ltx_border_bb">7.34%</td>
<td id="A2.T12.1.7.5.3" class="ltx_td ltx_align_left ltx_border_bb">6.96%</td>
<td id="A2.T12.1.7.5.4" class="ltx_td ltx_align_left ltx_border_bb">7.58%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 12: </span>The performance of FedPepTAO and random layer choosing strategy on CoLA dataset under different random seeds</figcaption>
</figure>
<figure id="A2.T13" class="ltx_table">
<div id="A2.T13.7" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:155.3pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-61.0pt,21.7pt) scale(0.780553699234188,0.780553699234188) ;">
<table id="A2.T13.7.7" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T13.7.7.7" class="ltx_tr">
<th id="A2.T13.7.7.7.8" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T13.7.7.7.8.1" class="ltx_text ltx_font_bold">Category</span></th>
<th id="A2.T13.7.7.7.9" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T13.7.7.7.9.1" class="ltx_text ltx_font_bold">Datasets</span></th>
<th id="A2.T13.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">
<math id="A2.T13.1.1.1.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="A2.T13.1.1.1.1.m1.1a"><mo fence="false" stretchy="false" id="A2.T13.1.1.1.1.m1.1.1" xref="A2.T13.1.1.1.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="A2.T13.1.1.1.1.m1.1b"><ci id="A2.T13.1.1.1.1.m1.1.1.cmml" xref="A2.T13.1.1.1.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T13.1.1.1.1.m1.1c">|</annotation></semantics></math><span id="A2.T13.2.2.2.2.1" class="ltx_text ltx_font_bold">Train<math id="A2.T13.2.2.2.2.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="A2.T13.2.2.2.2.1.m1.1a"><mo fence="false" stretchy="false" id="A2.T13.2.2.2.2.1.m1.1.1" xref="A2.T13.2.2.2.2.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="A2.T13.2.2.2.2.1.m1.1b"><ci id="A2.T13.2.2.2.2.1.m1.1.1.cmml" xref="A2.T13.2.2.2.2.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T13.2.2.2.2.1.m1.1c">|</annotation></semantics></math></span>
</th>
<th id="A2.T13.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">
<math id="A2.T13.3.3.3.3.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="A2.T13.3.3.3.3.m1.1a"><mo fence="false" stretchy="false" id="A2.T13.3.3.3.3.m1.1.1" xref="A2.T13.3.3.3.3.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="A2.T13.3.3.3.3.m1.1b"><ci id="A2.T13.3.3.3.3.m1.1.1.cmml" xref="A2.T13.3.3.3.3.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T13.3.3.3.3.m1.1c">|</annotation></semantics></math><span id="A2.T13.4.4.4.4.1" class="ltx_text ltx_font_bold">Dev<math id="A2.T13.4.4.4.4.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="A2.T13.4.4.4.4.1.m1.1a"><mo fence="false" stretchy="false" id="A2.T13.4.4.4.4.1.m1.1.1" xref="A2.T13.4.4.4.4.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="A2.T13.4.4.4.4.1.m1.1b"><ci id="A2.T13.4.4.4.4.1.m1.1.1.cmml" xref="A2.T13.4.4.4.4.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T13.4.4.4.4.1.m1.1c">|</annotation></semantics></math></span>
</th>
<th id="A2.T13.6.6.6.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">
<math id="A2.T13.5.5.5.5.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="A2.T13.5.5.5.5.m1.1a"><mo fence="false" stretchy="false" id="A2.T13.5.5.5.5.m1.1.1" xref="A2.T13.5.5.5.5.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="A2.T13.5.5.5.5.m1.1b"><ci id="A2.T13.5.5.5.5.m1.1.1.cmml" xref="A2.T13.5.5.5.5.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T13.5.5.5.5.m1.1c">|</annotation></semantics></math><span id="A2.T13.6.6.6.6.1" class="ltx_text ltx_font_bold">Test<math id="A2.T13.6.6.6.6.1.m1.1" class="ltx_Math" alttext="|" display="inline"><semantics id="A2.T13.6.6.6.6.1.m1.1a"><mo fence="false" stretchy="false" id="A2.T13.6.6.6.6.1.m1.1.1" xref="A2.T13.6.6.6.6.1.m1.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="A2.T13.6.6.6.6.1.m1.1b"><ci id="A2.T13.6.6.6.6.1.m1.1.1.cmml" xref="A2.T13.6.6.6.6.1.m1.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.T13.6.6.6.6.1.m1.1c">|</annotation></semantics></math></span>
</th>
<th id="A2.T13.7.7.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="A2.T13.7.7.7.7.m1.1" class="ltx_Math" alttext="\mathbf{|\mathcal{Y}|}" display="inline"><semantics id="A2.T13.7.7.7.7.m1.1a"><mrow id="A2.T13.7.7.7.7.m1.1.2.2" xref="A2.T13.7.7.7.7.m1.1.2.1.cmml"><mo stretchy="false" id="A2.T13.7.7.7.7.m1.1.2.2.1" xref="A2.T13.7.7.7.7.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A2.T13.7.7.7.7.m1.1.1" xref="A2.T13.7.7.7.7.m1.1.1.cmml">𝒴</mi><mo stretchy="false" id="A2.T13.7.7.7.7.m1.1.2.2.2" xref="A2.T13.7.7.7.7.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.T13.7.7.7.7.m1.1b"><apply id="A2.T13.7.7.7.7.m1.1.2.1.cmml" xref="A2.T13.7.7.7.7.m1.1.2.2"><abs id="A2.T13.7.7.7.7.m1.1.2.1.1.cmml" xref="A2.T13.7.7.7.7.m1.1.2.2.1"></abs><ci id="A2.T13.7.7.7.7.m1.1.1.cmml" xref="A2.T13.7.7.7.7.m1.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T13.7.7.7.7.m1.1c">\mathbf{|\mathcal{Y}|}</annotation></semantics></math></th>
<th id="A2.T13.7.7.7.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A2.T13.7.7.7.10.1" class="ltx_text ltx_font_bold">Type</span></th>
<th id="A2.T13.7.7.7.11" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T13.7.7.7.11.1" class="ltx_text ltx_font_bold">Labels</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T13.7.7.8.1" class="ltx_tr">
<td id="A2.T13.7.7.8.1.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="5"><span id="A2.T13.7.7.8.1.1.1" class="ltx_text">Single-sentence</span></td>
<td id="A2.T13.7.7.8.1.2" class="ltx_td ltx_align_left ltx_border_t">SST-2</td>
<td id="A2.T13.7.7.8.1.3" class="ltx_td ltx_align_center ltx_border_t">67349</td>
<td id="A2.T13.7.7.8.1.4" class="ltx_td ltx_align_center ltx_border_t">872</td>
<td id="A2.T13.7.7.8.1.5" class="ltx_td ltx_align_center ltx_border_t">1821</td>
<td id="A2.T13.7.7.8.1.6" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="A2.T13.7.7.8.1.7" class="ltx_td ltx_align_center ltx_border_t">sentiment</td>
<td id="A2.T13.7.7.8.1.8" class="ltx_td ltx_align_left ltx_border_t">positive, negative</td>
</tr>
<tr id="A2.T13.7.7.9.2" class="ltx_tr">
<td id="A2.T13.7.7.9.2.1" class="ltx_td ltx_align_left">MPQA</td>
<td id="A2.T13.7.7.9.2.2" class="ltx_td ltx_align_center">7606</td>
<td id="A2.T13.7.7.9.2.3" class="ltx_td ltx_align_center">1000</td>
<td id="A2.T13.7.7.9.2.4" class="ltx_td ltx_align_center">2000</td>
<td id="A2.T13.7.7.9.2.5" class="ltx_td ltx_align_center">2</td>
<td id="A2.T13.7.7.9.2.6" class="ltx_td ltx_align_center">opinion polarity</td>
<td id="A2.T13.7.7.9.2.7" class="ltx_td ltx_align_left">positive, negative</td>
</tr>
<tr id="A2.T13.7.7.10.3" class="ltx_tr">
<td id="A2.T13.7.7.10.3.1" class="ltx_td ltx_align_left">MR</td>
<td id="A2.T13.7.7.10.3.2" class="ltx_td ltx_align_center">7662</td>
<td id="A2.T13.7.7.10.3.3" class="ltx_td ltx_align_center">1000</td>
<td id="A2.T13.7.7.10.3.4" class="ltx_td ltx_align_center">2000</td>
<td id="A2.T13.7.7.10.3.5" class="ltx_td ltx_align_center">2</td>
<td id="A2.T13.7.7.10.3.6" class="ltx_td ltx_align_center">sentiment</td>
<td id="A2.T13.7.7.10.3.7" class="ltx_td ltx_align_left">positive, negative</td>
</tr>
<tr id="A2.T13.7.7.11.4" class="ltx_tr">
<td id="A2.T13.7.7.11.4.1" class="ltx_td ltx_align_left">Subj</td>
<td id="A2.T13.7.7.11.4.2" class="ltx_td ltx_align_center">7000</td>
<td id="A2.T13.7.7.11.4.3" class="ltx_td ltx_align_center">1000</td>
<td id="A2.T13.7.7.11.4.4" class="ltx_td ltx_align_center">2000</td>
<td id="A2.T13.7.7.11.4.5" class="ltx_td ltx_align_center">2</td>
<td id="A2.T13.7.7.11.4.6" class="ltx_td ltx_align_center">subjectivity</td>
<td id="A2.T13.7.7.11.4.7" class="ltx_td ltx_align_left">subjective, objective</td>
</tr>
<tr id="A2.T13.7.7.12.5" class="ltx_tr">
<td id="A2.T13.7.7.12.5.1" class="ltx_td ltx_align_left">Trec</td>
<td id="A2.T13.7.7.12.5.2" class="ltx_td ltx_align_center">4952</td>
<td id="A2.T13.7.7.12.5.3" class="ltx_td ltx_align_center">500</td>
<td id="A2.T13.7.7.12.5.4" class="ltx_td ltx_align_center">500</td>
<td id="A2.T13.7.7.12.5.5" class="ltx_td ltx_align_center">6</td>
<td id="A2.T13.7.7.12.5.6" class="ltx_td ltx_align_center">question cls.</td>
<td id="A2.T13.7.7.12.5.7" class="ltx_td ltx_align_left">abbr., entity, description, human, loc., num.</td>
</tr>
<tr id="A2.T13.7.7.13.6" class="ltx_tr">
<td id="A2.T13.7.7.13.6.1" class="ltx_td"></td>
<td id="A2.T13.7.7.13.6.2" class="ltx_td ltx_align_left">CoLA</td>
<td id="A2.T13.7.7.13.6.3" class="ltx_td ltx_align_center">8551</td>
<td id="A2.T13.7.7.13.6.4" class="ltx_td ltx_align_center">1043</td>
<td id="A2.T13.7.7.13.6.5" class="ltx_td ltx_align_center">1063</td>
<td id="A2.T13.7.7.13.6.6" class="ltx_td ltx_align_center">2</td>
<td id="A2.T13.7.7.13.6.7" class="ltx_td ltx_align_center">acceptability</td>
<td id="A2.T13.7.7.13.6.8" class="ltx_td ltx_align_left">acceptable, unacceptable</td>
</tr>
<tr id="A2.T13.7.7.14.7" class="ltx_tr">
<td id="A2.T13.7.7.14.7.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" rowspan="5"><span id="A2.T13.7.7.14.7.1.1" class="ltx_text">Sentence-pair</span></td>
<td id="A2.T13.7.7.14.7.2" class="ltx_td ltx_align_left ltx_border_t">MRPC</td>
<td id="A2.T13.7.7.14.7.3" class="ltx_td ltx_align_center ltx_border_t">3668</td>
<td id="A2.T13.7.7.14.7.4" class="ltx_td ltx_align_center ltx_border_t">408</td>
<td id="A2.T13.7.7.14.7.5" class="ltx_td ltx_align_center ltx_border_t">1725</td>
<td id="A2.T13.7.7.14.7.6" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="A2.T13.7.7.14.7.7" class="ltx_td ltx_align_center ltx_border_t">paraphrase</td>
<td id="A2.T13.7.7.14.7.8" class="ltx_td ltx_align_left ltx_border_t">equivalent, not equivalent</td>
</tr>
<tr id="A2.T13.7.7.15.8" class="ltx_tr">
<td id="A2.T13.7.7.15.8.1" class="ltx_td ltx_align_left">QNLI</td>
<td id="A2.T13.7.7.15.8.2" class="ltx_td ltx_align_center">104743</td>
<td id="A2.T13.7.7.15.8.3" class="ltx_td ltx_align_center">5463</td>
<td id="A2.T13.7.7.15.8.4" class="ltx_td ltx_align_center">5463</td>
<td id="A2.T13.7.7.15.8.5" class="ltx_td ltx_align_center">2</td>
<td id="A2.T13.7.7.15.8.6" class="ltx_td ltx_align_center">NLI</td>
<td id="A2.T13.7.7.15.8.7" class="ltx_td ltx_align_left">entailment, not entailment</td>
</tr>
<tr id="A2.T13.7.7.16.9" class="ltx_tr">
<td id="A2.T13.7.7.16.9.1" class="ltx_td ltx_align_left">BoolQ</td>
<td id="A2.T13.7.7.16.9.2" class="ltx_td ltx_align_center">9427</td>
<td id="A2.T13.7.7.16.9.3" class="ltx_td ltx_align_center">3270</td>
<td id="A2.T13.7.7.16.9.4" class="ltx_td ltx_align_center">3245</td>
<td id="A2.T13.7.7.16.9.5" class="ltx_td ltx_align_center">2</td>
<td id="A2.T13.7.7.16.9.6" class="ltx_td ltx_align_center">QA</td>
<td id="A2.T13.7.7.16.9.7" class="ltx_td ltx_align_left">true, false</td>
</tr>
<tr id="A2.T13.7.7.17.10" class="ltx_tr">
<td id="A2.T13.7.7.17.10.1" class="ltx_td ltx_align_left ltx_border_bb">RTE</td>
<td id="A2.T13.7.7.17.10.2" class="ltx_td ltx_align_center ltx_border_bb">2490</td>
<td id="A2.T13.7.7.17.10.3" class="ltx_td ltx_align_center ltx_border_bb">277</td>
<td id="A2.T13.7.7.17.10.4" class="ltx_td ltx_align_center ltx_border_bb">3000</td>
<td id="A2.T13.7.7.17.10.5" class="ltx_td ltx_align_center ltx_border_bb">2</td>
<td id="A2.T13.7.7.17.10.6" class="ltx_td ltx_align_center ltx_border_bb">NLI</td>
<td id="A2.T13.7.7.17.10.7" class="ltx_td ltx_align_left ltx_border_bb">entailment, not entailment</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 13: </span>The statistics of datasets evaluated in this work. <math id="A2.T13.9.m1.1" class="ltx_Math" alttext="|\mathcal{Y}|" display="inline"><semantics id="A2.T13.9.m1.1b"><mrow id="A2.T13.9.m1.1.2.2" xref="A2.T13.9.m1.1.2.1.cmml"><mo stretchy="false" id="A2.T13.9.m1.1.2.2.1" xref="A2.T13.9.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A2.T13.9.m1.1.1" xref="A2.T13.9.m1.1.1.cmml">𝒴</mi><mo stretchy="false" id="A2.T13.9.m1.1.2.2.2" xref="A2.T13.9.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.T13.9.m1.1c"><apply id="A2.T13.9.m1.1.2.1.cmml" xref="A2.T13.9.m1.1.2.2"><abs id="A2.T13.9.m1.1.2.1.1.cmml" xref="A2.T13.9.m1.1.2.2.1"></abs><ci id="A2.T13.9.m1.1.1.cmml" xref="A2.T13.9.m1.1.1">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.T13.9.m1.1d">|\mathcal{Y}|</annotation></semantics></math> is the number for classes.</figcaption>
</figure>
<div id="A2.SS6.p3" class="ltx_para">
<p id="A2.SS6.p3.1" class="ltx_p">We notice an inverse correlation between the performance of our Parameter-efficient Prompt Tuning (PEPT) method and the average sentence length of the three datasets. Specifically, PEPT tends to achieve a smaller performance gain on the datasets with longer average sentence length, as shown in Table <a href="#A2.T14" title="Table 14 ‣ B.6 Parameter-efficient Prompt Tuning and random layer selection strategy ‣ Appendix B Extra Experiments ‣ Federated Learning of Large Language Models with Parameter-Efficient Prompt Tuning and Adaptive Optimization" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>.</p>
</div>
<figure id="A2.T14" class="ltx_table">
<table id="A2.T14.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A2.T14.1.1.1" class="ltx_tr">
<th id="A2.T14.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T14.1.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="A2.T14.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T14.1.1.1.2.1" class="ltx_text ltx_font_bold">Avg sentence length</span></th>
<th id="A2.T14.1.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt"><span id="A2.T14.1.1.1.3.1" class="ltx_text ltx_font_bold">Avg acc gain</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A2.T14.1.2.1" class="ltx_tr">
<td id="A2.T14.1.2.1.1" class="ltx_td ltx_align_left ltx_border_t">RTE</td>
<td id="A2.T14.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">71.91</td>
<td id="A2.T14.1.2.1.3" class="ltx_td ltx_align_left ltx_border_t">2.91%</td>
</tr>
<tr id="A2.T14.1.3.2" class="ltx_tr">
<td id="A2.T14.1.3.2.1" class="ltx_td ltx_align_left">MRPC</td>
<td id="A2.T14.1.3.2.2" class="ltx_td ltx_align_left">54.95</td>
<td id="A2.T14.1.3.2.3" class="ltx_td ltx_align_left">4.64%</td>
</tr>
<tr id="A2.T14.1.4.3" class="ltx_tr">
<td id="A2.T14.1.4.3.1" class="ltx_td ltx_align_left ltx_border_bb">CoLA</td>
<td id="A2.T14.1.4.3.2" class="ltx_td ltx_align_left ltx_border_bb">16.37</td>
<td id="A2.T14.1.4.3.3" class="ltx_td ltx_align_left ltx_border_bb">7.29%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 14: </span>Average sentence length and accuracy improvements of FedPepTAO for three datasets.</figcaption>
</figure>
<div id="A2.SS6.p4" class="ltx_para">
<p id="A2.SS6.p4.1" class="ltx_p">A reasonable explanation is that the datasets with longer average sentence length, such as RTE, often contain more latent information. More/less latent information make them easier/more difficult to be evenly distributed across all transformer layers, resulting in a relatively equal/diverse contribution by each layer during tuning. When different layers contain the similar/dissimilar amount of latent information, the impact of each unique layer is accordingly decreased/increased. Therefore, the random layer selection results in less/more accuracy gain by our PEPT method. The above experiment results demonstrate that our PEPT method can achieve substantial performance improvement on different datasets in most experiments.</p>
</div>
<figure id="A2.F5" class="ltx_figure"><img src="/html/2310.15080/assets/x5.png" id="A2.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="230" height="172" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Evaluation of divers layer selection strategies.</figcaption>
</figure>
<figure id="A2.F6" class="ltx_figure"><img src="/html/2310.15080/assets/x6.png" id="A2.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="230" height="172" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Evaluation for various optimization methods.</figcaption>
</figure>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.15079" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.15080" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.15080">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.15080" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.15081" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 22:21:42 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
