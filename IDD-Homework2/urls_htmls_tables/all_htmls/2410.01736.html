<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Recursive Abstractive Processing for Retrieval in Dynamic Datasets</title>
<!--Generated on Wed Oct  2 16:46:07 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.01736v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S1" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S2" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S2.SS0.SSS0.Px1" title="In 2 Related Work ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Retrieval Algorithms</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S2.SS0.SSS0.Px2" title="In 2 Related Work ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Post-Retrieval Algorithms</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS1" title="In 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Clustering with Gaussian Mixture Models (GMMs)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS2" title="In 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Dimensionality Reduction with UMAP</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS3" title="In 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Recursive-Abstractive Tree Construction</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS3.SSS0.Px1" title="In 3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Dataset Chunking</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS3.SSS0.Px2" title="In 3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Clustering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS3.SSS0.Px3" title="In 3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Summarizing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS3.SSS0.Px4" title="In 3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Recursive Construction</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS4" title="In 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Retrieving Documents</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S4" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>adRAP: Adaptive Recursive-Abstractive Processing</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S4.SS1" title="In 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S4.SS2" title="In 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Adaptive UMAP</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S4.SS3" title="In 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Adaptive GMM</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S4.SS4" title="In 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>adRAP Algorithm</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S5" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>postQFRAP: post-retrieval Query-Focused Recursive-Abstractive Processing</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S5.SS1" title="In 5 postQFRAP: post-retrieval Query-Focused Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Motivation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S5.SS2" title="In 5 postQFRAP: post-retrieval Query-Focused Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>postQFRAP Algorithm</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S5.SS3" title="In 5 postQFRAP: post-retrieval Query-Focused Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Key Properties</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.SS1" title="In 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.SS2" title="In 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.SS3" title="In 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Hyperparameter Selection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.SS4" title="In 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.SS5" title="In 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S7" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S8" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S9" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Reproducibility Statement</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S9.SS0.SSS0.Px1" title="In 9 Reproducibility Statement ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Language Model Used</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S9.SS0.SSS0.Px2" title="In 9 Reproducibility Statement ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Prompts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S9.SS0.SSS0.Px3" title="In 9 Reproducibility Statement ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Hyperparameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S9.SS0.SSS0.Px4" title="In 9 Reproducibility Statement ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title">Datasets</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A1" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Pseudocodes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A2" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Comparing one- vs two-step Clustering for postQFRAP</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A3" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Qualitative Analysis of Human Coherence Rating</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A4" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Qualitative Analysis of postQFRAP</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A5" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Selection of <math alttext="k_{0}" class="ltx_Math" display="inline"><semantics><msub><mi>k</mi><mn>0</mn></msub><annotation-xml encoding="MathML-Content"><apply><csymbol cd="ambiguous">subscript</csymbol><ci>𝑘</ci><cn type="integer">0</cn></apply></annotation-xml><annotation encoding="application/x-tex">k_{0}</annotation><annotation encoding="application/x-llamapun">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> for postQFRAP</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A6" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Query Expansion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Prompts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8" title="In Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H </span>Detailed Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS1" title="In Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.1 </span>Computing Resources</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS2" title="In Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.2 </span>adRAP Runtime</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS3" title="In Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.3 </span>Generating Questions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS4" title="In Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.4 </span>Additional Dataset: <span class="ltx_text ltx_font_italic">NarrativeQA</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS5" title="In Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.5 </span>Dataset Preprocessing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS6" title="In Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">H.6 </span>Datasets Statistics</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Recursive Abstractive Processing for Retrieval in Dynamic Datasets</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Charbel Chucri
<br class="ltx_break"/>EPFL
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">charbel.chucri@epfl.ch</span>
<br class="ltx_break"/>&amp;Rami Azouz 
<br class="ltx_break"/>Philico SA 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id2.2.id2">rami.azouz@philico.com</span>
<br class="ltx_break"/>&amp;Joachim Ott 
<br class="ltx_break"/>Philico SA 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id3.3.id3">joachim.ott@philico.com</span>
</span><span class="ltx_author_notes">Work done while doing an internship at Philico SA</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id4.id1">Recent retrieval-augmented models enhance basic methods by building a hierarchical structure over retrieved text chunks through recursive embedding, clustering, and summarization.
The most relevant information is then retrieved from both the original text and generated summaries.
However, such approaches face limitations with dynamic datasets, where adding or removing documents over time complicates the updating of hierarchical representations formed through clustering.
We propose a new algorithm to efficiently maintain the recursive-abstractive tree structure in dynamic datasets, without compromising performance.
Additionally, we introduce a novel post-retrieval method that applies query-focused recursive abstractive processing to substantially improve context quality.
Our method overcomes the limitations of other approaches by functioning as a black-box post-retrieval layer compatible with any retrieval algorithm.
Both algorithms are validated through extensive experiments on real-world datasets, demonstrating their effectiveness in handling dynamic data and improving retrieval performance.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs) have established themselves as powerful tools across a wide range of natural language processing (NLP) tasks, thanks to their ability to store vast amounts of factual knowledge within their parameters <cite class="ltx_cite ltx_citemacro_citep">(Petroni et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib18" title="">2019</a>; Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib9" title="">2020</a>)</cite>. These models can be further fine-tuned to specialize in specific tasks <cite class="ltx_cite ltx_citemacro_citep">(Roberts et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib20" title="">2020</a>)</cite>, making them highly versatile. However, a key limitation of LLMs lies in their static nature: as the world evolves and new information emerges, the knowledge encoded within an LLM can quickly become outdated.
A promising alternative to relying solely on parametric knowledge is retrieval augmentation <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib7" title="">2023</a>)</cite>. This approach involves the use of external retrieval systems to supply relevant information in real-time.
Instead of encoding all knowledge directly into the model, large text corpora are indexed, segmented into manageable chunks, and dynamically retrieved as needed <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib11" title="">2020</a>; Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib7" title="">2023</a>)</cite>.
Retrieval-augmented methods not only improve model accuracy but also offer a practical solution for maintaining performance as knowledge evolves over time.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, retrieval-augmented approaches also have limitations.
Many existing methods only retrieve short, specific chunks as context, which restricts the model’s ability to answer questions requiring a broader understanding of the text.
To address this, RAPTOR was introduced <cite class="ltx_cite ltx_citemacro_citep">(Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib21" title="">2024</a>)</cite>.
It recursively embeds, clusters, and summarizes text chunks, enabling the retrieval of relevant information from both original document chunks and generated summaries.
Yet, RAPTOR introduces new challenges, especially with dynamic datasets where documents are frequently added or removed.
The clustering component makes the tree structure sensitive to these updates, requiring a full re-computation of the tree after each change, which is computationally expensive.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address these limitations, we introduce <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">adRAP</span> (adaptive Recursive Abstractive Processing), an algorithm designed to efficiently update RAPTOR’s recursive-abstractive structure as new documents are added or removed.
By incrementally adjusting the structure, adRAP avoids full re-computation, preserving retrieval performance while significantly reducing computational overhead.
Furthermore, both RAPTOR and adRAP introduce memory overhead and require periodic maintenance when used with dynamic datasets.
As an alternative, we propose <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">postQFRAP</span>, a post-retrieval method that applies query-focused recursive abstractive processing as a black-box layer, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">1</span></a>.
This post-processing method integrates seamlessly into any retrieval pipeline while significantly enhancing the quality of the retrieved context.
For example, naïve RAG <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib7" title="">2023</a>)</cite> can serve as the underlying model since it processes documents independently, allowing easy addition or removal of documents.
Moreover, by initially retrieving enough documents, questions requiring a broader understanding can be answered by passing the generated summary to the LLM, rather than passing all potentially relevant documents, thus mitigating challenges like limited context window size and information loss in large contexts <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib12" title="">2024</a>; Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib27" title="">2024</a>)</cite>.
Through extensive experiments on real-world datasets, we demonstrate that adRAP provides a good approximation of the RAPTOR tree, while postQFRAP effectively enhances retrieval quality.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="233" id="S1.F1.g1" src="x1.png" width="498"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S1.F1.4.1">Retrieval pipeline with postQFRAP</span>: we first retrieve from a dataset <math alttext="k_{0}" class="ltx_Math" display="inline" id="S1.F1.2.m1.1"><semantics id="S1.F1.2.m1.1b"><msub id="S1.F1.2.m1.1.1" xref="S1.F1.2.m1.1.1.cmml"><mi id="S1.F1.2.m1.1.1.2" xref="S1.F1.2.m1.1.1.2.cmml">k</mi><mn id="S1.F1.2.m1.1.1.3" xref="S1.F1.2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.2.m1.1c"><apply id="S1.F1.2.m1.1.1.cmml" xref="S1.F1.2.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.2.m1.1.1.1.cmml" xref="S1.F1.2.m1.1.1">subscript</csymbol><ci id="S1.F1.2.m1.1.1.2.cmml" xref="S1.F1.2.m1.1.1.2">𝑘</ci><cn id="S1.F1.2.m1.1.1.3.cmml" type="integer" xref="S1.F1.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.m1.1d">k_{0}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.2.m1.1e">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> chunks relevant to the query, then we build a query-focused recursive-abstractive tree on those chunks. Finally, we summarize the contents of the root layer of that tree to get the context that is passed to the LLM.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Retrieval Algorithms</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">In the context of LLMs, retrieval-augmented generation (RAG) involves retrieving relevant information from external sources and appending it to the LLM’s context alongside the original query <cite class="ltx_cite ltx_citemacro_citep">(Ram et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib19" title="">2023</a>)</cite>.
Naïve RAG methods <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib7" title="">2023</a>)</cite> address this challenge by converting documents into text, splitting it into chunks, and embedding these chunks in a vector space where semantically similar chunks are mapped to nearby vectors.
The query is similarly embedded, and the <math alttext="k" class="ltx_Math" display="inline" id="S2.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S2.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S2.SS0.SSS0.Px1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS0.SSS0.Px1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS0.SSS0.Px1.p1.1.m1.1d">italic_k</annotation></semantics></math>-nearest vectors are retrieved to augment the LLM’s context.
However, segmenting text into contiguous chunks may fail to capture its full semantic richness, and retrieving overly granular segments can overlook key information <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib7" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p2.1">The recursive-abstractive summarization method by <cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib25" title="">2021</a>)</cite> addresses this issue by breaking down tasks to summarize smaller text segments, which are then integrated to form summaries of larger sections.
While effective at capturing broader themes, it may miss finer details.
RAPTOR <cite class="ltx_cite ltx_citemacro_citep">(Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib21" title="">2024</a>)</cite> improves on this technique by recursively grouping and summarizing similar chunks, retaining both summaries and initial chunks.
This approach captures a representation of the text at multiple levels of detail while preserving inter-dependencies within the text.</p>
</div>
</section>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Post-Retrieval Algorithms</h4>
<div class="ltx_para ltx_noindent" id="S2.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px2.p1.1">To optimize retrieval algorithms, post-retrieval strategies are commonly employed.
These include re-ranking retrieved chunks and compressing the context <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib7" title="">2023</a>)</cite>, as large contexts fed directly into LLMs often result in information loss, particularly in the middle sections <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib12" title="">2024</a>; Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib27" title="">2024</a>)</cite>.
The closest approach to our setting is the query-focused summarization algorithm by <cite class="ltx_cite ltx_citemacro_citet">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib28" title="">2024</a>)</cite>.
They retrieve relevant documents which they also summarize using a prompt designed to extract key information before generating the summary. The latter is then passed as context to the LLM.
In contrast, we construct a hierarchical tree over the retrieved documents, allowing us to recursively filter noise by focusing on smaller, manageable chunks at each step. This yields a more refined and relevant summary.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Clustering with Gaussian Mixture Models (GMMs)</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.12">Gaussian Mixture Models assume that data points are generated from a mixture of multiple Gaussian distributions.
They have two key advantages: they allow non-isotropic Gaussians, enabling varied cluster shapes and orientations, and they support soft clustering, where a data point can belong to multiple clusters.
Let <math alttext="K" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_K</annotation></semantics></math> represent the number of clusters, and <math alttext="x_{1},\dots,x_{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.3"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3.2" xref="S3.SS1.p1.2.m2.3.3.3.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.2.cmml">x</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.3" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS1.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.3.2.4" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml">x</mi><mi id="S3.SS1.p1.2.m2.3.3.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><list id="S3.SS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.2">𝑥</ci><cn id="S3.SS1.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">𝑥</ci><ci id="S3.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">x_{1},\dots,x_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.3d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> be the data points.
Each cluster <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_k</annotation></semantics></math> is defined by its mean <math alttext="\mu_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">μ</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝜇</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mu_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, covariance matrix <math alttext="\Sigma_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" mathvariant="normal" xref="S3.SS1.p1.5.m5.1.1.2.cmml">Σ</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">Σ</ci><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\Sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and mixture weight <math alttext="\pi_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">π</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝜋</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\pi_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, which represents the prior probability of a data point belonging to cluster <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_k</annotation></semantics></math>.
The probability density function (PDF) for a data point <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_x</annotation></semantics></math> is given by <math alttext="p(x)=\sum_{k=1}^{K}\pi_{k}\mathcal{N}(x|\mu_{k},\Sigma_{k})" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.2"><semantics id="S3.SS1.p1.9.m9.2a"><mrow id="S3.SS1.p1.9.m9.2.2" xref="S3.SS1.p1.9.m9.2.2.cmml"><mrow id="S3.SS1.p1.9.m9.2.2.3" xref="S3.SS1.p1.9.m9.2.2.3.cmml"><mi id="S3.SS1.p1.9.m9.2.2.3.2" xref="S3.SS1.p1.9.m9.2.2.3.2.cmml">p</mi><mo id="S3.SS1.p1.9.m9.2.2.3.1" xref="S3.SS1.p1.9.m9.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.9.m9.2.2.3.3.2" xref="S3.SS1.p1.9.m9.2.2.3.cmml"><mo id="S3.SS1.p1.9.m9.2.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.9.m9.2.2.3.cmml">(</mo><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">x</mi><mo id="S3.SS1.p1.9.m9.2.2.3.3.2.2" stretchy="false" xref="S3.SS1.p1.9.m9.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.9.m9.2.2.2" rspace="0.111em" xref="S3.SS1.p1.9.m9.2.2.2.cmml">=</mo><mrow id="S3.SS1.p1.9.m9.2.2.1" xref="S3.SS1.p1.9.m9.2.2.1.cmml"><msubsup id="S3.SS1.p1.9.m9.2.2.1.2" xref="S3.SS1.p1.9.m9.2.2.1.2.cmml"><mo id="S3.SS1.p1.9.m9.2.2.1.2.2.2" xref="S3.SS1.p1.9.m9.2.2.1.2.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.9.m9.2.2.1.2.2.3" xref="S3.SS1.p1.9.m9.2.2.1.2.2.3.cmml"><mi id="S3.SS1.p1.9.m9.2.2.1.2.2.3.2" xref="S3.SS1.p1.9.m9.2.2.1.2.2.3.2.cmml">k</mi><mo id="S3.SS1.p1.9.m9.2.2.1.2.2.3.1" xref="S3.SS1.p1.9.m9.2.2.1.2.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.9.m9.2.2.1.2.2.3.3" xref="S3.SS1.p1.9.m9.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.9.m9.2.2.1.2.3" xref="S3.SS1.p1.9.m9.2.2.1.2.3.cmml">K</mi></msubsup><mrow id="S3.SS1.p1.9.m9.2.2.1.1" xref="S3.SS1.p1.9.m9.2.2.1.1.cmml"><msub id="S3.SS1.p1.9.m9.2.2.1.1.3" xref="S3.SS1.p1.9.m9.2.2.1.1.3.cmml"><mi id="S3.SS1.p1.9.m9.2.2.1.1.3.2" xref="S3.SS1.p1.9.m9.2.2.1.1.3.2.cmml">π</mi><mi id="S3.SS1.p1.9.m9.2.2.1.1.3.3" xref="S3.SS1.p1.9.m9.2.2.1.1.3.3.cmml">k</mi></msub><mo id="S3.SS1.p1.9.m9.2.2.1.1.2" xref="S3.SS1.p1.9.m9.2.2.1.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.2.2.1.1.4" xref="S3.SS1.p1.9.m9.2.2.1.1.4.cmml">𝒩</mi><mo id="S3.SS1.p1.9.m9.2.2.1.1.2a" xref="S3.SS1.p1.9.m9.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.9.m9.2.2.1.1.1.1" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.9.m9.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.4" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.4.cmml">x</mi><mo fence="false" id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.3" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.3.cmml"><msub id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.2" mathvariant="normal" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.2.cmml">Σ</mi><mi id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.SS1.p1.9.m9.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.2b"><apply id="S3.SS1.p1.9.m9.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2"><eq id="S3.SS1.p1.9.m9.2.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2.2"></eq><apply id="S3.SS1.p1.9.m9.2.2.3.cmml" xref="S3.SS1.p1.9.m9.2.2.3"><times id="S3.SS1.p1.9.m9.2.2.3.1.cmml" xref="S3.SS1.p1.9.m9.2.2.3.1"></times><ci id="S3.SS1.p1.9.m9.2.2.3.2.cmml" xref="S3.SS1.p1.9.m9.2.2.3.2">𝑝</ci><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑥</ci></apply><apply id="S3.SS1.p1.9.m9.2.2.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1"><apply id="S3.SS1.p1.9.m9.2.2.1.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.2.2.1.2.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2">superscript</csymbol><apply id="S3.SS1.p1.9.m9.2.2.1.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.2.2.1.2.2.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2">subscript</csymbol><sum id="S3.SS1.p1.9.m9.2.2.1.2.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2.2.2"></sum><apply id="S3.SS1.p1.9.m9.2.2.1.2.2.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2.2.3"><eq id="S3.SS1.p1.9.m9.2.2.1.2.2.3.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2.2.3.1"></eq><ci id="S3.SS1.p1.9.m9.2.2.1.2.2.3.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2.2.3.2">𝑘</ci><cn id="S3.SS1.p1.9.m9.2.2.1.2.2.3.3.cmml" type="integer" xref="S3.SS1.p1.9.m9.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.9.m9.2.2.1.2.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.2.3">𝐾</ci></apply><apply id="S3.SS1.p1.9.m9.2.2.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1"><times id="S3.SS1.p1.9.m9.2.2.1.1.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.2"></times><apply id="S3.SS1.p1.9.m9.2.2.1.1.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.2.2.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.9.m9.2.2.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.3.2">𝜋</ci><ci id="S3.SS1.p1.9.m9.2.2.1.1.3.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.3.3">𝑘</ci></apply><ci id="S3.SS1.p1.9.m9.2.2.1.1.4.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.4">𝒩</ci><apply id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.3">conditional</csymbol><ci id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.4">𝑥</ci><list id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2"><apply id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.2">Σ</ci><ci id="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.2c">p(x)=\sum_{k=1}^{K}\pi_{k}\mathcal{N}(x|\mu_{k},\Sigma_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.2d">italic_p ( italic_x ) = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT caligraphic_N ( italic_x | italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> where <math alttext="\mathcal{N}(x_{i}|\mu_{k},\Sigma_{k})" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">𝒩</mi><mo id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.10.m10.1.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.10.m10.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.10.m10.1.1.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.cmml"><msub id="S3.SS1.p1.10.m10.1.1.1.1.1.4" xref="S3.SS1.p1.10.m10.1.1.1.1.1.4.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.4.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.4.2.cmml">x</mi><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.4.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S3.SS1.p1.10.m10.1.1.1.1.1.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.3.cmml"><msub id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.2" mathvariant="normal" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.2.cmml">Σ</mi><mi id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.3" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.SS1.p1.10.m10.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><times id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2"></times><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝒩</ci><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.10.m10.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.3">conditional</csymbol><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.4.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.4.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.4.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.4.2">𝑥</ci><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.4.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.4.3">𝑖</ci></apply><list id="S3.SS1.p1.10.m10.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.2"><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.2">Σ</ci><ci id="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">\mathcal{N}(x_{i}|\mu_{k},\Sigma_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">caligraphic_N ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> is PDF of a multivariate normal distribution with mean <math alttext="\mu_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">μ</mi><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝜇</ci><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\mu_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and covariance <math alttext="\Sigma_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" mathvariant="normal" xref="S3.SS1.p1.12.m12.1.1.2.cmml">Σ</mi><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">Σ</ci><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\Sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.
The cluster parameters are learned by maximizing the log-likelihood using the Expectation-Maximization (EM) algorithm <cite class="ltx_cite ltx_citemacro_citep">(Moon, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib14" title="">1996</a>)</cite>, which iterates the two following steps until convergence, i.e., when the change in log-likelihood between consecutive iterations becomes negligibly small.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2"><span class="ltx_text ltx_font_bold" id="S3.SS1.p2.2.1">Expectation step:</span> Compute the posterior probability (responsibility) that the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_k</annotation></semantics></math>-th Gaussian component generated the data point <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑥</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\gamma(z_{ik})=\frac{\pi_{k}\mathcal{N}(x_{i}|\mu_{k},\Sigma_{k})}{\sum_{j=1}^%
{K}\pi_{j}\mathcal{N}(x_{i}|\mu_{j},\Sigma_{j})}," class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.3.cmml">γ</mi><mo id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mfrac id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.3.2.cmml">π</mi><mi id="S3.E1.m1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.3.3.cmml">k</mi></msub><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.4" xref="S3.E1.m1.1.1.1.4.cmml">𝒩</mi><mo id="S3.E1.m1.1.1.1.2a" xref="S3.E1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.1.1.1.4.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.2.2" mathvariant="normal" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.2.cmml">Σ</mi><mi id="S3.E1.m1.1.1.1.1.1.1.2.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.3.cmml">k</mi></msub></mrow></mrow><mo id="S3.E1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><msubsup id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml"><mo id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.2.2.2.2.2.3.2" xref="S3.E1.m1.2.2.2.2.2.3.2.cmml">j</mi><mo id="S3.E1.m1.2.2.2.2.2.3.1" xref="S3.E1.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.2.2.2.2.3.3" xref="S3.E1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.3.cmml">K</mi></msubsup><mrow id="S3.E1.m1.2.2.2.1" xref="S3.E1.m1.2.2.2.1.cmml"><msub id="S3.E1.m1.2.2.2.1.3" xref="S3.E1.m1.2.2.2.1.3.cmml"><mi id="S3.E1.m1.2.2.2.1.3.2" xref="S3.E1.m1.2.2.2.1.3.2.cmml">π</mi><mi id="S3.E1.m1.2.2.2.1.3.3" xref="S3.E1.m1.2.2.2.1.3.3.cmml">j</mi></msub><mo id="S3.E1.m1.2.2.2.1.2" xref="S3.E1.m1.2.2.2.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.1.4" xref="S3.E1.m1.2.2.2.1.4.cmml">𝒩</mi><mo id="S3.E1.m1.2.2.2.1.2a" xref="S3.E1.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.E1.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.E1.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.cmml"><msub id="S3.E1.m1.2.2.2.1.1.1.1.4" xref="S3.E1.m1.2.2.2.1.1.1.1.4.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.1.4.2" xref="S3.E1.m1.2.2.2.1.1.1.1.4.2.cmml">x</mi><mi id="S3.E1.m1.2.2.2.1.1.1.1.4.3" xref="S3.E1.m1.2.2.2.1.1.1.1.4.3.cmml">i</mi></msub><mo fence="false" id="S3.E1.m1.2.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.3.cmml">|</mo><mrow id="S3.E1.m1.2.2.2.1.1.1.1.2.2" xref="S3.E1.m1.2.2.2.1.1.1.1.2.3.cmml"><msub id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E1.m1.2.2.2.1.1.1.1.2.2.3" xref="S3.E1.m1.2.2.2.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.2.1.1.1.1.2.2.2" xref="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.2" mathvariant="normal" xref="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.2.cmml">Σ</mi><mi id="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.3" xref="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E1.m1.2.2.2.1.1.1.3" stretchy="false" xref="S3.E1.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.3">𝛾</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><divide id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2"></divide><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.3.2">𝜋</ci><ci id="S3.E1.m1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3">𝑘</ci></apply><ci id="S3.E1.m1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.4">𝒩</ci><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.4.3">𝑖</ci></apply><list id="S3.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.2">Σ</ci><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2.2.3">𝑘</ci></apply></list></apply></apply><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2">subscript</csymbol><sum id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"></sum><apply id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.3"><eq id="S3.E1.m1.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.2.2.2.2.2.3.1"></eq><ci id="S3.E1.m1.2.2.2.2.2.3.2.cmml" xref="S3.E1.m1.2.2.2.2.2.3.2">𝑗</ci><cn id="S3.E1.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.3">𝐾</ci></apply><apply id="S3.E1.m1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1"><times id="S3.E1.m1.2.2.2.1.2.cmml" xref="S3.E1.m1.2.2.2.1.2"></times><apply id="S3.E1.m1.2.2.2.1.3.cmml" xref="S3.E1.m1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.3.1.cmml" xref="S3.E1.m1.2.2.2.1.3">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.3.2.cmml" xref="S3.E1.m1.2.2.2.1.3.2">𝜋</ci><ci id="S3.E1.m1.2.2.2.1.3.3.cmml" xref="S3.E1.m1.2.2.2.1.3.3">𝑗</ci></apply><ci id="S3.E1.m1.2.2.2.1.4.cmml" xref="S3.E1.m1.2.2.2.1.4">𝒩</ci><apply id="S3.E1.m1.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.3">conditional</csymbol><apply id="S3.E1.m1.2.2.2.1.1.1.1.4.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.4.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.1.4.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.4.2">𝑥</ci><ci id="S3.E1.m1.2.2.2.1.1.1.1.4.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.4.3">𝑖</ci></apply><list id="S3.E1.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.2.2"><apply id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.2">Σ</ci><ci id="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.1.2.2.2.3">𝑗</ci></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\gamma(z_{ik})=\frac{\pi_{k}\mathcal{N}(x_{i}|\mu_{k},\Sigma_{k})}{\sum_{j=1}^%
{K}\pi_{j}\mathcal{N}(x_{i}|\mu_{j},\Sigma_{j})},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">italic_γ ( italic_z start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) = divide start_ARG italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT caligraphic_N ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_π start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT caligraphic_N ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_μ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , roman_Σ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.3"><span class="ltx_text ltx_font_bold" id="S3.SS1.p3.3.1">Maximization step:</span> Update the parameters <math alttext="\pi_{k}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">π</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝜋</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">\pi_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mu_{k}" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">μ</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝜇</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mu_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\Sigma_{k}" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" mathvariant="normal" xref="S3.SS1.p3.3.m3.1.1.2.cmml">Σ</mi><mi id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">Σ</ci><ci id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">\Sigma_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> by maximizing the expected log-likelihood given the responsibilities:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{k}=\frac{1}{n}\sum_{i=1}^{n}\gamma(z_{ik}),\quad\mu_{k}=\frac{\sum_{i=1}^%
{n}\gamma(z_{ik})x_{i}}{\sum_{i=1}^{n}\gamma(z_{ik})},\quad\Sigma_{k}=\frac{%
\sum_{i=1}^{n}\gamma(z_{ik})(x_{i}-\mu_{k})(x_{i}-\mu_{k})^{\top}}{\sum_{i=1}^%
{n}\gamma(z_{ik})}" class="ltx_Math" display="block" id="S3.E2.m1.8"><semantics id="S3.E2.m1.8a"><mrow id="S3.E2.m1.8.8.2" xref="S3.E2.m1.8.8.3.cmml"><mrow id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml"><msub id="S3.E2.m1.7.7.1.1.3" xref="S3.E2.m1.7.7.1.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.3.2" xref="S3.E2.m1.7.7.1.1.3.2.cmml">π</mi><mi id="S3.E2.m1.7.7.1.1.3.3" xref="S3.E2.m1.7.7.1.1.3.3.cmml">k</mi></msub><mo id="S3.E2.m1.7.7.1.1.2" xref="S3.E2.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.1.cmml"><mfrac id="S3.E2.m1.7.7.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.3.cmml"><mn id="S3.E2.m1.7.7.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.3.2.cmml">1</mn><mi id="S3.E2.m1.7.7.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.3.3.cmml">n</mi></mfrac><mo id="S3.E2.m1.7.7.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><munderover id="S3.E2.m1.7.7.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml"><mo id="S3.E2.m1.7.7.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E2.m1.7.7.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.2.2.3" xref="S3.E2.m1.7.7.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.2.2.3.2" xref="S3.E2.m1.7.7.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.7.7.1.1.1.1.2.2.3.1" xref="S3.E2.m1.7.7.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.7.7.1.1.1.1.2.2.3.3" xref="S3.E2.m1.7.7.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.7.7.1.1.1.1.2.3" xref="S3.E2.m1.7.7.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S3.E2.m1.7.7.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.3.cmml">γ</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.8.8.2.3" rspace="1.167em" xref="S3.E2.m1.8.8.3a.cmml">,</mo><mrow id="S3.E2.m1.8.8.2.2.2" xref="S3.E2.m1.8.8.2.2.3.cmml"><mrow id="S3.E2.m1.8.8.2.2.1.1" xref="S3.E2.m1.8.8.2.2.1.1.cmml"><msub id="S3.E2.m1.8.8.2.2.1.1.2" xref="S3.E2.m1.8.8.2.2.1.1.2.cmml"><mi id="S3.E2.m1.8.8.2.2.1.1.2.2" xref="S3.E2.m1.8.8.2.2.1.1.2.2.cmml">μ</mi><mi id="S3.E2.m1.8.8.2.2.1.1.2.3" xref="S3.E2.m1.8.8.2.2.1.1.2.3.cmml">k</mi></msub><mo id="S3.E2.m1.8.8.2.2.1.1.1" xref="S3.E2.m1.8.8.2.2.1.1.1.cmml">=</mo><mfrac id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.1.1.1.2.2.3" xref="S3.E2.m1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.2.2.3.2" xref="S3.E2.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.1.1.1.2.2.3.1" xref="S3.E2.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.1.1.1.2.2.3.3" xref="S3.E2.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.2.3.cmml">n</mi></msubsup><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml">γ</mi><mo id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.E2.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.1.1.1.1.2a" xref="S3.E2.m1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml"><mi id="S3.E2.m1.1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.1.4.2.cmml">x</mi><mi id="S3.E2.m1.1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.1.4.3.cmml">i</mi></msub></mrow></mrow><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><msubsup id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><mo id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml"><mi id="S3.E2.m1.2.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.2.2.2.2.2.3.1" xref="S3.E2.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.2.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">n</mi></msubsup><mrow id="S3.E2.m1.2.2.2.1" xref="S3.E2.m1.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.1.3" xref="S3.E2.m1.2.2.2.1.3.cmml">γ</mi><mo id="S3.E2.m1.2.2.2.1.2" xref="S3.E2.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.1.2.cmml">z</mi><mrow id="S3.E2.m1.2.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.1.3.2" xref="S3.E2.m1.2.2.2.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.2.2.2.1.1.1.1.3.1" xref="S3.E2.m1.2.2.2.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.2.2.2.1.1.1.1.3.3" xref="S3.E2.m1.2.2.2.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.E2.m1.2.2.2.1.1.1.3" stretchy="false" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E2.m1.8.8.2.2.2.3" rspace="1.167em" xref="S3.E2.m1.8.8.2.2.3a.cmml">,</mo><mrow id="S3.E2.m1.8.8.2.2.2.2" xref="S3.E2.m1.8.8.2.2.2.2.cmml"><msub id="S3.E2.m1.8.8.2.2.2.2.2" xref="S3.E2.m1.8.8.2.2.2.2.2.cmml"><mi id="S3.E2.m1.8.8.2.2.2.2.2.2" mathvariant="normal" xref="S3.E2.m1.8.8.2.2.2.2.2.2.cmml">Σ</mi><mi id="S3.E2.m1.8.8.2.2.2.2.2.3" xref="S3.E2.m1.8.8.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.E2.m1.8.8.2.2.2.2.1" xref="S3.E2.m1.8.8.2.2.2.2.1.cmml">=</mo><mfrac id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml"><mrow id="S3.E2.m1.5.5.3" xref="S3.E2.m1.5.5.3.cmml"><msubsup id="S3.E2.m1.5.5.3.4" xref="S3.E2.m1.5.5.3.4.cmml"><mo id="S3.E2.m1.5.5.3.4.2.2" xref="S3.E2.m1.5.5.3.4.2.2.cmml">∑</mo><mrow id="S3.E2.m1.5.5.3.4.2.3" xref="S3.E2.m1.5.5.3.4.2.3.cmml"><mi id="S3.E2.m1.5.5.3.4.2.3.2" xref="S3.E2.m1.5.5.3.4.2.3.2.cmml">i</mi><mo id="S3.E2.m1.5.5.3.4.2.3.1" xref="S3.E2.m1.5.5.3.4.2.3.1.cmml">=</mo><mn id="S3.E2.m1.5.5.3.4.2.3.3" xref="S3.E2.m1.5.5.3.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.5.5.3.4.3" xref="S3.E2.m1.5.5.3.4.3.cmml">n</mi></msubsup><mrow id="S3.E2.m1.5.5.3.3" xref="S3.E2.m1.5.5.3.3.cmml"><mi id="S3.E2.m1.5.5.3.3.5" xref="S3.E2.m1.5.5.3.3.5.cmml">γ</mi><mo id="S3.E2.m1.5.5.3.3.4" xref="S3.E2.m1.5.5.3.3.4.cmml">⁢</mo><mrow id="S3.E2.m1.3.3.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.E2.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.2.cmml">z</mi><mrow id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.3.3.1.1.1.1.1.3.1" xref="S3.E2.m1.3.3.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.3.3.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.E2.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.5.5.3.3.4a" xref="S3.E2.m1.5.5.3.3.4.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.2.2.2.1" xref="S3.E2.m1.4.4.2.2.2.1.1.cmml"><mo id="S3.E2.m1.4.4.2.2.2.1.2" stretchy="false" xref="S3.E2.m1.4.4.2.2.2.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.2.2.2.1.1" xref="S3.E2.m1.4.4.2.2.2.1.1.cmml"><msub id="S3.E2.m1.4.4.2.2.2.1.1.2" xref="S3.E2.m1.4.4.2.2.2.1.1.2.cmml"><mi id="S3.E2.m1.4.4.2.2.2.1.1.2.2" xref="S3.E2.m1.4.4.2.2.2.1.1.2.2.cmml">x</mi><mi id="S3.E2.m1.4.4.2.2.2.1.1.2.3" xref="S3.E2.m1.4.4.2.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.2.2.2.1.1.1" xref="S3.E2.m1.4.4.2.2.2.1.1.1.cmml">−</mo><msub id="S3.E2.m1.4.4.2.2.2.1.1.3" xref="S3.E2.m1.4.4.2.2.2.1.1.3.cmml"><mi id="S3.E2.m1.4.4.2.2.2.1.1.3.2" xref="S3.E2.m1.4.4.2.2.2.1.1.3.2.cmml">μ</mi><mi id="S3.E2.m1.4.4.2.2.2.1.1.3.3" xref="S3.E2.m1.4.4.2.2.2.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E2.m1.4.4.2.2.2.1.3" stretchy="false" xref="S3.E2.m1.4.4.2.2.2.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.5.5.3.3.4b" xref="S3.E2.m1.5.5.3.3.4.cmml">⁢</mo><msup id="S3.E2.m1.5.5.3.3.3" xref="S3.E2.m1.5.5.3.3.3.cmml"><mrow id="S3.E2.m1.5.5.3.3.3.1.1" xref="S3.E2.m1.5.5.3.3.3.1.1.1.cmml"><mo id="S3.E2.m1.5.5.3.3.3.1.1.2" stretchy="false" xref="S3.E2.m1.5.5.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.5.5.3.3.3.1.1.1" xref="S3.E2.m1.5.5.3.3.3.1.1.1.cmml"><msub id="S3.E2.m1.5.5.3.3.3.1.1.1.2" xref="S3.E2.m1.5.5.3.3.3.1.1.1.2.cmml"><mi id="S3.E2.m1.5.5.3.3.3.1.1.1.2.2" xref="S3.E2.m1.5.5.3.3.3.1.1.1.2.2.cmml">x</mi><mi id="S3.E2.m1.5.5.3.3.3.1.1.1.2.3" xref="S3.E2.m1.5.5.3.3.3.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.5.5.3.3.3.1.1.1.1" xref="S3.E2.m1.5.5.3.3.3.1.1.1.1.cmml">−</mo><msub id="S3.E2.m1.5.5.3.3.3.1.1.1.3" xref="S3.E2.m1.5.5.3.3.3.1.1.1.3.cmml"><mi id="S3.E2.m1.5.5.3.3.3.1.1.1.3.2" xref="S3.E2.m1.5.5.3.3.3.1.1.1.3.2.cmml">μ</mi><mi id="S3.E2.m1.5.5.3.3.3.1.1.1.3.3" xref="S3.E2.m1.5.5.3.3.3.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.E2.m1.5.5.3.3.3.1.1.3" stretchy="false" xref="S3.E2.m1.5.5.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.5.5.3.3.3.3" xref="S3.E2.m1.5.5.3.3.3.3.cmml">⊤</mo></msup></mrow></mrow><mrow id="S3.E2.m1.6.6.4" xref="S3.E2.m1.6.6.4.cmml"><msubsup id="S3.E2.m1.6.6.4.2" xref="S3.E2.m1.6.6.4.2.cmml"><mo id="S3.E2.m1.6.6.4.2.2.2" xref="S3.E2.m1.6.6.4.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.6.6.4.2.2.3" xref="S3.E2.m1.6.6.4.2.2.3.cmml"><mi id="S3.E2.m1.6.6.4.2.2.3.2" xref="S3.E2.m1.6.6.4.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.6.6.4.2.2.3.1" xref="S3.E2.m1.6.6.4.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.6.6.4.2.2.3.3" xref="S3.E2.m1.6.6.4.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.6.6.4.2.3" xref="S3.E2.m1.6.6.4.2.3.cmml">n</mi></msubsup><mrow id="S3.E2.m1.6.6.4.1" xref="S3.E2.m1.6.6.4.1.cmml"><mi id="S3.E2.m1.6.6.4.1.3" xref="S3.E2.m1.6.6.4.1.3.cmml">γ</mi><mo id="S3.E2.m1.6.6.4.1.2" xref="S3.E2.m1.6.6.4.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.4.1.1.1" xref="S3.E2.m1.6.6.4.1.1.1.1.cmml"><mo id="S3.E2.m1.6.6.4.1.1.1.2" stretchy="false" xref="S3.E2.m1.6.6.4.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.6.6.4.1.1.1.1" xref="S3.E2.m1.6.6.4.1.1.1.1.cmml"><mi id="S3.E2.m1.6.6.4.1.1.1.1.2" xref="S3.E2.m1.6.6.4.1.1.1.1.2.cmml">z</mi><mrow id="S3.E2.m1.6.6.4.1.1.1.1.3" xref="S3.E2.m1.6.6.4.1.1.1.1.3.cmml"><mi id="S3.E2.m1.6.6.4.1.1.1.1.3.2" xref="S3.E2.m1.6.6.4.1.1.1.1.3.2.cmml">i</mi><mo id="S3.E2.m1.6.6.4.1.1.1.1.3.1" xref="S3.E2.m1.6.6.4.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.E2.m1.6.6.4.1.1.1.1.3.3" xref="S3.E2.m1.6.6.4.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.E2.m1.6.6.4.1.1.1.3" stretchy="false" xref="S3.E2.m1.6.6.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.8b"><apply id="S3.E2.m1.8.8.3.cmml" xref="S3.E2.m1.8.8.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.3a.cmml" xref="S3.E2.m1.8.8.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1.1"><eq id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.2"></eq><apply id="S3.E2.m1.7.7.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2">𝜋</ci><ci id="S3.E2.m1.7.7.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.3.3">𝑘</ci></apply><apply id="S3.E2.m1.7.7.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1"><times id="S3.E2.m1.7.7.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.2"></times><apply id="S3.E2.m1.7.7.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.3"><divide id="S3.E2.m1.7.7.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.3"></divide><cn id="S3.E2.m1.7.7.1.1.1.3.2.cmml" type="integer" xref="S3.E2.m1.7.7.1.1.1.3.2">1</cn><ci id="S3.E2.m1.7.7.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E2.m1.7.7.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1"><apply id="S3.E2.m1.7.7.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.7.7.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.7.7.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.7.7.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.2.3"><eq id="S3.E2.m1.7.7.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.7.7.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E2.m1.7.7.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.7.7.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.7.7.1.1.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2.3">𝑛</ci></apply><apply id="S3.E2.m1.7.7.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1"><times id="S3.E2.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.2"></times><ci id="S3.E2.m1.7.7.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.3">𝛾</ci><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3"><times id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.8.8.2.2.3.cmml" xref="S3.E2.m1.8.8.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.3a.cmml" xref="S3.E2.m1.8.8.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.8.8.2.2.1.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1"><eq id="S3.E2.m1.8.8.2.2.1.1.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1.1"></eq><apply id="S3.E2.m1.8.8.2.2.1.1.2.cmml" xref="S3.E2.m1.8.8.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.1.1.2.1.cmml" xref="S3.E2.m1.8.8.2.2.1.1.2">subscript</csymbol><ci id="S3.E2.m1.8.8.2.2.1.1.2.2.cmml" xref="S3.E2.m1.8.8.2.2.1.1.2.2">𝜇</ci><ci id="S3.E2.m1.8.8.2.2.1.1.2.3.cmml" xref="S3.E2.m1.8.8.2.2.1.1.2.3">𝑘</ci></apply><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><divide id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2"></divide><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.2.2.3"><eq id="S3.E2.m1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E2.m1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.2.3">𝑛</ci></apply><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3">𝛾</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3"><times id="S3.E2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.1.4.2">𝑥</ci><ci id="S3.E2.m1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2">subscript</csymbol><sum id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"></sum><apply id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3"><eq id="S3.E2.m1.2.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.3.1"></eq><ci id="S3.E2.m1.2.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.3.2">𝑖</ci><cn id="S3.E2.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3">𝑛</ci></apply><apply id="S3.E2.m1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.1"><times id="S3.E2.m1.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.1.2"></times><ci id="S3.E2.m1.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.1.3">𝛾</ci><apply id="S3.E2.m1.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3"><times id="S3.E2.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3.1"></times><ci id="S3.E2.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3.2">𝑖</ci><ci id="S3.E2.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E2.m1.8.8.2.2.2.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2"><eq id="S3.E2.m1.8.8.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.2.2.2.2.1"></eq><apply id="S3.E2.m1.8.8.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.8.8.2.2.2.2.2.1.cmml" xref="S3.E2.m1.8.8.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.8.8.2.2.2.2.2.2.cmml" xref="S3.E2.m1.8.8.2.2.2.2.2.2">Σ</ci><ci id="S3.E2.m1.8.8.2.2.2.2.2.3.cmml" xref="S3.E2.m1.8.8.2.2.2.2.2.3">𝑘</ci></apply><apply id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6"><divide id="S3.E2.m1.6.6.5.cmml" xref="S3.E2.m1.6.6"></divide><apply id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.3"><apply id="S3.E2.m1.5.5.3.4.cmml" xref="S3.E2.m1.5.5.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.4.1.cmml" xref="S3.E2.m1.5.5.3.4">superscript</csymbol><apply id="S3.E2.m1.5.5.3.4.2.cmml" xref="S3.E2.m1.5.5.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.4.2.1.cmml" xref="S3.E2.m1.5.5.3.4">subscript</csymbol><sum id="S3.E2.m1.5.5.3.4.2.2.cmml" xref="S3.E2.m1.5.5.3.4.2.2"></sum><apply id="S3.E2.m1.5.5.3.4.2.3.cmml" xref="S3.E2.m1.5.5.3.4.2.3"><eq id="S3.E2.m1.5.5.3.4.2.3.1.cmml" xref="S3.E2.m1.5.5.3.4.2.3.1"></eq><ci id="S3.E2.m1.5.5.3.4.2.3.2.cmml" xref="S3.E2.m1.5.5.3.4.2.3.2">𝑖</ci><cn id="S3.E2.m1.5.5.3.4.2.3.3.cmml" type="integer" xref="S3.E2.m1.5.5.3.4.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.5.5.3.4.3.cmml" xref="S3.E2.m1.5.5.3.4.3">𝑛</ci></apply><apply id="S3.E2.m1.5.5.3.3.cmml" xref="S3.E2.m1.5.5.3.3"><times id="S3.E2.m1.5.5.3.3.4.cmml" xref="S3.E2.m1.5.5.3.3.4"></times><ci id="S3.E2.m1.5.5.3.3.5.cmml" xref="S3.E2.m1.5.5.3.3.5">𝛾</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3"><times id="S3.E2.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3.2">𝑖</ci><ci id="S3.E2.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.4.4.2.2.2.1.1.cmml" xref="S3.E2.m1.4.4.2.2.2.1"><minus id="S3.E2.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.1"></minus><apply id="S3.E2.m1.4.4.2.2.2.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.2.2">𝑥</ci><ci id="S3.E2.m1.4.4.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.4.4.2.2.2.1.1.3.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.3.2">𝜇</ci><ci id="S3.E2.m1.4.4.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.4.4.2.2.2.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.E2.m1.5.5.3.3.3.cmml" xref="S3.E2.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.3.3.2.cmml" xref="S3.E2.m1.5.5.3.3.3">superscript</csymbol><apply id="S3.E2.m1.5.5.3.3.3.1.1.1.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1"><minus id="S3.E2.m1.5.5.3.3.3.1.1.1.1.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.1"></minus><apply id="S3.E2.m1.5.5.3.3.3.1.1.1.2.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.3.3.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.5.5.3.3.3.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.2.2">𝑥</ci><ci id="S3.E2.m1.5.5.3.3.3.1.1.1.2.3.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.5.5.3.3.3.1.1.1.3.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.3.3.3.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.3.3.3.1.1.1.3.2.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.3.2">𝜇</ci><ci id="S3.E2.m1.5.5.3.3.3.1.1.1.3.3.cmml" xref="S3.E2.m1.5.5.3.3.3.1.1.1.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="S3.E2.m1.5.5.3.3.3.3.cmml" xref="S3.E2.m1.5.5.3.3.3.3">top</csymbol></apply></apply></apply><apply id="S3.E2.m1.6.6.4.cmml" xref="S3.E2.m1.6.6.4"><apply id="S3.E2.m1.6.6.4.2.cmml" xref="S3.E2.m1.6.6.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.4.2.1.cmml" xref="S3.E2.m1.6.6.4.2">superscript</csymbol><apply id="S3.E2.m1.6.6.4.2.2.cmml" xref="S3.E2.m1.6.6.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.4.2.2.1.cmml" xref="S3.E2.m1.6.6.4.2">subscript</csymbol><sum id="S3.E2.m1.6.6.4.2.2.2.cmml" xref="S3.E2.m1.6.6.4.2.2.2"></sum><apply id="S3.E2.m1.6.6.4.2.2.3.cmml" xref="S3.E2.m1.6.6.4.2.2.3"><eq id="S3.E2.m1.6.6.4.2.2.3.1.cmml" xref="S3.E2.m1.6.6.4.2.2.3.1"></eq><ci id="S3.E2.m1.6.6.4.2.2.3.2.cmml" xref="S3.E2.m1.6.6.4.2.2.3.2">𝑖</ci><cn id="S3.E2.m1.6.6.4.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.6.6.4.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.6.6.4.2.3.cmml" xref="S3.E2.m1.6.6.4.2.3">𝑛</ci></apply><apply id="S3.E2.m1.6.6.4.1.cmml" xref="S3.E2.m1.6.6.4.1"><times id="S3.E2.m1.6.6.4.1.2.cmml" xref="S3.E2.m1.6.6.4.1.2"></times><ci id="S3.E2.m1.6.6.4.1.3.cmml" xref="S3.E2.m1.6.6.4.1.3">𝛾</ci><apply id="S3.E2.m1.6.6.4.1.1.1.1.cmml" xref="S3.E2.m1.6.6.4.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.4.1.1.1.1.1.cmml" xref="S3.E2.m1.6.6.4.1.1.1">subscript</csymbol><ci id="S3.E2.m1.6.6.4.1.1.1.1.2.cmml" xref="S3.E2.m1.6.6.4.1.1.1.1.2">𝑧</ci><apply id="S3.E2.m1.6.6.4.1.1.1.1.3.cmml" xref="S3.E2.m1.6.6.4.1.1.1.1.3"><times id="S3.E2.m1.6.6.4.1.1.1.1.3.1.cmml" xref="S3.E2.m1.6.6.4.1.1.1.1.3.1"></times><ci id="S3.E2.m1.6.6.4.1.1.1.1.3.2.cmml" xref="S3.E2.m1.6.6.4.1.1.1.1.3.2">𝑖</ci><ci id="S3.E2.m1.6.6.4.1.1.1.1.3.3.cmml" xref="S3.E2.m1.6.6.4.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.8c">\pi_{k}=\frac{1}{n}\sum_{i=1}^{n}\gamma(z_{ik}),\quad\mu_{k}=\frac{\sum_{i=1}^%
{n}\gamma(z_{ik})x_{i}}{\sum_{i=1}^{n}\gamma(z_{ik})},\quad\Sigma_{k}=\frac{%
\sum_{i=1}^{n}\gamma(z_{ik})(x_{i}-\mu_{k})(x_{i}-\mu_{k})^{\top}}{\sum_{i=1}^%
{n}\gamma(z_{ik})}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.8d">italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ( italic_z start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) , italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ( italic_z start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ( italic_z start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) end_ARG , roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = divide start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ( italic_z start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_γ ( italic_z start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Dimensionality Reduction with UMAP</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Clustering algorithms often struggle with the curse of dimensionality, where data becomes sparse, and distances between points lose distinction in high dimensions.
To address this, Uniform Manifold Approximation and Projection (UMAP) <cite class="ltx_cite ltx_citemacro_citep">(McInnes et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib13" title="">2018</a>)</cite> reduces the dimensionality of embeddings, significantly enhancing clustering performance <cite class="ltx_cite ltx_citemacro_citep">(Allaoui et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib1" title="">2020</a>)</cite>.
UMAP learns a low-dimensional representation that preserves both local and global structures, with the key parameter <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.1">n_neighbors</span> controlling the trade-off between local and global structure preservation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Recursive-Abstractive Tree Construction</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The process of building the recursive-abstractive tree is outlined first, as it is key to understanding our new algorithms.
The construction, based on <cite class="ltx_cite ltx_citemacro_citet">Sarthi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib21" title="">2024</a>)</cite> with minor adjustments, consists of four steps: dataset chunking, clustering, summarizing, and recursive construction.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Dataset Chunking</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.1">Given a dataset, the first step is to divide the text into sentences using the NLTK Punkt Sentence Tokenizer<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.nltk.org/api/nltk.tokenize.punkt.html" title="">https://www.nltk.org/api/nltk.tokenize.punkt.html</a></span></span></span>.
These sentences are then grouped into chunks of up to 250 tokens, with a 50-token overlap between consecutive chunks, resulting in chunks of up to 300 tokens.
To maintain coherence, sentences are kept intact between chunks: if a sentence exceeds 250 tokens, it is included in the next chunk.
Sentences longer than 250 tokens are split at punctuation marks.
Token counts are determined using the <span class="ltx_text ltx_font_typewriter" id="S3.SS3.SSS0.Px1.p1.1.1">cl100k_base</span> tokenizer from the <span class="ltx_text ltx_font_typewriter" id="S3.SS3.SSS0.Px1.p1.1.2">tiktoken<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote2.1.1.1">2</span></span><a class="ltx_ref ltx_url" href="https://github.com/openai/tiktoken" title="">https://github.com/openai/tiktoken</a></span></span></span></span> library.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p2.1">Note that we use 250 tokens with a 50-token overlap instead of the 100-token chunks used by <cite class="ltx_cite ltx_citemacro_citep">(Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib21" title="">2024</a>)</cite>. Preliminary experiments (not included in this work) suggest that the larger chunk size with overlap improves output quality.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Clustering</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p1.6">The goal is to group <math alttext="n" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.1.m1.1d">italic_n</annotation></semantics></math> chunks <math alttext="c_{1},\dots,c_{n}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.2.m2.3"><semantics id="S3.SS3.SSS0.Px2.p1.2.m2.3a"><mrow id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.3.cmml"><msub id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml">c</mi><mn id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.4" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2.cmml">c</mi><mi id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.2.m2.3b"><list id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2"><apply id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.2">𝑐</ci><cn id="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.2">𝑐</ci><ci id="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.2.m2.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.2.m2.3c">c_{1},\dots,c_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.2.m2.3d">italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> into <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS3.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS3.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.3.m3.1d">italic_k</annotation></semantics></math> clusters <math alttext="C_{1},\dots,C_{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.4.m4.3"><semantics id="S3.SS3.SSS0.Px2.p1.4.m4.3a"><mrow id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.3.cmml"><msub id="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1" xref="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.2.cmml">C</mi><mn id="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.3" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.4.m4.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.4" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.2" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.2.cmml">C</mi><mi id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.4.m4.3b"><list id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2"><apply id="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.2">𝐶</ci><cn id="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.4.m4.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.2">𝐶</ci><ci id="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.4.m4.3.3.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.4.m4.3c">C_{1},\dots,C_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.4.m4.3d">italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS3.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS3.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS3.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.5.m5.1d">italic_k</annotation></semantics></math> is to be determined.
Clustering is performed on the embeddings, not the raw text. So, using an encoder model, embeddings <math alttext="v_{1},\dots,v_{n}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p1.6.m6.3"><semantics id="S3.SS3.SSS0.Px2.p1.6.m6.3a"><mrow id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.3.cmml"><msub id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2.cmml">v</mi><mn id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p1.6.m6.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.4" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.3.cmml">,</mo><msub id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.2" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.2.cmml">v</mi><mi id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p1.6.m6.3b"><list id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2"><apply id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.2">𝑣</ci><cn id="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p1.6.m6.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.2">𝑣</ci><ci id="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p1.6.m6.3.3.2.2.3">𝑛</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p1.6.m6.3c">v_{1},\dots,v_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p1.6.m6.3d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> are generated for the chunks.
Then, dimensionality reduction is performed using UMAP, followed by clustering with Gaussian Mixture Models (GMMs). This process is repeated twice, varying UMAP’s <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS0.Px2.p1.6.1">n_neighbors</span> parameter to create a hierarchical clustering, an approach shown to be effective for this task <cite class="ltx_cite ltx_citemacro_citep">(Sarthi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib21" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS3.SSS0.Px2.p2.9">First, <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS0.Px2.p2.9.1">n_neighbors</span> is set to <math alttext="\sqrt{n}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS3.SSS0.Px2.p2.1.m1.1a"><msqrt id="S3.SS3.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.cmml">n</mi></msqrt><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1"><root id="S3.SS3.SSS0.Px2.p2.1.m1.1.1a.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1"></root><ci id="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.1.m1.1.1.2">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.1.m1.1c">\sqrt{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.1.m1.1d">square-root start_ARG italic_n end_ARG</annotation></semantics></math>, generating 10-dimensional embeddings <math alttext="v_{1}^{g},\dots,v_{n}^{g}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.2.m2.3"><semantics id="S3.SS3.SSS0.Px2.p2.2.m2.3a"><mrow id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.3.cmml"><msubsup id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.2" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.2.cmml">v</mi><mn id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.3" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.3.cmml">g</mi></msubsup><mo id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.3" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p2.2.m2.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p2.2.m2.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.4" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.3.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.2" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.cmml">v</mi><mi id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.3" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.3.cmml">n</mi><mi id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.3.cmml">g</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.2.m2.3b"><list id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2"><apply id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.2">𝑣</ci><cn id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.2.2.1.1.3">𝑔</ci></apply><ci id="S3.SS3.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.2">𝑣</ci><ci id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.2.3">𝑛</ci></apply><ci id="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.2.m2.3.3.2.2.3">𝑔</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.2.m2.3c">v_{1}^{g},\dots,v_{n}^{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.2.m2.3d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT</annotation></semantics></math>.
GMMs are then applied, yielding global clusters <math alttext="C_{1}^{g},\dots,C_{k_{g}}^{g}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.3.m3.3"><semantics id="S3.SS3.SSS0.Px2.p2.3.m3.3a"><mrow id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.3.cmml"><msubsup id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.2" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.2.cmml">C</mi><mn id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.3" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.3.cmml">g</mi></msubsup><mo id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.3" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p2.3.m3.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p2.3.m3.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.4" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.3.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.2" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.2.cmml">C</mi><msub id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.2" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.2.cmml">k</mi><mi id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.3" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.3.cmml">g</mi></msub><mi id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.3.cmml">g</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.3.m3.3b"><list id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2"><apply id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.2">𝐶</ci><cn id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.2.2.1.1.3">𝑔</ci></apply><ci id="S3.SS3.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.2">𝐶</ci><apply id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.2">𝑘</ci><ci id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.2.3.3">𝑔</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.3.m3.3.3.2.2.3">𝑔</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.3.m3.3c">C_{1}^{g},\dots,C_{k_{g}}^{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.3.m3.3d">italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT , … , italic_C start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT</annotation></semantics></math>.
Next, refinement occurs within each global cluster. UMAP is applied with <span class="ltx_text ltx_font_italic" id="S3.SS3.SSS0.Px2.p2.9.2">n_neighbors</span> set to 10, resulting in reduced embeddings <math alttext="v_{1}^{l},\dots,v_{m}^{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.4.m4.3"><semantics id="S3.SS3.SSS0.Px2.p2.4.m4.3a"><mrow id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.3.cmml"><msubsup id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.2" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.2.cmml">v</mi><mn id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.3" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.3.cmml">l</mi></msubsup><mo id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.3" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p2.4.m4.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.4" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.3.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.2" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.2.cmml">v</mi><mi id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.3" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.3.cmml">m</mi><mi id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.3.cmml">l</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.4.m4.3b"><list id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2"><apply id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.2">𝑣</ci><cn id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.2.2.1.1.3">𝑙</ci></apply><ci id="S3.SS3.SSS0.Px2.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.2">𝑣</ci><ci id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.2.3">𝑚</ci></apply><ci id="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.4.m4.3.3.2.2.3">𝑙</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.4.m4.3c">v_{1}^{l},\dots,v_{m}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.4.m4.3d">italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="m" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.5.m5.1"><semantics id="S3.SS3.SSS0.Px2.p2.5.m5.1a"><mi id="S3.SS3.SSS0.Px2.p2.5.m5.1.1" xref="S3.SS3.SSS0.Px2.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.5.m5.1b"><ci id="S3.SS3.SSS0.Px2.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.5.m5.1c">m</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.5.m5.1d">italic_m</annotation></semantics></math> is the size of the current global cluster.
GMMs are then used to form local clusters <math alttext="C_{1}^{l},\dots,C_{k_{l}}^{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.6.m6.3"><semantics id="S3.SS3.SSS0.Px2.p2.6.m6.3a"><mrow id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.3.cmml"><msubsup id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.2" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.2.cmml">C</mi><mn id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.3" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.3.cmml">1</mn><mi id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.3" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.3.cmml">l</mi></msubsup><mo id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.3" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.3.cmml">,</mo><mi id="S3.SS3.SSS0.Px2.p2.6.m6.1.1" mathvariant="normal" xref="S3.SS3.SSS0.Px2.p2.6.m6.1.1.cmml">…</mi><mo id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.4" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.3.cmml">,</mo><msubsup id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.cmml"><mi id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.2" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.2.cmml">C</mi><msub id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.2" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.2.cmml">k</mi><mi id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.3" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.3.cmml">l</mi></msub><mi id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.3" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.3.cmml">l</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.6.m6.3b"><list id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2"><apply id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.2">𝐶</ci><cn id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.2.3">1</cn></apply><ci id="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.2.2.1.1.3">𝑙</ci></apply><ci id="S3.SS3.SSS0.Px2.p2.6.m6.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.1.1">…</ci><apply id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2">superscript</csymbol><apply id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.2">𝐶</ci><apply id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.1.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.2">𝑘</ci><ci id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.2.3.3">𝑙</ci></apply></apply><ci id="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.3.cmml" xref="S3.SS3.SSS0.Px2.p2.6.m6.3.3.2.2.3">𝑙</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.6.m6.3c">C_{1}^{l},\dots,C_{k_{l}}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.6.m6.3d">italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , … , italic_C start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math>. The final clustering is the union of all local clusters.
To determine <math alttext="k_{g}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.7.m7.1"><semantics id="S3.SS3.SSS0.Px2.p2.7.m7.1a"><msub id="S3.SS3.SSS0.Px2.p2.7.m7.1.1" xref="S3.SS3.SSS0.Px2.p2.7.m7.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.7.m7.1.1.2" xref="S3.SS3.SSS0.Px2.p2.7.m7.1.1.2.cmml">k</mi><mi id="S3.SS3.SSS0.Px2.p2.7.m7.1.1.3" xref="S3.SS3.SSS0.Px2.p2.7.m7.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.7.m7.1b"><apply id="S3.SS3.SSS0.Px2.p2.7.m7.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.7.m7.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.7.m7.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.7.m7.1.1.2">𝑘</ci><ci id="S3.SS3.SSS0.Px2.p2.7.m7.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.7.m7.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.7.m7.1c">k_{g}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.7.m7.1d">italic_k start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, values from 1 to <math alttext="\max(50,\sqrt{n})" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.8.m8.3"><semantics id="S3.SS3.SSS0.Px2.p2.8.m8.3a"><mrow id="S3.SS3.SSS0.Px2.p2.8.m8.3.4.2" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.4.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.8.m8.1.1" xref="S3.SS3.SSS0.Px2.p2.8.m8.1.1.cmml">max</mi><mo id="S3.SS3.SSS0.Px2.p2.8.m8.3.4.2a" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.4.1.cmml">⁡</mo><mrow id="S3.SS3.SSS0.Px2.p2.8.m8.3.4.2.1" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.4.1.cmml"><mo id="S3.SS3.SSS0.Px2.p2.8.m8.3.4.2.1.1" stretchy="false" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.4.1.cmml">(</mo><mn id="S3.SS3.SSS0.Px2.p2.8.m8.2.2" xref="S3.SS3.SSS0.Px2.p2.8.m8.2.2.cmml">50</mn><mo id="S3.SS3.SSS0.Px2.p2.8.m8.3.4.2.1.2" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.4.1.cmml">,</mo><msqrt id="S3.SS3.SSS0.Px2.p2.8.m8.3.3" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.3.cmml"><mi id="S3.SS3.SSS0.Px2.p2.8.m8.3.3.2" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.3.2.cmml">n</mi></msqrt><mo id="S3.SS3.SSS0.Px2.p2.8.m8.3.4.2.1.3" stretchy="false" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.8.m8.3b"><apply id="S3.SS3.SSS0.Px2.p2.8.m8.3.4.1.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.4.2"><max id="S3.SS3.SSS0.Px2.p2.8.m8.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m8.1.1"></max><cn id="S3.SS3.SSS0.Px2.p2.8.m8.2.2.cmml" type="integer" xref="S3.SS3.SSS0.Px2.p2.8.m8.2.2">50</cn><apply id="S3.SS3.SSS0.Px2.p2.8.m8.3.3.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.3"><root id="S3.SS3.SSS0.Px2.p2.8.m8.3.3a.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.3"></root><ci id="S3.SS3.SSS0.Px2.p2.8.m8.3.3.2.cmml" xref="S3.SS3.SSS0.Px2.p2.8.m8.3.3.2">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.8.m8.3c">\max(50,\sqrt{n})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.8.m8.3d">roman_max ( 50 , square-root start_ARG italic_n end_ARG )</annotation></semantics></math> are evaluated, and we select the value that minimizes the Bayesian Information Criterion (BIC) <cite class="ltx_cite ltx_citemacro_citep">(Schwarz, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib22" title="">1978</a>)</cite>. A similar approach is used to determine <math alttext="k_{l}" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px2.p2.9.m9.1"><semantics id="S3.SS3.SSS0.Px2.p2.9.m9.1a"><msub id="S3.SS3.SSS0.Px2.p2.9.m9.1.1" xref="S3.SS3.SSS0.Px2.p2.9.m9.1.1.cmml"><mi id="S3.SS3.SSS0.Px2.p2.9.m9.1.1.2" xref="S3.SS3.SSS0.Px2.p2.9.m9.1.1.2.cmml">k</mi><mi id="S3.SS3.SSS0.Px2.p2.9.m9.1.1.3" xref="S3.SS3.SSS0.Px2.p2.9.m9.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px2.p2.9.m9.1b"><apply id="S3.SS3.SSS0.Px2.p2.9.m9.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px2.p2.9.m9.1.1.1.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.SSS0.Px2.p2.9.m9.1.1.2.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m9.1.1.2">𝑘</ci><ci id="S3.SS3.SSS0.Px2.p2.9.m9.1.1.3.cmml" xref="S3.SS3.SSS0.Px2.p2.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px2.p2.9.m9.1c">k_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px2.p2.9.m9.1d">italic_k start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Summarizing</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px3.p1.1">After clustering, a large language model generates summaries for each cluster, providing a concise overview of the content.
The summary length is limited to 1,000 tokens to ensure the summaries remain manageable.
The specific prompt used for summarization is provided in the appendix (Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7.T4" title="Table 4 ‣ Appendix G Prompts ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Recursive Construction</h4>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px4.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px4.p1.1">The clustering and summarization process is repeated recursively to obtain a multi-layered representation of the dataset.
This approach is outlined in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg1" title="Algorithm 1 ‣ Recursive Construction ‣ 3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Recursive-Abstractive Tree Construction</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg1.l1.1">Input:</span> Dataset

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg1.l2.1">Output:</span> Recursive-Abstractive Tree

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Chunk the dataset, initializing the leaf nodes as these chunks.

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span><span class="ltx_text ltx_font_bold" id="alg1.l4.1">while</span> the top layer contains more than 10 nodes <span class="ltx_text ltx_font_bold" id="alg1.l4.2">and</span> there are fewer than 5 layers <span class="ltx_text ltx_font_bold" id="alg1.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     Compute embeddings for the nodes in the top layer.

</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     Apply the two-step clustering process to group these nodes.

</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     Generate a summary for each cluster.

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     Form a new layer with one new node per cluster.

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span><span class="ltx_text ltx_font_bold" id="alg1.l9.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l9.2">while</span>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Retrieving Documents</h3>
<div class="ltx_para ltx_noindent" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Given a query and a tree constructed over a relevant dataset, the goal is to retrieve <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_k</annotation></semantics></math> documents that are helpful in answering the query.
<cite class="ltx_cite ltx_citemacro_citet">Sarthi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib21" title="">2024</a>)</cite> compared tree-based retrieval with a collapsed-tree approach, where all nodes are considered simultaneously. The latter performed better, and is the method used in our experiments.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">In the collapsed-tree approach, the tree is flattened, and the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><mi id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">italic_k</annotation></semantics></math> most similar documents are retrieved using cosine similarity on the embeddings.
This method can be seen as augmenting the dataset with document summaries, followed by applying naïve RAG to the expanded dataset.
The pseudo-code for the retrieval algorithm is provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A1" title="Appendix A Pseudocodes ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>adRAP: Adaptive Recursive-Abstractive Processing</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Overview</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.9">The problem we are addressing can be formally described as follows.
Let <math alttext="T_{0}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">T</mi><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑇</ci><cn id="S4.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">T_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> represent a recursive-abstractive tree built on an initial dataset <math alttext="D_{0}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><msub id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">D</mi><mn id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝐷</ci><cn id="S4.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">D_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>.
Given an updated dataset <math alttext="D=D_{0}\cup D_{1}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">D</mi><mo id="S4.SS1.p1.3.m3.1.1.1" xref="S4.SS1.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml"><msub id="S4.SS1.p1.3.m3.1.1.3.2" xref="S4.SS1.p1.3.m3.1.1.3.2.cmml"><mi id="S4.SS1.p1.3.m3.1.1.3.2.2" xref="S4.SS1.p1.3.m3.1.1.3.2.2.cmml">D</mi><mn id="S4.SS1.p1.3.m3.1.1.3.2.3" xref="S4.SS1.p1.3.m3.1.1.3.2.3.cmml">0</mn></msub><mo id="S4.SS1.p1.3.m3.1.1.3.1" xref="S4.SS1.p1.3.m3.1.1.3.1.cmml">∪</mo><msub id="S4.SS1.p1.3.m3.1.1.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.cmml"><mi id="S4.SS1.p1.3.m3.1.1.3.3.2" xref="S4.SS1.p1.3.m3.1.1.3.3.2.cmml">D</mi><mn id="S4.SS1.p1.3.m3.1.1.3.3.3" xref="S4.SS1.p1.3.m3.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><eq id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1.1"></eq><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝐷</ci><apply id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3"><union id="S4.SS1.p1.3.m3.1.1.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.1"></union><apply id="S4.SS1.p1.3.m3.1.1.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.3.2.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.3.2.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.2.2">𝐷</ci><cn id="S4.SS1.p1.3.m3.1.1.3.2.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3.2.3">0</cn></apply><apply id="S4.SS1.p1.3.m3.1.1.3.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS1.p1.3.m3.1.1.3.3.2">𝐷</ci><cn id="S4.SS1.p1.3.m3.1.1.3.3.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">D=D_{0}\cup D_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_D = italic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∪ italic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="|D_{0}|\gg|D_{1}|" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.2"><semantics id="S4.SS1.p1.4.m4.2a"><mrow id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml"><mrow id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.2.cmml"><mo id="S4.SS1.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.1.2.1.cmml">|</mo><msub id="S4.SS1.p1.4.m4.1.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.1.1.2" xref="S4.SS1.p1.4.m4.1.1.1.1.1.2.cmml">D</mi><mn id="S4.SS1.p1.4.m4.1.1.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS1.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.4.m4.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS1.p1.4.m4.2.2.3" xref="S4.SS1.p1.4.m4.2.2.3.cmml">≫</mo><mrow id="S4.SS1.p1.4.m4.2.2.2.1" xref="S4.SS1.p1.4.m4.2.2.2.2.cmml"><mo id="S4.SS1.p1.4.m4.2.2.2.1.2" stretchy="false" xref="S4.SS1.p1.4.m4.2.2.2.2.1.cmml">|</mo><msub id="S4.SS1.p1.4.m4.2.2.2.1.1" xref="S4.SS1.p1.4.m4.2.2.2.1.1.cmml"><mi id="S4.SS1.p1.4.m4.2.2.2.1.1.2" xref="S4.SS1.p1.4.m4.2.2.2.1.1.2.cmml">D</mi><mn id="S4.SS1.p1.4.m4.2.2.2.1.1.3" xref="S4.SS1.p1.4.m4.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p1.4.m4.2.2.2.1.3" stretchy="false" xref="S4.SS1.p1.4.m4.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><apply id="S4.SS1.p1.4.m4.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2"><csymbol cd="latexml" id="S4.SS1.p1.4.m4.2.2.3.cmml" xref="S4.SS1.p1.4.m4.2.2.3">much-greater-than</csymbol><apply id="S4.SS1.p1.4.m4.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1"><abs id="S4.SS1.p1.4.m4.1.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2"></abs><apply id="S4.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.1.2">𝐷</ci><cn id="S4.SS1.p1.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.1.1.1.1.1.3">0</cn></apply></apply><apply id="S4.SS1.p1.4.m4.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.1"><abs id="S4.SS1.p1.4.m4.2.2.2.2.1.cmml" xref="S4.SS1.p1.4.m4.2.2.2.1.2"></abs><apply id="S4.SS1.p1.4.m4.2.2.2.1.1.cmml" xref="S4.SS1.p1.4.m4.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.2.2.2.1.1.1.cmml" xref="S4.SS1.p1.4.m4.2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.2.2.2.1.1.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.1.1.2">𝐷</ci><cn id="S4.SS1.p1.4.m4.2.2.2.1.1.3.cmml" type="integer" xref="S4.SS1.p1.4.m4.2.2.2.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">|D_{0}|\gg|D_{1}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.2d">| italic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | ≫ | italic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT |</annotation></semantics></math>, let <math alttext="T" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_T</annotation></semantics></math> be the tree constructed over <math alttext="D" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_D</annotation></semantics></math>.
The goal is to efficiently update <math alttext="T_{0}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1"><semantics id="S4.SS1.p1.7.m7.1a"><msub id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2" xref="S4.SS1.p1.7.m7.1.1.2.cmml">T</mi><mn id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2">𝑇</ci><cn id="S4.SS1.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.SS1.p1.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">T_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m7.1d">italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> to approximate <math alttext="T" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1"><semantics id="S4.SS1.p1.8.m8.1a"><mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">T</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m8.1d">italic_T</annotation></semantics></math> without fully recomputing the tree on <math alttext="D" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m9.1"><semantics id="S4.SS1.p1.9.m9.1a"><mi id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><ci id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">D</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.9.m9.1d">italic_D</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">To achieve this, UMAP is used to reduce the dimensionality of the new documents, which are then assigned to clusters, potentially updating the existing clustering.
We first examine these components individually, then explain how they are combined to create a dynamic data structure.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Adaptive UMAP</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.9">Let <math alttext="d\in D_{1}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">d</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">∈</mo><msub id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS2.p1.1.m1.1.1.3.2" xref="S4.SS2.p1.1.m1.1.1.3.2.cmml">D</mi><mn id="S4.SS2.p1.1.m1.1.1.3.3" xref="S4.SS2.p1.1.m1.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><in id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></in><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑑</ci><apply id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.3.1.cmml" xref="S4.SS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.3.2.cmml" xref="S4.SS2.p1.1.m1.1.1.3.2">𝐷</ci><cn id="S4.SS2.p1.1.m1.1.1.3.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">d\in D_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_d ∈ italic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> be a new document with embedding <math alttext="v" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_v</annotation></semantics></math>.
The first step is to reduce the dimensionality of <math alttext="v" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_v</annotation></semantics></math> to 10.
To do this, we find the <math alttext="n\_neighbors" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">n</mi><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.3" mathvariant="normal" xref="S4.SS2.p1.4.m4.1.1.3.cmml">_</mi><mo id="S4.SS2.p1.4.m4.1.1.1a" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.4" xref="S4.SS2.p1.4.m4.1.1.4.cmml">n</mi><mo id="S4.SS2.p1.4.m4.1.1.1b" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.5" xref="S4.SS2.p1.4.m4.1.1.5.cmml">e</mi><mo id="S4.SS2.p1.4.m4.1.1.1c" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.6" xref="S4.SS2.p1.4.m4.1.1.6.cmml">i</mi><mo id="S4.SS2.p1.4.m4.1.1.1d" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.7" xref="S4.SS2.p1.4.m4.1.1.7.cmml">g</mi><mo id="S4.SS2.p1.4.m4.1.1.1e" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.8" xref="S4.SS2.p1.4.m4.1.1.8.cmml">h</mi><mo id="S4.SS2.p1.4.m4.1.1.1f" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.9" xref="S4.SS2.p1.4.m4.1.1.9.cmml">b</mi><mo id="S4.SS2.p1.4.m4.1.1.1g" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.10" xref="S4.SS2.p1.4.m4.1.1.10.cmml">o</mi><mo id="S4.SS2.p1.4.m4.1.1.1h" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.11" xref="S4.SS2.p1.4.m4.1.1.11.cmml">r</mi><mo id="S4.SS2.p1.4.m4.1.1.1i" xref="S4.SS2.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p1.4.m4.1.1.12" xref="S4.SS2.p1.4.m4.1.1.12.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><times id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></times><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝑛</ci><ci id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">_</ci><ci id="S4.SS2.p1.4.m4.1.1.4.cmml" xref="S4.SS2.p1.4.m4.1.1.4">𝑛</ci><ci id="S4.SS2.p1.4.m4.1.1.5.cmml" xref="S4.SS2.p1.4.m4.1.1.5">𝑒</ci><ci id="S4.SS2.p1.4.m4.1.1.6.cmml" xref="S4.SS2.p1.4.m4.1.1.6">𝑖</ci><ci id="S4.SS2.p1.4.m4.1.1.7.cmml" xref="S4.SS2.p1.4.m4.1.1.7">𝑔</ci><ci id="S4.SS2.p1.4.m4.1.1.8.cmml" xref="S4.SS2.p1.4.m4.1.1.8">ℎ</ci><ci id="S4.SS2.p1.4.m4.1.1.9.cmml" xref="S4.SS2.p1.4.m4.1.1.9">𝑏</ci><ci id="S4.SS2.p1.4.m4.1.1.10.cmml" xref="S4.SS2.p1.4.m4.1.1.10">𝑜</ci><ci id="S4.SS2.p1.4.m4.1.1.11.cmml" xref="S4.SS2.p1.4.m4.1.1.11">𝑟</ci><ci id="S4.SS2.p1.4.m4.1.1.12.cmml" xref="S4.SS2.p1.4.m4.1.1.12">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">n\_neighbors</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_n _ italic_n italic_e italic_i italic_g italic_h italic_b italic_o italic_r italic_s</annotation></semantics></math> nearest neighbors of <math alttext="v" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">italic_v</annotation></semantics></math> in the original high-dimensional space and interpolate their positions in the previously learned low-dimensional embedding to obtain the reduced embedding <math alttext="v^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><msup id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">v</mi><mo id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">𝑣</ci><ci id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">v^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">italic_v start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.
This preserves the local relationships of <math alttext="v" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m7.1"><semantics id="S4.SS2.p1.7.m7.1a"><mi id="S4.SS2.p1.7.m7.1.1" xref="S4.SS2.p1.7.m7.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m7.1b"><ci id="S4.SS2.p1.7.m7.1.1.cmml" xref="S4.SS2.p1.7.m7.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m7.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.7.m7.1d">italic_v</annotation></semantics></math> with its neighbors, maintaining the structure learned during fitting.
Given <math alttext="|D_{0}|\gg|D_{1}|" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m8.2"><semantics id="S4.SS2.p1.8.m8.2a"><mrow id="S4.SS2.p1.8.m8.2.2" xref="S4.SS2.p1.8.m8.2.2.cmml"><mrow id="S4.SS2.p1.8.m8.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.2.cmml"><mo id="S4.SS2.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.8.m8.1.1.1.2.1.cmml">|</mo><msub id="S4.SS2.p1.8.m8.1.1.1.1.1" xref="S4.SS2.p1.8.m8.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.8.m8.1.1.1.1.1.2" xref="S4.SS2.p1.8.m8.1.1.1.1.1.2.cmml">D</mi><mn id="S4.SS2.p1.8.m8.1.1.1.1.1.3" xref="S4.SS2.p1.8.m8.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS2.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S4.SS2.p1.8.m8.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS2.p1.8.m8.2.2.3" xref="S4.SS2.p1.8.m8.2.2.3.cmml">≫</mo><mrow id="S4.SS2.p1.8.m8.2.2.2.1" xref="S4.SS2.p1.8.m8.2.2.2.2.cmml"><mo id="S4.SS2.p1.8.m8.2.2.2.1.2" stretchy="false" xref="S4.SS2.p1.8.m8.2.2.2.2.1.cmml">|</mo><msub id="S4.SS2.p1.8.m8.2.2.2.1.1" xref="S4.SS2.p1.8.m8.2.2.2.1.1.cmml"><mi id="S4.SS2.p1.8.m8.2.2.2.1.1.2" xref="S4.SS2.p1.8.m8.2.2.2.1.1.2.cmml">D</mi><mn id="S4.SS2.p1.8.m8.2.2.2.1.1.3" xref="S4.SS2.p1.8.m8.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p1.8.m8.2.2.2.1.3" stretchy="false" xref="S4.SS2.p1.8.m8.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m8.2b"><apply id="S4.SS2.p1.8.m8.2.2.cmml" xref="S4.SS2.p1.8.m8.2.2"><csymbol cd="latexml" id="S4.SS2.p1.8.m8.2.2.3.cmml" xref="S4.SS2.p1.8.m8.2.2.3">much-greater-than</csymbol><apply id="S4.SS2.p1.8.m8.1.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1"><abs id="S4.SS2.p1.8.m8.1.1.1.2.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.2"></abs><apply id="S4.SS2.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.8.m8.1.1.1.1.1.2">𝐷</ci><cn id="S4.SS2.p1.8.m8.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.8.m8.1.1.1.1.1.3">0</cn></apply></apply><apply id="S4.SS2.p1.8.m8.2.2.2.2.cmml" xref="S4.SS2.p1.8.m8.2.2.2.1"><abs id="S4.SS2.p1.8.m8.2.2.2.2.1.cmml" xref="S4.SS2.p1.8.m8.2.2.2.1.2"></abs><apply id="S4.SS2.p1.8.m8.2.2.2.1.1.cmml" xref="S4.SS2.p1.8.m8.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.8.m8.2.2.2.1.1.1.cmml" xref="S4.SS2.p1.8.m8.2.2.2.1.1">subscript</csymbol><ci id="S4.SS2.p1.8.m8.2.2.2.1.1.2.cmml" xref="S4.SS2.p1.8.m8.2.2.2.1.1.2">𝐷</ci><cn id="S4.SS2.p1.8.m8.2.2.2.1.1.3.cmml" type="integer" xref="S4.SS2.p1.8.m8.2.2.2.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m8.2c">|D_{0}|\gg|D_{1}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.8.m8.2d">| italic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | ≫ | italic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT |</annotation></semantics></math>, we assume this property holds for all new documents.
This process requires storing the fitted UMAP models (both global and local) with our tree.
We use the <span class="ltx_text ltx_markedasmath ltx_font_typewriter" id="S4.SS2.p1.9.1">UMAP-learn</span><span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://umap-learn.readthedocs.io/en/latest/" title="">https://umap-learn.readthedocs.io/en/latest/</a></span></span></span> library for UMAP fitting and dynamic transformations.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Adaptive GMM</h3>
<div class="ltx_para ltx_noindent" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.7">A key component of the recursive-abstractive tree construction (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg1" title="Algorithm 1 ‣ Recursive Construction ‣ 3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">1</span></a>) is its clustering algorithm, which poses challenges when handling dynamic datasets.
Given a fitted Gaussian Mixture Model (GMM) <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">caligraphic_I</annotation></semantics></math> with <math alttext="K" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">italic_K</annotation></semantics></math> clusters defined by their means <math alttext="\{\mu_{k}\}_{k=1}^{K}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><msubsup id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mrow id="S4.SS3.p1.3.m3.1.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.2.cmml"><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.3.m3.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.p1.3.m3.1.1.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS3.p1.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p1.3.m3.1.1.1.3" xref="S4.SS3.p1.3.m3.1.1.1.3.cmml"><mi id="S4.SS3.p1.3.m3.1.1.1.3.2" xref="S4.SS3.p1.3.m3.1.1.1.3.2.cmml">k</mi><mo id="S4.SS3.p1.3.m3.1.1.1.3.1" xref="S4.SS3.p1.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p1.3.m3.1.1.1.3.3" xref="S4.SS3.p1.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1">superscript</csymbol><apply id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1">subscript</csymbol><set id="S4.SS3.p1.3.m3.1.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1"><apply id="S4.SS3.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.2">𝜇</ci><ci id="S4.SS3.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS3.p1.3.m3.1.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.1.3"><eq id="S4.SS3.p1.3.m3.1.1.1.3.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.3.1"></eq><ci id="S4.SS3.p1.3.m3.1.1.1.3.2.cmml" xref="S4.SS3.p1.3.m3.1.1.1.3.2">𝑘</ci><cn id="S4.SS3.p1.3.m3.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.3.m3.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\{\mu_{k}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">{ italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, covariance matrices <math alttext="\{\Sigma_{k}\}_{k=1}^{K}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><msubsup id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mrow id="S4.SS3.p1.4.m4.1.1.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.1.2.cmml"><mo id="S4.SS3.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.4.m4.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.p1.4.m4.1.1.1.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.1.1.1.1.2" mathvariant="normal" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1.2.cmml">Σ</mi><mi id="S4.SS3.p1.4.m4.1.1.1.1.1.1.3" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS3.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.4.m4.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p1.4.m4.1.1.1.3" xref="S4.SS3.p1.4.m4.1.1.1.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.1.3.2" xref="S4.SS3.p1.4.m4.1.1.1.3.2.cmml">k</mi><mo id="S4.SS3.p1.4.m4.1.1.1.3.1" xref="S4.SS3.p1.4.m4.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p1.4.m4.1.1.1.3.3" xref="S4.SS3.p1.4.m4.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1">superscript</csymbol><apply id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1">subscript</csymbol><set id="S4.SS3.p1.4.m4.1.1.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1"><apply id="S4.SS3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1.2">Σ</ci><ci id="S4.SS3.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS3.p1.4.m4.1.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.1.3"><eq id="S4.SS3.p1.4.m4.1.1.1.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.3.1"></eq><ci id="S4.SS3.p1.4.m4.1.1.1.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.1.3.2">𝑘</ci><cn id="S4.SS3.p1.4.m4.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.4.m4.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\{\Sigma_{k}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">{ roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, and mixing coefficients <math alttext="\{\pi_{k}\}_{k=1}^{K}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><msubsup id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mrow id="S4.SS3.p1.5.m5.1.1.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.1.2.cmml"><mo id="S4.SS3.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.5.m5.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.p1.5.m5.1.1.1.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.5.m5.1.1.1.1.1.1.2" xref="S4.SS3.p1.5.m5.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.SS3.p1.5.m5.1.1.1.1.1.1.3" xref="S4.SS3.p1.5.m5.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS3.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.5.m5.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p1.5.m5.1.1.1.3" xref="S4.SS3.p1.5.m5.1.1.1.3.cmml"><mi id="S4.SS3.p1.5.m5.1.1.1.3.2" xref="S4.SS3.p1.5.m5.1.1.1.3.2.cmml">k</mi><mo id="S4.SS3.p1.5.m5.1.1.1.3.1" xref="S4.SS3.p1.5.m5.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p1.5.m5.1.1.1.3.3" xref="S4.SS3.p1.5.m5.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1">superscript</csymbol><apply id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1">subscript</csymbol><set id="S4.SS3.p1.5.m5.1.1.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.1"><apply id="S4.SS3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.SS3.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S4.SS3.p1.5.m5.1.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.1.3"><eq id="S4.SS3.p1.5.m5.1.1.1.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.1.3.1"></eq><ci id="S4.SS3.p1.5.m5.1.1.1.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.1.3.2">𝑘</ci><cn id="S4.SS3.p1.5.m5.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.5.m5.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\{\pi_{k}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">{ italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, and given points <math alttext="\{x_{i}\}_{i=1}^{n}" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m6.1"><semantics id="S4.SS3.p1.6.m6.1a"><msubsup id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mrow id="S4.SS3.p1.6.m6.1.1.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.1.2.cmml"><mo id="S4.SS3.p1.6.m6.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.6.m6.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.p1.6.m6.1.1.1.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.1.1.1.1.2" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS3.p1.6.m6.1.1.1.1.1.1.3" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.p1.6.m6.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.6.m6.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p1.6.m6.1.1.1.3" xref="S4.SS3.p1.6.m6.1.1.1.3.cmml"><mi id="S4.SS3.p1.6.m6.1.1.1.3.2" xref="S4.SS3.p1.6.m6.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p1.6.m6.1.1.1.3.1" xref="S4.SS3.p1.6.m6.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p1.6.m6.1.1.1.3.3" xref="S4.SS3.p1.6.m6.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1">subscript</csymbol><set id="S4.SS3.p1.6.m6.1.1.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1"><apply id="S4.SS3.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS3.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS3.p1.6.m6.1.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.1.3"><eq id="S4.SS3.p1.6.m6.1.1.1.3.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1.3.1"></eq><ci id="S4.SS3.p1.6.m6.1.1.1.3.2.cmml" xref="S4.SS3.p1.6.m6.1.1.1.3.2">𝑖</ci><cn id="S4.SS3.p1.6.m6.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.6.m6.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">\{x_{i}\}_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m6.1d">{ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> assigned to these clusters, the goal is to assign a new point <math alttext="x_{n+1}" class="ltx_Math" display="inline" id="S4.SS3.p1.7.m7.1"><semantics id="S4.SS3.p1.7.m7.1a"><msub id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2" xref="S4.SS3.p1.7.m7.1.1.2.cmml">x</mi><mrow id="S4.SS3.p1.7.m7.1.1.3" xref="S4.SS3.p1.7.m7.1.1.3.cmml"><mi id="S4.SS3.p1.7.m7.1.1.3.2" xref="S4.SS3.p1.7.m7.1.1.3.2.cmml">n</mi><mo id="S4.SS3.p1.7.m7.1.1.3.1" xref="S4.SS3.p1.7.m7.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p1.7.m7.1.1.3.3" xref="S4.SS3.p1.7.m7.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.1b"><apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2">𝑥</ci><apply id="S4.SS3.p1.7.m7.1.1.3.cmml" xref="S4.SS3.p1.7.m7.1.1.3"><plus id="S4.SS3.p1.7.m7.1.1.3.1.cmml" xref="S4.SS3.p1.7.m7.1.1.3.1"></plus><ci id="S4.SS3.p1.7.m7.1.1.3.2.cmml" xref="S4.SS3.p1.7.m7.1.1.3.2">𝑛</ci><cn id="S4.SS3.p1.7.m7.1.1.3.3.cmml" type="integer" xref="S4.SS3.p1.7.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.1c">x_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.7.m7.1d">italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> to one or more clusters.
This may involve updating the clustering structure or introducing new clusters.
While prior work addresses online GMMs <cite class="ltx_cite ltx_citemacro_citep">(Song and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib23" title="">2005</a>; Declercq and Piater, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib4" title="">2008</a>; Zhang and Scordilis, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib29" title="">2008</a>)</cite>, our setting differs in that we start with a GMM fit on a dataset, we have access to all the points and we want to minimize the number of updated clusters, as each update requires multiple re-generated summaries.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.4">First, assume <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_n</annotation></semantics></math> is large, i.e., many points have already been clustered.
Given a new point <math alttext="x_{n+1}" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><msub id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml">x</mi><mrow id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml"><mi id="S4.SS3.p2.2.m2.1.1.3.2" xref="S4.SS3.p2.2.m2.1.1.3.2.cmml">n</mi><mo id="S4.SS3.p2.2.m2.1.1.3.1" xref="S4.SS3.p2.2.m2.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p2.2.m2.1.1.3.3" xref="S4.SS3.p2.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">𝑥</ci><apply id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3"><plus id="S4.SS3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS3.p2.2.m2.1.1.3.1"></plus><ci id="S4.SS3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS3.p2.2.m2.1.1.3.2">𝑛</ci><cn id="S4.SS3.p2.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS3.p2.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">x_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, we compute its posterior probability <math alttext="\gamma(z_{n+1,k})" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.3"><semantics id="S4.SS3.p2.3.m3.3a"><mrow id="S4.SS3.p2.3.m3.3.3" xref="S4.SS3.p2.3.m3.3.3.cmml"><mi id="S4.SS3.p2.3.m3.3.3.3" xref="S4.SS3.p2.3.m3.3.3.3.cmml">γ</mi><mo id="S4.SS3.p2.3.m3.3.3.2" xref="S4.SS3.p2.3.m3.3.3.2.cmml">⁢</mo><mrow id="S4.SS3.p2.3.m3.3.3.1.1" xref="S4.SS3.p2.3.m3.3.3.1.1.1.cmml"><mo id="S4.SS3.p2.3.m3.3.3.1.1.2" stretchy="false" xref="S4.SS3.p2.3.m3.3.3.1.1.1.cmml">(</mo><msub id="S4.SS3.p2.3.m3.3.3.1.1.1" xref="S4.SS3.p2.3.m3.3.3.1.1.1.cmml"><mi id="S4.SS3.p2.3.m3.3.3.1.1.1.2" xref="S4.SS3.p2.3.m3.3.3.1.1.1.2.cmml">z</mi><mrow id="S4.SS3.p2.3.m3.2.2.2.2" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml"><mrow id="S4.SS3.p2.3.m3.2.2.2.2.1" xref="S4.SS3.p2.3.m3.2.2.2.2.1.cmml"><mi id="S4.SS3.p2.3.m3.2.2.2.2.1.2" xref="S4.SS3.p2.3.m3.2.2.2.2.1.2.cmml">n</mi><mo id="S4.SS3.p2.3.m3.2.2.2.2.1.1" xref="S4.SS3.p2.3.m3.2.2.2.2.1.1.cmml">+</mo><mn id="S4.SS3.p2.3.m3.2.2.2.2.1.3" xref="S4.SS3.p2.3.m3.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS3.p2.3.m3.2.2.2.2.2" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.3.m3.1.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.1.cmml">k</mi></mrow></msub><mo id="S4.SS3.p2.3.m3.3.3.1.1.3" stretchy="false" xref="S4.SS3.p2.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.3b"><apply id="S4.SS3.p2.3.m3.3.3.cmml" xref="S4.SS3.p2.3.m3.3.3"><times id="S4.SS3.p2.3.m3.3.3.2.cmml" xref="S4.SS3.p2.3.m3.3.3.2"></times><ci id="S4.SS3.p2.3.m3.3.3.3.cmml" xref="S4.SS3.p2.3.m3.3.3.3">𝛾</ci><apply id="S4.SS3.p2.3.m3.3.3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.3.3.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS3.p2.3.m3.3.3.1.1.1.2">𝑧</ci><list id="S4.SS3.p2.3.m3.2.2.2.3.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2"><apply id="S4.SS3.p2.3.m3.2.2.2.2.1.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2.1"><plus id="S4.SS3.p2.3.m3.2.2.2.2.1.1.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2.1.1"></plus><ci id="S4.SS3.p2.3.m3.2.2.2.2.1.2.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2.1.2">𝑛</ci><cn id="S4.SS3.p2.3.m3.2.2.2.2.1.3.cmml" type="integer" xref="S4.SS3.p2.3.m3.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS3.p2.3.m3.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1.1">𝑘</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.3c">\gamma(z_{n+1,k})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.3d">italic_γ ( italic_z start_POSTSUBSCRIPT italic_n + 1 , italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> for <math alttext="k\in[K]" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mrow id="S4.SS3.p2.4.m4.1.2" xref="S4.SS3.p2.4.m4.1.2.cmml"><mi id="S4.SS3.p2.4.m4.1.2.2" xref="S4.SS3.p2.4.m4.1.2.2.cmml">k</mi><mo id="S4.SS3.p2.4.m4.1.2.1" xref="S4.SS3.p2.4.m4.1.2.1.cmml">∈</mo><mrow id="S4.SS3.p2.4.m4.1.2.3.2" xref="S4.SS3.p2.4.m4.1.2.3.1.cmml"><mo id="S4.SS3.p2.4.m4.1.2.3.2.1" stretchy="false" xref="S4.SS3.p2.4.m4.1.2.3.1.1.cmml">[</mo><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">K</mi><mo id="S4.SS3.p2.4.m4.1.2.3.2.2" stretchy="false" xref="S4.SS3.p2.4.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><apply id="S4.SS3.p2.4.m4.1.2.cmml" xref="S4.SS3.p2.4.m4.1.2"><in id="S4.SS3.p2.4.m4.1.2.1.cmml" xref="S4.SS3.p2.4.m4.1.2.1"></in><ci id="S4.SS3.p2.4.m4.1.2.2.cmml" xref="S4.SS3.p2.4.m4.1.2.2">𝑘</ci><apply id="S4.SS3.p2.4.m4.1.2.3.1.cmml" xref="S4.SS3.p2.4.m4.1.2.3.2"><csymbol cd="latexml" id="S4.SS3.p2.4.m4.1.2.3.1.1.cmml" xref="S4.SS3.p2.4.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">k\in[K]</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_k ∈ [ italic_K ]</annotation></semantics></math>, and approximate the maximization step by updating the parameters with the new point’s contribution as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mu_{k}\leftarrow\frac{n\pi_{k}\mu_{k}+\gamma(z_{n+1,k})x_{n+1}}{n\pi_{k}+%
\gamma(z_{n+1,k})},\quad\Sigma_{k}\leftarrow\frac{n\pi_{k}\Sigma_{k}+\gamma(z_%
{n+1,k})(x_{n+1}-\mu_{k})(x_{n+1}-\mu_{k})^{\top}}{n\pi_{k}+\gamma(z_{n+1,k})}" class="ltx_Math" display="block" id="S4.Ex1.m1.16"><semantics id="S4.Ex1.m1.16a"><mrow id="S4.Ex1.m1.16.16.2" xref="S4.Ex1.m1.16.16.3.cmml"><mrow id="S4.Ex1.m1.15.15.1.1" xref="S4.Ex1.m1.15.15.1.1.cmml"><msub id="S4.Ex1.m1.15.15.1.1.2" xref="S4.Ex1.m1.15.15.1.1.2.cmml"><mi id="S4.Ex1.m1.15.15.1.1.2.2" xref="S4.Ex1.m1.15.15.1.1.2.2.cmml">μ</mi><mi id="S4.Ex1.m1.15.15.1.1.2.3" xref="S4.Ex1.m1.15.15.1.1.2.3.cmml">k</mi></msub><mo id="S4.Ex1.m1.15.15.1.1.1" stretchy="false" xref="S4.Ex1.m1.15.15.1.1.1.cmml">←</mo><mfrac id="S4.Ex1.m1.6.6" xref="S4.Ex1.m1.6.6.cmml"><mrow id="S4.Ex1.m1.3.3.3" xref="S4.Ex1.m1.3.3.3.cmml"><mrow id="S4.Ex1.m1.3.3.3.5" xref="S4.Ex1.m1.3.3.3.5.cmml"><mi id="S4.Ex1.m1.3.3.3.5.2" xref="S4.Ex1.m1.3.3.3.5.2.cmml">n</mi><mo id="S4.Ex1.m1.3.3.3.5.1" xref="S4.Ex1.m1.3.3.3.5.1.cmml">⁢</mo><msub id="S4.Ex1.m1.3.3.3.5.3" xref="S4.Ex1.m1.3.3.3.5.3.cmml"><mi id="S4.Ex1.m1.3.3.3.5.3.2" xref="S4.Ex1.m1.3.3.3.5.3.2.cmml">π</mi><mi id="S4.Ex1.m1.3.3.3.5.3.3" xref="S4.Ex1.m1.3.3.3.5.3.3.cmml">k</mi></msub><mo id="S4.Ex1.m1.3.3.3.5.1a" xref="S4.Ex1.m1.3.3.3.5.1.cmml">⁢</mo><msub id="S4.Ex1.m1.3.3.3.5.4" xref="S4.Ex1.m1.3.3.3.5.4.cmml"><mi id="S4.Ex1.m1.3.3.3.5.4.2" xref="S4.Ex1.m1.3.3.3.5.4.2.cmml">μ</mi><mi id="S4.Ex1.m1.3.3.3.5.4.3" xref="S4.Ex1.m1.3.3.3.5.4.3.cmml">k</mi></msub></mrow><mo id="S4.Ex1.m1.3.3.3.4" xref="S4.Ex1.m1.3.3.3.4.cmml">+</mo><mrow id="S4.Ex1.m1.3.3.3.3" xref="S4.Ex1.m1.3.3.3.3.cmml"><mi id="S4.Ex1.m1.3.3.3.3.3" xref="S4.Ex1.m1.3.3.3.3.3.cmml">γ</mi><mo id="S4.Ex1.m1.3.3.3.3.2" xref="S4.Ex1.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.3.3.3.3.1.1" xref="S4.Ex1.m1.3.3.3.3.1.1.1.cmml"><mo id="S4.Ex1.m1.3.3.3.3.1.1.2" stretchy="false" xref="S4.Ex1.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.3.3.3.3.1.1.1" xref="S4.Ex1.m1.3.3.3.3.1.1.1.cmml"><mi id="S4.Ex1.m1.3.3.3.3.1.1.1.2" xref="S4.Ex1.m1.3.3.3.3.1.1.1.2.cmml">z</mi><mrow id="S4.Ex1.m1.2.2.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.2.3.cmml"><mrow id="S4.Ex1.m1.2.2.2.2.2.2.1" xref="S4.Ex1.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.Ex1.m1.2.2.2.2.2.2.1.2" xref="S4.Ex1.m1.2.2.2.2.2.2.1.2.cmml">n</mi><mo id="S4.Ex1.m1.2.2.2.2.2.2.1.1" xref="S4.Ex1.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S4.Ex1.m1.2.2.2.2.2.2.1.3" xref="S4.Ex1.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.Ex1.m1.2.2.2.2.2.2.2" xref="S4.Ex1.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.cmml">k</mi></mrow></msub><mo id="S4.Ex1.m1.3.3.3.3.1.1.3" stretchy="false" xref="S4.Ex1.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex1.m1.3.3.3.3.2a" xref="S4.Ex1.m1.3.3.3.3.2.cmml">⁢</mo><msub id="S4.Ex1.m1.3.3.3.3.4" xref="S4.Ex1.m1.3.3.3.3.4.cmml"><mi id="S4.Ex1.m1.3.3.3.3.4.2" xref="S4.Ex1.m1.3.3.3.3.4.2.cmml">x</mi><mrow id="S4.Ex1.m1.3.3.3.3.4.3" xref="S4.Ex1.m1.3.3.3.3.4.3.cmml"><mi id="S4.Ex1.m1.3.3.3.3.4.3.2" xref="S4.Ex1.m1.3.3.3.3.4.3.2.cmml">n</mi><mo id="S4.Ex1.m1.3.3.3.3.4.3.1" xref="S4.Ex1.m1.3.3.3.3.4.3.1.cmml">+</mo><mn id="S4.Ex1.m1.3.3.3.3.4.3.3" xref="S4.Ex1.m1.3.3.3.3.4.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mrow id="S4.Ex1.m1.6.6.6" xref="S4.Ex1.m1.6.6.6.cmml"><mrow id="S4.Ex1.m1.6.6.6.5" xref="S4.Ex1.m1.6.6.6.5.cmml"><mi id="S4.Ex1.m1.6.6.6.5.2" xref="S4.Ex1.m1.6.6.6.5.2.cmml">n</mi><mo id="S4.Ex1.m1.6.6.6.5.1" xref="S4.Ex1.m1.6.6.6.5.1.cmml">⁢</mo><msub id="S4.Ex1.m1.6.6.6.5.3" xref="S4.Ex1.m1.6.6.6.5.3.cmml"><mi id="S4.Ex1.m1.6.6.6.5.3.2" xref="S4.Ex1.m1.6.6.6.5.3.2.cmml">π</mi><mi id="S4.Ex1.m1.6.6.6.5.3.3" xref="S4.Ex1.m1.6.6.6.5.3.3.cmml">k</mi></msub></mrow><mo id="S4.Ex1.m1.6.6.6.4" xref="S4.Ex1.m1.6.6.6.4.cmml">+</mo><mrow id="S4.Ex1.m1.6.6.6.3" xref="S4.Ex1.m1.6.6.6.3.cmml"><mi id="S4.Ex1.m1.6.6.6.3.3" xref="S4.Ex1.m1.6.6.6.3.3.cmml">γ</mi><mo id="S4.Ex1.m1.6.6.6.3.2" xref="S4.Ex1.m1.6.6.6.3.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.6.6.6.3.1.1" xref="S4.Ex1.m1.6.6.6.3.1.1.1.cmml"><mo id="S4.Ex1.m1.6.6.6.3.1.1.2" stretchy="false" xref="S4.Ex1.m1.6.6.6.3.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.6.6.6.3.1.1.1" xref="S4.Ex1.m1.6.6.6.3.1.1.1.cmml"><mi id="S4.Ex1.m1.6.6.6.3.1.1.1.2" xref="S4.Ex1.m1.6.6.6.3.1.1.1.2.cmml">z</mi><mrow id="S4.Ex1.m1.5.5.5.2.2.2" xref="S4.Ex1.m1.5.5.5.2.2.3.cmml"><mrow id="S4.Ex1.m1.5.5.5.2.2.2.1" xref="S4.Ex1.m1.5.5.5.2.2.2.1.cmml"><mi id="S4.Ex1.m1.5.5.5.2.2.2.1.2" xref="S4.Ex1.m1.5.5.5.2.2.2.1.2.cmml">n</mi><mo id="S4.Ex1.m1.5.5.5.2.2.2.1.1" xref="S4.Ex1.m1.5.5.5.2.2.2.1.1.cmml">+</mo><mn id="S4.Ex1.m1.5.5.5.2.2.2.1.3" xref="S4.Ex1.m1.5.5.5.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.Ex1.m1.5.5.5.2.2.2.2" xref="S4.Ex1.m1.5.5.5.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.4.4.4.1.1.1" xref="S4.Ex1.m1.4.4.4.1.1.1.cmml">k</mi></mrow></msub><mo id="S4.Ex1.m1.6.6.6.3.1.1.3" stretchy="false" xref="S4.Ex1.m1.6.6.6.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S4.Ex1.m1.16.16.2.3" rspace="1.167em" xref="S4.Ex1.m1.16.16.3a.cmml">,</mo><mrow id="S4.Ex1.m1.16.16.2.2" xref="S4.Ex1.m1.16.16.2.2.cmml"><msub id="S4.Ex1.m1.16.16.2.2.2" xref="S4.Ex1.m1.16.16.2.2.2.cmml"><mi id="S4.Ex1.m1.16.16.2.2.2.2" mathvariant="normal" xref="S4.Ex1.m1.16.16.2.2.2.2.cmml">Σ</mi><mi id="S4.Ex1.m1.16.16.2.2.2.3" xref="S4.Ex1.m1.16.16.2.2.2.3.cmml">k</mi></msub><mo id="S4.Ex1.m1.16.16.2.2.1" stretchy="false" xref="S4.Ex1.m1.16.16.2.2.1.cmml">←</mo><mfrac id="S4.Ex1.m1.14.14" xref="S4.Ex1.m1.14.14.cmml"><mrow id="S4.Ex1.m1.11.11.5" xref="S4.Ex1.m1.11.11.5.cmml"><mrow id="S4.Ex1.m1.11.11.5.7" xref="S4.Ex1.m1.11.11.5.7.cmml"><mi id="S4.Ex1.m1.11.11.5.7.2" xref="S4.Ex1.m1.11.11.5.7.2.cmml">n</mi><mo id="S4.Ex1.m1.11.11.5.7.1" xref="S4.Ex1.m1.11.11.5.7.1.cmml">⁢</mo><msub id="S4.Ex1.m1.11.11.5.7.3" xref="S4.Ex1.m1.11.11.5.7.3.cmml"><mi id="S4.Ex1.m1.11.11.5.7.3.2" xref="S4.Ex1.m1.11.11.5.7.3.2.cmml">π</mi><mi id="S4.Ex1.m1.11.11.5.7.3.3" xref="S4.Ex1.m1.11.11.5.7.3.3.cmml">k</mi></msub><mo id="S4.Ex1.m1.11.11.5.7.1a" xref="S4.Ex1.m1.11.11.5.7.1.cmml">⁢</mo><msub id="S4.Ex1.m1.11.11.5.7.4" xref="S4.Ex1.m1.11.11.5.7.4.cmml"><mi id="S4.Ex1.m1.11.11.5.7.4.2" mathvariant="normal" xref="S4.Ex1.m1.11.11.5.7.4.2.cmml">Σ</mi><mi id="S4.Ex1.m1.11.11.5.7.4.3" xref="S4.Ex1.m1.11.11.5.7.4.3.cmml">k</mi></msub></mrow><mo id="S4.Ex1.m1.11.11.5.6" xref="S4.Ex1.m1.11.11.5.6.cmml">+</mo><mrow id="S4.Ex1.m1.11.11.5.5" xref="S4.Ex1.m1.11.11.5.5.cmml"><mi id="S4.Ex1.m1.11.11.5.5.5" xref="S4.Ex1.m1.11.11.5.5.5.cmml">γ</mi><mo id="S4.Ex1.m1.11.11.5.5.4" xref="S4.Ex1.m1.11.11.5.5.4.cmml">⁢</mo><mrow id="S4.Ex1.m1.9.9.3.3.1.1" xref="S4.Ex1.m1.9.9.3.3.1.1.1.cmml"><mo id="S4.Ex1.m1.9.9.3.3.1.1.2" stretchy="false" xref="S4.Ex1.m1.9.9.3.3.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.9.9.3.3.1.1.1" xref="S4.Ex1.m1.9.9.3.3.1.1.1.cmml"><mi id="S4.Ex1.m1.9.9.3.3.1.1.1.2" xref="S4.Ex1.m1.9.9.3.3.1.1.1.2.cmml">z</mi><mrow id="S4.Ex1.m1.8.8.2.2.2.2" xref="S4.Ex1.m1.8.8.2.2.2.3.cmml"><mrow id="S4.Ex1.m1.8.8.2.2.2.2.1" xref="S4.Ex1.m1.8.8.2.2.2.2.1.cmml"><mi id="S4.Ex1.m1.8.8.2.2.2.2.1.2" xref="S4.Ex1.m1.8.8.2.2.2.2.1.2.cmml">n</mi><mo id="S4.Ex1.m1.8.8.2.2.2.2.1.1" xref="S4.Ex1.m1.8.8.2.2.2.2.1.1.cmml">+</mo><mn id="S4.Ex1.m1.8.8.2.2.2.2.1.3" xref="S4.Ex1.m1.8.8.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.Ex1.m1.8.8.2.2.2.2.2" xref="S4.Ex1.m1.8.8.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.7.7.1.1.1.1" xref="S4.Ex1.m1.7.7.1.1.1.1.cmml">k</mi></mrow></msub><mo id="S4.Ex1.m1.9.9.3.3.1.1.3" stretchy="false" xref="S4.Ex1.m1.9.9.3.3.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex1.m1.11.11.5.5.4a" xref="S4.Ex1.m1.11.11.5.5.4.cmml">⁢</mo><mrow id="S4.Ex1.m1.10.10.4.4.2.1" xref="S4.Ex1.m1.10.10.4.4.2.1.1.cmml"><mo id="S4.Ex1.m1.10.10.4.4.2.1.2" stretchy="false" xref="S4.Ex1.m1.10.10.4.4.2.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.10.10.4.4.2.1.1" xref="S4.Ex1.m1.10.10.4.4.2.1.1.cmml"><msub id="S4.Ex1.m1.10.10.4.4.2.1.1.2" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.cmml"><mi id="S4.Ex1.m1.10.10.4.4.2.1.1.2.2" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.2.cmml">x</mi><mrow id="S4.Ex1.m1.10.10.4.4.2.1.1.2.3" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.cmml"><mi id="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.2" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.2.cmml">n</mi><mo id="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.1" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.1.cmml">+</mo><mn id="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.3" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.Ex1.m1.10.10.4.4.2.1.1.1" xref="S4.Ex1.m1.10.10.4.4.2.1.1.1.cmml">−</mo><msub id="S4.Ex1.m1.10.10.4.4.2.1.1.3" xref="S4.Ex1.m1.10.10.4.4.2.1.1.3.cmml"><mi id="S4.Ex1.m1.10.10.4.4.2.1.1.3.2" xref="S4.Ex1.m1.10.10.4.4.2.1.1.3.2.cmml">μ</mi><mi id="S4.Ex1.m1.10.10.4.4.2.1.1.3.3" xref="S4.Ex1.m1.10.10.4.4.2.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S4.Ex1.m1.10.10.4.4.2.1.3" stretchy="false" xref="S4.Ex1.m1.10.10.4.4.2.1.1.cmml">)</mo></mrow><mo id="S4.Ex1.m1.11.11.5.5.4b" xref="S4.Ex1.m1.11.11.5.5.4.cmml">⁢</mo><msup id="S4.Ex1.m1.11.11.5.5.3" xref="S4.Ex1.m1.11.11.5.5.3.cmml"><mrow id="S4.Ex1.m1.11.11.5.5.3.1.1" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.cmml"><mo id="S4.Ex1.m1.11.11.5.5.3.1.1.2" stretchy="false" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.11.11.5.5.3.1.1.1" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.cmml"><msub id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.cmml"><mi id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.2" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.2.cmml">x</mi><mrow id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.cmml"><mi id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.2" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.2.cmml">n</mi><mo id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.1" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.1.cmml">+</mo><mn id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.3" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.Ex1.m1.11.11.5.5.3.1.1.1.1" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.1.cmml">−</mo><msub id="S4.Ex1.m1.11.11.5.5.3.1.1.1.3" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.cmml"><mi id="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.2" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.2.cmml">μ</mi><mi id="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.3" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S4.Ex1.m1.11.11.5.5.3.1.1.3" stretchy="false" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex1.m1.11.11.5.5.3.3" xref="S4.Ex1.m1.11.11.5.5.3.3.cmml">⊤</mo></msup></mrow></mrow><mrow id="S4.Ex1.m1.14.14.8" xref="S4.Ex1.m1.14.14.8.cmml"><mrow id="S4.Ex1.m1.14.14.8.5" xref="S4.Ex1.m1.14.14.8.5.cmml"><mi id="S4.Ex1.m1.14.14.8.5.2" xref="S4.Ex1.m1.14.14.8.5.2.cmml">n</mi><mo id="S4.Ex1.m1.14.14.8.5.1" xref="S4.Ex1.m1.14.14.8.5.1.cmml">⁢</mo><msub id="S4.Ex1.m1.14.14.8.5.3" xref="S4.Ex1.m1.14.14.8.5.3.cmml"><mi id="S4.Ex1.m1.14.14.8.5.3.2" xref="S4.Ex1.m1.14.14.8.5.3.2.cmml">π</mi><mi id="S4.Ex1.m1.14.14.8.5.3.3" xref="S4.Ex1.m1.14.14.8.5.3.3.cmml">k</mi></msub></mrow><mo id="S4.Ex1.m1.14.14.8.4" xref="S4.Ex1.m1.14.14.8.4.cmml">+</mo><mrow id="S4.Ex1.m1.14.14.8.3" xref="S4.Ex1.m1.14.14.8.3.cmml"><mi id="S4.Ex1.m1.14.14.8.3.3" xref="S4.Ex1.m1.14.14.8.3.3.cmml">γ</mi><mo id="S4.Ex1.m1.14.14.8.3.2" xref="S4.Ex1.m1.14.14.8.3.2.cmml">⁢</mo><mrow id="S4.Ex1.m1.14.14.8.3.1.1" xref="S4.Ex1.m1.14.14.8.3.1.1.1.cmml"><mo id="S4.Ex1.m1.14.14.8.3.1.1.2" stretchy="false" xref="S4.Ex1.m1.14.14.8.3.1.1.1.cmml">(</mo><msub id="S4.Ex1.m1.14.14.8.3.1.1.1" xref="S4.Ex1.m1.14.14.8.3.1.1.1.cmml"><mi id="S4.Ex1.m1.14.14.8.3.1.1.1.2" xref="S4.Ex1.m1.14.14.8.3.1.1.1.2.cmml">z</mi><mrow id="S4.Ex1.m1.13.13.7.2.2.2" xref="S4.Ex1.m1.13.13.7.2.2.3.cmml"><mrow id="S4.Ex1.m1.13.13.7.2.2.2.1" xref="S4.Ex1.m1.13.13.7.2.2.2.1.cmml"><mi id="S4.Ex1.m1.13.13.7.2.2.2.1.2" xref="S4.Ex1.m1.13.13.7.2.2.2.1.2.cmml">n</mi><mo id="S4.Ex1.m1.13.13.7.2.2.2.1.1" xref="S4.Ex1.m1.13.13.7.2.2.2.1.1.cmml">+</mo><mn id="S4.Ex1.m1.13.13.7.2.2.2.1.3" xref="S4.Ex1.m1.13.13.7.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.Ex1.m1.13.13.7.2.2.2.2" xref="S4.Ex1.m1.13.13.7.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.12.12.6.1.1.1" xref="S4.Ex1.m1.12.12.6.1.1.1.cmml">k</mi></mrow></msub><mo id="S4.Ex1.m1.14.14.8.3.1.1.3" stretchy="false" xref="S4.Ex1.m1.14.14.8.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.16b"><apply id="S4.Ex1.m1.16.16.3.cmml" xref="S4.Ex1.m1.16.16.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.16.16.3a.cmml" xref="S4.Ex1.m1.16.16.2.3">formulae-sequence</csymbol><apply id="S4.Ex1.m1.15.15.1.1.cmml" xref="S4.Ex1.m1.15.15.1.1"><ci id="S4.Ex1.m1.15.15.1.1.1.cmml" xref="S4.Ex1.m1.15.15.1.1.1">←</ci><apply id="S4.Ex1.m1.15.15.1.1.2.cmml" xref="S4.Ex1.m1.15.15.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.15.15.1.1.2.1.cmml" xref="S4.Ex1.m1.15.15.1.1.2">subscript</csymbol><ci id="S4.Ex1.m1.15.15.1.1.2.2.cmml" xref="S4.Ex1.m1.15.15.1.1.2.2">𝜇</ci><ci id="S4.Ex1.m1.15.15.1.1.2.3.cmml" xref="S4.Ex1.m1.15.15.1.1.2.3">𝑘</ci></apply><apply id="S4.Ex1.m1.6.6.cmml" xref="S4.Ex1.m1.6.6"><divide id="S4.Ex1.m1.6.6.7.cmml" xref="S4.Ex1.m1.6.6"></divide><apply id="S4.Ex1.m1.3.3.3.cmml" xref="S4.Ex1.m1.3.3.3"><plus id="S4.Ex1.m1.3.3.3.4.cmml" xref="S4.Ex1.m1.3.3.3.4"></plus><apply id="S4.Ex1.m1.3.3.3.5.cmml" xref="S4.Ex1.m1.3.3.3.5"><times id="S4.Ex1.m1.3.3.3.5.1.cmml" xref="S4.Ex1.m1.3.3.3.5.1"></times><ci id="S4.Ex1.m1.3.3.3.5.2.cmml" xref="S4.Ex1.m1.3.3.3.5.2">𝑛</ci><apply id="S4.Ex1.m1.3.3.3.5.3.cmml" xref="S4.Ex1.m1.3.3.3.5.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.3.3.5.3.1.cmml" xref="S4.Ex1.m1.3.3.3.5.3">subscript</csymbol><ci id="S4.Ex1.m1.3.3.3.5.3.2.cmml" xref="S4.Ex1.m1.3.3.3.5.3.2">𝜋</ci><ci id="S4.Ex1.m1.3.3.3.5.3.3.cmml" xref="S4.Ex1.m1.3.3.3.5.3.3">𝑘</ci></apply><apply id="S4.Ex1.m1.3.3.3.5.4.cmml" xref="S4.Ex1.m1.3.3.3.5.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.3.3.5.4.1.cmml" xref="S4.Ex1.m1.3.3.3.5.4">subscript</csymbol><ci id="S4.Ex1.m1.3.3.3.5.4.2.cmml" xref="S4.Ex1.m1.3.3.3.5.4.2">𝜇</ci><ci id="S4.Ex1.m1.3.3.3.5.4.3.cmml" xref="S4.Ex1.m1.3.3.3.5.4.3">𝑘</ci></apply></apply><apply id="S4.Ex1.m1.3.3.3.3.cmml" xref="S4.Ex1.m1.3.3.3.3"><times id="S4.Ex1.m1.3.3.3.3.2.cmml" xref="S4.Ex1.m1.3.3.3.3.2"></times><ci id="S4.Ex1.m1.3.3.3.3.3.cmml" xref="S4.Ex1.m1.3.3.3.3.3">𝛾</ci><apply id="S4.Ex1.m1.3.3.3.3.1.1.1.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S4.Ex1.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.1.2">𝑧</ci><list id="S4.Ex1.m1.2.2.2.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2.2.2.2"><apply id="S4.Ex1.m1.2.2.2.2.2.2.1.cmml" xref="S4.Ex1.m1.2.2.2.2.2.2.1"><plus id="S4.Ex1.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.Ex1.m1.2.2.2.2.2.2.1.1"></plus><ci id="S4.Ex1.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.Ex1.m1.2.2.2.2.2.2.1.2">𝑛</ci><cn id="S4.Ex1.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S4.Ex1.m1.2.2.2.2.2.2.1.3">1</cn></apply><ci id="S4.Ex1.m1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1">𝑘</ci></list></apply><apply id="S4.Ex1.m1.3.3.3.3.4.cmml" xref="S4.Ex1.m1.3.3.3.3.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.3.3.3.4.1.cmml" xref="S4.Ex1.m1.3.3.3.3.4">subscript</csymbol><ci id="S4.Ex1.m1.3.3.3.3.4.2.cmml" xref="S4.Ex1.m1.3.3.3.3.4.2">𝑥</ci><apply id="S4.Ex1.m1.3.3.3.3.4.3.cmml" xref="S4.Ex1.m1.3.3.3.3.4.3"><plus id="S4.Ex1.m1.3.3.3.3.4.3.1.cmml" xref="S4.Ex1.m1.3.3.3.3.4.3.1"></plus><ci id="S4.Ex1.m1.3.3.3.3.4.3.2.cmml" xref="S4.Ex1.m1.3.3.3.3.4.3.2">𝑛</ci><cn id="S4.Ex1.m1.3.3.3.3.4.3.3.cmml" type="integer" xref="S4.Ex1.m1.3.3.3.3.4.3.3">1</cn></apply></apply></apply></apply><apply id="S4.Ex1.m1.6.6.6.cmml" xref="S4.Ex1.m1.6.6.6"><plus id="S4.Ex1.m1.6.6.6.4.cmml" xref="S4.Ex1.m1.6.6.6.4"></plus><apply id="S4.Ex1.m1.6.6.6.5.cmml" xref="S4.Ex1.m1.6.6.6.5"><times id="S4.Ex1.m1.6.6.6.5.1.cmml" xref="S4.Ex1.m1.6.6.6.5.1"></times><ci id="S4.Ex1.m1.6.6.6.5.2.cmml" xref="S4.Ex1.m1.6.6.6.5.2">𝑛</ci><apply id="S4.Ex1.m1.6.6.6.5.3.cmml" xref="S4.Ex1.m1.6.6.6.5.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.6.5.3.1.cmml" xref="S4.Ex1.m1.6.6.6.5.3">subscript</csymbol><ci id="S4.Ex1.m1.6.6.6.5.3.2.cmml" xref="S4.Ex1.m1.6.6.6.5.3.2">𝜋</ci><ci id="S4.Ex1.m1.6.6.6.5.3.3.cmml" xref="S4.Ex1.m1.6.6.6.5.3.3">𝑘</ci></apply></apply><apply id="S4.Ex1.m1.6.6.6.3.cmml" xref="S4.Ex1.m1.6.6.6.3"><times id="S4.Ex1.m1.6.6.6.3.2.cmml" xref="S4.Ex1.m1.6.6.6.3.2"></times><ci id="S4.Ex1.m1.6.6.6.3.3.cmml" xref="S4.Ex1.m1.6.6.6.3.3">𝛾</ci><apply id="S4.Ex1.m1.6.6.6.3.1.1.1.cmml" xref="S4.Ex1.m1.6.6.6.3.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.6.6.6.3.1.1.1.1.cmml" xref="S4.Ex1.m1.6.6.6.3.1.1">subscript</csymbol><ci id="S4.Ex1.m1.6.6.6.3.1.1.1.2.cmml" xref="S4.Ex1.m1.6.6.6.3.1.1.1.2">𝑧</ci><list id="S4.Ex1.m1.5.5.5.2.2.3.cmml" xref="S4.Ex1.m1.5.5.5.2.2.2"><apply id="S4.Ex1.m1.5.5.5.2.2.2.1.cmml" xref="S4.Ex1.m1.5.5.5.2.2.2.1"><plus id="S4.Ex1.m1.5.5.5.2.2.2.1.1.cmml" xref="S4.Ex1.m1.5.5.5.2.2.2.1.1"></plus><ci id="S4.Ex1.m1.5.5.5.2.2.2.1.2.cmml" xref="S4.Ex1.m1.5.5.5.2.2.2.1.2">𝑛</ci><cn id="S4.Ex1.m1.5.5.5.2.2.2.1.3.cmml" type="integer" xref="S4.Ex1.m1.5.5.5.2.2.2.1.3">1</cn></apply><ci id="S4.Ex1.m1.4.4.4.1.1.1.cmml" xref="S4.Ex1.m1.4.4.4.1.1.1">𝑘</ci></list></apply></apply></apply></apply></apply><apply id="S4.Ex1.m1.16.16.2.2.cmml" xref="S4.Ex1.m1.16.16.2.2"><ci id="S4.Ex1.m1.16.16.2.2.1.cmml" xref="S4.Ex1.m1.16.16.2.2.1">←</ci><apply id="S4.Ex1.m1.16.16.2.2.2.cmml" xref="S4.Ex1.m1.16.16.2.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.16.16.2.2.2.1.cmml" xref="S4.Ex1.m1.16.16.2.2.2">subscript</csymbol><ci id="S4.Ex1.m1.16.16.2.2.2.2.cmml" xref="S4.Ex1.m1.16.16.2.2.2.2">Σ</ci><ci id="S4.Ex1.m1.16.16.2.2.2.3.cmml" xref="S4.Ex1.m1.16.16.2.2.2.3">𝑘</ci></apply><apply id="S4.Ex1.m1.14.14.cmml" xref="S4.Ex1.m1.14.14"><divide id="S4.Ex1.m1.14.14.9.cmml" xref="S4.Ex1.m1.14.14"></divide><apply id="S4.Ex1.m1.11.11.5.cmml" xref="S4.Ex1.m1.11.11.5"><plus id="S4.Ex1.m1.11.11.5.6.cmml" xref="S4.Ex1.m1.11.11.5.6"></plus><apply id="S4.Ex1.m1.11.11.5.7.cmml" xref="S4.Ex1.m1.11.11.5.7"><times id="S4.Ex1.m1.11.11.5.7.1.cmml" xref="S4.Ex1.m1.11.11.5.7.1"></times><ci id="S4.Ex1.m1.11.11.5.7.2.cmml" xref="S4.Ex1.m1.11.11.5.7.2">𝑛</ci><apply id="S4.Ex1.m1.11.11.5.7.3.cmml" xref="S4.Ex1.m1.11.11.5.7.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.11.11.5.7.3.1.cmml" xref="S4.Ex1.m1.11.11.5.7.3">subscript</csymbol><ci id="S4.Ex1.m1.11.11.5.7.3.2.cmml" xref="S4.Ex1.m1.11.11.5.7.3.2">𝜋</ci><ci id="S4.Ex1.m1.11.11.5.7.3.3.cmml" xref="S4.Ex1.m1.11.11.5.7.3.3">𝑘</ci></apply><apply id="S4.Ex1.m1.11.11.5.7.4.cmml" xref="S4.Ex1.m1.11.11.5.7.4"><csymbol cd="ambiguous" id="S4.Ex1.m1.11.11.5.7.4.1.cmml" xref="S4.Ex1.m1.11.11.5.7.4">subscript</csymbol><ci id="S4.Ex1.m1.11.11.5.7.4.2.cmml" xref="S4.Ex1.m1.11.11.5.7.4.2">Σ</ci><ci id="S4.Ex1.m1.11.11.5.7.4.3.cmml" xref="S4.Ex1.m1.11.11.5.7.4.3">𝑘</ci></apply></apply><apply id="S4.Ex1.m1.11.11.5.5.cmml" xref="S4.Ex1.m1.11.11.5.5"><times id="S4.Ex1.m1.11.11.5.5.4.cmml" xref="S4.Ex1.m1.11.11.5.5.4"></times><ci id="S4.Ex1.m1.11.11.5.5.5.cmml" xref="S4.Ex1.m1.11.11.5.5.5">𝛾</ci><apply id="S4.Ex1.m1.9.9.3.3.1.1.1.cmml" xref="S4.Ex1.m1.9.9.3.3.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.9.9.3.3.1.1.1.1.cmml" xref="S4.Ex1.m1.9.9.3.3.1.1">subscript</csymbol><ci id="S4.Ex1.m1.9.9.3.3.1.1.1.2.cmml" xref="S4.Ex1.m1.9.9.3.3.1.1.1.2">𝑧</ci><list id="S4.Ex1.m1.8.8.2.2.2.3.cmml" xref="S4.Ex1.m1.8.8.2.2.2.2"><apply id="S4.Ex1.m1.8.8.2.2.2.2.1.cmml" xref="S4.Ex1.m1.8.8.2.2.2.2.1"><plus id="S4.Ex1.m1.8.8.2.2.2.2.1.1.cmml" xref="S4.Ex1.m1.8.8.2.2.2.2.1.1"></plus><ci id="S4.Ex1.m1.8.8.2.2.2.2.1.2.cmml" xref="S4.Ex1.m1.8.8.2.2.2.2.1.2">𝑛</ci><cn id="S4.Ex1.m1.8.8.2.2.2.2.1.3.cmml" type="integer" xref="S4.Ex1.m1.8.8.2.2.2.2.1.3">1</cn></apply><ci id="S4.Ex1.m1.7.7.1.1.1.1.cmml" xref="S4.Ex1.m1.7.7.1.1.1.1">𝑘</ci></list></apply><apply id="S4.Ex1.m1.10.10.4.4.2.1.1.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1"><minus id="S4.Ex1.m1.10.10.4.4.2.1.1.1.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.1"></minus><apply id="S4.Ex1.m1.10.10.4.4.2.1.1.2.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.10.10.4.4.2.1.1.2.1.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2">subscript</csymbol><ci id="S4.Ex1.m1.10.10.4.4.2.1.1.2.2.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.2">𝑥</ci><apply id="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.3"><plus id="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.1.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.1"></plus><ci id="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.2.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.2">𝑛</ci><cn id="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.3.cmml" type="integer" xref="S4.Ex1.m1.10.10.4.4.2.1.1.2.3.3">1</cn></apply></apply><apply id="S4.Ex1.m1.10.10.4.4.2.1.1.3.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.10.10.4.4.2.1.1.3.1.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.10.10.4.4.2.1.1.3.2.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.3.2">𝜇</ci><ci id="S4.Ex1.m1.10.10.4.4.2.1.1.3.3.cmml" xref="S4.Ex1.m1.10.10.4.4.2.1.1.3.3">𝑘</ci></apply></apply><apply id="S4.Ex1.m1.11.11.5.5.3.cmml" xref="S4.Ex1.m1.11.11.5.5.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.11.11.5.5.3.2.cmml" xref="S4.Ex1.m1.11.11.5.5.3">superscript</csymbol><apply id="S4.Ex1.m1.11.11.5.5.3.1.1.1.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1"><minus id="S4.Ex1.m1.11.11.5.5.3.1.1.1.1.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.1"></minus><apply id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.1.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2">subscript</csymbol><ci id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.2.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.2">𝑥</ci><apply id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3"><plus id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.1.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.1"></plus><ci id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.2.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.2">𝑛</ci><cn id="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.3.cmml" type="integer" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.1.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.3">subscript</csymbol><ci id="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.2.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.2">𝜇</ci><ci id="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.3.cmml" xref="S4.Ex1.m1.11.11.5.5.3.1.1.1.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="S4.Ex1.m1.11.11.5.5.3.3.cmml" xref="S4.Ex1.m1.11.11.5.5.3.3">top</csymbol></apply></apply></apply><apply id="S4.Ex1.m1.14.14.8.cmml" xref="S4.Ex1.m1.14.14.8"><plus id="S4.Ex1.m1.14.14.8.4.cmml" xref="S4.Ex1.m1.14.14.8.4"></plus><apply id="S4.Ex1.m1.14.14.8.5.cmml" xref="S4.Ex1.m1.14.14.8.5"><times id="S4.Ex1.m1.14.14.8.5.1.cmml" xref="S4.Ex1.m1.14.14.8.5.1"></times><ci id="S4.Ex1.m1.14.14.8.5.2.cmml" xref="S4.Ex1.m1.14.14.8.5.2">𝑛</ci><apply id="S4.Ex1.m1.14.14.8.5.3.cmml" xref="S4.Ex1.m1.14.14.8.5.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.14.14.8.5.3.1.cmml" xref="S4.Ex1.m1.14.14.8.5.3">subscript</csymbol><ci id="S4.Ex1.m1.14.14.8.5.3.2.cmml" xref="S4.Ex1.m1.14.14.8.5.3.2">𝜋</ci><ci id="S4.Ex1.m1.14.14.8.5.3.3.cmml" xref="S4.Ex1.m1.14.14.8.5.3.3">𝑘</ci></apply></apply><apply id="S4.Ex1.m1.14.14.8.3.cmml" xref="S4.Ex1.m1.14.14.8.3"><times id="S4.Ex1.m1.14.14.8.3.2.cmml" xref="S4.Ex1.m1.14.14.8.3.2"></times><ci id="S4.Ex1.m1.14.14.8.3.3.cmml" xref="S4.Ex1.m1.14.14.8.3.3">𝛾</ci><apply id="S4.Ex1.m1.14.14.8.3.1.1.1.cmml" xref="S4.Ex1.m1.14.14.8.3.1.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.14.14.8.3.1.1.1.1.cmml" xref="S4.Ex1.m1.14.14.8.3.1.1">subscript</csymbol><ci id="S4.Ex1.m1.14.14.8.3.1.1.1.2.cmml" xref="S4.Ex1.m1.14.14.8.3.1.1.1.2">𝑧</ci><list id="S4.Ex1.m1.13.13.7.2.2.3.cmml" xref="S4.Ex1.m1.13.13.7.2.2.2"><apply id="S4.Ex1.m1.13.13.7.2.2.2.1.cmml" xref="S4.Ex1.m1.13.13.7.2.2.2.1"><plus id="S4.Ex1.m1.13.13.7.2.2.2.1.1.cmml" xref="S4.Ex1.m1.13.13.7.2.2.2.1.1"></plus><ci id="S4.Ex1.m1.13.13.7.2.2.2.1.2.cmml" xref="S4.Ex1.m1.13.13.7.2.2.2.1.2">𝑛</ci><cn id="S4.Ex1.m1.13.13.7.2.2.2.1.3.cmml" type="integer" xref="S4.Ex1.m1.13.13.7.2.2.2.1.3">1</cn></apply><ci id="S4.Ex1.m1.12.12.6.1.1.1.cmml" xref="S4.Ex1.m1.12.12.6.1.1.1">𝑘</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.16c">\mu_{k}\leftarrow\frac{n\pi_{k}\mu_{k}+\gamma(z_{n+1,k})x_{n+1}}{n\pi_{k}+%
\gamma(z_{n+1,k})},\quad\Sigma_{k}\leftarrow\frac{n\pi_{k}\Sigma_{k}+\gamma(z_%
{n+1,k})(x_{n+1}-\mu_{k})(x_{n+1}-\mu_{k})^{\top}}{n\pi_{k}+\gamma(z_{n+1,k})}</annotation><annotation encoding="application/x-llamapun" id="S4.Ex1.m1.16d">italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG italic_n italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_γ ( italic_z start_POSTSUBSCRIPT italic_n + 1 , italic_k end_POSTSUBSCRIPT ) italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT end_ARG start_ARG italic_n italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_γ ( italic_z start_POSTSUBSCRIPT italic_n + 1 , italic_k end_POSTSUBSCRIPT ) end_ARG , roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG italic_n italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT roman_Σ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_γ ( italic_z start_POSTSUBSCRIPT italic_n + 1 , italic_k end_POSTSUBSCRIPT ) ( italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) ( italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT - italic_μ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT end_ARG start_ARG italic_n italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_γ ( italic_z start_POSTSUBSCRIPT italic_n + 1 , italic_k end_POSTSUBSCRIPT ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\pi_{k}\leftarrow\frac{n\pi_{k}+\gamma(z_{n+1,k})}{n+1}" class="ltx_Math" display="block" id="S4.E3.m1.3"><semantics id="S4.E3.m1.3a"><mrow id="S4.E3.m1.3.4" xref="S4.E3.m1.3.4.cmml"><msub id="S4.E3.m1.3.4.2" xref="S4.E3.m1.3.4.2.cmml"><mi id="S4.E3.m1.3.4.2.2" xref="S4.E3.m1.3.4.2.2.cmml">π</mi><mi id="S4.E3.m1.3.4.2.3" xref="S4.E3.m1.3.4.2.3.cmml">k</mi></msub><mo id="S4.E3.m1.3.4.1" stretchy="false" xref="S4.E3.m1.3.4.1.cmml">←</mo><mfrac id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml"><mrow id="S4.E3.m1.3.3.3" xref="S4.E3.m1.3.3.3.cmml"><mrow id="S4.E3.m1.3.3.3.5" xref="S4.E3.m1.3.3.3.5.cmml"><mi id="S4.E3.m1.3.3.3.5.2" xref="S4.E3.m1.3.3.3.5.2.cmml">n</mi><mo id="S4.E3.m1.3.3.3.5.1" xref="S4.E3.m1.3.3.3.5.1.cmml">⁢</mo><msub id="S4.E3.m1.3.3.3.5.3" xref="S4.E3.m1.3.3.3.5.3.cmml"><mi id="S4.E3.m1.3.3.3.5.3.2" xref="S4.E3.m1.3.3.3.5.3.2.cmml">π</mi><mi id="S4.E3.m1.3.3.3.5.3.3" xref="S4.E3.m1.3.3.3.5.3.3.cmml">k</mi></msub></mrow><mo id="S4.E3.m1.3.3.3.4" xref="S4.E3.m1.3.3.3.4.cmml">+</mo><mrow id="S4.E3.m1.3.3.3.3" xref="S4.E3.m1.3.3.3.3.cmml"><mi id="S4.E3.m1.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.cmml">γ</mi><mo id="S4.E3.m1.3.3.3.3.2" xref="S4.E3.m1.3.3.3.3.2.cmml">⁢</mo><mrow id="S4.E3.m1.3.3.3.3.1.1" xref="S4.E3.m1.3.3.3.3.1.1.1.cmml"><mo id="S4.E3.m1.3.3.3.3.1.1.2" stretchy="false" xref="S4.E3.m1.3.3.3.3.1.1.1.cmml">(</mo><msub id="S4.E3.m1.3.3.3.3.1.1.1" xref="S4.E3.m1.3.3.3.3.1.1.1.cmml"><mi id="S4.E3.m1.3.3.3.3.1.1.1.2" xref="S4.E3.m1.3.3.3.3.1.1.1.2.cmml">z</mi><mrow id="S4.E3.m1.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.3.cmml"><mrow id="S4.E3.m1.2.2.2.2.2.2.1" xref="S4.E3.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.1.2" xref="S4.E3.m1.2.2.2.2.2.2.1.2.cmml">n</mi><mo id="S4.E3.m1.2.2.2.2.2.2.1.1" xref="S4.E3.m1.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E3.m1.2.2.2.2.2.2.1.3" xref="S4.E3.m1.2.2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E3.m1.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml">k</mi></mrow></msub><mo id="S4.E3.m1.3.3.3.3.1.1.3" stretchy="false" xref="S4.E3.m1.3.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S4.E3.m1.3.3.5" xref="S4.E3.m1.3.3.5.cmml"><mi id="S4.E3.m1.3.3.5.2" xref="S4.E3.m1.3.3.5.2.cmml">n</mi><mo id="S4.E3.m1.3.3.5.1" xref="S4.E3.m1.3.3.5.1.cmml">+</mo><mn id="S4.E3.m1.3.3.5.3" xref="S4.E3.m1.3.3.5.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.3b"><apply id="S4.E3.m1.3.4.cmml" xref="S4.E3.m1.3.4"><ci id="S4.E3.m1.3.4.1.cmml" xref="S4.E3.m1.3.4.1">←</ci><apply id="S4.E3.m1.3.4.2.cmml" xref="S4.E3.m1.3.4.2"><csymbol cd="ambiguous" id="S4.E3.m1.3.4.2.1.cmml" xref="S4.E3.m1.3.4.2">subscript</csymbol><ci id="S4.E3.m1.3.4.2.2.cmml" xref="S4.E3.m1.3.4.2.2">𝜋</ci><ci id="S4.E3.m1.3.4.2.3.cmml" xref="S4.E3.m1.3.4.2.3">𝑘</ci></apply><apply id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3"><divide id="S4.E3.m1.3.3.4.cmml" xref="S4.E3.m1.3.3"></divide><apply id="S4.E3.m1.3.3.3.cmml" xref="S4.E3.m1.3.3.3"><plus id="S4.E3.m1.3.3.3.4.cmml" xref="S4.E3.m1.3.3.3.4"></plus><apply id="S4.E3.m1.3.3.3.5.cmml" xref="S4.E3.m1.3.3.3.5"><times id="S4.E3.m1.3.3.3.5.1.cmml" xref="S4.E3.m1.3.3.3.5.1"></times><ci id="S4.E3.m1.3.3.3.5.2.cmml" xref="S4.E3.m1.3.3.3.5.2">𝑛</ci><apply id="S4.E3.m1.3.3.3.5.3.cmml" xref="S4.E3.m1.3.3.3.5.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.5.3.1.cmml" xref="S4.E3.m1.3.3.3.5.3">subscript</csymbol><ci id="S4.E3.m1.3.3.3.5.3.2.cmml" xref="S4.E3.m1.3.3.3.5.3.2">𝜋</ci><ci id="S4.E3.m1.3.3.3.5.3.3.cmml" xref="S4.E3.m1.3.3.3.5.3.3">𝑘</ci></apply></apply><apply id="S4.E3.m1.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3"><times id="S4.E3.m1.3.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3.3.2"></times><ci id="S4.E3.m1.3.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.3">𝛾</ci><apply id="S4.E3.m1.3.3.3.3.1.1.1.cmml" xref="S4.E3.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E3.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S4.E3.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E3.m1.3.3.3.3.1.1.1.2">𝑧</ci><list id="S4.E3.m1.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2"><apply id="S4.E3.m1.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1"><plus id="S4.E3.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.1"></plus><ci id="S4.E3.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.1.2">𝑛</ci><cn id="S4.E3.m1.2.2.2.2.2.2.1.3.cmml" type="integer" xref="S4.E3.m1.2.2.2.2.2.2.1.3">1</cn></apply><ci id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1">𝑘</ci></list></apply></apply></apply><apply id="S4.E3.m1.3.3.5.cmml" xref="S4.E3.m1.3.3.5"><plus id="S4.E3.m1.3.3.5.1.cmml" xref="S4.E3.m1.3.3.5.1"></plus><ci id="S4.E3.m1.3.3.5.2.cmml" xref="S4.E3.m1.3.3.5.2">𝑛</ci><cn id="S4.E3.m1.3.3.5.3.cmml" type="integer" xref="S4.E3.m1.3.3.5.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.3c">\pi_{k}\leftarrow\frac{n\pi_{k}+\gamma(z_{n+1,k})}{n+1}</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.3d">italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ← divide start_ARG italic_n italic_π start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_γ ( italic_z start_POSTSUBSCRIPT italic_n + 1 , italic_k end_POSTSUBSCRIPT ) end_ARG start_ARG italic_n + 1 end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.6">The updated parameters match those from applying Equation <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.E2" title="In 3.1 Clustering with Gaussian Mixture Models (GMMs) ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">2</span></a> to the points <math alttext="\{x_{i}\}_{i=1}^{n+1}" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><msubsup id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mrow id="S4.SS3.p3.1.m1.1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1.2.cmml"><mo id="S4.SS3.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS3.p3.1.m1.1.1.1.1.1.1" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.1.m1.1.1.1.1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS3.p3.1.m1.1.1.1.1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.p3.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS3.p3.1.m1.1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.1.3.cmml"><mi id="S4.SS3.p3.1.m1.1.1.1.3.2" xref="S4.SS3.p3.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p3.1.m1.1.1.1.3.1" xref="S4.SS3.p3.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS3.p3.1.m1.1.1.1.3.3" xref="S4.SS3.p3.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mrow id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml"><mi id="S4.SS3.p3.1.m1.1.1.3.2" xref="S4.SS3.p3.1.m1.1.1.3.2.cmml">n</mi><mo id="S4.SS3.p3.1.m1.1.1.3.1" xref="S4.SS3.p3.1.m1.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p3.1.m1.1.1.3.3" xref="S4.SS3.p3.1.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1">superscript</csymbol><apply id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1">subscript</csymbol><set id="S4.SS3.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1"><apply id="S4.SS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS3.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS3.p3.1.m1.1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.1.3"><eq id="S4.SS3.p3.1.m1.1.1.1.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.1.3.1"></eq><ci id="S4.SS3.p3.1.m1.1.1.1.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.1.3.2">𝑖</ci><cn id="S4.SS3.p3.1.m1.1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.1.m1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3"><plus id="S4.SS3.p3.1.m1.1.1.3.1.cmml" xref="S4.SS3.p3.1.m1.1.1.3.1"></plus><ci id="S4.SS3.p3.1.m1.1.1.3.2.cmml" xref="S4.SS3.p3.1.m1.1.1.3.2">𝑛</ci><cn id="S4.SS3.p3.1.m1.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\{x_{i}\}_{i=1}^{n+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">{ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n + 1 end_POSTSUPERSCRIPT</annotation></semantics></math>.
After updating the cluster parameters, we recompute the posterior for <math alttext="x_{n+1}" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m2.1"><semantics id="S4.SS3.p3.2.m2.1a"><msub id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">x</mi><mrow id="S4.SS3.p3.2.m2.1.1.3" xref="S4.SS3.p3.2.m2.1.1.3.cmml"><mi id="S4.SS3.p3.2.m2.1.1.3.2" xref="S4.SS3.p3.2.m2.1.1.3.2.cmml">n</mi><mo id="S4.SS3.p3.2.m2.1.1.3.1" xref="S4.SS3.p3.2.m2.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p3.2.m2.1.1.3.3" xref="S4.SS3.p3.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝑥</ci><apply id="S4.SS3.p3.2.m2.1.1.3.cmml" xref="S4.SS3.p3.2.m2.1.1.3"><plus id="S4.SS3.p3.2.m2.1.1.3.1.cmml" xref="S4.SS3.p3.2.m2.1.1.3.1"></plus><ci id="S4.SS3.p3.2.m2.1.1.3.2.cmml" xref="S4.SS3.p3.2.m2.1.1.3.2">𝑛</ci><cn id="S4.SS3.p3.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">x_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> and assign it to clusters <math alttext="\{k:\gamma(z_{n+1,k})&gt;0.1\}" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m3.4"><semantics id="S4.SS3.p3.3.m3.4a"><mrow id="S4.SS3.p3.3.m3.4.4.1" xref="S4.SS3.p3.3.m3.4.4.2.cmml"><mo id="S4.SS3.p3.3.m3.4.4.1.2" stretchy="false" xref="S4.SS3.p3.3.m3.4.4.2.1.cmml">{</mo><mi id="S4.SS3.p3.3.m3.3.3" xref="S4.SS3.p3.3.m3.3.3.cmml">k</mi><mo id="S4.SS3.p3.3.m3.4.4.1.3" lspace="0.278em" rspace="0.278em" xref="S4.SS3.p3.3.m3.4.4.2.1.cmml">:</mo><mrow id="S4.SS3.p3.3.m3.4.4.1.1" xref="S4.SS3.p3.3.m3.4.4.1.1.cmml"><mrow id="S4.SS3.p3.3.m3.4.4.1.1.1" xref="S4.SS3.p3.3.m3.4.4.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.4.4.1.1.1.3" xref="S4.SS3.p3.3.m3.4.4.1.1.1.3.cmml">γ</mi><mo id="S4.SS3.p3.3.m3.4.4.1.1.1.2" xref="S4.SS3.p3.3.m3.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p3.3.m3.4.4.1.1.1.1.1" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.2" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.2.cmml">z</mi><mrow id="S4.SS3.p3.3.m3.2.2.2.2" xref="S4.SS3.p3.3.m3.2.2.2.3.cmml"><mrow id="S4.SS3.p3.3.m3.2.2.2.2.1" xref="S4.SS3.p3.3.m3.2.2.2.2.1.cmml"><mi id="S4.SS3.p3.3.m3.2.2.2.2.1.2" xref="S4.SS3.p3.3.m3.2.2.2.2.1.2.cmml">n</mi><mo id="S4.SS3.p3.3.m3.2.2.2.2.1.1" xref="S4.SS3.p3.3.m3.2.2.2.2.1.1.cmml">+</mo><mn id="S4.SS3.p3.3.m3.2.2.2.2.1.3" xref="S4.SS3.p3.3.m3.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.SS3.p3.3.m3.2.2.2.2.2" xref="S4.SS3.p3.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p3.3.m3.1.1.1.1" xref="S4.SS3.p3.3.m3.1.1.1.1.cmml">k</mi></mrow></msub><mo id="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.p3.3.m3.4.4.1.1.2" xref="S4.SS3.p3.3.m3.4.4.1.1.2.cmml">&gt;</mo><mn id="S4.SS3.p3.3.m3.4.4.1.1.3" xref="S4.SS3.p3.3.m3.4.4.1.1.3.cmml">0.1</mn></mrow><mo id="S4.SS3.p3.3.m3.4.4.1.4" stretchy="false" xref="S4.SS3.p3.3.m3.4.4.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m3.4b"><apply id="S4.SS3.p3.3.m3.4.4.2.cmml" xref="S4.SS3.p3.3.m3.4.4.1"><csymbol cd="latexml" id="S4.SS3.p3.3.m3.4.4.2.1.cmml" xref="S4.SS3.p3.3.m3.4.4.1.2">conditional-set</csymbol><ci id="S4.SS3.p3.3.m3.3.3.cmml" xref="S4.SS3.p3.3.m3.3.3">𝑘</ci><apply id="S4.SS3.p3.3.m3.4.4.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1"><gt id="S4.SS3.p3.3.m3.4.4.1.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.2"></gt><apply id="S4.SS3.p3.3.m3.4.4.1.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1"><times id="S4.SS3.p3.3.m3.4.4.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1.2"></times><ci id="S4.SS3.p3.3.m3.4.4.1.1.1.3.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1.3">𝛾</ci><apply id="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p3.3.m3.4.4.1.1.1.1.1.1.2">𝑧</ci><list id="S4.SS3.p3.3.m3.2.2.2.3.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2"><apply id="S4.SS3.p3.3.m3.2.2.2.2.1.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.1"><plus id="S4.SS3.p3.3.m3.2.2.2.2.1.1.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.1.1"></plus><ci id="S4.SS3.p3.3.m3.2.2.2.2.1.2.cmml" xref="S4.SS3.p3.3.m3.2.2.2.2.1.2">𝑛</ci><cn id="S4.SS3.p3.3.m3.2.2.2.2.1.3.cmml" type="integer" xref="S4.SS3.p3.3.m3.2.2.2.2.1.3">1</cn></apply><ci id="S4.SS3.p3.3.m3.1.1.1.1.cmml" xref="S4.SS3.p3.3.m3.1.1.1.1">𝑘</ci></list></apply></apply><cn id="S4.SS3.p3.3.m3.4.4.1.1.3.cmml" type="float" xref="S4.SS3.p3.3.m3.4.4.1.1.3">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m3.4c">\{k:\gamma(z_{n+1,k})&gt;0.1\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m3.4d">{ italic_k : italic_γ ( italic_z start_POSTSUBSCRIPT italic_n + 1 , italic_k end_POSTSUBSCRIPT ) &gt; 0.1 }</annotation></semantics></math>, without affecting other point assignments.
Although this remains an approximation, it has been shown to be an effective way to incrementally fit a GMM <cite class="ltx_cite ltx_citemacro_citep">(Neal and Hinton, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib15" title="">1998</a>)</cite>.
The update is efficient, as its time is independent of <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m4.1"><semantics id="S4.SS3.p3.4.m4.1a"><mi id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m4.1b"><ci id="S4.SS3.p3.4.m4.1.1.cmml" xref="S4.SS3.p3.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m4.1d">italic_n</annotation></semantics></math>, with only a few clusters being updated (those assigned to <math alttext="x_{n+1}" class="ltx_Math" display="inline" id="S4.SS3.p3.5.m5.1"><semantics id="S4.SS3.p3.5.m5.1a"><msub id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml"><mi id="S4.SS3.p3.5.m5.1.1.2" xref="S4.SS3.p3.5.m5.1.1.2.cmml">x</mi><mrow id="S4.SS3.p3.5.m5.1.1.3" xref="S4.SS3.p3.5.m5.1.1.3.cmml"><mi id="S4.SS3.p3.5.m5.1.1.3.2" xref="S4.SS3.p3.5.m5.1.1.3.2.cmml">n</mi><mo id="S4.SS3.p3.5.m5.1.1.3.1" xref="S4.SS3.p3.5.m5.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p3.5.m5.1.1.3.3" xref="S4.SS3.p3.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m5.1b"><apply id="S4.SS3.p3.5.m5.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m5.1.1.1.cmml" xref="S4.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p3.5.m5.1.1.2.cmml" xref="S4.SS3.p3.5.m5.1.1.2">𝑥</ci><apply id="S4.SS3.p3.5.m5.1.1.3.cmml" xref="S4.SS3.p3.5.m5.1.1.3"><plus id="S4.SS3.p3.5.m5.1.1.3.1.cmml" xref="S4.SS3.p3.5.m5.1.1.3.1"></plus><ci id="S4.SS3.p3.5.m5.1.1.3.2.cmml" xref="S4.SS3.p3.5.m5.1.1.3.2">𝑛</ci><cn id="S4.SS3.p3.5.m5.1.1.3.3.cmml" type="integer" xref="S4.SS3.p3.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m5.1c">x_{n+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math>).
When <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p3.6.m6.1"><semantics id="S4.SS3.p3.6.m6.1a"><mi id="S4.SS3.p3.6.m6.1.1" xref="S4.SS3.p3.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m6.1b"><ci id="S4.SS3.p3.6.m6.1.1.cmml" xref="S4.SS3.p3.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.6.m6.1d">italic_n</annotation></semantics></math> is small, we perform full EM steps instead of updating using only the new point, as the smaller number of clusters makes this affordable.
This also yields more significant improvements, as clusterings with fewer points are more sensitive to new data.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.9">At this stage, an issue may arise as the number of clusters <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><mi id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><ci id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">italic_k</annotation></semantics></math> remains fixed, whether we use approximate or full EM steps.
If points are repeatedly added to the same cluster, it may grow too large, causing a node at layer 1 to resemble one at layer 3, which undermines the hierarchical structure.
To address large clusters, we attempt to split them, thereby increasing <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.1"><semantics id="S4.SS3.p4.2.m2.1a"><mi id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><ci id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.1d">italic_k</annotation></semantics></math>.
The splitting approach varies with <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p4.3.m3.1"><semantics id="S4.SS3.p4.3.m3.1a"><mi id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><ci id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.3.m3.1d">italic_n</annotation></semantics></math>.
For large <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p4.4.m4.1"><semantics id="S4.SS3.p4.4.m4.1a"><mi id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><ci id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.4.m4.1d">italic_n</annotation></semantics></math>, we focus on the large clusters independently of other clusters. We attempt to subdivide these large clusters by applying a GMM to them with <math alttext="k^{\prime}=1,2,3" class="ltx_Math" display="inline" id="S4.SS3.p4.5.m5.3"><semantics id="S4.SS3.p4.5.m5.3a"><mrow id="S4.SS3.p4.5.m5.3.4" xref="S4.SS3.p4.5.m5.3.4.cmml"><msup id="S4.SS3.p4.5.m5.3.4.2" xref="S4.SS3.p4.5.m5.3.4.2.cmml"><mi id="S4.SS3.p4.5.m5.3.4.2.2" xref="S4.SS3.p4.5.m5.3.4.2.2.cmml">k</mi><mo id="S4.SS3.p4.5.m5.3.4.2.3" xref="S4.SS3.p4.5.m5.3.4.2.3.cmml">′</mo></msup><mo id="S4.SS3.p4.5.m5.3.4.1" xref="S4.SS3.p4.5.m5.3.4.1.cmml">=</mo><mrow id="S4.SS3.p4.5.m5.3.4.3.2" xref="S4.SS3.p4.5.m5.3.4.3.1.cmml"><mn id="S4.SS3.p4.5.m5.1.1" xref="S4.SS3.p4.5.m5.1.1.cmml">1</mn><mo id="S4.SS3.p4.5.m5.3.4.3.2.1" xref="S4.SS3.p4.5.m5.3.4.3.1.cmml">,</mo><mn id="S4.SS3.p4.5.m5.2.2" xref="S4.SS3.p4.5.m5.2.2.cmml">2</mn><mo id="S4.SS3.p4.5.m5.3.4.3.2.2" xref="S4.SS3.p4.5.m5.3.4.3.1.cmml">,</mo><mn id="S4.SS3.p4.5.m5.3.3" xref="S4.SS3.p4.5.m5.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.5.m5.3b"><apply id="S4.SS3.p4.5.m5.3.4.cmml" xref="S4.SS3.p4.5.m5.3.4"><eq id="S4.SS3.p4.5.m5.3.4.1.cmml" xref="S4.SS3.p4.5.m5.3.4.1"></eq><apply id="S4.SS3.p4.5.m5.3.4.2.cmml" xref="S4.SS3.p4.5.m5.3.4.2"><csymbol cd="ambiguous" id="S4.SS3.p4.5.m5.3.4.2.1.cmml" xref="S4.SS3.p4.5.m5.3.4.2">superscript</csymbol><ci id="S4.SS3.p4.5.m5.3.4.2.2.cmml" xref="S4.SS3.p4.5.m5.3.4.2.2">𝑘</ci><ci id="S4.SS3.p4.5.m5.3.4.2.3.cmml" xref="S4.SS3.p4.5.m5.3.4.2.3">′</ci></apply><list id="S4.SS3.p4.5.m5.3.4.3.1.cmml" xref="S4.SS3.p4.5.m5.3.4.3.2"><cn id="S4.SS3.p4.5.m5.1.1.cmml" type="integer" xref="S4.SS3.p4.5.m5.1.1">1</cn><cn id="S4.SS3.p4.5.m5.2.2.cmml" type="integer" xref="S4.SS3.p4.5.m5.2.2">2</cn><cn id="S4.SS3.p4.5.m5.3.3.cmml" type="integer" xref="S4.SS3.p4.5.m5.3.3">3</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.5.m5.3c">k^{\prime}=1,2,3</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.5.m5.3d">italic_k start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = 1 , 2 , 3</annotation></semantics></math> subclusters, and we select the best model according to the Bayesian Information Criterion (BIC).
This method has a runtime independent of <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p4.6.m6.1"><semantics id="S4.SS3.p4.6.m6.1a"><mi id="S4.SS3.p4.6.m6.1.1" xref="S4.SS3.p4.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.6.m6.1b"><ci id="S4.SS3.p4.6.m6.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.6.m6.1d">italic_n</annotation></semantics></math>, and at most 3 clusters are updated or created.
For small <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p4.7.m7.1"><semantics id="S4.SS3.p4.7.m7.1a"><mi id="S4.SS3.p4.7.m7.1.1" xref="S4.SS3.p4.7.m7.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.7.m7.1b"><ci id="S4.SS3.p4.7.m7.1.1.cmml" xref="S4.SS3.p4.7.m7.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.7.m7.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.7.m7.1d">italic_n</annotation></semantics></math>, we explore larger values of <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p4.8.m8.1"><semantics id="S4.SS3.p4.8.m8.1a"><mi id="S4.SS3.p4.8.m8.1.1" xref="S4.SS3.p4.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.8.m8.1b"><ci id="S4.SS3.p4.8.m8.1.1.cmml" xref="S4.SS3.p4.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.8.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.8.m8.1d">italic_k</annotation></semantics></math> and fit a new GMM from scratch, selecting the <math alttext="k" class="ltx_Math" display="inline" id="S4.SS3.p4.9.m9.1"><semantics id="S4.SS3.p4.9.m9.1a"><mi id="S4.SS3.p4.9.m9.1.1" xref="S4.SS3.p4.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.9.m9.1b"><ci id="S4.SS3.p4.9.m9.1.1.cmml" xref="S4.SS3.p4.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.9.m9.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.9.m9.1d">italic_k</annotation></semantics></math> that optimizes the BIC.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.3">We summarize these ideas in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg2" title="Algorithm 2 ‣ 4.3 Adaptive GMM ‣ 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">2</span></a>.
The parameter <math alttext="\tau_{n}" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.1"><semantics id="S4.SS3.p5.1.m1.1a"><msub id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">τ</mi><mi id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝜏</ci><ci id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">\tau_{n}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.1d">italic_τ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> controls the trade-off between quality and computation time, determining whether to perform full or approximate EM updates based on <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.p5.2.m2.1"><semantics id="S4.SS3.p5.2.m2.1a"><mi id="S4.SS3.p5.2.m2.1.1" xref="S4.SS3.p5.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.2.m2.1b"><ci id="S4.SS3.p5.2.m2.1.1.cmml" xref="S4.SS3.p5.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.2.m2.1d">italic_n</annotation></semantics></math>.
Similarly, <math alttext="\tau_{c}" class="ltx_Math" display="inline" id="S4.SS3.p5.3.m3.1"><semantics id="S4.SS3.p5.3.m3.1a"><msub id="S4.SS3.p5.3.m3.1.1" xref="S4.SS3.p5.3.m3.1.1.cmml"><mi id="S4.SS3.p5.3.m3.1.1.2" xref="S4.SS3.p5.3.m3.1.1.2.cmml">τ</mi><mi id="S4.SS3.p5.3.m3.1.1.3" xref="S4.SS3.p5.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.3.m3.1b"><apply id="S4.SS3.p5.3.m3.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.3.m3.1.1.1.cmml" xref="S4.SS3.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p5.3.m3.1.1.2.cmml" xref="S4.SS3.p5.3.m3.1.1.2">𝜏</ci><ci id="S4.SS3.p5.3.m3.1.1.3.cmml" xref="S4.SS3.p5.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.3.m3.1c">\tau_{c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.3.m3.1d">italic_τ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> sets the cluster size threshold for triggering a potential split.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Adaptive Clustering</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg2.l1.1">Input:</span> GMM Instance <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">caligraphic_I</annotation></semantics></math> with <math alttext="n" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_n</annotation></semantics></math> points, new point <math alttext="x_{n+1}" class="ltx_Math" display="inline" id="alg2.l1.m3.1"><semantics id="alg2.l1.m3.1a"><msub id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml"><mi id="alg2.l1.m3.1.1.2" xref="alg2.l1.m3.1.1.2.cmml">x</mi><mrow id="alg2.l1.m3.1.1.3" xref="alg2.l1.m3.1.1.3.cmml"><mi id="alg2.l1.m3.1.1.3.2" xref="alg2.l1.m3.1.1.3.2.cmml">n</mi><mo id="alg2.l1.m3.1.1.3.1" xref="alg2.l1.m3.1.1.3.1.cmml">+</mo><mn id="alg2.l1.m3.1.1.3.3" xref="alg2.l1.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><apply id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1"><csymbol cd="ambiguous" id="alg2.l1.m3.1.1.1.cmml" xref="alg2.l1.m3.1.1">subscript</csymbol><ci id="alg2.l1.m3.1.1.2.cmml" xref="alg2.l1.m3.1.1.2">𝑥</ci><apply id="alg2.l1.m3.1.1.3.cmml" xref="alg2.l1.m3.1.1.3"><plus id="alg2.l1.m3.1.1.3.1.cmml" xref="alg2.l1.m3.1.1.3.1"></plus><ci id="alg2.l1.m3.1.1.3.2.cmml" xref="alg2.l1.m3.1.1.3.2">𝑛</ci><cn id="alg2.l1.m3.1.1.3.3.cmml" type="integer" xref="alg2.l1.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">x_{n+1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m3.1d">italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math>, thresholds <math alttext="\tau_{n},\tau_{c}" class="ltx_Math" display="inline" id="alg2.l1.m4.2"><semantics id="alg2.l1.m4.2a"><mrow id="alg2.l1.m4.2.2.2" xref="alg2.l1.m4.2.2.3.cmml"><msub id="alg2.l1.m4.1.1.1.1" xref="alg2.l1.m4.1.1.1.1.cmml"><mi id="alg2.l1.m4.1.1.1.1.2" xref="alg2.l1.m4.1.1.1.1.2.cmml">τ</mi><mi id="alg2.l1.m4.1.1.1.1.3" xref="alg2.l1.m4.1.1.1.1.3.cmml">n</mi></msub><mo id="alg2.l1.m4.2.2.2.3" xref="alg2.l1.m4.2.2.3.cmml">,</mo><msub id="alg2.l1.m4.2.2.2.2" xref="alg2.l1.m4.2.2.2.2.cmml"><mi id="alg2.l1.m4.2.2.2.2.2" xref="alg2.l1.m4.2.2.2.2.2.cmml">τ</mi><mi id="alg2.l1.m4.2.2.2.2.3" xref="alg2.l1.m4.2.2.2.2.3.cmml">c</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.2b"><list id="alg2.l1.m4.2.2.3.cmml" xref="alg2.l1.m4.2.2.2"><apply id="alg2.l1.m4.1.1.1.1.cmml" xref="alg2.l1.m4.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m4.1.1.1.1.1.cmml" xref="alg2.l1.m4.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m4.1.1.1.1.2.cmml" xref="alg2.l1.m4.1.1.1.1.2">𝜏</ci><ci id="alg2.l1.m4.1.1.1.1.3.cmml" xref="alg2.l1.m4.1.1.1.1.3">𝑛</ci></apply><apply id="alg2.l1.m4.2.2.2.2.cmml" xref="alg2.l1.m4.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m4.2.2.2.2.1.cmml" xref="alg2.l1.m4.2.2.2.2">subscript</csymbol><ci id="alg2.l1.m4.2.2.2.2.2.cmml" xref="alg2.l1.m4.2.2.2.2.2">𝜏</ci><ci id="alg2.l1.m4.2.2.2.2.3.cmml" xref="alg2.l1.m4.2.2.2.2.3">𝑐</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.2c">\tau_{n},\tau_{c}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m4.2d">italic_τ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , italic_τ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg2.l2.1">Output:</span> Updated Instance <math alttext="\mathcal{I^{\prime}}" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><msup id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">ℐ</mi><mo id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">superscript</csymbol><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">ℐ</ci><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\mathcal{I^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">caligraphic_I start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span><span class="ltx_text ltx_font_bold" id="alg2.l3.1">if</span> <math alttext="n\leq\tau_{n}" class="ltx_Math" display="inline" id="alg2.l3.m1.1"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">n</mi><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">≤</mo><msub id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml"><mi id="alg2.l3.m1.1.1.3.2" xref="alg2.l3.m1.1.1.3.2.cmml">τ</mi><mi id="alg2.l3.m1.1.1.3.3" xref="alg2.l3.m1.1.1.3.3.cmml">n</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><leq id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></leq><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝑛</ci><apply id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.3.1.cmml" xref="alg2.l3.m1.1.1.3">subscript</csymbol><ci id="alg2.l3.m1.1.1.3.2.cmml" xref="alg2.l3.m1.1.1.3.2">𝜏</ci><ci id="alg2.l3.m1.1.1.3.3.cmml" xref="alg2.l3.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">n\leq\tau_{n}</annotation><annotation encoding="application/x-llamapun" id="alg2.l3.m1.1d">italic_n ≤ italic_τ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg2.l3.2">then</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     Perform full EM steps until convergence.

</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>     Let <math alttext="c" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><mi id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">c</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">italic_c</annotation></semantics></math> be the number of clusters with more than <math alttext="\tau_{c}" class="ltx_Math" display="inline" id="alg2.l5.m2.1"><semantics id="alg2.l5.m2.1a"><msub id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">τ</mi><mi id="alg2.l5.m2.1.1.3" xref="alg2.l5.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><csymbol cd="ambiguous" id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1">subscript</csymbol><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">𝜏</ci><ci id="alg2.l5.m2.1.1.3.cmml" xref="alg2.l5.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">\tau_{c}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.1d">italic_τ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> points.

</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>     Fit GMM instances with <math alttext="K" class="ltx_Math" display="inline" id="alg2.l6.m1.1"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.1d">italic_K</annotation></semantics></math> up to <math alttext="K+c" class="ltx_Math" display="inline" id="alg2.l6.m2.1"><semantics id="alg2.l6.m2.1a"><mrow id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml"><mi id="alg2.l6.m2.1.1.2" xref="alg2.l6.m2.1.1.2.cmml">K</mi><mo id="alg2.l6.m2.1.1.1" xref="alg2.l6.m2.1.1.1.cmml">+</mo><mi id="alg2.l6.m2.1.1.3" xref="alg2.l6.m2.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><apply id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"><plus id="alg2.l6.m2.1.1.1.cmml" xref="alg2.l6.m2.1.1.1"></plus><ci id="alg2.l6.m2.1.1.2.cmml" xref="alg2.l6.m2.1.1.2">𝐾</ci><ci id="alg2.l6.m2.1.1.3.cmml" xref="alg2.l6.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">K+c</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m2.1d">italic_K + italic_c</annotation></semantics></math> clusters, keeping the best one with respect to BIC.

</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span><span class="ltx_text ltx_font_bold" id="alg2.l7.1">else</span>
</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     Perform a maximization step using <math alttext="x_{n+1}" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><msub id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">x</mi><mrow id="alg2.l8.m1.1.1.3" xref="alg2.l8.m1.1.1.3.cmml"><mi id="alg2.l8.m1.1.1.3.2" xref="alg2.l8.m1.1.1.3.2.cmml">n</mi><mo id="alg2.l8.m1.1.1.3.1" xref="alg2.l8.m1.1.1.3.1.cmml">+</mo><mn id="alg2.l8.m1.1.1.3.3" xref="alg2.l8.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1">subscript</csymbol><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝑥</ci><apply id="alg2.l8.m1.1.1.3.cmml" xref="alg2.l8.m1.1.1.3"><plus id="alg2.l8.m1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.3.1"></plus><ci id="alg2.l8.m1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.3.2">𝑛</ci><cn id="alg2.l8.m1.1.1.3.3.cmml" type="integer" xref="alg2.l8.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">x_{n+1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math>’s contribution.

</div>
<div class="ltx_listingline" id="alg2.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     Assign <math alttext="x_{n+1}" class="ltx_Math" display="inline" id="alg2.l9.m1.1"><semantics id="alg2.l9.m1.1a"><msub id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml">x</mi><mrow id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml"><mi id="alg2.l9.m1.1.1.3.2" xref="alg2.l9.m1.1.1.3.2.cmml">n</mi><mo id="alg2.l9.m1.1.1.3.1" xref="alg2.l9.m1.1.1.3.1.cmml">+</mo><mn id="alg2.l9.m1.1.1.3.3" xref="alg2.l9.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1">subscript</csymbol><ci id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2">𝑥</ci><apply id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3"><plus id="alg2.l9.m1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.3.1"></plus><ci id="alg2.l9.m1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.3.2">𝑛</ci><cn id="alg2.l9.m1.1.1.3.3.cmml" type="integer" xref="alg2.l9.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">x_{n+1}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m1.1d">italic_x start_POSTSUBSCRIPT italic_n + 1 end_POSTSUBSCRIPT</annotation></semantics></math> to clusters <math alttext="\{k:\gamma(z_{n+1,k})&gt;0.1\}" class="ltx_Math" display="inline" id="alg2.l9.m2.4"><semantics id="alg2.l9.m2.4a"><mrow id="alg2.l9.m2.4.4.1" xref="alg2.l9.m2.4.4.2.cmml"><mo id="alg2.l9.m2.4.4.1.2" stretchy="false" xref="alg2.l9.m2.4.4.2.1.cmml">{</mo><mi id="alg2.l9.m2.3.3" xref="alg2.l9.m2.3.3.cmml">k</mi><mo id="alg2.l9.m2.4.4.1.3" lspace="0.278em" rspace="0.278em" xref="alg2.l9.m2.4.4.2.1.cmml">:</mo><mrow id="alg2.l9.m2.4.4.1.1" xref="alg2.l9.m2.4.4.1.1.cmml"><mrow id="alg2.l9.m2.4.4.1.1.1" xref="alg2.l9.m2.4.4.1.1.1.cmml"><mi id="alg2.l9.m2.4.4.1.1.1.3" xref="alg2.l9.m2.4.4.1.1.1.3.cmml">γ</mi><mo id="alg2.l9.m2.4.4.1.1.1.2" xref="alg2.l9.m2.4.4.1.1.1.2.cmml">⁢</mo><mrow id="alg2.l9.m2.4.4.1.1.1.1.1" xref="alg2.l9.m2.4.4.1.1.1.1.1.1.cmml"><mo id="alg2.l9.m2.4.4.1.1.1.1.1.2" stretchy="false" xref="alg2.l9.m2.4.4.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l9.m2.4.4.1.1.1.1.1.1" xref="alg2.l9.m2.4.4.1.1.1.1.1.1.cmml"><mi id="alg2.l9.m2.4.4.1.1.1.1.1.1.2" xref="alg2.l9.m2.4.4.1.1.1.1.1.1.2.cmml">z</mi><mrow id="alg2.l9.m2.2.2.2.2" xref="alg2.l9.m2.2.2.2.3.cmml"><mrow id="alg2.l9.m2.2.2.2.2.1" xref="alg2.l9.m2.2.2.2.2.1.cmml"><mi id="alg2.l9.m2.2.2.2.2.1.2" xref="alg2.l9.m2.2.2.2.2.1.2.cmml">n</mi><mo id="alg2.l9.m2.2.2.2.2.1.1" xref="alg2.l9.m2.2.2.2.2.1.1.cmml">+</mo><mn id="alg2.l9.m2.2.2.2.2.1.3" xref="alg2.l9.m2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="alg2.l9.m2.2.2.2.2.2" xref="alg2.l9.m2.2.2.2.3.cmml">,</mo><mi id="alg2.l9.m2.1.1.1.1" xref="alg2.l9.m2.1.1.1.1.cmml">k</mi></mrow></msub><mo id="alg2.l9.m2.4.4.1.1.1.1.1.3" stretchy="false" xref="alg2.l9.m2.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l9.m2.4.4.1.1.2" xref="alg2.l9.m2.4.4.1.1.2.cmml">&gt;</mo><mn id="alg2.l9.m2.4.4.1.1.3" xref="alg2.l9.m2.4.4.1.1.3.cmml">0.1</mn></mrow><mo id="alg2.l9.m2.4.4.1.4" stretchy="false" xref="alg2.l9.m2.4.4.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.4b"><apply id="alg2.l9.m2.4.4.2.cmml" xref="alg2.l9.m2.4.4.1"><csymbol cd="latexml" id="alg2.l9.m2.4.4.2.1.cmml" xref="alg2.l9.m2.4.4.1.2">conditional-set</csymbol><ci id="alg2.l9.m2.3.3.cmml" xref="alg2.l9.m2.3.3">𝑘</ci><apply id="alg2.l9.m2.4.4.1.1.cmml" xref="alg2.l9.m2.4.4.1.1"><gt id="alg2.l9.m2.4.4.1.1.2.cmml" xref="alg2.l9.m2.4.4.1.1.2"></gt><apply id="alg2.l9.m2.4.4.1.1.1.cmml" xref="alg2.l9.m2.4.4.1.1.1"><times id="alg2.l9.m2.4.4.1.1.1.2.cmml" xref="alg2.l9.m2.4.4.1.1.1.2"></times><ci id="alg2.l9.m2.4.4.1.1.1.3.cmml" xref="alg2.l9.m2.4.4.1.1.1.3">𝛾</ci><apply id="alg2.l9.m2.4.4.1.1.1.1.1.1.cmml" xref="alg2.l9.m2.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.4.4.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m2.4.4.1.1.1.1.1">subscript</csymbol><ci id="alg2.l9.m2.4.4.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m2.4.4.1.1.1.1.1.1.2">𝑧</ci><list id="alg2.l9.m2.2.2.2.3.cmml" xref="alg2.l9.m2.2.2.2.2"><apply id="alg2.l9.m2.2.2.2.2.1.cmml" xref="alg2.l9.m2.2.2.2.2.1"><plus id="alg2.l9.m2.2.2.2.2.1.1.cmml" xref="alg2.l9.m2.2.2.2.2.1.1"></plus><ci id="alg2.l9.m2.2.2.2.2.1.2.cmml" xref="alg2.l9.m2.2.2.2.2.1.2">𝑛</ci><cn id="alg2.l9.m2.2.2.2.2.1.3.cmml" type="integer" xref="alg2.l9.m2.2.2.2.2.1.3">1</cn></apply><ci id="alg2.l9.m2.1.1.1.1.cmml" xref="alg2.l9.m2.1.1.1.1">𝑘</ci></list></apply></apply><cn id="alg2.l9.m2.4.4.1.1.3.cmml" type="float" xref="alg2.l9.m2.4.4.1.1.3">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.4c">\{k:\gamma(z_{n+1,k})&gt;0.1\}</annotation><annotation encoding="application/x-llamapun" id="alg2.l9.m2.4d">{ italic_k : italic_γ ( italic_z start_POSTSUBSCRIPT italic_n + 1 , italic_k end_POSTSUBSCRIPT ) &gt; 0.1 }</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg2.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     <span class="ltx_text ltx_font_bold" id="alg2.l10.1">if</span> some cluster <math alttext="k" class="ltx_Math" display="inline" id="alg2.l10.m1.1"><semantics id="alg2.l10.m1.1a"><mi id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><ci id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m1.1d">italic_k</annotation></semantics></math> contains more than <math alttext="\tau_{c}" class="ltx_Math" display="inline" id="alg2.l10.m2.1"><semantics id="alg2.l10.m2.1a"><msub id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml"><mi id="alg2.l10.m2.1.1.2" xref="alg2.l10.m2.1.1.2.cmml">τ</mi><mi id="alg2.l10.m2.1.1.3" xref="alg2.l10.m2.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><apply id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1"><csymbol cd="ambiguous" id="alg2.l10.m2.1.1.1.cmml" xref="alg2.l10.m2.1.1">subscript</csymbol><ci id="alg2.l10.m2.1.1.2.cmml" xref="alg2.l10.m2.1.1.2">𝜏</ci><ci id="alg2.l10.m2.1.1.3.cmml" xref="alg2.l10.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">\tau_{c}</annotation><annotation encoding="application/x-llamapun" id="alg2.l10.m2.1d">italic_τ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> points <span class="ltx_text ltx_font_bold" id="alg2.l10.2">then</span>
</div>
<div class="ltx_listingline" id="alg2.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>         Fit a GMM on cluster <math alttext="k" class="ltx_Math" display="inline" id="alg2.l11.m1.1"><semantics id="alg2.l11.m1.1a"><mi id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><ci id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg2.l11.m1.1d">italic_k</annotation></semantics></math> to get a sub-clustering with at most 3 clusters.

</div>
<div class="ltx_listingline" id="alg2.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <span class="ltx_text ltx_font_bold" id="alg2.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l12.2">if</span>
</div>
<div class="ltx_listingline" id="alg2.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span><span class="ltx_text ltx_font_bold" id="alg2.l13.1">end</span> <span class="ltx_text ltx_font_bold" id="alg2.l13.2">if</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>adRAP Algorithm</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.5">The process starts with an initial tree <math alttext="T_{0}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">T</mi><mn id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝑇</ci><cn id="S4.SS4.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS4.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">T_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and a new data chunk <math alttext="d\in D_{1}" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml">d</mi><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">∈</mo><msub id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml"><mi id="S4.SS4.p1.2.m2.1.1.3.2" xref="S4.SS4.p1.2.m2.1.1.3.2.cmml">D</mi><mn id="S4.SS4.p1.2.m2.1.1.3.3" xref="S4.SS4.p1.2.m2.1.1.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><in id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1"></in><ci id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2">𝑑</ci><apply id="S4.SS4.p1.2.m2.1.1.3.cmml" xref="S4.SS4.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.3.1.cmml" xref="S4.SS4.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.3.2.cmml" xref="S4.SS4.p1.2.m2.1.1.3.2">𝐷</ci><cn id="S4.SS4.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S4.SS4.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">d\in D_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_d ∈ italic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
First, <math alttext="d" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mi id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><ci id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_d</annotation></semantics></math>’s embedding <math alttext="v" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><mi id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><ci id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">italic_v</annotation></semantics></math> is computed, and a corresponding leaf node is created in <math alttext="T_{0}" class="ltx_Math" display="inline" id="S4.SS4.p1.5.m5.1"><semantics id="S4.SS4.p1.5.m5.1a"><msub id="S4.SS4.p1.5.m5.1.1" xref="S4.SS4.p1.5.m5.1.1.cmml"><mi id="S4.SS4.p1.5.m5.1.1.2" xref="S4.SS4.p1.5.m5.1.1.2.cmml">T</mi><mn id="S4.SS4.p1.5.m5.1.1.3" xref="S4.SS4.p1.5.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.5.m5.1b"><apply id="S4.SS4.p1.5.m5.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.5.m5.1.1.1.cmml" xref="S4.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.p1.5.m5.1.1.2.cmml" xref="S4.SS4.p1.5.m5.1.1.2">𝑇</ci><cn id="S4.SS4.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS4.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.5.m5.1c">T_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.5.m5.1d">italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>.
The first layer above the leaves (call it layer 1) is then updated to account for the new node.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.5">To do so, the global reduced embedding <math alttext="v_{g}" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><msub id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml"><mi id="S4.SS4.p2.1.m1.1.1.2" xref="S4.SS4.p2.1.m1.1.1.2.cmml">v</mi><mi id="S4.SS4.p2.1.m1.1.1.3" xref="S4.SS4.p2.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><apply id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.1.m1.1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p2.1.m1.1.1.2.cmml" xref="S4.SS4.p2.1.m1.1.1.2">𝑣</ci><ci id="S4.SS4.p2.1.m1.1.1.3.cmml" xref="S4.SS4.p2.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">v_{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> is derived from <math alttext="v" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_v</annotation></semantics></math> using the global UMAP model and assigned to the most probable cluster in the global clustering.
Since the global clustering includes all <math alttext="|D_{0}|" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.1"><semantics id="S4.SS4.p2.3.m3.1a"><mrow id="S4.SS4.p2.3.m3.1.1.1" xref="S4.SS4.p2.3.m3.1.1.2.cmml"><mo id="S4.SS4.p2.3.m3.1.1.1.2" stretchy="false" xref="S4.SS4.p2.3.m3.1.1.2.1.cmml">|</mo><msub id="S4.SS4.p2.3.m3.1.1.1.1" xref="S4.SS4.p2.3.m3.1.1.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.1.1.2" xref="S4.SS4.p2.3.m3.1.1.1.1.2.cmml">D</mi><mn id="S4.SS4.p2.3.m3.1.1.1.1.3" xref="S4.SS4.p2.3.m3.1.1.1.1.3.cmml">0</mn></msub><mo id="S4.SS4.p2.3.m3.1.1.1.3" stretchy="false" xref="S4.SS4.p2.3.m3.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.1"><abs id="S4.SS4.p2.3.m3.1.1.2.1.cmml" xref="S4.SS4.p2.3.m3.1.1.1.2"></abs><apply id="S4.SS4.p2.3.m3.1.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.1.1.2">𝐷</ci><cn id="S4.SS4.p2.3.m3.1.1.1.1.3.cmml" type="integer" xref="S4.SS4.p2.3.m3.1.1.1.1.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">|D_{0}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.1d">| italic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT |</annotation></semantics></math> nodes, it is considered stable and no dynamic adjustments are made.
Next, we focus on the global cluster to which <math alttext="v_{g}" class="ltx_Math" display="inline" id="S4.SS4.p2.4.m4.1"><semantics id="S4.SS4.p2.4.m4.1a"><msub id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml"><mi id="S4.SS4.p2.4.m4.1.1.2" xref="S4.SS4.p2.4.m4.1.1.2.cmml">v</mi><mi id="S4.SS4.p2.4.m4.1.1.3" xref="S4.SS4.p2.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><apply id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.4.m4.1.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p2.4.m4.1.1.2.cmml" xref="S4.SS4.p2.4.m4.1.1.2">𝑣</ci><ci id="S4.SS4.p2.4.m4.1.1.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">v_{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.4.m4.1d">italic_v start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> was assigned, applying the local UMAP model to compute a reduced local embedding <math alttext="v_{l}" class="ltx_Math" display="inline" id="S4.SS4.p2.5.m5.1"><semantics id="S4.SS4.p2.5.m5.1a"><msub id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml"><mi id="S4.SS4.p2.5.m5.1.1.2" xref="S4.SS4.p2.5.m5.1.1.2.cmml">v</mi><mi id="S4.SS4.p2.5.m5.1.1.3" xref="S4.SS4.p2.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b"><apply id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.5.m5.1.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.p2.5.m5.1.1.2.cmml" xref="S4.SS4.p2.5.m5.1.1.2">𝑣</ci><ci id="S4.SS4.p2.5.m5.1.1.3.cmml" xref="S4.SS4.p2.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">v_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.5.m5.1d">italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>.
The local clustering is updated using Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg2" title="Algorithm 2 ‣ 4.3 Adaptive GMM ‣ 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">2</span></a>, potentially creating new nodes.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.3">In <math alttext="T_{0}" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><msub id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">T</mi><mn id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">𝑇</ci><cn id="S4.SS4.p3.1.m1.1.1.3.cmml" type="integer" xref="S4.SS4.p3.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">T_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, nodes with updated children regenerate their summaries and recompute embeddings, with updates propagated to their ancestors (up to five levels).
If new clusters are created at layer <math alttext="i" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><mi id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><ci id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">italic_i</annotation></semantics></math>, this procedure is recursively applied at layer <math alttext="i+1" class="ltx_Math" display="inline" id="S4.SS4.p3.3.m3.1"><semantics id="S4.SS4.p3.3.m3.1a"><mrow id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml"><mi id="S4.SS4.p3.3.m3.1.1.2" xref="S4.SS4.p3.3.m3.1.1.2.cmml">i</mi><mo id="S4.SS4.p3.3.m3.1.1.1" xref="S4.SS4.p3.3.m3.1.1.1.cmml">+</mo><mn id="S4.SS4.p3.3.m3.1.1.3" xref="S4.SS4.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><apply id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1"><plus id="S4.SS4.p3.3.m3.1.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1.1"></plus><ci id="S4.SS4.p3.3.m3.1.1.2.cmml" xref="S4.SS4.p3.3.m3.1.1.2">𝑖</ci><cn id="S4.SS4.p3.3.m3.1.1.3.cmml" type="integer" xref="S4.SS4.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">i+1</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.3.m3.1d">italic_i + 1</annotation></semantics></math>.
By design, only a few clusters are affected, minimizing the need for summary re-computation. To illustrate this, we compare in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS2" title="H.2 adRAP Runtime ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">H.2</span></a> the runtime and number of generated summaries between adRAP and a full re-computation of the tree. Moreover, the pseudo-code of adRAP is presented in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A1" title="Appendix A Pseudocodes ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1">Though we focused on adding documents, the algorithm easily handles deletions by removing the chunk from the tree and recomputing summaries for its ancestors.
For frequent deletions, one can either recompute the local clustering by trying smaller values for <math alttext="K" class="ltx_Math" display="inline" id="S4.SS4.p4.1.m1.1"><semantics id="S4.SS4.p4.1.m1.1a"><mi id="S4.SS4.p4.1.m1.1.1" xref="S4.SS4.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.1b"><ci id="S4.SS4.p4.1.m1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.1.m1.1d">italic_K</annotation></semantics></math> or leave the clusters unchanged.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>postQFRAP: post-retrieval Query-Focused Recursive-Abstractive Processing</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Motivation</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Maintaining adRAP is costly, as it requires updating clusters and summaries with each new document.
Moreover, when many documents are added, the entire tree has to be recomputed to maintain solution quality.
Integrating this system poses significant development challenges, and companies with established retrieval algorithms may be hesitant to adopt a completely new system.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">To address this, we propose a modified version of the recursive-abstractive tree as a black-box post-retrieval solution that can be integrated with retrieval algorithms handling dynamic datasets (e.g., naïve RAG).
This approach enhances the initial construction by incorporating query-focused summaries, improving the context relevance of the output.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>postQFRAP Algorithm</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.4">Let <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">caligraphic_R</annotation></semantics></math> be a retrieval algorithm that takes as input an integer <math alttext="k\in\mathbb{N}^{+}" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">k</mi><mo id="S5.SS2.p1.2.m2.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml"><mi id="S5.SS2.p1.2.m2.1.1.3.2" xref="S5.SS2.p1.2.m2.1.1.3.2.cmml">ℕ</mi><mo id="S5.SS2.p1.2.m2.1.1.3.3" xref="S5.SS2.p1.2.m2.1.1.3.3.cmml">+</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><in id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1"></in><ci id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2">𝑘</ci><apply id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p1.2.m2.1.1.3.1.cmml" xref="S5.SS2.p1.2.m2.1.1.3">superscript</csymbol><ci id="S5.SS2.p1.2.m2.1.1.3.2.cmml" xref="S5.SS2.p1.2.m2.1.1.3.2">ℕ</ci><plus id="S5.SS2.p1.2.m2.1.1.3.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">k\in\mathbb{N}^{+}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">italic_k ∈ blackboard_N start_POSTSUPERSCRIPT + end_POSTSUPERSCRIPT</annotation></semantics></math> and a query <math alttext="q" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">italic_q</annotation></semantics></math>, and returns <math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.1"><semantics id="S5.SS2.p1.4.m4.1a"><mi id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><ci id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.1d">italic_k</annotation></semantics></math> documents relevant to the query. A simple example is the naïve RAG algorithm <cite class="ltx_cite ltx_citemacro_citep">(Gao et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib7" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.6">We augment <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">caligraphic_R</annotation></semantics></math> as follows.
First, we retrieve <math alttext="k_{0}" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.1"><semantics id="S5.SS2.p2.2.m2.1a"><msub id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml"><mi id="S5.SS2.p2.2.m2.1.1.2" xref="S5.SS2.p2.2.m2.1.1.2.cmml">k</mi><mn id="S5.SS2.p2.2.m2.1.1.3" xref="S5.SS2.p2.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.2.m2.1.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.p2.2.m2.1.1.2.cmml" xref="S5.SS2.p2.2.m2.1.1.2">𝑘</ci><cn id="S5.SS2.p2.2.m2.1.1.3.cmml" type="integer" xref="S5.SS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.2.m2.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> documents without imposing a token limit.
Then, we apply a query-focused version of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg1" title="Algorithm 1 ‣ Recursive Construction ‣ 3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">1</span></a> to these <math alttext="k_{0}" class="ltx_Math" display="inline" id="S5.SS2.p2.3.m3.1"><semantics id="S5.SS2.p2.3.m3.1a"><msub id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml"><mi id="S5.SS2.p2.3.m3.1.1.2" xref="S5.SS2.p2.3.m3.1.1.2.cmml">k</mi><mn id="S5.SS2.p2.3.m3.1.1.3" xref="S5.SS2.p2.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b"><apply id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.3.m3.1.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.p2.3.m3.1.1.2.cmml" xref="S5.SS2.p2.3.m3.1.1.2">𝑘</ci><cn id="S5.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S5.SS2.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.3.m3.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> documents to build a recursive-abstractive tree.
The key modification is using query-focused summarization (see prompt in Appendix, Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7.T5" title="Table 5 ‣ Appendix G Prompts ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">5</span></a>).
Since the tree is constructed to answer <math alttext="q" class="ltx_Math" display="inline" id="S5.SS2.p2.4.m4.1"><semantics id="S5.SS2.p2.4.m4.1a"><mi id="S5.SS2.p2.4.m4.1.1" xref="S5.SS2.p2.4.m4.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m4.1b"><ci id="S5.SS2.p2.4.m4.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m4.1c">q</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.4.m4.1d">italic_q</annotation></semantics></math>, summarizing information relevant to <math alttext="q" class="ltx_Math" display="inline" id="S5.SS2.p2.5.m5.1"><semantics id="S5.SS2.p2.5.m5.1a"><mi id="S5.SS2.p2.5.m5.1.1" xref="S5.SS2.p2.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.5.m5.1b"><ci id="S5.SS2.p2.5.m5.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.5.m5.1c">q</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.5.m5.1d">italic_q</annotation></semantics></math> ensures that key details are preserved while recursively filtering out irrelevant content.
Additionally, we modify the clustering to rely solely on local embeddings, as retrieving <math alttext="k_{0}" class="ltx_Math" display="inline" id="S5.SS2.p2.6.m6.1"><semantics id="S5.SS2.p2.6.m6.1a"><msub id="S5.SS2.p2.6.m6.1.1" xref="S5.SS2.p2.6.m6.1.1.cmml"><mi id="S5.SS2.p2.6.m6.1.1.2" xref="S5.SS2.p2.6.m6.1.1.2.cmml">k</mi><mn id="S5.SS2.p2.6.m6.1.1.3" xref="S5.SS2.p2.6.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.6.m6.1b"><apply id="S5.SS2.p2.6.m6.1.1.cmml" xref="S5.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.6.m6.1.1.1.cmml" xref="S5.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S5.SS2.p2.6.m6.1.1.2.cmml" xref="S5.SS2.p2.6.m6.1.1.2">𝑘</ci><cn id="S5.SS2.p2.6.m6.1.1.3.cmml" type="integer" xref="S5.SS2.p2.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.6.m6.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.6.m6.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> documents already serves as a global filtering step.
In other words, we assume the retrieved documents belong to the same global cluster.
We demonstrate in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A2" title="Appendix B Comparing one- vs two-step Clustering for postQFRAP ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">B</span></a> that using the simpler one-step clustering preserves the quality of the generated context compared to the two-step approach.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Finally, a summarization step is applied to all nodes at the last layer of the tree, instead of using a top-<math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.1"><semantics id="S5.SS2.p3.1.m1.1a"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.1d">italic_k</annotation></semantics></math> retrieval approach, to reduce redundancy in the results.
This process is detailed in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg3" title="Algorithm 3 ‣ 5.2 postQFRAP Algorithm ‣ 5 postQFRAP: post-retrieval Query-Focused Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg3.2.1.1">Algorithm 3</span> </span> postQFRAP Algorithm</figcaption>
<div class="ltx_listing ltx_listing" id="alg3.3">
<div class="ltx_listingline" id="alg3.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg3.l1.1">Input:</span> Retrieval Algorithm <math alttext="\mathcal{R}" class="ltx_Math" display="inline" id="alg3.l1.m1.1"><semantics id="alg3.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><ci id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">\mathcal{R}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m1.1d">caligraphic_R</annotation></semantics></math>, Initial Number of Chunks <math alttext="k_{0}" class="ltx_Math" display="inline" id="alg3.l1.m2.1"><semantics id="alg3.l1.m2.1a"><msub id="alg3.l1.m2.1.1" xref="alg3.l1.m2.1.1.cmml"><mi id="alg3.l1.m2.1.1.2" xref="alg3.l1.m2.1.1.2.cmml">k</mi><mn id="alg3.l1.m2.1.1.3" xref="alg3.l1.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><apply id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1"><csymbol cd="ambiguous" id="alg3.l1.m2.1.1.1.cmml" xref="alg3.l1.m2.1.1">subscript</csymbol><ci id="alg3.l1.m2.1.1.2.cmml" xref="alg3.l1.m2.1.1.2">𝑘</ci><cn id="alg3.l1.m2.1.1.3.cmml" type="integer" xref="alg3.l1.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m2.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, Query <math alttext="q" class="ltx_Math" display="inline" id="alg3.l1.m3.1"><semantics id="alg3.l1.m3.1a"><mi id="alg3.l1.m3.1.1" xref="alg3.l1.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m3.1b"><ci id="alg3.l1.m3.1.1.cmml" xref="alg3.l1.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m3.1d">italic_q</annotation></semantics></math>, Token Threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg3.l1.m4.1"><semantics id="alg3.l1.m4.1a"><mi id="alg3.l1.m4.1.1" xref="alg3.l1.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m4.1b"><ci id="alg3.l1.m4.1.1.cmml" xref="alg3.l1.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg3.l1.m4.1d">italic_τ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg3.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg3.l2.1">Output:</span> Final summary with at most <math alttext="\tau" class="ltx_Math" display="inline" id="alg3.l2.m1.1"><semantics id="alg3.l2.m1.1a"><mi id="alg3.l2.m1.1.1" xref="alg3.l2.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg3.l2.m1.1b"><ci id="alg3.l2.m1.1.1.cmml" xref="alg3.l2.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l2.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg3.l2.m1.1d">italic_τ</annotation></semantics></math> tokens

</div>
<div class="ltx_listingline" id="alg3.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Retrieve <math alttext="k_{0}" class="ltx_Math" display="inline" id="alg3.l3.m1.1"><semantics id="alg3.l3.m1.1a"><msub id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml"><mi id="alg3.l3.m1.1.1.2" xref="alg3.l3.m1.1.1.2.cmml">k</mi><mn id="alg3.l3.m1.1.1.3" xref="alg3.l3.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.1b"><apply id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1"><csymbol cd="ambiguous" id="alg3.l3.m1.1.1.1.cmml" xref="alg3.l3.m1.1.1">subscript</csymbol><ci id="alg3.l3.m1.1.1.2.cmml" xref="alg3.l3.m1.1.1.2">𝑘</ci><cn id="alg3.l3.m1.1.1.3.cmml" type="integer" xref="alg3.l3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="alg3.l3.m1.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> documents using <math alttext="\mathcal{R}(k_{0},q)" class="ltx_Math" display="inline" id="alg3.l3.m2.2"><semantics id="alg3.l3.m2.2a"><mrow id="alg3.l3.m2.2.2" xref="alg3.l3.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l3.m2.2.2.3" xref="alg3.l3.m2.2.2.3.cmml">ℛ</mi><mo id="alg3.l3.m2.2.2.2" xref="alg3.l3.m2.2.2.2.cmml">⁢</mo><mrow id="alg3.l3.m2.2.2.1.1" xref="alg3.l3.m2.2.2.1.2.cmml"><mo id="alg3.l3.m2.2.2.1.1.2" stretchy="false" xref="alg3.l3.m2.2.2.1.2.cmml">(</mo><msub id="alg3.l3.m2.2.2.1.1.1" xref="alg3.l3.m2.2.2.1.1.1.cmml"><mi id="alg3.l3.m2.2.2.1.1.1.2" xref="alg3.l3.m2.2.2.1.1.1.2.cmml">k</mi><mn id="alg3.l3.m2.2.2.1.1.1.3" xref="alg3.l3.m2.2.2.1.1.1.3.cmml">0</mn></msub><mo id="alg3.l3.m2.2.2.1.1.3" xref="alg3.l3.m2.2.2.1.2.cmml">,</mo><mi id="alg3.l3.m2.1.1" xref="alg3.l3.m2.1.1.cmml">q</mi><mo id="alg3.l3.m2.2.2.1.1.4" stretchy="false" xref="alg3.l3.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l3.m2.2b"><apply id="alg3.l3.m2.2.2.cmml" xref="alg3.l3.m2.2.2"><times id="alg3.l3.m2.2.2.2.cmml" xref="alg3.l3.m2.2.2.2"></times><ci id="alg3.l3.m2.2.2.3.cmml" xref="alg3.l3.m2.2.2.3">ℛ</ci><interval closure="open" id="alg3.l3.m2.2.2.1.2.cmml" xref="alg3.l3.m2.2.2.1.1"><apply id="alg3.l3.m2.2.2.1.1.1.cmml" xref="alg3.l3.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg3.l3.m2.2.2.1.1.1.1.cmml" xref="alg3.l3.m2.2.2.1.1.1">subscript</csymbol><ci id="alg3.l3.m2.2.2.1.1.1.2.cmml" xref="alg3.l3.m2.2.2.1.1.1.2">𝑘</ci><cn id="alg3.l3.m2.2.2.1.1.1.3.cmml" type="integer" xref="alg3.l3.m2.2.2.1.1.1.3">0</cn></apply><ci id="alg3.l3.m2.1.1.cmml" xref="alg3.l3.m2.1.1">𝑞</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m2.2c">\mathcal{R}(k_{0},q)</annotation><annotation encoding="application/x-llamapun" id="alg3.l3.m2.2d">caligraphic_R ( italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_q )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg3.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Construct a tree <math alttext="T" class="ltx_Math" display="inline" id="alg3.l4.m1.1"><semantics id="alg3.l4.m1.1a"><mi id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.1b"><ci id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg3.l4.m1.1d">italic_T</annotation></semantics></math> on the <math alttext="k_{0}" class="ltx_Math" display="inline" id="alg3.l4.m2.1"><semantics id="alg3.l4.m2.1a"><msub id="alg3.l4.m2.1.1" xref="alg3.l4.m2.1.1.cmml"><mi id="alg3.l4.m2.1.1.2" xref="alg3.l4.m2.1.1.2.cmml">k</mi><mn id="alg3.l4.m2.1.1.3" xref="alg3.l4.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg3.l4.m2.1b"><apply id="alg3.l4.m2.1.1.cmml" xref="alg3.l4.m2.1.1"><csymbol cd="ambiguous" id="alg3.l4.m2.1.1.1.cmml" xref="alg3.l4.m2.1.1">subscript</csymbol><ci id="alg3.l4.m2.1.1.2.cmml" xref="alg3.l4.m2.1.1.2">𝑘</ci><cn id="alg3.l4.m2.1.1.3.cmml" type="integer" xref="alg3.l4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m2.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="alg3.l4.m2.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> documents using Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg1" title="Algorithm 1 ‣ Recursive Construction ‣ 3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">1</span></a> with query-focused summarization and one-step clustering.

</div>
<div class="ltx_listingline" id="alg3.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>Generate a final query-focused summary from the content of the top layer of <math alttext="T" class="ltx_Math" display="inline" id="alg3.l5.m1.1"><semantics id="alg3.l5.m1.1a"><mi id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><ci id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.m1.1d">italic_T</annotation></semantics></math>, using at most <math alttext="\tau" class="ltx_Math" display="inline" id="alg3.l5.m2.1"><semantics id="alg3.l5.m2.1a"><mi id="alg3.l5.m2.1.1" xref="alg3.l5.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg3.l5.m2.1b"><ci id="alg3.l5.m2.1.1.cmml" xref="alg3.l5.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m2.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg3.l5.m2.1d">italic_τ</annotation></semantics></math> tokens.

</div>
<div class="ltx_listingline" id="alg3.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>Return the final summary.

</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Key Properties</h3>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">postQFRAP can be seamlessly integrated as a black-box solution with any retrieval algorithm that handles dynamic datasets.
A prime example of the latter is the naïve RAG algorithm, where adding documents is easy: chunk the new documents, embed each chunk, and add them to the vector database.
Removing documents is equally simple—just delete them from the database.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">Moreover, by recursively applying query-focused summarization, postQFRAP continuously extracts information relevant to answering the question.
Then, the final summarization step removes redundancy and serves as a last denoising phase, producing a highly relevant and coherent context.
It is important to note that increasing the hyperparameter <math alttext="k_{0}" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><msub id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">k</mi><mn id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">𝑘</ci><cn id="S5.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="S5.SS3.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> enables the model to handle broader questions without expanding the generated context size, though it increases inference time.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">Furthermore, postQFRAP avoids relying on a summarization model with a large context length due to its recursive structure, which focuses on small chunks at each step.
This enables the use of a distilled model for greater inference efficiency (e.g., the abstractive compressor of <cite class="ltx_cite ltx_citemacro_citet">Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib26" title="">2023</a>)</cite>).</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiments</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Datasets</h3>
<div class="ltx_para ltx_noindent" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">We evaluate our methods on three question-answering datasets: <span class="ltx_text ltx_font_italic" id="S6.SS1.p1.1.1">MultiHop</span>, <span class="ltx_text ltx_font_italic" id="S6.SS1.p1.1.2">QASPER</span>, and <span class="ltx_text ltx_font_italic" id="S6.SS1.p1.1.3">QuALITY</span>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1"><span class="ltx_text ltx_font_italic" id="S6.SS1.p2.1.1">MultiHop</span> consists of news articles published between 2013 and 2023 <cite class="ltx_cite ltx_citemacro_citep">(Tang and Yang, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib24" title="">2024</a>)</cite>.
Although the original questions focus on retrieving and reasoning across multiple documents, they primarily target explicit fact retrieval.
To create more challenging questions requiring a broader understanding, we construct a RAPTOR tree on the dataset, sample chunks/summaries from the tree, and ask an LLM to generate questions based on those chunks. Details are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS3" title="H.3 Generating Questions ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">H.3</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1"><span class="ltx_text ltx_font_italic" id="S6.SS1.p3.1.1">QASPER</span> consists of 1,585 NLP papers with associated questions <cite class="ltx_cite ltx_citemacro_citep">(Dasigi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib3" title="">2021</a>)</cite>.
Each question seeks information from the full text and is written by an NLP practitioner who has only seen the title and abstract.
For our experiments, we use the first 300 questions and their relevant papers.
To make each question context-independent, we include the paper’s name in the question (e.g. instead of asking ”What are the observed results?”, we ask ”In paper X, what are the observed results?”)</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p4">
<p class="ltx_p" id="S6.SS1.p4.1"><span class="ltx_text ltx_font_italic" id="S6.SS1.p4.1.1">QuALITY</span> consists of multiple-choice questions paired with context passages averaging 5,000 tokens <cite class="ltx_cite ltx_citemacro_citep">(Pang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib17" title="">2022</a>)</cite>.
This exceeds the size of the context generated by the retrieval algorithms in our experiments.
We also select the first 300 questions along with their corresponding context passages.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS1.p5">
<p class="ltx_p" id="S6.SS1.p5.1">We present the results of an additional dataset in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS4" title="H.4 Additional Dataset: NarrativeQA ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">H.4</span></a>.
Moreover, dataset sizes and an analysis of the recursive-abstractive trees constructed for each dataset are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS6" title="H.6 Datasets Statistics ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">H.6</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Metrics</h3>
<div class="ltx_para ltx_noindent" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">A key factor in the evaluation is the prompt used for the Question-Answering model.
To focus on the effectiveness of retrieval algorithms, we instruct the model to rely solely on the provided context. The full prompt is in the Appendix (Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7.T7" title="Table 7 ‣ Appendix G Prompts ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">7</span></a>).</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1">To evaluate our algorithms, we use two methods: a rating-based evaluation, providing a score for each model independently, and a head-to-head comparison.
Since the model is restricted to using only the retrieved context, measuring faithfulness is unnecessary.
Instead, we focus on ensuring the context provides sufficient information to answer the question.
Thus, we compute the proportion of <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.1">answered questions</span> and measure <span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.2">context relevance</span> <cite class="ltx_cite ltx_citemacro_citep">(Es et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib6" title="">2023</a>)</cite>. The latter acts as context precision, while the former is analogous to context recall, as it checks whether the necessary chunks are retrieved.
However, we avoid using context recall directly, as it is difficult to formally define with summarized chunks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p3">
<p class="ltx_p" id="S6.SS2.p3.1">Some generated answers may lack coherence, either in their internal structure or in relation to the question.
Providing summarized content as context may help the model generate more coherent responses.
To evaluate this, we introduce a novel metric called <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.1">Human Coherence Rating</span>, which prompts an LLM to assess whether an answer is coherent and resembles one that could plausibly be generated by a human expert.
The specific prompt used for this evaluation is shown in the appendix (Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7.T6" title="Table 6 ‣ Appendix G Prompts ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">6</span></a>), with a qualitative analysis of the metric provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A3" title="Appendix C Qualitative Analysis of Human Coherence Rating ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p4">
<p class="ltx_p" id="S6.SS2.p4.1">To gain deeper insights into our algorithms, we conduct a head-to-head evaluation.
Given our focus on questions requiring a global understanding, we adopt the evaluation metrics from <cite class="ltx_cite ltx_citemacro_citet">Edge et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib5" title="">2024</a>)</cite>, which assess <span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.1">comprehensiveness</span>, <span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.2">diversity</span>, <span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.3">empowerment</span>, and <span class="ltx_text ltx_font_bold" id="S6.SS2.p4.1.4">directness</span>.
For each comparison, the evaluator LLM is given the question, a prompt describing the target metric, and two answers.
The LLM evaluates which answer is superior or if it is a tie, providing a rationale for its decision.
To mitigate position bias <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib30" title="">2024</a>)</cite>, the evaluation is repeated for each pair of answers with their positions swapped.
If the same answer wins both trials, it is declared the winner; otherwise, the result is a tie.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS2.p5">
<p class="ltx_p" id="S6.SS2.p5.1">We also conduct a qualitative analysis of postQFRAP, detailed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A4" title="Appendix D Qualitative Analysis of postQFRAP ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Hyperparameter Selection</h3>
<div class="ltx_para ltx_noindent" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">A key hyperparameter to consider is the context size, or equivalently, the number of documents to retrieve.
<cite class="ltx_cite ltx_citemacro_citet">Sarthi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib21" title="">2024</a>)</cite> evaluated different context lengths on a subset of the QASPER dataset, finding that 2,000 output tokens yielded the best results.
Based on this, we set the output context size to 2,000 tokens for all algorithms unless stated otherwise.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.2">To select <math alttext="k_{0}" class="ltx_Math" display="inline" id="S6.SS3.p2.1.m1.1"><semantics id="S6.SS3.p2.1.m1.1a"><msub id="S6.SS3.p2.1.m1.1.1" xref="S6.SS3.p2.1.m1.1.1.cmml"><mi id="S6.SS3.p2.1.m1.1.1.2" xref="S6.SS3.p2.1.m1.1.1.2.cmml">k</mi><mn id="S6.SS3.p2.1.m1.1.1.3" xref="S6.SS3.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.m1.1b"><apply id="S6.SS3.p2.1.m1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p2.1.m1.1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S6.SS3.p2.1.m1.1.1.2.cmml" xref="S6.SS3.p2.1.m1.1.1.2">𝑘</ci><cn id="S6.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="S6.SS3.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.m1.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.1.m1.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> for the postQFRAP algorithm, we compare different values on two validation datasets.
We choose <math alttext="k_{0}=20" class="ltx_Math" display="inline" id="S6.SS3.p2.2.m2.1"><semantics id="S6.SS3.p2.2.m2.1a"><mrow id="S6.SS3.p2.2.m2.1.1" xref="S6.SS3.p2.2.m2.1.1.cmml"><msub id="S6.SS3.p2.2.m2.1.1.2" xref="S6.SS3.p2.2.m2.1.1.2.cmml"><mi id="S6.SS3.p2.2.m2.1.1.2.2" xref="S6.SS3.p2.2.m2.1.1.2.2.cmml">k</mi><mn id="S6.SS3.p2.2.m2.1.1.2.3" xref="S6.SS3.p2.2.m2.1.1.2.3.cmml">0</mn></msub><mo id="S6.SS3.p2.2.m2.1.1.1" xref="S6.SS3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS3.p2.2.m2.1.1.3" xref="S6.SS3.p2.2.m2.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.2.m2.1b"><apply id="S6.SS3.p2.2.m2.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1"><eq id="S6.SS3.p2.2.m2.1.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1.1"></eq><apply id="S6.SS3.p2.2.m2.1.1.2.cmml" xref="S6.SS3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.p2.2.m2.1.1.2.1.cmml" xref="S6.SS3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S6.SS3.p2.2.m2.1.1.2.2.cmml" xref="S6.SS3.p2.2.m2.1.1.2.2">𝑘</ci><cn id="S6.SS3.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S6.SS3.p2.2.m2.1.1.2.3">0</cn></apply><cn id="S6.SS3.p2.2.m2.1.1.3.cmml" type="integer" xref="S6.SS3.p2.2.m2.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.2.m2.1c">k_{0}=20</annotation><annotation encoding="application/x-llamapun" id="S6.SS3.p2.2.m2.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 20</annotation></semantics></math>, as larger values increase computational complexity without significant quality gains, while smaller values substantially reduce context relevance.
Details of this study are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A5" title="Appendix E Selection of 𝑘₀ for postQFRAP ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Baselines</h3>
<div class="ltx_para ltx_noindent" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.3">We compare the adRAP algorithm against Naïve RAG, RAPTOR, and a greedy variant of adRAP, which assigns each new point to its most probable cluster without updating the GMM fit.
To compute adRAP, we first construct a full tree using 70% of the dataset. The remaining 30% is added using the adRAP algorithm (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S4.SS4" title="4.4 adRAP Algorithm ‣ 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">4.4</span></a>) where we set <math alttext="\tau_{c}=11" class="ltx_Math" display="inline" id="S6.SS4.p1.1.m1.1"><semantics id="S6.SS4.p1.1.m1.1a"><mrow id="S6.SS4.p1.1.m1.1.1" xref="S6.SS4.p1.1.m1.1.1.cmml"><msub id="S6.SS4.p1.1.m1.1.1.2" xref="S6.SS4.p1.1.m1.1.1.2.cmml"><mi id="S6.SS4.p1.1.m1.1.1.2.2" xref="S6.SS4.p1.1.m1.1.1.2.2.cmml">τ</mi><mi id="S6.SS4.p1.1.m1.1.1.2.3" xref="S6.SS4.p1.1.m1.1.1.2.3.cmml">c</mi></msub><mo id="S6.SS4.p1.1.m1.1.1.1" xref="S6.SS4.p1.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS4.p1.1.m1.1.1.3" xref="S6.SS4.p1.1.m1.1.1.3.cmml">11</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.1.m1.1b"><apply id="S6.SS4.p1.1.m1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1"><eq id="S6.SS4.p1.1.m1.1.1.1.cmml" xref="S6.SS4.p1.1.m1.1.1.1"></eq><apply id="S6.SS4.p1.1.m1.1.1.2.cmml" xref="S6.SS4.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S6.SS4.p1.1.m1.1.1.2.1.cmml" xref="S6.SS4.p1.1.m1.1.1.2">subscript</csymbol><ci id="S6.SS4.p1.1.m1.1.1.2.2.cmml" xref="S6.SS4.p1.1.m1.1.1.2.2">𝜏</ci><ci id="S6.SS4.p1.1.m1.1.1.2.3.cmml" xref="S6.SS4.p1.1.m1.1.1.2.3">𝑐</ci></apply><cn id="S6.SS4.p1.1.m1.1.1.3.cmml" type="integer" xref="S6.SS4.p1.1.m1.1.1.3">11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.1.m1.1c">\tau_{c}=11</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.1.m1.1d">italic_τ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT = 11</annotation></semantics></math> and <math alttext="\tau_{n}=\max(100,\sqrt{|D_{0}|})" class="ltx_Math" display="inline" id="S6.SS4.p1.2.m2.3"><semantics id="S6.SS4.p1.2.m2.3a"><mrow id="S6.SS4.p1.2.m2.3.4" xref="S6.SS4.p1.2.m2.3.4.cmml"><msub id="S6.SS4.p1.2.m2.3.4.2" xref="S6.SS4.p1.2.m2.3.4.2.cmml"><mi id="S6.SS4.p1.2.m2.3.4.2.2" xref="S6.SS4.p1.2.m2.3.4.2.2.cmml">τ</mi><mi id="S6.SS4.p1.2.m2.3.4.2.3" xref="S6.SS4.p1.2.m2.3.4.2.3.cmml">n</mi></msub><mo id="S6.SS4.p1.2.m2.3.4.1" xref="S6.SS4.p1.2.m2.3.4.1.cmml">=</mo><mrow id="S6.SS4.p1.2.m2.3.4.3.2" xref="S6.SS4.p1.2.m2.3.4.3.1.cmml"><mi id="S6.SS4.p1.2.m2.2.2" xref="S6.SS4.p1.2.m2.2.2.cmml">max</mi><mo id="S6.SS4.p1.2.m2.3.4.3.2a" xref="S6.SS4.p1.2.m2.3.4.3.1.cmml">⁡</mo><mrow id="S6.SS4.p1.2.m2.3.4.3.2.1" xref="S6.SS4.p1.2.m2.3.4.3.1.cmml"><mo id="S6.SS4.p1.2.m2.3.4.3.2.1.1" stretchy="false" xref="S6.SS4.p1.2.m2.3.4.3.1.cmml">(</mo><mn id="S6.SS4.p1.2.m2.3.3" xref="S6.SS4.p1.2.m2.3.3.cmml">100</mn><mo id="S6.SS4.p1.2.m2.3.4.3.2.1.2" xref="S6.SS4.p1.2.m2.3.4.3.1.cmml">,</mo><msqrt id="S6.SS4.p1.2.m2.1.1" xref="S6.SS4.p1.2.m2.1.1.cmml"><mrow id="S6.SS4.p1.2.m2.1.1.1.1" xref="S6.SS4.p1.2.m2.1.1.1.2.cmml"><mo id="S6.SS4.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S6.SS4.p1.2.m2.1.1.1.2.1.cmml">|</mo><msub id="S6.SS4.p1.2.m2.1.1.1.1.1" xref="S6.SS4.p1.2.m2.1.1.1.1.1.cmml"><mi id="S6.SS4.p1.2.m2.1.1.1.1.1.2" xref="S6.SS4.p1.2.m2.1.1.1.1.1.2.cmml">D</mi><mn id="S6.SS4.p1.2.m2.1.1.1.1.1.3" xref="S6.SS4.p1.2.m2.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S6.SS4.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S6.SS4.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msqrt><mo id="S6.SS4.p1.2.m2.3.4.3.2.1.3" stretchy="false" xref="S6.SS4.p1.2.m2.3.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.2.m2.3b"><apply id="S6.SS4.p1.2.m2.3.4.cmml" xref="S6.SS4.p1.2.m2.3.4"><eq id="S6.SS4.p1.2.m2.3.4.1.cmml" xref="S6.SS4.p1.2.m2.3.4.1"></eq><apply id="S6.SS4.p1.2.m2.3.4.2.cmml" xref="S6.SS4.p1.2.m2.3.4.2"><csymbol cd="ambiguous" id="S6.SS4.p1.2.m2.3.4.2.1.cmml" xref="S6.SS4.p1.2.m2.3.4.2">subscript</csymbol><ci id="S6.SS4.p1.2.m2.3.4.2.2.cmml" xref="S6.SS4.p1.2.m2.3.4.2.2">𝜏</ci><ci id="S6.SS4.p1.2.m2.3.4.2.3.cmml" xref="S6.SS4.p1.2.m2.3.4.2.3">𝑛</ci></apply><apply id="S6.SS4.p1.2.m2.3.4.3.1.cmml" xref="S6.SS4.p1.2.m2.3.4.3.2"><max id="S6.SS4.p1.2.m2.2.2.cmml" xref="S6.SS4.p1.2.m2.2.2"></max><cn id="S6.SS4.p1.2.m2.3.3.cmml" type="integer" xref="S6.SS4.p1.2.m2.3.3">100</cn><apply id="S6.SS4.p1.2.m2.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1"><root id="S6.SS4.p1.2.m2.1.1a.cmml" xref="S6.SS4.p1.2.m2.1.1"></root><apply id="S6.SS4.p1.2.m2.1.1.1.2.cmml" xref="S6.SS4.p1.2.m2.1.1.1.1"><abs id="S6.SS4.p1.2.m2.1.1.1.2.1.cmml" xref="S6.SS4.p1.2.m2.1.1.1.1.2"></abs><apply id="S6.SS4.p1.2.m2.1.1.1.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S6.SS4.p1.2.m2.1.1.1.1.1.1.cmml" xref="S6.SS4.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S6.SS4.p1.2.m2.1.1.1.1.1.2.cmml" xref="S6.SS4.p1.2.m2.1.1.1.1.1.2">𝐷</ci><cn id="S6.SS4.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S6.SS4.p1.2.m2.1.1.1.1.1.3">0</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.2.m2.3c">\tau_{n}=\max(100,\sqrt{|D_{0}|})</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.2.m2.3d">italic_τ start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = roman_max ( 100 , square-root start_ARG | italic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT | end_ARG )</annotation></semantics></math> for Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg2" title="Algorithm 2 ‣ 4.3 Adaptive GMM ‣ 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">2</span></a>.
The choice of <math alttext="\tau_{c}" class="ltx_Math" display="inline" id="S6.SS4.p1.3.m3.1"><semantics id="S6.SS4.p1.3.m3.1a"><msub id="S6.SS4.p1.3.m3.1.1" xref="S6.SS4.p1.3.m3.1.1.cmml"><mi id="S6.SS4.p1.3.m3.1.1.2" xref="S6.SS4.p1.3.m3.1.1.2.cmml">τ</mi><mi id="S6.SS4.p1.3.m3.1.1.3" xref="S6.SS4.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S6.SS4.p1.3.m3.1b"><apply id="S6.SS4.p1.3.m3.1.1.cmml" xref="S6.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS4.p1.3.m3.1.1.1.cmml" xref="S6.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S6.SS4.p1.3.m3.1.1.2.cmml" xref="S6.SS4.p1.3.m3.1.1.2">𝜏</ci><ci id="S6.SS4.p1.3.m3.1.1.3.cmml" xref="S6.SS4.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p1.3.m3.1c">\tau_{c}</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p1.3.m3.1d">italic_τ start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math> is based on the average cluster size in the full RAPTOR tree, which is always less than 10 (see appendix, Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.T12" title="Table 12 ‣ H.6 Datasets Statistics ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">12</span></a>).
For the greedy variant, a similar procedure is used.
To simulate a challenging scenario, we remove the last 30% of documents instead of random sampling.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.3">We compare postQFRAP with other post-retrieval methods: no processing (naïve RAG) with <math alttext="k=7,20" class="ltx_Math" display="inline" id="S6.SS4.p2.1.m1.2"><semantics id="S6.SS4.p2.1.m1.2a"><mrow id="S6.SS4.p2.1.m1.2.3" xref="S6.SS4.p2.1.m1.2.3.cmml"><mi id="S6.SS4.p2.1.m1.2.3.2" xref="S6.SS4.p2.1.m1.2.3.2.cmml">k</mi><mo id="S6.SS4.p2.1.m1.2.3.1" xref="S6.SS4.p2.1.m1.2.3.1.cmml">=</mo><mrow id="S6.SS4.p2.1.m1.2.3.3.2" xref="S6.SS4.p2.1.m1.2.3.3.1.cmml"><mn id="S6.SS4.p2.1.m1.1.1" xref="S6.SS4.p2.1.m1.1.1.cmml">7</mn><mo id="S6.SS4.p2.1.m1.2.3.3.2.1" xref="S6.SS4.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="S6.SS4.p2.1.m1.2.2" xref="S6.SS4.p2.1.m1.2.2.cmml">20</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS4.p2.1.m1.2b"><apply id="S6.SS4.p2.1.m1.2.3.cmml" xref="S6.SS4.p2.1.m1.2.3"><eq id="S6.SS4.p2.1.m1.2.3.1.cmml" xref="S6.SS4.p2.1.m1.2.3.1"></eq><ci id="S6.SS4.p2.1.m1.2.3.2.cmml" xref="S6.SS4.p2.1.m1.2.3.2">𝑘</ci><list id="S6.SS4.p2.1.m1.2.3.3.1.cmml" xref="S6.SS4.p2.1.m1.2.3.3.2"><cn id="S6.SS4.p2.1.m1.1.1.cmml" type="integer" xref="S6.SS4.p2.1.m1.1.1">7</cn><cn id="S6.SS4.p2.1.m1.2.2.cmml" type="integer" xref="S6.SS4.p2.1.m1.2.2">20</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p2.1.m1.2c">k=7,20</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p2.1.m1.2d">italic_k = 7 , 20</annotation></semantics></math> retrieved documents, one-shot summarization, re-ranking, and postRAP.
One-shot summarization uses the controller from <cite class="ltx_cite ltx_citemacro_citet">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib28" title="">2024</a>)</cite> to directly generate 2,000 tokens (see prompt in Appendix, Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7.T8" title="Table 8 ‣ Appendix G Prompts ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">8</span></a>).
For re-ranking, we use the <span class="ltx_text ltx_font_typewriter" id="S6.SS4.p2.3.1">ms-marco-MiniLM-L-12-v2<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote4.1.1.1">4</span></span><a class="ltx_ref ltx_url" href="https://huggingface.co/cross-encoder/ms-marco-MiniLM-L-12-v2" title="">https://huggingface.co/cross-encoder/ms-marco-MiniLM-L-12-v2</a></span></span></span></span> cross-encoder from HuggingFace, retrieving 20 documents via naïve RAG, then re-ranking them to keep the top 7.
Finally, postRAP is a variant of postQFRAP without query-focused summarization which retrieves the top-<math alttext="k" class="ltx_Math" display="inline" id="S6.SS4.p2.2.m2.1"><semantics id="S6.SS4.p2.2.m2.1a"><mi id="S6.SS4.p2.2.m2.1.1" xref="S6.SS4.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S6.SS4.p2.2.m2.1b"><ci id="S6.SS4.p2.2.m2.1.1.cmml" xref="S6.SS4.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p2.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p2.2.m2.1d">italic_k</annotation></semantics></math> most similar chunks from the tree built on the <math alttext="k_{0}" class="ltx_Math" display="inline" id="S6.SS4.p2.3.m3.1"><semantics id="S6.SS4.p2.3.m3.1a"><msub id="S6.SS4.p2.3.m3.1.1" xref="S6.SS4.p2.3.m3.1.1.cmml"><mi id="S6.SS4.p2.3.m3.1.1.2" xref="S6.SS4.p2.3.m3.1.1.2.cmml">k</mi><mn id="S6.SS4.p2.3.m3.1.1.3" xref="S6.SS4.p2.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S6.SS4.p2.3.m3.1b"><apply id="S6.SS4.p2.3.m3.1.1.cmml" xref="S6.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S6.SS4.p2.3.m3.1.1.1.cmml" xref="S6.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S6.SS4.p2.3.m3.1.1.2.cmml" xref="S6.SS4.p2.3.m3.1.1.2">𝑘</ci><cn id="S6.SS4.p2.3.m3.1.1.3.cmml" type="integer" xref="S6.SS4.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS4.p2.3.m3.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="S6.SS4.p2.3.m3.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> chunks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS4.p3">
<p class="ltx_p" id="S6.SS4.p3.1">We also tried adding query expansion <cite class="ltx_cite ltx_citemacro_citep">(Jagerman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib8" title="">2023</a>)</cite> to our postQFRAP algorithm, but this barely affected the results.
So, we report the details of those experiments in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A6" title="Appendix F Query Expansion ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.SS4.p4">
<p class="ltx_p" id="S6.SS4.p4.1">We use OpenAI’s <span class="ltx_text ltx_font_typewriter" id="S6.SS4.p4.1.1">text-embedding-3-large<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote5.1.1.1">5</span></span><a class="ltx_ref ltx_url" href="https://platform.openai.com/docs/guides/embeddings" title="">https://platform.openai.com/docs/guides/embeddings</a></span></span></span></span> for embeddings and <span class="ltx_text ltx_font_typewriter" id="S6.SS4.p4.1.2">gpt-4o-mini-2024-07-18<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote6.1.1.1">6</span></span><a class="ltx_ref ltx_url" href="https://platform.openai.com/docs/models/gpt-4o-mini" title="">https://platform.openai.com/docs/models/gpt-4o-mini</a></span></span></span></span> for all LLM tasks.
All retrieval algorithms use a chunk size of 300 tokens with a 50-token overlap.
To account for the non-determinism of LLM evaluators, we repeat each experiment three times, reporting the average and standard error.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5 </span>Results</h3>
<div class="ltx_para ltx_noindent" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.F2" title="Figure 2 ‣ 6.5 Results ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">2</span></a> shows that adRAP’s performance is generally on par with RAPTOR across most metrics, with the exception of context relevance, where adRAP falls short by at least 3%.
However, adRAP outperforms both the naïve RAG and the greedy algorithm, particularly in the QuALITY dataset.
These findings are further corroborated by the head-to-head evaluations in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.F3" title="Figure 3 ‣ 6.5 Results ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.F4" title="Figure 4 ‣ 6.5 Results ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">4</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.F5" title="Figure 5 ‣ 6.5 Results ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">5</span></a>.
Notably, in the QuALITY dataset, adRAP exceeds RAPTOR in metrics such as comprehensiveness, diversity, and empowerment, despite its lower performance in context relevance.
On the other hand, adRAP underperforms compared to RAPTOR in the MultiHop and QASPER datasets.</p>
</div>
<figure class="ltx_figure" id="S6.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="184" id="S6.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Evaluation of adRAP (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S4.SS4" title="4.4 adRAP Algorithm ‣ 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">4.4</span></a>) on 3 datasets.</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="102" id="S6.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Percentage of Wins, Ties and Losses for adRAP vs other algorithms on MultiHop.</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="102" id="S6.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Percentage of Wins, Ties and Losses for adRAP vs other algorithms on QASPER.</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="102" id="S6.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Percentage of Wins, Ties and Losses for adRAP vs other algorithms on QuALITY.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S6.SS5.p2">
<p class="ltx_p" id="S6.SS5.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.F6" title="Figure 6 ‣ 6.5 Results ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">6</span></a> shows that algorithms with query-focused summarization consistently outperforms other approaches across all metrics.
While one-shot summarization scores slightly higher in answered questions and human coherence, postQFRAP excels in context relevance, demonstrating the effectiveness of recursive summarization in filtering noise from input chunks.
The superiority of postQFRAP as a post-retrieval algorithm becomes apparent in head-to-head evaluations. As shown in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.F7" title="Figure 7 ‣ 6.5 Results ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">7</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.F8" title="Figure 8 ‣ 6.5 Results ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">8</span></a>, and <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.F9" title="Figure 9 ‣ 6.5 Results ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">9</span></a>, postQFRAP excels in comprehensiveness, diversity, and empowerment.
The lower directness scores are expected, as directness often contrasts with these qualities, as noted by <cite class="ltx_cite ltx_citemacro_citet">Edge et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib5" title="">2024</a>)</cite>.
Overall, postQFRAP’s recursive extraction produces a more diverse, comprehensive, and empowering context, enhancing the quality of the final answer.</p>
</div>
<figure class="ltx_figure" id="S6.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="184" id="S6.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Evaluation of postQFRAP (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg3" title="Algorithm 3 ‣ 5.2 postQFRAP Algorithm ‣ 5 postQFRAP: post-retrieval Query-Focused Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">3</span></a>) on 3 datasets.</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="139" id="S6.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Percentage of Wins, Ties and Losses for postQFRAP vs other algorithms on MultiHop.</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="139" id="S6.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Percentage of Wins, Ties and Losses for postQFRAP vs other algorithms on QASPER.</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="139" id="S6.F9.g1" src="x9.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Percentage of Wins, Ties and Losses for postQFRAP vs other algorithms on QuALITY.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Limitations</h2>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">While adRAP is more efficient than repeatedly recomputing the full RAPTOR tree for dynamic datasets, it introduces some overhead.
It requires extra memory to store multiple UMAP and GMM models and adds complexity to the retrieval pipeline, as it must be triggered when new documents are added.
Additionally, a full tree recomputation may still be needed if a large volume of new documents is introduced, increasing implementation effort.
With postQFRAP, generated summaries can make it harder to trace original sources.
Additionally, multiple summarization calls are required during inference, although this follows the current trend of shifting more computational workload to inference time, as seen with OpenAI’s o1 model <cite class="ltx_cite ltx_citemacro_citep">(OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib16" title="">2024</a>; Brown et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib2" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Conclusion</h2>
<div class="ltx_para ltx_noindent" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">In this paper, we introduced adRAP, an adaptive extension of the RAPTOR algorithm, designed to efficiently approximate clustering when documents are added or removed.
Our experiments show that adRAP performs comparably to RAPTOR, making it a viable solution for dynamic datasets.</p>
</div>
<div class="ltx_para ltx_noindent" id="S8.p2">
<p class="ltx_p" id="S8.p2.1">We also presented postQFRAP, a novel post-retrieval algorithm that applies query-focused, recursive-abstractive processing to refine large contexts.
By filtering out irrelevant information, postQFRAP produces highly relevant summaries.
Our results demonstrate that postQFRAP consistently outperforms traditional methods, proving its effectiveness for post-retrieval processing.</p>
</div>
</section>
<section class="ltx_section" id="S9">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9 </span>Reproducibility Statement</h2>
<section class="ltx_paragraph" id="S9.SS0.SSS0.Px1">
<h4 class="ltx_title ltx_title_paragraph">Language Model Used</h4>
<div class="ltx_para ltx_noindent" id="S9.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S9.SS0.SSS0.Px1.p1.1">Open AI’s <span class="ltx_text ltx_font_typewriter" id="S9.SS0.SSS0.Px1.p1.1.1">gpt-4o-mini-2024-07-18<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote7.1.1.1">7</span></span><a class="ltx_ref ltx_url" href="https://platform.openai.com/docs/models/gpt-4o-mini" title="">https://platform.openai.com/docs/models/gpt-4o-mini</a></span></span></span></span> is used for both question answering and summarization in all our experiments. Open AI’s <span class="ltx_text ltx_font_typewriter" id="S9.SS0.SSS0.Px1.p1.1.2">text-embedding-3-large<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_serif" id="footnote8.1.1.1">8</span></span><a class="ltx_ref ltx_url" href="https://platform.openai.com/docs/guides/embeddings" title="">https://platform.openai.com/docs/guides/embeddings</a></span></span></span></span> is used to generate embeddings.</p>
</div>
</section>
<section class="ltx_paragraph" id="S9.SS0.SSS0.Px2">
<h4 class="ltx_title ltx_title_paragraph">Prompts</h4>
<div class="ltx_para ltx_noindent" id="S9.SS0.SSS0.Px2.p1">
<p class="ltx_p" id="S9.SS0.SSS0.Px2.p1.1">All used prompts are presented in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7" title="Appendix G Prompts ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">G</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S9.SS0.SSS0.Px3">
<h4 class="ltx_title ltx_title_paragraph">Hyperparameters</h4>
<div class="ltx_para ltx_noindent" id="S9.SS0.SSS0.Px3.p1">
<p class="ltx_p" id="S9.SS0.SSS0.Px3.p1.1">All hyperparameters and model configurations used in the experiments are clearly detailed in Sections <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.SS3" title="6.3 Hyperparameter Selection ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">6.3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S6.SS4" title="6.4 Baselines ‣ 6 Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">6.4</span></a>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S9.SS0.SSS0.Px4">
<h4 class="ltx_title ltx_title_paragraph">Datasets</h4>
<div class="ltx_para ltx_noindent" id="S9.SS0.SSS0.Px4.p1">
<p class="ltx_p" id="S9.SS0.SSS0.Px4.p1.1">All four datasets used in our experiments are publicly available: <a class="ltx_ref ltx_href" href="https://github.com/yixuantt/MultiHop-RAG" title="">MultiHop</a>, <a class="ltx_ref ltx_href" href="https://github.com/google-deepmind/narrativeqa" title="">NarrativeQA</a>, <a class="ltx_ref ltx_href" href="https://github.com/nyu-mll/quality" title="">QuALITY</a>, and <a class="ltx_ref ltx_href" href="https://allenai.org/data/qasper" title="">QASPER</a>.
Details of the preprocessing steps are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.SS5" title="H.5 Dataset Preprocessing ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">H.5</span></a>.</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Allaoui et al. (2020)</span>
<span class="ltx_bibblock">
Mebarka Allaoui, Mohammed Lamine Kherfi, and Abdelhakim Cheriet.

</span>
<span class="ltx_bibblock">Considerably improving clustering algorithms using umap dimensionality reduction technique: a comparative study.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">International conference on image and signal processing</em>, pages 317–325. Springer, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. (2024)</span>
<span class="ltx_bibblock">
Bradley Brown, Jordan Juravsky, Ryan Ehrlich, Ronald Clark, Quoc V. Le, Christopher Ré, and Azalia Mirhoseini.

</span>
<span class="ltx_bibblock">Large language monkeys: Scaling inference compute with repeated sampling, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2407.21787" title="">https://arxiv.org/abs/2407.21787</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dasigi et al. (2021)</span>
<span class="ltx_bibblock">
Pradeep Dasigi, Kyle Lo, Iz Beltagy, Arman Cohan, Noah A. Smith, and Matt Gardner.

</span>
<span class="ltx_bibblock">A dataset of information-seeking questions and answers anchored in research papers, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2105.03011" title="">https://arxiv.org/abs/2105.03011</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Declercq and Piater (2008)</span>
<span class="ltx_bibblock">
Arnaud Declercq and Justus H Piater.

</span>
<span class="ltx_bibblock">Online learning of gaussian mixture models-a two-level approach.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">VISAPP (1)</em>, pages 605–611, 2008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edge et al. (2024)</span>
<span class="ltx_bibblock">
Darren Edge, Ha Trinh, Newman Cheng, Joshua Bradley, Alex Chao, Apurva Mody, Steven Truitt, and Jonathan Larson.

</span>
<span class="ltx_bibblock">From local to global: A graph rag approach to query-focused summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2404.16130</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Es et al. (2023)</span>
<span class="ltx_bibblock">
Shahul Es, Jithin James, Luis Espinosa-Anke, and Steven Schockaert.

</span>
<span class="ltx_bibblock">Ragas: Automated evaluation of retrieval augmented generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2309.15217</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023)</span>
<span class="ltx_bibblock">
Yunfan Gao, Yun Xiong, Xinyu Gao, Kangxiang Jia, Jinliu Pan, Yuxi Bi, Yi Dai, Jiawei Sun, and Haofen Wang.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for large language models: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2312.10997</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jagerman et al. (2023)</span>
<span class="ltx_bibblock">
Rolf Jagerman, Honglei Zhuang, Zhen Qin, Xuanhui Wang, and Michael Bendersky.

</span>
<span class="ltx_bibblock">Query expansion by prompting large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2305.03653</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2020)</span>
<span class="ltx_bibblock">
Zhengbao Jiang, Frank F Xu, Jun Araki, and Graham Neubig.

</span>
<span class="ltx_bibblock">How can we know what language models know?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Transactions of the Association for Computational Linguistics</em>, 8:423–438, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kočiský et al. (2017)</span>
<span class="ltx_bibblock">
Tomáš Kočiský, Jonathan Schwarz, Phil Blunsom, Chris Dyer, Karl Moritz Hermann, Gábor Melis, and Edward Grefenstette.

</span>
<span class="ltx_bibblock">The narrativeqa reading comprehension challenge, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/1712.07040" title="">https://arxiv.org/abs/1712.07040</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, et al.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</em>, 33:9459–9474, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2024)</span>
<span class="ltx_bibblock">
Nelson F Liu, Kevin Lin, John Hewitt, Ashwin Paranjape, Michele Bevilacqua, Fabio Petroni, and Percy Liang.

</span>
<span class="ltx_bibblock">Lost in the middle: How language models use long contexts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Transactions of the Association for Computational Linguistics</em>, 12:157–173, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McInnes et al. (2018)</span>
<span class="ltx_bibblock">
Leland McInnes, John Healy, and James Melville.

</span>
<span class="ltx_bibblock">Umap: Uniform manifold approximation and projection for dimension reduction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1802.03426</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moon (1996)</span>
<span class="ltx_bibblock">
Todd K Moon.

</span>
<span class="ltx_bibblock">The expectation-maximization algorithm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">IEEE Signal processing magazine</em>, 13(6):47–60, 1996.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Neal and Hinton (1998)</span>
<span class="ltx_bibblock">
Radford M Neal and Geoffrey E Hinton.

</span>
<span class="ltx_bibblock">A view of the em algorithm that justifies incremental, sparse, and other variants.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Learning in graphical models</em>, pages 355–368. Springer, 1998.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2024)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Learning to reason with llms.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openai.com/index/learning-to-reason-with-llms/" title="">https://openai.com/index/learning-to-reason-with-llms/</a>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang et al. (2022)</span>
<span class="ltx_bibblock">
Richard Yuanzhe Pang, Alicia Parrish, Nitish Joshi, Nikita Nangia, Jason Phang, Angelica Chen, Vishakh Padmakumar, Johnny Ma, Jana Thompson, He He, and Samuel R. Bowman.

</span>
<span class="ltx_bibblock">Quality: Question answering with long input texts, yes!, 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2112.08608" title="">https://arxiv.org/abs/2112.08608</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petroni et al. (2019)</span>
<span class="ltx_bibblock">
Fabio Petroni, Tim Rocktäschel, Patrick Lewis, Anton Bakhtin, Yuxiang Wu, Alexander H Miller, and Sebastian Riedel.

</span>
<span class="ltx_bibblock">Language models as knowledge bases?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:1909.01066</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ram et al. (2023)</span>
<span class="ltx_bibblock">
Ori Ram, Yoav Levine, Itay Dalmedigos, Dor Muhlgay, Amnon Shashua, Kevin Leyton-Brown, and Yoav Shoham.

</span>
<span class="ltx_bibblock">In-context retrieval-augmented language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Transactions of the Association for Computational Linguistics</em>, 11:1316–1331, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roberts et al. (2020)</span>
<span class="ltx_bibblock">
Adam Roberts, Colin Raffel, and Noam Shazeer.

</span>
<span class="ltx_bibblock">How much knowledge can you pack into the parameters of a language model?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2002.08910</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarthi et al. (2024)</span>
<span class="ltx_bibblock">
Parth Sarthi, Salman Abdullah, Aditi Tuli, Shubh Khanna, Anna Goldie, and Christopher D Manning.

</span>
<span class="ltx_bibblock">Raptor: Recursive abstractive processing for tree-organized retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2401.18059</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schwarz (1978)</span>
<span class="ltx_bibblock">
Gideon Schwarz.

</span>
<span class="ltx_bibblock">Estimating the dimension of a model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">The annals of statistics</em>, pages 461–464, 1978.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song and Wang (2005)</span>
<span class="ltx_bibblock">
Mingzhou Song and Hongbin Wang.

</span>
<span class="ltx_bibblock">Highly efficient incremental estimation of gaussian mixture models for online data stream clustering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Intelligent Computing: Theory and Applications III</em>, volume 5803, pages 174–183. SPIE, 2005.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Yang (2024)</span>
<span class="ltx_bibblock">
Yixuan Tang and Yi Yang.

</span>
<span class="ltx_bibblock">Multihop-rag: Benchmarking retrieval-augmented generation for multi-hop queries.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2401.15391</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2021)</span>
<span class="ltx_bibblock">
Jeff Wu, Long Ouyang, Daniel M. Ziegler, Nisan Stiennon, Ryan Lowe, Jan Leike, and Paul Christiano.

</span>
<span class="ltx_bibblock">Recursively summarizing books with human feedback, 2021.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2109.10862" title="">https://arxiv.org/abs/2109.10862</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2023)</span>
<span class="ltx_bibblock">
Fangyuan Xu, Weijia Shi, and Eunsol Choi.

</span>
<span class="ltx_bibblock">Recomp: Improving retrieval-augmented lms with compression and selective augmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2310.04408</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2024)</span>
<span class="ltx_bibblock">
Tan Yu, Anbang Xu, and Rama Akkiraju.

</span>
<span class="ltx_bibblock">In defense of rag in the era of long-context language models, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2409.01666" title="">https://arxiv.org/abs/2409.01666</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Weijia Zhang, Jia-Hong Huang, Svitlana Vakulenko, Yumo Xu, Thilina Rajapakse, and Evangelos Kanoulas.

</span>
<span class="ltx_bibblock">Beyond relevant documents: A knowledge-intensive approach for query-focused summarization using large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2408.10357</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Scordilis (2008)</span>
<span class="ltx_bibblock">
Yongxin Zhang and Michael S Scordilis.

</span>
<span class="ltx_bibblock">Effective online unsupervised adaptation of gaussian mixture models and its application to speech classification.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Pattern Recognition Letters</em>, 29(6):735–744, 2008.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2024)</span>
<span class="ltx_bibblock">
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric Xing, et al.

</span>
<span class="ltx_bibblock">Judging llm-as-a-judge with mt-bench and chatbot arena.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Pseudocodes</h2>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg4.2.1.1">Algorithm 4</span> </span> Querying the Recursive-Abstractive Tree</figcaption>
<div class="ltx_listing ltx_listing" id="alg4.3">
<div class="ltx_listingline" id="alg4.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg4.l1.1">Input:</span> Query <math alttext="q" class="ltx_Math" display="inline" id="alg4.l1.m1.1"><semantics id="alg4.l1.m1.1a"><mi id="alg4.l1.m1.1.1" xref="alg4.l1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m1.1b"><ci id="alg4.l1.m1.1.1.cmml" xref="alg4.l1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m1.1d">italic_q</annotation></semantics></math>, Recursive-Abstractive Tree <math alttext="T" class="ltx_Math" display="inline" id="alg4.l1.m2.1"><semantics id="alg4.l1.m2.1a"><mi id="alg4.l1.m2.1.1" xref="alg4.l1.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m2.1b"><ci id="alg4.l1.m2.1.1.cmml" xref="alg4.l1.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m2.1d">italic_T</annotation></semantics></math>, Integer <math alttext="k" class="ltx_Math" display="inline" id="alg4.l1.m3.1"><semantics id="alg4.l1.m3.1a"><mi id="alg4.l1.m3.1.1" xref="alg4.l1.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m3.1b"><ci id="alg4.l1.m3.1.1.cmml" xref="alg4.l1.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m3.1d">italic_k</annotation></semantics></math>, Token Threshold <math alttext="\tau" class="ltx_Math" display="inline" id="alg4.l1.m4.1"><semantics id="alg4.l1.m4.1a"><mi id="alg4.l1.m4.1.1" xref="alg4.l1.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m4.1b"><ci id="alg4.l1.m4.1.1.cmml" xref="alg4.l1.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="alg4.l1.m4.1d">italic_τ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg4.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg4.l2.1">Output:</span> List of retrieved documents

</div>
<div class="ltx_listingline" id="alg4.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Compute the embedding <math alttext="v" class="ltx_Math" display="inline" id="alg4.l3.m1.1"><semantics id="alg4.l3.m1.1a"><mi id="alg4.l3.m1.1.1" xref="alg4.l3.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg4.l3.m1.1b"><ci id="alg4.l3.m1.1.1.cmml" xref="alg4.l3.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m1.1d">italic_v</annotation></semantics></math> for the query <math alttext="q" class="ltx_Math" display="inline" id="alg4.l3.m2.1"><semantics id="alg4.l3.m2.1a"><mi id="alg4.l3.m2.1.1" xref="alg4.l3.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="alg4.l3.m2.1b"><ci id="alg4.l3.m2.1.1.cmml" xref="alg4.l3.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="alg4.l3.m2.1d">italic_q</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg4.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Calculate the cosine similarity between <math alttext="v" class="ltx_Math" display="inline" id="alg4.l4.m1.1"><semantics id="alg4.l4.m1.1a"><mi id="alg4.l4.m1.1.1" xref="alg4.l4.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg4.l4.m1.1b"><ci id="alg4.l4.m1.1.1.cmml" xref="alg4.l4.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg4.l4.m1.1d">italic_v</annotation></semantics></math> and the embeddings of all nodes in <math alttext="T" class="ltx_Math" display="inline" id="alg4.l4.m2.1"><semantics id="alg4.l4.m2.1a"><mi id="alg4.l4.m2.1.1" xref="alg4.l4.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg4.l4.m2.1b"><ci id="alg4.l4.m2.1.1.cmml" xref="alg4.l4.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg4.l4.m2.1d">italic_T</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg4.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>Select the <math alttext="k" class="ltx_Math" display="inline" id="alg4.l5.m1.1"><semantics id="alg4.l5.m1.1a"><mi id="alg4.l5.m1.1.1" xref="alg4.l5.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg4.l5.m1.1b"><ci id="alg4.l5.m1.1.1.cmml" xref="alg4.l5.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="alg4.l5.m1.1d">italic_k</annotation></semantics></math> most similar nodes, sorted by decreasing similarity.

</div>
<div class="ltx_listingline" id="alg4.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>Add the nodes’ content to the output in order, stopping if the token threshold is reached.

</div>
</div>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg5.2.1.1">Algorithm 5</span> </span> adRAP Algorithm</figcaption>
<div class="ltx_listing ltx_listing" id="alg5.3">
<div class="ltx_listingline" id="alg5.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span><span class="ltx_text ltx_font_bold" id="alg5.l1.1">Input:</span> Tree <math alttext="T_{0}" class="ltx_Math" display="inline" id="alg5.l1.m1.1"><semantics id="alg5.l1.m1.1a"><msub id="alg5.l1.m1.1.1" xref="alg5.l1.m1.1.1.cmml"><mi id="alg5.l1.m1.1.1.2" xref="alg5.l1.m1.1.1.2.cmml">T</mi><mn id="alg5.l1.m1.1.1.3" xref="alg5.l1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg5.l1.m1.1b"><apply id="alg5.l1.m1.1.1.cmml" xref="alg5.l1.m1.1.1"><csymbol cd="ambiguous" id="alg5.l1.m1.1.1.1.cmml" xref="alg5.l1.m1.1.1">subscript</csymbol><ci id="alg5.l1.m1.1.1.2.cmml" xref="alg5.l1.m1.1.1.2">𝑇</ci><cn id="alg5.l1.m1.1.1.3.cmml" type="integer" xref="alg5.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m1.1c">T_{0}</annotation><annotation encoding="application/x-llamapun" id="alg5.l1.m1.1d">italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> with GMM and UMAP models, new document <math alttext="d" class="ltx_Math" display="inline" id="alg5.l1.m2.1"><semantics id="alg5.l1.m2.1a"><mi id="alg5.l1.m2.1.1" xref="alg5.l1.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg5.l1.m2.1b"><ci id="alg5.l1.m2.1.1.cmml" xref="alg5.l1.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l1.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg5.l1.m2.1d">italic_d</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg5.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span><span class="ltx_text ltx_font_bold" id="alg5.l2.1">Output:</span> Updated tree <math alttext="T" class="ltx_Math" display="inline" id="alg5.l2.m1.1"><semantics id="alg5.l2.m1.1a"><mi id="alg5.l2.m1.1.1" xref="alg5.l2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg5.l2.m1.1b"><ci id="alg5.l2.m1.1.1.cmml" xref="alg5.l2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l2.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg5.l2.m1.1d">italic_T</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg5.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>Compute the embedding <math alttext="v" class="ltx_Math" display="inline" id="alg5.l3.m1.1"><semantics id="alg5.l3.m1.1a"><mi id="alg5.l3.m1.1.1" xref="alg5.l3.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg5.l3.m1.1b"><ci id="alg5.l3.m1.1.1.cmml" xref="alg5.l3.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l3.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg5.l3.m1.1d">italic_v</annotation></semantics></math> of document <math alttext="d" class="ltx_Math" display="inline" id="alg5.l3.m2.1"><semantics id="alg5.l3.m2.1a"><mi id="alg5.l3.m2.1.1" xref="alg5.l3.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="alg5.l3.m2.1b"><ci id="alg5.l3.m2.1.1.cmml" xref="alg5.l3.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l3.m2.1c">d</annotation><annotation encoding="application/x-llamapun" id="alg5.l3.m2.1d">italic_d</annotation></semantics></math> using the appropriate model.

</div>
<div class="ltx_listingline" id="alg5.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>Create a leaf node in <math alttext="T_{0}" class="ltx_Math" display="inline" id="alg5.l4.m1.1"><semantics id="alg5.l4.m1.1a"><msub id="alg5.l4.m1.1.1" xref="alg5.l4.m1.1.1.cmml"><mi id="alg5.l4.m1.1.1.2" xref="alg5.l4.m1.1.1.2.cmml">T</mi><mn id="alg5.l4.m1.1.1.3" xref="alg5.l4.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg5.l4.m1.1b"><apply id="alg5.l4.m1.1.1.cmml" xref="alg5.l4.m1.1.1"><csymbol cd="ambiguous" id="alg5.l4.m1.1.1.1.cmml" xref="alg5.l4.m1.1.1">subscript</csymbol><ci id="alg5.l4.m1.1.1.2.cmml" xref="alg5.l4.m1.1.1.2">𝑇</ci><cn id="alg5.l4.m1.1.1.3.cmml" type="integer" xref="alg5.l4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l4.m1.1c">T_{0}</annotation><annotation encoding="application/x-llamapun" id="alg5.l4.m1.1d">italic_T start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="(d,v)" class="ltx_Math" display="inline" id="alg5.l4.m2.2"><semantics id="alg5.l4.m2.2a"><mrow id="alg5.l4.m2.2.3.2" xref="alg5.l4.m2.2.3.1.cmml"><mo id="alg5.l4.m2.2.3.2.1" stretchy="false" xref="alg5.l4.m2.2.3.1.cmml">(</mo><mi id="alg5.l4.m2.1.1" xref="alg5.l4.m2.1.1.cmml">d</mi><mo id="alg5.l4.m2.2.3.2.2" xref="alg5.l4.m2.2.3.1.cmml">,</mo><mi id="alg5.l4.m2.2.2" xref="alg5.l4.m2.2.2.cmml">v</mi><mo id="alg5.l4.m2.2.3.2.3" stretchy="false" xref="alg5.l4.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg5.l4.m2.2b"><interval closure="open" id="alg5.l4.m2.2.3.1.cmml" xref="alg5.l4.m2.2.3.2"><ci id="alg5.l4.m2.1.1.cmml" xref="alg5.l4.m2.1.1">𝑑</ci><ci id="alg5.l4.m2.2.2.cmml" xref="alg5.l4.m2.2.2">𝑣</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg5.l4.m2.2c">(d,v)</annotation><annotation encoding="application/x-llamapun" id="alg5.l4.m2.2d">( italic_d , italic_v )</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg5.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>Compute the global reduced embedding <math alttext="v_{g}" class="ltx_Math" display="inline" id="alg5.l5.m1.1"><semantics id="alg5.l5.m1.1a"><msub id="alg5.l5.m1.1.1" xref="alg5.l5.m1.1.1.cmml"><mi id="alg5.l5.m1.1.1.2" xref="alg5.l5.m1.1.1.2.cmml">v</mi><mi id="alg5.l5.m1.1.1.3" xref="alg5.l5.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg5.l5.m1.1b"><apply id="alg5.l5.m1.1.1.cmml" xref="alg5.l5.m1.1.1"><csymbol cd="ambiguous" id="alg5.l5.m1.1.1.1.cmml" xref="alg5.l5.m1.1.1">subscript</csymbol><ci id="alg5.l5.m1.1.1.2.cmml" xref="alg5.l5.m1.1.1.2">𝑣</ci><ci id="alg5.l5.m1.1.1.3.cmml" xref="alg5.l5.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l5.m1.1c">v_{g}</annotation><annotation encoding="application/x-llamapun" id="alg5.l5.m1.1d">italic_v start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="v" class="ltx_Math" display="inline" id="alg5.l5.m2.1"><semantics id="alg5.l5.m2.1a"><mi id="alg5.l5.m2.1.1" xref="alg5.l5.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg5.l5.m2.1b"><ci id="alg5.l5.m2.1.1.cmml" xref="alg5.l5.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l5.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg5.l5.m2.1d">italic_v</annotation></semantics></math> using the global UMAP model.

</div>
<div class="ltx_listingline" id="alg5.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>Assign <math alttext="v_{g}" class="ltx_Math" display="inline" id="alg5.l6.m1.1"><semantics id="alg5.l6.m1.1a"><msub id="alg5.l6.m1.1.1" xref="alg5.l6.m1.1.1.cmml"><mi id="alg5.l6.m1.1.1.2" xref="alg5.l6.m1.1.1.2.cmml">v</mi><mi id="alg5.l6.m1.1.1.3" xref="alg5.l6.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg5.l6.m1.1b"><apply id="alg5.l6.m1.1.1.cmml" xref="alg5.l6.m1.1.1"><csymbol cd="ambiguous" id="alg5.l6.m1.1.1.1.cmml" xref="alg5.l6.m1.1.1">subscript</csymbol><ci id="alg5.l6.m1.1.1.2.cmml" xref="alg5.l6.m1.1.1.2">𝑣</ci><ci id="alg5.l6.m1.1.1.3.cmml" xref="alg5.l6.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l6.m1.1c">v_{g}</annotation><annotation encoding="application/x-llamapun" id="alg5.l6.m1.1d">italic_v start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> to the most probable cluster in the global clustering, denoted <math alttext="C_{g}^{*}" class="ltx_Math" display="inline" id="alg5.l6.m2.1"><semantics id="alg5.l6.m2.1a"><msubsup id="alg5.l6.m2.1.1" xref="alg5.l6.m2.1.1.cmml"><mi id="alg5.l6.m2.1.1.2.2" xref="alg5.l6.m2.1.1.2.2.cmml">C</mi><mi id="alg5.l6.m2.1.1.2.3" xref="alg5.l6.m2.1.1.2.3.cmml">g</mi><mo id="alg5.l6.m2.1.1.3" xref="alg5.l6.m2.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg5.l6.m2.1b"><apply id="alg5.l6.m2.1.1.cmml" xref="alg5.l6.m2.1.1"><csymbol cd="ambiguous" id="alg5.l6.m2.1.1.1.cmml" xref="alg5.l6.m2.1.1">superscript</csymbol><apply id="alg5.l6.m2.1.1.2.cmml" xref="alg5.l6.m2.1.1"><csymbol cd="ambiguous" id="alg5.l6.m2.1.1.2.1.cmml" xref="alg5.l6.m2.1.1">subscript</csymbol><ci id="alg5.l6.m2.1.1.2.2.cmml" xref="alg5.l6.m2.1.1.2.2">𝐶</ci><ci id="alg5.l6.m2.1.1.2.3.cmml" xref="alg5.l6.m2.1.1.2.3">𝑔</ci></apply><times id="alg5.l6.m2.1.1.3.cmml" xref="alg5.l6.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l6.m2.1c">C_{g}^{*}</annotation><annotation encoding="application/x-llamapun" id="alg5.l6.m2.1d">italic_C start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg5.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>Compute the local reduced embedding <math alttext="v_{l}" class="ltx_Math" display="inline" id="alg5.l7.m1.1"><semantics id="alg5.l7.m1.1a"><msub id="alg5.l7.m1.1.1" xref="alg5.l7.m1.1.1.cmml"><mi id="alg5.l7.m1.1.1.2" xref="alg5.l7.m1.1.1.2.cmml">v</mi><mi id="alg5.l7.m1.1.1.3" xref="alg5.l7.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="alg5.l7.m1.1b"><apply id="alg5.l7.m1.1.1.cmml" xref="alg5.l7.m1.1.1"><csymbol cd="ambiguous" id="alg5.l7.m1.1.1.1.cmml" xref="alg5.l7.m1.1.1">subscript</csymbol><ci id="alg5.l7.m1.1.1.2.cmml" xref="alg5.l7.m1.1.1.2">𝑣</ci><ci id="alg5.l7.m1.1.1.3.cmml" xref="alg5.l7.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m1.1c">v_{l}</annotation><annotation encoding="application/x-llamapun" id="alg5.l7.m1.1d">italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> of <math alttext="v" class="ltx_Math" display="inline" id="alg5.l7.m2.1"><semantics id="alg5.l7.m2.1a"><mi id="alg5.l7.m2.1.1" xref="alg5.l7.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg5.l7.m2.1b"><ci id="alg5.l7.m2.1.1.cmml" xref="alg5.l7.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m2.1c">v</annotation><annotation encoding="application/x-llamapun" id="alg5.l7.m2.1d">italic_v</annotation></semantics></math> using the local UMAP model of <math alttext="C_{g}^{*}" class="ltx_Math" display="inline" id="alg5.l7.m3.1"><semantics id="alg5.l7.m3.1a"><msubsup id="alg5.l7.m3.1.1" xref="alg5.l7.m3.1.1.cmml"><mi id="alg5.l7.m3.1.1.2.2" xref="alg5.l7.m3.1.1.2.2.cmml">C</mi><mi id="alg5.l7.m3.1.1.2.3" xref="alg5.l7.m3.1.1.2.3.cmml">g</mi><mo id="alg5.l7.m3.1.1.3" xref="alg5.l7.m3.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg5.l7.m3.1b"><apply id="alg5.l7.m3.1.1.cmml" xref="alg5.l7.m3.1.1"><csymbol cd="ambiguous" id="alg5.l7.m3.1.1.1.cmml" xref="alg5.l7.m3.1.1">superscript</csymbol><apply id="alg5.l7.m3.1.1.2.cmml" xref="alg5.l7.m3.1.1"><csymbol cd="ambiguous" id="alg5.l7.m3.1.1.2.1.cmml" xref="alg5.l7.m3.1.1">subscript</csymbol><ci id="alg5.l7.m3.1.1.2.2.cmml" xref="alg5.l7.m3.1.1.2.2">𝐶</ci><ci id="alg5.l7.m3.1.1.2.3.cmml" xref="alg5.l7.m3.1.1.2.3">𝑔</ci></apply><times id="alg5.l7.m3.1.1.3.cmml" xref="alg5.l7.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l7.m3.1c">C_{g}^{*}</annotation><annotation encoding="application/x-llamapun" id="alg5.l7.m3.1d">italic_C start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>.

</div>
<div class="ltx_listingline" id="alg5.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>Update the local clustering of <math alttext="C_{g}^{*}" class="ltx_Math" display="inline" id="alg5.l8.m1.1"><semantics id="alg5.l8.m1.1a"><msubsup id="alg5.l8.m1.1.1" xref="alg5.l8.m1.1.1.cmml"><mi id="alg5.l8.m1.1.1.2.2" xref="alg5.l8.m1.1.1.2.2.cmml">C</mi><mi id="alg5.l8.m1.1.1.2.3" xref="alg5.l8.m1.1.1.2.3.cmml">g</mi><mo id="alg5.l8.m1.1.1.3" xref="alg5.l8.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg5.l8.m1.1b"><apply id="alg5.l8.m1.1.1.cmml" xref="alg5.l8.m1.1.1"><csymbol cd="ambiguous" id="alg5.l8.m1.1.1.1.cmml" xref="alg5.l8.m1.1.1">superscript</csymbol><apply id="alg5.l8.m1.1.1.2.cmml" xref="alg5.l8.m1.1.1"><csymbol cd="ambiguous" id="alg5.l8.m1.1.1.2.1.cmml" xref="alg5.l8.m1.1.1">subscript</csymbol><ci id="alg5.l8.m1.1.1.2.2.cmml" xref="alg5.l8.m1.1.1.2.2">𝐶</ci><ci id="alg5.l8.m1.1.1.2.3.cmml" xref="alg5.l8.m1.1.1.2.3">𝑔</ci></apply><times id="alg5.l8.m1.1.1.3.cmml" xref="alg5.l8.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="alg5.l8.m1.1c">C_{g}^{*}</annotation><annotation encoding="application/x-llamapun" id="alg5.l8.m1.1d">italic_C start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> using the online GMM procedure (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg2" title="Algorithm 2 ‣ 4.3 Adaptive GMM ‣ 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">2</span></a>).

</div>
<div class="ltx_listingline" id="alg5.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span><span class="ltx_text ltx_font_bold" id="alg5.l9.1">for all</span> clusters that changed <span class="ltx_text ltx_font_bold" id="alg5.l9.2">do</span>
</div>
<div class="ltx_listingline" id="alg5.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     Regenerate the tree summary.

</div>
<div class="ltx_listingline" id="alg5.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     Recompute the embedding for the cluster node.

</div>
<div class="ltx_listingline" id="alg5.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     Repeat the process for its ancestors in the tree.

</div>
<div class="ltx_listingline" id="alg5.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span><span class="ltx_text ltx_font_bold" id="alg5.l13.1">end</span> <span class="ltx_text ltx_font_bold" id="alg5.l13.2">for</span>
</div>
<div class="ltx_listingline" id="alg5.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span><span class="ltx_text ltx_font_bold" id="alg5.l14.1">for all</span> newly created clusters <span class="ltx_text ltx_font_bold" id="alg5.l14.2">do</span>
</div>
<div class="ltx_listingline" id="alg5.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>     Recur to the next layer (treating it as the leaf layer) and repeat the process.

</div>
<div class="ltx_listingline" id="alg5.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span><span class="ltx_text ltx_font_bold" id="alg5.l16.1">end</span> <span class="ltx_text ltx_font_bold" id="alg5.l16.2">for</span>
</div>
</div>
</figure>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Comparing one- vs two-step Clustering for postQFRAP</h2>
<div class="ltx_para ltx_noindent" id="A2.p1">
<p class="ltx_p" id="A2.p1.1">We compare postQFRAP, which uses a two-step hierarchical clustering algorithm as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S3.SS3" title="3.3 Recursive-Abstractive Tree Construction ‣ 3 Preliminaries ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">3.3</span></a>, with a one-step approach that only applies local clustering (i.e., setting the UMAP parameter <math alttext="n\_neighbors" class="ltx_Math" display="inline" id="A2.p1.1.m1.1"><semantics id="A2.p1.1.m1.1a"><mrow id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml"><mi id="A2.p1.1.m1.1.1.2" xref="A2.p1.1.m1.1.1.2.cmml">n</mi><mo id="A2.p1.1.m1.1.1.1" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.3" mathvariant="normal" xref="A2.p1.1.m1.1.1.3.cmml">_</mi><mo id="A2.p1.1.m1.1.1.1a" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.4" xref="A2.p1.1.m1.1.1.4.cmml">n</mi><mo id="A2.p1.1.m1.1.1.1b" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.5" xref="A2.p1.1.m1.1.1.5.cmml">e</mi><mo id="A2.p1.1.m1.1.1.1c" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.6" xref="A2.p1.1.m1.1.1.6.cmml">i</mi><mo id="A2.p1.1.m1.1.1.1d" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.7" xref="A2.p1.1.m1.1.1.7.cmml">g</mi><mo id="A2.p1.1.m1.1.1.1e" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.8" xref="A2.p1.1.m1.1.1.8.cmml">h</mi><mo id="A2.p1.1.m1.1.1.1f" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.9" xref="A2.p1.1.m1.1.1.9.cmml">b</mi><mo id="A2.p1.1.m1.1.1.1g" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.10" xref="A2.p1.1.m1.1.1.10.cmml">o</mi><mo id="A2.p1.1.m1.1.1.1h" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.11" xref="A2.p1.1.m1.1.1.11.cmml">r</mi><mo id="A2.p1.1.m1.1.1.1i" xref="A2.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="A2.p1.1.m1.1.1.12" xref="A2.p1.1.m1.1.1.12.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><apply id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1"><times id="A2.p1.1.m1.1.1.1.cmml" xref="A2.p1.1.m1.1.1.1"></times><ci id="A2.p1.1.m1.1.1.2.cmml" xref="A2.p1.1.m1.1.1.2">𝑛</ci><ci id="A2.p1.1.m1.1.1.3.cmml" xref="A2.p1.1.m1.1.1.3">_</ci><ci id="A2.p1.1.m1.1.1.4.cmml" xref="A2.p1.1.m1.1.1.4">𝑛</ci><ci id="A2.p1.1.m1.1.1.5.cmml" xref="A2.p1.1.m1.1.1.5">𝑒</ci><ci id="A2.p1.1.m1.1.1.6.cmml" xref="A2.p1.1.m1.1.1.6">𝑖</ci><ci id="A2.p1.1.m1.1.1.7.cmml" xref="A2.p1.1.m1.1.1.7">𝑔</ci><ci id="A2.p1.1.m1.1.1.8.cmml" xref="A2.p1.1.m1.1.1.8">ℎ</ci><ci id="A2.p1.1.m1.1.1.9.cmml" xref="A2.p1.1.m1.1.1.9">𝑏</ci><ci id="A2.p1.1.m1.1.1.10.cmml" xref="A2.p1.1.m1.1.1.10">𝑜</ci><ci id="A2.p1.1.m1.1.1.11.cmml" xref="A2.p1.1.m1.1.1.11">𝑟</ci><ci id="A2.p1.1.m1.1.1.12.cmml" xref="A2.p1.1.m1.1.1.12">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">n\_neighbors</annotation><annotation encoding="application/x-llamapun" id="A2.p1.1.m1.1d">italic_n _ italic_n italic_e italic_i italic_g italic_h italic_b italic_o italic_r italic_s</annotation></semantics></math> to 10 and using GMMs once).</p>
</div>
<div class="ltx_para ltx_noindent" id="A2.p2">
<p class="ltx_p" id="A2.p2.1">As shown in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A2.F10" title="Figure 10 ‣ Appendix B Comparing one- vs two-step Clustering for postQFRAP ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">10</span></a>,the results across all four datasets indicate that the difference between one-step and two-step clustering is minimal.
Furthermore, Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A2.F11" title="Figure 11 ‣ Appendix B Comparing one- vs two-step Clustering for postQFRAP ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">11</span></a> demonstrates that one-step clustering performs better in QASPER and QuALITY, worse in NarrativeQA, and is comparable to two-step clustering in MultiHop.
Overall, the differences in performance between the two algorithms are minor.
Based on these observations, we adopt the simpler and more efficient one-step clustering method in our algorithm.</p>
</div>
<figure class="ltx_figure" id="A2.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A2.F10.1" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="531" id="A2.F10.1.g1" src="x10.png" width="996"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A2.F10.2" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="531" id="A2.F10.2.g1" src="x11.png" width="996"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A2.F10.3" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="531" id="A2.F10.3.g1" src="x12.png" width="996"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A2.F10.4" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="531" id="A2.F10.4.g1" src="x13.png" width="996"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Comparison of postQFRAP with one-step clustering and postQFRAP with two-step clustering on 4 datasets.</figcaption>
</figure>
<figure class="ltx_figure" id="A2.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="A2.F11.g1" src="x14.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Percentage of Wins, Ties and Losses for postQFRAP with one-step clustering (green) vs postQFRAP with two-step clustering (red) on 4 datasets.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Qualitative Analysis of Human Coherence Rating</h2>
<div class="ltx_para ltx_noindent" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">To qualitatively analyze the newly proposed Human Coherence Rating, we consider an example of a question from the MultiHop dataset where using naïve RAG led to a low rating.
The results are summarized in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:qualHCR</span>.</p>
</div>
<figure class="ltx_table" id="A3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of Human Coherence Ratings for generated answers to a MultiHop dataset question, evaluating the performance of Naïve RAG versus postQFRAP models.</figcaption>
<table class="ltx_tabular" id="A3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A3.T1.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="3" id="A3.T1.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.1.1.1.1">
<span class="ltx_p" id="A3.T1.1.1.1.1.1.1" style="width:369.9pt;"><span class="ltx_text ltx_font_bold" id="A3.T1.1.1.1.1.1.1.1">Question: What injury has prevented Michail Antonio from participating in the match against Canada?</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A3.T1.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A3.T1.1.2.1.1" rowspan="3">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.2.1.1.1">
<span class="ltx_p" id="A3.T1.1.2.1.1.1.1" style="width:49.8pt;"><span class="ltx_text ltx_font_bold" id="A3.T1.1.2.1.1.1.1.1">Naïve RAG</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.2.1.2.1">
<span class="ltx_p" id="A3.T1.1.2.1.2.1.1" style="width:78.2pt;">Generated Answer</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.2.1.3">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.2.1.3.1">
<span class="ltx_p" id="A3.T1.1.2.1.3.1.1" style="width:227.6pt;">Michail Antonio has been sidelined due to a gutting ACL injury sustained during the match against Canada. He is now beginning a lengthy rehabilitation process.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T1.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.3.2.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.3.2.1.1">
<span class="ltx_p" id="A3.T1.1.3.2.1.1.1" style="width:78.2pt;">
<span class="ltx_tabular ltx_align_middle" id="A3.T1.1.3.2.1.1.1.1">
<span class="ltx_tr" id="A3.T1.1.3.2.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T1.1.3.2.1.1.1.1.1.1">Human Coherence</span></span>
<span class="ltx_tr" id="A3.T1.1.3.2.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T1.1.3.2.1.1.1.1.2.1">Rating</span></span>
</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.3.2.2.1">
<span class="ltx_p" id="A3.T1.1.3.2.2.1.1" style="width:227.6pt;">0.4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T1.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.4.3.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.4.3.1.1">
<span class="ltx_p" id="A3.T1.1.4.3.1.1.1" style="width:78.2pt;">Rating Explanation</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.4.3.2.1">
<span class="ltx_p" id="A3.T1.1.4.3.2.1.1" style="width:227.6pt;">The provided answer lacks coherence due to an error in the terminology used; an ACL injury (anterior cruciate ligament injury) is described as ”gutting,” which is an inappropriate term in this context. Additionally, the phrase ”sustained during the first leg of the match against Canada” suggests that the injury occurred during the match itself, which could be misleading. Furthermore, the transition to discussing the rehabilitation process feels abrupt and does not smoothly connect with the explanation of the injury.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T1.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A3.T1.1.5.4.1" rowspan="3">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.5.4.1.1">
<span class="ltx_p" id="A3.T1.1.5.4.1.1.1" style="width:49.8pt;"><span class="ltx_text ltx_font_bold" id="A3.T1.1.5.4.1.1.1.1">postQFRAP</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.5.4.2.1">
<span class="ltx_p" id="A3.T1.1.5.4.2.1.1" style="width:78.2pt;">Generated Answer</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.5.4.3">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.5.4.3.1">
<span class="ltx_p" id="A3.T1.1.5.4.3.1.1" style="width:227.6pt;">Michail Antonio was unable to participate in the match against Canada due to a significant injury that has been identified as a possible hamstring issue. There are also reports suggesting that his injury may be more severe than initially thought, with some sources indicating it could potentially be an ACL (anterior cruciate ligament) injury. This type of injury typically requires a lengthy rehabilitation process, which could keep him out of action for an extended period.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T1.1.6.5">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.6.5.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.6.5.1.1">
<span class="ltx_p" id="A3.T1.1.6.5.1.1.1" style="width:78.2pt;">
<span class="ltx_tabular ltx_align_middle" id="A3.T1.1.6.5.1.1.1.1">
<span class="ltx_tr" id="A3.T1.1.6.5.1.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T1.1.6.5.1.1.1.1.1.1">Human Coherence</span></span>
<span class="ltx_tr" id="A3.T1.1.6.5.1.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="A3.T1.1.6.5.1.1.1.1.2.1">Rating</span></span>
</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A3.T1.1.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.6.5.2.1">
<span class="ltx_p" id="A3.T1.1.6.5.2.1.1" style="width:227.6pt;">1.0</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A3.T1.1.7.6">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="A3.T1.1.7.6.1">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.7.6.1.1">
<span class="ltx_p" id="A3.T1.1.7.6.1.1.1" style="width:78.2pt;">Rating Explanation</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="A3.T1.1.7.6.2">
<span class="ltx_inline-block ltx_align_top" id="A3.T1.1.7.6.2.1">
<span class="ltx_p" id="A3.T1.1.7.6.2.1.1" style="width:227.6pt;">The provided answer is coherent and presents a clear response to the question about Michail Antonio’s injury. The information is logically structured, beginning with the immediate reason for his absence (a significant injury) and then elaborating on the nature and severity of that injury (possible hamstring issue and potential ACL injury). The flow of ideas is smooth, with each sentence building upon the previous one, maintaining relevance to the question throughout.</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Qualitative Analysis of postQFRAP</h2>
<div class="ltx_para ltx_noindent" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">To qualitatively analyze the postQFRAP algorithm, we examine a question from the MultiHop dataset. Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:qualOurs</span> presents the contexts and answers generated by postQFRAP and naïve RAG.
The context produced by naïve RAG is scattered and often irrelevant to the question, causing the QA model to fail in providing an answer.
In contrast, postQFRAP generates a coherent and highly relevant context, resulting in significant portions of the final answer being directly extracted from this context.</p>
</div>
<figure class="ltx_table" id="A4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison of contexts and answers generated for a MultiHop question using Naïve RAG and postQFRAP.</figcaption>
<table class="ltx_tabular" id="A4.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A4.T2.1.1.1">
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" colspan="3" id="A4.T2.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.1.1.1.1">
<span class="ltx_p" id="A4.T2.1.1.1.1.1.1" style="width:369.9pt;"><span class="ltx_text ltx_font_bold" id="A4.T2.1.1.1.1.1.1.1">Question: What measures has the U.K. Judicial Office implemented to ensure the responsible use of AI in the judicial system?</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A4.T2.1.2.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_l ltx_border_r ltx_border_t" id="A4.T2.1.2.1.1" rowspan="2">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.2.1.1.1">
<span class="ltx_p" id="A4.T2.1.2.1.1.1.1" style="width:49.8pt;"><span class="ltx_text ltx_font_bold" id="A4.T2.1.2.1.1.1.1.1">Naïve RAG</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T2.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.2.1.2.1">
<span class="ltx_p" id="A4.T2.1.2.1.2.1.1" style="width:42.7pt;">Generated Context</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T2.1.2.1.3">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.2.1.3.1">
<span class="ltx_p" id="A4.T2.1.2.1.3.1.1" style="width:263.2pt;">[…] “the use of AI in sentencing, parole and probation, pretrial release and detention, risk assessments, surveillance, crime forecasting and predictive policing, and forensic analysis.” […] prioritizing federal support to accelerate development of privacy-preserving techniques […] cryptographic tools that preserve individuals’ privacy […] “We have also established a governance team to put them into action by conducting ethical reviews of new systems, avoiding bias and incorporating privacy, security and safety.” […] “Citizens will have a right to launch complaints about AI systems and receive explanations about decisions based on high-risk AI systems that impact their rights.” […] The use of remote biometric identification technology in public places by law enforcement has not been completely banned […] the parliament said negotiators had agreed on a series of safeguards and narrow exceptions to limit use of technologies such as facial recognition. […] with uses limited to a “strictly defined” lists of crime. […]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T2.1.3.2">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T2.1.3.2.1">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.3.2.1.1">
<span class="ltx_p" id="A4.T2.1.3.2.1.1.1" style="width:42.7pt;">Generated Answer</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T2.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.3.2.2.1">
<span class="ltx_p" id="A4.T2.1.3.2.2.1.1" style="width:263.2pt;">No information is provided in the sources.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T2.1.4.3">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A4.T2.1.4.3.1" rowspan="3">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.4.3.1.1">
<span class="ltx_p" id="A4.T2.1.4.3.1.1.1" style="width:49.8pt;"><span class="ltx_text ltx_font_bold" id="A4.T2.1.4.3.1.1.1.1">postQFRAP</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T2.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.4.3.2.1">
<span class="ltx_p" id="A4.T2.1.4.3.2.1.1" style="width:42.7pt;">Generated Context</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A4.T2.1.4.3.3">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.4.3.3.1">
<span class="ltx_p" id="A4.T2.1.4.3.3.1.1" style="width:263.2pt;">The U.K. Judicial Office has recently issued guidance that allows judges to utilize AI tools, including ChatGPT, in their legal duties and court rulings. This guidance is designed to promote the responsible and ethical use of AI within the judicial system. […] Judges are encouraged to critically assess the outputs generated by AI tools and to consider how these outputs may reflect or perpetuate existing biases. […] By fostering a culture of critical engagement with AI, the Judicial Office aims to mitigate the risks associated with automated decision-making.</span>
<span class="ltx_p" id="A4.T2.1.4.3.3.1.2">[…] the guidance underscores the necessity of upholding privacy standards when using AI in court proceedings. Judges are reminded to protect sensitive information and ensure that the use of AI does not compromise the confidentiality of legal processes.</span>
<span class="ltx_p" id="A4.T2.1.4.3.3.1.3">[…] the retrieved documents do not detail specific measures or actions taken by the Judicial Office beyond this guidance. […] they primarily focus on broader discussions surrounding AI regulations in other contexts, such as the European Union’s AI Act and various U.S. executive orders related to AI. […] These regulations do not directly pertain to the U.K. Judicial Office’s measures. […]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A4.T2.1.5.4">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="A4.T2.1.5.4.1">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.5.4.1.1">
<span class="ltx_p" id="A4.T2.1.5.4.1.1.1" style="width:42.7pt;">Generated Answer</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r ltx_border_t" id="A4.T2.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A4.T2.1.5.4.2.1">
<span class="ltx_p" id="A4.T2.1.5.4.2.1.1" style="width:263.2pt;">The U.K. Judicial Office has implemented guidance that promotes the responsible and ethical use of AI tools, including ChatGPT, within the judicial system. Key measures outlined in this guidance include:</span>
<span class="ltx_p" id="A4.T2.1.5.4.2.1.2">1. **Awareness of Potential Bias**: Judges are encouraged to critically assess the outputs generated by AI tools. […]</span>
<span class="ltx_p" id="A4.T2.1.5.4.2.1.3">2. **Upholding Privacy Standards**: The guidance emphasizes the necessity of protecting sensitive information during court proceedings. […]</span>
<span class="ltx_p" id="A4.T2.1.5.4.2.1.4">3. **Promoting Critical Engagement**: By fostering a culture of critical engagement with AI, the Judicial Office aims to mitigate the risks associated with automated decision-making. […]</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Selection of <math alttext="k_{0}" class="ltx_Math" display="inline" id="A5.1.m1.1"><semantics id="A5.1.m1.1b"><msub id="A5.1.m1.1.1" xref="A5.1.m1.1.1.cmml"><mi id="A5.1.m1.1.1.2" xref="A5.1.m1.1.1.2.cmml">k</mi><mn id="A5.1.m1.1.1.3" xref="A5.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A5.1.m1.1c"><apply id="A5.1.m1.1.1.cmml" xref="A5.1.m1.1.1"><csymbol cd="ambiguous" id="A5.1.m1.1.1.1.cmml" xref="A5.1.m1.1.1">subscript</csymbol><ci id="A5.1.m1.1.1.2.cmml" xref="A5.1.m1.1.1.2">𝑘</ci><cn id="A5.1.m1.1.1.3.cmml" type="integer" xref="A5.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.1.m1.1d">k_{0}</annotation><annotation encoding="application/x-llamapun" id="A5.1.m1.1e">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> for postQFRAP</h2>
<div class="ltx_para ltx_noindent" id="A5.p1">
<p class="ltx_p" id="A5.p1.2">To determine the optimal value of <math alttext="k_{0}" class="ltx_Math" display="inline" id="A5.p1.1.m1.1"><semantics id="A5.p1.1.m1.1a"><msub id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml"><mi id="A5.p1.1.m1.1.1.2" xref="A5.p1.1.m1.1.1.2.cmml">k</mi><mn id="A5.p1.1.m1.1.1.3" xref="A5.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.1b"><apply id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A5.p1.1.m1.1.1.1.cmml" xref="A5.p1.1.m1.1.1">subscript</csymbol><ci id="A5.p1.1.m1.1.1.2.cmml" xref="A5.p1.1.m1.1.1.2">𝑘</ci><cn id="A5.p1.1.m1.1.1.3.cmml" type="integer" xref="A5.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="A5.p1.1.m1.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> for our main experiments, we evaluated five different values, <math alttext="k_{0}\in\{10,20,40,60,80\}" class="ltx_Math" display="inline" id="A5.p1.2.m2.5"><semantics id="A5.p1.2.m2.5a"><mrow id="A5.p1.2.m2.5.6" xref="A5.p1.2.m2.5.6.cmml"><msub id="A5.p1.2.m2.5.6.2" xref="A5.p1.2.m2.5.6.2.cmml"><mi id="A5.p1.2.m2.5.6.2.2" xref="A5.p1.2.m2.5.6.2.2.cmml">k</mi><mn id="A5.p1.2.m2.5.6.2.3" xref="A5.p1.2.m2.5.6.2.3.cmml">0</mn></msub><mo id="A5.p1.2.m2.5.6.1" xref="A5.p1.2.m2.5.6.1.cmml">∈</mo><mrow id="A5.p1.2.m2.5.6.3.2" xref="A5.p1.2.m2.5.6.3.1.cmml"><mo id="A5.p1.2.m2.5.6.3.2.1" stretchy="false" xref="A5.p1.2.m2.5.6.3.1.cmml">{</mo><mn id="A5.p1.2.m2.1.1" xref="A5.p1.2.m2.1.1.cmml">10</mn><mo id="A5.p1.2.m2.5.6.3.2.2" xref="A5.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="A5.p1.2.m2.2.2" xref="A5.p1.2.m2.2.2.cmml">20</mn><mo id="A5.p1.2.m2.5.6.3.2.3" xref="A5.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="A5.p1.2.m2.3.3" xref="A5.p1.2.m2.3.3.cmml">40</mn><mo id="A5.p1.2.m2.5.6.3.2.4" xref="A5.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="A5.p1.2.m2.4.4" xref="A5.p1.2.m2.4.4.cmml">60</mn><mo id="A5.p1.2.m2.5.6.3.2.5" xref="A5.p1.2.m2.5.6.3.1.cmml">,</mo><mn id="A5.p1.2.m2.5.5" xref="A5.p1.2.m2.5.5.cmml">80</mn><mo id="A5.p1.2.m2.5.6.3.2.6" stretchy="false" xref="A5.p1.2.m2.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.2.m2.5b"><apply id="A5.p1.2.m2.5.6.cmml" xref="A5.p1.2.m2.5.6"><in id="A5.p1.2.m2.5.6.1.cmml" xref="A5.p1.2.m2.5.6.1"></in><apply id="A5.p1.2.m2.5.6.2.cmml" xref="A5.p1.2.m2.5.6.2"><csymbol cd="ambiguous" id="A5.p1.2.m2.5.6.2.1.cmml" xref="A5.p1.2.m2.5.6.2">subscript</csymbol><ci id="A5.p1.2.m2.5.6.2.2.cmml" xref="A5.p1.2.m2.5.6.2.2">𝑘</ci><cn id="A5.p1.2.m2.5.6.2.3.cmml" type="integer" xref="A5.p1.2.m2.5.6.2.3">0</cn></apply><set id="A5.p1.2.m2.5.6.3.1.cmml" xref="A5.p1.2.m2.5.6.3.2"><cn id="A5.p1.2.m2.1.1.cmml" type="integer" xref="A5.p1.2.m2.1.1">10</cn><cn id="A5.p1.2.m2.2.2.cmml" type="integer" xref="A5.p1.2.m2.2.2">20</cn><cn id="A5.p1.2.m2.3.3.cmml" type="integer" xref="A5.p1.2.m2.3.3">40</cn><cn id="A5.p1.2.m2.4.4.cmml" type="integer" xref="A5.p1.2.m2.4.4">60</cn><cn id="A5.p1.2.m2.5.5.cmml" type="integer" xref="A5.p1.2.m2.5.5">80</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.2.m2.5c">k_{0}\in\{10,20,40,60,80\}</annotation><annotation encoding="application/x-llamapun" id="A5.p1.2.m2.5d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ { 10 , 20 , 40 , 60 , 80 }</annotation></semantics></math>, by comparing the performance on 100 questions from the validation sets of the NarrativeQA and QASPER datasets. It is important to emphasize that these questions are entirely distinct from the data used in our main experiments.
As in our primary experiments, we limited the final summary size to 2,000 tokens and considered three metrics: the number of answered questions, context relevance, and human coherence.
To account for the non-deterministic nature of the LLM evaluators, we repeated the evaluation process three times and reported the average performance along with the standard error in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A5.F12" title="Figure 12 ‣ Appendix E Selection of 𝑘₀ for postQFRAP ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">12</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.p2">
<p class="ltx_p" id="A5.p2.1">As expected, context relevance increases with higher <math alttext="k_{0}" class="ltx_Math" display="inline" id="A5.p2.1.m1.1"><semantics id="A5.p2.1.m1.1a"><msub id="A5.p2.1.m1.1.1" xref="A5.p2.1.m1.1.1.cmml"><mi id="A5.p2.1.m1.1.1.2" xref="A5.p2.1.m1.1.1.2.cmml">k</mi><mn id="A5.p2.1.m1.1.1.3" xref="A5.p2.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A5.p2.1.m1.1b"><apply id="A5.p2.1.m1.1.1.cmml" xref="A5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A5.p2.1.m1.1.1.1.cmml" xref="A5.p2.1.m1.1.1">subscript</csymbol><ci id="A5.p2.1.m1.1.1.2.cmml" xref="A5.p2.1.m1.1.1.2">𝑘</ci><cn id="A5.p2.1.m1.1.1.3.cmml" type="integer" xref="A5.p2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.1.m1.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="A5.p2.1.m1.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> values, as including more documents allows additional potentially relevant content to be retained while ensuring irrelevant content is excluded from the summaries.</p>
</div>
<div class="ltx_para ltx_noindent" id="A5.p3">
<p class="ltx_p" id="A5.p3.4">In both validation sets, we observe that the fraction of answered questions and human coherence peaks at <math alttext="k_{0}=20" class="ltx_Math" display="inline" id="A5.p3.1.m1.1"><semantics id="A5.p3.1.m1.1a"><mrow id="A5.p3.1.m1.1.1" xref="A5.p3.1.m1.1.1.cmml"><msub id="A5.p3.1.m1.1.1.2" xref="A5.p3.1.m1.1.1.2.cmml"><mi id="A5.p3.1.m1.1.1.2.2" xref="A5.p3.1.m1.1.1.2.2.cmml">k</mi><mn id="A5.p3.1.m1.1.1.2.3" xref="A5.p3.1.m1.1.1.2.3.cmml">0</mn></msub><mo id="A5.p3.1.m1.1.1.1" xref="A5.p3.1.m1.1.1.1.cmml">=</mo><mn id="A5.p3.1.m1.1.1.3" xref="A5.p3.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p3.1.m1.1b"><apply id="A5.p3.1.m1.1.1.cmml" xref="A5.p3.1.m1.1.1"><eq id="A5.p3.1.m1.1.1.1.cmml" xref="A5.p3.1.m1.1.1.1"></eq><apply id="A5.p3.1.m1.1.1.2.cmml" xref="A5.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="A5.p3.1.m1.1.1.2.1.cmml" xref="A5.p3.1.m1.1.1.2">subscript</csymbol><ci id="A5.p3.1.m1.1.1.2.2.cmml" xref="A5.p3.1.m1.1.1.2.2">𝑘</ci><cn id="A5.p3.1.m1.1.1.2.3.cmml" type="integer" xref="A5.p3.1.m1.1.1.2.3">0</cn></apply><cn id="A5.p3.1.m1.1.1.3.cmml" type="integer" xref="A5.p3.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.1.m1.1c">k_{0}=20</annotation><annotation encoding="application/x-llamapun" id="A5.p3.1.m1.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 20</annotation></semantics></math>.
Although <math alttext="k_{0}\in\{60,80\}" class="ltx_Math" display="inline" id="A5.p3.2.m2.2"><semantics id="A5.p3.2.m2.2a"><mrow id="A5.p3.2.m2.2.3" xref="A5.p3.2.m2.2.3.cmml"><msub id="A5.p3.2.m2.2.3.2" xref="A5.p3.2.m2.2.3.2.cmml"><mi id="A5.p3.2.m2.2.3.2.2" xref="A5.p3.2.m2.2.3.2.2.cmml">k</mi><mn id="A5.p3.2.m2.2.3.2.3" xref="A5.p3.2.m2.2.3.2.3.cmml">0</mn></msub><mo id="A5.p3.2.m2.2.3.1" xref="A5.p3.2.m2.2.3.1.cmml">∈</mo><mrow id="A5.p3.2.m2.2.3.3.2" xref="A5.p3.2.m2.2.3.3.1.cmml"><mo id="A5.p3.2.m2.2.3.3.2.1" stretchy="false" xref="A5.p3.2.m2.2.3.3.1.cmml">{</mo><mn id="A5.p3.2.m2.1.1" xref="A5.p3.2.m2.1.1.cmml">60</mn><mo id="A5.p3.2.m2.2.3.3.2.2" xref="A5.p3.2.m2.2.3.3.1.cmml">,</mo><mn id="A5.p3.2.m2.2.2" xref="A5.p3.2.m2.2.2.cmml">80</mn><mo id="A5.p3.2.m2.2.3.3.2.3" stretchy="false" xref="A5.p3.2.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A5.p3.2.m2.2b"><apply id="A5.p3.2.m2.2.3.cmml" xref="A5.p3.2.m2.2.3"><in id="A5.p3.2.m2.2.3.1.cmml" xref="A5.p3.2.m2.2.3.1"></in><apply id="A5.p3.2.m2.2.3.2.cmml" xref="A5.p3.2.m2.2.3.2"><csymbol cd="ambiguous" id="A5.p3.2.m2.2.3.2.1.cmml" xref="A5.p3.2.m2.2.3.2">subscript</csymbol><ci id="A5.p3.2.m2.2.3.2.2.cmml" xref="A5.p3.2.m2.2.3.2.2">𝑘</ci><cn id="A5.p3.2.m2.2.3.2.3.cmml" type="integer" xref="A5.p3.2.m2.2.3.2.3">0</cn></apply><set id="A5.p3.2.m2.2.3.3.1.cmml" xref="A5.p3.2.m2.2.3.3.2"><cn id="A5.p3.2.m2.1.1.cmml" type="integer" xref="A5.p3.2.m2.1.1">60</cn><cn id="A5.p3.2.m2.2.2.cmml" type="integer" xref="A5.p3.2.m2.2.2">80</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.2.m2.2c">k_{0}\in\{60,80\}</annotation><annotation encoding="application/x-llamapun" id="A5.p3.2.m2.2d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ∈ { 60 , 80 }</annotation></semantics></math> provides higher context relevance compared to <math alttext="k_{0}=20" class="ltx_Math" display="inline" id="A5.p3.3.m3.1"><semantics id="A5.p3.3.m3.1a"><mrow id="A5.p3.3.m3.1.1" xref="A5.p3.3.m3.1.1.cmml"><msub id="A5.p3.3.m3.1.1.2" xref="A5.p3.3.m3.1.1.2.cmml"><mi id="A5.p3.3.m3.1.1.2.2" xref="A5.p3.3.m3.1.1.2.2.cmml">k</mi><mn id="A5.p3.3.m3.1.1.2.3" xref="A5.p3.3.m3.1.1.2.3.cmml">0</mn></msub><mo id="A5.p3.3.m3.1.1.1" xref="A5.p3.3.m3.1.1.1.cmml">=</mo><mn id="A5.p3.3.m3.1.1.3" xref="A5.p3.3.m3.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p3.3.m3.1b"><apply id="A5.p3.3.m3.1.1.cmml" xref="A5.p3.3.m3.1.1"><eq id="A5.p3.3.m3.1.1.1.cmml" xref="A5.p3.3.m3.1.1.1"></eq><apply id="A5.p3.3.m3.1.1.2.cmml" xref="A5.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="A5.p3.3.m3.1.1.2.1.cmml" xref="A5.p3.3.m3.1.1.2">subscript</csymbol><ci id="A5.p3.3.m3.1.1.2.2.cmml" xref="A5.p3.3.m3.1.1.2.2">𝑘</ci><cn id="A5.p3.3.m3.1.1.2.3.cmml" type="integer" xref="A5.p3.3.m3.1.1.2.3">0</cn></apply><cn id="A5.p3.3.m3.1.1.3.cmml" type="integer" xref="A5.p3.3.m3.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.3.m3.1c">k_{0}=20</annotation><annotation encoding="application/x-llamapun" id="A5.p3.3.m3.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 20</annotation></semantics></math>, we select <math alttext="k_{0}=20" class="ltx_Math" display="inline" id="A5.p3.4.m4.1"><semantics id="A5.p3.4.m4.1a"><mrow id="A5.p3.4.m4.1.1" xref="A5.p3.4.m4.1.1.cmml"><msub id="A5.p3.4.m4.1.1.2" xref="A5.p3.4.m4.1.1.2.cmml"><mi id="A5.p3.4.m4.1.1.2.2" xref="A5.p3.4.m4.1.1.2.2.cmml">k</mi><mn id="A5.p3.4.m4.1.1.2.3" xref="A5.p3.4.m4.1.1.2.3.cmml">0</mn></msub><mo id="A5.p3.4.m4.1.1.1" xref="A5.p3.4.m4.1.1.1.cmml">=</mo><mn id="A5.p3.4.m4.1.1.3" xref="A5.p3.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="A5.p3.4.m4.1b"><apply id="A5.p3.4.m4.1.1.cmml" xref="A5.p3.4.m4.1.1"><eq id="A5.p3.4.m4.1.1.1.cmml" xref="A5.p3.4.m4.1.1.1"></eq><apply id="A5.p3.4.m4.1.1.2.cmml" xref="A5.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="A5.p3.4.m4.1.1.2.1.cmml" xref="A5.p3.4.m4.1.1.2">subscript</csymbol><ci id="A5.p3.4.m4.1.1.2.2.cmml" xref="A5.p3.4.m4.1.1.2.2">𝑘</ci><cn id="A5.p3.4.m4.1.1.2.3.cmml" type="integer" xref="A5.p3.4.m4.1.1.2.3">0</cn></apply><cn id="A5.p3.4.m4.1.1.3.cmml" type="integer" xref="A5.p3.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p3.4.m4.1c">k_{0}=20</annotation><annotation encoding="application/x-llamapun" id="A5.p3.4.m4.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 20</annotation></semantics></math> for our experiments as it optimizes the number of answered questions and human coherence without sacrificing too much context relevance.
Additionally, this choice ensures a more efficient post-retrieval process compared to larger values.</p>
</div>
<figure class="ltx_figure" id="A5.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A5.F12.1" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="778" id="A5.F12.1.g1" src="x15.png" width="1037"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A5.F12.2" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="778" id="A5.F12.2.g1" src="x16.png" width="1037"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Comparison of different values of <math alttext="k_{0}" class="ltx_Math" display="inline" id="A5.F12.4.m1.1"><semantics id="A5.F12.4.m1.1b"><msub id="A5.F12.4.m1.1.1" xref="A5.F12.4.m1.1.1.cmml"><mi id="A5.F12.4.m1.1.1.2" xref="A5.F12.4.m1.1.1.2.cmml">k</mi><mn id="A5.F12.4.m1.1.1.3" xref="A5.F12.4.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A5.F12.4.m1.1c"><apply id="A5.F12.4.m1.1.1.cmml" xref="A5.F12.4.m1.1.1"><csymbol cd="ambiguous" id="A5.F12.4.m1.1.1.1.cmml" xref="A5.F12.4.m1.1.1">subscript</csymbol><ci id="A5.F12.4.m1.1.1.2.cmml" xref="A5.F12.4.m1.1.1.2">𝑘</ci><cn id="A5.F12.4.m1.1.1.3.cmml" type="integer" xref="A5.F12.4.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.F12.4.m1.1d">k_{0}</annotation><annotation encoding="application/x-llamapun" id="A5.F12.4.m1.1e">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> for the postQFRAP algorithm on NarrativeQA and QASPER validation sets.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Query Expansion</h2>
<div class="ltx_para ltx_noindent" id="A6.p1">
<p class="ltx_p" id="A6.p1.2">A possible extension to the postQFRAP algorithm is to first expand the query <math alttext="q" class="ltx_Math" display="inline" id="A6.p1.1.m1.1"><semantics id="A6.p1.1.m1.1a"><mi id="A6.p1.1.m1.1.1" xref="A6.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A6.p1.1.m1.1b"><ci id="A6.p1.1.m1.1.1.cmml" xref="A6.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="A6.p1.1.m1.1d">italic_q</annotation></semantics></math> before retrieving <math alttext="k_{0}" class="ltx_Math" display="inline" id="A6.p1.2.m2.1"><semantics id="A6.p1.2.m2.1a"><msub id="A6.p1.2.m2.1.1" xref="A6.p1.2.m2.1.1.cmml"><mi id="A6.p1.2.m2.1.1.2" xref="A6.p1.2.m2.1.1.2.cmml">k</mi><mn id="A6.p1.2.m2.1.1.3" xref="A6.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A6.p1.2.m2.1b"><apply id="A6.p1.2.m2.1.1.cmml" xref="A6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A6.p1.2.m2.1.1.1.cmml" xref="A6.p1.2.m2.1.1">subscript</csymbol><ci id="A6.p1.2.m2.1.1.2.cmml" xref="A6.p1.2.m2.1.1.2">𝑘</ci><cn id="A6.p1.2.m2.1.1.3.cmml" type="integer" xref="A6.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.2.m2.1c">k_{0}</annotation><annotation encoding="application/x-llamapun" id="A6.p1.2.m2.1d">italic_k start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> initial documents.
This would lead to broader documents being retrieved before the clustering-summarization process, potentially leading to an improved context.</p>
</div>
<div class="ltx_para ltx_noindent" id="A6.p2">
<p class="ltx_p" id="A6.p2.1">To test this approach, we use the query expansion algorithm from <cite class="ltx_cite ltx_citemacro_citep">[Jagerman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib8" title="">2023</a>]</cite> with the Q2E/PRF prompt.
It consists of first retrieving the top-3 documents using naïve RAG. Then, we ask an LLM to extract key words from those documents relevant to the question. We append those to the query that is duplicated 5 times to get the augmented query <math alttext="q^{\prime}" class="ltx_Math" display="inline" id="A6.p2.1.m1.1"><semantics id="A6.p2.1.m1.1a"><msup id="A6.p2.1.m1.1.1" xref="A6.p2.1.m1.1.1.cmml"><mi id="A6.p2.1.m1.1.1.2" xref="A6.p2.1.m1.1.1.2.cmml">q</mi><mo id="A6.p2.1.m1.1.1.3" xref="A6.p2.1.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A6.p2.1.m1.1b"><apply id="A6.p2.1.m1.1.1.cmml" xref="A6.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A6.p2.1.m1.1.1.1.cmml" xref="A6.p2.1.m1.1.1">superscript</csymbol><ci id="A6.p2.1.m1.1.1.2.cmml" xref="A6.p2.1.m1.1.1.2">𝑞</ci><ci id="A6.p2.1.m1.1.1.3.cmml" xref="A6.p2.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.1.m1.1c">q^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.1.m1.1d">italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="A6.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q^{\prime}=\text{Concat}(q,q,q,q,q,\text{LLM}(\text{prompt}_{q}))" class="ltx_Math" display="block" id="A6.Ex2.m1.6"><semantics id="A6.Ex2.m1.6a"><mrow id="A6.Ex2.m1.6.6" xref="A6.Ex2.m1.6.6.cmml"><msup id="A6.Ex2.m1.6.6.3" xref="A6.Ex2.m1.6.6.3.cmml"><mi id="A6.Ex2.m1.6.6.3.2" xref="A6.Ex2.m1.6.6.3.2.cmml">q</mi><mo id="A6.Ex2.m1.6.6.3.3" xref="A6.Ex2.m1.6.6.3.3.cmml">′</mo></msup><mo id="A6.Ex2.m1.6.6.2" xref="A6.Ex2.m1.6.6.2.cmml">=</mo><mrow id="A6.Ex2.m1.6.6.1" xref="A6.Ex2.m1.6.6.1.cmml"><mtext id="A6.Ex2.m1.6.6.1.3" xref="A6.Ex2.m1.6.6.1.3a.cmml">Concat</mtext><mo id="A6.Ex2.m1.6.6.1.2" xref="A6.Ex2.m1.6.6.1.2.cmml">⁢</mo><mrow id="A6.Ex2.m1.6.6.1.1.1" xref="A6.Ex2.m1.6.6.1.1.2.cmml"><mo id="A6.Ex2.m1.6.6.1.1.1.2" stretchy="false" xref="A6.Ex2.m1.6.6.1.1.2.cmml">(</mo><mi id="A6.Ex2.m1.1.1" xref="A6.Ex2.m1.1.1.cmml">q</mi><mo id="A6.Ex2.m1.6.6.1.1.1.3" xref="A6.Ex2.m1.6.6.1.1.2.cmml">,</mo><mi id="A6.Ex2.m1.2.2" xref="A6.Ex2.m1.2.2.cmml">q</mi><mo id="A6.Ex2.m1.6.6.1.1.1.4" xref="A6.Ex2.m1.6.6.1.1.2.cmml">,</mo><mi id="A6.Ex2.m1.3.3" xref="A6.Ex2.m1.3.3.cmml">q</mi><mo id="A6.Ex2.m1.6.6.1.1.1.5" xref="A6.Ex2.m1.6.6.1.1.2.cmml">,</mo><mi id="A6.Ex2.m1.4.4" xref="A6.Ex2.m1.4.4.cmml">q</mi><mo id="A6.Ex2.m1.6.6.1.1.1.6" xref="A6.Ex2.m1.6.6.1.1.2.cmml">,</mo><mi id="A6.Ex2.m1.5.5" xref="A6.Ex2.m1.5.5.cmml">q</mi><mo id="A6.Ex2.m1.6.6.1.1.1.7" xref="A6.Ex2.m1.6.6.1.1.2.cmml">,</mo><mrow id="A6.Ex2.m1.6.6.1.1.1.1" xref="A6.Ex2.m1.6.6.1.1.1.1.cmml"><mtext id="A6.Ex2.m1.6.6.1.1.1.1.3" xref="A6.Ex2.m1.6.6.1.1.1.1.3a.cmml">LLM</mtext><mo id="A6.Ex2.m1.6.6.1.1.1.1.2" xref="A6.Ex2.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="A6.Ex2.m1.6.6.1.1.1.1.1.1" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="A6.Ex2.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><msub id="A6.Ex2.m1.6.6.1.1.1.1.1.1.1" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml"><mtext id="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.2" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.2a.cmml">prompt</mtext><mi id="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.3" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="A6.Ex2.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A6.Ex2.m1.6.6.1.1.1.8" stretchy="false" xref="A6.Ex2.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.Ex2.m1.6b"><apply id="A6.Ex2.m1.6.6.cmml" xref="A6.Ex2.m1.6.6"><eq id="A6.Ex2.m1.6.6.2.cmml" xref="A6.Ex2.m1.6.6.2"></eq><apply id="A6.Ex2.m1.6.6.3.cmml" xref="A6.Ex2.m1.6.6.3"><csymbol cd="ambiguous" id="A6.Ex2.m1.6.6.3.1.cmml" xref="A6.Ex2.m1.6.6.3">superscript</csymbol><ci id="A6.Ex2.m1.6.6.3.2.cmml" xref="A6.Ex2.m1.6.6.3.2">𝑞</ci><ci id="A6.Ex2.m1.6.6.3.3.cmml" xref="A6.Ex2.m1.6.6.3.3">′</ci></apply><apply id="A6.Ex2.m1.6.6.1.cmml" xref="A6.Ex2.m1.6.6.1"><times id="A6.Ex2.m1.6.6.1.2.cmml" xref="A6.Ex2.m1.6.6.1.2"></times><ci id="A6.Ex2.m1.6.6.1.3a.cmml" xref="A6.Ex2.m1.6.6.1.3"><mtext id="A6.Ex2.m1.6.6.1.3.cmml" xref="A6.Ex2.m1.6.6.1.3">Concat</mtext></ci><vector id="A6.Ex2.m1.6.6.1.1.2.cmml" xref="A6.Ex2.m1.6.6.1.1.1"><ci id="A6.Ex2.m1.1.1.cmml" xref="A6.Ex2.m1.1.1">𝑞</ci><ci id="A6.Ex2.m1.2.2.cmml" xref="A6.Ex2.m1.2.2">𝑞</ci><ci id="A6.Ex2.m1.3.3.cmml" xref="A6.Ex2.m1.3.3">𝑞</ci><ci id="A6.Ex2.m1.4.4.cmml" xref="A6.Ex2.m1.4.4">𝑞</ci><ci id="A6.Ex2.m1.5.5.cmml" xref="A6.Ex2.m1.5.5">𝑞</ci><apply id="A6.Ex2.m1.6.6.1.1.1.1.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1"><times id="A6.Ex2.m1.6.6.1.1.1.1.2.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1.2"></times><ci id="A6.Ex2.m1.6.6.1.1.1.1.3a.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1.3"><mtext id="A6.Ex2.m1.6.6.1.1.1.1.3.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1.3">LLM</mtext></ci><apply id="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.2a.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.2"><mtext id="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.2">prompt</mtext></ci><ci id="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="A6.Ex2.m1.6.6.1.1.1.1.1.1.1.3">𝑞</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.Ex2.m1.6c">q^{\prime}=\text{Concat}(q,q,q,q,q,\text{LLM}(\text{prompt}_{q}))</annotation><annotation encoding="application/x-llamapun" id="A6.Ex2.m1.6d">italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = Concat ( italic_q , italic_q , italic_q , italic_q , italic_q , LLM ( prompt start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A6.p2.4">where <math alttext="\text{LLM}(\text{prompt}_{q})" class="ltx_Math" display="inline" id="A6.p2.2.m1.1"><semantics id="A6.p2.2.m1.1a"><mrow id="A6.p2.2.m1.1.1" xref="A6.p2.2.m1.1.1.cmml"><mtext id="A6.p2.2.m1.1.1.3" xref="A6.p2.2.m1.1.1.3a.cmml">LLM</mtext><mo id="A6.p2.2.m1.1.1.2" xref="A6.p2.2.m1.1.1.2.cmml">⁢</mo><mrow id="A6.p2.2.m1.1.1.1.1" xref="A6.p2.2.m1.1.1.1.1.1.cmml"><mo id="A6.p2.2.m1.1.1.1.1.2" stretchy="false" xref="A6.p2.2.m1.1.1.1.1.1.cmml">(</mo><msub id="A6.p2.2.m1.1.1.1.1.1" xref="A6.p2.2.m1.1.1.1.1.1.cmml"><mtext id="A6.p2.2.m1.1.1.1.1.1.2" xref="A6.p2.2.m1.1.1.1.1.1.2a.cmml">prompt</mtext><mi id="A6.p2.2.m1.1.1.1.1.1.3" xref="A6.p2.2.m1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="A6.p2.2.m1.1.1.1.1.3" stretchy="false" xref="A6.p2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p2.2.m1.1b"><apply id="A6.p2.2.m1.1.1.cmml" xref="A6.p2.2.m1.1.1"><times id="A6.p2.2.m1.1.1.2.cmml" xref="A6.p2.2.m1.1.1.2"></times><ci id="A6.p2.2.m1.1.1.3a.cmml" xref="A6.p2.2.m1.1.1.3"><mtext id="A6.p2.2.m1.1.1.3.cmml" xref="A6.p2.2.m1.1.1.3">LLM</mtext></ci><apply id="A6.p2.2.m1.1.1.1.1.1.cmml" xref="A6.p2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="A6.p2.2.m1.1.1.1.1.1.1.cmml" xref="A6.p2.2.m1.1.1.1.1">subscript</csymbol><ci id="A6.p2.2.m1.1.1.1.1.1.2a.cmml" xref="A6.p2.2.m1.1.1.1.1.1.2"><mtext id="A6.p2.2.m1.1.1.1.1.1.2.cmml" xref="A6.p2.2.m1.1.1.1.1.1.2">prompt</mtext></ci><ci id="A6.p2.2.m1.1.1.1.1.1.3.cmml" xref="A6.p2.2.m1.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.2.m1.1c">\text{LLM}(\text{prompt}_{q})</annotation><annotation encoding="application/x-llamapun" id="A6.p2.2.m1.1d">LLM ( prompt start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT )</annotation></semantics></math> is the output of the Q2E/PRF prompt. The latter is found in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7.T9" title="Table 9 ‣ Appendix G Prompts ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">9</span></a>.
Then we use postQFRAP as before, by replacing <math alttext="q" class="ltx_Math" display="inline" id="A6.p2.3.m2.1"><semantics id="A6.p2.3.m2.1a"><mi id="A6.p2.3.m2.1.1" xref="A6.p2.3.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="A6.p2.3.m2.1b"><ci id="A6.p2.3.m2.1.1.cmml" xref="A6.p2.3.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.3.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="A6.p2.3.m2.1d">italic_q</annotation></semantics></math> with the augmented query <math alttext="q^{\prime}" class="ltx_Math" display="inline" id="A6.p2.4.m3.1"><semantics id="A6.p2.4.m3.1a"><msup id="A6.p2.4.m3.1.1" xref="A6.p2.4.m3.1.1.cmml"><mi id="A6.p2.4.m3.1.1.2" xref="A6.p2.4.m3.1.1.2.cmml">q</mi><mo id="A6.p2.4.m3.1.1.3" xref="A6.p2.4.m3.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="A6.p2.4.m3.1b"><apply id="A6.p2.4.m3.1.1.cmml" xref="A6.p2.4.m3.1.1"><csymbol cd="ambiguous" id="A6.p2.4.m3.1.1.1.cmml" xref="A6.p2.4.m3.1.1">superscript</csymbol><ci id="A6.p2.4.m3.1.1.2.cmml" xref="A6.p2.4.m3.1.1.2">𝑞</ci><ci id="A6.p2.4.m3.1.1.3.cmml" xref="A6.p2.4.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p2.4.m3.1c">q^{\prime}</annotation><annotation encoding="application/x-llamapun" id="A6.p2.4.m3.1d">italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="A6.p3">
<p class="ltx_p" id="A6.p3.1">We use this particular query expansion algorithm instead of the simpler Q2D/ZS algorithm that just asks an LLM to answer the query and use that answer as a new query because we do not want to exploit the LLM’s parametric knowledge.
Instead, we ground the extension on the retrieved documents.</p>
</div>
<figure class="ltx_figure" id="A6.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A6.F13.1" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="531" id="A6.F13.1.g1" src="x17.png" width="996"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A6.F13.2" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="531" id="A6.F13.2.g1" src="x18.png" width="996"/>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A6.F13.3" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="531" id="A6.F13.3.g1" src="x19.png" width="996"/>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A6.F13.4" style="width:195.1pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="531" id="A6.F13.4.g1" src="x20.png" width="996"/>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Comparing postQFRAP vs postQFRAP with Query Expansion on 4 datasets.</figcaption>
</figure>
<figure class="ltx_figure" id="A6.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="142" id="A6.F14.g1" src="x21.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span>Percentage of Wins, Ties and Losses for postQFRAP (green) vs postQFRAP with Query-Expansion (red) on 4 datasets.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="A6.p4">
<p class="ltx_p" id="A6.p4.1">We present the results in Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A6.F13" title="Figure 13 ‣ Appendix F Query Expansion ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">13</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A6.F14" title="Figure 14 ‣ Appendix F Query Expansion ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">14</span></a>.
We observe that adding Query Expansion to postQFRAP does not improve performance and, in fact, reduces the comprehensiveness and coherence of the generated answers.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Prompts</h2>
<figure class="ltx_table" id="A7.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Prompt for Question Generation</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A7.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T3.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A7.T3.1.1.1.1.1">Role</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A7.T3.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T3.1.1.1.2.1">
<span class="ltx_p" id="A7.T3.1.1.1.2.1.1" style="width:341.4pt;"><span class="ltx_text ltx_font_bold" id="A7.T3.1.1.1.2.1.1.1">Content</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A7.T3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T3.1.2.1.1">system</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T3.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T3.1.2.1.2.1">
<span class="ltx_p" id="A7.T3.1.2.1.2.1.1" style="width:341.4pt;">Given some text, you generate questions that can be answered by that text.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T3.1.3.2.1">user</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T3.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T3.1.3.2.2.1">
<span class="ltx_p" id="A7.T3.1.3.2.2.1.1" style="width:341.4pt;">You are given a context and a few example questions. Your task is to thoroughly contemplate these excerpts and conceive one question or query that a human with interest in the subject matter might pose, ensuring that the answer to that question can likely be found within the provided text segment.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T3.1.4.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T3.1.4.3.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T3.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T3.1.4.3.2.1">
<span class="ltx_p" id="A7.T3.1.4.3.2.1.1" style="width:341.4pt;">You should not use general references like ”What documents do I need to submit to demonstrate compliance with this directive?” or ”What are the requirements for compliance with this directive?”. Instead, you should use specific references like ”What documents do I need to submit to demonstrate compliance with the deposit guarantee schemes directive?”. Do not mention the context in the question. If you are unable to generate a high-quality question, return IMPOSSIBLE instead.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T3.1.5.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T3.1.5.4.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T3.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T3.1.5.4.2.1">
<span class="ltx_p" id="A7.T3.1.5.4.2.1.1" style="width:341.4pt;">Example of questions: {questions}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T3.1.6.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A7.T3.1.6.5.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" id="A7.T3.1.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T3.1.6.5.2.1">
<span class="ltx_p" id="A7.T3.1.6.5.2.1.1" style="width:341.4pt;">Context: {context}:</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A7.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Prompt for Text Summarization</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A7.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T4.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A7.T4.1.1.1.1.1">Role</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A7.T4.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T4.1.1.1.2.1">
<span class="ltx_p" id="A7.T4.1.1.1.2.1.1" style="width:341.4pt;"><span class="ltx_text ltx_font_bold" id="A7.T4.1.1.1.2.1.1.1">Content</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A7.T4.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T4.1.2.1.1">system</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T4.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T4.1.2.1.2.1">
<span class="ltx_p" id="A7.T4.1.2.1.2.1.1" style="width:341.4pt;">You are a helpful assistant.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T4.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T4.1.3.2.1">user</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T4.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T4.1.3.2.2.1">
<span class="ltx_p" id="A7.T4.1.3.2.2.1.1" style="width:341.4pt;">Write a summary of the following, including as many key details as possible using at most {max_tokens} tokens:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T4.1.4.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A7.T4.1.4.3.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" id="A7.T4.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T4.1.4.3.2.1">
<span class="ltx_p" id="A7.T4.1.4.3.2.1.1" style="width:341.4pt;">{context}</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A7.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Prompt for Query-Focused Text Summarization</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A7.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A7.T5.1.1.1.1.1">Role</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A7.T5.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T5.1.1.1.2.1">
<span class="ltx_p" id="A7.T5.1.1.1.2.1.1" style="width:341.4pt;"><span class="ltx_text ltx_font_bold" id="A7.T5.1.1.1.2.1.1.1">Content</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A7.T5.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T5.1.2.1.1">system</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T5.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T5.1.2.1.2.1">
<span class="ltx_p" id="A7.T5.1.2.1.2.1.1" style="width:341.4pt;">You are a helpful assistant.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T5.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T5.1.3.2.1">user</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T5.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T5.1.3.2.2.1">
<span class="ltx_p" id="A7.T5.1.3.2.2.1.1" style="width:341.4pt;">Summarize the information in the retrieved documents using at most {max_tokens} tokens. Make sure to include in your summary all the details that can be used to answer the question and omit any details that are entirely irrelevant to the question.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T5.1.4.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T5.1.4.3.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T5.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T5.1.4.3.2.1">
<span class="ltx_p" id="A7.T5.1.4.3.2.1.1" style="width:341.4pt;">Retrieved documents: {context}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T5.1.5.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T5.1.5.4.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T5.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T5.1.5.4.2.1">
<span class="ltx_p" id="A7.T5.1.5.4.2.1.1" style="width:341.4pt;">Question: {question}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T5.1.6.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A7.T5.1.6.5.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" id="A7.T5.1.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T5.1.6.5.2.1">
<span class="ltx_p" id="A7.T5.1.6.5.2.1.1" style="width:341.4pt;">Summary:</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A7.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Prompt for Computing Human Coherence Rating</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A7.T6.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T6.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A7.T6.1.1.1.1.1">Role</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A7.T6.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.1.1.2.1">
<span class="ltx_p" id="A7.T6.1.1.1.2.1.1" style="width:341.4pt;"><span class="ltx_text ltx_font_bold" id="A7.T6.1.1.1.2.1.1.1">Content</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A7.T6.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T6.1.2.1.1">system</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T6.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.2.1.2.1">
<span class="ltx_p" id="A7.T6.1.2.1.2.1.1" style="width:341.4pt;">You are a helpful assistant.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T6.1.3.2.1">user</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T6.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.3.2.2.1">
<span class="ltx_p" id="A7.T6.1.3.2.2.1.1" style="width:341.4pt;">You are given a question and an answer. Your task is to evaluate whether the provided answer could have been generated by a human expert, focusing on the coherence of the response. Assess how logically and smoothly the ideas are connected, how well the answer flows, and whether it maintains a clear and consistent structure. Provide a brief explanation of your reasoning, and then rate the likelihood on a scale of 1 to 5, where:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.4.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T6.1.4.3.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T6.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.4.3.2.1">
<span class="ltx_p" id="A7.T6.1.4.3.2.1.1" style="width:341.4pt;">1: Very unlikely to have been generated by a human expert (e.g., disjointed or lacking logical flow)</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.5.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T6.1.5.4.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T6.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.5.4.2.1">
<span class="ltx_p" id="A7.T6.1.5.4.2.1.1" style="width:341.4pt;">2: Unlikely (e.g., partially coherent but ideas do not flow well or seem disconnected)</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.6.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T6.1.6.5.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T6.1.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.6.5.2.1">
<span class="ltx_p" id="A7.T6.1.6.5.2.1.1" style="width:341.4pt;">3: Possibly (e.g., somewhat coherent but with noticeable breaks in flow or structure)</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.7.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T6.1.7.6.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T6.1.7.6.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.7.6.2.1">
<span class="ltx_p" id="A7.T6.1.7.6.2.1.1" style="width:341.4pt;">4: Likely (e.g., mostly coherent with minor disruptions in flow or structure)</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.8.7">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T6.1.8.7.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T6.1.8.7.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.8.7.2.1">
<span class="ltx_p" id="A7.T6.1.8.7.2.1.1" style="width:341.4pt;">5: Very likely to have been generated by a human expert (e.g., highly coherent, logically structured, and well-organized).</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.9.8">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T6.1.9.8.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T6.1.9.8.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.9.8.2.1">
<span class="ltx_p" id="A7.T6.1.9.8.2.1.1" style="width:341.4pt;">The final line of your output must be an integer between 1 and 5.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.10.9">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T6.1.10.9.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T6.1.10.9.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.10.9.2.1">
<span class="ltx_p" id="A7.T6.1.10.9.2.1.1" style="width:341.4pt;">Question: {question}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T6.1.11.10">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A7.T6.1.11.10.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" id="A7.T6.1.11.10.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T6.1.11.10.2.1">
<span class="ltx_p" id="A7.T6.1.11.10.2.1.1" style="width:341.4pt;">Answer: {answer}</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A7.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Prompt for Question Answering</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A7.T7.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T7.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.1.1.1">Role</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A7.T7.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.1.1.2.1">
<span class="ltx_p" id="A7.T7.1.1.1.2.1.1" style="width:341.4pt;"><span class="ltx_text ltx_font_bold" id="A7.T7.1.1.1.2.1.1.1">Content</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A7.T7.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T7.1.2.1.1">system</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T7.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.2.1.2.1">
<span class="ltx_p" id="A7.T7.1.2.1.2.1.1" style="width:341.4pt;">You are a Question Answering Portal. Given a question with relevant information sources, your task is to respond to the question using ONLY information from the provided sources. Ensure that the facts included are directly related to answering the question. If the sources do not provide an answer, reply with ”No information is provided in the sources.”</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T7.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T7.1.3.2.1">user</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T7.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.3.2.2.1">
<span class="ltx_p" id="A7.T7.1.3.2.2.1.1" style="width:341.4pt;">Sources: {context}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T7.1.4.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T7.1.4.3.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T7.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.4.3.2.1">
<span class="ltx_p" id="A7.T7.1.4.3.2.1.1" style="width:341.4pt;">Question: {question}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T7.1.5.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T7.1.5.4.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T7.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.5.4.2.1">
<span class="ltx_p" id="A7.T7.1.5.4.2.1.1" style="width:341.4pt;">Generate an answer with at most {max_tokens} tokens.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T7.1.6.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A7.T7.1.6.5.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" id="A7.T7.1.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T7.1.6.5.2.1">
<span class="ltx_p" id="A7.T7.1.6.5.2.1.1" style="width:341.4pt;">Answer:</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A7.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>Prompt for One-Shot Context Summarization <cite class="ltx_cite ltx_citemacro_citep">[Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib28" title="">2024</a>]</cite></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T8.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A7.T8.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T8.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.1.1.1">Role</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A7.T8.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.1.1.2.1">
<span class="ltx_p" id="A7.T8.1.1.1.2.1.1" style="width:341.4pt;"><span class="ltx_text ltx_font_bold" id="A7.T8.1.1.1.2.1.1.1">Content</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A7.T8.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T8.1.2.1.1">system</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T8.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.2.1.2.1">
<span class="ltx_p" id="A7.T8.1.2.1.2.1.1" style="width:341.4pt;">You are a helpful assistant.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T8.1.3.2.1">user</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T8.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.3.2.2.1">
<span class="ltx_p" id="A7.T8.1.3.2.2.1.1" style="width:341.4pt;">Instruction: You will be given a query and a set of documents. Your task is to generate an informative, fluent, and accurate query-focused summary. To do so, you should obtain a query-focused summary step by step.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.1.4.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T8.1.4.3.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T8.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.4.3.2.1">
<span class="ltx_p" id="A7.T8.1.4.3.2.1.1" style="width:341.4pt;">Step 1: Query-Relevant Information Identification</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.1.5.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T8.1.5.4.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T8.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.5.4.2.1">
<span class="ltx_p" id="A7.T8.1.5.4.2.1.1" style="width:341.4pt;">In this step, you will be given a query and a set of documents. Your task is to find and identify query-relevant information from each document. This relevant information can be at any level, such as phrases, sentences, or paragraphs.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.1.6.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T8.1.6.5.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T8.1.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.6.5.2.1">
<span class="ltx_p" id="A7.T8.1.6.5.2.1.1" style="width:341.4pt;">Step 2: Controllable Summarization</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.1.7.6">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T8.1.7.6.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T8.1.7.6.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.7.6.2.1">
<span class="ltx_p" id="A7.T8.1.7.6.2.1.1" style="width:341.4pt;">In this step, you should take the query and query-relevant information obtained from Step 1 as inputs. Your task is to summarize this information. The summary should be concise, include only non-redundant, query-relevant evidence. The output summary must consist of at most {max_tokens} tokens.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.1.8.7">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T8.1.8.7.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T8.1.8.7.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.8.7.2.1">
<span class="ltx_p" id="A7.T8.1.8.7.2.1.1" style="width:341.4pt;">Query: {question}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T8.1.9.8">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A7.T8.1.9.8.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" id="A7.T8.1.9.8.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T8.1.9.8.2.1">
<span class="ltx_p" id="A7.T8.1.9.8.2.1.1" style="width:341.4pt;">Documents: {context}</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A7.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>Prompt for Q2D/PRF Query Expansion</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A7.T9.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A7.T9.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T9.1.1.1.1"><span class="ltx_text ltx_font_bold" id="A7.T9.1.1.1.1.1">Role</span></th>
<th class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_r ltx_border_t" id="A7.T9.1.1.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T9.1.1.1.2.1">
<span class="ltx_p" id="A7.T9.1.1.1.2.1.1" style="width:341.4pt;"><span class="ltx_text ltx_font_bold" id="A7.T9.1.1.1.2.1.1.1">Content</span></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A7.T9.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T9.1.2.1.1">system</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T9.1.2.1.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T9.1.2.1.2.1">
<span class="ltx_p" id="A7.T9.1.2.1.2.1.1" style="width:341.4pt;">You are a helpful assistant.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T9.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="A7.T9.1.3.2.1">user</th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="A7.T9.1.3.2.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T9.1.3.2.2.1">
<span class="ltx_p" id="A7.T9.1.3.2.2.1.1" style="width:341.4pt;">Write a list of keywords for the given question based on the following context. Use at most {max_tokens} tokens:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T9.1.4.3">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T9.1.4.3.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T9.1.4.3.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T9.1.4.3.2.1">
<span class="ltx_p" id="A7.T9.1.4.3.2.1.1" style="width:341.4pt;">Sources: {context}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T9.1.5.4">
<th class="ltx_td ltx_th ltx_th_row ltx_border_l ltx_border_r" id="A7.T9.1.5.4.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="A7.T9.1.5.4.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T9.1.5.4.2.1">
<span class="ltx_p" id="A7.T9.1.5.4.2.1.1" style="width:341.4pt;">Question: {question}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A7.T9.1.6.5">
<th class="ltx_td ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" id="A7.T9.1.6.5.1"></th>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" id="A7.T9.1.6.5.2">
<span class="ltx_inline-block ltx_align_top" id="A7.T9.1.6.5.2.1">
<span class="ltx_p" id="A7.T9.1.6.5.2.1.1" style="width:341.4pt;">Keywords:</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A8">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix H </span>Detailed Experiments</h2>
<section class="ltx_subsection" id="A8.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.1 </span>Computing Resources</h3>
<div class="ltx_para ltx_noindent" id="A8.SS1.p1">
<p class="ltx_p" id="A8.SS1.p1.1">We implement our algorithms in Python 3.10 and run our experiments on a standard laptop with 16GB of RAM and 12th Gen Intel(R) Core(TM) i7-1250U CPU.</p>
</div>
</section>
<section class="ltx_subsection" id="A8.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.2 </span>adRAP Runtime</h3>
<div class="ltx_para ltx_noindent" id="A8.SS2.p1">
<p class="ltx_p" id="A8.SS2.p1.1">We present in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.T10" title="Table 10 ‣ H.2 adRAP Runtime ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">10</span></a> the time taken and the number of summary calls made on each of the QASPER and QuALITY dataset for two different algorithms:</p>
<ul class="ltx_itemize" id="A8.I1">
<li class="ltx_item" id="A8.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A8.I1.i1.p1">
<p class="ltx_p" id="A8.I1.i1.p1.1">Build the full tree on the first 70% of the dataset, then use the adRAP algorithm to add the remaining 30%.</p>
</div>
</li>
<li class="ltx_item" id="A8.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A8.I1.i2.p1">
<p class="ltx_p" id="A8.I1.i2.p1.1">Build the full tree on the first 70% of the dataset, then re-compute the full tree from scratch on the full dataset.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="A8.T10">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>Comparison of time taken and the number of summary calls between building a tree on 70% of the dataset followed by adRAP, and computing the full tree twice: once on 70% of the dataset and again on the entire dataset.</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="A8.T10.1" style="width:433.6pt;height:60.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-61.4pt,8.5pt) scale(0.779228991135847,0.779228991135847) ;">
<table class="ltx_tabular ltx_align_middle" id="A8.T10.1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A8.T10.1.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A8.T10.1.1.1.1.1">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T10.1.1.1.1.2">
<table class="ltx_tabular ltx_align_middle" id="A8.T10.1.1.1.1.2.1">
<tr class="ltx_tr" id="A8.T10.1.1.1.1.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T10.1.1.1.1.2.1.1.1">Time Taken</td>
</tr>
<tr class="ltx_tr" id="A8.T10.1.1.1.1.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T10.1.1.1.1.2.1.2.1">(adRAP Algorithm)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T10.1.1.1.1.3">
<table class="ltx_tabular ltx_align_middle" id="A8.T10.1.1.1.1.3.1">
<tr class="ltx_tr" id="A8.T10.1.1.1.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T10.1.1.1.1.3.1.1.1">Time Taken</td>
</tr>
<tr class="ltx_tr" id="A8.T10.1.1.1.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T10.1.1.1.1.3.1.2.1">(Full Tree Computed Twice)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T10.1.1.1.1.4">
<table class="ltx_tabular ltx_align_middle" id="A8.T10.1.1.1.1.4.1">
<tr class="ltx_tr" id="A8.T10.1.1.1.1.4.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T10.1.1.1.1.4.1.1.1">Summary Calls</td>
</tr>
<tr class="ltx_tr" id="A8.T10.1.1.1.1.4.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T10.1.1.1.1.4.1.2.1">(adRAP Algorithm)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T10.1.1.1.1.5">
<table class="ltx_tabular ltx_align_middle" id="A8.T10.1.1.1.1.5.1">
<tr class="ltx_tr" id="A8.T10.1.1.1.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T10.1.1.1.1.5.1.1.1">Summary Calls</td>
</tr>
<tr class="ltx_tr" id="A8.T10.1.1.1.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T10.1.1.1.1.5.1.2.1">(Full Tree Computed Twice)</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A8.T10.1.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A8.T10.1.1.2.2.1">QASPER</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T10.1.1.2.2.2">638 s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T10.1.1.2.2.3">1,093 s</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T10.1.1.2.2.4">530</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T10.1.1.2.2.5">761</td>
</tr>
<tr class="ltx_tr" id="A8.T10.1.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_b" id="A8.T10.1.1.3.3.1">QuALITY</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T10.1.1.3.3.2">342 s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T10.1.1.3.3.3">524 s</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T10.1.1.3.3.4">372</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T10.1.1.3.3.5">451</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="A8.SS2.p2">
<p class="ltx_p" id="A8.SS2.p2.1">It is clear that using adRAP requires significantly less time and fewer summary calls compared to re-computing the full tree, even when the latter is done only once. If the full tree were to be re-computed each time a new document is added, the difference would become substantially larger.</p>
</div>
</section>
<section class="ltx_subsection" id="A8.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.3 </span>Generating Questions</h3>
<div class="ltx_para ltx_noindent" id="A8.SS3.p1">
<p class="ltx_p" id="A8.SS3.p1.1">To create more challenging questions that require a broader understanding of the dataset, we take the following approach. First, we construct a RAPTOR tree on top of the dataset.
Then, to generate a new question, we sample a node from the tree and prompt a LLM to create a question based on the text from that node. We provide the LLM a few high quality questions to improve its output. The key idea is that some RAPTOR nodes contain summaries of various chunks, meaning the generated question requires synthesizing and summarizing information from different documents to be answered. The prompt used for generating these questions can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A7.T3" title="Table 3 ‣ Appendix G Prompts ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="A8.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.4 </span>Additional Dataset: <span class="ltx_text ltx_font_italic" id="A8.SS4.1.1">NarrativeQA</span>
</h3>
<div class="ltx_para ltx_noindent" id="A8.SS4.p1">
<p class="ltx_p" id="A8.SS4.p1.1"><span class="ltx_text ltx_font_italic" id="A8.SS4.p1.1.1">NarrativeQA</span> consists of complete stories and questions designed to assess a deep, comprehensive understanding of the narratives <cite class="ltx_cite ltx_citemacro_citep">[Kočiský et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#bib.bib10" title="">2017</a>]</cite>. From this dataset, we select the first 300 questions along with their corresponding documents.</p>
</div>
<div class="ltx_para ltx_noindent" id="A8.SS4.p2">
<p class="ltx_p" id="A8.SS4.p2.1">Figures <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.F15" title="Figure 15 ‣ H.4 Additional Dataset: NarrativeQA ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">15</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.F16" title="Figure 16 ‣ H.4 Additional Dataset: NarrativeQA ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">16</span></a> show that, on the NarrativeQA dataset, adRAP performs comparably to RAPTOR and Greedy adRAP, while consistently outperforming Naïve RAG.</p>
</div>
<div class="ltx_para ltx_noindent" id="A8.SS4.p3">
<p class="ltx_p" id="A8.SS4.p3.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.F17" title="Figure 17 ‣ H.4 Additional Dataset: NarrativeQA ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">17</span></a> demonstrates that query-focused algorithms clearly outperform the baselines on the NarrativeQA dataset.
Notably, postQFRAP and one-shot summarization achieve comparable results.
However, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.F18" title="Figure 18 ‣ H.4 Additional Dataset: NarrativeQA ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">18</span></a>, postQFRAP continues to significantly outperform all other algorithms in terms of comprehensiveness, diversity, and empowerment of the generated answers.</p>
</div>
<figure class="ltx_figure" id="A8.F15"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="310" id="A8.F15.g1" src="x22.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span>Evaluation of adRAP (Section <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#S4.SS4" title="4.4 adRAP Algorithm ‣ 4 adRAP: Adaptive Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">4.4</span></a>) vs other algorithms on NarrativeQA.</figcaption>
</figure>
<figure class="ltx_figure" id="A8.F16"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="102" id="A8.F16.g1" src="x23.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span>Percentage of Wins, Ties and Losses for adRAP vs other algorithms on NarrativeQA.</figcaption>
</figure>
<figure class="ltx_figure" id="A8.F17"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="310" id="A8.F17.g1" src="x24.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Evaluation of postQFRAP (Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#alg3" title="Algorithm 3 ‣ 5.2 postQFRAP Algorithm ‣ 5 postQFRAP: post-retrieval Query-Focused Recursive-Abstractive Processing ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">3</span></a>) vs other algorithms on NarrativeQA.</figcaption>
</figure>
<figure class="ltx_figure" id="A8.F18"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="159" id="A8.F18.g1" src="x25.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 18: </span>Percentage of Wins, Ties and Losses for postQFRAP vs other algorithms on NarrativeQA.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_subsection" id="A8.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.5 </span>Dataset Preprocessing</h3>
<div class="ltx_para ltx_noindent" id="A8.SS5.p1">
<p class="ltx_p" id="A8.SS5.p1.1">For datasets with HTML symbols (NarrativeQA and QuALITY), we use the BeautifulSoup <span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" title="">https://www.crummy.com/software/BeautifulSoup/bs4/doc/</a></span></span></span> library to convert them to text.
For all datasets, we standardize the formatting by cleaning new lines, ensuring that only two new lines separate different paragraphs.</p>
</div>
</section>
<section class="ltx_subsection" id="A8.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">H.6 </span>Datasets Statistics</h3>
<div class="ltx_para ltx_noindent" id="A8.SS6.p1">
<p class="ltx_p" id="A8.SS6.p1.2">In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.T11" title="Table 11 ‣ H.6 Datasets Statistics ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">11</span></a>, we present the sizes of the datasets used in our experiments.
In Table <a class="ltx_ref" href="https://arxiv.org/html/2410.01736v1#A8.T12" title="Table 12 ‣ H.6 Datasets Statistics ‣ Appendix H Detailed Experiments ‣ Recursive Abstractive Processing for Retrieval in Dynamic Datasets"><span class="ltx_text ltx_ref_tag">12</span></a>, we present various statistics regarding the recursive-abstractive trees constructed from our datasets. The number of internal nodes is approximately <math alttext="n/6" class="ltx_Math" display="inline" id="A8.SS6.p1.1.m1.1"><semantics id="A8.SS6.p1.1.m1.1a"><mrow id="A8.SS6.p1.1.m1.1.1" xref="A8.SS6.p1.1.m1.1.1.cmml"><mi id="A8.SS6.p1.1.m1.1.1.2" xref="A8.SS6.p1.1.m1.1.1.2.cmml">n</mi><mo id="A8.SS6.p1.1.m1.1.1.1" xref="A8.SS6.p1.1.m1.1.1.1.cmml">/</mo><mn id="A8.SS6.p1.1.m1.1.1.3" xref="A8.SS6.p1.1.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.SS6.p1.1.m1.1b"><apply id="A8.SS6.p1.1.m1.1.1.cmml" xref="A8.SS6.p1.1.m1.1.1"><divide id="A8.SS6.p1.1.m1.1.1.1.cmml" xref="A8.SS6.p1.1.m1.1.1.1"></divide><ci id="A8.SS6.p1.1.m1.1.1.2.cmml" xref="A8.SS6.p1.1.m1.1.1.2">𝑛</ci><cn id="A8.SS6.p1.1.m1.1.1.3.cmml" type="integer" xref="A8.SS6.p1.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.SS6.p1.1.m1.1c">n/6</annotation><annotation encoding="application/x-llamapun" id="A8.SS6.p1.1.m1.1d">italic_n / 6</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="A8.SS6.p1.2.m2.1"><semantics id="A8.SS6.p1.2.m2.1a"><mi id="A8.SS6.p1.2.m2.1.1" xref="A8.SS6.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="A8.SS6.p1.2.m2.1b"><ci id="A8.SS6.p1.2.m2.1.1.cmml" xref="A8.SS6.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="A8.SS6.p1.2.m2.1c">n</annotation><annotation encoding="application/x-llamapun" id="A8.SS6.p1.2.m2.1d">italic_n</annotation></semantics></math> represents the total number of chunks in the dataset. Additionally, most cluster sizes range between 4 and 15, with nodes rarely belonging to more than one cluster.</p>
</div>
<figure class="ltx_table" id="A8.T11">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A8.T11.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A8.T11.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A8.T11.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A8.T11.1.1.1.2">Number of Tokens</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t" id="A8.T11.1.1.1.3">Number of Questions</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A8.T11.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A8.T11.1.2.1.1">MultiHop</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T11.1.2.1.2">1,394,859</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T11.1.2.1.3">230</td>
</tr>
<tr class="ltx_tr" id="A8.T11.1.3.2">
<td class="ltx_td ltx_align_left" id="A8.T11.1.3.2.1">NarrativeQA</td>
<td class="ltx_td ltx_align_center" id="A8.T11.1.3.2.2">939,474</td>
<td class="ltx_td ltx_align_center" id="A8.T11.1.3.2.3">300</td>
</tr>
<tr class="ltx_tr" id="A8.T11.1.4.3">
<td class="ltx_td ltx_align_left" id="A8.T11.1.4.3.1">QASPER</td>
<td class="ltx_td ltx_align_center" id="A8.T11.1.4.3.2">364,610</td>
<td class="ltx_td ltx_align_center" id="A8.T11.1.4.3.3">300</td>
</tr>
<tr class="ltx_tr" id="A8.T11.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_b" id="A8.T11.1.5.4.1">QuALITY</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T11.1.5.4.2">254,297</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T11.1.5.4.3">300</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 11: </span>Sizes of the used datasets</figcaption>
</figure>
<figure class="ltx_table" id="A8.T12">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A8.T12.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A8.T12.8.9.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A8.T12.8.9.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="A8.T12.8.9.1.2">Number of Leaves</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A8.T12.8.9.1.3">
<table class="ltx_tabular ltx_align_middle" id="A8.T12.8.9.1.3.1">
<tr class="ltx_tr" id="A8.T12.8.9.1.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T12.8.9.1.3.1.1.1">Number of Internal</td>
</tr>
<tr class="ltx_tr" id="A8.T12.8.9.1.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T12.8.9.1.3.1.2.1">Nodes</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A8.T12.8.9.1.4">Cluster Size</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A8.T12.8.9.1.5">
<table class="ltx_tabular ltx_align_middle" id="A8.T12.8.9.1.5.1">
<tr class="ltx_tr" id="A8.T12.8.9.1.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T12.8.9.1.5.1.1.1">Number of parents</td>
</tr>
<tr class="ltx_tr" id="A8.T12.8.9.1.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A8.T12.8.9.1.5.1.2.1">per leaf</td>
</tr>
</table>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A8.T12.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A8.T12.2.2.3">MultiHop</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="A8.T12.2.2.4">6,489</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T12.2.2.5">935</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T12.1.1.1"><math alttext="7.96\pm 4.85" class="ltx_Math" display="inline" id="A8.T12.1.1.1.m1.1"><semantics id="A8.T12.1.1.1.m1.1a"><mrow id="A8.T12.1.1.1.m1.1.1" xref="A8.T12.1.1.1.m1.1.1.cmml"><mn id="A8.T12.1.1.1.m1.1.1.2" xref="A8.T12.1.1.1.m1.1.1.2.cmml">7.96</mn><mo id="A8.T12.1.1.1.m1.1.1.1" xref="A8.T12.1.1.1.m1.1.1.1.cmml">±</mo><mn id="A8.T12.1.1.1.m1.1.1.3" xref="A8.T12.1.1.1.m1.1.1.3.cmml">4.85</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.T12.1.1.1.m1.1b"><apply id="A8.T12.1.1.1.m1.1.1.cmml" xref="A8.T12.1.1.1.m1.1.1"><csymbol cd="latexml" id="A8.T12.1.1.1.m1.1.1.1.cmml" xref="A8.T12.1.1.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A8.T12.1.1.1.m1.1.1.2.cmml" type="float" xref="A8.T12.1.1.1.m1.1.1.2">7.96</cn><cn id="A8.T12.1.1.1.m1.1.1.3.cmml" type="float" xref="A8.T12.1.1.1.m1.1.1.3">4.85</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T12.1.1.1.m1.1c">7.96\pm 4.85</annotation><annotation encoding="application/x-llamapun" id="A8.T12.1.1.1.m1.1d">7.96 ± 4.85</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A8.T12.2.2.2"><math alttext="1.004\pm 0.063" class="ltx_Math" display="inline" id="A8.T12.2.2.2.m1.1"><semantics id="A8.T12.2.2.2.m1.1a"><mrow id="A8.T12.2.2.2.m1.1.1" xref="A8.T12.2.2.2.m1.1.1.cmml"><mn id="A8.T12.2.2.2.m1.1.1.2" xref="A8.T12.2.2.2.m1.1.1.2.cmml">1.004</mn><mo id="A8.T12.2.2.2.m1.1.1.1" xref="A8.T12.2.2.2.m1.1.1.1.cmml">±</mo><mn id="A8.T12.2.2.2.m1.1.1.3" xref="A8.T12.2.2.2.m1.1.1.3.cmml">0.063</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.T12.2.2.2.m1.1b"><apply id="A8.T12.2.2.2.m1.1.1.cmml" xref="A8.T12.2.2.2.m1.1.1"><csymbol cd="latexml" id="A8.T12.2.2.2.m1.1.1.1.cmml" xref="A8.T12.2.2.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A8.T12.2.2.2.m1.1.1.2.cmml" type="float" xref="A8.T12.2.2.2.m1.1.1.2">1.004</cn><cn id="A8.T12.2.2.2.m1.1.1.3.cmml" type="float" xref="A8.T12.2.2.2.m1.1.1.3">0.063</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T12.2.2.2.m1.1c">1.004\pm 0.063</annotation><annotation encoding="application/x-llamapun" id="A8.T12.2.2.2.m1.1d">1.004 ± 0.063</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A8.T12.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A8.T12.4.4.3">NarrativeQA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A8.T12.4.4.4">4,083</th>
<td class="ltx_td ltx_align_center" id="A8.T12.4.4.5">499</td>
<td class="ltx_td ltx_align_center" id="A8.T12.3.3.1"><math alttext="9.45\pm 5.81" class="ltx_Math" display="inline" id="A8.T12.3.3.1.m1.1"><semantics id="A8.T12.3.3.1.m1.1a"><mrow id="A8.T12.3.3.1.m1.1.1" xref="A8.T12.3.3.1.m1.1.1.cmml"><mn id="A8.T12.3.3.1.m1.1.1.2" xref="A8.T12.3.3.1.m1.1.1.2.cmml">9.45</mn><mo id="A8.T12.3.3.1.m1.1.1.1" xref="A8.T12.3.3.1.m1.1.1.1.cmml">±</mo><mn id="A8.T12.3.3.1.m1.1.1.3" xref="A8.T12.3.3.1.m1.1.1.3.cmml">5.81</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.T12.3.3.1.m1.1b"><apply id="A8.T12.3.3.1.m1.1.1.cmml" xref="A8.T12.3.3.1.m1.1.1"><csymbol cd="latexml" id="A8.T12.3.3.1.m1.1.1.1.cmml" xref="A8.T12.3.3.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A8.T12.3.3.1.m1.1.1.2.cmml" type="float" xref="A8.T12.3.3.1.m1.1.1.2">9.45</cn><cn id="A8.T12.3.3.1.m1.1.1.3.cmml" type="float" xref="A8.T12.3.3.1.m1.1.1.3">5.81</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T12.3.3.1.m1.1c">9.45\pm 5.81</annotation><annotation encoding="application/x-llamapun" id="A8.T12.3.3.1.m1.1d">9.45 ± 5.81</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A8.T12.4.4.2"><math alttext="1.034\pm 0.18" class="ltx_Math" display="inline" id="A8.T12.4.4.2.m1.1"><semantics id="A8.T12.4.4.2.m1.1a"><mrow id="A8.T12.4.4.2.m1.1.1" xref="A8.T12.4.4.2.m1.1.1.cmml"><mn id="A8.T12.4.4.2.m1.1.1.2" xref="A8.T12.4.4.2.m1.1.1.2.cmml">1.034</mn><mo id="A8.T12.4.4.2.m1.1.1.1" xref="A8.T12.4.4.2.m1.1.1.1.cmml">±</mo><mn id="A8.T12.4.4.2.m1.1.1.3" xref="A8.T12.4.4.2.m1.1.1.3.cmml">0.18</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.T12.4.4.2.m1.1b"><apply id="A8.T12.4.4.2.m1.1.1.cmml" xref="A8.T12.4.4.2.m1.1.1"><csymbol cd="latexml" id="A8.T12.4.4.2.m1.1.1.1.cmml" xref="A8.T12.4.4.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A8.T12.4.4.2.m1.1.1.2.cmml" type="float" xref="A8.T12.4.4.2.m1.1.1.2">1.034</cn><cn id="A8.T12.4.4.2.m1.1.1.3.cmml" type="float" xref="A8.T12.4.4.2.m1.1.1.3">0.18</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T12.4.4.2.m1.1c">1.034\pm 0.18</annotation><annotation encoding="application/x-llamapun" id="A8.T12.4.4.2.m1.1d">1.034 ± 0.18</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A8.T12.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A8.T12.6.6.3">QASPER</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="A8.T12.6.6.4">2,072</th>
<td class="ltx_td ltx_align_center" id="A8.T12.6.6.5">462</td>
<td class="ltx_td ltx_align_center" id="A8.T12.5.5.1"><math alttext="5.487\pm 1.96" class="ltx_Math" display="inline" id="A8.T12.5.5.1.m1.1"><semantics id="A8.T12.5.5.1.m1.1a"><mrow id="A8.T12.5.5.1.m1.1.1" xref="A8.T12.5.5.1.m1.1.1.cmml"><mn id="A8.T12.5.5.1.m1.1.1.2" xref="A8.T12.5.5.1.m1.1.1.2.cmml">5.487</mn><mo id="A8.T12.5.5.1.m1.1.1.1" xref="A8.T12.5.5.1.m1.1.1.1.cmml">±</mo><mn id="A8.T12.5.5.1.m1.1.1.3" xref="A8.T12.5.5.1.m1.1.1.3.cmml">1.96</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.T12.5.5.1.m1.1b"><apply id="A8.T12.5.5.1.m1.1.1.cmml" xref="A8.T12.5.5.1.m1.1.1"><csymbol cd="latexml" id="A8.T12.5.5.1.m1.1.1.1.cmml" xref="A8.T12.5.5.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A8.T12.5.5.1.m1.1.1.2.cmml" type="float" xref="A8.T12.5.5.1.m1.1.1.2">5.487</cn><cn id="A8.T12.5.5.1.m1.1.1.3.cmml" type="float" xref="A8.T12.5.5.1.m1.1.1.3">1.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T12.5.5.1.m1.1c">5.487\pm 1.96</annotation><annotation encoding="application/x-llamapun" id="A8.T12.5.5.1.m1.1d">5.487 ± 1.96</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="A8.T12.6.6.2"><math alttext="1.002\pm 0.044" class="ltx_Math" display="inline" id="A8.T12.6.6.2.m1.1"><semantics id="A8.T12.6.6.2.m1.1a"><mrow id="A8.T12.6.6.2.m1.1.1" xref="A8.T12.6.6.2.m1.1.1.cmml"><mn id="A8.T12.6.6.2.m1.1.1.2" xref="A8.T12.6.6.2.m1.1.1.2.cmml">1.002</mn><mo id="A8.T12.6.6.2.m1.1.1.1" xref="A8.T12.6.6.2.m1.1.1.1.cmml">±</mo><mn id="A8.T12.6.6.2.m1.1.1.3" xref="A8.T12.6.6.2.m1.1.1.3.cmml">0.044</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.T12.6.6.2.m1.1b"><apply id="A8.T12.6.6.2.m1.1.1.cmml" xref="A8.T12.6.6.2.m1.1.1"><csymbol cd="latexml" id="A8.T12.6.6.2.m1.1.1.1.cmml" xref="A8.T12.6.6.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A8.T12.6.6.2.m1.1.1.2.cmml" type="float" xref="A8.T12.6.6.2.m1.1.1.2">1.002</cn><cn id="A8.T12.6.6.2.m1.1.1.3.cmml" type="float" xref="A8.T12.6.6.2.m1.1.1.3">0.044</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T12.6.6.2.m1.1c">1.002\pm 0.044</annotation><annotation encoding="application/x-llamapun" id="A8.T12.6.6.2.m1.1d">1.002 ± 0.044</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="A8.T12.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" id="A8.T12.8.8.3">QuALITY</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" id="A8.T12.8.8.4">1,064</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T12.8.8.5">250</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T12.7.7.1"><math alttext="5.24\pm 2.11" class="ltx_Math" display="inline" id="A8.T12.7.7.1.m1.1"><semantics id="A8.T12.7.7.1.m1.1a"><mrow id="A8.T12.7.7.1.m1.1.1" xref="A8.T12.7.7.1.m1.1.1.cmml"><mn id="A8.T12.7.7.1.m1.1.1.2" xref="A8.T12.7.7.1.m1.1.1.2.cmml">5.24</mn><mo id="A8.T12.7.7.1.m1.1.1.1" xref="A8.T12.7.7.1.m1.1.1.1.cmml">±</mo><mn id="A8.T12.7.7.1.m1.1.1.3" xref="A8.T12.7.7.1.m1.1.1.3.cmml">2.11</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.T12.7.7.1.m1.1b"><apply id="A8.T12.7.7.1.m1.1.1.cmml" xref="A8.T12.7.7.1.m1.1.1"><csymbol cd="latexml" id="A8.T12.7.7.1.m1.1.1.1.cmml" xref="A8.T12.7.7.1.m1.1.1.1">plus-or-minus</csymbol><cn id="A8.T12.7.7.1.m1.1.1.2.cmml" type="float" xref="A8.T12.7.7.1.m1.1.1.2">5.24</cn><cn id="A8.T12.7.7.1.m1.1.1.3.cmml" type="float" xref="A8.T12.7.7.1.m1.1.1.3">2.11</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T12.7.7.1.m1.1c">5.24\pm 2.11</annotation><annotation encoding="application/x-llamapun" id="A8.T12.7.7.1.m1.1d">5.24 ± 2.11</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="A8.T12.8.8.2"><math alttext="1.0\pm 0.0" class="ltx_Math" display="inline" id="A8.T12.8.8.2.m1.1"><semantics id="A8.T12.8.8.2.m1.1a"><mrow id="A8.T12.8.8.2.m1.1.1" xref="A8.T12.8.8.2.m1.1.1.cmml"><mn id="A8.T12.8.8.2.m1.1.1.2" xref="A8.T12.8.8.2.m1.1.1.2.cmml">1.0</mn><mo id="A8.T12.8.8.2.m1.1.1.1" xref="A8.T12.8.8.2.m1.1.1.1.cmml">±</mo><mn id="A8.T12.8.8.2.m1.1.1.3" xref="A8.T12.8.8.2.m1.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="A8.T12.8.8.2.m1.1b"><apply id="A8.T12.8.8.2.m1.1.1.cmml" xref="A8.T12.8.8.2.m1.1.1"><csymbol cd="latexml" id="A8.T12.8.8.2.m1.1.1.1.cmml" xref="A8.T12.8.8.2.m1.1.1.1">plus-or-minus</csymbol><cn id="A8.T12.8.8.2.m1.1.1.2.cmml" type="float" xref="A8.T12.8.8.2.m1.1.1.2">1.0</cn><cn id="A8.T12.8.8.2.m1.1.1.3.cmml" type="float" xref="A8.T12.8.8.2.m1.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.T12.8.8.2.m1.1c">1.0\pm 0.0</annotation><annotation encoding="application/x-llamapun" id="A8.T12.8.8.2.m1.1d">1.0 ± 0.0</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 12: </span>Statistics of the different recursive-abstractive trees we construct on the datasets</figcaption>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  2 16:46:07 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
