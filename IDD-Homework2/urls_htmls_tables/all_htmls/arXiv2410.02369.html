<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation</title>
<!--Generated on Fri Oct  4 07:55:24 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.02369v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S1" title="In Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S2" title="In Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S3" title="In Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4" title="In Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS1" title="In 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Interaction between query and support images</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS2" title="In 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Injection of support mask information</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS3" title="In 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Supervision from query mask</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS4" title="In 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Exploration of generation process</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S5" title="In Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S5.SS1" title="In 5 Experiment ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>In-context setting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S5.SS2" title="In 5 Experiment ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Strict few-shot setting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S5.SS3" title="In 5 Experiment ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Visualization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S6" title="In Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1" title="In Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS1" title="In Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS2" title="In Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>More details on generation process</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS3" title="In Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Cross-attention tokenized interaction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS4" title="In Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Post processing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS5" title="In Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.5 </span>More ablation studies</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS6" title="In Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.6 </span>1-shot to n-shot</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS7" title="In Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.7 </span>Other visualization</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Muzhi Zhu<sup class="ltx_sup" id="id11.11.id1"><span class="ltx_text ltx_font_italic" id="id11.11.id1.1">1∗</span></sup>     Yang Liu<sup class="ltx_sup" id="id12.12.id2">1</sup>
    Zekai Luo<sup class="ltx_sup" id="id13.13.id3"><span class="ltx_text ltx_font_italic" id="id13.13.id3.1">1∗</span></sup>     Chenchen Jing<sup class="ltx_sup" id="id14.14.id4">1</sup>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id8.8.4">Hao Chen<sup class="ltx_sup" id="id8.8.4.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id8.8.4.1.1">1∗</span></sup>     Guangkai Xu<sup class="ltx_sup" id="id8.8.4.2"><span class="ltx_text ltx_font_medium" id="id8.8.4.2.1">1</span></sup>
    Xinlong Wang<sup class="ltx_sup" id="id8.8.4.3"><span class="ltx_text ltx_font_medium" id="id8.8.4.3.1">2</span></sup>     Chunhua Shen<sup class="ltx_sup" id="id8.8.4.4"><span class="ltx_text ltx_font_medium" id="id8.8.4.4.1">1</span></sup></span>
<br class="ltx_break"/>
<sup class="ltx_sup" id="id15.15.id5">1</sup>Zhejiang University        <sup class="ltx_sup" id="id16.16.id6">2</sup>Beijing Academy of Artificial Intelligence
</span><span class="ltx_author_notes">MZ, YL and ZL contributed eqaully. HC is the corresponding author.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id17.id1">The Diffusion Model has not only garnered noteworthy achievements in the realm of image generation
but has also demonstrated its potential as an effective pretraining method utilizing unlabeled data.
Drawing from the extensive potential unveiled by the Diffusion Model in both semantic correspondence and open vocabulary segmentation, our work initiates an investigation into employing the Latent Diffusion Model for Few-shot Semantic Segmentation.
Recently, inspired by the in-context learning ability of large language models, Few-shot Semantic Segmentation has evolved into In-context Segmentation tasks, morphing into a crucial element in assessing generalist segmentation models.
In this context, we concentrate
on Few-shot Semantic Segmentation,
establishing a solid foundation for the future development of a Diffusion-based generalist model for segmentation. Our initial focus lies in understanding how to facilitate interaction between the query image and the support image, resulting in the proposal of a KV fusion method within the self-attention framework.
Subsequently, we delve deeper into optimizing the infusion of information from the support mask and simultaneously re-evaluating how to provide reasonable supervision from the query mask.
Based on our analysis, we establish a simple and effective framework named DiffewS, maximally retaining the original Latent Diffusion Model’s generative framework and effectively utilizing the pre-training prior. Experimental results demonstrate that our method significantly outperforms the previous SOTA models in multiple settings.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The Diffusion Model (DM) has demonstrated powerful capabilities in multiple visual generation tasks, including image generation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib2" title="">2</a>]</cite>, image editing <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib4" title="">4</a>]</cite>, video generation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib7" title="">7</a>]</cite>, etc.
At the same time, DM has also been proven to be a powerful method for self-supervised pre-training <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib9" title="">9</a>]</cite> employing unlabelled data. To exploit the representation ability of DM, there are currently two emerging topics in vision research: improving the learning paradigm <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib11" title="">11</a>]</cite> and downstream task adaptation<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib14" title="">14</a>]</cite>.
The latter often focuses on the Latent Diffusion Model <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib2" title="">2</a>]</cite> (LDM). By compressing images into latent space, it significantly decreases computational expenses and emerges as the first open-source Text-to-Image Diffusion Model scaled up to the LAION-5B <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib15" title="">15</a>]</cite> level. For example, ODISE <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib16" title="">16</a>]</cite>,DVP <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib12" title="">12</a>]</cite>, DatasetDM <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib17" title="">17</a>]</cite> adapt LDM to multiple tasks such as depth estimation, semantic segmentation, but they all require training additional decoder heads, which increases training costs and may undermine the generalization ability and generation quality. Therefore, some works <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib14" title="">14</a>]</cite> have emerged that attempt to repurpose the Diffusion Model’s generative framework and apply it to visual perception tasks without adding extra decoder heads.
Nonetheless, these paradigms still cannot uniformly adapt to all tasks.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Let’s reconsider the most fundamental question in using generative models for visual perception: <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">how to design a fine-tuning framework that can guarantee both generalization ability and precise prediction of details?</span> Unfortunately, existing methods do not sufficiently address this challenge.
The demands of the FSS task for open-set generalization and high-quality segmentation results precisely align with this challenge. Thus, <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">our first motivation</span> is to further address the fundamental question posed above by exploring the Diffusion Model on the FSS task.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">FSS aims to segment query images given support samples.
Traditional FSS methods<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib20" title="">20</a>]</cite> rely on a pre-trained backbone, achieving semantic matching and pixel-level prediction tasks through designing complex modules and long-term training.
Recently, with the emergence of SAM <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib21" title="">21</a>]</cite>, some works are based on foundation models to complete FSS, such as Matcher <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib22" title="">22</a>]</cite>. It employs DINO<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib23" title="">23</a>]</cite> for semantic matching and SAM for segmentation. Similarly, other works <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib25" title="">25</a>]</cite> combine SAM with CLIP or MLLM to complete other open-set segmentation tasks. The current methods deal with matching(semantic) and segmentation as two distinct tasks through different modules. The Diffusion Model itself, however, exhibits significant potential in fine-grained pixel prediction tasks<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib16" title="">16</a>]</cite> and semantic correspondence tasks <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib28" title="">28</a>]</cite>.
Hence, we seek to maximize the reuse of the generative framework by taking advantage of the innate priors within the Diffusion Model to accomplish the FSS task.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Recently, inspired by the in-context learning ability of large language models, Few-shot Semantic Segmentation has further evolved into the In-context Segmentation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib30" title="">30</a>]</cite> task (see <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S2" title="2 Related Work ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">2</span></a>).
In-context Segmentation requires the model to have in-context learning ability for few-shot samples, posing new challenges to model’s generalization capabilities. Consequently, it’s now recognized as a crucial component in the evaluation process for generalist segmentation models. Therefore, <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">the second motivation</span> of our work is to lay the groundwork for the development of diffusion-based generalist segmentation models.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">As a foundational work of Diffusion-based methods in the FSS field, we strive to achieve optimal performance with a simple and efficient design, while maximally preserving the generative framework of the Latent Diffusion Model. This minimal disruption to the original UNet structure allows us to better make use of pre-trained priors.
We embark on a systematic exploration around the following four questions: 1) How to implement the interaction between the query image and the support image? 2) How to effectively inject information from the support mask? 3) What is a reasonable form of supervision from the query mask? 4) How to design
effective generation process to transfer the pre-trained diffusion models to mask prediction task?
Based on our observations, we ultimately establish the DiffewS framework and validate it in multiple settings, demonstrating the effectiveness of our method.
Our main contributions include:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We systematically study four crucial elements of applying the Diffusion Model to Few-shot Semantic Segmentation. For each of these aspects, we propose several reasonable solutions and validate them through comprehensive experiments.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Building upon our observations, we establish the DiffewS framework, which maximally retains the generative framework and effectively utilizes the pre-training prior. Notably, we introduce the first diffusion-based model dedicated to Few-shot Semantic Segmentation, setting the groundwork for a diffusion-based generalist segmentation model.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We validate the effectiveness of the DiffewS framework under several experimental settings, demonstrating that our method not only achieves a performance comparable with the state-of-the-art (SOTA) model in a strict Few-shot Semantic Segmentation setting, but also significantly outperforms the current SOTA model in an ‘in-context learning’ setting,</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Diffusion models</span> have shown impressive performance on visual generation tasks such as text-based
image generation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib2" title="">2</a>]</cite>, image editing <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib4" title="">4</a>]</cite>, and video generation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib7" title="">7</a>]</cite>.
Recent work explores visual priors of diffusion models for perceptual tasks.
ODISE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib16" title="">16</a>]</cite> uses frozen diffusion models for panoptic segmentation of any category in the wild.
DVP <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib12" title="">12</a>]</cite>, DatasetDM <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib17" title="">17</a>]</cite> adapt LDM to multiple tasks such as depth estimation, and semantic segmentation.
Marigold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>]</cite> fine-tunes diffusion models on synthetic data for affine-invariant monocular depth estimation and achieves impressive performance.
Different from the above methods, we focus on using diffusion models to model the visual correlations of multiple reference images and a target image for few-shot segmentation.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Few-shot semantic segmentation</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib32" title="">32</a>]</cite> aims to segment target objects in an input image given a few annotated support images.
Traditional FSS methods either explore prototype learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib35" title="">35</a>]</cite> of support images to predict query images’ masks or use pixel-level information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib18" title="">18</a>]</cite> to exploit the support information. For example,
some works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib30" title="">30</a>]</cite> demonstrate powerful generalization ability by unifying various segmentation tasks in an in-context learning framework. SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib30" title="">30</a>]</cite> can exactly segment any semantic conception by using one or a few support images, which motivates us to explore the potential of the diffusion model for the FSS task under the in-context setting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib30" title="">30</a>]</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminary</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.9">We first review the Latent Diffusion Model <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib2" title="">2</a>]</cite> used in our paper. It consists of an auto-encoder (VAE) and a UNet. The auto-encoder facilitates a two-way transformation between the RGB image <math alttext="\mathbf{I}\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">𝐈</mi><mo id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.3.2" xref="S3.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.1.m1.1.1.3.3" xref="S3.p1.1.m1.1.1.3.3.cmml"><mi id="S3.p1.1.m1.1.1.3.3.2" xref="S3.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.1.m1.1.1.3.3.3" xref="S3.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.p1.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.p1.1.m1.1.1.3.3.4" xref="S3.p1.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><in id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"></in><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝐈</ci><apply id="S3.p1.1.m1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.p1.1.m1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.p1.1.m1.1.1.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3"><times id="S3.p1.1.m1.1.1.3.3.1.cmml" xref="S3.p1.1.m1.1.1.3.3.1"></times><ci id="S3.p1.1.m1.1.1.3.3.2.cmml" xref="S3.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.p1.1.m1.1.1.3.3.3.cmml" xref="S3.p1.1.m1.1.1.3.3.3">𝑊</ci><cn id="S3.p1.1.m1.1.1.3.3.4.cmml" type="integer" xref="S3.p1.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathbf{I}\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">bold_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and the latent space <math alttext="\mathbf{z}\in\mathbb{R}^{h\times w\times c}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">𝐳</mi><mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml"><mi id="S3.p1.2.m2.1.1.3.2" xref="S3.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.p1.2.m2.1.1.3.3" xref="S3.p1.2.m2.1.1.3.3.cmml"><mi id="S3.p1.2.m2.1.1.3.3.2" xref="S3.p1.2.m2.1.1.3.3.2.cmml">h</mi><mo id="S3.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.2.m2.1.1.3.3.3" xref="S3.p1.2.m2.1.1.3.3.3.cmml">w</mi><mo id="S3.p1.2.m2.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.p1.2.m2.1.1.3.3.4" xref="S3.p1.2.m2.1.1.3.3.4.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><in id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1"></in><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝐳</ci><apply id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.3.1.cmml" xref="S3.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.p1.2.m2.1.1.3.2.cmml" xref="S3.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.p1.2.m2.1.1.3.3.cmml" xref="S3.p1.2.m2.1.1.3.3"><times id="S3.p1.2.m2.1.1.3.3.1.cmml" xref="S3.p1.2.m2.1.1.3.3.1"></times><ci id="S3.p1.2.m2.1.1.3.3.2.cmml" xref="S3.p1.2.m2.1.1.3.3.2">ℎ</ci><ci id="S3.p1.2.m2.1.1.3.3.3.cmml" xref="S3.p1.2.m2.1.1.3.3.3">𝑤</ci><ci id="S3.p1.2.m2.1.1.3.3.4.cmml" xref="S3.p1.2.m2.1.1.3.3.4">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\mathbf{z}\in\mathbb{R}^{h\times w\times c}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">bold_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_h × italic_w × italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>.
Both the forward and backward processes of diffusion are carried out in the latent space, and we denote the noisy latent code at time <math alttext="t" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_t</annotation></semantics></math> as <math alttext="\mathbf{z}^{(t)}=\sqrt{\bar{\alpha}_{t}}\mathbf{z}+\sqrt{1-\bar{\alpha}_{t}}{%
\mathbf{\epsilon}}" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.2" xref="S3.p1.4.m4.1.2.cmml"><msup id="S3.p1.4.m4.1.2.2" xref="S3.p1.4.m4.1.2.2.cmml"><mi id="S3.p1.4.m4.1.2.2.2" xref="S3.p1.4.m4.1.2.2.2.cmml">𝐳</mi><mrow id="S3.p1.4.m4.1.1.1.3" xref="S3.p1.4.m4.1.2.2.cmml"><mo id="S3.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.p1.4.m4.1.2.2.cmml">(</mo><mi id="S3.p1.4.m4.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.cmml">t</mi><mo id="S3.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.p1.4.m4.1.2.2.cmml">)</mo></mrow></msup><mo id="S3.p1.4.m4.1.2.1" xref="S3.p1.4.m4.1.2.1.cmml">=</mo><mrow id="S3.p1.4.m4.1.2.3" xref="S3.p1.4.m4.1.2.3.cmml"><mrow id="S3.p1.4.m4.1.2.3.2" xref="S3.p1.4.m4.1.2.3.2.cmml"><msqrt id="S3.p1.4.m4.1.2.3.2.2" xref="S3.p1.4.m4.1.2.3.2.2.cmml"><msub id="S3.p1.4.m4.1.2.3.2.2.2" xref="S3.p1.4.m4.1.2.3.2.2.2.cmml"><mover accent="true" id="S3.p1.4.m4.1.2.3.2.2.2.2" xref="S3.p1.4.m4.1.2.3.2.2.2.2.cmml"><mi id="S3.p1.4.m4.1.2.3.2.2.2.2.2" xref="S3.p1.4.m4.1.2.3.2.2.2.2.2.cmml">α</mi><mo id="S3.p1.4.m4.1.2.3.2.2.2.2.1" xref="S3.p1.4.m4.1.2.3.2.2.2.2.1.cmml">¯</mo></mover><mi id="S3.p1.4.m4.1.2.3.2.2.2.3" xref="S3.p1.4.m4.1.2.3.2.2.2.3.cmml">t</mi></msub></msqrt><mo id="S3.p1.4.m4.1.2.3.2.1" xref="S3.p1.4.m4.1.2.3.2.1.cmml">⁢</mo><mi id="S3.p1.4.m4.1.2.3.2.3" xref="S3.p1.4.m4.1.2.3.2.3.cmml">𝐳</mi></mrow><mo id="S3.p1.4.m4.1.2.3.1" xref="S3.p1.4.m4.1.2.3.1.cmml">+</mo><mrow id="S3.p1.4.m4.1.2.3.3" xref="S3.p1.4.m4.1.2.3.3.cmml"><msqrt id="S3.p1.4.m4.1.2.3.3.2" xref="S3.p1.4.m4.1.2.3.3.2.cmml"><mrow id="S3.p1.4.m4.1.2.3.3.2.2" xref="S3.p1.4.m4.1.2.3.3.2.2.cmml"><mn id="S3.p1.4.m4.1.2.3.3.2.2.2" xref="S3.p1.4.m4.1.2.3.3.2.2.2.cmml">1</mn><mo id="S3.p1.4.m4.1.2.3.3.2.2.1" xref="S3.p1.4.m4.1.2.3.3.2.2.1.cmml">−</mo><msub id="S3.p1.4.m4.1.2.3.3.2.2.3" xref="S3.p1.4.m4.1.2.3.3.2.2.3.cmml"><mover accent="true" id="S3.p1.4.m4.1.2.3.3.2.2.3.2" xref="S3.p1.4.m4.1.2.3.3.2.2.3.2.cmml"><mi id="S3.p1.4.m4.1.2.3.3.2.2.3.2.2" xref="S3.p1.4.m4.1.2.3.3.2.2.3.2.2.cmml">α</mi><mo id="S3.p1.4.m4.1.2.3.3.2.2.3.2.1" xref="S3.p1.4.m4.1.2.3.3.2.2.3.2.1.cmml">¯</mo></mover><mi id="S3.p1.4.m4.1.2.3.3.2.2.3.3" xref="S3.p1.4.m4.1.2.3.3.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="S3.p1.4.m4.1.2.3.3.1" xref="S3.p1.4.m4.1.2.3.3.1.cmml">⁢</mo><mi id="S3.p1.4.m4.1.2.3.3.3" xref="S3.p1.4.m4.1.2.3.3.3.cmml">ϵ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.2.cmml" xref="S3.p1.4.m4.1.2"><eq id="S3.p1.4.m4.1.2.1.cmml" xref="S3.p1.4.m4.1.2.1"></eq><apply id="S3.p1.4.m4.1.2.2.cmml" xref="S3.p1.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.2.2.1.cmml" xref="S3.p1.4.m4.1.2.2">superscript</csymbol><ci id="S3.p1.4.m4.1.2.2.2.cmml" xref="S3.p1.4.m4.1.2.2.2">𝐳</ci><ci id="S3.p1.4.m4.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1">𝑡</ci></apply><apply id="S3.p1.4.m4.1.2.3.cmml" xref="S3.p1.4.m4.1.2.3"><plus id="S3.p1.4.m4.1.2.3.1.cmml" xref="S3.p1.4.m4.1.2.3.1"></plus><apply id="S3.p1.4.m4.1.2.3.2.cmml" xref="S3.p1.4.m4.1.2.3.2"><times id="S3.p1.4.m4.1.2.3.2.1.cmml" xref="S3.p1.4.m4.1.2.3.2.1"></times><apply id="S3.p1.4.m4.1.2.3.2.2.cmml" xref="S3.p1.4.m4.1.2.3.2.2"><root id="S3.p1.4.m4.1.2.3.2.2a.cmml" xref="S3.p1.4.m4.1.2.3.2.2"></root><apply id="S3.p1.4.m4.1.2.3.2.2.2.cmml" xref="S3.p1.4.m4.1.2.3.2.2.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.2.3.2.2.2.1.cmml" xref="S3.p1.4.m4.1.2.3.2.2.2">subscript</csymbol><apply id="S3.p1.4.m4.1.2.3.2.2.2.2.cmml" xref="S3.p1.4.m4.1.2.3.2.2.2.2"><ci id="S3.p1.4.m4.1.2.3.2.2.2.2.1.cmml" xref="S3.p1.4.m4.1.2.3.2.2.2.2.1">¯</ci><ci id="S3.p1.4.m4.1.2.3.2.2.2.2.2.cmml" xref="S3.p1.4.m4.1.2.3.2.2.2.2.2">𝛼</ci></apply><ci id="S3.p1.4.m4.1.2.3.2.2.2.3.cmml" xref="S3.p1.4.m4.1.2.3.2.2.2.3">𝑡</ci></apply></apply><ci id="S3.p1.4.m4.1.2.3.2.3.cmml" xref="S3.p1.4.m4.1.2.3.2.3">𝐳</ci></apply><apply id="S3.p1.4.m4.1.2.3.3.cmml" xref="S3.p1.4.m4.1.2.3.3"><times id="S3.p1.4.m4.1.2.3.3.1.cmml" xref="S3.p1.4.m4.1.2.3.3.1"></times><apply id="S3.p1.4.m4.1.2.3.3.2.cmml" xref="S3.p1.4.m4.1.2.3.3.2"><root id="S3.p1.4.m4.1.2.3.3.2a.cmml" xref="S3.p1.4.m4.1.2.3.3.2"></root><apply id="S3.p1.4.m4.1.2.3.3.2.2.cmml" xref="S3.p1.4.m4.1.2.3.3.2.2"><minus id="S3.p1.4.m4.1.2.3.3.2.2.1.cmml" xref="S3.p1.4.m4.1.2.3.3.2.2.1"></minus><cn id="S3.p1.4.m4.1.2.3.3.2.2.2.cmml" type="integer" xref="S3.p1.4.m4.1.2.3.3.2.2.2">1</cn><apply id="S3.p1.4.m4.1.2.3.3.2.2.3.cmml" xref="S3.p1.4.m4.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.2.3.3.2.2.3.1.cmml" xref="S3.p1.4.m4.1.2.3.3.2.2.3">subscript</csymbol><apply id="S3.p1.4.m4.1.2.3.3.2.2.3.2.cmml" xref="S3.p1.4.m4.1.2.3.3.2.2.3.2"><ci id="S3.p1.4.m4.1.2.3.3.2.2.3.2.1.cmml" xref="S3.p1.4.m4.1.2.3.3.2.2.3.2.1">¯</ci><ci id="S3.p1.4.m4.1.2.3.3.2.2.3.2.2.cmml" xref="S3.p1.4.m4.1.2.3.3.2.2.3.2.2">𝛼</ci></apply><ci id="S3.p1.4.m4.1.2.3.3.2.2.3.3.cmml" xref="S3.p1.4.m4.1.2.3.3.2.2.3.3">𝑡</ci></apply></apply></apply><ci id="S3.p1.4.m4.1.2.3.3.3.cmml" xref="S3.p1.4.m4.1.2.3.3.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\mathbf{z}^{(t)}=\sqrt{\bar{\alpha}_{t}}\mathbf{z}+\sqrt{1-\bar{\alpha}_{t}}{%
\mathbf{\epsilon}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">bold_z start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT = square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_z + square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_ϵ</annotation></semantics></math>, where <math alttext="\bar{\alpha}_{t}=\prod^{t}_{s=1}(1-\beta_{s})" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><msub id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml"><mover accent="true" id="S3.p1.5.m5.1.1.3.2" xref="S3.p1.5.m5.1.1.3.2.cmml"><mi id="S3.p1.5.m5.1.1.3.2.2" xref="S3.p1.5.m5.1.1.3.2.2.cmml">α</mi><mo id="S3.p1.5.m5.1.1.3.2.1" xref="S3.p1.5.m5.1.1.3.2.1.cmml">¯</mo></mover><mi id="S3.p1.5.m5.1.1.3.3" xref="S3.p1.5.m5.1.1.3.3.cmml">t</mi></msub><mo id="S3.p1.5.m5.1.1.2" rspace="0.111em" xref="S3.p1.5.m5.1.1.2.cmml">=</mo><mrow id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml"><msubsup id="S3.p1.5.m5.1.1.1.2" xref="S3.p1.5.m5.1.1.1.2.cmml"><mo id="S3.p1.5.m5.1.1.1.2.2.2" rspace="0em" xref="S3.p1.5.m5.1.1.1.2.2.2.cmml">∏</mo><mrow id="S3.p1.5.m5.1.1.1.2.3" xref="S3.p1.5.m5.1.1.1.2.3.cmml"><mi id="S3.p1.5.m5.1.1.1.2.3.2" xref="S3.p1.5.m5.1.1.1.2.3.2.cmml">s</mi><mo id="S3.p1.5.m5.1.1.1.2.3.1" xref="S3.p1.5.m5.1.1.1.2.3.1.cmml">=</mo><mn id="S3.p1.5.m5.1.1.1.2.3.3" xref="S3.p1.5.m5.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S3.p1.5.m5.1.1.1.2.2.3" xref="S3.p1.5.m5.1.1.1.2.2.3.cmml">t</mi></msubsup><mrow id="S3.p1.5.m5.1.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="S3.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.5.m5.1.1.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml"><mn id="S3.p1.5.m5.1.1.1.1.1.1.2" xref="S3.p1.5.m5.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.p1.5.m5.1.1.1.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.p1.5.m5.1.1.1.1.1.1.3" xref="S3.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.5.m5.1.1.1.1.1.1.3.2" xref="S3.p1.5.m5.1.1.1.1.1.1.3.2.cmml">β</mi><mi id="S3.p1.5.m5.1.1.1.1.1.1.3.3" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S3.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><eq id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2"></eq><apply id="S3.p1.5.m5.1.1.3.cmml" xref="S3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.3.1.cmml" xref="S3.p1.5.m5.1.1.3">subscript</csymbol><apply id="S3.p1.5.m5.1.1.3.2.cmml" xref="S3.p1.5.m5.1.1.3.2"><ci id="S3.p1.5.m5.1.1.3.2.1.cmml" xref="S3.p1.5.m5.1.1.3.2.1">¯</ci><ci id="S3.p1.5.m5.1.1.3.2.2.cmml" xref="S3.p1.5.m5.1.1.3.2.2">𝛼</ci></apply><ci id="S3.p1.5.m5.1.1.3.3.cmml" xref="S3.p1.5.m5.1.1.3.3">𝑡</ci></apply><apply id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"><apply id="S3.p1.5.m5.1.1.1.2.cmml" xref="S3.p1.5.m5.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.2.1.cmml" xref="S3.p1.5.m5.1.1.1.2">subscript</csymbol><apply id="S3.p1.5.m5.1.1.1.2.2.cmml" xref="S3.p1.5.m5.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.2.2.1.cmml" xref="S3.p1.5.m5.1.1.1.2">superscript</csymbol><csymbol cd="latexml" id="S3.p1.5.m5.1.1.1.2.2.2.cmml" xref="S3.p1.5.m5.1.1.1.2.2.2">product</csymbol><ci id="S3.p1.5.m5.1.1.1.2.2.3.cmml" xref="S3.p1.5.m5.1.1.1.2.2.3">𝑡</ci></apply><apply id="S3.p1.5.m5.1.1.1.2.3.cmml" xref="S3.p1.5.m5.1.1.1.2.3"><eq id="S3.p1.5.m5.1.1.1.2.3.1.cmml" xref="S3.p1.5.m5.1.1.1.2.3.1"></eq><ci id="S3.p1.5.m5.1.1.1.2.3.2.cmml" xref="S3.p1.5.m5.1.1.1.2.3.2">𝑠</ci><cn id="S3.p1.5.m5.1.1.1.2.3.3.cmml" type="integer" xref="S3.p1.5.m5.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1"><minus id="S3.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.1"></minus><cn id="S3.p1.5.m5.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.p1.5.m5.1.1.1.1.1.1.2">1</cn><apply id="S3.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3.2">𝛽</ci><ci id="S3.p1.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\bar{\alpha}_{t}=\prod^{t}_{s=1}(1-\beta_{s})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = ∏ start_POSTSUPERSCRIPT italic_t end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT ( 1 - italic_β start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> is the noise schedule. <math alttext="\beta_{s}" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><msub id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml"><mi id="S3.p1.6.m6.1.1.2" xref="S3.p1.6.m6.1.1.2.cmml">β</mi><mi id="S3.p1.6.m6.1.1.3" xref="S3.p1.6.m6.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><apply id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.p1.6.m6.1.1.2.cmml" xref="S3.p1.6.m6.1.1.2">𝛽</ci><ci id="S3.p1.6.m6.1.1.3.cmml" xref="S3.p1.6.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\beta_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_β start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the variance sampled from a variance schedule <math alttext="{\beta_{t}\in(0,1)}^{T}_{t=1}" class="ltx_Math" display="inline" id="S3.p1.7.m7.2"><semantics id="S3.p1.7.m7.2a"><mrow id="S3.p1.7.m7.2.3" xref="S3.p1.7.m7.2.3.cmml"><msub id="S3.p1.7.m7.2.3.2" xref="S3.p1.7.m7.2.3.2.cmml"><mi id="S3.p1.7.m7.2.3.2.2" xref="S3.p1.7.m7.2.3.2.2.cmml">β</mi><mi id="S3.p1.7.m7.2.3.2.3" xref="S3.p1.7.m7.2.3.2.3.cmml">t</mi></msub><mo id="S3.p1.7.m7.2.3.1" xref="S3.p1.7.m7.2.3.1.cmml">∈</mo><msubsup id="S3.p1.7.m7.2.3.3" xref="S3.p1.7.m7.2.3.3.cmml"><mrow id="S3.p1.7.m7.2.3.3.2.2.2" xref="S3.p1.7.m7.2.3.3.2.2.1.cmml"><mo id="S3.p1.7.m7.2.3.3.2.2.2.1" stretchy="false" xref="S3.p1.7.m7.2.3.3.2.2.1.cmml">(</mo><mn id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">0</mn><mo id="S3.p1.7.m7.2.3.3.2.2.2.2" xref="S3.p1.7.m7.2.3.3.2.2.1.cmml">,</mo><mn id="S3.p1.7.m7.2.2" xref="S3.p1.7.m7.2.2.cmml">1</mn><mo id="S3.p1.7.m7.2.3.3.2.2.2.3" stretchy="false" xref="S3.p1.7.m7.2.3.3.2.2.1.cmml">)</mo></mrow><mrow id="S3.p1.7.m7.2.3.3.3" xref="S3.p1.7.m7.2.3.3.3.cmml"><mi id="S3.p1.7.m7.2.3.3.3.2" xref="S3.p1.7.m7.2.3.3.3.2.cmml">t</mi><mo id="S3.p1.7.m7.2.3.3.3.1" xref="S3.p1.7.m7.2.3.3.3.1.cmml">=</mo><mn id="S3.p1.7.m7.2.3.3.3.3" xref="S3.p1.7.m7.2.3.3.3.3.cmml">1</mn></mrow><mi id="S3.p1.7.m7.2.3.3.2.3" xref="S3.p1.7.m7.2.3.3.2.3.cmml">T</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.2b"><apply id="S3.p1.7.m7.2.3.cmml" xref="S3.p1.7.m7.2.3"><in id="S3.p1.7.m7.2.3.1.cmml" xref="S3.p1.7.m7.2.3.1"></in><apply id="S3.p1.7.m7.2.3.2.cmml" xref="S3.p1.7.m7.2.3.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.2.3.2.1.cmml" xref="S3.p1.7.m7.2.3.2">subscript</csymbol><ci id="S3.p1.7.m7.2.3.2.2.cmml" xref="S3.p1.7.m7.2.3.2.2">𝛽</ci><ci id="S3.p1.7.m7.2.3.2.3.cmml" xref="S3.p1.7.m7.2.3.2.3">𝑡</ci></apply><apply id="S3.p1.7.m7.2.3.3.cmml" xref="S3.p1.7.m7.2.3.3"><csymbol cd="ambiguous" id="S3.p1.7.m7.2.3.3.1.cmml" xref="S3.p1.7.m7.2.3.3">subscript</csymbol><apply id="S3.p1.7.m7.2.3.3.2.cmml" xref="S3.p1.7.m7.2.3.3"><csymbol cd="ambiguous" id="S3.p1.7.m7.2.3.3.2.1.cmml" xref="S3.p1.7.m7.2.3.3">superscript</csymbol><interval closure="open" id="S3.p1.7.m7.2.3.3.2.2.1.cmml" xref="S3.p1.7.m7.2.3.3.2.2.2"><cn id="S3.p1.7.m7.1.1.cmml" type="integer" xref="S3.p1.7.m7.1.1">0</cn><cn id="S3.p1.7.m7.2.2.cmml" type="integer" xref="S3.p1.7.m7.2.2">1</cn></interval><ci id="S3.p1.7.m7.2.3.3.2.3.cmml" xref="S3.p1.7.m7.2.3.3.2.3">𝑇</ci></apply><apply id="S3.p1.7.m7.2.3.3.3.cmml" xref="S3.p1.7.m7.2.3.3.3"><eq id="S3.p1.7.m7.2.3.3.3.1.cmml" xref="S3.p1.7.m7.2.3.3.3.1"></eq><ci id="S3.p1.7.m7.2.3.3.3.2.cmml" xref="S3.p1.7.m7.2.3.3.3.2">𝑡</ci><cn id="S3.p1.7.m7.2.3.3.3.3.cmml" type="integer" xref="S3.p1.7.m7.2.3.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.2c">{\beta_{t}\in(0,1)}^{T}_{t=1}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.2d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ ( 0 , 1 ) start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
The UNet can be considered as a series of equally weighted denoiser <math alttext="\mathbf{\epsilon}_{\theta}(\mathbf{z}^{(t)},t)" class="ltx_Math" display="inline" id="S3.p1.8.m8.3"><semantics id="S3.p1.8.m8.3a"><mrow id="S3.p1.8.m8.3.3" xref="S3.p1.8.m8.3.3.cmml"><msub id="S3.p1.8.m8.3.3.3" xref="S3.p1.8.m8.3.3.3.cmml"><mi id="S3.p1.8.m8.3.3.3.2" xref="S3.p1.8.m8.3.3.3.2.cmml">ϵ</mi><mi id="S3.p1.8.m8.3.3.3.3" xref="S3.p1.8.m8.3.3.3.3.cmml">θ</mi></msub><mo id="S3.p1.8.m8.3.3.2" xref="S3.p1.8.m8.3.3.2.cmml">⁢</mo><mrow id="S3.p1.8.m8.3.3.1.1" xref="S3.p1.8.m8.3.3.1.2.cmml"><mo id="S3.p1.8.m8.3.3.1.1.2" stretchy="false" xref="S3.p1.8.m8.3.3.1.2.cmml">(</mo><msup id="S3.p1.8.m8.3.3.1.1.1" xref="S3.p1.8.m8.3.3.1.1.1.cmml"><mi id="S3.p1.8.m8.3.3.1.1.1.2" xref="S3.p1.8.m8.3.3.1.1.1.2.cmml">𝐳</mi><mrow id="S3.p1.8.m8.1.1.1.3" xref="S3.p1.8.m8.3.3.1.1.1.cmml"><mo id="S3.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S3.p1.8.m8.3.3.1.1.1.cmml">(</mo><mi id="S3.p1.8.m8.1.1.1.1" xref="S3.p1.8.m8.1.1.1.1.cmml">t</mi><mo id="S3.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S3.p1.8.m8.3.3.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.p1.8.m8.3.3.1.1.3" xref="S3.p1.8.m8.3.3.1.2.cmml">,</mo><mi id="S3.p1.8.m8.2.2" xref="S3.p1.8.m8.2.2.cmml">t</mi><mo id="S3.p1.8.m8.3.3.1.1.4" stretchy="false" xref="S3.p1.8.m8.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.3b"><apply id="S3.p1.8.m8.3.3.cmml" xref="S3.p1.8.m8.3.3"><times id="S3.p1.8.m8.3.3.2.cmml" xref="S3.p1.8.m8.3.3.2"></times><apply id="S3.p1.8.m8.3.3.3.cmml" xref="S3.p1.8.m8.3.3.3"><csymbol cd="ambiguous" id="S3.p1.8.m8.3.3.3.1.cmml" xref="S3.p1.8.m8.3.3.3">subscript</csymbol><ci id="S3.p1.8.m8.3.3.3.2.cmml" xref="S3.p1.8.m8.3.3.3.2">italic-ϵ</ci><ci id="S3.p1.8.m8.3.3.3.3.cmml" xref="S3.p1.8.m8.3.3.3.3">𝜃</ci></apply><interval closure="open" id="S3.p1.8.m8.3.3.1.2.cmml" xref="S3.p1.8.m8.3.3.1.1"><apply id="S3.p1.8.m8.3.3.1.1.1.cmml" xref="S3.p1.8.m8.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.3.3.1.1.1.1.cmml" xref="S3.p1.8.m8.3.3.1.1.1">superscript</csymbol><ci id="S3.p1.8.m8.3.3.1.1.1.2.cmml" xref="S3.p1.8.m8.3.3.1.1.1.2">𝐳</ci><ci id="S3.p1.8.m8.1.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1.1">𝑡</ci></apply><ci id="S3.p1.8.m8.2.2.cmml" xref="S3.p1.8.m8.2.2">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.3c">\mathbf{\epsilon}_{\theta}(\mathbf{z}^{(t)},t)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.3d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_z start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT , italic_t )</annotation></semantics></math>.
The training objective <math alttext="\mathcal{L}" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">\mathcal{L}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">caligraphic_L</annotation></semantics></math> can be simplified as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathbb{E}_{\mathbf{z},\mathbf{\epsilon}\sim\mathcal{N}(0,1),t\in%
\mathcal{U}(T)}\left[\left\|\mathbf{\epsilon}-\mathbf{\epsilon}_{\theta}\left(%
\mathbf{z}^{(t)},t\right)\right\|_{2}^{2}\right]" class="ltx_Math" display="block" id="S3.E1.m1.10"><semantics id="S3.E1.m1.10a"><mrow id="S3.E1.m1.10.10" xref="S3.E1.m1.10.10.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.10.10.3" xref="S3.E1.m1.10.10.3.cmml">ℒ</mi><mo id="S3.E1.m1.10.10.2" xref="S3.E1.m1.10.10.2.cmml">=</mo><mrow id="S3.E1.m1.10.10.1" xref="S3.E1.m1.10.10.1.cmml"><msub id="S3.E1.m1.10.10.1.3" xref="S3.E1.m1.10.10.1.3.cmml"><mi id="S3.E1.m1.10.10.1.3.2" xref="S3.E1.m1.10.10.1.3.2.cmml">𝔼</mi><mrow id="S3.E1.m1.7.7.7.7" xref="S3.E1.m1.7.7.7.8.cmml"><mrow id="S3.E1.m1.6.6.6.6.1" xref="S3.E1.m1.6.6.6.6.1.cmml"><mrow id="S3.E1.m1.6.6.6.6.1.2.2" xref="S3.E1.m1.6.6.6.6.1.2.1.cmml"><mi id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">𝐳</mi><mo id="S3.E1.m1.6.6.6.6.1.2.2.1" xref="S3.E1.m1.6.6.6.6.1.2.1.cmml">,</mo><mi id="S3.E1.m1.4.4.4.4" xref="S3.E1.m1.4.4.4.4.cmml">ϵ</mi></mrow><mo id="S3.E1.m1.6.6.6.6.1.1" xref="S3.E1.m1.6.6.6.6.1.1.cmml">∼</mo><mrow id="S3.E1.m1.6.6.6.6.1.3" xref="S3.E1.m1.6.6.6.6.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.6.6.6.6.1.3.2" xref="S3.E1.m1.6.6.6.6.1.3.2.cmml">𝒩</mi><mo id="S3.E1.m1.6.6.6.6.1.3.1" xref="S3.E1.m1.6.6.6.6.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.6.6.1.3.3.2" xref="S3.E1.m1.6.6.6.6.1.3.3.1.cmml"><mo id="S3.E1.m1.6.6.6.6.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.6.6.6.6.1.3.3.1.cmml">(</mo><mn id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">0</mn><mo id="S3.E1.m1.6.6.6.6.1.3.3.2.2" xref="S3.E1.m1.6.6.6.6.1.3.3.1.cmml">,</mo><mn id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">1</mn><mo id="S3.E1.m1.6.6.6.6.1.3.3.2.3" stretchy="false" xref="S3.E1.m1.6.6.6.6.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.7.7.7.7.3" xref="S3.E1.m1.7.7.7.8a.cmml">,</mo><mrow id="S3.E1.m1.7.7.7.7.2" xref="S3.E1.m1.7.7.7.7.2.cmml"><mi id="S3.E1.m1.7.7.7.7.2.2" xref="S3.E1.m1.7.7.7.7.2.2.cmml">t</mi><mo id="S3.E1.m1.7.7.7.7.2.1" xref="S3.E1.m1.7.7.7.7.2.1.cmml">∈</mo><mrow id="S3.E1.m1.7.7.7.7.2.3" xref="S3.E1.m1.7.7.7.7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.7.7.7.7.2.3.2" xref="S3.E1.m1.7.7.7.7.2.3.2.cmml">𝒰</mi><mo id="S3.E1.m1.7.7.7.7.2.3.1" xref="S3.E1.m1.7.7.7.7.2.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.7.7.7.7.2.3.3.2" xref="S3.E1.m1.7.7.7.7.2.3.cmml"><mo id="S3.E1.m1.7.7.7.7.2.3.3.2.1" stretchy="false" xref="S3.E1.m1.7.7.7.7.2.3.cmml">(</mo><mi id="S3.E1.m1.5.5.5.5" xref="S3.E1.m1.5.5.5.5.cmml">T</mi><mo id="S3.E1.m1.7.7.7.7.2.3.3.2.2" stretchy="false" xref="S3.E1.m1.7.7.7.7.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo id="S3.E1.m1.10.10.1.2" xref="S3.E1.m1.10.10.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.10.10.1.1.1" xref="S3.E1.m1.10.10.1.1.2.cmml"><mo id="S3.E1.m1.10.10.1.1.1.2" xref="S3.E1.m1.10.10.1.1.2.1.cmml">[</mo><msubsup id="S3.E1.m1.10.10.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.cmml"><mrow id="S3.E1.m1.10.10.1.1.1.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.1.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.3.cmml">ϵ</mi><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S3.E1.m1.8.8.1.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.8.8.1.3.1" stretchy="false" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E1.m1.8.8.1.1" xref="S3.E1.m1.8.8.1.1.cmml">t</mi><mo id="S3.E1.m1.8.8.1.3.2" stretchy="false" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E1.m1.9.9" xref="S3.E1.m1.9.9.cmml">t</mi><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.10.10.1.1.1.1.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E1.m1.10.10.1.1.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E1.m1.10.10.1.1.1.1.3" xref="S3.E1.m1.10.10.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E1.m1.10.10.1.1.1.3" xref="S3.E1.m1.10.10.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.10b"><apply id="S3.E1.m1.10.10.cmml" xref="S3.E1.m1.10.10"><eq id="S3.E1.m1.10.10.2.cmml" xref="S3.E1.m1.10.10.2"></eq><ci id="S3.E1.m1.10.10.3.cmml" xref="S3.E1.m1.10.10.3">ℒ</ci><apply id="S3.E1.m1.10.10.1.cmml" xref="S3.E1.m1.10.10.1"><times id="S3.E1.m1.10.10.1.2.cmml" xref="S3.E1.m1.10.10.1.2"></times><apply id="S3.E1.m1.10.10.1.3.cmml" xref="S3.E1.m1.10.10.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.3.1.cmml" xref="S3.E1.m1.10.10.1.3">subscript</csymbol><ci id="S3.E1.m1.10.10.1.3.2.cmml" xref="S3.E1.m1.10.10.1.3.2">𝔼</ci><apply id="S3.E1.m1.7.7.7.8.cmml" xref="S3.E1.m1.7.7.7.7"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.7.8a.cmml" xref="S3.E1.m1.7.7.7.7.3">formulae-sequence</csymbol><apply id="S3.E1.m1.6.6.6.6.1.cmml" xref="S3.E1.m1.6.6.6.6.1"><csymbol cd="latexml" id="S3.E1.m1.6.6.6.6.1.1.cmml" xref="S3.E1.m1.6.6.6.6.1.1">similar-to</csymbol><list id="S3.E1.m1.6.6.6.6.1.2.1.cmml" xref="S3.E1.m1.6.6.6.6.1.2.2"><ci id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3">𝐳</ci><ci id="S3.E1.m1.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4">italic-ϵ</ci></list><apply id="S3.E1.m1.6.6.6.6.1.3.cmml" xref="S3.E1.m1.6.6.6.6.1.3"><times id="S3.E1.m1.6.6.6.6.1.3.1.cmml" xref="S3.E1.m1.6.6.6.6.1.3.1"></times><ci id="S3.E1.m1.6.6.6.6.1.3.2.cmml" xref="S3.E1.m1.6.6.6.6.1.3.2">𝒩</ci><interval closure="open" id="S3.E1.m1.6.6.6.6.1.3.3.1.cmml" xref="S3.E1.m1.6.6.6.6.1.3.3.2"><cn id="S3.E1.m1.1.1.1.1.cmml" type="integer" xref="S3.E1.m1.1.1.1.1">0</cn><cn id="S3.E1.m1.2.2.2.2.cmml" type="integer" xref="S3.E1.m1.2.2.2.2">1</cn></interval></apply></apply><apply id="S3.E1.m1.7.7.7.7.2.cmml" xref="S3.E1.m1.7.7.7.7.2"><in id="S3.E1.m1.7.7.7.7.2.1.cmml" xref="S3.E1.m1.7.7.7.7.2.1"></in><ci id="S3.E1.m1.7.7.7.7.2.2.cmml" xref="S3.E1.m1.7.7.7.7.2.2">𝑡</ci><apply id="S3.E1.m1.7.7.7.7.2.3.cmml" xref="S3.E1.m1.7.7.7.7.2.3"><times id="S3.E1.m1.7.7.7.7.2.3.1.cmml" xref="S3.E1.m1.7.7.7.7.2.3.1"></times><ci id="S3.E1.m1.7.7.7.7.2.3.2.cmml" xref="S3.E1.m1.7.7.7.7.2.3.2">𝒰</ci><ci id="S3.E1.m1.5.5.5.5.cmml" xref="S3.E1.m1.5.5.5.5">𝑇</ci></apply></apply></apply></apply><apply id="S3.E1.m1.10.10.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.10.10.1.1.2.1.cmml" xref="S3.E1.m1.10.10.1.1.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.10.10.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.10.10.1.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.2"></minus><ci id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.3">italic-ϵ</ci><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1"><times id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.2">italic-ϵ</ci><ci id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E1.m1.8.8.1.1.cmml" xref="S3.E1.m1.8.8.1.1">𝑡</ci></apply><ci id="S3.E1.m1.9.9.cmml" xref="S3.E1.m1.9.9">𝑡</ci></interval></apply></apply></apply><cn id="S3.E1.m1.10.10.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.10.10.1.1.1.1.1.3">2</cn></apply><cn id="S3.E1.m1.10.10.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.10.10.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.10c">\mathcal{L}=\mathbb{E}_{\mathbf{z},\mathbf{\epsilon}\sim\mathcal{N}(0,1),t\in%
\mathcal{U}(T)}\left[\left\|\mathbf{\epsilon}-\mathbf{\epsilon}_{\theta}\left(%
\mathbf{z}^{(t)},t\right)\right\|_{2}^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.10d">caligraphic_L = blackboard_E start_POSTSUBSCRIPT bold_z , italic_ϵ ∼ caligraphic_N ( 0 , 1 ) , italic_t ∈ caligraphic_U ( italic_T ) end_POSTSUBSCRIPT [ ∥ italic_ϵ - italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_z start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT , italic_t ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.2">Furthermore, to simplify comprehension and narration, we can reparametrize the output of UNet <math alttext="\mathbf{\epsilon}_{\theta}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">ϵ</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">italic-ϵ</ci><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathbf{\epsilon}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> as the form of v-prediciton <math alttext="v_{\theta}" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">v</mi><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.cmml" xref="S3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑣</ci><ci id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">v_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>. The training objective can be further elaborated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}=\mathbb{E}_{\mathbf{z},\mathbf{\epsilon}\sim\mathcal{N}(0,1),t\in%
\mathcal{U}(T)}\left[\left\|\mathbf{z}-v_{\theta}\left(\mathbf{z}^{(t)},t%
\right)\right\|_{2}^{2}\right]" class="ltx_Math" display="block" id="S3.E2.m1.10"><semantics id="S3.E2.m1.10a"><mrow id="S3.E2.m1.10.10" xref="S3.E2.m1.10.10.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.10.10.3" xref="S3.E2.m1.10.10.3.cmml">ℒ</mi><mo id="S3.E2.m1.10.10.2" xref="S3.E2.m1.10.10.2.cmml">=</mo><mrow id="S3.E2.m1.10.10.1" xref="S3.E2.m1.10.10.1.cmml"><msub id="S3.E2.m1.10.10.1.3" xref="S3.E2.m1.10.10.1.3.cmml"><mi id="S3.E2.m1.10.10.1.3.2" xref="S3.E2.m1.10.10.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.7.7.7.7" xref="S3.E2.m1.7.7.7.8.cmml"><mrow id="S3.E2.m1.6.6.6.6.1" xref="S3.E2.m1.6.6.6.6.1.cmml"><mrow id="S3.E2.m1.6.6.6.6.1.2.2" xref="S3.E2.m1.6.6.6.6.1.2.1.cmml"><mi id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml">𝐳</mi><mo id="S3.E2.m1.6.6.6.6.1.2.2.1" xref="S3.E2.m1.6.6.6.6.1.2.1.cmml">,</mo><mi id="S3.E2.m1.4.4.4.4" xref="S3.E2.m1.4.4.4.4.cmml">ϵ</mi></mrow><mo id="S3.E2.m1.6.6.6.6.1.1" xref="S3.E2.m1.6.6.6.6.1.1.cmml">∼</mo><mrow id="S3.E2.m1.6.6.6.6.1.3" xref="S3.E2.m1.6.6.6.6.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.6.6.6.6.1.3.2" xref="S3.E2.m1.6.6.6.6.1.3.2.cmml">𝒩</mi><mo id="S3.E2.m1.6.6.6.6.1.3.1" xref="S3.E2.m1.6.6.6.6.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.6.6.6.6.1.3.3.2" xref="S3.E2.m1.6.6.6.6.1.3.3.1.cmml"><mo id="S3.E2.m1.6.6.6.6.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.6.6.6.6.1.3.3.1.cmml">(</mo><mn id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">0</mn><mo id="S3.E2.m1.6.6.6.6.1.3.3.2.2" xref="S3.E2.m1.6.6.6.6.1.3.3.1.cmml">,</mo><mn id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">1</mn><mo id="S3.E2.m1.6.6.6.6.1.3.3.2.3" stretchy="false" xref="S3.E2.m1.6.6.6.6.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.7.7.7.7.3" xref="S3.E2.m1.7.7.7.8a.cmml">,</mo><mrow id="S3.E2.m1.7.7.7.7.2" xref="S3.E2.m1.7.7.7.7.2.cmml"><mi id="S3.E2.m1.7.7.7.7.2.2" xref="S3.E2.m1.7.7.7.7.2.2.cmml">t</mi><mo id="S3.E2.m1.7.7.7.7.2.1" xref="S3.E2.m1.7.7.7.7.2.1.cmml">∈</mo><mrow id="S3.E2.m1.7.7.7.7.2.3" xref="S3.E2.m1.7.7.7.7.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.7.7.7.7.2.3.2" xref="S3.E2.m1.7.7.7.7.2.3.2.cmml">𝒰</mi><mo id="S3.E2.m1.7.7.7.7.2.3.1" xref="S3.E2.m1.7.7.7.7.2.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.7.7.7.7.2.3.3.2" xref="S3.E2.m1.7.7.7.7.2.3.cmml"><mo id="S3.E2.m1.7.7.7.7.2.3.3.2.1" stretchy="false" xref="S3.E2.m1.7.7.7.7.2.3.cmml">(</mo><mi id="S3.E2.m1.5.5.5.5" xref="S3.E2.m1.5.5.5.5.cmml">T</mi><mo id="S3.E2.m1.7.7.7.7.2.3.3.2.2" stretchy="false" xref="S3.E2.m1.7.7.7.7.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo id="S3.E2.m1.10.10.1.2" xref="S3.E2.m1.10.10.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.1" xref="S3.E2.m1.10.10.1.1.2.cmml"><mo id="S3.E2.m1.10.10.1.1.1.2" xref="S3.E2.m1.10.10.1.1.2.1.cmml">[</mo><msubsup id="S3.E2.m1.10.10.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.3.cmml">𝐳</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.2.cmml">v</mi><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S3.E2.m1.8.8.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.8.8.1.3.1" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E2.m1.8.8.1.1" xref="S3.E2.m1.8.8.1.1.cmml">t</mi><mo id="S3.E2.m1.8.8.1.3.2" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.9.9" xref="S3.E2.m1.9.9.cmml">t</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E2.m1.10.10.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E2.m1.10.10.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E2.m1.10.10.1.1.1.3" xref="S3.E2.m1.10.10.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.10b"><apply id="S3.E2.m1.10.10.cmml" xref="S3.E2.m1.10.10"><eq id="S3.E2.m1.10.10.2.cmml" xref="S3.E2.m1.10.10.2"></eq><ci id="S3.E2.m1.10.10.3.cmml" xref="S3.E2.m1.10.10.3">ℒ</ci><apply id="S3.E2.m1.10.10.1.cmml" xref="S3.E2.m1.10.10.1"><times id="S3.E2.m1.10.10.1.2.cmml" xref="S3.E2.m1.10.10.1.2"></times><apply id="S3.E2.m1.10.10.1.3.cmml" xref="S3.E2.m1.10.10.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.3.1.cmml" xref="S3.E2.m1.10.10.1.3">subscript</csymbol><ci id="S3.E2.m1.10.10.1.3.2.cmml" xref="S3.E2.m1.10.10.1.3.2">𝔼</ci><apply id="S3.E2.m1.7.7.7.8.cmml" xref="S3.E2.m1.7.7.7.7"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.7.8a.cmml" xref="S3.E2.m1.7.7.7.7.3">formulae-sequence</csymbol><apply id="S3.E2.m1.6.6.6.6.1.cmml" xref="S3.E2.m1.6.6.6.6.1"><csymbol cd="latexml" id="S3.E2.m1.6.6.6.6.1.1.cmml" xref="S3.E2.m1.6.6.6.6.1.1">similar-to</csymbol><list id="S3.E2.m1.6.6.6.6.1.2.1.cmml" xref="S3.E2.m1.6.6.6.6.1.2.2"><ci id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3">𝐳</ci><ci id="S3.E2.m1.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4">italic-ϵ</ci></list><apply id="S3.E2.m1.6.6.6.6.1.3.cmml" xref="S3.E2.m1.6.6.6.6.1.3"><times id="S3.E2.m1.6.6.6.6.1.3.1.cmml" xref="S3.E2.m1.6.6.6.6.1.3.1"></times><ci id="S3.E2.m1.6.6.6.6.1.3.2.cmml" xref="S3.E2.m1.6.6.6.6.1.3.2">𝒩</ci><interval closure="open" id="S3.E2.m1.6.6.6.6.1.3.3.1.cmml" xref="S3.E2.m1.6.6.6.6.1.3.3.2"><cn id="S3.E2.m1.1.1.1.1.cmml" type="integer" xref="S3.E2.m1.1.1.1.1">0</cn><cn id="S3.E2.m1.2.2.2.2.cmml" type="integer" xref="S3.E2.m1.2.2.2.2">1</cn></interval></apply></apply><apply id="S3.E2.m1.7.7.7.7.2.cmml" xref="S3.E2.m1.7.7.7.7.2"><in id="S3.E2.m1.7.7.7.7.2.1.cmml" xref="S3.E2.m1.7.7.7.7.2.1"></in><ci id="S3.E2.m1.7.7.7.7.2.2.cmml" xref="S3.E2.m1.7.7.7.7.2.2">𝑡</ci><apply id="S3.E2.m1.7.7.7.7.2.3.cmml" xref="S3.E2.m1.7.7.7.7.2.3"><times id="S3.E2.m1.7.7.7.7.2.3.1.cmml" xref="S3.E2.m1.7.7.7.7.2.3.1"></times><ci id="S3.E2.m1.7.7.7.7.2.3.2.cmml" xref="S3.E2.m1.7.7.7.7.2.3.2">𝒰</ci><ci id="S3.E2.m1.5.5.5.5.cmml" xref="S3.E2.m1.5.5.5.5">𝑇</ci></apply></apply></apply></apply><apply id="S3.E2.m1.10.10.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.10.10.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.10.10.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.10.10.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.2"></minus><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.3">𝐳</ci><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.2">𝑣</ci><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E2.m1.8.8.1.1.cmml" xref="S3.E2.m1.8.8.1.1">𝑡</ci></apply><ci id="S3.E2.m1.9.9.cmml" xref="S3.E2.m1.9.9">𝑡</ci></interval></apply></apply></apply><cn id="S3.E2.m1.10.10.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.10.10.1.1.1.1.1.3">2</cn></apply><cn id="S3.E2.m1.10.10.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.10.10.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.10c">\mathcal{L}=\mathbb{E}_{\mathbf{z},\mathbf{\epsilon}\sim\mathcal{N}(0,1),t\in%
\mathcal{U}(T)}\left[\left\|\mathbf{z}-v_{\theta}\left(\mathbf{z}^{(t)},t%
\right)\right\|_{2}^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.10d">caligraphic_L = blackboard_E start_POSTSUBSCRIPT bold_z , italic_ϵ ∼ caligraphic_N ( 0 , 1 ) , italic_t ∈ caligraphic_U ( italic_T ) end_POSTSUBSCRIPT [ ∥ bold_z - italic_v start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_z start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT , italic_t ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.5">This implies that the goal of every training round is to denoise <math alttext="\mathbf{z}^{(t)}" class="ltx_Math" display="inline" id="S3.p2.3.m1.1"><semantics id="S3.p2.3.m1.1a"><msup id="S3.p2.3.m1.1.2" xref="S3.p2.3.m1.1.2.cmml"><mi id="S3.p2.3.m1.1.2.2" xref="S3.p2.3.m1.1.2.2.cmml">𝐳</mi><mrow id="S3.p2.3.m1.1.1.1.3" xref="S3.p2.3.m1.1.2.cmml"><mo id="S3.p2.3.m1.1.1.1.3.1" stretchy="false" xref="S3.p2.3.m1.1.2.cmml">(</mo><mi id="S3.p2.3.m1.1.1.1.1" xref="S3.p2.3.m1.1.1.1.1.cmml">t</mi><mo id="S3.p2.3.m1.1.1.1.3.2" stretchy="false" xref="S3.p2.3.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p2.3.m1.1b"><apply id="S3.p2.3.m1.1.2.cmml" xref="S3.p2.3.m1.1.2"><csymbol cd="ambiguous" id="S3.p2.3.m1.1.2.1.cmml" xref="S3.p2.3.m1.1.2">superscript</csymbol><ci id="S3.p2.3.m1.1.2.2.cmml" xref="S3.p2.3.m1.1.2.2">𝐳</ci><ci id="S3.p2.3.m1.1.1.1.1.cmml" xref="S3.p2.3.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m1.1c">\mathbf{z}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m1.1d">bold_z start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math> to <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S3.p2.4.m2.1"><semantics id="S3.p2.4.m2.1a"><mi id="S3.p2.4.m2.1.1" xref="S3.p2.4.m2.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m2.1b"><ci id="S3.p2.4.m2.1.1.cmml" xref="S3.p2.4.m2.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m2.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m2.1d">bold_z</annotation></semantics></math> for any time step <math alttext="t" class="ltx_Math" display="inline" id="S3.p2.5.m3.1"><semantics id="S3.p2.5.m3.1a"><mi id="S3.p2.5.m3.1.1" xref="S3.p2.5.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m3.1b"><ci id="S3.p2.5.m3.1.1.cmml" xref="S3.p2.5.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m3.1d">italic_t</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.10">Secondly, we present our task definition, using one-shot segmentation as an illustration. Given a data triplet (<math alttext="\mathbf{I}_{s}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">𝐈</mi><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝐈</ci><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathbf{I}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">𝐌</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝐌</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{I}_{q}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">𝐈</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝐈</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\mathbf{I}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">bold_I start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>), here <math alttext="\mathbf{I}_{s}" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><msub id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mi id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">𝐈</mi><mi id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">𝐈</ci><ci id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">\mathbf{I}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{I}_{q}" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><msub id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml"><mi id="S3.p3.5.m5.1.1.2" xref="S3.p3.5.m5.1.1.2.cmml">𝐈</mi><mi id="S3.p3.5.m5.1.1.3" xref="S3.p3.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.1.1.1.cmml" xref="S3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.p3.5.m5.1.1.2.cmml" xref="S3.p3.5.m5.1.1.2">𝐈</ci><ci id="S3.p3.5.m5.1.1.3.cmml" xref="S3.p3.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">\mathbf{I}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">bold_I start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> denote the support image and query image respectively, both sharing an overlapping category <math alttext="c" class="ltx_Math" display="inline" id="S3.p3.6.m6.1"><semantics id="S3.p3.6.m6.1a"><mi id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">italic_c</annotation></semantics></math>. <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S3.p3.7.m7.1"><semantics id="S3.p3.7.m7.1a"><msub id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml"><mi id="S3.p3.7.m7.1.1.2" xref="S3.p3.7.m7.1.1.2.cmml">𝐌</mi><mi id="S3.p3.7.m7.1.1.3" xref="S3.p3.7.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><apply id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p3.7.m7.1.1.1.cmml" xref="S3.p3.7.m7.1.1">subscript</csymbol><ci id="S3.p3.7.m7.1.1.2.cmml" xref="S3.p3.7.m7.1.1.2">𝐌</ci><ci id="S3.p3.7.m7.1.1.3.cmml" xref="S3.p3.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m7.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the mask of category <math alttext="c" class="ltx_Math" display="inline" id="S3.p3.8.m8.1"><semantics id="S3.p3.8.m8.1a"><mi id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><ci id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m8.1d">italic_c</annotation></semantics></math> in the support image. Our task is to predict the mask corresponding to category <math alttext="c" class="ltx_Math" display="inline" id="S3.p3.9.m9.1"><semantics id="S3.p3.9.m9.1a"><mi id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><ci id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m9.1d">italic_c</annotation></semantics></math> in <math alttext="\mathbf{I}_{q}" class="ltx_Math" display="inline" id="S3.p3.10.m10.1"><semantics id="S3.p3.10.m10.1a"><msub id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml"><mi id="S3.p3.10.m10.1.1.2" xref="S3.p3.10.m10.1.1.2.cmml">𝐈</mi><mi id="S3.p3.10.m10.1.1.3" xref="S3.p3.10.m10.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><apply id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p3.10.m10.1.1.1.cmml" xref="S3.p3.10.m10.1.1">subscript</csymbol><ci id="S3.p3.10.m10.1.1.2.cmml" xref="S3.p3.10.m10.1.1.2">𝐈</ci><ci id="S3.p3.10.m10.1.1.3.cmml" xref="S3.p3.10.m10.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">\mathbf{I}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.10.m10.1d">bold_I start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>.
In the strict one-shot segmentation setting, the category sets of the training set and the test set are disjoint.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.11">Our objective is to fully utilize the priors in the Latent Diffusion Model and equip it with Few-shot Semantic Segmentation capabilities. This leads us to reuse the original VAE to convert <math alttext="\mathbf{I}_{s}" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">𝐈</mi><mi id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝐈</ci><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\mathbf{I}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{I}_{q}" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><msub id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">𝐈</mi><mi id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝐈</ci><ci id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\mathbf{I}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">bold_I start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{M}_{q}" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><msub id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">𝐌</mi><mi id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝐌</ci><ci id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">\mathbf{M}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">bold_M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> into latent variables <math alttext="\mathbf{z}_{s}" class="ltx_Math" display="inline" id="S3.p4.4.m4.1"><semantics id="S3.p4.4.m4.1a"><msub id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml"><mi id="S3.p4.4.m4.1.1.2" xref="S3.p4.4.m4.1.1.2.cmml">𝐳</mi><mi id="S3.p4.4.m4.1.1.3" xref="S3.p4.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.1.1.cmml" xref="S3.p4.4.m4.1.1">subscript</csymbol><ci id="S3.p4.4.m4.1.1.2.cmml" xref="S3.p4.4.m4.1.1.2">𝐳</ci><ci id="S3.p4.4.m4.1.1.3.cmml" xref="S3.p4.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">\mathbf{z}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.4.m4.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}_{q}" class="ltx_Math" display="inline" id="S3.p4.5.m5.1"><semantics id="S3.p4.5.m5.1a"><msub id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml"><mi id="S3.p4.5.m5.1.1.2" xref="S3.p4.5.m5.1.1.2.cmml">𝐳</mi><mi id="S3.p4.5.m5.1.1.3" xref="S3.p4.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.1.cmml" xref="S3.p4.5.m5.1.1">subscript</csymbol><ci id="S3.p4.5.m5.1.1.2.cmml" xref="S3.p4.5.m5.1.1.2">𝐳</ci><ci id="S3.p4.5.m5.1.1.3.cmml" xref="S3.p4.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">\mathbf{z}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.5.m5.1d">bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{z}_{mq}" class="ltx_Math" display="inline" id="S3.p4.6.m6.1"><semantics id="S3.p4.6.m6.1a"><msub id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml"><mi id="S3.p4.6.m6.1.1.2" xref="S3.p4.6.m6.1.1.2.cmml">𝐳</mi><mrow id="S3.p4.6.m6.1.1.3" xref="S3.p4.6.m6.1.1.3.cmml"><mi id="S3.p4.6.m6.1.1.3.2" xref="S3.p4.6.m6.1.1.3.2.cmml">m</mi><mo id="S3.p4.6.m6.1.1.3.1" xref="S3.p4.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.p4.6.m6.1.1.3.3" xref="S3.p4.6.m6.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><apply id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p4.6.m6.1.1.1.cmml" xref="S3.p4.6.m6.1.1">subscript</csymbol><ci id="S3.p4.6.m6.1.1.2.cmml" xref="S3.p4.6.m6.1.1.2">𝐳</ci><apply id="S3.p4.6.m6.1.1.3.cmml" xref="S3.p4.6.m6.1.1.3"><times id="S3.p4.6.m6.1.1.3.1.cmml" xref="S3.p4.6.m6.1.1.3.1"></times><ci id="S3.p4.6.m6.1.1.3.2.cmml" xref="S3.p4.6.m6.1.1.3.2">𝑚</ci><ci id="S3.p4.6.m6.1.1.3.3.cmml" xref="S3.p4.6.m6.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">\mathbf{z}_{mq}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.6.m6.1d">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, our task is further simplified to explore how to improve the structure of UNet to <math alttext="v^{*}_{\theta}" class="ltx_Math" display="inline" id="S3.p4.7.m7.1"><semantics id="S3.p4.7.m7.1a"><msubsup id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml"><mi id="S3.p4.7.m7.1.1.2.2" xref="S3.p4.7.m7.1.1.2.2.cmml">v</mi><mi id="S3.p4.7.m7.1.1.3" xref="S3.p4.7.m7.1.1.3.cmml">θ</mi><mo id="S3.p4.7.m7.1.1.2.3" xref="S3.p4.7.m7.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><apply id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p4.7.m7.1.1.1.cmml" xref="S3.p4.7.m7.1.1">subscript</csymbol><apply id="S3.p4.7.m7.1.1.2.cmml" xref="S3.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p4.7.m7.1.1.2.1.cmml" xref="S3.p4.7.m7.1.1">superscript</csymbol><ci id="S3.p4.7.m7.1.1.2.2.cmml" xref="S3.p4.7.m7.1.1.2.2">𝑣</ci><times id="S3.p4.7.m7.1.1.2.3.cmml" xref="S3.p4.7.m7.1.1.2.3"></times></apply><ci id="S3.p4.7.m7.1.1.3.cmml" xref="S3.p4.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">v^{*}_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.7.m7.1d">italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> so that it can accept <math alttext="\mathbf{z}_{s}" class="ltx_Math" display="inline" id="S3.p4.8.m8.1"><semantics id="S3.p4.8.m8.1a"><msub id="S3.p4.8.m8.1.1" xref="S3.p4.8.m8.1.1.cmml"><mi id="S3.p4.8.m8.1.1.2" xref="S3.p4.8.m8.1.1.2.cmml">𝐳</mi><mi id="S3.p4.8.m8.1.1.3" xref="S3.p4.8.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.8.m8.1b"><apply id="S3.p4.8.m8.1.1.cmml" xref="S3.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p4.8.m8.1.1.1.cmml" xref="S3.p4.8.m8.1.1">subscript</csymbol><ci id="S3.p4.8.m8.1.1.2.cmml" xref="S3.p4.8.m8.1.1.2">𝐳</ci><ci id="S3.p4.8.m8.1.1.3.cmml" xref="S3.p4.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m8.1c">\mathbf{z}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.8.m8.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}_{q}" class="ltx_Math" display="inline" id="S3.p4.9.m9.1"><semantics id="S3.p4.9.m9.1a"><msub id="S3.p4.9.m9.1.1" xref="S3.p4.9.m9.1.1.cmml"><mi id="S3.p4.9.m9.1.1.2" xref="S3.p4.9.m9.1.1.2.cmml">𝐳</mi><mi id="S3.p4.9.m9.1.1.3" xref="S3.p4.9.m9.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.9.m9.1b"><apply id="S3.p4.9.m9.1.1.cmml" xref="S3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m9.1.1.1.cmml" xref="S3.p4.9.m9.1.1">subscript</csymbol><ci id="S3.p4.9.m9.1.1.2.cmml" xref="S3.p4.9.m9.1.1.2">𝐳</ci><ci id="S3.p4.9.m9.1.1.3.cmml" xref="S3.p4.9.m9.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.m9.1c">\mathbf{z}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.9.m9.1d">bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S3.p4.10.m10.1"><semantics id="S3.p4.10.m10.1a"><msub id="S3.p4.10.m10.1.1" xref="S3.p4.10.m10.1.1.cmml"><mi id="S3.p4.10.m10.1.1.2" xref="S3.p4.10.m10.1.1.2.cmml">𝐌</mi><mi id="S3.p4.10.m10.1.1.3" xref="S3.p4.10.m10.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.10.m10.1b"><apply id="S3.p4.10.m10.1.1.cmml" xref="S3.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p4.10.m10.1.1.1.cmml" xref="S3.p4.10.m10.1.1">subscript</csymbol><ci id="S3.p4.10.m10.1.1.2.cmml" xref="S3.p4.10.m10.1.1.2">𝐌</ci><ci id="S3.p4.10.m10.1.1.3.cmml" xref="S3.p4.10.m10.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.10.m10.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.10.m10.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> as inputs, and use <math alttext="\mathbf{z}_{mq}" class="ltx_Math" display="inline" id="S3.p4.11.m11.1"><semantics id="S3.p4.11.m11.1a"><msub id="S3.p4.11.m11.1.1" xref="S3.p4.11.m11.1.1.cmml"><mi id="S3.p4.11.m11.1.1.2" xref="S3.p4.11.m11.1.1.2.cmml">𝐳</mi><mrow id="S3.p4.11.m11.1.1.3" xref="S3.p4.11.m11.1.1.3.cmml"><mi id="S3.p4.11.m11.1.1.3.2" xref="S3.p4.11.m11.1.1.3.2.cmml">m</mi><mo id="S3.p4.11.m11.1.1.3.1" xref="S3.p4.11.m11.1.1.3.1.cmml">⁢</mo><mi id="S3.p4.11.m11.1.1.3.3" xref="S3.p4.11.m11.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.11.m11.1b"><apply id="S3.p4.11.m11.1.1.cmml" xref="S3.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S3.p4.11.m11.1.1.1.cmml" xref="S3.p4.11.m11.1.1">subscript</csymbol><ci id="S3.p4.11.m11.1.1.2.cmml" xref="S3.p4.11.m11.1.1.2">𝐳</ci><apply id="S3.p4.11.m11.1.1.3.cmml" xref="S3.p4.11.m11.1.1.3"><times id="S3.p4.11.m11.1.1.3.1.cmml" xref="S3.p4.11.m11.1.1.3.1"></times><ci id="S3.p4.11.m11.1.1.3.2.cmml" xref="S3.p4.11.m11.1.1.3.2">𝑚</ci><ci id="S3.p4.11.m11.1.1.3.3.cmml" xref="S3.p4.11.m11.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.11.m11.1c">\mathbf{z}_{mq}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.11.m11.1d">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT</annotation></semantics></math> as supervision.</p>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.1">This supervised approach in the latent space has been certified effective in tasks such as depth estimation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>]</cite> and semantic segmentation<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib14" title="">14</a>]</cite>. Concretely, our training objective <math alttext="\mathcal{L_{FSS}}" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><msub id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.1.m1.1.1.2" xref="S3.p5.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.p5.1.m1.1.1.3" xref="S3.p5.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.1.m1.1.1.3.2" xref="S3.p5.1.m1.1.1.3.2.cmml">ℱ</mi><mo id="S3.p5.1.m1.1.1.3.1" xref="S3.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.p5.1.m1.1.1.3.3" xref="S3.p5.1.m1.1.1.3.3.cmml">𝒮</mi><mo id="S3.p5.1.m1.1.1.3.1a" xref="S3.p5.1.m1.1.1.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.p5.1.m1.1.1.3.4" xref="S3.p5.1.m1.1.1.3.4.cmml">𝒮</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p5.1.m1.1.1.1.cmml" xref="S3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.p5.1.m1.1.1.2.cmml" xref="S3.p5.1.m1.1.1.2">ℒ</ci><apply id="S3.p5.1.m1.1.1.3.cmml" xref="S3.p5.1.m1.1.1.3"><times id="S3.p5.1.m1.1.1.3.1.cmml" xref="S3.p5.1.m1.1.1.3.1"></times><ci id="S3.p5.1.m1.1.1.3.2.cmml" xref="S3.p5.1.m1.1.1.3.2">ℱ</ci><ci id="S3.p5.1.m1.1.1.3.3.cmml" xref="S3.p5.1.m1.1.1.3.3">𝒮</ci><ci id="S3.p5.1.m1.1.1.3.4.cmml" xref="S3.p5.1.m1.1.1.3.4">𝒮</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\mathcal{L_{FSS}}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT caligraphic_F caligraphic_S caligraphic_S end_POSTSUBSCRIPT</annotation></semantics></math> is transformed into:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L_{FSS}}=\mathbb{E}_{(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf{M}_{s},%
\mathbf{z}_{mq})\sim\mathcal{D}}\left[\left\|\mathbf{z}_{mq}-v^{*}_{\theta}%
\left(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf{M}_{s}\right)\right\|_{2}^{2}\right]" class="ltx_Math" display="block" id="S3.E3.m1.5"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><msub id="S3.E3.m1.5.5.3" xref="S3.E3.m1.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.3.2" xref="S3.E3.m1.5.5.3.2.cmml">ℒ</mi><mrow id="S3.E3.m1.5.5.3.3" xref="S3.E3.m1.5.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.3.3.2" xref="S3.E3.m1.5.5.3.3.2.cmml">ℱ</mi><mo id="S3.E3.m1.5.5.3.3.1" xref="S3.E3.m1.5.5.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.3.3.3" xref="S3.E3.m1.5.5.3.3.3.cmml">𝒮</mi><mo id="S3.E3.m1.5.5.3.3.1a" xref="S3.E3.m1.5.5.3.3.1.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.5.5.3.3.4" xref="S3.E3.m1.5.5.3.3.4.cmml">𝒮</mi></mrow></msub><mo id="S3.E3.m1.5.5.2" xref="S3.E3.m1.5.5.2.cmml">=</mo><mrow id="S3.E3.m1.5.5.1" xref="S3.E3.m1.5.5.1.cmml"><msub id="S3.E3.m1.5.5.1.3" xref="S3.E3.m1.5.5.1.3.cmml"><mi id="S3.E3.m1.5.5.1.3.2" xref="S3.E3.m1.5.5.1.3.2.cmml">𝔼</mi><mrow id="S3.E3.m1.4.4.4" xref="S3.E3.m1.4.4.4.cmml"><mrow id="S3.E3.m1.4.4.4.4.4" xref="S3.E3.m1.4.4.4.4.5.cmml"><mo id="S3.E3.m1.4.4.4.4.4.5" stretchy="false" xref="S3.E3.m1.4.4.4.4.5.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E3.m1.4.4.4.4.4.6" xref="S3.E3.m1.4.4.4.4.5.cmml">,</mo><msub id="S3.E3.m1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.2.cmml">𝐳</mi><mi id="S3.E3.m1.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.2.2.3.cmml">q</mi></msub><mo id="S3.E3.m1.4.4.4.4.4.7" xref="S3.E3.m1.4.4.4.4.5.cmml">,</mo><msub id="S3.E3.m1.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.cmml"><mi id="S3.E3.m1.3.3.3.3.3.3.2" xref="S3.E3.m1.3.3.3.3.3.3.2.cmml">𝐌</mi><mi id="S3.E3.m1.3.3.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.3.3.cmml">s</mi></msub><mo id="S3.E3.m1.4.4.4.4.4.8" xref="S3.E3.m1.4.4.4.4.5.cmml">,</mo><msub id="S3.E3.m1.4.4.4.4.4.4" xref="S3.E3.m1.4.4.4.4.4.4.cmml"><mi id="S3.E3.m1.4.4.4.4.4.4.2" xref="S3.E3.m1.4.4.4.4.4.4.2.cmml">𝐳</mi><mrow id="S3.E3.m1.4.4.4.4.4.4.3" xref="S3.E3.m1.4.4.4.4.4.4.3.cmml"><mi id="S3.E3.m1.4.4.4.4.4.4.3.2" xref="S3.E3.m1.4.4.4.4.4.4.3.2.cmml">m</mi><mo id="S3.E3.m1.4.4.4.4.4.4.3.1" xref="S3.E3.m1.4.4.4.4.4.4.3.1.cmml">⁢</mo><mi id="S3.E3.m1.4.4.4.4.4.4.3.3" xref="S3.E3.m1.4.4.4.4.4.4.3.3.cmml">q</mi></mrow></msub><mo id="S3.E3.m1.4.4.4.4.4.9" stretchy="false" xref="S3.E3.m1.4.4.4.4.5.cmml">)</mo></mrow><mo id="S3.E3.m1.4.4.4.5" xref="S3.E3.m1.4.4.4.5.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.4.4.4.6" xref="S3.E3.m1.4.4.4.6.cmml">𝒟</mi></mrow></msub><mo id="S3.E3.m1.5.5.1.2" xref="S3.E3.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1" xref="S3.E3.m1.5.5.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.1.2" xref="S3.E3.m1.5.5.1.1.2.1.cmml">[</mo><msubsup id="S3.E3.m1.5.5.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.2.cmml">𝐳</mi><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.2.cmml">m</mi><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.1.cmml">⁢</mo><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.3.cmml">q</mi></mrow></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.4" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.4.cmml">−</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.2.cmml">v</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.3.cmml">θ</mi><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.3.cmml">∗</mo></msubsup><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.4" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.4" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">(</mo><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.5" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐳</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">q</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.6" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">𝐌</mi><mi id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">s</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.7" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E3.m1.5.5.1.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E3.m1.5.5.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S3.E3.m1.5.5.1.1.1.3" xref="S3.E3.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.2.cmml" xref="S3.E3.m1.5.5.2"></eq><apply id="S3.E3.m1.5.5.3.cmml" xref="S3.E3.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.3.1.cmml" xref="S3.E3.m1.5.5.3">subscript</csymbol><ci id="S3.E3.m1.5.5.3.2.cmml" xref="S3.E3.m1.5.5.3.2">ℒ</ci><apply id="S3.E3.m1.5.5.3.3.cmml" xref="S3.E3.m1.5.5.3.3"><times id="S3.E3.m1.5.5.3.3.1.cmml" xref="S3.E3.m1.5.5.3.3.1"></times><ci id="S3.E3.m1.5.5.3.3.2.cmml" xref="S3.E3.m1.5.5.3.3.2">ℱ</ci><ci id="S3.E3.m1.5.5.3.3.3.cmml" xref="S3.E3.m1.5.5.3.3.3">𝒮</ci><ci id="S3.E3.m1.5.5.3.3.4.cmml" xref="S3.E3.m1.5.5.3.3.4">𝒮</ci></apply></apply><apply id="S3.E3.m1.5.5.1.cmml" xref="S3.E3.m1.5.5.1"><times id="S3.E3.m1.5.5.1.2.cmml" xref="S3.E3.m1.5.5.1.2"></times><apply id="S3.E3.m1.5.5.1.3.cmml" xref="S3.E3.m1.5.5.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.3.1.cmml" xref="S3.E3.m1.5.5.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.3.2.cmml" xref="S3.E3.m1.5.5.1.3.2">𝔼</ci><apply id="S3.E3.m1.4.4.4.cmml" xref="S3.E3.m1.4.4.4"><csymbol cd="latexml" id="S3.E3.m1.4.4.4.5.cmml" xref="S3.E3.m1.4.4.4.5">similar-to</csymbol><vector id="S3.E3.m1.4.4.4.4.5.cmml" xref="S3.E3.m1.4.4.4.4.4"><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E3.m1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2">𝐳</ci><ci id="S3.E3.m1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.3">𝑞</ci></apply><apply id="S3.E3.m1.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3.3.3.2">𝐌</ci><ci id="S3.E3.m1.3.3.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3.3.3">𝑠</ci></apply><apply id="S3.E3.m1.4.4.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.4.4.4.1.cmml" xref="S3.E3.m1.4.4.4.4.4.4">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.4.4.2.cmml" xref="S3.E3.m1.4.4.4.4.4.4.2">𝐳</ci><apply id="S3.E3.m1.4.4.4.4.4.4.3.cmml" xref="S3.E3.m1.4.4.4.4.4.4.3"><times id="S3.E3.m1.4.4.4.4.4.4.3.1.cmml" xref="S3.E3.m1.4.4.4.4.4.4.3.1"></times><ci id="S3.E3.m1.4.4.4.4.4.4.3.2.cmml" xref="S3.E3.m1.4.4.4.4.4.4.3.2">𝑚</ci><ci id="S3.E3.m1.4.4.4.4.4.4.3.3.cmml" xref="S3.E3.m1.4.4.4.4.4.4.3.3">𝑞</ci></apply></apply></vector><ci id="S3.E3.m1.4.4.4.6.cmml" xref="S3.E3.m1.4.4.4.6">𝒟</ci></apply></apply><apply id="S3.E3.m1.5.5.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.5.5.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.4"></minus><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.2">𝐳</ci><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.1"></times><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.2">𝑚</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.5.3.3">𝑞</ci></apply></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3"><times id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.4"></times><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5">subscript</csymbol><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5">superscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.2">𝑣</ci><times id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.3"></times></apply><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.5.3">𝜃</ci></apply><vector id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3"><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐳</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑞</ci></apply><apply id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2">𝐌</ci><ci id="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3">𝑠</ci></apply></vector></apply></apply></apply><cn id="S3.E3.m1.5.5.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.1.1.1.3">2</cn></apply><cn id="S3.E3.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.5.5.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\mathcal{L_{FSS}}=\mathbb{E}_{(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf{M}_{s},%
\mathbf{z}_{mq})\sim\mathcal{D}}\left[\left\|\mathbf{z}_{mq}-v^{*}_{\theta}%
\left(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf{M}_{s}\right)\right\|_{2}^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.5d">caligraphic_L start_POSTSUBSCRIPT caligraphic_F caligraphic_S caligraphic_S end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ ∥ bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT - italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p5.3">where <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.p5.2.m1.1"><semantics id="S3.p5.2.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p5.2.m1.1.1" xref="S3.p5.2.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p5.2.m1.1b"><ci id="S3.p5.2.m1.1.1.cmml" xref="S3.p5.2.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m1.1d">caligraphic_D</annotation></semantics></math> represents the constructed training dataset. In addition, we omitted the input of time <math alttext="t" class="ltx_Math" display="inline" id="S3.p5.3.m2.1"><semantics id="S3.p5.3.m2.1a"><mi id="S3.p5.3.m2.1.1" xref="S3.p5.3.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p5.3.m2.1b"><ci id="S3.p5.3.m2.1.1.cmml" xref="S3.p5.3.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.3.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.p5.3.m2.1d">italic_t</annotation></semantics></math>. Our early experiments revealed that performing multiple steps of noise addition and denoising during training did not bring performance improvement.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="430" id="S3.F1.g1" src="x1.png" width="731"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F1.22.11.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S3.F1.20.10" style="font-size:90%;">Overview of the DiffewS framework.
(a)(b) display that query image <math alttext="\mathbf{I}_{q}" class="ltx_Math" display="inline" id="S3.F1.11.1.m1.1"><semantics id="S3.F1.11.1.m1.1b"><msub id="S3.F1.11.1.m1.1.1" xref="S3.F1.11.1.m1.1.1.cmml"><mi id="S3.F1.11.1.m1.1.1.2" xref="S3.F1.11.1.m1.1.1.2.cmml">𝐈</mi><mi id="S3.F1.11.1.m1.1.1.3" xref="S3.F1.11.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.11.1.m1.1c"><apply id="S3.F1.11.1.m1.1.1.cmml" xref="S3.F1.11.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F1.11.1.m1.1.1.1.cmml" xref="S3.F1.11.1.m1.1.1">subscript</csymbol><ci id="S3.F1.11.1.m1.1.1.2.cmml" xref="S3.F1.11.1.m1.1.1.2">𝐈</ci><ci id="S3.F1.11.1.m1.1.1.3.cmml" xref="S3.F1.11.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.11.1.m1.1d">\mathbf{I}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.11.1.m1.1e">bold_I start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, query mask <math alttext="\mathbf{M}_{q}" class="ltx_Math" display="inline" id="S3.F1.12.2.m2.1"><semantics id="S3.F1.12.2.m2.1b"><msub id="S3.F1.12.2.m2.1.1" xref="S3.F1.12.2.m2.1.1.cmml"><mi id="S3.F1.12.2.m2.1.1.2" xref="S3.F1.12.2.m2.1.1.2.cmml">𝐌</mi><mi id="S3.F1.12.2.m2.1.1.3" xref="S3.F1.12.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.12.2.m2.1c"><apply id="S3.F1.12.2.m2.1.1.cmml" xref="S3.F1.12.2.m2.1.1"><csymbol cd="ambiguous" id="S3.F1.12.2.m2.1.1.1.cmml" xref="S3.F1.12.2.m2.1.1">subscript</csymbol><ci id="S3.F1.12.2.m2.1.1.2.cmml" xref="S3.F1.12.2.m2.1.1.2">𝐌</ci><ci id="S3.F1.12.2.m2.1.1.3.cmml" xref="S3.F1.12.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.12.2.m2.1d">\mathbf{M}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.12.2.m2.1e">bold_M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, support image <math alttext="\mathbf{I}_{s}" class="ltx_Math" display="inline" id="S3.F1.13.3.m3.1"><semantics id="S3.F1.13.3.m3.1b"><msub id="S3.F1.13.3.m3.1.1" xref="S3.F1.13.3.m3.1.1.cmml"><mi id="S3.F1.13.3.m3.1.1.2" xref="S3.F1.13.3.m3.1.1.2.cmml">𝐈</mi><mi id="S3.F1.13.3.m3.1.1.3" xref="S3.F1.13.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.13.3.m3.1c"><apply id="S3.F1.13.3.m3.1.1.cmml" xref="S3.F1.13.3.m3.1.1"><csymbol cd="ambiguous" id="S3.F1.13.3.m3.1.1.1.cmml" xref="S3.F1.13.3.m3.1.1">subscript</csymbol><ci id="S3.F1.13.3.m3.1.1.2.cmml" xref="S3.F1.13.3.m3.1.1.2">𝐈</ci><ci id="S3.F1.13.3.m3.1.1.3.cmml" xref="S3.F1.13.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.13.3.m3.1d">\mathbf{I}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.13.3.m3.1e">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and support mask <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S3.F1.14.4.m4.1"><semantics id="S3.F1.14.4.m4.1b"><msub id="S3.F1.14.4.m4.1.1" xref="S3.F1.14.4.m4.1.1.cmml"><mi id="S3.F1.14.4.m4.1.1.2" xref="S3.F1.14.4.m4.1.1.2.cmml">𝐌</mi><mi id="S3.F1.14.4.m4.1.1.3" xref="S3.F1.14.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.14.4.m4.1c"><apply id="S3.F1.14.4.m4.1.1.cmml" xref="S3.F1.14.4.m4.1.1"><csymbol cd="ambiguous" id="S3.F1.14.4.m4.1.1.1.cmml" xref="S3.F1.14.4.m4.1.1">subscript</csymbol><ci id="S3.F1.14.4.m4.1.1.2.cmml" xref="S3.F1.14.4.m4.1.1.2">𝐌</ci><ci id="S3.F1.14.4.m4.1.1.3.cmml" xref="S3.F1.14.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.14.4.m4.1d">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.14.4.m4.1e">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> are all encoded by VAE into latent variables <math alttext="\mathbf{z}_{q}" class="ltx_Math" display="inline" id="S3.F1.15.5.m5.1"><semantics id="S3.F1.15.5.m5.1b"><msub id="S3.F1.15.5.m5.1.1" xref="S3.F1.15.5.m5.1.1.cmml"><mi id="S3.F1.15.5.m5.1.1.2" xref="S3.F1.15.5.m5.1.1.2.cmml">𝐳</mi><mi id="S3.F1.15.5.m5.1.1.3" xref="S3.F1.15.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.15.5.m5.1c"><apply id="S3.F1.15.5.m5.1.1.cmml" xref="S3.F1.15.5.m5.1.1"><csymbol cd="ambiguous" id="S3.F1.15.5.m5.1.1.1.cmml" xref="S3.F1.15.5.m5.1.1">subscript</csymbol><ci id="S3.F1.15.5.m5.1.1.2.cmml" xref="S3.F1.15.5.m5.1.1.2">𝐳</ci><ci id="S3.F1.15.5.m5.1.1.3.cmml" xref="S3.F1.15.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.15.5.m5.1d">\mathbf{z}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.15.5.m5.1e">bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}_{mq}" class="ltx_Math" display="inline" id="S3.F1.16.6.m6.1"><semantics id="S3.F1.16.6.m6.1b"><msub id="S3.F1.16.6.m6.1.1" xref="S3.F1.16.6.m6.1.1.cmml"><mi id="S3.F1.16.6.m6.1.1.2" xref="S3.F1.16.6.m6.1.1.2.cmml">𝐳</mi><mrow id="S3.F1.16.6.m6.1.1.3" xref="S3.F1.16.6.m6.1.1.3.cmml"><mi id="S3.F1.16.6.m6.1.1.3.2" xref="S3.F1.16.6.m6.1.1.3.2.cmml">m</mi><mo id="S3.F1.16.6.m6.1.1.3.1" xref="S3.F1.16.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S3.F1.16.6.m6.1.1.3.3" xref="S3.F1.16.6.m6.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F1.16.6.m6.1c"><apply id="S3.F1.16.6.m6.1.1.cmml" xref="S3.F1.16.6.m6.1.1"><csymbol cd="ambiguous" id="S3.F1.16.6.m6.1.1.1.cmml" xref="S3.F1.16.6.m6.1.1">subscript</csymbol><ci id="S3.F1.16.6.m6.1.1.2.cmml" xref="S3.F1.16.6.m6.1.1.2">𝐳</ci><apply id="S3.F1.16.6.m6.1.1.3.cmml" xref="S3.F1.16.6.m6.1.1.3"><times id="S3.F1.16.6.m6.1.1.3.1.cmml" xref="S3.F1.16.6.m6.1.1.3.1"></times><ci id="S3.F1.16.6.m6.1.1.3.2.cmml" xref="S3.F1.16.6.m6.1.1.3.2">𝑚</ci><ci id="S3.F1.16.6.m6.1.1.3.3.cmml" xref="S3.F1.16.6.m6.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.16.6.m6.1d">\mathbf{z}_{mq}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.16.6.m6.1e">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}_{s}" class="ltx_Math" display="inline" id="S3.F1.17.7.m7.1"><semantics id="S3.F1.17.7.m7.1b"><msub id="S3.F1.17.7.m7.1.1" xref="S3.F1.17.7.m7.1.1.cmml"><mi id="S3.F1.17.7.m7.1.1.2" xref="S3.F1.17.7.m7.1.1.2.cmml">𝐳</mi><mi id="S3.F1.17.7.m7.1.1.3" xref="S3.F1.17.7.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.17.7.m7.1c"><apply id="S3.F1.17.7.m7.1.1.cmml" xref="S3.F1.17.7.m7.1.1"><csymbol cd="ambiguous" id="S3.F1.17.7.m7.1.1.1.cmml" xref="S3.F1.17.7.m7.1.1">subscript</csymbol><ci id="S3.F1.17.7.m7.1.1.2.cmml" xref="S3.F1.17.7.m7.1.1.2">𝐳</ci><ci id="S3.F1.17.7.m7.1.1.3.cmml" xref="S3.F1.17.7.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.17.7.m7.1d">\mathbf{z}_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.17.7.m7.1e">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}_{ms}" class="ltx_Math" display="inline" id="S3.F1.18.8.m8.1"><semantics id="S3.F1.18.8.m8.1b"><msub id="S3.F1.18.8.m8.1.1" xref="S3.F1.18.8.m8.1.1.cmml"><mi id="S3.F1.18.8.m8.1.1.2" xref="S3.F1.18.8.m8.1.1.2.cmml">𝐳</mi><mrow id="S3.F1.18.8.m8.1.1.3" xref="S3.F1.18.8.m8.1.1.3.cmml"><mi id="S3.F1.18.8.m8.1.1.3.2" xref="S3.F1.18.8.m8.1.1.3.2.cmml">m</mi><mo id="S3.F1.18.8.m8.1.1.3.1" xref="S3.F1.18.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.F1.18.8.m8.1.1.3.3" xref="S3.F1.18.8.m8.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F1.18.8.m8.1c"><apply id="S3.F1.18.8.m8.1.1.cmml" xref="S3.F1.18.8.m8.1.1"><csymbol cd="ambiguous" id="S3.F1.18.8.m8.1.1.1.cmml" xref="S3.F1.18.8.m8.1.1">subscript</csymbol><ci id="S3.F1.18.8.m8.1.1.2.cmml" xref="S3.F1.18.8.m8.1.1.2">𝐳</ci><apply id="S3.F1.18.8.m8.1.1.3.cmml" xref="S3.F1.18.8.m8.1.1.3"><times id="S3.F1.18.8.m8.1.1.3.1.cmml" xref="S3.F1.18.8.m8.1.1.3.1"></times><ci id="S3.F1.18.8.m8.1.1.3.2.cmml" xref="S3.F1.18.8.m8.1.1.3.2">𝑚</ci><ci id="S3.F1.18.8.m8.1.1.3.3.cmml" xref="S3.F1.18.8.m8.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.18.8.m8.1d">\mathbf{z}_{ms}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.18.8.m8.1e">bold_z start_POSTSUBSCRIPT italic_m italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, respectively, where <math alttext="\mathbf{z}_{q}" class="ltx_Math" display="inline" id="S3.F1.19.9.m9.1"><semantics id="S3.F1.19.9.m9.1b"><msub id="S3.F1.19.9.m9.1.1" xref="S3.F1.19.9.m9.1.1.cmml"><mi id="S3.F1.19.9.m9.1.1.2" xref="S3.F1.19.9.m9.1.1.2.cmml">𝐳</mi><mi id="S3.F1.19.9.m9.1.1.3" xref="S3.F1.19.9.m9.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F1.19.9.m9.1c"><apply id="S3.F1.19.9.m9.1.1.cmml" xref="S3.F1.19.9.m9.1.1"><csymbol cd="ambiguous" id="S3.F1.19.9.m9.1.1.1.cmml" xref="S3.F1.19.9.m9.1.1">subscript</csymbol><ci id="S3.F1.19.9.m9.1.1.2.cmml" xref="S3.F1.19.9.m9.1.1.2">𝐳</ci><ci id="S3.F1.19.9.m9.1.1.3.cmml" xref="S3.F1.19.9.m9.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.19.9.m9.1d">\mathbf{z}_{q}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.19.9.m9.1e">bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{z}_{mq}" class="ltx_Math" display="inline" id="S3.F1.20.10.m10.1"><semantics id="S3.F1.20.10.m10.1b"><msub id="S3.F1.20.10.m10.1.1" xref="S3.F1.20.10.m10.1.1.cmml"><mi id="S3.F1.20.10.m10.1.1.2" xref="S3.F1.20.10.m10.1.1.2.cmml">𝐳</mi><mrow id="S3.F1.20.10.m10.1.1.3" xref="S3.F1.20.10.m10.1.1.3.cmml"><mi id="S3.F1.20.10.m10.1.1.3.2" xref="S3.F1.20.10.m10.1.1.3.2.cmml">m</mi><mo id="S3.F1.20.10.m10.1.1.3.1" xref="S3.F1.20.10.m10.1.1.3.1.cmml">⁢</mo><mi id="S3.F1.20.10.m10.1.1.3.3" xref="S3.F1.20.10.m10.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F1.20.10.m10.1c"><apply id="S3.F1.20.10.m10.1.1.cmml" xref="S3.F1.20.10.m10.1.1"><csymbol cd="ambiguous" id="S3.F1.20.10.m10.1.1.1.cmml" xref="S3.F1.20.10.m10.1.1">subscript</csymbol><ci id="S3.F1.20.10.m10.1.1.2.cmml" xref="S3.F1.20.10.m10.1.1.2">𝐳</ci><apply id="S3.F1.20.10.m10.1.1.3.cmml" xref="S3.F1.20.10.m10.1.1.3"><times id="S3.F1.20.10.m10.1.1.3.1.cmml" xref="S3.F1.20.10.m10.1.1.3.1"></times><ci id="S3.F1.20.10.m10.1.1.3.2.cmml" xref="S3.F1.20.10.m10.1.1.3.2">𝑚</ci><ci id="S3.F1.20.10.m10.1.1.3.3.cmml" xref="S3.F1.20.10.m10.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.20.10.m10.1d">\mathbf{z}_{mq}</annotation><annotation encoding="application/x-llamapun" id="S3.F1.20.10.m10.1e">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT</annotation></semantics></math> are concatenated to input into UNet.
(c) demonstrates the DiffewS fintuning protocol, where the query image branch performs the original Self-attention while the support Image branch facilitates interaction between query image and support image by executing KV Fusion Self-Attention (FSA). (d) elucidates the detailed implementation of FSA, acquiring information from support images by concatenating the query and key features.
</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Our investigation into model design primarily adheres to two criteria: 1. Strive for the design to be as simple and efficient as possible, while optimizing performance in Few-shot Semantic Segmentation. 2. Maximize the preservation of the Latent Diffusion Model’s generative schema, minimizing alteration to the original UNet structure, so as to better utilize the pre-training prior.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">Specifically, four key issues need to be addressed: 1) How to facilitate interaction between the query image and support image? 2) How to effectively incorporate information from the support mask? 3) What form of supervision from the query mask would be most reasonable?
4) How to design an effective generation process to transfer the pre-trained diffusion models to mask prediction task?
In this section, we discuss the four issues mentioned above in detail.
We engage in fair comparison tests and analysis on several feasible strategies. Drawing on our observations, we eventually settle on our framework, DiffewS (see <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S3.F1" title="In 3 Preliminary ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Interaction between query and support images</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.5">We first decompose the block of the l-th layer in UNet into three components: a self-attention layer <math alttext="{\operatorname{SelfAttn}}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">SelfAttn</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">SelfAttn</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">{\operatorname{SelfAttn}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">roman_SelfAttn</annotation></semantics></math>, a cross-attention layer <math alttext="{\operatorname{CrossAttn}}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">CrossAttn</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">CrossAttn</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">{\operatorname{CrossAttn}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">roman_CrossAttn</annotation></semantics></math>, and a feedforward layer <math alttext="{\operatorname{FFN}}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">FFN</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">FFN</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">{\operatorname{FFN}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">roman_FFN</annotation></semantics></math>.
Given the feature map <math alttext="\mathbf{X}^{l}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><msup id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">𝐗</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝐗</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">\mathbf{X}^{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">bold_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> of the l-th image and the textual input <math alttext="\mathbf{t}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">𝐭</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝐭</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">\mathbf{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">bold_t</annotation></semantics></math> (which is an empty character in our task), we obtain:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{X}^{l+1}={\operatorname{FFN}}\left({\operatorname{CrossAttn}}\left({%
\operatorname{SelfAttn}}\left(\mathbf{X}^{l}\right),\operatorname{CLIP}_{text}%
(\mathbf{t})\right)\right)," class="ltx_Math" display="block" id="S4.E4.m1.5"><semantics id="S4.E4.m1.5a"><mrow id="S4.E4.m1.5.5.1" xref="S4.E4.m1.5.5.1.1.cmml"><mrow id="S4.E4.m1.5.5.1.1" xref="S4.E4.m1.5.5.1.1.cmml"><msup id="S4.E4.m1.5.5.1.1.3" xref="S4.E4.m1.5.5.1.1.3.cmml"><mi id="S4.E4.m1.5.5.1.1.3.2" xref="S4.E4.m1.5.5.1.1.3.2.cmml">𝐗</mi><mrow id="S4.E4.m1.5.5.1.1.3.3" xref="S4.E4.m1.5.5.1.1.3.3.cmml"><mi id="S4.E4.m1.5.5.1.1.3.3.2" xref="S4.E4.m1.5.5.1.1.3.3.2.cmml">l</mi><mo id="S4.E4.m1.5.5.1.1.3.3.1" xref="S4.E4.m1.5.5.1.1.3.3.1.cmml">+</mo><mn id="S4.E4.m1.5.5.1.1.3.3.3" xref="S4.E4.m1.5.5.1.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S4.E4.m1.5.5.1.1.2" xref="S4.E4.m1.5.5.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.5.5.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.2.cmml"><mi id="S4.E4.m1.4.4" xref="S4.E4.m1.4.4.cmml">FFN</mi><mo id="S4.E4.m1.5.5.1.1.1.1a" xref="S4.E4.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.2.cmml"><mo id="S4.E4.m1.5.5.1.1.1.1.1.2" xref="S4.E4.m1.5.5.1.1.1.2.cmml">(</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1.1.2" xref="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">CrossAttn</mi><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2a" xref="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2" xref="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml"><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml">(</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">SelfAttn</mi><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1a" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msup id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.4" xref="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml">,</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml"><msub id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.cmml"><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.2" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.2.cmml">CLIP</mi><mrow id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.cmml"><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.2" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.2.cmml">t</mi><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.1" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.3" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.3.cmml">e</mi><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.1a" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.4" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.4.cmml">x</mi><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.1b" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.5" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.5.cmml">t</mi></mrow></msub><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1a" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">⁡</mo><mrow id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.2" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml"><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.2.1" stretchy="false" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">(</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">𝐭</mi><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.2.2" stretchy="false" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.5" xref="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.5.5.1.1.1.1.1.3" xref="S4.E4.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.5.5.1.2" xref="S4.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.5b"><apply id="S4.E4.m1.5.5.1.1.cmml" xref="S4.E4.m1.5.5.1"><eq id="S4.E4.m1.5.5.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.2"></eq><apply id="S4.E4.m1.5.5.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.1.1.3.1.cmml" xref="S4.E4.m1.5.5.1.1.3">superscript</csymbol><ci id="S4.E4.m1.5.5.1.1.3.2.cmml" xref="S4.E4.m1.5.5.1.1.3.2">𝐗</ci><apply id="S4.E4.m1.5.5.1.1.3.3.cmml" xref="S4.E4.m1.5.5.1.1.3.3"><plus id="S4.E4.m1.5.5.1.1.3.3.1.cmml" xref="S4.E4.m1.5.5.1.1.3.3.1"></plus><ci id="S4.E4.m1.5.5.1.1.3.3.2.cmml" xref="S4.E4.m1.5.5.1.1.3.3.2">𝑙</ci><cn id="S4.E4.m1.5.5.1.1.3.3.3.cmml" type="integer" xref="S4.E4.m1.5.5.1.1.3.3.3">1</cn></apply></apply><apply id="S4.E4.m1.5.5.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.1.1"><ci id="S4.E4.m1.4.4.cmml" xref="S4.E4.m1.4.4">FFN</ci><apply id="S4.E4.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2"><ci id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3">CrossAttn</ci><apply id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1"><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">SelfAttn</ci><apply id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐗</ci><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1"><apply id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1">subscript</csymbol><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.2">CLIP</ci><apply id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3"><times id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.1"></times><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.2">𝑡</ci><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.3.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.3">𝑒</ci><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.4.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.4">𝑥</ci><ci id="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.5.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1.1.2.2.2.1.1.3.5">𝑡</ci></apply></apply><ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">𝐭</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.5c">\mathbf{X}^{l+1}={\operatorname{FFN}}\left({\operatorname{CrossAttn}}\left({%
\operatorname{SelfAttn}}\left(\mathbf{X}^{l}\right),\operatorname{CLIP}_{text}%
(\mathbf{t})\right)\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.5d">bold_X start_POSTSUPERSCRIPT italic_l + 1 end_POSTSUPERSCRIPT = roman_FFN ( roman_CrossAttn ( roman_SelfAttn ( bold_X start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) , roman_CLIP start_POSTSUBSCRIPT italic_t italic_e italic_x italic_t end_POSTSUBSCRIPT ( bold_t ) ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.6">where <math alttext="\operatorname{CLIP}_{text}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m1.1"><semantics id="S4.SS1.p1.6.m1.1a"><msub id="S4.SS1.p1.6.m1.1.1" xref="S4.SS1.p1.6.m1.1.1.cmml"><mi id="S4.SS1.p1.6.m1.1.1.2" xref="S4.SS1.p1.6.m1.1.1.2.cmml">CLIP</mi><mrow id="S4.SS1.p1.6.m1.1.1.3" xref="S4.SS1.p1.6.m1.1.1.3.cmml"><mi id="S4.SS1.p1.6.m1.1.1.3.2" xref="S4.SS1.p1.6.m1.1.1.3.2.cmml">t</mi><mo id="S4.SS1.p1.6.m1.1.1.3.1" xref="S4.SS1.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.6.m1.1.1.3.3" xref="S4.SS1.p1.6.m1.1.1.3.3.cmml">e</mi><mo id="S4.SS1.p1.6.m1.1.1.3.1a" xref="S4.SS1.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.6.m1.1.1.3.4" xref="S4.SS1.p1.6.m1.1.1.3.4.cmml">x</mi><mo id="S4.SS1.p1.6.m1.1.1.3.1b" xref="S4.SS1.p1.6.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p1.6.m1.1.1.3.5" xref="S4.SS1.p1.6.m1.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m1.1b"><apply id="S4.SS1.p1.6.m1.1.1.cmml" xref="S4.SS1.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m1.1.1.1.cmml" xref="S4.SS1.p1.6.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m1.1.1.2.cmml" xref="S4.SS1.p1.6.m1.1.1.2">CLIP</ci><apply id="S4.SS1.p1.6.m1.1.1.3.cmml" xref="S4.SS1.p1.6.m1.1.1.3"><times id="S4.SS1.p1.6.m1.1.1.3.1.cmml" xref="S4.SS1.p1.6.m1.1.1.3.1"></times><ci id="S4.SS1.p1.6.m1.1.1.3.2.cmml" xref="S4.SS1.p1.6.m1.1.1.3.2">𝑡</ci><ci id="S4.SS1.p1.6.m1.1.1.3.3.cmml" xref="S4.SS1.p1.6.m1.1.1.3.3">𝑒</ci><ci id="S4.SS1.p1.6.m1.1.1.3.4.cmml" xref="S4.SS1.p1.6.m1.1.1.3.4">𝑥</ci><ci id="S4.SS1.p1.6.m1.1.1.3.5.cmml" xref="S4.SS1.p1.6.m1.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m1.1c">\operatorname{CLIP}_{text}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m1.1d">roman_CLIP start_POSTSUBSCRIPT italic_t italic_e italic_x italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents CLIP text encoder, and we
have skipped over skip-connection in the formula.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">Before considering the incorporation of the support mask, two straightforward and intuitive methods can be leveraged to facilitate interaction between the query image and support image. One approach entails interaction within the self-attention module, while the other involves interaction within the cross-attention module.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.5"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.5.1">KV Fusion Self-Attention.</span>
We first propose a KV fusion method in self-attention layer to achieve interaction between query image and support image.
For the input image feature <math alttext="\mathbf{X}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">𝐗</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝐗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathbf{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">bold_X</annotation></semantics></math>, the standard self-attention layer first maps it to query <math alttext="\mathbf{Q}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">𝐐</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝐐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\mathbf{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">bold_Q</annotation></semantics></math>, key <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">bold_K</annotation></semantics></math> and value <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mi id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><ci id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">bold_V</annotation></semantics></math> with a linear projection layer.
. Therefore, <math alttext="\operatorname{SelfAttn}(\mathbf{X})" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.2"><semantics id="S4.SS1.p3.5.m5.2a"><mrow id="S4.SS1.p3.5.m5.2.3.2" xref="S4.SS1.p3.5.m5.2.3.1.cmml"><mi id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">SelfAttn</mi><mo id="S4.SS1.p3.5.m5.2.3.2a" xref="S4.SS1.p3.5.m5.2.3.1.cmml">⁡</mo><mrow id="S4.SS1.p3.5.m5.2.3.2.1" xref="S4.SS1.p3.5.m5.2.3.1.cmml"><mo id="S4.SS1.p3.5.m5.2.3.2.1.1" stretchy="false" xref="S4.SS1.p3.5.m5.2.3.1.cmml">(</mo><mi id="S4.SS1.p3.5.m5.2.2" xref="S4.SS1.p3.5.m5.2.2.cmml">𝐗</mi><mo id="S4.SS1.p3.5.m5.2.3.2.1.2" stretchy="false" xref="S4.SS1.p3.5.m5.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.2b"><apply id="S4.SS1.p3.5.m5.2.3.1.cmml" xref="S4.SS1.p3.5.m5.2.3.2"><ci id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">SelfAttn</ci><ci id="S4.SS1.p3.5.m5.2.2.cmml" xref="S4.SS1.p3.5.m5.2.2">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.2c">\operatorname{SelfAttn}(\mathbf{X})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.5.m5.2d">roman_SelfAttn ( bold_X )</annotation></semantics></math> can be further represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{X}^{*}=\operatorname{{SelfAttn}}(\mathbf{X})=\operatorname{Attention}(%
\mathbf{Q},\mathbf{K},\mathbf{V})=\operatorname{Softmax}(\frac{\mathbf{Q}%
\mathbf{K}^{T}}{\sqrt{d}})\mathbf{V}" class="ltx_Math" display="block" id="S4.E5.m1.8"><semantics id="S4.E5.m1.8a"><mrow id="S4.E5.m1.8.9" xref="S4.E5.m1.8.9.cmml"><msup id="S4.E5.m1.8.9.2" xref="S4.E5.m1.8.9.2.cmml"><mi id="S4.E5.m1.8.9.2.2" xref="S4.E5.m1.8.9.2.2.cmml">𝐗</mi><mo id="S4.E5.m1.8.9.2.3" xref="S4.E5.m1.8.9.2.3.cmml">∗</mo></msup><mo id="S4.E5.m1.8.9.3" xref="S4.E5.m1.8.9.3.cmml">=</mo><mrow id="S4.E5.m1.8.9.4.2" xref="S4.E5.m1.8.9.4.1.cmml"><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">SelfAttn</mi><mo id="S4.E5.m1.8.9.4.2a" xref="S4.E5.m1.8.9.4.1.cmml">⁡</mo><mrow id="S4.E5.m1.8.9.4.2.1" xref="S4.E5.m1.8.9.4.1.cmml"><mo id="S4.E5.m1.8.9.4.2.1.1" stretchy="false" xref="S4.E5.m1.8.9.4.1.cmml">(</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">𝐗</mi><mo id="S4.E5.m1.8.9.4.2.1.2" stretchy="false" xref="S4.E5.m1.8.9.4.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.8.9.5" xref="S4.E5.m1.8.9.5.cmml">=</mo><mrow id="S4.E5.m1.8.9.6.2" xref="S4.E5.m1.8.9.6.1.cmml"><mi id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">Attention</mi><mo id="S4.E5.m1.8.9.6.2a" xref="S4.E5.m1.8.9.6.1.cmml">⁡</mo><mrow id="S4.E5.m1.8.9.6.2.1" xref="S4.E5.m1.8.9.6.1.cmml"><mo id="S4.E5.m1.8.9.6.2.1.1" stretchy="false" xref="S4.E5.m1.8.9.6.1.cmml">(</mo><mi id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml">𝐐</mi><mo id="S4.E5.m1.8.9.6.2.1.2" xref="S4.E5.m1.8.9.6.1.cmml">,</mo><mi id="S4.E5.m1.5.5" xref="S4.E5.m1.5.5.cmml">𝐊</mi><mo id="S4.E5.m1.8.9.6.2.1.3" xref="S4.E5.m1.8.9.6.1.cmml">,</mo><mi id="S4.E5.m1.6.6" xref="S4.E5.m1.6.6.cmml">𝐕</mi><mo id="S4.E5.m1.8.9.6.2.1.4" stretchy="false" xref="S4.E5.m1.8.9.6.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.8.9.7" xref="S4.E5.m1.8.9.7.cmml">=</mo><mrow id="S4.E5.m1.8.9.8" xref="S4.E5.m1.8.9.8.cmml"><mrow id="S4.E5.m1.8.9.8.2.2" xref="S4.E5.m1.8.9.8.2.1.cmml"><mi id="S4.E5.m1.7.7" xref="S4.E5.m1.7.7.cmml">Softmax</mi><mo id="S4.E5.m1.8.9.8.2.2a" xref="S4.E5.m1.8.9.8.2.1.cmml">⁡</mo><mrow id="S4.E5.m1.8.9.8.2.2.1" xref="S4.E5.m1.8.9.8.2.1.cmml"><mo id="S4.E5.m1.8.9.8.2.2.1.1" stretchy="false" xref="S4.E5.m1.8.9.8.2.1.cmml">(</mo><mfrac id="S4.E5.m1.8.8" xref="S4.E5.m1.8.8.cmml"><msup id="S4.E5.m1.8.8.2" xref="S4.E5.m1.8.8.2.cmml"><mi id="S4.E5.m1.8.8.2.2" xref="S4.E5.m1.8.8.2.2.cmml">𝐐𝐊</mi><mi id="S4.E5.m1.8.8.2.3" xref="S4.E5.m1.8.8.2.3.cmml">T</mi></msup><msqrt id="S4.E5.m1.8.8.3" xref="S4.E5.m1.8.8.3.cmml"><mi id="S4.E5.m1.8.8.3.2" xref="S4.E5.m1.8.8.3.2.cmml">d</mi></msqrt></mfrac><mo id="S4.E5.m1.8.9.8.2.2.1.2" stretchy="false" xref="S4.E5.m1.8.9.8.2.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.8.9.8.1" xref="S4.E5.m1.8.9.8.1.cmml">⁢</mo><mi id="S4.E5.m1.8.9.8.3" xref="S4.E5.m1.8.9.8.3.cmml">𝐕</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.8b"><apply id="S4.E5.m1.8.9.cmml" xref="S4.E5.m1.8.9"><and id="S4.E5.m1.8.9a.cmml" xref="S4.E5.m1.8.9"></and><apply id="S4.E5.m1.8.9b.cmml" xref="S4.E5.m1.8.9"><eq id="S4.E5.m1.8.9.3.cmml" xref="S4.E5.m1.8.9.3"></eq><apply id="S4.E5.m1.8.9.2.cmml" xref="S4.E5.m1.8.9.2"><csymbol cd="ambiguous" id="S4.E5.m1.8.9.2.1.cmml" xref="S4.E5.m1.8.9.2">superscript</csymbol><ci id="S4.E5.m1.8.9.2.2.cmml" xref="S4.E5.m1.8.9.2.2">𝐗</ci><times id="S4.E5.m1.8.9.2.3.cmml" xref="S4.E5.m1.8.9.2.3"></times></apply><apply id="S4.E5.m1.8.9.4.1.cmml" xref="S4.E5.m1.8.9.4.2"><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">SelfAttn</ci><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝐗</ci></apply></apply><apply id="S4.E5.m1.8.9c.cmml" xref="S4.E5.m1.8.9"><eq id="S4.E5.m1.8.9.5.cmml" xref="S4.E5.m1.8.9.5"></eq><share href="https://arxiv.org/html/2410.02369v2#S4.E5.m1.8.9.4.cmml" id="S4.E5.m1.8.9d.cmml" xref="S4.E5.m1.8.9"></share><apply id="S4.E5.m1.8.9.6.1.cmml" xref="S4.E5.m1.8.9.6.2"><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">Attention</ci><ci id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4">𝐐</ci><ci id="S4.E5.m1.5.5.cmml" xref="S4.E5.m1.5.5">𝐊</ci><ci id="S4.E5.m1.6.6.cmml" xref="S4.E5.m1.6.6">𝐕</ci></apply></apply><apply id="S4.E5.m1.8.9e.cmml" xref="S4.E5.m1.8.9"><eq id="S4.E5.m1.8.9.7.cmml" xref="S4.E5.m1.8.9.7"></eq><share href="https://arxiv.org/html/2410.02369v2#S4.E5.m1.8.9.6.cmml" id="S4.E5.m1.8.9f.cmml" xref="S4.E5.m1.8.9"></share><apply id="S4.E5.m1.8.9.8.cmml" xref="S4.E5.m1.8.9.8"><times id="S4.E5.m1.8.9.8.1.cmml" xref="S4.E5.m1.8.9.8.1"></times><apply id="S4.E5.m1.8.9.8.2.1.cmml" xref="S4.E5.m1.8.9.8.2.2"><ci id="S4.E5.m1.7.7.cmml" xref="S4.E5.m1.7.7">Softmax</ci><apply id="S4.E5.m1.8.8.cmml" xref="S4.E5.m1.8.8"><divide id="S4.E5.m1.8.8.1.cmml" xref="S4.E5.m1.8.8"></divide><apply id="S4.E5.m1.8.8.2.cmml" xref="S4.E5.m1.8.8.2"><csymbol cd="ambiguous" id="S4.E5.m1.8.8.2.1.cmml" xref="S4.E5.m1.8.8.2">superscript</csymbol><ci id="S4.E5.m1.8.8.2.2.cmml" xref="S4.E5.m1.8.8.2.2">𝐐𝐊</ci><ci id="S4.E5.m1.8.8.2.3.cmml" xref="S4.E5.m1.8.8.2.3">𝑇</ci></apply><apply id="S4.E5.m1.8.8.3.cmml" xref="S4.E5.m1.8.8.3"><root id="S4.E5.m1.8.8.3a.cmml" xref="S4.E5.m1.8.8.3"></root><ci id="S4.E5.m1.8.8.3.2.cmml" xref="S4.E5.m1.8.8.3.2">𝑑</ci></apply></apply></apply><ci id="S4.E5.m1.8.9.8.3.cmml" xref="S4.E5.m1.8.9.8.3">𝐕</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.8c">\mathbf{X}^{*}=\operatorname{{SelfAttn}}(\mathbf{X})=\operatorname{Attention}(%
\mathbf{Q},\mathbf{K},\mathbf{V})=\operatorname{Softmax}(\frac{\mathbf{Q}%
\mathbf{K}^{T}}{\sqrt{d}})\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.8d">bold_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_SelfAttn ( bold_X ) = roman_Attention ( bold_Q , bold_K , bold_V ) = roman_Softmax ( divide start_ARG bold_QK start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d end_ARG end_ARG ) bold_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.22">where <math alttext="d" class="ltx_Math" display="inline" id="S4.SS1.p3.6.m1.1"><semantics id="S4.SS1.p3.6.m1.1a"><mi id="S4.SS1.p3.6.m1.1.1" xref="S4.SS1.p3.6.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m1.1b"><ci id="S4.SS1.p3.6.m1.1.1.cmml" xref="S4.SS1.p3.6.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.6.m1.1d">italic_d</annotation></semantics></math> is the dimension of query and key, while <math alttext="\mathbf{X}^{*}" class="ltx_Math" display="inline" id="S4.SS1.p3.7.m2.1"><semantics id="S4.SS1.p3.7.m2.1a"><msup id="S4.SS1.p3.7.m2.1.1" xref="S4.SS1.p3.7.m2.1.1.cmml"><mi id="S4.SS1.p3.7.m2.1.1.2" xref="S4.SS1.p3.7.m2.1.1.2.cmml">𝐗</mi><mo id="S4.SS1.p3.7.m2.1.1.3" xref="S4.SS1.p3.7.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m2.1b"><apply id="S4.SS1.p3.7.m2.1.1.cmml" xref="S4.SS1.p3.7.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.7.m2.1.1.1.cmml" xref="S4.SS1.p3.7.m2.1.1">superscript</csymbol><ci id="S4.SS1.p3.7.m2.1.1.2.cmml" xref="S4.SS1.p3.7.m2.1.1.2">𝐗</ci><times id="S4.SS1.p3.7.m2.1.1.3.cmml" xref="S4.SS1.p3.7.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m2.1c">\mathbf{X}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.7.m2.1d">bold_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is the feature updated by self-attention.
Back to our task, we can also map the features of the support image and query image <math alttext="\mathbf{X}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.8.m3.1"><semantics id="S4.SS1.p3.8.m3.1a"><msub id="S4.SS1.p3.8.m3.1.1" xref="S4.SS1.p3.8.m3.1.1.cmml"><mi id="S4.SS1.p3.8.m3.1.1.2" xref="S4.SS1.p3.8.m3.1.1.2.cmml">𝐗</mi><mi id="S4.SS1.p3.8.m3.1.1.3" xref="S4.SS1.p3.8.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m3.1b"><apply id="S4.SS1.p3.8.m3.1.1.cmml" xref="S4.SS1.p3.8.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m3.1.1.1.cmml" xref="S4.SS1.p3.8.m3.1.1">subscript</csymbol><ci id="S4.SS1.p3.8.m3.1.1.2.cmml" xref="S4.SS1.p3.8.m3.1.1.2">𝐗</ci><ci id="S4.SS1.p3.8.m3.1.1.3.cmml" xref="S4.SS1.p3.8.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m3.1c">\mathbf{X}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.8.m3.1d">bold_X start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{X}_{q}" class="ltx_Math" display="inline" id="S4.SS1.p3.9.m4.1"><semantics id="S4.SS1.p3.9.m4.1a"><msub id="S4.SS1.p3.9.m4.1.1" xref="S4.SS1.p3.9.m4.1.1.cmml"><mi id="S4.SS1.p3.9.m4.1.1.2" xref="S4.SS1.p3.9.m4.1.1.2.cmml">𝐗</mi><mi id="S4.SS1.p3.9.m4.1.1.3" xref="S4.SS1.p3.9.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m4.1b"><apply id="S4.SS1.p3.9.m4.1.1.cmml" xref="S4.SS1.p3.9.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m4.1.1.1.cmml" xref="S4.SS1.p3.9.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.9.m4.1.1.2.cmml" xref="S4.SS1.p3.9.m4.1.1.2">𝐗</ci><ci id="S4.SS1.p3.9.m4.1.1.3.cmml" xref="S4.SS1.p3.9.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m4.1c">\mathbf{X}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.9.m4.1d">bold_X start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> to <math alttext="\mathbf{Q}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.10.m5.1"><semantics id="S4.SS1.p3.10.m5.1a"><msub id="S4.SS1.p3.10.m5.1.1" xref="S4.SS1.p3.10.m5.1.1.cmml"><mi id="S4.SS1.p3.10.m5.1.1.2" xref="S4.SS1.p3.10.m5.1.1.2.cmml">𝐐</mi><mi id="S4.SS1.p3.10.m5.1.1.3" xref="S4.SS1.p3.10.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m5.1b"><apply id="S4.SS1.p3.10.m5.1.1.cmml" xref="S4.SS1.p3.10.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.10.m5.1.1.1.cmml" xref="S4.SS1.p3.10.m5.1.1">subscript</csymbol><ci id="S4.SS1.p3.10.m5.1.1.2.cmml" xref="S4.SS1.p3.10.m5.1.1.2">𝐐</ci><ci id="S4.SS1.p3.10.m5.1.1.3.cmml" xref="S4.SS1.p3.10.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m5.1c">\mathbf{Q}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.10.m5.1d">bold_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.11.m6.1"><semantics id="S4.SS1.p3.11.m6.1a"><msub id="S4.SS1.p3.11.m6.1.1" xref="S4.SS1.p3.11.m6.1.1.cmml"><mi id="S4.SS1.p3.11.m6.1.1.2" xref="S4.SS1.p3.11.m6.1.1.2.cmml">𝐊</mi><mi id="S4.SS1.p3.11.m6.1.1.3" xref="S4.SS1.p3.11.m6.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.11.m6.1b"><apply id="S4.SS1.p3.11.m6.1.1.cmml" xref="S4.SS1.p3.11.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.11.m6.1.1.1.cmml" xref="S4.SS1.p3.11.m6.1.1">subscript</csymbol><ci id="S4.SS1.p3.11.m6.1.1.2.cmml" xref="S4.SS1.p3.11.m6.1.1.2">𝐊</ci><ci id="S4.SS1.p3.11.m6.1.1.3.cmml" xref="S4.SS1.p3.11.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.11.m6.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.11.m6.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{V}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.12.m7.1"><semantics id="S4.SS1.p3.12.m7.1a"><msub id="S4.SS1.p3.12.m7.1.1" xref="S4.SS1.p3.12.m7.1.1.cmml"><mi id="S4.SS1.p3.12.m7.1.1.2" xref="S4.SS1.p3.12.m7.1.1.2.cmml">𝐕</mi><mi id="S4.SS1.p3.12.m7.1.1.3" xref="S4.SS1.p3.12.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.12.m7.1b"><apply id="S4.SS1.p3.12.m7.1.1.cmml" xref="S4.SS1.p3.12.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.12.m7.1.1.1.cmml" xref="S4.SS1.p3.12.m7.1.1">subscript</csymbol><ci id="S4.SS1.p3.12.m7.1.1.2.cmml" xref="S4.SS1.p3.12.m7.1.1.2">𝐕</ci><ci id="S4.SS1.p3.12.m7.1.1.3.cmml" xref="S4.SS1.p3.12.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.12.m7.1c">\mathbf{V}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.12.m7.1d">bold_V start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{Q}_{q}" class="ltx_Math" display="inline" id="S4.SS1.p3.13.m8.1"><semantics id="S4.SS1.p3.13.m8.1a"><msub id="S4.SS1.p3.13.m8.1.1" xref="S4.SS1.p3.13.m8.1.1.cmml"><mi id="S4.SS1.p3.13.m8.1.1.2" xref="S4.SS1.p3.13.m8.1.1.2.cmml">𝐐</mi><mi id="S4.SS1.p3.13.m8.1.1.3" xref="S4.SS1.p3.13.m8.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.13.m8.1b"><apply id="S4.SS1.p3.13.m8.1.1.cmml" xref="S4.SS1.p3.13.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.13.m8.1.1.1.cmml" xref="S4.SS1.p3.13.m8.1.1">subscript</csymbol><ci id="S4.SS1.p3.13.m8.1.1.2.cmml" xref="S4.SS1.p3.13.m8.1.1.2">𝐐</ci><ci id="S4.SS1.p3.13.m8.1.1.3.cmml" xref="S4.SS1.p3.13.m8.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.13.m8.1c">\mathbf{Q}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.13.m8.1d">bold_Q start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{K}_{q}" class="ltx_Math" display="inline" id="S4.SS1.p3.14.m9.1"><semantics id="S4.SS1.p3.14.m9.1a"><msub id="S4.SS1.p3.14.m9.1.1" xref="S4.SS1.p3.14.m9.1.1.cmml"><mi id="S4.SS1.p3.14.m9.1.1.2" xref="S4.SS1.p3.14.m9.1.1.2.cmml">𝐊</mi><mi id="S4.SS1.p3.14.m9.1.1.3" xref="S4.SS1.p3.14.m9.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.14.m9.1b"><apply id="S4.SS1.p3.14.m9.1.1.cmml" xref="S4.SS1.p3.14.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.14.m9.1.1.1.cmml" xref="S4.SS1.p3.14.m9.1.1">subscript</csymbol><ci id="S4.SS1.p3.14.m9.1.1.2.cmml" xref="S4.SS1.p3.14.m9.1.1.2">𝐊</ci><ci id="S4.SS1.p3.14.m9.1.1.3.cmml" xref="S4.SS1.p3.14.m9.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.14.m9.1c">\mathbf{K}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.14.m9.1d">bold_K start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{V}_{q}" class="ltx_Math" display="inline" id="S4.SS1.p3.15.m10.1"><semantics id="S4.SS1.p3.15.m10.1a"><msub id="S4.SS1.p3.15.m10.1.1" xref="S4.SS1.p3.15.m10.1.1.cmml"><mi id="S4.SS1.p3.15.m10.1.1.2" xref="S4.SS1.p3.15.m10.1.1.2.cmml">𝐕</mi><mi id="S4.SS1.p3.15.m10.1.1.3" xref="S4.SS1.p3.15.m10.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.15.m10.1b"><apply id="S4.SS1.p3.15.m10.1.1.cmml" xref="S4.SS1.p3.15.m10.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.15.m10.1.1.1.cmml" xref="S4.SS1.p3.15.m10.1.1">subscript</csymbol><ci id="S4.SS1.p3.15.m10.1.1.2.cmml" xref="S4.SS1.p3.15.m10.1.1.2">𝐕</ci><ci id="S4.SS1.p3.15.m10.1.1.3.cmml" xref="S4.SS1.p3.15.m10.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.15.m10.1c">\mathbf{V}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.15.m10.1d">bold_V start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> through the linear projection layer.
We hope that the features of the query image can effectively utilize the information of the support image, so we need to let <math alttext="\mathbf{Q}_{q}" class="ltx_Math" display="inline" id="S4.SS1.p3.16.m11.1"><semantics id="S4.SS1.p3.16.m11.1a"><msub id="S4.SS1.p3.16.m11.1.1" xref="S4.SS1.p3.16.m11.1.1.cmml"><mi id="S4.SS1.p3.16.m11.1.1.2" xref="S4.SS1.p3.16.m11.1.1.2.cmml">𝐐</mi><mi id="S4.SS1.p3.16.m11.1.1.3" xref="S4.SS1.p3.16.m11.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.16.m11.1b"><apply id="S4.SS1.p3.16.m11.1.1.cmml" xref="S4.SS1.p3.16.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.16.m11.1.1.1.cmml" xref="S4.SS1.p3.16.m11.1.1">subscript</csymbol><ci id="S4.SS1.p3.16.m11.1.1.2.cmml" xref="S4.SS1.p3.16.m11.1.1.2">𝐐</ci><ci id="S4.SS1.p3.16.m11.1.1.3.cmml" xref="S4.SS1.p3.16.m11.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.16.m11.1c">\mathbf{Q}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.16.m11.1d">bold_Q start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> access <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.17.m12.1"><semantics id="S4.SS1.p3.17.m12.1a"><msub id="S4.SS1.p3.17.m12.1.1" xref="S4.SS1.p3.17.m12.1.1.cmml"><mi id="S4.SS1.p3.17.m12.1.1.2" xref="S4.SS1.p3.17.m12.1.1.2.cmml">𝐊</mi><mi id="S4.SS1.p3.17.m12.1.1.3" xref="S4.SS1.p3.17.m12.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.17.m12.1b"><apply id="S4.SS1.p3.17.m12.1.1.cmml" xref="S4.SS1.p3.17.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.17.m12.1.1.1.cmml" xref="S4.SS1.p3.17.m12.1.1">subscript</csymbol><ci id="S4.SS1.p3.17.m12.1.1.2.cmml" xref="S4.SS1.p3.17.m12.1.1.2">𝐊</ci><ci id="S4.SS1.p3.17.m12.1.1.3.cmml" xref="S4.SS1.p3.17.m12.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.17.m12.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.17.m12.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{V}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.18.m13.1"><semantics id="S4.SS1.p3.18.m13.1a"><msub id="S4.SS1.p3.18.m13.1.1" xref="S4.SS1.p3.18.m13.1.1.cmml"><mi id="S4.SS1.p3.18.m13.1.1.2" xref="S4.SS1.p3.18.m13.1.1.2.cmml">𝐕</mi><mi id="S4.SS1.p3.18.m13.1.1.3" xref="S4.SS1.p3.18.m13.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.18.m13.1b"><apply id="S4.SS1.p3.18.m13.1.1.cmml" xref="S4.SS1.p3.18.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.18.m13.1.1.1.cmml" xref="S4.SS1.p3.18.m13.1.1">subscript</csymbol><ci id="S4.SS1.p3.18.m13.1.1.2.cmml" xref="S4.SS1.p3.18.m13.1.1.2">𝐕</ci><ci id="S4.SS1.p3.18.m13.1.1.3.cmml" xref="S4.SS1.p3.18.m13.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.18.m13.1c">\mathbf{V}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.18.m13.1d">bold_V start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>. To achieve this, we can concatenate <math alttext="\mathbf{K}_{q}" class="ltx_Math" display="inline" id="S4.SS1.p3.19.m14.1"><semantics id="S4.SS1.p3.19.m14.1a"><msub id="S4.SS1.p3.19.m14.1.1" xref="S4.SS1.p3.19.m14.1.1.cmml"><mi id="S4.SS1.p3.19.m14.1.1.2" xref="S4.SS1.p3.19.m14.1.1.2.cmml">𝐊</mi><mi id="S4.SS1.p3.19.m14.1.1.3" xref="S4.SS1.p3.19.m14.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.19.m14.1b"><apply id="S4.SS1.p3.19.m14.1.1.cmml" xref="S4.SS1.p3.19.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.19.m14.1.1.1.cmml" xref="S4.SS1.p3.19.m14.1.1">subscript</csymbol><ci id="S4.SS1.p3.19.m14.1.1.2.cmml" xref="S4.SS1.p3.19.m14.1.1.2">𝐊</ci><ci id="S4.SS1.p3.19.m14.1.1.3.cmml" xref="S4.SS1.p3.19.m14.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.19.m14.1c">\mathbf{K}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.19.m14.1d">bold_K start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="S4.SS1.p3.20.m15.1"><semantics id="S4.SS1.p3.20.m15.1a"><msub id="S4.SS1.p3.20.m15.1.1" xref="S4.SS1.p3.20.m15.1.1.cmml"><mi id="S4.SS1.p3.20.m15.1.1.2" xref="S4.SS1.p3.20.m15.1.1.2.cmml">𝐊</mi><mi id="S4.SS1.p3.20.m15.1.1.3" xref="S4.SS1.p3.20.m15.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.20.m15.1b"><apply id="S4.SS1.p3.20.m15.1.1.cmml" xref="S4.SS1.p3.20.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.20.m15.1.1.1.cmml" xref="S4.SS1.p3.20.m15.1.1">subscript</csymbol><ci id="S4.SS1.p3.20.m15.1.1.2.cmml" xref="S4.SS1.p3.20.m15.1.1.2">𝐊</ci><ci id="S4.SS1.p3.20.m15.1.1.3.cmml" xref="S4.SS1.p3.20.m15.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.20.m15.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.20.m15.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to form <math alttext="\mathbf{K}_{qs}=[\mathbf{K}_{q},\mathbf{K}_{s}]" class="ltx_Math" display="inline" id="S4.SS1.p3.21.m16.2"><semantics id="S4.SS1.p3.21.m16.2a"><mrow id="S4.SS1.p3.21.m16.2.2" xref="S4.SS1.p3.21.m16.2.2.cmml"><msub id="S4.SS1.p3.21.m16.2.2.4" xref="S4.SS1.p3.21.m16.2.2.4.cmml"><mi id="S4.SS1.p3.21.m16.2.2.4.2" xref="S4.SS1.p3.21.m16.2.2.4.2.cmml">𝐊</mi><mrow id="S4.SS1.p3.21.m16.2.2.4.3" xref="S4.SS1.p3.21.m16.2.2.4.3.cmml"><mi id="S4.SS1.p3.21.m16.2.2.4.3.2" xref="S4.SS1.p3.21.m16.2.2.4.3.2.cmml">q</mi><mo id="S4.SS1.p3.21.m16.2.2.4.3.1" xref="S4.SS1.p3.21.m16.2.2.4.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.21.m16.2.2.4.3.3" xref="S4.SS1.p3.21.m16.2.2.4.3.3.cmml">s</mi></mrow></msub><mo id="S4.SS1.p3.21.m16.2.2.3" xref="S4.SS1.p3.21.m16.2.2.3.cmml">=</mo><mrow id="S4.SS1.p3.21.m16.2.2.2.2" xref="S4.SS1.p3.21.m16.2.2.2.3.cmml"><mo id="S4.SS1.p3.21.m16.2.2.2.2.3" stretchy="false" xref="S4.SS1.p3.21.m16.2.2.2.3.cmml">[</mo><msub id="S4.SS1.p3.21.m16.1.1.1.1.1" xref="S4.SS1.p3.21.m16.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.21.m16.1.1.1.1.1.2" xref="S4.SS1.p3.21.m16.1.1.1.1.1.2.cmml">𝐊</mi><mi id="S4.SS1.p3.21.m16.1.1.1.1.1.3" xref="S4.SS1.p3.21.m16.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.SS1.p3.21.m16.2.2.2.2.4" xref="S4.SS1.p3.21.m16.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p3.21.m16.2.2.2.2.2" xref="S4.SS1.p3.21.m16.2.2.2.2.2.cmml"><mi id="S4.SS1.p3.21.m16.2.2.2.2.2.2" xref="S4.SS1.p3.21.m16.2.2.2.2.2.2.cmml">𝐊</mi><mi id="S4.SS1.p3.21.m16.2.2.2.2.2.3" xref="S4.SS1.p3.21.m16.2.2.2.2.2.3.cmml">s</mi></msub><mo id="S4.SS1.p3.21.m16.2.2.2.2.5" stretchy="false" xref="S4.SS1.p3.21.m16.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.21.m16.2b"><apply id="S4.SS1.p3.21.m16.2.2.cmml" xref="S4.SS1.p3.21.m16.2.2"><eq id="S4.SS1.p3.21.m16.2.2.3.cmml" xref="S4.SS1.p3.21.m16.2.2.3"></eq><apply id="S4.SS1.p3.21.m16.2.2.4.cmml" xref="S4.SS1.p3.21.m16.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p3.21.m16.2.2.4.1.cmml" xref="S4.SS1.p3.21.m16.2.2.4">subscript</csymbol><ci id="S4.SS1.p3.21.m16.2.2.4.2.cmml" xref="S4.SS1.p3.21.m16.2.2.4.2">𝐊</ci><apply id="S4.SS1.p3.21.m16.2.2.4.3.cmml" xref="S4.SS1.p3.21.m16.2.2.4.3"><times id="S4.SS1.p3.21.m16.2.2.4.3.1.cmml" xref="S4.SS1.p3.21.m16.2.2.4.3.1"></times><ci id="S4.SS1.p3.21.m16.2.2.4.3.2.cmml" xref="S4.SS1.p3.21.m16.2.2.4.3.2">𝑞</ci><ci id="S4.SS1.p3.21.m16.2.2.4.3.3.cmml" xref="S4.SS1.p3.21.m16.2.2.4.3.3">𝑠</ci></apply></apply><interval closure="closed" id="S4.SS1.p3.21.m16.2.2.2.3.cmml" xref="S4.SS1.p3.21.m16.2.2.2.2"><apply id="S4.SS1.p3.21.m16.1.1.1.1.1.cmml" xref="S4.SS1.p3.21.m16.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.21.m16.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.21.m16.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.21.m16.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.21.m16.1.1.1.1.1.2">𝐊</ci><ci id="S4.SS1.p3.21.m16.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.21.m16.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.SS1.p3.21.m16.2.2.2.2.2.cmml" xref="S4.SS1.p3.21.m16.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.21.m16.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.21.m16.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.21.m16.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.21.m16.2.2.2.2.2.2">𝐊</ci><ci id="S4.SS1.p3.21.m16.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.21.m16.2.2.2.2.2.3">𝑠</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.21.m16.2c">\mathbf{K}_{qs}=[\mathbf{K}_{q},\mathbf{K}_{s}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.21.m16.2d">bold_K start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT = [ bold_K start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ]</annotation></semantics></math>. Similarly, we can get <math alttext="\mathbf{V}_{qs}=[\mathbf{V}_{q},\mathbf{V}_{s}]" class="ltx_Math" display="inline" id="S4.SS1.p3.22.m17.2"><semantics id="S4.SS1.p3.22.m17.2a"><mrow id="S4.SS1.p3.22.m17.2.2" xref="S4.SS1.p3.22.m17.2.2.cmml"><msub id="S4.SS1.p3.22.m17.2.2.4" xref="S4.SS1.p3.22.m17.2.2.4.cmml"><mi id="S4.SS1.p3.22.m17.2.2.4.2" xref="S4.SS1.p3.22.m17.2.2.4.2.cmml">𝐕</mi><mrow id="S4.SS1.p3.22.m17.2.2.4.3" xref="S4.SS1.p3.22.m17.2.2.4.3.cmml"><mi id="S4.SS1.p3.22.m17.2.2.4.3.2" xref="S4.SS1.p3.22.m17.2.2.4.3.2.cmml">q</mi><mo id="S4.SS1.p3.22.m17.2.2.4.3.1" xref="S4.SS1.p3.22.m17.2.2.4.3.1.cmml">⁢</mo><mi id="S4.SS1.p3.22.m17.2.2.4.3.3" xref="S4.SS1.p3.22.m17.2.2.4.3.3.cmml">s</mi></mrow></msub><mo id="S4.SS1.p3.22.m17.2.2.3" xref="S4.SS1.p3.22.m17.2.2.3.cmml">=</mo><mrow id="S4.SS1.p3.22.m17.2.2.2.2" xref="S4.SS1.p3.22.m17.2.2.2.3.cmml"><mo id="S4.SS1.p3.22.m17.2.2.2.2.3" stretchy="false" xref="S4.SS1.p3.22.m17.2.2.2.3.cmml">[</mo><msub id="S4.SS1.p3.22.m17.1.1.1.1.1" xref="S4.SS1.p3.22.m17.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.22.m17.1.1.1.1.1.2" xref="S4.SS1.p3.22.m17.1.1.1.1.1.2.cmml">𝐕</mi><mi id="S4.SS1.p3.22.m17.1.1.1.1.1.3" xref="S4.SS1.p3.22.m17.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.SS1.p3.22.m17.2.2.2.2.4" xref="S4.SS1.p3.22.m17.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p3.22.m17.2.2.2.2.2" xref="S4.SS1.p3.22.m17.2.2.2.2.2.cmml"><mi id="S4.SS1.p3.22.m17.2.2.2.2.2.2" xref="S4.SS1.p3.22.m17.2.2.2.2.2.2.cmml">𝐕</mi><mi id="S4.SS1.p3.22.m17.2.2.2.2.2.3" xref="S4.SS1.p3.22.m17.2.2.2.2.2.3.cmml">s</mi></msub><mo id="S4.SS1.p3.22.m17.2.2.2.2.5" stretchy="false" xref="S4.SS1.p3.22.m17.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.22.m17.2b"><apply id="S4.SS1.p3.22.m17.2.2.cmml" xref="S4.SS1.p3.22.m17.2.2"><eq id="S4.SS1.p3.22.m17.2.2.3.cmml" xref="S4.SS1.p3.22.m17.2.2.3"></eq><apply id="S4.SS1.p3.22.m17.2.2.4.cmml" xref="S4.SS1.p3.22.m17.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p3.22.m17.2.2.4.1.cmml" xref="S4.SS1.p3.22.m17.2.2.4">subscript</csymbol><ci id="S4.SS1.p3.22.m17.2.2.4.2.cmml" xref="S4.SS1.p3.22.m17.2.2.4.2">𝐕</ci><apply id="S4.SS1.p3.22.m17.2.2.4.3.cmml" xref="S4.SS1.p3.22.m17.2.2.4.3"><times id="S4.SS1.p3.22.m17.2.2.4.3.1.cmml" xref="S4.SS1.p3.22.m17.2.2.4.3.1"></times><ci id="S4.SS1.p3.22.m17.2.2.4.3.2.cmml" xref="S4.SS1.p3.22.m17.2.2.4.3.2">𝑞</ci><ci id="S4.SS1.p3.22.m17.2.2.4.3.3.cmml" xref="S4.SS1.p3.22.m17.2.2.4.3.3">𝑠</ci></apply></apply><interval closure="closed" id="S4.SS1.p3.22.m17.2.2.2.3.cmml" xref="S4.SS1.p3.22.m17.2.2.2.2"><apply id="S4.SS1.p3.22.m17.1.1.1.1.1.cmml" xref="S4.SS1.p3.22.m17.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.22.m17.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.22.m17.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.22.m17.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.22.m17.1.1.1.1.1.2">𝐕</ci><ci id="S4.SS1.p3.22.m17.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.22.m17.1.1.1.1.1.3">𝑞</ci></apply><apply id="S4.SS1.p3.22.m17.2.2.2.2.2.cmml" xref="S4.SS1.p3.22.m17.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.22.m17.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.22.m17.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.22.m17.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.22.m17.2.2.2.2.2.2">𝐕</ci><ci id="S4.SS1.p3.22.m17.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.22.m17.2.2.2.2.2.3">𝑠</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.22.m17.2c">\mathbf{V}_{qs}=[\mathbf{V}_{q},\mathbf{V}_{s}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.22.m17.2d">bold_V start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT = [ bold_V start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_V start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ]</annotation></semantics></math>.
Finally, our KV Fusion Self-Attention layer can be represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{X}^{*}_{q}=\operatorname{FusionAttn}(\mathbf{X}_{q},\mathbf{X}_{s})=%
\operatorname{Attention}(\mathbf{Q}_{q},\mathbf{K}_{qs},\mathbf{V}_{qs})" class="ltx_Math" display="block" id="S4.E6.m1.7"><semantics id="S4.E6.m1.7a"><mrow id="S4.E6.m1.7.7" xref="S4.E6.m1.7.7.cmml"><msubsup id="S4.E6.m1.7.7.7" xref="S4.E6.m1.7.7.7.cmml"><mi id="S4.E6.m1.7.7.7.2.2" xref="S4.E6.m1.7.7.7.2.2.cmml">𝐗</mi><mi id="S4.E6.m1.7.7.7.3" xref="S4.E6.m1.7.7.7.3.cmml">q</mi><mo id="S4.E6.m1.7.7.7.2.3" xref="S4.E6.m1.7.7.7.2.3.cmml">∗</mo></msubsup><mo id="S4.E6.m1.7.7.8" xref="S4.E6.m1.7.7.8.cmml">=</mo><mrow id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.3.cmml"><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">FusionAttn</mi><mo id="S4.E6.m1.4.4.2.2a" xref="S4.E6.m1.4.4.2.3.cmml">⁡</mo><mrow id="S4.E6.m1.4.4.2.2.2" xref="S4.E6.m1.4.4.2.3.cmml"><mo id="S4.E6.m1.4.4.2.2.2.3" stretchy="false" xref="S4.E6.m1.4.4.2.3.cmml">(</mo><msub id="S4.E6.m1.3.3.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.2.cmml">𝐗</mi><mi id="S4.E6.m1.3.3.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.3.cmml">q</mi></msub><mo id="S4.E6.m1.4.4.2.2.2.4" xref="S4.E6.m1.4.4.2.3.cmml">,</mo><msub id="S4.E6.m1.4.4.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.2.cmml"><mi id="S4.E6.m1.4.4.2.2.2.2.2" xref="S4.E6.m1.4.4.2.2.2.2.2.cmml">𝐗</mi><mi id="S4.E6.m1.4.4.2.2.2.2.3" xref="S4.E6.m1.4.4.2.2.2.2.3.cmml">s</mi></msub><mo id="S4.E6.m1.4.4.2.2.2.5" stretchy="false" xref="S4.E6.m1.4.4.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.7.7.9" xref="S4.E6.m1.7.7.9.cmml">=</mo><mrow id="S4.E6.m1.7.7.5.3" xref="S4.E6.m1.7.7.5.4.cmml"><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">Attention</mi><mo id="S4.E6.m1.7.7.5.3a" xref="S4.E6.m1.7.7.5.4.cmml">⁡</mo><mrow id="S4.E6.m1.7.7.5.3.3" xref="S4.E6.m1.7.7.5.4.cmml"><mo id="S4.E6.m1.7.7.5.3.3.4" stretchy="false" xref="S4.E6.m1.7.7.5.4.cmml">(</mo><msub id="S4.E6.m1.5.5.3.1.1.1" xref="S4.E6.m1.5.5.3.1.1.1.cmml"><mi id="S4.E6.m1.5.5.3.1.1.1.2" xref="S4.E6.m1.5.5.3.1.1.1.2.cmml">𝐐</mi><mi id="S4.E6.m1.5.5.3.1.1.1.3" xref="S4.E6.m1.5.5.3.1.1.1.3.cmml">q</mi></msub><mo id="S4.E6.m1.7.7.5.3.3.5" xref="S4.E6.m1.7.7.5.4.cmml">,</mo><msub id="S4.E6.m1.6.6.4.2.2.2" xref="S4.E6.m1.6.6.4.2.2.2.cmml"><mi id="S4.E6.m1.6.6.4.2.2.2.2" xref="S4.E6.m1.6.6.4.2.2.2.2.cmml">𝐊</mi><mrow id="S4.E6.m1.6.6.4.2.2.2.3" xref="S4.E6.m1.6.6.4.2.2.2.3.cmml"><mi id="S4.E6.m1.6.6.4.2.2.2.3.2" xref="S4.E6.m1.6.6.4.2.2.2.3.2.cmml">q</mi><mo id="S4.E6.m1.6.6.4.2.2.2.3.1" xref="S4.E6.m1.6.6.4.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E6.m1.6.6.4.2.2.2.3.3" xref="S4.E6.m1.6.6.4.2.2.2.3.3.cmml">s</mi></mrow></msub><mo id="S4.E6.m1.7.7.5.3.3.6" xref="S4.E6.m1.7.7.5.4.cmml">,</mo><msub id="S4.E6.m1.7.7.5.3.3.3" xref="S4.E6.m1.7.7.5.3.3.3.cmml"><mi id="S4.E6.m1.7.7.5.3.3.3.2" xref="S4.E6.m1.7.7.5.3.3.3.2.cmml">𝐕</mi><mrow id="S4.E6.m1.7.7.5.3.3.3.3" xref="S4.E6.m1.7.7.5.3.3.3.3.cmml"><mi id="S4.E6.m1.7.7.5.3.3.3.3.2" xref="S4.E6.m1.7.7.5.3.3.3.3.2.cmml">q</mi><mo id="S4.E6.m1.7.7.5.3.3.3.3.1" xref="S4.E6.m1.7.7.5.3.3.3.3.1.cmml">⁢</mo><mi id="S4.E6.m1.7.7.5.3.3.3.3.3" xref="S4.E6.m1.7.7.5.3.3.3.3.3.cmml">s</mi></mrow></msub><mo id="S4.E6.m1.7.7.5.3.3.7" stretchy="false" xref="S4.E6.m1.7.7.5.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.7b"><apply id="S4.E6.m1.7.7.cmml" xref="S4.E6.m1.7.7"><and id="S4.E6.m1.7.7a.cmml" xref="S4.E6.m1.7.7"></and><apply id="S4.E6.m1.7.7b.cmml" xref="S4.E6.m1.7.7"><eq id="S4.E6.m1.7.7.8.cmml" xref="S4.E6.m1.7.7.8"></eq><apply id="S4.E6.m1.7.7.7.cmml" xref="S4.E6.m1.7.7.7"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.7.1.cmml" xref="S4.E6.m1.7.7.7">subscript</csymbol><apply id="S4.E6.m1.7.7.7.2.cmml" xref="S4.E6.m1.7.7.7"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.7.2.1.cmml" xref="S4.E6.m1.7.7.7">superscript</csymbol><ci id="S4.E6.m1.7.7.7.2.2.cmml" xref="S4.E6.m1.7.7.7.2.2">𝐗</ci><times id="S4.E6.m1.7.7.7.2.3.cmml" xref="S4.E6.m1.7.7.7.2.3"></times></apply><ci id="S4.E6.m1.7.7.7.3.cmml" xref="S4.E6.m1.7.7.7.3">𝑞</ci></apply><apply id="S4.E6.m1.4.4.2.3.cmml" xref="S4.E6.m1.4.4.2.2"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">FusionAttn</ci><apply id="S4.E6.m1.3.3.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.3.3.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.3.3.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.2">𝐗</ci><ci id="S4.E6.m1.3.3.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.3">𝑞</ci></apply><apply id="S4.E6.m1.4.4.2.2.2.2.cmml" xref="S4.E6.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.2.2.2.2.1.cmml" xref="S4.E6.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S4.E6.m1.4.4.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.2.2.2.2.2">𝐗</ci><ci id="S4.E6.m1.4.4.2.2.2.2.3.cmml" xref="S4.E6.m1.4.4.2.2.2.2.3">𝑠</ci></apply></apply></apply><apply id="S4.E6.m1.7.7c.cmml" xref="S4.E6.m1.7.7"><eq id="S4.E6.m1.7.7.9.cmml" xref="S4.E6.m1.7.7.9"></eq><share href="https://arxiv.org/html/2410.02369v2#S4.E6.m1.4.4.2.cmml" id="S4.E6.m1.7.7d.cmml" xref="S4.E6.m1.7.7"></share><apply id="S4.E6.m1.7.7.5.4.cmml" xref="S4.E6.m1.7.7.5.3"><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">Attention</ci><apply id="S4.E6.m1.5.5.3.1.1.1.cmml" xref="S4.E6.m1.5.5.3.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.3.1.1.1.1.cmml" xref="S4.E6.m1.5.5.3.1.1.1">subscript</csymbol><ci id="S4.E6.m1.5.5.3.1.1.1.2.cmml" xref="S4.E6.m1.5.5.3.1.1.1.2">𝐐</ci><ci id="S4.E6.m1.5.5.3.1.1.1.3.cmml" xref="S4.E6.m1.5.5.3.1.1.1.3">𝑞</ci></apply><apply id="S4.E6.m1.6.6.4.2.2.2.cmml" xref="S4.E6.m1.6.6.4.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.6.6.4.2.2.2.1.cmml" xref="S4.E6.m1.6.6.4.2.2.2">subscript</csymbol><ci id="S4.E6.m1.6.6.4.2.2.2.2.cmml" xref="S4.E6.m1.6.6.4.2.2.2.2">𝐊</ci><apply id="S4.E6.m1.6.6.4.2.2.2.3.cmml" xref="S4.E6.m1.6.6.4.2.2.2.3"><times id="S4.E6.m1.6.6.4.2.2.2.3.1.cmml" xref="S4.E6.m1.6.6.4.2.2.2.3.1"></times><ci id="S4.E6.m1.6.6.4.2.2.2.3.2.cmml" xref="S4.E6.m1.6.6.4.2.2.2.3.2">𝑞</ci><ci id="S4.E6.m1.6.6.4.2.2.2.3.3.cmml" xref="S4.E6.m1.6.6.4.2.2.2.3.3">𝑠</ci></apply></apply><apply id="S4.E6.m1.7.7.5.3.3.3.cmml" xref="S4.E6.m1.7.7.5.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.7.7.5.3.3.3.1.cmml" xref="S4.E6.m1.7.7.5.3.3.3">subscript</csymbol><ci id="S4.E6.m1.7.7.5.3.3.3.2.cmml" xref="S4.E6.m1.7.7.5.3.3.3.2">𝐕</ci><apply id="S4.E6.m1.7.7.5.3.3.3.3.cmml" xref="S4.E6.m1.7.7.5.3.3.3.3"><times id="S4.E6.m1.7.7.5.3.3.3.3.1.cmml" xref="S4.E6.m1.7.7.5.3.3.3.3.1"></times><ci id="S4.E6.m1.7.7.5.3.3.3.3.2.cmml" xref="S4.E6.m1.7.7.5.3.3.3.3.2">𝑞</ci><ci id="S4.E6.m1.7.7.5.3.3.3.3.3.cmml" xref="S4.E6.m1.7.7.5.3.3.3.3.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.7c">\mathbf{X}^{*}_{q}=\operatorname{FusionAttn}(\mathbf{X}_{q},\mathbf{X}_{s})=%
\operatorname{Attention}(\mathbf{Q}_{q},\mathbf{K}_{qs},\mathbf{V}_{qs})</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.7d">bold_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = roman_FusionAttn ( bold_X start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_X start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) = roman_Attention ( bold_Q start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_K start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT , bold_V start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.24">Since we only replaced <math alttext="\mathbf{K}" class="ltx_Math" display="inline" id="S4.SS1.p3.23.m1.1"><semantics id="S4.SS1.p3.23.m1.1a"><mi id="S4.SS1.p3.23.m1.1.1" xref="S4.SS1.p3.23.m1.1.1.cmml">𝐊</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.23.m1.1b"><ci id="S4.SS1.p3.23.m1.1.1.cmml" xref="S4.SS1.p3.23.m1.1.1">𝐊</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.23.m1.1c">\mathbf{K}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.23.m1.1d">bold_K</annotation></semantics></math> and <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S4.SS1.p3.24.m2.1"><semantics id="S4.SS1.p3.24.m2.1a"><mi id="S4.SS1.p3.24.m2.1.1" xref="S4.SS1.p3.24.m2.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.24.m2.1b"><ci id="S4.SS1.p3.24.m2.1.1.cmml" xref="S4.SS1.p3.24.m2.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.24.m2.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.24.m2.1d">bold_V</annotation></semantics></math>, we can fully reuse the weights of the original self-attention.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.3"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.3.1">Tokenized Interaction Cross-Attention </span> The second alternative is to inject information originating from the support image via cross-attention. This strategy has been widely used in Customized Text-to-Image Generation <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib40" title="">40</a>]</cite>.
In particular, the initial cross-attention is employed to introduce the text information, encoded using CLIP text encoder. We can encode the support image into a series of tokens using the CLIP image encoder and utilize it as the cross-attention input. At this point, the process can be represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{X_{q}}^{*}=\operatorname{CrossAttn}(\mathbf{X_{q}},\operatorname{%
Flatten}({\rm CLIP}_{img}(\mathbf{I}_{s})))" class="ltx_Math" display="block" id="S4.E7.m1.4"><semantics id="S4.E7.m1.4a"><mrow id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml"><mmultiscripts id="S4.E7.m1.4.4.4" xref="S4.E7.m1.4.4.4.cmml"><mi id="S4.E7.m1.4.4.4.2.2" xref="S4.E7.m1.4.4.4.2.2.cmml">𝐗</mi><mi id="S4.E7.m1.4.4.4.2.3" xref="S4.E7.m1.4.4.4.2.3.cmml">𝐪</mi><mrow id="S4.E7.m1.4.4.4a" xref="S4.E7.m1.4.4.4.cmml"></mrow><mrow id="S4.E7.m1.4.4.4b" xref="S4.E7.m1.4.4.4.cmml"></mrow><mo id="S4.E7.m1.4.4.4.3" xref="S4.E7.m1.4.4.4.3.cmml">∗</mo></mmultiscripts><mo id="S4.E7.m1.4.4.3" xref="S4.E7.m1.4.4.3.cmml">=</mo><mrow id="S4.E7.m1.4.4.2.2" xref="S4.E7.m1.4.4.2.3.cmml"><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">CrossAttn</mi><mo id="S4.E7.m1.4.4.2.2a" xref="S4.E7.m1.4.4.2.3.cmml">⁡</mo><mrow id="S4.E7.m1.4.4.2.2.2" xref="S4.E7.m1.4.4.2.3.cmml"><mo id="S4.E7.m1.4.4.2.2.2.3" stretchy="false" xref="S4.E7.m1.4.4.2.3.cmml">(</mo><msub id="S4.E7.m1.3.3.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.2.cmml">𝐗</mi><mi id="S4.E7.m1.3.3.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.3.cmml">𝐪</mi></msub><mo id="S4.E7.m1.4.4.2.2.2.4" xref="S4.E7.m1.4.4.2.3.cmml">,</mo><mrow id="S4.E7.m1.4.4.2.2.2.2.1" xref="S4.E7.m1.4.4.2.2.2.2.2.cmml"><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">Flatten</mi><mo id="S4.E7.m1.4.4.2.2.2.2.1a" xref="S4.E7.m1.4.4.2.2.2.2.2.cmml">⁡</mo><mrow id="S4.E7.m1.4.4.2.2.2.2.1.1" xref="S4.E7.m1.4.4.2.2.2.2.2.cmml"><mo id="S4.E7.m1.4.4.2.2.2.2.1.1.2" stretchy="false" xref="S4.E7.m1.4.4.2.2.2.2.2.cmml">(</mo><mrow id="S4.E7.m1.4.4.2.2.2.2.1.1.1" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.cmml"><msub id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.2" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.2.cmml">CLIP</mi><mrow id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.cmml"><mi id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.2" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.2.cmml">i</mi><mo id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.1" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.3" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.3.cmml">m</mi><mo id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.1a" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.4" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.4.cmml">g</mi></mrow></msub><mo id="S4.E7.m1.4.4.2.2.2.2.1.1.1.2" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.2" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.2.cmml">𝐈</mi><mi id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.4.4.2.2.2.2.1.1.3" stretchy="false" xref="S4.E7.m1.4.4.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.4.4.2.2.2.5" stretchy="false" xref="S4.E7.m1.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.4b"><apply id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4"><eq id="S4.E7.m1.4.4.3.cmml" xref="S4.E7.m1.4.4.3"></eq><apply id="S4.E7.m1.4.4.4.cmml" xref="S4.E7.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.1.cmml" xref="S4.E7.m1.4.4.4">superscript</csymbol><apply id="S4.E7.m1.4.4.4.2.cmml" xref="S4.E7.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.2.1.cmml" xref="S4.E7.m1.4.4.4">subscript</csymbol><ci id="S4.E7.m1.4.4.4.2.2.cmml" xref="S4.E7.m1.4.4.4.2.2">𝐗</ci><ci id="S4.E7.m1.4.4.4.2.3.cmml" xref="S4.E7.m1.4.4.4.2.3">𝐪</ci></apply><times id="S4.E7.m1.4.4.4.3.cmml" xref="S4.E7.m1.4.4.4.3"></times></apply><apply id="S4.E7.m1.4.4.2.3.cmml" xref="S4.E7.m1.4.4.2.2"><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">CrossAttn</ci><apply id="S4.E7.m1.3.3.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2">𝐗</ci><ci id="S4.E7.m1.3.3.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3">𝐪</ci></apply><apply id="S4.E7.m1.4.4.2.2.2.2.2.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1"><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">Flatten</ci><apply id="S4.E7.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1"><times id="S4.E7.m1.4.4.2.2.2.2.1.1.1.2.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.2"></times><apply id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.2">CLIP</ci><apply id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3"><times id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.1.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.1"></times><ci id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.2.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.2">𝑖</ci><ci id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.3.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.3">𝑚</ci><ci id="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.4.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.3.3.4">𝑔</ci></apply></apply><apply id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.2">𝐈</ci><ci id="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.4.4.2.2.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.4c">\mathbf{X_{q}}^{*}=\operatorname{CrossAttn}(\mathbf{X_{q}},\operatorname{%
Flatten}({\rm CLIP}_{img}(\mathbf{I}_{s})))</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.4d">bold_X start_POSTSUBSCRIPT bold_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_CrossAttn ( bold_X start_POSTSUBSCRIPT bold_q end_POSTSUBSCRIPT , roman_Flatten ( roman_CLIP start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT ( bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p4.2">where <math alttext="\operatorname{Flatten}" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">Flatten</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">Flatten</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\operatorname{Flatten}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">roman_Flatten</annotation></semantics></math> means flattening the token sequence after image encoding. <math alttext="{\rm CLIP}_{img}" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2.1"><semantics id="S4.SS1.p4.2.m2.1a"><msub id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">CLIP</mi><mrow id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml"><mi id="S4.SS1.p4.2.m2.1.1.3.2" xref="S4.SS1.p4.2.m2.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p4.2.m2.1.1.3.1" xref="S4.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p4.2.m2.1.1.3.3" xref="S4.SS1.p4.2.m2.1.1.3.3.cmml">m</mi><mo id="S4.SS1.p4.2.m2.1.1.3.1a" xref="S4.SS1.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.p4.2.m2.1.1.3.4" xref="S4.SS1.p4.2.m2.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2">CLIP</ci><apply id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3"><times id="S4.SS1.p4.2.m2.1.1.3.1.cmml" xref="S4.SS1.p4.2.m2.1.1.3.1"></times><ci id="S4.SS1.p4.2.m2.1.1.3.2.cmml" xref="S4.SS1.p4.2.m2.1.1.3.2">𝑖</ci><ci id="S4.SS1.p4.2.m2.1.1.3.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3.3">𝑚</ci><ci id="S4.SS1.p4.2.m2.1.1.3.4.cmml" xref="S4.SS1.p4.2.m2.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">{\rm CLIP}_{img}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.2.m2.1d">roman_CLIP start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math> represents the CLIP image encoder corresponding to the CLIP text encoder used in the original UNet.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Injection of support mask information</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Building upon the Self-attention kv fusion approach, we investigate methodologies for incorporating support mask information. We categorize the injection methods into four types:</p>
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.1.1.1">a.</span></span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.3"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.3.1">Concatenation</span> The support mask <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><msub id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝐌</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> can be converted into an RGB image, then directly encoded into a latent variable <math alttext="\mathbf{z}_{ms}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.2.m2.1"><semantics id="S4.I1.i1.p1.2.m2.1a"><msub id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml"><mi id="S4.I1.i1.p1.2.m2.1.1.2" xref="S4.I1.i1.p1.2.m2.1.1.2.cmml">𝐳</mi><mrow id="S4.I1.i1.p1.2.m2.1.1.3" xref="S4.I1.i1.p1.2.m2.1.1.3.cmml"><mi id="S4.I1.i1.p1.2.m2.1.1.3.2" xref="S4.I1.i1.p1.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.I1.i1.p1.2.m2.1.1.3.1" xref="S4.I1.i1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.I1.i1.p1.2.m2.1.1.3.3" xref="S4.I1.i1.p1.2.m2.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.2.m2.1b"><apply id="S4.I1.i1.p1.2.m2.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.2.m2.1.1.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.2.m2.1.1.2.cmml" xref="S4.I1.i1.p1.2.m2.1.1.2">𝐳</ci><apply id="S4.I1.i1.p1.2.m2.1.1.3.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3"><times id="S4.I1.i1.p1.2.m2.1.1.3.1.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3.1"></times><ci id="S4.I1.i1.p1.2.m2.1.1.3.2.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S4.I1.i1.p1.2.m2.1.1.3.3.cmml" xref="S4.I1.i1.p1.2.m2.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.2.m2.1c">\mathbf{z}_{ms}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.2.m2.1d">bold_z start_POSTSUBSCRIPT italic_m italic_s end_POSTSUBSCRIPT</annotation></semantics></math> using VAE, which is then concatenated with <math alttext="\mathbf{z}_{s}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.3.m3.1"><semantics id="S4.I1.i1.p1.3.m3.1a"><msub id="S4.I1.i1.p1.3.m3.1.1" xref="S4.I1.i1.p1.3.m3.1.1.cmml"><mi id="S4.I1.i1.p1.3.m3.1.1.2" xref="S4.I1.i1.p1.3.m3.1.1.2.cmml">𝐳</mi><mi id="S4.I1.i1.p1.3.m3.1.1.3" xref="S4.I1.i1.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.3.m3.1b"><apply id="S4.I1.i1.p1.3.m3.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.3.m3.1.1.1.cmml" xref="S4.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.3.m3.1.1.2.cmml" xref="S4.I1.i1.p1.3.m3.1.1.2">𝐳</ci><ci id="S4.I1.i1.p1.3.m3.1.1.3.cmml" xref="S4.I1.i1.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.3.m3.1c">\mathbf{z}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.3.m3.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> in the channel dimension. Due to the resulting mismatch in dimensionality from the concatenation, we adopt the approach of Marigold <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>]</cite>, where the first layer weight tensor is duplicated and its values are halved.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.1.1.1">b.</span></span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.5"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.5.1">Multiplication</span> We can directly multiply <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><msub id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝐌</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> on the image <math alttext="\mathbf{I}_{s}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><msub id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.2" xref="S4.I1.i2.p1.2.m2.1.1.2.cmml">𝐈</mi><mi id="S4.I1.i2.p1.2.m2.1.1.3" xref="S4.I1.i2.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2">𝐈</ci><ci id="S4.I1.i2.p1.2.m2.1.1.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">\mathbf{I}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to form the image <math alttext="\mathbf{I}_{s}^{*}=\mathbf{I}_{s}\cdot\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><mrow id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><msubsup id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.2.2.2" xref="S4.I1.i2.p1.3.m3.1.1.2.2.2.cmml">𝐈</mi><mi id="S4.I1.i2.p1.3.m3.1.1.2.2.3" xref="S4.I1.i2.p1.3.m3.1.1.2.2.3.cmml">s</mi><mo id="S4.I1.i2.p1.3.m3.1.1.2.3" xref="S4.I1.i2.p1.3.m3.1.1.2.3.cmml">∗</mo></msubsup><mo id="S4.I1.i2.p1.3.m3.1.1.1" xref="S4.I1.i2.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml"><msub id="S4.I1.i2.p1.3.m3.1.1.3.2" xref="S4.I1.i2.p1.3.m3.1.1.3.2.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.3.2.2" xref="S4.I1.i2.p1.3.m3.1.1.3.2.2.cmml">𝐈</mi><mi id="S4.I1.i2.p1.3.m3.1.1.3.2.3" xref="S4.I1.i2.p1.3.m3.1.1.3.2.3.cmml">s</mi></msub><mo id="S4.I1.i2.p1.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S4.I1.i2.p1.3.m3.1.1.3.1.cmml">⋅</mo><msub id="S4.I1.i2.p1.3.m3.1.1.3.3" xref="S4.I1.i2.p1.3.m3.1.1.3.3.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.3.3.2" xref="S4.I1.i2.p1.3.m3.1.1.3.3.2.cmml">𝐌</mi><mi id="S4.I1.i2.p1.3.m3.1.1.3.3.3" xref="S4.I1.i2.p1.3.m3.1.1.3.3.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><eq id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.1"></eq><apply id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.2.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">superscript</csymbol><apply id="S4.I1.i2.p1.3.m3.1.1.2.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.2.2.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.2.2.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2.2.2">𝐈</ci><ci id="S4.I1.i2.p1.3.m3.1.1.2.2.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2.2.3">𝑠</ci></apply><times id="S4.I1.i2.p1.3.m3.1.1.2.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2.3"></times></apply><apply id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3"><ci id="S4.I1.i2.p1.3.m3.1.1.3.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.1">⋅</ci><apply id="S4.I1.i2.p1.3.m3.1.1.3.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.3.2.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.2">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.3.2.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.2.2">𝐈</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.2.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.2.3">𝑠</ci></apply><apply id="S4.I1.i2.p1.3.m3.1.1.3.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.3.3.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.3.3.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.3.2">𝐌</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.3.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">\mathbf{I}_{s}^{*}=\mathbf{I}_{s}\cdot\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ⋅ bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, and finally encode <math alttext="\mathbf{I}_{s}^{*}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.1"><semantics id="S4.I1.i2.p1.4.m4.1a"><msubsup id="S4.I1.i2.p1.4.m4.1.1" xref="S4.I1.i2.p1.4.m4.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.1.1.2.2" xref="S4.I1.i2.p1.4.m4.1.1.2.2.cmml">𝐈</mi><mi id="S4.I1.i2.p1.4.m4.1.1.2.3" xref="S4.I1.i2.p1.4.m4.1.1.2.3.cmml">s</mi><mo id="S4.I1.i2.p1.4.m4.1.1.3" xref="S4.I1.i2.p1.4.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.1b"><apply id="S4.I1.i2.p1.4.m4.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1">superscript</csymbol><apply id="S4.I1.i2.p1.4.m4.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.1.1.2.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.4.m4.1.1.2.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2.2">𝐈</ci><ci id="S4.I1.i2.p1.4.m4.1.1.2.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2.3">𝑠</ci></apply><times id="S4.I1.i2.p1.4.m4.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.1c">\mathbf{I}_{s}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> into a latent variable <math alttext="\mathbf{z}_{s}^{*}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.5.m5.1"><semantics id="S4.I1.i2.p1.5.m5.1a"><msubsup id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.2.2" xref="S4.I1.i2.p1.5.m5.1.1.2.2.cmml">𝐳</mi><mi id="S4.I1.i2.p1.5.m5.1.1.2.3" xref="S4.I1.i2.p1.5.m5.1.1.2.3.cmml">s</mi><mo id="S4.I1.i2.p1.5.m5.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><apply id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.5.m5.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">superscript</csymbol><apply id="S4.I1.i2.p1.5.m5.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.5.m5.1.1.2.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.5.m5.1.1.2.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.2.2">𝐳</ci><ci id="S4.I1.i2.p1.5.m5.1.1.2.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.2.3">𝑠</ci></apply><times id="S4.I1.i2.p1.5.m5.1.1.3.cmml" xref="S4.I1.i2.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">\mathbf{z}_{s}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.5.m5.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> using VAE as the input of UNet.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.1.1.1">c.</span></span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.4"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.4.1">Attention Mask</span> <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1"><semantics id="S4.I1.i3.p1.1.m1.1a"><msub id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="S4.I1.i3.p1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><apply id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.2">𝐌</ci><ci id="S4.I1.i3.p1.1.m1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> can serve as an attention mask to control self-attention, so that only <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.1"><semantics id="S4.I1.i3.p1.2.m2.1a"><msub id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml"><mi id="S4.I1.i3.p1.2.m2.1.1.2" xref="S4.I1.i3.p1.2.m2.1.1.2.cmml">𝐊</mi><mi id="S4.I1.i3.p1.2.m2.1.1.3" xref="S4.I1.i3.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.1b"><apply id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.2.m2.1.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.2.m2.1.1.2.cmml" xref="S4.I1.i3.p1.2.m2.1.1.2">𝐊</ci><ci id="S4.I1.i3.p1.2.m2.1.1.3.cmml" xref="S4.I1.i3.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.m2.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> in the masked region can be accessed by <math alttext="\mathbf{Q}_{q}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.3.m3.1"><semantics id="S4.I1.i3.p1.3.m3.1a"><msub id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml"><mi id="S4.I1.i3.p1.3.m3.1.1.2" xref="S4.I1.i3.p1.3.m3.1.1.2.cmml">𝐐</mi><mi id="S4.I1.i3.p1.3.m3.1.1.3" xref="S4.I1.i3.p1.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><apply id="S4.I1.i3.p1.3.m3.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.3.m3.1.1.2.cmml" xref="S4.I1.i3.p1.3.m3.1.1.2">𝐐</ci><ci id="S4.I1.i3.p1.3.m3.1.1.3.cmml" xref="S4.I1.i3.p1.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">\mathbf{Q}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.3.m3.1d">bold_Q start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>. Since the feature map sizes of different layers are different, we need to resize <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.4.m4.1"><semantics id="S4.I1.i3.p1.4.m4.1a"><msub id="S4.I1.i3.p1.4.m4.1.1" xref="S4.I1.i3.p1.4.m4.1.1.cmml"><mi id="S4.I1.i3.p1.4.m4.1.1.2" xref="S4.I1.i3.p1.4.m4.1.1.2.cmml">𝐌</mi><mi id="S4.I1.i3.p1.4.m4.1.1.3" xref="S4.I1.i3.p1.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m4.1b"><apply id="S4.I1.i3.p1.4.m4.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.4.m4.1.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.4.m4.1.1.2.cmml" xref="S4.I1.i3.p1.4.m4.1.1.2">𝐌</ci><ci id="S4.I1.i3.p1.4.m4.1.1.3.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m4.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.4.m4.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to fit the dimensions of each layer.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.1.1.1">d.</span></span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.5"><span class="ltx_text ltx_font_bold" id="S4.I1.i4.p1.5.1">Addition</span>
Alternatively, <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.1.m1.1"><semantics id="S4.I1.i4.p1.1.m1.1a"><msub id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml"><mi id="S4.I1.i4.p1.1.m1.1.1.2" xref="S4.I1.i4.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="S4.I1.i4.p1.1.m1.1.1.3" xref="S4.I1.i4.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.1.m1.1b"><apply id="S4.I1.i4.p1.1.m1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.1.m1.1.1.1.cmml" xref="S4.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.1.m1.1.1.2.cmml" xref="S4.I1.i4.p1.1.m1.1.1.2">𝐌</ci><ci id="S4.I1.i4.p1.1.m1.1.1.3.cmml" xref="S4.I1.i4.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.1.m1.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> can be directly added to the image <math alttext="\mathbf{I}_{s}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.2.m2.1"><semantics id="S4.I1.i4.p1.2.m2.1a"><msub id="S4.I1.i4.p1.2.m2.1.1" xref="S4.I1.i4.p1.2.m2.1.1.cmml"><mi id="S4.I1.i4.p1.2.m2.1.1.2" xref="S4.I1.i4.p1.2.m2.1.1.2.cmml">𝐈</mi><mi id="S4.I1.i4.p1.2.m2.1.1.3" xref="S4.I1.i4.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.2.m2.1b"><apply id="S4.I1.i4.p1.2.m2.1.1.cmml" xref="S4.I1.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.2.m2.1.1.1.cmml" xref="S4.I1.i4.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.2.m2.1.1.2.cmml" xref="S4.I1.i4.p1.2.m2.1.1.2">𝐈</ci><ci id="S4.I1.i4.p1.2.m2.1.1.3.cmml" xref="S4.I1.i4.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.2.m2.1c">\mathbf{I}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.2.m2.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, generating the image <math alttext="\mathbf{I}_{s}^{*}=0.5\mathbf{I}_{s}+0.5\mathbf{M}_{s}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.3.m3.1"><semantics id="S4.I1.i4.p1.3.m3.1a"><mrow id="S4.I1.i4.p1.3.m3.1.1" xref="S4.I1.i4.p1.3.m3.1.1.cmml"><msubsup id="S4.I1.i4.p1.3.m3.1.1.2" xref="S4.I1.i4.p1.3.m3.1.1.2.cmml"><mi id="S4.I1.i4.p1.3.m3.1.1.2.2.2" xref="S4.I1.i4.p1.3.m3.1.1.2.2.2.cmml">𝐈</mi><mi id="S4.I1.i4.p1.3.m3.1.1.2.2.3" xref="S4.I1.i4.p1.3.m3.1.1.2.2.3.cmml">s</mi><mo id="S4.I1.i4.p1.3.m3.1.1.2.3" xref="S4.I1.i4.p1.3.m3.1.1.2.3.cmml">∗</mo></msubsup><mo id="S4.I1.i4.p1.3.m3.1.1.1" xref="S4.I1.i4.p1.3.m3.1.1.1.cmml">=</mo><mrow id="S4.I1.i4.p1.3.m3.1.1.3" xref="S4.I1.i4.p1.3.m3.1.1.3.cmml"><mrow id="S4.I1.i4.p1.3.m3.1.1.3.2" xref="S4.I1.i4.p1.3.m3.1.1.3.2.cmml"><mn id="S4.I1.i4.p1.3.m3.1.1.3.2.2" xref="S4.I1.i4.p1.3.m3.1.1.3.2.2.cmml">0.5</mn><mo id="S4.I1.i4.p1.3.m3.1.1.3.2.1" xref="S4.I1.i4.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><msub id="S4.I1.i4.p1.3.m3.1.1.3.2.3" xref="S4.I1.i4.p1.3.m3.1.1.3.2.3.cmml"><mi id="S4.I1.i4.p1.3.m3.1.1.3.2.3.2" xref="S4.I1.i4.p1.3.m3.1.1.3.2.3.2.cmml">𝐈</mi><mi id="S4.I1.i4.p1.3.m3.1.1.3.2.3.3" xref="S4.I1.i4.p1.3.m3.1.1.3.2.3.3.cmml">s</mi></msub></mrow><mo id="S4.I1.i4.p1.3.m3.1.1.3.1" xref="S4.I1.i4.p1.3.m3.1.1.3.1.cmml">+</mo><mrow id="S4.I1.i4.p1.3.m3.1.1.3.3" xref="S4.I1.i4.p1.3.m3.1.1.3.3.cmml"><mn id="S4.I1.i4.p1.3.m3.1.1.3.3.2" xref="S4.I1.i4.p1.3.m3.1.1.3.3.2.cmml">0.5</mn><mo id="S4.I1.i4.p1.3.m3.1.1.3.3.1" xref="S4.I1.i4.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><msub id="S4.I1.i4.p1.3.m3.1.1.3.3.3" xref="S4.I1.i4.p1.3.m3.1.1.3.3.3.cmml"><mi id="S4.I1.i4.p1.3.m3.1.1.3.3.3.2" xref="S4.I1.i4.p1.3.m3.1.1.3.3.3.2.cmml">𝐌</mi><mi id="S4.I1.i4.p1.3.m3.1.1.3.3.3.3" xref="S4.I1.i4.p1.3.m3.1.1.3.3.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.3.m3.1b"><apply id="S4.I1.i4.p1.3.m3.1.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1"><eq id="S4.I1.i4.p1.3.m3.1.1.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.1"></eq><apply id="S4.I1.i4.p1.3.m3.1.1.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i4.p1.3.m3.1.1.2.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2">superscript</csymbol><apply id="S4.I1.i4.p1.3.m3.1.1.2.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.I1.i4.p1.3.m3.1.1.2.2.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2">subscript</csymbol><ci id="S4.I1.i4.p1.3.m3.1.1.2.2.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2.2.2">𝐈</ci><ci id="S4.I1.i4.p1.3.m3.1.1.2.2.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2.2.3">𝑠</ci></apply><times id="S4.I1.i4.p1.3.m3.1.1.2.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.2.3"></times></apply><apply id="S4.I1.i4.p1.3.m3.1.1.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3"><plus id="S4.I1.i4.p1.3.m3.1.1.3.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.1"></plus><apply id="S4.I1.i4.p1.3.m3.1.1.3.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.2"><times id="S4.I1.i4.p1.3.m3.1.1.3.2.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.2.1"></times><cn id="S4.I1.i4.p1.3.m3.1.1.3.2.2.cmml" type="float" xref="S4.I1.i4.p1.3.m3.1.1.3.2.2">0.5</cn><apply id="S4.I1.i4.p1.3.m3.1.1.3.2.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.I1.i4.p1.3.m3.1.1.3.2.3.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.2.3">subscript</csymbol><ci id="S4.I1.i4.p1.3.m3.1.1.3.2.3.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.2.3.2">𝐈</ci><ci id="S4.I1.i4.p1.3.m3.1.1.3.2.3.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.2.3.3">𝑠</ci></apply></apply><apply id="S4.I1.i4.p1.3.m3.1.1.3.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.3"><times id="S4.I1.i4.p1.3.m3.1.1.3.3.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.3.1"></times><cn id="S4.I1.i4.p1.3.m3.1.1.3.3.2.cmml" type="float" xref="S4.I1.i4.p1.3.m3.1.1.3.3.2">0.5</cn><apply id="S4.I1.i4.p1.3.m3.1.1.3.3.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.I1.i4.p1.3.m3.1.1.3.3.3.1.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S4.I1.i4.p1.3.m3.1.1.3.3.3.2.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.3.3.2">𝐌</ci><ci id="S4.I1.i4.p1.3.m3.1.1.3.3.3.3.cmml" xref="S4.I1.i4.p1.3.m3.1.1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.3.m3.1c">\mathbf{I}_{s}^{*}=0.5\mathbf{I}_{s}+0.5\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.3.m3.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = 0.5 bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + 0.5 bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>. Following that, <math alttext="\mathbf{I}_{s}^{*}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.4.m4.1"><semantics id="S4.I1.i4.p1.4.m4.1a"><msubsup id="S4.I1.i4.p1.4.m4.1.1" xref="S4.I1.i4.p1.4.m4.1.1.cmml"><mi id="S4.I1.i4.p1.4.m4.1.1.2.2" xref="S4.I1.i4.p1.4.m4.1.1.2.2.cmml">𝐈</mi><mi id="S4.I1.i4.p1.4.m4.1.1.2.3" xref="S4.I1.i4.p1.4.m4.1.1.2.3.cmml">s</mi><mo id="S4.I1.i4.p1.4.m4.1.1.3" xref="S4.I1.i4.p1.4.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.4.m4.1b"><apply id="S4.I1.i4.p1.4.m4.1.1.cmml" xref="S4.I1.i4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.4.m4.1.1.1.cmml" xref="S4.I1.i4.p1.4.m4.1.1">superscript</csymbol><apply id="S4.I1.i4.p1.4.m4.1.1.2.cmml" xref="S4.I1.i4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.4.m4.1.1.2.1.cmml" xref="S4.I1.i4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.4.m4.1.1.2.2.cmml" xref="S4.I1.i4.p1.4.m4.1.1.2.2">𝐈</ci><ci id="S4.I1.i4.p1.4.m4.1.1.2.3.cmml" xref="S4.I1.i4.p1.4.m4.1.1.2.3">𝑠</ci></apply><times id="S4.I1.i4.p1.4.m4.1.1.3.cmml" xref="S4.I1.i4.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.4.m4.1c">\mathbf{I}_{s}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.4.m4.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is encoded into a latent variable <math alttext="\mathbf{z}_{s}^{*}" class="ltx_Math" display="inline" id="S4.I1.i4.p1.5.m5.1"><semantics id="S4.I1.i4.p1.5.m5.1a"><msubsup id="S4.I1.i4.p1.5.m5.1.1" xref="S4.I1.i4.p1.5.m5.1.1.cmml"><mi id="S4.I1.i4.p1.5.m5.1.1.2.2" xref="S4.I1.i4.p1.5.m5.1.1.2.2.cmml">𝐳</mi><mi id="S4.I1.i4.p1.5.m5.1.1.2.3" xref="S4.I1.i4.p1.5.m5.1.1.2.3.cmml">s</mi><mo id="S4.I1.i4.p1.5.m5.1.1.3" xref="S4.I1.i4.p1.5.m5.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.I1.i4.p1.5.m5.1b"><apply id="S4.I1.i4.p1.5.m5.1.1.cmml" xref="S4.I1.i4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.5.m5.1.1.1.cmml" xref="S4.I1.i4.p1.5.m5.1.1">superscript</csymbol><apply id="S4.I1.i4.p1.5.m5.1.1.2.cmml" xref="S4.I1.i4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i4.p1.5.m5.1.1.2.1.cmml" xref="S4.I1.i4.p1.5.m5.1.1">subscript</csymbol><ci id="S4.I1.i4.p1.5.m5.1.1.2.2.cmml" xref="S4.I1.i4.p1.5.m5.1.1.2.2">𝐳</ci><ci id="S4.I1.i4.p1.5.m5.1.1.2.3.cmml" xref="S4.I1.i4.p1.5.m5.1.1.2.3">𝑠</ci></apply><times id="S4.I1.i4.p1.5.m5.1.1.3.cmml" xref="S4.I1.i4.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i4.p1.5.m5.1c">\mathbf{z}_{s}^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i4.p1.5.m5.1d">bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> using VAE, which is then used as the UNet input.</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="261" id="S4.F2.g1" src="x2.png" width="272"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">Exploring the Interaction and Injection Methods</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">For cross-attention tokenized interaction, information of the support mask can also be injected in the same four ways. There are just some slight differences in the implementation details (see the <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS3" title="A.3 Cross-attention tokenized interaction ‣ Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.3</span></a>).</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">We carry out a comparison of two interaction methods (<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS1" title="4.1 Interaction between query and support images ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.1</span></a>) paired with four injection methods (<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS2" title="4.2 Injection of support mask information ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>); these eight combinations are then verified experimentally, and the results are presented in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.F2" title="In 4.2 Injection of support mask information ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">2</span></a>.
Overall, we observe that KV Fusion Self-Attention(FSA) outperforms Tokenized Interaction Cross-Attention(TCA). We attribute this mainly to the preservation and flexible utilization of information from the support image by FSA. Conversely, TCA, which only compresses support image to tokens via the CLIP image encoder, leads to some information loss.
Notably, within the FSA, the Concatenation method surpassed the other three. It offered a more free-form handling of RGB images and MASK information via subsequent learnable convolutional layers, compared to other hard injection methods.
In the case of TCA, the Attention Mask method seems more apt as other operations are actually constrained by the CLIP image encoder. The CLIP image encoder itself is not good at dealing with mask information. Of course, we believe that there is still room for further exploration here, referring to FGVP <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib41" title="">41</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Supervision from query mask</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.4">In <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S3" title="3 Preliminary ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3</span></a>, we mentioned that we encode the query mask <math alttext="\mathbf{M}_{q}" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">𝐌</ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathbf{M}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> into a latent variable <math alttext="\mathbf{z}_{mq}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">𝐳</mi><mrow id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3.2" xref="S4.SS3.p1.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.SS3.p1.2.m2.1.1.3.1" xref="S4.SS3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p1.2.m2.1.1.3.3" xref="S4.SS3.p1.2.m2.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">𝐳</ci><apply id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3"><times id="S4.SS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS3.p1.2.m2.1.1.3.1"></times><ci id="S4.SS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS3.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S4.SS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mathbf{z}_{mq}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, and directly supervise in the latent space. However, <math alttext="\mathbf{M}_{q}\in[0,1]^{H\times W}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.2"><semantics id="S4.SS3.p1.3.m3.2a"><mrow id="S4.SS3.p1.3.m3.2.3" xref="S4.SS3.p1.3.m3.2.3.cmml"><msub id="S4.SS3.p1.3.m3.2.3.2" xref="S4.SS3.p1.3.m3.2.3.2.cmml"><mi id="S4.SS3.p1.3.m3.2.3.2.2" xref="S4.SS3.p1.3.m3.2.3.2.2.cmml">𝐌</mi><mi id="S4.SS3.p1.3.m3.2.3.2.3" xref="S4.SS3.p1.3.m3.2.3.2.3.cmml">q</mi></msub><mo id="S4.SS3.p1.3.m3.2.3.1" xref="S4.SS3.p1.3.m3.2.3.1.cmml">∈</mo><msup id="S4.SS3.p1.3.m3.2.3.3" xref="S4.SS3.p1.3.m3.2.3.3.cmml"><mrow id="S4.SS3.p1.3.m3.2.3.3.2.2" xref="S4.SS3.p1.3.m3.2.3.3.2.1.cmml"><mo id="S4.SS3.p1.3.m3.2.3.3.2.2.1" stretchy="false" xref="S4.SS3.p1.3.m3.2.3.3.2.1.cmml">[</mo><mn id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">0</mn><mo id="S4.SS3.p1.3.m3.2.3.3.2.2.2" xref="S4.SS3.p1.3.m3.2.3.3.2.1.cmml">,</mo><mn id="S4.SS3.p1.3.m3.2.2" xref="S4.SS3.p1.3.m3.2.2.cmml">1</mn><mo id="S4.SS3.p1.3.m3.2.3.3.2.2.3" stretchy="false" xref="S4.SS3.p1.3.m3.2.3.3.2.1.cmml">]</mo></mrow><mrow id="S4.SS3.p1.3.m3.2.3.3.3" xref="S4.SS3.p1.3.m3.2.3.3.3.cmml"><mi id="S4.SS3.p1.3.m3.2.3.3.3.2" xref="S4.SS3.p1.3.m3.2.3.3.3.2.cmml">H</mi><mo id="S4.SS3.p1.3.m3.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS3.p1.3.m3.2.3.3.3.1.cmml">×</mo><mi id="S4.SS3.p1.3.m3.2.3.3.3.3" xref="S4.SS3.p1.3.m3.2.3.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.2b"><apply id="S4.SS3.p1.3.m3.2.3.cmml" xref="S4.SS3.p1.3.m3.2.3"><in id="S4.SS3.p1.3.m3.2.3.1.cmml" xref="S4.SS3.p1.3.m3.2.3.1"></in><apply id="S4.SS3.p1.3.m3.2.3.2.cmml" xref="S4.SS3.p1.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.2.3.2.1.cmml" xref="S4.SS3.p1.3.m3.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.3.m3.2.3.2.2.cmml" xref="S4.SS3.p1.3.m3.2.3.2.2">𝐌</ci><ci id="S4.SS3.p1.3.m3.2.3.2.3.cmml" xref="S4.SS3.p1.3.m3.2.3.2.3">𝑞</ci></apply><apply id="S4.SS3.p1.3.m3.2.3.3.cmml" xref="S4.SS3.p1.3.m3.2.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.2.3.3.1.cmml" xref="S4.SS3.p1.3.m3.2.3.3">superscript</csymbol><interval closure="closed" id="S4.SS3.p1.3.m3.2.3.3.2.1.cmml" xref="S4.SS3.p1.3.m3.2.3.3.2.2"><cn id="S4.SS3.p1.3.m3.1.1.cmml" type="integer" xref="S4.SS3.p1.3.m3.1.1">0</cn><cn id="S4.SS3.p1.3.m3.2.2.cmml" type="integer" xref="S4.SS3.p1.3.m3.2.2">1</cn></interval><apply id="S4.SS3.p1.3.m3.2.3.3.3.cmml" xref="S4.SS3.p1.3.m3.2.3.3.3"><times id="S4.SS3.p1.3.m3.2.3.3.3.1.cmml" xref="S4.SS3.p1.3.m3.2.3.3.3.1"></times><ci id="S4.SS3.p1.3.m3.2.3.3.3.2.cmml" xref="S4.SS3.p1.3.m3.2.3.3.3.2">𝐻</ci><ci id="S4.SS3.p1.3.m3.2.3.3.3.3.cmml" xref="S4.SS3.p1.3.m3.2.3.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.2c">\mathbf{M}_{q}\in[0,1]^{H\times W}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.2d">bold_M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∈ [ 0 , 1 ] start_POSTSUPERSCRIPT italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math> is a two-dimensional mask, while the input of VAE needs to be an RGB image.
Consequently, conversion of <math alttext="\mathbf{M}_{q}" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><msub id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">𝐌</mi><mi id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">𝐌</ci><ci id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\mathbf{M}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">bold_M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> into an RGB image becomes necessary, but it’s unclear which form of conversion would yield optimal results as no research has delved into this as yet.
A reasonable conversion method should satisfy the following two conditions:1. It is easier for UNet to learn 2. It is more convenient to get the final segmentation result through post-processing.
In this section, we explore the following four forms of conversion.</p>
<ol class="ltx_enumerate" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.1.1.1">a.</span></span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">White foreground + black background</span> Visualizing the segmentation annotation with a white mask and black background is a common way in the academic community. Specifically, we only need to replicate <math alttext="\mathbf{M}_{q}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.1.m1.1"><semantics id="S4.I2.i1.p1.1.m1.1a"><msub id="S4.I2.i1.p1.1.m1.1.1" xref="S4.I2.i1.p1.1.m1.1.1.cmml"><mi id="S4.I2.i1.p1.1.m1.1.1.2" xref="S4.I2.i1.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="S4.I2.i1.p1.1.m1.1.1.3" xref="S4.I2.i1.p1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i1.p1.1.m1.1b"><apply id="S4.I2.i1.p1.1.m1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I2.i1.p1.1.m1.1.1.1.cmml" xref="S4.I2.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I2.i1.p1.1.m1.1.1.2.cmml" xref="S4.I2.i1.p1.1.m1.1.1.2">𝐌</ci><ci id="S4.I2.i1.p1.1.m1.1.1.3.cmml" xref="S4.I2.i1.p1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i1.p1.1.m1.1c">\mathbf{M}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i1.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> three thrice along the channel dimension to form the corresponding RGB image denoted by the mask. We employed this conversion approach as a default in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS2" title="4.2 Injection of support mask information ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.1.1.1">b.</span></span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">Real foreground + black background</span>
Considering LDM’s original pre-training on real images, forcing the model to output purely black-and-white images that do not fit within real-image distribution might amplify the model’s learning difficulty. Therefore, we also attempted to retain the real pixels of the foreground, while setting the background to black</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.1.1.1">c.</span></span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">Black foreground + real background</span> Following the same logic, we also try preserving the pixels of the real background but render the foreground pixel black.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I2.i4.1.1.1">d.</span></span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i4.p1.1.1">Adding mask on real image</span> We also consider overlaying <math alttext="\mathbf{M}_{q}" class="ltx_Math" display="inline" id="S4.I2.i4.p1.1.m1.1"><semantics id="S4.I2.i4.p1.1.m1.1a"><msub id="S4.I2.i4.p1.1.m1.1.1" xref="S4.I2.i4.p1.1.m1.1.1.cmml"><mi id="S4.I2.i4.p1.1.m1.1.1.2" xref="S4.I2.i4.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="S4.I2.i4.p1.1.m1.1.1.3" xref="S4.I2.i4.p1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I2.i4.p1.1.m1.1b"><apply id="S4.I2.i4.p1.1.m1.1.1.cmml" xref="S4.I2.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I2.i4.p1.1.m1.1.1.1.cmml" xref="S4.I2.i4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I2.i4.p1.1.m1.1.1.2.cmml" xref="S4.I2.i4.p1.1.m1.1.1.2">𝐌</ci><ci id="S4.I2.i4.p1.1.m1.1.1.3.cmml" xref="S4.I2.i4.p1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i4.p1.1.m1.1c">\mathbf{M}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.I2.i4.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> on the real image to form the mask on the real image, which is the Addition method mentioned in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS2" title="4.2 Injection of support mask information ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>. This approach makes the output space of UNet closer to the distribution of real images, but it requires more complex post-processing to get the final segmentation results. That is, we need to subtract the original image from the model output to get the final segmentation result.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.F3" title="In 4.3 Supervision from query mask ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">3</span></a>, we assess the performance of the four forms of supervision, among which (a) method achieved the best performance in all experiments.
Although (b) (c) (d) methods being closer to the real image distribution, the performance is lower.
On the one hand, it is difficult to obtain the mask through simple post-processing, and on the other hand, it may increase the learning difficulty because the model needs to retain the ability to generate the original image.
In conclusion, our results demonstrate that UNetUNet can effortlessly learn to output in forms such as ‘white foreground + black background’. Therefore, we eventually chose this approach for Diffews.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="220" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Illustrations and comparisons of different forms of supervision from query mask.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Exploration of generation process</h3>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="343" id="S4.F4.g1" src="x4.png" width="824"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S4.F4.3.2" style="font-size:90%;">Illustrations and comparisons of different mask generation processes.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In this section, we further discuss how to design an effective generation process to transfer the pre-trained diffusion models to mask prediction tasks. Inspired by the success of transferring pre-trained diffusion models to depth estimation task <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib42" title="">42</a>]</cite>, we explore three different mask generation processes. The illustration of different mask generation processes is shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.F4" title="In 4.4 Exploration of generation process ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<ul class="ltx_itemize" id="S4.I3">
<li class="ltx_item" id="S4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i1.p1">
<p class="ltx_p" id="S4.I3.i1.p1.5"><span class="ltx_text ltx_font_bold" id="S4.I3.i1.p1.5.1">Multi-step noise-to-mask generation (MN2M)</span> MN2M follows the denoise pipeline of original diffusion models. The training and inference schemes of MN2M are similar to Marigold <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>]</cite>. <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.F4" title="In 4.4 Exploration of generation process ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>(b1) shows the illustration of inference process. The image latent <math alttext="z_{q}" class="ltx_Math" display="inline" id="S4.I3.i1.p1.1.m1.1"><semantics id="S4.I3.i1.p1.1.m1.1a"><msub id="S4.I3.i1.p1.1.m1.1.1" xref="S4.I3.i1.p1.1.m1.1.1.cmml"><mi id="S4.I3.i1.p1.1.m1.1.1.2" xref="S4.I3.i1.p1.1.m1.1.1.2.cmml">z</mi><mi id="S4.I3.i1.p1.1.m1.1.1.3" xref="S4.I3.i1.p1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i1.p1.1.m1.1b"><apply id="S4.I3.i1.p1.1.m1.1.1.cmml" xref="S4.I3.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I3.i1.p1.1.m1.1.1.1.cmml" xref="S4.I3.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I3.i1.p1.1.m1.1.1.2.cmml" xref="S4.I3.i1.p1.1.m1.1.1.2">𝑧</ci><ci id="S4.I3.i1.p1.1.m1.1.1.3.cmml" xref="S4.I3.i1.p1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i1.p1.1.m1.1c">z_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i1.p1.1.m1.1d">italic_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> concatenates with the mask latent <math alttext="\hat{\textbf{z}}_{mq}^{(t)}" class="ltx_Math" display="inline" id="S4.I3.i1.p1.2.m2.1"><semantics id="S4.I3.i1.p1.2.m2.1a"><msubsup id="S4.I3.i1.p1.2.m2.1.2" xref="S4.I3.i1.p1.2.m2.1.2.cmml"><mover accent="true" id="S4.I3.i1.p1.2.m2.1.2.2.2" xref="S4.I3.i1.p1.2.m2.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i1.p1.2.m2.1.2.2.2.2" xref="S4.I3.i1.p1.2.m2.1.2.2.2.2a.cmml">z</mtext><mo id="S4.I3.i1.p1.2.m2.1.2.2.2.1" xref="S4.I3.i1.p1.2.m2.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.I3.i1.p1.2.m2.1.2.2.3" xref="S4.I3.i1.p1.2.m2.1.2.2.3.cmml"><mi id="S4.I3.i1.p1.2.m2.1.2.2.3.2" xref="S4.I3.i1.p1.2.m2.1.2.2.3.2.cmml">m</mi><mo id="S4.I3.i1.p1.2.m2.1.2.2.3.1" xref="S4.I3.i1.p1.2.m2.1.2.2.3.1.cmml">⁢</mo><mi id="S4.I3.i1.p1.2.m2.1.2.2.3.3" xref="S4.I3.i1.p1.2.m2.1.2.2.3.3.cmml">q</mi></mrow><mrow id="S4.I3.i1.p1.2.m2.1.1.1.3" xref="S4.I3.i1.p1.2.m2.1.2.cmml"><mo id="S4.I3.i1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S4.I3.i1.p1.2.m2.1.2.cmml">(</mo><mi id="S4.I3.i1.p1.2.m2.1.1.1.1" xref="S4.I3.i1.p1.2.m2.1.1.1.1.cmml">t</mi><mo id="S4.I3.i1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S4.I3.i1.p1.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I3.i1.p1.2.m2.1b"><apply id="S4.I3.i1.p1.2.m2.1.2.cmml" xref="S4.I3.i1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.I3.i1.p1.2.m2.1.2.1.cmml" xref="S4.I3.i1.p1.2.m2.1.2">superscript</csymbol><apply id="S4.I3.i1.p1.2.m2.1.2.2.cmml" xref="S4.I3.i1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S4.I3.i1.p1.2.m2.1.2.2.1.cmml" xref="S4.I3.i1.p1.2.m2.1.2">subscript</csymbol><apply id="S4.I3.i1.p1.2.m2.1.2.2.2.cmml" xref="S4.I3.i1.p1.2.m2.1.2.2.2"><ci id="S4.I3.i1.p1.2.m2.1.2.2.2.1.cmml" xref="S4.I3.i1.p1.2.m2.1.2.2.2.1">^</ci><ci id="S4.I3.i1.p1.2.m2.1.2.2.2.2a.cmml" xref="S4.I3.i1.p1.2.m2.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i1.p1.2.m2.1.2.2.2.2.cmml" xref="S4.I3.i1.p1.2.m2.1.2.2.2.2">z</mtext></ci></apply><apply id="S4.I3.i1.p1.2.m2.1.2.2.3.cmml" xref="S4.I3.i1.p1.2.m2.1.2.2.3"><times id="S4.I3.i1.p1.2.m2.1.2.2.3.1.cmml" xref="S4.I3.i1.p1.2.m2.1.2.2.3.1"></times><ci id="S4.I3.i1.p1.2.m2.1.2.2.3.2.cmml" xref="S4.I3.i1.p1.2.m2.1.2.2.3.2">𝑚</ci><ci id="S4.I3.i1.p1.2.m2.1.2.2.3.3.cmml" xref="S4.I3.i1.p1.2.m2.1.2.2.3.3">𝑞</ci></apply></apply><ci id="S4.I3.i1.p1.2.m2.1.1.1.1.cmml" xref="S4.I3.i1.p1.2.m2.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i1.p1.2.m2.1c">\hat{\textbf{z}}_{mq}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i1.p1.2.m2.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math>. The UNet takes it as input and predicts the new mask latent <math alttext="\hat{\textbf{z}}_{mq}^{(t-1)}" class="ltx_Math" display="inline" id="S4.I3.i1.p1.3.m3.1"><semantics id="S4.I3.i1.p1.3.m3.1a"><msubsup id="S4.I3.i1.p1.3.m3.1.2" xref="S4.I3.i1.p1.3.m3.1.2.cmml"><mover accent="true" id="S4.I3.i1.p1.3.m3.1.2.2.2" xref="S4.I3.i1.p1.3.m3.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i1.p1.3.m3.1.2.2.2.2" xref="S4.I3.i1.p1.3.m3.1.2.2.2.2a.cmml">z</mtext><mo id="S4.I3.i1.p1.3.m3.1.2.2.2.1" xref="S4.I3.i1.p1.3.m3.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.I3.i1.p1.3.m3.1.2.2.3" xref="S4.I3.i1.p1.3.m3.1.2.2.3.cmml"><mi id="S4.I3.i1.p1.3.m3.1.2.2.3.2" xref="S4.I3.i1.p1.3.m3.1.2.2.3.2.cmml">m</mi><mo id="S4.I3.i1.p1.3.m3.1.2.2.3.1" xref="S4.I3.i1.p1.3.m3.1.2.2.3.1.cmml">⁢</mo><mi id="S4.I3.i1.p1.3.m3.1.2.2.3.3" xref="S4.I3.i1.p1.3.m3.1.2.2.3.3.cmml">q</mi></mrow><mrow id="S4.I3.i1.p1.3.m3.1.1.1.1" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S4.I3.i1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.I3.i1.p1.3.m3.1.1.1.1.1" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S4.I3.i1.p1.3.m3.1.1.1.1.1.2" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.2.cmml">t</mi><mo id="S4.I3.i1.p1.3.m3.1.1.1.1.1.1" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.1.cmml">−</mo><mn id="S4.I3.i1.p1.3.m3.1.1.1.1.1.3" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I3.i1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I3.i1.p1.3.m3.1b"><apply id="S4.I3.i1.p1.3.m3.1.2.cmml" xref="S4.I3.i1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S4.I3.i1.p1.3.m3.1.2.1.cmml" xref="S4.I3.i1.p1.3.m3.1.2">superscript</csymbol><apply id="S4.I3.i1.p1.3.m3.1.2.2.cmml" xref="S4.I3.i1.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S4.I3.i1.p1.3.m3.1.2.2.1.cmml" xref="S4.I3.i1.p1.3.m3.1.2">subscript</csymbol><apply id="S4.I3.i1.p1.3.m3.1.2.2.2.cmml" xref="S4.I3.i1.p1.3.m3.1.2.2.2"><ci id="S4.I3.i1.p1.3.m3.1.2.2.2.1.cmml" xref="S4.I3.i1.p1.3.m3.1.2.2.2.1">^</ci><ci id="S4.I3.i1.p1.3.m3.1.2.2.2.2a.cmml" xref="S4.I3.i1.p1.3.m3.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i1.p1.3.m3.1.2.2.2.2.cmml" xref="S4.I3.i1.p1.3.m3.1.2.2.2.2">z</mtext></ci></apply><apply id="S4.I3.i1.p1.3.m3.1.2.2.3.cmml" xref="S4.I3.i1.p1.3.m3.1.2.2.3"><times id="S4.I3.i1.p1.3.m3.1.2.2.3.1.cmml" xref="S4.I3.i1.p1.3.m3.1.2.2.3.1"></times><ci id="S4.I3.i1.p1.3.m3.1.2.2.3.2.cmml" xref="S4.I3.i1.p1.3.m3.1.2.2.3.2">𝑚</ci><ci id="S4.I3.i1.p1.3.m3.1.2.2.3.3.cmml" xref="S4.I3.i1.p1.3.m3.1.2.2.3.3">𝑞</ci></apply></apply><apply id="S4.I3.i1.p1.3.m3.1.1.1.1.1.cmml" xref="S4.I3.i1.p1.3.m3.1.1.1.1"><minus id="S4.I3.i1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.1"></minus><ci id="S4.I3.i1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.2">𝑡</ci><cn id="S4.I3.i1.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S4.I3.i1.p1.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i1.p1.3.m3.1c">\hat{\textbf{z}}_{mq}^{(t-1)}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i1.p1.3.m3.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math>. After T steps, the final mask latent <math alttext="\hat{\textbf{z}}_{mq}^{(0)}" class="ltx_Math" display="inline" id="S4.I3.i1.p1.4.m4.1"><semantics id="S4.I3.i1.p1.4.m4.1a"><msubsup id="S4.I3.i1.p1.4.m4.1.2" xref="S4.I3.i1.p1.4.m4.1.2.cmml"><mover accent="true" id="S4.I3.i1.p1.4.m4.1.2.2.2" xref="S4.I3.i1.p1.4.m4.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i1.p1.4.m4.1.2.2.2.2" xref="S4.I3.i1.p1.4.m4.1.2.2.2.2a.cmml">z</mtext><mo id="S4.I3.i1.p1.4.m4.1.2.2.2.1" xref="S4.I3.i1.p1.4.m4.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.I3.i1.p1.4.m4.1.2.2.3" xref="S4.I3.i1.p1.4.m4.1.2.2.3.cmml"><mi id="S4.I3.i1.p1.4.m4.1.2.2.3.2" xref="S4.I3.i1.p1.4.m4.1.2.2.3.2.cmml">m</mi><mo id="S4.I3.i1.p1.4.m4.1.2.2.3.1" xref="S4.I3.i1.p1.4.m4.1.2.2.3.1.cmml">⁢</mo><mi id="S4.I3.i1.p1.4.m4.1.2.2.3.3" xref="S4.I3.i1.p1.4.m4.1.2.2.3.3.cmml">q</mi></mrow><mrow id="S4.I3.i1.p1.4.m4.1.1.1.3" xref="S4.I3.i1.p1.4.m4.1.2.cmml"><mo id="S4.I3.i1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S4.I3.i1.p1.4.m4.1.2.cmml">(</mo><mn id="S4.I3.i1.p1.4.m4.1.1.1.1" xref="S4.I3.i1.p1.4.m4.1.1.1.1.cmml">0</mn><mo id="S4.I3.i1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S4.I3.i1.p1.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I3.i1.p1.4.m4.1b"><apply id="S4.I3.i1.p1.4.m4.1.2.cmml" xref="S4.I3.i1.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.I3.i1.p1.4.m4.1.2.1.cmml" xref="S4.I3.i1.p1.4.m4.1.2">superscript</csymbol><apply id="S4.I3.i1.p1.4.m4.1.2.2.cmml" xref="S4.I3.i1.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.I3.i1.p1.4.m4.1.2.2.1.cmml" xref="S4.I3.i1.p1.4.m4.1.2">subscript</csymbol><apply id="S4.I3.i1.p1.4.m4.1.2.2.2.cmml" xref="S4.I3.i1.p1.4.m4.1.2.2.2"><ci id="S4.I3.i1.p1.4.m4.1.2.2.2.1.cmml" xref="S4.I3.i1.p1.4.m4.1.2.2.2.1">^</ci><ci id="S4.I3.i1.p1.4.m4.1.2.2.2.2a.cmml" xref="S4.I3.i1.p1.4.m4.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i1.p1.4.m4.1.2.2.2.2.cmml" xref="S4.I3.i1.p1.4.m4.1.2.2.2.2">z</mtext></ci></apply><apply id="S4.I3.i1.p1.4.m4.1.2.2.3.cmml" xref="S4.I3.i1.p1.4.m4.1.2.2.3"><times id="S4.I3.i1.p1.4.m4.1.2.2.3.1.cmml" xref="S4.I3.i1.p1.4.m4.1.2.2.3.1"></times><ci id="S4.I3.i1.p1.4.m4.1.2.2.3.2.cmml" xref="S4.I3.i1.p1.4.m4.1.2.2.3.2">𝑚</ci><ci id="S4.I3.i1.p1.4.m4.1.2.2.3.3.cmml" xref="S4.I3.i1.p1.4.m4.1.2.2.3.3">𝑞</ci></apply></apply><cn id="S4.I3.i1.p1.4.m4.1.1.1.1.cmml" type="integer" xref="S4.I3.i1.p1.4.m4.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i1.p1.4.m4.1c">\hat{\textbf{z}}_{mq}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i1.p1.4.m4.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> is decoded into mask prediction. The mask latent <math alttext="\hat{\textbf{z}}_{mq}^{(T)}" class="ltx_Math" display="inline" id="S4.I3.i1.p1.5.m5.1"><semantics id="S4.I3.i1.p1.5.m5.1a"><msubsup id="S4.I3.i1.p1.5.m5.1.2" xref="S4.I3.i1.p1.5.m5.1.2.cmml"><mover accent="true" id="S4.I3.i1.p1.5.m5.1.2.2.2" xref="S4.I3.i1.p1.5.m5.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i1.p1.5.m5.1.2.2.2.2" xref="S4.I3.i1.p1.5.m5.1.2.2.2.2a.cmml">z</mtext><mo id="S4.I3.i1.p1.5.m5.1.2.2.2.1" xref="S4.I3.i1.p1.5.m5.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.I3.i1.p1.5.m5.1.2.2.3" xref="S4.I3.i1.p1.5.m5.1.2.2.3.cmml"><mi id="S4.I3.i1.p1.5.m5.1.2.2.3.2" xref="S4.I3.i1.p1.5.m5.1.2.2.3.2.cmml">m</mi><mo id="S4.I3.i1.p1.5.m5.1.2.2.3.1" xref="S4.I3.i1.p1.5.m5.1.2.2.3.1.cmml">⁢</mo><mi id="S4.I3.i1.p1.5.m5.1.2.2.3.3" xref="S4.I3.i1.p1.5.m5.1.2.2.3.3.cmml">q</mi></mrow><mrow id="S4.I3.i1.p1.5.m5.1.1.1.3" xref="S4.I3.i1.p1.5.m5.1.2.cmml"><mo id="S4.I3.i1.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S4.I3.i1.p1.5.m5.1.2.cmml">(</mo><mi id="S4.I3.i1.p1.5.m5.1.1.1.1" xref="S4.I3.i1.p1.5.m5.1.1.1.1.cmml">T</mi><mo id="S4.I3.i1.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S4.I3.i1.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I3.i1.p1.5.m5.1b"><apply id="S4.I3.i1.p1.5.m5.1.2.cmml" xref="S4.I3.i1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S4.I3.i1.p1.5.m5.1.2.1.cmml" xref="S4.I3.i1.p1.5.m5.1.2">superscript</csymbol><apply id="S4.I3.i1.p1.5.m5.1.2.2.cmml" xref="S4.I3.i1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S4.I3.i1.p1.5.m5.1.2.2.1.cmml" xref="S4.I3.i1.p1.5.m5.1.2">subscript</csymbol><apply id="S4.I3.i1.p1.5.m5.1.2.2.2.cmml" xref="S4.I3.i1.p1.5.m5.1.2.2.2"><ci id="S4.I3.i1.p1.5.m5.1.2.2.2.1.cmml" xref="S4.I3.i1.p1.5.m5.1.2.2.2.1">^</ci><ci id="S4.I3.i1.p1.5.m5.1.2.2.2.2a.cmml" xref="S4.I3.i1.p1.5.m5.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i1.p1.5.m5.1.2.2.2.2.cmml" xref="S4.I3.i1.p1.5.m5.1.2.2.2.2">z</mtext></ci></apply><apply id="S4.I3.i1.p1.5.m5.1.2.2.3.cmml" xref="S4.I3.i1.p1.5.m5.1.2.2.3"><times id="S4.I3.i1.p1.5.m5.1.2.2.3.1.cmml" xref="S4.I3.i1.p1.5.m5.1.2.2.3.1"></times><ci id="S4.I3.i1.p1.5.m5.1.2.2.3.2.cmml" xref="S4.I3.i1.p1.5.m5.1.2.2.3.2">𝑚</ci><ci id="S4.I3.i1.p1.5.m5.1.2.2.3.3.cmml" xref="S4.I3.i1.p1.5.m5.1.2.2.3.3">𝑞</ci></apply></apply><ci id="S4.I3.i1.p1.5.m5.1.1.1.1.cmml" xref="S4.I3.i1.p1.5.m5.1.1.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i1.p1.5.m5.1c">\hat{\textbf{z}}_{mq}^{(T)}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i1.p1.5.m5.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_T ) end_POSTSUPERSCRIPT</annotation></semantics></math> is initialized as random noise. We also use the annealed multi-resolution noise and test-time ensemble tricks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib13" title="">13</a>]</cite> proposed in Marigold.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i2.p1">
<p class="ltx_p" id="S4.I3.i2.p1.5"><span class="ltx_text ltx_font_bold" id="S4.I3.i2.p1.5.1">Multi-step image-to-mask generation (MI2M)</span> MI2M formulates the diffusion denoising process as a deterministic multi-step conversion process from image to prediction, similar to DMP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib42" title="">42</a>]</cite>. <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.F4" title="In 4.4 Exploration of generation process ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>(b2) shows the illustration of inference process. The mask latent <math alttext="\hat{\textbf{z}}_{mq}^{(T)}" class="ltx_Math" display="inline" id="S4.I3.i2.p1.1.m1.1"><semantics id="S4.I3.i2.p1.1.m1.1a"><msubsup id="S4.I3.i2.p1.1.m1.1.2" xref="S4.I3.i2.p1.1.m1.1.2.cmml"><mover accent="true" id="S4.I3.i2.p1.1.m1.1.2.2.2" xref="S4.I3.i2.p1.1.m1.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.1.m1.1.2.2.2.2" xref="S4.I3.i2.p1.1.m1.1.2.2.2.2a.cmml">z</mtext><mo id="S4.I3.i2.p1.1.m1.1.2.2.2.1" xref="S4.I3.i2.p1.1.m1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.I3.i2.p1.1.m1.1.2.2.3" xref="S4.I3.i2.p1.1.m1.1.2.2.3.cmml"><mi id="S4.I3.i2.p1.1.m1.1.2.2.3.2" xref="S4.I3.i2.p1.1.m1.1.2.2.3.2.cmml">m</mi><mo id="S4.I3.i2.p1.1.m1.1.2.2.3.1" xref="S4.I3.i2.p1.1.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.I3.i2.p1.1.m1.1.2.2.3.3" xref="S4.I3.i2.p1.1.m1.1.2.2.3.3.cmml">q</mi></mrow><mrow id="S4.I3.i2.p1.1.m1.1.1.1.3" xref="S4.I3.i2.p1.1.m1.1.2.cmml"><mo id="S4.I3.i2.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S4.I3.i2.p1.1.m1.1.2.cmml">(</mo><mi id="S4.I3.i2.p1.1.m1.1.1.1.1" xref="S4.I3.i2.p1.1.m1.1.1.1.1.cmml">T</mi><mo id="S4.I3.i2.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S4.I3.i2.p1.1.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I3.i2.p1.1.m1.1b"><apply id="S4.I3.i2.p1.1.m1.1.2.cmml" xref="S4.I3.i2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.I3.i2.p1.1.m1.1.2.1.cmml" xref="S4.I3.i2.p1.1.m1.1.2">superscript</csymbol><apply id="S4.I3.i2.p1.1.m1.1.2.2.cmml" xref="S4.I3.i2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.I3.i2.p1.1.m1.1.2.2.1.cmml" xref="S4.I3.i2.p1.1.m1.1.2">subscript</csymbol><apply id="S4.I3.i2.p1.1.m1.1.2.2.2.cmml" xref="S4.I3.i2.p1.1.m1.1.2.2.2"><ci id="S4.I3.i2.p1.1.m1.1.2.2.2.1.cmml" xref="S4.I3.i2.p1.1.m1.1.2.2.2.1">^</ci><ci id="S4.I3.i2.p1.1.m1.1.2.2.2.2a.cmml" xref="S4.I3.i2.p1.1.m1.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.1.m1.1.2.2.2.2.cmml" xref="S4.I3.i2.p1.1.m1.1.2.2.2.2">z</mtext></ci></apply><apply id="S4.I3.i2.p1.1.m1.1.2.2.3.cmml" xref="S4.I3.i2.p1.1.m1.1.2.2.3"><times id="S4.I3.i2.p1.1.m1.1.2.2.3.1.cmml" xref="S4.I3.i2.p1.1.m1.1.2.2.3.1"></times><ci id="S4.I3.i2.p1.1.m1.1.2.2.3.2.cmml" xref="S4.I3.i2.p1.1.m1.1.2.2.3.2">𝑚</ci><ci id="S4.I3.i2.p1.1.m1.1.2.2.3.3.cmml" xref="S4.I3.i2.p1.1.m1.1.2.2.3.3">𝑞</ci></apply></apply><ci id="S4.I3.i2.p1.1.m1.1.1.1.1.cmml" xref="S4.I3.i2.p1.1.m1.1.1.1.1">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i2.p1.1.m1.1c">\hat{\textbf{z}}_{mq}^{(T)}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i2.p1.1.m1.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_T ) end_POSTSUPERSCRIPT</annotation></semantics></math> is initialized as image latent <math alttext="\textbf{z}_{q}" class="ltx_Math" display="inline" id="S4.I3.i2.p1.2.m2.1"><semantics id="S4.I3.i2.p1.2.m2.1a"><msub id="S4.I3.i2.p1.2.m2.1.1" xref="S4.I3.i2.p1.2.m2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.2.m2.1.1.2" xref="S4.I3.i2.p1.2.m2.1.1.2a.cmml">z</mtext><mi id="S4.I3.i2.p1.2.m2.1.1.3" xref="S4.I3.i2.p1.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i2.p1.2.m2.1b"><apply id="S4.I3.i2.p1.2.m2.1.1.cmml" xref="S4.I3.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I3.i2.p1.2.m2.1.1.1.cmml" xref="S4.I3.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I3.i2.p1.2.m2.1.1.2a.cmml" xref="S4.I3.i2.p1.2.m2.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.2.m2.1.1.2.cmml" xref="S4.I3.i2.p1.2.m2.1.1.2">z</mtext></ci><ci id="S4.I3.i2.p1.2.m2.1.1.3.cmml" xref="S4.I3.i2.p1.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i2.p1.2.m2.1c">\textbf{z}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i2.p1.2.m2.1d">z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>. Then similar to MN2M, the UNet takes <math alttext="\hat{\textbf{z}}_{mq}^{(t)}" class="ltx_Math" display="inline" id="S4.I3.i2.p1.3.m3.1"><semantics id="S4.I3.i2.p1.3.m3.1a"><msubsup id="S4.I3.i2.p1.3.m3.1.2" xref="S4.I3.i2.p1.3.m3.1.2.cmml"><mover accent="true" id="S4.I3.i2.p1.3.m3.1.2.2.2" xref="S4.I3.i2.p1.3.m3.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.3.m3.1.2.2.2.2" xref="S4.I3.i2.p1.3.m3.1.2.2.2.2a.cmml">z</mtext><mo id="S4.I3.i2.p1.3.m3.1.2.2.2.1" xref="S4.I3.i2.p1.3.m3.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.I3.i2.p1.3.m3.1.2.2.3" xref="S4.I3.i2.p1.3.m3.1.2.2.3.cmml"><mi id="S4.I3.i2.p1.3.m3.1.2.2.3.2" xref="S4.I3.i2.p1.3.m3.1.2.2.3.2.cmml">m</mi><mo id="S4.I3.i2.p1.3.m3.1.2.2.3.1" xref="S4.I3.i2.p1.3.m3.1.2.2.3.1.cmml">⁢</mo><mi id="S4.I3.i2.p1.3.m3.1.2.2.3.3" xref="S4.I3.i2.p1.3.m3.1.2.2.3.3.cmml">q</mi></mrow><mrow id="S4.I3.i2.p1.3.m3.1.1.1.3" xref="S4.I3.i2.p1.3.m3.1.2.cmml"><mo id="S4.I3.i2.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S4.I3.i2.p1.3.m3.1.2.cmml">(</mo><mi id="S4.I3.i2.p1.3.m3.1.1.1.1" xref="S4.I3.i2.p1.3.m3.1.1.1.1.cmml">t</mi><mo id="S4.I3.i2.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S4.I3.i2.p1.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I3.i2.p1.3.m3.1b"><apply id="S4.I3.i2.p1.3.m3.1.2.cmml" xref="S4.I3.i2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S4.I3.i2.p1.3.m3.1.2.1.cmml" xref="S4.I3.i2.p1.3.m3.1.2">superscript</csymbol><apply id="S4.I3.i2.p1.3.m3.1.2.2.cmml" xref="S4.I3.i2.p1.3.m3.1.2"><csymbol cd="ambiguous" id="S4.I3.i2.p1.3.m3.1.2.2.1.cmml" xref="S4.I3.i2.p1.3.m3.1.2">subscript</csymbol><apply id="S4.I3.i2.p1.3.m3.1.2.2.2.cmml" xref="S4.I3.i2.p1.3.m3.1.2.2.2"><ci id="S4.I3.i2.p1.3.m3.1.2.2.2.1.cmml" xref="S4.I3.i2.p1.3.m3.1.2.2.2.1">^</ci><ci id="S4.I3.i2.p1.3.m3.1.2.2.2.2a.cmml" xref="S4.I3.i2.p1.3.m3.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.3.m3.1.2.2.2.2.cmml" xref="S4.I3.i2.p1.3.m3.1.2.2.2.2">z</mtext></ci></apply><apply id="S4.I3.i2.p1.3.m3.1.2.2.3.cmml" xref="S4.I3.i2.p1.3.m3.1.2.2.3"><times id="S4.I3.i2.p1.3.m3.1.2.2.3.1.cmml" xref="S4.I3.i2.p1.3.m3.1.2.2.3.1"></times><ci id="S4.I3.i2.p1.3.m3.1.2.2.3.2.cmml" xref="S4.I3.i2.p1.3.m3.1.2.2.3.2">𝑚</ci><ci id="S4.I3.i2.p1.3.m3.1.2.2.3.3.cmml" xref="S4.I3.i2.p1.3.m3.1.2.2.3.3">𝑞</ci></apply></apply><ci id="S4.I3.i2.p1.3.m3.1.1.1.1.cmml" xref="S4.I3.i2.p1.3.m3.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i2.p1.3.m3.1c">\hat{\textbf{z}}_{mq}^{(t)}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i2.p1.3.m3.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT</annotation></semantics></math> as input and predicts <math alttext="\hat{\textbf{z}}_{mq}^{(t-1)}" class="ltx_Math" display="inline" id="S4.I3.i2.p1.4.m4.1"><semantics id="S4.I3.i2.p1.4.m4.1a"><msubsup id="S4.I3.i2.p1.4.m4.1.2" xref="S4.I3.i2.p1.4.m4.1.2.cmml"><mover accent="true" id="S4.I3.i2.p1.4.m4.1.2.2.2" xref="S4.I3.i2.p1.4.m4.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.4.m4.1.2.2.2.2" xref="S4.I3.i2.p1.4.m4.1.2.2.2.2a.cmml">z</mtext><mo id="S4.I3.i2.p1.4.m4.1.2.2.2.1" xref="S4.I3.i2.p1.4.m4.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.I3.i2.p1.4.m4.1.2.2.3" xref="S4.I3.i2.p1.4.m4.1.2.2.3.cmml"><mi id="S4.I3.i2.p1.4.m4.1.2.2.3.2" xref="S4.I3.i2.p1.4.m4.1.2.2.3.2.cmml">m</mi><mo id="S4.I3.i2.p1.4.m4.1.2.2.3.1" xref="S4.I3.i2.p1.4.m4.1.2.2.3.1.cmml">⁢</mo><mi id="S4.I3.i2.p1.4.m4.1.2.2.3.3" xref="S4.I3.i2.p1.4.m4.1.2.2.3.3.cmml">q</mi></mrow><mrow id="S4.I3.i2.p1.4.m4.1.1.1.1" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.cmml"><mo id="S4.I3.i2.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.I3.i2.p1.4.m4.1.1.1.1.1" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S4.I3.i2.p1.4.m4.1.1.1.1.1.2" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.2.cmml">t</mi><mo id="S4.I3.i2.p1.4.m4.1.1.1.1.1.1" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.1.cmml">−</mo><mn id="S4.I3.i2.p1.4.m4.1.1.1.1.1.3" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.I3.i2.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I3.i2.p1.4.m4.1b"><apply id="S4.I3.i2.p1.4.m4.1.2.cmml" xref="S4.I3.i2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.I3.i2.p1.4.m4.1.2.1.cmml" xref="S4.I3.i2.p1.4.m4.1.2">superscript</csymbol><apply id="S4.I3.i2.p1.4.m4.1.2.2.cmml" xref="S4.I3.i2.p1.4.m4.1.2"><csymbol cd="ambiguous" id="S4.I3.i2.p1.4.m4.1.2.2.1.cmml" xref="S4.I3.i2.p1.4.m4.1.2">subscript</csymbol><apply id="S4.I3.i2.p1.4.m4.1.2.2.2.cmml" xref="S4.I3.i2.p1.4.m4.1.2.2.2"><ci id="S4.I3.i2.p1.4.m4.1.2.2.2.1.cmml" xref="S4.I3.i2.p1.4.m4.1.2.2.2.1">^</ci><ci id="S4.I3.i2.p1.4.m4.1.2.2.2.2a.cmml" xref="S4.I3.i2.p1.4.m4.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.4.m4.1.2.2.2.2.cmml" xref="S4.I3.i2.p1.4.m4.1.2.2.2.2">z</mtext></ci></apply><apply id="S4.I3.i2.p1.4.m4.1.2.2.3.cmml" xref="S4.I3.i2.p1.4.m4.1.2.2.3"><times id="S4.I3.i2.p1.4.m4.1.2.2.3.1.cmml" xref="S4.I3.i2.p1.4.m4.1.2.2.3.1"></times><ci id="S4.I3.i2.p1.4.m4.1.2.2.3.2.cmml" xref="S4.I3.i2.p1.4.m4.1.2.2.3.2">𝑚</ci><ci id="S4.I3.i2.p1.4.m4.1.2.2.3.3.cmml" xref="S4.I3.i2.p1.4.m4.1.2.2.3.3">𝑞</ci></apply></apply><apply id="S4.I3.i2.p1.4.m4.1.1.1.1.1.cmml" xref="S4.I3.i2.p1.4.m4.1.1.1.1"><minus id="S4.I3.i2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.1"></minus><ci id="S4.I3.i2.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.2">𝑡</ci><cn id="S4.I3.i2.p1.4.m4.1.1.1.1.1.3.cmml" type="integer" xref="S4.I3.i2.p1.4.m4.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i2.p1.4.m4.1c">\hat{\textbf{z}}_{mq}^{(t-1)}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i2.p1.4.m4.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t - 1 ) end_POSTSUPERSCRIPT</annotation></semantics></math>. After T steps, the final mask latent <math alttext="\hat{\textbf{z}}_{mq}^{(0)}" class="ltx_Math" display="inline" id="S4.I3.i2.p1.5.m5.1"><semantics id="S4.I3.i2.p1.5.m5.1a"><msubsup id="S4.I3.i2.p1.5.m5.1.2" xref="S4.I3.i2.p1.5.m5.1.2.cmml"><mover accent="true" id="S4.I3.i2.p1.5.m5.1.2.2.2" xref="S4.I3.i2.p1.5.m5.1.2.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.5.m5.1.2.2.2.2" xref="S4.I3.i2.p1.5.m5.1.2.2.2.2a.cmml">z</mtext><mo id="S4.I3.i2.p1.5.m5.1.2.2.2.1" xref="S4.I3.i2.p1.5.m5.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.I3.i2.p1.5.m5.1.2.2.3" xref="S4.I3.i2.p1.5.m5.1.2.2.3.cmml"><mi id="S4.I3.i2.p1.5.m5.1.2.2.3.2" xref="S4.I3.i2.p1.5.m5.1.2.2.3.2.cmml">m</mi><mo id="S4.I3.i2.p1.5.m5.1.2.2.3.1" xref="S4.I3.i2.p1.5.m5.1.2.2.3.1.cmml">⁢</mo><mi id="S4.I3.i2.p1.5.m5.1.2.2.3.3" xref="S4.I3.i2.p1.5.m5.1.2.2.3.3.cmml">q</mi></mrow><mrow id="S4.I3.i2.p1.5.m5.1.1.1.3" xref="S4.I3.i2.p1.5.m5.1.2.cmml"><mo id="S4.I3.i2.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S4.I3.i2.p1.5.m5.1.2.cmml">(</mo><mn id="S4.I3.i2.p1.5.m5.1.1.1.1" xref="S4.I3.i2.p1.5.m5.1.1.1.1.cmml">0</mn><mo id="S4.I3.i2.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S4.I3.i2.p1.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.I3.i2.p1.5.m5.1b"><apply id="S4.I3.i2.p1.5.m5.1.2.cmml" xref="S4.I3.i2.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S4.I3.i2.p1.5.m5.1.2.1.cmml" xref="S4.I3.i2.p1.5.m5.1.2">superscript</csymbol><apply id="S4.I3.i2.p1.5.m5.1.2.2.cmml" xref="S4.I3.i2.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S4.I3.i2.p1.5.m5.1.2.2.1.cmml" xref="S4.I3.i2.p1.5.m5.1.2">subscript</csymbol><apply id="S4.I3.i2.p1.5.m5.1.2.2.2.cmml" xref="S4.I3.i2.p1.5.m5.1.2.2.2"><ci id="S4.I3.i2.p1.5.m5.1.2.2.2.1.cmml" xref="S4.I3.i2.p1.5.m5.1.2.2.2.1">^</ci><ci id="S4.I3.i2.p1.5.m5.1.2.2.2.2a.cmml" xref="S4.I3.i2.p1.5.m5.1.2.2.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i2.p1.5.m5.1.2.2.2.2.cmml" xref="S4.I3.i2.p1.5.m5.1.2.2.2.2">z</mtext></ci></apply><apply id="S4.I3.i2.p1.5.m5.1.2.2.3.cmml" xref="S4.I3.i2.p1.5.m5.1.2.2.3"><times id="S4.I3.i2.p1.5.m5.1.2.2.3.1.cmml" xref="S4.I3.i2.p1.5.m5.1.2.2.3.1"></times><ci id="S4.I3.i2.p1.5.m5.1.2.2.3.2.cmml" xref="S4.I3.i2.p1.5.m5.1.2.2.3.2">𝑚</ci><ci id="S4.I3.i2.p1.5.m5.1.2.2.3.3.cmml" xref="S4.I3.i2.p1.5.m5.1.2.2.3.3">𝑞</ci></apply></apply><cn id="S4.I3.i2.p1.5.m5.1.1.1.1.cmml" type="integer" xref="S4.I3.i2.p1.5.m5.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i2.p1.5.m5.1c">\hat{\textbf{z}}_{mq}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i2.p1.5.m5.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> is decoded into mask prediction.</p>
</div>
</li>
<li class="ltx_item" id="S4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I3.i3.p1">
<p class="ltx_p" id="S4.I3.i3.p1.2"><span class="ltx_text ltx_font_bold" id="S4.I3.i3.p1.2.1">One-step image-to-mask generation (OI2M)</span> OI2M further transforms MI2M’s multi-step prediction into a one-step prediction, <em class="ltx_emph ltx_font_italic" id="S4.I3.i3.p1.2.2">i.e.</em>, UNet takes <math alttext="\textbf{z}_{q}" class="ltx_Math" display="inline" id="S4.I3.i3.p1.1.m1.1"><semantics id="S4.I3.i3.p1.1.m1.1a"><msub id="S4.I3.i3.p1.1.m1.1.1" xref="S4.I3.i3.p1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i3.p1.1.m1.1.1.2" xref="S4.I3.i3.p1.1.m1.1.1.2a.cmml">z</mtext><mi id="S4.I3.i3.p1.1.m1.1.1.3" xref="S4.I3.i3.p1.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i3.p1.1.m1.1b"><apply id="S4.I3.i3.p1.1.m1.1.1.cmml" xref="S4.I3.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I3.i3.p1.1.m1.1.1.1.cmml" xref="S4.I3.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I3.i3.p1.1.m1.1.1.2a.cmml" xref="S4.I3.i3.p1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i3.p1.1.m1.1.1.2.cmml" xref="S4.I3.i3.p1.1.m1.1.1.2">z</mtext></ci><ci id="S4.I3.i3.p1.1.m1.1.1.3.cmml" xref="S4.I3.i3.p1.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i3.p1.1.m1.1c">\textbf{z}_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i3.p1.1.m1.1d">z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> as input and outputs the prediction <math alttext="\hat{\textbf{z}}_{mq}" class="ltx_Math" display="inline" id="S4.I3.i3.p1.2.m2.1"><semantics id="S4.I3.i3.p1.2.m2.1a"><msub id="S4.I3.i3.p1.2.m2.1.1" xref="S4.I3.i3.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.I3.i3.p1.2.m2.1.1.2" xref="S4.I3.i3.p1.2.m2.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="S4.I3.i3.p1.2.m2.1.1.2.2" xref="S4.I3.i3.p1.2.m2.1.1.2.2a.cmml">z</mtext><mo id="S4.I3.i3.p1.2.m2.1.1.2.1" xref="S4.I3.i3.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mrow id="S4.I3.i3.p1.2.m2.1.1.3" xref="S4.I3.i3.p1.2.m2.1.1.3.cmml"><mi id="S4.I3.i3.p1.2.m2.1.1.3.2" xref="S4.I3.i3.p1.2.m2.1.1.3.2.cmml">m</mi><mo id="S4.I3.i3.p1.2.m2.1.1.3.1" xref="S4.I3.i3.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.I3.i3.p1.2.m2.1.1.3.3" xref="S4.I3.i3.p1.2.m2.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I3.i3.p1.2.m2.1b"><apply id="S4.I3.i3.p1.2.m2.1.1.cmml" xref="S4.I3.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I3.i3.p1.2.m2.1.1.1.cmml" xref="S4.I3.i3.p1.2.m2.1.1">subscript</csymbol><apply id="S4.I3.i3.p1.2.m2.1.1.2.cmml" xref="S4.I3.i3.p1.2.m2.1.1.2"><ci id="S4.I3.i3.p1.2.m2.1.1.2.1.cmml" xref="S4.I3.i3.p1.2.m2.1.1.2.1">^</ci><ci id="S4.I3.i3.p1.2.m2.1.1.2.2a.cmml" xref="S4.I3.i3.p1.2.m2.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="S4.I3.i3.p1.2.m2.1.1.2.2.cmml" xref="S4.I3.i3.p1.2.m2.1.1.2.2">z</mtext></ci></apply><apply id="S4.I3.i3.p1.2.m2.1.1.3.cmml" xref="S4.I3.i3.p1.2.m2.1.1.3"><times id="S4.I3.i3.p1.2.m2.1.1.3.1.cmml" xref="S4.I3.i3.p1.2.m2.1.1.3.1"></times><ci id="S4.I3.i3.p1.2.m2.1.1.3.2.cmml" xref="S4.I3.i3.p1.2.m2.1.1.3.2">𝑚</ci><ci id="S4.I3.i3.p1.2.m2.1.1.3.3.cmml" xref="S4.I3.i3.p1.2.m2.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I3.i3.p1.2.m2.1c">\hat{\textbf{z}}_{mq}</annotation><annotation encoding="application/x-llamapun" id="S4.I3.i3.p1.2.m2.1d">over^ start_ARG z end_ARG start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT</annotation></semantics></math> directly.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.3">We explore the mask generation pipeline starting from MN2M. As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.F4" title="In 4.4 Exploration of generation process ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>(c), MN2N achieves 15.2% mIoU. Then, we change MN2M into MI2M keeping same variance <math alttext="\beta_{1}=(0.00085,0.012)" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.2"><semantics id="S4.SS4.p3.1.m1.2a"><mrow id="S4.SS4.p3.1.m1.2.3" xref="S4.SS4.p3.1.m1.2.3.cmml"><msub id="S4.SS4.p3.1.m1.2.3.2" xref="S4.SS4.p3.1.m1.2.3.2.cmml"><mi id="S4.SS4.p3.1.m1.2.3.2.2" xref="S4.SS4.p3.1.m1.2.3.2.2.cmml">β</mi><mn id="S4.SS4.p3.1.m1.2.3.2.3" xref="S4.SS4.p3.1.m1.2.3.2.3.cmml">1</mn></msub><mo id="S4.SS4.p3.1.m1.2.3.1" xref="S4.SS4.p3.1.m1.2.3.1.cmml">=</mo><mrow id="S4.SS4.p3.1.m1.2.3.3.2" xref="S4.SS4.p3.1.m1.2.3.3.1.cmml"><mo id="S4.SS4.p3.1.m1.2.3.3.2.1" stretchy="false" xref="S4.SS4.p3.1.m1.2.3.3.1.cmml">(</mo><mn id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml">0.00085</mn><mo id="S4.SS4.p3.1.m1.2.3.3.2.2" xref="S4.SS4.p3.1.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS4.p3.1.m1.2.2" xref="S4.SS4.p3.1.m1.2.2.cmml">0.012</mn><mo id="S4.SS4.p3.1.m1.2.3.3.2.3" stretchy="false" xref="S4.SS4.p3.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.2b"><apply id="S4.SS4.p3.1.m1.2.3.cmml" xref="S4.SS4.p3.1.m1.2.3"><eq id="S4.SS4.p3.1.m1.2.3.1.cmml" xref="S4.SS4.p3.1.m1.2.3.1"></eq><apply id="S4.SS4.p3.1.m1.2.3.2.cmml" xref="S4.SS4.p3.1.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.2.3.2.1.cmml" xref="S4.SS4.p3.1.m1.2.3.2">subscript</csymbol><ci id="S4.SS4.p3.1.m1.2.3.2.2.cmml" xref="S4.SS4.p3.1.m1.2.3.2.2">𝛽</ci><cn id="S4.SS4.p3.1.m1.2.3.2.3.cmml" type="integer" xref="S4.SS4.p3.1.m1.2.3.2.3">1</cn></apply><interval closure="open" id="S4.SS4.p3.1.m1.2.3.3.1.cmml" xref="S4.SS4.p3.1.m1.2.3.3.2"><cn id="S4.SS4.p3.1.m1.1.1.cmml" type="float" xref="S4.SS4.p3.1.m1.1.1">0.00085</cn><cn id="S4.SS4.p3.1.m1.2.2.cmml" type="float" xref="S4.SS4.p3.1.m1.2.2">0.012</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.2c">\beta_{1}=(0.00085,0.012)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = ( 0.00085 , 0.012 )</annotation></semantics></math>. The performance has improved by 4.7% mIoU. Both methods achieve bad performance. We hypothesize that this is because adding a very small noise or image to the binary mask during the training process and then predicting it does not lead to a challenging task compared with diffusion pre-training.
The binary mask is simpler than natural images, the mask latent after adding noise can still easily distinguish the foreground and the background. This results in serious information leakage in the training process of UNet, leading to poor performance.
To verify this hypothesis, we increase the variance of MI2M from <math alttext="\beta_{1}=(0.00085,0.012)" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.2"><semantics id="S4.SS4.p3.2.m2.2a"><mrow id="S4.SS4.p3.2.m2.2.3" xref="S4.SS4.p3.2.m2.2.3.cmml"><msub id="S4.SS4.p3.2.m2.2.3.2" xref="S4.SS4.p3.2.m2.2.3.2.cmml"><mi id="S4.SS4.p3.2.m2.2.3.2.2" xref="S4.SS4.p3.2.m2.2.3.2.2.cmml">β</mi><mn id="S4.SS4.p3.2.m2.2.3.2.3" xref="S4.SS4.p3.2.m2.2.3.2.3.cmml">1</mn></msub><mo id="S4.SS4.p3.2.m2.2.3.1" xref="S4.SS4.p3.2.m2.2.3.1.cmml">=</mo><mrow id="S4.SS4.p3.2.m2.2.3.3.2" xref="S4.SS4.p3.2.m2.2.3.3.1.cmml"><mo id="S4.SS4.p3.2.m2.2.3.3.2.1" stretchy="false" xref="S4.SS4.p3.2.m2.2.3.3.1.cmml">(</mo><mn id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml">0.00085</mn><mo id="S4.SS4.p3.2.m2.2.3.3.2.2" xref="S4.SS4.p3.2.m2.2.3.3.1.cmml">,</mo><mn id="S4.SS4.p3.2.m2.2.2" xref="S4.SS4.p3.2.m2.2.2.cmml">0.012</mn><mo id="S4.SS4.p3.2.m2.2.3.3.2.3" stretchy="false" xref="S4.SS4.p3.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.2b"><apply id="S4.SS4.p3.2.m2.2.3.cmml" xref="S4.SS4.p3.2.m2.2.3"><eq id="S4.SS4.p3.2.m2.2.3.1.cmml" xref="S4.SS4.p3.2.m2.2.3.1"></eq><apply id="S4.SS4.p3.2.m2.2.3.2.cmml" xref="S4.SS4.p3.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.2.3.2.1.cmml" xref="S4.SS4.p3.2.m2.2.3.2">subscript</csymbol><ci id="S4.SS4.p3.2.m2.2.3.2.2.cmml" xref="S4.SS4.p3.2.m2.2.3.2.2">𝛽</ci><cn id="S4.SS4.p3.2.m2.2.3.2.3.cmml" type="integer" xref="S4.SS4.p3.2.m2.2.3.2.3">1</cn></apply><interval closure="open" id="S4.SS4.p3.2.m2.2.3.3.1.cmml" xref="S4.SS4.p3.2.m2.2.3.3.2"><cn id="S4.SS4.p3.2.m2.1.1.cmml" type="float" xref="S4.SS4.p3.2.m2.1.1">0.00085</cn><cn id="S4.SS4.p3.2.m2.2.2.cmml" type="float" xref="S4.SS4.p3.2.m2.2.2">0.012</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.2c">\beta_{1}=(0.00085,0.012)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.2d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = ( 0.00085 , 0.012 )</annotation></semantics></math> to <math alttext="\beta_{2}=(0.0272,0.384)" class="ltx_Math" display="inline" id="S4.SS4.p3.3.m3.2"><semantics id="S4.SS4.p3.3.m3.2a"><mrow id="S4.SS4.p3.3.m3.2.3" xref="S4.SS4.p3.3.m3.2.3.cmml"><msub id="S4.SS4.p3.3.m3.2.3.2" xref="S4.SS4.p3.3.m3.2.3.2.cmml"><mi id="S4.SS4.p3.3.m3.2.3.2.2" xref="S4.SS4.p3.3.m3.2.3.2.2.cmml">β</mi><mn id="S4.SS4.p3.3.m3.2.3.2.3" xref="S4.SS4.p3.3.m3.2.3.2.3.cmml">2</mn></msub><mo id="S4.SS4.p3.3.m3.2.3.1" xref="S4.SS4.p3.3.m3.2.3.1.cmml">=</mo><mrow id="S4.SS4.p3.3.m3.2.3.3.2" xref="S4.SS4.p3.3.m3.2.3.3.1.cmml"><mo id="S4.SS4.p3.3.m3.2.3.3.2.1" stretchy="false" xref="S4.SS4.p3.3.m3.2.3.3.1.cmml">(</mo><mn id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml">0.0272</mn><mo id="S4.SS4.p3.3.m3.2.3.3.2.2" xref="S4.SS4.p3.3.m3.2.3.3.1.cmml">,</mo><mn id="S4.SS4.p3.3.m3.2.2" xref="S4.SS4.p3.3.m3.2.2.cmml">0.384</mn><mo id="S4.SS4.p3.3.m3.2.3.3.2.3" stretchy="false" xref="S4.SS4.p3.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.2b"><apply id="S4.SS4.p3.3.m3.2.3.cmml" xref="S4.SS4.p3.3.m3.2.3"><eq id="S4.SS4.p3.3.m3.2.3.1.cmml" xref="S4.SS4.p3.3.m3.2.3.1"></eq><apply id="S4.SS4.p3.3.m3.2.3.2.cmml" xref="S4.SS4.p3.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.2.3.2.1.cmml" xref="S4.SS4.p3.3.m3.2.3.2">subscript</csymbol><ci id="S4.SS4.p3.3.m3.2.3.2.2.cmml" xref="S4.SS4.p3.3.m3.2.3.2.2">𝛽</ci><cn id="S4.SS4.p3.3.m3.2.3.2.3.cmml" type="integer" xref="S4.SS4.p3.3.m3.2.3.2.3">2</cn></apply><interval closure="open" id="S4.SS4.p3.3.m3.2.3.3.1.cmml" xref="S4.SS4.p3.3.m3.2.3.3.2"><cn id="S4.SS4.p3.3.m3.1.1.cmml" type="float" xref="S4.SS4.p3.3.m3.1.1">0.0272</cn><cn id="S4.SS4.p3.3.m3.2.2.cmml" type="float" xref="S4.SS4.p3.3.m3.2.2">0.384</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.2c">\beta_{2}=(0.0272,0.384)</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.3.m3.2d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = ( 0.0272 , 0.384 )</annotation></semantics></math>. The performance has significantly improved by 23.3% mIoU. To fully increase the difficulty of training, we convert MI2M into OI2M, which does not introduce any ground-truth information into the input of the UNet during training. In addition, OI2M reduces the number of iterations to 1, which significantly improves the predictive efficiency of the network. <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.F4" title="In 4.4 Exploration of generation process ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">4</span></a>(c) shows OI2M achieves best performance. Therefore, we choose OI2M as the mask generation pipeline.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiment</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.4"><span class="ltx_text ltx_font_bold" id="S5.p1.4.1">Datasets</span>
We test our method in two settings:
1. Strict few shot setting: Following the few-shot setting on COCO-20<sup class="ltx_sup" id="S5.p1.4.2"><span class="ltx_text ltx_font_italic" id="S5.p1.4.2.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib43" title="">43</a>]</cite>, we organize 80 classes from COCO2014 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib44" title="">44</a>]</cite> into 4 folds. Each trial consists of 60 classes allocated for training and 20 classes designated for testing. For evaluation, we randomly sample 1000 reference-target pairs in each fold with the same seed used in HSNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib18" title="">18</a>]</cite>.
2. In-context setting: Following the setting in SegGPT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib30" title="">30</a>]</cite>, COCO, ADE <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib45" title="">45</a>]</cite>, and PASCAL VOC <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib46" title="">46</a>]</cite> serve as the training set. In-domain testing is conducted on COCO-20<sup class="ltx_sup" id="S5.p1.4.3"><span class="ltx_text ltx_font_italic" id="S5.p1.4.3.1">i</span></sup> and PASCAL-5<sup class="ltx_sup" id="S5.p1.4.4"><span class="ltx_text ltx_font_italic" id="S5.p1.4.4.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib31" title="">31</a>]</cite> to evaluate our model. In line with Matcher <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib22" title="">22</a>]</cite>, LVIS-92<sup class="ltx_sup" id="S5.p1.4.5"><span class="ltx_text ltx_font_italic" id="S5.p1.4.5.1">i</span></sup> function as the out-of-domain test set.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1"><span class="ltx_text ltx_font_bold" id="S5.p2.1.1">Implementation details</span>
We initialize our model with Stable Diffusion 2.1 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib2" title="">2</a>]</cite>. The Adam optimizer is used with a weight decay set at 0.01 and a learning rate of 1e-5, coupled with a linear schedule.
In terms of data augmentation, our methodology only involves resizing the input image directly to 512x512. No additional data augmentation occurs.
Under the strict few-shot setting, the model undergoes training on four V100 GPUs. With the gradient accumulation set at 4, the total batch size comes to 16. Training carries out for 10,000 iterations, typically requiring six hours.
For in-context setting, since the training set is larger, we keep other hyperparameters consistent with the strict few-shot setting, and adjust the total training iterations to 30000 iterations.
Lastly, our ablation experiments are validated on Fold0 of COCO-20<sup class="ltx_sup" id="S5.p2.1.2"><span class="ltx_text ltx_font_italic" id="S5.p2.1.2.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib43" title="">43</a>]</cite>. The training took place on a single 4090 GPU, with a gradient accumulation set at 4, which brought the total batch size to 4. The training, which consisted of 10,000 iterations, took roughly 11 hours.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.14.4.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S5.T1.6.3" style="font-size:90%;">Results of few-shot semantic segmentation on COCO-20<sup class="ltx_sup" id="S5.T1.6.3.1"><span class="ltx_text ltx_font_italic" id="S5.T1.6.3.1.1">i</span></sup>, PASCAL-5<sup class="ltx_sup" id="S5.T1.6.3.2"><span class="ltx_text ltx_font_italic" id="S5.T1.6.3.2.1">i</span></sup>, and LVIS-92<sup class="ltx_sup" id="S5.T1.6.3.3"><span class="ltx_text ltx_font_italic" id="S5.T1.6.3.3.1">i</span></sup>, under in-context setting.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.9" style="width:398.9pt;height:139.4pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-85.2pt,29.6pt) scale(0.700596557194678,0.700596557194678) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T1.9.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.9.3.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T1.9.3.3.4" rowspan="2"><span class="ltx_text" id="S5.T1.9.3.3.4.1">Methods</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.9.3.3.5" rowspan="2"><span class="ltx_text" id="S5.T1.9.3.3.5.1">Venue</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T1.7.1.1.1">COCO-20<sup class="ltx_sup" id="S5.T1.7.1.1.1.1"><span class="ltx_text ltx_font_italic" id="S5.T1.7.1.1.1.1.1">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2" id="S5.T1.8.2.2.2">PASCAL-5<sup class="ltx_sup" id="S5.T1.8.2.2.2.1"><span class="ltx_text ltx_font_italic" id="S5.T1.8.2.2.2.1.1">i</span></sup>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="S5.T1.9.3.3.3">LVIS-92<sup class="ltx_sup" id="S5.T1.9.3.3.3.1"><span class="ltx_text ltx_font_italic" id="S5.T1.9.3.3.3.1.1">i</span></sup>
</th>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.4.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T1.9.3.4.1.1">one-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T1.9.3.4.1.2">few-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T1.9.3.4.1.3">one-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T1.9.3.4.1.4">few-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T1.9.3.4.1.5">one-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T1.9.3.4.1.6">few-shot</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.9.3.5.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T1.9.3.5.1.1">HSNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib18" title="">18</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.9.3.5.1.2">ICCV’21</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.9.3.5.1.3">41.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.9.3.5.1.4">50.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.9.3.5.1.5">68.7</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.9.3.5.1.6">73.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.9.3.5.1.7">17.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.9.3.5.1.8">22.9</td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.6.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T1.9.3.6.2.1">VAT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib47" title="">47</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.9.3.6.2.2">ECCV’22</th>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.6.2.3">42.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.6.2.4">49.4</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.6.2.5">72.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.6.2.6">76.3</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.6.2.7">18.5</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.6.2.8">22.7</td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.7.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T1.9.3.7.3.1">FPTrans <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib48" title="">48</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.9.3.7.3.2">NeurIPS’22</th>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.7.3.3">56.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.7.3.4">65.5</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.7.3.5">77.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.7.3.6">83.2</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.7.3.7">-</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.7.3.8">-</td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.8.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T1.9.3.8.4.1">Painter <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib29" title="">29</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.9.3.8.4.2">CVPR’23</th>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.8.4.3">32.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.8.4.4">32.6</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.8.4.5">64.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.8.4.6">64.6</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.8.4.7">10.5</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.8.4.8">10.9</td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.9.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T1.9.3.9.5.1">SegGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib30" title="">30</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.9.3.9.5.2">ICCV’23</th>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.9.5.3">56.1</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.9.5.4">67.9</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.9.5.5">83.2</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.9.5.6">89.8</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.9.5.7">18.6</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.9.5.8">25.4</td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.10.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T1.9.3.10.6.1">PerSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib49" title="">49</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.9.3.10.6.2" rowspan="2"><span class="ltx_text" id="S5.T1.9.3.10.6.2.1">ICLR’24</span></th>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.10.6.3">23.0</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.10.6.4">-</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.10.6.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.10.6.6">-</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.10.6.7">15.6</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.10.6.8">-</td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.11.7">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T1.9.3.11.7.1">PerSAM-F <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib49" title="">49</a>]</cite>
</th>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.11.7.2">23.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.11.7.3">-</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.11.7.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.11.7.5">-</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.11.7.6">18.4</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.11.7.7">-</td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.12.8">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T1.9.3.12.8.1">Matcher <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib22" title="">22</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.9.3.12.8.2">ICLR’24</th>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.12.8.3">52.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.12.8.4">60.7</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.12.8.5">67.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.9.3.12.8.6">75.6</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.12.8.7">33.0</td>
<td class="ltx_td ltx_align_center" id="S5.T1.9.3.12.8.8">40.0</td>
</tr>
<tr class="ltx_tr" id="S5.T1.9.3.13.9">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b" id="S5.T1.9.3.13.9.1">DiffewS</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T1.9.3.13.9.2">this work</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.9.3.13.9.3">71.3</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.9.3.13.9.4">72.2</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.9.3.13.9.5">88.3</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.9.3.13.9.6">87.8</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.9.3.13.9.7">31.4</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.9.3.13.9.8">35.4</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.13.2.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text" id="S5.T2.2.1" style="font-size:90%;">Results of strict few-shot semantic segmentation on COCO-20<sup class="ltx_sup" id="S5.T2.2.1.1"><span class="ltx_text ltx_font_italic" id="S5.T2.2.1.1.1">i</span></sup>.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.10" style="width:398.9pt;height:111.5pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-92.1pt,25.6pt) scale(0.684077471974848,0.684077471974848) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.10.8">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.10.8.9.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S5.T2.10.8.9.1.1" rowspan="2"><span class="ltx_text" id="S5.T2.10.8.9.1.1.1">Methods</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.10.8.9.1.2" rowspan="2"><span class="ltx_text" id="S5.T2.10.8.9.1.2.1">Venue</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="5" id="S5.T2.10.8.9.1.3">1-shot</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="5" id="S5.T2.10.8.9.1.4">5-shot</th>
</tr>
<tr class="ltx_tr" id="S5.T2.10.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.3.1.1.1"><math alttext="20^{0}" class="ltx_Math" display="inline" id="S5.T2.3.1.1.1.m1.1"><semantics id="S5.T2.3.1.1.1.m1.1a"><msup id="S5.T2.3.1.1.1.m1.1.1" xref="S5.T2.3.1.1.1.m1.1.1.cmml"><mn id="S5.T2.3.1.1.1.m1.1.1.2" xref="S5.T2.3.1.1.1.m1.1.1.2.cmml">20</mn><mn id="S5.T2.3.1.1.1.m1.1.1.3" xref="S5.T2.3.1.1.1.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T2.3.1.1.1.m1.1b"><apply id="S5.T2.3.1.1.1.m1.1.1.cmml" xref="S5.T2.3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.3.1.1.1.m1.1.1.1.cmml" xref="S5.T2.3.1.1.1.m1.1.1">superscript</csymbol><cn id="S5.T2.3.1.1.1.m1.1.1.2.cmml" type="integer" xref="S5.T2.3.1.1.1.m1.1.1.2">20</cn><cn id="S5.T2.3.1.1.1.m1.1.1.3.cmml" type="integer" xref="S5.T2.3.1.1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.1.1.1.m1.1c">20^{0}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.1.1.1.m1.1d">20 start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.4.2.2.2"><math alttext="20^{1}" class="ltx_Math" display="inline" id="S5.T2.4.2.2.2.m1.1"><semantics id="S5.T2.4.2.2.2.m1.1a"><msup id="S5.T2.4.2.2.2.m1.1.1" xref="S5.T2.4.2.2.2.m1.1.1.cmml"><mn id="S5.T2.4.2.2.2.m1.1.1.2" xref="S5.T2.4.2.2.2.m1.1.1.2.cmml">20</mn><mn id="S5.T2.4.2.2.2.m1.1.1.3" xref="S5.T2.4.2.2.2.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T2.4.2.2.2.m1.1b"><apply id="S5.T2.4.2.2.2.m1.1.1.cmml" xref="S5.T2.4.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.4.2.2.2.m1.1.1.1.cmml" xref="S5.T2.4.2.2.2.m1.1.1">superscript</csymbol><cn id="S5.T2.4.2.2.2.m1.1.1.2.cmml" type="integer" xref="S5.T2.4.2.2.2.m1.1.1.2">20</cn><cn id="S5.T2.4.2.2.2.m1.1.1.3.cmml" type="integer" xref="S5.T2.4.2.2.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.2.2.2.m1.1c">20^{1}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.2.2.2.m1.1d">20 start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.5.3.3.3"><math alttext="20^{2}" class="ltx_Math" display="inline" id="S5.T2.5.3.3.3.m1.1"><semantics id="S5.T2.5.3.3.3.m1.1a"><msup id="S5.T2.5.3.3.3.m1.1.1" xref="S5.T2.5.3.3.3.m1.1.1.cmml"><mn id="S5.T2.5.3.3.3.m1.1.1.2" xref="S5.T2.5.3.3.3.m1.1.1.2.cmml">20</mn><mn id="S5.T2.5.3.3.3.m1.1.1.3" xref="S5.T2.5.3.3.3.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T2.5.3.3.3.m1.1b"><apply id="S5.T2.5.3.3.3.m1.1.1.cmml" xref="S5.T2.5.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.5.3.3.3.m1.1.1.1.cmml" xref="S5.T2.5.3.3.3.m1.1.1">superscript</csymbol><cn id="S5.T2.5.3.3.3.m1.1.1.2.cmml" type="integer" xref="S5.T2.5.3.3.3.m1.1.1.2">20</cn><cn id="S5.T2.5.3.3.3.m1.1.1.3.cmml" type="integer" xref="S5.T2.5.3.3.3.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.3.3.3.m1.1c">20^{2}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.3.3.3.m1.1d">20 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.6.4.4.4"><math alttext="20^{3}" class="ltx_Math" display="inline" id="S5.T2.6.4.4.4.m1.1"><semantics id="S5.T2.6.4.4.4.m1.1a"><msup id="S5.T2.6.4.4.4.m1.1.1" xref="S5.T2.6.4.4.4.m1.1.1.cmml"><mn id="S5.T2.6.4.4.4.m1.1.1.2" xref="S5.T2.6.4.4.4.m1.1.1.2.cmml">20</mn><mn id="S5.T2.6.4.4.4.m1.1.1.3" xref="S5.T2.6.4.4.4.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T2.6.4.4.4.m1.1b"><apply id="S5.T2.6.4.4.4.m1.1.1.cmml" xref="S5.T2.6.4.4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.6.4.4.4.m1.1.1.1.cmml" xref="S5.T2.6.4.4.4.m1.1.1">superscript</csymbol><cn id="S5.T2.6.4.4.4.m1.1.1.2.cmml" type="integer" xref="S5.T2.6.4.4.4.m1.1.1.2">20</cn><cn id="S5.T2.6.4.4.4.m1.1.1.3.cmml" type="integer" xref="S5.T2.6.4.4.4.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.4.4.4.m1.1c">20^{3}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.4.4.4.m1.1d">20 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T2.10.8.8.9">mean</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.7.5.5.5"><math alttext="20^{0}" class="ltx_Math" display="inline" id="S5.T2.7.5.5.5.m1.1"><semantics id="S5.T2.7.5.5.5.m1.1a"><msup id="S5.T2.7.5.5.5.m1.1.1" xref="S5.T2.7.5.5.5.m1.1.1.cmml"><mn id="S5.T2.7.5.5.5.m1.1.1.2" xref="S5.T2.7.5.5.5.m1.1.1.2.cmml">20</mn><mn id="S5.T2.7.5.5.5.m1.1.1.3" xref="S5.T2.7.5.5.5.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T2.7.5.5.5.m1.1b"><apply id="S5.T2.7.5.5.5.m1.1.1.cmml" xref="S5.T2.7.5.5.5.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.7.5.5.5.m1.1.1.1.cmml" xref="S5.T2.7.5.5.5.m1.1.1">superscript</csymbol><cn id="S5.T2.7.5.5.5.m1.1.1.2.cmml" type="integer" xref="S5.T2.7.5.5.5.m1.1.1.2">20</cn><cn id="S5.T2.7.5.5.5.m1.1.1.3.cmml" type="integer" xref="S5.T2.7.5.5.5.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.5.5.5.m1.1c">20^{0}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.5.5.5.m1.1d">20 start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.8.6.6.6"><math alttext="20^{1}" class="ltx_Math" display="inline" id="S5.T2.8.6.6.6.m1.1"><semantics id="S5.T2.8.6.6.6.m1.1a"><msup id="S5.T2.8.6.6.6.m1.1.1" xref="S5.T2.8.6.6.6.m1.1.1.cmml"><mn id="S5.T2.8.6.6.6.m1.1.1.2" xref="S5.T2.8.6.6.6.m1.1.1.2.cmml">20</mn><mn id="S5.T2.8.6.6.6.m1.1.1.3" xref="S5.T2.8.6.6.6.m1.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T2.8.6.6.6.m1.1b"><apply id="S5.T2.8.6.6.6.m1.1.1.cmml" xref="S5.T2.8.6.6.6.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.8.6.6.6.m1.1.1.1.cmml" xref="S5.T2.8.6.6.6.m1.1.1">superscript</csymbol><cn id="S5.T2.8.6.6.6.m1.1.1.2.cmml" type="integer" xref="S5.T2.8.6.6.6.m1.1.1.2">20</cn><cn id="S5.T2.8.6.6.6.m1.1.1.3.cmml" type="integer" xref="S5.T2.8.6.6.6.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.6.6.6.m1.1c">20^{1}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.8.6.6.6.m1.1d">20 start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.9.7.7.7"><math alttext="20^{2}" class="ltx_Math" display="inline" id="S5.T2.9.7.7.7.m1.1"><semantics id="S5.T2.9.7.7.7.m1.1a"><msup id="S5.T2.9.7.7.7.m1.1.1" xref="S5.T2.9.7.7.7.m1.1.1.cmml"><mn id="S5.T2.9.7.7.7.m1.1.1.2" xref="S5.T2.9.7.7.7.m1.1.1.2.cmml">20</mn><mn id="S5.T2.9.7.7.7.m1.1.1.3" xref="S5.T2.9.7.7.7.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T2.9.7.7.7.m1.1b"><apply id="S5.T2.9.7.7.7.m1.1.1.cmml" xref="S5.T2.9.7.7.7.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.9.7.7.7.m1.1.1.1.cmml" xref="S5.T2.9.7.7.7.m1.1.1">superscript</csymbol><cn id="S5.T2.9.7.7.7.m1.1.1.2.cmml" type="integer" xref="S5.T2.9.7.7.7.m1.1.1.2">20</cn><cn id="S5.T2.9.7.7.7.m1.1.1.3.cmml" type="integer" xref="S5.T2.9.7.7.7.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.7.7.7.m1.1c">20^{2}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.9.7.7.7.m1.1d">20 start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.10.8.8.8"><math alttext="20^{3}" class="ltx_Math" display="inline" id="S5.T2.10.8.8.8.m1.1"><semantics id="S5.T2.10.8.8.8.m1.1a"><msup id="S5.T2.10.8.8.8.m1.1.1" xref="S5.T2.10.8.8.8.m1.1.1.cmml"><mn id="S5.T2.10.8.8.8.m1.1.1.2" xref="S5.T2.10.8.8.8.m1.1.1.2.cmml">20</mn><mn id="S5.T2.10.8.8.8.m1.1.1.3" xref="S5.T2.10.8.8.8.m1.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S5.T2.10.8.8.8.m1.1b"><apply id="S5.T2.10.8.8.8.m1.1.1.cmml" xref="S5.T2.10.8.8.8.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.10.8.8.8.m1.1.1.1.cmml" xref="S5.T2.10.8.8.8.m1.1.1">superscript</csymbol><cn id="S5.T2.10.8.8.8.m1.1.1.2.cmml" type="integer" xref="S5.T2.10.8.8.8.m1.1.1.2">20</cn><cn id="S5.T2.10.8.8.8.m1.1.1.3.cmml" type="integer" xref="S5.T2.10.8.8.8.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.8.8.8.m1.1c">20^{3}</annotation><annotation encoding="application/x-llamapun" id="S5.T2.10.8.8.8.m1.1d">20 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T2.10.8.8.10">mean</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.10.8.10.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t" id="S5.T2.10.8.10.1.1">HSNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib18" title="">18</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.10.8.10.1.2">ICCV’21</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.3">37.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.4">44.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.5">42.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.6">41.3</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.10.8.10.1.7">41.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.8">45.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.9">53.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.10">51.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.11">47.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.10.8.10.1.12">49.5</td>
</tr>
<tr class="ltx_tr" id="S5.T2.10.8.11.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T2.10.8.11.2.1">CyCTR <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib50" title="">50</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.10.8.11.2.2">NeurIPS’21</th>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.3">38.9</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.4">43.0</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.5">39.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.6">39.8</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.10.8.11.2.7">40.3</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.8">41.1</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.9">48.9</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.10">45.2</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.11">47.0</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.11.2.12">45.6</td>
</tr>
<tr class="ltx_tr" id="S5.T2.10.8.12.3">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T2.10.8.12.3.1">VAT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib47" title="">47</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.10.8.12.3.2">ECCV’22</th>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.3">39.0</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.4">43.8</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.5">42.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.6">39.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.10.8.12.3.7">41.3</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.8">44.1</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.9">51.1</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.10">50.2</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.11">46.1</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.12.3.12">47.9</td>
</tr>
<tr class="ltx_tr" id="S5.T2.10.8.13.4">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T2.10.8.13.4.1">BAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib51" title="">51</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.10.8.13.4.2">CVPR’22</th>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.3">43.4</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.4">50.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.5">47.5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.6">43.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.10.8.13.4.7">46.2</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.8">49.3</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.9">54.2</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.10">51.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.11">49.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.13.4.12">51.2</td>
</tr>
<tr class="ltx_tr" id="S5.T2.10.8.14.5">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T2.10.8.14.5.1">DCAMA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib19" title="">19</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.10.8.14.5.2">ECCV’22</th>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.3">49.5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.4">52.7</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.5">52.8</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.6">48.7</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.10.8.14.5.7">50.9</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.8">55.4</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.9">60.3</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.10">59.9</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.11">57.5</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.14.5.12">58.3</td>
</tr>
<tr class="ltx_tr" id="S5.T2.10.8.15.6">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row" id="S5.T2.10.8.15.6.1">HDMNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib20" title="">20</a>]</cite>
</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.10.8.15.6.2">CVPR’23</th>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.3">43.8</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.4">55.3</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.5">51.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.6">49.4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.10.8.15.6.7">50.0</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.8">50.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.9">61.6</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.10">55.7</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.11">56.0</td>
<td class="ltx_td ltx_align_center" id="S5.T2.10.8.15.6.12">56.0</td>
</tr>
<tr class="ltx_tr" id="S5.T2.10.8.16.7">
<th class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b" id="S5.T2.10.8.16.7.1">DiffewS</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T2.10.8.16.7.2">this work</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.3">47.7</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.4">56.4</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.5">51.9</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.6">48.7</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.10.8.16.7.7">51.2</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.8">52.0</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.9">63.0</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.10">54.5</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.11">54.3</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.10.8.16.7.12">56.0</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>In-context setting</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.6">We first compare DiffewS with other generalist models such as Painter <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib29" title="">29</a>]</cite>, SegGPT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib29" title="">29</a>]</cite>, PerSAM-F<cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib49" title="">49</a>]</cite>, and Matcher <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib22" title="">22</a>]</cite> as well as specialist models like HSNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib18" title="">18</a>]</cite>, VAT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib47" title="">47</a>]</cite>, FPTrans <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib48" title="">48</a>]</cite>.
Regarding the specialist models, we directly refer to the results presented within the SegGPT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib30" title="">30</a>]</cite> and Matcher <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib22" title="">22</a>]</cite> research papers. These specialist models are also trained on the test categories from COCO <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib44" title="">44</a>]</cite> and PASCAL VOC <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib46" title="">46</a>]</cite>.
We employ COCO-20<sup class="ltx_sup" id="S5.SS1.p1.6.1"><span class="ltx_text ltx_font_italic" id="S5.SS1.p1.6.1.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib43" title="">43</a>]</cite> and PASCAL-5<sup class="ltx_sup" id="S5.SS1.p1.6.2"><span class="ltx_text ltx_font_italic" id="S5.SS1.p1.6.2.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib31" title="">31</a>]</cite> to validate the in-domain performance of DiffewS. Remarkably, on COCO, DiffewS achieves a 1-shot score of 71.3, considerably exceeding the generalist model SegGPT (+15.2) and specialist model FPTrans (+14.8), both trained with in-domain data.
DiffewS furthermore significantly outperforms SAM-based models PerSAM-F (+47.8) and Matcher (+18.6). On PASCAL-5<sup class="ltx_sup" id="S5.SS1.p1.6.3"><span class="ltx_text ltx_font_italic" id="S5.SS1.p1.6.3.1">i</span></sup>, DiffewS records 88.3 in 1-shot, clearly surpassing SegGPT (+5.1) and Matcher (+20.4).
These results evidence that DiffewS effectively utilizes the prior of Stable Diffusion, unlocking the full potential of Stable Diffusion in segmentation.
Furthermore, out-of-domain examination on LVIS-92<sup class="ltx_sup" id="S5.SS1.p1.6.4"><span class="ltx_text ltx_font_italic" id="S5.SS1.p1.6.4.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib22" title="">22</a>]</cite> underpins the generalization ability of DiffewS. In this setting, DiffewS registers 31.4 in 1-shot and 35.4 in 5-shot, markedly outperforming other generalist models, aside from Matcher.
It is worth mentioning that Matcher simultaneously utilizes two Foundation models (SAM <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib21" title="">21</a>]</cite> and DINO V2 <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib23" title="">23</a>]</cite> ), and SAM itself is pre-trained on an exhaustive, finely annotated segmentation dataset.
On the other hand, DiffewS undergoes fine-tuning on a relatively smaller quantity of segmentation data for limited iterations, still delivering performance that rivals Matcher.
This indicates that using the paradigm of DiffewS, there is potential to achieve significant breakthroughs in the segmentation field if further trained on larger-scale segmentation data.
It should be noted that the improvement of DiffewS in 5-shot is not significant, with a 4.0 distinct improvement only on LVIS-92<sup class="ltx_sup" id="S5.SS1.p1.6.5"><span class="ltx_text ltx_font_italic" id="S5.SS1.p1.6.5.1">i</span></sup>. This might be due to the presence of many small objects in the support images of LVIS, so increasing the number of support images can alleviate this problem. Conversely, the DiffewS 5-shot performance on PASCAL-5<sup class="ltx_sup" id="S5.SS1.p1.6.6"><span class="ltx_text ltx_font_italic" id="S5.SS1.p1.6.6.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib31" title="">31</a>]</cite> is slightly deficient compared to the 1-shot. This could be ascribed to the presence of relatively larger and more simplistic objects within PASCAL VOC’s support images, inputting more images might interfere with the original architecture of the model.
In the <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.SS6" title="A.6 1-shot to n-shot ‣ Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">A.6</span></a>, details of how to extend the inference to a 5-shot scenario are provided, and a discussion about this phenomenon will occur in the next section <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S5.SS2" title="5.2 Strict few-shot setting ‣ 5 Experiment ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">5.2</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Strict few-shot setting</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We also undertake validation of DiffewS under the standard few-shot setting, comparing it with other specialist models such as HSNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib18" title="">18</a>]</cite>, CyCTR <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib50" title="">50</a>]</cite>, VAT <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib47" title="">47</a>]</cite>, BAM <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib51" title="">51</a>]</cite>, HDMNet <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib20" title="">20</a>]</cite>, and DCAMA <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib19" title="">19</a>]</cite>.
For the one-shot setting, the average performance of DiffewS across all four folds attains 51.2, surpassing the current state-of-the-art (SOTA) model DCAMA, scoring 50.9 mIoU. Worth mentioning is that DCAMA relies on a highly complex additional block, whereas DiffewS entirely utilizes the generative framework of UNet. In terms of the efficiency of convergence, DiffewS necessitates just a 30000-iteration training, in contrast to both DCAMA and HSNet which require training spanning hundreds of epochs, typically costing several days.
This demonstrates the successful employment of Stable Diffusion priors by DiffewS, thereby securing impressive performance without requiring extended periods of fine-tuning.
In the five-shot setting, the average performance across four folds reaches 56.0, higher than all other models aside from DCAMA. Currently, DiffewS primarily focuses on the 1-shot situation lacking specific optimizations for the 5-shot scenario in its training and inference systems. This explains why DiffewS is at present marginally inferior to DCAMA.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Visualization</h3>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="430" id="S5.F5.g1" src="x5.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.5.2.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S5.F5.2.1" style="font-size:90%;">
Qualitative results of one-shot semantic segmentation on LVIS-92<sup class="ltx_sup" id="S5.F5.2.1.1"><span class="ltx_text ltx_font_italic" id="S5.F5.2.1.1.1">i</span></sup>. The blue color denotes the support mask while the red represents the query mask.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S5.F5" title="In 5.3 Visualization ‣ 5 Experiment ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">5</span></a>, DiffewS effectively segments categories not in the training set, such as slippers and aprons. It also accurately segments objects of different styles and smaller items, demonstrating strong generalization capabilities. In some cases, DiffewS even achieves more accurate results than GT.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this work, we have presented DiffewS, a simple and efficient framework for few-shot semantic segmentation.
By directly generating the target mask, DiffewS is capable of retaining the original latent diffusion models’ generative framework and effectively utilizing the visual prior of pre-trained diffusion models.
By introducing several designs about multi-image interaction, information injection, and supervision signals, DiffewS outperforms SOTA models in the in-context learning setting, and reaches comparable performance to specialist models in the strict few-shot setting.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dhariwal and Nichol [2021]</span>
<span class="ltx_bibblock">
Prafulla Dhariwal and Alexander Nichol.

</span>
<span class="ltx_bibblock">Diffusion models beat gans on image synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proc. Adv. Neural Inf. Process. Syst.</em>, 34:8780–8794, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rombach et al. [2022]</span>
<span class="ltx_bibblock">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn
Ommer.

</span>
<span class="ltx_bibblock">High-resolution image synthesis with latent diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hertz et al. [2022]</span>
<span class="ltx_bibblock">
Amir Hertz, Ron Mokady, Jay Tenenbaum, Kfir Aberman, Yael Pritch, and Daniel
Cohen-Or.

</span>
<span class="ltx_bibblock">Prompt-to-prompt image editing with cross attention control.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Int. Conf. Learn. Represent.</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brooks et al. [2023]</span>
<span class="ltx_bibblock">
Tim Brooks, Aleksander Holynski, and Alexei Efros.

</span>
<span class="ltx_bibblock">Instructpix2pix: Learning to follow image editing instructions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2023a]</span>
<span class="ltx_bibblock">
Jay Zhangjie Wu, Yixiao Ge, Xintao Wang, Stan Weixian Lei, Yuchao Gu, Yufei
Shi, Wynne Hsu, Ying Shan, Xiaohu Qie, and Mike Zheng Shou.

</span>
<span class="ltx_bibblock">Tune-a-video: One-shot tuning of image diffusion models for
text-to-video generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proc. IEEE/CVF Int. Conf. Computer Vision</em>, pages
7623–7633, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. [2022a]</span>
<span class="ltx_bibblock">
Jonathan Ho, Tim Salimans, Alexey Gritsenko, William Chan, Mohammad Norouzi,
and David J Fleet.

</span>
<span class="ltx_bibblock">Video diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proc. Adv. Neural Information Processing Systems</em>, 35:8633–8646, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. [2022b]</span>
<span class="ltx_bibblock">
Jonathan Ho, William Chan, Chitwan Saharia, Jay Whang, Ruiqi Gao, Alexey
Gritsenko, Diederik P Kingma, Ben Poole, Mohammad Norouzi, David J Fleet,
et al.

</span>
<span class="ltx_bibblock">Imagen video: High definition video generation with diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2210.02303</em>, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abstreiter et al. [2021]</span>
<span class="ltx_bibblock">
Korbinian Abstreiter, Sarthak Mittal, Stefan Bauer, Bernhard Schölkopf, and
Arash Mehrjou.

</span>
<span class="ltx_bibblock">Diffusion-based representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">arXiv preprint arXiv:2105.14257</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiang et al. [2023]</span>
<span class="ltx_bibblock">
Weilai Xiang, Hongyu Yang, Di Huang, and Yunhong Wang.

</span>
<span class="ltx_bibblock">Denoising diffusion autoencoders are unified self-supervised
learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Int. Conf. Comput. Vis.</em>, pages 15802–15812, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hudson et al. [2023]</span>
<span class="ltx_bibblock">
Drew A Hudson, Daniel Zoran, Mateusz Malinowski, Andrew K Lampinen, Andrew
Jaegle, James L McClelland, Loic Matthey, Felix Hill, and Alexander Lerchner.

</span>
<span class="ltx_bibblock">Soda: Bottleneck diffusion models for representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2311.17901</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2024]</span>
<span class="ltx_bibblock">
Xinlei Chen, Zhuang Liu, Saining Xie, and Kaiming He.

</span>
<span class="ltx_bibblock">Deconstructing denoising diffusion models for self-supervised
learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2401.14404</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2023]</span>
<span class="ltx_bibblock">
Wenliang Zhao, Yongming Rao, Zuyan Liu, Benlin Liu, Jie Zhou, and Jiwen Lu.

</span>
<span class="ltx_bibblock">Unleashing text-to-image diffusion models for visual perception.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Int. Conf. Comput. Vis.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ke et al. [2023]</span>
<span class="ltx_bibblock">
Bingxin Ke, Anton Obukhov, Shengyu Huang, Nando Metzger, Rodrigo Caye Daudt,
and Konrad Schindler.

</span>
<span class="ltx_bibblock">Repurposing diffusion-based image generators for monocular depth
estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2312.02145</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. [2024]</span>
<span class="ltx_bibblock">
Hsin-Ying Lee, Hung-Yu Tseng, Hsin-Ying Lee, and Ming-Hsuan Yang.

</span>
<span class="ltx_bibblock">Exploiting diffusion prior for generalizable dense prediction.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schuhmann et al. [2022]</span>
<span class="ltx_bibblock">
Christoph Schuhmann, Romain Beaumont, Richard Vencu, Cade Gordon, Ross
Wightman, Mehdi Cherti, Theo Coombes, Aarush Katta, Clayton Mullis, Mitchell
Wortsman, et al.

</span>
<span class="ltx_bibblock">Laion-5b: An open large-scale dataset for training next generation
image-text models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</em>,
35:25278–25294, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2023]</span>
<span class="ltx_bibblock">
Jiarui Xu, Sifei Liu, Arash Vahdat, Wonmin Byeon, Xiaolong Wang, and Shalini
De Mello.

</span>
<span class="ltx_bibblock">Open-vocabulary panoptic segmentation with text-to-image diffusion
models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2023b]</span>
<span class="ltx_bibblock">
Weijia Wu, Yuzhong Zhao, Hao Chen, Yuchao Gu, Rui Zhao, Yefei He, Hong Zhou,
Mike Zheng Shou, and Chunhua Shen.

</span>
<span class="ltx_bibblock">Datasetdm: Synthesizing data with perception annotations using
diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proc. Adv. Neural Inf. Process. Syst.</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et al. [2021]</span>
<span class="ltx_bibblock">
Juhong Min, Dahyun Kang, and Minsu Cho.

</span>
<span class="ltx_bibblock">Hypercorrelation squeeze for few-shot segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. [2022]</span>
<span class="ltx_bibblock">
Xinyu Shi, Dong Wei, Yu Zhang, Donghuan Lu, Munan Ning, Jiashun Chen, Kai Ma,
and Yefeng Zheng.

</span>
<span class="ltx_bibblock">Dense cross-query-and-support attention weighted mask aggregation for
few-shot segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Eur. Conf. Comput. Vis.</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. [2023]</span>
<span class="ltx_bibblock">
Bohao Peng, Zhuotao Tian, Xiaoyang Wu, Chengyao Wang, Shu Liu, Jingyong Su, and
Jiaya Jia.

</span>
<span class="ltx_bibblock">Hierarchical dense correlation distillation for few-shot
segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirillov et al. [2023]</span>
<span class="ltx_bibblock">
Alexander Kirillov, Eric Mintun, Nikhila Ravi, Hanzi Mao, Chloe Rolland, Laura
Gustafson, Tete Xiao, Spencer Whitehead, Alexander C Berg, Wan-Yen Lo, et al.

</span>
<span class="ltx_bibblock">Segment anything.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Int. Conf. Comput. Vis.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2024]</span>
<span class="ltx_bibblock">
Yang Liu, Muzhi Zhu, Hengtao Li, Hao Chen, Xinlong Wang, and Chunhua Shen.

</span>
<span class="ltx_bibblock">Matcher: Segment anything with one shot using all-purpose feature
matching.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Int. Conf. Learn. Represent.</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oquab et al. [2023]</span>
<span class="ltx_bibblock">
Maxime Oquab, Timothée Darcet, Théo Moutakanni, Huy Vo, Marc
Szafraniec, Vasil Khalidov, Pierre Fernandez, Daniel Haziza, Francisco Massa,
Alaaeldin El-Nouby, et al.

</span>
<span class="ltx_bibblock">Dinov2: Learning robust visual features without supervision.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint arXiv:2304.07193</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2023a]</span>
<span class="ltx_bibblock">
Haoxiang Wang, Pavan Kumar Anasosalu Vasu, Fartash Faghri, Raviteja
Vemulapalli, Mehrdad Farajtabar, Sachin Mehta, Mohammad Rastegari, Oncel
Tuzel, and Hadi Pouransari.

</span>
<span class="ltx_bibblock">Sam-clip: Merging vision foundation models towards semantic and
spatial understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2310.15308</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lai et al. [2023]</span>
<span class="ltx_bibblock">
Xin Lai, Zhuotao Tian, Yukang Chen, Yanwei Li, Yuhui Yuan, Shu Liu, and Jiaya
Jia.

</span>
<span class="ltx_bibblock">Lisa: Reasoning segmentation via large language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2308.00692</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al. [2023]</span>
<span class="ltx_bibblock">
Luming Tang, Menglin Jia, Qianqian Wang, Cheng Perng Phoo, and Bharath
Hariharan.

</span>
<span class="ltx_bibblock">Emergent correspondence from image diffusion.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proc. Adv. Neural Inf. Process. Syst.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2024]</span>
<span class="ltx_bibblock">
Grace Luo, Lisa Dunlap, Dong Huk Park, Aleksander Holynski, and Trevor Darrell.

</span>
<span class="ltx_bibblock">Diffusion hyperfeatures: Searching through time and space for
semantic correspondence.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proc. Adv. Neural Inf. Process. Syst.</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2024]</span>
<span class="ltx_bibblock">
Junyi Zhang, Charles Herrmann, Junhwa Hur, Luisa Polania Cabrera, Varun
Jampani, Deqing Sun, and Ming-Hsuan Yang.

</span>
<span class="ltx_bibblock">A tale of two features: Stable diffusion complements dino for
zero-shot semantic correspondence.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proc. Adv. Neural Inf. Process. Syst.</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2023b]</span>
<span class="ltx_bibblock">
Xinlong Wang, Wen Wang, Yue Cao, Chunhua Shen, and Tiejun Huang.

</span>
<span class="ltx_bibblock">Images speak in images: A generalist painter for in-context visual
learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2023c]</span>
<span class="ltx_bibblock">
Xinlong Wang, Xiaosong Zhang, Yue Cao, Wen Wang, Chunhua Shen, and Tiejun
Huang.

</span>
<span class="ltx_bibblock">Seggpt: Segmenting everything in context.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Int. Conf. Comput. Vis.</em>, 2023c.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shaban et al. [2017]</span>
<span class="ltx_bibblock">
Amirreza Shaban, Shray Bansal, Zhen Liu, Irfan Essa, and Byron Boots.

</span>
<span class="ltx_bibblock">One-shot learning for semantic segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Brit. Mach. Vis. Conf.</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rakelly et al. [2018]</span>
<span class="ltx_bibblock">
Kate Rakelly, Evan Shelhamer, Trevor Darrell, Alyosha Efros, and Sergey Levine.

</span>
<span class="ltx_bibblock">Conditional networks for few-shot semantic segmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proc. Int. Conf. Learning Representations Workshop</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2021]</span>
<span class="ltx_bibblock">
Gen Li, Varun Jampani, Laura Sevilla-Lara, Deqing Sun, Jonghyun Kim, and
Joongkyu Kim.

</span>
<span class="ltx_bibblock">Adaptive prototype learning and allocation for few-shot segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, pages 8334–8343,
2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al. [2023a]</span>
<span class="ltx_bibblock">
Henghui Ding, Chang Liu, Shuting He, Xudong Jiang, and Chen Change Loy.

</span>
<span class="ltx_bibblock">MeViS: A large-scale benchmark for video segmentation with motion
expressions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Int. Conf. Comput. Vis.</em>, pages 2694–2703,
2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ding et al. [2023b]</span>
<span class="ltx_bibblock">
Henghui Ding, Chang Liu, Shuting He, Xudong Jiang, Philip HS Torr, and Song
Bai.

</span>
<span class="ltx_bibblock">MOSE: A new dataset for video object segmentation in complex
scenes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Int. Conf. Comput. Vis.</em>, pages 20224–20234,
2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2019]</span>
<span class="ltx_bibblock">
Chi Zhang, Guosheng Lin, Fayao Liu, Jiushuang Guo, Qingyao Wu, and Rui Yao.

</span>
<span class="ltx_bibblock">Pyramid graph networks with connection attentions for region-based
one-shot semantic segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Int. Conf. Comput. Vis.</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2020]</span>
<span class="ltx_bibblock">
Haochen Wang, Xudong Zhang, Yutao Hu, Yandan Yang, Xianbin Cao, and Xiantong
Zhen.

</span>
<span class="ltx_bibblock">Few-shot semantic segmentation with democratic attention networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Eur. Conf. Comput. Vis.</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. [2023]</span>
<span class="ltx_bibblock">
Yuxiang Wei, Yabo Zhang, Zhilong Ji, Jinfeng Bai, Lei Zhang, and Wangmeng Zuo.

</span>
<span class="ltx_bibblock">Elite: Encoding visual concepts into textual embeddings for
customized text-to-image generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Int. Conf. Comput. Vis.</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023]</span>
<span class="ltx_bibblock">
Zhen Li, Mingdeng Cao, Xintao Wang, Zhongang Qi, Ming-Ming Cheng, and Ying
Shan.

</span>
<span class="ltx_bibblock">Photomaker: Customizing realistic human photos via stacked id
embedding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2312.04461</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2024]</span>
<span class="ltx_bibblock">
Qixun Wang, Xu Bai, Haofan Wang, Zekui Qin, and Anthony Chen.

</span>
<span class="ltx_bibblock">Instantid: Zero-shot identity-preserving generation in seconds.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2401.07519</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2024]</span>
<span class="ltx_bibblock">
Lingfeng Yang, Yueze Wang, Xiang Li, Xinlong Wang, and Jian Yang.

</span>
<span class="ltx_bibblock">Fine-grained visual prompting.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">Proc. Adv. Neural Inf. Process. Syst.</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. [2023]</span>
<span class="ltx_bibblock">
Hsin-Ying Lee, Hung-Yu Tseng, and Ming-Hsuan Yang.

</span>
<span class="ltx_bibblock">Exploiting diffusion prior for generalizable pixel-level semantic
prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:2311.18832</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen and Todorovic [2019]</span>
<span class="ltx_bibblock">
Khoi Nguyen and Sinisa Todorovic.

</span>
<span class="ltx_bibblock">Feature weighting and boosting for few-shot segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Int. Conf. Comput. Vis.</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2014]</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Eur. Conf. Comput. Vis.</em>, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2017]</span>
<span class="ltx_bibblock">
Bolei Zhou, Hang Zhao, Xavier Puig, Sanja Fidler, Adela Barriuso, and Antonio
Torralba.

</span>
<span class="ltx_bibblock">Scene parsing through ade20k dataset.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Everingham et al. [2010]</span>
<span class="ltx_bibblock">
Mark Everingham, Luc Van Gool, Christopher KI Williams, John Winn, and Andrew
Zisserman.

</span>
<span class="ltx_bibblock">The pascal visual object classes (voc) challenge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Int. J. Comput. Vis.</em>, 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et al. [2022]</span>
<span class="ltx_bibblock">
Sunghwan Hong, Seokju Cho, Jisu Nam, Stephen Lin, and Seungryong Kim.

</span>
<span class="ltx_bibblock">Cost aggregation with 4d convolutional swin transformer for few-shot
segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Eur. Conf. Comput. Vis.</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2022]</span>
<span class="ltx_bibblock">
Jian-Wei Zhang, Yifan Sun, Yi Yang, and Wei Chen.

</span>
<span class="ltx_bibblock">Feature-proxy transformer for few-shot segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proc. Adv. Neural Inf. Process. Syst.</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2023]</span>
<span class="ltx_bibblock">
Renrui Zhang, Zhengkai Jiang, Ziyu Guo, Shilin Yan, Junting Pan, Hao Dong, Peng
Gao, and Hongsheng Li.

</span>
<span class="ltx_bibblock">Personalize segment anything model with one shot.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">arXiv preprint arXiv:2305.03048</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2021]</span>
<span class="ltx_bibblock">
Gengwei Zhang, Guoliang Kang, Yi Yang, and Yunchao Wei.

</span>
<span class="ltx_bibblock">Few-shot segmentation via cycle-consistent transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proc. Adv. Neural Inf. Process. Syst.</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lang et al. [2022]</span>
<span class="ltx_bibblock">
Chunbo Lang, Gong Cheng, Binfei Tu, and Junwei Han.

</span>
<span class="ltx_bibblock">Learning what not to segment: A new perspective on few-shot
segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">IEEE Conf. Comput. Vis. Pattern Recog.</em>, 2022.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Discussion</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p1.1.1">Broader Impacts</span> We do not foresee any obvious undesirable ethical or social impacts now.</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p2.1.1">Limitations</span> Our method, as the first diffusion-based FSS model, proposes a simple and intuitive design, which maximizes the retention of the generative framework of LDM. There is still a lot of room for improvement in performance (especially in the n-shot setting), including more sophisticated model design and more optimized training strategies. We hope that our method can serve as a diffusion-based FSS baseline to inspire more researchers to invest in this field.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>More details on generation process</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">In the above section we have discussed the generation process of DiffewS. In addition to the final choice of OI2M, we also tried MN2M and MI2M. Here we detail the training objectives of these three generation processes.</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS2.p2.1.1">OI2M</span> We directly input the image and let the UNet output the mask. This process can be described as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L_{\mathbf{OI2M}}}=\mathbb{E}_{(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf%
{z}_{ms},\mathbf{z}_{mq})\sim\mathcal{D}}\left[\left\|\mathbf{z}_{mq}-v^{*}_{%
\theta}\left(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf{z}_{ms}\right)\right\|_{2}^%
{2}\right]" class="ltx_Math" display="block" id="A1.E8.m1.5"><semantics id="A1.E8.m1.5a"><mrow id="A1.E8.m1.5.5" xref="A1.E8.m1.5.5.cmml"><msub id="A1.E8.m1.5.5.3" xref="A1.E8.m1.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E8.m1.5.5.3.2" xref="A1.E8.m1.5.5.3.2.cmml">ℒ</mi><mi id="A1.E8.m1.5.5.3.3" xref="A1.E8.m1.5.5.3.3.cmml">𝐎𝐈𝟐𝐌</mi></msub><mo id="A1.E8.m1.5.5.2" xref="A1.E8.m1.5.5.2.cmml">=</mo><mrow id="A1.E8.m1.5.5.1" xref="A1.E8.m1.5.5.1.cmml"><msub id="A1.E8.m1.5.5.1.3" xref="A1.E8.m1.5.5.1.3.cmml"><mi id="A1.E8.m1.5.5.1.3.2" xref="A1.E8.m1.5.5.1.3.2.cmml">𝔼</mi><mrow id="A1.E8.m1.4.4.4" xref="A1.E8.m1.4.4.4.cmml"><mrow id="A1.E8.m1.4.4.4.4.4" xref="A1.E8.m1.4.4.4.4.5.cmml"><mo id="A1.E8.m1.4.4.4.4.4.5" stretchy="false" xref="A1.E8.m1.4.4.4.4.5.cmml">(</mo><msub id="A1.E8.m1.1.1.1.1.1.1" xref="A1.E8.m1.1.1.1.1.1.1.cmml"><mi id="A1.E8.m1.1.1.1.1.1.1.2" xref="A1.E8.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="A1.E8.m1.1.1.1.1.1.1.3" xref="A1.E8.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A1.E8.m1.4.4.4.4.4.6" xref="A1.E8.m1.4.4.4.4.5.cmml">,</mo><msub id="A1.E8.m1.2.2.2.2.2.2" xref="A1.E8.m1.2.2.2.2.2.2.cmml"><mi id="A1.E8.m1.2.2.2.2.2.2.2" xref="A1.E8.m1.2.2.2.2.2.2.2.cmml">𝐳</mi><mi id="A1.E8.m1.2.2.2.2.2.2.3" xref="A1.E8.m1.2.2.2.2.2.2.3.cmml">q</mi></msub><mo id="A1.E8.m1.4.4.4.4.4.7" xref="A1.E8.m1.4.4.4.4.5.cmml">,</mo><msub id="A1.E8.m1.3.3.3.3.3.3" xref="A1.E8.m1.3.3.3.3.3.3.cmml"><mi id="A1.E8.m1.3.3.3.3.3.3.2" xref="A1.E8.m1.3.3.3.3.3.3.2.cmml">𝐳</mi><mrow id="A1.E8.m1.3.3.3.3.3.3.3" xref="A1.E8.m1.3.3.3.3.3.3.3.cmml"><mi id="A1.E8.m1.3.3.3.3.3.3.3.2" xref="A1.E8.m1.3.3.3.3.3.3.3.2.cmml">m</mi><mo id="A1.E8.m1.3.3.3.3.3.3.3.1" xref="A1.E8.m1.3.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E8.m1.3.3.3.3.3.3.3.3" xref="A1.E8.m1.3.3.3.3.3.3.3.3.cmml">s</mi></mrow></msub><mo id="A1.E8.m1.4.4.4.4.4.8" xref="A1.E8.m1.4.4.4.4.5.cmml">,</mo><msub id="A1.E8.m1.4.4.4.4.4.4" xref="A1.E8.m1.4.4.4.4.4.4.cmml"><mi id="A1.E8.m1.4.4.4.4.4.4.2" xref="A1.E8.m1.4.4.4.4.4.4.2.cmml">𝐳</mi><mrow id="A1.E8.m1.4.4.4.4.4.4.3" xref="A1.E8.m1.4.4.4.4.4.4.3.cmml"><mi id="A1.E8.m1.4.4.4.4.4.4.3.2" xref="A1.E8.m1.4.4.4.4.4.4.3.2.cmml">m</mi><mo id="A1.E8.m1.4.4.4.4.4.4.3.1" xref="A1.E8.m1.4.4.4.4.4.4.3.1.cmml">⁢</mo><mi id="A1.E8.m1.4.4.4.4.4.4.3.3" xref="A1.E8.m1.4.4.4.4.4.4.3.3.cmml">q</mi></mrow></msub><mo id="A1.E8.m1.4.4.4.4.4.9" stretchy="false" xref="A1.E8.m1.4.4.4.4.5.cmml">)</mo></mrow><mo id="A1.E8.m1.4.4.4.5" xref="A1.E8.m1.4.4.4.5.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E8.m1.4.4.4.6" xref="A1.E8.m1.4.4.4.6.cmml">𝒟</mi></mrow></msub><mo id="A1.E8.m1.5.5.1.2" xref="A1.E8.m1.5.5.1.2.cmml">⁢</mo><mrow id="A1.E8.m1.5.5.1.1.1" xref="A1.E8.m1.5.5.1.1.2.cmml"><mo id="A1.E8.m1.5.5.1.1.1.2" xref="A1.E8.m1.5.5.1.1.2.1.cmml">[</mo><msubsup id="A1.E8.m1.5.5.1.1.1.1" xref="A1.E8.m1.5.5.1.1.1.1.cmml"><mrow id="A1.E8.m1.5.5.1.1.1.1.1.1.1" xref="A1.E8.m1.5.5.1.1.1.1.1.1.2.cmml"><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.cmml"><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.2.cmml">𝐳</mi><mrow id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.cmml"><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.2.cmml">m</mi><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.1" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.1.cmml">⁢</mo><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.3.cmml">q</mi></mrow></msub><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.4" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.4.cmml">−</mo><mrow id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><msubsup id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.cmml"><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.2.cmml">v</mi><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.3.cmml">θ</mi><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.3.cmml">∗</mo></msubsup><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.4" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.4.cmml">⁢</mo><mrow id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml"><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.4" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">(</mo><msub id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.5" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐳</mi><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">q</mi></msub><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.6" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msub id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">𝐳</mi><mrow id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml"><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.2" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.2.cmml">m</mi><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.1" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml">s</mi></mrow></msub><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.7" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E8.m1.5.5.1.1.1.1.1.1.1.3" xref="A1.E8.m1.5.5.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E8.m1.5.5.1.1.1.1.1.3" xref="A1.E8.m1.5.5.1.1.1.1.1.3.cmml">2</mn><mn id="A1.E8.m1.5.5.1.1.1.1.3" xref="A1.E8.m1.5.5.1.1.1.1.3.cmml">2</mn></msubsup><mo id="A1.E8.m1.5.5.1.1.1.3" xref="A1.E8.m1.5.5.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E8.m1.5b"><apply id="A1.E8.m1.5.5.cmml" xref="A1.E8.m1.5.5"><eq id="A1.E8.m1.5.5.2.cmml" xref="A1.E8.m1.5.5.2"></eq><apply id="A1.E8.m1.5.5.3.cmml" xref="A1.E8.m1.5.5.3"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.3.1.cmml" xref="A1.E8.m1.5.5.3">subscript</csymbol><ci id="A1.E8.m1.5.5.3.2.cmml" xref="A1.E8.m1.5.5.3.2">ℒ</ci><ci id="A1.E8.m1.5.5.3.3.cmml" xref="A1.E8.m1.5.5.3.3">𝐎𝐈𝟐𝐌</ci></apply><apply id="A1.E8.m1.5.5.1.cmml" xref="A1.E8.m1.5.5.1"><times id="A1.E8.m1.5.5.1.2.cmml" xref="A1.E8.m1.5.5.1.2"></times><apply id="A1.E8.m1.5.5.1.3.cmml" xref="A1.E8.m1.5.5.1.3"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.3.1.cmml" xref="A1.E8.m1.5.5.1.3">subscript</csymbol><ci id="A1.E8.m1.5.5.1.3.2.cmml" xref="A1.E8.m1.5.5.1.3.2">𝔼</ci><apply id="A1.E8.m1.4.4.4.cmml" xref="A1.E8.m1.4.4.4"><csymbol cd="latexml" id="A1.E8.m1.4.4.4.5.cmml" xref="A1.E8.m1.4.4.4.5">similar-to</csymbol><vector id="A1.E8.m1.4.4.4.4.5.cmml" xref="A1.E8.m1.4.4.4.4.4"><apply id="A1.E8.m1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.1.1.1.1.1.1.2">𝐳</ci><ci id="A1.E8.m1.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A1.E8.m1.2.2.2.2.2.2.cmml" xref="A1.E8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.2.2.2.2.2.2.1.cmml" xref="A1.E8.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E8.m1.2.2.2.2.2.2.2.cmml" xref="A1.E8.m1.2.2.2.2.2.2.2">𝐳</ci><ci id="A1.E8.m1.2.2.2.2.2.2.3.cmml" xref="A1.E8.m1.2.2.2.2.2.2.3">𝑞</ci></apply><apply id="A1.E8.m1.3.3.3.3.3.3.cmml" xref="A1.E8.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.3.3.3.3.3.3.1.cmml" xref="A1.E8.m1.3.3.3.3.3.3">subscript</csymbol><ci id="A1.E8.m1.3.3.3.3.3.3.2.cmml" xref="A1.E8.m1.3.3.3.3.3.3.2">𝐳</ci><apply id="A1.E8.m1.3.3.3.3.3.3.3.cmml" xref="A1.E8.m1.3.3.3.3.3.3.3"><times id="A1.E8.m1.3.3.3.3.3.3.3.1.cmml" xref="A1.E8.m1.3.3.3.3.3.3.3.1"></times><ci id="A1.E8.m1.3.3.3.3.3.3.3.2.cmml" xref="A1.E8.m1.3.3.3.3.3.3.3.2">𝑚</ci><ci id="A1.E8.m1.3.3.3.3.3.3.3.3.cmml" xref="A1.E8.m1.3.3.3.3.3.3.3.3">𝑠</ci></apply></apply><apply id="A1.E8.m1.4.4.4.4.4.4.cmml" xref="A1.E8.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="A1.E8.m1.4.4.4.4.4.4.1.cmml" xref="A1.E8.m1.4.4.4.4.4.4">subscript</csymbol><ci id="A1.E8.m1.4.4.4.4.4.4.2.cmml" xref="A1.E8.m1.4.4.4.4.4.4.2">𝐳</ci><apply id="A1.E8.m1.4.4.4.4.4.4.3.cmml" xref="A1.E8.m1.4.4.4.4.4.4.3"><times id="A1.E8.m1.4.4.4.4.4.4.3.1.cmml" xref="A1.E8.m1.4.4.4.4.4.4.3.1"></times><ci id="A1.E8.m1.4.4.4.4.4.4.3.2.cmml" xref="A1.E8.m1.4.4.4.4.4.4.3.2">𝑚</ci><ci id="A1.E8.m1.4.4.4.4.4.4.3.3.cmml" xref="A1.E8.m1.4.4.4.4.4.4.3.3">𝑞</ci></apply></apply></vector><ci id="A1.E8.m1.4.4.4.6.cmml" xref="A1.E8.m1.4.4.4.6">𝒟</ci></apply></apply><apply id="A1.E8.m1.5.5.1.1.2.cmml" xref="A1.E8.m1.5.5.1.1.1"><csymbol cd="latexml" id="A1.E8.m1.5.5.1.1.2.1.cmml" xref="A1.E8.m1.5.5.1.1.1.2">delimited-[]</csymbol><apply id="A1.E8.m1.5.5.1.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1">superscript</csymbol><apply id="A1.E8.m1.5.5.1.1.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.1.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1">subscript</csymbol><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E8.m1.5.5.1.1.1.1.1.1.2.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1"><minus id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.4"></minus><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.2">𝐳</ci><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3"><times id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.1"></times><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.2">𝑚</ci><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.5.3.3">𝑞</ci></apply></apply><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3"><times id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.4.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.4"></times><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5">subscript</csymbol><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5">superscript</csymbol><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.2">𝑣</ci><times id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.2.3"></times></apply><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.5.3">𝜃</ci></apply><vector id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3"><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐳</ci><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑞</ci></apply><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.2">𝐳</ci><apply id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3"><times id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.1.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.1"></times><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.2.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.2">𝑚</ci><ci id="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.3.cmml" xref="A1.E8.m1.5.5.1.1.1.1.1.1.1.1.3.3.3.3.3.3">𝑠</ci></apply></apply></vector></apply></apply></apply><cn id="A1.E8.m1.5.5.1.1.1.1.1.3.cmml" type="integer" xref="A1.E8.m1.5.5.1.1.1.1.1.3">2</cn></apply><cn id="A1.E8.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="A1.E8.m1.5.5.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E8.m1.5c">\mathcal{L_{\mathbf{OI2M}}}=\mathbb{E}_{(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf%
{z}_{ms},\mathbf{z}_{mq})\sim\mathcal{D}}\left[\left\|\mathbf{z}_{mq}-v^{*}_{%
\theta}\left(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf{z}_{ms}\right)\right\|_{2}^%
{2}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E8.m1.5d">caligraphic_L start_POSTSUBSCRIPT bold_OI2M end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ ∥ bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT - italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_s end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="A1.SS2.p3">
<p class="ltx_p" id="A1.SS2.p3.3"><span class="ltx_text ltx_font_bold" id="A1.SS2.p3.3.1">MN2M</span> We add noise to query mask <math alttext="\mathbf{z}_{mq}" class="ltx_Math" display="inline" id="A1.SS2.p3.1.m1.1"><semantics id="A1.SS2.p3.1.m1.1a"><msub id="A1.SS2.p3.1.m1.1.1" xref="A1.SS2.p3.1.m1.1.1.cmml"><mi id="A1.SS2.p3.1.m1.1.1.2" xref="A1.SS2.p3.1.m1.1.1.2.cmml">𝐳</mi><mrow id="A1.SS2.p3.1.m1.1.1.3" xref="A1.SS2.p3.1.m1.1.1.3.cmml"><mi id="A1.SS2.p3.1.m1.1.1.3.2" xref="A1.SS2.p3.1.m1.1.1.3.2.cmml">m</mi><mo id="A1.SS2.p3.1.m1.1.1.3.1" xref="A1.SS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.1.m1.1.1.3.3" xref="A1.SS2.p3.1.m1.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.1.m1.1b"><apply id="A1.SS2.p3.1.m1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.1.m1.1.1.1.cmml" xref="A1.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS2.p3.1.m1.1.1.2.cmml" xref="A1.SS2.p3.1.m1.1.1.2">𝐳</ci><apply id="A1.SS2.p3.1.m1.1.1.3.cmml" xref="A1.SS2.p3.1.m1.1.1.3"><times id="A1.SS2.p3.1.m1.1.1.3.1.cmml" xref="A1.SS2.p3.1.m1.1.1.3.1"></times><ci id="A1.SS2.p3.1.m1.1.1.3.2.cmml" xref="A1.SS2.p3.1.m1.1.1.3.2">𝑚</ci><ci id="A1.SS2.p3.1.m1.1.1.3.3.cmml" xref="A1.SS2.p3.1.m1.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.1.m1.1c">\mathbf{z}_{mq}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.1.m1.1d">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}_{mq}^{(t)}=\sqrt{\bar{\alpha}_{t}}\mathbf{z}_{mq}+\sqrt{1-\bar{%
\alpha}_{t}}{\mathbf{\epsilon}}" class="ltx_Math" display="inline" id="A1.SS2.p3.2.m2.1"><semantics id="A1.SS2.p3.2.m2.1a"><mrow id="A1.SS2.p3.2.m2.1.2" xref="A1.SS2.p3.2.m2.1.2.cmml"><msubsup id="A1.SS2.p3.2.m2.1.2.2" xref="A1.SS2.p3.2.m2.1.2.2.cmml"><mi id="A1.SS2.p3.2.m2.1.2.2.2.2" xref="A1.SS2.p3.2.m2.1.2.2.2.2.cmml">𝐳</mi><mrow id="A1.SS2.p3.2.m2.1.2.2.2.3" xref="A1.SS2.p3.2.m2.1.2.2.2.3.cmml"><mi id="A1.SS2.p3.2.m2.1.2.2.2.3.2" xref="A1.SS2.p3.2.m2.1.2.2.2.3.2.cmml">m</mi><mo id="A1.SS2.p3.2.m2.1.2.2.2.3.1" xref="A1.SS2.p3.2.m2.1.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.2.m2.1.2.2.2.3.3" xref="A1.SS2.p3.2.m2.1.2.2.2.3.3.cmml">q</mi></mrow><mrow id="A1.SS2.p3.2.m2.1.1.1.3" xref="A1.SS2.p3.2.m2.1.2.2.cmml"><mo id="A1.SS2.p3.2.m2.1.1.1.3.1" stretchy="false" xref="A1.SS2.p3.2.m2.1.2.2.cmml">(</mo><mi id="A1.SS2.p3.2.m2.1.1.1.1" xref="A1.SS2.p3.2.m2.1.1.1.1.cmml">t</mi><mo id="A1.SS2.p3.2.m2.1.1.1.3.2" stretchy="false" xref="A1.SS2.p3.2.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.SS2.p3.2.m2.1.2.1" xref="A1.SS2.p3.2.m2.1.2.1.cmml">=</mo><mrow id="A1.SS2.p3.2.m2.1.2.3" xref="A1.SS2.p3.2.m2.1.2.3.cmml"><mrow id="A1.SS2.p3.2.m2.1.2.3.2" xref="A1.SS2.p3.2.m2.1.2.3.2.cmml"><msqrt id="A1.SS2.p3.2.m2.1.2.3.2.2" xref="A1.SS2.p3.2.m2.1.2.3.2.2.cmml"><msub id="A1.SS2.p3.2.m2.1.2.3.2.2.2" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.cmml"><mover accent="true" id="A1.SS2.p3.2.m2.1.2.3.2.2.2.2" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.cmml"><mi id="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.2" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.2.cmml">α</mi><mo id="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.1" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.1.cmml">¯</mo></mover><mi id="A1.SS2.p3.2.m2.1.2.3.2.2.2.3" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.3.cmml">t</mi></msub></msqrt><mo id="A1.SS2.p3.2.m2.1.2.3.2.1" xref="A1.SS2.p3.2.m2.1.2.3.2.1.cmml">⁢</mo><msub id="A1.SS2.p3.2.m2.1.2.3.2.3" xref="A1.SS2.p3.2.m2.1.2.3.2.3.cmml"><mi id="A1.SS2.p3.2.m2.1.2.3.2.3.2" xref="A1.SS2.p3.2.m2.1.2.3.2.3.2.cmml">𝐳</mi><mrow id="A1.SS2.p3.2.m2.1.2.3.2.3.3" xref="A1.SS2.p3.2.m2.1.2.3.2.3.3.cmml"><mi id="A1.SS2.p3.2.m2.1.2.3.2.3.3.2" xref="A1.SS2.p3.2.m2.1.2.3.2.3.3.2.cmml">m</mi><mo id="A1.SS2.p3.2.m2.1.2.3.2.3.3.1" xref="A1.SS2.p3.2.m2.1.2.3.2.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.2.m2.1.2.3.2.3.3.3" xref="A1.SS2.p3.2.m2.1.2.3.2.3.3.3.cmml">q</mi></mrow></msub></mrow><mo id="A1.SS2.p3.2.m2.1.2.3.1" xref="A1.SS2.p3.2.m2.1.2.3.1.cmml">+</mo><mrow id="A1.SS2.p3.2.m2.1.2.3.3" xref="A1.SS2.p3.2.m2.1.2.3.3.cmml"><msqrt id="A1.SS2.p3.2.m2.1.2.3.3.2" xref="A1.SS2.p3.2.m2.1.2.3.3.2.cmml"><mrow id="A1.SS2.p3.2.m2.1.2.3.3.2.2" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.cmml"><mn id="A1.SS2.p3.2.m2.1.2.3.3.2.2.2" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.2.cmml">1</mn><mo id="A1.SS2.p3.2.m2.1.2.3.3.2.2.1" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.1.cmml">−</mo><msub id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.cmml"><mover accent="true" id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.cmml"><mi id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.2" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.2.cmml">α</mi><mo id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.1" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.1.cmml">¯</mo></mover><mi id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.3" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="A1.SS2.p3.2.m2.1.2.3.3.1" xref="A1.SS2.p3.2.m2.1.2.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.2.m2.1.2.3.3.3" xref="A1.SS2.p3.2.m2.1.2.3.3.3.cmml">ϵ</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.2.m2.1b"><apply id="A1.SS2.p3.2.m2.1.2.cmml" xref="A1.SS2.p3.2.m2.1.2"><eq id="A1.SS2.p3.2.m2.1.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.1"></eq><apply id="A1.SS2.p3.2.m2.1.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.2.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.2">superscript</csymbol><apply id="A1.SS2.p3.2.m2.1.2.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.2.2.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.2">subscript</csymbol><ci id="A1.SS2.p3.2.m2.1.2.2.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.2.2.2">𝐳</ci><apply id="A1.SS2.p3.2.m2.1.2.2.2.3.cmml" xref="A1.SS2.p3.2.m2.1.2.2.2.3"><times id="A1.SS2.p3.2.m2.1.2.2.2.3.1.cmml" xref="A1.SS2.p3.2.m2.1.2.2.2.3.1"></times><ci id="A1.SS2.p3.2.m2.1.2.2.2.3.2.cmml" xref="A1.SS2.p3.2.m2.1.2.2.2.3.2">𝑚</ci><ci id="A1.SS2.p3.2.m2.1.2.2.2.3.3.cmml" xref="A1.SS2.p3.2.m2.1.2.2.2.3.3">𝑞</ci></apply></apply><ci id="A1.SS2.p3.2.m2.1.1.1.1.cmml" xref="A1.SS2.p3.2.m2.1.1.1.1">𝑡</ci></apply><apply id="A1.SS2.p3.2.m2.1.2.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3"><plus id="A1.SS2.p3.2.m2.1.2.3.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.1"></plus><apply id="A1.SS2.p3.2.m2.1.2.3.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2"><times id="A1.SS2.p3.2.m2.1.2.3.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.1"></times><apply id="A1.SS2.p3.2.m2.1.2.3.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.2"><root id="A1.SS2.p3.2.m2.1.2.3.2.2a.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.2"></root><apply id="A1.SS2.p3.2.m2.1.2.3.2.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.2.3.2.2.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2">subscript</csymbol><apply id="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.2"><ci id="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.1">¯</ci><ci id="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.2.2">𝛼</ci></apply><ci id="A1.SS2.p3.2.m2.1.2.3.2.2.2.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.2.2.3">𝑡</ci></apply></apply><apply id="A1.SS2.p3.2.m2.1.2.3.2.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.3"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.2.3.2.3.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.3">subscript</csymbol><ci id="A1.SS2.p3.2.m2.1.2.3.2.3.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.3.2">𝐳</ci><apply id="A1.SS2.p3.2.m2.1.2.3.2.3.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.3.3"><times id="A1.SS2.p3.2.m2.1.2.3.2.3.3.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.3.3.1"></times><ci id="A1.SS2.p3.2.m2.1.2.3.2.3.3.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.3.3.2">𝑚</ci><ci id="A1.SS2.p3.2.m2.1.2.3.2.3.3.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3.2.3.3.3">𝑞</ci></apply></apply></apply><apply id="A1.SS2.p3.2.m2.1.2.3.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3"><times id="A1.SS2.p3.2.m2.1.2.3.3.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.1"></times><apply id="A1.SS2.p3.2.m2.1.2.3.3.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2"><root id="A1.SS2.p3.2.m2.1.2.3.3.2a.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2"></root><apply id="A1.SS2.p3.2.m2.1.2.3.3.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2"><minus id="A1.SS2.p3.2.m2.1.2.3.3.2.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.1"></minus><cn id="A1.SS2.p3.2.m2.1.2.3.3.2.2.2.cmml" type="integer" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.2">1</cn><apply id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3">subscript</csymbol><apply id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2"><ci id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.1.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.1">¯</ci><ci id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.2.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.2.2">𝛼</ci></apply><ci id="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.2.2.3.3">𝑡</ci></apply></apply></apply><ci id="A1.SS2.p3.2.m2.1.2.3.3.3.cmml" xref="A1.SS2.p3.2.m2.1.2.3.3.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.2.m2.1c">\mathbf{z}_{mq}^{(t)}=\sqrt{\bar{\alpha}_{t}}\mathbf{z}_{mq}+\sqrt{1-\bar{%
\alpha}_{t}}{\mathbf{\epsilon}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.2.m2.1d">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT = square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT + square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_ϵ</annotation></semantics></math>, and during inference we use <math alttext="\mathbf{z}_{mq}^{(0)}" class="ltx_Math" display="inline" id="A1.SS2.p3.3.m3.1"><semantics id="A1.SS2.p3.3.m3.1a"><msubsup id="A1.SS2.p3.3.m3.1.2" xref="A1.SS2.p3.3.m3.1.2.cmml"><mi id="A1.SS2.p3.3.m3.1.2.2.2" xref="A1.SS2.p3.3.m3.1.2.2.2.cmml">𝐳</mi><mrow id="A1.SS2.p3.3.m3.1.2.2.3" xref="A1.SS2.p3.3.m3.1.2.2.3.cmml"><mi id="A1.SS2.p3.3.m3.1.2.2.3.2" xref="A1.SS2.p3.3.m3.1.2.2.3.2.cmml">m</mi><mo id="A1.SS2.p3.3.m3.1.2.2.3.1" xref="A1.SS2.p3.3.m3.1.2.2.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.3.m3.1.2.2.3.3" xref="A1.SS2.p3.3.m3.1.2.2.3.3.cmml">q</mi></mrow><mrow id="A1.SS2.p3.3.m3.1.1.1.3" xref="A1.SS2.p3.3.m3.1.2.cmml"><mo id="A1.SS2.p3.3.m3.1.1.1.3.1" stretchy="false" xref="A1.SS2.p3.3.m3.1.2.cmml">(</mo><mn id="A1.SS2.p3.3.m3.1.1.1.1" xref="A1.SS2.p3.3.m3.1.1.1.1.cmml">0</mn><mo id="A1.SS2.p3.3.m3.1.1.1.3.2" stretchy="false" xref="A1.SS2.p3.3.m3.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.3.m3.1b"><apply id="A1.SS2.p3.3.m3.1.2.cmml" xref="A1.SS2.p3.3.m3.1.2"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.2.1.cmml" xref="A1.SS2.p3.3.m3.1.2">superscript</csymbol><apply id="A1.SS2.p3.3.m3.1.2.2.cmml" xref="A1.SS2.p3.3.m3.1.2"><csymbol cd="ambiguous" id="A1.SS2.p3.3.m3.1.2.2.1.cmml" xref="A1.SS2.p3.3.m3.1.2">subscript</csymbol><ci id="A1.SS2.p3.3.m3.1.2.2.2.cmml" xref="A1.SS2.p3.3.m3.1.2.2.2">𝐳</ci><apply id="A1.SS2.p3.3.m3.1.2.2.3.cmml" xref="A1.SS2.p3.3.m3.1.2.2.3"><times id="A1.SS2.p3.3.m3.1.2.2.3.1.cmml" xref="A1.SS2.p3.3.m3.1.2.2.3.1"></times><ci id="A1.SS2.p3.3.m3.1.2.2.3.2.cmml" xref="A1.SS2.p3.3.m3.1.2.2.3.2">𝑚</ci><ci id="A1.SS2.p3.3.m3.1.2.2.3.3.cmml" xref="A1.SS2.p3.3.m3.1.2.2.3.3">𝑞</ci></apply></apply><cn id="A1.SS2.p3.3.m3.1.1.1.1.cmml" type="integer" xref="A1.SS2.p3.3.m3.1.1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.3.m3.1c">\mathbf{z}_{mq}^{(0)}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.3.m3.1d">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 0 ) end_POSTSUPERSCRIPT</annotation></semantics></math> as the mask prediction. The supervised form is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L_{\mathbf{MN2M}}}=\mathbb{E}_{(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf%
{z}_{ms},\mathbf{z}_{mq})\sim\mathcal{D},\mathbf{\epsilon}\sim\mathcal{N}(0,1)%
,t\in\mathcal{U}(T)}\left[\left\|\mathbf{z}_{mq}-v^{*}_{\theta}\left(\mathbf{z%
}_{mq}^{(t)},\mathbf{z}_{s},\mathbf{z}_{q},\mathbf{z}_{ms},t\right)\right\|_{2%
}^{2}\right]" class="ltx_Math" display="block" id="A1.E9.m1.8"><semantics id="A1.E9.m1.8a"><mrow id="A1.E9.m1.8.8" xref="A1.E9.m1.8.8.cmml"><msub id="A1.E9.m1.8.8.3" xref="A1.E9.m1.8.8.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E9.m1.8.8.3.2" xref="A1.E9.m1.8.8.3.2.cmml">ℒ</mi><mi id="A1.E9.m1.8.8.3.3" xref="A1.E9.m1.8.8.3.3.cmml">𝐌𝐍𝟐𝐌</mi></msub><mo id="A1.E9.m1.8.8.2" xref="A1.E9.m1.8.8.2.cmml">=</mo><mrow id="A1.E9.m1.8.8.1" xref="A1.E9.m1.8.8.1.cmml"><msub id="A1.E9.m1.8.8.1.3" xref="A1.E9.m1.8.8.1.3.cmml"><mi id="A1.E9.m1.8.8.1.3.2" xref="A1.E9.m1.8.8.1.3.2.cmml">𝔼</mi><mrow id="A1.E9.m1.5.5.5.5" xref="A1.E9.m1.5.5.5.6.cmml"><mrow id="A1.E9.m1.4.4.4.4.1" xref="A1.E9.m1.4.4.4.4.1.cmml"><mrow id="A1.E9.m1.4.4.4.4.1.4.4" xref="A1.E9.m1.4.4.4.4.1.4.5.cmml"><mo id="A1.E9.m1.4.4.4.4.1.4.4.5" stretchy="false" xref="A1.E9.m1.4.4.4.4.1.4.5.cmml">(</mo><msub id="A1.E9.m1.4.4.4.4.1.1.1.1" xref="A1.E9.m1.4.4.4.4.1.1.1.1.cmml"><mi id="A1.E9.m1.4.4.4.4.1.1.1.1.2" xref="A1.E9.m1.4.4.4.4.1.1.1.1.2.cmml">𝐳</mi><mi id="A1.E9.m1.4.4.4.4.1.1.1.1.3" xref="A1.E9.m1.4.4.4.4.1.1.1.1.3.cmml">s</mi></msub><mo id="A1.E9.m1.4.4.4.4.1.4.4.6" xref="A1.E9.m1.4.4.4.4.1.4.5.cmml">,</mo><msub id="A1.E9.m1.4.4.4.4.1.2.2.2" xref="A1.E9.m1.4.4.4.4.1.2.2.2.cmml"><mi id="A1.E9.m1.4.4.4.4.1.2.2.2.2" xref="A1.E9.m1.4.4.4.4.1.2.2.2.2.cmml">𝐳</mi><mi id="A1.E9.m1.4.4.4.4.1.2.2.2.3" xref="A1.E9.m1.4.4.4.4.1.2.2.2.3.cmml">q</mi></msub><mo id="A1.E9.m1.4.4.4.4.1.4.4.7" xref="A1.E9.m1.4.4.4.4.1.4.5.cmml">,</mo><msub id="A1.E9.m1.4.4.4.4.1.3.3.3" xref="A1.E9.m1.4.4.4.4.1.3.3.3.cmml"><mi id="A1.E9.m1.4.4.4.4.1.3.3.3.2" xref="A1.E9.m1.4.4.4.4.1.3.3.3.2.cmml">𝐳</mi><mrow id="A1.E9.m1.4.4.4.4.1.3.3.3.3" xref="A1.E9.m1.4.4.4.4.1.3.3.3.3.cmml"><mi id="A1.E9.m1.4.4.4.4.1.3.3.3.3.2" xref="A1.E9.m1.4.4.4.4.1.3.3.3.3.2.cmml">m</mi><mo id="A1.E9.m1.4.4.4.4.1.3.3.3.3.1" xref="A1.E9.m1.4.4.4.4.1.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E9.m1.4.4.4.4.1.3.3.3.3.3" xref="A1.E9.m1.4.4.4.4.1.3.3.3.3.3.cmml">s</mi></mrow></msub><mo id="A1.E9.m1.4.4.4.4.1.4.4.8" xref="A1.E9.m1.4.4.4.4.1.4.5.cmml">,</mo><msub id="A1.E9.m1.4.4.4.4.1.4.4.4" xref="A1.E9.m1.4.4.4.4.1.4.4.4.cmml"><mi id="A1.E9.m1.4.4.4.4.1.4.4.4.2" xref="A1.E9.m1.4.4.4.4.1.4.4.4.2.cmml">𝐳</mi><mrow id="A1.E9.m1.4.4.4.4.1.4.4.4.3" xref="A1.E9.m1.4.4.4.4.1.4.4.4.3.cmml"><mi id="A1.E9.m1.4.4.4.4.1.4.4.4.3.2" xref="A1.E9.m1.4.4.4.4.1.4.4.4.3.2.cmml">m</mi><mo id="A1.E9.m1.4.4.4.4.1.4.4.4.3.1" xref="A1.E9.m1.4.4.4.4.1.4.4.4.3.1.cmml">⁢</mo><mi id="A1.E9.m1.4.4.4.4.1.4.4.4.3.3" xref="A1.E9.m1.4.4.4.4.1.4.4.4.3.3.cmml">q</mi></mrow></msub><mo id="A1.E9.m1.4.4.4.4.1.4.4.9" stretchy="false" xref="A1.E9.m1.4.4.4.4.1.4.5.cmml">)</mo></mrow><mo id="A1.E9.m1.4.4.4.4.1.5" xref="A1.E9.m1.4.4.4.4.1.5.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E9.m1.4.4.4.4.1.6" xref="A1.E9.m1.4.4.4.4.1.6.cmml">𝒟</mi></mrow><mo id="A1.E9.m1.5.5.5.5.3" xref="A1.E9.m1.5.5.5.6a.cmml">,</mo><mrow id="A1.E9.m1.5.5.5.5.2.2" xref="A1.E9.m1.5.5.5.5.2.3.cmml"><mrow id="A1.E9.m1.5.5.5.5.2.1.1" xref="A1.E9.m1.5.5.5.5.2.1.1.cmml"><mi id="A1.E9.m1.5.5.5.5.2.1.1.2" xref="A1.E9.m1.5.5.5.5.2.1.1.2.cmml">ϵ</mi><mo id="A1.E9.m1.5.5.5.5.2.1.1.1" xref="A1.E9.m1.5.5.5.5.2.1.1.1.cmml">∼</mo><mrow id="A1.E9.m1.5.5.5.5.2.1.1.3" xref="A1.E9.m1.5.5.5.5.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E9.m1.5.5.5.5.2.1.1.3.2" xref="A1.E9.m1.5.5.5.5.2.1.1.3.2.cmml">𝒩</mi><mo id="A1.E9.m1.5.5.5.5.2.1.1.3.1" xref="A1.E9.m1.5.5.5.5.2.1.1.3.1.cmml">⁢</mo><mrow id="A1.E9.m1.5.5.5.5.2.1.1.3.3.2" xref="A1.E9.m1.5.5.5.5.2.1.1.3.3.1.cmml"><mo id="A1.E9.m1.5.5.5.5.2.1.1.3.3.2.1" stretchy="false" xref="A1.E9.m1.5.5.5.5.2.1.1.3.3.1.cmml">(</mo><mn id="A1.E9.m1.1.1.1.1" xref="A1.E9.m1.1.1.1.1.cmml">0</mn><mo id="A1.E9.m1.5.5.5.5.2.1.1.3.3.2.2" xref="A1.E9.m1.5.5.5.5.2.1.1.3.3.1.cmml">,</mo><mn id="A1.E9.m1.2.2.2.2" xref="A1.E9.m1.2.2.2.2.cmml">1</mn><mo id="A1.E9.m1.5.5.5.5.2.1.1.3.3.2.3" stretchy="false" xref="A1.E9.m1.5.5.5.5.2.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E9.m1.5.5.5.5.2.2.3" xref="A1.E9.m1.5.5.5.5.2.3a.cmml">,</mo><mrow id="A1.E9.m1.5.5.5.5.2.2.2" xref="A1.E9.m1.5.5.5.5.2.2.2.cmml"><mi id="A1.E9.m1.5.5.5.5.2.2.2.2" xref="A1.E9.m1.5.5.5.5.2.2.2.2.cmml">t</mi><mo id="A1.E9.m1.5.5.5.5.2.2.2.1" xref="A1.E9.m1.5.5.5.5.2.2.2.1.cmml">∈</mo><mrow id="A1.E9.m1.5.5.5.5.2.2.2.3" xref="A1.E9.m1.5.5.5.5.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E9.m1.5.5.5.5.2.2.2.3.2" xref="A1.E9.m1.5.5.5.5.2.2.2.3.2.cmml">𝒰</mi><mo id="A1.E9.m1.5.5.5.5.2.2.2.3.1" xref="A1.E9.m1.5.5.5.5.2.2.2.3.1.cmml">⁢</mo><mrow id="A1.E9.m1.5.5.5.5.2.2.2.3.3.2" xref="A1.E9.m1.5.5.5.5.2.2.2.3.cmml"><mo id="A1.E9.m1.5.5.5.5.2.2.2.3.3.2.1" stretchy="false" xref="A1.E9.m1.5.5.5.5.2.2.2.3.cmml">(</mo><mi id="A1.E9.m1.3.3.3.3" xref="A1.E9.m1.3.3.3.3.cmml">T</mi><mo id="A1.E9.m1.5.5.5.5.2.2.2.3.3.2.2" stretchy="false" xref="A1.E9.m1.5.5.5.5.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></msub><mo id="A1.E9.m1.8.8.1.2" xref="A1.E9.m1.8.8.1.2.cmml">⁢</mo><mrow id="A1.E9.m1.8.8.1.1.1" xref="A1.E9.m1.8.8.1.1.2.cmml"><mo id="A1.E9.m1.8.8.1.1.1.2" xref="A1.E9.m1.8.8.1.1.2.1.cmml">[</mo><msubsup id="A1.E9.m1.8.8.1.1.1.1" xref="A1.E9.m1.8.8.1.1.1.1.cmml"><mrow id="A1.E9.m1.8.8.1.1.1.1.1.1.1" xref="A1.E9.m1.8.8.1.1.1.1.1.1.2.cmml"><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.2.cmml">𝐳</mi><mrow id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.2.cmml">m</mi><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.1" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.1.cmml">⁢</mo><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.3.cmml">q</mi></mrow></msub><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.5" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.5.cmml">−</mo><mrow id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.cmml"><msubsup id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.2.cmml">v</mi><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.3.cmml">θ</mi><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.3.cmml">∗</mo></msubsup><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.5" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.5.cmml">⁢</mo><mrow id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.5.cmml"><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.5" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.5.cmml">(</mo><msubsup id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">q</mi></mrow><mrow id="A1.E9.m1.6.6.1.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E9.m1.6.6.1.3.1" stretchy="false" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E9.m1.6.6.1.1" xref="A1.E9.m1.6.6.1.1.cmml">t</mi><mo id="A1.E9.m1.6.6.1.3.2" stretchy="false" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.6" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.5.cmml">,</mo><msub id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐳</mi><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msub><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.7" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.5.cmml">,</mo><msub id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">𝐳</mi><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">q</mi></msub><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.8" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.5.cmml">,</mo><msub id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.2.cmml">𝐳</mi><mrow id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.cmml"><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.2" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.2.cmml">m</mi><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.1" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.1.cmml">⁢</mo><mi id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.3.cmml">s</mi></mrow></msub><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.9" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.5.cmml">,</mo><mi id="A1.E9.m1.7.7" xref="A1.E9.m1.7.7.cmml">t</mi><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.10" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.5.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E9.m1.8.8.1.1.1.1.1.1.1.3" xref="A1.E9.m1.8.8.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E9.m1.8.8.1.1.1.1.1.3" xref="A1.E9.m1.8.8.1.1.1.1.1.3.cmml">2</mn><mn id="A1.E9.m1.8.8.1.1.1.1.3" xref="A1.E9.m1.8.8.1.1.1.1.3.cmml">2</mn></msubsup><mo id="A1.E9.m1.8.8.1.1.1.3" xref="A1.E9.m1.8.8.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E9.m1.8b"><apply id="A1.E9.m1.8.8.cmml" xref="A1.E9.m1.8.8"><eq id="A1.E9.m1.8.8.2.cmml" xref="A1.E9.m1.8.8.2"></eq><apply id="A1.E9.m1.8.8.3.cmml" xref="A1.E9.m1.8.8.3"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.3.1.cmml" xref="A1.E9.m1.8.8.3">subscript</csymbol><ci id="A1.E9.m1.8.8.3.2.cmml" xref="A1.E9.m1.8.8.3.2">ℒ</ci><ci id="A1.E9.m1.8.8.3.3.cmml" xref="A1.E9.m1.8.8.3.3">𝐌𝐍𝟐𝐌</ci></apply><apply id="A1.E9.m1.8.8.1.cmml" xref="A1.E9.m1.8.8.1"><times id="A1.E9.m1.8.8.1.2.cmml" xref="A1.E9.m1.8.8.1.2"></times><apply id="A1.E9.m1.8.8.1.3.cmml" xref="A1.E9.m1.8.8.1.3"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.3.1.cmml" xref="A1.E9.m1.8.8.1.3">subscript</csymbol><ci id="A1.E9.m1.8.8.1.3.2.cmml" xref="A1.E9.m1.8.8.1.3.2">𝔼</ci><apply id="A1.E9.m1.5.5.5.6.cmml" xref="A1.E9.m1.5.5.5.5"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.5.6a.cmml" xref="A1.E9.m1.5.5.5.5.3">formulae-sequence</csymbol><apply id="A1.E9.m1.4.4.4.4.1.cmml" xref="A1.E9.m1.4.4.4.4.1"><csymbol cd="latexml" id="A1.E9.m1.4.4.4.4.1.5.cmml" xref="A1.E9.m1.4.4.4.4.1.5">similar-to</csymbol><vector id="A1.E9.m1.4.4.4.4.1.4.5.cmml" xref="A1.E9.m1.4.4.4.4.1.4.4"><apply id="A1.E9.m1.4.4.4.4.1.1.1.1.cmml" xref="A1.E9.m1.4.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.4.4.1.1.1.1.1.cmml" xref="A1.E9.m1.4.4.4.4.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.4.4.4.4.1.1.1.1.2.cmml" xref="A1.E9.m1.4.4.4.4.1.1.1.1.2">𝐳</ci><ci id="A1.E9.m1.4.4.4.4.1.1.1.1.3.cmml" xref="A1.E9.m1.4.4.4.4.1.1.1.1.3">𝑠</ci></apply><apply id="A1.E9.m1.4.4.4.4.1.2.2.2.cmml" xref="A1.E9.m1.4.4.4.4.1.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.4.4.1.2.2.2.1.cmml" xref="A1.E9.m1.4.4.4.4.1.2.2.2">subscript</csymbol><ci id="A1.E9.m1.4.4.4.4.1.2.2.2.2.cmml" xref="A1.E9.m1.4.4.4.4.1.2.2.2.2">𝐳</ci><ci id="A1.E9.m1.4.4.4.4.1.2.2.2.3.cmml" xref="A1.E9.m1.4.4.4.4.1.2.2.2.3">𝑞</ci></apply><apply id="A1.E9.m1.4.4.4.4.1.3.3.3.cmml" xref="A1.E9.m1.4.4.4.4.1.3.3.3"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.4.4.1.3.3.3.1.cmml" xref="A1.E9.m1.4.4.4.4.1.3.3.3">subscript</csymbol><ci id="A1.E9.m1.4.4.4.4.1.3.3.3.2.cmml" xref="A1.E9.m1.4.4.4.4.1.3.3.3.2">𝐳</ci><apply id="A1.E9.m1.4.4.4.4.1.3.3.3.3.cmml" xref="A1.E9.m1.4.4.4.4.1.3.3.3.3"><times id="A1.E9.m1.4.4.4.4.1.3.3.3.3.1.cmml" xref="A1.E9.m1.4.4.4.4.1.3.3.3.3.1"></times><ci id="A1.E9.m1.4.4.4.4.1.3.3.3.3.2.cmml" xref="A1.E9.m1.4.4.4.4.1.3.3.3.3.2">𝑚</ci><ci id="A1.E9.m1.4.4.4.4.1.3.3.3.3.3.cmml" xref="A1.E9.m1.4.4.4.4.1.3.3.3.3.3">𝑠</ci></apply></apply><apply id="A1.E9.m1.4.4.4.4.1.4.4.4.cmml" xref="A1.E9.m1.4.4.4.4.1.4.4.4"><csymbol cd="ambiguous" id="A1.E9.m1.4.4.4.4.1.4.4.4.1.cmml" xref="A1.E9.m1.4.4.4.4.1.4.4.4">subscript</csymbol><ci id="A1.E9.m1.4.4.4.4.1.4.4.4.2.cmml" xref="A1.E9.m1.4.4.4.4.1.4.4.4.2">𝐳</ci><apply id="A1.E9.m1.4.4.4.4.1.4.4.4.3.cmml" xref="A1.E9.m1.4.4.4.4.1.4.4.4.3"><times id="A1.E9.m1.4.4.4.4.1.4.4.4.3.1.cmml" xref="A1.E9.m1.4.4.4.4.1.4.4.4.3.1"></times><ci id="A1.E9.m1.4.4.4.4.1.4.4.4.3.2.cmml" xref="A1.E9.m1.4.4.4.4.1.4.4.4.3.2">𝑚</ci><ci id="A1.E9.m1.4.4.4.4.1.4.4.4.3.3.cmml" xref="A1.E9.m1.4.4.4.4.1.4.4.4.3.3">𝑞</ci></apply></apply></vector><ci id="A1.E9.m1.4.4.4.4.1.6.cmml" xref="A1.E9.m1.4.4.4.4.1.6">𝒟</ci></apply><apply id="A1.E9.m1.5.5.5.5.2.3.cmml" xref="A1.E9.m1.5.5.5.5.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.5.5.5.5.2.3a.cmml" xref="A1.E9.m1.5.5.5.5.2.2.3">formulae-sequence</csymbol><apply id="A1.E9.m1.5.5.5.5.2.1.1.cmml" xref="A1.E9.m1.5.5.5.5.2.1.1"><csymbol cd="latexml" id="A1.E9.m1.5.5.5.5.2.1.1.1.cmml" xref="A1.E9.m1.5.5.5.5.2.1.1.1">similar-to</csymbol><ci id="A1.E9.m1.5.5.5.5.2.1.1.2.cmml" xref="A1.E9.m1.5.5.5.5.2.1.1.2">italic-ϵ</ci><apply id="A1.E9.m1.5.5.5.5.2.1.1.3.cmml" xref="A1.E9.m1.5.5.5.5.2.1.1.3"><times id="A1.E9.m1.5.5.5.5.2.1.1.3.1.cmml" xref="A1.E9.m1.5.5.5.5.2.1.1.3.1"></times><ci id="A1.E9.m1.5.5.5.5.2.1.1.3.2.cmml" xref="A1.E9.m1.5.5.5.5.2.1.1.3.2">𝒩</ci><interval closure="open" id="A1.E9.m1.5.5.5.5.2.1.1.3.3.1.cmml" xref="A1.E9.m1.5.5.5.5.2.1.1.3.3.2"><cn id="A1.E9.m1.1.1.1.1.cmml" type="integer" xref="A1.E9.m1.1.1.1.1">0</cn><cn id="A1.E9.m1.2.2.2.2.cmml" type="integer" xref="A1.E9.m1.2.2.2.2">1</cn></interval></apply></apply><apply id="A1.E9.m1.5.5.5.5.2.2.2.cmml" xref="A1.E9.m1.5.5.5.5.2.2.2"><in id="A1.E9.m1.5.5.5.5.2.2.2.1.cmml" xref="A1.E9.m1.5.5.5.5.2.2.2.1"></in><ci id="A1.E9.m1.5.5.5.5.2.2.2.2.cmml" xref="A1.E9.m1.5.5.5.5.2.2.2.2">𝑡</ci><apply id="A1.E9.m1.5.5.5.5.2.2.2.3.cmml" xref="A1.E9.m1.5.5.5.5.2.2.2.3"><times id="A1.E9.m1.5.5.5.5.2.2.2.3.1.cmml" xref="A1.E9.m1.5.5.5.5.2.2.2.3.1"></times><ci id="A1.E9.m1.5.5.5.5.2.2.2.3.2.cmml" xref="A1.E9.m1.5.5.5.5.2.2.2.3.2">𝒰</ci><ci id="A1.E9.m1.3.3.3.3.cmml" xref="A1.E9.m1.3.3.3.3">𝑇</ci></apply></apply></apply></apply></apply><apply id="A1.E9.m1.8.8.1.1.2.cmml" xref="A1.E9.m1.8.8.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.8.8.1.1.2.1.cmml" xref="A1.E9.m1.8.8.1.1.1.2">delimited-[]</csymbol><apply id="A1.E9.m1.8.8.1.1.1.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1">superscript</csymbol><apply id="A1.E9.m1.8.8.1.1.1.1.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1">subscript</csymbol><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E9.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1"><minus id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.5.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.5"></minus><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.2">𝐳</ci><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3"><times id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.1"></times><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.2">𝑚</ci><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.6.3.3">𝑞</ci></apply></apply><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4"><times id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.5.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.5"></times><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6">subscript</csymbol><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6">superscript</csymbol><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.2">𝑣</ci><times id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.2.3"></times></apply><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.6.3">𝜃</ci></apply><vector id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.5.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4"><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑞</ci></apply></apply><ci id="A1.E9.m1.6.6.1.1.cmml" xref="A1.E9.m1.6.6.1.1">𝑡</ci></apply><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐳</ci><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.2">𝐳</ci><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.3.3.3.3.3">𝑞</ci></apply><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4">subscript</csymbol><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.2">𝐳</ci><apply id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3"><times id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.1.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.1"></times><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.2.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.2">𝑚</ci><ci id="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.3.cmml" xref="A1.E9.m1.8.8.1.1.1.1.1.1.1.1.4.4.4.4.3.3">𝑠</ci></apply></apply><ci id="A1.E9.m1.7.7.cmml" xref="A1.E9.m1.7.7">𝑡</ci></vector></apply></apply></apply><cn id="A1.E9.m1.8.8.1.1.1.1.1.3.cmml" type="integer" xref="A1.E9.m1.8.8.1.1.1.1.1.3">2</cn></apply><cn id="A1.E9.m1.8.8.1.1.1.1.3.cmml" type="integer" xref="A1.E9.m1.8.8.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E9.m1.8c">\mathcal{L_{\mathbf{MN2M}}}=\mathbb{E}_{(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf%
{z}_{ms},\mathbf{z}_{mq})\sim\mathcal{D},\mathbf{\epsilon}\sim\mathcal{N}(0,1)%
,t\in\mathcal{U}(T)}\left[\left\|\mathbf{z}_{mq}-v^{*}_{\theta}\left(\mathbf{z%
}_{mq}^{(t)},\mathbf{z}_{s},\mathbf{z}_{q},\mathbf{z}_{ms},t\right)\right\|_{2%
}^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E9.m1.8d">caligraphic_L start_POSTSUBSCRIPT bold_MN2M end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT ) ∼ caligraphic_D , italic_ϵ ∼ caligraphic_N ( 0 , 1 ) , italic_t ∈ caligraphic_U ( italic_T ) end_POSTSUBSCRIPT [ ∥ bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT - italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT , bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_s end_POSTSUBSCRIPT , italic_t ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS2.p3.5"><span class="ltx_text ltx_font_bold" id="A1.SS2.p3.5.1">MI2M</span> We add image(as noise) to the query mask <math alttext="\mathbf{z}_{mq}" class="ltx_Math" display="inline" id="A1.SS2.p3.4.m1.1"><semantics id="A1.SS2.p3.4.m1.1a"><msub id="A1.SS2.p3.4.m1.1.1" xref="A1.SS2.p3.4.m1.1.1.cmml"><mi id="A1.SS2.p3.4.m1.1.1.2" xref="A1.SS2.p3.4.m1.1.1.2.cmml">𝐳</mi><mrow id="A1.SS2.p3.4.m1.1.1.3" xref="A1.SS2.p3.4.m1.1.1.3.cmml"><mi id="A1.SS2.p3.4.m1.1.1.3.2" xref="A1.SS2.p3.4.m1.1.1.3.2.cmml">m</mi><mo id="A1.SS2.p3.4.m1.1.1.3.1" xref="A1.SS2.p3.4.m1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.4.m1.1.1.3.3" xref="A1.SS2.p3.4.m1.1.1.3.3.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.4.m1.1b"><apply id="A1.SS2.p3.4.m1.1.1.cmml" xref="A1.SS2.p3.4.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p3.4.m1.1.1.1.cmml" xref="A1.SS2.p3.4.m1.1.1">subscript</csymbol><ci id="A1.SS2.p3.4.m1.1.1.2.cmml" xref="A1.SS2.p3.4.m1.1.1.2">𝐳</ci><apply id="A1.SS2.p3.4.m1.1.1.3.cmml" xref="A1.SS2.p3.4.m1.1.1.3"><times id="A1.SS2.p3.4.m1.1.1.3.1.cmml" xref="A1.SS2.p3.4.m1.1.1.3.1"></times><ci id="A1.SS2.p3.4.m1.1.1.3.2.cmml" xref="A1.SS2.p3.4.m1.1.1.3.2">𝑚</ci><ci id="A1.SS2.p3.4.m1.1.1.3.3.cmml" xref="A1.SS2.p3.4.m1.1.1.3.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.4.m1.1c">\mathbf{z}_{mq}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.4.m1.1d">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{z}_{mq}^{(t)}=\sqrt{\bar{\alpha}_{t}}\mathbf{z}_{mq}+\sqrt{1-\bar{%
\alpha}_{t}}{\mathbf{z}_{q}}" class="ltx_Math" display="inline" id="A1.SS2.p3.5.m2.1"><semantics id="A1.SS2.p3.5.m2.1a"><mrow id="A1.SS2.p3.5.m2.1.2" xref="A1.SS2.p3.5.m2.1.2.cmml"><msubsup id="A1.SS2.p3.5.m2.1.2.2" xref="A1.SS2.p3.5.m2.1.2.2.cmml"><mi id="A1.SS2.p3.5.m2.1.2.2.2.2" xref="A1.SS2.p3.5.m2.1.2.2.2.2.cmml">𝐳</mi><mrow id="A1.SS2.p3.5.m2.1.2.2.2.3" xref="A1.SS2.p3.5.m2.1.2.2.2.3.cmml"><mi id="A1.SS2.p3.5.m2.1.2.2.2.3.2" xref="A1.SS2.p3.5.m2.1.2.2.2.3.2.cmml">m</mi><mo id="A1.SS2.p3.5.m2.1.2.2.2.3.1" xref="A1.SS2.p3.5.m2.1.2.2.2.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.5.m2.1.2.2.2.3.3" xref="A1.SS2.p3.5.m2.1.2.2.2.3.3.cmml">q</mi></mrow><mrow id="A1.SS2.p3.5.m2.1.1.1.3" xref="A1.SS2.p3.5.m2.1.2.2.cmml"><mo id="A1.SS2.p3.5.m2.1.1.1.3.1" stretchy="false" xref="A1.SS2.p3.5.m2.1.2.2.cmml">(</mo><mi id="A1.SS2.p3.5.m2.1.1.1.1" xref="A1.SS2.p3.5.m2.1.1.1.1.cmml">t</mi><mo id="A1.SS2.p3.5.m2.1.1.1.3.2" stretchy="false" xref="A1.SS2.p3.5.m2.1.2.2.cmml">)</mo></mrow></msubsup><mo id="A1.SS2.p3.5.m2.1.2.1" xref="A1.SS2.p3.5.m2.1.2.1.cmml">=</mo><mrow id="A1.SS2.p3.5.m2.1.2.3" xref="A1.SS2.p3.5.m2.1.2.3.cmml"><mrow id="A1.SS2.p3.5.m2.1.2.3.2" xref="A1.SS2.p3.5.m2.1.2.3.2.cmml"><msqrt id="A1.SS2.p3.5.m2.1.2.3.2.2" xref="A1.SS2.p3.5.m2.1.2.3.2.2.cmml"><msub id="A1.SS2.p3.5.m2.1.2.3.2.2.2" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.cmml"><mover accent="true" id="A1.SS2.p3.5.m2.1.2.3.2.2.2.2" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.cmml"><mi id="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.2" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.2.cmml">α</mi><mo id="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.1" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.1.cmml">¯</mo></mover><mi id="A1.SS2.p3.5.m2.1.2.3.2.2.2.3" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.3.cmml">t</mi></msub></msqrt><mo id="A1.SS2.p3.5.m2.1.2.3.2.1" xref="A1.SS2.p3.5.m2.1.2.3.2.1.cmml">⁢</mo><msub id="A1.SS2.p3.5.m2.1.2.3.2.3" xref="A1.SS2.p3.5.m2.1.2.3.2.3.cmml"><mi id="A1.SS2.p3.5.m2.1.2.3.2.3.2" xref="A1.SS2.p3.5.m2.1.2.3.2.3.2.cmml">𝐳</mi><mrow id="A1.SS2.p3.5.m2.1.2.3.2.3.3" xref="A1.SS2.p3.5.m2.1.2.3.2.3.3.cmml"><mi id="A1.SS2.p3.5.m2.1.2.3.2.3.3.2" xref="A1.SS2.p3.5.m2.1.2.3.2.3.3.2.cmml">m</mi><mo id="A1.SS2.p3.5.m2.1.2.3.2.3.3.1" xref="A1.SS2.p3.5.m2.1.2.3.2.3.3.1.cmml">⁢</mo><mi id="A1.SS2.p3.5.m2.1.2.3.2.3.3.3" xref="A1.SS2.p3.5.m2.1.2.3.2.3.3.3.cmml">q</mi></mrow></msub></mrow><mo id="A1.SS2.p3.5.m2.1.2.3.1" xref="A1.SS2.p3.5.m2.1.2.3.1.cmml">+</mo><mrow id="A1.SS2.p3.5.m2.1.2.3.3" xref="A1.SS2.p3.5.m2.1.2.3.3.cmml"><msqrt id="A1.SS2.p3.5.m2.1.2.3.3.2" xref="A1.SS2.p3.5.m2.1.2.3.3.2.cmml"><mrow id="A1.SS2.p3.5.m2.1.2.3.3.2.2" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.cmml"><mn id="A1.SS2.p3.5.m2.1.2.3.3.2.2.2" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.2.cmml">1</mn><mo id="A1.SS2.p3.5.m2.1.2.3.3.2.2.1" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.1.cmml">−</mo><msub id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.cmml"><mover accent="true" id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.cmml"><mi id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.2" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.2.cmml">α</mi><mo id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.1" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.1.cmml">¯</mo></mover><mi id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.3" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="A1.SS2.p3.5.m2.1.2.3.3.1" xref="A1.SS2.p3.5.m2.1.2.3.3.1.cmml">⁢</mo><msub id="A1.SS2.p3.5.m2.1.2.3.3.3" xref="A1.SS2.p3.5.m2.1.2.3.3.3.cmml"><mi id="A1.SS2.p3.5.m2.1.2.3.3.3.2" xref="A1.SS2.p3.5.m2.1.2.3.3.3.2.cmml">𝐳</mi><mi id="A1.SS2.p3.5.m2.1.2.3.3.3.3" xref="A1.SS2.p3.5.m2.1.2.3.3.3.3.cmml">q</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p3.5.m2.1b"><apply id="A1.SS2.p3.5.m2.1.2.cmml" xref="A1.SS2.p3.5.m2.1.2"><eq id="A1.SS2.p3.5.m2.1.2.1.cmml" xref="A1.SS2.p3.5.m2.1.2.1"></eq><apply id="A1.SS2.p3.5.m2.1.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m2.1.2.2.1.cmml" xref="A1.SS2.p3.5.m2.1.2.2">superscript</csymbol><apply id="A1.SS2.p3.5.m2.1.2.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m2.1.2.2.2.1.cmml" xref="A1.SS2.p3.5.m2.1.2.2">subscript</csymbol><ci id="A1.SS2.p3.5.m2.1.2.2.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.2.2.2">𝐳</ci><apply id="A1.SS2.p3.5.m2.1.2.2.2.3.cmml" xref="A1.SS2.p3.5.m2.1.2.2.2.3"><times id="A1.SS2.p3.5.m2.1.2.2.2.3.1.cmml" xref="A1.SS2.p3.5.m2.1.2.2.2.3.1"></times><ci id="A1.SS2.p3.5.m2.1.2.2.2.3.2.cmml" xref="A1.SS2.p3.5.m2.1.2.2.2.3.2">𝑚</ci><ci id="A1.SS2.p3.5.m2.1.2.2.2.3.3.cmml" xref="A1.SS2.p3.5.m2.1.2.2.2.3.3">𝑞</ci></apply></apply><ci id="A1.SS2.p3.5.m2.1.1.1.1.cmml" xref="A1.SS2.p3.5.m2.1.1.1.1">𝑡</ci></apply><apply id="A1.SS2.p3.5.m2.1.2.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3"><plus id="A1.SS2.p3.5.m2.1.2.3.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.1"></plus><apply id="A1.SS2.p3.5.m2.1.2.3.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2"><times id="A1.SS2.p3.5.m2.1.2.3.2.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.1"></times><apply id="A1.SS2.p3.5.m2.1.2.3.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.2"><root id="A1.SS2.p3.5.m2.1.2.3.2.2a.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.2"></root><apply id="A1.SS2.p3.5.m2.1.2.3.2.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m2.1.2.3.2.2.2.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2">subscript</csymbol><apply id="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.2"><ci id="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.1">¯</ci><ci id="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.2.2">𝛼</ci></apply><ci id="A1.SS2.p3.5.m2.1.2.3.2.2.2.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.2.2.3">𝑡</ci></apply></apply><apply id="A1.SS2.p3.5.m2.1.2.3.2.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.3"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m2.1.2.3.2.3.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.3">subscript</csymbol><ci id="A1.SS2.p3.5.m2.1.2.3.2.3.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.3.2">𝐳</ci><apply id="A1.SS2.p3.5.m2.1.2.3.2.3.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.3.3"><times id="A1.SS2.p3.5.m2.1.2.3.2.3.3.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.3.3.1"></times><ci id="A1.SS2.p3.5.m2.1.2.3.2.3.3.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.3.3.2">𝑚</ci><ci id="A1.SS2.p3.5.m2.1.2.3.2.3.3.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.2.3.3.3">𝑞</ci></apply></apply></apply><apply id="A1.SS2.p3.5.m2.1.2.3.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3"><times id="A1.SS2.p3.5.m2.1.2.3.3.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.1"></times><apply id="A1.SS2.p3.5.m2.1.2.3.3.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2"><root id="A1.SS2.p3.5.m2.1.2.3.3.2a.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2"></root><apply id="A1.SS2.p3.5.m2.1.2.3.3.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2"><minus id="A1.SS2.p3.5.m2.1.2.3.3.2.2.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.1"></minus><cn id="A1.SS2.p3.5.m2.1.2.3.3.2.2.2.cmml" type="integer" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.2">1</cn><apply id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3">subscript</csymbol><apply id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2"><ci id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.1">¯</ci><ci id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.2.2">𝛼</ci></apply><ci id="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="A1.SS2.p3.5.m2.1.2.3.3.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.3"><csymbol cd="ambiguous" id="A1.SS2.p3.5.m2.1.2.3.3.3.1.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.3">subscript</csymbol><ci id="A1.SS2.p3.5.m2.1.2.3.3.3.2.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.3.2">𝐳</ci><ci id="A1.SS2.p3.5.m2.1.2.3.3.3.3.cmml" xref="A1.SS2.p3.5.m2.1.2.3.3.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p3.5.m2.1c">\mathbf{z}_{mq}^{(t)}=\sqrt{\bar{\alpha}_{t}}\mathbf{z}_{mq}+\sqrt{1-\bar{%
\alpha}_{t}}{\mathbf{z}_{q}}</annotation><annotation encoding="application/x-llamapun" id="A1.SS2.p3.5.m2.1d">bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT = square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT + square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>. The supervised form is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L_{\mathbf{MI2M}}}=\mathbb{E}_{(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf%
{z}_{ms},\mathbf{z}_{mq})\sim\mathcal{D},t\in\mathcal{U}(T)}\left[\left\|%
\mathbf{z}_{mq}-v^{*}_{\theta}\left(\mathbf{z}_{mq}^{(t)},\mathbf{z}_{s},%
\mathbf{z}_{q},\mathbf{z}_{ms},t\right)\right\|_{2}^{2}\right]" class="ltx_Math" display="block" id="A1.E10.m1.6"><semantics id="A1.E10.m1.6a"><mrow id="A1.E10.m1.6.6" xref="A1.E10.m1.6.6.cmml"><msub id="A1.E10.m1.6.6.3" xref="A1.E10.m1.6.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E10.m1.6.6.3.2" xref="A1.E10.m1.6.6.3.2.cmml">ℒ</mi><mi id="A1.E10.m1.6.6.3.3" xref="A1.E10.m1.6.6.3.3.cmml">𝐌𝐈𝟐𝐌</mi></msub><mo id="A1.E10.m1.6.6.2" xref="A1.E10.m1.6.6.2.cmml">=</mo><mrow id="A1.E10.m1.6.6.1" xref="A1.E10.m1.6.6.1.cmml"><msub id="A1.E10.m1.6.6.1.3" xref="A1.E10.m1.6.6.1.3.cmml"><mi id="A1.E10.m1.6.6.1.3.2" xref="A1.E10.m1.6.6.1.3.2.cmml">𝔼</mi><mrow id="A1.E10.m1.3.3.3.3" xref="A1.E10.m1.3.3.3.4.cmml"><mrow id="A1.E10.m1.2.2.2.2.1" xref="A1.E10.m1.2.2.2.2.1.cmml"><mrow id="A1.E10.m1.2.2.2.2.1.4.4" xref="A1.E10.m1.2.2.2.2.1.4.5.cmml"><mo id="A1.E10.m1.2.2.2.2.1.4.4.5" stretchy="false" xref="A1.E10.m1.2.2.2.2.1.4.5.cmml">(</mo><msub id="A1.E10.m1.2.2.2.2.1.1.1.1" xref="A1.E10.m1.2.2.2.2.1.1.1.1.cmml"><mi id="A1.E10.m1.2.2.2.2.1.1.1.1.2" xref="A1.E10.m1.2.2.2.2.1.1.1.1.2.cmml">𝐳</mi><mi id="A1.E10.m1.2.2.2.2.1.1.1.1.3" xref="A1.E10.m1.2.2.2.2.1.1.1.1.3.cmml">s</mi></msub><mo id="A1.E10.m1.2.2.2.2.1.4.4.6" xref="A1.E10.m1.2.2.2.2.1.4.5.cmml">,</mo><msub id="A1.E10.m1.2.2.2.2.1.2.2.2" xref="A1.E10.m1.2.2.2.2.1.2.2.2.cmml"><mi id="A1.E10.m1.2.2.2.2.1.2.2.2.2" xref="A1.E10.m1.2.2.2.2.1.2.2.2.2.cmml">𝐳</mi><mi id="A1.E10.m1.2.2.2.2.1.2.2.2.3" xref="A1.E10.m1.2.2.2.2.1.2.2.2.3.cmml">q</mi></msub><mo id="A1.E10.m1.2.2.2.2.1.4.4.7" xref="A1.E10.m1.2.2.2.2.1.4.5.cmml">,</mo><msub id="A1.E10.m1.2.2.2.2.1.3.3.3" xref="A1.E10.m1.2.2.2.2.1.3.3.3.cmml"><mi id="A1.E10.m1.2.2.2.2.1.3.3.3.2" xref="A1.E10.m1.2.2.2.2.1.3.3.3.2.cmml">𝐳</mi><mrow id="A1.E10.m1.2.2.2.2.1.3.3.3.3" xref="A1.E10.m1.2.2.2.2.1.3.3.3.3.cmml"><mi id="A1.E10.m1.2.2.2.2.1.3.3.3.3.2" xref="A1.E10.m1.2.2.2.2.1.3.3.3.3.2.cmml">m</mi><mo id="A1.E10.m1.2.2.2.2.1.3.3.3.3.1" xref="A1.E10.m1.2.2.2.2.1.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E10.m1.2.2.2.2.1.3.3.3.3.3" xref="A1.E10.m1.2.2.2.2.1.3.3.3.3.3.cmml">s</mi></mrow></msub><mo id="A1.E10.m1.2.2.2.2.1.4.4.8" xref="A1.E10.m1.2.2.2.2.1.4.5.cmml">,</mo><msub id="A1.E10.m1.2.2.2.2.1.4.4.4" xref="A1.E10.m1.2.2.2.2.1.4.4.4.cmml"><mi id="A1.E10.m1.2.2.2.2.1.4.4.4.2" xref="A1.E10.m1.2.2.2.2.1.4.4.4.2.cmml">𝐳</mi><mrow id="A1.E10.m1.2.2.2.2.1.4.4.4.3" xref="A1.E10.m1.2.2.2.2.1.4.4.4.3.cmml"><mi id="A1.E10.m1.2.2.2.2.1.4.4.4.3.2" xref="A1.E10.m1.2.2.2.2.1.4.4.4.3.2.cmml">m</mi><mo id="A1.E10.m1.2.2.2.2.1.4.4.4.3.1" xref="A1.E10.m1.2.2.2.2.1.4.4.4.3.1.cmml">⁢</mo><mi id="A1.E10.m1.2.2.2.2.1.4.4.4.3.3" xref="A1.E10.m1.2.2.2.2.1.4.4.4.3.3.cmml">q</mi></mrow></msub><mo id="A1.E10.m1.2.2.2.2.1.4.4.9" stretchy="false" xref="A1.E10.m1.2.2.2.2.1.4.5.cmml">)</mo></mrow><mo id="A1.E10.m1.2.2.2.2.1.5" xref="A1.E10.m1.2.2.2.2.1.5.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="A1.E10.m1.2.2.2.2.1.6" xref="A1.E10.m1.2.2.2.2.1.6.cmml">𝒟</mi></mrow><mo id="A1.E10.m1.3.3.3.3.3" xref="A1.E10.m1.3.3.3.4a.cmml">,</mo><mrow id="A1.E10.m1.3.3.3.3.2" xref="A1.E10.m1.3.3.3.3.2.cmml"><mi id="A1.E10.m1.3.3.3.3.2.2" xref="A1.E10.m1.3.3.3.3.2.2.cmml">t</mi><mo id="A1.E10.m1.3.3.3.3.2.1" xref="A1.E10.m1.3.3.3.3.2.1.cmml">∈</mo><mrow id="A1.E10.m1.3.3.3.3.2.3" xref="A1.E10.m1.3.3.3.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E10.m1.3.3.3.3.2.3.2" xref="A1.E10.m1.3.3.3.3.2.3.2.cmml">𝒰</mi><mo id="A1.E10.m1.3.3.3.3.2.3.1" xref="A1.E10.m1.3.3.3.3.2.3.1.cmml">⁢</mo><mrow id="A1.E10.m1.3.3.3.3.2.3.3.2" xref="A1.E10.m1.3.3.3.3.2.3.cmml"><mo id="A1.E10.m1.3.3.3.3.2.3.3.2.1" stretchy="false" xref="A1.E10.m1.3.3.3.3.2.3.cmml">(</mo><mi id="A1.E10.m1.1.1.1.1" xref="A1.E10.m1.1.1.1.1.cmml">T</mi><mo id="A1.E10.m1.3.3.3.3.2.3.3.2.2" stretchy="false" xref="A1.E10.m1.3.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo id="A1.E10.m1.6.6.1.2" xref="A1.E10.m1.6.6.1.2.cmml">⁢</mo><mrow id="A1.E10.m1.6.6.1.1.1" xref="A1.E10.m1.6.6.1.1.2.cmml"><mo id="A1.E10.m1.6.6.1.1.1.2" xref="A1.E10.m1.6.6.1.1.2.1.cmml">[</mo><msubsup id="A1.E10.m1.6.6.1.1.1.1" xref="A1.E10.m1.6.6.1.1.1.1.cmml"><mrow id="A1.E10.m1.6.6.1.1.1.1.1.1.1" xref="A1.E10.m1.6.6.1.1.1.1.1.1.2.cmml"><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.cmml"><msub id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.2.cmml">𝐳</mi><mrow id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.2.cmml">m</mi><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.1" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.1.cmml">⁢</mo><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.3.cmml">q</mi></mrow></msub><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.5" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.5.cmml">−</mo><mrow id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.cmml"><msubsup id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.2.cmml">v</mi><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.3.cmml">θ</mi><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.3.cmml">∗</mo></msubsup><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.5" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.5.cmml">⁢</mo><mrow id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.5.cmml"><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.5" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.5.cmml">(</mo><msubsup id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">m</mi><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">q</mi></mrow><mrow id="A1.E10.m1.4.4.1.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="A1.E10.m1.4.4.1.3.1" stretchy="false" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="A1.E10.m1.4.4.1.1" xref="A1.E10.m1.4.4.1.1.cmml">t</mi><mo id="A1.E10.m1.4.4.1.3.2" stretchy="false" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.6" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.5.cmml">,</mo><msub id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐳</mi><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msub><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.7" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.5.cmml">,</mo><msub id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">𝐳</mi><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">q</mi></msub><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.8" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.5.cmml">,</mo><msub id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.2.cmml">𝐳</mi><mrow id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.cmml"><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.2" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.2.cmml">m</mi><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.1" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.1.cmml">⁢</mo><mi id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.3.cmml">s</mi></mrow></msub><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.9" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.5.cmml">,</mo><mi id="A1.E10.m1.5.5" xref="A1.E10.m1.5.5.cmml">t</mi><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.10" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.5.cmml">)</mo></mrow></mrow></mrow><mo id="A1.E10.m1.6.6.1.1.1.1.1.1.1.3" xref="A1.E10.m1.6.6.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E10.m1.6.6.1.1.1.1.1.3" xref="A1.E10.m1.6.6.1.1.1.1.1.3.cmml">2</mn><mn id="A1.E10.m1.6.6.1.1.1.1.3" xref="A1.E10.m1.6.6.1.1.1.1.3.cmml">2</mn></msubsup><mo id="A1.E10.m1.6.6.1.1.1.3" xref="A1.E10.m1.6.6.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E10.m1.6b"><apply id="A1.E10.m1.6.6.cmml" xref="A1.E10.m1.6.6"><eq id="A1.E10.m1.6.6.2.cmml" xref="A1.E10.m1.6.6.2"></eq><apply id="A1.E10.m1.6.6.3.cmml" xref="A1.E10.m1.6.6.3"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.3.1.cmml" xref="A1.E10.m1.6.6.3">subscript</csymbol><ci id="A1.E10.m1.6.6.3.2.cmml" xref="A1.E10.m1.6.6.3.2">ℒ</ci><ci id="A1.E10.m1.6.6.3.3.cmml" xref="A1.E10.m1.6.6.3.3">𝐌𝐈𝟐𝐌</ci></apply><apply id="A1.E10.m1.6.6.1.cmml" xref="A1.E10.m1.6.6.1"><times id="A1.E10.m1.6.6.1.2.cmml" xref="A1.E10.m1.6.6.1.2"></times><apply id="A1.E10.m1.6.6.1.3.cmml" xref="A1.E10.m1.6.6.1.3"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.3.1.cmml" xref="A1.E10.m1.6.6.1.3">subscript</csymbol><ci id="A1.E10.m1.6.6.1.3.2.cmml" xref="A1.E10.m1.6.6.1.3.2">𝔼</ci><apply id="A1.E10.m1.3.3.3.4.cmml" xref="A1.E10.m1.3.3.3.3"><csymbol cd="ambiguous" id="A1.E10.m1.3.3.3.4a.cmml" xref="A1.E10.m1.3.3.3.3.3">formulae-sequence</csymbol><apply id="A1.E10.m1.2.2.2.2.1.cmml" xref="A1.E10.m1.2.2.2.2.1"><csymbol cd="latexml" id="A1.E10.m1.2.2.2.2.1.5.cmml" xref="A1.E10.m1.2.2.2.2.1.5">similar-to</csymbol><vector id="A1.E10.m1.2.2.2.2.1.4.5.cmml" xref="A1.E10.m1.2.2.2.2.1.4.4"><apply id="A1.E10.m1.2.2.2.2.1.1.1.1.cmml" xref="A1.E10.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.1.1.1.1.1.cmml" xref="A1.E10.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="A1.E10.m1.2.2.2.2.1.1.1.1.2.cmml" xref="A1.E10.m1.2.2.2.2.1.1.1.1.2">𝐳</ci><ci id="A1.E10.m1.2.2.2.2.1.1.1.1.3.cmml" xref="A1.E10.m1.2.2.2.2.1.1.1.1.3">𝑠</ci></apply><apply id="A1.E10.m1.2.2.2.2.1.2.2.2.cmml" xref="A1.E10.m1.2.2.2.2.1.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.1.2.2.2.1.cmml" xref="A1.E10.m1.2.2.2.2.1.2.2.2">subscript</csymbol><ci id="A1.E10.m1.2.2.2.2.1.2.2.2.2.cmml" xref="A1.E10.m1.2.2.2.2.1.2.2.2.2">𝐳</ci><ci id="A1.E10.m1.2.2.2.2.1.2.2.2.3.cmml" xref="A1.E10.m1.2.2.2.2.1.2.2.2.3">𝑞</ci></apply><apply id="A1.E10.m1.2.2.2.2.1.3.3.3.cmml" xref="A1.E10.m1.2.2.2.2.1.3.3.3"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.1.3.3.3.1.cmml" xref="A1.E10.m1.2.2.2.2.1.3.3.3">subscript</csymbol><ci id="A1.E10.m1.2.2.2.2.1.3.3.3.2.cmml" xref="A1.E10.m1.2.2.2.2.1.3.3.3.2">𝐳</ci><apply id="A1.E10.m1.2.2.2.2.1.3.3.3.3.cmml" xref="A1.E10.m1.2.2.2.2.1.3.3.3.3"><times id="A1.E10.m1.2.2.2.2.1.3.3.3.3.1.cmml" xref="A1.E10.m1.2.2.2.2.1.3.3.3.3.1"></times><ci id="A1.E10.m1.2.2.2.2.1.3.3.3.3.2.cmml" xref="A1.E10.m1.2.2.2.2.1.3.3.3.3.2">𝑚</ci><ci id="A1.E10.m1.2.2.2.2.1.3.3.3.3.3.cmml" xref="A1.E10.m1.2.2.2.2.1.3.3.3.3.3">𝑠</ci></apply></apply><apply id="A1.E10.m1.2.2.2.2.1.4.4.4.cmml" xref="A1.E10.m1.2.2.2.2.1.4.4.4"><csymbol cd="ambiguous" id="A1.E10.m1.2.2.2.2.1.4.4.4.1.cmml" xref="A1.E10.m1.2.2.2.2.1.4.4.4">subscript</csymbol><ci id="A1.E10.m1.2.2.2.2.1.4.4.4.2.cmml" xref="A1.E10.m1.2.2.2.2.1.4.4.4.2">𝐳</ci><apply id="A1.E10.m1.2.2.2.2.1.4.4.4.3.cmml" xref="A1.E10.m1.2.2.2.2.1.4.4.4.3"><times id="A1.E10.m1.2.2.2.2.1.4.4.4.3.1.cmml" xref="A1.E10.m1.2.2.2.2.1.4.4.4.3.1"></times><ci id="A1.E10.m1.2.2.2.2.1.4.4.4.3.2.cmml" xref="A1.E10.m1.2.2.2.2.1.4.4.4.3.2">𝑚</ci><ci id="A1.E10.m1.2.2.2.2.1.4.4.4.3.3.cmml" xref="A1.E10.m1.2.2.2.2.1.4.4.4.3.3">𝑞</ci></apply></apply></vector><ci id="A1.E10.m1.2.2.2.2.1.6.cmml" xref="A1.E10.m1.2.2.2.2.1.6">𝒟</ci></apply><apply id="A1.E10.m1.3.3.3.3.2.cmml" xref="A1.E10.m1.3.3.3.3.2"><in id="A1.E10.m1.3.3.3.3.2.1.cmml" xref="A1.E10.m1.3.3.3.3.2.1"></in><ci id="A1.E10.m1.3.3.3.3.2.2.cmml" xref="A1.E10.m1.3.3.3.3.2.2">𝑡</ci><apply id="A1.E10.m1.3.3.3.3.2.3.cmml" xref="A1.E10.m1.3.3.3.3.2.3"><times id="A1.E10.m1.3.3.3.3.2.3.1.cmml" xref="A1.E10.m1.3.3.3.3.2.3.1"></times><ci id="A1.E10.m1.3.3.3.3.2.3.2.cmml" xref="A1.E10.m1.3.3.3.3.2.3.2">𝒰</ci><ci id="A1.E10.m1.1.1.1.1.cmml" xref="A1.E10.m1.1.1.1.1">𝑇</ci></apply></apply></apply></apply><apply id="A1.E10.m1.6.6.1.1.2.cmml" xref="A1.E10.m1.6.6.1.1.1"><csymbol cd="latexml" id="A1.E10.m1.6.6.1.1.2.1.cmml" xref="A1.E10.m1.6.6.1.1.1.2">delimited-[]</csymbol><apply id="A1.E10.m1.6.6.1.1.1.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1">superscript</csymbol><apply id="A1.E10.m1.6.6.1.1.1.1.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1">subscript</csymbol><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E10.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1"><minus id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.5.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.5"></minus><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6">subscript</csymbol><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.2">𝐳</ci><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3"><times id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.1"></times><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.2">𝑚</ci><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.6.3.3">𝑞</ci></apply></apply><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4"><times id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.5.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.5"></times><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6">subscript</csymbol><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6">superscript</csymbol><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.2">𝑣</ci><times id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.2.3"></times></apply><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.6.3">𝜃</ci></apply><vector id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.5.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4"><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑚</ci><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑞</ci></apply></apply><ci id="A1.E10.m1.4.4.1.1.cmml" xref="A1.E10.m1.4.4.1.1">𝑡</ci></apply><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐳</ci><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.2">𝐳</ci><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.3.3.3.3.3">𝑞</ci></apply><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4"><csymbol cd="ambiguous" id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4">subscript</csymbol><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.2">𝐳</ci><apply id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3"><times id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.1.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.1"></times><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.2.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.2">𝑚</ci><ci id="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.3.cmml" xref="A1.E10.m1.6.6.1.1.1.1.1.1.1.1.4.4.4.4.3.3">𝑠</ci></apply></apply><ci id="A1.E10.m1.5.5.cmml" xref="A1.E10.m1.5.5">𝑡</ci></vector></apply></apply></apply><cn id="A1.E10.m1.6.6.1.1.1.1.1.3.cmml" type="integer" xref="A1.E10.m1.6.6.1.1.1.1.1.3">2</cn></apply><cn id="A1.E10.m1.6.6.1.1.1.1.3.cmml" type="integer" xref="A1.E10.m1.6.6.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E10.m1.6c">\mathcal{L_{\mathbf{MI2M}}}=\mathbb{E}_{(\mathbf{z}_{s},\mathbf{z}_{q},\mathbf%
{z}_{ms},\mathbf{z}_{mq})\sim\mathcal{D},t\in\mathcal{U}(T)}\left[\left\|%
\mathbf{z}_{mq}-v^{*}_{\theta}\left(\mathbf{z}_{mq}^{(t)},\mathbf{z}_{s},%
\mathbf{z}_{q},\mathbf{z}_{ms},t\right)\right\|_{2}^{2}\right]</annotation><annotation encoding="application/x-llamapun" id="A1.E10.m1.6d">caligraphic_L start_POSTSUBSCRIPT bold_MI2M end_POSTSUBSCRIPT = blackboard_E start_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT ) ∼ caligraphic_D , italic_t ∈ caligraphic_U ( italic_T ) end_POSTSUBSCRIPT [ ∥ bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT - italic_v start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_z start_POSTSUBSCRIPT italic_m italic_q end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_t ) end_POSTSUPERSCRIPT , bold_z start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_z start_POSTSUBSCRIPT italic_m italic_s end_POSTSUBSCRIPT , italic_t ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Cross-attention tokenized interaction</h3>
<div class="ltx_para" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">In the <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS2" title="4.2 Injection of support mask information ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.2</span></a>, we only discussed how to inject information from the support mask based on the Self-attention kv fusion method. Here we discuss how to inject information from the support mask based on the Tokenized Interaction Cross-Attention method. There are also the following four ways.</p>
<ol class="ltx_enumerate" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="A1.I1.i1.1.1.1">a.</span></span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.3"><span class="ltx_text ltx_font_bold" id="A1.I1.i1.p1.3.1">Concatenation</span> We can convert the support mask <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.1.m1.1"><semantics id="A1.I1.i1.p1.1.m1.1a"><msub id="A1.I1.i1.p1.1.m1.1.1" xref="A1.I1.i1.p1.1.m1.1.1.cmml"><mi id="A1.I1.i1.p1.1.m1.1.1.2" xref="A1.I1.i1.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="A1.I1.i1.p1.1.m1.1.1.3" xref="A1.I1.i1.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.1.m1.1b"><apply id="A1.I1.i1.p1.1.m1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.1.m1.1.1.1.cmml" xref="A1.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.1.m1.1.1.2.cmml" xref="A1.I1.i1.p1.1.m1.1.1.2">𝐌</ci><ci id="A1.I1.i1.p1.1.m1.1.1.3.cmml" xref="A1.I1.i1.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.1.m1.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> into an RGB image, encode <math alttext="I_{s}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.2.m2.1"><semantics id="A1.I1.i1.p1.2.m2.1a"><msub id="A1.I1.i1.p1.2.m2.1.1" xref="A1.I1.i1.p1.2.m2.1.1.cmml"><mi id="A1.I1.i1.p1.2.m2.1.1.2" xref="A1.I1.i1.p1.2.m2.1.1.2.cmml">I</mi><mi id="A1.I1.i1.p1.2.m2.1.1.3" xref="A1.I1.i1.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.2.m2.1b"><apply id="A1.I1.i1.p1.2.m2.1.1.cmml" xref="A1.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.2.m2.1.1.1.cmml" xref="A1.I1.i1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.2.m2.1.1.2.cmml" xref="A1.I1.i1.p1.2.m2.1.1.2">𝐼</ci><ci id="A1.I1.i1.p1.2.m2.1.1.3.cmml" xref="A1.I1.i1.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.2.m2.1c">I_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.2.m2.1d">italic_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="A1.I1.i1.p1.3.m3.1"><semantics id="A1.I1.i1.p1.3.m3.1a"><msub id="A1.I1.i1.p1.3.m3.1.1" xref="A1.I1.i1.p1.3.m3.1.1.cmml"><mi id="A1.I1.i1.p1.3.m3.1.1.2" xref="A1.I1.i1.p1.3.m3.1.1.2.cmml">𝐌</mi><mi id="A1.I1.i1.p1.3.m3.1.1.3" xref="A1.I1.i1.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i1.p1.3.m3.1b"><apply id="A1.I1.i1.p1.3.m3.1.1.cmml" xref="A1.I1.i1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.I1.i1.p1.3.m3.1.1.1.cmml" xref="A1.I1.i1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.I1.i1.p1.3.m3.1.1.2.cmml" xref="A1.I1.i1.p1.3.m3.1.1.2">𝐌</ci><ci id="A1.I1.i1.p1.3.m3.1.1.3.cmml" xref="A1.I1.i1.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i1.p1.3.m3.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i1.p1.3.m3.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> into token sequences using CLIP image encoder respectively, concatenate them on the sequence, and finally use them as the input of cross-attention.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="A1.I1.i2.1.1.1">b.</span></span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.4"><span class="ltx_text ltx_font_bold" id="A1.I1.i2.p1.4.1">Multiplication</span> We can directly multiply <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="A1.I1.i2.p1.1.m1.1"><semantics id="A1.I1.i2.p1.1.m1.1a"><msub id="A1.I1.i2.p1.1.m1.1.1" xref="A1.I1.i2.p1.1.m1.1.1.cmml"><mi id="A1.I1.i2.p1.1.m1.1.1.2" xref="A1.I1.i2.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="A1.I1.i2.p1.1.m1.1.1.3" xref="A1.I1.i2.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.1.m1.1b"><apply id="A1.I1.i2.p1.1.m1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I1.i2.p1.1.m1.1.1.1.cmml" xref="A1.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I1.i2.p1.1.m1.1.1.2.cmml" xref="A1.I1.i2.p1.1.m1.1.1.2">𝐌</ci><ci id="A1.I1.i2.p1.1.m1.1.1.3.cmml" xref="A1.I1.i2.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.1.m1.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> on the image <math alttext="\mathbf{I}_{s}" class="ltx_Math" display="inline" id="A1.I1.i2.p1.2.m2.1"><semantics id="A1.I1.i2.p1.2.m2.1a"><msub id="A1.I1.i2.p1.2.m2.1.1" xref="A1.I1.i2.p1.2.m2.1.1.cmml"><mi id="A1.I1.i2.p1.2.m2.1.1.2" xref="A1.I1.i2.p1.2.m2.1.1.2.cmml">𝐈</mi><mi id="A1.I1.i2.p1.2.m2.1.1.3" xref="A1.I1.i2.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.2.m2.1b"><apply id="A1.I1.i2.p1.2.m2.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I1.i2.p1.2.m2.1.1.1.cmml" xref="A1.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I1.i2.p1.2.m2.1.1.2.cmml" xref="A1.I1.i2.p1.2.m2.1.1.2">𝐈</ci><ci id="A1.I1.i2.p1.2.m2.1.1.3.cmml" xref="A1.I1.i2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.2.m2.1c">\mathbf{I}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.2.m2.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to form the image <math alttext="\mathbf{I}_{s}^{*}=\mathbf{I}_{s}\cdot\mathbf{M}_{s}" class="ltx_Math" display="inline" id="A1.I1.i2.p1.3.m3.1"><semantics id="A1.I1.i2.p1.3.m3.1a"><mrow id="A1.I1.i2.p1.3.m3.1.1" xref="A1.I1.i2.p1.3.m3.1.1.cmml"><msubsup id="A1.I1.i2.p1.3.m3.1.1.2" xref="A1.I1.i2.p1.3.m3.1.1.2.cmml"><mi id="A1.I1.i2.p1.3.m3.1.1.2.2.2" xref="A1.I1.i2.p1.3.m3.1.1.2.2.2.cmml">𝐈</mi><mi id="A1.I1.i2.p1.3.m3.1.1.2.2.3" xref="A1.I1.i2.p1.3.m3.1.1.2.2.3.cmml">s</mi><mo id="A1.I1.i2.p1.3.m3.1.1.2.3" xref="A1.I1.i2.p1.3.m3.1.1.2.3.cmml">∗</mo></msubsup><mo id="A1.I1.i2.p1.3.m3.1.1.1" xref="A1.I1.i2.p1.3.m3.1.1.1.cmml">=</mo><mrow id="A1.I1.i2.p1.3.m3.1.1.3" xref="A1.I1.i2.p1.3.m3.1.1.3.cmml"><msub id="A1.I1.i2.p1.3.m3.1.1.3.2" xref="A1.I1.i2.p1.3.m3.1.1.3.2.cmml"><mi id="A1.I1.i2.p1.3.m3.1.1.3.2.2" xref="A1.I1.i2.p1.3.m3.1.1.3.2.2.cmml">𝐈</mi><mi id="A1.I1.i2.p1.3.m3.1.1.3.2.3" xref="A1.I1.i2.p1.3.m3.1.1.3.2.3.cmml">s</mi></msub><mo id="A1.I1.i2.p1.3.m3.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="A1.I1.i2.p1.3.m3.1.1.3.1.cmml">⋅</mo><msub id="A1.I1.i2.p1.3.m3.1.1.3.3" xref="A1.I1.i2.p1.3.m3.1.1.3.3.cmml"><mi id="A1.I1.i2.p1.3.m3.1.1.3.3.2" xref="A1.I1.i2.p1.3.m3.1.1.3.3.2.cmml">𝐌</mi><mi id="A1.I1.i2.p1.3.m3.1.1.3.3.3" xref="A1.I1.i2.p1.3.m3.1.1.3.3.3.cmml">s</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.3.m3.1b"><apply id="A1.I1.i2.p1.3.m3.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1"><eq id="A1.I1.i2.p1.3.m3.1.1.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.1"></eq><apply id="A1.I1.i2.p1.3.m3.1.1.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i2.p1.3.m3.1.1.2.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.2">superscript</csymbol><apply id="A1.I1.i2.p1.3.m3.1.1.2.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i2.p1.3.m3.1.1.2.2.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.2">subscript</csymbol><ci id="A1.I1.i2.p1.3.m3.1.1.2.2.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.2.2.2">𝐈</ci><ci id="A1.I1.i2.p1.3.m3.1.1.2.2.3.cmml" xref="A1.I1.i2.p1.3.m3.1.1.2.2.3">𝑠</ci></apply><times id="A1.I1.i2.p1.3.m3.1.1.2.3.cmml" xref="A1.I1.i2.p1.3.m3.1.1.2.3"></times></apply><apply id="A1.I1.i2.p1.3.m3.1.1.3.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3"><ci id="A1.I1.i2.p1.3.m3.1.1.3.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.1">⋅</ci><apply id="A1.I1.i2.p1.3.m3.1.1.3.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.2"><csymbol cd="ambiguous" id="A1.I1.i2.p1.3.m3.1.1.3.2.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.2">subscript</csymbol><ci id="A1.I1.i2.p1.3.m3.1.1.3.2.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.2.2">𝐈</ci><ci id="A1.I1.i2.p1.3.m3.1.1.3.2.3.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.2.3">𝑠</ci></apply><apply id="A1.I1.i2.p1.3.m3.1.1.3.3.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="A1.I1.i2.p1.3.m3.1.1.3.3.1.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.3">subscript</csymbol><ci id="A1.I1.i2.p1.3.m3.1.1.3.3.2.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.3.2">𝐌</ci><ci id="A1.I1.i2.p1.3.m3.1.1.3.3.3.cmml" xref="A1.I1.i2.p1.3.m3.1.1.3.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.3.m3.1c">\mathbf{I}_{s}^{*}=\mathbf{I}_{s}\cdot\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.3.m3.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ⋅ bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, and finally encode <math alttext="\mathbf{I}_{s}^{*}" class="ltx_Math" display="inline" id="A1.I1.i2.p1.4.m4.1"><semantics id="A1.I1.i2.p1.4.m4.1a"><msubsup id="A1.I1.i2.p1.4.m4.1.1" xref="A1.I1.i2.p1.4.m4.1.1.cmml"><mi id="A1.I1.i2.p1.4.m4.1.1.2.2" xref="A1.I1.i2.p1.4.m4.1.1.2.2.cmml">𝐈</mi><mi id="A1.I1.i2.p1.4.m4.1.1.2.3" xref="A1.I1.i2.p1.4.m4.1.1.2.3.cmml">s</mi><mo id="A1.I1.i2.p1.4.m4.1.1.3" xref="A1.I1.i2.p1.4.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.I1.i2.p1.4.m4.1b"><apply id="A1.I1.i2.p1.4.m4.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.I1.i2.p1.4.m4.1.1.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1">superscript</csymbol><apply id="A1.I1.i2.p1.4.m4.1.1.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.I1.i2.p1.4.m4.1.1.2.1.cmml" xref="A1.I1.i2.p1.4.m4.1.1">subscript</csymbol><ci id="A1.I1.i2.p1.4.m4.1.1.2.2.cmml" xref="A1.I1.i2.p1.4.m4.1.1.2.2">𝐈</ci><ci id="A1.I1.i2.p1.4.m4.1.1.2.3.cmml" xref="A1.I1.i2.p1.4.m4.1.1.2.3">𝑠</ci></apply><times id="A1.I1.i2.p1.4.m4.1.1.3.cmml" xref="A1.I1.i2.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i2.p1.4.m4.1c">\mathbf{I}_{s}^{*}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i2.p1.4.m4.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> into a token sequence using CLIP image encoder as the input of cross-attention.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="A1.I1.i3.1.1.1">c.</span></span>
<div class="ltx_para" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.4"><span class="ltx_text ltx_font_bold" id="A1.I1.i3.p1.4.1">Addition</span> We can also directly add <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="A1.I1.i3.p1.1.m1.1"><semantics id="A1.I1.i3.p1.1.m1.1a"><msub id="A1.I1.i3.p1.1.m1.1.1" xref="A1.I1.i3.p1.1.m1.1.1.cmml"><mi id="A1.I1.i3.p1.1.m1.1.1.2" xref="A1.I1.i3.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="A1.I1.i3.p1.1.m1.1.1.3" xref="A1.I1.i3.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.1.m1.1b"><apply id="A1.I1.i3.p1.1.m1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I1.i3.p1.1.m1.1.1.1.cmml" xref="A1.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I1.i3.p1.1.m1.1.1.2.cmml" xref="A1.I1.i3.p1.1.m1.1.1.2">𝐌</ci><ci id="A1.I1.i3.p1.1.m1.1.1.3.cmml" xref="A1.I1.i3.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.1.m1.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to the image <math alttext="\mathbf{I}_{s}" class="ltx_Math" display="inline" id="A1.I1.i3.p1.2.m2.1"><semantics id="A1.I1.i3.p1.2.m2.1a"><msub id="A1.I1.i3.p1.2.m2.1.1" xref="A1.I1.i3.p1.2.m2.1.1.cmml"><mi id="A1.I1.i3.p1.2.m2.1.1.2" xref="A1.I1.i3.p1.2.m2.1.1.2.cmml">𝐈</mi><mi id="A1.I1.i3.p1.2.m2.1.1.3" xref="A1.I1.i3.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.2.m2.1b"><apply id="A1.I1.i3.p1.2.m2.1.1.cmml" xref="A1.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I1.i3.p1.2.m2.1.1.1.cmml" xref="A1.I1.i3.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I1.i3.p1.2.m2.1.1.2.cmml" xref="A1.I1.i3.p1.2.m2.1.1.2">𝐈</ci><ci id="A1.I1.i3.p1.2.m2.1.1.3.cmml" xref="A1.I1.i3.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.2.m2.1c">\mathbf{I}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.2.m2.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to form the image <math alttext="\mathbf{I}_{s}^{*}=0.5\mathbf{I}_{s}+0.5\mathbf{M}_{s}" class="ltx_Math" display="inline" id="A1.I1.i3.p1.3.m3.1"><semantics id="A1.I1.i3.p1.3.m3.1a"><mrow id="A1.I1.i3.p1.3.m3.1.1" xref="A1.I1.i3.p1.3.m3.1.1.cmml"><msubsup id="A1.I1.i3.p1.3.m3.1.1.2" xref="A1.I1.i3.p1.3.m3.1.1.2.cmml"><mi id="A1.I1.i3.p1.3.m3.1.1.2.2.2" xref="A1.I1.i3.p1.3.m3.1.1.2.2.2.cmml">𝐈</mi><mi id="A1.I1.i3.p1.3.m3.1.1.2.2.3" xref="A1.I1.i3.p1.3.m3.1.1.2.2.3.cmml">s</mi><mo id="A1.I1.i3.p1.3.m3.1.1.2.3" xref="A1.I1.i3.p1.3.m3.1.1.2.3.cmml">∗</mo></msubsup><mo id="A1.I1.i3.p1.3.m3.1.1.1" xref="A1.I1.i3.p1.3.m3.1.1.1.cmml">=</mo><mrow id="A1.I1.i3.p1.3.m3.1.1.3" xref="A1.I1.i3.p1.3.m3.1.1.3.cmml"><mrow id="A1.I1.i3.p1.3.m3.1.1.3.2" xref="A1.I1.i3.p1.3.m3.1.1.3.2.cmml"><mn id="A1.I1.i3.p1.3.m3.1.1.3.2.2" xref="A1.I1.i3.p1.3.m3.1.1.3.2.2.cmml">0.5</mn><mo id="A1.I1.i3.p1.3.m3.1.1.3.2.1" xref="A1.I1.i3.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><msub id="A1.I1.i3.p1.3.m3.1.1.3.2.3" xref="A1.I1.i3.p1.3.m3.1.1.3.2.3.cmml"><mi id="A1.I1.i3.p1.3.m3.1.1.3.2.3.2" xref="A1.I1.i3.p1.3.m3.1.1.3.2.3.2.cmml">𝐈</mi><mi id="A1.I1.i3.p1.3.m3.1.1.3.2.3.3" xref="A1.I1.i3.p1.3.m3.1.1.3.2.3.3.cmml">s</mi></msub></mrow><mo id="A1.I1.i3.p1.3.m3.1.1.3.1" xref="A1.I1.i3.p1.3.m3.1.1.3.1.cmml">+</mo><mrow id="A1.I1.i3.p1.3.m3.1.1.3.3" xref="A1.I1.i3.p1.3.m3.1.1.3.3.cmml"><mn id="A1.I1.i3.p1.3.m3.1.1.3.3.2" xref="A1.I1.i3.p1.3.m3.1.1.3.3.2.cmml">0.5</mn><mo id="A1.I1.i3.p1.3.m3.1.1.3.3.1" xref="A1.I1.i3.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><msub id="A1.I1.i3.p1.3.m3.1.1.3.3.3" xref="A1.I1.i3.p1.3.m3.1.1.3.3.3.cmml"><mi id="A1.I1.i3.p1.3.m3.1.1.3.3.3.2" xref="A1.I1.i3.p1.3.m3.1.1.3.3.3.2.cmml">𝐌</mi><mi id="A1.I1.i3.p1.3.m3.1.1.3.3.3.3" xref="A1.I1.i3.p1.3.m3.1.1.3.3.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.3.m3.1b"><apply id="A1.I1.i3.p1.3.m3.1.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1"><eq id="A1.I1.i3.p1.3.m3.1.1.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.1"></eq><apply id="A1.I1.i3.p1.3.m3.1.1.2.cmml" xref="A1.I1.i3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i3.p1.3.m3.1.1.2.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.2">superscript</csymbol><apply id="A1.I1.i3.p1.3.m3.1.1.2.2.cmml" xref="A1.I1.i3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="A1.I1.i3.p1.3.m3.1.1.2.2.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.2">subscript</csymbol><ci id="A1.I1.i3.p1.3.m3.1.1.2.2.2.cmml" xref="A1.I1.i3.p1.3.m3.1.1.2.2.2">𝐈</ci><ci id="A1.I1.i3.p1.3.m3.1.1.2.2.3.cmml" xref="A1.I1.i3.p1.3.m3.1.1.2.2.3">𝑠</ci></apply><times id="A1.I1.i3.p1.3.m3.1.1.2.3.cmml" xref="A1.I1.i3.p1.3.m3.1.1.2.3"></times></apply><apply id="A1.I1.i3.p1.3.m3.1.1.3.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3"><plus id="A1.I1.i3.p1.3.m3.1.1.3.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.1"></plus><apply id="A1.I1.i3.p1.3.m3.1.1.3.2.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.2"><times id="A1.I1.i3.p1.3.m3.1.1.3.2.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.2.1"></times><cn id="A1.I1.i3.p1.3.m3.1.1.3.2.2.cmml" type="float" xref="A1.I1.i3.p1.3.m3.1.1.3.2.2">0.5</cn><apply id="A1.I1.i3.p1.3.m3.1.1.3.2.3.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.2.3"><csymbol cd="ambiguous" id="A1.I1.i3.p1.3.m3.1.1.3.2.3.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.2.3">subscript</csymbol><ci id="A1.I1.i3.p1.3.m3.1.1.3.2.3.2.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.2.3.2">𝐈</ci><ci id="A1.I1.i3.p1.3.m3.1.1.3.2.3.3.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.2.3.3">𝑠</ci></apply></apply><apply id="A1.I1.i3.p1.3.m3.1.1.3.3.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.3"><times id="A1.I1.i3.p1.3.m3.1.1.3.3.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.3.1"></times><cn id="A1.I1.i3.p1.3.m3.1.1.3.3.2.cmml" type="float" xref="A1.I1.i3.p1.3.m3.1.1.3.3.2">0.5</cn><apply id="A1.I1.i3.p1.3.m3.1.1.3.3.3.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="A1.I1.i3.p1.3.m3.1.1.3.3.3.1.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="A1.I1.i3.p1.3.m3.1.1.3.3.3.2.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.3.3.2">𝐌</ci><ci id="A1.I1.i3.p1.3.m3.1.1.3.3.3.3.cmml" xref="A1.I1.i3.p1.3.m3.1.1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.3.m3.1c">\mathbf{I}_{s}^{*}=0.5\mathbf{I}_{s}+0.5\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.3.m3.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = 0.5 bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT + 0.5 bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>. Similarly, we encode <math alttext="\mathbf{I}_{s}^{*}" class="ltx_Math" display="inline" id="A1.I1.i3.p1.4.m4.1"><semantics id="A1.I1.i3.p1.4.m4.1a"><msubsup id="A1.I1.i3.p1.4.m4.1.1" xref="A1.I1.i3.p1.4.m4.1.1.cmml"><mi id="A1.I1.i3.p1.4.m4.1.1.2.2" xref="A1.I1.i3.p1.4.m4.1.1.2.2.cmml">𝐈</mi><mi id="A1.I1.i3.p1.4.m4.1.1.2.3" xref="A1.I1.i3.p1.4.m4.1.1.2.3.cmml">s</mi><mo id="A1.I1.i3.p1.4.m4.1.1.3" xref="A1.I1.i3.p1.4.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="A1.I1.i3.p1.4.m4.1b"><apply id="A1.I1.i3.p1.4.m4.1.1.cmml" xref="A1.I1.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.I1.i3.p1.4.m4.1.1.1.cmml" xref="A1.I1.i3.p1.4.m4.1.1">superscript</csymbol><apply id="A1.I1.i3.p1.4.m4.1.1.2.cmml" xref="A1.I1.i3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.I1.i3.p1.4.m4.1.1.2.1.cmml" xref="A1.I1.i3.p1.4.m4.1.1">subscript</csymbol><ci id="A1.I1.i3.p1.4.m4.1.1.2.2.cmml" xref="A1.I1.i3.p1.4.m4.1.1.2.2">𝐈</ci><ci id="A1.I1.i3.p1.4.m4.1.1.2.3.cmml" xref="A1.I1.i3.p1.4.m4.1.1.2.3">𝑠</ci></apply><times id="A1.I1.i3.p1.4.m4.1.1.3.cmml" xref="A1.I1.i3.p1.4.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i3.p1.4.m4.1c">\mathbf{I}_{s}^{*}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i3.p1.4.m4.1d">bold_I start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> into a token sequence using CLIP image encoder as the input of cross-attention.</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="A1.I1.i4.1.1.1">d.</span></span>
<div class="ltx_para" id="A1.I1.i4.p1">
<p class="ltx_p" id="A1.I1.i4.p1.3"><span class="ltx_text ltx_font_bold" id="A1.I1.i4.p1.3.1">Attention Mask</span> We can use <math alttext="\mathbf{M}_{s}" class="ltx_Math" display="inline" id="A1.I1.i4.p1.1.m1.1"><semantics id="A1.I1.i4.p1.1.m1.1a"><msub id="A1.I1.i4.p1.1.m1.1.1" xref="A1.I1.i4.p1.1.m1.1.1.cmml"><mi id="A1.I1.i4.p1.1.m1.1.1.2" xref="A1.I1.i4.p1.1.m1.1.1.2.cmml">𝐌</mi><mi id="A1.I1.i4.p1.1.m1.1.1.3" xref="A1.I1.i4.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.1.m1.1b"><apply id="A1.I1.i4.p1.1.m1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.I1.i4.p1.1.m1.1.1.1.cmml" xref="A1.I1.i4.p1.1.m1.1.1">subscript</csymbol><ci id="A1.I1.i4.p1.1.m1.1.1.2.cmml" xref="A1.I1.i4.p1.1.m1.1.1.2">𝐌</ci><ci id="A1.I1.i4.p1.1.m1.1.1.3.cmml" xref="A1.I1.i4.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.1.m1.1c">\mathbf{M}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.1.m1.1d">bold_M start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> as an attention mask to control self-attention, so that only <math alttext="\mathbf{K}_{s}" class="ltx_Math" display="inline" id="A1.I1.i4.p1.2.m2.1"><semantics id="A1.I1.i4.p1.2.m2.1a"><msub id="A1.I1.i4.p1.2.m2.1.1" xref="A1.I1.i4.p1.2.m2.1.1.cmml"><mi id="A1.I1.i4.p1.2.m2.1.1.2" xref="A1.I1.i4.p1.2.m2.1.1.2.cmml">𝐊</mi><mi id="A1.I1.i4.p1.2.m2.1.1.3" xref="A1.I1.i4.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.2.m2.1b"><apply id="A1.I1.i4.p1.2.m2.1.1.cmml" xref="A1.I1.i4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.I1.i4.p1.2.m2.1.1.1.cmml" xref="A1.I1.i4.p1.2.m2.1.1">subscript</csymbol><ci id="A1.I1.i4.p1.2.m2.1.1.2.cmml" xref="A1.I1.i4.p1.2.m2.1.1.2">𝐊</ci><ci id="A1.I1.i4.p1.2.m2.1.1.3.cmml" xref="A1.I1.i4.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.2.m2.1c">\mathbf{K}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.2.m2.1d">bold_K start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> in the masked area can be accessed by <math alttext="\mathbf{Q}_{q}" class="ltx_Math" display="inline" id="A1.I1.i4.p1.3.m3.1"><semantics id="A1.I1.i4.p1.3.m3.1a"><msub id="A1.I1.i4.p1.3.m3.1.1" xref="A1.I1.i4.p1.3.m3.1.1.cmml"><mi id="A1.I1.i4.p1.3.m3.1.1.2" xref="A1.I1.i4.p1.3.m3.1.1.2.cmml">𝐐</mi><mi id="A1.I1.i4.p1.3.m3.1.1.3" xref="A1.I1.i4.p1.3.m3.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="A1.I1.i4.p1.3.m3.1b"><apply id="A1.I1.i4.p1.3.m3.1.1.cmml" xref="A1.I1.i4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.I1.i4.p1.3.m3.1.1.1.cmml" xref="A1.I1.i4.p1.3.m3.1.1">subscript</csymbol><ci id="A1.I1.i4.p1.3.m3.1.1.2.cmml" xref="A1.I1.i4.p1.3.m3.1.1.2">𝐐</ci><ci id="A1.I1.i4.p1.3.m3.1.1.3.cmml" xref="A1.I1.i4.p1.3.m3.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.I1.i4.p1.3.m3.1c">\mathbf{Q}_{q}</annotation><annotation encoding="application/x-llamapun" id="A1.I1.i4.p1.3.m3.1d">bold_Q start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Post processing</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.4">The original prediction of the model is an RGB three-channel image. We first average over the channel dimension to obtain a single-channel <math alttext="\hat{\textbf{M}}_{q}\in[0,1]^{H\times W}" class="ltx_Math" display="inline" id="A1.SS4.p1.1.m1.2"><semantics id="A1.SS4.p1.1.m1.2a"><mrow id="A1.SS4.p1.1.m1.2.3" xref="A1.SS4.p1.1.m1.2.3.cmml"><msub id="A1.SS4.p1.1.m1.2.3.2" xref="A1.SS4.p1.1.m1.2.3.2.cmml"><mover accent="true" id="A1.SS4.p1.1.m1.2.3.2.2" xref="A1.SS4.p1.1.m1.2.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS4.p1.1.m1.2.3.2.2.2" xref="A1.SS4.p1.1.m1.2.3.2.2.2a.cmml">M</mtext><mo id="A1.SS4.p1.1.m1.2.3.2.2.1" xref="A1.SS4.p1.1.m1.2.3.2.2.1.cmml">^</mo></mover><mi id="A1.SS4.p1.1.m1.2.3.2.3" xref="A1.SS4.p1.1.m1.2.3.2.3.cmml">q</mi></msub><mo id="A1.SS4.p1.1.m1.2.3.1" xref="A1.SS4.p1.1.m1.2.3.1.cmml">∈</mo><msup id="A1.SS4.p1.1.m1.2.3.3" xref="A1.SS4.p1.1.m1.2.3.3.cmml"><mrow id="A1.SS4.p1.1.m1.2.3.3.2.2" xref="A1.SS4.p1.1.m1.2.3.3.2.1.cmml"><mo id="A1.SS4.p1.1.m1.2.3.3.2.2.1" stretchy="false" xref="A1.SS4.p1.1.m1.2.3.3.2.1.cmml">[</mo><mn id="A1.SS4.p1.1.m1.1.1" xref="A1.SS4.p1.1.m1.1.1.cmml">0</mn><mo id="A1.SS4.p1.1.m1.2.3.3.2.2.2" xref="A1.SS4.p1.1.m1.2.3.3.2.1.cmml">,</mo><mn id="A1.SS4.p1.1.m1.2.2" xref="A1.SS4.p1.1.m1.2.2.cmml">1</mn><mo id="A1.SS4.p1.1.m1.2.3.3.2.2.3" stretchy="false" xref="A1.SS4.p1.1.m1.2.3.3.2.1.cmml">]</mo></mrow><mrow id="A1.SS4.p1.1.m1.2.3.3.3" xref="A1.SS4.p1.1.m1.2.3.3.3.cmml"><mi id="A1.SS4.p1.1.m1.2.3.3.3.2" xref="A1.SS4.p1.1.m1.2.3.3.3.2.cmml">H</mi><mo id="A1.SS4.p1.1.m1.2.3.3.3.1" lspace="0.222em" rspace="0.222em" xref="A1.SS4.p1.1.m1.2.3.3.3.1.cmml">×</mo><mi id="A1.SS4.p1.1.m1.2.3.3.3.3" xref="A1.SS4.p1.1.m1.2.3.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.1.m1.2b"><apply id="A1.SS4.p1.1.m1.2.3.cmml" xref="A1.SS4.p1.1.m1.2.3"><in id="A1.SS4.p1.1.m1.2.3.1.cmml" xref="A1.SS4.p1.1.m1.2.3.1"></in><apply id="A1.SS4.p1.1.m1.2.3.2.cmml" xref="A1.SS4.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="A1.SS4.p1.1.m1.2.3.2.1.cmml" xref="A1.SS4.p1.1.m1.2.3.2">subscript</csymbol><apply id="A1.SS4.p1.1.m1.2.3.2.2.cmml" xref="A1.SS4.p1.1.m1.2.3.2.2"><ci id="A1.SS4.p1.1.m1.2.3.2.2.1.cmml" xref="A1.SS4.p1.1.m1.2.3.2.2.1">^</ci><ci id="A1.SS4.p1.1.m1.2.3.2.2.2a.cmml" xref="A1.SS4.p1.1.m1.2.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="A1.SS4.p1.1.m1.2.3.2.2.2.cmml" xref="A1.SS4.p1.1.m1.2.3.2.2.2">M</mtext></ci></apply><ci id="A1.SS4.p1.1.m1.2.3.2.3.cmml" xref="A1.SS4.p1.1.m1.2.3.2.3">𝑞</ci></apply><apply id="A1.SS4.p1.1.m1.2.3.3.cmml" xref="A1.SS4.p1.1.m1.2.3.3"><csymbol cd="ambiguous" id="A1.SS4.p1.1.m1.2.3.3.1.cmml" xref="A1.SS4.p1.1.m1.2.3.3">superscript</csymbol><interval closure="closed" id="A1.SS4.p1.1.m1.2.3.3.2.1.cmml" xref="A1.SS4.p1.1.m1.2.3.3.2.2"><cn id="A1.SS4.p1.1.m1.1.1.cmml" type="integer" xref="A1.SS4.p1.1.m1.1.1">0</cn><cn id="A1.SS4.p1.1.m1.2.2.cmml" type="integer" xref="A1.SS4.p1.1.m1.2.2">1</cn></interval><apply id="A1.SS4.p1.1.m1.2.3.3.3.cmml" xref="A1.SS4.p1.1.m1.2.3.3.3"><times id="A1.SS4.p1.1.m1.2.3.3.3.1.cmml" xref="A1.SS4.p1.1.m1.2.3.3.3.1"></times><ci id="A1.SS4.p1.1.m1.2.3.3.3.2.cmml" xref="A1.SS4.p1.1.m1.2.3.3.3.2">𝐻</ci><ci id="A1.SS4.p1.1.m1.2.3.3.3.3.cmml" xref="A1.SS4.p1.1.m1.2.3.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.1.m1.2c">\hat{\textbf{M}}_{q}\in[0,1]^{H\times W}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.1.m1.2d">over^ start_ARG M end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ∈ [ 0 , 1 ] start_POSTSUPERSCRIPT italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math>.
Then we tried two thresholding methods, absolute threshold <math alttext="\tau_{a}" class="ltx_Math" display="inline" id="A1.SS4.p1.2.m2.1"><semantics id="A1.SS4.p1.2.m2.1a"><msub id="A1.SS4.p1.2.m2.1.1" xref="A1.SS4.p1.2.m2.1.1.cmml"><mi id="A1.SS4.p1.2.m2.1.1.2" xref="A1.SS4.p1.2.m2.1.1.2.cmml">τ</mi><mi id="A1.SS4.p1.2.m2.1.1.3" xref="A1.SS4.p1.2.m2.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.2.m2.1b"><apply id="A1.SS4.p1.2.m2.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS4.p1.2.m2.1.1.1.cmml" xref="A1.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="A1.SS4.p1.2.m2.1.1.2.cmml" xref="A1.SS4.p1.2.m2.1.1.2">𝜏</ci><ci id="A1.SS4.p1.2.m2.1.1.3.cmml" xref="A1.SS4.p1.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.2.m2.1c">\tau_{a}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.2.m2.1d">italic_τ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math> and relative threshold <math alttext="\tau_{r}" class="ltx_Math" display="inline" id="A1.SS4.p1.3.m3.1"><semantics id="A1.SS4.p1.3.m3.1a"><msub id="A1.SS4.p1.3.m3.1.1" xref="A1.SS4.p1.3.m3.1.1.cmml"><mi id="A1.SS4.p1.3.m3.1.1.2" xref="A1.SS4.p1.3.m3.1.1.2.cmml">τ</mi><mi id="A1.SS4.p1.3.m3.1.1.3" xref="A1.SS4.p1.3.m3.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.3.m3.1b"><apply id="A1.SS4.p1.3.m3.1.1.cmml" xref="A1.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS4.p1.3.m3.1.1.1.cmml" xref="A1.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS4.p1.3.m3.1.1.2.cmml" xref="A1.SS4.p1.3.m3.1.1.2">𝜏</ci><ci id="A1.SS4.p1.3.m3.1.1.3.cmml" xref="A1.SS4.p1.3.m3.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.3.m3.1c">\tau_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.3.m3.1d">italic_τ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math>. The absolute threshold is a fixed value, and the final binary mask <math alttext="\textbf{M}_{q}" class="ltx_Math" display="inline" id="A1.SS4.p1.4.m4.1"><semantics id="A1.SS4.p1.4.m4.1a"><msub id="A1.SS4.p1.4.m4.1.1" xref="A1.SS4.p1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.SS4.p1.4.m4.1.1.2" xref="A1.SS4.p1.4.m4.1.1.2a.cmml">M</mtext><mi id="A1.SS4.p1.4.m4.1.1.3" xref="A1.SS4.p1.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p1.4.m4.1b"><apply id="A1.SS4.p1.4.m4.1.1.cmml" xref="A1.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS4.p1.4.m4.1.1.1.cmml" xref="A1.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS4.p1.4.m4.1.1.2a.cmml" xref="A1.SS4.p1.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.SS4.p1.4.m4.1.1.2.cmml" xref="A1.SS4.p1.4.m4.1.1.2">M</mtext></ci><ci id="A1.SS4.p1.4.m4.1.1.3.cmml" xref="A1.SS4.p1.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p1.4.m4.1c">\textbf{M}_{q}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p1.4.m4.1d">M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> can be represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{M}_{q}=\left\{\begin{array}[]{l}1,\textbf{if }\hat{\textbf{M}}_{q}&gt;%
\tau_{a}\\
0,\textbf{otherwise}\end{array}\right." class="ltx_Math" display="block" id="A1.E11.m1.4"><semantics id="A1.E11.m1.4a"><mrow id="A1.E11.m1.4.5" xref="A1.E11.m1.4.5.cmml"><msub id="A1.E11.m1.4.5.2" xref="A1.E11.m1.4.5.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.E11.m1.4.5.2.2" xref="A1.E11.m1.4.5.2.2a.cmml">M</mtext><mi id="A1.E11.m1.4.5.2.3" xref="A1.E11.m1.4.5.2.3.cmml">q</mi></msub><mo id="A1.E11.m1.4.5.1" xref="A1.E11.m1.4.5.1.cmml">=</mo><mrow id="A1.E11.m1.4.5.3.2" xref="A1.E11.m1.4.5.3.1.cmml"><mo id="A1.E11.m1.4.5.3.2.1" xref="A1.E11.m1.4.5.3.1.1.cmml">{</mo><mtable displaystyle="true" id="A1.E11.m1.4.4" rowspacing="0pt" xref="A1.E11.m1.4.4.cmml"><mtr id="A1.E11.m1.4.4a" xref="A1.E11.m1.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E11.m1.4.4b" xref="A1.E11.m1.4.4.cmml"><mrow id="A1.E11.m1.2.2.2.2.2" xref="A1.E11.m1.2.2.2.2.2.cmml"><mrow id="A1.E11.m1.2.2.2.2.2.2.1" xref="A1.E11.m1.2.2.2.2.2.2.2.cmml"><mn id="A1.E11.m1.1.1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.1.1.cmml">1</mn><mo id="A1.E11.m1.2.2.2.2.2.2.1.2" xref="A1.E11.m1.2.2.2.2.2.2.2.cmml">,</mo><mrow id="A1.E11.m1.2.2.2.2.2.2.1.1" xref="A1.E11.m1.2.2.2.2.2.2.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.E11.m1.2.2.2.2.2.2.1.1.2" xref="A1.E11.m1.2.2.2.2.2.2.1.1.2a.cmml">if </mtext><mo id="A1.E11.m1.2.2.2.2.2.2.1.1.1" xref="A1.E11.m1.2.2.2.2.2.2.1.1.1.cmml">⁢</mo><msub id="A1.E11.m1.2.2.2.2.2.2.1.1.3" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.cmml"><mover accent="true" id="A1.E11.m1.2.2.2.2.2.2.1.1.3.2" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.2" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.2a.cmml">M</mtext><mo id="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.1" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.1.cmml">^</mo></mover><mi id="A1.E11.m1.2.2.2.2.2.2.1.1.3.3" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.3.cmml">q</mi></msub></mrow></mrow><mo id="A1.E11.m1.2.2.2.2.2.3" xref="A1.E11.m1.2.2.2.2.2.3.cmml">&gt;</mo><msub id="A1.E11.m1.2.2.2.2.2.4" xref="A1.E11.m1.2.2.2.2.2.4.cmml"><mi id="A1.E11.m1.2.2.2.2.2.4.2" xref="A1.E11.m1.2.2.2.2.2.4.2.cmml">τ</mi><mi id="A1.E11.m1.2.2.2.2.2.4.3" xref="A1.E11.m1.2.2.2.2.2.4.3.cmml">a</mi></msub></mrow></mtd></mtr><mtr id="A1.E11.m1.4.4c" xref="A1.E11.m1.4.4.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E11.m1.4.4d" xref="A1.E11.m1.4.4.cmml"><mrow id="A1.E11.m1.4.4.4.2.2.4" xref="A1.E11.m1.4.4.4.2.2.3.cmml"><mn id="A1.E11.m1.3.3.3.1.1.1" xref="A1.E11.m1.3.3.3.1.1.1.cmml">0</mn><mo id="A1.E11.m1.4.4.4.2.2.4.1" xref="A1.E11.m1.4.4.4.2.2.3.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="A1.E11.m1.4.4.4.2.2.2" xref="A1.E11.m1.4.4.4.2.2.2a.cmml">otherwise</mtext></mrow></mtd></mtr></mtable><mi id="A1.E11.m1.4.5.3.2.2" xref="A1.E11.m1.4.5.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E11.m1.4b"><apply id="A1.E11.m1.4.5.cmml" xref="A1.E11.m1.4.5"><eq id="A1.E11.m1.4.5.1.cmml" xref="A1.E11.m1.4.5.1"></eq><apply id="A1.E11.m1.4.5.2.cmml" xref="A1.E11.m1.4.5.2"><csymbol cd="ambiguous" id="A1.E11.m1.4.5.2.1.cmml" xref="A1.E11.m1.4.5.2">subscript</csymbol><ci id="A1.E11.m1.4.5.2.2a.cmml" xref="A1.E11.m1.4.5.2.2"><mtext class="ltx_mathvariant_bold" id="A1.E11.m1.4.5.2.2.cmml" xref="A1.E11.m1.4.5.2.2">M</mtext></ci><ci id="A1.E11.m1.4.5.2.3.cmml" xref="A1.E11.m1.4.5.2.3">𝑞</ci></apply><apply id="A1.E11.m1.4.5.3.1.cmml" xref="A1.E11.m1.4.5.3.2"><csymbol cd="latexml" id="A1.E11.m1.4.5.3.1.1.cmml" xref="A1.E11.m1.4.5.3.2.1">cases</csymbol><matrix id="A1.E11.m1.4.4.cmml" xref="A1.E11.m1.4.4"><matrixrow id="A1.E11.m1.4.4a.cmml" xref="A1.E11.m1.4.4"><apply id="A1.E11.m1.2.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2.2"><gt id="A1.E11.m1.2.2.2.2.2.3.cmml" xref="A1.E11.m1.2.2.2.2.2.3"></gt><list id="A1.E11.m1.2.2.2.2.2.2.2.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1"><cn id="A1.E11.m1.1.1.1.1.1.1.cmml" type="integer" xref="A1.E11.m1.1.1.1.1.1.1">1</cn><apply id="A1.E11.m1.2.2.2.2.2.2.1.1.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1"><times id="A1.E11.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.1"></times><ci id="A1.E11.m1.2.2.2.2.2.2.1.1.2a.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.E11.m1.2.2.2.2.2.2.1.1.2.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.2">if </mtext></ci><apply id="A1.E11.m1.2.2.2.2.2.2.1.1.3.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A1.E11.m1.2.2.2.2.2.2.1.1.3.1.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3">subscript</csymbol><apply id="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.2"><ci id="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.1.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.1">^</ci><ci id="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.2a.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.2.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.2.2">M</mtext></ci></apply><ci id="A1.E11.m1.2.2.2.2.2.2.1.1.3.3.cmml" xref="A1.E11.m1.2.2.2.2.2.2.1.1.3.3">𝑞</ci></apply></apply></list><apply id="A1.E11.m1.2.2.2.2.2.4.cmml" xref="A1.E11.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="A1.E11.m1.2.2.2.2.2.4.1.cmml" xref="A1.E11.m1.2.2.2.2.2.4">subscript</csymbol><ci id="A1.E11.m1.2.2.2.2.2.4.2.cmml" xref="A1.E11.m1.2.2.2.2.2.4.2">𝜏</ci><ci id="A1.E11.m1.2.2.2.2.2.4.3.cmml" xref="A1.E11.m1.2.2.2.2.2.4.3">𝑎</ci></apply></apply></matrixrow><matrixrow id="A1.E11.m1.4.4b.cmml" xref="A1.E11.m1.4.4"><list id="A1.E11.m1.4.4.4.2.2.3.cmml" xref="A1.E11.m1.4.4.4.2.2.4"><cn id="A1.E11.m1.3.3.3.1.1.1.cmml" type="integer" xref="A1.E11.m1.3.3.3.1.1.1">0</cn><ci id="A1.E11.m1.4.4.4.2.2.2a.cmml" xref="A1.E11.m1.4.4.4.2.2.2"><mtext class="ltx_mathvariant_bold" id="A1.E11.m1.4.4.4.2.2.2.cmml" xref="A1.E11.m1.4.4.4.2.2.2">otherwise</mtext></ci></list></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E11.m1.4c">\textbf{M}_{q}=\left\{\begin{array}[]{l}1,\textbf{if }\hat{\textbf{M}}_{q}&gt;%
\tau_{a}\\
0,\textbf{otherwise}\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="A1.E11.m1.4d">M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = { start_ARRAY start_ROW start_CELL 1 , if over^ start_ARG M end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT &gt; italic_τ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL 0 , otherwise end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="A1.SS4.p1.5">Using relative threshold, we have:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\textbf{M}_{q}=\left\{\begin{array}[]{l}1,\textbf{if }\hat{\textbf{M}}_{q}&gt;%
\tau_{r}\max(\hat{\textbf{M}}_{q})\\
0,\textbf{otherwise}\end{array}\right." class="ltx_Math" display="block" id="A1.E12.m1.6"><semantics id="A1.E12.m1.6a"><mrow id="A1.E12.m1.6.7" xref="A1.E12.m1.6.7.cmml"><msub id="A1.E12.m1.6.7.2" xref="A1.E12.m1.6.7.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.6.7.2.2" xref="A1.E12.m1.6.7.2.2a.cmml">M</mtext><mi id="A1.E12.m1.6.7.2.3" xref="A1.E12.m1.6.7.2.3.cmml">q</mi></msub><mo id="A1.E12.m1.6.7.1" xref="A1.E12.m1.6.7.1.cmml">=</mo><mrow id="A1.E12.m1.6.7.3.2" xref="A1.E12.m1.6.7.3.1.cmml"><mo id="A1.E12.m1.6.7.3.2.1" xref="A1.E12.m1.6.7.3.1.1.cmml">{</mo><mtable displaystyle="true" id="A1.E12.m1.6.6" rowspacing="0pt" xref="A1.E12.m1.6.6.cmml"><mtr id="A1.E12.m1.6.6a" xref="A1.E12.m1.6.6.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E12.m1.6.6b" xref="A1.E12.m1.6.6.cmml"><mrow id="A1.E12.m1.4.4.4.4.4" xref="A1.E12.m1.4.4.4.4.4.cmml"><mrow id="A1.E12.m1.3.3.3.3.3.3.1" xref="A1.E12.m1.3.3.3.3.3.3.2.cmml"><mn id="A1.E12.m1.2.2.2.2.2.2" xref="A1.E12.m1.2.2.2.2.2.2.cmml">1</mn><mo id="A1.E12.m1.3.3.3.3.3.3.1.2" xref="A1.E12.m1.3.3.3.3.3.3.2.cmml">,</mo><mrow id="A1.E12.m1.3.3.3.3.3.3.1.1" xref="A1.E12.m1.3.3.3.3.3.3.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.3.3.3.3.3.3.1.1.2" xref="A1.E12.m1.3.3.3.3.3.3.1.1.2a.cmml">if </mtext><mo id="A1.E12.m1.3.3.3.3.3.3.1.1.1" xref="A1.E12.m1.3.3.3.3.3.3.1.1.1.cmml">⁢</mo><msub id="A1.E12.m1.3.3.3.3.3.3.1.1.3" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.cmml"><mover accent="true" id="A1.E12.m1.3.3.3.3.3.3.1.1.3.2" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.2" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.2a.cmml">M</mtext><mo id="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.1" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.1.cmml">^</mo></mover><mi id="A1.E12.m1.3.3.3.3.3.3.1.1.3.3" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.3.cmml">q</mi></msub></mrow></mrow><mo id="A1.E12.m1.4.4.4.4.4.5" xref="A1.E12.m1.4.4.4.4.4.5.cmml">&gt;</mo><mrow id="A1.E12.m1.4.4.4.4.4.4" xref="A1.E12.m1.4.4.4.4.4.4.cmml"><msub id="A1.E12.m1.4.4.4.4.4.4.3" xref="A1.E12.m1.4.4.4.4.4.4.3.cmml"><mi id="A1.E12.m1.4.4.4.4.4.4.3.2" xref="A1.E12.m1.4.4.4.4.4.4.3.2.cmml">τ</mi><mi id="A1.E12.m1.4.4.4.4.4.4.3.3" xref="A1.E12.m1.4.4.4.4.4.4.3.3.cmml">r</mi></msub><mo id="A1.E12.m1.4.4.4.4.4.4.2" lspace="0.167em" xref="A1.E12.m1.4.4.4.4.4.4.2.cmml">⁢</mo><mrow id="A1.E12.m1.4.4.4.4.4.4.1.1" xref="A1.E12.m1.4.4.4.4.4.4.1.2.cmml"><mi id="A1.E12.m1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml">max</mi><mo id="A1.E12.m1.4.4.4.4.4.4.1.1a" xref="A1.E12.m1.4.4.4.4.4.4.1.2.cmml">⁡</mo><mrow id="A1.E12.m1.4.4.4.4.4.4.1.1.1" xref="A1.E12.m1.4.4.4.4.4.4.1.2.cmml"><mo id="A1.E12.m1.4.4.4.4.4.4.1.1.1.2" stretchy="false" xref="A1.E12.m1.4.4.4.4.4.4.1.2.cmml">(</mo><msub id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.cmml"><mover accent="true" id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.cmml"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.2" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.2a.cmml">M</mtext><mo id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.1" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.1.cmml">^</mo></mover><mi id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.3" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.3.cmml">q</mi></msub><mo id="A1.E12.m1.4.4.4.4.4.4.1.1.1.3" stretchy="false" xref="A1.E12.m1.4.4.4.4.4.4.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="A1.E12.m1.6.6c" xref="A1.E12.m1.6.6.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E12.m1.6.6d" xref="A1.E12.m1.6.6.cmml"><mrow id="A1.E12.m1.6.6.6.2.2.4" xref="A1.E12.m1.6.6.6.2.2.3.cmml"><mn id="A1.E12.m1.5.5.5.1.1.1" xref="A1.E12.m1.5.5.5.1.1.1.cmml">0</mn><mo id="A1.E12.m1.6.6.6.2.2.4.1" xref="A1.E12.m1.6.6.6.2.2.3.cmml">,</mo><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.6.6.6.2.2.2" xref="A1.E12.m1.6.6.6.2.2.2a.cmml">otherwise</mtext></mrow></mtd></mtr></mtable><mi id="A1.E12.m1.6.7.3.2.2" xref="A1.E12.m1.6.7.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E12.m1.6b"><apply id="A1.E12.m1.6.7.cmml" xref="A1.E12.m1.6.7"><eq id="A1.E12.m1.6.7.1.cmml" xref="A1.E12.m1.6.7.1"></eq><apply id="A1.E12.m1.6.7.2.cmml" xref="A1.E12.m1.6.7.2"><csymbol cd="ambiguous" id="A1.E12.m1.6.7.2.1.cmml" xref="A1.E12.m1.6.7.2">subscript</csymbol><ci id="A1.E12.m1.6.7.2.2a.cmml" xref="A1.E12.m1.6.7.2.2"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.6.7.2.2.cmml" xref="A1.E12.m1.6.7.2.2">M</mtext></ci><ci id="A1.E12.m1.6.7.2.3.cmml" xref="A1.E12.m1.6.7.2.3">𝑞</ci></apply><apply id="A1.E12.m1.6.7.3.1.cmml" xref="A1.E12.m1.6.7.3.2"><csymbol cd="latexml" id="A1.E12.m1.6.7.3.1.1.cmml" xref="A1.E12.m1.6.7.3.2.1">cases</csymbol><matrix id="A1.E12.m1.6.6.cmml" xref="A1.E12.m1.6.6"><matrixrow id="A1.E12.m1.6.6a.cmml" xref="A1.E12.m1.6.6"><apply id="A1.E12.m1.4.4.4.4.4.cmml" xref="A1.E12.m1.4.4.4.4.4"><gt id="A1.E12.m1.4.4.4.4.4.5.cmml" xref="A1.E12.m1.4.4.4.4.4.5"></gt><list id="A1.E12.m1.3.3.3.3.3.3.2.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1"><cn id="A1.E12.m1.2.2.2.2.2.2.cmml" type="integer" xref="A1.E12.m1.2.2.2.2.2.2">1</cn><apply id="A1.E12.m1.3.3.3.3.3.3.1.1.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1"><times id="A1.E12.m1.3.3.3.3.3.3.1.1.1.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.1"></times><ci id="A1.E12.m1.3.3.3.3.3.3.1.1.2a.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.2"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.3.3.3.3.3.3.1.1.2.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.2">if </mtext></ci><apply id="A1.E12.m1.3.3.3.3.3.3.1.1.3.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="A1.E12.m1.3.3.3.3.3.3.1.1.3.1.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3">subscript</csymbol><apply id="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.2"><ci id="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.1.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.1">^</ci><ci id="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.2a.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.2"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.2.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.2.2">M</mtext></ci></apply><ci id="A1.E12.m1.3.3.3.3.3.3.1.1.3.3.cmml" xref="A1.E12.m1.3.3.3.3.3.3.1.1.3.3">𝑞</ci></apply></apply></list><apply id="A1.E12.m1.4.4.4.4.4.4.cmml" xref="A1.E12.m1.4.4.4.4.4.4"><times id="A1.E12.m1.4.4.4.4.4.4.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.2"></times><apply id="A1.E12.m1.4.4.4.4.4.4.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.3"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.3.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.3">subscript</csymbol><ci id="A1.E12.m1.4.4.4.4.4.4.3.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.3.2">𝜏</ci><ci id="A1.E12.m1.4.4.4.4.4.4.3.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.3.3">𝑟</ci></apply><apply id="A1.E12.m1.4.4.4.4.4.4.1.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1"><max id="A1.E12.m1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1"></max><apply id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1">subscript</csymbol><apply id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2"><ci id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.1.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.1">^</ci><ci id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.2a.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.2"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.2.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.2.2">M</mtext></ci></apply><ci id="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.3.cmml" xref="A1.E12.m1.4.4.4.4.4.4.1.1.1.1.3">𝑞</ci></apply></apply></apply></apply></matrixrow><matrixrow id="A1.E12.m1.6.6b.cmml" xref="A1.E12.m1.6.6"><list id="A1.E12.m1.6.6.6.2.2.3.cmml" xref="A1.E12.m1.6.6.6.2.2.4"><cn id="A1.E12.m1.5.5.5.1.1.1.cmml" type="integer" xref="A1.E12.m1.5.5.5.1.1.1">0</cn><ci id="A1.E12.m1.6.6.6.2.2.2a.cmml" xref="A1.E12.m1.6.6.6.2.2.2"><mtext class="ltx_mathvariant_bold" id="A1.E12.m1.6.6.6.2.2.2.cmml" xref="A1.E12.m1.6.6.6.2.2.2">otherwise</mtext></ci></list></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E12.m1.6c">\textbf{M}_{q}=\left\{\begin{array}[]{l}1,\textbf{if }\hat{\textbf{M}}_{q}&gt;%
\tau_{r}\max(\hat{\textbf{M}}_{q})\\
0,\textbf{otherwise}\end{array}\right.</annotation><annotation encoding="application/x-llamapun" id="A1.E12.m1.6d">M start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = { start_ARRAY start_ROW start_CELL 1 , if over^ start_ARG M end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT &gt; italic_τ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT roman_max ( over^ start_ARG M end_ARG start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ) end_CELL end_ROW start_ROW start_CELL 0 , otherwise end_CELL end_ROW end_ARRAY</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_table" id="A1.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T3.4.1.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text" id="A1.T3.5.2" style="font-size:90%;">Comparison of different thresholding methods</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T3.2">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T3.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T3.1.1.1"><math alttext="\tau_{r}" class="ltx_Math" display="inline" id="A1.T3.1.1.1.m1.1"><semantics id="A1.T3.1.1.1.m1.1a"><msub id="A1.T3.1.1.1.m1.1.1" xref="A1.T3.1.1.1.m1.1.1.cmml"><mi id="A1.T3.1.1.1.m1.1.1.2" xref="A1.T3.1.1.1.m1.1.1.2.cmml">τ</mi><mi id="A1.T3.1.1.1.m1.1.1.3" xref="A1.T3.1.1.1.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.m1.1b"><apply id="A1.T3.1.1.1.m1.1.1.cmml" xref="A1.T3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T3.1.1.1.m1.1.1.1.cmml" xref="A1.T3.1.1.1.m1.1.1">subscript</csymbol><ci id="A1.T3.1.1.1.m1.1.1.2.cmml" xref="A1.T3.1.1.1.m1.1.1.2">𝜏</ci><ci id="A1.T3.1.1.1.m1.1.1.3.cmml" xref="A1.T3.1.1.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.1.1.1.m1.1c">\tau_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.1.1.1.m1.1d">italic_τ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T3.1.1.2">0.2</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T3.1.1.3">0.25</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T3.1.1.4">0.3</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T3.1.1.5">0.35</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="A1.T3.1.1.6">0.4</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.3.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.3.1.1">mIoU</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.3.1.2">47.56</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.3.1.3">47.69</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.3.1.4">47.48</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.3.1.5">47.4</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.3.1.6">47.11</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.2.1"><math alttext="\tau_{a}" class="ltx_Math" display="inline" id="A1.T3.2.2.1.m1.1"><semantics id="A1.T3.2.2.1.m1.1a"><msub id="A1.T3.2.2.1.m1.1.1" xref="A1.T3.2.2.1.m1.1.1.cmml"><mi id="A1.T3.2.2.1.m1.1.1.2" xref="A1.T3.2.2.1.m1.1.1.2.cmml">τ</mi><mi id="A1.T3.2.2.1.m1.1.1.3" xref="A1.T3.2.2.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="A1.T3.2.2.1.m1.1b"><apply id="A1.T3.2.2.1.m1.1.1.cmml" xref="A1.T3.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.T3.2.2.1.m1.1.1.1.cmml" xref="A1.T3.2.2.1.m1.1.1">subscript</csymbol><ci id="A1.T3.2.2.1.m1.1.1.2.cmml" xref="A1.T3.2.2.1.m1.1.1.2">𝜏</ci><ci id="A1.T3.2.2.1.m1.1.1.3.cmml" xref="A1.T3.2.2.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.2.1.m1.1c">\tau_{a}</annotation><annotation encoding="application/x-llamapun" id="A1.T3.2.2.1.m1.1d">italic_τ start_POSTSUBSCRIPT italic_a end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.2.2">0.1</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.2.3">0.15</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.2.4">0.2</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.2.5">0.25</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T3.2.2.6">0.3</td>
</tr>
<tr class="ltx_tr" id="A1.T3.2.4.2">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T3.2.4.2.1">mIoU</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T3.2.4.2.2">46.64</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T3.2.4.2.3">47.21</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T3.2.4.2.4">46.91</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T3.2.4.2.5">46.53</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="A1.T3.2.4.2.6">46</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A1.SS4.p2">
<p class="ltx_p" id="A1.SS4.p2.2">Our experiments (see <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.T3" title="In A.4 Post processing ‣ Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">3</span></a>) have shown that the relative threshold method achieved better results on COCO-20<sup class="ltx_sup" id="A1.SS4.p2.2.1"><span class="ltx_text ltx_font_italic" id="A1.SS4.p2.2.1.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib43" title="">43</a>]</cite> fold0. The optimal <math alttext="\tau_{r}" class="ltx_Math" display="inline" id="A1.SS4.p2.2.m2.1"><semantics id="A1.SS4.p2.2.m2.1a"><msub id="A1.SS4.p2.2.m2.1.1" xref="A1.SS4.p2.2.m2.1.1.cmml"><mi id="A1.SS4.p2.2.m2.1.1.2" xref="A1.SS4.p2.2.m2.1.1.2.cmml">τ</mi><mi id="A1.SS4.p2.2.m2.1.1.3" xref="A1.SS4.p2.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS4.p2.2.m2.1b"><apply id="A1.SS4.p2.2.m2.1.1.cmml" xref="A1.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS4.p2.2.m2.1.1.1.cmml" xref="A1.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="A1.SS4.p2.2.m2.1.1.2.cmml" xref="A1.SS4.p2.2.m2.1.1.2">𝜏</ci><ci id="A1.SS4.p2.2.m2.1.1.3.cmml" xref="A1.SS4.p2.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS4.p2.2.m2.1c">\tau_{r}</annotation><annotation encoding="application/x-llamapun" id="A1.SS4.p2.2.m2.1d">italic_τ start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT</annotation></semantics></math> is 0.25.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.5 </span>More ablation studies</h3>
<div class="ltx_para" id="A1.SS5.p1">
<p class="ltx_p" id="A1.SS5.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS5.p1.1.1">Multiplication</span>
We found in the experiment that Multiplication can be directly applied to RGB images, and another choice is to apply it to the latent space.</p>
</div>
<figure class="ltx_table" id="A1.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T4.2.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="A1.T4.3.2" style="font-size:90%;">Comparison of different Multiplication methods</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T4.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T4.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T4.4.1.1.1">Multiplication</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T4.4.1.1.2">mIoU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T4.4.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.4.2.1.1">latent</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T4.4.2.1.2">32.14</td>
</tr>
<tr class="ltx_tr" id="A1.T4.4.3.2">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T4.4.3.2.1">RGB</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T4.4.3.2.2">33.12</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A1.SS5.p2">
<p class="ltx_p" id="A1.SS5.p2.1">As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.T4" title="Table 4 ‣ A.5 More ablation studies ‣ Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">4</span></a>, the Multiplication method directly applied to RGB images achieved better results. However, the overall disparity is not significant.</p>
</div>
<div class="ltx_para" id="A1.SS5.p3">
<p class="ltx_p" id="A1.SS5.p3.3"><span class="ltx_text ltx_font_bold" id="A1.SS5.p3.3.1">Self-Attention fusion</span>
In previous sections, we mentioned that we use a KV fusion strategy. An alternative is to use a QKV fusion strategy, in which we also concatenate <math alttext="\mathbf{Q}_{q}" class="ltx_Math" display="inline" id="A1.SS5.p3.1.m1.1"><semantics id="A1.SS5.p3.1.m1.1a"><msub id="A1.SS5.p3.1.m1.1.1" xref="A1.SS5.p3.1.m1.1.1.cmml"><mi id="A1.SS5.p3.1.m1.1.1.2" xref="A1.SS5.p3.1.m1.1.1.2.cmml">𝐐</mi><mi id="A1.SS5.p3.1.m1.1.1.3" xref="A1.SS5.p3.1.m1.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.p3.1.m1.1b"><apply id="A1.SS5.p3.1.m1.1.1.cmml" xref="A1.SS5.p3.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS5.p3.1.m1.1.1.1.cmml" xref="A1.SS5.p3.1.m1.1.1">subscript</csymbol><ci id="A1.SS5.p3.1.m1.1.1.2.cmml" xref="A1.SS5.p3.1.m1.1.1.2">𝐐</ci><ci id="A1.SS5.p3.1.m1.1.1.3.cmml" xref="A1.SS5.p3.1.m1.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p3.1.m1.1c">\mathbf{Q}_{q}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p3.1.m1.1d">bold_Q start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{Q}_{s}" class="ltx_Math" display="inline" id="A1.SS5.p3.2.m2.1"><semantics id="A1.SS5.p3.2.m2.1a"><msub id="A1.SS5.p3.2.m2.1.1" xref="A1.SS5.p3.2.m2.1.1.cmml"><mi id="A1.SS5.p3.2.m2.1.1.2" xref="A1.SS5.p3.2.m2.1.1.2.cmml">𝐐</mi><mi id="A1.SS5.p3.2.m2.1.1.3" xref="A1.SS5.p3.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS5.p3.2.m2.1b"><apply id="A1.SS5.p3.2.m2.1.1.cmml" xref="A1.SS5.p3.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS5.p3.2.m2.1.1.1.cmml" xref="A1.SS5.p3.2.m2.1.1">subscript</csymbol><ci id="A1.SS5.p3.2.m2.1.1.2.cmml" xref="A1.SS5.p3.2.m2.1.1.2">𝐐</ci><ci id="A1.SS5.p3.2.m2.1.1.3.cmml" xref="A1.SS5.p3.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p3.2.m2.1c">\mathbf{Q}_{s}</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p3.2.m2.1d">bold_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> to form <math alttext="\mathbf{Q}_{qs}=[\mathbf{Q}_{q},\mathbf{Q}_{s}]" class="ltx_Math" display="inline" id="A1.SS5.p3.3.m3.2"><semantics id="A1.SS5.p3.3.m3.2a"><mrow id="A1.SS5.p3.3.m3.2.2" xref="A1.SS5.p3.3.m3.2.2.cmml"><msub id="A1.SS5.p3.3.m3.2.2.4" xref="A1.SS5.p3.3.m3.2.2.4.cmml"><mi id="A1.SS5.p3.3.m3.2.2.4.2" xref="A1.SS5.p3.3.m3.2.2.4.2.cmml">𝐐</mi><mrow id="A1.SS5.p3.3.m3.2.2.4.3" xref="A1.SS5.p3.3.m3.2.2.4.3.cmml"><mi id="A1.SS5.p3.3.m3.2.2.4.3.2" xref="A1.SS5.p3.3.m3.2.2.4.3.2.cmml">q</mi><mo id="A1.SS5.p3.3.m3.2.2.4.3.1" xref="A1.SS5.p3.3.m3.2.2.4.3.1.cmml">⁢</mo><mi id="A1.SS5.p3.3.m3.2.2.4.3.3" xref="A1.SS5.p3.3.m3.2.2.4.3.3.cmml">s</mi></mrow></msub><mo id="A1.SS5.p3.3.m3.2.2.3" xref="A1.SS5.p3.3.m3.2.2.3.cmml">=</mo><mrow id="A1.SS5.p3.3.m3.2.2.2.2" xref="A1.SS5.p3.3.m3.2.2.2.3.cmml"><mo id="A1.SS5.p3.3.m3.2.2.2.2.3" stretchy="false" xref="A1.SS5.p3.3.m3.2.2.2.3.cmml">[</mo><msub id="A1.SS5.p3.3.m3.1.1.1.1.1" xref="A1.SS5.p3.3.m3.1.1.1.1.1.cmml"><mi id="A1.SS5.p3.3.m3.1.1.1.1.1.2" xref="A1.SS5.p3.3.m3.1.1.1.1.1.2.cmml">𝐐</mi><mi id="A1.SS5.p3.3.m3.1.1.1.1.1.3" xref="A1.SS5.p3.3.m3.1.1.1.1.1.3.cmml">q</mi></msub><mo id="A1.SS5.p3.3.m3.2.2.2.2.4" xref="A1.SS5.p3.3.m3.2.2.2.3.cmml">,</mo><msub id="A1.SS5.p3.3.m3.2.2.2.2.2" xref="A1.SS5.p3.3.m3.2.2.2.2.2.cmml"><mi id="A1.SS5.p3.3.m3.2.2.2.2.2.2" xref="A1.SS5.p3.3.m3.2.2.2.2.2.2.cmml">𝐐</mi><mi id="A1.SS5.p3.3.m3.2.2.2.2.2.3" xref="A1.SS5.p3.3.m3.2.2.2.2.2.3.cmml">s</mi></msub><mo id="A1.SS5.p3.3.m3.2.2.2.2.5" stretchy="false" xref="A1.SS5.p3.3.m3.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS5.p3.3.m3.2b"><apply id="A1.SS5.p3.3.m3.2.2.cmml" xref="A1.SS5.p3.3.m3.2.2"><eq id="A1.SS5.p3.3.m3.2.2.3.cmml" xref="A1.SS5.p3.3.m3.2.2.3"></eq><apply id="A1.SS5.p3.3.m3.2.2.4.cmml" xref="A1.SS5.p3.3.m3.2.2.4"><csymbol cd="ambiguous" id="A1.SS5.p3.3.m3.2.2.4.1.cmml" xref="A1.SS5.p3.3.m3.2.2.4">subscript</csymbol><ci id="A1.SS5.p3.3.m3.2.2.4.2.cmml" xref="A1.SS5.p3.3.m3.2.2.4.2">𝐐</ci><apply id="A1.SS5.p3.3.m3.2.2.4.3.cmml" xref="A1.SS5.p3.3.m3.2.2.4.3"><times id="A1.SS5.p3.3.m3.2.2.4.3.1.cmml" xref="A1.SS5.p3.3.m3.2.2.4.3.1"></times><ci id="A1.SS5.p3.3.m3.2.2.4.3.2.cmml" xref="A1.SS5.p3.3.m3.2.2.4.3.2">𝑞</ci><ci id="A1.SS5.p3.3.m3.2.2.4.3.3.cmml" xref="A1.SS5.p3.3.m3.2.2.4.3.3">𝑠</ci></apply></apply><interval closure="closed" id="A1.SS5.p3.3.m3.2.2.2.3.cmml" xref="A1.SS5.p3.3.m3.2.2.2.2"><apply id="A1.SS5.p3.3.m3.1.1.1.1.1.cmml" xref="A1.SS5.p3.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS5.p3.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS5.p3.3.m3.1.1.1.1.1">subscript</csymbol><ci id="A1.SS5.p3.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS5.p3.3.m3.1.1.1.1.1.2">𝐐</ci><ci id="A1.SS5.p3.3.m3.1.1.1.1.1.3.cmml" xref="A1.SS5.p3.3.m3.1.1.1.1.1.3">𝑞</ci></apply><apply id="A1.SS5.p3.3.m3.2.2.2.2.2.cmml" xref="A1.SS5.p3.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS5.p3.3.m3.2.2.2.2.2.1.cmml" xref="A1.SS5.p3.3.m3.2.2.2.2.2">subscript</csymbol><ci id="A1.SS5.p3.3.m3.2.2.2.2.2.2.cmml" xref="A1.SS5.p3.3.m3.2.2.2.2.2.2">𝐐</ci><ci id="A1.SS5.p3.3.m3.2.2.2.2.2.3.cmml" xref="A1.SS5.p3.3.m3.2.2.2.2.2.3">𝑠</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS5.p3.3.m3.2c">\mathbf{Q}_{qs}=[\mathbf{Q}_{q},\mathbf{Q}_{s}]</annotation><annotation encoding="application/x-llamapun" id="A1.SS5.p3.3.m3.2d">bold_Q start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT = [ bold_Q start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_Q start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="A1.SS5.p4">
<p class="ltx_p" id="A1.SS5.p4.1">This strategies means the support image can also access the query image information.</p>
</div>
<figure class="ltx_table" id="A1.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T5.2.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="A1.T5.3.2" style="font-size:90%;">Comparison of different Self-Attention fusion strategies</span></figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T5.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T5.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T5.4.1.1.1">strategy</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="A1.T5.4.1.1.2">mIoU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T5.4.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.4.2.1.1">KV fusion</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="A1.T5.4.2.1.2">46.64</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.3.2">
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T5.4.3.2.1">QKV fusion</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="A1.T5.4.3.2.2">46.61</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="A1.SS5.p5">
<p class="ltx_p" id="A1.SS5.p5.1">As shown in the <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.T5" title="In A.5 More ablation studies ‣ Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">5</span></a>, KV fusion is slightly better than QKV fusion, and KV fusion has lower computational complexity, which can effectively reduce memory usage and inference time. Therefore, we choose KV fusion as our default strategy.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.6 </span>1-shot to n-shot</h3>
<div class="ltx_para" id="A1.SS6.p1">
<p class="ltx_p" id="A1.SS6.p1.13">In the <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#S4.SS1" title="4.1 Interaction between query and support images ‣ 4 Method ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">4.1</span></a>, we introduced how to inject the information of the support image into the features of the query image using the KV Fusion Self-Attention method. In inference, our support set <math alttext="S" class="ltx_Math" display="inline" id="A1.SS6.p1.1.m1.1"><semantics id="A1.SS6.p1.1.m1.1a"><mi id="A1.SS6.p1.1.m1.1.1" xref="A1.SS6.p1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.1.m1.1b"><ci id="A1.SS6.p1.1.m1.1.1.cmml" xref="A1.SS6.p1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.1.m1.1d">italic_S</annotation></semantics></math> may contain more than one image, <math alttext="S=\{I_{s1},I_{s2},...,I_{sn}\}" class="ltx_Math" display="inline" id="A1.SS6.p1.2.m2.4"><semantics id="A1.SS6.p1.2.m2.4a"><mrow id="A1.SS6.p1.2.m2.4.4" xref="A1.SS6.p1.2.m2.4.4.cmml"><mi id="A1.SS6.p1.2.m2.4.4.5" xref="A1.SS6.p1.2.m2.4.4.5.cmml">S</mi><mo id="A1.SS6.p1.2.m2.4.4.4" xref="A1.SS6.p1.2.m2.4.4.4.cmml">=</mo><mrow id="A1.SS6.p1.2.m2.4.4.3.3" xref="A1.SS6.p1.2.m2.4.4.3.4.cmml"><mo id="A1.SS6.p1.2.m2.4.4.3.3.4" stretchy="false" xref="A1.SS6.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="A1.SS6.p1.2.m2.2.2.1.1.1" xref="A1.SS6.p1.2.m2.2.2.1.1.1.cmml"><mi id="A1.SS6.p1.2.m2.2.2.1.1.1.2" xref="A1.SS6.p1.2.m2.2.2.1.1.1.2.cmml">I</mi><mrow id="A1.SS6.p1.2.m2.2.2.1.1.1.3" xref="A1.SS6.p1.2.m2.2.2.1.1.1.3.cmml"><mi id="A1.SS6.p1.2.m2.2.2.1.1.1.3.2" xref="A1.SS6.p1.2.m2.2.2.1.1.1.3.2.cmml">s</mi><mo id="A1.SS6.p1.2.m2.2.2.1.1.1.3.1" xref="A1.SS6.p1.2.m2.2.2.1.1.1.3.1.cmml">⁢</mo><mn id="A1.SS6.p1.2.m2.2.2.1.1.1.3.3" xref="A1.SS6.p1.2.m2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS6.p1.2.m2.4.4.3.3.5" xref="A1.SS6.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="A1.SS6.p1.2.m2.3.3.2.2.2" xref="A1.SS6.p1.2.m2.3.3.2.2.2.cmml"><mi id="A1.SS6.p1.2.m2.3.3.2.2.2.2" xref="A1.SS6.p1.2.m2.3.3.2.2.2.2.cmml">I</mi><mrow id="A1.SS6.p1.2.m2.3.3.2.2.2.3" xref="A1.SS6.p1.2.m2.3.3.2.2.2.3.cmml"><mi id="A1.SS6.p1.2.m2.3.3.2.2.2.3.2" xref="A1.SS6.p1.2.m2.3.3.2.2.2.3.2.cmml">s</mi><mo id="A1.SS6.p1.2.m2.3.3.2.2.2.3.1" xref="A1.SS6.p1.2.m2.3.3.2.2.2.3.1.cmml">⁢</mo><mn id="A1.SS6.p1.2.m2.3.3.2.2.2.3.3" xref="A1.SS6.p1.2.m2.3.3.2.2.2.3.3.cmml">2</mn></mrow></msub><mo id="A1.SS6.p1.2.m2.4.4.3.3.6" xref="A1.SS6.p1.2.m2.4.4.3.4.cmml">,</mo><mi id="A1.SS6.p1.2.m2.1.1" mathvariant="normal" xref="A1.SS6.p1.2.m2.1.1.cmml">…</mi><mo id="A1.SS6.p1.2.m2.4.4.3.3.7" xref="A1.SS6.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="A1.SS6.p1.2.m2.4.4.3.3.3" xref="A1.SS6.p1.2.m2.4.4.3.3.3.cmml"><mi id="A1.SS6.p1.2.m2.4.4.3.3.3.2" xref="A1.SS6.p1.2.m2.4.4.3.3.3.2.cmml">I</mi><mrow id="A1.SS6.p1.2.m2.4.4.3.3.3.3" xref="A1.SS6.p1.2.m2.4.4.3.3.3.3.cmml"><mi id="A1.SS6.p1.2.m2.4.4.3.3.3.3.2" xref="A1.SS6.p1.2.m2.4.4.3.3.3.3.2.cmml">s</mi><mo id="A1.SS6.p1.2.m2.4.4.3.3.3.3.1" xref="A1.SS6.p1.2.m2.4.4.3.3.3.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.2.m2.4.4.3.3.3.3.3" xref="A1.SS6.p1.2.m2.4.4.3.3.3.3.3.cmml">n</mi></mrow></msub><mo id="A1.SS6.p1.2.m2.4.4.3.3.8" stretchy="false" xref="A1.SS6.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.2.m2.4b"><apply id="A1.SS6.p1.2.m2.4.4.cmml" xref="A1.SS6.p1.2.m2.4.4"><eq id="A1.SS6.p1.2.m2.4.4.4.cmml" xref="A1.SS6.p1.2.m2.4.4.4"></eq><ci id="A1.SS6.p1.2.m2.4.4.5.cmml" xref="A1.SS6.p1.2.m2.4.4.5">𝑆</ci><set id="A1.SS6.p1.2.m2.4.4.3.4.cmml" xref="A1.SS6.p1.2.m2.4.4.3.3"><apply id="A1.SS6.p1.2.m2.2.2.1.1.1.cmml" xref="A1.SS6.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.2.m2.2.2.1.1.1.1.cmml" xref="A1.SS6.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="A1.SS6.p1.2.m2.2.2.1.1.1.2.cmml" xref="A1.SS6.p1.2.m2.2.2.1.1.1.2">𝐼</ci><apply id="A1.SS6.p1.2.m2.2.2.1.1.1.3.cmml" xref="A1.SS6.p1.2.m2.2.2.1.1.1.3"><times id="A1.SS6.p1.2.m2.2.2.1.1.1.3.1.cmml" xref="A1.SS6.p1.2.m2.2.2.1.1.1.3.1"></times><ci id="A1.SS6.p1.2.m2.2.2.1.1.1.3.2.cmml" xref="A1.SS6.p1.2.m2.2.2.1.1.1.3.2">𝑠</ci><cn id="A1.SS6.p1.2.m2.2.2.1.1.1.3.3.cmml" type="integer" xref="A1.SS6.p1.2.m2.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="A1.SS6.p1.2.m2.3.3.2.2.2.cmml" xref="A1.SS6.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.SS6.p1.2.m2.3.3.2.2.2.1.cmml" xref="A1.SS6.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="A1.SS6.p1.2.m2.3.3.2.2.2.2.cmml" xref="A1.SS6.p1.2.m2.3.3.2.2.2.2">𝐼</ci><apply id="A1.SS6.p1.2.m2.3.3.2.2.2.3.cmml" xref="A1.SS6.p1.2.m2.3.3.2.2.2.3"><times id="A1.SS6.p1.2.m2.3.3.2.2.2.3.1.cmml" xref="A1.SS6.p1.2.m2.3.3.2.2.2.3.1"></times><ci id="A1.SS6.p1.2.m2.3.3.2.2.2.3.2.cmml" xref="A1.SS6.p1.2.m2.3.3.2.2.2.3.2">𝑠</ci><cn id="A1.SS6.p1.2.m2.3.3.2.2.2.3.3.cmml" type="integer" xref="A1.SS6.p1.2.m2.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="A1.SS6.p1.2.m2.1.1.cmml" xref="A1.SS6.p1.2.m2.1.1">…</ci><apply id="A1.SS6.p1.2.m2.4.4.3.3.3.cmml" xref="A1.SS6.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="A1.SS6.p1.2.m2.4.4.3.3.3.1.cmml" xref="A1.SS6.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="A1.SS6.p1.2.m2.4.4.3.3.3.2.cmml" xref="A1.SS6.p1.2.m2.4.4.3.3.3.2">𝐼</ci><apply id="A1.SS6.p1.2.m2.4.4.3.3.3.3.cmml" xref="A1.SS6.p1.2.m2.4.4.3.3.3.3"><times id="A1.SS6.p1.2.m2.4.4.3.3.3.3.1.cmml" xref="A1.SS6.p1.2.m2.4.4.3.3.3.3.1"></times><ci id="A1.SS6.p1.2.m2.4.4.3.3.3.3.2.cmml" xref="A1.SS6.p1.2.m2.4.4.3.3.3.3.2">𝑠</ci><ci id="A1.SS6.p1.2.m2.4.4.3.3.3.3.3.cmml" xref="A1.SS6.p1.2.m2.4.4.3.3.3.3.3">𝑛</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.2.m2.4c">S=\{I_{s1},I_{s2},...,I_{sn}\}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.2.m2.4d">italic_S = { italic_I start_POSTSUBSCRIPT italic_s 1 end_POSTSUBSCRIPT , italic_I start_POSTSUBSCRIPT italic_s 2 end_POSTSUBSCRIPT , … , italic_I start_POSTSUBSCRIPT italic_s italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>. We encode each image into the features <math alttext="\mathbf{X}_{si}" class="ltx_Math" display="inline" id="A1.SS6.p1.3.m3.1"><semantics id="A1.SS6.p1.3.m3.1a"><msub id="A1.SS6.p1.3.m3.1.1" xref="A1.SS6.p1.3.m3.1.1.cmml"><mi id="A1.SS6.p1.3.m3.1.1.2" xref="A1.SS6.p1.3.m3.1.1.2.cmml">𝐗</mi><mrow id="A1.SS6.p1.3.m3.1.1.3" xref="A1.SS6.p1.3.m3.1.1.3.cmml"><mi id="A1.SS6.p1.3.m3.1.1.3.2" xref="A1.SS6.p1.3.m3.1.1.3.2.cmml">s</mi><mo id="A1.SS6.p1.3.m3.1.1.3.1" xref="A1.SS6.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.3.m3.1.1.3.3" xref="A1.SS6.p1.3.m3.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.3.m3.1b"><apply id="A1.SS6.p1.3.m3.1.1.cmml" xref="A1.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.3.m3.1.1.1.cmml" xref="A1.SS6.p1.3.m3.1.1">subscript</csymbol><ci id="A1.SS6.p1.3.m3.1.1.2.cmml" xref="A1.SS6.p1.3.m3.1.1.2">𝐗</ci><apply id="A1.SS6.p1.3.m3.1.1.3.cmml" xref="A1.SS6.p1.3.m3.1.1.3"><times id="A1.SS6.p1.3.m3.1.1.3.1.cmml" xref="A1.SS6.p1.3.m3.1.1.3.1"></times><ci id="A1.SS6.p1.3.m3.1.1.3.2.cmml" xref="A1.SS6.p1.3.m3.1.1.3.2">𝑠</ci><ci id="A1.SS6.p1.3.m3.1.1.3.3.cmml" xref="A1.SS6.p1.3.m3.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.3.m3.1c">\mathbf{X}_{si}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.3.m3.1d">bold_X start_POSTSUBSCRIPT italic_s italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
Correspondingly, after mapping, we can obtain a series of <math alttext="\mathbf{Q}_{si}" class="ltx_Math" display="inline" id="A1.SS6.p1.4.m4.1"><semantics id="A1.SS6.p1.4.m4.1a"><msub id="A1.SS6.p1.4.m4.1.1" xref="A1.SS6.p1.4.m4.1.1.cmml"><mi id="A1.SS6.p1.4.m4.1.1.2" xref="A1.SS6.p1.4.m4.1.1.2.cmml">𝐐</mi><mrow id="A1.SS6.p1.4.m4.1.1.3" xref="A1.SS6.p1.4.m4.1.1.3.cmml"><mi id="A1.SS6.p1.4.m4.1.1.3.2" xref="A1.SS6.p1.4.m4.1.1.3.2.cmml">s</mi><mo id="A1.SS6.p1.4.m4.1.1.3.1" xref="A1.SS6.p1.4.m4.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.4.m4.1.1.3.3" xref="A1.SS6.p1.4.m4.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.4.m4.1b"><apply id="A1.SS6.p1.4.m4.1.1.cmml" xref="A1.SS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.4.m4.1.1.1.cmml" xref="A1.SS6.p1.4.m4.1.1">subscript</csymbol><ci id="A1.SS6.p1.4.m4.1.1.2.cmml" xref="A1.SS6.p1.4.m4.1.1.2">𝐐</ci><apply id="A1.SS6.p1.4.m4.1.1.3.cmml" xref="A1.SS6.p1.4.m4.1.1.3"><times id="A1.SS6.p1.4.m4.1.1.3.1.cmml" xref="A1.SS6.p1.4.m4.1.1.3.1"></times><ci id="A1.SS6.p1.4.m4.1.1.3.2.cmml" xref="A1.SS6.p1.4.m4.1.1.3.2">𝑠</ci><ci id="A1.SS6.p1.4.m4.1.1.3.3.cmml" xref="A1.SS6.p1.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.4.m4.1c">\mathbf{Q}_{si}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.4.m4.1d">bold_Q start_POSTSUBSCRIPT italic_s italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{K}_{si}" class="ltx_Math" display="inline" id="A1.SS6.p1.5.m5.1"><semantics id="A1.SS6.p1.5.m5.1a"><msub id="A1.SS6.p1.5.m5.1.1" xref="A1.SS6.p1.5.m5.1.1.cmml"><mi id="A1.SS6.p1.5.m5.1.1.2" xref="A1.SS6.p1.5.m5.1.1.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.5.m5.1.1.3" xref="A1.SS6.p1.5.m5.1.1.3.cmml"><mi id="A1.SS6.p1.5.m5.1.1.3.2" xref="A1.SS6.p1.5.m5.1.1.3.2.cmml">s</mi><mo id="A1.SS6.p1.5.m5.1.1.3.1" xref="A1.SS6.p1.5.m5.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.5.m5.1.1.3.3" xref="A1.SS6.p1.5.m5.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.5.m5.1b"><apply id="A1.SS6.p1.5.m5.1.1.cmml" xref="A1.SS6.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.5.m5.1.1.1.cmml" xref="A1.SS6.p1.5.m5.1.1">subscript</csymbol><ci id="A1.SS6.p1.5.m5.1.1.2.cmml" xref="A1.SS6.p1.5.m5.1.1.2">𝐊</ci><apply id="A1.SS6.p1.5.m5.1.1.3.cmml" xref="A1.SS6.p1.5.m5.1.1.3"><times id="A1.SS6.p1.5.m5.1.1.3.1.cmml" xref="A1.SS6.p1.5.m5.1.1.3.1"></times><ci id="A1.SS6.p1.5.m5.1.1.3.2.cmml" xref="A1.SS6.p1.5.m5.1.1.3.2">𝑠</ci><ci id="A1.SS6.p1.5.m5.1.1.3.3.cmml" xref="A1.SS6.p1.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.5.m5.1c">\mathbf{K}_{si}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.5.m5.1d">bold_K start_POSTSUBSCRIPT italic_s italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{V}_{si}" class="ltx_Math" display="inline" id="A1.SS6.p1.6.m6.1"><semantics id="A1.SS6.p1.6.m6.1a"><msub id="A1.SS6.p1.6.m6.1.1" xref="A1.SS6.p1.6.m6.1.1.cmml"><mi id="A1.SS6.p1.6.m6.1.1.2" xref="A1.SS6.p1.6.m6.1.1.2.cmml">𝐕</mi><mrow id="A1.SS6.p1.6.m6.1.1.3" xref="A1.SS6.p1.6.m6.1.1.3.cmml"><mi id="A1.SS6.p1.6.m6.1.1.3.2" xref="A1.SS6.p1.6.m6.1.1.3.2.cmml">s</mi><mo id="A1.SS6.p1.6.m6.1.1.3.1" xref="A1.SS6.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.6.m6.1.1.3.3" xref="A1.SS6.p1.6.m6.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.6.m6.1b"><apply id="A1.SS6.p1.6.m6.1.1.cmml" xref="A1.SS6.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.6.m6.1.1.1.cmml" xref="A1.SS6.p1.6.m6.1.1">subscript</csymbol><ci id="A1.SS6.p1.6.m6.1.1.2.cmml" xref="A1.SS6.p1.6.m6.1.1.2">𝐕</ci><apply id="A1.SS6.p1.6.m6.1.1.3.cmml" xref="A1.SS6.p1.6.m6.1.1.3"><times id="A1.SS6.p1.6.m6.1.1.3.1.cmml" xref="A1.SS6.p1.6.m6.1.1.3.1"></times><ci id="A1.SS6.p1.6.m6.1.1.3.2.cmml" xref="A1.SS6.p1.6.m6.1.1.3.2">𝑠</ci><ci id="A1.SS6.p1.6.m6.1.1.3.3.cmml" xref="A1.SS6.p1.6.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.6.m6.1c">\mathbf{V}_{si}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.6.m6.1d">bold_V start_POSTSUBSCRIPT italic_s italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{Q}_{qi}" class="ltx_Math" display="inline" id="A1.SS6.p1.7.m7.1"><semantics id="A1.SS6.p1.7.m7.1a"><msub id="A1.SS6.p1.7.m7.1.1" xref="A1.SS6.p1.7.m7.1.1.cmml"><mi id="A1.SS6.p1.7.m7.1.1.2" xref="A1.SS6.p1.7.m7.1.1.2.cmml">𝐐</mi><mrow id="A1.SS6.p1.7.m7.1.1.3" xref="A1.SS6.p1.7.m7.1.1.3.cmml"><mi id="A1.SS6.p1.7.m7.1.1.3.2" xref="A1.SS6.p1.7.m7.1.1.3.2.cmml">q</mi><mo id="A1.SS6.p1.7.m7.1.1.3.1" xref="A1.SS6.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.7.m7.1.1.3.3" xref="A1.SS6.p1.7.m7.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.7.m7.1b"><apply id="A1.SS6.p1.7.m7.1.1.cmml" xref="A1.SS6.p1.7.m7.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.7.m7.1.1.1.cmml" xref="A1.SS6.p1.7.m7.1.1">subscript</csymbol><ci id="A1.SS6.p1.7.m7.1.1.2.cmml" xref="A1.SS6.p1.7.m7.1.1.2">𝐐</ci><apply id="A1.SS6.p1.7.m7.1.1.3.cmml" xref="A1.SS6.p1.7.m7.1.1.3"><times id="A1.SS6.p1.7.m7.1.1.3.1.cmml" xref="A1.SS6.p1.7.m7.1.1.3.1"></times><ci id="A1.SS6.p1.7.m7.1.1.3.2.cmml" xref="A1.SS6.p1.7.m7.1.1.3.2">𝑞</ci><ci id="A1.SS6.p1.7.m7.1.1.3.3.cmml" xref="A1.SS6.p1.7.m7.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.7.m7.1c">\mathbf{Q}_{qi}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.7.m7.1d">bold_Q start_POSTSUBSCRIPT italic_q italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{K}_{qi}" class="ltx_Math" display="inline" id="A1.SS6.p1.8.m8.1"><semantics id="A1.SS6.p1.8.m8.1a"><msub id="A1.SS6.p1.8.m8.1.1" xref="A1.SS6.p1.8.m8.1.1.cmml"><mi id="A1.SS6.p1.8.m8.1.1.2" xref="A1.SS6.p1.8.m8.1.1.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.8.m8.1.1.3" xref="A1.SS6.p1.8.m8.1.1.3.cmml"><mi id="A1.SS6.p1.8.m8.1.1.3.2" xref="A1.SS6.p1.8.m8.1.1.3.2.cmml">q</mi><mo id="A1.SS6.p1.8.m8.1.1.3.1" xref="A1.SS6.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.8.m8.1.1.3.3" xref="A1.SS6.p1.8.m8.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.8.m8.1b"><apply id="A1.SS6.p1.8.m8.1.1.cmml" xref="A1.SS6.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.8.m8.1.1.1.cmml" xref="A1.SS6.p1.8.m8.1.1">subscript</csymbol><ci id="A1.SS6.p1.8.m8.1.1.2.cmml" xref="A1.SS6.p1.8.m8.1.1.2">𝐊</ci><apply id="A1.SS6.p1.8.m8.1.1.3.cmml" xref="A1.SS6.p1.8.m8.1.1.3"><times id="A1.SS6.p1.8.m8.1.1.3.1.cmml" xref="A1.SS6.p1.8.m8.1.1.3.1"></times><ci id="A1.SS6.p1.8.m8.1.1.3.2.cmml" xref="A1.SS6.p1.8.m8.1.1.3.2">𝑞</ci><ci id="A1.SS6.p1.8.m8.1.1.3.3.cmml" xref="A1.SS6.p1.8.m8.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.8.m8.1c">\mathbf{K}_{qi}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.8.m8.1d">bold_K start_POSTSUBSCRIPT italic_q italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\mathbf{V}_{qi}" class="ltx_Math" display="inline" id="A1.SS6.p1.9.m9.1"><semantics id="A1.SS6.p1.9.m9.1a"><msub id="A1.SS6.p1.9.m9.1.1" xref="A1.SS6.p1.9.m9.1.1.cmml"><mi id="A1.SS6.p1.9.m9.1.1.2" xref="A1.SS6.p1.9.m9.1.1.2.cmml">𝐕</mi><mrow id="A1.SS6.p1.9.m9.1.1.3" xref="A1.SS6.p1.9.m9.1.1.3.cmml"><mi id="A1.SS6.p1.9.m9.1.1.3.2" xref="A1.SS6.p1.9.m9.1.1.3.2.cmml">q</mi><mo id="A1.SS6.p1.9.m9.1.1.3.1" xref="A1.SS6.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.9.m9.1.1.3.3" xref="A1.SS6.p1.9.m9.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.9.m9.1b"><apply id="A1.SS6.p1.9.m9.1.1.cmml" xref="A1.SS6.p1.9.m9.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.9.m9.1.1.1.cmml" xref="A1.SS6.p1.9.m9.1.1">subscript</csymbol><ci id="A1.SS6.p1.9.m9.1.1.2.cmml" xref="A1.SS6.p1.9.m9.1.1.2">𝐕</ci><apply id="A1.SS6.p1.9.m9.1.1.3.cmml" xref="A1.SS6.p1.9.m9.1.1.3"><times id="A1.SS6.p1.9.m9.1.1.3.1.cmml" xref="A1.SS6.p1.9.m9.1.1.3.1"></times><ci id="A1.SS6.p1.9.m9.1.1.3.2.cmml" xref="A1.SS6.p1.9.m9.1.1.3.2">𝑞</ci><ci id="A1.SS6.p1.9.m9.1.1.3.3.cmml" xref="A1.SS6.p1.9.m9.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.9.m9.1c">\mathbf{V}_{qi}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.9.m9.1d">bold_V start_POSTSUBSCRIPT italic_q italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. We can concatenate <math alttext="\mathbf{K}_{qi}" class="ltx_Math" display="inline" id="A1.SS6.p1.10.m10.1"><semantics id="A1.SS6.p1.10.m10.1a"><msub id="A1.SS6.p1.10.m10.1.1" xref="A1.SS6.p1.10.m10.1.1.cmml"><mi id="A1.SS6.p1.10.m10.1.1.2" xref="A1.SS6.p1.10.m10.1.1.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.10.m10.1.1.3" xref="A1.SS6.p1.10.m10.1.1.3.cmml"><mi id="A1.SS6.p1.10.m10.1.1.3.2" xref="A1.SS6.p1.10.m10.1.1.3.2.cmml">q</mi><mo id="A1.SS6.p1.10.m10.1.1.3.1" xref="A1.SS6.p1.10.m10.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.10.m10.1.1.3.3" xref="A1.SS6.p1.10.m10.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.10.m10.1b"><apply id="A1.SS6.p1.10.m10.1.1.cmml" xref="A1.SS6.p1.10.m10.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.10.m10.1.1.1.cmml" xref="A1.SS6.p1.10.m10.1.1">subscript</csymbol><ci id="A1.SS6.p1.10.m10.1.1.2.cmml" xref="A1.SS6.p1.10.m10.1.1.2">𝐊</ci><apply id="A1.SS6.p1.10.m10.1.1.3.cmml" xref="A1.SS6.p1.10.m10.1.1.3"><times id="A1.SS6.p1.10.m10.1.1.3.1.cmml" xref="A1.SS6.p1.10.m10.1.1.3.1"></times><ci id="A1.SS6.p1.10.m10.1.1.3.2.cmml" xref="A1.SS6.p1.10.m10.1.1.3.2">𝑞</ci><ci id="A1.SS6.p1.10.m10.1.1.3.3.cmml" xref="A1.SS6.p1.10.m10.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.10.m10.1c">\mathbf{K}_{qi}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.10.m10.1d">bold_K start_POSTSUBSCRIPT italic_q italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{K}_{si}" class="ltx_Math" display="inline" id="A1.SS6.p1.11.m11.1"><semantics id="A1.SS6.p1.11.m11.1a"><msub id="A1.SS6.p1.11.m11.1.1" xref="A1.SS6.p1.11.m11.1.1.cmml"><mi id="A1.SS6.p1.11.m11.1.1.2" xref="A1.SS6.p1.11.m11.1.1.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.11.m11.1.1.3" xref="A1.SS6.p1.11.m11.1.1.3.cmml"><mi id="A1.SS6.p1.11.m11.1.1.3.2" xref="A1.SS6.p1.11.m11.1.1.3.2.cmml">s</mi><mo id="A1.SS6.p1.11.m11.1.1.3.1" xref="A1.SS6.p1.11.m11.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.11.m11.1.1.3.3" xref="A1.SS6.p1.11.m11.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.11.m11.1b"><apply id="A1.SS6.p1.11.m11.1.1.cmml" xref="A1.SS6.p1.11.m11.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.11.m11.1.1.1.cmml" xref="A1.SS6.p1.11.m11.1.1">subscript</csymbol><ci id="A1.SS6.p1.11.m11.1.1.2.cmml" xref="A1.SS6.p1.11.m11.1.1.2">𝐊</ci><apply id="A1.SS6.p1.11.m11.1.1.3.cmml" xref="A1.SS6.p1.11.m11.1.1.3"><times id="A1.SS6.p1.11.m11.1.1.3.1.cmml" xref="A1.SS6.p1.11.m11.1.1.3.1"></times><ci id="A1.SS6.p1.11.m11.1.1.3.2.cmml" xref="A1.SS6.p1.11.m11.1.1.3.2">𝑠</ci><ci id="A1.SS6.p1.11.m11.1.1.3.3.cmml" xref="A1.SS6.p1.11.m11.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.11.m11.1c">\mathbf{K}_{si}</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.11.m11.1d">bold_K start_POSTSUBSCRIPT italic_s italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to form <math alttext="\mathbf{K}_{qs}=[\mathbf{K}_{qi},\mathbf{K}_{s1},\mathbf{K}_{s2},...,\mathbf{K%
}_{sn}]" class="ltx_Math" display="inline" id="A1.SS6.p1.12.m12.5"><semantics id="A1.SS6.p1.12.m12.5a"><mrow id="A1.SS6.p1.12.m12.5.5" xref="A1.SS6.p1.12.m12.5.5.cmml"><msub id="A1.SS6.p1.12.m12.5.5.6" xref="A1.SS6.p1.12.m12.5.5.6.cmml"><mi id="A1.SS6.p1.12.m12.5.5.6.2" xref="A1.SS6.p1.12.m12.5.5.6.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.12.m12.5.5.6.3" xref="A1.SS6.p1.12.m12.5.5.6.3.cmml"><mi id="A1.SS6.p1.12.m12.5.5.6.3.2" xref="A1.SS6.p1.12.m12.5.5.6.3.2.cmml">q</mi><mo id="A1.SS6.p1.12.m12.5.5.6.3.1" xref="A1.SS6.p1.12.m12.5.5.6.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.12.m12.5.5.6.3.3" xref="A1.SS6.p1.12.m12.5.5.6.3.3.cmml">s</mi></mrow></msub><mo id="A1.SS6.p1.12.m12.5.5.5" xref="A1.SS6.p1.12.m12.5.5.5.cmml">=</mo><mrow id="A1.SS6.p1.12.m12.5.5.4.4" xref="A1.SS6.p1.12.m12.5.5.4.5.cmml"><mo id="A1.SS6.p1.12.m12.5.5.4.4.5" stretchy="false" xref="A1.SS6.p1.12.m12.5.5.4.5.cmml">[</mo><msub id="A1.SS6.p1.12.m12.2.2.1.1.1" xref="A1.SS6.p1.12.m12.2.2.1.1.1.cmml"><mi id="A1.SS6.p1.12.m12.2.2.1.1.1.2" xref="A1.SS6.p1.12.m12.2.2.1.1.1.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.12.m12.2.2.1.1.1.3" xref="A1.SS6.p1.12.m12.2.2.1.1.1.3.cmml"><mi id="A1.SS6.p1.12.m12.2.2.1.1.1.3.2" xref="A1.SS6.p1.12.m12.2.2.1.1.1.3.2.cmml">q</mi><mo id="A1.SS6.p1.12.m12.2.2.1.1.1.3.1" xref="A1.SS6.p1.12.m12.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.12.m12.2.2.1.1.1.3.3" xref="A1.SS6.p1.12.m12.2.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.SS6.p1.12.m12.5.5.4.4.6" xref="A1.SS6.p1.12.m12.5.5.4.5.cmml">,</mo><msub id="A1.SS6.p1.12.m12.3.3.2.2.2" xref="A1.SS6.p1.12.m12.3.3.2.2.2.cmml"><mi id="A1.SS6.p1.12.m12.3.3.2.2.2.2" xref="A1.SS6.p1.12.m12.3.3.2.2.2.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.12.m12.3.3.2.2.2.3" xref="A1.SS6.p1.12.m12.3.3.2.2.2.3.cmml"><mi id="A1.SS6.p1.12.m12.3.3.2.2.2.3.2" xref="A1.SS6.p1.12.m12.3.3.2.2.2.3.2.cmml">s</mi><mo id="A1.SS6.p1.12.m12.3.3.2.2.2.3.1" xref="A1.SS6.p1.12.m12.3.3.2.2.2.3.1.cmml">⁢</mo><mn id="A1.SS6.p1.12.m12.3.3.2.2.2.3.3" xref="A1.SS6.p1.12.m12.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS6.p1.12.m12.5.5.4.4.7" xref="A1.SS6.p1.12.m12.5.5.4.5.cmml">,</mo><msub id="A1.SS6.p1.12.m12.4.4.3.3.3" xref="A1.SS6.p1.12.m12.4.4.3.3.3.cmml"><mi id="A1.SS6.p1.12.m12.4.4.3.3.3.2" xref="A1.SS6.p1.12.m12.4.4.3.3.3.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.12.m12.4.4.3.3.3.3" xref="A1.SS6.p1.12.m12.4.4.3.3.3.3.cmml"><mi id="A1.SS6.p1.12.m12.4.4.3.3.3.3.2" xref="A1.SS6.p1.12.m12.4.4.3.3.3.3.2.cmml">s</mi><mo id="A1.SS6.p1.12.m12.4.4.3.3.3.3.1" xref="A1.SS6.p1.12.m12.4.4.3.3.3.3.1.cmml">⁢</mo><mn id="A1.SS6.p1.12.m12.4.4.3.3.3.3.3" xref="A1.SS6.p1.12.m12.4.4.3.3.3.3.3.cmml">2</mn></mrow></msub><mo id="A1.SS6.p1.12.m12.5.5.4.4.8" xref="A1.SS6.p1.12.m12.5.5.4.5.cmml">,</mo><mi id="A1.SS6.p1.12.m12.1.1" mathvariant="normal" xref="A1.SS6.p1.12.m12.1.1.cmml">…</mi><mo id="A1.SS6.p1.12.m12.5.5.4.4.9" xref="A1.SS6.p1.12.m12.5.5.4.5.cmml">,</mo><msub id="A1.SS6.p1.12.m12.5.5.4.4.4" xref="A1.SS6.p1.12.m12.5.5.4.4.4.cmml"><mi id="A1.SS6.p1.12.m12.5.5.4.4.4.2" xref="A1.SS6.p1.12.m12.5.5.4.4.4.2.cmml">𝐊</mi><mrow id="A1.SS6.p1.12.m12.5.5.4.4.4.3" xref="A1.SS6.p1.12.m12.5.5.4.4.4.3.cmml"><mi id="A1.SS6.p1.12.m12.5.5.4.4.4.3.2" xref="A1.SS6.p1.12.m12.5.5.4.4.4.3.2.cmml">s</mi><mo id="A1.SS6.p1.12.m12.5.5.4.4.4.3.1" xref="A1.SS6.p1.12.m12.5.5.4.4.4.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.12.m12.5.5.4.4.4.3.3" xref="A1.SS6.p1.12.m12.5.5.4.4.4.3.3.cmml">n</mi></mrow></msub><mo id="A1.SS6.p1.12.m12.5.5.4.4.10" stretchy="false" xref="A1.SS6.p1.12.m12.5.5.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.12.m12.5b"><apply id="A1.SS6.p1.12.m12.5.5.cmml" xref="A1.SS6.p1.12.m12.5.5"><eq id="A1.SS6.p1.12.m12.5.5.5.cmml" xref="A1.SS6.p1.12.m12.5.5.5"></eq><apply id="A1.SS6.p1.12.m12.5.5.6.cmml" xref="A1.SS6.p1.12.m12.5.5.6"><csymbol cd="ambiguous" id="A1.SS6.p1.12.m12.5.5.6.1.cmml" xref="A1.SS6.p1.12.m12.5.5.6">subscript</csymbol><ci id="A1.SS6.p1.12.m12.5.5.6.2.cmml" xref="A1.SS6.p1.12.m12.5.5.6.2">𝐊</ci><apply id="A1.SS6.p1.12.m12.5.5.6.3.cmml" xref="A1.SS6.p1.12.m12.5.5.6.3"><times id="A1.SS6.p1.12.m12.5.5.6.3.1.cmml" xref="A1.SS6.p1.12.m12.5.5.6.3.1"></times><ci id="A1.SS6.p1.12.m12.5.5.6.3.2.cmml" xref="A1.SS6.p1.12.m12.5.5.6.3.2">𝑞</ci><ci id="A1.SS6.p1.12.m12.5.5.6.3.3.cmml" xref="A1.SS6.p1.12.m12.5.5.6.3.3">𝑠</ci></apply></apply><list id="A1.SS6.p1.12.m12.5.5.4.5.cmml" xref="A1.SS6.p1.12.m12.5.5.4.4"><apply id="A1.SS6.p1.12.m12.2.2.1.1.1.cmml" xref="A1.SS6.p1.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.12.m12.2.2.1.1.1.1.cmml" xref="A1.SS6.p1.12.m12.2.2.1.1.1">subscript</csymbol><ci id="A1.SS6.p1.12.m12.2.2.1.1.1.2.cmml" xref="A1.SS6.p1.12.m12.2.2.1.1.1.2">𝐊</ci><apply id="A1.SS6.p1.12.m12.2.2.1.1.1.3.cmml" xref="A1.SS6.p1.12.m12.2.2.1.1.1.3"><times id="A1.SS6.p1.12.m12.2.2.1.1.1.3.1.cmml" xref="A1.SS6.p1.12.m12.2.2.1.1.1.3.1"></times><ci id="A1.SS6.p1.12.m12.2.2.1.1.1.3.2.cmml" xref="A1.SS6.p1.12.m12.2.2.1.1.1.3.2">𝑞</ci><ci id="A1.SS6.p1.12.m12.2.2.1.1.1.3.3.cmml" xref="A1.SS6.p1.12.m12.2.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A1.SS6.p1.12.m12.3.3.2.2.2.cmml" xref="A1.SS6.p1.12.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.SS6.p1.12.m12.3.3.2.2.2.1.cmml" xref="A1.SS6.p1.12.m12.3.3.2.2.2">subscript</csymbol><ci id="A1.SS6.p1.12.m12.3.3.2.2.2.2.cmml" xref="A1.SS6.p1.12.m12.3.3.2.2.2.2">𝐊</ci><apply id="A1.SS6.p1.12.m12.3.3.2.2.2.3.cmml" xref="A1.SS6.p1.12.m12.3.3.2.2.2.3"><times id="A1.SS6.p1.12.m12.3.3.2.2.2.3.1.cmml" xref="A1.SS6.p1.12.m12.3.3.2.2.2.3.1"></times><ci id="A1.SS6.p1.12.m12.3.3.2.2.2.3.2.cmml" xref="A1.SS6.p1.12.m12.3.3.2.2.2.3.2">𝑠</ci><cn id="A1.SS6.p1.12.m12.3.3.2.2.2.3.3.cmml" type="integer" xref="A1.SS6.p1.12.m12.3.3.2.2.2.3.3">1</cn></apply></apply><apply id="A1.SS6.p1.12.m12.4.4.3.3.3.cmml" xref="A1.SS6.p1.12.m12.4.4.3.3.3"><csymbol cd="ambiguous" id="A1.SS6.p1.12.m12.4.4.3.3.3.1.cmml" xref="A1.SS6.p1.12.m12.4.4.3.3.3">subscript</csymbol><ci id="A1.SS6.p1.12.m12.4.4.3.3.3.2.cmml" xref="A1.SS6.p1.12.m12.4.4.3.3.3.2">𝐊</ci><apply id="A1.SS6.p1.12.m12.4.4.3.3.3.3.cmml" xref="A1.SS6.p1.12.m12.4.4.3.3.3.3"><times id="A1.SS6.p1.12.m12.4.4.3.3.3.3.1.cmml" xref="A1.SS6.p1.12.m12.4.4.3.3.3.3.1"></times><ci id="A1.SS6.p1.12.m12.4.4.3.3.3.3.2.cmml" xref="A1.SS6.p1.12.m12.4.4.3.3.3.3.2">𝑠</ci><cn id="A1.SS6.p1.12.m12.4.4.3.3.3.3.3.cmml" type="integer" xref="A1.SS6.p1.12.m12.4.4.3.3.3.3.3">2</cn></apply></apply><ci id="A1.SS6.p1.12.m12.1.1.cmml" xref="A1.SS6.p1.12.m12.1.1">…</ci><apply id="A1.SS6.p1.12.m12.5.5.4.4.4.cmml" xref="A1.SS6.p1.12.m12.5.5.4.4.4"><csymbol cd="ambiguous" id="A1.SS6.p1.12.m12.5.5.4.4.4.1.cmml" xref="A1.SS6.p1.12.m12.5.5.4.4.4">subscript</csymbol><ci id="A1.SS6.p1.12.m12.5.5.4.4.4.2.cmml" xref="A1.SS6.p1.12.m12.5.5.4.4.4.2">𝐊</ci><apply id="A1.SS6.p1.12.m12.5.5.4.4.4.3.cmml" xref="A1.SS6.p1.12.m12.5.5.4.4.4.3"><times id="A1.SS6.p1.12.m12.5.5.4.4.4.3.1.cmml" xref="A1.SS6.p1.12.m12.5.5.4.4.4.3.1"></times><ci id="A1.SS6.p1.12.m12.5.5.4.4.4.3.2.cmml" xref="A1.SS6.p1.12.m12.5.5.4.4.4.3.2">𝑠</ci><ci id="A1.SS6.p1.12.m12.5.5.4.4.4.3.3.cmml" xref="A1.SS6.p1.12.m12.5.5.4.4.4.3.3">𝑛</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.12.m12.5c">\mathbf{K}_{qs}=[\mathbf{K}_{qi},\mathbf{K}_{s1},\mathbf{K}_{s2},...,\mathbf{K%
}_{sn}]</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.12.m12.5d">bold_K start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT = [ bold_K start_POSTSUBSCRIPT italic_q italic_i end_POSTSUBSCRIPT , bold_K start_POSTSUBSCRIPT italic_s 1 end_POSTSUBSCRIPT , bold_K start_POSTSUBSCRIPT italic_s 2 end_POSTSUBSCRIPT , … , bold_K start_POSTSUBSCRIPT italic_s italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math>, and similarly we can obtain <math alttext="\mathbf{V}_{qs}=[\mathbf{V}_{qi},\mathbf{V}_{s1},\mathbf{V}_{s2},...,\mathbf{V%
}_{sn}]" class="ltx_Math" display="inline" id="A1.SS6.p1.13.m13.5"><semantics id="A1.SS6.p1.13.m13.5a"><mrow id="A1.SS6.p1.13.m13.5.5" xref="A1.SS6.p1.13.m13.5.5.cmml"><msub id="A1.SS6.p1.13.m13.5.5.6" xref="A1.SS6.p1.13.m13.5.5.6.cmml"><mi id="A1.SS6.p1.13.m13.5.5.6.2" xref="A1.SS6.p1.13.m13.5.5.6.2.cmml">𝐕</mi><mrow id="A1.SS6.p1.13.m13.5.5.6.3" xref="A1.SS6.p1.13.m13.5.5.6.3.cmml"><mi id="A1.SS6.p1.13.m13.5.5.6.3.2" xref="A1.SS6.p1.13.m13.5.5.6.3.2.cmml">q</mi><mo id="A1.SS6.p1.13.m13.5.5.6.3.1" xref="A1.SS6.p1.13.m13.5.5.6.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.13.m13.5.5.6.3.3" xref="A1.SS6.p1.13.m13.5.5.6.3.3.cmml">s</mi></mrow></msub><mo id="A1.SS6.p1.13.m13.5.5.5" xref="A1.SS6.p1.13.m13.5.5.5.cmml">=</mo><mrow id="A1.SS6.p1.13.m13.5.5.4.4" xref="A1.SS6.p1.13.m13.5.5.4.5.cmml"><mo id="A1.SS6.p1.13.m13.5.5.4.4.5" stretchy="false" xref="A1.SS6.p1.13.m13.5.5.4.5.cmml">[</mo><msub id="A1.SS6.p1.13.m13.2.2.1.1.1" xref="A1.SS6.p1.13.m13.2.2.1.1.1.cmml"><mi id="A1.SS6.p1.13.m13.2.2.1.1.1.2" xref="A1.SS6.p1.13.m13.2.2.1.1.1.2.cmml">𝐕</mi><mrow id="A1.SS6.p1.13.m13.2.2.1.1.1.3" xref="A1.SS6.p1.13.m13.2.2.1.1.1.3.cmml"><mi id="A1.SS6.p1.13.m13.2.2.1.1.1.3.2" xref="A1.SS6.p1.13.m13.2.2.1.1.1.3.2.cmml">q</mi><mo id="A1.SS6.p1.13.m13.2.2.1.1.1.3.1" xref="A1.SS6.p1.13.m13.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.13.m13.2.2.1.1.1.3.3" xref="A1.SS6.p1.13.m13.2.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.SS6.p1.13.m13.5.5.4.4.6" xref="A1.SS6.p1.13.m13.5.5.4.5.cmml">,</mo><msub id="A1.SS6.p1.13.m13.3.3.2.2.2" xref="A1.SS6.p1.13.m13.3.3.2.2.2.cmml"><mi id="A1.SS6.p1.13.m13.3.3.2.2.2.2" xref="A1.SS6.p1.13.m13.3.3.2.2.2.2.cmml">𝐕</mi><mrow id="A1.SS6.p1.13.m13.3.3.2.2.2.3" xref="A1.SS6.p1.13.m13.3.3.2.2.2.3.cmml"><mi id="A1.SS6.p1.13.m13.3.3.2.2.2.3.2" xref="A1.SS6.p1.13.m13.3.3.2.2.2.3.2.cmml">s</mi><mo id="A1.SS6.p1.13.m13.3.3.2.2.2.3.1" xref="A1.SS6.p1.13.m13.3.3.2.2.2.3.1.cmml">⁢</mo><mn id="A1.SS6.p1.13.m13.3.3.2.2.2.3.3" xref="A1.SS6.p1.13.m13.3.3.2.2.2.3.3.cmml">1</mn></mrow></msub><mo id="A1.SS6.p1.13.m13.5.5.4.4.7" xref="A1.SS6.p1.13.m13.5.5.4.5.cmml">,</mo><msub id="A1.SS6.p1.13.m13.4.4.3.3.3" xref="A1.SS6.p1.13.m13.4.4.3.3.3.cmml"><mi id="A1.SS6.p1.13.m13.4.4.3.3.3.2" xref="A1.SS6.p1.13.m13.4.4.3.3.3.2.cmml">𝐕</mi><mrow id="A1.SS6.p1.13.m13.4.4.3.3.3.3" xref="A1.SS6.p1.13.m13.4.4.3.3.3.3.cmml"><mi id="A1.SS6.p1.13.m13.4.4.3.3.3.3.2" xref="A1.SS6.p1.13.m13.4.4.3.3.3.3.2.cmml">s</mi><mo id="A1.SS6.p1.13.m13.4.4.3.3.3.3.1" xref="A1.SS6.p1.13.m13.4.4.3.3.3.3.1.cmml">⁢</mo><mn id="A1.SS6.p1.13.m13.4.4.3.3.3.3.3" xref="A1.SS6.p1.13.m13.4.4.3.3.3.3.3.cmml">2</mn></mrow></msub><mo id="A1.SS6.p1.13.m13.5.5.4.4.8" xref="A1.SS6.p1.13.m13.5.5.4.5.cmml">,</mo><mi id="A1.SS6.p1.13.m13.1.1" mathvariant="normal" xref="A1.SS6.p1.13.m13.1.1.cmml">…</mi><mo id="A1.SS6.p1.13.m13.5.5.4.4.9" xref="A1.SS6.p1.13.m13.5.5.4.5.cmml">,</mo><msub id="A1.SS6.p1.13.m13.5.5.4.4.4" xref="A1.SS6.p1.13.m13.5.5.4.4.4.cmml"><mi id="A1.SS6.p1.13.m13.5.5.4.4.4.2" xref="A1.SS6.p1.13.m13.5.5.4.4.4.2.cmml">𝐕</mi><mrow id="A1.SS6.p1.13.m13.5.5.4.4.4.3" xref="A1.SS6.p1.13.m13.5.5.4.4.4.3.cmml"><mi id="A1.SS6.p1.13.m13.5.5.4.4.4.3.2" xref="A1.SS6.p1.13.m13.5.5.4.4.4.3.2.cmml">s</mi><mo id="A1.SS6.p1.13.m13.5.5.4.4.4.3.1" xref="A1.SS6.p1.13.m13.5.5.4.4.4.3.1.cmml">⁢</mo><mi id="A1.SS6.p1.13.m13.5.5.4.4.4.3.3" xref="A1.SS6.p1.13.m13.5.5.4.4.4.3.3.cmml">n</mi></mrow></msub><mo id="A1.SS6.p1.13.m13.5.5.4.4.10" stretchy="false" xref="A1.SS6.p1.13.m13.5.5.4.5.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS6.p1.13.m13.5b"><apply id="A1.SS6.p1.13.m13.5.5.cmml" xref="A1.SS6.p1.13.m13.5.5"><eq id="A1.SS6.p1.13.m13.5.5.5.cmml" xref="A1.SS6.p1.13.m13.5.5.5"></eq><apply id="A1.SS6.p1.13.m13.5.5.6.cmml" xref="A1.SS6.p1.13.m13.5.5.6"><csymbol cd="ambiguous" id="A1.SS6.p1.13.m13.5.5.6.1.cmml" xref="A1.SS6.p1.13.m13.5.5.6">subscript</csymbol><ci id="A1.SS6.p1.13.m13.5.5.6.2.cmml" xref="A1.SS6.p1.13.m13.5.5.6.2">𝐕</ci><apply id="A1.SS6.p1.13.m13.5.5.6.3.cmml" xref="A1.SS6.p1.13.m13.5.5.6.3"><times id="A1.SS6.p1.13.m13.5.5.6.3.1.cmml" xref="A1.SS6.p1.13.m13.5.5.6.3.1"></times><ci id="A1.SS6.p1.13.m13.5.5.6.3.2.cmml" xref="A1.SS6.p1.13.m13.5.5.6.3.2">𝑞</ci><ci id="A1.SS6.p1.13.m13.5.5.6.3.3.cmml" xref="A1.SS6.p1.13.m13.5.5.6.3.3">𝑠</ci></apply></apply><list id="A1.SS6.p1.13.m13.5.5.4.5.cmml" xref="A1.SS6.p1.13.m13.5.5.4.4"><apply id="A1.SS6.p1.13.m13.2.2.1.1.1.cmml" xref="A1.SS6.p1.13.m13.2.2.1.1.1"><csymbol cd="ambiguous" id="A1.SS6.p1.13.m13.2.2.1.1.1.1.cmml" xref="A1.SS6.p1.13.m13.2.2.1.1.1">subscript</csymbol><ci id="A1.SS6.p1.13.m13.2.2.1.1.1.2.cmml" xref="A1.SS6.p1.13.m13.2.2.1.1.1.2">𝐕</ci><apply id="A1.SS6.p1.13.m13.2.2.1.1.1.3.cmml" xref="A1.SS6.p1.13.m13.2.2.1.1.1.3"><times id="A1.SS6.p1.13.m13.2.2.1.1.1.3.1.cmml" xref="A1.SS6.p1.13.m13.2.2.1.1.1.3.1"></times><ci id="A1.SS6.p1.13.m13.2.2.1.1.1.3.2.cmml" xref="A1.SS6.p1.13.m13.2.2.1.1.1.3.2">𝑞</ci><ci id="A1.SS6.p1.13.m13.2.2.1.1.1.3.3.cmml" xref="A1.SS6.p1.13.m13.2.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A1.SS6.p1.13.m13.3.3.2.2.2.cmml" xref="A1.SS6.p1.13.m13.3.3.2.2.2"><csymbol cd="ambiguous" id="A1.SS6.p1.13.m13.3.3.2.2.2.1.cmml" xref="A1.SS6.p1.13.m13.3.3.2.2.2">subscript</csymbol><ci id="A1.SS6.p1.13.m13.3.3.2.2.2.2.cmml" xref="A1.SS6.p1.13.m13.3.3.2.2.2.2">𝐕</ci><apply id="A1.SS6.p1.13.m13.3.3.2.2.2.3.cmml" xref="A1.SS6.p1.13.m13.3.3.2.2.2.3"><times id="A1.SS6.p1.13.m13.3.3.2.2.2.3.1.cmml" xref="A1.SS6.p1.13.m13.3.3.2.2.2.3.1"></times><ci id="A1.SS6.p1.13.m13.3.3.2.2.2.3.2.cmml" xref="A1.SS6.p1.13.m13.3.3.2.2.2.3.2">𝑠</ci><cn id="A1.SS6.p1.13.m13.3.3.2.2.2.3.3.cmml" type="integer" xref="A1.SS6.p1.13.m13.3.3.2.2.2.3.3">1</cn></apply></apply><apply id="A1.SS6.p1.13.m13.4.4.3.3.3.cmml" xref="A1.SS6.p1.13.m13.4.4.3.3.3"><csymbol cd="ambiguous" id="A1.SS6.p1.13.m13.4.4.3.3.3.1.cmml" xref="A1.SS6.p1.13.m13.4.4.3.3.3">subscript</csymbol><ci id="A1.SS6.p1.13.m13.4.4.3.3.3.2.cmml" xref="A1.SS6.p1.13.m13.4.4.3.3.3.2">𝐕</ci><apply id="A1.SS6.p1.13.m13.4.4.3.3.3.3.cmml" xref="A1.SS6.p1.13.m13.4.4.3.3.3.3"><times id="A1.SS6.p1.13.m13.4.4.3.3.3.3.1.cmml" xref="A1.SS6.p1.13.m13.4.4.3.3.3.3.1"></times><ci id="A1.SS6.p1.13.m13.4.4.3.3.3.3.2.cmml" xref="A1.SS6.p1.13.m13.4.4.3.3.3.3.2">𝑠</ci><cn id="A1.SS6.p1.13.m13.4.4.3.3.3.3.3.cmml" type="integer" xref="A1.SS6.p1.13.m13.4.4.3.3.3.3.3">2</cn></apply></apply><ci id="A1.SS6.p1.13.m13.1.1.cmml" xref="A1.SS6.p1.13.m13.1.1">…</ci><apply id="A1.SS6.p1.13.m13.5.5.4.4.4.cmml" xref="A1.SS6.p1.13.m13.5.5.4.4.4"><csymbol cd="ambiguous" id="A1.SS6.p1.13.m13.5.5.4.4.4.1.cmml" xref="A1.SS6.p1.13.m13.5.5.4.4.4">subscript</csymbol><ci id="A1.SS6.p1.13.m13.5.5.4.4.4.2.cmml" xref="A1.SS6.p1.13.m13.5.5.4.4.4.2">𝐕</ci><apply id="A1.SS6.p1.13.m13.5.5.4.4.4.3.cmml" xref="A1.SS6.p1.13.m13.5.5.4.4.4.3"><times id="A1.SS6.p1.13.m13.5.5.4.4.4.3.1.cmml" xref="A1.SS6.p1.13.m13.5.5.4.4.4.3.1"></times><ci id="A1.SS6.p1.13.m13.5.5.4.4.4.3.2.cmml" xref="A1.SS6.p1.13.m13.5.5.4.4.4.3.2">𝑠</ci><ci id="A1.SS6.p1.13.m13.5.5.4.4.4.3.3.cmml" xref="A1.SS6.p1.13.m13.5.5.4.4.4.3.3">𝑛</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS6.p1.13.m13.5c">\mathbf{V}_{qs}=[\mathbf{V}_{qi},\mathbf{V}_{s1},\mathbf{V}_{s2},...,\mathbf{V%
}_{sn}]</annotation><annotation encoding="application/x-llamapun" id="A1.SS6.p1.13.m13.5d">bold_V start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT = [ bold_V start_POSTSUBSCRIPT italic_q italic_i end_POSTSUBSCRIPT , bold_V start_POSTSUBSCRIPT italic_s 1 end_POSTSUBSCRIPT , bold_V start_POSTSUBSCRIPT italic_s 2 end_POSTSUBSCRIPT , … , bold_V start_POSTSUBSCRIPT italic_s italic_n end_POSTSUBSCRIPT ]</annotation></semantics></math>.
Finally, our kv fusion self attention layer can be represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="A1.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{X}^{*}_{q}=KVFusionAttn(\mathbf{X}_{q},\mathbf{X}_{s})=Attention(%
\mathbf{Q}_{q},\mathbf{K}_{qs},\mathbf{V}_{qs})" class="ltx_Math" display="block" id="A1.E13.m1.5"><semantics id="A1.E13.m1.5a"><mrow id="A1.E13.m1.5.5" xref="A1.E13.m1.5.5.cmml"><msubsup id="A1.E13.m1.5.5.7" xref="A1.E13.m1.5.5.7.cmml"><mi id="A1.E13.m1.5.5.7.2.2" xref="A1.E13.m1.5.5.7.2.2.cmml">𝐗</mi><mi id="A1.E13.m1.5.5.7.3" xref="A1.E13.m1.5.5.7.3.cmml">q</mi><mo id="A1.E13.m1.5.5.7.2.3" xref="A1.E13.m1.5.5.7.2.3.cmml">∗</mo></msubsup><mo id="A1.E13.m1.5.5.8" xref="A1.E13.m1.5.5.8.cmml">=</mo><mrow id="A1.E13.m1.2.2.2" xref="A1.E13.m1.2.2.2.cmml"><mi id="A1.E13.m1.2.2.2.4" xref="A1.E13.m1.2.2.2.4.cmml">K</mi><mo id="A1.E13.m1.2.2.2.3" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.5" xref="A1.E13.m1.2.2.2.5.cmml">V</mi><mo id="A1.E13.m1.2.2.2.3a" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.6" xref="A1.E13.m1.2.2.2.6.cmml">F</mi><mo id="A1.E13.m1.2.2.2.3b" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.7" xref="A1.E13.m1.2.2.2.7.cmml">u</mi><mo id="A1.E13.m1.2.2.2.3c" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.8" xref="A1.E13.m1.2.2.2.8.cmml">s</mi><mo id="A1.E13.m1.2.2.2.3d" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.9" xref="A1.E13.m1.2.2.2.9.cmml">i</mi><mo id="A1.E13.m1.2.2.2.3e" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.10" xref="A1.E13.m1.2.2.2.10.cmml">o</mi><mo id="A1.E13.m1.2.2.2.3f" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.11" xref="A1.E13.m1.2.2.2.11.cmml">n</mi><mo id="A1.E13.m1.2.2.2.3g" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.12" xref="A1.E13.m1.2.2.2.12.cmml">A</mi><mo id="A1.E13.m1.2.2.2.3h" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.13" xref="A1.E13.m1.2.2.2.13.cmml">t</mi><mo id="A1.E13.m1.2.2.2.3i" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.14" xref="A1.E13.m1.2.2.2.14.cmml">t</mi><mo id="A1.E13.m1.2.2.2.3j" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mi id="A1.E13.m1.2.2.2.15" xref="A1.E13.m1.2.2.2.15.cmml">n</mi><mo id="A1.E13.m1.2.2.2.3k" xref="A1.E13.m1.2.2.2.3.cmml">⁢</mo><mrow id="A1.E13.m1.2.2.2.2.2" xref="A1.E13.m1.2.2.2.2.3.cmml"><mo id="A1.E13.m1.2.2.2.2.2.3" stretchy="false" xref="A1.E13.m1.2.2.2.2.3.cmml">(</mo><msub id="A1.E13.m1.1.1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.1.1.cmml"><mi id="A1.E13.m1.1.1.1.1.1.1.2" xref="A1.E13.m1.1.1.1.1.1.1.2.cmml">𝐗</mi><mi id="A1.E13.m1.1.1.1.1.1.1.3" xref="A1.E13.m1.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="A1.E13.m1.2.2.2.2.2.4" xref="A1.E13.m1.2.2.2.2.3.cmml">,</mo><msub id="A1.E13.m1.2.2.2.2.2.2" xref="A1.E13.m1.2.2.2.2.2.2.cmml"><mi id="A1.E13.m1.2.2.2.2.2.2.2" xref="A1.E13.m1.2.2.2.2.2.2.2.cmml">𝐗</mi><mi id="A1.E13.m1.2.2.2.2.2.2.3" xref="A1.E13.m1.2.2.2.2.2.2.3.cmml">s</mi></msub><mo id="A1.E13.m1.2.2.2.2.2.5" stretchy="false" xref="A1.E13.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A1.E13.m1.5.5.9" xref="A1.E13.m1.5.5.9.cmml">=</mo><mrow id="A1.E13.m1.5.5.5" xref="A1.E13.m1.5.5.5.cmml"><mi id="A1.E13.m1.5.5.5.5" xref="A1.E13.m1.5.5.5.5.cmml">A</mi><mo id="A1.E13.m1.5.5.5.4" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.6" xref="A1.E13.m1.5.5.5.6.cmml">t</mi><mo id="A1.E13.m1.5.5.5.4a" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.7" xref="A1.E13.m1.5.5.5.7.cmml">t</mi><mo id="A1.E13.m1.5.5.5.4b" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.8" xref="A1.E13.m1.5.5.5.8.cmml">e</mi><mo id="A1.E13.m1.5.5.5.4c" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.9" xref="A1.E13.m1.5.5.5.9.cmml">n</mi><mo id="A1.E13.m1.5.5.5.4d" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.10" xref="A1.E13.m1.5.5.5.10.cmml">t</mi><mo id="A1.E13.m1.5.5.5.4e" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.11" xref="A1.E13.m1.5.5.5.11.cmml">i</mi><mo id="A1.E13.m1.5.5.5.4f" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.12" xref="A1.E13.m1.5.5.5.12.cmml">o</mi><mo id="A1.E13.m1.5.5.5.4g" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.13" xref="A1.E13.m1.5.5.5.13.cmml">n</mi><mo id="A1.E13.m1.5.5.5.4h" xref="A1.E13.m1.5.5.5.4.cmml">⁢</mo><mrow id="A1.E13.m1.5.5.5.3.3" xref="A1.E13.m1.5.5.5.3.4.cmml"><mo id="A1.E13.m1.5.5.5.3.3.4" stretchy="false" xref="A1.E13.m1.5.5.5.3.4.cmml">(</mo><msub id="A1.E13.m1.3.3.3.1.1.1" xref="A1.E13.m1.3.3.3.1.1.1.cmml"><mi id="A1.E13.m1.3.3.3.1.1.1.2" xref="A1.E13.m1.3.3.3.1.1.1.2.cmml">𝐐</mi><mi id="A1.E13.m1.3.3.3.1.1.1.3" xref="A1.E13.m1.3.3.3.1.1.1.3.cmml">q</mi></msub><mo id="A1.E13.m1.5.5.5.3.3.5" xref="A1.E13.m1.5.5.5.3.4.cmml">,</mo><msub id="A1.E13.m1.4.4.4.2.2.2" xref="A1.E13.m1.4.4.4.2.2.2.cmml"><mi id="A1.E13.m1.4.4.4.2.2.2.2" xref="A1.E13.m1.4.4.4.2.2.2.2.cmml">𝐊</mi><mrow id="A1.E13.m1.4.4.4.2.2.2.3" xref="A1.E13.m1.4.4.4.2.2.2.3.cmml"><mi id="A1.E13.m1.4.4.4.2.2.2.3.2" xref="A1.E13.m1.4.4.4.2.2.2.3.2.cmml">q</mi><mo id="A1.E13.m1.4.4.4.2.2.2.3.1" xref="A1.E13.m1.4.4.4.2.2.2.3.1.cmml">⁢</mo><mi id="A1.E13.m1.4.4.4.2.2.2.3.3" xref="A1.E13.m1.4.4.4.2.2.2.3.3.cmml">s</mi></mrow></msub><mo id="A1.E13.m1.5.5.5.3.3.6" xref="A1.E13.m1.5.5.5.3.4.cmml">,</mo><msub id="A1.E13.m1.5.5.5.3.3.3" xref="A1.E13.m1.5.5.5.3.3.3.cmml"><mi id="A1.E13.m1.5.5.5.3.3.3.2" xref="A1.E13.m1.5.5.5.3.3.3.2.cmml">𝐕</mi><mrow id="A1.E13.m1.5.5.5.3.3.3.3" xref="A1.E13.m1.5.5.5.3.3.3.3.cmml"><mi id="A1.E13.m1.5.5.5.3.3.3.3.2" xref="A1.E13.m1.5.5.5.3.3.3.3.2.cmml">q</mi><mo id="A1.E13.m1.5.5.5.3.3.3.3.1" xref="A1.E13.m1.5.5.5.3.3.3.3.1.cmml">⁢</mo><mi id="A1.E13.m1.5.5.5.3.3.3.3.3" xref="A1.E13.m1.5.5.5.3.3.3.3.3.cmml">s</mi></mrow></msub><mo id="A1.E13.m1.5.5.5.3.3.7" stretchy="false" xref="A1.E13.m1.5.5.5.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E13.m1.5b"><apply id="A1.E13.m1.5.5.cmml" xref="A1.E13.m1.5.5"><and id="A1.E13.m1.5.5a.cmml" xref="A1.E13.m1.5.5"></and><apply id="A1.E13.m1.5.5b.cmml" xref="A1.E13.m1.5.5"><eq id="A1.E13.m1.5.5.8.cmml" xref="A1.E13.m1.5.5.8"></eq><apply id="A1.E13.m1.5.5.7.cmml" xref="A1.E13.m1.5.5.7"><csymbol cd="ambiguous" id="A1.E13.m1.5.5.7.1.cmml" xref="A1.E13.m1.5.5.7">subscript</csymbol><apply id="A1.E13.m1.5.5.7.2.cmml" xref="A1.E13.m1.5.5.7"><csymbol cd="ambiguous" id="A1.E13.m1.5.5.7.2.1.cmml" xref="A1.E13.m1.5.5.7">superscript</csymbol><ci id="A1.E13.m1.5.5.7.2.2.cmml" xref="A1.E13.m1.5.5.7.2.2">𝐗</ci><times id="A1.E13.m1.5.5.7.2.3.cmml" xref="A1.E13.m1.5.5.7.2.3"></times></apply><ci id="A1.E13.m1.5.5.7.3.cmml" xref="A1.E13.m1.5.5.7.3">𝑞</ci></apply><apply id="A1.E13.m1.2.2.2.cmml" xref="A1.E13.m1.2.2.2"><times id="A1.E13.m1.2.2.2.3.cmml" xref="A1.E13.m1.2.2.2.3"></times><ci id="A1.E13.m1.2.2.2.4.cmml" xref="A1.E13.m1.2.2.2.4">𝐾</ci><ci id="A1.E13.m1.2.2.2.5.cmml" xref="A1.E13.m1.2.2.2.5">𝑉</ci><ci id="A1.E13.m1.2.2.2.6.cmml" xref="A1.E13.m1.2.2.2.6">𝐹</ci><ci id="A1.E13.m1.2.2.2.7.cmml" xref="A1.E13.m1.2.2.2.7">𝑢</ci><ci id="A1.E13.m1.2.2.2.8.cmml" xref="A1.E13.m1.2.2.2.8">𝑠</ci><ci id="A1.E13.m1.2.2.2.9.cmml" xref="A1.E13.m1.2.2.2.9">𝑖</ci><ci id="A1.E13.m1.2.2.2.10.cmml" xref="A1.E13.m1.2.2.2.10">𝑜</ci><ci id="A1.E13.m1.2.2.2.11.cmml" xref="A1.E13.m1.2.2.2.11">𝑛</ci><ci id="A1.E13.m1.2.2.2.12.cmml" xref="A1.E13.m1.2.2.2.12">𝐴</ci><ci id="A1.E13.m1.2.2.2.13.cmml" xref="A1.E13.m1.2.2.2.13">𝑡</ci><ci id="A1.E13.m1.2.2.2.14.cmml" xref="A1.E13.m1.2.2.2.14">𝑡</ci><ci id="A1.E13.m1.2.2.2.15.cmml" xref="A1.E13.m1.2.2.2.15">𝑛</ci><interval closure="open" id="A1.E13.m1.2.2.2.2.3.cmml" xref="A1.E13.m1.2.2.2.2.2"><apply id="A1.E13.m1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E13.m1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.1.1.1.2">𝐗</ci><ci id="A1.E13.m1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="A1.E13.m1.2.2.2.2.2.2.cmml" xref="A1.E13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.E13.m1.2.2.2.2.2.2.1.cmml" xref="A1.E13.m1.2.2.2.2.2.2">subscript</csymbol><ci id="A1.E13.m1.2.2.2.2.2.2.2.cmml" xref="A1.E13.m1.2.2.2.2.2.2.2">𝐗</ci><ci id="A1.E13.m1.2.2.2.2.2.2.3.cmml" xref="A1.E13.m1.2.2.2.2.2.2.3">𝑠</ci></apply></interval></apply></apply><apply id="A1.E13.m1.5.5c.cmml" xref="A1.E13.m1.5.5"><eq id="A1.E13.m1.5.5.9.cmml" xref="A1.E13.m1.5.5.9"></eq><share href="https://arxiv.org/html/2410.02369v2#A1.E13.m1.2.2.2.cmml" id="A1.E13.m1.5.5d.cmml" xref="A1.E13.m1.5.5"></share><apply id="A1.E13.m1.5.5.5.cmml" xref="A1.E13.m1.5.5.5"><times id="A1.E13.m1.5.5.5.4.cmml" xref="A1.E13.m1.5.5.5.4"></times><ci id="A1.E13.m1.5.5.5.5.cmml" xref="A1.E13.m1.5.5.5.5">𝐴</ci><ci id="A1.E13.m1.5.5.5.6.cmml" xref="A1.E13.m1.5.5.5.6">𝑡</ci><ci id="A1.E13.m1.5.5.5.7.cmml" xref="A1.E13.m1.5.5.5.7">𝑡</ci><ci id="A1.E13.m1.5.5.5.8.cmml" xref="A1.E13.m1.5.5.5.8">𝑒</ci><ci id="A1.E13.m1.5.5.5.9.cmml" xref="A1.E13.m1.5.5.5.9">𝑛</ci><ci id="A1.E13.m1.5.5.5.10.cmml" xref="A1.E13.m1.5.5.5.10">𝑡</ci><ci id="A1.E13.m1.5.5.5.11.cmml" xref="A1.E13.m1.5.5.5.11">𝑖</ci><ci id="A1.E13.m1.5.5.5.12.cmml" xref="A1.E13.m1.5.5.5.12">𝑜</ci><ci id="A1.E13.m1.5.5.5.13.cmml" xref="A1.E13.m1.5.5.5.13">𝑛</ci><vector id="A1.E13.m1.5.5.5.3.4.cmml" xref="A1.E13.m1.5.5.5.3.3"><apply id="A1.E13.m1.3.3.3.1.1.1.cmml" xref="A1.E13.m1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="A1.E13.m1.3.3.3.1.1.1.1.cmml" xref="A1.E13.m1.3.3.3.1.1.1">subscript</csymbol><ci id="A1.E13.m1.3.3.3.1.1.1.2.cmml" xref="A1.E13.m1.3.3.3.1.1.1.2">𝐐</ci><ci id="A1.E13.m1.3.3.3.1.1.1.3.cmml" xref="A1.E13.m1.3.3.3.1.1.1.3">𝑞</ci></apply><apply id="A1.E13.m1.4.4.4.2.2.2.cmml" xref="A1.E13.m1.4.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.E13.m1.4.4.4.2.2.2.1.cmml" xref="A1.E13.m1.4.4.4.2.2.2">subscript</csymbol><ci id="A1.E13.m1.4.4.4.2.2.2.2.cmml" xref="A1.E13.m1.4.4.4.2.2.2.2">𝐊</ci><apply id="A1.E13.m1.4.4.4.2.2.2.3.cmml" xref="A1.E13.m1.4.4.4.2.2.2.3"><times id="A1.E13.m1.4.4.4.2.2.2.3.1.cmml" xref="A1.E13.m1.4.4.4.2.2.2.3.1"></times><ci id="A1.E13.m1.4.4.4.2.2.2.3.2.cmml" xref="A1.E13.m1.4.4.4.2.2.2.3.2">𝑞</ci><ci id="A1.E13.m1.4.4.4.2.2.2.3.3.cmml" xref="A1.E13.m1.4.4.4.2.2.2.3.3">𝑠</ci></apply></apply><apply id="A1.E13.m1.5.5.5.3.3.3.cmml" xref="A1.E13.m1.5.5.5.3.3.3"><csymbol cd="ambiguous" id="A1.E13.m1.5.5.5.3.3.3.1.cmml" xref="A1.E13.m1.5.5.5.3.3.3">subscript</csymbol><ci id="A1.E13.m1.5.5.5.3.3.3.2.cmml" xref="A1.E13.m1.5.5.5.3.3.3.2">𝐕</ci><apply id="A1.E13.m1.5.5.5.3.3.3.3.cmml" xref="A1.E13.m1.5.5.5.3.3.3.3"><times id="A1.E13.m1.5.5.5.3.3.3.3.1.cmml" xref="A1.E13.m1.5.5.5.3.3.3.3.1"></times><ci id="A1.E13.m1.5.5.5.3.3.3.3.2.cmml" xref="A1.E13.m1.5.5.5.3.3.3.3.2">𝑞</ci><ci id="A1.E13.m1.5.5.5.3.3.3.3.3.cmml" xref="A1.E13.m1.5.5.5.3.3.3.3.3">𝑠</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E13.m1.5c">\mathbf{X}^{*}_{q}=KVFusionAttn(\mathbf{X}_{q},\mathbf{X}_{s})=Attention(%
\mathbf{Q}_{q},\mathbf{K}_{qs},\mathbf{V}_{qs})</annotation><annotation encoding="application/x-llamapun" id="A1.E13.m1.5d">bold_X start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT = italic_K italic_V italic_F italic_u italic_s italic_i italic_o italic_n italic_A italic_t italic_t italic_n ( bold_X start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_X start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ) = italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ( bold_Q start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT , bold_K start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT , bold_V start_POSTSUBSCRIPT italic_q italic_s end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="A1.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.7 </span>Other visualization</h3>
<div class="ltx_para" id="A1.SS7.p1">
<p class="ltx_p" id="A1.SS7.p1.3">To better explore the capabilities of DiffewS, we visualize its performance on COCO-20<sup class="ltx_sup" id="A1.SS7.p1.3.1"><span class="ltx_text ltx_font_italic" id="A1.SS7.p1.3.1.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib43" title="">43</a>]</cite>  LVIS-92<sup class="ltx_sup" id="A1.SS7.p1.3.2"><span class="ltx_text ltx_font_italic" id="A1.SS7.p1.3.2.1">i</span></sup> <cite class="ltx_cite ltx_citemacro_citep">[<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#bib.bib22" title="">22</a>]</cite> and several cases from Internet.
<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.F8" title="In A.7 Other visualization ‣ Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">8</span></a> shows the remarkable results of DiffewS on COCO-20<sup class="ltx_sup" id="A1.SS7.p1.3.3"><span class="ltx_text ltx_font_italic" id="A1.SS7.p1.3.3.1">i</span></sup>.
<a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.F6" title="In A.7 Other visualization ‣ Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">6</span></a> demonstrates the impressive generalization capabilities of DiffewS.
For some categories not present in the training set, such as apron and violin, DiffewS is able to perform accurate segmentation.
In addition, DiffewS is demonstrated effective results in some cross-style segmentation and small object segmentation cases.
For abstract concepts, such as Western dragons and Chinese dragons, DiffewS links them together to achieve accurate results.
We speculate that the impressive generalization ability of DiffewS stems from its effective utilization of prior knowledge from the diffusion model.
As shown in <a class="ltx_ref" href="https://arxiv.org/html/2410.02369v2#A1.F7" title="In A.7 Other visualization ‣ Appendix A Appendix ‣ Unleashing the Potential of the Diffusion Model in Few-shot Semantic Segmentation"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">7</span></a>, DiffewS also fails to segment some challenging cases.
When there is a significant appearance disparity between the reference image and the target image (Appearance disparity), DiffewS may encounter segmentation errors.
Additionally, if there are other objects with similar appearances in the target image (Look-alike interference) or if the objects in the image are severely occluded (Occlusion interference), DiffewS struggles to produce accurate results.</p>
</div>
<figure class="ltx_figure" id="A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="211" id="A1.F6.g1" src="x6.png" width="746"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="A1.F6.3.2" style="font-size:90%;">
Visualization of one-shot semantic segmentation on various Internet cases. The blue color denotes the support mask while the red represents the query mask. DiffewS also performs impressively on cases with cross-styles and significant appearance differences, as well as on abstract concepts it has never encountered before. </span></figcaption>
</figure>
<figure class="ltx_figure" id="A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="292" id="A1.F7.g1" src="x7.png" width="746"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F7.8.3.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="A1.F7.4.2" style="font-size:90%;">
Three types of failed cases in one-shot semantic segmentation on LVIS-92<sup class="ltx_sup" id="A1.F7.4.2.1"><span class="ltx_text ltx_font_italic" id="A1.F7.4.2.1.1">i</span></sup> and COCO-20<sup class="ltx_sup" id="A1.F7.4.2.2"><span class="ltx_text ltx_font_italic" id="A1.F7.4.2.2.1">i</span></sup>. </span></figcaption>
</figure>
<figure class="ltx_figure" id="A1.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="860" id="A1.F8.g1" src="x8.png" width="748"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="A1.F8.8.3.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="A1.F8.4.2" style="font-size:90%;">
Qualitative results of one-shot semantic segmentation on COCO-20<sup class="ltx_sup" id="A1.F8.4.2.1"><span class="ltx_text ltx_font_italic" id="A1.F8.4.2.1.1">i</span></sup>. The blue color denotes the support mask while the red represents the query mask. DiffewS has an impressive performance on COCO-20<sup class="ltx_sup" id="A1.F8.4.2.2"><span class="ltx_text ltx_font_italic" id="A1.F8.4.2.2.1">i</span></sup>. </span></figcaption>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Oct  4 07:55:24 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
