<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator</title>
<!--Generated on Sat Sep 14 01:39:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Generative Recommender Systems,  Large Language Models,  Twin-Tower Architecture,  Vector Quantization" lang="en" name="keywords"/>
<base href="/html/2409.09253v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S1" title="In Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S2" title="In Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S3" title="In Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Background</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4" title="In Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS1" title="In 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Problem Formulation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS2" title="In 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>TTDS Recommender</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS2.SSS1" title="In 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span><span class="ltx_text ltx_font_bold">Dynamic Knowledge Fusion Framework</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS2.SSS2" title="In 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span><span class="ltx_text ltx_font_bold">Hierarchical Index Mechanism</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS2.SSS3" title="In 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.3 </span><span class="ltx_text ltx_font_bold">Dual-Modality Variational Auto-Encoder</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS2.SSS4" title="In 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.4 </span><span class="ltx_text ltx_font_bold">High-Order User-Item Interaction Pattern</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS2.SSS5" title="In 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.5 </span><span class="ltx_text ltx_font_bold">Collision Handling Mechanism</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS3" title="In 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Discussion</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS3.SSS1" title="In 4.3. Discussion ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span><span class="ltx_text ltx_font_bold">Index Mechanism</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.SS3.SSS2" title="In 4.3. Discussion ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span><span class="ltx_text ltx_font_bold">Sequential Recommendation</span></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5" title="In Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiment</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS1" title="In 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS1.SSS1" title="In 5.1. Experimental Setup ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span><span class="ltx_text ltx_font_bold">Dataset</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS1.SSS2" title="In 5.1. Experimental Setup ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span><span class="ltx_text ltx_font_bold">Baseline</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS1.SSS3" title="In 5.1. Experimental Setup ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.3 </span><span class="ltx_text ltx_font_bold">Evaluation Strategy</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS1.SSS4" title="In 5.1. Experimental Setup ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.4 </span><span class="ltx_text ltx_font_bold">Implementation Detail</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS2" title="In 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Main Result</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS3" title="In 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Ablation Study</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS3.SSS1" title="In 5.3. Ablation Study ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.1 </span><span class="ltx_text ltx_font_bold">Architecture</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.SS3.SSS2" title="In 5.3. Ablation Study ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3.2 </span><span class="ltx_text ltx_font_bold">Indexing Mechanism</span></span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S6" title="In Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\useunder</span>
<p class="ltx_p" id="p1.2"><span class="ltx_text ltx_ulem_uline" id="p1.2.1"></span><span class="ltx_ERROR undefined" id="p1.2.2">\ul</span></p>
</div>
<h1 class="ltx_title ltx_title_document">Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jun Yin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Central South University</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Changsha</span><span class="ltx_text ltx_affiliation_state" id="id3.3.id3">Hunan</span><span class="ltx_text ltx_affiliation_country" id="id4.4.id4">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yinjun2000@csu.edu.cn">yinjun2000@csu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhengxin Zeng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Microsoft</span><span class="ltx_text ltx_affiliation_city" id="id6.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id7.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhze@microsoft.com">zhze@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mingzheng Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id8.1.id1">Microsoft</span><span class="ltx_text ltx_affiliation_city" id="id9.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id10.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:mingzhengli@microsoft.com">mingzhengli@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hao Yan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id11.1.id1">Central South University</span><span class="ltx_text ltx_affiliation_city" id="id12.2.id2">Changsha</span><span class="ltx_text ltx_affiliation_state" id="id13.3.id3">Hunan</span><span class="ltx_text ltx_affiliation_country" id="id14.4.id4">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:CSUyh1999@csu.edu.cn">CSUyh1999@csu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chaozhuo Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id15.1.id1">Microsoft Research Asia</span><span class="ltx_text ltx_affiliation_city" id="id16.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id17.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:cli@microsoft.com">cli@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weihao Han
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id18.1.id1">Microsoft</span><span class="ltx_text ltx_affiliation_city" id="id19.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id20.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:weihan@microsoft.com">weihan@microsoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jianjin Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id21.1.id1">Microsoft</span><span class="ltx_text ltx_affiliation_city" id="id22.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id23.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:jianjzh@miscrosoft.com">jianjzh@miscrosoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ruochen Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id24.1.id1">Central South University</span><span class="ltx_text ltx_affiliation_city" id="id25.2.id2">Changsha</span><span class="ltx_text ltx_affiliation_state" id="id26.3.id3">Hunan</span><span class="ltx_text ltx_affiliation_country" id="id27.4.id4">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:234712122@csu.edu.cn">234712122@csu.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Allen Sun
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id28.1.id1">Microsoft</span><span class="ltx_text ltx_affiliation_city" id="id29.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id30.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:hasun@miscrosoft.com">hasun@miscrosoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Denvy Deng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id31.1.id1">Microsoft</span><span class="ltx_text ltx_affiliation_city" id="id32.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id33.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:dedeng@miscrosoft.com">dedeng@miscrosoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Feng Sun
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id34.1.id1">Microsoft</span><span class="ltx_text ltx_affiliation_city" id="id35.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id36.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:sunfeng@miscrosoft.com">sunfeng@miscrosoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qi Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id37.1.id1">Microsoft</span><span class="ltx_text ltx_affiliation_city" id="id38.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id39.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:qizhang@miscrosoft.com">qizhang@miscrosoft.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shirui Pan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id40.1.id1">Griffith University</span><span class="ltx_text ltx_affiliation_city" id="id41.2.id2">Brisbane</span><span class="ltx_text ltx_affiliation_state" id="id42.3.id3">Queensland</span><span class="ltx_text ltx_affiliation_country" id="id43.4.id4">Australia</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:s.pan@griffith.edu.au">s.pan@griffith.edu.au</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Senzhang Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id44.1.id1">Central South University</span><span class="ltx_text ltx_affiliation_city" id="id45.2.id2">Changsha</span><span class="ltx_text ltx_affiliation_state" id="id46.3.id3">Hunan</span><span class="ltx_text ltx_affiliation_country" id="id47.4.id4">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:szwang@csu.edu.cn">szwang@csu.edu.cn</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id48.id1">Owing to the unprecedented capability in semantic understanding and logical reasoning, the pre-trained large language models (LLMs) have shown fantastic potential in developing the next-generation recommender systems (RSs). However, the static index paradigm adopted by current methods greatly restricts the utilization of LLMs capacity for recommendation, leading to not only the insufficient alignment between semantic and collaborative knowledge, but also the neglect of high-order user-item interaction patterns. In this paper, we propose <span class="ltx_text ltx_font_bold" id="id48.id1.1">T</span>win-<span class="ltx_text ltx_font_bold" id="id48.id1.2">T</span>ower <span class="ltx_text ltx_font_bold" id="id48.id1.3">D</span>ynamic <span class="ltx_text ltx_font_bold" id="id48.id1.4">S</span>emantic Recommender (<span class="ltx_text ltx_font_bold" id="id48.id1.5">TTDS</span>)<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The code and dataset will be available upon acceptance of the paper</span></span></span>, the first generative RS which adopts dynamic semantic index paradigm, targeting at resolving the above problems simultaneously. To be more specific, we for the first time contrive a dynamic knowledge fusion framework which integrates a twin-tower semantic token generator into the LLM-based recommender, hierarchically allocating meaningful semantic index for items and users, and accordingly predicting the semantic index of target item. Furthermore, a dual-modality variational auto-encoder is proposed to facilitate multi-grained alignment between semantic and collaborative knowledge. Eventually, a series of novel tuning tasks specially customized for capturing high-order user-item interaction patterns are proposed to take advantages of user historical behavior. Extensive experiments across three public datasets demonstrate the superiority of the proposed methodology in developing LLM-based generative RSs. The proposed TTDS recommender achieves an average improvement of 19.41% in Hit-Rate and 20.84% in NDCG metric, compared with the leading baseline methods.</p>
</div>
<div class="ltx_keywords">Generative Recommender Systems, Large Language Models, Twin-Tower Architecture, Vector Quantization
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Language models</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Information extraction</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id9"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Personalization</span></span></span>
<figure class="ltx_figure" id="S0.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="318" id="S0.F1.g1" src="x1.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>An overview of a). The proposed twin-tower generative recommender systems based on dynamic semantic index and b). Existing single-Tower generative recommender systems based on static semantic index.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S0.F1.1">\Description</span></div>
</div>
</figure>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">With the network information proliferating exponentially, recommender systems (RSs) which discover user interested contents have become essential components of online service platforms <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib34" title="">2020</a>; Covington et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib4" title="">2016</a>; Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib9" title="">2022</a>; de Souza Pereira Moreira et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib7" title="">2021</a>)</cite>. Since user preference evolves over time, sequential recommender systems have attracted great research attention from both academia and industry <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib25" title="">2018</a>)</cite>, due to the splendid capability in capturing collaborative patterns of items in user behavior sequences. In current research literature, sequential recommender systems introduce various deep neural network architectures, including convolutional neural networks (CNNs) <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib47" title="">2019</a>; Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib39" title="">2018</a>)</cite>, recurrent neural networks (RNNs) <cite class="ltx_cite ltx_citemacro_citep">(Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib38" title="">2016</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib27" title="">2017a</a>)</cite>, graph neural networks (GNNs) <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib45" title="">2019</a>; Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib46" title="">2019</a>)</cite>, and Transformers <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib25" title="">2018</a>; de Souza Pereira Moreira et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib7" title="">2021</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib37" title="">2019</a>)</cite>, to extract collaborative informative within the user historical behaviors represented by item sequences. For further improvement on recommendation performance, the pre-trained language models (PLMs) are adopted to capture the semantic information within the item textual features <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib16" title="">2022</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib29" title="">2023</a>; Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib15" title="">2023</a>)</cite>. Recently, the emergency of large language models (LLMs) pre-trained on large-scale natural language (NL) corpus, such as GPT <cite class="ltx_cite ltx_citemacro_citep">(Radford et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib33" title="">2023</a>)</cite>, T5 <cite class="ltx_cite ltx_citemacro_citep">(Gomez-Uribe and Hunt, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib10" title="">2016</a>)</cite>, and LlaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib41" title="">2023</a>)</cite>, have revolutionized the recommender systems community, due to the unprecedented capability in semantic understanding and logical reasoning <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>; Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib54" title="">2024</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">The cornerstone of developing LLM-based recommender systems lies in the integration between the two modalities of item that serves as the fundamental in sequential recommendation, i.e., the collaborative information reflected by historical interaction and the semantic information implicating in item textual feature. Existing efforts to align the collaborative and semantic information in sequential recommendation can be divided into two main approaches: <span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p2.1.1">(i)</span> The first approach verbalizes the historical interaction into textual sequence (e.g., concatenate the item titles and descriptions) and then instructs LLMs on sequential recommendation through natural language prompt <cite class="ltx_cite ltx_citemacro_citep">(Hou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib17" title="">2024</a>; Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib2" title="">2023</a>; Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib19" title="">2023</a>)</cite>. Such an <span class="ltx_text ltx_font_bold" id="S1.p2.1.2">content-based</span> approach further increases the computation expenditure due to the greatly extended input sequence and fails to guarantee in-domain recommendation results <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib54" title="">2024</a>)</cite>. <span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p2.1.3">(ii)</span> The second approach incorporates LLMs and RSs through the static index mapping<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Without ambiguity, the term <span class="ltx_text ltx_font_bold ltx_font_italic" id="footnote2.1">ID</span> and <span class="ltx_text ltx_font_bold ltx_font_italic" id="footnote2.2">index (indices)</span> will be used interchangeably.</span></span></span>. The compact item indices can be considered as special tokens and used to extend the LLM vocabulary, aiming to mitigate the computation overhead and guarantee the in-domain legitimate recommendation results <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>; Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib54" title="">2024</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>; Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib9" title="">2022</a>; Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib19" title="">2023</a>)</cite>. To be more specific, <span class="ltx_text ltx_font_bold" id="S1.p2.1.4">pseudo index based</span> methods emulate traditional ID-based RS and adopt ID-alike words to represent users and items (e.g., <span class="ltx_text ltx_font_italic" id="S1.p2.1.5">¡user_100¿</span> and <span class="ltx_text ltx_font_italic" id="S1.p2.1.6">¡item_128¿</span>) <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib9" title="">2022</a>; Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib54" title="">2024</a>; Hua et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib19" title="">2023</a>)</cite>. To bring the best of the content-based and the pseudo index based methods, <span class="ltx_text ltx_font_bold" id="S1.p2.1.7">semantic index based</span> methods first embed the item/user related content into continuous vector, and then introduce discrete indexing technique which quantizes continuous embedding into discrete indices <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>; Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib22" title="">2024b</a>)</cite>. Notably, different from pseudo ID, the discrete semantic ID is generated based on the item/user representation similarity, which implies that <span class="ltx_text ltx_font_italic" id="S1.p2.1.8">¡item_1¿</span> is more similar to <span class="ltx_text ltx_font_italic" id="S1.p2.1.9">¡item_2¿</span> than <span class="ltx_text ltx_font_italic" id="S1.p2.1.10">¡item_10¿</span>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Despite remarkable achievements have been developed, such a static index mechanism based integration paradigm is still confronted with the fundamental discrepancy between the semantic and collaborative knowledge. Throughout the static index based recommendation process, each item index is completely dominated by the corresponding textual content and the textual encoder <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>; Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib23" title="">2024a</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib31" title="">2024</a>)</cite>. First, the textual content itself implicates semantic inductive bias, probably misleading the downstream RSs. For example, the film <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">Transformers</span> (July 3, 2007) and the teaching video <span class="ltx_text ltx_font_italic" id="S1.p3.1.2">Transformer Careful Elaboration</span> (October 28, 2021) are highly similar in terms of textual content, yet fractionally overlap within the interaction records. Second, distribution mismatch between the textual encoder embedding and the RS representation is overlooked <cite class="ltx_cite ltx_citemacro_citep">(Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib22" title="">2024b</a>; Huh et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib20" title="">2023</a>)</cite>. Assuming that a shallow textual encoder is employed, the entire RS performance will be constrained by the inferior encoding ability. Last but not least, existing static integration paradigms fail to exploit high-order user-item interaction patterns during the recommendation-oriented fine-tune <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib31" title="">2024</a>; Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib23" title="">2024a</a>)</cite>. Only the item co-occurrence pattern within user historical behavior is underlined, high-order interaction patterns, such as the user co-purchase pattern and the user preference pattern, remain to be fully utilized.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we for the first time investigate the generative RSs based on dynamic semantic index mechanism, aiming to address the above problems simultaneously. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S0.F1" title="Figure 1 ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">1</span></a>, during the recommendation-oriented fine-tuning, the twin-tower semantic token generator is cooperatively optimized with the recommender module. Note that within the dynamic semantic index mechanism, the textual encoder module and the recommender module share the same LLM backbone, seamlessly aligning the distribution of the textual embedding and the recommender representation, eventually fusing the semantic and collaborative knowledge into a monolithic model. Moreover, the twin-tower semantic token generator contains two homogeneous branches of discrete index module, one of which for the item index learning and the other for the user counterpart. By reasonably aggregating the user and item semantic indices, the recommender module is able to delve into the exploition of high-order user-item interaction patterns. However, it is non-trivial to design the dynamic semantic index based generative recommender system due to the following challenges.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Under-trained User/Item Semantic Token.</span> Since LLM-based the generative RSs extend the LLM vocabulary with the semantic tokens of users and items, the semantic tokens can be considered as basic words of a brand-new language which specifically describes the recommendation field <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib44" title="">2022</a>; Tay et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib40" title="">2022</a>; Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>)</cite>. However, the novel language is unfamiliar to the LLM backbone which is pre-trained on large-scale NL corpus. Therefore, there exists considerable discrepancy between the under-trained semantic tokens and the well pre-trained NL tokens. How to instruct LLMs in understanding the under-trained semantic tokens as well as the NL tokens is challenging.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_bold" id="S1.p6.1.1">Implicit High-order User-Item Interaction Pattern.</span> As to the sequential recommendation task, the user historical behavior is represented as an interactive item sequence (e.g., [<span class="ltx_text ltx_font_italic" id="S1.p6.1.2">¡item_1¿</span>, <span class="ltx_text ltx_font_italic" id="S1.p6.1.3">¡item_3¿</span>, …, <span class="ltx_text ltx_font_italic" id="S1.p6.1.4">¡item_34¿</span>]) <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib25" title="">2018</a>; de Souza Pereira Moreira et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib7" title="">2021</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib37" title="">2019</a>)</cite>. Accordingly, the item co-occurrence pattern is explicit and effortless to capture. Nevertheless, the high-order interaction patterns that implicitly contained in user historical behavior are overlooked by existing methods <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>; Jin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib23" title="">2024a</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib31" title="">2024</a>; Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib54" title="">2024</a>)</cite>. For example, the user co-purchase pattern (e.g., <span class="ltx_text ltx_font_italic" id="S1.p6.1.5">¡user_1¿</span> and <span class="ltx_text ltx_font_italic" id="S1.p6.1.6">¡user_2¿</span> both purchase <span class="ltx_text ltx_font_italic" id="S1.p6.1.7">¡item_9¿</span>) and the user preference pattern (e.g., <span class="ltx_text ltx_font_italic" id="S1.p6.1.8">¡user_3¿</span> and <span class="ltx_text ltx_font_italic" id="S1.p6.1.9">¡user_4¿</span> share lots of similar items) are difficult to capture merely based on the sequential recommendation task <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib43" title="">2019</a>)</cite>. How to exploit and capture the implicit high-order user-item interaction patterns are also challenging.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">To address the aforementioned challenges, we propose <span class="ltx_text ltx_font_bold" id="S1.p7.1.1">T</span>win-<span class="ltx_text ltx_font_bold" id="S1.p7.1.2">T</span>ower <span class="ltx_text ltx_font_bold" id="S1.p7.1.3">D</span>ynamic <span class="ltx_text ltx_font_bold" id="S1.p7.1.4">S</span>emantic (<span class="ltx_text ltx_font_bold" id="S1.p7.1.5">TTDS</span>) Recommender, the first generative RS that adopts dynamic semantic index mechanism. By devising a dynamic knowledge fusion framework, TTDS recommender is able to absorb the semantic knowledge in textual feature and the collaborative knowledge within the historical interaction into a single LLM backbone. Given the user historical interacted items, first the LLM can convert the user textual profile and item textual features into continuous embeddings, then the twin-tower semantic token generator hierarchically discretizes the continuous embeddings into semantic user/item indices <cite class="ltx_cite ltx_citemacro_citep">(Zeghidour et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib48" title="">2021</a>)</cite>. Within the dynamic knowledge fusion process, a dual-modality variational auto-encoder (DM-VAE) is proposed to align the under-trained semantic tokens and the well pre-trained NL token across multiple representation granularity. Accordingly, the user profile and the item textual feature can be equivalently replaced by the corresponding semantic indices. By aggregating the user/item semantic indices and the user behavior sequence through human instruction, the semantic knowledge and the collaborative knowledge are seamlessly integrated during the recommendation-oriented fine-tuning procedure. Furthermore, we customize a series of novel tuning tasks target at capturing high-order user-item interaction patterns. Eventually, the learned user/item indices not only contain semantic knowledge represented by the textual features, but also imply collaborative knowledge reflected by the interaction histories. Based on the dynamic knowledge fusion framework, TTDS recommender is able to perform sequential recommendation following the paradigm of next token prediction in NLP <cite class="ltx_cite ltx_citemacro_citep">(Tay et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib40" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">The main contributions of this work can be summarized below:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We for the first time investigate the dynamic semantic index based generative recommender systems and propose the Twin-Tower Dynamic Semantic Recommender that adopts a dynamic knowledge fusion framework,</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose the dual-modality variational auto-encoder (DM-VAE) module, aiming to facilitate LLM to understand the newly introduced semantic tokens. In addition, we design a series of specific tuning tasks, to exploit and capture high-order user-item interaction patterns.
</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Extensive experimental results on three public recommendation datasets demonstrate that the TTDS recommender outperforms the current SOTA recommender system models, achieving an average improvement of 19.41% in Hit-Rate and 20.84% in NDCG metrics,.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Sequential Recommendation.</span> While the inchoate sequential recommendation models are developed on the basis of classical matrix factorization <cite class="ltx_cite ltx_citemacro_citep">(Rendle et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib36" title="">2009</a>; Kabbur et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib24" title="">2013</a>)</cite>, K-nearest neighbor <cite class="ltx_cite ltx_citemacro_citep">(Davidson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib6" title="">2010</a>; Linden et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib30" title="">2003</a>)</cite>, and markov chains techniques <cite class="ltx_cite ltx_citemacro_citep">(He and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib13" title="">2016</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib12" title="">2017</a>)</cite>, artificial neural network based deep sequential recommender systems have dominated the current leaderboard <cite class="ltx_cite ltx_citemacro_citep">(Fang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib8" title="">2020</a>)</cite>. GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(Jannach and Ludewig, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib21" title="">2017</a>)</cite> for the first time incorporates GRU module <cite class="ltx_cite ltx_citemacro_citep">(Chung et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib3" title="">2014</a>)</cite> with sequential recommendation. NARM <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib28" title="">2017b</a>)</cite> further enhances the long-term user preference memory through attention mechanism, and AttRec <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib49" title="">2019a</a>)</cite> introduces metric learning to capture user-item affinity additionally. Inspired by the great success of pre-trained language models and masked token prediction, Bert4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib37" title="">2019</a>)</cite> first utilizes deep transformer model with masking pre-train strategy on sequential recommendation. The sequential recommendation models introduced above aims at learning high-dimensional item representation and then provide the recommendation result based on Approximate Nearest Neighbor in the Maximum Inner Product Search <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib11" title="">2020</a>)</cite>. On the other hand, generative recommendation models based on index learning technique have attracted significant research attention, due to the efficient inference. DSI <cite class="ltx_cite ltx_citemacro_citep">(Tay et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib40" title="">2022</a>)</cite> for the first time proposes an end-to-end transformer model for document retrieval, NCI <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib44" title="">2022</a>)</cite> further supplements the index learning mechanism of DSI by proposing a specific prefix decoder.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">LLM-based Recommender System.</span> As the LLMs demonstrating comprehensive capacity on language modeling tasks, P5 <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib9" title="">2022</a>)</cite> for the first time attempts to fine-tune LLM for a sequential recommendation oriented model, M6-Rec <cite class="ltx_cite ltx_citemacro_citep">(Cui et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib5" title="">2022</a>)</cite> replaces the pseudo index in P5 (e.g., <span class="ltx_text ltx_font_italic" id="S2.p2.1.2">¡item_7¿</span>) with the corresponding linguistic description, and TALLRec <cite class="ltx_cite ltx_citemacro_citep">(Bao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib2" title="">2023</a>)</cite> combines both the pseudo index and textual description. CLLM4Rec <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib54" title="">2024</a>)</cite> extends the LLM vocabulary with vanilla item index and proposes a mixed prompting strategy to adapt the extended LLM. Furthermore, TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>)</cite> for the first time adopts hierarchical vector quantization technique to generate semantic item index and LC-Rec <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>)</cite> substitutes the T5X backbone with LlaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib41" title="">2023</a>)</cite> for superior recommendation performance.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Background</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we briefly introduce the sequential recommendation task and the large language model. The key notations are summarized in Appendix A for clarity.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.2"><span class="ltx_text ltx_font_bold" id="S3.p2.2.1">Sequential Recommendation.</span> By analyzing the user historical interactions, sequential recommendation aims to identify user preference and predict the suitable item that would be engaged with <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib47" title="">2019</a>; Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib39" title="">2018</a>; Tan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib38" title="">2016</a>; Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib27" title="">2017a</a>; Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib46" title="">2019</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib45" title="">2019</a>; de Souza Pereira Moreira et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib7" title="">2021</a>; Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib25" title="">2018</a>; Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib37" title="">2019</a>)</cite>. Given a chronologically organized sequence of interacted items <math alttext="s=\{v_{1},v_{2},\cdots,v_{l}\}" class="ltx_Math" display="inline" id="S3.p2.1.m1.4"><semantics id="S3.p2.1.m1.4a"><mrow id="S3.p2.1.m1.4.4" xref="S3.p2.1.m1.4.4.cmml"><mi id="S3.p2.1.m1.4.4.5" xref="S3.p2.1.m1.4.4.5.cmml">s</mi><mo id="S3.p2.1.m1.4.4.4" xref="S3.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.p2.1.m1.4.4.3.3" xref="S3.p2.1.m1.4.4.3.4.cmml"><mo id="S3.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S3.p2.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.p2.1.m1.2.2.1.1.1" xref="S3.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.p2.1.m1.2.2.1.1.1.2" xref="S3.p2.1.m1.2.2.1.1.1.2.cmml">v</mi><mn id="S3.p2.1.m1.2.2.1.1.1.3" xref="S3.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.1.m1.4.4.3.3.5" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.p2.1.m1.3.3.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.p2.1.m1.3.3.2.2.2.2" xref="S3.p2.1.m1.3.3.2.2.2.2.cmml">v</mi><mn id="S3.p2.1.m1.3.3.2.2.2.3" xref="S3.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.p2.1.m1.4.4.3.3.6" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.p2.1.m1.1.1" mathvariant="normal" xref="S3.p2.1.m1.1.1.cmml">⋯</mi><mo id="S3.p2.1.m1.4.4.3.3.7" xref="S3.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.p2.1.m1.4.4.3.3.3" xref="S3.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.p2.1.m1.4.4.3.3.3.2" xref="S3.p2.1.m1.4.4.3.3.3.2.cmml">v</mi><mi id="S3.p2.1.m1.4.4.3.3.3.3" xref="S3.p2.1.m1.4.4.3.3.3.3.cmml">l</mi></msub><mo id="S3.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S3.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.4b"><apply id="S3.p2.1.m1.4.4.cmml" xref="S3.p2.1.m1.4.4"><eq id="S3.p2.1.m1.4.4.4.cmml" xref="S3.p2.1.m1.4.4.4"></eq><ci id="S3.p2.1.m1.4.4.5.cmml" xref="S3.p2.1.m1.4.4.5">𝑠</ci><set id="S3.p2.1.m1.4.4.3.4.cmml" xref="S3.p2.1.m1.4.4.3.3"><apply id="S3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.p2.1.m1.2.2.1.1.1.2">𝑣</ci><cn id="S3.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.p2.1.m1.3.3.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.p2.1.m1.3.3.2.2.2.2">𝑣</ci><cn id="S3.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">⋯</ci><apply id="S3.p2.1.m1.4.4.3.3.3.cmml" xref="S3.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.p2.1.m1.4.4.3.3.3.2">𝑣</ci><ci id="S3.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.p2.1.m1.4.4.3.3.3.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.4c">s=\{v_{1},v_{2},\cdots,v_{l}\}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.4d">italic_s = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT }</annotation></semantics></math>, the objective function of sequential recommender system <math alttext="f" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">f</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_f</annotation></semantics></math> is to maximize the corresponding likelihood defined as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\log p(v_{1},v_{2},\cdots,v_{l};f)=\sum_{j=1}^{l-1}\log f(v_{j+1}|v_{1},v_{2},%
\cdots,v_{j})." class="ltx_Math" display="block" id="S3.E1.m1.4"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><mrow id="S3.E1.m1.4.4.1.1.3.5" xref="S3.E1.m1.4.4.1.1.3.5.cmml"><mi id="S3.E1.m1.4.4.1.1.3.5.1" xref="S3.E1.m1.4.4.1.1.3.5.1.cmml">log</mi><mo id="S3.E1.m1.4.4.1.1.3.5a" lspace="0.167em" xref="S3.E1.m1.4.4.1.1.3.5.cmml">⁡</mo><mi id="S3.E1.m1.4.4.1.1.3.5.2" xref="S3.E1.m1.4.4.1.1.3.5.2.cmml">p</mi></mrow><mo id="S3.E1.m1.4.4.1.1.3.4" xref="S3.E1.m1.4.4.1.1.3.4.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.3.3.3" xref="S3.E1.m1.4.4.1.1.3.3.4.cmml"><mo id="S3.E1.m1.4.4.1.1.3.3.3.4" stretchy="false" xref="S3.E1.m1.4.4.1.1.3.3.4.cmml">(</mo><msub id="S3.E1.m1.4.4.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml">v</mi><mn id="S3.E1.m1.4.4.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.4.4.1.1.3.3.3.5" xref="S3.E1.m1.4.4.1.1.3.3.4.cmml">,</mo><msub id="S3.E1.m1.4.4.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.2.2.2.2.2" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml">v</mi><mn id="S3.E1.m1.4.4.1.1.2.2.2.2.3" xref="S3.E1.m1.4.4.1.1.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E1.m1.4.4.1.1.3.3.3.6" xref="S3.E1.m1.4.4.1.1.3.3.4.cmml">,</mo><mi id="S3.E1.m1.1.1" mathvariant="normal" xref="S3.E1.m1.1.1.cmml">⋯</mi><mo id="S3.E1.m1.4.4.1.1.3.3.3.7" xref="S3.E1.m1.4.4.1.1.3.3.4.cmml">,</mo><msub id="S3.E1.m1.4.4.1.1.3.3.3.3" xref="S3.E1.m1.4.4.1.1.3.3.3.3.cmml"><mi id="S3.E1.m1.4.4.1.1.3.3.3.3.2" xref="S3.E1.m1.4.4.1.1.3.3.3.3.2.cmml">v</mi><mi id="S3.E1.m1.4.4.1.1.3.3.3.3.3" xref="S3.E1.m1.4.4.1.1.3.3.3.3.3.cmml">l</mi></msub><mo id="S3.E1.m1.4.4.1.1.3.3.3.8" xref="S3.E1.m1.4.4.1.1.3.3.4.cmml">;</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">f</mi><mo id="S3.E1.m1.4.4.1.1.3.3.3.9" stretchy="false" xref="S3.E1.m1.4.4.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.5" rspace="0.111em" xref="S3.E1.m1.4.4.1.1.5.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.4" xref="S3.E1.m1.4.4.1.1.4.cmml"><munderover id="S3.E1.m1.4.4.1.1.4.2" xref="S3.E1.m1.4.4.1.1.4.2.cmml"><mo id="S3.E1.m1.4.4.1.1.4.2.2.2" movablelimits="false" xref="S3.E1.m1.4.4.1.1.4.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.4.4.1.1.4.2.2.3" xref="S3.E1.m1.4.4.1.1.4.2.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.4.2.2.3.2" xref="S3.E1.m1.4.4.1.1.4.2.2.3.2.cmml">j</mi><mo id="S3.E1.m1.4.4.1.1.4.2.2.3.1" xref="S3.E1.m1.4.4.1.1.4.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.4.4.1.1.4.2.2.3.3" xref="S3.E1.m1.4.4.1.1.4.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.4.4.1.1.4.2.3" xref="S3.E1.m1.4.4.1.1.4.2.3.cmml"><mi id="S3.E1.m1.4.4.1.1.4.2.3.2" xref="S3.E1.m1.4.4.1.1.4.2.3.2.cmml">l</mi><mo id="S3.E1.m1.4.4.1.1.4.2.3.1" xref="S3.E1.m1.4.4.1.1.4.2.3.1.cmml">−</mo><mn id="S3.E1.m1.4.4.1.1.4.2.3.3" xref="S3.E1.m1.4.4.1.1.4.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S3.E1.m1.4.4.1.1.4.1" xref="S3.E1.m1.4.4.1.1.4.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.4.1.3" xref="S3.E1.m1.4.4.1.1.4.1.3.cmml"><mi id="S3.E1.m1.4.4.1.1.4.1.3.1" xref="S3.E1.m1.4.4.1.1.4.1.3.1.cmml">log</mi><mo id="S3.E1.m1.4.4.1.1.4.1.3a" lspace="0.167em" xref="S3.E1.m1.4.4.1.1.4.1.3.cmml">⁡</mo><mi id="S3.E1.m1.4.4.1.1.4.1.3.2" xref="S3.E1.m1.4.4.1.1.4.1.3.2.cmml">f</mi></mrow><mo id="S3.E1.m1.4.4.1.1.4.1.2" xref="S3.E1.m1.4.4.1.1.4.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.1.1.4.1.1.1" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.cmml"><mo id="S3.E1.m1.4.4.1.1.4.1.1.1.2" stretchy="false" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.4.4.1.1.4.1.1.1.1" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.cmml"><msub id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.cmml"><mi id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.2" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.2.cmml">v</mi><mrow id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.cmml"><mi id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.2" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.2.cmml">j</mi><mo id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.1" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.1.cmml">+</mo><mn id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.3" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E1.m1.4.4.1.1.4.1.1.1.1.4" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.4.cmml">|</mo><mrow id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.4.cmml"><msub id="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.2.cmml">v</mi><mn id="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.4" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.cmml"><mi id="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.2" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.2.cmml">v</mi><mn id="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.3" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.5" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E1.m1.3.3" mathvariant="normal" xref="S3.E1.m1.3.3.cmml">⋯</mi><mo id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.6" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.cmml"><mi id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.2" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.2.cmml">v</mi><mi id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.3" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E1.m1.4.4.1.1.4.1.1.1.3" stretchy="false" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.4.4.1.2" lspace="0em" xref="S3.E1.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1"><eq id="S3.E1.m1.4.4.1.1.5.cmml" xref="S3.E1.m1.4.4.1.1.5"></eq><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><times id="S3.E1.m1.4.4.1.1.3.4.cmml" xref="S3.E1.m1.4.4.1.1.3.4"></times><apply id="S3.E1.m1.4.4.1.1.3.5.cmml" xref="S3.E1.m1.4.4.1.1.3.5"><log id="S3.E1.m1.4.4.1.1.3.5.1.cmml" xref="S3.E1.m1.4.4.1.1.3.5.1"></log><ci id="S3.E1.m1.4.4.1.1.3.5.2.cmml" xref="S3.E1.m1.4.4.1.1.3.5.2">𝑝</ci></apply><vector id="S3.E1.m1.4.4.1.1.3.3.4.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3"><apply id="S3.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1.1.2">𝑣</ci><cn id="S3.E1.m1.4.4.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E1.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.2.2.2.2.2">𝑣</ci><cn id="S3.E1.m1.4.4.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.2.2.2.2.3">2</cn></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">⋯</ci><apply id="S3.E1.m1.4.4.1.1.3.3.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.3.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.3.3.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.3.2">𝑣</ci><ci id="S3.E1.m1.4.4.1.1.3.3.3.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3.3.3.3">𝑙</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑓</ci></vector></apply><apply id="S3.E1.m1.4.4.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.4"><apply id="S3.E1.m1.4.4.1.1.4.2.cmml" xref="S3.E1.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.2.1.cmml" xref="S3.E1.m1.4.4.1.1.4.2">superscript</csymbol><apply id="S3.E1.m1.4.4.1.1.4.2.2.cmml" xref="S3.E1.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.4.2">subscript</csymbol><sum id="S3.E1.m1.4.4.1.1.4.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.4.2.2.2"></sum><apply id="S3.E1.m1.4.4.1.1.4.2.2.3.cmml" xref="S3.E1.m1.4.4.1.1.4.2.2.3"><eq id="S3.E1.m1.4.4.1.1.4.2.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.4.2.2.3.1"></eq><ci id="S3.E1.m1.4.4.1.1.4.2.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.4.2.2.3.2">𝑗</ci><cn id="S3.E1.m1.4.4.1.1.4.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.4.2.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.4.4.1.1.4.2.3.cmml" xref="S3.E1.m1.4.4.1.1.4.2.3"><minus id="S3.E1.m1.4.4.1.1.4.2.3.1.cmml" xref="S3.E1.m1.4.4.1.1.4.2.3.1"></minus><ci id="S3.E1.m1.4.4.1.1.4.2.3.2.cmml" xref="S3.E1.m1.4.4.1.1.4.2.3.2">𝑙</ci><cn id="S3.E1.m1.4.4.1.1.4.2.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.4.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.4.4.1.1.4.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1"><times id="S3.E1.m1.4.4.1.1.4.1.2.cmml" xref="S3.E1.m1.4.4.1.1.4.1.2"></times><apply id="S3.E1.m1.4.4.1.1.4.1.3.cmml" xref="S3.E1.m1.4.4.1.1.4.1.3"><log id="S3.E1.m1.4.4.1.1.4.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1.3.1"></log><ci id="S3.E1.m1.4.4.1.1.4.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.4.1.3.2">𝑓</ci></apply><apply id="S3.E1.m1.4.4.1.1.4.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.4.1.1.1.1.4.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.4">conditional</csymbol><apply id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.2.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.2">𝑣</ci><apply id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3"><plus id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.1"></plus><ci id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.2.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.2">𝑗</ci><cn id="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.5.3.3">1</cn></apply></apply><list id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.4.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3"><apply id="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.2">𝑣</ci><cn id="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.2">𝑣</ci><cn id="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">⋯</ci><apply id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.2">𝑣</ci><ci id="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.4.4.1.1.4.1.1.1.1.3.3.3.3">𝑗</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\log p(v_{1},v_{2},\cdots,v_{l};f)=\sum_{j=1}^{l-1}\log f(v_{j+1}|v_{1},v_{2},%
\cdots,v_{j}).</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.4d">roman_log italic_p ( italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ; italic_f ) = ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l - 1 end_POSTSUPERSCRIPT roman_log italic_f ( italic_v start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.4">Finally, the trained sequential recommender system <math alttext="f^{*}" class="ltx_Math" display="inline" id="S3.p2.3.m1.1"><semantics id="S3.p2.3.m1.1a"><msup id="S3.p2.3.m1.1.1" xref="S3.p2.3.m1.1.1.cmml"><mi id="S3.p2.3.m1.1.1.2" xref="S3.p2.3.m1.1.1.2.cmml">f</mi><mo id="S3.p2.3.m1.1.1.3" xref="S3.p2.3.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p2.3.m1.1b"><apply id="S3.p2.3.m1.1.1.cmml" xref="S3.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m1.1.1.1.cmml" xref="S3.p2.3.m1.1.1">superscript</csymbol><ci id="S3.p2.3.m1.1.1.2.cmml" xref="S3.p2.3.m1.1.1.2">𝑓</ci><times id="S3.p2.3.m1.1.1.3.cmml" xref="S3.p2.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m1.1c">f^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m1.1d">italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is optimized by maximizing the likelihood function over all the <math alttext="N" class="ltx_Math" display="inline" id="S3.p2.4.m2.1"><semantics id="S3.p2.4.m2.1a"><mi id="S3.p2.4.m2.1.1" xref="S3.p2.4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m2.1b"><ci id="S3.p2.4.m2.1.1.cmml" xref="S3.p2.4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m2.1d">italic_N</annotation></semantics></math> training interaction sequences, that is,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle f^{*}" class="ltx_Math" display="inline" id="S3.E2X.2.1.1.m1.1"><semantics id="S3.E2X.2.1.1.m1.1a"><msup id="S3.E2X.2.1.1.m1.1.1" xref="S3.E2X.2.1.1.m1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.1.1.2" xref="S3.E2X.2.1.1.m1.1.1.2.cmml">f</mi><mo id="S3.E2X.2.1.1.m1.1.1.3" xref="S3.E2X.2.1.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.1b"><apply id="S3.E2X.2.1.1.m1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E2X.2.1.1.m1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.1.1.2">𝑓</ci><times id="S3.E2X.2.1.1.m1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.1c">\displaystyle f^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.2.1.1.m1.1d">italic_f start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathop{\arg\max}\limits_{f}\sum_{i=1}^{N}\log p(s_{i};f)" class="ltx_Math" display="inline" id="S3.E2X.3.2.2.m1.2"><semantics id="S3.E2X.3.2.2.m1.2a"><mrow id="S3.E2X.3.2.2.m1.2.2" xref="S3.E2X.3.2.2.m1.2.2.cmml"><mi id="S3.E2X.3.2.2.m1.2.2.3" xref="S3.E2X.3.2.2.m1.2.2.3.cmml"></mi><mo id="S3.E2X.3.2.2.m1.2.2.2" xref="S3.E2X.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S3.E2X.3.2.2.m1.2.2.1" xref="S3.E2X.3.2.2.m1.2.2.1.cmml"><munder id="S3.E2X.3.2.2.m1.2.2.1.2" xref="S3.E2X.3.2.2.m1.2.2.1.2.cmml"><mrow id="S3.E2X.3.2.2.m1.2.2.1.2.2" xref="S3.E2X.3.2.2.m1.2.2.1.2.2.cmml"><mi id="S3.E2X.3.2.2.m1.2.2.1.2.2.1" xref="S3.E2X.3.2.2.m1.2.2.1.2.2.1.cmml">arg</mi><mo id="S3.E2X.3.2.2.m1.2.2.1.2.2a" lspace="0.167em" xref="S3.E2X.3.2.2.m1.2.2.1.2.2.cmml">⁡</mo><mi id="S3.E2X.3.2.2.m1.2.2.1.2.2.2" xref="S3.E2X.3.2.2.m1.2.2.1.2.2.2.cmml">max</mi></mrow><mi id="S3.E2X.3.2.2.m1.2.2.1.2.3" xref="S3.E2X.3.2.2.m1.2.2.1.2.3.cmml">f</mi></munder><mrow id="S3.E2X.3.2.2.m1.2.2.1.1" xref="S3.E2X.3.2.2.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S3.E2X.3.2.2.m1.2.2.1.1.2" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.cmml"><munderover id="S3.E2X.3.2.2.m1.2.2.1.1.2a" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.cmml"><mo id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.2" movablelimits="false" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.2" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.1" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.3" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2X.3.2.2.m1.2.2.1.1.2.3" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E2X.3.2.2.m1.2.2.1.1.1" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.cmml"><mrow id="S3.E2X.3.2.2.m1.2.2.1.1.1.3" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.3.cmml"><mi id="S3.E2X.3.2.2.m1.2.2.1.1.1.3.1" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.3.1.cmml">log</mi><mo id="S3.E2X.3.2.2.m1.2.2.1.1.1.3a" lspace="0.167em" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.3.cmml">⁡</mo><mi id="S3.E2X.3.2.2.m1.2.2.1.1.1.3.2" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.3.2.cmml">p</mi></mrow><mo id="S3.E2X.3.2.2.m1.2.2.1.1.1.2" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.2.cmml"><mo id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.2.cmml">(</mo><msub id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.2.cmml">;</mo><mi id="S3.E2X.3.2.2.m1.1.1" xref="S3.E2X.3.2.2.m1.1.1.cmml">f</mi><mo id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.4" stretchy="false" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.3.2.2.m1.2b"><apply id="S3.E2X.3.2.2.m1.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2"><eq id="S3.E2X.3.2.2.m1.2.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S3.E2X.3.2.2.m1.2.2.3.cmml" xref="S3.E2X.3.2.2.m1.2.2.3">absent</csymbol><apply id="S3.E2X.3.2.2.m1.2.2.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1"><apply id="S3.E2X.3.2.2.m1.2.2.1.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.2.2.1.2.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.2">subscript</csymbol><apply id="S3.E2X.3.2.2.m1.2.2.1.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.2.2"><arg id="S3.E2X.3.2.2.m1.2.2.1.2.2.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.2.2.1"></arg><max id="S3.E2X.3.2.2.m1.2.2.1.2.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.2.2.2"></max></apply><ci id="S3.E2X.3.2.2.m1.2.2.1.2.3.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.2.3">𝑓</ci></apply><apply id="S3.E2X.3.2.2.m1.2.2.1.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1"><apply id="S3.E2X.3.2.2.m1.2.2.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.2.2.1.1.2.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2">superscript</csymbol><apply id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2">subscript</csymbol><sum id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.2"></sum><apply id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3"><eq id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.1"></eq><ci id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.2">𝑖</ci><cn id="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.3.cmml" type="integer" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2X.3.2.2.m1.2.2.1.1.2.3.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.2.3">𝑁</ci></apply><apply id="S3.E2X.3.2.2.m1.2.2.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1"><times id="S3.E2X.3.2.2.m1.2.2.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.2"></times><apply id="S3.E2X.3.2.2.m1.2.2.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.3"><log id="S3.E2X.3.2.2.m1.2.2.1.1.1.3.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.3.1"></log><ci id="S3.E2X.3.2.2.m1.2.2.1.1.1.3.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.3.2">𝑝</ci></apply><list id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1"><apply id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2X.3.2.2.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E2X.3.2.2.m1.1.1.cmml" xref="S3.E2X.3.2.2.m1.1.1">𝑓</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.3.2.2.m1.2c">\displaystyle=\mathop{\arg\max}\limits_{f}\sum_{i=1}^{N}\log p(s_{i};f)</annotation><annotation encoding="application/x-llamapun" id="S3.E2X.3.2.2.m1.2d">= start_BIGOP roman_arg roman_max end_BIGOP start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT roman_log italic_p ( italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ; italic_f )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E2Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\mathop{\arg\max}\limits_{f}\sum_{i=1}^{N}\sum_{j=1}^{|s_{j}|-1}%
\log f(v_{j+1}|v_{1},v_{2},\cdots,v_{j})." class="ltx_Math" display="inline" id="S3.E2Xa.2.1.1.m1.3"><semantics id="S3.E2Xa.2.1.1.m1.3a"><mrow id="S3.E2Xa.2.1.1.m1.3.3.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.3.cmml"></mi><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.cmml"><munder id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.cmml"><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.1.cmml">arg</mi><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2a" lspace="0.167em" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.cmml">⁡</mo><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.2.cmml">max</mi></mrow><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.3.cmml">f</mi></munder><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml"><munderover id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2a" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml"><munderover id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2a" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E2Xa.2.1.1.m1.1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.1.cmml"><mrow id="S3.E2Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.2.cmml"><mo id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.E2Xa.2.1.1.m1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.1.1.1.2.cmml">−</mo><mn id="S3.E2Xa.2.1.1.m1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.1.1.1.3.cmml">1</mn></mrow></munderover></mstyle><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.cmml">f</mi></mrow><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.2.cmml">v</mi><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.2.cmml">j</mi><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.1.cmml">+</mo><mn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.4.cmml"><msub id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E2Xa.2.1.1.m1.2.2" mathvariant="normal" xref="S3.E2Xa.2.1.1.m1.2.2.cmml">⋯</mi><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.6" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">v</mi><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2Xa.2.1.1.m1.3.3.1.2" lspace="0em" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.2.1.1.m1.3b"><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1"><eq id="S3.E2Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.2"></eq><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.3">absent</csymbol><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1"><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2">subscript</csymbol><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2"><arg id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.1"></arg><max id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.2.2"></max></apply><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.2.3">𝑓</ci></apply><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1"><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1"><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.2"></sum><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3"><eq id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E2Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1"><minus id="S3.E2Xa.2.1.1.m1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.2"></minus><apply id="S3.E2Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1"><abs id="S3.E2Xa.2.1.1.m1.1.1.1.1.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.2"></abs><apply id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><cn id="S3.E2Xa.2.1.1.m1.1.1.1.3.cmml" type="integer" xref="S3.E2Xa.2.1.1.m1.1.1.1.3">1</cn></apply></apply><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1"><times id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2"></times><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3"><log id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.1"></log><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3.2">𝑓</ci></apply><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.2">𝑣</ci><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3"><plus id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.1"></plus><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.2">𝑗</ci><cn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.3.cmml" type="integer" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.5.3.3">1</cn></apply></apply><list id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3"><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑣</ci><cn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.2">𝑣</ci><cn id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E2Xa.2.1.1.m1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2">⋯</ci><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.2">𝑣</ci><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.3.3.3.3">𝑗</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.2.1.1.m1.3c">\displaystyle=\mathop{\arg\max}\limits_{f}\sum_{i=1}^{N}\sum_{j=1}^{|s_{j}|-1}%
\log f(v_{j+1}|v_{1},v_{2},\cdots,v_{j}).</annotation><annotation encoding="application/x-llamapun" id="S3.E2Xa.2.1.1.m1.3d">= start_BIGOP roman_arg roman_max end_BIGOP start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_s start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT | - 1 end_POSTSUPERSCRIPT roman_log italic_f ( italic_v start_POSTSUBSCRIPT italic_j + 1 end_POSTSUBSCRIPT | italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_v start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.3"><span class="ltx_text ltx_font_bold" id="S3.p3.3.1">Large Language Model.</span> Transformer-based models with billions learnable parameters trained on large scale corpora <cite class="ltx_cite ltx_citemacro_citep">(Radford et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib33" title="">2023</a>; Gomez-Uribe and Hunt, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib10" title="">2016</a>; Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib41" title="">2023</a>)</cite>, i.e., large language models (LLMs), have presented astonishing capabilities in natural language understanding and logical reasoning based on learned knowledge. The mainstream LLMs mostly belong to the decoder-only architecture with superior generative ability <cite class="ltx_cite ltx_citemacro_citep">(Radford et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib33" title="">2023</a>)</cite>, which consists of a token embedding layer, a single decoder module, and a correlated tokenizer. Given a natural language sentence <math alttext="s=\{w_{1},w_{2},\cdots\}" class="ltx_Math" display="inline" id="S3.p3.1.m1.3"><semantics id="S3.p3.1.m1.3a"><mrow id="S3.p3.1.m1.3.3" xref="S3.p3.1.m1.3.3.cmml"><mi id="S3.p3.1.m1.3.3.4" xref="S3.p3.1.m1.3.3.4.cmml">s</mi><mo id="S3.p3.1.m1.3.3.3" xref="S3.p3.1.m1.3.3.3.cmml">=</mo><mrow id="S3.p3.1.m1.3.3.2.2" xref="S3.p3.1.m1.3.3.2.3.cmml"><mo id="S3.p3.1.m1.3.3.2.2.3" stretchy="false" xref="S3.p3.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.p3.1.m1.2.2.1.1.1" xref="S3.p3.1.m1.2.2.1.1.1.cmml"><mi id="S3.p3.1.m1.2.2.1.1.1.2" xref="S3.p3.1.m1.2.2.1.1.1.2.cmml">w</mi><mn id="S3.p3.1.m1.2.2.1.1.1.3" xref="S3.p3.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p3.1.m1.3.3.2.2.4" xref="S3.p3.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.p3.1.m1.3.3.2.2.2" xref="S3.p3.1.m1.3.3.2.2.2.cmml"><mi id="S3.p3.1.m1.3.3.2.2.2.2" xref="S3.p3.1.m1.3.3.2.2.2.2.cmml">w</mi><mn id="S3.p3.1.m1.3.3.2.2.2.3" xref="S3.p3.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.p3.1.m1.3.3.2.2.5" xref="S3.p3.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.p3.1.m1.1.1" mathvariant="normal" xref="S3.p3.1.m1.1.1.cmml">⋯</mi><mo id="S3.p3.1.m1.3.3.2.2.6" stretchy="false" xref="S3.p3.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.3b"><apply id="S3.p3.1.m1.3.3.cmml" xref="S3.p3.1.m1.3.3"><eq id="S3.p3.1.m1.3.3.3.cmml" xref="S3.p3.1.m1.3.3.3"></eq><ci id="S3.p3.1.m1.3.3.4.cmml" xref="S3.p3.1.m1.3.3.4">𝑠</ci><set id="S3.p3.1.m1.3.3.2.3.cmml" xref="S3.p3.1.m1.3.3.2.2"><apply id="S3.p3.1.m1.2.2.1.1.1.cmml" xref="S3.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.p3.1.m1.2.2.1.1.1.2">𝑤</ci><cn id="S3.p3.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.p3.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.p3.1.m1.3.3.2.2.2.cmml" xref="S3.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p3.1.m1.3.3.2.2.2.1.cmml" xref="S3.p3.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.p3.1.m1.3.3.2.2.2.2">𝑤</ci><cn id="S3.p3.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.p3.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">⋯</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.3c">s=\{w_{1},w_{2},\cdots\}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.3d">italic_s = { italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ }</annotation></semantics></math>, the tokenizer first converts the sentence into sequence of token index <math alttext="t_{i}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">t</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝑡</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">t_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> whose corresponding word <math alttext="w_{i}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><msub id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">w</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝑤</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">w_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is included in the LLM vocabulary, formulated as follows,</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S3.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle t=\{t_{1},t_{2},\cdots\}" class="ltx_Math" display="inline" id="S3.E3X.2.1.1.m1.3"><semantics id="S3.E3X.2.1.1.m1.3a"><mrow id="S3.E3X.2.1.1.m1.3.3" xref="S3.E3X.2.1.1.m1.3.3.cmml"><mi id="S3.E3X.2.1.1.m1.3.3.4" xref="S3.E3X.2.1.1.m1.3.3.4.cmml">t</mi><mo id="S3.E3X.2.1.1.m1.3.3.3" xref="S3.E3X.2.1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.E3X.2.1.1.m1.3.3.2.2" xref="S3.E3X.2.1.1.m1.3.3.2.3.cmml"><mo id="S3.E3X.2.1.1.m1.3.3.2.2.3" stretchy="false" xref="S3.E3X.2.1.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.E3X.2.1.1.m1.2.2.1.1.1" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.2.2.1.1.1.2" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.2.cmml">t</mi><mn id="S3.E3X.2.1.1.m1.2.2.1.1.1.3" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.E3X.2.1.1.m1.3.3.2.2.4" xref="S3.E3X.2.1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.E3X.2.1.1.m1.3.3.2.2.2" xref="S3.E3X.2.1.1.m1.3.3.2.2.2.cmml"><mi id="S3.E3X.2.1.1.m1.3.3.2.2.2.2" xref="S3.E3X.2.1.1.m1.3.3.2.2.2.2.cmml">t</mi><mn id="S3.E3X.2.1.1.m1.3.3.2.2.2.3" xref="S3.E3X.2.1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.E3X.2.1.1.m1.3.3.2.2.5" xref="S3.E3X.2.1.1.m1.3.3.2.3.cmml">,</mo><mi id="S3.E3X.2.1.1.m1.1.1" mathvariant="normal" xref="S3.E3X.2.1.1.m1.1.1.cmml">⋯</mi><mo id="S3.E3X.2.1.1.m1.3.3.2.2.6" stretchy="false" xref="S3.E3X.2.1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.3b"><apply id="S3.E3X.2.1.1.m1.3.3.cmml" xref="S3.E3X.2.1.1.m1.3.3"><eq id="S3.E3X.2.1.1.m1.3.3.3.cmml" xref="S3.E3X.2.1.1.m1.3.3.3"></eq><ci id="S3.E3X.2.1.1.m1.3.3.4.cmml" xref="S3.E3X.2.1.1.m1.3.3.4">𝑡</ci><set id="S3.E3X.2.1.1.m1.3.3.2.3.cmml" xref="S3.E3X.2.1.1.m1.3.3.2.2"><apply id="S3.E3X.2.1.1.m1.2.2.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.2">𝑡</ci><cn id="S3.E3X.2.1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.E3X.2.1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.E3X.2.1.1.m1.3.3.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.3.3.2.2.2.1.cmml" xref="S3.E3X.2.1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.3.3.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.3.3.2.2.2.2">𝑡</ci><cn id="S3.E3X.2.1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.E3X.2.1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1">⋯</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.3c">\displaystyle t=\{t_{1},t_{2},\cdots\}</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.2.1.1.m1.3d">italic_t = { italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ }</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle={\rm Tokenizer}(s)" class="ltx_Math" display="inline" id="S3.E3X.3.2.2.m1.1"><semantics id="S3.E3X.3.2.2.m1.1a"><mrow id="S3.E3X.3.2.2.m1.1.2" xref="S3.E3X.3.2.2.m1.1.2.cmml"><mi id="S3.E3X.3.2.2.m1.1.2.2" xref="S3.E3X.3.2.2.m1.1.2.2.cmml"></mi><mo id="S3.E3X.3.2.2.m1.1.2.1" xref="S3.E3X.3.2.2.m1.1.2.1.cmml">=</mo><mrow id="S3.E3X.3.2.2.m1.1.2.3" xref="S3.E3X.3.2.2.m1.1.2.3.cmml"><mi id="S3.E3X.3.2.2.m1.1.2.3.2" xref="S3.E3X.3.2.2.m1.1.2.3.2.cmml">Tokenizer</mi><mo id="S3.E3X.3.2.2.m1.1.2.3.1" xref="S3.E3X.3.2.2.m1.1.2.3.1.cmml">⁢</mo><mrow id="S3.E3X.3.2.2.m1.1.2.3.3.2" xref="S3.E3X.3.2.2.m1.1.2.3.cmml"><mo id="S3.E3X.3.2.2.m1.1.2.3.3.2.1" stretchy="false" xref="S3.E3X.3.2.2.m1.1.2.3.cmml">(</mo><mi id="S3.E3X.3.2.2.m1.1.1" xref="S3.E3X.3.2.2.m1.1.1.cmml">s</mi><mo id="S3.E3X.3.2.2.m1.1.2.3.3.2.2" stretchy="false" xref="S3.E3X.3.2.2.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.3.2.2.m1.1b"><apply id="S3.E3X.3.2.2.m1.1.2.cmml" xref="S3.E3X.3.2.2.m1.1.2"><eq id="S3.E3X.3.2.2.m1.1.2.1.cmml" xref="S3.E3X.3.2.2.m1.1.2.1"></eq><csymbol cd="latexml" id="S3.E3X.3.2.2.m1.1.2.2.cmml" xref="S3.E3X.3.2.2.m1.1.2.2">absent</csymbol><apply id="S3.E3X.3.2.2.m1.1.2.3.cmml" xref="S3.E3X.3.2.2.m1.1.2.3"><times id="S3.E3X.3.2.2.m1.1.2.3.1.cmml" xref="S3.E3X.3.2.2.m1.1.2.3.1"></times><ci id="S3.E3X.3.2.2.m1.1.2.3.2.cmml" xref="S3.E3X.3.2.2.m1.1.2.3.2">Tokenizer</ci><ci id="S3.E3X.3.2.2.m1.1.1.cmml" xref="S3.E3X.3.2.2.m1.1.1">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.3.2.2.m1.1c">\displaystyle={\rm Tokenizer}(s)</annotation><annotation encoding="application/x-llamapun" id="S3.E3X.3.2.2.m1.1d">= roman_Tokenizer ( italic_s )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S3.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\{{\rm Tokenizer}(w_{1}),{\rm Tokenizer}(w_{2}),\cdots\}." class="ltx_Math" display="inline" id="S3.E3Xa.2.1.1.m1.2"><semantics id="S3.E3Xa.2.1.1.m1.2a"><mrow id="S3.E3Xa.2.1.1.m1.2.2.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.4" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4.cmml"></mi><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml"><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.3" stretchy="false" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml">{</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml">Tokenizer</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">w</mi><mn id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.4" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml">,</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.3.cmml">Tokenizer</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.cmml">(</mo><msub id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.2.cmml">w</mi><mn id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.3.cmml">2</mn></msub><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.5" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml">,</mo><mi id="S3.E3Xa.2.1.1.m1.1.1" mathvariant="normal" xref="S3.E3Xa.2.1.1.m1.1.1.cmml">⋯</mi><mo id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.6" stretchy="false" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml">}</mo></mrow></mrow><mo id="S3.E3Xa.2.1.1.m1.2.2.1.2" lspace="0em" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.2b"><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1"><eq id="S3.E3Xa.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.3"></eq><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.2.2.1.1.4.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.4">absent</csymbol><set id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2"><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1"><times id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.2"></times><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.3">Tokenizer</ci><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.2">𝑤</ci><cn id="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2"><times id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.2"></times><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.3">Tokenizer</ci><apply id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.2">𝑤</ci><cn id="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.3.cmml" type="integer" xref="S3.E3Xa.2.1.1.m1.2.2.1.1.2.2.2.1.1.1.3">2</cn></apply></apply><ci id="S3.E3Xa.2.1.1.m1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1">⋯</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.2c">\displaystyle=\{{\rm Tokenizer}(w_{1}),{\rm Tokenizer}(w_{2}),\cdots\}.</annotation><annotation encoding="application/x-llamapun" id="S3.E3Xa.2.1.1.m1.2d">= { roman_Tokenizer ( italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , roman_Tokenizer ( italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , ⋯ } .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S3.p3.10">Then, the token index sequence is fed into the token embedding layer and projected into continuous latent space, by the table look-up operation as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h={\rm Embed\_Token}(t)={\rm One\_Hot}(t)\cdot E," class="ltx_Math" display="block" id="S3.E4.m1.3"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.1.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml">h</mi><mo id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.4" xref="S3.E4.m1.3.3.1.1.4.cmml"><mi id="S3.E4.m1.3.3.1.1.4.2" xref="S3.E4.m1.3.3.1.1.4.2.cmml">Embed</mi><mo id="S3.E4.m1.3.3.1.1.4.1" xref="S3.E4.m1.3.3.1.1.4.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.4.3" mathvariant="normal" xref="S3.E4.m1.3.3.1.1.4.3.cmml">_</mi><mo id="S3.E4.m1.3.3.1.1.4.1a" xref="S3.E4.m1.3.3.1.1.4.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.4.4" xref="S3.E4.m1.3.3.1.1.4.4.cmml">Token</mi><mo id="S3.E4.m1.3.3.1.1.4.1b" xref="S3.E4.m1.3.3.1.1.4.1.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.4.5.2" xref="S3.E4.m1.3.3.1.1.4.cmml"><mo id="S3.E4.m1.3.3.1.1.4.5.2.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.4.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.4.5.2.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.4.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.5" xref="S3.E4.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E4.m1.3.3.1.1.6" xref="S3.E4.m1.3.3.1.1.6.cmml"><mrow id="S3.E4.m1.3.3.1.1.6.2" xref="S3.E4.m1.3.3.1.1.6.2.cmml"><mi id="S3.E4.m1.3.3.1.1.6.2.2" xref="S3.E4.m1.3.3.1.1.6.2.2.cmml">One</mi><mo id="S3.E4.m1.3.3.1.1.6.2.1" xref="S3.E4.m1.3.3.1.1.6.2.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.6.2.3" mathvariant="normal" xref="S3.E4.m1.3.3.1.1.6.2.3.cmml">_</mi><mo id="S3.E4.m1.3.3.1.1.6.2.1a" xref="S3.E4.m1.3.3.1.1.6.2.1.cmml">⁢</mo><mi id="S3.E4.m1.3.3.1.1.6.2.4" xref="S3.E4.m1.3.3.1.1.6.2.4.cmml">Hot</mi><mo id="S3.E4.m1.3.3.1.1.6.2.1b" xref="S3.E4.m1.3.3.1.1.6.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.6.2.5.2" xref="S3.E4.m1.3.3.1.1.6.2.cmml"><mo id="S3.E4.m1.3.3.1.1.6.2.5.2.1" stretchy="false" xref="S3.E4.m1.3.3.1.1.6.2.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.6.2.5.2.2" rspace="0.055em" stretchy="false" xref="S3.E4.m1.3.3.1.1.6.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.1.1.6.1" rspace="0.222em" xref="S3.E4.m1.3.3.1.1.6.1.cmml">⋅</mo><mi id="S3.E4.m1.3.3.1.1.6.3" xref="S3.E4.m1.3.3.1.1.6.3.cmml">E</mi></mrow></mrow><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1"><and id="S3.E4.m1.3.3.1.1a.cmml" xref="S3.E4.m1.3.3.1"></and><apply id="S3.E4.m1.3.3.1.1b.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.3"></eq><ci id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2">ℎ</ci><apply id="S3.E4.m1.3.3.1.1.4.cmml" xref="S3.E4.m1.3.3.1.1.4"><times id="S3.E4.m1.3.3.1.1.4.1.cmml" xref="S3.E4.m1.3.3.1.1.4.1"></times><ci id="S3.E4.m1.3.3.1.1.4.2.cmml" xref="S3.E4.m1.3.3.1.1.4.2">Embed</ci><ci id="S3.E4.m1.3.3.1.1.4.3.cmml" xref="S3.E4.m1.3.3.1.1.4.3">_</ci><ci id="S3.E4.m1.3.3.1.1.4.4.cmml" xref="S3.E4.m1.3.3.1.1.4.4">Token</ci><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑡</ci></apply></apply><apply id="S3.E4.m1.3.3.1.1c.cmml" xref="S3.E4.m1.3.3.1"><eq id="S3.E4.m1.3.3.1.1.5.cmml" xref="S3.E4.m1.3.3.1.1.5"></eq><share href="https://arxiv.org/html/2409.09253v1#S3.E4.m1.3.3.1.1.4.cmml" id="S3.E4.m1.3.3.1.1d.cmml" xref="S3.E4.m1.3.3.1"></share><apply id="S3.E4.m1.3.3.1.1.6.cmml" xref="S3.E4.m1.3.3.1.1.6"><ci id="S3.E4.m1.3.3.1.1.6.1.cmml" xref="S3.E4.m1.3.3.1.1.6.1">⋅</ci><apply id="S3.E4.m1.3.3.1.1.6.2.cmml" xref="S3.E4.m1.3.3.1.1.6.2"><times id="S3.E4.m1.3.3.1.1.6.2.1.cmml" xref="S3.E4.m1.3.3.1.1.6.2.1"></times><ci id="S3.E4.m1.3.3.1.1.6.2.2.cmml" xref="S3.E4.m1.3.3.1.1.6.2.2">One</ci><ci id="S3.E4.m1.3.3.1.1.6.2.3.cmml" xref="S3.E4.m1.3.3.1.1.6.2.3">_</ci><ci id="S3.E4.m1.3.3.1.1.6.2.4.cmml" xref="S3.E4.m1.3.3.1.1.6.2.4">Hot</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑡</ci></apply><ci id="S3.E4.m1.3.3.1.1.6.3.cmml" xref="S3.E4.m1.3.3.1.1.6.3">𝐸</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">h={\rm Embed\_Token}(t)={\rm One\_Hot}(t)\cdot E,</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.3d">italic_h = roman_Embed _ roman_Token ( italic_t ) = roman_One _ roman_Hot ( italic_t ) ⋅ italic_E ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\rm One\_Hot}(t)\in\{0,1,\cdots,|\mathcal{V}|-1\}^{L\times|\mathcal{V}|},E\in
R%
^{|\mathcal{V}|\times d}," class="ltx_Math" display="block" id="S3.Ex1.m1.8"><semantics id="S3.Ex1.m1.8a"><mrow id="S3.Ex1.m1.8.8.1"><mrow id="S3.Ex1.m1.8.8.1.1.2" xref="S3.Ex1.m1.8.8.1.1.3.cmml"><mrow id="S3.Ex1.m1.8.8.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.8.8.1.1.1.1.3" xref="S3.Ex1.m1.8.8.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.8.8.1.1.1.1.3.2" xref="S3.Ex1.m1.8.8.1.1.1.1.3.2.cmml">One</mi><mo id="S3.Ex1.m1.8.8.1.1.1.1.3.1" xref="S3.Ex1.m1.8.8.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.8.8.1.1.1.1.3.3" mathvariant="normal" xref="S3.Ex1.m1.8.8.1.1.1.1.3.3.cmml">_</mi><mo id="S3.Ex1.m1.8.8.1.1.1.1.3.1a" xref="S3.Ex1.m1.8.8.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex1.m1.8.8.1.1.1.1.3.4" xref="S3.Ex1.m1.8.8.1.1.1.1.3.4.cmml">Hot</mi><mo id="S3.Ex1.m1.8.8.1.1.1.1.3.1b" xref="S3.Ex1.m1.8.8.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.8.8.1.1.1.1.3.5.2" xref="S3.Ex1.m1.8.8.1.1.1.1.3.cmml"><mo id="S3.Ex1.m1.8.8.1.1.1.1.3.5.2.1" stretchy="false" xref="S3.Ex1.m1.8.8.1.1.1.1.3.cmml">(</mo><mi id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml">t</mi><mo id="S3.Ex1.m1.8.8.1.1.1.1.3.5.2.2" stretchy="false" xref="S3.Ex1.m1.8.8.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.8.8.1.1.1.1.2" xref="S3.Ex1.m1.8.8.1.1.1.1.2.cmml">∈</mo><msup id="S3.Ex1.m1.8.8.1.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml">{</mo><mn id="S3.Ex1.m1.4.4" xref="S3.Ex1.m1.4.4.cmml">0</mn><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml">,</mo><mn id="S3.Ex1.m1.5.5" xref="S3.Ex1.m1.5.5.cmml">1</mn><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.4" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex1.m1.6.6" mathvariant="normal" xref="S3.Ex1.m1.6.6.cmml">⋯</mi><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.5" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml"><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.2.1" stretchy="false" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.7.7" xref="S3.Ex1.m1.7.7.cmml">𝒱</mi><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.2.2" stretchy="false" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.6" stretchy="false" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.3.cmml">L</mi><mo id="S3.Ex1.m1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.Ex1.m1.1.1.1.2.cmml">×</mo><mrow id="S3.Ex1.m1.1.1.1.4.2" xref="S3.Ex1.m1.1.1.1.4.1.cmml"><mo id="S3.Ex1.m1.1.1.1.4.2.1" stretchy="false" xref="S3.Ex1.m1.1.1.1.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml">𝒱</mi><mo id="S3.Ex1.m1.1.1.1.4.2.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.4.1.1.cmml">|</mo></mrow></mrow></msup></mrow><mo id="S3.Ex1.m1.8.8.1.1.2.3" xref="S3.Ex1.m1.8.8.1.1.3a.cmml">,</mo><mrow id="S3.Ex1.m1.8.8.1.1.2.2" xref="S3.Ex1.m1.8.8.1.1.2.2.cmml"><mi id="S3.Ex1.m1.8.8.1.1.2.2.2" xref="S3.Ex1.m1.8.8.1.1.2.2.2.cmml">E</mi><mo id="S3.Ex1.m1.8.8.1.1.2.2.1" xref="S3.Ex1.m1.8.8.1.1.2.2.1.cmml">∈</mo><msup id="S3.Ex1.m1.8.8.1.1.2.2.3" xref="S3.Ex1.m1.8.8.1.1.2.2.3.cmml"><mi id="S3.Ex1.m1.8.8.1.1.2.2.3.2" xref="S3.Ex1.m1.8.8.1.1.2.2.3.2.cmml">R</mi><mrow id="S3.Ex1.m1.2.2.1" xref="S3.Ex1.m1.2.2.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.3.2" xref="S3.Ex1.m1.2.2.1.3.1.cmml"><mo id="S3.Ex1.m1.2.2.1.3.2.1" stretchy="false" xref="S3.Ex1.m1.2.2.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.1.cmml">𝒱</mi><mo id="S3.Ex1.m1.2.2.1.3.2.2" rspace="0.055em" stretchy="false" xref="S3.Ex1.m1.2.2.1.3.1.1.cmml">|</mo></mrow><mo id="S3.Ex1.m1.2.2.1.2" rspace="0.222em" xref="S3.Ex1.m1.2.2.1.2.cmml">×</mo><mi id="S3.Ex1.m1.2.2.1.4" xref="S3.Ex1.m1.2.2.1.4.cmml">d</mi></mrow></msup></mrow></mrow><mo id="S3.Ex1.m1.8.8.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.8b"><apply id="S3.Ex1.m1.8.8.1.1.3.cmml" xref="S3.Ex1.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.1.1.3a.cmml" xref="S3.Ex1.m1.8.8.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex1.m1.8.8.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1"><in id="S3.Ex1.m1.8.8.1.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.2"></in><apply id="S3.Ex1.m1.8.8.1.1.1.1.3.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.3"><times id="S3.Ex1.m1.8.8.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.3.1"></times><ci id="S3.Ex1.m1.8.8.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.3.2">One</ci><ci id="S3.Ex1.m1.8.8.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.3.3">_</ci><ci id="S3.Ex1.m1.8.8.1.1.1.1.3.4.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.3.4">Hot</ci><ci id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3">𝑡</ci></apply><apply id="S3.Ex1.m1.8.8.1.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1">superscript</csymbol><set id="S3.Ex1.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1"><cn id="S3.Ex1.m1.4.4.cmml" type="integer" xref="S3.Ex1.m1.4.4">0</cn><cn id="S3.Ex1.m1.5.5.cmml" type="integer" xref="S3.Ex1.m1.5.5">1</cn><ci id="S3.Ex1.m1.6.6.cmml" xref="S3.Ex1.m1.6.6">⋯</ci><apply id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1"><minus id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.2"><abs id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.2.2.1"></abs><ci id="S3.Ex1.m1.7.7.cmml" xref="S3.Ex1.m1.7.7">𝒱</ci></apply><cn id="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex1.m1.8.8.1.1.1.1.1.1.1.1.3">1</cn></apply></set><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><times id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3">𝐿</ci><apply id="S3.Ex1.m1.1.1.1.4.1.cmml" xref="S3.Ex1.m1.1.1.1.4.2"><abs id="S3.Ex1.m1.1.1.1.4.1.1.cmml" xref="S3.Ex1.m1.1.1.1.4.2.1"></abs><ci id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1">𝒱</ci></apply></apply></apply></apply><apply id="S3.Ex1.m1.8.8.1.1.2.2.cmml" xref="S3.Ex1.m1.8.8.1.1.2.2"><in id="S3.Ex1.m1.8.8.1.1.2.2.1.cmml" xref="S3.Ex1.m1.8.8.1.1.2.2.1"></in><ci id="S3.Ex1.m1.8.8.1.1.2.2.2.cmml" xref="S3.Ex1.m1.8.8.1.1.2.2.2">𝐸</ci><apply id="S3.Ex1.m1.8.8.1.1.2.2.3.cmml" xref="S3.Ex1.m1.8.8.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.8.8.1.1.2.2.3.1.cmml" xref="S3.Ex1.m1.8.8.1.1.2.2.3">superscript</csymbol><ci id="S3.Ex1.m1.8.8.1.1.2.2.3.2.cmml" xref="S3.Ex1.m1.8.8.1.1.2.2.3.2">𝑅</ci><apply id="S3.Ex1.m1.2.2.1.cmml" xref="S3.Ex1.m1.2.2.1"><times id="S3.Ex1.m1.2.2.1.2.cmml" xref="S3.Ex1.m1.2.2.1.2"></times><apply id="S3.Ex1.m1.2.2.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.3.2"><abs id="S3.Ex1.m1.2.2.1.3.1.1.cmml" xref="S3.Ex1.m1.2.2.1.3.2.1"></abs><ci id="S3.Ex1.m1.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1">𝒱</ci></apply><ci id="S3.Ex1.m1.2.2.1.4.cmml" xref="S3.Ex1.m1.2.2.1.4">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.8c">{\rm One\_Hot}(t)\in\{0,1,\cdots,|\mathcal{V}|-1\}^{L\times|\mathcal{V}|},E\in
R%
^{|\mathcal{V}|\times d},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.8d">roman_One _ roman_Hot ( italic_t ) ∈ { 0 , 1 , ⋯ , | caligraphic_V | - 1 } start_POSTSUPERSCRIPT italic_L × | caligraphic_V | end_POSTSUPERSCRIPT , italic_E ∈ italic_R start_POSTSUPERSCRIPT | caligraphic_V | × italic_d end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.9">where <math alttext="E" class="ltx_Math" display="inline" id="S3.p3.4.m1.1"><semantics id="S3.p3.4.m1.1a"><mi id="S3.p3.4.m1.1.1" xref="S3.p3.4.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m1.1b"><ci id="S3.p3.4.m1.1.1.cmml" xref="S3.p3.4.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m1.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m1.1d">italic_E</annotation></semantics></math> is the token embedding table, <math alttext="L" class="ltx_Math" display="inline" id="S3.p3.5.m2.1"><semantics id="S3.p3.5.m2.1a"><mi id="S3.p3.5.m2.1.1" xref="S3.p3.5.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p3.5.m2.1b"><ci id="S3.p3.5.m2.1.1.cmml" xref="S3.p3.5.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m2.1d">italic_L</annotation></semantics></math> is the token sequence length, <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.p3.6.m3.1"><semantics id="S3.p3.6.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p3.6.m3.1.1" xref="S3.p3.6.m3.1.1.cmml">𝒱</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m3.1b"><ci id="S3.p3.6.m3.1.1.cmml" xref="S3.p3.6.m3.1.1">𝒱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m3.1c">\mathcal{V}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m3.1d">caligraphic_V</annotation></semantics></math> is the LLM vocabulary, and <math alttext="d" class="ltx_Math" display="inline" id="S3.p3.7.m4.1"><semantics id="S3.p3.7.m4.1a"><mi id="S3.p3.7.m4.1.1" xref="S3.p3.7.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.p3.7.m4.1b"><ci id="S3.p3.7.m4.1.1.cmml" xref="S3.p3.7.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m4.1c">d</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m4.1d">italic_d</annotation></semantics></math> is the latent space dimension. Eventually, the continuous embedding <math alttext="h" class="ltx_Math" display="inline" id="S3.p3.8.m5.1"><semantics id="S3.p3.8.m5.1a"><mi id="S3.p3.8.m5.1.1" xref="S3.p3.8.m5.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.p3.8.m5.1b"><ci id="S3.p3.8.m5.1.1.cmml" xref="S3.p3.8.m5.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m5.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m5.1d">italic_h</annotation></semantics></math> forward through the LLM decoder module. In addition, for the LLM aiming at generation task, a language model head is appended to transform the final representation <math alttext="h^{\prime}" class="ltx_Math" display="inline" id="S3.p3.9.m6.1"><semantics id="S3.p3.9.m6.1a"><msup id="S3.p3.9.m6.1.1" xref="S3.p3.9.m6.1.1.cmml"><mi id="S3.p3.9.m6.1.1.2" xref="S3.p3.9.m6.1.1.2.cmml">h</mi><mo id="S3.p3.9.m6.1.1.3" xref="S3.p3.9.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p3.9.m6.1b"><apply id="S3.p3.9.m6.1.1.cmml" xref="S3.p3.9.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m6.1.1.1.cmml" xref="S3.p3.9.m6.1.1">superscript</csymbol><ci id="S3.p3.9.m6.1.1.2.cmml" xref="S3.p3.9.m6.1.1.2">ℎ</ci><ci id="S3.p3.9.m6.1.1.3.cmml" xref="S3.p3.9.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m6.1c">h^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m6.1d">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> back into the token index space, as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h^{\prime}={\rm Decoder}(h),t^{\prime}={\rm LM\_Head}(h^{\prime})." class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1"><mrow id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.3.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><msup id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.2.2.cmml">h</mi><mo id="S3.E5.m1.2.2.1.1.1.1.2.3" xref="S3.E5.m1.2.2.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.2.cmml">Decoder</mi><mo id="S3.E5.m1.2.2.1.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.3.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">h</mi><mo id="S3.E5.m1.2.2.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.2.3" xref="S3.E5.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S3.E5.m1.2.2.1.1.2.2" xref="S3.E5.m1.2.2.1.1.2.2.cmml"><msup id="S3.E5.m1.2.2.1.1.2.2.3" xref="S3.E5.m1.2.2.1.1.2.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.3.2" xref="S3.E5.m1.2.2.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E5.m1.2.2.1.1.2.2.3.3" xref="S3.E5.m1.2.2.1.1.2.2.3.3.cmml">′</mo></msup><mo id="S3.E5.m1.2.2.1.1.2.2.2" xref="S3.E5.m1.2.2.1.1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.1" xref="S3.E5.m1.2.2.1.1.2.2.1.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.1.3" xref="S3.E5.m1.2.2.1.1.2.2.1.3.cmml">LM</mi><mo id="S3.E5.m1.2.2.1.1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.2.2.1.4" mathvariant="normal" xref="S3.E5.m1.2.2.1.1.2.2.1.4.cmml">_</mi><mo id="S3.E5.m1.2.2.1.1.2.2.1.2a" xref="S3.E5.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.2.2.1.5" xref="S3.E5.m1.2.2.1.1.2.2.1.5.cmml">Head</mi><mo id="S3.E5.m1.2.2.1.1.2.2.1.2b" xref="S3.E5.m1.2.2.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.cmml">(</mo><msup id="S3.E5.m1.2.2.1.1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.2.cmml">h</mi><mo id="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.E5.m1.2.2.1.1.2.2.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.3a.cmml" xref="S3.E5.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><eq id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"></eq><apply id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2.2">ℎ</ci><ci id="S3.E5.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2.3">′</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3"><times id="S3.E5.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.2">Decoder</ci><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">ℎ</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2"><eq id="S3.E5.m1.2.2.1.1.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.2"></eq><apply id="S3.E5.m1.2.2.1.1.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3">superscript</csymbol><ci id="S3.E5.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3.2">𝑡</ci><ci id="S3.E5.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.3.3">′</ci></apply><apply id="S3.E5.m1.2.2.1.1.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1"><times id="S3.E5.m1.2.2.1.1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1.2"></times><ci id="S3.E5.m1.2.2.1.1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1.3">LM</ci><ci id="S3.E5.m1.2.2.1.1.2.2.1.4.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1.4">_</ci><ci id="S3.E5.m1.2.2.1.1.2.2.1.5.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1.5">Head</ci><apply id="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1">superscript</csymbol><ci id="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.2">ℎ</ci><ci id="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.2.2.1.1.1.1.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">h^{\prime}={\rm Decoder}(h),t^{\prime}={\rm LM\_Head}(h^{\prime}).</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = roman_Decoder ( italic_h ) , italic_t start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = roman_LM _ roman_Head ( italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p3.11">Afterwards, the tokenizer is able to translate the newly generated token index sequence into natural language sentence by an inverse table look-up operation as opposed to Formula <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S3.E4" title="In 3. Background ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="277" id="S3.F2.g1" src="x2.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>The overall framework of the proposed Twin-Tower Dynamic Semantic Recommender System</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F2.1">\Description</span></div>
</div>
</figure>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Methodology</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we introduce the <span class="ltx_text ltx_font_bold" id="S4.p1.1.1">T</span>win-<span class="ltx_text ltx_font_bold" id="S4.p1.1.2">T</span>ower <span class="ltx_text ltx_font_bold" id="S4.p1.1.3">D</span>ynamic <span class="ltx_text ltx_font_bold" id="S4.p1.1.4">S</span>emantic (<span class="ltx_text ltx_font_bold" id="S4.p1.1.5">TTDS</span>) Recommender in detail. Holistically, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S3.F2" title="Figure 2 ‣ 3. Background ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">2</span></a>, the TTDS recommender is characterized by the proposed dynamic knowledge fusion framework, where the semantic knowledge within textual content and the collaborative knowledge within historical behavior are sufficiently integrated. Specifically, a twin-tower semantic token generator takes in charge of hierarchically generating semantic index for both item and user, based on the corresponding LLM textual representation. A dual-modality variational auto-encoder (DM-VAE) is devised to eliminate great discrepancy between the newly-introduced semantic tokens and the well pre-trained NL tokens. Moreover, during the recommendation-oriented fine-tuning, a series of customized tasks are specially designed for modeling the implicit high-order user-item interaction patterns.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Problem Formulation</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.6">In this paper, we focus on sequential recommendation task whose target is predicting suitable items for users according to their historical behavior. For each user <math alttext="U_{j}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><msub id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">U</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑈</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">U_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, the historical behavior is mainly represented by the sequence of interactive items <math alttext="\{I_{k}\}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.2.cmml"><mo id="S4.SS1.p1.2.m2.1.1.1.2" stretchy="false" xref="S4.SS1.p1.2.m2.1.1.2.cmml">{</mo><msub id="S4.SS1.p1.2.m2.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.1.2.cmml">I</mi><mi id="S4.SS1.p1.2.m2.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.3.cmml">k</mi></msub><mo id="S4.SS1.p1.2.m2.1.1.1.3" stretchy="false" xref="S4.SS1.p1.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><set id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1"><apply id="S4.SS1.p1.2.m2.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.2">𝐼</ci><ci id="S4.SS1.p1.2.m2.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\{I_{k}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">{ italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT }</annotation></semantics></math>, such as <math alttext="S_{j}=[I_{7},I_{3},\cdots,I_{26}]" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.4"><semantics id="S4.SS1.p1.3.m3.4a"><mrow id="S4.SS1.p1.3.m3.4.4" xref="S4.SS1.p1.3.m3.4.4.cmml"><msub id="S4.SS1.p1.3.m3.4.4.5" xref="S4.SS1.p1.3.m3.4.4.5.cmml"><mi id="S4.SS1.p1.3.m3.4.4.5.2" xref="S4.SS1.p1.3.m3.4.4.5.2.cmml">S</mi><mi id="S4.SS1.p1.3.m3.4.4.5.3" xref="S4.SS1.p1.3.m3.4.4.5.3.cmml">j</mi></msub><mo id="S4.SS1.p1.3.m3.4.4.4" xref="S4.SS1.p1.3.m3.4.4.4.cmml">=</mo><mrow id="S4.SS1.p1.3.m3.4.4.3.3" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml"><mo id="S4.SS1.p1.3.m3.4.4.3.3.4" stretchy="false" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">[</mo><msub id="S4.SS1.p1.3.m3.2.2.1.1.1" xref="S4.SS1.p1.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.3.m3.2.2.1.1.1.2" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2.cmml">I</mi><mn id="S4.SS1.p1.3.m3.2.2.1.1.1.3" xref="S4.SS1.p1.3.m3.2.2.1.1.1.3.cmml">7</mn></msub><mo id="S4.SS1.p1.3.m3.4.4.3.3.5" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.3.m3.3.3.2.2.2" xref="S4.SS1.p1.3.m3.3.3.2.2.2.cmml"><mi id="S4.SS1.p1.3.m3.3.3.2.2.2.2" xref="S4.SS1.p1.3.m3.3.3.2.2.2.2.cmml">I</mi><mn id="S4.SS1.p1.3.m3.3.3.2.2.2.3" xref="S4.SS1.p1.3.m3.3.3.2.2.2.3.cmml">3</mn></msub><mo id="S4.SS1.p1.3.m3.4.4.3.3.6" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S4.SS1.p1.3.m3.1.1" mathvariant="normal" xref="S4.SS1.p1.3.m3.1.1.cmml">⋯</mi><mo id="S4.SS1.p1.3.m3.4.4.3.3.7" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S4.SS1.p1.3.m3.4.4.3.3.3" xref="S4.SS1.p1.3.m3.4.4.3.3.3.cmml"><mi id="S4.SS1.p1.3.m3.4.4.3.3.3.2" xref="S4.SS1.p1.3.m3.4.4.3.3.3.2.cmml">I</mi><mn id="S4.SS1.p1.3.m3.4.4.3.3.3.3" xref="S4.SS1.p1.3.m3.4.4.3.3.3.3.cmml">26</mn></msub><mo id="S4.SS1.p1.3.m3.4.4.3.3.8" stretchy="false" xref="S4.SS1.p1.3.m3.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.4b"><apply id="S4.SS1.p1.3.m3.4.4.cmml" xref="S4.SS1.p1.3.m3.4.4"><eq id="S4.SS1.p1.3.m3.4.4.4.cmml" xref="S4.SS1.p1.3.m3.4.4.4"></eq><apply id="S4.SS1.p1.3.m3.4.4.5.cmml" xref="S4.SS1.p1.3.m3.4.4.5"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.5.1.cmml" xref="S4.SS1.p1.3.m3.4.4.5">subscript</csymbol><ci id="S4.SS1.p1.3.m3.4.4.5.2.cmml" xref="S4.SS1.p1.3.m3.4.4.5.2">𝑆</ci><ci id="S4.SS1.p1.3.m3.4.4.5.3.cmml" xref="S4.SS1.p1.3.m3.4.4.5.3">𝑗</ci></apply><list id="S4.SS1.p1.3.m3.4.4.3.4.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3"><apply id="S4.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.3.m3.2.2.1.1.1.2">𝐼</ci><cn id="S4.SS1.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.2.2.1.1.1.3">7</cn></apply><apply id="S4.SS1.p1.3.m3.3.3.2.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.3.m3.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.3.m3.3.3.2.2.2.2">𝐼</ci><cn id="S4.SS1.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.3.3.2.2.2.3">3</cn></apply><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">⋯</ci><apply id="S4.SS1.p1.3.m3.4.4.3.3.3.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.4.4.3.3.3.1.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S4.SS1.p1.3.m3.4.4.3.3.3.2.cmml" xref="S4.SS1.p1.3.m3.4.4.3.3.3.2">𝐼</ci><cn id="S4.SS1.p1.3.m3.4.4.3.3.3.3.cmml" type="integer" xref="S4.SS1.p1.3.m3.4.4.3.3.3.3">26</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.4c">S_{j}=[I_{7},I_{3},\cdots,I_{26}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.4d">italic_S start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = [ italic_I start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT , italic_I start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , ⋯ , italic_I start_POSTSUBSCRIPT 26 end_POSTSUBSCRIPT ]</annotation></semantics></math>. Additionally, we use <math alttext="C_{j}^{U},C_{k}^{I}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.2"><semantics id="S4.SS1.p1.4.m4.2a"><mrow id="S4.SS1.p1.4.m4.2.2.2" xref="S4.SS1.p1.4.m4.2.2.3.cmml"><msubsup id="S4.SS1.p1.4.m4.1.1.1.1" xref="S4.SS1.p1.4.m4.1.1.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.1.1.2.2" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2.cmml">C</mi><mi id="S4.SS1.p1.4.m4.1.1.1.1.2.3" xref="S4.SS1.p1.4.m4.1.1.1.1.2.3.cmml">j</mi><mi id="S4.SS1.p1.4.m4.1.1.1.1.3" xref="S4.SS1.p1.4.m4.1.1.1.1.3.cmml">U</mi></msubsup><mo id="S4.SS1.p1.4.m4.2.2.2.3" xref="S4.SS1.p1.4.m4.2.2.3.cmml">,</mo><msubsup id="S4.SS1.p1.4.m4.2.2.2.2" xref="S4.SS1.p1.4.m4.2.2.2.2.cmml"><mi id="S4.SS1.p1.4.m4.2.2.2.2.2.2" xref="S4.SS1.p1.4.m4.2.2.2.2.2.2.cmml">C</mi><mi id="S4.SS1.p1.4.m4.2.2.2.2.2.3" xref="S4.SS1.p1.4.m4.2.2.2.2.2.3.cmml">k</mi><mi id="S4.SS1.p1.4.m4.2.2.2.2.3" xref="S4.SS1.p1.4.m4.2.2.2.2.3.cmml">I</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><list id="S4.SS1.p1.4.m4.2.2.3.cmml" xref="S4.SS1.p1.4.m4.2.2.2"><apply id="S4.SS1.p1.4.m4.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2.2">𝐶</ci><ci id="S4.SS1.p1.4.m4.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.SS1.p1.4.m4.1.1.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.1.1.3">𝑈</ci></apply><apply id="S4.SS1.p1.4.m4.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.2.2.2.2.1.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2">superscript</csymbol><apply id="S4.SS1.p1.4.m4.2.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p1.4.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.2.2">𝐶</ci><ci id="S4.SS1.p1.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.2.3">𝑘</ci></apply><ci id="S4.SS1.p1.4.m4.2.2.2.2.3.cmml" xref="S4.SS1.p1.4.m4.2.2.2.2.3">𝐼</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">C_{j}^{U},C_{k}^{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.2d">italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_U end_POSTSUPERSCRIPT , italic_C start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math> to denote the related textual content of user <math alttext="U_{j}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><msub id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">U</mi><mi id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝑈</ci><ci id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">U_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and item <math alttext="I_{k}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><msub id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">I</mi><mi id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">𝐼</ci><ci id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">I_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, respectively. For the item branch, the textual content mostly includes the item title, the detailed description, and other auxiliaries (e.g., brand and category). Similarly, the user-related textual content usually consists of the recent comment, the search query, and the holistic user profile.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>TTDS Recommender</h3>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS1.1.1">Dynamic Knowledge Fusion Framework</span>
</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.1">To sufficiently integrate the semantic knowledge and the collaborative knowledge, we propose the dynamic knowledge fusion framework for TTDS recommender. Within this framework, the TTDS recommender system consists of a twin-tower semantic token generator and a LLM-based recommender backbone. The former aims to discretize the continuous representation of user/item into corresponding semantic index. The latter is not only in charge of converting the textual content of user/item into continuous representation, but also responsible for the next-item prediction based on the user/item semantic index and human instruction.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p2">
<p class="ltx_p" id="S4.SS2.SSS1.p2.11">Consider a system of <math alttext="K" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.1.m1.1"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mi id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><ci id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.1.m1.1d">italic_K</annotation></semantics></math> items and <math alttext="J" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.2.m2.1"><semantics id="S4.SS2.SSS1.p2.2.m2.1a"><mi id="S4.SS2.SSS1.p2.2.m2.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.2.m2.1b"><ci id="S4.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.2.m2.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.2.m2.1c">J</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.2.m2.1d">italic_J</annotation></semantics></math> users, the interactive item sequence of user <math alttext="U_{j}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.3.m3.1"><semantics id="S4.SS2.SSS1.p2.3.m3.1a"><msub id="S4.SS2.SSS1.p2.3.m3.1.1" xref="S4.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S4.SS2.SSS1.p2.3.m3.1.1.2" xref="S4.SS2.SSS1.p2.3.m3.1.1.2.cmml">U</mi><mi id="S4.SS2.SSS1.p2.3.m3.1.1.3" xref="S4.SS2.SSS1.p2.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.3.m3.1b"><apply id="S4.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S4.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S4.SS2.SSS1.p2.3.m3.1.1.2">𝑈</ci><ci id="S4.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S4.SS2.SSS1.p2.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.3.m3.1c">U_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.3.m3.1d">italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can be denoted as <math alttext="S_{j}=[I_{k_{1}},I_{k_{2}},\cdots,I_{k_{n}}]" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.4.m4.4"><semantics id="S4.SS2.SSS1.p2.4.m4.4a"><mrow id="S4.SS2.SSS1.p2.4.m4.4.4" xref="S4.SS2.SSS1.p2.4.m4.4.4.cmml"><msub id="S4.SS2.SSS1.p2.4.m4.4.4.5" xref="S4.SS2.SSS1.p2.4.m4.4.4.5.cmml"><mi id="S4.SS2.SSS1.p2.4.m4.4.4.5.2" xref="S4.SS2.SSS1.p2.4.m4.4.4.5.2.cmml">S</mi><mi id="S4.SS2.SSS1.p2.4.m4.4.4.5.3" xref="S4.SS2.SSS1.p2.4.m4.4.4.5.3.cmml">j</mi></msub><mo id="S4.SS2.SSS1.p2.4.m4.4.4.4" xref="S4.SS2.SSS1.p2.4.m4.4.4.4.cmml">=</mo><mrow id="S4.SS2.SSS1.p2.4.m4.4.4.3.3" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.4.cmml"><mo id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.4" stretchy="false" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.4.cmml">[</mo><msub id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.cmml"><mi id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.2" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.2.cmml">I</mi><msub id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.2" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.2.cmml">k</mi><mn id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.3" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.5" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.4.cmml">,</mo><msub id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.cmml"><mi id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.2" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.2.cmml">I</mi><msub id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.cmml"><mi id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.2" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.2.cmml">k</mi><mn id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.3" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.6" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.4.cmml">,</mo><mi id="S4.SS2.SSS1.p2.4.m4.1.1" mathvariant="normal" xref="S4.SS2.SSS1.p2.4.m4.1.1.cmml">⋯</mi><mo id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.7" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.4.cmml">,</mo><msub id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.cmml"><mi id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.2" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.2.cmml">I</mi><msub id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.cmml"><mi id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.2" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.2.cmml">k</mi><mi id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.3" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.3.cmml">n</mi></msub></msub><mo id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.8" stretchy="false" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.4.m4.4b"><apply id="S4.SS2.SSS1.p2.4.m4.4.4.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4"><eq id="S4.SS2.SSS1.p2.4.m4.4.4.4.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.4"></eq><apply id="S4.SS2.SSS1.p2.4.m4.4.4.5.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.5"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m4.4.4.5.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.5">subscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m4.4.4.5.2.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.5.2">𝑆</ci><ci id="S4.SS2.SSS1.p2.4.m4.4.4.5.3.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.5.3">𝑗</ci></apply><list id="S4.SS2.SSS1.p2.4.m4.4.4.3.4.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3"><apply id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.2">𝐼</ci><apply id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.2">𝑘</ci><cn id="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p2.4.m4.2.2.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.cmml" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.2.cmml" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.2">𝐼</ci><apply id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.cmml" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.2.cmml" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.2">𝑘</ci><cn id="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p2.4.m4.3.3.2.2.2.3.3">2</cn></apply></apply><ci id="S4.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.1.1">⋯</ci><apply id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.2.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.2">𝐼</ci><apply id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.1.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.2.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.2">𝑘</ci><ci id="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.3.cmml" xref="S4.SS2.SSS1.p2.4.m4.4.4.3.3.3.3.3">𝑛</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.4.m4.4c">S_{j}=[I_{k_{1}},I_{k_{2}},\cdots,I_{k_{n}}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.4.m4.4d">italic_S start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = [ italic_I start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_I start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ⋯ , italic_I start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>, where the subscript <math alttext="k_{x}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.5.m5.1"><semantics id="S4.SS2.SSS1.p2.5.m5.1a"><msub id="S4.SS2.SSS1.p2.5.m5.1.1" xref="S4.SS2.SSS1.p2.5.m5.1.1.cmml"><mi id="S4.SS2.SSS1.p2.5.m5.1.1.2" xref="S4.SS2.SSS1.p2.5.m5.1.1.2.cmml">k</mi><mi id="S4.SS2.SSS1.p2.5.m5.1.1.3" xref="S4.SS2.SSS1.p2.5.m5.1.1.3.cmml">x</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.5.m5.1b"><apply id="S4.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.5.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.5.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p2.5.m5.1.1.2">𝑘</ci><ci id="S4.SS2.SSS1.p2.5.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p2.5.m5.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.5.m5.1c">k_{x}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.5.m5.1d">italic_k start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT</annotation></semantics></math> identifies the interactive item and <math alttext="n" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.6.m6.1"><semantics id="S4.SS2.SSS1.p2.6.m6.1a"><mi id="S4.SS2.SSS1.p2.6.m6.1.1" xref="S4.SS2.SSS1.p2.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.6.m6.1b"><ci id="S4.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S4.SS2.SSS1.p2.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.6.m6.1c">n</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.6.m6.1d">italic_n</annotation></semantics></math> is the sequence length. First, the LLM backbone <math alttext="f" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.7.m7.1"><semantics id="S4.SS2.SSS1.p2.7.m7.1a"><mi id="S4.SS2.SSS1.p2.7.m7.1.1" xref="S4.SS2.SSS1.p2.7.m7.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.7.m7.1b"><ci id="S4.SS2.SSS1.p2.7.m7.1.1.cmml" xref="S4.SS2.SSS1.p2.7.m7.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.7.m7.1c">f</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.7.m7.1d">italic_f</annotation></semantics></math> embeds the related textual content of user <math alttext="U_{j}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.8.m8.1"><semantics id="S4.SS2.SSS1.p2.8.m8.1a"><msub id="S4.SS2.SSS1.p2.8.m8.1.1" xref="S4.SS2.SSS1.p2.8.m8.1.1.cmml"><mi id="S4.SS2.SSS1.p2.8.m8.1.1.2" xref="S4.SS2.SSS1.p2.8.m8.1.1.2.cmml">U</mi><mi id="S4.SS2.SSS1.p2.8.m8.1.1.3" xref="S4.SS2.SSS1.p2.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.8.m8.1b"><apply id="S4.SS2.SSS1.p2.8.m8.1.1.cmml" xref="S4.SS2.SSS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.8.m8.1.1.1.cmml" xref="S4.SS2.SSS1.p2.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.8.m8.1.1.2.cmml" xref="S4.SS2.SSS1.p2.8.m8.1.1.2">𝑈</ci><ci id="S4.SS2.SSS1.p2.8.m8.1.1.3.cmml" xref="S4.SS2.SSS1.p2.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.8.m8.1c">U_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.8.m8.1d">italic_U start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> and item <math alttext="I_{k_{x}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.9.m9.1"><semantics id="S4.SS2.SSS1.p2.9.m9.1a"><msub id="S4.SS2.SSS1.p2.9.m9.1.1" xref="S4.SS2.SSS1.p2.9.m9.1.1.cmml"><mi id="S4.SS2.SSS1.p2.9.m9.1.1.2" xref="S4.SS2.SSS1.p2.9.m9.1.1.2.cmml">I</mi><msub id="S4.SS2.SSS1.p2.9.m9.1.1.3" xref="S4.SS2.SSS1.p2.9.m9.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.9.m9.1.1.3.2" xref="S4.SS2.SSS1.p2.9.m9.1.1.3.2.cmml">k</mi><mi id="S4.SS2.SSS1.p2.9.m9.1.1.3.3" xref="S4.SS2.SSS1.p2.9.m9.1.1.3.3.cmml">x</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.9.m9.1b"><apply id="S4.SS2.SSS1.p2.9.m9.1.1.cmml" xref="S4.SS2.SSS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.9.m9.1.1.1.cmml" xref="S4.SS2.SSS1.p2.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.9.m9.1.1.2.cmml" xref="S4.SS2.SSS1.p2.9.m9.1.1.2">𝐼</ci><apply id="S4.SS2.SSS1.p2.9.m9.1.1.3.cmml" xref="S4.SS2.SSS1.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.9.m9.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.9.m9.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.9.m9.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.9.m9.1.1.3.2">𝑘</ci><ci id="S4.SS2.SSS1.p2.9.m9.1.1.3.3.cmml" xref="S4.SS2.SSS1.p2.9.m9.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.9.m9.1c">I_{k_{x}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.9.m9.1d">italic_I start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, denoted as <math alttext="C_{j}^{U}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.10.m10.1"><semantics id="S4.SS2.SSS1.p2.10.m10.1a"><msubsup id="S4.SS2.SSS1.p2.10.m10.1.1" xref="S4.SS2.SSS1.p2.10.m10.1.1.cmml"><mi id="S4.SS2.SSS1.p2.10.m10.1.1.2.2" xref="S4.SS2.SSS1.p2.10.m10.1.1.2.2.cmml">C</mi><mi id="S4.SS2.SSS1.p2.10.m10.1.1.2.3" xref="S4.SS2.SSS1.p2.10.m10.1.1.2.3.cmml">j</mi><mi id="S4.SS2.SSS1.p2.10.m10.1.1.3" xref="S4.SS2.SSS1.p2.10.m10.1.1.3.cmml">U</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.10.m10.1b"><apply id="S4.SS2.SSS1.p2.10.m10.1.1.cmml" xref="S4.SS2.SSS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.10.m10.1.1.1.cmml" xref="S4.SS2.SSS1.p2.10.m10.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p2.10.m10.1.1.2.cmml" xref="S4.SS2.SSS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.10.m10.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.10.m10.1.1.2.2.cmml" xref="S4.SS2.SSS1.p2.10.m10.1.1.2.2">𝐶</ci><ci id="S4.SS2.SSS1.p2.10.m10.1.1.2.3.cmml" xref="S4.SS2.SSS1.p2.10.m10.1.1.2.3">𝑗</ci></apply><ci id="S4.SS2.SSS1.p2.10.m10.1.1.3.cmml" xref="S4.SS2.SSS1.p2.10.m10.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.10.m10.1c">C_{j}^{U}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.10.m10.1d">italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_U end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="C_{k_{x}}^{I}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.11.m11.1"><semantics id="S4.SS2.SSS1.p2.11.m11.1a"><msubsup id="S4.SS2.SSS1.p2.11.m11.1.1" xref="S4.SS2.SSS1.p2.11.m11.1.1.cmml"><mi id="S4.SS2.SSS1.p2.11.m11.1.1.2.2" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.2.cmml">C</mi><msub id="S4.SS2.SSS1.p2.11.m11.1.1.2.3" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.3.cmml"><mi id="S4.SS2.SSS1.p2.11.m11.1.1.2.3.2" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.3.2.cmml">k</mi><mi id="S4.SS2.SSS1.p2.11.m11.1.1.2.3.3" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.3.3.cmml">x</mi></msub><mi id="S4.SS2.SSS1.p2.11.m11.1.1.3" xref="S4.SS2.SSS1.p2.11.m11.1.1.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.11.m11.1b"><apply id="S4.SS2.SSS1.p2.11.m11.1.1.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.11.m11.1.1.1.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p2.11.m11.1.1.2.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.11.m11.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.11.m11.1.1.2.2.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.2">𝐶</ci><apply id="S4.SS2.SSS1.p2.11.m11.1.1.2.3.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.11.m11.1.1.2.3.1.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.11.m11.1.1.2.3.2.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.3.2">𝑘</ci><ci id="S4.SS2.SSS1.p2.11.m11.1.1.2.3.3.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1.2.3.3">𝑥</ci></apply></apply><ci id="S4.SS2.SSS1.p2.11.m11.1.1.3.cmml" xref="S4.SS2.SSS1.p2.11.m11.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.11.m11.1c">C_{k_{x}}^{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.11.m11.1d">italic_C start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math>, into continuous representation, formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="X=f(C)={\rm Decoder}({\rm Embed\_Token}({\rm Tokenizer}(C)))," class="ltx_Math" display="block" id="S4.E6.m1.3"><semantics id="S4.E6.m1.3a"><mrow id="S4.E6.m1.3.3.1" xref="S4.E6.m1.3.3.1.1.cmml"><mrow id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.3" xref="S4.E6.m1.3.3.1.1.3.cmml">X</mi><mo id="S4.E6.m1.3.3.1.1.4" xref="S4.E6.m1.3.3.1.1.4.cmml">=</mo><mrow id="S4.E6.m1.3.3.1.1.5" xref="S4.E6.m1.3.3.1.1.5.cmml"><mi id="S4.E6.m1.3.3.1.1.5.2" xref="S4.E6.m1.3.3.1.1.5.2.cmml">f</mi><mo id="S4.E6.m1.3.3.1.1.5.1" xref="S4.E6.m1.3.3.1.1.5.1.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.1.1.5.3.2" xref="S4.E6.m1.3.3.1.1.5.cmml"><mo id="S4.E6.m1.3.3.1.1.5.3.2.1" stretchy="false" xref="S4.E6.m1.3.3.1.1.5.cmml">(</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">C</mi><mo id="S4.E6.m1.3.3.1.1.5.3.2.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.5.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.3.3.1.1.6" xref="S4.E6.m1.3.3.1.1.6.cmml">=</mo><mrow id="S4.E6.m1.3.3.1.1.1" xref="S4.E6.m1.3.3.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.3.cmml">Decoder</mi><mo id="S4.E6.m1.3.3.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.3" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml">Embed</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.4" mathvariant="normal" xref="S4.E6.m1.3.3.1.1.1.1.1.1.4.cmml">_</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.2a" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.5" xref="S4.E6.m1.3.3.1.1.1.1.1.1.5.cmml">Token</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.2b" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">Tokenizer</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">C</mi><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.3.3.1.2" xref="S4.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.3b"><apply id="S4.E6.m1.3.3.1.1.cmml" xref="S4.E6.m1.3.3.1"><and id="S4.E6.m1.3.3.1.1a.cmml" xref="S4.E6.m1.3.3.1"></and><apply id="S4.E6.m1.3.3.1.1b.cmml" xref="S4.E6.m1.3.3.1"><eq id="S4.E6.m1.3.3.1.1.4.cmml" xref="S4.E6.m1.3.3.1.1.4"></eq><ci id="S4.E6.m1.3.3.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.3">𝑋</ci><apply id="S4.E6.m1.3.3.1.1.5.cmml" xref="S4.E6.m1.3.3.1.1.5"><times id="S4.E6.m1.3.3.1.1.5.1.cmml" xref="S4.E6.m1.3.3.1.1.5.1"></times><ci id="S4.E6.m1.3.3.1.1.5.2.cmml" xref="S4.E6.m1.3.3.1.1.5.2">𝑓</ci><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝐶</ci></apply></apply><apply id="S4.E6.m1.3.3.1.1c.cmml" xref="S4.E6.m1.3.3.1"><eq id="S4.E6.m1.3.3.1.1.6.cmml" xref="S4.E6.m1.3.3.1.1.6"></eq><share href="https://arxiv.org/html/2409.09253v1#S4.E6.m1.3.3.1.1.5.cmml" id="S4.E6.m1.3.3.1.1d.cmml" xref="S4.E6.m1.3.3.1"></share><apply id="S4.E6.m1.3.3.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1"><times id="S4.E6.m1.3.3.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.2"></times><ci id="S4.E6.m1.3.3.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.3">Decoder</ci><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1"><times id="S4.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.2"></times><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.3">Embed</ci><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.4">_</ci><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.5.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.5">Token</ci><apply id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1"><times id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.3.3.1.1.1.1.1.1.1.1.1.2">Tokenizer</ci><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝐶</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.3c">X=f(C)={\rm Decoder}({\rm Embed\_Token}({\rm Tokenizer}(C))),</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.3d">italic_X = italic_f ( italic_C ) = roman_Decoder ( roman_Embed _ roman_Token ( roman_Tokenizer ( italic_C ) ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS1.p2.19">where <math alttext="C" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.12.m1.1"><semantics id="S4.SS2.SSS1.p2.12.m1.1a"><mi id="S4.SS2.SSS1.p2.12.m1.1.1" xref="S4.SS2.SSS1.p2.12.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.12.m1.1b"><ci id="S4.SS2.SSS1.p2.12.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.12.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.12.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.12.m1.1d">italic_C</annotation></semantics></math> refers to the textual content <math alttext="C_{j}^{U}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.13.m2.1"><semantics id="S4.SS2.SSS1.p2.13.m2.1a"><msubsup id="S4.SS2.SSS1.p2.13.m2.1.1" xref="S4.SS2.SSS1.p2.13.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p2.13.m2.1.1.2.2" xref="S4.SS2.SSS1.p2.13.m2.1.1.2.2.cmml">C</mi><mi id="S4.SS2.SSS1.p2.13.m2.1.1.2.3" xref="S4.SS2.SSS1.p2.13.m2.1.1.2.3.cmml">j</mi><mi id="S4.SS2.SSS1.p2.13.m2.1.1.3" xref="S4.SS2.SSS1.p2.13.m2.1.1.3.cmml">U</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.13.m2.1b"><apply id="S4.SS2.SSS1.p2.13.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.13.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.13.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p2.13.m2.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p2.13.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p2.13.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.13.m2.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.13.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.13.m2.1.1.2.2.cmml" xref="S4.SS2.SSS1.p2.13.m2.1.1.2.2">𝐶</ci><ci id="S4.SS2.SSS1.p2.13.m2.1.1.2.3.cmml" xref="S4.SS2.SSS1.p2.13.m2.1.1.2.3">𝑗</ci></apply><ci id="S4.SS2.SSS1.p2.13.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p2.13.m2.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.13.m2.1c">C_{j}^{U}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.13.m2.1d">italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_U end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="C_{k_{x}}^{I}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.14.m3.1"><semantics id="S4.SS2.SSS1.p2.14.m3.1a"><msubsup id="S4.SS2.SSS1.p2.14.m3.1.1" xref="S4.SS2.SSS1.p2.14.m3.1.1.cmml"><mi id="S4.SS2.SSS1.p2.14.m3.1.1.2.2" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.2.cmml">C</mi><msub id="S4.SS2.SSS1.p2.14.m3.1.1.2.3" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.3.cmml"><mi id="S4.SS2.SSS1.p2.14.m3.1.1.2.3.2" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.3.2.cmml">k</mi><mi id="S4.SS2.SSS1.p2.14.m3.1.1.2.3.3" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.3.3.cmml">x</mi></msub><mi id="S4.SS2.SSS1.p2.14.m3.1.1.3" xref="S4.SS2.SSS1.p2.14.m3.1.1.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.14.m3.1b"><apply id="S4.SS2.SSS1.p2.14.m3.1.1.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.14.m3.1.1.1.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p2.14.m3.1.1.2.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.14.m3.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.14.m3.1.1.2.2.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.2">𝐶</ci><apply id="S4.SS2.SSS1.p2.14.m3.1.1.2.3.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.14.m3.1.1.2.3.1.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.14.m3.1.1.2.3.2.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.3.2">𝑘</ci><ci id="S4.SS2.SSS1.p2.14.m3.1.1.2.3.3.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1.2.3.3">𝑥</ci></apply></apply><ci id="S4.SS2.SSS1.p2.14.m3.1.1.3.cmml" xref="S4.SS2.SSS1.p2.14.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.14.m3.1c">C_{k_{x}}^{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.14.m3.1d">italic_C start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="X" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.15.m4.1"><semantics id="S4.SS2.SSS1.p2.15.m4.1a"><mi id="S4.SS2.SSS1.p2.15.m4.1.1" xref="S4.SS2.SSS1.p2.15.m4.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.15.m4.1b"><ci id="S4.SS2.SSS1.p2.15.m4.1.1.cmml" xref="S4.SS2.SSS1.p2.15.m4.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.15.m4.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.15.m4.1d">italic_X</annotation></semantics></math> corresponds to the continuous representation <math alttext="X_{j}^{U}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.16.m5.1"><semantics id="S4.SS2.SSS1.p2.16.m5.1a"><msubsup id="S4.SS2.SSS1.p2.16.m5.1.1" xref="S4.SS2.SSS1.p2.16.m5.1.1.cmml"><mi id="S4.SS2.SSS1.p2.16.m5.1.1.2.2" xref="S4.SS2.SSS1.p2.16.m5.1.1.2.2.cmml">X</mi><mi id="S4.SS2.SSS1.p2.16.m5.1.1.2.3" xref="S4.SS2.SSS1.p2.16.m5.1.1.2.3.cmml">j</mi><mi id="S4.SS2.SSS1.p2.16.m5.1.1.3" xref="S4.SS2.SSS1.p2.16.m5.1.1.3.cmml">U</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.16.m5.1b"><apply id="S4.SS2.SSS1.p2.16.m5.1.1.cmml" xref="S4.SS2.SSS1.p2.16.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.16.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p2.16.m5.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p2.16.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p2.16.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.16.m5.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.16.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.16.m5.1.1.2.2.cmml" xref="S4.SS2.SSS1.p2.16.m5.1.1.2.2">𝑋</ci><ci id="S4.SS2.SSS1.p2.16.m5.1.1.2.3.cmml" xref="S4.SS2.SSS1.p2.16.m5.1.1.2.3">𝑗</ci></apply><ci id="S4.SS2.SSS1.p2.16.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p2.16.m5.1.1.3">𝑈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.16.m5.1c">X_{j}^{U}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.16.m5.1d">italic_X start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_U end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="X_{k_{x}}^{I}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.17.m6.1"><semantics id="S4.SS2.SSS1.p2.17.m6.1a"><msubsup id="S4.SS2.SSS1.p2.17.m6.1.1" xref="S4.SS2.SSS1.p2.17.m6.1.1.cmml"><mi id="S4.SS2.SSS1.p2.17.m6.1.1.2.2" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.2.cmml">X</mi><msub id="S4.SS2.SSS1.p2.17.m6.1.1.2.3" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.3.cmml"><mi id="S4.SS2.SSS1.p2.17.m6.1.1.2.3.2" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.3.2.cmml">k</mi><mi id="S4.SS2.SSS1.p2.17.m6.1.1.2.3.3" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.3.3.cmml">x</mi></msub><mi id="S4.SS2.SSS1.p2.17.m6.1.1.3" xref="S4.SS2.SSS1.p2.17.m6.1.1.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.17.m6.1b"><apply id="S4.SS2.SSS1.p2.17.m6.1.1.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.17.m6.1.1.1.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p2.17.m6.1.1.2.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.17.m6.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.17.m6.1.1.2.2.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.2">𝑋</ci><apply id="S4.SS2.SSS1.p2.17.m6.1.1.2.3.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.17.m6.1.1.2.3.1.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.3">subscript</csymbol><ci id="S4.SS2.SSS1.p2.17.m6.1.1.2.3.2.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.3.2">𝑘</ci><ci id="S4.SS2.SSS1.p2.17.m6.1.1.2.3.3.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1.2.3.3">𝑥</ci></apply></apply><ci id="S4.SS2.SSS1.p2.17.m6.1.1.3.cmml" xref="S4.SS2.SSS1.p2.17.m6.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.17.m6.1c">X_{k_{x}}^{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.17.m6.1d">italic_X start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math>. Afterwards, the twin-tower semantic token generator takes the continuous representation <math alttext="X" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.18.m7.1"><semantics id="S4.SS2.SSS1.p2.18.m7.1a"><mi id="S4.SS2.SSS1.p2.18.m7.1.1" xref="S4.SS2.SSS1.p2.18.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.18.m7.1b"><ci id="S4.SS2.SSS1.p2.18.m7.1.1.cmml" xref="S4.SS2.SSS1.p2.18.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.18.m7.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.18.m7.1d">italic_X</annotation></semantics></math> as input and produce semantic index for both user and item. To be more specific, the semantic token generator functions as vector quantization, which adopts a learnable codebook <math alttext="\mathcal{C}=\{c_{i}\}_{i=1}^{|\mathcal{C}|}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.19.m8.2"><semantics id="S4.SS2.SSS1.p2.19.m8.2a"><mrow id="S4.SS2.SSS1.p2.19.m8.2.2" xref="S4.SS2.SSS1.p2.19.m8.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p2.19.m8.2.2.3" xref="S4.SS2.SSS1.p2.19.m8.2.2.3.cmml">𝒞</mi><mo id="S4.SS2.SSS1.p2.19.m8.2.2.2" xref="S4.SS2.SSS1.p2.19.m8.2.2.2.cmml">=</mo><msubsup id="S4.SS2.SSS1.p2.19.m8.2.2.1" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.cmml"><mrow id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.2.cmml"><mo id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.2" stretchy="false" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.2.cmml">{</mo><msub id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.2" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.2.cmml">c</mi><mi id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.3" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.3" stretchy="false" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.2" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.2.cmml">i</mi><mo id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.1" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.1.cmml">=</mo><mn id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.3" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.3.cmml">1</mn></mrow><mrow id="S4.SS2.SSS1.p2.19.m8.1.1.1.3" xref="S4.SS2.SSS1.p2.19.m8.1.1.1.2.cmml"><mo id="S4.SS2.SSS1.p2.19.m8.1.1.1.3.1" stretchy="false" xref="S4.SS2.SSS1.p2.19.m8.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p2.19.m8.1.1.1.1" xref="S4.SS2.SSS1.p2.19.m8.1.1.1.1.cmml">𝒞</mi><mo id="S4.SS2.SSS1.p2.19.m8.1.1.1.3.2" stretchy="false" xref="S4.SS2.SSS1.p2.19.m8.1.1.1.2.1.cmml">|</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.19.m8.2b"><apply id="S4.SS2.SSS1.p2.19.m8.2.2.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2"><eq id="S4.SS2.SSS1.p2.19.m8.2.2.2.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.2"></eq><ci id="S4.SS2.SSS1.p2.19.m8.2.2.3.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.3">𝒞</ci><apply id="S4.SS2.SSS1.p2.19.m8.2.2.1.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.19.m8.2.2.1.2.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1">superscript</csymbol><apply id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.2.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1">subscript</csymbol><set id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1"><apply id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.2">𝑐</ci><ci id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3"><eq id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.1"></eq><ci id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.2">𝑖</ci><cn id="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p2.19.m8.2.2.1.1.3.3">1</cn></apply></apply><apply id="S4.SS2.SSS1.p2.19.m8.1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.19.m8.1.1.1.3"><abs id="S4.SS2.SSS1.p2.19.m8.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p2.19.m8.1.1.1.3.1"></abs><ci id="S4.SS2.SSS1.p2.19.m8.1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.19.m8.1.1.1.1">𝒞</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.19.m8.2c">\mathcal{C}=\{c_{i}\}_{i=1}^{|\mathcal{C}|}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.19.m8.2d">caligraphic_C = { italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_C | end_POSTSUPERSCRIPT</annotation></semantics></math> to approximate the input representation, formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="i^{*}=\mathop{\arg\min}\limits_{i}\mathcal{D}(X,c_{i})," class="ltx_Math" display="block" id="S4.E7.m1.2"><semantics id="S4.E7.m1.2a"><mrow id="S4.E7.m1.2.2.1" xref="S4.E7.m1.2.2.1.1.cmml"><mrow id="S4.E7.m1.2.2.1.1" xref="S4.E7.m1.2.2.1.1.cmml"><msup id="S4.E7.m1.2.2.1.1.3" xref="S4.E7.m1.2.2.1.1.3.cmml"><mi id="S4.E7.m1.2.2.1.1.3.2" xref="S4.E7.m1.2.2.1.1.3.2.cmml">i</mi><mo id="S4.E7.m1.2.2.1.1.3.3" xref="S4.E7.m1.2.2.1.1.3.3.cmml">∗</mo></msup><mo id="S4.E7.m1.2.2.1.1.2" xref="S4.E7.m1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E7.m1.2.2.1.1.1" xref="S4.E7.m1.2.2.1.1.1.cmml"><munder id="S4.E7.m1.2.2.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.2.cmml"><mrow id="S4.E7.m1.2.2.1.1.1.2.2" xref="S4.E7.m1.2.2.1.1.1.2.2.cmml"><mi id="S4.E7.m1.2.2.1.1.1.2.2.1" xref="S4.E7.m1.2.2.1.1.1.2.2.1.cmml">arg</mi><mo id="S4.E7.m1.2.2.1.1.1.2.2a" lspace="0.167em" xref="S4.E7.m1.2.2.1.1.1.2.2.cmml">⁡</mo><mi id="S4.E7.m1.2.2.1.1.1.2.2.2" xref="S4.E7.m1.2.2.1.1.1.2.2.2.cmml">min</mi></mrow><mi id="S4.E7.m1.2.2.1.1.1.2.3" xref="S4.E7.m1.2.2.1.1.1.2.3.cmml">i</mi></munder><mrow id="S4.E7.m1.2.2.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.2.2.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.3.cmml">𝒟</mi><mo id="S4.E7.m1.2.2.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S4.E7.m1.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">X</mi><mo id="S4.E7.m1.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.2.cmml">,</mo><msub id="S4.E7.m1.2.2.1.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E7.m1.2.2.1.1.1.1.1.1.4" stretchy="false" xref="S4.E7.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.2.2.1.2" xref="S4.E7.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.2b"><apply id="S4.E7.m1.2.2.1.1.cmml" xref="S4.E7.m1.2.2.1"><eq id="S4.E7.m1.2.2.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.2"></eq><apply id="S4.E7.m1.2.2.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.3.1.cmml" xref="S4.E7.m1.2.2.1.1.3">superscript</csymbol><ci id="S4.E7.m1.2.2.1.1.3.2.cmml" xref="S4.E7.m1.2.2.1.1.3.2">𝑖</ci><times id="S4.E7.m1.2.2.1.1.3.3.cmml" xref="S4.E7.m1.2.2.1.1.3.3"></times></apply><apply id="S4.E7.m1.2.2.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1"><apply id="S4.E7.m1.2.2.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.2.1.cmml" xref="S4.E7.m1.2.2.1.1.1.2">subscript</csymbol><apply id="S4.E7.m1.2.2.1.1.1.2.2.cmml" xref="S4.E7.m1.2.2.1.1.1.2.2"><arg id="S4.E7.m1.2.2.1.1.1.2.2.1.cmml" xref="S4.E7.m1.2.2.1.1.1.2.2.1"></arg><min id="S4.E7.m1.2.2.1.1.1.2.2.2.cmml" xref="S4.E7.m1.2.2.1.1.1.2.2.2"></min></apply><ci id="S4.E7.m1.2.2.1.1.1.2.3.cmml" xref="S4.E7.m1.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E7.m1.2.2.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1"><times id="S4.E7.m1.2.2.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.2"></times><ci id="S4.E7.m1.2.2.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.3">𝒟</ci><interval closure="open" id="S4.E7.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1"><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝑋</ci><apply id="S4.E7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.2">𝑐</ci><ci id="S4.E7.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.2c">i^{*}=\mathop{\arg\min}\limits_{i}\mathcal{D}(X,c_{i}),</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.2d">italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = start_BIGOP roman_arg roman_min end_BIGOP start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT caligraphic_D ( italic_X , italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS1.p2.26">where <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.20.m1.1"><semantics id="S4.SS2.SSS1.p2.20.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p2.20.m1.1.1" xref="S4.SS2.SSS1.p2.20.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.20.m1.1b"><ci id="S4.SS2.SSS1.p2.20.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.20.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.20.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.20.m1.1d">caligraphic_D</annotation></semantics></math> represents distance metric and <math alttext="i^{*}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.21.m2.1"><semantics id="S4.SS2.SSS1.p2.21.m2.1a"><msup id="S4.SS2.SSS1.p2.21.m2.1.1" xref="S4.SS2.SSS1.p2.21.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p2.21.m2.1.1.2" xref="S4.SS2.SSS1.p2.21.m2.1.1.2.cmml">i</mi><mo id="S4.SS2.SSS1.p2.21.m2.1.1.3" xref="S4.SS2.SSS1.p2.21.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.21.m2.1b"><apply id="S4.SS2.SSS1.p2.21.m2.1.1.cmml" xref="S4.SS2.SSS1.p2.21.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.21.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p2.21.m2.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p2.21.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p2.21.m2.1.1.2">𝑖</ci><times id="S4.SS2.SSS1.p2.21.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p2.21.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.21.m2.1c">i^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.21.m2.1d">italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is the semantic index of <math alttext="X" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.22.m3.1"><semantics id="S4.SS2.SSS1.p2.22.m3.1a"><mi id="S4.SS2.SSS1.p2.22.m3.1.1" xref="S4.SS2.SSS1.p2.22.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.22.m3.1b"><ci id="S4.SS2.SSS1.p2.22.m3.1.1.cmml" xref="S4.SS2.SSS1.p2.22.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.22.m3.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.22.m3.1d">italic_X</annotation></semantics></math>. Within the learnable codebook <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.23.m4.1"><semantics id="S4.SS2.SSS1.p2.23.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p2.23.m4.1.1" xref="S4.SS2.SSS1.p2.23.m4.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.23.m4.1b"><ci id="S4.SS2.SSS1.p2.23.m4.1.1.cmml" xref="S4.SS2.SSS1.p2.23.m4.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.23.m4.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.23.m4.1d">caligraphic_C</annotation></semantics></math>, vector <math alttext="c^{*}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.24.m5.1"><semantics id="S4.SS2.SSS1.p2.24.m5.1a"><msup id="S4.SS2.SSS1.p2.24.m5.1.1" xref="S4.SS2.SSS1.p2.24.m5.1.1.cmml"><mi id="S4.SS2.SSS1.p2.24.m5.1.1.2" xref="S4.SS2.SSS1.p2.24.m5.1.1.2.cmml">c</mi><mo id="S4.SS2.SSS1.p2.24.m5.1.1.3" xref="S4.SS2.SSS1.p2.24.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.24.m5.1b"><apply id="S4.SS2.SSS1.p2.24.m5.1.1.cmml" xref="S4.SS2.SSS1.p2.24.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.24.m5.1.1.1.cmml" xref="S4.SS2.SSS1.p2.24.m5.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p2.24.m5.1.1.2.cmml" xref="S4.SS2.SSS1.p2.24.m5.1.1.2">𝑐</ci><times id="S4.SS2.SSS1.p2.24.m5.1.1.3.cmml" xref="S4.SS2.SSS1.p2.24.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.24.m5.1c">c^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.24.m5.1d">italic_c start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> (i.e., <math alttext="c_{i^{*}}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.25.m6.1"><semantics id="S4.SS2.SSS1.p2.25.m6.1a"><msub id="S4.SS2.SSS1.p2.25.m6.1.1" xref="S4.SS2.SSS1.p2.25.m6.1.1.cmml"><mi id="S4.SS2.SSS1.p2.25.m6.1.1.2" xref="S4.SS2.SSS1.p2.25.m6.1.1.2.cmml">c</mi><msup id="S4.SS2.SSS1.p2.25.m6.1.1.3" xref="S4.SS2.SSS1.p2.25.m6.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.25.m6.1.1.3.2" xref="S4.SS2.SSS1.p2.25.m6.1.1.3.2.cmml">i</mi><mo id="S4.SS2.SSS1.p2.25.m6.1.1.3.3" xref="S4.SS2.SSS1.p2.25.m6.1.1.3.3.cmml">∗</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.25.m6.1b"><apply id="S4.SS2.SSS1.p2.25.m6.1.1.cmml" xref="S4.SS2.SSS1.p2.25.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.25.m6.1.1.1.cmml" xref="S4.SS2.SSS1.p2.25.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p2.25.m6.1.1.2.cmml" xref="S4.SS2.SSS1.p2.25.m6.1.1.2">𝑐</ci><apply id="S4.SS2.SSS1.p2.25.m6.1.1.3.cmml" xref="S4.SS2.SSS1.p2.25.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p2.25.m6.1.1.3.1.cmml" xref="S4.SS2.SSS1.p2.25.m6.1.1.3">superscript</csymbol><ci id="S4.SS2.SSS1.p2.25.m6.1.1.3.2.cmml" xref="S4.SS2.SSS1.p2.25.m6.1.1.3.2">𝑖</ci><times id="S4.SS2.SSS1.p2.25.m6.1.1.3.3.cmml" xref="S4.SS2.SSS1.p2.25.m6.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.25.m6.1c">c_{i^{*}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.25.m6.1d">italic_c start_POSTSUBSCRIPT italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>) is the closest one to the input representation <math alttext="X" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p2.26.m7.1"><semantics id="S4.SS2.SSS1.p2.26.m7.1a"><mi id="S4.SS2.SSS1.p2.26.m7.1.1" xref="S4.SS2.SSS1.p2.26.m7.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.26.m7.1b"><ci id="S4.SS2.SSS1.p2.26.m7.1.1.cmml" xref="S4.SS2.SSS1.p2.26.m7.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.26.m7.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p2.26.m7.1d">italic_X</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS1.p3">
<p class="ltx_p" id="S4.SS2.SSS1.p3.10">The twin-tower semantic token generator quantizes the continuous embedding <math alttext="X" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.1.m1.1"><semantics id="S4.SS2.SSS1.p3.1.m1.1a"><mi id="S4.SS2.SSS1.p3.1.m1.1.1" xref="S4.SS2.SSS1.p3.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.1.m1.1b"><ci id="S4.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.1.m1.1c">X</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.1.m1.1d">italic_X</annotation></semantics></math> into the discrete index <math alttext="i^{*}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.2.m2.1"><semantics id="S4.SS2.SSS1.p3.2.m2.1a"><msup id="S4.SS2.SSS1.p3.2.m2.1.1" xref="S4.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S4.SS2.SSS1.p3.2.m2.1.1.2" xref="S4.SS2.SSS1.p3.2.m2.1.1.2.cmml">i</mi><mo id="S4.SS2.SSS1.p3.2.m2.1.1.3" xref="S4.SS2.SSS1.p3.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.2.m2.1b"><apply id="S4.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1.2">𝑖</ci><times id="S4.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p3.2.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.2.m2.1c">i^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.2.m2.1d">italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> (i.e., semantic index) which serves as an identifier. Note that in Formula <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.E7" title="In 4.2.1. Dynamic Knowledge Fusion Framework ‣ 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">7</span></a>, the semantic index <math alttext="i^{*}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.3.m3.1"><semantics id="S4.SS2.SSS1.p3.3.m3.1a"><msup id="S4.SS2.SSS1.p3.3.m3.1.1" xref="S4.SS2.SSS1.p3.3.m3.1.1.cmml"><mi id="S4.SS2.SSS1.p3.3.m3.1.1.2" xref="S4.SS2.SSS1.p3.3.m3.1.1.2.cmml">i</mi><mo id="S4.SS2.SSS1.p3.3.m3.1.1.3" xref="S4.SS2.SSS1.p3.3.m3.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.3.m3.1b"><apply id="S4.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.3.m3.1.1.1.cmml" xref="S4.SS2.SSS1.p3.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.3.m3.1.1.2.cmml" xref="S4.SS2.SSS1.p3.3.m3.1.1.2">𝑖</ci><times id="S4.SS2.SSS1.p3.3.m3.1.1.3.cmml" xref="S4.SS2.SSS1.p3.3.m3.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.3.m3.1c">i^{*}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.3.m3.1d">italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is selected on the basis of representation distance and thus the similar representations will be allocated with similar indices. Accordingly, the vocabulary of LLM backbone is extended with the newly generated semantic token, to predict the next item in an end-to-end manner. Based on the semantic index and the interaction history, we prompt the LLM backbone by natural language human instruction. Specifically, the original item index and user index within the interaction history are both replaced with the corresponding semantic index. The rewritten interaction history is organized as a semantic index sequence in chronological order and the sequential recommendation instruction is also merged into the prompt. An example instruction prompt is given as follows: <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS1.p3.5.2">You are an expert in sequential recommendation. Please predict the most suitable item for user <math alttext="&lt;i^{*}_{U_{0}}&gt;" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.4.1.m1.1"><semantics id="S4.SS2.SSS1.p3.4.1.m1.1a"><mrow id="S4.SS2.SSS1.p3.4.1.m1.1.1.1" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.2.cmml"><mo fence="true" id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.2" rspace="0em" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.2.1.cmml">&lt;</mo><msubsup id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.2" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.2.cmml">i</mi><msub id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.2" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.2.cmml">U</mi><mn id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.3" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.3" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.3.cmml">∗</mo></msubsup><mo fence="true" id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.3" lspace="0em" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.2.1.cmml">&gt;</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.4.1.m1.1b"><apply id="S4.SS2.SSS1.p3.4.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS1.p3.4.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.2">expectation</csymbol><apply id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.2">𝑖</ci><times id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.2.3"></times></apply><apply id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.2">𝑈</ci><cn id="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p3.4.1.m1.1.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.4.1.m1.1c">&lt;i^{*}_{U_{0}}&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.4.1.m1.1d">&lt; italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_POSTSUBSCRIPT &gt;</annotation></semantics></math>, based on the historical interactions: <math alttext="&lt;i^{*}_{I_{3}}&gt;,&lt;i^{*}_{I_{7}}&gt;,\cdots,&lt;i^{*}_{I_{15}}&gt;" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.5.2.m2.4"><semantics id="S4.SS2.SSS1.p3.5.2.m2.4a"><mrow id="S4.SS2.SSS1.p3.5.2.m2.4.4.3" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.4.cmml"><mrow id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.2.cmml"><mo fence="true" id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.2" rspace="0em" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.2.1.cmml">&lt;</mo><msubsup id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.2" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.2.cmml">i</mi><msub id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.2" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.2.cmml">I</mi><mn id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.3" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.3.cmml">3</mn></msub><mo id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.3" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.3.cmml">∗</mo></msubsup><mo fence="true" id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.3" lspace="0em" rspace="0em" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.2.1.cmml">&gt;</mo></mrow><mo id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.4" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.4.cmml">,</mo><mrow id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.2.cmml"><mo fence="true" id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.2" lspace="0em" rspace="0em" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.2.1.cmml">&lt;</mo><msubsup id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.cmml"><mi id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.2" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.2.cmml">i</mi><msub id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.cmml"><mi id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.2" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.2.cmml">I</mi><mn id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.3" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.3.cmml">7</mn></msub><mo id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.3" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.3.cmml">∗</mo></msubsup><mo fence="true" id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.3" lspace="0em" rspace="0em" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.2.1.cmml">&gt;</mo></mrow><mo id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.5" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.4.cmml">,</mo><mi id="S4.SS2.SSS1.p3.5.2.m2.1.1" mathvariant="normal" xref="S4.SS2.SSS1.p3.5.2.m2.1.1.cmml">⋯</mi><mo id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.6" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.4.cmml">,</mo><mrow id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.2.cmml"><mo fence="true" id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.2" lspace="0em" rspace="0em" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.2.1.cmml">&lt;</mo><msubsup id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.cmml"><mi id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.2" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.2.cmml">i</mi><msub id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.cmml"><mi id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.2" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.2.cmml">I</mi><mn id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.3" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.3.cmml">15</mn></msub><mo id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.3" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.3.cmml">∗</mo></msubsup><mo fence="true" id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.3" lspace="0em" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.2.1.cmml">&gt;</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.5.2.m2.4b"><list id="S4.SS2.SSS1.p3.5.2.m2.4.4.4.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3"><apply id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.2">expectation</csymbol><apply id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.2">𝑖</ci><times id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.3.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.2.3"></times></apply><apply id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.2">𝐼</ci><cn id="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p3.5.2.m2.2.2.1.1.1.1.3.3">3</cn></apply></apply></apply><apply id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1"><csymbol cd="latexml" id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.2.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.2">expectation</csymbol><apply id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.2">𝑖</ci><times id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.3.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.2.3"></times></apply><apply id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.2">𝐼</ci><cn id="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p3.5.2.m2.3.3.2.2.1.1.3.3">7</cn></apply></apply></apply><ci id="S4.SS2.SSS1.p3.5.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.1.1">⋯</ci><apply id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1"><csymbol cd="latexml" id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.2.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.2">expectation</csymbol><apply id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.2">𝑖</ci><times id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.3.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.2.3"></times></apply><apply id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.1.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.2.cmml" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.2">𝐼</ci><cn id="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS1.p3.5.2.m2.4.4.3.3.1.1.3.3">15</cn></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.5.2.m2.4c">&lt;i^{*}_{I_{3}}&gt;,&lt;i^{*}_{I_{7}}&gt;,\cdots,&lt;i^{*}_{I_{15}}&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.5.2.m2.4d">&lt; italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT end_POSTSUBSCRIPT &gt; , &lt; italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT end_POSTSUBSCRIPT &gt; , ⋯ , &lt; italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT 15 end_POSTSUBSCRIPT end_POSTSUBSCRIPT &gt;</annotation></semantics></math></span>. Denoting the human instruction as <math alttext="P" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.6.m4.1"><semantics id="S4.SS2.SSS1.p3.6.m4.1a"><mi id="S4.SS2.SSS1.p3.6.m4.1.1" xref="S4.SS2.SSS1.p3.6.m4.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.6.m4.1b"><ci id="S4.SS2.SSS1.p3.6.m4.1.1.cmml" xref="S4.SS2.SSS1.p3.6.m4.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.6.m4.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.6.m4.1d">italic_P</annotation></semantics></math>, the LLM backbone <math alttext="f" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.7.m5.1"><semantics id="S4.SS2.SSS1.p3.7.m5.1a"><mi id="S4.SS2.SSS1.p3.7.m5.1.1" xref="S4.SS2.SSS1.p3.7.m5.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.7.m5.1b"><ci id="S4.SS2.SSS1.p3.7.m5.1.1.cmml" xref="S4.SS2.SSS1.p3.7.m5.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.7.m5.1c">f</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.7.m5.1d">italic_f</annotation></semantics></math> first transforms natural language <math alttext="P" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.8.m6.1"><semantics id="S4.SS2.SSS1.p3.8.m6.1a"><mi id="S4.SS2.SSS1.p3.8.m6.1.1" xref="S4.SS2.SSS1.p3.8.m6.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.8.m6.1b"><ci id="S4.SS2.SSS1.p3.8.m6.1.1.cmml" xref="S4.SS2.SSS1.p3.8.m6.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.8.m6.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.8.m6.1d">italic_P</annotation></semantics></math> into hidden representation <math alttext="X_{P}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.9.m7.1"><semantics id="S4.SS2.SSS1.p3.9.m7.1a"><msub id="S4.SS2.SSS1.p3.9.m7.1.1" xref="S4.SS2.SSS1.p3.9.m7.1.1.cmml"><mi id="S4.SS2.SSS1.p3.9.m7.1.1.2" xref="S4.SS2.SSS1.p3.9.m7.1.1.2.cmml">X</mi><mi id="S4.SS2.SSS1.p3.9.m7.1.1.3" xref="S4.SS2.SSS1.p3.9.m7.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.9.m7.1b"><apply id="S4.SS2.SSS1.p3.9.m7.1.1.cmml" xref="S4.SS2.SSS1.p3.9.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.9.m7.1.1.1.cmml" xref="S4.SS2.SSS1.p3.9.m7.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.9.m7.1.1.2.cmml" xref="S4.SS2.SSS1.p3.9.m7.1.1.2">𝑋</ci><ci id="S4.SS2.SSS1.p3.9.m7.1.1.3.cmml" xref="S4.SS2.SSS1.p3.9.m7.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.9.m7.1c">X_{P}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.9.m7.1d">italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math> based on Formula <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.E6" title="In 4.2.1. Dynamic Knowledge Fusion Framework ‣ 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">6</span></a>. Then a language model head is appended to project the hidden state <math alttext="X_{P}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.10.m8.1"><semantics id="S4.SS2.SSS1.p3.10.m8.1a"><msub id="S4.SS2.SSS1.p3.10.m8.1.1" xref="S4.SS2.SSS1.p3.10.m8.1.1.cmml"><mi id="S4.SS2.SSS1.p3.10.m8.1.1.2" xref="S4.SS2.SSS1.p3.10.m8.1.1.2.cmml">X</mi><mi id="S4.SS2.SSS1.p3.10.m8.1.1.3" xref="S4.SS2.SSS1.p3.10.m8.1.1.3.cmml">P</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.10.m8.1b"><apply id="S4.SS2.SSS1.p3.10.m8.1.1.cmml" xref="S4.SS2.SSS1.p3.10.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.10.m8.1.1.1.cmml" xref="S4.SS2.SSS1.p3.10.m8.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.10.m8.1.1.2.cmml" xref="S4.SS2.SSS1.p3.10.m8.1.1.2">𝑋</ci><ci id="S4.SS2.SSS1.p3.10.m8.1.1.3.cmml" xref="S4.SS2.SSS1.p3.10.m8.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.10.m8.1c">X_{P}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.10.m8.1d">italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT</annotation></semantics></math> into the semantic token vocabulary, formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{i}={\rm LM\_Head}(X_{P})," class="ltx_Math" display="block" id="S4.E8.m1.1"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mover accent="true" id="S4.E8.m1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E8.m1.1.1.1.1.3.1" xref="S4.E8.m1.1.1.1.1.3.1.cmml">^</mo></mover><mo id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.3.cmml">LM</mi><mo id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.4" mathvariant="normal" xref="S4.E8.m1.1.1.1.1.1.4.cmml">_</mi><mo id="S4.E8.m1.1.1.1.1.1.2a" xref="S4.E8.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S4.E8.m1.1.1.1.1.1.5" xref="S4.E8.m1.1.1.1.1.1.5.cmml">Head</mi><mo id="S4.E8.m1.1.1.1.1.1.2b" xref="S4.E8.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E8.m1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S4.E8.m1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3.cmml">P</mi></msub><mo id="S4.E8.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><eq id="S4.E8.m1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2"></eq><apply id="S4.E8.m1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.3"><ci id="S4.E8.m1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.1">^</ci><ci id="S4.E8.m1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2">𝑖</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.2"></times><ci id="S4.E8.m1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.3">LM</ci><ci id="S4.E8.m1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.1.1.1.1.1.4">_</ci><ci id="S4.E8.m1.1.1.1.1.1.5.cmml" xref="S4.E8.m1.1.1.1.1.1.5">Head</ci><apply id="S4.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1.3">𝑃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\hat{i}={\rm LM\_Head}(X_{P}),</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.1d">over^ start_ARG italic_i end_ARG = roman_LM _ roman_Head ( italic_X start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS1.p3.11">where <math alttext="\hat{i}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.11.m1.1"><semantics id="S4.SS2.SSS1.p3.11.m1.1a"><mover accent="true" id="S4.SS2.SSS1.p3.11.m1.1.1" xref="S4.SS2.SSS1.p3.11.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p3.11.m1.1.1.2" xref="S4.SS2.SSS1.p3.11.m1.1.1.2.cmml">i</mi><mo id="S4.SS2.SSS1.p3.11.m1.1.1.1" xref="S4.SS2.SSS1.p3.11.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.11.m1.1b"><apply id="S4.SS2.SSS1.p3.11.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.11.m1.1.1"><ci id="S4.SS2.SSS1.p3.11.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p3.11.m1.1.1.1">^</ci><ci id="S4.SS2.SSS1.p3.11.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p3.11.m1.1.1.2">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.11.m1.1c">\hat{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.11.m1.1d">over^ start_ARG italic_i end_ARG</annotation></semantics></math> is the semantic index of the recommendation result and an inverse look-up operation opposite to Formula <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.E7" title="In 4.2.1. Dynamic Knowledge Fusion Framework ‣ 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">7</span></a> can identify the original item index. The sequential recommendation task based on human instruction prompt can be conveniently formulated as language generation task. The optimization objective is defined as the negative log-likelihood as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\rm LLM}=-\sum_{b=1}^{B}\log F(i^{*}_{b}|P_{b})," class="ltx_Math" display="block" id="S4.E9.m1.1"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><msub id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.3.2.cmml">ℒ</mi><mi id="S4.E9.m1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.3.3.cmml">LLM</mi></msub><mo id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.1.1.1.1.1a" xref="S4.E9.m1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml"><munderover id="S4.E9.m1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml"><mo id="S4.E9.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.2.2.3" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.cmml">b</mi><mo id="S4.E9.m1.1.1.1.1.1.1.2.2.3.1" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E9.m1.1.1.1.1.1.1.2.2.3.3" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.1.2.3.cmml">B</mi></munderover><mrow id="S4.E9.m1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.3.1" xref="S4.E9.m1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E9.m1.1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.E9.m1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.3.2.cmml">F</mi></mrow><mo id="S4.E9.m1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">i</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">b</mi><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msubsup><mo fence="false" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">P</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">b</mi></msub></mrow><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><eq id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2"></eq><apply id="S4.E9.m1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2">ℒ</ci><ci id="S4.E9.m1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.3">LLM</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><minus id="S4.E9.m1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1"></minus><apply id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1"><apply id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E9.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3"><eq id="S4.E9.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.2">𝑏</ci><cn id="S4.E9.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.3">𝐵</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1"><times id="S4.E9.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.2"></times><apply id="S4.E9.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.3"><log id="S4.E9.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.3.1"></log><ci id="S4.E9.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.3.2">𝐹</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑖</ci><times id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑃</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\mathcal{L}_{\rm LLM}=-\sum_{b=1}^{B}\log F(i^{*}_{b}|P_{b}),</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_LLM end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_b = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT roman_log italic_F ( italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT | italic_P start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS1.p3.16">where <math alttext="F" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.12.m1.1"><semantics id="S4.SS2.SSS1.p3.12.m1.1a"><mi id="S4.SS2.SSS1.p3.12.m1.1.1" xref="S4.SS2.SSS1.p3.12.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.12.m1.1b"><ci id="S4.SS2.SSS1.p3.12.m1.1.1.cmml" xref="S4.SS2.SSS1.p3.12.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.12.m1.1c">F</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.12.m1.1d">italic_F</annotation></semantics></math> is the combination of the LLM backbone and the LM head, <math alttext="B" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.13.m2.1"><semantics id="S4.SS2.SSS1.p3.13.m2.1a"><mi id="S4.SS2.SSS1.p3.13.m2.1.1" xref="S4.SS2.SSS1.p3.13.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.13.m2.1b"><ci id="S4.SS2.SSS1.p3.13.m2.1.1.cmml" xref="S4.SS2.SSS1.p3.13.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.13.m2.1c">B</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.13.m2.1d">italic_B</annotation></semantics></math> represents the batch-size, <math alttext="i^{*}_{b}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.14.m3.1"><semantics id="S4.SS2.SSS1.p3.14.m3.1a"><msubsup id="S4.SS2.SSS1.p3.14.m3.1.1" xref="S4.SS2.SSS1.p3.14.m3.1.1.cmml"><mi id="S4.SS2.SSS1.p3.14.m3.1.1.2.2" xref="S4.SS2.SSS1.p3.14.m3.1.1.2.2.cmml">i</mi><mi id="S4.SS2.SSS1.p3.14.m3.1.1.3" xref="S4.SS2.SSS1.p3.14.m3.1.1.3.cmml">b</mi><mo id="S4.SS2.SSS1.p3.14.m3.1.1.2.3" xref="S4.SS2.SSS1.p3.14.m3.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.14.m3.1b"><apply id="S4.SS2.SSS1.p3.14.m3.1.1.cmml" xref="S4.SS2.SSS1.p3.14.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.14.m3.1.1.1.cmml" xref="S4.SS2.SSS1.p3.14.m3.1.1">subscript</csymbol><apply id="S4.SS2.SSS1.p3.14.m3.1.1.2.cmml" xref="S4.SS2.SSS1.p3.14.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.14.m3.1.1.2.1.cmml" xref="S4.SS2.SSS1.p3.14.m3.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p3.14.m3.1.1.2.2.cmml" xref="S4.SS2.SSS1.p3.14.m3.1.1.2.2">𝑖</ci><times id="S4.SS2.SSS1.p3.14.m3.1.1.2.3.cmml" xref="S4.SS2.SSS1.p3.14.m3.1.1.2.3"></times></apply><ci id="S4.SS2.SSS1.p3.14.m3.1.1.3.cmml" xref="S4.SS2.SSS1.p3.14.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.14.m3.1c">i^{*}_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.14.m3.1d">italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="P_{b}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.15.m4.1"><semantics id="S4.SS2.SSS1.p3.15.m4.1a"><msub id="S4.SS2.SSS1.p3.15.m4.1.1" xref="S4.SS2.SSS1.p3.15.m4.1.1.cmml"><mi id="S4.SS2.SSS1.p3.15.m4.1.1.2" xref="S4.SS2.SSS1.p3.15.m4.1.1.2.cmml">P</mi><mi id="S4.SS2.SSS1.p3.15.m4.1.1.3" xref="S4.SS2.SSS1.p3.15.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.15.m4.1b"><apply id="S4.SS2.SSS1.p3.15.m4.1.1.cmml" xref="S4.SS2.SSS1.p3.15.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p3.15.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p3.15.m4.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p3.15.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p3.15.m4.1.1.2">𝑃</ci><ci id="S4.SS2.SSS1.p3.15.m4.1.1.3.cmml" xref="S4.SS2.SSS1.p3.15.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.15.m4.1c">P_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.15.m4.1d">italic_P start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> is the ground-truth semantic index and the human instruction of the <math alttext="b" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p3.16.m5.1"><semantics id="S4.SS2.SSS1.p3.16.m5.1a"><mi id="S4.SS2.SSS1.p3.16.m5.1.1" xref="S4.SS2.SSS1.p3.16.m5.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p3.16.m5.1b"><ci id="S4.SS2.SSS1.p3.16.m5.1.1.cmml" xref="S4.SS2.SSS1.p3.16.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p3.16.m5.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p3.16.m5.1d">italic_b</annotation></semantics></math>-th batch, respectively.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS2.1.1">Hierarchical Index Mechanism</span>
</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.3">Considering the computation increment caused by the extended vocabulary, TTDS recommender adopts hierarchical index mechanism whose expressive space increases exponentially with the index length. Within the hierarchical index mechanism, <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.1.m1.1"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><mi id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><ci id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.1.m1.1d">italic_M</annotation></semantics></math> semantic tokens constitute one semantic index to represents one user/item. Taking item <math alttext="I_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.2.m2.1"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><msub id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p1.2.m2.1.1.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml">I</mi><mi id="S4.SS2.SSS2.p1.2.m2.1.1.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><apply id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2">𝐼</ci><ci id="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">I_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.2.m2.1d">italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> as an example, the quantization procedure in Formula <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.E7" title="In 4.2.1. Dynamic Knowledge Fusion Framework ‣ 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">7</span></a> will be conducted <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p1.3.m3.1"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><mi id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><ci id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p1.3.m3.1d">italic_M</annotation></semantics></math> times in a residual manner, formulated as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="i^{*}_{m}=\mathop{\arg\min}\limits_{i}\mathcal{D}(X_{k,m}^{I},c_{i,m})," class="ltx_Math" display="block" id="S4.E10.m1.5"><semantics id="S4.E10.m1.5a"><mrow id="S4.E10.m1.5.5.1" xref="S4.E10.m1.5.5.1.1.cmml"><mrow id="S4.E10.m1.5.5.1.1" xref="S4.E10.m1.5.5.1.1.cmml"><msubsup id="S4.E10.m1.5.5.1.1.4" xref="S4.E10.m1.5.5.1.1.4.cmml"><mi id="S4.E10.m1.5.5.1.1.4.2.2" xref="S4.E10.m1.5.5.1.1.4.2.2.cmml">i</mi><mi id="S4.E10.m1.5.5.1.1.4.3" xref="S4.E10.m1.5.5.1.1.4.3.cmml">m</mi><mo id="S4.E10.m1.5.5.1.1.4.2.3" xref="S4.E10.m1.5.5.1.1.4.2.3.cmml">∗</mo></msubsup><mo id="S4.E10.m1.5.5.1.1.3" xref="S4.E10.m1.5.5.1.1.3.cmml">=</mo><mrow id="S4.E10.m1.5.5.1.1.2" xref="S4.E10.m1.5.5.1.1.2.cmml"><munder id="S4.E10.m1.5.5.1.1.2.3" xref="S4.E10.m1.5.5.1.1.2.3.cmml"><mrow id="S4.E10.m1.5.5.1.1.2.3.2" xref="S4.E10.m1.5.5.1.1.2.3.2.cmml"><mi id="S4.E10.m1.5.5.1.1.2.3.2.1" xref="S4.E10.m1.5.5.1.1.2.3.2.1.cmml">arg</mi><mo id="S4.E10.m1.5.5.1.1.2.3.2a" lspace="0.167em" xref="S4.E10.m1.5.5.1.1.2.3.2.cmml">⁡</mo><mi id="S4.E10.m1.5.5.1.1.2.3.2.2" xref="S4.E10.m1.5.5.1.1.2.3.2.2.cmml">min</mi></mrow><mi id="S4.E10.m1.5.5.1.1.2.3.3" xref="S4.E10.m1.5.5.1.1.2.3.3.cmml">i</mi></munder><mrow id="S4.E10.m1.5.5.1.1.2.2" xref="S4.E10.m1.5.5.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.5.5.1.1.2.2.4" xref="S4.E10.m1.5.5.1.1.2.2.4.cmml">𝒟</mi><mo id="S4.E10.m1.5.5.1.1.2.2.3" xref="S4.E10.m1.5.5.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.E10.m1.5.5.1.1.2.2.2.2" xref="S4.E10.m1.5.5.1.1.2.2.2.3.cmml"><mo id="S4.E10.m1.5.5.1.1.2.2.2.2.3" stretchy="false" xref="S4.E10.m1.5.5.1.1.2.2.2.3.cmml">(</mo><msubsup id="S4.E10.m1.5.5.1.1.1.1.1.1.1" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.2.2.cmml">X</mi><mrow id="S4.E10.m1.2.2.2.4" xref="S4.E10.m1.2.2.2.3.cmml"><mi id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">k</mi><mo id="S4.E10.m1.2.2.2.4.1" xref="S4.E10.m1.2.2.2.3.cmml">,</mo><mi id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.2.cmml">m</mi></mrow><mi id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.cmml">I</mi></msubsup><mo id="S4.E10.m1.5.5.1.1.2.2.2.2.4" xref="S4.E10.m1.5.5.1.1.2.2.2.3.cmml">,</mo><msub id="S4.E10.m1.5.5.1.1.2.2.2.2.2" xref="S4.E10.m1.5.5.1.1.2.2.2.2.2.cmml"><mi id="S4.E10.m1.5.5.1.1.2.2.2.2.2.2" xref="S4.E10.m1.5.5.1.1.2.2.2.2.2.2.cmml">c</mi><mrow id="S4.E10.m1.4.4.2.4" xref="S4.E10.m1.4.4.2.3.cmml"><mi id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1.cmml">i</mi><mo id="S4.E10.m1.4.4.2.4.1" xref="S4.E10.m1.4.4.2.3.cmml">,</mo><mi id="S4.E10.m1.4.4.2.2" xref="S4.E10.m1.4.4.2.2.cmml">m</mi></mrow></msub><mo id="S4.E10.m1.5.5.1.1.2.2.2.2.5" stretchy="false" xref="S4.E10.m1.5.5.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E10.m1.5.5.1.2" xref="S4.E10.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.5b"><apply id="S4.E10.m1.5.5.1.1.cmml" xref="S4.E10.m1.5.5.1"><eq id="S4.E10.m1.5.5.1.1.3.cmml" xref="S4.E10.m1.5.5.1.1.3"></eq><apply id="S4.E10.m1.5.5.1.1.4.cmml" xref="S4.E10.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.4.1.cmml" xref="S4.E10.m1.5.5.1.1.4">subscript</csymbol><apply id="S4.E10.m1.5.5.1.1.4.2.cmml" xref="S4.E10.m1.5.5.1.1.4"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.4.2.1.cmml" xref="S4.E10.m1.5.5.1.1.4">superscript</csymbol><ci id="S4.E10.m1.5.5.1.1.4.2.2.cmml" xref="S4.E10.m1.5.5.1.1.4.2.2">𝑖</ci><times id="S4.E10.m1.5.5.1.1.4.2.3.cmml" xref="S4.E10.m1.5.5.1.1.4.2.3"></times></apply><ci id="S4.E10.m1.5.5.1.1.4.3.cmml" xref="S4.E10.m1.5.5.1.1.4.3">𝑚</ci></apply><apply id="S4.E10.m1.5.5.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.2"><apply id="S4.E10.m1.5.5.1.1.2.3.cmml" xref="S4.E10.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.2.3.1.cmml" xref="S4.E10.m1.5.5.1.1.2.3">subscript</csymbol><apply id="S4.E10.m1.5.5.1.1.2.3.2.cmml" xref="S4.E10.m1.5.5.1.1.2.3.2"><arg id="S4.E10.m1.5.5.1.1.2.3.2.1.cmml" xref="S4.E10.m1.5.5.1.1.2.3.2.1"></arg><min id="S4.E10.m1.5.5.1.1.2.3.2.2.cmml" xref="S4.E10.m1.5.5.1.1.2.3.2.2"></min></apply><ci id="S4.E10.m1.5.5.1.1.2.3.3.cmml" xref="S4.E10.m1.5.5.1.1.2.3.3">𝑖</ci></apply><apply id="S4.E10.m1.5.5.1.1.2.2.cmml" xref="S4.E10.m1.5.5.1.1.2.2"><times id="S4.E10.m1.5.5.1.1.2.2.3.cmml" xref="S4.E10.m1.5.5.1.1.2.2.3"></times><ci id="S4.E10.m1.5.5.1.1.2.2.4.cmml" xref="S4.E10.m1.5.5.1.1.2.2.4">𝒟</ci><interval closure="open" id="S4.E10.m1.5.5.1.1.2.2.2.3.cmml" xref="S4.E10.m1.5.5.1.1.2.2.2.2"><apply id="S4.E10.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E10.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.2.2">𝑋</ci><list id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.4"><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">𝑘</ci><ci id="S4.E10.m1.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2">𝑚</ci></list></apply><ci id="S4.E10.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.1.3">𝐼</ci></apply><apply id="S4.E10.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S4.E10.m1.5.5.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S4.E10.m1.5.5.1.1.2.2.2.2.2">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S4.E10.m1.5.5.1.1.2.2.2.2.2.2">𝑐</ci><list id="S4.E10.m1.4.4.2.3.cmml" xref="S4.E10.m1.4.4.2.4"><ci id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1.1">𝑖</ci><ci id="S4.E10.m1.4.4.2.2.cmml" xref="S4.E10.m1.4.4.2.2">𝑚</ci></list></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.5c">i^{*}_{m}=\mathop{\arg\min}\limits_{i}\mathcal{D}(X_{k,m}^{I},c_{i,m}),</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.5d">italic_i start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = start_BIGOP roman_arg roman_min end_BIGOP start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT caligraphic_D ( italic_X start_POSTSUBSCRIPT italic_k , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT , italic_c start_POSTSUBSCRIPT italic_i , italic_m end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="X_{k,m}^{I}=X_{k,m-1}^{I}-c_{m-1}^{*}." class="ltx_Math" display="block" id="S4.E11.m1.5"><semantics id="S4.E11.m1.5a"><mrow id="S4.E11.m1.5.5.1" xref="S4.E11.m1.5.5.1.1.cmml"><mrow id="S4.E11.m1.5.5.1.1" xref="S4.E11.m1.5.5.1.1.cmml"><msubsup id="S4.E11.m1.5.5.1.1.2" xref="S4.E11.m1.5.5.1.1.2.cmml"><mi id="S4.E11.m1.5.5.1.1.2.2.2" xref="S4.E11.m1.5.5.1.1.2.2.2.cmml">X</mi><mrow id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.3.cmml"><mi id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml">k</mi><mo id="S4.E11.m1.2.2.2.4.1" xref="S4.E11.m1.2.2.2.3.cmml">,</mo><mi id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml">m</mi></mrow><mi id="S4.E11.m1.5.5.1.1.2.3" xref="S4.E11.m1.5.5.1.1.2.3.cmml">I</mi></msubsup><mo id="S4.E11.m1.5.5.1.1.1" xref="S4.E11.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E11.m1.5.5.1.1.3" xref="S4.E11.m1.5.5.1.1.3.cmml"><msubsup id="S4.E11.m1.5.5.1.1.3.2" xref="S4.E11.m1.5.5.1.1.3.2.cmml"><mi id="S4.E11.m1.5.5.1.1.3.2.2.2" xref="S4.E11.m1.5.5.1.1.3.2.2.2.cmml">X</mi><mrow id="S4.E11.m1.4.4.2.2" xref="S4.E11.m1.4.4.2.3.cmml"><mi id="S4.E11.m1.3.3.1.1" xref="S4.E11.m1.3.3.1.1.cmml">k</mi><mo id="S4.E11.m1.4.4.2.2.2" xref="S4.E11.m1.4.4.2.3.cmml">,</mo><mrow id="S4.E11.m1.4.4.2.2.1" xref="S4.E11.m1.4.4.2.2.1.cmml"><mi id="S4.E11.m1.4.4.2.2.1.2" xref="S4.E11.m1.4.4.2.2.1.2.cmml">m</mi><mo id="S4.E11.m1.4.4.2.2.1.1" xref="S4.E11.m1.4.4.2.2.1.1.cmml">−</mo><mn id="S4.E11.m1.4.4.2.2.1.3" xref="S4.E11.m1.4.4.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="S4.E11.m1.5.5.1.1.3.2.3" xref="S4.E11.m1.5.5.1.1.3.2.3.cmml">I</mi></msubsup><mo id="S4.E11.m1.5.5.1.1.3.1" xref="S4.E11.m1.5.5.1.1.3.1.cmml">−</mo><msubsup id="S4.E11.m1.5.5.1.1.3.3" xref="S4.E11.m1.5.5.1.1.3.3.cmml"><mi id="S4.E11.m1.5.5.1.1.3.3.2.2" xref="S4.E11.m1.5.5.1.1.3.3.2.2.cmml">c</mi><mrow id="S4.E11.m1.5.5.1.1.3.3.2.3" xref="S4.E11.m1.5.5.1.1.3.3.2.3.cmml"><mi id="S4.E11.m1.5.5.1.1.3.3.2.3.2" xref="S4.E11.m1.5.5.1.1.3.3.2.3.2.cmml">m</mi><mo id="S4.E11.m1.5.5.1.1.3.3.2.3.1" xref="S4.E11.m1.5.5.1.1.3.3.2.3.1.cmml">−</mo><mn id="S4.E11.m1.5.5.1.1.3.3.2.3.3" xref="S4.E11.m1.5.5.1.1.3.3.2.3.3.cmml">1</mn></mrow><mo id="S4.E11.m1.5.5.1.1.3.3.3" xref="S4.E11.m1.5.5.1.1.3.3.3.cmml">∗</mo></msubsup></mrow></mrow><mo id="S4.E11.m1.5.5.1.2" lspace="0em" xref="S4.E11.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.5b"><apply id="S4.E11.m1.5.5.1.1.cmml" xref="S4.E11.m1.5.5.1"><eq id="S4.E11.m1.5.5.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1"></eq><apply id="S4.E11.m1.5.5.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2.2.2">𝑋</ci><list id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.4"><ci id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1">𝑘</ci><ci id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2">𝑚</ci></list></apply><ci id="S4.E11.m1.5.5.1.1.2.3.cmml" xref="S4.E11.m1.5.5.1.1.2.3">𝐼</ci></apply><apply id="S4.E11.m1.5.5.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.3"><minus id="S4.E11.m1.5.5.1.1.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3.1"></minus><apply id="S4.E11.m1.5.5.1.1.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.3.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2.2.2">𝑋</ci><list id="S4.E11.m1.4.4.2.3.cmml" xref="S4.E11.m1.4.4.2.2"><ci id="S4.E11.m1.3.3.1.1.cmml" xref="S4.E11.m1.3.3.1.1">𝑘</ci><apply id="S4.E11.m1.4.4.2.2.1.cmml" xref="S4.E11.m1.4.4.2.2.1"><minus id="S4.E11.m1.4.4.2.2.1.1.cmml" xref="S4.E11.m1.4.4.2.2.1.1"></minus><ci id="S4.E11.m1.4.4.2.2.1.2.cmml" xref="S4.E11.m1.4.4.2.2.1.2">𝑚</ci><cn id="S4.E11.m1.4.4.2.2.1.3.cmml" type="integer" xref="S4.E11.m1.4.4.2.2.1.3">1</cn></apply></list></apply><ci id="S4.E11.m1.5.5.1.1.3.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.2.3">𝐼</ci></apply><apply id="S4.E11.m1.5.5.1.1.3.3.cmml" xref="S4.E11.m1.5.5.1.1.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3">superscript</csymbol><apply id="S4.E11.m1.5.5.1.1.3.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.3.3.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3">subscript</csymbol><ci id="S4.E11.m1.5.5.1.1.3.3.2.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.2">𝑐</ci><apply id="S4.E11.m1.5.5.1.1.3.3.2.3.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.3"><minus id="S4.E11.m1.5.5.1.1.3.3.2.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.3.1"></minus><ci id="S4.E11.m1.5.5.1.1.3.3.2.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.3.2.3.2">𝑚</ci><cn id="S4.E11.m1.5.5.1.1.3.3.2.3.3.cmml" type="integer" xref="S4.E11.m1.5.5.1.1.3.3.2.3.3">1</cn></apply></apply><times id="S4.E11.m1.5.5.1.1.3.3.3.cmml" xref="S4.E11.m1.5.5.1.1.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.5c">X_{k,m}^{I}=X_{k,m-1}^{I}-c_{m-1}^{*}.</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.5d">italic_X start_POSTSUBSCRIPT italic_k , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT = italic_X start_POSTSUBSCRIPT italic_k , italic_m - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT - italic_c start_POSTSUBSCRIPT italic_m - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<p class="ltx_p" id="S4.SS2.SSS2.p2.1">The semantic index of item <math alttext="I_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.1.m1.1"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><msub id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p2.1.m1.1.1.2" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml">I</mi><mi id="S4.SS2.SSS2.p2.1.m1.1.1.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.1.m1.1b"><apply id="S4.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.2">𝐼</ci><ci id="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.1.m1.1c">I_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.1.m1.1d">italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> can be represented as</p>
<table class="ltx_equation ltx_eqn_table" id="S4.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="{\rm Sid}_{I_{k}}=&lt;i_{1}^{*},i_{2}^{*},\cdots,i_{M}^{*}&gt;." class="ltx_math_unparsed" display="block" id="S4.Ex2.m1.1"><semantics id="S4.Ex2.m1.1a"><mrow id="S4.Ex2.m1.1b"><msub id="S4.Ex2.m1.1.2"><mi id="S4.Ex2.m1.1.2.2">Sid</mi><msub id="S4.Ex2.m1.1.2.3"><mi id="S4.Ex2.m1.1.2.3.2">I</mi><mi id="S4.Ex2.m1.1.2.3.3">k</mi></msub></msub><mo id="S4.Ex2.m1.1.3" rspace="0em">=</mo><mo id="S4.Ex2.m1.1.4" lspace="0em">&lt;</mo><msubsup id="S4.Ex2.m1.1.5"><mi id="S4.Ex2.m1.1.5.2.2">i</mi><mn id="S4.Ex2.m1.1.5.2.3">1</mn><mo id="S4.Ex2.m1.1.5.3">∗</mo></msubsup><mo id="S4.Ex2.m1.1.6">,</mo><msubsup id="S4.Ex2.m1.1.7"><mi id="S4.Ex2.m1.1.7.2.2">i</mi><mn id="S4.Ex2.m1.1.7.2.3">2</mn><mo id="S4.Ex2.m1.1.7.3">∗</mo></msubsup><mo id="S4.Ex2.m1.1.8">,</mo><mi id="S4.Ex2.m1.1.1" mathvariant="normal">⋯</mi><mo id="S4.Ex2.m1.1.9">,</mo><msubsup id="S4.Ex2.m1.1.10"><mi id="S4.Ex2.m1.1.10.2.2">i</mi><mi id="S4.Ex2.m1.1.10.2.3">M</mi><mo id="S4.Ex2.m1.1.10.3">∗</mo></msubsup><mo id="S4.Ex2.m1.1.11" rspace="0em">&gt;</mo><mo id="S4.Ex2.m1.1.12" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S4.Ex2.m1.1c">{\rm Sid}_{I_{k}}=&lt;i_{1}^{*},i_{2}^{*},\cdots,i_{M}^{*}&gt;.</annotation><annotation encoding="application/x-llamapun" id="S4.Ex2.m1.1d">roman_Sid start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT = &lt; italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT &gt; .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p2.5">Therefore, a <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.2.m1.1"><semantics id="S4.SS2.SSS2.p2.2.m1.1a"><mi id="S4.SS2.SSS2.p2.2.m1.1.1" xref="S4.SS2.SSS2.p2.2.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.2.m1.1b"><ci id="S4.SS2.SSS2.p2.2.m1.1.1.cmml" xref="S4.SS2.SSS2.p2.2.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.2.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.2.m1.1d">italic_M</annotation></semantics></math> length hierarchical index mechanism with <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.3.m2.1"><semantics id="S4.SS2.SSS2.p2.3.m2.1a"><mi id="S4.SS2.SSS2.p2.3.m2.1.1" xref="S4.SS2.SSS2.p2.3.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.3.m2.1b"><ci id="S4.SS2.SSS2.p2.3.m2.1.1.cmml" xref="S4.SS2.SSS2.p2.3.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.3.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.3.m2.1d">italic_N</annotation></semantics></math> as base can theoretically represents <math alttext="N^{M}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.4.m3.1"><semantics id="S4.SS2.SSS2.p2.4.m3.1a"><msup id="S4.SS2.SSS2.p2.4.m3.1.1" xref="S4.SS2.SSS2.p2.4.m3.1.1.cmml"><mi id="S4.SS2.SSS2.p2.4.m3.1.1.2" xref="S4.SS2.SSS2.p2.4.m3.1.1.2.cmml">N</mi><mi id="S4.SS2.SSS2.p2.4.m3.1.1.3" xref="S4.SS2.SSS2.p2.4.m3.1.1.3.cmml">M</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.4.m3.1b"><apply id="S4.SS2.SSS2.p2.4.m3.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p2.4.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p2.4.m3.1.1">superscript</csymbol><ci id="S4.SS2.SSS2.p2.4.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p2.4.m3.1.1.2">𝑁</ci><ci id="S4.SS2.SSS2.p2.4.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p2.4.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.4.m3.1c">N^{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.4.m3.1d">italic_N start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT</annotation></semantics></math> distinct items and the newly introduced tokens are merely <math alttext="N*M" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p2.5.m4.1"><semantics id="S4.SS2.SSS2.p2.5.m4.1a"><mrow id="S4.SS2.SSS2.p2.5.m4.1.1" xref="S4.SS2.SSS2.p2.5.m4.1.1.cmml"><mi id="S4.SS2.SSS2.p2.5.m4.1.1.2" xref="S4.SS2.SSS2.p2.5.m4.1.1.2.cmml">N</mi><mo id="S4.SS2.SSS2.p2.5.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS2.SSS2.p2.5.m4.1.1.1.cmml">∗</mo><mi id="S4.SS2.SSS2.p2.5.m4.1.1.3" xref="S4.SS2.SSS2.p2.5.m4.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p2.5.m4.1b"><apply id="S4.SS2.SSS2.p2.5.m4.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m4.1.1"><times id="S4.SS2.SSS2.p2.5.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p2.5.m4.1.1.1"></times><ci id="S4.SS2.SSS2.p2.5.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p2.5.m4.1.1.2">𝑁</ci><ci id="S4.SS2.SSS2.p2.5.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p2.5.m4.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p2.5.m4.1c">N*M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p2.5.m4.1d">italic_N ∗ italic_M</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3. </span><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS3.1.1">Dual-Modality Variational Auto-Encoder</span>
</h4>
<div class="ltx_para" id="S4.SS2.SSS3.p1">
<p class="ltx_p" id="S4.SS2.SSS3.p1.7">Within the proposed dynamic knowledge fusion framework, the newly generated user/item semantic tokens are used to extend the LLM vocabulary, to predict the next-item in an end-to-end manner. However, the LLM backbone is unfamiliar with the under-trained semantic tokens, compared with the natural language tokens well pre-trained on large-scale corpus. To facilitate the LLM understanding on semantic tokens, we propose a dual-modality variational auto-encoder (DM-VAE) which constructs multi-grained alignment between the natural language token and the semantic token. Given the continuous embedding <math alttext="X^{I}_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.1.m1.1"><semantics id="S4.SS2.SSS3.p1.1.m1.1a"><msubsup id="S4.SS2.SSS3.p1.1.m1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS3.p1.1.m1.1.1.2.2" xref="S4.SS2.SSS3.p1.1.m1.1.1.2.2.cmml">X</mi><mi id="S4.SS2.SSS3.p1.1.m1.1.1.3" xref="S4.SS2.SSS3.p1.1.m1.1.1.3.cmml">k</mi><mi id="S4.SS2.SSS3.p1.1.m1.1.1.2.3" xref="S4.SS2.SSS3.p1.1.m1.1.1.2.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.1.m1.1b"><apply id="S4.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><apply id="S4.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS3.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.2.2">𝑋</ci><ci id="S4.SS2.SSS3.p1.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.2.3">𝐼</ci></apply><ci id="S4.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.1.m1.1c">X^{I}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.1.m1.1d">italic_X start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and the semantic index <math alttext="{\rm Sid}_{I_{k}}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.2.m2.1"><semantics id="S4.SS2.SSS3.p1.2.m2.1a"><msub id="S4.SS2.SSS3.p1.2.m2.1.1" xref="S4.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS3.p1.2.m2.1.1.2" xref="S4.SS2.SSS3.p1.2.m2.1.1.2.cmml">Sid</mi><msub id="S4.SS2.SSS3.p1.2.m2.1.1.3" xref="S4.SS2.SSS3.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.SSS3.p1.2.m2.1.1.3.2" xref="S4.SS2.SSS3.p1.2.m2.1.1.3.2.cmml">I</mi><mi id="S4.SS2.SSS3.p1.2.m2.1.1.3.3" xref="S4.SS2.SSS3.p1.2.m2.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.2.m2.1b"><apply id="S4.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.2">Sid</ci><apply id="S4.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS3.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.3.2">𝐼</ci><ci id="S4.SS2.SSS3.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSS3.p1.2.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.2.m2.1c">{\rm Sid}_{I_{k}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.2.m2.1d">roman_Sid start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> of item <math alttext="I_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.3.m3.1"><semantics id="S4.SS2.SSS3.p1.3.m3.1a"><msub id="S4.SS2.SSS3.p1.3.m3.1.1" xref="S4.SS2.SSS3.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS3.p1.3.m3.1.1.2" xref="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml">I</mi><mi id="S4.SS2.SSS3.p1.3.m3.1.1.3" xref="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.3.m3.1b"><apply id="S4.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.2">𝐼</ci><ci id="S4.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS3.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.3.m3.1c">I_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.3.m3.1d">italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, we note that <math alttext="X^{I}_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.4.m4.1"><semantics id="S4.SS2.SSS3.p1.4.m4.1a"><msubsup id="S4.SS2.SSS3.p1.4.m4.1.1" xref="S4.SS2.SSS3.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS3.p1.4.m4.1.1.2.2" xref="S4.SS2.SSS3.p1.4.m4.1.1.2.2.cmml">X</mi><mi id="S4.SS2.SSS3.p1.4.m4.1.1.3" xref="S4.SS2.SSS3.p1.4.m4.1.1.3.cmml">k</mi><mi id="S4.SS2.SSS3.p1.4.m4.1.1.2.3" xref="S4.SS2.SSS3.p1.4.m4.1.1.2.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.4.m4.1b"><apply id="S4.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1">subscript</csymbol><apply id="S4.SS2.SSS3.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.4.m4.1.1.2.1.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS2.SSS3.p1.4.m4.1.1.2.2.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.2.2">𝑋</ci><ci id="S4.SS2.SSS3.p1.4.m4.1.1.2.3.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.2.3">𝐼</ci></apply><ci id="S4.SS2.SSS3.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS3.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.4.m4.1c">X^{I}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.4.m4.1d">italic_X start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="{\rm Sid}_{I_{k}}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.5.m5.1"><semantics id="S4.SS2.SSS3.p1.5.m5.1a"><msub id="S4.SS2.SSS3.p1.5.m5.1.1" xref="S4.SS2.SSS3.p1.5.m5.1.1.cmml"><mi id="S4.SS2.SSS3.p1.5.m5.1.1.2" xref="S4.SS2.SSS3.p1.5.m5.1.1.2.cmml">Sid</mi><msub id="S4.SS2.SSS3.p1.5.m5.1.1.3" xref="S4.SS2.SSS3.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.SSS3.p1.5.m5.1.1.3.2" xref="S4.SS2.SSS3.p1.5.m5.1.1.3.2.cmml">I</mi><mi id="S4.SS2.SSS3.p1.5.m5.1.1.3.3" xref="S4.SS2.SSS3.p1.5.m5.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.5.m5.1b"><apply id="S4.SS2.SSS3.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.5.m5.1.1.1.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.5.m5.1.1.2.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1.2">Sid</ci><apply id="S4.SS2.SSS3.p1.5.m5.1.1.3.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS3.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1.3.2">𝐼</ci><ci id="S4.SS2.SSS3.p1.5.m5.1.1.3.3.cmml" xref="S4.SS2.SSS3.p1.5.m5.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.5.m5.1c">{\rm Sid}_{I_{k}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.5.m5.1d">roman_Sid start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> are two different modalities of the same object. Therefore, the LLM representation of <math alttext="{\rm Sid}_{I_{k}}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.6.m6.1"><semantics id="S4.SS2.SSS3.p1.6.m6.1a"><msub id="S4.SS2.SSS3.p1.6.m6.1.1" xref="S4.SS2.SSS3.p1.6.m6.1.1.cmml"><mi id="S4.SS2.SSS3.p1.6.m6.1.1.2" xref="S4.SS2.SSS3.p1.6.m6.1.1.2.cmml">Sid</mi><msub id="S4.SS2.SSS3.p1.6.m6.1.1.3" xref="S4.SS2.SSS3.p1.6.m6.1.1.3.cmml"><mi id="S4.SS2.SSS3.p1.6.m6.1.1.3.2" xref="S4.SS2.SSS3.p1.6.m6.1.1.3.2.cmml">I</mi><mi id="S4.SS2.SSS3.p1.6.m6.1.1.3.3" xref="S4.SS2.SSS3.p1.6.m6.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.6.m6.1b"><apply id="S4.SS2.SSS3.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.2">Sid</ci><apply id="S4.SS2.SSS3.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.6.m6.1.1.3.1.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS3.p1.6.m6.1.1.3.2.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.3.2">𝐼</ci><ci id="S4.SS2.SSS3.p1.6.m6.1.1.3.3.cmml" xref="S4.SS2.SSS3.p1.6.m6.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.6.m6.1c">{\rm Sid}_{I_{k}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.6.m6.1d">roman_Sid start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> ought to be similar to <math alttext="X^{I}_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.7.m7.1"><semantics id="S4.SS2.SSS3.p1.7.m7.1a"><msubsup id="S4.SS2.SSS3.p1.7.m7.1.1" xref="S4.SS2.SSS3.p1.7.m7.1.1.cmml"><mi id="S4.SS2.SSS3.p1.7.m7.1.1.2.2" xref="S4.SS2.SSS3.p1.7.m7.1.1.2.2.cmml">X</mi><mi id="S4.SS2.SSS3.p1.7.m7.1.1.3" xref="S4.SS2.SSS3.p1.7.m7.1.1.3.cmml">k</mi><mi id="S4.SS2.SSS3.p1.7.m7.1.1.2.3" xref="S4.SS2.SSS3.p1.7.m7.1.1.2.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.7.m7.1b"><apply id="S4.SS2.SSS3.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.7.m7.1.1.1.cmml" xref="S4.SS2.SSS3.p1.7.m7.1.1">subscript</csymbol><apply id="S4.SS2.SSS3.p1.7.m7.1.1.2.cmml" xref="S4.SS2.SSS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.7.m7.1.1.2.1.cmml" xref="S4.SS2.SSS3.p1.7.m7.1.1">superscript</csymbol><ci id="S4.SS2.SSS3.p1.7.m7.1.1.2.2.cmml" xref="S4.SS2.SSS3.p1.7.m7.1.1.2.2">𝑋</ci><ci id="S4.SS2.SSS3.p1.7.m7.1.1.2.3.cmml" xref="S4.SS2.SSS3.p1.7.m7.1.1.2.3">𝐼</ci></apply><ci id="S4.SS2.SSS3.p1.7.m7.1.1.3.cmml" xref="S4.SS2.SSS3.p1.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.7.m7.1c">X^{I}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.7.m7.1d">italic_X start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>. We design the semantic index level reconstruction based on the optimization objective defined as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\rm ID}^{S}=\|X^{S}_{k}-X^{I}_{k}\|_{2}^{2}," class="ltx_Math" display="block" id="S4.E12.m1.1"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><msubsup id="S4.E12.m1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.3.2.2" xref="S4.E12.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S4.E12.m1.1.1.1.1.3.2.3" xref="S4.E12.m1.1.1.1.1.3.2.3.cmml">ID</mi><mi id="S4.E12.m1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.3.3.cmml">S</mi></msubsup><mo id="S4.E12.m1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.2.cmml">=</mo><msubsup id="S4.E12.m1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">X</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">S</mi></msubsup><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">X</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">I</mi></msubsup></mrow><mo id="S4.E12.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E12.m1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E12.m1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S4.E12.m1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow><mo id="S4.E12.m1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"><eq id="S4.E12.m1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.2"></eq><apply id="S4.E12.m1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E12.m1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.2.1.cmml" xref="S4.E12.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.2.2.cmml" xref="S4.E12.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S4.E12.m1.1.1.1.1.3.2.3.cmml" xref="S4.E12.m1.1.1.1.1.3.2.3">ID</ci></apply><ci id="S4.E12.m1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.3">𝑆</ci></apply><apply id="S4.E12.m1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1">subscript</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E12.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1"><minus id="S4.E12.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.2">𝑋</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.2.3">𝑆</ci></apply><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑋</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝐼</ci></apply><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn id="S4.E12.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E12.m1.1.1.1.1.1.1.3">2</cn></apply><cn id="S4.E12.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E12.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">\mathcal{L}_{\rm ID}^{S}=\|X^{S}_{k}-X^{I}_{k}\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_ID end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT = ∥ italic_X start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_X start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS3.p1.10">where <math alttext="X^{S}_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.8.m1.1"><semantics id="S4.SS2.SSS3.p1.8.m1.1a"><msubsup id="S4.SS2.SSS3.p1.8.m1.1.1" xref="S4.SS2.SSS3.p1.8.m1.1.1.cmml"><mi id="S4.SS2.SSS3.p1.8.m1.1.1.2.2" xref="S4.SS2.SSS3.p1.8.m1.1.1.2.2.cmml">X</mi><mi id="S4.SS2.SSS3.p1.8.m1.1.1.3" xref="S4.SS2.SSS3.p1.8.m1.1.1.3.cmml">k</mi><mi id="S4.SS2.SSS3.p1.8.m1.1.1.2.3" xref="S4.SS2.SSS3.p1.8.m1.1.1.2.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.8.m1.1b"><apply id="S4.SS2.SSS3.p1.8.m1.1.1.cmml" xref="S4.SS2.SSS3.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.8.m1.1.1.1.cmml" xref="S4.SS2.SSS3.p1.8.m1.1.1">subscript</csymbol><apply id="S4.SS2.SSS3.p1.8.m1.1.1.2.cmml" xref="S4.SS2.SSS3.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.8.m1.1.1.2.1.cmml" xref="S4.SS2.SSS3.p1.8.m1.1.1">superscript</csymbol><ci id="S4.SS2.SSS3.p1.8.m1.1.1.2.2.cmml" xref="S4.SS2.SSS3.p1.8.m1.1.1.2.2">𝑋</ci><ci id="S4.SS2.SSS3.p1.8.m1.1.1.2.3.cmml" xref="S4.SS2.SSS3.p1.8.m1.1.1.2.3">𝑆</ci></apply><ci id="S4.SS2.SSS3.p1.8.m1.1.1.3.cmml" xref="S4.SS2.SSS3.p1.8.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.8.m1.1c">X^{S}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.8.m1.1d">italic_X start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the LLM representation of <math alttext="{\rm Sid}_{I_{k}}" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.9.m2.1"><semantics id="S4.SS2.SSS3.p1.9.m2.1a"><msub id="S4.SS2.SSS3.p1.9.m2.1.1" xref="S4.SS2.SSS3.p1.9.m2.1.1.cmml"><mi id="S4.SS2.SSS3.p1.9.m2.1.1.2" xref="S4.SS2.SSS3.p1.9.m2.1.1.2.cmml">Sid</mi><msub id="S4.SS2.SSS3.p1.9.m2.1.1.3" xref="S4.SS2.SSS3.p1.9.m2.1.1.3.cmml"><mi id="S4.SS2.SSS3.p1.9.m2.1.1.3.2" xref="S4.SS2.SSS3.p1.9.m2.1.1.3.2.cmml">I</mi><mi id="S4.SS2.SSS3.p1.9.m2.1.1.3.3" xref="S4.SS2.SSS3.p1.9.m2.1.1.3.3.cmml">k</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.9.m2.1b"><apply id="S4.SS2.SSS3.p1.9.m2.1.1.cmml" xref="S4.SS2.SSS3.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.9.m2.1.1.1.cmml" xref="S4.SS2.SSS3.p1.9.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS3.p1.9.m2.1.1.2.cmml" xref="S4.SS2.SSS3.p1.9.m2.1.1.2">Sid</ci><apply id="S4.SS2.SSS3.p1.9.m2.1.1.3.cmml" xref="S4.SS2.SSS3.p1.9.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS3.p1.9.m2.1.1.3.1.cmml" xref="S4.SS2.SSS3.p1.9.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS3.p1.9.m2.1.1.3.2.cmml" xref="S4.SS2.SSS3.p1.9.m2.1.1.3.2">𝐼</ci><ci id="S4.SS2.SSS3.p1.9.m2.1.1.3.3.cmml" xref="S4.SS2.SSS3.p1.9.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.9.m2.1c">{\rm Sid}_{I_{k}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.9.m2.1d">roman_Sid start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. Notably, based on the hierarchical index mechanism, a single semantic index consists of <math alttext="M" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.10.m3.1"><semantics id="S4.SS2.SSS3.p1.10.m3.1a"><mi id="S4.SS2.SSS3.p1.10.m3.1.1" xref="S4.SS2.SSS3.p1.10.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.10.m3.1b"><ci id="S4.SS2.SSS3.p1.10.m3.1.1.cmml" xref="S4.SS2.SSS3.p1.10.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.10.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.10.m3.1d">italic_M</annotation></semantics></math> semantic tokens. We design the semantic token level reconstruction based on the optimization objective defined as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\rm Token}^{S}=\sum_{m=1}^{M}\|X_{k,m-1}^{I}-c_{m-1}^{*}\|_{2}^{2}." class="ltx_Math" display="block" id="S4.E13.m1.3"><semantics id="S4.E13.m1.3a"><mrow id="S4.E13.m1.3.3.1" xref="S4.E13.m1.3.3.1.1.cmml"><mrow id="S4.E13.m1.3.3.1.1" xref="S4.E13.m1.3.3.1.1.cmml"><msubsup id="S4.E13.m1.3.3.1.1.3" xref="S4.E13.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.3.3.1.1.3.2.2" xref="S4.E13.m1.3.3.1.1.3.2.2.cmml">ℒ</mi><mi id="S4.E13.m1.3.3.1.1.3.2.3" xref="S4.E13.m1.3.3.1.1.3.2.3.cmml">Token</mi><mi id="S4.E13.m1.3.3.1.1.3.3" xref="S4.E13.m1.3.3.1.1.3.3.cmml">S</mi></msubsup><mo id="S4.E13.m1.3.3.1.1.2" rspace="0.111em" xref="S4.E13.m1.3.3.1.1.2.cmml">=</mo><mrow id="S4.E13.m1.3.3.1.1.1" xref="S4.E13.m1.3.3.1.1.1.cmml"><munderover id="S4.E13.m1.3.3.1.1.1.2" xref="S4.E13.m1.3.3.1.1.1.2.cmml"><mo id="S4.E13.m1.3.3.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E13.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E13.m1.3.3.1.1.1.2.2.3" xref="S4.E13.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S4.E13.m1.3.3.1.1.1.2.2.3.2" xref="S4.E13.m1.3.3.1.1.1.2.2.3.2.cmml">m</mi><mo id="S4.E13.m1.3.3.1.1.1.2.2.3.1" xref="S4.E13.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E13.m1.3.3.1.1.1.2.2.3.3" xref="S4.E13.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E13.m1.3.3.1.1.1.2.3" xref="S4.E13.m1.3.3.1.1.1.2.3.cmml">M</mi></munderover><msubsup id="S4.E13.m1.3.3.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.cmml"><mrow id="S4.E13.m1.3.3.1.1.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S4.E13.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E13.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml">X</mi><mrow id="S4.E13.m1.2.2.2.2" xref="S4.E13.m1.2.2.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml">k</mi><mo id="S4.E13.m1.2.2.2.2.2" xref="S4.E13.m1.2.2.2.3.cmml">,</mo><mrow id="S4.E13.m1.2.2.2.2.1" xref="S4.E13.m1.2.2.2.2.1.cmml"><mi id="S4.E13.m1.2.2.2.2.1.2" xref="S4.E13.m1.2.2.2.2.1.2.cmml">m</mi><mo id="S4.E13.m1.2.2.2.2.1.1" xref="S4.E13.m1.2.2.2.2.1.1.cmml">−</mo><mn id="S4.E13.m1.2.2.2.2.1.3" xref="S4.E13.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">I</mi></msubsup><mo id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">c</mi><mrow id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.2.cmml">m</mi><mo id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.1" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow><mo id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">∗</mo></msubsup></mrow><mo id="S4.E13.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E13.m1.3.3.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E13.m1.3.3.1.1.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.1.1.3.cmml">2</mn><mn id="S4.E13.m1.3.3.1.1.1.1.3" xref="S4.E13.m1.3.3.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S4.E13.m1.3.3.1.2" lspace="0em" xref="S4.E13.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.3b"><apply id="S4.E13.m1.3.3.1.1.cmml" xref="S4.E13.m1.3.3.1"><eq id="S4.E13.m1.3.3.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.2"></eq><apply id="S4.E13.m1.3.3.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.3.1.cmml" xref="S4.E13.m1.3.3.1.1.3">superscript</csymbol><apply id="S4.E13.m1.3.3.1.1.3.2.cmml" xref="S4.E13.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.3.2.1.cmml" xref="S4.E13.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.3.2.2.cmml" xref="S4.E13.m1.3.3.1.1.3.2.2">ℒ</ci><ci id="S4.E13.m1.3.3.1.1.3.2.3.cmml" xref="S4.E13.m1.3.3.1.1.3.2.3">Token</ci></apply><ci id="S4.E13.m1.3.3.1.1.3.3.cmml" xref="S4.E13.m1.3.3.1.1.3.3">𝑆</ci></apply><apply id="S4.E13.m1.3.3.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1"><apply id="S4.E13.m1.3.3.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.2.1.cmml" xref="S4.E13.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S4.E13.m1.3.3.1.1.1.2.2.cmml" xref="S4.E13.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.2.2.1.cmml" xref="S4.E13.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S4.E13.m1.3.3.1.1.1.2.2.2.cmml" xref="S4.E13.m1.3.3.1.1.1.2.2.2"></sum><apply id="S4.E13.m1.3.3.1.1.1.2.2.3.cmml" xref="S4.E13.m1.3.3.1.1.1.2.2.3"><eq id="S4.E13.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S4.E13.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S4.E13.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S4.E13.m1.3.3.1.1.1.2.2.3.2">𝑚</ci><cn id="S4.E13.m1.3.3.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E13.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E13.m1.3.3.1.1.1.2.3.cmml" xref="S4.E13.m1.3.3.1.1.1.2.3">𝑀</ci></apply><apply id="S4.E13.m1.3.3.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1">superscript</csymbol><apply id="S4.E13.m1.3.3.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1">subscript</csymbol><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E13.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.2.2">𝑋</ci><list id="S4.E13.m1.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.2"><ci id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1">𝑘</ci><apply id="S4.E13.m1.2.2.2.2.1.cmml" xref="S4.E13.m1.2.2.2.2.1"><minus id="S4.E13.m1.2.2.2.2.1.1.cmml" xref="S4.E13.m1.2.2.2.2.1.1"></minus><ci id="S4.E13.m1.2.2.2.2.1.2.cmml" xref="S4.E13.m1.2.2.2.2.1.2">𝑚</ci><cn id="S4.E13.m1.2.2.2.2.1.3.cmml" type="integer" xref="S4.E13.m1.2.2.2.2.1.3">1</cn></apply></list></apply><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.2.3">𝐼</ci></apply><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">𝑐</ci><apply id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3"><minus id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.1"></minus><ci id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.2">𝑚</ci><cn id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.3.cmml" type="integer" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply><times id="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.3.3.1.1.1.1.1.1.1.1.3.3"></times></apply></apply></apply><cn id="S4.E13.m1.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S4.E13.m1.3.3.1.1.1.1.1.3">2</cn></apply><cn id="S4.E13.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S4.E13.m1.3.3.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.3c">\mathcal{L}_{\rm Token}^{S}=\sum_{m=1}^{M}\|X_{k,m-1}^{I}-c_{m-1}^{*}\|_{2}^{2}.</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.3d">caligraphic_L start_POSTSUBSCRIPT roman_Token end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT = ∑ start_POSTSUBSCRIPT italic_m = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ∥ italic_X start_POSTSUBSCRIPT italic_k , italic_m - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT - italic_c start_POSTSUBSCRIPT italic_m - 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS3.p1.12">The above two objective functions are also defined for the user branch. Overall, the optimization objective of DM-VAE is defined as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\rm DM-VAE}=\mathcal{L}_{\rm ID}^{S}+\beta*\mathcal{L}_{\rm Token%
}^{S}," class="ltx_Math" display="block" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.cmml"><msub id="S4.E14.m1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.1.1.1.1.2.2" xref="S4.E14.m1.1.1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.E14.m1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1.2.3.2" xref="S4.E14.m1.1.1.1.1.2.3.2.cmml">DM</mi><mo id="S4.E14.m1.1.1.1.1.2.3.1" xref="S4.E14.m1.1.1.1.1.2.3.1.cmml">−</mo><mi id="S4.E14.m1.1.1.1.1.2.3.3" xref="S4.E14.m1.1.1.1.1.2.3.3.cmml">VAE</mi></mrow></msub><mo id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.3.cmml"><msubsup id="S4.E14.m1.1.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.1.1.1.1.3.2.2.2" xref="S4.E14.m1.1.1.1.1.3.2.2.2.cmml">ℒ</mi><mi id="S4.E14.m1.1.1.1.1.3.2.2.3" xref="S4.E14.m1.1.1.1.1.3.2.2.3.cmml">ID</mi><mi id="S4.E14.m1.1.1.1.1.3.2.3" xref="S4.E14.m1.1.1.1.1.3.2.3.cmml">S</mi></msubsup><mo id="S4.E14.m1.1.1.1.1.3.1" xref="S4.E14.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E14.m1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.3.3.cmml"><mi id="S4.E14.m1.1.1.1.1.3.3.2" xref="S4.E14.m1.1.1.1.1.3.3.2.cmml">β</mi><mo id="S4.E14.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E14.m1.1.1.1.1.3.3.1.cmml">∗</mo><msubsup id="S4.E14.m1.1.1.1.1.3.3.3" xref="S4.E14.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14.m1.1.1.1.1.3.3.3.2.2" xref="S4.E14.m1.1.1.1.1.3.3.3.2.2.cmml">ℒ</mi><mi id="S4.E14.m1.1.1.1.1.3.3.3.2.3" xref="S4.E14.m1.1.1.1.1.3.3.3.2.3.cmml">Token</mi><mi id="S4.E14.m1.1.1.1.1.3.3.3.3" xref="S4.E14.m1.1.1.1.1.3.3.3.3.cmml">S</mi></msubsup></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1"><eq id="S4.E14.m1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"></eq><apply id="S4.E14.m1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2">ℒ</ci><apply id="S4.E14.m1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.3"><minus id="S4.E14.m1.1.1.1.1.2.3.1.cmml" xref="S4.E14.m1.1.1.1.1.2.3.1"></minus><ci id="S4.E14.m1.1.1.1.1.2.3.2.cmml" xref="S4.E14.m1.1.1.1.1.2.3.2">DM</ci><ci id="S4.E14.m1.1.1.1.1.2.3.3.cmml" xref="S4.E14.m1.1.1.1.1.2.3.3">VAE</ci></apply></apply><apply id="S4.E14.m1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.3"><plus id="S4.E14.m1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.1"></plus><apply id="S4.E14.m1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.2">ℒ</ci><ci id="S4.E14.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.2.2.3">ID</ci></apply><ci id="S4.E14.m1.1.1.1.1.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.2.3">𝑆</ci></apply><apply id="S4.E14.m1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3"><times id="S4.E14.m1.1.1.1.1.3.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.1"></times><ci id="S4.E14.m1.1.1.1.1.3.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.2">𝛽</ci><apply id="S4.E14.m1.1.1.1.1.3.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3.3.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.3.3.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3.2.2">ℒ</ci><ci id="S4.E14.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3.2.3">Token</ci></apply><ci id="S4.E14.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E14.m1.1.1.1.1.3.3.3.3">𝑆</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">\mathcal{L}_{\rm DM-VAE}=\mathcal{L}_{\rm ID}^{S}+\beta*\mathcal{L}_{\rm Token%
}^{S},</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_DM - roman_VAE end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT roman_ID end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT + italic_β ∗ caligraphic_L start_POSTSUBSCRIPT roman_Token end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_S end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS3.p1.11">where <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.11.m1.1"><semantics id="S4.SS2.SSS3.p1.11.m1.1a"><mi id="S4.SS2.SSS3.p1.11.m1.1.1" xref="S4.SS2.SSS3.p1.11.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.11.m1.1b"><ci id="S4.SS2.SSS3.p1.11.m1.1.1.cmml" xref="S4.SS2.SSS3.p1.11.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.11.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.11.m1.1d">italic_β</annotation></semantics></math> is the weighted parameter to control the loss magnitude.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="396" id="S4.F3.g1" src="x3.png" width="830"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>The Dual-Modality Variational Auto-Encoder</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F3.1">\Description</span></div>
</div>
</figure>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Performance comparison of TTDS recommender and baselines on three public datasets. The best and the runner-up performance are indicated in <span class="ltx_text ltx_font_bold" id="S4.T1.4.1">bold</span> and <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.5.2">underlined</span> font, respectively. For evaluation stability, the presented performance of TTDS is the average result over several distinct instructions. The <span class="ltx_text ltx_font_italic" id="S4.T1.6.3">Improvement</span> is defined as (Best-Second)/Second.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.7" style="width:597.6pt;height:213.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-105.0pt,37.4pt) scale(0.74,0.74) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.7.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S4.T1.7.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="5" id="S4.T1.7.1.1.1.2">Instruments</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" colspan="5" id="S4.T1.7.1.1.1.3">Games</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="5" id="S4.T1.7.1.1.1.4">Arts</th>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.7.1.2.2.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.2">HR@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.3">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.4">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.5">NDCG-5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.7.1.2.2.6">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.7">HR@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.8">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.9">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.10">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T1.7.1.2.2.11">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.12">HR@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.13">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.14">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.15">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T1.7.1.2.2.16">NDCG@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.7.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T1.7.1.3.1.1">FMLP-Rec</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.2">0.0480</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.3">0.0786</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.4">0.0988</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.5">0.0638</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.7.1.3.1.6">0.0704</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.7">0.0152</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.8">0.0571</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.9">0.0930</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.10">0.0361</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.7.1.3.1.11">0.0476</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.12">0.0310</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.13">0.0757</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.14">0.1046</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.15">0.0541</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.1.3.1.16">0.0634</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.4.2.1">Caser</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.2">0.0149</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.3">0.0543</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.4">0.0710</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.5">0.0355</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.4.2.6">0.0409</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.7">0.0085</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.8">0.0367</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.9">0.0617</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.10">0.0227</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.4.2.11">0.0307</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.12">0.0138</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.13">0.0379</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.14">0.0541</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.15">0.0262</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.4.2.16">0.0313</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.5.3.1">HGN</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.2">0.0523</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.3">0.0813</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.4">0.1048</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.5">0.0668</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.5.3.6">0.0744</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.7">0.0154</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.8">0.0517</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.9">0.0856</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.10">0.0333</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.5.3.11">0.0442</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.12">0.0300</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.13">0.0622</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.14">0.0875</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.15">0.0462</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.5.3.16">0.0544</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.6.4.1">GRU4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.2">0.0571</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.3">0.0821</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.4">0.1031</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.5">0.0698</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.6.4.6">0.0765</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.7">0.0176</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.8">0.0586</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.9">0.0964</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.10">0.0381</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.6.4.11">0.0502</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.12">0.0421</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.13">0.0749</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.14">0.0964</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.15">0.0590</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.6.4.16">0.0659</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.7.5.1">BERT4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.2">0.0435</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.3">0.0671</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.4">0.0822</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.5">0.0560</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.7.5.6">0.0608</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.7">0.0136</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.8">0.0482</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.9">0.0763</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.10">0.0311</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.7.5.11">0.0401</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.12">0.0337</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.13">0.0559</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.14">0.0713</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.15">0.0451</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.7.5.16">0.0500</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.8.6.1">SASRec</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.2">0.0503</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.3">0.0751</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.4">0.0947</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.5">0.0627</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.8.6.6">0.0690</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.7">0.0145</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.8">0.0581</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.9">0.0940</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.10">0.0365</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.8.6.11">0.0481</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.12">0.0225</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.13">0.0757</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.14">0.1016</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.15">0.0508</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.8.6.16">0.0592</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.9.7.1">FDSA</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.2">0.0520</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.3">0.0834</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.4">0.1046</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.5">0.0681</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.9.7.6">0.0750</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.7">0.0161</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.9.7.8.1">0.0644</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.9.7.9.1">0.1041</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.9.7.10.1">0.0404</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.9.7.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.9.7.11.1">0.0531</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.12">0.0451</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.13">0.0734</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.14">0.0933</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.15">0.0595</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.9.7.16">0.0660</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.10.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.10.8.1">S3-Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.2">0.0367</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.10.8.3.1">0.0863</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.10.8.4.1">0.1136</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.5">0.0626</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.10.8.6">0.0714</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.7">0.0119</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.8">0.0606</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.9">0.1002</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.10">0.0364</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.10.8.11">0.0491</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.12">0.0245</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.13">0.0767</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.10.8.14.1">0.1051</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.15">0.0521</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.10.8.16">0.0612</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.11.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.11.9.1">P5-CID</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.2">0.0587</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.3">0.0827</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.4">0.1016</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.5">0.0708</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.11.9.6">0.0768</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.7">0.0177</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.8">0.0506</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.9">0.0803</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.10">0.0342</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.11.9.11">0.0437</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.11.9.12.1">0.0485</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.13">0.0724</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.14">0.0902</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.15">0.0607</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.11.9.16">0.0664</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.12.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.12.10.1">TIGER</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.12.10.2.1">0.0608</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.12.10.3.1">0.0863</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.4">0.1064</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.12.10.5.1">0.0738</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.12.10.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.12.10.6.1">0.0803</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.12.10.7.1">0.0188</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.8">0.0599</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.9">0.0939</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.10">0.0392</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.12.10.11">0.0501</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.12">0.0465</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.12.10.13.1">0.0788</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.14">0.1012</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.15"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.12.10.15.1">0.0631</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.12.10.16"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.7.1.12.10.16.1">0.0703</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.13.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.13.11.1">CLLM4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.13.11.2">0.0336</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.13.11.3">0.0666</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.13.11.4">0.0845</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.13.11.5">0.0516</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.13.11.6">0.0574</td>
<td class="ltx_td" id="S4.T1.7.1.13.11.7"></td>
<td class="ltx_td" id="S4.T1.7.1.13.11.8"></td>
<td class="ltx_td" id="S4.T1.7.1.13.11.9"></td>
<td class="ltx_td" id="S4.T1.7.1.13.11.10"></td>
<td class="ltx_td ltx_border_r" id="S4.T1.7.1.13.11.11"></td>
<td class="ltx_td" id="S4.T1.7.1.13.11.12"></td>
<td class="ltx_td" id="S4.T1.7.1.13.11.13"></td>
<td class="ltx_td" id="S4.T1.7.1.13.11.14"></td>
<td class="ltx_td" id="S4.T1.7.1.13.11.15"></td>
<td class="ltx_td" id="S4.T1.7.1.13.11.16"></td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.14.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.14.12.1">LC-Rec LoRA</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.2">0.0576</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.3">0.0817</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.4">0.1009</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.5">0.0698</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.14.12.6">0.0760</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.7">0.0165</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.8">0.0520</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.9">0.0835</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.10">0.0342</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.14.12.11">0.0443</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.12">0.0367</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.13">0.0637</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.14">0.0837</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.15">0.0504</td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.14.12.16">0.0569</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.15.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S4.T1.7.1.15.13.1">TTDS (Ours)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.2"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.2.1">0.0714</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.3"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.3.1">0.1028</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.4"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.4.1">0.1281</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.5"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.5.1">0.0872</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.15.13.6"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.6.1">0.0947</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.7"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.7.1">0.0254</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.8"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.8.1">0.0704</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.9"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.9.1">0.1083</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.10"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.10.1">0.0480</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T1.7.1.15.13.11"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.11.1">0.0597</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.12"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.12.1">0.0639</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.13"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.13.1">0.1002</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.14"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.14.1">0.1260</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.15"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.15.1">0.0823</span></td>
<td class="ltx_td ltx_align_center" id="S4.T1.7.1.15.13.16"><span class="ltx_text ltx_font_bold" id="S4.T1.7.1.15.13.16.1">0.0906</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.1.16.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.7.1.16.14.1">Improvement</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.2">17.47%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.3">19.07%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.4">12.74%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.5">18.09%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.7.1.16.14.6">17.98%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.7">34.92%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.8">9.25%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.9">4.00%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.10">18.78%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.7.1.16.14.11">12.48%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.12">31.65%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.13">27.11%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.14">19.86%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.15">30.46%</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.7.1.16.14.16">28.86%</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.4. </span><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS4.1.1">High-Order User-Item Interaction Pattern</span>
</h4>
<div class="ltx_para" id="S4.SS2.SSS4.p1">
<p class="ltx_p" id="S4.SS2.SSS4.p1.2">Most of the existing LLM-based recommendation systems merely focus on the item-related information and design item-centred fine-tuning tasks, neglecting the high-order user-item interaction patterns implicated in the user historical behavior. On the basis of the interactive item sequence, the item co-occurrence pattern is easy to capture. However, the high-order user-item interaction patterns, such as the user co-purchase pattern and the user preference pattern, are implicit and difficult to modeling. To this end, we specifically customize a series of fine-tuning tasks oriented for the high-order user-item interaction patterns. First, inspired by the collaborative filtering technique, we design a user prediction task which is the counterpart of item sequential recommendation. We extract the users who purchase the same item and organize them as an interactive user sequence. The LLM backbone is prompted with the former several users and the human instruction is to predict the next user who is interested in the same item. An example instruction prompt is given as follows: <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS4.p1.2.2">You are an recommendation expert. The item <math alttext="{\rm Sid}_{I_{1}}" class="ltx_Math" display="inline" id="S4.SS2.SSS4.p1.1.1.m1.1"><semantics id="S4.SS2.SSS4.p1.1.1.m1.1a"><msub id="S4.SS2.SSS4.p1.1.1.m1.1.1" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS4.p1.1.1.m1.1.1.2" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.2.cmml">Sid</mi><msub id="S4.SS2.SSS4.p1.1.1.m1.1.1.3" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS4.p1.1.1.m1.1.1.3.2" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.3.2.cmml">I</mi><mn id="S4.SS2.SSS4.p1.1.1.m1.1.1.3.3" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.3.3.cmml">1</mn></msub></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS4.p1.1.1.m1.1b"><apply id="S4.SS2.SSS4.p1.1.1.m1.1.1.cmml" xref="S4.SS2.SSS4.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS4.p1.1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS4.p1.1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS4.p1.1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.2">Sid</ci><apply id="S4.SS2.SSS4.p1.1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS4.p1.1.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS4.p1.1.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.3.2">𝐼</ci><cn id="S4.SS2.SSS4.p1.1.1.m1.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS4.p1.1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS4.p1.1.1.m1.1c">{\rm Sid}_{I_{1}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS4.p1.1.1.m1.1d">roman_Sid start_POSTSUBSCRIPT italic_I start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> has been clicked by the following users: <math alttext="{\rm Sid}_{U_{9}},{\rm Sid}_{U_{5}},\cdots,{\rm Sid}_{U_{23}}" class="ltx_Math" display="inline" id="S4.SS2.SSS4.p1.2.2.m2.4"><semantics id="S4.SS2.SSS4.p1.2.2.m2.4a"><mrow id="S4.SS2.SSS4.p1.2.2.m2.4.4.3" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.4.cmml"><msub id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.cmml"><mi id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.2" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.2.cmml">Sid</mi><msub id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.cmml"><mi id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.2" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.2.cmml">U</mi><mn id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.3" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.3.cmml">9</mn></msub></msub><mo id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.4" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.cmml"><mi id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.2" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.2.cmml">Sid</mi><msub id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.cmml"><mi id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.2" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.2.cmml">U</mi><mn id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.3" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.3.cmml">5</mn></msub></msub><mo id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.5" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.4.cmml">,</mo><mi id="S4.SS2.SSS4.p1.2.2.m2.1.1" mathvariant="normal" xref="S4.SS2.SSS4.p1.2.2.m2.1.1.cmml">⋯</mi><mo id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.6" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.4.cmml">,</mo><msub id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.cmml"><mi id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.2" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.2.cmml">Sid</mi><msub id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.cmml"><mi id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.2" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.2.cmml">U</mi><mn id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.3" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.3.cmml">23</mn></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS4.p1.2.2.m2.4b"><list id="S4.SS2.SSS4.p1.2.2.m2.4.4.4.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3"><apply id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.1.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1">subscript</csymbol><ci id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.2.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.2">Sid</ci><apply id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.1.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.2.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.2">𝑈</ci><cn id="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.3.cmml" type="integer" xref="S4.SS2.SSS4.p1.2.2.m2.2.2.1.1.3.3">9</cn></apply></apply><apply id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.1.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2">subscript</csymbol><ci id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.2.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.2">Sid</ci><apply id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.1.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3">subscript</csymbol><ci id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.2.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.2">𝑈</ci><cn id="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.3.cmml" type="integer" xref="S4.SS2.SSS4.p1.2.2.m2.3.3.2.2.3.3">5</cn></apply></apply><ci id="S4.SS2.SSS4.p1.2.2.m2.1.1.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.1.1">⋯</ci><apply id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.1.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3">subscript</csymbol><ci id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.2.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.2">Sid</ci><apply id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.1.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.2.cmml" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.2">𝑈</ci><cn id="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.3.cmml" type="integer" xref="S4.SS2.SSS4.p1.2.2.m2.4.4.3.3.3.3">23</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS4.p1.2.2.m2.4c">{\rm Sid}_{U_{9}},{\rm Sid}_{U_{5}},\cdots,{\rm Sid}_{U_{23}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS4.p1.2.2.m2.4d">roman_Sid start_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT 9 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , roman_Sid start_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , ⋯ , roman_Sid start_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT 23 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. Can you predict another user who is interested in this item?</span></p>
</div>
<div class="ltx_para" id="S4.SS2.SSS4.p2">
<p class="ltx_p" id="S4.SS2.SSS4.p2.2">Furthermore, we also design fine-tuning tasks based on the user recent comments and search queries. The LLM backbone is prompted with the user historical interaction sequence and the human instruction is to deduce the user comment or the search query, which is able to reflect the user preference to a certain degree. Notably, the designed fine-tuning tasks oriented for the high-order user-item interaction patterns can also be formatted as language generation task in a sequence-to-sequence manner, with the optimization objective defined in Formula <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.E9" title="In 4.2.1. Dynamic Knowledge Fusion Framework ‣ 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">9</span></a>. The overall objective function of TTDS recommender system is defined as follows,</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\rm All}=\mathcal{L}_{\rm LLM}+\alpha*\mathcal{L}_{\rm DM-VAE}," class="ltx_Math" display="block" id="S4.E15.m1.1"><semantics id="S4.E15.m1.1a"><mrow id="S4.E15.m1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml"><msub id="S4.E15.m1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.2.2.cmml">ℒ</mi><mi id="S4.E15.m1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.2.3.cmml">All</mi></msub><mo id="S4.E15.m1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E15.m1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.3.cmml"><msub id="S4.E15.m1.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.1.1.1.1.3.2.2" xref="S4.E15.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S4.E15.m1.1.1.1.1.3.2.3" xref="S4.E15.m1.1.1.1.1.3.2.3.cmml">LLM</mi></msub><mo id="S4.E15.m1.1.1.1.1.3.1" xref="S4.E15.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E15.m1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.3.3.cmml"><mi id="S4.E15.m1.1.1.1.1.3.3.2" xref="S4.E15.m1.1.1.1.1.3.3.2.cmml">α</mi><mo id="S4.E15.m1.1.1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.E15.m1.1.1.1.1.3.3.1.cmml">∗</mo><msub id="S4.E15.m1.1.1.1.1.3.3.3" xref="S4.E15.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.1.1.1.1.3.3.3.2" xref="S4.E15.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mrow id="S4.E15.m1.1.1.1.1.3.3.3.3" xref="S4.E15.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S4.E15.m1.1.1.1.1.3.3.3.3.2" xref="S4.E15.m1.1.1.1.1.3.3.3.3.2.cmml">DM</mi><mo id="S4.E15.m1.1.1.1.1.3.3.3.3.1" xref="S4.E15.m1.1.1.1.1.3.3.3.3.1.cmml">−</mo><mi id="S4.E15.m1.1.1.1.1.3.3.3.3.3" xref="S4.E15.m1.1.1.1.1.3.3.3.3.3.cmml">VAE</mi></mrow></msub></mrow></mrow></mrow><mo id="S4.E15.m1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.1b"><apply id="S4.E15.m1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1"><eq id="S4.E15.m1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1"></eq><apply id="S4.E15.m1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.2.2">ℒ</ci><ci id="S4.E15.m1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.2.3">All</ci></apply><apply id="S4.E15.m1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.3"><plus id="S4.E15.m1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.3.1"></plus><apply id="S4.E15.m1.1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.3.2.1.cmml" xref="S4.E15.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.3.2.2.cmml" xref="S4.E15.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S4.E15.m1.1.1.1.1.3.2.3.cmml" xref="S4.E15.m1.1.1.1.1.3.2.3">LLM</ci></apply><apply id="S4.E15.m1.1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.1.3.3"><times id="S4.E15.m1.1.1.1.1.3.3.1.cmml" xref="S4.E15.m1.1.1.1.1.3.3.1"></times><ci id="S4.E15.m1.1.1.1.1.3.3.2.cmml" xref="S4.E15.m1.1.1.1.1.3.3.2">𝛼</ci><apply id="S4.E15.m1.1.1.1.1.3.3.3.cmml" xref="S4.E15.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.3.3.3.1.cmml" xref="S4.E15.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.3.3.3.2.cmml" xref="S4.E15.m1.1.1.1.1.3.3.3.2">ℒ</ci><apply id="S4.E15.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E15.m1.1.1.1.1.3.3.3.3"><minus id="S4.E15.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E15.m1.1.1.1.1.3.3.3.3.1"></minus><ci id="S4.E15.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.E15.m1.1.1.1.1.3.3.3.3.2">DM</ci><ci id="S4.E15.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.E15.m1.1.1.1.1.3.3.3.3.3">VAE</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.1c">\mathcal{L}_{\rm All}=\mathcal{L}_{\rm LLM}+\alpha*\mathcal{L}_{\rm DM-VAE},</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.1d">caligraphic_L start_POSTSUBSCRIPT roman_All end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT roman_LLM end_POSTSUBSCRIPT + italic_α ∗ caligraphic_L start_POSTSUBSCRIPT roman_DM - roman_VAE end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS4.p2.1">where <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS2.SSS4.p2.1.m1.1"><semantics id="S4.SS2.SSS4.p2.1.m1.1a"><mi id="S4.SS2.SSS4.p2.1.m1.1.1" xref="S4.SS2.SSS4.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS4.p2.1.m1.1b"><ci id="S4.SS2.SSS4.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS4.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS4.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS4.p2.1.m1.1d">italic_α</annotation></semantics></math> is the weighted hyper-parameter.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS5">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.5. </span><span class="ltx_text ltx_font_bold" id="S4.SS2.SSS5.1.1">Collision Handling Mechanism</span>
</h4>
<div class="ltx_para" id="S4.SS2.SSS5.p1">
<p class="ltx_p" id="S4.SS2.SSS5.p1.3">It is worth noting that the hierarchical index mechanism formulated by Formula <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.E10" title="In 4.2.2. Hierarchical Index Mechanism ‣ 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">10</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.E11" title="In 4.2.2. Hierarchical Index Mechanism ‣ 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">11</span></a> is unable to guarantee the semantic index uniqueness, i.e., different items/users are allocated with distinct semantic indices. Through the <span class="ltx_text ltx_font_italic" id="S4.SS2.SSS5.p1.3.1">argmin</span> operation over distance metric may result in semantic index collision, the corresponding recommender system is still practicable with a fairly low collision rate <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>)</cite>. In our practice, the collision rate is no more than <span class="ltx_text" id="S4.SS2.SSS5.p1.3.2" style="color:#0000FF;">1%</span>. However, on one hand, the collision rate is affected by the dataset scale, the model architecture, the training parameter, and so on, which is extremely uncontrollable. On the other hand, within some recommender systems, the index uniqueness is significant and must be guaranteed <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib31" title="">2024</a>)</cite>. Inspired by the rehashing method in hash collision, we append an additional token into the semantic index, representing the order inside the collision set <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib31" title="">2024</a>)</cite>. For example, two different items share the same semantic index <math alttext="&lt;1,2,3&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS2.SSS5.p1.1.m1.3"><semantics id="S4.SS2.SSS5.p1.1.m1.3a"><mrow id="S4.SS2.SSS5.p1.1.m1.3b"><mo id="S4.SS2.SSS5.p1.1.m1.3.4">&lt;</mo><mn id="S4.SS2.SSS5.p1.1.m1.1.1">1</mn><mo id="S4.SS2.SSS5.p1.1.m1.3.5">,</mo><mn id="S4.SS2.SSS5.p1.1.m1.2.2">2</mn><mo id="S4.SS2.SSS5.p1.1.m1.3.6">,</mo><mn id="S4.SS2.SSS5.p1.1.m1.3.3">3</mn><mo id="S4.SS2.SSS5.p1.1.m1.3.7">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.SSS5.p1.1.m1.3c">&lt;1,2,3&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS5.p1.1.m1.3d">&lt; 1 , 2 , 3 &gt;</annotation></semantics></math>. Then, the semantic indices will be remapped to <math alttext="&lt;1,2,3,p_{0}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS2.SSS5.p1.2.m2.3"><semantics id="S4.SS2.SSS5.p1.2.m2.3a"><mrow id="S4.SS2.SSS5.p1.2.m2.3b"><mo id="S4.SS2.SSS5.p1.2.m2.3.4">&lt;</mo><mn id="S4.SS2.SSS5.p1.2.m2.1.1">1</mn><mo id="S4.SS2.SSS5.p1.2.m2.3.5">,</mo><mn id="S4.SS2.SSS5.p1.2.m2.2.2">2</mn><mo id="S4.SS2.SSS5.p1.2.m2.3.6">,</mo><mn id="S4.SS2.SSS5.p1.2.m2.3.3">3</mn><mo id="S4.SS2.SSS5.p1.2.m2.3.7">,</mo><msub id="S4.SS2.SSS5.p1.2.m2.3.8"><mi id="S4.SS2.SSS5.p1.2.m2.3.8.2">p</mi><mn id="S4.SS2.SSS5.p1.2.m2.3.8.3">0</mn></msub><mo id="S4.SS2.SSS5.p1.2.m2.3.9">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.SSS5.p1.2.m2.3c">&lt;1,2,3,p_{0}&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS5.p1.2.m2.3d">&lt; 1 , 2 , 3 , italic_p start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT &gt;</annotation></semantics></math> and <math alttext="&lt;1,2,3,p_{1}&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS2.SSS5.p1.3.m3.3"><semantics id="S4.SS2.SSS5.p1.3.m3.3a"><mrow id="S4.SS2.SSS5.p1.3.m3.3b"><mo id="S4.SS2.SSS5.p1.3.m3.3.4">&lt;</mo><mn id="S4.SS2.SSS5.p1.3.m3.1.1">1</mn><mo id="S4.SS2.SSS5.p1.3.m3.3.5">,</mo><mn id="S4.SS2.SSS5.p1.3.m3.2.2">2</mn><mo id="S4.SS2.SSS5.p1.3.m3.3.6">,</mo><mn id="S4.SS2.SSS5.p1.3.m3.3.3">3</mn><mo id="S4.SS2.SSS5.p1.3.m3.3.7">,</mo><msub id="S4.SS2.SSS5.p1.3.m3.3.8"><mi id="S4.SS2.SSS5.p1.3.m3.3.8.2">p</mi><mn id="S4.SS2.SSS5.p1.3.m3.3.8.3">1</mn></msub><mo id="S4.SS2.SSS5.p1.3.m3.3.9">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.SSS5.p1.3.m3.3c">&lt;1,2,3,p_{1}&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS5.p1.3.m3.3d">&lt; 1 , 2 , 3 , italic_p start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT &gt;</annotation></semantics></math>, which scrupulously guarantee the index uniqueness.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Discussion</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To provide a comprehensive understanding to the proposed contribution and innovation, we conduct a discussion about the proposed TTDS recommender and several leading LLM-based generative recommender systems.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1. </span><span class="ltx_text ltx_font_bold" id="S4.SS3.SSS1.1.1">Index Mechanism</span>
</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">For the LLM-based generative recommender systems, the index mechanism is the fundamental of item representation during both model training and service deployment. CLLM4Rec <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib54" title="">2024</a>)</cite> adopts vanilla item index such as <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.1.1">¡item_1¿</span> and considers the item index as a special token which can be appended into the language model vocabulary, resulting in a linearly expanded vocabulary. Furthermore, semantic index based methods, including TIGER <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>)</cite>, LC-Rec <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>)</cite>, and LETTER <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib42" title="">2024</a>)</cite>, adopt residual vector quantization technique to hierarchically allocate item index (e.g., <math alttext="&lt;10,1,6&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS3.SSS1.p1.1.m1.3"><semantics id="S4.SS3.SSS1.p1.1.m1.3a"><mrow id="S4.SS3.SSS1.p1.1.m1.3b"><mo id="S4.SS3.SSS1.p1.1.m1.3.4">&lt;</mo><mn id="S4.SS3.SSS1.p1.1.m1.1.1">10</mn><mo id="S4.SS3.SSS1.p1.1.m1.3.5">,</mo><mn id="S4.SS3.SSS1.p1.1.m1.2.2">1</mn><mo id="S4.SS3.SSS1.p1.1.m1.3.6">,</mo><mn id="S4.SS3.SSS1.p1.1.m1.3.3">6</mn><mo id="S4.SS3.SSS1.p1.1.m1.3.7">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S4.SS3.SSS1.p1.1.m1.3c">&lt;10,1,6&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.SSS1.p1.1.m1.3d">&lt; 10 , 1 , 6 &gt;</annotation></semantics></math>), which reduce the vocabulary scale to a great extent. However, all of the aforementioned methods separate the item indexing process from the downstream sequential recommendation task, hindering the integration of the semantic and collaborative knowledge, thus leading to a sub-optimal performance. To overcome this limitation, we propose a dynamic knowledge fusion framework, where the semantic index generator are jointly optimized with the sequential recommender. Accordingly, the semantic knowledge and the collaborative knowledge are able to be fused sufficiently. Furthermore, we construct multi-grained alignment between the semantic index representation and the textual feature representation of the same item, to facilitate the understanding of newly introduced semantic tokens.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2. </span><span class="ltx_text ltx_font_bold" id="S4.SS3.SSS2.1.1">Sequential Recommendation</span>
</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">Existing LLM-based generative recommender systems taking the user historical interaction sequence as input and output an item index as the prediction result. Semantic index based methods, including TIGER, LC-Rec, and LETTER, all neglect the high-order user-item interaction patterns, such as the user co-purchase pattern and the user preference pattern, provide next-item prediction solely based on the interactive item sequence which contains the local item co-occurrence pattern. CLLM4Rec takes user comments into consideration and exploits the user preference to some extent. However, the user co-purchase pattern is also overlooked in CLLM4Rec and the vanilla user index fails to capture the user similarity, leading the moderate recommendation performance. In this paper, we propose to tokenize user representation into semantic user index and customize several high-order user-item interaction patterns exploitation tasks, promoting the TTDS recommender to model the collaborative knowledge.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiment</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we present and analyse the sequential recommendation performance of TTDS recommender on three public datasets. Furthermore, we investigate the effectiveness of the proposed innovations in TTDS recommender and the superiority of the dynamic semantic index. Finally, we describe several important and intriguing characteristics of TTDS recommender.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experimental Setup</h3>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1. </span><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS1.1.1">Dataset</span>
</h4>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.1">We evaluate the proposed TTDS recommender all the baseline models on public benchmarks from the Amazon Product Review dataset <cite class="ltx_cite ltx_citemacro_citep">(He and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib14" title="">2020</a>)</cite>, containing user review data from May 1996 to October 2018. Particularly, we extract three categories for the sequential recommendation task, i.e., <span class="ltx_text ltx_font_italic" id="S5.SS1.SSS1.p1.1.1">”Musical Instruments”</span>,<span class="ltx_text ltx_font_italic" id="S5.SS1.SSS1.p1.1.2">”Arts, Crafts and Sewing”</span>, and <span class="ltx_text ltx_font_italic" id="S5.SS1.SSS1.p1.1.3">”Video Games”</span>. Within the above datasets, each item is associated with a series of textual contents, including the item title, the detailed description, the item category, and so on. Similar to the user entity, the associated textual contents include the user comment, the search query, and so on. Following standard procedure, inactive users/items with less then 5 interactions are filtered out and the user interactive sequence is created according to the chronological order. The dataset statistics and detailed pre-processing are presented in Appendix A.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2. </span><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS2.1.1">Baseline</span>
</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.1">To comprehensively demonstrate the multifaceted superiority of TTDS recommender, the evaluation includes the following baselines based on various methodologies.</p>
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.1">MLP-Based</span>: <span class="ltx_text ltx_font_bold" id="S5.I1.i1.p1.1.2">FMLP-Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib53" title="">2022</a>)</cite> proposes an all-MLP model with learnable filters for sequential recommendation, ensuring efficiency and reduces noise signals.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.1">CNN-Based</span>: <span class="ltx_text ltx_font_bold" id="S5.I1.i2.p1.1.2">Caser</span> <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib47" title="">2019</a>)</cite> captures user behaviors by applying horizontal and vertical convolutional filters.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.1">RNN-Based</span>: <span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.2">HGN</span> <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib32" title="">2019</a>)</cite> utilizes hierarchical gating networks to capture both long-term and short-term user interests from historical behaviors. <span class="ltx_text ltx_font_bold" id="S5.I1.i3.p1.1.3">GRU4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Jannach and Ludewig, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib21" title="">2017</a>)</cite> is an sequential recommendation model that utilizes GRU <cite class="ltx_cite ltx_citemacro_citep">(Chung et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib3" title="">2014</a>)</cite> to encode the item sequence.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.1">GNN-Based</span>: <span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.2">SR-GNN</span> <cite class="ltx_cite ltx_citemacro_citep">(Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib45" title="">2019</a>)</cite> models session sequences as graph structured data, to capture complex transitions of items. <span class="ltx_text ltx_font_bold" id="S5.I1.i4.p1.1.3">GC-SAN</span> <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib46" title="">2019</a>)</cite> utilizes both graph neural network and self-attention mechanism, for session-based recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i5.p1">
<p class="ltx_p" id="S5.I1.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.2">Transformer-Based</span>: <span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.3">BERT4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib37" title="">2019</a>)</cite> adopts a bidirectional Transformer model and combines it with a mask prediction task for the item sequences modeling. <span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.4">SASRec</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib25" title="">2018</a>)</cite> exploits a unidirectional transformer model to capture the item sequences and predict the next item. <span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.5">FDSA</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib50" title="">2019b</a>)</cite> focuses on the transformation patterns between item features, modeling both item-level and feature-level sequences separately through self-attention networks. <span class="ltx_text ltx_font_bold" id="S5.I1.i5.p1.1.1">S<sup class="ltx_sup" id="S5.I1.i5.p1.1.1.1"><span class="ltx_text ltx_font_medium" id="S5.I1.i5.p1.1.1.1.1">3</span></sup>-Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib52" title="">2020</a>)</cite> utilizes mutual information maximization to pre-train a self-supervised sequential recommendation model, learning the correlation between items and attributes.</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i6.p1">
<p class="ltx_p" id="S5.I1.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I1.i6.p1.1.1">PLM/LLM-Based</span>: <span class="ltx_text ltx_font_bold" id="S5.I1.i6.p1.1.2">P5-CID</span> <cite class="ltx_cite ltx_citemacro_citep">(Geng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib9" title="">2022</a>)</cite> organizes multiple recommendation tasks in a text-to-text format and models different tasks uniformly using the T5 <cite class="ltx_cite ltx_citemacro_citep">(Gomez-Uribe and Hunt, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib10" title="">2016</a>)</cite> model. <span class="ltx_text ltx_font_bold" id="S5.I1.i6.p1.1.3">TIGER</span> <cite class="ltx_cite ltx_citemacro_citep">(Rajput et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib35" title="">2023</a>)</cite> adopts the generative retrieval paradigm for sequential recommendation and introduces a semantic ID to uniquely identify items. <span class="ltx_text ltx_font_bold" id="S5.I1.i6.p1.1.4">CLLM4Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib54" title="">2024</a>)</cite> proposes mixed prompting strategy based on heterogeneous tokens to fulfill sequential recommedation task. <span class="ltx_text ltx_font_bold" id="S5.I1.i6.p1.1.5">LC-Rec</span> <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib51" title="">2024</a>)</cite> extends the TIGER framework and further adopts LlaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib41" title="">2023</a>)</cite> as the recommeder backbone. Moreover, LC-Rec also design several semantic index oriented fine-tuning tasks.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3. </span><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS3.1.1">Evaluation Strategy</span>
</h4>
<div class="ltx_para" id="S5.SS1.SSS3.p1">
<p class="ltx_p" id="S5.SS1.SSS3.p1.1">We adopt the Top-K Hit-Rate (HR@K) with K = 1, 5, 10 and the Normalized Discounted Cumulative Gain (NDCG@K) with K = 5, 10 to evaluate the sequential recommendation performance. Following standard setting, the leave-one-out strategy is adopted. Specifically, the most recent item serves as the evaluation data, the second most recent item servers as the validation data, and the remaining interactive items form the training data. As an end-to-end generative recommender system, TTDS performs full ranking evaluation over the whole item set, instead of the sample-based or candidate-based evaluation.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.4. </span><span class="ltx_text ltx_font_bold" id="S5.SS1.SSS4.1.1">Implementation Detail</span>
</h4>
<div class="ltx_para" id="S5.SS1.SSS4.p1">
<p class="ltx_p" id="S5.SS1.SSS4.p1.2">We employ the open source large language model LlaMA <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib41" title="">2023</a>)</cite> developed by Meta and introduce low-rank adaption technique <cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib18" title="">2022</a>)</cite> for LlaMA fine-tuning. The representation dimension of LlaMA model is 4096. A language model head is appended to translating the hidden representation into the extended vocabulary. For the twin-tower dynamic semantic token generator, the semantic index length <math alttext="L" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.1.m1.1"><semantics id="S5.SS1.SSS4.p1.1.m1.1a"><mi id="S5.SS1.SSS4.p1.1.m1.1.1" xref="S5.SS1.SSS4.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.1.m1.1b"><ci id="S5.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.1.m1.1d">italic_L</annotation></semantics></math> is set as 4, and thus both the item and the user branch have 4 hierarchically connected codebooks respectively. Each codebook consists of 256 quantization embeddings whose dimension is set to 256. The encoder module within the semantic token generator contains a series of linear layers <math alttext="[4096,2048,1024,512,256]" class="ltx_Math" display="inline" id="S5.SS1.SSS4.p1.2.m2.5"><semantics id="S5.SS1.SSS4.p1.2.m2.5a"><mrow id="S5.SS1.SSS4.p1.2.m2.5.6.2" xref="S5.SS1.SSS4.p1.2.m2.5.6.1.cmml"><mo id="S5.SS1.SSS4.p1.2.m2.5.6.2.1" stretchy="false" xref="S5.SS1.SSS4.p1.2.m2.5.6.1.cmml">[</mo><mn id="S5.SS1.SSS4.p1.2.m2.1.1" xref="S5.SS1.SSS4.p1.2.m2.1.1.cmml">4096</mn><mo id="S5.SS1.SSS4.p1.2.m2.5.6.2.2" xref="S5.SS1.SSS4.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.2.m2.2.2" xref="S5.SS1.SSS4.p1.2.m2.2.2.cmml">2048</mn><mo id="S5.SS1.SSS4.p1.2.m2.5.6.2.3" xref="S5.SS1.SSS4.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.2.m2.3.3" xref="S5.SS1.SSS4.p1.2.m2.3.3.cmml">1024</mn><mo id="S5.SS1.SSS4.p1.2.m2.5.6.2.4" xref="S5.SS1.SSS4.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.2.m2.4.4" xref="S5.SS1.SSS4.p1.2.m2.4.4.cmml">512</mn><mo id="S5.SS1.SSS4.p1.2.m2.5.6.2.5" xref="S5.SS1.SSS4.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS1.SSS4.p1.2.m2.5.5" xref="S5.SS1.SSS4.p1.2.m2.5.5.cmml">256</mn><mo id="S5.SS1.SSS4.p1.2.m2.5.6.2.6" stretchy="false" xref="S5.SS1.SSS4.p1.2.m2.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.2.m2.5b"><list id="S5.SS1.SSS4.p1.2.m2.5.6.1.cmml" xref="S5.SS1.SSS4.p1.2.m2.5.6.2"><cn id="S5.SS1.SSS4.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS4.p1.2.m2.1.1">4096</cn><cn id="S5.SS1.SSS4.p1.2.m2.2.2.cmml" type="integer" xref="S5.SS1.SSS4.p1.2.m2.2.2">2048</cn><cn id="S5.SS1.SSS4.p1.2.m2.3.3.cmml" type="integer" xref="S5.SS1.SSS4.p1.2.m2.3.3">1024</cn><cn id="S5.SS1.SSS4.p1.2.m2.4.4.cmml" type="integer" xref="S5.SS1.SSS4.p1.2.m2.4.4">512</cn><cn id="S5.SS1.SSS4.p1.2.m2.5.5.cmml" type="integer" xref="S5.SS1.SSS4.p1.2.m2.5.5">256</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.2.m2.5c">[4096,2048,1024,512,256]</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS4.p1.2.m2.5d">[ 4096 , 2048 , 1024 , 512 , 256 ]</annotation></semantics></math>, gradually projecting the LlaMA representation into the codebook hidden space. We prepare a warm-up phase with a learning rate of 1e-3 for the twin-tower dynamic semantic token generator, by freezing the LlaMA-based recommender. For the TTDS recommender training phase, we adopt the AdamW <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#bib.bib26" title="">2015</a>)</cite> optimizer with a learning rate of 5e-4.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Main Result</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">In this section, we compare the proposed TTDS recommender with the leading baselines in sequential recommendation. The overall evaluation result is presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S4.T1" title="Table 1 ‣ 4.2.3. Dual-Modality Variational Auto-Encoder ‣ 4.2. TTDS Recommender ‣ 4. Methodology ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">In comparing the performance of various recommendation algorithms, it is evident that those which integrate item content data, such as FDSA and S3-Rec, outperform the conventional methods that depend solely on user-item interactions and collaborative filtering, exemplified by Caser, HGN, GRU4Rec, BERT4Re, SASRec, and FMLP-Rec. This suggests that supplementing the recommendation process with item content can significantly enhance its efficacy. Furthermore, P5-CID and TIGER have shown promising results, particularly in the first two datasets, where they excel in metrics like HR@1 and NDCG, which are crucial for evaluating item ranking. However, when applied to the Games dataset, while they do show some improvement over the ID-only model, their performance does not markedly surpass that of methods already incorporating auxiliary content. This discrepancy may be attributed to the varying impact of content information and the inherent challenges in effectively modeling it across different types of data and scenarios.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Our model demonstrates consistently superior performance across three datasets, significantly outperforming the baseline methods. This excellence can be traced back to two key factors: (1) The item indexing mechanism, which employs vector quantization alongside uniform semantic mapping. This approach adeptly captures the nuances of item similarities and guarantees a semantically accurate generation process at the final index stage, ensuring no loss of semantic information. (2) The seamless integration of collaborative semantics into Large Language Models (LLMs). This integration harmonizes language semantics with collaborative semantics, creating a cohesive and effective recommendation system. By implementing these strategies, our model harnesses the robust predictive power of LLMs, leading to substantial enhancements in the accuracy and effectiveness of the recommendation task.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Ablation study on the architecture of the Twin-Tower Dynamic Semantic recommender model. <span class="ltx_text ltx_font_italic" id="S5.T2.2.1">Baseline</span> is the best performance achieved by baseline models.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.3" style="width:281.1pt;height:133.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-10.6pt,5.0pt) scale(0.93,0.93) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T2.3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.3.1.1.1.1">Metric</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.3.1.1.1.2">HR@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.3.1.1.1.3">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.3.1.1.1.4">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.3.1.1.1.5">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.3.1.1.1.6">NDCG@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.3.1.2.1.1">TTDS</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S5.T2.3.1.2.1.2.1">0.0711</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S5.T2.3.1.2.1.3.1">0.1018</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S5.T2.3.1.2.1.4.1">0.1281</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.1.2.1.5"><span class="ltx_text ltx_font_bold" id="S5.T2.3.1.2.1.5.1">0.0864</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.1.2.1.6"><span class="ltx_text ltx_font_bold" id="S5.T2.3.1.2.1.6.1">0.0947</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.3.1.3.2.1">STDS</th>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.3.2.2">0.0701</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.3.2.3">0.1010</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.3.2.4">0.1230</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.3.2.5">0.0860</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.3.2.6">0.0929</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.3.1.4.3.1">TTSS</th>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.4.3.2">0.0621</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.4.3.3">0.0828</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.4.3.4">0.1005</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.4.3.5">0.0727</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.4.3.6">0.0784</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.3.1.5.4.1">TTDS-DM</th>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.5.4.2">0.0685</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.5.4.3">0.0986</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.5.4.4">0.1224</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.5.4.5">0.0835</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.5.4.6">0.0911</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.3.1.6.5.1">STDS-DM</th>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.6.5.2">0.0610</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.6.5.3">0.0919</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.6.5.4">0.1159</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.6.5.5">0.0769</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.6.5.6">0.0845</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T2.3.1.7.6.1">TTDS-HO</th>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.7.6.2">0.0696</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.7.6.3">0.1007</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.7.6.4">0.1236</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.7.6.5">0.0852</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.1.7.6.6">0.0926</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.1.8.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T2.3.1.8.7.1">Baseline</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.3.1.8.7.2">0.0608</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.3.1.8.7.3">0.0863</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.3.1.8.7.4">0.1136</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.3.1.8.7.5">0.0738</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.3.1.8.7.6">0.0803</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Ablation Study</h3>
<section class="ltx_subsubsection" id="S5.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.1. </span><span class="ltx_text ltx_font_bold" id="S5.SS3.SSS1.1.1">Architecture</span>
</h4>
<div class="ltx_para" id="S5.SS3.SSS1.p1">
<p class="ltx_p" id="S5.SS3.SSS1.p1.1">To demonstrate the effectiveness of the proposed innovations, including the dynamic knowledge fusion framework, the dual-modality variational auto-encoder, and the high-order user-item interaction pattern specific tasks, we design ablation study to investigate the contribution of each module. In ablation study, <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS1.p1.1.1">TTDS</span> refers to the twin-tower dynamic semantic recommender which is the unabridged model, <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS1.p1.1.2">STDS</span> refers to single-tower dynamic semantic recommender that removes the TTDS user branch, <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS1.p1.1.3">TTSS</span> refers to twin-tower static semantic recommender that removes the dynamic knowledge fusion framework, , <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS1.p1.1.4">TTDS-DM</span> removes the DM-VAE module, <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS1.p1.1.5">STDS-DM</span> removes both the DM-VAE module and the TTDS user branch, and <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS1.p1.1.6">TTDS-HO</span> removes the specific tuning tasks for the high-order user-item interaction patterns.</p>
</div>
<div class="ltx_para" id="S5.SS3.SSS1.p2">
<p class="ltx_p" id="S5.SS3.SSS1.p2.1">The sequential recommendation performance on Amazon Instruments dataset is presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.T2" title="Table 2 ‣ 5.2. Main Result ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">2</span></a>.

The data presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.T2" title="Table 2 ‣ 5.2. Main Result ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">2</span></a> reveals that progressively integrating various semantic alignment tasks into the sequential recommendation process, which was initially based solely on collaborative semantics, leads to a notable enhancement in performance. The inclusion of these instruction tuning tasks has proven to be advantageous for boosting the effectiveness of sequential recommendations. Furthermore, there is an indication that performance could be further optimized by incorporating an even greater number of semantic alignment tasks into the model.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Ablation study on the index mechanism of the Twin-Tower Dynamic Semantic recommender model. <span class="ltx_text ltx_font_italic" id="S5.T3.2.1">Baseline</span> is the best performance achieved by baseline models.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T3.3" style="width:278.3pt;height:150.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-10.5pt,5.7pt) scale(0.93,0.93) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T3.3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T3.3.1.1.1.1">Metric</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.1.1.2">HR@1</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.1.1.3">HR@5</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.1.1.4">HR@10</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.1.1.5">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.3.1.1.1.6">NDCG@10</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.1.2.2.1">TTDS</th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.2.2.2">0.0711</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.2.2.3">0.1018</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.2.2.4">0.1281</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.2.2.5">0.0864</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.2.2.6">0.0947</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.1.3.3.1">TTDS-3</th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.3.3.2">0.0686</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.3.3.3">0.1004</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.3.3.4">0.1222</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.3.3.5">0.0844</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.3.3.6">0.0914</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.1.4.4.1">TTDS-5</th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.4.2">0.0697</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.4.3">0.1007</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.4.4">0.1233</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.4.5">0.0853</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.4.4.6">0.0926</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.1.5.5.1">TTSS</th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.5.5.2">0.0621</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.5.5.3">0.0828</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.5.5.4">0.1005</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.5.5.5">0.0727</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.5.5.6">0.0784</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.1.6.6.1">TT-DLSH</th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.6.6.2">0.0677</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.6.6.3">0.0976</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.6.6.4">0.1228</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.6.6.5">0.0829</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.6.6.6">0.0909</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.1.7.7.1">TT-SLSH</th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.7.7.2">0.0660</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.7.7.3">0.0918</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.7.7.4">0.1131</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.7.7.5">0.0790</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.7.7.6">0.0859</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r" id="S5.T3.3.1.8.8.1">TT-SR</th>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.8.8.2">0.0110</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.8.8.3">0.0405</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.8.8.4">0.0713</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.8.8.5">0.0251</td>
<td class="ltx_td ltx_align_center" id="S5.T3.3.1.8.8.6">0.0349</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.1.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T3.3.1.9.9.1">Baseline</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.9.9.2">0.0608</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.9.9.3">0.0863</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.9.9.4">0.1136</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.9.9.5">0.0738</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.3.1.9.9.6">0.0803</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.3.2. </span><span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.1.1">Indexing Mechanism</span>
</h4>
<div class="ltx_para" id="S5.SS3.SSS2.p1">
<p class="ltx_p" id="S5.SS3.SSS2.p1.1">Furthermore, we investigate the impact of different index mechanism. The dynamic semantic index adopted by TTDS recommender is able to sufficiently integrate the semantic and collaborative knowledge together. To comprehensively justify its superiority, we introduce dynamic locality sensitive hashing (LSH) index, static LSH index, and static random index, denoted as <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.p1.1.1">TT-DLSH</span>, <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.p1.1.2">TT-SLSH</span>, <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.p1.1.3">TT-SR</span>. Since the TTDS recommeder in main experiment adopts dynamic semantic index consisting of 4 tokens, we further train two comparison version of TTDS recommender with the dynamic semantic index length equals 3 and 5, denoted as <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.p1.1.4">TTDS-3</span> and <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.p1.1.5">TTDS-5</span>, respectively. Note that the variant <span class="ltx_text ltx_font_bold" id="S5.SS3.SSS2.p1.1.6">TTSS</span> that removes the dynamic knowledge fusion framework adopts the static semantic index, also serving as a contrastive model.</p>
</div>
<div class="ltx_para" id="S5.SS3.SSS2.p2">
<p class="ltx_p" id="S5.SS3.SSS2.p2.1">The sequential recommendation performance on Amazon Instruments dataset is presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.09253v1#S5.T3" title="Table 3 ‣ 5.3.1. Architecture ‣ 5.3. Ablation Study ‣ 5. Experiment ‣ Unleash LLMs Potential for Recommendation by Coordinating Twin-Tower Dynamic Semantic Token Generator"><span class="ltx_text ltx_ref_tag">3</span></a>.

We can conclude the following observations from the presented result. First, representing each item/user with 4 semantic tokens (i.e., TTDS in main experiment) is appropriate such an dataset volume (ten thousand). TTDS-3 with less semantic index length may suffer from inadequate expressiveness and TTDS-5 with larger representation space will increase the difficulty of target item generation. Second, comparing TTDS recommender with the variants that adopts static semantic index TTSS, the superiority of dynamic semantic index optimized by the dynamic knowledge fusion framework is significant. The outperformance of TT-DLSH over the static variant TT-SLSH further verifies the effectiveness of the proposed dynaminc knowledge fusion framework for the locality sensitive hashing index as well. Third, comparing the semantic index based recommender and the LSH index based recommender, we can note that for the static index mechanism, the LSH index outperforms the semantic index, since the hyperplane projection in locality sensitive hashing is more stable than the vector quantization technique. Conversely, within the dynamic index situation, the capacity of semantic index is sufficiently exploited and thus TTDS recommender achieves significant improvement over the LSH index based variant.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this research, we propose the Twin-Tower Dynamic Semantic Recommender (<span class="ltx_text ltx_font_bold" id="S6.p1.1.1">TTDS</span>), a pioneering generative Recommender System (RS) that employs a dynamic semantic indexing approach to address the aforementioned challenges holistically. This innovative system is the first of its kind to incorporate a dynamic knowledge fusion framework, which includes a twin-tower semantic token generator within a Large Language Model (LLM)-based recommendation engine. It assigns a hierarchical semantic index to both items and users, enabling the prediction of the target item’s semantic index with precision. Additionally, we introduce a dual-modality variational auto-encoder designed to enhance the alignment between semantic and collaborative knowledge at multiple levels of granularity. To capitalize on user historical behavior, we have also developed a suite of novel tuning tasks specifically tailored to capture complex user-item interaction patterns. Our extensive experimental evaluation across three public datasets has confirmed the efficacy of our proposed methodology in advancing LLM-based generative RSs. The TTDS recommender has achieved remarkable results, with an average improvement of 19.41% in Hit-Rate and 20.84% in the Normalized Discounted Cumulative Gain metric over the leading baseline methods, showcasing its potential in the field of recommendation systems.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Keqin Bao, Jizhi Zhang, Yang Zhang, Wenjie Wang, Fuli Feng, and Xiangnan He. 2023.

</span>
<span class="ltx_bibblock">TALLRec: An Effective and Efficient Tuning Framework to Align Large Language Model with Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">Proceedings of the ACM Conference on Recommender Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2014)</span>
<span class="ltx_bibblock">
Junyoung Chung, Caglar Gulcehre, KyungHyun Cho, and Yoshua Bengio. 2014.

</span>
<span class="ltx_bibblock">Empirical Evaluation of Gated Recurrent Neural Networks on Sequence Modeling. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the International Conference on Neural Information Processing System</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Covington et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin. 2016.

</span>
<span class="ltx_bibblock">Deep Neural Networks for Youtube Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the ACM conference on recommender systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zeyu Cui, Jianxin Ma, Chang Zhou, Jingren Zhou, and Hongxia Yang. 2022.

</span>
<span class="ltx_bibblock">M6-Rec: Generative Pretrained Language Models are Open-Ended Recommender Systems.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2205.08084

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Davidson et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
James Davidson, Benjamin Liebald, Junning Liu, Palash Nandy, Taylor Van Vleet, Ullas Gargi, Sujoy Gupta, Yu He, Mike Lambert, Blake Livingston, and Dasarathi Sampath. 2010.

</span>
<span class="ltx_bibblock">The YouTube Video Recommendation System. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Proceedings of the ACM Conference on Recommender Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">de Souza Pereira Moreira et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Gabriel de Souza Pereira Moreira, Sara Rabhi, Jeong Min Lee, Ronay Ak, and Even Oldridge. 2021.

</span>
<span class="ltx_bibblock">Transformers4Rec: Bridging the Gap between NLP and Sequential / Session-Based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the ACM conference on recommender systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Hui Fang, Danning Zhang, Yiheng Shu, and Guibing Guo. 2020.

</span>
<span class="ltx_bibblock">Deep Learning for Sequential Recommendation: Algorithms, Influential Factors, and Evaluations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">ACM Transactions on Information Systems</em> 39(1) (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang. 2022.

</span>
<span class="ltx_bibblock">Recommendation as Language Processing (RLP): A Unified Pretrain, Personalized Prompt &amp; Predict Paradigm (P5). In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the ACM conference on recommender systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gomez-Uribe and Hunt (2016)</span>
<span class="ltx_bibblock">
Carlos Alberto Gomez-Uribe and Neil Hunt. 2016.

</span>
<span class="ltx_bibblock">The Netflix Recommender System: Algorithms, Business Value, and Innovation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">ACM Transactions on Management Information Systems</em> 6(4) (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ruiqi Guo, Philip Sun, Erik Lindgren, Quan Geng, David Simcha, Felix Chern, and Sanjiv Kumar. 2020.

</span>
<span class="ltx_bibblock">Accelerating Large-Scale Inference with Anisotropic Vector Quantization. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the International Conference on Machine Learning</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruining He, Wang-Cheng Kang, and Julian McAuley. 2017.

</span>
<span class="ltx_bibblock">Translation-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the ACM Conference on Recommender Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2016)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley. 2016.

</span>
<span class="ltx_bibblock">Fusing Similarity Models with Markov Chains for Sparse Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">IEEE International Conference on Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He and McAuley (2020)</span>
<span class="ltx_bibblock">
Ruining He and Julian McAuley. 2020.

</span>
<span class="ltx_bibblock">Ups and Downs: Modeling the Visual Evolution of Fashion Trends with One-Class Collaborative Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the International Conference on World Wide Web</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yupeng Hou, Zhankui He, Julian McAuley, and Wayne Xin Zhao. 2023.

</span>
<span class="ltx_bibblock">Learning Vector-Quantized Item Representation for Transferable Sequential Recommenders. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Proceedings of the ACM Web Conference</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yupeng Hou, Shanlei Mu, Wayne Xin Zhao, Yaliang Li, Bolin Ding, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Towards Universal Sequence Representation Learning for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yupeng Hou, Junjie Zhang, Zihan Lin, Hongyu Lu, Ruobing Xie, Julian McAuley, and Wayne Xin Zhao. 2024.

</span>
<span class="ltx_bibblock">Large Language Models are Zero-Shot Rankers for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the Advances in Information Retrieval: European Conference on Information Retrieval Engineering</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen. 2022.

</span>
<span class="ltx_bibblock">LoRA: Low-Rank Adaptation of Large Language Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of the International Conference on Learning Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hua et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wenyue Hua, Shuyuan Xu, Yingqiang Ge, and Yongfeng Zhang. 2023.

</span>
<span class="ltx_bibblock">How to Index Item IDs for Recommendation Foundation Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the Annual International ACM SIGIR Conference on Research and Development in Information Retrieval in the Asia Pacific Region</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huh et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Minyoung Huh, Brian Cheung, Pulkit Agrawal, and Phillip Isola. 2023.

</span>
<span class="ltx_bibblock">Straightening Out the Straight-Through Estimator: Overcoming Optimization Challenges in Vector Quantized Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the International Conference on Machine Learning</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jannach and Ludewig (2017)</span>
<span class="ltx_bibblock">
Dietmar Jannach and Malte Ludewig. 2017.

</span>
<span class="ltx_bibblock">When Recurrent Neural Networks meet the Neighborhood for Session-Based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the ACM Conference on Recommender Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Bowen Jin, Hansi Zeng, Guoyin Wang, Xiusi Chen, Tianxin Wei, Ruirui Li, Zhengyang Wang, Zheng Li, Yang Li, Hanqing Lu, Suhang Wang, Jiawei Han, and Xianfeng Tang. 2024b.

</span>
<span class="ltx_bibblock">Language Models as Semantic Indexers. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the International Conference on Machine Learning</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jin et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Mengqun Jin, Zexuan Qiu, Jieming Zhu, Zhenhua Dong, and Xiu Li. 2024a.

</span>
<span class="ltx_bibblock">Contrastive Quantization based Semantic Code for Generative Recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2404.14774

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kabbur et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2013)</span>
<span class="ltx_bibblock">
Santosh Kabbur, Xia Ning, and George Karypis. 2013.

</span>
<span class="ltx_bibblock">FISM: Factored Item Similarity Models for Top-N Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Proceedings of the ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-Attentive Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the IEEE International Conference on Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2015)</span>
<span class="ltx_bibblock">
Diederik P. Kingma and Jimmy Ba. 2015.

</span>
<span class="ltx_bibblock">Adam: A Method for Stochastic Optimization. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the International Conference on Learning Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2017a)</span>
<span class="ltx_bibblock">
Jing Li, Zhumin Chen Pengjie Ren, Zhaochun Ren, Tao Lian, and Jun Ma. 2017a.

</span>
<span class="ltx_bibblock">Neural Attentive Session-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the ACM on Conference on Information and Knowledge Management</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2017b)</span>
<span class="ltx_bibblock">
Jing Li, Pengjie Ren, Zhumin Chen, Zhaochun Ren, Tao Lian, and Jun Ma. 2017b.

</span>
<span class="ltx_bibblock">Neural Attentive Session-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">Proceedings of the ACM on Conference on Information and Knowledge Management</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jiacheng Li, Ming Wang, Jin Li, Jinmiao Fu, Xin Shen, Jingbo Shang, and Julian McAuley. 2023.

</span>
<span class="ltx_bibblock">Text Is All You Need: Learning Language Representations for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">Proceedings of the ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Linden et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2003)</span>
<span class="ltx_bibblock">
Greg Linden, Brent Smith, and Jeremy York. 2003.

</span>
<span class="ltx_bibblock">Amazon.com Recommendations: Item-to-Item Collaborative Filtering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">IEEE Internet Computing</em> 7(1) (2003).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Han Liu, Yinwei Wei, Xuemeng Song, Weili Guan, Yuan-Fang Li, and Liqiang Nie. 2024.

</span>
<span class="ltx_bibblock">MMGRec: Multimodal Generative Recommendation with Transformer Model.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2404.16555

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chen Ma, Peng Kang, and Xue Liu. 2019.

</span>
<span class="ltx_bibblock">Hierarchical Gating Networks for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever. 2023.

</span>
<span class="ltx_bibblock">Improving Language Understanding by Generative Pre-Rraining.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J. Liu. 2020.

</span>
<span class="ltx_bibblock">Exploring the Limits of Transfer Learning with A Unified Text-To-text Transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">The Journal of Machine Learning Research</em> 21(1) (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rajput et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shashank Rajput, Nikhil Mehta, Anima Singh, Raghunandan Keshavan, Trung Vu, Lukasz Heidt, Lichan Hong, Yi Tay, Vinh Q. Tran, Jonah Samost, Maciej Kula, Ed H. Chi, and Maheswaran Sathiamoorthy. 2023.

</span>
<span class="ltx_bibblock">Recommender Systems with Generative Retrieval. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Proceedings of the International Conference on Neural Information Processing Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2009.

</span>
<span class="ltx_bibblock">BPR: Bayesian Personalized Ranking from Implicit Feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Proceedings of the Conference on Uncertainty in Artificial Intelligence</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential Recommendation with Bidirectional Encoder Representations from Transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Proceedings of the ACM International Conference on Information and Knowledge Management</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yong Kiam Tan, Xinxing Xu, and Yong Liu. 2016.

</span>
<span class="ltx_bibblock">Improved Recurrent Neural Networks for Session-based Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the Workshop on Deep Learning for Recommender Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized Top-N Sequential Recommendation via Convolutional Sequence Embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the ACM International Conference on Web Search and Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tay et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yi Tay, Vinh Q. Tran, Mostafa Dehghani, Jianmo Ni, Dara Bahri, Harsh Mehta, Zhen Qin, Kai Hui, Zhe Zhao, Jai Gupta, Tal Schuster, William W. Cohen, and Donald Metzler. 2022.

</span>
<span class="ltx_bibblock">Transformer Memory as a Differentiable Search Index. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the International Conference on Neural Information Processing System</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, and Faisal Azhar. 2023.

</span>
<span class="ltx_bibblock">LlaMA: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Wenjie Wang, Honghui Bao, Xinyu Lin, Jizhi Zhang, Yongqi Li, Fuli Feng, See-Kiong Ng, and Tat-Seng Chua. 2024.

</span>
<span class="ltx_bibblock">Learnable Item Tokenization for Generative Recommendation.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2405.07314

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Meng Wang, Fuli Feng, and Tat-Seng Chua. 2019.

</span>
<span class="ltx_bibblock">Neural Graph Collaborative Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">Proceedings of the International ACM SIGIR Conference on Research and Development in Information Retrieval</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yujing Wang, Yingyan Hou, Haonan Wang, Ziming Miao, Shibin Wu, Hao Sun, Qi Chen, Yuqing Xia, Chengmin Chi, Guoshuai Zhao, Zheng Liu, Xing Xie, Hao Allen Sun, Weiwei Deng, Qi Zhang, and Mao Yang. 2022.

</span>
<span class="ltx_bibblock">A Neural Corpus Indexer for Document Retrieval. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of the International Conference on Neural Information Processing System</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Shu Wu, Yuyuan Tang, Yanqiao Zhu, Liang Wang, Xing Xie, and Tieniu Tan. 2019.

</span>
<span class="ltx_bibblock">Session-based Recommendation with Graph Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Chengfeng Xu, Pengpeng Zhao, Yanchi Liu, Victor S. Sheng, Jiajie Xu, Fuzhen Zhuang, Junhua Fang, and Xiaofang Zhou. 2019.

</span>
<span class="ltx_bibblock">Graph Contextualized Self-Attention Network for Session-based Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">Proceedings of the International Joint Conference on Artificial Intelligence</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fajie Yuan, Alexandros Karatzoglou, Ioannis Arapakis, Joemon M. Jose, and Xiangnan He. 2019.

</span>
<span class="ltx_bibblock">A Simple Convolutional Generative Network for Next Item Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Proceedings of the ACM International Conference on Web Search and Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeghidour et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Neil Zeghidour, Alejandro Luebs, Ahmed Omran, Jan Skoglund, and Marco Tagliasacchi. 2021.

</span>
<span class="ltx_bibblock">SoundStream: An End-to-End Neural Audio Codec.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">IEEE/ACM Transactions on Audio, Speech, and Language Processing</em> 31 (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Shuai Zhang, Yi Tay, Lina Yao, Aixin Sun, and Jake An. 2019a.

</span>
<span class="ltx_bibblock">Next Item Recommendation with Self-Attentive Metric Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Tingting Zhang, Pengpeng Zhao, Yanchi Liu, Victor S. Sheng, Jiajie Xu, Deqing Wang, Guanfeng Liu, and Xiaofang Zhou. 2019b.

</span>
<span class="ltx_bibblock">Feature-level Deeper Self-Attention Network for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">Proceedings of the International Joint Conference on Artificial Intelligence</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Bowen Zheng, Yupeng Hou, Hongyu Lu, Yu Chen, Wayne Xin Zhao, and Ji rong Wen. 2024.

</span>
<span class="ltx_bibblock">Adapting Large Language Models by Integrating Collaborative Semantics for Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">Proceedings of the IEEE International Conference on Data Engineering</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Wang, Wayne Xin Zhao, Yutao Zhu, Sirui Wang, Fuzheng Zhang, Zhongyuan Wang, and Ji-Rong Wen. 2020.

</span>
<span class="ltx_bibblock">S3-Rec: Self-Supervised Learning for Sequential Recommendation with Mutual Information Maximization. In <em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">Proceedings of the ACM International Conference on Information and Knowledge Management</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib53.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Yu, Wayne Xin Zhao, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Filter-enhanced MLP is All You Need for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib53.3.1">Proceedings of the ACM Web Conference</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib54.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yaochen Zhu, Liang Wu, Qi Guo, Liangjie Hong, and Jundong Li. 2024.

</span>
<span class="ltx_bibblock">Collaborative Large Language Model for Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib54.3.1">Proceedings of the ACM on Web Conference</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Sep 14 01:39:32 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
