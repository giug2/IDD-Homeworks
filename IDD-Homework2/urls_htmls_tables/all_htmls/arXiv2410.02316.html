<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration</title>
<!--Generated on Thu Oct  3 08:48:22 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.02316v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S1" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S2" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S2.SS1" title="In 2 Related Works ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Image registration-based approaches</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S2.SS2" title="In 2 Related Works ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Image segmentation-based approaches</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S2.SS3" title="In 2 Related Works ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Comparison to our method</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Material and Methods</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS1" title="In 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Segmentation of anatomical structures</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS2" title="In 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Atlas registration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS3" title="In 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Cropping of pre-defined anatomical regions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS4" title="In 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Computing of new anatomical regions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S4" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S4.SS1" title="In 4 Experiments ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Image registration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S4.SS2" title="In 4 Experiments ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Anatomical region cropping</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S4.SS3" title="In 4 Experiments ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Computation of new anatomical regions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.SS1" title="In 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Image registration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.SS2" title="In 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Anatomical region cropping</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.SS3" title="In 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Computation of new anatomical regions</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S6" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S7" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S1a" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Outlier examples in Totalsegmentator</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S2a" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Hyper-parameters of image augmentation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3a" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Additional results image registration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S4a" title="In CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Simulation of segmentation network inference</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en">
<h1 class="ltx_title ltx_title_document">CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id1.1.id1">\firstname</span>Thomas <span class="ltx_ERROR undefined" id="id2.2.id2">\surname</span>Buddenkotte <span class="ltx_ERROR undefined" id="id3.3.id3">\email</span>thomasbuddenkotte@googlemail.com 
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id4.4.id4">\addr</span>Department of Diagnostic and Interventional Radiology and Nuclear Medicine, University Medical Center Hamburg-Eppendorf, Hamburg, Germany,
<br class="ltx_break"/>jung diagnostics, Hamburg Germany 
<br class="ltx_break"/>Department of Oncology, University of Cambridge, UK
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id5.5.id5">\AND</span><span class="ltx_ERROR undefined" id="id6.6.id6">\name</span>Roland Opfer
<span class="ltx_ERROR undefined" id="id7.7.id7">\addr</span>jung diagnostics, Hamburg Germany 
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id8.8.id8">\AND</span><span class="ltx_ERROR undefined" id="id9.9.id9">\name</span>Julia Krüger
<span class="ltx_ERROR undefined" id="id10.10.id10">\addr</span>jung diagnostics, Hamburg Germany 
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id11.11.id11">\AND</span><span class="ltx_ERROR undefined" id="id12.12.id12">\name</span>Alessa Hering
<span class="ltx_ERROR undefined" id="id13.13.id13">\addr</span>Department of Medical Imaging, Radboud University Medical Center, Nijmegen, The Netherlands 
<br class="ltx_break"/><span class="ltx_ERROR undefined" id="id14.14.id14">\AND</span><span class="ltx_ERROR undefined" id="id15.15.id15">\name</span>Mireia Crispin-Ortuzar
<span class="ltx_ERROR undefined" id="id16.16.id16">\addr</span>Early Cancer Institute, Department of Oncology, University of Cambridge, UK
<br class="ltx_break"/>Cancer Research UK Cambridge Centre, University of Cambridge, UK
<br class="ltx_break"/>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id17.id1"><span class="ltx_text" id="id17.id1.1">Medical image analysis tasks often focus on regions or structures located in a particular location within the patient’s body. Often large parts of the image may not be of interest for the image analysis task. When using deep-learning based approaches, this causes an unnecessary increases the computational burden during inference and raises the chance of errors. In this paper, we introduce CTARR, a novel generic method for CT Anatomical Region Recognition. The method serves as a pre-processing step for any deep learning-based CT image analysis pipeline by automatically identifying the pre-defined anatomical region that is relevant for the follow-up task and removing the rest. It can be used in (i) image segmentation to prevent false positives in anatomically implausible regions and speeding up the inference, (ii) image classification to produce image crops that are consistent in their anatomical context, and (iii) image registration by serving as a fast pre-registration step. Our proposed method is based on atlas registration and provides a fast and robust way to crop any anatomical region encoded as one or multiple bounding box(es) from any unlabeled CT scan of the brain, chest, abdomen and/or pelvis. We demonstrate the utility and robustness of the proposed method in the context of medical image segmentation by evaluating it on six datasets of public segmentation challenges. The foreground voxels in the regions of interest are preserved in the vast majority of cases and tasks (97.45-100%) while taking only fractions of a seconds to compute (0.1-0.21s) on a deep learning workstation and greatly reducing the segmentation runtime (2.0-12.7x). Our code is available at https://github.com/ThomasBudd/ctarr.</span></p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<p class="ltx_p" id="p1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1" style="font-size:90%;">Keywords:</span><span class="ltx_text" id="p1.1.2" style="font-size:90%;"> 
CT, Deep learning, Image Segmentation, Image Registration, Atlas Registration</span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Deep learning is currently the most dominant technology for automated medical image analysis tasks such as classification, segmentation and prognosis. Computed tomography (CT) is one of the most common medical imaging modalities nowadays (<cite class="ltx_cite ltx_citemacro_cite">Schöckel et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib17" title="">2020</a>)</cite><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.who.int/data/gho/data/indicators/indicator-details/GHO/total-density-per-million-population-computed-tomography-units</span></span></span><span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://www.england.nhs.uk/statistics/wp-content/uploads/sites/2/2022/07/Statistical-Release-21st-July-2022-PDF-875KB.pdf</span></span></span>). The field of view CT images varies naturally. For example, on a large scale the medical question determines which body part is scanned (head, chest, abdomen, pelvis etc.). On a small scale it depends on the input of the radiographers to the scanner and thus slightly varies between users. On the other hand, the information required for the medical question or the image analysis task is often located in a particular anatomical region of interest. <cite class="ltx_cite ltx_citemacro_cite">Myronenko et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib14" title="">2023</a>)</cite> suggested a segmentation pipeline build on deep supervision, a method where a preliminary low resolution segmentation is created on the entire scan and a full-resolution network refines the prediction only in the context around the preliminary segmentation. <cite class="ltx_cite ltx_citemacro_cite">Mikhael et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib13" title="">2023</a>)</cite> proposed an image classification pipeline to assess lung cancer risk that used automated segmentation of the lung and applied the classification network only inside a crop around this segmentation. These and similar approaches heavily rely on a robust segmentation of the organ in which the disease is located and thus cannot be applied directly to other CT image analysis problems, such as segmentation of metastatic disease, where lesions can appear in a variety of locations. Further, computing bounding boxes based on any automated segmentations can be disadvantageous for several other reasons. First, such automated segmentation algorithms tend to produce false positive annotations far away from the actual anatomical region of interest as previously reported by <cite class="ltx_cite ltx_citemacro_cite">Buddenkotte et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib3" title="">2023</a>)</cite> and demonstrated in Appendix A. Second, predicting the segmentation on full volume on full resolution of the CT image can be computationally expensive. Third, using a segmentation algorithm on low resolution instead is not feasible in problems where the object of interest is very small such as lymph nodes or bone fractures.
<br class="ltx_break"/>In this manuscript, we describe a fast and robust approach for the identification of predefined anatomical regions in CT scans. In contrast to the previously described approaches by <cite class="ltx_cite ltx_citemacro_cite">Myronenko et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib14" title="">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Mikhael et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib13" title="">2023</a>)</cite>, our method can identify any anatomical region of interest without the need for fine-tuning the pipeline. Instead, new anatomical regions of interest are simply added as bounding boxes in an atlas coordinate system. The method uses image registration to map such bounding boxes from the atlas coordinate system to the coordinate system of the incoming CT scan. We further suggest a novel image registration algorithm that is particularly suited for this task. Traditional registration methods often use iterative schemes and are likely to get stuck in local minima in cases where large translations are needed for the optimal alignment. Our method prevents this by using anatomical segmentation masks instead of the CT images directly. We validate our method on a total of 1131 CT scans from public segmentation challenges to demonstrate robustness and computational feasibility. The proposed method also identifies orientation misalignment compared to the atlas with regards to 90-, 180- and 270-degrees’ rotations in xy-plane and reversion of the z-axis, which occur in some dicom to nifti conversion tools or when false information was added into the dicom header. The proposed method can serve as a pre-processing step for CT image analysis problems like image segmentation, classification or registration. The framework is available for at https://github.com/ThomasBudd/ctarr and offers a convenient interface to crop from predefined anatomical regions on unlabeled scans as well as inferring custom ones from labelled datasets.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">To the best of our knowledge, our method is the only one today that can extract any anatomical region of interest from a CT scan as previous approaches are tailored for only a single region. Previous approaches are typically build on either image registration or segmentation while our method utilises a combination of both. In the following we will describe these previously existing method.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Image registration-based approaches</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">There is a long tradition in creating specialised anatomical region recognition in medical images that use image registration. For example, <cite class="ltx_cite ltx_citemacro_cite">Kalinić (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib10" title="">2009</a>)</cite> summarized well before the age of deep learning existing techniques to perform image segmentation by registering an image to an atlas and propagating the segmentation from the atlas to the image. The usage of atlas-based registration techniques is especially popular in brain imaging. CT, MRI, or SPECT images are often registered to an atlas in the so-called Montreal Neuro Imaging (MNI) space during pre-processing before carrying out further analysis such as accurate identification of different brain regions as suggested by <cite class="ltx_cite ltx_citemacro_cite">Manera et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib12" title="">2020</a>)</cite> or <cite class="ltx_cite ltx_citemacro_cite">Ni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib15" title="">2020</a>)</cite>. Similar to our approach, <cite class="ltx_cite ltx_citemacro_cite">Buchert et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib2" title="">2015</a>)</cite> created a registration method for brain SPECT images to the MNI space to consistently crop from six slices with locations defined in this MNI space. The reason why these approaches are popular in the field of brain imaging might be that the robust and reliable registration algorithms could be proposed due to the rigidity of the brain. Image registration in other areas of the body can be significantly more challenging, especially considering anatomies that are more flexible or show more variation between patients. Nowadays, deep learning is often used as a part of image registration pipeline to solve difficult registration problems or decrease the computational effort of conventional approaches. For a comprehensive survey we refer to <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib5" title="">2021</a>)</cite> and <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib4" title="">2023</a>)</cite>.
<br class="ltx_break"/></p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Image segmentation-based approaches</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Other approaches comparable to our proposed method automatically segment organs of interest to create smaller image crops. <cite class="ltx_cite ltx_citemacro_cite">Mikhael et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib13" title="">2023</a>)</cite> suggested a prediction pipeline for lung cancer risk and used cropping around automatically created lung segmentations as a prepossessing step. <cite class="ltx_cite ltx_citemacro_cite">Myronenko et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib14" title="">2023</a>)</cite> won the 2023 kidney tumor segmentation challenge (kits23)<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://kits-challenge.org/kits23/</span></span></span> by using an approach that first identifies the kidneys on a low resolution, cropping around this region and employing a second network that operates only on the full resolution crops.
<br class="ltx_break"/>Our method is based on anatomy segmentation of the full body and registration to an atlas which are active fields of research. One of the most relevant current work on segmentation of various anatomies on CT images is the Totalsegmentator by <cite class="ltx_cite ltx_citemacro_cite">Wasserthal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib18" title="">2023</a>)</cite>. The Totalsegmentator consists of a dataset of more than 1200 CT scans and annotations from 117<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The original version had annotations from 104 anatomies while the recent update contains 117 https://github.com/wasserth/TotalSegmentator</span></span></span> different anatomies and automated segmentation models for the segmentation for those anatomies. The annotations were made by first creating a small set of manual annotations, training a publicly available segmentation model on these and refining the model predictions on remaining scans. Other examples of automated segmentation of organs and other anatomies can be found in the well-established nnU-Net framework <cite class="ltx_cite ltx_citemacro_cite">Isensee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib8" title="">2021</a>)</cite>, where the authors proposed a pipeline that automatically suggests hyper-parameters for a CNN-based segmentation model given any new dataset for biomedical image segmentation. The framework won multiple segmentation challenges and can be downloaded freely with pre-trained weights for multiple segmentation tasks including organ segmentation. For example, the challenge submission for the Multi Atlas Labeling Beyond the Cranial Vault - Abdomen Challenge is capable of segmenting 13 different organs in the abdomen. For a more comprehensive review on anatomy segmentation on CT images can be found in <cite class="ltx_cite ltx_citemacro_cite">Wasserthal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib18" title="">2023</a>)</cite>
<br class="ltx_break"/></p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Comparison to our method</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">All previously established approaches have in common that they are specialised for one particular anatomical region of interest. Modification to other anatomical regions often involves collecting new datasets, training new networks or adapting parameters in the registration pipeline. In contrast to this, our method is a general-purpose tool in the sense that new anatomical regions can be added by defining a new bounding box in the coordinate system of an atlas. The rest of the pipeline is agnostic to the choice of the bounding box. Our novel image registration method uses sets of segmentation masks instead of performing on the CT images directly, this allows us to prevent the method from getting caught in local minima and to safely determine even large transformations as we will demonstrate in the following sections.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Material and Methods</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In the following we will describe the proposed method in detail. The goal of our method is to automatically identify pre-defined anatomical regions in any incoming CT scan. This is achieved by encoding anatomical regions as one or multiple bounding boxes in the coordinate system of the atlas and mapping those to the CT scan by performing image registration. In contrast to many existing image registration techniques, we do not perform the image registration directly on the CT images, but instead on the segmentation masks of a fixed set of 19 anatomies. We will first describe our automated segmentation method to obtain this segmentation automatically in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS1" title="3.1 Segmentation of anatomical structures ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.1</span></a> followed by the atlas registration method in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS2" title="3.2 Atlas registration ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.2</span></a>. The pipeline of how to perform the cropping of a pre-defined anatomical region on an unseen CT image is described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS3" title="3.3 Cropping of pre-defined anatomical regions ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.3</span></a>. Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS4" title="3.4 Computing of new anatomical regions ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.4</span></a> described how such anatomical region can be computed when none is pre-defined, but a set of CT images and segmentations of the region of interest are given.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Segmentation of anatomical structures</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The segmentation of the anatomical structures was performed by training a 3d U-Net (<cite class="ltx_cite ltx_citemacro_cite">Ronneberger et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib16" title="">2015</a>); Çiçek et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib6" title="">2016</a>)</cite>) on the Totalsegmenator dataset. We first carefully selected a set of 19 anatomical structures throughout the whole body which ratified the following criteria: (1) large volume, (2) segmented by previous approaches with high accuracy and (3) do not demonstrate large anatomical variations. We further created groups of some anatomies to reduce the complexity of the segmentation task. The resulting list of the 19 anatomical structures considered by our segmentation approach can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.T1" title="Table 1 ‣ 3.1 Segmentation of anatomical structures ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">1</span></a>. We ensured that our segmentation model is on state-of-the-art level by starting from hyper-parameters suggested by the nnU-Net framework followed by a hyper-parameter tuning of the patch size, learning rate, batch size, optimizer, and augmentation strength.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Target anatomies of the segmentation approach</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1">ID</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_rr" id="S3.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.2.1">Anatomy name</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S3.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.3.1">ID</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S3.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.4.1">Anatomy name</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.2.1.1">1</th>
<td class="ltx_td ltx_align_left ltx_border_rr ltx_border_t" id="S3.T1.1.2.1.2">skull</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.2.1.3">11</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.1.2.1.4">brain</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.3.2.1">2</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.3.2.2">C vertebrae</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.3.2.3">12</th>
<td class="ltx_td ltx_align_left" id="S3.T1.1.3.2.4">lung left</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.4.3.1">3</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.4.3.2">left rips, scapula, clavicular</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.4.3.3">13</th>
<td class="ltx_td ltx_align_left" id="S3.T1.1.4.3.4">lung right</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.5.4.1">4</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.5.4.2">right rips, scapula, clavicular</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.5.4.3">14</th>
<td class="ltx_td ltx_align_left" id="S3.T1.1.5.4.4">heart</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.6.5.1">5</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.6.5.2">sternum</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.6.5.3">15</th>
<td class="ltx_td ltx_align_left" id="S3.T1.1.6.5.4">liver</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.7.6.1">6</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.7.6.2">T vertebrae</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.7.6.3">16</th>
<td class="ltx_td ltx_align_left" id="S3.T1.1.7.6.4">spleen</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.8.7.1">7</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.8.7.2">L vertebrae</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.8.7.3">17</th>
<td class="ltx_td ltx_align_left" id="S3.T1.1.8.7.4">left kidney</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.9.8.1">8</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.9.8.2">sacrum</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.9.8.3">18</th>
<td class="ltx_td ltx_align_left" id="S3.T1.1.9.8.4">right kidney</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.10.9.1">9</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.10.9.2">left hip</td>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.10.9.3">19</th>
<td class="ltx_td ltx_align_left" id="S3.T1.1.10.9.4">urinary bladder</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.11.10.1">10</th>
<td class="ltx_td ltx_align_left ltx_border_rr" id="S3.T1.1.11.10.2">right hip</td>
<th class="ltx_td ltx_th ltx_th_row ltx_border_r" id="S3.T1.1.11.10.3"></th>
<td class="ltx_td" id="S3.T1.1.11.10.4"></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.3">For pre-processing, we resized the training dataset to 3mm isotropic voxel spacing and created a three channel input by windowing the CT image with a bone, lung and soft-tissue window followed by normalizing the gray values to [0, 1] in each channel. The network is a standard 3d U-Net with 32 filters in the first block, four stages and 20 output channels followed by a softmax function. The network was trained using the ADAMW optimizer as suggested by <cite class="ltx_cite ltx_citemacro_cite">Loshchilov and Hutter (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib11" title="">2017</a>)</cite> for 250.000 steps with a batch size of 4, a linear warm-up plus cosine decay schedule with a maximum learning rate of 0.0016, <math alttext="\beta_{1}=0.98" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><msub id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.2.2.cmml">β</mi><mn id="S3.SS1.p2.1.m1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">0.98</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><eq id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></eq><apply id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2.2">𝛽</ci><cn id="S3.SS1.p2.1.m1.1.1.2.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.2.3">1</cn></apply><cn id="S3.SS1.p2.1.m1.1.1.3.cmml" type="float" xref="S3.SS1.p2.1.m1.1.1.3">0.98</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\beta_{1}=0.98</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.98</annotation></semantics></math>, <math alttext="\beta_{2}=0.999" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.2.2.cmml">β</mi><mn id="S3.SS1.p2.2.m2.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">0.999</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><eq id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"></eq><apply id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2.2">𝛽</ci><cn id="S3.SS1.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.2.3">2</cn></apply><cn id="S3.SS1.p2.2.m2.1.1.3.cmml" type="float" xref="S3.SS1.p2.2.m2.1.1.3">0.999</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\beta_{2}=0.999</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.999</annotation></semantics></math> and a weight decay of 0.0001. We used a cubed input patches of <math alttext="64^{3}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msup id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mn id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">64</mn><mn id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">3</mn></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">superscript</csymbol><cn id="S3.SS1.p2.3.m3.1.1.2.cmml" type="integer" xref="S3.SS1.p2.3.m3.1.1.2">64</cn><cn id="S3.SS1.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p2.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">64^{3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">64 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT</annotation></semantics></math> voxels. To promote robustness of the network, we employed aggressive data augmentation during training, namely rotation in xy plane, z axis flipping, zooming in and out as well as heavy Gaussian noise and blurring (see Supplementary Materials for more Detail). In contrast to other segmentation frameworks like nnU-Net by <cite class="ltx_cite ltx_citemacro_cite">Isensee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib8" title="">2021</a>)</cite>, we do not resize the segmentations to the original resolution, but instead perform the atlas registration step using the isotropic resolution of 3mm to reduce the memory and computational cost.
<br class="ltx_break"/>Recent research of <cite class="ltx_cite ltx_citemacro_cite">Isensee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib9" title="">2024</a>)</cite> suggests that the performance of simple 3d U-Nets can be improved by simply changing the decoder to a ResNet and increasing the amount of convolutional layers. However, this comes at the expense of increased computational burden. To prevent this and maintain a high inference speed we decided against more elaborate architectures. Instead, we research how improved segmentation quality affects the registration results by applying the registration once with our automated segmentations and once with ground truth segmentations.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Atlas registration</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.12">The aim of the atlas registration is to find a mapping <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_T</annotation></semantics></math> which aligns the input CT image <math alttext="im" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">i</mi><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></times><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑖</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">im</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_i italic_m</annotation></semantics></math> (moving image) to the atlas (fixed image). Classical methods use the CT images directly and have the disadvantage of being sensitive towards the initial condition of the iterative scheme in the sense that they often get stuck in local minima in cases where large transformations are needed to align the two images. The registration method presented in this prevents this by <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.12.1">not</span> acting on CT images directly, but instead using the output of the anatomy segmentation described in the previous section. It is important to note that the atlas is <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.12.2">not</span> present as a CT image, but as a set of averaged segmentations of the anatomies listed in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.T1" title="Table 1 ‣ 3.1 Segmentation of anatomical structures ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">1</span></a>. The creation of this atlas of segmentations is described in the end of this section.
<br class="ltx_break"/>In principle any type of registration algorithm can be used to map the bounding box(es) from the atlas coordinate system to the scans coordinate system. In this work we decided to restrict the transformation such that the topology of bounding boxes is maintained after transformation. To be precises, we restrict the transformation such that transformed bounding boxes still have edges parallel to the x-, y-, and z-axis by allowing only translations, scalings and possibly 90-, 180- and 270-degrees rotations in the xy-plane as well as flippings along the z-axis. The computation of this transformation is divided in two steps, a first translation alignment followed by an iterative gradient descent step.
<br class="ltx_break"/>The first translational alignment step prevents the iterative scheme from getting stuck in local minima, especially for cases where large translations are needed for optimal alignment. To compute this translation, we compute the center of masses of the segmentations and used them as landmarks to minimize a weighted mean squared error. For this, let <math alttext="x\in\mathbb{R}^{19\times 3}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">x</mi><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.p1.3.m3.1.1.3.2" xref="S3.SS2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.3.m3.1.1.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.cmml"><mn id="S3.SS2.p1.3.m3.1.1.3.3.2" xref="S3.SS2.p1.3.m3.1.1.3.3.2.cmml">19</mn><mo id="S3.SS2.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p1.3.m3.1.1.3.3.3" xref="S3.SS2.p1.3.m3.1.1.3.3.3.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><in id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></in><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑥</ci><apply id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3"><times id="S3.SS2.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS2.p1.3.m3.1.1.3.3.1"></times><cn id="S3.SS2.p1.3.m3.1.1.3.3.2.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.3.3.2">19</cn><cn id="S3.SS2.p1.3.m3.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p1.3.m3.1.1.3.3.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">x\in\mathbb{R}^{19\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_x ∈ blackboard_R start_POSTSUPERSCRIPT 19 × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> be the center of mass of the segmentations from the input CT image and <math alttext="y\in\mathbb{R}^{19\times 3}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">y</mi><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml"><mi id="S3.SS2.p1.4.m4.1.1.3.2" xref="S3.SS2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.4.m4.1.1.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.cmml"><mn id="S3.SS2.p1.4.m4.1.1.3.3.2" xref="S3.SS2.p1.4.m4.1.1.3.3.2.cmml">19</mn><mo id="S3.SS2.p1.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.4.m4.1.1.3.3.1.cmml">×</mo><mn id="S3.SS2.p1.4.m4.1.1.3.3.3" xref="S3.SS2.p1.4.m4.1.1.3.3.3.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><in id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></in><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑦</ci><apply id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.p1.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3"><times id="S3.SS2.p1.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p1.4.m4.1.1.3.3.1"></times><cn id="S3.SS2.p1.4.m4.1.1.3.3.2.cmml" type="integer" xref="S3.SS2.p1.4.m4.1.1.3.3.2">19</cn><cn id="S3.SS2.p1.4.m4.1.1.3.3.3.cmml" type="integer" xref="S3.SS2.p1.4.m4.1.1.3.3.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">y\in\mathbb{R}^{19\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_y ∈ blackboard_R start_POSTSUPERSCRIPT 19 × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> be the center of mass of the segmentations of the atlas. The coordinates in <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_x</annotation></semantics></math> are only well-defined for anatomies that are covered in the input CT image. To put no weight on anatomies not covered in the input image and only little weight on those only partially covered, we introduce a weighting vector <math alttext="w" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_w</annotation></semantics></math>. This weighting vector is computed on the fly for each incoming image. For anatomy <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_i</annotation></semantics></math>, <math alttext="\tilde{w}_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mover accent="true" id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2.2" xref="S3.SS2.p1.8.m8.1.1.2.2.cmml">w</mi><mo id="S3.SS2.p1.8.m8.1.1.2.1" xref="S3.SS2.p1.8.m8.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><apply id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2"><ci id="S3.SS2.p1.8.m8.1.1.2.1.cmml" xref="S3.SS2.p1.8.m8.1.1.2.1">~</ci><ci id="S3.SS2.p1.8.m8.1.1.2.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2.2">𝑤</ci></apply><ci id="S3.SS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">\tilde{w}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">over~ start_ARG italic_w end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is computed as the ratio volume in the input image vs the volume of this anatomy in the atlas. The resulting vector is normalized to sum to 1 (<math alttext="w_{i}=\tilde{w}_{i}/\sum_{j}\tilde{w}_{j}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><mrow id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><msub id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2.2" xref="S3.SS2.p1.9.m9.1.1.2.2.cmml">w</mi><mi id="S3.SS2.p1.9.m9.1.1.2.3" xref="S3.SS2.p1.9.m9.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.9.m9.1.1.1" xref="S3.SS2.p1.9.m9.1.1.1.cmml">=</mo><mrow id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3.cmml"><msub id="S3.SS2.p1.9.m9.1.1.3.2" xref="S3.SS2.p1.9.m9.1.1.3.2.cmml"><mover accent="true" id="S3.SS2.p1.9.m9.1.1.3.2.2" xref="S3.SS2.p1.9.m9.1.1.3.2.2.cmml"><mi id="S3.SS2.p1.9.m9.1.1.3.2.2.2" xref="S3.SS2.p1.9.m9.1.1.3.2.2.2.cmml">w</mi><mo id="S3.SS2.p1.9.m9.1.1.3.2.2.1" xref="S3.SS2.p1.9.m9.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S3.SS2.p1.9.m9.1.1.3.2.3" xref="S3.SS2.p1.9.m9.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.SS2.p1.9.m9.1.1.3.1" rspace="0.055em" xref="S3.SS2.p1.9.m9.1.1.3.1.cmml">/</mo><mrow id="S3.SS2.p1.9.m9.1.1.3.3" xref="S3.SS2.p1.9.m9.1.1.3.3.cmml"><msub id="S3.SS2.p1.9.m9.1.1.3.3.1" xref="S3.SS2.p1.9.m9.1.1.3.3.1.cmml"><mo id="S3.SS2.p1.9.m9.1.1.3.3.1.2" xref="S3.SS2.p1.9.m9.1.1.3.3.1.2.cmml">∑</mo><mi id="S3.SS2.p1.9.m9.1.1.3.3.1.3" xref="S3.SS2.p1.9.m9.1.1.3.3.1.3.cmml">j</mi></msub><msub id="S3.SS2.p1.9.m9.1.1.3.3.2" xref="S3.SS2.p1.9.m9.1.1.3.3.2.cmml"><mover accent="true" id="S3.SS2.p1.9.m9.1.1.3.3.2.2" xref="S3.SS2.p1.9.m9.1.1.3.3.2.2.cmml"><mi id="S3.SS2.p1.9.m9.1.1.3.3.2.2.2" xref="S3.SS2.p1.9.m9.1.1.3.3.2.2.2.cmml">w</mi><mo id="S3.SS2.p1.9.m9.1.1.3.3.2.2.1" xref="S3.SS2.p1.9.m9.1.1.3.3.2.2.1.cmml">~</mo></mover><mi id="S3.SS2.p1.9.m9.1.1.3.3.2.3" xref="S3.SS2.p1.9.m9.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><eq id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1.1"></eq><apply id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2.2">𝑤</ci><ci id="S3.SS2.p1.9.m9.1.1.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><divide id="S3.SS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.1"></divide><apply id="S3.SS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.3.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2">subscript</csymbol><apply id="S3.SS2.p1.9.m9.1.1.3.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2.2"><ci id="S3.SS2.p1.9.m9.1.1.3.2.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2.2.1">~</ci><ci id="S3.SS2.p1.9.m9.1.1.3.2.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2.2.2">𝑤</ci></apply><ci id="S3.SS2.p1.9.m9.1.1.3.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.2.3">𝑖</ci></apply><apply id="S3.SS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3"><apply id="S3.SS2.p1.9.m9.1.1.3.3.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.3.3.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.1">subscript</csymbol><sum id="S3.SS2.p1.9.m9.1.1.3.3.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.1.2"></sum><ci id="S3.SS2.p1.9.m9.1.1.3.3.1.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.1.3">𝑗</ci></apply><apply id="S3.SS2.p1.9.m9.1.1.3.3.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.3.3.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.2">subscript</csymbol><apply id="S3.SS2.p1.9.m9.1.1.3.3.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.2.2"><ci id="S3.SS2.p1.9.m9.1.1.3.3.2.2.1.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.2.2.1">~</ci><ci id="S3.SS2.p1.9.m9.1.1.3.3.2.2.2.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.2.2.2">𝑤</ci></apply><ci id="S3.SS2.p1.9.m9.1.1.3.3.2.3.cmml" xref="S3.SS2.p1.9.m9.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">w_{i}=\tilde{w}_{i}/\sum_{j}\tilde{w}_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = over~ start_ARG italic_w end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT / ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT over~ start_ARG italic_w end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>). Given the two sets of center of masses <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m10.1"><semantics id="S3.SS2.p1.10.m10.1a"><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m11.1"><semantics id="S3.SS2.p1.11.m11.1a"><mi id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><ci id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m11.1d">italic_y</annotation></semantics></math> and a weighting vector <math alttext="w" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m12.1"><semantics id="S3.SS2.p1.12.m12.1a"><mi id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><ci id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m12.1d">italic_w</annotation></semantics></math>, we obtain the translation via</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S4.EGx1">
<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle t_{j}" class="ltx_Math" display="inline" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><msub id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">t</mi><mi id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2">𝑡</ci><ci id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle t_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{argmin}\sum_{i=1}^{19}w_{i}(x_{ij}+t_{j}-y_{ij})^{2}" class="ltx_Math" display="inline" id="S3.Ex1.m2.1"><semantics id="S3.Ex1.m2.1a"><mrow id="S3.Ex1.m2.1.1" xref="S3.Ex1.m2.1.1.cmml"><mi id="S3.Ex1.m2.1.1.3" xref="S3.Ex1.m2.1.1.3.cmml"></mi><mo id="S3.Ex1.m2.1.1.2" xref="S3.Ex1.m2.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m2.1.1.1" xref="S3.Ex1.m2.1.1.1.cmml"><mtext id="S3.Ex1.m2.1.1.1.3" xref="S3.Ex1.m2.1.1.1.3a.cmml">argmin</mtext><mo id="S3.Ex1.m2.1.1.1.2" xref="S3.Ex1.m2.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m2.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.2.cmml"><munderover id="S3.Ex1.m2.1.1.1.1.2a" xref="S3.Ex1.m2.1.1.1.1.2.cmml"><mo id="S3.Ex1.m2.1.1.1.1.2.2.2" movablelimits="false" xref="S3.Ex1.m2.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex1.m2.1.1.1.1.2.2.3" xref="S3.Ex1.m2.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1.2.2.3.2" xref="S3.Ex1.m2.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex1.m2.1.1.1.1.2.2.3.1" xref="S3.Ex1.m2.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex1.m2.1.1.1.1.2.2.3.3" xref="S3.Ex1.m2.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mn id="S3.Ex1.m2.1.1.1.1.2.3" xref="S3.Ex1.m2.1.1.1.1.2.3.cmml">19</mn></munderover></mstyle><mrow id="S3.Ex1.m2.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.cmml"><msub id="S3.Ex1.m2.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.3.2" xref="S3.Ex1.m2.1.1.1.1.1.3.2.cmml">w</mi><mi id="S3.Ex1.m2.1.1.1.1.1.3.3" xref="S3.Ex1.m2.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex1.m2.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.2.cmml">⁢</mo><msup id="S3.Ex1.m2.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">x</mi><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1.cmml">+</mo><msub id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mrow id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S3.Ex1.m2.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.Ex1.m2.1.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.1b"><apply id="S3.Ex1.m2.1.1.cmml" xref="S3.Ex1.m2.1.1"><eq id="S3.Ex1.m2.1.1.2.cmml" xref="S3.Ex1.m2.1.1.2"></eq><csymbol cd="latexml" id="S3.Ex1.m2.1.1.3.cmml" xref="S3.Ex1.m2.1.1.3">absent</csymbol><apply id="S3.Ex1.m2.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1"><times id="S3.Ex1.m2.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.2"></times><ci id="S3.Ex1.m2.1.1.1.3a.cmml" xref="S3.Ex1.m2.1.1.1.3"><mtext id="S3.Ex1.m2.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.3">argmin</mtext></ci><apply id="S3.Ex1.m2.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1"><apply id="S3.Ex1.m2.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex1.m2.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m2.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1.m2.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m2.1.1.1.1.2.2.2"></sum><apply id="S3.Ex1.m2.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m2.1.1.1.1.2.2.3"><eq id="S3.Ex1.m2.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex1.m2.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.Ex1.m2.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.Ex1.m2.1.1.1.1.2.2.3.3">1</cn></apply></apply><cn id="S3.Ex1.m2.1.1.1.1.2.3.cmml" type="integer" xref="S3.Ex1.m2.1.1.1.1.2.3">19</cn></apply><apply id="S3.Ex1.m2.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1"><times id="S3.Ex1.m2.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.2"></times><apply id="S3.Ex1.m2.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.3.2">𝑤</ci><ci id="S3.Ex1.m2.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex1.m2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1"><minus id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2"><plus id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.1"></plus><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.2">𝑥</ci><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3"><times id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><apply id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><cn id="S3.Ex1.m2.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex1.m2.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.1c">\displaystyle=\text{argmin}\sum_{i=1}^{19}w_{i}(x_{ij}+t_{j}-y_{ij})^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m2.1d">= argmin ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 19 end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT + italic_t start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT - italic_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{i=1}^{19}w_{i}(y_{ij}-x_{ij})" class="ltx_Math" display="inline" id="S3.Ex2.m1.1"><semantics id="S3.Ex2.m1.1a"><mrow id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml"><mi id="S3.Ex2.m1.1.1.3" xref="S3.Ex2.m1.1.1.3.cmml"></mi><mo id="S3.Ex2.m1.1.1.2" xref="S3.Ex2.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex2.m1.1.1.1" xref="S3.Ex2.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex2.m1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.2.cmml"><munderover id="S3.Ex2.m1.1.1.1.2a" xref="S3.Ex2.m1.1.1.1.2.cmml"><mo id="S3.Ex2.m1.1.1.1.2.2.2" movablelimits="false" xref="S3.Ex2.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex2.m1.1.1.1.2.2.3" xref="S3.Ex2.m1.1.1.1.2.2.3.cmml"><mi id="S3.Ex2.m1.1.1.1.2.2.3.2" xref="S3.Ex2.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex2.m1.1.1.1.2.2.3.1" xref="S3.Ex2.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex2.m1.1.1.1.2.2.3.3" xref="S3.Ex2.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mn id="S3.Ex2.m1.1.1.1.2.3" xref="S3.Ex2.m1.1.1.1.2.3.cmml">19</mn></munderover></mstyle><mrow id="S3.Ex2.m1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.cmml"><msub id="S3.Ex2.m1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.3.2" xref="S3.Ex2.m1.1.1.1.1.3.2.cmml">w</mi><mi id="S3.Ex2.m1.1.1.1.1.3.3" xref="S3.Ex2.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex2.m1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex2.m1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex2.m1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.2.2" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mrow id="S3.Ex2.m1.1.1.1.1.1.1.1.2.3" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex2.m1.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.Ex2.m1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.3.2" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.Ex2.m1.1.1.1.1.1.1.1.3.3" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.1" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.3" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo id="S3.Ex2.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.1b"><apply id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1"><eq id="S3.Ex2.m1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.Ex2.m1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.3">absent</csymbol><apply id="S3.Ex2.m1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1"><apply id="S3.Ex2.m1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.2">superscript</csymbol><apply id="S3.Ex2.m1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.2.2.1.cmml" xref="S3.Ex2.m1.1.1.1.2">subscript</csymbol><sum id="S3.Ex2.m1.1.1.1.2.2.2.cmml" xref="S3.Ex2.m1.1.1.1.2.2.2"></sum><apply id="S3.Ex2.m1.1.1.1.2.2.3.cmml" xref="S3.Ex2.m1.1.1.1.2.2.3"><eq id="S3.Ex2.m1.1.1.1.2.2.3.1.cmml" xref="S3.Ex2.m1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex2.m1.1.1.1.2.2.3.2.cmml" xref="S3.Ex2.m1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.Ex2.m1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.Ex2.m1.1.1.1.2.2.3.3">1</cn></apply></apply><cn id="S3.Ex2.m1.1.1.1.2.3.cmml" type="integer" xref="S3.Ex2.m1.1.1.1.2.3">19</cn></apply><apply id="S3.Ex2.m1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1"><times id="S3.Ex2.m1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.2"></times><apply id="S3.Ex2.m1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.3.2">𝑤</ci><ci id="S3.Ex2.m1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1"><minus id="S3.Ex2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.1"></minus><apply id="S3.Ex2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.2">𝑦</ci><apply id="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.3"><times id="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex2.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.3"><times id="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex2.m1.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.1c">\displaystyle=\sum_{i=1}^{19}w_{i}(y_{ij}-x_{ij})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.1d">= ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 19 end_POSTSUPERSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT - italic_x start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.14">To account for misalignment of the atlas and input image in terms of 90-, 180-, or 270-degree rotations in the xy plane or a flipped z-axis, we iterate over all possible configurations and choose the one that minimizes the previously described weighted mean squared error of the landmarks. The landmark-based registration is computationally cheap, but contains imperfections as the landmarks contain less information than the set of segmentation masks. The initial translational alignment is a crucial step as it prevents the iterative refinement scheme from getting stuck in local minima like traditional image-based methods do.
<br class="ltx_break"/>To improve upon the landmark-based registration, we perform a gradient descent-based refinement scheme to obtain the final translation and scaling component of the registration transformation. This is performed by minimizing the dice loss between the segmentation masks of the CT image <math alttext="seg_{im}" class="ltx_Math" display="inline" id="S3.SS2.p1.13.m1.1"><semantics id="S3.SS2.p1.13.m1.1a"><mrow id="S3.SS2.p1.13.m1.1.1" xref="S3.SS2.p1.13.m1.1.1.cmml"><mi id="S3.SS2.p1.13.m1.1.1.2" xref="S3.SS2.p1.13.m1.1.1.2.cmml">s</mi><mo id="S3.SS2.p1.13.m1.1.1.1" xref="S3.SS2.p1.13.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.13.m1.1.1.3" xref="S3.SS2.p1.13.m1.1.1.3.cmml">e</mi><mo id="S3.SS2.p1.13.m1.1.1.1a" xref="S3.SS2.p1.13.m1.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p1.13.m1.1.1.4" xref="S3.SS2.p1.13.m1.1.1.4.cmml"><mi id="S3.SS2.p1.13.m1.1.1.4.2" xref="S3.SS2.p1.13.m1.1.1.4.2.cmml">g</mi><mrow id="S3.SS2.p1.13.m1.1.1.4.3" xref="S3.SS2.p1.13.m1.1.1.4.3.cmml"><mi id="S3.SS2.p1.13.m1.1.1.4.3.2" xref="S3.SS2.p1.13.m1.1.1.4.3.2.cmml">i</mi><mo id="S3.SS2.p1.13.m1.1.1.4.3.1" xref="S3.SS2.p1.13.m1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.13.m1.1.1.4.3.3" xref="S3.SS2.p1.13.m1.1.1.4.3.3.cmml">m</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m1.1b"><apply id="S3.SS2.p1.13.m1.1.1.cmml" xref="S3.SS2.p1.13.m1.1.1"><times id="S3.SS2.p1.13.m1.1.1.1.cmml" xref="S3.SS2.p1.13.m1.1.1.1"></times><ci id="S3.SS2.p1.13.m1.1.1.2.cmml" xref="S3.SS2.p1.13.m1.1.1.2">𝑠</ci><ci id="S3.SS2.p1.13.m1.1.1.3.cmml" xref="S3.SS2.p1.13.m1.1.1.3">𝑒</ci><apply id="S3.SS2.p1.13.m1.1.1.4.cmml" xref="S3.SS2.p1.13.m1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m1.1.1.4.1.cmml" xref="S3.SS2.p1.13.m1.1.1.4">subscript</csymbol><ci id="S3.SS2.p1.13.m1.1.1.4.2.cmml" xref="S3.SS2.p1.13.m1.1.1.4.2">𝑔</ci><apply id="S3.SS2.p1.13.m1.1.1.4.3.cmml" xref="S3.SS2.p1.13.m1.1.1.4.3"><times id="S3.SS2.p1.13.m1.1.1.4.3.1.cmml" xref="S3.SS2.p1.13.m1.1.1.4.3.1"></times><ci id="S3.SS2.p1.13.m1.1.1.4.3.2.cmml" xref="S3.SS2.p1.13.m1.1.1.4.3.2">𝑖</ci><ci id="S3.SS2.p1.13.m1.1.1.4.3.3.cmml" xref="S3.SS2.p1.13.m1.1.1.4.3.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m1.1c">seg_{im}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.13.m1.1d">italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT</annotation></semantics></math> and the atlas <math alttext="seg_{atlas}" class="ltx_Math" display="inline" id="S3.SS2.p1.14.m2.1"><semantics id="S3.SS2.p1.14.m2.1a"><mrow id="S3.SS2.p1.14.m2.1.1" xref="S3.SS2.p1.14.m2.1.1.cmml"><mi id="S3.SS2.p1.14.m2.1.1.2" xref="S3.SS2.p1.14.m2.1.1.2.cmml">s</mi><mo id="S3.SS2.p1.14.m2.1.1.1" xref="S3.SS2.p1.14.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p1.14.m2.1.1.3" xref="S3.SS2.p1.14.m2.1.1.3.cmml">e</mi><mo id="S3.SS2.p1.14.m2.1.1.1a" xref="S3.SS2.p1.14.m2.1.1.1.cmml">⁢</mo><msub id="S3.SS2.p1.14.m2.1.1.4" xref="S3.SS2.p1.14.m2.1.1.4.cmml"><mi id="S3.SS2.p1.14.m2.1.1.4.2" xref="S3.SS2.p1.14.m2.1.1.4.2.cmml">g</mi><mrow id="S3.SS2.p1.14.m2.1.1.4.3" xref="S3.SS2.p1.14.m2.1.1.4.3.cmml"><mi id="S3.SS2.p1.14.m2.1.1.4.3.2" xref="S3.SS2.p1.14.m2.1.1.4.3.2.cmml">a</mi><mo id="S3.SS2.p1.14.m2.1.1.4.3.1" xref="S3.SS2.p1.14.m2.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.14.m2.1.1.4.3.3" xref="S3.SS2.p1.14.m2.1.1.4.3.3.cmml">t</mi><mo id="S3.SS2.p1.14.m2.1.1.4.3.1a" xref="S3.SS2.p1.14.m2.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.14.m2.1.1.4.3.4" xref="S3.SS2.p1.14.m2.1.1.4.3.4.cmml">l</mi><mo id="S3.SS2.p1.14.m2.1.1.4.3.1b" xref="S3.SS2.p1.14.m2.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.14.m2.1.1.4.3.5" xref="S3.SS2.p1.14.m2.1.1.4.3.5.cmml">a</mi><mo id="S3.SS2.p1.14.m2.1.1.4.3.1c" xref="S3.SS2.p1.14.m2.1.1.4.3.1.cmml">⁢</mo><mi id="S3.SS2.p1.14.m2.1.1.4.3.6" xref="S3.SS2.p1.14.m2.1.1.4.3.6.cmml">s</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m2.1b"><apply id="S3.SS2.p1.14.m2.1.1.cmml" xref="S3.SS2.p1.14.m2.1.1"><times id="S3.SS2.p1.14.m2.1.1.1.cmml" xref="S3.SS2.p1.14.m2.1.1.1"></times><ci id="S3.SS2.p1.14.m2.1.1.2.cmml" xref="S3.SS2.p1.14.m2.1.1.2">𝑠</ci><ci id="S3.SS2.p1.14.m2.1.1.3.cmml" xref="S3.SS2.p1.14.m2.1.1.3">𝑒</ci><apply id="S3.SS2.p1.14.m2.1.1.4.cmml" xref="S3.SS2.p1.14.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p1.14.m2.1.1.4.1.cmml" xref="S3.SS2.p1.14.m2.1.1.4">subscript</csymbol><ci id="S3.SS2.p1.14.m2.1.1.4.2.cmml" xref="S3.SS2.p1.14.m2.1.1.4.2">𝑔</ci><apply id="S3.SS2.p1.14.m2.1.1.4.3.cmml" xref="S3.SS2.p1.14.m2.1.1.4.3"><times id="S3.SS2.p1.14.m2.1.1.4.3.1.cmml" xref="S3.SS2.p1.14.m2.1.1.4.3.1"></times><ci id="S3.SS2.p1.14.m2.1.1.4.3.2.cmml" xref="S3.SS2.p1.14.m2.1.1.4.3.2">𝑎</ci><ci id="S3.SS2.p1.14.m2.1.1.4.3.3.cmml" xref="S3.SS2.p1.14.m2.1.1.4.3.3">𝑡</ci><ci id="S3.SS2.p1.14.m2.1.1.4.3.4.cmml" xref="S3.SS2.p1.14.m2.1.1.4.3.4">𝑙</ci><ci id="S3.SS2.p1.14.m2.1.1.4.3.5.cmml" xref="S3.SS2.p1.14.m2.1.1.4.3.5">𝑎</ci><ci id="S3.SS2.p1.14.m2.1.1.4.3.6.cmml" xref="S3.SS2.p1.14.m2.1.1.4.3.6">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m2.1c">seg_{atlas}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.14.m2.1d">italic_s italic_e italic_g start_POSTSUBSCRIPT italic_a italic_t italic_l italic_a italic_s end_POSTSUBSCRIPT</annotation></semantics></math></p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{T}L^{dsc}(T(seg_{im}),seg_{atlas})," class="ltx_Math" display="block" id="S3.Ex3.m1.1"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.1.4.cmml"><munder id="S3.Ex3.m1.1.1.1.1.4.1" xref="S3.Ex3.m1.1.1.1.1.4.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.4.1.2" xref="S3.Ex3.m1.1.1.1.1.4.1.2.cmml">min</mi><mi id="S3.Ex3.m1.1.1.1.1.4.1.3" xref="S3.Ex3.m1.1.1.1.1.4.1.3.cmml">T</mi></munder><mo id="S3.Ex3.m1.1.1.1.1.4a" lspace="0.167em" xref="S3.Ex3.m1.1.1.1.1.4.cmml">⁡</mo><msup id="S3.Ex3.m1.1.1.1.1.4.2" xref="S3.Ex3.m1.1.1.1.1.4.2.cmml"><mi id="S3.Ex3.m1.1.1.1.1.4.2.2" xref="S3.Ex3.m1.1.1.1.1.4.2.2.cmml">L</mi><mrow id="S3.Ex3.m1.1.1.1.1.4.2.3" xref="S3.Ex3.m1.1.1.1.1.4.2.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.4.2.3.2" xref="S3.Ex3.m1.1.1.1.1.4.2.3.2.cmml">d</mi><mo id="S3.Ex3.m1.1.1.1.1.4.2.3.1" xref="S3.Ex3.m1.1.1.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.4.2.3.3" xref="S3.Ex3.m1.1.1.1.1.4.2.3.3.cmml">s</mi><mo id="S3.Ex3.m1.1.1.1.1.4.2.3.1a" xref="S3.Ex3.m1.1.1.1.1.4.2.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.4.2.3.4" xref="S3.Ex3.m1.1.1.1.1.4.2.3.4.cmml">c</mi></mrow></msup></mrow><mo id="S3.Ex3.m1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.3.cmml">⁢</mo><mrow id="S3.Ex3.m1.1.1.1.1.2.2" xref="S3.Ex3.m1.1.1.1.1.2.3.cmml"><mo id="S3.Ex3.m1.1.1.1.1.2.2.3" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.2.3.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.3.cmml">T</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">s</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1a" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.1.1.1.1.2.2.4" xref="S3.Ex3.m1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.Ex3.m1.1.1.1.1.2.2.2" xref="S3.Ex3.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex3.m1.1.1.1.1.2.2.2.2" xref="S3.Ex3.m1.1.1.1.1.2.2.2.2.cmml">s</mi><mo id="S3.Ex3.m1.1.1.1.1.2.2.2.1" xref="S3.Ex3.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.2.2.2.3" xref="S3.Ex3.m1.1.1.1.1.2.2.2.3.cmml">e</mi><mo id="S3.Ex3.m1.1.1.1.1.2.2.2.1a" xref="S3.Ex3.m1.1.1.1.1.2.2.2.1.cmml">⁢</mo><msub id="S3.Ex3.m1.1.1.1.1.2.2.2.4" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.cmml"><mi id="S3.Ex3.m1.1.1.1.1.2.2.2.4.2" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.2.cmml">g</mi><mrow id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.2" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.2.cmml">a</mi><mo id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.3" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.3.cmml">t</mi><mo id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1a" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.4" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.4.cmml">l</mi><mo id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1b" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.5" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.5.cmml">a</mi><mo id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1c" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.6" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.6.cmml">s</mi></mrow></msub></mrow><mo id="S3.Ex3.m1.1.1.1.1.2.2.5" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><times id="S3.Ex3.m1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.3"></times><apply id="S3.Ex3.m1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.1.4"><apply id="S3.Ex3.m1.1.1.1.1.4.1.cmml" xref="S3.Ex3.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.4.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.4.1">subscript</csymbol><min id="S3.Ex3.m1.1.1.1.1.4.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.4.1.2"></min><ci id="S3.Ex3.m1.1.1.1.1.4.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.4.1.3">𝑇</ci></apply><apply id="S3.Ex3.m1.1.1.1.1.4.2.cmml" xref="S3.Ex3.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.4.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.4.2">superscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.4.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.4.2.2">𝐿</ci><apply id="S3.Ex3.m1.1.1.1.1.4.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.4.2.3"><times id="S3.Ex3.m1.1.1.1.1.4.2.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.4.2.3.1"></times><ci id="S3.Ex3.m1.1.1.1.1.4.2.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.4.2.3.2">𝑑</ci><ci id="S3.Ex3.m1.1.1.1.1.4.2.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.4.2.3.3">𝑠</ci><ci id="S3.Ex3.m1.1.1.1.1.4.2.3.4.cmml" xref="S3.Ex3.m1.1.1.1.1.4.2.3.4">𝑐</ci></apply></apply></apply><interval closure="open" id="S3.Ex3.m1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2"><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1"><times id="S3.Ex3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.2"></times><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.3">𝑇</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.3">𝑒</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.2">𝑔</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3"><times id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.1"></times><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.4.3.3">𝑚</ci></apply></apply></apply></apply><apply id="S3.Ex3.m1.1.1.1.1.2.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2"><times id="S3.Ex3.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.1"></times><ci id="S3.Ex3.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.2">𝑠</ci><ci id="S3.Ex3.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.3">𝑒</ci><apply id="S3.Ex3.m1.1.1.1.1.2.2.2.4.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.2.2.2.4.1.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.2.2.2.4.2.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.2">𝑔</ci><apply id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3"><times id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.1"></times><ci id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.2">𝑎</ci><ci id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.3">𝑡</ci><ci id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.4.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.4">𝑙</ci><ci id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.5.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.5">𝑎</ci><ci id="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.6.cmml" xref="S3.Ex3.m1.1.1.1.1.2.2.2.4.3.6">𝑠</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\min_{T}L^{dsc}(T(seg_{im}),seg_{atlas}),</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1d">roman_min start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT italic_L start_POSTSUPERSCRIPT italic_d italic_s italic_c end_POSTSUPERSCRIPT ( italic_T ( italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT ) , italic_s italic_e italic_g start_POSTSUBSCRIPT italic_a italic_t italic_l italic_a italic_s end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.15">where <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.p1.15.m1.1"><semantics id="S3.SS2.p1.15.m1.1a"><mi id="S3.SS2.p1.15.m1.1.1" xref="S3.SS2.p1.15.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m1.1b"><ci id="S3.SS2.p1.15.m1.1.1.cmml" xref="S3.SS2.p1.15.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.15.m1.1d">italic_T</annotation></semantics></math> denotes the registration operator that maps the moving image to the fixed.
We initialise the parameters of the translation as the ones computed by the landmark-based approach and the parameters of the scaling as ones (no scaling). Next, we apply gradient descent to minimize the dice loss between the anatomy segmentations of the input CT image (moving image) and the atlas (fixed image). We use an initial step size of 0.05 and reduce the step size by a factor of 2 each time the loss did not decrease by at least 0.005 between two iterations. The iteration is stopped when reducing the step size a fourth time. The rotations in xy-plane the and flipping of the z-axis are left unchanged in this stage.
<br class="ltx_break"/>The atlas of anatomical segmentations was obtained by registering and averaging all 37 scans from the Totalsegmentator that contained all 19 segmentation classes. First, each of these scans was registered to all remaining 36 scans and the average over all 36 translations and scalings was computed. Second, these averaged transformations were applied to each corresponding set of segmentations of the anatomical structures. Third, we computed a provisionally atlas by computing the voxel-vise average of the transformed anatomy segmentations. Fourth, each scan was registered to the provisionally atlas. The final atlas was computed by the voxel-wise average of the aforementioned registered anatomy segmentations and checked visually.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Cropping of pre-defined anatomical regions</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.7">Let’s assume that the anatomical region of interest is given as one or multiple bounding boxes <math alttext="bb_{1},\dots,bb_{k}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.3"><semantics id="S3.SS3.p1.1.m1.3a"><mrow id="S3.SS3.p1.1.m1.3.3.2" xref="S3.SS3.p1.1.m1.3.3.3.cmml"><mrow id="S3.SS3.p1.1.m1.2.2.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS3.p1.1.m1.2.2.1.1.2" xref="S3.SS3.p1.1.m1.2.2.1.1.2.cmml">b</mi><mo id="S3.SS3.p1.1.m1.2.2.1.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p1.1.m1.2.2.1.1.3" xref="S3.SS3.p1.1.m1.2.2.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.2.2.1.1.3.2" xref="S3.SS3.p1.1.m1.2.2.1.1.3.2.cmml">b</mi><mn id="S3.SS3.p1.1.m1.2.2.1.1.3.3" xref="S3.SS3.p1.1.m1.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS3.p1.1.m1.3.3.2.3" xref="S3.SS3.p1.1.m1.3.3.3.cmml">,</mo><mi id="S3.SS3.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS3.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.p1.1.m1.3.3.2.4" xref="S3.SS3.p1.1.m1.3.3.3.cmml">,</mo><mrow id="S3.SS3.p1.1.m1.3.3.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS3.p1.1.m1.3.3.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.cmml">b</mi><mo id="S3.SS3.p1.1.m1.3.3.2.2.1" xref="S3.SS3.p1.1.m1.3.3.2.2.1.cmml">⁢</mo><msub id="S3.SS3.p1.1.m1.3.3.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.3.cmml"><mi id="S3.SS3.p1.1.m1.3.3.2.2.3.2" xref="S3.SS3.p1.1.m1.3.3.2.2.3.2.cmml">b</mi><mi id="S3.SS3.p1.1.m1.3.3.2.2.3.3" xref="S3.SS3.p1.1.m1.3.3.2.2.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.3b"><list id="S3.SS3.p1.1.m1.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2"><apply id="S3.SS3.p1.1.m1.2.2.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1"><times id="S3.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1"></times><ci id="S3.SS3.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.2">𝑏</ci><apply id="S3.SS3.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.2.2.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.3.2">𝑏</ci><cn id="S3.SS3.p1.1.m1.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.1.m1.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">…</ci><apply id="S3.SS3.p1.1.m1.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2"><times id="S3.SS3.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.1"></times><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">𝑏</ci><apply id="S3.SS3.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.3.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.2.2.3.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.3.2">𝑏</ci><ci id="S3.SS3.p1.1.m1.3.3.2.2.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.3.3">𝑘</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.3c">bb_{1},\dots,bb_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.3d">italic_b italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_b italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> in the coordinate system of the atlas. To map those bounding box(es) to the coordinate system of the input image, one first has to compute the registration transformation <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_T</annotation></semantics></math> as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS2" title="3.2 Atlas registration ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.2</span></a>. As <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_T</annotation></semantics></math> maps the input image (moving image) to the atlas (fixed image), <math alttext="T^{-1}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msup id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">T</mi><mrow id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mo id="S3.SS3.p1.4.m4.1.1.3a" xref="S3.SS3.p1.4.m4.1.1.3.cmml">−</mo><mn id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑇</ci><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><minus id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3"></minus><cn id="S3.SS3.p1.4.m4.1.1.3.2.cmml" type="integer" xref="S3.SS3.p1.4.m4.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">T^{-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_T start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT</annotation></semantics></math> maps the bounding boxes <math alttext="bb_{1},\dots,bb_{k}" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.3"><semantics id="S3.SS3.p1.5.m5.3a"><mrow id="S3.SS3.p1.5.m5.3.3.2" xref="S3.SS3.p1.5.m5.3.3.3.cmml"><mrow id="S3.SS3.p1.5.m5.2.2.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.2" xref="S3.SS3.p1.5.m5.2.2.1.1.2.cmml">b</mi><mo id="S3.SS3.p1.5.m5.2.2.1.1.1" xref="S3.SS3.p1.5.m5.2.2.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p1.5.m5.2.2.1.1.3" xref="S3.SS3.p1.5.m5.2.2.1.1.3.cmml"><mi id="S3.SS3.p1.5.m5.2.2.1.1.3.2" xref="S3.SS3.p1.5.m5.2.2.1.1.3.2.cmml">b</mi><mn id="S3.SS3.p1.5.m5.2.2.1.1.3.3" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS3.p1.5.m5.3.3.2.3" xref="S3.SS3.p1.5.m5.3.3.3.cmml">,</mo><mi id="S3.SS3.p1.5.m5.1.1" mathvariant="normal" xref="S3.SS3.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS3.p1.5.m5.3.3.2.4" xref="S3.SS3.p1.5.m5.3.3.3.cmml">,</mo><mrow id="S3.SS3.p1.5.m5.3.3.2.2" xref="S3.SS3.p1.5.m5.3.3.2.2.cmml"><mi id="S3.SS3.p1.5.m5.3.3.2.2.2" xref="S3.SS3.p1.5.m5.3.3.2.2.2.cmml">b</mi><mo id="S3.SS3.p1.5.m5.3.3.2.2.1" xref="S3.SS3.p1.5.m5.3.3.2.2.1.cmml">⁢</mo><msub id="S3.SS3.p1.5.m5.3.3.2.2.3" xref="S3.SS3.p1.5.m5.3.3.2.2.3.cmml"><mi id="S3.SS3.p1.5.m5.3.3.2.2.3.2" xref="S3.SS3.p1.5.m5.3.3.2.2.3.2.cmml">b</mi><mi id="S3.SS3.p1.5.m5.3.3.2.2.3.3" xref="S3.SS3.p1.5.m5.3.3.2.2.3.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.3b"><list id="S3.SS3.p1.5.m5.3.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3.2"><apply id="S3.SS3.p1.5.m5.2.2.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1"><times id="S3.SS3.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1"></times><ci id="S3.SS3.p1.5.m5.2.2.1.1.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.2">𝑏</ci><apply id="S3.SS3.p1.5.m5.2.2.1.1.3.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.2.2.1.1.3.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.5.m5.2.2.1.1.3.2.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.3.2">𝑏</ci><cn id="S3.SS3.p1.5.m5.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.5.m5.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">…</ci><apply id="S3.SS3.p1.5.m5.3.3.2.2.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2"><times id="S3.SS3.p1.5.m5.3.3.2.2.1.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.1"></times><ci id="S3.SS3.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.2">𝑏</ci><apply id="S3.SS3.p1.5.m5.3.3.2.2.3.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.2.2.3.1.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.2.2.3.2.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.3.2">𝑏</ci><ci id="S3.SS3.p1.5.m5.3.3.2.2.3.3.cmml" xref="S3.SS3.p1.5.m5.3.3.2.2.3.3">𝑘</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.3c">bb_{1},\dots,bb_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.3d">italic_b italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_b italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> to the input images coordinate system. By design of <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_T</annotation></semantics></math> the mapped bounding boxes <math alttext="T^{-1}(bb_{1}),\dots,T^{-1}(bb_{k})" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.3"><semantics id="S3.SS3.p1.7.m7.3a"><mrow id="S3.SS3.p1.7.m7.3.3.2" xref="S3.SS3.p1.7.m7.3.3.3.cmml"><mrow id="S3.SS3.p1.7.m7.2.2.1.1" xref="S3.SS3.p1.7.m7.2.2.1.1.cmml"><msup id="S3.SS3.p1.7.m7.2.2.1.1.3" xref="S3.SS3.p1.7.m7.2.2.1.1.3.cmml"><mi id="S3.SS3.p1.7.m7.2.2.1.1.3.2" xref="S3.SS3.p1.7.m7.2.2.1.1.3.2.cmml">T</mi><mrow id="S3.SS3.p1.7.m7.2.2.1.1.3.3" xref="S3.SS3.p1.7.m7.2.2.1.1.3.3.cmml"><mo id="S3.SS3.p1.7.m7.2.2.1.1.3.3a" xref="S3.SS3.p1.7.m7.2.2.1.1.3.3.cmml">−</mo><mn id="S3.SS3.p1.7.m7.2.2.1.1.3.3.2" xref="S3.SS3.p1.7.m7.2.2.1.1.3.3.2.cmml">1</mn></mrow></msup><mo id="S3.SS3.p1.7.m7.2.2.1.1.2" xref="S3.SS3.p1.7.m7.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.7.m7.2.2.1.1.1.1" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.7.m7.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.2" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.2.cmml">b</mi><mo id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.1" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.2" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.2.cmml">b</mi><mn id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.3" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.SS3.p1.7.m7.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.7.m7.3.3.2.3" xref="S3.SS3.p1.7.m7.3.3.3.cmml">,</mo><mi id="S3.SS3.p1.7.m7.1.1" mathvariant="normal" xref="S3.SS3.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS3.p1.7.m7.3.3.2.4" xref="S3.SS3.p1.7.m7.3.3.3.cmml">,</mo><mrow id="S3.SS3.p1.7.m7.3.3.2.2" xref="S3.SS3.p1.7.m7.3.3.2.2.cmml"><msup id="S3.SS3.p1.7.m7.3.3.2.2.3" xref="S3.SS3.p1.7.m7.3.3.2.2.3.cmml"><mi id="S3.SS3.p1.7.m7.3.3.2.2.3.2" xref="S3.SS3.p1.7.m7.3.3.2.2.3.2.cmml">T</mi><mrow id="S3.SS3.p1.7.m7.3.3.2.2.3.3" xref="S3.SS3.p1.7.m7.3.3.2.2.3.3.cmml"><mo id="S3.SS3.p1.7.m7.3.3.2.2.3.3a" xref="S3.SS3.p1.7.m7.3.3.2.2.3.3.cmml">−</mo><mn id="S3.SS3.p1.7.m7.3.3.2.2.3.3.2" xref="S3.SS3.p1.7.m7.3.3.2.2.3.3.2.cmml">1</mn></mrow></msup><mo id="S3.SS3.p1.7.m7.3.3.2.2.2" xref="S3.SS3.p1.7.m7.3.3.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p1.7.m7.3.3.2.2.1.1" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.cmml"><mo id="S3.SS3.p1.7.m7.3.3.2.2.1.1.2" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.2" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.2.cmml">b</mi><mo id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.1" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.1.cmml">⁢</mo><msub id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.cmml"><mi id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.2" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.2.cmml">b</mi><mi id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.3" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.3.cmml">k</mi></msub></mrow><mo id="S3.SS3.p1.7.m7.3.3.2.2.1.1.3" stretchy="false" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.3b"><list id="S3.SS3.p1.7.m7.3.3.3.cmml" xref="S3.SS3.p1.7.m7.3.3.2"><apply id="S3.SS3.p1.7.m7.2.2.1.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1"><times id="S3.SS3.p1.7.m7.2.2.1.1.2.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.2"></times><apply id="S3.SS3.p1.7.m7.2.2.1.1.3.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.2.2.1.1.3.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.7.m7.2.2.1.1.3.2.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.3.2">𝑇</ci><apply id="S3.SS3.p1.7.m7.2.2.1.1.3.3.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.3.3"><minus id="S3.SS3.p1.7.m7.2.2.1.1.3.3.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.3.3"></minus><cn id="S3.SS3.p1.7.m7.2.2.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.p1.7.m7.2.2.1.1.3.3.2">1</cn></apply></apply><apply id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1"><times id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.1"></times><ci id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.2">𝑏</ci><apply id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.2">𝑏</ci><cn id="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.7.m7.2.2.1.1.1.1.1.3.3">1</cn></apply></apply></apply><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">…</ci><apply id="S3.SS3.p1.7.m7.3.3.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2"><times id="S3.SS3.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.2"></times><apply id="S3.SS3.p1.7.m7.3.3.2.2.3.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.3.3.2.2.3.1.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.3">superscript</csymbol><ci id="S3.SS3.p1.7.m7.3.3.2.2.3.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.3.2">𝑇</ci><apply id="S3.SS3.p1.7.m7.3.3.2.2.3.3.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.3.3"><minus id="S3.SS3.p1.7.m7.3.3.2.2.3.3.1.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.3.3"></minus><cn id="S3.SS3.p1.7.m7.3.3.2.2.3.3.2.cmml" type="integer" xref="S3.SS3.p1.7.m7.3.3.2.2.3.3.2">1</cn></apply></apply><apply id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1"><times id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.1"></times><ci id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.2">𝑏</ci><apply id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.1.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.2">𝑏</ci><ci id="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.3.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.1.1.1.3.3">𝑘</ci></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.3c">T^{-1}(bb_{1}),\dots,T^{-1}(bb_{k})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.3d">italic_T start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_b italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , … , italic_T start_POSTSUPERSCRIPT - 1 end_POSTSUPERSCRIPT ( italic_b italic_b start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT )</annotation></semantics></math> still have edges parallel to the x-, y-, and z-axis and thus can be used for cropping without any need for interpolation. This workflow is visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.F1" title="Figure 1 ‣ 3.3 Cropping of pre-defined anatomical regions ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">1</span></a> and presented as pseudo code in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#alg1" title="Algorithm 1 ‣ 3.3 Cropping of pre-defined anatomical regions ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="231" id="S3.F1.g1" src="extracted/5898221/cropping_pipeline.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Pipeline of cropping pre-computed anatomical regions in unseen CT images. Step 1: CNN-based segmentation for a fixed set of 19 anatomies is performed. Step 2: image registration is performed to align the segmentations of step 1 (moving image) to the atlas (fixed image). Step 3: the registration transformation is being used to map the anatomical region from the atlas- to the image coordinate system and used for cropping. The segmentations are displayed as colored pseudo X-Ray images where the sum of the binary mask was computed over the x-axis. </figcaption>
</figure>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> CT Anatomical Region Cropping</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<math alttext="im,\&gt;seg_{atlas},\&gt;bb" class="ltx_Math" display="inline" id="alg1.l1.m1.3"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3.3" xref="alg1.l1.m1.3.3.4.cmml"><mrow id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.2.cmml">i</mi><mo id="alg1.l1.m1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l1.m1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.3.cmml">m</mi></mrow><mo id="alg1.l1.m1.3.3.3.4" rspace="0.387em" xref="alg1.l1.m1.3.3.4.cmml">,</mo><mrow id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.cmml"><mi id="alg1.l1.m1.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.cmml">s</mi><mo id="alg1.l1.m1.2.2.2.2.1" xref="alg1.l1.m1.2.2.2.2.1.cmml">⁢</mo><mi id="alg1.l1.m1.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.3.cmml">e</mi><mo id="alg1.l1.m1.2.2.2.2.1a" xref="alg1.l1.m1.2.2.2.2.1.cmml">⁢</mo><msub id="alg1.l1.m1.2.2.2.2.4" xref="alg1.l1.m1.2.2.2.2.4.cmml"><mi id="alg1.l1.m1.2.2.2.2.4.2" xref="alg1.l1.m1.2.2.2.2.4.2.cmml">g</mi><mrow id="alg1.l1.m1.2.2.2.2.4.3" xref="alg1.l1.m1.2.2.2.2.4.3.cmml"><mi id="alg1.l1.m1.2.2.2.2.4.3.2" xref="alg1.l1.m1.2.2.2.2.4.3.2.cmml">a</mi><mo id="alg1.l1.m1.2.2.2.2.4.3.1" xref="alg1.l1.m1.2.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.2.2.2.2.4.3.3" xref="alg1.l1.m1.2.2.2.2.4.3.3.cmml">t</mi><mo id="alg1.l1.m1.2.2.2.2.4.3.1a" xref="alg1.l1.m1.2.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.2.2.2.2.4.3.4" xref="alg1.l1.m1.2.2.2.2.4.3.4.cmml">l</mi><mo id="alg1.l1.m1.2.2.2.2.4.3.1b" xref="alg1.l1.m1.2.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.2.2.2.2.4.3.5" xref="alg1.l1.m1.2.2.2.2.4.3.5.cmml">a</mi><mo id="alg1.l1.m1.2.2.2.2.4.3.1c" xref="alg1.l1.m1.2.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.2.2.2.2.4.3.6" xref="alg1.l1.m1.2.2.2.2.4.3.6.cmml">s</mi></mrow></msub></mrow><mo id="alg1.l1.m1.3.3.3.5" rspace="0.387em" xref="alg1.l1.m1.3.3.4.cmml">,</mo><mrow id="alg1.l1.m1.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.cmml"><mi id="alg1.l1.m1.3.3.3.3.2" xref="alg1.l1.m1.3.3.3.3.2.cmml">b</mi><mo id="alg1.l1.m1.3.3.3.3.1" xref="alg1.l1.m1.3.3.3.3.1.cmml">⁢</mo><mi id="alg1.l1.m1.3.3.3.3.3" xref="alg1.l1.m1.3.3.3.3.3.cmml">b</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><list id="alg1.l1.m1.3.3.4.cmml" xref="alg1.l1.m1.3.3.3"><apply id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1"><times id="alg1.l1.m1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1"></times><ci id="alg1.l1.m1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.2">𝑖</ci><ci id="alg1.l1.m1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.3">𝑚</ci></apply><apply id="alg1.l1.m1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2"><times id="alg1.l1.m1.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.1"></times><ci id="alg1.l1.m1.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2">𝑠</ci><ci id="alg1.l1.m1.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.3">𝑒</ci><apply id="alg1.l1.m1.2.2.2.2.4.cmml" xref="alg1.l1.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.2.2.4.1.cmml" xref="alg1.l1.m1.2.2.2.2.4">subscript</csymbol><ci id="alg1.l1.m1.2.2.2.2.4.2.cmml" xref="alg1.l1.m1.2.2.2.2.4.2">𝑔</ci><apply id="alg1.l1.m1.2.2.2.2.4.3.cmml" xref="alg1.l1.m1.2.2.2.2.4.3"><times id="alg1.l1.m1.2.2.2.2.4.3.1.cmml" xref="alg1.l1.m1.2.2.2.2.4.3.1"></times><ci id="alg1.l1.m1.2.2.2.2.4.3.2.cmml" xref="alg1.l1.m1.2.2.2.2.4.3.2">𝑎</ci><ci id="alg1.l1.m1.2.2.2.2.4.3.3.cmml" xref="alg1.l1.m1.2.2.2.2.4.3.3">𝑡</ci><ci id="alg1.l1.m1.2.2.2.2.4.3.4.cmml" xref="alg1.l1.m1.2.2.2.2.4.3.4">𝑙</ci><ci id="alg1.l1.m1.2.2.2.2.4.3.5.cmml" xref="alg1.l1.m1.2.2.2.2.4.3.5">𝑎</ci><ci id="alg1.l1.m1.2.2.2.2.4.3.6.cmml" xref="alg1.l1.m1.2.2.2.2.4.3.6">𝑠</ci></apply></apply></apply><apply id="alg1.l1.m1.3.3.3.3.cmml" xref="alg1.l1.m1.3.3.3.3"><times id="alg1.l1.m1.3.3.3.3.1.cmml" xref="alg1.l1.m1.3.3.3.3.1"></times><ci id="alg1.l1.m1.3.3.3.3.2.cmml" xref="alg1.l1.m1.3.3.3.3.2">𝑏</ci><ci id="alg1.l1.m1.3.3.3.3.3.cmml" xref="alg1.l1.m1.3.3.3.3.3">𝑏</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">im,\&gt;seg_{atlas},\&gt;bb</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">italic_i italic_m , italic_s italic_e italic_g start_POSTSUBSCRIPT italic_a italic_t italic_l italic_a italic_s end_POSTSUBSCRIPT , italic_b italic_b</annotation></semantics></math> <span class="ltx_text" id="alg1.l1.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l1.1.m1.1"><semantics id="alg1.l1.1.m1.1a"><mo id="alg1.l1.1.m1.1.1" xref="alg1.l1.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l1.1.m1.1b"><ci id="alg1.l1.1.m1.1.1.cmml" xref="alg1.l1.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.1.m1.1d">▷</annotation></semantics></math> CT image, atlas segmentation, bounding box
</span>
</div>
<div class="ltx_listingline" id="alg1.l2">
<math alttext="seg_{im}\leftarrow\text{AnatomySegmentation}(im)" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">e</mi><mo id="alg1.l2.m1.1.1.3.1a" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l2.m1.1.1.3.4" xref="alg1.l2.m1.1.1.3.4.cmml"><mi id="alg1.l2.m1.1.1.3.4.2" xref="alg1.l2.m1.1.1.3.4.2.cmml">g</mi><mrow id="alg1.l2.m1.1.1.3.4.3" xref="alg1.l2.m1.1.1.3.4.3.cmml"><mi id="alg1.l2.m1.1.1.3.4.3.2" xref="alg1.l2.m1.1.1.3.4.3.2.cmml">i</mi><mo id="alg1.l2.m1.1.1.3.4.3.1" xref="alg1.l2.m1.1.1.3.4.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.4.3.3" xref="alg1.l2.m1.1.1.3.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l2.m1.1.1.2" stretchy="false" xref="alg1.l2.m1.1.1.2.cmml">←</mo><mrow id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml"><mtext id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.1.1.1.3a.cmml">AnatomySegmentation</mtext><mo id="alg1.l2.m1.1.1.1.2" xref="alg1.l2.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l2.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l2.m1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg1.l2.m1.1.1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="alg1.l2.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">←</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><times id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></times><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝑠</ci><ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">𝑒</ci><apply id="alg1.l2.m1.1.1.3.4.cmml" xref="alg1.l2.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.4.1.cmml" xref="alg1.l2.m1.1.1.3.4">subscript</csymbol><ci id="alg1.l2.m1.1.1.3.4.2.cmml" xref="alg1.l2.m1.1.1.3.4.2">𝑔</ci><apply id="alg1.l2.m1.1.1.3.4.3.cmml" xref="alg1.l2.m1.1.1.3.4.3"><times id="alg1.l2.m1.1.1.3.4.3.1.cmml" xref="alg1.l2.m1.1.1.3.4.3.1"></times><ci id="alg1.l2.m1.1.1.3.4.3.2.cmml" xref="alg1.l2.m1.1.1.3.4.3.2">𝑖</ci><ci id="alg1.l2.m1.1.1.3.4.3.3.cmml" xref="alg1.l2.m1.1.1.3.4.3.3">𝑚</ci></apply></apply></apply><apply id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"><times id="alg1.l2.m1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.2"></times><ci id="alg1.l2.m1.1.1.1.3a.cmml" xref="alg1.l2.m1.1.1.1.3"><mtext id="alg1.l2.m1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.3">AnatomySegmentation</mtext></ci><apply id="alg1.l2.m1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1"><times id="alg1.l2.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l2.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.2">𝑖</ci><ci id="alg1.l2.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">seg_{im}\leftarrow\text{AnatomySegmentation}(im)</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT ← AnatomySegmentation ( italic_i italic_m )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<math alttext="x\leftarrow\text{CenterOfMass}(seg_{im})" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">x</mi><mo id="alg1.l3.m1.1.1.2" stretchy="false" xref="alg1.l3.m1.1.1.2.cmml">←</mo><mrow id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml"><mtext id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.1.1.3a.cmml">CenterOfMass</mtext><mo id="alg1.l3.m1.1.1.1.2" xref="alg1.l3.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l3.m1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l3.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l3.m1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.1.1.2.cmml">s</mi><mo id="alg1.l3.m1.1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.1.3.cmml">e</mi><mo id="alg1.l3.m1.1.1.1.1.1.1.1a" xref="alg1.l3.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg1.l3.m1.1.1.1.1.1.1.4" xref="alg1.l3.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.1.4.2" xref="alg1.l3.m1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="alg1.l3.m1.1.1.1.1.1.1.4.3" xref="alg1.l3.m1.1.1.1.1.1.1.4.3.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.1.4.3.2" xref="alg1.l3.m1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="alg1.l3.m1.1.1.1.1.1.1.4.3.1" xref="alg1.l3.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l3.m1.1.1.1.1.1.1.4.3.3" xref="alg1.l3.m1.1.1.1.1.1.1.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l3.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">←</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑥</ci><apply id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"><times id="alg1.l3.m1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.2"></times><ci id="alg1.l3.m1.1.1.1.3a.cmml" xref="alg1.l3.m1.1.1.1.3"><mtext id="alg1.l3.m1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.3">CenterOfMass</mtext></ci><apply id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1"><times id="alg1.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l3.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.3">𝑒</ci><apply id="alg1.l3.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.4.2">𝑔</ci><apply id="alg1.l3.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.4.3"><times id="alg1.l3.m1.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.4.3.1"></times><ci id="alg1.l3.m1.1.1.1.1.1.1.4.3.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="alg1.l3.m1.1.1.1.1.1.1.4.3.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.4.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">x\leftarrow\text{CenterOfMass}(seg_{im})</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">italic_x ← CenterOfMass ( italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l3.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l3.1.m1.1"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.1.m1.1d">▷</annotation></semantics></math> Landmarks moving image
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<math alttext="y\leftarrow\text{CenterOfMass}(seg_{atlas})" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">y</mi><mo id="alg1.l4.m1.1.1.2" stretchy="false" xref="alg1.l4.m1.1.1.2.cmml">←</mo><mrow id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml"><mtext id="alg1.l4.m1.1.1.1.3" xref="alg1.l4.m1.1.1.1.3a.cmml">CenterOfMass</mtext><mo id="alg1.l4.m1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l4.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.2.cmml">s</mi><mo id="alg1.l4.m1.1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml">e</mi><mo id="alg1.l4.m1.1.1.1.1.1.1.1a" xref="alg1.l4.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg1.l4.m1.1.1.1.1.1.1.4" xref="alg1.l4.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.4.2" xref="alg1.l4.m1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="alg1.l4.m1.1.1.1.1.1.1.4.3" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.4.3.2" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.2.cmml">a</mi><mo id="alg1.l4.m1.1.1.1.1.1.1.4.3.1" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.1.1.1.1.4.3.3" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.3.cmml">t</mi><mo id="alg1.l4.m1.1.1.1.1.1.1.4.3.1a" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.1.1.1.1.4.3.4" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.4.cmml">l</mi><mo id="alg1.l4.m1.1.1.1.1.1.1.4.3.1b" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.1.1.1.1.4.3.5" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.5.cmml">a</mi><mo id="alg1.l4.m1.1.1.1.1.1.1.4.3.1c" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l4.m1.1.1.1.1.1.1.4.3.6" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.6.cmml">s</mi></mrow></msub></mrow><mo id="alg1.l4.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">←</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑦</ci><apply id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"><times id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.2"></times><ci id="alg1.l4.m1.1.1.1.3a.cmml" xref="alg1.l4.m1.1.1.1.3"><mtext id="alg1.l4.m1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.3">CenterOfMass</mtext></ci><apply id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1"><times id="alg1.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3">𝑒</ci><apply id="alg1.l4.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4.2">𝑔</ci><apply id="alg1.l4.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4.3"><times id="alg1.l4.m1.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.1"></times><ci id="alg1.l4.m1.1.1.1.1.1.1.4.3.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.2">𝑎</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.4.3.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.3">𝑡</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.4.3.4.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.4">𝑙</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.4.3.5.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.5">𝑎</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.4.3.6.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.4.3.6">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">y\leftarrow\text{CenterOfMass}(seg_{atlas})</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_y ← CenterOfMass ( italic_s italic_e italic_g start_POSTSUBSCRIPT italic_a italic_t italic_l italic_a italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l4.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l4.1.m1.1"><semantics id="alg1.l4.1.m1.1a"><mo id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.1.m1.1d">▷</annotation></semantics></math> Landmarks fixed image
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<math alttext="\tilde{w}\leftarrow\text{sum}(seg_{im},(1,2,3))/\text{sum}(seg_{atlas},(1,2,3))" class="ltx_Math" display="inline" id="alg1.l5.m1.10"><semantics id="alg1.l5.m1.10a"><mrow id="alg1.l5.m1.10.10" xref="alg1.l5.m1.10.10.cmml"><mover accent="true" id="alg1.l5.m1.10.10.6" xref="alg1.l5.m1.10.10.6.cmml"><mi id="alg1.l5.m1.10.10.6.2" xref="alg1.l5.m1.10.10.6.2.cmml">w</mi><mo id="alg1.l5.m1.10.10.6.1" xref="alg1.l5.m1.10.10.6.1.cmml">~</mo></mover><mo id="alg1.l5.m1.10.10.5" stretchy="false" xref="alg1.l5.m1.10.10.5.cmml">←</mo><mrow id="alg1.l5.m1.10.10.4" xref="alg1.l5.m1.10.10.4.cmml"><mrow id="alg1.l5.m1.8.8.2.2" xref="alg1.l5.m1.8.8.2.2.cmml"><mrow id="alg1.l5.m1.8.8.2.2.2" xref="alg1.l5.m1.8.8.2.2.2.cmml"><mtext id="alg1.l5.m1.8.8.2.2.2.4" xref="alg1.l5.m1.8.8.2.2.2.4a.cmml">sum</mtext><mo id="alg1.l5.m1.8.8.2.2.2.3" xref="alg1.l5.m1.8.8.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l5.m1.8.8.2.2.2.2.2" xref="alg1.l5.m1.8.8.2.2.2.2.3.cmml"><mo id="alg1.l5.m1.8.8.2.2.2.2.2.3" stretchy="false" xref="alg1.l5.m1.8.8.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l5.m1.7.7.1.1.1.1.1.1" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.7.7.1.1.1.1.1.1.2" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.2.cmml">s</mi><mo id="alg1.l5.m1.7.7.1.1.1.1.1.1.1" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.7.7.1.1.1.1.1.1.3" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.3.cmml">e</mi><mo id="alg1.l5.m1.7.7.1.1.1.1.1.1.1a" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg1.l5.m1.7.7.1.1.1.1.1.1.4" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.cmml"><mi id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.2" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.cmml"><mi id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.2" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.1" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.3" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l5.m1.8.8.2.2.2.2.2.4" xref="alg1.l5.m1.8.8.2.2.2.2.3.cmml">,</mo><mrow id="alg1.l5.m1.8.8.2.2.2.2.2.2.2" xref="alg1.l5.m1.8.8.2.2.2.2.2.2.1.cmml"><mo id="alg1.l5.m1.8.8.2.2.2.2.2.2.2.1" stretchy="false" xref="alg1.l5.m1.8.8.2.2.2.2.2.2.1.cmml">(</mo><mn id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">1</mn><mo id="alg1.l5.m1.8.8.2.2.2.2.2.2.2.2" xref="alg1.l5.m1.8.8.2.2.2.2.2.2.1.cmml">,</mo><mn id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">2</mn><mo id="alg1.l5.m1.8.8.2.2.2.2.2.2.2.3" xref="alg1.l5.m1.8.8.2.2.2.2.2.2.1.cmml">,</mo><mn id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">3</mn><mo id="alg1.l5.m1.8.8.2.2.2.2.2.2.2.4" stretchy="false" xref="alg1.l5.m1.8.8.2.2.2.2.2.2.1.cmml">)</mo></mrow><mo id="alg1.l5.m1.8.8.2.2.2.2.2.5" stretchy="false" xref="alg1.l5.m1.8.8.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l5.m1.8.8.2.2.3" xref="alg1.l5.m1.8.8.2.2.3.cmml">/</mo><mtext id="alg1.l5.m1.8.8.2.2.4" xref="alg1.l5.m1.8.8.2.2.4a.cmml">sum</mtext></mrow><mo id="alg1.l5.m1.10.10.4.5" xref="alg1.l5.m1.10.10.4.5.cmml">⁢</mo><mrow id="alg1.l5.m1.10.10.4.4.2" xref="alg1.l5.m1.10.10.4.4.3.cmml"><mo id="alg1.l5.m1.10.10.4.4.2.3" stretchy="false" xref="alg1.l5.m1.10.10.4.4.3.cmml">(</mo><mrow id="alg1.l5.m1.9.9.3.3.1.1" xref="alg1.l5.m1.9.9.3.3.1.1.cmml"><mi id="alg1.l5.m1.9.9.3.3.1.1.2" xref="alg1.l5.m1.9.9.3.3.1.1.2.cmml">s</mi><mo id="alg1.l5.m1.9.9.3.3.1.1.1" xref="alg1.l5.m1.9.9.3.3.1.1.1.cmml">⁢</mo><mi id="alg1.l5.m1.9.9.3.3.1.1.3" xref="alg1.l5.m1.9.9.3.3.1.1.3.cmml">e</mi><mo id="alg1.l5.m1.9.9.3.3.1.1.1a" xref="alg1.l5.m1.9.9.3.3.1.1.1.cmml">⁢</mo><msub id="alg1.l5.m1.9.9.3.3.1.1.4" xref="alg1.l5.m1.9.9.3.3.1.1.4.cmml"><mi id="alg1.l5.m1.9.9.3.3.1.1.4.2" xref="alg1.l5.m1.9.9.3.3.1.1.4.2.cmml">g</mi><mrow id="alg1.l5.m1.9.9.3.3.1.1.4.3" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.cmml"><mi id="alg1.l5.m1.9.9.3.3.1.1.4.3.2" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.2.cmml">a</mi><mo id="alg1.l5.m1.9.9.3.3.1.1.4.3.1" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.9.9.3.3.1.1.4.3.3" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.3.cmml">t</mi><mo id="alg1.l5.m1.9.9.3.3.1.1.4.3.1a" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.9.9.3.3.1.1.4.3.4" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.4.cmml">l</mi><mo id="alg1.l5.m1.9.9.3.3.1.1.4.3.1b" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.9.9.3.3.1.1.4.3.5" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.5.cmml">a</mi><mo id="alg1.l5.m1.9.9.3.3.1.1.4.3.1c" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.9.9.3.3.1.1.4.3.6" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.6.cmml">s</mi></mrow></msub></mrow><mo id="alg1.l5.m1.10.10.4.4.2.4" xref="alg1.l5.m1.10.10.4.4.3.cmml">,</mo><mrow id="alg1.l5.m1.10.10.4.4.2.2.2" xref="alg1.l5.m1.10.10.4.4.2.2.1.cmml"><mo id="alg1.l5.m1.10.10.4.4.2.2.2.1" stretchy="false" xref="alg1.l5.m1.10.10.4.4.2.2.1.cmml">(</mo><mn id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml">1</mn><mo id="alg1.l5.m1.10.10.4.4.2.2.2.2" xref="alg1.l5.m1.10.10.4.4.2.2.1.cmml">,</mo><mn id="alg1.l5.m1.5.5" xref="alg1.l5.m1.5.5.cmml">2</mn><mo id="alg1.l5.m1.10.10.4.4.2.2.2.3" xref="alg1.l5.m1.10.10.4.4.2.2.1.cmml">,</mo><mn id="alg1.l5.m1.6.6" xref="alg1.l5.m1.6.6.cmml">3</mn><mo id="alg1.l5.m1.10.10.4.4.2.2.2.4" stretchy="false" xref="alg1.l5.m1.10.10.4.4.2.2.1.cmml">)</mo></mrow><mo id="alg1.l5.m1.10.10.4.4.2.5" stretchy="false" xref="alg1.l5.m1.10.10.4.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.10b"><apply id="alg1.l5.m1.10.10.cmml" xref="alg1.l5.m1.10.10"><ci id="alg1.l5.m1.10.10.5.cmml" xref="alg1.l5.m1.10.10.5">←</ci><apply id="alg1.l5.m1.10.10.6.cmml" xref="alg1.l5.m1.10.10.6"><ci id="alg1.l5.m1.10.10.6.1.cmml" xref="alg1.l5.m1.10.10.6.1">~</ci><ci id="alg1.l5.m1.10.10.6.2.cmml" xref="alg1.l5.m1.10.10.6.2">𝑤</ci></apply><apply id="alg1.l5.m1.10.10.4.cmml" xref="alg1.l5.m1.10.10.4"><times id="alg1.l5.m1.10.10.4.5.cmml" xref="alg1.l5.m1.10.10.4.5"></times><apply id="alg1.l5.m1.8.8.2.2.cmml" xref="alg1.l5.m1.8.8.2.2"><divide id="alg1.l5.m1.8.8.2.2.3.cmml" xref="alg1.l5.m1.8.8.2.2.3"></divide><apply id="alg1.l5.m1.8.8.2.2.2.cmml" xref="alg1.l5.m1.8.8.2.2.2"><times id="alg1.l5.m1.8.8.2.2.2.3.cmml" xref="alg1.l5.m1.8.8.2.2.2.3"></times><ci id="alg1.l5.m1.8.8.2.2.2.4a.cmml" xref="alg1.l5.m1.8.8.2.2.2.4"><mtext id="alg1.l5.m1.8.8.2.2.2.4.cmml" xref="alg1.l5.m1.8.8.2.2.2.4">sum</mtext></ci><interval closure="open" id="alg1.l5.m1.8.8.2.2.2.2.3.cmml" xref="alg1.l5.m1.8.8.2.2.2.2.2"><apply id="alg1.l5.m1.7.7.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1"><times id="alg1.l5.m1.7.7.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.1"></times><ci id="alg1.l5.m1.7.7.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l5.m1.7.7.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.3">𝑒</ci><apply id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.1.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.2.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.2">𝑔</ci><apply id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3"><times id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.1"></times><ci id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.2.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.3.cmml" xref="alg1.l5.m1.7.7.1.1.1.1.1.1.4.3.3">𝑚</ci></apply></apply></apply><vector id="alg1.l5.m1.8.8.2.2.2.2.2.2.1.cmml" xref="alg1.l5.m1.8.8.2.2.2.2.2.2.2"><cn id="alg1.l5.m1.1.1.cmml" type="integer" xref="alg1.l5.m1.1.1">1</cn><cn id="alg1.l5.m1.2.2.cmml" type="integer" xref="alg1.l5.m1.2.2">2</cn><cn id="alg1.l5.m1.3.3.cmml" type="integer" xref="alg1.l5.m1.3.3">3</cn></vector></interval></apply><ci id="alg1.l5.m1.8.8.2.2.4a.cmml" xref="alg1.l5.m1.8.8.2.2.4"><mtext id="alg1.l5.m1.8.8.2.2.4.cmml" xref="alg1.l5.m1.8.8.2.2.4">sum</mtext></ci></apply><interval closure="open" id="alg1.l5.m1.10.10.4.4.3.cmml" xref="alg1.l5.m1.10.10.4.4.2"><apply id="alg1.l5.m1.9.9.3.3.1.1.cmml" xref="alg1.l5.m1.9.9.3.3.1.1"><times id="alg1.l5.m1.9.9.3.3.1.1.1.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.1"></times><ci id="alg1.l5.m1.9.9.3.3.1.1.2.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.2">𝑠</ci><ci id="alg1.l5.m1.9.9.3.3.1.1.3.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.3">𝑒</ci><apply id="alg1.l5.m1.9.9.3.3.1.1.4.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4"><csymbol cd="ambiguous" id="alg1.l5.m1.9.9.3.3.1.1.4.1.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4">subscript</csymbol><ci id="alg1.l5.m1.9.9.3.3.1.1.4.2.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4.2">𝑔</ci><apply id="alg1.l5.m1.9.9.3.3.1.1.4.3.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4.3"><times id="alg1.l5.m1.9.9.3.3.1.1.4.3.1.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.1"></times><ci id="alg1.l5.m1.9.9.3.3.1.1.4.3.2.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.2">𝑎</ci><ci id="alg1.l5.m1.9.9.3.3.1.1.4.3.3.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.3">𝑡</ci><ci id="alg1.l5.m1.9.9.3.3.1.1.4.3.4.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.4">𝑙</ci><ci id="alg1.l5.m1.9.9.3.3.1.1.4.3.5.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.5">𝑎</ci><ci id="alg1.l5.m1.9.9.3.3.1.1.4.3.6.cmml" xref="alg1.l5.m1.9.9.3.3.1.1.4.3.6">𝑠</ci></apply></apply></apply><vector id="alg1.l5.m1.10.10.4.4.2.2.1.cmml" xref="alg1.l5.m1.10.10.4.4.2.2.2"><cn id="alg1.l5.m1.4.4.cmml" type="integer" xref="alg1.l5.m1.4.4">1</cn><cn id="alg1.l5.m1.5.5.cmml" type="integer" xref="alg1.l5.m1.5.5">2</cn><cn id="alg1.l5.m1.6.6.cmml" type="integer" xref="alg1.l5.m1.6.6">3</cn></vector></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.10c">\tilde{w}\leftarrow\text{sum}(seg_{im},(1,2,3))/\text{sum}(seg_{atlas},(1,2,3))</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.10d">over~ start_ARG italic_w end_ARG ← sum ( italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT , ( 1 , 2 , 3 ) ) / sum ( italic_s italic_e italic_g start_POSTSUBSCRIPT italic_a italic_t italic_l italic_a italic_s end_POSTSUBSCRIPT , ( 1 , 2 , 3 ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<math alttext="w\leftarrow\tilde{w}/sum(\tilde{w})" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.2" xref="alg1.l6.m1.1.2.cmml"><mi id="alg1.l6.m1.1.2.2" xref="alg1.l6.m1.1.2.2.cmml">w</mi><mo id="alg1.l6.m1.1.2.1" stretchy="false" xref="alg1.l6.m1.1.2.1.cmml">←</mo><mrow id="alg1.l6.m1.1.2.3" xref="alg1.l6.m1.1.2.3.cmml"><mrow id="alg1.l6.m1.1.2.3.2" xref="alg1.l6.m1.1.2.3.2.cmml"><mover accent="true" id="alg1.l6.m1.1.2.3.2.2" xref="alg1.l6.m1.1.2.3.2.2.cmml"><mi id="alg1.l6.m1.1.2.3.2.2.2" xref="alg1.l6.m1.1.2.3.2.2.2.cmml">w</mi><mo id="alg1.l6.m1.1.2.3.2.2.1" xref="alg1.l6.m1.1.2.3.2.2.1.cmml">~</mo></mover><mo id="alg1.l6.m1.1.2.3.2.1" xref="alg1.l6.m1.1.2.3.2.1.cmml">/</mo><mi id="alg1.l6.m1.1.2.3.2.3" xref="alg1.l6.m1.1.2.3.2.3.cmml">s</mi></mrow><mo id="alg1.l6.m1.1.2.3.1" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.3" xref="alg1.l6.m1.1.2.3.3.cmml">u</mi><mo id="alg1.l6.m1.1.2.3.1a" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.1.2.3.4" xref="alg1.l6.m1.1.2.3.4.cmml">m</mi><mo id="alg1.l6.m1.1.2.3.1b" xref="alg1.l6.m1.1.2.3.1.cmml">⁢</mo><mrow id="alg1.l6.m1.1.2.3.5.2" xref="alg1.l6.m1.1.1.cmml"><mo id="alg1.l6.m1.1.2.3.5.2.1" stretchy="false" xref="alg1.l6.m1.1.1.cmml">(</mo><mover accent="true" id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">w</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">~</mo></mover><mo id="alg1.l6.m1.1.2.3.5.2.2" stretchy="false" xref="alg1.l6.m1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.2.cmml" xref="alg1.l6.m1.1.2"><ci id="alg1.l6.m1.1.2.1.cmml" xref="alg1.l6.m1.1.2.1">←</ci><ci id="alg1.l6.m1.1.2.2.cmml" xref="alg1.l6.m1.1.2.2">𝑤</ci><apply id="alg1.l6.m1.1.2.3.cmml" xref="alg1.l6.m1.1.2.3"><times id="alg1.l6.m1.1.2.3.1.cmml" xref="alg1.l6.m1.1.2.3.1"></times><apply id="alg1.l6.m1.1.2.3.2.cmml" xref="alg1.l6.m1.1.2.3.2"><divide id="alg1.l6.m1.1.2.3.2.1.cmml" xref="alg1.l6.m1.1.2.3.2.1"></divide><apply id="alg1.l6.m1.1.2.3.2.2.cmml" xref="alg1.l6.m1.1.2.3.2.2"><ci id="alg1.l6.m1.1.2.3.2.2.1.cmml" xref="alg1.l6.m1.1.2.3.2.2.1">~</ci><ci id="alg1.l6.m1.1.2.3.2.2.2.cmml" xref="alg1.l6.m1.1.2.3.2.2.2">𝑤</ci></apply><ci id="alg1.l6.m1.1.2.3.2.3.cmml" xref="alg1.l6.m1.1.2.3.2.3">𝑠</ci></apply><ci id="alg1.l6.m1.1.2.3.3.cmml" xref="alg1.l6.m1.1.2.3.3">𝑢</ci><ci id="alg1.l6.m1.1.2.3.4.cmml" xref="alg1.l6.m1.1.2.3.4">𝑚</ci><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.2.3.5.2"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">~</ci><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">w\leftarrow\tilde{w}/sum(\tilde{w})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_w ← over~ start_ARG italic_w end_ARG / italic_s italic_u italic_m ( over~ start_ARG italic_w end_ARG )</annotation></semantics></math> <span class="ltx_text" id="alg1.l6.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> MSE Weight
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<math alttext="t_{0},\&gt;k_{rot},\&gt;f_{z}\leftarrow\text{LeastSquares}(x,\&gt;,y\&gt;,w)" class="ltx_math_unparsed" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1b"><msub id="alg1.l7.m1.1.1"><mi id="alg1.l7.m1.1.1.2">t</mi><mn id="alg1.l7.m1.1.1.3">0</mn></msub><mo id="alg1.l7.m1.1.2" rspace="0.387em">,</mo><msub id="alg1.l7.m1.1.3"><mi id="alg1.l7.m1.1.3.2">k</mi><mrow id="alg1.l7.m1.1.3.3"><mi id="alg1.l7.m1.1.3.3.2">r</mi><mo id="alg1.l7.m1.1.3.3.1">⁢</mo><mi id="alg1.l7.m1.1.3.3.3">o</mi><mo id="alg1.l7.m1.1.3.3.1a">⁢</mo><mi id="alg1.l7.m1.1.3.3.4">t</mi></mrow></msub><mo id="alg1.l7.m1.1.4" rspace="0.387em">,</mo><msub id="alg1.l7.m1.1.5"><mi id="alg1.l7.m1.1.5.2">f</mi><mi id="alg1.l7.m1.1.5.3">z</mi></msub><mo id="alg1.l7.m1.1.6" stretchy="false">←</mo><mtext id="alg1.l7.m1.1.7">LeastSquares</mtext><mrow id="alg1.l7.m1.1.8"><mo id="alg1.l7.m1.1.8.1" stretchy="false">(</mo><mi id="alg1.l7.m1.1.8.2">x</mi><mo id="alg1.l7.m1.1.8.3" rspace="0.387em">,</mo><mo id="alg1.l7.m1.1.8.4">,</mo><mi id="alg1.l7.m1.1.8.5">y</mi><mo id="alg1.l7.m1.1.8.6" lspace="0.220em">,</mo><mi id="alg1.l7.m1.1.8.7">w</mi><mo id="alg1.l7.m1.1.8.8" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">t_{0},\&gt;k_{rot},\&gt;f_{z}\leftarrow\text{LeastSquares}(x,\&gt;,y\&gt;,w)</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_k start_POSTSUBSCRIPT italic_r italic_o italic_t end_POSTSUBSCRIPT , italic_f start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ← LeastSquares ( italic_x , , italic_y , italic_w )</annotation></semantics></math> <span class="ltx_text" id="alg1.l7.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l7.1.m1.1"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.1.m1.1d">▷</annotation></semantics></math> Orientation and initial translation
</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_text ltx_font_bold" id="alg1.l8.1">if</span> <math alttext="k_{rot}&gt;0" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">k</mi><mrow id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.2.3.2" xref="alg1.l8.m1.1.1.2.3.2.cmml">r</mi><mo id="alg1.l8.m1.1.1.2.3.1" xref="alg1.l8.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.3.3" xref="alg1.l8.m1.1.1.2.3.3.cmml">o</mi><mo id="alg1.l8.m1.1.1.2.3.1a" xref="alg1.l8.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l8.m1.1.1.2.3.4" xref="alg1.l8.m1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">&gt;</mo><mn id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><gt id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></gt><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝑘</ci><apply id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3"><times id="alg1.l8.m1.1.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.2.3.1"></times><ci id="alg1.l8.m1.1.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.2.3.2">𝑟</ci><ci id="alg1.l8.m1.1.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.2.3.3">𝑜</ci><ci id="alg1.l8.m1.1.1.2.3.4.cmml" xref="alg1.l8.m1.1.1.2.3.4">𝑡</ci></apply></apply><cn id="alg1.l8.m1.1.1.3.cmml" type="integer" xref="alg1.l8.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">k_{rot}&gt;0</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_k start_POSTSUBSCRIPT italic_r italic_o italic_t end_POSTSUBSCRIPT &gt; 0</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l9">     <math alttext="seg_{im}\leftarrow\text{Rotate90}(seg_{im},k_{rot})" class="ltx_Math" display="inline" id="alg1.l9.m1.2"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><mrow id="alg1.l9.m1.2.2.4" xref="alg1.l9.m1.2.2.4.cmml"><mi id="alg1.l9.m1.2.2.4.2" xref="alg1.l9.m1.2.2.4.2.cmml">s</mi><mo id="alg1.l9.m1.2.2.4.1" xref="alg1.l9.m1.2.2.4.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.4.3" xref="alg1.l9.m1.2.2.4.3.cmml">e</mi><mo id="alg1.l9.m1.2.2.4.1a" xref="alg1.l9.m1.2.2.4.1.cmml">⁢</mo><msub id="alg1.l9.m1.2.2.4.4" xref="alg1.l9.m1.2.2.4.4.cmml"><mi id="alg1.l9.m1.2.2.4.4.2" xref="alg1.l9.m1.2.2.4.4.2.cmml">g</mi><mrow id="alg1.l9.m1.2.2.4.4.3" xref="alg1.l9.m1.2.2.4.4.3.cmml"><mi id="alg1.l9.m1.2.2.4.4.3.2" xref="alg1.l9.m1.2.2.4.4.3.2.cmml">i</mi><mo id="alg1.l9.m1.2.2.4.4.3.1" xref="alg1.l9.m1.2.2.4.4.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.4.4.3.3" xref="alg1.l9.m1.2.2.4.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l9.m1.2.2.3" stretchy="false" xref="alg1.l9.m1.2.2.3.cmml">←</mo><mrow id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.2.cmml"><mtext id="alg1.l9.m1.2.2.2.4" xref="alg1.l9.m1.2.2.2.4a.cmml">Rotate90</mtext><mo id="alg1.l9.m1.2.2.2.3" xref="alg1.l9.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.3.cmml"><mo id="alg1.l9.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l9.m1.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml">s</mi><mo id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml">e</mi><mo id="alg1.l9.m1.1.1.1.1.1.1.1a" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg1.l9.m1.1.1.1.1.1.1.4" xref="alg1.l9.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.4.2" xref="alg1.l9.m1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="alg1.l9.m1.1.1.1.1.1.1.4.3" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.4.3.2" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="alg1.l9.m1.1.1.1.1.1.1.4.3.1" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.1.1.1.1.4.3.3" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l9.m1.2.2.2.2.2.4" xref="alg1.l9.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l9.m1.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.cmml">k</mi><mrow id="alg1.l9.m1.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2.3.2" xref="alg1.l9.m1.2.2.2.2.2.2.3.2.cmml">r</mi><mo id="alg1.l9.m1.2.2.2.2.2.2.3.1" xref="alg1.l9.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.2.2.3.3" xref="alg1.l9.m1.2.2.2.2.2.2.3.3.cmml">o</mi><mo id="alg1.l9.m1.2.2.2.2.2.2.3.1a" xref="alg1.l9.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.2.2.2.2.2.2.3.4" xref="alg1.l9.m1.2.2.2.2.2.2.3.4.cmml">t</mi></mrow></msub><mo id="alg1.l9.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l9.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><ci id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3">←</ci><apply id="alg1.l9.m1.2.2.4.cmml" xref="alg1.l9.m1.2.2.4"><times id="alg1.l9.m1.2.2.4.1.cmml" xref="alg1.l9.m1.2.2.4.1"></times><ci id="alg1.l9.m1.2.2.4.2.cmml" xref="alg1.l9.m1.2.2.4.2">𝑠</ci><ci id="alg1.l9.m1.2.2.4.3.cmml" xref="alg1.l9.m1.2.2.4.3">𝑒</ci><apply id="alg1.l9.m1.2.2.4.4.cmml" xref="alg1.l9.m1.2.2.4.4"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.4.4.1.cmml" xref="alg1.l9.m1.2.2.4.4">subscript</csymbol><ci id="alg1.l9.m1.2.2.4.4.2.cmml" xref="alg1.l9.m1.2.2.4.4.2">𝑔</ci><apply id="alg1.l9.m1.2.2.4.4.3.cmml" xref="alg1.l9.m1.2.2.4.4.3"><times id="alg1.l9.m1.2.2.4.4.3.1.cmml" xref="alg1.l9.m1.2.2.4.4.3.1"></times><ci id="alg1.l9.m1.2.2.4.4.3.2.cmml" xref="alg1.l9.m1.2.2.4.4.3.2">𝑖</ci><ci id="alg1.l9.m1.2.2.4.4.3.3.cmml" xref="alg1.l9.m1.2.2.4.4.3.3">𝑚</ci></apply></apply></apply><apply id="alg1.l9.m1.2.2.2.cmml" xref="alg1.l9.m1.2.2.2"><times id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.3"></times><ci id="alg1.l9.m1.2.2.2.4a.cmml" xref="alg1.l9.m1.2.2.2.4"><mtext id="alg1.l9.m1.2.2.2.4.cmml" xref="alg1.l9.m1.2.2.2.4">Rotate90</mtext></ci><interval closure="open" id="alg1.l9.m1.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"><times id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3">𝑒</ci><apply id="alg1.l9.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.2">𝑔</ci><apply id="alg1.l9.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.3"><times id="alg1.l9.m1.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.1"></times><ci id="alg1.l9.m1.1.1.1.1.1.1.4.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.4.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.3.3">𝑚</ci></apply></apply></apply><apply id="alg1.l9.m1.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2">𝑘</ci><apply id="alg1.l9.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3"><times id="alg1.l9.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3.1"></times><ci id="alg1.l9.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3.2">𝑟</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3.3">𝑜</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.3.4.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.3.4">𝑡</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">seg_{im}\leftarrow\text{Rotate90}(seg_{im},k_{rot})</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.2d">italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT ← Rotate90 ( italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT , italic_k start_POSTSUBSCRIPT italic_r italic_o italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l9.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l9.1.m1.1"><semantics id="alg1.l9.1.m1.1a"><mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.1.m1.1d">▷</annotation></semantics></math> xy rotation
</span>
</div>
<div class="ltx_listingline" id="alg1.l10">     <math alttext="im\leftarrow\text{Rotate90}(im,k_{rot})" class="ltx_Math" display="inline" id="alg1.l10.m1.2"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml"><mrow id="alg1.l10.m1.2.2.4" xref="alg1.l10.m1.2.2.4.cmml"><mi id="alg1.l10.m1.2.2.4.2" xref="alg1.l10.m1.2.2.4.2.cmml">i</mi><mo id="alg1.l10.m1.2.2.4.1" xref="alg1.l10.m1.2.2.4.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.4.3" xref="alg1.l10.m1.2.2.4.3.cmml">m</mi></mrow><mo id="alg1.l10.m1.2.2.3" stretchy="false" xref="alg1.l10.m1.2.2.3.cmml">←</mo><mrow id="alg1.l10.m1.2.2.2" xref="alg1.l10.m1.2.2.2.cmml"><mtext id="alg1.l10.m1.2.2.2.4" xref="alg1.l10.m1.2.2.2.4a.cmml">Rotate90</mtext><mo id="alg1.l10.m1.2.2.2.3" xref="alg1.l10.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l10.m1.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.3.cmml"><mo id="alg1.l10.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l10.m1.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l10.m1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg1.l10.m1.1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l10.m1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="alg1.l10.m1.2.2.2.2.2.4" xref="alg1.l10.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l10.m1.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2.2" xref="alg1.l10.m1.2.2.2.2.2.2.2.cmml">k</mi><mrow id="alg1.l10.m1.2.2.2.2.2.2.3" xref="alg1.l10.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l10.m1.2.2.2.2.2.2.3.2" xref="alg1.l10.m1.2.2.2.2.2.2.3.2.cmml">r</mi><mo id="alg1.l10.m1.2.2.2.2.2.2.3.1" xref="alg1.l10.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.2.2.3.3" xref="alg1.l10.m1.2.2.2.2.2.2.3.3.cmml">o</mi><mo id="alg1.l10.m1.2.2.2.2.2.2.3.1a" xref="alg1.l10.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="alg1.l10.m1.2.2.2.2.2.2.3.4" xref="alg1.l10.m1.2.2.2.2.2.2.3.4.cmml">t</mi></mrow></msub><mo id="alg1.l10.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l10.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2"><ci id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2.3">←</ci><apply id="alg1.l10.m1.2.2.4.cmml" xref="alg1.l10.m1.2.2.4"><times id="alg1.l10.m1.2.2.4.1.cmml" xref="alg1.l10.m1.2.2.4.1"></times><ci id="alg1.l10.m1.2.2.4.2.cmml" xref="alg1.l10.m1.2.2.4.2">𝑖</ci><ci id="alg1.l10.m1.2.2.4.3.cmml" xref="alg1.l10.m1.2.2.4.3">𝑚</ci></apply><apply id="alg1.l10.m1.2.2.2.cmml" xref="alg1.l10.m1.2.2.2"><times id="alg1.l10.m1.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.3"></times><ci id="alg1.l10.m1.2.2.2.4a.cmml" xref="alg1.l10.m1.2.2.2.4"><mtext id="alg1.l10.m1.2.2.2.4.cmml" xref="alg1.l10.m1.2.2.2.4">Rotate90</mtext></ci><interval closure="open" id="alg1.l10.m1.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2"><apply id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1"><times id="alg1.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2">𝑖</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="alg1.l10.m1.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.2">𝑘</ci><apply id="alg1.l10.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.3"><times id="alg1.l10.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.3.1"></times><ci id="alg1.l10.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.3.2">𝑟</ci><ci id="alg1.l10.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.3.3">𝑜</ci><ci id="alg1.l10.m1.2.2.2.2.2.2.3.4.cmml" xref="alg1.l10.m1.2.2.2.2.2.2.3.4">𝑡</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">im\leftarrow\text{Rotate90}(im,k_{rot})</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.2d">italic_i italic_m ← Rotate90 ( italic_i italic_m , italic_k start_POSTSUBSCRIPT italic_r italic_o italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_text ltx_font_bold" id="alg1.l11.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l11.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_text ltx_font_bold" id="alg1.l12.1">if</span> <math alttext="f_{z}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">f</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑓</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">f_{z}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_f start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l12.2">then</span>
</div>
<div class="ltx_listingline" id="alg1.l13">     <math alttext="seg_{im}\leftarrow\text{FlipZ}(seg_{im})" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">s</mi><mo id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml">e</mi><mo id="alg1.l13.m1.1.1.3.1a" xref="alg1.l13.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l13.m1.1.1.3.4" xref="alg1.l13.m1.1.1.3.4.cmml"><mi id="alg1.l13.m1.1.1.3.4.2" xref="alg1.l13.m1.1.1.3.4.2.cmml">g</mi><mrow id="alg1.l13.m1.1.1.3.4.3" xref="alg1.l13.m1.1.1.3.4.3.cmml"><mi id="alg1.l13.m1.1.1.3.4.3.2" xref="alg1.l13.m1.1.1.3.4.3.2.cmml">i</mi><mo id="alg1.l13.m1.1.1.3.4.3.1" xref="alg1.l13.m1.1.1.3.4.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.3.4.3.3" xref="alg1.l13.m1.1.1.3.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l13.m1.1.1.2" stretchy="false" xref="alg1.l13.m1.1.1.2.cmml">←</mo><mrow id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml"><mtext id="alg1.l13.m1.1.1.1.3" xref="alg1.l13.m1.1.1.1.3a.cmml">FlipZ</mtext><mo id="alg1.l13.m1.1.1.1.2" xref="alg1.l13.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l13.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.1.2.cmml">s</mi><mo id="alg1.l13.m1.1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.1.3.cmml">e</mi><mo id="alg1.l13.m1.1.1.1.1.1.1.1a" xref="alg1.l13.m1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="alg1.l13.m1.1.1.1.1.1.1.4" xref="alg1.l13.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.4.2" xref="alg1.l13.m1.1.1.1.1.1.1.4.2.cmml">g</mi><mrow id="alg1.l13.m1.1.1.1.1.1.1.4.3" xref="alg1.l13.m1.1.1.1.1.1.1.4.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1.4.3.2" xref="alg1.l13.m1.1.1.1.1.1.1.4.3.2.cmml">i</mi><mo id="alg1.l13.m1.1.1.1.1.1.1.4.3.1" xref="alg1.l13.m1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l13.m1.1.1.1.1.1.1.4.3.3" xref="alg1.l13.m1.1.1.1.1.1.1.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l13.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">←</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><times id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></times><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">𝑠</ci><ci id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3">𝑒</ci><apply id="alg1.l13.m1.1.1.3.4.cmml" xref="alg1.l13.m1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.4.1.cmml" xref="alg1.l13.m1.1.1.3.4">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.4.2.cmml" xref="alg1.l13.m1.1.1.3.4.2">𝑔</ci><apply id="alg1.l13.m1.1.1.3.4.3.cmml" xref="alg1.l13.m1.1.1.3.4.3"><times id="alg1.l13.m1.1.1.3.4.3.1.cmml" xref="alg1.l13.m1.1.1.3.4.3.1"></times><ci id="alg1.l13.m1.1.1.3.4.3.2.cmml" xref="alg1.l13.m1.1.1.3.4.3.2">𝑖</ci><ci id="alg1.l13.m1.1.1.3.4.3.3.cmml" xref="alg1.l13.m1.1.1.3.4.3.3">𝑚</ci></apply></apply></apply><apply id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"><times id="alg1.l13.m1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.2"></times><ci id="alg1.l13.m1.1.1.1.3a.cmml" xref="alg1.l13.m1.1.1.1.3"><mtext id="alg1.l13.m1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.3">FlipZ</mtext></ci><apply id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><times id="alg1.l13.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.2">𝑠</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.3">𝑒</ci><apply id="alg1.l13.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.4.2">𝑔</ci><apply id="alg1.l13.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.4.3"><times id="alg1.l13.m1.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.4.3.1"></times><ci id="alg1.l13.m1.1.1.1.1.1.1.4.3.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.4.3.2">𝑖</ci><ci id="alg1.l13.m1.1.1.1.1.1.1.4.3.3.cmml" xref="alg1.l13.m1.1.1.1.1.1.1.4.3.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">seg_{im}\leftarrow\text{FlipZ}(seg_{im})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT ← FlipZ ( italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l13.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l13.1.m1.1"><semantics id="alg1.l13.1.m1.1a"><mo id="alg1.l13.1.m1.1.1" xref="alg1.l13.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l13.1.m1.1b"><ci id="alg1.l13.1.m1.1.1.cmml" xref="alg1.l13.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.1.m1.1d">▷</annotation></semantics></math> Flipping of z axis
</span>
</div>
<div class="ltx_listingline" id="alg1.l14">     <math alttext="im\leftarrow\text{FlipZ}(im)" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml">m</mi></mrow><mo id="alg1.l14.m1.1.1.2" stretchy="false" xref="alg1.l14.m1.1.1.2.cmml">←</mo><mrow id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml"><mtext id="alg1.l14.m1.1.1.1.3" xref="alg1.l14.m1.1.1.1.3a.cmml">FlipZ</mtext><mo id="alg1.l14.m1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l14.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="alg1.l14.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">←</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><times id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"></times><ci id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">𝑖</ci><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">𝑚</ci></apply><apply id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"><times id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.2"></times><ci id="alg1.l14.m1.1.1.1.3a.cmml" xref="alg1.l14.m1.1.1.1.3"><mtext id="alg1.l14.m1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.3">FlipZ</mtext></ci><apply id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1"><times id="alg1.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2">𝑖</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">im\leftarrow\text{FlipZ}(im)</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_i italic_m ← FlipZ ( italic_i italic_m )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_text ltx_font_bold" id="alg1.l15.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l15.2">if</span>
</div>
<div class="ltx_listingline" id="alg1.l16">
<math alttext="s_{1},\&gt;t_{1}\leftarrow\text{IterativeRegistration}(seg_{im},seg_{atlas},t_{0})" class="ltx_Math" display="inline" id="alg1.l16.m1.5"><semantics id="alg1.l16.m1.5a"><mrow id="alg1.l16.m1.5.5" xref="alg1.l16.m1.5.5.cmml"><mrow id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.3.cmml"><msub id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.2.cmml">s</mi><mn id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l16.m1.2.2.2.2.3" rspace="0.387em" xref="alg1.l16.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l16.m1.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.cmml"><mi id="alg1.l16.m1.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.2.cmml">t</mi><mn id="alg1.l16.m1.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.2.3.cmml">1</mn></msub></mrow><mo id="alg1.l16.m1.5.5.6" stretchy="false" xref="alg1.l16.m1.5.5.6.cmml">←</mo><mrow id="alg1.l16.m1.5.5.5" xref="alg1.l16.m1.5.5.5.cmml"><mtext id="alg1.l16.m1.5.5.5.5" xref="alg1.l16.m1.5.5.5.5a.cmml">IterativeRegistration</mtext><mo id="alg1.l16.m1.5.5.5.4" xref="alg1.l16.m1.5.5.5.4.cmml">⁢</mo><mrow id="alg1.l16.m1.5.5.5.3.3" xref="alg1.l16.m1.5.5.5.3.4.cmml"><mo id="alg1.l16.m1.5.5.5.3.3.4" stretchy="false" xref="alg1.l16.m1.5.5.5.3.4.cmml">(</mo><mrow id="alg1.l16.m1.3.3.3.1.1.1" xref="alg1.l16.m1.3.3.3.1.1.1.cmml"><mi id="alg1.l16.m1.3.3.3.1.1.1.2" xref="alg1.l16.m1.3.3.3.1.1.1.2.cmml">s</mi><mo id="alg1.l16.m1.3.3.3.1.1.1.1" xref="alg1.l16.m1.3.3.3.1.1.1.1.cmml">⁢</mo><mi id="alg1.l16.m1.3.3.3.1.1.1.3" xref="alg1.l16.m1.3.3.3.1.1.1.3.cmml">e</mi><mo id="alg1.l16.m1.3.3.3.1.1.1.1a" xref="alg1.l16.m1.3.3.3.1.1.1.1.cmml">⁢</mo><msub id="alg1.l16.m1.3.3.3.1.1.1.4" xref="alg1.l16.m1.3.3.3.1.1.1.4.cmml"><mi id="alg1.l16.m1.3.3.3.1.1.1.4.2" xref="alg1.l16.m1.3.3.3.1.1.1.4.2.cmml">g</mi><mrow id="alg1.l16.m1.3.3.3.1.1.1.4.3" xref="alg1.l16.m1.3.3.3.1.1.1.4.3.cmml"><mi id="alg1.l16.m1.3.3.3.1.1.1.4.3.2" xref="alg1.l16.m1.3.3.3.1.1.1.4.3.2.cmml">i</mi><mo id="alg1.l16.m1.3.3.3.1.1.1.4.3.1" xref="alg1.l16.m1.3.3.3.1.1.1.4.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.3.3.3.1.1.1.4.3.3" xref="alg1.l16.m1.3.3.3.1.1.1.4.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l16.m1.5.5.5.3.3.5" xref="alg1.l16.m1.5.5.5.3.4.cmml">,</mo><mrow id="alg1.l16.m1.4.4.4.2.2.2" xref="alg1.l16.m1.4.4.4.2.2.2.cmml"><mi id="alg1.l16.m1.4.4.4.2.2.2.2" xref="alg1.l16.m1.4.4.4.2.2.2.2.cmml">s</mi><mo id="alg1.l16.m1.4.4.4.2.2.2.1" xref="alg1.l16.m1.4.4.4.2.2.2.1.cmml">⁢</mo><mi id="alg1.l16.m1.4.4.4.2.2.2.3" xref="alg1.l16.m1.4.4.4.2.2.2.3.cmml">e</mi><mo id="alg1.l16.m1.4.4.4.2.2.2.1a" xref="alg1.l16.m1.4.4.4.2.2.2.1.cmml">⁢</mo><msub id="alg1.l16.m1.4.4.4.2.2.2.4" xref="alg1.l16.m1.4.4.4.2.2.2.4.cmml"><mi id="alg1.l16.m1.4.4.4.2.2.2.4.2" xref="alg1.l16.m1.4.4.4.2.2.2.4.2.cmml">g</mi><mrow id="alg1.l16.m1.4.4.4.2.2.2.4.3" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.cmml"><mi id="alg1.l16.m1.4.4.4.2.2.2.4.3.2" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.2.cmml">a</mi><mo id="alg1.l16.m1.4.4.4.2.2.2.4.3.1" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.4.4.4.2.2.2.4.3.3" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.3.cmml">t</mi><mo id="alg1.l16.m1.4.4.4.2.2.2.4.3.1a" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.4.4.4.2.2.2.4.3.4" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.4.cmml">l</mi><mo id="alg1.l16.m1.4.4.4.2.2.2.4.3.1b" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.4.4.4.2.2.2.4.3.5" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.5.cmml">a</mi><mo id="alg1.l16.m1.4.4.4.2.2.2.4.3.1c" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.4.4.4.2.2.2.4.3.6" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.6.cmml">s</mi></mrow></msub></mrow><mo id="alg1.l16.m1.5.5.5.3.3.6" xref="alg1.l16.m1.5.5.5.3.4.cmml">,</mo><msub id="alg1.l16.m1.5.5.5.3.3.3" xref="alg1.l16.m1.5.5.5.3.3.3.cmml"><mi id="alg1.l16.m1.5.5.5.3.3.3.2" xref="alg1.l16.m1.5.5.5.3.3.3.2.cmml">t</mi><mn id="alg1.l16.m1.5.5.5.3.3.3.3" xref="alg1.l16.m1.5.5.5.3.3.3.3.cmml">0</mn></msub><mo id="alg1.l16.m1.5.5.5.3.3.7" stretchy="false" xref="alg1.l16.m1.5.5.5.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.5b"><apply id="alg1.l16.m1.5.5.cmml" xref="alg1.l16.m1.5.5"><ci id="alg1.l16.m1.5.5.6.cmml" xref="alg1.l16.m1.5.5.6">←</ci><list id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2"><apply id="alg1.l16.m1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.2">𝑠</ci><cn id="alg1.l16.m1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l16.m1.1.1.1.1.1.3">1</cn></apply><apply id="alg1.l16.m1.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2">𝑡</ci><cn id="alg1.l16.m1.2.2.2.2.2.3.cmml" type="integer" xref="alg1.l16.m1.2.2.2.2.2.3">1</cn></apply></list><apply id="alg1.l16.m1.5.5.5.cmml" xref="alg1.l16.m1.5.5.5"><times id="alg1.l16.m1.5.5.5.4.cmml" xref="alg1.l16.m1.5.5.5.4"></times><ci id="alg1.l16.m1.5.5.5.5a.cmml" xref="alg1.l16.m1.5.5.5.5"><mtext id="alg1.l16.m1.5.5.5.5.cmml" xref="alg1.l16.m1.5.5.5.5">IterativeRegistration</mtext></ci><vector id="alg1.l16.m1.5.5.5.3.4.cmml" xref="alg1.l16.m1.5.5.5.3.3"><apply id="alg1.l16.m1.3.3.3.1.1.1.cmml" xref="alg1.l16.m1.3.3.3.1.1.1"><times id="alg1.l16.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.1"></times><ci id="alg1.l16.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.2">𝑠</ci><ci id="alg1.l16.m1.3.3.3.1.1.1.3.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.3">𝑒</ci><apply id="alg1.l16.m1.3.3.3.1.1.1.4.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.3.1.1.1.4.1.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.4">subscript</csymbol><ci id="alg1.l16.m1.3.3.3.1.1.1.4.2.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.4.2">𝑔</ci><apply id="alg1.l16.m1.3.3.3.1.1.1.4.3.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.4.3"><times id="alg1.l16.m1.3.3.3.1.1.1.4.3.1.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.4.3.1"></times><ci id="alg1.l16.m1.3.3.3.1.1.1.4.3.2.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.4.3.2">𝑖</ci><ci id="alg1.l16.m1.3.3.3.1.1.1.4.3.3.cmml" xref="alg1.l16.m1.3.3.3.1.1.1.4.3.3">𝑚</ci></apply></apply></apply><apply id="alg1.l16.m1.4.4.4.2.2.2.cmml" xref="alg1.l16.m1.4.4.4.2.2.2"><times id="alg1.l16.m1.4.4.4.2.2.2.1.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.1"></times><ci id="alg1.l16.m1.4.4.4.2.2.2.2.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.2">𝑠</ci><ci id="alg1.l16.m1.4.4.4.2.2.2.3.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.3">𝑒</ci><apply id="alg1.l16.m1.4.4.4.2.2.2.4.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l16.m1.4.4.4.2.2.2.4.1.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4">subscript</csymbol><ci id="alg1.l16.m1.4.4.4.2.2.2.4.2.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4.2">𝑔</ci><apply id="alg1.l16.m1.4.4.4.2.2.2.4.3.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4.3"><times id="alg1.l16.m1.4.4.4.2.2.2.4.3.1.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.1"></times><ci id="alg1.l16.m1.4.4.4.2.2.2.4.3.2.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.2">𝑎</ci><ci id="alg1.l16.m1.4.4.4.2.2.2.4.3.3.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.3">𝑡</ci><ci id="alg1.l16.m1.4.4.4.2.2.2.4.3.4.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.4">𝑙</ci><ci id="alg1.l16.m1.4.4.4.2.2.2.4.3.5.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.5">𝑎</ci><ci id="alg1.l16.m1.4.4.4.2.2.2.4.3.6.cmml" xref="alg1.l16.m1.4.4.4.2.2.2.4.3.6">𝑠</ci></apply></apply></apply><apply id="alg1.l16.m1.5.5.5.3.3.3.cmml" xref="alg1.l16.m1.5.5.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.5.5.5.3.3.3.1.cmml" xref="alg1.l16.m1.5.5.5.3.3.3">subscript</csymbol><ci id="alg1.l16.m1.5.5.5.3.3.3.2.cmml" xref="alg1.l16.m1.5.5.5.3.3.3.2">𝑡</ci><cn id="alg1.l16.m1.5.5.5.3.3.3.3.cmml" type="integer" xref="alg1.l16.m1.5.5.5.3.3.3.3">0</cn></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.5c">s_{1},\&gt;t_{1}\leftarrow\text{IterativeRegistration}(seg_{im},seg_{atlas},t_{0})</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.5d">italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ← IterativeRegistration ( italic_s italic_e italic_g start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT , italic_s italic_e italic_g start_POSTSUBSCRIPT italic_a italic_t italic_l italic_a italic_s end_POSTSUBSCRIPT , italic_t start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> <span class="ltx_text" id="alg1.l16.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l16.1.m1.1"><semantics id="alg1.l16.1.m1.1a"><mo id="alg1.l16.1.m1.1.1" xref="alg1.l16.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l16.1.m1.1b"><ci id="alg1.l16.1.m1.1.1.cmml" xref="alg1.l16.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.1.m1.1d">▷</annotation></semantics></math> Refine registration
</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<math alttext="bb_{im}\leftarrow(bb-t_{1})/s1" class="ltx_Math" display="inline" id="alg1.l17.m1.1"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.3.2" xref="alg1.l17.m1.1.1.3.2.cmml">b</mi><mo id="alg1.l17.m1.1.1.3.1" xref="alg1.l17.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml"><mi id="alg1.l17.m1.1.1.3.3.2" xref="alg1.l17.m1.1.1.3.3.2.cmml">b</mi><mrow id="alg1.l17.m1.1.1.3.3.3" xref="alg1.l17.m1.1.1.3.3.3.cmml"><mi id="alg1.l17.m1.1.1.3.3.3.2" xref="alg1.l17.m1.1.1.3.3.3.2.cmml">i</mi><mo id="alg1.l17.m1.1.1.3.3.3.1" xref="alg1.l17.m1.1.1.3.3.3.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.3.3.3.3" xref="alg1.l17.m1.1.1.3.3.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l17.m1.1.1.2" stretchy="false" xref="alg1.l17.m1.1.1.2.cmml">←</mo><mrow id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l17.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l17.m1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.2.cmml">b</mi><mo id="alg1.l17.m1.1.1.1.1.1.1.1.2.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="alg1.l17.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.3.cmml">b</mi></mrow><mo id="alg1.l17.m1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l17.m1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l17.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mn id="alg1.l17.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="alg1.l17.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l17.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l17.m1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.2.cmml">/</mo><mi id="alg1.l17.m1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.3.cmml">s</mi></mrow><mo id="alg1.l17.m1.1.1.1.2" xref="alg1.l17.m1.1.1.1.2.cmml">⁢</mo><mn id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.1.1.1.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">←</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><times id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3.1"></times><ci id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3.2">𝑏</ci><apply id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.3.1.cmml" xref="alg1.l17.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.3.2.cmml" xref="alg1.l17.m1.1.1.3.3.2">𝑏</ci><apply id="alg1.l17.m1.1.1.3.3.3.cmml" xref="alg1.l17.m1.1.1.3.3.3"><times id="alg1.l17.m1.1.1.3.3.3.1.cmml" xref="alg1.l17.m1.1.1.3.3.3.1"></times><ci id="alg1.l17.m1.1.1.3.3.3.2.cmml" xref="alg1.l17.m1.1.1.3.3.3.2">𝑖</ci><ci id="alg1.l17.m1.1.1.3.3.3.3.cmml" xref="alg1.l17.m1.1.1.3.3.3.3">𝑚</ci></apply></apply></apply><apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><times id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.2"></times><apply id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1"><divide id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.2"></divide><apply id="alg1.l17.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1"><minus id="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l17.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.2"><times id="alg1.l17.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.1"></times><ci id="alg1.l17.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.2">𝑏</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.2.3">𝑏</ci></apply><apply id="alg1.l17.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn id="alg1.l17.m1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="alg1.l17.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l17.m1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.3">𝑠</ci></apply><cn id="alg1.l17.m1.1.1.1.3.cmml" type="integer" xref="alg1.l17.m1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">bb_{im}\leftarrow(bb-t_{1})/s1</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.m1.1d">italic_b italic_b start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT ← ( italic_b italic_b - italic_t start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) / italic_s 1</annotation></semantics></math> <span class="ltx_text" id="alg1.l17.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l17.1.m1.1"><semantics id="alg1.l17.1.m1.1a"><mo id="alg1.l17.1.m1.1.1" xref="alg1.l17.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l17.1.m1.1b"><ci id="alg1.l17.1.m1.1.1.cmml" xref="alg1.l17.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l17.1.m1.1d">▷</annotation></semantics></math> Map bounding box to scan
</span>
</div>
<div class="ltx_listingline" id="alg1.l18">
<math alttext="im_{crop}\leftarrow\text{Cropping}(im,\&gt;bb_{im})" class="ltx_Math" display="inline" id="alg1.l18.m1.2"><semantics id="alg1.l18.m1.2a"><mrow id="alg1.l18.m1.2.2" xref="alg1.l18.m1.2.2.cmml"><mrow id="alg1.l18.m1.2.2.4" xref="alg1.l18.m1.2.2.4.cmml"><mi id="alg1.l18.m1.2.2.4.2" xref="alg1.l18.m1.2.2.4.2.cmml">i</mi><mo id="alg1.l18.m1.2.2.4.1" xref="alg1.l18.m1.2.2.4.1.cmml">⁢</mo><msub id="alg1.l18.m1.2.2.4.3" xref="alg1.l18.m1.2.2.4.3.cmml"><mi id="alg1.l18.m1.2.2.4.3.2" xref="alg1.l18.m1.2.2.4.3.2.cmml">m</mi><mrow id="alg1.l18.m1.2.2.4.3.3" xref="alg1.l18.m1.2.2.4.3.3.cmml"><mi id="alg1.l18.m1.2.2.4.3.3.2" xref="alg1.l18.m1.2.2.4.3.3.2.cmml">c</mi><mo id="alg1.l18.m1.2.2.4.3.3.1" xref="alg1.l18.m1.2.2.4.3.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.2.2.4.3.3.3" xref="alg1.l18.m1.2.2.4.3.3.3.cmml">r</mi><mo id="alg1.l18.m1.2.2.4.3.3.1a" xref="alg1.l18.m1.2.2.4.3.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.2.2.4.3.3.4" xref="alg1.l18.m1.2.2.4.3.3.4.cmml">o</mi><mo id="alg1.l18.m1.2.2.4.3.3.1b" xref="alg1.l18.m1.2.2.4.3.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.2.2.4.3.3.5" xref="alg1.l18.m1.2.2.4.3.3.5.cmml">p</mi></mrow></msub></mrow><mo id="alg1.l18.m1.2.2.3" stretchy="false" xref="alg1.l18.m1.2.2.3.cmml">←</mo><mrow id="alg1.l18.m1.2.2.2" xref="alg1.l18.m1.2.2.2.cmml"><mtext id="alg1.l18.m1.2.2.2.4" xref="alg1.l18.m1.2.2.2.4a.cmml">Cropping</mtext><mo id="alg1.l18.m1.2.2.2.3" xref="alg1.l18.m1.2.2.2.3.cmml">⁢</mo><mrow id="alg1.l18.m1.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.3.cmml"><mo id="alg1.l18.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l18.m1.2.2.2.2.3.cmml">(</mo><mrow id="alg1.l18.m1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l18.m1.1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.1.2.cmml">i</mi><mo id="alg1.l18.m1.1.1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="alg1.l18.m1.2.2.2.2.2.4" rspace="0.387em" xref="alg1.l18.m1.2.2.2.2.3.cmml">,</mo><mrow id="alg1.l18.m1.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l18.m1.2.2.2.2.2.2.2" xref="alg1.l18.m1.2.2.2.2.2.2.2.cmml">b</mi><mo id="alg1.l18.m1.2.2.2.2.2.2.1" xref="alg1.l18.m1.2.2.2.2.2.2.1.cmml">⁢</mo><msub id="alg1.l18.m1.2.2.2.2.2.2.3" xref="alg1.l18.m1.2.2.2.2.2.2.3.cmml"><mi id="alg1.l18.m1.2.2.2.2.2.2.3.2" xref="alg1.l18.m1.2.2.2.2.2.2.3.2.cmml">b</mi><mrow id="alg1.l18.m1.2.2.2.2.2.2.3.3" xref="alg1.l18.m1.2.2.2.2.2.2.3.3.cmml"><mi id="alg1.l18.m1.2.2.2.2.2.2.3.3.2" xref="alg1.l18.m1.2.2.2.2.2.2.3.3.2.cmml">i</mi><mo id="alg1.l18.m1.2.2.2.2.2.2.3.3.1" xref="alg1.l18.m1.2.2.2.2.2.2.3.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.2.2.2.2.2.2.3.3.3" xref="alg1.l18.m1.2.2.2.2.2.2.3.3.3.cmml">m</mi></mrow></msub></mrow><mo id="alg1.l18.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l18.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.2b"><apply id="alg1.l18.m1.2.2.cmml" xref="alg1.l18.m1.2.2"><ci id="alg1.l18.m1.2.2.3.cmml" xref="alg1.l18.m1.2.2.3">←</ci><apply id="alg1.l18.m1.2.2.4.cmml" xref="alg1.l18.m1.2.2.4"><times id="alg1.l18.m1.2.2.4.1.cmml" xref="alg1.l18.m1.2.2.4.1"></times><ci id="alg1.l18.m1.2.2.4.2.cmml" xref="alg1.l18.m1.2.2.4.2">𝑖</ci><apply id="alg1.l18.m1.2.2.4.3.cmml" xref="alg1.l18.m1.2.2.4.3"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.4.3.1.cmml" xref="alg1.l18.m1.2.2.4.3">subscript</csymbol><ci id="alg1.l18.m1.2.2.4.3.2.cmml" xref="alg1.l18.m1.2.2.4.3.2">𝑚</ci><apply id="alg1.l18.m1.2.2.4.3.3.cmml" xref="alg1.l18.m1.2.2.4.3.3"><times id="alg1.l18.m1.2.2.4.3.3.1.cmml" xref="alg1.l18.m1.2.2.4.3.3.1"></times><ci id="alg1.l18.m1.2.2.4.3.3.2.cmml" xref="alg1.l18.m1.2.2.4.3.3.2">𝑐</ci><ci id="alg1.l18.m1.2.2.4.3.3.3.cmml" xref="alg1.l18.m1.2.2.4.3.3.3">𝑟</ci><ci id="alg1.l18.m1.2.2.4.3.3.4.cmml" xref="alg1.l18.m1.2.2.4.3.3.4">𝑜</ci><ci id="alg1.l18.m1.2.2.4.3.3.5.cmml" xref="alg1.l18.m1.2.2.4.3.3.5">𝑝</ci></apply></apply></apply><apply id="alg1.l18.m1.2.2.2.cmml" xref="alg1.l18.m1.2.2.2"><times id="alg1.l18.m1.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.3"></times><ci id="alg1.l18.m1.2.2.2.4a.cmml" xref="alg1.l18.m1.2.2.2.4"><mtext id="alg1.l18.m1.2.2.2.4.cmml" xref="alg1.l18.m1.2.2.2.4">Cropping</mtext></ci><interval closure="open" id="alg1.l18.m1.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.2"><apply id="alg1.l18.m1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1"><times id="alg1.l18.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.1"></times><ci id="alg1.l18.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.2">𝑖</ci><ci id="alg1.l18.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="alg1.l18.m1.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2"><times id="alg1.l18.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.1"></times><ci id="alg1.l18.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.2">𝑏</ci><apply id="alg1.l18.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l18.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="alg1.l18.m1.2.2.2.2.2.2.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.3.2">𝑏</ci><apply id="alg1.l18.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.3.3"><times id="alg1.l18.m1.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.3.3.1"></times><ci id="alg1.l18.m1.2.2.2.2.2.2.3.3.2.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.3.3.2">𝑖</ci><ci id="alg1.l18.m1.2.2.2.2.2.2.3.3.3.cmml" xref="alg1.l18.m1.2.2.2.2.2.2.3.3.3">𝑚</ci></apply></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.2c">im_{crop}\leftarrow\text{Cropping}(im,\&gt;bb_{im})</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.2d">italic_i italic_m start_POSTSUBSCRIPT italic_c italic_r italic_o italic_p end_POSTSUBSCRIPT ← Cropping ( italic_i italic_m , italic_b italic_b start_POSTSUBSCRIPT italic_i italic_m end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Computing of new anatomical regions</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.5">One way to create anatomical regions is to create or edit the bounding boxes in the atlas coordinate system guided by expert knowledge. Another way is to use pairs of images and segmentations of the region of interest, which is performed the following way. For each image <math alttext="im_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">i</mi><mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">⁢</mo><msub id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">m</mi><mi id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><times id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></times><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝑖</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝑚</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">im_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">italic_i italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with corresponding region of interest segmentation <math alttext="ROI_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">R</mi><mo id="S3.SS4.p1.2.m2.1.1.1" xref="S3.SS4.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">O</mi><mo id="S3.SS4.p1.2.m2.1.1.1a" xref="S3.SS4.p1.2.m2.1.1.1.cmml">⁢</mo><msub id="S3.SS4.p1.2.m2.1.1.4" xref="S3.SS4.p1.2.m2.1.1.4.cmml"><mi id="S3.SS4.p1.2.m2.1.1.4.2" xref="S3.SS4.p1.2.m2.1.1.4.2.cmml">I</mi><mi id="S3.SS4.p1.2.m2.1.1.4.3" xref="S3.SS4.p1.2.m2.1.1.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><times id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1.1"></times><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑅</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝑂</ci><apply id="S3.SS4.p1.2.m2.1.1.4.cmml" xref="S3.SS4.p1.2.m2.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.4.1.cmml" xref="S3.SS4.p1.2.m2.1.1.4">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.4.2.cmml" xref="S3.SS4.p1.2.m2.1.1.4.2">𝐼</ci><ci id="S3.SS4.p1.2.m2.1.1.4.3.cmml" xref="S3.SS4.p1.2.m2.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">ROI_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">italic_R italic_O italic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> the registration transformation <math alttext="T_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">T</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝑇</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">T_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is computed as detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS2" title="3.2 Atlas registration ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.2</span></a>. This transformation is applied to <math alttext="ROI_{i}" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><mrow id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">R</mi><mo id="S3.SS4.p1.4.m4.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">O</mi><mo id="S3.SS4.p1.4.m4.1.1.1a" xref="S3.SS4.p1.4.m4.1.1.1.cmml">⁢</mo><msub id="S3.SS4.p1.4.m4.1.1.4" xref="S3.SS4.p1.4.m4.1.1.4.cmml"><mi id="S3.SS4.p1.4.m4.1.1.4.2" xref="S3.SS4.p1.4.m4.1.1.4.2.cmml">I</mi><mi id="S3.SS4.p1.4.m4.1.1.4.3" xref="S3.SS4.p1.4.m4.1.1.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><times id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1"></times><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝑅</ci><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝑂</ci><apply id="S3.SS4.p1.4.m4.1.1.4.cmml" xref="S3.SS4.p1.4.m4.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.4.1.cmml" xref="S3.SS4.p1.4.m4.1.1.4">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.4.2.cmml" xref="S3.SS4.p1.4.m4.1.1.4.2">𝐼</ci><ci id="S3.SS4.p1.4.m4.1.1.4.3.cmml" xref="S3.SS4.p1.4.m4.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">ROI_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.1d">italic_R italic_O italic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. The collection of transformed region of interest segmentations <math alttext="(T_{i}(ROI_{i}))_{i=1}^{n}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1"><semantics id="S3.SS4.p1.5.m5.1a"><msubsup id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mrow id="S3.SS4.p1.5.m5.1.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.5.m5.1.1.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml"><msub id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.2" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.3" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS4.p1.5.m5.1.1.1.1.1.1.2" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.3.cmml">O</mi><mo id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.1a" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.2" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.2.cmml">I</mi><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.3" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.3.cmml">i</mi></msub></mrow><mo id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.SS4.p1.5.m5.1.1.1.3" xref="S3.SS4.p1.5.m5.1.1.1.3.cmml"><mi id="S3.SS4.p1.5.m5.1.1.1.3.2" xref="S3.SS4.p1.5.m5.1.1.1.3.2.cmml">i</mi><mo id="S3.SS4.p1.5.m5.1.1.1.3.1" xref="S3.SS4.p1.5.m5.1.1.1.3.1.cmml">=</mo><mn id="S3.SS4.p1.5.m5.1.1.1.3.3" xref="S3.SS4.p1.5.m5.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">n</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1">superscript</csymbol><apply id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1"><times id="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.2"></times><apply id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.2">𝑇</ci><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1"><times id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.3">𝑂</ci><apply id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.2">𝐼</ci><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply><apply id="S3.SS4.p1.5.m5.1.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.3"><eq id="S3.SS4.p1.5.m5.1.1.1.3.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.3.1"></eq><ci id="S3.SS4.p1.5.m5.1.1.1.3.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.3.2">𝑖</ci><cn id="S3.SS4.p1.5.m5.1.1.1.3.3.cmml" type="integer" xref="S3.SS4.p1.5.m5.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">(T_{i}(ROI_{i}))_{i=1}^{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.1d">( italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_R italic_O italic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT</annotation></semantics></math> now reveals in which parts of the atlases coordinate system region of interest can and cannot occur. To extract one our multiple bounding boxes from this information we propose to simply average these masks by computing the heatmap</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="h=\frac{1}{n}\sum_{i=1}^{n}T_{i}(ROI_{i})." class="ltx_Math" display="block" id="S3.Ex4.m1.1"><semantics id="S3.Ex4.m1.1a"><mrow id="S3.Ex4.m1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.cmml"><mrow id="S3.Ex4.m1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.3.cmml">h</mi><mo id="S3.Ex4.m1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.Ex4.m1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.cmml"><mfrac id="S3.Ex4.m1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.3.cmml"><mn id="S3.Ex4.m1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.Ex4.m1.1.1.1.1.1.3.3" xref="S3.Ex4.m1.1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo id="S3.Ex4.m1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.cmml"><munderover id="S3.Ex4.m1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex4.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.2.2.3" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.Ex4.m1.1.1.1.1.1.1.2.3" xref="S3.Ex4.m1.1.1.1.1.1.1.2.3.cmml">n</mi></munderover><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex4.m1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.2.cmml">T</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.3.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">O</mi><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1a" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">I</mi><mi id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.3" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml">i</mi></msub></mrow><mo id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex4.m1.1.1.1.2" lspace="0em" xref="S3.Ex4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.1b"><apply id="S3.Ex4.m1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1"><eq id="S3.Ex4.m1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.2"></eq><ci id="S3.Ex4.m1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.3">ℎ</ci><apply id="S3.Ex4.m1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.2"></times><apply id="S3.Ex4.m1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3"><divide id="S3.Ex4.m1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3"></divide><cn id="S3.Ex4.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.Ex4.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.Ex4.m1.1.1.1.1.1.3.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.Ex4.m1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1"><apply id="S3.Ex4.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex4.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex4.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.Ex4.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.Ex4.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.3">𝑂</ci><apply id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.2">𝐼</ci><ci id="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.Ex4.m1.1.1.1.1.1.1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.1c">h=\frac{1}{n}\sum_{i=1}^{n}T_{i}(ROI_{i}).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.1d">italic_h = divide start_ARG 1 end_ARG start_ARG italic_n end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_R italic_O italic_I start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p1.7">The bounding boxes can be computed such that they contain all coordinates <math alttext="(x,y,z)" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m1.3"><semantics id="S3.SS4.p1.6.m1.3a"><mrow id="S3.SS4.p1.6.m1.3.4.2" xref="S3.SS4.p1.6.m1.3.4.1.cmml"><mo id="S3.SS4.p1.6.m1.3.4.2.1" stretchy="false" xref="S3.SS4.p1.6.m1.3.4.1.cmml">(</mo><mi id="S3.SS4.p1.6.m1.1.1" xref="S3.SS4.p1.6.m1.1.1.cmml">x</mi><mo id="S3.SS4.p1.6.m1.3.4.2.2" xref="S3.SS4.p1.6.m1.3.4.1.cmml">,</mo><mi id="S3.SS4.p1.6.m1.2.2" xref="S3.SS4.p1.6.m1.2.2.cmml">y</mi><mo id="S3.SS4.p1.6.m1.3.4.2.3" xref="S3.SS4.p1.6.m1.3.4.1.cmml">,</mo><mi id="S3.SS4.p1.6.m1.3.3" xref="S3.SS4.p1.6.m1.3.3.cmml">z</mi><mo id="S3.SS4.p1.6.m1.3.4.2.4" stretchy="false" xref="S3.SS4.p1.6.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m1.3b"><vector id="S3.SS4.p1.6.m1.3.4.1.cmml" xref="S3.SS4.p1.6.m1.3.4.2"><ci id="S3.SS4.p1.6.m1.1.1.cmml" xref="S3.SS4.p1.6.m1.1.1">𝑥</ci><ci id="S3.SS4.p1.6.m1.2.2.cmml" xref="S3.SS4.p1.6.m1.2.2">𝑦</ci><ci id="S3.SS4.p1.6.m1.3.3.cmml" xref="S3.SS4.p1.6.m1.3.3">𝑧</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m1.3c">(x,y,z)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m1.3d">( italic_x , italic_y , italic_z )</annotation></semantics></math> for which the heatmaps value is above a certain threshold. In case all segmentation labels are clean one can use 0 as a threshold, otherwise a larger threshold can be used. Our implementation computes the bounding box for each connected components of the thresholded heatmap <math alttext="h" class="ltx_Math" display="inline" id="S3.SS4.p1.7.m2.1"><semantics id="S3.SS4.p1.7.m2.1a"><mi id="S3.SS4.p1.7.m2.1.1" xref="S3.SS4.p1.7.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m2.1b"><ci id="S3.SS4.p1.7.m2.1.1.cmml" xref="S3.SS4.p1.7.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.7.m2.1d">italic_h</annotation></semantics></math> and merges overlapping ones. To account for anatomical variations and imperfections in the atlas registrations we increased the resulting bounding boxes by 1cm in each direction.
The corresponding workflow is visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.F2" title="Figure 2 ‣ 3.4 Computing of new anatomical regions ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="S3.F2.g1" src="extracted/5898221/bounding_box_generation.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Workflow of computing bounding boxes from labelled CT images. Step 1 and 2 compute the anatomy segmentations and the atlas registration transformation for each scan of the dataset. Step 3 applies these transformations to the regions of interest to map them all into the same coordinate system. Step 4 overlays these to a heatmap and computes the bounding box.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">Our code is available at https://github.com/ThomasBudd/ctarr and is delivered with bounding boxes for the anatomical regions of the kidneys, brain, colon, gallbladder, heart, liver, lungs, pancreas, spine, spleen, stomach, and urinary bladder. The creation of these boxes is described in the following section.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Image registration</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We use the Totalsegmentator dataset to compare our proposed segmentation and atlas registration algorithm with alternative methods. First, to assess the influence of the errors of the segmentation network onto the registration result, we ran the registration algorithm on this dataset again using the manual ground truth segmentations instead of the segmentation produced by the CNN. Second, to compare our registration pipeline with established state-of-the-art algorithms that perform directly on CT images, we use the affine registration of the ANTs framework<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://antspy.readthedocs.io/en/latest/registration.html</span></span></span>. To perform image-based atlas registration we needed to create a CT image atlas as the atlas of our registration method is only given as a set of segmentations. For this we used the scan with the longest z axis and registered it and its segmentation with our registration method to the atlas and verified the results visually (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.F4" title="Figure 4 ‣ 5.1 Image registration ‣ 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">4</span></a>). Lastly, we set up our proposed method. Since the original segmentation network was trained on the Totalsegmentator dataset, we trained the network again in four-fold cross-validation and collected only the predictions of scans that were not present in the training data to prevent a bias due to overfitting. We quantified the results in terms of DSC between the manual ground truth anatomy segmentations and NCC between the CT image atlas and the warped moving image.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Anatomical region cropping</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Next, we aimed at testing the utilities of the cropping pipeline. For this, we used the Totalsegmentator dataset to create a set of bounding boxes for various anatomical regions without considering other data sources. As the labels of the dataset are noisy, we could not threshold the heatmap <math alttext="h" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_h</annotation></semantics></math> (see Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS4" title="3.4 Computing of new anatomical regions ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.4</span></a>) with a value of 0, but instead had to choose larger values to prevent single outliers (see Appendix A) from greatly increasing the bounding boxes. The thresholds used for each region is listed in the supplementary Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S1.T4" title="Table 4 ‣ A Outlier examples in Totalsegmentator ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">4</span></a>. The data was obtained by using random scans from different scanners of the picture archiving system of a university hospital. In this case it is reasonable to assume that the majority of the segmented anatomies were healthy.
<br class="ltx_break"/>The cropping pipeline was tested on a total of n=1131 scans from public segmentation challenges namely the liver, lung, pancreas, spleen and colon dataset of the medical segmentation decathlon (MSD, <cite class="ltx_cite ltx_citemacro_cite">Antonelli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib1" title="">2022</a>)</cite>) and the kits23 challenge. In contrast to the Totalsegmentator data, these datasets contain scans of pathological organs (except for the spleen dataset).
<br class="ltx_break"/>As a measure for the sensitivity of the method, we computed the percentage of preserved foreground voxels after cropping. The specificity was captured by computing the percentage of foreground voxels contained in the image before and after cropping. To motivate the usage in reducing the inference time of image segmentation pipelines we further measured (1) the time it takes to execute the cropping pipeline, (2) the execution speed of inference of an nnU-Net style segmentation algorithm with and (3) without cropping the images using our proposed method. More technical detail on these experiments can be found in the Appendix B. It should be noted that we did not train an nnU-Net style network for this as this would have required additional training datasets for each segmentation problem. Instead, the inference was simulated by using networks with randomly initialised weights. To check how often the orientation in terms of 90 degrees rotation in xy-plane and flipping of the z-axis was obtained correctly by the pipeline, we manually checked the axial, coronal and sagittal view of each volume after applying our pipeline and computed the percentage of correct orientations.
<br class="ltx_break"/></p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Computation of new anatomical regions</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">As a last line of experiments we gradually reduced the number of scans from the Totalsegmentator dataset used to compute the bounding boxes and compared those with the MSD pancreas test dataset. This was done to see how many annotated scans are needed to perform the computation of bounding boxes described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS4" title="3.4 Computing of new anatomical regions ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.4</span></a>. As mentioned in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.SS4" title="3.4 Computing of new anatomical regions ‣ 3 Material and Methods ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3.4</span></a>, we increase the bounding box with a margin of 1cm in each direction by default. To make the bounding boxes obtained by the differing amount of scans comparable, we adapted this additional margin such that the volume of the bounding box equalled the volume of the bounding box created with the full Totalsegmentator dataset.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Image registration</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">The results of the image registration experiments can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.F3" title="Figure 3 ‣ 5.1 Image registration ‣ 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="251" id="S5.F3.g1" src="extracted/5898221/bar_plot_registration_methods.png" width="479"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Results of comparing the presented image registration method with the usage of clean segmentation labels and state-of-the-art affine registration methods using CT images instead of segmentations.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">It can be observed that the results of the registration pipeline using the automated and the manual ground truth labels are almost indistinguishable. While the traditional image-based method maintains moderate NCC values in some cases, it can be observed that the DSC values of this method are very poor. One reason for this is that the method is dependent on the starting point of the iteration and can get stuck in local minima before reaching the desired global minima. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.F4" title="Figure 4 ‣ 5.1 Image registration ‣ 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates some of such failures.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="313" id="S5.F4.g1" src="extracted/5898221/figure_im_atlas.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Examples of failures of the traditional image-based registration method.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">We present further comparisons via scatter plots in the Supplementary Materials along with visual comparisons.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Anatomical region cropping</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">The results of testing the cropping pipeline can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.T2" title="Table 2 ‣ 5.2 Anatomical region cropping ‣ 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Numerical evaluation of the cropping pipeline on the test dataset. The reduction of image voxels was computed by dividing voxels before cropping by the number of voxels after cropping. Computation times were measured using an RTX 6000 Ada GPU with pytorch 2.02 installation.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_rr" id="S5.T2.1.1.1.1">dataset</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" id="S5.T2.1.1.1.2">Liver</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" id="S5.T2.1.1.1.3">Lung</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" id="S5.T2.1.1.1.4">Panc.</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" id="S5.T2.1.1.1.5">Spleen</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r" id="S5.T2.1.1.1.6">Colon</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column" id="S5.T2.1.1.1.7">kits23</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_tt" id="S5.T2.1.2.1.1">region of</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T2.1.2.1.2">liver &amp;</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T2.1.2.1.3">lung</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T2.1.2.1.4">panc. &amp;</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T2.1.2.1.5">spleen</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T2.1.2.1.6">colon</td>
<td class="ltx_td ltx_align_left ltx_border_tt" id="S5.T2.1.2.1.7">kidneys &amp;</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr" id="S5.T2.1.3.2.1">interest</th>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.1.3.2.2">tumors</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.1.3.2.3">cancer</td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.1.3.2.4">masses</td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.3.2.5"></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.1.3.2.6">cancer</td>
<td class="ltx_td ltx_align_left" id="S5.T2.1.3.2.7">masses</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" id="S5.T2.1.4.3.1">num. scans</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.4.3.2">n=131</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.4.3.3">n=63</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.4.3.4">n=281</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.4.3.5">n=41</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.4.3.6">n=126</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.4.3.7">n=489</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" id="S5.T2.1.5.4.1">preserved</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.5.4.2">98.91%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.5.4.3">100%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.5.4.4">99.07%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.5.4.5">100%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.5.4.6">100%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.5.4.7">97.45%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr" id="S5.T2.1.6.5.1">foreground</th>
<td class="ltx_td ltx_border_r" id="S5.T2.1.6.5.2"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.6.5.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.6.5.4"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.6.5.5"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.6.5.6"></td>
<td class="ltx_td" id="S5.T2.1.6.5.7"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" id="S5.T2.1.7.6.1">foreground voxels</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.7.6.2">2.28%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.7.6.3">0.04%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.7.6.4">0.22%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.7.6.5">0.44%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.7.6.6">0.05%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.7.6.7">0.83%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr" id="S5.T2.1.8.7.1">before cropping</th>
<td class="ltx_td ltx_border_r" id="S5.T2.1.8.7.2"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.8.7.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.8.7.4"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.8.7.5"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.8.7.6"></td>
<td class="ltx_td" id="S5.T2.1.8.7.7"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.9.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" id="S5.T2.1.9.8.1">foreground voxels</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.9.8.2">11.38%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.9.8.3">0.08%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.9.8.4">2.08%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.9.8.5">8.09%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.9.8.6">0.13%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.9.8.7">10.3%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr" id="S5.T2.1.10.9.1">after cropping</th>
<td class="ltx_td ltx_border_r" id="S5.T2.1.10.9.2"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.10.9.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.10.9.4"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.10.9.5"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.10.9.6"></td>
<td class="ltx_td" id="S5.T2.1.10.9.7"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" id="S5.T2.1.11.10.1">exec. speed</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.11.10.2">0.21s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.11.10.3">0.15s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.11.10.4">0.10s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.11.10.5">0.14s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.11.10.6">0.16s</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.11.10.7">0.17s</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr" id="S5.T2.1.12.11.1">cropping</th>
<td class="ltx_td ltx_border_r" id="S5.T2.1.12.11.2"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.12.11.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.12.11.4"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.12.11.5"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.12.11.6"></td>
<td class="ltx_td" id="S5.T2.1.12.11.7"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.13.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" id="S5.T2.1.13.12.1">inference speed</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.13.12.2">126.7s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.13.12.3">87.4s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.13.12.4">72.7s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.13.12.5">102.3s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.13.12.6">124.5s</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.13.12.7">117.4s</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.14.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr" id="S5.T2.1.14.13.1">no cropping</th>
<td class="ltx_td ltx_border_r" id="S5.T2.1.14.13.2"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.14.13.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.14.13.4"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.14.13.5"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.14.13.6"></td>
<td class="ltx_td" id="S5.T2.1.14.13.7"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.15.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" id="S5.T2.1.15.14.1">inference speed</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.15.14.2">26.5s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.15.14.3">43.4s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.15.14.4">5.7s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.15.14.5">10.2s</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.15.14.6">58.1s</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.15.14.7">14.0s</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.16.15">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr" id="S5.T2.1.16.15.1">cropping</th>
<td class="ltx_td ltx_border_r" id="S5.T2.1.16.15.2"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.16.15.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.16.15.4"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.16.15.5"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.16.15.6"></td>
<td class="ltx_td" id="S5.T2.1.16.15.7"></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.17.16">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t" id="S5.T2.1.17.16.1">correct</th>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.17.16.2">99.24%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.17.16.3">100%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.17.16.4">100%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.17.16.5">100%</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.1.17.16.6">98.41%</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.1.17.16.7">100%</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.18.17">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr" id="S5.T2.1.18.17.1">orientation</th>
<td class="ltx_td ltx_border_r" id="S5.T2.1.18.17.2"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.18.17.3"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.18.17.4"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.18.17.5"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.1.18.17.6"></td>
<td class="ltx_td" id="S5.T2.1.18.17.7"></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">It can be observed that all foreground was preserved in three of the six tasks, and only 0.93-2.55% of the foreground was lost in the remaining tasks, while the percentage of foreground voxels in the images after cropping was increased by a factor of 1.98-8.13. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.F5" title="Figure 5 ‣ 5.2 Anatomical region cropping ‣ 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">5</span></a> shows examples of scans from each of those three tasks with a loss of ground truth foreground after cropping. Visual analysis revealed that the foreground that got lost during the cropping was always in close proximity to the margin of the bounding boxes. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.F5" title="Figure 5 ‣ 5.2 Anatomical region cropping ‣ 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">5</span></a> also shows that all three scans are still reasonably well aligned with the atlas despite the fact that the pathological masses present in the images caused a distortion in the neighboring anatomies. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.T2" title="Table 2 ‣ 5.2 Anatomical region cropping ‣ 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">2</span></a> shows that the proposed cropping pipeline took an average of 0.10-0.21s to compute on our RTX 6000 ADA GPU using pytorch 2.02, while reducing the inference computing time of a nnU-Net style segmentation algorithm by 44.0-100.2s. Last, the orientation of the scans was correctly determined in all except one scan in the MSD Liver and two scans in the MSD Colon dataset. The one scan from the MSD Liver dataset was flipped on the z-axis compared to the atlas as the segmentation algorithm labelled the vertebrae in the lower abdomen as vertebrae in the neck. We found that both scans from the MSD Colon dataset with wrong orientation were caused by a corruption of the image files. In both cases, we observed that some bottom slices were placed on the top of the stack of slices instead of the bottom, which also caused a flip of the z-axis when being compared to the atlas.</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="514" id="S5.F5.g1" src="extracted/5898221/outlier_examples.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Examples of scan with a loss of ground truth foreground after cropping.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Computation of new anatomical regions</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">In the end we evaluated the bounding boxes of the pancreas obtained with the differing amount of CT image and segmentation pairs. The results can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S5.T3" title="Table 3 ‣ 5.3 Computation of new anatomical regions ‣ 5 Results ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">3</span></a>. It can be noted that the sensitivity remains very stable even when using as little data as n=25 scans.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Change of sensitivity when decreasing the dataset size for locating the anatomical region of the pancreas. The bounding box size was fixed to the size of the bounding box when using the full dataset.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r" id="S5.T3.1.1.1"><math alttext="n" class="ltx_Math" display="inline" id="S5.T3.1.1.1.m1.1"><semantics id="S5.T3.1.1.1.m1.1a"><mi id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.T3.1.1.1.m1.1d">italic_n</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T3.1.1.2">807</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T3.1.1.3">403</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T3.1.1.4">201</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T3.1.1.5">100</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T3.1.1.6">50</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T3.1.1.7">25</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S5.T3.1.1.8">12</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S5.T3.1.1.9">6</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.1.2.1.1">sens</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.1.2">99.07</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.1.3">99.24</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.1.4">99.20</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.1.5">99.31</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.1.6">99.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.1.7">98.99</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.1.8">98.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.2.1.9">98.89</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Discussion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">The fact that CT images naturally vary in the anatomical context they contain can make automated processing of them more challenging. In this manuscript we proposed the first general purpose pipeline for identifying anatomical regions on CT images. We demonstrated how our pipeline can be adapted to any anatomical region by simply defining a new bounding box in the coordinate system of the atlas. We also showed that our method is robust, fast and can be used to drastically improve the inference speed of segmentation pipelines. This was done using over 1100 scans from six different publicly available datasets. We also suggested a novel registration pipeline based on automatically generated segmentation masks instead of using CT images directly. While this seems like an additional step that might introduce accumulated errors, we demonstrated how the usage of such segmentation masks instead prevents registration methods from getting stuck in local minima. The fact that the registration results using the automated and manual segmentations were extremely similar implies that further improvement of the segmentation model might not lead to an improved registration performance. Further, we demonstrated that potentially only very few labeled examples might be needed to compute new anatomical regions automatically.
<br class="ltx_break"/>Our method has room for improvement. Our results showed that inferring bounding boxes from healthy regions of interest and applying it to unhealthy patients might lead to a loss of information when applying the cropping pipelines. This is naturally to be expected as unhealthy organs can be enlarged and might exceed the boundaries of healthy organs. In consequence, more anatomical regions from unhealthy subjects should be computed and added to the pipeline to ensure no loss of information in these cases. As an alternative, an additional cropping margin can be used when using bounding boxes computed from healthy organs for scans with unhealthy organs. Second, the current version of the algorithm is not applicable for CT scans of the legs, as our method is not capable of segmenting anatomies in the legs. The current release of the Totalsegmentator algorithm does feature the segmentation of bones in the legs, however the corresponding labels have not been released in the publicly available dataset yet. Third, while the pipeline was able to infer the orientation of the scan in terms of z-axis flipping and xy-plane rotations, the user still has to know on whether the input images are axial, sagittal, or coronal images. This knowledge can be difficult to obtain especially when using nifti scans with isotropic resolution or false information was added to dicom headers. Fourth, to prevent the orientation alignment errors it is desirable to check the automated anatomical segmentations for plausibility. This might allow raising warnings for scans with labelling errors in the automated segmentation, or corrupted image files as observed in the MSD colon dataset. Finally, we believe that it would be valuable to extend the library for the usage of MRI scans as the Totalsegmentator dataset was recently extended by <cite class="ltx_cite ltx_citemacro_cite">D’Antonoli et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib7" title="">2024</a>)</cite> for the usage in MRI.
<br class="ltx_break"/>For the future, we believe it to be valuable to test the proposed pipeline as a preprocessing step for CT image analysis tasks. For example, the pipeline can be used as a first step in image registration problems where two scans of the same patient are present. In this scenario, CTARR reduces the workload and serves as a pre-registration tool by providing two crops of the same anatomical region. Further, the pipeline should be tested for image classification pipelines targeting cancers with complex distributions like ovarian cancer that is spread across the abdomen. The proposed pipeline can help reducing a dataset of CT scans to image crops of similar size showing the same anatomical context. This might be a key pre-processing step to avoid overfitting and reduce the training and inference burden.
<br class="ltx_break"/></p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">We presented a novel pipeline for cropping anatomical regions on CT images based on automated CNN-based anatomy segmentations and traditional image registration techniques to a predefined atlas. We demonstrated that the pipeline is fast, robust can be adapted easily to identify new anatomical regions.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p2">
<br class="ltx_break"/>
<p class="ltx_p" id="S7.p2.1"><span class="ltx_text ltx_font_bold" id="S7.p2.1.1" style="font-size:120%;">Acknowledgments</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p3">
<p class="ltx_p" id="S7.p3.1">We acknowledge funding and support from Cancer Research UK and the Cancer Research UK Cambridge Centre [CTRQQR-2021-100012], The Mark Foundation for Cancer Research [RG95043], GE HealthCare, and the CRUK National Cancer Imaging Translational Accelerator (NCITA) [A27066]. Additional support was also provided by the National Institute of Health Research (NIHR) Cambridge Biomedical Research Centre [NIHR203312] and EPSRC Tier-2 capital grant [EP/P020259/1]. MCO received support from the Joseph Mitchell Fund. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p4">
<br class="ltx_break"/>
<p class="ltx_p" id="S7.p4.1"><span class="ltx_text ltx_font_bold" id="S7.p4.1.1" style="font-size:120%;">Ethical Standards</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p5">
<p class="ltx_p" id="S7.p5.1">The work follows appropriate ethical standards in conducting research and writing the manuscript, following all applicable laws and regulations regarding treatment of animals or human subjects.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p6">
<br class="ltx_break"/>
<p class="ltx_p" id="S7.p6.1"><span class="ltx_text ltx_font_bold" id="S7.p6.1.1" style="font-size:120%;">Conflicts of Interest</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p7">
<p class="ltx_p" id="S7.p7.1">The conflicts of interest have not been entered yet.
</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p8">
<br class="ltx_break"/>
<p class="ltx_p" id="S7.p8.1"><span class="ltx_text ltx_font_bold" id="S7.p8.1.1" style="font-size:120%;">Data availability</span></p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p9">
<p class="ltx_p" id="S7.p9.1">All data used in this study is publicly available. The Totalsegmentator data can be found at https://zenodo.org/records/10047292. The Medical Decathlon data is available via http://medicaldecathlon.com/. The kits21 data can be accessed via the official github repository: https://github.com/neheller/kits21</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Antonelli et al. (2022)</span>
<span class="ltx_bibblock">
Michela Antonelli, Annika Reinke, Spyridon Bakas, Keyvan Farahani, AnnetteKopp-Schneider, Bennett A. Landman, Geert Litjens, Bjoern Menze, Olaf Ronneberger, Ronald M. Summers, Bram van Ginneken, Michel Bilello, Patrick Bilic, Patrick F. Christ, Richard K. G. Do, Marc J. Gollub, Stephan H. Heckers, Henkjan Huisman, William R. Jarnagin, Maureen K. McHugo, Sandy Napel, Jennifer S. Goli Pernicka, Kawal Rhode, Catalina Tobon-Gomez, Eugene Vorontsov, Henkjan Huisman, James A. Meakin, Sebastien Ourselin, Manuel Wiesenfarth, Pablo Arbelaez, Byeonguk Bae, Sihong Chen, Laura Daza, Jianjiang Feng, Baochun He, Fabian Isensee, Yuanfeng Ji, Fucang Jia, Namkug Kim, Ildoo Kim, Dorit Merhof, Akshay Pai, Beomhee Park, Mathias Perslev, Ramin Rezaiifar, Oliver Rippel, Ignacio Sarasua, Wei Shen, Jaemin Son, Christian Wachinger, Liansheng Wang, Yan Wang, Yingda Xia, Daguang Xu, Zhanwei Xu, Yefeng Zheng, Amber L. Simpson, Lena Maier-Hein, and M. Jorge Cardoso.

</span>
<span class="ltx_bibblock">The medical segmentation decathlon.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Nature Communications</em>, 2022.

</span>
<span class="ltx_bibblock">.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1038/s41467-022-30695-9" title="">https://doi.org/10.1038/s41467-022-30695-9</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Buchert et al. (2015)</span>
<span class="ltx_bibblock">
Ralph Buchert, Chloe Hutton, Catharina Lange, Peter Hoppe, Marcus Makowski, Thamer Bamousa, Günther Platsch, Winfried Brenner, and Jerome Declerck.

</span>
<span class="ltx_bibblock">Semiquantitative slab view display for visual evaluation of 123i-fp-cit spect.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Nuclear Medicine Communications</em>, 37:1, 12 2015.

</span>
<span class="ltx_bibblock">.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Buddenkotte et al. (2023)</span>
<span class="ltx_bibblock">
Thomas Buddenkotte, Leonardo Rundo, Ramona Woitek, Lorena Escudero Sanchez, Lucian Beer, Mireia Crispin-Ortuzar, Christian Etmann, Subhadip Mukherjee, Vlad Bura, Cathal McCague, Hilal Sahin, Roxana Pintican, Marta Zerunian, Iris Allajbeu, Naveena Singh, Sahdev Anju, Laura Havrilesky, David E. Cohn, Nicholas W. Bateman, Thomas P. Conrads, Kathleen M. Darcy, G. Larry Maxwell, John B. Freymann, Ozan Öktem, James D. Brenton, Evis Sala, and Carola-Bibiane Schönlieb.

</span>
<span class="ltx_bibblock">Deep learning-based segmentation of multi-site disease in ovarian cancer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">medRxiv</em>, 2023.

</span>
<span class="ltx_bibblock">.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.medrxiv.org/content/early/2023/01/11/2023.01.10.22279679" title="">https://www.medrxiv.org/content/early/2023/01/11/2023.01.10.22279679</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023)</span>
<span class="ltx_bibblock">
Junyu Chen, Yihao Liu, Shuwen Wei, Zhangxing Bian, Shalini Subramanian, Aaron Carass, Jerry Prince, and Yong Du.

</span>
<span class="ltx_bibblock">A survey on deep learning in medical image registration: New technologies, uncertainty, evaluation metrics, and beyond.

</span>
<span class="ltx_bibblock">07 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
<span class="ltx_bibblock">
Xiang Chen, Andres Diaz-Pinto, Nishant Ravikumar, and Alejandro F Frangi.

</span>
<span class="ltx_bibblock">Deep learning in medical image registration.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Progress in Biomedical Engineering</em>, 3(1):012003, feb 2021.

</span>
<span class="ltx_bibblock">.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://dx.doi.org/10.1088/2516-1091/abd37c" title="">https://dx.doi.org/10.1088/2516-1091/abd37c</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Çiçek et al. (2016)</span>
<span class="ltx_bibblock">
Özgün Çiçek, Ahmed Abdulkadir, Soeren S. Lienkamp, Thomas Brox, and Olaf Ronneberger.

</span>
<span class="ltx_bibblock">3d u-net: Learning dense volumetric segmentation from sparse annotation.

</span>
<span class="ltx_bibblock">pages 424–432, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">D’Antonoli et al. (2024)</span>
<span class="ltx_bibblock">
Tugba Akinci D’Antonoli, Lucas K. Berger, Ashraya K. Indrakanti, Nathan Vishwanathan, Jakob Weiß, Matthias Jung, Zeynep Berkarda, Alexander Rau, Marco Reisert, Thomas Küstner, Alexandra Walter, Elmar M. Merkle, Martin Segeroth, Joshy Cyriac, Shan Yang, and Jakob Wasserthal.

</span>
<span class="ltx_bibblock">Totalsegmentator mri: Sequence-independent segmentation of 59 anatomical structures in mr images.

</span>
<span class="ltx_bibblock">2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2405.19492" title="">https://arxiv.org/abs/2405.19492</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Isensee et al. (2021)</span>
<span class="ltx_bibblock">
Fabian Isensee, Paul F. Jaeger, Simon A. A. Kohl, Jens Petersen, and Klaus H. Maier-Hein.

</span>
<span class="ltx_bibblock">nnu-net: a self-configuring method for deep learning-based biomedical image segmentation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Nature Methods</em>, 2021.

</span>
<span class="ltx_bibblock">.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1038/s41592-020-01008-z" title="">https://doi.org/10.1038/s41592-020-01008-z</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Isensee et al. (2024)</span>
<span class="ltx_bibblock">
Fabian Isensee, Tassilo Wald, Constantin Ulrich, Michael Baumgartner, Saikat Roy, Klaus Maier-Hein, and Paul F. Jaeger.

</span>
<span class="ltx_bibblock">nnu-net revisited: A call for rigorous validation in 3d medical image segmentation.

</span>
<span class="ltx_bibblock">2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2404.09556" title="">https://arxiv.org/abs/2404.09556</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kalinić (2009)</span>
<span class="ltx_bibblock">
Hrvoje Kalinić.

</span>
<span class="ltx_bibblock">Atlas-based image segmentation: A survey.

</span>
<span class="ltx_bibblock">2009.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:18162999" title="">https://api.semanticscholar.org/CorpusID:18162999</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2017)</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter.

</span>
<span class="ltx_bibblock">Fixing weight decay regularization in adam.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">CoRR</em>, abs/1711.05101, 2017.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1711.05101" title="">http://arxiv.org/abs/1711.05101</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manera et al. (2020)</span>
<span class="ltx_bibblock">
Ana Manera, Mahsa Dadar, Vladimir Fonov, and Louis Collins.

</span>
<span class="ltx_bibblock">Cerebra, registration and manual label correction of mindboggle-101 atlas for mni-icbm152 template.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Scientific Data</em>, 7, 07 2020.

</span>
<span class="ltx_bibblock">.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mikhael et al. (2023)</span>
<span class="ltx_bibblock">
Peter G. Mikhael, Jeremy Wohlwend, Adam Yala, Ludvig Karstens, Justin Xiang, Angelo K. Takigami, Patrick P. Bourgouin, PuiYee Chan, Sofiane Mrah, Wael Amayri, Yu-Hsiang Juan, Cheng-Ta Yang, Yung-Liang Wan, Gigin Lin, Lecia V. Sequist, Florian J. Fintelmann, and Regina Barzilay.

</span>
<span class="ltx_bibblock">Sybil: A validated deep learning model to predict future lung cancer risk from a single low-dose chest computed tomography.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Journal of Clinical Oncology</em>, 41(12):2191–2200, 2023.

</span>
<span class="ltx_bibblock">.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1200/JCO.22.01345" title="">https://doi.org/10.1200/JCO.22.01345</a>.

</span>
<span class="ltx_bibblock">PMID: 36634294.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Myronenko et al. (2023)</span>
<span class="ltx_bibblock">
Andriy Myronenko, Dong Yang, Yufan He, and Daguang Xu.

</span>
<span class="ltx_bibblock">Automated 3d segmentation of kidneys and tumors in miccai kits 2023 challenge, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ni et al. (2020)</span>
<span class="ltx_bibblock">
Hong Ni, Tan Chaozhen, Zhao Feng, Shangbin Chen, Zoutao Zhang, Wenwei Li, Yue Guan, Hui Gong, Qingming Luo, and Anan Li.

</span>
<span class="ltx_bibblock">A robust image registration interface for large volume brain atlas.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Scientific Reports</em>, 10, 02 2020.

</span>
<span class="ltx_bibblock">.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ronneberger et al. (2015)</span>
<span class="ltx_bibblock">
Olaf Ronneberger, Philipp Fischer, and Thomas Brox.

</span>
<span class="ltx_bibblock">U-net: Convolutional networks for biomedical image segmentation.

</span>
<span class="ltx_bibblock">2015.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/1505.04597" title="">http://arxiv.org/abs/1505.04597</a>.

</span>
<span class="ltx_bibblock">cite arxiv:1505.04597Comment: conditionally accepted at MICCAI 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schöckel et al. (2020)</span>
<span class="ltx_bibblock">
Laura Schöckel, Gregor Jost, Peter Seidensticker, Philipp Lengsfeld, Petra Palkowitsch, and Hubertus Pietsch.

</span>
<span class="ltx_bibblock">Developments in x-ray contrast media and the potential impact on computed tomography.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Investigative Radiology</em>, 2020.

</span>
<span class="ltx_bibblock">.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wasserthal et al. (2023)</span>
<span class="ltx_bibblock">
Jakob Wasserthal, Hanns-Christian Breit, Manfred T. Meyer, Maurice Pradella, Daniel Hinck, Alexander W. Sauter, Tobias Heye, Daniel T. Boll, Joshy Cyriac, Shan Yang, Michael Bach, and Martin Segeroth.

</span>
<span class="ltx_bibblock">Totalsegmentator: Robust segmentation of 104 anatomic structures in ct images.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Radiology: Artificial Intelligence</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1148/ryai.230024" title="">https://doi.org/10.1148/ryai.230024</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_section" id="S1a">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">A </span>Outlier examples in Totalsegmentator</h2>
<div class="ltx_para" id="S1a.p1">
<p class="ltx_p" id="S1a.p1.1">This section briefly demonstrates some outliers far from the actual anatomical region that are introduced by automated segmentation methods. The examples were taken from the Totalsegmentator dataset <cite class="ltx_cite ltx_citemacro_cite">Wasserthal et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib18" title="">2023</a>)</cite>. The annotations of this dataset were created by first training the nnU-Net framework <cite class="ltx_cite ltx_citemacro_cite">Isensee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib8" title="">2021</a>)</cite> on little manually created annotations, evaluating the model on unannotated data and correcting the predictions manually. We found that some of the annotations in the Totalsegmentator dataset contained mistakes which are most likely caused by the annotator missing errors of the nnU-Net segmentation. Examples of such can be found in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S1.F6" title="Figure 6 ‣ A Outlier examples in Totalsegmentator ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">6</span></a>. All errors presented are far away from the anatomical region where the organs are actually located. This might be a reason why the annotators have missed these false positive predictions.</p>
</div>
<figure class="ltx_figure" id="S1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="316" id="S1.F6.g1" src="extracted/5898221/totalsegmentator_outliers.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Examples of implausible annotations on the Totalsegmentator dataset. These errors are most likely a result of false positive errors of the segmentation network that were missed by the annotator during the refinement process. The heading of each image displays the label of the red contour and the ID of the scan.</figcaption>
</figure>
<figure class="ltx_table" id="S1.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Thresholds applied to infer bounding boxes on the Totalsegmentator dataset. Noise in the Totalsegmentator labels cause too large bounding boxes when using a threshold of 0. The thresholds were obtained by increasing the threshold until the visual inspection of the bounding box in the atlas coordinate system was satisfying.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S1.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S1.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r" id="S1.T4.1.1.1.1">Region</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S1.T4.1.1.1.2">threshold</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S1.T4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S1.T4.1.2.1.1">spine</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S1.T4.1.2.1.2">0.03</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.3.2.1">brain</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.3.2.2">0.01</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.4.3.1">lungs</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.4.3.2">0.04</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.5.4.1">heart</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.5.4.2">0.03</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.6.5.1">spleen</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.6.5.2">0.01</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.7.6.1">kidneys</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.7.6.2">0.01</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.8.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.8.7.1">urinary bladder</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.8.7.2">0.01</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.9.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.9.8.1">colon</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.9.8.2">0.03</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.10.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.10.9.1">gallbladder</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.10.9.2">0.01</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.11.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.11.10.1">pancreas</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.11.10.2">0.01</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.12.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.12.11.1">stomach</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.12.11.2">0.01</td>
</tr>
<tr class="ltx_tr" id="S1.T4.1.13.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S1.T4.1.13.12.1">liver</td>
<td class="ltx_td ltx_align_center" id="S1.T4.1.13.12.2">0.035</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_section" id="S2a">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">B </span>Hyper-parameters of image augmentation</h2>
<div class="ltx_para" id="S2a.p1">
<p class="ltx_p" id="S2a.p1.1">The hyper-paramters of the image augmentation can be found in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S2.T5" title="Table 5 ‣ B Hyper-parameters of image augmentation ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">5</span></a>. Rotations and grid scaling were applied only in xy plane. Rotations were performed around the image center once using interpolation (magnitude=[-45, 45] degrees) and in a interpolation-free manner (90-, 180-, or 270-degrees). The standard deviation of the additive Gaussian noise was computed by respecting the standard deviation of the image patch <math alttext="\sigma(im)" class="ltx_Math" display="inline" id="S2a.p1.1.m1.1"><semantics id="S2a.p1.1.m1.1a"><mrow id="S2a.p1.1.m1.1.1" xref="S2a.p1.1.m1.1.1.cmml"><mi id="S2a.p1.1.m1.1.1.3" xref="S2a.p1.1.m1.1.1.3.cmml">σ</mi><mo id="S2a.p1.1.m1.1.1.2" xref="S2a.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2a.p1.1.m1.1.1.1.1" xref="S2a.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2a.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2a.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2a.p1.1.m1.1.1.1.1.1" xref="S2a.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2a.p1.1.m1.1.1.1.1.1.2" xref="S2a.p1.1.m1.1.1.1.1.1.2.cmml">i</mi><mo id="S2a.p1.1.m1.1.1.1.1.1.1" xref="S2a.p1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2a.p1.1.m1.1.1.1.1.1.3" xref="S2a.p1.1.m1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S2a.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2a.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2a.p1.1.m1.1b"><apply id="S2a.p1.1.m1.1.1.cmml" xref="S2a.p1.1.m1.1.1"><times id="S2a.p1.1.m1.1.1.2.cmml" xref="S2a.p1.1.m1.1.1.2"></times><ci id="S2a.p1.1.m1.1.1.3.cmml" xref="S2a.p1.1.m1.1.1.3">𝜎</ci><apply id="S2a.p1.1.m1.1.1.1.1.1.cmml" xref="S2a.p1.1.m1.1.1.1.1"><times id="S2a.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2a.p1.1.m1.1.1.1.1.1.1"></times><ci id="S2a.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2a.p1.1.m1.1.1.1.1.1.2">𝑖</ci><ci id="S2a.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2a.p1.1.m1.1.1.1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2a.p1.1.m1.1c">\sigma(im)</annotation><annotation encoding="application/x-llamapun" id="S2a.p1.1.m1.1d">italic_σ ( italic_i italic_m )</annotation></semantics></math>. The magnitude of the Gaussian Blurring is given in number of voxels with full width at half maximum.</p>
</div>
<figure class="ltx_table" id="S2.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Hyper-paramters of the image augmentations.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S2.T5.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S2.T5.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.2.1.1">Operation</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.2.1.2">Probability</td>
<td class="ltx_td ltx_align_center" id="S2.T5.1.2.1.3">Magnitude</td>
</tr>
<tr class="ltx_tr" id="S2.T5.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T5.1.3.2.1">Rotation</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S2.T5.1.3.2.2">0.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S2.T5.1.3.2.3">[-45, 45]</td>
</tr>
<tr class="ltx_tr" id="S2.T5.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.4.3.1">Rotation</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.4.3.2">0.75</td>
<td class="ltx_td ltx_align_center" id="S2.T5.1.4.3.3">{90, 180, 270}</td>
</tr>
<tr class="ltx_tr" id="S2.T5.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.5.4.1">Grid scaling</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.5.4.2">0.5</td>
<td class="ltx_td ltx_align_center" id="S2.T5.1.5.4.3">[0.7, 1.4]</td>
</tr>
<tr class="ltx_tr" id="S2.T5.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.6.5.1">Flipping (z only)</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.6.5.2">0.5</td>
<td class="ltx_td" id="S2.T5.1.6.5.3"></td>
</tr>
<tr class="ltx_tr" id="S2.T5.1.1">
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.1.2">Addative Gaussian Noise</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.1.3">0.5</td>
<td class="ltx_td ltx_align_center" id="S2.T5.1.1.1"><math alttext="\sigma(im)\times[0,0.25]" class="ltx_Math" display="inline" id="S2.T5.1.1.1.m1.3"><semantics id="S2.T5.1.1.1.m1.3a"><mrow id="S2.T5.1.1.1.m1.3.3" xref="S2.T5.1.1.1.m1.3.3.cmml"><mrow id="S2.T5.1.1.1.m1.3.3.1" xref="S2.T5.1.1.1.m1.3.3.1.cmml"><mi id="S2.T5.1.1.1.m1.3.3.1.3" xref="S2.T5.1.1.1.m1.3.3.1.3.cmml">σ</mi><mo id="S2.T5.1.1.1.m1.3.3.1.2" xref="S2.T5.1.1.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.T5.1.1.1.m1.3.3.1.1.1" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.cmml"><mo id="S2.T5.1.1.1.m1.3.3.1.1.1.2" stretchy="false" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.T5.1.1.1.m1.3.3.1.1.1.1" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.cmml"><mi id="S2.T5.1.1.1.m1.3.3.1.1.1.1.2" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.2.cmml">i</mi><mo id="S2.T5.1.1.1.m1.3.3.1.1.1.1.1" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.1.cmml">⁢</mo><mi id="S2.T5.1.1.1.m1.3.3.1.1.1.1.3" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.3.cmml">m</mi></mrow><mo id="S2.T5.1.1.1.m1.3.3.1.1.1.3" rspace="0.055em" stretchy="false" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.T5.1.1.1.m1.3.3.2" rspace="0.222em" xref="S2.T5.1.1.1.m1.3.3.2.cmml">×</mo><mrow id="S2.T5.1.1.1.m1.3.3.3.2" xref="S2.T5.1.1.1.m1.3.3.3.1.cmml"><mo id="S2.T5.1.1.1.m1.3.3.3.2.1" stretchy="false" xref="S2.T5.1.1.1.m1.3.3.3.1.cmml">[</mo><mn id="S2.T5.1.1.1.m1.1.1" xref="S2.T5.1.1.1.m1.1.1.cmml">0</mn><mo id="S2.T5.1.1.1.m1.3.3.3.2.2" xref="S2.T5.1.1.1.m1.3.3.3.1.cmml">,</mo><mn id="S2.T5.1.1.1.m1.2.2" xref="S2.T5.1.1.1.m1.2.2.cmml">0.25</mn><mo id="S2.T5.1.1.1.m1.3.3.3.2.3" stretchy="false" xref="S2.T5.1.1.1.m1.3.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.T5.1.1.1.m1.3b"><apply id="S2.T5.1.1.1.m1.3.3.cmml" xref="S2.T5.1.1.1.m1.3.3"><times id="S2.T5.1.1.1.m1.3.3.2.cmml" xref="S2.T5.1.1.1.m1.3.3.2"></times><apply id="S2.T5.1.1.1.m1.3.3.1.cmml" xref="S2.T5.1.1.1.m1.3.3.1"><times id="S2.T5.1.1.1.m1.3.3.1.2.cmml" xref="S2.T5.1.1.1.m1.3.3.1.2"></times><ci id="S2.T5.1.1.1.m1.3.3.1.3.cmml" xref="S2.T5.1.1.1.m1.3.3.1.3">𝜎</ci><apply id="S2.T5.1.1.1.m1.3.3.1.1.1.1.cmml" xref="S2.T5.1.1.1.m1.3.3.1.1.1"><times id="S2.T5.1.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.1"></times><ci id="S2.T5.1.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.2">𝑖</ci><ci id="S2.T5.1.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S2.T5.1.1.1.m1.3.3.1.1.1.1.3">𝑚</ci></apply></apply><interval closure="closed" id="S2.T5.1.1.1.m1.3.3.3.1.cmml" xref="S2.T5.1.1.1.m1.3.3.3.2"><cn id="S2.T5.1.1.1.m1.1.1.cmml" type="integer" xref="S2.T5.1.1.1.m1.1.1">0</cn><cn id="S2.T5.1.1.1.m1.2.2.cmml" type="float" xref="S2.T5.1.1.1.m1.2.2">0.25</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T5.1.1.1.m1.3c">\sigma(im)\times[0,0.25]</annotation><annotation encoding="application/x-llamapun" id="S2.T5.1.1.1.m1.3d">italic_σ ( italic_i italic_m ) × [ 0 , 0.25 ]</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S2.T5.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.7.6.1">Gaussian Blurring</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S2.T5.1.7.6.2">0.5</td>
<td class="ltx_td ltx_align_center" id="S2.T5.1.7.6.3">[0, 5]</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_section" id="S3a">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">C </span>Additional results image registration</h2>
<div class="ltx_para" id="S3a.p1">
<p class="ltx_p" id="S3a.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.F7" title="Figure 7 ‣ C Additional results image registration ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">7</span></a> presents scatter plots to compare the different registration methods.</p>
</div>
<figure class="ltx_figure" id="S3.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="307" id="S3.F7.g1" src="extracted/5898221/scatter_plot_manual_vs_auto.png" width="598"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="306" id="S3.F7.g2" src="extracted/5898221/scatter_plot_our_vs_ants.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Scatter plot for a case by case comparison of the different registration methods.</figcaption>
</figure>
<div class="ltx_para" id="S3a.p2">
<p class="ltx_p" id="S3a.p2.1">It can be observed that the segmentation-based approaches result in very similar results in terms of NCC and that only few outliers can be detected in terms of DSC. The most dominant six cases in which a higher DSC was achieved by using the manual segmentation instead of the automated segmentation are displayed in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#S3.F8" title="Figure 8 ‣ C Additional results image registration ‣ CTARR: A fast and robust method for identifying anatomical regions on CT images via atlas registration"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="562" id="S3.F8.g1" src="extracted/5898221/gt_vs_auto.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Examples for which the registration achieved a higher DSC performance when using the manual ground truth segmentations instead of the automated segmentations.</figcaption>
</figure>
<div class="ltx_para" id="S3a.p3">
<p class="ltx_p" id="S3a.p3.1">Overall it can be observed how the classical image-based method frequently fails in aligning the CT image with the atlas.</p>
</div>
</section>
<section class="ltx_section" id="S4a">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">D </span>Simulation of segmentation network inference</h2>
<div class="ltx_para" id="S4a.p1">
<p class="ltx_p" id="S4a.p1.1">To simulate the computational burden of segmentation network inference we created a inference pipeline similar to the one suggested by nnU-Net <cite class="ltx_cite ltx_citemacro_cite">Isensee et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02316v1#bib.bib8" title="">2021</a>)</cite>. In a first step we resized the images to a common voxel spacing. While nnU-Net suggests a different voxel spacing per dataset, we used a common spacing of 3mm in z and 0.75mm in xy direction to simplify the experiments. Next, we used a 3d U-Net architecture as suggested by nnU-Net. We used a five stage network where the first two stages used only inplane convolutions to account for the anisotropic resolution. The network was evaluated with the Sliding Window algorithm using a patch size of 64 x 160 x 160 voxels. As in nnU-Net, this was repeated applied total of 40 times to simulate the test time augmentation (evaluating with eight configurations of flipping over the z, x, and y axes) and the ensembling (evaluate five networks trained in cross-validation). Finally, the predictions were interpolated again to the original image spacing. In our experiments we used the GPU interpolation operations implemented in pytorch to accelerate the inference. We used an NVIDIA 6000 Ada GPU and pytorch v2.02 for all experiments.</p>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 08:48:22 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
