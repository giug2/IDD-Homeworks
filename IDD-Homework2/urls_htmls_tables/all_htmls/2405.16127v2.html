<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Finetuning Large Language Model for Personalized Ranking</title>
<!--Generated on Thu Jun 20 07:16:34 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Large Language Model,  Recommender Systems,  Direct Preference Optimization" lang="en" name="keywords"/>
<base href="/html/2405.16127v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S1" title="In Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S2" title="In Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S2.SS1" title="In 2. Related Work ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>LLM-based recommendation systems</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S2.SS2" title="In 2. Related Work ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S2.SS3" title="In 2. Related Work ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Cross-domain Recommendation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S3" title="In Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S3.SS1" title="In 3. Preliminary ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Pair-Wise Ranking loss</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4" title="In Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.SS1" title="In 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Task Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.SS2" title="In 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Instruction Prompts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.SS3" title="In 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Supervised Fine Tuning (SFT)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.SS4" title="In 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Direct Multiple Preference Optimization (DMPO)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.SS5" title="In 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Prediction</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5" title="In Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS1" title="In 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Dataset</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS1.SSS1" title="In 5.1. Dataset ‣ 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.1 </span>MovieLens 1M</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS1.SSS2" title="In 5.1. Dataset ‣ 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1.2 </span>Amazon Datasets</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS2" title="In 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Baseline</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS2.SSS1" title="In 5.2. Baseline ‣ 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.1 </span>LLM-based methods</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS2.SSS2" title="In 5.2. Baseline ‣ 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.2 </span>Traditional methods</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS3" title="In 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Evaluation Metric</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS4" title="In 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Implementation Details</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6" title="In Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS1" title="In 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Performance Comparison (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS2" title="In 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Ablation Study (RQ2)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS2.SSS1" title="In 6.2. Ablation Study (RQ2) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2.1 </span>Number of Negative samples in DMPO</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS2.SSS2" title="In 6.2. Ablation Study (RQ2) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2.2 </span>DMPO and SFT with Varying Few-Shot Samples</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS2.SSS3" title="In 6.2. Ablation Study (RQ2) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2.3 </span>Generalization across Base Models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS3" title="In 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Cross-Domain Analysis (RQ3)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS3.SSS1" title="In 6.3. Cross-Domain Analysis (RQ3) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3.1 </span>Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS3.SSS2" title="In 6.3. Cross-Domain Analysis (RQ3) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3.2 </span>Performance Comparsion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS4" title="In 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Case Study (RQ4)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS5" title="In 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Explainable Recommendation System</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S7" title="In Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Finetuning Large Language Model for Personalized Ranking</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhuoxi Bai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:bzxleon844@gmail.com">bzxleon844@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Cashcat</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ning Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:wuning@buaa.edu.cn">wuning@buaa.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Beihang University</span><span class="ltx_text ltx_affiliation_country" id="id4.2.id2">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Fengyu Cai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:fengyu.cai@tu-darmstadt.de">fengyu.cai@tu-darmstadt.de</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Technical University of Darmstadt</span><span class="ltx_text ltx_affiliation_country" id="id6.2.id2">Germany</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xinyi Zhu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:helvieluke534@gmail.com">helvieluke534@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Shanghai University</span><span class="ltx_text ltx_affiliation_country" id="id8.2.id2">China</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yun Xiong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yunx@fudan.edu.cn">yunx@fudan.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">Fudan University</span><span class="ltx_text ltx_affiliation_country" id="id10.2.id2">China</span>
</span></span></span>
</div>
<div class="ltx_dates">(2018; 20 February 2007; 12 March 2009; 5 June 2009)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id11.id1">Large Language Models (LLMs) have demonstrated remarkable performance across various domains, motivating researchers to investigate their potential use in recommendation systems. However, directly applying LLMs to recommendation tasks has proven challenging due to the significant disparity between the data used for pre-training LLMs and the specific requirements of recommendation tasks. In this study, we introduce Direct Multi-Preference Optimization (DMPO), a streamlined framework designed to bridge the gap and enhance the alignment of LLMs for recommendation tasks. DMPO enhances the performance of LLM-based recommenders by simultaneously maximizing the probability of positive samples and minimizing the probability of multiple negative samples. We conducted experimental evaluations to compare DMPO against traditional recommendation methods and other LLM-based recommendation approaches. The results demonstrate that DMPO significantly improves the recommendation capabilities of LLMs across three real-world public datasets in few-shot scenarios. Additionally, the experiments indicate that DMPO exhibits superior generalization ability in cross-domain recommendations. A case study elucidates the reasons behind these consistent improvements and also underscores DMPO’s potential as an explainable recommendation system. Our code and data are available at <a class="ltx_ref ltx_href" href="https://github.com/BZX667/DMPO" title="">https://github.com/BZX667/DMPO</a></p>
</div>
<div class="ltx_keywords">Large Language Model, Recommender Systems, Direct Preference Optimization
</div>
<div class="ltx_acknowledgements">*Both authors contributed equally to this research. †The corresponding author.
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation email; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommendation systems are essential for addressing information overload and fulfilling the information needs of users <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib58" title="">guo2017deepfm, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib59" title="">xi2023bird, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib60" title="">xi2023towards, </a>)</cite>. Large Language Models (LLMs) have emerged as powerful tools in Natural Language Processing (NLP), demonstrating impressive capacity in natural language understanding and text generation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib61" title="">brown2020language, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib62" title="">touvron2023llama, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib63" title="">wang2023recmind, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib64" title="">zhang2023memory, </a>)</cite>. Previous studies have highlighted the rich knowledge and generalization abilities of LLMs <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib41" title="">ouyang2022training, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib74" title="">sanh2021multitask, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib75" title="">wei2021finetuned, </a>)</cite>. Given these strengths, LLMs are poised to revolutionize recommendation systems, particularly in few-shot or zero-shot scenarios. Consequently, researchers have begun exploring the application of LLMs in recommendation systems. However, directly applying LLMs to recommendation tasks may not yield satisfactory performance, as the pre-training data of LLMs is primarily tailored for NLP tasks, which significantly differ in purpose and requirements from recommendation tasks <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib2" title="">tallrec, </a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Previous work has employed in-context learning <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib61" title="">brown2020language, </a>)</cite> to align LLMs with recommendation problems <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib49" title="">geng2022recommendation, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib55" title="">wang2023zero, </a>)</cite>. These methods typically use closed-source models such as ChatGPT and GPT4 <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://chat.openai.com/</span></span></span> to rerank candidates selected by traditional recommendation models such as Matrix Factorization (MF) <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib56" title="">koren2009matrix, </a>)</cite> and LightGCN <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib4" title="">he2020lightgcn, </a>)</cite>. However, these methods only superficially incorporate LLMs, constrained by the limitations of previous methods. This is a pressing need to explore strategies for effective and efficient utilization of LLMs in recommendation tasks. Other studies, such as TALLrec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib2" title="">tallrec, </a>)</cite>, have proposed Supervised Fine-Tuning (SFT) to bridge this gap by introducing data samples specific to recommendation tasks. TALLrec leverages the fine-tuning method used in general NLP to train on recommendation samples, aiming to achieve improved results compared to the in-context learning method. However, SFT only maximizes the probability of generating the correct answer during training. When faced with unseen incorrect answers, the model may overestimate their probability and make incorrect predictions due to the lack of negative sample learning. This approach overlooks the benefits of learning and establishing distinctions and connections between multiple pairs of positive and negative samples, as illustrated in Fig <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="278" id="S1.F1.g1" src="x1.png" width="789"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>When aligning the LLMs with recommendation tasks, applying Supervised Fine-Tuning (SFT) to LLM initially helps maximize the probability of generating each token in positive items. However, this method overlooks the potential benefits of comparing positive and multiple negative samples. As a result, although the model trained solely with SFT may improve the probability of positive items during training, it may overestimate the probability of unseen negative items during testing, leading to incorrect prediction. </figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To address this limitation, we propose Direct Multi-Preference Optimization (DMPO), a streamlined framework designed to maximize the probability of generating correct answers while simultaneously minimizing the probability of generating multiple incorrect answers under a dynamic margin. The motivation for introducing DMPO arises from the constraints of the original Direct Preference Optimization (DPO) <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib3" title="">dpo, </a>)</cite>, which considered only one positive sample and one negative sample from a user’s user-item interaction list, thereby restricting the diversity of training data and potential performance improvements. Drawing inspiration from contrastive learning methods that employ negative sampling strategies <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib69" title="">InstDisc, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib70" title="">InvaSpread, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib67" title="">MoCo, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib68" title="">simCLR, </a>)</cite>, DMPO incorporates sampling multiple negative samples to expand the range of negative samples. This allows the model to establish more comprehensive and balanced relationships between positive and negative samples, enhancing overall performance.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To evaluate the effectiveness of DMPO, we conducted extensive experiments on three real-world public datasets: <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">”Movielens-1M”</span>, <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">”Amazon Movies and TV”</span>, and <span class="ltx_text ltx_font_italic" id="S1.p4.1.3">”Amazon Video Games”</span>. DMPO aims to perform binary classification by distinguishing positive items from negative items, and then rank the likelihood of a user giving a high rating to these items. When generating the answer, the model is expected to prioritize the positive items over the negative items. More details of the dataset and task can be found in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS1" title="5.1. Dataset ‣ 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">5.1</span></a> and Section <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.SS1" title="4.1. Task Introduction ‣ 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">4.1</span></a>. Since DMPO utilizes user-item interaction lists, it is appropriate to compare it with LLM-based methods <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib2" title="">tallrec, </a>)</cite> and traditional sequential methods<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib13" title="">GCSAN, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib16" title="">STAMP, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib77" title="">SASRec, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib17" title="">GRU4Rec, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib12" title="">BERT4Rec, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib14" title="">SHAN, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib15" title="">CORE, </a>)</cite>. The results demonstrate that DMPO significantly improves AUC compared to other methods in a few-shot scenario. Furthermore, in order to validate the superior generalization ability of DMPO, we conducted experiments to compare it with other LLM-based cross-domain methods <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib2" title="">tallrec, </a>)</cite> and traditional cross-domain methods <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib9" title="">BiTGCF, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib6" title="">CMF, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib10" title="">CLFM, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib11" title="">DeepAPF, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib76" title="">DTCDR, </a>)</cite>. The results highlight DMPO’s breakthrough performance in cross-domain recommendation tasks. We also conducted ablation studies to investigate the factors that may affect the performance of DMPO, including the number of negative samples, the number of few-shot samples, and different base models. Additionally, we performed a case study to demonstrate the reasons why DMPO can bring improvements, and we highlighted that DMPO is an explainable recommendation system.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In total, our contributions are summarized as follows:</p>
</div>
<div class="ltx_para" id="S1.p6">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">In order to narrow the gap between LLMs and the recommendation tasks, we propose Direct Multi-Preference Optimization (DMPO). This streamlined framework enhances LLMs’ ability to model the comparative relationships between positive and negative samples for recommendation tasks.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Through the comprehensive experiments, we showcase that DMPO significantly outperforms the previous LLM-based and traditional methods;</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Moreover, DMPO’s consistent improvements across multiple domains and various types of LLMs empirically underscore its strong generalization and robustness.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>LLM-based recommendation systems</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">There have been various attempts to incorporate LLMs into recommendation systems. Despite the integration of LLMs <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib49" title="">geng2022recommendation, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib50" title="">li2023personalized, </a>)</cite>, some efforts focus on enhancing the recommendation capability of LLMs through in-context learning methods and combining them with traditional recommendation models like MF <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib56" title="">koren2009matrix, </a>)</cite> and LightGCN <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib4" title="">he2020lightgcn, </a>)</cite>, including Chat-rec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib54" title="">gao2023chat, </a>)</cite> and NIR <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib55" title="">wang2023zero, </a>)</cite>. However, certain approaches only depend on UserIDs and ItemIDs to represent users and items, disregarding the benefits of incorporating language information and leveraging the extensive knowledge of Language Models (LLMs) about the items. These methods might also encounter challenges in generalization due to limited training data for certain User/Item IDs <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib51" title="">hou2022towards, </a>)</cite>. Furthermore, some other works employ undisclosed models that possess initial recommendation capabilities <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib52" title="">cui2022m6, </a>)</cite>, or small models trained on large-scale downstream task data <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib53" title="">zhang2023prompt, </a>)</cite>. However, the capabilities of these methods are demonstrated to be limited by the smaller-scale models.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">We have also observed some methods that utilize the SFT approach to bridge the gap between natural language processing tasks and recommendations, such as TALLRec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib2" title="">tallrec, </a>)</cite>. TALLRec is a tuning framework for aligning LLMs with recommendations. However, solely relying on the SFT may only maximize the probability of generating the correct answer. To further enhance performance, we can introduce multiple incorrect answers into the system and establish pair-wise relationships between the correct and incorrect answers.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Sequential Recommendation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The user-item interaction list is utilized in DMPO, which is similar to the sequential recommendation. The sequential recommendation aims to predict the next item for a user based on their historical interactions with items <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib27" title="">fang2020deep, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib28" title="">wang2019sequential, </a>)</cite>. Initially, Markov chain models were prevalent in sequential recommendation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib29" title="">he2016fusing, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib30" title="">mahmood2007learning, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib31" title="">rendle2010factorizing, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib32" title="">wang2015learning, </a>)</cite>. In recent times, deep learning approaches have gained popularity, including those based on RNNs <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib33" title="">cui2018mv, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib34" title="">donkers2017sequential, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib17" title="">GRU4Rec, </a>)</cite>, CNNs <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib35" title="">tang2018personalized, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib36" title="">yan2019cosrec, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib37" title="">yuan2019simple, </a>)</cite>, and attention structures <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib12" title="">BERT4Rec, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib38" title="">kang2018self, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib39" title="">xu2021long, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib40" title="">zhang2019feature, </a>)</cite>. However, these models typically focus solely on UserID and ItemID, limiting their ability to generalize across different domains. Some recent studies have emphasized improving the generalization capability of sequential recommendation models through techniques like pre-training <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib41" title="">ouyang2022training, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib42" title="">yuan2020parameter, </a>)</cite>, data augmentation <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib43" title="">qiu2022contrastive, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib44" title="">wang2022multi, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib45" title="">xie2022contrastive, </a>)</cite>, debiasing <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib45" title="">xie2022contrastive, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib46" title="">wang2022unbiased, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib47" title="">zhang2021causal, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib48" title="">zheng2021disentangling, </a>)</cite>, and robust optimization <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib57" title="">wen2022distributionally, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib40" title="">zhang2019feature, </a>)</cite>. However, these methods typically use UserIDs and ItemIDs to represent users and items, which can lead to insufficient training when the training data is limited. As a result, the potential of leveraging the strong generalization ability of LLMs, trained on extensive data and likely possessing rich knowledge about common items, remains largely unexplored.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3. </span>Cross-domain Recommendation</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Transfer learning aims to utilize knowledge from a source domain to enhance learning performance in the target domain or reduce the number of labeled examples needed in the target domain when achieving the same performance. <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib19" title="">wang2022generalizing, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib20" title="">zhuang2020comprehensive, </a>)</cite>. Cross-Domain Recommendation (CDR), inspired by transfer learning, is a promising approach to address data sparsity and the cold-start issue in the target domain by leveraging the auxiliary (source) domain. Initially, CMF <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib21" title="">singh2008relational, </a>)</cite> assumes a shared global user embedding matrix for all domains and factorizes matrices from multiple domains simultaneously. CoNet <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib8" title="">CoNet, </a>)</cite> transfers and integrates knowledge through cross-connections in feed-forward neural networks. Another set of CDR methods focuses on connecting user preferences across different domains, as demonstrated by studies such as <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib22" title="">kang2019semi, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib23" title="">man2017cross, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib24" title="">pan2010transfer, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib25" title="">zhang2020learning, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib26" title="">zhu2020deep, </a>)</cite>. These methods either utilize the user embedding learned in the source domain to initialize the user embedding in the target domain and restrict them to being closed or explicitly model the preference bridge. All the above methods are involved in exacting information from the source domain and transferring it to the target domain; however, the limitation persists because all the user/item embeddings are built on certain user/item IDs. For LLMs, using natural language provides an excellent and natural medium to transfer the features learned across domains. Consequently, the potential of using LLM-based models to accomplish the cross-domain recommendation task still remains largely unexplored.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Preliminary</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we introduce preliminary knowledge of DMPO. In previous sections, we mentioned conceiving DMPO as a pair-wise ranking loss, which we consider as an important concept. We introduce what pair-wise ranking loss is and explain why DMPO shares a similar mathematical foundation with pair-wise ranking loss.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Pair-Wise Ranking loss</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Pair-wise ranking loss is a type of loss function used in supervised learning specifically for sorting problems. It calculates the loss by comparing the relative rankings of a pair of input elements. Commonly used options for this type of loss function include Hinge loss <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib66" title="">cortes1995support, </a>)</cite> and Bayesian Personalized Ranking (BPR) loss <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib65" title="">rendle2012bpr, </a>)</cite>, among others. In recommendation systems, pair-wise ranking loss is typically employed to establish the pair-wise relationship between positive items and negative items. To further illustrate this concept, the mathematical equation of BPR loss is presented in Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S3.E1" title="In 3.1. Pair-Wise Ranking loss ‣ 3. Preliminary ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{BPR}=-\sum_{(u,i,j)\in\mathcal{D}}\ln\sigma(f_{u}(i)-f_{u}(j))" class="ltx_Math" display="block" id="S3.E1.m1.6"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><msub id="S3.E1.m1.6.6.3" xref="S3.E1.m1.6.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.6.6.3.2" xref="S3.E1.m1.6.6.3.2.cmml">ℒ</mi><mrow id="S3.E1.m1.6.6.3.3" xref="S3.E1.m1.6.6.3.3.cmml"><mi id="S3.E1.m1.6.6.3.3.2" xref="S3.E1.m1.6.6.3.3.2.cmml">B</mi><mo id="S3.E1.m1.6.6.3.3.1" xref="S3.E1.m1.6.6.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.6.6.3.3.3" xref="S3.E1.m1.6.6.3.3.3.cmml">P</mi><mo id="S3.E1.m1.6.6.3.3.1a" xref="S3.E1.m1.6.6.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.6.6.3.3.4" xref="S3.E1.m1.6.6.3.3.4.cmml">R</mi></mrow></msub><mo id="S3.E1.m1.6.6.2" xref="S3.E1.m1.6.6.2.cmml">=</mo><mrow id="S3.E1.m1.6.6.1" xref="S3.E1.m1.6.6.1.cmml"><mo id="S3.E1.m1.6.6.1a" xref="S3.E1.m1.6.6.1.cmml">−</mo><mrow id="S3.E1.m1.6.6.1.1" xref="S3.E1.m1.6.6.1.1.cmml"><munder id="S3.E1.m1.6.6.1.1.2" xref="S3.E1.m1.6.6.1.1.2.cmml"><mo id="S3.E1.m1.6.6.1.1.2.2" movablelimits="false" xref="S3.E1.m1.6.6.1.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml"><mrow id="S3.E1.m1.3.3.3.5.2" xref="S3.E1.m1.3.3.3.5.1.cmml"><mo id="S3.E1.m1.3.3.3.5.2.1" stretchy="false" xref="S3.E1.m1.3.3.3.5.1.cmml">(</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">u</mi><mo id="S3.E1.m1.3.3.3.5.2.2" xref="S3.E1.m1.3.3.3.5.1.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">i</mi><mo id="S3.E1.m1.3.3.3.5.2.3" xref="S3.E1.m1.3.3.3.5.1.cmml">,</mo><mi id="S3.E1.m1.3.3.3.3" xref="S3.E1.m1.3.3.3.3.cmml">j</mi><mo id="S3.E1.m1.3.3.3.5.2.4" stretchy="false" xref="S3.E1.m1.3.3.3.5.1.cmml">)</mo></mrow><mo id="S3.E1.m1.3.3.3.4" xref="S3.E1.m1.3.3.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.3.6" xref="S3.E1.m1.3.3.3.6.cmml">𝒟</mi></mrow></munder><mrow id="S3.E1.m1.6.6.1.1.1" xref="S3.E1.m1.6.6.1.1.1.cmml"><mrow id="S3.E1.m1.6.6.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.3.cmml"><mi id="S3.E1.m1.6.6.1.1.1.3.1" xref="S3.E1.m1.6.6.1.1.1.3.1.cmml">ln</mi><mo id="S3.E1.m1.6.6.1.1.1.3a" lspace="0.167em" xref="S3.E1.m1.6.6.1.1.1.3.cmml">⁡</mo><mi id="S3.E1.m1.6.6.1.1.1.3.2" xref="S3.E1.m1.6.6.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E1.m1.6.6.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.6.6.1.1.1.1.1.1.2.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.2.cmml">f</mi><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.3.cmml">u</mi></msub><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.2.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.cmml"><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">i</mi><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.2.3.2.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.cmml"><msub id="S3.E1.m1.6.6.1.1.1.1.1.1.3.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.2.cmml">f</mi><mi id="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.3.cmml">u</mi></msub><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.3.1" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.cmml"><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">j</mi><mo id="S3.E1.m1.6.6.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.6.6.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><eq id="S3.E1.m1.6.6.2.cmml" xref="S3.E1.m1.6.6.2"></eq><apply id="S3.E1.m1.6.6.3.cmml" xref="S3.E1.m1.6.6.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.3.1.cmml" xref="S3.E1.m1.6.6.3">subscript</csymbol><ci id="S3.E1.m1.6.6.3.2.cmml" xref="S3.E1.m1.6.6.3.2">ℒ</ci><apply id="S3.E1.m1.6.6.3.3.cmml" xref="S3.E1.m1.6.6.3.3"><times id="S3.E1.m1.6.6.3.3.1.cmml" xref="S3.E1.m1.6.6.3.3.1"></times><ci id="S3.E1.m1.6.6.3.3.2.cmml" xref="S3.E1.m1.6.6.3.3.2">𝐵</ci><ci id="S3.E1.m1.6.6.3.3.3.cmml" xref="S3.E1.m1.6.6.3.3.3">𝑃</ci><ci id="S3.E1.m1.6.6.3.3.4.cmml" xref="S3.E1.m1.6.6.3.3.4">𝑅</ci></apply></apply><apply id="S3.E1.m1.6.6.1.cmml" xref="S3.E1.m1.6.6.1"><minus id="S3.E1.m1.6.6.1.2.cmml" xref="S3.E1.m1.6.6.1"></minus><apply id="S3.E1.m1.6.6.1.1.cmml" xref="S3.E1.m1.6.6.1.1"><apply id="S3.E1.m1.6.6.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.2.1.cmml" xref="S3.E1.m1.6.6.1.1.2">subscript</csymbol><sum id="S3.E1.m1.6.6.1.1.2.2.cmml" xref="S3.E1.m1.6.6.1.1.2.2"></sum><apply id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"><in id="S3.E1.m1.3.3.3.4.cmml" xref="S3.E1.m1.3.3.3.4"></in><vector id="S3.E1.m1.3.3.3.5.1.cmml" xref="S3.E1.m1.3.3.3.5.2"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑢</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑖</ci><ci id="S3.E1.m1.3.3.3.3.cmml" xref="S3.E1.m1.3.3.3.3">𝑗</ci></vector><ci id="S3.E1.m1.3.3.3.6.cmml" xref="S3.E1.m1.3.3.3.6">𝒟</ci></apply></apply><apply id="S3.E1.m1.6.6.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1"><times id="S3.E1.m1.6.6.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.2"></times><apply id="S3.E1.m1.6.6.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.1.3"><ln id="S3.E1.m1.6.6.1.1.1.3.1.cmml" xref="S3.E1.m1.6.6.1.1.1.3.1"></ln><ci id="S3.E1.m1.6.6.1.1.1.3.2.cmml" xref="S3.E1.m1.6.6.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1"><minus id="S3.E1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2"><times id="S3.E1.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.1"></times><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.2">𝑓</ci><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.2.2.3">𝑢</ci></apply><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑖</ci></apply><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3"><times id="S3.E1.m1.6.6.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.1"></times><apply id="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.2">𝑓</ci><ci id="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.6.6.1.1.1.1.1.1.3.2.3">𝑢</ci></apply><ci id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\mathcal{L}_{BPR}=-\sum_{(u,i,j)\in\mathcal{D}}\ln\sigma(f_{u}(i)-f_{u}(j))</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.6d">caligraphic_L start_POSTSUBSCRIPT italic_B italic_P italic_R end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT ( italic_u , italic_i , italic_j ) ∈ caligraphic_D end_POSTSUBSCRIPT roman_ln italic_σ ( italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_i ) - italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_j ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p2.11">where the <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">caligraphic_D</annotation></semantics></math> refers to the dataset, <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_u</annotation></semantics></math> refers to the user, <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_i</annotation></semantics></math> and <math alttext="j" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_j</annotation></semantics></math> denotes the positive and negative sample pair. <math alttext="f_{u}(i)" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.2" xref="S3.SS1.p2.5.m5.1.2.cmml"><msub id="S3.SS1.p2.5.m5.1.2.2" xref="S3.SS1.p2.5.m5.1.2.2.cmml"><mi id="S3.SS1.p2.5.m5.1.2.2.2" xref="S3.SS1.p2.5.m5.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p2.5.m5.1.2.2.3" xref="S3.SS1.p2.5.m5.1.2.2.3.cmml">u</mi></msub><mo id="S3.SS1.p2.5.m5.1.2.1" xref="S3.SS1.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.5.m5.1.2.3.2" xref="S3.SS1.p2.5.m5.1.2.cmml"><mo id="S3.SS1.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.5.m5.1.2.cmml">(</mo><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">i</mi><mo id="S3.SS1.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.2.cmml" xref="S3.SS1.p2.5.m5.1.2"><times id="S3.SS1.p2.5.m5.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2.1"></times><apply id="S3.SS1.p2.5.m5.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.2.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.2.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2.2.2">𝑓</ci><ci id="S3.SS1.p2.5.m5.1.2.2.3.cmml" xref="S3.SS1.p2.5.m5.1.2.2.3">𝑢</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">f_{u}(i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_i )</annotation></semantics></math> denotes the preference score for the user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mi id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><ci id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">italic_u</annotation></semantics></math> of the item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_i</annotation></semantics></math>. Commonly used preference score functions include cosine similarity and Pearson correlation coefficient. By utilizing the BPR loss, the <math alttext="f_{u}(i)" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mrow id="S3.SS1.p2.8.m8.1.2" xref="S3.SS1.p2.8.m8.1.2.cmml"><msub id="S3.SS1.p2.8.m8.1.2.2" xref="S3.SS1.p2.8.m8.1.2.2.cmml"><mi id="S3.SS1.p2.8.m8.1.2.2.2" xref="S3.SS1.p2.8.m8.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p2.8.m8.1.2.2.3" xref="S3.SS1.p2.8.m8.1.2.2.3.cmml">u</mi></msub><mo id="S3.SS1.p2.8.m8.1.2.1" xref="S3.SS1.p2.8.m8.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.8.m8.1.2.3.2" xref="S3.SS1.p2.8.m8.1.2.cmml"><mo id="S3.SS1.p2.8.m8.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.8.m8.1.2.cmml">(</mo><mi id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">i</mi><mo id="S3.SS1.p2.8.m8.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.2.cmml" xref="S3.SS1.p2.8.m8.1.2"><times id="S3.SS1.p2.8.m8.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.2.1"></times><apply id="S3.SS1.p2.8.m8.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.2.2.1.cmml" xref="S3.SS1.p2.8.m8.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.8.m8.1.2.2.2.cmml" xref="S3.SS1.p2.8.m8.1.2.2.2">𝑓</ci><ci id="S3.SS1.p2.8.m8.1.2.2.3.cmml" xref="S3.SS1.p2.8.m8.1.2.2.3">𝑢</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">f_{u}(i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_i )</annotation></semantics></math> is increased, while the <math alttext="f_{u}(j)" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.1"><semantics id="S3.SS1.p2.9.m9.1a"><mrow id="S3.SS1.p2.9.m9.1.2" xref="S3.SS1.p2.9.m9.1.2.cmml"><msub id="S3.SS1.p2.9.m9.1.2.2" xref="S3.SS1.p2.9.m9.1.2.2.cmml"><mi id="S3.SS1.p2.9.m9.1.2.2.2" xref="S3.SS1.p2.9.m9.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p2.9.m9.1.2.2.3" xref="S3.SS1.p2.9.m9.1.2.2.3.cmml">u</mi></msub><mo id="S3.SS1.p2.9.m9.1.2.1" xref="S3.SS1.p2.9.m9.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.9.m9.1.2.3.2" xref="S3.SS1.p2.9.m9.1.2.cmml"><mo id="S3.SS1.p2.9.m9.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.9.m9.1.2.cmml">(</mo><mi id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml">j</mi><mo id="S3.SS1.p2.9.m9.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.9.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.2.cmml" xref="S3.SS1.p2.9.m9.1.2"><times id="S3.SS1.p2.9.m9.1.2.1.cmml" xref="S3.SS1.p2.9.m9.1.2.1"></times><apply id="S3.SS1.p2.9.m9.1.2.2.cmml" xref="S3.SS1.p2.9.m9.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.2.2.1.cmml" xref="S3.SS1.p2.9.m9.1.2.2">subscript</csymbol><ci id="S3.SS1.p2.9.m9.1.2.2.2.cmml" xref="S3.SS1.p2.9.m9.1.2.2.2">𝑓</ci><ci id="S3.SS1.p2.9.m9.1.2.2.3.cmml" xref="S3.SS1.p2.9.m9.1.2.2.3">𝑢</ci></apply><ci id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">f_{u}(j)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.9.m9.1d">italic_f start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ( italic_j )</annotation></semantics></math> is decreased. Compare to the DMPO mathematical equations, which are shown in Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.E3" title="In 4.4. Direct Multiple Preference Optimization (DMPO) ‣ 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">3</span></a>. We found that the fundamental idea behind it is similar, except the DMPO
increases the likelihood of the preferred completions <math alttext="y_{w}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1"><semantics id="S3.SS1.p2.10.m10.1a"><msub id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml"><mi id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">y</mi><mi id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">𝑦</ci><ci id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.10.m10.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> and decreases the likelihood of dispreferred completions <math alttext="y_{l}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1"><semantics id="S3.SS1.p2.11.m11.1a"><msub id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">y</mi><mi id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2">𝑦</ci><ci id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.11.m11.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. The likelihood in the DMPO refers to the joint generating probability of multiple tokens.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Methodology</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we introduce the DMPO, a streamlined framework that aims to align LLMs with recommendation tasks.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="238" id="S4.F2.g1" src="x2.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>We first performed SFT on the base LLM model and then proceeded with DMPO. SFT samples and DMPO samples were constructed as inputs for training. Both SFT and DMPO were trained using LoRA. DMPO aims to maximize the probability of positive samples while minimizing the probability of multiple negative samples simultaneously.</figcaption>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Task Introduction</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.6">The DMPO is expected to distinguish whether the user enjoys the given items or not. The task is essentially a binary classification task. The user’s item preferences history is inputted into the prompt. A pair of items from the user-item interaction list is then offered to make the prediction. One of the items, denoted as <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_i</annotation></semantics></math>, has been rated highly by the user with a score greater than 3 out of 5, making it a positive sample. The other item, denoted as <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><ci id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">italic_j</annotation></semantics></math>, has received a low rating from the user, scoring lower than 3. The model is expected to determine that the user is more likely to enjoy the positive sample item <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m3.1d">italic_i</annotation></semantics></math> than the negative sample item <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m4.1d">italic_j</annotation></semantics></math> by generating a recommendation that ranks the likelihood of the user giving a high rating to the items, and placing the item <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m5.1d">italic_i</annotation></semantics></math> before the item <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m6.1d">italic_j</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Instruction Prompts</h3>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1. </span>An instruction tuning sample for DMPO. ”Roman Holiday” is the positive item, and the other movies serve as negative items. The order of positive and negative samples placed in the instruction input is randomly altered across different samples to prevent the LLMs from making predictions based on the input sequence.
</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.3" style="width:195.1pt;height:118.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-103.5pt,62.7pt) scale(0.485240410516711,0.485240410516711) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.3.1">
<tr class="ltx_tr" id="S4.T1.3.1.1">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.1.1.1" style="font-size:90%;">Task Input</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.1.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.3.1.2.1"><span class="ltx_text" id="S4.T1.3.1.2.1.1" style="font-size:90%;">Instruction:</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T1.3.1.2.2">
<span class="ltx_text" id="S4.T1.3.1.2.2.1"></span><span class="ltx_text" id="S4.T1.3.1.2.2.2" style="font-size:90%;">
<span class="ltx_tabular ltx_align_middle" id="S4.T1.3.1.2.2.2.1">
<span class="ltx_tr" id="S4.T1.3.1.2.2.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top" id="S4.T1.3.1.2.2.2.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.3.1.2.2.2.1.1.1.1">
<span class="ltx_p" id="S4.T1.3.1.2.2.2.1.1.1.1.1" style="width:227.6pt;">You are an assistant working on movie recommendations. Here is the user’s history of movies they have watched: ¡Waterloo Bridge¿, ¡Rear Window¿, ¡Forrest Gump¿. Rank the likelihood of the user watching the two movies</span>
</span></span></span>
<span class="ltx_tr" id="S4.T1.3.1.2.2.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top" id="S4.T1.3.1.2.2.2.1.2.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.3.1.2.2.2.1.2.1.1">
<span class="ltx_p" id="S4.T1.3.1.2.2.2.1.2.1.1.1" style="width:227.6pt;">(1) ¡Roman Holiday¿ and ¡Iron Man¿</span>
</span></span></span>
<span class="ltx_tr" id="S4.T1.3.1.2.2.2.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top" id="S4.T1.3.1.2.2.2.1.3.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.3.1.2.2.2.1.3.1.1">
<span class="ltx_p" id="S4.T1.3.1.2.2.2.1.3.1.1.1" style="width:227.6pt;">(2) ¡Harry Potter¿ and ¡Roman Holiday¿</span>
</span></span></span>
<span class="ltx_tr" id="S4.T1.3.1.2.2.2.1.4">
<span class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top" id="S4.T1.3.1.2.2.2.1.4.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.3.1.2.2.2.1.4.1.1">
<span class="ltx_p" id="S4.T1.3.1.2.2.2.1.4.1.1.1" style="width:227.6pt;">(3) ¡Roman Holiday¿ and ¡Spider Man¿</span>
</span></span></span>
<span class="ltx_tr" id="S4.T1.3.1.2.2.2.1.5">
<span class="ltx_td ltx_nopad_r ltx_align_justify ltx_align_top" id="S4.T1.3.1.2.2.2.1.5.1">
<span class="ltx_inline-block ltx_align_top" id="S4.T1.3.1.2.2.2.1.5.1.1">
<span class="ltx_p" id="S4.T1.3.1.2.2.2.1.5.1.1.1" style="width:227.6pt;">(4) ¡The Lion King¿ and ¡Roman Holiday¿</span>
</span></span></span>
</span></span><span class="ltx_text" id="S4.T1.3.1.2.2.3"></span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T1.3.1.3.1"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.3.1.1" style="font-size:90%;">Task Output</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.1.4">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T1.3.1.4.1" rowspan="4"><span class="ltx_text" id="S4.T1.3.1.4.1.1" style="font-size:90%;">DMPO Label:</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S4.T1.3.1.4.2"><span class="ltx_text" id="S4.T1.3.1.4.2.1" style="font-size:90%;">(1) [”¡Roman Holiday¿, ¡Iron Man¿”, ”¡Iron Man¿, ¡Roman Holiday¿”].</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.1.5">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T1.3.1.5.1"><span class="ltx_text" id="S4.T1.3.1.5.1.1" style="font-size:90%;">(2) [”¡Roman Holiday¿, ¡Harry Potter¿”, ”¡Harry Potter¿, ¡Roman Holiday¿”].</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.1.6">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S4.T1.3.1.6.1"><span class="ltx_text" id="S4.T1.3.1.6.1.1" style="font-size:90%;">(3) [”¡Roman Holiday¿, ¡Spider Man¿”, ”¡Spider Man¿, ¡Roman Holiday¿”].</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.1.7">
<td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" id="S4.T1.3.1.7.1"><span class="ltx_text" id="S4.T1.3.1.7.1.1" style="font-size:90%;">(4) [”¡Roman Holiday¿, ¡The Lion King¿”, ”¡The Lion King¿, ¡Roman Holiday¿”].</span></td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We provide an instruction sample for DMPO, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.T1" title="Table 1 ‣ 4.2. Instruction Prompts ‣ 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">1</span></a>. Firstly, construct the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.1">Task input</span>, which includes the model’s role settings, user-item interaction list, and positive and negative candidates. The order of positive and negative candidates in the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.2">Task input</span> should be randomly arranged to prevent the model from generating answers based on the input. In the user-item interaction list, only the item title is used and separated by ”¡¿” for easier identification by the model. In the <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.3">Task output</span>, for SFT, we only need to provide the correct answer as ”¡positive sample, negative sample¿”, with the positive sample listed before the negative sample. For DMPO, both the correct and incorrect answers should be provided in a list format ”[¡positive sample, negative sample¿, ¡negative sample, positive sample¿]”. In the case of multiple negative sampling, multiple negative samples should be provided.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Supervised Fine Tuning (SFT)</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">SFT involves fine-tuning Language Models (LLMs) for the recommendation task using positive samples. The main objective of it is to maximize the probability of each token in the correct answers. Additionally, SFT ensures that the answers generated by LLMs adhere to the correct format, avoiding ambiguous or evasive responses. The mathematical formula is shown in equation <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.E2" title="In 4.3. Supervised Fine Tuning (SFT) ‣ 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\max_{\Phi}\sum_{(x,y)\in\mathcal{D}}\sum_{t=1}^{|y|}\text{log}\left(P_{%
\Phi}(y_{t}|x,y_{&lt;t})\right)," class="ltx_Math" display="block" id="S4.E2.m1.5"><semantics id="S4.E2.m1.5a"><mrow id="S4.E2.m1.5.5.1" xref="S4.E2.m1.5.5.1.1.cmml"><mrow id="S4.E2.m1.5.5.1.1" xref="S4.E2.m1.5.5.1.1.cmml"><munder id="S4.E2.m1.5.5.1.1.3" xref="S4.E2.m1.5.5.1.1.3.cmml"><mi id="S4.E2.m1.5.5.1.1.3.2" mathsize="90%" xref="S4.E2.m1.5.5.1.1.3.2.cmml">max</mi><mi id="S4.E2.m1.5.5.1.1.3.3" mathsize="90%" mathvariant="normal" xref="S4.E2.m1.5.5.1.1.3.3.cmml">Φ</mi></munder><mo id="S4.E2.m1.5.5.1.1.2" xref="S4.E2.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.5.5.1.1.1" xref="S4.E2.m1.5.5.1.1.1.cmml"><munder id="S4.E2.m1.5.5.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.2.cmml"><mo id="S4.E2.m1.5.5.1.1.1.2.2" maxsize="90%" minsize="90%" movablelimits="false" rspace="0em" stretchy="true" xref="S4.E2.m1.5.5.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E2.m1.2.2.2" xref="S4.E2.m1.2.2.2.cmml"><mrow id="S4.E2.m1.2.2.2.4.2" xref="S4.E2.m1.2.2.2.4.1.cmml"><mo id="S4.E2.m1.2.2.2.4.2.1" maxsize="90%" minsize="90%" xref="S4.E2.m1.2.2.2.4.1.cmml">(</mo><mi id="S4.E2.m1.1.1.1.1" mathsize="90%" xref="S4.E2.m1.1.1.1.1.cmml">x</mi><mo id="S4.E2.m1.2.2.2.4.2.2" mathsize="90%" xref="S4.E2.m1.2.2.2.4.1.cmml">,</mo><mi id="S4.E2.m1.2.2.2.2" mathsize="90%" xref="S4.E2.m1.2.2.2.2.cmml">y</mi><mo id="S4.E2.m1.2.2.2.4.2.3" maxsize="90%" minsize="90%" xref="S4.E2.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S4.E2.m1.2.2.2.3" mathsize="90%" xref="S4.E2.m1.2.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.2.2.2.5" mathsize="90%" xref="S4.E2.m1.2.2.2.5.cmml">𝒟</mi></mrow></munder><mrow id="S4.E2.m1.5.5.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.cmml"><munderover id="S4.E2.m1.5.5.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.2.cmml"><mo id="S4.E2.m1.5.5.1.1.1.1.2.2.2" maxsize="90%" minsize="90%" movablelimits="false" stretchy="true" xref="S4.E2.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.2.2.3" xref="S4.E2.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.2.2.3.2" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S4.E2.m1.5.5.1.1.1.1.2.2.3.1" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E2.m1.5.5.1.1.1.1.2.2.3.3" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E2.m1.3.3.1.3" xref="S4.E2.m1.3.3.1.2.cmml"><mo id="S4.E2.m1.3.3.1.3.1" maxsize="90%" minsize="90%" xref="S4.E2.m1.3.3.1.2.1.cmml">|</mo><mi id="S4.E2.m1.3.3.1.1" mathsize="90%" xref="S4.E2.m1.3.3.1.1.cmml">y</mi><mo id="S4.E2.m1.3.3.1.3.2" maxsize="90%" minsize="90%" xref="S4.E2.m1.3.3.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S4.E2.m1.5.5.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.cmml"><mtext id="S4.E2.m1.5.5.1.1.1.1.1.3" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.3a.cmml">log</mtext><mo id="S4.E2.m1.5.5.1.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">P</mi><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3" mathsize="90%" mathvariant="normal" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml">Φ</mi></msub><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E2.m1.4.4" mathsize="90%" xref="S4.E2.m1.4.4.cmml">x</mi><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E2.m1.5.5.1.2" mathsize="90%" xref="S4.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.5b"><apply id="S4.E2.m1.5.5.1.1.cmml" xref="S4.E2.m1.5.5.1"><times id="S4.E2.m1.5.5.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.2"></times><apply id="S4.E2.m1.5.5.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.3">subscript</csymbol><max id="S4.E2.m1.5.5.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.3.2"></max><ci id="S4.E2.m1.5.5.1.1.3.3.cmml" xref="S4.E2.m1.5.5.1.1.3.3">Φ</ci></apply><apply id="S4.E2.m1.5.5.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1"><apply id="S4.E2.m1.5.5.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.5.5.1.1.1.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.2.2"></sum><apply id="S4.E2.m1.2.2.2.cmml" xref="S4.E2.m1.2.2.2"><in id="S4.E2.m1.2.2.2.3.cmml" xref="S4.E2.m1.2.2.2.3"></in><interval closure="open" id="S4.E2.m1.2.2.2.4.1.cmml" xref="S4.E2.m1.2.2.2.4.2"><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑥</ci><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝑦</ci></interval><ci id="S4.E2.m1.2.2.2.5.cmml" xref="S4.E2.m1.2.2.2.5">𝒟</ci></apply></apply><apply id="S4.E2.m1.5.5.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1"><apply id="S4.E2.m1.5.5.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.5.5.1.1.1.1.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2.2.2"></sum><apply id="S4.E2.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2.2.3"><eq id="S4.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="S4.E2.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S4.E2.m1.5.5.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E2.m1.3.3.1.2.cmml" xref="S4.E2.m1.3.3.1.3"><abs id="S4.E2.m1.3.3.1.2.1.cmml" xref="S4.E2.m1.3.3.1.3.1"></abs><ci id="S4.E2.m1.3.3.1.1.cmml" xref="S4.E2.m1.3.3.1.1">𝑦</ci></apply></apply><apply id="S4.E2.m1.5.5.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1"><times id="S4.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.2"></times><ci id="S4.E2.m1.5.5.1.1.1.1.1.3a.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.3"><mtext id="S4.E2.m1.5.5.1.1.1.1.1.3.cmml" mathsize="90%" xref="S4.E2.m1.5.5.1.1.1.1.1.3">log</mtext></ci><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1"><times id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.2"></times><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝑃</ci><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3">Φ</ci></apply><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S4.E2.m1.4.4.cmml" xref="S4.E2.m1.4.4">𝑥</ci><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.5c">\small\max_{\Phi}\sum_{(x,y)\in\mathcal{D}}\sum_{t=1}^{|y|}\text{log}\left(P_{%
\Phi}(y_{t}|x,y_{&lt;t})\right),</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.5d">roman_max start_POSTSUBSCRIPT roman_Φ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( italic_x , italic_y ) ∈ caligraphic_D end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_y | end_POSTSUPERSCRIPT log ( italic_P start_POSTSUBSCRIPT roman_Φ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x , italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p2.9">where <math alttext="x" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_y</annotation></semantics></math> represent the ”<span class="ltx_text ltx_font_italic" id="S4.SS3.p2.9.1">Task Input</span>” and ”<span class="ltx_text ltx_font_italic" id="S4.SS3.p2.9.2">Task Output</span>” in the instruction tuning data, respectively, <math alttext="y_{t}" class="ltx_Math" display="inline" id="S4.SS3.p2.3.m3.1"><semantics id="S4.SS3.p2.3.m3.1a"><msub id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml">y</mi><mi id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">𝑦</ci><ci id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="t" class="ltx_Math" display="inline" id="S4.SS3.p2.4.m4.1"><semantics id="S4.SS3.p2.4.m4.1a"><mi id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.1b"><ci id="S4.SS3.p2.4.m4.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.4.m4.1d">italic_t</annotation></semantics></math>-th token of the <math alttext="y" class="ltx_Math" display="inline" id="S4.SS3.p2.5.m5.1"><semantics id="S4.SS3.p2.5.m5.1a"><mi id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><ci id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.5.m5.1d">italic_y</annotation></semantics></math>, <math alttext="y_{&lt;t}" class="ltx_Math" display="inline" id="S4.SS3.p2.6.m6.1"><semantics id="S4.SS3.p2.6.m6.1a"><msub id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml"><mi id="S4.SS3.p2.6.m6.1.1.2" xref="S4.SS3.p2.6.m6.1.1.2.cmml">y</mi><mrow id="S4.SS3.p2.6.m6.1.1.3" xref="S4.SS3.p2.6.m6.1.1.3.cmml"><mi id="S4.SS3.p2.6.m6.1.1.3.2" xref="S4.SS3.p2.6.m6.1.1.3.2.cmml"></mi><mo id="S4.SS3.p2.6.m6.1.1.3.1" xref="S4.SS3.p2.6.m6.1.1.3.1.cmml">&lt;</mo><mi id="S4.SS3.p2.6.m6.1.1.3.3" xref="S4.SS3.p2.6.m6.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m6.1b"><apply id="S4.SS3.p2.6.m6.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m6.1.1.1.cmml" xref="S4.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p2.6.m6.1.1.2.cmml" xref="S4.SS3.p2.6.m6.1.1.2">𝑦</ci><apply id="S4.SS3.p2.6.m6.1.1.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3"><lt id="S4.SS3.p2.6.m6.1.1.3.1.cmml" xref="S4.SS3.p2.6.m6.1.1.3.1"></lt><csymbol cd="latexml" id="S4.SS3.p2.6.m6.1.1.3.2.cmml" xref="S4.SS3.p2.6.m6.1.1.3.2">absent</csymbol><ci id="S4.SS3.p2.6.m6.1.1.3.3.cmml" xref="S4.SS3.p2.6.m6.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m6.1c">y_{&lt;t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.6.m6.1d">italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the tokens before <math alttext="y_{t}" class="ltx_Math" display="inline" id="S4.SS3.p2.7.m7.1"><semantics id="S4.SS3.p2.7.m7.1a"><msub id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml"><mi id="S4.SS3.p2.7.m7.1.1.2" xref="S4.SS3.p2.7.m7.1.1.2.cmml">y</mi><mi id="S4.SS3.p2.7.m7.1.1.3" xref="S4.SS3.p2.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m7.1b"><apply id="S4.SS3.p2.7.m7.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m7.1.1.1.cmml" xref="S4.SS3.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p2.7.m7.1.1.2.cmml" xref="S4.SS3.p2.7.m7.1.1.2">𝑦</ci><ci id="S4.SS3.p2.7.m7.1.1.3.cmml" xref="S4.SS3.p2.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m7.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.7.m7.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>,
<math alttext="\Phi" class="ltx_Math" display="inline" id="S4.SS3.p2.8.m8.1"><semantics id="S4.SS3.p2.8.m8.1a"><mi id="S4.SS3.p2.8.m8.1.1" mathvariant="normal" xref="S4.SS3.p2.8.m8.1.1.cmml">Φ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.8.m8.1b"><ci id="S4.SS3.p2.8.m8.1.1.cmml" xref="S4.SS3.p2.8.m8.1.1">Φ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.8.m8.1c">\Phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.8.m8.1d">roman_Φ</annotation></semantics></math> is the original parameters of the model, and <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS3.p2.9.m9.1"><semantics id="S4.SS3.p2.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.9.m9.1.1" xref="S4.SS3.p2.9.m9.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.9.m9.1b"><ci id="S4.SS3.p2.9.m9.1.1.cmml" xref="S4.SS3.p2.9.m9.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.9.m9.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.9.m9.1d">caligraphic_D</annotation></semantics></math> is the training set.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Direct Multiple Preference Optimization (DMPO)</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">DMPO builds upon SFT by not only maximizing the probability of generating correct answers but also minimizing the probability of generating multiple negative samples. This helps the model learn and establish the subtle and complex relationships between positive and negative samples, enabling it to capture their differences and connections. Additionally, DMPO helps suppress the generation probability of key tokens in negative samples. The introduction of multiple negative sampling in DMPO expands the range of sampled negative samples compared to the original DPO<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib3" title="">dpo, </a>)</cite>, promoting a more diverse and uniform learning of negative samples. This enhancement ultimately improves the performance of the model. The mathematical formula of DMPO is shown in the equation below:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E3X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{DMPO}}(\pi_{\theta};\pi_{ref})=-\mathbb{E}_{(x%
,y_{w},y_{l})\sim\mathcal{D}}" class="ltx_Math" display="inline" id="S4.E3X.2.1.1.m1.5"><semantics id="S4.E3X.2.1.1.m1.5a"><mrow id="S4.E3X.2.1.1.m1.5.5" xref="S4.E3X.2.1.1.m1.5.5.cmml"><mrow id="S4.E3X.2.1.1.m1.5.5.2" xref="S4.E3X.2.1.1.m1.5.5.2.cmml"><msub id="S4.E3X.2.1.1.m1.5.5.2.4" xref="S4.E3X.2.1.1.m1.5.5.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3X.2.1.1.m1.5.5.2.4.2" xref="S4.E3X.2.1.1.m1.5.5.2.4.2.cmml">ℒ</mi><mtext id="S4.E3X.2.1.1.m1.5.5.2.4.3" xref="S4.E3X.2.1.1.m1.5.5.2.4.3a.cmml">DMPO</mtext></msub><mo id="S4.E3X.2.1.1.m1.5.5.2.3" xref="S4.E3X.2.1.1.m1.5.5.2.3.cmml">⁢</mo><mrow id="S4.E3X.2.1.1.m1.5.5.2.2.2" xref="S4.E3X.2.1.1.m1.5.5.2.2.3.cmml"><mo id="S4.E3X.2.1.1.m1.5.5.2.2.2.3" stretchy="false" xref="S4.E3X.2.1.1.m1.5.5.2.2.3.cmml">(</mo><msub id="S4.E3X.2.1.1.m1.4.4.1.1.1.1" xref="S4.E3X.2.1.1.m1.4.4.1.1.1.1.cmml"><mi id="S4.E3X.2.1.1.m1.4.4.1.1.1.1.2" xref="S4.E3X.2.1.1.m1.4.4.1.1.1.1.2.cmml">π</mi><mi id="S4.E3X.2.1.1.m1.4.4.1.1.1.1.3" xref="S4.E3X.2.1.1.m1.4.4.1.1.1.1.3.cmml">θ</mi></msub><mo id="S4.E3X.2.1.1.m1.5.5.2.2.2.4" xref="S4.E3X.2.1.1.m1.5.5.2.2.3.cmml">;</mo><msub id="S4.E3X.2.1.1.m1.5.5.2.2.2.2" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.cmml"><mi id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.2" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.2.cmml">π</mi><mrow id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.cmml"><mi id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.2" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.cmml">r</mi><mo id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.1" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.3" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.cmml">e</mi><mo id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.1a" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.4" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.4.cmml">f</mi></mrow></msub><mo id="S4.E3X.2.1.1.m1.5.5.2.2.2.5" stretchy="false" xref="S4.E3X.2.1.1.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E3X.2.1.1.m1.5.5.3" xref="S4.E3X.2.1.1.m1.5.5.3.cmml">=</mo><mrow id="S4.E3X.2.1.1.m1.5.5.4" xref="S4.E3X.2.1.1.m1.5.5.4.cmml"><mo id="S4.E3X.2.1.1.m1.5.5.4a" xref="S4.E3X.2.1.1.m1.5.5.4.cmml">−</mo><msub id="S4.E3X.2.1.1.m1.5.5.4.2" xref="S4.E3X.2.1.1.m1.5.5.4.2.cmml"><mi id="S4.E3X.2.1.1.m1.5.5.4.2.2" xref="S4.E3X.2.1.1.m1.5.5.4.2.2.cmml">𝔼</mi><mrow id="S4.E3X.2.1.1.m1.3.3.3" xref="S4.E3X.2.1.1.m1.3.3.3.cmml"><mrow id="S4.E3X.2.1.1.m1.3.3.3.3.2" xref="S4.E3X.2.1.1.m1.3.3.3.3.3.cmml"><mo id="S4.E3X.2.1.1.m1.3.3.3.3.2.3" stretchy="false" xref="S4.E3X.2.1.1.m1.3.3.3.3.3.cmml">(</mo><mi id="S4.E3X.2.1.1.m1.1.1.1.1" xref="S4.E3X.2.1.1.m1.1.1.1.1.cmml">x</mi><mo id="S4.E3X.2.1.1.m1.3.3.3.3.2.4" xref="S4.E3X.2.1.1.m1.3.3.3.3.3.cmml">,</mo><msub id="S4.E3X.2.1.1.m1.2.2.2.2.1.1" xref="S4.E3X.2.1.1.m1.2.2.2.2.1.1.cmml"><mi id="S4.E3X.2.1.1.m1.2.2.2.2.1.1.2" xref="S4.E3X.2.1.1.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="S4.E3X.2.1.1.m1.2.2.2.2.1.1.3" xref="S4.E3X.2.1.1.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="S4.E3X.2.1.1.m1.3.3.3.3.2.5" xref="S4.E3X.2.1.1.m1.3.3.3.3.3.cmml">,</mo><msub id="S4.E3X.2.1.1.m1.3.3.3.3.2.2" xref="S4.E3X.2.1.1.m1.3.3.3.3.2.2.cmml"><mi id="S4.E3X.2.1.1.m1.3.3.3.3.2.2.2" xref="S4.E3X.2.1.1.m1.3.3.3.3.2.2.2.cmml">y</mi><mi id="S4.E3X.2.1.1.m1.3.3.3.3.2.2.3" xref="S4.E3X.2.1.1.m1.3.3.3.3.2.2.3.cmml">l</mi></msub><mo id="S4.E3X.2.1.1.m1.3.3.3.3.2.6" stretchy="false" xref="S4.E3X.2.1.1.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="S4.E3X.2.1.1.m1.3.3.3.4" xref="S4.E3X.2.1.1.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E3X.2.1.1.m1.3.3.3.5" xref="S4.E3X.2.1.1.m1.3.3.3.5.cmml">𝒟</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3X.2.1.1.m1.5b"><apply id="S4.E3X.2.1.1.m1.5.5.cmml" xref="S4.E3X.2.1.1.m1.5.5"><eq id="S4.E3X.2.1.1.m1.5.5.3.cmml" xref="S4.E3X.2.1.1.m1.5.5.3"></eq><apply id="S4.E3X.2.1.1.m1.5.5.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.2"><times id="S4.E3X.2.1.1.m1.5.5.2.3.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.3"></times><apply id="S4.E3X.2.1.1.m1.5.5.2.4.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.4"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.5.5.2.4.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.4">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.5.5.2.4.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.4.2">ℒ</ci><ci id="S4.E3X.2.1.1.m1.5.5.2.4.3a.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.4.3"><mtext id="S4.E3X.2.1.1.m1.5.5.2.4.3.cmml" mathsize="70%" xref="S4.E3X.2.1.1.m1.5.5.2.4.3">DMPO</mtext></ci></apply><list id="S4.E3X.2.1.1.m1.5.5.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2"><apply id="S4.E3X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.4.4.1.1.1.1.2">𝜋</ci><ci id="S4.E3X.2.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S4.E3X.2.1.1.m1.4.4.1.1.1.1.3">𝜃</ci></apply><apply id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.2">𝜋</ci><apply id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3"><times id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.1"></times><ci id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.2">𝑟</ci><ci id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.3">𝑒</ci><ci id="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.4.cmml" xref="S4.E3X.2.1.1.m1.5.5.2.2.2.2.3.4">𝑓</ci></apply></apply></list></apply><apply id="S4.E3X.2.1.1.m1.5.5.4.cmml" xref="S4.E3X.2.1.1.m1.5.5.4"><minus id="S4.E3X.2.1.1.m1.5.5.4.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.4"></minus><apply id="S4.E3X.2.1.1.m1.5.5.4.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.4.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.5.5.4.2.1.cmml" xref="S4.E3X.2.1.1.m1.5.5.4.2">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.5.5.4.2.2.cmml" xref="S4.E3X.2.1.1.m1.5.5.4.2.2">𝔼</ci><apply id="S4.E3X.2.1.1.m1.3.3.3.cmml" xref="S4.E3X.2.1.1.m1.3.3.3"><csymbol cd="latexml" id="S4.E3X.2.1.1.m1.3.3.3.4.cmml" xref="S4.E3X.2.1.1.m1.3.3.3.4">similar-to</csymbol><vector id="S4.E3X.2.1.1.m1.3.3.3.3.3.cmml" xref="S4.E3X.2.1.1.m1.3.3.3.3.2"><ci id="S4.E3X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.1.1.1.1">𝑥</ci><apply id="S4.E3X.2.1.1.m1.2.2.2.2.1.1.cmml" xref="S4.E3X.2.1.1.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.2.2.2.2.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.2.2.2.2.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S4.E3X.2.1.1.m1.2.2.2.2.1.1.3.cmml" xref="S4.E3X.2.1.1.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="S4.E3X.2.1.1.m1.3.3.3.3.2.2.cmml" xref="S4.E3X.2.1.1.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.3.3.3.3.2.2.1.cmml" xref="S4.E3X.2.1.1.m1.3.3.3.3.2.2">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.3.3.3.3.2.2.2.cmml" xref="S4.E3X.2.1.1.m1.3.3.3.3.2.2.2">𝑦</ci><ci id="S4.E3X.2.1.1.m1.3.3.3.3.2.2.3.cmml" xref="S4.E3X.2.1.1.m1.3.3.3.3.2.2.3">𝑙</ci></apply></vector><ci id="S4.E3X.2.1.1.m1.3.3.3.5.cmml" xref="S4.E3X.2.1.1.m1.3.3.3.5">𝒟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3X.2.1.1.m1.5c">\displaystyle\mathcal{L}_{\text{DMPO}}(\pi_{\theta};\pi_{ref})=-\mathbb{E}_{(x%
,y_{w},y_{l})\sim\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S4.E3X.2.1.1.m1.5d">caligraphic_L start_POSTSUBSCRIPT DMPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_π start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT ) = - blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\left[\log\sigma\left(\beta\log\frac{\pi_{\theta}(y_{w}\mid x)}{%
\pi_{ref}(y_{w}\mid x)}-\frac{1}{k}\sum_{i=1}^{k}(\beta\log\frac{\pi_{\theta}(%
y_{l\ i}\mid x_{i})}{\pi_{ref}(y_{l\ i}\mid x_{i}))}\right)\right]" class="ltx_math_unparsed" display="inline" id="S4.E3Xa.2.1.1.m1.3"><semantics id="S4.E3Xa.2.1.1.m1.3a"><mrow id="S4.E3Xa.2.1.1.m1.3b"><mo id="S4.E3Xa.2.1.1.m1.3.4">[</mo><mi id="S4.E3Xa.2.1.1.m1.3.5">log</mi><mi id="S4.E3Xa.2.1.1.m1.3.6">σ</mi><mrow id="S4.E3Xa.2.1.1.m1.3.7"><mo id="S4.E3Xa.2.1.1.m1.3.7.1">(</mo><mi id="S4.E3Xa.2.1.1.m1.3.7.2">β</mi><mi id="S4.E3Xa.2.1.1.m1.3.7.3">log</mi><mstyle displaystyle="true" id="S4.E3Xa.2.1.1.m1.2.2"><mfrac id="S4.E3Xa.2.1.1.m1.2.2a"><mrow id="S4.E3Xa.2.1.1.m1.1.1.1"><msub id="S4.E3Xa.2.1.1.m1.1.1.1.3"><mi id="S4.E3Xa.2.1.1.m1.1.1.1.3.2">π</mi><mi id="S4.E3Xa.2.1.1.m1.1.1.1.3.3">θ</mi></msub><mo id="S4.E3Xa.2.1.1.m1.1.1.1.2">⁢</mo><mrow id="S4.E3Xa.2.1.1.m1.1.1.1.1.1"><mo id="S4.E3Xa.2.1.1.m1.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S4.E3Xa.2.1.1.m1.1.1.1.1.1.1"><msub id="S4.E3Xa.2.1.1.m1.1.1.1.1.1.1.2"><mi id="S4.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.2">y</mi><mi id="S4.E3Xa.2.1.1.m1.1.1.1.1.1.1.2.3">w</mi></msub><mo id="S4.E3Xa.2.1.1.m1.1.1.1.1.1.1.1">∣</mo><mi id="S4.E3Xa.2.1.1.m1.1.1.1.1.1.1.3">x</mi></mrow><mo id="S4.E3Xa.2.1.1.m1.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S4.E3Xa.2.1.1.m1.2.2.2"><msub id="S4.E3Xa.2.1.1.m1.2.2.2.3"><mi id="S4.E3Xa.2.1.1.m1.2.2.2.3.2">π</mi><mrow id="S4.E3Xa.2.1.1.m1.2.2.2.3.3"><mi id="S4.E3Xa.2.1.1.m1.2.2.2.3.3.2">r</mi><mo id="S4.E3Xa.2.1.1.m1.2.2.2.3.3.1">⁢</mo><mi id="S4.E3Xa.2.1.1.m1.2.2.2.3.3.3">e</mi><mo id="S4.E3Xa.2.1.1.m1.2.2.2.3.3.1a">⁢</mo><mi id="S4.E3Xa.2.1.1.m1.2.2.2.3.3.4">f</mi></mrow></msub><mo id="S4.E3Xa.2.1.1.m1.2.2.2.2">⁢</mo><mrow id="S4.E3Xa.2.1.1.m1.2.2.2.1.1"><mo id="S4.E3Xa.2.1.1.m1.2.2.2.1.1.2" stretchy="false">(</mo><mrow id="S4.E3Xa.2.1.1.m1.2.2.2.1.1.1"><msub id="S4.E3Xa.2.1.1.m1.2.2.2.1.1.1.2"><mi id="S4.E3Xa.2.1.1.m1.2.2.2.1.1.1.2.2">y</mi><mi id="S4.E3Xa.2.1.1.m1.2.2.2.1.1.1.2.3">w</mi></msub><mo id="S4.E3Xa.2.1.1.m1.2.2.2.1.1.1.1">∣</mo><mi id="S4.E3Xa.2.1.1.m1.2.2.2.1.1.1.3">x</mi></mrow><mo id="S4.E3Xa.2.1.1.m1.2.2.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mfrac></mstyle><mo id="S4.E3Xa.2.1.1.m1.3.7.4">−</mo><mstyle displaystyle="true" id="S4.E3Xa.2.1.1.m1.3.7.5"><mfrac id="S4.E3Xa.2.1.1.m1.3.7.5a"><mn id="S4.E3Xa.2.1.1.m1.3.7.5.2">1</mn><mi id="S4.E3Xa.2.1.1.m1.3.7.5.3">k</mi></mfrac></mstyle><mstyle displaystyle="true" id="S4.E3Xa.2.1.1.m1.3.7.6"><munderover id="S4.E3Xa.2.1.1.m1.3.7.6a"><mo id="S4.E3Xa.2.1.1.m1.3.7.6.2.2" movablelimits="false">∑</mo><mrow id="S4.E3Xa.2.1.1.m1.3.7.6.2.3"><mi id="S4.E3Xa.2.1.1.m1.3.7.6.2.3.2">i</mi><mo id="S4.E3Xa.2.1.1.m1.3.7.6.2.3.1">=</mo><mn id="S4.E3Xa.2.1.1.m1.3.7.6.2.3.3">1</mn></mrow><mi id="S4.E3Xa.2.1.1.m1.3.7.6.3">k</mi></munderover></mstyle><mrow id="S4.E3Xa.2.1.1.m1.3.7.7"><mo id="S4.E3Xa.2.1.1.m1.3.7.7.1" stretchy="false">(</mo><mi id="S4.E3Xa.2.1.1.m1.3.7.7.2">β</mi><mi id="S4.E3Xa.2.1.1.m1.3.7.7.3">log</mi><mstyle displaystyle="true" id="S4.E3Xa.2.1.1.m1.3.3"><mfrac id="S4.E3Xa.2.1.1.m1.3.3a"><mrow id="S4.E3Xa.2.1.1.m1.3.3.1"><msub id="S4.E3Xa.2.1.1.m1.3.3.1.3"><mi id="S4.E3Xa.2.1.1.m1.3.3.1.3.2">π</mi><mi id="S4.E3Xa.2.1.1.m1.3.3.1.3.3">θ</mi></msub><mo id="S4.E3Xa.2.1.1.m1.3.3.1.2">⁢</mo><mrow id="S4.E3Xa.2.1.1.m1.3.3.1.1.1"><mo id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.2" stretchy="false">(</mo><mrow id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1"><msub id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.2"><mi id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.2.2">y</mi><mrow id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.2.3"><mi id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.2.3.2">l</mi><mo id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.2.3.1" lspace="0.350em">⁢</mo><mi id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.2.3.3">i</mi></mrow></msub><mo id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.1">∣</mo><msub id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.3"><mi id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2">x</mi><mi id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.3">i</mi></msub></mrow><mo id="S4.E3Xa.2.1.1.m1.3.3.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S4.E3Xa.2.1.1.m1.3.3.3"><msub id="S4.E3Xa.2.1.1.m1.3.3.3.1"><mi id="S4.E3Xa.2.1.1.m1.3.3.3.1.2">π</mi><mrow id="S4.E3Xa.2.1.1.m1.3.3.3.1.3"><mi id="S4.E3Xa.2.1.1.m1.3.3.3.1.3.2">r</mi><mo id="S4.E3Xa.2.1.1.m1.3.3.3.1.3.1">⁢</mo><mi id="S4.E3Xa.2.1.1.m1.3.3.3.1.3.3">e</mi><mo id="S4.E3Xa.2.1.1.m1.3.3.3.1.3.1a">⁢</mo><mi id="S4.E3Xa.2.1.1.m1.3.3.3.1.3.4">f</mi></mrow></msub><mrow id="S4.E3Xa.2.1.1.m1.3.3.3.2"><mo id="S4.E3Xa.2.1.1.m1.3.3.3.2.1" stretchy="false">(</mo><msub id="S4.E3Xa.2.1.1.m1.3.3.3.2.2"><mi id="S4.E3Xa.2.1.1.m1.3.3.3.2.2.2">y</mi><mrow id="S4.E3Xa.2.1.1.m1.3.3.3.2.2.3"><mi id="S4.E3Xa.2.1.1.m1.3.3.3.2.2.3.2">l</mi><mo id="S4.E3Xa.2.1.1.m1.3.3.3.2.2.3.1" lspace="0.350em">⁢</mo><mi id="S4.E3Xa.2.1.1.m1.3.3.3.2.2.3.3">i</mi></mrow></msub><mo id="S4.E3Xa.2.1.1.m1.3.3.3.2.3" lspace="0em" rspace="0.167em">∣</mo><msub id="S4.E3Xa.2.1.1.m1.3.3.3.2.4"><mi id="S4.E3Xa.2.1.1.m1.3.3.3.2.4.2">x</mi><mi id="S4.E3Xa.2.1.1.m1.3.3.3.2.4.3">i</mi></msub><mo id="S4.E3Xa.2.1.1.m1.3.3.3.2.5" stretchy="false">)</mo></mrow><mo id="S4.E3Xa.2.1.1.m1.3.3.3.3" stretchy="false">)</mo></mrow></mfrac></mstyle><mo id="S4.E3Xa.2.1.1.m1.3.7.7.4">)</mo></mrow><mo id="S4.E3Xa.2.1.1.m1.3.7.8">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.E3Xa.2.1.1.m1.3c">\displaystyle\left[\log\sigma\left(\beta\log\frac{\pi_{\theta}(y_{w}\mid x)}{%
\pi_{ref}(y_{w}\mid x)}-\frac{1}{k}\sum_{i=1}^{k}(\beta\log\frac{\pi_{\theta}(%
y_{l\ i}\mid x_{i})}{\pi_{ref}(y_{l\ i}\mid x_{i}))}\right)\right]</annotation><annotation encoding="application/x-llamapun" id="S4.E3Xa.2.1.1.m1.3d">[ roman_log italic_σ ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∣ italic_x ) end_ARG - divide start_ARG 1 end_ARG start_ARG italic_k end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l italic_i end_POSTSUBSCRIPT ∣ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l italic_i end_POSTSUBSCRIPT ∣ italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) end_ARG ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.8">where <math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_k</annotation></semantics></math> represents the number of negative samples, <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><msub id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2" xref="S4.SS4.p2.2.m2.1.1.2.cmml">π</mi><mi id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2">𝜋</ci><ci id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> represents the language model policy, <math alttext="\pi_{ref}" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.1"><semantics id="S4.SS4.p2.3.m3.1a"><msub id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2" xref="S4.SS4.p2.3.m3.1.1.2.cmml">π</mi><mrow id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml"><mi id="S4.SS4.p2.3.m3.1.1.3.2" xref="S4.SS4.p2.3.m3.1.1.3.2.cmml">r</mi><mo id="S4.SS4.p2.3.m3.1.1.3.1" xref="S4.SS4.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.3.m3.1.1.3.3" xref="S4.SS4.p2.3.m3.1.1.3.3.cmml">e</mi><mo id="S4.SS4.p2.3.m3.1.1.3.1a" xref="S4.SS4.p2.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p2.3.m3.1.1.3.4" xref="S4.SS4.p2.3.m3.1.1.3.4.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2">𝜋</ci><apply id="S4.SS4.p2.3.m3.1.1.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3"><times id="S4.SS4.p2.3.m3.1.1.3.1.cmml" xref="S4.SS4.p2.3.m3.1.1.3.1"></times><ci id="S4.SS4.p2.3.m3.1.1.3.2.cmml" xref="S4.SS4.p2.3.m3.1.1.3.2">𝑟</ci><ci id="S4.SS4.p2.3.m3.1.1.3.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3.3">𝑒</ci><ci id="S4.SS4.p2.3.m3.1.1.3.4.cmml" xref="S4.SS4.p2.3.m3.1.1.3.4">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">\pi_{ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT</annotation></semantics></math> denotes the reference policy, <math alttext="x" class="ltx_Math" display="inline" id="S4.SS4.p2.4.m4.1"><semantics id="S4.SS4.p2.4.m4.1a"><mi id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><ci id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.4.m4.1d">italic_x</annotation></semantics></math> denotes the instruction inputs, <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS4.p2.5.m5.1"><semantics id="S4.SS4.p2.5.m5.1a"><mi id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b"><ci id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.5.m5.1d">italic_σ</annotation></semantics></math> refers to the sigmoid activation function, <math alttext="y_{w}" class="ltx_Math" display="inline" id="S4.SS4.p2.6.m6.1"><semantics id="S4.SS4.p2.6.m6.1a"><msub id="S4.SS4.p2.6.m6.1.1" xref="S4.SS4.p2.6.m6.1.1.cmml"><mi id="S4.SS4.p2.6.m6.1.1.2" xref="S4.SS4.p2.6.m6.1.1.2.cmml">y</mi><mi id="S4.SS4.p2.6.m6.1.1.3" xref="S4.SS4.p2.6.m6.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m6.1b"><apply id="S4.SS4.p2.6.m6.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.6.m6.1.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS4.p2.6.m6.1.1.2.cmml" xref="S4.SS4.p2.6.m6.1.1.2">𝑦</ci><ci id="S4.SS4.p2.6.m6.1.1.3.cmml" xref="S4.SS4.p2.6.m6.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m6.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{l}" class="ltx_Math" display="inline" id="S4.SS4.p2.7.m7.1"><semantics id="S4.SS4.p2.7.m7.1a"><msub id="S4.SS4.p2.7.m7.1.1" xref="S4.SS4.p2.7.m7.1.1.cmml"><mi id="S4.SS4.p2.7.m7.1.1.2" xref="S4.SS4.p2.7.m7.1.1.2.cmml">y</mi><mi id="S4.SS4.p2.7.m7.1.1.3" xref="S4.SS4.p2.7.m7.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m7.1b"><apply id="S4.SS4.p2.7.m7.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.7.m7.1.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS4.p2.7.m7.1.1.2.cmml" xref="S4.SS4.p2.7.m7.1.1.2">𝑦</ci><ci id="S4.SS4.p2.7.m7.1.1.3.cmml" xref="S4.SS4.p2.7.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.7.m7.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.7.m7.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> indicate the correct answers and incorrect answers that constructed as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.T1" title="Table 1 ‣ 4.2. Instruction Prompts ‣ 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">1</span></a>, <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS4.p2.8.m8.1"><semantics id="S4.SS4.p2.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p2.8.m8.1.1" xref="S4.SS4.p2.8.m8.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.8.m8.1b"><ci id="S4.SS4.p2.8.m8.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.8.m8.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.8.m8.1d">caligraphic_D</annotation></semantics></math> denotes the instruction dataset.</p>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1">The gradient of the DMPO can be written as follows:</p>
</div>
<div class="ltx_para" id="S4.SS4.p4">
<table class="ltx_equation ltx_eqn_table" id="S4.SS4.p4.1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\nabla_{\theta}\mathcal{L}_{\text{DMPO}}(\pi_{\theta};\pi_{ref})=\\
-\beta\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\bigg{[}\underbrace{\sigma%
\left(\frac{1}{k}\sum_{i=1}^{k}(\hat{r}_{\theta}(x,y_{l}))-\hat{r}_{\theta}(x,%
y_{w})\right)}_{\text{higher weight when reward estimate is wrong}}\\
\bigg{[}\underbrace{\nabla_{\theta}\log\pi(y_{w}\mid x)}_{\text{increase %
likelihood of }y_{w}}-\underbrace{\frac{1}{k}\sum_{i=1}^{k}(\nabla_{\theta}%
\log\pi(y_{l}\mid x))}_{\text{decrease likelihood of }y_{l}}\bigg{]}\bigg{]}," class="ltx_Math" display="block" id="S4.SS4.p4.1.m1.31"><semantics id="S4.SS4.p4.1.m1.31a"><mtable displaystyle="true" id="S4.SS4.p4.1.m1.31.31.3" rowspacing="0pt"><mtr id="S4.SS4.p4.1.m1.31.31.3a"><mtd class="ltx_align_left" columnalign="left" id="S4.SS4.p4.1.m1.31.31.3b"><mrow id="S4.SS4.p4.1.m1.31.31.3.30.14.14"><mrow id="S4.SS4.p4.1.m1.31.31.3.30.14.14.14"><mrow id="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.4"><msub id="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.4.1"><mo id="S4.SS4.p4.1.m1.1.1.1.1.1.1" xref="S4.SS4.p4.1.m1.1.1.1.1.1.1.cmml">∇</mo><mi id="S4.SS4.p4.1.m1.2.2.2.2.2.2.1" xref="S4.SS4.p4.1.m1.2.2.2.2.2.2.1.cmml">θ</mi></msub><msub id="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.4.2"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.1.m1.3.3.3.3.3.3" xref="S4.SS4.p4.1.m1.3.3.3.3.3.3.cmml">ℒ</mi><mtext id="S4.SS4.p4.1.m1.4.4.4.4.4.4.1" xref="S4.SS4.p4.1.m1.4.4.4.4.4.4.1a.cmml">DMPO</mtext></msub></mrow><mo id="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">⁢</mo><mrow id="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.2.2"><mo id="S4.SS4.p4.1.m1.5.5.5.5.5.5" stretchy="false" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">(</mo><msub id="S4.SS4.p4.1.m1.30.30.2.29.13.13.13.1.1.1"><mi id="S4.SS4.p4.1.m1.6.6.6.6.6.6" xref="S4.SS4.p4.1.m1.6.6.6.6.6.6.cmml">π</mi><mi id="S4.SS4.p4.1.m1.7.7.7.7.7.7.1" xref="S4.SS4.p4.1.m1.7.7.7.7.7.7.1.cmml">θ</mi></msub><mo id="S4.SS4.p4.1.m1.8.8.8.8.8.8" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">;</mo><msub id="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.2.2.2"><mi id="S4.SS4.p4.1.m1.9.9.9.9.9.9" xref="S4.SS4.p4.1.m1.9.9.9.9.9.9.cmml">π</mi><mrow id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.cmml"><mi id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.2" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.2.cmml">r</mi><mo id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.1" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.1.cmml">⁢</mo><mi id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.3" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.3.cmml">e</mi><mo id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.1a" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.1.cmml">⁢</mo><mi id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.4" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.4.cmml">f</mi></mrow></msub><mo id="S4.SS4.p4.1.m1.11.11.11.11.11.11" stretchy="false" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p4.1.m1.12.12.12.12.12.12" xref="S4.SS4.p4.1.m1.12.12.12.12.12.12.cmml">=</mo><mi id="S4.SS4.p4.1.m1.31.31.3.30.14.14.15" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml"></mi></mrow></mtd></mtr><mtr id="S4.SS4.p4.1.m1.31.31.3c"><mtd class="ltx_align_right" columnalign="right" id="S4.SS4.p4.1.m1.31.31.3d"><mrow id="S4.SS4.p4.1.m1.19.19.19.7.7"><mo id="S4.SS4.p4.1.m1.13.13.13.1.1.1" xref="S4.SS4.p4.1.m1.13.13.13.1.1.1.cmml">−</mo><mi id="S4.SS4.p4.1.m1.14.14.14.2.2.2" xref="S4.SS4.p4.1.m1.14.14.14.2.2.2.cmml">β</mi><msub id="S4.SS4.p4.1.m1.19.19.19.7.7.8"><mi id="S4.SS4.p4.1.m1.15.15.15.3.3.3" xref="S4.SS4.p4.1.m1.15.15.15.3.3.3.cmml">𝔼</mi><mrow id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.cmml"><mrow id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.3.cmml"><mo id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.3" stretchy="false" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.3.cmml">(</mo><mi id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.1" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.1.cmml">x</mi><mo id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.4" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.3.cmml">,</mo><msub id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.cmml"><mi id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.2" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.2.cmml">y</mi><mi id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.3" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.3.cmml">w</mi></msub><mo id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.5" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.3.cmml">,</mo><msub id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.cmml"><mi id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.2" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.2.cmml">y</mi><mi id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.3" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.3.cmml">l</mi></msub><mo id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.6" stretchy="false" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.3.cmml">)</mo></mrow><mo id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.4" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.5" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.5.cmml">𝒟</mi></mrow></msub><mrow id="S4.SS4.p4.1.m1.19.19.19.7.7.9"><mo id="S4.SS4.p4.1.m1.17.17.17.5.5.5" maxsize="210%" minsize="210%" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">[</mo><munder id="S4.SS4.p4.1.m1.19.19.19.7.7.9.1"><munder accentunder="true" id="S4.SS4.p4.1.m1.18.18.18.6.6.6" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.cmml"><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.cmml"><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.5" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.5.cmml">σ</mi><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.4" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.4.cmml">⁢</mo><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.cmml"><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.cmml">(</mo><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.cmml"><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.cmml"><mfrac id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.cmml"><mn id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.2.cmml">1</mn><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.3.cmml">k</mi></mfrac><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.cmml"><munderover id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.cmml"><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.cmml"><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.3.cmml">k</mi></munderover><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.cmml"><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.cmml"><msub id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.2.cmml">r</mi><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.1.1.cmml">x</mi><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.3.cmml">−</mo><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.cmml"><msub id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.cmml"><mover accent="true" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.cmml"><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.2.cmml">r</mi><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.1.cmml">^</mo></mover><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.3.cmml">θ</mi></msub><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.2.cmml">⁢</mo><mrow id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.2.cmml"><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.2" stretchy="false" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.2.cmml">(</mo><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.2.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.2.2.cmml">x</mi><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.2.cmml">,</mo><msub id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.cmml"><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.2" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.2.cmml">y</mi><mi id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.3.cmml">w</mi></msub><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.4" stretchy="false" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.3" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p4.1.m1.18.18.18.6.6.6.4" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.4.cmml">⏟</mo></munder><mtext id="S4.SS4.p4.1.m1.19.19.19.7.7.7.1" xref="S4.SS4.p4.1.m1.19.19.19.7.7.7.1a.cmml">higher weight when reward estimate is wrong</mtext></munder></mrow></mrow></mtd></mtr><mtr id="S4.SS4.p4.1.m1.31.31.3e"><mtd class="ltx_align_right" columnalign="right" id="S4.SS4.p4.1.m1.31.31.3f"><mrow id="S4.SS4.p4.1.m1.28.28.28.9.9"><mrow id="S4.SS4.p4.1.m1.28.28.28.9.9.10"><mo id="S4.SS4.p4.1.m1.20.20.20.1.1.1" maxsize="210%" minsize="210%" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">[</mo><munder id="S4.SS4.p4.1.m1.28.28.28.9.9.10.1"><munder accentunder="true" id="S4.SS4.p4.1.m1.21.21.21.2.2.2" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.cmml"><mrow id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.cmml"><mrow id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.cmml"><mrow id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.cmml"><msub id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.cmml"><mo id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.2" rspace="0.167em" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.2.cmml">∇</mo><mi id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.3" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.3.cmml">θ</mi></msub><mi id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.2" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.2.cmml">log</mi></mrow><mo id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3a" lspace="0.167em" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.cmml">⁡</mo><mi id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.2" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.2.cmml">π</mi></mrow><mo id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.2" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.cmml"><mo id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.2" stretchy="false" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.cmml"><msub id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.cmml"><mi id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.2" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.2.cmml">y</mi><mi id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.3" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.3.cmml">w</mi></msub><mo id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.1" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.1.cmml">∣</mo><mi id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.3" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.3" stretchy="false" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p4.1.m1.21.21.21.2.2.2.2" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.2.cmml">⏟</mo></munder><mrow id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.cmml"><mtext id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.2" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.2a.cmml">increase likelihood of </mtext><mo id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.1" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.1.cmml">⁢</mo><msub id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.cmml"><mi id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.2" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.2.cmml">y</mi><mi id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.3" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.3.cmml">w</mi></msub></mrow></munder><mo id="S4.SS4.p4.1.m1.23.23.23.4.4.4" xref="S4.SS4.p4.1.m1.23.23.23.4.4.4.cmml">−</mo><munder id="S4.SS4.p4.1.m1.28.28.28.9.9.10.2"><munder accentunder="true" id="S4.SS4.p4.1.m1.24.24.24.5.5.5" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.cmml"><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.cmml"><mfrac id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.cmml"><mn id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.2.cmml">1</mn><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.3.cmml">k</mi></mfrac><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.2.cmml">⁢</mo><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.cmml"><munderover id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.cmml"><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.2.cmml">∑</mo><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.cmml"><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.2.cmml">i</mi><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.1.cmml">=</mo><mn id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.3.cmml">k</mi></munderover><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.cmml"><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.2" stretchy="false" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.cmml"><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.cmml"><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.cmml"><msub id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.cmml"><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.2" rspace="0.167em" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.2.cmml">∇</mo><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.3.cmml">θ</mi></msub><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.2.cmml">log</mi></mrow><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3a" lspace="0.167em" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.cmml">⁡</mo><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.2.cmml">π</mi></mrow><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msub><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.1" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.3" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.3" stretchy="false" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS4.p4.1.m1.24.24.24.5.5.5.2" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.2.cmml">⏟</mo></munder><mrow id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.cmml"><mtext id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.2" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.2a.cmml">decrease likelihood of </mtext><mo id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.1" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.1.cmml">⁢</mo><msub id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.cmml"><mi id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.2" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.2.cmml">y</mi><mi id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.3" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.3.cmml">l</mi></msub></mrow></munder><mo id="S4.SS4.p4.1.m1.26.26.26.7.7.7" maxsize="210%" minsize="210%" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">]</mo></mrow><mo id="S4.SS4.p4.1.m1.27.27.27.8.8.8" maxsize="210%" minsize="210%" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">]</mo><mo id="S4.SS4.p4.1.m1.28.28.28.9.9.9" xref="S4.SS4.p4.1.m1.29.29.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.SS4.p4.1.m1.31b"><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><eq id="S4.SS4.p4.1.m1.12.12.12.12.12.12.cmml" xref="S4.SS4.p4.1.m1.12.12.12.12.12.12"></eq><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><times id="S4.SS4.p4.1.m1.29.29.1.1.1.2.3.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"></times><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.2.4.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.2.4.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.29.29.1.1.1.2.4.1.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.1.1.1.1.1.1">∇</ci><ci id="S4.SS4.p4.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.SS4.p4.1.m1.2.2.2.2.2.2.1">𝜃</ci></apply><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.2.4.2.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.29.29.1.1.1.2.4.2.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.3.3.3.3.3.3.cmml" xref="S4.SS4.p4.1.m1.3.3.3.3.3.3">ℒ</ci><ci id="S4.SS4.p4.1.m1.4.4.4.4.4.4.1a.cmml" xref="S4.SS4.p4.1.m1.4.4.4.4.4.4.1"><mtext id="S4.SS4.p4.1.m1.4.4.4.4.4.4.1.cmml" mathsize="70%" xref="S4.SS4.p4.1.m1.4.4.4.4.4.4.1">DMPO</mtext></ci></apply></apply><list id="S4.SS4.p4.1.m1.29.29.1.1.1.2.2.3.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.29.29.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.6.6.6.6.6.6.cmml" xref="S4.SS4.p4.1.m1.6.6.6.6.6.6">𝜋</ci><ci id="S4.SS4.p4.1.m1.7.7.7.7.7.7.1.cmml" xref="S4.SS4.p4.1.m1.7.7.7.7.7.7.1">𝜃</ci></apply><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.2.2.2.2.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.29.29.1.1.1.2.2.2.2.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.9.9.9.9.9.9.cmml" xref="S4.SS4.p4.1.m1.9.9.9.9.9.9">𝜋</ci><apply id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.cmml" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1"><times id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.1.cmml" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.1"></times><ci id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.2.cmml" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.2">𝑟</ci><ci id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.3.cmml" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.3">𝑒</ci><ci id="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.4.cmml" xref="S4.SS4.p4.1.m1.10.10.10.10.10.10.1.4">𝑓</ci></apply></apply></list></apply><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><minus id="S4.SS4.p4.1.m1.13.13.13.1.1.1.cmml" xref="S4.SS4.p4.1.m1.13.13.13.1.1.1"></minus><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><times id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.2.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"></times><ci id="S4.SS4.p4.1.m1.14.14.14.2.2.2.cmml" xref="S4.SS4.p4.1.m1.14.14.14.2.2.2">𝛽</ci><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.4.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.4.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.15.15.15.3.3.3.cmml" xref="S4.SS4.p4.1.m1.15.15.15.3.3.3">𝔼</ci><apply id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1"><csymbol cd="latexml" id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.4.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.4">similar-to</csymbol><vector id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.3.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2"><ci id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.1.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.1">𝑥</ci><apply id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.1.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1">subscript</csymbol><ci id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.2.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.2">𝑦</ci><ci id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.3.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.2.1.1.3">𝑤</ci></apply><apply id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.1.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2">subscript</csymbol><ci id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.2.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.2">𝑦</ci><ci id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.3.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.3.2.2.3">𝑙</ci></apply></vector><ci id="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.5.cmml" xref="S4.SS4.p4.1.m1.16.16.16.4.4.4.1.5">𝒟</ci></apply></apply><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.2.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="latexml" id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">delimited-[]</csymbol><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><times id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"></times><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.3.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">subscript</csymbol><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6"><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.4.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.4">⏟</ci><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3"><times id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.4.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.4"></times><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.5.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.5">𝜎</ci><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1"><minus id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.3"></minus><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1"><times id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.2"></times><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3"><divide id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3"></divide><cn id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.2.cmml" type="integer" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.2">1</cn><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.3.3">𝑘</ci></apply><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1"><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2">superscript</csymbol><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2">subscript</csymbol><sum id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.2"></sum><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3"><eq id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.2.3">𝑘</ci></apply><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1"><times id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.2"></times><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2"><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.2.2">𝑟</ci></apply><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1"><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.1.1">𝑥</ci><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></interval></apply></apply></apply><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2"><times id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.2"></times><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3">subscript</csymbol><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2"><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.1">^</ci><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.2.2">𝑟</ci></apply><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.3.3">𝜃</ci></apply><interval closure="open" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1"><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.2.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.2.2">𝑥</ci><apply id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1">subscript</csymbol><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.2">𝑦</ci><ci id="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.18.18.18.6.6.6.3.3.1.1.2.1.1.1.3">𝑤</ci></apply></interval></apply></apply></apply></apply><ci id="S4.SS4.p4.1.m1.19.19.19.7.7.7.1a.cmml" xref="S4.SS4.p4.1.m1.19.19.19.7.7.7.1"><mtext id="S4.SS4.p4.1.m1.19.19.19.7.7.7.1.cmml" mathsize="70%" xref="S4.SS4.p4.1.m1.19.19.19.7.7.7.1">higher weight when reward estimate is wrong</mtext></ci></apply><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="latexml" id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">delimited-[]</csymbol><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><minus id="S4.SS4.p4.1.m1.23.23.23.4.4.4.cmml" xref="S4.SS4.p4.1.m1.23.23.23.4.4.4"></minus><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">subscript</csymbol><apply id="S4.SS4.p4.1.m1.21.21.21.2.2.2.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2"><ci id="S4.SS4.p4.1.m1.21.21.21.2.2.2.2.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.2">⏟</ci><apply id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1"><times id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.2.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.2"></times><apply id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3"><apply id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1"><apply id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.1.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1">subscript</csymbol><ci id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.2.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.2">∇</ci><ci id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.3.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.1.3">𝜃</ci></apply><log id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.2.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.1.2"></log></apply><ci id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.2.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.3.2">𝜋</ci></apply><apply id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.2.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.2">𝑦</ci><ci id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.3.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.2.3">𝑤</ci></apply><ci id="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.21.21.21.2.2.2.1.1.1.1.3">𝑥</ci></apply></apply></apply><apply id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.cmml" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1"><times id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.1.cmml" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.1"></times><ci id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.2a.cmml" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.2"><mtext id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.2.cmml" mathsize="70%" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.2">increase likelihood of </mtext></ci><apply id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.cmml" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.1.cmml" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.2.cmml" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.2">𝑦</ci><ci id="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.3.cmml" xref="S4.SS4.p4.1.m1.22.22.22.3.3.3.1.3.3">𝑤</ci></apply></apply></apply><apply id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.29.29.1.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS4.p4.1.m1.31.31.3.30.14.14.14.3">subscript</csymbol><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5"><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.2">⏟</ci><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1"><times id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.2"></times><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3"><divide id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3"></divide><cn id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.2.cmml" type="integer" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.2">1</cn><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.3.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.3.3">𝑘</ci></apply><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1"><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2">superscript</csymbol><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2">subscript</csymbol><sum id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.2"></sum><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3"><eq id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.1"></eq><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.2">𝑖</ci><cn id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.3.cmml" type="integer" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.3.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.2.3">𝑘</ci></apply><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1"><times id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.2"></times><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3"><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1"><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.2">∇</ci><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.3.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.1.3">𝜃</ci></apply><log id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.1.2"></log></apply><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.3.2">𝜋</ci></apply><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p4.1.m1.24.24.24.5.5.5.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply><apply id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.cmml" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1"><times id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.1.cmml" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.1"></times><ci id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.2a.cmml" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.2"><mtext id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.2.cmml" mathsize="70%" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.2">decrease likelihood of </mtext></ci><apply id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.cmml" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3"><csymbol cd="ambiguous" id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.1.cmml" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3">subscript</csymbol><ci id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.2.cmml" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.2">𝑦</ci><ci id="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.3.cmml" xref="S4.SS4.p4.1.m1.25.25.25.6.6.6.1.3.3">𝑙</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p4.1.m1.31c">\nabla_{\theta}\mathcal{L}_{\text{DMPO}}(\pi_{\theta};\pi_{ref})=\\
-\beta\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}\bigg{[}\underbrace{\sigma%
\left(\frac{1}{k}\sum_{i=1}^{k}(\hat{r}_{\theta}(x,y_{l}))-\hat{r}_{\theta}(x,%
y_{w})\right)}_{\text{higher weight when reward estimate is wrong}}\\
\bigg{[}\underbrace{\nabla_{\theta}\log\pi(y_{w}\mid x)}_{\text{increase %
likelihood of }y_{w}}-\underbrace{\frac{1}{k}\sum_{i=1}^{k}(\nabla_{\theta}%
\log\pi(y_{l}\mid x))}_{\text{decrease likelihood of }y_{l}}\bigg{]}\bigg{]},</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p4.1.m1.31d">start_ROW start_CELL ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT DMPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_π start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT ) = end_CELL end_ROW start_ROW start_CELL - italic_β blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ under⏟ start_ARG italic_σ ( divide start_ARG 1 end_ARG start_ARG italic_k end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ) - over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) ) end_ARG start_POSTSUBSCRIPT higher weight when reward estimate is wrong end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL [ under⏟ start_ARG ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log italic_π ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ∣ italic_x ) end_ARG start_POSTSUBSCRIPT increase likelihood of italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT end_POSTSUBSCRIPT - under⏟ start_ARG divide start_ARG 1 end_ARG start_ARG italic_k end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT ( ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT roman_log italic_π ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∣ italic_x ) ) end_ARG start_POSTSUBSCRIPT decrease likelihood of italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT ] ] , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS4.p5">
<p class="ltx_p" id="S4.SS4.p5.6">where <math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p5.1.m1.1"><semantics id="S4.SS4.p5.1.m1.1a"><mi id="S4.SS4.p5.1.m1.1.1" xref="S4.SS4.p5.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.1.m1.1b"><ci id="S4.SS4.p5.1.m1.1.1.cmml" xref="S4.SS4.p5.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.1.m1.1d">italic_k</annotation></semantics></math> also refers to the number of negative samples. <math alttext="\hat{r}_{\theta}(x,y)=\beta\log\frac{\pi_{\theta}(y\mid x)}{\pi_{ref}(y\mid x)}" class="ltx_Math" display="inline" id="S4.SS4.p5.2.m2.4"><semantics id="S4.SS4.p5.2.m2.4a"><mrow id="S4.SS4.p5.2.m2.4.5" xref="S4.SS4.p5.2.m2.4.5.cmml"><mrow id="S4.SS4.p5.2.m2.4.5.2" xref="S4.SS4.p5.2.m2.4.5.2.cmml"><msub id="S4.SS4.p5.2.m2.4.5.2.2" xref="S4.SS4.p5.2.m2.4.5.2.2.cmml"><mover accent="true" id="S4.SS4.p5.2.m2.4.5.2.2.2" xref="S4.SS4.p5.2.m2.4.5.2.2.2.cmml"><mi id="S4.SS4.p5.2.m2.4.5.2.2.2.2" xref="S4.SS4.p5.2.m2.4.5.2.2.2.2.cmml">r</mi><mo id="S4.SS4.p5.2.m2.4.5.2.2.2.1" xref="S4.SS4.p5.2.m2.4.5.2.2.2.1.cmml">^</mo></mover><mi id="S4.SS4.p5.2.m2.4.5.2.2.3" xref="S4.SS4.p5.2.m2.4.5.2.2.3.cmml">θ</mi></msub><mo id="S4.SS4.p5.2.m2.4.5.2.1" xref="S4.SS4.p5.2.m2.4.5.2.1.cmml">⁢</mo><mrow id="S4.SS4.p5.2.m2.4.5.2.3.2" xref="S4.SS4.p5.2.m2.4.5.2.3.1.cmml"><mo id="S4.SS4.p5.2.m2.4.5.2.3.2.1" stretchy="false" xref="S4.SS4.p5.2.m2.4.5.2.3.1.cmml">(</mo><mi id="S4.SS4.p5.2.m2.3.3" xref="S4.SS4.p5.2.m2.3.3.cmml">x</mi><mo id="S4.SS4.p5.2.m2.4.5.2.3.2.2" xref="S4.SS4.p5.2.m2.4.5.2.3.1.cmml">,</mo><mi id="S4.SS4.p5.2.m2.4.4" xref="S4.SS4.p5.2.m2.4.4.cmml">y</mi><mo id="S4.SS4.p5.2.m2.4.5.2.3.2.3" stretchy="false" xref="S4.SS4.p5.2.m2.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS4.p5.2.m2.4.5.1" xref="S4.SS4.p5.2.m2.4.5.1.cmml">=</mo><mrow id="S4.SS4.p5.2.m2.4.5.3" xref="S4.SS4.p5.2.m2.4.5.3.cmml"><mi id="S4.SS4.p5.2.m2.4.5.3.2" xref="S4.SS4.p5.2.m2.4.5.3.2.cmml">β</mi><mo id="S4.SS4.p5.2.m2.4.5.3.1" lspace="0.167em" xref="S4.SS4.p5.2.m2.4.5.3.1.cmml">⁢</mo><mrow id="S4.SS4.p5.2.m2.4.5.3.3" xref="S4.SS4.p5.2.m2.4.5.3.3.cmml"><mi id="S4.SS4.p5.2.m2.4.5.3.3.1" xref="S4.SS4.p5.2.m2.4.5.3.3.1.cmml">log</mi><mo id="S4.SS4.p5.2.m2.4.5.3.3a" lspace="0.167em" xref="S4.SS4.p5.2.m2.4.5.3.3.cmml">⁡</mo><mfrac id="S4.SS4.p5.2.m2.2.2" xref="S4.SS4.p5.2.m2.2.2.cmml"><mrow id="S4.SS4.p5.2.m2.1.1.1" xref="S4.SS4.p5.2.m2.1.1.1.cmml"><msub id="S4.SS4.p5.2.m2.1.1.1.3" xref="S4.SS4.p5.2.m2.1.1.1.3.cmml"><mi id="S4.SS4.p5.2.m2.1.1.1.3.2" xref="S4.SS4.p5.2.m2.1.1.1.3.2.cmml">π</mi><mi id="S4.SS4.p5.2.m2.1.1.1.3.3" xref="S4.SS4.p5.2.m2.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS4.p5.2.m2.1.1.1.2" xref="S4.SS4.p5.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.p5.2.m2.1.1.1.1.1" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.cmml"><mo id="S4.SS4.p5.2.m2.1.1.1.1.1.2" stretchy="false" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS4.p5.2.m2.1.1.1.1.1.1" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS4.p5.2.m2.1.1.1.1.1.1.2" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.SS4.p5.2.m2.1.1.1.1.1.1.1" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.SS4.p5.2.m2.1.1.1.1.1.1.3" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.SS4.p5.2.m2.1.1.1.1.1.3" stretchy="false" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.SS4.p5.2.m2.2.2.2" xref="S4.SS4.p5.2.m2.2.2.2.cmml"><msub id="S4.SS4.p5.2.m2.2.2.2.3" xref="S4.SS4.p5.2.m2.2.2.2.3.cmml"><mi id="S4.SS4.p5.2.m2.2.2.2.3.2" xref="S4.SS4.p5.2.m2.2.2.2.3.2.cmml">π</mi><mrow id="S4.SS4.p5.2.m2.2.2.2.3.3" xref="S4.SS4.p5.2.m2.2.2.2.3.3.cmml"><mi id="S4.SS4.p5.2.m2.2.2.2.3.3.2" xref="S4.SS4.p5.2.m2.2.2.2.3.3.2.cmml">r</mi><mo id="S4.SS4.p5.2.m2.2.2.2.3.3.1" xref="S4.SS4.p5.2.m2.2.2.2.3.3.1.cmml">⁢</mo><mi id="S4.SS4.p5.2.m2.2.2.2.3.3.3" xref="S4.SS4.p5.2.m2.2.2.2.3.3.3.cmml">e</mi><mo id="S4.SS4.p5.2.m2.2.2.2.3.3.1a" xref="S4.SS4.p5.2.m2.2.2.2.3.3.1.cmml">⁢</mo><mi id="S4.SS4.p5.2.m2.2.2.2.3.3.4" xref="S4.SS4.p5.2.m2.2.2.2.3.3.4.cmml">f</mi></mrow></msub><mo id="S4.SS4.p5.2.m2.2.2.2.2" xref="S4.SS4.p5.2.m2.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS4.p5.2.m2.2.2.2.1.1" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.cmml"><mo id="S4.SS4.p5.2.m2.2.2.2.1.1.2" stretchy="false" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.SS4.p5.2.m2.2.2.2.1.1.1" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.cmml"><mi id="S4.SS4.p5.2.m2.2.2.2.1.1.1.2" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.2.cmml">y</mi><mo id="S4.SS4.p5.2.m2.2.2.2.1.1.1.1" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.1.cmml">∣</mo><mi id="S4.SS4.p5.2.m2.2.2.2.1.1.1.3" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S4.SS4.p5.2.m2.2.2.2.1.1.3" stretchy="false" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.2.m2.4b"><apply id="S4.SS4.p5.2.m2.4.5.cmml" xref="S4.SS4.p5.2.m2.4.5"><eq id="S4.SS4.p5.2.m2.4.5.1.cmml" xref="S4.SS4.p5.2.m2.4.5.1"></eq><apply id="S4.SS4.p5.2.m2.4.5.2.cmml" xref="S4.SS4.p5.2.m2.4.5.2"><times id="S4.SS4.p5.2.m2.4.5.2.1.cmml" xref="S4.SS4.p5.2.m2.4.5.2.1"></times><apply id="S4.SS4.p5.2.m2.4.5.2.2.cmml" xref="S4.SS4.p5.2.m2.4.5.2.2"><csymbol cd="ambiguous" id="S4.SS4.p5.2.m2.4.5.2.2.1.cmml" xref="S4.SS4.p5.2.m2.4.5.2.2">subscript</csymbol><apply id="S4.SS4.p5.2.m2.4.5.2.2.2.cmml" xref="S4.SS4.p5.2.m2.4.5.2.2.2"><ci id="S4.SS4.p5.2.m2.4.5.2.2.2.1.cmml" xref="S4.SS4.p5.2.m2.4.5.2.2.2.1">^</ci><ci id="S4.SS4.p5.2.m2.4.5.2.2.2.2.cmml" xref="S4.SS4.p5.2.m2.4.5.2.2.2.2">𝑟</ci></apply><ci id="S4.SS4.p5.2.m2.4.5.2.2.3.cmml" xref="S4.SS4.p5.2.m2.4.5.2.2.3">𝜃</ci></apply><interval closure="open" id="S4.SS4.p5.2.m2.4.5.2.3.1.cmml" xref="S4.SS4.p5.2.m2.4.5.2.3.2"><ci id="S4.SS4.p5.2.m2.3.3.cmml" xref="S4.SS4.p5.2.m2.3.3">𝑥</ci><ci id="S4.SS4.p5.2.m2.4.4.cmml" xref="S4.SS4.p5.2.m2.4.4">𝑦</ci></interval></apply><apply id="S4.SS4.p5.2.m2.4.5.3.cmml" xref="S4.SS4.p5.2.m2.4.5.3"><times id="S4.SS4.p5.2.m2.4.5.3.1.cmml" xref="S4.SS4.p5.2.m2.4.5.3.1"></times><ci id="S4.SS4.p5.2.m2.4.5.3.2.cmml" xref="S4.SS4.p5.2.m2.4.5.3.2">𝛽</ci><apply id="S4.SS4.p5.2.m2.4.5.3.3.cmml" xref="S4.SS4.p5.2.m2.4.5.3.3"><log id="S4.SS4.p5.2.m2.4.5.3.3.1.cmml" xref="S4.SS4.p5.2.m2.4.5.3.3.1"></log><apply id="S4.SS4.p5.2.m2.2.2.cmml" xref="S4.SS4.p5.2.m2.2.2"><divide id="S4.SS4.p5.2.m2.2.2.3.cmml" xref="S4.SS4.p5.2.m2.2.2"></divide><apply id="S4.SS4.p5.2.m2.1.1.1.cmml" xref="S4.SS4.p5.2.m2.1.1.1"><times id="S4.SS4.p5.2.m2.1.1.1.2.cmml" xref="S4.SS4.p5.2.m2.1.1.1.2"></times><apply id="S4.SS4.p5.2.m2.1.1.1.3.cmml" xref="S4.SS4.p5.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS4.p5.2.m2.1.1.1.3.1.cmml" xref="S4.SS4.p5.2.m2.1.1.1.3">subscript</csymbol><ci id="S4.SS4.p5.2.m2.1.1.1.3.2.cmml" xref="S4.SS4.p5.2.m2.1.1.1.3.2">𝜋</ci><ci id="S4.SS4.p5.2.m2.1.1.1.3.3.cmml" xref="S4.SS4.p5.2.m2.1.1.1.3.3">𝜃</ci></apply><apply id="S4.SS4.p5.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS4.p5.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS4.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS4.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.SS4.p5.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS4.p5.2.m2.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.SS4.p5.2.m2.2.2.2.cmml" xref="S4.SS4.p5.2.m2.2.2.2"><times id="S4.SS4.p5.2.m2.2.2.2.2.cmml" xref="S4.SS4.p5.2.m2.2.2.2.2"></times><apply id="S4.SS4.p5.2.m2.2.2.2.3.cmml" xref="S4.SS4.p5.2.m2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS4.p5.2.m2.2.2.2.3.1.cmml" xref="S4.SS4.p5.2.m2.2.2.2.3">subscript</csymbol><ci id="S4.SS4.p5.2.m2.2.2.2.3.2.cmml" xref="S4.SS4.p5.2.m2.2.2.2.3.2">𝜋</ci><apply id="S4.SS4.p5.2.m2.2.2.2.3.3.cmml" xref="S4.SS4.p5.2.m2.2.2.2.3.3"><times id="S4.SS4.p5.2.m2.2.2.2.3.3.1.cmml" xref="S4.SS4.p5.2.m2.2.2.2.3.3.1"></times><ci id="S4.SS4.p5.2.m2.2.2.2.3.3.2.cmml" xref="S4.SS4.p5.2.m2.2.2.2.3.3.2">𝑟</ci><ci id="S4.SS4.p5.2.m2.2.2.2.3.3.3.cmml" xref="S4.SS4.p5.2.m2.2.2.2.3.3.3">𝑒</ci><ci id="S4.SS4.p5.2.m2.2.2.2.3.3.4.cmml" xref="S4.SS4.p5.2.m2.2.2.2.3.3.4">𝑓</ci></apply></apply><apply id="S4.SS4.p5.2.m2.2.2.2.1.1.1.cmml" xref="S4.SS4.p5.2.m2.2.2.2.1.1"><csymbol cd="latexml" id="S4.SS4.p5.2.m2.2.2.2.1.1.1.1.cmml" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S4.SS4.p5.2.m2.2.2.2.1.1.1.2.cmml" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.2">𝑦</ci><ci id="S4.SS4.p5.2.m2.2.2.2.1.1.1.3.cmml" xref="S4.SS4.p5.2.m2.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.2.m2.4c">\hat{r}_{\theta}(x,y)=\beta\log\frac{\pi_{\theta}(y\mid x)}{\pi_{ref}(y\mid x)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.2.m2.4d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG</annotation></semantics></math> denotes the reward implicitly defined by the language model <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.SS4.p5.3.m3.1"><semantics id="S4.SS4.p5.3.m3.1a"><msub id="S4.SS4.p5.3.m3.1.1" xref="S4.SS4.p5.3.m3.1.1.cmml"><mi id="S4.SS4.p5.3.m3.1.1.2" xref="S4.SS4.p5.3.m3.1.1.2.cmml">π</mi><mi id="S4.SS4.p5.3.m3.1.1.3" xref="S4.SS4.p5.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.3.m3.1b"><apply id="S4.SS4.p5.3.m3.1.1.cmml" xref="S4.SS4.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p5.3.m3.1.1.1.cmml" xref="S4.SS4.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p5.3.m3.1.1.2.cmml" xref="S4.SS4.p5.3.m3.1.1.2">𝜋</ci><ci id="S4.SS4.p5.3.m3.1.1.3.cmml" xref="S4.SS4.p5.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.3.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> and reference model <math alttext="\pi_{ref}" class="ltx_Math" display="inline" id="S4.SS4.p5.4.m4.1"><semantics id="S4.SS4.p5.4.m4.1a"><msub id="S4.SS4.p5.4.m4.1.1" xref="S4.SS4.p5.4.m4.1.1.cmml"><mi id="S4.SS4.p5.4.m4.1.1.2" xref="S4.SS4.p5.4.m4.1.1.2.cmml">π</mi><mrow id="S4.SS4.p5.4.m4.1.1.3" xref="S4.SS4.p5.4.m4.1.1.3.cmml"><mi id="S4.SS4.p5.4.m4.1.1.3.2" xref="S4.SS4.p5.4.m4.1.1.3.2.cmml">r</mi><mo id="S4.SS4.p5.4.m4.1.1.3.1" xref="S4.SS4.p5.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p5.4.m4.1.1.3.3" xref="S4.SS4.p5.4.m4.1.1.3.3.cmml">e</mi><mo id="S4.SS4.p5.4.m4.1.1.3.1a" xref="S4.SS4.p5.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S4.SS4.p5.4.m4.1.1.3.4" xref="S4.SS4.p5.4.m4.1.1.3.4.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.4.m4.1b"><apply id="S4.SS4.p5.4.m4.1.1.cmml" xref="S4.SS4.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p5.4.m4.1.1.1.cmml" xref="S4.SS4.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p5.4.m4.1.1.2.cmml" xref="S4.SS4.p5.4.m4.1.1.2">𝜋</ci><apply id="S4.SS4.p5.4.m4.1.1.3.cmml" xref="S4.SS4.p5.4.m4.1.1.3"><times id="S4.SS4.p5.4.m4.1.1.3.1.cmml" xref="S4.SS4.p5.4.m4.1.1.3.1"></times><ci id="S4.SS4.p5.4.m4.1.1.3.2.cmml" xref="S4.SS4.p5.4.m4.1.1.3.2">𝑟</ci><ci id="S4.SS4.p5.4.m4.1.1.3.3.cmml" xref="S4.SS4.p5.4.m4.1.1.3.3">𝑒</ci><ci id="S4.SS4.p5.4.m4.1.1.3.4.cmml" xref="S4.SS4.p5.4.m4.1.1.3.4">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.4.m4.1c">\pi_{ref}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT</annotation></semantics></math>. The mathematical formulation of DMPO shows that instead of computing the probability of generating negative samples <math alttext="\hat{r}_{\theta}(x,y_{l})" class="ltx_Math" display="inline" id="S4.SS4.p5.5.m5.2"><semantics id="S4.SS4.p5.5.m5.2a"><mrow id="S4.SS4.p5.5.m5.2.2" xref="S4.SS4.p5.5.m5.2.2.cmml"><msub id="S4.SS4.p5.5.m5.2.2.3" xref="S4.SS4.p5.5.m5.2.2.3.cmml"><mover accent="true" id="S4.SS4.p5.5.m5.2.2.3.2" xref="S4.SS4.p5.5.m5.2.2.3.2.cmml"><mi id="S4.SS4.p5.5.m5.2.2.3.2.2" xref="S4.SS4.p5.5.m5.2.2.3.2.2.cmml">r</mi><mo id="S4.SS4.p5.5.m5.2.2.3.2.1" xref="S4.SS4.p5.5.m5.2.2.3.2.1.cmml">^</mo></mover><mi id="S4.SS4.p5.5.m5.2.2.3.3" xref="S4.SS4.p5.5.m5.2.2.3.3.cmml">θ</mi></msub><mo id="S4.SS4.p5.5.m5.2.2.2" xref="S4.SS4.p5.5.m5.2.2.2.cmml">⁢</mo><mrow id="S4.SS4.p5.5.m5.2.2.1.1" xref="S4.SS4.p5.5.m5.2.2.1.2.cmml"><mo id="S4.SS4.p5.5.m5.2.2.1.1.2" stretchy="false" xref="S4.SS4.p5.5.m5.2.2.1.2.cmml">(</mo><mi id="S4.SS4.p5.5.m5.1.1" xref="S4.SS4.p5.5.m5.1.1.cmml">x</mi><mo id="S4.SS4.p5.5.m5.2.2.1.1.3" xref="S4.SS4.p5.5.m5.2.2.1.2.cmml">,</mo><msub id="S4.SS4.p5.5.m5.2.2.1.1.1" xref="S4.SS4.p5.5.m5.2.2.1.1.1.cmml"><mi id="S4.SS4.p5.5.m5.2.2.1.1.1.2" xref="S4.SS4.p5.5.m5.2.2.1.1.1.2.cmml">y</mi><mi id="S4.SS4.p5.5.m5.2.2.1.1.1.3" xref="S4.SS4.p5.5.m5.2.2.1.1.1.3.cmml">l</mi></msub><mo id="S4.SS4.p5.5.m5.2.2.1.1.4" stretchy="false" xref="S4.SS4.p5.5.m5.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.5.m5.2b"><apply id="S4.SS4.p5.5.m5.2.2.cmml" xref="S4.SS4.p5.5.m5.2.2"><times id="S4.SS4.p5.5.m5.2.2.2.cmml" xref="S4.SS4.p5.5.m5.2.2.2"></times><apply id="S4.SS4.p5.5.m5.2.2.3.cmml" xref="S4.SS4.p5.5.m5.2.2.3"><csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.2.2.3.1.cmml" xref="S4.SS4.p5.5.m5.2.2.3">subscript</csymbol><apply id="S4.SS4.p5.5.m5.2.2.3.2.cmml" xref="S4.SS4.p5.5.m5.2.2.3.2"><ci id="S4.SS4.p5.5.m5.2.2.3.2.1.cmml" xref="S4.SS4.p5.5.m5.2.2.3.2.1">^</ci><ci id="S4.SS4.p5.5.m5.2.2.3.2.2.cmml" xref="S4.SS4.p5.5.m5.2.2.3.2.2">𝑟</ci></apply><ci id="S4.SS4.p5.5.m5.2.2.3.3.cmml" xref="S4.SS4.p5.5.m5.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S4.SS4.p5.5.m5.2.2.1.2.cmml" xref="S4.SS4.p5.5.m5.2.2.1.1"><ci id="S4.SS4.p5.5.m5.1.1.cmml" xref="S4.SS4.p5.5.m5.1.1">𝑥</ci><apply id="S4.SS4.p5.5.m5.2.2.1.1.1.cmml" xref="S4.SS4.p5.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p5.5.m5.2.2.1.1.1.1.cmml" xref="S4.SS4.p5.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS4.p5.5.m5.2.2.1.1.1.2.cmml" xref="S4.SS4.p5.5.m5.2.2.1.1.1.2">𝑦</ci><ci id="S4.SS4.p5.5.m5.2.2.1.1.1.3.cmml" xref="S4.SS4.p5.5.m5.2.2.1.1.1.3">𝑙</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.5.m5.2c">\hat{r}_{\theta}(x,y_{l})</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.5.m5.2d">over^ start_ARG italic_r end_ARG start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> using a single negative item, it is now computed as the average value of <math alttext="k" class="ltx_Math" display="inline" id="S4.SS4.p5.6.m6.1"><semantics id="S4.SS4.p5.6.m6.1a"><mi id="S4.SS4.p5.6.m6.1.1" xref="S4.SS4.p5.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p5.6.m6.1b"><ci id="S4.SS4.p5.6.m6.1.1.cmml" xref="S4.SS4.p5.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p5.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p5.6.m6.1d">italic_k</annotation></semantics></math> negative samples. It promotes a more diverse and uniform learning of negative samples, which enhances the performance in recommendation tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Prediction</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.3">To predict the generation probabilities of positive and negative candidates, we calculate the probability of each token in each candidate and obtain their average, denoted as <math alttext="P" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><mi id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><ci id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">italic_P</annotation></semantics></math>. We then use this average probability <math alttext="P" class="ltx_Math" display="inline" id="S4.SS5.p1.2.m2.1"><semantics id="S4.SS5.p1.2.m2.1a"><mi id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><ci id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.2.m2.1d">italic_P</annotation></semantics></math> to calculate the evaluation metric AUC. The mathematical formula of <math alttext="P" class="ltx_Math" display="inline" id="S4.SS5.p1.3.m3.1"><semantics id="S4.SS5.p1.3.m3.1a"><mi id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><ci id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.3.m3.1d">italic_P</annotation></semantics></math> is shown in the equation below:</p>
</div>
<div class="ltx_para" id="S4.SS5.p2">
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E4X">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle P=\frac{\pi_{\theta}(y\mid x)}{n_{y}}," class="ltx_Math" display="inline" id="S4.E4X.2.1.1.m1.2"><semantics id="S4.E4X.2.1.1.m1.2a"><mrow id="S4.E4X.2.1.1.m1.2.2.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S4.E4X.2.1.1.m1.2.2.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.cmml"><mi id="S4.E4X.2.1.1.m1.2.2.1.1.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.2.cmml">P</mi><mo id="S4.E4X.2.1.1.m1.2.2.1.1.1" xref="S4.E4X.2.1.1.m1.2.2.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S4.E4X.2.1.1.m1.1.1" xref="S4.E4X.2.1.1.m1.1.1.cmml"><mfrac id="S4.E4X.2.1.1.m1.1.1a" xref="S4.E4X.2.1.1.m1.1.1.cmml"><mrow id="S4.E4X.2.1.1.m1.1.1.1" xref="S4.E4X.2.1.1.m1.1.1.1.cmml"><msub id="S4.E4X.2.1.1.m1.1.1.1.3" xref="S4.E4X.2.1.1.m1.1.1.1.3.cmml"><mi id="S4.E4X.2.1.1.m1.1.1.1.3.2" xref="S4.E4X.2.1.1.m1.1.1.1.3.2.cmml">π</mi><mi id="S4.E4X.2.1.1.m1.1.1.1.3.3" xref="S4.E4X.2.1.1.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.E4X.2.1.1.m1.1.1.1.2" xref="S4.E4X.2.1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4X.2.1.1.m1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.E4X.2.1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4X.2.1.1.m1.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.E4X.2.1.1.m1.1.1.1.1.1.1.2" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.E4X.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S4.E4X.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.E4X.2.1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><msub id="S4.E4X.2.1.1.m1.1.1.3" xref="S4.E4X.2.1.1.m1.1.1.3.cmml"><mi id="S4.E4X.2.1.1.m1.1.1.3.2" xref="S4.E4X.2.1.1.m1.1.1.3.2.cmml">n</mi><mi id="S4.E4X.2.1.1.m1.1.1.3.3" xref="S4.E4X.2.1.1.m1.1.1.3.3.cmml">y</mi></msub></mfrac></mstyle></mrow><mo id="S4.E4X.2.1.1.m1.2.2.1.2" xref="S4.E4X.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4X.2.1.1.m1.2b"><apply id="S4.E4X.2.1.1.m1.2.2.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1"><eq id="S4.E4X.2.1.1.m1.2.2.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.1"></eq><ci id="S4.E4X.2.1.1.m1.2.2.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.2.2.1.1.2">𝑃</ci><apply id="S4.E4X.2.1.1.m1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1"><divide id="S4.E4X.2.1.1.m1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.1.1"></divide><apply id="S4.E4X.2.1.1.m1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1"><times id="S4.E4X.2.1.1.m1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.2"></times><apply id="S4.E4X.2.1.1.m1.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.1.1.1.3.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.3">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.1.1.1.3.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.3.2">𝜋</ci><ci id="S4.E4X.2.1.1.m1.1.1.1.3.3.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E4X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E4X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E4X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S4.E4X.2.1.1.m1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.1.1.3.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.1.1.3.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.3.2">𝑛</ci><ci id="S4.E4X.2.1.1.m1.1.1.3.3.cmml" xref="S4.E4X.2.1.1.m1.1.1.3.3">𝑦</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4X.2.1.1.m1.2c">\displaystyle P=\frac{\pi_{\theta}(y\mid x)}{n_{y}},</annotation><annotation encoding="application/x-llamapun" id="S4.E4X.2.1.1.m1.2d">italic_P = divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) end_ARG start_ARG italic_n start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS5.p2.4">where <math alttext="n_{y}" class="ltx_Math" display="inline" id="S4.SS5.p2.1.m1.1"><semantics id="S4.SS5.p2.1.m1.1a"><msub id="S4.SS5.p2.1.m1.1.1" xref="S4.SS5.p2.1.m1.1.1.cmml"><mi id="S4.SS5.p2.1.m1.1.1.2" xref="S4.SS5.p2.1.m1.1.1.2.cmml">n</mi><mi id="S4.SS5.p2.1.m1.1.1.3" xref="S4.SS5.p2.1.m1.1.1.3.cmml">y</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.1.m1.1b"><apply id="S4.SS5.p2.1.m1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p2.1.m1.1.1.1.cmml" xref="S4.SS5.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.p2.1.m1.1.1.2.cmml" xref="S4.SS5.p2.1.m1.1.1.2">𝑛</ci><ci id="S4.SS5.p2.1.m1.1.1.3.cmml" xref="S4.SS5.p2.1.m1.1.1.3">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.1.m1.1c">n_{y}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.1.m1.1d">italic_n start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT</annotation></semantics></math> represents the number of tokens in the candidate <math alttext="y" class="ltx_Math" display="inline" id="S4.SS5.p2.2.m2.1"><semantics id="S4.SS5.p2.2.m2.1a"><mi id="S4.SS5.p2.2.m2.1.1" xref="S4.SS5.p2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.2.m2.1b"><ci id="S4.SS5.p2.2.m2.1.1.cmml" xref="S4.SS5.p2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.2.m2.1d">italic_y</annotation></semantics></math> that needs to be predicted, <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S4.SS5.p2.3.m3.1"><semantics id="S4.SS5.p2.3.m3.1a"><msub id="S4.SS5.p2.3.m3.1.1" xref="S4.SS5.p2.3.m3.1.1.cmml"><mi id="S4.SS5.p2.3.m3.1.1.2" xref="S4.SS5.p2.3.m3.1.1.2.cmml">π</mi><mi id="S4.SS5.p2.3.m3.1.1.3" xref="S4.SS5.p2.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.3.m3.1b"><apply id="S4.SS5.p2.3.m3.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.p2.3.m3.1.1.1.cmml" xref="S4.SS5.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS5.p2.3.m3.1.1.2.cmml" xref="S4.SS5.p2.3.m3.1.1.2">𝜋</ci><ci id="S4.SS5.p2.3.m3.1.1.3.cmml" xref="S4.SS5.p2.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.3.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.3.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> represents the model we have established, <math alttext="x" class="ltx_Math" display="inline" id="S4.SS5.p2.4.m4.1"><semantics id="S4.SS5.p2.4.m4.1a"><mi id="S4.SS5.p2.4.m4.1.1" xref="S4.SS5.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p2.4.m4.1b"><ci id="S4.SS5.p2.4.m4.1.1.cmml" xref="S4.SS5.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p2.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p2.4.m4.1d">italic_x</annotation></semantics></math> denotes the instruction inputs.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Dataset</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.8">We conduct experiments on three real-world public datasets, which are <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.8.1">MovieLens 1M</span>, <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.8.2">Amazon Movies and TV</span>, and <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.8.3">Amazon Video Games</span>. All three datasets contain a list of user-item interactions, with ratings of products. In our experiment, following the prior studies <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib4" title="">he2020lightgcn, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib5" title="">zhang2023reformulating, </a>)</cite>, we categorize the ratings into two classes: ratings <math alttext="&lt;=3" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml"></mi><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">&lt;=</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><leq id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></leq><csymbol cd="latexml" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">absent</csymbol><cn id="S5.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">&lt;=3</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">&lt; = 3</annotation></semantics></math> indicate users who do not prefer the movie (negative item), while ratings <math alttext="&gt;3" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml"></mi><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">&gt;</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><gt id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></gt><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">absent</csymbol><cn id="S5.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">&gt;3</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">&gt; 3</annotation></semantics></math> indicate users who prefer the movie (positive item). Data filtering is performed based on the number of user-item interactions, ensuring there are a minimum of <math alttext="5" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mn id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><cn id="S5.SS1.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">5</annotation></semantics></math> positive and <math alttext="5" class="ltx_Math" display="inline" id="S5.SS1.p1.4.m4.1"><semantics id="S5.SS1.p1.4.m4.1a"><mn id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><cn id="S5.SS1.p1.4.m4.1.1.cmml" type="integer" xref="S5.SS1.p1.4.m4.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">5</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">5</annotation></semantics></math> negative samples, with the length of the interaction list limited to <math alttext="40" class="ltx_Math" display="inline" id="S5.SS1.p1.5.m5.1"><semantics id="S5.SS1.p1.5.m5.1a"><mn id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.5.m5.1b"><cn id="S5.SS1.p1.5.m5.1.1.cmml" type="integer" xref="S5.SS1.p1.5.m5.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.5.m5.1c">40</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.5.m5.1d">40</annotation></semantics></math> items. The experiment is conducted in a few-shot learning scenario. For training, validation, and testing, we randomly selected <math alttext="100" class="ltx_Math" display="inline" id="S5.SS1.p1.6.m6.1"><semantics id="S5.SS1.p1.6.m6.1a"><mn id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.6.m6.1b"><cn id="S5.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S5.SS1.p1.6.m6.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.6.m6.1c">100</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.6.m6.1d">100</annotation></semantics></math>, <math alttext="100" class="ltx_Math" display="inline" id="S5.SS1.p1.7.m7.1"><semantics id="S5.SS1.p1.7.m7.1a"><mn id="S5.SS1.p1.7.m7.1.1" xref="S5.SS1.p1.7.m7.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.7.m7.1b"><cn id="S5.SS1.p1.7.m7.1.1.cmml" type="integer" xref="S5.SS1.p1.7.m7.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.7.m7.1c">100</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.7.m7.1d">100</annotation></semantics></math>, and <math alttext="1000" class="ltx_Math" display="inline" id="S5.SS1.p1.8.m8.1"><semantics id="S5.SS1.p1.8.m8.1a"><mn id="S5.SS1.p1.8.m8.1.1" xref="S5.SS1.p1.8.m8.1.1.cmml">1000</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.8.m8.1b"><cn id="S5.SS1.p1.8.m8.1.1.cmml" type="integer" xref="S5.SS1.p1.8.m8.1.1">1000</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.8.m8.1c">1000</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.8.m8.1d">1000</annotation></semantics></math> samples, respectively. Statistics and more details can be found in our released data.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1. </span>MovieLens 1M</h4>
<div class="ltx_para" id="S5.SS1.SSS1.p1">
<p class="ltx_p" id="S5.SS1.SSS1.p1.4">It is a movie dataset commonly utilized in recommendation tasks, collected by the GroupLens Research Project at the University of Minnesota <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://grouplens.org/datasets/movielens/1m/</span></span></span>. The dataset comprises <math alttext="1,000,209" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.1.m1.3"><semantics id="S5.SS1.SSS1.p1.1.m1.3a"><mrow id="S5.SS1.SSS1.p1.1.m1.3.4.2" xref="S5.SS1.SSS1.p1.1.m1.3.4.1.cmml"><mn id="S5.SS1.SSS1.p1.1.m1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.cmml">1</mn><mo id="S5.SS1.SSS1.p1.1.m1.3.4.2.1" xref="S5.SS1.SSS1.p1.1.m1.3.4.1.cmml">,</mo><mn id="S5.SS1.SSS1.p1.1.m1.2.2" xref="S5.SS1.SSS1.p1.1.m1.2.2.cmml">000</mn><mo id="S5.SS1.SSS1.p1.1.m1.3.4.2.2" xref="S5.SS1.SSS1.p1.1.m1.3.4.1.cmml">,</mo><mn id="S5.SS1.SSS1.p1.1.m1.3.3" xref="S5.SS1.SSS1.p1.1.m1.3.3.cmml">209</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.1.m1.3b"><list id="S5.SS1.SSS1.p1.1.m1.3.4.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.3.4.2"><cn id="S5.SS1.SSS1.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.1.m1.1.1">1</cn><cn id="S5.SS1.SSS1.p1.1.m1.2.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.1.m1.2.2">000</cn><cn id="S5.SS1.SSS1.p1.1.m1.3.3.cmml" type="integer" xref="S5.SS1.SSS1.p1.1.m1.3.3">209</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.1.m1.3c">1,000,209</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.1.m1.3d">1 , 000 , 209</annotation></semantics></math> anonymous ratings for around <math alttext="3,900" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.2.m2.2"><semantics id="S5.SS1.SSS1.p1.2.m2.2a"><mrow id="S5.SS1.SSS1.p1.2.m2.2.3.2" xref="S5.SS1.SSS1.p1.2.m2.2.3.1.cmml"><mn id="S5.SS1.SSS1.p1.2.m2.1.1" xref="S5.SS1.SSS1.p1.2.m2.1.1.cmml">3</mn><mo id="S5.SS1.SSS1.p1.2.m2.2.3.2.1" xref="S5.SS1.SSS1.p1.2.m2.2.3.1.cmml">,</mo><mn id="S5.SS1.SSS1.p1.2.m2.2.2" xref="S5.SS1.SSS1.p1.2.m2.2.2.cmml">900</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.2.m2.2b"><list id="S5.SS1.SSS1.p1.2.m2.2.3.1.cmml" xref="S5.SS1.SSS1.p1.2.m2.2.3.2"><cn id="S5.SS1.SSS1.p1.2.m2.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.2.m2.1.1">3</cn><cn id="S5.SS1.SSS1.p1.2.m2.2.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.2.m2.2.2">900</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.2.m2.2c">3,900</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.2.m2.2d">3 , 900</annotation></semantics></math> movies provided by <math alttext="6,040" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.3.m3.2"><semantics id="S5.SS1.SSS1.p1.3.m3.2a"><mrow id="S5.SS1.SSS1.p1.3.m3.2.3.2" xref="S5.SS1.SSS1.p1.3.m3.2.3.1.cmml"><mn id="S5.SS1.SSS1.p1.3.m3.1.1" xref="S5.SS1.SSS1.p1.3.m3.1.1.cmml">6</mn><mo id="S5.SS1.SSS1.p1.3.m3.2.3.2.1" xref="S5.SS1.SSS1.p1.3.m3.2.3.1.cmml">,</mo><mn id="S5.SS1.SSS1.p1.3.m3.2.2" xref="S5.SS1.SSS1.p1.3.m3.2.2.cmml">040</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.3.m3.2b"><list id="S5.SS1.SSS1.p1.3.m3.2.3.1.cmml" xref="S5.SS1.SSS1.p1.3.m3.2.3.2"><cn id="S5.SS1.SSS1.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS1.SSS1.p1.3.m3.1.1">6</cn><cn id="S5.SS1.SSS1.p1.3.m3.2.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.3.m3.2.2">040</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.3.m3.2c">6,040</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.3.m3.2d">6 , 040</annotation></semantics></math> MovieLens users who joined the platform in 2000. Each user has rated a minimum of 20 movies. Data collection took place on the MovieLens website over seven months from September 19th, 1997, to April 22nd, 1998. User ratings range from <math alttext="(1-5)" class="ltx_Math" display="inline" id="S5.SS1.SSS1.p1.4.m4.1"><semantics id="S5.SS1.SSS1.p1.4.m4.1a"><mrow id="S5.SS1.SSS1.p1.4.m4.1.1.1" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.cmml"><mo id="S5.SS1.SSS1.p1.4.m4.1.1.1.2" stretchy="false" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.cmml">(</mo><mrow id="S5.SS1.SSS1.p1.4.m4.1.1.1.1" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.cmml"><mn id="S5.SS1.SSS1.p1.4.m4.1.1.1.1.2" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.2.cmml">1</mn><mo id="S5.SS1.SSS1.p1.4.m4.1.1.1.1.1" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.1.cmml">−</mo><mn id="S5.SS1.SSS1.p1.4.m4.1.1.1.1.3" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.3.cmml">5</mn></mrow><mo id="S5.SS1.SSS1.p1.4.m4.1.1.1.3" stretchy="false" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.4.m4.1b"><apply id="S5.SS1.SSS1.p1.4.m4.1.1.1.1.cmml" xref="S5.SS1.SSS1.p1.4.m4.1.1.1"><minus id="S5.SS1.SSS1.p1.4.m4.1.1.1.1.1.cmml" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.1"></minus><cn id="S5.SS1.SSS1.p1.4.m4.1.1.1.1.2.cmml" type="integer" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.2">1</cn><cn id="S5.SS1.SSS1.p1.4.m4.1.1.1.1.3.cmml" type="integer" xref="S5.SS1.SSS1.p1.4.m4.1.1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.4.m4.1c">(1-5)</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.SSS1.p1.4.m4.1d">( 1 - 5 )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2. </span>Amazon Datasets</h4>
<div class="ltx_para" id="S5.SS1.SSS2.p1">
<p class="ltx_p" id="S5.SS1.SSS2.p1.1">This dataset contains 142.8 million reviews and metadata of Amazon products from May 1996 to July 2014 <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://nijianmo.github.io/amazon/index.html</span></span></span>. It includes subsets like Books, Movies and TV, Video Games, Electronics, and more. For our study, we chose the ”<span class="ltx_text ltx_font_italic" id="S5.SS1.SSS2.p1.1.1">Amazon Movies and TV</span>” and ”<span class="ltx_text ltx_font_italic" id="S5.SS1.SSS2.p1.1.2">Amazon Video Games</span>” datasets, which include reviewer ID, item ID, item title, item brand, user-item interactions, ratings, and user reviews. In our experiment, we only use the item title and the user-item interaction history for DMPO to make the prediction.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>
Performance comparison among traditional sequential recommendation baselines, LLM-based methods, and DMPO. The reported results are presented as the AUC multiplied by 100, with boldface indicating the highest score. <math alttext="\ddagger" class="ltx_Math" display="inline" id="S5.T2.3.m1.1"><semantics id="S5.T2.3.m1.1b"><mo id="S5.T2.3.m1.1.1" xref="S5.T2.3.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.m1.1c"><ci id="S5.T2.3.m1.1.1.cmml" xref="S5.T2.3.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.m1.1d">\ddagger</annotation><annotation encoding="application/x-llamapun" id="S5.T2.3.m1.1e">‡</annotation></semantics></math>: significantly better than all baselines with a t-test <math alttext="p" class="ltx_Math" display="inline" id="S5.T2.4.m2.1"><semantics id="S5.T2.4.m2.1b"><mi id="S5.T2.4.m2.1.1" xref="S5.T2.4.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.T2.4.m2.1c"><ci id="S5.T2.4.m2.1.1.cmml" xref="S5.T2.4.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.m2.1d">p</annotation><annotation encoding="application/x-llamapun" id="S5.T2.4.m2.1e">italic_p</annotation></semantics></math>¡0.01.
</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S5.T2.7" style="width:433.6pt;height:49.3pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-104.5pt,11.7pt) scale(0.674853840387919,0.674853840387919) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.7.3">
<tr class="ltx_tr" id="S5.T2.7.3.4">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.1" style="padding-left:11.4pt;padding-right:11.4pt;">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.2" style="padding-left:11.4pt;padding-right:11.4pt;">GCSAN</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.3" style="padding-left:11.4pt;padding-right:11.4pt;">STAMP</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.4" style="padding-left:11.4pt;padding-right:11.4pt;">SASRec</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.5" style="padding-left:11.4pt;padding-right:11.4pt;">GRU4Rec</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.6" style="padding-left:11.4pt;padding-right:11.4pt;">BERT4Rec</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.7" style="padding-left:11.4pt;padding-right:11.4pt;">SHAN</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.8" style="padding-left:11.4pt;padding-right:11.4pt;">CORE</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.9" style="padding-left:11.4pt;padding-right:11.4pt;">TALLrec</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.7.3.4.10" style="padding-left:11.4pt;padding-right:11.4pt;">OurMethod</td>
</tr>
<tr class="ltx_tr" id="S5.T2.5.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S5.T2.5.1.1.2.1">MovieLens 1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">52.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.4" style="padding-left:11.4pt;padding-right:11.4pt;">53.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.5" style="padding-left:11.4pt;padding-right:11.4pt;">54.77</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.6" style="padding-left:11.4pt;padding-right:11.4pt;">52.75</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.7" style="padding-left:11.4pt;padding-right:11.4pt;">47.72</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.8" style="padding-left:11.4pt;padding-right:11.4pt;">51.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.9" style="padding-left:11.4pt;padding-right:11.4pt;">50.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.10" style="padding-left:11.4pt;padding-right:11.4pt;">67.79</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.1.1.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.5.1.1.1.1">70.20<math alttext="\ddagger" class="ltx_Math" display="inline" id="S5.T2.5.1.1.1.1.m1.1"><semantics id="S5.T2.5.1.1.1.1.m1.1a"><mo id="S5.T2.5.1.1.1.1.m1.1.1" xref="S5.T2.5.1.1.1.1.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.1.1.1.1.m1.1b"><ci id="S5.T2.5.1.1.1.1.m1.1.1.cmml" xref="S5.T2.5.1.1.1.1.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.1.1.1.1.m1.1c">\ddagger</annotation><annotation encoding="application/x-llamapun" id="S5.T2.5.1.1.1.1.m1.1d">‡</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S5.T2.6.2.2.2.1">Amazon Movie</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.3" style="padding-left:11.4pt;padding-right:11.4pt;">51.07</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.4" style="padding-left:11.4pt;padding-right:11.4pt;">53.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.5" style="padding-left:11.4pt;padding-right:11.4pt;">49.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.6" style="padding-left:11.4pt;padding-right:11.4pt;">47.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.7" style="padding-left:11.4pt;padding-right:11.4pt;">50.17</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.8" style="padding-left:11.4pt;padding-right:11.4pt;">52.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.9" style="padding-left:11.4pt;padding-right:11.4pt;">49.55</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.10" style="padding-left:11.4pt;padding-right:11.4pt;">57.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.2.2.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.6.2.2.1.1">66.60<math alttext="\ddagger" class="ltx_Math" display="inline" id="S5.T2.6.2.2.1.1.m1.1"><semantics id="S5.T2.6.2.2.1.1.m1.1a"><mo id="S5.T2.6.2.2.1.1.m1.1.1" xref="S5.T2.6.2.2.1.1.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.2.2.1.1.m1.1b"><ci id="S5.T2.6.2.2.1.1.m1.1.1.cmml" xref="S5.T2.6.2.2.1.1.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.2.2.1.1.m1.1c">\ddagger</annotation><annotation encoding="application/x-llamapun" id="S5.T2.6.2.2.1.1.m1.1d">‡</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.7.3.3">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S5.T2.7.3.3.2.1">Amazon Game</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.3" style="padding-left:11.4pt;padding-right:11.4pt;">52.11</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.4" style="padding-left:11.4pt;padding-right:11.4pt;">51.27</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.5" style="padding-left:11.4pt;padding-right:11.4pt;">50.23</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.6" style="padding-left:11.4pt;padding-right:11.4pt;">51.26</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.7" style="padding-left:11.4pt;padding-right:11.4pt;">50.81</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.8" style="padding-left:11.4pt;padding-right:11.4pt;">50.35</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.9" style="padding-left:11.4pt;padding-right:11.4pt;">49.96</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.10" style="padding-left:11.4pt;padding-right:11.4pt;">53.17</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.7.3.3.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S5.T2.7.3.3.1.1">64.51<math alttext="\ddagger" class="ltx_Math" display="inline" id="S5.T2.7.3.3.1.1.m1.1"><semantics id="S5.T2.7.3.3.1.1.m1.1a"><mo id="S5.T2.7.3.3.1.1.m1.1.1" xref="S5.T2.7.3.3.1.1.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.3.3.1.1.m1.1b"><ci id="S5.T2.7.3.3.1.1.m1.1.1.cmml" xref="S5.T2.7.3.3.1.1.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.3.3.1.1.m1.1c">\ddagger</annotation><annotation encoding="application/x-llamapun" id="S5.T2.7.3.3.1.1.m1.1d">‡</annotation></semantics></math></span></td>
</tr>
</table>
</span></div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Baseline</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We compared DMPO with both LLM-based and traditional sequential recommendation methods. To ensure a fair comparison, we followed the same setup as DMPO for the LLM-based method, including tuning instructions and training, validation, and test data. For the traditional sequential recommendation methods, we generated train, valid, and test datasets using the same data as DMPO, which include item ID, user ID, and labels derived from user ratings.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1. </span>LLM-based methods</h4>
<div class="ltx_para" id="S5.SS2.SSS1.p1">
<p class="ltx_p" id="S5.SS2.SSS1.p1.1">We conducted an experiment to compare DMPO with previous work that employed LLM for the recommendation task. <span class="ltx_text ltx_font_bold" id="S5.SS2.SSS1.p1.1.1">(i) TALLRec</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib2" title="">tallrec, </a>)</cite> is an LLM-based approach that aims to bridge the gap between training tasks for LLMs and recommendation tasks. It incorporates recommendation data into LLMs through rec-tuning, which involves constructing instruction-tuning samples using recommendation data and conducting SFT. We use the implementation provided by the authors.<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/SAI990323/TALLRec" title="">https://github.com/SAI990323/TALLRec</a>.</span></span></span></p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2. </span>Traditional methods</h4>
<div class="ltx_para" id="S5.SS2.SSS2.p1">
<p class="ltx_p" id="S5.SS2.SSS2.p1.1">Since DMPO utilizes the user’s preference item list to construct the prompt, it bears similarities to sequential recommendation systems. Therefore, we experimented to compare DMPO with the traditional sequential methods. <span class="ltx_text ltx_font_bold" id="S5.SS2.SSS2.p1.1.1">(i) GRU4Rec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib17" title="">GRU4Rec, </a>)</cite></span> is an RNN-based sequential recommender, which utilizes GRU to encode historical interactions.
<span class="ltx_text ltx_font_bold" id="S5.SS2.SSS2.p1.1.2">(ii) GCSAN <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib13" title="">GCSAN, </a>)</cite></span> focuses on addressing session recommendation problems by utilizing Graph Neural Networks (GNNs) and self-attention networks.
<span class="ltx_text ltx_font_bold" id="S5.SS2.SSS2.p1.1.3">(iii) SASRec <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib77" title="">SASRec, </a>)</cite></span> is a classic transformer-based sequential recommender.
<span class="ltx_text ltx_font_bold" id="S5.SS2.SSS2.p1.1.4">(iv) STAMP <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib16" title="">STAMP, </a>)</cite></span> is a short-term attention/memory priority model. It combines long-term memory to capture general interests and short-term memory to account for current user interests
<span class="ltx_text ltx_font_bold" id="S5.SS2.SSS2.p1.1.5">(v) BERT4Rec<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib12" title="">BERT4Rec, </a>)</cite></span> is a sequential recommendation model that utilizes deep bidirectional self-attention to model user behavior sequences. It addresses the limitations of unidirectional models by allowing each item in the sequence to fuse information from both left and right sides.
<span class="ltx_text ltx_font_bold" id="S5.SS2.SSS2.p1.1.6">(vi) SHAN<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib14" title="">SHAN, </a>)</cite></span> is a two-layer hierarchical attention network that considers user long-term preferences and dynamic characteristics. It incorporates both user-item and item-item interactions in a non-linear way.
<span class="ltx_text ltx_font_bold" id="S5.SS2.SSS2.p1.1.7">(vii) CORE<cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib15" title="">CORE, </a>)</cite></span> is a recommender that addresses the inconsistent prediction issue in the session-based recommendation by unifying the representation space for session embedding and item embeddings. It achieves this through a representation-consistent encoder and a robust distance-measuring method.</p>
</div>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="166" id="S5.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Performance for different numbers of negative samples in DMPO. The x-axis label represents the number of negative samples. </figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Evaluation Metric</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Although the task’s output format involves ranking the likelihood of user preference for items, the task itself is fundamentally a binary classification problem. The model is tasked with distinguishing between the positive and negative samples and placing the positive sample ahead of the negative sample. The objective is to differentiate between positive and negative samples and establish pair-wise relationships between correct and incorrect answers. Therefore, we utilize a widely used evaluation metric in recommendation systems: the <span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.1">Area Under the Receiver Operating Characteristic (AUC)</span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Implementation Details</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">To ensure sequence lengths, we truncated the user-item interaction list to 40, while ensuring a minimum of 5 positive and 5 negative items. For training, validation, and testing, we randomly selected 100, 100, and 1000 samples, respectively. For most experiments, we utilized <span class="ltx_text ltx_font_italic" id="S5.SS4.p1.1.1">Llama-2-7b-chat-hf</span> <span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://huggingface.co/meta-llama/Llama-2-7b-chat-hf</span></span></span> as the base model. The training of LoRA <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib1" title="">lora, </a>)</cite> was implemented using Llama Factory <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib71" title="">zheng2024llamafactory, </a>)</cite>, which is an efficient LLM tuning framework. We examined the learning rates for all methods in the set 1e-3, 1e-4, 1e-5, 1e-6 to identify the optimal choice and adopted a cosine decay policy for the learning rate. For LoRA rank, we conducted experiments with 8, 16, 32 to determine the optimal choice, using q, k, and v as LoRA targets. In the case of the traditional method, we utilized the implementation provided by RecBole<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/RUCAIBox/RecBole" title="">https://github.com/RUCAIBox/RecBole</a></span></span></span>, a project that replicates and enhances recommendation algorithms within a unified framework. Subsequently, we conducted five runs using different random seeds and presented the averaged results. Further details are provided in the code.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Analysis</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this section, we conduct analysis of our experiments to address the following research questions:</p>
</div>
<div class="ltx_para" id="S6.p2">
<ul class="ltx_itemize" id="S6.I1">
<li class="ltx_item" id="S6.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span>
<div class="ltx_para" id="S6.I1.ix1.p1">
<p class="ltx_p" id="S6.I1.ix1.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.ix1.p1.1.1">RQ1:</span>
How does DMPO perform compared to current LLM-based and traditional sequential recommendation models?</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span>
<div class="ltx_para" id="S6.I1.ix2.p1">
<p class="ltx_p" id="S6.I1.ix2.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.ix2.p1.1.1">RQ2:</span>
What factors affect the performance of DMPO?</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span>
<div class="ltx_para" id="S6.I1.ix3.p1">
<p class="ltx_p" id="S6.I1.ix3.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.ix3.p1.1.1">RQ3:</span>
What about the generalization ability of DMPO? How does it perform under cross-domain recommendation?</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span>
<div class="ltx_para" id="S6.I1.ix4.p1">
<p class="ltx_p" id="S6.I1.ix4.p1.1"><span class="ltx_text ltx_font_bold" id="S6.I1.ix4.p1.1.1">RQ4:</span>
Why does DMPO lead to improvements?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1. </span>Performance Comparison (RQ1)</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">We conducted the experiment in a few-shot learning scenario to compare the recommendation performance of different methods. The results are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.T2" title="Table 2 ‣ 5.1.2. Amazon Datasets ‣ 5.1. Dataset ‣ 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">2</span></a>. From the table, we draw the following observations: 1) Our method significantly outperforms both traditional sequential recommendation methods and LLM-based methods, demonstrating the superiority of the DMPO framework. 2) The LLM-based method shows improvements compared to the traditional sequential recommendation method, aligning with expectations but still lower than the DMPO. 3) The traditional sequential recommendation method performs similarly to random guessing (<math alttext="AUC\approx 0.5" class="ltx_Math" display="inline" id="S6.SS1.p1.1.m1.1"><semantics id="S6.SS1.p1.1.m1.1a"><mrow id="S6.SS1.p1.1.m1.1.1" xref="S6.SS1.p1.1.m1.1.1.cmml"><mrow id="S6.SS1.p1.1.m1.1.1.2" xref="S6.SS1.p1.1.m1.1.1.2.cmml"><mi id="S6.SS1.p1.1.m1.1.1.2.2" xref="S6.SS1.p1.1.m1.1.1.2.2.cmml">A</mi><mo id="S6.SS1.p1.1.m1.1.1.2.1" xref="S6.SS1.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.1.m1.1.1.2.3" xref="S6.SS1.p1.1.m1.1.1.2.3.cmml">U</mi><mo id="S6.SS1.p1.1.m1.1.1.2.1a" xref="S6.SS1.p1.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S6.SS1.p1.1.m1.1.1.2.4" xref="S6.SS1.p1.1.m1.1.1.2.4.cmml">C</mi></mrow><mo id="S6.SS1.p1.1.m1.1.1.1" xref="S6.SS1.p1.1.m1.1.1.1.cmml">≈</mo><mn id="S6.SS1.p1.1.m1.1.1.3" xref="S6.SS1.p1.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p1.1.m1.1b"><apply id="S6.SS1.p1.1.m1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1"><approx id="S6.SS1.p1.1.m1.1.1.1.cmml" xref="S6.SS1.p1.1.m1.1.1.1"></approx><apply id="S6.SS1.p1.1.m1.1.1.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2"><times id="S6.SS1.p1.1.m1.1.1.2.1.cmml" xref="S6.SS1.p1.1.m1.1.1.2.1"></times><ci id="S6.SS1.p1.1.m1.1.1.2.2.cmml" xref="S6.SS1.p1.1.m1.1.1.2.2">𝐴</ci><ci id="S6.SS1.p1.1.m1.1.1.2.3.cmml" xref="S6.SS1.p1.1.m1.1.1.2.3">𝑈</ci><ci id="S6.SS1.p1.1.m1.1.1.2.4.cmml" xref="S6.SS1.p1.1.m1.1.1.2.4">𝐶</ci></apply><cn id="S6.SS1.p1.1.m1.1.1.3.cmml" type="float" xref="S6.SS1.p1.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p1.1.m1.1c">AUC\approx 0.5</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p1.1.m1.1d">italic_A italic_U italic_C ≈ 0.5</annotation></semantics></math>) in this scenario, indicating that its effectiveness is limited by the amount of training data and its inability to quickly learn recommendation capabilities with a small number of training samples.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2. </span>Ablation Study (RQ2)</h3>
<section class="ltx_subsubsection" id="S6.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.2.1. </span>Number of Negative samples in DMPO</h4>
<div class="ltx_para" id="S6.SS2.SSS1.p1">
<p class="ltx_p" id="S6.SS2.SSS1.p1.1">In the DMPO, multiple negative sampling is introduced into the framework, as discussed in section <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.SS2" title="4.2. Instruction Prompts ‣ 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">4.2</span></a>. One important question that arises is the optimal number of negative samples to include in DMPO and how this quantity affects performance. To address this question, we conducted ablation studies with varying numbers of negative samples denoted as <math alttext="k" class="ltx_Math" display="inline" id="S6.SS2.SSS1.p1.1.m1.1"><semantics id="S6.SS2.SSS1.p1.1.m1.1a"><mi id="S6.SS2.SSS1.p1.1.m1.1.1" xref="S6.SS2.SSS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.SSS1.p1.1.m1.1b"><ci id="S6.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S6.SS2.SSS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.SSS1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S6.SS2.SSS1.p1.1.m1.1d">italic_k</annotation></semantics></math>. The results are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.F3" title="Figure 3 ‣ 5.2.2. Traditional methods ‣ 5.2. Baseline ‣ 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">3</span></a>. Based on the results, we make the following observations: 1) Increasing the number of negative samples in DMPO improves the performance compared to using only a single negative sample. 2) The performance tends to stabilize when the number of negative samples ranges from three to five. This improvement is derived from the introduction of more diverse negative samples for comparison. The multiple negative sampling enhances the diversity and uniformity of negative samples, enabling the model to establish more comprehensive and rich comparisons between positive and negative samples. However, the extent of this improvement is not infinite, and adding more negative samples beyond five may lead to additional computational overhead, reducing the efficiency of the model, and providing limited additional benefits. Moreover, the number of negative samples is also limited by the total length of the user-item interaction list. Therefore, we did not further increase the number of negative samples.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.2.2. </span>DMPO and SFT with Varying Few-Shot Samples</h4>
<figure class="ltx_figure" id="S6.F4">
<div class="ltx_block ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F4.1" style="width:433.6pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S6.F4.1.g1" src="x4.png" width="830"/>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Performance of using SFT+DMPO and using only DMPO is compared under different few-shot sample numbers.</figcaption>
</figure>
<div class="ltx_para" id="S6.SS2.SSS2.p1">
<p class="ltx_p" id="S6.SS2.SSS2.p1.1">We conducted experiments on the <span class="ltx_text ltx_font_italic" id="S6.SS2.SSS2.p1.1.1">Amazon Movies and TV</span> dataset to investigate two questions. The first question was about the difference in performance between using DMPO alone and using SFT+DMPO, and to clarify the roles of SFT and DPO. The second question was about the impact of different numbers of few-shot samples on the model. The experimental results are presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.F4" title="Figure 4 ‣ 6.2.2. DMPO and SFT with Varying Few-Shot Samples ‣ 6.2. Ablation Study (RQ2) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">4</span></a>. The observation can be drawn as follows: 1) When the number of few-shot samples is less than or equal to 50, using DMPO alone yields lower results than using SFT+DMPO. However, when the number of few-shot samples increases to 100 or more, the performance gap between DMPO and SFT+DMPO is reduced. The performance of both approaches is similar, with a difference of only about 1.3 percent. This suggests that DMPO plays an important role in improving model performance. 2) As the number of few-shot samples increases, the performance of both DMPO and SFT+DMPO shows a clear upward trend. However, with only 20 few-shot samples, the AUC can reach around 87 percent of the AUC achieved with 200 few-shot samples. This demonstrates the high efficiency of DMPO.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.2.3. </span>Generalization across Base Models</h4>
<figure class="ltx_figure" id="S6.F5">
<div class="ltx_block ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F5.1" style="width:433.6pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S6.F5.1.g1" src="x5.png" width="830"/>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>Performance for different base models of DMPO. In the label ”SFT+DMPO(1)” and the label ”SFT+DMPO(3)”, the number in the brackets refers to the number of negative samples used in DMPO. </figcaption>
</figure>
<figure class="ltx_table" id="S6.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>
Comparison of cross-domain generalization performance between DMPO, traditional cross-domain recommendation models, and LLM-based models under few-shot scenarios. The reported results are presented as the AUC multiplied by 100, with boldface indicating the highest score, <math alttext="\ddagger" class="ltx_Math" display="inline" id="S6.T3.3.m1.1"><semantics id="S6.T3.3.m1.1b"><mo id="S6.T3.3.m1.1.1" xref="S6.T3.3.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S6.T3.3.m1.1c"><ci id="S6.T3.3.m1.1.1.cmml" xref="S6.T3.3.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.3.m1.1d">\ddagger</annotation><annotation encoding="application/x-llamapun" id="S6.T3.3.m1.1e">‡</annotation></semantics></math>, which is significantly better than all baselines according to a t-test with <math alttext="p" class="ltx_Math" display="inline" id="S6.T3.4.m2.1"><semantics id="S6.T3.4.m2.1b"><mi id="S6.T3.4.m2.1.1" xref="S6.T3.4.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S6.T3.4.m2.1c"><ci id="S6.T3.4.m2.1.1.cmml" xref="S6.T3.4.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.4.m2.1d">p</annotation><annotation encoding="application/x-llamapun" id="S6.T3.4.m2.1e">italic_p</annotation></semantics></math>¡0.01. ”Movie to Game” means the ”<span class="ltx_text ltx_font_italic" id="S6.T3.11.1">Amazon Movies and TV</span>” is the source domain and the ”<span class="ltx_text ltx_font_italic" id="S6.T3.12.2">Amazon Video Games</span>” is the target domain. ”Game to Movie” means that ”<span class="ltx_text ltx_font_italic" id="S6.T3.13.3">Amazon Video Games</span>” is the source domain and ”<span class="ltx_text ltx_font_italic" id="S6.T3.14.4">Amazon Movies and TV</span>” is the target domain.
</figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S6.T3.6" style="width:433.6pt;height:43.5pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-57.5pt,5.7pt) scale(0.790397276587564,0.790397276587564) ;">
<table class="ltx_tabular ltx_align_middle" id="S6.T3.6.2">
<tr class="ltx_tr" id="S6.T3.6.2.3">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.1" style="padding-left:11.4pt;padding-right:11.4pt;">Dataset</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.2" style="padding-left:11.4pt;padding-right:11.4pt;">BiTGCF</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.3" style="padding-left:11.4pt;padding-right:11.4pt;">CMF</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.4" style="padding-left:11.4pt;padding-right:11.4pt;">DTCDR</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.5" style="padding-left:11.4pt;padding-right:11.4pt;">CoNet</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.6" style="padding-left:11.4pt;padding-right:11.4pt;">CLFM</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.7" style="padding-left:11.4pt;padding-right:11.4pt;">DeepAPF</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.8" style="padding-left:11.4pt;padding-right:11.4pt;">TALLRec</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S6.T3.6.2.3.9" style="padding-left:11.4pt;padding-right:11.4pt;">DMPO</td>
</tr>
<tr class="ltx_tr" id="S6.T3.5.1.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S6.T3.5.1.1.2.1">Movie to Game</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.3" style="padding-left:11.4pt;padding-right:11.4pt;">52.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.4" style="padding-left:11.4pt;padding-right:11.4pt;">49.16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.5" style="padding-left:11.4pt;padding-right:11.4pt;">48.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.6" style="padding-left:11.4pt;padding-right:11.4pt;">49.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.7" style="padding-left:11.4pt;padding-right:11.4pt;">51.25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.8" style="padding-left:11.4pt;padding-right:11.4pt;">50.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.9" style="padding-left:11.4pt;padding-right:11.4pt;">54.61</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S6.T3.5.1.1.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.5.1.1.1.1">62.73<math alttext="\ddagger" class="ltx_Math" display="inline" id="S6.T3.5.1.1.1.1.m1.1"><semantics id="S6.T3.5.1.1.1.1.m1.1a"><mo id="S6.T3.5.1.1.1.1.m1.1.1" xref="S6.T3.5.1.1.1.1.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S6.T3.5.1.1.1.1.m1.1b"><ci id="S6.T3.5.1.1.1.1.m1.1.1.cmml" xref="S6.T3.5.1.1.1.1.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.5.1.1.1.1.m1.1c">\ddagger</annotation><annotation encoding="application/x-llamapun" id="S6.T3.5.1.1.1.1.m1.1d">‡</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.6.2.2">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.2" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text" id="S6.T3.6.2.2.2.1">Game to Movie</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.3" style="padding-left:11.4pt;padding-right:11.4pt;">52.4</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.4" style="padding-left:11.4pt;padding-right:11.4pt;">52.70</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.5" style="padding-left:11.4pt;padding-right:11.4pt;">48.73</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.6" style="padding-left:11.4pt;padding-right:11.4pt;">47.91</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.7" style="padding-left:11.4pt;padding-right:11.4pt;">53.33</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.8" style="padding-left:11.4pt;padding-right:11.4pt;">49.13</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.9" style="padding-left:11.4pt;padding-right:11.4pt;">52.59</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S6.T3.6.2.2.1" style="padding-left:11.4pt;padding-right:11.4pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.6.2.2.1.1">64.55<math alttext="\ddagger" class="ltx_Math" display="inline" id="S6.T3.6.2.2.1.1.m1.1"><semantics id="S6.T3.6.2.2.1.1.m1.1a"><mo id="S6.T3.6.2.2.1.1.m1.1.1" xref="S6.T3.6.2.2.1.1.m1.1.1.cmml">‡</mo><annotation-xml encoding="MathML-Content" id="S6.T3.6.2.2.1.1.m1.1b"><ci id="S6.T3.6.2.2.1.1.m1.1.1.cmml" xref="S6.T3.6.2.2.1.1.m1.1.1">‡</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.6.2.2.1.1.m1.1c">\ddagger</annotation><annotation encoding="application/x-llamapun" id="S6.T3.6.2.2.1.1.m1.1d">‡</annotation></semantics></math></span></td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S6.SS2.SSS3.p1">
<p class="ltx_p" id="S6.SS2.SSS3.p1.1">Recently, many researchers in the field of LLMs have publicly released their models and model parameters, including <span class="ltx_text ltx_font_italic" id="S6.SS2.SSS3.p1.1.1">Llama-3-8B</span> <span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>https://huggingface.co/meta-llama/Meta-Llama-3-8B</span></span></span>, <span class="ltx_text ltx_font_italic" id="S6.SS2.SSS3.p1.1.2">gemma-7b</span> <span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>https://huggingface.co/google/gemma-7b</span></span></span>,
<span class="ltx_text ltx_font_italic" id="S6.SS2.SSS3.p1.1.3">Phi-3-mini-128k-instruct</span> <span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>https://huggingface.co/microsoft/Phi-3-mini-128k-instruct</span></span></span> and <span class="ltx_text ltx_font_italic" id="S6.SS2.SSS3.p1.1.4">Mistral-7B-Instruct-v0.2</span> <span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note">10</span>https://huggingface.co/mistralai/Mistral-7B-Instruct-v0.2</span></span></span>. We have a strong interest in evaluating the performance of our method on various open-source language model-based recommendation systems (LLMs), particularly those models that claim to have SOTA performance. As a result, we conducted experiments on multiple recently released LLMs using the <span class="ltx_text ltx_font_italic" id="S6.SS2.SSS3.p1.1.5">Amazon Movies and TV</span>. To validate the effectiveness of DMPO, we conducted experiments under three different conditions: (1) SFT; (2) SFT and DMPO using only one negative sample; (3) SFT and DMPO using three negative samples. In Section <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.SS2.SSS1" title="6.2.1. Number of Negative samples in DMPO ‣ 6.2. Ablation Study (RQ2) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">6.2.1</span></a>, we found that employing three negative samples in the DMPO yielded relatively stable improvements.</p>
</div>
<div class="ltx_para" id="S6.SS2.SSS3.p2">
<p class="ltx_p" id="S6.SS2.SSS3.p2.1">The results, shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.F5" title="Figure 5 ‣ 6.2.3. Generalization across Base Models ‣ 6.2. Ablation Study (RQ2) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">5</span></a>, demonstrate the following conclusions: 1) Firstly, on various base models of LLMs, performing DMPO can lead to an increase in AUC cross different base models; 2) The increasing number of negative sample brings further performance improvements; 3) Among all models, the <span class="ltx_text ltx_font_italic" id="S6.SS2.SSS3.p2.1.1">Mistral-7B-Instruct-v0.2</span> shows the smallest improvement after utilizing DMPO, while the <span class="ltx_text ltx_font_italic" id="S6.SS2.SSS3.p2.1.2">Llama-3-8B</span> model shows the largest improvement, which may be related to the structures, train methods, and parameter choices of the different base models.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3. </span>Cross-Domain Analysis (RQ3)</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">To investigate the generalization ability of DMPO, we conducted cross-domain experiments between the ”<span class="ltx_text ltx_font_italic" id="S6.SS3.p1.1.1">Amazon Movies and TV</span>” and the ”<span class="ltx_text ltx_font_italic" id="S6.SS3.p1.1.2">Amazon Video Games</span>”. Initially, we used ”<span class="ltx_text ltx_font_italic" id="S6.SS3.p1.1.3">Amazon Movies and TV</span>” as the source domain and ”<span class="ltx_text ltx_font_italic" id="S6.SS3.p1.1.4">Amazon Video Games</span>” as the target domain. Subsequently, we swapped the roles of the source and target domains for further analysis. In the cross-domain evaluation, the data from the source domain was used for training, while the data from the target domain was used for validation and testing. The datasets remained consistent with the original datasets described in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S5.SS1" title="5.1. Dataset ‣ 5. Experiments ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">5.1</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S6.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.1. </span>Baselines</h4>
<div class="ltx_para" id="S6.SS3.SSS1.p1">
<p class="ltx_p" id="S6.SS3.SSS1.p1.1">We compared DMPO with the traditional cross-domain method and LLM-based cross-domain method. For the traditional cross-domain approach, we considered the following methods: <span class="ltx_text ltx_font_bold" id="S6.SS3.SSS1.p1.1.1">(i) CMF</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib6" title="">CMF, </a>)</cite>, a well-known cross-domain recommender using Collective Matrix Factorization. <span class="ltx_text ltx_font_bold" id="S6.SS3.SSS1.p1.1.2">(ii) CLFM</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib10" title="">CLFM, </a>)</cite>, a cross-domain recommender that identifies shared and unique rating patterns between domains, focusing solely on shared patterns for knowledge transfer. <span class="ltx_text ltx_font_bold" id="S6.SS3.SSS1.p1.1.3">(iii) DTCDR</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib76" title="">DTCDR, </a>)</cite>, a cross-domain model employing an adaptive embedding-sharing strategy based on multi-task learning to enhance recommendation performance on both richer and sparser domains simultaneously. <span class="ltx_text ltx_font_bold" id="S6.SS3.SSS1.p1.1.4">(iv) DeepAPF</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib11" title="">DeepAPF, </a>)</cite>, a cross-domain recommender that captures cross-domain common interests and domain-specific interests using an attention network. <span class="ltx_text ltx_font_bold" id="S6.SS3.SSS1.p1.1.5">(v) BiTGCF</span> <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib9" title="">BiTGCF, </a>)</cite>, a cross-domain recommender based on a graph collaborative filtering network, integrating common user features with target domain-specific features.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S6.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.3.2. </span>Performance Comparsion</h4>
<div class="ltx_para" id="S6.SS3.SSS2.p1">
<p class="ltx_p" id="S6.SS3.SSS2.p1.1">The results presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.T3" title="Table 3 ‣ 6.2.3. Generalization across Base Models ‣ 6.2. Ablation Study (RQ2) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">3</span></a> indicate the following findings, 1) DMPO demonstrates a significant improvement compared to both LLM-based and traditional cross-domain methods. 2) The cross-domain recommendation result for DMPO was slightly lower compared to training on the target domain data, which is aligned with the exception.</p>
</div>
<div class="ltx_para" id="S6.SS3.SSS2.p2">
<p class="ltx_p" id="S6.SS3.SSS2.p2.1">We also conduct the experiment to investigate the influence of varying numbers of negative samples in DMPO in cross-domain recommendation. The results present in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.F6" title="Figure 6 ‣ 6.3.2. Performance Comparsion ‣ 6.3. Cross-Domain Analysis (RQ3) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">6</span></a> indicate the following observations. 1) The increasing number of negative samples enhances the performance in the cross-domain context. 2) The performance tends to stabilize when the number of negative samples reaches three to five.</p>
</div>
<figure class="ltx_figure" id="S6.F6">
<div class="ltx_block ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F6.1" style="width:433.6pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="553" id="S6.F6.1.g1" src="x6.png" width="830"/>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Performance of the DMPO in cross-domain recommendation varies with different numbers of negative samples. The x-axis represents the number of negative samples</figcaption>
</figure>
<figure class="ltx_figure" id="S6.F7">
<div class="ltx_block ltx_minipage ltx_align_center ltx_align_bottom" id="S6.F7.1" style="width:433.6pt;">
<img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="467" id="S6.F7.1.g1" src="x7.png" width="830"/>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>Average conditional probabilities for positive and negative candidates of ”<span class="ltx_text ltx_font_italic" id="S6.F7.3.1">Movielens-1M</span>” test dataset. Predictions of the model using only SFT, the model using only DMPO, and the model using SFT+DMPO and the gap of probabilities between candidates are presented.</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4. </span>Case Study (RQ4)</h3>
<figure class="ltx_figure" id="S6.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="419" id="S6.F8.g1" src="x8.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span>A case study sample illustrates the reason why DMPO can improve the performance. The user’s historical sequence, positive and negative candidates, and the conditional probabilities for generating each token are provided. model using only SFT made an incorrect prediction, while model using SFT+DMPO made the correct prediction. </figcaption>
</figure>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">To investigate why DMPO leads to improvements, we conducted a case study. By inputting a user’s historical sequence, positive and negative candidates, we obtained the conditional probability of each token of candidates. Through a specific example, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.F8" title="Figure 8 ‣ 6.4. Case Study (RQ4) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">8</span></a>, we made the following observations: 1) the gap between positive and negative candidates increased after applying DMPO; 2) the conditional probability of key tokens in negative candidates was suppressed after DMPO, while this was not observed in the model that only underwent SFT. This suggests that through DMPO, the model achieved better discrimination between positive and negative candidates.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">The average conditional probability data for the ”<span class="ltx_text ltx_font_italic" id="S6.SS4.p2.1.1">Movielens-1M</span>” test dataset also supports this conclusion, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S6.F7" title="Figure 7 ‣ 6.3.2. Performance Comparsion ‣ 6.3. Cross-Domain Analysis (RQ3) ‣ 6. Analysis ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">7</span></a>. The gap between positive and negative candidates’ conditional probabilities increased from 0.4 percent in the model using only SFT to 2.0 percent in the model using SFT+DMPO, and the average conditional probabilities of negative candidates decreased. This further validates our previous findings. It is worth noting that the above conclusion can also be obtained by using DMPO alone, as shown in the label <span class="ltx_text ltx_font_italic" id="S6.SS4.p2.1.2">DMPO</span>, which means that DMPO can provide performance benefits even when used independently.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5. </span>Explainable Recommendation System</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">The explainable recommendation system can improve the acceptance of recommended products, persuade users to purchase them, and even enhance the overall trust of the system <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib73" title="">herlocker2000explaining, </a>)</cite>. The DMPO can provide interpretability for recommendation tasks <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#bib.bib72" title="">rafailov2024r, </a>)</cite>. As shown in Section <a class="ltx_ref" href="https://arxiv.org/html/2405.16127v2#S4.SS5" title="4.5. Prediction ‣ 4. Methodology ‣ Finetuning Large Language Model for Personalized Ranking"><span class="ltx_text ltx_ref_tag">4.5</span></a>, the model calculates the probability of generating each token in the candidates and assigns higher probabilities to the important tokens, indicating that the recommendation is made based on those crucial tokens. This explains why certain candidates are chosen for item recommendations.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7. </span>Conclusion</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">In this study, we introduced Direct Multiple Preference Optimization (DMPO), a streamlined framework that effectively aligns LLMs with recommendation tasks. DMPO can be seen as a pair-wise ranking loss that distinguishes between positive and negative samples. Through multiple negative sampling, DMPO enhances the performance of LLM-based recommenders by maximizing the probability of positive samples and minimizing the probability of multiple negative samples simultaneously. This enhances the diversity and uniformity of negative samples, enabling the model to learn and establish more comprehensive and accurate positive-negative sample relationships. Through extensive experiments, we compared the performance of DMPO with other methods, including LLM-based and traditional sequential recommendation approaches. Significant improvements were observed with DMPO in few-shot scenarios. Additionally, we evaluated the generalization ability of DMPO in cross-domain recommendation tasks, comparing it with traditional cross-domain methods and LLM-based cross-domain methods. DMPO exhibited superior performance in cross-domain recommendation. Ablation studies were conducted to analyze the factors contributing to the enhancements in DMPO, and case studies explored the reasons for the improvements. Moreover, DMPO is also highlighted as an explainable recommendation system. Moving forward, our future research will focus on exploring more efficient methods to leverage the recommendation capabilities of LLMs.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
E. J. Hu, Y. Shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, and W. Chen, “Lora: Low-rank adaptation of large language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2106.09685</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(2)</span>
<span class="ltx_bibblock">
K. Bao, J. Zhang, Y. Zhang, W. Wang, F. Feng, and X. He, “Tallrec: An effective and efficient tuning framework to align large language model with recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 17th ACM Conference on Recommender Systems</em>, 2023, pp. 1007–1014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(3)</span>
<span class="ltx_bibblock">
R. Rafailov, A. Sharma, E. Mitchell, C. D. Manning, S. Ermon, and C. Finn, “Direct preference optimization: Your language model is secretly a reward model,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in Neural Information Processing Systems</em>, vol. 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(4)</span>
<span class="ltx_bibblock">
X. He, K. Deng, X. Wang, Y. Li, Y. Zhang, and M. Wang, “Lightgcn: Simplifying and powering graph convolution network for recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">SIGIR’20</em>, 2020, pp. 639–648.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(5)</span>
<span class="ltx_bibblock">
Y. Zhang, T. Shi, F. Feng, W. Wang, D. Wang, X. He, and Y. Zhang, “Reformulating ctr prediction: Learning invariant feature interactions for recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2023, pp. 1386–1395.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(6)</span>
<span class="ltx_bibblock">
A. P. Singh and G. J. Gordon, “Relational learning via collective matrix factorization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 14th ACM SIGKDD international conference on Knowledge discovery and data mining</em>, 2008, pp. 650–658.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(7)</span>
<span class="ltx_bibblock">
F. Zhu, C. Chen, Y. Wang, G. Liu, and X. Zheng, “Dtcdr: A framework for dual-target cross-domain recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</em>, 2019, pp. 1533–1542.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(8)</span>
<span class="ltx_bibblock">
G. Hu, Y. Zhang, and Q. Yang, “Conet: Collaborative cross networks for cross-domain recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 27th ACM international conference on information and knowledge management</em>, 2018, pp. 667–676.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(9)</span>
<span class="ltx_bibblock">
M. Liu, J. Li, G. Li, and P. Pan, “Cross domain recommendation via bi-directional transfer graph collaborative filtering networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 29th ACM international conference on information &amp; knowledge management</em>, 2020, pp. 885–894.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(10)</span>
<span class="ltx_bibblock">
——, “Cross domain recommendation via bi-directional transfer graph collaborative filtering networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the 29th ACM international conference on information &amp; knowledge management</em>, 2020, pp. 885–894.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(11)</span>
<span class="ltx_bibblock">
H. Yan, X. Chen, C. Gao, Y. Li, and D. Jin, “Deepapf: Deep attentive probabilistic factorization for multi-site video recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">TC</em>, vol. 2, no. 130, pp. 17–883, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(12)</span>
<span class="ltx_bibblock">
F. Sun, J. Liu, J. Wu, C. Pei, X. Lin, W. Ou, and P. Jiang, “Bert4rec: Sequential recommendation with bidirectional encoder representations from transformer,” in <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>, 2019, pp. 1441–1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(13)</span>
<span class="ltx_bibblock">
Z. Fu, C. Wang, and J. Xu, “Graph contextualized self-attention network for software service sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Future Generation Computer Systems</em>, vol. 149, pp. 509–517, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(14)</span>
<span class="ltx_bibblock">
H. Ying, F. Zhuang, F. Zhang, Y. Liu, G. Xu, X. Xie, H. Xiong, and J. Wu, “Sequential recommender system based on hierarchical attention network,” in <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">IJCAI international joint conference on artificial intelligence</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(15)</span>
<span class="ltx_bibblock">
Y. Hou, B. Hu, Z. Zhang, and W. X. Zhao, “Core: simple and effective session-based recommendation within consistent representation space,” in <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 45th international ACM SIGIR conference on research and development in information retrieval</em>, 2022, pp. 1796–1801.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(16)</span>
<span class="ltx_bibblock">
Q. Liu, Y. Zeng, R. Mokhosi, and H. Zhang, “Stamp: short-term attention/memory priority model for session-based recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>, 2018, pp. 1831–1839.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(17)</span>
<span class="ltx_bibblock">
Y. K. Tan, X. Xu, and Y. Liu, “Improved recurrent neural networks for session-based recommendations,” in <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 1st workshop on deep learning for recommender systems</em>, 2016, pp. 17–22.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(18)</span>
<span class="ltx_bibblock">
J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova, “Bert: Pre-training of deep bidirectional transformers for language understanding,” <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:1810.04805</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(19)</span>
<span class="ltx_bibblock">
J. Wang, C. Lan, C. Liu, Y. Ouyang, T. Qin, W. Lu, Y. Chen, W. Zeng, and S. Y. Philip, “Generalizing to unseen domains: A survey on domain generalization,” <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">IEEE transactions on knowledge and data engineering</em>, vol. 35, no. 8, pp. 8052–8072, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(20)</span>
<span class="ltx_bibblock">
F. Zhuang, Z. Qi, K. Duan, D. Xi, Y. Zhu, H. Zhu, H. Xiong, and Q. He, “A comprehensive survey on transfer learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the IEEE</em>, vol. 109, no. 1, pp. 43–76, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(21)</span>
<span class="ltx_bibblock">
A. P. Singh and G. J. Gordon, “Relational learning via collective matrix factorization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 14th ACM SIGKDD international conference on Knowledge discovery and data mining</em>, 2008, pp. 650–658.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(22)</span>
<span class="ltx_bibblock">
S. Kang, J. Hwang, D. Lee, and H. Yu, “Semi-supervised learning for cross-domain recommendation to cold-start users,” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>, 2019, pp. 1563–1572.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(23)</span>
<span class="ltx_bibblock">
T. Man, H. Shen, X. Jin, and X. Cheng, “Cross-domain recommendation: An embedding and mapping approach.” in <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">IJCAI</em>, vol. 17, 2017, pp. 2464–2470.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(24)</span>
<span class="ltx_bibblock">
W. Pan, E. Xiang, N. Liu, and Q. Yang, “Transfer learning in collaborative filtering for sparsity reduction,” in <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the AAAI conference on artificial intelligence</em>, vol. 24, no. 1, 2010, pp. 230–235.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(25)</span>
<span class="ltx_bibblock">
Y. Zhang, Y. Liu, P. Han, C. Miao, L. Cui, B. Li, and H. Tang, “Learning personalized itemset mapping for cross-domain recommendation,” 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(26)</span>
<span class="ltx_bibblock">
F. Zhu, Y. Wang, C. Chen, G. Liu, M. Orgun, and J. Wu, “A deep framework for cross-domain and cross-system recommendations,” <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2009.06215</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(27)</span>
<span class="ltx_bibblock">
H. Fang, D. Zhang, Y. Shu, and G. Guo, “Deep learning for sequential recommendation: Algorithms, influential factors, and evaluations,” <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">ACM Transactions on Information Systems (TOIS)</em>, vol. 39, no. 1, pp. 1–42, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(28)</span>
<span class="ltx_bibblock">
S. Wang, L. Hu, Y. Wang, L. Cao, Q. Z. Sheng, and M. Orgun, “Sequential recommender systems: challenges, progress and prospects,” <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2001.04830</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(29)</span>
<span class="ltx_bibblock">
R. He and J. McAuley, “Fusing similarity models with markov chains for sparse sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">2016 IEEE 16th international conference on data mining (ICDM)</em>.   IEEE, 2016, pp. 191–200.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(30)</span>
<span class="ltx_bibblock">
T. Mahmood and F. Ricci, “Learning and adaptivity in interactive recommender systems,” in <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the ninth international conference on Electronic commerce</em>, 2007, pp. 75–84.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(31)</span>
<span class="ltx_bibblock">
S. Rendle, C. Freudenthaler, and L. Schmidt-Thieme, “Factorizing personalized markov chains for next-basket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 19th international conference on World wide web</em>, 2010, pp. 811–820.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(32)</span>
<span class="ltx_bibblock">
P. Wang, J. Guo, Y. Lan, J. Xu, S. Wan, and X. Cheng, “Learning hierarchical representation model for nextbasket recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the 38th International ACM SIGIR conference on Research and Development in Information Retrieval</em>, 2015, pp. 403–412.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(33)</span>
<span class="ltx_bibblock">
Q. Cui, S. Wu, Q. Liu, W. Zhong, and L. Wang, “Mv-rnn: A multi-view recurrent neural network for sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, vol. 32, no. 2, pp. 317–331, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(34)</span>
<span class="ltx_bibblock">
T. Donkers, B. Loepp, and J. Ziegler, “Sequential user-based recurrent neural network recommendations,” in <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the eleventh ACM conference on recommender systems</em>, 2017, pp. 152–160.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(35)</span>
<span class="ltx_bibblock">
J. Tang and K. Wang, “Personalized top-n sequential recommendation via convolutional sequence embedding,” in <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the eleventh ACM international conference on web search and data mining</em>, 2018, pp. 565–573.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(36)</span>
<span class="ltx_bibblock">
A. Yan, S. Cheng, W.-C. Kang, M. Wan, and J. McAuley, “Cosrec: 2d convolutional neural networks for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>, 2019, pp. 2173–2176.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(37)</span>
<span class="ltx_bibblock">
F. Yuan, A. Karatzoglou, I. Arapakis, J. M. Jose, and X. He, “A simple convolutional generative network for next item recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Proceedings of the twelfth ACM international conference on web search and data mining</em>, 2019, pp. 582–590.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(38)</span>
<span class="ltx_bibblock">
W.-C. Kang and J. McAuley, “Self-attentive sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">2018 IEEE international conference on data mining (ICDM)</em>.   IEEE, 2018, pp. 197–206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(39)</span>
<span class="ltx_bibblock">
C. Xu, J. Feng, P. Zhao, F. Zhuang, D. Wang, Y. Liu, and V. S. Sheng, “Long-and short-term self-attention network for sequential recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Neurocomputing</em>, vol. 423, pp. 580–589, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(40)</span>
<span class="ltx_bibblock">
T. Zhang, P. Zhao, Y. Liu, V. S. Sheng, J. Xu, D. Wang, G. Liu, X. Zhou <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">et al.</em>, “Feature-level deeper self-attention network for sequential recommendation.” in <em class="ltx_emph ltx_font_italic" id="bib.bib40.2.2">IJCAI</em>, 2019, pp. 4320–4326.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(41)</span>
<span class="ltx_bibblock">
L. Ouyang, J. Wu, X. Jiang, D. Almeida, C. Wainwright, P. Mishkin, C. Zhang, S. Agarwal, K. Slama, A. Ray <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">et al.</em>, “Training language models to follow instructions with human feedback,” <em class="ltx_emph ltx_font_italic" id="bib.bib41.2.2">Advances in neural information processing systems</em>, vol. 35, pp. 27 730–27 744, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(42)</span>
<span class="ltx_bibblock">
F. Yuan, X. He, A. Karatzoglou, and L. Zhang, “Parameter-efficient transfer from sequential behaviors for user modeling and recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval</em>, 2020, pp. 1469–1478.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(43)</span>
<span class="ltx_bibblock">
R. Qiu, Z. Huang, H. Yin, and Z. Wang, “Contrastive learning for representation degeneration problem in sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the fifteenth ACM international conference on web search and data mining</em>, 2022, pp. 813–823.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(44)</span>
<span class="ltx_bibblock">
Z. Wang, H. Liu, W. Wei, Y. Hu, X.-L. Mao, S. He, R. Fang, and D. Chen, “Multi-level contrastive learning framework for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</em>, 2022, pp. 2098–2107.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(45)</span>
<span class="ltx_bibblock">
X. Xie, F. Sun, Z. Liu, S. Wu, J. Gao, J. Zhang, B. Ding, and B. Cui, “Contrastive learning for sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">2022 IEEE 38th international conference on data engineering (ICDE)</em>.   IEEE, 2022, pp. 1259–1273.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(46)</span>
<span class="ltx_bibblock">
Z. Wang, S. Shen, Z. Wang, B. Chen, X. Chen, and J.-R. Wen, “Unbiased sequential recommendation with latent confounders,” in <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the ACM Web Conference 2022</em>, 2022, pp. 2195–2204.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(47)</span>
<span class="ltx_bibblock">
Y. Zhang, F. Feng, X. He, T. Wei, C. Song, G. Ling, and Y. Zhang, “Causal intervention for leveraging popularity bias in recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2021, pp. 11–20.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(48)</span>
<span class="ltx_bibblock">
Y. Zheng, C. Gao, X. Li, X. He, Y. Li, and D. Jin, “Disentangling user interest and conformity for recommendation with causal embedding,” in <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proceedings of the Web Conference 2021</em>, 2021, pp. 2980–2991.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(49)</span>
<span class="ltx_bibblock">
S. Geng, S. Liu, Z. Fu, Y. Ge, and Y. Zhang, “Recommendation as language processing (rlp): A unified pretrain, personalized prompt &amp; predict paradigm (p5),” in <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>, 2022, pp. 299–315.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(50)</span>
<span class="ltx_bibblock">
L. Li, Y. Zhang, and L. Chen, “Personalized prompt learning for explainable recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">ACM Transactions on Information Systems</em>, vol. 41, no. 4, pp. 1–26, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(51)</span>
<span class="ltx_bibblock">
Y. Hou, S. Mu, W. X. Zhao, Y. Li, B. Ding, and J.-R. Wen, “Towards universal sequence representation learning for recommender systems,” in <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>, 2022, pp. 585–593.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(52)</span>
<span class="ltx_bibblock">
Z. Cui, J. Ma, C. Zhou, J. Zhou, and H. Yang, “M6-rec: Generative pretrained language models are open-ended recommender systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">arXiv preprint arXiv:2205.08084</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(53)</span>
<span class="ltx_bibblock">
Z. Zhang and B. Wang, “Prompt learning for news recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2023, pp. 227–237.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(54)</span>
<span class="ltx_bibblock">
Y. Gao, T. Sheng, Y. Xiang, Y. Xiong, H. Wang, and J. Zhang, “Chat-rec: Towards interactive and explainable llms-augmented recommender system,” <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">arXiv preprint arXiv:2303.14524</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(55)</span>
<span class="ltx_bibblock">
L. Wang and E.-P. Lim, “Zero-shot next-item recommendation using large pretrained language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">arXiv preprint arXiv:2304.03153</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(56)</span>
<span class="ltx_bibblock">
Y. Koren, R. Bell, and C. Volinsky, “Matrix factorization techniques for recommender systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Computer</em>, vol. 42, no. 8, pp. 30–37, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(57)</span>
<span class="ltx_bibblock">
H. Wen, X. Yi, T. Yao, J. Tang, L. Hong, and E. H. Chi, “Distributionally-robust recommendations for improving worst-case user experience,” in <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">Proceedings of the ACM Web Conference 2022</em>, 2022, pp. 3606–3610.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(58)</span>
<span class="ltx_bibblock">
H. Guo, R. Tang, Y. Ye, Z. Li, and X. He, “Deepfm: a factorization-machine based neural network for ctr prediction,” <em class="ltx_emph ltx_font_italic" id="bib.bib58.1.1">arXiv preprint arXiv:1703.04247</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(59)</span>
<span class="ltx_bibblock">
Y. Xi, J. Lin, W. Liu, X. Dai, W. Zhang, R. Zhang, R. Tang, and Y. Yu, “A bird’s-eye view of reranking: from list level to page level,” in <em class="ltx_emph ltx_font_italic" id="bib.bib59.1.1">Proceedings of the Sixteenth ACM International Conference on Web Search and Data Mining</em>, 2023, pp. 1075–1083.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(60)</span>
<span class="ltx_bibblock">
Y. Xi, W. Liu, J. Lin, J. Zhu, B. Chen, R. Tang, W. Zhang, R. Zhang, and Y. Yu, “Towards open-world recommendation with knowledge augmentation from large language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib60.1.1">arXiv preprint arXiv:2306.10933</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(61)</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal, A. Neelakantan, P. Shyam, G. Sastry, A. Askell <em class="ltx_emph ltx_font_italic" id="bib.bib61.1.1">et al.</em>, “Language models are few-shot learners,” <em class="ltx_emph ltx_font_italic" id="bib.bib61.2.2">Advances in neural information processing systems</em>, vol. 33, pp. 1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(62)</span>
<span class="ltx_bibblock">
H. Touvron, T. Lavril, G. Izacard, X. Martinet, M.-A. Lachaux, T. Lacroix, B. Rozière, N. Goyal, E. Hambro, F. Azhar <em class="ltx_emph ltx_font_italic" id="bib.bib62.1.1">et al.</em>, “Llama: Open and efficient foundation language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib62.2.2">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(63)</span>
<span class="ltx_bibblock">
Y. Wang, Z. Jiang, Z. Chen, F. Yang, Y. Zhou, E. Cho, X. Fan, X. Huang, Y. Lu, and Y. Yang, “Recmind: Large language model powered agent for recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib63.1.1">arXiv preprint arXiv:2308.14296</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(64)</span>
<span class="ltx_bibblock">
K. Zhang, F. Zhao, Y. Kang, and X. Liu, “Memory-augmented llm personalization with short-and long-term memory coordination,” <em class="ltx_emph ltx_font_italic" id="bib.bib64.1.1">arXiv preprint arXiv:2309.11696</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(65)</span>
<span class="ltx_bibblock">
S. Rendle, C. Freudenthaler, Z. Gantner, and L. Schmidt-Thieme, “Bpr: Bayesian personalized ranking from implicit feedback,” <em class="ltx_emph ltx_font_italic" id="bib.bib65.1.1">arXiv preprint arXiv:1205.2618</em>, 2012.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib66">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(66)</span>
<span class="ltx_bibblock">
C. Cortes and V. Vapnik, “Support-vector networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib66.1.1">Machine learning</em>, vol. 20, pp. 273–297, 1995.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib67">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(67)</span>
<span class="ltx_bibblock">
K. He, H. Fan, Y. Wu, S. Xie, and R. Girshick, “Momentum contrast for unsupervised visual representation learning,” in <em class="ltx_emph ltx_font_italic" id="bib.bib67.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2020, pp. 9729–9738.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib68">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(68)</span>
<span class="ltx_bibblock">
T. Chen, S. Kornblith, M. Norouzi, and G. Hinton, “A simple framework for contrastive learning of visual representations,” in <em class="ltx_emph ltx_font_italic" id="bib.bib68.1.1">International conference on machine learning</em>.   PMLR, 2020, pp. 1597–1607.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib69">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(69)</span>
<span class="ltx_bibblock">
Z. Wu, Y. Xiong, S. X. Yu, and D. Lin, “Unsupervised feature learning via non-parametric instance discrimination,” in <em class="ltx_emph ltx_font_italic" id="bib.bib69.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 2018, pp. 3733–3742.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib70">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(70)</span>
<span class="ltx_bibblock">
M. Ye, X. Zhang, P. C. Yuen, and S.-F. Chang, “Unsupervised embedding learning via invariant and spreading instance feature,” in <em class="ltx_emph ltx_font_italic" id="bib.bib70.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2019, pp. 6210–6219.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib71">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(71)</span>
<span class="ltx_bibblock">
Y. Zheng, R. Zhang, J. Zhang, Y. Ye, Z. Luo, and Y. Ma, “Llamafactory: Unified efficient fine-tuning of 100+ language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib71.1.1">arXiv preprint arXiv:2403.13372</em>, 2024. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/2403.13372" title="">http://arxiv.org/abs/2403.13372</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib72">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(72)</span>
<span class="ltx_bibblock">
R. Rafailov, J. Hejna, R. Park, and C. Finn, “From <math alttext="r" class="ltx_Math" display="inline" id="bib.bib72.1.m1.1"><semantics id="bib.bib72.1.m1.1a"><mi id="bib.bib72.1.m1.1.1" xref="bib.bib72.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="bib.bib72.1.m1.1b"><ci id="bib.bib72.1.m1.1.1.cmml" xref="bib.bib72.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib72.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="bib.bib72.1.m1.1d">italic_r</annotation></semantics></math> to <math alttext="q^{\ast}" class="ltx_Math" display="inline" id="bib.bib72.2.m2.1"><semantics id="bib.bib72.2.m2.1a"><msup id="bib.bib72.2.m2.1.1" xref="bib.bib72.2.m2.1.1.cmml"><mi id="bib.bib72.2.m2.1.1.2" xref="bib.bib72.2.m2.1.1.2.cmml">q</mi><mo id="bib.bib72.2.m2.1.1.3" xref="bib.bib72.2.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="bib.bib72.2.m2.1b"><apply id="bib.bib72.2.m2.1.1.cmml" xref="bib.bib72.2.m2.1.1"><csymbol cd="ambiguous" id="bib.bib72.2.m2.1.1.1.cmml" xref="bib.bib72.2.m2.1.1">superscript</csymbol><ci id="bib.bib72.2.m2.1.1.2.cmml" xref="bib.bib72.2.m2.1.1.2">𝑞</ci><ci id="bib.bib72.2.m2.1.1.3.cmml" xref="bib.bib72.2.m2.1.1.3">∗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib72.2.m2.1c">q^{\ast}</annotation><annotation encoding="application/x-llamapun" id="bib.bib72.2.m2.1d">italic_q start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>: Your language model is secretly a q-function,” <em class="ltx_emph ltx_font_italic" id="bib.bib72.3.1">arXiv preprint arXiv:2404.12358</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib73">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(73)</span>
<span class="ltx_bibblock">
J. L. Herlocker, J. A. Konstan, and J. Riedl, “Explaining collaborative filtering recommendations,” in <em class="ltx_emph ltx_font_italic" id="bib.bib73.1.1">Proceedings of the 2000 ACM conference on Computer supported cooperative work</em>, 2000, pp. 241–250.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib74">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(74)</span>
<span class="ltx_bibblock">
V. Sanh, A. Webson, C. Raffel, S. H. Bach, L. Sutawika, Z. Alyafeai, A. Chaffin, A. Stiegler, T. L. Scao, A. Raja <em class="ltx_emph ltx_font_italic" id="bib.bib74.1.1">et al.</em>, “Multitask prompted training enables zero-shot task generalization,” <em class="ltx_emph ltx_font_italic" id="bib.bib74.2.2">arXiv preprint arXiv:2110.08207</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib75">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(75)</span>
<span class="ltx_bibblock">
J. Wei, M. Bosma, V. Y. Zhao, K. Guu, A. W. Yu, B. Lester, N. Du, A. M. Dai, and Q. V. Le, “Finetuned language models are zero-shot learners,” <em class="ltx_emph ltx_font_italic" id="bib.bib75.1.1">arXiv preprint arXiv:2109.01652</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib76">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(76)</span>
<span class="ltx_bibblock">
F. Zhu, C. Chen, Y. Wang, G. Liu, and X. Zheng, “Dtcdr: A framework for dual-target cross-domain recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib76.1.1">Proceedings of the 28th ACM International Conference on Information and Knowledge Management</em>, 2019, pp. 1533–1542.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib77">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(77)</span>
<span class="ltx_bibblock">
W.-C. Kang and J. McAuley, “Self-attentive sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib77.1.1">2018 IEEE international conference on data mining (ICDM)</em>.   IEEE, 2018, pp. 197–206.

</span>
</li>
</ul>
</section>
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1"></p>
</div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jun 20 07:16:34 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
