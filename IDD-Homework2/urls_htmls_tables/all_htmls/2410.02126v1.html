<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale</title>
<!--Generated on Thu Oct  3 01:02:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.02126v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx1" title="In BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2" title="In BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.SSx1" title="In Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Background</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.SSx2" title="In Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Empirical Bayesian Prior Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.SSx3" title="In Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Neural Network Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.SSx4" title="In Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Ranking Model Guided Online Learning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.SSx5" title="In Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Non-stationarity and Continual Exploration</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx3" title="In BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx3.SSx5.SSSx1" title="In Related Work ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Cold Start</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx3.SSx5.SSSx2" title="In Related Work ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Non-stationarity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx3.SSx5.SSSx3" title="In Related Work ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Online Learning to Rank</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx4" title="In BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx4.SSx5.SSSx1" title="In Experiments ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Simulation: Stationary Setting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx4.SSx5.SSSx2" title="In Experiments ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Simulation: Non-stationary Setting</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx4.SSx5.SSSx3" title="In Experiments ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Evaluations on Benchmark Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx4.SSx5.SSSx4" title="In Experiments ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Online A/B Testing</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx5" title="In BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_title">Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_smallcaps" id="id1.id1">BayesCNS</span>: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Randy Ardywibowo,
Rakesh Sunki,
Lucy Kuo,
Sankalp Nayak

</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Information Retrieval (IR) systems used in search and recommendation platforms frequently employ Learning-to-Rank (LTR) models to rank items in response to user queries. These models heavily rely on features derived from user interactions, such as clicks and engagement data. This dependence introduces cold start issues for items lacking user engagement and poses challenges in adapting to non-stationary shifts in user behavior over time. We address both challenges holistically as an online learning problem and propose BayesCNS, a Bayesian approach designed to handle cold start and non-stationary distribution shifts in search systems at scale. BayesCNS achieves this by estimating prior distributions for user-item interactions, which are continuously updated with new user interactions gathered online. This online learning procedure is guided by a ranker model, enabling efficient exploration of relevant items using contextual information provided by the ranker. We successfully deployed BayesCNS in a large-scale search system and demonstrated its efficacy through comprehensive offline and online experiments. Notably, an online A/B experiment showed a 10.60% increase in new item interactions and a 1.05% improvement in overall success metrics over the existing production baseline.</p>
</div>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Introduction</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">Information Retrieval (IR) techniques used in search and recommendation systems often use Learning-to-Rank (LTR) solutions to rank relevant items against user queries <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib32" title="">2009</a>; Zoghi et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib55" title="">2017</a>)</cite>. These LTR models heavily rely on features derived from user interactions, such as user clicks and engagement data, as they are often the most effective features for ranking items <cite class="ltx_cite ltx_citemacro_citep">(Sorokina and Cantu-Paz <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib44" title="">2016</a>; Haldar et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib19" title="">2020</a>; Yang et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib50" title="">2022</a>)</cite>. However, relying on user interaction signals in LTR can lead to several challenges. Besides being noisy, user interaction data is sparse for new and tail items <cite class="ltx_cite ltx_citemacro_citep">(Joachims <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib26" title="">2002</a>; Lam et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib29" title="">2008</a>)</cite>. This leads to cold start issues, where new items are ranked poorly and receive no user engagement. User interaction signals are also dynamic and non-stationary, changing due to seasonality, long-term trends, or through repeated interactions with the search system as a whole <cite class="ltx_cite ltx_citemacro_citep">(Kulkarni et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib28" title="">2011</a>; Moore et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib35" title="">2013</a>)</cite>.</p>
</div>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.1">Performing exploration over item recommendations may alleviate cold start issues by providing a wider selection of items to users. However, naively doing so may come at the expense of key business metrics <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib24" title="">2011</a>)</cite>. Indeed, over-exploration of items can hurt search quality metrics, and recommending irrelevant items can damage user trust <cite class="ltx_cite ltx_citemacro_citep">(Schnabel et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib40" title="">2018</a>)</cite>. On the other hand, under-exploration may prevent the search system from adapting to shifts in user behavior over time <cite class="ltx_cite ltx_citemacro_citep">(Pereira et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib37" title="">2018</a>)</cite>.</p>
</div>
<div class="ltx_para" id="Sx1.p3">
<p class="ltx_p" id="Sx1.p3.1">Though both cold start and non-stationarity of user interaction features are closely related and common problems in search and recommendation systems, to the best of our knowledge, no method attempts to address these issues holistically at scale <cite class="ltx_cite ltx_citemacro_citep">(Al-Ghossein, Abdessalem, and Barré <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib3" title="">2021</a>)</cite>. Existing methods that solve cold start rely on heuristics to selectively boost item rankings <cite class="ltx_cite ltx_citemacro_citep">(Taank, Cao, and Gattani <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib45" title="">2017</a>; Haldar et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib19" title="">2020</a>)</cite>, or auxiliary information to make up for the absence of interaction data <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib31" title="">2019</a>; Saveski and Mantrach <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib39" title="">2014</a>; Zhu et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib54" title="">2020</a>; Gantner et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib16" title="">2010</a>; Missault et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib33" title="">2021</a>)</cite>. Meanwhile, non-stationary distribution shifts are handled in practice by periodic model retraining, which is costly and unstable due to the varying quality of data collected online <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib22" title="">2014</a>; Ash and Adams <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib4" title="">2020</a>; Haldar et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib19" title="">2020</a>; Coleman et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib12" title="">2024</a>; Chaney, Stewart, and Engelhardt <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib11" title="">2018</a>)</cite>.</p>
</div>
<div class="ltx_para" id="Sx1.p4">
<p class="ltx_p" id="Sx1.p4.1">Bayesian modeling offers a way to principally handle the dynamic and uncertain nature of these user interaction features <cite class="ltx_cite ltx_citemacro_citep">(Barber <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib5" title="">2012</a>)</cite>. Under a Bayesian paradigm, one can model the prior distribution of the user interaction features which can be updated in real time as new data is observed under non-stationary distribution shifts <cite class="ltx_cite ltx_citemacro_citep">(Casella <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib9" title="">1985</a>; Russo et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib38" title="">2018</a>)</cite>. The posterior distribution can then inform an online learning algorithm which uses both the user interaction feature estimates and the contextual query-item features to rank items accordingly.</p>
</div>
<div class="ltx_para" id="Sx1.p5">
<p class="ltx_p" id="Sx1.p5.1">Despite their advantages, Bayesian methods are computationally demanding, as exact estimation of the posterior distribution is intractable. Promisingly, recent variational inference approaches that use neural networks enable modeling expressive distributions and allow efficient updates approximating the posterior distribution <cite class="ltx_cite ltx_citemacro_citep">(Yin and Zhou <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib51" title="">2018</a>; Molchanov et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib34" title="">2019</a>; Kingma et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib27" title="">2021</a>)</cite>. However, their application to address cold start and non-stationarity in recommendation systems has not been previously explored.</p>
</div>
<div class="ltx_para" id="Sx1.p6">
<p class="ltx_p" id="Sx1.p6.1">To this end, we propose BayesCNS: a unified Bayesian approach holistically addressing cold start and non-stationarity in search systems at scale. We formulate our approach as a Bayesian online learning problem. Using an empirical Bayesian formulation, we learn expressive prior distributions of user-item interactions based on contextual features. We use this learned prior to perform online learning under non-stationarity using a Thompson sampling algorithm, allowing us to update our prior estimates and continually learn from new data to maximize a specified cumulative reward. Our method interfaces with a ranker model, enabling <span class="ltx_text ltx_font_italic" id="Sx1.p6.1.1">ranker-guided online learning</span> to efficiently explore the space of relevant items based on the contextual information provided by the ranker. To summarize, our contributions are as follows:</p>
<ul class="ltx_itemize" id="Sx1.I1">
<li class="ltx_item" id="Sx1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i1.p1">
<p class="ltx_p" id="Sx1.I1.i1.p1.1">We develop a unified method to deal with item cold start and non-stationarity in large scale search and recommendation systems.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i2.p1">
<p class="ltx_p" id="Sx1.I1.i2.p1.1">We develop an empirical Bayesian model that, using a novel deep neural network parameterization, estimates the prior distribution of user-item interactions based on contextual features.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i3.p1">
<p class="ltx_p" id="Sx1.I1.i3.p1.1">We present an efficient method to perform online learning under non-stationarity which can be applied to any ranker model commonly used in search and recommendation systems.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i4.p1">
<p class="ltx_p" id="Sx1.I1.i4.p1.1">We apply our approach to a search system at scale and conduct comprehensive offline and online experiments showing the efficacy of our method. Notably, an online A/B test we conducted shows an improvement in overall new item interactions by 10.60%, and an improvement of 1.05% in overall success rate compared to baseline using our proposed approach.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="Sx1.p6.2">We describe our methodology, related work, and experiments conducted in greater detail in the following sections.</p>
</div>
</section>
<section class="ltx_section" id="Sx2">
<h2 class="ltx_title ltx_title_section">Methodology</h2>
<figure class="ltx_figure" id="Sx2.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Sx2.F1.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="221" id="Sx2.F1.1.g1" src="x1.png" width="581"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="Sx2.F1.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_portrait" height="260" id="Sx2.F1.2.g1" src="x2.png" width="207"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="Sx2.F1.33.1">(a)</span> An Illustration of our proposed approach. The contextual query-item features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.F1.17.m1.1"><semantics id="Sx2.F1.17.m1.1b"><mi id="Sx2.F1.17.m1.1.1" xref="Sx2.F1.17.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.F1.17.m1.1c"><ci id="Sx2.F1.17.m1.1.1.cmml" xref="Sx2.F1.17.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.17.m1.1d">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.17.m1.1e">bold_italic_z</annotation></semantics></math> is used to construct a learned prior model <math alttext="f_{\boldsymbol{\theta}}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.F1.18.m2.1"><semantics id="Sx2.F1.18.m2.1b"><mrow id="Sx2.F1.18.m2.1.2" xref="Sx2.F1.18.m2.1.2.cmml"><msub id="Sx2.F1.18.m2.1.2.2" xref="Sx2.F1.18.m2.1.2.2.cmml"><mi id="Sx2.F1.18.m2.1.2.2.2" xref="Sx2.F1.18.m2.1.2.2.2.cmml">f</mi><mi id="Sx2.F1.18.m2.1.2.2.3" xref="Sx2.F1.18.m2.1.2.2.3.cmml">𝜽</mi></msub><mo id="Sx2.F1.18.m2.1.2.1" xref="Sx2.F1.18.m2.1.2.1.cmml">⁢</mo><mrow id="Sx2.F1.18.m2.1.2.3.2" xref="Sx2.F1.18.m2.1.2.cmml"><mo id="Sx2.F1.18.m2.1.2.3.2.1" stretchy="false" xref="Sx2.F1.18.m2.1.2.cmml">(</mo><mi id="Sx2.F1.18.m2.1.1" xref="Sx2.F1.18.m2.1.1.cmml">𝒛</mi><mo id="Sx2.F1.18.m2.1.2.3.2.2" stretchy="false" xref="Sx2.F1.18.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.F1.18.m2.1c"><apply id="Sx2.F1.18.m2.1.2.cmml" xref="Sx2.F1.18.m2.1.2"><times id="Sx2.F1.18.m2.1.2.1.cmml" xref="Sx2.F1.18.m2.1.2.1"></times><apply id="Sx2.F1.18.m2.1.2.2.cmml" xref="Sx2.F1.18.m2.1.2.2"><csymbol cd="ambiguous" id="Sx2.F1.18.m2.1.2.2.1.cmml" xref="Sx2.F1.18.m2.1.2.2">subscript</csymbol><ci id="Sx2.F1.18.m2.1.2.2.2.cmml" xref="Sx2.F1.18.m2.1.2.2.2">𝑓</ci><ci id="Sx2.F1.18.m2.1.2.2.3.cmml" xref="Sx2.F1.18.m2.1.2.2.3">𝜽</ci></apply><ci id="Sx2.F1.18.m2.1.1.cmml" xref="Sx2.F1.18.m2.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.18.m2.1d">f_{\boldsymbol{\theta}}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.18.m2.1e">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math>. This model is used to construct prior estimates of the user interaction features <math alttext="p(\boldsymbol{x}|\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.F1.19.m3.1"><semantics id="Sx2.F1.19.m3.1b"><mrow id="Sx2.F1.19.m3.1.1" xref="Sx2.F1.19.m3.1.1.cmml"><mi id="Sx2.F1.19.m3.1.1.3" xref="Sx2.F1.19.m3.1.1.3.cmml">p</mi><mo id="Sx2.F1.19.m3.1.1.2" xref="Sx2.F1.19.m3.1.1.2.cmml">⁢</mo><mrow id="Sx2.F1.19.m3.1.1.1.1" xref="Sx2.F1.19.m3.1.1.1.1.1.cmml"><mo id="Sx2.F1.19.m3.1.1.1.1.2" stretchy="false" xref="Sx2.F1.19.m3.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.F1.19.m3.1.1.1.1.1" xref="Sx2.F1.19.m3.1.1.1.1.1.cmml"><mi id="Sx2.F1.19.m3.1.1.1.1.1.2" xref="Sx2.F1.19.m3.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="Sx2.F1.19.m3.1.1.1.1.1.1" xref="Sx2.F1.19.m3.1.1.1.1.1.1.cmml">|</mo><mi id="Sx2.F1.19.m3.1.1.1.1.1.3" xref="Sx2.F1.19.m3.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo id="Sx2.F1.19.m3.1.1.1.1.3" stretchy="false" xref="Sx2.F1.19.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.F1.19.m3.1c"><apply id="Sx2.F1.19.m3.1.1.cmml" xref="Sx2.F1.19.m3.1.1"><times id="Sx2.F1.19.m3.1.1.2.cmml" xref="Sx2.F1.19.m3.1.1.2"></times><ci id="Sx2.F1.19.m3.1.1.3.cmml" xref="Sx2.F1.19.m3.1.1.3">𝑝</ci><apply id="Sx2.F1.19.m3.1.1.1.1.1.cmml" xref="Sx2.F1.19.m3.1.1.1.1"><csymbol cd="latexml" id="Sx2.F1.19.m3.1.1.1.1.1.1.cmml" xref="Sx2.F1.19.m3.1.1.1.1.1.1">conditional</csymbol><ci id="Sx2.F1.19.m3.1.1.1.1.1.2.cmml" xref="Sx2.F1.19.m3.1.1.1.1.1.2">𝒙</ci><ci id="Sx2.F1.19.m3.1.1.1.1.1.3.cmml" xref="Sx2.F1.19.m3.1.1.1.1.1.3">𝒛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.19.m3.1d">p(\boldsymbol{x}|\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.19.m3.1e">italic_p ( bold_italic_x | bold_italic_z )</annotation></semantics></math>. The model then performs online learning through Thompson sampling. By providing user interaction feature estimates <math alttext="\hat{\boldsymbol{a}}" class="ltx_Math" display="inline" id="Sx2.F1.20.m4.1"><semantics id="Sx2.F1.20.m4.1b"><mover accent="true" id="Sx2.F1.20.m4.1.1" xref="Sx2.F1.20.m4.1.1.cmml"><mi id="Sx2.F1.20.m4.1.1.2" xref="Sx2.F1.20.m4.1.1.2.cmml">𝒂</mi><mo id="Sx2.F1.20.m4.1.1.1" xref="Sx2.F1.20.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="Sx2.F1.20.m4.1c"><apply id="Sx2.F1.20.m4.1.1.cmml" xref="Sx2.F1.20.m4.1.1"><ci id="Sx2.F1.20.m4.1.1.1.cmml" xref="Sx2.F1.20.m4.1.1.1">^</ci><ci id="Sx2.F1.20.m4.1.1.2.cmml" xref="Sx2.F1.20.m4.1.1.2">𝒂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.20.m4.1d">\hat{\boldsymbol{a}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.20.m4.1e">over^ start_ARG bold_italic_a end_ARG</annotation></semantics></math> to a ranking model <math alttext="p_{\boldsymbol{\psi}}(\cdot)" class="ltx_Math" display="inline" id="Sx2.F1.21.m5.1"><semantics id="Sx2.F1.21.m5.1b"><mrow id="Sx2.F1.21.m5.1.2" xref="Sx2.F1.21.m5.1.2.cmml"><msub id="Sx2.F1.21.m5.1.2.2" xref="Sx2.F1.21.m5.1.2.2.cmml"><mi id="Sx2.F1.21.m5.1.2.2.2" xref="Sx2.F1.21.m5.1.2.2.2.cmml">p</mi><mi id="Sx2.F1.21.m5.1.2.2.3" xref="Sx2.F1.21.m5.1.2.2.3.cmml">𝝍</mi></msub><mo id="Sx2.F1.21.m5.1.2.1" xref="Sx2.F1.21.m5.1.2.1.cmml">⁢</mo><mrow id="Sx2.F1.21.m5.1.2.3.2" xref="Sx2.F1.21.m5.1.2.cmml"><mo id="Sx2.F1.21.m5.1.2.3.2.1" stretchy="false" xref="Sx2.F1.21.m5.1.2.cmml">(</mo><mo id="Sx2.F1.21.m5.1.1" lspace="0em" rspace="0em" xref="Sx2.F1.21.m5.1.1.cmml">⋅</mo><mo id="Sx2.F1.21.m5.1.2.3.2.2" stretchy="false" xref="Sx2.F1.21.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.F1.21.m5.1c"><apply id="Sx2.F1.21.m5.1.2.cmml" xref="Sx2.F1.21.m5.1.2"><times id="Sx2.F1.21.m5.1.2.1.cmml" xref="Sx2.F1.21.m5.1.2.1"></times><apply id="Sx2.F1.21.m5.1.2.2.cmml" xref="Sx2.F1.21.m5.1.2.2"><csymbol cd="ambiguous" id="Sx2.F1.21.m5.1.2.2.1.cmml" xref="Sx2.F1.21.m5.1.2.2">subscript</csymbol><ci id="Sx2.F1.21.m5.1.2.2.2.cmml" xref="Sx2.F1.21.m5.1.2.2.2">𝑝</ci><ci id="Sx2.F1.21.m5.1.2.2.3.cmml" xref="Sx2.F1.21.m5.1.2.2.3">𝝍</ci></apply><ci id="Sx2.F1.21.m5.1.1.cmml" xref="Sx2.F1.21.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.21.m5.1d">p_{\boldsymbol{\psi}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.21.m5.1e">italic_p start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>, the model can explore the space of relevant rankings <math alttext="p(\boldsymbol{c}|\boldsymbol{x},\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.F1.22.m6.3"><semantics id="Sx2.F1.22.m6.3b"><mrow id="Sx2.F1.22.m6.3.3" xref="Sx2.F1.22.m6.3.3.cmml"><mi id="Sx2.F1.22.m6.3.3.3" xref="Sx2.F1.22.m6.3.3.3.cmml">p</mi><mo id="Sx2.F1.22.m6.3.3.2" xref="Sx2.F1.22.m6.3.3.2.cmml">⁢</mo><mrow id="Sx2.F1.22.m6.3.3.1.1" xref="Sx2.F1.22.m6.3.3.1.1.1.cmml"><mo id="Sx2.F1.22.m6.3.3.1.1.2" stretchy="false" xref="Sx2.F1.22.m6.3.3.1.1.1.cmml">(</mo><mrow id="Sx2.F1.22.m6.3.3.1.1.1" xref="Sx2.F1.22.m6.3.3.1.1.1.cmml"><mi id="Sx2.F1.22.m6.3.3.1.1.1.2" xref="Sx2.F1.22.m6.3.3.1.1.1.2.cmml">𝒄</mi><mo fence="false" id="Sx2.F1.22.m6.3.3.1.1.1.1" xref="Sx2.F1.22.m6.3.3.1.1.1.1.cmml">|</mo><mrow id="Sx2.F1.22.m6.3.3.1.1.1.3.2" xref="Sx2.F1.22.m6.3.3.1.1.1.3.1.cmml"><mi id="Sx2.F1.22.m6.1.1" xref="Sx2.F1.22.m6.1.1.cmml">𝒙</mi><mo id="Sx2.F1.22.m6.3.3.1.1.1.3.2.1" xref="Sx2.F1.22.m6.3.3.1.1.1.3.1.cmml">,</mo><mi id="Sx2.F1.22.m6.2.2" xref="Sx2.F1.22.m6.2.2.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.F1.22.m6.3.3.1.1.3" stretchy="false" xref="Sx2.F1.22.m6.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.F1.22.m6.3c"><apply id="Sx2.F1.22.m6.3.3.cmml" xref="Sx2.F1.22.m6.3.3"><times id="Sx2.F1.22.m6.3.3.2.cmml" xref="Sx2.F1.22.m6.3.3.2"></times><ci id="Sx2.F1.22.m6.3.3.3.cmml" xref="Sx2.F1.22.m6.3.3.3">𝑝</ci><apply id="Sx2.F1.22.m6.3.3.1.1.1.cmml" xref="Sx2.F1.22.m6.3.3.1.1"><csymbol cd="latexml" id="Sx2.F1.22.m6.3.3.1.1.1.1.cmml" xref="Sx2.F1.22.m6.3.3.1.1.1.1">conditional</csymbol><ci id="Sx2.F1.22.m6.3.3.1.1.1.2.cmml" xref="Sx2.F1.22.m6.3.3.1.1.1.2">𝒄</ci><list id="Sx2.F1.22.m6.3.3.1.1.1.3.1.cmml" xref="Sx2.F1.22.m6.3.3.1.1.1.3.2"><ci id="Sx2.F1.22.m6.1.1.cmml" xref="Sx2.F1.22.m6.1.1">𝒙</ci><ci id="Sx2.F1.22.m6.2.2.cmml" xref="Sx2.F1.22.m6.2.2">𝒛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.22.m6.3d">p(\boldsymbol{c}|\boldsymbol{x},\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.22.m6.3e">italic_p ( bold_italic_c | bold_italic_x , bold_italic_z )</annotation></semantics></math> while being guided by relevant contextual information <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.F1.23.m7.1"><semantics id="Sx2.F1.23.m7.1b"><mi id="Sx2.F1.23.m7.1.1" xref="Sx2.F1.23.m7.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.F1.23.m7.1c"><ci id="Sx2.F1.23.m7.1.1.cmml" xref="Sx2.F1.23.m7.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.23.m7.1d">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.23.m7.1e">bold_italic_z</annotation></semantics></math>. The model receives feedback rewards in the form of user interactions <math alttext="\boldsymbol{x}_{t}" class="ltx_Math" display="inline" id="Sx2.F1.24.m8.1"><semantics id="Sx2.F1.24.m8.1b"><msub id="Sx2.F1.24.m8.1.1" xref="Sx2.F1.24.m8.1.1.cmml"><mi id="Sx2.F1.24.m8.1.1.2" xref="Sx2.F1.24.m8.1.1.2.cmml">𝒙</mi><mi id="Sx2.F1.24.m8.1.1.3" xref="Sx2.F1.24.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.F1.24.m8.1c"><apply id="Sx2.F1.24.m8.1.1.cmml" xref="Sx2.F1.24.m8.1.1"><csymbol cd="ambiguous" id="Sx2.F1.24.m8.1.1.1.cmml" xref="Sx2.F1.24.m8.1.1">subscript</csymbol><ci id="Sx2.F1.24.m8.1.1.2.cmml" xref="Sx2.F1.24.m8.1.1.2">𝒙</ci><ci id="Sx2.F1.24.m8.1.1.3.cmml" xref="Sx2.F1.24.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.24.m8.1d">\boldsymbol{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.24.m8.1e">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> which are used to subsequently update the posterior distribution <math alttext="p(\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.F1.25.m9.2"><semantics id="Sx2.F1.25.m9.2b"><mrow id="Sx2.F1.25.m9.2.2" xref="Sx2.F1.25.m9.2.2.cmml"><mi id="Sx2.F1.25.m9.2.2.3" xref="Sx2.F1.25.m9.2.2.3.cmml">p</mi><mo id="Sx2.F1.25.m9.2.2.2" xref="Sx2.F1.25.m9.2.2.2.cmml">⁢</mo><mrow id="Sx2.F1.25.m9.2.2.1.1" xref="Sx2.F1.25.m9.2.2.1.1.1.cmml"><mo id="Sx2.F1.25.m9.2.2.1.1.2" stretchy="false" xref="Sx2.F1.25.m9.2.2.1.1.1.cmml">(</mo><mrow id="Sx2.F1.25.m9.2.2.1.1.1" xref="Sx2.F1.25.m9.2.2.1.1.1.cmml"><msub id="Sx2.F1.25.m9.2.2.1.1.1.3" xref="Sx2.F1.25.m9.2.2.1.1.1.3.cmml"><mi id="Sx2.F1.25.m9.2.2.1.1.1.3.2" xref="Sx2.F1.25.m9.2.2.1.1.1.3.2.cmml">𝒙</mi><mi id="Sx2.F1.25.m9.2.2.1.1.1.3.3" xref="Sx2.F1.25.m9.2.2.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="Sx2.F1.25.m9.2.2.1.1.1.2" xref="Sx2.F1.25.m9.2.2.1.1.1.2.cmml">|</mo><mrow id="Sx2.F1.25.m9.2.2.1.1.1.1.1" xref="Sx2.F1.25.m9.2.2.1.1.1.1.2.cmml"><msub id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.cmml"><mi id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.2" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.cmml"><mn id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.2" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.2" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.1" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.3" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="Sx2.F1.25.m9.2.2.1.1.1.1.1.2" xref="Sx2.F1.25.m9.2.2.1.1.1.1.2.cmml">,</mo><mi id="Sx2.F1.25.m9.1.1" xref="Sx2.F1.25.m9.1.1.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.F1.25.m9.2.2.1.1.3" stretchy="false" xref="Sx2.F1.25.m9.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.F1.25.m9.2c"><apply id="Sx2.F1.25.m9.2.2.cmml" xref="Sx2.F1.25.m9.2.2"><times id="Sx2.F1.25.m9.2.2.2.cmml" xref="Sx2.F1.25.m9.2.2.2"></times><ci id="Sx2.F1.25.m9.2.2.3.cmml" xref="Sx2.F1.25.m9.2.2.3">𝑝</ci><apply id="Sx2.F1.25.m9.2.2.1.1.1.cmml" xref="Sx2.F1.25.m9.2.2.1.1"><csymbol cd="latexml" id="Sx2.F1.25.m9.2.2.1.1.1.2.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.2">conditional</csymbol><apply id="Sx2.F1.25.m9.2.2.1.1.1.3.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.F1.25.m9.2.2.1.1.1.3.1.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.3">subscript</csymbol><ci id="Sx2.F1.25.m9.2.2.1.1.1.3.2.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.3.2">𝒙</ci><ci id="Sx2.F1.25.m9.2.2.1.1.1.3.3.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.3.3">𝑡</ci></apply><list id="Sx2.F1.25.m9.2.2.1.1.1.1.2.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1"><apply id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.2.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.2">𝒙</ci><apply id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3"><ci id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.1.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.1">:</ci><cn id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.2">1</cn><apply id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3"><minus id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.1"></minus><ci id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.F1.25.m9.2.2.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="Sx2.F1.25.m9.1.1.cmml" xref="Sx2.F1.25.m9.1.1">𝒛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.25.m9.2d">p(\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.25.m9.2e">italic_p ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_z )</annotation></semantics></math> in the next timestep <math alttext="t" class="ltx_Math" display="inline" id="Sx2.F1.26.m10.1"><semantics id="Sx2.F1.26.m10.1b"><mi id="Sx2.F1.26.m10.1.1" xref="Sx2.F1.26.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx2.F1.26.m10.1c"><ci id="Sx2.F1.26.m10.1.1.cmml" xref="Sx2.F1.26.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.26.m10.1d">t</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.26.m10.1e">italic_t</annotation></semantics></math>. <span class="ltx_text ltx_font_bold" id="Sx2.F1.34.2">(b)</span> The neural network architecture used for <math alttext="f_{\boldsymbol{\theta}}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.F1.27.m11.1"><semantics id="Sx2.F1.27.m11.1b"><mrow id="Sx2.F1.27.m11.1.2" xref="Sx2.F1.27.m11.1.2.cmml"><msub id="Sx2.F1.27.m11.1.2.2" xref="Sx2.F1.27.m11.1.2.2.cmml"><mi id="Sx2.F1.27.m11.1.2.2.2" xref="Sx2.F1.27.m11.1.2.2.2.cmml">f</mi><mi id="Sx2.F1.27.m11.1.2.2.3" xref="Sx2.F1.27.m11.1.2.2.3.cmml">𝜽</mi></msub><mo id="Sx2.F1.27.m11.1.2.1" xref="Sx2.F1.27.m11.1.2.1.cmml">⁢</mo><mrow id="Sx2.F1.27.m11.1.2.3.2" xref="Sx2.F1.27.m11.1.2.cmml"><mo id="Sx2.F1.27.m11.1.2.3.2.1" stretchy="false" xref="Sx2.F1.27.m11.1.2.cmml">(</mo><mi id="Sx2.F1.27.m11.1.1" xref="Sx2.F1.27.m11.1.1.cmml">𝒛</mi><mo id="Sx2.F1.27.m11.1.2.3.2.2" stretchy="false" xref="Sx2.F1.27.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.F1.27.m11.1c"><apply id="Sx2.F1.27.m11.1.2.cmml" xref="Sx2.F1.27.m11.1.2"><times id="Sx2.F1.27.m11.1.2.1.cmml" xref="Sx2.F1.27.m11.1.2.1"></times><apply id="Sx2.F1.27.m11.1.2.2.cmml" xref="Sx2.F1.27.m11.1.2.2"><csymbol cd="ambiguous" id="Sx2.F1.27.m11.1.2.2.1.cmml" xref="Sx2.F1.27.m11.1.2.2">subscript</csymbol><ci id="Sx2.F1.27.m11.1.2.2.2.cmml" xref="Sx2.F1.27.m11.1.2.2.2">𝑓</ci><ci id="Sx2.F1.27.m11.1.2.2.3.cmml" xref="Sx2.F1.27.m11.1.2.2.3">𝜽</ci></apply><ci id="Sx2.F1.27.m11.1.1.cmml" xref="Sx2.F1.27.m11.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.27.m11.1d">f_{\boldsymbol{\theta}}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.27.m11.1e">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> trained to output prior parameters <math alttext="\alpha" class="ltx_Math" display="inline" id="Sx2.F1.28.m12.1"><semantics id="Sx2.F1.28.m12.1b"><mi id="Sx2.F1.28.m12.1.1" xref="Sx2.F1.28.m12.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx2.F1.28.m12.1c"><ci id="Sx2.F1.28.m12.1.1.cmml" xref="Sx2.F1.28.m12.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.28.m12.1d">\alpha</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.28.m12.1e">italic_α</annotation></semantics></math> and <math alttext="\zeta" class="ltx_Math" display="inline" id="Sx2.F1.29.m13.1"><semantics id="Sx2.F1.29.m13.1b"><mi id="Sx2.F1.29.m13.1.1" xref="Sx2.F1.29.m13.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="Sx2.F1.29.m13.1c"><ci id="Sx2.F1.29.m13.1.1.cmml" xref="Sx2.F1.29.m13.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.29.m13.1d">\zeta</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.29.m13.1e">italic_ζ</annotation></semantics></math> by optimizing a Gamma-Poisson loss function <math alttext="\mathcal{L}(\boldsymbol{\theta})" class="ltx_Math" display="inline" id="Sx2.F1.30.m14.1"><semantics id="Sx2.F1.30.m14.1b"><mrow id="Sx2.F1.30.m14.1.2" xref="Sx2.F1.30.m14.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx2.F1.30.m14.1.2.2" xref="Sx2.F1.30.m14.1.2.2.cmml">ℒ</mi><mo id="Sx2.F1.30.m14.1.2.1" xref="Sx2.F1.30.m14.1.2.1.cmml">⁢</mo><mrow id="Sx2.F1.30.m14.1.2.3.2" xref="Sx2.F1.30.m14.1.2.cmml"><mo id="Sx2.F1.30.m14.1.2.3.2.1" stretchy="false" xref="Sx2.F1.30.m14.1.2.cmml">(</mo><mi id="Sx2.F1.30.m14.1.1" xref="Sx2.F1.30.m14.1.1.cmml">𝜽</mi><mo id="Sx2.F1.30.m14.1.2.3.2.2" stretchy="false" xref="Sx2.F1.30.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.F1.30.m14.1c"><apply id="Sx2.F1.30.m14.1.2.cmml" xref="Sx2.F1.30.m14.1.2"><times id="Sx2.F1.30.m14.1.2.1.cmml" xref="Sx2.F1.30.m14.1.2.1"></times><ci id="Sx2.F1.30.m14.1.2.2.cmml" xref="Sx2.F1.30.m14.1.2.2">ℒ</ci><ci id="Sx2.F1.30.m14.1.1.cmml" xref="Sx2.F1.30.m14.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F1.30.m14.1d">\mathcal{L}(\boldsymbol{\theta})</annotation><annotation encoding="application/x-llamapun" id="Sx2.F1.30.m14.1e">caligraphic_L ( bold_italic_θ )</annotation></semantics></math>. </figcaption>
</figure>
<section class="ltx_subsection" id="Sx2.SSx1">
<h3 class="ltx_title ltx_title_subsection">Background</h3>
<div class="ltx_para" id="Sx2.SSx1.p1">
<p class="ltx_p" id="Sx2.SSx1.p1.12">A search and ranking system can be described as follows: At any given time <math alttext="t" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.1.m1.1"><semantics id="Sx2.SSx1.p1.1.m1.1a"><mi id="Sx2.SSx1.p1.1.m1.1.1" xref="Sx2.SSx1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.1.m1.1b"><ci id="Sx2.SSx1.p1.1.m1.1.1.cmml" xref="Sx2.SSx1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.1.m1.1d">italic_t</annotation></semantics></math>, a user issues a query <math alttext="q_{t}\in Q" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.2.m2.1"><semantics id="Sx2.SSx1.p1.2.m2.1a"><mrow id="Sx2.SSx1.p1.2.m2.1.1" xref="Sx2.SSx1.p1.2.m2.1.1.cmml"><msub id="Sx2.SSx1.p1.2.m2.1.1.2" xref="Sx2.SSx1.p1.2.m2.1.1.2.cmml"><mi id="Sx2.SSx1.p1.2.m2.1.1.2.2" xref="Sx2.SSx1.p1.2.m2.1.1.2.2.cmml">q</mi><mi id="Sx2.SSx1.p1.2.m2.1.1.2.3" xref="Sx2.SSx1.p1.2.m2.1.1.2.3.cmml">t</mi></msub><mo id="Sx2.SSx1.p1.2.m2.1.1.1" xref="Sx2.SSx1.p1.2.m2.1.1.1.cmml">∈</mo><mi id="Sx2.SSx1.p1.2.m2.1.1.3" xref="Sx2.SSx1.p1.2.m2.1.1.3.cmml">Q</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.2.m2.1b"><apply id="Sx2.SSx1.p1.2.m2.1.1.cmml" xref="Sx2.SSx1.p1.2.m2.1.1"><in id="Sx2.SSx1.p1.2.m2.1.1.1.cmml" xref="Sx2.SSx1.p1.2.m2.1.1.1"></in><apply id="Sx2.SSx1.p1.2.m2.1.1.2.cmml" xref="Sx2.SSx1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.2.m2.1.1.2.1.cmml" xref="Sx2.SSx1.p1.2.m2.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.p1.2.m2.1.1.2.2.cmml" xref="Sx2.SSx1.p1.2.m2.1.1.2.2">𝑞</ci><ci id="Sx2.SSx1.p1.2.m2.1.1.2.3.cmml" xref="Sx2.SSx1.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="Sx2.SSx1.p1.2.m2.1.1.3.cmml" xref="Sx2.SSx1.p1.2.m2.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.2.m2.1c">q_{t}\in Q</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.2.m2.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ italic_Q</annotation></semantics></math> to find a desired item within an index of items <math alttext="D" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.3.m3.1"><semantics id="Sx2.SSx1.p1.3.m3.1a"><mi id="Sx2.SSx1.p1.3.m3.1.1" xref="Sx2.SSx1.p1.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.3.m3.1b"><ci id="Sx2.SSx1.p1.3.m3.1.1.cmml" xref="Sx2.SSx1.p1.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.3.m3.1c">D</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.3.m3.1d">italic_D</annotation></semantics></math>. In response, the search system returns a set of <math alttext="K" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.4.m4.1"><semantics id="Sx2.SSx1.p1.4.m4.1a"><mi id="Sx2.SSx1.p1.4.m4.1.1" xref="Sx2.SSx1.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.4.m4.1b"><ci id="Sx2.SSx1.p1.4.m4.1.1.cmml" xref="Sx2.SSx1.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.4.m4.1d">italic_K</annotation></semantics></math> items <math alttext="D_{q_{t}}" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.5.m5.1"><semantics id="Sx2.SSx1.p1.5.m5.1a"><msub id="Sx2.SSx1.p1.5.m5.1.1" xref="Sx2.SSx1.p1.5.m5.1.1.cmml"><mi id="Sx2.SSx1.p1.5.m5.1.1.2" xref="Sx2.SSx1.p1.5.m5.1.1.2.cmml">D</mi><msub id="Sx2.SSx1.p1.5.m5.1.1.3" xref="Sx2.SSx1.p1.5.m5.1.1.3.cmml"><mi id="Sx2.SSx1.p1.5.m5.1.1.3.2" xref="Sx2.SSx1.p1.5.m5.1.1.3.2.cmml">q</mi><mi id="Sx2.SSx1.p1.5.m5.1.1.3.3" xref="Sx2.SSx1.p1.5.m5.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.5.m5.1b"><apply id="Sx2.SSx1.p1.5.m5.1.1.cmml" xref="Sx2.SSx1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.5.m5.1.1.1.cmml" xref="Sx2.SSx1.p1.5.m5.1.1">subscript</csymbol><ci id="Sx2.SSx1.p1.5.m5.1.1.2.cmml" xref="Sx2.SSx1.p1.5.m5.1.1.2">𝐷</ci><apply id="Sx2.SSx1.p1.5.m5.1.1.3.cmml" xref="Sx2.SSx1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.5.m5.1.1.3.1.cmml" xref="Sx2.SSx1.p1.5.m5.1.1.3">subscript</csymbol><ci id="Sx2.SSx1.p1.5.m5.1.1.3.2.cmml" xref="Sx2.SSx1.p1.5.m5.1.1.3.2">𝑞</ci><ci id="Sx2.SSx1.p1.5.m5.1.1.3.3.cmml" xref="Sx2.SSx1.p1.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.5.m5.1c">D_{q_{t}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="D_{q_{t}}\subset D" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.6.m6.1"><semantics id="Sx2.SSx1.p1.6.m6.1a"><mrow id="Sx2.SSx1.p1.6.m6.1.1" xref="Sx2.SSx1.p1.6.m6.1.1.cmml"><msub id="Sx2.SSx1.p1.6.m6.1.1.2" xref="Sx2.SSx1.p1.6.m6.1.1.2.cmml"><mi id="Sx2.SSx1.p1.6.m6.1.1.2.2" xref="Sx2.SSx1.p1.6.m6.1.1.2.2.cmml">D</mi><msub id="Sx2.SSx1.p1.6.m6.1.1.2.3" xref="Sx2.SSx1.p1.6.m6.1.1.2.3.cmml"><mi id="Sx2.SSx1.p1.6.m6.1.1.2.3.2" xref="Sx2.SSx1.p1.6.m6.1.1.2.3.2.cmml">q</mi><mi id="Sx2.SSx1.p1.6.m6.1.1.2.3.3" xref="Sx2.SSx1.p1.6.m6.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="Sx2.SSx1.p1.6.m6.1.1.1" xref="Sx2.SSx1.p1.6.m6.1.1.1.cmml">⊂</mo><mi id="Sx2.SSx1.p1.6.m6.1.1.3" xref="Sx2.SSx1.p1.6.m6.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.6.m6.1b"><apply id="Sx2.SSx1.p1.6.m6.1.1.cmml" xref="Sx2.SSx1.p1.6.m6.1.1"><subset id="Sx2.SSx1.p1.6.m6.1.1.1.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.1"></subset><apply id="Sx2.SSx1.p1.6.m6.1.1.2.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.6.m6.1.1.2.1.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.p1.6.m6.1.1.2.2.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.2.2">𝐷</ci><apply id="Sx2.SSx1.p1.6.m6.1.1.2.3.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.2.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.6.m6.1.1.2.3.1.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.2.3">subscript</csymbol><ci id="Sx2.SSx1.p1.6.m6.1.1.2.3.2.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.2.3.2">𝑞</ci><ci id="Sx2.SSx1.p1.6.m6.1.1.2.3.3.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.2.3.3">𝑡</ci></apply></apply><ci id="Sx2.SSx1.p1.6.m6.1.1.3.cmml" xref="Sx2.SSx1.p1.6.m6.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.6.m6.1c">D_{q_{t}}\subset D</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.6.m6.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⊂ italic_D</annotation></semantics></math>. The system shows <math alttext="D_{q_{t}}" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.7.m7.1"><semantics id="Sx2.SSx1.p1.7.m7.1a"><msub id="Sx2.SSx1.p1.7.m7.1.1" xref="Sx2.SSx1.p1.7.m7.1.1.cmml"><mi id="Sx2.SSx1.p1.7.m7.1.1.2" xref="Sx2.SSx1.p1.7.m7.1.1.2.cmml">D</mi><msub id="Sx2.SSx1.p1.7.m7.1.1.3" xref="Sx2.SSx1.p1.7.m7.1.1.3.cmml"><mi id="Sx2.SSx1.p1.7.m7.1.1.3.2" xref="Sx2.SSx1.p1.7.m7.1.1.3.2.cmml">q</mi><mi id="Sx2.SSx1.p1.7.m7.1.1.3.3" xref="Sx2.SSx1.p1.7.m7.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.7.m7.1b"><apply id="Sx2.SSx1.p1.7.m7.1.1.cmml" xref="Sx2.SSx1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.7.m7.1.1.1.cmml" xref="Sx2.SSx1.p1.7.m7.1.1">subscript</csymbol><ci id="Sx2.SSx1.p1.7.m7.1.1.2.cmml" xref="Sx2.SSx1.p1.7.m7.1.1.2">𝐷</ci><apply id="Sx2.SSx1.p1.7.m7.1.1.3.cmml" xref="Sx2.SSx1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.7.m7.1.1.3.1.cmml" xref="Sx2.SSx1.p1.7.m7.1.1.3">subscript</csymbol><ci id="Sx2.SSx1.p1.7.m7.1.1.3.2.cmml" xref="Sx2.SSx1.p1.7.m7.1.1.3.2">𝑞</ci><ci id="Sx2.SSx1.p1.7.m7.1.1.3.3.cmml" xref="Sx2.SSx1.p1.7.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.7.m7.1c">D_{q_{t}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.7.m7.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> as a list <math alttext="\pi_{t}:d\in D_{q_{t}}\rightarrow\{1,2,\dots,K\}" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.8.m8.4"><semantics id="Sx2.SSx1.p1.8.m8.4a"><mrow id="Sx2.SSx1.p1.8.m8.4.5" xref="Sx2.SSx1.p1.8.m8.4.5.cmml"><msub id="Sx2.SSx1.p1.8.m8.4.5.2" xref="Sx2.SSx1.p1.8.m8.4.5.2.cmml"><mi id="Sx2.SSx1.p1.8.m8.4.5.2.2" xref="Sx2.SSx1.p1.8.m8.4.5.2.2.cmml">π</mi><mi id="Sx2.SSx1.p1.8.m8.4.5.2.3" xref="Sx2.SSx1.p1.8.m8.4.5.2.3.cmml">t</mi></msub><mo id="Sx2.SSx1.p1.8.m8.4.5.1" lspace="0.278em" rspace="0.278em" xref="Sx2.SSx1.p1.8.m8.4.5.1.cmml">:</mo><mrow id="Sx2.SSx1.p1.8.m8.4.5.3" xref="Sx2.SSx1.p1.8.m8.4.5.3.cmml"><mi id="Sx2.SSx1.p1.8.m8.4.5.3.2" xref="Sx2.SSx1.p1.8.m8.4.5.3.2.cmml">d</mi><mo id="Sx2.SSx1.p1.8.m8.4.5.3.3" xref="Sx2.SSx1.p1.8.m8.4.5.3.3.cmml">∈</mo><msub id="Sx2.SSx1.p1.8.m8.4.5.3.4" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.cmml"><mi id="Sx2.SSx1.p1.8.m8.4.5.3.4.2" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.2.cmml">D</mi><msub id="Sx2.SSx1.p1.8.m8.4.5.3.4.3" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.3.cmml"><mi id="Sx2.SSx1.p1.8.m8.4.5.3.4.3.2" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.3.2.cmml">q</mi><mi id="Sx2.SSx1.p1.8.m8.4.5.3.4.3.3" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.3.3.cmml">t</mi></msub></msub><mo id="Sx2.SSx1.p1.8.m8.4.5.3.5" stretchy="false" xref="Sx2.SSx1.p1.8.m8.4.5.3.5.cmml">→</mo><mrow id="Sx2.SSx1.p1.8.m8.4.5.3.6.2" xref="Sx2.SSx1.p1.8.m8.4.5.3.6.1.cmml"><mo id="Sx2.SSx1.p1.8.m8.4.5.3.6.2.1" stretchy="false" xref="Sx2.SSx1.p1.8.m8.4.5.3.6.1.cmml">{</mo><mn id="Sx2.SSx1.p1.8.m8.1.1" xref="Sx2.SSx1.p1.8.m8.1.1.cmml">1</mn><mo id="Sx2.SSx1.p1.8.m8.4.5.3.6.2.2" xref="Sx2.SSx1.p1.8.m8.4.5.3.6.1.cmml">,</mo><mn id="Sx2.SSx1.p1.8.m8.2.2" xref="Sx2.SSx1.p1.8.m8.2.2.cmml">2</mn><mo id="Sx2.SSx1.p1.8.m8.4.5.3.6.2.3" xref="Sx2.SSx1.p1.8.m8.4.5.3.6.1.cmml">,</mo><mi id="Sx2.SSx1.p1.8.m8.3.3" mathvariant="normal" xref="Sx2.SSx1.p1.8.m8.3.3.cmml">…</mi><mo id="Sx2.SSx1.p1.8.m8.4.5.3.6.2.4" xref="Sx2.SSx1.p1.8.m8.4.5.3.6.1.cmml">,</mo><mi id="Sx2.SSx1.p1.8.m8.4.4" xref="Sx2.SSx1.p1.8.m8.4.4.cmml">K</mi><mo id="Sx2.SSx1.p1.8.m8.4.5.3.6.2.5" stretchy="false" xref="Sx2.SSx1.p1.8.m8.4.5.3.6.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.8.m8.4b"><apply id="Sx2.SSx1.p1.8.m8.4.5.cmml" xref="Sx2.SSx1.p1.8.m8.4.5"><ci id="Sx2.SSx1.p1.8.m8.4.5.1.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.1">:</ci><apply id="Sx2.SSx1.p1.8.m8.4.5.2.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.8.m8.4.5.2.1.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.2">subscript</csymbol><ci id="Sx2.SSx1.p1.8.m8.4.5.2.2.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.2.2">𝜋</ci><ci id="Sx2.SSx1.p1.8.m8.4.5.2.3.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.2.3">𝑡</ci></apply><apply id="Sx2.SSx1.p1.8.m8.4.5.3.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3"><and id="Sx2.SSx1.p1.8.m8.4.5.3a.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3"></and><apply id="Sx2.SSx1.p1.8.m8.4.5.3b.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3"><in id="Sx2.SSx1.p1.8.m8.4.5.3.3.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.3"></in><ci id="Sx2.SSx1.p1.8.m8.4.5.3.2.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.2">𝑑</ci><apply id="Sx2.SSx1.p1.8.m8.4.5.3.4.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.4"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.8.m8.4.5.3.4.1.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.4">subscript</csymbol><ci id="Sx2.SSx1.p1.8.m8.4.5.3.4.2.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.2">𝐷</ci><apply id="Sx2.SSx1.p1.8.m8.4.5.3.4.3.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.8.m8.4.5.3.4.3.1.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.3">subscript</csymbol><ci id="Sx2.SSx1.p1.8.m8.4.5.3.4.3.2.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.3.2">𝑞</ci><ci id="Sx2.SSx1.p1.8.m8.4.5.3.4.3.3.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.4.3.3">𝑡</ci></apply></apply></apply><apply id="Sx2.SSx1.p1.8.m8.4.5.3c.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3"><ci id="Sx2.SSx1.p1.8.m8.4.5.3.5.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.5">→</ci><share href="https://arxiv.org/html/2410.02126v1#Sx2.SSx1.p1.8.m8.4.5.3.4.cmml" id="Sx2.SSx1.p1.8.m8.4.5.3d.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3"></share><set id="Sx2.SSx1.p1.8.m8.4.5.3.6.1.cmml" xref="Sx2.SSx1.p1.8.m8.4.5.3.6.2"><cn id="Sx2.SSx1.p1.8.m8.1.1.cmml" type="integer" xref="Sx2.SSx1.p1.8.m8.1.1">1</cn><cn id="Sx2.SSx1.p1.8.m8.2.2.cmml" type="integer" xref="Sx2.SSx1.p1.8.m8.2.2">2</cn><ci id="Sx2.SSx1.p1.8.m8.3.3.cmml" xref="Sx2.SSx1.p1.8.m8.3.3">…</ci><ci id="Sx2.SSx1.p1.8.m8.4.4.cmml" xref="Sx2.SSx1.p1.8.m8.4.4">𝐾</ci></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.8.m8.4c">\pi_{t}:d\in D_{q_{t}}\rightarrow\{1,2,\dots,K\}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.8.m8.4d">italic_π start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT : italic_d ∈ italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT → { 1 , 2 , … , italic_K }</annotation></semantics></math> ranked according to a score function <math alttext="s:D\times Q\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.9.m9.1"><semantics id="Sx2.SSx1.p1.9.m9.1a"><mrow id="Sx2.SSx1.p1.9.m9.1.1" xref="Sx2.SSx1.p1.9.m9.1.1.cmml"><mi id="Sx2.SSx1.p1.9.m9.1.1.2" xref="Sx2.SSx1.p1.9.m9.1.1.2.cmml">s</mi><mo id="Sx2.SSx1.p1.9.m9.1.1.1" lspace="0.278em" rspace="0.278em" xref="Sx2.SSx1.p1.9.m9.1.1.1.cmml">:</mo><mrow id="Sx2.SSx1.p1.9.m9.1.1.3" xref="Sx2.SSx1.p1.9.m9.1.1.3.cmml"><mrow id="Sx2.SSx1.p1.9.m9.1.1.3.2" xref="Sx2.SSx1.p1.9.m9.1.1.3.2.cmml"><mi id="Sx2.SSx1.p1.9.m9.1.1.3.2.2" xref="Sx2.SSx1.p1.9.m9.1.1.3.2.2.cmml">D</mi><mo id="Sx2.SSx1.p1.9.m9.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="Sx2.SSx1.p1.9.m9.1.1.3.2.1.cmml">×</mo><mi id="Sx2.SSx1.p1.9.m9.1.1.3.2.3" xref="Sx2.SSx1.p1.9.m9.1.1.3.2.3.cmml">Q</mi></mrow><mo id="Sx2.SSx1.p1.9.m9.1.1.3.1" stretchy="false" xref="Sx2.SSx1.p1.9.m9.1.1.3.1.cmml">→</mo><mi id="Sx2.SSx1.p1.9.m9.1.1.3.3" xref="Sx2.SSx1.p1.9.m9.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.9.m9.1b"><apply id="Sx2.SSx1.p1.9.m9.1.1.cmml" xref="Sx2.SSx1.p1.9.m9.1.1"><ci id="Sx2.SSx1.p1.9.m9.1.1.1.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.1">:</ci><ci id="Sx2.SSx1.p1.9.m9.1.1.2.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.2">𝑠</ci><apply id="Sx2.SSx1.p1.9.m9.1.1.3.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.3"><ci id="Sx2.SSx1.p1.9.m9.1.1.3.1.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.3.1">→</ci><apply id="Sx2.SSx1.p1.9.m9.1.1.3.2.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.3.2"><times id="Sx2.SSx1.p1.9.m9.1.1.3.2.1.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.3.2.1"></times><ci id="Sx2.SSx1.p1.9.m9.1.1.3.2.2.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.3.2.2">𝐷</ci><ci id="Sx2.SSx1.p1.9.m9.1.1.3.2.3.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.3.2.3">𝑄</ci></apply><ci id="Sx2.SSx1.p1.9.m9.1.1.3.3.cmml" xref="Sx2.SSx1.p1.9.m9.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.9.m9.1c">s:D\times Q\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.9.m9.1d">italic_s : italic_D × italic_Q → blackboard_R</annotation></semantics></math> which maps document-query pairs to real valued relevance scores. Users then browse the provided results list, producing a reward signal in the form of user interactions as they engage with the system. For simplicity, we assume that the reward signal is represented as a binary reward vector <math alttext="\boldsymbol{c}_{t}\in\{0,1\}^{K}" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.10.m10.2"><semantics id="Sx2.SSx1.p1.10.m10.2a"><mrow id="Sx2.SSx1.p1.10.m10.2.3" xref="Sx2.SSx1.p1.10.m10.2.3.cmml"><msub id="Sx2.SSx1.p1.10.m10.2.3.2" xref="Sx2.SSx1.p1.10.m10.2.3.2.cmml"><mi id="Sx2.SSx1.p1.10.m10.2.3.2.2" xref="Sx2.SSx1.p1.10.m10.2.3.2.2.cmml">𝒄</mi><mi id="Sx2.SSx1.p1.10.m10.2.3.2.3" xref="Sx2.SSx1.p1.10.m10.2.3.2.3.cmml">t</mi></msub><mo id="Sx2.SSx1.p1.10.m10.2.3.1" xref="Sx2.SSx1.p1.10.m10.2.3.1.cmml">∈</mo><msup id="Sx2.SSx1.p1.10.m10.2.3.3" xref="Sx2.SSx1.p1.10.m10.2.3.3.cmml"><mrow id="Sx2.SSx1.p1.10.m10.2.3.3.2.2" xref="Sx2.SSx1.p1.10.m10.2.3.3.2.1.cmml"><mo id="Sx2.SSx1.p1.10.m10.2.3.3.2.2.1" stretchy="false" xref="Sx2.SSx1.p1.10.m10.2.3.3.2.1.cmml">{</mo><mn id="Sx2.SSx1.p1.10.m10.1.1" xref="Sx2.SSx1.p1.10.m10.1.1.cmml">0</mn><mo id="Sx2.SSx1.p1.10.m10.2.3.3.2.2.2" xref="Sx2.SSx1.p1.10.m10.2.3.3.2.1.cmml">,</mo><mn id="Sx2.SSx1.p1.10.m10.2.2" xref="Sx2.SSx1.p1.10.m10.2.2.cmml">1</mn><mo id="Sx2.SSx1.p1.10.m10.2.3.3.2.2.3" stretchy="false" xref="Sx2.SSx1.p1.10.m10.2.3.3.2.1.cmml">}</mo></mrow><mi id="Sx2.SSx1.p1.10.m10.2.3.3.3" xref="Sx2.SSx1.p1.10.m10.2.3.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.10.m10.2b"><apply id="Sx2.SSx1.p1.10.m10.2.3.cmml" xref="Sx2.SSx1.p1.10.m10.2.3"><in id="Sx2.SSx1.p1.10.m10.2.3.1.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.1"></in><apply id="Sx2.SSx1.p1.10.m10.2.3.2.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.10.m10.2.3.2.1.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.2">subscript</csymbol><ci id="Sx2.SSx1.p1.10.m10.2.3.2.2.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.2.2">𝒄</ci><ci id="Sx2.SSx1.p1.10.m10.2.3.2.3.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.2.3">𝑡</ci></apply><apply id="Sx2.SSx1.p1.10.m10.2.3.3.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.10.m10.2.3.3.1.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.3">superscript</csymbol><set id="Sx2.SSx1.p1.10.m10.2.3.3.2.1.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.3.2.2"><cn id="Sx2.SSx1.p1.10.m10.1.1.cmml" type="integer" xref="Sx2.SSx1.p1.10.m10.1.1">0</cn><cn id="Sx2.SSx1.p1.10.m10.2.2.cmml" type="integer" xref="Sx2.SSx1.p1.10.m10.2.2">1</cn></set><ci id="Sx2.SSx1.p1.10.m10.2.3.3.3.cmml" xref="Sx2.SSx1.p1.10.m10.2.3.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.10.m10.2c">\boldsymbol{c}_{t}\in\{0,1\}^{K}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.10.m10.2d">bold_italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∈ { 0 , 1 } start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="c_{t}^{d}=1" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.11.m11.1"><semantics id="Sx2.SSx1.p1.11.m11.1a"><mrow id="Sx2.SSx1.p1.11.m11.1.1" xref="Sx2.SSx1.p1.11.m11.1.1.cmml"><msubsup id="Sx2.SSx1.p1.11.m11.1.1.2" xref="Sx2.SSx1.p1.11.m11.1.1.2.cmml"><mi id="Sx2.SSx1.p1.11.m11.1.1.2.2.2" xref="Sx2.SSx1.p1.11.m11.1.1.2.2.2.cmml">c</mi><mi id="Sx2.SSx1.p1.11.m11.1.1.2.2.3" xref="Sx2.SSx1.p1.11.m11.1.1.2.2.3.cmml">t</mi><mi id="Sx2.SSx1.p1.11.m11.1.1.2.3" xref="Sx2.SSx1.p1.11.m11.1.1.2.3.cmml">d</mi></msubsup><mo id="Sx2.SSx1.p1.11.m11.1.1.1" xref="Sx2.SSx1.p1.11.m11.1.1.1.cmml">=</mo><mn id="Sx2.SSx1.p1.11.m11.1.1.3" xref="Sx2.SSx1.p1.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.11.m11.1b"><apply id="Sx2.SSx1.p1.11.m11.1.1.cmml" xref="Sx2.SSx1.p1.11.m11.1.1"><eq id="Sx2.SSx1.p1.11.m11.1.1.1.cmml" xref="Sx2.SSx1.p1.11.m11.1.1.1"></eq><apply id="Sx2.SSx1.p1.11.m11.1.1.2.cmml" xref="Sx2.SSx1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.11.m11.1.1.2.1.cmml" xref="Sx2.SSx1.p1.11.m11.1.1.2">superscript</csymbol><apply id="Sx2.SSx1.p1.11.m11.1.1.2.2.cmml" xref="Sx2.SSx1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p1.11.m11.1.1.2.2.1.cmml" xref="Sx2.SSx1.p1.11.m11.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.p1.11.m11.1.1.2.2.2.cmml" xref="Sx2.SSx1.p1.11.m11.1.1.2.2.2">𝑐</ci><ci id="Sx2.SSx1.p1.11.m11.1.1.2.2.3.cmml" xref="Sx2.SSx1.p1.11.m11.1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.SSx1.p1.11.m11.1.1.2.3.cmml" xref="Sx2.SSx1.p1.11.m11.1.1.2.3">𝑑</ci></apply><cn id="Sx2.SSx1.p1.11.m11.1.1.3.cmml" type="integer" xref="Sx2.SSx1.p1.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.11.m11.1c">c_{t}^{d}=1</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.11.m11.1d">italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT = 1</annotation></semantics></math> indicates that the user performed a favorable action, such as clicking on item <math alttext="d" class="ltx_Math" display="inline" id="Sx2.SSx1.p1.12.m12.1"><semantics id="Sx2.SSx1.p1.12.m12.1a"><mi id="Sx2.SSx1.p1.12.m12.1.1" xref="Sx2.SSx1.p1.12.m12.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p1.12.m12.1b"><ci id="Sx2.SSx1.p1.12.m12.1.1.cmml" xref="Sx2.SSx1.p1.12.m12.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p1.12.m12.1c">d</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p1.12.m12.1d">italic_d</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="Sx2.SSx1.p2">
<p class="ltx_p" id="Sx2.SSx1.p2.4">Given this setting, the goal is to learn a ranking function <math alttext="s" class="ltx_Math" display="inline" id="Sx2.SSx1.p2.1.m1.1"><semantics id="Sx2.SSx1.p2.1.m1.1a"><mi id="Sx2.SSx1.p2.1.m1.1.1" xref="Sx2.SSx1.p2.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p2.1.m1.1b"><ci id="Sx2.SSx1.p2.1.m1.1.1.cmml" xref="Sx2.SSx1.p2.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p2.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p2.1.m1.1d">italic_s</annotation></semantics></math> such that the expected cumulative reward over a period of time <math alttext="T" class="ltx_Math" display="inline" id="Sx2.SSx1.p2.2.m2.1"><semantics id="Sx2.SSx1.p2.2.m2.1a"><mi id="Sx2.SSx1.p2.2.m2.1.1" xref="Sx2.SSx1.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p2.2.m2.1b"><ci id="Sx2.SSx1.p2.2.m2.1.1.cmml" xref="Sx2.SSx1.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p2.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p2.2.m2.1d">italic_T</annotation></semantics></math>, <math alttext="\mathbb{E}[\sum_{t=0}^{T}{\left\lVert\boldsymbol{c}_{t}\right\rVert_{1}}]" class="ltx_Math" display="inline" id="Sx2.SSx1.p2.3.m3.1"><semantics id="Sx2.SSx1.p2.3.m3.1a"><mrow id="Sx2.SSx1.p2.3.m3.1.1" xref="Sx2.SSx1.p2.3.m3.1.1.cmml"><mi id="Sx2.SSx1.p2.3.m3.1.1.3" xref="Sx2.SSx1.p2.3.m3.1.1.3.cmml">𝔼</mi><mo id="Sx2.SSx1.p2.3.m3.1.1.2" xref="Sx2.SSx1.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx1.p2.3.m3.1.1.1.1" xref="Sx2.SSx1.p2.3.m3.1.1.1.2.cmml"><mo id="Sx2.SSx1.p2.3.m3.1.1.1.1.2" stretchy="false" xref="Sx2.SSx1.p2.3.m3.1.1.1.2.1.cmml">[</mo><mrow id="Sx2.SSx1.p2.3.m3.1.1.1.1.1" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.cmml"><msubsup id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.cmml"><mo id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.2" lspace="0em" rspace="0em" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.cmml"><mi id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.2" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.1" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.3" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mi id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.3" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.3.cmml">T</mi></msubsup><msub id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.cmml"><mrow id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.2.cmml"><mo fence="true" id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" stretchy="true" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.2.1.cmml">∥</mo><msub id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.2" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">𝒄</mi><mi id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.3" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.3" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.3.cmml">1</mn></msub></mrow><mo id="Sx2.SSx1.p2.3.m3.1.1.1.1.3" stretchy="false" xref="Sx2.SSx1.p2.3.m3.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p2.3.m3.1b"><apply id="Sx2.SSx1.p2.3.m3.1.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1"><times id="Sx2.SSx1.p2.3.m3.1.1.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.2"></times><ci id="Sx2.SSx1.p2.3.m3.1.1.3.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.3">𝔼</ci><apply id="Sx2.SSx1.p2.3.m3.1.1.1.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx1.p2.3.m3.1.1.1.2.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1"><apply id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2">subscript</csymbol><sum id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.2"></sum><apply id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3"><eq id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><ci id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.3.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1">subscript</csymbol><apply id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.2">𝒄</ci><ci id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><cn id="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.3.cmml" type="integer" xref="Sx2.SSx1.p2.3.m3.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p2.3.m3.1c">\mathbb{E}[\sum_{t=0}^{T}{\left\lVert\boldsymbol{c}_{t}\right\rVert_{1}}]</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p2.3.m3.1d">blackboard_E [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∥ bold_italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ]</annotation></semantics></math> is maximized. This is achieved when the items are scored according to the conditional probability of a favorable action given the query <math alttext="s(d,q_{t})=p(c_{t}^{d}|q_{t})" class="ltx_Math" display="inline" id="Sx2.SSx1.p2.4.m4.3"><semantics id="Sx2.SSx1.p2.4.m4.3a"><mrow id="Sx2.SSx1.p2.4.m4.3.3" xref="Sx2.SSx1.p2.4.m4.3.3.cmml"><mrow id="Sx2.SSx1.p2.4.m4.2.2.1" xref="Sx2.SSx1.p2.4.m4.2.2.1.cmml"><mi id="Sx2.SSx1.p2.4.m4.2.2.1.3" xref="Sx2.SSx1.p2.4.m4.2.2.1.3.cmml">s</mi><mo id="Sx2.SSx1.p2.4.m4.2.2.1.2" xref="Sx2.SSx1.p2.4.m4.2.2.1.2.cmml">⁢</mo><mrow id="Sx2.SSx1.p2.4.m4.2.2.1.1.1" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.2.cmml"><mo id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.2" stretchy="false" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.2.cmml">(</mo><mi id="Sx2.SSx1.p2.4.m4.1.1" xref="Sx2.SSx1.p2.4.m4.1.1.cmml">d</mi><mo id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.3" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.2.cmml">,</mo><msub id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.cmml"><mi id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.2" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.2.cmml">q</mi><mi id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.3" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.4" stretchy="false" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx1.p2.4.m4.3.3.3" xref="Sx2.SSx1.p2.4.m4.3.3.3.cmml">=</mo><mrow id="Sx2.SSx1.p2.4.m4.3.3.2" xref="Sx2.SSx1.p2.4.m4.3.3.2.cmml"><mi id="Sx2.SSx1.p2.4.m4.3.3.2.3" xref="Sx2.SSx1.p2.4.m4.3.3.2.3.cmml">p</mi><mo id="Sx2.SSx1.p2.4.m4.3.3.2.2" xref="Sx2.SSx1.p2.4.m4.3.3.2.2.cmml">⁢</mo><mrow id="Sx2.SSx1.p2.4.m4.3.3.2.1.1" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.cmml"><mo id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.2" stretchy="false" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.cmml">(</mo><mrow id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.cmml"><msubsup id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.cmml"><mi id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.2" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.2.cmml">c</mi><mi id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.3" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.3.cmml">t</mi><mi id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.3" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.3.cmml">d</mi></msubsup><mo fence="false" id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.1" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.1.cmml">|</mo><msub id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.cmml"><mi id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.2" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.2.cmml">q</mi><mi id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.3" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.3" stretchy="false" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p2.4.m4.3b"><apply id="Sx2.SSx1.p2.4.m4.3.3.cmml" xref="Sx2.SSx1.p2.4.m4.3.3"><eq id="Sx2.SSx1.p2.4.m4.3.3.3.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.3"></eq><apply id="Sx2.SSx1.p2.4.m4.2.2.1.cmml" xref="Sx2.SSx1.p2.4.m4.2.2.1"><times id="Sx2.SSx1.p2.4.m4.2.2.1.2.cmml" xref="Sx2.SSx1.p2.4.m4.2.2.1.2"></times><ci id="Sx2.SSx1.p2.4.m4.2.2.1.3.cmml" xref="Sx2.SSx1.p2.4.m4.2.2.1.3">𝑠</ci><interval closure="open" id="Sx2.SSx1.p2.4.m4.2.2.1.1.2.cmml" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.1"><ci id="Sx2.SSx1.p2.4.m4.1.1.cmml" xref="Sx2.SSx1.p2.4.m4.1.1">𝑑</ci><apply id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.cmml" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.1.cmml" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.2.cmml" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.2">𝑞</ci><ci id="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.3.cmml" xref="Sx2.SSx1.p2.4.m4.2.2.1.1.1.1.3">𝑡</ci></apply></interval></apply><apply id="Sx2.SSx1.p2.4.m4.3.3.2.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2"><times id="Sx2.SSx1.p2.4.m4.3.3.2.2.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.2"></times><ci id="Sx2.SSx1.p2.4.m4.3.3.2.3.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.3">𝑝</ci><apply id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1"><csymbol cd="latexml" id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.1.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.1">conditional</csymbol><apply id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.1.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2">superscript</csymbol><apply id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.1.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.2.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.2">𝑐</ci><ci id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.3.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.3.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.2.3">𝑑</ci></apply><apply id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.1.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.2.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.2">𝑞</ci><ci id="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.3.cmml" xref="Sx2.SSx1.p2.4.m4.3.3.2.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p2.4.m4.3c">s(d,q_{t})=p(c_{t}^{d}|q_{t})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p2.4.m4.3d">italic_s ( italic_d , italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_p ( italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, as</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}_{Q}\bigg{[}\sum_{t=0}^{T}{\left\lVert\boldsymbol{c}_{t}\right\rVert%
_{1}}\bigg{]}\propto\sum_{t=1}^{T}{\sum_{d\in D_{q_{t}}}{\mathbb{E}[c_{t}^{d}|%
q_{t}]}}=\sum_{t=1}^{T}{\sum_{d\in D_{q_{t}}}{p(c_{t}^{d}|q_{t})}}." class="ltx_Math" display="block" id="Sx2.E1.m1.1"><semantics id="Sx2.E1.m1.1a"><mrow id="Sx2.E1.m1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.cmml"><mrow id="Sx2.E1.m1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.cmml"><mrow id="Sx2.E1.m1.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.1.cmml"><msub id="Sx2.E1.m1.1.1.1.1.1.3" xref="Sx2.E1.m1.1.1.1.1.1.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.1.3.2" xref="Sx2.E1.m1.1.1.1.1.1.3.2.cmml">𝔼</mi><mi id="Sx2.E1.m1.1.1.1.1.1.3.3" xref="Sx2.E1.m1.1.1.1.1.1.3.3.cmml">Q</mi></msub><mo id="Sx2.E1.m1.1.1.1.1.1.2" xref="Sx2.E1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E1.m1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.1.1.2.cmml"><mo id="Sx2.E1.m1.1.1.1.1.1.1.1.2" maxsize="210%" minsize="210%" xref="Sx2.E1.m1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="Sx2.E1.m1.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.cmml"><munderover id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.2" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.1" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.3" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mi id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml">T</mi></munderover><msub id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo fence="true" id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" stretchy="true" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">∥</mo><msub id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒄</mi><mi id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo fence="true" id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" stretchy="true" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub></mrow><mo id="Sx2.E1.m1.1.1.1.1.1.1.1.3" maxsize="210%" minsize="210%" xref="Sx2.E1.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="Sx2.E1.m1.1.1.1.1.5" rspace="0.111em" xref="Sx2.E1.m1.1.1.1.1.5.cmml">∝</mo><mrow id="Sx2.E1.m1.1.1.1.1.2" xref="Sx2.E1.m1.1.1.1.1.2.cmml"><munderover id="Sx2.E1.m1.1.1.1.1.2.2" xref="Sx2.E1.m1.1.1.1.1.2.2.cmml"><mo id="Sx2.E1.m1.1.1.1.1.2.2.2.2" movablelimits="false" rspace="0em" xref="Sx2.E1.m1.1.1.1.1.2.2.2.2.cmml">∑</mo><mrow id="Sx2.E1.m1.1.1.1.1.2.2.2.3" xref="Sx2.E1.m1.1.1.1.1.2.2.2.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.2.2.2.3.2" xref="Sx2.E1.m1.1.1.1.1.2.2.2.3.2.cmml">t</mi><mo id="Sx2.E1.m1.1.1.1.1.2.2.2.3.1" xref="Sx2.E1.m1.1.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="Sx2.E1.m1.1.1.1.1.2.2.2.3.3" xref="Sx2.E1.m1.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="Sx2.E1.m1.1.1.1.1.2.2.3" xref="Sx2.E1.m1.1.1.1.1.2.2.3.cmml">T</mi></munderover><mrow id="Sx2.E1.m1.1.1.1.1.2.1" xref="Sx2.E1.m1.1.1.1.1.2.1.cmml"><munder id="Sx2.E1.m1.1.1.1.1.2.1.2" xref="Sx2.E1.m1.1.1.1.1.2.1.2.cmml"><mo id="Sx2.E1.m1.1.1.1.1.2.1.2.2" movablelimits="false" xref="Sx2.E1.m1.1.1.1.1.2.1.2.2.cmml">∑</mo><mrow id="Sx2.E1.m1.1.1.1.1.2.1.2.3" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.2.1.2.3.2" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.2.cmml">d</mi><mo id="Sx2.E1.m1.1.1.1.1.2.1.2.3.1" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.1.cmml">∈</mo><msub id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.2" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.2.cmml">D</mi><msub id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.2" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.2.cmml">q</mi><mi id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.3" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.3.cmml">t</mi></msub></msub></mrow></munder><mrow id="Sx2.E1.m1.1.1.1.1.2.1.1" xref="Sx2.E1.m1.1.1.1.1.2.1.1.cmml"><mi id="Sx2.E1.m1.1.1.1.1.2.1.1.3" xref="Sx2.E1.m1.1.1.1.1.2.1.1.3.cmml">𝔼</mi><mo id="Sx2.E1.m1.1.1.1.1.2.1.1.2" xref="Sx2.E1.m1.1.1.1.1.2.1.1.2.cmml">⁢</mo><mrow id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.2.cmml"><mo id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.2" stretchy="false" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.2.1.cmml">[</mo><mrow id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.cmml"><msubsup id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.cmml"><mi id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.2" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.3" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.3" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo fence="false" id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.1.cmml">|</mo><msub id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.2" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.2.cmml">q</mi><mi id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.3" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.3" stretchy="false" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="Sx2.E1.m1.1.1.1.1.6" rspace="0.111em" xref="Sx2.E1.m1.1.1.1.1.6.cmml">=</mo><mrow id="Sx2.E1.m1.1.1.1.1.3" xref="Sx2.E1.m1.1.1.1.1.3.cmml"><munderover id="Sx2.E1.m1.1.1.1.1.3.2" xref="Sx2.E1.m1.1.1.1.1.3.2.cmml"><mo id="Sx2.E1.m1.1.1.1.1.3.2.2.2" movablelimits="false" rspace="0em" xref="Sx2.E1.m1.1.1.1.1.3.2.2.2.cmml">∑</mo><mrow id="Sx2.E1.m1.1.1.1.1.3.2.2.3" xref="Sx2.E1.m1.1.1.1.1.3.2.2.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.3.2.2.3.2" xref="Sx2.E1.m1.1.1.1.1.3.2.2.3.2.cmml">t</mi><mo id="Sx2.E1.m1.1.1.1.1.3.2.2.3.1" xref="Sx2.E1.m1.1.1.1.1.3.2.2.3.1.cmml">=</mo><mn id="Sx2.E1.m1.1.1.1.1.3.2.2.3.3" xref="Sx2.E1.m1.1.1.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi id="Sx2.E1.m1.1.1.1.1.3.2.3" xref="Sx2.E1.m1.1.1.1.1.3.2.3.cmml">T</mi></munderover><mrow id="Sx2.E1.m1.1.1.1.1.3.1" xref="Sx2.E1.m1.1.1.1.1.3.1.cmml"><munder id="Sx2.E1.m1.1.1.1.1.3.1.2" xref="Sx2.E1.m1.1.1.1.1.3.1.2.cmml"><mo id="Sx2.E1.m1.1.1.1.1.3.1.2.2" movablelimits="false" xref="Sx2.E1.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="Sx2.E1.m1.1.1.1.1.3.1.2.3" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.3.1.2.3.2" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.2.cmml">d</mi><mo id="Sx2.E1.m1.1.1.1.1.3.1.2.3.1" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.1.cmml">∈</mo><msub id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.2" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.2.cmml">D</mi><msub id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.2" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.2.cmml">q</mi><mi id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.3" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.3.cmml">t</mi></msub></msub></mrow></munder><mrow id="Sx2.E1.m1.1.1.1.1.3.1.1" xref="Sx2.E1.m1.1.1.1.1.3.1.1.cmml"><mi id="Sx2.E1.m1.1.1.1.1.3.1.1.3" xref="Sx2.E1.m1.1.1.1.1.3.1.1.3.cmml">p</mi><mo id="Sx2.E1.m1.1.1.1.1.3.1.1.2" xref="Sx2.E1.m1.1.1.1.1.3.1.1.2.cmml">⁢</mo><mrow id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.cmml"><mo id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.2" stretchy="false" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.cmml"><msubsup id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.cmml"><mi id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.2" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.3" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.3" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo fence="false" id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.1" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.1.cmml">|</mo><msub id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.cmml"><mi id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.2" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.2.cmml">q</mi><mi id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.3" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.3" stretchy="false" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="Sx2.E1.m1.1.1.1.2" lspace="0em" xref="Sx2.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E1.m1.1b"><apply id="Sx2.E1.m1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1"><and id="Sx2.E1.m1.1.1.1.1a.cmml" xref="Sx2.E1.m1.1.1.1"></and><apply id="Sx2.E1.m1.1.1.1.1b.cmml" xref="Sx2.E1.m1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.1.1.1.1.5.cmml" xref="Sx2.E1.m1.1.1.1.1.5">proportional-to</csymbol><apply id="Sx2.E1.m1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1"><times id="Sx2.E1.m1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.2"></times><apply id="Sx2.E1.m1.1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.1.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.1.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.3.2">𝔼</ci><ci id="Sx2.E1.m1.1.1.1.1.1.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.1.3.3">𝑄</ci></apply><apply id="Sx2.E1.m1.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1"><apply id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3"><eq id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><ci id="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒄</ci><ci id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><cn id="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Sx2.E1.m1.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply><apply id="Sx2.E1.m1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2"><apply id="Sx2.E1.m1.1.1.1.1.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.2.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2">superscript</csymbol><apply id="Sx2.E1.m1.1.1.1.1.2.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.2.2.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2">subscript</csymbol><sum id="Sx2.E1.m1.1.1.1.1.2.2.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2.2.2"></sum><apply id="Sx2.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2.2.3"><eq id="Sx2.E1.m1.1.1.1.1.2.2.2.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2.2.3.1"></eq><ci id="Sx2.E1.m1.1.1.1.1.2.2.2.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2.2.3.2">𝑡</ci><cn id="Sx2.E1.m1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="Sx2.E1.m1.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="Sx2.E1.m1.1.1.1.1.2.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.2.3">𝑇</ci></apply><apply id="Sx2.E1.m1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1"><apply id="Sx2.E1.m1.1.1.1.1.2.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.2.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2">subscript</csymbol><sum id="Sx2.E1.m1.1.1.1.1.2.1.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.2"></sum><apply id="Sx2.E1.m1.1.1.1.1.2.1.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3"><in id="Sx2.E1.m1.1.1.1.1.2.1.2.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.1"></in><ci id="Sx2.E1.m1.1.1.1.1.2.1.2.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.2">𝑑</ci><apply id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.2">𝐷</ci><apply id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.2">𝑞</ci><ci id="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.2.3.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="Sx2.E1.m1.1.1.1.1.2.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1"><times id="Sx2.E1.m1.1.1.1.1.2.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.2"></times><ci id="Sx2.E1.m1.1.1.1.1.2.1.1.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.3">𝔼</ci><apply id="Sx2.E1.m1.1.1.1.1.2.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.1.1.1.1.2.1.1.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.1">conditional</csymbol><apply id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.2">𝑐</ci><ci id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.2">𝑞</ci><ci id="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply><apply id="Sx2.E1.m1.1.1.1.1c.cmml" xref="Sx2.E1.m1.1.1.1"><eq id="Sx2.E1.m1.1.1.1.1.6.cmml" xref="Sx2.E1.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2410.02126v1#Sx2.E1.m1.1.1.1.1.2.cmml" id="Sx2.E1.m1.1.1.1.1d.cmml" xref="Sx2.E1.m1.1.1.1"></share><apply id="Sx2.E1.m1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3"><apply id="Sx2.E1.m1.1.1.1.1.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.3.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2">superscript</csymbol><apply id="Sx2.E1.m1.1.1.1.1.3.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.3.2.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2">subscript</csymbol><sum id="Sx2.E1.m1.1.1.1.1.3.2.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2.2.2"></sum><apply id="Sx2.E1.m1.1.1.1.1.3.2.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2.2.3"><eq id="Sx2.E1.m1.1.1.1.1.3.2.2.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2.2.3.1"></eq><ci id="Sx2.E1.m1.1.1.1.1.3.2.2.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2.2.3.2">𝑡</ci><cn id="Sx2.E1.m1.1.1.1.1.3.2.2.3.3.cmml" type="integer" xref="Sx2.E1.m1.1.1.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="Sx2.E1.m1.1.1.1.1.3.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.2.3">𝑇</ci></apply><apply id="Sx2.E1.m1.1.1.1.1.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1"><apply id="Sx2.E1.m1.1.1.1.1.3.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.3.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2">subscript</csymbol><sum id="Sx2.E1.m1.1.1.1.1.3.1.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.2"></sum><apply id="Sx2.E1.m1.1.1.1.1.3.1.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3"><in id="Sx2.E1.m1.1.1.1.1.3.1.2.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.1"></in><ci id="Sx2.E1.m1.1.1.1.1.3.1.2.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.2">𝑑</ci><apply id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.2">𝐷</ci><apply id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.2">𝑞</ci><ci id="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.2.3.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="Sx2.E1.m1.1.1.1.1.3.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1"><times id="Sx2.E1.m1.1.1.1.1.3.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.2"></times><ci id="Sx2.E1.m1.1.1.1.1.3.1.1.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.3">𝑝</ci><apply id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1"><csymbol cd="latexml" id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.1">conditional</csymbol><apply id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.2">𝑐</ci><ci id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.1.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.2.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.2">𝑞</ci><ci id="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.3.cmml" xref="Sx2.E1.m1.1.1.1.1.3.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E1.m1.1c">\mathbb{E}_{Q}\bigg{[}\sum_{t=0}^{T}{\left\lVert\boldsymbol{c}_{t}\right\rVert%
_{1}}\bigg{]}\propto\sum_{t=1}^{T}{\sum_{d\in D_{q_{t}}}{\mathbb{E}[c_{t}^{d}|%
q_{t}]}}=\sum_{t=1}^{T}{\sum_{d\in D_{q_{t}}}{p(c_{t}^{d}|q_{t})}}.</annotation><annotation encoding="application/x-llamapun" id="Sx2.E1.m1.1d">blackboard_E start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_t = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∥ bold_italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ] ∝ ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_d ∈ italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E [ italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ] = ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_d ∈ italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_p ( italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx1.p2.6">The term is maximized when we select items <math alttext="D_{q_{t}}^{*}\subset D" class="ltx_Math" display="inline" id="Sx2.SSx1.p2.5.m1.1"><semantics id="Sx2.SSx1.p2.5.m1.1a"><mrow id="Sx2.SSx1.p2.5.m1.1.1" xref="Sx2.SSx1.p2.5.m1.1.1.cmml"><msubsup id="Sx2.SSx1.p2.5.m1.1.1.2" xref="Sx2.SSx1.p2.5.m1.1.1.2.cmml"><mi id="Sx2.SSx1.p2.5.m1.1.1.2.2.2" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.2.cmml">D</mi><msub id="Sx2.SSx1.p2.5.m1.1.1.2.2.3" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.3.cmml"><mi id="Sx2.SSx1.p2.5.m1.1.1.2.2.3.2" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.3.2.cmml">q</mi><mi id="Sx2.SSx1.p2.5.m1.1.1.2.2.3.3" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.3.3.cmml">t</mi></msub><mo id="Sx2.SSx1.p2.5.m1.1.1.2.3" xref="Sx2.SSx1.p2.5.m1.1.1.2.3.cmml">∗</mo></msubsup><mo id="Sx2.SSx1.p2.5.m1.1.1.1" xref="Sx2.SSx1.p2.5.m1.1.1.1.cmml">⊂</mo><mi id="Sx2.SSx1.p2.5.m1.1.1.3" xref="Sx2.SSx1.p2.5.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p2.5.m1.1b"><apply id="Sx2.SSx1.p2.5.m1.1.1.cmml" xref="Sx2.SSx1.p2.5.m1.1.1"><subset id="Sx2.SSx1.p2.5.m1.1.1.1.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.1"></subset><apply id="Sx2.SSx1.p2.5.m1.1.1.2.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.5.m1.1.1.2.1.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2">superscript</csymbol><apply id="Sx2.SSx1.p2.5.m1.1.1.2.2.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.5.m1.1.1.2.2.1.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.p2.5.m1.1.1.2.2.2.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.2">𝐷</ci><apply id="Sx2.SSx1.p2.5.m1.1.1.2.2.3.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.5.m1.1.1.2.2.3.1.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.3">subscript</csymbol><ci id="Sx2.SSx1.p2.5.m1.1.1.2.2.3.2.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.3.2">𝑞</ci><ci id="Sx2.SSx1.p2.5.m1.1.1.2.2.3.3.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2.2.3.3">𝑡</ci></apply></apply><times id="Sx2.SSx1.p2.5.m1.1.1.2.3.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.2.3"></times></apply><ci id="Sx2.SSx1.p2.5.m1.1.1.3.cmml" xref="Sx2.SSx1.p2.5.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p2.5.m1.1c">D_{q_{t}}^{*}\subset D</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p2.5.m1.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ⊂ italic_D</annotation></semantics></math> with the highest score <math alttext="p(c_{t}^{d}|q_{t})" class="ltx_Math" display="inline" id="Sx2.SSx1.p2.6.m2.1"><semantics id="Sx2.SSx1.p2.6.m2.1a"><mrow id="Sx2.SSx1.p2.6.m2.1.1" xref="Sx2.SSx1.p2.6.m2.1.1.cmml"><mi id="Sx2.SSx1.p2.6.m2.1.1.3" xref="Sx2.SSx1.p2.6.m2.1.1.3.cmml">p</mi><mo id="Sx2.SSx1.p2.6.m2.1.1.2" xref="Sx2.SSx1.p2.6.m2.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx1.p2.6.m2.1.1.1.1" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.cmml"><mo id="Sx2.SSx1.p2.6.m2.1.1.1.1.2" stretchy="false" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx1.p2.6.m2.1.1.1.1.1" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.cmml"><msubsup id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.cmml"><mi id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.2" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.3" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.3" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo fence="false" id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.1" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.1.cmml">|</mo><msub id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.cmml"><mi id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.2" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.2.cmml">q</mi><mi id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.3" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Sx2.SSx1.p2.6.m2.1.1.1.1.3" stretchy="false" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p2.6.m2.1b"><apply id="Sx2.SSx1.p2.6.m2.1.1.cmml" xref="Sx2.SSx1.p2.6.m2.1.1"><times id="Sx2.SSx1.p2.6.m2.1.1.2.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.2"></times><ci id="Sx2.SSx1.p2.6.m2.1.1.3.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.3">𝑝</ci><apply id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.1.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.1">conditional</csymbol><apply id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.1.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.2.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.2">𝑐</ci><ci id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.3.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.3.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.2.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.2">𝑞</ci><ci id="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx1.p2.6.m2.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p2.6.m2.1c">p(c_{t}^{d}|q_{t})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p2.6.m2.1d">italic_p ( italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D_{q_{t}}^{*}=\operatorname*{arg\,max}_{D_{q_{t}}\subset D}{\sum_{d\in D_{q_{t%
}}}{p(c_{t}^{d}|q_{t})}}." class="ltx_Math" display="block" id="Sx2.E2.m1.1"><semantics id="Sx2.E2.m1.1a"><mrow id="Sx2.E2.m1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.cmml"><mrow id="Sx2.E2.m1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.cmml"><msubsup id="Sx2.E2.m1.1.1.1.1.3" xref="Sx2.E2.m1.1.1.1.1.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.3.2.2" xref="Sx2.E2.m1.1.1.1.1.3.2.2.cmml">D</mi><msub id="Sx2.E2.m1.1.1.1.1.3.2.3" xref="Sx2.E2.m1.1.1.1.1.3.2.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.3.2.3.2" xref="Sx2.E2.m1.1.1.1.1.3.2.3.2.cmml">q</mi><mi id="Sx2.E2.m1.1.1.1.1.3.2.3.3" xref="Sx2.E2.m1.1.1.1.1.3.2.3.3.cmml">t</mi></msub><mo id="Sx2.E2.m1.1.1.1.1.3.3" xref="Sx2.E2.m1.1.1.1.1.3.3.cmml">∗</mo></msubsup><mo id="Sx2.E2.m1.1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx2.E2.m1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.cmml"><munder id="Sx2.E2.m1.1.1.1.1.1.3" xref="Sx2.E2.m1.1.1.1.1.1.3.cmml"><mrow id="Sx2.E2.m1.1.1.1.1.1.3.2" xref="Sx2.E2.m1.1.1.1.1.1.3.2.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.3.2.2" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2.cmml">arg</mi><mo id="Sx2.E2.m1.1.1.1.1.1.3.2.1" lspace="0.170em" xref="Sx2.E2.m1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mi id="Sx2.E2.m1.1.1.1.1.1.3.2.3" xref="Sx2.E2.m1.1.1.1.1.1.3.2.3.cmml">max</mi></mrow><mrow id="Sx2.E2.m1.1.1.1.1.1.3.3" xref="Sx2.E2.m1.1.1.1.1.1.3.3.cmml"><msub id="Sx2.E2.m1.1.1.1.1.1.3.3.2" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.3.3.2.2" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.2.cmml">D</mi><msub id="Sx2.E2.m1.1.1.1.1.1.3.3.2.3" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.2" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.2.cmml">q</mi><mi id="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.3" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.3.cmml">t</mi></msub></msub><mo id="Sx2.E2.m1.1.1.1.1.1.3.3.1" xref="Sx2.E2.m1.1.1.1.1.1.3.3.1.cmml">⊂</mo><mi id="Sx2.E2.m1.1.1.1.1.1.3.3.3" xref="Sx2.E2.m1.1.1.1.1.1.3.3.3.cmml">D</mi></mrow></munder><mo id="Sx2.E2.m1.1.1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E2.m1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.cmml"><munder id="Sx2.E2.m1.1.1.1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.1.1.2.cmml"><mo id="Sx2.E2.m1.1.1.1.1.1.1.2.2" movablelimits="false" xref="Sx2.E2.m1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="Sx2.E2.m1.1.1.1.1.1.1.2.3" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.1.2.3.2" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.2.cmml">d</mi><mo id="Sx2.E2.m1.1.1.1.1.1.1.2.3.1" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.2" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.2.cmml">D</mi><msub id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.2" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.2.cmml">q</mi><mi id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.3" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.3.cmml">t</mi></msub></msub></mrow></munder><mrow id="Sx2.E2.m1.1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.1.1.3" xref="Sx2.E2.m1.1.1.1.1.1.1.1.3.cmml">p</mi><mo id="Sx2.E2.m1.1.1.1.1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">c</mi><mi id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">t</mi><mi id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo fence="false" id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">q</mi><mi id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="Sx2.E2.m1.1.1.1.2" lspace="0em" xref="Sx2.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E2.m1.1b"><apply id="Sx2.E2.m1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1"><eq id="Sx2.E2.m1.1.1.1.1.2.cmml" xref="Sx2.E2.m1.1.1.1.1.2"></eq><apply id="Sx2.E2.m1.1.1.1.1.3.cmml" xref="Sx2.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.3">superscript</csymbol><apply id="Sx2.E2.m1.1.1.1.1.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.3.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.3.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.3.2.2">𝐷</ci><apply id="Sx2.E2.m1.1.1.1.1.3.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.3.2.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.3.2.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.3.2.3.2">𝑞</ci><ci id="Sx2.E2.m1.1.1.1.1.3.2.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply><times id="Sx2.E2.m1.1.1.1.1.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.3.3"></times></apply><apply id="Sx2.E2.m1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1"><times id="Sx2.E2.m1.1.1.1.1.1.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.2"></times><apply id="Sx2.E2.m1.1.1.1.1.1.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3">subscript</csymbol><apply id="Sx2.E2.m1.1.1.1.1.1.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2"><times id="Sx2.E2.m1.1.1.1.1.1.3.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2.1"></times><ci id="Sx2.E2.m1.1.1.1.1.1.3.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2.2">arg</ci><ci id="Sx2.E2.m1.1.1.1.1.1.3.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.2.3">max</ci></apply><apply id="Sx2.E2.m1.1.1.1.1.1.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3"><subset id="Sx2.E2.m1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.1"></subset><apply id="Sx2.E2.m1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.3.3.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.1.3.3.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.2">𝐷</ci><apply id="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.2">𝑞</ci><ci id="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.2.3.3">𝑡</ci></apply></apply><ci id="Sx2.E2.m1.1.1.1.1.1.3.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.3.3.3">𝐷</ci></apply></apply><apply id="Sx2.E2.m1.1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1"><apply id="Sx2.E2.m1.1.1.1.1.1.1.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="Sx2.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.2"></sum><apply id="Sx2.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3"><in id="Sx2.E2.m1.1.1.1.1.1.1.2.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.1"></in><ci id="Sx2.E2.m1.1.1.1.1.1.1.2.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.2">𝑑</ci><apply id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.2">𝐷</ci><apply id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3">subscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.2">𝑞</ci><ci id="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.2.3.3.3.3">𝑡</ci></apply></apply></apply></apply><apply id="Sx2.E2.m1.1.1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1"><times id="Sx2.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.2"></times><ci id="Sx2.E2.m1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.3">𝑝</ci><apply id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.2">𝑐</ci><ci id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><apply id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑞</ci><ci id="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E2.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E2.m1.1c">D_{q_{t}}^{*}=\operatorname*{arg\,max}_{D_{q_{t}}\subset D}{\sum_{d\in D_{q_{t%
}}}{p(c_{t}^{d}|q_{t})}}.</annotation><annotation encoding="application/x-llamapun" id="Sx2.E2.m1.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ⊂ italic_D end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_d ∈ italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_p ( italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="Sx2.SSx1.p3">
<p class="ltx_p" id="Sx2.SSx1.p3.4">The queries and items are typically represented as features, which may be derived from user interactions <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="Sx2.SSx1.p3.1.m1.1"><semantics id="Sx2.SSx1.p3.1.m1.1a"><mi id="Sx2.SSx1.p3.1.m1.1.1" xref="Sx2.SSx1.p3.1.m1.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p3.1.m1.1b"><ci id="Sx2.SSx1.p3.1.m1.1.1.cmml" xref="Sx2.SSx1.p3.1.m1.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p3.1.m1.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p3.1.m1.1d">bold_italic_x</annotation></semantics></math>, or contextual features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx1.p3.2.m2.1"><semantics id="Sx2.SSx1.p3.2.m2.1a"><mi id="Sx2.SSx1.p3.2.m2.1.1" xref="Sx2.SSx1.p3.2.m2.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p3.2.m2.1b"><ci id="Sx2.SSx1.p3.2.m2.1.1.cmml" xref="Sx2.SSx1.p3.2.m2.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p3.2.m2.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p3.2.m2.1d">bold_italic_z</annotation></semantics></math> such as item categories, keywords, or other query-item attributes. Thus, one may parameterize the score function as <math alttext="s(d,q_{t})=p(c_{t}^{d}|q_{t})\triangleq p_{\boldsymbol{\psi}}(c|\boldsymbol{x}%
,\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx1.p3.3.m3.6"><semantics id="Sx2.SSx1.p3.3.m3.6a"><mrow id="Sx2.SSx1.p3.3.m3.6.6" xref="Sx2.SSx1.p3.3.m3.6.6.cmml"><mrow id="Sx2.SSx1.p3.3.m3.4.4.1" xref="Sx2.SSx1.p3.3.m3.4.4.1.cmml"><mi id="Sx2.SSx1.p3.3.m3.4.4.1.3" xref="Sx2.SSx1.p3.3.m3.4.4.1.3.cmml">s</mi><mo id="Sx2.SSx1.p3.3.m3.4.4.1.2" xref="Sx2.SSx1.p3.3.m3.4.4.1.2.cmml">⁢</mo><mrow id="Sx2.SSx1.p3.3.m3.4.4.1.1.1" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.2.cmml"><mo id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.2" stretchy="false" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.2.cmml">(</mo><mi id="Sx2.SSx1.p3.3.m3.1.1" xref="Sx2.SSx1.p3.3.m3.1.1.cmml">d</mi><mo id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.3" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.2.cmml">,</mo><msub id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.cmml"><mi id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.2" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.2.cmml">q</mi><mi id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.3" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.3.cmml">t</mi></msub><mo id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.4" stretchy="false" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx1.p3.3.m3.6.6.5" xref="Sx2.SSx1.p3.3.m3.6.6.5.cmml">=</mo><mrow id="Sx2.SSx1.p3.3.m3.5.5.2" xref="Sx2.SSx1.p3.3.m3.5.5.2.cmml"><mi id="Sx2.SSx1.p3.3.m3.5.5.2.3" xref="Sx2.SSx1.p3.3.m3.5.5.2.3.cmml">p</mi><mo id="Sx2.SSx1.p3.3.m3.5.5.2.2" xref="Sx2.SSx1.p3.3.m3.5.5.2.2.cmml">⁢</mo><mrow id="Sx2.SSx1.p3.3.m3.5.5.2.1.1" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.cmml"><mo id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.2" stretchy="false" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.cmml">(</mo><mrow id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.cmml"><msubsup id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.cmml"><mi id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.2" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.2.cmml">c</mi><mi id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.3" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.3.cmml">t</mi><mi id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.3" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.3.cmml">d</mi></msubsup><mo fence="false" id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.1" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.1.cmml">|</mo><msub id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.cmml"><mi id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.2" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.2.cmml">q</mi><mi id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.3" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.3" stretchy="false" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx1.p3.3.m3.6.6.6" xref="Sx2.SSx1.p3.3.m3.6.6.6.cmml">≜</mo><mrow id="Sx2.SSx1.p3.3.m3.6.6.3" xref="Sx2.SSx1.p3.3.m3.6.6.3.cmml"><msub id="Sx2.SSx1.p3.3.m3.6.6.3.3" xref="Sx2.SSx1.p3.3.m3.6.6.3.3.cmml"><mi id="Sx2.SSx1.p3.3.m3.6.6.3.3.2" xref="Sx2.SSx1.p3.3.m3.6.6.3.3.2.cmml">p</mi><mi id="Sx2.SSx1.p3.3.m3.6.6.3.3.3" xref="Sx2.SSx1.p3.3.m3.6.6.3.3.3.cmml">𝝍</mi></msub><mo id="Sx2.SSx1.p3.3.m3.6.6.3.2" xref="Sx2.SSx1.p3.3.m3.6.6.3.2.cmml">⁢</mo><mrow id="Sx2.SSx1.p3.3.m3.6.6.3.1.1" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.cmml"><mo id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.2" stretchy="false" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.cmml">(</mo><mrow id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.cmml"><mi id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.2" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.2.cmml">c</mi><mo fence="false" id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.1" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.1.cmml">|</mo><mrow id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.3.2" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.3.1.cmml"><mi id="Sx2.SSx1.p3.3.m3.2.2" xref="Sx2.SSx1.p3.3.m3.2.2.cmml">𝒙</mi><mo id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.3.2.1" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.3.1.cmml">,</mo><mi id="Sx2.SSx1.p3.3.m3.3.3" xref="Sx2.SSx1.p3.3.m3.3.3.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.3" stretchy="false" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p3.3.m3.6b"><apply id="Sx2.SSx1.p3.3.m3.6.6.cmml" xref="Sx2.SSx1.p3.3.m3.6.6"><and id="Sx2.SSx1.p3.3.m3.6.6a.cmml" xref="Sx2.SSx1.p3.3.m3.6.6"></and><apply id="Sx2.SSx1.p3.3.m3.6.6b.cmml" xref="Sx2.SSx1.p3.3.m3.6.6"><eq id="Sx2.SSx1.p3.3.m3.6.6.5.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.5"></eq><apply id="Sx2.SSx1.p3.3.m3.4.4.1.cmml" xref="Sx2.SSx1.p3.3.m3.4.4.1"><times id="Sx2.SSx1.p3.3.m3.4.4.1.2.cmml" xref="Sx2.SSx1.p3.3.m3.4.4.1.2"></times><ci id="Sx2.SSx1.p3.3.m3.4.4.1.3.cmml" xref="Sx2.SSx1.p3.3.m3.4.4.1.3">𝑠</ci><interval closure="open" id="Sx2.SSx1.p3.3.m3.4.4.1.1.2.cmml" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.1"><ci id="Sx2.SSx1.p3.3.m3.1.1.cmml" xref="Sx2.SSx1.p3.3.m3.1.1">𝑑</ci><apply id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.cmml" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.1.cmml" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.2.cmml" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.2">𝑞</ci><ci id="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.3.cmml" xref="Sx2.SSx1.p3.3.m3.4.4.1.1.1.1.3">𝑡</ci></apply></interval></apply><apply id="Sx2.SSx1.p3.3.m3.5.5.2.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2"><times id="Sx2.SSx1.p3.3.m3.5.5.2.2.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.2"></times><ci id="Sx2.SSx1.p3.3.m3.5.5.2.3.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.3">𝑝</ci><apply id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1"><csymbol cd="latexml" id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.1.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.1">conditional</csymbol><apply id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.1.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2">superscript</csymbol><apply id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.1.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.2.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.2">𝑐</ci><ci id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.3.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.3.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.2.3">𝑑</ci></apply><apply id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.1.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.2.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.2">𝑞</ci><ci id="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.3.cmml" xref="Sx2.SSx1.p3.3.m3.5.5.2.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><apply id="Sx2.SSx1.p3.3.m3.6.6c.cmml" xref="Sx2.SSx1.p3.3.m3.6.6"><ci id="Sx2.SSx1.p3.3.m3.6.6.6.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.6">≜</ci><share href="https://arxiv.org/html/2410.02126v1#Sx2.SSx1.p3.3.m3.5.5.2.cmml" id="Sx2.SSx1.p3.3.m3.6.6d.cmml" xref="Sx2.SSx1.p3.3.m3.6.6"></share><apply id="Sx2.SSx1.p3.3.m3.6.6.3.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3"><times id="Sx2.SSx1.p3.3.m3.6.6.3.2.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.2"></times><apply id="Sx2.SSx1.p3.3.m3.6.6.3.3.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.3"><csymbol cd="ambiguous" id="Sx2.SSx1.p3.3.m3.6.6.3.3.1.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.3">subscript</csymbol><ci id="Sx2.SSx1.p3.3.m3.6.6.3.3.2.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.3.2">𝑝</ci><ci id="Sx2.SSx1.p3.3.m3.6.6.3.3.3.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.3.3">𝝍</ci></apply><apply id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1"><csymbol cd="latexml" id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.1.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.1">conditional</csymbol><ci id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.2.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.2">𝑐</ci><list id="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.3.1.cmml" xref="Sx2.SSx1.p3.3.m3.6.6.3.1.1.1.3.2"><ci id="Sx2.SSx1.p3.3.m3.2.2.cmml" xref="Sx2.SSx1.p3.3.m3.2.2">𝒙</ci><ci id="Sx2.SSx1.p3.3.m3.3.3.cmml" xref="Sx2.SSx1.p3.3.m3.3.3">𝒛</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p3.3.m3.6c">s(d,q_{t})=p(c_{t}^{d}|q_{t})\triangleq p_{\boldsymbol{\psi}}(c|\boldsymbol{x}%
,\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p3.3.m3.6d">italic_s ( italic_d , italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = italic_p ( italic_c start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ≜ italic_p start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( italic_c | bold_italic_x , bold_italic_z )</annotation></semantics></math>. Here, the score function is parameterized by <math alttext="\boldsymbol{\psi}" class="ltx_Math" display="inline" id="Sx2.SSx1.p3.4.m4.1"><semantics id="Sx2.SSx1.p3.4.m4.1a"><mi id="Sx2.SSx1.p3.4.m4.1.1" xref="Sx2.SSx1.p3.4.m4.1.1.cmml">𝝍</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p3.4.m4.1b"><ci id="Sx2.SSx1.p3.4.m4.1.1.cmml" xref="Sx2.SSx1.p3.4.m4.1.1">𝝍</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p3.4.m4.1c">\boldsymbol{\psi}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p3.4.m4.1d">bold_italic_ψ</annotation></semantics></math> which can be defined using any function approximator, such as decision trees or neural networks, and can be estimated by optimizing a chosen ranking objective <cite class="ltx_cite ltx_citemacro_citep">(Cao et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib8" title="">2007</a>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">rendle2012bpr</span>; Sedhain et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib43" title="">2014</a>)</cite>.</p>
</div>
<div class="ltx_para" id="Sx2.SSx1.p4">
<p class="ltx_p" id="Sx2.SSx1.p4.2">While contextual features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx1.p4.1.m1.1"><semantics id="Sx2.SSx1.p4.1.m1.1a"><mi id="Sx2.SSx1.p4.1.m1.1.1" xref="Sx2.SSx1.p4.1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p4.1.m1.1b"><ci id="Sx2.SSx1.p4.1.m1.1.1.cmml" xref="Sx2.SSx1.p4.1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p4.1.m1.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p4.1.m1.1d">bold_italic_z</annotation></semantics></math> are mostly static, user interaction features <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="Sx2.SSx1.p4.2.m2.1"><semantics id="Sx2.SSx1.p4.2.m2.1a"><mi id="Sx2.SSx1.p4.2.m2.1.1" xref="Sx2.SSx1.p4.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p4.2.m2.1b"><ci id="Sx2.SSx1.p4.2.m2.1.1.cmml" xref="Sx2.SSx1.p4.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p4.2.m2.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p4.2.m2.1d">bold_italic_x</annotation></semantics></math> are dynamic and uncertain, varying drastically due to seasonal trends <cite class="ltx_cite ltx_citemacro_citep">(Moore et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib35" title="">2013</a>)</cite>, long-term distribution shifts <cite class="ltx_cite ltx_citemacro_citep">(Abdollahpouri, Burke, and Mobasher <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib1" title="">2019</a>)</cite>, popularity biases, and cold start effects. Despite this variability, user interaction features are frequently relied upon by search and recommendation systems. Consequently, it is crucial for these systems to handle the dynamic and uncertain nature of these features scalably.</p>
</div>
<div class="ltx_para" id="Sx2.SSx1.p5">
<p class="ltx_p" id="Sx2.SSx1.p5.1">We develop an online Bayesian learning formulation to address these issues. In an empirical Bayes fashion, Our method first predicts prior distributions of the user-item interaction features based on the contextual features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx1.p5.1.m1.1"><semantics id="Sx2.SSx1.p5.1.m1.1a"><mi id="Sx2.SSx1.p5.1.m1.1.1" xref="Sx2.SSx1.p5.1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx1.p5.1.m1.1b"><ci id="Sx2.SSx1.p5.1.m1.1.1.cmml" xref="Sx2.SSx1.p5.1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx1.p5.1.m1.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx1.p5.1.m1.1d">bold_italic_z</annotation></semantics></math>. We perform Thompson sampling on these prior distributions, which provide user-item interaction estimates and receive rewards as feedback to further optimize these priors to maximize the expected cumulative reward. We describe this in further detail in the following sections.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx2.SSx2">
<h3 class="ltx_title ltx_title_subsection">Empirical Bayesian Prior Modeling</h3>
<div class="ltx_para" id="Sx2.SSx2.p1">
<p class="ltx_p" id="Sx2.SSx2.p1.6">In an empirical Bayes fashion, we are interested in estimating the prior distribution <math alttext="p(\boldsymbol{x}|\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.1.m1.1"><semantics id="Sx2.SSx2.p1.1.m1.1a"><mrow id="Sx2.SSx2.p1.1.m1.1.1" xref="Sx2.SSx2.p1.1.m1.1.1.cmml"><mi id="Sx2.SSx2.p1.1.m1.1.1.3" xref="Sx2.SSx2.p1.1.m1.1.1.3.cmml">p</mi><mo id="Sx2.SSx2.p1.1.m1.1.1.2" xref="Sx2.SSx2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx2.p1.1.m1.1.1.1.1" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.cmml"><mo id="Sx2.SSx2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx2.p1.1.m1.1.1.1.1.1" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.cmml"><mi id="Sx2.SSx2.p1.1.m1.1.1.1.1.1.2" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="Sx2.SSx2.p1.1.m1.1.1.1.1.1.1" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="Sx2.SSx2.p1.1.m1.1.1.1.1.1.3" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.3.cmml">𝒛</mi></mrow><mo id="Sx2.SSx2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.1.m1.1b"><apply id="Sx2.SSx2.p1.1.m1.1.1.cmml" xref="Sx2.SSx2.p1.1.m1.1.1"><times id="Sx2.SSx2.p1.1.m1.1.1.2.cmml" xref="Sx2.SSx2.p1.1.m1.1.1.2"></times><ci id="Sx2.SSx2.p1.1.m1.1.1.3.cmml" xref="Sx2.SSx2.p1.1.m1.1.1.3">𝑝</ci><apply id="Sx2.SSx2.p1.1.m1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx2.p1.1.m1.1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx2.SSx2.p1.1.m1.1.1.1.1.1.2.cmml" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.2">𝒙</ci><ci id="Sx2.SSx2.p1.1.m1.1.1.1.1.1.3.cmml" xref="Sx2.SSx2.p1.1.m1.1.1.1.1.1.3">𝒛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.1.m1.1c">p(\boldsymbol{x}|\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.1.m1.1d">italic_p ( bold_italic_x | bold_italic_z )</annotation></semantics></math> of user interactions <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.2.m2.1"><semantics id="Sx2.SSx2.p1.2.m2.1a"><mi id="Sx2.SSx2.p1.2.m2.1.1" xref="Sx2.SSx2.p1.2.m2.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.2.m2.1b"><ci id="Sx2.SSx2.p1.2.m2.1.1.cmml" xref="Sx2.SSx2.p1.2.m2.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.2.m2.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.2.m2.1d">bold_italic_x</annotation></semantics></math> given contextual features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.3.m3.1"><semantics id="Sx2.SSx2.p1.3.m3.1a"><mi id="Sx2.SSx2.p1.3.m3.1.1" xref="Sx2.SSx2.p1.3.m3.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.3.m3.1b"><ci id="Sx2.SSx2.p1.3.m3.1.1.cmml" xref="Sx2.SSx2.p1.3.m3.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.3.m3.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.3.m3.1d">bold_italic_z</annotation></semantics></math>, using data of existing items in our index <math alttext="(\boldsymbol{x},\boldsymbol{z})\sim D" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.4.m4.2"><semantics id="Sx2.SSx2.p1.4.m4.2a"><mrow id="Sx2.SSx2.p1.4.m4.2.3" xref="Sx2.SSx2.p1.4.m4.2.3.cmml"><mrow id="Sx2.SSx2.p1.4.m4.2.3.2.2" xref="Sx2.SSx2.p1.4.m4.2.3.2.1.cmml"><mo id="Sx2.SSx2.p1.4.m4.2.3.2.2.1" stretchy="false" xref="Sx2.SSx2.p1.4.m4.2.3.2.1.cmml">(</mo><mi id="Sx2.SSx2.p1.4.m4.1.1" xref="Sx2.SSx2.p1.4.m4.1.1.cmml">𝒙</mi><mo id="Sx2.SSx2.p1.4.m4.2.3.2.2.2" xref="Sx2.SSx2.p1.4.m4.2.3.2.1.cmml">,</mo><mi id="Sx2.SSx2.p1.4.m4.2.2" xref="Sx2.SSx2.p1.4.m4.2.2.cmml">𝒛</mi><mo id="Sx2.SSx2.p1.4.m4.2.3.2.2.3" stretchy="false" xref="Sx2.SSx2.p1.4.m4.2.3.2.1.cmml">)</mo></mrow><mo id="Sx2.SSx2.p1.4.m4.2.3.1" xref="Sx2.SSx2.p1.4.m4.2.3.1.cmml">∼</mo><mi id="Sx2.SSx2.p1.4.m4.2.3.3" xref="Sx2.SSx2.p1.4.m4.2.3.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.4.m4.2b"><apply id="Sx2.SSx2.p1.4.m4.2.3.cmml" xref="Sx2.SSx2.p1.4.m4.2.3"><csymbol cd="latexml" id="Sx2.SSx2.p1.4.m4.2.3.1.cmml" xref="Sx2.SSx2.p1.4.m4.2.3.1">similar-to</csymbol><interval closure="open" id="Sx2.SSx2.p1.4.m4.2.3.2.1.cmml" xref="Sx2.SSx2.p1.4.m4.2.3.2.2"><ci id="Sx2.SSx2.p1.4.m4.1.1.cmml" xref="Sx2.SSx2.p1.4.m4.1.1">𝒙</ci><ci id="Sx2.SSx2.p1.4.m4.2.2.cmml" xref="Sx2.SSx2.p1.4.m4.2.2">𝒛</ci></interval><ci id="Sx2.SSx2.p1.4.m4.2.3.3.cmml" xref="Sx2.SSx2.p1.4.m4.2.3.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.4.m4.2c">(\boldsymbol{x},\boldsymbol{z})\sim D</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.4.m4.2d">( bold_italic_x , bold_italic_z ) ∼ italic_D</annotation></semantics></math>. We define this distribution implicitly using a neural network. Specifically, given <math alttext="L" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.5.m5.1"><semantics id="Sx2.SSx2.p1.5.m5.1a"><mi id="Sx2.SSx2.p1.5.m5.1.1" xref="Sx2.SSx2.p1.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.5.m5.1b"><ci id="Sx2.SSx2.p1.5.m5.1.1.cmml" xref="Sx2.SSx2.p1.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.5.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.5.m5.1d">italic_L</annotation></semantics></math> user interaction features, <math alttext="\boldsymbol{x}=[x_{1},\dots,x_{L}]" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.6.m6.3"><semantics id="Sx2.SSx2.p1.6.m6.3a"><mrow id="Sx2.SSx2.p1.6.m6.3.3" xref="Sx2.SSx2.p1.6.m6.3.3.cmml"><mi id="Sx2.SSx2.p1.6.m6.3.3.4" xref="Sx2.SSx2.p1.6.m6.3.3.4.cmml">𝒙</mi><mo id="Sx2.SSx2.p1.6.m6.3.3.3" xref="Sx2.SSx2.p1.6.m6.3.3.3.cmml">=</mo><mrow id="Sx2.SSx2.p1.6.m6.3.3.2.2" xref="Sx2.SSx2.p1.6.m6.3.3.2.3.cmml"><mo id="Sx2.SSx2.p1.6.m6.3.3.2.2.3" stretchy="false" xref="Sx2.SSx2.p1.6.m6.3.3.2.3.cmml">[</mo><msub id="Sx2.SSx2.p1.6.m6.2.2.1.1.1" xref="Sx2.SSx2.p1.6.m6.2.2.1.1.1.cmml"><mi id="Sx2.SSx2.p1.6.m6.2.2.1.1.1.2" xref="Sx2.SSx2.p1.6.m6.2.2.1.1.1.2.cmml">x</mi><mn id="Sx2.SSx2.p1.6.m6.2.2.1.1.1.3" xref="Sx2.SSx2.p1.6.m6.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Sx2.SSx2.p1.6.m6.3.3.2.2.4" xref="Sx2.SSx2.p1.6.m6.3.3.2.3.cmml">,</mo><mi id="Sx2.SSx2.p1.6.m6.1.1" mathvariant="normal" xref="Sx2.SSx2.p1.6.m6.1.1.cmml">…</mi><mo id="Sx2.SSx2.p1.6.m6.3.3.2.2.5" xref="Sx2.SSx2.p1.6.m6.3.3.2.3.cmml">,</mo><msub id="Sx2.SSx2.p1.6.m6.3.3.2.2.2" xref="Sx2.SSx2.p1.6.m6.3.3.2.2.2.cmml"><mi id="Sx2.SSx2.p1.6.m6.3.3.2.2.2.2" xref="Sx2.SSx2.p1.6.m6.3.3.2.2.2.2.cmml">x</mi><mi id="Sx2.SSx2.p1.6.m6.3.3.2.2.2.3" xref="Sx2.SSx2.p1.6.m6.3.3.2.2.2.3.cmml">L</mi></msub><mo id="Sx2.SSx2.p1.6.m6.3.3.2.2.6" stretchy="false" xref="Sx2.SSx2.p1.6.m6.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.6.m6.3b"><apply id="Sx2.SSx2.p1.6.m6.3.3.cmml" xref="Sx2.SSx2.p1.6.m6.3.3"><eq id="Sx2.SSx2.p1.6.m6.3.3.3.cmml" xref="Sx2.SSx2.p1.6.m6.3.3.3"></eq><ci id="Sx2.SSx2.p1.6.m6.3.3.4.cmml" xref="Sx2.SSx2.p1.6.m6.3.3.4">𝒙</ci><list id="Sx2.SSx2.p1.6.m6.3.3.2.3.cmml" xref="Sx2.SSx2.p1.6.m6.3.3.2.2"><apply id="Sx2.SSx2.p1.6.m6.2.2.1.1.1.cmml" xref="Sx2.SSx2.p1.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p1.6.m6.2.2.1.1.1.1.cmml" xref="Sx2.SSx2.p1.6.m6.2.2.1.1.1">subscript</csymbol><ci id="Sx2.SSx2.p1.6.m6.2.2.1.1.1.2.cmml" xref="Sx2.SSx2.p1.6.m6.2.2.1.1.1.2">𝑥</ci><cn id="Sx2.SSx2.p1.6.m6.2.2.1.1.1.3.cmml" type="integer" xref="Sx2.SSx2.p1.6.m6.2.2.1.1.1.3">1</cn></apply><ci id="Sx2.SSx2.p1.6.m6.1.1.cmml" xref="Sx2.SSx2.p1.6.m6.1.1">…</ci><apply id="Sx2.SSx2.p1.6.m6.3.3.2.2.2.cmml" xref="Sx2.SSx2.p1.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx2.SSx2.p1.6.m6.3.3.2.2.2.1.cmml" xref="Sx2.SSx2.p1.6.m6.3.3.2.2.2">subscript</csymbol><ci id="Sx2.SSx2.p1.6.m6.3.3.2.2.2.2.cmml" xref="Sx2.SSx2.p1.6.m6.3.3.2.2.2.2">𝑥</ci><ci id="Sx2.SSx2.p1.6.m6.3.3.2.2.2.3.cmml" xref="Sx2.SSx2.p1.6.m6.3.3.2.2.2.3">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.6.m6.3c">\boldsymbol{x}=[x_{1},\dots,x_{L}]</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.6.m6.3d">bold_italic_x = [ italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math>, we let</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\boldsymbol{x}\sim p(\boldsymbol{x}|\boldsymbol{\phi})\triangleq\prod_{i=1}^{L%
}{p(x_{i}|\phi_{i})},\quad\boldsymbol{\phi}=f_{\boldsymbol{\theta}}(%
\boldsymbol{z})." class="ltx_Math" display="block" id="Sx2.E3.m1.2"><semantics id="Sx2.E3.m1.2a"><mrow id="Sx2.E3.m1.2.2.1"><mrow id="Sx2.E3.m1.2.2.1.1.2" xref="Sx2.E3.m1.2.2.1.1.3.cmml"><mrow id="Sx2.E3.m1.2.2.1.1.1.1" xref="Sx2.E3.m1.2.2.1.1.1.1.cmml"><mi id="Sx2.E3.m1.2.2.1.1.1.1.4" xref="Sx2.E3.m1.2.2.1.1.1.1.4.cmml">𝒙</mi><mo id="Sx2.E3.m1.2.2.1.1.1.1.5" xref="Sx2.E3.m1.2.2.1.1.1.1.5.cmml">∼</mo><mrow id="Sx2.E3.m1.2.2.1.1.1.1.1" xref="Sx2.E3.m1.2.2.1.1.1.1.1.cmml"><mi id="Sx2.E3.m1.2.2.1.1.1.1.1.3" xref="Sx2.E3.m1.2.2.1.1.1.1.1.3.cmml">p</mi><mo id="Sx2.E3.m1.2.2.1.1.1.1.1.2" xref="Sx2.E3.m1.2.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi class="ltx_mathvariant_bold-italic" id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.3" mathvariant="bold-italic" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi></mrow><mo id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E3.m1.2.2.1.1.1.1.6" rspace="0.111em" xref="Sx2.E3.m1.2.2.1.1.1.1.6.cmml">≜</mo><mrow id="Sx2.E3.m1.2.2.1.1.1.1.2" xref="Sx2.E3.m1.2.2.1.1.1.1.2.cmml"><munderover id="Sx2.E3.m1.2.2.1.1.1.1.2.2" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.cmml"><mo id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.2" movablelimits="false" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.2.cmml">∏</mo><mrow id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.cmml"><mi id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.2" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.2.cmml">i</mi><mo id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.1" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.1.cmml">=</mo><mn id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.3" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.3.cmml">1</mn></mrow><mi id="Sx2.E3.m1.2.2.1.1.1.1.2.2.3" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.3.cmml">L</mi></munderover><mrow id="Sx2.E3.m1.2.2.1.1.1.1.2.1" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.cmml"><mi id="Sx2.E3.m1.2.2.1.1.1.1.2.1.3" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.3.cmml">p</mi><mo id="Sx2.E3.m1.2.2.1.1.1.1.2.1.2" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.2.cmml">⁢</mo><mrow id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml"><mo id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.2" stretchy="false" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml"><msub id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.cmml"><mi id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.2" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.2.cmml">x</mi><mi id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.3" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.1" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml">|</mo><msub id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.2" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.2.cmml">ϕ</mi><mi id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.3" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.3" stretchy="false" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.E3.m1.2.2.1.1.2.3" rspace="1.167em" xref="Sx2.E3.m1.2.2.1.1.3a.cmml">,</mo><mrow id="Sx2.E3.m1.2.2.1.1.2.2" xref="Sx2.E3.m1.2.2.1.1.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" id="Sx2.E3.m1.2.2.1.1.2.2.2" mathvariant="bold-italic" xref="Sx2.E3.m1.2.2.1.1.2.2.2.cmml">ϕ</mi><mo id="Sx2.E3.m1.2.2.1.1.2.2.1" xref="Sx2.E3.m1.2.2.1.1.2.2.1.cmml">=</mo><mrow id="Sx2.E3.m1.2.2.1.1.2.2.3" xref="Sx2.E3.m1.2.2.1.1.2.2.3.cmml"><msub id="Sx2.E3.m1.2.2.1.1.2.2.3.2" xref="Sx2.E3.m1.2.2.1.1.2.2.3.2.cmml"><mi id="Sx2.E3.m1.2.2.1.1.2.2.3.2.2" xref="Sx2.E3.m1.2.2.1.1.2.2.3.2.2.cmml">f</mi><mi id="Sx2.E3.m1.2.2.1.1.2.2.3.2.3" xref="Sx2.E3.m1.2.2.1.1.2.2.3.2.3.cmml">𝜽</mi></msub><mo id="Sx2.E3.m1.2.2.1.1.2.2.3.1" xref="Sx2.E3.m1.2.2.1.1.2.2.3.1.cmml">⁢</mo><mrow id="Sx2.E3.m1.2.2.1.1.2.2.3.3.2" xref="Sx2.E3.m1.2.2.1.1.2.2.3.cmml"><mo id="Sx2.E3.m1.2.2.1.1.2.2.3.3.2.1" stretchy="false" xref="Sx2.E3.m1.2.2.1.1.2.2.3.cmml">(</mo><mi id="Sx2.E3.m1.1.1" xref="Sx2.E3.m1.1.1.cmml">𝒛</mi><mo id="Sx2.E3.m1.2.2.1.1.2.2.3.3.2.2" stretchy="false" xref="Sx2.E3.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.E3.m1.2.2.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E3.m1.2b"><apply id="Sx2.E3.m1.2.2.1.1.3.cmml" xref="Sx2.E3.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.2.2.1.1.3a.cmml" xref="Sx2.E3.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="Sx2.E3.m1.2.2.1.1.1.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1"><and id="Sx2.E3.m1.2.2.1.1.1.1a.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1"></and><apply id="Sx2.E3.m1.2.2.1.1.1.1b.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="Sx2.E3.m1.2.2.1.1.1.1.5.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.5">similar-to</csymbol><ci id="Sx2.E3.m1.2.2.1.1.1.1.4.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.4">𝒙</ci><apply id="Sx2.E3.m1.2.2.1.1.1.1.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.1"><times id="Sx2.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.1.2"></times><ci id="Sx2.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.1.3">𝑝</ci><apply id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.1.1.1.1.3">bold-italic-ϕ</ci></apply></apply></apply><apply id="Sx2.E3.m1.2.2.1.1.1.1c.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1"><ci id="Sx2.E3.m1.2.2.1.1.1.1.6.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.6">≜</ci><share href="https://arxiv.org/html/2410.02126v1#Sx2.E3.m1.2.2.1.1.1.1.1.cmml" id="Sx2.E3.m1.2.2.1.1.1.1d.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1"></share><apply id="Sx2.E3.m1.2.2.1.1.1.1.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2"><apply id="Sx2.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.2.2.1.1.1.1.2.2.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2">superscript</csymbol><apply id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2">subscript</csymbol><csymbol cd="latexml" id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.2">product</csymbol><apply id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3"><eq id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.1"></eq><ci id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.2">𝑖</ci><cn id="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.2.3.3">1</cn></apply></apply><ci id="Sx2.E3.m1.2.2.1.1.1.1.2.2.3.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.2.3">𝐿</ci></apply><apply id="Sx2.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1"><times id="Sx2.E3.m1.2.2.1.1.1.1.2.1.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.2"></times><ci id="Sx2.E3.m1.2.2.1.1.1.1.2.1.3.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.3">𝑝</ci><apply id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.1">conditional</csymbol><apply id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.2">𝑥</ci><ci id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.2">italic-ϕ</ci><ci id="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="Sx2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="Sx2.E3.m1.2.2.1.1.2.2.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2"><eq id="Sx2.E3.m1.2.2.1.1.2.2.1.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2.1"></eq><ci id="Sx2.E3.m1.2.2.1.1.2.2.2.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2.2">bold-italic-ϕ</ci><apply id="Sx2.E3.m1.2.2.1.1.2.2.3.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2.3"><times id="Sx2.E3.m1.2.2.1.1.2.2.3.1.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2.3.1"></times><apply id="Sx2.E3.m1.2.2.1.1.2.2.3.2.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2.3.2"><csymbol cd="ambiguous" id="Sx2.E3.m1.2.2.1.1.2.2.3.2.1.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2.3.2">subscript</csymbol><ci id="Sx2.E3.m1.2.2.1.1.2.2.3.2.2.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2.3.2.2">𝑓</ci><ci id="Sx2.E3.m1.2.2.1.1.2.2.3.2.3.cmml" xref="Sx2.E3.m1.2.2.1.1.2.2.3.2.3">𝜽</ci></apply><ci id="Sx2.E3.m1.1.1.cmml" xref="Sx2.E3.m1.1.1">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E3.m1.2c">\boldsymbol{x}\sim p(\boldsymbol{x}|\boldsymbol{\phi})\triangleq\prod_{i=1}^{L%
}{p(x_{i}|\phi_{i})},\quad\boldsymbol{\phi}=f_{\boldsymbol{\theta}}(%
\boldsymbol{z}).</annotation><annotation encoding="application/x-llamapun" id="Sx2.E3.m1.2d">bold_italic_x ∼ italic_p ( bold_italic_x | bold_italic_ϕ ) ≜ ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_ϕ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , bold_italic_ϕ = italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx2.p1.17">Here, <math alttext="f_{\boldsymbol{\theta}}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.7.m1.1"><semantics id="Sx2.SSx2.p1.7.m1.1a"><mrow id="Sx2.SSx2.p1.7.m1.1.2" xref="Sx2.SSx2.p1.7.m1.1.2.cmml"><msub id="Sx2.SSx2.p1.7.m1.1.2.2" xref="Sx2.SSx2.p1.7.m1.1.2.2.cmml"><mi id="Sx2.SSx2.p1.7.m1.1.2.2.2" xref="Sx2.SSx2.p1.7.m1.1.2.2.2.cmml">f</mi><mi id="Sx2.SSx2.p1.7.m1.1.2.2.3" xref="Sx2.SSx2.p1.7.m1.1.2.2.3.cmml">𝜽</mi></msub><mo id="Sx2.SSx2.p1.7.m1.1.2.1" xref="Sx2.SSx2.p1.7.m1.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx2.p1.7.m1.1.2.3.2" xref="Sx2.SSx2.p1.7.m1.1.2.cmml"><mo id="Sx2.SSx2.p1.7.m1.1.2.3.2.1" stretchy="false" xref="Sx2.SSx2.p1.7.m1.1.2.cmml">(</mo><mi id="Sx2.SSx2.p1.7.m1.1.1" xref="Sx2.SSx2.p1.7.m1.1.1.cmml">𝒛</mi><mo id="Sx2.SSx2.p1.7.m1.1.2.3.2.2" stretchy="false" xref="Sx2.SSx2.p1.7.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.7.m1.1b"><apply id="Sx2.SSx2.p1.7.m1.1.2.cmml" xref="Sx2.SSx2.p1.7.m1.1.2"><times id="Sx2.SSx2.p1.7.m1.1.2.1.cmml" xref="Sx2.SSx2.p1.7.m1.1.2.1"></times><apply id="Sx2.SSx2.p1.7.m1.1.2.2.cmml" xref="Sx2.SSx2.p1.7.m1.1.2.2"><csymbol cd="ambiguous" id="Sx2.SSx2.p1.7.m1.1.2.2.1.cmml" xref="Sx2.SSx2.p1.7.m1.1.2.2">subscript</csymbol><ci id="Sx2.SSx2.p1.7.m1.1.2.2.2.cmml" xref="Sx2.SSx2.p1.7.m1.1.2.2.2">𝑓</ci><ci id="Sx2.SSx2.p1.7.m1.1.2.2.3.cmml" xref="Sx2.SSx2.p1.7.m1.1.2.2.3">𝜽</ci></apply><ci id="Sx2.SSx2.p1.7.m1.1.1.cmml" xref="Sx2.SSx2.p1.7.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.7.m1.1c">f_{\boldsymbol{\theta}}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.7.m1.1d">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> is a neural network with parameters <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.8.m2.1"><semantics id="Sx2.SSx2.p1.8.m2.1a"><mi id="Sx2.SSx2.p1.8.m2.1.1" xref="Sx2.SSx2.p1.8.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.8.m2.1b"><ci id="Sx2.SSx2.p1.8.m2.1.1.cmml" xref="Sx2.SSx2.p1.8.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.8.m2.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.8.m2.1d">bold_italic_θ</annotation></semantics></math> which takes contextual features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.9.m3.1"><semantics id="Sx2.SSx2.p1.9.m3.1a"><mi id="Sx2.SSx2.p1.9.m3.1.1" xref="Sx2.SSx2.p1.9.m3.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.9.m3.1b"><ci id="Sx2.SSx2.p1.9.m3.1.1.cmml" xref="Sx2.SSx2.p1.9.m3.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.9.m3.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.9.m3.1d">bold_italic_z</annotation></semantics></math> and maps them to parameters <math alttext="\boldsymbol{\phi}" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.10.m4.1"><semantics id="Sx2.SSx2.p1.10.m4.1a"><mi class="ltx_mathvariant_bold-italic" id="Sx2.SSx2.p1.10.m4.1.1" mathvariant="bold-italic" xref="Sx2.SSx2.p1.10.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.10.m4.1b"><ci id="Sx2.SSx2.p1.10.m4.1.1.cmml" xref="Sx2.SSx2.p1.10.m4.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.10.m4.1c">\boldsymbol{\phi}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.10.m4.1d">bold_italic_ϕ</annotation></semantics></math> of <math alttext="p(\boldsymbol{x}|\boldsymbol{\phi})" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.11.m5.1"><semantics id="Sx2.SSx2.p1.11.m5.1a"><mrow id="Sx2.SSx2.p1.11.m5.1.1" xref="Sx2.SSx2.p1.11.m5.1.1.cmml"><mi id="Sx2.SSx2.p1.11.m5.1.1.3" xref="Sx2.SSx2.p1.11.m5.1.1.3.cmml">p</mi><mo id="Sx2.SSx2.p1.11.m5.1.1.2" xref="Sx2.SSx2.p1.11.m5.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx2.p1.11.m5.1.1.1.1" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.cmml"><mo id="Sx2.SSx2.p1.11.m5.1.1.1.1.2" stretchy="false" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx2.p1.11.m5.1.1.1.1.1" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.cmml"><mi id="Sx2.SSx2.p1.11.m5.1.1.1.1.1.2" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="Sx2.SSx2.p1.11.m5.1.1.1.1.1.1" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.1.cmml">|</mo><mi class="ltx_mathvariant_bold-italic" id="Sx2.SSx2.p1.11.m5.1.1.1.1.1.3" mathvariant="bold-italic" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.3.cmml">ϕ</mi></mrow><mo id="Sx2.SSx2.p1.11.m5.1.1.1.1.3" stretchy="false" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.11.m5.1b"><apply id="Sx2.SSx2.p1.11.m5.1.1.cmml" xref="Sx2.SSx2.p1.11.m5.1.1"><times id="Sx2.SSx2.p1.11.m5.1.1.2.cmml" xref="Sx2.SSx2.p1.11.m5.1.1.2"></times><ci id="Sx2.SSx2.p1.11.m5.1.1.3.cmml" xref="Sx2.SSx2.p1.11.m5.1.1.3">𝑝</ci><apply id="Sx2.SSx2.p1.11.m5.1.1.1.1.1.cmml" xref="Sx2.SSx2.p1.11.m5.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx2.p1.11.m5.1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.1">conditional</csymbol><ci id="Sx2.SSx2.p1.11.m5.1.1.1.1.1.2.cmml" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.2">𝒙</ci><ci id="Sx2.SSx2.p1.11.m5.1.1.1.1.1.3.cmml" xref="Sx2.SSx2.p1.11.m5.1.1.1.1.1.3">bold-italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.11.m5.1c">p(\boldsymbol{x}|\boldsymbol{\phi})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.11.m5.1d">italic_p ( bold_italic_x | bold_italic_ϕ )</annotation></semantics></math>. Meanwhile, <math alttext="p(\boldsymbol{x}|\boldsymbol{\phi})" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.12.m6.1"><semantics id="Sx2.SSx2.p1.12.m6.1a"><mrow id="Sx2.SSx2.p1.12.m6.1.1" xref="Sx2.SSx2.p1.12.m6.1.1.cmml"><mi id="Sx2.SSx2.p1.12.m6.1.1.3" xref="Sx2.SSx2.p1.12.m6.1.1.3.cmml">p</mi><mo id="Sx2.SSx2.p1.12.m6.1.1.2" xref="Sx2.SSx2.p1.12.m6.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx2.p1.12.m6.1.1.1.1" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.cmml"><mo id="Sx2.SSx2.p1.12.m6.1.1.1.1.2" stretchy="false" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx2.p1.12.m6.1.1.1.1.1" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.cmml"><mi id="Sx2.SSx2.p1.12.m6.1.1.1.1.1.2" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.2.cmml">𝒙</mi><mo fence="false" id="Sx2.SSx2.p1.12.m6.1.1.1.1.1.1" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.1.cmml">|</mo><mi class="ltx_mathvariant_bold-italic" id="Sx2.SSx2.p1.12.m6.1.1.1.1.1.3" mathvariant="bold-italic" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.3.cmml">ϕ</mi></mrow><mo id="Sx2.SSx2.p1.12.m6.1.1.1.1.3" stretchy="false" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.12.m6.1b"><apply id="Sx2.SSx2.p1.12.m6.1.1.cmml" xref="Sx2.SSx2.p1.12.m6.1.1"><times id="Sx2.SSx2.p1.12.m6.1.1.2.cmml" xref="Sx2.SSx2.p1.12.m6.1.1.2"></times><ci id="Sx2.SSx2.p1.12.m6.1.1.3.cmml" xref="Sx2.SSx2.p1.12.m6.1.1.3">𝑝</ci><apply id="Sx2.SSx2.p1.12.m6.1.1.1.1.1.cmml" xref="Sx2.SSx2.p1.12.m6.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx2.p1.12.m6.1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.1">conditional</csymbol><ci id="Sx2.SSx2.p1.12.m6.1.1.1.1.1.2.cmml" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.2">𝒙</ci><ci id="Sx2.SSx2.p1.12.m6.1.1.1.1.1.3.cmml" xref="Sx2.SSx2.p1.12.m6.1.1.1.1.1.3">bold-italic-ϕ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.12.m6.1c">p(\boldsymbol{x}|\boldsymbol{\phi})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.12.m6.1d">italic_p ( bold_italic_x | bold_italic_ϕ )</annotation></semantics></math> is a product of explicit distributions with closed-form likelihoods for each of the <math alttext="p" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.13.m7.1"><semantics id="Sx2.SSx2.p1.13.m7.1a"><mi id="Sx2.SSx2.p1.13.m7.1.1" xref="Sx2.SSx2.p1.13.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.13.m7.1b"><ci id="Sx2.SSx2.p1.13.m7.1.1.cmml" xref="Sx2.SSx2.p1.13.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.13.m7.1c">p</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.13.m7.1d">italic_p</annotation></semantics></math> features. In other words, <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.14.m8.1"><semantics id="Sx2.SSx2.p1.14.m8.1a"><mi id="Sx2.SSx2.p1.14.m8.1.1" xref="Sx2.SSx2.p1.14.m8.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.14.m8.1b"><ci id="Sx2.SSx2.p1.14.m8.1.1.cmml" xref="Sx2.SSx2.p1.14.m8.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.14.m8.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.14.m8.1d">bold_italic_x</annotation></semantics></math> is distributed according to a distribution with parameters <math alttext="\boldsymbol{\phi}" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.15.m9.1"><semantics id="Sx2.SSx2.p1.15.m9.1a"><mi class="ltx_mathvariant_bold-italic" id="Sx2.SSx2.p1.15.m9.1.1" mathvariant="bold-italic" xref="Sx2.SSx2.p1.15.m9.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.15.m9.1b"><ci id="Sx2.SSx2.p1.15.m9.1.1.cmml" xref="Sx2.SSx2.p1.15.m9.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.15.m9.1c">\boldsymbol{\phi}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.15.m9.1d">bold_italic_ϕ</annotation></semantics></math> which are generated through a transformation <math alttext="f_{\boldsymbol{\theta}}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.16.m10.1"><semantics id="Sx2.SSx2.p1.16.m10.1a"><mrow id="Sx2.SSx2.p1.16.m10.1.2" xref="Sx2.SSx2.p1.16.m10.1.2.cmml"><msub id="Sx2.SSx2.p1.16.m10.1.2.2" xref="Sx2.SSx2.p1.16.m10.1.2.2.cmml"><mi id="Sx2.SSx2.p1.16.m10.1.2.2.2" xref="Sx2.SSx2.p1.16.m10.1.2.2.2.cmml">f</mi><mi id="Sx2.SSx2.p1.16.m10.1.2.2.3" xref="Sx2.SSx2.p1.16.m10.1.2.2.3.cmml">𝜽</mi></msub><mo id="Sx2.SSx2.p1.16.m10.1.2.1" xref="Sx2.SSx2.p1.16.m10.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx2.p1.16.m10.1.2.3.2" xref="Sx2.SSx2.p1.16.m10.1.2.cmml"><mo id="Sx2.SSx2.p1.16.m10.1.2.3.2.1" stretchy="false" xref="Sx2.SSx2.p1.16.m10.1.2.cmml">(</mo><mi id="Sx2.SSx2.p1.16.m10.1.1" xref="Sx2.SSx2.p1.16.m10.1.1.cmml">𝒛</mi><mo id="Sx2.SSx2.p1.16.m10.1.2.3.2.2" stretchy="false" xref="Sx2.SSx2.p1.16.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.16.m10.1b"><apply id="Sx2.SSx2.p1.16.m10.1.2.cmml" xref="Sx2.SSx2.p1.16.m10.1.2"><times id="Sx2.SSx2.p1.16.m10.1.2.1.cmml" xref="Sx2.SSx2.p1.16.m10.1.2.1"></times><apply id="Sx2.SSx2.p1.16.m10.1.2.2.cmml" xref="Sx2.SSx2.p1.16.m10.1.2.2"><csymbol cd="ambiguous" id="Sx2.SSx2.p1.16.m10.1.2.2.1.cmml" xref="Sx2.SSx2.p1.16.m10.1.2.2">subscript</csymbol><ci id="Sx2.SSx2.p1.16.m10.1.2.2.2.cmml" xref="Sx2.SSx2.p1.16.m10.1.2.2.2">𝑓</ci><ci id="Sx2.SSx2.p1.16.m10.1.2.2.3.cmml" xref="Sx2.SSx2.p1.16.m10.1.2.2.3">𝜽</ci></apply><ci id="Sx2.SSx2.p1.16.m10.1.1.cmml" xref="Sx2.SSx2.p1.16.m10.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.16.m10.1c">f_{\boldsymbol{\theta}}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.16.m10.1d">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> of the contextual variables <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx2.p1.17.m11.1"><semantics id="Sx2.SSx2.p1.17.m11.1a"><mi id="Sx2.SSx2.p1.17.m11.1.1" xref="Sx2.SSx2.p1.17.m11.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p1.17.m11.1b"><ci id="Sx2.SSx2.p1.17.m11.1.1.cmml" xref="Sx2.SSx2.p1.17.m11.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p1.17.m11.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p1.17.m11.1d">bold_italic_z</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="Sx2.SSx2.p2">
<p class="ltx_p" id="Sx2.SSx2.p2.3">We define each <math alttext="p(x_{i}|\phi_{i})" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.1.m1.1"><semantics id="Sx2.SSx2.p2.1.m1.1a"><mrow id="Sx2.SSx2.p2.1.m1.1.1" xref="Sx2.SSx2.p2.1.m1.1.1.cmml"><mi id="Sx2.SSx2.p2.1.m1.1.1.3" xref="Sx2.SSx2.p2.1.m1.1.1.3.cmml">p</mi><mo id="Sx2.SSx2.p2.1.m1.1.1.2" xref="Sx2.SSx2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx2.p2.1.m1.1.1.1.1" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.cmml"><mo id="Sx2.SSx2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx2.p2.1.m1.1.1.1.1.1" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.cmml"><msub id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.2" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.3" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.1" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><msub id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.2" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.3" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="Sx2.SSx2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.1.m1.1b"><apply id="Sx2.SSx2.p2.1.m1.1.1.cmml" xref="Sx2.SSx2.p2.1.m1.1.1"><times id="Sx2.SSx2.p2.1.m1.1.1.2.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.2"></times><ci id="Sx2.SSx2.p2.1.m1.1.1.3.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.3">𝑝</ci><apply id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.2">italic-ϕ</ci><ci id="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx2.p2.1.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.1.m1.1c">p(x_{i}|\phi_{i})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.1.m1.1d">italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | italic_ϕ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> as a Gamma-Poisson mixture distribution, a common distribution to handle count data that enables efficient posterior updates <cite class="ltx_cite ltx_citemacro_citep">(Casella and Berger <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib10" title="">2024</a>)</cite>. This distribution is defined by a mixture of Poisson distributions with parameter <math alttext="\lambda" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.2.m2.1"><semantics id="Sx2.SSx2.p2.2.m2.1a"><mi id="Sx2.SSx2.p2.2.m2.1.1" xref="Sx2.SSx2.p2.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.2.m2.1b"><ci id="Sx2.SSx2.p2.2.m2.1.1.cmml" xref="Sx2.SSx2.p2.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.2.m2.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.2.m2.1d">italic_λ</annotation></semantics></math> drawn from a Gamma distribution with parameters <math alttext="\phi\triangleq\{\alpha,\beta\}" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.3.m3.2"><semantics id="Sx2.SSx2.p2.3.m3.2a"><mrow id="Sx2.SSx2.p2.3.m3.2.3" xref="Sx2.SSx2.p2.3.m3.2.3.cmml"><mi id="Sx2.SSx2.p2.3.m3.2.3.2" xref="Sx2.SSx2.p2.3.m3.2.3.2.cmml">ϕ</mi><mo id="Sx2.SSx2.p2.3.m3.2.3.1" xref="Sx2.SSx2.p2.3.m3.2.3.1.cmml">≜</mo><mrow id="Sx2.SSx2.p2.3.m3.2.3.3.2" xref="Sx2.SSx2.p2.3.m3.2.3.3.1.cmml"><mo id="Sx2.SSx2.p2.3.m3.2.3.3.2.1" stretchy="false" xref="Sx2.SSx2.p2.3.m3.2.3.3.1.cmml">{</mo><mi id="Sx2.SSx2.p2.3.m3.1.1" xref="Sx2.SSx2.p2.3.m3.1.1.cmml">α</mi><mo id="Sx2.SSx2.p2.3.m3.2.3.3.2.2" xref="Sx2.SSx2.p2.3.m3.2.3.3.1.cmml">,</mo><mi id="Sx2.SSx2.p2.3.m3.2.2" xref="Sx2.SSx2.p2.3.m3.2.2.cmml">β</mi><mo id="Sx2.SSx2.p2.3.m3.2.3.3.2.3" stretchy="false" xref="Sx2.SSx2.p2.3.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.3.m3.2b"><apply id="Sx2.SSx2.p2.3.m3.2.3.cmml" xref="Sx2.SSx2.p2.3.m3.2.3"><ci id="Sx2.SSx2.p2.3.m3.2.3.1.cmml" xref="Sx2.SSx2.p2.3.m3.2.3.1">≜</ci><ci id="Sx2.SSx2.p2.3.m3.2.3.2.cmml" xref="Sx2.SSx2.p2.3.m3.2.3.2">italic-ϕ</ci><set id="Sx2.SSx2.p2.3.m3.2.3.3.1.cmml" xref="Sx2.SSx2.p2.3.m3.2.3.3.2"><ci id="Sx2.SSx2.p2.3.m3.1.1.cmml" xref="Sx2.SSx2.p2.3.m3.1.1">𝛼</ci><ci id="Sx2.SSx2.p2.3.m3.2.2.cmml" xref="Sx2.SSx2.p2.3.m3.2.2">𝛽</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.3.m3.2c">\phi\triangleq\{\alpha,\beta\}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.3.m3.2d">italic_ϕ ≜ { italic_α , italic_β }</annotation></semantics></math>. Omitting subscripts, this can be written as</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}p(x|\phi)&amp;\triangleq p_{GP}(x|\alpha,\beta)\\
&amp;=\int_{0}^{\infty}{\text{Poisson}(x|\lambda)\text{Gamma}(\lambda|\alpha,\beta%
)d\lambda}\\
&amp;=\int_{0}^{\infty}{\frac{e^{-\lambda}\lambda^{x}}{x!}\frac{\beta^{\alpha}}{%
\Gamma(\alpha)}\lambda^{\alpha-1}e^{-\beta\lambda}d\lambda}\\
&amp;=\frac{\Gamma(x+\alpha)}{x!\Gamma(\alpha)}\left(\frac{\beta}{1+\beta}\right)^%
{\alpha}\left(\frac{1}{1+\beta}\right)^{x},\end{split}" class="ltx_Math" display="block" id="Sx2.E4.m1.65"><semantics id="Sx2.E4.m1.65a"><mtable columnspacing="0pt" displaystyle="true" id="Sx2.E4.m1.65.65.6" rowspacing="0pt"><mtr id="Sx2.E4.m1.65.65.6a"><mtd class="ltx_align_right" columnalign="right" id="Sx2.E4.m1.65.65.6b"><mrow id="Sx2.E4.m1.61.61.2.60.17.7"><mi id="Sx2.E4.m1.1.1.1.1.1.1" xref="Sx2.E4.m1.1.1.1.1.1.1.cmml">p</mi><mo id="Sx2.E4.m1.61.61.2.60.17.7.8" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><mrow id="Sx2.E4.m1.61.61.2.60.17.7.7.1"><mo id="Sx2.E4.m1.2.2.2.2.2.2" stretchy="false" xref="Sx2.E4.m1.60.60.1.1.1.cmml">(</mo><mrow id="Sx2.E4.m1.61.61.2.60.17.7.7.1.1"><mi id="Sx2.E4.m1.3.3.3.3.3.3" xref="Sx2.E4.m1.3.3.3.3.3.3.cmml">x</mi><mo fence="false" id="Sx2.E4.m1.4.4.4.4.4.4" xref="Sx2.E4.m1.4.4.4.4.4.4.cmml">|</mo><mi id="Sx2.E4.m1.5.5.5.5.5.5" xref="Sx2.E4.m1.5.5.5.5.5.5.cmml">ϕ</mi></mrow><mo id="Sx2.E4.m1.6.6.6.6.6.6" stretchy="false" xref="Sx2.E4.m1.60.60.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E4.m1.65.65.6c"><mrow id="Sx2.E4.m1.62.62.3.61.18.11"><mi id="Sx2.E4.m1.62.62.3.61.18.11.12" xref="Sx2.E4.m1.60.60.1.1.1.cmml"></mi><mo id="Sx2.E4.m1.7.7.7.7.1.1" xref="Sx2.E4.m1.7.7.7.7.1.1.cmml">≜</mo><mrow id="Sx2.E4.m1.62.62.3.61.18.11.11"><msub id="Sx2.E4.m1.62.62.3.61.18.11.11.3"><mi id="Sx2.E4.m1.8.8.8.8.2.2" xref="Sx2.E4.m1.8.8.8.8.2.2.cmml">p</mi><mrow id="Sx2.E4.m1.9.9.9.9.3.3.1" xref="Sx2.E4.m1.9.9.9.9.3.3.1.cmml"><mi id="Sx2.E4.m1.9.9.9.9.3.3.1.2" xref="Sx2.E4.m1.9.9.9.9.3.3.1.2.cmml">G</mi><mo id="Sx2.E4.m1.9.9.9.9.3.3.1.1" xref="Sx2.E4.m1.9.9.9.9.3.3.1.1.cmml">⁢</mo><mi id="Sx2.E4.m1.9.9.9.9.3.3.1.3" xref="Sx2.E4.m1.9.9.9.9.3.3.1.3.cmml">P</mi></mrow></msub><mo id="Sx2.E4.m1.62.62.3.61.18.11.11.2" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><mrow id="Sx2.E4.m1.62.62.3.61.18.11.11.1.1"><mo id="Sx2.E4.m1.10.10.10.10.4.4" stretchy="false" xref="Sx2.E4.m1.60.60.1.1.1.cmml">(</mo><mrow id="Sx2.E4.m1.62.62.3.61.18.11.11.1.1.1"><mi id="Sx2.E4.m1.11.11.11.11.5.5" xref="Sx2.E4.m1.11.11.11.11.5.5.cmml">x</mi><mo fence="false" id="Sx2.E4.m1.12.12.12.12.6.6" xref="Sx2.E4.m1.12.12.12.12.6.6.cmml">|</mo><mrow id="Sx2.E4.m1.62.62.3.61.18.11.11.1.1.1.1"><mi id="Sx2.E4.m1.13.13.13.13.7.7" xref="Sx2.E4.m1.13.13.13.13.7.7.cmml">α</mi><mo id="Sx2.E4.m1.14.14.14.14.8.8" xref="Sx2.E4.m1.60.60.1.1.1.cmml">,</mo><mi id="Sx2.E4.m1.15.15.15.15.9.9" xref="Sx2.E4.m1.15.15.15.15.9.9.cmml">β</mi></mrow></mrow><mo id="Sx2.E4.m1.16.16.16.16.10.10" stretchy="false" xref="Sx2.E4.m1.60.60.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx2.E4.m1.65.65.6d"><mtd id="Sx2.E4.m1.65.65.6e" xref="Sx2.E4.m1.60.60.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E4.m1.65.65.6f"><mrow id="Sx2.E4.m1.64.64.5.63.22.22"><mi id="Sx2.E4.m1.64.64.5.63.22.22.23" xref="Sx2.E4.m1.60.60.1.1.1.cmml"></mi><mo id="Sx2.E4.m1.17.17.17.1.1.1" rspace="0.111em" xref="Sx2.E4.m1.17.17.17.1.1.1.cmml">=</mo><mrow id="Sx2.E4.m1.64.64.5.63.22.22.22"><msubsup id="Sx2.E4.m1.64.64.5.63.22.22.22.3"><mo id="Sx2.E4.m1.18.18.18.2.2.2" xref="Sx2.E4.m1.18.18.18.2.2.2.cmml">∫</mo><mn id="Sx2.E4.m1.19.19.19.3.3.3.1" xref="Sx2.E4.m1.19.19.19.3.3.3.1.cmml">0</mn><mi id="Sx2.E4.m1.20.20.20.4.4.4.1" mathvariant="normal" xref="Sx2.E4.m1.20.20.20.4.4.4.1.cmml">∞</mi></msubsup><mrow id="Sx2.E4.m1.64.64.5.63.22.22.22.2"><mtext id="Sx2.E4.m1.21.21.21.5.5.5" xref="Sx2.E4.m1.21.21.21.5.5.5a.cmml">Poisson</mtext><mo id="Sx2.E4.m1.64.64.5.63.22.22.22.2.3" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><mrow id="Sx2.E4.m1.63.63.4.62.21.21.21.1.1.1"><mo id="Sx2.E4.m1.22.22.22.6.6.6" stretchy="false" xref="Sx2.E4.m1.60.60.1.1.1.cmml">(</mo><mrow id="Sx2.E4.m1.63.63.4.62.21.21.21.1.1.1.1"><mi id="Sx2.E4.m1.23.23.23.7.7.7" xref="Sx2.E4.m1.23.23.23.7.7.7.cmml">x</mi><mo fence="false" id="Sx2.E4.m1.24.24.24.8.8.8" xref="Sx2.E4.m1.24.24.24.8.8.8.cmml">|</mo><mi id="Sx2.E4.m1.25.25.25.9.9.9" xref="Sx2.E4.m1.25.25.25.9.9.9.cmml">λ</mi></mrow><mo id="Sx2.E4.m1.26.26.26.10.10.10" stretchy="false" xref="Sx2.E4.m1.60.60.1.1.1.cmml">)</mo></mrow><mo id="Sx2.E4.m1.64.64.5.63.22.22.22.2.3a" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><mtext id="Sx2.E4.m1.27.27.27.11.11.11" xref="Sx2.E4.m1.27.27.27.11.11.11a.cmml">Gamma</mtext><mo id="Sx2.E4.m1.64.64.5.63.22.22.22.2.3b" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><mrow id="Sx2.E4.m1.64.64.5.63.22.22.22.2.2.1"><mo id="Sx2.E4.m1.28.28.28.12.12.12" stretchy="false" xref="Sx2.E4.m1.60.60.1.1.1.cmml">(</mo><mrow id="Sx2.E4.m1.64.64.5.63.22.22.22.2.2.1.1"><mi id="Sx2.E4.m1.29.29.29.13.13.13" xref="Sx2.E4.m1.29.29.29.13.13.13.cmml">λ</mi><mo fence="false" id="Sx2.E4.m1.30.30.30.14.14.14" xref="Sx2.E4.m1.30.30.30.14.14.14.cmml">|</mo><mrow id="Sx2.E4.m1.64.64.5.63.22.22.22.2.2.1.1.1"><mi id="Sx2.E4.m1.31.31.31.15.15.15" xref="Sx2.E4.m1.31.31.31.15.15.15.cmml">α</mi><mo id="Sx2.E4.m1.32.32.32.16.16.16" xref="Sx2.E4.m1.60.60.1.1.1.cmml">,</mo><mi id="Sx2.E4.m1.33.33.33.17.17.17" xref="Sx2.E4.m1.33.33.33.17.17.17.cmml">β</mi></mrow></mrow><mo id="Sx2.E4.m1.34.34.34.18.18.18" stretchy="false" xref="Sx2.E4.m1.60.60.1.1.1.cmml">)</mo></mrow><mo id="Sx2.E4.m1.64.64.5.63.22.22.22.2.3c" lspace="0em" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><mrow id="Sx2.E4.m1.64.64.5.63.22.22.22.2.4"><mo id="Sx2.E4.m1.35.35.35.19.19.19" rspace="0em" xref="Sx2.E4.m1.35.35.35.19.19.19.cmml">𝑑</mo><mi id="Sx2.E4.m1.36.36.36.20.20.20" xref="Sx2.E4.m1.36.36.36.20.20.20.cmml">λ</mi></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="Sx2.E4.m1.65.65.6g"><mtd id="Sx2.E4.m1.65.65.6h" xref="Sx2.E4.m1.60.60.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E4.m1.65.65.6i"><mrow id="Sx2.E4.m1.48.48.48.12.12"><mi id="Sx2.E4.m1.48.48.48.12.12.13" xref="Sx2.E4.m1.60.60.1.1.1.cmml"></mi><mo id="Sx2.E4.m1.37.37.37.1.1.1" rspace="0.111em" xref="Sx2.E4.m1.37.37.37.1.1.1.cmml">=</mo><mrow id="Sx2.E4.m1.48.48.48.12.12.14"><msubsup id="Sx2.E4.m1.48.48.48.12.12.14.1"><mo id="Sx2.E4.m1.38.38.38.2.2.2" xref="Sx2.E4.m1.38.38.38.2.2.2.cmml">∫</mo><mn id="Sx2.E4.m1.39.39.39.3.3.3.1" xref="Sx2.E4.m1.39.39.39.3.3.3.1.cmml">0</mn><mi id="Sx2.E4.m1.40.40.40.4.4.4.1" mathvariant="normal" xref="Sx2.E4.m1.40.40.40.4.4.4.1.cmml">∞</mi></msubsup><mrow id="Sx2.E4.m1.48.48.48.12.12.14.2"><mfrac id="Sx2.E4.m1.41.41.41.5.5.5" xref="Sx2.E4.m1.41.41.41.5.5.5.cmml"><mrow id="Sx2.E4.m1.41.41.41.5.5.5.2" xref="Sx2.E4.m1.41.41.41.5.5.5.2.cmml"><msup id="Sx2.E4.m1.41.41.41.5.5.5.2.2" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.cmml"><mi id="Sx2.E4.m1.41.41.41.5.5.5.2.2.2" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.2.cmml">e</mi><mrow id="Sx2.E4.m1.41.41.41.5.5.5.2.2.3" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.3.cmml"><mo id="Sx2.E4.m1.41.41.41.5.5.5.2.2.3a" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.3.cmml">−</mo><mi id="Sx2.E4.m1.41.41.41.5.5.5.2.2.3.2" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.3.2.cmml">λ</mi></mrow></msup><mo id="Sx2.E4.m1.41.41.41.5.5.5.2.1" xref="Sx2.E4.m1.41.41.41.5.5.5.2.1.cmml">⁢</mo><msup id="Sx2.E4.m1.41.41.41.5.5.5.2.3" xref="Sx2.E4.m1.41.41.41.5.5.5.2.3.cmml"><mi id="Sx2.E4.m1.41.41.41.5.5.5.2.3.2" xref="Sx2.E4.m1.41.41.41.5.5.5.2.3.2.cmml">λ</mi><mi id="Sx2.E4.m1.41.41.41.5.5.5.2.3.3" xref="Sx2.E4.m1.41.41.41.5.5.5.2.3.3.cmml">x</mi></msup></mrow><mrow id="Sx2.E4.m1.41.41.41.5.5.5.3" xref="Sx2.E4.m1.41.41.41.5.5.5.3.cmml"><mi id="Sx2.E4.m1.41.41.41.5.5.5.3.2" xref="Sx2.E4.m1.41.41.41.5.5.5.3.2.cmml">x</mi><mo id="Sx2.E4.m1.41.41.41.5.5.5.3.1" xref="Sx2.E4.m1.41.41.41.5.5.5.3.1.cmml">!</mo></mrow></mfrac><mo id="Sx2.E4.m1.48.48.48.12.12.14.2.1" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><mfrac id="Sx2.E4.m1.42.42.42.6.6.6" xref="Sx2.E4.m1.42.42.42.6.6.6.cmml"><msup id="Sx2.E4.m1.42.42.42.6.6.6.3" xref="Sx2.E4.m1.42.42.42.6.6.6.3.cmml"><mi id="Sx2.E4.m1.42.42.42.6.6.6.3.2" xref="Sx2.E4.m1.42.42.42.6.6.6.3.2.cmml">β</mi><mi id="Sx2.E4.m1.42.42.42.6.6.6.3.3" xref="Sx2.E4.m1.42.42.42.6.6.6.3.3.cmml">α</mi></msup><mrow id="Sx2.E4.m1.42.42.42.6.6.6.1" xref="Sx2.E4.m1.42.42.42.6.6.6.1.cmml"><mi id="Sx2.E4.m1.42.42.42.6.6.6.1.3" mathvariant="normal" xref="Sx2.E4.m1.42.42.42.6.6.6.1.3.cmml">Γ</mi><mo id="Sx2.E4.m1.42.42.42.6.6.6.1.2" xref="Sx2.E4.m1.42.42.42.6.6.6.1.2.cmml">⁢</mo><mrow id="Sx2.E4.m1.42.42.42.6.6.6.1.4.2" xref="Sx2.E4.m1.42.42.42.6.6.6.1.cmml"><mo id="Sx2.E4.m1.42.42.42.6.6.6.1.4.2.1" stretchy="false" xref="Sx2.E4.m1.42.42.42.6.6.6.1.cmml">(</mo><mi id="Sx2.E4.m1.42.42.42.6.6.6.1.1" xref="Sx2.E4.m1.42.42.42.6.6.6.1.1.cmml">α</mi><mo id="Sx2.E4.m1.42.42.42.6.6.6.1.4.2.2" stretchy="false" xref="Sx2.E4.m1.42.42.42.6.6.6.1.cmml">)</mo></mrow></mrow></mfrac><mo id="Sx2.E4.m1.48.48.48.12.12.14.2.1a" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><msup id="Sx2.E4.m1.48.48.48.12.12.14.2.2"><mi id="Sx2.E4.m1.43.43.43.7.7.7" xref="Sx2.E4.m1.43.43.43.7.7.7.cmml">λ</mi><mrow id="Sx2.E4.m1.44.44.44.8.8.8.1" xref="Sx2.E4.m1.44.44.44.8.8.8.1.cmml"><mi id="Sx2.E4.m1.44.44.44.8.8.8.1.2" xref="Sx2.E4.m1.44.44.44.8.8.8.1.2.cmml">α</mi><mo id="Sx2.E4.m1.44.44.44.8.8.8.1.1" xref="Sx2.E4.m1.44.44.44.8.8.8.1.1.cmml">−</mo><mn id="Sx2.E4.m1.44.44.44.8.8.8.1.3" xref="Sx2.E4.m1.44.44.44.8.8.8.1.3.cmml">1</mn></mrow></msup><mo id="Sx2.E4.m1.48.48.48.12.12.14.2.1b" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><msup id="Sx2.E4.m1.48.48.48.12.12.14.2.3"><mi id="Sx2.E4.m1.45.45.45.9.9.9" xref="Sx2.E4.m1.45.45.45.9.9.9.cmml">e</mi><mrow id="Sx2.E4.m1.46.46.46.10.10.10.1" xref="Sx2.E4.m1.46.46.46.10.10.10.1.cmml"><mo id="Sx2.E4.m1.46.46.46.10.10.10.1a" xref="Sx2.E4.m1.46.46.46.10.10.10.1.cmml">−</mo><mrow id="Sx2.E4.m1.46.46.46.10.10.10.1.2" xref="Sx2.E4.m1.46.46.46.10.10.10.1.2.cmml"><mi id="Sx2.E4.m1.46.46.46.10.10.10.1.2.2" xref="Sx2.E4.m1.46.46.46.10.10.10.1.2.2.cmml">β</mi><mo id="Sx2.E4.m1.46.46.46.10.10.10.1.2.1" xref="Sx2.E4.m1.46.46.46.10.10.10.1.2.1.cmml">⁢</mo><mi id="Sx2.E4.m1.46.46.46.10.10.10.1.2.3" xref="Sx2.E4.m1.46.46.46.10.10.10.1.2.3.cmml">λ</mi></mrow></mrow></msup><mo id="Sx2.E4.m1.48.48.48.12.12.14.2.1c" lspace="0em" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><mrow id="Sx2.E4.m1.48.48.48.12.12.14.2.4"><mo id="Sx2.E4.m1.47.47.47.11.11.11" rspace="0em" xref="Sx2.E4.m1.47.47.47.11.11.11.cmml">𝑑</mo><mi id="Sx2.E4.m1.48.48.48.12.12.12" xref="Sx2.E4.m1.48.48.48.12.12.12.cmml">λ</mi></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="Sx2.E4.m1.65.65.6j"><mtd id="Sx2.E4.m1.65.65.6k" xref="Sx2.E4.m1.60.60.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E4.m1.65.65.6l"><mrow id="Sx2.E4.m1.65.65.6.64.12.12.12"><mrow id="Sx2.E4.m1.65.65.6.64.12.12.12.1"><mi id="Sx2.E4.m1.65.65.6.64.12.12.12.1.1" xref="Sx2.E4.m1.60.60.1.1.1.cmml"></mi><mo id="Sx2.E4.m1.49.49.49.1.1.1" xref="Sx2.E4.m1.49.49.49.1.1.1.cmml">=</mo><mrow id="Sx2.E4.m1.65.65.6.64.12.12.12.1.2"><mfrac id="Sx2.E4.m1.50.50.50.2.2.2" xref="Sx2.E4.m1.50.50.50.2.2.2.cmml"><mrow id="Sx2.E4.m1.50.50.50.2.2.2.1" xref="Sx2.E4.m1.50.50.50.2.2.2.1.cmml"><mi id="Sx2.E4.m1.50.50.50.2.2.2.1.3" mathvariant="normal" xref="Sx2.E4.m1.50.50.50.2.2.2.1.3.cmml">Γ</mi><mo id="Sx2.E4.m1.50.50.50.2.2.2.1.2" xref="Sx2.E4.m1.50.50.50.2.2.2.1.2.cmml">⁢</mo><mrow id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.cmml"><mo id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.2" stretchy="false" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.cmml">(</mo><mrow id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.cmml"><mi id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.2" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.2.cmml">x</mi><mo id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.1" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.1.cmml">+</mo><mi id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.3" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.3.cmml">α</mi></mrow><mo id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.3" stretchy="false" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="Sx2.E4.m1.50.50.50.2.2.2.2" xref="Sx2.E4.m1.50.50.50.2.2.2.2.cmml"><mrow id="Sx2.E4.m1.50.50.50.2.2.2.2.3" xref="Sx2.E4.m1.50.50.50.2.2.2.2.3.cmml"><mi id="Sx2.E4.m1.50.50.50.2.2.2.2.3.2" xref="Sx2.E4.m1.50.50.50.2.2.2.2.3.2.cmml">x</mi><mo id="Sx2.E4.m1.50.50.50.2.2.2.2.3.1" xref="Sx2.E4.m1.50.50.50.2.2.2.2.3.1.cmml">!</mo></mrow><mo id="Sx2.E4.m1.50.50.50.2.2.2.2.2" xref="Sx2.E4.m1.50.50.50.2.2.2.2.2.cmml">⁢</mo><mi id="Sx2.E4.m1.50.50.50.2.2.2.2.4" mathvariant="normal" xref="Sx2.E4.m1.50.50.50.2.2.2.2.4.cmml">Γ</mi><mo id="Sx2.E4.m1.50.50.50.2.2.2.2.2a" xref="Sx2.E4.m1.50.50.50.2.2.2.2.2.cmml">⁢</mo><mrow id="Sx2.E4.m1.50.50.50.2.2.2.2.5.2" xref="Sx2.E4.m1.50.50.50.2.2.2.2.cmml"><mo id="Sx2.E4.m1.50.50.50.2.2.2.2.5.2.1" stretchy="false" xref="Sx2.E4.m1.50.50.50.2.2.2.2.cmml">(</mo><mi id="Sx2.E4.m1.50.50.50.2.2.2.2.1" xref="Sx2.E4.m1.50.50.50.2.2.2.2.1.cmml">α</mi><mo id="Sx2.E4.m1.50.50.50.2.2.2.2.5.2.2" stretchy="false" xref="Sx2.E4.m1.50.50.50.2.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="Sx2.E4.m1.65.65.6.64.12.12.12.1.2.1" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><msup id="Sx2.E4.m1.65.65.6.64.12.12.12.1.2.2"><mrow id="Sx2.E4.m1.65.65.6.64.12.12.12.1.2.2.2"><mo id="Sx2.E4.m1.51.51.51.3.3.3" xref="Sx2.E4.m1.60.60.1.1.1.cmml">(</mo><mfrac id="Sx2.E4.m1.52.52.52.4.4.4" xref="Sx2.E4.m1.52.52.52.4.4.4.cmml"><mi id="Sx2.E4.m1.52.52.52.4.4.4.2" xref="Sx2.E4.m1.52.52.52.4.4.4.2.cmml">β</mi><mrow id="Sx2.E4.m1.52.52.52.4.4.4.3" xref="Sx2.E4.m1.52.52.52.4.4.4.3.cmml"><mn id="Sx2.E4.m1.52.52.52.4.4.4.3.2" xref="Sx2.E4.m1.52.52.52.4.4.4.3.2.cmml">1</mn><mo id="Sx2.E4.m1.52.52.52.4.4.4.3.1" xref="Sx2.E4.m1.52.52.52.4.4.4.3.1.cmml">+</mo><mi id="Sx2.E4.m1.52.52.52.4.4.4.3.3" xref="Sx2.E4.m1.52.52.52.4.4.4.3.3.cmml">β</mi></mrow></mfrac><mo id="Sx2.E4.m1.53.53.53.5.5.5" xref="Sx2.E4.m1.60.60.1.1.1.cmml">)</mo></mrow><mi id="Sx2.E4.m1.54.54.54.6.6.6.1" xref="Sx2.E4.m1.54.54.54.6.6.6.1.cmml">α</mi></msup><mo id="Sx2.E4.m1.65.65.6.64.12.12.12.1.2.1a" xref="Sx2.E4.m1.60.60.1.1.1.cmml">⁢</mo><msup id="Sx2.E4.m1.65.65.6.64.12.12.12.1.2.3"><mrow id="Sx2.E4.m1.65.65.6.64.12.12.12.1.2.3.2"><mo id="Sx2.E4.m1.55.55.55.7.7.7" xref="Sx2.E4.m1.60.60.1.1.1.cmml">(</mo><mfrac id="Sx2.E4.m1.56.56.56.8.8.8" xref="Sx2.E4.m1.56.56.56.8.8.8.cmml"><mn id="Sx2.E4.m1.56.56.56.8.8.8.2" xref="Sx2.E4.m1.56.56.56.8.8.8.2.cmml">1</mn><mrow id="Sx2.E4.m1.56.56.56.8.8.8.3" xref="Sx2.E4.m1.56.56.56.8.8.8.3.cmml"><mn id="Sx2.E4.m1.56.56.56.8.8.8.3.2" xref="Sx2.E4.m1.56.56.56.8.8.8.3.2.cmml">1</mn><mo id="Sx2.E4.m1.56.56.56.8.8.8.3.1" xref="Sx2.E4.m1.56.56.56.8.8.8.3.1.cmml">+</mo><mi id="Sx2.E4.m1.56.56.56.8.8.8.3.3" xref="Sx2.E4.m1.56.56.56.8.8.8.3.3.cmml">β</mi></mrow></mfrac><mo id="Sx2.E4.m1.57.57.57.9.9.9" xref="Sx2.E4.m1.60.60.1.1.1.cmml">)</mo></mrow><mi id="Sx2.E4.m1.58.58.58.10.10.10.1" xref="Sx2.E4.m1.58.58.58.10.10.10.1.cmml">x</mi></msup></mrow></mrow><mo id="Sx2.E4.m1.59.59.59.11.11.11" xref="Sx2.E4.m1.60.60.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx2.E4.m1.65b"><apply id="Sx2.E4.m1.60.60.1.1.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><and id="Sx2.E4.m1.60.60.1.1.1a.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></and><apply id="Sx2.E4.m1.60.60.1.1.1b.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><ci id="Sx2.E4.m1.7.7.7.7.1.1.cmml" xref="Sx2.E4.m1.7.7.7.7.1.1">≜</ci><apply id="Sx2.E4.m1.60.60.1.1.1.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><times id="Sx2.E4.m1.60.60.1.1.1.1.2.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></times><ci id="Sx2.E4.m1.1.1.1.1.1.1.cmml" xref="Sx2.E4.m1.1.1.1.1.1.1">𝑝</ci><apply id="Sx2.E4.m1.60.60.1.1.1.1.1.1.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="latexml" id="Sx2.E4.m1.4.4.4.4.4.4.cmml" xref="Sx2.E4.m1.4.4.4.4.4.4">conditional</csymbol><ci id="Sx2.E4.m1.3.3.3.3.3.3.cmml" xref="Sx2.E4.m1.3.3.3.3.3.3">𝑥</ci><ci id="Sx2.E4.m1.5.5.5.5.5.5.cmml" xref="Sx2.E4.m1.5.5.5.5.5.5">italic-ϕ</ci></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1.2.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><times id="Sx2.E4.m1.60.60.1.1.1.2.2.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></times><apply id="Sx2.E4.m1.60.60.1.1.1.2.3.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.2.3.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">subscript</csymbol><ci id="Sx2.E4.m1.8.8.8.8.2.2.cmml" xref="Sx2.E4.m1.8.8.8.8.2.2">𝑝</ci><apply id="Sx2.E4.m1.9.9.9.9.3.3.1.cmml" xref="Sx2.E4.m1.9.9.9.9.3.3.1"><times id="Sx2.E4.m1.9.9.9.9.3.3.1.1.cmml" xref="Sx2.E4.m1.9.9.9.9.3.3.1.1"></times><ci id="Sx2.E4.m1.9.9.9.9.3.3.1.2.cmml" xref="Sx2.E4.m1.9.9.9.9.3.3.1.2">𝐺</ci><ci id="Sx2.E4.m1.9.9.9.9.3.3.1.3.cmml" xref="Sx2.E4.m1.9.9.9.9.3.3.1.3">𝑃</ci></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1.2.1.1.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="latexml" id="Sx2.E4.m1.12.12.12.12.6.6.cmml" xref="Sx2.E4.m1.12.12.12.12.6.6">conditional</csymbol><ci id="Sx2.E4.m1.11.11.11.11.5.5.cmml" xref="Sx2.E4.m1.11.11.11.11.5.5">𝑥</ci><list id="Sx2.E4.m1.60.60.1.1.1.2.1.1.1.3.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><ci id="Sx2.E4.m1.13.13.13.13.7.7.cmml" xref="Sx2.E4.m1.13.13.13.13.7.7">𝛼</ci><ci id="Sx2.E4.m1.15.15.15.15.9.9.cmml" xref="Sx2.E4.m1.15.15.15.15.9.9">𝛽</ci></list></apply></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1c.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><eq id="Sx2.E4.m1.17.17.17.1.1.1.cmml" xref="Sx2.E4.m1.17.17.17.1.1.1"></eq><share href="https://arxiv.org/html/2410.02126v1#Sx2.E4.m1.60.60.1.1.1.2.cmml" id="Sx2.E4.m1.60.60.1.1.1d.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></share><apply id="Sx2.E4.m1.60.60.1.1.1.4.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><apply id="Sx2.E4.m1.60.60.1.1.1.4.3.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.4.3.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">superscript</csymbol><apply id="Sx2.E4.m1.60.60.1.1.1.4.3.2.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.4.3.2.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">subscript</csymbol><int id="Sx2.E4.m1.18.18.18.2.2.2.cmml" xref="Sx2.E4.m1.18.18.18.2.2.2"></int><cn id="Sx2.E4.m1.19.19.19.3.3.3.1.cmml" type="integer" xref="Sx2.E4.m1.19.19.19.3.3.3.1">0</cn></apply><infinity id="Sx2.E4.m1.20.20.20.4.4.4.1.cmml" xref="Sx2.E4.m1.20.20.20.4.4.4.1"></infinity></apply><apply id="Sx2.E4.m1.60.60.1.1.1.4.2.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><times id="Sx2.E4.m1.60.60.1.1.1.4.2.3.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></times><ci id="Sx2.E4.m1.21.21.21.5.5.5a.cmml" xref="Sx2.E4.m1.21.21.21.5.5.5"><mtext id="Sx2.E4.m1.21.21.21.5.5.5.cmml" xref="Sx2.E4.m1.21.21.21.5.5.5">Poisson</mtext></ci><apply id="Sx2.E4.m1.60.60.1.1.1.3.1.1.1.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="latexml" id="Sx2.E4.m1.24.24.24.8.8.8.cmml" xref="Sx2.E4.m1.24.24.24.8.8.8">conditional</csymbol><ci id="Sx2.E4.m1.23.23.23.7.7.7.cmml" xref="Sx2.E4.m1.23.23.23.7.7.7">𝑥</ci><ci id="Sx2.E4.m1.25.25.25.9.9.9.cmml" xref="Sx2.E4.m1.25.25.25.9.9.9">𝜆</ci></apply><ci id="Sx2.E4.m1.27.27.27.11.11.11a.cmml" xref="Sx2.E4.m1.27.27.27.11.11.11"><mtext id="Sx2.E4.m1.27.27.27.11.11.11.cmml" xref="Sx2.E4.m1.27.27.27.11.11.11">Gamma</mtext></ci><apply id="Sx2.E4.m1.60.60.1.1.1.4.2.2.1.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="latexml" id="Sx2.E4.m1.30.30.30.14.14.14.cmml" xref="Sx2.E4.m1.30.30.30.14.14.14">conditional</csymbol><ci id="Sx2.E4.m1.29.29.29.13.13.13.cmml" xref="Sx2.E4.m1.29.29.29.13.13.13">𝜆</ci><list id="Sx2.E4.m1.60.60.1.1.1.4.2.2.1.1.3.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><ci id="Sx2.E4.m1.31.31.31.15.15.15.cmml" xref="Sx2.E4.m1.31.31.31.15.15.15">𝛼</ci><ci id="Sx2.E4.m1.33.33.33.17.17.17.cmml" xref="Sx2.E4.m1.33.33.33.17.17.17">𝛽</ci></list></apply><apply id="Sx2.E4.m1.60.60.1.1.1.4.2.6.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="latexml" id="Sx2.E4.m1.35.35.35.19.19.19.cmml" xref="Sx2.E4.m1.35.35.35.19.19.19">differential-d</csymbol><ci id="Sx2.E4.m1.36.36.36.20.20.20.cmml" xref="Sx2.E4.m1.36.36.36.20.20.20">𝜆</ci></apply></apply></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1e.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><eq id="Sx2.E4.m1.37.37.37.1.1.1.cmml" xref="Sx2.E4.m1.37.37.37.1.1.1"></eq><share href="https://arxiv.org/html/2410.02126v1#Sx2.E4.m1.60.60.1.1.1.4.cmml" id="Sx2.E4.m1.60.60.1.1.1f.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></share><apply id="Sx2.E4.m1.60.60.1.1.1.9.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><apply id="Sx2.E4.m1.60.60.1.1.1.9.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.9.1.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">superscript</csymbol><apply id="Sx2.E4.m1.60.60.1.1.1.9.1.2.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.9.1.2.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">subscript</csymbol><int id="Sx2.E4.m1.38.38.38.2.2.2.cmml" xref="Sx2.E4.m1.38.38.38.2.2.2"></int><cn id="Sx2.E4.m1.39.39.39.3.3.3.1.cmml" type="integer" xref="Sx2.E4.m1.39.39.39.3.3.3.1">0</cn></apply><infinity id="Sx2.E4.m1.40.40.40.4.4.4.1.cmml" xref="Sx2.E4.m1.40.40.40.4.4.4.1"></infinity></apply><apply id="Sx2.E4.m1.60.60.1.1.1.9.2.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><times id="Sx2.E4.m1.60.60.1.1.1.9.2.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></times><apply id="Sx2.E4.m1.41.41.41.5.5.5.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5"><divide id="Sx2.E4.m1.41.41.41.5.5.5.1.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5"></divide><apply id="Sx2.E4.m1.41.41.41.5.5.5.2.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2"><times id="Sx2.E4.m1.41.41.41.5.5.5.2.1.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.1"></times><apply id="Sx2.E4.m1.41.41.41.5.5.5.2.2.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2"><csymbol cd="ambiguous" id="Sx2.E4.m1.41.41.41.5.5.5.2.2.1.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2">superscript</csymbol><ci id="Sx2.E4.m1.41.41.41.5.5.5.2.2.2.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.2">𝑒</ci><apply id="Sx2.E4.m1.41.41.41.5.5.5.2.2.3.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.3"><minus id="Sx2.E4.m1.41.41.41.5.5.5.2.2.3.1.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.3"></minus><ci id="Sx2.E4.m1.41.41.41.5.5.5.2.2.3.2.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.2.3.2">𝜆</ci></apply></apply><apply id="Sx2.E4.m1.41.41.41.5.5.5.2.3.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.3"><csymbol cd="ambiguous" id="Sx2.E4.m1.41.41.41.5.5.5.2.3.1.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.3">superscript</csymbol><ci id="Sx2.E4.m1.41.41.41.5.5.5.2.3.2.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.3.2">𝜆</ci><ci id="Sx2.E4.m1.41.41.41.5.5.5.2.3.3.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.2.3.3">𝑥</ci></apply></apply><apply id="Sx2.E4.m1.41.41.41.5.5.5.3.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.3"><factorial id="Sx2.E4.m1.41.41.41.5.5.5.3.1.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.3.1"></factorial><ci id="Sx2.E4.m1.41.41.41.5.5.5.3.2.cmml" xref="Sx2.E4.m1.41.41.41.5.5.5.3.2">𝑥</ci></apply></apply><apply id="Sx2.E4.m1.42.42.42.6.6.6.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6"><divide id="Sx2.E4.m1.42.42.42.6.6.6.2.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6"></divide><apply id="Sx2.E4.m1.42.42.42.6.6.6.3.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6.3"><csymbol cd="ambiguous" id="Sx2.E4.m1.42.42.42.6.6.6.3.1.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6.3">superscript</csymbol><ci id="Sx2.E4.m1.42.42.42.6.6.6.3.2.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6.3.2">𝛽</ci><ci id="Sx2.E4.m1.42.42.42.6.6.6.3.3.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6.3.3">𝛼</ci></apply><apply id="Sx2.E4.m1.42.42.42.6.6.6.1.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6.1"><times id="Sx2.E4.m1.42.42.42.6.6.6.1.2.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6.1.2"></times><ci id="Sx2.E4.m1.42.42.42.6.6.6.1.3.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6.1.3">Γ</ci><ci id="Sx2.E4.m1.42.42.42.6.6.6.1.1.cmml" xref="Sx2.E4.m1.42.42.42.6.6.6.1.1">𝛼</ci></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1.9.2.4.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.9.2.4.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">superscript</csymbol><ci id="Sx2.E4.m1.43.43.43.7.7.7.cmml" xref="Sx2.E4.m1.43.43.43.7.7.7">𝜆</ci><apply id="Sx2.E4.m1.44.44.44.8.8.8.1.cmml" xref="Sx2.E4.m1.44.44.44.8.8.8.1"><minus id="Sx2.E4.m1.44.44.44.8.8.8.1.1.cmml" xref="Sx2.E4.m1.44.44.44.8.8.8.1.1"></minus><ci id="Sx2.E4.m1.44.44.44.8.8.8.1.2.cmml" xref="Sx2.E4.m1.44.44.44.8.8.8.1.2">𝛼</ci><cn id="Sx2.E4.m1.44.44.44.8.8.8.1.3.cmml" type="integer" xref="Sx2.E4.m1.44.44.44.8.8.8.1.3">1</cn></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1.9.2.5.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.9.2.5.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">superscript</csymbol><ci id="Sx2.E4.m1.45.45.45.9.9.9.cmml" xref="Sx2.E4.m1.45.45.45.9.9.9">𝑒</ci><apply id="Sx2.E4.m1.46.46.46.10.10.10.1.cmml" xref="Sx2.E4.m1.46.46.46.10.10.10.1"><minus id="Sx2.E4.m1.46.46.46.10.10.10.1.1.cmml" xref="Sx2.E4.m1.46.46.46.10.10.10.1"></minus><apply id="Sx2.E4.m1.46.46.46.10.10.10.1.2.cmml" xref="Sx2.E4.m1.46.46.46.10.10.10.1.2"><times id="Sx2.E4.m1.46.46.46.10.10.10.1.2.1.cmml" xref="Sx2.E4.m1.46.46.46.10.10.10.1.2.1"></times><ci id="Sx2.E4.m1.46.46.46.10.10.10.1.2.2.cmml" xref="Sx2.E4.m1.46.46.46.10.10.10.1.2.2">𝛽</ci><ci id="Sx2.E4.m1.46.46.46.10.10.10.1.2.3.cmml" xref="Sx2.E4.m1.46.46.46.10.10.10.1.2.3">𝜆</ci></apply></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1.9.2.6.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="latexml" id="Sx2.E4.m1.47.47.47.11.11.11.cmml" xref="Sx2.E4.m1.47.47.47.11.11.11">differential-d</csymbol><ci id="Sx2.E4.m1.48.48.48.12.12.12.cmml" xref="Sx2.E4.m1.48.48.48.12.12.12">𝜆</ci></apply></apply></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1g.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><eq id="Sx2.E4.m1.49.49.49.1.1.1.cmml" xref="Sx2.E4.m1.49.49.49.1.1.1"></eq><share href="https://arxiv.org/html/2410.02126v1#Sx2.E4.m1.60.60.1.1.1.9.cmml" id="Sx2.E4.m1.60.60.1.1.1h.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></share><apply id="Sx2.E4.m1.60.60.1.1.1.11.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><times id="Sx2.E4.m1.60.60.1.1.1.11.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"></times><apply id="Sx2.E4.m1.50.50.50.2.2.2.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2"><divide id="Sx2.E4.m1.50.50.50.2.2.2.3.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2"></divide><apply id="Sx2.E4.m1.50.50.50.2.2.2.1.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.1"><times id="Sx2.E4.m1.50.50.50.2.2.2.1.2.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.1.2"></times><ci id="Sx2.E4.m1.50.50.50.2.2.2.1.3.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.1.3">Γ</ci><apply id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1"><plus id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.1.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.1"></plus><ci id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.2.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.2">𝑥</ci><ci id="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.3.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.1.1.1.1.3">𝛼</ci></apply></apply><apply id="Sx2.E4.m1.50.50.50.2.2.2.2.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.2"><times id="Sx2.E4.m1.50.50.50.2.2.2.2.2.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.2.2"></times><apply id="Sx2.E4.m1.50.50.50.2.2.2.2.3.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.2.3"><factorial id="Sx2.E4.m1.50.50.50.2.2.2.2.3.1.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.2.3.1"></factorial><ci id="Sx2.E4.m1.50.50.50.2.2.2.2.3.2.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.2.3.2">𝑥</ci></apply><ci id="Sx2.E4.m1.50.50.50.2.2.2.2.4.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.2.4">Γ</ci><ci id="Sx2.E4.m1.50.50.50.2.2.2.2.1.cmml" xref="Sx2.E4.m1.50.50.50.2.2.2.2.1">𝛼</ci></apply></apply><apply id="Sx2.E4.m1.60.60.1.1.1.11.3.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.11.3.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">superscript</csymbol><apply id="Sx2.E4.m1.52.52.52.4.4.4.cmml" xref="Sx2.E4.m1.52.52.52.4.4.4"><divide id="Sx2.E4.m1.52.52.52.4.4.4.1.cmml" xref="Sx2.E4.m1.52.52.52.4.4.4"></divide><ci id="Sx2.E4.m1.52.52.52.4.4.4.2.cmml" xref="Sx2.E4.m1.52.52.52.4.4.4.2">𝛽</ci><apply id="Sx2.E4.m1.52.52.52.4.4.4.3.cmml" xref="Sx2.E4.m1.52.52.52.4.4.4.3"><plus id="Sx2.E4.m1.52.52.52.4.4.4.3.1.cmml" xref="Sx2.E4.m1.52.52.52.4.4.4.3.1"></plus><cn id="Sx2.E4.m1.52.52.52.4.4.4.3.2.cmml" type="integer" xref="Sx2.E4.m1.52.52.52.4.4.4.3.2">1</cn><ci id="Sx2.E4.m1.52.52.52.4.4.4.3.3.cmml" xref="Sx2.E4.m1.52.52.52.4.4.4.3.3">𝛽</ci></apply></apply><ci id="Sx2.E4.m1.54.54.54.6.6.6.1.cmml" xref="Sx2.E4.m1.54.54.54.6.6.6.1">𝛼</ci></apply><apply id="Sx2.E4.m1.60.60.1.1.1.11.4.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8"><csymbol cd="ambiguous" id="Sx2.E4.m1.60.60.1.1.1.11.4.1.cmml" xref="Sx2.E4.m1.61.61.2.60.17.7.8">superscript</csymbol><apply id="Sx2.E4.m1.56.56.56.8.8.8.cmml" xref="Sx2.E4.m1.56.56.56.8.8.8"><divide id="Sx2.E4.m1.56.56.56.8.8.8.1.cmml" xref="Sx2.E4.m1.56.56.56.8.8.8"></divide><cn id="Sx2.E4.m1.56.56.56.8.8.8.2.cmml" type="integer" xref="Sx2.E4.m1.56.56.56.8.8.8.2">1</cn><apply id="Sx2.E4.m1.56.56.56.8.8.8.3.cmml" xref="Sx2.E4.m1.56.56.56.8.8.8.3"><plus id="Sx2.E4.m1.56.56.56.8.8.8.3.1.cmml" xref="Sx2.E4.m1.56.56.56.8.8.8.3.1"></plus><cn id="Sx2.E4.m1.56.56.56.8.8.8.3.2.cmml" type="integer" xref="Sx2.E4.m1.56.56.56.8.8.8.3.2">1</cn><ci id="Sx2.E4.m1.56.56.56.8.8.8.3.3.cmml" xref="Sx2.E4.m1.56.56.56.8.8.8.3.3">𝛽</ci></apply></apply><ci id="Sx2.E4.m1.58.58.58.10.10.10.1.cmml" xref="Sx2.E4.m1.58.58.58.10.10.10.1">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E4.m1.65c">\begin{split}p(x|\phi)&amp;\triangleq p_{GP}(x|\alpha,\beta)\\
&amp;=\int_{0}^{\infty}{\text{Poisson}(x|\lambda)\text{Gamma}(\lambda|\alpha,\beta%
)d\lambda}\\
&amp;=\int_{0}^{\infty}{\frac{e^{-\lambda}\lambda^{x}}{x!}\frac{\beta^{\alpha}}{%
\Gamma(\alpha)}\lambda^{\alpha-1}e^{-\beta\lambda}d\lambda}\\
&amp;=\frac{\Gamma(x+\alpha)}{x!\Gamma(\alpha)}\left(\frac{\beta}{1+\beta}\right)^%
{\alpha}\left(\frac{1}{1+\beta}\right)^{x},\end{split}</annotation><annotation encoding="application/x-llamapun" id="Sx2.E4.m1.65d">start_ROW start_CELL italic_p ( italic_x | italic_ϕ ) end_CELL start_CELL ≜ italic_p start_POSTSUBSCRIPT italic_G italic_P end_POSTSUBSCRIPT ( italic_x | italic_α , italic_β ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = ∫ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT Poisson ( italic_x | italic_λ ) Gamma ( italic_λ | italic_α , italic_β ) italic_d italic_λ end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = ∫ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∞ end_POSTSUPERSCRIPT divide start_ARG italic_e start_POSTSUPERSCRIPT - italic_λ end_POSTSUPERSCRIPT italic_λ start_POSTSUPERSCRIPT italic_x end_POSTSUPERSCRIPT end_ARG start_ARG italic_x ! end_ARG divide start_ARG italic_β start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT end_ARG start_ARG roman_Γ ( italic_α ) end_ARG italic_λ start_POSTSUPERSCRIPT italic_α - 1 end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT - italic_β italic_λ end_POSTSUPERSCRIPT italic_d italic_λ end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = divide start_ARG roman_Γ ( italic_x + italic_α ) end_ARG start_ARG italic_x ! roman_Γ ( italic_α ) end_ARG ( divide start_ARG italic_β end_ARG start_ARG 1 + italic_β end_ARG ) start_POSTSUPERSCRIPT italic_α end_POSTSUPERSCRIPT ( divide start_ARG 1 end_ARG start_ARG 1 + italic_β end_ARG ) start_POSTSUPERSCRIPT italic_x end_POSTSUPERSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx2.p2.4">where <math alttext="\Gamma(\cdot)" class="ltx_Math" display="inline" id="Sx2.SSx2.p2.4.m1.1"><semantics id="Sx2.SSx2.p2.4.m1.1a"><mrow id="Sx2.SSx2.p2.4.m1.1.2" xref="Sx2.SSx2.p2.4.m1.1.2.cmml"><mi id="Sx2.SSx2.p2.4.m1.1.2.2" mathvariant="normal" xref="Sx2.SSx2.p2.4.m1.1.2.2.cmml">Γ</mi><mo id="Sx2.SSx2.p2.4.m1.1.2.1" xref="Sx2.SSx2.p2.4.m1.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx2.p2.4.m1.1.2.3.2" xref="Sx2.SSx2.p2.4.m1.1.2.cmml"><mo id="Sx2.SSx2.p2.4.m1.1.2.3.2.1" stretchy="false" xref="Sx2.SSx2.p2.4.m1.1.2.cmml">(</mo><mo id="Sx2.SSx2.p2.4.m1.1.1" lspace="0em" rspace="0em" xref="Sx2.SSx2.p2.4.m1.1.1.cmml">⋅</mo><mo id="Sx2.SSx2.p2.4.m1.1.2.3.2.2" stretchy="false" xref="Sx2.SSx2.p2.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p2.4.m1.1b"><apply id="Sx2.SSx2.p2.4.m1.1.2.cmml" xref="Sx2.SSx2.p2.4.m1.1.2"><times id="Sx2.SSx2.p2.4.m1.1.2.1.cmml" xref="Sx2.SSx2.p2.4.m1.1.2.1"></times><ci id="Sx2.SSx2.p2.4.m1.1.2.2.cmml" xref="Sx2.SSx2.p2.4.m1.1.2.2">Γ</ci><ci id="Sx2.SSx2.p2.4.m1.1.1.cmml" xref="Sx2.SSx2.p2.4.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p2.4.m1.1c">\Gamma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p2.4.m1.1d">roman_Γ ( ⋅ )</annotation></semantics></math> denotes the Gamma function.</p>
</div>
<div class="ltx_para" id="Sx2.SSx2.p3">
<p class="ltx_p" id="Sx2.SSx2.p3.1">Despite its attractive properties, the distribution is not immediately amenable to stochastic gradient-based techniques due to numerical underflow of the rate parameter gradients <math alttext="\beta" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.1.m1.1"><semantics id="Sx2.SSx2.p3.1.m1.1a"><mi id="Sx2.SSx2.p3.1.m1.1.1" xref="Sx2.SSx2.p3.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.1.m1.1b"><ci id="Sx2.SSx2.p3.1.m1.1.1.cmml" xref="Sx2.SSx2.p3.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.1.m1.1d">italic_β</annotation></semantics></math>. Instead, we introduce a parameterization of the Gamma-Poisson distribution which circumvents these issues. Firstly, we note that this distribution is equivalent to the negative binomial distribution</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{NB}(x|r,\rho)\triangleq\frac{\Gamma(x+r)}{x!\Gamma(r)}\rho^{r}(1-\rho)^{x}," class="ltx_Math" display="block" id="Sx2.E5.m1.5"><semantics id="Sx2.E5.m1.5a"><mrow id="Sx2.E5.m1.5.5.1" xref="Sx2.E5.m1.5.5.1.1.cmml"><mrow id="Sx2.E5.m1.5.5.1.1" xref="Sx2.E5.m1.5.5.1.1.cmml"><mrow id="Sx2.E5.m1.5.5.1.1.1" xref="Sx2.E5.m1.5.5.1.1.1.cmml"><msub id="Sx2.E5.m1.5.5.1.1.1.3" xref="Sx2.E5.m1.5.5.1.1.1.3.cmml"><mi id="Sx2.E5.m1.5.5.1.1.1.3.2" xref="Sx2.E5.m1.5.5.1.1.1.3.2.cmml">p</mi><mrow id="Sx2.E5.m1.5.5.1.1.1.3.3" xref="Sx2.E5.m1.5.5.1.1.1.3.3.cmml"><mi id="Sx2.E5.m1.5.5.1.1.1.3.3.2" xref="Sx2.E5.m1.5.5.1.1.1.3.3.2.cmml">N</mi><mo id="Sx2.E5.m1.5.5.1.1.1.3.3.1" xref="Sx2.E5.m1.5.5.1.1.1.3.3.1.cmml">⁢</mo><mi id="Sx2.E5.m1.5.5.1.1.1.3.3.3" xref="Sx2.E5.m1.5.5.1.1.1.3.3.3.cmml">B</mi></mrow></msub><mo id="Sx2.E5.m1.5.5.1.1.1.2" xref="Sx2.E5.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E5.m1.5.5.1.1.1.1.1" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.cmml"><mo id="Sx2.E5.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E5.m1.5.5.1.1.1.1.1.1" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.cmml"><mi id="Sx2.E5.m1.5.5.1.1.1.1.1.1.2" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="Sx2.E5.m1.5.5.1.1.1.1.1.1.1" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.1.cmml">|</mo><mrow id="Sx2.E5.m1.5.5.1.1.1.1.1.1.3.2" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.3.1.cmml"><mi id="Sx2.E5.m1.3.3" xref="Sx2.E5.m1.3.3.cmml">r</mi><mo id="Sx2.E5.m1.5.5.1.1.1.1.1.1.3.2.1" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="Sx2.E5.m1.4.4" xref="Sx2.E5.m1.4.4.cmml">ρ</mi></mrow></mrow><mo id="Sx2.E5.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E5.m1.5.5.1.1.3" xref="Sx2.E5.m1.5.5.1.1.3.cmml">≜</mo><mrow id="Sx2.E5.m1.5.5.1.1.2" xref="Sx2.E5.m1.5.5.1.1.2.cmml"><mfrac id="Sx2.E5.m1.2.2" xref="Sx2.E5.m1.2.2.cmml"><mrow id="Sx2.E5.m1.1.1.1" xref="Sx2.E5.m1.1.1.1.cmml"><mi id="Sx2.E5.m1.1.1.1.3" mathvariant="normal" xref="Sx2.E5.m1.1.1.1.3.cmml">Γ</mi><mo id="Sx2.E5.m1.1.1.1.2" xref="Sx2.E5.m1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E5.m1.1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.1.1.cmml"><mo id="Sx2.E5.m1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E5.m1.1.1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.1.1.cmml"><mi id="Sx2.E5.m1.1.1.1.1.1.1.2" xref="Sx2.E5.m1.1.1.1.1.1.1.2.cmml">x</mi><mo id="Sx2.E5.m1.1.1.1.1.1.1.1" xref="Sx2.E5.m1.1.1.1.1.1.1.1.cmml">+</mo><mi id="Sx2.E5.m1.1.1.1.1.1.1.3" xref="Sx2.E5.m1.1.1.1.1.1.1.3.cmml">r</mi></mrow><mo id="Sx2.E5.m1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="Sx2.E5.m1.2.2.2" xref="Sx2.E5.m1.2.2.2.cmml"><mrow id="Sx2.E5.m1.2.2.2.3" xref="Sx2.E5.m1.2.2.2.3.cmml"><mi id="Sx2.E5.m1.2.2.2.3.2" xref="Sx2.E5.m1.2.2.2.3.2.cmml">x</mi><mo id="Sx2.E5.m1.2.2.2.3.1" xref="Sx2.E5.m1.2.2.2.3.1.cmml">!</mo></mrow><mo id="Sx2.E5.m1.2.2.2.2" xref="Sx2.E5.m1.2.2.2.2.cmml">⁢</mo><mi id="Sx2.E5.m1.2.2.2.4" mathvariant="normal" xref="Sx2.E5.m1.2.2.2.4.cmml">Γ</mi><mo id="Sx2.E5.m1.2.2.2.2a" xref="Sx2.E5.m1.2.2.2.2.cmml">⁢</mo><mrow id="Sx2.E5.m1.2.2.2.5.2" xref="Sx2.E5.m1.2.2.2.cmml"><mo id="Sx2.E5.m1.2.2.2.5.2.1" stretchy="false" xref="Sx2.E5.m1.2.2.2.cmml">(</mo><mi id="Sx2.E5.m1.2.2.2.1" xref="Sx2.E5.m1.2.2.2.1.cmml">r</mi><mo id="Sx2.E5.m1.2.2.2.5.2.2" stretchy="false" xref="Sx2.E5.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="Sx2.E5.m1.5.5.1.1.2.2" xref="Sx2.E5.m1.5.5.1.1.2.2.cmml">⁢</mo><msup id="Sx2.E5.m1.5.5.1.1.2.3" xref="Sx2.E5.m1.5.5.1.1.2.3.cmml"><mi id="Sx2.E5.m1.5.5.1.1.2.3.2" xref="Sx2.E5.m1.5.5.1.1.2.3.2.cmml">ρ</mi><mi id="Sx2.E5.m1.5.5.1.1.2.3.3" xref="Sx2.E5.m1.5.5.1.1.2.3.3.cmml">r</mi></msup><mo id="Sx2.E5.m1.5.5.1.1.2.2a" xref="Sx2.E5.m1.5.5.1.1.2.2.cmml">⁢</mo><msup id="Sx2.E5.m1.5.5.1.1.2.1" xref="Sx2.E5.m1.5.5.1.1.2.1.cmml"><mrow id="Sx2.E5.m1.5.5.1.1.2.1.1.1" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.cmml"><mo id="Sx2.E5.m1.5.5.1.1.2.1.1.1.2" stretchy="false" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.cmml">(</mo><mrow id="Sx2.E5.m1.5.5.1.1.2.1.1.1.1" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.cmml"><mn id="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.2" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.1" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.1.cmml">−</mo><mi id="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.3" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.3.cmml">ρ</mi></mrow><mo id="Sx2.E5.m1.5.5.1.1.2.1.1.1.3" stretchy="false" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.cmml">)</mo></mrow><mi id="Sx2.E5.m1.5.5.1.1.2.1.3" xref="Sx2.E5.m1.5.5.1.1.2.1.3.cmml">x</mi></msup></mrow></mrow><mo id="Sx2.E5.m1.5.5.1.2" xref="Sx2.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E5.m1.5b"><apply id="Sx2.E5.m1.5.5.1.1.cmml" xref="Sx2.E5.m1.5.5.1"><ci id="Sx2.E5.m1.5.5.1.1.3.cmml" xref="Sx2.E5.m1.5.5.1.1.3">≜</ci><apply id="Sx2.E5.m1.5.5.1.1.1.cmml" xref="Sx2.E5.m1.5.5.1.1.1"><times id="Sx2.E5.m1.5.5.1.1.1.2.cmml" xref="Sx2.E5.m1.5.5.1.1.1.2"></times><apply id="Sx2.E5.m1.5.5.1.1.1.3.cmml" xref="Sx2.E5.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.5.5.1.1.1.3.1.cmml" xref="Sx2.E5.m1.5.5.1.1.1.3">subscript</csymbol><ci id="Sx2.E5.m1.5.5.1.1.1.3.2.cmml" xref="Sx2.E5.m1.5.5.1.1.1.3.2">𝑝</ci><apply id="Sx2.E5.m1.5.5.1.1.1.3.3.cmml" xref="Sx2.E5.m1.5.5.1.1.1.3.3"><times id="Sx2.E5.m1.5.5.1.1.1.3.3.1.cmml" xref="Sx2.E5.m1.5.5.1.1.1.3.3.1"></times><ci id="Sx2.E5.m1.5.5.1.1.1.3.3.2.cmml" xref="Sx2.E5.m1.5.5.1.1.1.3.3.2">𝑁</ci><ci id="Sx2.E5.m1.5.5.1.1.1.3.3.3.cmml" xref="Sx2.E5.m1.5.5.1.1.1.3.3.3">𝐵</ci></apply></apply><apply id="Sx2.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="Sx2.E5.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E5.m1.5.5.1.1.1.1.1.1.1.cmml" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.1">conditional</csymbol><ci id="Sx2.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.2">𝑥</ci><list id="Sx2.E5.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E5.m1.5.5.1.1.1.1.1.1.3.2"><ci id="Sx2.E5.m1.3.3.cmml" xref="Sx2.E5.m1.3.3">𝑟</ci><ci id="Sx2.E5.m1.4.4.cmml" xref="Sx2.E5.m1.4.4">𝜌</ci></list></apply></apply><apply id="Sx2.E5.m1.5.5.1.1.2.cmml" xref="Sx2.E5.m1.5.5.1.1.2"><times id="Sx2.E5.m1.5.5.1.1.2.2.cmml" xref="Sx2.E5.m1.5.5.1.1.2.2"></times><apply id="Sx2.E5.m1.2.2.cmml" xref="Sx2.E5.m1.2.2"><divide id="Sx2.E5.m1.2.2.3.cmml" xref="Sx2.E5.m1.2.2"></divide><apply id="Sx2.E5.m1.1.1.1.cmml" xref="Sx2.E5.m1.1.1.1"><times id="Sx2.E5.m1.1.1.1.2.cmml" xref="Sx2.E5.m1.1.1.1.2"></times><ci id="Sx2.E5.m1.1.1.1.3.cmml" xref="Sx2.E5.m1.1.1.1.3">Γ</ci><apply id="Sx2.E5.m1.1.1.1.1.1.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1"><plus id="Sx2.E5.m1.1.1.1.1.1.1.1.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.1"></plus><ci id="Sx2.E5.m1.1.1.1.1.1.1.2.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="Sx2.E5.m1.1.1.1.1.1.1.3.cmml" xref="Sx2.E5.m1.1.1.1.1.1.1.3">𝑟</ci></apply></apply><apply id="Sx2.E5.m1.2.2.2.cmml" xref="Sx2.E5.m1.2.2.2"><times id="Sx2.E5.m1.2.2.2.2.cmml" xref="Sx2.E5.m1.2.2.2.2"></times><apply id="Sx2.E5.m1.2.2.2.3.cmml" xref="Sx2.E5.m1.2.2.2.3"><factorial id="Sx2.E5.m1.2.2.2.3.1.cmml" xref="Sx2.E5.m1.2.2.2.3.1"></factorial><ci id="Sx2.E5.m1.2.2.2.3.2.cmml" xref="Sx2.E5.m1.2.2.2.3.2">𝑥</ci></apply><ci id="Sx2.E5.m1.2.2.2.4.cmml" xref="Sx2.E5.m1.2.2.2.4">Γ</ci><ci id="Sx2.E5.m1.2.2.2.1.cmml" xref="Sx2.E5.m1.2.2.2.1">𝑟</ci></apply></apply><apply id="Sx2.E5.m1.5.5.1.1.2.3.cmml" xref="Sx2.E5.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="Sx2.E5.m1.5.5.1.1.2.3.1.cmml" xref="Sx2.E5.m1.5.5.1.1.2.3">superscript</csymbol><ci id="Sx2.E5.m1.5.5.1.1.2.3.2.cmml" xref="Sx2.E5.m1.5.5.1.1.2.3.2">𝜌</ci><ci id="Sx2.E5.m1.5.5.1.1.2.3.3.cmml" xref="Sx2.E5.m1.5.5.1.1.2.3.3">𝑟</ci></apply><apply id="Sx2.E5.m1.5.5.1.1.2.1.cmml" xref="Sx2.E5.m1.5.5.1.1.2.1"><csymbol cd="ambiguous" id="Sx2.E5.m1.5.5.1.1.2.1.2.cmml" xref="Sx2.E5.m1.5.5.1.1.2.1">superscript</csymbol><apply id="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.cmml" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1"><minus id="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.1"></minus><cn id="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.2.cmml" type="integer" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.2">1</cn><ci id="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.3.cmml" xref="Sx2.E5.m1.5.5.1.1.2.1.1.1.1.3">𝜌</ci></apply><ci id="Sx2.E5.m1.5.5.1.1.2.1.3.cmml" xref="Sx2.E5.m1.5.5.1.1.2.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E5.m1.5c">p_{NB}(x|r,\rho)\triangleq\frac{\Gamma(x+r)}{x!\Gamma(r)}\rho^{r}(1-\rho)^{x},</annotation><annotation encoding="application/x-llamapun" id="Sx2.E5.m1.5d">italic_p start_POSTSUBSCRIPT italic_N italic_B end_POSTSUBSCRIPT ( italic_x | italic_r , italic_ρ ) ≜ divide start_ARG roman_Γ ( italic_x + italic_r ) end_ARG start_ARG italic_x ! roman_Γ ( italic_r ) end_ARG italic_ρ start_POSTSUPERSCRIPT italic_r end_POSTSUPERSCRIPT ( 1 - italic_ρ ) start_POSTSUPERSCRIPT italic_x end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx2.p3.5">with <math alttext="r=\alpha" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.2.m1.1"><semantics id="Sx2.SSx2.p3.2.m1.1a"><mrow id="Sx2.SSx2.p3.2.m1.1.1" xref="Sx2.SSx2.p3.2.m1.1.1.cmml"><mi id="Sx2.SSx2.p3.2.m1.1.1.2" xref="Sx2.SSx2.p3.2.m1.1.1.2.cmml">r</mi><mo id="Sx2.SSx2.p3.2.m1.1.1.1" xref="Sx2.SSx2.p3.2.m1.1.1.1.cmml">=</mo><mi id="Sx2.SSx2.p3.2.m1.1.1.3" xref="Sx2.SSx2.p3.2.m1.1.1.3.cmml">α</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.2.m1.1b"><apply id="Sx2.SSx2.p3.2.m1.1.1.cmml" xref="Sx2.SSx2.p3.2.m1.1.1"><eq id="Sx2.SSx2.p3.2.m1.1.1.1.cmml" xref="Sx2.SSx2.p3.2.m1.1.1.1"></eq><ci id="Sx2.SSx2.p3.2.m1.1.1.2.cmml" xref="Sx2.SSx2.p3.2.m1.1.1.2">𝑟</ci><ci id="Sx2.SSx2.p3.2.m1.1.1.3.cmml" xref="Sx2.SSx2.p3.2.m1.1.1.3">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.2.m1.1c">r=\alpha</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.2.m1.1d">italic_r = italic_α</annotation></semantics></math> and <math alttext="\rho=\frac{\beta}{1+\beta}" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.3.m2.1"><semantics id="Sx2.SSx2.p3.3.m2.1a"><mrow id="Sx2.SSx2.p3.3.m2.1.1" xref="Sx2.SSx2.p3.3.m2.1.1.cmml"><mi id="Sx2.SSx2.p3.3.m2.1.1.2" xref="Sx2.SSx2.p3.3.m2.1.1.2.cmml">ρ</mi><mo id="Sx2.SSx2.p3.3.m2.1.1.1" xref="Sx2.SSx2.p3.3.m2.1.1.1.cmml">=</mo><mfrac id="Sx2.SSx2.p3.3.m2.1.1.3" xref="Sx2.SSx2.p3.3.m2.1.1.3.cmml"><mi id="Sx2.SSx2.p3.3.m2.1.1.3.2" xref="Sx2.SSx2.p3.3.m2.1.1.3.2.cmml">β</mi><mrow id="Sx2.SSx2.p3.3.m2.1.1.3.3" xref="Sx2.SSx2.p3.3.m2.1.1.3.3.cmml"><mn id="Sx2.SSx2.p3.3.m2.1.1.3.3.2" xref="Sx2.SSx2.p3.3.m2.1.1.3.3.2.cmml">1</mn><mo id="Sx2.SSx2.p3.3.m2.1.1.3.3.1" xref="Sx2.SSx2.p3.3.m2.1.1.3.3.1.cmml">+</mo><mi id="Sx2.SSx2.p3.3.m2.1.1.3.3.3" xref="Sx2.SSx2.p3.3.m2.1.1.3.3.3.cmml">β</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.3.m2.1b"><apply id="Sx2.SSx2.p3.3.m2.1.1.cmml" xref="Sx2.SSx2.p3.3.m2.1.1"><eq id="Sx2.SSx2.p3.3.m2.1.1.1.cmml" xref="Sx2.SSx2.p3.3.m2.1.1.1"></eq><ci id="Sx2.SSx2.p3.3.m2.1.1.2.cmml" xref="Sx2.SSx2.p3.3.m2.1.1.2">𝜌</ci><apply id="Sx2.SSx2.p3.3.m2.1.1.3.cmml" xref="Sx2.SSx2.p3.3.m2.1.1.3"><divide id="Sx2.SSx2.p3.3.m2.1.1.3.1.cmml" xref="Sx2.SSx2.p3.3.m2.1.1.3"></divide><ci id="Sx2.SSx2.p3.3.m2.1.1.3.2.cmml" xref="Sx2.SSx2.p3.3.m2.1.1.3.2">𝛽</ci><apply id="Sx2.SSx2.p3.3.m2.1.1.3.3.cmml" xref="Sx2.SSx2.p3.3.m2.1.1.3.3"><plus id="Sx2.SSx2.p3.3.m2.1.1.3.3.1.cmml" xref="Sx2.SSx2.p3.3.m2.1.1.3.3.1"></plus><cn id="Sx2.SSx2.p3.3.m2.1.1.3.3.2.cmml" type="integer" xref="Sx2.SSx2.p3.3.m2.1.1.3.3.2">1</cn><ci id="Sx2.SSx2.p3.3.m2.1.1.3.3.3.cmml" xref="Sx2.SSx2.p3.3.m2.1.1.3.3.3">𝛽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.3.m2.1c">\rho=\frac{\beta}{1+\beta}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.3.m2.1d">italic_ρ = divide start_ARG italic_β end_ARG start_ARG 1 + italic_β end_ARG</annotation></semantics></math>. We can further reparameterize <math alttext="\rho" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.4.m3.1"><semantics id="Sx2.SSx2.p3.4.m3.1a"><mi id="Sx2.SSx2.p3.4.m3.1.1" xref="Sx2.SSx2.p3.4.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.4.m3.1b"><ci id="Sx2.SSx2.p3.4.m3.1.1.cmml" xref="Sx2.SSx2.p3.4.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.4.m3.1c">\rho</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.4.m3.1d">italic_ρ</annotation></semantics></math> in terms of logits <math alttext="\zeta" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.5.m4.1"><semantics id="Sx2.SSx2.p3.5.m4.1a"><mi id="Sx2.SSx2.p3.5.m4.1.1" xref="Sx2.SSx2.p3.5.m4.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.5.m4.1b"><ci id="Sx2.SSx2.p3.5.m4.1.1.cmml" xref="Sx2.SSx2.p3.5.m4.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.5.m4.1c">\zeta</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.5.m4.1d">italic_ζ</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\rho=\frac{\beta}{1+\beta}\triangleq\sigma(\zeta)," class="ltx_Math" display="block" id="Sx2.E6.m1.2"><semantics id="Sx2.E6.m1.2a"><mrow id="Sx2.E6.m1.2.2.1" xref="Sx2.E6.m1.2.2.1.1.cmml"><mrow id="Sx2.E6.m1.2.2.1.1" xref="Sx2.E6.m1.2.2.1.1.cmml"><mi id="Sx2.E6.m1.2.2.1.1.2" xref="Sx2.E6.m1.2.2.1.1.2.cmml">ρ</mi><mo id="Sx2.E6.m1.2.2.1.1.3" xref="Sx2.E6.m1.2.2.1.1.3.cmml">=</mo><mfrac id="Sx2.E6.m1.2.2.1.1.4" xref="Sx2.E6.m1.2.2.1.1.4.cmml"><mi id="Sx2.E6.m1.2.2.1.1.4.2" xref="Sx2.E6.m1.2.2.1.1.4.2.cmml">β</mi><mrow id="Sx2.E6.m1.2.2.1.1.4.3" xref="Sx2.E6.m1.2.2.1.1.4.3.cmml"><mn id="Sx2.E6.m1.2.2.1.1.4.3.2" xref="Sx2.E6.m1.2.2.1.1.4.3.2.cmml">1</mn><mo id="Sx2.E6.m1.2.2.1.1.4.3.1" xref="Sx2.E6.m1.2.2.1.1.4.3.1.cmml">+</mo><mi id="Sx2.E6.m1.2.2.1.1.4.3.3" xref="Sx2.E6.m1.2.2.1.1.4.3.3.cmml">β</mi></mrow></mfrac><mo id="Sx2.E6.m1.2.2.1.1.5" xref="Sx2.E6.m1.2.2.1.1.5.cmml">≜</mo><mrow id="Sx2.E6.m1.2.2.1.1.6" xref="Sx2.E6.m1.2.2.1.1.6.cmml"><mi id="Sx2.E6.m1.2.2.1.1.6.2" xref="Sx2.E6.m1.2.2.1.1.6.2.cmml">σ</mi><mo id="Sx2.E6.m1.2.2.1.1.6.1" xref="Sx2.E6.m1.2.2.1.1.6.1.cmml">⁢</mo><mrow id="Sx2.E6.m1.2.2.1.1.6.3.2" xref="Sx2.E6.m1.2.2.1.1.6.cmml"><mo id="Sx2.E6.m1.2.2.1.1.6.3.2.1" stretchy="false" xref="Sx2.E6.m1.2.2.1.1.6.cmml">(</mo><mi id="Sx2.E6.m1.1.1" xref="Sx2.E6.m1.1.1.cmml">ζ</mi><mo id="Sx2.E6.m1.2.2.1.1.6.3.2.2" stretchy="false" xref="Sx2.E6.m1.2.2.1.1.6.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.E6.m1.2.2.1.2" xref="Sx2.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E6.m1.2b"><apply id="Sx2.E6.m1.2.2.1.1.cmml" xref="Sx2.E6.m1.2.2.1"><and id="Sx2.E6.m1.2.2.1.1a.cmml" xref="Sx2.E6.m1.2.2.1"></and><apply id="Sx2.E6.m1.2.2.1.1b.cmml" xref="Sx2.E6.m1.2.2.1"><eq id="Sx2.E6.m1.2.2.1.1.3.cmml" xref="Sx2.E6.m1.2.2.1.1.3"></eq><ci id="Sx2.E6.m1.2.2.1.1.2.cmml" xref="Sx2.E6.m1.2.2.1.1.2">𝜌</ci><apply id="Sx2.E6.m1.2.2.1.1.4.cmml" xref="Sx2.E6.m1.2.2.1.1.4"><divide id="Sx2.E6.m1.2.2.1.1.4.1.cmml" xref="Sx2.E6.m1.2.2.1.1.4"></divide><ci id="Sx2.E6.m1.2.2.1.1.4.2.cmml" xref="Sx2.E6.m1.2.2.1.1.4.2">𝛽</ci><apply id="Sx2.E6.m1.2.2.1.1.4.3.cmml" xref="Sx2.E6.m1.2.2.1.1.4.3"><plus id="Sx2.E6.m1.2.2.1.1.4.3.1.cmml" xref="Sx2.E6.m1.2.2.1.1.4.3.1"></plus><cn id="Sx2.E6.m1.2.2.1.1.4.3.2.cmml" type="integer" xref="Sx2.E6.m1.2.2.1.1.4.3.2">1</cn><ci id="Sx2.E6.m1.2.2.1.1.4.3.3.cmml" xref="Sx2.E6.m1.2.2.1.1.4.3.3">𝛽</ci></apply></apply></apply><apply id="Sx2.E6.m1.2.2.1.1c.cmml" xref="Sx2.E6.m1.2.2.1"><ci id="Sx2.E6.m1.2.2.1.1.5.cmml" xref="Sx2.E6.m1.2.2.1.1.5">≜</ci><share href="https://arxiv.org/html/2410.02126v1#Sx2.E6.m1.2.2.1.1.4.cmml" id="Sx2.E6.m1.2.2.1.1d.cmml" xref="Sx2.E6.m1.2.2.1"></share><apply id="Sx2.E6.m1.2.2.1.1.6.cmml" xref="Sx2.E6.m1.2.2.1.1.6"><times id="Sx2.E6.m1.2.2.1.1.6.1.cmml" xref="Sx2.E6.m1.2.2.1.1.6.1"></times><ci id="Sx2.E6.m1.2.2.1.1.6.2.cmml" xref="Sx2.E6.m1.2.2.1.1.6.2">𝜎</ci><ci id="Sx2.E6.m1.1.1.cmml" xref="Sx2.E6.m1.1.1">𝜁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E6.m1.2c">\rho=\frac{\beta}{1+\beta}\triangleq\sigma(\zeta),</annotation><annotation encoding="application/x-llamapun" id="Sx2.E6.m1.2d">italic_ρ = divide start_ARG italic_β end_ARG start_ARG 1 + italic_β end_ARG ≜ italic_σ ( italic_ζ ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx2.p3.9">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.6.m1.1"><semantics id="Sx2.SSx2.p3.6.m1.1a"><mrow id="Sx2.SSx2.p3.6.m1.1.2" xref="Sx2.SSx2.p3.6.m1.1.2.cmml"><mi id="Sx2.SSx2.p3.6.m1.1.2.2" xref="Sx2.SSx2.p3.6.m1.1.2.2.cmml">σ</mi><mo id="Sx2.SSx2.p3.6.m1.1.2.1" xref="Sx2.SSx2.p3.6.m1.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx2.p3.6.m1.1.2.3.2" xref="Sx2.SSx2.p3.6.m1.1.2.cmml"><mo id="Sx2.SSx2.p3.6.m1.1.2.3.2.1" stretchy="false" xref="Sx2.SSx2.p3.6.m1.1.2.cmml">(</mo><mo id="Sx2.SSx2.p3.6.m1.1.1" lspace="0em" rspace="0em" xref="Sx2.SSx2.p3.6.m1.1.1.cmml">⋅</mo><mo id="Sx2.SSx2.p3.6.m1.1.2.3.2.2" stretchy="false" xref="Sx2.SSx2.p3.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.6.m1.1b"><apply id="Sx2.SSx2.p3.6.m1.1.2.cmml" xref="Sx2.SSx2.p3.6.m1.1.2"><times id="Sx2.SSx2.p3.6.m1.1.2.1.cmml" xref="Sx2.SSx2.p3.6.m1.1.2.1"></times><ci id="Sx2.SSx2.p3.6.m1.1.2.2.cmml" xref="Sx2.SSx2.p3.6.m1.1.2.2">𝜎</ci><ci id="Sx2.SSx2.p3.6.m1.1.1.cmml" xref="Sx2.SSx2.p3.6.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.6.m1.1c">\sigma(\cdot)</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.6.m1.1d">italic_σ ( ⋅ )</annotation></semantics></math> denotes the sigmoid function. Note also that <math alttext="\beta=e^{\zeta}" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.7.m2.1"><semantics id="Sx2.SSx2.p3.7.m2.1a"><mrow id="Sx2.SSx2.p3.7.m2.1.1" xref="Sx2.SSx2.p3.7.m2.1.1.cmml"><mi id="Sx2.SSx2.p3.7.m2.1.1.2" xref="Sx2.SSx2.p3.7.m2.1.1.2.cmml">β</mi><mo id="Sx2.SSx2.p3.7.m2.1.1.1" xref="Sx2.SSx2.p3.7.m2.1.1.1.cmml">=</mo><msup id="Sx2.SSx2.p3.7.m2.1.1.3" xref="Sx2.SSx2.p3.7.m2.1.1.3.cmml"><mi id="Sx2.SSx2.p3.7.m2.1.1.3.2" xref="Sx2.SSx2.p3.7.m2.1.1.3.2.cmml">e</mi><mi id="Sx2.SSx2.p3.7.m2.1.1.3.3" xref="Sx2.SSx2.p3.7.m2.1.1.3.3.cmml">ζ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.7.m2.1b"><apply id="Sx2.SSx2.p3.7.m2.1.1.cmml" xref="Sx2.SSx2.p3.7.m2.1.1"><eq id="Sx2.SSx2.p3.7.m2.1.1.1.cmml" xref="Sx2.SSx2.p3.7.m2.1.1.1"></eq><ci id="Sx2.SSx2.p3.7.m2.1.1.2.cmml" xref="Sx2.SSx2.p3.7.m2.1.1.2">𝛽</ci><apply id="Sx2.SSx2.p3.7.m2.1.1.3.cmml" xref="Sx2.SSx2.p3.7.m2.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx2.p3.7.m2.1.1.3.1.cmml" xref="Sx2.SSx2.p3.7.m2.1.1.3">superscript</csymbol><ci id="Sx2.SSx2.p3.7.m2.1.1.3.2.cmml" xref="Sx2.SSx2.p3.7.m2.1.1.3.2">𝑒</ci><ci id="Sx2.SSx2.p3.7.m2.1.1.3.3.cmml" xref="Sx2.SSx2.p3.7.m2.1.1.3.3">𝜁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.7.m2.1c">\beta=e^{\zeta}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.7.m2.1d">italic_β = italic_e start_POSTSUPERSCRIPT italic_ζ end_POSTSUPERSCRIPT</annotation></semantics></math>. Ignoring constant terms with respect to <math alttext="\alpha" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.8.m3.1"><semantics id="Sx2.SSx2.p3.8.m3.1a"><mi id="Sx2.SSx2.p3.8.m3.1.1" xref="Sx2.SSx2.p3.8.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.8.m3.1b"><ci id="Sx2.SSx2.p3.8.m3.1.1.cmml" xref="Sx2.SSx2.p3.8.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.8.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.8.m3.1d">italic_α</annotation></semantics></math> and <math alttext="\zeta" class="ltx_Math" display="inline" id="Sx2.SSx2.p3.9.m4.1"><semantics id="Sx2.SSx2.p3.9.m4.1a"><mi id="Sx2.SSx2.p3.9.m4.1.1" xref="Sx2.SSx2.p3.9.m4.1.1.cmml">ζ</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p3.9.m4.1b"><ci id="Sx2.SSx2.p3.9.m4.1.1.cmml" xref="Sx2.SSx2.p3.9.m4.1.1">𝜁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p3.9.m4.1c">\zeta</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p3.9.m4.1d">italic_ζ</annotation></semantics></math>, the log-likelihood of the Gamma-Poisson distribution becomes:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\log p(x|\alpha,\zeta)=&amp;\log{\Gamma(x+\alpha)}-\log{\Gamma(\alpha%
)}\\
&amp;+\alpha\log{\sigma(\zeta)}+x\log{(1-\sigma(\zeta))}.\end{split}" class="ltx_Math" display="block" id="Sx2.E7.m1.46"><semantics id="Sx2.E7.m1.46a"><mtable columnspacing="0pt" displaystyle="true" id="Sx2.E7.m1.46.46.4" rowspacing="0pt"><mtr id="Sx2.E7.m1.46.46.4a"><mtd class="ltx_align_right" columnalign="right" id="Sx2.E7.m1.46.46.4b"><mrow id="Sx2.E7.m1.44.44.2.43.24.11"><mrow id="Sx2.E7.m1.44.44.2.43.24.11.11"><mrow id="Sx2.E7.m1.44.44.2.43.24.11.11.3"><mi id="Sx2.E7.m1.1.1.1.1.1.1" xref="Sx2.E7.m1.1.1.1.1.1.1.cmml">log</mi><mo id="Sx2.E7.m1.44.44.2.43.24.11.11.3a" lspace="0.167em" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁡</mo><mi id="Sx2.E7.m1.2.2.2.2.2.2" xref="Sx2.E7.m1.2.2.2.2.2.2.cmml">p</mi></mrow><mo id="Sx2.E7.m1.44.44.2.43.24.11.11.2" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁢</mo><mrow id="Sx2.E7.m1.44.44.2.43.24.11.11.1.1"><mo id="Sx2.E7.m1.3.3.3.3.3.3" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">(</mo><mrow id="Sx2.E7.m1.44.44.2.43.24.11.11.1.1.1"><mi id="Sx2.E7.m1.4.4.4.4.4.4" xref="Sx2.E7.m1.4.4.4.4.4.4.cmml">x</mi><mo fence="false" id="Sx2.E7.m1.5.5.5.5.5.5" xref="Sx2.E7.m1.5.5.5.5.5.5.cmml">|</mo><mrow id="Sx2.E7.m1.44.44.2.43.24.11.11.1.1.1.1"><mi id="Sx2.E7.m1.6.6.6.6.6.6" xref="Sx2.E7.m1.6.6.6.6.6.6.cmml">α</mi><mo id="Sx2.E7.m1.7.7.7.7.7.7" xref="Sx2.E7.m1.43.43.1.1.1.cmml">,</mo><mi id="Sx2.E7.m1.8.8.8.8.8.8" xref="Sx2.E7.m1.8.8.8.8.8.8.cmml">ζ</mi></mrow></mrow><mo id="Sx2.E7.m1.9.9.9.9.9.9" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E7.m1.10.10.10.10.10.10" xref="Sx2.E7.m1.10.10.10.10.10.10.cmml">=</mo><mi id="Sx2.E7.m1.44.44.2.43.24.11.12" xref="Sx2.E7.m1.43.43.1.1.1.cmml"></mi></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E7.m1.46.46.4c"><mrow id="Sx2.E7.m1.45.45.3.44.25.14"><mrow id="Sx2.E7.m1.45.45.3.44.25.14.14"><mrow id="Sx2.E7.m1.45.45.3.44.25.14.14.3"><mi id="Sx2.E7.m1.11.11.11.11.1.1" xref="Sx2.E7.m1.11.11.11.11.1.1.cmml">log</mi><mo id="Sx2.E7.m1.45.45.3.44.25.14.14.3a" lspace="0.167em" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁡</mo><mi id="Sx2.E7.m1.12.12.12.12.2.2" mathvariant="normal" xref="Sx2.E7.m1.12.12.12.12.2.2.cmml">Γ</mi></mrow><mo id="Sx2.E7.m1.45.45.3.44.25.14.14.2" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁢</mo><mrow id="Sx2.E7.m1.45.45.3.44.25.14.14.1.1"><mo id="Sx2.E7.m1.13.13.13.13.3.3" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">(</mo><mrow id="Sx2.E7.m1.45.45.3.44.25.14.14.1.1.1"><mi id="Sx2.E7.m1.14.14.14.14.4.4" xref="Sx2.E7.m1.14.14.14.14.4.4.cmml">x</mi><mo id="Sx2.E7.m1.15.15.15.15.5.5" xref="Sx2.E7.m1.15.15.15.15.5.5.cmml">+</mo><mi id="Sx2.E7.m1.16.16.16.16.6.6" xref="Sx2.E7.m1.16.16.16.16.6.6.cmml">α</mi></mrow><mo id="Sx2.E7.m1.17.17.17.17.7.7" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E7.m1.18.18.18.18.8.8" xref="Sx2.E7.m1.18.18.18.18.8.8.cmml">−</mo><mrow id="Sx2.E7.m1.45.45.3.44.25.14.15"><mrow id="Sx2.E7.m1.45.45.3.44.25.14.15.2"><mi id="Sx2.E7.m1.19.19.19.19.9.9" xref="Sx2.E7.m1.19.19.19.19.9.9.cmml">log</mi><mo id="Sx2.E7.m1.45.45.3.44.25.14.15.2a" lspace="0.167em" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁡</mo><mi id="Sx2.E7.m1.20.20.20.20.10.10" mathvariant="normal" xref="Sx2.E7.m1.20.20.20.20.10.10.cmml">Γ</mi></mrow><mo id="Sx2.E7.m1.45.45.3.44.25.14.15.1" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁢</mo><mrow id="Sx2.E7.m1.45.45.3.44.25.14.15.3"><mo id="Sx2.E7.m1.21.21.21.21.11.11" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">(</mo><mi id="Sx2.E7.m1.22.22.22.22.12.12" xref="Sx2.E7.m1.22.22.22.22.12.12.cmml">α</mi><mo id="Sx2.E7.m1.23.23.23.23.13.13" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx2.E7.m1.46.46.4d"><mtd id="Sx2.E7.m1.46.46.4e" xref="Sx2.E7.m1.43.43.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E7.m1.46.46.4f"><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20"><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1"><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.2"><mo id="Sx2.E7.m1.46.46.4.45.20.20.20.1.2a" xref="Sx2.E7.m1.43.43.1.1.1.cmml">+</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.2.1"><mi id="Sx2.E7.m1.25.25.25.2.2.2" xref="Sx2.E7.m1.25.25.25.2.2.2.cmml">α</mi><mo id="Sx2.E7.m1.46.46.4.45.20.20.20.1.2.1.1" lspace="0.167em" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁢</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.2.1.2"><mi id="Sx2.E7.m1.26.26.26.3.3.3" xref="Sx2.E7.m1.26.26.26.3.3.3.cmml">log</mi><mo id="Sx2.E7.m1.46.46.4.45.20.20.20.1.2.1.2a" lspace="0.167em" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁡</mo><mi id="Sx2.E7.m1.27.27.27.4.4.4" xref="Sx2.E7.m1.27.27.27.4.4.4.cmml">σ</mi></mrow><mo id="Sx2.E7.m1.46.46.4.45.20.20.20.1.2.1.1a" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁢</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.2.1.3"><mo id="Sx2.E7.m1.28.28.28.5.5.5" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">(</mo><mi id="Sx2.E7.m1.29.29.29.6.6.6" xref="Sx2.E7.m1.29.29.29.6.6.6.cmml">ζ</mi><mo id="Sx2.E7.m1.30.30.30.7.7.7" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.E7.m1.31.31.31.8.8.8" xref="Sx2.E7.m1.43.43.1.1.1.cmml">+</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1"><mi id="Sx2.E7.m1.32.32.32.9.9.9" xref="Sx2.E7.m1.32.32.32.9.9.9.cmml">x</mi><mo id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1.2" lspace="0.167em" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁢</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1.1.1"><mi id="Sx2.E7.m1.33.33.33.10.10.10" xref="Sx2.E7.m1.33.33.33.10.10.10.cmml">log</mi><mo id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1.1.1a" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁡</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1.1.1.1"><mo id="Sx2.E7.m1.34.34.34.11.11.11" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">(</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1.1.1.1.1"><mn id="Sx2.E7.m1.35.35.35.12.12.12" xref="Sx2.E7.m1.35.35.35.12.12.12.cmml">1</mn><mo id="Sx2.E7.m1.36.36.36.13.13.13" xref="Sx2.E7.m1.36.36.36.13.13.13.cmml">−</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1.1.1.1.1.1"><mi id="Sx2.E7.m1.37.37.37.14.14.14" xref="Sx2.E7.m1.37.37.37.14.14.14.cmml">σ</mi><mo id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1.1.1.1.1.1.1" xref="Sx2.E7.m1.43.43.1.1.1.cmml">⁢</mo><mrow id="Sx2.E7.m1.46.46.4.45.20.20.20.1.1.1.1.1.1.1.2"><mo id="Sx2.E7.m1.38.38.38.15.15.15" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">(</mo><mi id="Sx2.E7.m1.39.39.39.16.16.16" xref="Sx2.E7.m1.39.39.39.16.16.16.cmml">ζ</mi><mo id="Sx2.E7.m1.40.40.40.17.17.17" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.E7.m1.41.41.41.18.18.18" stretchy="false" xref="Sx2.E7.m1.43.43.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.E7.m1.42.42.42.19.19.19" lspace="0em" xref="Sx2.E7.m1.43.43.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx2.E7.m1.46b"><apply id="Sx2.E7.m1.43.43.1.1.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><eq id="Sx2.E7.m1.10.10.10.10.10.10.cmml" xref="Sx2.E7.m1.10.10.10.10.10.10"></eq><apply id="Sx2.E7.m1.43.43.1.1.1.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><times id="Sx2.E7.m1.43.43.1.1.1.1.2.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"></times><apply id="Sx2.E7.m1.43.43.1.1.1.1.3.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><log id="Sx2.E7.m1.1.1.1.1.1.1.cmml" xref="Sx2.E7.m1.1.1.1.1.1.1"></log><ci id="Sx2.E7.m1.2.2.2.2.2.2.cmml" xref="Sx2.E7.m1.2.2.2.2.2.2">𝑝</ci></apply><apply id="Sx2.E7.m1.43.43.1.1.1.1.1.1.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><csymbol cd="latexml" id="Sx2.E7.m1.5.5.5.5.5.5.cmml" xref="Sx2.E7.m1.5.5.5.5.5.5">conditional</csymbol><ci id="Sx2.E7.m1.4.4.4.4.4.4.cmml" xref="Sx2.E7.m1.4.4.4.4.4.4">𝑥</ci><list id="Sx2.E7.m1.43.43.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><ci id="Sx2.E7.m1.6.6.6.6.6.6.cmml" xref="Sx2.E7.m1.6.6.6.6.6.6">𝛼</ci><ci id="Sx2.E7.m1.8.8.8.8.8.8.cmml" xref="Sx2.E7.m1.8.8.8.8.8.8">𝜁</ci></list></apply></apply><apply id="Sx2.E7.m1.43.43.1.1.1.3.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><plus id="Sx2.E7.m1.24.24.24.1.1.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"></plus><apply id="Sx2.E7.m1.43.43.1.1.1.2.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><minus id="Sx2.E7.m1.18.18.18.18.8.8.cmml" xref="Sx2.E7.m1.18.18.18.18.8.8"></minus><apply id="Sx2.E7.m1.43.43.1.1.1.2.1.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><times id="Sx2.E7.m1.43.43.1.1.1.2.1.1.2.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"></times><apply id="Sx2.E7.m1.43.43.1.1.1.2.1.1.3.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><log id="Sx2.E7.m1.11.11.11.11.1.1.cmml" xref="Sx2.E7.m1.11.11.11.11.1.1"></log><ci id="Sx2.E7.m1.12.12.12.12.2.2.cmml" xref="Sx2.E7.m1.12.12.12.12.2.2">Γ</ci></apply><apply id="Sx2.E7.m1.43.43.1.1.1.2.1.1.1.1.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><plus id="Sx2.E7.m1.15.15.15.15.5.5.cmml" xref="Sx2.E7.m1.15.15.15.15.5.5"></plus><ci id="Sx2.E7.m1.14.14.14.14.4.4.cmml" xref="Sx2.E7.m1.14.14.14.14.4.4">𝑥</ci><ci id="Sx2.E7.m1.16.16.16.16.6.6.cmml" xref="Sx2.E7.m1.16.16.16.16.6.6">𝛼</ci></apply></apply><apply id="Sx2.E7.m1.43.43.1.1.1.2.1.3.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><times id="Sx2.E7.m1.43.43.1.1.1.2.1.3.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"></times><apply id="Sx2.E7.m1.43.43.1.1.1.2.1.3.2.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><log id="Sx2.E7.m1.19.19.19.19.9.9.cmml" xref="Sx2.E7.m1.19.19.19.19.9.9"></log><ci id="Sx2.E7.m1.20.20.20.20.10.10.cmml" xref="Sx2.E7.m1.20.20.20.20.10.10">Γ</ci></apply><ci id="Sx2.E7.m1.22.22.22.22.12.12.cmml" xref="Sx2.E7.m1.22.22.22.22.12.12">𝛼</ci></apply></apply><apply id="Sx2.E7.m1.43.43.1.1.1.3.4.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><times id="Sx2.E7.m1.43.43.1.1.1.3.4.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"></times><ci id="Sx2.E7.m1.25.25.25.2.2.2.cmml" xref="Sx2.E7.m1.25.25.25.2.2.2">𝛼</ci><apply id="Sx2.E7.m1.43.43.1.1.1.3.4.3.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><log id="Sx2.E7.m1.26.26.26.3.3.3.cmml" xref="Sx2.E7.m1.26.26.26.3.3.3"></log><ci id="Sx2.E7.m1.27.27.27.4.4.4.cmml" xref="Sx2.E7.m1.27.27.27.4.4.4">𝜎</ci></apply><ci id="Sx2.E7.m1.29.29.29.6.6.6.cmml" xref="Sx2.E7.m1.29.29.29.6.6.6">𝜁</ci></apply><apply id="Sx2.E7.m1.43.43.1.1.1.3.2.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><times id="Sx2.E7.m1.43.43.1.1.1.3.2.2.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"></times><ci id="Sx2.E7.m1.32.32.32.9.9.9.cmml" xref="Sx2.E7.m1.32.32.32.9.9.9">𝑥</ci><apply id="Sx2.E7.m1.43.43.1.1.1.3.2.1.2.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><log id="Sx2.E7.m1.33.33.33.10.10.10.cmml" xref="Sx2.E7.m1.33.33.33.10.10.10"></log><apply id="Sx2.E7.m1.43.43.1.1.1.3.2.1.1.1.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><minus id="Sx2.E7.m1.36.36.36.13.13.13.cmml" xref="Sx2.E7.m1.36.36.36.13.13.13"></minus><cn id="Sx2.E7.m1.35.35.35.12.12.12.cmml" type="integer" xref="Sx2.E7.m1.35.35.35.12.12.12">1</cn><apply id="Sx2.E7.m1.43.43.1.1.1.3.2.1.1.1.1.3.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"><times id="Sx2.E7.m1.43.43.1.1.1.3.2.1.1.1.1.3.1.cmml" xref="Sx2.E7.m1.44.44.2.43.24.11.11.3a"></times><ci id="Sx2.E7.m1.37.37.37.14.14.14.cmml" xref="Sx2.E7.m1.37.37.37.14.14.14">𝜎</ci><ci id="Sx2.E7.m1.39.39.39.16.16.16.cmml" xref="Sx2.E7.m1.39.39.39.16.16.16">𝜁</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E7.m1.46c">\begin{split}\log p(x|\alpha,\zeta)=&amp;\log{\Gamma(x+\alpha)}-\log{\Gamma(\alpha%
)}\\
&amp;+\alpha\log{\sigma(\zeta)}+x\log{(1-\sigma(\zeta))}.\end{split}</annotation><annotation encoding="application/x-llamapun" id="Sx2.E7.m1.46d">start_ROW start_CELL roman_log italic_p ( italic_x | italic_α , italic_ζ ) = end_CELL start_CELL roman_log roman_Γ ( italic_x + italic_α ) - roman_log roman_Γ ( italic_α ) end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL + italic_α roman_log italic_σ ( italic_ζ ) + italic_x roman_log ( 1 - italic_σ ( italic_ζ ) ) . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="Sx2.SSx2.p4">
<p class="ltx_p" id="Sx2.SSx2.p4.6">In practice, gradients of the terms on the second row can be computed with numerical stability using a modification of the common Binary Cross Entropy (BCE) loss, while those of the first row are numerically stable for strictly positive values of <math alttext="\alpha" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.1.m1.1"><semantics id="Sx2.SSx2.p4.1.m1.1a"><mi id="Sx2.SSx2.p4.1.m1.1.1" xref="Sx2.SSx2.p4.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.1.m1.1b"><ci id="Sx2.SSx2.p4.1.m1.1.1.cmml" xref="Sx2.SSx2.p4.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.1.m1.1d">italic_α</annotation></semantics></math>. With this, we can use a neural network <math alttext="f_{\boldsymbol{\theta}}(\cdot)" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.2.m2.1"><semantics id="Sx2.SSx2.p4.2.m2.1a"><mrow id="Sx2.SSx2.p4.2.m2.1.2" xref="Sx2.SSx2.p4.2.m2.1.2.cmml"><msub id="Sx2.SSx2.p4.2.m2.1.2.2" xref="Sx2.SSx2.p4.2.m2.1.2.2.cmml"><mi id="Sx2.SSx2.p4.2.m2.1.2.2.2" xref="Sx2.SSx2.p4.2.m2.1.2.2.2.cmml">f</mi><mi id="Sx2.SSx2.p4.2.m2.1.2.2.3" xref="Sx2.SSx2.p4.2.m2.1.2.2.3.cmml">𝜽</mi></msub><mo id="Sx2.SSx2.p4.2.m2.1.2.1" xref="Sx2.SSx2.p4.2.m2.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx2.p4.2.m2.1.2.3.2" xref="Sx2.SSx2.p4.2.m2.1.2.cmml"><mo id="Sx2.SSx2.p4.2.m2.1.2.3.2.1" stretchy="false" xref="Sx2.SSx2.p4.2.m2.1.2.cmml">(</mo><mo id="Sx2.SSx2.p4.2.m2.1.1" lspace="0em" rspace="0em" xref="Sx2.SSx2.p4.2.m2.1.1.cmml">⋅</mo><mo id="Sx2.SSx2.p4.2.m2.1.2.3.2.2" stretchy="false" xref="Sx2.SSx2.p4.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.2.m2.1b"><apply id="Sx2.SSx2.p4.2.m2.1.2.cmml" xref="Sx2.SSx2.p4.2.m2.1.2"><times id="Sx2.SSx2.p4.2.m2.1.2.1.cmml" xref="Sx2.SSx2.p4.2.m2.1.2.1"></times><apply id="Sx2.SSx2.p4.2.m2.1.2.2.cmml" xref="Sx2.SSx2.p4.2.m2.1.2.2"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.2.m2.1.2.2.1.cmml" xref="Sx2.SSx2.p4.2.m2.1.2.2">subscript</csymbol><ci id="Sx2.SSx2.p4.2.m2.1.2.2.2.cmml" xref="Sx2.SSx2.p4.2.m2.1.2.2.2">𝑓</ci><ci id="Sx2.SSx2.p4.2.m2.1.2.2.3.cmml" xref="Sx2.SSx2.p4.2.m2.1.2.2.3">𝜽</ci></apply><ci id="Sx2.SSx2.p4.2.m2.1.1.cmml" xref="Sx2.SSx2.p4.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.2.m2.1c">f_{\boldsymbol{\theta}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.2.m2.1d">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math> to take input contextual features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.3.m3.1"><semantics id="Sx2.SSx2.p4.3.m3.1a"><mi id="Sx2.SSx2.p4.3.m3.1.1" xref="Sx2.SSx2.p4.3.m3.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.3.m3.1b"><ci id="Sx2.SSx2.p4.3.m3.1.1.cmml" xref="Sx2.SSx2.p4.3.m3.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.3.m3.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.3.m3.1d">bold_italic_z</annotation></semantics></math> and output parameters <math alttext="\boldsymbol{\alpha}" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.4.m4.1"><semantics id="Sx2.SSx2.p4.4.m4.1a"><mi id="Sx2.SSx2.p4.4.m4.1.1" xref="Sx2.SSx2.p4.4.m4.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.4.m4.1b"><ci id="Sx2.SSx2.p4.4.m4.1.1.cmml" xref="Sx2.SSx2.p4.4.m4.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.4.m4.1c">\boldsymbol{\alpha}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.4.m4.1d">bold_italic_α</annotation></semantics></math> and <math alttext="\boldsymbol{\zeta}" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.5.m5.1"><semantics id="Sx2.SSx2.p4.5.m5.1a"><mi id="Sx2.SSx2.p4.5.m5.1.1" xref="Sx2.SSx2.p4.5.m5.1.1.cmml">𝜻</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.5.m5.1b"><ci id="Sx2.SSx2.p4.5.m5.1.1.cmml" xref="Sx2.SSx2.p4.5.m5.1.1">𝜻</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.5.m5.1c">\boldsymbol{\zeta}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.5.m5.1d">bold_italic_ζ</annotation></semantics></math> for the prior distribution which optimize the log-likelihood defined above for all items <math alttext="d" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.6.m6.1"><semantics id="Sx2.SSx2.p4.6.m6.1a"><mi id="Sx2.SSx2.p4.6.m6.1.1" xref="Sx2.SSx2.p4.6.m6.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.6.m6.1b"><ci id="Sx2.SSx2.p4.6.m6.1.1.cmml" xref="Sx2.SSx2.p4.6.m6.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.6.m6.1c">d</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.6.m6.1d">italic_d</annotation></semantics></math>. Reintroducing subscripts, the full negative log-likelihood loss can be written as</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}(\boldsymbol{\theta})&amp;=\mathbb{E}_{(\boldsymbol{x},%
\boldsymbol{z})\sim D}[-\log p(\boldsymbol{x}|\boldsymbol{\phi})]\\
&amp;=-\sum_{d=1}^{|D|}{\sum_{i=1}^{L}{\log p(x_{i}^{d}|\alpha_{\boldsymbol{\theta%
}}(\boldsymbol{z}^{d}_{i}),\zeta_{\boldsymbol{\theta}}(\boldsymbol{z}^{d}_{i})%
)}},\end{split}" class="ltx_Math" display="block" id="Sx2.E8.m1.52"><semantics id="Sx2.E8.m1.52a"><mtable columnspacing="0pt" displaystyle="true" id="Sx2.E8.m1.52.52.3" rowspacing="0pt"><mtr id="Sx2.E8.m1.52.52.3a"><mtd class="ltx_align_right" columnalign="right" id="Sx2.E8.m1.52.52.3b"><mrow id="Sx2.E8.m1.4.4.4.4.4"><mi class="ltx_font_mathcaligraphic" id="Sx2.E8.m1.1.1.1.1.1.1" xref="Sx2.E8.m1.1.1.1.1.1.1.cmml">ℒ</mi><mo id="Sx2.E8.m1.4.4.4.4.4.5" xref="Sx2.E8.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E8.m1.4.4.4.4.4.6"><mo id="Sx2.E8.m1.2.2.2.2.2.2" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">(</mo><mi id="Sx2.E8.m1.3.3.3.3.3.3" xref="Sx2.E8.m1.3.3.3.3.3.3.cmml">𝜽</mi><mo id="Sx2.E8.m1.4.4.4.4.4.4" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E8.m1.52.52.3c"><mrow id="Sx2.E8.m1.51.51.2.50.18.14"><mi id="Sx2.E8.m1.51.51.2.50.18.14.15" xref="Sx2.E8.m1.50.50.1.1.1.cmml"></mi><mo id="Sx2.E8.m1.5.5.5.5.1.1" xref="Sx2.E8.m1.5.5.5.5.1.1.cmml">=</mo><mrow id="Sx2.E8.m1.51.51.2.50.18.14.14"><msub id="Sx2.E8.m1.51.51.2.50.18.14.14.3"><mi id="Sx2.E8.m1.6.6.6.6.2.2" xref="Sx2.E8.m1.6.6.6.6.2.2.cmml">𝔼</mi><mrow id="Sx2.E8.m1.7.7.7.7.3.3.1" xref="Sx2.E8.m1.7.7.7.7.3.3.1.cmml"><mrow id="Sx2.E8.m1.7.7.7.7.3.3.1.4.2" xref="Sx2.E8.m1.7.7.7.7.3.3.1.4.1.cmml"><mo id="Sx2.E8.m1.7.7.7.7.3.3.1.4.2.1" stretchy="false" xref="Sx2.E8.m1.7.7.7.7.3.3.1.4.1.cmml">(</mo><mi id="Sx2.E8.m1.7.7.7.7.3.3.1.1" xref="Sx2.E8.m1.7.7.7.7.3.3.1.1.cmml">𝒙</mi><mo id="Sx2.E8.m1.7.7.7.7.3.3.1.4.2.2" xref="Sx2.E8.m1.7.7.7.7.3.3.1.4.1.cmml">,</mo><mi id="Sx2.E8.m1.7.7.7.7.3.3.1.2" xref="Sx2.E8.m1.7.7.7.7.3.3.1.2.cmml">𝒛</mi><mo id="Sx2.E8.m1.7.7.7.7.3.3.1.4.2.3" stretchy="false" xref="Sx2.E8.m1.7.7.7.7.3.3.1.4.1.cmml">)</mo></mrow><mo id="Sx2.E8.m1.7.7.7.7.3.3.1.3" xref="Sx2.E8.m1.7.7.7.7.3.3.1.3.cmml">∼</mo><mi id="Sx2.E8.m1.7.7.7.7.3.3.1.5" xref="Sx2.E8.m1.7.7.7.7.3.3.1.5.cmml">D</mi></mrow></msub><mo id="Sx2.E8.m1.51.51.2.50.18.14.14.2" xref="Sx2.E8.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1"><mo id="Sx2.E8.m1.8.8.8.8.4.4" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">[</mo><mrow id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1.1"><mo id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1.1a" rspace="0.167em" xref="Sx2.E8.m1.50.50.1.1.1.cmml">−</mo><mrow id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1.1.1"><mrow id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1.1.1.3"><mi id="Sx2.E8.m1.10.10.10.10.6.6" xref="Sx2.E8.m1.10.10.10.10.6.6.cmml">log</mi><mo id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1.1.1.3a" lspace="0.167em" xref="Sx2.E8.m1.50.50.1.1.1.cmml">⁡</mo><mi id="Sx2.E8.m1.11.11.11.11.7.7" xref="Sx2.E8.m1.11.11.11.11.7.7.cmml">p</mi></mrow><mo id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1.1.1.2" xref="Sx2.E8.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1.1.1.1.1"><mo id="Sx2.E8.m1.12.12.12.12.8.8" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">(</mo><mrow id="Sx2.E8.m1.51.51.2.50.18.14.14.1.1.1.1.1.1.1"><mi id="Sx2.E8.m1.13.13.13.13.9.9" xref="Sx2.E8.m1.13.13.13.13.9.9.cmml">𝒙</mi><mo fence="false" id="Sx2.E8.m1.14.14.14.14.10.10" xref="Sx2.E8.m1.14.14.14.14.10.10.cmml">|</mo><mi class="ltx_mathvariant_bold-italic" id="Sx2.E8.m1.15.15.15.15.11.11" mathvariant="bold-italic" xref="Sx2.E8.m1.15.15.15.15.11.11.cmml">ϕ</mi></mrow><mo id="Sx2.E8.m1.16.16.16.16.12.12" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.E8.m1.17.17.17.17.13.13" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">]</mo></mrow></mrow></mrow></mtd></mtr><mtr id="Sx2.E8.m1.52.52.3d"><mtd id="Sx2.E8.m1.52.52.3e" xref="Sx2.E8.m1.50.50.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E8.m1.52.52.3f"><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33"><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1"><mi id="Sx2.E8.m1.52.52.3.51.33.33.33.1.2" xref="Sx2.E8.m1.50.50.1.1.1.cmml"></mi><mo id="Sx2.E8.m1.18.18.18.1.1.1" xref="Sx2.E8.m1.18.18.18.1.1.1.cmml">=</mo><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1"><mo id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1a" xref="Sx2.E8.m1.50.50.1.1.1.cmml">−</mo><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1"><munderover id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.2"><mo id="Sx2.E8.m1.20.20.20.3.3.3" movablelimits="false" rspace="0em" xref="Sx2.E8.m1.20.20.20.3.3.3.cmml">∑</mo><mrow id="Sx2.E8.m1.21.21.21.4.4.4.1" xref="Sx2.E8.m1.21.21.21.4.4.4.1.cmml"><mi id="Sx2.E8.m1.21.21.21.4.4.4.1.2" xref="Sx2.E8.m1.21.21.21.4.4.4.1.2.cmml">d</mi><mo id="Sx2.E8.m1.21.21.21.4.4.4.1.1" xref="Sx2.E8.m1.21.21.21.4.4.4.1.1.cmml">=</mo><mn id="Sx2.E8.m1.21.21.21.4.4.4.1.3" xref="Sx2.E8.m1.21.21.21.4.4.4.1.3.cmml">1</mn></mrow><mrow id="Sx2.E8.m1.22.22.22.5.5.5.1.3" xref="Sx2.E8.m1.22.22.22.5.5.5.1.2.cmml"><mo id="Sx2.E8.m1.22.22.22.5.5.5.1.3.1" stretchy="false" xref="Sx2.E8.m1.22.22.22.5.5.5.1.2.1.cmml">|</mo><mi id="Sx2.E8.m1.22.22.22.5.5.5.1.1" xref="Sx2.E8.m1.22.22.22.5.5.5.1.1.cmml">D</mi><mo id="Sx2.E8.m1.22.22.22.5.5.5.1.3.2" stretchy="false" xref="Sx2.E8.m1.22.22.22.5.5.5.1.2.1.cmml">|</mo></mrow></munderover><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1"><munderover id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.2"><mo id="Sx2.E8.m1.23.23.23.6.6.6" movablelimits="false" xref="Sx2.E8.m1.23.23.23.6.6.6.cmml">∑</mo><mrow id="Sx2.E8.m1.24.24.24.7.7.7.1" xref="Sx2.E8.m1.24.24.24.7.7.7.1.cmml"><mi id="Sx2.E8.m1.24.24.24.7.7.7.1.2" xref="Sx2.E8.m1.24.24.24.7.7.7.1.2.cmml">i</mi><mo id="Sx2.E8.m1.24.24.24.7.7.7.1.1" xref="Sx2.E8.m1.24.24.24.7.7.7.1.1.cmml">=</mo><mn id="Sx2.E8.m1.24.24.24.7.7.7.1.3" xref="Sx2.E8.m1.24.24.24.7.7.7.1.3.cmml">1</mn></mrow><mi id="Sx2.E8.m1.25.25.25.8.8.8.1" xref="Sx2.E8.m1.25.25.25.8.8.8.1.cmml">L</mi></munderover><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1"><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.3"><mi id="Sx2.E8.m1.26.26.26.9.9.9" xref="Sx2.E8.m1.26.26.26.9.9.9.cmml">log</mi><mo id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.3a" lspace="0.167em" xref="Sx2.E8.m1.50.50.1.1.1.cmml">⁡</mo><mi id="Sx2.E8.m1.27.27.27.10.10.10" xref="Sx2.E8.m1.27.27.27.10.10.10.cmml">p</mi></mrow><mo id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.2" xref="Sx2.E8.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1"><mo id="Sx2.E8.m1.28.28.28.11.11.11" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">(</mo><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1"><msubsup id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.3"><mi id="Sx2.E8.m1.29.29.29.12.12.12" xref="Sx2.E8.m1.29.29.29.12.12.12.cmml">x</mi><mi id="Sx2.E8.m1.30.30.30.13.13.13.1" xref="Sx2.E8.m1.30.30.30.13.13.13.1.cmml">i</mi><mi id="Sx2.E8.m1.31.31.31.14.14.14.1" xref="Sx2.E8.m1.31.31.31.14.14.14.1.cmml">d</mi></msubsup><mo fence="false" id="Sx2.E8.m1.32.32.32.15.15.15" xref="Sx2.E8.m1.32.32.32.15.15.15.cmml">|</mo><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.2.2"><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.1.1.1"><msub id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.1.1.1.3"><mi id="Sx2.E8.m1.33.33.33.16.16.16" xref="Sx2.E8.m1.33.33.33.16.16.16.cmml">α</mi><mi id="Sx2.E8.m1.34.34.34.17.17.17.1" xref="Sx2.E8.m1.34.34.34.17.17.17.1.cmml">𝜽</mi></msub><mo id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E8.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.1"><mo id="Sx2.E8.m1.35.35.35.18.18.18" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">(</mo><msubsup id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="Sx2.E8.m1.36.36.36.19.19.19" xref="Sx2.E8.m1.36.36.36.19.19.19.cmml">𝒛</mi><mi id="Sx2.E8.m1.38.38.38.21.21.21.1" xref="Sx2.E8.m1.38.38.38.21.21.21.1.cmml">i</mi><mi id="Sx2.E8.m1.37.37.37.20.20.20.1" xref="Sx2.E8.m1.37.37.37.20.20.20.1.cmml">d</mi></msubsup><mo id="Sx2.E8.m1.39.39.39.22.22.22" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E8.m1.40.40.40.23.23.23" xref="Sx2.E8.m1.50.50.1.1.1.cmml">,</mo><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.2.2.2"><msub id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.2.2.2.3"><mi id="Sx2.E8.m1.41.41.41.24.24.24" xref="Sx2.E8.m1.41.41.41.24.24.24.cmml">ζ</mi><mi id="Sx2.E8.m1.42.42.42.25.25.25.1" xref="Sx2.E8.m1.42.42.42.25.25.25.1.cmml">𝜽</mi></msub><mo id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.2.2.2.2" xref="Sx2.E8.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.2.2.2.1.1"><mo id="Sx2.E8.m1.43.43.43.26.26.26" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">(</mo><msubsup id="Sx2.E8.m1.52.52.3.51.33.33.33.1.1.1.1.1.1.1.1.2.2.2.1.1.1"><mi id="Sx2.E8.m1.44.44.44.27.27.27" xref="Sx2.E8.m1.44.44.44.27.27.27.cmml">𝒛</mi><mi id="Sx2.E8.m1.46.46.46.29.29.29.1" xref="Sx2.E8.m1.46.46.46.29.29.29.1.cmml">i</mi><mi id="Sx2.E8.m1.45.45.45.28.28.28.1" xref="Sx2.E8.m1.45.45.45.28.28.28.1.cmml">d</mi></msubsup><mo id="Sx2.E8.m1.47.47.47.30.30.30" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.E8.m1.48.48.48.31.31.31" stretchy="false" xref="Sx2.E8.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="Sx2.E8.m1.49.49.49.32.32.32" xref="Sx2.E8.m1.50.50.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx2.E8.m1.52b"><apply id="Sx2.E8.m1.50.50.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><and id="Sx2.E8.m1.50.50.1.1.1a.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></and><apply id="Sx2.E8.m1.50.50.1.1.1b.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><eq id="Sx2.E8.m1.5.5.5.5.1.1.cmml" xref="Sx2.E8.m1.5.5.5.5.1.1"></eq><apply id="Sx2.E8.m1.50.50.1.1.1.4.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><times id="Sx2.E8.m1.50.50.1.1.1.4.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></times><ci id="Sx2.E8.m1.1.1.1.1.1.1.cmml" xref="Sx2.E8.m1.1.1.1.1.1.1">ℒ</ci><ci id="Sx2.E8.m1.3.3.3.3.3.3.cmml" xref="Sx2.E8.m1.3.3.3.3.3.3">𝜽</ci></apply><apply id="Sx2.E8.m1.50.50.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><times id="Sx2.E8.m1.50.50.1.1.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></times><apply id="Sx2.E8.m1.50.50.1.1.1.1.3.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.1.3.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">subscript</csymbol><ci id="Sx2.E8.m1.6.6.6.6.2.2.cmml" xref="Sx2.E8.m1.6.6.6.6.2.2">𝔼</ci><apply id="Sx2.E8.m1.7.7.7.7.3.3.1.cmml" xref="Sx2.E8.m1.7.7.7.7.3.3.1"><csymbol cd="latexml" id="Sx2.E8.m1.7.7.7.7.3.3.1.3.cmml" xref="Sx2.E8.m1.7.7.7.7.3.3.1.3">similar-to</csymbol><interval closure="open" id="Sx2.E8.m1.7.7.7.7.3.3.1.4.1.cmml" xref="Sx2.E8.m1.7.7.7.7.3.3.1.4.2"><ci id="Sx2.E8.m1.7.7.7.7.3.3.1.1.cmml" xref="Sx2.E8.m1.7.7.7.7.3.3.1.1">𝒙</ci><ci id="Sx2.E8.m1.7.7.7.7.3.3.1.2.cmml" xref="Sx2.E8.m1.7.7.7.7.3.3.1.2">𝒛</ci></interval><ci id="Sx2.E8.m1.7.7.7.7.3.3.1.5.cmml" xref="Sx2.E8.m1.7.7.7.7.3.3.1.5">𝐷</ci></apply></apply><apply id="Sx2.E8.m1.50.50.1.1.1.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="latexml" id="Sx2.E8.m1.50.50.1.1.1.1.1.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">delimited-[]</csymbol><apply id="Sx2.E8.m1.50.50.1.1.1.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><minus id="Sx2.E8.m1.9.9.9.9.5.5.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></minus><apply id="Sx2.E8.m1.50.50.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><times id="Sx2.E8.m1.50.50.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></times><apply id="Sx2.E8.m1.50.50.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><log id="Sx2.E8.m1.10.10.10.10.6.6.cmml" xref="Sx2.E8.m1.10.10.10.10.6.6"></log><ci id="Sx2.E8.m1.11.11.11.11.7.7.cmml" xref="Sx2.E8.m1.11.11.11.11.7.7">𝑝</ci></apply><apply id="Sx2.E8.m1.50.50.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="latexml" id="Sx2.E8.m1.14.14.14.14.10.10.cmml" xref="Sx2.E8.m1.14.14.14.14.10.10">conditional</csymbol><ci id="Sx2.E8.m1.13.13.13.13.9.9.cmml" xref="Sx2.E8.m1.13.13.13.13.9.9">𝒙</ci><ci id="Sx2.E8.m1.15.15.15.15.11.11.cmml" xref="Sx2.E8.m1.15.15.15.15.11.11">bold-italic-ϕ</ci></apply></apply></apply></apply></apply></apply><apply id="Sx2.E8.m1.50.50.1.1.1c.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><eq id="Sx2.E8.m1.18.18.18.1.1.1.cmml" xref="Sx2.E8.m1.18.18.18.1.1.1"></eq><share href="https://arxiv.org/html/2410.02126v1#Sx2.E8.m1.50.50.1.1.1.1.cmml" id="Sx2.E8.m1.50.50.1.1.1d.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></share><apply id="Sx2.E8.m1.50.50.1.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><minus id="Sx2.E8.m1.19.19.19.2.2.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></minus><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">superscript</csymbol><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.2.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.2.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">subscript</csymbol><sum id="Sx2.E8.m1.20.20.20.3.3.3.cmml" xref="Sx2.E8.m1.20.20.20.3.3.3"></sum><apply id="Sx2.E8.m1.21.21.21.4.4.4.1.cmml" xref="Sx2.E8.m1.21.21.21.4.4.4.1"><eq id="Sx2.E8.m1.21.21.21.4.4.4.1.1.cmml" xref="Sx2.E8.m1.21.21.21.4.4.4.1.1"></eq><ci id="Sx2.E8.m1.21.21.21.4.4.4.1.2.cmml" xref="Sx2.E8.m1.21.21.21.4.4.4.1.2">𝑑</ci><cn id="Sx2.E8.m1.21.21.21.4.4.4.1.3.cmml" type="integer" xref="Sx2.E8.m1.21.21.21.4.4.4.1.3">1</cn></apply></apply><apply id="Sx2.E8.m1.22.22.22.5.5.5.1.2.cmml" xref="Sx2.E8.m1.22.22.22.5.5.5.1.3"><abs id="Sx2.E8.m1.22.22.22.5.5.5.1.2.1.cmml" xref="Sx2.E8.m1.22.22.22.5.5.5.1.3.1"></abs><ci id="Sx2.E8.m1.22.22.22.5.5.5.1.1.cmml" xref="Sx2.E8.m1.22.22.22.5.5.5.1.1">𝐷</ci></apply></apply><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">superscript</csymbol><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.2.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.2.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">subscript</csymbol><sum id="Sx2.E8.m1.23.23.23.6.6.6.cmml" xref="Sx2.E8.m1.23.23.23.6.6.6"></sum><apply id="Sx2.E8.m1.24.24.24.7.7.7.1.cmml" xref="Sx2.E8.m1.24.24.24.7.7.7.1"><eq id="Sx2.E8.m1.24.24.24.7.7.7.1.1.cmml" xref="Sx2.E8.m1.24.24.24.7.7.7.1.1"></eq><ci id="Sx2.E8.m1.24.24.24.7.7.7.1.2.cmml" xref="Sx2.E8.m1.24.24.24.7.7.7.1.2">𝑖</ci><cn id="Sx2.E8.m1.24.24.24.7.7.7.1.3.cmml" type="integer" xref="Sx2.E8.m1.24.24.24.7.7.7.1.3">1</cn></apply></apply><ci id="Sx2.E8.m1.25.25.25.8.8.8.1.cmml" xref="Sx2.E8.m1.25.25.25.8.8.8.1">𝐿</ci></apply><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><times id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></times><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.3.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><log id="Sx2.E8.m1.26.26.26.9.9.9.cmml" xref="Sx2.E8.m1.26.26.26.9.9.9"></log><ci id="Sx2.E8.m1.27.27.27.10.10.10.cmml" xref="Sx2.E8.m1.27.27.27.10.10.10">𝑝</ci></apply><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="latexml" id="Sx2.E8.m1.32.32.32.15.15.15.cmml" xref="Sx2.E8.m1.32.32.32.15.15.15">conditional</csymbol><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.4.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.4.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">superscript</csymbol><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.4.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.4.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">subscript</csymbol><ci id="Sx2.E8.m1.29.29.29.12.12.12.cmml" xref="Sx2.E8.m1.29.29.29.12.12.12">𝑥</ci><ci id="Sx2.E8.m1.30.30.30.13.13.13.1.cmml" xref="Sx2.E8.m1.30.30.30.13.13.13.1">𝑖</ci></apply><ci id="Sx2.E8.m1.31.31.31.14.14.14.1.cmml" xref="Sx2.E8.m1.31.31.31.14.14.14.1">𝑑</ci></apply><list id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><times id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></times><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">subscript</csymbol><ci id="Sx2.E8.m1.33.33.33.16.16.16.cmml" xref="Sx2.E8.m1.33.33.33.16.16.16">𝛼</ci><ci id="Sx2.E8.m1.34.34.34.17.17.17.1.cmml" xref="Sx2.E8.m1.34.34.34.17.17.17.1">𝜽</ci></apply><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">subscript</csymbol><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">superscript</csymbol><ci id="Sx2.E8.m1.36.36.36.19.19.19.cmml" xref="Sx2.E8.m1.36.36.36.19.19.19">𝒛</ci><ci id="Sx2.E8.m1.37.37.37.20.20.20.1.cmml" xref="Sx2.E8.m1.37.37.37.20.20.20.1">𝑑</ci></apply><ci id="Sx2.E8.m1.38.38.38.21.21.21.1.cmml" xref="Sx2.E8.m1.38.38.38.21.21.21.1">𝑖</ci></apply></apply><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><times id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"></times><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">subscript</csymbol><ci id="Sx2.E8.m1.41.41.41.24.24.24.cmml" xref="Sx2.E8.m1.41.41.41.24.24.24">𝜁</ci><ci id="Sx2.E8.m1.42.42.42.25.25.25.1.cmml" xref="Sx2.E8.m1.42.42.42.25.25.25.1">𝜽</ci></apply><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">subscript</csymbol><apply id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5"><csymbol cd="ambiguous" id="Sx2.E8.m1.50.50.1.1.1.2.1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="Sx2.E8.m1.4.4.4.4.4.5">superscript</csymbol><ci id="Sx2.E8.m1.44.44.44.27.27.27.cmml" xref="Sx2.E8.m1.44.44.44.27.27.27">𝒛</ci><ci id="Sx2.E8.m1.45.45.45.28.28.28.1.cmml" xref="Sx2.E8.m1.45.45.45.28.28.28.1">𝑑</ci></apply><ci id="Sx2.E8.m1.46.46.46.29.29.29.1.cmml" xref="Sx2.E8.m1.46.46.46.29.29.29.1">𝑖</ci></apply></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E8.m1.52c">\begin{split}\mathcal{L}(\boldsymbol{\theta})&amp;=\mathbb{E}_{(\boldsymbol{x},%
\boldsymbol{z})\sim D}[-\log p(\boldsymbol{x}|\boldsymbol{\phi})]\\
&amp;=-\sum_{d=1}^{|D|}{\sum_{i=1}^{L}{\log p(x_{i}^{d}|\alpha_{\boldsymbol{\theta%
}}(\boldsymbol{z}^{d}_{i}),\zeta_{\boldsymbol{\theta}}(\boldsymbol{z}^{d}_{i})%
)}},\end{split}</annotation><annotation encoding="application/x-llamapun" id="Sx2.E8.m1.52d">start_ROW start_CELL caligraphic_L ( bold_italic_θ ) end_CELL start_CELL = blackboard_E start_POSTSUBSCRIPT ( bold_italic_x , bold_italic_z ) ∼ italic_D end_POSTSUBSCRIPT [ - roman_log italic_p ( bold_italic_x | bold_italic_ϕ ) ] end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL = - ∑ start_POSTSUBSCRIPT italic_d = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_D | end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT roman_log italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_α start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ζ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx2.p4.9">where <math alttext="\log p(x_{i}^{d}|\alpha_{\boldsymbol{\theta}}(\boldsymbol{z}^{d}_{i}),\zeta_{%
\boldsymbol{\theta}}(\boldsymbol{z}^{d}_{i}))" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.7.m1.1"><semantics id="Sx2.SSx2.p4.7.m1.1a"><mrow id="Sx2.SSx2.p4.7.m1.1.1" xref="Sx2.SSx2.p4.7.m1.1.1.cmml"><mrow id="Sx2.SSx2.p4.7.m1.1.1.3" xref="Sx2.SSx2.p4.7.m1.1.1.3.cmml"><mi id="Sx2.SSx2.p4.7.m1.1.1.3.1" xref="Sx2.SSx2.p4.7.m1.1.1.3.1.cmml">log</mi><mo id="Sx2.SSx2.p4.7.m1.1.1.3a" lspace="0.167em" xref="Sx2.SSx2.p4.7.m1.1.1.3.cmml">⁡</mo><mi id="Sx2.SSx2.p4.7.m1.1.1.3.2" xref="Sx2.SSx2.p4.7.m1.1.1.3.2.cmml">p</mi></mrow><mo id="Sx2.SSx2.p4.7.m1.1.1.2" xref="Sx2.SSx2.p4.7.m1.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx2.p4.7.m1.1.1.1.1" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.cmml"><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.2" stretchy="false" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx2.p4.7.m1.1.1.1.1.1" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.cmml"><msubsup id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.cmml"><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.2.cmml">x</mi><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.3.cmml">i</mi><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.3.cmml">d</mi></msubsup><mo fence="false" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.3.cmml">|</mo><mrow id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.3.cmml"><mrow id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.2.cmml">α</mi><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">d</mi></msubsup><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.cmml"><msub id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.cmml"><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.2.cmml">ζ</mi><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.3.cmml">𝜽</mi></msub><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><msubsup id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.2" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml">𝒛</mi><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">i</mi><mi id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.3" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml">d</mi></msubsup><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.SSx2.p4.7.m1.1.1.1.1.3" stretchy="false" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.7.m1.1b"><apply id="Sx2.SSx2.p4.7.m1.1.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1"><times id="Sx2.SSx2.p4.7.m1.1.1.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.2"></times><apply id="Sx2.SSx2.p4.7.m1.1.1.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.3"><log id="Sx2.SSx2.p4.7.m1.1.1.3.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.3.1"></log><ci id="Sx2.SSx2.p4.7.m1.1.1.3.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.3.2">𝑝</ci></apply><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1"><csymbol cd="latexml" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.3">conditional</csymbol><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4">superscript</csymbol><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4">subscript</csymbol><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.2">𝑥</ci><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.4.3">𝑑</ci></apply><list id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2"><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1"><times id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.2"></times><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.2">𝛼</ci><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒛</ci><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑑</ci></apply><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2"><times id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.2"></times><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.2">𝜁</ci><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.3.3">𝜽</ci></apply><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1">subscript</csymbol><apply id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.1.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1">superscript</csymbol><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.2.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.2">𝒛</ci><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.2.3">𝑑</ci></apply><ci id="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="Sx2.SSx2.p4.7.m1.1.1.1.1.1.2.2.2.1.1.1.3">𝑖</ci></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.7.m1.1c">\log p(x_{i}^{d}|\alpha_{\boldsymbol{\theta}}(\boldsymbol{z}^{d}_{i}),\zeta_{%
\boldsymbol{\theta}}(\boldsymbol{z}^{d}_{i}))</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.7.m1.1d">roman_log italic_p ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT | italic_α start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , italic_ζ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math> is defined by Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.E7" title="In Empirical Bayesian Prior Modeling ‣ Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">7</span></a>), and <math alttext="\{\alpha_{\boldsymbol{\theta}}(\boldsymbol{z}),\zeta_{\boldsymbol{\theta}}(%
\boldsymbol{z})\}\triangleq f_{\boldsymbol{\theta}}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.8.m2.5"><semantics id="Sx2.SSx2.p4.8.m2.5a"><mrow id="Sx2.SSx2.p4.8.m2.5.5" xref="Sx2.SSx2.p4.8.m2.5.5.cmml"><mrow id="Sx2.SSx2.p4.8.m2.5.5.2.2" xref="Sx2.SSx2.p4.8.m2.5.5.2.3.cmml"><mo id="Sx2.SSx2.p4.8.m2.5.5.2.2.3" stretchy="false" xref="Sx2.SSx2.p4.8.m2.5.5.2.3.cmml">{</mo><mrow id="Sx2.SSx2.p4.8.m2.4.4.1.1.1" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.cmml"><msub id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.cmml"><mi id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.2" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.2.cmml">α</mi><mi id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.3" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.3.cmml">𝜽</mi></msub><mo id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.1" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.1.cmml">⁢</mo><mrow id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.3.2" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.cmml"><mo id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.3.2.1" stretchy="false" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.cmml">(</mo><mi id="Sx2.SSx2.p4.8.m2.1.1" xref="Sx2.SSx2.p4.8.m2.1.1.cmml">𝒛</mi><mo id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.3.2.2" stretchy="false" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx2.p4.8.m2.5.5.2.2.4" xref="Sx2.SSx2.p4.8.m2.5.5.2.3.cmml">,</mo><mrow id="Sx2.SSx2.p4.8.m2.5.5.2.2.2" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.cmml"><msub id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.cmml"><mi id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.2" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.2.cmml">ζ</mi><mi id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.3" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.3.cmml">𝜽</mi></msub><mo id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.1" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.1.cmml">⁢</mo><mrow id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.3.2" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.cmml"><mo id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.3.2.1" stretchy="false" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.cmml">(</mo><mi id="Sx2.SSx2.p4.8.m2.2.2" xref="Sx2.SSx2.p4.8.m2.2.2.cmml">𝒛</mi><mo id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.3.2.2" stretchy="false" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx2.p4.8.m2.5.5.2.2.5" stretchy="false" xref="Sx2.SSx2.p4.8.m2.5.5.2.3.cmml">}</mo></mrow><mo id="Sx2.SSx2.p4.8.m2.5.5.3" xref="Sx2.SSx2.p4.8.m2.5.5.3.cmml">≜</mo><mrow id="Sx2.SSx2.p4.8.m2.5.5.4" xref="Sx2.SSx2.p4.8.m2.5.5.4.cmml"><msub id="Sx2.SSx2.p4.8.m2.5.5.4.2" xref="Sx2.SSx2.p4.8.m2.5.5.4.2.cmml"><mi id="Sx2.SSx2.p4.8.m2.5.5.4.2.2" xref="Sx2.SSx2.p4.8.m2.5.5.4.2.2.cmml">f</mi><mi id="Sx2.SSx2.p4.8.m2.5.5.4.2.3" xref="Sx2.SSx2.p4.8.m2.5.5.4.2.3.cmml">𝜽</mi></msub><mo id="Sx2.SSx2.p4.8.m2.5.5.4.1" xref="Sx2.SSx2.p4.8.m2.5.5.4.1.cmml">⁢</mo><mrow id="Sx2.SSx2.p4.8.m2.5.5.4.3.2" xref="Sx2.SSx2.p4.8.m2.5.5.4.cmml"><mo id="Sx2.SSx2.p4.8.m2.5.5.4.3.2.1" stretchy="false" xref="Sx2.SSx2.p4.8.m2.5.5.4.cmml">(</mo><mi id="Sx2.SSx2.p4.8.m2.3.3" xref="Sx2.SSx2.p4.8.m2.3.3.cmml">𝒛</mi><mo id="Sx2.SSx2.p4.8.m2.5.5.4.3.2.2" stretchy="false" xref="Sx2.SSx2.p4.8.m2.5.5.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.8.m2.5b"><apply id="Sx2.SSx2.p4.8.m2.5.5.cmml" xref="Sx2.SSx2.p4.8.m2.5.5"><ci id="Sx2.SSx2.p4.8.m2.5.5.3.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.3">≜</ci><set id="Sx2.SSx2.p4.8.m2.5.5.2.3.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.2.2"><apply id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.cmml" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1"><times id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.1.cmml" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.1"></times><apply id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.cmml" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.1.cmml" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.2.cmml" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.2">𝛼</ci><ci id="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.3.cmml" xref="Sx2.SSx2.p4.8.m2.4.4.1.1.1.2.3">𝜽</ci></apply><ci id="Sx2.SSx2.p4.8.m2.1.1.cmml" xref="Sx2.SSx2.p4.8.m2.1.1">𝒛</ci></apply><apply id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2"><times id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.1.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.1"></times><apply id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.1.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2">subscript</csymbol><ci id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.2.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.2">𝜁</ci><ci id="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.3.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.2.2.2.2.3">𝜽</ci></apply><ci id="Sx2.SSx2.p4.8.m2.2.2.cmml" xref="Sx2.SSx2.p4.8.m2.2.2">𝒛</ci></apply></set><apply id="Sx2.SSx2.p4.8.m2.5.5.4.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.4"><times id="Sx2.SSx2.p4.8.m2.5.5.4.1.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.4.1"></times><apply id="Sx2.SSx2.p4.8.m2.5.5.4.2.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.4.2"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.8.m2.5.5.4.2.1.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.4.2">subscript</csymbol><ci id="Sx2.SSx2.p4.8.m2.5.5.4.2.2.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.4.2.2">𝑓</ci><ci id="Sx2.SSx2.p4.8.m2.5.5.4.2.3.cmml" xref="Sx2.SSx2.p4.8.m2.5.5.4.2.3">𝜽</ci></apply><ci id="Sx2.SSx2.p4.8.m2.3.3.cmml" xref="Sx2.SSx2.p4.8.m2.3.3">𝒛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.8.m2.5c">\{\alpha_{\boldsymbol{\theta}}(\boldsymbol{z}),\zeta_{\boldsymbol{\theta}}(%
\boldsymbol{z})\}\triangleq f_{\boldsymbol{\theta}}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.8.m2.5d">{ italic_α start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z ) , italic_ζ start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z ) } ≜ italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> denote the prior parameters predicted by <math alttext="f_{\boldsymbol{\theta}}" class="ltx_Math" display="inline" id="Sx2.SSx2.p4.9.m3.1"><semantics id="Sx2.SSx2.p4.9.m3.1a"><msub id="Sx2.SSx2.p4.9.m3.1.1" xref="Sx2.SSx2.p4.9.m3.1.1.cmml"><mi id="Sx2.SSx2.p4.9.m3.1.1.2" xref="Sx2.SSx2.p4.9.m3.1.1.2.cmml">f</mi><mi id="Sx2.SSx2.p4.9.m3.1.1.3" xref="Sx2.SSx2.p4.9.m3.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx2.p4.9.m3.1b"><apply id="Sx2.SSx2.p4.9.m3.1.1.cmml" xref="Sx2.SSx2.p4.9.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx2.p4.9.m3.1.1.1.cmml" xref="Sx2.SSx2.p4.9.m3.1.1">subscript</csymbol><ci id="Sx2.SSx2.p4.9.m3.1.1.2.cmml" xref="Sx2.SSx2.p4.9.m3.1.1.2">𝑓</ci><ci id="Sx2.SSx2.p4.9.m3.1.1.3.cmml" xref="Sx2.SSx2.p4.9.m3.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx2.p4.9.m3.1c">f_{\boldsymbol{\theta}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx2.p4.9.m3.1d">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx2.SSx3">
<h3 class="ltx_title ltx_title_subsection">Neural Network Architecture</h3>
<div class="ltx_para" id="Sx2.SSx3.p1">
<p class="ltx_p" id="Sx2.SSx3.p1.5">The architecture of our prior model <math alttext="f_{\boldsymbol{\theta}}" class="ltx_Math" display="inline" id="Sx2.SSx3.p1.1.m1.1"><semantics id="Sx2.SSx3.p1.1.m1.1a"><msub id="Sx2.SSx3.p1.1.m1.1.1" xref="Sx2.SSx3.p1.1.m1.1.1.cmml"><mi id="Sx2.SSx3.p1.1.m1.1.1.2" xref="Sx2.SSx3.p1.1.m1.1.1.2.cmml">f</mi><mi id="Sx2.SSx3.p1.1.m1.1.1.3" xref="Sx2.SSx3.p1.1.m1.1.1.3.cmml">𝜽</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.1.m1.1b"><apply id="Sx2.SSx3.p1.1.m1.1.1.cmml" xref="Sx2.SSx3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx3.p1.1.m1.1.1.1.cmml" xref="Sx2.SSx3.p1.1.m1.1.1">subscript</csymbol><ci id="Sx2.SSx3.p1.1.m1.1.1.2.cmml" xref="Sx2.SSx3.p1.1.m1.1.1.2">𝑓</ci><ci id="Sx2.SSx3.p1.1.m1.1.1.3.cmml" xref="Sx2.SSx3.p1.1.m1.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.1.m1.1c">f_{\boldsymbol{\theta}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> can be seen in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.F1" title="Figure 1 ‣ Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">1</span></a>. While this model can be made as expressive as necessary, we adopt a simple residual feedforward network architecture that takes query-item embeddings as input. Specifically, we can incorporate text embeddings for text features <cite class="ltx_cite ltx_citemacro_citep">(Devlin et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib13" title="">2018</a>)</cite>, image embeddings for image-based features <cite class="ltx_cite ltx_citemacro_citep">(Dosovitskiy et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib14" title="">2020</a>)</cite>, embedding tables for categorical features, and continuous transformations through other Feed-forward Networks (FFNs) for other continuous features. We further reparameterize <math alttext="\boldsymbol{\alpha}" class="ltx_Math" display="inline" id="Sx2.SSx3.p1.2.m2.1"><semantics id="Sx2.SSx3.p1.2.m2.1a"><mi id="Sx2.SSx3.p1.2.m2.1.1" xref="Sx2.SSx3.p1.2.m2.1.1.cmml">𝜶</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.2.m2.1b"><ci id="Sx2.SSx3.p1.2.m2.1.1.cmml" xref="Sx2.SSx3.p1.2.m2.1.1">𝜶</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.2.m2.1c">\boldsymbol{\alpha}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p1.2.m2.1d">bold_italic_α</annotation></semantics></math> into <math alttext="\log{\boldsymbol{\alpha}}" class="ltx_Math" display="inline" id="Sx2.SSx3.p1.3.m3.1"><semantics id="Sx2.SSx3.p1.3.m3.1a"><mrow id="Sx2.SSx3.p1.3.m3.1.1" xref="Sx2.SSx3.p1.3.m3.1.1.cmml"><mi id="Sx2.SSx3.p1.3.m3.1.1.1" xref="Sx2.SSx3.p1.3.m3.1.1.1.cmml">log</mi><mo id="Sx2.SSx3.p1.3.m3.1.1a" lspace="0.167em" xref="Sx2.SSx3.p1.3.m3.1.1.cmml">⁡</mo><mi id="Sx2.SSx3.p1.3.m3.1.1.2" xref="Sx2.SSx3.p1.3.m3.1.1.2.cmml">𝜶</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.3.m3.1b"><apply id="Sx2.SSx3.p1.3.m3.1.1.cmml" xref="Sx2.SSx3.p1.3.m3.1.1"><log id="Sx2.SSx3.p1.3.m3.1.1.1.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.1"></log><ci id="Sx2.SSx3.p1.3.m3.1.1.2.cmml" xref="Sx2.SSx3.p1.3.m3.1.1.2">𝜶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.3.m3.1c">\log{\boldsymbol{\alpha}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p1.3.m3.1d">roman_log bold_italic_α</annotation></semantics></math>, letting the model output <math alttext="\log{\boldsymbol{\alpha}}" class="ltx_Math" display="inline" id="Sx2.SSx3.p1.4.m4.1"><semantics id="Sx2.SSx3.p1.4.m4.1a"><mrow id="Sx2.SSx3.p1.4.m4.1.1" xref="Sx2.SSx3.p1.4.m4.1.1.cmml"><mi id="Sx2.SSx3.p1.4.m4.1.1.1" xref="Sx2.SSx3.p1.4.m4.1.1.1.cmml">log</mi><mo id="Sx2.SSx3.p1.4.m4.1.1a" lspace="0.167em" xref="Sx2.SSx3.p1.4.m4.1.1.cmml">⁡</mo><mi id="Sx2.SSx3.p1.4.m4.1.1.2" xref="Sx2.SSx3.p1.4.m4.1.1.2.cmml">𝜶</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.4.m4.1b"><apply id="Sx2.SSx3.p1.4.m4.1.1.cmml" xref="Sx2.SSx3.p1.4.m4.1.1"><log id="Sx2.SSx3.p1.4.m4.1.1.1.cmml" xref="Sx2.SSx3.p1.4.m4.1.1.1"></log><ci id="Sx2.SSx3.p1.4.m4.1.1.2.cmml" xref="Sx2.SSx3.p1.4.m4.1.1.2">𝜶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.4.m4.1c">\log{\boldsymbol{\alpha}}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p1.4.m4.1d">roman_log bold_italic_α</annotation></semantics></math> and <math alttext="\boldsymbol{\zeta}" class="ltx_Math" display="inline" id="Sx2.SSx3.p1.5.m5.1"><semantics id="Sx2.SSx3.p1.5.m5.1a"><mi id="Sx2.SSx3.p1.5.m5.1.1" xref="Sx2.SSx3.p1.5.m5.1.1.cmml">𝜻</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx3.p1.5.m5.1b"><ci id="Sx2.SSx3.p1.5.m5.1.1.cmml" xref="Sx2.SSx3.p1.5.m5.1.1">𝜻</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx3.p1.5.m5.1c">\boldsymbol{\zeta}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx3.p1.5.m5.1d">bold_italic_ζ</annotation></semantics></math>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> BayesCNS Algorithm</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline">0:</span>  Prior model <math alttext="f_{\boldsymbol{\theta}}(\cdot)" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><mrow id="alg1.l0.m1.1.2" xref="alg1.l0.m1.1.2.cmml"><msub id="alg1.l0.m1.1.2.2" xref="alg1.l0.m1.1.2.2.cmml"><mi id="alg1.l0.m1.1.2.2.2" xref="alg1.l0.m1.1.2.2.2.cmml">f</mi><mi id="alg1.l0.m1.1.2.2.3" xref="alg1.l0.m1.1.2.2.3.cmml">𝜽</mi></msub><mo id="alg1.l0.m1.1.2.1" xref="alg1.l0.m1.1.2.1.cmml">⁢</mo><mrow id="alg1.l0.m1.1.2.3.2" xref="alg1.l0.m1.1.2.cmml"><mo id="alg1.l0.m1.1.2.3.2.1" stretchy="false" xref="alg1.l0.m1.1.2.cmml">(</mo><mo id="alg1.l0.m1.1.1" lspace="0em" rspace="0em" xref="alg1.l0.m1.1.1.cmml">⋅</mo><mo id="alg1.l0.m1.1.2.3.2.2" stretchy="false" xref="alg1.l0.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.2.cmml" xref="alg1.l0.m1.1.2"><times id="alg1.l0.m1.1.2.1.cmml" xref="alg1.l0.m1.1.2.1"></times><apply id="alg1.l0.m1.1.2.2.cmml" xref="alg1.l0.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l0.m1.1.2.2.1.cmml" xref="alg1.l0.m1.1.2.2">subscript</csymbol><ci id="alg1.l0.m1.1.2.2.2.cmml" xref="alg1.l0.m1.1.2.2.2">𝑓</ci><ci id="alg1.l0.m1.1.2.2.3.cmml" xref="alg1.l0.m1.1.2.2.3">𝜽</ci></apply><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">f_{\boldsymbol{\theta}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>, Ranking model <math alttext="p_{\boldsymbol{\psi}}(\cdot)" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mrow id="alg1.l0.m2.1.2" xref="alg1.l0.m2.1.2.cmml"><msub id="alg1.l0.m2.1.2.2" xref="alg1.l0.m2.1.2.2.cmml"><mi id="alg1.l0.m2.1.2.2.2" xref="alg1.l0.m2.1.2.2.2.cmml">p</mi><mi id="alg1.l0.m2.1.2.2.3" xref="alg1.l0.m2.1.2.2.3.cmml">𝝍</mi></msub><mo id="alg1.l0.m2.1.2.1" xref="alg1.l0.m2.1.2.1.cmml">⁢</mo><mrow id="alg1.l0.m2.1.2.3.2" xref="alg1.l0.m2.1.2.cmml"><mo id="alg1.l0.m2.1.2.3.2.1" stretchy="false" xref="alg1.l0.m2.1.2.cmml">(</mo><mo id="alg1.l0.m2.1.1" lspace="0em" rspace="0em" xref="alg1.l0.m2.1.1.cmml">⋅</mo><mo id="alg1.l0.m2.1.2.3.2.2" stretchy="false" xref="alg1.l0.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.2.cmml" xref="alg1.l0.m2.1.2"><times id="alg1.l0.m2.1.2.1.cmml" xref="alg1.l0.m2.1.2.1"></times><apply id="alg1.l0.m2.1.2.2.cmml" xref="alg1.l0.m2.1.2.2"><csymbol cd="ambiguous" id="alg1.l0.m2.1.2.2.1.cmml" xref="alg1.l0.m2.1.2.2">subscript</csymbol><ci id="alg1.l0.m2.1.2.2.2.cmml" xref="alg1.l0.m2.1.2.2.2">𝑝</ci><ci id="alg1.l0.m2.1.2.2.3.cmml" xref="alg1.l0.m2.1.2.2.3">𝝍</ci></apply><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">p_{\boldsymbol{\psi}}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">italic_p start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( ⋅ )</annotation></semantics></math>, <math alttext="\gamma" class="ltx_Math" display="inline" id="alg1.l0.m3.1"><semantics id="alg1.l0.m3.1a"><mi id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">\gamma</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.1d">italic_γ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline">1:</span>  <math alttext="\{\alpha_{d},\beta_{d}\}\leftarrow f_{\boldsymbol{\theta}}(\boldsymbol{z}_{d})%
,\forall d\in D" class="ltx_Math" display="inline" id="alg1.l1.m1.2"><semantics id="alg1.l1.m1.2a"><mrow id="alg1.l1.m1.2.2.2" xref="alg1.l1.m1.2.2.3.cmml"><mrow id="alg1.l1.m1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.cmml"><mrow id="alg1.l1.m1.1.1.1.1.2.2" xref="alg1.l1.m1.1.1.1.1.2.3.cmml"><mo id="alg1.l1.m1.1.1.1.1.2.2.3" stretchy="false" xref="alg1.l1.m1.1.1.1.1.2.3.cmml">{</mo><msub id="alg1.l1.m1.1.1.1.1.1.1.1" xref="alg1.l1.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.1.1.1.2.cmml">α</mi><mi id="alg1.l1.m1.1.1.1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.1.1.1.3.cmml">d</mi></msub><mo id="alg1.l1.m1.1.1.1.1.2.2.4" xref="alg1.l1.m1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l1.m1.1.1.1.1.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l1.m1.1.1.1.1.2.2.2.2" xref="alg1.l1.m1.1.1.1.1.2.2.2.2.cmml">β</mi><mi id="alg1.l1.m1.1.1.1.1.2.2.2.3" xref="alg1.l1.m1.1.1.1.1.2.2.2.3.cmml">d</mi></msub><mo id="alg1.l1.m1.1.1.1.1.2.2.5" stretchy="false" xref="alg1.l1.m1.1.1.1.1.2.3.cmml">}</mo></mrow><mo id="alg1.l1.m1.1.1.1.1.4" stretchy="false" xref="alg1.l1.m1.1.1.1.1.4.cmml">←</mo><mrow id="alg1.l1.m1.1.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.3.cmml"><msub id="alg1.l1.m1.1.1.1.1.3.3" xref="alg1.l1.m1.1.1.1.1.3.3.cmml"><mi id="alg1.l1.m1.1.1.1.1.3.3.2" xref="alg1.l1.m1.1.1.1.1.3.3.2.cmml">f</mi><mi id="alg1.l1.m1.1.1.1.1.3.3.3" xref="alg1.l1.m1.1.1.1.1.3.3.3.cmml">𝜽</mi></msub><mo id="alg1.l1.m1.1.1.1.1.3.2" xref="alg1.l1.m1.1.1.1.1.3.2.cmml">⁢</mo><mrow id="alg1.l1.m1.1.1.1.1.3.1.1" xref="alg1.l1.m1.1.1.1.1.3.1.1.1.cmml"><mo id="alg1.l1.m1.1.1.1.1.3.1.1.2" stretchy="false" xref="alg1.l1.m1.1.1.1.1.3.1.1.1.cmml">(</mo><msub id="alg1.l1.m1.1.1.1.1.3.1.1.1" xref="alg1.l1.m1.1.1.1.1.3.1.1.1.cmml"><mi id="alg1.l1.m1.1.1.1.1.3.1.1.1.2" xref="alg1.l1.m1.1.1.1.1.3.1.1.1.2.cmml">𝒛</mi><mi id="alg1.l1.m1.1.1.1.1.3.1.1.1.3" xref="alg1.l1.m1.1.1.1.1.3.1.1.1.3.cmml">d</mi></msub><mo id="alg1.l1.m1.1.1.1.1.3.1.1.3" stretchy="false" xref="alg1.l1.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="alg1.l1.m1.2.2.2.3" xref="alg1.l1.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l1.m1.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.cmml"><mrow id="alg1.l1.m1.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.cmml"><mo id="alg1.l1.m1.2.2.2.2.2.1" rspace="0.167em" xref="alg1.l1.m1.2.2.2.2.2.1.cmml">∀</mo><mi id="alg1.l1.m1.2.2.2.2.2.2" xref="alg1.l1.m1.2.2.2.2.2.2.cmml">d</mi></mrow><mo id="alg1.l1.m1.2.2.2.2.1" xref="alg1.l1.m1.2.2.2.2.1.cmml">∈</mo><mi id="alg1.l1.m1.2.2.2.2.3" xref="alg1.l1.m1.2.2.2.2.3.cmml">D</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.2b"><apply id="alg1.l1.m1.2.2.3.cmml" xref="alg1.l1.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.3a.cmml" xref="alg1.l1.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l1.m1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1"><ci id="alg1.l1.m1.1.1.1.1.4.cmml" xref="alg1.l1.m1.1.1.1.1.4">←</ci><set id="alg1.l1.m1.1.1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2"><apply id="alg1.l1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.2">𝛼</ci><ci id="alg1.l1.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="alg1.l1.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.2">𝛽</ci><ci id="alg1.l1.m1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l1.m1.1.1.1.1.2.2.2.3">𝑑</ci></apply></set><apply id="alg1.l1.m1.1.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.3"><times id="alg1.l1.m1.1.1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.1.1.3.2"></times><apply id="alg1.l1.m1.1.1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.2">𝑓</ci><ci id="alg1.l1.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l1.m1.1.1.1.1.3.3.3">𝜽</ci></apply><apply id="alg1.l1.m1.1.1.1.1.3.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.1.3.1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1.1.3.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.1.1.3.1.1.1.2.cmml" xref="alg1.l1.m1.1.1.1.1.3.1.1.1.2">𝒛</ci><ci id="alg1.l1.m1.1.1.1.1.3.1.1.1.3.cmml" xref="alg1.l1.m1.1.1.1.1.3.1.1.1.3">𝑑</ci></apply></apply></apply><apply id="alg1.l1.m1.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2"><in id="alg1.l1.m1.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.1"></in><apply id="alg1.l1.m1.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2"><csymbol cd="latexml" id="alg1.l1.m1.2.2.2.2.2.1.cmml" xref="alg1.l1.m1.2.2.2.2.2.1">for-all</csymbol><ci id="alg1.l1.m1.2.2.2.2.2.2.cmml" xref="alg1.l1.m1.2.2.2.2.2.2">𝑑</ci></apply><ci id="alg1.l1.m1.2.2.2.2.3.cmml" xref="alg1.l1.m1.2.2.2.2.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.2c">\{\alpha_{d},\beta_{d}\}\leftarrow f_{\boldsymbol{\theta}}(\boldsymbol{z}_{d})%
,\forall d\in D</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.2d">{ italic_α start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT } ← italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ) , ∀ italic_d ∈ italic_D</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l2.1">for</span> <math alttext="t\leftarrow 0" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">t</mi><mo id="alg1.l2.m1.1.1.1" stretchy="false" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑡</ci><cn id="alg1.l2.m1.1.1.3.cmml" type="integer" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">t\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_t ← 0</annotation></semantics></math> to <math alttext="T" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_T</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l2.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline">3:</span>     <span class="ltx_text ltx_font_typewriter" id="alg1.l3.1">// Rank and Show Items</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l4.1">for</span> <math alttext="d\in D" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">d</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑑</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">d\in D</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_d ∈ italic_D</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline">5:</span>        <math alttext="\hat{\boldsymbol{a}}_{d}\sim p_{GP}(\boldsymbol{x}_{t}|\alpha_{d},\beta_{d})" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mover accent="true" id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml"><mi id="alg1.l5.m1.1.1.3.2.2" xref="alg1.l5.m1.1.1.3.2.2.cmml">𝒂</mi><mo id="alg1.l5.m1.1.1.3.2.1" xref="alg1.l5.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">d</mi></msub><mo id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">∼</mo><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><msub id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.1.3.2" xref="alg1.l5.m1.1.1.1.3.2.cmml">p</mi><mrow id="alg1.l5.m1.1.1.1.3.3" xref="alg1.l5.m1.1.1.1.3.3.cmml"><mi id="alg1.l5.m1.1.1.1.3.3.2" xref="alg1.l5.m1.1.1.1.3.3.2.cmml">G</mi><mo id="alg1.l5.m1.1.1.1.3.3.1" xref="alg1.l5.m1.1.1.1.3.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.1.1.1.3.3.3" xref="alg1.l5.m1.1.1.1.3.3.3.cmml">P</mi></mrow></msub><mo id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l5.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l5.m1.1.1.1.1.1.1.4" xref="alg1.l5.m1.1.1.1.1.1.1.4.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.4.2" xref="alg1.l5.m1.1.1.1.1.1.1.4.2.cmml">𝒙</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.4.3" xref="alg1.l5.m1.1.1.1.1.1.1.4.3.cmml">t</mi></msub><mo fence="false" id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="alg1.l5.m1.1.1.1.1.1.1.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml"><msub id="alg1.l5.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.cmml">α</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3.cmml">d</mi></msub><mo id="alg1.l5.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l5.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.2.cmml">β</mi><mi id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.3.cmml">d</mi></msub></mrow></mrow><mo id="alg1.l5.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">similar-to</csymbol><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><apply id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2"><ci id="alg1.l5.m1.1.1.3.2.1.cmml" xref="alg1.l5.m1.1.1.3.2.1">^</ci><ci id="alg1.l5.m1.1.1.3.2.2.cmml" xref="alg1.l5.m1.1.1.3.2.2">𝒂</ci></apply><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑑</ci></apply><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><apply id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.1.3.2">𝑝</ci><apply id="alg1.l5.m1.1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.1.3.3"><times id="alg1.l5.m1.1.1.1.3.3.1.cmml" xref="alg1.l5.m1.1.1.1.3.3.1"></times><ci id="alg1.l5.m1.1.1.1.3.3.2.cmml" xref="alg1.l5.m1.1.1.1.3.3.2">𝐺</ci><ci id="alg1.l5.m1.1.1.1.3.3.3.cmml" xref="alg1.l5.m1.1.1.1.3.3.3">𝑃</ci></apply></apply><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="alg1.l5.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4.2">𝒙</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.4.3">𝑡</ci></apply><list id="alg1.l5.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2"><apply id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.2">𝛼</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.2">𝛽</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2.2.2.3">𝑑</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\hat{\boldsymbol{a}}_{d}\sim p_{GP}(\boldsymbol{x}_{t}|\alpha_{d},\beta_{d})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ∼ italic_p start_POSTSUBSCRIPT italic_G italic_P end_POSTSUBSCRIPT ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_α start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline">6:</span>        <math alttext="s_{d}\leftarrow p_{\boldsymbol{\psi}}(c|\hat{\boldsymbol{a}}_{d},\boldsymbol{z%
}_{d})" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">s</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">d</mi></msub><mo id="alg1.l6.m1.1.1.2" stretchy="false" xref="alg1.l6.m1.1.1.2.cmml">←</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.3.2.cmml">p</mi><mi id="alg1.l6.m1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.3.3.cmml">𝝍</mi></msub><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mo id="alg1.l6.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.4" xref="alg1.l6.m1.1.1.1.1.1.1.4.cmml">c</mi><mo fence="false" id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.3.cmml"><msub id="alg1.l6.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒂</mi><mo id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.3.cmml">d</mi></msub><mo id="alg1.l6.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l6.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l6.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.2.2.cmml">𝒛</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.2.3.cmml">d</mi></msub></mrow></mrow><mo id="alg1.l6.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">←</ci><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝑠</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑑</ci></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><times id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></times><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.2">𝑝</ci><ci id="alg1.l6.m1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.3">𝝍</ci></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">conditional</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.4">𝑐</ci><list id="alg1.l6.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.2"><apply id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2"><ci id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.2.2">𝒂</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.1.3">𝑑</ci></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.2.2">𝒛</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2.2.2.3">𝑑</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">s_{d}\leftarrow p_{\boldsymbol{\psi}}(c|\hat{\boldsymbol{a}}_{d},\boldsymbol{z%
}_{d})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_s start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ← italic_p start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( italic_c | over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT , bold_italic_z start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l7.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l7.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math alttext="D_{q_{t}}\leftarrow\operatorname{TopK}_{d\in D}{s_{d}}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msub id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">D</mi><msub id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml"><mi id="alg1.l8.m1.1.1.2.3.2" xref="alg1.l8.m1.1.1.2.3.2.cmml">q</mi><mi id="alg1.l8.m1.1.1.2.3.3" xref="alg1.l8.m1.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="alg1.l8.m1.1.1.1" stretchy="false" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><msub id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml"><mi id="alg1.l8.m1.1.1.3.1.2" xref="alg1.l8.m1.1.1.3.1.2.cmml">TopK</mi><mrow id="alg1.l8.m1.1.1.3.1.3" xref="alg1.l8.m1.1.1.3.1.3.cmml"><mi id="alg1.l8.m1.1.1.3.1.3.2" xref="alg1.l8.m1.1.1.3.1.3.2.cmml">d</mi><mo id="alg1.l8.m1.1.1.3.1.3.1" xref="alg1.l8.m1.1.1.3.1.3.1.cmml">∈</mo><mi id="alg1.l8.m1.1.1.3.1.3.3" xref="alg1.l8.m1.1.1.3.1.3.3.cmml">D</mi></mrow></msub><mo id="alg1.l8.m1.1.1.3a" lspace="0.167em" xref="alg1.l8.m1.1.1.3.cmml">⁡</mo><msub id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml"><mi id="alg1.l8.m1.1.1.3.2.2" xref="alg1.l8.m1.1.1.3.2.2.cmml">s</mi><mi id="alg1.l8.m1.1.1.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.cmml">d</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝐷</ci><apply id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.3.1.cmml" xref="alg1.l8.m1.1.1.2.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.2.3.2.cmml" xref="alg1.l8.m1.1.1.2.3.2">𝑞</ci><ci id="alg1.l8.m1.1.1.2.3.3.cmml" xref="alg1.l8.m1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><apply id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.1.cmml" xref="alg1.l8.m1.1.1.3.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.1.2.cmml" xref="alg1.l8.m1.1.1.3.1.2">TopK</ci><apply id="alg1.l8.m1.1.1.3.1.3.cmml" xref="alg1.l8.m1.1.1.3.1.3"><in id="alg1.l8.m1.1.1.3.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1.3.1"></in><ci id="alg1.l8.m1.1.1.3.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.1.3.2">𝑑</ci><ci id="alg1.l8.m1.1.1.3.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.1.3.3">𝐷</ci></apply></apply><apply id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2">𝑠</ci><ci id="alg1.l8.m1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">D_{q_{t}}\leftarrow\operatorname{TopK}_{d\in D}{s_{d}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT ← roman_TopK start_POSTSUBSCRIPT italic_d ∈ italic_D end_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline">9:</span>     Show <math alttext="D_{q_{t}}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">D</mi><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">q</mi><mi id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝐷</ci><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑞</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">D_{q_{t}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and receive feedback <math alttext="\boldsymbol{x}_{t}" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><msub id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">𝒙</mi><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝒙</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">\boldsymbol{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="n_{t}" class="ltx_Math" display="inline" id="alg1.l9.m3.1"><semantics id="alg1.l9.m3.1a"><msub id="alg1.l9.m3.1.1" xref="alg1.l9.m3.1.1.cmml"><mi id="alg1.l9.m3.1.1.2" xref="alg1.l9.m3.1.1.2.cmml">n</mi><mi id="alg1.l9.m3.1.1.3" xref="alg1.l9.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m3.1b"><apply id="alg1.l9.m3.1.1.cmml" xref="alg1.l9.m3.1.1"><csymbol cd="ambiguous" id="alg1.l9.m3.1.1.1.cmml" xref="alg1.l9.m3.1.1">subscript</csymbol><ci id="alg1.l9.m3.1.1.2.cmml" xref="alg1.l9.m3.1.1.2">𝑛</ci><ci id="alg1.l9.m3.1.1.3.cmml" xref="alg1.l9.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m3.1c">n_{t}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m3.1d">italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline">10:</span>     
</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <span class="ltx_text ltx_font_typewriter" id="alg1.l11.1">// Update Estimates</span>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l12.1">for</span> <math alttext="d\in D_{q_{t}}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">d</mi><mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">∈</mo><msub id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.3.2" xref="alg1.l12.m1.1.1.3.2.cmml">D</mi><msub id="alg1.l12.m1.1.1.3.3" xref="alg1.l12.m1.1.1.3.3.cmml"><mi id="alg1.l12.m1.1.1.3.3.2" xref="alg1.l12.m1.1.1.3.3.2.cmml">q</mi><mi id="alg1.l12.m1.1.1.3.3.3" xref="alg1.l12.m1.1.1.3.3.3.cmml">t</mi></msub></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><in id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1"></in><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑑</ci><apply id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.3.2">𝐷</ci><apply id="alg1.l12.m1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.3.3.1.cmml" xref="alg1.l12.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l12.m1.1.1.3.3.2.cmml" xref="alg1.l12.m1.1.1.3.3.2">𝑞</ci><ci id="alg1.l12.m1.1.1.3.3.3.cmml" xref="alg1.l12.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">d\in D_{q_{t}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">italic_d ∈ italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l12.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline">13:</span>        <math alttext="\{\alpha_{0},\beta_{0}\}\leftarrow f_{\boldsymbol{\theta}}(\boldsymbol{z}_{d})" class="ltx_Math" display="inline" id="alg1.l13.m1.3"><semantics id="alg1.l13.m1.3a"><mrow id="alg1.l13.m1.3.3" xref="alg1.l13.m1.3.3.cmml"><mrow id="alg1.l13.m1.2.2.2.2" xref="alg1.l13.m1.2.2.2.3.cmml"><mo id="alg1.l13.m1.2.2.2.2.3" stretchy="false" xref="alg1.l13.m1.2.2.2.3.cmml">{</mo><msub id="alg1.l13.m1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.2" xref="alg1.l13.m1.1.1.1.1.1.2.cmml">α</mi><mn id="alg1.l13.m1.1.1.1.1.1.3" xref="alg1.l13.m1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="alg1.l13.m1.2.2.2.2.4" xref="alg1.l13.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l13.m1.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.cmml"><mi id="alg1.l13.m1.2.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.2.cmml">β</mi><mn id="alg1.l13.m1.2.2.2.2.2.3" xref="alg1.l13.m1.2.2.2.2.2.3.cmml">0</mn></msub><mo id="alg1.l13.m1.2.2.2.2.5" stretchy="false" xref="alg1.l13.m1.2.2.2.3.cmml">}</mo></mrow><mo id="alg1.l13.m1.3.3.4" stretchy="false" xref="alg1.l13.m1.3.3.4.cmml">←</mo><mrow id="alg1.l13.m1.3.3.3" xref="alg1.l13.m1.3.3.3.cmml"><msub id="alg1.l13.m1.3.3.3.3" xref="alg1.l13.m1.3.3.3.3.cmml"><mi id="alg1.l13.m1.3.3.3.3.2" xref="alg1.l13.m1.3.3.3.3.2.cmml">f</mi><mi id="alg1.l13.m1.3.3.3.3.3" xref="alg1.l13.m1.3.3.3.3.3.cmml">𝜽</mi></msub><mo id="alg1.l13.m1.3.3.3.2" xref="alg1.l13.m1.3.3.3.2.cmml">⁢</mo><mrow id="alg1.l13.m1.3.3.3.1.1" xref="alg1.l13.m1.3.3.3.1.1.1.cmml"><mo id="alg1.l13.m1.3.3.3.1.1.2" stretchy="false" xref="alg1.l13.m1.3.3.3.1.1.1.cmml">(</mo><msub id="alg1.l13.m1.3.3.3.1.1.1" xref="alg1.l13.m1.3.3.3.1.1.1.cmml"><mi id="alg1.l13.m1.3.3.3.1.1.1.2" xref="alg1.l13.m1.3.3.3.1.1.1.2.cmml">𝒛</mi><mi id="alg1.l13.m1.3.3.3.1.1.1.3" xref="alg1.l13.m1.3.3.3.1.1.1.3.cmml">d</mi></msub><mo id="alg1.l13.m1.3.3.3.1.1.3" stretchy="false" xref="alg1.l13.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.3b"><apply id="alg1.l13.m1.3.3.cmml" xref="alg1.l13.m1.3.3"><ci id="alg1.l13.m1.3.3.4.cmml" xref="alg1.l13.m1.3.3.4">←</ci><set id="alg1.l13.m1.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2"><apply id="alg1.l13.m1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.1.1.1.1.1.2">𝛼</ci><cn id="alg1.l13.m1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l13.m1.1.1.1.1.1.3">0</cn></apply><apply id="alg1.l13.m1.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.2.2.1.cmml" xref="alg1.l13.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2">𝛽</ci><cn id="alg1.l13.m1.2.2.2.2.2.3.cmml" type="integer" xref="alg1.l13.m1.2.2.2.2.2.3">0</cn></apply></set><apply id="alg1.l13.m1.3.3.3.cmml" xref="alg1.l13.m1.3.3.3"><times id="alg1.l13.m1.3.3.3.2.cmml" xref="alg1.l13.m1.3.3.3.2"></times><apply id="alg1.l13.m1.3.3.3.3.cmml" xref="alg1.l13.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.3.3.1.cmml" xref="alg1.l13.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l13.m1.3.3.3.3.2.cmml" xref="alg1.l13.m1.3.3.3.3.2">𝑓</ci><ci id="alg1.l13.m1.3.3.3.3.3.cmml" xref="alg1.l13.m1.3.3.3.3.3">𝜽</ci></apply><apply id="alg1.l13.m1.3.3.3.1.1.1.cmml" xref="alg1.l13.m1.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.3.3.3.1.1.1.1.cmml" xref="alg1.l13.m1.3.3.3.1.1">subscript</csymbol><ci id="alg1.l13.m1.3.3.3.1.1.1.2.cmml" xref="alg1.l13.m1.3.3.3.1.1.1.2">𝒛</ci><ci id="alg1.l13.m1.3.3.3.1.1.1.3.cmml" xref="alg1.l13.m1.3.3.3.1.1.1.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.3c">\{\alpha_{0},\beta_{0}\}\leftarrow f_{\boldsymbol{\theta}}(\boldsymbol{z}_{d})</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.3d">{ italic_α start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT } ← italic_f start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_italic_z start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline">14:</span>        <math alttext="\alpha_{d}\leftarrow\sum_{i=1}^{n_{t}}{x_{t}^{i}}+\gamma\alpha_{0}+(1-\gamma)%
\alpha_{d}" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml">α</mi><mi id="alg1.l14.m1.1.1.3.3" xref="alg1.l14.m1.1.1.3.3.cmml">d</mi></msub><mo id="alg1.l14.m1.1.1.2" rspace="0.111em" stretchy="false" xref="alg1.l14.m1.1.1.2.cmml">←</mo><mrow id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml"><mrow id="alg1.l14.m1.1.1.1.3" xref="alg1.l14.m1.1.1.1.3.cmml"><msubsup id="alg1.l14.m1.1.1.1.3.1" xref="alg1.l14.m1.1.1.1.3.1.cmml"><mo id="alg1.l14.m1.1.1.1.3.1.2.2" xref="alg1.l14.m1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l14.m1.1.1.1.3.1.2.3" xref="alg1.l14.m1.1.1.1.3.1.2.3.cmml"><mi id="alg1.l14.m1.1.1.1.3.1.2.3.2" xref="alg1.l14.m1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="alg1.l14.m1.1.1.1.3.1.2.3.1" xref="alg1.l14.m1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l14.m1.1.1.1.3.1.2.3.3" xref="alg1.l14.m1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="alg1.l14.m1.1.1.1.3.1.3" xref="alg1.l14.m1.1.1.1.3.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.3.1.3.2" xref="alg1.l14.m1.1.1.1.3.1.3.2.cmml">n</mi><mi id="alg1.l14.m1.1.1.1.3.1.3.3" xref="alg1.l14.m1.1.1.1.3.1.3.3.cmml">t</mi></msub></msubsup><msubsup id="alg1.l14.m1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.3.2.cmml"><mi id="alg1.l14.m1.1.1.1.3.2.2.2" xref="alg1.l14.m1.1.1.1.3.2.2.2.cmml">x</mi><mi id="alg1.l14.m1.1.1.1.3.2.2.3" xref="alg1.l14.m1.1.1.1.3.2.2.3.cmml">t</mi><mi id="alg1.l14.m1.1.1.1.3.2.3" xref="alg1.l14.m1.1.1.1.3.2.3.cmml">i</mi></msubsup></mrow><mo id="alg1.l14.m1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l14.m1.1.1.1.4" xref="alg1.l14.m1.1.1.1.4.cmml"><mi id="alg1.l14.m1.1.1.1.4.2" xref="alg1.l14.m1.1.1.1.4.2.cmml">γ</mi><mo id="alg1.l14.m1.1.1.1.4.1" xref="alg1.l14.m1.1.1.1.4.1.cmml">⁢</mo><msub id="alg1.l14.m1.1.1.1.4.3" xref="alg1.l14.m1.1.1.1.4.3.cmml"><mi id="alg1.l14.m1.1.1.1.4.3.2" xref="alg1.l14.m1.1.1.1.4.3.2.cmml">α</mi><mn id="alg1.l14.m1.1.1.1.4.3.3" xref="alg1.l14.m1.1.1.1.4.3.3.cmml">0</mn></msub></mrow><mo id="alg1.l14.m1.1.1.1.2a" xref="alg1.l14.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml"><mrow id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l14.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l14.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l14.m1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.cmml"><mn id="alg1.l14.m1.1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l14.m1.1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l14.m1.1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="alg1.l14.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l14.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l14.m1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.2.cmml">⁢</mo><msub id="alg1.l14.m1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.3.2" xref="alg1.l14.m1.1.1.1.1.3.2.cmml">α</mi><mi id="alg1.l14.m1.1.1.1.1.3.3" xref="alg1.l14.m1.1.1.1.1.3.3.cmml">d</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">←</ci><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2">𝛼</ci><ci id="alg1.l14.m1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.3.3">𝑑</ci></apply><apply id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1"><plus id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.2"></plus><apply id="alg1.l14.m1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.3"><apply id="alg1.l14.m1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.3.1.1.cmml" xref="alg1.l14.m1.1.1.1.3.1">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.3.1.2.cmml" xref="alg1.l14.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.3.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.3.1">subscript</csymbol><sum id="alg1.l14.m1.1.1.1.3.1.2.2.cmml" xref="alg1.l14.m1.1.1.1.3.1.2.2"></sum><apply id="alg1.l14.m1.1.1.1.3.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.3.1.2.3"><eq id="alg1.l14.m1.1.1.1.3.1.2.3.1.cmml" xref="alg1.l14.m1.1.1.1.3.1.2.3.1"></eq><ci id="alg1.l14.m1.1.1.1.3.1.2.3.2.cmml" xref="alg1.l14.m1.1.1.1.3.1.2.3.2">𝑖</ci><cn id="alg1.l14.m1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="alg1.l14.m1.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="alg1.l14.m1.1.1.1.3.1.3.cmml" xref="alg1.l14.m1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.3.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.3.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.3.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.3.1.3.2">𝑛</ci><ci id="alg1.l14.m1.1.1.1.3.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.3.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l14.m1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.1.3.2">superscript</csymbol><apply id="alg1.l14.m1.1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.3.2.2.1.cmml" xref="alg1.l14.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.3.2.2.2.cmml" xref="alg1.l14.m1.1.1.1.3.2.2.2">𝑥</ci><ci id="alg1.l14.m1.1.1.1.3.2.2.3.cmml" xref="alg1.l14.m1.1.1.1.3.2.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.1.3.2.3">𝑖</ci></apply></apply><apply id="alg1.l14.m1.1.1.1.4.cmml" xref="alg1.l14.m1.1.1.1.4"><times id="alg1.l14.m1.1.1.1.4.1.cmml" xref="alg1.l14.m1.1.1.1.4.1"></times><ci id="alg1.l14.m1.1.1.1.4.2.cmml" xref="alg1.l14.m1.1.1.1.4.2">𝛾</ci><apply id="alg1.l14.m1.1.1.1.4.3.cmml" xref="alg1.l14.m1.1.1.1.4.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.4.3.1.cmml" xref="alg1.l14.m1.1.1.1.4.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.4.3.2.cmml" xref="alg1.l14.m1.1.1.1.4.3.2">𝛼</ci><cn id="alg1.l14.m1.1.1.1.4.3.3.cmml" type="integer" xref="alg1.l14.m1.1.1.1.4.3.3">0</cn></apply></apply><apply id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1"><times id="alg1.l14.m1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.2"></times><apply id="alg1.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1"><minus id="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.1"></minus><cn id="alg1.l14.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l14.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg1.l14.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="alg1.l14.m1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.3.2">𝛼</ci><ci id="alg1.l14.m1.1.1.1.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\alpha_{d}\leftarrow\sum_{i=1}^{n_{t}}{x_{t}^{i}}+\gamma\alpha_{0}+(1-\gamma)%
\alpha_{d}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">italic_α start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ← ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT + italic_γ italic_α start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + ( 1 - italic_γ ) italic_α start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline">15:</span>        <math alttext="\beta_{d}\leftarrow n_{t}+\gamma\beta_{0}+(1-\gamma)\beta_{d}" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msub id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">β</mi><mi id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml">d</mi></msub><mo id="alg1.l15.m1.1.1.2" stretchy="false" xref="alg1.l15.m1.1.1.2.cmml">←</mo><mrow id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><msub id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.3.2.cmml">n</mi><mi id="alg1.l15.m1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.3.3.cmml">t</mi></msub><mo id="alg1.l15.m1.1.1.1.2" xref="alg1.l15.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l15.m1.1.1.1.4" xref="alg1.l15.m1.1.1.1.4.cmml"><mi id="alg1.l15.m1.1.1.1.4.2" xref="alg1.l15.m1.1.1.1.4.2.cmml">γ</mi><mo id="alg1.l15.m1.1.1.1.4.1" xref="alg1.l15.m1.1.1.1.4.1.cmml">⁢</mo><msub id="alg1.l15.m1.1.1.1.4.3" xref="alg1.l15.m1.1.1.1.4.3.cmml"><mi id="alg1.l15.m1.1.1.1.4.3.2" xref="alg1.l15.m1.1.1.1.4.3.2.cmml">β</mi><mn id="alg1.l15.m1.1.1.1.4.3.3" xref="alg1.l15.m1.1.1.1.4.3.3.cmml">0</mn></msub></mrow><mo id="alg1.l15.m1.1.1.1.2a" xref="alg1.l15.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml"><mrow id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml"><mo id="alg1.l15.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml"><mn id="alg1.l15.m1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l15.m1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l15.m1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="alg1.l15.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l15.m1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.2.cmml">⁢</mo><msub id="alg1.l15.m1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.1.3.2.cmml">β</mi><mi id="alg1.l15.m1.1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.1.3.3.cmml">d</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">←</ci><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">𝛽</ci><ci id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3">𝑑</ci></apply><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><plus id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.2"></plus><apply id="alg1.l15.m1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.3.2">𝑛</ci><ci id="alg1.l15.m1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.3.3">𝑡</ci></apply><apply id="alg1.l15.m1.1.1.1.4.cmml" xref="alg1.l15.m1.1.1.1.4"><times id="alg1.l15.m1.1.1.1.4.1.cmml" xref="alg1.l15.m1.1.1.1.4.1"></times><ci id="alg1.l15.m1.1.1.1.4.2.cmml" xref="alg1.l15.m1.1.1.1.4.2">𝛾</ci><apply id="alg1.l15.m1.1.1.1.4.3.cmml" xref="alg1.l15.m1.1.1.1.4.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.4.3.1.cmml" xref="alg1.l15.m1.1.1.1.4.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.4.3.2.cmml" xref="alg1.l15.m1.1.1.1.4.3.2">𝛽</ci><cn id="alg1.l15.m1.1.1.1.4.3.3.cmml" type="integer" xref="alg1.l15.m1.1.1.1.4.3.3">0</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1"><times id="alg1.l15.m1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.2"></times><apply id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1"><minus id="alg1.l15.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1"></minus><cn id="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l15.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="alg1.l15.m1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.3.2">𝛽</ci><ci id="alg1.l15.m1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.3.3">𝑑</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\beta_{d}\leftarrow n_{t}+\gamma\beta_{0}+(1-\gamma)\beta_{d}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">italic_β start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ← italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ italic_β start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + ( 1 - italic_γ ) italic_β start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline">16:</span>     <span class="ltx_text ltx_font_bold" id="alg1.l16.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l16.2">for</span>
</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline">17:</span>  <span class="ltx_text ltx_font_bold" id="alg1.l17.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l17.2">for</span>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="Sx2.SSx4">
<h3 class="ltx_title ltx_title_subsection">Ranking Model Guided Online Learning</h3>
<div class="ltx_para" id="Sx2.SSx4.p1">
<p class="ltx_p" id="Sx2.SSx4.p1.3">Using the learned priors as our starting belief, we perform online learning to further refine this estimate to maximize the expected cumulative reward. We accomplish this through a Thompson sampling strategy to optimally balance between exploring new item recommendations and exploiting the information we gathered over time <cite class="ltx_cite ltx_citemacro_citep">(Russo et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib38" title="">2018</a>)</cite>. Thompson sampling consists of playing the action <math alttext="\boldsymbol{a}_{t}" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.1.m1.1"><semantics id="Sx2.SSx4.p1.1.m1.1a"><msub id="Sx2.SSx4.p1.1.m1.1.1" xref="Sx2.SSx4.p1.1.m1.1.1.cmml"><mi id="Sx2.SSx4.p1.1.m1.1.1.2" xref="Sx2.SSx4.p1.1.m1.1.1.2.cmml">𝒂</mi><mi id="Sx2.SSx4.p1.1.m1.1.1.3" xref="Sx2.SSx4.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.1.m1.1b"><apply id="Sx2.SSx4.p1.1.m1.1.1.cmml" xref="Sx2.SSx4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.1.m1.1.1.1.cmml" xref="Sx2.SSx4.p1.1.m1.1.1">subscript</csymbol><ci id="Sx2.SSx4.p1.1.m1.1.1.2.cmml" xref="Sx2.SSx4.p1.1.m1.1.1.2">𝒂</ci><ci id="Sx2.SSx4.p1.1.m1.1.1.3.cmml" xref="Sx2.SSx4.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.1.m1.1c">\boldsymbol{a}_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.1.m1.1d">bold_italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> according to the probability that it maximizes the expected reward at time <math alttext="t" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.2.m2.1"><semantics id="Sx2.SSx4.p1.2.m2.1a"><mi id="Sx2.SSx4.p1.2.m2.1.1" xref="Sx2.SSx4.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.2.m2.1b"><ci id="Sx2.SSx4.p1.2.m2.1.1.cmml" xref="Sx2.SSx4.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.2.m2.1d">italic_t</annotation></semantics></math>. Specifically, an action <math alttext="\hat{\boldsymbol{a}}_{t}" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.3.m3.1"><semantics id="Sx2.SSx4.p1.3.m3.1a"><msub id="Sx2.SSx4.p1.3.m3.1.1" xref="Sx2.SSx4.p1.3.m3.1.1.cmml"><mover accent="true" id="Sx2.SSx4.p1.3.m3.1.1.2" xref="Sx2.SSx4.p1.3.m3.1.1.2.cmml"><mi id="Sx2.SSx4.p1.3.m3.1.1.2.2" xref="Sx2.SSx4.p1.3.m3.1.1.2.2.cmml">𝒂</mi><mo id="Sx2.SSx4.p1.3.m3.1.1.2.1" xref="Sx2.SSx4.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="Sx2.SSx4.p1.3.m3.1.1.3" xref="Sx2.SSx4.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.3.m3.1b"><apply id="Sx2.SSx4.p1.3.m3.1.1.cmml" xref="Sx2.SSx4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.3.m3.1.1.1.cmml" xref="Sx2.SSx4.p1.3.m3.1.1">subscript</csymbol><apply id="Sx2.SSx4.p1.3.m3.1.1.2.cmml" xref="Sx2.SSx4.p1.3.m3.1.1.2"><ci id="Sx2.SSx4.p1.3.m3.1.1.2.1.cmml" xref="Sx2.SSx4.p1.3.m3.1.1.2.1">^</ci><ci id="Sx2.SSx4.p1.3.m3.1.1.2.2.cmml" xref="Sx2.SSx4.p1.3.m3.1.1.2.2">𝒂</ci></apply><ci id="Sx2.SSx4.p1.3.m3.1.1.3.cmml" xref="Sx2.SSx4.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.3.m3.1c">\hat{\boldsymbol{a}}_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.3.m3.1d">over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is chosen with probability</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}p(&amp;\hat{\boldsymbol{a}}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z}%
)=\\
&amp;\int{\mathds{1}\big{[}R(\boldsymbol{a}_{t}^{*},\boldsymbol{x}_{t})=\max_{%
\boldsymbol{a}_{t}}{R(\boldsymbol{a}_{t},\boldsymbol{x}_{t})}\big{]}p(%
\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})d\boldsymbol{x}_{t}},%
\end{split}" class="ltx_Math" display="block" id="Sx2.E9.m1.51"><semantics id="Sx2.E9.m1.51a"><mtable columnspacing="0pt" displaystyle="true" id="Sx2.E9.m1.51.51.2" rowspacing="0pt"><mtr id="Sx2.E9.m1.51.51.2a"><mtd class="ltx_align_right" columnalign="right" id="Sx2.E9.m1.51.51.2b"><mrow id="Sx2.E9.m1.2.2.2.2.2"><mi id="Sx2.E9.m1.1.1.1.1.1.1" xref="Sx2.E9.m1.1.1.1.1.1.1.cmml">p</mi><mo id="Sx2.E9.m1.2.2.2.2.2.2" stretchy="false" xref="Sx2.E9.m1.50.50.1.1.1.cmml">(</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E9.m1.51.51.2c"><mrow id="Sx2.E9.m1.11.11.11.11.9"><msub id="Sx2.E9.m1.11.11.11.11.9.10"><mover accent="true" id="Sx2.E9.m1.3.3.3.3.1.1" xref="Sx2.E9.m1.3.3.3.3.1.1.cmml"><mi id="Sx2.E9.m1.3.3.3.3.1.1.2" xref="Sx2.E9.m1.3.3.3.3.1.1.2.cmml">𝒂</mi><mo id="Sx2.E9.m1.3.3.3.3.1.1.1" xref="Sx2.E9.m1.3.3.3.3.1.1.1.cmml">^</mo></mover><mi id="Sx2.E9.m1.4.4.4.4.2.2.1" xref="Sx2.E9.m1.4.4.4.4.2.2.1.cmml">t</mi></msub><mo fence="false" id="Sx2.E9.m1.5.5.5.5.3.3" rspace="0.167em" stretchy="false" xref="Sx2.E9.m1.5.5.5.5.3.3.cmml">|</mo><msub id="Sx2.E9.m1.11.11.11.11.9.11"><mi id="Sx2.E9.m1.6.6.6.6.4.4" xref="Sx2.E9.m1.6.6.6.6.4.4.cmml">𝒙</mi><mrow id="Sx2.E9.m1.7.7.7.7.5.5.1" xref="Sx2.E9.m1.7.7.7.7.5.5.1.cmml"><mn id="Sx2.E9.m1.7.7.7.7.5.5.1.2" xref="Sx2.E9.m1.7.7.7.7.5.5.1.2.cmml">1</mn><mo id="Sx2.E9.m1.7.7.7.7.5.5.1.1" lspace="0.278em" rspace="0.278em" xref="Sx2.E9.m1.7.7.7.7.5.5.1.1.cmml">:</mo><mrow id="Sx2.E9.m1.7.7.7.7.5.5.1.3" xref="Sx2.E9.m1.7.7.7.7.5.5.1.3.cmml"><mi id="Sx2.E9.m1.7.7.7.7.5.5.1.3.2" xref="Sx2.E9.m1.7.7.7.7.5.5.1.3.2.cmml">t</mi><mo id="Sx2.E9.m1.7.7.7.7.5.5.1.3.1" xref="Sx2.E9.m1.7.7.7.7.5.5.1.3.1.cmml">−</mo><mn id="Sx2.E9.m1.7.7.7.7.5.5.1.3.3" xref="Sx2.E9.m1.7.7.7.7.5.5.1.3.3.cmml">1</mn></mrow></mrow></msub><mo id="Sx2.E9.m1.8.8.8.8.6.6" xref="Sx2.E9.m1.50.50.1.1.1.cmml">,</mo><mi id="Sx2.E9.m1.9.9.9.9.7.7" xref="Sx2.E9.m1.9.9.9.9.7.7.cmml">𝒛</mi><mo id="Sx2.E9.m1.10.10.10.10.8.8" stretchy="false" xref="Sx2.E9.m1.50.50.1.1.1.cmml">)</mo><mo id="Sx2.E9.m1.11.11.11.11.9.9" xref="Sx2.E9.m1.11.11.11.11.9.9.cmml">=</mo></mrow></mtd></mtr><mtr id="Sx2.E9.m1.51.51.2d"><mtd id="Sx2.E9.m1.51.51.2e" xref="Sx2.E9.m1.50.50.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="Sx2.E9.m1.51.51.2f"><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39"><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1"><mo id="Sx2.E9.m1.12.12.12.1.1.1" xref="Sx2.E9.m1.12.12.12.1.1.1.cmml">∫</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2"><mn id="Sx2.E9.m1.13.13.13.2.2.2" xref="Sx2.E9.m1.13.13.13.2.2.2.cmml">𝟙</mn><mo id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.3" xref="Sx2.E9.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1"><mo id="Sx2.E9.m1.14.14.14.3.3.3" maxsize="120%" minsize="120%" xref="Sx2.E9.m1.50.50.1.1.1.cmml">[</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1"><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.2"><mi id="Sx2.E9.m1.15.15.15.4.4.4" xref="Sx2.E9.m1.15.15.15.4.4.4.cmml">R</mi><mo id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.2.3" xref="Sx2.E9.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.2.2.2"><mo id="Sx2.E9.m1.16.16.16.5.5.5" stretchy="false" xref="Sx2.E9.m1.50.50.1.1.1.cmml">(</mo><msubsup id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.1.1.1.1"><mi id="Sx2.E9.m1.17.17.17.6.6.6" xref="Sx2.E9.m1.17.17.17.6.6.6.cmml">𝒂</mi><mi id="Sx2.E9.m1.18.18.18.7.7.7.1" xref="Sx2.E9.m1.18.18.18.7.7.7.1.cmml">t</mi><mo id="Sx2.E9.m1.19.19.19.8.8.8.1" xref="Sx2.E9.m1.19.19.19.8.8.8.1.cmml">∗</mo></msubsup><mo id="Sx2.E9.m1.20.20.20.9.9.9" xref="Sx2.E9.m1.50.50.1.1.1.cmml">,</mo><msub id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.2.2.2.2"><mi id="Sx2.E9.m1.21.21.21.10.10.10" xref="Sx2.E9.m1.21.21.21.10.10.10.cmml">𝒙</mi><mi id="Sx2.E9.m1.22.22.22.11.11.11.1" xref="Sx2.E9.m1.22.22.22.11.11.11.1.cmml">t</mi></msub><mo id="Sx2.E9.m1.23.23.23.12.12.12" stretchy="false" xref="Sx2.E9.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E9.m1.24.24.24.13.13.13" xref="Sx2.E9.m1.24.24.24.13.13.13.cmml">=</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.4"><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.4.4"><munder id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.4.4.1"><mi id="Sx2.E9.m1.25.25.25.14.14.14" xref="Sx2.E9.m1.25.25.25.14.14.14.cmml">max</mi><msub id="Sx2.E9.m1.26.26.26.15.15.15.1" xref="Sx2.E9.m1.26.26.26.15.15.15.1.cmml"><mi id="Sx2.E9.m1.26.26.26.15.15.15.1.2" xref="Sx2.E9.m1.26.26.26.15.15.15.1.2.cmml">𝒂</mi><mi id="Sx2.E9.m1.26.26.26.15.15.15.1.3" xref="Sx2.E9.m1.26.26.26.15.15.15.1.3.cmml">t</mi></msub></munder><mo id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.4.4a" lspace="0.167em" xref="Sx2.E9.m1.50.50.1.1.1.cmml">⁡</mo><mi id="Sx2.E9.m1.27.27.27.16.16.16" xref="Sx2.E9.m1.27.27.27.16.16.16.cmml">R</mi></mrow><mo id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.4.3" xref="Sx2.E9.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.4.2.2"><mo id="Sx2.E9.m1.28.28.28.17.17.17" stretchy="false" xref="Sx2.E9.m1.50.50.1.1.1.cmml">(</mo><msub id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.3.1.1.1"><mi id="Sx2.E9.m1.29.29.29.18.18.18" xref="Sx2.E9.m1.29.29.29.18.18.18.cmml">𝒂</mi><mi id="Sx2.E9.m1.30.30.30.19.19.19.1" xref="Sx2.E9.m1.30.30.30.19.19.19.1.cmml">t</mi></msub><mo id="Sx2.E9.m1.31.31.31.20.20.20" xref="Sx2.E9.m1.50.50.1.1.1.cmml">,</mo><msub id="Sx2.E9.m1.51.51.2.50.39.39.39.1.1.1.1.1.4.2.2.2"><mi id="Sx2.E9.m1.32.32.32.21.21.21" xref="Sx2.E9.m1.32.32.32.21.21.21.cmml">𝒙</mi><mi id="Sx2.E9.m1.33.33.33.22.22.22.1" xref="Sx2.E9.m1.33.33.33.22.22.22.1.cmml">t</mi></msub><mo id="Sx2.E9.m1.34.34.34.23.23.23" stretchy="false" xref="Sx2.E9.m1.50.50.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.E9.m1.35.35.35.24.24.24" maxsize="120%" minsize="120%" xref="Sx2.E9.m1.50.50.1.1.1.cmml">]</mo></mrow><mo id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.3a" xref="Sx2.E9.m1.50.50.1.1.1.cmml">⁢</mo><mi id="Sx2.E9.m1.36.36.36.25.25.25" xref="Sx2.E9.m1.36.36.36.25.25.25.cmml">p</mi><mo id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.3b" xref="Sx2.E9.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.2.1"><mo id="Sx2.E9.m1.37.37.37.26.26.26" stretchy="false" xref="Sx2.E9.m1.50.50.1.1.1.cmml">(</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.2.1.1"><msub id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.2.1.1.2"><mi id="Sx2.E9.m1.38.38.38.27.27.27" xref="Sx2.E9.m1.38.38.38.27.27.27.cmml">𝒙</mi><mi id="Sx2.E9.m1.39.39.39.28.28.28.1" xref="Sx2.E9.m1.39.39.39.28.28.28.1.cmml">t</mi></msub><mo fence="false" id="Sx2.E9.m1.40.40.40.29.29.29" xref="Sx2.E9.m1.40.40.40.29.29.29.cmml">|</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.2.1.1.1.1"><msub id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.2.1.1.1.1.1"><mi id="Sx2.E9.m1.41.41.41.30.30.30" xref="Sx2.E9.m1.41.41.41.30.30.30.cmml">𝒙</mi><mrow id="Sx2.E9.m1.42.42.42.31.31.31.1" xref="Sx2.E9.m1.42.42.42.31.31.31.1.cmml"><mn id="Sx2.E9.m1.42.42.42.31.31.31.1.2" xref="Sx2.E9.m1.42.42.42.31.31.31.1.2.cmml">1</mn><mo id="Sx2.E9.m1.42.42.42.31.31.31.1.1" lspace="0.278em" rspace="0.278em" xref="Sx2.E9.m1.42.42.42.31.31.31.1.1.cmml">:</mo><mrow id="Sx2.E9.m1.42.42.42.31.31.31.1.3" xref="Sx2.E9.m1.42.42.42.31.31.31.1.3.cmml"><mi id="Sx2.E9.m1.42.42.42.31.31.31.1.3.2" xref="Sx2.E9.m1.42.42.42.31.31.31.1.3.2.cmml">t</mi><mo id="Sx2.E9.m1.42.42.42.31.31.31.1.3.1" xref="Sx2.E9.m1.42.42.42.31.31.31.1.3.1.cmml">−</mo><mn id="Sx2.E9.m1.42.42.42.31.31.31.1.3.3" xref="Sx2.E9.m1.42.42.42.31.31.31.1.3.3.cmml">1</mn></mrow></mrow></msub><mo id="Sx2.E9.m1.43.43.43.32.32.32" xref="Sx2.E9.m1.50.50.1.1.1.cmml">,</mo><mi id="Sx2.E9.m1.44.44.44.33.33.33" xref="Sx2.E9.m1.44.44.44.33.33.33.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.E9.m1.45.45.45.34.34.34" stretchy="false" xref="Sx2.E9.m1.50.50.1.1.1.cmml">)</mo></mrow><mo id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.3c" lspace="0em" xref="Sx2.E9.m1.50.50.1.1.1.cmml">⁢</mo><mrow id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.4"><mo id="Sx2.E9.m1.46.46.46.35.35.35" rspace="0em" xref="Sx2.E9.m1.46.46.46.35.35.35.cmml">𝑑</mo><msub id="Sx2.E9.m1.51.51.2.50.39.39.39.1.2.4.1"><mi id="Sx2.E9.m1.47.47.47.36.36.36" xref="Sx2.E9.m1.47.47.47.36.36.36.cmml">𝒙</mi><mi id="Sx2.E9.m1.48.48.48.37.37.37.1" xref="Sx2.E9.m1.48.48.48.37.37.37.1.cmml">t</mi></msub></mrow></mrow></mrow><mo id="Sx2.E9.m1.49.49.49.38.38.38" xref="Sx2.E9.m1.50.50.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="Sx2.E9.m1.51b"><apply id="Sx2.E9.m1.50.50.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><eq id="Sx2.E9.m1.11.11.11.11.9.9.cmml" xref="Sx2.E9.m1.11.11.11.11.9.9"></eq><apply id="Sx2.E9.m1.50.50.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><times id="Sx2.E9.m1.50.50.1.1.1.1.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"></times><ci id="Sx2.E9.m1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.1.1.1.1.1.1">𝑝</ci><apply id="Sx2.E9.m1.50.50.1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><ci id="Sx2.E9.m1.5.5.5.5.3.3.cmml" xref="Sx2.E9.m1.5.5.5.5.3.3">|</ci><apply id="Sx2.E9.m1.50.50.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><apply id="Sx2.E9.m1.3.3.3.3.1.1.cmml" xref="Sx2.E9.m1.3.3.3.3.1.1"><ci id="Sx2.E9.m1.3.3.3.3.1.1.1.cmml" xref="Sx2.E9.m1.3.3.3.3.1.1.1">^</ci><ci id="Sx2.E9.m1.3.3.3.3.1.1.2.cmml" xref="Sx2.E9.m1.3.3.3.3.1.1.2">𝒂</ci></apply><ci id="Sx2.E9.m1.4.4.4.4.2.2.1.cmml" xref="Sx2.E9.m1.4.4.4.4.2.2.1">𝑡</ci></apply><list id="Sx2.E9.m1.50.50.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><apply id="Sx2.E9.m1.50.50.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.E9.m1.6.6.6.6.4.4.cmml" xref="Sx2.E9.m1.6.6.6.6.4.4">𝒙</ci><apply id="Sx2.E9.m1.7.7.7.7.5.5.1.cmml" xref="Sx2.E9.m1.7.7.7.7.5.5.1"><ci id="Sx2.E9.m1.7.7.7.7.5.5.1.1.cmml" xref="Sx2.E9.m1.7.7.7.7.5.5.1.1">:</ci><cn id="Sx2.E9.m1.7.7.7.7.5.5.1.2.cmml" type="integer" xref="Sx2.E9.m1.7.7.7.7.5.5.1.2">1</cn><apply id="Sx2.E9.m1.7.7.7.7.5.5.1.3.cmml" xref="Sx2.E9.m1.7.7.7.7.5.5.1.3"><minus id="Sx2.E9.m1.7.7.7.7.5.5.1.3.1.cmml" xref="Sx2.E9.m1.7.7.7.7.5.5.1.3.1"></minus><ci id="Sx2.E9.m1.7.7.7.7.5.5.1.3.2.cmml" xref="Sx2.E9.m1.7.7.7.7.5.5.1.3.2">𝑡</ci><cn id="Sx2.E9.m1.7.7.7.7.5.5.1.3.3.cmml" type="integer" xref="Sx2.E9.m1.7.7.7.7.5.5.1.3.3">1</cn></apply></apply></apply><ci id="Sx2.E9.m1.9.9.9.9.7.7.cmml" xref="Sx2.E9.m1.9.9.9.9.7.7">𝒛</ci></list></apply></apply><apply id="Sx2.E9.m1.50.50.1.1.1.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><int id="Sx2.E9.m1.12.12.12.1.1.1.cmml" xref="Sx2.E9.m1.12.12.12.1.1.1"></int><apply id="Sx2.E9.m1.50.50.1.1.1.3.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><times id="Sx2.E9.m1.50.50.1.1.1.3.2.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"></times><cn id="Sx2.E9.m1.13.13.13.2.2.2.cmml" type="integer" xref="Sx2.E9.m1.13.13.13.2.2.2">1</cn><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="latexml" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.2.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">delimited-[]</csymbol><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><eq id="Sx2.E9.m1.24.24.24.13.13.13.cmml" xref="Sx2.E9.m1.24.24.24.13.13.13"></eq><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><times id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.2.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"></times><ci id="Sx2.E9.m1.15.15.15.4.4.4.cmml" xref="Sx2.E9.m1.15.15.15.4.4.4">𝑅</ci><interval closure="open" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.2.2.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">superscript</csymbol><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.E9.m1.17.17.17.6.6.6.cmml" xref="Sx2.E9.m1.17.17.17.6.6.6">𝒂</ci><ci id="Sx2.E9.m1.18.18.18.7.7.7.1.cmml" xref="Sx2.E9.m1.18.18.18.7.7.7.1">𝑡</ci></apply><times id="Sx2.E9.m1.19.19.19.8.8.8.1.cmml" xref="Sx2.E9.m1.19.19.19.8.8.8.1"></times></apply><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.2.2.2.2.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.E9.m1.21.21.21.10.10.10.cmml" xref="Sx2.E9.m1.21.21.21.10.10.10">𝒙</ci><ci id="Sx2.E9.m1.22.22.22.11.11.11.1.cmml" xref="Sx2.E9.m1.22.22.22.11.11.11.1">𝑡</ci></apply></interval></apply><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.4.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><times id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.4.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"></times><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.4.4.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.4.4.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.4.4.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><max id="Sx2.E9.m1.25.25.25.14.14.14.cmml" xref="Sx2.E9.m1.25.25.25.14.14.14"></max><apply id="Sx2.E9.m1.26.26.26.15.15.15.1.cmml" xref="Sx2.E9.m1.26.26.26.15.15.15.1"><csymbol cd="ambiguous" id="Sx2.E9.m1.26.26.26.15.15.15.1.1.cmml" xref="Sx2.E9.m1.26.26.26.15.15.15.1">subscript</csymbol><ci id="Sx2.E9.m1.26.26.26.15.15.15.1.2.cmml" xref="Sx2.E9.m1.26.26.26.15.15.15.1.2">𝒂</ci><ci id="Sx2.E9.m1.26.26.26.15.15.15.1.3.cmml" xref="Sx2.E9.m1.26.26.26.15.15.15.1.3">𝑡</ci></apply></apply><ci id="Sx2.E9.m1.27.27.27.16.16.16.cmml" xref="Sx2.E9.m1.27.27.27.16.16.16">𝑅</ci></apply><interval closure="open" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.4.2.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.3.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.3.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.E9.m1.29.29.29.18.18.18.cmml" xref="Sx2.E9.m1.29.29.29.18.18.18">𝒂</ci><ci id="Sx2.E9.m1.30.30.30.19.19.19.1.cmml" xref="Sx2.E9.m1.30.30.30.19.19.19.1">𝑡</ci></apply><apply id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.4.2.2.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.2.1.1.1.1.4.2.2.2.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.E9.m1.32.32.32.21.21.21.cmml" xref="Sx2.E9.m1.32.32.32.21.21.21">𝒙</ci><ci id="Sx2.E9.m1.33.33.33.22.22.22.1.cmml" xref="Sx2.E9.m1.33.33.33.22.22.22.1">𝑡</ci></apply></interval></apply></apply></apply><ci id="Sx2.E9.m1.36.36.36.25.25.25.cmml" xref="Sx2.E9.m1.36.36.36.25.25.25">𝑝</ci><apply id="Sx2.E9.m1.50.50.1.1.1.3.2.2.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="latexml" id="Sx2.E9.m1.40.40.40.29.29.29.cmml" xref="Sx2.E9.m1.40.40.40.29.29.29">conditional</csymbol><apply id="Sx2.E9.m1.50.50.1.1.1.3.2.2.1.1.3.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.3.2.2.1.1.3.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.E9.m1.38.38.38.27.27.27.cmml" xref="Sx2.E9.m1.38.38.38.27.27.27">𝒙</ci><ci id="Sx2.E9.m1.39.39.39.28.28.28.1.cmml" xref="Sx2.E9.m1.39.39.39.28.28.28.1">𝑡</ci></apply><list id="Sx2.E9.m1.50.50.1.1.1.3.2.2.1.1.1.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><apply id="Sx2.E9.m1.50.50.1.1.1.3.2.2.1.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.3.2.2.1.1.1.1.1.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.E9.m1.41.41.41.30.30.30.cmml" xref="Sx2.E9.m1.41.41.41.30.30.30">𝒙</ci><apply id="Sx2.E9.m1.42.42.42.31.31.31.1.cmml" xref="Sx2.E9.m1.42.42.42.31.31.31.1"><ci id="Sx2.E9.m1.42.42.42.31.31.31.1.1.cmml" xref="Sx2.E9.m1.42.42.42.31.31.31.1.1">:</ci><cn id="Sx2.E9.m1.42.42.42.31.31.31.1.2.cmml" type="integer" xref="Sx2.E9.m1.42.42.42.31.31.31.1.2">1</cn><apply id="Sx2.E9.m1.42.42.42.31.31.31.1.3.cmml" xref="Sx2.E9.m1.42.42.42.31.31.31.1.3"><minus id="Sx2.E9.m1.42.42.42.31.31.31.1.3.1.cmml" xref="Sx2.E9.m1.42.42.42.31.31.31.1.3.1"></minus><ci id="Sx2.E9.m1.42.42.42.31.31.31.1.3.2.cmml" xref="Sx2.E9.m1.42.42.42.31.31.31.1.3.2">𝑡</ci><cn id="Sx2.E9.m1.42.42.42.31.31.31.1.3.3.cmml" type="integer" xref="Sx2.E9.m1.42.42.42.31.31.31.1.3.3">1</cn></apply></apply></apply><ci id="Sx2.E9.m1.44.44.44.33.33.33.cmml" xref="Sx2.E9.m1.44.44.44.33.33.33">𝒛</ci></list></apply><apply id="Sx2.E9.m1.50.50.1.1.1.3.2.6.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="latexml" id="Sx2.E9.m1.46.46.46.35.35.35.cmml" xref="Sx2.E9.m1.46.46.46.35.35.35">differential-d</csymbol><apply id="Sx2.E9.m1.50.50.1.1.1.3.2.6.2.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E9.m1.50.50.1.1.1.3.2.6.2.1.cmml" xref="Sx2.E9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.E9.m1.47.47.47.36.36.36.cmml" xref="Sx2.E9.m1.47.47.47.36.36.36">𝒙</ci><ci id="Sx2.E9.m1.48.48.48.37.37.37.1.cmml" xref="Sx2.E9.m1.48.48.48.37.37.37.1">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E9.m1.51c">\begin{split}p(&amp;\hat{\boldsymbol{a}}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z}%
)=\\
&amp;\int{\mathds{1}\big{[}R(\boldsymbol{a}_{t}^{*},\boldsymbol{x}_{t})=\max_{%
\boldsymbol{a}_{t}}{R(\boldsymbol{a}_{t},\boldsymbol{x}_{t})}\big{]}p(%
\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})d\boldsymbol{x}_{t}},%
\end{split}</annotation><annotation encoding="application/x-llamapun" id="Sx2.E9.m1.51d">start_ROW start_CELL italic_p ( end_CELL start_CELL over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_z ) = end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL ∫ blackboard_1 [ italic_R ( bold_italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = roman_max start_POSTSUBSCRIPT bold_italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_R ( bold_italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) ] italic_p ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_z ) italic_d bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx4.p1.11">where <math alttext="R(\boldsymbol{a},\boldsymbol{x})" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.4.m1.2"><semantics id="Sx2.SSx4.p1.4.m1.2a"><mrow id="Sx2.SSx4.p1.4.m1.2.3" xref="Sx2.SSx4.p1.4.m1.2.3.cmml"><mi id="Sx2.SSx4.p1.4.m1.2.3.2" xref="Sx2.SSx4.p1.4.m1.2.3.2.cmml">R</mi><mo id="Sx2.SSx4.p1.4.m1.2.3.1" xref="Sx2.SSx4.p1.4.m1.2.3.1.cmml">⁢</mo><mrow id="Sx2.SSx4.p1.4.m1.2.3.3.2" xref="Sx2.SSx4.p1.4.m1.2.3.3.1.cmml"><mo id="Sx2.SSx4.p1.4.m1.2.3.3.2.1" stretchy="false" xref="Sx2.SSx4.p1.4.m1.2.3.3.1.cmml">(</mo><mi id="Sx2.SSx4.p1.4.m1.1.1" xref="Sx2.SSx4.p1.4.m1.1.1.cmml">𝒂</mi><mo id="Sx2.SSx4.p1.4.m1.2.3.3.2.2" xref="Sx2.SSx4.p1.4.m1.2.3.3.1.cmml">,</mo><mi id="Sx2.SSx4.p1.4.m1.2.2" xref="Sx2.SSx4.p1.4.m1.2.2.cmml">𝒙</mi><mo id="Sx2.SSx4.p1.4.m1.2.3.3.2.3" stretchy="false" xref="Sx2.SSx4.p1.4.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.4.m1.2b"><apply id="Sx2.SSx4.p1.4.m1.2.3.cmml" xref="Sx2.SSx4.p1.4.m1.2.3"><times id="Sx2.SSx4.p1.4.m1.2.3.1.cmml" xref="Sx2.SSx4.p1.4.m1.2.3.1"></times><ci id="Sx2.SSx4.p1.4.m1.2.3.2.cmml" xref="Sx2.SSx4.p1.4.m1.2.3.2">𝑅</ci><interval closure="open" id="Sx2.SSx4.p1.4.m1.2.3.3.1.cmml" xref="Sx2.SSx4.p1.4.m1.2.3.3.2"><ci id="Sx2.SSx4.p1.4.m1.1.1.cmml" xref="Sx2.SSx4.p1.4.m1.1.1">𝒂</ci><ci id="Sx2.SSx4.p1.4.m1.2.2.cmml" xref="Sx2.SSx4.p1.4.m1.2.2">𝒙</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.4.m1.2c">R(\boldsymbol{a},\boldsymbol{x})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.4.m1.2d">italic_R ( bold_italic_a , bold_italic_x )</annotation></semantics></math> is the reward function of taking action <math alttext="\boldsymbol{a}" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.5.m2.1"><semantics id="Sx2.SSx4.p1.5.m2.1a"><mi id="Sx2.SSx4.p1.5.m2.1.1" xref="Sx2.SSx4.p1.5.m2.1.1.cmml">𝒂</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.5.m2.1b"><ci id="Sx2.SSx4.p1.5.m2.1.1.cmml" xref="Sx2.SSx4.p1.5.m2.1.1">𝒂</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.5.m2.1c">\boldsymbol{a}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.5.m2.1d">bold_italic_a</annotation></semantics></math> given context <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.6.m3.1"><semantics id="Sx2.SSx4.p1.6.m3.1a"><mi id="Sx2.SSx4.p1.6.m3.1.1" xref="Sx2.SSx4.p1.6.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.6.m3.1b"><ci id="Sx2.SSx4.p1.6.m3.1.1.cmml" xref="Sx2.SSx4.p1.6.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.6.m3.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.6.m3.1d">bold_italic_x</annotation></semantics></math>. In our case, we are interested in estimating user interactions features based on previously seen information. To this end, our action space is defined to be the space of predictions of the user interactions, while our context corresponds to the user interactions <math alttext="\boldsymbol{x}" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.7.m4.1"><semantics id="Sx2.SSx4.p1.7.m4.1a"><mi id="Sx2.SSx4.p1.7.m4.1.1" xref="Sx2.SSx4.p1.7.m4.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.7.m4.1b"><ci id="Sx2.SSx4.p1.7.m4.1.1.cmml" xref="Sx2.SSx4.p1.7.m4.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.7.m4.1c">\boldsymbol{x}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.7.m4.1d">bold_italic_x</annotation></semantics></math> themselves. We then let <math alttext="R(\boldsymbol{a}_{t},\boldsymbol{x}_{t})=\mathds{1}[\boldsymbol{a}_{t}=%
\boldsymbol{x}_{t}]" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.8.m5.3"><semantics id="Sx2.SSx4.p1.8.m5.3a"><mrow id="Sx2.SSx4.p1.8.m5.3.3" xref="Sx2.SSx4.p1.8.m5.3.3.cmml"><mrow id="Sx2.SSx4.p1.8.m5.2.2.2" xref="Sx2.SSx4.p1.8.m5.2.2.2.cmml"><mi id="Sx2.SSx4.p1.8.m5.2.2.2.4" xref="Sx2.SSx4.p1.8.m5.2.2.2.4.cmml">R</mi><mo id="Sx2.SSx4.p1.8.m5.2.2.2.3" xref="Sx2.SSx4.p1.8.m5.2.2.2.3.cmml">⁢</mo><mrow id="Sx2.SSx4.p1.8.m5.2.2.2.2.2" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.3.cmml"><mo id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.3" stretchy="false" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.3.cmml">(</mo><msub id="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1" xref="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.cmml"><mi id="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.2" xref="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.2.cmml">𝒂</mi><mi id="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.3" xref="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.4" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.3.cmml">,</mo><msub id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.cmml"><mi id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.2" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.2.cmml">𝒙</mi><mi id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.3" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.3.cmml">t</mi></msub><mo id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.5" stretchy="false" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx4.p1.8.m5.3.3.4" xref="Sx2.SSx4.p1.8.m5.3.3.4.cmml">=</mo><mrow id="Sx2.SSx4.p1.8.m5.3.3.3" xref="Sx2.SSx4.p1.8.m5.3.3.3.cmml"><mn id="Sx2.SSx4.p1.8.m5.3.3.3.3" xref="Sx2.SSx4.p1.8.m5.3.3.3.3.cmml">𝟙</mn><mo id="Sx2.SSx4.p1.8.m5.3.3.3.2" xref="Sx2.SSx4.p1.8.m5.3.3.3.2.cmml">⁢</mo><mrow id="Sx2.SSx4.p1.8.m5.3.3.3.1.1" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.2.cmml"><mo id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.2" stretchy="false" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.2.1.cmml">[</mo><mrow id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.cmml"><msub id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.cmml"><mi id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.2" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.2.cmml">𝒂</mi><mi id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.3" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.3.cmml">t</mi></msub><mo id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.1" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.1.cmml">=</mo><msub id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.cmml"><mi id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.2" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.2.cmml">𝒙</mi><mi id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.3" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.3" stretchy="false" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.8.m5.3b"><apply id="Sx2.SSx4.p1.8.m5.3.3.cmml" xref="Sx2.SSx4.p1.8.m5.3.3"><eq id="Sx2.SSx4.p1.8.m5.3.3.4.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.4"></eq><apply id="Sx2.SSx4.p1.8.m5.2.2.2.cmml" xref="Sx2.SSx4.p1.8.m5.2.2.2"><times id="Sx2.SSx4.p1.8.m5.2.2.2.3.cmml" xref="Sx2.SSx4.p1.8.m5.2.2.2.3"></times><ci id="Sx2.SSx4.p1.8.m5.2.2.2.4.cmml" xref="Sx2.SSx4.p1.8.m5.2.2.2.4">𝑅</ci><interval closure="open" id="Sx2.SSx4.p1.8.m5.2.2.2.2.3.cmml" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.2"><apply id="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.2">𝒂</ci><ci id="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx4.p1.8.m5.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.cmml" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.1.cmml" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2">subscript</csymbol><ci id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.2.cmml" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.2">𝒙</ci><ci id="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.3.cmml" xref="Sx2.SSx4.p1.8.m5.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="Sx2.SSx4.p1.8.m5.3.3.3.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3"><times id="Sx2.SSx4.p1.8.m5.3.3.3.2.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.2"></times><cn id="Sx2.SSx4.p1.8.m5.3.3.3.3.cmml" type="integer" xref="Sx2.SSx4.p1.8.m5.3.3.3.3">1</cn><apply id="Sx2.SSx4.p1.8.m5.3.3.3.1.2.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1"><csymbol cd="latexml" id="Sx2.SSx4.p1.8.m5.3.3.3.1.2.1.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.2">delimited-[]</csymbol><apply id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1"><eq id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.1.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.1"></eq><apply id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.1.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.2.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.2">𝒂</ci><ci id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.3.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.2.3">𝑡</ci></apply><apply id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.1.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.2.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.2">𝒙</ci><ci id="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.3.cmml" xref="Sx2.SSx4.p1.8.m5.3.3.3.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.8.m5.3c">R(\boldsymbol{a}_{t},\boldsymbol{x}_{t})=\mathds{1}[\boldsymbol{a}_{t}=%
\boldsymbol{x}_{t}]</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.8.m5.3d">italic_R ( bold_italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = blackboard_1 [ bold_italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ]</annotation></semantics></math>, rewarding the model for accurately predicting the features <math alttext="\boldsymbol{x}_{t}" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.9.m6.1"><semantics id="Sx2.SSx4.p1.9.m6.1a"><msub id="Sx2.SSx4.p1.9.m6.1.1" xref="Sx2.SSx4.p1.9.m6.1.1.cmml"><mi id="Sx2.SSx4.p1.9.m6.1.1.2" xref="Sx2.SSx4.p1.9.m6.1.1.2.cmml">𝒙</mi><mi id="Sx2.SSx4.p1.9.m6.1.1.3" xref="Sx2.SSx4.p1.9.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.9.m6.1b"><apply id="Sx2.SSx4.p1.9.m6.1.1.cmml" xref="Sx2.SSx4.p1.9.m6.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.9.m6.1.1.1.cmml" xref="Sx2.SSx4.p1.9.m6.1.1">subscript</csymbol><ci id="Sx2.SSx4.p1.9.m6.1.1.2.cmml" xref="Sx2.SSx4.p1.9.m6.1.1.2">𝒙</ci><ci id="Sx2.SSx4.p1.9.m6.1.1.3.cmml" xref="Sx2.SSx4.p1.9.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.9.m6.1c">\boldsymbol{x}_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.9.m6.1d">bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. With this formulation, the probability of choosing an action <math alttext="\hat{\boldsymbol{a}}_{t}" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.10.m7.1"><semantics id="Sx2.SSx4.p1.10.m7.1a"><msub id="Sx2.SSx4.p1.10.m7.1.1" xref="Sx2.SSx4.p1.10.m7.1.1.cmml"><mover accent="true" id="Sx2.SSx4.p1.10.m7.1.1.2" xref="Sx2.SSx4.p1.10.m7.1.1.2.cmml"><mi id="Sx2.SSx4.p1.10.m7.1.1.2.2" xref="Sx2.SSx4.p1.10.m7.1.1.2.2.cmml">𝒂</mi><mo id="Sx2.SSx4.p1.10.m7.1.1.2.1" xref="Sx2.SSx4.p1.10.m7.1.1.2.1.cmml">^</mo></mover><mi id="Sx2.SSx4.p1.10.m7.1.1.3" xref="Sx2.SSx4.p1.10.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.10.m7.1b"><apply id="Sx2.SSx4.p1.10.m7.1.1.cmml" xref="Sx2.SSx4.p1.10.m7.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.10.m7.1.1.1.cmml" xref="Sx2.SSx4.p1.10.m7.1.1">subscript</csymbol><apply id="Sx2.SSx4.p1.10.m7.1.1.2.cmml" xref="Sx2.SSx4.p1.10.m7.1.1.2"><ci id="Sx2.SSx4.p1.10.m7.1.1.2.1.cmml" xref="Sx2.SSx4.p1.10.m7.1.1.2.1">^</ci><ci id="Sx2.SSx4.p1.10.m7.1.1.2.2.cmml" xref="Sx2.SSx4.p1.10.m7.1.1.2.2">𝒂</ci></apply><ci id="Sx2.SSx4.p1.10.m7.1.1.3.cmml" xref="Sx2.SSx4.p1.10.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.10.m7.1c">\hat{\boldsymbol{a}}_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.10.m7.1d">over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> simplifies to <math alttext="p(\hat{\boldsymbol{a}}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})=p(%
\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx4.p1.11.m8.4"><semantics id="Sx2.SSx4.p1.11.m8.4a"><mrow id="Sx2.SSx4.p1.11.m8.4.4" xref="Sx2.SSx4.p1.11.m8.4.4.cmml"><mrow id="Sx2.SSx4.p1.11.m8.3.3.1" xref="Sx2.SSx4.p1.11.m8.3.3.1.cmml"><mi id="Sx2.SSx4.p1.11.m8.3.3.1.3" xref="Sx2.SSx4.p1.11.m8.3.3.1.3.cmml">p</mi><mo id="Sx2.SSx4.p1.11.m8.3.3.1.2" xref="Sx2.SSx4.p1.11.m8.3.3.1.2.cmml">⁢</mo><mrow id="Sx2.SSx4.p1.11.m8.3.3.1.1.1" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.cmml"><mo id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.2" stretchy="false" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.cmml"><msub id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.cmml"><mover accent="true" id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.cmml"><mi id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.2" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.2.cmml">𝒂</mi><mo id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.1" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.3" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.2" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.2.cmml">|</mo><mrow id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.2.cmml"><msub id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.cmml"><mi id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.2" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.cmml"><mn id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.2" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.2" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.1" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.3" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.2" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="Sx2.SSx4.p1.11.m8.1.1" xref="Sx2.SSx4.p1.11.m8.1.1.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.3" stretchy="false" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx4.p1.11.m8.4.4.3" xref="Sx2.SSx4.p1.11.m8.4.4.3.cmml">=</mo><mrow id="Sx2.SSx4.p1.11.m8.4.4.2" xref="Sx2.SSx4.p1.11.m8.4.4.2.cmml"><mi id="Sx2.SSx4.p1.11.m8.4.4.2.3" xref="Sx2.SSx4.p1.11.m8.4.4.2.3.cmml">p</mi><mo id="Sx2.SSx4.p1.11.m8.4.4.2.2" xref="Sx2.SSx4.p1.11.m8.4.4.2.2.cmml">⁢</mo><mrow id="Sx2.SSx4.p1.11.m8.4.4.2.1.1" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.cmml"><mo id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.2" stretchy="false" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.cmml">(</mo><mrow id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.cmml"><msub id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.cmml"><mi id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.2" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.2.cmml">𝒙</mi><mi id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.3" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.2" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.2.cmml">|</mo><mrow id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.2.cmml"><msub id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.cmml"><mi id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.2" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.cmml"><mn id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.2" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.2" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.1" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.3" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.2" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.2.cmml">,</mo><mi id="Sx2.SSx4.p1.11.m8.2.2" xref="Sx2.SSx4.p1.11.m8.2.2.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.3" stretchy="false" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p1.11.m8.4b"><apply id="Sx2.SSx4.p1.11.m8.4.4.cmml" xref="Sx2.SSx4.p1.11.m8.4.4"><eq id="Sx2.SSx4.p1.11.m8.4.4.3.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.3"></eq><apply id="Sx2.SSx4.p1.11.m8.3.3.1.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1"><times id="Sx2.SSx4.p1.11.m8.3.3.1.2.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.2"></times><ci id="Sx2.SSx4.p1.11.m8.3.3.1.3.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.3">𝑝</ci><apply id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1"><csymbol cd="latexml" id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.2.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.2">conditional</csymbol><apply id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.1.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3">subscript</csymbol><apply id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2"><ci id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.1.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.1">^</ci><ci id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.2.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.2.2">𝒂</ci></apply><ci id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.3.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.3.3">𝑡</ci></apply><list id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.2.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1"><apply id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.2">𝒙</ci><apply id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3"><ci id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.1">:</ci><cn id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.2">1</cn><apply id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3"><minus id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.1"></minus><ci id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.SSx4.p1.11.m8.3.3.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="Sx2.SSx4.p1.11.m8.1.1.cmml" xref="Sx2.SSx4.p1.11.m8.1.1">𝒛</ci></list></apply></apply><apply id="Sx2.SSx4.p1.11.m8.4.4.2.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2"><times id="Sx2.SSx4.p1.11.m8.4.4.2.2.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.2"></times><ci id="Sx2.SSx4.p1.11.m8.4.4.2.3.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.3">𝑝</ci><apply id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1"><csymbol cd="latexml" id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.2.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.2">conditional</csymbol><apply id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.1.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.2.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.2">𝒙</ci><ci id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.3.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.3.3">𝑡</ci></apply><list id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.2.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1"><apply id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.2">𝒙</ci><apply id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3"><ci id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.1">:</ci><cn id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.2">1</cn><apply id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3"><minus id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.1"></minus><ci id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.SSx4.p1.11.m8.4.4.2.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="Sx2.SSx4.p1.11.m8.2.2.cmml" xref="Sx2.SSx4.p1.11.m8.2.2">𝒛</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p1.11.m8.4c">p(\hat{\boldsymbol{a}}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})=p(%
\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p1.11.m8.4d">italic_p ( over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_z ) = italic_p ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_z )</annotation></semantics></math>.</p>
</div>
<figure class="ltx_figure" id="Sx2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="560" id="Sx2.F2.g1" src="x3.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Click-through Rate (CTR (%)) comparison of different approaches in simulated environments with varying predictive power (<math alttext="w" class="ltx_Math" display="inline" id="Sx2.F2.2.m1.1"><semantics id="Sx2.F2.2.m1.1b"><mi id="Sx2.F2.2.m1.1.1" xref="Sx2.F2.2.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="Sx2.F2.2.m1.1c"><ci id="Sx2.F2.2.m1.1.1.cmml" xref="Sx2.F2.2.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.F2.2.m1.1d">w</annotation><annotation encoding="application/x-llamapun" id="Sx2.F2.2.m1.1e">italic_w</annotation></semantics></math>).</figcaption>
</figure>
<figure class="ltx_figure" id="Sx2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="311" id="Sx2.F3.g1" src="x4.png" width="823"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Click-through Rate (CTR (%)) rewards per time step of different methods measured in a simulated non-stationary environment. We ablate our method (Bayesian Nonstationary), removing the non-stationary assumption (Bayesian Stationary), and removing the use of user interaction features (Non-behavioral).</figcaption>
</figure>
<div class="ltx_para" id="Sx2.SSx4.p2">
<p class="ltx_p" id="Sx2.SSx4.p2.6">Using this formulation, we sample <math alttext="\hat{\boldsymbol{a}}_{t}\sim p(\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},%
\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx4.p2.1.m1.2"><semantics id="Sx2.SSx4.p2.1.m1.2a"><mrow id="Sx2.SSx4.p2.1.m1.2.2" xref="Sx2.SSx4.p2.1.m1.2.2.cmml"><msub id="Sx2.SSx4.p2.1.m1.2.2.3" xref="Sx2.SSx4.p2.1.m1.2.2.3.cmml"><mover accent="true" id="Sx2.SSx4.p2.1.m1.2.2.3.2" xref="Sx2.SSx4.p2.1.m1.2.2.3.2.cmml"><mi id="Sx2.SSx4.p2.1.m1.2.2.3.2.2" xref="Sx2.SSx4.p2.1.m1.2.2.3.2.2.cmml">𝒂</mi><mo id="Sx2.SSx4.p2.1.m1.2.2.3.2.1" xref="Sx2.SSx4.p2.1.m1.2.2.3.2.1.cmml">^</mo></mover><mi id="Sx2.SSx4.p2.1.m1.2.2.3.3" xref="Sx2.SSx4.p2.1.m1.2.2.3.3.cmml">t</mi></msub><mo id="Sx2.SSx4.p2.1.m1.2.2.2" xref="Sx2.SSx4.p2.1.m1.2.2.2.cmml">∼</mo><mrow id="Sx2.SSx4.p2.1.m1.2.2.1" xref="Sx2.SSx4.p2.1.m1.2.2.1.cmml"><mi id="Sx2.SSx4.p2.1.m1.2.2.1.3" xref="Sx2.SSx4.p2.1.m1.2.2.1.3.cmml">p</mi><mo id="Sx2.SSx4.p2.1.m1.2.2.1.2" xref="Sx2.SSx4.p2.1.m1.2.2.1.2.cmml">⁢</mo><mrow id="Sx2.SSx4.p2.1.m1.2.2.1.1.1" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.cmml"><mo id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.2" stretchy="false" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.cmml"><msub id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.cmml"><mi id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.2" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.2.cmml">𝒙</mi><mi id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.3" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.2" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.2.cmml">|</mo><mrow id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.2.cmml"><msub id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.2" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mn id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.2" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.2" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.1" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.3" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.2" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="Sx2.SSx4.p2.1.m1.1.1" xref="Sx2.SSx4.p2.1.m1.1.1.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.3" stretchy="false" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p2.1.m1.2b"><apply id="Sx2.SSx4.p2.1.m1.2.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2"><csymbol cd="latexml" id="Sx2.SSx4.p2.1.m1.2.2.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.2">similar-to</csymbol><apply id="Sx2.SSx4.p2.1.m1.2.2.3.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.3"><csymbol cd="ambiguous" id="Sx2.SSx4.p2.1.m1.2.2.3.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.3">subscript</csymbol><apply id="Sx2.SSx4.p2.1.m1.2.2.3.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.3.2"><ci id="Sx2.SSx4.p2.1.m1.2.2.3.2.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.3.2.1">^</ci><ci id="Sx2.SSx4.p2.1.m1.2.2.3.2.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.3.2.2">𝒂</ci></apply><ci id="Sx2.SSx4.p2.1.m1.2.2.3.3.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.3.3">𝑡</ci></apply><apply id="Sx2.SSx4.p2.1.m1.2.2.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1"><times id="Sx2.SSx4.p2.1.m1.2.2.1.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.2"></times><ci id="Sx2.SSx4.p2.1.m1.2.2.1.3.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.3">𝑝</ci><apply id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1"><csymbol cd="latexml" id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.2">conditional</csymbol><apply id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.2">𝒙</ci><ci id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.3.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply><list id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1"><apply id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.2">𝒙</ci><apply id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3"><ci id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.1">:</ci><cn id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.2">1</cn><apply id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3"><minus id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.SSx4.p2.1.m1.2.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="Sx2.SSx4.p2.1.m1.1.1.cmml" xref="Sx2.SSx4.p2.1.m1.1.1">𝒛</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p2.1.m1.2c">\hat{\boldsymbol{a}}_{t}\sim p(\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},%
\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p2.1.m1.2d">over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ∼ italic_p ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_z )</annotation></semantics></math> as estimates of the user interaction features. These estimates are given to the ranking model <math alttext="p_{\boldsymbol{\psi}}(c|\hat{\boldsymbol{a}}_{t},\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx4.p2.2.m2.2"><semantics id="Sx2.SSx4.p2.2.m2.2a"><mrow id="Sx2.SSx4.p2.2.m2.2.2" xref="Sx2.SSx4.p2.2.m2.2.2.cmml"><msub id="Sx2.SSx4.p2.2.m2.2.2.3" xref="Sx2.SSx4.p2.2.m2.2.2.3.cmml"><mi id="Sx2.SSx4.p2.2.m2.2.2.3.2" xref="Sx2.SSx4.p2.2.m2.2.2.3.2.cmml">p</mi><mi id="Sx2.SSx4.p2.2.m2.2.2.3.3" xref="Sx2.SSx4.p2.2.m2.2.2.3.3.cmml">𝝍</mi></msub><mo id="Sx2.SSx4.p2.2.m2.2.2.2" xref="Sx2.SSx4.p2.2.m2.2.2.2.cmml">⁢</mo><mrow id="Sx2.SSx4.p2.2.m2.2.2.1.1" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.cmml"><mo id="Sx2.SSx4.p2.2.m2.2.2.1.1.2" stretchy="false" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="Sx2.SSx4.p2.2.m2.2.2.1.1.1" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.cmml"><mi id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.3" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.3.cmml">c</mi><mo fence="false" id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.2" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.2.cmml">|</mo><mrow id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.2.cmml"><msub id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.cmml"><mover accent="true" id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.cmml"><mi id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.2" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.2.cmml">𝒂</mi><mo id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.1" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.3" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.2" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.2.cmml">,</mo><mi id="Sx2.SSx4.p2.2.m2.1.1" xref="Sx2.SSx4.p2.2.m2.1.1.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.SSx4.p2.2.m2.2.2.1.1.3" stretchy="false" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p2.2.m2.2b"><apply id="Sx2.SSx4.p2.2.m2.2.2.cmml" xref="Sx2.SSx4.p2.2.m2.2.2"><times id="Sx2.SSx4.p2.2.m2.2.2.2.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.2"></times><apply id="Sx2.SSx4.p2.2.m2.2.2.3.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.3"><csymbol cd="ambiguous" id="Sx2.SSx4.p2.2.m2.2.2.3.1.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.3">subscript</csymbol><ci id="Sx2.SSx4.p2.2.m2.2.2.3.2.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.3.2">𝑝</ci><ci id="Sx2.SSx4.p2.2.m2.2.2.3.3.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.3.3">𝝍</ci></apply><apply id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1"><csymbol cd="latexml" id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.2.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.2">conditional</csymbol><ci id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.3.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.3">𝑐</ci><list id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1"><apply id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2"><ci id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.1">^</ci><ci id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.2.2">𝒂</ci></apply><ci id="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx4.p2.2.m2.2.2.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="Sx2.SSx4.p2.2.m2.1.1.cmml" xref="Sx2.SSx4.p2.2.m2.1.1">𝒛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p2.2.m2.2c">p_{\boldsymbol{\psi}}(c|\hat{\boldsymbol{a}}_{t},\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p2.2.m2.2d">italic_p start_POSTSUBSCRIPT bold_italic_ψ end_POSTSUBSCRIPT ( italic_c | over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , bold_italic_z )</annotation></semantics></math>, which scores items according to the estimated features <math alttext="\hat{\boldsymbol{a}}_{t}" class="ltx_Math" display="inline" id="Sx2.SSx4.p2.3.m3.1"><semantics id="Sx2.SSx4.p2.3.m3.1a"><msub id="Sx2.SSx4.p2.3.m3.1.1" xref="Sx2.SSx4.p2.3.m3.1.1.cmml"><mover accent="true" id="Sx2.SSx4.p2.3.m3.1.1.2" xref="Sx2.SSx4.p2.3.m3.1.1.2.cmml"><mi id="Sx2.SSx4.p2.3.m3.1.1.2.2" xref="Sx2.SSx4.p2.3.m3.1.1.2.2.cmml">𝒂</mi><mo id="Sx2.SSx4.p2.3.m3.1.1.2.1" xref="Sx2.SSx4.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="Sx2.SSx4.p2.3.m3.1.1.3" xref="Sx2.SSx4.p2.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p2.3.m3.1b"><apply id="Sx2.SSx4.p2.3.m3.1.1.cmml" xref="Sx2.SSx4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p2.3.m3.1.1.1.cmml" xref="Sx2.SSx4.p2.3.m3.1.1">subscript</csymbol><apply id="Sx2.SSx4.p2.3.m3.1.1.2.cmml" xref="Sx2.SSx4.p2.3.m3.1.1.2"><ci id="Sx2.SSx4.p2.3.m3.1.1.2.1.cmml" xref="Sx2.SSx4.p2.3.m3.1.1.2.1">^</ci><ci id="Sx2.SSx4.p2.3.m3.1.1.2.2.cmml" xref="Sx2.SSx4.p2.3.m3.1.1.2.2">𝒂</ci></apply><ci id="Sx2.SSx4.p2.3.m3.1.1.3.cmml" xref="Sx2.SSx4.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p2.3.m3.1c">\hat{\boldsymbol{a}}_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p2.3.m3.1d">over^ start_ARG bold_italic_a end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and the contextual features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx4.p2.4.m4.1"><semantics id="Sx2.SSx4.p2.4.m4.1a"><mi id="Sx2.SSx4.p2.4.m4.1.1" xref="Sx2.SSx4.p2.4.m4.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p2.4.m4.1b"><ci id="Sx2.SSx4.p2.4.m4.1.1.cmml" xref="Sx2.SSx4.p2.4.m4.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p2.4.m4.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p2.4.m4.1d">bold_italic_z</annotation></semantics></math>. This enables us to perform ranking-guided online learning. Guided by the ranking model with contextual information <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx4.p2.5.m5.1"><semantics id="Sx2.SSx4.p2.5.m5.1a"><mi id="Sx2.SSx4.p2.5.m5.1.1" xref="Sx2.SSx4.p2.5.m5.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p2.5.m5.1b"><ci id="Sx2.SSx4.p2.5.m5.1.1.cmml" xref="Sx2.SSx4.p2.5.m5.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p2.5.m5.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p2.5.m5.1d">bold_italic_z</annotation></semantics></math>, we are able to explore rankings of relevant items to recommend by sampling from the posterior distribution <math alttext="p(\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx4.p2.6.m6.2"><semantics id="Sx2.SSx4.p2.6.m6.2a"><mrow id="Sx2.SSx4.p2.6.m6.2.2" xref="Sx2.SSx4.p2.6.m6.2.2.cmml"><mi id="Sx2.SSx4.p2.6.m6.2.2.3" xref="Sx2.SSx4.p2.6.m6.2.2.3.cmml">p</mi><mo id="Sx2.SSx4.p2.6.m6.2.2.2" xref="Sx2.SSx4.p2.6.m6.2.2.2.cmml">⁢</mo><mrow id="Sx2.SSx4.p2.6.m6.2.2.1.1" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.cmml"><mo id="Sx2.SSx4.p2.6.m6.2.2.1.1.2" stretchy="false" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="Sx2.SSx4.p2.6.m6.2.2.1.1.1" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.cmml"><msub id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.cmml"><mi id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.2" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.2.cmml">𝒙</mi><mi id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.3" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.2" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.2.cmml">|</mo><mrow id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.2.cmml"><msub id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.cmml"><mi id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.2" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.cmml"><mn id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.2" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.2" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.1" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.3" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.2" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.2.cmml">,</mo><mi id="Sx2.SSx4.p2.6.m6.1.1" xref="Sx2.SSx4.p2.6.m6.1.1.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.SSx4.p2.6.m6.2.2.1.1.3" stretchy="false" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx4.p2.6.m6.2b"><apply id="Sx2.SSx4.p2.6.m6.2.2.cmml" xref="Sx2.SSx4.p2.6.m6.2.2"><times id="Sx2.SSx4.p2.6.m6.2.2.2.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.2"></times><ci id="Sx2.SSx4.p2.6.m6.2.2.3.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.3">𝑝</ci><apply id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1"><csymbol cd="latexml" id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.2.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.2">conditional</csymbol><apply id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.1.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.2.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.2">𝒙</ci><ci id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.3.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.3.3">𝑡</ci></apply><list id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.2.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1"><apply id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.2">𝒙</ci><apply id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3"><ci id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.1">:</ci><cn id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.2">1</cn><apply id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3"><minus id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.1"></minus><ci id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.SSx4.p2.6.m6.2.2.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="Sx2.SSx4.p2.6.m6.1.1.cmml" xref="Sx2.SSx4.p2.6.m6.1.1">𝒛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx4.p2.6.m6.2c">p(\boldsymbol{x}_{t}|\boldsymbol{x}_{1:t-1},\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx4.p2.6.m6.2d">italic_p ( bold_italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t - 1 end_POSTSUBSCRIPT , bold_italic_z )</annotation></semantics></math>. As we gain more samples from repeated interactions with the search system, the posterior distribution is updated, effectively balancing exploration and exploitation. In the following, we derive the updates for this distribution which accounts for distribution shifts and non-stationarity of the user interaction features.</p>
</div>
</section>
<section class="ltx_subsection" id="Sx2.SSx5">
<h3 class="ltx_title ltx_title_subsection">Non-stationarity and Continual Exploration</h3>
<div class="ltx_para" id="Sx2.SSx5.p1">
<p class="ltx_p" id="Sx2.SSx5.p1.1">User behaviors often change over time due to seasonality or long-term trends. Therefore, the search system needs to continually adapt to distribution shifts of these user interaction features. To this end, the posterior probabilities <math alttext="p(\boldsymbol{x}_{t+1}|\boldsymbol{x}_{1:t},\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.1.m1.2"><semantics id="Sx2.SSx5.p1.1.m1.2a"><mrow id="Sx2.SSx5.p1.1.m1.2.2" xref="Sx2.SSx5.p1.1.m1.2.2.cmml"><mi id="Sx2.SSx5.p1.1.m1.2.2.3" xref="Sx2.SSx5.p1.1.m1.2.2.3.cmml">p</mi><mo id="Sx2.SSx5.p1.1.m1.2.2.2" xref="Sx2.SSx5.p1.1.m1.2.2.2.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.1.m1.2.2.1.1" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.cmml"><mo id="Sx2.SSx5.p1.1.m1.2.2.1.1.2" stretchy="false" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="Sx2.SSx5.p1.1.m1.2.2.1.1.1" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.cmml"><msub id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.cmml"><mi id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.2" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.2.cmml">𝒙</mi><mrow id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.cmml"><mi id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.2" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.1" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.3" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.2" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.2.cmml">|</mo><mrow id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.2.cmml"><msub id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.2" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mn id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.2" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.3" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.2" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="Sx2.SSx5.p1.1.m1.1.1" xref="Sx2.SSx5.p1.1.m1.1.1.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.SSx5.p1.1.m1.2.2.1.1.3" stretchy="false" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.1.m1.2b"><apply id="Sx2.SSx5.p1.1.m1.2.2.cmml" xref="Sx2.SSx5.p1.1.m1.2.2"><times id="Sx2.SSx5.p1.1.m1.2.2.2.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.2"></times><ci id="Sx2.SSx5.p1.1.m1.2.2.3.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.3">𝑝</ci><apply id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1"><csymbol cd="latexml" id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.2.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.2">conditional</csymbol><apply id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.1.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.2.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.2">𝒙</ci><apply id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3"><plus id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.1.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.1"></plus><ci id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.2.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.3.3.3">1</cn></apply></apply><list id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.2.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1"><apply id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.2">𝒙</ci><apply id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3"><ci id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.1">:</ci><cn id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.2">1</cn><ci id="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="Sx2.SSx5.p1.1.m1.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="Sx2.SSx5.p1.1.m1.1.1.cmml" xref="Sx2.SSx5.p1.1.m1.1.1">𝒛</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.1.m1.2c">p(\boldsymbol{x}_{t+1}|\boldsymbol{x}_{1:t},\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.1.m1.2d">italic_p ( bold_italic_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , bold_italic_z )</annotation></semantics></math> needs to account for this non-stationary behavior. Specifically, the posterior probability is defined as</p>
<table class="ltx_equation ltx_eqn_table" id="Sx2.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(x_{t+1}|\boldsymbol{x}_{1:t},\boldsymbol{z})=p_{GP}(x_{t+1}|\alpha_{t}(%
\boldsymbol{z}),\beta_{t}(\boldsymbol{z}))," class="ltx_Math" display="block" id="Sx2.E10.m1.4"><semantics id="Sx2.E10.m1.4a"><mrow id="Sx2.E10.m1.4.4.1" xref="Sx2.E10.m1.4.4.1.1.cmml"><mrow id="Sx2.E10.m1.4.4.1.1" xref="Sx2.E10.m1.4.4.1.1.cmml"><mrow id="Sx2.E10.m1.4.4.1.1.1" xref="Sx2.E10.m1.4.4.1.1.1.cmml"><mi id="Sx2.E10.m1.4.4.1.1.1.3" xref="Sx2.E10.m1.4.4.1.1.1.3.cmml">p</mi><mo id="Sx2.E10.m1.4.4.1.1.1.2" xref="Sx2.E10.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.E10.m1.4.4.1.1.1.1.1" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.cmml"><mo id="Sx2.E10.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E10.m1.4.4.1.1.1.1.1.1" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.cmml"><msub id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.2" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.cmml"><mi id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.2" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.1" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.1.cmml">+</mo><mn id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.3" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="Sx2.E10.m1.4.4.1.1.1.1.1.1.2" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.2.cmml">|</mo><mrow id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.2.cmml"><msub id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mrow id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.3" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.2" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="Sx2.E10.m1.1.1" xref="Sx2.E10.m1.1.1.cmml">𝒛</mi></mrow></mrow><mo id="Sx2.E10.m1.4.4.1.1.1.1.1.3" stretchy="false" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E10.m1.4.4.1.1.3" xref="Sx2.E10.m1.4.4.1.1.3.cmml">=</mo><mrow id="Sx2.E10.m1.4.4.1.1.2" xref="Sx2.E10.m1.4.4.1.1.2.cmml"><msub id="Sx2.E10.m1.4.4.1.1.2.3" xref="Sx2.E10.m1.4.4.1.1.2.3.cmml"><mi id="Sx2.E10.m1.4.4.1.1.2.3.2" xref="Sx2.E10.m1.4.4.1.1.2.3.2.cmml">p</mi><mrow id="Sx2.E10.m1.4.4.1.1.2.3.3" xref="Sx2.E10.m1.4.4.1.1.2.3.3.cmml"><mi id="Sx2.E10.m1.4.4.1.1.2.3.3.2" xref="Sx2.E10.m1.4.4.1.1.2.3.3.2.cmml">G</mi><mo id="Sx2.E10.m1.4.4.1.1.2.3.3.1" xref="Sx2.E10.m1.4.4.1.1.2.3.3.1.cmml">⁢</mo><mi id="Sx2.E10.m1.4.4.1.1.2.3.3.3" xref="Sx2.E10.m1.4.4.1.1.2.3.3.3.cmml">P</mi></mrow></msub><mo id="Sx2.E10.m1.4.4.1.1.2.2" xref="Sx2.E10.m1.4.4.1.1.2.2.cmml">⁢</mo><mrow id="Sx2.E10.m1.4.4.1.1.2.1.1" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.cmml"><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.2" stretchy="false" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.cmml">(</mo><mrow id="Sx2.E10.m1.4.4.1.1.2.1.1.1" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.cmml"><msub id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.cmml"><mi id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.2.cmml">x</mi><mrow id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.cmml"><mi id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.2.cmml">t</mi><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.1" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.1.cmml">+</mo><mn id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.3" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="Sx2.E10.m1.4.4.1.1.2.1.1.1.3" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.3.cmml">|</mo><mrow id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.3.cmml"><mrow id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><msub id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.2.cmml">α</mi><mi id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.3" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.1" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.3.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="Sx2.E10.m1.2.2" xref="Sx2.E10.m1.2.2.cmml">𝒛</mi><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.3" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.3.cmml">,</mo><mrow id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.cmml"><msub id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.cmml"><mi id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.2.cmml">β</mi><mi id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.3" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.1" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.3.2" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.cmml"><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.cmml">(</mo><mi id="Sx2.E10.m1.3.3" xref="Sx2.E10.m1.3.3.cmml">𝒛</mi><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.3.2.2" stretchy="false" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.E10.m1.4.4.1.1.2.1.1.3" stretchy="false" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx2.E10.m1.4.4.1.2" xref="Sx2.E10.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E10.m1.4b"><apply id="Sx2.E10.m1.4.4.1.1.cmml" xref="Sx2.E10.m1.4.4.1"><eq id="Sx2.E10.m1.4.4.1.1.3.cmml" xref="Sx2.E10.m1.4.4.1.1.3"></eq><apply id="Sx2.E10.m1.4.4.1.1.1.cmml" xref="Sx2.E10.m1.4.4.1.1.1"><times id="Sx2.E10.m1.4.4.1.1.1.2.cmml" xref="Sx2.E10.m1.4.4.1.1.1.2"></times><ci id="Sx2.E10.m1.4.4.1.1.1.3.cmml" xref="Sx2.E10.m1.4.4.1.1.1.3">𝑝</ci><apply id="Sx2.E10.m1.4.4.1.1.1.1.1.1.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1"><csymbol cd="latexml" id="Sx2.E10.m1.4.4.1.1.1.1.1.1.2.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.2">conditional</csymbol><apply id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.2">𝑥</ci><apply id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3"><plus id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.1.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.1"></plus><ci id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.2.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.3.3.3">1</cn></apply></apply><list id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1"><apply id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝒙</ci><apply id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3"><ci id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.1">:</ci><cn id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.2">1</cn><ci id="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx2.E10.m1.4.4.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="Sx2.E10.m1.1.1.cmml" xref="Sx2.E10.m1.1.1">𝒛</ci></list></apply></apply><apply id="Sx2.E10.m1.4.4.1.1.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2"><times id="Sx2.E10.m1.4.4.1.1.2.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.2"></times><apply id="Sx2.E10.m1.4.4.1.1.2.3.cmml" xref="Sx2.E10.m1.4.4.1.1.2.3"><csymbol cd="ambiguous" id="Sx2.E10.m1.4.4.1.1.2.3.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.3">subscript</csymbol><ci id="Sx2.E10.m1.4.4.1.1.2.3.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.3.2">𝑝</ci><apply id="Sx2.E10.m1.4.4.1.1.2.3.3.cmml" xref="Sx2.E10.m1.4.4.1.1.2.3.3"><times id="Sx2.E10.m1.4.4.1.1.2.3.3.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.3.3.1"></times><ci id="Sx2.E10.m1.4.4.1.1.2.3.3.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.3.3.2">𝐺</ci><ci id="Sx2.E10.m1.4.4.1.1.2.3.3.3.cmml" xref="Sx2.E10.m1.4.4.1.1.2.3.3.3">𝑃</ci></apply></apply><apply id="Sx2.E10.m1.4.4.1.1.2.1.1.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1"><csymbol cd="latexml" id="Sx2.E10.m1.4.4.1.1.2.1.1.1.3.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.3">conditional</csymbol><apply id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4">subscript</csymbol><ci id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.2">𝑥</ci><apply id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3"><plus id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.1"></plus><ci id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.2">𝑡</ci><cn id="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.3.cmml" type="integer" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.4.3.3">1</cn></apply></apply><list id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.3.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2"><apply id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1"><times id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.1"></times><apply id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.2">𝛼</ci><ci id="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="Sx2.E10.m1.2.2.cmml" xref="Sx2.E10.m1.2.2">𝒛</ci></apply><apply id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2"><times id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.1"></times><apply id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.1.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.2.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.2">𝛽</ci><ci id="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.3.cmml" xref="Sx2.E10.m1.4.4.1.1.2.1.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="Sx2.E10.m1.3.3.cmml" xref="Sx2.E10.m1.3.3">𝒛</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E10.m1.4c">p(x_{t+1}|\boldsymbol{x}_{1:t},\boldsymbol{z})=p_{GP}(x_{t+1}|\alpha_{t}(%
\boldsymbol{z}),\beta_{t}(\boldsymbol{z})),</annotation><annotation encoding="application/x-llamapun" id="Sx2.E10.m1.4d">italic_p ( italic_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | bold_italic_x start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT , bold_italic_z ) = italic_p start_POSTSUBSCRIPT italic_G italic_P end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT | italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_z ) , italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_z ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx2.SSx5.p1.8">where <math alttext="p_{GP}(x|\alpha_{t}(\boldsymbol{z}),\beta_{t}(\boldsymbol{z}))" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.2.m1.3"><semantics id="Sx2.SSx5.p1.2.m1.3a"><mrow id="Sx2.SSx5.p1.2.m1.3.3" xref="Sx2.SSx5.p1.2.m1.3.3.cmml"><msub id="Sx2.SSx5.p1.2.m1.3.3.3" xref="Sx2.SSx5.p1.2.m1.3.3.3.cmml"><mi id="Sx2.SSx5.p1.2.m1.3.3.3.2" xref="Sx2.SSx5.p1.2.m1.3.3.3.2.cmml">p</mi><mrow id="Sx2.SSx5.p1.2.m1.3.3.3.3" xref="Sx2.SSx5.p1.2.m1.3.3.3.3.cmml"><mi id="Sx2.SSx5.p1.2.m1.3.3.3.3.2" xref="Sx2.SSx5.p1.2.m1.3.3.3.3.2.cmml">G</mi><mo id="Sx2.SSx5.p1.2.m1.3.3.3.3.1" xref="Sx2.SSx5.p1.2.m1.3.3.3.3.1.cmml">⁢</mo><mi id="Sx2.SSx5.p1.2.m1.3.3.3.3.3" xref="Sx2.SSx5.p1.2.m1.3.3.3.3.3.cmml">P</mi></mrow></msub><mo id="Sx2.SSx5.p1.2.m1.3.3.2" xref="Sx2.SSx5.p1.2.m1.3.3.2.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.2.m1.3.3.1.1" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.cmml"><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.2" stretchy="false" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.cmml">(</mo><mrow id="Sx2.SSx5.p1.2.m1.3.3.1.1.1" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.cmml"><mi id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.4" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.4.cmml">x</mi><mo fence="false" id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.3" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.3.cmml">|</mo><mrow id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.3.cmml"><mrow id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.cmml"><msub id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.2" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.2.cmml">α</mi><mi id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.3" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.1" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.3.2" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="Sx2.SSx5.p1.2.m1.1.1" xref="Sx2.SSx5.p1.2.m1.1.1.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.3" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.3.cmml">,</mo><mrow id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.cmml"><msub id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.cmml"><mi id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.2" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.2.cmml">β</mi><mi id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.3" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.3.cmml">t</mi></msub><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.1" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.3.2" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.cmml"><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.cmml">(</mo><mi id="Sx2.SSx5.p1.2.m1.2.2" xref="Sx2.SSx5.p1.2.m1.2.2.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.3.2.2" stretchy="false" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx2.SSx5.p1.2.m1.3.3.1.1.3" stretchy="false" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.2.m1.3b"><apply id="Sx2.SSx5.p1.2.m1.3.3.cmml" xref="Sx2.SSx5.p1.2.m1.3.3"><times id="Sx2.SSx5.p1.2.m1.3.3.2.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.2"></times><apply id="Sx2.SSx5.p1.2.m1.3.3.3.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.3"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.2.m1.3.3.3.1.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.3">subscript</csymbol><ci id="Sx2.SSx5.p1.2.m1.3.3.3.2.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.3.2">𝑝</ci><apply id="Sx2.SSx5.p1.2.m1.3.3.3.3.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.3.3"><times id="Sx2.SSx5.p1.2.m1.3.3.3.3.1.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.3.3.1"></times><ci id="Sx2.SSx5.p1.2.m1.3.3.3.3.2.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.3.3.2">𝐺</ci><ci id="Sx2.SSx5.p1.2.m1.3.3.3.3.3.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.3.3.3">𝑃</ci></apply></apply><apply id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1"><csymbol cd="latexml" id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.3.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.3">conditional</csymbol><ci id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.4.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.4">𝑥</ci><list id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.3.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2"><apply id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1"><times id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.1"></times><apply id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.2">𝛼</ci><ci id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.1.1.1.2.3">𝑡</ci></apply><ci id="Sx2.SSx5.p1.2.m1.1.1.cmml" xref="Sx2.SSx5.p1.2.m1.1.1">𝒛</ci></apply><apply id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2"><times id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.1.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.1"></times><apply id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.1.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.2.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.2">𝛽</ci><ci id="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.3.cmml" xref="Sx2.SSx5.p1.2.m1.3.3.1.1.1.2.2.2.2.3">𝑡</ci></apply><ci id="Sx2.SSx5.p1.2.m1.2.2.cmml" xref="Sx2.SSx5.p1.2.m1.2.2">𝒛</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.2.m1.3c">p_{GP}(x|\alpha_{t}(\boldsymbol{z}),\beta_{t}(\boldsymbol{z}))</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.2.m1.3d">italic_p start_POSTSUBSCRIPT italic_G italic_P end_POSTSUBSCRIPT ( italic_x | italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_z ) , italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_z ) )</annotation></semantics></math> is defined as in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.E4" title="In Empirical Bayesian Prior Modeling ‣ Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">4</span></a>), and <math alttext="\alpha_{t}" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.3.m2.1"><semantics id="Sx2.SSx5.p1.3.m2.1a"><msub id="Sx2.SSx5.p1.3.m2.1.1" xref="Sx2.SSx5.p1.3.m2.1.1.cmml"><mi id="Sx2.SSx5.p1.3.m2.1.1.2" xref="Sx2.SSx5.p1.3.m2.1.1.2.cmml">α</mi><mi id="Sx2.SSx5.p1.3.m2.1.1.3" xref="Sx2.SSx5.p1.3.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.3.m2.1b"><apply id="Sx2.SSx5.p1.3.m2.1.1.cmml" xref="Sx2.SSx5.p1.3.m2.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.3.m2.1.1.1.cmml" xref="Sx2.SSx5.p1.3.m2.1.1">subscript</csymbol><ci id="Sx2.SSx5.p1.3.m2.1.1.2.cmml" xref="Sx2.SSx5.p1.3.m2.1.1.2">𝛼</ci><ci id="Sx2.SSx5.p1.3.m2.1.1.3.cmml" xref="Sx2.SSx5.p1.3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.3.m2.1c">\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.3.m2.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\beta_{t}" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.4.m3.1"><semantics id="Sx2.SSx5.p1.4.m3.1a"><msub id="Sx2.SSx5.p1.4.m3.1.1" xref="Sx2.SSx5.p1.4.m3.1.1.cmml"><mi id="Sx2.SSx5.p1.4.m3.1.1.2" xref="Sx2.SSx5.p1.4.m3.1.1.2.cmml">β</mi><mi id="Sx2.SSx5.p1.4.m3.1.1.3" xref="Sx2.SSx5.p1.4.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.4.m3.1b"><apply id="Sx2.SSx5.p1.4.m3.1.1.cmml" xref="Sx2.SSx5.p1.4.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.4.m3.1.1.1.cmml" xref="Sx2.SSx5.p1.4.m3.1.1">subscript</csymbol><ci id="Sx2.SSx5.p1.4.m3.1.1.2.cmml" xref="Sx2.SSx5.p1.4.m3.1.1.2">𝛽</ci><ci id="Sx2.SSx5.p1.4.m3.1.1.3.cmml" xref="Sx2.SSx5.p1.4.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.4.m3.1c">\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.4.m3.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> are the posterior parameters corresponding to the Gamma-Poisson distribution <cite class="ltx_cite ltx_citemacro_citep">(Fink <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib15" title="">1997</a>)</cite>. Under non-stationarity, the posterior updates for <math alttext="\alpha_{t}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.5.m4.1"><semantics id="Sx2.SSx5.p1.5.m4.1a"><mrow id="Sx2.SSx5.p1.5.m4.1.2" xref="Sx2.SSx5.p1.5.m4.1.2.cmml"><msub id="Sx2.SSx5.p1.5.m4.1.2.2" xref="Sx2.SSx5.p1.5.m4.1.2.2.cmml"><mi id="Sx2.SSx5.p1.5.m4.1.2.2.2" xref="Sx2.SSx5.p1.5.m4.1.2.2.2.cmml">α</mi><mi id="Sx2.SSx5.p1.5.m4.1.2.2.3" xref="Sx2.SSx5.p1.5.m4.1.2.2.3.cmml">t</mi></msub><mo id="Sx2.SSx5.p1.5.m4.1.2.1" xref="Sx2.SSx5.p1.5.m4.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.5.m4.1.2.3.2" xref="Sx2.SSx5.p1.5.m4.1.2.cmml"><mo id="Sx2.SSx5.p1.5.m4.1.2.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.5.m4.1.2.cmml">(</mo><mi id="Sx2.SSx5.p1.5.m4.1.1" xref="Sx2.SSx5.p1.5.m4.1.1.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.5.m4.1.2.3.2.2" stretchy="false" xref="Sx2.SSx5.p1.5.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.5.m4.1b"><apply id="Sx2.SSx5.p1.5.m4.1.2.cmml" xref="Sx2.SSx5.p1.5.m4.1.2"><times id="Sx2.SSx5.p1.5.m4.1.2.1.cmml" xref="Sx2.SSx5.p1.5.m4.1.2.1"></times><apply id="Sx2.SSx5.p1.5.m4.1.2.2.cmml" xref="Sx2.SSx5.p1.5.m4.1.2.2"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.5.m4.1.2.2.1.cmml" xref="Sx2.SSx5.p1.5.m4.1.2.2">subscript</csymbol><ci id="Sx2.SSx5.p1.5.m4.1.2.2.2.cmml" xref="Sx2.SSx5.p1.5.m4.1.2.2.2">𝛼</ci><ci id="Sx2.SSx5.p1.5.m4.1.2.2.3.cmml" xref="Sx2.SSx5.p1.5.m4.1.2.2.3">𝑡</ci></apply><ci id="Sx2.SSx5.p1.5.m4.1.1.cmml" xref="Sx2.SSx5.p1.5.m4.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.5.m4.1c">\alpha_{t}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.5.m4.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> and <math alttext="\beta_{t}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.6.m5.1"><semantics id="Sx2.SSx5.p1.6.m5.1a"><mrow id="Sx2.SSx5.p1.6.m5.1.2" xref="Sx2.SSx5.p1.6.m5.1.2.cmml"><msub id="Sx2.SSx5.p1.6.m5.1.2.2" xref="Sx2.SSx5.p1.6.m5.1.2.2.cmml"><mi id="Sx2.SSx5.p1.6.m5.1.2.2.2" xref="Sx2.SSx5.p1.6.m5.1.2.2.2.cmml">β</mi><mi id="Sx2.SSx5.p1.6.m5.1.2.2.3" xref="Sx2.SSx5.p1.6.m5.1.2.2.3.cmml">t</mi></msub><mo id="Sx2.SSx5.p1.6.m5.1.2.1" xref="Sx2.SSx5.p1.6.m5.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.6.m5.1.2.3.2" xref="Sx2.SSx5.p1.6.m5.1.2.cmml"><mo id="Sx2.SSx5.p1.6.m5.1.2.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.6.m5.1.2.cmml">(</mo><mi id="Sx2.SSx5.p1.6.m5.1.1" xref="Sx2.SSx5.p1.6.m5.1.1.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.6.m5.1.2.3.2.2" stretchy="false" xref="Sx2.SSx5.p1.6.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.6.m5.1b"><apply id="Sx2.SSx5.p1.6.m5.1.2.cmml" xref="Sx2.SSx5.p1.6.m5.1.2"><times id="Sx2.SSx5.p1.6.m5.1.2.1.cmml" xref="Sx2.SSx5.p1.6.m5.1.2.1"></times><apply id="Sx2.SSx5.p1.6.m5.1.2.2.cmml" xref="Sx2.SSx5.p1.6.m5.1.2.2"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.6.m5.1.2.2.1.cmml" xref="Sx2.SSx5.p1.6.m5.1.2.2">subscript</csymbol><ci id="Sx2.SSx5.p1.6.m5.1.2.2.2.cmml" xref="Sx2.SSx5.p1.6.m5.1.2.2.2">𝛽</ci><ci id="Sx2.SSx5.p1.6.m5.1.2.2.3.cmml" xref="Sx2.SSx5.p1.6.m5.1.2.2.3">𝑡</ci></apply><ci id="Sx2.SSx5.p1.6.m5.1.1.cmml" xref="Sx2.SSx5.p1.6.m5.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.6.m5.1c">\beta_{t}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.6.m5.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> given observations <math alttext="\boldsymbol{x}_{1:t}" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.7.m6.1"><semantics id="Sx2.SSx5.p1.7.m6.1a"><msub id="Sx2.SSx5.p1.7.m6.1.1" xref="Sx2.SSx5.p1.7.m6.1.1.cmml"><mi id="Sx2.SSx5.p1.7.m6.1.1.2" xref="Sx2.SSx5.p1.7.m6.1.1.2.cmml">𝒙</mi><mrow id="Sx2.SSx5.p1.7.m6.1.1.3" xref="Sx2.SSx5.p1.7.m6.1.1.3.cmml"><mn id="Sx2.SSx5.p1.7.m6.1.1.3.2" xref="Sx2.SSx5.p1.7.m6.1.1.3.2.cmml">1</mn><mo id="Sx2.SSx5.p1.7.m6.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="Sx2.SSx5.p1.7.m6.1.1.3.1.cmml">:</mo><mi id="Sx2.SSx5.p1.7.m6.1.1.3.3" xref="Sx2.SSx5.p1.7.m6.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.7.m6.1b"><apply id="Sx2.SSx5.p1.7.m6.1.1.cmml" xref="Sx2.SSx5.p1.7.m6.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.7.m6.1.1.1.cmml" xref="Sx2.SSx5.p1.7.m6.1.1">subscript</csymbol><ci id="Sx2.SSx5.p1.7.m6.1.1.2.cmml" xref="Sx2.SSx5.p1.7.m6.1.1.2">𝒙</ci><apply id="Sx2.SSx5.p1.7.m6.1.1.3.cmml" xref="Sx2.SSx5.p1.7.m6.1.1.3"><ci id="Sx2.SSx5.p1.7.m6.1.1.3.1.cmml" xref="Sx2.SSx5.p1.7.m6.1.1.3.1">:</ci><cn id="Sx2.SSx5.p1.7.m6.1.1.3.2.cmml" type="integer" xref="Sx2.SSx5.p1.7.m6.1.1.3.2">1</cn><ci id="Sx2.SSx5.p1.7.m6.1.1.3.3.cmml" xref="Sx2.SSx5.p1.7.m6.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.7.m6.1c">\boldsymbol{x}_{1:t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.7.m6.1d">bold_italic_x start_POSTSUBSCRIPT 1 : italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and contextual features <math alttext="\boldsymbol{z}" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.8.m7.1"><semantics id="Sx2.SSx5.p1.8.m7.1a"><mi id="Sx2.SSx5.p1.8.m7.1.1" xref="Sx2.SSx5.p1.8.m7.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.8.m7.1b"><ci id="Sx2.SSx5.p1.8.m7.1.1.cmml" xref="Sx2.SSx5.p1.8.m7.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.8.m7.1c">\boldsymbol{z}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.8.m7.1d">bold_italic_z</annotation></semantics></math> can be defined as</p>
<table class="ltx_equationgroup ltx_eqn_table" id="Sx2.E11">
<tbody>
<tr class="ltx_eqn_row" id="Sx5.EGx1"><td class="ltx_eqn_cell" colspan="5"></td></tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="Sx2.E11.1">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha_{t}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.E11.1.m1.1"><semantics id="Sx2.E11.1.m1.1a"><mrow id="Sx2.E11.1.m1.1.2" xref="Sx2.E11.1.m1.1.2.cmml"><msub id="Sx2.E11.1.m1.1.2.2" xref="Sx2.E11.1.m1.1.2.2.cmml"><mi id="Sx2.E11.1.m1.1.2.2.2" xref="Sx2.E11.1.m1.1.2.2.2.cmml">α</mi><mi id="Sx2.E11.1.m1.1.2.2.3" xref="Sx2.E11.1.m1.1.2.2.3.cmml">t</mi></msub><mo id="Sx2.E11.1.m1.1.2.1" xref="Sx2.E11.1.m1.1.2.1.cmml">⁢</mo><mrow id="Sx2.E11.1.m1.1.2.3.2" xref="Sx2.E11.1.m1.1.2.cmml"><mo id="Sx2.E11.1.m1.1.2.3.2.1" stretchy="false" xref="Sx2.E11.1.m1.1.2.cmml">(</mo><mi id="Sx2.E11.1.m1.1.1" xref="Sx2.E11.1.m1.1.1.cmml">𝒛</mi><mo id="Sx2.E11.1.m1.1.2.3.2.2" stretchy="false" xref="Sx2.E11.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E11.1.m1.1b"><apply id="Sx2.E11.1.m1.1.2.cmml" xref="Sx2.E11.1.m1.1.2"><times id="Sx2.E11.1.m1.1.2.1.cmml" xref="Sx2.E11.1.m1.1.2.1"></times><apply id="Sx2.E11.1.m1.1.2.2.cmml" xref="Sx2.E11.1.m1.1.2.2"><csymbol cd="ambiguous" id="Sx2.E11.1.m1.1.2.2.1.cmml" xref="Sx2.E11.1.m1.1.2.2">subscript</csymbol><ci id="Sx2.E11.1.m1.1.2.2.2.cmml" xref="Sx2.E11.1.m1.1.2.2.2">𝛼</ci><ci id="Sx2.E11.1.m1.1.2.2.3.cmml" xref="Sx2.E11.1.m1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.E11.1.m1.1.1.cmml" xref="Sx2.E11.1.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E11.1.m1.1c">\displaystyle\alpha_{t}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.E11.1.m1.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{i=1}^{n_{t}}{x_{t}^{i}}+\gamma\alpha_{0}(\boldsymbol{z})+(%
1-\gamma)\alpha_{t-1}," class="ltx_Math" display="inline" id="Sx2.E11.1.m2.2"><semantics id="Sx2.E11.1.m2.2a"><mrow id="Sx2.E11.1.m2.2.2.1" xref="Sx2.E11.1.m2.2.2.1.1.cmml"><mrow id="Sx2.E11.1.m2.2.2.1.1" xref="Sx2.E11.1.m2.2.2.1.1.cmml"><mi id="Sx2.E11.1.m2.2.2.1.1.3" xref="Sx2.E11.1.m2.2.2.1.1.3.cmml"></mi><mo id="Sx2.E11.1.m2.2.2.1.1.2" xref="Sx2.E11.1.m2.2.2.1.1.2.cmml">=</mo><mrow id="Sx2.E11.1.m2.2.2.1.1.1" xref="Sx2.E11.1.m2.2.2.1.1.1.cmml"><mrow id="Sx2.E11.1.m2.2.2.1.1.1.3" xref="Sx2.E11.1.m2.2.2.1.1.1.3.cmml"><mstyle displaystyle="true" id="Sx2.E11.1.m2.2.2.1.1.1.3.1" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.cmml"><munderover id="Sx2.E11.1.m2.2.2.1.1.1.3.1a" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.cmml"><mo id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.2" movablelimits="false" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.cmml"><mi id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.2" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.1" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.3" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><msub id="Sx2.E11.1.m2.2.2.1.1.1.3.1.3" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.cmml"><mi id="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.2" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.2.cmml">n</mi><mi id="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.3" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.3.cmml">t</mi></msub></munderover></mstyle><msubsup id="Sx2.E11.1.m2.2.2.1.1.1.3.2" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2.cmml"><mi id="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.2" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.2.cmml">x</mi><mi id="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.3" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.3.cmml">t</mi><mi id="Sx2.E11.1.m2.2.2.1.1.1.3.2.3" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2.3.cmml">i</mi></msubsup></mrow><mo id="Sx2.E11.1.m2.2.2.1.1.1.2" xref="Sx2.E11.1.m2.2.2.1.1.1.2.cmml">+</mo><mrow id="Sx2.E11.1.m2.2.2.1.1.1.4" xref="Sx2.E11.1.m2.2.2.1.1.1.4.cmml"><mi id="Sx2.E11.1.m2.2.2.1.1.1.4.2" xref="Sx2.E11.1.m2.2.2.1.1.1.4.2.cmml">γ</mi><mo id="Sx2.E11.1.m2.2.2.1.1.1.4.1" xref="Sx2.E11.1.m2.2.2.1.1.1.4.1.cmml">⁢</mo><msub id="Sx2.E11.1.m2.2.2.1.1.1.4.3" xref="Sx2.E11.1.m2.2.2.1.1.1.4.3.cmml"><mi id="Sx2.E11.1.m2.2.2.1.1.1.4.3.2" xref="Sx2.E11.1.m2.2.2.1.1.1.4.3.2.cmml">α</mi><mn id="Sx2.E11.1.m2.2.2.1.1.1.4.3.3" xref="Sx2.E11.1.m2.2.2.1.1.1.4.3.3.cmml">0</mn></msub><mo id="Sx2.E11.1.m2.2.2.1.1.1.4.1a" xref="Sx2.E11.1.m2.2.2.1.1.1.4.1.cmml">⁢</mo><mrow id="Sx2.E11.1.m2.2.2.1.1.1.4.4.2" xref="Sx2.E11.1.m2.2.2.1.1.1.4.cmml"><mo id="Sx2.E11.1.m2.2.2.1.1.1.4.4.2.1" stretchy="false" xref="Sx2.E11.1.m2.2.2.1.1.1.4.cmml">(</mo><mi id="Sx2.E11.1.m2.1.1" xref="Sx2.E11.1.m2.1.1.cmml">𝒛</mi><mo id="Sx2.E11.1.m2.2.2.1.1.1.4.4.2.2" stretchy="false" xref="Sx2.E11.1.m2.2.2.1.1.1.4.cmml">)</mo></mrow></mrow><mo id="Sx2.E11.1.m2.2.2.1.1.1.2a" xref="Sx2.E11.1.m2.2.2.1.1.1.2.cmml">+</mo><mrow id="Sx2.E11.1.m2.2.2.1.1.1.1" xref="Sx2.E11.1.m2.2.2.1.1.1.1.cmml"><mrow id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.cmml"><mn id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.2" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.1" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.3" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Sx2.E11.1.m2.2.2.1.1.1.1.2" xref="Sx2.E11.1.m2.2.2.1.1.1.1.2.cmml">⁢</mo><msub id="Sx2.E11.1.m2.2.2.1.1.1.1.3" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.cmml"><mi id="Sx2.E11.1.m2.2.2.1.1.1.1.3.2" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.2.cmml">α</mi><mrow id="Sx2.E11.1.m2.2.2.1.1.1.1.3.3" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.cmml"><mi id="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.2" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.1" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.3" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow><mo id="Sx2.E11.1.m2.2.2.1.2" xref="Sx2.E11.1.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E11.1.m2.2b"><apply id="Sx2.E11.1.m2.2.2.1.1.cmml" xref="Sx2.E11.1.m2.2.2.1"><eq id="Sx2.E11.1.m2.2.2.1.1.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="Sx2.E11.1.m2.2.2.1.1.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.3">absent</csymbol><apply id="Sx2.E11.1.m2.2.2.1.1.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1"><plus id="Sx2.E11.1.m2.2.2.1.1.1.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.2"></plus><apply id="Sx2.E11.1.m2.2.2.1.1.1.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3"><apply id="Sx2.E11.1.m2.2.2.1.1.1.3.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1"><csymbol cd="ambiguous" id="Sx2.E11.1.m2.2.2.1.1.1.3.1.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1">superscript</csymbol><apply id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1"><csymbol cd="ambiguous" id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1">subscript</csymbol><sum id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.2"></sum><apply id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3"><eq id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.1"></eq><ci id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.2">𝑖</ci><cn id="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.3.cmml" type="integer" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.2.3.3">1</cn></apply></apply><apply id="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.3"><csymbol cd="ambiguous" id="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.3">subscript</csymbol><ci id="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.2">𝑛</ci><ci id="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.1.3.3">𝑡</ci></apply></apply><apply id="Sx2.E11.1.m2.2.2.1.1.1.3.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E11.1.m2.2.2.1.1.1.3.2.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2">superscript</csymbol><apply id="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2">subscript</csymbol><ci id="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.2">𝑥</ci><ci id="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2.2.3">𝑡</ci></apply><ci id="Sx2.E11.1.m2.2.2.1.1.1.3.2.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.3.2.3">𝑖</ci></apply></apply><apply id="Sx2.E11.1.m2.2.2.1.1.1.4.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.4"><times id="Sx2.E11.1.m2.2.2.1.1.1.4.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.4.1"></times><ci id="Sx2.E11.1.m2.2.2.1.1.1.4.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.4.2">𝛾</ci><apply id="Sx2.E11.1.m2.2.2.1.1.1.4.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.4.3"><csymbol cd="ambiguous" id="Sx2.E11.1.m2.2.2.1.1.1.4.3.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.4.3">subscript</csymbol><ci id="Sx2.E11.1.m2.2.2.1.1.1.4.3.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.4.3.2">𝛼</ci><cn id="Sx2.E11.1.m2.2.2.1.1.1.4.3.3.cmml" type="integer" xref="Sx2.E11.1.m2.2.2.1.1.1.4.3.3">0</cn></apply><ci id="Sx2.E11.1.m2.1.1.cmml" xref="Sx2.E11.1.m2.1.1">𝒛</ci></apply><apply id="Sx2.E11.1.m2.2.2.1.1.1.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1"><times id="Sx2.E11.1.m2.2.2.1.1.1.1.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.2"></times><apply id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1"><minus id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.1"></minus><cn id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.2">1</cn><ci id="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="Sx2.E11.1.m2.2.2.1.1.1.1.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E11.1.m2.2.2.1.1.1.1.3.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E11.1.m2.2.2.1.1.1.1.3.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.2">𝛼</ci><apply id="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.3"><minus id="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.1.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.1"></minus><ci id="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.2.cmml" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.E11.1.m2.2.2.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E11.1.m2.2c">\displaystyle=\sum_{i=1}^{n_{t}}{x_{t}^{i}}+\gamma\alpha_{0}(\boldsymbol{z})+(%
1-\gamma)\alpha_{t-1},</annotation><annotation encoding="application/x-llamapun" id="Sx2.E11.1.m2.2d">= ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT + italic_γ italic_α start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z ) + ( 1 - italic_γ ) italic_α start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11a)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="Sx2.E11.2">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\beta_{t}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.E11.2.m1.1"><semantics id="Sx2.E11.2.m1.1a"><mrow id="Sx2.E11.2.m1.1.2" xref="Sx2.E11.2.m1.1.2.cmml"><msub id="Sx2.E11.2.m1.1.2.2" xref="Sx2.E11.2.m1.1.2.2.cmml"><mi id="Sx2.E11.2.m1.1.2.2.2" xref="Sx2.E11.2.m1.1.2.2.2.cmml">β</mi><mi id="Sx2.E11.2.m1.1.2.2.3" xref="Sx2.E11.2.m1.1.2.2.3.cmml">t</mi></msub><mo id="Sx2.E11.2.m1.1.2.1" xref="Sx2.E11.2.m1.1.2.1.cmml">⁢</mo><mrow id="Sx2.E11.2.m1.1.2.3.2" xref="Sx2.E11.2.m1.1.2.cmml"><mo id="Sx2.E11.2.m1.1.2.3.2.1" stretchy="false" xref="Sx2.E11.2.m1.1.2.cmml">(</mo><mi id="Sx2.E11.2.m1.1.1" xref="Sx2.E11.2.m1.1.1.cmml">𝒛</mi><mo id="Sx2.E11.2.m1.1.2.3.2.2" stretchy="false" xref="Sx2.E11.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E11.2.m1.1b"><apply id="Sx2.E11.2.m1.1.2.cmml" xref="Sx2.E11.2.m1.1.2"><times id="Sx2.E11.2.m1.1.2.1.cmml" xref="Sx2.E11.2.m1.1.2.1"></times><apply id="Sx2.E11.2.m1.1.2.2.cmml" xref="Sx2.E11.2.m1.1.2.2"><csymbol cd="ambiguous" id="Sx2.E11.2.m1.1.2.2.1.cmml" xref="Sx2.E11.2.m1.1.2.2">subscript</csymbol><ci id="Sx2.E11.2.m1.1.2.2.2.cmml" xref="Sx2.E11.2.m1.1.2.2.2">𝛽</ci><ci id="Sx2.E11.2.m1.1.2.2.3.cmml" xref="Sx2.E11.2.m1.1.2.2.3">𝑡</ci></apply><ci id="Sx2.E11.2.m1.1.1.cmml" xref="Sx2.E11.2.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E11.2.m1.1c">\displaystyle\beta_{t}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.E11.2.m1.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=n_{t}+\gamma\beta_{0}(\boldsymbol{z})+(1-\gamma)\beta_{t-1}." class="ltx_Math" display="inline" id="Sx2.E11.2.m2.2"><semantics id="Sx2.E11.2.m2.2a"><mrow id="Sx2.E11.2.m2.2.2.1" xref="Sx2.E11.2.m2.2.2.1.1.cmml"><mrow id="Sx2.E11.2.m2.2.2.1.1" xref="Sx2.E11.2.m2.2.2.1.1.cmml"><mi id="Sx2.E11.2.m2.2.2.1.1.3" xref="Sx2.E11.2.m2.2.2.1.1.3.cmml"></mi><mo id="Sx2.E11.2.m2.2.2.1.1.2" xref="Sx2.E11.2.m2.2.2.1.1.2.cmml">=</mo><mrow id="Sx2.E11.2.m2.2.2.1.1.1" xref="Sx2.E11.2.m2.2.2.1.1.1.cmml"><msub id="Sx2.E11.2.m2.2.2.1.1.1.3" xref="Sx2.E11.2.m2.2.2.1.1.1.3.cmml"><mi id="Sx2.E11.2.m2.2.2.1.1.1.3.2" xref="Sx2.E11.2.m2.2.2.1.1.1.3.2.cmml">n</mi><mi id="Sx2.E11.2.m2.2.2.1.1.1.3.3" xref="Sx2.E11.2.m2.2.2.1.1.1.3.3.cmml">t</mi></msub><mo id="Sx2.E11.2.m2.2.2.1.1.1.2" xref="Sx2.E11.2.m2.2.2.1.1.1.2.cmml">+</mo><mrow id="Sx2.E11.2.m2.2.2.1.1.1.4" xref="Sx2.E11.2.m2.2.2.1.1.1.4.cmml"><mi id="Sx2.E11.2.m2.2.2.1.1.1.4.2" xref="Sx2.E11.2.m2.2.2.1.1.1.4.2.cmml">γ</mi><mo id="Sx2.E11.2.m2.2.2.1.1.1.4.1" xref="Sx2.E11.2.m2.2.2.1.1.1.4.1.cmml">⁢</mo><msub id="Sx2.E11.2.m2.2.2.1.1.1.4.3" xref="Sx2.E11.2.m2.2.2.1.1.1.4.3.cmml"><mi id="Sx2.E11.2.m2.2.2.1.1.1.4.3.2" xref="Sx2.E11.2.m2.2.2.1.1.1.4.3.2.cmml">β</mi><mn id="Sx2.E11.2.m2.2.2.1.1.1.4.3.3" xref="Sx2.E11.2.m2.2.2.1.1.1.4.3.3.cmml">0</mn></msub><mo id="Sx2.E11.2.m2.2.2.1.1.1.4.1a" xref="Sx2.E11.2.m2.2.2.1.1.1.4.1.cmml">⁢</mo><mrow id="Sx2.E11.2.m2.2.2.1.1.1.4.4.2" xref="Sx2.E11.2.m2.2.2.1.1.1.4.cmml"><mo id="Sx2.E11.2.m2.2.2.1.1.1.4.4.2.1" stretchy="false" xref="Sx2.E11.2.m2.2.2.1.1.1.4.cmml">(</mo><mi id="Sx2.E11.2.m2.1.1" xref="Sx2.E11.2.m2.1.1.cmml">𝒛</mi><mo id="Sx2.E11.2.m2.2.2.1.1.1.4.4.2.2" stretchy="false" xref="Sx2.E11.2.m2.2.2.1.1.1.4.cmml">)</mo></mrow></mrow><mo id="Sx2.E11.2.m2.2.2.1.1.1.2a" xref="Sx2.E11.2.m2.2.2.1.1.1.2.cmml">+</mo><mrow id="Sx2.E11.2.m2.2.2.1.1.1.1" xref="Sx2.E11.2.m2.2.2.1.1.1.1.cmml"><mrow id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mn id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.2" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.1" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.3" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Sx2.E11.2.m2.2.2.1.1.1.1.2" xref="Sx2.E11.2.m2.2.2.1.1.1.1.2.cmml">⁢</mo><msub id="Sx2.E11.2.m2.2.2.1.1.1.1.3" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.cmml"><mi id="Sx2.E11.2.m2.2.2.1.1.1.1.3.2" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.2.cmml">β</mi><mrow id="Sx2.E11.2.m2.2.2.1.1.1.1.3.3" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.cmml"><mi id="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.2" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.2.cmml">t</mi><mo id="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.1" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.3" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow><mo id="Sx2.E11.2.m2.2.2.1.2" lspace="0em" xref="Sx2.E11.2.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx2.E11.2.m2.2b"><apply id="Sx2.E11.2.m2.2.2.1.1.cmml" xref="Sx2.E11.2.m2.2.2.1"><eq id="Sx2.E11.2.m2.2.2.1.1.2.cmml" xref="Sx2.E11.2.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="Sx2.E11.2.m2.2.2.1.1.3.cmml" xref="Sx2.E11.2.m2.2.2.1.1.3">absent</csymbol><apply id="Sx2.E11.2.m2.2.2.1.1.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1"><plus id="Sx2.E11.2.m2.2.2.1.1.1.2.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.2"></plus><apply id="Sx2.E11.2.m2.2.2.1.1.1.3.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E11.2.m2.2.2.1.1.1.3.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="Sx2.E11.2.m2.2.2.1.1.1.3.2.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.3.2">𝑛</ci><ci id="Sx2.E11.2.m2.2.2.1.1.1.3.3.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.3.3">𝑡</ci></apply><apply id="Sx2.E11.2.m2.2.2.1.1.1.4.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.4"><times id="Sx2.E11.2.m2.2.2.1.1.1.4.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.4.1"></times><ci id="Sx2.E11.2.m2.2.2.1.1.1.4.2.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.4.2">𝛾</ci><apply id="Sx2.E11.2.m2.2.2.1.1.1.4.3.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.4.3"><csymbol cd="ambiguous" id="Sx2.E11.2.m2.2.2.1.1.1.4.3.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.4.3">subscript</csymbol><ci id="Sx2.E11.2.m2.2.2.1.1.1.4.3.2.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.4.3.2">𝛽</ci><cn id="Sx2.E11.2.m2.2.2.1.1.1.4.3.3.cmml" type="integer" xref="Sx2.E11.2.m2.2.2.1.1.1.4.3.3">0</cn></apply><ci id="Sx2.E11.2.m2.1.1.cmml" xref="Sx2.E11.2.m2.1.1">𝒛</ci></apply><apply id="Sx2.E11.2.m2.2.2.1.1.1.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1"><times id="Sx2.E11.2.m2.2.2.1.1.1.1.2.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.2"></times><apply id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1"><minus id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.1"></minus><cn id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.2">1</cn><ci id="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="Sx2.E11.2.m2.2.2.1.1.1.1.3.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.E11.2.m2.2.2.1.1.1.1.3.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="Sx2.E11.2.m2.2.2.1.1.1.1.3.2.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.2">𝛽</ci><apply id="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.3"><minus id="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.1.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.1"></minus><ci id="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.2.cmml" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.2">𝑡</ci><cn id="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.3.cmml" type="integer" xref="Sx2.E11.2.m2.2.2.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.E11.2.m2.2c">\displaystyle=n_{t}+\gamma\beta_{0}(\boldsymbol{z})+(1-\gamma)\beta_{t-1}.</annotation><annotation encoding="application/x-llamapun" id="Sx2.E11.2.m2.2d">= italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT + italic_γ italic_β start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z ) + ( 1 - italic_γ ) italic_β start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11b)</span></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="Sx2.SSx5.p1.17">Here, <math alttext="\alpha_{0}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.9.m1.1"><semantics id="Sx2.SSx5.p1.9.m1.1a"><mrow id="Sx2.SSx5.p1.9.m1.1.2" xref="Sx2.SSx5.p1.9.m1.1.2.cmml"><msub id="Sx2.SSx5.p1.9.m1.1.2.2" xref="Sx2.SSx5.p1.9.m1.1.2.2.cmml"><mi id="Sx2.SSx5.p1.9.m1.1.2.2.2" xref="Sx2.SSx5.p1.9.m1.1.2.2.2.cmml">α</mi><mn id="Sx2.SSx5.p1.9.m1.1.2.2.3" xref="Sx2.SSx5.p1.9.m1.1.2.2.3.cmml">0</mn></msub><mo id="Sx2.SSx5.p1.9.m1.1.2.1" xref="Sx2.SSx5.p1.9.m1.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.9.m1.1.2.3.2" xref="Sx2.SSx5.p1.9.m1.1.2.cmml"><mo id="Sx2.SSx5.p1.9.m1.1.2.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.9.m1.1.2.cmml">(</mo><mi id="Sx2.SSx5.p1.9.m1.1.1" xref="Sx2.SSx5.p1.9.m1.1.1.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.9.m1.1.2.3.2.2" stretchy="false" xref="Sx2.SSx5.p1.9.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.9.m1.1b"><apply id="Sx2.SSx5.p1.9.m1.1.2.cmml" xref="Sx2.SSx5.p1.9.m1.1.2"><times id="Sx2.SSx5.p1.9.m1.1.2.1.cmml" xref="Sx2.SSx5.p1.9.m1.1.2.1"></times><apply id="Sx2.SSx5.p1.9.m1.1.2.2.cmml" xref="Sx2.SSx5.p1.9.m1.1.2.2"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.9.m1.1.2.2.1.cmml" xref="Sx2.SSx5.p1.9.m1.1.2.2">subscript</csymbol><ci id="Sx2.SSx5.p1.9.m1.1.2.2.2.cmml" xref="Sx2.SSx5.p1.9.m1.1.2.2.2">𝛼</ci><cn id="Sx2.SSx5.p1.9.m1.1.2.2.3.cmml" type="integer" xref="Sx2.SSx5.p1.9.m1.1.2.2.3">0</cn></apply><ci id="Sx2.SSx5.p1.9.m1.1.1.cmml" xref="Sx2.SSx5.p1.9.m1.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.9.m1.1c">\alpha_{0}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.9.m1.1d">italic_α start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> and <math alttext="\beta_{0}(\boldsymbol{z})=e^{\zeta_{0}(\boldsymbol{z})}" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.10.m2.2"><semantics id="Sx2.SSx5.p1.10.m2.2a"><mrow id="Sx2.SSx5.p1.10.m2.2.3" xref="Sx2.SSx5.p1.10.m2.2.3.cmml"><mrow id="Sx2.SSx5.p1.10.m2.2.3.2" xref="Sx2.SSx5.p1.10.m2.2.3.2.cmml"><msub id="Sx2.SSx5.p1.10.m2.2.3.2.2" xref="Sx2.SSx5.p1.10.m2.2.3.2.2.cmml"><mi id="Sx2.SSx5.p1.10.m2.2.3.2.2.2" xref="Sx2.SSx5.p1.10.m2.2.3.2.2.2.cmml">β</mi><mn id="Sx2.SSx5.p1.10.m2.2.3.2.2.3" xref="Sx2.SSx5.p1.10.m2.2.3.2.2.3.cmml">0</mn></msub><mo id="Sx2.SSx5.p1.10.m2.2.3.2.1" xref="Sx2.SSx5.p1.10.m2.2.3.2.1.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.10.m2.2.3.2.3.2" xref="Sx2.SSx5.p1.10.m2.2.3.2.cmml"><mo id="Sx2.SSx5.p1.10.m2.2.3.2.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.10.m2.2.3.2.cmml">(</mo><mi id="Sx2.SSx5.p1.10.m2.2.2" xref="Sx2.SSx5.p1.10.m2.2.2.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.10.m2.2.3.2.3.2.2" stretchy="false" xref="Sx2.SSx5.p1.10.m2.2.3.2.cmml">)</mo></mrow></mrow><mo id="Sx2.SSx5.p1.10.m2.2.3.1" xref="Sx2.SSx5.p1.10.m2.2.3.1.cmml">=</mo><msup id="Sx2.SSx5.p1.10.m2.2.3.3" xref="Sx2.SSx5.p1.10.m2.2.3.3.cmml"><mi id="Sx2.SSx5.p1.10.m2.2.3.3.2" xref="Sx2.SSx5.p1.10.m2.2.3.3.2.cmml">e</mi><mrow id="Sx2.SSx5.p1.10.m2.1.1.1" xref="Sx2.SSx5.p1.10.m2.1.1.1.cmml"><msub id="Sx2.SSx5.p1.10.m2.1.1.1.3" xref="Sx2.SSx5.p1.10.m2.1.1.1.3.cmml"><mi id="Sx2.SSx5.p1.10.m2.1.1.1.3.2" xref="Sx2.SSx5.p1.10.m2.1.1.1.3.2.cmml">ζ</mi><mn id="Sx2.SSx5.p1.10.m2.1.1.1.3.3" xref="Sx2.SSx5.p1.10.m2.1.1.1.3.3.cmml">0</mn></msub><mo id="Sx2.SSx5.p1.10.m2.1.1.1.2" xref="Sx2.SSx5.p1.10.m2.1.1.1.2.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.10.m2.1.1.1.4.2" xref="Sx2.SSx5.p1.10.m2.1.1.1.cmml"><mo id="Sx2.SSx5.p1.10.m2.1.1.1.4.2.1" stretchy="false" xref="Sx2.SSx5.p1.10.m2.1.1.1.cmml">(</mo><mi id="Sx2.SSx5.p1.10.m2.1.1.1.1" xref="Sx2.SSx5.p1.10.m2.1.1.1.1.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.10.m2.1.1.1.4.2.2" stretchy="false" xref="Sx2.SSx5.p1.10.m2.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.10.m2.2b"><apply id="Sx2.SSx5.p1.10.m2.2.3.cmml" xref="Sx2.SSx5.p1.10.m2.2.3"><eq id="Sx2.SSx5.p1.10.m2.2.3.1.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.1"></eq><apply id="Sx2.SSx5.p1.10.m2.2.3.2.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.2"><times id="Sx2.SSx5.p1.10.m2.2.3.2.1.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.2.1"></times><apply id="Sx2.SSx5.p1.10.m2.2.3.2.2.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.2.2"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.10.m2.2.3.2.2.1.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.2.2">subscript</csymbol><ci id="Sx2.SSx5.p1.10.m2.2.3.2.2.2.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.2.2.2">𝛽</ci><cn id="Sx2.SSx5.p1.10.m2.2.3.2.2.3.cmml" type="integer" xref="Sx2.SSx5.p1.10.m2.2.3.2.2.3">0</cn></apply><ci id="Sx2.SSx5.p1.10.m2.2.2.cmml" xref="Sx2.SSx5.p1.10.m2.2.2">𝒛</ci></apply><apply id="Sx2.SSx5.p1.10.m2.2.3.3.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.3"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.10.m2.2.3.3.1.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.3">superscript</csymbol><ci id="Sx2.SSx5.p1.10.m2.2.3.3.2.cmml" xref="Sx2.SSx5.p1.10.m2.2.3.3.2">𝑒</ci><apply id="Sx2.SSx5.p1.10.m2.1.1.1.cmml" xref="Sx2.SSx5.p1.10.m2.1.1.1"><times id="Sx2.SSx5.p1.10.m2.1.1.1.2.cmml" xref="Sx2.SSx5.p1.10.m2.1.1.1.2"></times><apply id="Sx2.SSx5.p1.10.m2.1.1.1.3.cmml" xref="Sx2.SSx5.p1.10.m2.1.1.1.3"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.10.m2.1.1.1.3.1.cmml" xref="Sx2.SSx5.p1.10.m2.1.1.1.3">subscript</csymbol><ci id="Sx2.SSx5.p1.10.m2.1.1.1.3.2.cmml" xref="Sx2.SSx5.p1.10.m2.1.1.1.3.2">𝜁</ci><cn id="Sx2.SSx5.p1.10.m2.1.1.1.3.3.cmml" type="integer" xref="Sx2.SSx5.p1.10.m2.1.1.1.3.3">0</cn></apply><ci id="Sx2.SSx5.p1.10.m2.1.1.1.1.cmml" xref="Sx2.SSx5.p1.10.m2.1.1.1.1">𝒛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.10.m2.2c">\beta_{0}(\boldsymbol{z})=e^{\zeta_{0}(\boldsymbol{z})}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.10.m2.2d">italic_β start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z ) = italic_e start_POSTSUPERSCRIPT italic_ζ start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z ) end_POSTSUPERSCRIPT</annotation></semantics></math> are the estimates received from the prior model, <math alttext="n_{t}" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.11.m3.1"><semantics id="Sx2.SSx5.p1.11.m3.1a"><msub id="Sx2.SSx5.p1.11.m3.1.1" xref="Sx2.SSx5.p1.11.m3.1.1.cmml"><mi id="Sx2.SSx5.p1.11.m3.1.1.2" xref="Sx2.SSx5.p1.11.m3.1.1.2.cmml">n</mi><mi id="Sx2.SSx5.p1.11.m3.1.1.3" xref="Sx2.SSx5.p1.11.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.11.m3.1b"><apply id="Sx2.SSx5.p1.11.m3.1.1.cmml" xref="Sx2.SSx5.p1.11.m3.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.11.m3.1.1.1.cmml" xref="Sx2.SSx5.p1.11.m3.1.1">subscript</csymbol><ci id="Sx2.SSx5.p1.11.m3.1.1.2.cmml" xref="Sx2.SSx5.p1.11.m3.1.1.2">𝑛</ci><ci id="Sx2.SSx5.p1.11.m3.1.1.3.cmml" xref="Sx2.SSx5.p1.11.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.11.m3.1c">n_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.11.m3.1d">italic_n start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> denotes the number of observations seen at time <math alttext="t" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.12.m4.1"><semantics id="Sx2.SSx5.p1.12.m4.1a"><mi id="Sx2.SSx5.p1.12.m4.1.1" xref="Sx2.SSx5.p1.12.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.12.m4.1b"><ci id="Sx2.SSx5.p1.12.m4.1.1.cmml" xref="Sx2.SSx5.p1.12.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.12.m4.1c">t</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.12.m4.1d">italic_t</annotation></semantics></math>, and <math alttext="x_{t}^{i}" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.13.m5.1"><semantics id="Sx2.SSx5.p1.13.m5.1a"><msubsup id="Sx2.SSx5.p1.13.m5.1.1" xref="Sx2.SSx5.p1.13.m5.1.1.cmml"><mi id="Sx2.SSx5.p1.13.m5.1.1.2.2" xref="Sx2.SSx5.p1.13.m5.1.1.2.2.cmml">x</mi><mi id="Sx2.SSx5.p1.13.m5.1.1.2.3" xref="Sx2.SSx5.p1.13.m5.1.1.2.3.cmml">t</mi><mi id="Sx2.SSx5.p1.13.m5.1.1.3" xref="Sx2.SSx5.p1.13.m5.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.13.m5.1b"><apply id="Sx2.SSx5.p1.13.m5.1.1.cmml" xref="Sx2.SSx5.p1.13.m5.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.13.m5.1.1.1.cmml" xref="Sx2.SSx5.p1.13.m5.1.1">superscript</csymbol><apply id="Sx2.SSx5.p1.13.m5.1.1.2.cmml" xref="Sx2.SSx5.p1.13.m5.1.1"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.13.m5.1.1.2.1.cmml" xref="Sx2.SSx5.p1.13.m5.1.1">subscript</csymbol><ci id="Sx2.SSx5.p1.13.m5.1.1.2.2.cmml" xref="Sx2.SSx5.p1.13.m5.1.1.2.2">𝑥</ci><ci id="Sx2.SSx5.p1.13.m5.1.1.2.3.cmml" xref="Sx2.SSx5.p1.13.m5.1.1.2.3">𝑡</ci></apply><ci id="Sx2.SSx5.p1.13.m5.1.1.3.cmml" xref="Sx2.SSx5.p1.13.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.13.m5.1c">x_{t}^{i}</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.13.m5.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the user interaction counts of each of the observations <math alttext="i" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.14.m6.1"><semantics id="Sx2.SSx5.p1.14.m6.1a"><mi id="Sx2.SSx5.p1.14.m6.1.1" xref="Sx2.SSx5.p1.14.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.14.m6.1b"><ci id="Sx2.SSx5.p1.14.m6.1.1.cmml" xref="Sx2.SSx5.p1.14.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.14.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.14.m6.1d">italic_i</annotation></semantics></math>. Intuitively, the process can be thought of as updating the posterior parameters based on the observations, while non-stationary effects randomly perturb the parameters in each time period, injecting uncertainty. The parameter <math alttext="\gamma\in[0,1]" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.15.m7.2"><semantics id="Sx2.SSx5.p1.15.m7.2a"><mrow id="Sx2.SSx5.p1.15.m7.2.3" xref="Sx2.SSx5.p1.15.m7.2.3.cmml"><mi id="Sx2.SSx5.p1.15.m7.2.3.2" xref="Sx2.SSx5.p1.15.m7.2.3.2.cmml">γ</mi><mo id="Sx2.SSx5.p1.15.m7.2.3.1" xref="Sx2.SSx5.p1.15.m7.2.3.1.cmml">∈</mo><mrow id="Sx2.SSx5.p1.15.m7.2.3.3.2" xref="Sx2.SSx5.p1.15.m7.2.3.3.1.cmml"><mo id="Sx2.SSx5.p1.15.m7.2.3.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.15.m7.2.3.3.1.cmml">[</mo><mn id="Sx2.SSx5.p1.15.m7.1.1" xref="Sx2.SSx5.p1.15.m7.1.1.cmml">0</mn><mo id="Sx2.SSx5.p1.15.m7.2.3.3.2.2" xref="Sx2.SSx5.p1.15.m7.2.3.3.1.cmml">,</mo><mn id="Sx2.SSx5.p1.15.m7.2.2" xref="Sx2.SSx5.p1.15.m7.2.2.cmml">1</mn><mo id="Sx2.SSx5.p1.15.m7.2.3.3.2.3" stretchy="false" xref="Sx2.SSx5.p1.15.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.15.m7.2b"><apply id="Sx2.SSx5.p1.15.m7.2.3.cmml" xref="Sx2.SSx5.p1.15.m7.2.3"><in id="Sx2.SSx5.p1.15.m7.2.3.1.cmml" xref="Sx2.SSx5.p1.15.m7.2.3.1"></in><ci id="Sx2.SSx5.p1.15.m7.2.3.2.cmml" xref="Sx2.SSx5.p1.15.m7.2.3.2">𝛾</ci><interval closure="closed" id="Sx2.SSx5.p1.15.m7.2.3.3.1.cmml" xref="Sx2.SSx5.p1.15.m7.2.3.3.2"><cn id="Sx2.SSx5.p1.15.m7.1.1.cmml" type="integer" xref="Sx2.SSx5.p1.15.m7.1.1">0</cn><cn id="Sx2.SSx5.p1.15.m7.2.2.cmml" type="integer" xref="Sx2.SSx5.p1.15.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.15.m7.2c">\gamma\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.15.m7.2d">italic_γ ∈ [ 0 , 1 ]</annotation></semantics></math> controls how quickly this uncertainty is injected, under which the parameters will converge to the prior distribution parameters <math alttext="\alpha_{0}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.16.m8.1"><semantics id="Sx2.SSx5.p1.16.m8.1a"><mrow id="Sx2.SSx5.p1.16.m8.1.2" xref="Sx2.SSx5.p1.16.m8.1.2.cmml"><msub id="Sx2.SSx5.p1.16.m8.1.2.2" xref="Sx2.SSx5.p1.16.m8.1.2.2.cmml"><mi id="Sx2.SSx5.p1.16.m8.1.2.2.2" xref="Sx2.SSx5.p1.16.m8.1.2.2.2.cmml">α</mi><mn id="Sx2.SSx5.p1.16.m8.1.2.2.3" xref="Sx2.SSx5.p1.16.m8.1.2.2.3.cmml">0</mn></msub><mo id="Sx2.SSx5.p1.16.m8.1.2.1" xref="Sx2.SSx5.p1.16.m8.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.16.m8.1.2.3.2" xref="Sx2.SSx5.p1.16.m8.1.2.cmml"><mo id="Sx2.SSx5.p1.16.m8.1.2.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.16.m8.1.2.cmml">(</mo><mi id="Sx2.SSx5.p1.16.m8.1.1" xref="Sx2.SSx5.p1.16.m8.1.1.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.16.m8.1.2.3.2.2" stretchy="false" xref="Sx2.SSx5.p1.16.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.16.m8.1b"><apply id="Sx2.SSx5.p1.16.m8.1.2.cmml" xref="Sx2.SSx5.p1.16.m8.1.2"><times id="Sx2.SSx5.p1.16.m8.1.2.1.cmml" xref="Sx2.SSx5.p1.16.m8.1.2.1"></times><apply id="Sx2.SSx5.p1.16.m8.1.2.2.cmml" xref="Sx2.SSx5.p1.16.m8.1.2.2"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.16.m8.1.2.2.1.cmml" xref="Sx2.SSx5.p1.16.m8.1.2.2">subscript</csymbol><ci id="Sx2.SSx5.p1.16.m8.1.2.2.2.cmml" xref="Sx2.SSx5.p1.16.m8.1.2.2.2">𝛼</ci><cn id="Sx2.SSx5.p1.16.m8.1.2.2.3.cmml" type="integer" xref="Sx2.SSx5.p1.16.m8.1.2.2.3">0</cn></apply><ci id="Sx2.SSx5.p1.16.m8.1.1.cmml" xref="Sx2.SSx5.p1.16.m8.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.16.m8.1c">\alpha_{0}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.16.m8.1d">italic_α start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> and <math alttext="\beta_{0}(\boldsymbol{z})" class="ltx_Math" display="inline" id="Sx2.SSx5.p1.17.m9.1"><semantics id="Sx2.SSx5.p1.17.m9.1a"><mrow id="Sx2.SSx5.p1.17.m9.1.2" xref="Sx2.SSx5.p1.17.m9.1.2.cmml"><msub id="Sx2.SSx5.p1.17.m9.1.2.2" xref="Sx2.SSx5.p1.17.m9.1.2.2.cmml"><mi id="Sx2.SSx5.p1.17.m9.1.2.2.2" xref="Sx2.SSx5.p1.17.m9.1.2.2.2.cmml">β</mi><mn id="Sx2.SSx5.p1.17.m9.1.2.2.3" xref="Sx2.SSx5.p1.17.m9.1.2.2.3.cmml">0</mn></msub><mo id="Sx2.SSx5.p1.17.m9.1.2.1" xref="Sx2.SSx5.p1.17.m9.1.2.1.cmml">⁢</mo><mrow id="Sx2.SSx5.p1.17.m9.1.2.3.2" xref="Sx2.SSx5.p1.17.m9.1.2.cmml"><mo id="Sx2.SSx5.p1.17.m9.1.2.3.2.1" stretchy="false" xref="Sx2.SSx5.p1.17.m9.1.2.cmml">(</mo><mi id="Sx2.SSx5.p1.17.m9.1.1" xref="Sx2.SSx5.p1.17.m9.1.1.cmml">𝒛</mi><mo id="Sx2.SSx5.p1.17.m9.1.2.3.2.2" stretchy="false" xref="Sx2.SSx5.p1.17.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx2.SSx5.p1.17.m9.1b"><apply id="Sx2.SSx5.p1.17.m9.1.2.cmml" xref="Sx2.SSx5.p1.17.m9.1.2"><times id="Sx2.SSx5.p1.17.m9.1.2.1.cmml" xref="Sx2.SSx5.p1.17.m9.1.2.1"></times><apply id="Sx2.SSx5.p1.17.m9.1.2.2.cmml" xref="Sx2.SSx5.p1.17.m9.1.2.2"><csymbol cd="ambiguous" id="Sx2.SSx5.p1.17.m9.1.2.2.1.cmml" xref="Sx2.SSx5.p1.17.m9.1.2.2">subscript</csymbol><ci id="Sx2.SSx5.p1.17.m9.1.2.2.2.cmml" xref="Sx2.SSx5.p1.17.m9.1.2.2.2">𝛽</ci><cn id="Sx2.SSx5.p1.17.m9.1.2.2.3.cmml" type="integer" xref="Sx2.SSx5.p1.17.m9.1.2.2.3">0</cn></apply><ci id="Sx2.SSx5.p1.17.m9.1.1.cmml" xref="Sx2.SSx5.p1.17.m9.1.1">𝒛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx2.SSx5.p1.17.m9.1c">\beta_{0}(\boldsymbol{z})</annotation><annotation encoding="application/x-llamapun" id="Sx2.SSx5.p1.17.m9.1d">italic_β start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ( bold_italic_z )</annotation></semantics></math> in the absence of observations. Under this formulation, our model can continuously explore item rankings even on items that are not new. Our method is summarized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.F1" title="Figure 1 ‣ Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">1</span></a> and Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#alg1" title="Algorithm 1 ‣ Neural Network Architecture ‣ Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_table" id="Sx2.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_italic" id="Sx2.T1.4.1">Recall@k</span>, <span class="ltx_text ltx_font_italic" id="Sx2.T1.5.2">Precision@k</span>, and <span class="ltx_text ltx_font_italic" id="Sx2.T1.6.3">NDCG@k</span> of all methods considered across various cold start recommendation datasets.</figcaption>
<p class="ltx_p ltx_align_center" id="Sx2.T1.7"><span class="ltx_text" id="Sx2.T1.7.1">
<span class="ltx_inline-block ltx_transformed_outer" id="Sx2.T1.7.1.1" style="width:441.5pt;height:360pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="Sx2.T1.7.1.1.1"><span class="ltx_text" id="Sx2.T1.7.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="Sx2.T1.7.1.1.1.1.1">
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.1">
<span class="ltx_td ltx_border_tt ltx_colspan ltx_colspan_2" id="Sx2.T1.7.1.1.1.1.1.1.1"></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3" id="Sx2.T1.7.1.1.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.1.2.1">CiteULike</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3" id="Sx2.T1.7.1.1.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.1.3.1">LastFM</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_3" id="Sx2.T1.7.1.1.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.1.4.1">XING</span></span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.2">
<span class="ltx_td ltx_colspan ltx_colspan_2" id="Sx2.T1.7.1.1.1.1.1.2.1"></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.2"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.2.1">@20</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.3"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.3.1">@50</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.4"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.4.1">@100</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.5"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.5.1">@20</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.6"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.6.1">@50</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.7"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.7.1">@100</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.8"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.8.1">@20</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.9"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.9.1">@50</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.2.10"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.2.10.1">@100</span></span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.3">
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_3" id="Sx2.T1.7.1.1.1.1.1.3.1"><span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.3.1.1">KNN</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.2">Recall</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.3">.2192</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.4">.3853</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.5">.5208</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.6">.1354</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.7">.2343</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.8">.3406</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.9">.1222</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.10">.2191</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.3.11">.3011</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.4">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.4.1">Precision</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.4.2">.0479</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.4.3">.0359</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.4.4">.0254</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.4.5">.3065</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.4.6">.2108</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.4.7">.1473</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.4.8">.1498</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.4.9">.1070</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.4.10">.0739</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.5">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.5.1">NDCG</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.5.2">.1500</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.5.3">.2310</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.5.4">.2953</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.5.5">.3537</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.5.6">.2956</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.5.7">.3625</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.5.8">.1722</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.5.9">.2154</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.5.10">.2581</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.6">
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_3" id="Sx2.T1.7.1.1.1.1.1.6.1"><span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.6.1.1">LinMap</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.2">Recall</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.3">.2351</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.4">.4197</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.5">.5738</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.6">.1152</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.7">.2039</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.8">.2946</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.9">.2902</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.10">.4475</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.6.11">.5556</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.7">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.7.1">Precision</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.7.2">.0586</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.7.3">.0420</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.7.4">.0297</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.7.5">.2500</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.7.6">.1776</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.7.7">.1229</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.7.8">.3502</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.7.9">.2179</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.7.10">.1348</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.8">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.8.1">NDCG</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.8.2">.2150</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.8.3">.3049</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.8.4">.3743</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.8.5">.2880</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.8.6">.2547</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.8.7">.3152</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.8.8">.3933</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.8.9">.4558</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.8.10">.4103</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.9">
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_3" id="Sx2.T1.7.1.1.1.1.1.9.1"><span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.9.1.1">NLinMap</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.2">Recall</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.3">.2748</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.4">.4614</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.5">.6251</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.6">.1398</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.7">.2468</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.8">.3462</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.9">.2966</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.10">.4496</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.9.11">.5533</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.10">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.10.1">Precision</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.10.2">.0686</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.10.3">.0469</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.10.4">.0324</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.10.5">.3065</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.10.6">.2156</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.10.7">.1520</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.10.8">.3579</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.10.9">.2191</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.10.10">.1344</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.11">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.11.1">NDCG</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.11.2">.2641</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.11.3">.3585</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.11.4">.4295</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.11.5">.3535</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.11.6">.3105</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.11.7">.3771</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.11.8">.4001</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.11.9">.4583</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.11.10">.5147</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.12">
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_3" id="Sx2.T1.7.1.1.1.1.1.12.1"><span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.12.1.1">DropoutNet</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.2">Recall</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.3">.3275</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.4">.5092</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.5">.6518</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.6">.1351</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.7">.2371</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.8">.3384</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.9">.2417</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.10">.4219</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.12.11">.5638</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.13">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.13.1">Precision</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.13.2">.0770</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.13.3">.0500</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.13.4">.0331</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.13.5">.3001</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.13.6">.2097</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.13.7">.1496</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.13.8">.2921</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.13.9">.2058</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.13.10">.1371</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.14">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.14.1">NDCG</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.14.2">.3089</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.14.3">.4026</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.14.4">.4674</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.14.5">.3439</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.14.6">.3012</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.14.7">.3687</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.14.8">.2761</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.14.9">.3920</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.14.10">.4646</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.15">
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_3" id="Sx2.T1.7.1.1.1.1.1.15.1"><span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.15.1.1">Heater</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.2">Recall</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.3">.3727</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.4">.5533</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.5">.6852</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.6">.1451</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.7">.2575</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.8">.3686</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.9">.3074</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.10">.4727</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.15.11">.5810</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.16">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.16.1">Precision</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.16.2">.0894</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.16.3">.0552</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.16.4"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.16.4.1">.0352</span></span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.16.5"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.16.5.1">.3221</span></span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.16.6">.2279</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.16.7">.1620</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.16.8">.3714</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.16.9">.2308</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.16.10">.1413</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.17">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.17.1">NDCG</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.17.2">.3731</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.17.3">.4673</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.17.4">.5278</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.17.5">.3705</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.17.6">.3270</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.17.7">.3994</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.17.8">.4150</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.17.9">.4798</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.17.10">.5345</span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.18">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t ltx_rowspan ltx_rowspan_3" id="Sx2.T1.7.1.1.1.1.1.18.1"><span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.18.1.1"><span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.18.1.1.1"></span> <span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.18.1.1.2">
<span class="ltx_tabular ltx_align_middle" id="Sx2.T1.7.1.1.1.1.1.18.1.1.2.1">
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.18.1.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.18.1.1.2.1.1.1">BayesCNS</span></span>
</span></span> <span class="ltx_text" id="Sx2.T1.7.1.1.1.1.1.18.1.1.3"></span></span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.2">Recall</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.3"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.3.1">.3833</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.4"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.4.1">.5702</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.5"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.5.1">.7001</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.6"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.6.1">.1507</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.7"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.7.1">.2657</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.8"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.8.1">.3775</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.9"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.9.1">.3120</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.10"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.10.1">.4951</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx2.T1.7.1.1.1.1.1.18.11"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.18.11.1">.5944</span></span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.19">
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.19.1">Precision</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.19.2"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.19.2.1">.0964</span></span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.19.3"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.19.3.1">.0638</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.19.4">.0349</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.19.5">.3190</span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.19.6"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.19.6.1">.2459</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.19.7"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.19.7.1">.1804</span></span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.19.8"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.19.8.1">.3785</span></span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.19.9"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.19.9.1">.2412</span></span>
<span class="ltx_td ltx_align_center" id="Sx2.T1.7.1.1.1.1.1.19.10"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.19.10.1">.1438</span></span></span>
<span class="ltx_tr" id="Sx2.T1.7.1.1.1.1.1.20">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.20.1">NDCG</span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="Sx2.T1.7.1.1.1.1.1.20.2"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.2.1">.3940</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="Sx2.T1.7.1.1.1.1.1.20.3"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.3.1">.4817</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.20.4"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.4.1">.5398</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="Sx2.T1.7.1.1.1.1.1.20.5"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.5.1">.3729</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="Sx2.T1.7.1.1.1.1.1.20.6"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.6.1">.3356</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="Sx2.T1.7.1.1.1.1.1.20.7"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.7.1">.4322</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="Sx2.T1.7.1.1.1.1.1.20.8"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.8.1">.4289</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="Sx2.T1.7.1.1.1.1.1.20.9"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.9.1">.4914</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb" id="Sx2.T1.7.1.1.1.1.1.20.10"><span class="ltx_text ltx_font_bold" id="Sx2.T1.7.1.1.1.1.1.20.10.1">.5476</span></span></span>
</span></span></span>
</span></span></span></p>
</figure>
</section>
</section>
<section class="ltx_section" id="Sx3">
<h2 class="ltx_title ltx_title_section">Related Work</h2>
<section class="ltx_subsubsection" id="Sx3.SSx5.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Cold Start</h4>
<div class="ltx_para" id="Sx3.SSx5.SSSx1.p1">
<p class="ltx_p" id="Sx3.SSx5.SSSx1.p1.1">Cold start is a common issue in search and recommendation systems. Existing approaches to alleviate this problem attempt to inject new items in search results by using heuristics to selectively boost item rankings <cite class="ltx_cite ltx_citemacro_citep">(Taank, Cao, and Gattani <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib45" title="">2017</a>; Haldar et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib19" title="">2020</a>)</cite>. Other solutions involve using side information to make up for the lack of interaction data. This includes using item-specific features <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib31" title="">2019</a>; Van den Oord, Dieleman, and Schrauwen <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib46" title="">2013</a>; Saveski and Mantrach <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib39" title="">2014</a>; Volkovs, Yu, and Poutanen <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib47" title="">2017</a>; Zhu et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib54" title="">2020</a>)</cite>, user features <cite class="ltx_cite ltx_citemacro_citep">(Gantner et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib16" title="">2010</a>; Sedhain et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib42" title="">2017</a>)</cite>, or through transfer learning strategies from different domains <cite class="ltx_cite ltx_citemacro_citep">(Missault et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib33" title="">2021</a>)</cite>. Our approach is orthogonal to these works and can be applied in conjunction with these methods. Recently, <cite class="ltx_cite ltx_citemacro_citet">Han et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib20" title="">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Gupta et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib18" title="">2020</a>)</cite> address cold start by estimating the user interactions of cold items. These methods do not account for non-stationary shifts in user behaviors, limiting their ability to continually explore and learn in dynamic environments.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx3.SSx5.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Non-stationarity</h4>
<div class="ltx_para" id="Sx3.SSx5.SSSx2.p1">
<p class="ltx_p" id="Sx3.SSx5.SSSx2.p1.1">Non-stationarity widely exists in many real-world applications, including in search and recommendation systems <cite class="ltx_cite ltx_citemacro_citep">(Besbes, Gur, and Zeevi <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib6" title="">2014</a>; Pereira et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib37" title="">2018</a>; Jagerman, Markov, and de Rijke <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib25" title="">2019</a>)</cite>. Existing approaches have dealt with non-stationarity for search and recommendation systems within the bandit setting, which may be restrictive and suffer from scalability issues <cite class="ltx_cite ltx_citemacro_citep">(Yu and Mannor <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib52" title="">2009</a>; Li and De Rijke <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib30" title="">2019</a>; Wu, Iyer, and Wang <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib49" title="">2018</a>)</cite>. In practice, search and recommendation systems commonly address non-stationarity by periodically retraining models to deal with distribution shift <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib22" title="">2014</a>)</cite>. This procedure is costly and cannot be done frequently. Moreover, model retraining can be unstable due to the varying quality of the data collected online and may even hurt model generalization <cite class="ltx_cite ltx_citemacro_citep">(Ash and Adams <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib4" title="">2020</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx3.SSx5.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Online Learning to Rank</h4>
<div class="ltx_para" id="Sx3.SSx5.SSSx3.p1">
<p class="ltx_p" id="Sx3.SSx5.SSSx3.p1.1">In Online Learning to Rank (OLTR), rankers are optimized under a stream of user interactions. Rather than modeling user interactions, OLTR perturb ranker parameters and update them based on online user feedback <cite class="ltx_cite ltx_citemacro_citep">(Hofmann et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib23" title="">2013</a>; Oosterhuis and de Rijke <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib36" title="">2018</a>; Schuth et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib41" title="">2016</a>; Yue and Joachims <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib53" title="">2009</a>)</cite>. Although this method addresses biases in labels, it does not consider biases introduced when user interactions are used as features. Furthermore, OLTR faces challenges in dealing with factors that introduce noise into the environment, such as distribution shifts due to seasonality or delayed user feedback <cite class="ltx_cite ltx_citemacro_citep">(Gupta et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib18" title="">2020</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx4">
<h2 class="ltx_title ltx_title_section">Experiments</h2>
<div class="ltx_para" id="Sx4.p1">
<p class="ltx_p" id="Sx4.p1.1">We now empirically study the effect of our method in holistically addressing cold start and non-stationarity. In the following, we test our approach in simulated environments, benchmark datasets, as well as in a real-world search system setting through a large scale A/B test.</p>
</div>
<section class="ltx_subsubsection" id="Sx4.SSx5.SSSx1">
<h4 class="ltx_title ltx_title_subsubsection">Simulation: Stationary Setting</h4>
<div class="ltx_para" id="Sx4.SSx5.SSSx1.p1">
<p class="ltx_p" id="Sx4.SSx5.SSSx1.p1.10">We test our method in a stationary environment with item cold start. Following <cite class="ltx_cite ltx_citemacro_citet">Han et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib20" title="">2022</a>)</cite>, we generate 1,000 queries and 10,000 items described by feature vectors <math alttext="\boldsymbol{z}_{i}^{Q}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.1.m1.1"><semantics id="Sx4.SSx5.SSSx1.p1.1.m1.1a"><msubsup id="Sx4.SSx5.SSSx1.p1.1.m1.1.1" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.2" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.2.cmml">𝒛</mi><mi id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.3" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.3" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1.3.cmml">Q</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.1.m1.1b"><apply id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.2">𝒛</ci><ci id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p1.1.m1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p1.1.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.1.m1.1c">\boldsymbol{z}_{i}^{Q}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.1.m1.1d">bold_italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\boldsymbol{z}_{j}^{D}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.2.m2.1"><semantics id="Sx4.SSx5.SSSx1.p1.2.m2.1a"><msubsup id="Sx4.SSx5.SSSx1.p1.2.m2.1.1" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.2" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.2.cmml">𝒛</mi><mi id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.3" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.3.cmml">j</mi><mi id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.3" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1.3.cmml">D</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.2.m2.1b"><apply id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.2">𝒛</ci><ci id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1.2.3">𝑗</ci></apply><ci id="Sx4.SSx5.SSSx1.p1.2.m2.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p1.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.2.m2.1c">\boldsymbol{z}_{j}^{D}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.2.m2.1d">bold_italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> respectively. For each query <math alttext="q_{i}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.3.m3.1"><semantics id="Sx4.SSx5.SSSx1.p1.3.m3.1a"><msub id="Sx4.SSx5.SSSx1.p1.3.m3.1.1" xref="Sx4.SSx5.SSSx1.p1.3.m3.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p1.3.m3.1.1.2" xref="Sx4.SSx5.SSSx1.p1.3.m3.1.1.2.cmml">q</mi><mi id="Sx4.SSx5.SSSx1.p1.3.m3.1.1.3" xref="Sx4.SSx5.SSSx1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.3.m3.1b"><apply id="Sx4.SSx5.SSSx1.p1.3.m3.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.3.m3.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.3.m3.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.3.m3.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.3.m3.1.1.2">𝑞</ci><ci id="Sx4.SSx5.SSSx1.p1.3.m3.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.3.m3.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.3.m3.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we randomly select a subset of items <math alttext="D_{q_{i}}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.4.m4.1"><semantics id="Sx4.SSx5.SSSx1.p1.4.m4.1a"><msub id="Sx4.SSx5.SSSx1.p1.4.m4.1.1" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.2" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.2.cmml">D</mi><msub id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.2" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.2.cmml">q</mi><mi id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.3" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.4.m4.1b"><apply id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.2">𝐷</ci><apply id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.2">𝑞</ci><ci id="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.4.m4.1c">D_{q_{i}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.4.m4.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> as the match set. We set the size for each <math alttext="D_{q_{i}}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.5.m5.1"><semantics id="Sx4.SSx5.SSSx1.p1.5.m5.1a"><msub id="Sx4.SSx5.SSSx1.p1.5.m5.1.1" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.2" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.2.cmml">D</mi><msub id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.2" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.2.cmml">q</mi><mi id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.3" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.5.m5.1b"><apply id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.2">𝐷</ci><apply id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.2">𝑞</ci><ci id="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.5.m5.1c">D_{q_{i}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> randomly between 5 and 50. We then assign contextual query-item feature vectors <math alttext="\boldsymbol{z}_{ij}^{QD}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.6.m6.1"><semantics id="Sx4.SSx5.SSSx1.p1.6.m6.1a"><msubsup id="Sx4.SSx5.SSSx1.p1.6.m6.1.1" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.2" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.2.cmml">𝒛</mi><mrow id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.2" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.2.cmml">i</mi><mo id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.1" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.1.cmml">⁢</mo><mi id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.3" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.3.cmml">j</mi></mrow><mrow id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.2" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.2.cmml">Q</mi><mo id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.1" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.1.cmml">⁢</mo><mi id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.3" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.3.cmml">D</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.6.m6.1b"><apply id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.2">𝒛</ci><apply id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3"><times id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.1"></times><ci id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.2">𝑖</ci><ci id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.2.3.3">𝑗</ci></apply></apply><apply id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3"><times id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.1"></times><ci id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.2">𝑄</ci><ci id="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.6.m6.1.1.3.3">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.6.m6.1c">\boldsymbol{z}_{ij}^{QD}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.6.m6.1d">bold_italic_z start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>, <math alttext="i=1,\dots,1000" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.7.m7.3"><semantics id="Sx4.SSx5.SSSx1.p1.7.m7.3a"><mrow id="Sx4.SSx5.SSSx1.p1.7.m7.3.4" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.cmml"><mi id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.2" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.2.cmml">i</mi><mo id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.1" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.1.cmml">=</mo><mrow id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.3.2" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.3.1.cmml"><mn id="Sx4.SSx5.SSSx1.p1.7.m7.1.1" xref="Sx4.SSx5.SSSx1.p1.7.m7.1.1.cmml">1</mn><mo id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.3.2.1" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.3.1.cmml">,</mo><mi id="Sx4.SSx5.SSSx1.p1.7.m7.2.2" mathvariant="normal" xref="Sx4.SSx5.SSSx1.p1.7.m7.2.2.cmml">…</mi><mo id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.3.2.2" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.3.1.cmml">,</mo><mn id="Sx4.SSx5.SSSx1.p1.7.m7.3.3" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.3.cmml">1000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.7.m7.3b"><apply id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.cmml" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4"><eq id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.1.cmml" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.1"></eq><ci id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.2.cmml" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.2">𝑖</ci><list id="Sx4.SSx5.SSSx1.p1.7.m7.3.4.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.4.3.2"><cn id="Sx4.SSx5.SSSx1.p1.7.m7.1.1.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p1.7.m7.1.1">1</cn><ci id="Sx4.SSx5.SSSx1.p1.7.m7.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.7.m7.2.2">…</ci><cn id="Sx4.SSx5.SSSx1.p1.7.m7.3.3.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p1.7.m7.3.3">1000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.7.m7.3c">i=1,\dots,1000</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.7.m7.3d">italic_i = 1 , … , 1000</annotation></semantics></math>, <math alttext="j=1,\dots,|D_{q_{j}}|" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.8.m8.3"><semantics id="Sx4.SSx5.SSSx1.p1.8.m8.3a"><mrow id="Sx4.SSx5.SSSx1.p1.8.m8.3.3" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.3" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.3.cmml">j</mi><mo id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.2" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.2.cmml">=</mo><mrow id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.2.cmml"><mn id="Sx4.SSx5.SSSx1.p1.8.m8.1.1" xref="Sx4.SSx5.SSSx1.p1.8.m8.1.1.cmml">1</mn><mo id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.2" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.2.cmml">,</mo><mi id="Sx4.SSx5.SSSx1.p1.8.m8.2.2" mathvariant="normal" xref="Sx4.SSx5.SSSx1.p1.8.m8.2.2.cmml">…</mi><mo id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.3" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.2.cmml">,</mo><mrow id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.2.cmml"><mo id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.2" stretchy="false" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.2.1.cmml">|</mo><msub id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.2" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.2.cmml">D</mi><msub id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.2" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.2.cmml">q</mi><mi id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.3" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.3.cmml">j</mi></msub></msub><mo id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.3" stretchy="false" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.8.m8.3b"><apply id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3"><eq id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.2"></eq><ci id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.3">𝑗</ci><list id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1"><cn id="Sx4.SSx5.SSSx1.p1.8.m8.1.1.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p1.8.m8.1.1">1</cn><ci id="Sx4.SSx5.SSSx1.p1.8.m8.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.2.2">…</ci><apply id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1"><abs id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.2"></abs><apply id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.2">𝐷</ci><apply id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.2">𝑞</ci><ci id="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.8.m8.3.3.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.8.m8.3c">j=1,\dots,|D_{q_{j}}|</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.8.m8.3d">italic_j = 1 , … , | italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT |</annotation></semantics></math> for each pair. To simplify the simulation, we define all the features as scalars, and assign their value uniformly at random between <math alttext="[0,1]" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.9.m9.2"><semantics id="Sx4.SSx5.SSSx1.p1.9.m9.2a"><mrow id="Sx4.SSx5.SSSx1.p1.9.m9.2.3.2" xref="Sx4.SSx5.SSSx1.p1.9.m9.2.3.1.cmml"><mo id="Sx4.SSx5.SSSx1.p1.9.m9.2.3.2.1" stretchy="false" xref="Sx4.SSx5.SSSx1.p1.9.m9.2.3.1.cmml">[</mo><mn id="Sx4.SSx5.SSSx1.p1.9.m9.1.1" xref="Sx4.SSx5.SSSx1.p1.9.m9.1.1.cmml">0</mn><mo id="Sx4.SSx5.SSSx1.p1.9.m9.2.3.2.2" xref="Sx4.SSx5.SSSx1.p1.9.m9.2.3.1.cmml">,</mo><mn id="Sx4.SSx5.SSSx1.p1.9.m9.2.2" xref="Sx4.SSx5.SSSx1.p1.9.m9.2.2.cmml">1</mn><mo id="Sx4.SSx5.SSSx1.p1.9.m9.2.3.2.3" stretchy="false" xref="Sx4.SSx5.SSSx1.p1.9.m9.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.9.m9.2b"><interval closure="closed" id="Sx4.SSx5.SSSx1.p1.9.m9.2.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.9.m9.2.3.2"><cn id="Sx4.SSx5.SSSx1.p1.9.m9.1.1.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p1.9.m9.1.1">0</cn><cn id="Sx4.SSx5.SSSx1.p1.9.m9.2.2.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p1.9.m9.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.9.m9.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.9.m9.2d">[ 0 , 1 ]</annotation></semantics></math>. Thus, the contextual features are vectors <math alttext="\boldsymbol{z}_{i}^{j}=[\boldsymbol{z}_{i}^{Q},\boldsymbol{z}_{j}^{D},%
\boldsymbol{z}_{ij}^{QD}]" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p1.10.m10.3"><semantics id="Sx4.SSx5.SSSx1.p1.10.m10.3a"><mrow id="Sx4.SSx5.SSSx1.p1.10.m10.3.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.cmml"><msubsup id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.cmml"><mi id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.2" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.2.cmml">𝒛</mi><mi id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.4" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.4.cmml">=</mo><mrow id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.4.cmml"><mo id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.4" stretchy="false" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.4.cmml">[</mo><msubsup id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.2" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.2.cmml">𝒛</mi><mi id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.3.cmml">Q</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.5" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.4.cmml">,</mo><msubsup id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.cmml"><mi id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.2" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.2.cmml">𝒛</mi><mi id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.3.cmml">j</mi><mi id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.3.cmml">D</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.6" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.4.cmml">,</mo><msubsup id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.2" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.2.cmml">𝒛</mi><mrow id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.2" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.2.cmml">i</mi><mo id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.1" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.3.cmml">j</mi></mrow><mrow id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.cmml"><mi id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.2" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.2.cmml">Q</mi><mo id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.1" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.1.cmml">⁢</mo><mi id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.3" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.3.cmml">D</mi></mrow></msubsup><mo id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.7" stretchy="false" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p1.10.m10.3b"><apply id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3"><eq id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.4.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.4"></eq><apply id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.2">𝒛</ci><ci id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.5.3">𝑗</ci></apply><list id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.4.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3"><apply id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.2">𝒛</ci><ci id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.1.1.1.1.1.3">𝑄</ci></apply><apply id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.2">𝒛</ci><ci id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.2.2.2.2.2.3">𝐷</ci></apply><apply id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.2">𝒛</ci><apply id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3"><times id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.1"></times><ci id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.2">𝑖</ci><ci id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.2.3.3">𝑗</ci></apply></apply><apply id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3"><times id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.1.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.1"></times><ci id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.2.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.2">𝑄</ci><ci id="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.3.cmml" xref="Sx4.SSx5.SSSx1.p1.10.m10.3.3.3.3.3.3.3">𝐷</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p1.10.m10.3c">\boldsymbol{z}_{i}^{j}=[\boldsymbol{z}_{i}^{Q},\boldsymbol{z}_{j}^{D},%
\boldsymbol{z}_{ij}^{QD}]</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p1.10.m10.3d">bold_italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT = [ bold_italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q end_POSTSUPERSCRIPT , bold_italic_z start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT , bold_italic_z start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_Q italic_D end_POSTSUPERSCRIPT ]</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="Sx4.SSx5.SSSx1.p2">
<p class="ltx_p" id="Sx4.SSx5.SSSx1.p2.3">We model the attractiveness <math alttext="p_{i}^{j}\in[0,1]" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.1.m1.2"><semantics id="Sx4.SSx5.SSSx1.p2.1.m1.2a"><mrow id="Sx4.SSx5.SSSx1.p2.1.m1.2.3" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.cmml"><msubsup id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.cmml"><mi id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.2" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.2.cmml">p</mi><mi id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.3" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.3" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.1" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.1.cmml">∈</mo><mrow id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.2" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.1.cmml"><mo id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.2.1" stretchy="false" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.1.cmml">[</mo><mn id="Sx4.SSx5.SSSx1.p2.1.m1.1.1" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1.cmml">0</mn><mo id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.2.2" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.1.cmml">,</mo><mn id="Sx4.SSx5.SSSx1.p2.1.m1.2.2" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.2.cmml">1</mn><mo id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.2.3" stretchy="false" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.1.m1.2b"><apply id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3"><in id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.1.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.1"></in><apply id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.2">𝑝</ci><ci id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.2.3">𝑗</ci></apply><interval closure="closed" id="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.1.cmml" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.3.3.2"><cn id="Sx4.SSx5.SSSx1.p2.1.m1.1.1.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p2.1.m1.1.1">0</cn><cn id="Sx4.SSx5.SSSx1.p2.1.m1.2.2.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p2.1.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.1.m1.2c">p_{i}^{j}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.1.m1.2d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math> of an item <math alttext="j" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.2.m2.1"><semantics id="Sx4.SSx5.SSSx1.p2.2.m2.1a"><mi id="Sx4.SSx5.SSSx1.p2.2.m2.1.1" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.2.m2.1b"><ci id="Sx4.SSx5.SSSx1.p2.2.m2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.2.m2.1c">j</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.2.m2.1d">italic_j</annotation></semantics></math> given a query <math alttext="i" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.3.m3.1"><semantics id="Sx4.SSx5.SSSx1.p2.3.m3.1a"><mi id="Sx4.SSx5.SSSx1.p2.3.m3.1.1" xref="Sx4.SSx5.SSSx1.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.3.m3.1b"><ci id="Sx4.SSx5.SSSx1.p2.3.m3.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.3.m3.1d">italic_i</annotation></semantics></math> as a noisy linear model:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{i}^{j}=w\boldsymbol{v}^{T}\boldsymbol{z}_{i}^{j}+(1-w)\epsilon_{i}^{j}." class="ltx_Math" display="block" id="Sx4.E12.m1.1"><semantics id="Sx4.E12.m1.1a"><mrow id="Sx4.E12.m1.1.1.1" xref="Sx4.E12.m1.1.1.1.1.cmml"><mrow id="Sx4.E12.m1.1.1.1.1" xref="Sx4.E12.m1.1.1.1.1.cmml"><msubsup id="Sx4.E12.m1.1.1.1.1.3" xref="Sx4.E12.m1.1.1.1.1.3.cmml"><mi id="Sx4.E12.m1.1.1.1.1.3.2.2" xref="Sx4.E12.m1.1.1.1.1.3.2.2.cmml">p</mi><mi id="Sx4.E12.m1.1.1.1.1.3.2.3" xref="Sx4.E12.m1.1.1.1.1.3.2.3.cmml">i</mi><mi id="Sx4.E12.m1.1.1.1.1.3.3" xref="Sx4.E12.m1.1.1.1.1.3.3.cmml">j</mi></msubsup><mo id="Sx4.E12.m1.1.1.1.1.2" xref="Sx4.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="Sx4.E12.m1.1.1.1.1.1" xref="Sx4.E12.m1.1.1.1.1.1.cmml"><mrow id="Sx4.E12.m1.1.1.1.1.1.3" xref="Sx4.E12.m1.1.1.1.1.1.3.cmml"><mi id="Sx4.E12.m1.1.1.1.1.1.3.2" xref="Sx4.E12.m1.1.1.1.1.1.3.2.cmml">w</mi><mo id="Sx4.E12.m1.1.1.1.1.1.3.1" xref="Sx4.E12.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="Sx4.E12.m1.1.1.1.1.1.3.3" xref="Sx4.E12.m1.1.1.1.1.1.3.3.cmml"><mi id="Sx4.E12.m1.1.1.1.1.1.3.3.2" xref="Sx4.E12.m1.1.1.1.1.1.3.3.2.cmml">𝒗</mi><mi id="Sx4.E12.m1.1.1.1.1.1.3.3.3" xref="Sx4.E12.m1.1.1.1.1.1.3.3.3.cmml">T</mi></msup><mo id="Sx4.E12.m1.1.1.1.1.1.3.1a" xref="Sx4.E12.m1.1.1.1.1.1.3.1.cmml">⁢</mo><msubsup id="Sx4.E12.m1.1.1.1.1.1.3.4" xref="Sx4.E12.m1.1.1.1.1.1.3.4.cmml"><mi id="Sx4.E12.m1.1.1.1.1.1.3.4.2.2" xref="Sx4.E12.m1.1.1.1.1.1.3.4.2.2.cmml">𝒛</mi><mi id="Sx4.E12.m1.1.1.1.1.1.3.4.2.3" xref="Sx4.E12.m1.1.1.1.1.1.3.4.2.3.cmml">i</mi><mi id="Sx4.E12.m1.1.1.1.1.1.3.4.3" xref="Sx4.E12.m1.1.1.1.1.1.3.4.3.cmml">j</mi></msubsup></mrow><mo id="Sx4.E12.m1.1.1.1.1.1.2" xref="Sx4.E12.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="Sx4.E12.m1.1.1.1.1.1.1" xref="Sx4.E12.m1.1.1.1.1.1.1.cmml"><mrow id="Sx4.E12.m1.1.1.1.1.1.1.1.1" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="Sx4.E12.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.E12.m1.1.1.1.1.1.1.1.1.1" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.2" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.1" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.3" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.3.cmml">w</mi></mrow><mo id="Sx4.E12.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Sx4.E12.m1.1.1.1.1.1.1.2" xref="Sx4.E12.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="Sx4.E12.m1.1.1.1.1.1.1.3" xref="Sx4.E12.m1.1.1.1.1.1.1.3.cmml"><mi id="Sx4.E12.m1.1.1.1.1.1.1.3.2.2" xref="Sx4.E12.m1.1.1.1.1.1.1.3.2.2.cmml">ϵ</mi><mi id="Sx4.E12.m1.1.1.1.1.1.1.3.2.3" xref="Sx4.E12.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="Sx4.E12.m1.1.1.1.1.1.1.3.3" xref="Sx4.E12.m1.1.1.1.1.1.1.3.3.cmml">j</mi></msubsup></mrow></mrow></mrow><mo id="Sx4.E12.m1.1.1.1.2" lspace="0em" xref="Sx4.E12.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E12.m1.1b"><apply id="Sx4.E12.m1.1.1.1.1.cmml" xref="Sx4.E12.m1.1.1.1"><eq id="Sx4.E12.m1.1.1.1.1.2.cmml" xref="Sx4.E12.m1.1.1.1.1.2"></eq><apply id="Sx4.E12.m1.1.1.1.1.3.cmml" xref="Sx4.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.E12.m1.1.1.1.1.3.1.cmml" xref="Sx4.E12.m1.1.1.1.1.3">superscript</csymbol><apply id="Sx4.E12.m1.1.1.1.1.3.2.cmml" xref="Sx4.E12.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.E12.m1.1.1.1.1.3.2.1.cmml" xref="Sx4.E12.m1.1.1.1.1.3">subscript</csymbol><ci id="Sx4.E12.m1.1.1.1.1.3.2.2.cmml" xref="Sx4.E12.m1.1.1.1.1.3.2.2">𝑝</ci><ci id="Sx4.E12.m1.1.1.1.1.3.2.3.cmml" xref="Sx4.E12.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="Sx4.E12.m1.1.1.1.1.3.3.cmml" xref="Sx4.E12.m1.1.1.1.1.3.3">𝑗</ci></apply><apply id="Sx4.E12.m1.1.1.1.1.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1"><plus id="Sx4.E12.m1.1.1.1.1.1.2.cmml" xref="Sx4.E12.m1.1.1.1.1.1.2"></plus><apply id="Sx4.E12.m1.1.1.1.1.1.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3"><times id="Sx4.E12.m1.1.1.1.1.1.3.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.1"></times><ci id="Sx4.E12.m1.1.1.1.1.1.3.2.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.2">𝑤</ci><apply id="Sx4.E12.m1.1.1.1.1.1.3.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx4.E12.m1.1.1.1.1.1.3.3.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.3">superscript</csymbol><ci id="Sx4.E12.m1.1.1.1.1.1.3.3.2.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.3.2">𝒗</ci><ci id="Sx4.E12.m1.1.1.1.1.1.3.3.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.3.3">𝑇</ci></apply><apply id="Sx4.E12.m1.1.1.1.1.1.3.4.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="Sx4.E12.m1.1.1.1.1.1.3.4.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.4">superscript</csymbol><apply id="Sx4.E12.m1.1.1.1.1.1.3.4.2.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="Sx4.E12.m1.1.1.1.1.1.3.4.2.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.4">subscript</csymbol><ci id="Sx4.E12.m1.1.1.1.1.1.3.4.2.2.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.4.2.2">𝒛</ci><ci id="Sx4.E12.m1.1.1.1.1.1.3.4.2.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.4.2.3">𝑖</ci></apply><ci id="Sx4.E12.m1.1.1.1.1.1.3.4.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.3.4.3">𝑗</ci></apply></apply><apply id="Sx4.E12.m1.1.1.1.1.1.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1"><times id="Sx4.E12.m1.1.1.1.1.1.1.2.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.2"></times><apply id="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1"><minus id="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.1.1.1.3">𝑤</ci></apply><apply id="Sx4.E12.m1.1.1.1.1.1.1.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.E12.m1.1.1.1.1.1.1.3.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx4.E12.m1.1.1.1.1.1.1.3.2.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.E12.m1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx4.E12.m1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.3.2.2">italic-ϵ</ci><ci id="Sx4.E12.m1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="Sx4.E12.m1.1.1.1.1.1.1.3.3.cmml" xref="Sx4.E12.m1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E12.m1.1c">p_{i}^{j}=w\boldsymbol{v}^{T}\boldsymbol{z}_{i}^{j}+(1-w)\epsilon_{i}^{j}.</annotation><annotation encoding="application/x-llamapun" id="Sx4.E12.m1.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT = italic_w bold_italic_v start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT bold_italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT + ( 1 - italic_w ) italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.SSx5.SSSx1.p2.13">Here, <math alttext="\boldsymbol{v}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.4.m1.1"><semantics id="Sx4.SSx5.SSSx1.p2.4.m1.1a"><mi id="Sx4.SSx5.SSSx1.p2.4.m1.1.1" xref="Sx4.SSx5.SSSx1.p2.4.m1.1.1.cmml">𝒗</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.4.m1.1b"><ci id="Sx4.SSx5.SSSx1.p2.4.m1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.4.m1.1.1">𝒗</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.4.m1.1c">\boldsymbol{v}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.4.m1.1d">bold_italic_v</annotation></semantics></math> is a unit length vector, with <math alttext="|\boldsymbol{v}|_{1}=1" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.5.m2.1"><semantics id="Sx4.SSx5.SSSx1.p2.5.m2.1a"><mrow id="Sx4.SSx5.SSSx1.p2.5.m2.1.2" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.cmml"><msub id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.cmml"><mrow id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.2" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.1.cmml"><mo id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.2.1" stretchy="false" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.1.1.cmml">|</mo><mi id="Sx4.SSx5.SSSx1.p2.5.m2.1.1" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.1.cmml">𝒗</mi><mo id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.2.2" stretchy="false" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.1.1.cmml">|</mo></mrow><mn id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.3" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.3.cmml">1</mn></msub><mo id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.1" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.1.cmml">=</mo><mn id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.3" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.5.m2.1b"><apply id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.cmml" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2"><eq id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.1"></eq><apply id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2">subscript</csymbol><apply id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.2"><abs id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.2.2.1"></abs><ci id="Sx4.SSx5.SSSx1.p2.5.m2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.1">𝒗</ci></apply><cn id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.3.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.2.3">1</cn></apply><cn id="Sx4.SSx5.SSSx1.p2.5.m2.1.2.3.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p2.5.m2.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.5.m2.1c">|\boldsymbol{v}|_{1}=1</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.5.m2.1d">| bold_italic_v | start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 1</annotation></semantics></math>, which determines the effect of the contextual features <math alttext="\boldsymbol{z}_{i}^{j}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.6.m3.1"><semantics id="Sx4.SSx5.SSSx1.p2.6.m3.1a"><msubsup id="Sx4.SSx5.SSSx1.p2.6.m3.1.1" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.2" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.2.cmml">𝒛</mi><mi id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.3" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.3" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.6.m3.1b"><apply id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.2">𝒛</ci><ci id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p2.6.m3.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p2.6.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.6.m3.1c">\boldsymbol{z}_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.6.m3.1d">bold_italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> on the item attractiveness. Meanwhile, <math alttext="\epsilon_{i}^{j}\in[0,1]" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.7.m4.2"><semantics id="Sx4.SSx5.SSSx1.p2.7.m4.2a"><mrow id="Sx4.SSx5.SSSx1.p2.7.m4.2.3" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.cmml"><msubsup id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.cmml"><mi id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.2" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.2.cmml">ϵ</mi><mi id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.3" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.3" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.1" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.1.cmml">∈</mo><mrow id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.2" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.1.cmml"><mo id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.2.1" stretchy="false" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.1.cmml">[</mo><mn id="Sx4.SSx5.SSSx1.p2.7.m4.1.1" xref="Sx4.SSx5.SSSx1.p2.7.m4.1.1.cmml">0</mn><mo id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.2.2" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.1.cmml">,</mo><mn id="Sx4.SSx5.SSSx1.p2.7.m4.2.2" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.2.cmml">1</mn><mo id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.2.3" stretchy="false" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.7.m4.2b"><apply id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3"><in id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.1.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.1"></in><apply id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.2">italic-ϵ</ci><ci id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.2.3">𝑗</ci></apply><interval closure="closed" id="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.1.cmml" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.3.3.2"><cn id="Sx4.SSx5.SSSx1.p2.7.m4.1.1.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p2.7.m4.1.1">0</cn><cn id="Sx4.SSx5.SSSx1.p2.7.m4.2.2.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p2.7.m4.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.7.m4.2c">\epsilon_{i}^{j}\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.7.m4.2d">italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ∈ [ 0 , 1 ]</annotation></semantics></math> are uniform random variables determining the inherent query-item attractiveness. The strength in which the contextual features <math alttext="\boldsymbol{z}_{i}^{j}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.8.m5.1"><semantics id="Sx4.SSx5.SSSx1.p2.8.m5.1a"><msubsup id="Sx4.SSx5.SSSx1.p2.8.m5.1.1" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.2" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.2.cmml">𝒛</mi><mi id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.3" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.3" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.8.m5.1b"><apply id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.2">𝒛</ci><ci id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p2.8.m5.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p2.8.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.8.m5.1c">\boldsymbol{z}_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.8.m5.1d">bold_italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> affect the overall attractiveness <math alttext="p_{i}^{j}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.9.m6.1"><semantics id="Sx4.SSx5.SSSx1.p2.9.m6.1a"><msubsup id="Sx4.SSx5.SSSx1.p2.9.m6.1.1" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.2" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.2.cmml">p</mi><mi id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.3" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.3" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.9.m6.1b"><apply id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.2">𝑝</ci><ci id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p2.9.m6.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p2.9.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.9.m6.1c">p_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.9.m6.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> is determined by <math alttext="w\in[0,1]" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.10.m7.2"><semantics id="Sx4.SSx5.SSSx1.p2.10.m7.2a"><mrow id="Sx4.SSx5.SSSx1.p2.10.m7.2.3" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.cmml"><mi id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.2" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.2.cmml">w</mi><mo id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.1" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.1.cmml">∈</mo><mrow id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.2" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.1.cmml"><mo id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.2.1" stretchy="false" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.1.cmml">[</mo><mn id="Sx4.SSx5.SSSx1.p2.10.m7.1.1" xref="Sx4.SSx5.SSSx1.p2.10.m7.1.1.cmml">0</mn><mo id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.2.2" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.1.cmml">,</mo><mn id="Sx4.SSx5.SSSx1.p2.10.m7.2.2" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.2.cmml">1</mn><mo id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.2.3" stretchy="false" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.10.m7.2b"><apply id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3"><in id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.1.cmml" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.1"></in><ci id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.2.cmml" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.2">𝑤</ci><interval closure="closed" id="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.1.cmml" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.3.3.2"><cn id="Sx4.SSx5.SSSx1.p2.10.m7.1.1.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p2.10.m7.1.1">0</cn><cn id="Sx4.SSx5.SSSx1.p2.10.m7.2.2.cmml" type="integer" xref="Sx4.SSx5.SSSx1.p2.10.m7.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.10.m7.2c">w\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.10.m7.2d">italic_w ∈ [ 0 , 1 ]</annotation></semantics></math>, which is termed the <span class="ltx_text ltx_font_italic" id="Sx4.SSx5.SSSx1.p2.13.1">predictive power</span> of the contextual features. We vary this weight to study the robustness of various methods under different simulated environments. For small <math alttext="w" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.11.m8.1"><semantics id="Sx4.SSx5.SSSx1.p2.11.m8.1a"><mi id="Sx4.SSx5.SSSx1.p2.11.m8.1.1" xref="Sx4.SSx5.SSSx1.p2.11.m8.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.11.m8.1b"><ci id="Sx4.SSx5.SSSx1.p2.11.m8.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.11.m8.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.11.m8.1c">w</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.11.m8.1d">italic_w</annotation></semantics></math>, the random inherent attractiveness <math alttext="\epsilon_{i}^{j}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.12.m9.1"><semantics id="Sx4.SSx5.SSSx1.p2.12.m9.1a"><msubsup id="Sx4.SSx5.SSSx1.p2.12.m9.1.1" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.2" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.2.cmml">ϵ</mi><mi id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.3" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.3" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.12.m9.1b"><apply id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.2">italic-ϵ</ci><ci id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p2.12.m9.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p2.12.m9.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.12.m9.1c">\epsilon_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.12.m9.1d">italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> dominates the overall item attractiveness. Meanwhile, for large <math alttext="w" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p2.13.m10.1"><semantics id="Sx4.SSx5.SSSx1.p2.13.m10.1a"><mi id="Sx4.SSx5.SSSx1.p2.13.m10.1.1" xref="Sx4.SSx5.SSSx1.p2.13.m10.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p2.13.m10.1b"><ci id="Sx4.SSx5.SSSx1.p2.13.m10.1.1.cmml" xref="Sx4.SSx5.SSSx1.p2.13.m10.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p2.13.m10.1c">w</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p2.13.m10.1d">italic_w</annotation></semantics></math>, the contextual features are more predictive of overall item attractiveness.</p>
</div>
<figure class="ltx_table" id="Sx4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance metrics of our proposed approach in an online A/B experiment. New Items (%) denote the percentage of new items introduced relative to the original index size. Success rate (Succ.) measures the amount of favorable actions performed by users. Impression (+%) measures the amount of new items shown to the user. Statistical significance denoted by asterisks (*) (p-value <math alttext="&lt;0.05" class="ltx_Math" display="inline" id="Sx4.T2.2.m1.1"><semantics id="Sx4.T2.2.m1.1b"><mrow id="Sx4.T2.2.m1.1.1" xref="Sx4.T2.2.m1.1.1.cmml"><mi id="Sx4.T2.2.m1.1.1.2" xref="Sx4.T2.2.m1.1.1.2.cmml"></mi><mo id="Sx4.T2.2.m1.1.1.1" xref="Sx4.T2.2.m1.1.1.1.cmml">&lt;</mo><mn id="Sx4.T2.2.m1.1.1.3" xref="Sx4.T2.2.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.T2.2.m1.1c"><apply id="Sx4.T2.2.m1.1.1.cmml" xref="Sx4.T2.2.m1.1.1"><lt id="Sx4.T2.2.m1.1.1.1.cmml" xref="Sx4.T2.2.m1.1.1.1"></lt><csymbol cd="latexml" id="Sx4.T2.2.m1.1.1.2.cmml" xref="Sx4.T2.2.m1.1.1.2">absent</csymbol><cn id="Sx4.T2.2.m1.1.1.3.cmml" type="float" xref="Sx4.T2.2.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T2.2.m1.1d">&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="Sx4.T2.2.m1.1e">&lt; 0.05</annotation></semantics></math> by paired t-test).</figcaption>
<p class="ltx_p ltx_align_center" id="Sx4.T2.3"><span class="ltx_text ltx_inline-block" id="Sx4.T2.3.1" style="width:433.6pt;">
<span class="ltx_inline-block ltx_transformed_outer" id="Sx4.T2.3.1.1" style="width:505.9pt;height:128.7pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-32.1pt,8.1pt) scale(0.88735,0.88735) ;">
<span class="ltx_p" id="Sx4.T2.3.1.1.1"><span class="ltx_text" id="Sx4.T2.3.1.1.1.1">
<span class="ltx_inline-block ltx_transformed_outer" id="Sx4.T2.3.1.1.1.1.1" style="width:570.1pt;height:145pt;vertical-align:-1.0pt;"><span class="ltx_transformed_inner" style="transform:translate(0.0pt,0.0pt) scale(1,1) ;">
<span class="ltx_p" id="Sx4.T2.3.1.1.1.1.1.1"><span class="ltx_text" id="Sx4.T2.3.1.1.1.1.1.1.1">
<span class="ltx_tabular ltx_align_middle" id="Sx4.T2.3.1.1.1.1.1.1.1.1">
<span class="ltx_tr" id="Sx4.T2.3.1.1.1.1.1.1.1.1.1">
<span class="ltx_td ltx_align_center ltx_border_tt ltx_rowspan ltx_rowspan_2" id="Sx4.T2.3.1.1.1.1.1.1.1.1.1.1"><span class="ltx_text" id="Sx4.T2.3.1.1.1.1.1.1.1.1.1.1.1">Cohort</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_rowspan ltx_rowspan_2" id="Sx4.T2.3.1.1.1.1.1.1.1.1.1.2"><span class="ltx_text" id="Sx4.T2.3.1.1.1.1.1.1.1.1.1.2.1">New Items (%)</span></span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="Sx4.T2.3.1.1.1.1.1.1.1.1.1.3">Base</span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="Sx4.T2.3.1.1.1.1.1.1.1.1.1.4">Test (Ours)</span>
<span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_2" id="Sx4.T2.3.1.1.1.1.1.1.1.1.1.5">Difference</span></span>
<span class="ltx_tr" id="Sx4.T2.3.1.1.1.1.1.1.1.1.2">
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.2.1">Succ. (+%)</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.2.2">Impression (+%)</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.2.3">Succ. (+%)</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.2.4">Impression (+%)</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.2.5">Succ. (+%)</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.2.6">Impression (+%)</span></span>
<span class="ltx_tr" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3">
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.1">1</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.2">0.96</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.3">0.97</span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.4">1.64</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.5"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.5.1">0.98</span></span>
<span class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.6"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.6.1">3.21</span></span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.7">0.01</span>
<span class="ltx_td ltx_align_center ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.3.8">1.57</span></span>
<span class="ltx_tr" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4">
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.1">2</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.2">14.04</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.3">1.97</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.4">10.28</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.5"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.5.1">4.42</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.6"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.6.1">38.83</span></span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.7">2.45*</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.4.8">28.55*</span></span>
<span class="ltx_tr" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5">
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.1">3</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.2">15.80</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.3">2.52</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.4">12.55</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.5"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.5.1">2.83</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.6"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.6.1">15.10</span></span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.7">0.31</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.5.8">2.55*</span></span>
<span class="ltx_tr" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6">
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.1">4</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.2">19.37</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.3">2.31</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.4">12.04</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.5"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.5.1">7.48</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.6"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.6.1">46.21</span></span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.7">5.17*</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.6.8">34.17*</span></span>
<span class="ltx_tr" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7">
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.1">5</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.2">24.94</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.3">2.99</span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.4">14.13</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.5"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.5.1">5.42</span></span>
<span class="ltx_td ltx_align_center ltx_border_r" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.6"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.6.1">32.56</span></span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.7">2.43*</span>
<span class="ltx_td ltx_align_center" id="Sx4.T2.3.1.1.1.1.1.1.1.1.7.8">18.43*</span></span>
<span class="ltx_tr" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8">
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.1">Overall</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.2">22.81</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.3">1.76</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.4">7.62</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.5"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.5.1">2.81</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.6"><span class="ltx_text ltx_font_bold" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.6.1">18.22</span></span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.7">1.05*</span>
<span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="Sx4.T2.3.1.1.1.1.1.1.1.1.8.8">10.60*</span></span>
</span></span></span>
</span></span></span></span>
</span></span>
</span></p>
</figure>
<div class="ltx_para" id="Sx4.SSx5.SSSx1.p3">
<p class="ltx_p" id="Sx4.SSx5.SSSx1.p3.3">To simplify the simulation, we limit the user interactions to be a single scalar feature denoting the amount of clicks for each query-item pair. With this, we can simulate clicks <math alttext="c_{i}^{j}\sim\text{Bern}(p_{i}^{j})" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p3.1.m1.1"><semantics id="Sx4.SSx5.SSSx1.p3.1.m1.1a"><mrow id="Sx4.SSx5.SSSx1.p3.1.m1.1.1" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.cmml"><msubsup id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.cmml"><mi id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.2" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.2.cmml">c</mi><mi id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.3" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.3" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.2" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.2.cmml">∼</mo><mrow id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.cmml"><mtext id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.3" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.3a.cmml">Bern</mtext><mo id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.2" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.cmml"><mo id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.2" stretchy="false" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.2" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.3" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.3" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.3" stretchy="false" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p3.1.m1.1b"><apply id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1"><csymbol cd="latexml" id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.2">similar-to</csymbol><apply id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.1.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.1.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.2">𝑐</ci><ci id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.3.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.3.3">𝑗</ci></apply><apply id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1"><times id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.2"></times><ci id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.3a.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.3"><mtext id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.3">Bern</mtext></ci><apply id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p3.1.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p3.1.m1.1c">c_{i}^{j}\sim\text{Bern}(p_{i}^{j})</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p3.1.m1.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ∼ Bern ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT )</annotation></semantics></math> and generate data for training a ranker model and the empirical Bayes prior. Specifically, we can generate user interaction features from a binomial distribution <math alttext="x_{i}^{j}\sim\text{Bin}(n_{i}^{j},p_{i}^{j})" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p3.2.m2.2"><semantics id="Sx4.SSx5.SSSx1.p3.2.m2.2a"><mrow id="Sx4.SSx5.SSSx1.p3.2.m2.2.2" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.cmml"><msubsup id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.cmml"><mi id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.2" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.2.cmml">x</mi><mi id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.3" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.3" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.3" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.3.cmml">∼</mo><mrow id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.cmml"><mtext id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.4" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.4a.cmml">Bin</mtext><mo id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.3" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.3.cmml">⁢</mo><mrow id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.3.cmml"><mo id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.3" stretchy="false" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.3.cmml">(</mo><msubsup id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.2" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.3" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.3" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.4" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.3.cmml">,</mo><msubsup id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.cmml"><mi id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.2" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.2.cmml">p</mi><mi id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.3" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.3" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.5" stretchy="false" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p3.2.m2.2b"><apply id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2"><csymbol cd="latexml" id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.3">similar-to</csymbol><apply id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.1.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.1.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.2">𝑥</ci><ci id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.4.3">𝑗</ci></apply><apply id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2"><times id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.3"></times><ci id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.4a.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.4"><mtext id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.4.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.4">Bin</mtext></ci><interval closure="open" id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2"><apply id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.2">𝑛</ci><ci id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.1.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.1.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.2">𝑝</ci><ci id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.2.m2.2.2.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p3.2.m2.2c">x_{i}^{j}\sim\text{Bin}(n_{i}^{j},p_{i}^{j})</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p3.2.m2.2d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ∼ Bin ( italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT )</annotation></semantics></math>, where we sample <math alttext="n_{i}^{j}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p3.3.m3.1"><semantics id="Sx4.SSx5.SSSx1.p3.3.m3.1a"><msubsup id="Sx4.SSx5.SSSx1.p3.3.m3.1.1" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.2" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.2.cmml">n</mi><mi id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.3" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.3" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p3.3.m3.1b"><apply id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.2">𝑛</ci><ci id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx1.p3.3.m3.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p3.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p3.3.m3.1c">n_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p3.3.m3.1d">italic_n start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> uniformly at random between 10 and 1,000.</p>
</div>
<div class="ltx_para" id="Sx4.SSx5.SSSx1.p4">
<p class="ltx_p" id="Sx4.SSx5.SSSx1.p4.3">At each time <math alttext="t" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p4.1.m1.1"><semantics id="Sx4.SSx5.SSSx1.p4.1.m1.1a"><mi id="Sx4.SSx5.SSSx1.p4.1.m1.1.1" xref="Sx4.SSx5.SSSx1.p4.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p4.1.m1.1b"><ci id="Sx4.SSx5.SSSx1.p4.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p4.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p4.1.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p4.1.m1.1d">italic_t</annotation></semantics></math>, we randomly sample a query <math alttext="q_{t}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p4.2.m2.1"><semantics id="Sx4.SSx5.SSSx1.p4.2.m2.1a"><msub id="Sx4.SSx5.SSSx1.p4.2.m2.1.1" xref="Sx4.SSx5.SSSx1.p4.2.m2.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p4.2.m2.1.1.2" xref="Sx4.SSx5.SSSx1.p4.2.m2.1.1.2.cmml">q</mi><mi id="Sx4.SSx5.SSSx1.p4.2.m2.1.1.3" xref="Sx4.SSx5.SSSx1.p4.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p4.2.m2.1b"><apply id="Sx4.SSx5.SSSx1.p4.2.m2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p4.2.m2.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p4.2.m2.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p4.2.m2.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p4.2.m2.1.1.2">𝑞</ci><ci id="Sx4.SSx5.SSSx1.p4.2.m2.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p4.2.m2.1c">q_{t}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p4.2.m2.1d">italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and obtain its corresponding item match set <math alttext="D_{q_{t}}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p4.3.m3.1"><semantics id="Sx4.SSx5.SSSx1.p4.3.m3.1a"><msub id="Sx4.SSx5.SSSx1.p4.3.m3.1.1" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.cmml"><mi id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.2" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.2.cmml">D</mi><msub id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.cmml"><mi id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.2" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.2.cmml">q</mi><mi id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.3" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p4.3.m3.1b"><apply id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.cmml" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.2.cmml" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.2">𝐷</ci><apply id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.cmml" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.1.cmml" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3">subscript</csymbol><ci id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.2.cmml" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.2">𝑞</ci><ci id="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.3.cmml" xref="Sx4.SSx5.SSSx1.p4.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p4.3.m3.1c">D_{q_{t}}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p4.3.m3.1d">italic_D start_POSTSUBSCRIPT italic_q start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>. We then use the proposed approach to rank items in decreasing order, select the top 10 items to show to the user, and simulate clicks on these items based on their true probability of attractiveness. All items are cold at the start of the simulation, as they have no previous user interactions. We run this simulation for 10,000 timesteps and perform 5 independent trials to obtain confidence intervals for each method. We ablate our model, comparing three approaches:</p>
<ul class="ltx_itemize" id="Sx4.I2">
<li class="ltx_item" id="Sx4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i1.p1">
<p class="ltx_p" id="Sx4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I2.i1.p1.1.1">Non-behavioral</span>: Uses only contextual features to rank items.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i2.p1">
<p class="ltx_p" id="Sx4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I2.i2.p1.1.1">Behavioral</span>: Uses contextual features and user interaction features without applying our approach.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I2.i3.p1">
<p class="ltx_p" id="Sx4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I2.i3.p1.1.1">BayesCNS</span>: Uses both query-item features and user interaction features along with a learned prior that estimates the user-item interaction features.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="Sx4.SSx5.SSSx1.p5">
<p class="ltx_p" id="Sx4.SSx5.SSSx1.p5.4">We plot the Click-through rate (CTR) of each approach under different <math alttext="w" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p5.1.m1.1"><semantics id="Sx4.SSx5.SSSx1.p5.1.m1.1a"><mi id="Sx4.SSx5.SSSx1.p5.1.m1.1.1" xref="Sx4.SSx5.SSSx1.p5.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p5.1.m1.1b"><ci id="Sx4.SSx5.SSSx1.p5.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx1.p5.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p5.1.m1.1c">w</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p5.1.m1.1d">italic_w</annotation></semantics></math> in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.F2" title="Figure 2 ‣ Ranking Model Guided Online Learning ‣ Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">2</span></a>. Here, we see that for small <math alttext="w" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p5.2.m2.1"><semantics id="Sx4.SSx5.SSSx1.p5.2.m2.1a"><mi id="Sx4.SSx5.SSSx1.p5.2.m2.1.1" xref="Sx4.SSx5.SSSx1.p5.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p5.2.m2.1b"><ci id="Sx4.SSx5.SSSx1.p5.2.m2.1.1.cmml" xref="Sx4.SSx5.SSSx1.p5.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p5.2.m2.1c">w</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p5.2.m2.1d">italic_w</annotation></semantics></math>, where the contextual features are not predictive of item attractiveness, the non-behavioral approach underperforms the other methods. Meanwhile, for high <math alttext="w" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p5.3.m3.1"><semantics id="Sx4.SSx5.SSSx1.p5.3.m3.1a"><mi id="Sx4.SSx5.SSSx1.p5.3.m3.1.1" xref="Sx4.SSx5.SSSx1.p5.3.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p5.3.m3.1b"><ci id="Sx4.SSx5.SSSx1.p5.3.m3.1.1.cmml" xref="Sx4.SSx5.SSSx1.p5.3.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p5.3.m3.1c">w</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p5.3.m3.1d">italic_w</annotation></semantics></math>, the behavioral approach performs worse due to selection bias on items which previously had user interactions. Meanwhile, our approach is able to capture the best of both worlds and outperforms both methods across low and high <math alttext="w" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx1.p5.4.m4.1"><semantics id="Sx4.SSx5.SSSx1.p5.4.m4.1a"><mi id="Sx4.SSx5.SSSx1.p5.4.m4.1.1" xref="Sx4.SSx5.SSSx1.p5.4.m4.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx1.p5.4.m4.1b"><ci id="Sx4.SSx5.SSSx1.p5.4.m4.1.1.cmml" xref="Sx4.SSx5.SSSx1.p5.4.m4.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx1.p5.4.m4.1c">w</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx1.p5.4.m4.1d">italic_w</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx4.SSx5.SSSx2">
<h4 class="ltx_title ltx_title_subsubsection">Simulation: Non-stationary Setting</h4>
<div class="ltx_para" id="Sx4.SSx5.SSSx2.p1">
<p class="ltx_p" id="Sx4.SSx5.SSSx2.p1.1">We further test our method in an environment that introduces cold start and non-stationarity simultaneously. Specifically, we simulate an environment where item attractiveness can abruptly change at unknown <span class="ltx_text ltx_font_italic" id="Sx4.SSx5.SSSx2.p1.1.1">breakpoints</span> in time <cite class="ltx_cite ltx_citemacro_citep">(Garivier and Moulines <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib17" title="">2011</a>; Li and De Rijke <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib30" title="">2019</a>)</cite>. To do this, we further decompose <math alttext="\epsilon_{i}^{j}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx2.p1.1.m1.1"><semantics id="Sx4.SSx5.SSSx2.p1.1.m1.1a"><msubsup id="Sx4.SSx5.SSSx2.p1.1.m1.1.1" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1.cmml"><mi id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.2" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.2.cmml">ϵ</mi><mi id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.3" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.3.cmml">i</mi><mi id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.3" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.1.m1.1b"><apply id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1">superscript</csymbol><apply id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.cmml" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.1.cmml" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1">subscript</csymbol><ci id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.2.cmml" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.2">italic-ϵ</ci><ci id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.3.cmml" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1.2.3">𝑖</ci></apply><ci id="Sx4.SSx5.SSSx2.p1.1.m1.1.1.3.cmml" xref="Sx4.SSx5.SSSx2.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.1.m1.1c">\epsilon_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx2.p1.1.m1.1d">italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> into two components:</p>
<table class="ltx_equation ltx_eqn_table" id="Sx4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\epsilon_{i}^{j}=r\epsilon_{i,\text{Static}}^{j}+(1-r)\epsilon_{i,\text{%
Dynamic}}^{j}(e)." class="ltx_Math" display="block" id="Sx4.E13.m1.6"><semantics id="Sx4.E13.m1.6a"><mrow id="Sx4.E13.m1.6.6.1" xref="Sx4.E13.m1.6.6.1.1.cmml"><mrow id="Sx4.E13.m1.6.6.1.1" xref="Sx4.E13.m1.6.6.1.1.cmml"><msubsup id="Sx4.E13.m1.6.6.1.1.3" xref="Sx4.E13.m1.6.6.1.1.3.cmml"><mi id="Sx4.E13.m1.6.6.1.1.3.2.2" xref="Sx4.E13.m1.6.6.1.1.3.2.2.cmml">ϵ</mi><mi id="Sx4.E13.m1.6.6.1.1.3.2.3" xref="Sx4.E13.m1.6.6.1.1.3.2.3.cmml">i</mi><mi id="Sx4.E13.m1.6.6.1.1.3.3" xref="Sx4.E13.m1.6.6.1.1.3.3.cmml">j</mi></msubsup><mo id="Sx4.E13.m1.6.6.1.1.2" xref="Sx4.E13.m1.6.6.1.1.2.cmml">=</mo><mrow id="Sx4.E13.m1.6.6.1.1.1" xref="Sx4.E13.m1.6.6.1.1.1.cmml"><mrow id="Sx4.E13.m1.6.6.1.1.1.3" xref="Sx4.E13.m1.6.6.1.1.1.3.cmml"><mi id="Sx4.E13.m1.6.6.1.1.1.3.2" xref="Sx4.E13.m1.6.6.1.1.1.3.2.cmml">r</mi><mo id="Sx4.E13.m1.6.6.1.1.1.3.1" xref="Sx4.E13.m1.6.6.1.1.1.3.1.cmml">⁢</mo><msubsup id="Sx4.E13.m1.6.6.1.1.1.3.3" xref="Sx4.E13.m1.6.6.1.1.1.3.3.cmml"><mi id="Sx4.E13.m1.6.6.1.1.1.3.3.2.2" xref="Sx4.E13.m1.6.6.1.1.1.3.3.2.2.cmml">ϵ</mi><mrow id="Sx4.E13.m1.2.2.2.4" xref="Sx4.E13.m1.2.2.2.3.cmml"><mi id="Sx4.E13.m1.1.1.1.1" xref="Sx4.E13.m1.1.1.1.1.cmml">i</mi><mo id="Sx4.E13.m1.2.2.2.4.1" xref="Sx4.E13.m1.2.2.2.3.cmml">,</mo><mtext id="Sx4.E13.m1.2.2.2.2" xref="Sx4.E13.m1.2.2.2.2a.cmml">Static</mtext></mrow><mi id="Sx4.E13.m1.6.6.1.1.1.3.3.3" xref="Sx4.E13.m1.6.6.1.1.1.3.3.3.cmml">j</mi></msubsup></mrow><mo id="Sx4.E13.m1.6.6.1.1.1.2" xref="Sx4.E13.m1.6.6.1.1.1.2.cmml">+</mo><mrow id="Sx4.E13.m1.6.6.1.1.1.1" xref="Sx4.E13.m1.6.6.1.1.1.1.cmml"><mrow id="Sx4.E13.m1.6.6.1.1.1.1.1.1" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.cmml"><mo id="Sx4.E13.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx4.E13.m1.6.6.1.1.1.1.1.1.1" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.cmml"><mn id="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.2" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.1" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.3" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.3.cmml">r</mi></mrow><mo id="Sx4.E13.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="Sx4.E13.m1.6.6.1.1.1.1.2" xref="Sx4.E13.m1.6.6.1.1.1.1.2.cmml">⁢</mo><msubsup id="Sx4.E13.m1.6.6.1.1.1.1.3" xref="Sx4.E13.m1.6.6.1.1.1.1.3.cmml"><mi id="Sx4.E13.m1.6.6.1.1.1.1.3.2.2" xref="Sx4.E13.m1.6.6.1.1.1.1.3.2.2.cmml">ϵ</mi><mrow id="Sx4.E13.m1.4.4.2.4" xref="Sx4.E13.m1.4.4.2.3.cmml"><mi id="Sx4.E13.m1.3.3.1.1" xref="Sx4.E13.m1.3.3.1.1.cmml">i</mi><mo id="Sx4.E13.m1.4.4.2.4.1" xref="Sx4.E13.m1.4.4.2.3.cmml">,</mo><mtext id="Sx4.E13.m1.4.4.2.2" xref="Sx4.E13.m1.4.4.2.2a.cmml">Dynamic</mtext></mrow><mi id="Sx4.E13.m1.6.6.1.1.1.1.3.3" xref="Sx4.E13.m1.6.6.1.1.1.1.3.3.cmml">j</mi></msubsup><mo id="Sx4.E13.m1.6.6.1.1.1.1.2a" xref="Sx4.E13.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="Sx4.E13.m1.6.6.1.1.1.1.4.2" xref="Sx4.E13.m1.6.6.1.1.1.1.cmml"><mo id="Sx4.E13.m1.6.6.1.1.1.1.4.2.1" stretchy="false" xref="Sx4.E13.m1.6.6.1.1.1.1.cmml">(</mo><mi id="Sx4.E13.m1.5.5" xref="Sx4.E13.m1.5.5.cmml">e</mi><mo id="Sx4.E13.m1.6.6.1.1.1.1.4.2.2" stretchy="false" xref="Sx4.E13.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx4.E13.m1.6.6.1.2" lspace="0em" xref="Sx4.E13.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.E13.m1.6b"><apply id="Sx4.E13.m1.6.6.1.1.cmml" xref="Sx4.E13.m1.6.6.1"><eq id="Sx4.E13.m1.6.6.1.1.2.cmml" xref="Sx4.E13.m1.6.6.1.1.2"></eq><apply id="Sx4.E13.m1.6.6.1.1.3.cmml" xref="Sx4.E13.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="Sx4.E13.m1.6.6.1.1.3.1.cmml" xref="Sx4.E13.m1.6.6.1.1.3">superscript</csymbol><apply id="Sx4.E13.m1.6.6.1.1.3.2.cmml" xref="Sx4.E13.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="Sx4.E13.m1.6.6.1.1.3.2.1.cmml" xref="Sx4.E13.m1.6.6.1.1.3">subscript</csymbol><ci id="Sx4.E13.m1.6.6.1.1.3.2.2.cmml" xref="Sx4.E13.m1.6.6.1.1.3.2.2">italic-ϵ</ci><ci id="Sx4.E13.m1.6.6.1.1.3.2.3.cmml" xref="Sx4.E13.m1.6.6.1.1.3.2.3">𝑖</ci></apply><ci id="Sx4.E13.m1.6.6.1.1.3.3.cmml" xref="Sx4.E13.m1.6.6.1.1.3.3">𝑗</ci></apply><apply id="Sx4.E13.m1.6.6.1.1.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1"><plus id="Sx4.E13.m1.6.6.1.1.1.2.cmml" xref="Sx4.E13.m1.6.6.1.1.1.2"></plus><apply id="Sx4.E13.m1.6.6.1.1.1.3.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3"><times id="Sx4.E13.m1.6.6.1.1.1.3.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3.1"></times><ci id="Sx4.E13.m1.6.6.1.1.1.3.2.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3.2">𝑟</ci><apply id="Sx4.E13.m1.6.6.1.1.1.3.3.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx4.E13.m1.6.6.1.1.1.3.3.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3.3">superscript</csymbol><apply id="Sx4.E13.m1.6.6.1.1.1.3.3.2.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx4.E13.m1.6.6.1.1.1.3.3.2.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3.3">subscript</csymbol><ci id="Sx4.E13.m1.6.6.1.1.1.3.3.2.2.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3.3.2.2">italic-ϵ</ci><list id="Sx4.E13.m1.2.2.2.3.cmml" xref="Sx4.E13.m1.2.2.2.4"><ci id="Sx4.E13.m1.1.1.1.1.cmml" xref="Sx4.E13.m1.1.1.1.1">𝑖</ci><ci id="Sx4.E13.m1.2.2.2.2a.cmml" xref="Sx4.E13.m1.2.2.2.2"><mtext id="Sx4.E13.m1.2.2.2.2.cmml" mathsize="70%" xref="Sx4.E13.m1.2.2.2.2">Static</mtext></ci></list></apply><ci id="Sx4.E13.m1.6.6.1.1.1.3.3.3.cmml" xref="Sx4.E13.m1.6.6.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="Sx4.E13.m1.6.6.1.1.1.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1"><times id="Sx4.E13.m1.6.6.1.1.1.1.2.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.2"></times><apply id="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1"><minus id="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.1"></minus><cn id="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml" type="integer" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.2">1</cn><ci id="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.1.1.1.3">𝑟</ci></apply><apply id="Sx4.E13.m1.6.6.1.1.1.1.3.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.E13.m1.6.6.1.1.1.1.3.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.3">superscript</csymbol><apply id="Sx4.E13.m1.6.6.1.1.1.1.3.2.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx4.E13.m1.6.6.1.1.1.1.3.2.1.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.3">subscript</csymbol><ci id="Sx4.E13.m1.6.6.1.1.1.1.3.2.2.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.3.2.2">italic-ϵ</ci><list id="Sx4.E13.m1.4.4.2.3.cmml" xref="Sx4.E13.m1.4.4.2.4"><ci id="Sx4.E13.m1.3.3.1.1.cmml" xref="Sx4.E13.m1.3.3.1.1">𝑖</ci><ci id="Sx4.E13.m1.4.4.2.2a.cmml" xref="Sx4.E13.m1.4.4.2.2"><mtext id="Sx4.E13.m1.4.4.2.2.cmml" mathsize="70%" xref="Sx4.E13.m1.4.4.2.2">Dynamic</mtext></ci></list></apply><ci id="Sx4.E13.m1.6.6.1.1.1.1.3.3.cmml" xref="Sx4.E13.m1.6.6.1.1.1.1.3.3">𝑗</ci></apply><ci id="Sx4.E13.m1.5.5.cmml" xref="Sx4.E13.m1.5.5">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.E13.m1.6c">\epsilon_{i}^{j}=r\epsilon_{i,\text{Static}}^{j}+(1-r)\epsilon_{i,\text{%
Dynamic}}^{j}(e).</annotation><annotation encoding="application/x-llamapun" id="Sx4.E13.m1.6d">italic_ϵ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT = italic_r italic_ϵ start_POSTSUBSCRIPT italic_i , Static end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT + ( 1 - italic_r ) italic_ϵ start_POSTSUBSCRIPT italic_i , Dynamic end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_e ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Sx4.SSx5.SSSx2.p1.8">Here <math alttext="\epsilon_{i,\text{Static}}^{j}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx2.p1.2.m1.2"><semantics id="Sx4.SSx5.SSSx2.p1.2.m1.2a"><msubsup id="Sx4.SSx5.SSSx2.p1.2.m1.2.3" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3.cmml"><mi id="Sx4.SSx5.SSSx2.p1.2.m1.2.3.2.2" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3.2.2.cmml">ϵ</mi><mrow id="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.4" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.3.cmml"><mi id="Sx4.SSx5.SSSx2.p1.2.m1.1.1.1.1" xref="Sx4.SSx5.SSSx2.p1.2.m1.1.1.1.1.cmml">i</mi><mo id="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.4.1" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.3.cmml">,</mo><mtext id="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.2" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.2a.cmml">Static</mtext></mrow><mi id="Sx4.SSx5.SSSx2.p1.2.m1.2.3.3" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.2.m1.2b"><apply id="Sx4.SSx5.SSSx2.p1.2.m1.2.3.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx2.p1.2.m1.2.3.1.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3">superscript</csymbol><apply id="Sx4.SSx5.SSSx2.p1.2.m1.2.3.2.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx2.p1.2.m1.2.3.2.1.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3">subscript</csymbol><ci id="Sx4.SSx5.SSSx2.p1.2.m1.2.3.2.2.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3.2.2">italic-ϵ</ci><list id="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.4"><ci id="Sx4.SSx5.SSSx2.p1.2.m1.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.1.1.1.1">𝑖</ci><ci id="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.2a.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.2"><mtext id="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.2.cmml" mathsize="70%" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.2.2.2">Static</mtext></ci></list></apply><ci id="Sx4.SSx5.SSSx2.p1.2.m1.2.3.3.cmml" xref="Sx4.SSx5.SSSx2.p1.2.m1.2.3.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.2.m1.2c">\epsilon_{i,\text{Static}}^{j}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx2.p1.2.m1.2d">italic_ϵ start_POSTSUBSCRIPT italic_i , Static end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> is the static component which remains unchanged throughout the simulation, while <math alttext="\epsilon_{i,\text{Dynamic}}^{j}(e)" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx2.p1.3.m2.3"><semantics id="Sx4.SSx5.SSSx2.p1.3.m2.3a"><mrow id="Sx4.SSx5.SSSx2.p1.3.m2.3.4" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.cmml"><msubsup id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.cmml"><mi id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.2.2" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.2.2.cmml">ϵ</mi><mrow id="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.4" xref="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.3.cmml"><mi id="Sx4.SSx5.SSSx2.p1.3.m2.1.1.1.1" xref="Sx4.SSx5.SSSx2.p1.3.m2.1.1.1.1.cmml">i</mi><mo id="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.4.1" xref="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.3.cmml">,</mo><mtext id="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.2" xref="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.2a.cmml">Dynamic</mtext></mrow><mi id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.3" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.1" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.1.cmml">⁢</mo><mrow id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.3.2" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.cmml"><mo id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.3.2.1" stretchy="false" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.cmml">(</mo><mi id="Sx4.SSx5.SSSx2.p1.3.m2.3.3" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.3.cmml">e</mi><mo id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.3.2.2" stretchy="false" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.3.m2.3b"><apply id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4"><times id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.1.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.1"></times><apply id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.1.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2">superscript</csymbol><apply id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.2.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.2.1.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2">subscript</csymbol><ci id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.2.2.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.2.2">italic-ϵ</ci><list id="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.4"><ci id="Sx4.SSx5.SSSx2.p1.3.m2.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.1.1.1.1">𝑖</ci><ci id="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.2a.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.2"><mtext id="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.2.cmml" mathsize="70%" xref="Sx4.SSx5.SSSx2.p1.3.m2.2.2.2.2">Dynamic</mtext></ci></list></apply><ci id="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.3.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.4.2.3">𝑗</ci></apply><ci id="Sx4.SSx5.SSSx2.p1.3.m2.3.3.cmml" xref="Sx4.SSx5.SSSx2.p1.3.m2.3.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.3.m2.3c">\epsilon_{i,\text{Dynamic}}^{j}(e)</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx2.p1.3.m2.3d">italic_ϵ start_POSTSUBSCRIPT italic_i , Dynamic end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_e )</annotation></semantics></math> dynamically changes with each episode <math alttext="e" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx2.p1.4.m3.1"><semantics id="Sx4.SSx5.SSSx2.p1.4.m3.1a"><mi id="Sx4.SSx5.SSSx2.p1.4.m3.1.1" xref="Sx4.SSx5.SSSx2.p1.4.m3.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.4.m3.1b"><ci id="Sx4.SSx5.SSSx2.p1.4.m3.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.4.m3.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.4.m3.1c">e</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx2.p1.4.m3.1d">italic_e</annotation></semantics></math>. For each episode, we sample <math alttext="\epsilon_{i,\text{Dynamic}}^{j}(e)" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx2.p1.5.m4.3"><semantics id="Sx4.SSx5.SSSx2.p1.5.m4.3a"><mrow id="Sx4.SSx5.SSSx2.p1.5.m4.3.4" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.cmml"><msubsup id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.cmml"><mi id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.2.2" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.2.2.cmml">ϵ</mi><mrow id="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.4" xref="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.3.cmml"><mi id="Sx4.SSx5.SSSx2.p1.5.m4.1.1.1.1" xref="Sx4.SSx5.SSSx2.p1.5.m4.1.1.1.1.cmml">i</mi><mo id="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.4.1" xref="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.3.cmml">,</mo><mtext id="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.2" xref="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.2a.cmml">Dynamic</mtext></mrow><mi id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.3" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.3.cmml">j</mi></msubsup><mo id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.1" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.1.cmml">⁢</mo><mrow id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.3.2" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.cmml"><mo id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.3.2.1" stretchy="false" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.cmml">(</mo><mi id="Sx4.SSx5.SSSx2.p1.5.m4.3.3" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.3.cmml">e</mi><mo id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.3.2.2" stretchy="false" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.5.m4.3b"><apply id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4"><times id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.1.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.1"></times><apply id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.1.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2">superscript</csymbol><apply id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.2.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2"><csymbol cd="ambiguous" id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.2.1.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2">subscript</csymbol><ci id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.2.2.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.2.2">italic-ϵ</ci><list id="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.3.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.4"><ci id="Sx4.SSx5.SSSx2.p1.5.m4.1.1.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.1.1.1.1">𝑖</ci><ci id="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.2a.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.2"><mtext id="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.2.cmml" mathsize="70%" xref="Sx4.SSx5.SSSx2.p1.5.m4.2.2.2.2">Dynamic</mtext></ci></list></apply><ci id="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.3.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.4.2.3">𝑗</ci></apply><ci id="Sx4.SSx5.SSSx2.p1.5.m4.3.3.cmml" xref="Sx4.SSx5.SSSx2.p1.5.m4.3.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.5.m4.3c">\epsilon_{i,\text{Dynamic}}^{j}(e)</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx2.p1.5.m4.3d">italic_ϵ start_POSTSUBSCRIPT italic_i , Dynamic end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_e )</annotation></semantics></math> uniformly at random between <math alttext="[0,1]" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx2.p1.6.m5.2"><semantics id="Sx4.SSx5.SSSx2.p1.6.m5.2a"><mrow id="Sx4.SSx5.SSSx2.p1.6.m5.2.3.2" xref="Sx4.SSx5.SSSx2.p1.6.m5.2.3.1.cmml"><mo id="Sx4.SSx5.SSSx2.p1.6.m5.2.3.2.1" stretchy="false" xref="Sx4.SSx5.SSSx2.p1.6.m5.2.3.1.cmml">[</mo><mn id="Sx4.SSx5.SSSx2.p1.6.m5.1.1" xref="Sx4.SSx5.SSSx2.p1.6.m5.1.1.cmml">0</mn><mo id="Sx4.SSx5.SSSx2.p1.6.m5.2.3.2.2" xref="Sx4.SSx5.SSSx2.p1.6.m5.2.3.1.cmml">,</mo><mn id="Sx4.SSx5.SSSx2.p1.6.m5.2.2" xref="Sx4.SSx5.SSSx2.p1.6.m5.2.2.cmml">1</mn><mo id="Sx4.SSx5.SSSx2.p1.6.m5.2.3.2.3" stretchy="false" xref="Sx4.SSx5.SSSx2.p1.6.m5.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.6.m5.2b"><interval closure="closed" id="Sx4.SSx5.SSSx2.p1.6.m5.2.3.1.cmml" xref="Sx4.SSx5.SSSx2.p1.6.m5.2.3.2"><cn id="Sx4.SSx5.SSSx2.p1.6.m5.1.1.cmml" type="integer" xref="Sx4.SSx5.SSSx2.p1.6.m5.1.1">0</cn><cn id="Sx4.SSx5.SSSx2.p1.6.m5.2.2.cmml" type="integer" xref="Sx4.SSx5.SSSx2.p1.6.m5.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.6.m5.2c">[0,1]</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx2.p1.6.m5.2d">[ 0 , 1 ]</annotation></semantics></math>. We set <math alttext="r=0.5" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx2.p1.7.m6.1"><semantics id="Sx4.SSx5.SSSx2.p1.7.m6.1a"><mrow id="Sx4.SSx5.SSSx2.p1.7.m6.1.1" xref="Sx4.SSx5.SSSx2.p1.7.m6.1.1.cmml"><mi id="Sx4.SSx5.SSSx2.p1.7.m6.1.1.2" xref="Sx4.SSx5.SSSx2.p1.7.m6.1.1.2.cmml">r</mi><mo id="Sx4.SSx5.SSSx2.p1.7.m6.1.1.1" xref="Sx4.SSx5.SSSx2.p1.7.m6.1.1.1.cmml">=</mo><mn id="Sx4.SSx5.SSSx2.p1.7.m6.1.1.3" xref="Sx4.SSx5.SSSx2.p1.7.m6.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.7.m6.1b"><apply id="Sx4.SSx5.SSSx2.p1.7.m6.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.7.m6.1.1"><eq id="Sx4.SSx5.SSSx2.p1.7.m6.1.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.7.m6.1.1.1"></eq><ci id="Sx4.SSx5.SSSx2.p1.7.m6.1.1.2.cmml" xref="Sx4.SSx5.SSSx2.p1.7.m6.1.1.2">𝑟</ci><cn id="Sx4.SSx5.SSSx2.p1.7.m6.1.1.3.cmml" type="float" xref="Sx4.SSx5.SSSx2.p1.7.m6.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.7.m6.1c">r=0.5</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx2.p1.7.m6.1d">italic_r = 0.5</annotation></semantics></math>, <math alttext="w=0.05" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx2.p1.8.m7.1"><semantics id="Sx4.SSx5.SSSx2.p1.8.m7.1a"><mrow id="Sx4.SSx5.SSSx2.p1.8.m7.1.1" xref="Sx4.SSx5.SSSx2.p1.8.m7.1.1.cmml"><mi id="Sx4.SSx5.SSSx2.p1.8.m7.1.1.2" xref="Sx4.SSx5.SSSx2.p1.8.m7.1.1.2.cmml">w</mi><mo id="Sx4.SSx5.SSSx2.p1.8.m7.1.1.1" xref="Sx4.SSx5.SSSx2.p1.8.m7.1.1.1.cmml">=</mo><mn id="Sx4.SSx5.SSSx2.p1.8.m7.1.1.3" xref="Sx4.SSx5.SSSx2.p1.8.m7.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx2.p1.8.m7.1b"><apply id="Sx4.SSx5.SSSx2.p1.8.m7.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.8.m7.1.1"><eq id="Sx4.SSx5.SSSx2.p1.8.m7.1.1.1.cmml" xref="Sx4.SSx5.SSSx2.p1.8.m7.1.1.1"></eq><ci id="Sx4.SSx5.SSSx2.p1.8.m7.1.1.2.cmml" xref="Sx4.SSx5.SSSx2.p1.8.m7.1.1.2">𝑤</ci><cn id="Sx4.SSx5.SSSx2.p1.8.m7.1.1.3.cmml" type="float" xref="Sx4.SSx5.SSSx2.p1.8.m7.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx2.p1.8.m7.1c">w=0.05</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx2.p1.8.m7.1d">italic_w = 0.05</annotation></semantics></math>, and run the simulation through 5 different episodes, each consisting of 10,000 timesteps.</p>
</div>
<div class="ltx_para" id="Sx4.SSx5.SSSx2.p2">
<p class="ltx_p" id="Sx4.SSx5.SSSx2.p2.1">We ablate our method by removing the non-stationary assumption (Bayesian Stationary), and the use of user interaction features (Non-behavioral). We perform 5 independent trials and plot the Click-through rate along with confidence intervals at each timestep in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.F3" title="Figure 3 ‣ Ranking Model Guided Online Learning ‣ Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">3</span></a>. Here, although the stationary approach performs well on the first episode, it is unable to adapt to shifts in item attractiveness in successive episodes, performing worse than the non-behavioral approach in later episodes. Meanwhile, our method is able to adapt to distribution shifts in item attractiveness and recover favorable rewards across all episodes.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx4.SSx5.SSSx3">
<h4 class="ltx_title ltx_title_subsubsection">Evaluations on Benchmark Datasets</h4>
<div class="ltx_para" id="Sx4.SSx5.SSSx3.p1">
<p class="ltx_p" id="Sx4.SSx5.SSSx3.p1.1">Following <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib54" title="">2020</a>)</cite>, we evaluate our method on three diverse benchmark datasets for addressing cold start in recommender systems:</p>
<ul class="ltx_itemize" id="Sx4.I3">
<li class="ltx_item" id="Sx4.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I3.i1.p1">
<p class="ltx_p" id="Sx4.I3.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I3.i1.p1.1.1">CiteULike</span> <cite class="ltx_cite ltx_citemacro_citep">(Wang and Blei <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib48" title="">2011</a>)</cite>: A dataset of user preferences for scientific articles. It includes 5,551 users, 16,980 articles, and 204,986 user-like-article interactions.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I3.i2.p1">
<p class="ltx_p" id="Sx4.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I3.i2.p1.1.1">LastFM</span> <cite class="ltx_cite ltx_citemacro_citep">(Cantador, Brusilovsky, and Kuflik <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib7" title="">2011</a>)</cite>: A dataset consisting of users and music artists as items to be recommended. This dataset consists of 1,892 users and 17,632 music artists as items to be recommended, with 92,834 user-listen-to-artist interactions.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I3.i3.p1">
<p class="ltx_p" id="Sx4.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I3.i3.p1.1.1">XING</span> <cite class="ltx_cite ltx_citemacro_citep">(Abel et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib2" title="">2017</a>)</cite>: A subset of the ACM RecSys 2017 Challenge dataset containing jobs as items to be recommended to users. It contains 106,881 users, 20,519 jobs as items to be recommended, and 4,306,183 user-view-job interactions.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="Sx4.SSx5.SSSx3.p1.2">These datasets contain user-item auxiliary information, which we use to construct priors on the user interaction features. For comparison, we consider five state-of-the-art cold start recommendation algorithms:</p>
<ul class="ltx_itemize" id="Sx4.I4">
<li class="ltx_item" id="Sx4.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i1.p1">
<p class="ltx_p" id="Sx4.I4.i1.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I4.i1.p1.1.1">KNN</span> <cite class="ltx_cite ltx_citemacro_citep">(Sedhain et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib43" title="">2014</a>)</cite>: Generates recommendations using a nearest neighbor algorithm.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i2.p1">
<p class="ltx_p" id="Sx4.I4.i2.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I4.i2.p1.1.1">LinMap</span> <cite class="ltx_cite ltx_citemacro_citep">(Gantner et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib16" title="">2010</a>)</cite>: Learns a linear transform to generate user-item Collaborative Filtering (CF) representations.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i3.p1">
<p class="ltx_p" id="Sx4.I4.i3.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I4.i3.p1.1.1">NLinMap</span> <cite class="ltx_cite ltx_citemacro_citep">(Van den Oord, Dieleman, and Schrauwen <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib46" title="">2013</a>)</cite>: Uses deep neural networks to transform representations into CF space.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i4.p1">
<p class="ltx_p" id="Sx4.I4.i4.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I4.i4.p1.1.1">DropoutNet</span> <cite class="ltx_cite ltx_citemacro_citep">(Volkovs, Yu, and Poutanen <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib47" title="">2017</a>)</cite>: Addresses cold items by randomly dropping CF representations during training.</p>
</div>
</li>
<li class="ltx_item" id="Sx4.I4.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx4.I4.i5.p1">
<p class="ltx_p" id="Sx4.I4.i5.p1.1"><span class="ltx_text ltx_font_bold" id="Sx4.I4.i5.p1.1.1">Heater</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib54" title="">2020</a>)</cite>: A method combining separate, joint, and randomized training, along with mixture of experts to generate recommendations.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="Sx4.SSx5.SSSx3.p2">
<p class="ltx_p" id="Sx4.SSx5.SSSx3.p2.1">We measure Recall@k, Precision@k, and NDCG@k for <math alttext="k\in\{20,50,100\}" class="ltx_Math" display="inline" id="Sx4.SSx5.SSSx3.p2.1.m1.3"><semantics id="Sx4.SSx5.SSSx3.p2.1.m1.3a"><mrow id="Sx4.SSx5.SSSx3.p2.1.m1.3.4" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.cmml"><mi id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.2" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.2.cmml">k</mi><mo id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.1" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.1.cmml">∈</mo><mrow id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.2" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.1.cmml"><mo id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.2.1" stretchy="false" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.1.cmml">{</mo><mn id="Sx4.SSx5.SSSx3.p2.1.m1.1.1" xref="Sx4.SSx5.SSSx3.p2.1.m1.1.1.cmml">20</mn><mo id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.2.2" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="Sx4.SSx5.SSSx3.p2.1.m1.2.2" xref="Sx4.SSx5.SSSx3.p2.1.m1.2.2.cmml">50</mn><mo id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.2.3" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="Sx4.SSx5.SSSx3.p2.1.m1.3.3" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.3.cmml">100</mn><mo id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.2.4" stretchy="false" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx3.p2.1.m1.3b"><apply id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.cmml" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4"><in id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.1.cmml" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.1"></in><ci id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.2.cmml" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.2">𝑘</ci><set id="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.1.cmml" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.4.3.2"><cn id="Sx4.SSx5.SSSx3.p2.1.m1.1.1.cmml" type="integer" xref="Sx4.SSx5.SSSx3.p2.1.m1.1.1">20</cn><cn id="Sx4.SSx5.SSSx3.p2.1.m1.2.2.cmml" type="integer" xref="Sx4.SSx5.SSSx3.p2.1.m1.2.2">50</cn><cn id="Sx4.SSx5.SSSx3.p2.1.m1.3.3.cmml" type="integer" xref="Sx4.SSx5.SSSx3.p2.1.m1.3.3">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx3.p2.1.m1.3c">k\in\{20,50,100\}</annotation><annotation encoding="application/x-llamapun" id="Sx4.SSx5.SSSx3.p2.1.m1.3d">italic_k ∈ { 20 , 50 , 100 }</annotation></semantics></math> to evaluate model performance <cite class="ltx_cite ltx_citemacro_citep">(He et al. <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#bib.bib21" title="">2017</a>)</cite>. The results of our evaluations are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx2.T1" title="Table 1 ‣ Non-stationarity and Continual Exploration ‣ Methodology ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">1</span></a>. Here, we see that BayesCNS performs competitively compared to the other methods considered across all datasets. We refer to the appendix for more discussions and details on our experiment setup.</p>
</div>
</section>
<section class="ltx_subsubsection" id="Sx4.SSx5.SSSx4">
<h4 class="ltx_title ltx_title_subsubsection">Online A/B Testing</h4>
<div class="ltx_para" id="Sx4.SSx5.SSSx4.p1">
<p class="ltx_p" id="Sx4.SSx5.SSSx4.p1.1">We conducted an online A/B test where we introduced millions of new items which in total consist of 22.81% of our original item index size. We compare our treatment with the baseline, which introduced these new items without explicitly considering cold start and non-stationary effects. We ran this test for 1 month, accruing millions of requests to reach statistical significance. Throughout this experiment, we record the overall success rate measuring the amount of favorable actions performed users, and new item impression rate measuring the amount of times that new items get shown to users.</p>
</div>
<div class="ltx_para" id="Sx4.SSx5.SSSx4.p2">
<p class="ltx_p" id="Sx4.SSx5.SSSx4.p2.1">The results of this A/B test are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.02126v1#Sx4.T2" title="Table 2 ‣ Simulation: Stationary Setting ‣ Experiments ‣ BayesCNS: A Unified Bayesian Approach to Address Cold Start and Non-Stationarity in Search Systems at Scale"><span class="ltx_text ltx_ref_tag">2</span></a>, where we have divided the impact into different anonymized cohorts, each with different new item percentages relative to the existing size. Our approach consistently boosts both the success rate and new item surface rate compared to surfacing new items without it, achieving statistical significance in nearly all metrics in all cohorts. For cohorts with more new items, our method provides more outsized improvements in all metrics, while cohorts with less new items observe a more modest gain.</p>
</div>
</section>
</section>
<section class="ltx_section" id="Sx5">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>
<div class="ltx_para" id="Sx5.p1">
<p class="ltx_p" id="Sx5.p1.1">We have presented BayesCNS, a Bayesian online learning approach to address cold start and non-stationarity in search systems at scale. Our approach predicts prior user-item interaction distributions based on contextual item features. We developed a novel parameterization of this prior model using deep neural networks, allowing us to learn expressive priors while enabling efficient posterior updates. We then use this learned prior to perform online learning under non-stationarity using a Thompson sampling algorithm. Through simulation experiments, evaluations on benchmark datasets, and online A/B testing, we have shown the efficacy of our proposed approach in dealing with cold start and non-stationarity, significantly improving click-through rates, new item impression rates, and success metrics on users.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abdollahpouri, Burke, and Mobasher (2019)</span>
<span class="ltx_bibblock">
Abdollahpouri, H.; Burke, R.; and Mobasher, B. 2019.

</span>
<span class="ltx_bibblock">Managing popularity bias in recommender systems with personalized
re-ranking.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:1901.07555</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abel et al. (2017)</span>
<span class="ltx_bibblock">
Abel, F.; Deldjoo, Y.; Elahi, M.; and Kohlsdorf, D. 2017.

</span>
<span class="ltx_bibblock">Recsys challenge 2017: Offline and online evaluation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the eleventh acm conference on recommender
systems</em>, 372–373.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Al-Ghossein, Abdessalem, and Barré (2021)</span>
<span class="ltx_bibblock">
Al-Ghossein, M.; Abdessalem, T.; and Barré, A. 2021.

</span>
<span class="ltx_bibblock">A survey on stream-based recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">ACM computing surveys (CSUR)</em>, 54(5): 1–36.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ash and Adams (2020)</span>
<span class="ltx_bibblock">
Ash, J.; and Adams, R. P. 2020.

</span>
<span class="ltx_bibblock">On warm-starting neural network training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Advances in neural information processing systems</em>, 33:
3884–3894.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Barber (2012)</span>
<span class="ltx_bibblock">
Barber, D. 2012.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Bayesian reasoning and machine learning</em>.

</span>
<span class="ltx_bibblock">Cambridge University Press.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Besbes, Gur, and Zeevi (2014)</span>
<span class="ltx_bibblock">
Besbes, O.; Gur, Y.; and Zeevi, A. 2014.

</span>
<span class="ltx_bibblock">Stochastic multi-armed-bandit problem with non-stationary rewards.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in neural information processing systems</em>, 27.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cantador, Brusilovsky, and Kuflik (2011)</span>
<span class="ltx_bibblock">
Cantador, I.; Brusilovsky, P.; and Kuflik, T. 2011.

</span>
<span class="ltx_bibblock">Second workshop on information heterogeneity and fusion in
recommender systems (HetRec2011).

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the fifth ACM conference on Recommender
systems</em>, 387–388.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cao et al. (2007)</span>
<span class="ltx_bibblock">
Cao, Z.; Qin, T.; Liu, T.-Y.; Tsai, M.-F.; and Li, H. 2007.

</span>
<span class="ltx_bibblock">Learning to rank: from pairwise approach to listwise approach.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 24th international conference on Machine
learning</em>, 129–136.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Casella (1985)</span>
<span class="ltx_bibblock">
Casella, G. 1985.

</span>
<span class="ltx_bibblock">An introduction to empirical Bayes data analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">The American Statistician</em>, 39(2): 83–87.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Casella and Berger (2024)</span>
<span class="ltx_bibblock">
Casella, G.; and Berger, R. 2024.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Statistical inference</em>.

</span>
<span class="ltx_bibblock">CRC Press.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chaney, Stewart, and Engelhardt (2018)</span>
<span class="ltx_bibblock">
Chaney, A. J.; Stewart, B. M.; and Engelhardt, B. E. 2018.

</span>
<span class="ltx_bibblock">How algorithmic confounding in recommendation systems increases
homogeneity and decreases utility.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 12th ACM conference on recommender
systems</em>, 224–232.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Coleman et al. (2024)</span>
<span class="ltx_bibblock">
Coleman, B.; Kang, W.-C.; Fahrbach, M.; Wang, R.; Hong, L.; Chi, E.; and Cheng,
D. 2024.

</span>
<span class="ltx_bibblock">Unified Embedding: Battle-tested feature representations for
web-scale ML systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</em>, 36.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2018)</span>
<span class="ltx_bibblock">
Devlin, J.; Chang, M.-W.; Lee, K.; and Toutanova, K. 2018.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1810.04805</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dosovitskiy et al. (2020)</span>
<span class="ltx_bibblock">
Dosovitskiy, A.; Beyer, L.; Kolesnikov, A.; Weissenborn, D.; Zhai, X.;
Unterthiner, T.; Dehghani, M.; Minderer, M.; Heigold, G.; Gelly, S.; et al.
2020.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2010.11929</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fink (1997)</span>
<span class="ltx_bibblock">
Fink, D. 1997.

</span>
<span class="ltx_bibblock">A compendium of conjugate priors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">See http://www. people. cornell. edu/pages/df36/CONJINTRnew%
20TEX. pdf</em>, 46.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gantner et al. (2010)</span>
<span class="ltx_bibblock">
Gantner, Z.; Drumond, L.; Freudenthaler, C.; Rendle, S.; and Schmidt-Thieme, L.
2010.

</span>
<span class="ltx_bibblock">Learning attribute-to-feature mappings for cold-start
recommendations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">2010 IEEE international conference on data mining</em>,
176–185. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garivier and Moulines (2011)</span>
<span class="ltx_bibblock">
Garivier, A.; and Moulines, E. 2011.

</span>
<span class="ltx_bibblock">On upper-confidence bound policies for switching bandit problems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">International conference on algorithmic learning theory</em>,
174–188. Springer.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gupta et al. (2020)</span>
<span class="ltx_bibblock">
Gupta, P.; Dreossi, T.; Bakus, J.; Lin, Y.-H.; and Salaka, V. 2020.

</span>
<span class="ltx_bibblock">Treating cold start in product search by priors.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Companion Proceedings of the Web Conference 2020</em>, 77–78.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Haldar et al. (2020)</span>
<span class="ltx_bibblock">
Haldar, M.; Ramanathan, P.; Sax, T.; Abdool, M.; Zhang, L.; Mansawala, A.;
Yang, S.; Turnbull, B.; and Liao, J. 2020.

</span>
<span class="ltx_bibblock">Improving deep learning for airbnb search.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the 26th ACM SIGKDD International Conference
on Knowledge Discovery &amp; Data Mining</em>, 2822–2830.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2022)</span>
<span class="ltx_bibblock">
Han, C.; Castells, P.; Gupta, P.; Xu, X.; and Salaka, V. 2022.

</span>
<span class="ltx_bibblock">Addressing cold start in product search via empirical bayes.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 31st ACM International Conference on
Information &amp; Knowledge Management</em>, 3141–3151.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2017)</span>
<span class="ltx_bibblock">
He, X.; Liao, L.; Zhang, H.; Nie, L.; Hu, X.; and Chua, T.-S. 2017.

</span>
<span class="ltx_bibblock">Neural collaborative filtering.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 26th international conference on world
wide web</em>, 173–182.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2014)</span>
<span class="ltx_bibblock">
He, X.; Pan, J.; Jin, O.; Xu, T.; Liu, B.; Xu, T.; Shi, Y.; Atallah, A.;
Herbrich, R.; Bowers, S.; et al. 2014.

</span>
<span class="ltx_bibblock">Practical lessons from predicting clicks on ads at facebook.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the eighth international workshop on data
mining for online advertising</em>, 1–9.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hofmann et al. (2013)</span>
<span class="ltx_bibblock">
Hofmann, K.; Schuth, A.; Whiteson, S.; and De Rijke, M. 2013.

</span>
<span class="ltx_bibblock">Reusing historical interaction data for faster online learning to
rank for IR.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the sixth ACM international conference on Web
search and data mining</em>, 183–192.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2011)</span>
<span class="ltx_bibblock">
Hu, V.; Stone, M.; Pedersen, J.; and White, R. W. 2011.

</span>
<span class="ltx_bibblock">Effects of search success on search engine re-use.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the 20th ACM international conference on
Information and knowledge management</em>, 1841–1846.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jagerman, Markov, and de Rijke (2019)</span>
<span class="ltx_bibblock">
Jagerman, R.; Markov, I.; and de Rijke, M. 2019.

</span>
<span class="ltx_bibblock">When people change their mind: Off-policy evaluation in
non-stationary recommendation environments.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the twelfth ACM international conference on
web search and data mining</em>, 447–455.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joachims (2002)</span>
<span class="ltx_bibblock">
Joachims, T. 2002.

</span>
<span class="ltx_bibblock">Optimizing search engines using clickthrough data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Proceedings of the eighth ACM SIGKDD international
conference on Knowledge discovery and data mining</em>, 133–142.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma et al. (2021)</span>
<span class="ltx_bibblock">
Kingma, D.; Salimans, T.; Poole, B.; and Ho, J. 2021.

</span>
<span class="ltx_bibblock">Variational diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Advances in neural information processing systems</em>, 34:
21696–21707.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kulkarni et al. (2011)</span>
<span class="ltx_bibblock">
Kulkarni, A.; Teevan, J.; Svore, K. M.; and Dumais, S. T. 2011.

</span>
<span class="ltx_bibblock">Understanding temporal query dynamics.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the fourth ACM international conference on
Web search and data mining</em>, 167–176.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lam et al. (2008)</span>
<span class="ltx_bibblock">
Lam, X. N.; Vu, T.; Le, T. D.; and Duong, A. D. 2008.

</span>
<span class="ltx_bibblock">Addressing cold-start problem in recommendation systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the 2nd international conference on
Ubiquitous information management and communication</em>, 208–211.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and De Rijke (2019)</span>
<span class="ltx_bibblock">
Li, C.; and De Rijke, M. 2019.

</span>
<span class="ltx_bibblock">Cascading non-stationary bandits: Online learning to rank in the
non-stationary cascade model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">arXiv preprint arXiv:1905.12370</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019)</span>
<span class="ltx_bibblock">
Li, J.; Jing, M.; Lu, K.; Zhu, L.; Yang, Y.; and Huang, Z. 2019.

</span>
<span class="ltx_bibblock">From zero-shot learning to cold-start recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the AAAI conference on artificial
intelligence</em>, volume 33, 4189–4196.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2009)</span>
<span class="ltx_bibblock">
Liu, T.-Y.; et al. 2009.

</span>
<span class="ltx_bibblock">Learning to rank for information retrieval.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Foundations and Trends® in Information
Retrieval</em>, 3(3): 225–331.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Missault et al. (2021)</span>
<span class="ltx_bibblock">
Missault, P.; de Myttenaere, A.; Radler, A.; and Sondag, P.-A. 2021.

</span>
<span class="ltx_bibblock">Addressing cold start with dataset transfer in e-commerce learning to
rank.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Molchanov et al. (2019)</span>
<span class="ltx_bibblock">
Molchanov, D.; Kharitonov, V.; Sobolev, A.; and Vetrov, D. 2019.

</span>
<span class="ltx_bibblock">Doubly semi-implicit variational inference.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">The 22nd International Conference on Artificial Intelligence
and Statistics</em>, 2593–2602. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Moore et al. (2013)</span>
<span class="ltx_bibblock">
Moore, J. L.; Chen, S.; Turnbull, D. R.; and Joachims, T. 2013.

</span>
<span class="ltx_bibblock">Taste Over Time: The Temporal Dynamics of User Preferences.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">ISMIR</em>, volume 13, 406.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oosterhuis and de Rijke (2018)</span>
<span class="ltx_bibblock">
Oosterhuis, H.; and de Rijke, M. 2018.

</span>
<span class="ltx_bibblock">Differentiable unbiased online learning to rank.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 27th ACM international conference on
information and knowledge management</em>, 1293–1302.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pereira et al. (2018)</span>
<span class="ltx_bibblock">
Pereira, F. S.; Gama, J.; de Amo, S.; and Oliveira, G. M. 2018.

</span>
<span class="ltx_bibblock">On analyzing user preference dynamics with temporal social networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Machine Learning</em>, 107: 1745–1773.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Russo et al. (2018)</span>
<span class="ltx_bibblock">
Russo, D. J.; Van Roy, B.; Kazerouni, A.; Osband, I.; Wen, Z.; et al. 2018.

</span>
<span class="ltx_bibblock">A tutorial on thompson sampling.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Foundations and Trends® in Machine Learning</em>,
11(1): 1–96.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saveski and Mantrach (2014)</span>
<span class="ltx_bibblock">
Saveski, M.; and Mantrach, A. 2014.

</span>
<span class="ltx_bibblock">Item cold-start recommendations: learning local collective
embeddings.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the 8th ACM Conference on Recommender
systems</em>, 89–96.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schnabel et al. (2018)</span>
<span class="ltx_bibblock">
Schnabel, T.; Bennett, P. N.; Dumais, S. T.; and Joachims, T. 2018.

</span>
<span class="ltx_bibblock">Short-term satisfaction and long-term coverage: Understanding how
users tolerate algorithmic exploration.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the Eleventh ACM International Conference on
Web Search and Data Mining</em>, 513–521.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schuth et al. (2016)</span>
<span class="ltx_bibblock">
Schuth, A.; Oosterhuis, H.; Whiteson, S.; and de Rijke, M. 2016.

</span>
<span class="ltx_bibblock">Multileave gradient descent for fast online learning to rank.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">proceedings of the ninth ACM international conference on web
search and data mining</em>, 457–466.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sedhain et al. (2017)</span>
<span class="ltx_bibblock">
Sedhain, S.; Menon, A.; Sanner, S.; Xie, L.; and Braziunas, D. 2017.

</span>
<span class="ltx_bibblock">Low-rank linear cold-start recommendation from social data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Proceedings of the AAAI Conference on Artificial
Intelligence</em>, volume 31.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sedhain et al. (2014)</span>
<span class="ltx_bibblock">
Sedhain, S.; Sanner, S.; Braziunas, D.; Xie, L.; and Christensen, J. 2014.

</span>
<span class="ltx_bibblock">Social collaborative filtering for cold-start recommendations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the 8th ACM Conference on Recommender
systems</em>, 345–348.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sorokina and Cantu-Paz (2016)</span>
<span class="ltx_bibblock">
Sorokina, D.; and Cantu-Paz, E. 2016.

</span>
<span class="ltx_bibblock">Amazon search: The joy of ranking products.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">Proceedings of the 39th International ACM SIGIR conference
on Research and Development in Information Retrieval</em>, 459–460.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taank, Cao, and Gattani (2017)</span>
<span class="ltx_bibblock">
Taank, S.; Cao, T. M.; and Gattani, A. 2017.

</span>
<span class="ltx_bibblock">Re-ranking results in a search.

</span>
<span class="ltx_bibblock">US Patent 9,563,705.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van den Oord, Dieleman, and Schrauwen (2013)</span>
<span class="ltx_bibblock">
Van den Oord, A.; Dieleman, S.; and Schrauwen, B. 2013.

</span>
<span class="ltx_bibblock">Deep content-based music recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Advances in neural information processing systems</em>, 26.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Volkovs, Yu, and Poutanen (2017)</span>
<span class="ltx_bibblock">
Volkovs, M.; Yu, G.; and Poutanen, T. 2017.

</span>
<span class="ltx_bibblock">Dropoutnet: Addressing cold start in recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Advances in neural information processing systems</em>, 30.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang and Blei (2011)</span>
<span class="ltx_bibblock">
Wang, C.; and Blei, D. M. 2011.

</span>
<span class="ltx_bibblock">Collaborative topic modeling for recommending scientific articles.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">Proceedings of the 17th ACM SIGKDD international conference
on Knowledge discovery and data mining</em>, 448–456.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu, Iyer, and Wang (2018)</span>
<span class="ltx_bibblock">
Wu, Q.; Iyer, N.; and Wang, H. 2018.

</span>
<span class="ltx_bibblock">Learning contextual bandits in a non-stationary environment.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">The 41st International ACM SIGIR Conference on Research &amp;
Development in Information Retrieval</em>, 495–504.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2022)</span>
<span class="ltx_bibblock">
Yang, T.; Luo, C.; Lu, H.; Gupta, P.; Yin, B.; and Ai, Q. 2022.

</span>
<span class="ltx_bibblock">Can clicks be both labels and features? Unbiased Behavior Feature
Collection and Uncertainty-aware Learning to Rank.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the 45th international ACM SIGIR conference
on research and development in information retrieval</em>, 6–17.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yin and Zhou (2018)</span>
<span class="ltx_bibblock">
Yin, M.; and Zhou, M. 2018.

</span>
<span class="ltx_bibblock">Semi-implicit variational inference.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">International conference on machine learning</em>, 5660–5669.
PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu and Mannor (2009)</span>
<span class="ltx_bibblock">
Yu, J. Y.; and Mannor, S. 2009.

</span>
<span class="ltx_bibblock">Piecewise-stationary bandit problems with side observations.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">Proceedings of the 26th annual international conference on
machine learning</em>, 1177–1184.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue and Joachims (2009)</span>
<span class="ltx_bibblock">
Yue, Y.; and Joachims, T. 2009.

</span>
<span class="ltx_bibblock">Interactively optimizing information retrieval systems as a dueling
bandits problem.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Proceedings of the 26th Annual International Conference on
Machine Learning</em>, 1201–1208.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2020)</span>
<span class="ltx_bibblock">
Zhu, Z.; Sefati, S.; Saadatpanah, P.; and Caverlee, J. 2020.

</span>
<span class="ltx_bibblock">Recommendation for new users and new items via randomized training
and mixture-of-experts transformation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Proceedings of the 43rd International ACM SIGIR Conference
on Research and Development in Information Retrieval</em>, 1121–1130.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zoghi et al. (2017)</span>
<span class="ltx_bibblock">
Zoghi, M.; Tunys, T.; Ghavamzadeh, M.; Kveton, B.; Szepesvari, C.; and Wen, Z.
2017.

</span>
<span class="ltx_bibblock">Online learning to rank in stochastic click models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">International conference on machine learning</em>, 4199–4208.
PMLR.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct  3 01:02:32 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
