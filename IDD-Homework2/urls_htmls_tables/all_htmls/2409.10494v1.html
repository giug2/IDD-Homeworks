<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation</title>
<!--Generated on Mon Sep 16 16:29:33 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
recommender system,  generative AI,  diffusion,  classifier-free guidance
" lang="en" name="keywords"/>
<base href="/html/2409.10494v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S1" title="In Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S2" title="In Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Background and Related Work</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S2.SS1" title="In II Background and Related Work ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-A</span> </span><span class="ltx_text ltx_font_italic">Recommender Systems</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S2.SS2" title="In II Background and Related Work ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-B</span> </span><span class="ltx_text ltx_font_italic">Diffusion</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S2.SS3" title="In II Background and Related Work ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span> </span><span class="ltx_text ltx_font_italic">Diffusion-Based Recommender Systems</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S2.SS4" title="In II Background and Related Work ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-D</span> </span><span class="ltx_text ltx_font_italic">Classifier-Free Guidance</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S3" title="In Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Methodology</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S3.SS1" title="In III Methodology ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Diffusion Process</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S3.SS2" title="In III Methodology ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Denoising Model/Reverse Process</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S4" title="In Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Experimental Setup</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S4.SS1" title="In IV Experimental Setup ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Datasets</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S4.SS2" title="In IV Experimental Setup ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">Experimental Configurations</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S4.SS3" title="In IV Experimental Setup ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span> </span><span class="ltx_text ltx_font_italic">Evaluation</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S5" title="In Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Experimental Results</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S6" title="In Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VI </span><span class="ltx_text ltx_font_smallcaps">Conclusion and Future Work</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation
<br class="ltx_break"/>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Noah Buchanan, Susan Gauch, Quan Mai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id1.1.id1">Department of Electrical Engineering and Computer Science</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="id2.2.id2">University of Arkansas
<br class="ltx_break"/></span>Fayetteville, USA 
<br class="ltx_break"/>{njb004, sgauch, quanmai}@uark.edu
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">This paper presents a diffusion-based recommender system that incorporates classifier-free guidance. Most current recommender systems provide recommendations using conventional methods such as collaborative or content-based filtering. Diffusion is a new approach to generative AI that improves on previous generative AI approaches such as Variational Autoencoders (VAEs) and Generative Adversarial Networks (GANs). We incorporate diffusion in a recommender system that mirrors the sequence users take when browsing and rating items. Although a few current recommender systems incorporate diffusion, they do not incorporate classifier-free guidance, a new innovation in diffusion models as a whole. In this paper, we present a diffusion recommender system that augments
the underlying recommender system model for improved performance and also incorporates classifier-free guidance. Our findings show improvements over state-of-the-art recommender systems for most metrics for several recommendation tasks on a variety of datasets.
In particular, our approach demonstrates the potential to provide better recommendations when data is sparse.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
recommender system, generative AI, diffusion, classifier-free guidance

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The introduction of generative models has marked a turning point in the capabilities of AI and it gives us a glimpse into the distances we can go using such tools. Autoencoders, a foundational generational technology, learn a compressed format of information to pass into neural models. However, the latent space created by the autoencoder’s compression may contain parts that do not correspond to any data point in the original input, limiting their generative capabilities. Because the latent space is not regularized, autoencoder models only have generative capabilities that correspond to generating data we have seen before. During inference, when the training data is not available, we have no way of knowing whether or not the output generated is garbage. To address this, Variational Autoencoders (VAEs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib28" title="">28</a>]</cite>
and Generative Adversarial Networks (GANs)<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib31" title="">31</a>]</cite> were developed,
both of which have been shown to be capable of a wide range of of generation capabilities.<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib31" title="">31</a>]</cite>
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib28" title="">28</a>]</cite>
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib30" title="">30</a>]</cite>.
Text-to-image synthesis is one such capability and, not coincidentally, a very popular area of research. The idea of a pipeline capable of transforming our human language into another form of media that has none of the ease of creation that language does is an extremely appealing concept; as a result, there has been an explosion of research in this area in recent years. GANs and VAEs were the main generative models used for a broad scope of tasks for some time. Despite their success, GANs and VAEs remain only partially competitive with recent state-of-the-art techniques - diffusion.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Diffusion-based techniques outperform other recent techniques in the visual fidelity of images and their understanding of textual prompts. Additionally, they excel in the range of generated images and their ability to create variations of the same image while still accurately following the guidelines provided by the text prompt. Diffusion models (DMs) are based on the idea of diffusion in the natural sciences and are heavily inspired by non-equilibrium thermodynamics. The process of diffusion in natural science is the movement of solutes and molecules from a high concentration to a lower concentration. As the name suggests, DMs attempt to mimic this process using Gaussian noise instead as our measure of concentration, a fully noised image being the parallel of a perfectly diffused liquid.
The underlying concept is that, in actual diffusion, regardless of where or how dye is introduced into a container of water, the dye will eventually diffuse evenly throughout the container, producing a consistent result each time. DMs replicate this process, but instead of producing a uniform distribution, they recreate a distribution of the original data from random Gaussian noise.
Leveraging this principle, diffusion-based techniques have achieved unparalleled results in text-to-image synthesis and general image generation. While text-to-image is likely the most popular use case, they are capable of other tasks, such as text-to-text (sequence-to-sequence) or text-to-video. One such use case is recommendation.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The current challenge with generative recommender models lies in the limited capablities of current approaches that primarily rely on GANs and VAEs. GANs are plagued by instability issues <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib29" title="">29</a>]</cite>, whereas VAEs face a trade-off between tractability and the quality of their representations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib30" title="">30</a>]</cite>.
In contrast, Diffusion Models (DMs) do not encounter the aforementioned issues and therefore represent a promising solution for generative recommender systems (RSs). However, the current implementation of diffusion RSs is limited by their failure to incorporate recent innovations in DMs, i.e., classifier-free guidance. Essentially, classifier-free guidance, as implied by its name, enhances the generative capability of DMs without the need for an external classifier. Our contributions are threefold. <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">First</span>, we develop an implementation that seamlessly integrates classifier-free guidance into diffusion-based RSs. <span class="ltx_text ltx_font_italic" id="S1.p3.1.2">Second</span>, we provide an in-depth analysis of the architecture of the employed models. <span class="ltx_text ltx_font_italic" id="S1.p3.1.3">Third</span>, we offer insights and solutions to the challenges posed by few-shot and zero-shot scenarios, which frequently hamper the performance of RSs.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S2" title="II Background and Related Work ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">II</span></a> provides a summary of related work, situating our contributions within the existing literature. In Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S3" title="III Methodology ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">III</span></a>, we detail the process of integrating Classifier-Free Guidance into the implementation of a diffusion RS, originally described in our inspiration paper, and explain the inner workings of our enhanced RS. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S5" title="V Experimental Results ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">V</span></a> presents the results of our modifications and compares them to the outcomes from unmodified implementations. Finally, Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S6" title="VI Conclusion and Future Work ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">VI</span></a> offers conclusions and discusses potential avenues for future research to further advance the capabilities of diffusion-based RSs.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Background and Related Work</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we discuss RSs and DMs and how these fields combine. We also give some background on a technique used in DMs that has seen significant success in recent literature, known as classifier-free guidance, which is the basis for the improvement demonstrated in this paper.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS1.4.1.1">II-A</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS1.5.2">Recommender Systems</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">RSs are a crucial part of how businesses operate today, with users providing information in return for recommendations on products, whether items from a store or shows/movies. The foundation for RSs was generally considered to be first introduced by Elaine Rich in 1979 through a system she called Grundy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib1" title="">1</a>]</cite>. She wanted a way to recommend users’ books by asking them specific questions, in turn classifying them into classes of preferences depending on their answers. Jussi Karlgren improved upon Elaine Rich’s system by introducing a measure of “closeness” to attempt to imitate the occurrences in bookcases where interesting documents often happen to be found adjacent to each other regardless of a relatively unordered bookcase <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib2" title="">2</a>]</cite>. This idea of closeness was adopted and used in a variety of models after its inception. The first information filtering system based on collaborative filtering through human evaluation was introduced by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib3" title="">3</a>]</cite>, where they would make recommendations based on similarities between the interest profile of a user in question and other users; the concept was coined “weaving an information tapestry.” Inspired by the results of the study, researchers from MIT and the University of Minnesota (UMN) developed a new recommendation service called GroupLens, which features a user-to-user collaborative filtering model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib20" title="">20</a>]</cite>. Following the publication of these initial findings, the GroupLens research lab was established at UMN and became a pioneering force in the field of recommender system studies. The GroupLens research lab subsequently launched the MovieLens project, which led to the creation of the first version of their recommender model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib21" title="">21</a>]</cite>.
As a result of this project and its success, several MovieLens datasets were released from then to now and became one of, if not the most, popular datasets for recommendation studies.
</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">AI-based methods have been very popular, with the explosion of AI research in the last 20 years being an obvious indicator of its soon-to-be application to the recommendation domain. The application in this field did see success as early as 2006 and 2009, inspired by the Netflix Prize, matrix factorization models that would learn a user embedding matrix and an item embedding matrix; using these embedding matrices, we can find similarities using the measure of closeness we talked about earlier, in this case typically it would be the dot product <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib22" title="">22</a>]</cite>,<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib23" title="">23</a>]</cite>. Other techniques were created during this period, and linear models for this task gained some popularity. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib24" title="">24</a>]</cite> presented a logistic regression model that achieved tangible improvements on new user-centric evaluation methods, such as errors in click-through rate estimation. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib25" title="">25</a>]</cite> introduced a VAE for collaborative filtering with success on the MovieLens and Netflix Prize datasets. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib26" title="">26</a>]</cite> showed that GANs are also capable of creating a recommender model. Models for video recommendation were also created following the introduction of deep learning for RSs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib27" title="">27</a>]</cite>, showing that deep models have a surprising ability to recommend videos and the capability to perform both candidate generation and ranking.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS2.4.1.1">II-B</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS2.5.2">Diffusion</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The first paper that broaches the topic of diffusion models coined “Deep Unsupervised Learning using Nonequilibrium Thermodynamics”, aimed to attack the tradeoff between tractability and flexibility that probabilistic models historically are afflicted by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib4" title="">4</a>]</cite>. The next major breakthrough in DMs was achieved by the work in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib5" title="">5</a>]</cite>, which marked the first significant adoption of this model for high-quality image generation. This study not only demonstrated that DMs are capable of producing high-quality images, competitive with state-of-the-art methods on the CIFAR-10 dataset, but also highlighted the efficacy of class-conditional models that use a classifier to guide generation towards higher fidelity on the same task. The influential findings of this paper catalyzed widespread adoption, leading to numerous subsequent improvements. DMs, already known for the prowess in unconditional image generation, have shown superior performance in various other areas. Especifically, they have become the de-facto state-of-the-art in class-conditional generation, particularly with the incorporation of classifier guidance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib7" title="">7</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib6" title="">6</a>]</cite>. Additional, DMs have begun to dominate the domain of super-resolution <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib8" title="">8</a>]</cite>. The advancements prompted by this major adoption extended beyond the models’ use cases and capabilities to their performance optimization. Techniques such as latent diffusion models, introduced in the widely acclaimed Stable Diffusion paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib9" title="">9</a>]</cite>, have been developed to enhance these models. Latent diffusion models leverage the latent space concept from autoencoders: data is compressed into the latent space before the forward process, and both forward and reverse Markov transitions occur in this reduced dimensionality. The result is then upscaled back to the original size before output. This paper gained significant attention not only within the research community but also among non-researchers, as it provided open-access resources to code and model weights, enabling widespread use with proper guidance. Further improvements borrowed techniques from VAEs. For instance, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib13" title="">13</a>]</cite> demonstrated that Vector Quantization in the latent space could enhance the efficiency of both training and sampling speeds. Another innovative approach by a team at Snapchat introduced step-distillation to decrease the number of steps required in the denoising process. This lead to the creation of the SnapFusion model, which boasts the capability of image generation within two seconds on mobile devices <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib14" title="">14</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Large language models (LLMs) have represented a significant breakthrough in AI research, demonstrating exceptional performance across various applications, including chatbots, content generation, language translation, text summarization, question-answering systems, and personalized recommendations. This breakthrough has coincided with the rise in popularity of prompt-based conditional DMs, making it an opportune moment to merge LLMs’ textual understanding capabilities with these advanced image generation models. Google explored this integration and discovered that large language models were surprisingly effective at encoding text for image synthesis. This led to the development of a model named Imagen <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib10" title="">10</a>]</cite>, which exemplified the potency of combining these techniques. Similarly, OpenAI’s DALL-E 2 model employed large language models with diffusion techniques, using a CLIP model to generate images based on its enhanced language-image understanding <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib11" title="">11</a>]</cite>. Although the third iteration of DALL-E continued this approach, it uncovered some limitations; specifically, the imperfections in image captions were found to introduce flaws in the generated images. This highlighted the critical role of the language component in the effectiveness of these models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib12" title="">12</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS3.4.1.1">II-C</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS3.5.2">Diffusion-Based Recommender Systems</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">The success of DMs and the subsequent expansion of their use cases have led to increased interest in diffusion-based RSs. While GANs and VAEs are commonly utilized to model the generative process of user interactions, they share similar limitations with their traditional counterparts. With diffusion models showing promise in overcoming these issues within the domain of image generation, it is reasonable to hypothesize that they could address these shortcomings in generative recommender systems as well. The study by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib15" title="">15</a>]</cite> provides compelling evidence in support of this hypothesis. This research introduced one of the first diffusion-based recommender models, arguing that the objectives of RSs align well with the methodological framework of DMs. Specifically, RSs aim to infer future interaction probabilities based on corrupted historical interactions, a process analogous to the noise-corruption mechanism inherent in DMs. Their approach did not involve any direct conditioning, instead, the amount of noise added to the data was limited so that the data was corrupted but not completely indecipherable.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Although diffusion-based recommendation is a relatively new research area, it is rapidly gaining traction. Within the same year, several other diffusion recommender models emerged, employing varied approaches to achieve similar tasks. For instance, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib16" title="">16</a>]</cite> introduced a conditional diffusion-based RS using a cross-attentive denoising decoder to remove noise. Unlike previous approaches that relied on guidance via partially corrupted data, this method employed direct conditioning. This inspired other papers, such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib18" title="">18</a>]</cite>, which developed sequential recommendation methods using DMs. Additionally, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib17" title="">17</a>]</cite> explored the application of DMs for reranking purposes in RSs, achieving notable results.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS4.4.1.1">II-D</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS4.5.2">Classifier-Free Guidance</span>
</h3>
<div class="ltx_para" id="S2.SS4.p1">
<p class="ltx_p" id="S2.SS4.p1.1"><span class="ltx_text ltx_font_bold" id="S2.SS4.p1.1.1">Classifier guidance</span> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib6" title="">6</a>]</cite> modifies the diffusion score, specifically the gradient of the log probability density function, which is more tractable to learn than directly modeling the data distribution. This approach employs a classifier to guide the generation process by increasing the probability of data that the classifier assigns a high likelihood to the correct label. As demonstrated by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib19" title="">19</a>]</cite>, data that is well-classified tends to exhibit high perceptual quality, contributing to superior image generation outcomes.</p>
</div>
<div class="ltx_para" id="S2.SS4.p2">
<p class="ltx_p" id="S2.SS4.p2.1">Despite its effectiveness in balancing precision and recall, classifier guidance depends on the gradients of an image classifier, limiting the variability of generated images. This dependency raises the question of whether it is possible to achieve comparable or superior guidance without relying on a classifier.</p>
</div>
<div class="ltx_para" id="S2.SS4.p3">
<p class="ltx_p" id="S2.SS4.p3.1"><span class="ltx_text ltx_font_bold" id="S2.SS4.p3.1.1">Classifier-free guidance</span>, introduced by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib7" title="">7</a>]</cite>, addresses this issue by eliminating the need for a dedicated classifier. Instead, it involves training an unconditional denoising diffusion model, parameterized by a score estimator, alongside a conditional denoising diffusion model, parameterized by a conditional score estimator. These are parameterized using a single neural network. For the unconditional model, a null token is used for the class identifier. The models are jointly trained, with the conditioning randomly set to a null token based on a hyperparameter probability p-uncond. This methodology not only simplifies the model architecture but also enhances guidance capabilities without the dependence on an external classifier.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Methodology</span>
</h2>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="262" id="S3.F1.g1" src="extracted/5858476/system_diagram.png" width="588"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Diagram of Our Recommender System</figcaption>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The approach adopted in this paper consists of two principle components, detailed in green and blue in Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S3.F1" title="Figure 1 ‣ III Methodology ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>. The first component is the diffusion process, encompassing the forward and reverse processes as well as the sampling procedure. Our methodology is inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib15" title="">15</a>]</cite>, which serves as our baseline. In contrast to the original work, which relies solely on partially corrupted original data to guide the denoising model during the reverse process (pseudo-guidance), this study requires an adaptation to implement classifier-free guidance. In this section, we will elucidate the implementation of this external guidance and explore the options available for this type of task. Furthermore, we will discuss the modifications made to the model architecture both independently and as a result of the new form of guidance, and elaborate on the workings of the diffusion process. By thoroughly examining these components, we aim to underscore the necessity and efficacy of incorporating classifier-free guidance into diffusion-based RSs.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">The use of partially-noised data for guidance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib15" title="">15</a>]</cite> is inherently incompatible with the classifier-free guidance paradigm. To address this, instead of using partially noised data, we employed pre-noised data to derive guidance. This novel form of guidance, which will be elaborated upon later in this section, enables the seamless integration of classifier-free guidance into the training process. By implementing this revised approach, we aim to enhance the efficacy and flexibility of diffusion-based RSs.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.4.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.5.2">Diffusion Process</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The diffusion process consists of a forward process and a reverse process. Given that our modifications primarily impact the reverse process and the denoising model, we will provide an in-depth exploration of the reverse process in the subsequent section. In this section, we will offer a brief overview of how it integrates within the overall diffusion framework. The notations for the forward and reverse processes differ. The forward process is described as follows:</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(x_{t}|x_{t-1})=\mathcal{N}(x_{t},\sqrt{1-\beta_{t}}x_{t—1},\beta_{t}I)" class="ltx_Math" display="block" id="S3.E1.m1.4"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">q</mi><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.3.3.1" xref="S3.E1.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E1.m1.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.5" xref="S3.E1.m1.4.4.5.cmml">=</mo><mrow id="S3.E1.m1.4.4.4" xref="S3.E1.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.4.5" xref="S3.E1.m1.4.4.4.5.cmml">𝒩</mi><mo id="S3.E1.m1.4.4.4.4" xref="S3.E1.m1.4.4.4.4.cmml">⁢</mo><mrow id="S3.E1.m1.4.4.4.3.3" xref="S3.E1.m1.4.4.4.3.4.cmml"><mo id="S3.E1.m1.4.4.4.3.3.4" stretchy="false" xref="S3.E1.m1.4.4.4.3.4.cmml">(</mo><msub id="S3.E1.m1.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.2.2.2.1.1.1.2" xref="S3.E1.m1.2.2.2.1.1.1.2.cmml">x</mi><mi id="S3.E1.m1.2.2.2.1.1.1.3" xref="S3.E1.m1.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E1.m1.4.4.4.3.3.5" xref="S3.E1.m1.4.4.4.3.4.cmml">,</mo><mrow id="S3.E1.m1.3.3.3.2.2.2" xref="S3.E1.m1.3.3.3.2.2.2.cmml"><msqrt id="S3.E1.m1.3.3.3.2.2.2.2" xref="S3.E1.m1.3.3.3.2.2.2.2.cmml"><mrow id="S3.E1.m1.3.3.3.2.2.2.2.2" xref="S3.E1.m1.3.3.3.2.2.2.2.2.cmml"><mn id="S3.E1.m1.3.3.3.2.2.2.2.2.2" xref="S3.E1.m1.3.3.3.2.2.2.2.2.2.cmml">1</mn><mo id="S3.E1.m1.3.3.3.2.2.2.2.2.1" xref="S3.E1.m1.3.3.3.2.2.2.2.2.1.cmml">−</mo><msub id="S3.E1.m1.3.3.3.2.2.2.2.2.3" xref="S3.E1.m1.3.3.3.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.3.3.3.2.2.2.2.2.3.2" xref="S3.E1.m1.3.3.3.2.2.2.2.2.3.2.cmml">β</mi><mi id="S3.E1.m1.3.3.3.2.2.2.2.2.3.3" xref="S3.E1.m1.3.3.3.2.2.2.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="S3.E1.m1.3.3.3.2.2.2.1" xref="S3.E1.m1.3.3.3.2.2.2.1.cmml">⁢</mo><msub id="S3.E1.m1.3.3.3.2.2.2.3" xref="S3.E1.m1.3.3.3.2.2.2.3.cmml"><mi id="S3.E1.m1.3.3.3.2.2.2.3.2" xref="S3.E1.m1.3.3.3.2.2.2.3.2.cmml">x</mi><mrow id="S3.E1.m1.3.3.3.2.2.2.3.3" xref="S3.E1.m1.3.3.3.2.2.2.3.3.cmml"><mi id="S3.E1.m1.3.3.3.2.2.2.3.3.2" xref="S3.E1.m1.3.3.3.2.2.2.3.3.2.cmml">t</mi><mo id="S3.E1.m1.3.3.3.2.2.2.3.3.1" xref="S3.E1.m1.3.3.3.2.2.2.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.3.3.3.2.2.2.3.3.3" mathvariant="normal" xref="S3.E1.m1.3.3.3.2.2.2.3.3.3.cmml">—</mi><mo id="S3.E1.m1.3.3.3.2.2.2.3.3.1a" xref="S3.E1.m1.3.3.3.2.2.2.3.3.1.cmml">⁢</mo><mn id="S3.E1.m1.3.3.3.2.2.2.3.3.4" xref="S3.E1.m1.3.3.3.2.2.2.3.3.4.cmml">1</mn></mrow></msub></mrow><mo id="S3.E1.m1.4.4.4.3.3.6" xref="S3.E1.m1.4.4.4.3.4.cmml">,</mo><mrow id="S3.E1.m1.4.4.4.3.3.3" xref="S3.E1.m1.4.4.4.3.3.3.cmml"><msub id="S3.E1.m1.4.4.4.3.3.3.2" xref="S3.E1.m1.4.4.4.3.3.3.2.cmml"><mi id="S3.E1.m1.4.4.4.3.3.3.2.2" xref="S3.E1.m1.4.4.4.3.3.3.2.2.cmml">β</mi><mi id="S3.E1.m1.4.4.4.3.3.3.2.3" xref="S3.E1.m1.4.4.4.3.3.3.2.3.cmml">t</mi></msub><mo id="S3.E1.m1.4.4.4.3.3.3.1" xref="S3.E1.m1.4.4.4.3.3.3.1.cmml">⁢</mo><mi id="S3.E1.m1.4.4.4.3.3.3.3" xref="S3.E1.m1.4.4.4.3.3.3.3.cmml">I</mi></mrow><mo id="S3.E1.m1.4.4.4.3.3.7" stretchy="false" xref="S3.E1.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><eq id="S3.E1.m1.4.4.5.cmml" xref="S3.E1.m1.4.4.5"></eq><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><times id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">𝑞</ci><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.E1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3"><minus id="S3.E1.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E1.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.E1.m1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.E1.m1.4.4.4.cmml" xref="S3.E1.m1.4.4.4"><times id="S3.E1.m1.4.4.4.4.cmml" xref="S3.E1.m1.4.4.4.4"></times><ci id="S3.E1.m1.4.4.4.5.cmml" xref="S3.E1.m1.4.4.4.5">𝒩</ci><vector id="S3.E1.m1.4.4.4.3.4.cmml" xref="S3.E1.m1.4.4.4.3.3"><apply id="S3.E1.m1.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.2.1.1.1.2">𝑥</ci><ci id="S3.E1.m1.2.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S3.E1.m1.3.3.3.2.2.2.cmml" xref="S3.E1.m1.3.3.3.2.2.2"><times id="S3.E1.m1.3.3.3.2.2.2.1.cmml" xref="S3.E1.m1.3.3.3.2.2.2.1"></times><apply id="S3.E1.m1.3.3.3.2.2.2.2.cmml" xref="S3.E1.m1.3.3.3.2.2.2.2"><root id="S3.E1.m1.3.3.3.2.2.2.2a.cmml" xref="S3.E1.m1.3.3.3.2.2.2.2"></root><apply id="S3.E1.m1.3.3.3.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.3.2.2.2.2.2"><minus id="S3.E1.m1.3.3.3.2.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.3.2.2.2.2.2.1"></minus><cn id="S3.E1.m1.3.3.3.2.2.2.2.2.2.cmml" type="integer" xref="S3.E1.m1.3.3.3.2.2.2.2.2.2">1</cn><apply id="S3.E1.m1.3.3.3.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.3.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.2.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.3.2.2.2.2.2.3.2">𝛽</ci><ci id="S3.E1.m1.3.3.3.2.2.2.2.2.3.3.cmml" xref="S3.E1.m1.3.3.3.2.2.2.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E1.m1.3.3.3.2.2.2.3.cmml" xref="S3.E1.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="S3.E1.m1.3.3.3.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.3.2.2.2.3.2">𝑥</ci><apply id="S3.E1.m1.3.3.3.2.2.2.3.3.cmml" xref="S3.E1.m1.3.3.3.2.2.2.3.3"><times id="S3.E1.m1.3.3.3.2.2.2.3.3.1.cmml" xref="S3.E1.m1.3.3.3.2.2.2.3.3.1"></times><ci id="S3.E1.m1.3.3.3.2.2.2.3.3.2.cmml" xref="S3.E1.m1.3.3.3.2.2.2.3.3.2">𝑡</ci><ci id="S3.E1.m1.3.3.3.2.2.2.3.3.3.cmml" xref="S3.E1.m1.3.3.3.2.2.2.3.3.3">—</ci><cn id="S3.E1.m1.3.3.3.2.2.2.3.3.4.cmml" type="integer" xref="S3.E1.m1.3.3.3.2.2.2.3.3.4">1</cn></apply></apply></apply><apply id="S3.E1.m1.4.4.4.3.3.3.cmml" xref="S3.E1.m1.4.4.4.3.3.3"><times id="S3.E1.m1.4.4.4.3.3.3.1.cmml" xref="S3.E1.m1.4.4.4.3.3.3.1"></times><apply id="S3.E1.m1.4.4.4.3.3.3.2.cmml" xref="S3.E1.m1.4.4.4.3.3.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.3.3.3.2.1.cmml" xref="S3.E1.m1.4.4.4.3.3.3.2">subscript</csymbol><ci id="S3.E1.m1.4.4.4.3.3.3.2.2.cmml" xref="S3.E1.m1.4.4.4.3.3.3.2.2">𝛽</ci><ci id="S3.E1.m1.4.4.4.3.3.3.2.3.cmml" xref="S3.E1.m1.4.4.4.3.3.3.2.3">𝑡</ci></apply><ci id="S3.E1.m1.4.4.4.3.3.3.3.cmml" xref="S3.E1.m1.4.4.4.3.3.3.3">𝐼</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">q(x_{t}|x_{t-1})=\mathcal{N}(x_{t},\sqrt{1-\beta_{t}}x_{t—1},\beta_{t}I)</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.4d">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) = caligraphic_N ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , square-root start_ARG 1 - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_x start_POSTSUBSCRIPT italic_t — 1 end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.11">where <math alttext="x_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑥</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">x_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the output of the forward process at step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p3.2.m2.1"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.2.m2.1d">italic_t</annotation></semantics></math>, the output of step <math alttext="t-1" class="ltx_Math" display="inline" id="S3.SS1.p3.3.m3.1"><semantics id="S3.SS1.p3.3.m3.1a"><mrow id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">t</mi><mo id="S3.SS1.p3.3.m3.1.1.1" xref="S3.SS1.p3.3.m3.1.1.1.cmml">−</mo><mn id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><minus id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1.1"></minus><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝑡</ci><cn id="S3.SS1.p3.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">t-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.3.m3.1d">italic_t - 1</annotation></semantics></math> (<math alttext="x_{t-1}" class="ltx_Math" display="inline" id="S3.SS1.p3.4.m4.1"><semantics id="S3.SS1.p3.4.m4.1a"><msub id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml">x</mi><mrow id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p3.4.m4.1.1.3.1" xref="S3.SS1.p3.4.m4.1.1.3.1.cmml">−</mo><mn id="S3.SS1.p3.4.m4.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2">𝑥</ci><apply id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3"><minus id="S3.SS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3.1"></minus><ci id="S3.SS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2">𝑡</ci><cn id="S3.SS1.p3.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS1.p3.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">x_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math>) is the input at time step <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p3.5.m5.1"><semantics id="S3.SS1.p3.5.m5.1a"><mi id="S3.SS1.p3.5.m5.1.1" xref="S3.SS1.p3.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m5.1b"><ci id="S3.SS1.p3.5.m5.1.1.cmml" xref="S3.SS1.p3.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m5.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.5.m5.1d">italic_t</annotation></semantics></math>. <math alttext="\mathcal{N}" class="ltx_Math" display="inline" id="S3.SS1.p3.6.m6.1"><semantics id="S3.SS1.p3.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.6.m6.1.1" xref="S3.SS1.p3.6.m6.1.1.cmml">𝒩</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m6.1b"><ci id="S3.SS1.p3.6.m6.1.1.cmml" xref="S3.SS1.p3.6.m6.1.1">𝒩</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m6.1c">\mathcal{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.6.m6.1d">caligraphic_N</annotation></semantics></math> denotes a normal distribution. In the reverse process, denoted as <math alttext="p" class="ltx_Math" display="inline" id="S3.SS1.p3.7.m7.1"><semantics id="S3.SS1.p3.7.m7.1a"><mi id="S3.SS1.p3.7.m7.1.1" xref="S3.SS1.p3.7.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m7.1b"><ci id="S3.SS1.p3.7.m7.1.1.cmml" xref="S3.SS1.p3.7.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m7.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.7.m7.1d">italic_p</annotation></semantics></math>, we predict the noise to reconstruct <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p3.8.m8.1"><semantics id="S3.SS1.p3.8.m8.1a"><mi id="S3.SS1.p3.8.m8.1.1" xref="S3.SS1.p3.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.8.m8.1b"><ci id="S3.SS1.p3.8.m8.1.1.cmml" xref="S3.SS1.p3.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.8.m8.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.8.m8.1d">italic_q</annotation></semantics></math>, whereas <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p3.9.m9.1"><semantics id="S3.SS1.p3.9.m9.1a"><mi id="S3.SS1.p3.9.m9.1.1" xref="S3.SS1.p3.9.m9.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.9.m9.1b"><ci id="S3.SS1.p3.9.m9.1.1.cmml" xref="S3.SS1.p3.9.m9.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.9.m9.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.9.m9.1d">italic_q</annotation></semantics></math> is a predetermined function for the forward process. For the forward process at timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS1.p3.10.m10.1"><semantics id="S3.SS1.p3.10.m10.1a"><mi id="S3.SS1.p3.10.m10.1.1" xref="S3.SS1.p3.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.10.m10.1b"><ci id="S3.SS1.p3.10.m10.1.1.cmml" xref="S3.SS1.p3.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.10.m10.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.10.m10.1d">italic_t</annotation></semantics></math>, modeled as a normal distribution, we define it by its mean and variance parameters, respectively. <math alttext="\beta_{t}" class="ltx_Math" display="inline" id="S3.SS1.p3.11.m11.1"><semantics id="S3.SS1.p3.11.m11.1a"><msub id="S3.SS1.p3.11.m11.1.1" xref="S3.SS1.p3.11.m11.1.1.cmml"><mi id="S3.SS1.p3.11.m11.1.1.2" xref="S3.SS1.p3.11.m11.1.1.2.cmml">β</mi><mi id="S3.SS1.p3.11.m11.1.1.3" xref="S3.SS1.p3.11.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.11.m11.1b"><apply id="S3.SS1.p3.11.m11.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.11.m11.1.1.1.cmml" xref="S3.SS1.p3.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p3.11.m11.1.1.2.cmml" xref="S3.SS1.p3.11.m11.1.1.2">𝛽</ci><ci id="S3.SS1.p3.11.m11.1.1.3.cmml" xref="S3.SS1.p3.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.11.m11.1c">\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.11.m11.1d">italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> in both mean and variance refers to a scheduler.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">In our work, we employ a linear scheduling approach, which has gained significant traction in recent research. As the term suggests, a linear schedule refers to a sequential method for incrementally adding noise to an image or, in our specific application, to a sequence of interactions. This process can be modeled as a Markov chain, where each step in the sequence is dependent on the previous one to ensure the accurate introduction of noise. Although this iterative approach is characteristic of Markov chains, it could result in inefficiencies during training due to its inherently slow progression. However, this issue is circumvented by adopting the reparameterization technique introduced in the Stable Diffusion framework by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib5" title="">5</a>]</cite>. This method allows us to bypass the need for iterative sampling at each timestep, enabling us to generate the desired output in a single step using the formula:</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q(x_{t}|x_{0})=\sqrt{\bar{\alpha}_{t}}x_{0}+\sqrt{1-\bar{\alpha}_{t}}\epsilon=%
\mathcal{N}(x_{t};\sqrt{\bar{\alpha}_{t}}x_{0},(1-\bar{\alpha}_{t})I)" class="ltx_Math" display="block" id="S3.E2.m1.4"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">q</mi><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E2.m1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.E2.m1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S3.E2.m1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.E2.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.4.4.6" xref="S3.E2.m1.4.4.6.cmml">=</mo><mrow id="S3.E2.m1.4.4.7" xref="S3.E2.m1.4.4.7.cmml"><mrow id="S3.E2.m1.4.4.7.2" xref="S3.E2.m1.4.4.7.2.cmml"><msqrt id="S3.E2.m1.4.4.7.2.2" xref="S3.E2.m1.4.4.7.2.2.cmml"><msub id="S3.E2.m1.4.4.7.2.2.2" xref="S3.E2.m1.4.4.7.2.2.2.cmml"><mover accent="true" id="S3.E2.m1.4.4.7.2.2.2.2" xref="S3.E2.m1.4.4.7.2.2.2.2.cmml"><mi id="S3.E2.m1.4.4.7.2.2.2.2.2" xref="S3.E2.m1.4.4.7.2.2.2.2.2.cmml">α</mi><mo id="S3.E2.m1.4.4.7.2.2.2.2.1" xref="S3.E2.m1.4.4.7.2.2.2.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.4.4.7.2.2.2.3" xref="S3.E2.m1.4.4.7.2.2.2.3.cmml">t</mi></msub></msqrt><mo id="S3.E2.m1.4.4.7.2.1" xref="S3.E2.m1.4.4.7.2.1.cmml">⁢</mo><msub id="S3.E2.m1.4.4.7.2.3" xref="S3.E2.m1.4.4.7.2.3.cmml"><mi id="S3.E2.m1.4.4.7.2.3.2" xref="S3.E2.m1.4.4.7.2.3.2.cmml">x</mi><mn id="S3.E2.m1.4.4.7.2.3.3" xref="S3.E2.m1.4.4.7.2.3.3.cmml">0</mn></msub></mrow><mo id="S3.E2.m1.4.4.7.1" xref="S3.E2.m1.4.4.7.1.cmml">+</mo><mrow id="S3.E2.m1.4.4.7.3" xref="S3.E2.m1.4.4.7.3.cmml"><msqrt id="S3.E2.m1.4.4.7.3.2" xref="S3.E2.m1.4.4.7.3.2.cmml"><mrow id="S3.E2.m1.4.4.7.3.2.2" xref="S3.E2.m1.4.4.7.3.2.2.cmml"><mn id="S3.E2.m1.4.4.7.3.2.2.2" xref="S3.E2.m1.4.4.7.3.2.2.2.cmml">1</mn><mo id="S3.E2.m1.4.4.7.3.2.2.1" xref="S3.E2.m1.4.4.7.3.2.2.1.cmml">−</mo><msub id="S3.E2.m1.4.4.7.3.2.2.3" xref="S3.E2.m1.4.4.7.3.2.2.3.cmml"><mover accent="true" id="S3.E2.m1.4.4.7.3.2.2.3.2" xref="S3.E2.m1.4.4.7.3.2.2.3.2.cmml"><mi id="S3.E2.m1.4.4.7.3.2.2.3.2.2" xref="S3.E2.m1.4.4.7.3.2.2.3.2.2.cmml">α</mi><mo id="S3.E2.m1.4.4.7.3.2.2.3.2.1" xref="S3.E2.m1.4.4.7.3.2.2.3.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.4.4.7.3.2.2.3.3" xref="S3.E2.m1.4.4.7.3.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="S3.E2.m1.4.4.7.3.1" xref="S3.E2.m1.4.4.7.3.1.cmml">⁢</mo><mi id="S3.E2.m1.4.4.7.3.3" xref="S3.E2.m1.4.4.7.3.3.cmml">ϵ</mi></mrow></mrow><mo id="S3.E2.m1.4.4.8" xref="S3.E2.m1.4.4.8.cmml">=</mo><mrow id="S3.E2.m1.4.4.4" xref="S3.E2.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.4.5" xref="S3.E2.m1.4.4.4.5.cmml">𝒩</mi><mo id="S3.E2.m1.4.4.4.4" xref="S3.E2.m1.4.4.4.4.cmml">⁢</mo><mrow id="S3.E2.m1.4.4.4.3.3" xref="S3.E2.m1.4.4.4.3.4.cmml"><mo id="S3.E2.m1.4.4.4.3.3.4" stretchy="false" xref="S3.E2.m1.4.4.4.3.4.cmml">(</mo><msub id="S3.E2.m1.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.2.cmml">x</mi><mi id="S3.E2.m1.2.2.2.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E2.m1.4.4.4.3.3.5" xref="S3.E2.m1.4.4.4.3.4.cmml">;</mo><mrow id="S3.E2.m1.3.3.3.2.2.2" xref="S3.E2.m1.3.3.3.2.2.2.cmml"><msqrt id="S3.E2.m1.3.3.3.2.2.2.2" xref="S3.E2.m1.3.3.3.2.2.2.2.cmml"><msub id="S3.E2.m1.3.3.3.2.2.2.2.2" xref="S3.E2.m1.3.3.3.2.2.2.2.2.cmml"><mover accent="true" id="S3.E2.m1.3.3.3.2.2.2.2.2.2" xref="S3.E2.m1.3.3.3.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.3.3.3.2.2.2.2.2.2.2" xref="S3.E2.m1.3.3.3.2.2.2.2.2.2.2.cmml">α</mi><mo id="S3.E2.m1.3.3.3.2.2.2.2.2.2.1" xref="S3.E2.m1.3.3.3.2.2.2.2.2.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.3.3.3.2.2.2.2.2.3" xref="S3.E2.m1.3.3.3.2.2.2.2.2.3.cmml">t</mi></msub></msqrt><mo id="S3.E2.m1.3.3.3.2.2.2.1" xref="S3.E2.m1.3.3.3.2.2.2.1.cmml">⁢</mo><msub id="S3.E2.m1.3.3.3.2.2.2.3" xref="S3.E2.m1.3.3.3.2.2.2.3.cmml"><mi id="S3.E2.m1.3.3.3.2.2.2.3.2" xref="S3.E2.m1.3.3.3.2.2.2.3.2.cmml">x</mi><mn id="S3.E2.m1.3.3.3.2.2.2.3.3" xref="S3.E2.m1.3.3.3.2.2.2.3.3.cmml">0</mn></msub></mrow><mo id="S3.E2.m1.4.4.4.3.3.6" xref="S3.E2.m1.4.4.4.3.4.cmml">,</mo><mrow id="S3.E2.m1.4.4.4.3.3.3" xref="S3.E2.m1.4.4.4.3.3.3.cmml"><mrow id="S3.E2.m1.4.4.4.3.3.3.1.1" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.cmml"><mo id="S3.E2.m1.4.4.4.3.3.3.1.1.2" stretchy="false" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.4.4.4.3.3.3.1.1.1" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.cmml"><mn id="S3.E2.m1.4.4.4.3.3.3.1.1.1.2" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.2.cmml">1</mn><mo id="S3.E2.m1.4.4.4.3.3.3.1.1.1.1" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.1.cmml">−</mo><msub id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.cmml"><mover accent="true" id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.cmml"><mi id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.2" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.2.cmml">α</mi><mo id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.1" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.3" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E2.m1.4.4.4.3.3.3.1.1.3" stretchy="false" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.cmml">)</mo></mrow><mo id="S3.E2.m1.4.4.4.3.3.3.2" xref="S3.E2.m1.4.4.4.3.3.3.2.cmml">⁢</mo><mi id="S3.E2.m1.4.4.4.3.3.3.3" xref="S3.E2.m1.4.4.4.3.3.3.3.cmml">I</mi></mrow><mo id="S3.E2.m1.4.4.4.3.3.7" stretchy="false" xref="S3.E2.m1.4.4.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4"><and id="S3.E2.m1.4.4a.cmml" xref="S3.E2.m1.4.4"></and><apply id="S3.E2.m1.4.4b.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.6.cmml" xref="S3.E2.m1.4.4.6"></eq><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝑞</ci><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S3.E2.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="S3.E2.m1.4.4.7.cmml" xref="S3.E2.m1.4.4.7"><plus id="S3.E2.m1.4.4.7.1.cmml" xref="S3.E2.m1.4.4.7.1"></plus><apply id="S3.E2.m1.4.4.7.2.cmml" xref="S3.E2.m1.4.4.7.2"><times id="S3.E2.m1.4.4.7.2.1.cmml" xref="S3.E2.m1.4.4.7.2.1"></times><apply id="S3.E2.m1.4.4.7.2.2.cmml" xref="S3.E2.m1.4.4.7.2.2"><root id="S3.E2.m1.4.4.7.2.2a.cmml" xref="S3.E2.m1.4.4.7.2.2"></root><apply id="S3.E2.m1.4.4.7.2.2.2.cmml" xref="S3.E2.m1.4.4.7.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.7.2.2.2.1.cmml" xref="S3.E2.m1.4.4.7.2.2.2">subscript</csymbol><apply id="S3.E2.m1.4.4.7.2.2.2.2.cmml" xref="S3.E2.m1.4.4.7.2.2.2.2"><ci id="S3.E2.m1.4.4.7.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.7.2.2.2.2.1">¯</ci><ci id="S3.E2.m1.4.4.7.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.7.2.2.2.2.2">𝛼</ci></apply><ci id="S3.E2.m1.4.4.7.2.2.2.3.cmml" xref="S3.E2.m1.4.4.7.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.4.4.7.2.3.cmml" xref="S3.E2.m1.4.4.7.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.7.2.3.1.cmml" xref="S3.E2.m1.4.4.7.2.3">subscript</csymbol><ci id="S3.E2.m1.4.4.7.2.3.2.cmml" xref="S3.E2.m1.4.4.7.2.3.2">𝑥</ci><cn id="S3.E2.m1.4.4.7.2.3.3.cmml" type="integer" xref="S3.E2.m1.4.4.7.2.3.3">0</cn></apply></apply><apply id="S3.E2.m1.4.4.7.3.cmml" xref="S3.E2.m1.4.4.7.3"><times id="S3.E2.m1.4.4.7.3.1.cmml" xref="S3.E2.m1.4.4.7.3.1"></times><apply id="S3.E2.m1.4.4.7.3.2.cmml" xref="S3.E2.m1.4.4.7.3.2"><root id="S3.E2.m1.4.4.7.3.2a.cmml" xref="S3.E2.m1.4.4.7.3.2"></root><apply id="S3.E2.m1.4.4.7.3.2.2.cmml" xref="S3.E2.m1.4.4.7.3.2.2"><minus id="S3.E2.m1.4.4.7.3.2.2.1.cmml" xref="S3.E2.m1.4.4.7.3.2.2.1"></minus><cn id="S3.E2.m1.4.4.7.3.2.2.2.cmml" type="integer" xref="S3.E2.m1.4.4.7.3.2.2.2">1</cn><apply id="S3.E2.m1.4.4.7.3.2.2.3.cmml" xref="S3.E2.m1.4.4.7.3.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.7.3.2.2.3.1.cmml" xref="S3.E2.m1.4.4.7.3.2.2.3">subscript</csymbol><apply id="S3.E2.m1.4.4.7.3.2.2.3.2.cmml" xref="S3.E2.m1.4.4.7.3.2.2.3.2"><ci id="S3.E2.m1.4.4.7.3.2.2.3.2.1.cmml" xref="S3.E2.m1.4.4.7.3.2.2.3.2.1">¯</ci><ci id="S3.E2.m1.4.4.7.3.2.2.3.2.2.cmml" xref="S3.E2.m1.4.4.7.3.2.2.3.2.2">𝛼</ci></apply><ci id="S3.E2.m1.4.4.7.3.2.2.3.3.cmml" xref="S3.E2.m1.4.4.7.3.2.2.3.3">𝑡</ci></apply></apply></apply><ci id="S3.E2.m1.4.4.7.3.3.cmml" xref="S3.E2.m1.4.4.7.3.3">italic-ϵ</ci></apply></apply></apply><apply id="S3.E2.m1.4.4c.cmml" xref="S3.E2.m1.4.4"><eq id="S3.E2.m1.4.4.8.cmml" xref="S3.E2.m1.4.4.8"></eq><share href="https://arxiv.org/html/2409.10494v1#S3.E2.m1.4.4.7.cmml" id="S3.E2.m1.4.4d.cmml" xref="S3.E2.m1.4.4"></share><apply id="S3.E2.m1.4.4.4.cmml" xref="S3.E2.m1.4.4.4"><times id="S3.E2.m1.4.4.4.4.cmml" xref="S3.E2.m1.4.4.4.4"></times><ci id="S3.E2.m1.4.4.4.5.cmml" xref="S3.E2.m1.4.4.4.5">𝒩</ci><list id="S3.E2.m1.4.4.4.3.4.cmml" xref="S3.E2.m1.4.4.4.3.3"><apply id="S3.E2.m1.2.2.2.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.2">𝑥</ci><ci id="S3.E2.m1.2.2.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.3">𝑡</ci></apply><apply id="S3.E2.m1.3.3.3.2.2.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2"><times id="S3.E2.m1.3.3.3.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.2.2.2.1"></times><apply id="S3.E2.m1.3.3.3.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2"><root id="S3.E2.m1.3.3.3.2.2.2.2a.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2"></root><apply id="S3.E2.m1.3.3.3.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.2.2.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2.2">subscript</csymbol><apply id="S3.E2.m1.3.3.3.2.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2.2.2"><ci id="S3.E2.m1.3.3.3.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2.2.2.1">¯</ci><ci id="S3.E2.m1.3.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2.2.2.2">𝛼</ci></apply><ci id="S3.E2.m1.3.3.3.2.2.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.2.2.2.2.2.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.3.3.3.2.2.2.3.cmml" xref="S3.E2.m1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.3.2.2.2.3.1.cmml" xref="S3.E2.m1.3.3.3.2.2.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.3.2.2.2.3.2.cmml" xref="S3.E2.m1.3.3.3.2.2.2.3.2">𝑥</ci><cn id="S3.E2.m1.3.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.E2.m1.3.3.3.2.2.2.3.3">0</cn></apply></apply><apply id="S3.E2.m1.4.4.4.3.3.3.cmml" xref="S3.E2.m1.4.4.4.3.3.3"><times id="S3.E2.m1.4.4.4.3.3.3.2.cmml" xref="S3.E2.m1.4.4.4.3.3.3.2"></times><apply id="S3.E2.m1.4.4.4.3.3.3.1.1.1.cmml" xref="S3.E2.m1.4.4.4.3.3.3.1.1"><minus id="S3.E2.m1.4.4.4.3.3.3.1.1.1.1.cmml" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.1"></minus><cn id="S3.E2.m1.4.4.4.3.3.3.1.1.1.2.cmml" type="integer" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.2">1</cn><apply id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.cmml" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3">subscript</csymbol><apply id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2"><ci id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.1.cmml" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.1">¯</ci><ci id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.2.cmml" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.2.2">𝛼</ci></apply><ci id="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.4.3.3.3.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S3.E2.m1.4.4.4.3.3.3.3.cmml" xref="S3.E2.m1.4.4.4.3.3.3.3">𝐼</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">q(x_{t}|x_{0})=\sqrt{\bar{\alpha}_{t}}x_{0}+\sqrt{1-\bar{\alpha}_{t}}\epsilon=%
\mathcal{N}(x_{t};\sqrt{\bar{\alpha}_{t}}x_{0},(1-\bar{\alpha}_{t})I)</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.4d">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_ϵ = caligraphic_N ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ; square-root start_ARG over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , ( 1 - over¯ start_ARG italic_α end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) italic_I )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1">With this new formula, we can efficiently calculate the noise to be added at any arbitrary timestep without the need to sequentially traverse all preceding steps. This significantly accelerates the training process.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.4.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.5.2">Denoising Model/Reverse Process</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The primary modifications pertain to the denoising model. In this section, we will thoroughly examine these modifications and their implementation. First, we will elucidate the purpose of the denoising model in diffusion models and discuss any differences in its application for RSs. We will then identify the shortcomings of the original denoising model in incorporating classifier-free guidance and explain the steps taken to address these issues.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">The denoising model is fundamental to reversing the noise introduced in the forward process. In image diffusion models, a U-Net architecture is commonly employed due to its effectiveness in noise removal tasks. However, given that our dataset is not as extensive as typical image data, we can opt for a simpler architecture, such as a straightforward feedforward network. The primary function of the denoising model is to predict the noise at each timestep, facilitating the reversal process until timestep 0 (fully reversed) is reached. Once the noise is predicted, only a portion of that predicted noise, proportional to the timestep, is removed. Building upon the equation for the reverse process as outlined in the original Stable Diffusion paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib5" title="">5</a>]</cite> (Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S3.E3" title="In III-B Denoising Model/Reverse Process ‣ III Methodology ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S3.E4" title="In III-B Denoising Model/Reverse Process ‣ III Methodology ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a>), our modifications adapt this framework to our specific needs.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{\theta}(x_{0}:T):=p(x_{T})\prod^{T}_{t=1}p_{\theta}(x_{t-1}|x_{t})" class="ltx_math_unparsed" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1b"><msub id="S3.E3.m1.1.1"><mi id="S3.E3.m1.1.1.2">p</mi><mi id="S3.E3.m1.1.1.3">θ</mi></msub><mrow id="S3.E3.m1.1.2"><mo id="S3.E3.m1.1.2.1" stretchy="false">(</mo><msub id="S3.E3.m1.1.2.2"><mi id="S3.E3.m1.1.2.2.2">x</mi><mn id="S3.E3.m1.1.2.2.3">0</mn></msub><mo id="S3.E3.m1.1.2.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.E3.m1.1.2.4">T</mi><mo id="S3.E3.m1.1.2.5" rspace="0.278em" stretchy="false">)</mo></mrow><mo id="S3.E3.m1.1.3" rspace="0.278em">:=</mo><mi id="S3.E3.m1.1.4">p</mi><mrow id="S3.E3.m1.1.5"><mo id="S3.E3.m1.1.5.1" stretchy="false">(</mo><msub id="S3.E3.m1.1.5.2"><mi id="S3.E3.m1.1.5.2.2">x</mi><mi id="S3.E3.m1.1.5.2.3">T</mi></msub><mo id="S3.E3.m1.1.5.3" stretchy="false">)</mo></mrow><munderover id="S3.E3.m1.1.6"><mo id="S3.E3.m1.1.6.2.2" movablelimits="false">∏</mo><mrow id="S3.E3.m1.1.6.3"><mi id="S3.E3.m1.1.6.3.2">t</mi><mo id="S3.E3.m1.1.6.3.1">=</mo><mn id="S3.E3.m1.1.6.3.3">1</mn></mrow><mi id="S3.E3.m1.1.6.2.3">T</mi></munderover><msub id="S3.E3.m1.1.7"><mi id="S3.E3.m1.1.7.2">p</mi><mi id="S3.E3.m1.1.7.3">θ</mi></msub><mrow id="S3.E3.m1.1.8"><mo id="S3.E3.m1.1.8.1" stretchy="false">(</mo><msub id="S3.E3.m1.1.8.2"><mi id="S3.E3.m1.1.8.2.2">x</mi><mrow id="S3.E3.m1.1.8.2.3"><mi id="S3.E3.m1.1.8.2.3.2">t</mi><mo id="S3.E3.m1.1.8.2.3.1">−</mo><mn id="S3.E3.m1.1.8.2.3.3">1</mn></mrow></msub><mo fence="false" id="S3.E3.m1.1.8.3" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E3.m1.1.8.4"><mi id="S3.E3.m1.1.8.4.2">x</mi><mi id="S3.E3.m1.1.8.4.3">t</mi></msub><mo id="S3.E3.m1.1.8.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E3.m1.1c">p_{\theta}(x_{0}:T):=p(x_{T})\prod^{T}_{t=1}p_{\theta}(x_{t-1}|x_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT : italic_T ) := italic_p ( italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ∏ start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(x_{t-1};\mu_{\theta}(x_{t},t),\sum_{%
\theta}(x_{t},t))" class="ltx_Math" display="block" id="S3.E4.m1.6"><semantics id="S3.E4.m1.6a"><mrow id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml"><msub id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.3.3.1.3.cmml"><mi id="S3.E4.m1.3.3.1.3.2" xref="S3.E4.m1.3.3.1.3.2.cmml">p</mi><mi id="S3.E4.m1.3.3.1.3.3" xref="S3.E4.m1.3.3.1.3.3.cmml">θ</mi></msub><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><msub id="S3.E4.m1.3.3.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.2.2" xref="S3.E4.m1.3.3.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.E4.m1.3.3.1.1.1.1.2.3" xref="S3.E4.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.2.3.2" xref="S3.E4.m1.3.3.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E4.m1.3.3.1.1.1.1.2.3.1" xref="S3.E4.m1.3.3.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.E4.m1.3.3.1.1.1.1.2.3.3" xref="S3.E4.m1.3.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml">|</mo><msub id="S3.E4.m1.3.3.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.3.2" xref="S3.E4.m1.3.3.1.1.1.1.3.2.cmml">x</mi><mi id="S3.E4.m1.3.3.1.1.1.1.3.3" xref="S3.E4.m1.3.3.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E4.m1.3.3.1.1.1.3" stretchy="false" xref="S3.E4.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.6.6.5" xref="S3.E4.m1.6.6.5.cmml">=</mo><mrow id="S3.E4.m1.6.6.4" xref="S3.E4.m1.6.6.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.6.6.4.5" xref="S3.E4.m1.6.6.4.5.cmml">𝒩</mi><mo id="S3.E4.m1.6.6.4.4" xref="S3.E4.m1.6.6.4.4.cmml">⁢</mo><mrow id="S3.E4.m1.6.6.4.3.3" xref="S3.E4.m1.6.6.4.3.4.cmml"><mo id="S3.E4.m1.6.6.4.3.3.4" stretchy="false" xref="S3.E4.m1.6.6.4.3.4.cmml">(</mo><msub id="S3.E4.m1.4.4.2.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.2" xref="S3.E4.m1.4.4.2.1.1.1.2.cmml">x</mi><mrow id="S3.E4.m1.4.4.2.1.1.1.3" xref="S3.E4.m1.4.4.2.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.3.2" xref="S3.E4.m1.4.4.2.1.1.1.3.2.cmml">t</mi><mo id="S3.E4.m1.4.4.2.1.1.1.3.1" xref="S3.E4.m1.4.4.2.1.1.1.3.1.cmml">−</mo><mn id="S3.E4.m1.4.4.2.1.1.1.3.3" xref="S3.E4.m1.4.4.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E4.m1.6.6.4.3.3.5" xref="S3.E4.m1.6.6.4.3.4.cmml">;</mo><mrow id="S3.E4.m1.5.5.3.2.2.2" xref="S3.E4.m1.5.5.3.2.2.2.cmml"><msub id="S3.E4.m1.5.5.3.2.2.2.3" xref="S3.E4.m1.5.5.3.2.2.2.3.cmml"><mi id="S3.E4.m1.5.5.3.2.2.2.3.2" xref="S3.E4.m1.5.5.3.2.2.2.3.2.cmml">μ</mi><mi id="S3.E4.m1.5.5.3.2.2.2.3.3" xref="S3.E4.m1.5.5.3.2.2.2.3.3.cmml">θ</mi></msub><mo id="S3.E4.m1.5.5.3.2.2.2.2" xref="S3.E4.m1.5.5.3.2.2.2.2.cmml">⁢</mo><mrow id="S3.E4.m1.5.5.3.2.2.2.1.1" xref="S3.E4.m1.5.5.3.2.2.2.1.2.cmml"><mo id="S3.E4.m1.5.5.3.2.2.2.1.1.2" stretchy="false" xref="S3.E4.m1.5.5.3.2.2.2.1.2.cmml">(</mo><msub id="S3.E4.m1.5.5.3.2.2.2.1.1.1" xref="S3.E4.m1.5.5.3.2.2.2.1.1.1.cmml"><mi id="S3.E4.m1.5.5.3.2.2.2.1.1.1.2" xref="S3.E4.m1.5.5.3.2.2.2.1.1.1.2.cmml">x</mi><mi id="S3.E4.m1.5.5.3.2.2.2.1.1.1.3" xref="S3.E4.m1.5.5.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.E4.m1.5.5.3.2.2.2.1.1.3" xref="S3.E4.m1.5.5.3.2.2.2.1.2.cmml">,</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">t</mi><mo id="S3.E4.m1.5.5.3.2.2.2.1.1.4" stretchy="false" xref="S3.E4.m1.5.5.3.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.6.6.4.3.3.6" rspace="0em" xref="S3.E4.m1.6.6.4.3.4.cmml">,</mo><mrow id="S3.E4.m1.6.6.4.3.3.3" xref="S3.E4.m1.6.6.4.3.3.3.cmml"><munder id="S3.E4.m1.6.6.4.3.3.3.2" xref="S3.E4.m1.6.6.4.3.3.3.2.cmml"><mo id="S3.E4.m1.6.6.4.3.3.3.2.2" movablelimits="false" rspace="0em" xref="S3.E4.m1.6.6.4.3.3.3.2.2.cmml">∑</mo><mi id="S3.E4.m1.6.6.4.3.3.3.2.3" xref="S3.E4.m1.6.6.4.3.3.3.2.3.cmml">θ</mi></munder><mrow id="S3.E4.m1.6.6.4.3.3.3.1.1" xref="S3.E4.m1.6.6.4.3.3.3.1.2.cmml"><mo id="S3.E4.m1.6.6.4.3.3.3.1.1.2" stretchy="false" xref="S3.E4.m1.6.6.4.3.3.3.1.2.cmml">(</mo><msub id="S3.E4.m1.6.6.4.3.3.3.1.1.1" xref="S3.E4.m1.6.6.4.3.3.3.1.1.1.cmml"><mi id="S3.E4.m1.6.6.4.3.3.3.1.1.1.2" xref="S3.E4.m1.6.6.4.3.3.3.1.1.1.2.cmml">x</mi><mi id="S3.E4.m1.6.6.4.3.3.3.1.1.1.3" xref="S3.E4.m1.6.6.4.3.3.3.1.1.1.3.cmml">t</mi></msub><mo id="S3.E4.m1.6.6.4.3.3.3.1.1.3" xref="S3.E4.m1.6.6.4.3.3.3.1.2.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">t</mi><mo id="S3.E4.m1.6.6.4.3.3.3.1.1.4" stretchy="false" xref="S3.E4.m1.6.6.4.3.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.6.6.4.3.3.7" stretchy="false" xref="S3.E4.m1.6.6.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.6b"><apply id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"><eq id="S3.E4.m1.6.6.5.cmml" xref="S3.E4.m1.6.6.5"></eq><apply id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1"><times id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.2"></times><apply id="S3.E4.m1.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.3.1.cmml" xref="S3.E4.m1.3.3.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.3.2.cmml" xref="S3.E4.m1.3.3.1.3.2">𝑝</ci><ci id="S3.E4.m1.3.3.1.3.3.cmml" xref="S3.E4.m1.3.3.1.3.3">𝜃</ci></apply><apply id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.E4.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2.2">𝑥</ci><apply id="S3.E4.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2.3"><minus id="S3.E4.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2.3.1"></minus><ci id="S3.E4.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.E4.m1.3.3.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E4.m1.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.3.3.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3.2">𝑥</ci><ci id="S3.E4.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.6.6.4.cmml" xref="S3.E4.m1.6.6.4"><times id="S3.E4.m1.6.6.4.4.cmml" xref="S3.E4.m1.6.6.4.4"></times><ci id="S3.E4.m1.6.6.4.5.cmml" xref="S3.E4.m1.6.6.4.5">𝒩</ci><list id="S3.E4.m1.6.6.4.3.4.cmml" xref="S3.E4.m1.6.6.4.3.3"><apply id="S3.E4.m1.4.4.2.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.2.1.1.1.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.2">𝑥</ci><apply id="S3.E4.m1.4.4.2.1.1.1.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.3"><minus id="S3.E4.m1.4.4.2.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.3.1"></minus><ci id="S3.E4.m1.4.4.2.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.3.2">𝑡</ci><cn id="S3.E4.m1.4.4.2.1.1.1.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.2.1.1.1.3.3">1</cn></apply></apply><apply id="S3.E4.m1.5.5.3.2.2.2.cmml" xref="S3.E4.m1.5.5.3.2.2.2"><times id="S3.E4.m1.5.5.3.2.2.2.2.cmml" xref="S3.E4.m1.5.5.3.2.2.2.2"></times><apply id="S3.E4.m1.5.5.3.2.2.2.3.cmml" xref="S3.E4.m1.5.5.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.3.2.2.2.3.1.cmml" xref="S3.E4.m1.5.5.3.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.5.5.3.2.2.2.3.2.cmml" xref="S3.E4.m1.5.5.3.2.2.2.3.2">𝜇</ci><ci id="S3.E4.m1.5.5.3.2.2.2.3.3.cmml" xref="S3.E4.m1.5.5.3.2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.E4.m1.5.5.3.2.2.2.1.2.cmml" xref="S3.E4.m1.5.5.3.2.2.2.1.1"><apply id="S3.E4.m1.5.5.3.2.2.2.1.1.1.cmml" xref="S3.E4.m1.5.5.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.3.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.5.5.3.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.5.5.3.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.5.5.3.2.2.2.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.5.5.3.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.5.5.3.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑡</ci></interval></apply><apply id="S3.E4.m1.6.6.4.3.3.3.cmml" xref="S3.E4.m1.6.6.4.3.3.3"><apply id="S3.E4.m1.6.6.4.3.3.3.2.cmml" xref="S3.E4.m1.6.6.4.3.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.3.3.3.2.1.cmml" xref="S3.E4.m1.6.6.4.3.3.3.2">subscript</csymbol><sum id="S3.E4.m1.6.6.4.3.3.3.2.2.cmml" xref="S3.E4.m1.6.6.4.3.3.3.2.2"></sum><ci id="S3.E4.m1.6.6.4.3.3.3.2.3.cmml" xref="S3.E4.m1.6.6.4.3.3.3.2.3">𝜃</ci></apply><interval closure="open" id="S3.E4.m1.6.6.4.3.3.3.1.2.cmml" xref="S3.E4.m1.6.6.4.3.3.3.1.1"><apply id="S3.E4.m1.6.6.4.3.3.3.1.1.1.cmml" xref="S3.E4.m1.6.6.4.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.4.3.3.3.1.1.1.1.cmml" xref="S3.E4.m1.6.6.4.3.3.3.1.1.1">subscript</csymbol><ci id="S3.E4.m1.6.6.4.3.3.3.1.1.1.2.cmml" xref="S3.E4.m1.6.6.4.3.3.3.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.6.6.4.3.3.3.1.1.1.3.cmml" xref="S3.E4.m1.6.6.4.3.3.3.1.1.1.3">𝑡</ci></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑡</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.6c">p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(x_{t-1};\mu_{\theta}(x_{t},t),\sum_{%
\theta}(x_{t},t))</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.6d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = caligraphic_N ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ; italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) , ∑ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.6">where <math alttext="p_{\theta}(x_{0}:T)" class="ltx_math_unparsed" display="inline" id="S3.SS2.p5.1.m1.1"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1b"><msub id="S3.SS2.p5.1.m1.1.1"><mi id="S3.SS2.p5.1.m1.1.1.2">p</mi><mi id="S3.SS2.p5.1.m1.1.1.3">θ</mi></msub><mrow id="S3.SS2.p5.1.m1.1.2"><mo id="S3.SS2.p5.1.m1.1.2.1" stretchy="false">(</mo><msub id="S3.SS2.p5.1.m1.1.2.2"><mi id="S3.SS2.p5.1.m1.1.2.2.2">x</mi><mn id="S3.SS2.p5.1.m1.1.2.2.3">0</mn></msub><mo id="S3.SS2.p5.1.m1.1.2.3" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.SS2.p5.1.m1.1.2.4">T</mi><mo id="S3.SS2.p5.1.m1.1.2.5" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">p_{\theta}(x_{0}:T)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT : italic_T )</annotation></semantics></math>, known as the diffusion process, is a chain of Gaussian transitions starting at <math alttext="p(x_{T})" class="ltx_Math" display="inline" id="S3.SS2.p5.2.m2.1"><semantics id="S3.SS2.p5.2.m2.1a"><mrow id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">p</mi><mo id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p5.2.m2.1.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.p5.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p5.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p5.2.m2.1.1.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.1.1.1.2" xref="S3.SS2.p5.2.m2.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.p5.2.m2.1.1.1.1.1.3" xref="S3.SS2.p5.2.m2.1.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.SS2.p5.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p5.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><times id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2"></times><ci id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3">𝑝</ci><apply id="S3.SS2.p5.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p5.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">p(x_{T})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.2.m2.1d">italic_p ( italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT )</annotation></semantics></math> that iterates to <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.p5.3.m3.1"><semantics id="S3.SS2.p5.3.m3.1a"><mi id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><ci id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.3.m3.1d">italic_T</annotation></semantics></math> using <math alttext="p_{\theta}(x_{t-1}|x_{t})" class="ltx_Math" display="inline" id="S3.SS2.p5.4.m4.1"><semantics id="S3.SS2.p5.4.m4.1a"><mrow id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><msub id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.3.2.cmml">p</mi><mi id="S3.SS2.p5.4.m4.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p5.4.m4.1.1.1.1" xref="S3.SS2.p5.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS2.p5.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS2.p5.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p5.4.m4.1.1.1.1.1" xref="S3.SS2.p5.4.m4.1.1.1.1.1.cmml"><msub id="S3.SS2.p5.4.m4.1.1.1.1.1.2" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p5.4.m4.1.1.1.1.1.2.2" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.SS2.p5.4.m4.1.1.1.1.1.2.3" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.2" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.1" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.3" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.SS2.p5.4.m4.1.1.1.1.1.1" xref="S3.SS2.p5.4.m4.1.1.1.1.1.1.cmml">|</mo><msub id="S3.SS2.p5.4.m4.1.1.1.1.1.3" xref="S3.SS2.p5.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.1.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.1.1.1.3.2.cmml">x</mi><mi id="S3.SS2.p5.4.m4.1.1.1.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.SS2.p5.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS2.p5.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><times id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2"></times><apply id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.3.2">𝑝</ci><ci id="S3.SS2.p5.4.m4.1.1.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3">𝜃</ci></apply><apply id="S3.SS2.p5.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p5.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.p5.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.2">𝑥</ci><apply id="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.3"><minus id="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.1"></minus><ci id="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.SS2.p5.4.m4.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p5.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.SS2.p5.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">p_{\theta}(x_{t-1}|x_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> equation for each singular step. The variance in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S3.E4" title="In III-B Denoising Model/Reverse Process ‣ III Methodology ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">4</span></a> is time-dependent, but is not trainable. Rather than being set to a constant, it is equal to <math alttext="\beta_{T}I" class="ltx_Math" display="inline" id="S3.SS2.p5.5.m5.1"><semantics id="S3.SS2.p5.5.m5.1a"><mrow id="S3.SS2.p5.5.m5.1.1" xref="S3.SS2.p5.5.m5.1.1.cmml"><msub id="S3.SS2.p5.5.m5.1.1.2" xref="S3.SS2.p5.5.m5.1.1.2.cmml"><mi id="S3.SS2.p5.5.m5.1.1.2.2" xref="S3.SS2.p5.5.m5.1.1.2.2.cmml">β</mi><mi id="S3.SS2.p5.5.m5.1.1.2.3" xref="S3.SS2.p5.5.m5.1.1.2.3.cmml">T</mi></msub><mo id="S3.SS2.p5.5.m5.1.1.1" xref="S3.SS2.p5.5.m5.1.1.1.cmml">⁢</mo><mi id="S3.SS2.p5.5.m5.1.1.3" xref="S3.SS2.p5.5.m5.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m5.1b"><apply id="S3.SS2.p5.5.m5.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1"><times id="S3.SS2.p5.5.m5.1.1.1.cmml" xref="S3.SS2.p5.5.m5.1.1.1"></times><apply id="S3.SS2.p5.5.m5.1.1.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m5.1.1.2.1.cmml" xref="S3.SS2.p5.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.5.m5.1.1.2.2.cmml" xref="S3.SS2.p5.5.m5.1.1.2.2">𝛽</ci><ci id="S3.SS2.p5.5.m5.1.1.2.3.cmml" xref="S3.SS2.p5.5.m5.1.1.2.3">𝑇</ci></apply><ci id="S3.SS2.p5.5.m5.1.1.3.cmml" xref="S3.SS2.p5.5.m5.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m5.1c">\beta_{T}I</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.5.m5.1d">italic_β start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT italic_I</annotation></semantics></math> from the schedule described in the forward process. We refer readers to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib5" title="">5</a>]</cite> for details on mean estimation and other specific aspects. The output for a given timestep <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.p5.6.m6.1"><semantics id="S3.SS2.p5.6.m6.1a"><mi id="S3.SS2.p5.6.m6.1.1" xref="S3.SS2.p5.6.m6.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m6.1b"><ci id="S3.SS2.p5.6.m6.1.1.cmml" xref="S3.SS2.p5.6.m6.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m6.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.6.m6.1d">italic_t</annotation></semantics></math> is calculated by:</p>
</div>
<div class="ltx_para" id="S3.SS2.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="x_{t-1}=\frac{1}{\sqrt{\alpha t}}(x_{t}-\frac{\beta_{t}}{\sqrt{1-\bar{\alpha}}%
}\epsilon_{\theta}(x_{t},t))+\sqrt{\beta_{t}\epsilon}" class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><msub id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml"><mi id="S3.E5.m1.2.2.3.2" xref="S3.E5.m1.2.2.3.2.cmml">x</mi><mrow id="S3.E5.m1.2.2.3.3" xref="S3.E5.m1.2.2.3.3.cmml"><mi id="S3.E5.m1.2.2.3.3.2" xref="S3.E5.m1.2.2.3.3.2.cmml">t</mi><mo id="S3.E5.m1.2.2.3.3.1" xref="S3.E5.m1.2.2.3.3.1.cmml">−</mo><mn id="S3.E5.m1.2.2.3.3.3" xref="S3.E5.m1.2.2.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><mfrac id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml"><mn id="S3.E5.m1.2.2.1.1.3.2" xref="S3.E5.m1.2.2.1.1.3.2.cmml">1</mn><msqrt id="S3.E5.m1.2.2.1.1.3.3" xref="S3.E5.m1.2.2.1.1.3.3.cmml"><mrow id="S3.E5.m1.2.2.1.1.3.3.2" xref="S3.E5.m1.2.2.1.1.3.3.2.cmml"><mi id="S3.E5.m1.2.2.1.1.3.3.2.2" xref="S3.E5.m1.2.2.1.1.3.3.2.2.cmml">α</mi><mo id="S3.E5.m1.2.2.1.1.3.3.2.1" xref="S3.E5.m1.2.2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.1.3.3.2.3" xref="S3.E5.m1.2.2.1.1.3.3.2.3.cmml">t</mi></mrow></msqrt></mfrac><mo id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2.cmml">x</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><mfrac id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">β</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">t</mi></msub><msqrt id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.cmml"><mn id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.2.cmml">1</mn><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.1.cmml">−</mo><mover accent="true" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.cmml">α</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.1.cmml">¯</mo></mover></mrow></msqrt></mfrac><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.cmml">ϵ</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.4.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.3.cmml">θ</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.2a" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">t</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.2.cmml">+</mo><msqrt id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.2.2.1.3.cmml"><mrow id="S3.E5.m1.2.2.1.3.2" xref="S3.E5.m1.2.2.1.3.2.cmml"><msub id="S3.E5.m1.2.2.1.3.2.2" xref="S3.E5.m1.2.2.1.3.2.2.cmml"><mi id="S3.E5.m1.2.2.1.3.2.2.2" xref="S3.E5.m1.2.2.1.3.2.2.2.cmml">β</mi><mi id="S3.E5.m1.2.2.1.3.2.2.3" xref="S3.E5.m1.2.2.1.3.2.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.2.2.1.3.2.1" xref="S3.E5.m1.2.2.1.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.1.3.2.3" xref="S3.E5.m1.2.2.1.3.2.3.cmml">ϵ</mi></mrow></msqrt></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"></eq><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.3.2">𝑥</ci><apply id="S3.E5.m1.2.2.3.3.cmml" xref="S3.E5.m1.2.2.3.3"><minus id="S3.E5.m1.2.2.3.3.1.cmml" xref="S3.E5.m1.2.2.3.3.1"></minus><ci id="S3.E5.m1.2.2.3.3.2.cmml" xref="S3.E5.m1.2.2.3.3.2">𝑡</ci><cn id="S3.E5.m1.2.2.3.3.3.cmml" type="integer" xref="S3.E5.m1.2.2.3.3.3">1</cn></apply></apply><apply id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2.1"><plus id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.2"></plus><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1.1"><times id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3"><divide id="S3.E5.m1.2.2.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3"></divide><cn id="S3.E5.m1.2.2.1.1.3.2.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.3.2">1</cn><apply id="S3.E5.m1.2.2.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3"><root id="S3.E5.m1.2.2.1.1.3.3a.cmml" xref="S3.E5.m1.2.2.1.1.3.3"></root><apply id="S3.E5.m1.2.2.1.1.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.3.2"><times id="S3.E5.m1.2.2.1.1.3.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.3.3.2.1"></times><ci id="S3.E5.m1.2.2.1.1.3.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.3.3.2.2">𝛼</ci><ci id="S3.E5.m1.2.2.1.1.3.3.2.3.cmml" xref="S3.E5.m1.2.2.1.1.3.3.2.3">𝑡</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><minus id="S3.E5.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2"></minus><apply id="S3.E5.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2">𝑥</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3"><divide id="S3.E5.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3"></divide><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.2">𝛽</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3"><root id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3a.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3"></root><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2"><minus id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.1"></minus><cn id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.2.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.2">1</cn><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3"><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.1">¯</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.2.3.2">𝛼</ci></apply></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2">italic-ϵ</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.3">𝜃</ci></apply><interval closure="open" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑡</ci></interval></apply></apply></apply><apply id="S3.E5.m1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3"><root id="S3.E5.m1.2.2.1.3a.cmml" xref="S3.E5.m1.2.2.1.3"></root><apply id="S3.E5.m1.2.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.3.2"><times id="S3.E5.m1.2.2.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.3.2.1"></times><apply id="S3.E5.m1.2.2.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.2.2.1.cmml" xref="S3.E5.m1.2.2.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.3.2.2.2.cmml" xref="S3.E5.m1.2.2.1.3.2.2.2">𝛽</ci><ci id="S3.E5.m1.2.2.1.3.2.2.3.cmml" xref="S3.E5.m1.2.2.1.3.2.2.3">𝑡</ci></apply><ci id="S3.E5.m1.2.2.1.3.2.3.cmml" xref="S3.E5.m1.2.2.1.3.2.3">italic-ϵ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">x_{t-1}=\frac{1}{\sqrt{\alpha t}}(x_{t}-\frac{\beta_{t}}{\sqrt{1-\bar{\alpha}}%
}\epsilon_{\theta}(x_{t},t))+\sqrt{\beta_{t}\epsilon}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG square-root start_ARG italic_α italic_t end_ARG end_ARG ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT - divide start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG start_ARG square-root start_ARG 1 - over¯ start_ARG italic_α end_ARG end_ARG end_ARG italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) ) + square-root start_ARG italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_ϵ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p7">
<p class="ltx_p" id="S3.SS2.p7.1">where <math alttext="\epsilon_{\theta}(x_{t},t)" class="ltx_Math" display="inline" id="S3.SS2.p7.1.m1.2"><semantics id="S3.SS2.p7.1.m1.2a"><mrow id="S3.SS2.p7.1.m1.2.2" xref="S3.SS2.p7.1.m1.2.2.cmml"><msub id="S3.SS2.p7.1.m1.2.2.3" xref="S3.SS2.p7.1.m1.2.2.3.cmml"><mi id="S3.SS2.p7.1.m1.2.2.3.2" xref="S3.SS2.p7.1.m1.2.2.3.2.cmml">ϵ</mi><mi id="S3.SS2.p7.1.m1.2.2.3.3" xref="S3.SS2.p7.1.m1.2.2.3.3.cmml">θ</mi></msub><mo id="S3.SS2.p7.1.m1.2.2.2" xref="S3.SS2.p7.1.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.p7.1.m1.2.2.1.1" xref="S3.SS2.p7.1.m1.2.2.1.2.cmml"><mo id="S3.SS2.p7.1.m1.2.2.1.1.2" stretchy="false" xref="S3.SS2.p7.1.m1.2.2.1.2.cmml">(</mo><msub id="S3.SS2.p7.1.m1.2.2.1.1.1" xref="S3.SS2.p7.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p7.1.m1.2.2.1.1.1.2" xref="S3.SS2.p7.1.m1.2.2.1.1.1.2.cmml">x</mi><mi id="S3.SS2.p7.1.m1.2.2.1.1.1.3" xref="S3.SS2.p7.1.m1.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.p7.1.m1.2.2.1.1.3" xref="S3.SS2.p7.1.m1.2.2.1.2.cmml">,</mo><mi id="S3.SS2.p7.1.m1.1.1" xref="S3.SS2.p7.1.m1.1.1.cmml">t</mi><mo id="S3.SS2.p7.1.m1.2.2.1.1.4" stretchy="false" xref="S3.SS2.p7.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p7.1.m1.2b"><apply id="S3.SS2.p7.1.m1.2.2.cmml" xref="S3.SS2.p7.1.m1.2.2"><times id="S3.SS2.p7.1.m1.2.2.2.cmml" xref="S3.SS2.p7.1.m1.2.2.2"></times><apply id="S3.SS2.p7.1.m1.2.2.3.cmml" xref="S3.SS2.p7.1.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.2.2.3.1.cmml" xref="S3.SS2.p7.1.m1.2.2.3">subscript</csymbol><ci id="S3.SS2.p7.1.m1.2.2.3.2.cmml" xref="S3.SS2.p7.1.m1.2.2.3.2">italic-ϵ</ci><ci id="S3.SS2.p7.1.m1.2.2.3.3.cmml" xref="S3.SS2.p7.1.m1.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.SS2.p7.1.m1.2.2.1.2.cmml" xref="S3.SS2.p7.1.m1.2.2.1.1"><apply id="S3.SS2.p7.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p7.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p7.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p7.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p7.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p7.1.m1.2.2.1.1.1.2">𝑥</ci><ci id="S3.SS2.p7.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p7.1.m1.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.SS2.p7.1.m1.1.1.cmml" xref="S3.SS2.p7.1.m1.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p7.1.m1.2c">\epsilon_{\theta}(x_{t},t)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p7.1.m1.2d">italic_ϵ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math> is our model’s predicted noise. We simply use this to reverse the diffusion process iteratively using the predicted noise from our denoising model.</p>
</div>
<div class="ltx_para" id="S3.SS2.p8">
<p class="ltx_p" id="S3.SS2.p8.3">The original model architecture employed a straightforward pipeline where the input was passed through an embedding layer and then to an output layer. While this architecture was sufficient for their implementation, we introduced several modifications to enhance performance, particularly with the integration of classifier-free guidance. Firstly, the input to the model was revised to include an unnoised version of the data batch, which serves as guidance for conditioning. Previously, partially noised data acted as pseudo-guidance, but with the new approach, we require explicit external guidance. Therefore, the forward method now takes both the noisy batch of data and the corresponding unnoised batch (hereafter referred to as guidance). Additionally, a parameter, p_uncond, pertinent to classifier-free guidance, was introduced. This parameter represents the proportion of data where the gradients from the guidance will be zero, effectively enabling non-conditional prediction. In this paper, <math alttext="p\_uncond=0.2" class="ltx_Math" display="inline" id="S3.SS2.p8.1.m1.1"><semantics id="S3.SS2.p8.1.m1.1a"><mrow id="S3.SS2.p8.1.m1.1.1" xref="S3.SS2.p8.1.m1.1.1.cmml"><mrow id="S3.SS2.p8.1.m1.1.1.2" xref="S3.SS2.p8.1.m1.1.1.2.cmml"><mi id="S3.SS2.p8.1.m1.1.1.2.2" xref="S3.SS2.p8.1.m1.1.1.2.2.cmml">p</mi><mo id="S3.SS2.p8.1.m1.1.1.2.1" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.2.3" mathvariant="normal" xref="S3.SS2.p8.1.m1.1.1.2.3.cmml">_</mi><mo id="S3.SS2.p8.1.m1.1.1.2.1a" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.2.4" xref="S3.SS2.p8.1.m1.1.1.2.4.cmml">u</mi><mo id="S3.SS2.p8.1.m1.1.1.2.1b" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.2.5" xref="S3.SS2.p8.1.m1.1.1.2.5.cmml">n</mi><mo id="S3.SS2.p8.1.m1.1.1.2.1c" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.2.6" xref="S3.SS2.p8.1.m1.1.1.2.6.cmml">c</mi><mo id="S3.SS2.p8.1.m1.1.1.2.1d" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.2.7" xref="S3.SS2.p8.1.m1.1.1.2.7.cmml">o</mi><mo id="S3.SS2.p8.1.m1.1.1.2.1e" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.2.8" xref="S3.SS2.p8.1.m1.1.1.2.8.cmml">n</mi><mo id="S3.SS2.p8.1.m1.1.1.2.1f" xref="S3.SS2.p8.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S3.SS2.p8.1.m1.1.1.2.9" xref="S3.SS2.p8.1.m1.1.1.2.9.cmml">d</mi></mrow><mo id="S3.SS2.p8.1.m1.1.1.1" xref="S3.SS2.p8.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p8.1.m1.1.1.3" xref="S3.SS2.p8.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.1b"><apply id="S3.SS2.p8.1.m1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1"><eq id="S3.SS2.p8.1.m1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1.1"></eq><apply id="S3.SS2.p8.1.m1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2"><times id="S3.SS2.p8.1.m1.1.1.2.1.cmml" xref="S3.SS2.p8.1.m1.1.1.2.1"></times><ci id="S3.SS2.p8.1.m1.1.1.2.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2.2">𝑝</ci><ci id="S3.SS2.p8.1.m1.1.1.2.3.cmml" xref="S3.SS2.p8.1.m1.1.1.2.3">_</ci><ci id="S3.SS2.p8.1.m1.1.1.2.4.cmml" xref="S3.SS2.p8.1.m1.1.1.2.4">𝑢</ci><ci id="S3.SS2.p8.1.m1.1.1.2.5.cmml" xref="S3.SS2.p8.1.m1.1.1.2.5">𝑛</ci><ci id="S3.SS2.p8.1.m1.1.1.2.6.cmml" xref="S3.SS2.p8.1.m1.1.1.2.6">𝑐</ci><ci id="S3.SS2.p8.1.m1.1.1.2.7.cmml" xref="S3.SS2.p8.1.m1.1.1.2.7">𝑜</ci><ci id="S3.SS2.p8.1.m1.1.1.2.8.cmml" xref="S3.SS2.p8.1.m1.1.1.2.8">𝑛</ci><ci id="S3.SS2.p8.1.m1.1.1.2.9.cmml" xref="S3.SS2.p8.1.m1.1.1.2.9">𝑑</ci></apply><cn id="S3.SS2.p8.1.m1.1.1.3.cmml" type="float" xref="S3.SS2.p8.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.1c">p\_uncond=0.2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.1.m1.1d">italic_p _ italic_u italic_n italic_c italic_o italic_n italic_d = 0.2</annotation></semantics></math>, meaning that 20% of the guidance data will have zero gradients. The data is then normalized and concatenated with the noised data (<math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p8.2.m2.1"><semantics id="S3.SS2.p8.2.m2.1a"><mi id="S3.SS2.p8.2.m2.1.1" xref="S3.SS2.p8.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.2.m2.1b"><ci id="S3.SS2.p8.2.m2.1.1.cmml" xref="S3.SS2.p8.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.2.m2.1d">italic_x</annotation></semantics></math>). This process trains the denoising model to generate recommendations with and without guidance simultaneously, thereby enhancing the model’s capability, as supported by the principles of classifier-free guidance. Although there are various methods to condition the denoising model (e.g., attention mechanisms), we found that the simplest method, concatenation of the data and guidance, was the most effective. The embedding size from the original architecture was maintained, so the concatenated data is transformed to dimensions of (batch size <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS2.p8.3.m3.1"><semantics id="S3.SS2.p8.3.m3.1a"><mo id="S3.SS2.p8.3.m3.1.1" xref="S3.SS2.p8.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.3.m3.1b"><times id="S3.SS2.p8.3.m3.1.1.cmml" xref="S3.SS2.p8.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p8.3.m3.1d">×</annotation></semantics></math> embedding size). This transformed data is then run through a hyperbolic tangent activation function and subsequently through another linear layer to project it back to the dimensions corresponding to the number of items in the dataset. This process provides a heatmap of outputs for each item in the dataset. The model remains relatively lightweight, and the rationale behind this design choice will be elaborated upon in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S4.SS2" title="IV-B Experimental Configurations ‣ IV Experimental Setup ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span></span></a>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Experimental Setup</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we will discuss the specifics of the datasets used and how they pertain to our training and testing. We will also discuss the configuration of the experiments we ran when discovering the best method for personalizing recommendations through conditioning and finding the best denoising model architecture. Lastly, the actual results of our chosen architecture and method of guidance in comparison to the original implementation that we based ours upon, as well as the special use cases we have identified that our modified system excels in.
</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.4.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.5.2">Datasets</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We report results for three datasets: the MovieLens 1 Million dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib32" title="">32</a>]</cite>, the Yelp dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib34" title="">34</a>]</cite>, and several Amazon review datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#bib.bib33" title="">33</a>]</cite>. The inspiration paper specifies two training formats: clean and noisy. While our modifications were tested in both formats, all externally created datasets were limited to the clean format. No significant differences were observed between our modified implementation and the original method for either training format. Datasets statistics are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S4.T1" title="TABLE I ‣ IV-A Datasets ‣ IV Experimental Setup ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">I</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">For the MovieLens and Yelp datasets, noisy and clean settings are available. However, due to computational constraints, we only employed the MovieLens noisy configuration; the Yelp noisy dataset was excluded. Clean training involves using only ratings of 4 or 5; such ratings are considered “hits,” while ratings of 3 or below are deemed “misses.” Hits are represented as 1 in a vector of length <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">italic_N</annotation></semantics></math> (number of unique items), whereas misses and unrated items are labeled as 0.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1">The numeric ratings in the MovieLens 1 Million and Yelp datasets facilitate straightforward classification of hits and misses. In contrast, the Amazon datasets lack numeric ratings, leading us to consider all provided reviews as hits. Although this introduces some noise, it does not significantly affect the differences between our modifications and the original method.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Dataset Statistics</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.2.1">Users</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.3.1">Items</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.1">Total Reviews</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.2.2.1.1">ML-1M Clean</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.2">5949</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.3">2810</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.2.2.4">403,277</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.3.3.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.3.3.1.1">ML-1M Noisy</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.3.3.2">5949</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.3.3.3">3494</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.3.3.4">429,993</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.4.4.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.4.4.1.1">Yelp Clean</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.4.4.2">54,574</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.4.4.3">34,395</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.4.4.4">1,014,486</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.5.5.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.5.5.1.1">Amazon Kitchen</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.5.5.2">11,566</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.5.5.3">7,722</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.5.5.4">100,464</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.6.6.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.6.6.1.1">Amazon Beauty</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.6.6.2">3,782</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.6.6.3">2,658</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.6.6.4">38,867</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.7.7.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.7.7.1.1">Amazon Office</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.7.7.2">1,719</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.7.7.3">901</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.7.7.4">21,466</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.8.8.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.8.8.1.1">Amazon Toys</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.8.8.2">2,676</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.8.8.3">2,474</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.8.8.4">26,850</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S4.T1.1.9.9.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.9.9.1.1">Amazon VG</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.1.9.9.2">5,435</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.1.9.9.3">4,295</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S4.T1.1.9.9.4">60,497</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">The data was split with an 80:20 ratio for training and testing, or 70:20:10 for training, validation, and testing. The last segment of each sequence was reserved for testing. Datasets, primarily containing user ID, item ID, ratings (1-5), review time, and extraneous data, were preprocessed by discarding entries with ratings of 3 or below. Subsequently, the rating column was removed.</p>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1">For datasets without numeric ratings, all reviews were assumed positive, with allowances for minor noise. Data was sorted by user ID and review time, ensuring sequential interactions per user starting with the oldest. User and item IDs were renumbered from zero to maintain accurate counts post-cleaning.</p>
</div>
<div class="ltx_para" id="S4.SS1.p6">
<p class="ltx_p" id="S4.SS1.p6.1">The preprocessed data was then split into training, validation, and testing sets based on the specified ratios. Post-splitting, the data comprised sequential user interactions, facilitating model training and comparison of recommendations against the most recent user ratings.</p>
</div>
<div class="ltx_para" id="S4.SS1.p7">
<p class="ltx_p" id="S4.SS1.p7.1">The datasets are prepared for training by transforming the pre-runtime format into a more suitable structure. The initial format is inadequate for training since it does not differentiate users effectively, leading to a continuous flow of entries from one user to the next. To address this, we convert the data into a sparse format using <span class="ltx_text ltx_font_bold" id="S4.SS1.p7.1.1">multi-hot</span> vectors. Unlike one-hot vectors, which indicate a single hit among items for a specific user, multi-hot vectors represent all hits or interactions with multiple 1’s for each user.</p>
</div>
<div class="ltx_para" id="S4.SS1.p8">
<p class="ltx_p" id="S4.SS1.p8.1">This approach necessitates that the vector length corresponds to the total number of items in the dataset, ensuring accurate item representation. Although the model does not make recommendations based on an exact sequence, it leverages historical data to generate recommendations and uses future data for validation. By preparing the data in this manner, we ensure that the model can effectively differentiate between users and items, thereby facilitating more accurate recommendations.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.4.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.5.2">Experimental Configurations</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">In this section, we detail the experiments conducted to identify the best-performing recommender system, examining what was successful, what was not, and our reasoning behind these outcomes. Most experiments involved modifications either to the guidance provided to the denoising model or to the denoising model itself. We also conducted minor experiments to explore the potential of certain functionalities.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">One key experiment investigated making the recommendation model aware of the actual numeric ratings, rather than using binary signals (1’s and 0’s) to represent hits and misses. In this implementation, negative signals (ratings of 1-3) were introduced alongside positive signals (ratings of 4-5), distinguishing between disliked or unrated items. However, the resulting recommendations were subpar and not comparable to other results, leading us to abandon this approach. The reasons for this performance decline remain unclear.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">Through our experiments, we identified a general rule: <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.1.1">a significantly larger parameter count tends to reduce effectiveness</span>, likely due to overfitting during testing. Given the iterative nature of the denoising process, a large model was unnecessary for the incremental removal of noise from the data. Consequently, configurations with additional layers or increased neurons per layer did not perform well.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">We also experimented with attention mechanisms, including self-attention for the input sequence and cross-attentive conditioning from the guidance. Overall, the inclusion of attention did not yield the expected benefits, leading us to opt for a simpler concatenation method to incorporate guidance with input data. This may be attributed to the earlier rule that more parameters do not necessarily enhance performance, and attention mechanisms inherently add parameters.</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">Different embeddings for the guidance were tested with mixed success. Embeddings proved beneficial primarily with exceptionally large datasets, although they were slightly less effective than using raw data. However, embeddings demonstrated improved efficiency. Therefore, while raw data might be preferable for smaller datasets, embeddings are recommended for scaling the system to handle large datasets. The Yelp dataset, our largest, performed well without embeddings, suggesting that the raw data approach suffices for our current scope.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS3.4.1.1">IV-C</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS3.5.2">Evaluation</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">For all datasets, we saved the highest-performing model based on the nDCG@10 metric. For evaluation, we computed metrics at K = [1, 5, 10, 20], reflecting the practical importance for recommender systems to generate valuable recommendations within this range. We initially considered higher values but concluded that average users are unlikely to search through 50 or 100 recommendations.
All configurations were trained for varying durations depending on the dataset size but extended well beyond the point of reaching the best-performing results on the testing datasets.
</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Experimental Results</span>
</h2>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Testing Results. Org denotes original results. Values are in percentage.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="S5.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T2.1.1.1.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T2.1.1.1.2">ML-1M Clean</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T2.1.1.1.3">ML-1M Noisy</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T2.1.1.1.4">Yelp Clean</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.2.1">Original</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.2.2">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.2.3">Original</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.2.4">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.2.5">Original</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.2.2.6">Ours</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.3.3.1" rowspan="4"><span class="ltx_text" id="S5.T2.1.3.3.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T2.1.3.3.1.1.1">
<span class="ltx_tr" id="S5.T2.1.3.3.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.3.3.1.1.1.1.1">Precision</span></span>
<span class="ltx_tr" id="S5.T2.1.3.3.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.3.3.1.1.1.2.1">@</span></span>
<span class="ltx_tr" id="S5.T2.1.3.3.1.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.3.3.1.1.1.3.1">[1, 5, 10, 20]</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3.2">8.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.3.3.1">9.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3.4">2.99</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.3.5.1">4.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3.6">2.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.3.3.7"><span class="ltx_text ltx_font_bold" id="S5.T2.1.3.3.7.1">2.61</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.4.1">7.92</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.4.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.4.2.1">8.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.4.3">3.37</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.4.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.4.4.4.1">3.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.4.5">2.22</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.4.4.6">2.08</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.5.1">7.16</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.5.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.5.5.2.1">7.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.5.3">3.46</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.5.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.5.5.4.1">3.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.5.5">1.9</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.5.5.6">1.87</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.6.1">6.54</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.6.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.2.1">6.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.6.3">3.45</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.6.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.4.1">3.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.6.5">1.61</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.6.6.6"><span class="ltx_text ltx_font_bold" id="S5.T2.1.6.6.6.1">1.61</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.7.7.1" rowspan="4"><span class="ltx_text" id="S5.T2.1.7.7.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T2.1.7.7.1.1.1">
<span class="ltx_tr" id="S5.T2.1.7.7.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.7.7.1.1.1.1.1">Recall</span></span>
<span class="ltx_tr" id="S5.T2.1.7.7.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.7.7.1.1.1.2.1">@</span></span>
<span class="ltx_tr" id="S5.T2.1.7.7.1.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.7.7.1.1.1.3.1">[1, 5, 10, 20]</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.7.7.2">0.69</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.7.7.3.1">0.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.7.7.4">0.29</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.7.7.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.7.7.5.1">0.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.7.7.6">0.48</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.7.7.7"><span class="ltx_text ltx_font_bold" id="S5.T2.1.7.7.7.1">0.48</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.8.1">3.18</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.8.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.8.8.2.1">3.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.8.3">1.51</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.8.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.8.8.4.1">2.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.8.5">1.85</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.8.8.6">1.77</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.9.9.1">5.49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.9.9.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.9.9.2.1">6.6</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.9.9.3">3.04</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.9.9.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.9.9.4.1">3.7</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.9.9.5">3.12</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.9.9.6">3.11</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.10.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.10.10.1">9.72</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.10.10.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.10.10.2.1">11.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.10.10.3">5.55</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.10.10.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.10.10.4.1">6.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.10.10.5">5.14</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.10.10.6"><span class="ltx_text ltx_font_bold" id="S5.T2.1.10.10.6.1">5.19</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.11.11">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.11.11.1" rowspan="4"><span class="ltx_text" id="S5.T2.1.11.11.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T2.1.11.11.1.1.1">
<span class="ltx_tr" id="S5.T2.1.11.11.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.11.11.1.1.1.1.1">nDCG</span></span>
<span class="ltx_tr" id="S5.T2.1.11.11.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.11.11.1.1.1.2.1">@</span></span>
<span class="ltx_tr" id="S5.T2.1.11.11.1.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.11.11.1.1.1.3.1">[1, 5, 10, 20]</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.11.11.2">8.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.11.11.3.1">9.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.11.11.4">2.99</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.11.11.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.11.11.5.1">4.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.11.11.6">2.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.11.11.7">2.61</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.12.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.12.12.1">8.33</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.12.12.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.2.1">9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.12.12.3">3.49</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.12.12.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.12.12.4.1">4.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.12.12.5">2.67</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.12.12.6">2.53</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.13.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.13.13.1">8.43</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.13.13.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.13.13.2.1">9.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.13.13.3">3.97</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.13.13.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.13.13.4.1">4.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.13.13.5">2.94</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.13.13.6">2.88</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.14.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.14.14.1">9.44</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.14.14.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.14.14.2.1">10.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.14.14.3">4.83</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.14.14.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.14.14.4.1">5.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.14.14.5">3.56</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.14.14.6">3.53</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.15.15">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T2.1.15.15.1" rowspan="4"><span class="ltx_text" id="S5.T2.1.15.15.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T2.1.15.15.1.1.1">
<span class="ltx_tr" id="S5.T2.1.15.15.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.15.15.1.1.1.1.1">MRR</span></span>
<span class="ltx_tr" id="S5.T2.1.15.15.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.15.15.1.1.1.2.1">@</span></span>
<span class="ltx_tr" id="S5.T2.1.15.15.1.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.1.15.15.1.1.1.3.1">[1, 5, 10, 20]</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.15.15.2">8.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.15.15.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.15.15.3.1">9.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.15.15.4">2.99</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.15.15.5"><span class="ltx_text ltx_font_bold" id="S5.T2.1.15.15.5.1">4.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.15.15.6">2.8</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.1.15.15.7">2.61</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.16.16">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.16.16.1">15.41</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.16.16.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.16.16.2.1">16.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.16.16.3">6.78</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.16.16.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.16.16.4.1">8.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.16.16.5">5.29</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.16.16.6">4.94</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.17.17">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.17.17.1">17.06</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.17.17.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.17.17.2.1">18.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.17.17.3">8.34</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.17.17.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.17.17.4.1">9.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.17.17.5">6.04</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.1.17.17.6">5.77</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.18.18">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.1.18.18.1">18.15</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.1.18.18.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.18.18.2.1">19.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.1.18.18.3">9.38</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.1.18.18.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.18.18.4.1">10.9</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.1.18.18.5">6.62</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.1.18.18.6">6.35</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Results for Amazon dataset. Values are in percentage.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.1.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T3.1.1.1.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T3.1.1.1.2">Amazon Kitchen</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T3.1.1.1.3">Amazon Beauty</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T3.1.1.1.4">Amazon Toys</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T3.1.1.1.5">Amazon Office</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T3.1.1.1.6">Amazon VG</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.1">Original</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.2">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.3">Original</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.4">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.5">Original</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.6">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.7">Original</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.8">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.9">Original</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.2.2.10">Ours</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.1.3.3.1" rowspan="4"><span class="ltx_text" id="S5.T3.1.3.3.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.1.3.3.1.1.1">
<span class="ltx_tr" id="S5.T3.1.3.3.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.3.3.1.1.1.1.1">Precision</span></span>
<span class="ltx_tr" id="S5.T3.1.3.3.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.3.3.1.1.1.2.1">@</span></span>
<span class="ltx_tr" id="S5.T3.1.3.3.1.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.3.3.1.1.1.3.1">[1, 5, 10, 20]</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.2">0.35</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.3.3.1">0.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.4">0.93</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.5"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.3.5.1">1.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.6">1.12</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.7">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.8">0.29</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.9"><span class="ltx_text ltx_font_bold" id="S5.T3.1.3.3.9.1">0.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.10">1.47</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.3.3.11">1.29</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.1">0.21</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.4.2.1">0.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.3">0.87</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.4.4.1">0.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.5">0.45</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.6">0.30</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.7">0.35</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.4.8.1">0.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.9">0.90</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.4.4.10"><span class="ltx_text ltx_font_bold" id="S5.T3.1.4.4.10.1">1.09</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.1">0.14</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.5.2.1">0.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.3">0.83</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.4">0.81</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.5">0.32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.6">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.7">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.5.5.8.1">0.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.9">0.90</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.5.5.10">0.84</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.1">0.10</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.6.2.1">0.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.3">0.62</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.6.4.1">0.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.5">0.20</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.6"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.6.6.1">0.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.7">0.17</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.6.8.1">0.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.9">0.70</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.6.6.10"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.6.10.1">0.71</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.1.7.7.1" rowspan="4"><span class="ltx_text" id="S5.T3.1.7.7.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.1.7.7.1.1.1">
<span class="ltx_tr" id="S5.T3.1.7.7.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.7.7.1.1.1.1.1">Recall</span></span>
<span class="ltx_tr" id="S5.T3.1.7.7.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.7.7.1.1.1.2.1">@</span></span>
<span class="ltx_tr" id="S5.T3.1.7.7.1.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.7.7.1.1.1.3.1">[1, 5, 10, 20]</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.2">0.13</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.7.7.3.1">0.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.4">0.38</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.5"><span class="ltx_text ltx_font_bold" id="S5.T3.1.7.7.5.1">0.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.6">0.42</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.7"><span class="ltx_text ltx_font_bold" id="S5.T3.1.7.7.7.1">0.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.8">0.04</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.9"><span class="ltx_text ltx_font_bold" id="S5.T3.1.7.7.9.1">0.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.10">0.82</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.7.7.11">0.72</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.1">0.42</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.8.2.1">0.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.3">1.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.8.4.1">1.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.5">0.97</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.6">0.64</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.7">0.74</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.8">0.65</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.9">2.32</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.8.8.10"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.8.10.1">2.63</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.1">0.62</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.9.9.2.1">0.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.3">3.44</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.4">3.18</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.5">1.15</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.6"><span class="ltx_text ltx_font_bold" id="S5.T3.1.9.9.6.1">1.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.7">1.08</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.9.9.8.1">1.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.9">4.63</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.9.9.10">4.12</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.10.10">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.1">0.89</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.2">0.79</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.3">5.19</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.10.10.4.1">5.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.5">1.37</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.6"><span class="ltx_text ltx_font_bold" id="S5.T3.1.10.10.6.1">2.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.7">1.34</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.10.10.8.1">2.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.9">6.80</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.10.10.10"><span class="ltx_text ltx_font_bold" id="S5.T3.1.10.10.10.1">6.99</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.11.11">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.1.11.11.1" rowspan="4"><span class="ltx_text" id="S5.T3.1.11.11.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.1.11.11.1.1.1">
<span class="ltx_tr" id="S5.T3.1.11.11.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.11.11.1.1.1.1.1">nDCG</span></span>
<span class="ltx_tr" id="S5.T3.1.11.11.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.11.11.1.1.1.2.1">@</span></span>
<span class="ltx_tr" id="S5.T3.1.11.11.1.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.11.11.1.1.1.3.1">[1, 5, 10, 20]</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.2">0.35</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.11.11.3.1">0.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.4">0.93</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.5"><span class="ltx_text ltx_font_bold" id="S5.T3.1.11.11.5.1">1.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.6">1.12</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.7">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.8">0.29</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.9"><span class="ltx_text ltx_font_bold" id="S5.T3.1.11.11.9.1">0.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.10">1.47</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.11.11.11">1.29</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.12.12">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.1">0.35</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.12.12.2.1">0.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.3">1.37</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.4"><span class="ltx_text ltx_font_bold" id="S5.T3.1.12.12.4.1">1.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.5">0.94</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.6">0.65</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.7">0.61</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.12.12.8.1">0.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.9">1.94</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.12.12.10"><span class="ltx_text ltx_font_bold" id="S5.T3.1.12.12.10.1">2.03</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.13.13">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.1">0.41</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.13.13.2.1">0.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.3">2.05</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.4">1.92</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.5">0.98</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.6">0.89</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.7">0.72</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.13.13.8.1">1.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.9">2.75</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.13.13.10">2.54</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.14.14">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.1">0.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.14.14.2.1">0.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.3">2.58</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.4">2.57</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.5">1.04</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.6"><span class="ltx_text ltx_font_bold" id="S5.T3.1.14.14.6.1">1.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.7">0.82</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.14.14.8.1">1.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.9">3.40</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.14.14.10"><span class="ltx_text ltx_font_bold" id="S5.T3.1.14.14.10.1">3.49</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.15.15">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S5.T3.1.15.15.1" rowspan="4"><span class="ltx_text" id="S5.T3.1.15.15.1.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T3.1.15.15.1.1.1">
<span class="ltx_tr" id="S5.T3.1.15.15.1.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.15.15.1.1.1.1.1">MRR</span></span>
<span class="ltx_tr" id="S5.T3.1.15.15.1.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.15.15.1.1.1.2.1">@</span></span>
<span class="ltx_tr" id="S5.T3.1.15.15.1.1.1.3">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T3.1.15.15.1.1.1.3.1">[1, 5, 10, 20]</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.2">0.35</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.3"><span class="ltx_text ltx_font_bold" id="S5.T3.1.15.15.3.1">0.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.4">0.93</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.5"><span class="ltx_text ltx_font_bold" id="S5.T3.1.15.15.5.1">1.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.6">1.12</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.7">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.8">0.29</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.9"><span class="ltx_text ltx_font_bold" id="S5.T3.1.15.15.9.1">0.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.10">1.47</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.15.15.11">1.29</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.16.16">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.1">0.53</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.16.16.2.1">0.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.3">1.94</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.4">1.76</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.5">1.54</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.6">0.87</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.7">0.95</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.16.16.8.1">1.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.9">2.52</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.16.16.10"><span class="ltx_text ltx_font_bold" id="S5.T3.1.16.16.10.1">2.61</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.17.17">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.1">0.57</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.17.17.2.1">0.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.3">2.22</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.4">2.14</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.5">1.59</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.6">1.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.7">1.05</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.17.17.8.1">1.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.9">3.07</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.1.17.17.10">2.94</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.18.18">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.1">0.61</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.2"><span class="ltx_text ltx_font_bold" id="S5.T3.1.18.18.2.1">0.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.3">2.36</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.4">2.32</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.5">1.61</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.6">1.14</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.7">1.10</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.8"><span class="ltx_text ltx_font_bold" id="S5.T3.1.18.18.8.1">1.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.9">3.37</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T3.1.18.18.10">3.27</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Some of the results from our experiments yield intriguing insights into specific scenarios where our model excels, particularly when compared to other methods and the original implementation. The hyperparameter configuration remained the same as in the original work, except for the addition of the classifier-free guidance hyperparameter <math alttext="p\_uncond" class="ltx_Math" display="inline" id="S5.p1.1.m1.1"><semantics id="S5.p1.1.m1.1a"><mrow id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">p</mi><mo id="S5.p1.1.m1.1.1.1" xref="S5.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.p1.1.m1.1.1.3" mathvariant="normal" xref="S5.p1.1.m1.1.1.3.cmml">_</mi><mo id="S5.p1.1.m1.1.1.1a" xref="S5.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.p1.1.m1.1.1.4" xref="S5.p1.1.m1.1.1.4.cmml">u</mi><mo id="S5.p1.1.m1.1.1.1b" xref="S5.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.p1.1.m1.1.1.5" xref="S5.p1.1.m1.1.1.5.cmml">n</mi><mo id="S5.p1.1.m1.1.1.1c" xref="S5.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.p1.1.m1.1.1.6" xref="S5.p1.1.m1.1.1.6.cmml">c</mi><mo id="S5.p1.1.m1.1.1.1d" xref="S5.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.p1.1.m1.1.1.7" xref="S5.p1.1.m1.1.1.7.cmml">o</mi><mo id="S5.p1.1.m1.1.1.1e" xref="S5.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.p1.1.m1.1.1.8" xref="S5.p1.1.m1.1.1.8.cmml">n</mi><mo id="S5.p1.1.m1.1.1.1f" xref="S5.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.p1.1.m1.1.1.9" xref="S5.p1.1.m1.1.1.9.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><times id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1.1"></times><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">𝑝</ci><ci id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">_</ci><ci id="S5.p1.1.m1.1.1.4.cmml" xref="S5.p1.1.m1.1.1.4">𝑢</ci><ci id="S5.p1.1.m1.1.1.5.cmml" xref="S5.p1.1.m1.1.1.5">𝑛</ci><ci id="S5.p1.1.m1.1.1.6.cmml" xref="S5.p1.1.m1.1.1.6">𝑐</ci><ci id="S5.p1.1.m1.1.1.7.cmml" xref="S5.p1.1.m1.1.1.7">𝑜</ci><ci id="S5.p1.1.m1.1.1.8.cmml" xref="S5.p1.1.m1.1.1.8">𝑛</ci><ci id="S5.p1.1.m1.1.1.9.cmml" xref="S5.p1.1.m1.1.1.9">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">p\_uncond</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.1d">italic_p _ italic_u italic_n italic_c italic_o italic_n italic_d</annotation></semantics></math> set at 0.2. The results are shown in Tables <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S5.T2" title="TABLE II ‣ V Experimental Results ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">II</span></a> an <a class="ltx_ref" href="https://arxiv.org/html/2409.10494v1#S5.T3" title="TABLE III ‣ V Experimental Results ‣ Incorporating Classifier-Free Guidance in Diffusion Model-Based Recommendation"><span class="ltx_text ltx_ref_tag">III</span></a>, in which any bold value represents a score that either surpasses or ties with the other implementations.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Our system generally performs on par with, or better than, the original method across most scenarios. When our method is outperformed, the margin is typically small. Conversely, when our method outperforms the original, the margin is substantially larger, outperforming the original by more than 100% in some situations. This trend holds for nearly all scenarios, with only occasional outliers. One such outlier is the Yelp dataset with clean data. Our model fails to beat the original approach on this dataset systematically, we suspect that this is due to the method of applying guidance. For the majority of our datasets, a complex embedding to encapsulate the information of the guidance matrix is not needed, however, the Yelp dataset may be one such scenario as it is noticeably larger. The experimentation into an efficient embedding model for guidance fell out of the scope of this paper. Overall, our approach equals or surpasses the original implementation in 85 out of 128 categories across all datasets, indicating a clear improvement.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">We also believe that our recommendation system, enhanced by classifier-free guidance, could excel in few-shot and potentially zero-shot scenarios. This hypothesis is supported by the marked improvements observed in the Amazon Office dataset, which has a limited item count and thus offers less personalization. Generally, we found our model to work better in scenarios where either fewer items were offered for personalization or there were fewer reviews per user. Classifier-free guidance involves training without guidance for 20% of the samples, creating a scenario analogous to zero-shot learning, which might contribute to its effectiveness in this area and would explain its significant performance in comparison to the original method when less guiding data is available. Although we did not explore this aspect in-depth, our preliminary results suggest potential benefits in few-shot and zero-shot scenarios.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">Conclusion and Future Work</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This paper presents classifier-free guidance as a form of personalization and incorporates denoising in diffusion-based recommender frameworks. By restructuring the guidance mechanism by removing partially noised pseudo-guidance and incorporating true guidance through conditioning on pre-noise data, we demonstrated improvements in performance. The effectiveness of our method was evaluated using precision, recall, nDCG, and mean reciprocal rank @ K on held-out user data, revealing clear benefits over previous methods. Additionally, our approach showed potentially enhanced capabilities in few-shot and zero-shot recommendation scenarios.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Our major contributions include: (1) the implementation and evaluation of classifier-free guidance in diffusion-based recommendation tasks; (2) an in-depth discussion on the parameterization and architecture of the denoising model utilized in these tasks; and (3) insights into the applicability of diffusion models beyond the visual domain. Our findings indicate that classifier-free guidance improves performance in recommendation tasks similarly to its success in visual tasks. Additionally, we provide a framework that addresses challenges within diffusion-based recommendation systems while highlighting the newfound capabilities in few-shot and zero-shot scenarios.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">The potential for future work in this area is substantial. One promising direction involves improving the system by considering actual numerical ratings. While our initial attempt at this was inconclusive, a more sophisticated approach, potentially involving triplet loss to account for negative reviews, could yield better results. Cross-attentive conditioning, another feature that did not meet our performance expectations, might benefit from refined architectural innovations for improved guidance.</p>
</div>
<div class="ltx_para" id="S6.p4">
<p class="ltx_p" id="S6.p4.1">The use of transformers in the diffusion process is another avenue worth exploring. Recent advancements in image generation have shown that replacing the U-Net backbone with a Vision Transformer (ViT) can enhance denoising capabilities, and similar benefits might be realized in recommendation systems. Additionally, the few-shot and zero-shot capabilities of diffusion recommender systems trained with classifier-free guidance warrant further investigation. This aspect is particularly relevant for e-commerce, where new users with no interaction history present ongoing challenges.</p>
</div>
<div class="ltx_para" id="S6.p5">
<p class="ltx_p" id="S6.p5.1">In conclusion, our study lays the groundwork for advancing diffusion-based recommendation systems. By addressing the identified shortcomings and exploring the outlined directions for future research, we can further enhance these systems to meet the evolving needs of recommender applications.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"> E. Rich, “User modeling via stereotypes,” Cognitive Science, vol. 3, Issue 4, 1979.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"> J. Karlgren, “An Algebra for Recommendations,” 1990. [Online]. Available: https://jussikarlgren.wordpress.com/wp-content/uploads/1990/09/algebrawp.pdf

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"> D. Goldberg, D. Nichols, B. M. Oki, D. Terry, “Using collaborative filtering to weave an information tapestry,” Communications of the ACM, Volume 35, Issue 12, pp 61-70, 1992. [Online]. Availabile: https://doi.org/10.1145/138859.138867

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"> J. Sohl-Dickstein, E. A. Weiss, N. Maheswaranathan, S. Ganguli, “Deep Unsupervised Learning using Nonequilibrium Thermodynamics,” CoRR, 2015. [online]. Availabile: https://arxiv.org/abs/1503.03585

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"> J. Ho, A. Jain, P. Abbeel. “Denoising Diffusion Probabilistic Models,” CoRR, 2020. [Online]. Available: https://arxiv.org/abs/2006.11239

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"> P. Dhariwal, A. Nichol, “Diffusion Models Beat GANs on Image Synthesis,” CoRR, 2021. [Online]. Available: https://arxiv.org/abs/2105.05233

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"> J. Ho, et al., “Cascaded Diffusion Models for High Fidelity Image Generation,” CoRR, 2021. [Online]. Available: https://arxiv.org/abs/2106.15282

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"> C. Saharia, J. Ho, W. Chan, T. Salimans, D. J. Fleet, “Image Super-Resolution via Iterative Refinement,” IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 45, no. 4, pp. 4713-4726, 1 April, 2023. [Online]. Available: https://arxiv.org/abs/2104.07636

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"> R. Rombach, A. Blattmann, D. Lorenz, P. Esser, B. Ommer, “High-Resolution Image Synthesis with Latent Diffusion Models,” CoRR, 2022. [Online]. Available: https://arxiv.org/abs/2112.10752

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"> C. Saharia, W. Chan, S. Saxena, L. Li, J. Whang, E. Denton, S. Kamyar, S. Ghasemipour, B. K. Ayan, S. S. Mahdavi, R. G. Lopes, T. Salimans, J. Ho, D. J. Fleet, M. Norouzi, “Photorealistic Text-to-Image Diffusion Models with Deep Language Understanding,” NeurIPS, 2022. [Online]. Available: https://arxiv.org/abs/2205.11487

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"> A. Ramesh, P. Dhariwal, A. Nichol, C. Chu, “Hierarchical Text-Conditional Image Generation with CLIP Latents,” 2022. [Online]. Available: https://arxiv.org/abs/2204.06125

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"> J. Betker, et al., “Improving Image Generation with Better Captions,” 2023. [Online]. Available: https://arxiv.org/abs/2006.11807

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"> S. Gu, et al., “Vector Quantized Diffusion Model for Text-to-Image Synthesis,” CoRR, 2022. [Online]. Available: https://arxiv.org/abs/2111.14822

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"> Y. Li, et al., “SnapFusion: Text-to-Image Diffusion Model on Mobile Devices with Two Seconds,” NeurIPS, 2023. [Online]. Available: https://arxiv.org/abs/2306.00980

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"> W. Wang, et al., “Diffusion Recommender Model,” SIG IR, 2023. [Online]. Available: https://arxiv.org/abs/2304.04971

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"> Y. Wang, Z. Liu, L. Yang, P. S. Yu, “Conditional Denoising Diffusion for Sequential Recommendation,” 2023. [Online]. Available: https://arxiv.org/abs/2304.11433

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"> X. Lin, et al., “Discrete Conditional Diffusion for Reranking in Recommendation,” 2023. [Online]. Available: https://arxiv.org/abs/2308.06982

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"> Z. Li, A. Sun, C. Li, “DiffuRec: A Diffusion Model for Sequential Recommendation,” 2023. [Online]. Available: https://arxiv.org/abs/2304.00686

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"> T. Salimans, et al., “Improved Techniques for Training GANs,” CoRR, 2016. [Online]. Available: https://arxiv.org/abs/1606.03498

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"> P. Resnick, N. Lacovou, M. Suchak, P. Bergstrom, J. Riedl, “GroupLens: An Open Architecture for Collaborative Filtering of Netnews,” ACM, pp 175-186, 1994. [Online]. Available: https://dl.acm.org/doi/10.1145/192844.192905

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"> F. M. Harper, J. A. Konstan, “The MovieLens Datasets: History and Context,” ACM, Volume 5, Issue 4, Article No.: 19, pp 1-19, 2015. [Online]. Available: https://dl.acm.org/doi/10.1145/2827872

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"> Y. Koren, “Factorization meets the neighborhood: a multifaceted collaborative filtering model,” ACM, pp 426-434, 2008. [Online]. Available: https://dl.acm.org/doi/10.1145/1401890.1401944

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"> Y. Koren, “Collaborative filtering with temporal dynamics,” ACM, pp 447-456, 2010. [Online]. Available: https://dl.acm.org/doi/pdf/10.1145/1721654.1721677

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"> M. Richardson, E. Dominowska, R. Ragno, “Predicting clicks: estimating the click-through rate for new ads,” ACM, pp 521-530, 2007. [Online]. Available: https://dl.acm.org/doi/10.1145/1242572.1242643

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"> D. Liang, R. G. Krishnan, M. D. Hoffman, T. Jebara, “Variational Autoencoders for Collaborative Filtering,” 2018. [Online]. Available: https://arxiv.org/abs/1802.05814

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"> M. Gao, et al., “Recommender Systems Based on Generative Adversarial Networks: A Problem-Driven Perspective,” 2020. [Online]. Available: https://arxiv.org/pdf/2003.02474

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"> P. Covington, J. Adams, E. Sargin, “Deep Neural Networks for YouTube Recommendations,” ACM, pp 191-198, 2016. [Online]. Available: https://dl.acm.org/doi/10.1145/2959100.2959190

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"> D. P. Kingma, M. Welling, “Auto-Encoding Variational Bayes,” 2013. [Online]. Available: https://arxiv.org/abs/1312.6114

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"> M. M. Saad, R. O’Reilly, M. H. Rehmani, “A Survey on Training Challenges in Generative Adversarial Networks for Biomedical Image Analysis,” 2023. [Online]. Available: https://arxiv.org/abs/2201.07646

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"> S. Bond-Taylor, A. Leach, Y. Long, C. G. Willcocks, “Deep Generative Modeling: A Comparative Review of VAEs, GANs, Normalizing FLows, Energy0Based and Autoregressive Models,” CoRR, 2022. [Online]. Available: https://arxiv.org/abs/2103.04922

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"> I. J. Goodfellow, et al. “Generative Adversarial Nets,” NeurIPS, 2014. [Online]. Available: https://arxiv.org/abs/1406.2661

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"> F. Maxwell Harper, Joseph A. Konstan, ”The MovieLens Datasets: History
and Context,” ACM Transactions on Interactive Intelligent Systems (TiiS) 5, 4,
Article 19, 19 pages, 2015. [Online]. Available:http://dx.doi.org/10.1145/2827872 
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"> Yupeng Hou, et al., ”Bridging Language and Items for Retrieval and Recommendation,” arXiv, 2023. [Online]. Available: https://arxiv.org/pdf/2403.03952 
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"> Yelp, ”Yelp Open Dataset,” 2021. [Online]. Available: https://www.yelp.com/dataset 
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 16 16:29:33 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
