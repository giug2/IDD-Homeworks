<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2305.08328] FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning</title><meta property="og:description" content="Conversion rate (CVR) estimation aims to predict the probability of conversion event after a user has clicked an ad. Typically, online publisher has user browsing interests and click feedbacks, while demand-side advert…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2305.08328">

<!--Generated on Thu Feb 29 07:46:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Ad Ranking,  Vertical Federated Learning,  Deep Generative Model">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Penghui Wei
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id5.1.id1" class="ltx_text ltx_affiliation_institution">Alibaba Group</span><span id="id6.2.id2" class="ltx_text ltx_affiliation_city"></span><span id="id7.3.id3" class="ltx_text ltx_affiliation_country"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wph242967@alibaba-inc.com">wph242967@alibaba-inc.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hongjian Dou
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id8.1.id1" class="ltx_text ltx_affiliation_institution">Alibaba Group</span><span id="id9.2.id2" class="ltx_text ltx_affiliation_city"></span><span id="id10.3.id3" class="ltx_text ltx_affiliation_country"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:hongjian.dhj@alibaba-inc.com">hongjian.dhj@alibaba-inc.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shaoguo Liu<sup id="id11.2.id1" class="ltx_sup"><span id="id11.2.id1.1" class="ltx_text ltx_font_italic">∗</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id12.3.id1" class="ltx_text ltx_affiliation_institution">Alibaba Group</span><span id="id13.4.id2" class="ltx_text ltx_affiliation_city"></span><span id="id14.5.id3" class="ltx_text ltx_affiliation_country"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:shaoguo.lsg@alibaba-inc.com">shaoguo.lsg@alibaba-inc.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rongjun Tang<sup id="id15.2.id1" class="ltx_sup"><span id="id15.2.id1.1" class="ltx_text ltx_font_italic">†</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id16.3.id1" class="ltx_text ltx_affiliation_institution">The Chinese University of Hong Kong, Shenzhen</span><span id="id17.4.id2" class="ltx_text ltx_affiliation_city"></span><span id="id18.5.id3" class="ltx_text ltx_affiliation_country"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:rongjuntang@link.cuhk.edu.cn">rongjuntang@link.cuhk.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Li Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id19.1.id1" class="ltx_text ltx_affiliation_institution">The Thrust of Artificial Intelligence, The Hong Kong University of Science and Technology
(Guangzhou)</span><span id="id20.2.id2" class="ltx_text ltx_affiliation_city"></span><span id="id21.3.id3" class="ltx_text ltx_affiliation_country"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:avrillliu@hkust-gz.edu.cn">avrillliu@hkust-gz.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Liang Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id22.1.id1" class="ltx_text ltx_affiliation_institution">Alibaba Group</span><span id="id23.2.id2" class="ltx_text ltx_affiliation_city"></span><span id="id24.3.id3" class="ltx_text ltx_affiliation_country"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:liangbo.wl@alibaba-inc.com">liangbo.wl@alibaba-inc.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bo Zheng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id25.1.id1" class="ltx_text ltx_affiliation_institution">Alibaba Group</span><span id="id26.2.id2" class="ltx_text ltx_affiliation_city"></span><span id="id27.3.id3" class="ltx_text ltx_affiliation_country"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:bozheng@alibaba-inc.com">bozheng@alibaba-inc.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2023)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id28.id1" class="ltx_p">Conversion rate (CVR) estimation aims to predict the probability of conversion event after a user has clicked an ad. Typically, online publisher has user browsing interests and click feedbacks, while demand-side advertising platform collects users’ post-click behaviors such as dwell time and conversion decisions. To estimate CVR accurately and protect data privacy better, vertical federated learning (vFL) is a natural solution to combine two sides’ advantages for training models, without exchanging raw data. Both CVR estimation and applied vFL algorithms have attracted increasing research attentions. However, standardized and systematical evaluations are missing: due to the lack of standardized datasets, existing studies adopt public datasets to <span id="id28.id1.1" class="ltx_text ltx_font_italic">simulate</span> a vFL setting via hand-crafted feature partition, which brings challenges to fair comparison.
We introduce <span id="id28.id1.2" class="ltx_text ltx_font_sansserif">FedAds</span>, the first benchmark for CVR estimation with vFL, to facilitate standardized and systematical evaluations for vFL algorithms. It contains a large-scale real world dataset collected from Alibaba’s advertising platform, as well as systematical evaluations for both effectiveness and privacy aspects of various vFL algorithms. Besides, we also explore to incorporate unaligned data in vFL to improve effectiveness, and develop perturbation operations to protect privacy well. We hope that future research work in vFL and CVR estimation benefits from the <span id="id28.id1.3" class="ltx_text ltx_font_sansserif">FedAds</span> benchmark.</p>
</div>
<div class="ltx_keywords">Ad Ranking, Vertical Federated Learning, Deep Generative Model
</div>
<div class="ltx_acknowledgements">
<sup id="id29.id1" class="ltx_sup"><span id="id29.id1.1" class="ltx_text ltx_font_italic">†</span></sup>Work done during internship at Alibaba Group. <sup id="id30.id2" class="ltx_sup"><span id="id30.id2.1" class="ltx_text ltx_font_italic">∗</span></sup>Correspondence to: S. Liu.
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2023</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval; July 23–27, 2023; Taipei, Taiwan</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_booktitle"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval (SIGIR ’23), July 23–27, 2023, Taipei, Taiwan</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_price"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">price: </span>15.00</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3539618.3591909</span></span></span><span id="id7" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-9408-6/23/07</span></span></span><span id="id8" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Online advertising</span></span></span><span id="id9" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Neural networks</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Nowadays, more and more Web applications employ machine learning models to provide personalized services for users to meet their preferences.
Conversion rate (CVR) estimation is a foundational module in online recommendation and advertising systems, which aims to predict the probability of conversion event (e.g., purchase behavior in e-commerce ads) after a user has clicked an item/ad. It plays a crucial in candidate ranking and ad bidding strategies.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Figure <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (a) gives an illustration of user behaviors in online advertising. If a user browses an ad at the publisher page and then clicks on it, the user will arrive at an ad landing page. Follow-up behaviors including conversion decisions may happen. Therefore, the <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">online publisher</span> has user browsing interests and click feedbacks, and the demand-side <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">advertising platform</span> collects users’ post-click behaviors on ad pages such as dwell time and conversion. CVR estimation models are trained using collected data about user profiles, user behaviors and item/ad properties, with the goals of improving user experiences and increasing platform revenue. However due to the potential abuse and leak of user data, continued concerns regarding data privacy and security are raised.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">User behaviors collected by online publisher or advertising platform are private information and should be protected. To estimate CVR accurately and protect data privacy better, vertical federated learning (vFL) <cite class="ltx_cite ltx_citemacro_citep">(Vepakomma et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2018b</a>; Yang
et al<span class="ltx_text">.</span>, <a href="#bib.bib41" title="" class="ltx_ref">2019</a>)</cite> is a natural solution for model training, which combines two sides’ advantages without exchanging raw data. As a branch of federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite> techniques, vFL can collaboratively train a model using feature-partitioned data from multiple participants via exchanging <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">intermediate results</span> (e.g., hidden representations and gradients) rather than <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">raw data</span> (e.g., features and labels).
Figure <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (b) shows the vFL framework for training a neural network based CVR estimation model. There are two participants, where the <span id="S1.p3.1.3" class="ltx_text ltx_font_bold">non-label party</span> is online publisher and the <span id="S1.p3.1.4" class="ltx_text ltx_font_bold">label party</span> is advertising platform that owns conversion labels. The training data for vFL is <span id="S1.p3.1.5" class="ltx_text ltx_font_bold">feature-partitioned</span>: before model training, the two participants first perform private set intersection (PSI) <cite class="ltx_cite ltx_citemacro_citep">(Kolesnikov et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2016</a>)</cite> to obtain an aligned sample ID set, and each sample’s features come from both non-label party (e.g., behaviors on publisher page) and label party (e.g., behaviors on ad page).</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The whole model is split into two submodels owned by non-label and label parties respectively. During the <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">forward</span> pass, for a given input sample, the non-label party’s submodel sends a <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">hidden representation</span> to the label party. Then the label party combines such representation with its own one, and produces the predicted conversion probability and cross-entropy loss according to the sample’s conversion label. During the <span id="S1.p4.1.3" class="ltx_text ltx_font_italic">backward</span> propagation, the label party computes <span id="S1.p4.1.4" class="ltx_text ltx_font_italic">gradient</span> w.r.t. the non-label party’s hidden representation and sends it back, thus the update of non-label party’s submodel parameters depends on the label party.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<p id="S1.F1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S1.F1.1.1" class="ltx_text"><img src="/html/2305.08328/assets/x1.png" id="S1.F1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="235" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>(a) The feedback behaviors after a user browses an ad. (b) Vertical federated learning framework for training conversion rate estimation model. Online publisher and advertising platform provide the collected user feedback data and collaboratively train the model. </figcaption>
</figure>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Both CVR estimation <cite class="ltx_cite ltx_citemacro_citep">(Ma
et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2018</a>; Wei
et al<span class="ltx_text">.</span>, <a href="#bib.bib39" title="" class="ltx_ref">2021</a>; Guo et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2021</a>; Xu
et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite> and applied vFL algorithms <cite class="ltx_cite ltx_citemacro_citep">(Castiglia
et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">[n.d.]</a>; Kang
et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2022</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2022d</a>; He
et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2022</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2022c</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2022a</a>; Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2022</a>; Fu et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> have attracted increasing research attentions.
Specifically, to improve privacy-preserving CVR estimation, two research problems in vFL should be tackled.
The first is about <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">effectiveness</span>: Traditional vFL training procedure only employs <span id="S1.p5.1.2" class="ltx_text ltx_font_italic">aligned</span> samples among multiple participants, however the size of aligned samples is quite limited, which restricts the model performance. Various approaches based on self-supervised learning <cite class="ltx_cite ltx_citemacro_citep">(Castiglia
et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">[n.d.]</a>; He
et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite> and semi-supervised learning <cite class="ltx_cite ltx_citemacro_citep">(Kang
et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2022</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2022d</a>; Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2022c</a>)</cite> are proposed to explore the potential usage of a large amount of unaligned samples owned by each party for improving vFL.
The second is about <span id="S1.p5.1.3" class="ltx_text ltx_font_bold">privacy</span>: Although vFL only exchange intermediate results rather than raw features and labels, recent studies revealed that it still suffers from privacy leakage risks such as label inference attack, which means that a honest-but-curious non-label party can successfully infer private labels. To defend against such attack, many studies focus on random perturbation based approaches <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2022a</a>; Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2022</a>; Fu et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite> for protecting private label information.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">However, standardized datasets and systematical evaluations for vFL algorithms are missing: due to the lack of standardized datasets, existing studies usually adopt public datasets to <span id="S1.p6.1.1" class="ltx_text ltx_font_italic">simulate</span> a vFL experiment setting via hand-crafted feature partition, rather than adopting datasets from real-world vFL applications. This situation brings challenges to fair comparison of various models and hinders further research of vFL and privacy-preserving CVR estimation. As a result, above-mentioned vFL algorithms are not compared under the same dataset and evaluation procedure currently. Therefore, there is a great need for a comprehensive benchmark to facilitate vFL research.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">In this paper we introduce <span id="S1.p7.1.1" class="ltx_text ltx_font_sansserif">FedAds</span>, the first benchmark for privacy-preserving CVR estimation with vFL, to facilitate systematical evaluations for vFL algorithms. It contains 1) a large-scale real-world dataset from our online advertising platform, collected from an ad delivery business relying on vFL-based ranking models, as well as 2) systematical evaluations for both effectiveness and privacy aspects of various neural network based vFL algorithms through extensive experiments. Besides, to improve vFL effectiveness, we explore to incorporate unaligned data via generating unaligned samples’ feature representations using generative models. To protect privacy well, we also develop perturbation based on mixup and projection operations. We hope that future research work in both vFL algorithms and CVR estimation benefits from our <span id="S1.p7.1.2" class="ltx_text ltx_font_sansserif">FedAds</span> benchmark.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">The main contributions of this work are:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We provide a real-world CVR estimation dataset collected from our ad delivery business relying on vFL-based ranking models. To our knowledge, this is the first large-scale dataset for vFL research.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We conduct systematical evaluations to recently proposed vFL algorithms for effectiveness and privacy aspects respectively on the proposed dataset, which promotes fair comparison of various studies.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We propose two approaches for incorporating unaligned samples and protecting private label information in vFL respectively, and experiments on the proposed dataset verify their performance.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Preliminaries</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Conversion Rate Estimation</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.6" class="ltx_p">The goal of a post-click conversion rate (CVR) estimation model <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.2" xref="S2.SS1.p1.1.m1.1.2.cmml"><mi id="S2.SS1.p1.1.m1.1.2.2" xref="S2.SS1.p1.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.1.2.1" xref="S2.SS1.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.1.m1.1.2.3.2" xref="S2.SS1.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.1.m1.1.2.3.2.1" xref="S2.SS1.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS1.p1.1.m1.1.2.3.2.2" xref="S2.SS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.2"><times id="S2.SS1.p1.1.m1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.2.1"></times><ci id="S2.SS1.p1.1.m1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.2.2">𝑓</ci><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">f(\cdot)</annotation></semantics></math> is to produce the conversion probability if a user has clicked an ad: <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\hat{p}_{\mathrm{CVR}}=f(\bm{x})" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.2" xref="S2.SS1.p1.2.m2.1.2.cmml"><msub id="S2.SS1.p1.2.m2.1.2.2" xref="S2.SS1.p1.2.m2.1.2.2.cmml"><mover accent="true" id="S2.SS1.p1.2.m2.1.2.2.2" xref="S2.SS1.p1.2.m2.1.2.2.2.cmml"><mi id="S2.SS1.p1.2.m2.1.2.2.2.2" xref="S2.SS1.p1.2.m2.1.2.2.2.2.cmml">p</mi><mo id="S2.SS1.p1.2.m2.1.2.2.2.1" xref="S2.SS1.p1.2.m2.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.SS1.p1.2.m2.1.2.2.3" xref="S2.SS1.p1.2.m2.1.2.2.3.cmml">CVR</mi></msub><mo id="S2.SS1.p1.2.m2.1.2.1" xref="S2.SS1.p1.2.m2.1.2.1.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.1.2.3" xref="S2.SS1.p1.2.m2.1.2.3.cmml"><mi id="S2.SS1.p1.2.m2.1.2.3.2" xref="S2.SS1.p1.2.m2.1.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.2.m2.1.2.3.1" xref="S2.SS1.p1.2.m2.1.2.3.1.cmml">​</mo><mrow id="S2.SS1.p1.2.m2.1.2.3.3.2" xref="S2.SS1.p1.2.m2.1.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.1.2.3.3.2.1" xref="S2.SS1.p1.2.m2.1.2.3.cmml">(</mo><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.SS1.p1.2.m2.1.2.3.3.2.2" xref="S2.SS1.p1.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.2.cmml" xref="S2.SS1.p1.2.m2.1.2"><eq id="S2.SS1.p1.2.m2.1.2.1.cmml" xref="S2.SS1.p1.2.m2.1.2.1"></eq><apply id="S2.SS1.p1.2.m2.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.2.2.1.cmml" xref="S2.SS1.p1.2.m2.1.2.2">subscript</csymbol><apply id="S2.SS1.p1.2.m2.1.2.2.2.cmml" xref="S2.SS1.p1.2.m2.1.2.2.2"><ci id="S2.SS1.p1.2.m2.1.2.2.2.1.cmml" xref="S2.SS1.p1.2.m2.1.2.2.2.1">^</ci><ci id="S2.SS1.p1.2.m2.1.2.2.2.2.cmml" xref="S2.SS1.p1.2.m2.1.2.2.2.2">𝑝</ci></apply><ci id="S2.SS1.p1.2.m2.1.2.2.3.cmml" xref="S2.SS1.p1.2.m2.1.2.2.3">CVR</ci></apply><apply id="S2.SS1.p1.2.m2.1.2.3.cmml" xref="S2.SS1.p1.2.m2.1.2.3"><times id="S2.SS1.p1.2.m2.1.2.3.1.cmml" xref="S2.SS1.p1.2.m2.1.2.3.1"></times><ci id="S2.SS1.p1.2.m2.1.2.3.2.cmml" xref="S2.SS1.p1.2.m2.1.2.3.2">𝑓</ci><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝒙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\hat{p}_{\mathrm{CVR}}=f(\bm{x})</annotation></semantics></math>, where <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\bm{x}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">𝒙</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝒙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\bm{x}</annotation></semantics></math> denotes input feature of a sample. The model <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.2" xref="S2.SS1.p1.4.m4.1.2.cmml"><mi id="S2.SS1.p1.4.m4.1.2.2" xref="S2.SS1.p1.4.m4.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.1.2.1" xref="S2.SS1.p1.4.m4.1.2.1.cmml">​</mo><mrow id="S2.SS1.p1.4.m4.1.2.3.2" xref="S2.SS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.1.2.3.2.1" xref="S2.SS1.p1.4.m4.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS1.p1.4.m4.1.2.3.2.2" xref="S2.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.2.cmml" xref="S2.SS1.p1.4.m4.1.2"><times id="S2.SS1.p1.4.m4.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.2.1"></times><ci id="S2.SS1.p1.4.m4.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.2.2">𝑓</ci><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">f(\cdot)</annotation></semantics></math> is trained using click log <math id="S2.SS1.p1.5.m5.3" class="ltx_Math" alttext="\mathcal{D}=\left\{\left(\bm{x},y\right)\right\}" display="inline"><semantics id="S2.SS1.p1.5.m5.3a"><mrow id="S2.SS1.p1.5.m5.3.3" xref="S2.SS1.p1.5.m5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.5.m5.3.3.3" xref="S2.SS1.p1.5.m5.3.3.3.cmml">𝒟</mi><mo id="S2.SS1.p1.5.m5.3.3.2" xref="S2.SS1.p1.5.m5.3.3.2.cmml">=</mo><mrow id="S2.SS1.p1.5.m5.3.3.1.1" xref="S2.SS1.p1.5.m5.3.3.1.2.cmml"><mo id="S2.SS1.p1.5.m5.3.3.1.1.2" xref="S2.SS1.p1.5.m5.3.3.1.2.cmml">{</mo><mrow id="S2.SS1.p1.5.m5.3.3.1.1.1.2" xref="S2.SS1.p1.5.m5.3.3.1.1.1.1.cmml"><mo id="S2.SS1.p1.5.m5.3.3.1.1.1.2.1" xref="S2.SS1.p1.5.m5.3.3.1.1.1.1.cmml">(</mo><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">𝒙</mi><mo id="S2.SS1.p1.5.m5.3.3.1.1.1.2.2" xref="S2.SS1.p1.5.m5.3.3.1.1.1.1.cmml">,</mo><mi id="S2.SS1.p1.5.m5.2.2" xref="S2.SS1.p1.5.m5.2.2.cmml">y</mi><mo id="S2.SS1.p1.5.m5.3.3.1.1.1.2.3" xref="S2.SS1.p1.5.m5.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.SS1.p1.5.m5.3.3.1.1.3" xref="S2.SS1.p1.5.m5.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.3b"><apply id="S2.SS1.p1.5.m5.3.3.cmml" xref="S2.SS1.p1.5.m5.3.3"><eq id="S2.SS1.p1.5.m5.3.3.2.cmml" xref="S2.SS1.p1.5.m5.3.3.2"></eq><ci id="S2.SS1.p1.5.m5.3.3.3.cmml" xref="S2.SS1.p1.5.m5.3.3.3">𝒟</ci><set id="S2.SS1.p1.5.m5.3.3.1.2.cmml" xref="S2.SS1.p1.5.m5.3.3.1.1"><interval closure="open" id="S2.SS1.p1.5.m5.3.3.1.1.1.1.cmml" xref="S2.SS1.p1.5.m5.3.3.1.1.1.2"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝒙</ci><ci id="S2.SS1.p1.5.m5.2.2.cmml" xref="S2.SS1.p1.5.m5.2.2">𝑦</ci></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.3c">\mathcal{D}=\left\{\left(\bm{x},y\right)\right\}</annotation></semantics></math> with cross-entropy loss, where <math id="S2.SS1.p1.6.m6.2" class="ltx_Math" alttext="y\in\{0,1\}" display="inline"><semantics id="S2.SS1.p1.6.m6.2a"><mrow id="S2.SS1.p1.6.m6.2.3" xref="S2.SS1.p1.6.m6.2.3.cmml"><mi id="S2.SS1.p1.6.m6.2.3.2" xref="S2.SS1.p1.6.m6.2.3.2.cmml">y</mi><mo id="S2.SS1.p1.6.m6.2.3.1" xref="S2.SS1.p1.6.m6.2.3.1.cmml">∈</mo><mrow id="S2.SS1.p1.6.m6.2.3.3.2" xref="S2.SS1.p1.6.m6.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.6.m6.2.3.3.2.1" xref="S2.SS1.p1.6.m6.2.3.3.1.cmml">{</mo><mn id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">0</mn><mo id="S2.SS1.p1.6.m6.2.3.3.2.2" xref="S2.SS1.p1.6.m6.2.3.3.1.cmml">,</mo><mn id="S2.SS1.p1.6.m6.2.2" xref="S2.SS1.p1.6.m6.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS1.p1.6.m6.2.3.3.2.3" xref="S2.SS1.p1.6.m6.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.2b"><apply id="S2.SS1.p1.6.m6.2.3.cmml" xref="S2.SS1.p1.6.m6.2.3"><in id="S2.SS1.p1.6.m6.2.3.1.cmml" xref="S2.SS1.p1.6.m6.2.3.1"></in><ci id="S2.SS1.p1.6.m6.2.3.2.cmml" xref="S2.SS1.p1.6.m6.2.3.2">𝑦</ci><set id="S2.SS1.p1.6.m6.2.3.3.1.cmml" xref="S2.SS1.p1.6.m6.2.3.3.2"><cn type="integer" id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">0</cn><cn type="integer" id="S2.SS1.p1.6.m6.2.2.cmml" xref="S2.SS1.p1.6.m6.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.2c">y\in\{0,1\}</annotation></semantics></math> is the sample’s binary conversion label.
CVR estimation models are usually deployed to the ranking module of online advertising and recommendation systems, and they are crucial for improving user experiences, satisfying advertiser demands and increasing the revenue of advertising platform.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Vertical Federated Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">We first give a brief introduction to two-party vFL framework, and then discuss the issues in traditional vFL.</p>
</div>
<section id="S2.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1. </span><span id="S2.SS2.SSS1.1.1" class="ltx_text ltx_font_bold">Two-Party vFL</span>
</h4>

<div id="S2.SS2.SSS1.p1" class="ltx_para">
<p id="S2.SS2.SSS1.p1.5" class="ltx_p">We consider the overall framework in <a href="#S1.F1" title="In 1. Introduction ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a> (b). Without loss of generality, we assume that there are two separate participants, namely non-label party and label party. They cooperate with each other to learn a model <math id="S2.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="f:\mathcal{X}\rightarrow\mathcal{Y}" display="inline"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mrow id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.1.m1.1.1.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml">f</mi><mo lspace="0.278em" rspace="0.278em" id="S2.SS2.SSS1.p1.1.m1.1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S2.SS2.SSS1.p1.1.m1.1.1.3" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.1.m1.1.1.3.2" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.2.cmml">𝒳</mi><mo stretchy="false" id="S2.SS2.SSS1.p1.1.m1.1.1.3.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.1.m1.1.1.3.3" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.3.cmml">𝒴</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><apply id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.1">:</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.2">𝑓</ci><apply id="S2.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.1">→</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.2">𝒳</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.3.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">f:\mathcal{X}\rightarrow\mathcal{Y}</annotation></semantics></math>.
The feature space
<math id="S2.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{X}=\mathcal{X}_{\mathrm{N}}\cup\mathcal{X}_{\mathrm{L}}" display="inline"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><mrow id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.2.m2.1.1.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.2.cmml">𝒳</mi><mo id="S2.SS2.SSS1.p1.2.m2.1.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S2.SS2.SSS1.p1.2.m2.1.1.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.cmml"><msub id="S2.SS2.SSS1.p1.2.m2.1.1.3.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.2.m2.1.1.3.2.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.2.2.cmml">𝒳</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p1.2.m2.1.1.3.2.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.2.3.cmml">N</mi></msub><mo id="S2.SS2.SSS1.p1.2.m2.1.1.3.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.1.cmml">∪</mo><msub id="S2.SS2.SSS1.p1.2.m2.1.1.3.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.2.m2.1.1.3.3.2" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.3.2.cmml">𝒳</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p1.2.m2.1.1.3.3.3" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.3.3.cmml">L</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><apply id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1"><eq id="S2.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.1"></eq><ci id="S2.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.2">𝒳</ci><apply id="S2.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3"><union id="S2.SS2.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.1"></union><apply id="S2.SS2.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m2.1.1.3.2.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m2.1.1.3.2.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.2.2">𝒳</ci><ci id="S2.SS2.SSS1.p1.2.m2.1.1.3.2.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.2.3">N</ci></apply><apply id="S2.SS2.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.2.m2.1.1.3.3.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.2.m2.1.1.3.3.2.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.3.2">𝒳</ci><ci id="S2.SS2.SSS1.p1.2.m2.1.1.3.3.3.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1.3.3.3">L</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">\mathcal{X}=\mathcal{X}_{\mathrm{N}}\cup\mathcal{X}_{\mathrm{L}}</annotation></semantics></math> is composed of two parts, where <math id="S2.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{X}_{\mathrm{N}}" display="inline"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><msub id="S2.SS2.SSS1.p1.3.m3.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.3.m3.1.1.2" xref="S2.SS2.SSS1.p1.3.m3.1.1.2.cmml">𝒳</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p1.3.m3.1.1.3" xref="S2.SS2.SSS1.p1.3.m3.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><apply id="S2.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1.2">𝒳</ci><ci id="S2.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">\mathcal{X}_{\mathrm{N}}</annotation></semantics></math> / <math id="S2.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{X}_{\mathrm{L}}" display="inline"><semantics id="S2.SS2.SSS1.p1.4.m4.1a"><msub id="S2.SS2.SSS1.p1.4.m4.1.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.4.m4.1.1.2" xref="S2.SS2.SSS1.p1.4.m4.1.1.2.cmml">𝒳</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p1.4.m4.1.1.3" xref="S2.SS2.SSS1.p1.4.m4.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m4.1b"><apply id="S2.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.2">𝒳</ci><ci id="S2.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.3">L</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m4.1c">\mathcal{X}_{\mathrm{L}}</annotation></semantics></math> represents the feature subspace owned by <span id="S2.SS2.SSS1.p1.5.1" class="ltx_text ltx_framed ltx_framed_underline">N</span>on-label party / <span id="S2.SS2.SSS1.p1.5.2" class="ltx_text ltx_framed ltx_framed_underline">L</span>abel party.
The label party owns the one-hot label space <math id="S2.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S2.SS2.SSS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.5.m5.1.1" xref="S2.SS2.SSS1.p1.5.m5.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.5.m5.1b"><ci id="S2.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.5.m5.1c">\mathcal{Y}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.SSS1.p2" class="ltx_para">
<p id="S2.SS2.SSS1.p2.3" class="ltx_p">The whole model <math id="S2.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p2.1.m1.1a"><mrow id="S2.SS2.SSS1.p2.1.m1.1.2" xref="S2.SS2.SSS1.p2.1.m1.1.2.cmml"><mi id="S2.SS2.SSS1.p2.1.m1.1.2.2" xref="S2.SS2.SSS1.p2.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.1.m1.1.2.1" xref="S2.SS2.SSS1.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p2.1.m1.1.2.3.2" xref="S2.SS2.SSS1.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p2.1.m1.1.2.3.2.1" xref="S2.SS2.SSS1.p2.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.1.m1.1.1" xref="S2.SS2.SSS1.p2.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p2.1.m1.1.2.3.2.2" xref="S2.SS2.SSS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.1.m1.1b"><apply id="S2.SS2.SSS1.p2.1.m1.1.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.2"><times id="S2.SS2.SSS1.p2.1.m1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.2.1"></times><ci id="S2.SS2.SSS1.p2.1.m1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.1.m1.1c">f(\cdot)</annotation></semantics></math> is split into two submodels <math id="S2.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="f_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p2.2.m2.1a"><mrow id="S2.SS2.SSS1.p2.2.m2.1.2" xref="S2.SS2.SSS1.p2.2.m2.1.2.cmml"><msub id="S2.SS2.SSS1.p2.2.m2.1.2.2" xref="S2.SS2.SSS1.p2.2.m2.1.2.2.cmml"><mi id="S2.SS2.SSS1.p2.2.m2.1.2.2.2" xref="S2.SS2.SSS1.p2.2.m2.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p2.2.m2.1.2.2.3" xref="S2.SS2.SSS1.p2.2.m2.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.2.m2.1.2.1" xref="S2.SS2.SSS1.p2.2.m2.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p2.2.m2.1.2.3.2" xref="S2.SS2.SSS1.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p2.2.m2.1.2.3.2.1" xref="S2.SS2.SSS1.p2.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.2.m2.1.1" xref="S2.SS2.SSS1.p2.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p2.2.m2.1.2.3.2.2" xref="S2.SS2.SSS1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.2.m2.1b"><apply id="S2.SS2.SSS1.p2.2.m2.1.2.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.2"><times id="S2.SS2.SSS1.p2.2.m2.1.2.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.2.1"></times><apply id="S2.SS2.SSS1.p2.2.m2.1.2.2.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.2.m2.1.2.2.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p2.2.m2.1.2.2.2.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p2.2.m2.1.2.2.3.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.2.2.3">N</ci></apply><ci id="S2.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.2.m2.1c">f_{\mathrm{N}}(\cdot)</annotation></semantics></math> and <math id="S2.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="f_{\mathrm{L}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p2.3.m3.1a"><mrow id="S2.SS2.SSS1.p2.3.m3.1.2" xref="S2.SS2.SSS1.p2.3.m3.1.2.cmml"><msub id="S2.SS2.SSS1.p2.3.m3.1.2.2" xref="S2.SS2.SSS1.p2.3.m3.1.2.2.cmml"><mi id="S2.SS2.SSS1.p2.3.m3.1.2.2.2" xref="S2.SS2.SSS1.p2.3.m3.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p2.3.m3.1.2.2.3" xref="S2.SS2.SSS1.p2.3.m3.1.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.3.m3.1.2.1" xref="S2.SS2.SSS1.p2.3.m3.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p2.3.m3.1.2.3.2" xref="S2.SS2.SSS1.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p2.3.m3.1.2.3.2.1" xref="S2.SS2.SSS1.p2.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.3.m3.1.1" xref="S2.SS2.SSS1.p2.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p2.3.m3.1.2.3.2.2" xref="S2.SS2.SSS1.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.3.m3.1b"><apply id="S2.SS2.SSS1.p2.3.m3.1.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.2"><times id="S2.SS2.SSS1.p2.3.m3.1.2.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.2.1"></times><apply id="S2.SS2.SSS1.p2.3.m3.1.2.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.3.m3.1.2.2.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p2.3.m3.1.2.2.2.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p2.3.m3.1.2.2.3.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.2.2.3">L</ci></apply><ci id="S2.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p2.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.3.m3.1c">f_{\mathrm{L}}(\cdot)</annotation></semantics></math> which are owned by non-label party and label-party respectively:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.1" class="ltx_Math" alttext="f\coloneqq f_{\mathrm{N}}\circ f_{\mathrm{L}}\,," display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">f</mi><mo id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml">≔</mo><mrow id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><msub id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.1.3.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.E1.m1.1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.1.3.2.3.cmml">N</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.E1.m1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.3.1.cmml">∘</mo><msub id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.3.3.2.cmml">f</mi><mi mathvariant="normal" id="S2.E1.m1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.3.3.3.cmml">L</mi></msub></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><ci id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1">≔</ci><ci id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2">𝑓</ci><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><compose id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.1"></compose><apply id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2.2">𝑓</ci><ci id="S2.E1.m1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.3.2.3">N</ci></apply><apply id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.3.2">𝑓</ci><ci id="S2.E1.m1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3.3">L</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">f\coloneqq f_{\mathrm{N}}\circ f_{\mathrm{L}}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS1.p2.5" class="ltx_p">here <math id="S2.SS2.SSS1.p2.4.m1.1" class="ltx_Math" alttext="f_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p2.4.m1.1a"><mrow id="S2.SS2.SSS1.p2.4.m1.1.2" xref="S2.SS2.SSS1.p2.4.m1.1.2.cmml"><msub id="S2.SS2.SSS1.p2.4.m1.1.2.2" xref="S2.SS2.SSS1.p2.4.m1.1.2.2.cmml"><mi id="S2.SS2.SSS1.p2.4.m1.1.2.2.2" xref="S2.SS2.SSS1.p2.4.m1.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p2.4.m1.1.2.2.3" xref="S2.SS2.SSS1.p2.4.m1.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.4.m1.1.2.1" xref="S2.SS2.SSS1.p2.4.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p2.4.m1.1.2.3.2" xref="S2.SS2.SSS1.p2.4.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p2.4.m1.1.2.3.2.1" xref="S2.SS2.SSS1.p2.4.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.4.m1.1.1" xref="S2.SS2.SSS1.p2.4.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p2.4.m1.1.2.3.2.2" xref="S2.SS2.SSS1.p2.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.4.m1.1b"><apply id="S2.SS2.SSS1.p2.4.m1.1.2.cmml" xref="S2.SS2.SSS1.p2.4.m1.1.2"><times id="S2.SS2.SSS1.p2.4.m1.1.2.1.cmml" xref="S2.SS2.SSS1.p2.4.m1.1.2.1"></times><apply id="S2.SS2.SSS1.p2.4.m1.1.2.2.cmml" xref="S2.SS2.SSS1.p2.4.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.4.m1.1.2.2.1.cmml" xref="S2.SS2.SSS1.p2.4.m1.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p2.4.m1.1.2.2.2.cmml" xref="S2.SS2.SSS1.p2.4.m1.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p2.4.m1.1.2.2.3.cmml" xref="S2.SS2.SSS1.p2.4.m1.1.2.2.3">N</ci></apply><ci id="S2.SS2.SSS1.p2.4.m1.1.1.cmml" xref="S2.SS2.SSS1.p2.4.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.4.m1.1c">f_{\mathrm{N}}(\cdot)</annotation></semantics></math> is the non-label party’s submodel which produces hidden representation for each sample and sends it to label party,
while <math id="S2.SS2.SSS1.p2.5.m2.1" class="ltx_Math" alttext="f_{\mathrm{L}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p2.5.m2.1a"><mrow id="S2.SS2.SSS1.p2.5.m2.1.2" xref="S2.SS2.SSS1.p2.5.m2.1.2.cmml"><msub id="S2.SS2.SSS1.p2.5.m2.1.2.2" xref="S2.SS2.SSS1.p2.5.m2.1.2.2.cmml"><mi id="S2.SS2.SSS1.p2.5.m2.1.2.2.2" xref="S2.SS2.SSS1.p2.5.m2.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p2.5.m2.1.2.2.3" xref="S2.SS2.SSS1.p2.5.m2.1.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.5.m2.1.2.1" xref="S2.SS2.SSS1.p2.5.m2.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p2.5.m2.1.2.3.2" xref="S2.SS2.SSS1.p2.5.m2.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p2.5.m2.1.2.3.2.1" xref="S2.SS2.SSS1.p2.5.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p2.5.m2.1.1" xref="S2.SS2.SSS1.p2.5.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p2.5.m2.1.2.3.2.2" xref="S2.SS2.SSS1.p2.5.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p2.5.m2.1b"><apply id="S2.SS2.SSS1.p2.5.m2.1.2.cmml" xref="S2.SS2.SSS1.p2.5.m2.1.2"><times id="S2.SS2.SSS1.p2.5.m2.1.2.1.cmml" xref="S2.SS2.SSS1.p2.5.m2.1.2.1"></times><apply id="S2.SS2.SSS1.p2.5.m2.1.2.2.cmml" xref="S2.SS2.SSS1.p2.5.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p2.5.m2.1.2.2.1.cmml" xref="S2.SS2.SSS1.p2.5.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p2.5.m2.1.2.2.2.cmml" xref="S2.SS2.SSS1.p2.5.m2.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p2.5.m2.1.2.2.3.cmml" xref="S2.SS2.SSS1.p2.5.m2.1.2.2.3">L</ci></apply><ci id="S2.SS2.SSS1.p2.5.m2.1.1.cmml" xref="S2.SS2.SSS1.p2.5.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p2.5.m2.1c">f_{\mathrm{L}}(\cdot)</annotation></semantics></math> is the label party’s submodel that produces the predicted probability distribution.</p>
</div>
<div id="S2.SS2.SSS1.p3" class="ltx_para">
<p id="S2.SS2.SSS1.p3.7" class="ltx_p">Before model training, the two parties first perform PSI to obtain an <span id="S2.SS2.SSS1.p3.7.1" class="ltx_text ltx_font_bold">aligned</span> sample set <math id="S2.SS2.SSS1.p3.1.m1.2" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}=\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\}" display="inline"><semantics id="S2.SS2.SSS1.p3.1.m1.2a"><mrow id="S2.SS2.SSS1.p3.1.m1.2.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.cmml"><msub id="S2.SS2.SSS1.p3.1.m1.2.2.3" xref="S2.SS2.SSS1.p3.1.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p3.1.m1.2.2.3.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.3.2.cmml">𝒟</mi><mi id="S2.SS2.SSS1.p3.1.m1.2.2.3.3" xref="S2.SS2.SSS1.p3.1.m1.2.2.3.3.cmml">aligned</mi></msub><mo id="S2.SS2.SSS1.p3.1.m1.2.2.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.2.cmml">=</mo><mrow id="S2.SS2.SSS1.p3.1.m1.2.2.1.1" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.2.cmml">{</mo><mrow id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.3" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.3.cmml">(</mo><msub id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.3" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.3.cmml">N</mi></msub><mo id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.4" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.3.cmml">,</mo><msub id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.cmml"><mi id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.2" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.3" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.3.cmml">L</mi></msub><mo id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.5" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.3.cmml">,</mo><mi id="S2.SS2.SSS1.p3.1.m1.1.1" xref="S2.SS2.SSS1.p3.1.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.6" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.3" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.1.m1.2b"><apply id="S2.SS2.SSS1.p3.1.m1.2.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2"><eq id="S2.SS2.SSS1.p3.1.m1.2.2.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.2"></eq><apply id="S2.SS2.SSS1.p3.1.m1.2.2.3.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.1.m1.2.2.3.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.3">subscript</csymbol><ci id="S2.SS2.SSS1.p3.1.m1.2.2.3.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.3.2">𝒟</ci><ci id="S2.SS2.SSS1.p3.1.m1.2.2.3.3.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.3.3">aligned</ci></apply><set id="S2.SS2.SSS1.p3.1.m1.2.2.1.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1"><vector id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2"><apply id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.1.1.3">N</ci></apply><apply id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.2">𝒙</ci><ci id="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.3.cmml" xref="S2.SS2.SSS1.p3.1.m1.2.2.1.1.1.2.2.3">L</ci></apply><ci id="S2.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.1.m1.1.1">𝒚</ci></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.1.m1.2c">\mathcal{D}_{\mathrm{aligned}}=\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\}</annotation></semantics></math>,
where <math id="S2.SS2.SSS1.p3.2.m2.1" class="ltx_Math" alttext="\bm{x}_{\mathrm{N}}" display="inline"><semantics id="S2.SS2.SSS1.p3.2.m2.1a"><msub id="S2.SS2.SSS1.p3.2.m2.1.1" xref="S2.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p3.2.m2.1.1.2" xref="S2.SS2.SSS1.p3.2.m2.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.2.m2.1.1.3" xref="S2.SS2.SSS1.p3.2.m2.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.2.m2.1b"><apply id="S2.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.2">𝒙</ci><ci id="S2.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p3.2.m2.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.2.m2.1c">\bm{x}_{\mathrm{N}}</annotation></semantics></math> and <math id="S2.SS2.SSS1.p3.3.m3.1" class="ltx_Math" alttext="\bm{x}_{\mathrm{L}}" display="inline"><semantics id="S2.SS2.SSS1.p3.3.m3.1a"><msub id="S2.SS2.SSS1.p3.3.m3.1.1" xref="S2.SS2.SSS1.p3.3.m3.1.1.cmml"><mi id="S2.SS2.SSS1.p3.3.m3.1.1.2" xref="S2.SS2.SSS1.p3.3.m3.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.3.m3.1.1.3" xref="S2.SS2.SSS1.p3.3.m3.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.3.m3.1b"><apply id="S2.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.3.m3.1.1.1.cmml" xref="S2.SS2.SSS1.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p3.3.m3.1.1.2.cmml" xref="S2.SS2.SSS1.p3.3.m3.1.1.2">𝒙</ci><ci id="S2.SS2.SSS1.p3.3.m3.1.1.3.cmml" xref="S2.SS2.SSS1.p3.3.m3.1.1.3">L</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.3.m3.1c">\bm{x}_{\mathrm{L}}</annotation></semantics></math> denote the sample’s feature provided by two parties respectively, and its label <math id="S2.SS2.SSS1.p3.4.m4.1" class="ltx_Math" alttext="\bm{y}" display="inline"><semantics id="S2.SS2.SSS1.p3.4.m4.1a"><mi id="S2.SS2.SSS1.p3.4.m4.1.1" xref="S2.SS2.SSS1.p3.4.m4.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.4.m4.1b"><ci id="S2.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p3.4.m4.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.4.m4.1c">\bm{y}</annotation></semantics></math> is a one-hot vector.
Consider the forward pass, for each sample the model <math id="S2.SS2.SSS1.p3.5.m5.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p3.5.m5.1a"><mrow id="S2.SS2.SSS1.p3.5.m5.1.2" xref="S2.SS2.SSS1.p3.5.m5.1.2.cmml"><mi id="S2.SS2.SSS1.p3.5.m5.1.2.2" xref="S2.SS2.SSS1.p3.5.m5.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.5.m5.1.2.1" xref="S2.SS2.SSS1.p3.5.m5.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p3.5.m5.1.2.3.2" xref="S2.SS2.SSS1.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.5.m5.1.2.3.2.1" xref="S2.SS2.SSS1.p3.5.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.5.m5.1.1" xref="S2.SS2.SSS1.p3.5.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p3.5.m5.1.2.3.2.2" xref="S2.SS2.SSS1.p3.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.5.m5.1b"><apply id="S2.SS2.SSS1.p3.5.m5.1.2.cmml" xref="S2.SS2.SSS1.p3.5.m5.1.2"><times id="S2.SS2.SSS1.p3.5.m5.1.2.1.cmml" xref="S2.SS2.SSS1.p3.5.m5.1.2.1"></times><ci id="S2.SS2.SSS1.p3.5.m5.1.2.2.cmml" xref="S2.SS2.SSS1.p3.5.m5.1.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p3.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p3.5.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.5.m5.1c">f(\cdot)</annotation></semantics></math> outputs the predicted distribution <math id="S2.SS2.SSS1.p3.6.m6.1" class="ltx_Math" alttext="\hat{\bm{y}}" display="inline"><semantics id="S2.SS2.SSS1.p3.6.m6.1a"><mover accent="true" id="S2.SS2.SSS1.p3.6.m6.1.1" xref="S2.SS2.SSS1.p3.6.m6.1.1.cmml"><mi id="S2.SS2.SSS1.p3.6.m6.1.1.2" xref="S2.SS2.SSS1.p3.6.m6.1.1.2.cmml">𝒚</mi><mo id="S2.SS2.SSS1.p3.6.m6.1.1.1" xref="S2.SS2.SSS1.p3.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.6.m6.1b"><apply id="S2.SS2.SSS1.p3.6.m6.1.1.cmml" xref="S2.SS2.SSS1.p3.6.m6.1.1"><ci id="S2.SS2.SSS1.p3.6.m6.1.1.1.cmml" xref="S2.SS2.SSS1.p3.6.m6.1.1.1">^</ci><ci id="S2.SS2.SSS1.p3.6.m6.1.1.2.cmml" xref="S2.SS2.SSS1.p3.6.m6.1.1.2">𝒚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.6.m6.1c">\hat{\bm{y}}</annotation></semantics></math>, and then computes the cross-entropy loss <math id="S2.SS2.SSS1.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.SS2.SSS1.p3.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p3.7.m7.1.1" xref="S2.SS2.SSS1.p3.7.m7.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.7.m7.1b"><ci id="S2.SS2.SSS1.p3.7.m7.1.1.cmml" xref="S2.SS2.SSS1.p3.7.m7.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.7.m7.1c">\mathcal{L}</annotation></semantics></math>:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.3" class="ltx_Math" alttext="\bm{h}_{\mathrm{N}}=f_{\mathrm{N}}(\bm{x}_{\mathrm{N}})\,,\quad\bm{h}_{\mathrm{L}}=f_{\mathrm{L}}^{(\mathrm{b})}(\bm{x}_{\mathrm{L}})" display="block"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.2" xref="S2.E2.m1.3.3.3.cmml"><mrow id="S2.E2.m1.2.2.1.1" xref="S2.E2.m1.2.2.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.3" xref="S2.E2.m1.2.2.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.3.2" xref="S2.E2.m1.2.2.1.1.3.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.E2.m1.2.2.1.1.3.3" xref="S2.E2.m1.2.2.1.1.3.3.cmml">N</mi></msub><mo id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.2.2.1.1.1" xref="S2.E2.m1.2.2.1.1.1.cmml"><msub id="S2.E2.m1.2.2.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.3.2" xref="S2.E2.m1.2.2.1.1.1.3.2.cmml">f</mi><mi mathvariant="normal" id="S2.E2.m1.2.2.1.1.1.3.3" xref="S2.E2.m1.2.2.1.1.1.3.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.2.2.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.2.2.1.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S2.E2.m1.2.2.1.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml">N</mi></msub><mo rspace="0.170em" stretchy="false" id="S2.E2.m1.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S2.E2.m1.3.3.2.3" xref="S2.E2.m1.3.3.3a.cmml">,</mo><mrow id="S2.E2.m1.3.3.2.2" xref="S2.E2.m1.3.3.2.2.cmml"><msub id="S2.E2.m1.3.3.2.2.3" xref="S2.E2.m1.3.3.2.2.3.cmml"><mi id="S2.E2.m1.3.3.2.2.3.2" xref="S2.E2.m1.3.3.2.2.3.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.E2.m1.3.3.2.2.3.3" xref="S2.E2.m1.3.3.2.2.3.3.cmml">L</mi></msub><mo id="S2.E2.m1.3.3.2.2.2" xref="S2.E2.m1.3.3.2.2.2.cmml">=</mo><mrow id="S2.E2.m1.3.3.2.2.1" xref="S2.E2.m1.3.3.2.2.1.cmml"><msubsup id="S2.E2.m1.3.3.2.2.1.3" xref="S2.E2.m1.3.3.2.2.1.3.cmml"><mi id="S2.E2.m1.3.3.2.2.1.3.2.2" xref="S2.E2.m1.3.3.2.2.1.3.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.E2.m1.3.3.2.2.1.3.2.3" xref="S2.E2.m1.3.3.2.2.1.3.2.3.cmml">L</mi><mrow id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.3.3.2.2.1.3.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.3.1" xref="S2.E2.m1.3.3.2.2.1.3.cmml">(</mo><mi mathvariant="normal" id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">b</mi><mo stretchy="false" id="S2.E2.m1.1.1.1.3.2" xref="S2.E2.m1.3.3.2.2.1.3.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.E2.m1.3.3.2.2.1.2" xref="S2.E2.m1.3.3.2.2.1.2.cmml">​</mo><mrow id="S2.E2.m1.3.3.2.2.1.1.1" xref="S2.E2.m1.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.3.3.2.2.1.1.1.2" xref="S2.E2.m1.3.3.2.2.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.3.3.2.2.1.1.1.1" xref="S2.E2.m1.3.3.2.2.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.2.2.1.1.1.1.2" xref="S2.E2.m1.3.3.2.2.1.1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S2.E2.m1.3.3.2.2.1.1.1.1.3" xref="S2.E2.m1.3.3.2.2.1.1.1.1.3.cmml">L</mi></msub><mo stretchy="false" id="S2.E2.m1.3.3.2.2.1.1.1.3" xref="S2.E2.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.3.cmml" xref="S2.E2.m1.3.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.3a.cmml" xref="S2.E2.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.2.2.1.1.cmml" xref="S2.E2.m1.2.2.1.1"><eq id="S2.E2.m1.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.2"></eq><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.3.2">𝒉</ci><ci id="S2.E2.m1.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.3.3">N</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1"><times id="S2.E2.m1.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.2"></times><apply id="S2.E2.m1.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.3.2">𝑓</ci><ci id="S2.E2.m1.2.2.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.3.3">N</ci></apply><apply id="S2.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1.1.3">N</ci></apply></apply></apply><apply id="S2.E2.m1.3.3.2.2.cmml" xref="S2.E2.m1.3.3.2.2"><eq id="S2.E2.m1.3.3.2.2.2.cmml" xref="S2.E2.m1.3.3.2.2.2"></eq><apply id="S2.E2.m1.3.3.2.2.3.cmml" xref="S2.E2.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.3.1.cmml" xref="S2.E2.m1.3.3.2.2.3">subscript</csymbol><ci id="S2.E2.m1.3.3.2.2.3.2.cmml" xref="S2.E2.m1.3.3.2.2.3.2">𝒉</ci><ci id="S2.E2.m1.3.3.2.2.3.3.cmml" xref="S2.E2.m1.3.3.2.2.3.3">L</ci></apply><apply id="S2.E2.m1.3.3.2.2.1.cmml" xref="S2.E2.m1.3.3.2.2.1"><times id="S2.E2.m1.3.3.2.2.1.2.cmml" xref="S2.E2.m1.3.3.2.2.1.2"></times><apply id="S2.E2.m1.3.3.2.2.1.3.cmml" xref="S2.E2.m1.3.3.2.2.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.1.3.1.cmml" xref="S2.E2.m1.3.3.2.2.1.3">superscript</csymbol><apply id="S2.E2.m1.3.3.2.2.1.3.2.cmml" xref="S2.E2.m1.3.3.2.2.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.1.3.2.1.cmml" xref="S2.E2.m1.3.3.2.2.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.2.2.1.3.2.2.cmml" xref="S2.E2.m1.3.3.2.2.1.3.2.2">𝑓</ci><ci id="S2.E2.m1.3.3.2.2.1.3.2.3.cmml" xref="S2.E2.m1.3.3.2.2.1.3.2.3">L</ci></apply><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">b</ci></apply><apply id="S2.E2.m1.3.3.2.2.1.1.1.1.cmml" xref="S2.E2.m1.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.2.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.2.2.1.1.1.1.2">𝒙</ci><ci id="S2.E2.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.3.3.2.2.1.1.1.1.3">L</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\bm{h}_{\mathrm{N}}=f_{\mathrm{N}}(\bm{x}_{\mathrm{N}})\,,\quad\bm{h}_{\mathrm{L}}=f_{\mathrm{L}}^{(\mathrm{b})}(\bm{x}_{\mathrm{L}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.4" class="ltx_Math" alttext="\bm{l}=f_{\mathrm{L}}^{(\mathrm{t})}\bigl{(}\bm{h}_{\mathrm{N}},\bm{h}_{\mathrm{L}}\bigr{)}\,,\quad\hat{\bm{y}}=\mathrm{softmax}(\bm{l})" display="block"><semantics id="S2.E3.m1.4a"><mrow id="S2.E3.m1.4.4.2" xref="S2.E3.m1.4.4.3.cmml"><mrow id="S2.E3.m1.3.3.1.1" xref="S2.E3.m1.3.3.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.4" xref="S2.E3.m1.3.3.1.1.4.cmml">𝒍</mi><mo id="S2.E3.m1.3.3.1.1.3" xref="S2.E3.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E3.m1.3.3.1.1.2" xref="S2.E3.m1.3.3.1.1.2.cmml"><msubsup id="S2.E3.m1.3.3.1.1.2.4" xref="S2.E3.m1.3.3.1.1.2.4.cmml"><mi id="S2.E3.m1.3.3.1.1.2.4.2.2" xref="S2.E3.m1.3.3.1.1.2.4.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.E3.m1.3.3.1.1.2.4.2.3" xref="S2.E3.m1.3.3.1.1.2.4.2.3.cmml">L</mi><mrow id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.2.4.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.3.1" xref="S2.E3.m1.3.3.1.1.2.4.cmml">(</mo><mi mathvariant="normal" id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S2.E3.m1.1.1.1.3.2" xref="S2.E3.m1.3.3.1.1.2.4.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.E3.m1.3.3.1.1.2.3" xref="S2.E3.m1.3.3.1.1.2.3.cmml">​</mo><mrow id="S2.E3.m1.3.3.1.1.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml"><mo maxsize="120%" minsize="120%" id="S2.E3.m1.3.3.1.1.2.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml">(</mo><msub id="S2.E3.m1.3.3.1.1.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1.1.1.2" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.E3.m1.3.3.1.1.1.1.1.1.3" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml">N</mi></msub><mo id="S2.E3.m1.3.3.1.1.2.2.2.4" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml">,</mo><msub id="S2.E3.m1.3.3.1.1.2.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S2.E3.m1.3.3.1.1.2.2.2.2.2" xref="S2.E3.m1.3.3.1.1.2.2.2.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.E3.m1.3.3.1.1.2.2.2.2.3" xref="S2.E3.m1.3.3.1.1.2.2.2.2.3.cmml">L</mi></msub><mo maxsize="120%" minsize="120%" rspace="0.170em" id="S2.E3.m1.3.3.1.1.2.2.2.5" xref="S2.E3.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S2.E3.m1.4.4.2.3" xref="S2.E3.m1.4.4.3a.cmml">,</mo><mrow id="S2.E3.m1.4.4.2.2" xref="S2.E3.m1.4.4.2.2.cmml"><mover accent="true" id="S2.E3.m1.4.4.2.2.2" xref="S2.E3.m1.4.4.2.2.2.cmml"><mi id="S2.E3.m1.4.4.2.2.2.2" xref="S2.E3.m1.4.4.2.2.2.2.cmml">𝒚</mi><mo id="S2.E3.m1.4.4.2.2.2.1" xref="S2.E3.m1.4.4.2.2.2.1.cmml">^</mo></mover><mo id="S2.E3.m1.4.4.2.2.1" xref="S2.E3.m1.4.4.2.2.1.cmml">=</mo><mrow id="S2.E3.m1.4.4.2.2.3" xref="S2.E3.m1.4.4.2.2.3.cmml"><mi id="S2.E3.m1.4.4.2.2.3.2" xref="S2.E3.m1.4.4.2.2.3.2.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.2.2.3.1" xref="S2.E3.m1.4.4.2.2.3.1.cmml">​</mo><mrow id="S2.E3.m1.4.4.2.2.3.3.2" xref="S2.E3.m1.4.4.2.2.3.cmml"><mo stretchy="false" id="S2.E3.m1.4.4.2.2.3.3.2.1" xref="S2.E3.m1.4.4.2.2.3.cmml">(</mo><mi id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml">𝒍</mi><mo stretchy="false" id="S2.E3.m1.4.4.2.2.3.3.2.2" xref="S2.E3.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.4b"><apply id="S2.E3.m1.4.4.3.cmml" xref="S2.E3.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.3a.cmml" xref="S2.E3.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S2.E3.m1.3.3.1.1.cmml" xref="S2.E3.m1.3.3.1.1"><eq id="S2.E3.m1.3.3.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.3"></eq><ci id="S2.E3.m1.3.3.1.1.4.cmml" xref="S2.E3.m1.3.3.1.1.4">𝒍</ci><apply id="S2.E3.m1.3.3.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.2"><times id="S2.E3.m1.3.3.1.1.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.3"></times><apply id="S2.E3.m1.3.3.1.1.2.4.cmml" xref="S2.E3.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.4.1.cmml" xref="S2.E3.m1.3.3.1.1.2.4">superscript</csymbol><apply id="S2.E3.m1.3.3.1.1.2.4.2.cmml" xref="S2.E3.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.4.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.4">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.4.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.4.2.2">𝑓</ci><ci id="S2.E3.m1.3.3.1.1.2.4.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.4.2.3">L</ci></apply><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">t</ci></apply><interval closure="open" id="S2.E3.m1.3.3.1.1.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2"><apply id="S2.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.2">𝒉</ci><ci id="S2.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.3.3.1.1.1.1.1.1.3">N</ci></apply><apply id="S2.E3.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.2">𝒉</ci><ci id="S2.E3.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S2.E3.m1.3.3.1.1.2.2.2.2.3">L</ci></apply></interval></apply></apply><apply id="S2.E3.m1.4.4.2.2.cmml" xref="S2.E3.m1.4.4.2.2"><eq id="S2.E3.m1.4.4.2.2.1.cmml" xref="S2.E3.m1.4.4.2.2.1"></eq><apply id="S2.E3.m1.4.4.2.2.2.cmml" xref="S2.E3.m1.4.4.2.2.2"><ci id="S2.E3.m1.4.4.2.2.2.1.cmml" xref="S2.E3.m1.4.4.2.2.2.1">^</ci><ci id="S2.E3.m1.4.4.2.2.2.2.cmml" xref="S2.E3.m1.4.4.2.2.2.2">𝒚</ci></apply><apply id="S2.E3.m1.4.4.2.2.3.cmml" xref="S2.E3.m1.4.4.2.2.3"><times id="S2.E3.m1.4.4.2.2.3.1.cmml" xref="S2.E3.m1.4.4.2.2.3.1"></times><ci id="S2.E3.m1.4.4.2.2.3.2.cmml" xref="S2.E3.m1.4.4.2.2.3.2">softmax</ci><ci id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2">𝒍</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.4c">\bm{l}=f_{\mathrm{L}}^{(\mathrm{t})}\bigl{(}\bm{h}_{\mathrm{N}},\bm{h}_{\mathrm{L}}\bigr{)}\,,\quad\hat{\bm{y}}=\mathrm{softmax}(\bm{l})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.1" class="ltx_Math" alttext="\mathcal{L}=-\bm{y}^{\top}\log\hat{\bm{y}}" display="block"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.2" xref="S2.E4.m1.1.1.2.cmml">ℒ</mi><mo id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.cmml">=</mo><mrow id="S2.E4.m1.1.1.3" xref="S2.E4.m1.1.1.3.cmml"><mo id="S2.E4.m1.1.1.3a" xref="S2.E4.m1.1.1.3.cmml">−</mo><mrow id="S2.E4.m1.1.1.3.2" xref="S2.E4.m1.1.1.3.2.cmml"><msup id="S2.E4.m1.1.1.3.2.2" xref="S2.E4.m1.1.1.3.2.2.cmml"><mi id="S2.E4.m1.1.1.3.2.2.2" xref="S2.E4.m1.1.1.3.2.2.2.cmml">𝒚</mi><mo id="S2.E4.m1.1.1.3.2.2.3" xref="S2.E4.m1.1.1.3.2.2.3.cmml">⊤</mo></msup><mo lspace="0.167em" rspace="0em" id="S2.E4.m1.1.1.3.2.1" xref="S2.E4.m1.1.1.3.2.1.cmml">​</mo><mrow id="S2.E4.m1.1.1.3.2.3" xref="S2.E4.m1.1.1.3.2.3.cmml"><mi id="S2.E4.m1.1.1.3.2.3.1" xref="S2.E4.m1.1.1.3.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E4.m1.1.1.3.2.3a" xref="S2.E4.m1.1.1.3.2.3.cmml">⁡</mo><mover accent="true" id="S2.E4.m1.1.1.3.2.3.2" xref="S2.E4.m1.1.1.3.2.3.2.cmml"><mi id="S2.E4.m1.1.1.3.2.3.2.2" xref="S2.E4.m1.1.1.3.2.3.2.2.cmml">𝒚</mi><mo id="S2.E4.m1.1.1.3.2.3.2.1" xref="S2.E4.m1.1.1.3.2.3.2.1.cmml">^</mo></mover></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1"><eq id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"></eq><ci id="S2.E4.m1.1.1.2.cmml" xref="S2.E4.m1.1.1.2">ℒ</ci><apply id="S2.E4.m1.1.1.3.cmml" xref="S2.E4.m1.1.1.3"><minus id="S2.E4.m1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.3"></minus><apply id="S2.E4.m1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.3.2"><times id="S2.E4.m1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.3.2.1"></times><apply id="S2.E4.m1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.3.2.2.1.cmml" xref="S2.E4.m1.1.1.3.2.2">superscript</csymbol><ci id="S2.E4.m1.1.1.3.2.2.2.cmml" xref="S2.E4.m1.1.1.3.2.2.2">𝒚</ci><csymbol cd="latexml" id="S2.E4.m1.1.1.3.2.2.3.cmml" xref="S2.E4.m1.1.1.3.2.2.3">top</csymbol></apply><apply id="S2.E4.m1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.3.2.3"><log id="S2.E4.m1.1.1.3.2.3.1.cmml" xref="S2.E4.m1.1.1.3.2.3.1"></log><apply id="S2.E4.m1.1.1.3.2.3.2.cmml" xref="S2.E4.m1.1.1.3.2.3.2"><ci id="S2.E4.m1.1.1.3.2.3.2.1.cmml" xref="S2.E4.m1.1.1.3.2.3.2.1">^</ci><ci id="S2.E4.m1.1.1.3.2.3.2.2.cmml" xref="S2.E4.m1.1.1.3.2.3.2.2">𝒚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\mathcal{L}=-\bm{y}^{\top}\log\hat{\bm{y}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS1.p3.12" class="ltx_p">where <math id="S2.SS2.SSS1.p3.8.m1.1" class="ltx_Math" alttext="\bm{h}_{\mathrm{N}}" display="inline"><semantics id="S2.SS2.SSS1.p3.8.m1.1a"><msub id="S2.SS2.SSS1.p3.8.m1.1.1" xref="S2.SS2.SSS1.p3.8.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p3.8.m1.1.1.2" xref="S2.SS2.SSS1.p3.8.m1.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.8.m1.1.1.3" xref="S2.SS2.SSS1.p3.8.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.8.m1.1b"><apply id="S2.SS2.SSS1.p3.8.m1.1.1.cmml" xref="S2.SS2.SSS1.p3.8.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.8.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p3.8.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p3.8.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p3.8.m1.1.1.2">𝒉</ci><ci id="S2.SS2.SSS1.p3.8.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p3.8.m1.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.8.m1.1c">\bm{h}_{\mathrm{N}}</annotation></semantics></math> is the hidden representation that the non-label party sends to the label party, and the output layer of <math id="S2.SS2.SSS1.p3.9.m2.1" class="ltx_Math" alttext="f_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p3.9.m2.1a"><mrow id="S2.SS2.SSS1.p3.9.m2.1.2" xref="S2.SS2.SSS1.p3.9.m2.1.2.cmml"><msub id="S2.SS2.SSS1.p3.9.m2.1.2.2" xref="S2.SS2.SSS1.p3.9.m2.1.2.2.cmml"><mi id="S2.SS2.SSS1.p3.9.m2.1.2.2.2" xref="S2.SS2.SSS1.p3.9.m2.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.9.m2.1.2.2.3" xref="S2.SS2.SSS1.p3.9.m2.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.9.m2.1.2.1" xref="S2.SS2.SSS1.p3.9.m2.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p3.9.m2.1.2.3.2" xref="S2.SS2.SSS1.p3.9.m2.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.9.m2.1.2.3.2.1" xref="S2.SS2.SSS1.p3.9.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.9.m2.1.1" xref="S2.SS2.SSS1.p3.9.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p3.9.m2.1.2.3.2.2" xref="S2.SS2.SSS1.p3.9.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.9.m2.1b"><apply id="S2.SS2.SSS1.p3.9.m2.1.2.cmml" xref="S2.SS2.SSS1.p3.9.m2.1.2"><times id="S2.SS2.SSS1.p3.9.m2.1.2.1.cmml" xref="S2.SS2.SSS1.p3.9.m2.1.2.1"></times><apply id="S2.SS2.SSS1.p3.9.m2.1.2.2.cmml" xref="S2.SS2.SSS1.p3.9.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.9.m2.1.2.2.1.cmml" xref="S2.SS2.SSS1.p3.9.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p3.9.m2.1.2.2.2.cmml" xref="S2.SS2.SSS1.p3.9.m2.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p3.9.m2.1.2.2.3.cmml" xref="S2.SS2.SSS1.p3.9.m2.1.2.2.3">N</ci></apply><ci id="S2.SS2.SSS1.p3.9.m2.1.1.cmml" xref="S2.SS2.SSS1.p3.9.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.9.m2.1c">f_{\mathrm{N}}(\cdot)</annotation></semantics></math> is also known as <span id="S2.SS2.SSS1.p3.12.1" class="ltx_text ltx_font_bold">cut layer</span>. The label party’s submodel <math id="S2.SS2.SSS1.p3.10.m3.1" class="ltx_Math" alttext="f_{\mathrm{L}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p3.10.m3.1a"><mrow id="S2.SS2.SSS1.p3.10.m3.1.2" xref="S2.SS2.SSS1.p3.10.m3.1.2.cmml"><msub id="S2.SS2.SSS1.p3.10.m3.1.2.2" xref="S2.SS2.SSS1.p3.10.m3.1.2.2.cmml"><mi id="S2.SS2.SSS1.p3.10.m3.1.2.2.2" xref="S2.SS2.SSS1.p3.10.m3.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.10.m3.1.2.2.3" xref="S2.SS2.SSS1.p3.10.m3.1.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.10.m3.1.2.1" xref="S2.SS2.SSS1.p3.10.m3.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p3.10.m3.1.2.3.2" xref="S2.SS2.SSS1.p3.10.m3.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.10.m3.1.2.3.2.1" xref="S2.SS2.SSS1.p3.10.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.10.m3.1.1" xref="S2.SS2.SSS1.p3.10.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p3.10.m3.1.2.3.2.2" xref="S2.SS2.SSS1.p3.10.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.10.m3.1b"><apply id="S2.SS2.SSS1.p3.10.m3.1.2.cmml" xref="S2.SS2.SSS1.p3.10.m3.1.2"><times id="S2.SS2.SSS1.p3.10.m3.1.2.1.cmml" xref="S2.SS2.SSS1.p3.10.m3.1.2.1"></times><apply id="S2.SS2.SSS1.p3.10.m3.1.2.2.cmml" xref="S2.SS2.SSS1.p3.10.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.10.m3.1.2.2.1.cmml" xref="S2.SS2.SSS1.p3.10.m3.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p3.10.m3.1.2.2.2.cmml" xref="S2.SS2.SSS1.p3.10.m3.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p3.10.m3.1.2.2.3.cmml" xref="S2.SS2.SSS1.p3.10.m3.1.2.2.3">L</ci></apply><ci id="S2.SS2.SSS1.p3.10.m3.1.1.cmml" xref="S2.SS2.SSS1.p3.10.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.10.m3.1c">f_{\mathrm{L}}(\cdot)</annotation></semantics></math> is composed of a bottom part <math id="S2.SS2.SSS1.p3.11.m4.2" class="ltx_Math" alttext="f_{\mathrm{L}}^{(\mathrm{b})}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p3.11.m4.2a"><mrow id="S2.SS2.SSS1.p3.11.m4.2.3" xref="S2.SS2.SSS1.p3.11.m4.2.3.cmml"><msubsup id="S2.SS2.SSS1.p3.11.m4.2.3.2" xref="S2.SS2.SSS1.p3.11.m4.2.3.2.cmml"><mi id="S2.SS2.SSS1.p3.11.m4.2.3.2.2.2" xref="S2.SS2.SSS1.p3.11.m4.2.3.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.11.m4.2.3.2.2.3" xref="S2.SS2.SSS1.p3.11.m4.2.3.2.2.3.cmml">L</mi><mrow id="S2.SS2.SSS1.p3.11.m4.1.1.1.3" xref="S2.SS2.SSS1.p3.11.m4.2.3.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.11.m4.1.1.1.3.1" xref="S2.SS2.SSS1.p3.11.m4.2.3.2.cmml">(</mo><mi mathvariant="normal" id="S2.SS2.SSS1.p3.11.m4.1.1.1.1" xref="S2.SS2.SSS1.p3.11.m4.1.1.1.1.cmml">b</mi><mo stretchy="false" id="S2.SS2.SSS1.p3.11.m4.1.1.1.3.2" xref="S2.SS2.SSS1.p3.11.m4.2.3.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.11.m4.2.3.1" xref="S2.SS2.SSS1.p3.11.m4.2.3.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p3.11.m4.2.3.3.2" xref="S2.SS2.SSS1.p3.11.m4.2.3.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.11.m4.2.3.3.2.1" xref="S2.SS2.SSS1.p3.11.m4.2.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.11.m4.2.2" xref="S2.SS2.SSS1.p3.11.m4.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p3.11.m4.2.3.3.2.2" xref="S2.SS2.SSS1.p3.11.m4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.11.m4.2b"><apply id="S2.SS2.SSS1.p3.11.m4.2.3.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.3"><times id="S2.SS2.SSS1.p3.11.m4.2.3.1.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.3.1"></times><apply id="S2.SS2.SSS1.p3.11.m4.2.3.2.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.11.m4.2.3.2.1.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.3.2">superscript</csymbol><apply id="S2.SS2.SSS1.p3.11.m4.2.3.2.2.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.11.m4.2.3.2.2.1.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.3.2">subscript</csymbol><ci id="S2.SS2.SSS1.p3.11.m4.2.3.2.2.2.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.3.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p3.11.m4.2.3.2.2.3.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.3.2.2.3">L</ci></apply><ci id="S2.SS2.SSS1.p3.11.m4.1.1.1.1.cmml" xref="S2.SS2.SSS1.p3.11.m4.1.1.1.1">b</ci></apply><ci id="S2.SS2.SSS1.p3.11.m4.2.2.cmml" xref="S2.SS2.SSS1.p3.11.m4.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.11.m4.2c">f_{\mathrm{L}}^{(\mathrm{b})}(\cdot)</annotation></semantics></math> and a top part <math id="S2.SS2.SSS1.p3.12.m5.2" class="ltx_Math" alttext="f_{\mathrm{L}}^{(\mathrm{t})}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p3.12.m5.2a"><mrow id="S2.SS2.SSS1.p3.12.m5.2.3" xref="S2.SS2.SSS1.p3.12.m5.2.3.cmml"><msubsup id="S2.SS2.SSS1.p3.12.m5.2.3.2" xref="S2.SS2.SSS1.p3.12.m5.2.3.2.cmml"><mi id="S2.SS2.SSS1.p3.12.m5.2.3.2.2.2" xref="S2.SS2.SSS1.p3.12.m5.2.3.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p3.12.m5.2.3.2.2.3" xref="S2.SS2.SSS1.p3.12.m5.2.3.2.2.3.cmml">L</mi><mrow id="S2.SS2.SSS1.p3.12.m5.1.1.1.3" xref="S2.SS2.SSS1.p3.12.m5.2.3.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.12.m5.1.1.1.3.1" xref="S2.SS2.SSS1.p3.12.m5.2.3.2.cmml">(</mo><mi mathvariant="normal" id="S2.SS2.SSS1.p3.12.m5.1.1.1.1" xref="S2.SS2.SSS1.p3.12.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S2.SS2.SSS1.p3.12.m5.1.1.1.3.2" xref="S2.SS2.SSS1.p3.12.m5.2.3.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.12.m5.2.3.1" xref="S2.SS2.SSS1.p3.12.m5.2.3.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p3.12.m5.2.3.3.2" xref="S2.SS2.SSS1.p3.12.m5.2.3.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p3.12.m5.2.3.3.2.1" xref="S2.SS2.SSS1.p3.12.m5.2.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p3.12.m5.2.2" xref="S2.SS2.SSS1.p3.12.m5.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p3.12.m5.2.3.3.2.2" xref="S2.SS2.SSS1.p3.12.m5.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p3.12.m5.2b"><apply id="S2.SS2.SSS1.p3.12.m5.2.3.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.3"><times id="S2.SS2.SSS1.p3.12.m5.2.3.1.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.3.1"></times><apply id="S2.SS2.SSS1.p3.12.m5.2.3.2.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.12.m5.2.3.2.1.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.3.2">superscript</csymbol><apply id="S2.SS2.SSS1.p3.12.m5.2.3.2.2.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p3.12.m5.2.3.2.2.1.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.3.2">subscript</csymbol><ci id="S2.SS2.SSS1.p3.12.m5.2.3.2.2.2.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.3.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p3.12.m5.2.3.2.2.3.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.3.2.2.3">L</ci></apply><ci id="S2.SS2.SSS1.p3.12.m5.1.1.1.1.cmml" xref="S2.SS2.SSS1.p3.12.m5.1.1.1.1">t</ci></apply><ci id="S2.SS2.SSS1.p3.12.m5.2.2.cmml" xref="S2.SS2.SSS1.p3.12.m5.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p3.12.m5.2c">f_{\mathrm{L}}^{(\mathrm{t})}(\cdot)</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.SSS1.p4" class="ltx_para">
<p id="S2.SS2.SSS1.p4.4" class="ltx_p">For the backward pass, the label party’s submodel <math id="S2.SS2.SSS1.p4.1.m1.1" class="ltx_Math" alttext="f_{\mathrm{L}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p4.1.m1.1a"><mrow id="S2.SS2.SSS1.p4.1.m1.1.2" xref="S2.SS2.SSS1.p4.1.m1.1.2.cmml"><msub id="S2.SS2.SSS1.p4.1.m1.1.2.2" xref="S2.SS2.SSS1.p4.1.m1.1.2.2.cmml"><mi id="S2.SS2.SSS1.p4.1.m1.1.2.2.2" xref="S2.SS2.SSS1.p4.1.m1.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p4.1.m1.1.2.2.3" xref="S2.SS2.SSS1.p4.1.m1.1.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p4.1.m1.1.2.1" xref="S2.SS2.SSS1.p4.1.m1.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p4.1.m1.1.2.3.2" xref="S2.SS2.SSS1.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p4.1.m1.1.2.3.2.1" xref="S2.SS2.SSS1.p4.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p4.1.m1.1.1" xref="S2.SS2.SSS1.p4.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p4.1.m1.1.2.3.2.2" xref="S2.SS2.SSS1.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p4.1.m1.1b"><apply id="S2.SS2.SSS1.p4.1.m1.1.2.cmml" xref="S2.SS2.SSS1.p4.1.m1.1.2"><times id="S2.SS2.SSS1.p4.1.m1.1.2.1.cmml" xref="S2.SS2.SSS1.p4.1.m1.1.2.1"></times><apply id="S2.SS2.SSS1.p4.1.m1.1.2.2.cmml" xref="S2.SS2.SSS1.p4.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p4.1.m1.1.2.2.1.cmml" xref="S2.SS2.SSS1.p4.1.m1.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p4.1.m1.1.2.2.2.cmml" xref="S2.SS2.SSS1.p4.1.m1.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p4.1.m1.1.2.2.3.cmml" xref="S2.SS2.SSS1.p4.1.m1.1.2.2.3">L</ci></apply><ci id="S2.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p4.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p4.1.m1.1c">f_{\mathrm{L}}(\cdot)</annotation></semantics></math> is updated normally based on the gradient of loss <math id="S2.SS2.SSS1.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.SS2.SSS1.p4.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p4.2.m2.1.1" xref="S2.SS2.SSS1.p4.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p4.2.m2.1b"><ci id="S2.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p4.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p4.2.m2.1c">\mathcal{L}</annotation></semantics></math> w.r.t. the submodel parameters.
To update the parameters of non-label party’s submodel <math id="S2.SS2.SSS1.p4.3.m3.1" class="ltx_Math" alttext="f_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p4.3.m3.1a"><mrow id="S2.SS2.SSS1.p4.3.m3.1.2" xref="S2.SS2.SSS1.p4.3.m3.1.2.cmml"><msub id="S2.SS2.SSS1.p4.3.m3.1.2.2" xref="S2.SS2.SSS1.p4.3.m3.1.2.2.cmml"><mi id="S2.SS2.SSS1.p4.3.m3.1.2.2.2" xref="S2.SS2.SSS1.p4.3.m3.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p4.3.m3.1.2.2.3" xref="S2.SS2.SSS1.p4.3.m3.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p4.3.m3.1.2.1" xref="S2.SS2.SSS1.p4.3.m3.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p4.3.m3.1.2.3.2" xref="S2.SS2.SSS1.p4.3.m3.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p4.3.m3.1.2.3.2.1" xref="S2.SS2.SSS1.p4.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p4.3.m3.1.1" xref="S2.SS2.SSS1.p4.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p4.3.m3.1.2.3.2.2" xref="S2.SS2.SSS1.p4.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p4.3.m3.1b"><apply id="S2.SS2.SSS1.p4.3.m3.1.2.cmml" xref="S2.SS2.SSS1.p4.3.m3.1.2"><times id="S2.SS2.SSS1.p4.3.m3.1.2.1.cmml" xref="S2.SS2.SSS1.p4.3.m3.1.2.1"></times><apply id="S2.SS2.SSS1.p4.3.m3.1.2.2.cmml" xref="S2.SS2.SSS1.p4.3.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p4.3.m3.1.2.2.1.cmml" xref="S2.SS2.SSS1.p4.3.m3.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p4.3.m3.1.2.2.2.cmml" xref="S2.SS2.SSS1.p4.3.m3.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p4.3.m3.1.2.2.3.cmml" xref="S2.SS2.SSS1.p4.3.m3.1.2.2.3">N</ci></apply><ci id="S2.SS2.SSS1.p4.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p4.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p4.3.m3.1c">f_{\mathrm{N}}(\cdot)</annotation></semantics></math>, the label party further computes the gradient w.r.t. the hidden representation <math id="S2.SS2.SSS1.p4.4.m4.1" class="ltx_Math" alttext="\bm{h}_{\mathrm{N}}" display="inline"><semantics id="S2.SS2.SSS1.p4.4.m4.1a"><msub id="S2.SS2.SSS1.p4.4.m4.1.1" xref="S2.SS2.SSS1.p4.4.m4.1.1.cmml"><mi id="S2.SS2.SSS1.p4.4.m4.1.1.2" xref="S2.SS2.SSS1.p4.4.m4.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p4.4.m4.1.1.3" xref="S2.SS2.SSS1.p4.4.m4.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p4.4.m4.1b"><apply id="S2.SS2.SSS1.p4.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p4.4.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p4.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p4.4.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p4.4.m4.1.1.2">𝒉</ci><ci id="S2.SS2.SSS1.p4.4.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p4.4.m4.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p4.4.m4.1c">\bm{h}_{\mathrm{N}}</annotation></semantics></math>, and sends it back to the non-label party:</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.1" class="ltx_Math" alttext="\bm{g}\coloneqq\nabla_{{\bm{h}_{\mathrm{N}}}}\mathcal{L}=\frac{\partial\bm{l}}{\partial\bm{h}_{\mathrm{N}}}\frac{\partial\mathcal{L}}{\partial\bm{l}}=\frac{\partial\bm{l}}{\partial\bm{h}_{\mathrm{N}}}(\hat{\bm{y}}-{\bm{y}})\,." display="block"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.3.cmml">𝒈</mi><mo id="S2.E5.m1.1.1.1.1.4" xref="S2.E5.m1.1.1.1.1.4.cmml">≔</mo><mrow id="S2.E5.m1.1.1.1.1.5" xref="S2.E5.m1.1.1.1.1.5.cmml"><msub id="S2.E5.m1.1.1.1.1.5.1" xref="S2.E5.m1.1.1.1.1.5.1.cmml"><mo rspace="0.167em" id="S2.E5.m1.1.1.1.1.5.1.2" xref="S2.E5.m1.1.1.1.1.5.1.2.cmml">∇</mo><msub id="S2.E5.m1.1.1.1.1.5.1.3" xref="S2.E5.m1.1.1.1.1.5.1.3.cmml"><mi id="S2.E5.m1.1.1.1.1.5.1.3.2" xref="S2.E5.m1.1.1.1.1.5.1.3.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.E5.m1.1.1.1.1.5.1.3.3" xref="S2.E5.m1.1.1.1.1.5.1.3.3.cmml">N</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1.5.2" xref="S2.E5.m1.1.1.1.1.5.2.cmml">ℒ</mi></mrow><mo id="S2.E5.m1.1.1.1.1.6" xref="S2.E5.m1.1.1.1.1.6.cmml">=</mo><mrow id="S2.E5.m1.1.1.1.1.7" xref="S2.E5.m1.1.1.1.1.7.cmml"><mfrac id="S2.E5.m1.1.1.1.1.7.2" xref="S2.E5.m1.1.1.1.1.7.2.cmml"><mrow id="S2.E5.m1.1.1.1.1.7.2.2" xref="S2.E5.m1.1.1.1.1.7.2.2.cmml"><mo rspace="0em" id="S2.E5.m1.1.1.1.1.7.2.2.1" xref="S2.E5.m1.1.1.1.1.7.2.2.1.cmml">∂</mo><mi id="S2.E5.m1.1.1.1.1.7.2.2.2" xref="S2.E5.m1.1.1.1.1.7.2.2.2.cmml">𝒍</mi></mrow><mrow id="S2.E5.m1.1.1.1.1.7.2.3" xref="S2.E5.m1.1.1.1.1.7.2.3.cmml"><mo rspace="0em" id="S2.E5.m1.1.1.1.1.7.2.3.1" xref="S2.E5.m1.1.1.1.1.7.2.3.1.cmml">∂</mo><msub id="S2.E5.m1.1.1.1.1.7.2.3.2" xref="S2.E5.m1.1.1.1.1.7.2.3.2.cmml"><mi id="S2.E5.m1.1.1.1.1.7.2.3.2.2" xref="S2.E5.m1.1.1.1.1.7.2.3.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.E5.m1.1.1.1.1.7.2.3.2.3" xref="S2.E5.m1.1.1.1.1.7.2.3.2.3.cmml">N</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.7.1" xref="S2.E5.m1.1.1.1.1.7.1.cmml">​</mo><mfrac id="S2.E5.m1.1.1.1.1.7.3" xref="S2.E5.m1.1.1.1.1.7.3.cmml"><mrow id="S2.E5.m1.1.1.1.1.7.3.2" xref="S2.E5.m1.1.1.1.1.7.3.2.cmml"><mo rspace="0em" id="S2.E5.m1.1.1.1.1.7.3.2.1" xref="S2.E5.m1.1.1.1.1.7.3.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1.7.3.2.2" xref="S2.E5.m1.1.1.1.1.7.3.2.2.cmml">ℒ</mi></mrow><mrow id="S2.E5.m1.1.1.1.1.7.3.3" xref="S2.E5.m1.1.1.1.1.7.3.3.cmml"><mo rspace="0em" id="S2.E5.m1.1.1.1.1.7.3.3.1" xref="S2.E5.m1.1.1.1.1.7.3.3.1.cmml">∂</mo><mi id="S2.E5.m1.1.1.1.1.7.3.3.2" xref="S2.E5.m1.1.1.1.1.7.3.3.2.cmml">𝒍</mi></mrow></mfrac></mrow><mo id="S2.E5.m1.1.1.1.1.8" xref="S2.E5.m1.1.1.1.1.8.cmml">=</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mfrac id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml"><mrow id="S2.E5.m1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.3.2.cmml"><mo rspace="0em" id="S2.E5.m1.1.1.1.1.1.3.2.1" xref="S2.E5.m1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="S2.E5.m1.1.1.1.1.1.3.2.2" xref="S2.E5.m1.1.1.1.1.1.3.2.2.cmml">𝒍</mi></mrow><mrow id="S2.E5.m1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.3.3.cmml"><mo rspace="0em" id="S2.E5.m1.1.1.1.1.1.3.3.1" xref="S2.E5.m1.1.1.1.1.1.3.3.1.cmml">∂</mo><msub id="S2.E5.m1.1.1.1.1.1.3.3.2" xref="S2.E5.m1.1.1.1.1.1.3.3.2.cmml"><mi id="S2.E5.m1.1.1.1.1.1.3.3.2.2" xref="S2.E5.m1.1.1.1.1.1.3.3.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.E5.m1.1.1.1.1.1.3.3.2.3" xref="S2.E5.m1.1.1.1.1.1.3.3.2.3.cmml">N</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E5.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝒚</mi><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.2.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml">𝒚</mi></mrow><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0.170em" id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.1b"><apply id="S2.E5.m1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><and id="S2.E5.m1.1.1.1.1a.cmml" xref="S2.E5.m1.1.1.1"></and><apply id="S2.E5.m1.1.1.1.1b.cmml" xref="S2.E5.m1.1.1.1"><ci id="S2.E5.m1.1.1.1.1.4.cmml" xref="S2.E5.m1.1.1.1.1.4">≔</ci><ci id="S2.E5.m1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.3">𝒈</ci><apply id="S2.E5.m1.1.1.1.1.5.cmml" xref="S2.E5.m1.1.1.1.1.5"><apply id="S2.E5.m1.1.1.1.1.5.1.cmml" xref="S2.E5.m1.1.1.1.1.5.1"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.5.1.1.cmml" xref="S2.E5.m1.1.1.1.1.5.1">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.5.1.2.cmml" xref="S2.E5.m1.1.1.1.1.5.1.2">∇</ci><apply id="S2.E5.m1.1.1.1.1.5.1.3.cmml" xref="S2.E5.m1.1.1.1.1.5.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.5.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.5.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.5.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.5.1.3.2">𝒉</ci><ci id="S2.E5.m1.1.1.1.1.5.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.5.1.3.3">N</ci></apply></apply><ci id="S2.E5.m1.1.1.1.1.5.2.cmml" xref="S2.E5.m1.1.1.1.1.5.2">ℒ</ci></apply></apply><apply id="S2.E5.m1.1.1.1.1c.cmml" xref="S2.E5.m1.1.1.1"><eq id="S2.E5.m1.1.1.1.1.6.cmml" xref="S2.E5.m1.1.1.1.1.6"></eq><share href="#S2.E5.m1.1.1.1.1.5.cmml" id="S2.E5.m1.1.1.1.1d.cmml" xref="S2.E5.m1.1.1.1"></share><apply id="S2.E5.m1.1.1.1.1.7.cmml" xref="S2.E5.m1.1.1.1.1.7"><times id="S2.E5.m1.1.1.1.1.7.1.cmml" xref="S2.E5.m1.1.1.1.1.7.1"></times><apply id="S2.E5.m1.1.1.1.1.7.2.cmml" xref="S2.E5.m1.1.1.1.1.7.2"><divide id="S2.E5.m1.1.1.1.1.7.2.1.cmml" xref="S2.E5.m1.1.1.1.1.7.2"></divide><apply id="S2.E5.m1.1.1.1.1.7.2.2.cmml" xref="S2.E5.m1.1.1.1.1.7.2.2"><partialdiff id="S2.E5.m1.1.1.1.1.7.2.2.1.cmml" xref="S2.E5.m1.1.1.1.1.7.2.2.1"></partialdiff><ci id="S2.E5.m1.1.1.1.1.7.2.2.2.cmml" xref="S2.E5.m1.1.1.1.1.7.2.2.2">𝒍</ci></apply><apply id="S2.E5.m1.1.1.1.1.7.2.3.cmml" xref="S2.E5.m1.1.1.1.1.7.2.3"><partialdiff id="S2.E5.m1.1.1.1.1.7.2.3.1.cmml" xref="S2.E5.m1.1.1.1.1.7.2.3.1"></partialdiff><apply id="S2.E5.m1.1.1.1.1.7.2.3.2.cmml" xref="S2.E5.m1.1.1.1.1.7.2.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.7.2.3.2.1.cmml" xref="S2.E5.m1.1.1.1.1.7.2.3.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.7.2.3.2.2.cmml" xref="S2.E5.m1.1.1.1.1.7.2.3.2.2">𝒉</ci><ci id="S2.E5.m1.1.1.1.1.7.2.3.2.3.cmml" xref="S2.E5.m1.1.1.1.1.7.2.3.2.3">N</ci></apply></apply></apply><apply id="S2.E5.m1.1.1.1.1.7.3.cmml" xref="S2.E5.m1.1.1.1.1.7.3"><divide id="S2.E5.m1.1.1.1.1.7.3.1.cmml" xref="S2.E5.m1.1.1.1.1.7.3"></divide><apply id="S2.E5.m1.1.1.1.1.7.3.2.cmml" xref="S2.E5.m1.1.1.1.1.7.3.2"><partialdiff id="S2.E5.m1.1.1.1.1.7.3.2.1.cmml" xref="S2.E5.m1.1.1.1.1.7.3.2.1"></partialdiff><ci id="S2.E5.m1.1.1.1.1.7.3.2.2.cmml" xref="S2.E5.m1.1.1.1.1.7.3.2.2">ℒ</ci></apply><apply id="S2.E5.m1.1.1.1.1.7.3.3.cmml" xref="S2.E5.m1.1.1.1.1.7.3.3"><partialdiff id="S2.E5.m1.1.1.1.1.7.3.3.1.cmml" xref="S2.E5.m1.1.1.1.1.7.3.3.1"></partialdiff><ci id="S2.E5.m1.1.1.1.1.7.3.3.2.cmml" xref="S2.E5.m1.1.1.1.1.7.3.3.2">𝒍</ci></apply></apply></apply></apply><apply id="S2.E5.m1.1.1.1.1e.cmml" xref="S2.E5.m1.1.1.1"><eq id="S2.E5.m1.1.1.1.1.8.cmml" xref="S2.E5.m1.1.1.1.1.8"></eq><share href="#S2.E5.m1.1.1.1.1.7.cmml" id="S2.E5.m1.1.1.1.1f.cmml" xref="S2.E5.m1.1.1.1"></share><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2"></times><apply id="S2.E5.m1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3"><divide id="S2.E5.m1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.3"></divide><apply id="S2.E5.m1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2"><partialdiff id="S2.E5.m1.1.1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2.1"></partialdiff><ci id="S2.E5.m1.1.1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.3.2.2">𝒍</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3.3"><partialdiff id="S2.E5.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.3.3.1"></partialdiff><apply id="S2.E5.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.3.3.2.2">𝒉</ci><ci id="S2.E5.m1.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3.3.2.3">N</ci></apply></apply></apply><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1"><minus id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2"><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.2">𝒚</ci></apply><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3">𝒚</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\bm{g}\coloneqq\nabla_{{\bm{h}_{\mathrm{N}}}}\mathcal{L}=\frac{\partial\bm{l}}{\partial\bm{h}_{\mathrm{N}}}\frac{\partial\mathcal{L}}{\partial\bm{l}}=\frac{\partial\bm{l}}{\partial\bm{h}_{\mathrm{N}}}(\hat{\bm{y}}-{\bm{y}})\,.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS1.p4.6" class="ltx_p">After receiving the gradient <math id="S2.SS2.SSS1.p4.5.m1.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S2.SS2.SSS1.p4.5.m1.1a"><mi id="S2.SS2.SSS1.p4.5.m1.1.1" xref="S2.SS2.SSS1.p4.5.m1.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p4.5.m1.1b"><ci id="S2.SS2.SSS1.p4.5.m1.1.1.cmml" xref="S2.SS2.SSS1.p4.5.m1.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p4.5.m1.1c">\bm{g}</annotation></semantics></math>, the non-label party computes the gradients of the remaining submodel parameters using chain rule, and thus continues the backward pass to update the submodel <math id="S2.SS2.SSS1.p4.6.m2.1" class="ltx_Math" alttext="f_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S2.SS2.SSS1.p4.6.m2.1a"><mrow id="S2.SS2.SSS1.p4.6.m2.1.2" xref="S2.SS2.SSS1.p4.6.m2.1.2.cmml"><msub id="S2.SS2.SSS1.p4.6.m2.1.2.2" xref="S2.SS2.SSS1.p4.6.m2.1.2.2.cmml"><mi id="S2.SS2.SSS1.p4.6.m2.1.2.2.2" xref="S2.SS2.SSS1.p4.6.m2.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p4.6.m2.1.2.2.3" xref="S2.SS2.SSS1.p4.6.m2.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p4.6.m2.1.2.1" xref="S2.SS2.SSS1.p4.6.m2.1.2.1.cmml">​</mo><mrow id="S2.SS2.SSS1.p4.6.m2.1.2.3.2" xref="S2.SS2.SSS1.p4.6.m2.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p4.6.m2.1.2.3.2.1" xref="S2.SS2.SSS1.p4.6.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.SS2.SSS1.p4.6.m2.1.1" xref="S2.SS2.SSS1.p4.6.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.SS2.SSS1.p4.6.m2.1.2.3.2.2" xref="S2.SS2.SSS1.p4.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p4.6.m2.1b"><apply id="S2.SS2.SSS1.p4.6.m2.1.2.cmml" xref="S2.SS2.SSS1.p4.6.m2.1.2"><times id="S2.SS2.SSS1.p4.6.m2.1.2.1.cmml" xref="S2.SS2.SSS1.p4.6.m2.1.2.1"></times><apply id="S2.SS2.SSS1.p4.6.m2.1.2.2.cmml" xref="S2.SS2.SSS1.p4.6.m2.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p4.6.m2.1.2.2.1.cmml" xref="S2.SS2.SSS1.p4.6.m2.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p4.6.m2.1.2.2.2.cmml" xref="S2.SS2.SSS1.p4.6.m2.1.2.2.2">𝑓</ci><ci id="S2.SS2.SSS1.p4.6.m2.1.2.2.3.cmml" xref="S2.SS2.SSS1.p4.6.m2.1.2.2.3">N</ci></apply><ci id="S2.SS2.SSS1.p4.6.m2.1.1.cmml" xref="S2.SS2.SSS1.p4.6.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p4.6.m2.1c">f_{\mathrm{N}}(\cdot)</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.SSS1.p5" class="ltx_para">
<p id="S2.SS2.SSS1.p5.5" class="ltx_p">In the above training process, the two participants do not share their raw data (features <math id="S2.SS2.SSS1.p5.1.m1.1" class="ltx_Math" alttext="\bm{x}_{\mathrm{N}}" display="inline"><semantics id="S2.SS2.SSS1.p5.1.m1.1a"><msub id="S2.SS2.SSS1.p5.1.m1.1.1" xref="S2.SS2.SSS1.p5.1.m1.1.1.cmml"><mi id="S2.SS2.SSS1.p5.1.m1.1.1.2" xref="S2.SS2.SSS1.p5.1.m1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p5.1.m1.1.1.3" xref="S2.SS2.SSS1.p5.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p5.1.m1.1b"><apply id="S2.SS2.SSS1.p5.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p5.1.m1.1.1.1.cmml" xref="S2.SS2.SSS1.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p5.1.m1.1.1.2.cmml" xref="S2.SS2.SSS1.p5.1.m1.1.1.2">𝒙</ci><ci id="S2.SS2.SSS1.p5.1.m1.1.1.3.cmml" xref="S2.SS2.SSS1.p5.1.m1.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p5.1.m1.1c">\bm{x}_{\mathrm{N}}</annotation></semantics></math>, <math id="S2.SS2.SSS1.p5.2.m2.1" class="ltx_Math" alttext="\bm{x}_{\mathrm{L}}" display="inline"><semantics id="S2.SS2.SSS1.p5.2.m2.1a"><msub id="S2.SS2.SSS1.p5.2.m2.1.1" xref="S2.SS2.SSS1.p5.2.m2.1.1.cmml"><mi id="S2.SS2.SSS1.p5.2.m2.1.1.2" xref="S2.SS2.SSS1.p5.2.m2.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p5.2.m2.1.1.3" xref="S2.SS2.SSS1.p5.2.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p5.2.m2.1b"><apply id="S2.SS2.SSS1.p5.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p5.2.m2.1.1.1.cmml" xref="S2.SS2.SSS1.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p5.2.m2.1.1.2.cmml" xref="S2.SS2.SSS1.p5.2.m2.1.1.2">𝒙</ci><ci id="S2.SS2.SSS1.p5.2.m2.1.1.3.cmml" xref="S2.SS2.SSS1.p5.2.m2.1.1.3">L</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p5.2.m2.1c">\bm{x}_{\mathrm{L}}</annotation></semantics></math> and label <math id="S2.SS2.SSS1.p5.3.m3.1" class="ltx_Math" alttext="\bm{y}" display="inline"><semantics id="S2.SS2.SSS1.p5.3.m3.1a"><mi id="S2.SS2.SSS1.p5.3.m3.1.1" xref="S2.SS2.SSS1.p5.3.m3.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p5.3.m3.1b"><ci id="S2.SS2.SSS1.p5.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p5.3.m3.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p5.3.m3.1c">\bm{y}</annotation></semantics></math>) to each other. On the contrary, they only exchange intermediate results <math id="S2.SS2.SSS1.p5.4.m4.1" class="ltx_Math" alttext="\bm{h}_{\mathrm{N}}" display="inline"><semantics id="S2.SS2.SSS1.p5.4.m4.1a"><msub id="S2.SS2.SSS1.p5.4.m4.1.1" xref="S2.SS2.SSS1.p5.4.m4.1.1.cmml"><mi id="S2.SS2.SSS1.p5.4.m4.1.1.2" xref="S2.SS2.SSS1.p5.4.m4.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S2.SS2.SSS1.p5.4.m4.1.1.3" xref="S2.SS2.SSS1.p5.4.m4.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p5.4.m4.1b"><apply id="S2.SS2.SSS1.p5.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p5.4.m4.1.1.1.cmml" xref="S2.SS2.SSS1.p5.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p5.4.m4.1.1.2.cmml" xref="S2.SS2.SSS1.p5.4.m4.1.1.2">𝒉</ci><ci id="S2.SS2.SSS1.p5.4.m4.1.1.3.cmml" xref="S2.SS2.SSS1.p5.4.m4.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p5.4.m4.1c">\bm{h}_{\mathrm{N}}</annotation></semantics></math> and <math id="S2.SS2.SSS1.p5.5.m5.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S2.SS2.SSS1.p5.5.m5.1a"><mi id="S2.SS2.SSS1.p5.5.m5.1.1" xref="S2.SS2.SSS1.p5.5.m5.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p5.5.m5.1b"><ci id="S2.SS2.SSS1.p5.5.m5.1.1.cmml" xref="S2.SS2.SSS1.p5.5.m5.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p5.5.m5.1c">\bm{g}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2. </span><span id="S2.SS2.SSS2.1.1" class="ltx_text ltx_font_bold">Issues of Effectiveness and Privacy</span>
</h4>

<div id="S2.SS2.SSS2.p1" class="ltx_para">
<p id="S2.SS2.SSS2.p1.1" class="ltx_p">vFL has been successfully applied in healthcare informatics <cite class="ltx_cite ltx_citemacro_citep">(Vepakomma et al<span class="ltx_text">.</span>, <a href="#bib.bib36" title="" class="ltx_ref">2018b</a>)</cite>, computational advertising <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2022a</a>)</cite> and many other domains. To further improve vFL algorithms, recent studies pay more attention to the following perspectives: effectiveness and privacy.</p>
</div>
<div id="S2.SS2.SSS2.p2" class="ltx_para">
<p id="S2.SS2.SSS2.p2.1" class="ltx_p"><span id="S2.SS2.SSS2.p2.1.1" class="ltx_text ltx_font_bold">Effectiveness: Limited Aligned Samples.</span></p>
</div>
<div id="S2.SS2.SSS2.p3" class="ltx_para">
<p id="S2.SS2.SSS2.p3.1" class="ltx_p">The training procedure of traditional vFL algorithms relies on aligned, feature-partitioned data. That is, each participant first provides its own sample ID set, and then a PSI process is adopt to align samples from all participants, and finally produces the <span id="S2.SS2.SSS2.p3.1.1" class="ltx_text ltx_font_italic">intersection</span> sample set, namely aligned samples. In the aligned data, for a specific sample, each participant owns a part of feature of it, and all participants need to collaboratively train the vFL model.</p>
</div>
<div id="S2.SS2.SSS2.p4" class="ltx_para">
<p id="S2.SS2.SSS2.p4.1" class="ltx_p">We can see that the vFL model performance greatly depends on the size of aligned samples. However the size is usually limited, which restricts the effectiveness of vFL models.
To tackle this, a direction is to make use of local samples of each participant, namely unaligned samples.
In the case of CVR estimation, the advertising platform usually also collects conversion events from in-station ads (which are not displayed on the extra publishers). These local data can be used as auxiliary training samples to enhance the model trained on aligned samples only. To exploit such unaligned samples that only have partly features into the vFL training framework, we focus on how to synthesize the features of other participants.</p>
</div>
<div id="S2.SS2.SSS2.p5" class="ltx_para">
<p id="S2.SS2.SSS2.p5.1" class="ltx_p"><span id="S2.SS2.SSS2.p5.1.1" class="ltx_text ltx_font_bold">Privacy: Potential Label Leakage.</span></p>
</div>
<div id="S2.SS2.SSS2.p6" class="ltx_para">
<p id="S2.SS2.SSS2.p6.1" class="ltx_p">vFL is often considered to be privacy-oriented, because during training process participants only exchange intermediate hidden representations and gradients rather than raw features and labels.
However, recent studies revealed that it still suffers from potential privacy leakage risks: (1) label inference attack <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2022a</a>; Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2022</a>; Fu et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2022</a>)</cite>, which means that a honest-but-curious non-label party can successfully infer private labels, and (2) input reconstruction attack <cite class="ltx_cite ltx_citemacro_citep">(Vepakomma
et al<span class="ltx_text">.</span>, <a href="#bib.bib35" title="" class="ltx_ref">2018a</a>; Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib33" title="" class="ltx_ref">2021</a>)</cite>, which means that the label party can reconstruct the raw input features of the non-label party.</p>
</div>
<div id="S2.SS2.SSS2.p7" class="ltx_para">
<p id="S2.SS2.SSS2.p7.2" class="ltx_p">In this work we focus on defending against label inference attacks, aiming to guarantee that the private label information owned by label party can be protected. Specifically, although the label party only sends gradients to the non-label party during training, from Equation <a href="#S2.E5" title="Equation 5 ‣ 2.2.1. Two-Party vFL ‣ 2.2. Vertical Federated Learning ‣ 2. Preliminaries ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we can observe that the mathematical expression of the gradient <math id="S2.SS2.SSS2.p7.1.m1.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S2.SS2.SSS2.p7.1.m1.1a"><mi id="S2.SS2.SSS2.p7.1.m1.1.1" xref="S2.SS2.SSS2.p7.1.m1.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p7.1.m1.1b"><ci id="S2.SS2.SSS2.p7.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p7.1.m1.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p7.1.m1.1c">\bm{g}</annotation></semantics></math> w.r.t. hidden representation contains label information <math id="S2.SS2.SSS2.p7.2.m2.1" class="ltx_Math" alttext="\bm{y}" display="inline"><semantics id="S2.SS2.SSS2.p7.2.m2.1a"><mi id="S2.SS2.SSS2.p7.2.m2.1.1" xref="S2.SS2.SSS2.p7.2.m2.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p7.2.m2.1b"><ci id="S2.SS2.SSS2.p7.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p7.2.m2.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p7.2.m2.1c">\bm{y}</annotation></semantics></math>, which results in potential label leakage.</p>
</div>
<div id="S2.SS2.SSS2.p8" class="ltx_para">
<p id="S2.SS2.SSS2.p8.1" class="ltx_p">During the training procedure of vFL models, privacy-preserving computing techniques can be applied to protect private information. For instance, the open-source framework <span id="S2.SS2.SSS2.p8.1.1" class="ltx_text ltx_font_sansserif">EFLS<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note"><span id="footnote1.1.1.1" class="ltx_text ltx_font_serif">1</span></span><a target="_blank" href="https://github.com/alibaba/Elastic-Federated-Learning-Solution" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/alibaba/Elastic-Federated-Learning-Solution</a></span></span></span></span> from Alibaba Group provides APIs of cryptography-based homomorphic encryption <cite class="ltx_cite ltx_citemacro_citep">(Zhang and Zhu, <a href="#bib.bib44" title="" class="ltx_ref">2020</a>)</cite> and perturbation-based differential privacy <cite class="ltx_cite ltx_citemacro_citep">(Abadi et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2016</a>)</cite>. In this work we focus on random perturbation-based algorithms.</p>
</div>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Proposed Benchmark</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Currently, the lack of a comprehensive benchmark brings challenges to fair comparison of various algorithms, and also hinders further research for tacking the effectiveness and privacy issues of vFL. To address this, we introduce <span id="S3.p1.1.1" class="ltx_text ltx_font_sansserif">FedAds</span>, the first benchmark for privacy-preserving CVR estimation with vFL, to facilitate systematical evaluations for vFL algorithms.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Overview</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_sansserif">FedAds</span> benchmark contains:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">A large-scale dataset from Alibaba’s advertising platform, collected from the log of an ad delivery business relying on vFL-based ranking models. Details in Section <a href="#S3.SS2" title="3.2. Real-World Dataset Construction ‣ 3. Proposed Benchmark ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p">Systematical evaluations for both effectiveness and privacy aspects of various vFL algorithms. Details in Section <a href="#S5" title="5. Systematical Evaluations ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</li>
</ul>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">We release the <span id="S3.SS1.p2.1.1" class="ltx_text ltx_font_sansserif">FedAds</span> benchmark at the page <a target="_blank" href="https://github.com/alibaba/Elastic-Federated-Learning-Solution/tree/FedAds" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/alibaba/Elastic-Federated-Learning-Solution/tree/FedAds</a>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Real-World Dataset Construction</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We first introduce the background of the collected data, and then give statistics and features of the dataset.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span><span id="S3.SS2.SSS1.1.1" class="ltx_text ltx_font_bold">Data Description</span>
</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">The dataset is built upon the click log of our e-commerce ad delivery business, in which both the online publisher and the advertising platform belong to Alibaba Group. Although the two parties belong to the same company, they still cannot share user behavior information to each other.
Specifically, the online publisher is a mobile app that contains ad positions. As shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2.2. Dataset Construction ‣ 3.2. Real-World Dataset Construction ‣ 3. Proposed Benchmark ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the advertising platform bids for ad impressions in real-time, and for each request the predicted CVR score <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\hat{p}_{\mathrm{CVR}}" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><msub id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.2.cmml">p</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.2.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml">CVR</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.1">^</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.2">𝑝</ci></apply><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3">CVR</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">\hat{p}_{\mathrm{CVR}}</annotation></semantics></math> is a key factor in the bid price.
If an ad from the advertising platform wins a bid, it will be displayed to the user. The user will arrive at another e-commerce mobile app that manages the ad landing page if he/she clicks on the ad, and may take further behaviors such as add-to-wishlist and purchase.</p>
</div>
<div id="S3.SS2.SSS1.p2" class="ltx_para">
<p id="S3.SS2.SSS1.p2.1" class="ltx_p">The above ad delivery business is a typical application of vFL, where the online publisher and the advertising platform collaboratively train the CVR estimation model for ranking candidate ads and improving the delivery performance.
Therefore, we believe that further vFL research can benefit from our benchmark.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Statistics of the dataset.</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T1.1.1" class="ltx_tr">
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">Split</td>
<td id="S3.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"># Samples</td>
<td id="S3.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"># Users</td>
<td id="S3.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"># Ads</td>
<td id="S3.T1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">CVR</td>
</tr>
<tr id="S3.T1.1.2" class="ltx_tr">
<td id="S3.T1.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Training+Test</td>
<td id="S3.T1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">11.3 mil.</td>
<td id="S3.T1.1.2.3" class="ltx_td ltx_align_center ltx_border_t">4.1 mil.</td>
<td id="S3.T1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">1.3 mil.</td>
<td id="S3.T1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">0.6%</td>
</tr>
<tr id="S3.T1.1.3" class="ltx_tr">
<td id="S3.T1.1.3.1" class="ltx_td ltx_align_center">Training</td>
<td id="S3.T1.1.3.2" class="ltx_td ltx_align_center">10.0 mil.</td>
<td id="S3.T1.1.3.3" class="ltx_td ltx_align_center">3.7 mil.</td>
<td id="S3.T1.1.3.4" class="ltx_td ltx_align_center">1.2 mil.</td>
<td id="S3.T1.1.3.5" class="ltx_td ltx_align_center">0.6%</td>
</tr>
<tr id="S3.T1.1.4" class="ltx_tr">
<td id="S3.T1.1.4.1" class="ltx_td ltx_align_center ltx_border_bb">Test</td>
<td id="S3.T1.1.4.2" class="ltx_td ltx_align_center ltx_border_bb">1.3 mil.</td>
<td id="S3.T1.1.4.3" class="ltx_td ltx_align_center ltx_border_bb">0.7 mil.</td>
<td id="S3.T1.1.4.4" class="ltx_td ltx_align_center ltx_border_bb">0.4 mil.</td>
<td id="S3.T1.1.4.5" class="ltx_td ltx_align_center ltx_border_bb">0.6%</td>
</tr>
</table>
</figure>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span><span id="S3.SS2.SSS2.1.1" class="ltx_text ltx_font_bold">Dataset Construction</span>
</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.1" class="ltx_p">We built the dataset based on the above collected data.
Specifically, we collect 1-month consecutive user click events of the delivery business, and each sample in the dataset is corresponding to a unique click event. We record context information for each sample, such as the timestamps of request and click event. Generally, the dataset is composed of features from both parties, and conversion labels from label party.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.p2.1" class="ltx_p"><span id="S3.SS2.SSS2.p2.1.1" class="ltx_text ltx_font_bold">Conversion label.</span></p>
</div>
<div id="S3.SS2.SSS2.p3" class="ltx_para">
<p id="S3.SS2.SSS2.p3.1" class="ltx_p">A sample’s label is set to 1 if the user purchases the item described by the clicked ad, where the attribution window is set to 24 hours. Here we employ last-touch attribution, which means that if a user clicks on the ad multiple times and finally purchases the item, we regard that this conversion event is attributed by the last click event.</p>
</div>
<figure id="S3.F2" class="ltx_figure">
<p id="S3.F2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F2.1.1" class="ltx_text"><img src="/html/2305.08328/assets/x2.png" id="S3.F2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="415" height="246" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Brief illustration of the ranking stage in ad delivery procedure and user behaviors. The proposed dataset is built upon the click log collected from this procedure. </figcaption>
</figure>
<div id="S3.SS2.SSS2.p4" class="ltx_para">
<p id="S3.SS2.SSS2.p4.1" class="ltx_p"><span id="S3.SS2.SSS2.p4.1.1" class="ltx_text ltx_font_bold">Features and processing.</span></p>
</div>
<div id="S3.SS2.SSS2.p5" class="ltx_para">
<p id="S3.SS2.SSS2.p5.1" class="ltx_p">The feature set for each sample consists of two parts: one part from the label party (i.e., advertising platform) and another one from the non-label party (i.e., online publisher). Specifically,</p>
<ul id="S3.I2" class="ltx_itemize">
<li id="S3.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i1.p1" class="ltx_para">
<p id="S3.I2.i1.p1.1" class="ltx_p">Features from label party: we construct user-side, ad-side and context features.</p>
<ul id="S3.I2.i1.I1" class="ltx_itemize">
<li id="S3.I2.i1.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span> 
<div id="S3.I2.i1.I1.ix1.p1" class="ltx_para">
<p id="S3.I2.i1.I1.ix1.p1.1" class="ltx_p">The user-side features contain user profile information (e.g., user ID and activity level), as well as purchase-related behaviors such as user’s historial purchased items.</p>
</div>
</li>
<li id="S3.I2.i1.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span> 
<div id="S3.I2.i1.I1.ix2.p1" class="ltx_para">
<p id="S3.I2.i1.I1.ix2.p1.1" class="ltx_p">The ad-side features contain profile information (e.g., ad ID, item ID, item’s brand ID and price level), as well as ad statistics like historial click/conversion count level.</p>
</div>
</li>
<li id="S3.I2.i1.I1.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span> 
<div id="S3.I2.i1.I1.ix3.p1" class="ltx_para">
<p id="S3.I2.i1.I1.ix3.p1.1" class="ltx_p">Context feature is the timestamp of conversion event.</p>
</div>
</li>
</ul>
</div>
</li>
<li id="S3.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I2.i2.p1" class="ltx_para">
<p id="S3.I2.i2.p1.1" class="ltx_p">Features from non-label party: similarly, we construct user-side, ad-side and context features.</p>
<ul id="S3.I2.i2.I1" class="ltx_itemize">
<li id="S3.I2.i2.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span> 
<div id="S3.I2.i2.I1.ix1.p1" class="ltx_para">
<p id="S3.I2.i2.I1.ix1.p1.1" class="ltx_p">The user-side features are click-related behaviors such as user’s historial clicked ads.</p>
</div>
</li>
<li id="S3.I2.i2.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span> 
<div id="S3.I2.i2.I1.ix2.p1" class="ltx_para">
<p id="S3.I2.i2.I1.ix2.p1.1" class="ltx_p">The ad-side features are statistical information such as historial impression count level.</p>
</div>
</li>
<li id="S3.I2.i2.I1.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span> 
<div id="S3.I2.i2.I1.ix3.p1" class="ltx_para">
<p id="S3.I2.i2.I1.ix3.p1.1" class="ltx_p">Context feature is the timestamp of click event.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="S3.SS2.SSS2.p6" class="ltx_para">
<p id="S3.SS2.SSS2.p6.1" class="ltx_p">In summary, there are 16 features owned by label party and 7 features owned by non-label party.
For the considerations of fair comparison and removing personal identifiable information, in our dataset we release the processed features rather than original values. Specifically, for discrete features we map the original values to IDs. For each continuous feature, we perform equi-frequency discretization to transform the original values to bin IDs.</p>
</div>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3. </span><span id="S3.SS2.SSS3.1.1" class="ltx_text ltx_font_bold">Statistics</span>
</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.p1.1" class="ltx_p">Table <a href="#S3.T1" title="Table 1 ‣ 3.2.1. Data Description ‣ 3.2. Real-World Dataset Construction ‣ 3. Proposed Benchmark ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> lists the statistics of our constructed dataset.
Totally the dataset contains 11.3 million samples, and to our knowledge it is the largest public dataset for evaluating CVR estimation models and vFL algorithms.
We split it to training set and test set based on click timestamp, where the last week’s samples are selected for test set. Details about how to use the dataset for evaluating effectiveness and privacy are introduced in Section <a href="#S5" title="5. Systematical Evaluations ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="S3.SS2.SSS3.p2" class="ltx_para">
<p id="S3.SS2.SSS3.p2.1" class="ltx_p">We compare our proposed dataset with current commonly-used datasets in vFL research in Table <a href="#S3.T2" title="Table 2 ‣ 3.2.3. Statistics ‣ 3.2. Real-World Dataset Construction ‣ 3. Proposed Benchmark ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
More importantly, our dataset is constructed from real world applications, thus we do not need to simulate a vFL experiment setting.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Comparison of datasets.</figcaption>
<table id="S3.T2.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S3.T2.1.1" class="ltx_tr">
<td id="S3.T2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">Split</td>
<td id="S3.T2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"># Samples</td>
<td id="S3.T2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">Type</td>
</tr>
<tr id="S3.T2.1.2" class="ltx_tr">
<td id="S3.T2.1.2.1" class="ltx_td ltx_align_center ltx_border_t">BHI <cite class="ltx_cite ltx_citemacro_citep">(Mooney, <a href="#bib.bib27" title="" class="ltx_ref">[n.d.]</a>)</cite>
</td>
<td id="S3.T2.1.2.2" class="ltx_td ltx_align_center ltx_border_t">0.3 mil.</td>
<td id="S3.T2.1.2.3" class="ltx_td ltx_align_center ltx_border_t">Image</td>
</tr>
<tr id="S3.T2.1.3" class="ltx_tr">
<td id="S3.T2.1.3.1" class="ltx_td ltx_align_center">Yahoo Answers <cite class="ltx_cite ltx_citemacro_citep">(Rakshit, <a href="#bib.bib30" title="" class="ltx_ref">[n.d.]</a>)</cite>
</td>
<td id="S3.T2.1.3.2" class="ltx_td ltx_align_center">1.5 mil.</td>
<td id="S3.T2.1.3.3" class="ltx_td ltx_align_center">Text</td>
</tr>
<tr id="S3.T2.1.4" class="ltx_tr">
<td id="S3.T2.1.4.1" class="ltx_td ltx_align_center">Give Me Some Credit <cite class="ltx_cite ltx_citemacro_citep">(Kaggle, <a href="#bib.bib16" title="" class="ltx_ref">[n.d.]b</a>)</cite>
</td>
<td id="S3.T2.1.4.2" class="ltx_td ltx_align_center">0.3 mil.</td>
<td id="S3.T2.1.4.3" class="ltx_td ltx_align_center">Tabular</td>
</tr>
<tr id="S3.T2.1.5" class="ltx_tr">
<td id="S3.T2.1.5.1" class="ltx_td ltx_align_center">Epsilon <cite class="ltx_cite ltx_citemacro_citep">(PASCAL-Challenge-2008, <a href="#bib.bib29" title="" class="ltx_ref">[n.d.]</a>)</cite>
</td>
<td id="S3.T2.1.5.2" class="ltx_td ltx_align_center">0.5 mil.</td>
<td id="S3.T2.1.5.3" class="ltx_td ltx_align_center">Tabular</td>
</tr>
<tr id="S3.T2.1.6" class="ltx_tr">
<td id="S3.T2.1.6.1" class="ltx_td ltx_align_center">Avazu <cite class="ltx_cite ltx_citemacro_citep">(Kaggle, <a href="#bib.bib15" title="" class="ltx_ref">[n.d.]a</a>)</cite>
</td>
<td id="S3.T2.1.6.2" class="ltx_td ltx_align_center">4 mil.</td>
<td id="S3.T2.1.6.3" class="ltx_td ltx_align_center">Tabular</td>
</tr>
<tr id="S3.T2.1.7" class="ltx_tr">
<td id="S3.T2.1.7.1" class="ltx_td ltx_align_center">Criteo <cite class="ltx_cite ltx_citemacro_citep">(Labs., <a href="#bib.bib19" title="" class="ltx_ref">[n.d.]</a>)</cite>
</td>
<td id="S3.T2.1.7.2" class="ltx_td ltx_align_center">4.5 mil.</td>
<td id="S3.T2.1.7.3" class="ltx_td ltx_align_center">Tabular</td>
</tr>
<tr id="S3.T2.1.8" class="ltx_tr">
<td id="S3.T2.1.8.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S3.T2.1.8.1.1" class="ltx_text ltx_font_sansserif">FedAds</span> (Ours)</td>
<td id="S3.T2.1.8.2" class="ltx_td ltx_align_center ltx_border_bb">11.3 mil.</td>
<td id="S3.T2.1.8.3" class="ltx_td ltx_align_center ltx_border_bb">Tabular</td>
</tr>
</table>
</figure>
<figure id="S3.F3" class="ltx_figure">
<p id="S3.F3.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F3.1.1" class="ltx_text"><img src="/html/2305.08328/assets/x3.png" id="S3.F3.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="355" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>(a) Learning a conditional diffusion model for generating federated embeddings of label party’s unaligned samples. (b) The <span id="S3.F3.3.1" class="ltx_text ltx_font_sansserif">Diffu-AT</span> framework for exploiting unaligned samples in vFL training. </figcaption>
</figure>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Methodology</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Before the systematical evaluations of existing vFL models, we propose two approaches for improving effectiveness and privacy.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Exploiting Label Party’s Unaligned Samples</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">As statement in Section <a href="#S2.SS2.SSS2" title="2.2.2. Issues of Effectiveness and Privacy ‣ 2.2. Vertical Federated Learning ‣ 2. Preliminaries ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2.2</span></a>, the limited size of aligned samples <math id="S4.SS1.p1.1.m1.2" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}=\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\}" display="inline"><semantics id="S4.SS1.p1.1.m1.2a"><mrow id="S4.SS1.p1.1.m1.2.2" xref="S4.SS1.p1.1.m1.2.2.cmml"><msub id="S4.SS1.p1.1.m1.2.2.3" xref="S4.SS1.p1.1.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.2.2.3.2" xref="S4.SS1.p1.1.m1.2.2.3.2.cmml">𝒟</mi><mi id="S4.SS1.p1.1.m1.2.2.3.3" xref="S4.SS1.p1.1.m1.2.2.3.3.cmml">aligned</mi></msub><mo id="S4.SS1.p1.1.m1.2.2.2" xref="S4.SS1.p1.1.m1.2.2.2.cmml">=</mo><mrow id="S4.SS1.p1.1.m1.2.2.1.1" xref="S4.SS1.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.2.2.1.1.2" xref="S4.SS1.p1.1.m1.2.2.1.2.cmml">{</mo><mrow id="S4.SS1.p1.1.m1.2.2.1.1.1.2" xref="S4.SS1.p1.1.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.p1.1.m1.2.2.1.1.1.2.3" xref="S4.SS1.p1.1.m1.2.2.1.1.1.3.cmml">(</mo><msub id="S4.SS1.p1.1.m1.2.2.1.1.1.1.1" xref="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.2" xref="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.3" xref="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.3.cmml">N</mi></msub><mo id="S4.SS1.p1.1.m1.2.2.1.1.1.2.4" xref="S4.SS1.p1.1.m1.2.2.1.1.1.3.cmml">,</mo><msub id="S4.SS1.p1.1.m1.2.2.1.1.1.2.2" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.cmml"><mi id="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.2" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.3" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.3.cmml">L</mi></msub><mo id="S4.SS1.p1.1.m1.2.2.1.1.1.2.5" xref="S4.SS1.p1.1.m1.2.2.1.1.1.3.cmml">,</mo><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="S4.SS1.p1.1.m1.2.2.1.1.1.2.6" xref="S4.SS1.p1.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S4.SS1.p1.1.m1.2.2.1.1.3" xref="S4.SS1.p1.1.m1.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.2b"><apply id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2"><eq id="S4.SS1.p1.1.m1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.2"></eq><apply id="S4.SS1.p1.1.m1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.3.1.cmml" xref="S4.SS1.p1.1.m1.2.2.3">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.3.2.cmml" xref="S4.SS1.p1.1.m1.2.2.3.2">𝒟</ci><ci id="S4.SS1.p1.1.m1.2.2.3.3.cmml" xref="S4.SS1.p1.1.m1.2.2.3.3">aligned</ci></apply><set id="S4.SS1.p1.1.m1.2.2.1.2.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1"><vector id="S4.SS1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2"><apply id="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.2">𝒙</ci><ci id="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.1.1.3">N</ci></apply><apply id="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.2">𝒙</ci><ci id="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.3.cmml" xref="S4.SS1.p1.1.m1.2.2.1.1.1.2.2.3">L</ci></apply><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝒚</ci></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.2c">\mathcal{D}_{\mathrm{aligned}}=\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\}</annotation></semantics></math> restricts the effectiveness of vFL models. From the perspective of advertising platform, a nature way to tackle this problem is to incorporate its local and unaligned samples <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{unaligned}}=\left\{\left(\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><msub id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">𝒟</mi><mi id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml">unaligned</mi></msub><mo id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S4.SS1.p1.2.m2.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S4.SS1.p1.2.m2.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.2.cmml">{</mo><mrow id="S4.SS1.p1.2.m2.1.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml"><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml">(</mo><msubsup id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.2.4" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml">,</mo><msup id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.2.cmml">𝒚</mi><mi mathvariant="normal" id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.3.cmml">u</mi></msup><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.2.5" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S4.SS1.p1.2.m2.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><eq id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"></eq><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">𝒟</ci><ci id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3">unaligned</ci></apply><set id="S4.SS1.p1.2.m2.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1"><interval closure="open" id="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2"><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.3">L</ci></apply><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3">u</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.2">𝒚</ci><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.3">u</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathcal{D}_{\mathrm{unaligned}}=\left\{\left(\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}</annotation></semantics></math> into the vFL training procedure.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">However, the challenge of exploiting label party’s unaligned samples in vFL is that they do not have non-label party’s features (i.e., <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\bm{x}_{\mathrm{N}}^{\mathrm{u}}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msubsup id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2.2" xref="S4.SS1.p2.1.m1.1.1.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.p2.1.m1.1.1.2.3" xref="S4.SS1.p2.1.m1.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2.2">𝒙</ci><ci id="S4.SS1.p2.1.m1.1.1.2.3.cmml" xref="S4.SS1.p2.1.m1.1.1.2.3">N</ci></apply><ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\bm{x}_{\mathrm{N}}^{\mathrm{u}}</annotation></semantics></math> is missing). We propose <span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_sansserif">Diffu-AT</span>, an enhanced vFL training framework which first generates missing feature with a diffusion model, and then performs alternatively training to incorporate unaligned samples into the traditional vFL framework.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span><span id="S4.SS1.SSS1.1.1" class="ltx_text ltx_font_bold">Generating Federated Embedding <math id="S4.SS1.SSS1.1.1.m1.1" class="ltx_Math" alttext="\tilde{\bm{h}}_{\mathrm{L}}^{\mathrm{u}}" display="inline"><semantics id="S4.SS1.SSS1.1.1.m1.1b"><msubsup id="S4.SS1.SSS1.1.1.m1.1.1" xref="S4.SS1.SSS1.1.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.SSS1.1.1.m1.1.1.2.2" xref="S4.SS1.SSS1.1.1.m1.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.1.1.m1.1.1.2.2.2" xref="S4.SS1.SSS1.1.1.m1.1.1.2.2.2.cmml">h</mi><mo id="S4.SS1.SSS1.1.1.m1.1.1.2.2.1" xref="S4.SS1.SSS1.1.1.m1.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.1.1.m1.1.1.2.3" xref="S4.SS1.SSS1.1.1.m1.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.SSS1.1.1.m1.1.1.3" xref="S4.SS1.SSS1.1.1.m1.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.1.1.m1.1c"><apply id="S4.SS1.SSS1.1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.1.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.1.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1.2.2"><ci id="S4.SS1.SSS1.1.1.m1.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1.2.2.1">~</ci><ci id="S4.SS1.SSS1.1.1.m1.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1.2.2.2">ℎ</ci></apply><ci id="S4.SS1.SSS1.1.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1.2.3">L</ci></apply><ci id="S4.SS1.SSS1.1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.1.1.m1.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.1.1.m1.1d">\tilde{\bm{h}}_{\mathrm{L}}^{\mathrm{u}}</annotation></semantics></math> with Conditional Diffusion Model</span>
</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.2" class="ltx_p">As shown in <a href="#S1.F1" title="In 1. Introduction ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Figure</span> <span class="ltx_text ltx_ref_tag">1</span></a>, the key of traditional vFL training procedure is that the non-label party sends the representation <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\bm{h}_{\mathrm{N}}" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><msub id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p1.1.m1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">\bm{h}_{\mathrm{N}}</annotation></semantics></math> (named <span id="S4.SS1.SSS1.p1.2.1" class="ltx_text ltx_font_bold">federated embedding</span> in this work) to enhance the prediction.
To effectively incorporate unaligned samples into vFL, we employ deep generative models to synthesize federated embeddings <math id="S4.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}" display="inline"><semantics id="S4.SS1.SSS1.p1.2.m2.1a"><msubsup id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.SSS1.p1.2.m2.1.1.2.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.2.cmml">𝒉</mi><mo id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p1.2.m2.1.1.2.3" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p1.2.m2.1.1.3" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.1b"><apply id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2"><ci id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.1">~</ci><ci id="S4.SS1.SSS1.p1.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.2.2">𝒉</ci></apply><ci id="S4.SS1.SSS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.1c">\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}</annotation></semantics></math> for those samples.</p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.1" class="ltx_p"><span id="S4.SS1.SSS1.p2.1.1" class="ltx_text ltx_font_bold">Problem formulation.</span></p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.5" class="ltx_p">We formulate the synthesis process is to learn a generation model <math id="S4.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p3.1.m1.1a"><mrow id="S4.SS1.SSS1.p3.1.m1.1.2" xref="S4.SS1.SSS1.p3.1.m1.1.2.cmml"><msub id="S4.SS1.SSS1.p3.1.m1.1.2.2" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p3.1.m1.1.2.2.2" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.2.cmml"><mi id="S4.SS1.SSS1.p3.1.m1.1.2.2.2.2" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS1.p3.1.m1.1.2.2.2.1" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p3.1.m1.1.2.2.3" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p3.1.m1.1.2.1" xref="S4.SS1.SSS1.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p3.1.m1.1.2.3.2" xref="S4.SS1.SSS1.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p3.1.m1.1.2.3.2.1" xref="S4.SS1.SSS1.p3.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p3.1.m1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p3.1.m1.1.2.3.2.2" xref="S4.SS1.SSS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.1.m1.1b"><apply id="S4.SS1.SSS1.p3.1.m1.1.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.2"><times id="S4.SS1.SSS1.p3.1.m1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.2.1"></times><apply id="S4.SS1.SSS1.p3.1.m1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.1.m1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p3.1.m1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.2"><ci id="S4.SS1.SSS1.p3.1.m1.1.2.2.2.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS1.p3.1.m1.1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS1.p3.1.m1.1.2.2.3.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.2.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.1.m1.1c">\tilde{f}_{\mathrm{N}}(\cdot)</annotation></semantics></math>, which can generate a federated embedding <math id="S4.SS1.SSS1.p3.2.m2.1" class="ltx_Math" alttext="\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}" display="inline"><semantics id="S4.SS1.SSS1.p3.2.m2.1a"><msubsup id="S4.SS1.SSS1.p3.2.m2.1.1" xref="S4.SS1.SSS1.p3.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.SSS1.p3.2.m2.1.1.2.2" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p3.2.m2.1.1.2.2.2" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.2.2.cmml">𝒉</mi><mo id="S4.SS1.SSS1.p3.2.m2.1.1.2.2.1" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p3.2.m2.1.1.2.3" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p3.2.m2.1.1.3" xref="S4.SS1.SSS1.p3.2.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.2.m2.1b"><apply id="S4.SS1.SSS1.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.2.m2.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.p3.2.m2.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.2"><ci id="S4.SS1.SSS1.p3.2.m2.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.2.1">~</ci><ci id="S4.SS1.SSS1.p3.2.m2.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.2.2">𝒉</ci></apply><ci id="S4.SS1.SSS1.p3.2.m2.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p3.2.m2.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.2.m2.1c">\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}</annotation></semantics></math> given label party’s feature <math id="S4.SS1.SSS1.p3.3.m3.1" class="ltx_Math" alttext="\bm{x}_{\mathrm{L}}^{\mathrm{u}}" display="inline"><semantics id="S4.SS1.SSS1.p3.3.m3.1a"><msubsup id="S4.SS1.SSS1.p3.3.m3.1.1" xref="S4.SS1.SSS1.p3.3.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p3.3.m3.1.1.2.2" xref="S4.SS1.SSS1.p3.3.m3.1.1.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p3.3.m3.1.1.2.3" xref="S4.SS1.SSS1.p3.3.m3.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p3.3.m3.1.1.3" xref="S4.SS1.SSS1.p3.3.m3.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.3.m3.1b"><apply id="S4.SS1.SSS1.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.3.m3.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.3.m3.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.2.2">𝒙</ci><ci id="S4.SS1.SSS1.p3.3.m3.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.2.3">L</ci></apply><ci id="S4.SS1.SSS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p3.3.m3.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.3.m3.1c">\bm{x}_{\mathrm{L}}^{\mathrm{u}}</annotation></semantics></math> and label <math id="S4.SS1.SSS1.p3.4.m4.1" class="ltx_Math" alttext="\bm{y}^{\mathrm{u}}" display="inline"><semantics id="S4.SS1.SSS1.p3.4.m4.1a"><msup id="S4.SS1.SSS1.p3.4.m4.1.1" xref="S4.SS1.SSS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.SSS1.p3.4.m4.1.1.2" xref="S4.SS1.SSS1.p3.4.m4.1.1.2.cmml">𝒚</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p3.4.m4.1.1.3" xref="S4.SS1.SSS1.p3.4.m4.1.1.3.cmml">u</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.4.m4.1b"><apply id="S4.SS1.SSS1.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1.2">𝒚</ci><ci id="S4.SS1.SSS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p3.4.m4.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.4.m4.1c">\bm{y}^{\mathrm{u}}</annotation></semantics></math>, namely <math id="S4.SS1.SSS1.p3.5.m5.2" class="ltx_Math" alttext="\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}=\tilde{f}_{\mathrm{N}}\left(\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)" display="inline"><semantics id="S4.SS1.SSS1.p3.5.m5.2a"><mrow id="S4.SS1.SSS1.p3.5.m5.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.cmml"><msubsup id="S4.SS1.SSS1.p3.5.m5.2.2.4" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.cmml"><mover accent="true" id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.2.cmml">𝒉</mi><mo id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.1" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.3" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.2.3.cmml">N</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p3.5.m5.2.2.4.3" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS1.p3.5.m5.2.2.3" xref="S4.SS1.SSS1.p3.5.m5.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS1.p3.5.m5.2.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.cmml"><msub id="S4.SS1.SSS1.p3.5.m5.2.2.2.4" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.cmml"><mover accent="true" id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.2.cmml">f</mi><mo id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.1" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.3" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p3.5.m5.2.2.2.3" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.3.cmml">​</mo><mrow id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.3.cmml"><mo id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.3" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.3.cmml">(</mo><msubsup id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.4" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.3.cmml">,</mo><msup id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.2" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.2.cmml">𝒚</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.3" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.3.cmml">u</mi></msup><mo id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.5" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.5.m5.2b"><apply id="S4.SS1.SSS1.p3.5.m5.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2"><eq id="S4.SS1.SSS1.p3.5.m5.2.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.3"></eq><apply id="S4.SS1.SSS1.p3.5.m5.2.2.4.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.2.2.4.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4">superscript</csymbol><apply id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4">subscript</csymbol><apply id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2"><ci id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.1">~</ci><ci id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.2.2.2">𝒉</ci></apply><ci id="S4.SS1.SSS1.p3.5.m5.2.2.4.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p3.5.m5.2.2.4.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.4.3">u</ci></apply><apply id="S4.SS1.SSS1.p3.5.m5.2.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2"><times id="S4.SS1.SSS1.p3.5.m5.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.3"></times><apply id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4">subscript</csymbol><apply id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2"><ci id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.1">~</ci><ci id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS1.p3.5.m5.2.2.2.4.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.4.3">N</ci></apply><interval closure="open" id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2"><apply id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.2.3">L</ci></apply><ci id="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.1.1.1.1.1.1.3">u</ci></apply><apply id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.2">𝒚</ci><ci id="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p3.5.m5.2.2.2.2.2.2.3">u</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.5.m5.2c">\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}=\tilde{f}_{\mathrm{N}}\left(\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.SSS1.p4" class="ltx_para">
<p id="S4.SS1.SSS1.p4.1" class="ltx_p"><span id="S4.SS1.SSS1.p4.1.1" class="ltx_text ltx_font_bold">Step 1: vFL pretraining.</span></p>
</div>
<div id="S4.SS1.SSS1.p5" class="ltx_para">
<p id="S4.SS1.SSS1.p5.5" class="ltx_p">To this end, we first perform vFL training, that is, pretrain a vFL model <math id="S4.SS1.SSS1.p5.1.m1.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p5.1.m1.1a"><mrow id="S4.SS1.SSS1.p5.1.m1.1.2" xref="S4.SS1.SSS1.p5.1.m1.1.2.cmml"><mi id="S4.SS1.SSS1.p5.1.m1.1.2.2" xref="S4.SS1.SSS1.p5.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p5.1.m1.1.2.1" xref="S4.SS1.SSS1.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p5.1.m1.1.2.3.2" xref="S4.SS1.SSS1.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p5.1.m1.1.2.3.2.1" xref="S4.SS1.SSS1.p5.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p5.1.m1.1.1" xref="S4.SS1.SSS1.p5.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p5.1.m1.1.2.3.2.2" xref="S4.SS1.SSS1.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.1.m1.1b"><apply id="S4.SS1.SSS1.p5.1.m1.1.2.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.2"><times id="S4.SS1.SSS1.p5.1.m1.1.2.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.2.1"></times><ci id="S4.SS1.SSS1.p5.1.m1.1.2.2.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.2.2">𝑓</ci><ci id="S4.SS1.SSS1.p5.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.1.m1.1c">f(\cdot)</annotation></semantics></math> using aligned samples <math id="S4.SS1.SSS1.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}" display="inline"><semantics id="S4.SS1.SSS1.p5.2.m2.1a"><msub id="S4.SS1.SSS1.p5.2.m2.1.1" xref="S4.SS1.SSS1.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p5.2.m2.1.1.2" xref="S4.SS1.SSS1.p5.2.m2.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.SSS1.p5.2.m2.1.1.3" xref="S4.SS1.SSS1.p5.2.m2.1.1.3.cmml">aligned</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.2.m2.1b"><apply id="S4.SS1.SSS1.p5.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p5.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p5.2.m2.1.1.2">𝒟</ci><ci id="S4.SS1.SSS1.p5.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p5.2.m2.1.1.3">aligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.2.m2.1c">\mathcal{D}_{\mathrm{aligned}}</annotation></semantics></math> with the loss in Eq. <a href="#S2.E4" title="Equation 4 ‣ 2.2.1. Two-Party vFL ‣ 2.2. Vertical Federated Learning ‣ 2. Preliminaries ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
Therefore, based on the pretrained vFL model, for each aligned sample we obtain its federated embedding <math id="S4.SS1.SSS1.p5.3.m3.1" class="ltx_Math" alttext="{\bm{h}}_{\mathrm{N}}" display="inline"><semantics id="S4.SS1.SSS1.p5.3.m3.1a"><msub id="S4.SS1.SSS1.p5.3.m3.1.1" xref="S4.SS1.SSS1.p5.3.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p5.3.m3.1.1.2" xref="S4.SS1.SSS1.p5.3.m3.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p5.3.m3.1.1.3" xref="S4.SS1.SSS1.p5.3.m3.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.3.m3.1b"><apply id="S4.SS1.SSS1.p5.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p5.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p5.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p5.3.m3.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p5.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p5.3.m3.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.3.m3.1c">{\bm{h}}_{\mathrm{N}}</annotation></semantics></math> and label party’s representation <math id="S4.SS1.SSS1.p5.4.m4.1" class="ltx_Math" alttext="{\bm{h}}_{\mathrm{L}}" display="inline"><semantics id="S4.SS1.SSS1.p5.4.m4.1a"><msub id="S4.SS1.SSS1.p5.4.m4.1.1" xref="S4.SS1.SSS1.p5.4.m4.1.1.cmml"><mi id="S4.SS1.SSS1.p5.4.m4.1.1.2" xref="S4.SS1.SSS1.p5.4.m4.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p5.4.m4.1.1.3" xref="S4.SS1.SSS1.p5.4.m4.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.4.m4.1b"><apply id="S4.SS1.SSS1.p5.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.4.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p5.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p5.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p5.4.m4.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p5.4.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p5.4.m4.1.1.3">L</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.4.m4.1c">{\bm{h}}_{\mathrm{L}}</annotation></semantics></math>.
Similarly, for each unaligned sample, we obtain its label party’s representation <math id="S4.SS1.SSS1.p5.5.m5.1" class="ltx_Math" alttext="{\bm{h}}_{\mathrm{L}}^{\mathrm{u}}" display="inline"><semantics id="S4.SS1.SSS1.p5.5.m5.1a"><msubsup id="S4.SS1.SSS1.p5.5.m5.1.1" xref="S4.SS1.SSS1.p5.5.m5.1.1.cmml"><mi id="S4.SS1.SSS1.p5.5.m5.1.1.2.2" xref="S4.SS1.SSS1.p5.5.m5.1.1.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p5.5.m5.1.1.2.3" xref="S4.SS1.SSS1.p5.5.m5.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p5.5.m5.1.1.3" xref="S4.SS1.SSS1.p5.5.m5.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.5.m5.1b"><apply id="S4.SS1.SSS1.p5.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.5.m5.1.1.1.cmml" xref="S4.SS1.SSS1.p5.5.m5.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p5.5.m5.1.1.2.cmml" xref="S4.SS1.SSS1.p5.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p5.5.m5.1.1.2.1.cmml" xref="S4.SS1.SSS1.p5.5.m5.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p5.5.m5.1.1.2.2.cmml" xref="S4.SS1.SSS1.p5.5.m5.1.1.2.2">𝒉</ci><ci id="S4.SS1.SSS1.p5.5.m5.1.1.2.3.cmml" xref="S4.SS1.SSS1.p5.5.m5.1.1.2.3">L</ci></apply><ci id="S4.SS1.SSS1.p5.5.m5.1.1.3.cmml" xref="S4.SS1.SSS1.p5.5.m5.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.5.m5.1c">{\bm{h}}_{\mathrm{L}}^{\mathrm{u}}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.SSS1.p6" class="ltx_para">
<p id="S4.SS1.SSS1.p6.4" class="ltx_p">Next, we use the data <math id="S4.SS1.SSS1.p6.1.m1.2" class="ltx_Math" alttext="\left\{({\bm{h}}_{\mathrm{N}},{\bm{h}}_{\mathrm{L}},\bm{y})\right\}" display="inline"><semantics id="S4.SS1.SSS1.p6.1.m1.2a"><mrow id="S4.SS1.SSS1.p6.1.m1.2.2.1" xref="S4.SS1.SSS1.p6.1.m1.2.2.2.cmml"><mo id="S4.SS1.SSS1.p6.1.m1.2.2.1.2" xref="S4.SS1.SSS1.p6.1.m1.2.2.2.cmml">{</mo><mrow id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.3" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.3.cmml">(</mo><msub id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.2" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.3" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.3.cmml">N</mi></msub><mo id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.4" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.3.cmml">,</mo><msub id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.2" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.3" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.3.cmml">L</mi></msub><mo id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.5" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.3.cmml">,</mo><mi id="S4.SS1.SSS1.p6.1.m1.1.1" xref="S4.SS1.SSS1.p6.1.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.6" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.3.cmml">)</mo></mrow><mo id="S4.SS1.SSS1.p6.1.m1.2.2.1.3" xref="S4.SS1.SSS1.p6.1.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p6.1.m1.2b"><set id="S4.SS1.SSS1.p6.1.m1.2.2.2.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1"><vector id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.3.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2"><apply id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.1.1.3">N</ci></apply><apply id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.2">𝒉</ci><ci id="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.3.cmml" xref="S4.SS1.SSS1.p6.1.m1.2.2.1.1.2.2.3">L</ci></apply><ci id="S4.SS1.SSS1.p6.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p6.1.m1.1.1">𝒚</ci></vector></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p6.1.m1.2c">\left\{({\bm{h}}_{\mathrm{N}},{\bm{h}}_{\mathrm{L}},\bm{y})\right\}</annotation></semantics></math> of aligned samples to learn the generation model <math id="S4.SS1.SSS1.p6.2.m2.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p6.2.m2.1a"><mrow id="S4.SS1.SSS1.p6.2.m2.1.2" xref="S4.SS1.SSS1.p6.2.m2.1.2.cmml"><msub id="S4.SS1.SSS1.p6.2.m2.1.2.2" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p6.2.m2.1.2.2.2" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.2.cmml"><mi id="S4.SS1.SSS1.p6.2.m2.1.2.2.2.2" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS1.p6.2.m2.1.2.2.2.1" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p6.2.m2.1.2.2.3" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p6.2.m2.1.2.1" xref="S4.SS1.SSS1.p6.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p6.2.m2.1.2.3.2" xref="S4.SS1.SSS1.p6.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p6.2.m2.1.2.3.2.1" xref="S4.SS1.SSS1.p6.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p6.2.m2.1.1" xref="S4.SS1.SSS1.p6.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p6.2.m2.1.2.3.2.2" xref="S4.SS1.SSS1.p6.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p6.2.m2.1b"><apply id="S4.SS1.SSS1.p6.2.m2.1.2.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.2"><times id="S4.SS1.SSS1.p6.2.m2.1.2.1.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.2.1"></times><apply id="S4.SS1.SSS1.p6.2.m2.1.2.2.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p6.2.m2.1.2.2.1.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p6.2.m2.1.2.2.2.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.2"><ci id="S4.SS1.SSS1.p6.2.m2.1.2.2.2.1.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS1.p6.2.m2.1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS1.p6.2.m2.1.2.2.3.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.2.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p6.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p6.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p6.2.m2.1c">\tilde{f}_{\mathrm{N}}(\cdot)</annotation></semantics></math>, so as to perform inference on the data <math id="S4.SS1.SSS1.p6.3.m3.1" class="ltx_Math" alttext="\left\{\left(\bm{h}_{\mathrm{L}}^{\mathrm{u}},{\bm{y}}^{\mathrm{u}}\right)\right\}" display="inline"><semantics id="S4.SS1.SSS1.p6.3.m3.1a"><mrow id="S4.SS1.SSS1.p6.3.m3.1.1.1" xref="S4.SS1.SSS1.p6.3.m3.1.1.2.cmml"><mo id="S4.SS1.SSS1.p6.3.m3.1.1.1.2" xref="S4.SS1.SSS1.p6.3.m3.1.1.2.cmml">{</mo><mrow id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.3.cmml"><mo id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.3" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.3.cmml">(</mo><msubsup id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.4" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.3.cmml">,</mo><msup id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.2" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.2.cmml">𝒚</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.3" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.3.cmml">u</mi></msup><mo id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.5" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.3.cmml">)</mo></mrow><mo id="S4.SS1.SSS1.p6.3.m3.1.1.1.3" xref="S4.SS1.SSS1.p6.3.m3.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p6.3.m3.1b"><set id="S4.SS1.SSS1.p6.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1"><interval closure="open" id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2"><apply id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.2">𝒉</ci><ci id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.2.3">L</ci></apply><ci id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.1.1.3">u</ci></apply><apply id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.2">𝒚</ci><ci id="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.3.cmml" xref="S4.SS1.SSS1.p6.3.m3.1.1.1.1.2.2.3">u</ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p6.3.m3.1c">\left\{\left(\bm{h}_{\mathrm{L}}^{\mathrm{u}},{\bm{y}}^{\mathrm{u}}\right)\right\}</annotation></semantics></math> of unaligned samples to generate <math id="S4.SS1.SSS1.p6.4.m4.1" class="ltx_Math" alttext="\left\{\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}\right\}" display="inline"><semantics id="S4.SS1.SSS1.p6.4.m4.1a"><mrow id="S4.SS1.SSS1.p6.4.m4.1.1.1" xref="S4.SS1.SSS1.p6.4.m4.1.1.2.cmml"><mo id="S4.SS1.SSS1.p6.4.m4.1.1.1.2" xref="S4.SS1.SSS1.p6.4.m4.1.1.2.cmml">{</mo><msubsup id="S4.SS1.SSS1.p6.4.m4.1.1.1.1" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.2" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.2.cmml">𝒉</mi><mo id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.1" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.3" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.3" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS1.p6.4.m4.1.1.1.3" xref="S4.SS1.SSS1.p6.4.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p6.4.m4.1b"><set id="S4.SS1.SSS1.p6.4.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1"><apply id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2"><ci id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.1">~</ci><ci id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.2.2">𝒉</ci></apply><ci id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p6.4.m4.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p6.4.m4.1.1.1.1.3">u</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p6.4.m4.1c">\left\{\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}\right\}</annotation></semantics></math>.<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Note that compared to previous problem formulation, we simplify the synthesis process via replacing the input <math id="footnote2.m1.1" class="ltx_Math" alttext="\bm{x}_{\mathrm{L}}^{\mathrm{u}}" display="inline"><semantics id="footnote2.m1.1b"><msubsup id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml"><mi id="footnote2.m1.1.1.2.2" xref="footnote2.m1.1.1.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="footnote2.m1.1.1.2.3" xref="footnote2.m1.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="footnote2.m1.1.1.3" xref="footnote2.m1.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><apply id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1"><csymbol cd="ambiguous" id="footnote2.m1.1.1.1.cmml" xref="footnote2.m1.1.1">superscript</csymbol><apply id="footnote2.m1.1.1.2.cmml" xref="footnote2.m1.1.1"><csymbol cd="ambiguous" id="footnote2.m1.1.1.2.1.cmml" xref="footnote2.m1.1.1">subscript</csymbol><ci id="footnote2.m1.1.1.2.2.cmml" xref="footnote2.m1.1.1.2.2">𝒙</ci><ci id="footnote2.m1.1.1.2.3.cmml" xref="footnote2.m1.1.1.2.3">L</ci></apply><ci id="footnote2.m1.1.1.3.cmml" xref="footnote2.m1.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">\bm{x}_{\mathrm{L}}^{\mathrm{u}}</annotation></semantics></math> with <math id="footnote2.m2.1" class="ltx_Math" alttext="\bm{h}_{\mathrm{L}}^{\mathrm{u}}" display="inline"><semantics id="footnote2.m2.1b"><msubsup id="footnote2.m2.1.1" xref="footnote2.m2.1.1.cmml"><mi id="footnote2.m2.1.1.2.2" xref="footnote2.m2.1.1.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="footnote2.m2.1.1.2.3" xref="footnote2.m2.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="footnote2.m2.1.1.3" xref="footnote2.m2.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="footnote2.m2.1c"><apply id="footnote2.m2.1.1.cmml" xref="footnote2.m2.1.1"><csymbol cd="ambiguous" id="footnote2.m2.1.1.1.cmml" xref="footnote2.m2.1.1">superscript</csymbol><apply id="footnote2.m2.1.1.2.cmml" xref="footnote2.m2.1.1"><csymbol cd="ambiguous" id="footnote2.m2.1.1.2.1.cmml" xref="footnote2.m2.1.1">subscript</csymbol><ci id="footnote2.m2.1.1.2.2.cmml" xref="footnote2.m2.1.1.2.2">𝒉</ci><ci id="footnote2.m2.1.1.2.3.cmml" xref="footnote2.m2.1.1.2.3">L</ci></apply><ci id="footnote2.m2.1.1.3.cmml" xref="footnote2.m2.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m2.1d">\bm{h}_{\mathrm{L}}^{\mathrm{u}}</annotation></semantics></math>.</span></span></span></p>
</div>
<div id="S4.SS1.SSS1.p7" class="ltx_para">
<p id="S4.SS1.SSS1.p7.1" class="ltx_p"><span id="S4.SS1.SSS1.p7.1.1" class="ltx_text ltx_font_bold">Step 2: Learning a conditional diffusion model as <math id="S4.SS1.SSS1.p7.1.1.m1.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS1.p7.1.1.m1.1a"><mrow id="S4.SS1.SSS1.p7.1.1.m1.1.2" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.cmml"><msub id="S4.SS1.SSS1.p7.1.1.m1.1.2.2" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.cmml"><mi id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.2" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.1" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.3" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p7.1.1.m1.1.2.1" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p7.1.1.m1.1.2.3.2" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p7.1.1.m1.1.2.3.2.1" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p7.1.1.m1.1.1" xref="S4.SS1.SSS1.p7.1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS1.p7.1.1.m1.1.2.3.2.2" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p7.1.1.m1.1b"><apply id="S4.SS1.SSS1.p7.1.1.m1.1.2.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.2"><times id="S4.SS1.SSS1.p7.1.1.m1.1.2.1.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.1"></times><apply id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2"><ci id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.1.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS1.p7.1.1.m1.1.2.2.3.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.2.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p7.1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p7.1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p7.1.1.m1.1c">\tilde{f}_{\mathrm{N}}(\cdot)</annotation></semantics></math>.</span></p>
</div>
<div id="S4.SS1.SSS1.p8" class="ltx_para">
<p id="S4.SS1.SSS1.p8.1" class="ltx_p">Inspired by recent studies on diffusion-based deep generative models <cite class="ltx_cite ltx_citemacro_citep">(Sohl-Dickstein et al<span class="ltx_text">.</span>, <a href="#bib.bib31" title="" class="ltx_ref">2015</a>; Ho
et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2022b</a>; Gong
et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2023</a>)</cite>, we propose to synthesize unaligned samples’ federated embeddings via a conditional diffusion model.</p>
</div>
<div id="S4.SS1.SSS1.p9" class="ltx_para">
<p id="S4.SS1.SSS1.p9.4" class="ltx_p">Formally, we regard the concatenation of label party’s representation <math id="S4.SS1.SSS1.p9.1.m1.1" class="ltx_Math" alttext="\bm{h}_{\mathrm{L}}" display="inline"><semantics id="S4.SS1.SSS1.p9.1.m1.1a"><msub id="S4.SS1.SSS1.p9.1.m1.1.1" xref="S4.SS1.SSS1.p9.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p9.1.m1.1.1.2" xref="S4.SS1.SSS1.p9.1.m1.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p9.1.m1.1.1.3" xref="S4.SS1.SSS1.p9.1.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.1.m1.1b"><apply id="S4.SS1.SSS1.p9.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p9.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p9.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p9.1.m1.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p9.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p9.1.m1.1.1.3">L</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.1.m1.1c">\bm{h}_{\mathrm{L}}</annotation></semantics></math> and label <math id="S4.SS1.SSS1.p9.2.m2.1" class="ltx_Math" alttext="{\bm{y}}" display="inline"><semantics id="S4.SS1.SSS1.p9.2.m2.1a"><mi id="S4.SS1.SSS1.p9.2.m2.1.1" xref="S4.SS1.SSS1.p9.2.m2.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.2.m2.1b"><ci id="S4.SS1.SSS1.p9.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p9.2.m2.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.2.m2.1c">{\bm{y}}</annotation></semantics></math> as the condition <math id="S4.SS1.SSS1.p9.3.m3.2" class="ltx_Math" alttext="\left[{\bm{y}};\bm{h}_{\mathrm{L}}\right]" display="inline"><semantics id="S4.SS1.SSS1.p9.3.m3.2a"><mrow id="S4.SS1.SSS1.p9.3.m3.2.2.1" xref="S4.SS1.SSS1.p9.3.m3.2.2.2.cmml"><mo id="S4.SS1.SSS1.p9.3.m3.2.2.1.2" xref="S4.SS1.SSS1.p9.3.m3.2.2.2.cmml">[</mo><mi id="S4.SS1.SSS1.p9.3.m3.1.1" xref="S4.SS1.SSS1.p9.3.m3.1.1.cmml">𝒚</mi><mo id="S4.SS1.SSS1.p9.3.m3.2.2.1.3" xref="S4.SS1.SSS1.p9.3.m3.2.2.2.cmml">;</mo><msub id="S4.SS1.SSS1.p9.3.m3.2.2.1.1" xref="S4.SS1.SSS1.p9.3.m3.2.2.1.1.cmml"><mi id="S4.SS1.SSS1.p9.3.m3.2.2.1.1.2" xref="S4.SS1.SSS1.p9.3.m3.2.2.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p9.3.m3.2.2.1.1.3" xref="S4.SS1.SSS1.p9.3.m3.2.2.1.1.3.cmml">L</mi></msub><mo id="S4.SS1.SSS1.p9.3.m3.2.2.1.4" xref="S4.SS1.SSS1.p9.3.m3.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.3.m3.2b"><list id="S4.SS1.SSS1.p9.3.m3.2.2.2.cmml" xref="S4.SS1.SSS1.p9.3.m3.2.2.1"><ci id="S4.SS1.SSS1.p9.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p9.3.m3.1.1">𝒚</ci><apply id="S4.SS1.SSS1.p9.3.m3.2.2.1.1.cmml" xref="S4.SS1.SSS1.p9.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.3.m3.2.2.1.1.1.cmml" xref="S4.SS1.SSS1.p9.3.m3.2.2.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p9.3.m3.2.2.1.1.2.cmml" xref="S4.SS1.SSS1.p9.3.m3.2.2.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p9.3.m3.2.2.1.1.3.cmml" xref="S4.SS1.SSS1.p9.3.m3.2.2.1.1.3">L</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.3.m3.2c">\left[{\bm{y}};\bm{h}_{\mathrm{L}}\right]</annotation></semantics></math>.
We define the forward (noising) process with <math id="S4.SS1.SSS1.p9.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS1.SSS1.p9.4.m4.1a"><mi id="S4.SS1.SSS1.p9.4.m4.1.1" xref="S4.SS1.SSS1.p9.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.4.m4.1b"><ci id="S4.SS1.SSS1.p9.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p9.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.4.m4.1c">T</annotation></semantics></math> steps as:</p>
<table id="S4.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equationgroup ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6X.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle q\left(\bm{h}_{\mathrm{N},t}\mid\bm{h}_{\mathrm{N},t-1}\right)" display="inline"><semantics id="S4.E6X.2.1.1.m1.5a"><mrow id="S4.E6X.2.1.1.m1.5.5" xref="S4.E6X.2.1.1.m1.5.5.cmml"><mi id="S4.E6X.2.1.1.m1.5.5.3" xref="S4.E6X.2.1.1.m1.5.5.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.E6X.2.1.1.m1.5.5.2" xref="S4.E6X.2.1.1.m1.5.5.2.cmml">​</mo><mrow id="S4.E6X.2.1.1.m1.5.5.1.1" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.cmml"><mo id="S4.E6X.2.1.1.m1.5.5.1.1.2" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.cmml">(</mo><mrow id="S4.E6X.2.1.1.m1.5.5.1.1.1" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.cmml"><msub id="S4.E6X.2.1.1.m1.5.5.1.1.1.2" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.2.cmml"><mi id="S4.E6X.2.1.1.m1.5.5.1.1.1.2.2" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.2.2.cmml">𝒉</mi><mrow id="S4.E6X.2.1.1.m1.2.2.2.4" xref="S4.E6X.2.1.1.m1.2.2.2.3.cmml"><mi mathvariant="normal" id="S4.E6X.2.1.1.m1.1.1.1.1" xref="S4.E6X.2.1.1.m1.1.1.1.1.cmml">N</mi><mo id="S4.E6X.2.1.1.m1.2.2.2.4.1" xref="S4.E6X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.E6X.2.1.1.m1.2.2.2.2" xref="S4.E6X.2.1.1.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.E6X.2.1.1.m1.5.5.1.1.1.1" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.1.cmml">∣</mo><msub id="S4.E6X.2.1.1.m1.5.5.1.1.1.3" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.3.cmml"><mi id="S4.E6X.2.1.1.m1.5.5.1.1.1.3.2" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.3.2.cmml">𝒉</mi><mrow id="S4.E6X.2.1.1.m1.4.4.2.2" xref="S4.E6X.2.1.1.m1.4.4.2.3.cmml"><mi mathvariant="normal" id="S4.E6X.2.1.1.m1.3.3.1.1" xref="S4.E6X.2.1.1.m1.3.3.1.1.cmml">N</mi><mo id="S4.E6X.2.1.1.m1.4.4.2.2.2" xref="S4.E6X.2.1.1.m1.4.4.2.3.cmml">,</mo><mrow id="S4.E6X.2.1.1.m1.4.4.2.2.1" xref="S4.E6X.2.1.1.m1.4.4.2.2.1.cmml"><mi id="S4.E6X.2.1.1.m1.4.4.2.2.1.2" xref="S4.E6X.2.1.1.m1.4.4.2.2.1.2.cmml">t</mi><mo id="S4.E6X.2.1.1.m1.4.4.2.2.1.1" xref="S4.E6X.2.1.1.m1.4.4.2.2.1.1.cmml">−</mo><mn id="S4.E6X.2.1.1.m1.4.4.2.2.1.3" xref="S4.E6X.2.1.1.m1.4.4.2.2.1.3.cmml">1</mn></mrow></mrow></msub></mrow><mo id="S4.E6X.2.1.1.m1.5.5.1.1.3" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6X.2.1.1.m1.5b"><apply id="S4.E6X.2.1.1.m1.5.5.cmml" xref="S4.E6X.2.1.1.m1.5.5"><times id="S4.E6X.2.1.1.m1.5.5.2.cmml" xref="S4.E6X.2.1.1.m1.5.5.2"></times><ci id="S4.E6X.2.1.1.m1.5.5.3.cmml" xref="S4.E6X.2.1.1.m1.5.5.3">𝑞</ci><apply id="S4.E6X.2.1.1.m1.5.5.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.5.5.1.1"><csymbol cd="latexml" id="S4.E6X.2.1.1.m1.5.5.1.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.1">conditional</csymbol><apply id="S4.E6X.2.1.1.m1.5.5.1.1.1.2.cmml" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.5.5.1.1.1.2.1.cmml" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.2">subscript</csymbol><ci id="S4.E6X.2.1.1.m1.5.5.1.1.1.2.2.cmml" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.2.2">𝒉</ci><list id="S4.E6X.2.1.1.m1.2.2.2.3.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.4"><ci id="S4.E6X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E6X.2.1.1.m1.1.1.1.1">N</ci><ci id="S4.E6X.2.1.1.m1.2.2.2.2.cmml" xref="S4.E6X.2.1.1.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S4.E6X.2.1.1.m1.5.5.1.1.1.3.cmml" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6X.2.1.1.m1.5.5.1.1.1.3.1.cmml" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S4.E6X.2.1.1.m1.5.5.1.1.1.3.2.cmml" xref="S4.E6X.2.1.1.m1.5.5.1.1.1.3.2">𝒉</ci><list id="S4.E6X.2.1.1.m1.4.4.2.3.cmml" xref="S4.E6X.2.1.1.m1.4.4.2.2"><ci id="S4.E6X.2.1.1.m1.3.3.1.1.cmml" xref="S4.E6X.2.1.1.m1.3.3.1.1">N</ci><apply id="S4.E6X.2.1.1.m1.4.4.2.2.1.cmml" xref="S4.E6X.2.1.1.m1.4.4.2.2.1"><minus id="S4.E6X.2.1.1.m1.4.4.2.2.1.1.cmml" xref="S4.E6X.2.1.1.m1.4.4.2.2.1.1"></minus><ci id="S4.E6X.2.1.1.m1.4.4.2.2.1.2.cmml" xref="S4.E6X.2.1.1.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E6X.2.1.1.m1.4.4.2.2.1.3.cmml" xref="S4.E6X.2.1.1.m1.4.4.2.2.1.3">1</cn></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6X.2.1.1.m1.5c">\displaystyle q\left(\bm{h}_{\mathrm{N},t}\mid\bm{h}_{\mathrm{N},t-1}\right)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6X.3.2.2.m1.7" class="ltx_Math" alttext="\displaystyle=\mathcal{N}\left(\bm{h}_{\mathrm{N},t};\sqrt{1-\beta_{t}}\bm{h}_{\mathrm{N},t-1},\beta_{t}\mathbf{I}\right)" display="inline"><semantics id="S4.E6X.3.2.2.m1.7a"><mrow id="S4.E6X.3.2.2.m1.7.7" xref="S4.E6X.3.2.2.m1.7.7.cmml"><mi id="S4.E6X.3.2.2.m1.7.7.5" xref="S4.E6X.3.2.2.m1.7.7.5.cmml"></mi><mo id="S4.E6X.3.2.2.m1.7.7.4" xref="S4.E6X.3.2.2.m1.7.7.4.cmml">=</mo><mrow id="S4.E6X.3.2.2.m1.7.7.3" xref="S4.E6X.3.2.2.m1.7.7.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6X.3.2.2.m1.7.7.3.5" xref="S4.E6X.3.2.2.m1.7.7.3.5.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.7.7.3.4" xref="S4.E6X.3.2.2.m1.7.7.3.4.cmml">​</mo><mrow id="S4.E6X.3.2.2.m1.7.7.3.3.3" xref="S4.E6X.3.2.2.m1.7.7.3.3.4.cmml"><mo id="S4.E6X.3.2.2.m1.7.7.3.3.3.4" xref="S4.E6X.3.2.2.m1.7.7.3.3.4.cmml">(</mo><msub id="S4.E6X.3.2.2.m1.5.5.1.1.1.1" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.1.cmml"><mi id="S4.E6X.3.2.2.m1.5.5.1.1.1.1.2" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.1.2.cmml">𝒉</mi><mrow id="S4.E6X.3.2.2.m1.2.2.2.4" xref="S4.E6X.3.2.2.m1.2.2.2.3.cmml"><mi mathvariant="normal" id="S4.E6X.3.2.2.m1.1.1.1.1" xref="S4.E6X.3.2.2.m1.1.1.1.1.cmml">N</mi><mo id="S4.E6X.3.2.2.m1.2.2.2.4.1" xref="S4.E6X.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S4.E6X.3.2.2.m1.2.2.2.2" xref="S4.E6X.3.2.2.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.E6X.3.2.2.m1.7.7.3.3.3.5" xref="S4.E6X.3.2.2.m1.7.7.3.3.4.cmml">;</mo><mrow id="S4.E6X.3.2.2.m1.6.6.2.2.2.2" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.cmml"><msqrt id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.cmml"><mrow id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.cmml"><mn id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.2" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.2.cmml">1</mn><mo id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.1" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.1.cmml">−</mo><msub id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.cmml"><mi id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.2" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.2.cmml">β</mi><mi id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.3" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.1" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.1.cmml">​</mo><msub id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3.cmml"><mi id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3.2" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3.2.cmml">𝒉</mi><mrow id="S4.E6X.3.2.2.m1.4.4.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.3.cmml"><mi mathvariant="normal" id="S4.E6X.3.2.2.m1.3.3.1.1" xref="S4.E6X.3.2.2.m1.3.3.1.1.cmml">N</mi><mo id="S4.E6X.3.2.2.m1.4.4.2.2.2" xref="S4.E6X.3.2.2.m1.4.4.2.3.cmml">,</mo><mrow id="S4.E6X.3.2.2.m1.4.4.2.2.1" xref="S4.E6X.3.2.2.m1.4.4.2.2.1.cmml"><mi id="S4.E6X.3.2.2.m1.4.4.2.2.1.2" xref="S4.E6X.3.2.2.m1.4.4.2.2.1.2.cmml">t</mi><mo id="S4.E6X.3.2.2.m1.4.4.2.2.1.1" xref="S4.E6X.3.2.2.m1.4.4.2.2.1.1.cmml">−</mo><mn id="S4.E6X.3.2.2.m1.4.4.2.2.1.3" xref="S4.E6X.3.2.2.m1.4.4.2.2.1.3.cmml">1</mn></mrow></mrow></msub></mrow><mo id="S4.E6X.3.2.2.m1.7.7.3.3.3.6" xref="S4.E6X.3.2.2.m1.7.7.3.3.4.cmml">,</mo><mrow id="S4.E6X.3.2.2.m1.7.7.3.3.3.3" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.cmml"><msub id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.cmml"><mi id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.2" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.2.cmml">β</mi><mi id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.3" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.1" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.1.cmml">​</mo><mi id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.3" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.3.cmml">𝐈</mi></mrow><mo id="S4.E6X.3.2.2.m1.7.7.3.3.3.7" xref="S4.E6X.3.2.2.m1.7.7.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6X.3.2.2.m1.7b"><apply id="S4.E6X.3.2.2.m1.7.7.cmml" xref="S4.E6X.3.2.2.m1.7.7"><eq id="S4.E6X.3.2.2.m1.7.7.4.cmml" xref="S4.E6X.3.2.2.m1.7.7.4"></eq><csymbol cd="latexml" id="S4.E6X.3.2.2.m1.7.7.5.cmml" xref="S4.E6X.3.2.2.m1.7.7.5">absent</csymbol><apply id="S4.E6X.3.2.2.m1.7.7.3.cmml" xref="S4.E6X.3.2.2.m1.7.7.3"><times id="S4.E6X.3.2.2.m1.7.7.3.4.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.4"></times><ci id="S4.E6X.3.2.2.m1.7.7.3.5.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.5">𝒩</ci><list id="S4.E6X.3.2.2.m1.7.7.3.3.4.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.3.3"><apply id="S4.E6X.3.2.2.m1.5.5.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.5.5.1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.5.5.1.1.1.1.2.cmml" xref="S4.E6X.3.2.2.m1.5.5.1.1.1.1.2">𝒉</ci><list id="S4.E6X.3.2.2.m1.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.4"><ci id="S4.E6X.3.2.2.m1.1.1.1.1.cmml" xref="S4.E6X.3.2.2.m1.1.1.1.1">N</ci><ci id="S4.E6X.3.2.2.m1.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2"><times id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.1.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.1"></times><apply id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2"><root id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2a.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2"></root><apply id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2"><minus id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.1"></minus><cn type="integer" id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.2">1</cn><apply id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.1.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.2.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.2">𝛽</ci><ci id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.3.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3.1.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3.2.cmml" xref="S4.E6X.3.2.2.m1.6.6.2.2.2.2.3.2">𝒉</ci><list id="S4.E6X.3.2.2.m1.4.4.2.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2"><ci id="S4.E6X.3.2.2.m1.3.3.1.1.cmml" xref="S4.E6X.3.2.2.m1.3.3.1.1">N</ci><apply id="S4.E6X.3.2.2.m1.4.4.2.2.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.1"><minus id="S4.E6X.3.2.2.m1.4.4.2.2.1.1.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.1.1"></minus><ci id="S4.E6X.3.2.2.m1.4.4.2.2.1.2.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S4.E6X.3.2.2.m1.4.4.2.2.1.3.cmml" xref="S4.E6X.3.2.2.m1.4.4.2.2.1.3">1</cn></apply></list></apply></apply><apply id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3"><times id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.1.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.1"></times><apply id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2"><csymbol cd="ambiguous" id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.1.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2">subscript</csymbol><ci id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.2.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.2">𝛽</ci><ci id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.3.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.2.3">𝑡</ci></apply><ci id="S4.E6X.3.2.2.m1.7.7.3.3.3.3.3.cmml" xref="S4.E6X.3.2.2.m1.7.7.3.3.3.3.3">𝐈</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6X.3.2.2.m1.7c">\displaystyle=\mathcal{N}\left(\bm{h}_{\mathrm{N},t};\sqrt{1-\beta_{t}}\bm{h}_{\mathrm{N},t-1},\beta_{t}\mathbf{I}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S4.E6Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{z}_{t}" display="inline"><semantics id="S4.E6Xa.2.1.1.m1.1a"><msub id="S4.E6Xa.2.1.1.m1.1.1" xref="S4.E6Xa.2.1.1.m1.1.1.cmml"><mi id="S4.E6Xa.2.1.1.m1.1.1.2" xref="S4.E6Xa.2.1.1.m1.1.1.2.cmml">𝒛</mi><mi id="S4.E6Xa.2.1.1.m1.1.1.3" xref="S4.E6Xa.2.1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E6Xa.2.1.1.m1.1b"><apply id="S4.E6Xa.2.1.1.m1.1.1.cmml" xref="S4.E6Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E6Xa.2.1.1.m1.1.1.1.cmml" xref="S4.E6Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.E6Xa.2.1.1.m1.1.1.2.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.2">𝒛</ci><ci id="S4.E6Xa.2.1.1.m1.1.1.3.cmml" xref="S4.E6Xa.2.1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6Xa.2.1.1.m1.1c">\displaystyle\bm{z}_{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E6Xa.3.2.2.m1.5" class="ltx_Math" alttext="\displaystyle\coloneqq\left[{\bm{y}};\bm{h}_{\mathrm{L}};\bm{h}_{\mathrm{N},t}\right]" display="inline"><semantics id="S4.E6Xa.3.2.2.m1.5a"><mrow id="S4.E6Xa.3.2.2.m1.5.5" xref="S4.E6Xa.3.2.2.m1.5.5.cmml"><mi id="S4.E6Xa.3.2.2.m1.5.5.4" xref="S4.E6Xa.3.2.2.m1.5.5.4.cmml"></mi><mo id="S4.E6Xa.3.2.2.m1.5.5.3" xref="S4.E6Xa.3.2.2.m1.5.5.3.cmml">≔</mo><mrow id="S4.E6Xa.3.2.2.m1.5.5.2.2" xref="S4.E6Xa.3.2.2.m1.5.5.2.3.cmml"><mo id="S4.E6Xa.3.2.2.m1.5.5.2.2.3" xref="S4.E6Xa.3.2.2.m1.5.5.2.3.cmml">[</mo><mi id="S4.E6Xa.3.2.2.m1.3.3" xref="S4.E6Xa.3.2.2.m1.3.3.cmml">𝒚</mi><mo id="S4.E6Xa.3.2.2.m1.5.5.2.2.4" xref="S4.E6Xa.3.2.2.m1.5.5.2.3.cmml">;</mo><msub id="S4.E6Xa.3.2.2.m1.4.4.1.1.1" xref="S4.E6Xa.3.2.2.m1.4.4.1.1.1.cmml"><mi id="S4.E6Xa.3.2.2.m1.4.4.1.1.1.2" xref="S4.E6Xa.3.2.2.m1.4.4.1.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.E6Xa.3.2.2.m1.4.4.1.1.1.3" xref="S4.E6Xa.3.2.2.m1.4.4.1.1.1.3.cmml">L</mi></msub><mo id="S4.E6Xa.3.2.2.m1.5.5.2.2.5" xref="S4.E6Xa.3.2.2.m1.5.5.2.3.cmml">;</mo><msub id="S4.E6Xa.3.2.2.m1.5.5.2.2.2" xref="S4.E6Xa.3.2.2.m1.5.5.2.2.2.cmml"><mi id="S4.E6Xa.3.2.2.m1.5.5.2.2.2.2" xref="S4.E6Xa.3.2.2.m1.5.5.2.2.2.2.cmml">𝒉</mi><mrow id="S4.E6Xa.3.2.2.m1.2.2.2.4" xref="S4.E6Xa.3.2.2.m1.2.2.2.3.cmml"><mi mathvariant="normal" id="S4.E6Xa.3.2.2.m1.1.1.1.1" xref="S4.E6Xa.3.2.2.m1.1.1.1.1.cmml">N</mi><mo id="S4.E6Xa.3.2.2.m1.2.2.2.4.1" xref="S4.E6Xa.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S4.E6Xa.3.2.2.m1.2.2.2.2" xref="S4.E6Xa.3.2.2.m1.2.2.2.2.cmml">t</mi></mrow></msub><mo id="S4.E6Xa.3.2.2.m1.5.5.2.2.6" xref="S4.E6Xa.3.2.2.m1.5.5.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6Xa.3.2.2.m1.5b"><apply id="S4.E6Xa.3.2.2.m1.5.5.cmml" xref="S4.E6Xa.3.2.2.m1.5.5"><ci id="S4.E6Xa.3.2.2.m1.5.5.3.cmml" xref="S4.E6Xa.3.2.2.m1.5.5.3">≔</ci><csymbol cd="latexml" id="S4.E6Xa.3.2.2.m1.5.5.4.cmml" xref="S4.E6Xa.3.2.2.m1.5.5.4">absent</csymbol><list id="S4.E6Xa.3.2.2.m1.5.5.2.3.cmml" xref="S4.E6Xa.3.2.2.m1.5.5.2.2"><ci id="S4.E6Xa.3.2.2.m1.3.3.cmml" xref="S4.E6Xa.3.2.2.m1.3.3">𝒚</ci><apply id="S4.E6Xa.3.2.2.m1.4.4.1.1.1.cmml" xref="S4.E6Xa.3.2.2.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.E6Xa.3.2.2.m1.4.4.1.1.1.1.cmml" xref="S4.E6Xa.3.2.2.m1.4.4.1.1.1">subscript</csymbol><ci id="S4.E6Xa.3.2.2.m1.4.4.1.1.1.2.cmml" xref="S4.E6Xa.3.2.2.m1.4.4.1.1.1.2">𝒉</ci><ci id="S4.E6Xa.3.2.2.m1.4.4.1.1.1.3.cmml" xref="S4.E6Xa.3.2.2.m1.4.4.1.1.1.3">L</ci></apply><apply id="S4.E6Xa.3.2.2.m1.5.5.2.2.2.cmml" xref="S4.E6Xa.3.2.2.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="S4.E6Xa.3.2.2.m1.5.5.2.2.2.1.cmml" xref="S4.E6Xa.3.2.2.m1.5.5.2.2.2">subscript</csymbol><ci id="S4.E6Xa.3.2.2.m1.5.5.2.2.2.2.cmml" xref="S4.E6Xa.3.2.2.m1.5.5.2.2.2.2">𝒉</ci><list id="S4.E6Xa.3.2.2.m1.2.2.2.3.cmml" xref="S4.E6Xa.3.2.2.m1.2.2.2.4"><ci id="S4.E6Xa.3.2.2.m1.1.1.1.1.cmml" xref="S4.E6Xa.3.2.2.m1.1.1.1.1">N</ci><ci id="S4.E6Xa.3.2.2.m1.2.2.2.2.cmml" xref="S4.E6Xa.3.2.2.m1.2.2.2.2">𝑡</ci></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6Xa.3.2.2.m1.5c">\displaystyle\coloneqq\left[{\bm{y}};\bm{h}_{\mathrm{L}};\bm{h}_{\mathrm{N},t}\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.SSS1.p9.10" class="ltx_p">where <math id="S4.SS1.SSS1.p9.5.m1.2" class="ltx_Math" alttext="\bm{h}_{\mathrm{N},0}\coloneqq\bm{h}_{\mathrm{N}}" display="inline"><semantics id="S4.SS1.SSS1.p9.5.m1.2a"><mrow id="S4.SS1.SSS1.p9.5.m1.2.3" xref="S4.SS1.SSS1.p9.5.m1.2.3.cmml"><msub id="S4.SS1.SSS1.p9.5.m1.2.3.2" xref="S4.SS1.SSS1.p9.5.m1.2.3.2.cmml"><mi id="S4.SS1.SSS1.p9.5.m1.2.3.2.2" xref="S4.SS1.SSS1.p9.5.m1.2.3.2.2.cmml">𝒉</mi><mrow id="S4.SS1.SSS1.p9.5.m1.2.2.2.4" xref="S4.SS1.SSS1.p9.5.m1.2.2.2.3.cmml"><mi mathvariant="normal" id="S4.SS1.SSS1.p9.5.m1.1.1.1.1" xref="S4.SS1.SSS1.p9.5.m1.1.1.1.1.cmml">N</mi><mo id="S4.SS1.SSS1.p9.5.m1.2.2.2.4.1" xref="S4.SS1.SSS1.p9.5.m1.2.2.2.3.cmml">,</mo><mn id="S4.SS1.SSS1.p9.5.m1.2.2.2.2" xref="S4.SS1.SSS1.p9.5.m1.2.2.2.2.cmml">0</mn></mrow></msub><mo id="S4.SS1.SSS1.p9.5.m1.2.3.1" xref="S4.SS1.SSS1.p9.5.m1.2.3.1.cmml">≔</mo><msub id="S4.SS1.SSS1.p9.5.m1.2.3.3" xref="S4.SS1.SSS1.p9.5.m1.2.3.3.cmml"><mi id="S4.SS1.SSS1.p9.5.m1.2.3.3.2" xref="S4.SS1.SSS1.p9.5.m1.2.3.3.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p9.5.m1.2.3.3.3" xref="S4.SS1.SSS1.p9.5.m1.2.3.3.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.5.m1.2b"><apply id="S4.SS1.SSS1.p9.5.m1.2.3.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3"><ci id="S4.SS1.SSS1.p9.5.m1.2.3.1.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3.1">≔</ci><apply id="S4.SS1.SSS1.p9.5.m1.2.3.2.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.5.m1.2.3.2.1.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS1.p9.5.m1.2.3.2.2.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3.2.2">𝒉</ci><list id="S4.SS1.SSS1.p9.5.m1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.2.2.4"><ci id="S4.SS1.SSS1.p9.5.m1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p9.5.m1.1.1.1.1">N</ci><cn type="integer" id="S4.SS1.SSS1.p9.5.m1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.2.2.2">0</cn></list></apply><apply id="S4.SS1.SSS1.p9.5.m1.2.3.3.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.5.m1.2.3.3.1.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3.3">subscript</csymbol><ci id="S4.SS1.SSS1.p9.5.m1.2.3.3.2.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3.3.2">𝒉</ci><ci id="S4.SS1.SSS1.p9.5.m1.2.3.3.3.cmml" xref="S4.SS1.SSS1.p9.5.m1.2.3.3.3">N</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.5.m1.2c">\bm{h}_{\mathrm{N},0}\coloneqq\bm{h}_{\mathrm{N}}</annotation></semantics></math> and <math id="S4.SS1.SSS1.p9.6.m2.3" class="ltx_Math" alttext="\bm{z}_{0}\coloneqq\left[{\bm{y}};\bm{h}_{\mathrm{L}};\bm{h}_{\mathrm{N}}\right]" display="inline"><semantics id="S4.SS1.SSS1.p9.6.m2.3a"><mrow id="S4.SS1.SSS1.p9.6.m2.3.3" xref="S4.SS1.SSS1.p9.6.m2.3.3.cmml"><msub id="S4.SS1.SSS1.p9.6.m2.3.3.4" xref="S4.SS1.SSS1.p9.6.m2.3.3.4.cmml"><mi id="S4.SS1.SSS1.p9.6.m2.3.3.4.2" xref="S4.SS1.SSS1.p9.6.m2.3.3.4.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p9.6.m2.3.3.4.3" xref="S4.SS1.SSS1.p9.6.m2.3.3.4.3.cmml">0</mn></msub><mo id="S4.SS1.SSS1.p9.6.m2.3.3.3" xref="S4.SS1.SSS1.p9.6.m2.3.3.3.cmml">≔</mo><mrow id="S4.SS1.SSS1.p9.6.m2.3.3.2.2" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.3.cmml"><mo id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.3" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.3.cmml">[</mo><mi id="S4.SS1.SSS1.p9.6.m2.1.1" xref="S4.SS1.SSS1.p9.6.m2.1.1.cmml">𝒚</mi><mo id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.4" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.3.cmml">;</mo><msub id="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1" xref="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.2" xref="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.3" xref="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.3.cmml">L</mi></msub><mo id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.5" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.3.cmml">;</mo><msub id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.2" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.3" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.3.cmml">N</mi></msub><mo id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.6" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.6.m2.3b"><apply id="S4.SS1.SSS1.p9.6.m2.3.3.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3"><ci id="S4.SS1.SSS1.p9.6.m2.3.3.3.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.3">≔</ci><apply id="S4.SS1.SSS1.p9.6.m2.3.3.4.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.6.m2.3.3.4.1.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.4">subscript</csymbol><ci id="S4.SS1.SSS1.p9.6.m2.3.3.4.2.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.4.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p9.6.m2.3.3.4.3.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.4.3">0</cn></apply><list id="S4.SS1.SSS1.p9.6.m2.3.3.2.3.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.2"><ci id="S4.SS1.SSS1.p9.6.m2.1.1.cmml" xref="S4.SS1.SSS1.p9.6.m2.1.1">𝒚</ci><apply id="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.cmml" xref="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS1.p9.6.m2.2.2.1.1.1.3">L</ci></apply><apply id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.1.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.2">𝒉</ci><ci id="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.3.cmml" xref="S4.SS1.SSS1.p9.6.m2.3.3.2.2.2.3">N</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.6.m2.3c">\bm{z}_{0}\coloneqq\left[{\bm{y}};\bm{h}_{\mathrm{L}};\bm{h}_{\mathrm{N}}\right]</annotation></semantics></math>, which means that at each step we incrementally add Gaussian noise on the part of <math id="S4.SS1.SSS1.p9.7.m3.1" class="ltx_Math" alttext="\bm{h}_{\mathrm{N}}" display="inline"><semantics id="S4.SS1.SSS1.p9.7.m3.1a"><msub id="S4.SS1.SSS1.p9.7.m3.1.1" xref="S4.SS1.SSS1.p9.7.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p9.7.m3.1.1.2" xref="S4.SS1.SSS1.p9.7.m3.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p9.7.m3.1.1.3" xref="S4.SS1.SSS1.p9.7.m3.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.7.m3.1b"><apply id="S4.SS1.SSS1.p9.7.m3.1.1.cmml" xref="S4.SS1.SSS1.p9.7.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.7.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p9.7.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p9.7.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p9.7.m3.1.1.2">𝒉</ci><ci id="S4.SS1.SSS1.p9.7.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p9.7.m3.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.7.m3.1c">\bm{h}_{\mathrm{N}}</annotation></semantics></math> only, while keeping the condition part unchanged. <math id="S4.SS1.SSS1.p9.8.m4.1" class="ltx_Math" alttext="\beta_{t}" display="inline"><semantics id="S4.SS1.SSS1.p9.8.m4.1a"><msub id="S4.SS1.SSS1.p9.8.m4.1.1" xref="S4.SS1.SSS1.p9.8.m4.1.1.cmml"><mi id="S4.SS1.SSS1.p9.8.m4.1.1.2" xref="S4.SS1.SSS1.p9.8.m4.1.1.2.cmml">β</mi><mi id="S4.SS1.SSS1.p9.8.m4.1.1.3" xref="S4.SS1.SSS1.p9.8.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.8.m4.1b"><apply id="S4.SS1.SSS1.p9.8.m4.1.1.cmml" xref="S4.SS1.SSS1.p9.8.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.8.m4.1.1.1.cmml" xref="S4.SS1.SSS1.p9.8.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p9.8.m4.1.1.2.cmml" xref="S4.SS1.SSS1.p9.8.m4.1.1.2">𝛽</ci><ci id="S4.SS1.SSS1.p9.8.m4.1.1.3.cmml" xref="S4.SS1.SSS1.p9.8.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.8.m4.1c">\beta_{t}</annotation></semantics></math> is a hyperparameter that controls the degree of noise at each step, and after <math id="S4.SS1.SSS1.p9.9.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS1.SSS1.p9.9.m5.1a"><mi id="S4.SS1.SSS1.p9.9.m5.1.1" xref="S4.SS1.SSS1.p9.9.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.9.m5.1b"><ci id="S4.SS1.SSS1.p9.9.m5.1.1.cmml" xref="S4.SS1.SSS1.p9.9.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.9.m5.1c">T</annotation></semantics></math> steps the <math id="S4.SS1.SSS1.p9.10.m6.2" class="ltx_Math" alttext="\bm{h}_{\mathrm{N},T}" display="inline"><semantics id="S4.SS1.SSS1.p9.10.m6.2a"><msub id="S4.SS1.SSS1.p9.10.m6.2.3" xref="S4.SS1.SSS1.p9.10.m6.2.3.cmml"><mi id="S4.SS1.SSS1.p9.10.m6.2.3.2" xref="S4.SS1.SSS1.p9.10.m6.2.3.2.cmml">𝒉</mi><mrow id="S4.SS1.SSS1.p9.10.m6.2.2.2.4" xref="S4.SS1.SSS1.p9.10.m6.2.2.2.3.cmml"><mi mathvariant="normal" id="S4.SS1.SSS1.p9.10.m6.1.1.1.1" xref="S4.SS1.SSS1.p9.10.m6.1.1.1.1.cmml">N</mi><mo id="S4.SS1.SSS1.p9.10.m6.2.2.2.4.1" xref="S4.SS1.SSS1.p9.10.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS1.SSS1.p9.10.m6.2.2.2.2" xref="S4.SS1.SSS1.p9.10.m6.2.2.2.2.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p9.10.m6.2b"><apply id="S4.SS1.SSS1.p9.10.m6.2.3.cmml" xref="S4.SS1.SSS1.p9.10.m6.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p9.10.m6.2.3.1.cmml" xref="S4.SS1.SSS1.p9.10.m6.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p9.10.m6.2.3.2.cmml" xref="S4.SS1.SSS1.p9.10.m6.2.3.2">𝒉</ci><list id="S4.SS1.SSS1.p9.10.m6.2.2.2.3.cmml" xref="S4.SS1.SSS1.p9.10.m6.2.2.2.4"><ci id="S4.SS1.SSS1.p9.10.m6.1.1.1.1.cmml" xref="S4.SS1.SSS1.p9.10.m6.1.1.1.1">N</ci><ci id="S4.SS1.SSS1.p9.10.m6.2.2.2.2.cmml" xref="S4.SS1.SSS1.p9.10.m6.2.2.2.2">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p9.10.m6.2c">\bm{h}_{\mathrm{N},T}</annotation></semantics></math> is approximately Gaussian.</p>
</div>
<div id="S4.SS1.SSS1.p10" class="ltx_para">
<p id="S4.SS1.SSS1.p10.2" class="ltx_p">Further, the reverse (denoising) process is to reconstruct the original <math id="S4.SS1.SSS1.p10.1.m1.1" class="ltx_Math" alttext="\bm{z}_{0}" display="inline"><semantics id="S4.SS1.SSS1.p10.1.m1.1a"><msub id="S4.SS1.SSS1.p10.1.m1.1.1" xref="S4.SS1.SSS1.p10.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p10.1.m1.1.1.2" xref="S4.SS1.SSS1.p10.1.m1.1.1.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p10.1.m1.1.1.3" xref="S4.SS1.SSS1.p10.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.1.m1.1b"><apply id="S4.SS1.SSS1.p10.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p10.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.1.m1.1.1.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p10.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.1.m1.1c">\bm{z}_{0}</annotation></semantics></math> given <math id="S4.SS1.SSS1.p10.2.m2.1" class="ltx_Math" alttext="\bm{z}_{T}" display="inline"><semantics id="S4.SS1.SSS1.p10.2.m2.1a"><msub id="S4.SS1.SSS1.p10.2.m2.1.1" xref="S4.SS1.SSS1.p10.2.m2.1.1.cmml"><mi id="S4.SS1.SSS1.p10.2.m2.1.1.2" xref="S4.SS1.SSS1.p10.2.m2.1.1.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p10.2.m2.1.1.3" xref="S4.SS1.SSS1.p10.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.2.m2.1b"><apply id="S4.SS1.SSS1.p10.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p10.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p10.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p10.2.m2.1.1.2">𝒛</ci><ci id="S4.SS1.SSS1.p10.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p10.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.2.m2.1c">\bm{z}_{T}</annotation></semantics></math>:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.6" class="ltx_Math" alttext="p_{\Theta}(\bm{z}_{t-1}\mid\bm{z}_{t})=\mathcal{N}\left(\bm{z}_{t-1};\bm{\mu}_{\Theta}(\bm{z}_{t},t),\bm{\Sigma}_{\Theta}(\bm{z}_{t},t)\right)" display="block"><semantics id="S4.E7.m1.6a"><mrow id="S4.E7.m1.6.6" xref="S4.E7.m1.6.6.cmml"><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.cmml"><msub id="S4.E7.m1.3.3.1.3" xref="S4.E7.m1.3.3.1.3.cmml"><mi id="S4.E7.m1.3.3.1.3.2" xref="S4.E7.m1.3.3.1.3.2.cmml">p</mi><mi mathvariant="normal" id="S4.E7.m1.3.3.1.3.3" xref="S4.E7.m1.3.3.1.3.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.2.cmml">​</mo><mrow id="S4.E7.m1.3.3.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.3.3.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.cmml"><msub id="S4.E7.m1.3.3.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.2.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.2.2" xref="S4.E7.m1.3.3.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="S4.E7.m1.3.3.1.1.1.1.2.3" xref="S4.E7.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.2.3.2" xref="S4.E7.m1.3.3.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.E7.m1.3.3.1.1.1.1.2.3.1" xref="S4.E7.m1.3.3.1.1.1.1.2.3.1.cmml">−</mo><mn id="S4.E7.m1.3.3.1.1.1.1.2.3.3" xref="S4.E7.m1.3.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.E7.m1.3.3.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.cmml">∣</mo><msub id="S4.E7.m1.3.3.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.3.2" xref="S4.E7.m1.3.3.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S4.E7.m1.3.3.1.1.1.1.3.3" xref="S4.E7.m1.3.3.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.E7.m1.3.3.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.6.6.5" xref="S4.E7.m1.6.6.5.cmml">=</mo><mrow id="S4.E7.m1.6.6.4" xref="S4.E7.m1.6.6.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.6.6.4.5" xref="S4.E7.m1.6.6.4.5.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.4.4" xref="S4.E7.m1.6.6.4.4.cmml">​</mo><mrow id="S4.E7.m1.6.6.4.3.3" xref="S4.E7.m1.6.6.4.3.4.cmml"><mo id="S4.E7.m1.6.6.4.3.3.4" xref="S4.E7.m1.6.6.4.3.4.cmml">(</mo><msub id="S4.E7.m1.4.4.2.1.1.1" xref="S4.E7.m1.4.4.2.1.1.1.cmml"><mi id="S4.E7.m1.4.4.2.1.1.1.2" xref="S4.E7.m1.4.4.2.1.1.1.2.cmml">𝒛</mi><mrow id="S4.E7.m1.4.4.2.1.1.1.3" xref="S4.E7.m1.4.4.2.1.1.1.3.cmml"><mi id="S4.E7.m1.4.4.2.1.1.1.3.2" xref="S4.E7.m1.4.4.2.1.1.1.3.2.cmml">t</mi><mo id="S4.E7.m1.4.4.2.1.1.1.3.1" xref="S4.E7.m1.4.4.2.1.1.1.3.1.cmml">−</mo><mn id="S4.E7.m1.4.4.2.1.1.1.3.3" xref="S4.E7.m1.4.4.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E7.m1.6.6.4.3.3.5" xref="S4.E7.m1.6.6.4.3.4.cmml">;</mo><mrow id="S4.E7.m1.5.5.3.2.2.2" xref="S4.E7.m1.5.5.3.2.2.2.cmml"><msub id="S4.E7.m1.5.5.3.2.2.2.3" xref="S4.E7.m1.5.5.3.2.2.2.3.cmml"><mi id="S4.E7.m1.5.5.3.2.2.2.3.2" xref="S4.E7.m1.5.5.3.2.2.2.3.2.cmml">𝝁</mi><mi mathvariant="normal" id="S4.E7.m1.5.5.3.2.2.2.3.3" xref="S4.E7.m1.5.5.3.2.2.2.3.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.5.5.3.2.2.2.2" xref="S4.E7.m1.5.5.3.2.2.2.2.cmml">​</mo><mrow id="S4.E7.m1.5.5.3.2.2.2.1.1" xref="S4.E7.m1.5.5.3.2.2.2.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.5.5.3.2.2.2.1.1.2" xref="S4.E7.m1.5.5.3.2.2.2.1.2.cmml">(</mo><msub id="S4.E7.m1.5.5.3.2.2.2.1.1.1" xref="S4.E7.m1.5.5.3.2.2.2.1.1.1.cmml"><mi id="S4.E7.m1.5.5.3.2.2.2.1.1.1.2" xref="S4.E7.m1.5.5.3.2.2.2.1.1.1.2.cmml">𝒛</mi><mi id="S4.E7.m1.5.5.3.2.2.2.1.1.1.3" xref="S4.E7.m1.5.5.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S4.E7.m1.5.5.3.2.2.2.1.1.3" xref="S4.E7.m1.5.5.3.2.2.2.1.2.cmml">,</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">t</mi><mo stretchy="false" id="S4.E7.m1.5.5.3.2.2.2.1.1.4" xref="S4.E7.m1.5.5.3.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.6.6.4.3.3.6" xref="S4.E7.m1.6.6.4.3.4.cmml">,</mo><mrow id="S4.E7.m1.6.6.4.3.3.3" xref="S4.E7.m1.6.6.4.3.3.3.cmml"><msub id="S4.E7.m1.6.6.4.3.3.3.3" xref="S4.E7.m1.6.6.4.3.3.3.3.cmml"><mi id="S4.E7.m1.6.6.4.3.3.3.3.2" xref="S4.E7.m1.6.6.4.3.3.3.3.2.cmml">𝚺</mi><mi mathvariant="normal" id="S4.E7.m1.6.6.4.3.3.3.3.3" xref="S4.E7.m1.6.6.4.3.3.3.3.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.4.3.3.3.2" xref="S4.E7.m1.6.6.4.3.3.3.2.cmml">​</mo><mrow id="S4.E7.m1.6.6.4.3.3.3.1.1" xref="S4.E7.m1.6.6.4.3.3.3.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.6.6.4.3.3.3.1.1.2" xref="S4.E7.m1.6.6.4.3.3.3.1.2.cmml">(</mo><msub id="S4.E7.m1.6.6.4.3.3.3.1.1.1" xref="S4.E7.m1.6.6.4.3.3.3.1.1.1.cmml"><mi id="S4.E7.m1.6.6.4.3.3.3.1.1.1.2" xref="S4.E7.m1.6.6.4.3.3.3.1.1.1.2.cmml">𝒛</mi><mi id="S4.E7.m1.6.6.4.3.3.3.1.1.1.3" xref="S4.E7.m1.6.6.4.3.3.3.1.1.1.3.cmml">t</mi></msub><mo id="S4.E7.m1.6.6.4.3.3.3.1.1.3" xref="S4.E7.m1.6.6.4.3.3.3.1.2.cmml">,</mo><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">t</mi><mo stretchy="false" id="S4.E7.m1.6.6.4.3.3.3.1.1.4" xref="S4.E7.m1.6.6.4.3.3.3.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.6.6.4.3.3.7" xref="S4.E7.m1.6.6.4.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.6b"><apply id="S4.E7.m1.6.6.cmml" xref="S4.E7.m1.6.6"><eq id="S4.E7.m1.6.6.5.cmml" xref="S4.E7.m1.6.6.5"></eq><apply id="S4.E7.m1.3.3.1.cmml" xref="S4.E7.m1.3.3.1"><times id="S4.E7.m1.3.3.1.2.cmml" xref="S4.E7.m1.3.3.1.2"></times><apply id="S4.E7.m1.3.3.1.3.cmml" xref="S4.E7.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.3.1.cmml" xref="S4.E7.m1.3.3.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.3.2.cmml" xref="S4.E7.m1.3.3.1.3.2">𝑝</ci><ci id="S4.E7.m1.3.3.1.3.3.cmml" xref="S4.E7.m1.3.3.1.3.3">Θ</ci></apply><apply id="S4.E7.m1.3.3.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.3.3.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="S4.E7.m1.3.3.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.2.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.2">𝒛</ci><apply id="S4.E7.m1.3.3.1.1.1.1.2.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.3"><minus id="S4.E7.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.3.1"></minus><ci id="S4.E7.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.E7.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E7.m1.3.3.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3.2">𝒛</ci><ci id="S4.E7.m1.3.3.1.1.1.1.3.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S4.E7.m1.6.6.4.cmml" xref="S4.E7.m1.6.6.4"><times id="S4.E7.m1.6.6.4.4.cmml" xref="S4.E7.m1.6.6.4.4"></times><ci id="S4.E7.m1.6.6.4.5.cmml" xref="S4.E7.m1.6.6.4.5">𝒩</ci><list id="S4.E7.m1.6.6.4.3.4.cmml" xref="S4.E7.m1.6.6.4.3.3"><apply id="S4.E7.m1.4.4.2.1.1.1.cmml" xref="S4.E7.m1.4.4.2.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.2.1.1.1.1.cmml" xref="S4.E7.m1.4.4.2.1.1.1">subscript</csymbol><ci id="S4.E7.m1.4.4.2.1.1.1.2.cmml" xref="S4.E7.m1.4.4.2.1.1.1.2">𝒛</ci><apply id="S4.E7.m1.4.4.2.1.1.1.3.cmml" xref="S4.E7.m1.4.4.2.1.1.1.3"><minus id="S4.E7.m1.4.4.2.1.1.1.3.1.cmml" xref="S4.E7.m1.4.4.2.1.1.1.3.1"></minus><ci id="S4.E7.m1.4.4.2.1.1.1.3.2.cmml" xref="S4.E7.m1.4.4.2.1.1.1.3.2">𝑡</ci><cn type="integer" id="S4.E7.m1.4.4.2.1.1.1.3.3.cmml" xref="S4.E7.m1.4.4.2.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E7.m1.5.5.3.2.2.2.cmml" xref="S4.E7.m1.5.5.3.2.2.2"><times id="S4.E7.m1.5.5.3.2.2.2.2.cmml" xref="S4.E7.m1.5.5.3.2.2.2.2"></times><apply id="S4.E7.m1.5.5.3.2.2.2.3.cmml" xref="S4.E7.m1.5.5.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.3.2.2.2.3.1.cmml" xref="S4.E7.m1.5.5.3.2.2.2.3">subscript</csymbol><ci id="S4.E7.m1.5.5.3.2.2.2.3.2.cmml" xref="S4.E7.m1.5.5.3.2.2.2.3.2">𝝁</ci><ci id="S4.E7.m1.5.5.3.2.2.2.3.3.cmml" xref="S4.E7.m1.5.5.3.2.2.2.3.3">Θ</ci></apply><interval closure="open" id="S4.E7.m1.5.5.3.2.2.2.1.2.cmml" xref="S4.E7.m1.5.5.3.2.2.2.1.1"><apply id="S4.E7.m1.5.5.3.2.2.2.1.1.1.cmml" xref="S4.E7.m1.5.5.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.3.2.2.2.1.1.1.1.cmml" xref="S4.E7.m1.5.5.3.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E7.m1.5.5.3.2.2.2.1.1.1.2.cmml" xref="S4.E7.m1.5.5.3.2.2.2.1.1.1.2">𝒛</ci><ci id="S4.E7.m1.5.5.3.2.2.2.1.1.1.3.cmml" xref="S4.E7.m1.5.5.3.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝑡</ci></interval></apply><apply id="S4.E7.m1.6.6.4.3.3.3.cmml" xref="S4.E7.m1.6.6.4.3.3.3"><times id="S4.E7.m1.6.6.4.3.3.3.2.cmml" xref="S4.E7.m1.6.6.4.3.3.3.2"></times><apply id="S4.E7.m1.6.6.4.3.3.3.3.cmml" xref="S4.E7.m1.6.6.4.3.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.4.3.3.3.3.1.cmml" xref="S4.E7.m1.6.6.4.3.3.3.3">subscript</csymbol><ci id="S4.E7.m1.6.6.4.3.3.3.3.2.cmml" xref="S4.E7.m1.6.6.4.3.3.3.3.2">𝚺</ci><ci id="S4.E7.m1.6.6.4.3.3.3.3.3.cmml" xref="S4.E7.m1.6.6.4.3.3.3.3.3">Θ</ci></apply><interval closure="open" id="S4.E7.m1.6.6.4.3.3.3.1.2.cmml" xref="S4.E7.m1.6.6.4.3.3.3.1.1"><apply id="S4.E7.m1.6.6.4.3.3.3.1.1.1.cmml" xref="S4.E7.m1.6.6.4.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.4.3.3.3.1.1.1.1.cmml" xref="S4.E7.m1.6.6.4.3.3.3.1.1.1">subscript</csymbol><ci id="S4.E7.m1.6.6.4.3.3.3.1.1.1.2.cmml" xref="S4.E7.m1.6.6.4.3.3.3.1.1.1.2">𝒛</ci><ci id="S4.E7.m1.6.6.4.3.3.3.1.1.1.3.cmml" xref="S4.E7.m1.6.6.4.3.3.3.1.1.1.3">𝑡</ci></apply><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">𝑡</ci></interval></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.6c">p_{\Theta}(\bm{z}_{t-1}\mid\bm{z}_{t})=\mathcal{N}\left(\bm{z}_{t-1};\bm{\mu}_{\Theta}(\bm{z}_{t},t),\bm{\Sigma}_{\Theta}(\bm{z}_{t},t)\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS1.p10.7" class="ltx_p">where <math id="S4.SS1.SSS1.p10.3.m1.2" class="ltx_Math" alttext="\bm{\mu}_{\Theta}(\bm{z}_{t},t)" display="inline"><semantics id="S4.SS1.SSS1.p10.3.m1.2a"><mrow id="S4.SS1.SSS1.p10.3.m1.2.2" xref="S4.SS1.SSS1.p10.3.m1.2.2.cmml"><msub id="S4.SS1.SSS1.p10.3.m1.2.2.3" xref="S4.SS1.SSS1.p10.3.m1.2.2.3.cmml"><mi id="S4.SS1.SSS1.p10.3.m1.2.2.3.2" xref="S4.SS1.SSS1.p10.3.m1.2.2.3.2.cmml">𝝁</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p10.3.m1.2.2.3.3" xref="S4.SS1.SSS1.p10.3.m1.2.2.3.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.3.m1.2.2.2" xref="S4.SS1.SSS1.p10.3.m1.2.2.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.3.m1.2.2.1.1" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.2" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.2.cmml">(</mo><msub id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.2" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.3" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.3" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.2.cmml">,</mo><mi id="S4.SS1.SSS1.p10.3.m1.1.1" xref="S4.SS1.SSS1.p10.3.m1.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.4" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.3.m1.2b"><apply id="S4.SS1.SSS1.p10.3.m1.2.2.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2"><times id="S4.SS1.SSS1.p10.3.m1.2.2.2.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.2"></times><apply id="S4.SS1.SSS1.p10.3.m1.2.2.3.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.3.m1.2.2.3.1.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p10.3.m1.2.2.3.2.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.3.2">𝝁</ci><ci id="S4.SS1.SSS1.p10.3.m1.2.2.3.3.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.3.3">Θ</ci></apply><interval closure="open" id="S4.SS1.SSS1.p10.3.m1.2.2.1.2.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.1"><apply id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.2">𝒛</ci><ci id="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.3.m1.2.2.1.1.1.3">𝑡</ci></apply><ci id="S4.SS1.SSS1.p10.3.m1.1.1.cmml" xref="S4.SS1.SSS1.p10.3.m1.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.3.m1.2c">\bm{\mu}_{\Theta}(\bm{z}_{t},t)</annotation></semantics></math> and <math id="S4.SS1.SSS1.p10.4.m2.2" class="ltx_Math" alttext="\bm{\Sigma}_{\Theta}(\bm{z}_{t},t)" display="inline"><semantics id="S4.SS1.SSS1.p10.4.m2.2a"><mrow id="S4.SS1.SSS1.p10.4.m2.2.2" xref="S4.SS1.SSS1.p10.4.m2.2.2.cmml"><msub id="S4.SS1.SSS1.p10.4.m2.2.2.3" xref="S4.SS1.SSS1.p10.4.m2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p10.4.m2.2.2.3.2" xref="S4.SS1.SSS1.p10.4.m2.2.2.3.2.cmml">𝚺</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p10.4.m2.2.2.3.3" xref="S4.SS1.SSS1.p10.4.m2.2.2.3.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.4.m2.2.2.2" xref="S4.SS1.SSS1.p10.4.m2.2.2.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.4.m2.2.2.1.1" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.2" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.2.cmml">(</mo><msub id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.2" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.3" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.3" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.2.cmml">,</mo><mi id="S4.SS1.SSS1.p10.4.m2.1.1" xref="S4.SS1.SSS1.p10.4.m2.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.4" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.4.m2.2b"><apply id="S4.SS1.SSS1.p10.4.m2.2.2.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2"><times id="S4.SS1.SSS1.p10.4.m2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.2"></times><apply id="S4.SS1.SSS1.p10.4.m2.2.2.3.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.4.m2.2.2.3.1.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p10.4.m2.2.2.3.2.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.3.2">𝚺</ci><ci id="S4.SS1.SSS1.p10.4.m2.2.2.3.3.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.3.3">Θ</ci></apply><interval closure="open" id="S4.SS1.SSS1.p10.4.m2.2.2.1.2.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.1"><apply id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.2">𝒛</ci><ci id="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.4.m2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S4.SS1.SSS1.p10.4.m2.1.1.cmml" xref="S4.SS1.SSS1.p10.4.m2.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.4.m2.2c">\bm{\Sigma}_{\Theta}(\bm{z}_{t},t)</annotation></semantics></math> are the predicted mean and standard deviation of <math id="S4.SS1.SSS1.p10.5.m3.1" class="ltx_Math" alttext="p_{\Theta}(\bm{z}_{t-1}\mid\bm{z}_{t})" display="inline"><semantics id="S4.SS1.SSS1.p10.5.m3.1a"><mrow id="S4.SS1.SSS1.p10.5.m3.1.1" xref="S4.SS1.SSS1.p10.5.m3.1.1.cmml"><msub id="S4.SS1.SSS1.p10.5.m3.1.1.3" xref="S4.SS1.SSS1.p10.5.m3.1.1.3.cmml"><mi id="S4.SS1.SSS1.p10.5.m3.1.1.3.2" xref="S4.SS1.SSS1.p10.5.m3.1.1.3.2.cmml">p</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p10.5.m3.1.1.3.3" xref="S4.SS1.SSS1.p10.5.m3.1.1.3.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.5.m3.1.1.2" xref="S4.SS1.SSS1.p10.5.m3.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.5.m3.1.1.1.1" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.2" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.cmml"><msub id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.cmml"><mi id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.cmml"><mi id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.2" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.1" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.3" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.1" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.1.cmml">∣</mo><msub id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.2" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.3" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.3" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.5.m3.1b"><apply id="S4.SS1.SSS1.p10.5.m3.1.1.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1"><times id="S4.SS1.SSS1.p10.5.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.2"></times><apply id="S4.SS1.SSS1.p10.5.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.5.m3.1.1.3.1.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p10.5.m3.1.1.3.2.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.3.2">𝑝</ci><ci id="S4.SS1.SSS1.p10.5.m3.1.1.3.3.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.3.3">Θ</ci></apply><apply id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.2">𝒛</ci><apply id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3"><minus id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.1.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.1"></minus><ci id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.2.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.3.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.2">𝒛</ci><ci id="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p10.5.m3.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.5.m3.1c">p_{\Theta}(\bm{z}_{t-1}\mid\bm{z}_{t})</annotation></semantics></math> respectively, parameterized by learnable <math id="S4.SS1.SSS1.p10.6.m4.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S4.SS1.SSS1.p10.6.m4.1a"><mi mathvariant="normal" id="S4.SS1.SSS1.p10.6.m4.1.1" xref="S4.SS1.SSS1.p10.6.m4.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.6.m4.1b"><ci id="S4.SS1.SSS1.p10.6.m4.1.1.cmml" xref="S4.SS1.SSS1.p10.6.m4.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.6.m4.1c">\Theta</annotation></semantics></math>.
The objective is to maximize the marginal likelihood <math id="S4.SS1.SSS1.p10.7.m5.2" class="ltx_Math" alttext="\mathbb{E}_{q(\bm{z}_{0})}\left[\log p_{\Theta}(\bm{z}_{0})\right]" display="inline"><semantics id="S4.SS1.SSS1.p10.7.m5.2a"><mrow id="S4.SS1.SSS1.p10.7.m5.2.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.cmml"><msub id="S4.SS1.SSS1.p10.7.m5.2.2.3" xref="S4.SS1.SSS1.p10.7.m5.2.2.3.cmml"><mi id="S4.SS1.SSS1.p10.7.m5.2.2.3.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.3.2.cmml">𝔼</mi><mrow id="S4.SS1.SSS1.p10.7.m5.1.1.1" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.cmml"><mi id="S4.SS1.SSS1.p10.7.m5.1.1.1.3" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.7.m5.1.1.1.2" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.2" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.7.m5.2.2.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.7.m5.2.2.1.1" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.2.cmml"><mo id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.2.1.cmml">[</mo><mrow id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.cmml"><mrow id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.1" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3a" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.cmml">⁡</mo><msub id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.cmml"><mi id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.2.cmml">p</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.3" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.3.cmml">Θ</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.3.cmml">0</mn></msub><mo stretchy="false" id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.3" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.7.m5.2b"><apply id="S4.SS1.SSS1.p10.7.m5.2.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2"><times id="S4.SS1.SSS1.p10.7.m5.2.2.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.2"></times><apply id="S4.SS1.SSS1.p10.7.m5.2.2.3.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.7.m5.2.2.3.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p10.7.m5.2.2.3.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.3.2">𝔼</ci><apply id="S4.SS1.SSS1.p10.7.m5.1.1.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.1.1.1"><times id="S4.SS1.SSS1.p10.7.m5.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.2"></times><ci id="S4.SS1.SSS1.p10.7.m5.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.3">𝑞</ci><apply id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.7.m5.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S4.SS1.SSS1.p10.7.m5.2.2.1.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p10.7.m5.2.2.1.2.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.2">delimited-[]</csymbol><apply id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1"><times id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.2"></times><apply id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3"><log id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.1"></log><apply id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.2">𝑝</ci><ci id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.3.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.3.2.3">Θ</ci></apply></apply><apply id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.7.m5.2.2.1.1.1.1.1.1.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.7.m5.2c">\mathbb{E}_{q(\bm{z}_{0})}\left[\log p_{\Theta}(\bm{z}_{0})\right]</annotation></semantics></math>, and it can be optimized using the variational lower bound <cite class="ltx_cite ltx_citemacro_citep">(Sohl-Dickstein et al<span class="ltx_text">.</span>, <a href="#bib.bib31" title="" class="ltx_ref">2015</a>)</cite>.
In practice, we follow <span id="S4.SS1.SSS1.p10.7.1" class="ltx_text ltx_font_sansserif">DDPM</span> <cite class="ltx_cite ltx_citemacro_citep">(Ho
et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> to use a simplified form that the training stability has been empirically proved:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.3" class="ltx_Math" alttext="\mathcal{L}_{\mathrm{DDPM}}=\sum_{t=1}^{T}\mathbb{E}_{q(\bm{z}_{t}\mid\bm{z}_{0})}\left[\lVert\tilde{\bm{\mu}}_{t}(\bm{z}_{t},\bm{z}_{0})-\bm{\mu}_{\Theta}(\bm{z}_{t},t)\rVert^{2}\right]" display="block"><semantics id="S4.E8.m1.3a"><mrow id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml"><msub id="S4.E8.m1.3.3.3" xref="S4.E8.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.3.3.3.2" xref="S4.E8.m1.3.3.3.2.cmml">ℒ</mi><mi id="S4.E8.m1.3.3.3.3" xref="S4.E8.m1.3.3.3.3.cmml">DDPM</mi></msub><mo rspace="0.111em" id="S4.E8.m1.3.3.2" xref="S4.E8.m1.3.3.2.cmml">=</mo><mrow id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.cmml"><munderover id="S4.E8.m1.3.3.1.2" xref="S4.E8.m1.3.3.1.2.cmml"><mo movablelimits="false" id="S4.E8.m1.3.3.1.2.2.2" xref="S4.E8.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="S4.E8.m1.3.3.1.2.2.3" xref="S4.E8.m1.3.3.1.2.2.3.cmml"><mi id="S4.E8.m1.3.3.1.2.2.3.2" xref="S4.E8.m1.3.3.1.2.2.3.2.cmml">t</mi><mo id="S4.E8.m1.3.3.1.2.2.3.1" xref="S4.E8.m1.3.3.1.2.2.3.1.cmml">=</mo><mn id="S4.E8.m1.3.3.1.2.2.3.3" xref="S4.E8.m1.3.3.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E8.m1.3.3.1.2.3" xref="S4.E8.m1.3.3.1.2.3.cmml">T</mi></munderover><mrow id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml"><msub id="S4.E8.m1.3.3.1.1.3" xref="S4.E8.m1.3.3.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.3.2" xref="S4.E8.m1.3.3.1.1.3.2.cmml">𝔼</mi><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><msub id="S4.E8.m1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mi id="S4.E8.m1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mn id="S4.E8.m1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.1.2" xref="S4.E8.m1.3.3.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.3.3.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.2.cmml"><mo id="S4.E8.m1.3.3.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.2.1.cmml">[</mo><msup id="S4.E8.m1.3.3.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml"><mo fence="true" lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.cmml">∥</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.cmml"><mover accent="true" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.2.cmml">𝝁</mi><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.1.cmml">~</mo></mover><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝒛</mi><mn id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">0</mn></msub><mo stretchy="false" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.5" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.4.cmml">−</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml">𝝁</mi><mi mathvariant="normal" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">​</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.2.cmml">(</mo><msub id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml">𝒛</mi><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.3.cmml">t</mi></msub><mo id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.2.cmml">,</mo><mi id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml">t</mi><mo stretchy="false" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.4" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.2.cmml">)</mo></mrow></mrow></mrow><mo fence="true" lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.cmml">∥</mo></mrow><mn id="S4.E8.m1.3.3.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.E8.m1.3.3.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.3b"><apply id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3"><eq id="S4.E8.m1.3.3.2.cmml" xref="S4.E8.m1.3.3.2"></eq><apply id="S4.E8.m1.3.3.3.cmml" xref="S4.E8.m1.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.1.cmml" xref="S4.E8.m1.3.3.3">subscript</csymbol><ci id="S4.E8.m1.3.3.3.2.cmml" xref="S4.E8.m1.3.3.3.2">ℒ</ci><ci id="S4.E8.m1.3.3.3.3.cmml" xref="S4.E8.m1.3.3.3.3">DDPM</ci></apply><apply id="S4.E8.m1.3.3.1.cmml" xref="S4.E8.m1.3.3.1"><apply id="S4.E8.m1.3.3.1.2.cmml" xref="S4.E8.m1.3.3.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.2.1.cmml" xref="S4.E8.m1.3.3.1.2">superscript</csymbol><apply id="S4.E8.m1.3.3.1.2.2.cmml" xref="S4.E8.m1.3.3.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.2.2.1.cmml" xref="S4.E8.m1.3.3.1.2">subscript</csymbol><sum id="S4.E8.m1.3.3.1.2.2.2.cmml" xref="S4.E8.m1.3.3.1.2.2.2"></sum><apply id="S4.E8.m1.3.3.1.2.2.3.cmml" xref="S4.E8.m1.3.3.1.2.2.3"><eq id="S4.E8.m1.3.3.1.2.2.3.1.cmml" xref="S4.E8.m1.3.3.1.2.2.3.1"></eq><ci id="S4.E8.m1.3.3.1.2.2.3.2.cmml" xref="S4.E8.m1.3.3.1.2.2.3.2">𝑡</ci><cn type="integer" id="S4.E8.m1.3.3.1.2.2.3.3.cmml" xref="S4.E8.m1.3.3.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E8.m1.3.3.1.2.3.cmml" xref="S4.E8.m1.3.3.1.2.3">𝑇</ci></apply><apply id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1"><times id="S4.E8.m1.3.3.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2"></times><apply id="S4.E8.m1.3.3.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.3.2">𝔼</ci><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><times id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"></times><ci id="S4.E8.m1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.3">𝑞</ci><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2.2">𝒛</ci><ci id="S4.E8.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.2">𝒛</ci><cn type="integer" id="S4.E8.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply></apply><apply id="S4.E8.m1.3.3.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.3.3.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.2">delimited-∥∥</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.4"></minus><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2"><times id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.3"></times><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4">subscript</csymbol><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2"><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.1">~</ci><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.2.2">𝝁</ci></apply><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.4.3">𝑡</ci></apply><interval closure="open" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2"><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒛</ci><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2">𝒛</ci><cn type="integer" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3">0</cn></apply></interval></apply><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3"><times id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.2"></times><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.2">𝝁</ci><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.3.3">Θ</ci></apply><interval closure="open" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1"><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.2">𝒛</ci><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.1.3.1.1.1.3">𝑡</ci></apply><ci id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">𝑡</ci></interval></apply></apply></apply><cn type="integer" id="S4.E8.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.3c">\mathcal{L}_{\mathrm{DDPM}}=\sum_{t=1}^{T}\mathbb{E}_{q(\bm{z}_{t}\mid\bm{z}_{0})}\left[\lVert\tilde{\bm{\mu}}_{t}(\bm{z}_{t},\bm{z}_{0})-\bm{\mu}_{\Theta}(\bm{z}_{t},t)\rVert^{2}\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.SSS1.p10.10" class="ltx_p">where <math id="S4.SS1.SSS1.p10.8.m1.3" class="ltx_Math" alttext="\tilde{\bm{\mu}}_{t}(\bm{z}_{t},\bm{z}_{0})=\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1-\bar{\alpha}_{t}}\bm{z}_{t}+\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha}_{t}}\bm{z}_{0}" display="inline"><semantics id="S4.SS1.SSS1.p10.8.m1.3a"><mrow id="S4.SS1.SSS1.p10.8.m1.3.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.cmml"><mrow id="S4.SS1.SSS1.p10.8.m1.3.3.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.cmml"><msub id="S4.SS1.SSS1.p10.8.m1.3.3.2.4" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.cmml"><mover accent="true" id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.2.cmml">𝝁</mi><mo id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.1.cmml">~</mo></mover><mi id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.8.m1.3.3.2.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.3.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.3.cmml">(</mo><msub id="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1" xref="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.2" xref="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.3" xref="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.4" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.3.cmml">,</mo><msub id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.3.cmml">0</mn></msub><mo stretchy="false" id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.5" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS1.p10.8.m1.3.3.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.3.cmml">=</mo><mrow id="S4.SS1.SSS1.p10.8.m1.3.3.4" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.cmml"><mrow id="S4.SS1.SSS1.p10.8.m1.3.3.4.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.cmml"><mfrac id="S4.SS1.SSS1.p10.8.m1.1.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.cmml"><mrow id="S4.SS1.SSS1.p10.8.m1.1.1.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.cmml"><msqrt id="S4.SS1.SSS1.p10.8.m1.1.1.1.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3.cmml"><msub id="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.2.cmml">α</mi><mi id="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.3.cmml">t</mi></msub></msqrt><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.8.m1.1.1.1.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.cmml"><mn id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.2.cmml">α</mi><mo id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.SS1.SSS1.p10.8.m1.1.1.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.cmml"><mn id="S4.SS1.SSS1.p10.8.m1.1.1.3.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.2.cmml">1</mn><mo id="S4.SS1.SSS1.p10.8.m1.1.1.3.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.1.cmml">−</mo><msub id="S4.SS1.SSS1.p10.8.m1.1.1.3.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.cmml"><mover accent="true" id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.2" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.2.cmml">α</mi><mo id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.1" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.1.cmml">¯</mo></mover><mi id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.3" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.3.cmml">t</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.1.cmml">​</mo><msub id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.3.cmml">t</mi></msub></mrow><mo id="S4.SS1.SSS1.p10.8.m1.3.3.4.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.1.cmml">+</mo><mrow id="S4.SS1.SSS1.p10.8.m1.3.3.4.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.cmml"><mfrac id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.cmml"><mrow id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.cmml"><msqrt id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.cmml"><msub id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.2.cmml">α</mi><mo id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.1.cmml">¯</mo></mover><mrow id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.2.cmml">t</mi><mo id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.1.cmml">−</mo><mn id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.3.cmml">1</mn></mrow></msub></msqrt><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.1.cmml">​</mo><msub id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.2.cmml">β</mi><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.3.cmml">t</mi></msub></mrow><mrow id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.cmml"><mn id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.2.cmml">1</mn><mo id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.1.cmml">−</mo><msub id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.cmml"><mover accent="true" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.2.cmml">α</mi><mo id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.1.cmml">¯</mo></mover><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.3.cmml">t</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.1" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.1.cmml">​</mo><msub id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.cmml"><mi id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.2" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.3" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.3.cmml">0</mn></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.8.m1.3b"><apply id="S4.SS1.SSS1.p10.8.m1.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3"><eq id="S4.SS1.SSS1.p10.8.m1.3.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.3"></eq><apply id="S4.SS1.SSS1.p10.8.m1.3.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2"><times id="S4.SS1.SSS1.p10.8.m1.3.3.2.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.3"></times><apply id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4">subscript</csymbol><apply id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2"><ci id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.1">~</ci><ci id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.2.2">𝝁</ci></apply><ci id="S4.SS1.SSS1.p10.8.m1.3.3.2.4.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.4.3">𝑡</ci></apply><interval closure="open" id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2"><apply id="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.2">𝒛</ci><ci id="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.2.2.2.2.3">0</cn></apply></interval></apply><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4"><plus id="S4.SS1.SSS1.p10.8.m1.3.3.4.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.1"></plus><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2"><times id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.1"></times><apply id="S4.SS1.SSS1.p10.8.m1.1.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1"><divide id="S4.SS1.SSS1.p10.8.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1"></divide><apply id="S4.SS1.SSS1.p10.8.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1"><times id="S4.SS1.SSS1.p10.8.m1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.2"></times><apply id="S4.SS1.SSS1.p10.8.m1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3"><root id="S4.SS1.SSS1.p10.8.m1.1.1.1.3a.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3"></root><apply id="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.2">𝛼</ci><ci id="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1"><minus id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.2">1</cn><apply id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2"><ci id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.1">¯</ci><ci id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.2.2">𝛼</ci></apply><apply id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3"><minus id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S4.SS1.SSS1.p10.8.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3"><minus id="S4.SS1.SSS1.p10.8.m1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.1"></minus><cn type="integer" id="S4.SS1.SSS1.p10.8.m1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.2">1</cn><apply id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3">subscript</csymbol><apply id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2"><ci id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.1">¯</ci><ci id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.2.2">𝛼</ci></apply><ci id="S4.SS1.SSS1.p10.8.m1.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.2">𝒛</ci><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.2.2.3">𝑡</ci></apply></apply><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3"><times id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.1"></times><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2"><divide id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2"></divide><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2"><times id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.1"></times><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2"><root id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2a.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2"></root><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2"><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.1">¯</ci><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.2.2">𝛼</ci></apply><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3"><minus id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.1"></minus><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.2.2.3.3">1</cn></apply></apply></apply><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.2">𝛽</ci><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.2.3.3">𝑡</ci></apply></apply><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3"><minus id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.1"></minus><cn type="integer" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.2">1</cn><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3">subscript</csymbol><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2"><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.1">¯</ci><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.2.2">𝛼</ci></apply><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.1.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3">subscript</csymbol><ci id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.2.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.3.cmml" xref="S4.SS1.SSS1.p10.8.m1.3.3.4.3.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.8.m1.3c">\tilde{\bm{\mu}}_{t}(\bm{z}_{t},\bm{z}_{0})=\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1-\bar{\alpha}_{t}}\bm{z}_{t}+\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha}_{t}}\bm{z}_{0}</annotation></semantics></math> is the mean of posterior <math id="S4.SS1.SSS1.p10.9.m2.1" class="ltx_Math" alttext="q(\bm{z}_{t-1}\mid\bm{z}_{t},\bm{z}_{0})" display="inline"><semantics id="S4.SS1.SSS1.p10.9.m2.1a"><mrow id="S4.SS1.SSS1.p10.9.m2.1.1" xref="S4.SS1.SSS1.p10.9.m2.1.1.cmml"><mi id="S4.SS1.SSS1.p10.9.m2.1.1.3" xref="S4.SS1.SSS1.p10.9.m2.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p10.9.m2.1.1.2" xref="S4.SS1.SSS1.p10.9.m2.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p10.9.m2.1.1.1.1" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.2" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.cmml"><msub id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.cmml"><mi id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.2" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.2.cmml">𝒛</mi><mrow id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.cmml"><mi id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.2" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.2.cmml">t</mi><mo id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.1" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.1.cmml">−</mo><mn id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.3" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.3.cmml">∣</mo><mrow id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.3.cmml"><msub id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.3" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.2" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.3" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.3.cmml">0</mn></msub></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.3" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.9.m2.1b"><apply id="S4.SS1.SSS1.p10.9.m2.1.1.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1"><times id="S4.SS1.SSS1.p10.9.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.2"></times><ci id="S4.SS1.SSS1.p10.9.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.3">𝑞</ci><apply id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.3">conditional</csymbol><apply id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.1.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4">subscript</csymbol><ci id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.2.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.2">𝒛</ci><apply id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3"><minus id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.1.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.1"></minus><ci id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.2.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.2">𝑡</ci><cn type="integer" id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.3.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.4.3.3">1</cn></apply></apply><list id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2"><apply id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.2">𝒛</ci><ci id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.SSS1.p10.9.m2.1.1.1.1.1.2.2.2.3">0</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.9.m2.1c">q(\bm{z}_{t-1}\mid\bm{z}_{t},\bm{z}_{0})</annotation></semantics></math>, and here <math id="S4.SS1.SSS1.p10.10.m3.2" class="ltx_Math" alttext="\alpha_{t}=1-\beta_{t},\bar{\alpha}_{t}=\prod_{i=1}^{t}\alpha_{i}" display="inline"><semantics id="S4.SS1.SSS1.p10.10.m3.2a"><mrow id="S4.SS1.SSS1.p10.10.m3.2.2.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.3.cmml"><mrow id="S4.SS1.SSS1.p10.10.m3.1.1.1.1" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.cmml"><msub id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.cmml"><mi id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.2" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.2.cmml">α</mi><mi id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.3" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.1" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.1.cmml">=</mo><mrow id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.cmml"><mn id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.2" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.2.cmml">1</mn><mo id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.1" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.1.cmml">−</mo><msub id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.cmml"><mi id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.2" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.2.cmml">β</mi><mi id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.3" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><mo id="S4.SS1.SSS1.p10.10.m3.2.2.2.3" xref="S4.SS1.SSS1.p10.10.m3.2.2.3a.cmml">,</mo><mrow id="S4.SS1.SSS1.p10.10.m3.2.2.2.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.cmml"><msub id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.2.cmml">α</mi><mo id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.1" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.1.cmml">¯</mo></mover><mi id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.3" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.3.cmml">t</mi></msub><mo rspace="0.111em" id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.1" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.1.cmml">=</mo><mrow id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.cmml"><msubsup id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.cmml"><mo id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.2.cmml">∏</mo><mrow id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.cmml"><mi id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.2.cmml">i</mi><mo id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.1" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.3" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.3" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.3.cmml">t</mi></msubsup><msub id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.cmml"><mi id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.2" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.2.cmml">α</mi><mi id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.3" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p10.10.m3.2b"><apply id="S4.SS1.SSS1.p10.10.m3.2.2.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.10.m3.2.2.3a.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.3">formulae-sequence</csymbol><apply id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1"><eq id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.1"></eq><apply id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.2">𝛼</ci><ci id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3"><minus id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.1"></minus><cn type="integer" id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.2">1</cn><apply id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3">subscript</csymbol><ci id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.2">𝛽</ci><ci id="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.1.1.1.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2"><eq id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.1"></eq><apply id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2">subscript</csymbol><apply id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2"><ci id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.1">¯</ci><ci id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.2.2">𝛼</ci></apply><ci id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.2.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3"><apply id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1">superscript</csymbol><apply id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.2">product</csymbol><apply id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3"><eq id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.1"></eq><ci id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.1.3">𝑡</ci></apply><apply id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.1.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.2.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.2">𝛼</ci><ci id="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.3.cmml" xref="S4.SS1.SSS1.p10.10.m3.2.2.2.2.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p10.10.m3.2c">\alpha_{t}=1-\beta_{t},\bar{\alpha}_{t}=\prod_{i=1}^{t}\alpha_{i}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.SSS1.p11" class="ltx_para">
<p id="S4.SS1.SSS1.p11.12" class="ltx_p">After learning the diffusion model, we perform conditional generation to obtain each unaligned sample’s federated embedding <math id="S4.SS1.SSS1.p11.1.m1.1" class="ltx_Math" alttext="\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}" display="inline"><semantics id="S4.SS1.SSS1.p11.1.m1.1a"><msubsup id="S4.SS1.SSS1.p11.1.m1.1.1" xref="S4.SS1.SSS1.p11.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.SSS1.p11.1.m1.1.1.2.2" xref="S4.SS1.SSS1.p11.1.m1.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p11.1.m1.1.1.2.2.2" xref="S4.SS1.SSS1.p11.1.m1.1.1.2.2.2.cmml">𝒉</mi><mo id="S4.SS1.SSS1.p11.1.m1.1.1.2.2.1" xref="S4.SS1.SSS1.p11.1.m1.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p11.1.m1.1.1.2.3" xref="S4.SS1.SSS1.p11.1.m1.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.1.m1.1.1.3" xref="S4.SS1.SSS1.p11.1.m1.1.1.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.1.m1.1b"><apply id="S4.SS1.SSS1.p11.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1">superscript</csymbol><apply id="S4.SS1.SSS1.p11.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.SSS1.p11.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1.2.2"><ci id="S4.SS1.SSS1.p11.1.m1.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1.2.2.1">~</ci><ci id="S4.SS1.SSS1.p11.1.m1.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1.2.2.2">𝒉</ci></apply><ci id="S4.SS1.SSS1.p11.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p11.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p11.1.m1.1.1.3">u</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.1.m1.1c">\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}</annotation></semantics></math> given the conditional input <math id="S4.SS1.SSS1.p11.2.m2.3" class="ltx_Math" alttext="\bm{z}_{T}=\left[{\bm{y}}^{\mathrm{u}};\bm{h}_{\mathrm{L}}^{\mathrm{u}};\bm{h}_{T}\right]" display="inline"><semantics id="S4.SS1.SSS1.p11.2.m2.3a"><mrow id="S4.SS1.SSS1.p11.2.m2.3.3" xref="S4.SS1.SSS1.p11.2.m2.3.3.cmml"><msub id="S4.SS1.SSS1.p11.2.m2.3.3.5" xref="S4.SS1.SSS1.p11.2.m2.3.3.5.cmml"><mi id="S4.SS1.SSS1.p11.2.m2.3.3.5.2" xref="S4.SS1.SSS1.p11.2.m2.3.3.5.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p11.2.m2.3.3.5.3" xref="S4.SS1.SSS1.p11.2.m2.3.3.5.3.cmml">T</mi></msub><mo id="S4.SS1.SSS1.p11.2.m2.3.3.4" xref="S4.SS1.SSS1.p11.2.m2.3.3.4.cmml">=</mo><mrow id="S4.SS1.SSS1.p11.2.m2.3.3.3.3" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.4.cmml"><mo id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.4" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.4.cmml">[</mo><msup id="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1" xref="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.2" xref="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.2.cmml">𝒚</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.3" xref="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.3.cmml">u</mi></msup><mo id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.5" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.4.cmml">;</mo><msubsup id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.2" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.3" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.3" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.6" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.4.cmml">;</mo><msub id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.cmml"><mi id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.2" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.2.cmml">𝒉</mi><mi id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.3" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.3.cmml">T</mi></msub><mo id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.7" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.2.m2.3b"><apply id="S4.SS1.SSS1.p11.2.m2.3.3.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3"><eq id="S4.SS1.SSS1.p11.2.m2.3.3.4.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.4"></eq><apply id="S4.SS1.SSS1.p11.2.m2.3.3.5.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.5"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.2.m2.3.3.5.1.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.5">subscript</csymbol><ci id="S4.SS1.SSS1.p11.2.m2.3.3.5.2.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.5.2">𝒛</ci><ci id="S4.SS1.SSS1.p11.2.m2.3.3.5.3.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.5.3">𝑇</ci></apply><list id="S4.SS1.SSS1.p11.2.m2.3.3.3.4.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.3"><apply id="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.2">𝒚</ci><ci id="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p11.2.m2.1.1.1.1.1.3">u</ci></apply><apply id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2">superscript</csymbol><apply id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.2">𝒉</ci><ci id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.2.3">L</ci></apply><ci id="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p11.2.m2.2.2.2.2.2.3">u</ci></apply><apply id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.1.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.2.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.2">𝒉</ci><ci id="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.3.cmml" xref="S4.SS1.SSS1.p11.2.m2.3.3.3.3.3.3">𝑇</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.2.m2.3c">\bm{z}_{T}=\left[{\bm{y}}^{\mathrm{u}};\bm{h}_{\mathrm{L}}^{\mathrm{u}};\bm{h}_{T}\right]</annotation></semantics></math>, where <math id="S4.SS1.SSS1.p11.3.m3.2" class="ltx_Math" alttext="\bm{h}_{T}\sim\mathcal{N}(\bm{0},\mathbf{I})" display="inline"><semantics id="S4.SS1.SSS1.p11.3.m3.2a"><mrow id="S4.SS1.SSS1.p11.3.m3.2.3" xref="S4.SS1.SSS1.p11.3.m3.2.3.cmml"><msub id="S4.SS1.SSS1.p11.3.m3.2.3.2" xref="S4.SS1.SSS1.p11.3.m3.2.3.2.cmml"><mi id="S4.SS1.SSS1.p11.3.m3.2.3.2.2" xref="S4.SS1.SSS1.p11.3.m3.2.3.2.2.cmml">𝒉</mi><mi id="S4.SS1.SSS1.p11.3.m3.2.3.2.3" xref="S4.SS1.SSS1.p11.3.m3.2.3.2.3.cmml">T</mi></msub><mo id="S4.SS1.SSS1.p11.3.m3.2.3.1" xref="S4.SS1.SSS1.p11.3.m3.2.3.1.cmml">∼</mo><mrow id="S4.SS1.SSS1.p11.3.m3.2.3.3" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p11.3.m3.2.3.3.2" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p11.3.m3.2.3.3.1" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.1.cmml">​</mo><mrow id="S4.SS1.SSS1.p11.3.m3.2.3.3.3.2" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p11.3.m3.2.3.3.3.2.1" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.3.1.cmml">(</mo><mn id="S4.SS1.SSS1.p11.3.m3.1.1" xref="S4.SS1.SSS1.p11.3.m3.1.1.cmml">𝟎</mn><mo id="S4.SS1.SSS1.p11.3.m3.2.3.3.3.2.2" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS1.p11.3.m3.2.2" xref="S4.SS1.SSS1.p11.3.m3.2.2.cmml">𝐈</mi><mo stretchy="false" id="S4.SS1.SSS1.p11.3.m3.2.3.3.3.2.3" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.3.m3.2b"><apply id="S4.SS1.SSS1.p11.3.m3.2.3.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3"><csymbol cd="latexml" id="S4.SS1.SSS1.p11.3.m3.2.3.1.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.1">similar-to</csymbol><apply id="S4.SS1.SSS1.p11.3.m3.2.3.2.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.3.m3.2.3.2.1.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS1.p11.3.m3.2.3.2.2.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.2.2">𝒉</ci><ci id="S4.SS1.SSS1.p11.3.m3.2.3.2.3.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.2.3">𝑇</ci></apply><apply id="S4.SS1.SSS1.p11.3.m3.2.3.3.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.3"><times id="S4.SS1.SSS1.p11.3.m3.2.3.3.1.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.1"></times><ci id="S4.SS1.SSS1.p11.3.m3.2.3.3.2.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.2">𝒩</ci><interval closure="open" id="S4.SS1.SSS1.p11.3.m3.2.3.3.3.1.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.3.3.3.2"><cn type="integer" id="S4.SS1.SSS1.p11.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p11.3.m3.1.1">0</cn><ci id="S4.SS1.SSS1.p11.3.m3.2.2.cmml" xref="S4.SS1.SSS1.p11.3.m3.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.3.m3.2c">\bm{h}_{T}\sim\mathcal{N}(\bm{0},\mathbf{I})</annotation></semantics></math> is the initiate state. The generation repeats <math id="S4.SS1.SSS1.p11.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S4.SS1.SSS1.p11.4.m4.1a"><mi id="S4.SS1.SSS1.p11.4.m4.1.1" xref="S4.SS1.SSS1.p11.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.4.m4.1b"><ci id="S4.SS1.SSS1.p11.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p11.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.4.m4.1c">T</annotation></semantics></math> steps of denoising operation using the learned model <math id="S4.SS1.SSS1.p11.5.m5.1" class="ltx_Math" alttext="\Theta" display="inline"><semantics id="S4.SS1.SSS1.p11.5.m5.1a"><mi mathvariant="normal" id="S4.SS1.SSS1.p11.5.m5.1.1" xref="S4.SS1.SSS1.p11.5.m5.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.5.m5.1b"><ci id="S4.SS1.SSS1.p11.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p11.5.m5.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.5.m5.1c">\Theta</annotation></semantics></math> for sampling <math id="S4.SS1.SSS1.p11.6.m6.4" class="ltx_Math" alttext="\bm{z}_{T-1},\bm{z}_{T-2},\ldots,\bm{z}_{0}" display="inline"><semantics id="S4.SS1.SSS1.p11.6.m6.4a"><mrow id="S4.SS1.SSS1.p11.6.m6.4.4.3" xref="S4.SS1.SSS1.p11.6.m6.4.4.4.cmml"><msub id="S4.SS1.SSS1.p11.6.m6.2.2.1.1" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.cmml"><mi id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.2" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.2.cmml">𝒛</mi><mrow id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.cmml"><mi id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.2" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.2.cmml">T</mi><mo id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.1" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.1.cmml">−</mo><mn id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.3" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS1.p11.6.m6.4.4.3.4" xref="S4.SS1.SSS1.p11.6.m6.4.4.4.cmml">,</mo><msub id="S4.SS1.SSS1.p11.6.m6.3.3.2.2" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.cmml"><mi id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.2" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.2.cmml">𝒛</mi><mrow id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.cmml"><mi id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.2" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.2.cmml">T</mi><mo id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.1" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.1.cmml">−</mo><mn id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.3" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S4.SS1.SSS1.p11.6.m6.4.4.3.5" xref="S4.SS1.SSS1.p11.6.m6.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.SSS1.p11.6.m6.1.1" xref="S4.SS1.SSS1.p11.6.m6.1.1.cmml">…</mi><mo id="S4.SS1.SSS1.p11.6.m6.4.4.3.6" xref="S4.SS1.SSS1.p11.6.m6.4.4.4.cmml">,</mo><msub id="S4.SS1.SSS1.p11.6.m6.4.4.3.3" xref="S4.SS1.SSS1.p11.6.m6.4.4.3.3.cmml"><mi id="S4.SS1.SSS1.p11.6.m6.4.4.3.3.2" xref="S4.SS1.SSS1.p11.6.m6.4.4.3.3.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p11.6.m6.4.4.3.3.3" xref="S4.SS1.SSS1.p11.6.m6.4.4.3.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.6.m6.4b"><list id="S4.SS1.SSS1.p11.6.m6.4.4.4.cmml" xref="S4.SS1.SSS1.p11.6.m6.4.4.3"><apply id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.cmml" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.1.cmml" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.2.cmml" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.2">𝒛</ci><apply id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.cmml" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3"><minus id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.1.cmml" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.1"></minus><ci id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.2.cmml" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.2">𝑇</ci><cn type="integer" id="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.3.cmml" xref="S4.SS1.SSS1.p11.6.m6.2.2.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.cmml" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.1.cmml" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.2.cmml" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.2">𝒛</ci><apply id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.cmml" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3"><minus id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.1.cmml" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.1"></minus><ci id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.2.cmml" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.2">𝑇</ci><cn type="integer" id="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.3.cmml" xref="S4.SS1.SSS1.p11.6.m6.3.3.2.2.3.3">2</cn></apply></apply><ci id="S4.SS1.SSS1.p11.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p11.6.m6.1.1">…</ci><apply id="S4.SS1.SSS1.p11.6.m6.4.4.3.3.cmml" xref="S4.SS1.SSS1.p11.6.m6.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.6.m6.4.4.3.3.1.cmml" xref="S4.SS1.SSS1.p11.6.m6.4.4.3.3">subscript</csymbol><ci id="S4.SS1.SSS1.p11.6.m6.4.4.3.3.2.cmml" xref="S4.SS1.SSS1.p11.6.m6.4.4.3.3.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p11.6.m6.4.4.3.3.3.cmml" xref="S4.SS1.SSS1.p11.6.m6.4.4.3.3.3">0</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.6.m6.4c">\bm{z}_{T-1},\bm{z}_{T-2},\ldots,\bm{z}_{0}</annotation></semantics></math> using <math id="S4.SS1.SSS1.p11.7.m7.1" class="ltx_Math" alttext="\bm{z}_{t-1}\sim p_{\Theta}(\bm{z}_{t-1}\mid\bm{z}_{t})" display="inline"><semantics id="S4.SS1.SSS1.p11.7.m7.1a"><mrow id="S4.SS1.SSS1.p11.7.m7.1.1" xref="S4.SS1.SSS1.p11.7.m7.1.1.cmml"><msub id="S4.SS1.SSS1.p11.7.m7.1.1.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.cmml"><mi id="S4.SS1.SSS1.p11.7.m7.1.1.3.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.2.cmml">𝒛</mi><mrow id="S4.SS1.SSS1.p11.7.m7.1.1.3.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.3.cmml"><mi id="S4.SS1.SSS1.p11.7.m7.1.1.3.3.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.3.2.cmml">t</mi><mo id="S4.SS1.SSS1.p11.7.m7.1.1.3.3.1" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.3.1.cmml">−</mo><mn id="S4.SS1.SSS1.p11.7.m7.1.1.3.3.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS1.p11.7.m7.1.1.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.2.cmml">∼</mo><mrow id="S4.SS1.SSS1.p11.7.m7.1.1.1" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.cmml"><msub id="S4.SS1.SSS1.p11.7.m7.1.1.1.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p11.7.m7.1.1.1.3.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.3.2.cmml">p</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.7.m7.1.1.1.3.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.3.3.cmml">Θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p11.7.m7.1.1.1.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.cmml"><msub id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.cmml"><mi id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.2.cmml">𝒛</mi><mrow id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.1" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.1.cmml">−</mo><mn id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.1" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.1.cmml">∣</mo><msub id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.2" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.3" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.7.m7.1b"><apply id="S4.SS1.SSS1.p11.7.m7.1.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p11.7.m7.1.1.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.2">similar-to</csymbol><apply id="S4.SS1.SSS1.p11.7.m7.1.1.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.7.m7.1.1.3.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p11.7.m7.1.1.3.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.2">𝒛</ci><apply id="S4.SS1.SSS1.p11.7.m7.1.1.3.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.3"><minus id="S4.SS1.SSS1.p11.7.m7.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.3.1"></minus><ci id="S4.SS1.SSS1.p11.7.m7.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.3.2">𝑡</ci><cn type="integer" id="S4.SS1.SSS1.p11.7.m7.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.3.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS1.p11.7.m7.1.1.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1"><times id="S4.SS1.SSS1.p11.7.m7.1.1.1.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.2"></times><apply id="S4.SS1.SSS1.p11.7.m7.1.1.1.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.7.m7.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p11.7.m7.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.3.2">𝑝</ci><ci id="S4.SS1.SSS1.p11.7.m7.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.3.3">Θ</ci></apply><apply id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.2">𝒛</ci><apply id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3"><minus id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.1"></minus><ci id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.2">𝒛</ci><ci id="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS1.p11.7.m7.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.7.m7.1c">\bm{z}_{t-1}\sim p_{\Theta}(\bm{z}_{t-1}\mid\bm{z}_{t})</annotation></semantics></math>. Note that at each step, we replace the condition part of the generated <math id="S4.SS1.SSS1.p11.8.m8.1" class="ltx_Math" alttext="\bm{z}_{t}" display="inline"><semantics id="S4.SS1.SSS1.p11.8.m8.1a"><msub id="S4.SS1.SSS1.p11.8.m8.1.1" xref="S4.SS1.SSS1.p11.8.m8.1.1.cmml"><mi id="S4.SS1.SSS1.p11.8.m8.1.1.2" xref="S4.SS1.SSS1.p11.8.m8.1.1.2.cmml">𝒛</mi><mi id="S4.SS1.SSS1.p11.8.m8.1.1.3" xref="S4.SS1.SSS1.p11.8.m8.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.8.m8.1b"><apply id="S4.SS1.SSS1.p11.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p11.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.8.m8.1.1.1.cmml" xref="S4.SS1.SSS1.p11.8.m8.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p11.8.m8.1.1.2.cmml" xref="S4.SS1.SSS1.p11.8.m8.1.1.2">𝒛</ci><ci id="S4.SS1.SSS1.p11.8.m8.1.1.3.cmml" xref="S4.SS1.SSS1.p11.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.8.m8.1c">\bm{z}_{t}</annotation></semantics></math> to the original condition <math id="S4.SS1.SSS1.p11.9.m9.2" class="ltx_Math" alttext="\left[{\bm{y}}^{\mathrm{u}};\bm{h}_{\mathrm{L}}^{\mathrm{u}}\right]" display="inline"><semantics id="S4.SS1.SSS1.p11.9.m9.2a"><mrow id="S4.SS1.SSS1.p11.9.m9.2.2.2" xref="S4.SS1.SSS1.p11.9.m9.2.2.3.cmml"><mo id="S4.SS1.SSS1.p11.9.m9.2.2.2.3" xref="S4.SS1.SSS1.p11.9.m9.2.2.3.cmml">[</mo><msup id="S4.SS1.SSS1.p11.9.m9.1.1.1.1" xref="S4.SS1.SSS1.p11.9.m9.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p11.9.m9.1.1.1.1.2" xref="S4.SS1.SSS1.p11.9.m9.1.1.1.1.2.cmml">𝒚</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.9.m9.1.1.1.1.3" xref="S4.SS1.SSS1.p11.9.m9.1.1.1.1.3.cmml">u</mi></msup><mo id="S4.SS1.SSS1.p11.9.m9.2.2.2.4" xref="S4.SS1.SSS1.p11.9.m9.2.2.3.cmml">;</mo><msubsup id="S4.SS1.SSS1.p11.9.m9.2.2.2.2" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.2" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.3" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.3" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS1.p11.9.m9.2.2.2.5" xref="S4.SS1.SSS1.p11.9.m9.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.9.m9.2b"><list id="S4.SS1.SSS1.p11.9.m9.2.2.3.cmml" xref="S4.SS1.SSS1.p11.9.m9.2.2.2"><apply id="S4.SS1.SSS1.p11.9.m9.1.1.1.1.cmml" xref="S4.SS1.SSS1.p11.9.m9.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.9.m9.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p11.9.m9.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p11.9.m9.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p11.9.m9.1.1.1.1.2">𝒚</ci><ci id="S4.SS1.SSS1.p11.9.m9.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p11.9.m9.1.1.1.1.3">u</ci></apply><apply id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.cmml" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2">superscript</csymbol><apply id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.2">𝒉</ci><ci id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2.2.3">L</ci></apply><ci id="S4.SS1.SSS1.p11.9.m9.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p11.9.m9.2.2.2.2.3">u</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.9.m9.2c">\left[{\bm{y}}^{\mathrm{u}};\bm{h}_{\mathrm{L}}^{\mathrm{u}}\right]</annotation></semantics></math>.
Finally at the last step we obtain <math id="S4.SS1.SSS1.p11.10.m10.1" class="ltx_Math" alttext="\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}\coloneqq\bm{h}_{0}" display="inline"><semantics id="S4.SS1.SSS1.p11.10.m10.1a"><mrow id="S4.SS1.SSS1.p11.10.m10.1.1" xref="S4.SS1.SSS1.p11.10.m10.1.1.cmml"><msubsup id="S4.SS1.SSS1.p11.10.m10.1.1.2" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.cmml"><mi id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.2" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.2.cmml">𝒉</mi><mo id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.1" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.3" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.2.3.cmml">N</mi><mi mathvariant="normal" id="S4.SS1.SSS1.p11.10.m10.1.1.2.3" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS1.p11.10.m10.1.1.1" xref="S4.SS1.SSS1.p11.10.m10.1.1.1.cmml">≔</mo><msub id="S4.SS1.SSS1.p11.10.m10.1.1.3" xref="S4.SS1.SSS1.p11.10.m10.1.1.3.cmml"><mi id="S4.SS1.SSS1.p11.10.m10.1.1.3.2" xref="S4.SS1.SSS1.p11.10.m10.1.1.3.2.cmml">𝒉</mi><mn id="S4.SS1.SSS1.p11.10.m10.1.1.3.3" xref="S4.SS1.SSS1.p11.10.m10.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.10.m10.1b"><apply id="S4.SS1.SSS1.p11.10.m10.1.1.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1"><ci id="S4.SS1.SSS1.p11.10.m10.1.1.1.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.1">≔</ci><apply id="S4.SS1.SSS1.p11.10.m10.1.1.2.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.10.m10.1.1.2.1.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2">superscript</csymbol><apply id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2">subscript</csymbol><apply id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2"><ci id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.2.2.2">𝒉</ci></apply><ci id="S4.SS1.SSS1.p11.10.m10.1.1.2.2.3.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.2.3">N</ci></apply><ci id="S4.SS1.SSS1.p11.10.m10.1.1.2.3.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.2.3">u</ci></apply><apply id="S4.SS1.SSS1.p11.10.m10.1.1.3.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.10.m10.1.1.3.1.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p11.10.m10.1.1.3.2.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.3.2">𝒉</ci><cn type="integer" id="S4.SS1.SSS1.p11.10.m10.1.1.3.3.cmml" xref="S4.SS1.SSS1.p11.10.m10.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.10.m10.1c">\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}\coloneqq\bm{h}_{0}</annotation></semantics></math> as the synthesized federated embedding, where <math id="S4.SS1.SSS1.p11.11.m11.1" class="ltx_Math" alttext="\bm{h}_{0}" display="inline"><semantics id="S4.SS1.SSS1.p11.11.m11.1a"><msub id="S4.SS1.SSS1.p11.11.m11.1.1" xref="S4.SS1.SSS1.p11.11.m11.1.1.cmml"><mi id="S4.SS1.SSS1.p11.11.m11.1.1.2" xref="S4.SS1.SSS1.p11.11.m11.1.1.2.cmml">𝒉</mi><mn id="S4.SS1.SSS1.p11.11.m11.1.1.3" xref="S4.SS1.SSS1.p11.11.m11.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.11.m11.1b"><apply id="S4.SS1.SSS1.p11.11.m11.1.1.cmml" xref="S4.SS1.SSS1.p11.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.11.m11.1.1.1.cmml" xref="S4.SS1.SSS1.p11.11.m11.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p11.11.m11.1.1.2.cmml" xref="S4.SS1.SSS1.p11.11.m11.1.1.2">𝒉</ci><cn type="integer" id="S4.SS1.SSS1.p11.11.m11.1.1.3.cmml" xref="S4.SS1.SSS1.p11.11.m11.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.11.m11.1c">\bm{h}_{0}</annotation></semantics></math> is the part in <math id="S4.SS1.SSS1.p11.12.m12.1" class="ltx_Math" alttext="\bm{z}_{0}" display="inline"><semantics id="S4.SS1.SSS1.p11.12.m12.1a"><msub id="S4.SS1.SSS1.p11.12.m12.1.1" xref="S4.SS1.SSS1.p11.12.m12.1.1.cmml"><mi id="S4.SS1.SSS1.p11.12.m12.1.1.2" xref="S4.SS1.SSS1.p11.12.m12.1.1.2.cmml">𝒛</mi><mn id="S4.SS1.SSS1.p11.12.m12.1.1.3" xref="S4.SS1.SSS1.p11.12.m12.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p11.12.m12.1b"><apply id="S4.SS1.SSS1.p11.12.m12.1.1.cmml" xref="S4.SS1.SSS1.p11.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p11.12.m12.1.1.1.cmml" xref="S4.SS1.SSS1.p11.12.m12.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p11.12.m12.1.1.2.cmml" xref="S4.SS1.SSS1.p11.12.m12.1.1.2">𝒛</ci><cn type="integer" id="S4.SS1.SSS1.p11.12.m12.1.1.3.cmml" xref="S4.SS1.SSS1.p11.12.m12.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p11.12.m12.1c">\bm{z}_{0}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span><span id="S4.SS1.SSS2.1.1" class="ltx_text ltx_font_bold">Alternative Training Framework</span>
</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.2" class="ltx_p">Now we have aligned samples <math id="S4.SS1.SSS2.p1.1.m1.2" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}=\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\}" display="inline"><semantics id="S4.SS1.SSS2.p1.1.m1.2a"><mrow id="S4.SS1.SSS2.p1.1.m1.2.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.cmml"><msub id="S4.SS1.SSS2.p1.1.m1.2.2.3" xref="S4.SS1.SSS2.p1.1.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.1.m1.2.2.3.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.3.2.cmml">𝒟</mi><mi id="S4.SS1.SSS2.p1.1.m1.2.2.3.3" xref="S4.SS1.SSS2.p1.1.m1.2.2.3.3.cmml">aligned</mi></msub><mo id="S4.SS1.SSS2.p1.1.m1.2.2.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.2.cmml">=</mo><mrow id="S4.SS1.SSS2.p1.1.m1.2.2.1.1" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.2.cmml">{</mo><mrow id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.3" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.3.cmml">(</mo><msub id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.3.cmml">N</mi></msub><mo id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.4" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.3.cmml">,</mo><msub id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.3" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.3.cmml">L</mi></msub><mo id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.5" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.3.cmml">,</mo><mi id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.6" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.2b"><apply id="S4.SS1.SSS2.p1.1.m1.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2"><eq id="S4.SS1.SSS2.p1.1.m1.2.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.2"></eq><apply id="S4.SS1.SSS2.p1.1.m1.2.2.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.2.2.3.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS2.p1.1.m1.2.2.3.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.3.2">𝒟</ci><ci id="S4.SS1.SSS2.p1.1.m1.2.2.3.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.3.3">aligned</ci></apply><set id="S4.SS1.SSS2.p1.1.m1.2.2.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1"><vector id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2"><apply id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.2">𝒙</ci><ci id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.1.1.3">N</ci></apply><apply id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.2">𝒙</ci><ci id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.2.2.3">L</ci></apply><ci id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">𝒚</ci></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.2c">\mathcal{D}_{\mathrm{aligned}}=\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\}</annotation></semantics></math> as well as unaligned samples with synthesized federated embeddings <math id="S4.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\tilde{\mathcal{D}}_{\mathrm{unaligned}}=\left\{\left(\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}},\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}" display="inline"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><mrow id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml"><msub id="S4.SS1.SSS2.p1.2.m2.1.1.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml"><mover accent="true" id="S4.SS1.SSS2.p1.2.m2.1.1.3.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.2.m2.1.1.3.2.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2.2.cmml">𝒟</mi><mo id="S4.SS1.SSS2.p1.2.m2.1.1.3.2.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2.1.cmml">~</mo></mover><mi id="S4.SS1.SSS2.p1.2.m2.1.1.3.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.3.cmml">unaligned</mi></msub><mo id="S4.SS1.SSS2.p1.2.m2.1.1.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S4.SS1.SSS2.p1.2.m2.1.1.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.2.cmml"><mo id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.2.cmml">{</mo><mrow id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.4.cmml"><mo id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.4" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.4.cmml">(</mo><msubsup id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.cmml">𝒉</mi><mo id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.5" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.4.cmml">,</mo><msubsup id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.3.cmml">L</mi><mi mathvariant="normal" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.6" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.4.cmml">,</mo><msup id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.2" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.2.cmml">𝒚</mi><mi mathvariant="normal" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.3.cmml">u</mi></msup><mo id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.7" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.3" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><apply id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1"><eq id="S4.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.2"></eq><apply id="S4.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3">subscript</csymbol><apply id="S4.SS1.SSS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2"><ci id="S4.SS1.SSS2.p1.2.m2.1.1.3.2.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2.1">~</ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.3.2.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.2.2">𝒟</ci></apply><ci id="S4.SS1.SSS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.3.3">unaligned</ci></apply><set id="S4.SS1.SSS2.p1.2.m2.1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1"><vector id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.4.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3"><apply id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2"><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.2.2">𝒉</ci></apply><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.2.3">N</ci></apply><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.1.3">u</ci></apply><apply id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2">superscript</csymbol><apply id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.2">𝒙</ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.2.3">L</ci></apply><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.2.3">u</ci></apply><apply id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.2">𝒚</ci><ci id="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.3.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.3.3">u</ci></apply></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">\tilde{\mathcal{D}}_{\mathrm{unaligned}}=\left\{\left(\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}},\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p id="S4.SS1.SSS2.p2.3" class="ltx_p">To effectively fuse them for learning an enhanced federated model that improves effectiveness, we propose to combine the two sample set in an alternative training fashion. As shown in Figure <a href="#S3.F3" title="Figure 3 ‣ 3.2.3. Statistics ‣ 3.2. Real-World Dataset Construction ‣ 3. Proposed Benchmark ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> (b), the label party augments an auxiliary submodel <math id="S4.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{L}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS2.p2.1.m1.1a"><mrow id="S4.SS1.SSS2.p2.1.m1.1.2" xref="S4.SS1.SSS2.p2.1.m1.1.2.cmml"><msub id="S4.SS1.SSS2.p2.1.m1.1.2.2" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.1.m1.1.2.2.2" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.2.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.1.2.2.2.2" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS2.p2.1.m1.1.2.2.2.1" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS2.p2.1.m1.1.2.2.3" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.1.m1.1.2.1" xref="S4.SS1.SSS2.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS2.p2.1.m1.1.2.3.2" xref="S4.SS1.SSS2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p2.1.m1.1.2.3.2.1" xref="S4.SS1.SSS2.p2.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.1.m1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS2.p2.1.m1.1.2.3.2.2" xref="S4.SS1.SSS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.1.m1.1b"><apply id="S4.SS1.SSS2.p2.1.m1.1.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.2"><times id="S4.SS1.SSS2.p2.1.m1.1.2.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.2.1"></times><apply id="S4.SS1.SSS2.p2.1.m1.1.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS2.p2.1.m1.1.2.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.2"><ci id="S4.SS1.SSS2.p2.1.m1.1.2.2.2.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS2.p2.1.m1.1.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS2.p2.1.m1.1.2.2.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.2.2.3">L</ci></apply><ci id="S4.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.1.m1.1c">\tilde{f}_{\mathrm{L}}(\cdot)</annotation></semantics></math> composed of <math id="S4.SS1.SSS2.p2.2.m2.5" class="ltx_Math" alttext="\left(\tilde{f}_{\mathrm{L}}^{(\mathrm{b})},\tilde{f}_{\mathrm{L}}^{(\mathrm{t})},\tilde{f}_{\mathrm{N}}\right)" display="inline"><semantics id="S4.SS1.SSS2.p2.2.m2.5a"><mrow id="S4.SS1.SSS2.p2.2.m2.5.5.3" xref="S4.SS1.SSS2.p2.2.m2.5.5.4.cmml"><mo id="S4.SS1.SSS2.p2.2.m2.5.5.3.4" xref="S4.SS1.SSS2.p2.2.m2.5.5.4.cmml">(</mo><msubsup id="S4.SS1.SSS2.p2.2.m2.3.3.1.1" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.2" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.1" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.3" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.3.cmml">L</mi><mrow id="S4.SS1.SSS2.p2.2.m2.1.1.1.3" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p2.2.m2.1.1.1.3.1" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.cmml">(</mo><mi mathvariant="normal" id="S4.SS1.SSS2.p2.2.m2.1.1.1.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.1.1.cmml">b</mi><mo stretchy="false" id="S4.SS1.SSS2.p2.2.m2.1.1.1.3.2" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.SSS2.p2.2.m2.5.5.3.5" xref="S4.SS1.SSS2.p2.2.m2.5.5.4.cmml">,</mo><msubsup id="S4.SS1.SSS2.p2.2.m2.4.4.2.2" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.2" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.1" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.3" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.3.cmml">L</mi><mrow id="S4.SS1.SSS2.p2.2.m2.2.2.1.3" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p2.2.m2.2.2.1.3.1" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.cmml">(</mo><mi mathvariant="normal" id="S4.SS1.SSS2.p2.2.m2.2.2.1.1" xref="S4.SS1.SSS2.p2.2.m2.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS1.SSS2.p2.2.m2.2.2.1.3.2" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.SSS2.p2.2.m2.5.5.3.6" xref="S4.SS1.SSS2.p2.2.m2.5.5.4.cmml">,</mo><msub id="S4.SS1.SSS2.p2.2.m2.5.5.3.3" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.2" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.2.cmml">f</mi><mo id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.1" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.3" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.3.cmml">N</mi></msub><mo id="S4.SS1.SSS2.p2.2.m2.5.5.3.7" xref="S4.SS1.SSS2.p2.2.m2.5.5.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.2.m2.5b"><vector id="S4.SS1.SSS2.p2.2.m2.5.5.4.cmml" xref="S4.SS1.SSS2.p2.2.m2.5.5.3"><apply id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2"><ci id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.1">~</ci><ci id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.3.3.1.1.2.3">L</ci></apply><ci id="S4.SS1.SSS2.p2.2.m2.1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.1.1">b</ci></apply><apply id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2">superscript</csymbol><apply id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2">subscript</csymbol><apply id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2"><ci id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.1">~</ci><ci id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.4.4.2.2.2.3">L</ci></apply><ci id="S4.SS1.SSS2.p2.2.m2.2.2.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.2.2.1.1">t</ci></apply><apply id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3">subscript</csymbol><apply id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2"><ci id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.1">~</ci><ci id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS2.p2.2.m2.5.5.3.3.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.5.5.3.3.3">N</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.2.m2.5c">\left(\tilde{f}_{\mathrm{L}}^{(\mathrm{b})},\tilde{f}_{\mathrm{L}}^{(\mathrm{t})},\tilde{f}_{\mathrm{N}}\right)</annotation></semantics></math> to exploit unaligned samples, and recall that <math id="S4.SS1.SSS2.p2.3.m3.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS2.p2.3.m3.1a"><mrow id="S4.SS1.SSS2.p2.3.m3.1.2" xref="S4.SS1.SSS2.p2.3.m3.1.2.cmml"><msub id="S4.SS1.SSS2.p2.3.m3.1.2.2" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.cmml"><mover accent="true" id="S4.SS1.SSS2.p2.3.m3.1.2.2.2" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.2.cmml"><mi id="S4.SS1.SSS2.p2.3.m3.1.2.2.2.2" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS2.p2.3.m3.1.2.2.2.1" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS2.p2.3.m3.1.2.2.3" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.3.m3.1.2.1" xref="S4.SS1.SSS2.p2.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS2.p2.3.m3.1.2.3.2" xref="S4.SS1.SSS2.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p2.3.m3.1.2.3.2.1" xref="S4.SS1.SSS2.p2.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.3.m3.1.1" xref="S4.SS1.SSS2.p2.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS2.p2.3.m3.1.2.3.2.2" xref="S4.SS1.SSS2.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.3.m3.1b"><apply id="S4.SS1.SSS2.p2.3.m3.1.2.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.2"><times id="S4.SS1.SSS2.p2.3.m3.1.2.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.2.1"></times><apply id="S4.SS1.SSS2.p2.3.m3.1.2.2.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.3.m3.1.2.2.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS2.p2.3.m3.1.2.2.2.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.2"><ci id="S4.SS1.SSS2.p2.3.m3.1.2.2.2.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS2.p2.3.m3.1.2.2.2.2.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS2.p2.3.m3.1.2.2.3.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.2.2.3">N</ci></apply><ci id="S4.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.3.m3.1c">\tilde{f}_{\mathrm{N}}(\cdot)</annotation></semantics></math> is the learned diffusion model.</p>
</div>
<div id="S4.SS1.SSS2.p3" class="ltx_para">
<p id="S4.SS1.SSS2.p3.10" class="ltx_p">Our proposed vFL framework named <span id="S4.SS1.SSS2.p3.10.1" class="ltx_text ltx_font_sansserif">Diffu-AT</span> contains a federated branch <math id="S4.SS1.SSS2.p3.1.m1.1" class="ltx_Math" alttext="{f}(\cdot)" display="inline"><semantics id="S4.SS1.SSS2.p3.1.m1.1a"><mrow id="S4.SS1.SSS2.p3.1.m1.1.2" xref="S4.SS1.SSS2.p3.1.m1.1.2.cmml"><mi id="S4.SS1.SSS2.p3.1.m1.1.2.2" xref="S4.SS1.SSS2.p3.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p3.1.m1.1.2.1" xref="S4.SS1.SSS2.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS2.p3.1.m1.1.2.3.2" xref="S4.SS1.SSS2.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.1.m1.1.2.3.2.1" xref="S4.SS1.SSS2.p3.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p3.1.m1.1.1" xref="S4.SS1.SSS2.p3.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS2.p3.1.m1.1.2.3.2.2" xref="S4.SS1.SSS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.1.m1.1b"><apply id="S4.SS1.SSS2.p3.1.m1.1.2.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.2"><times id="S4.SS1.SSS2.p3.1.m1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.2.1"></times><ci id="S4.SS1.SSS2.p3.1.m1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.2.2">𝑓</ci><ci id="S4.SS1.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.1.m1.1c">{f}(\cdot)</annotation></semantics></math> and a local branch <math id="S4.SS1.SSS2.p3.2.m2.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{L}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS2.p3.2.m2.1a"><mrow id="S4.SS1.SSS2.p3.2.m2.1.2" xref="S4.SS1.SSS2.p3.2.m2.1.2.cmml"><msub id="S4.SS1.SSS2.p3.2.m2.1.2.2" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.cmml"><mover accent="true" id="S4.SS1.SSS2.p3.2.m2.1.2.2.2" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.2.cmml"><mi id="S4.SS1.SSS2.p3.2.m2.1.2.2.2.2" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS2.p3.2.m2.1.2.2.2.1" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS2.p3.2.m2.1.2.2.3" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p3.2.m2.1.2.1" xref="S4.SS1.SSS2.p3.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS2.p3.2.m2.1.2.3.2" xref="S4.SS1.SSS2.p3.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.2.m2.1.2.3.2.1" xref="S4.SS1.SSS2.p3.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p3.2.m2.1.1" xref="S4.SS1.SSS2.p3.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS2.p3.2.m2.1.2.3.2.2" xref="S4.SS1.SSS2.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.2.m2.1b"><apply id="S4.SS1.SSS2.p3.2.m2.1.2.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.2"><times id="S4.SS1.SSS2.p3.2.m2.1.2.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.2.1"></times><apply id="S4.SS1.SSS2.p3.2.m2.1.2.2.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.2.m2.1.2.2.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS2.p3.2.m2.1.2.2.2.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.2"><ci id="S4.SS1.SSS2.p3.2.m2.1.2.2.2.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS2.p3.2.m2.1.2.2.2.2.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS2.p3.2.m2.1.2.2.3.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.2.2.3">L</ci></apply><ci id="S4.SS1.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.2.m2.1c">\tilde{f}_{\mathrm{L}}(\cdot)</annotation></semantics></math> for learning from aligned samples <math id="S4.SS1.SSS2.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}" display="inline"><semantics id="S4.SS1.SSS2.p3.3.m3.1a"><msub id="S4.SS1.SSS2.p3.3.m3.1.1" xref="S4.SS1.SSS2.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.3.m3.1.1.2" xref="S4.SS1.SSS2.p3.3.m3.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.SSS2.p3.3.m3.1.1.3" xref="S4.SS1.SSS2.p3.3.m3.1.1.3.cmml">aligned</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.3.m3.1b"><apply id="S4.SS1.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.3.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1.2">𝒟</ci><ci id="S4.SS1.SSS2.p3.3.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p3.3.m3.1.1.3">aligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.3.m3.1c">\mathcal{D}_{\mathrm{aligned}}</annotation></semantics></math> and unaligned samples <math id="S4.SS1.SSS2.p3.4.m4.1" class="ltx_Math" alttext="\tilde{\mathcal{D}}_{\mathrm{unaligned}}" display="inline"><semantics id="S4.SS1.SSS2.p3.4.m4.1a"><msub id="S4.SS1.SSS2.p3.4.m4.1.1" xref="S4.SS1.SSS2.p3.4.m4.1.1.cmml"><mover accent="true" id="S4.SS1.SSS2.p3.4.m4.1.1.2" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.4.m4.1.1.2.2" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.2.cmml">𝒟</mi><mo id="S4.SS1.SSS2.p3.4.m4.1.1.2.1" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS1.SSS2.p3.4.m4.1.1.3" xref="S4.SS1.SSS2.p3.4.m4.1.1.3.cmml">unaligned</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.4.m4.1b"><apply id="S4.SS1.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1.2"><ci id="S4.SS1.SSS2.p3.4.m4.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.1">~</ci><ci id="S4.SS1.SSS2.p3.4.m4.1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1.2.2">𝒟</ci></apply><ci id="S4.SS1.SSS2.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS2.p3.4.m4.1.1.3">unaligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.4.m4.1c">\tilde{\mathcal{D}}_{\mathrm{unaligned}}</annotation></semantics></math> respectively in an alternative training fashion, and their bottom parts <math id="S4.SS1.SSS2.p3.5.m5.1" class="ltx_Math" alttext="{f}_{\mathrm{L}}^{(\mathrm{b})}" display="inline"><semantics id="S4.SS1.SSS2.p3.5.m5.1a"><msubsup id="S4.SS1.SSS2.p3.5.m5.1.2" xref="S4.SS1.SSS2.p3.5.m5.1.2.cmml"><mi id="S4.SS1.SSS2.p3.5.m5.1.2.2.2" xref="S4.SS1.SSS2.p3.5.m5.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S4.SS1.SSS2.p3.5.m5.1.2.2.3" xref="S4.SS1.SSS2.p3.5.m5.1.2.2.3.cmml">L</mi><mrow id="S4.SS1.SSS2.p3.5.m5.1.1.1.3" xref="S4.SS1.SSS2.p3.5.m5.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.5.m5.1.1.1.3.1" xref="S4.SS1.SSS2.p3.5.m5.1.2.cmml">(</mo><mi mathvariant="normal" id="S4.SS1.SSS2.p3.5.m5.1.1.1.1" xref="S4.SS1.SSS2.p3.5.m5.1.1.1.1.cmml">b</mi><mo stretchy="false" id="S4.SS1.SSS2.p3.5.m5.1.1.1.3.2" xref="S4.SS1.SSS2.p3.5.m5.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.5.m5.1b"><apply id="S4.SS1.SSS2.p3.5.m5.1.2.cmml" xref="S4.SS1.SSS2.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.5.m5.1.2.1.cmml" xref="S4.SS1.SSS2.p3.5.m5.1.2">superscript</csymbol><apply id="S4.SS1.SSS2.p3.5.m5.1.2.2.cmml" xref="S4.SS1.SSS2.p3.5.m5.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.5.m5.1.2.2.1.cmml" xref="S4.SS1.SSS2.p3.5.m5.1.2">subscript</csymbol><ci id="S4.SS1.SSS2.p3.5.m5.1.2.2.2.cmml" xref="S4.SS1.SSS2.p3.5.m5.1.2.2.2">𝑓</ci><ci id="S4.SS1.SSS2.p3.5.m5.1.2.2.3.cmml" xref="S4.SS1.SSS2.p3.5.m5.1.2.2.3">L</ci></apply><ci id="S4.SS1.SSS2.p3.5.m5.1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.5.m5.1.1.1.1">b</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.5.m5.1c">{f}_{\mathrm{L}}^{(\mathrm{b})}</annotation></semantics></math> and <math id="S4.SS1.SSS2.p3.6.m6.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{L}}^{(\mathrm{b})}" display="inline"><semantics id="S4.SS1.SSS2.p3.6.m6.1a"><msubsup id="S4.SS1.SSS2.p3.6.m6.1.2" xref="S4.SS1.SSS2.p3.6.m6.1.2.cmml"><mover accent="true" id="S4.SS1.SSS2.p3.6.m6.1.2.2.2" xref="S4.SS1.SSS2.p3.6.m6.1.2.2.2.cmml"><mi id="S4.SS1.SSS2.p3.6.m6.1.2.2.2.2" xref="S4.SS1.SSS2.p3.6.m6.1.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS2.p3.6.m6.1.2.2.2.1" xref="S4.SS1.SSS2.p3.6.m6.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS2.p3.6.m6.1.2.2.3" xref="S4.SS1.SSS2.p3.6.m6.1.2.2.3.cmml">L</mi><mrow id="S4.SS1.SSS2.p3.6.m6.1.1.1.3" xref="S4.SS1.SSS2.p3.6.m6.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.6.m6.1.1.1.3.1" xref="S4.SS1.SSS2.p3.6.m6.1.2.cmml">(</mo><mi mathvariant="normal" id="S4.SS1.SSS2.p3.6.m6.1.1.1.1" xref="S4.SS1.SSS2.p3.6.m6.1.1.1.1.cmml">b</mi><mo stretchy="false" id="S4.SS1.SSS2.p3.6.m6.1.1.1.3.2" xref="S4.SS1.SSS2.p3.6.m6.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.6.m6.1b"><apply id="S4.SS1.SSS2.p3.6.m6.1.2.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.6.m6.1.2.1.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.2">superscript</csymbol><apply id="S4.SS1.SSS2.p3.6.m6.1.2.2.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.6.m6.1.2.2.1.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.2">subscript</csymbol><apply id="S4.SS1.SSS2.p3.6.m6.1.2.2.2.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.2.2.2"><ci id="S4.SS1.SSS2.p3.6.m6.1.2.2.2.1.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS2.p3.6.m6.1.2.2.2.2.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS2.p3.6.m6.1.2.2.3.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.2.2.3">L</ci></apply><ci id="S4.SS1.SSS2.p3.6.m6.1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.6.m6.1.1.1.1">b</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.6.m6.1c">\tilde{f}_{\mathrm{L}}^{(\mathrm{b})}</annotation></semantics></math> share the parameter set. Specifically, at each training iteration, we randomly sample a mini-batch from <math id="S4.SS1.SSS2.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}" display="inline"><semantics id="S4.SS1.SSS2.p3.7.m7.1a"><msub id="S4.SS1.SSS2.p3.7.m7.1.1" xref="S4.SS1.SSS2.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.7.m7.1.1.2" xref="S4.SS1.SSS2.p3.7.m7.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.SSS2.p3.7.m7.1.1.3" xref="S4.SS1.SSS2.p3.7.m7.1.1.3.cmml">aligned</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.7.m7.1b"><apply id="S4.SS1.SSS2.p3.7.m7.1.1.cmml" xref="S4.SS1.SSS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.7.m7.1.1.1.cmml" xref="S4.SS1.SSS2.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.7.m7.1.1.2.cmml" xref="S4.SS1.SSS2.p3.7.m7.1.1.2">𝒟</ci><ci id="S4.SS1.SSS2.p3.7.m7.1.1.3.cmml" xref="S4.SS1.SSS2.p3.7.m7.1.1.3">aligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.7.m7.1c">\mathcal{D}_{\mathrm{aligned}}</annotation></semantics></math> or <math id="S4.SS1.SSS2.p3.8.m8.1" class="ltx_Math" alttext="\tilde{\mathcal{D}}_{\mathrm{unaligned}}" display="inline"><semantics id="S4.SS1.SSS2.p3.8.m8.1a"><msub id="S4.SS1.SSS2.p3.8.m8.1.1" xref="S4.SS1.SSS2.p3.8.m8.1.1.cmml"><mover accent="true" id="S4.SS1.SSS2.p3.8.m8.1.1.2" xref="S4.SS1.SSS2.p3.8.m8.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.8.m8.1.1.2.2" xref="S4.SS1.SSS2.p3.8.m8.1.1.2.2.cmml">𝒟</mi><mo id="S4.SS1.SSS2.p3.8.m8.1.1.2.1" xref="S4.SS1.SSS2.p3.8.m8.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS1.SSS2.p3.8.m8.1.1.3" xref="S4.SS1.SSS2.p3.8.m8.1.1.3.cmml">unaligned</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.8.m8.1b"><apply id="S4.SS1.SSS2.p3.8.m8.1.1.cmml" xref="S4.SS1.SSS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.8.m8.1.1.1.cmml" xref="S4.SS1.SSS2.p3.8.m8.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p3.8.m8.1.1.2.cmml" xref="S4.SS1.SSS2.p3.8.m8.1.1.2"><ci id="S4.SS1.SSS2.p3.8.m8.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.8.m8.1.1.2.1">~</ci><ci id="S4.SS1.SSS2.p3.8.m8.1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.8.m8.1.1.2.2">𝒟</ci></apply><ci id="S4.SS1.SSS2.p3.8.m8.1.1.3.cmml" xref="S4.SS1.SSS2.p3.8.m8.1.1.3">unaligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.8.m8.1c">\tilde{\mathcal{D}}_{\mathrm{unaligned}}</annotation></semantics></math>, and then update the parameters of the corresponding branch. The sampling probability of selecting a mini-batch from <math id="S4.SS1.SSS2.p3.9.m9.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}" display="inline"><semantics id="S4.SS1.SSS2.p3.9.m9.1a"><msub id="S4.SS1.SSS2.p3.9.m9.1.1" xref="S4.SS1.SSS2.p3.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.9.m9.1.1.2" xref="S4.SS1.SSS2.p3.9.m9.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.SSS2.p3.9.m9.1.1.3" xref="S4.SS1.SSS2.p3.9.m9.1.1.3.cmml">aligned</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.9.m9.1b"><apply id="S4.SS1.SSS2.p3.9.m9.1.1.cmml" xref="S4.SS1.SSS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.9.m9.1.1.1.cmml" xref="S4.SS1.SSS2.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.9.m9.1.1.2.cmml" xref="S4.SS1.SSS2.p3.9.m9.1.1.2">𝒟</ci><ci id="S4.SS1.SSS2.p3.9.m9.1.1.3.cmml" xref="S4.SS1.SSS2.p3.9.m9.1.1.3">aligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.9.m9.1c">\mathcal{D}_{\mathrm{aligned}}</annotation></semantics></math> is set to <math id="S4.SS1.SSS2.p3.10.m10.2" class="ltx_Math" alttext="p=|{\mathcal{D}}_{\mathrm{aligned}}|/(|{\mathcal{D}}_{\mathrm{aligned}}|+|\tilde{\mathcal{D}}_{\mathrm{unaligned}}|)" display="inline"><semantics id="S4.SS1.SSS2.p3.10.m10.2a"><mrow id="S4.SS1.SSS2.p3.10.m10.2.2" xref="S4.SS1.SSS2.p3.10.m10.2.2.cmml"><mi id="S4.SS1.SSS2.p3.10.m10.2.2.4" xref="S4.SS1.SSS2.p3.10.m10.2.2.4.cmml">p</mi><mo id="S4.SS1.SSS2.p3.10.m10.2.2.3" xref="S4.SS1.SSS2.p3.10.m10.2.2.3.cmml">=</mo><mrow id="S4.SS1.SSS2.p3.10.m10.2.2.2" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.cmml"><mrow id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.2" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.2.1.cmml">|</mo><msub id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.2" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.3" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.3.cmml">aligned</mi></msub><mo stretchy="false" id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.3" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS1.SSS2.p3.10.m10.2.2.2.3" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.3.cmml">/</mo><mrow id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.2" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.cmml"><mrow id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.2" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.2.1.cmml">|</mo><msub id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.2" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.3" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.3.cmml">aligned</mi></msub><mo stretchy="false" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.3" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.2.1.cmml">|</mo></mrow><mo id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.3" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.3.cmml">+</mo><mrow id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.2.cmml"><mo stretchy="false" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.2" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.2.1.cmml">|</mo><msub id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.cmml"><mover accent="true" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.2" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.2.cmml">𝒟</mi><mo id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.1" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.3" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.3.cmml">unaligned</mi></msub><mo stretchy="false" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.3" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.3" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p3.10.m10.2b"><apply id="S4.SS1.SSS2.p3.10.m10.2.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2"><eq id="S4.SS1.SSS2.p3.10.m10.2.2.3.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.3"></eq><ci id="S4.SS1.SSS2.p3.10.m10.2.2.4.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.4">𝑝</ci><apply id="S4.SS1.SSS2.p3.10.m10.2.2.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2"><divide id="S4.SS1.SSS2.p3.10.m10.2.2.2.3.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.3"></divide><apply id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1"><abs id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.2"></abs><apply id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.2">𝒟</ci><ci id="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p3.10.m10.1.1.1.1.1.1.3">aligned</ci></apply></apply><apply id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1"><plus id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.3.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.3"></plus><apply id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1"><abs id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.2"></abs><apply id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.2">𝒟</ci><ci id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.3.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.1.1.1.3">aligned</ci></apply></apply><apply id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1"><abs id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.2.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.2"></abs><apply id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1">subscript</csymbol><apply id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2"><ci id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.1.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.1">~</ci><ci id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.2.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.2.2">𝒟</ci></apply><ci id="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.3.cmml" xref="S4.SS1.SSS2.p3.10.m10.2.2.2.2.1.1.2.1.1.3">unaligned</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p3.10.m10.2c">p=|{\mathcal{D}}_{\mathrm{aligned}}|/(|{\mathcal{D}}_{\mathrm{aligned}}|+|\tilde{\mathcal{D}}_{\mathrm{unaligned}}|)</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.SSS2.p4" class="ltx_para">
<p id="S4.SS1.SSS2.p4.1" class="ltx_p">Put all together, Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.1.3. Online Inference ‣ 4.1. Exploiting Label Party’s Unaligned Samples ‣ 4. Methodology ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the training procedure of our <span id="S4.SS1.SSS2.p4.1.1" class="ltx_text ltx_font_sansserif">Diffu-AT</span>. Note that for large-scale deep learning based estimation models in online advertising and recommendation systems, the number of epochs is usually set to one.</p>
</div>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3. </span><span id="S4.SS1.SSS3.1.1" class="ltx_text ltx_font_bold">Online Inference</span>
</h4>

<div id="S4.SS1.SSS3.p1" class="ltx_para">
<p id="S4.SS1.SSS3.p1.2" class="ltx_p">During online inference, only the federated branch <math id="S4.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S4.SS1.SSS3.p1.1.m1.1a"><mrow id="S4.SS1.SSS3.p1.1.m1.1.2" xref="S4.SS1.SSS3.p1.1.m1.1.2.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.2.2" xref="S4.SS1.SSS3.p1.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.1.m1.1.2.1" xref="S4.SS1.SSS3.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS3.p1.1.m1.1.2.3.2" xref="S4.SS1.SSS3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p1.1.m1.1.2.3.2.1" xref="S4.SS1.SSS3.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.1.m1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS3.p1.1.m1.1.2.3.2.2" xref="S4.SS1.SSS3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.1.m1.1b"><apply id="S4.SS1.SSS3.p1.1.m1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.2"><times id="S4.SS1.SSS3.p1.1.m1.1.2.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.2.1"></times><ci id="S4.SS1.SSS3.p1.1.m1.1.2.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.2.2">𝑓</ci><ci id="S4.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.1.m1.1c">f(\cdot)</annotation></semantics></math> is needed for producing the real-time predictions, and the local branch <math id="S4.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{L}}(\cdot)" display="inline"><semantics id="S4.SS1.SSS3.p1.2.m2.1a"><mrow id="S4.SS1.SSS3.p1.2.m2.1.2" xref="S4.SS1.SSS3.p1.2.m2.1.2.cmml"><msub id="S4.SS1.SSS3.p1.2.m2.1.2.2" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.cmml"><mover accent="true" id="S4.SS1.SSS3.p1.2.m2.1.2.2.2" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.2.cmml"><mi id="S4.SS1.SSS3.p1.2.m2.1.2.2.2.2" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.2.2.cmml">f</mi><mo id="S4.SS1.SSS3.p1.2.m2.1.2.2.2.1" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S4.SS1.SSS3.p1.2.m2.1.2.2.3" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.2.m2.1.2.1" xref="S4.SS1.SSS3.p1.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS1.SSS3.p1.2.m2.1.2.3.2" xref="S4.SS1.SSS3.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p1.2.m2.1.2.3.2.1" xref="S4.SS1.SSS3.p1.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.SSS3.p1.2.m2.1.1" xref="S4.SS1.SSS3.p1.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.SSS3.p1.2.m2.1.2.3.2.2" xref="S4.SS1.SSS3.p1.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.2.m2.1b"><apply id="S4.SS1.SSS3.p1.2.m2.1.2.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.2"><times id="S4.SS1.SSS3.p1.2.m2.1.2.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.2.1"></times><apply id="S4.SS1.SSS3.p1.2.m2.1.2.2.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.2.m2.1.2.2.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.2.2">subscript</csymbol><apply id="S4.SS1.SSS3.p1.2.m2.1.2.2.2.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.2"><ci id="S4.SS1.SSS3.p1.2.m2.1.2.2.2.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.2.1">~</ci><ci id="S4.SS1.SSS3.p1.2.m2.1.2.2.2.2.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.2.2">𝑓</ci></apply><ci id="S4.SS1.SSS3.p1.2.m2.1.2.2.3.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.2.2.3">L</ci></apply><ci id="S4.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.2.m2.1c">\tilde{f}_{\mathrm{L}}(\cdot)</annotation></semantics></math> is dropped.</p>
</div>
<div id="S4.SS1.SSS3.p2" class="ltx_para">
<p id="S4.SS1.SSS3.p2.1" class="ltx_p">We notice that some studies focus on performing online inference based on a local model owned by label party via distilling knowledge from the federated model, motivated by reducing response time of receiving federated embedding from the non-label party <cite class="ltx_cite ltx_citemacro_citep">(Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2022c</a>; Li et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2022d</a>)</cite>. However, in practice we found that the performance of the distilled local model drops drastically compared to the federated model, which is unacceptable in Alibaba’s advertising business.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Training Procedure of <span id="alg1.4.2" class="ltx_text ltx_font_sansserif">Diffu-AT</span></figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>    1) Aligned samples <math id="alg1.l0.m1.2" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}=\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\}" display="inline"><semantics id="alg1.l0.m1.2a"><mrow id="alg1.l0.m1.2.2" xref="alg1.l0.m1.2.2.cmml"><msub id="alg1.l0.m1.2.2.3" xref="alg1.l0.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m1.2.2.3.2" xref="alg1.l0.m1.2.2.3.2.cmml">𝒟</mi><mi id="alg1.l0.m1.2.2.3.3" xref="alg1.l0.m1.2.2.3.3.cmml">aligned</mi></msub><mo id="alg1.l0.m1.2.2.2" xref="alg1.l0.m1.2.2.2.cmml">=</mo><mrow id="alg1.l0.m1.2.2.1.1" xref="alg1.l0.m1.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l0.m1.2.2.1.1.2" xref="alg1.l0.m1.2.2.1.2.cmml">{</mo><mrow id="alg1.l0.m1.2.2.1.1.1.2" xref="alg1.l0.m1.2.2.1.1.1.3.cmml"><mo stretchy="false" id="alg1.l0.m1.2.2.1.1.1.2.3" xref="alg1.l0.m1.2.2.1.1.1.3.cmml">(</mo><msub id="alg1.l0.m1.2.2.1.1.1.1.1" xref="alg1.l0.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l0.m1.2.2.1.1.1.1.1.2" xref="alg1.l0.m1.2.2.1.1.1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="alg1.l0.m1.2.2.1.1.1.1.1.3" xref="alg1.l0.m1.2.2.1.1.1.1.1.3.cmml">N</mi></msub><mo id="alg1.l0.m1.2.2.1.1.1.2.4" xref="alg1.l0.m1.2.2.1.1.1.3.cmml">,</mo><msub id="alg1.l0.m1.2.2.1.1.1.2.2" xref="alg1.l0.m1.2.2.1.1.1.2.2.cmml"><mi id="alg1.l0.m1.2.2.1.1.1.2.2.2" xref="alg1.l0.m1.2.2.1.1.1.2.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="alg1.l0.m1.2.2.1.1.1.2.2.3" xref="alg1.l0.m1.2.2.1.1.1.2.2.3.cmml">L</mi></msub><mo id="alg1.l0.m1.2.2.1.1.1.2.5" xref="alg1.l0.m1.2.2.1.1.1.3.cmml">,</mo><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="alg1.l0.m1.2.2.1.1.1.2.6" xref="alg1.l0.m1.2.2.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="alg1.l0.m1.2.2.1.1.3" xref="alg1.l0.m1.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.2b"><apply id="alg1.l0.m1.2.2.cmml" xref="alg1.l0.m1.2.2"><eq id="alg1.l0.m1.2.2.2.cmml" xref="alg1.l0.m1.2.2.2"></eq><apply id="alg1.l0.m1.2.2.3.cmml" xref="alg1.l0.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l0.m1.2.2.3.1.cmml" xref="alg1.l0.m1.2.2.3">subscript</csymbol><ci id="alg1.l0.m1.2.2.3.2.cmml" xref="alg1.l0.m1.2.2.3.2">𝒟</ci><ci id="alg1.l0.m1.2.2.3.3.cmml" xref="alg1.l0.m1.2.2.3.3">aligned</ci></apply><set id="alg1.l0.m1.2.2.1.2.cmml" xref="alg1.l0.m1.2.2.1.1"><vector id="alg1.l0.m1.2.2.1.1.1.3.cmml" xref="alg1.l0.m1.2.2.1.1.1.2"><apply id="alg1.l0.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l0.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l0.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l0.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l0.m1.2.2.1.1.1.1.1.2">𝒙</ci><ci id="alg1.l0.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l0.m1.2.2.1.1.1.1.1.3">N</ci></apply><apply id="alg1.l0.m1.2.2.1.1.1.2.2.cmml" xref="alg1.l0.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l0.m1.2.2.1.1.1.2.2.1.cmml" xref="alg1.l0.m1.2.2.1.1.1.2.2">subscript</csymbol><ci id="alg1.l0.m1.2.2.1.1.1.2.2.2.cmml" xref="alg1.l0.m1.2.2.1.1.1.2.2.2">𝒙</ci><ci id="alg1.l0.m1.2.2.1.1.1.2.2.3.cmml" xref="alg1.l0.m1.2.2.1.1.1.2.2.3">L</ci></apply><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝒚</ci></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.2c">\mathcal{D}_{\mathrm{aligned}}=\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\}</annotation></semantics></math>   2) Unaligned samples <math id="alg1.l0.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{unaligned}}=\left\{\left(\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}" display="inline"><semantics id="alg1.l0.m2.1a"><mrow id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml"><msub id="alg1.l0.m2.1.1.3" xref="alg1.l0.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m2.1.1.3.2" xref="alg1.l0.m2.1.1.3.2.cmml">𝒟</mi><mi id="alg1.l0.m2.1.1.3.3" xref="alg1.l0.m2.1.1.3.3.cmml">unaligned</mi></msub><mo id="alg1.l0.m2.1.1.2" xref="alg1.l0.m2.1.1.2.cmml">=</mo><mrow id="alg1.l0.m2.1.1.1.1" xref="alg1.l0.m2.1.1.1.2.cmml"><mo id="alg1.l0.m2.1.1.1.1.2" xref="alg1.l0.m2.1.1.1.2.cmml">{</mo><mrow id="alg1.l0.m2.1.1.1.1.1.2" xref="alg1.l0.m2.1.1.1.1.1.3.cmml"><mo id="alg1.l0.m2.1.1.1.1.1.2.3" xref="alg1.l0.m2.1.1.1.1.1.3.cmml">(</mo><msubsup id="alg1.l0.m2.1.1.1.1.1.1.1" xref="alg1.l0.m2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l0.m2.1.1.1.1.1.1.1.2.2" xref="alg1.l0.m2.1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="alg1.l0.m2.1.1.1.1.1.1.1.2.3" xref="alg1.l0.m2.1.1.1.1.1.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="alg1.l0.m2.1.1.1.1.1.1.1.3" xref="alg1.l0.m2.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="alg1.l0.m2.1.1.1.1.1.2.4" xref="alg1.l0.m2.1.1.1.1.1.3.cmml">,</mo><msup id="alg1.l0.m2.1.1.1.1.1.2.2" xref="alg1.l0.m2.1.1.1.1.1.2.2.cmml"><mi id="alg1.l0.m2.1.1.1.1.1.2.2.2" xref="alg1.l0.m2.1.1.1.1.1.2.2.2.cmml">𝒚</mi><mi mathvariant="normal" id="alg1.l0.m2.1.1.1.1.1.2.2.3" xref="alg1.l0.m2.1.1.1.1.1.2.2.3.cmml">u</mi></msup><mo id="alg1.l0.m2.1.1.1.1.1.2.5" xref="alg1.l0.m2.1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l0.m2.1.1.1.1.3" xref="alg1.l0.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><apply id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1"><eq id="alg1.l0.m2.1.1.2.cmml" xref="alg1.l0.m2.1.1.2"></eq><apply id="alg1.l0.m2.1.1.3.cmml" xref="alg1.l0.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.3.1.cmml" xref="alg1.l0.m2.1.1.3">subscript</csymbol><ci id="alg1.l0.m2.1.1.3.2.cmml" xref="alg1.l0.m2.1.1.3.2">𝒟</ci><ci id="alg1.l0.m2.1.1.3.3.cmml" xref="alg1.l0.m2.1.1.3.3">unaligned</ci></apply><set id="alg1.l0.m2.1.1.1.2.cmml" xref="alg1.l0.m2.1.1.1.1"><interval closure="open" id="alg1.l0.m2.1.1.1.1.1.3.cmml" xref="alg1.l0.m2.1.1.1.1.1.2"><apply id="alg1.l0.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l0.m2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l0.m2.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="alg1.l0.m2.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.1.2.3">L</ci></apply><ci id="alg1.l0.m2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l0.m2.1.1.1.1.1.1.1.3">u</ci></apply><apply id="alg1.l0.m2.1.1.1.1.1.2.2.cmml" xref="alg1.l0.m2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l0.m2.1.1.1.1.1.2.2.1.cmml" xref="alg1.l0.m2.1.1.1.1.1.2.2">superscript</csymbol><ci id="alg1.l0.m2.1.1.1.1.1.2.2.2.cmml" xref="alg1.l0.m2.1.1.1.1.1.2.2.2">𝒚</ci><ci id="alg1.l0.m2.1.1.1.1.1.2.2.3.cmml" xref="alg1.l0.m2.1.1.1.1.1.2.2.3">u</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\mathcal{D}_{\mathrm{unaligned}}=\left\{\left(\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}</annotation></semantics></math>
</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  The federated model <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="alg1.l0a.m1.1a"><mrow id="alg1.l0a.m1.1.2" xref="alg1.l0a.m1.1.2.cmml"><mi id="alg1.l0a.m1.1.2.2" xref="alg1.l0a.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg1.l0a.m1.1.2.1" xref="alg1.l0a.m1.1.2.1.cmml">​</mo><mrow id="alg1.l0a.m1.1.2.3.2" xref="alg1.l0a.m1.1.2.cmml"><mo stretchy="false" id="alg1.l0a.m1.1.2.3.2.1" xref="alg1.l0a.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.l0a.m1.1.2.3.2.2" xref="alg1.l0a.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.2.cmml" xref="alg1.l0a.m1.1.2"><times id="alg1.l0a.m1.1.2.1.cmml" xref="alg1.l0a.m1.1.2.1"></times><ci id="alg1.l0a.m1.1.2.2.cmml" xref="alg1.l0a.m1.1.2.2">𝑓</ci><ci id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">f(\cdot)</annotation></semantics></math> composed of <math id="alg1.l0a.m2.5" class="ltx_Math" alttext="\left({f}_{\mathrm{L}}^{(\mathrm{b})},{f}_{\mathrm{L}}^{(\mathrm{t})},{f}_{\mathrm{N}}\right)" display="inline"><semantics id="alg1.l0a.m2.5a"><mrow id="alg1.l0a.m2.5.5.3" xref="alg1.l0a.m2.5.5.4.cmml"><mo id="alg1.l0a.m2.5.5.3.4" xref="alg1.l0a.m2.5.5.4.cmml">(</mo><msubsup id="alg1.l0a.m2.3.3.1.1" xref="alg1.l0a.m2.3.3.1.1.cmml"><mi id="alg1.l0a.m2.3.3.1.1.2.2" xref="alg1.l0a.m2.3.3.1.1.2.2.cmml">f</mi><mi mathvariant="normal" id="alg1.l0a.m2.3.3.1.1.2.3" xref="alg1.l0a.m2.3.3.1.1.2.3.cmml">L</mi><mrow id="alg1.l0a.m2.1.1.1.3" xref="alg1.l0a.m2.3.3.1.1.cmml"><mo stretchy="false" id="alg1.l0a.m2.1.1.1.3.1" xref="alg1.l0a.m2.3.3.1.1.cmml">(</mo><mi mathvariant="normal" id="alg1.l0a.m2.1.1.1.1" xref="alg1.l0a.m2.1.1.1.1.cmml">b</mi><mo stretchy="false" id="alg1.l0a.m2.1.1.1.3.2" xref="alg1.l0a.m2.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l0a.m2.5.5.3.5" xref="alg1.l0a.m2.5.5.4.cmml">,</mo><msubsup id="alg1.l0a.m2.4.4.2.2" xref="alg1.l0a.m2.4.4.2.2.cmml"><mi id="alg1.l0a.m2.4.4.2.2.2.2" xref="alg1.l0a.m2.4.4.2.2.2.2.cmml">f</mi><mi mathvariant="normal" id="alg1.l0a.m2.4.4.2.2.2.3" xref="alg1.l0a.m2.4.4.2.2.2.3.cmml">L</mi><mrow id="alg1.l0a.m2.2.2.1.3" xref="alg1.l0a.m2.4.4.2.2.cmml"><mo stretchy="false" id="alg1.l0a.m2.2.2.1.3.1" xref="alg1.l0a.m2.4.4.2.2.cmml">(</mo><mi mathvariant="normal" id="alg1.l0a.m2.2.2.1.1" xref="alg1.l0a.m2.2.2.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l0a.m2.2.2.1.3.2" xref="alg1.l0a.m2.4.4.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l0a.m2.5.5.3.6" xref="alg1.l0a.m2.5.5.4.cmml">,</mo><msub id="alg1.l0a.m2.5.5.3.3" xref="alg1.l0a.m2.5.5.3.3.cmml"><mi id="alg1.l0a.m2.5.5.3.3.2" xref="alg1.l0a.m2.5.5.3.3.2.cmml">f</mi><mi mathvariant="normal" id="alg1.l0a.m2.5.5.3.3.3" xref="alg1.l0a.m2.5.5.3.3.3.cmml">N</mi></msub><mo id="alg1.l0a.m2.5.5.3.7" xref="alg1.l0a.m2.5.5.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0a.m2.5b"><vector id="alg1.l0a.m2.5.5.4.cmml" xref="alg1.l0a.m2.5.5.3"><apply id="alg1.l0a.m2.3.3.1.1.cmml" xref="alg1.l0a.m2.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m2.3.3.1.1.1.cmml" xref="alg1.l0a.m2.3.3.1.1">superscript</csymbol><apply id="alg1.l0a.m2.3.3.1.1.2.cmml" xref="alg1.l0a.m2.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m2.3.3.1.1.2.1.cmml" xref="alg1.l0a.m2.3.3.1.1">subscript</csymbol><ci id="alg1.l0a.m2.3.3.1.1.2.2.cmml" xref="alg1.l0a.m2.3.3.1.1.2.2">𝑓</ci><ci id="alg1.l0a.m2.3.3.1.1.2.3.cmml" xref="alg1.l0a.m2.3.3.1.1.2.3">L</ci></apply><ci id="alg1.l0a.m2.1.1.1.1.cmml" xref="alg1.l0a.m2.1.1.1.1">b</ci></apply><apply id="alg1.l0a.m2.4.4.2.2.cmml" xref="alg1.l0a.m2.4.4.2.2"><csymbol cd="ambiguous" id="alg1.l0a.m2.4.4.2.2.1.cmml" xref="alg1.l0a.m2.4.4.2.2">superscript</csymbol><apply id="alg1.l0a.m2.4.4.2.2.2.cmml" xref="alg1.l0a.m2.4.4.2.2"><csymbol cd="ambiguous" id="alg1.l0a.m2.4.4.2.2.2.1.cmml" xref="alg1.l0a.m2.4.4.2.2">subscript</csymbol><ci id="alg1.l0a.m2.4.4.2.2.2.2.cmml" xref="alg1.l0a.m2.4.4.2.2.2.2">𝑓</ci><ci id="alg1.l0a.m2.4.4.2.2.2.3.cmml" xref="alg1.l0a.m2.4.4.2.2.2.3">L</ci></apply><ci id="alg1.l0a.m2.2.2.1.1.cmml" xref="alg1.l0a.m2.2.2.1.1">t</ci></apply><apply id="alg1.l0a.m2.5.5.3.3.cmml" xref="alg1.l0a.m2.5.5.3.3"><csymbol cd="ambiguous" id="alg1.l0a.m2.5.5.3.3.1.cmml" xref="alg1.l0a.m2.5.5.3.3">subscript</csymbol><ci id="alg1.l0a.m2.5.5.3.3.2.cmml" xref="alg1.l0a.m2.5.5.3.3.2">𝑓</ci><ci id="alg1.l0a.m2.5.5.3.3.3.cmml" xref="alg1.l0a.m2.5.5.3.3.3">N</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m2.5c">\left({f}_{\mathrm{L}}^{(\mathrm{b})},{f}_{\mathrm{L}}^{(\mathrm{t})},{f}_{\mathrm{N}}\right)</annotation></semantics></math> 

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l1.m1.1a"><mo id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l1.2" class="ltx_text ltx_font_sansserif" style="color:#808080;">Generating Federated Embeddings for Unaligned Samples</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Learn a conditional diffusion model on <math id="alg1.l2.m1.2" class="ltx_Math" alttext="\left\{({\bm{h}}_{\mathrm{N}},{\bm{h}}_{\mathrm{L}},\bm{y})\right\}" display="inline"><semantics id="alg1.l2.m1.2a"><mrow id="alg1.l2.m1.2.2.1" xref="alg1.l2.m1.2.2.2.cmml"><mo id="alg1.l2.m1.2.2.1.2" xref="alg1.l2.m1.2.2.2.cmml">{</mo><mrow id="alg1.l2.m1.2.2.1.1.2" xref="alg1.l2.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.2.3" xref="alg1.l2.m1.2.2.1.1.3.cmml">(</mo><msub id="alg1.l2.m1.2.2.1.1.1.1" xref="alg1.l2.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l2.m1.2.2.1.1.1.1.2" xref="alg1.l2.m1.2.2.1.1.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="alg1.l2.m1.2.2.1.1.1.1.3" xref="alg1.l2.m1.2.2.1.1.1.1.3.cmml">N</mi></msub><mo id="alg1.l2.m1.2.2.1.1.2.4" xref="alg1.l2.m1.2.2.1.1.3.cmml">,</mo><msub id="alg1.l2.m1.2.2.1.1.2.2" xref="alg1.l2.m1.2.2.1.1.2.2.cmml"><mi id="alg1.l2.m1.2.2.1.1.2.2.2" xref="alg1.l2.m1.2.2.1.1.2.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="alg1.l2.m1.2.2.1.1.2.2.3" xref="alg1.l2.m1.2.2.1.1.2.2.3.cmml">L</mi></msub><mo id="alg1.l2.m1.2.2.1.1.2.5" xref="alg1.l2.m1.2.2.1.1.3.cmml">,</mo><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="alg1.l2.m1.2.2.1.1.2.6" xref="alg1.l2.m1.2.2.1.1.3.cmml">)</mo></mrow><mo id="alg1.l2.m1.2.2.1.3" xref="alg1.l2.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><set id="alg1.l2.m1.2.2.2.cmml" xref="alg1.l2.m1.2.2.1"><vector id="alg1.l2.m1.2.2.1.1.3.cmml" xref="alg1.l2.m1.2.2.1.1.2"><apply id="alg1.l2.m1.2.2.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l2.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l2.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l2.m1.2.2.1.1.1.1.2">𝒉</ci><ci id="alg1.l2.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l2.m1.2.2.1.1.1.1.3">N</ci></apply><apply id="alg1.l2.m1.2.2.1.1.2.2.cmml" xref="alg1.l2.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.2.2.1.1.2.2.1.cmml" xref="alg1.l2.m1.2.2.1.1.2.2">subscript</csymbol><ci id="alg1.l2.m1.2.2.1.1.2.2.2.cmml" xref="alg1.l2.m1.2.2.1.1.2.2.2">𝒉</ci><ci id="alg1.l2.m1.2.2.1.1.2.2.3.cmml" xref="alg1.l2.m1.2.2.1.1.2.2.3">L</ci></apply><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝒚</ci></vector></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">\left\{({\bm{h}}_{\mathrm{N}},{\bm{h}}_{\mathrm{L}},\bm{y})\right\}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  Inference on unaligned samples <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\left\{\left(\bm{h}_{\mathrm{L}}^{\mathrm{u}},{\bm{y}}^{\mathrm{u}}\right)\right\}" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.2.cmml"><mo id="alg1.l3.m1.1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">{</mo><mrow id="alg1.l3.m1.1.1.1.1.2" xref="alg1.l3.m1.1.1.1.1.3.cmml"><mo id="alg1.l3.m1.1.1.1.1.2.3" xref="alg1.l3.m1.1.1.1.1.3.cmml">(</mo><msubsup id="alg1.l3.m1.1.1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.1.1.1.1.1.1.2.2" xref="alg1.l3.m1.1.1.1.1.1.1.2.2.cmml">𝒉</mi><mi mathvariant="normal" id="alg1.l3.m1.1.1.1.1.1.1.2.3" xref="alg1.l3.m1.1.1.1.1.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="alg1.l3.m1.1.1.1.1.1.1.3" xref="alg1.l3.m1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="alg1.l3.m1.1.1.1.1.2.4" xref="alg1.l3.m1.1.1.1.1.3.cmml">,</mo><msup id="alg1.l3.m1.1.1.1.1.2.2" xref="alg1.l3.m1.1.1.1.1.2.2.cmml"><mi id="alg1.l3.m1.1.1.1.1.2.2.2" xref="alg1.l3.m1.1.1.1.1.2.2.2.cmml">𝒚</mi><mi mathvariant="normal" id="alg1.l3.m1.1.1.1.1.2.2.3" xref="alg1.l3.m1.1.1.1.1.2.2.3.cmml">u</mi></msup><mo id="alg1.l3.m1.1.1.1.1.2.5" xref="alg1.l3.m1.1.1.1.1.3.cmml">)</mo></mrow><mo id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><set id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1"><interval closure="open" id="alg1.l3.m1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.2"><apply id="alg1.l3.m1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l3.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.2.2">𝒉</ci><ci id="alg1.l3.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.2.3">L</ci></apply><ci id="alg1.l3.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l3.m1.1.1.1.1.1.1.3">u</ci></apply><apply id="alg1.l3.m1.1.1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l3.m1.1.1.1.1.2.2">superscript</csymbol><ci id="alg1.l3.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.2">𝒚</ci><ci id="alg1.l3.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l3.m1.1.1.1.1.2.2.3">u</ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\left\{\left(\bm{h}_{\mathrm{L}}^{\mathrm{u}},{\bm{y}}^{\mathrm{u}}\right)\right\}</annotation></semantics></math>, generating <math id="alg1.l3.m2.1" class="ltx_Math" alttext="\left\{\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}\right\}" display="inline"><semantics id="alg1.l3.m2.1a"><mrow id="alg1.l3.m2.1.1.1" xref="alg1.l3.m2.1.1.2.cmml"><mo id="alg1.l3.m2.1.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">{</mo><msubsup id="alg1.l3.m2.1.1.1.1" xref="alg1.l3.m2.1.1.1.1.cmml"><mover accent="true" id="alg1.l3.m2.1.1.1.1.2.2" xref="alg1.l3.m2.1.1.1.1.2.2.cmml"><mi id="alg1.l3.m2.1.1.1.1.2.2.2" xref="alg1.l3.m2.1.1.1.1.2.2.2.cmml">𝒉</mi><mo id="alg1.l3.m2.1.1.1.1.2.2.1" xref="alg1.l3.m2.1.1.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="alg1.l3.m2.1.1.1.1.2.3" xref="alg1.l3.m2.1.1.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="alg1.l3.m2.1.1.1.1.3" xref="alg1.l3.m2.1.1.1.1.3.cmml">u</mi></msubsup><mo id="alg1.l3.m2.1.1.1.3" xref="alg1.l3.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><set id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.1"><apply id="alg1.l3.m2.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.1.1.cmml" xref="alg1.l3.m2.1.1.1.1">superscript</csymbol><apply id="alg1.l3.m2.1.1.1.1.2.cmml" xref="alg1.l3.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.1.2.1.cmml" xref="alg1.l3.m2.1.1.1.1">subscript</csymbol><apply id="alg1.l3.m2.1.1.1.1.2.2.cmml" xref="alg1.l3.m2.1.1.1.1.2.2"><ci id="alg1.l3.m2.1.1.1.1.2.2.1.cmml" xref="alg1.l3.m2.1.1.1.1.2.2.1">~</ci><ci id="alg1.l3.m2.1.1.1.1.2.2.2.cmml" xref="alg1.l3.m2.1.1.1.1.2.2.2">𝒉</ci></apply><ci id="alg1.l3.m2.1.1.1.1.2.3.cmml" xref="alg1.l3.m2.1.1.1.1.2.3">N</ci></apply><ci id="alg1.l3.m2.1.1.1.1.3.cmml" xref="alg1.l3.m2.1.1.1.1.3">u</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\left\{\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}}\right\}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\tilde{\mathcal{D}}_{\mathrm{unaligned}}=\left\{\left(\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}},\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><msub id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mover accent="true" id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.3.2.2" xref="alg1.l4.m1.1.1.3.2.2.cmml">𝒟</mi><mo id="alg1.l4.m1.1.1.3.2.1" xref="alg1.l4.m1.1.1.3.2.1.cmml">~</mo></mover><mi id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">unaligned</mi></msub><mo id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">=</mo><mrow id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.2.cmml"><mo id="alg1.l4.m1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.cmml">{</mo><mrow id="alg1.l4.m1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.4.cmml"><mo id="alg1.l4.m1.1.1.1.1.1.3.4" xref="alg1.l4.m1.1.1.1.1.1.4.cmml">(</mo><msubsup id="alg1.l4.m1.1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="alg1.l4.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.1.2.2.2" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.2.2.cmml">𝒉</mi><mo id="alg1.l4.m1.1.1.1.1.1.1.1.2.2.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="alg1.l4.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="alg1.l4.m1.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="alg1.l4.m1.1.1.1.1.1.3.5" xref="alg1.l4.m1.1.1.1.1.1.4.cmml">,</mo><msubsup id="alg1.l4.m1.1.1.1.1.1.2.2" xref="alg1.l4.m1.1.1.1.1.1.2.2.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.2.2.2.2" xref="alg1.l4.m1.1.1.1.1.1.2.2.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="alg1.l4.m1.1.1.1.1.1.2.2.2.3" xref="alg1.l4.m1.1.1.1.1.1.2.2.2.3.cmml">L</mi><mi mathvariant="normal" id="alg1.l4.m1.1.1.1.1.1.2.2.3" xref="alg1.l4.m1.1.1.1.1.1.2.2.3.cmml">u</mi></msubsup><mo id="alg1.l4.m1.1.1.1.1.1.3.6" xref="alg1.l4.m1.1.1.1.1.1.4.cmml">,</mo><msup id="alg1.l4.m1.1.1.1.1.1.3.3" xref="alg1.l4.m1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.3.3.2" xref="alg1.l4.m1.1.1.1.1.1.3.3.2.cmml">𝒚</mi><mi mathvariant="normal" id="alg1.l4.m1.1.1.1.1.1.3.3.3" xref="alg1.l4.m1.1.1.1.1.1.3.3.3.cmml">u</mi></msup><mo id="alg1.l4.m1.1.1.1.1.1.3.7" xref="alg1.l4.m1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="alg1.l4.m1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"></eq><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">subscript</csymbol><apply id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2"><ci id="alg1.l4.m1.1.1.3.2.1.cmml" xref="alg1.l4.m1.1.1.3.2.1">~</ci><ci id="alg1.l4.m1.1.1.3.2.2.cmml" xref="alg1.l4.m1.1.1.3.2.2">𝒟</ci></apply><ci id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">unaligned</ci></apply><set id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1"><vector id="alg1.l4.m1.1.1.1.1.1.4.cmml" xref="alg1.l4.m1.1.1.1.1.1.3"><apply id="alg1.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l4.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l4.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.2"><ci id="alg1.l4.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.2.1">~</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.2.2">𝒉</ci></apply><ci id="alg1.l4.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.2.3">N</ci></apply><ci id="alg1.l4.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1.3">u</ci></apply><apply id="alg1.l4.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2">superscript</csymbol><apply id="alg1.l4.m1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2.2.2">𝒙</ci><ci id="alg1.l4.m1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2.2.3">L</ci></apply><ci id="alg1.l4.m1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.2.2.3">u</ci></apply><apply id="alg1.l4.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.3.3">superscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.3.3.2">𝒚</ci><ci id="alg1.l4.m1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.3.3.3">u</ci></apply></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\tilde{\mathcal{D}}_{\mathrm{unaligned}}=\left\{\left(\tilde{\bm{h}}_{\mathrm{N}}^{\mathrm{u}},\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}</annotation></semantics></math>


</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>  <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l5.m1.1a"><mo id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\triangleright</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_sansserif" style="color:#808080;">Alternative Training</span>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>  <math id="alg1.l6.m1.2" class="ltx_Math" alttext="p=|{\mathcal{D}}_{\mathrm{aligned}}|/(|{\mathcal{D}}_{\mathrm{aligned}}|+|\tilde{\mathcal{D}}_{\mathrm{unaligned}}|)" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><mi id="alg1.l6.m1.2.2.4" xref="alg1.l6.m1.2.2.4.cmml">p</mi><mo id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">=</mo><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.2.cmml"><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.3.cmml">aligned</mi></msub><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="alg1.l6.m1.2.2.2.3" xref="alg1.l6.m1.2.2.2.3.cmml">/</mo><mrow id="alg1.l6.m1.2.2.2.2.1" xref="alg1.l6.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.cmml"><mrow id="alg1.l6.m1.2.2.2.2.1.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.2.1.cmml">|</mo><msub id="alg1.l6.m1.2.2.2.2.1.1.1.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.3.cmml">aligned</mi></msub><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.1.2.1.cmml">|</mo></mrow><mo id="alg1.l6.m1.2.2.2.2.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.3.cmml">+</mo><mrow id="alg1.l6.m1.2.2.2.2.1.1.2.1" xref="alg1.l6.m1.2.2.2.2.1.1.2.2.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.2.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.2.2.1.cmml">|</mo><msub id="alg1.l6.m1.2.2.2.2.1.1.2.1.1" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.cmml"><mover accent="true" id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.2" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.2.cmml">𝒟</mi><mo id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.1" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.3.cmml">unaligned</mi></msub><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.1.2.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.2.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1.3" xref="alg1.l6.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><eq id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3"></eq><ci id="alg1.l6.m1.2.2.4.cmml" xref="alg1.l6.m1.2.2.4">𝑝</ci><apply id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2"><divide id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.3"></divide><apply id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1"><abs id="alg1.l6.m1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.2"></abs><apply id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.2">𝒟</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.3">aligned</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1"><plus id="alg1.l6.m1.2.2.2.2.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.3"></plus><apply id="alg1.l6.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1"><abs id="alg1.l6.m1.2.2.2.2.1.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.2"></abs><apply id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.2">𝒟</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.1.1.1.3">aligned</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1"><abs id="alg1.l6.m1.2.2.2.2.1.1.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.2"></abs><apply id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1">subscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2"><ci id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.1">~</ci><ci id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.2.2">𝒟</ci></apply><ci id="alg1.l6.m1.2.2.2.2.1.1.2.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.2.1.1.2.1.1.3">unaligned</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">p=|{\mathcal{D}}_{\mathrm{aligned}}|/(|{\mathcal{D}}_{\mathrm{aligned}}|+|\tilde{\mathcal{D}}_{\mathrm{unaligned}}|)</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>  <span id="alg1.l7.2" class="ltx_text ltx_font_bold">for all</span> epoch <math id="alg1.l7.m1.1" class="ltx_Math" alttext="e\leftarrow 1" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">e</mi><mo stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mn id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑒</ci><cn type="integer" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">e\leftarrow 1</annotation></semantics></math> <span id="alg1.l7.3" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l7.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">E</annotation></semantics></math> <span id="alg1.l7.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for all</span> iteration <math id="alg1.l8.m1.1" class="ltx_Math" alttext="i\leftarrow 1" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">i</mi><mo stretchy="false" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">←</mo><mn id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">←</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">i\leftarrow 1</annotation></semantics></math> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l8.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">I</annotation></semantics></math> <span id="alg1.l8.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        Randomly sampling a value <math id="alg1.l9.m1.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">p</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑝</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">p_{i}</annotation></semantics></math> from <math id="alg1.l9.m2.2" class="ltx_Math" alttext="\mathcal{U}(0,1)" display="inline"><semantics id="alg1.l9.m2.2a"><mrow id="alg1.l9.m2.2.3" xref="alg1.l9.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m2.2.3.2" xref="alg1.l9.m2.2.3.2.cmml">𝒰</mi><mo lspace="0em" rspace="0em" id="alg1.l9.m2.2.3.1" xref="alg1.l9.m2.2.3.1.cmml">​</mo><mrow id="alg1.l9.m2.2.3.3.2" xref="alg1.l9.m2.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l9.m2.2.3.3.2.1" xref="alg1.l9.m2.2.3.3.1.cmml">(</mo><mn id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">0</mn><mo id="alg1.l9.m2.2.3.3.2.2" xref="alg1.l9.m2.2.3.3.1.cmml">,</mo><mn id="alg1.l9.m2.2.2" xref="alg1.l9.m2.2.2.cmml">1</mn><mo stretchy="false" id="alg1.l9.m2.2.3.3.2.3" xref="alg1.l9.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.2b"><apply id="alg1.l9.m2.2.3.cmml" xref="alg1.l9.m2.2.3"><times id="alg1.l9.m2.2.3.1.cmml" xref="alg1.l9.m2.2.3.1"></times><ci id="alg1.l9.m2.2.3.2.cmml" xref="alg1.l9.m2.2.3.2">𝒰</ci><interval closure="open" id="alg1.l9.m2.2.3.3.1.cmml" xref="alg1.l9.m2.2.3.3.2"><cn type="integer" id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">0</cn><cn type="integer" id="alg1.l9.m2.2.2.cmml" xref="alg1.l9.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.2c">\mathcal{U}(0,1)</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>        <span id="alg1.l10.2" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l10.m1.1" class="ltx_Math" alttext="p_{i}\leq p" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msub id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">p</mi><mi id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">≤</mo><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><leq id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></leq><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝑝</ci><ci id="alg1.l10.m1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">p_{i}\leq p</annotation></semantics></math> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>           Yield a mini-batch from <math id="alg1.l11.m1.1" class="ltx_Math" alttext="{\mathcal{D}}_{\mathrm{aligned}}" display="inline"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">aligned</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝒟</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">aligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">{\mathcal{D}}_{\mathrm{aligned}}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>           Update the parameters of the federated branch <math id="alg1.l12.m1.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.2" xref="alg1.l12.m1.1.2.cmml"><mi id="alg1.l12.m1.1.2.2" xref="alg1.l12.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.2.1" xref="alg1.l12.m1.1.2.1.cmml">​</mo><mrow id="alg1.l12.m1.1.2.3.2" xref="alg1.l12.m1.1.2.cmml"><mo stretchy="false" id="alg1.l12.m1.1.2.3.2.1" xref="alg1.l12.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.l12.m1.1.2.3.2.2" xref="alg1.l12.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.2.cmml" xref="alg1.l12.m1.1.2"><times id="alg1.l12.m1.1.2.1.cmml" xref="alg1.l12.m1.1.2.1"></times><ci id="alg1.l12.m1.1.2.2.cmml" xref="alg1.l12.m1.1.2.2">𝑓</ci><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">f(\cdot)</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>        <span id="alg1.l13.2" class="ltx_text ltx_font_bold">else</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l13.m1.1" class="ltx_Math" alttext="p_{i}&gt;p" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msub id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">p</mi><mi id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">&gt;</mo><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">p</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><gt id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></gt><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝑝</ci><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">p_{i}&gt;p</annotation></semantics></math> <span id="alg1.l13.4" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>           Yield a mini-batch from <math id="alg1.l14.m1.1" class="ltx_Math" alttext="\tilde{\mathcal{D}}_{\mathrm{unaligned}}" display="inline"><semantics id="alg1.l14.m1.1a"><msub id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mover accent="true" id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m1.1.1.2.2" xref="alg1.l14.m1.1.1.2.2.cmml">𝒟</mi><mo id="alg1.l14.m1.1.1.2.1" xref="alg1.l14.m1.1.1.2.1.cmml">~</mo></mover><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">unaligned</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1">subscript</csymbol><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><ci id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2.1">~</ci><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝒟</ci></apply><ci id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">unaligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\tilde{\mathcal{D}}_{\mathrm{unaligned}}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>           Update the parameters of the local branch <math id="alg1.l15.m1.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{L}}(\cdot)" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.2" xref="alg1.l15.m1.1.2.cmml"><msub id="alg1.l15.m1.1.2.2" xref="alg1.l15.m1.1.2.2.cmml"><mover accent="true" id="alg1.l15.m1.1.2.2.2" xref="alg1.l15.m1.1.2.2.2.cmml"><mi id="alg1.l15.m1.1.2.2.2.2" xref="alg1.l15.m1.1.2.2.2.2.cmml">f</mi><mo id="alg1.l15.m1.1.2.2.2.1" xref="alg1.l15.m1.1.2.2.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="alg1.l15.m1.1.2.2.3" xref="alg1.l15.m1.1.2.2.3.cmml">L</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.2.1" xref="alg1.l15.m1.1.2.1.cmml">​</mo><mrow id="alg1.l15.m1.1.2.3.2" xref="alg1.l15.m1.1.2.cmml"><mo stretchy="false" id="alg1.l15.m1.1.2.3.2.1" xref="alg1.l15.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.l15.m1.1.2.3.2.2" xref="alg1.l15.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.2.cmml" xref="alg1.l15.m1.1.2"><times id="alg1.l15.m1.1.2.1.cmml" xref="alg1.l15.m1.1.2.1"></times><apply id="alg1.l15.m1.1.2.2.cmml" xref="alg1.l15.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.2.2.1.cmml" xref="alg1.l15.m1.1.2.2">subscript</csymbol><apply id="alg1.l15.m1.1.2.2.2.cmml" xref="alg1.l15.m1.1.2.2.2"><ci id="alg1.l15.m1.1.2.2.2.1.cmml" xref="alg1.l15.m1.1.2.2.2.1">~</ci><ci id="alg1.l15.m1.1.2.2.2.2.cmml" xref="alg1.l15.m1.1.2.2.2.2">𝑓</ci></apply><ci id="alg1.l15.m1.1.2.2.3.cmml" xref="alg1.l15.m1.1.2.2.3">L</ci></apply><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\tilde{f}_{\mathrm{L}}(\cdot)</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>        <span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>     <span id="alg1.l17.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l17.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>  <span id="alg1.l18.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l18.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
<br class="ltx_break ltx_break">
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Defending Label Inference Attack</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p">As statement in Section <a href="#S2.SS2.SSS2" title="2.2.2. Issues of Effectiveness and Privacy ‣ 2.2. Vertical Federated Learning ‣ 2. Preliminaries ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2.2</span></a>, due to the mathematical expression of the gradient <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\bm{g}</annotation></semantics></math> w.r.t. federated embedding contains label information <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\bm{y}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\bm{y}</annotation></semantics></math>, vFL models may suffer from potential label leakage, which means that a honest-but-curious non-label party can infer private labels. We focus on employ random perturbation methods to protect label information during vFL training.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Given the fact that the label leakage mainly comes from the difference between the magnitudes and directions of samples, an intuitive way to address such problem is to applying random convex combination of gradients while transmitting in the cut layer, also known as mixup <cite class="ltx_cite ltx_citemacro_citep">(Zhang
et al<span class="ltx_text">.</span>, <a href="#bib.bib43" title="" class="ltx_ref">2018</a>)</cite>. To alleviate label leakage, we propose a simple-yet-effective gradient mixup and projection approach named <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_sansserif">MixPro</span>, which performs convex combinations and projections on in-batch sample gradients for protecting private label information. It employs mixup operation as initial perturbation to original gradients, and then performs projection to further remove useless information contained in original gradients.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p"><span id="S4.SS2.p3.1.1" class="ltx_text ltx_font_sansserif">MixPro</span> does not make any assumption about gradient distribution and can be seamlessly integrated into neural network based vFL framework. Next we first introduce the gradient mixup strategy, then adopt gradient projection to further modify the gradient directions to achieve better privacy-preserving performance during vFL model training.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span><span id="S4.SS2.SSS1.1.1" class="ltx_text ltx_font_bold">Gradient Mixup</span>
</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.3" class="ltx_p">For a batch of samples during training, we denote <math id="S4.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\left\{\bm{g}_{i}\right\}_{i=1}^{B}" display="inline"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><msubsup id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml"><mrow id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.SSS1.p1.1.m1.1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p1.1.m1.1.1.1.3.2" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.3.2.cmml">i</mi><mo id="S4.SS2.SSS1.p1.1.m1.1.1.1.3.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.1.m1.1.1.1.3.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS1.p1.1.m1.1.1.3" xref="S4.SS2.SSS1.p1.1.m1.1.1.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><apply id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">subscript</csymbol><set id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1"><apply id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.2">𝒈</ci><ci id="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS2.SSS1.p1.1.m1.1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.3"><eq id="S4.SS2.SSS1.p1.1.m1.1.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.3.1"></eq><ci id="S4.SS2.SSS1.p1.1.m1.1.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS2.SSS1.p1.1.m1.1.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">\left\{\bm{g}_{i}\right\}_{i=1}^{B}</annotation></semantics></math> to be the collection of gradients w.r.t. federated embeddings at the cut layer, where <math id="S4.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><mi id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><ci id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">B</annotation></semantics></math> is the batch size.
We formulate the mixup-based perturbed gradient of the <math id="S4.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><mi id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><ci id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">i</annotation></semantics></math>-th sample to be the convex combination of two sample gradients in the form below:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.3" class="ltx_Math" alttext="{\bm{g}}_{mixed,i}=\lambda\cdot{\bm{g}}_{i}+(1-\lambda)\cdot{\bm{g}}_{r}" display="block"><semantics id="S4.E9.m1.3a"><mrow id="S4.E9.m1.3.3" xref="S4.E9.m1.3.3.cmml"><msub id="S4.E9.m1.3.3.3" xref="S4.E9.m1.3.3.3.cmml"><mi id="S4.E9.m1.3.3.3.2" xref="S4.E9.m1.3.3.3.2.cmml">𝒈</mi><mrow id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.3.cmml"><mrow id="S4.E9.m1.2.2.2.2.1" xref="S4.E9.m1.2.2.2.2.1.cmml"><mi id="S4.E9.m1.2.2.2.2.1.2" xref="S4.E9.m1.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.2.1.1" xref="S4.E9.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E9.m1.2.2.2.2.1.3" xref="S4.E9.m1.2.2.2.2.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.2.1.1a" xref="S4.E9.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E9.m1.2.2.2.2.1.4" xref="S4.E9.m1.2.2.2.2.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.2.1.1b" xref="S4.E9.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E9.m1.2.2.2.2.1.5" xref="S4.E9.m1.2.2.2.2.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.2.1.1c" xref="S4.E9.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E9.m1.2.2.2.2.1.6" xref="S4.E9.m1.2.2.2.2.1.6.cmml">d</mi></mrow><mo id="S4.E9.m1.2.2.2.2.2" xref="S4.E9.m1.2.2.2.3.cmml">,</mo><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">i</mi></mrow></msub><mo id="S4.E9.m1.3.3.2" xref="S4.E9.m1.3.3.2.cmml">=</mo><mrow id="S4.E9.m1.3.3.1" xref="S4.E9.m1.3.3.1.cmml"><mrow id="S4.E9.m1.3.3.1.3" xref="S4.E9.m1.3.3.1.3.cmml"><mi id="S4.E9.m1.3.3.1.3.2" xref="S4.E9.m1.3.3.1.3.2.cmml">λ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E9.m1.3.3.1.3.1" xref="S4.E9.m1.3.3.1.3.1.cmml">⋅</mo><msub id="S4.E9.m1.3.3.1.3.3" xref="S4.E9.m1.3.3.1.3.3.cmml"><mi id="S4.E9.m1.3.3.1.3.3.2" xref="S4.E9.m1.3.3.1.3.3.2.cmml">𝒈</mi><mi id="S4.E9.m1.3.3.1.3.3.3" xref="S4.E9.m1.3.3.1.3.3.3.cmml">i</mi></msub></mrow><mo id="S4.E9.m1.3.3.1.2" xref="S4.E9.m1.3.3.1.2.cmml">+</mo><mrow id="S4.E9.m1.3.3.1.1" xref="S4.E9.m1.3.3.1.1.cmml"><mrow id="S4.E9.m1.3.3.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.3.3.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.3.3.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.cmml"><mn id="S4.E9.m1.3.3.1.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E9.m1.3.3.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E9.m1.3.3.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.3.cmml">λ</mi></mrow><mo rspace="0.055em" stretchy="false" id="S4.E9.m1.3.3.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.E9.m1.3.3.1.1.2" xref="S4.E9.m1.3.3.1.1.2.cmml">⋅</mo><msub id="S4.E9.m1.3.3.1.1.3" xref="S4.E9.m1.3.3.1.1.3.cmml"><mi id="S4.E9.m1.3.3.1.1.3.2" xref="S4.E9.m1.3.3.1.1.3.2.cmml">𝒈</mi><mi id="S4.E9.m1.3.3.1.1.3.3" xref="S4.E9.m1.3.3.1.1.3.3.cmml">r</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.3b"><apply id="S4.E9.m1.3.3.cmml" xref="S4.E9.m1.3.3"><eq id="S4.E9.m1.3.3.2.cmml" xref="S4.E9.m1.3.3.2"></eq><apply id="S4.E9.m1.3.3.3.cmml" xref="S4.E9.m1.3.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.1.cmml" xref="S4.E9.m1.3.3.3">subscript</csymbol><ci id="S4.E9.m1.3.3.3.2.cmml" xref="S4.E9.m1.3.3.3.2">𝒈</ci><list id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2"><apply id="S4.E9.m1.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.1"><times id="S4.E9.m1.2.2.2.2.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1"></times><ci id="S4.E9.m1.2.2.2.2.1.2.cmml" xref="S4.E9.m1.2.2.2.2.1.2">𝑚</ci><ci id="S4.E9.m1.2.2.2.2.1.3.cmml" xref="S4.E9.m1.2.2.2.2.1.3">𝑖</ci><ci id="S4.E9.m1.2.2.2.2.1.4.cmml" xref="S4.E9.m1.2.2.2.2.1.4">𝑥</ci><ci id="S4.E9.m1.2.2.2.2.1.5.cmml" xref="S4.E9.m1.2.2.2.2.1.5">𝑒</ci><ci id="S4.E9.m1.2.2.2.2.1.6.cmml" xref="S4.E9.m1.2.2.2.2.1.6">𝑑</ci></apply><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑖</ci></list></apply><apply id="S4.E9.m1.3.3.1.cmml" xref="S4.E9.m1.3.3.1"><plus id="S4.E9.m1.3.3.1.2.cmml" xref="S4.E9.m1.3.3.1.2"></plus><apply id="S4.E9.m1.3.3.1.3.cmml" xref="S4.E9.m1.3.3.1.3"><ci id="S4.E9.m1.3.3.1.3.1.cmml" xref="S4.E9.m1.3.3.1.3.1">⋅</ci><ci id="S4.E9.m1.3.3.1.3.2.cmml" xref="S4.E9.m1.3.3.1.3.2">𝜆</ci><apply id="S4.E9.m1.3.3.1.3.3.cmml" xref="S4.E9.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.3.3.1.cmml" xref="S4.E9.m1.3.3.1.3.3">subscript</csymbol><ci id="S4.E9.m1.3.3.1.3.3.2.cmml" xref="S4.E9.m1.3.3.1.3.3.2">𝒈</ci><ci id="S4.E9.m1.3.3.1.3.3.3.cmml" xref="S4.E9.m1.3.3.1.3.3.3">𝑖</ci></apply></apply><apply id="S4.E9.m1.3.3.1.1.cmml" xref="S4.E9.m1.3.3.1.1"><ci id="S4.E9.m1.3.3.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.2">⋅</ci><apply id="S4.E9.m1.3.3.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1"><minus id="S4.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E9.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.2">1</cn><ci id="S4.E9.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.1.1.1.3">𝜆</ci></apply><apply id="S4.E9.m1.3.3.1.1.3.cmml" xref="S4.E9.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.1.1.3.1.cmml" xref="S4.E9.m1.3.3.1.1.3">subscript</csymbol><ci id="S4.E9.m1.3.3.1.1.3.2.cmml" xref="S4.E9.m1.3.3.1.1.3.2">𝒈</ci><ci id="S4.E9.m1.3.3.1.1.3.3.cmml" xref="S4.E9.m1.3.3.1.1.3.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.3c">{\bm{g}}_{mixed,i}=\lambda\cdot{\bm{g}}_{i}+(1-\lambda)\cdot{\bm{g}}_{r}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS1.p1.7" class="ltx_p">where <math id="S4.SS2.SSS1.p1.4.m1.1" class="ltx_Math" alttext="{\bm{g}}_{r}" display="inline"><semantics id="S4.SS2.SSS1.p1.4.m1.1a"><msub id="S4.SS2.SSS1.p1.4.m1.1.1" xref="S4.SS2.SSS1.p1.4.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p1.4.m1.1.1.2" xref="S4.SS2.SSS1.p1.4.m1.1.1.2.cmml">𝒈</mi><mi id="S4.SS2.SSS1.p1.4.m1.1.1.3" xref="S4.SS2.SSS1.p1.4.m1.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m1.1b"><apply id="S4.SS2.SSS1.p1.4.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.4.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS1.p1.4.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p1.4.m1.1.1.2">𝒈</ci><ci id="S4.SS2.SSS1.p1.4.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p1.4.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m1.1c">{\bm{g}}_{r}</annotation></semantics></math> is a random sample’s gradient from the given batch. As stated in the original mixup method <cite class="ltx_cite ltx_citemacro_citep">(Zhang
et al<span class="ltx_text">.</span>, <a href="#bib.bib43" title="" class="ltx_ref">2018</a>)</cite>, we choose <math id="S4.SS2.SSS1.p1.5.m2.2" class="ltx_Math" alttext="\lambda\sim\mathrm{Beta}(\alpha,\alpha)" display="inline"><semantics id="S4.SS2.SSS1.p1.5.m2.2a"><mrow id="S4.SS2.SSS1.p1.5.m2.2.3" xref="S4.SS2.SSS1.p1.5.m2.2.3.cmml"><mi id="S4.SS2.SSS1.p1.5.m2.2.3.2" xref="S4.SS2.SSS1.p1.5.m2.2.3.2.cmml">λ</mi><mo id="S4.SS2.SSS1.p1.5.m2.2.3.1" xref="S4.SS2.SSS1.p1.5.m2.2.3.1.cmml">∼</mo><mrow id="S4.SS2.SSS1.p1.5.m2.2.3.3" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.cmml"><mi id="S4.SS2.SSS1.p1.5.m2.2.3.3.2" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.2.cmml">Beta</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS1.p1.5.m2.2.3.3.1" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.1.cmml">​</mo><mrow id="S4.SS2.SSS1.p1.5.m2.2.3.3.3.2" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.SSS1.p1.5.m2.2.3.3.3.2.1" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.3.1.cmml">(</mo><mi id="S4.SS2.SSS1.p1.5.m2.1.1" xref="S4.SS2.SSS1.p1.5.m2.1.1.cmml">α</mi><mo id="S4.SS2.SSS1.p1.5.m2.2.3.3.3.2.2" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.3.1.cmml">,</mo><mi id="S4.SS2.SSS1.p1.5.m2.2.2" xref="S4.SS2.SSS1.p1.5.m2.2.2.cmml">α</mi><mo stretchy="false" id="S4.SS2.SSS1.p1.5.m2.2.3.3.3.2.3" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m2.2b"><apply id="S4.SS2.SSS1.p1.5.m2.2.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.3"><csymbol cd="latexml" id="S4.SS2.SSS1.p1.5.m2.2.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.3.1">similar-to</csymbol><ci id="S4.SS2.SSS1.p1.5.m2.2.3.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.3.2">𝜆</ci><apply id="S4.SS2.SSS1.p1.5.m2.2.3.3.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.3.3"><times id="S4.SS2.SSS1.p1.5.m2.2.3.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.1"></times><ci id="S4.SS2.SSS1.p1.5.m2.2.3.3.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.2">Beta</ci><interval closure="open" id="S4.SS2.SSS1.p1.5.m2.2.3.3.3.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.3.3.3.2"><ci id="S4.SS2.SSS1.p1.5.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m2.1.1">𝛼</ci><ci id="S4.SS2.SSS1.p1.5.m2.2.2.cmml" xref="S4.SS2.SSS1.p1.5.m2.2.2">𝛼</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m2.2c">\lambda\sim\mathrm{Beta}(\alpha,\alpha)</annotation></semantics></math> and set <math id="S4.SS2.SSS1.p1.6.m3.1" class="ltx_Math" alttext="\lambda&gt;0.5" display="inline"><semantics id="S4.SS2.SSS1.p1.6.m3.1a"><mrow id="S4.SS2.SSS1.p1.6.m3.1.1" xref="S4.SS2.SSS1.p1.6.m3.1.1.cmml"><mi id="S4.SS2.SSS1.p1.6.m3.1.1.2" xref="S4.SS2.SSS1.p1.6.m3.1.1.2.cmml">λ</mi><mo id="S4.SS2.SSS1.p1.6.m3.1.1.1" xref="S4.SS2.SSS1.p1.6.m3.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.SSS1.p1.6.m3.1.1.3" xref="S4.SS2.SSS1.p1.6.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.6.m3.1b"><apply id="S4.SS2.SSS1.p1.6.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m3.1.1"><gt id="S4.SS2.SSS1.p1.6.m3.1.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m3.1.1.1"></gt><ci id="S4.SS2.SSS1.p1.6.m3.1.1.2.cmml" xref="S4.SS2.SSS1.p1.6.m3.1.1.2">𝜆</ci><cn type="float" id="S4.SS2.SSS1.p1.6.m3.1.1.3.cmml" xref="S4.SS2.SSS1.p1.6.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.6.m3.1c">\lambda&gt;0.5</annotation></semantics></math>, where <math id="S4.SS2.SSS1.p1.7.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.SSS1.p1.7.m4.1a"><mi id="S4.SS2.SSS1.p1.7.m4.1.1" xref="S4.SS2.SSS1.p1.7.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.7.m4.1b"><ci id="S4.SS2.SSS1.p1.7.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.7.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.7.m4.1c">\alpha</annotation></semantics></math> is a hyperparameter.</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p">Note that we set <math id="S4.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\lambda&gt;0.5" display="inline"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mrow id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p2.1.m1.1.1.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml">λ</mi><mo id="S4.SS2.SSS1.p2.1.m1.1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.cmml">&gt;</mo><mn id="S4.SS2.SSS1.p2.1.m1.1.1.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p2.1.m1.1b"><apply id="S4.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1"><gt id="S4.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.1"></gt><ci id="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.2">𝜆</ci><cn type="float" id="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS2.SSS1.p2.1.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p2.1.m1.1c">\lambda&gt;0.5</annotation></semantics></math> since the perturbed gradients should preserve more information from the original gradient including magnitude and direction to maintain the prediction performance of the vFL model.
We only use the convex combination between two sample gradients in order to simplify the calculation, and we empirically found that this strategy also achieves similar performance with more gradients to be mixed.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<p id="S4.F4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S4.F4.1.1" class="ltx_text"><img src="/html/2305.08328/assets/x4.png" id="S4.F4.1.1.g1" class="ltx_graphics ltx_img_portrait" width="322" height="485" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Illustration of gradient mixup and projection operations in <span id="S4.F4.3.1" class="ltx_text ltx_font_sansserif">MixPro</span> for a training sample’s gradient w.r.t. the federated embedding. </figcaption>
</figure>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span><span id="S4.SS2.SSS2.1.1" class="ltx_text ltx_font_bold">Gradient Projection</span>
</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">The above gradient mixup strategy may still suffer from the label leakage problem induced by the directions of gradients, since the direction information of the original gradient remains in the perturbed gradient to some extent.</p>
</div>
<div id="S4.SS2.SSS2.p2" class="ltx_para">
<p id="S4.SS2.SSS2.p2.1" class="ltx_p">In order to keep the directions of gradients confined to a smaller region, we propose to further perform gradient projection on the mixed gradients.
This is inspired by the studies in multi-task learning models <cite class="ltx_cite ltx_citemacro_citep">(Wang
et al<span class="ltx_text">.</span>, <a href="#bib.bib37" title="" class="ltx_ref">2021</a>; Yu et al<span class="ltx_text">.</span>, <a href="#bib.bib42" title="" class="ltx_ref">2020</a>)</cite>, in which the gradients for different tasks are projected along the direction of main one to avoid the conflict in gradient directions and thus achieve better performance.
Given the intuition that higher similarity of gradients in orientation will effectively alleviate the label leakage from sample gradients, such projection technique in multi-task optimization can be further adopted in defending label leakage in vFL.</p>
</div>
<div id="S4.SS2.SSS2.p3" class="ltx_para">
<p id="S4.SS2.SSS2.p3.4" class="ltx_p">Specifically, we denote <math id="S4.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\bar{\bm{g}}=\frac{1}{B}\sum_{i=1}^{B}\bm{g}_{i}" display="inline"><semantics id="S4.SS2.SSS2.p3.1.m1.1a"><mrow id="S4.SS2.SSS2.p3.1.m1.1.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.cmml"><mover accent="true" id="S4.SS2.SSS2.p3.1.m1.1.1.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.2.cmml"><mi id="S4.SS2.SSS2.p3.1.m1.1.1.2.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.2.2.cmml">𝒈</mi><mo id="S4.SS2.SSS2.p3.1.m1.1.1.2.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.2.1.cmml">¯</mo></mover><mo id="S4.SS2.SSS2.p3.1.m1.1.1.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSS2.p3.1.m1.1.1.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.cmml"><mfrac id="S4.SS2.SSS2.p3.1.m1.1.1.3.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2.cmml"><mn id="S4.SS2.SSS2.p3.1.m1.1.1.3.2.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2.2.cmml">1</mn><mi id="S4.SS2.SSS2.p3.1.m1.1.1.3.2.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.1.m1.1.1.3.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.1.cmml">​</mo><mrow id="S4.SS2.SSS2.p3.1.m1.1.1.3.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.cmml"><msubsup id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.cmml"><mo id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.cmml"><mi id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.3.cmml">B</mi></msubsup><msub id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.cmml"><mi id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.2" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.2.cmml">𝒈</mi><mi id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.3" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.1.m1.1b"><apply id="S4.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1"><eq id="S4.SS2.SSS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.1"></eq><apply id="S4.SS2.SSS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.2"><ci id="S4.SS2.SSS2.p3.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.2.1">¯</ci><ci id="S4.SS2.SSS2.p3.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.2.2">𝒈</ci></apply><apply id="S4.SS2.SSS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3"><times id="S4.SS2.SSS2.p3.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.1"></times><apply id="S4.SS2.SSS2.p3.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2"><divide id="S4.SS2.SSS2.p3.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2"></divide><cn type="integer" id="S4.SS2.SSS2.p3.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2.2">1</cn><ci id="S4.SS2.SSS2.p3.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.2.3">𝐵</ci></apply><apply id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3"><apply id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1">superscript</csymbol><apply id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1">subscript</csymbol><sum id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.2"></sum><apply id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3"><eq id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.1"></eq><ci id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.1.3">𝐵</ci></apply><apply id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.2.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.2">𝒈</ci><ci id="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.3.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.1.m1.1c">\bar{\bm{g}}=\frac{1}{B}\sum_{i=1}^{B}\bm{g}_{i}</annotation></semantics></math> as the average gradient for a batch of samples.
We set the goal of the cosine similarity between the an in-batch gradient <math id="S4.SS2.SSS2.p3.2.m2.2" class="ltx_Math" alttext="\bm{g}_{mixed,i}" display="inline"><semantics id="S4.SS2.SSS2.p3.2.m2.2a"><msub id="S4.SS2.SSS2.p3.2.m2.2.3" xref="S4.SS2.SSS2.p3.2.m2.2.3.cmml"><mi id="S4.SS2.SSS2.p3.2.m2.2.3.2" xref="S4.SS2.SSS2.p3.2.m2.2.3.2.cmml">𝒈</mi><mrow id="S4.SS2.SSS2.p3.2.m2.2.2.2.2" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.3.cmml"><mrow id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.cmml"><mi id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.2" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.3" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1a" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.4" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1b" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.5" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1c" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.6" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.6.cmml">d</mi></mrow><mo id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.2" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS2.p3.2.m2.1.1.1.1" xref="S4.SS2.SSS2.p3.2.m2.1.1.1.1.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.2.m2.2b"><apply id="S4.SS2.SSS2.p3.2.m2.2.3.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.2.m2.2.3.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.3">subscript</csymbol><ci id="S4.SS2.SSS2.p3.2.m2.2.3.2.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.3.2">𝒈</ci><list id="S4.SS2.SSS2.p3.2.m2.2.2.2.3.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2"><apply id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1"><times id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.1"></times><ci id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.2.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.2">𝑚</ci><ci id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.3.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.3">𝑖</ci><ci id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.4.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.4">𝑥</ci><ci id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.5.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.5">𝑒</ci><ci id="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.6.cmml" xref="S4.SS2.SSS2.p3.2.m2.2.2.2.2.1.6">𝑑</ci></apply><ci id="S4.SS2.SSS2.p3.2.m2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.2.m2.2c">\bm{g}_{mixed,i}</annotation></semantics></math> and the average gradient <math id="S4.SS2.SSS2.p3.3.m3.1" class="ltx_Math" alttext="\bar{\bm{g}}" display="inline"><semantics id="S4.SS2.SSS2.p3.3.m3.1a"><mover accent="true" id="S4.SS2.SSS2.p3.3.m3.1.1" xref="S4.SS2.SSS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.SSS2.p3.3.m3.1.1.2" xref="S4.SS2.SSS2.p3.3.m3.1.1.2.cmml">𝒈</mi><mo id="S4.SS2.SSS2.p3.3.m3.1.1.1" xref="S4.SS2.SSS2.p3.3.m3.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.3.m3.1b"><apply id="S4.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1"><ci id="S4.SS2.SSS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1.1">¯</ci><ci id="S4.SS2.SSS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1.2">𝒈</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.3.m3.1c">\bar{\bm{g}}</annotation></semantics></math> is that it should be larger than a pre-defined threshold <math id="S4.SS2.SSS2.p3.4.m4.2" class="ltx_Math" alttext="\phi_{goal}\in[-1,1]" display="inline"><semantics id="S4.SS2.SSS2.p3.4.m4.2a"><mrow id="S4.SS2.SSS2.p3.4.m4.2.2" xref="S4.SS2.SSS2.p3.4.m4.2.2.cmml"><msub id="S4.SS2.SSS2.p3.4.m4.2.2.3" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.cmml"><mi id="S4.SS2.SSS2.p3.4.m4.2.2.3.2" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.2.cmml">ϕ</mi><mrow id="S4.SS2.SSS2.p3.4.m4.2.2.3.3" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.cmml"><mi id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.2" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.1" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.1.cmml">​</mo><mi id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.3" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.1a" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.1.cmml">​</mo><mi id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.4" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.1b" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.1.cmml">​</mo><mi id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.5" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.5.cmml">l</mi></mrow></msub><mo id="S4.SS2.SSS2.p3.4.m4.2.2.2" xref="S4.SS2.SSS2.p3.4.m4.2.2.2.cmml">∈</mo><mrow id="S4.SS2.SSS2.p3.4.m4.2.2.1.1" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.2" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.2.cmml">[</mo><mrow id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1.cmml"><mo id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1a" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1.2" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1.2.cmml">1</mn></mrow><mo id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.3" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.2.cmml">,</mo><mn id="S4.SS2.SSS2.p3.4.m4.1.1" xref="S4.SS2.SSS2.p3.4.m4.1.1.cmml">1</mn><mo stretchy="false" id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.4" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.4.m4.2b"><apply id="S4.SS2.SSS2.p3.4.m4.2.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2"><in id="S4.SS2.SSS2.p3.4.m4.2.2.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.2"></in><apply id="S4.SS2.SSS2.p3.4.m4.2.2.3.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p3.4.m4.2.2.3.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3">subscript</csymbol><ci id="S4.SS2.SSS2.p3.4.m4.2.2.3.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.2">italic-ϕ</ci><apply id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3"><times id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.1"></times><ci id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.2">𝑔</ci><ci id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.3.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.3">𝑜</ci><ci id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.4.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.4">𝑎</ci><ci id="S4.SS2.SSS2.p3.4.m4.2.2.3.3.5.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.3.3.5">𝑙</ci></apply></apply><interval closure="closed" id="S4.SS2.SSS2.p3.4.m4.2.2.1.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.1"><apply id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1"><minus id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1"></minus><cn type="integer" id="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p3.4.m4.2.2.1.1.1.2">1</cn></apply><cn type="integer" id="S4.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.1.1">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.4.m4.2c">\phi_{goal}\in[-1,1]</annotation></semantics></math>:</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.5" class="ltx_Math" alttext="\phi_{i}=\cos\left(\bm{g}_{mixed,i},\bar{\bm{g}}\right)\geq\phi_{goal}\,." display="block"><semantics id="S4.E10.m1.5a"><mrow id="S4.E10.m1.5.5.1" xref="S4.E10.m1.5.5.1.1.cmml"><mrow id="S4.E10.m1.5.5.1.1" xref="S4.E10.m1.5.5.1.1.cmml"><msub id="S4.E10.m1.5.5.1.1.3" xref="S4.E10.m1.5.5.1.1.3.cmml"><mi id="S4.E10.m1.5.5.1.1.3.2" xref="S4.E10.m1.5.5.1.1.3.2.cmml">ϕ</mi><mi id="S4.E10.m1.5.5.1.1.3.3" xref="S4.E10.m1.5.5.1.1.3.3.cmml">i</mi></msub><mo id="S4.E10.m1.5.5.1.1.4" xref="S4.E10.m1.5.5.1.1.4.cmml">=</mo><mrow id="S4.E10.m1.5.5.1.1.1.1" xref="S4.E10.m1.5.5.1.1.1.2.cmml"><mi id="S4.E10.m1.3.3" xref="S4.E10.m1.3.3.cmml">cos</mi><mo id="S4.E10.m1.5.5.1.1.1.1a" xref="S4.E10.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S4.E10.m1.5.5.1.1.1.1.1" xref="S4.E10.m1.5.5.1.1.1.2.cmml"><mo id="S4.E10.m1.5.5.1.1.1.1.1.2" xref="S4.E10.m1.5.5.1.1.1.2.cmml">(</mo><msub id="S4.E10.m1.5.5.1.1.1.1.1.1" xref="S4.E10.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.5.5.1.1.1.1.1.1.2" xref="S4.E10.m1.5.5.1.1.1.1.1.1.2.cmml">𝒈</mi><mrow id="S4.E10.m1.2.2.2.2" xref="S4.E10.m1.2.2.2.3.cmml"><mrow id="S4.E10.m1.2.2.2.2.1" xref="S4.E10.m1.2.2.2.2.1.cmml"><mi id="S4.E10.m1.2.2.2.2.1.2" xref="S4.E10.m1.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.2.2.1.1" xref="S4.E10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E10.m1.2.2.2.2.1.3" xref="S4.E10.m1.2.2.2.2.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.2.2.1.1a" xref="S4.E10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E10.m1.2.2.2.2.1.4" xref="S4.E10.m1.2.2.2.2.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.2.2.1.1b" xref="S4.E10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E10.m1.2.2.2.2.1.5" xref="S4.E10.m1.2.2.2.2.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.2.2.2.2.1.1c" xref="S4.E10.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E10.m1.2.2.2.2.1.6" xref="S4.E10.m1.2.2.2.2.1.6.cmml">d</mi></mrow><mo id="S4.E10.m1.2.2.2.2.2" xref="S4.E10.m1.2.2.2.3.cmml">,</mo><mi id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">i</mi></mrow></msub><mo id="S4.E10.m1.5.5.1.1.1.1.1.3" xref="S4.E10.m1.5.5.1.1.1.2.cmml">,</mo><mover accent="true" id="S4.E10.m1.4.4" xref="S4.E10.m1.4.4.cmml"><mi id="S4.E10.m1.4.4.2" xref="S4.E10.m1.4.4.2.cmml">𝒈</mi><mo id="S4.E10.m1.4.4.1" xref="S4.E10.m1.4.4.1.cmml">¯</mo></mover><mo id="S4.E10.m1.5.5.1.1.1.1.1.4" xref="S4.E10.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.5.5.1.1.5" xref="S4.E10.m1.5.5.1.1.5.cmml">≥</mo><msub id="S4.E10.m1.5.5.1.1.6" xref="S4.E10.m1.5.5.1.1.6.cmml"><mi id="S4.E10.m1.5.5.1.1.6.2" xref="S4.E10.m1.5.5.1.1.6.2.cmml">ϕ</mi><mrow id="S4.E10.m1.5.5.1.1.6.3" xref="S4.E10.m1.5.5.1.1.6.3.cmml"><mi id="S4.E10.m1.5.5.1.1.6.3.2" xref="S4.E10.m1.5.5.1.1.6.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.5.5.1.1.6.3.1" xref="S4.E10.m1.5.5.1.1.6.3.1.cmml">​</mo><mi id="S4.E10.m1.5.5.1.1.6.3.3" xref="S4.E10.m1.5.5.1.1.6.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.5.5.1.1.6.3.1a" xref="S4.E10.m1.5.5.1.1.6.3.1.cmml">​</mo><mi id="S4.E10.m1.5.5.1.1.6.3.4" xref="S4.E10.m1.5.5.1.1.6.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E10.m1.5.5.1.1.6.3.1b" xref="S4.E10.m1.5.5.1.1.6.3.1.cmml">​</mo><mi id="S4.E10.m1.5.5.1.1.6.3.5" xref="S4.E10.m1.5.5.1.1.6.3.5.cmml">l</mi></mrow></msub></mrow><mo lspace="0em" id="S4.E10.m1.5.5.1.2" xref="S4.E10.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.5b"><apply id="S4.E10.m1.5.5.1.1.cmml" xref="S4.E10.m1.5.5.1"><and id="S4.E10.m1.5.5.1.1a.cmml" xref="S4.E10.m1.5.5.1"></and><apply id="S4.E10.m1.5.5.1.1b.cmml" xref="S4.E10.m1.5.5.1"><eq id="S4.E10.m1.5.5.1.1.4.cmml" xref="S4.E10.m1.5.5.1.1.4"></eq><apply id="S4.E10.m1.5.5.1.1.3.cmml" xref="S4.E10.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.3.1.cmml" xref="S4.E10.m1.5.5.1.1.3">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.3.2.cmml" xref="S4.E10.m1.5.5.1.1.3.2">italic-ϕ</ci><ci id="S4.E10.m1.5.5.1.1.3.3.cmml" xref="S4.E10.m1.5.5.1.1.3.3">𝑖</ci></apply><apply id="S4.E10.m1.5.5.1.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1"><cos id="S4.E10.m1.3.3.cmml" xref="S4.E10.m1.3.3"></cos><apply id="S4.E10.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.5.5.1.1.1.1.1.1.2">𝒈</ci><list id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.2"><apply id="S4.E10.m1.2.2.2.2.1.cmml" xref="S4.E10.m1.2.2.2.2.1"><times id="S4.E10.m1.2.2.2.2.1.1.cmml" xref="S4.E10.m1.2.2.2.2.1.1"></times><ci id="S4.E10.m1.2.2.2.2.1.2.cmml" xref="S4.E10.m1.2.2.2.2.1.2">𝑚</ci><ci id="S4.E10.m1.2.2.2.2.1.3.cmml" xref="S4.E10.m1.2.2.2.2.1.3">𝑖</ci><ci id="S4.E10.m1.2.2.2.2.1.4.cmml" xref="S4.E10.m1.2.2.2.2.1.4">𝑥</ci><ci id="S4.E10.m1.2.2.2.2.1.5.cmml" xref="S4.E10.m1.2.2.2.2.1.5">𝑒</ci><ci id="S4.E10.m1.2.2.2.2.1.6.cmml" xref="S4.E10.m1.2.2.2.2.1.6">𝑑</ci></apply><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">𝑖</ci></list></apply><apply id="S4.E10.m1.4.4.cmml" xref="S4.E10.m1.4.4"><ci id="S4.E10.m1.4.4.1.cmml" xref="S4.E10.m1.4.4.1">¯</ci><ci id="S4.E10.m1.4.4.2.cmml" xref="S4.E10.m1.4.4.2">𝒈</ci></apply></apply></apply><apply id="S4.E10.m1.5.5.1.1c.cmml" xref="S4.E10.m1.5.5.1"><geq id="S4.E10.m1.5.5.1.1.5.cmml" xref="S4.E10.m1.5.5.1.1.5"></geq><share href="#S4.E10.m1.5.5.1.1.1.cmml" id="S4.E10.m1.5.5.1.1d.cmml" xref="S4.E10.m1.5.5.1"></share><apply id="S4.E10.m1.5.5.1.1.6.cmml" xref="S4.E10.m1.5.5.1.1.6"><csymbol cd="ambiguous" id="S4.E10.m1.5.5.1.1.6.1.cmml" xref="S4.E10.m1.5.5.1.1.6">subscript</csymbol><ci id="S4.E10.m1.5.5.1.1.6.2.cmml" xref="S4.E10.m1.5.5.1.1.6.2">italic-ϕ</ci><apply id="S4.E10.m1.5.5.1.1.6.3.cmml" xref="S4.E10.m1.5.5.1.1.6.3"><times id="S4.E10.m1.5.5.1.1.6.3.1.cmml" xref="S4.E10.m1.5.5.1.1.6.3.1"></times><ci id="S4.E10.m1.5.5.1.1.6.3.2.cmml" xref="S4.E10.m1.5.5.1.1.6.3.2">𝑔</ci><ci id="S4.E10.m1.5.5.1.1.6.3.3.cmml" xref="S4.E10.m1.5.5.1.1.6.3.3">𝑜</ci><ci id="S4.E10.m1.5.5.1.1.6.3.4.cmml" xref="S4.E10.m1.5.5.1.1.6.3.4">𝑎</ci><ci id="S4.E10.m1.5.5.1.1.6.3.5.cmml" xref="S4.E10.m1.5.5.1.1.6.3.5">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.5c">\phi_{i}=\cos\left(\bm{g}_{mixed,i},\bar{\bm{g}}\right)\geq\phi_{goal}\,.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.SSS2.p4" class="ltx_para">
<p id="S4.SS2.SSS2.p4.1" class="ltx_p">For a sample where the similarity goal is not achieved (that is, <math id="S4.SS2.SSS2.p4.1.m1.1" class="ltx_Math" alttext="\phi_{goal}&gt;\phi_{i}" display="inline"><semantics id="S4.SS2.SSS2.p4.1.m1.1a"><mrow id="S4.SS2.SSS2.p4.1.m1.1.1" xref="S4.SS2.SSS2.p4.1.m1.1.1.cmml"><msub id="S4.SS2.SSS2.p4.1.m1.1.1.2" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.cmml"><mi id="S4.SS2.SSS2.p4.1.m1.1.1.2.2" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.2.cmml">ϕ</mi><mrow id="S4.SS2.SSS2.p4.1.m1.1.1.2.3" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.cmml"><mi id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.2" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.1" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.3" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.1a" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.4" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.1b" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.5" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.5.cmml">l</mi></mrow></msub><mo id="S4.SS2.SSS2.p4.1.m1.1.1.1" xref="S4.SS2.SSS2.p4.1.m1.1.1.1.cmml">&gt;</mo><msub id="S4.SS2.SSS2.p4.1.m1.1.1.3" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p4.1.m1.1.1.3.2" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.2.cmml">ϕ</mi><mi id="S4.SS2.SSS2.p4.1.m1.1.1.3.3" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p4.1.m1.1b"><apply id="S4.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1"><gt id="S4.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.1"></gt><apply id="S4.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.1.m1.1.1.2.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.SSS2.p4.1.m1.1.1.2.2.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.2">italic-ϕ</ci><apply id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3"><times id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.1"></times><ci id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.2.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.2">𝑔</ci><ci id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.3.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.3">𝑜</ci><ci id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.4.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.4">𝑎</ci><ci id="S4.SS2.SSS2.p4.1.m1.1.1.2.3.5.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.2.3.5">𝑙</ci></apply></apply><apply id="S4.SS2.SSS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.SSS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.2">italic-ϕ</ci><ci id="S4.SS2.SSS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p4.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p4.1.m1.1c">\phi_{goal}&gt;\phi_{i}</annotation></semantics></math>), the following projection operation will be applied and we obtain the projected gradient:</p>
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex1.m1.4" class="ltx_Math" alttext="\displaystyle\bm{g}_{projected,i}=\bm{g}_{mixed,i}\ +" display="inline"><semantics id="S4.Ex1.m1.4a"><mrow id="S4.Ex1.m1.4.5" xref="S4.Ex1.m1.4.5.cmml"><msub id="S4.Ex1.m1.4.5.2" xref="S4.Ex1.m1.4.5.2.cmml"><mi id="S4.Ex1.m1.4.5.2.2" xref="S4.Ex1.m1.4.5.2.2.cmml">𝒈</mi><mrow id="S4.Ex1.m1.2.2.2.2" xref="S4.Ex1.m1.2.2.2.3.cmml"><mrow id="S4.Ex1.m1.2.2.2.2.1" xref="S4.Ex1.m1.2.2.2.2.1.cmml"><mi id="S4.Ex1.m1.2.2.2.2.1.2" xref="S4.Ex1.m1.2.2.2.2.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.2.2.1.1" xref="S4.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.2.2.1.3" xref="S4.Ex1.m1.2.2.2.2.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.2.2.1.1a" xref="S4.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.2.2.1.4" xref="S4.Ex1.m1.2.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.2.2.1.1b" xref="S4.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.2.2.1.5" xref="S4.Ex1.m1.2.2.2.2.1.5.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.2.2.1.1c" xref="S4.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.2.2.1.6" xref="S4.Ex1.m1.2.2.2.2.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.2.2.1.1d" xref="S4.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.2.2.1.7" xref="S4.Ex1.m1.2.2.2.2.1.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.2.2.1.1e" xref="S4.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.2.2.1.8" xref="S4.Ex1.m1.2.2.2.2.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.2.2.1.1f" xref="S4.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.2.2.1.9" xref="S4.Ex1.m1.2.2.2.2.1.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.2.2.2.2.1.1g" xref="S4.Ex1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.2.2.2.2.1.10" xref="S4.Ex1.m1.2.2.2.2.1.10.cmml">d</mi></mrow><mo id="S4.Ex1.m1.2.2.2.2.2" xref="S4.Ex1.m1.2.2.2.3.cmml">,</mo><mi id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml">i</mi></mrow></msub><mo id="S4.Ex1.m1.4.5.1" xref="S4.Ex1.m1.4.5.1.cmml">=</mo><mrow id="S4.Ex1.m1.4.5.3" xref="S4.Ex1.m1.4.5.3.cmml"><msub id="S4.Ex1.m1.4.5.3.2" xref="S4.Ex1.m1.4.5.3.2.cmml"><mi id="S4.Ex1.m1.4.5.3.2.2" xref="S4.Ex1.m1.4.5.3.2.2.cmml">𝒈</mi><mrow id="S4.Ex1.m1.4.4.2.2" xref="S4.Ex1.m1.4.4.2.3.cmml"><mrow id="S4.Ex1.m1.4.4.2.2.1" xref="S4.Ex1.m1.4.4.2.2.1.cmml"><mi id="S4.Ex1.m1.4.4.2.2.1.2" xref="S4.Ex1.m1.4.4.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.4.4.2.2.1.1" xref="S4.Ex1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.4.4.2.2.1.3" xref="S4.Ex1.m1.4.4.2.2.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.4.4.2.2.1.1a" xref="S4.Ex1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.4.4.2.2.1.4" xref="S4.Ex1.m1.4.4.2.2.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.4.4.2.2.1.1b" xref="S4.Ex1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.4.4.2.2.1.5" xref="S4.Ex1.m1.4.4.2.2.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.4.4.2.2.1.1c" xref="S4.Ex1.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S4.Ex1.m1.4.4.2.2.1.6" xref="S4.Ex1.m1.4.4.2.2.1.6.cmml">d</mi></mrow><mo id="S4.Ex1.m1.4.4.2.2.2" xref="S4.Ex1.m1.4.4.2.3.cmml">,</mo><mi id="S4.Ex1.m1.3.3.1.1" xref="S4.Ex1.m1.3.3.1.1.cmml">i</mi></mrow></msub><mo id="S4.Ex1.m1.4.5.3.3" xref="S4.Ex1.m1.4.5.3.3.cmml">+</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.4b"><apply id="S4.Ex1.m1.4.5.cmml" xref="S4.Ex1.m1.4.5"><eq id="S4.Ex1.m1.4.5.1.cmml" xref="S4.Ex1.m1.4.5.1"></eq><apply id="S4.Ex1.m1.4.5.2.cmml" xref="S4.Ex1.m1.4.5.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.5.2.1.cmml" xref="S4.Ex1.m1.4.5.2">subscript</csymbol><ci id="S4.Ex1.m1.4.5.2.2.cmml" xref="S4.Ex1.m1.4.5.2.2">𝒈</ci><list id="S4.Ex1.m1.2.2.2.3.cmml" xref="S4.Ex1.m1.2.2.2.2"><apply id="S4.Ex1.m1.2.2.2.2.1.cmml" xref="S4.Ex1.m1.2.2.2.2.1"><times id="S4.Ex1.m1.2.2.2.2.1.1.cmml" xref="S4.Ex1.m1.2.2.2.2.1.1"></times><ci id="S4.Ex1.m1.2.2.2.2.1.2.cmml" xref="S4.Ex1.m1.2.2.2.2.1.2">𝑝</ci><ci id="S4.Ex1.m1.2.2.2.2.1.3.cmml" xref="S4.Ex1.m1.2.2.2.2.1.3">𝑟</ci><ci id="S4.Ex1.m1.2.2.2.2.1.4.cmml" xref="S4.Ex1.m1.2.2.2.2.1.4">𝑜</ci><ci id="S4.Ex1.m1.2.2.2.2.1.5.cmml" xref="S4.Ex1.m1.2.2.2.2.1.5">𝑗</ci><ci id="S4.Ex1.m1.2.2.2.2.1.6.cmml" xref="S4.Ex1.m1.2.2.2.2.1.6">𝑒</ci><ci id="S4.Ex1.m1.2.2.2.2.1.7.cmml" xref="S4.Ex1.m1.2.2.2.2.1.7">𝑐</ci><ci id="S4.Ex1.m1.2.2.2.2.1.8.cmml" xref="S4.Ex1.m1.2.2.2.2.1.8">𝑡</ci><ci id="S4.Ex1.m1.2.2.2.2.1.9.cmml" xref="S4.Ex1.m1.2.2.2.2.1.9">𝑒</ci><ci id="S4.Ex1.m1.2.2.2.2.1.10.cmml" xref="S4.Ex1.m1.2.2.2.2.1.10">𝑑</ci></apply><ci id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1">𝑖</ci></list></apply><apply id="S4.Ex1.m1.4.5.3.cmml" xref="S4.Ex1.m1.4.5.3"><csymbol cd="latexml" id="S4.Ex1.m1.4.5.3.1.cmml" xref="S4.Ex1.m1.4.5.3">limit-from</csymbol><apply id="S4.Ex1.m1.4.5.3.2.cmml" xref="S4.Ex1.m1.4.5.3.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.5.3.2.1.cmml" xref="S4.Ex1.m1.4.5.3.2">subscript</csymbol><ci id="S4.Ex1.m1.4.5.3.2.2.cmml" xref="S4.Ex1.m1.4.5.3.2.2">𝒈</ci><list id="S4.Ex1.m1.4.4.2.3.cmml" xref="S4.Ex1.m1.4.4.2.2"><apply id="S4.Ex1.m1.4.4.2.2.1.cmml" xref="S4.Ex1.m1.4.4.2.2.1"><times id="S4.Ex1.m1.4.4.2.2.1.1.cmml" xref="S4.Ex1.m1.4.4.2.2.1.1"></times><ci id="S4.Ex1.m1.4.4.2.2.1.2.cmml" xref="S4.Ex1.m1.4.4.2.2.1.2">𝑚</ci><ci id="S4.Ex1.m1.4.4.2.2.1.3.cmml" xref="S4.Ex1.m1.4.4.2.2.1.3">𝑖</ci><ci id="S4.Ex1.m1.4.4.2.2.1.4.cmml" xref="S4.Ex1.m1.4.4.2.2.1.4">𝑥</ci><ci id="S4.Ex1.m1.4.4.2.2.1.5.cmml" xref="S4.Ex1.m1.4.4.2.2.1.5">𝑒</ci><ci id="S4.Ex1.m1.4.4.2.2.1.6.cmml" xref="S4.Ex1.m1.4.4.2.2.1.6">𝑑</ci></apply><ci id="S4.Ex1.m1.3.3.1.1.cmml" xref="S4.Ex1.m1.3.3.1.1">𝑖</ci></list></apply><plus id="S4.Ex1.m1.4.5.3.3.cmml" xref="S4.Ex1.m1.4.5.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.4c">\displaystyle\bm{g}_{projected,i}=\bm{g}_{mixed,i}\ +</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E11.m1.9" class="ltx_Math" alttext="\displaystyle\frac{\lVert\bm{g}_{mixed,i}\rVert\left(\phi_{goal}\sqrt{1-(\phi_{i})^{2}}-\phi_{i}\sqrt{1-(\phi_{goal})^{2}}\right)}{\lVert\bar{\bm{g}}\rVert\sqrt{1-(\phi_{goal})^{2}}}\cdot\bar{\bm{g}}." display="inline"><semantics id="S4.E11.m1.9a"><mrow id="S4.E11.m1.9.9.1" xref="S4.E11.m1.9.9.1.1.cmml"><mrow id="S4.E11.m1.9.9.1.1" xref="S4.E11.m1.9.9.1.1.cmml"><mstyle displaystyle="true" id="S4.E11.m1.8.8" xref="S4.E11.m1.8.8.cmml"><mfrac id="S4.E11.m1.8.8a" xref="S4.E11.m1.8.8.cmml"><mrow id="S4.E11.m1.6.6.6" xref="S4.E11.m1.6.6.6.cmml"><mrow id="S4.E11.m1.5.5.5.5.1" xref="S4.E11.m1.5.5.5.5.2.cmml"><mo fence="true" rspace="0em" id="S4.E11.m1.5.5.5.5.1.2" xref="S4.E11.m1.5.5.5.5.2.1.cmml">∥</mo><msub id="S4.E11.m1.5.5.5.5.1.1" xref="S4.E11.m1.5.5.5.5.1.1.cmml"><mi id="S4.E11.m1.5.5.5.5.1.1.2" xref="S4.E11.m1.5.5.5.5.1.1.2.cmml">𝒈</mi><mrow id="S4.E11.m1.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.3.cmml"><mrow id="S4.E11.m1.2.2.2.2.2.2.1" xref="S4.E11.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2.1.2" xref="S4.E11.m1.2.2.2.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.2.2.1.1" xref="S4.E11.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E11.m1.2.2.2.2.2.2.1.3" xref="S4.E11.m1.2.2.2.2.2.2.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.2.2.1.1a" xref="S4.E11.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E11.m1.2.2.2.2.2.2.1.4" xref="S4.E11.m1.2.2.2.2.2.2.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.2.2.1.1b" xref="S4.E11.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E11.m1.2.2.2.2.2.2.1.5" xref="S4.E11.m1.2.2.2.2.2.2.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.2.2.1.1c" xref="S4.E11.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S4.E11.m1.2.2.2.2.2.2.1.6" xref="S4.E11.m1.2.2.2.2.2.2.1.6.cmml">d</mi></mrow><mo id="S4.E11.m1.2.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml">i</mi></mrow></msub><mo fence="true" lspace="0em" id="S4.E11.m1.5.5.5.5.1.3" xref="S4.E11.m1.5.5.5.5.2.1.cmml">∥</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E11.m1.6.6.6.7" xref="S4.E11.m1.6.6.6.7.cmml">​</mo><mrow id="S4.E11.m1.6.6.6.6.1" xref="S4.E11.m1.6.6.6.6.1.1.cmml"><mo id="S4.E11.m1.6.6.6.6.1.2" xref="S4.E11.m1.6.6.6.6.1.1.cmml">(</mo><mrow id="S4.E11.m1.6.6.6.6.1.1" xref="S4.E11.m1.6.6.6.6.1.1.cmml"><mrow id="S4.E11.m1.6.6.6.6.1.1.2" xref="S4.E11.m1.6.6.6.6.1.1.2.cmml"><msub id="S4.E11.m1.6.6.6.6.1.1.2.2" xref="S4.E11.m1.6.6.6.6.1.1.2.2.cmml"><mi id="S4.E11.m1.6.6.6.6.1.1.2.2.2" xref="S4.E11.m1.6.6.6.6.1.1.2.2.2.cmml">ϕ</mi><mrow id="S4.E11.m1.6.6.6.6.1.1.2.2.3" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.cmml"><mi id="S4.E11.m1.6.6.6.6.1.1.2.2.3.2" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.6.6.6.6.1.1.2.2.3.1" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E11.m1.6.6.6.6.1.1.2.2.3.3" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.6.6.6.6.1.1.2.2.3.1a" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E11.m1.6.6.6.6.1.1.2.2.3.4" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.6.6.6.6.1.1.2.2.3.1b" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.1.cmml">​</mo><mi id="S4.E11.m1.6.6.6.6.1.1.2.2.3.5" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.5.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.6.6.6.6.1.1.2.1" xref="S4.E11.m1.6.6.6.6.1.1.2.1.cmml">​</mo><msqrt id="S4.E11.m1.3.3.3.3" xref="S4.E11.m1.3.3.3.3.cmml"><mrow id="S4.E11.m1.3.3.3.3.1" xref="S4.E11.m1.3.3.3.3.1.cmml"><mn id="S4.E11.m1.3.3.3.3.1.3" xref="S4.E11.m1.3.3.3.3.1.3.cmml">1</mn><mo id="S4.E11.m1.3.3.3.3.1.2" xref="S4.E11.m1.3.3.3.3.1.2.cmml">−</mo><msup id="S4.E11.m1.3.3.3.3.1.1" xref="S4.E11.m1.3.3.3.3.1.1.cmml"><mrow id="S4.E11.m1.3.3.3.3.1.1.1.1" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.3.3.3.3.1.1.1.1.2" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.3.3.3.3.1.1.1.1.1" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S4.E11.m1.3.3.3.3.1.1.1.1.1.2" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S4.E11.m1.3.3.3.3.1.1.1.1.1.3" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E11.m1.3.3.3.3.1.1.1.1.3" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E11.m1.3.3.3.3.1.1.3" xref="S4.E11.m1.3.3.3.3.1.1.3.cmml">2</mn></msup></mrow></msqrt></mrow><mo id="S4.E11.m1.6.6.6.6.1.1.1" xref="S4.E11.m1.6.6.6.6.1.1.1.cmml">−</mo><mrow id="S4.E11.m1.6.6.6.6.1.1.3" xref="S4.E11.m1.6.6.6.6.1.1.3.cmml"><msub id="S4.E11.m1.6.6.6.6.1.1.3.2" xref="S4.E11.m1.6.6.6.6.1.1.3.2.cmml"><mi id="S4.E11.m1.6.6.6.6.1.1.3.2.2" xref="S4.E11.m1.6.6.6.6.1.1.3.2.2.cmml">ϕ</mi><mi id="S4.E11.m1.6.6.6.6.1.1.3.2.3" xref="S4.E11.m1.6.6.6.6.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.6.6.6.6.1.1.3.1" xref="S4.E11.m1.6.6.6.6.1.1.3.1.cmml">​</mo><msqrt id="S4.E11.m1.4.4.4.4" xref="S4.E11.m1.4.4.4.4.cmml"><mrow id="S4.E11.m1.4.4.4.4.1" xref="S4.E11.m1.4.4.4.4.1.cmml"><mn id="S4.E11.m1.4.4.4.4.1.3" xref="S4.E11.m1.4.4.4.4.1.3.cmml">1</mn><mo id="S4.E11.m1.4.4.4.4.1.2" xref="S4.E11.m1.4.4.4.4.1.2.cmml">−</mo><msup id="S4.E11.m1.4.4.4.4.1.1" xref="S4.E11.m1.4.4.4.4.1.1.cmml"><mrow id="S4.E11.m1.4.4.4.4.1.1.1.1" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.4.4.4.4.1.1.1.1.2" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.4.4.4.4.1.1.1.1.1" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.cmml"><mi id="S4.E11.m1.4.4.4.4.1.1.1.1.1.2" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.2.cmml">ϕ</mi><mrow id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.2" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.1" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.3" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.1a" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.4" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.1b" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.5" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.5.cmml">l</mi></mrow></msub><mo stretchy="false" id="S4.E11.m1.4.4.4.4.1.1.1.1.3" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E11.m1.4.4.4.4.1.1.3" xref="S4.E11.m1.4.4.4.4.1.1.3.cmml">2</mn></msup></mrow></msqrt></mrow></mrow><mo id="S4.E11.m1.6.6.6.6.1.3" xref="S4.E11.m1.6.6.6.6.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E11.m1.8.8.8" xref="S4.E11.m1.8.8.8.cmml"><mrow id="S4.E11.m1.8.8.8.4.2" xref="S4.E11.m1.8.8.8.4.1.cmml"><mo fence="true" rspace="0em" id="S4.E11.m1.8.8.8.4.2.1" xref="S4.E11.m1.8.8.8.4.1.1.cmml">∥</mo><mover accent="true" id="S4.E11.m1.8.8.8.2" xref="S4.E11.m1.8.8.8.2.cmml"><mi id="S4.E11.m1.8.8.8.2.2" xref="S4.E11.m1.8.8.8.2.2.cmml">𝒈</mi><mo id="S4.E11.m1.8.8.8.2.1" xref="S4.E11.m1.8.8.8.2.1.cmml">¯</mo></mover><mo fence="true" lspace="0em" id="S4.E11.m1.8.8.8.4.2.2" xref="S4.E11.m1.8.8.8.4.1.1.cmml">∥</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E11.m1.8.8.8.3" xref="S4.E11.m1.8.8.8.3.cmml">​</mo><msqrt id="S4.E11.m1.7.7.7.1" xref="S4.E11.m1.7.7.7.1.cmml"><mrow id="S4.E11.m1.7.7.7.1.1" xref="S4.E11.m1.7.7.7.1.1.cmml"><mn id="S4.E11.m1.7.7.7.1.1.3" xref="S4.E11.m1.7.7.7.1.1.3.cmml">1</mn><mo id="S4.E11.m1.7.7.7.1.1.2" xref="S4.E11.m1.7.7.7.1.1.2.cmml">−</mo><msup id="S4.E11.m1.7.7.7.1.1.1" xref="S4.E11.m1.7.7.7.1.1.1.cmml"><mrow id="S4.E11.m1.7.7.7.1.1.1.1.1" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.7.7.7.1.1.1.1.1.2" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.7.7.7.1.1.1.1.1.1" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.7.7.7.1.1.1.1.1.1.2" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.2.cmml">ϕ</mi><mrow id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.cmml"><mi id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.2" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.1" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.3" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.1a" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.4" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.1b" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.5" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.5.cmml">l</mi></mrow></msub><mo stretchy="false" id="S4.E11.m1.7.7.7.1.1.1.1.1.3" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E11.m1.7.7.7.1.1.1.3" xref="S4.E11.m1.7.7.7.1.1.1.3.cmml">2</mn></msup></mrow></msqrt></mrow></mfrac></mstyle><mo lspace="0.222em" rspace="0.222em" id="S4.E11.m1.9.9.1.1.1" xref="S4.E11.m1.9.9.1.1.1.cmml">⋅</mo><mover accent="true" id="S4.E11.m1.9.9.1.1.2" xref="S4.E11.m1.9.9.1.1.2.cmml"><mi id="S4.E11.m1.9.9.1.1.2.2" xref="S4.E11.m1.9.9.1.1.2.2.cmml">𝒈</mi><mo id="S4.E11.m1.9.9.1.1.2.1" xref="S4.E11.m1.9.9.1.1.2.1.cmml">¯</mo></mover></mrow><mo lspace="0em" id="S4.E11.m1.9.9.1.2" xref="S4.E11.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.9b"><apply id="S4.E11.m1.9.9.1.1.cmml" xref="S4.E11.m1.9.9.1"><ci id="S4.E11.m1.9.9.1.1.1.cmml" xref="S4.E11.m1.9.9.1.1.1">⋅</ci><apply id="S4.E11.m1.8.8.cmml" xref="S4.E11.m1.8.8"><divide id="S4.E11.m1.8.8.9.cmml" xref="S4.E11.m1.8.8"></divide><apply id="S4.E11.m1.6.6.6.cmml" xref="S4.E11.m1.6.6.6"><times id="S4.E11.m1.6.6.6.7.cmml" xref="S4.E11.m1.6.6.6.7"></times><apply id="S4.E11.m1.5.5.5.5.2.cmml" xref="S4.E11.m1.5.5.5.5.1"><csymbol cd="latexml" id="S4.E11.m1.5.5.5.5.2.1.cmml" xref="S4.E11.m1.5.5.5.5.1.2">delimited-∥∥</csymbol><apply id="S4.E11.m1.5.5.5.5.1.1.cmml" xref="S4.E11.m1.5.5.5.5.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.5.5.1.1.1.cmml" xref="S4.E11.m1.5.5.5.5.1.1">subscript</csymbol><ci id="S4.E11.m1.5.5.5.5.1.1.2.cmml" xref="S4.E11.m1.5.5.5.5.1.1.2">𝒈</ci><list id="S4.E11.m1.2.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2"><apply id="S4.E11.m1.2.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1"><times id="S4.E11.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.1"></times><ci id="S4.E11.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.2">𝑚</ci><ci id="S4.E11.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.3">𝑖</ci><ci id="S4.E11.m1.2.2.2.2.2.2.1.4.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.4">𝑥</ci><ci id="S4.E11.m1.2.2.2.2.2.2.1.5.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.5">𝑒</ci><ci id="S4.E11.m1.2.2.2.2.2.2.1.6.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.6">𝑑</ci></apply><ci id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1">𝑖</ci></list></apply></apply><apply id="S4.E11.m1.6.6.6.6.1.1.cmml" xref="S4.E11.m1.6.6.6.6.1"><minus id="S4.E11.m1.6.6.6.6.1.1.1.cmml" xref="S4.E11.m1.6.6.6.6.1.1.1"></minus><apply id="S4.E11.m1.6.6.6.6.1.1.2.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2"><times id="S4.E11.m1.6.6.6.6.1.1.2.1.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.1"></times><apply id="S4.E11.m1.6.6.6.6.1.1.2.2.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.6.6.6.6.1.1.2.2.1.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2">subscript</csymbol><ci id="S4.E11.m1.6.6.6.6.1.1.2.2.2.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2.2">italic-ϕ</ci><apply id="S4.E11.m1.6.6.6.6.1.1.2.2.3.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3"><times id="S4.E11.m1.6.6.6.6.1.1.2.2.3.1.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.1"></times><ci id="S4.E11.m1.6.6.6.6.1.1.2.2.3.2.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.2">𝑔</ci><ci id="S4.E11.m1.6.6.6.6.1.1.2.2.3.3.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.3">𝑜</ci><ci id="S4.E11.m1.6.6.6.6.1.1.2.2.3.4.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.4">𝑎</ci><ci id="S4.E11.m1.6.6.6.6.1.1.2.2.3.5.cmml" xref="S4.E11.m1.6.6.6.6.1.1.2.2.3.5">𝑙</ci></apply></apply><apply id="S4.E11.m1.3.3.3.3.cmml" xref="S4.E11.m1.3.3.3.3"><root id="S4.E11.m1.3.3.3.3a.cmml" xref="S4.E11.m1.3.3.3.3"></root><apply id="S4.E11.m1.3.3.3.3.1.cmml" xref="S4.E11.m1.3.3.3.3.1"><minus id="S4.E11.m1.3.3.3.3.1.2.cmml" xref="S4.E11.m1.3.3.3.3.1.2"></minus><cn type="integer" id="S4.E11.m1.3.3.3.3.1.3.cmml" xref="S4.E11.m1.3.3.3.3.1.3">1</cn><apply id="S4.E11.m1.3.3.3.3.1.1.cmml" xref="S4.E11.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.3.3.1.1.2.cmml" xref="S4.E11.m1.3.3.3.3.1.1">superscript</csymbol><apply id="S4.E11.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.3.3.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.2">italic-ϕ</ci><ci id="S4.E11.m1.3.3.3.3.1.1.1.1.1.3.cmml" xref="S4.E11.m1.3.3.3.3.1.1.1.1.1.3">𝑖</ci></apply><cn type="integer" id="S4.E11.m1.3.3.3.3.1.1.3.cmml" xref="S4.E11.m1.3.3.3.3.1.1.3">2</cn></apply></apply></apply></apply><apply id="S4.E11.m1.6.6.6.6.1.1.3.cmml" xref="S4.E11.m1.6.6.6.6.1.1.3"><times id="S4.E11.m1.6.6.6.6.1.1.3.1.cmml" xref="S4.E11.m1.6.6.6.6.1.1.3.1"></times><apply id="S4.E11.m1.6.6.6.6.1.1.3.2.cmml" xref="S4.E11.m1.6.6.6.6.1.1.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.6.6.6.6.1.1.3.2.1.cmml" xref="S4.E11.m1.6.6.6.6.1.1.3.2">subscript</csymbol><ci id="S4.E11.m1.6.6.6.6.1.1.3.2.2.cmml" xref="S4.E11.m1.6.6.6.6.1.1.3.2.2">italic-ϕ</ci><ci id="S4.E11.m1.6.6.6.6.1.1.3.2.3.cmml" xref="S4.E11.m1.6.6.6.6.1.1.3.2.3">𝑖</ci></apply><apply id="S4.E11.m1.4.4.4.4.cmml" xref="S4.E11.m1.4.4.4.4"><root id="S4.E11.m1.4.4.4.4a.cmml" xref="S4.E11.m1.4.4.4.4"></root><apply id="S4.E11.m1.4.4.4.4.1.cmml" xref="S4.E11.m1.4.4.4.4.1"><minus id="S4.E11.m1.4.4.4.4.1.2.cmml" xref="S4.E11.m1.4.4.4.4.1.2"></minus><cn type="integer" id="S4.E11.m1.4.4.4.4.1.3.cmml" xref="S4.E11.m1.4.4.4.4.1.3">1</cn><apply id="S4.E11.m1.4.4.4.4.1.1.cmml" xref="S4.E11.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.4.1.1.2.cmml" xref="S4.E11.m1.4.4.4.4.1.1">superscript</csymbol><apply id="S4.E11.m1.4.4.4.4.1.1.1.1.1.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.4.1.1.1.1.1.1.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.4.4.4.4.1.1.1.1.1.2.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.2">italic-ϕ</ci><apply id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3"><times id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.1"></times><ci id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.2">𝑔</ci><ci id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.3">𝑜</ci><ci id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.4.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.4">𝑎</ci><ci id="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.5.cmml" xref="S4.E11.m1.4.4.4.4.1.1.1.1.1.3.5">𝑙</ci></apply></apply><cn type="integer" id="S4.E11.m1.4.4.4.4.1.1.3.cmml" xref="S4.E11.m1.4.4.4.4.1.1.3">2</cn></apply></apply></apply></apply></apply></apply><apply id="S4.E11.m1.8.8.8.cmml" xref="S4.E11.m1.8.8.8"><times id="S4.E11.m1.8.8.8.3.cmml" xref="S4.E11.m1.8.8.8.3"></times><apply id="S4.E11.m1.8.8.8.4.1.cmml" xref="S4.E11.m1.8.8.8.4.2"><csymbol cd="latexml" id="S4.E11.m1.8.8.8.4.1.1.cmml" xref="S4.E11.m1.8.8.8.4.2.1">delimited-∥∥</csymbol><apply id="S4.E11.m1.8.8.8.2.cmml" xref="S4.E11.m1.8.8.8.2"><ci id="S4.E11.m1.8.8.8.2.1.cmml" xref="S4.E11.m1.8.8.8.2.1">¯</ci><ci id="S4.E11.m1.8.8.8.2.2.cmml" xref="S4.E11.m1.8.8.8.2.2">𝒈</ci></apply></apply><apply id="S4.E11.m1.7.7.7.1.cmml" xref="S4.E11.m1.7.7.7.1"><root id="S4.E11.m1.7.7.7.1a.cmml" xref="S4.E11.m1.7.7.7.1"></root><apply id="S4.E11.m1.7.7.7.1.1.cmml" xref="S4.E11.m1.7.7.7.1.1"><minus id="S4.E11.m1.7.7.7.1.1.2.cmml" xref="S4.E11.m1.7.7.7.1.1.2"></minus><cn type="integer" id="S4.E11.m1.7.7.7.1.1.3.cmml" xref="S4.E11.m1.7.7.7.1.1.3">1</cn><apply id="S4.E11.m1.7.7.7.1.1.1.cmml" xref="S4.E11.m1.7.7.7.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.7.7.7.1.1.1.2.cmml" xref="S4.E11.m1.7.7.7.1.1.1">superscript</csymbol><apply id="S4.E11.m1.7.7.7.1.1.1.1.1.1.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.7.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.7.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.2">italic-ϕ</ci><apply id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3"><times id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.1.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.1"></times><ci id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.2.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.3.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.3">𝑜</ci><ci id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.4.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.4">𝑎</ci><ci id="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.5.cmml" xref="S4.E11.m1.7.7.7.1.1.1.1.1.1.3.5">𝑙</ci></apply></apply><cn type="integer" id="S4.E11.m1.7.7.7.1.1.1.3.cmml" xref="S4.E11.m1.7.7.7.1.1.1.3">2</cn></apply></apply></apply></apply></apply><apply id="S4.E11.m1.9.9.1.1.2.cmml" xref="S4.E11.m1.9.9.1.1.2"><ci id="S4.E11.m1.9.9.1.1.2.1.cmml" xref="S4.E11.m1.9.9.1.1.2.1">¯</ci><ci id="S4.E11.m1.9.9.1.1.2.2.cmml" xref="S4.E11.m1.9.9.1.1.2.2">𝒈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.9c">\displaystyle\frac{\lVert\bm{g}_{mixed,i}\rVert\left(\phi_{goal}\sqrt{1-(\phi_{i})^{2}}-\phi_{i}\sqrt{1-(\phi_{goal})^{2}}\right)}{\lVert\bar{\bm{g}}\rVert\sqrt{1-(\phi_{goal})^{2}}}\cdot\bar{\bm{g}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.SSS2.p5" class="ltx_para">
<p id="S4.SS2.SSS2.p5.4" class="ltx_p">And finally, the operation of our <span id="S4.SS2.SSS2.p5.4.1" class="ltx_text ltx_font_sansserif">MixPro</span> is:</p>
<table id="Sx1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E12.m1.6" class="ltx_Math" alttext="\displaystyle\bm{g}_{perturbed,i}=\begin{cases}\bm{g}_{mixed,i}\ ,\ &amp;\textrm{if}\ \phi_{i}\geq\phi_{goal}\ ,\\
\bm{g}_{projected,i}\ ,\ &amp;\textrm{if}\ \phi_{i}&lt;\phi_{goal}\ .\end{cases}" display="inline"><semantics id="S4.E12.m1.6a"><mrow id="S4.E12.m1.6.7" xref="S4.E12.m1.6.7.cmml"><msub id="S4.E12.m1.6.7.2" xref="S4.E12.m1.6.7.2.cmml"><mi id="S4.E12.m1.6.7.2.2" xref="S4.E12.m1.6.7.2.2.cmml">𝒈</mi><mrow id="S4.E12.m1.6.6.2.2" xref="S4.E12.m1.6.6.2.3.cmml"><mrow id="S4.E12.m1.6.6.2.2.1" xref="S4.E12.m1.6.6.2.2.1.cmml"><mi id="S4.E12.m1.6.6.2.2.1.2" xref="S4.E12.m1.6.6.2.2.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.2.1.1" xref="S4.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.2.1.3" xref="S4.E12.m1.6.6.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.2.1.1a" xref="S4.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.2.1.4" xref="S4.E12.m1.6.6.2.2.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.2.1.1b" xref="S4.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.2.1.5" xref="S4.E12.m1.6.6.2.2.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.2.1.1c" xref="S4.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.2.1.6" xref="S4.E12.m1.6.6.2.2.1.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.2.1.1d" xref="S4.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.2.1.7" xref="S4.E12.m1.6.6.2.2.1.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.2.1.1e" xref="S4.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.2.1.8" xref="S4.E12.m1.6.6.2.2.1.8.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.2.1.1f" xref="S4.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.2.1.9" xref="S4.E12.m1.6.6.2.2.1.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.2.1.1g" xref="S4.E12.m1.6.6.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.6.6.2.2.1.10" xref="S4.E12.m1.6.6.2.2.1.10.cmml">d</mi></mrow><mo id="S4.E12.m1.6.6.2.2.2" xref="S4.E12.m1.6.6.2.3.cmml">,</mo><mi id="S4.E12.m1.5.5.1.1" xref="S4.E12.m1.5.5.1.1.cmml">i</mi></mrow></msub><mo id="S4.E12.m1.6.7.1" xref="S4.E12.m1.6.7.1.cmml">=</mo><mrow id="S4.E12.m1.4.4a" xref="S4.E12.m1.6.7.3.1.cmml"><mo id="S4.E12.m1.4.4a.5" xref="S4.E12.m1.6.7.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S4.E12.m1.4.4.4a" xref="S4.E12.m1.6.7.3.1.cmml"><mtr id="S4.E12.m1.4.4.4aa" xref="S4.E12.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.4.4.4ab" xref="S4.E12.m1.6.7.3.1.cmml"><mrow id="S4.E12.m1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.3.1.cmml"><msub id="S4.E12.m1.1.1.1.1.1.1.3.1" xref="S4.E12.m1.1.1.1.1.1.1.3.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.3.1.2" xref="S4.E12.m1.1.1.1.1.1.1.3.1.2.cmml">𝒈</mi><mrow id="S4.E12.m1.1.1.1.1.1.1.2.2.2" xref="S4.E12.m1.1.1.1.1.1.1.2.2.3.cmml"><mrow id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.2" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.3" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1a" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.4" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1b" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.5" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1c" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.6" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.6.cmml">d</mi></mrow><mo id="S4.E12.m1.1.1.1.1.1.1.2.2.2.2" xref="S4.E12.m1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S4.E12.m1.1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1.cmml">i</mi></mrow></msub><mo lspace="0.500em" id="S4.E12.m1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.4.4.4ac" xref="S4.E12.m1.6.7.3.1.cmml"><mrow id="S4.E12.m1.2.2.2.2.2.1.1" xref="S4.E12.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S4.E12.m1.2.2.2.2.2.1.1.1" xref="S4.E12.m1.2.2.2.2.2.1.1.1.cmml"><mrow id="S4.E12.m1.2.2.2.2.2.1.1.1.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.cmml"><mtext id="S4.E12.m1.2.2.2.2.2.1.1.1.2.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.2a.cmml">if</mtext><mo lspace="0.500em" rspace="0em" id="S4.E12.m1.2.2.2.2.2.1.1.1.2.1" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.1.cmml">​</mo><msub id="S4.E12.m1.2.2.2.2.2.1.1.1.2.3" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.cmml"><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.2.cmml">ϕ</mi><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.3" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S4.E12.m1.2.2.2.2.2.1.1.1.1" xref="S4.E12.m1.2.2.2.2.2.1.1.1.1.cmml">≥</mo><msub id="S4.E12.m1.2.2.2.2.2.1.1.1.3" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.2.cmml">ϕ</mi><mrow id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.cmml"><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.1" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.3" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.1a" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.4" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.1b" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.5" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.5.cmml">l</mi></mrow></msub></mrow><mo id="S4.E12.m1.2.2.2.2.2.1.1.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S4.E12.m1.4.4.4ad" xref="S4.E12.m1.6.7.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.4.4.4ae" xref="S4.E12.m1.6.7.3.1.cmml"><mrow id="S4.E12.m1.3.3.3.3.1.1.3" xref="S4.E12.m1.3.3.3.3.1.1.3.1.cmml"><msub id="S4.E12.m1.3.3.3.3.1.1.3.1" xref="S4.E12.m1.3.3.3.3.1.1.3.1.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.3.1.2" xref="S4.E12.m1.3.3.3.3.1.1.3.1.2.cmml">𝒈</mi><mrow id="S4.E12.m1.3.3.3.3.1.1.2.2.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.3.cmml"><mrow id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.3" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1a" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.4" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1b" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.5" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.5.cmml">j</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1c" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.6" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.6.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1d" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.7" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.7.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1e" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.8" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.8.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1f" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.9" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1g" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml">​</mo><mi id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.10" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.10.cmml">d</mi></mrow><mo id="S4.E12.m1.3.3.3.3.1.1.2.2.2.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.3.cmml">,</mo><mi id="S4.E12.m1.3.3.3.3.1.1.1.1.1" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1.cmml">i</mi></mrow></msub><mo lspace="0.500em" id="S4.E12.m1.3.3.3.3.1.1.3.2" xref="S4.E12.m1.3.3.3.3.1.1.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E12.m1.4.4.4af" xref="S4.E12.m1.6.7.3.1.cmml"><mrow id="S4.E12.m1.4.4.4.4.2.1.1" xref="S4.E12.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S4.E12.m1.4.4.4.4.2.1.1.1" xref="S4.E12.m1.4.4.4.4.2.1.1.1.cmml"><mrow id="S4.E12.m1.4.4.4.4.2.1.1.1.2" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.cmml"><mtext id="S4.E12.m1.4.4.4.4.2.1.1.1.2.2" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.2a.cmml">if</mtext><mo lspace="0.500em" rspace="0em" id="S4.E12.m1.4.4.4.4.2.1.1.1.2.1" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.1.cmml">​</mo><msub id="S4.E12.m1.4.4.4.4.2.1.1.1.2.3" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.cmml"><mi id="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.2" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.2.cmml">ϕ</mi><mi id="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.3" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="S4.E12.m1.4.4.4.4.2.1.1.1.1" xref="S4.E12.m1.4.4.4.4.2.1.1.1.1.cmml">&lt;</mo><msub id="S4.E12.m1.4.4.4.4.2.1.1.1.3" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.cmml"><mi id="S4.E12.m1.4.4.4.4.2.1.1.1.3.2" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.2.cmml">ϕ</mi><mrow id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.cmml"><mi id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.2" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.1" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.3" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.1a" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.4" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.1b" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.5" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.5.cmml">l</mi></mrow></msub></mrow><mo lspace="0em" id="S4.E12.m1.4.4.4.4.2.1.1.2" xref="S4.E12.m1.4.4.4.4.2.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.6b"><apply id="S4.E12.m1.6.7.cmml" xref="S4.E12.m1.6.7"><eq id="S4.E12.m1.6.7.1.cmml" xref="S4.E12.m1.6.7.1"></eq><apply id="S4.E12.m1.6.7.2.cmml" xref="S4.E12.m1.6.7.2"><csymbol cd="ambiguous" id="S4.E12.m1.6.7.2.1.cmml" xref="S4.E12.m1.6.7.2">subscript</csymbol><ci id="S4.E12.m1.6.7.2.2.cmml" xref="S4.E12.m1.6.7.2.2">𝒈</ci><list id="S4.E12.m1.6.6.2.3.cmml" xref="S4.E12.m1.6.6.2.2"><apply id="S4.E12.m1.6.6.2.2.1.cmml" xref="S4.E12.m1.6.6.2.2.1"><times id="S4.E12.m1.6.6.2.2.1.1.cmml" xref="S4.E12.m1.6.6.2.2.1.1"></times><ci id="S4.E12.m1.6.6.2.2.1.2.cmml" xref="S4.E12.m1.6.6.2.2.1.2">𝑝</ci><ci id="S4.E12.m1.6.6.2.2.1.3.cmml" xref="S4.E12.m1.6.6.2.2.1.3">𝑒</ci><ci id="S4.E12.m1.6.6.2.2.1.4.cmml" xref="S4.E12.m1.6.6.2.2.1.4">𝑟</ci><ci id="S4.E12.m1.6.6.2.2.1.5.cmml" xref="S4.E12.m1.6.6.2.2.1.5">𝑡</ci><ci id="S4.E12.m1.6.6.2.2.1.6.cmml" xref="S4.E12.m1.6.6.2.2.1.6">𝑢</ci><ci id="S4.E12.m1.6.6.2.2.1.7.cmml" xref="S4.E12.m1.6.6.2.2.1.7">𝑟</ci><ci id="S4.E12.m1.6.6.2.2.1.8.cmml" xref="S4.E12.m1.6.6.2.2.1.8">𝑏</ci><ci id="S4.E12.m1.6.6.2.2.1.9.cmml" xref="S4.E12.m1.6.6.2.2.1.9">𝑒</ci><ci id="S4.E12.m1.6.6.2.2.1.10.cmml" xref="S4.E12.m1.6.6.2.2.1.10">𝑑</ci></apply><ci id="S4.E12.m1.5.5.1.1.cmml" xref="S4.E12.m1.5.5.1.1">𝑖</ci></list></apply><apply id="S4.E12.m1.6.7.3.1.cmml" xref="S4.E12.m1.4.4a"><csymbol cd="latexml" id="S4.E12.m1.6.7.3.1.1.cmml" xref="S4.E12.m1.4.4a.5">cases</csymbol><apply id="S4.E12.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.3.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.3.1.2">𝒈</ci><list id="S4.E12.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2"><apply id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1"><times id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.1"></times><ci id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.2">𝑚</ci><ci id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.3">𝑖</ci><ci id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.4.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.4">𝑥</ci><ci id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.5.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.5">𝑒</ci><ci id="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.6.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2.2.2.1.6">𝑑</ci></apply><ci id="S4.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.1.1">𝑖</ci></list></apply><apply id="S4.E12.m1.2.2.2.2.2.1.1.1.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1"><geq id="S4.E12.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.1"></geq><apply id="S4.E12.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2"><times id="S4.E12.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.1"></times><ci id="S4.E12.m1.2.2.2.2.2.1.1.1.2.2a.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.2"><mtext id="S4.E12.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.2">if</mtext></ci><apply id="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.1.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.3">subscript</csymbol><ci id="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.2.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.2">italic-ϕ</ci><ci id="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.3.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.E12.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.2">italic-ϕ</ci><apply id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3"><times id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.1.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.1"></times><ci id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.2.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.2">𝑔</ci><ci id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.3.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.3">𝑜</ci><ci id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.4.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.4">𝑎</ci><ci id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.5.cmml" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.5">𝑙</ci></apply></apply></apply><apply id="S4.E12.m1.3.3.3.3.1.1.3.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.3.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3">subscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.3.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3.1.2">𝒈</ci><list id="S4.E12.m1.3.3.3.3.1.1.2.2.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2"><apply id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1"><times id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.1"></times><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.2">𝑝</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.3">𝑟</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.4.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.4">𝑜</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.5.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.5">𝑗</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.6.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.6">𝑒</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.7.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.7">𝑐</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.8.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.8">𝑡</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.9.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.9">𝑒</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.10.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2.2.1.10">𝑑</ci></apply><ci id="S4.E12.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1.1.1.1">𝑖</ci></list></apply><apply id="S4.E12.m1.4.4.4.4.2.1.1.1.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1"><lt id="S4.E12.m1.4.4.4.4.2.1.1.1.1.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.1"></lt><apply id="S4.E12.m1.4.4.4.4.2.1.1.1.2.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2"><times id="S4.E12.m1.4.4.4.4.2.1.1.1.2.1.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.1"></times><ci id="S4.E12.m1.4.4.4.4.2.1.1.1.2.2a.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.2"><mtext id="S4.E12.m1.4.4.4.4.2.1.1.1.2.2.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.2">if</mtext></ci><apply id="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.1.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.3">subscript</csymbol><ci id="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.2.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.2">italic-ϕ</ci><ci id="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.3.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.E12.m1.4.4.4.4.2.1.1.1.3.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.4.2.1.1.1.3.1.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3">subscript</csymbol><ci id="S4.E12.m1.4.4.4.4.2.1.1.1.3.2.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.2">italic-ϕ</ci><apply id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3"><times id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.1.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.1"></times><ci id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.2.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.2">𝑔</ci><ci id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.3.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.3">𝑜</ci><ci id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.4.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.4">𝑎</ci><ci id="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.5.cmml" xref="S4.E12.m1.4.4.4.4.2.1.1.1.3.3.5">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.6c">\displaystyle\bm{g}_{perturbed,i}=\begin{cases}\bm{g}_{mixed,i}\ ,\ &amp;\textrm{if}\ \phi_{i}\geq\phi_{goal}\ ,\\
\bm{g}_{projected,i}\ ,\ &amp;\textrm{if}\ \phi_{i}&lt;\phi_{goal}\ .\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.SSS2.p5.3" class="ltx_p">During training process, based on our defense approach <span id="S4.SS2.SSS2.p5.3.1" class="ltx_text ltx_font_sansserif">MixPro</span>, for a batch of aligned training samples, the label party sends the perturbed gradients <math id="S4.SS2.SSS2.p5.1.m1.3" class="ltx_Math" alttext="\left\{\bm{g}_{perturbed,i}\right\}_{i=1}^{B}" display="inline"><semantics id="S4.SS2.SSS2.p5.1.m1.3a"><msubsup id="S4.SS2.SSS2.p5.1.m1.3.3" xref="S4.SS2.SSS2.p5.1.m1.3.3.cmml"><mrow id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.2.cmml"><mo id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.2" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.2.cmml">{</mo><msub id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.2" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.2.cmml">𝒈</mi><mrow id="S4.SS2.SSS2.p5.1.m1.2.2.2.2" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.3.cmml"><mrow id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.cmml"><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.2" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.3" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1a" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.4" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1b" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.5" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1c" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.6" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1d" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.7" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1e" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.8" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.8.cmml">b</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1f" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.9" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.9.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1g" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.10" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.10.cmml">d</mi></mrow><mo id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.2" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.SSS2.p5.1.m1.1.1.1.1" xref="S4.SS2.SSS2.p5.1.m1.1.1.1.1.cmml">i</mi></mrow></msub><mo id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.3" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.SSS2.p5.1.m1.3.3.1.3" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.3.cmml"><mi id="S4.SS2.SSS2.p5.1.m1.3.3.1.3.2" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.3.2.cmml">i</mi><mo id="S4.SS2.SSS2.p5.1.m1.3.3.1.3.1" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.3.1.cmml">=</mo><mn id="S4.SS2.SSS2.p5.1.m1.3.3.1.3.3" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS2.p5.1.m1.3.3.3" xref="S4.SS2.SSS2.p5.1.m1.3.3.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p5.1.m1.3b"><apply id="S4.SS2.SSS2.p5.1.m1.3.3.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p5.1.m1.3.3.2.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3">superscript</csymbol><apply id="S4.SS2.SSS2.p5.1.m1.3.3.1.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p5.1.m1.3.3.1.2.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3">subscript</csymbol><set id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.2.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1"><apply id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.2">𝒈</ci><list id="S4.SS2.SSS2.p5.1.m1.2.2.2.3.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2"><apply id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1"><times id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.1"></times><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.2.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.2">𝑝</ci><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.3.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.3">𝑒</ci><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.4.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.4">𝑟</ci><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.5.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.5">𝑡</ci><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.6.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.6">𝑢</ci><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.7.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.7">𝑟</ci><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.8.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.8">𝑏</ci><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.9.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.9">𝑒</ci><ci id="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.10.cmml" xref="S4.SS2.SSS2.p5.1.m1.2.2.2.2.1.10">𝑑</ci></apply><ci id="S4.SS2.SSS2.p5.1.m1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p5.1.m1.1.1.1.1">𝑖</ci></list></apply></set><apply id="S4.SS2.SSS2.p5.1.m1.3.3.1.3.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.3"><eq id="S4.SS2.SSS2.p5.1.m1.3.3.1.3.1.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.3.1"></eq><ci id="S4.SS2.SSS2.p5.1.m1.3.3.1.3.2.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.3.2">𝑖</ci><cn type="integer" id="S4.SS2.SSS2.p5.1.m1.3.3.1.3.3.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.1.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS2.p5.1.m1.3.3.3.cmml" xref="S4.SS2.SSS2.p5.1.m1.3.3.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p5.1.m1.3c">\left\{\bm{g}_{perturbed,i}\right\}_{i=1}^{B}</annotation></semantics></math> rather than the original ones <math id="S4.SS2.SSS2.p5.2.m2.1" class="ltx_Math" alttext="\left\{\bm{g}_{i}\right\}_{i=1}^{B}" display="inline"><semantics id="S4.SS2.SSS2.p5.2.m2.1a"><msubsup id="S4.SS2.SSS2.p5.2.m2.1.1" xref="S4.SS2.SSS2.p5.2.m2.1.1.cmml"><mrow id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.2.cmml"><mo id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.2" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.2.cmml">𝒈</mi><mi id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.3" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS2.SSS2.p5.2.m2.1.1.1.3" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p5.2.m2.1.1.1.3.2" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.3.2.cmml">i</mi><mo id="S4.SS2.SSS2.p5.2.m2.1.1.1.3.1" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S4.SS2.SSS2.p5.2.m2.1.1.1.3.3" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS2.SSS2.p5.2.m2.1.1.3" xref="S4.SS2.SSS2.p5.2.m2.1.1.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p5.2.m2.1b"><apply id="S4.SS2.SSS2.p5.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1">superscript</csymbol><apply id="S4.SS2.SSS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p5.2.m2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1">subscript</csymbol><set id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1"><apply id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.2">𝒈</ci><ci id="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S4.SS2.SSS2.p5.2.m2.1.1.1.3.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.3"><eq id="S4.SS2.SSS2.p5.2.m2.1.1.1.3.1.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.3.1"></eq><ci id="S4.SS2.SSS2.p5.2.m2.1.1.1.3.2.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.3.2">𝑖</ci><cn type="integer" id="S4.SS2.SSS2.p5.2.m2.1.1.1.3.3.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S4.SS2.SSS2.p5.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p5.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p5.2.m2.1c">\left\{\bm{g}_{i}\right\}_{i=1}^{B}</annotation></semantics></math> to the non-label party for updating the submodel <math id="S4.SS2.SSS2.p5.3.m3.1" class="ltx_Math" alttext="f_{\mathrm{N}}(\cdot)" display="inline"><semantics id="S4.SS2.SSS2.p5.3.m3.1a"><mrow id="S4.SS2.SSS2.p5.3.m3.1.2" xref="S4.SS2.SSS2.p5.3.m3.1.2.cmml"><msub id="S4.SS2.SSS2.p5.3.m3.1.2.2" xref="S4.SS2.SSS2.p5.3.m3.1.2.2.cmml"><mi id="S4.SS2.SSS2.p5.3.m3.1.2.2.2" xref="S4.SS2.SSS2.p5.3.m3.1.2.2.2.cmml">f</mi><mi mathvariant="normal" id="S4.SS2.SSS2.p5.3.m3.1.2.2.3" xref="S4.SS2.SSS2.p5.3.m3.1.2.2.3.cmml">N</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.3.m3.1.2.1" xref="S4.SS2.SSS2.p5.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.SSS2.p5.3.m3.1.2.3.2" xref="S4.SS2.SSS2.p5.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p5.3.m3.1.2.3.2.1" xref="S4.SS2.SSS2.p5.3.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p5.3.m3.1.1" xref="S4.SS2.SSS2.p5.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.SSS2.p5.3.m3.1.2.3.2.2" xref="S4.SS2.SSS2.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p5.3.m3.1b"><apply id="S4.SS2.SSS2.p5.3.m3.1.2.cmml" xref="S4.SS2.SSS2.p5.3.m3.1.2"><times id="S4.SS2.SSS2.p5.3.m3.1.2.1.cmml" xref="S4.SS2.SSS2.p5.3.m3.1.2.1"></times><apply id="S4.SS2.SSS2.p5.3.m3.1.2.2.cmml" xref="S4.SS2.SSS2.p5.3.m3.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p5.3.m3.1.2.2.1.cmml" xref="S4.SS2.SSS2.p5.3.m3.1.2.2">subscript</csymbol><ci id="S4.SS2.SSS2.p5.3.m3.1.2.2.2.cmml" xref="S4.SS2.SSS2.p5.3.m3.1.2.2.2">𝑓</ci><ci id="S4.SS2.SSS2.p5.3.m3.1.2.2.3.cmml" xref="S4.SS2.SSS2.p5.3.m3.1.2.2.3">N</ci></apply><ci id="S4.SS2.SSS2.p5.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p5.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p5.3.m3.1c">f_{\mathrm{N}}(\cdot)</annotation></semantics></math>, aiming to improve the privacy of the vFL model training.</p>
</div>
<div id="S4.SS2.SSS2.p6" class="ltx_para">
<p id="S4.SS2.SSS2.p6.1" class="ltx_p"><span id="S4.SS2.SSS2.p6.1.1" class="ltx_text ltx_font_sansserif">MixPro</span> does not make any assumption about gradient distribution and can be seamlessly integrated into arbitrary neural network based vFL training framework.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Systematical Evaluations</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">As another contribution of our <span id="S5.p1.1.1" class="ltx_text ltx_font_sansserif">FedAds</span> benchmark, we conduct systematical evaluations of various vFL models for both effectiveness and privacy aspects.
For existing vFL algorithms that focus on improving effectiveness, we evaluate their performance in Section <a href="#S5.SS1" title="5.1. Experiments on Effectiveness ‣ 5. Systematical Evaluations ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>. We then compare representative approaches for defending label inference attack, and results are shown in Section <a href="#S5.SS2" title="5.2. Experiments on Privacy ‣ 5. Systematical Evaluations ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experiments on Effectiveness</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We first introduce experimental setup, evaluation metrics and comparative approaches in experiments, and then list implementation details and show experimental results.</p>
</div>
<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.1. </span><span id="S5.SS1.SSS1.1.1" class="ltx_text ltx_font_bold">Experimental Setup.</span>
</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.p1.2" class="ltx_p">We use our proposed dataset for evaluation. Specifically, we use 20% of the training set as aligned samples <math id="S5.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{aligned}}" display="inline"><semantics id="S5.SS1.SSS1.p1.1.m1.1a"><msub id="S5.SS1.SSS1.p1.1.m1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p1.1.m1.1.1.2" xref="S5.SS1.SSS1.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S5.SS1.SSS1.p1.1.m1.1.1.3" xref="S5.SS1.SSS1.p1.1.m1.1.1.3.cmml">aligned</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.1.m1.1b"><apply id="S5.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1.2">𝒟</ci><ci id="S5.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1.3">aligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.1.m1.1c">\mathcal{D}_{\mathrm{aligned}}</annotation></semantics></math>, and the rest 80% of the training set is used as unaligned samples <math id="S5.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{unaligned}}" display="inline"><semantics id="S5.SS1.SSS1.p1.2.m2.1a"><msub id="S5.SS1.SSS1.p1.2.m2.1.1" xref="S5.SS1.SSS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p1.2.m2.1.1.2" xref="S5.SS1.SSS1.p1.2.m2.1.1.2.cmml">𝒟</mi><mi id="S5.SS1.SSS1.p1.2.m2.1.1.3" xref="S5.SS1.SSS1.p1.2.m2.1.1.3.cmml">unaligned</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.2.m2.1b"><apply id="S5.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS1.p1.2.m2.1.1.2">𝒟</ci><ci id="S5.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS1.p1.2.m2.1.1.3">unaligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.2.m2.1c">\mathcal{D}_{\mathrm{unaligned}}</annotation></semantics></math> by removing their features from non-label party. The performance is evaluated using the test set.</p>
</div>
<div id="S5.SS1.SSS1.p2" class="ltx_para">
<p id="S5.SS1.SSS1.p2.1" class="ltx_p">This setup allows us to know the upper bound of exploiting unaligned samples in vFL on our dataset: if we use the full training data as aligned samples and train a vFL model, the model’s performance is the upper bound because we “leak” the non-label party’s features of <math id="S5.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{\mathrm{unaligned}}" display="inline"><semantics id="S5.SS1.SSS1.p2.1.m1.1a"><msub id="S5.SS1.SSS1.p2.1.m1.1.1" xref="S5.SS1.SSS1.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.SSS1.p2.1.m1.1.1.2" xref="S5.SS1.SSS1.p2.1.m1.1.1.2.cmml">𝒟</mi><mi id="S5.SS1.SSS1.p2.1.m1.1.1.3" xref="S5.SS1.SSS1.p2.1.m1.1.1.3.cmml">unaligned</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p2.1.m1.1b"><apply id="S5.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.2">𝒟</ci><ci id="S5.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.SSS1.p2.1.m1.1.1.3">unaligned</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p2.1.m1.1c">\mathcal{D}_{\mathrm{unaligned}}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.2. </span><span id="S5.SS1.SSS2.1.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span>
</h4>

<div id="S5.SS1.SSS2.p1" class="ltx_para">
<p id="S5.SS1.SSS2.p1.1" class="ltx_p">We use AUC and negative log likelihood (NLL for short) as the evaluation metrics for effectiveness. The former measures ranking performance on candidates, and the latter reflects calibration performance of predicted scores.</p>
</div>
</section>
<section id="S5.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.3. </span><span id="S5.SS1.SSS3.1.1" class="ltx_text ltx_font_bold">Comparative Approaches.</span>
</h4>

<div id="S5.SS1.SSS3.p1" class="ltx_para">
<p id="S5.SS1.SSS3.p1.1" class="ltx_p">We compare the following approaches to evaluate effectiveness:</p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span id="S5.I1.i1.p1.1.1" class="ltx_text ltx_font_sansserif">Local</span> is a model trained on label party’s features only, without using any features from non-label party.</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p"><span id="S5.I1.i2.p1.1.1" class="ltx_text ltx_font_sansserif">VanillaVFL</span> is a vFL model trained on aligned samples using the loss in Equation <a href="#S2.E4" title="Equation 4 ‣ 2.2.1. Two-Party vFL ‣ 2.2. Vertical Federated Learning ‣ 2. Preliminaries ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p"><span id="S5.I1.i3.p1.1.1" class="ltx_text ltx_font_sansserif">HeuristicVFL</span> further exploits label party’s unaligned samples, in which the missing non-label party’s features are synthesized with a heuristic way: for each unaligned sample, we retrieve the user ID from aligned samples, and compute the averaged federated embedding of this user in <span id="S5.I1.i3.p1.1.2" class="ltx_text ltx_font_sansserif">VanillaVFL</span>. Then we perform alternative training (see Section <a href="#S4.SS1.SSS2" title="4.1.2. Alternative Training Framework ‣ 4.1. Exploiting Label Party’s Unaligned Samples ‣ 4. Methodology ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1.2</span></a>).</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p"><span id="S5.I1.i4.p1.1.1" class="ltx_text ltx_font_sansserif">SS-VFL</span> <cite class="ltx_cite ltx_citemacro_citep">(Castiglia
et al<span class="ltx_text">.</span>, <a href="#bib.bib5" title="" class="ltx_ref">[n.d.]</a>)</cite> exploits unaligned samples with self-supervised learning. Each party first employs its local samples to perform unsupervised pretraining, and then a <span id="S5.I1.i4.p1.1.2" class="ltx_text ltx_font_sansserif">VanillaVFL</span> is trained as the final model.</p>
</div>
</li>
<li id="S5.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i5.p1" class="ltx_para">
<p id="S5.I1.i5.p1.1" class="ltx_p"><span id="S5.I1.i5.p1.1.1" class="ltx_text ltx_font_sansserif">FedCVT</span> <cite class="ltx_cite ltx_citemacro_citep">(Kang
et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite> exploits unaligned samples with both self-supervised learning and semi-supervised learning. It first performs unsupervised pretraining to learn a two-stream network. Then a similarity function is used to generate unaligned samples’ features. Finally it combines unlabeled unaligned samples and labeled aligned samples with semi-supervised learning in a co-training fashion.<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Note that the time complexity of similarity computing process in <span id="footnote3.1" class="ltx_text ltx_font_sansserif">FedCVT</span> is too high, and thus we re-implement it with an approximate way through randomly dropping some candidates before similarity computing.</span></span></span></p>
</div>
</li>
<li id="S5.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i6.p1" class="ltx_para">
<p id="S5.I1.i6.p1.1" class="ltx_p"><span id="S5.I1.i6.p1.1.1" class="ltx_text ltx_font_sansserif">VFL-MPD</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2022d</a>)</cite> exploits unaligned samples with a specific self-supervised learning task, where a matched pair detection task is proposed to learn powerful representations using large size of unaligned samples.</p>
</div>
</li>
<li id="S5.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i7.p1" class="ltx_para">
<p id="S5.I1.i7.p1.1" class="ltx_p"><span id="S5.I1.i7.p1.1.1" class="ltx_text ltx_font_sansserif">FedHSSL</span> <cite class="ltx_cite ltx_citemacro_citep">(He
et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite> exploits unaligned samples with two-stage pretraining. The first stage is cross-party pretraining that fits learned representations each other. The second stage is local pretraining where the learning objective is based on data augmentation.</p>
</div>
</li>
<li id="S5.I1.i8" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i8.p1" class="ltx_para">
<p id="S5.I1.i8.p1.1" class="ltx_p"><span id="S5.I1.i8.p1.1.1" class="ltx_text ltx_font_sansserif">JPL</span> <cite class="ltx_cite ltx_citemacro_citep">(Li
et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2022c</a>)</cite> exploits unaligned samples via synthesizing non-label party’s features based on learning a mapping function between label party’s features and non-label party’s features, with several constraints like representation equivalence and label discrimination.<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Note that the original <span id="footnote4.1" class="ltx_text ltx_font_sansserif">JPL</span> approach distills the knowledge of federated model to a local model, which results in performance drop. For fair comparison, we replace the distillation with the alternative training as we stated in Section <a href="#S4.SS1.SSS2" title="4.1.2. Alternative Training Framework ‣ 4.1. Exploiting Label Party’s Unaligned Samples ‣ 4. Methodology ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1.2</span></a>.</span></span></span></p>
</div>
</li>
<li id="S5.I1.i9" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i9.p1" class="ltx_para">
<p id="S5.I1.i9.p1.1" class="ltx_p"><span id="S5.I1.i9.p1.1.1" class="ltx_text ltx_font_sansserif">Diffu-AT</span> is our proposed approach.</p>
</div>
</li>
<li id="S5.I1.i10" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i10.p1" class="ltx_para">
<p id="S5.I1.i10.p1.1" class="ltx_p"><span id="S5.I1.i10.p1.1.1" class="ltx_text ltx_font_sansserif">ORALE</span> is a model trained on the full training set that the non-label party’s features of unaligned samples are known in advance. Therefore its performance is the upper bound of exploiting unaligned samples in our dataset.</p>
</div>
</li>
</ul>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3. </span>Effectiveness evaluation of comparative vFL algorithms for CVR estimation.</figcaption>
<table id="S5.T3.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T3.4.5" class="ltx_tr">
<td id="S5.T3.4.5.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S5.T3.4.5.1.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S5.T3.4.5.2" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S5.T3.4.5.2.1" class="ltx_text ltx_font_bold">Ranking</span>: AUC</td>
<td id="S5.T3.4.5.3" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S5.T3.4.5.3.1" class="ltx_text ltx_font_bold">Calibration</span>: NLL</td>
</tr>
<tr id="S5.T3.1.1" class="ltx_tr">
<td id="S5.T3.1.1.1" class="ltx_td ltx_align_left ltx_border_t" colspan="3">
<span id="S5.T3.1.1.1.1" class="ltx_text ltx_font_italic">Label party’s features</span> <math id="S5.T3.1.1.1.m1.2" class="ltx_Math" alttext="\left\{(\bm{x}_{\mathrm{L}},\bm{y})\right\}" display="inline"><semantics id="S5.T3.1.1.1.m1.2a"><mrow id="S5.T3.1.1.1.m1.2.2.1" xref="S5.T3.1.1.1.m1.2.2.2.cmml"><mo id="S5.T3.1.1.1.m1.2.2.1.2" xref="S5.T3.1.1.1.m1.2.2.2.cmml">{</mo><mrow id="S5.T3.1.1.1.m1.2.2.1.1.1" xref="S5.T3.1.1.1.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S5.T3.1.1.1.m1.2.2.1.1.1.2" xref="S5.T3.1.1.1.m1.2.2.1.1.2.cmml">(</mo><msub id="S5.T3.1.1.1.m1.2.2.1.1.1.1" xref="S5.T3.1.1.1.m1.2.2.1.1.1.1.cmml"><mi id="S5.T3.1.1.1.m1.2.2.1.1.1.1.2" xref="S5.T3.1.1.1.m1.2.2.1.1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S5.T3.1.1.1.m1.2.2.1.1.1.1.3" xref="S5.T3.1.1.1.m1.2.2.1.1.1.1.3.cmml">L</mi></msub><mo id="S5.T3.1.1.1.m1.2.2.1.1.1.3" xref="S5.T3.1.1.1.m1.2.2.1.1.2.cmml">,</mo><mi id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="S5.T3.1.1.1.m1.2.2.1.1.1.4" xref="S5.T3.1.1.1.m1.2.2.1.1.2.cmml">)</mo></mrow><mo id="S5.T3.1.1.1.m1.2.2.1.3" xref="S5.T3.1.1.1.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.2b"><set id="S5.T3.1.1.1.m1.2.2.2.cmml" xref="S5.T3.1.1.1.m1.2.2.1"><interval closure="open" id="S5.T3.1.1.1.m1.2.2.1.1.2.cmml" xref="S5.T3.1.1.1.m1.2.2.1.1.1"><apply id="S5.T3.1.1.1.m1.2.2.1.1.1.1.cmml" xref="S5.T3.1.1.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S5.T3.1.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S5.T3.1.1.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S5.T3.1.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S5.T3.1.1.1.m1.2.2.1.1.1.1.2">𝒙</ci><ci id="S5.T3.1.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S5.T3.1.1.1.m1.2.2.1.1.1.1.3">L</ci></apply><ci id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">𝒚</ci></interval></set></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.2c">\left\{(\bm{x}_{\mathrm{L}},\bm{y})\right\}</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T3.4.6" class="ltx_tr">
<td id="S5.T3.4.6.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.6.1.1" class="ltx_text ltx_font_sansserif">Local</span>
</td>
<td id="S5.T3.4.6.2" class="ltx_td ltx_align_center">0.609</td>
<td id="S5.T3.4.6.3" class="ltx_td ltx_align_center">0.0391</td>
</tr>
<tr id="S5.T3.2.2" class="ltx_tr">
<td id="S5.T3.2.2.1" class="ltx_td ltx_align_left ltx_border_t" colspan="3">
<span id="S5.T3.2.2.1.1" class="ltx_text ltx_font_italic">+ vFL training</span> <math id="S5.T3.2.2.1.m1.2" class="ltx_Math" alttext="\left\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\right\}" display="inline"><semantics id="S5.T3.2.2.1.m1.2a"><mrow id="S5.T3.2.2.1.m1.2.2.1" xref="S5.T3.2.2.1.m1.2.2.2.cmml"><mo id="S5.T3.2.2.1.m1.2.2.1.2" xref="S5.T3.2.2.1.m1.2.2.2.cmml">{</mo><mrow id="S5.T3.2.2.1.m1.2.2.1.1.2" xref="S5.T3.2.2.1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S5.T3.2.2.1.m1.2.2.1.1.2.3" xref="S5.T3.2.2.1.m1.2.2.1.1.3.cmml">(</mo><msub id="S5.T3.2.2.1.m1.2.2.1.1.1.1" xref="S5.T3.2.2.1.m1.2.2.1.1.1.1.cmml"><mi id="S5.T3.2.2.1.m1.2.2.1.1.1.1.2" xref="S5.T3.2.2.1.m1.2.2.1.1.1.1.2.cmml">𝒙</mi><mi mathvariant="normal" id="S5.T3.2.2.1.m1.2.2.1.1.1.1.3" xref="S5.T3.2.2.1.m1.2.2.1.1.1.1.3.cmml">N</mi></msub><mo id="S5.T3.2.2.1.m1.2.2.1.1.2.4" xref="S5.T3.2.2.1.m1.2.2.1.1.3.cmml">,</mo><msub id="S5.T3.2.2.1.m1.2.2.1.1.2.2" xref="S5.T3.2.2.1.m1.2.2.1.1.2.2.cmml"><mi id="S5.T3.2.2.1.m1.2.2.1.1.2.2.2" xref="S5.T3.2.2.1.m1.2.2.1.1.2.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S5.T3.2.2.1.m1.2.2.1.1.2.2.3" xref="S5.T3.2.2.1.m1.2.2.1.1.2.2.3.cmml">L</mi></msub><mo id="S5.T3.2.2.1.m1.2.2.1.1.2.5" xref="S5.T3.2.2.1.m1.2.2.1.1.3.cmml">,</mo><mi id="S5.T3.2.2.1.m1.1.1" xref="S5.T3.2.2.1.m1.1.1.cmml">𝒚</mi><mo stretchy="false" id="S5.T3.2.2.1.m1.2.2.1.1.2.6" xref="S5.T3.2.2.1.m1.2.2.1.1.3.cmml">)</mo></mrow><mo id="S5.T3.2.2.1.m1.2.2.1.3" xref="S5.T3.2.2.1.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.1.m1.2b"><set id="S5.T3.2.2.1.m1.2.2.2.cmml" xref="S5.T3.2.2.1.m1.2.2.1"><vector id="S5.T3.2.2.1.m1.2.2.1.1.3.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.2"><apply id="S5.T3.2.2.1.m1.2.2.1.1.1.1.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.2.1.m1.2.2.1.1.1.1.1.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S5.T3.2.2.1.m1.2.2.1.1.1.1.2.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.1.2">𝒙</ci><ci id="S5.T3.2.2.1.m1.2.2.1.1.1.1.3.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.1.1.3">N</ci></apply><apply id="S5.T3.2.2.1.m1.2.2.1.1.2.2.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S5.T3.2.2.1.m1.2.2.1.1.2.2.1.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.2.2">subscript</csymbol><ci id="S5.T3.2.2.1.m1.2.2.1.1.2.2.2.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.2.2.2">𝒙</ci><ci id="S5.T3.2.2.1.m1.2.2.1.1.2.2.3.cmml" xref="S5.T3.2.2.1.m1.2.2.1.1.2.2.3">L</ci></apply><ci id="S5.T3.2.2.1.m1.1.1.cmml" xref="S5.T3.2.2.1.m1.1.1">𝒚</ci></vector></set></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.1.m1.2c">\left\{(\bm{x}_{\mathrm{N}},\bm{x}_{\mathrm{L}},\bm{y})\right\}</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T3.4.7" class="ltx_tr">
<td id="S5.T3.4.7.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.7.1.1" class="ltx_text ltx_font_sansserif">VanillaVFL</span>
</td>
<td id="S5.T3.4.7.2" class="ltx_td ltx_align_center">0.620</td>
<td id="S5.T3.4.7.3" class="ltx_td ltx_align_center">0.0389</td>
</tr>
<tr id="S5.T3.3.3" class="ltx_tr">
<td id="S5.T3.3.3.1" class="ltx_td ltx_align_left ltx_border_t" colspan="3">
<span id="S5.T3.3.3.1.1" class="ltx_text ltx_font_italic">+ Unaligned samples</span> <math id="S5.T3.3.3.1.m1.1" class="ltx_Math" alttext="\left\{\left(\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}" display="inline"><semantics id="S5.T3.3.3.1.m1.1a"><mrow id="S5.T3.3.3.1.m1.1.1.1" xref="S5.T3.3.3.1.m1.1.1.2.cmml"><mo id="S5.T3.3.3.1.m1.1.1.1.2" xref="S5.T3.3.3.1.m1.1.1.2.cmml">{</mo><mrow id="S5.T3.3.3.1.m1.1.1.1.1.2" xref="S5.T3.3.3.1.m1.1.1.1.1.3.cmml"><mo id="S5.T3.3.3.1.m1.1.1.1.1.2.3" xref="S5.T3.3.3.1.m1.1.1.1.1.3.cmml">(</mo><msubsup id="S5.T3.3.3.1.m1.1.1.1.1.1.1" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1.cmml"><mi id="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.2" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.3" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.3.cmml">L</mi><mi mathvariant="normal" id="S5.T3.3.3.1.m1.1.1.1.1.1.1.3" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S5.T3.3.3.1.m1.1.1.1.1.2.4" xref="S5.T3.3.3.1.m1.1.1.1.1.3.cmml">,</mo><msup id="S5.T3.3.3.1.m1.1.1.1.1.2.2" xref="S5.T3.3.3.1.m1.1.1.1.1.2.2.cmml"><mi id="S5.T3.3.3.1.m1.1.1.1.1.2.2.2" xref="S5.T3.3.3.1.m1.1.1.1.1.2.2.2.cmml">𝒚</mi><mi mathvariant="normal" id="S5.T3.3.3.1.m1.1.1.1.1.2.2.3" xref="S5.T3.3.3.1.m1.1.1.1.1.2.2.3.cmml">u</mi></msup><mo id="S5.T3.3.3.1.m1.1.1.1.1.2.5" xref="S5.T3.3.3.1.m1.1.1.1.1.3.cmml">)</mo></mrow><mo id="S5.T3.3.3.1.m1.1.1.1.3" xref="S5.T3.3.3.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.1.m1.1b"><set id="S5.T3.3.3.1.m1.1.1.2.cmml" xref="S5.T3.3.3.1.m1.1.1.1"><interval closure="open" id="S5.T3.3.3.1.m1.1.1.1.1.3.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.2"><apply id="S5.T3.3.3.1.m1.1.1.1.1.1.1.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.T3.3.3.1.m1.1.1.1.1.1.1.1.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1.2.3">L</ci></apply><ci id="S5.T3.3.3.1.m1.1.1.1.1.1.1.3.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.1.1.3">u</ci></apply><apply id="S5.T3.3.3.1.m1.1.1.1.1.2.2.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.T3.3.3.1.m1.1.1.1.1.2.2.1.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.2.2">superscript</csymbol><ci id="S5.T3.3.3.1.m1.1.1.1.1.2.2.2.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.2.2.2">𝒚</ci><ci id="S5.T3.3.3.1.m1.1.1.1.1.2.2.3.cmml" xref="S5.T3.3.3.1.m1.1.1.1.1.2.2.3">u</ci></apply></interval></set></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.1.m1.1c">\left\{\left(\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T3.4.8" class="ltx_tr">
<td id="S5.T3.4.8.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.8.1.1" class="ltx_text ltx_font_sansserif">HeuristicVFL</span>
</td>
<td id="S5.T3.4.8.2" class="ltx_td ltx_align_center">0.630</td>
<td id="S5.T3.4.8.3" class="ltx_td ltx_align_center">0.0387</td>
</tr>
<tr id="S5.T3.4.9" class="ltx_tr">
<td id="S5.T3.4.9.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.9.1.1" class="ltx_text ltx_font_sansserif">SS-VFL</span>
</td>
<td id="S5.T3.4.9.2" class="ltx_td ltx_align_center">0.636</td>
<td id="S5.T3.4.9.3" class="ltx_td ltx_align_center">0.0381</td>
</tr>
<tr id="S5.T3.4.10" class="ltx_tr">
<td id="S5.T3.4.10.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.10.1.1" class="ltx_text ltx_font_sansserif">FedCVT</span>
</td>
<td id="S5.T3.4.10.2" class="ltx_td ltx_align_center">0.639</td>
<td id="S5.T3.4.10.3" class="ltx_td ltx_align_center">0.0379</td>
</tr>
<tr id="S5.T3.4.11" class="ltx_tr">
<td id="S5.T3.4.11.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.11.1.1" class="ltx_text ltx_font_sansserif">VFL-MPD</span>
</td>
<td id="S5.T3.4.11.2" class="ltx_td ltx_align_center">0.641</td>
<td id="S5.T3.4.11.3" class="ltx_td ltx_align_center"><span id="S5.T3.4.11.3.1" class="ltx_text ltx_font_bold">0.0373</span></td>
</tr>
<tr id="S5.T3.4.12" class="ltx_tr">
<td id="S5.T3.4.12.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.12.1.1" class="ltx_text ltx_font_sansserif">FedHSSL</span>
</td>
<td id="S5.T3.4.12.2" class="ltx_td ltx_align_center">0.642</td>
<td id="S5.T3.4.12.3" class="ltx_td ltx_align_center">0.0375</td>
</tr>
<tr id="S5.T3.4.13" class="ltx_tr">
<td id="S5.T3.4.13.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.13.1.1" class="ltx_text ltx_font_sansserif">JPL</span>
</td>
<td id="S5.T3.4.13.2" class="ltx_td ltx_align_center">0.644</td>
<td id="S5.T3.4.13.3" class="ltx_td ltx_align_center">0.0374</td>
</tr>
<tr id="S5.T3.4.14" class="ltx_tr">
<td id="S5.T3.4.14.1" class="ltx_td ltx_align_left">   <span id="S5.T3.4.14.1.1" class="ltx_text ltx_font_sansserif">Diffu-AT</span> (Ours)</td>
<td id="S5.T3.4.14.2" class="ltx_td ltx_align_center"><span id="S5.T3.4.14.2.1" class="ltx_text ltx_font_bold">0.645</span></td>
<td id="S5.T3.4.14.3" class="ltx_td ltx_align_center">0.0375</td>
</tr>
<tr id="S5.T3.4.4" class="ltx_tr">
<td id="S5.T3.4.4.1" class="ltx_td ltx_align_left ltx_border_t" colspan="3">
<span id="S5.T3.4.4.1.1" class="ltx_text ltx_font_italic">Upper bound</span> <math id="S5.T3.4.4.1.m1.1" class="ltx_Math" alttext="\left\{\left(\bm{x}_{\mathrm{N}}^{\mathrm{u}},\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}" display="inline"><semantics id="S5.T3.4.4.1.m1.1a"><mrow id="S5.T3.4.4.1.m1.1.1.1" xref="S5.T3.4.4.1.m1.1.1.2.cmml"><mo id="S5.T3.4.4.1.m1.1.1.1.2" xref="S5.T3.4.4.1.m1.1.1.2.cmml">{</mo><mrow id="S5.T3.4.4.1.m1.1.1.1.1.3" xref="S5.T3.4.4.1.m1.1.1.1.1.4.cmml"><mo id="S5.T3.4.4.1.m1.1.1.1.1.3.4" xref="S5.T3.4.4.1.m1.1.1.1.1.4.cmml">(</mo><msubsup id="S5.T3.4.4.1.m1.1.1.1.1.1.1" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1.cmml"><mi id="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.2" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.3" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.3.cmml">N</mi><mi mathvariant="normal" id="S5.T3.4.4.1.m1.1.1.1.1.1.1.3" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1.3.cmml">u</mi></msubsup><mo id="S5.T3.4.4.1.m1.1.1.1.1.3.5" xref="S5.T3.4.4.1.m1.1.1.1.1.4.cmml">,</mo><msubsup id="S5.T3.4.4.1.m1.1.1.1.1.2.2" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2.cmml"><mi id="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.2" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.2.cmml">𝒙</mi><mi mathvariant="normal" id="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.3" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.3.cmml">L</mi><mi mathvariant="normal" id="S5.T3.4.4.1.m1.1.1.1.1.2.2.3" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S5.T3.4.4.1.m1.1.1.1.1.3.6" xref="S5.T3.4.4.1.m1.1.1.1.1.4.cmml">,</mo><msup id="S5.T3.4.4.1.m1.1.1.1.1.3.3" xref="S5.T3.4.4.1.m1.1.1.1.1.3.3.cmml"><mi id="S5.T3.4.4.1.m1.1.1.1.1.3.3.2" xref="S5.T3.4.4.1.m1.1.1.1.1.3.3.2.cmml">𝒚</mi><mi mathvariant="normal" id="S5.T3.4.4.1.m1.1.1.1.1.3.3.3" xref="S5.T3.4.4.1.m1.1.1.1.1.3.3.3.cmml">u</mi></msup><mo id="S5.T3.4.4.1.m1.1.1.1.1.3.7" xref="S5.T3.4.4.1.m1.1.1.1.1.4.cmml">)</mo></mrow><mo id="S5.T3.4.4.1.m1.1.1.1.3" xref="S5.T3.4.4.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.1.m1.1b"><set id="S5.T3.4.4.1.m1.1.1.2.cmml" xref="S5.T3.4.4.1.m1.1.1.1"><vector id="S5.T3.4.4.1.m1.1.1.1.1.4.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.3"><apply id="S5.T3.4.4.1.m1.1.1.1.1.1.1.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.T3.4.4.1.m1.1.1.1.1.1.1.1.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.2">𝒙</ci><ci id="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1.2.3">N</ci></apply><ci id="S5.T3.4.4.1.m1.1.1.1.1.1.1.3.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.1.1.3">u</ci></apply><apply id="S5.T3.4.4.1.m1.1.1.1.1.2.2.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.T3.4.4.1.m1.1.1.1.1.2.2.1.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2">superscript</csymbol><apply id="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2">subscript</csymbol><ci id="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.2">𝒙</ci><ci id="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.3.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2.2.3">L</ci></apply><ci id="S5.T3.4.4.1.m1.1.1.1.1.2.2.3.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.2.2.3">u</ci></apply><apply id="S5.T3.4.4.1.m1.1.1.1.1.3.3.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S5.T3.4.4.1.m1.1.1.1.1.3.3.1.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S5.T3.4.4.1.m1.1.1.1.1.3.3.2.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.3.3.2">𝒚</ci><ci id="S5.T3.4.4.1.m1.1.1.1.1.3.3.3.cmml" xref="S5.T3.4.4.1.m1.1.1.1.1.3.3.3">u</ci></apply></vector></set></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.1.m1.1c">\left\{\left(\bm{x}_{\mathrm{N}}^{\mathrm{u}},\bm{x}_{\mathrm{L}}^{\mathrm{u}},\bm{y}^{\mathrm{u}}\right)\right\}</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T3.4.15" class="ltx_tr">
<td id="S5.T3.4.15.1" class="ltx_td ltx_align_left ltx_border_bb">   <span id="S5.T3.4.15.1.1" class="ltx_text ltx_font_sansserif">ORALE</span>
</td>
<td id="S5.T3.4.15.2" class="ltx_td ltx_align_center ltx_border_bb">0.658</td>
<td id="S5.T3.4.15.3" class="ltx_td ltx_align_center ltx_border_bb">0.0367</td>
</tr>
</table>
</figure>
</section>
<section id="S5.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.4. </span><span id="S5.SS1.SSS4.1.1" class="ltx_text ltx_font_bold">Implementation Details.</span>
</h4>

<div id="S5.SS1.SSS4.p1" class="ltx_para">
<p id="S5.SS1.SSS4.p1.6" class="ltx_p">We choose YouTube-DNN <cite class="ltx_cite ltx_citemacro_citep">(Covington
et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2016</a>)</cite> as the backbone. Each feature is represented as an 8-dim embedding. The non-label party submodel <math id="S5.SS1.SSS4.p1.1.m1.1" class="ltx_Math" alttext="f_{\mathrm{N}}" display="inline"><semantics id="S5.SS1.SSS4.p1.1.m1.1a"><msub id="S5.SS1.SSS4.p1.1.m1.1.1" xref="S5.SS1.SSS4.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS4.p1.1.m1.1.1.2" xref="S5.SS1.SSS4.p1.1.m1.1.1.2.cmml">f</mi><mi mathvariant="normal" id="S5.SS1.SSS4.p1.1.m1.1.1.3" xref="S5.SS1.SSS4.p1.1.m1.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.1.m1.1b"><apply id="S5.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.2">𝑓</ci><ci id="S5.SS1.SSS4.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS4.p1.1.m1.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.1.m1.1c">f_{\mathrm{N}}</annotation></semantics></math> contains an embedding table and a two-layered DNN with output sizes of [128, 32]. The label party’s submodel contains two branches <math id="S5.SS1.SSS4.p1.2.m2.1" class="ltx_Math" alttext="f_{\mathrm{L}}" display="inline"><semantics id="S5.SS1.SSS4.p1.2.m2.1a"><msub id="S5.SS1.SSS4.p1.2.m2.1.1" xref="S5.SS1.SSS4.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS4.p1.2.m2.1.1.2" xref="S5.SS1.SSS4.p1.2.m2.1.1.2.cmml">f</mi><mi mathvariant="normal" id="S5.SS1.SSS4.p1.2.m2.1.1.3" xref="S5.SS1.SSS4.p1.2.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.2.m2.1b"><apply id="S5.SS1.SSS4.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.SSS4.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1.2">𝑓</ci><ci id="S5.SS1.SSS4.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS4.p1.2.m2.1.1.3">L</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.2.m2.1c">f_{\mathrm{L}}</annotation></semantics></math> and <math id="S5.SS1.SSS4.p1.3.m3.1" class="ltx_Math" alttext="\tilde{f}_{\mathrm{L}}" display="inline"><semantics id="S5.SS1.SSS4.p1.3.m3.1a"><msub id="S5.SS1.SSS4.p1.3.m3.1.1" xref="S5.SS1.SSS4.p1.3.m3.1.1.cmml"><mover accent="true" id="S5.SS1.SSS4.p1.3.m3.1.1.2" xref="S5.SS1.SSS4.p1.3.m3.1.1.2.cmml"><mi id="S5.SS1.SSS4.p1.3.m3.1.1.2.2" xref="S5.SS1.SSS4.p1.3.m3.1.1.2.2.cmml">f</mi><mo id="S5.SS1.SSS4.p1.3.m3.1.1.2.1" xref="S5.SS1.SSS4.p1.3.m3.1.1.2.1.cmml">~</mo></mover><mi mathvariant="normal" id="S5.SS1.SSS4.p1.3.m3.1.1.3" xref="S5.SS1.SSS4.p1.3.m3.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.3.m3.1b"><apply id="S5.SS1.SSS4.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.SSS4.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1">subscript</csymbol><apply id="S5.SS1.SSS4.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.2"><ci id="S5.SS1.SSS4.p1.3.m3.1.1.2.1.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.2.1">~</ci><ci id="S5.SS1.SSS4.p1.3.m3.1.1.2.2.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.2.2">𝑓</ci></apply><ci id="S5.SS1.SSS4.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS4.p1.3.m3.1.1.3">L</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.3.m3.1c">\tilde{f}_{\mathrm{L}}</annotation></semantics></math>, where they share the embedding table and bottom part (a two-layered DNN with output sizes of [256, 128]), and each top part is a single layer with logistic function to produce predicted score. The two branches do not share the batch normalization operations. The batch size is set to 256. In the conditional diffusion model, the total step <math id="S5.SS1.SSS4.p1.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S5.SS1.SSS4.p1.4.m4.1a"><mi id="S5.SS1.SSS4.p1.4.m4.1.1" xref="S5.SS1.SSS4.p1.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.4.m4.1b"><ci id="S5.SS1.SSS4.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS4.p1.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.4.m4.1c">T</annotation></semantics></math> is set to 1000 as in previous work <cite class="ltx_cite ltx_citemacro_citep">(Ho
et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite>. For timestep <math id="S5.SS1.SSS4.p1.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S5.SS1.SSS4.p1.5.m5.1a"><mi id="S5.SS1.SSS4.p1.5.m5.1.1" xref="S5.SS1.SSS4.p1.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.5.m5.1b"><ci id="S5.SS1.SSS4.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS4.p1.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.5.m5.1c">t</annotation></semantics></math> we use sine and cosine functions to encode, and the schedule for <math id="S5.SS1.SSS4.p1.6.m6.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S5.SS1.SSS4.p1.6.m6.1a"><mi id="S5.SS1.SSS4.p1.6.m6.1.1" xref="S5.SS1.SSS4.p1.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.p1.6.m6.1b"><ci id="S5.SS1.SSS4.p1.6.m6.1.1.cmml" xref="S5.SS1.SSS4.p1.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.p1.6.m6.1c">\beta</annotation></semantics></math> is linear schedule. We implement the models using <span id="S5.SS1.SSS4.p1.6.1" class="ltx_text ltx_font_sansserif">XDL<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note"><span id="footnote5.1.1.1" class="ltx_text ltx_font_serif">5</span></span><a target="_blank" href="https://github.com/alibaba/x-deeplearning" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/alibaba/x-deeplearning</a></span></span></span></span> and <span id="S5.SS1.SSS4.p1.6.2" class="ltx_text ltx_font_sansserif">EFLS</span>.</p>
</div>
</section>
<section id="S5.SS1.SSS5" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.1.5. </span><span id="S5.SS1.SSS5.1.1" class="ltx_text ltx_font_bold">Experimental Results.</span>
</h4>

<div id="S5.SS1.SSS5.p1" class="ltx_para">
<p id="S5.SS1.SSS5.p1.1" class="ltx_p">Table <a href="#S5.T3" title="Table 3 ‣ 5.1.3. Comparative Approaches. ‣ 5.1. Experiments on Effectiveness ‣ 5. Systematical Evaluations ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the evaluation results for effectiveness of all the comparative approaches. Note that 0.3% improvement on AUC can be regarded as a large improvement in large-scale industrial datasets <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2016</a>)</cite>. We observe that <span id="S5.SS1.SSS5.p1.1.1" class="ltx_text ltx_font_sansserif">VanillaVFL</span> outperforms <span id="S5.SS1.SSS5.p1.1.2" class="ltx_text ltx_font_sansserif">Local</span> by around 1.1% AUC, which demonstrates that incorporating non-label party’s features to perform federated training is effective to improve the estimation performance.
Furthermore, exploiting unaligned samples usually boost the AUC and NLL compared to <span id="S5.SS1.SSS5.p1.1.3" class="ltx_text ltx_font_sansserif">VanillaVFL</span>. For instance, the simple approach <span id="S5.SS1.SSS5.p1.1.4" class="ltx_text ltx_font_sansserif">HeuristicVFL</span> outperforms <span id="S5.SS1.SSS5.p1.1.5" class="ltx_text ltx_font_sansserif">VanillaVFL</span> by 1.0% AUC which shows the potential of this direction.
By comparing the approaches that exploits unaligned samples, we can see that the models considering label information of unaligned data (such as <span id="S5.SS1.SSS5.p1.1.6" class="ltx_text ltx_font_sansserif">Diffu-AT</span> and <span id="S5.SS1.SSS5.p1.1.7" class="ltx_text ltx_font_sansserif">JPL</span>) generally perform better than the self-supervised learning models (such as <span id="S5.SS1.SSS5.p1.1.8" class="ltx_text ltx_font_sansserif">FedHSSL</span>, <span id="S5.SS1.SSS5.p1.1.9" class="ltx_text ltx_font_sansserif">VFL-MPD</span> and <span id="S5.SS1.SSS5.p1.1.10" class="ltx_text ltx_font_sansserif">SS-VFL</span>), and thus the labeled samples from label party are the key for improving traditional vFL.</p>
</div>
<div id="S5.SS1.SSS5.p2" class="ltx_para">
<p id="S5.SS1.SSS5.p2.1" class="ltx_p">Our proposed <span id="S5.SS1.SSS5.p2.1.1" class="ltx_text ltx_font_sansserif">Diffu-AT</span> shows the best performance on the ranking ability among all comparative approaches, verifying that the synthesized federated embeddings with diffusion model can enhance the representation of unaligned samples. We also see that <span id="S5.SS1.SSS5.p2.1.2" class="ltx_text ltx_font_sansserif">VFL-MPD</span> performs the best on the calibration performance, and we suggest that its pretraining objective obtains better model initialization. We leave the improvement of <span id="S5.SS1.SSS5.p2.1.3" class="ltx_text ltx_font_sansserif">Diffu-AT</span>’s calibration performance in future work.</p>
</div>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Experiments on Privacy</h3>

<section id="S5.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1. </span><span id="S5.SS2.SSS1.1.1" class="ltx_text ltx_font_bold">Evaluation Metrics for Privacy.</span>
</h4>

<div id="S5.SS2.SSS1.p1" class="ltx_para">
<p id="S5.SS2.SSS1.p1.1" class="ltx_p">We first introduce how a non-label party can perform label inference attack to steal private label information, and then gives the evaluation metrics for privacy.</p>
</div>
<div id="S5.SS2.SSS1.p2" class="ltx_para">
<p id="S5.SS2.SSS1.p2.1" class="ltx_p"><span id="S5.SS2.SSS1.p2.1.1" class="ltx_text ltx_font_bold">Label inference attack.</span></p>
</div>
<div id="S5.SS2.SSS1.p3" class="ltx_para">
<p id="S5.SS2.SSS1.p3.3" class="ltx_p">Specifically, the non-label party is the <span id="S5.SS2.SSS1.p3.3.1" class="ltx_text ltx_font_bold">attacker</span> that performs label inference attack.
The objective of an attacker is to infer the private labels <math id="S5.SS2.SSS1.p3.1.m1.1" class="ltx_Math" alttext="{\bm{y}}" display="inline"><semantics id="S5.SS2.SSS1.p3.1.m1.1a"><mi id="S5.SS2.SSS1.p3.1.m1.1.1" xref="S5.SS2.SSS1.p3.1.m1.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p3.1.m1.1b"><ci id="S5.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S5.SS2.SSS1.p3.1.m1.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p3.1.m1.1c">{\bm{y}}</annotation></semantics></math> owned by the label party based on exchanged federated embeddings <math id="S5.SS2.SSS1.p3.2.m2.1" class="ltx_Math" alttext="\bm{h}_{\mathrm{N}}" display="inline"><semantics id="S5.SS2.SSS1.p3.2.m2.1a"><msub id="S5.SS2.SSS1.p3.2.m2.1.1" xref="S5.SS2.SSS1.p3.2.m2.1.1.cmml"><mi id="S5.SS2.SSS1.p3.2.m2.1.1.2" xref="S5.SS2.SSS1.p3.2.m2.1.1.2.cmml">𝒉</mi><mi mathvariant="normal" id="S5.SS2.SSS1.p3.2.m2.1.1.3" xref="S5.SS2.SSS1.p3.2.m2.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p3.2.m2.1b"><apply id="S5.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S5.SS2.SSS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p3.2.m2.1.1.1.cmml" xref="S5.SS2.SSS1.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.SSS1.p3.2.m2.1.1.2.cmml" xref="S5.SS2.SSS1.p3.2.m2.1.1.2">𝒉</ci><ci id="S5.SS2.SSS1.p3.2.m2.1.1.3.cmml" xref="S5.SS2.SSS1.p3.2.m2.1.1.3">N</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p3.2.m2.1c">\bm{h}_{\mathrm{N}}</annotation></semantics></math> and/or gradients <math id="S5.SS2.SSS1.p3.3.m3.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S5.SS2.SSS1.p3.3.m3.1a"><mi id="S5.SS2.SSS1.p3.3.m3.1.1" xref="S5.SS2.SSS1.p3.3.m3.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p3.3.m3.1b"><ci id="S5.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S5.SS2.SSS1.p3.3.m3.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p3.3.m3.1c">\bm{g}</annotation></semantics></math>. Specifically, the attack can be performed between two iterations during training phrase, or after the training is finished.
We assume that the non-label party is honest-but-curious, which means that it <span id="S5.SS2.SSS1.p3.3.2" class="ltx_text ltx_font_italic">cannot</span> interfere with the training process (such as sending wrong hidden representations to the label party). Under this situation, the non-label party can employ arbitrary classifiers to infer labels.</p>
</div>
<div id="S5.SS2.SSS1.p4" class="ltx_para">
<p id="S5.SS2.SSS1.p4.2" class="ltx_p">From Equation <a href="#S2.E5" title="Equation 5 ‣ 2.2.1. Two-Party vFL ‣ 2.2. Vertical Federated Learning ‣ 2. Preliminaries ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we observe that the form of gradient <math id="S5.SS2.SSS1.p4.1.m1.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S5.SS2.SSS1.p4.1.m1.1a"><mi id="S5.SS2.SSS1.p4.1.m1.1.1" xref="S5.SS2.SSS1.p4.1.m1.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p4.1.m1.1b"><ci id="S5.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S5.SS2.SSS1.p4.1.m1.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p4.1.m1.1c">\bm{g}</annotation></semantics></math> actually contains label information <math id="S5.SS2.SSS1.p4.2.m2.1" class="ltx_Math" alttext="{\bm{y}}" display="inline"><semantics id="S5.SS2.SSS1.p4.2.m2.1a"><mi id="S5.SS2.SSS1.p4.2.m2.1.1" xref="S5.SS2.SSS1.p4.2.m2.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p4.2.m2.1b"><ci id="S5.SS2.SSS1.p4.2.m2.1.1.cmml" xref="S5.SS2.SSS1.p4.2.m2.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p4.2.m2.1c">{\bm{y}}</annotation></semantics></math>. Besides, <cite class="ltx_cite ltx_citemacro_citet">Sun
et al<span class="ltx_text">.</span> (<a href="#bib.bib32" title="" class="ltx_ref">2022</a>)</cite> also found that the federated embeddings gradually have correlations with labels during vFL training. We introduce two attack strategies based on gradient and federated embedding respectively.</p>
<ol id="S5.I2" class="ltx_enumerate">
<li id="S5.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(1)</span> 
<div id="S5.I2.i1.p1" class="ltx_para">
<p id="S5.I2.i1.p1.1" class="ltx_p">Gradient-based attack <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2022a</a>)</cite>. Given the observation that a model tends to be less confident about “a positive sample being positive” than “a negative sample being negative”, if a sample’s gradient norm <math id="S5.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="\lVert\bm{g}\rVert_{2}" display="inline"><semantics id="S5.I2.i1.p1.1.m1.1a"><msub id="S5.I2.i1.p1.1.m1.1.2" xref="S5.I2.i1.p1.1.m1.1.2.cmml"><mrow id="S5.I2.i1.p1.1.m1.1.2.2.2" xref="S5.I2.i1.p1.1.m1.1.2.2.1.cmml"><mo fence="true" rspace="0em" id="S5.I2.i1.p1.1.m1.1.2.2.2.1" xref="S5.I2.i1.p1.1.m1.1.2.2.1.1.cmml">∥</mo><mi id="S5.I2.i1.p1.1.m1.1.1" xref="S5.I2.i1.p1.1.m1.1.1.cmml">𝒈</mi><mo fence="true" lspace="0em" id="S5.I2.i1.p1.1.m1.1.2.2.2.2" xref="S5.I2.i1.p1.1.m1.1.2.2.1.1.cmml">∥</mo></mrow><mn id="S5.I2.i1.p1.1.m1.1.2.3" xref="S5.I2.i1.p1.1.m1.1.2.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.I2.i1.p1.1.m1.1b"><apply id="S5.I2.i1.p1.1.m1.1.2.cmml" xref="S5.I2.i1.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S5.I2.i1.p1.1.m1.1.2.1.cmml" xref="S5.I2.i1.p1.1.m1.1.2">subscript</csymbol><apply id="S5.I2.i1.p1.1.m1.1.2.2.1.cmml" xref="S5.I2.i1.p1.1.m1.1.2.2.2"><csymbol cd="latexml" id="S5.I2.i1.p1.1.m1.1.2.2.1.1.cmml" xref="S5.I2.i1.p1.1.m1.1.2.2.2.1">delimited-∥∥</csymbol><ci id="S5.I2.i1.p1.1.m1.1.1.cmml" xref="S5.I2.i1.p1.1.m1.1.1">𝒈</ci></apply><cn type="integer" id="S5.I2.i1.p1.1.m1.1.2.3.cmml" xref="S5.I2.i1.p1.1.m1.1.2.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.I2.i1.p1.1.m1.1c">\lVert\bm{g}\rVert_{2}</annotation></semantics></math> is larger than a threshold, the attacker infers that it belongs to positive class.</p>
</div>
</li>
<li id="S5.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">(2)</span> 
<div id="S5.I2.i2.p1" class="ltx_para">
<p id="S5.I2.i2.p1.1" class="ltx_p">Federated embedding-based attack <cite class="ltx_cite ltx_citemacro_citep">(Sun
et al<span class="ltx_text">.</span>, <a href="#bib.bib32" title="" class="ltx_ref">2022</a>)</cite>. After vFL model training, we perform clustering on the federated embeddings to place all training samples into two clusters. Given the prior knowledge that positive samples’ size is smaller than that of negative samples, the attacker infers that the samples in the smaller cluster belong to the positive class.</p>
</div>
</li>
</ol>
</div>
<div id="S5.SS2.SSS1.p5" class="ltx_para">
<p id="S5.SS2.SSS1.p5.1" class="ltx_p"><span id="S5.SS2.SSS1.p5.1.1" class="ltx_text ltx_font_bold">Evaluation metrics.</span></p>
</div>
<div id="S5.SS2.SSS1.p6" class="ltx_para">
<p id="S5.SS2.SSS1.p6.1" class="ltx_p">For a vFL model equipping defense approach, we evaluate two aspects including <span id="S5.SS2.SSS1.p6.1.1" class="ltx_text ltx_font_italic">utility</span> and <span id="S5.SS2.SSS1.p6.1.2" class="ltx_text ltx_font_italic">privacy</span>.
The utility aspect is about the prediction performance of the model, and we choose AUC used in previous experiments on effectiveness.</p>
</div>
<div id="S5.SS2.SSS1.p7" class="ltx_para">
<p id="S5.SS2.SSS1.p7.4" class="ltx_p">The privacy aspect evaluates the defense ability to label inference attack. Because the evaluation relies on the attack strategy that may be stochastic to some extent, we design a metric named <math id="S5.SS2.SSS1.p7.1.m1.1" class="ltx_Math" alttext="\Delta\mathrm{LeakAUC}" display="inline"><semantics id="S5.SS2.SSS1.p7.1.m1.1a"><mrow id="S5.SS2.SSS1.p7.1.m1.1.1" xref="S5.SS2.SSS1.p7.1.m1.1.1.cmml"><mi mathvariant="normal" id="S5.SS2.SSS1.p7.1.m1.1.1.2" xref="S5.SS2.SSS1.p7.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS1.p7.1.m1.1.1.1" xref="S5.SS2.SSS1.p7.1.m1.1.1.1.cmml">​</mo><mi id="S5.SS2.SSS1.p7.1.m1.1.1.3" xref="S5.SS2.SSS1.p7.1.m1.1.1.3.cmml">LeakAUC</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p7.1.m1.1b"><apply id="S5.SS2.SSS1.p7.1.m1.1.1.cmml" xref="S5.SS2.SSS1.p7.1.m1.1.1"><times id="S5.SS2.SSS1.p7.1.m1.1.1.1.cmml" xref="S5.SS2.SSS1.p7.1.m1.1.1.1"></times><ci id="S5.SS2.SSS1.p7.1.m1.1.1.2.cmml" xref="S5.SS2.SSS1.p7.1.m1.1.1.2">Δ</ci><ci id="S5.SS2.SSS1.p7.1.m1.1.1.3.cmml" xref="S5.SS2.SSS1.p7.1.m1.1.1.3">LeakAUC</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p7.1.m1.1c">\Delta\mathrm{LeakAUC}</annotation></semantics></math> to compute relative improvement to a base model: 1) we first use the model without any defense approach as the base, and compute the AUC value given the labels inferred by attacker and the true labels, namely <math id="S5.SS2.SSS1.p7.2.m2.1" class="ltx_Math" alttext="\mathrm{LeakAUC}_{\mathrm{base}}" display="inline"><semantics id="S5.SS2.SSS1.p7.2.m2.1a"><msub id="S5.SS2.SSS1.p7.2.m2.1.1" xref="S5.SS2.SSS1.p7.2.m2.1.1.cmml"><mi id="S5.SS2.SSS1.p7.2.m2.1.1.2" xref="S5.SS2.SSS1.p7.2.m2.1.1.2.cmml">LeakAUC</mi><mi id="S5.SS2.SSS1.p7.2.m2.1.1.3" xref="S5.SS2.SSS1.p7.2.m2.1.1.3.cmml">base</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p7.2.m2.1b"><apply id="S5.SS2.SSS1.p7.2.m2.1.1.cmml" xref="S5.SS2.SSS1.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p7.2.m2.1.1.1.cmml" xref="S5.SS2.SSS1.p7.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.SSS1.p7.2.m2.1.1.2.cmml" xref="S5.SS2.SSS1.p7.2.m2.1.1.2">LeakAUC</ci><ci id="S5.SS2.SSS1.p7.2.m2.1.1.3.cmml" xref="S5.SS2.SSS1.p7.2.m2.1.1.3">base</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p7.2.m2.1c">\mathrm{LeakAUC}_{\mathrm{base}}</annotation></semantics></math>. 2) Consider a model with a specific defense approach, similarly we compute the <math id="S5.SS2.SSS1.p7.3.m3.1" class="ltx_Math" alttext="\mathrm{LeakAUC}_{\mathrm{exp}}" display="inline"><semantics id="S5.SS2.SSS1.p7.3.m3.1a"><msub id="S5.SS2.SSS1.p7.3.m3.1.1" xref="S5.SS2.SSS1.p7.3.m3.1.1.cmml"><mi id="S5.SS2.SSS1.p7.3.m3.1.1.2" xref="S5.SS2.SSS1.p7.3.m3.1.1.2.cmml">LeakAUC</mi><mi id="S5.SS2.SSS1.p7.3.m3.1.1.3" xref="S5.SS2.SSS1.p7.3.m3.1.1.3.cmml">exp</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p7.3.m3.1b"><apply id="S5.SS2.SSS1.p7.3.m3.1.1.cmml" xref="S5.SS2.SSS1.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p7.3.m3.1.1.1.cmml" xref="S5.SS2.SSS1.p7.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.SSS1.p7.3.m3.1.1.2.cmml" xref="S5.SS2.SSS1.p7.3.m3.1.1.2">LeakAUC</ci><ci id="S5.SS2.SSS1.p7.3.m3.1.1.3.cmml" xref="S5.SS2.SSS1.p7.3.m3.1.1.3">exp</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p7.3.m3.1c">\mathrm{LeakAUC}_{\mathrm{exp}}</annotation></semantics></math>. 3) Finally we compute the relative improvement <math id="S5.SS2.SSS1.p7.4.m4.1" class="ltx_Math" alttext="\Delta\mathrm{LeakAUC}=(\mathrm{LeakAUC}_{\mathrm{exp}}-\mathrm{LeakAUC}_{\mathrm{base}})/\mathrm{LeakAUC}_{\mathrm{base}}" display="inline"><semantics id="S5.SS2.SSS1.p7.4.m4.1a"><mrow id="S5.SS2.SSS1.p7.4.m4.1.1" xref="S5.SS2.SSS1.p7.4.m4.1.1.cmml"><mrow id="S5.SS2.SSS1.p7.4.m4.1.1.3" xref="S5.SS2.SSS1.p7.4.m4.1.1.3.cmml"><mi mathvariant="normal" id="S5.SS2.SSS1.p7.4.m4.1.1.3.2" xref="S5.SS2.SSS1.p7.4.m4.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS1.p7.4.m4.1.1.3.1" xref="S5.SS2.SSS1.p7.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS1.p7.4.m4.1.1.3.3" xref="S5.SS2.SSS1.p7.4.m4.1.1.3.3.cmml">LeakAUC</mi></mrow><mo id="S5.SS2.SSS1.p7.4.m4.1.1.2" xref="S5.SS2.SSS1.p7.4.m4.1.1.2.cmml">=</mo><mrow id="S5.SS2.SSS1.p7.4.m4.1.1.1" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.cmml"><mrow id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.2" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.cmml"><msub id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.cmml"><mi id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.2" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.2.cmml">LeakAUC</mi><mi id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.3" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.3.cmml">exp</mi></msub><mo id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.1" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.1.cmml">−</mo><msub id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.cmml"><mi id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.2" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.2.cmml">LeakAUC</mi><mi id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.3" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.3.cmml">base</mi></msub></mrow><mo stretchy="false" id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.3" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S5.SS2.SSS1.p7.4.m4.1.1.1.2" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.2.cmml">/</mo><msub id="S5.SS2.SSS1.p7.4.m4.1.1.1.3" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.3.cmml"><mi id="S5.SS2.SSS1.p7.4.m4.1.1.1.3.2" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.3.2.cmml">LeakAUC</mi><mi id="S5.SS2.SSS1.p7.4.m4.1.1.1.3.3" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.3.3.cmml">base</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS1.p7.4.m4.1b"><apply id="S5.SS2.SSS1.p7.4.m4.1.1.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1"><eq id="S5.SS2.SSS1.p7.4.m4.1.1.2.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.2"></eq><apply id="S5.SS2.SSS1.p7.4.m4.1.1.3.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.3"><times id="S5.SS2.SSS1.p7.4.m4.1.1.3.1.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.3.1"></times><ci id="S5.SS2.SSS1.p7.4.m4.1.1.3.2.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.3.2">Δ</ci><ci id="S5.SS2.SSS1.p7.4.m4.1.1.3.3.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.3.3">LeakAUC</ci></apply><apply id="S5.SS2.SSS1.p7.4.m4.1.1.1.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1"><divide id="S5.SS2.SSS1.p7.4.m4.1.1.1.2.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.2"></divide><apply id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1"><minus id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.1.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.1"></minus><apply id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.2">LeakAUC</ci><ci id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.2.3">exp</ci></apply><apply id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.2.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.2">LeakAUC</ci><ci id="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.3.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.1.1.1.3.3">base</ci></apply></apply><apply id="S5.SS2.SSS1.p7.4.m4.1.1.1.3.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.SSS1.p7.4.m4.1.1.1.3.1.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.3">subscript</csymbol><ci id="S5.SS2.SSS1.p7.4.m4.1.1.1.3.2.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.3.2">LeakAUC</ci><ci id="S5.SS2.SSS1.p7.4.m4.1.1.1.3.3.cmml" xref="S5.SS2.SSS1.p7.4.m4.1.1.1.3.3">base</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS1.p7.4.m4.1c">\Delta\mathrm{LeakAUC}=(\mathrm{LeakAUC}_{\mathrm{exp}}-\mathrm{LeakAUC}_{\mathrm{base}})/\mathrm{LeakAUC}_{\mathrm{base}}</annotation></semantics></math> as the evaluation metric.
For the LeakAUC metric, <span id="S5.SS2.SSS1.p7.4.1" class="ltx_text ltx_font_bold">lower</span> is better, because it is expected that the attacker cannot recover true labels.</p>
</div>
</section>
<section id="S5.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2. </span><span id="S5.SS2.SSS2.1.1" class="ltx_text ltx_font_bold">Comparative Approaches.</span>
</h4>

<div id="S5.SS2.SSS2.p1" class="ltx_para">
<p id="S5.SS2.SSS2.p1.1" class="ltx_p">We compare the following random perturbation based defense approaches.</p>
<ul id="S5.I3" class="ltx_itemize">
<li id="S5.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i1.p1" class="ltx_para">
<p id="S5.I3.i1.p1.1" class="ltx_p"><span id="S5.I3.i1.p1.1.1" class="ltx_text ltx_font_sansserif">No Defense</span> is the vFL model that does not equip any defense approach during training.</p>
</div>
</li>
<li id="S5.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i2.p1" class="ltx_para">
<p id="S5.I3.i2.p1.1" class="ltx_p"><span id="S5.I3.i2.p1.1.1" class="ltx_text ltx_font_sansserif">DP</span> <cite class="ltx_cite ltx_citemacro_citep">(Abadi et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2016</a>)</cite> employs differential privacy to obtain a generic gradient perturbation framework, in which DP is enforced on the transmitted information.</p>
</div>
</li>
<li id="S5.I3.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i3.p1" class="ltx_para">
<p id="S5.I3.i3.p1.1" class="ltx_p"><span id="S5.I3.i3.p1.1.1" class="ltx_text ltx_font_sansserif">Marvell</span> <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2022a</a>)</cite> adds Gaussian noise to perturb original gradients, where the covariance matrices of noise distribution are computed based on minimizing leakage level under a noise power constraint. The noise form assumes that the original gradient also follows Gaussian distribution.</p>
</div>
</li>
<li id="S5.I3.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I3.i4.p1" class="ltx_para">
<p id="S5.I3.i4.p1.1" class="ltx_p"><span id="S5.I3.i4.p1.1.1" class="ltx_text ltx_font_sansserif">MixPro</span> is our proposed defense approach.</p>
</div>
</li>
</ul>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4. </span>Privacy evaluation of comparative defense approaches to label inference attack.</figcaption>
<table id="S5.T4.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T4.1.1" class="ltx_tr">
<td id="S5.T4.1.1.2" class="ltx_td ltx_align_left ltx_border_tt"><span id="S5.T4.1.1.2.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S5.T4.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S5.T4.1.1.1.1" class="ltx_text ltx_font_bold">Privacy</span>: <math id="S5.T4.1.1.1.m1.1" class="ltx_Math" alttext="\Delta\mathrm{LeakAUC}" display="inline"><semantics id="S5.T4.1.1.1.m1.1a"><mrow id="S5.T4.1.1.1.m1.1.1" xref="S5.T4.1.1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S5.T4.1.1.1.m1.1.1.2" xref="S5.T4.1.1.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S5.T4.1.1.1.m1.1.1.1" xref="S5.T4.1.1.1.m1.1.1.1.cmml">​</mo><mi id="S5.T4.1.1.1.m1.1.1.3" xref="S5.T4.1.1.1.m1.1.1.3.cmml">LeakAUC</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.1.1.1.m1.1b"><apply id="S5.T4.1.1.1.m1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1"><times id="S5.T4.1.1.1.m1.1.1.1.cmml" xref="S5.T4.1.1.1.m1.1.1.1"></times><ci id="S5.T4.1.1.1.m1.1.1.2.cmml" xref="S5.T4.1.1.1.m1.1.1.2">Δ</ci><ci id="S5.T4.1.1.1.m1.1.1.3.cmml" xref="S5.T4.1.1.1.m1.1.1.3">LeakAUC</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.1.1.1.m1.1c">\Delta\mathrm{LeakAUC}</annotation></semantics></math>
</td>
<td id="S5.T4.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">
<span id="S5.T4.1.1.3.1" class="ltx_text ltx_font_bold">Utility</span>: AUC</td>
</tr>
<tr id="S5.T4.1.2" class="ltx_tr">
<td id="S5.T4.1.2.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T4.1.2.1.1" class="ltx_text ltx_font_sansserif">No Defense</span></td>
<td id="S5.T4.1.2.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S5.T4.1.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.2.3.1" class="ltx_text ltx_font_bold">0.620</span></td>
</tr>
<tr id="S5.T4.1.3" class="ltx_tr">
<td id="S5.T4.1.3.1" class="ltx_td ltx_align_left"><span id="S5.T4.1.3.1.1" class="ltx_text ltx_font_sansserif">DP</span></td>
<td id="S5.T4.1.3.2" class="ltx_td ltx_align_center">-5.7%</td>
<td id="S5.T4.1.3.3" class="ltx_td ltx_align_center">0.602</td>
</tr>
<tr id="S5.T4.1.4" class="ltx_tr">
<td id="S5.T4.1.4.1" class="ltx_td ltx_align_left"><span id="S5.T4.1.4.1.1" class="ltx_text ltx_font_sansserif">Marvell</span></td>
<td id="S5.T4.1.4.2" class="ltx_td ltx_align_center"><span id="S5.T4.1.4.2.1" class="ltx_text ltx_font_bold">-24.7%</span></td>
<td id="S5.T4.1.4.3" class="ltx_td ltx_align_center">0.601</td>
</tr>
<tr id="S5.T4.1.5" class="ltx_tr">
<td id="S5.T4.1.5.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">
<span id="S5.T4.1.5.1.1" class="ltx_text ltx_font_sansserif">MixPro</span> (Ours)</td>
<td id="S5.T4.1.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">-11.3%</td>
<td id="S5.T4.1.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">0.602</td>
</tr>
</table>
</figure>
</section>
<section id="S5.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.3. </span><span id="S5.SS2.SSS3.1.1" class="ltx_text ltx_font_bold">Implementation Details.</span>
</h4>

<div id="S5.SS2.SSS3.p1" class="ltx_para">
<p id="S5.SS2.SSS3.p1.8" class="ltx_p">We choose the <span id="S5.SS2.SSS3.p1.8.1" class="ltx_text ltx_font_sansserif">VanillaVFL</span> model used in previous experiments on effectiveness as the base model to compute <math id="S5.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\mathrm{LeakAUC}_{\mathrm{base}}" display="inline"><semantics id="S5.SS2.SSS3.p1.1.m1.1a"><msub id="S5.SS2.SSS3.p1.1.m1.1.1" xref="S5.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS3.p1.1.m1.1.1.2" xref="S5.SS2.SSS3.p1.1.m1.1.1.2.cmml">LeakAUC</mi><mi id="S5.SS2.SSS3.p1.1.m1.1.1.3" xref="S5.SS2.SSS3.p1.1.m1.1.1.3.cmml">base</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.1.m1.1b"><apply id="S5.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1.2">LeakAUC</ci><ci id="S5.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1.3">base</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.1.m1.1c">\mathrm{LeakAUC}_{\mathrm{base}}</annotation></semantics></math>, and the label inference attack strategy is the federated embedding-based attacker.
There are two key hyperparameters in our proposed <span id="S5.SS2.SSS3.p1.8.2" class="ltx_text ltx_font_sansserif">MixPro</span>: <math id="S5.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS3.p1.2.m2.1a"><mi id="S5.SS2.SSS3.p1.2.m2.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.2.m2.1b"><ci id="S5.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.2.m2.1c">\alpha</annotation></semantics></math> to control the gradient mixup strategy and <math id="S5.SS2.SSS3.p1.3.m3.1" class="ltx_Math" alttext="\phi_{goal}" display="inline"><semantics id="S5.SS2.SSS3.p1.3.m3.1a"><msub id="S5.SS2.SSS3.p1.3.m3.1.1" xref="S5.SS2.SSS3.p1.3.m3.1.1.cmml"><mi id="S5.SS2.SSS3.p1.3.m3.1.1.2" xref="S5.SS2.SSS3.p1.3.m3.1.1.2.cmml">ϕ</mi><mrow id="S5.SS2.SSS3.p1.3.m3.1.1.3" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.cmml"><mi id="S5.SS2.SSS3.p1.3.m3.1.1.3.2" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.3.m3.1.1.3.1" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.3.m3.1.1.3.3" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.3.m3.1.1.3.1a" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.3.m3.1.1.3.4" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.3.m3.1.1.3.1b" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.3.m3.1.1.3.5" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.3.m3.1b"><apply id="S5.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS3.p1.3.m3.1.1.1.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.SSS3.p1.3.m3.1.1.2.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1.2">italic-ϕ</ci><apply id="S5.SS2.SSS3.p1.3.m3.1.1.3.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1.3"><times id="S5.SS2.SSS3.p1.3.m3.1.1.3.1.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.1"></times><ci id="S5.SS2.SSS3.p1.3.m3.1.1.3.2.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.2">𝑔</ci><ci id="S5.SS2.SSS3.p1.3.m3.1.1.3.3.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.3">𝑜</ci><ci id="S5.SS2.SSS3.p1.3.m3.1.1.3.4.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.4">𝑎</ci><ci id="S5.SS2.SSS3.p1.3.m3.1.1.3.5.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.3.m3.1c">\phi_{goal}</annotation></semantics></math> to determine how the mixed gradient should be projected. Generally, a larger <math id="S5.SS2.SSS3.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.SSS3.p1.4.m4.1a"><mi id="S5.SS2.SSS3.p1.4.m4.1.1" xref="S5.SS2.SSS3.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.4.m4.1b"><ci id="S5.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS3.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.4.m4.1c">\alpha</annotation></semantics></math> will force the mixup strategy to show less uncertainty and the mixup weight <math id="S5.SS2.SSS3.p1.5.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.SSS3.p1.5.m5.1a"><mi id="S5.SS2.SSS3.p1.5.m5.1.1" xref="S5.SS2.SSS3.p1.5.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.5.m5.1b"><ci id="S5.SS2.SSS3.p1.5.m5.1.1.cmml" xref="S5.SS2.SSS3.p1.5.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.5.m5.1c">\lambda</annotation></semantics></math> will thus become closer to 0.5, leading to better privacy preservation but greater compromise on AUC. A larger <math id="S5.SS2.SSS3.p1.6.m6.1" class="ltx_Math" alttext="\phi_{goal}" display="inline"><semantics id="S5.SS2.SSS3.p1.6.m6.1a"><msub id="S5.SS2.SSS3.p1.6.m6.1.1" xref="S5.SS2.SSS3.p1.6.m6.1.1.cmml"><mi id="S5.SS2.SSS3.p1.6.m6.1.1.2" xref="S5.SS2.SSS3.p1.6.m6.1.1.2.cmml">ϕ</mi><mrow id="S5.SS2.SSS3.p1.6.m6.1.1.3" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.cmml"><mi id="S5.SS2.SSS3.p1.6.m6.1.1.3.2" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.6.m6.1.1.3.1" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.6.m6.1.1.3.3" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.6.m6.1.1.3.1a" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.6.m6.1.1.3.4" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.6.m6.1.1.3.1b" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.6.m6.1.1.3.5" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.5.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.6.m6.1b"><apply id="S5.SS2.SSS3.p1.6.m6.1.1.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS3.p1.6.m6.1.1.1.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1">subscript</csymbol><ci id="S5.SS2.SSS3.p1.6.m6.1.1.2.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1.2">italic-ϕ</ci><apply id="S5.SS2.SSS3.p1.6.m6.1.1.3.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1.3"><times id="S5.SS2.SSS3.p1.6.m6.1.1.3.1.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.1"></times><ci id="S5.SS2.SSS3.p1.6.m6.1.1.3.2.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.2">𝑔</ci><ci id="S5.SS2.SSS3.p1.6.m6.1.1.3.3.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.3">𝑜</ci><ci id="S5.SS2.SSS3.p1.6.m6.1.1.3.4.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.4">𝑎</ci><ci id="S5.SS2.SSS3.p1.6.m6.1.1.3.5.cmml" xref="S5.SS2.SSS3.p1.6.m6.1.1.3.5">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.6.m6.1c">\phi_{goal}</annotation></semantics></math> will also narrow down the region of gradients’ directions and provide better privacy performance with more trade-off on AUC. In experiments we set <math id="S5.SS2.SSS3.p1.7.m7.1" class="ltx_Math" alttext="\alpha=0.6" display="inline"><semantics id="S5.SS2.SSS3.p1.7.m7.1a"><mrow id="S5.SS2.SSS3.p1.7.m7.1.1" xref="S5.SS2.SSS3.p1.7.m7.1.1.cmml"><mi id="S5.SS2.SSS3.p1.7.m7.1.1.2" xref="S5.SS2.SSS3.p1.7.m7.1.1.2.cmml">α</mi><mo id="S5.SS2.SSS3.p1.7.m7.1.1.1" xref="S5.SS2.SSS3.p1.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS3.p1.7.m7.1.1.3" xref="S5.SS2.SSS3.p1.7.m7.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.7.m7.1b"><apply id="S5.SS2.SSS3.p1.7.m7.1.1.cmml" xref="S5.SS2.SSS3.p1.7.m7.1.1"><eq id="S5.SS2.SSS3.p1.7.m7.1.1.1.cmml" xref="S5.SS2.SSS3.p1.7.m7.1.1.1"></eq><ci id="S5.SS2.SSS3.p1.7.m7.1.1.2.cmml" xref="S5.SS2.SSS3.p1.7.m7.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.SSS3.p1.7.m7.1.1.3.cmml" xref="S5.SS2.SSS3.p1.7.m7.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.7.m7.1c">\alpha=0.6</annotation></semantics></math> and <math id="S5.SS2.SSS3.p1.8.m8.1" class="ltx_Math" alttext="\phi_{goal}=\sqrt{3}/2" display="inline"><semantics id="S5.SS2.SSS3.p1.8.m8.1a"><mrow id="S5.SS2.SSS3.p1.8.m8.1.1" xref="S5.SS2.SSS3.p1.8.m8.1.1.cmml"><msub id="S5.SS2.SSS3.p1.8.m8.1.1.2" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.cmml"><mi id="S5.SS2.SSS3.p1.8.m8.1.1.2.2" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.2.cmml">ϕ</mi><mrow id="S5.SS2.SSS3.p1.8.m8.1.1.2.3" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.cmml"><mi id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.2" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.1" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.3" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.1a" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.4" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.1b" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.1.cmml">​</mo><mi id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.5" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.5.cmml">l</mi></mrow></msub><mo id="S5.SS2.SSS3.p1.8.m8.1.1.1" xref="S5.SS2.SSS3.p1.8.m8.1.1.1.cmml">=</mo><mrow id="S5.SS2.SSS3.p1.8.m8.1.1.3" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.cmml"><msqrt id="S5.SS2.SSS3.p1.8.m8.1.1.3.2" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.2.cmml"><mn id="S5.SS2.SSS3.p1.8.m8.1.1.3.2.2" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.2.2.cmml">3</mn></msqrt><mo id="S5.SS2.SSS3.p1.8.m8.1.1.3.1" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.1.cmml">/</mo><mn id="S5.SS2.SSS3.p1.8.m8.1.1.3.3" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.8.m8.1b"><apply id="S5.SS2.SSS3.p1.8.m8.1.1.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1"><eq id="S5.SS2.SSS3.p1.8.m8.1.1.1.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.1"></eq><apply id="S5.SS2.SSS3.p1.8.m8.1.1.2.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.SSS3.p1.8.m8.1.1.2.1.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2">subscript</csymbol><ci id="S5.SS2.SSS3.p1.8.m8.1.1.2.2.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.2">italic-ϕ</ci><apply id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3"><times id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.1.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.1"></times><ci id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.2.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.2">𝑔</ci><ci id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.3.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.3">𝑜</ci><ci id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.4.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.4">𝑎</ci><ci id="S5.SS2.SSS3.p1.8.m8.1.1.2.3.5.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.2.3.5">𝑙</ci></apply></apply><apply id="S5.SS2.SSS3.p1.8.m8.1.1.3.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.3"><divide id="S5.SS2.SSS3.p1.8.m8.1.1.3.1.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.1"></divide><apply id="S5.SS2.SSS3.p1.8.m8.1.1.3.2.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.2"><root id="S5.SS2.SSS3.p1.8.m8.1.1.3.2a.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.2"></root><cn type="integer" id="S5.SS2.SSS3.p1.8.m8.1.1.3.2.2.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.2.2">3</cn></apply><cn type="integer" id="S5.SS2.SSS3.p1.8.m8.1.1.3.3.cmml" xref="S5.SS2.SSS3.p1.8.m8.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.8.m8.1c">\phi_{goal}=\sqrt{3}/2</annotation></semantics></math> by default.</p>
</div>
</section>
<section id="S5.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.4. </span><span id="S5.SS2.SSS4.1.1" class="ltx_text ltx_font_bold">Experimental Results.</span>
</h4>

<div id="S5.SS2.SSS4.p1" class="ltx_para">
<p id="S5.SS2.SSS4.p1.1" class="ltx_p">Table <a href="#S5.T4" title="Table 4 ‣ 5.2.2. Comparative Approaches. ‣ 5.2. Experiments on Privacy ‣ 5. Systematical Evaluations ‣ FedAds: A Benchmark for Privacy-Preserving CVR Estimation with Vertical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows the experimental results on our proposed datasets of our proposed <span id="S5.SS2.SSS4.p1.1.1" class="ltx_text ltx_font_sansserif">MixPro</span> and other compared approaches against the label inference attack. The straightforward <span id="S5.SS2.SSS4.p1.1.2" class="ltx_text ltx_font_sansserif">DP</span> only achieves very limited privacy performance compared to <span id="S5.SS2.SSS4.p1.1.3" class="ltx_text ltx_font_sansserif">No Defense</span>, which means that more sophisticated approaches are needed for protecting label information.</p>
</div>
<div id="S5.SS2.SSS4.p2" class="ltx_para">
<p id="S5.SS2.SSS4.p2.1" class="ltx_p"><span id="S5.SS2.SSS4.p2.1.1" class="ltx_text ltx_font_sansserif">Marvell</span> reduces the LeakAUC by a large margin and achieves an acceptable level, demonstrating that the a well-designed random perturbation strategy is very effective for defending label inference attack.
Our proposed <span id="S5.SS2.SSS4.p2.1.2" class="ltx_text ltx_font_sansserif">MixPro</span> performs much better than <span id="S5.SS2.SSS4.p2.1.3" class="ltx_text ltx_font_sansserif">DP</span>, verifying its privacy performance in vFL model training, and <span id="S5.SS2.SSS4.p2.1.4" class="ltx_text ltx_font_sansserif">Marvell</span> is still the state-of-the-art defense approach. We suggest that in <span id="S5.SS2.SSS4.p2.1.5" class="ltx_text ltx_font_sansserif">MixPro</span> the random sampling operation for mixup and projection may restrict its defense ability, because the size of positive samples is very small and thus two combined gradients usually come from the same class.
We also notice that both <span id="S5.SS2.SSS4.p2.1.6" class="ltx_text ltx_font_sansserif">MixPro</span> and <span id="S5.SS2.SSS4.p2.1.7" class="ltx_text ltx_font_sansserif">Marvell</span> result in a drop of around 2.0% AUC compared to <span id="S5.SS2.SSS4.p2.1.8" class="ltx_text ltx_font_sansserif">No Defense</span>. Therefore, better utility-privacy trade-off is a key direction in further defense approaches during vFL model training.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Related Work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">There are many great benchmarks for FL, such as LEAF <cite class="ltx_cite ltx_citemacro_citep">(Caldas et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite>, FedML <cite class="ltx_cite ltx_citemacro_citep">(He et al<span class="ltx_text">.</span>, <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>, Flower <cite class="ltx_cite ltx_citemacro_citep">(Beutel et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite>, FedScale <cite class="ltx_cite ltx_citemacro_citep">(Lai et al<span class="ltx_text">.</span>, <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite>, FLamby <cite class="ltx_cite ltx_citemacro_citep">(Terrail
et al<span class="ltx_text">.</span>, <a href="#bib.bib34" title="" class="ltx_ref">2022</a>)</cite> and pFL-bench <cite class="ltx_cite ltx_citemacro_citep">(Chen
et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite>.
They mainly focus on horizontal FL and personalized FL, and to our knowledge no vFL benchmarks have been proposed for fair comparing existing approaches, especially for neural network based vFL approaches.
In this work, we propose the vFL benchmark named <span id="S6.p1.1.1" class="ltx_text ltx_font_sansserif">FedAds</span>, which provides a large-scale dataset collected from Alibaba’s advertising system, as well as systematical evaluations for existing approaches. Therefore we believe that the <span id="S6.p1.1.2" class="ltx_text ltx_font_sansserif">FedAds</span> makes good contributions to facilitate vFL research.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7. </span>Conclusion and Future Work</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We introduce <span id="S7.p1.1.1" class="ltx_text ltx_font_sansserif">FedAds</span>, the first benchmark for privacy-preserving CVR estimation, to facilitate systematical evaluations for vFL algorithms. It contains 1) a large-scale real-world dataset from our online advertising platform, collected from an ad delivery business relying on vFL-based ranking models, as well as 2) systematical evaluations for both effectiveness and privacy aspects of various neural network based vFL algorithms through extensive experiments. Besides, to improve vFL effectiveness, we explore to incorporate unaligned data via generating unaligned samples’ feature representations using generative models. To protect privacy well, we also develop perturbation based on mixup and projection operations. Experiments show that they achieve reasonable performances.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">In future work, we shall explore the following directions: 1) Improving the calibration performance of vFL models <cite class="ltx_cite ltx_citemacro_citep">(Pan
et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2020</a>; Wei et al<span class="ltx_text">.</span>, <a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite>. 2) Alleviating the sample selection bias issue in CVR estimation models through debiasing approaches <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a href="#bib.bib11" title="" class="ltx_ref">2021</a>; Xu
et al<span class="ltx_text">.</span>, <a href="#bib.bib40" title="" class="ltx_ref">2022</a>)</cite> for vFL models. 3) Improving vFL training efficiency. 4) Extending the usage of vFL fashion from ranking stage to retrieval stage in online adverting systems.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgement</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work was supported by Alibaba Innovative Research project. We thank all the anonymous reviewers for their valuable comments.
We also thank Jinquan Liu and Prof. Baoyuan Wu for assistance.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abadi et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Martin Abadi, Andy Chu,
Ian Goodfellow, H Brendan McMahan,
Ilya Mironov, Kunal Talwar, and
Li Zhang. 2016.

</span>
<span class="ltx_bibblock">Deep learning with differential privacy. In
<em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 2016 ACM SIGSAC conference on
computer and communications security</em>. 308–318.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beutel et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Daniel J Beutel, Taner
Topal, Akhil Mathur, Xinchi Qiu,
Titouan Parcollet, Pedro PB de
Gusmão, and Nicholas D Lane.
2020.

</span>
<span class="ltx_bibblock">Flower: A friendly federated learning research
framework.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.14390</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caldas et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Sebastian Caldas, Sai
Meher Karthik Duddu, Peter Wu, Tian Li,
Jakub Konečnỳ, H Brendan
McMahan, Virginia Smith, and Ameet
Talwalkar. 2018.

</span>
<span class="ltx_bibblock">Leaf: A benchmark for federated settings.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.01097</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Castiglia
et al<span id="bib.bib5.2.2.1" class="ltx_text">.</span> ([n.d.])</span>
<span class="ltx_bibblock">
Timothy Castiglia,
Shiqiang Wang, and Stacy Patterson.
[n.d.].

</span>
<span class="ltx_bibblock">Self-Supervised Vertical Federated Learning. In
<em id="bib.bib5.3.1" class="ltx_emph ltx_font_italic">Workshop on Federated Learning: Recent Advances and
New Challenges (in Conjunction with NeurIPS 2022)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen
et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Daoyuan Chen, Dawei Gao,
Weirui Kuang, Yaliang Li, and
Bolin Ding. 2022.

</span>
<span class="ltx_bibblock">pFL-Bench: A Comprehensive Benchmark for
Personalized Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.03655</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span id="bib.bib7.3.3.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Heng-Tze Cheng, Levent
Koc, Jeremiah Harmsen, Tal Shaked,
Tushar Chandra, Hrishi Aradhye,
Glen Anderson, Greg Corrado,
Wei Chai, Mustafa Ispir, et al<span id="bib.bib7.4.1" class="ltx_text">.</span>
2016.

</span>
<span class="ltx_bibblock">Wide &amp; deep learning for recommender systems. In
<em id="bib.bib7.5.1" class="ltx_emph ltx_font_italic">Proceedings of the 1st workshop on deep learning
for recommender systems</em>. 7–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Covington
et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Paul Covington, Jay
Adams, and Emre Sargin.
2016.

</span>
<span class="ltx_bibblock">Deep neural networks for YouTube
recommendations. In <em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 10th ACM
conference on recommender systems</em>. 191–198.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Chong Fu, Xuhong Zhang,
Shouling Ji, Jinyin Chen,
Jingzheng Wu, Shanqing Guo,
Jun Zhou, Alex X Liu, and
Ting Wang. 2022.

</span>
<span class="ltx_bibblock">Label inference attacks against vertical federated
learning. In <em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">31st USENIX Security Symposium
(USENIX Security 22), Boston, MA</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong
et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Shansan Gong, Mukai Li,
Jiangtao Feng, Zhiyong Wu, and
Lingpeng Kong. 2023.

</span>
<span class="ltx_bibblock">Sequence to sequence text generation with diffusion
models. In <em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span id="bib.bib11.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Siyuan Guo, Lixin Zou,
Yiding Liu, Wenwen Ye,
Suqi Cheng, Shuaiqiang Wang,
Hechang Chen, Dawei Yin, and
Yi Chang. 2021.

</span>
<span class="ltx_bibblock">Enhanced Doubly Robust Learning for Debiasing
Post-click Conversion Rate Estimation. In <em id="bib.bib11.3.1" class="ltx_emph ltx_font_italic">The 44th
International ACM SIGIR Conference on Research and Development in Information
Retrieval</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span id="bib.bib12.3.3.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Chaoyang He, Songze Li,
Jinhyun So, Xiao Zeng,
Mi Zhang, Hongyi Wang,
Xiaoyang Wang, Praneeth Vepakomma,
Abhishek Singh, Hang Qiu,
et al<span id="bib.bib12.4.1" class="ltx_text">.</span> 2020.

</span>
<span class="ltx_bibblock">Fedml: A research library and benchmark for
federated machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.5.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.13518</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He
et al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Yuanqin He, Yan Kang,
Jiahuan Luo, Lixin Fan, and
Qiang Yang. 2022.

</span>
<span class="ltx_bibblock">A hybrid self-supervised learning framework for
vertical federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2208.08934</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho
et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain,
and Pieter Abbeel. 2020.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em> 33 (2020),
6840–6851.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaggle ([n.d.]a)</span>
<span class="ltx_bibblock">
Kaggle.
[n.d.]a.

</span>
<span class="ltx_bibblock">Avazu dataset.

</span>
<span class="ltx_bibblock">https://www.kaggle.com/c/avazu-ctr-prediction.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaggle ([n.d.]b)</span>
<span class="ltx_bibblock">
Kaggle.
[n.d.]b.

</span>
<span class="ltx_bibblock">Give me some credit dataset.

</span>
<span class="ltx_bibblock">https://www.kaggle.com/c/GiveMeSomeCredit.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang
et al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Yan Kang, Yang Liu, and
Xinle Liang. 2022.

</span>
<span class="ltx_bibblock">FedCVT: Semi-supervised vertical federated
learning with cross-view training.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.3.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology (TIST)</em> 13, 4
(2022), 1–16.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kolesnikov et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Vladimir Kolesnikov,
Ranjit Kumaresan, Mike Rosulek, and
Ni Trieu. 2016.

</span>
<span class="ltx_bibblock">Efficient batched oblivious PRF with applications
to private set intersection. In <em id="bib.bib18.3.1" class="ltx_emph ltx_font_italic">Proceedings of the
2016 ACM SIGSAC Conference on Computer and Communications Security</em>.
818–829.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Labs. ([n.d.])</span>
<span class="ltx_bibblock">
Criteo Labs.
[n.d.].

</span>
<span class="ltx_bibblock">Criteo dataset.

</span>
<span class="ltx_bibblock">https://labs.criteo.com/2014/02/download-kaggle-display-advert
ising-challenge-dataset/.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lai et al<span id="bib.bib20.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Fan Lai, Yinwei Dai,
Sanjay Singapuram, Jiachen Liu,
Xiangfeng Zhu, Harsha Madhyastha, and
Mosharaf Chowdhury. 2022.

</span>
<span class="ltx_bibblock">Fedscale: Benchmarking model and system performance
of federated learning at scale. In <em id="bib.bib20.3.1" class="ltx_emph ltx_font_italic">International
Conference on Machine Learning</em>. PMLR, 11814–11827.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2022a)</span>
<span class="ltx_bibblock">
Oscar Li, Jiankai Sun,
Xin Yang, Weihao Gao,
Hongyi Zhang, Junyuan Xie,
Virginia Smith, and Chong Wang.
2022a.

</span>
<span class="ltx_bibblock">Label Leakage and Protection in Two-party Split
Learning. In <em id="bib.bib21.3.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li
et al<span id="bib.bib22.2.2.1" class="ltx_text">.</span> (2022c)</span>
<span class="ltx_bibblock">
Wenjie Li, Qiaolin Xia,
Hao Cheng, Kouyin Xue, and
Shu-Tao Xia. 2022c.

</span>
<span class="ltx_bibblock">Vertical semi-federated learning for efficient
online advertising.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.15635</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2022d)</span>
<span class="ltx_bibblock">
Wenjie Li, Qiaolin Xia,
Junfeng Deng, Hao Cheng,
Jiangming Liu, Kouying Xue,
Yong Cheng, and Shu-Tao Xia.
2022d.

</span>
<span class="ltx_bibblock">Semi-supervised cross-silo advertising with partial
knowledge transfer.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.3.1" class="ltx_emph ltx_font_italic">International Workshop on Trustworthy
Federated Learning in Conjunction with IJCAI 2022 (FL-IJCAI’22)</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2022b)</span>
<span class="ltx_bibblock">
Xiang Lisa Li, John
Thickstun, Ishaan Gulrajani, Percy
Liang, and Tatsunori Hashimoto.
2022b.

</span>
<span class="ltx_bibblock">Diffusion-LM Improves Controllable Text
Generation. In <em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma
et al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Xiao Ma, Liqin Zhao,
Guan Huang, Zhi Wang,
Zelin Hu, Xiaoqiang Zhu, and
Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Entire Space Multi-Task Model: An Effective
Approach for Estimating Post-Click Conversion Rate. In
<em id="bib.bib25.3.1" class="ltx_emph ltx_font_italic">The 41st International ACM SIGIR Conference on
Research and Development in Information Retrieval</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider
Moore, Daniel Ramage, Seth Hampson,
and Blaise Aguera y Arcas.
2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data. In <em id="bib.bib26.3.1" class="ltx_emph ltx_font_italic">Artificial
intelligence and statistics</em>. PMLR, 1273–1282.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mooney ([n.d.])</span>
<span class="ltx_bibblock">
P. Mooney.
[n.d.].

</span>
<span class="ltx_bibblock">Breast histopathology images.

</span>
<span class="ltx_bibblock">https://www.kaggle.com/datasets/paultimothymooney/breast-histopathology-images.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pan
et al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Feiyang Pan, Xiang Ao,
Pingzhong Tang, Min Lu,
Dapeng Liu, Lei Xiao, and
Qing He. 2020.

</span>
<span class="ltx_bibblock">Field-aware calibration: A simple and empirically
strong method for reliable probabilistic predictions. In
<em id="bib.bib28.3.1" class="ltx_emph ltx_font_italic">Proceedings of The Web Conference 2020</em>.
729–739.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">PASCAL-Challenge-2008 ([n.d.])</span>
<span class="ltx_bibblock">
PASCAL-Challenge-2008.
[n.d.].

</span>
<span class="ltx_bibblock">epsilon dataset.

</span>
<span class="ltx_bibblock">https://www.csie.ntu.edu.tw/ cjlin/libsvmtools/datasets/.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rakshit ([n.d.])</span>
<span class="ltx_bibblock">
Soumik Rakshit.
[n.d.].

</span>
<span class="ltx_bibblock">Yahoo answers dataset.

</span>
<span class="ltx_bibblock">https://www.kaggle.com/soumikrakshit/yahoo-answers-dataset.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sohl-Dickstein et al<span id="bib.bib31.2.2.1" class="ltx_text">.</span> (2015)</span>
<span class="ltx_bibblock">
Jascha Sohl-Dickstein,
Eric Weiss, Niru Maheswaranathan, and
Surya Ganguli. 2015.

</span>
<span class="ltx_bibblock">Deep unsupervised learning using nonequilibrium
thermodynamics. In <em id="bib.bib31.3.1" class="ltx_emph ltx_font_italic">International Conference on
Machine Learning</em>. PMLR, 2256–2265.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun
et al<span id="bib.bib32.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Jiankai Sun, Xin Yang,
Yuanshun Yao, and Chong Wang.
2022.

</span>
<span class="ltx_bibblock">Label Leakage and Protection from Forward Embedding
in Vertical Federated Learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.01451</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun
et al<span id="bib.bib33.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Jiankai Sun, Yuanshun
Yao, Weihao Gao, Junyuan Xie, and
Chong Wang. 2021.

</span>
<span class="ltx_bibblock">Defending against reconstruction attack in vertical
federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.09898</em>
(2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Terrail
et al<span id="bib.bib34.3.3.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Jean Ogier du Terrail,
Samy-Safwan Ayed, Edwige Cyffers,
Felix Grimberg, Chaoyang He,
Regis Loeb, Paul Mangold,
Tanguy Marchand, Othmane Marfoq,
Erum Mushtaq, et al<span id="bib.bib34.4.1" class="ltx_text">.</span>
2022.

</span>
<span class="ltx_bibblock">FLamby: Datasets and Benchmarks for Cross-Silo
Federated Learning in Realistic Healthcare Settings.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.5.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2210.04620</em>
(2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vepakomma
et al<span id="bib.bib35.2.2.1" class="ltx_text">.</span> (2018a)</span>
<span class="ltx_bibblock">
Praneeth Vepakomma,
Otkrist Gupta, Abhimanyu Dubey, and
Ramesh Raskar. 2018a.

</span>
<span class="ltx_bibblock">Reducing leakage in distributed deep learning for
sensitive health data.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.3.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.00564</em>
2 (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vepakomma et al<span id="bib.bib36.2.2.1" class="ltx_text">.</span> (2018b)</span>
<span class="ltx_bibblock">
Praneeth Vepakomma,
Otkrist Gupta, Tristan Swedish, and
Ramesh Raskar. 2018b.

</span>
<span class="ltx_bibblock">Split learning for health: Distributed deep
learning without sharing raw patient data.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.3.1" class="ltx_emph ltx_font_italic">ICLR 2019 Workshop on AI for social good</em>
(2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang
et al<span id="bib.bib37.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Zirui Wang, Yulia
Tsvetkov, Orhan Firat, and Yuan Cao.
2021.

</span>
<span class="ltx_bibblock">Gradient Vaccine: Investigating and Improving
Multi-task Optimization in Massively Multilingual Models. In
<em id="bib.bib37.3.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span id="bib.bib38.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Penghui Wei, Weimin
Zhang, Ruijie Hou, Jinquan Liu,
Shaoguo Liu, Liang Wang, and
Bo Zheng. 2022.

</span>
<span class="ltx_bibblock">Posterior Probability Matters: Doubly-Adaptive
Calibration for Neural Predictions in Online Advertising. In
<em id="bib.bib38.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 45th International ACM SIGIR
Conference on Research and Development in Information Retrieval</em>.
2645–2649.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei
et al<span id="bib.bib39.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Penghui Wei, Weimin
Zhang, Zixuan Xu, Shaoguo Liu,
Kuang-chih Lee, and Bo Zheng.
2021.

</span>
<span class="ltx_bibblock">AutoHERI: Automated Hierarchical Representation
Integration for Post-Click Conversion Rate Estimation. In
<em id="bib.bib39.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 30th ACM International
Conference on Information &amp; Knowledge Management</em>.
3528–3532.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu
et al<span id="bib.bib40.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Zixuan Xu, Penghui Wei,
Weimin Zhang, Shaoguo Liu,
Liang Wang, and Bo Zheng.
2022.

</span>
<span class="ltx_bibblock">UKD: Debiasing Conversion Rate Estimation via
Uncertainty-regularized Knowledge Distillation. In
<em id="bib.bib40.3.1" class="ltx_emph ltx_font_italic">Proceedings of The Web Conference 2022</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang
et al<span id="bib.bib41.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Qiang Yang, Yang Liu,
Tianjian Chen, and Yongxin Tong.
2019.

</span>
<span class="ltx_bibblock">Federated machine learning: Concept and
applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib41.3.1" class="ltx_emph ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology (TIST)</em> 10, 2
(2019), 1–19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al<span id="bib.bib42.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Tianhe Yu, Saurabh Kumar,
Abhishek Gupta, Sergey Levine,
Karol Hausman, and Chelsea Finn.
2020.

</span>
<span class="ltx_bibblock">Gradient surgery for multi-task learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.3.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing
Systems</em> 33 (2020),
5824–5836.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang
et al<span id="bib.bib43.2.2.1" class="ltx_text">.</span> (2018)</span>
<span class="ltx_bibblock">
Hongyi Zhang, Moustapha
Cisse, Yann N Dauphin, and David
Lopez-Paz. 2018.

</span>
<span class="ltx_bibblock">mixup: Beyond Empirical Risk Minimization. In
<em id="bib.bib43.3.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Zhu (2020)</span>
<span class="ltx_bibblock">
Yifei Zhang and Hao
Zhu. 2020.

</span>
<span class="ltx_bibblock">Additively homomorphical encryption based deep
neural network for asymmetrically collaborative machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2007.06849</em>
(2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2305.08325" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2305.08328" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2305.08328">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2305.08328" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2305.08329" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 07:46:40 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
