<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.12296] Prototype Helps Federated Learning: Towards Faster Convergence</title><meta property="og:description" content="Federated learning (FL) is a distributed machine learning technique in which multiple clients cooperate to train a shared model without exchanging their raw data. However, heterogeneity of data distribution among clien…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Prototype Helps Federated Learning: Towards Faster Convergence">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Prototype Helps Federated Learning: Towards Faster Convergence">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.12296">

<!--Generated on Thu Feb 29 19:07:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_pruned_first">
<h1 class="ltx_title ltx_title_document" style="font-size:144%;"><span id="id1.id1" class="ltx_text ltx_font_bold">Prototype Helps Federated Learning: Towards Faster Convergence</span></h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yu Qiao<sup id="id2.1.id1" class="ltx_sup">1</sup>, Seong-Bae Park<sup id="id3.2.id2" class="ltx_sup">2</sup>, Sun Moo Kang<sup id="id4.3.id3" class="ltx_sup">2</sup>, and Choong Seon Hong<sup id="id5.4.id4" class="ltx_sup">2</sup>*
<sup id="id6.5.id5" class="ltx_sup">1</sup>
<span id="id7.6.id6" class="ltx_text ltx_font_italic">Department of Artificial Intelligence, Kyung Hee University, Yongin-si 17104, Republic of Korea
<br class="ltx_break"><sup id="id7.6.id6.1" class="ltx_sup"><span id="id7.6.id6.1.1" class="ltx_text ltx_font_upright">2</span></sup></span>
<span id="id8.7.id7" class="ltx_text ltx_font_italic">Department of Computer Science and Engineering, Kyung Hee University, Yongin-si 17104, Republic of Korea
<br class="ltx_break"></span>Email: {qiaoyu, sbpark71, etxkang, cshong}@khu.ac.kr
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id9.id1" class="ltx_p">Federated learning (FL) is a distributed machine learning technique in which multiple clients cooperate to train a shared model without exchanging their raw data. However, heterogeneity of data distribution among clients usually leads to poor model inference. In this paper, a prototype-based federated learning framework is proposed, which can achieve better inference performance with only a few changes to the last global iteration of the typical federated learning process. In the last iteration, the server aggregates the prototypes transmitted from distributed clients and then sends them back to local clients for their respective model inferences. Experiments on two baseline datasets show that our proposal can achieve higher accuracy (at least 1%) and relatively efficient communication than two popular baselines under different heterogeneous settings.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) was first proposed by Google in 2016 and was originally used to address the update issues of Android terminals. Its original motivation is to carry out privacy-preserving Machine Learning (ML) based on datasets distributed on multiple computing nodes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. Essentially, FL is a distributed ML paradigm. With the further development of Artificial Intelligence (AI), the concept of FL has been further refined and developed. The essential feature of federated training is that the data of all parties are kept locally without revealing privacy issues. In addition, the data distribution of clients in federated scenarios is usually heterogeneous. Therefore, the key challenge is revealed: the data distribution among clients is usually not Independent and Identically Distributed (non-IID), which can lead to poor performance in model inferences <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">There are existing various studies trying to tackle the non-IID issue. FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> is the first optimization algorithm for federated scenarios. MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> employs a contrastive loss to minimize the difference between the representations learned by global and local models. FedNova <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> focuses on the aggregation stage. It lets different clients execute different numbers of local epochs in each global iteration, and then normalizes and scales their local updates before aggregating all local updates to ensure that the aggregated global updates have little biases.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, the classifier of the model in the federated settings has a greater bias than other layers. In other words, this means that predictions made through the classifier tend to be highly biased. Therefore, in this paper, we creatively propose to make predictions through the previous layer of the classifier. The output of the previous layer of the classifier is the feature space of the class, and the average of the feature spaces in the same class space can be defined as the ”prototype” of this class. Their work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> has shown that the information of prototypes can be effectively exploited to resolve heterogeneity in FL.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The main contributions are summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We design a novel prototype-based federated learning framework where clients communicate with the server as typical federated training does, but model inferences are made based on the aggregated prototypes instead of the classifier.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a prototype aggregation method, in which clients can upload their prototypes to the server for aggregation before finishing the last federation iteration.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Experiments over two popular benchmark datasets:
MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and Fashion-MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, show that our proposal has a higher test accuracy (at least 1% higher) and is relatively efficient in communication than the two popular baselines.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Proposed Framework</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Problem Statement</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.7" class="ltx_p">Consider a distributed clients set <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\phi</annotation></semantics></math> with private sensitive dataset <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{i}=\{(\boldsymbol{x}_{i},y_{i})\}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mrow id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><msub id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.2.m2.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.3.2.cmml">𝒟</mi><mi id="S2.SS1.p1.2.m2.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.3.3.cmml">i</mi></msub><mo id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S2.SS1.p1.2.m2.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.p1.2.m2.1.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S2.SS1.p1.2.m2.1.1.1.1.1.2.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml">(</mo><msub id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.SS1.p1.2.m2.1.1.1.1.1.2.4" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml">,</mo><msub id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml"><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.2" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.3" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p1.2.m2.1.1.1.1.1.2.5" xref="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S2.SS1.p1.2.m2.1.1.1.1.3" xref="S2.SS1.p1.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><eq id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2"></eq><apply id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.3">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.3.2">𝒟</ci><ci id="S2.SS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3">𝑖</ci></apply><set id="S2.SS1.p1.2.m2.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1"><interval closure="open" id="S2.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2"><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.2.m2.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\mathcal{D}_{i}=\{(\boldsymbol{x}_{i},y_{i})\}</annotation></semantics></math> of size <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">D</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝐷</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">D_{i}</annotation></semantics></math> in the distributed edge network. Following the typical training process of FL, clients and the edge server cooperate to train a shared model <math id="S2.SS1.p1.4.m4.2" class="ltx_Math" alttext="\mathcal{F}(\omega;\boldsymbol{x}_{i})" display="inline"><semantics id="S2.SS1.p1.4.m4.2a"><mrow id="S2.SS1.p1.4.m4.2.2" xref="S2.SS1.p1.4.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.2.2.3" xref="S2.SS1.p1.4.m4.2.2.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.4.m4.2.2.2" xref="S2.SS1.p1.4.m4.2.2.2.cmml">​</mo><mrow id="S2.SS1.p1.4.m4.2.2.1.1" xref="S2.SS1.p1.4.m4.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.4.m4.2.2.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.2.cmml">(</mo><mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">ω</mi><mo id="S2.SS1.p1.4.m4.2.2.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.2.cmml">;</mo><msub id="S2.SS1.p1.4.m4.2.2.1.1.1" xref="S2.SS1.p1.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.2" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.4.m4.2.2.1.1.1.3" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.SS1.p1.4.m4.2.2.1.1.4" xref="S2.SS1.p1.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.2b"><apply id="S2.SS1.p1.4.m4.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2"><times id="S2.SS1.p1.4.m4.2.2.2.cmml" xref="S2.SS1.p1.4.m4.2.2.2"></times><ci id="S2.SS1.p1.4.m4.2.2.3.cmml" xref="S2.SS1.p1.4.m4.2.2.3">ℱ</ci><list id="S2.SS1.p1.4.m4.2.2.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1"><ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">𝜔</ci><apply id="S2.SS1.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.2">𝒙</ci><ci id="S2.SS1.p1.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.4.m4.2.2.1.1.1.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.2c">\mathcal{F}(\omega;\boldsymbol{x}_{i})</annotation></semantics></math>, where <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\omega</annotation></semantics></math> is the model parameters of the global model and <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\boldsymbol{x}_{i}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">𝒙</ci><ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\boldsymbol{x}_{i}</annotation></semantics></math> denotes the feature vector of one client <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">i</annotation></semantics></math>. Our objective is to minimize the loss function across heterogeneous clients as follows:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\mathop{\arg\min}_{\omega}{\mathcal{L}}(\omega)=\sum_{i\in\phi}\frac{D_{i}}{\sum_{i\in\phi}D_{i}}{\mathcal{L}_{i}}(\mathcal{F}(\omega;\boldsymbol{x}_{i}),y_{i})," display="block"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.4" xref="S2.E1.m1.3.3.1.1.4.cmml"><munder id="S2.E1.m1.3.3.1.1.4.1" xref="S2.E1.m1.3.3.1.1.4.1.cmml"><mrow id="S2.E1.m1.3.3.1.1.4.1.2" xref="S2.E1.m1.3.3.1.1.4.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.4.1.2.1" xref="S2.E1.m1.3.3.1.1.4.1.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E1.m1.3.3.1.1.4.1.2a" xref="S2.E1.m1.3.3.1.1.4.1.2.cmml">⁡</mo><mi id="S2.E1.m1.3.3.1.1.4.1.2.2" xref="S2.E1.m1.3.3.1.1.4.1.2.2.cmml">min</mi></mrow><mi id="S2.E1.m1.3.3.1.1.4.1.3" xref="S2.E1.m1.3.3.1.1.4.1.3.cmml">ω</mi></munder><mrow id="S2.E1.m1.3.3.1.1.4.2" xref="S2.E1.m1.3.3.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.4.2.2" xref="S2.E1.m1.3.3.1.1.4.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.4.2.1" xref="S2.E1.m1.3.3.1.1.4.2.1.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.4.2.3.2" xref="S2.E1.m1.3.3.1.1.4.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.4.2.3.2.1" xref="S2.E1.m1.3.3.1.1.4.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">ω</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.4.2.3.2.2" xref="S2.E1.m1.3.3.1.1.4.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.111em" id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml"><munder id="S2.E1.m1.3.3.1.1.2.3" xref="S2.E1.m1.3.3.1.1.2.3.cmml"><mo movablelimits="false" id="S2.E1.m1.3.3.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.2.3.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.2.3.3" xref="S2.E1.m1.3.3.1.1.2.3.3.cmml"><mi id="S2.E1.m1.3.3.1.1.2.3.3.2" xref="S2.E1.m1.3.3.1.1.2.3.3.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.2.3.3.1" xref="S2.E1.m1.3.3.1.1.2.3.3.1.cmml">∈</mo><mi id="S2.E1.m1.3.3.1.1.2.3.3.3" xref="S2.E1.m1.3.3.1.1.2.3.3.3.cmml">ϕ</mi></mrow></munder><mrow id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml"><mfrac id="S2.E1.m1.3.3.1.1.2.2.4" xref="S2.E1.m1.3.3.1.1.2.2.4.cmml"><msub id="S2.E1.m1.3.3.1.1.2.2.4.2" xref="S2.E1.m1.3.3.1.1.2.2.4.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.4.2.2" xref="S2.E1.m1.3.3.1.1.2.2.4.2.2.cmml">D</mi><mi id="S2.E1.m1.3.3.1.1.2.2.4.2.3" xref="S2.E1.m1.3.3.1.1.2.2.4.2.3.cmml">i</mi></msub><mrow id="S2.E1.m1.3.3.1.1.2.2.4.3" xref="S2.E1.m1.3.3.1.1.2.2.4.3.cmml"><msub id="S2.E1.m1.3.3.1.1.2.2.4.3.1" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.cmml"><mo id="S2.E1.m1.3.3.1.1.2.2.4.3.1.2" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.2" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.1" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.1.cmml">∈</mo><mi id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.3" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.3.cmml">ϕ</mi></mrow></msub><msub id="S2.E1.m1.3.3.1.1.2.2.4.3.2" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.4.3.2.2" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.2.cmml">D</mi><mi id="S2.E1.m1.3.3.1.1.2.2.4.3.2.3" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.3.cmml">i</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">​</mo><msub id="S2.E1.m1.3.3.1.1.2.2.5" xref="S2.E1.m1.3.3.1.1.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.2.2.5.2" xref="S2.E1.m1.3.3.1.1.2.2.5.2.cmml">ℒ</mi><mi id="S2.E1.m1.3.3.1.1.2.2.5.3" xref="S2.E1.m1.3.3.1.1.2.2.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.2.2.3a" xref="S2.E1.m1.3.3.1.1.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.2.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.2.3.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">ω</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">;</mo><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.2.2.2.2.4" xref="S2.E1.m1.3.3.1.1.2.2.2.3.cmml">,</mo><msub id="S2.E1.m1.3.3.1.1.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S2.E1.m1.3.3.1.1.2.2.2.2.2.3" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.2.2.2.5" xref="S2.E1.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"></eq><apply id="S2.E1.m1.3.3.1.1.4.cmml" xref="S2.E1.m1.3.3.1.1.4"><apply id="S2.E1.m1.3.3.1.1.4.1.cmml" xref="S2.E1.m1.3.3.1.1.4.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.4.1.1.cmml" xref="S2.E1.m1.3.3.1.1.4.1">subscript</csymbol><apply id="S2.E1.m1.3.3.1.1.4.1.2.cmml" xref="S2.E1.m1.3.3.1.1.4.1.2"><arg id="S2.E1.m1.3.3.1.1.4.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.4.1.2.1"></arg><min id="S2.E1.m1.3.3.1.1.4.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.4.1.2.2"></min></apply><ci id="S2.E1.m1.3.3.1.1.4.1.3.cmml" xref="S2.E1.m1.3.3.1.1.4.1.3">𝜔</ci></apply><apply id="S2.E1.m1.3.3.1.1.4.2.cmml" xref="S2.E1.m1.3.3.1.1.4.2"><times id="S2.E1.m1.3.3.1.1.4.2.1.cmml" xref="S2.E1.m1.3.3.1.1.4.2.1"></times><ci id="S2.E1.m1.3.3.1.1.4.2.2.cmml" xref="S2.E1.m1.3.3.1.1.4.2.2">ℒ</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝜔</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"><apply id="S2.E1.m1.3.3.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3.2"></sum><apply id="S2.E1.m1.3.3.1.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3"><in id="S2.E1.m1.3.3.1.1.2.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3.1"></in><ci id="S2.E1.m1.3.3.1.1.2.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3.2">𝑖</ci><ci id="S2.E1.m1.3.3.1.1.2.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.3.3.3">italic-ϕ</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"><times id="S2.E1.m1.3.3.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.3"></times><apply id="S2.E1.m1.3.3.1.1.2.2.4.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4"><divide id="S2.E1.m1.3.3.1.1.2.2.4.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4"></divide><apply id="S2.E1.m1.3.3.1.1.2.2.4.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.4.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.4.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.2.2">𝐷</ci><ci id="S2.E1.m1.3.3.1.1.2.2.4.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.2.3">𝑖</ci></apply><apply id="S2.E1.m1.3.3.1.1.2.2.4.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3"><apply id="S2.E1.m1.3.3.1.1.2.2.4.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.4.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.2.2.4.3.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.2"></sum><apply id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3"><in id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.1"></in><ci id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.2">𝑖</ci><ci id="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.1.3.3">italic-ϕ</ci></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.4.3.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.4.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.4.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.2">𝐷</ci><ci id="S2.E1.m1.3.3.1.1.2.2.4.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.4.3.2.3">𝑖</ci></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.5.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.5.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.5.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.2">ℒ</ci><ci id="S2.E1.m1.3.3.1.1.2.2.5.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.5.3">𝑖</ci></apply><interval closure="open" id="S2.E1.m1.3.3.1.1.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2"><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1"><times id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.3">ℱ</ci><list id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝜔</ci><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝒙</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply><apply id="S2.E1.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.2">𝑦</ci><ci id="S2.E1.m1.3.3.1.1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\mathop{\arg\min}_{\omega}{\mathcal{L}}(\omega)=\sum_{i\in\phi}\frac{D_{i}}{\sum_{i\in\phi}D_{i}}{\mathcal{L}_{i}}(\mathcal{F}(\omega;\boldsymbol{x}_{i}),y_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.10" class="ltx_p">where <math id="S2.SS1.p1.8.m1.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S2.SS1.p1.8.m1.1a"><msub id="S2.SS1.p1.8.m1.1.1" xref="S2.SS1.p1.8.m1.1.1.cmml"><mi id="S2.SS1.p1.8.m1.1.1.2" xref="S2.SS1.p1.8.m1.1.1.2.cmml">y</mi><mi id="S2.SS1.p1.8.m1.1.1.3" xref="S2.SS1.p1.8.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m1.1b"><apply id="S2.SS1.p1.8.m1.1.1.cmml" xref="S2.SS1.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m1.1.1.1.cmml" xref="S2.SS1.p1.8.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m1.1.1.2.cmml" xref="S2.SS1.p1.8.m1.1.1.2">𝑦</ci><ci id="S2.SS1.p1.8.m1.1.1.3.cmml" xref="S2.SS1.p1.8.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m1.1c">y_{i}</annotation></semantics></math> denotes the label of a sample, and <math id="S2.SS1.p1.9.m2.1" class="ltx_Math" alttext="\mathcal{L}_{i}" display="inline"><semantics id="S2.SS1.p1.9.m2.1a"><msub id="S2.SS1.p1.9.m2.1.1" xref="S2.SS1.p1.9.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.9.m2.1.1.2" xref="S2.SS1.p1.9.m2.1.1.2.cmml">ℒ</mi><mi id="S2.SS1.p1.9.m2.1.1.3" xref="S2.SS1.p1.9.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m2.1b"><apply id="S2.SS1.p1.9.m2.1.1.cmml" xref="S2.SS1.p1.9.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.9.m2.1.1.1.cmml" xref="S2.SS1.p1.9.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.9.m2.1.1.2.cmml" xref="S2.SS1.p1.9.m2.1.1.2">ℒ</ci><ci id="S2.SS1.p1.9.m2.1.1.3.cmml" xref="S2.SS1.p1.9.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m2.1c">\mathcal{L}_{i}</annotation></semantics></math> is the empirical risk (e.g. cross-entropy loss) of client <math id="S2.SS1.p1.10.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS1.p1.10.m3.1a"><mi id="S2.SS1.p1.10.m3.1.1" xref="S2.SS1.p1.10.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m3.1b"><ci id="S2.SS1.p1.10.m3.1.1.cmml" xref="S2.SS1.p1.10.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m3.1c">i</annotation></semantics></math>, respectively.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2303.12296/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="221" height="139" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The overview of the proposed prototype-based FL framework. Note that in previous <math id="S2.F1.4.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.F1.4.m1.1b"><mi id="S2.F1.4.m1.1.1" xref="S2.F1.4.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.F1.4.m1.1c"><ci id="S2.F1.4.m1.1.1.cmml" xref="S2.F1.4.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.4.m1.1d">T</annotation></semantics></math>-1 global rounds, clients only transmit model parameters with the server to train a shared model, which does not illustrate in the figure. We only illustrate the training process in <math id="S2.F1.5.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.F1.5.m2.1b"><mi id="S2.F1.5.m2.1.1" xref="S2.F1.5.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.F1.5.m2.1c"><ci id="S2.F1.5.m2.1.1.cmml" xref="S2.F1.5.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.5.m2.1d">T</annotation></semantics></math>-th global iteration (i.e. the final global iteration.). In the <math id="S2.F1.6.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.F1.6.m3.1b"><mi id="S2.F1.6.m3.1.1" xref="S2.F1.6.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.F1.6.m3.1c"><ci id="S2.F1.6.m3.1.1.cmml" xref="S2.F1.6.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.6.m3.1d">T</annotation></semantics></math>-th round, clients not only transmit their model parameters, but also their prototypes to the server for model aggregation (step. 1 in this figure) and prototype aggregation (step. 2). Finally, the prediction can be made based on the distance of each query to aggregated prototypes (step. 3).</figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Proposed Federated Learning Framework</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">The typical federated training process can be summarized as: (1). The server distributes the model to each client for local training; (2). Clients update the model parameters individually and send them back to the server for aggregation; (3). The server aggregates these uploaded latest model parameters, and then sends them back again to local clients for the next global iteration, repeating the above process until convergence.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Our proposal is similar to this typical process, but in the last global round, clients not only need to update their own local model parameters as usual, but also calculate their own prototypes for each class. The calculated prototypes along with model parameters are sent to the server for aggregation. Finally, the aggregated prototypes and the latest model parameters are then sent back to local clients for model inferences. The overview of our proposed framework is presented in Fig. <a href="#S2.F1" title="Figure 1 ‣ II-A Problem Statement ‣ II Proposed Framework ‣ Prototype Helps Federated Learning: Towards Faster Convergence" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Prototype-based Model Inference Strategy</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.4" class="ltx_p">Generally, a deep learning model consists of two parts: feature extractor layers and decision-making layers. The former is denoted as <math id="S2.SS3.p1.1.m1.2" class="ltx_Math" alttext="f_{e}(\omega_{e};\boldsymbol{x})" display="inline"><semantics id="S2.SS3.p1.1.m1.2a"><mrow id="S2.SS3.p1.1.m1.2.2" xref="S2.SS3.p1.1.m1.2.2.cmml"><msub id="S2.SS3.p1.1.m1.2.2.3" xref="S2.SS3.p1.1.m1.2.2.3.cmml"><mi id="S2.SS3.p1.1.m1.2.2.3.2" xref="S2.SS3.p1.1.m1.2.2.3.2.cmml">f</mi><mi id="S2.SS3.p1.1.m1.2.2.3.3" xref="S2.SS3.p1.1.m1.2.2.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.1.m1.2.2.2" xref="S2.SS3.p1.1.m1.2.2.2.cmml">​</mo><mrow id="S2.SS3.p1.1.m1.2.2.1.1" xref="S2.SS3.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.1.m1.2.2.1.1.2" xref="S2.SS3.p1.1.m1.2.2.1.2.cmml">(</mo><msub id="S2.SS3.p1.1.m1.2.2.1.1.1" xref="S2.SS3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.2" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2.cmml">ω</mi><mi id="S2.SS3.p1.1.m1.2.2.1.1.1.3" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3.cmml">e</mi></msub><mo id="S2.SS3.p1.1.m1.2.2.1.1.3" xref="S2.SS3.p1.1.m1.2.2.1.2.cmml">;</mo><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.SS3.p1.1.m1.2.2.1.1.4" xref="S2.SS3.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.2b"><apply id="S2.SS3.p1.1.m1.2.2.cmml" xref="S2.SS3.p1.1.m1.2.2"><times id="S2.SS3.p1.1.m1.2.2.2.cmml" xref="S2.SS3.p1.1.m1.2.2.2"></times><apply id="S2.SS3.p1.1.m1.2.2.3.cmml" xref="S2.SS3.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.2.2.3.1.cmml" xref="S2.SS3.p1.1.m1.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.1.m1.2.2.3.2.cmml" xref="S2.SS3.p1.1.m1.2.2.3.2">𝑓</ci><ci id="S2.SS3.p1.1.m1.2.2.3.3.cmml" xref="S2.SS3.p1.1.m1.2.2.3.3">𝑒</ci></apply><list id="S2.SS3.p1.1.m1.2.2.1.2.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1"><apply id="S2.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.2">𝜔</ci><ci id="S2.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.2.2.1.1.1.3">𝑒</ci></apply><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝒙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.2c">f_{e}(\omega_{e};\boldsymbol{x})</annotation></semantics></math>, and the latter is denoted as <math id="S2.SS3.p1.2.m2.2" class="ltx_Math" alttext="f_{d}(\omega_{d};y)" display="inline"><semantics id="S2.SS3.p1.2.m2.2a"><mrow id="S2.SS3.p1.2.m2.2.2" xref="S2.SS3.p1.2.m2.2.2.cmml"><msub id="S2.SS3.p1.2.m2.2.2.3" xref="S2.SS3.p1.2.m2.2.2.3.cmml"><mi id="S2.SS3.p1.2.m2.2.2.3.2" xref="S2.SS3.p1.2.m2.2.2.3.2.cmml">f</mi><mi id="S2.SS3.p1.2.m2.2.2.3.3" xref="S2.SS3.p1.2.m2.2.2.3.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.2.m2.2.2.2" xref="S2.SS3.p1.2.m2.2.2.2.cmml">​</mo><mrow id="S2.SS3.p1.2.m2.2.2.1.1" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.2.m2.2.2.1.1.2" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">(</mo><msub id="S2.SS3.p1.2.m2.2.2.1.1.1" xref="S2.SS3.p1.2.m2.2.2.1.1.1.cmml"><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.2" xref="S2.SS3.p1.2.m2.2.2.1.1.1.2.cmml">ω</mi><mi id="S2.SS3.p1.2.m2.2.2.1.1.1.3" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3.cmml">d</mi></msub><mo id="S2.SS3.p1.2.m2.2.2.1.1.3" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">;</mo><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">y</mi><mo stretchy="false" id="S2.SS3.p1.2.m2.2.2.1.1.4" xref="S2.SS3.p1.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.2b"><apply id="S2.SS3.p1.2.m2.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2"><times id="S2.SS3.p1.2.m2.2.2.2.cmml" xref="S2.SS3.p1.2.m2.2.2.2"></times><apply id="S2.SS3.p1.2.m2.2.2.3.cmml" xref="S2.SS3.p1.2.m2.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.2.2.3.1.cmml" xref="S2.SS3.p1.2.m2.2.2.3">subscript</csymbol><ci id="S2.SS3.p1.2.m2.2.2.3.2.cmml" xref="S2.SS3.p1.2.m2.2.2.3.2">𝑓</ci><ci id="S2.SS3.p1.2.m2.2.2.3.3.cmml" xref="S2.SS3.p1.2.m2.2.2.3.3">𝑑</ci></apply><list id="S2.SS3.p1.2.m2.2.2.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1"><apply id="S2.SS3.p1.2.m2.2.2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.2.2.1.1.1.1.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.2">𝜔</ci><ci id="S2.SS3.p1.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS3.p1.2.m2.2.2.1.1.1.3">𝑑</ci></apply><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝑦</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.2c">f_{d}(\omega_{d};y)</annotation></semantics></math>. Therefore, the shared model can be written as <math id="S2.SS3.p1.3.m3.2" class="ltx_Math" alttext="\mathcal{F}(\omega;\boldsymbol{x})" display="inline"><semantics id="S2.SS3.p1.3.m3.2a"><mrow id="S2.SS3.p1.3.m3.2.3" xref="S2.SS3.p1.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.3.m3.2.3.2" xref="S2.SS3.p1.3.m3.2.3.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p1.3.m3.2.3.1" xref="S2.SS3.p1.3.m3.2.3.1.cmml">​</mo><mrow id="S2.SS3.p1.3.m3.2.3.3.2" xref="S2.SS3.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS3.p1.3.m3.2.3.3.2.1" xref="S2.SS3.p1.3.m3.2.3.3.1.cmml">(</mo><mi id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml">ω</mi><mo id="S2.SS3.p1.3.m3.2.3.3.2.2" xref="S2.SS3.p1.3.m3.2.3.3.1.cmml">;</mo><mi id="S2.SS3.p1.3.m3.2.2" xref="S2.SS3.p1.3.m3.2.2.cmml">𝒙</mi><mo stretchy="false" id="S2.SS3.p1.3.m3.2.3.3.2.3" xref="S2.SS3.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.2b"><apply id="S2.SS3.p1.3.m3.2.3.cmml" xref="S2.SS3.p1.3.m3.2.3"><times id="S2.SS3.p1.3.m3.2.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.1"></times><ci id="S2.SS3.p1.3.m3.2.3.2.cmml" xref="S2.SS3.p1.3.m3.2.3.2">ℱ</ci><list id="S2.SS3.p1.3.m3.2.3.3.1.cmml" xref="S2.SS3.p1.3.m3.2.3.3.2"><ci id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">𝜔</ci><ci id="S2.SS3.p1.3.m3.2.2.cmml" xref="S2.SS3.p1.3.m3.2.2">𝒙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.2c">\mathcal{F}(\omega;\boldsymbol{x})</annotation></semantics></math> = <math id="S2.SS3.p1.4.m4.3" class="ltx_Math" alttext="f_{d}(f_{e}(\omega_{e};\boldsymbol{x}),y)" display="inline"><semantics id="S2.SS3.p1.4.m4.3a"><mrow id="S2.SS3.p1.4.m4.3.3" xref="S2.SS3.p1.4.m4.3.3.cmml"><msub id="S2.SS3.p1.4.m4.3.3.3" xref="S2.SS3.p1.4.m4.3.3.3.cmml"><mi id="S2.SS3.p1.4.m4.3.3.3.2" xref="S2.SS3.p1.4.m4.3.3.3.2.cmml">f</mi><mi id="S2.SS3.p1.4.m4.3.3.3.3" xref="S2.SS3.p1.4.m4.3.3.3.3.cmml">d</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.4.m4.3.3.2" xref="S2.SS3.p1.4.m4.3.3.2.cmml">​</mo><mrow id="S2.SS3.p1.4.m4.3.3.1.1" xref="S2.SS3.p1.4.m4.3.3.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.4.m4.3.3.1.1.2" xref="S2.SS3.p1.4.m4.3.3.1.2.cmml">(</mo><mrow id="S2.SS3.p1.4.m4.3.3.1.1.1" xref="S2.SS3.p1.4.m4.3.3.1.1.1.cmml"><msub id="S2.SS3.p1.4.m4.3.3.1.1.1.3" xref="S2.SS3.p1.4.m4.3.3.1.1.1.3.cmml"><mi id="S2.SS3.p1.4.m4.3.3.1.1.1.3.2" xref="S2.SS3.p1.4.m4.3.3.1.1.1.3.2.cmml">f</mi><mi id="S2.SS3.p1.4.m4.3.3.1.1.1.3.3" xref="S2.SS3.p1.4.m4.3.3.1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.p1.4.m4.3.3.1.1.1.2" xref="S2.SS3.p1.4.m4.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.2" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.2.cmml">(</mo><msub id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.cmml"><mi id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.2" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.3" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.3" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.2.cmml">;</mo><mi id="S2.SS3.p1.4.m4.1.1" xref="S2.SS3.p1.4.m4.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.4" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p1.4.m4.3.3.1.1.3" xref="S2.SS3.p1.4.m4.3.3.1.2.cmml">,</mo><mi id="S2.SS3.p1.4.m4.2.2" xref="S2.SS3.p1.4.m4.2.2.cmml">y</mi><mo stretchy="false" id="S2.SS3.p1.4.m4.3.3.1.1.4" xref="S2.SS3.p1.4.m4.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.3b"><apply id="S2.SS3.p1.4.m4.3.3.cmml" xref="S2.SS3.p1.4.m4.3.3"><times id="S2.SS3.p1.4.m4.3.3.2.cmml" xref="S2.SS3.p1.4.m4.3.3.2"></times><apply id="S2.SS3.p1.4.m4.3.3.3.cmml" xref="S2.SS3.p1.4.m4.3.3.3"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.3.3.3.1.cmml" xref="S2.SS3.p1.4.m4.3.3.3">subscript</csymbol><ci id="S2.SS3.p1.4.m4.3.3.3.2.cmml" xref="S2.SS3.p1.4.m4.3.3.3.2">𝑓</ci><ci id="S2.SS3.p1.4.m4.3.3.3.3.cmml" xref="S2.SS3.p1.4.m4.3.3.3.3">𝑑</ci></apply><interval closure="open" id="S2.SS3.p1.4.m4.3.3.1.2.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1"><apply id="S2.SS3.p1.4.m4.3.3.1.1.1.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1"><times id="S2.SS3.p1.4.m4.3.3.1.1.1.2.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.2"></times><apply id="S2.SS3.p1.4.m4.3.3.1.1.1.3.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.3.3.1.1.1.3.1.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.3">subscript</csymbol><ci id="S2.SS3.p1.4.m4.3.3.1.1.1.3.2.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.3.2">𝑓</ci><ci id="S2.SS3.p1.4.m4.3.3.1.1.1.3.3.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.3.3">𝑒</ci></apply><list id="S2.SS3.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.1"><apply id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.1.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.2.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.3.cmml" xref="S2.SS3.p1.4.m4.3.3.1.1.1.1.1.1.3">𝑒</ci></apply><ci id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">𝒙</ci></list></apply><ci id="S2.SS3.p1.4.m4.2.2.cmml" xref="S2.SS3.p1.4.m4.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.3c">f_{d}(f_{e}(\omega_{e};\boldsymbol{x}),y)</annotation></semantics></math>, which means that the output of feature extractor layers acts as the input of the decision-making layers.</p>
</div>
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.2" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.2.2" class="ltx_listingline">






















































<div id="alg1.2.2.2" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>     
</div>
<div id="alg1.2.2.2.2" class="ltx_listingline">Dataset <math id="alg1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="alg1.1.1.1.1.m1.1a"><msub id="alg1.1.1.1.1.m1.1.1" xref="alg1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.1.1.1.1.m1.1.1.2" xref="alg1.1.1.1.1.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.1.1.1.1.m1.1.1.3" xref="alg1.1.1.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.1.m1.1b"><apply id="alg1.1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="alg1.1.1.1.1.m1.1.1.2.cmml" xref="alg1.1.1.1.1.m1.1.1.2">𝒟</ci><ci id="alg1.1.1.1.1.m1.1.1.3.cmml" xref="alg1.1.1.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.1.m1.1c">\mathcal{D}_{i}</annotation></semantics></math>, <math id="alg1.2.2.2.2.m2.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="alg1.2.2.2.2.m2.1a"><msub id="alg1.2.2.2.2.m2.1.1" xref="alg1.2.2.2.2.m2.1.1.cmml"><mi id="alg1.2.2.2.2.m2.1.1.2" xref="alg1.2.2.2.2.m2.1.1.2.cmml">ω</mi><mi id="alg1.2.2.2.2.m2.1.1.3" xref="alg1.2.2.2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.2.m2.1b"><apply id="alg1.2.2.2.2.m2.1.1.cmml" xref="alg1.2.2.2.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m2.1.1.1.cmml" xref="alg1.2.2.2.2.m2.1.1">subscript</csymbol><ci id="alg1.2.2.2.2.m2.1.1.2.cmml" xref="alg1.2.2.2.2.m2.1.1.2">𝜔</ci><ci id="alg1.2.2.2.2.m2.1.1.3.cmml" xref="alg1.2.2.2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.2.m2.1c">\omega_{i}</annotation></semantics></math>

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Model Training:</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.2.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Initialize <math id="alg1.l2.1.m1.1" class="ltx_Math" alttext="\omega^{0}" display="inline"><semantics id="alg1.l2.1.m1.1a"><msup id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml"><mi id="alg1.l2.1.m1.1.1.2" xref="alg1.l2.1.m1.1.1.2.cmml">ω</mi><mn id="alg1.l2.1.m1.1.1.3" xref="alg1.l2.1.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><apply id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.1.m1.1.1.1.cmml" xref="alg1.l2.1.m1.1.1">superscript</csymbol><ci id="alg1.l2.1.m1.1.1.2.cmml" xref="alg1.l2.1.m1.1.1.2">𝜔</ci><cn type="integer" id="alg1.l2.1.m1.1.1.3.cmml" xref="alg1.l2.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">\omega^{0}</annotation></semantics></math></span>, <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\{\overline{y}\}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.2.2" xref="alg1.l2.m1.1.2.1.cmml"><mo stretchy="false" id="alg1.l2.m1.1.2.2.1" xref="alg1.l2.m1.1.2.1.cmml">{</mo><mover accent="true" id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">y</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="alg1.l2.m1.1.2.2.2" xref="alg1.l2.m1.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><set id="alg1.l2.m1.1.2.1.cmml" xref="alg1.l2.m1.1.2.2"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">¯</ci><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑦</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\{\overline{y}\}</annotation></semantics></math>.

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span>  <math id="alg1.l3.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l3.m1.1a"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">t</annotation></semantics></math> = 1, 2, …, <math id="alg1.l3.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">T</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span>  <math id="alg1.l4.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i</annotation></semantics></math> = 0, 1,…, <math id="alg1.l4.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">N</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg1.l4.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        <span id="alg1.l5.2" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l5.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">t</annotation></semantics></math> = <math id="alg1.l5.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l5.m2.1a"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">T</annotation></semantics></math> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>           Local model updates.

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>           Prototypes aggregation by Eq. (<a href="#S2.E3" title="In II-C2 Global Prototype Aggregation ‣ II-C Prototype-based Model Inference Strategy ‣ II Proposed Framework ‣ Prototype Helps Federated Learning: Towards Faster Convergence" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>        <span id="alg1.l8.2" class="ltx_text ltx_font_bold">else</span> <span id="alg1.l8.3" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l8.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">t</annotation></semantics></math> &lt;<math id="alg1.l8.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">T</annotation></semantics></math> <span id="alg1.l8.4" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>           Local model updates.

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>        <span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>  <span id="alg1.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>  <span id="alg1.l13.2" class="ltx_text ltx_font_bold">Model Testing:</span>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>  <span id="alg1.l14.2" class="ltx_text ltx_font_bold">for</span>  each sample <math id="alg1.l14.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l14.m1.1a"><mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">i</annotation></semantics></math> in testing dataset <span id="alg1.l14.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     <span id="alg1.l15.2" class="ltx_text ltx_font_bold">for</span>  each class <math id="alg1.l15.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="alg1.l15.m1.1a"><mi id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><ci id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">j</annotation></semantics></math> in <math id="alg1.l15.m2.1" class="ltx_Math" alttext="\{\overline{y}\}" display="inline"><semantics id="alg1.l15.m2.1a"><mrow id="alg1.l15.m2.1.2.2" xref="alg1.l15.m2.1.2.1.cmml"><mo stretchy="false" id="alg1.l15.m2.1.2.2.1" xref="alg1.l15.m2.1.2.1.cmml">{</mo><mover accent="true" id="alg1.l15.m2.1.1" xref="alg1.l15.m2.1.1.cmml"><mi id="alg1.l15.m2.1.1.2" xref="alg1.l15.m2.1.1.2.cmml">y</mi><mo id="alg1.l15.m2.1.1.1" xref="alg1.l15.m2.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="alg1.l15.m2.1.2.2.2" xref="alg1.l15.m2.1.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m2.1b"><set id="alg1.l15.m2.1.2.1.cmml" xref="alg1.l15.m2.1.2.2"><apply id="alg1.l15.m2.1.1.cmml" xref="alg1.l15.m2.1.1"><ci id="alg1.l15.m2.1.1.1.cmml" xref="alg1.l15.m2.1.1.1">¯</ci><ci id="alg1.l15.m2.1.1.2.cmml" xref="alg1.l15.m2.1.1.2">𝑦</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m2.1c">\{\overline{y}\}</annotation></semantics></math> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>        Measure L2 distance between <math id="alg1.l16.m1.2" class="ltx_Math" alttext="f_{e}(\omega_{e};\boldsymbol{x}_{i})" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml"><msub id="alg1.l16.m1.2.2.4" xref="alg1.l16.m1.2.2.4.cmml"><mi id="alg1.l16.m1.2.2.4.2" xref="alg1.l16.m1.2.2.4.2.cmml">f</mi><mi id="alg1.l16.m1.2.2.4.3" xref="alg1.l16.m1.2.2.4.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.2.3" xref="alg1.l16.m1.2.2.3.cmml">​</mo><mrow id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l16.m1.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.3.cmml">(</mo><msub id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.2.cmml">ω</mi><mi id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="alg1.l16.m1.2.2.2.2.4" xref="alg1.l16.m1.2.2.2.3.cmml">;</mo><msub id="alg1.l16.m1.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.cmml"><mi id="alg1.l16.m1.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.2.cmml">𝒙</mi><mi id="alg1.l16.m1.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l16.m1.2.2.2.2.5" xref="alg1.l16.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2"><times id="alg1.l16.m1.2.2.3.cmml" xref="alg1.l16.m1.2.2.3"></times><apply id="alg1.l16.m1.2.2.4.cmml" xref="alg1.l16.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.4.1.cmml" xref="alg1.l16.m1.2.2.4">subscript</csymbol><ci id="alg1.l16.m1.2.2.4.2.cmml" xref="alg1.l16.m1.2.2.4.2">𝑓</ci><ci id="alg1.l16.m1.2.2.4.3.cmml" xref="alg1.l16.m1.2.2.4.3">𝑒</ci></apply><list id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2"><apply id="alg1.l16.m1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.2">𝜔</ci><ci id="alg1.l16.m1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3">𝑒</ci></apply><apply id="alg1.l16.m1.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2">𝒙</ci><ci id="alg1.l16.m1.2.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.2.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">f_{e}(\omega_{e};\boldsymbol{x}_{i})</annotation></semantics></math>
and <math id="alg1.l16.m2.1" class="ltx_Math" alttext="\overline{y}_{j}" display="inline"><semantics id="alg1.l16.m2.1a"><msub id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml"><mover accent="true" id="alg1.l16.m2.1.1.2" xref="alg1.l16.m2.1.1.2.cmml"><mi id="alg1.l16.m2.1.1.2.2" xref="alg1.l16.m2.1.1.2.2.cmml">y</mi><mo id="alg1.l16.m2.1.1.2.1" xref="alg1.l16.m2.1.1.2.1.cmml">¯</mo></mover><mi id="alg1.l16.m2.1.1.3" xref="alg1.l16.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.1b"><apply id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.1.1.1.cmml" xref="alg1.l16.m2.1.1">subscript</csymbol><apply id="alg1.l16.m2.1.1.2.cmml" xref="alg1.l16.m2.1.1.2"><ci id="alg1.l16.m2.1.1.2.1.cmml" xref="alg1.l16.m2.1.1.2.1">¯</ci><ci id="alg1.l16.m2.1.1.2.2.cmml" xref="alg1.l16.m2.1.1.2.2">𝑦</ci></apply><ci id="alg1.l16.m2.1.1.3.cmml" xref="alg1.l16.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.1c">\overline{y}_{j}</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>     <span id="alg1.l17.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l17.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>     Make final predictions by Eq. (<a href="#S2.E4" title="In II-C3 Prototype-based Model Inference ‣ II-C Prototype-based Model Inference Strategy ‣ II Proposed Framework ‣ Prototype Helps Federated Learning: Towards Faster Convergence" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>)

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>  <span id="alg1.l19.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Prototype-based FL (ProtoFed)</figcaption>
</figure>
<section id="S2.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS3.SSS1.4.1.1" class="ltx_text">II-C</span>1 </span>Prototype Calculation</h4>

<div id="S2.SS3.SSS1.p1" class="ltx_para">
<p id="S2.SS3.SSS1.p1.2" class="ltx_p">Following the definition for prototypes given by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, the prototype representing <math id="S2.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS3.SSS1.p1.1.m1.1a"><mi id="S2.SS3.SSS1.p1.1.m1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.1.m1.1b"><ci id="S2.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.1.m1.1c">j</annotation></semantics></math>-th class of client <math id="S2.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.SSS1.p1.2.m2.1a"><mi id="S2.SS3.SSS1.p1.2.m2.1.1" xref="S2.SS3.SSS1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.2.m2.1b"><ci id="S2.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.2.m2.1c">i</annotation></semantics></math>-th can be formulated as:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.10" class="ltx_Math" alttext="\widetilde{y}_{i,j}=\frac{1}{D_{i,j}}\sum_{(x,y)\in\mathcal{D}_{i,j}}f_{e}(\omega_{e};\boldsymbol{x})," display="block"><semantics id="S2.E2.m1.10a"><mrow id="S2.E2.m1.10.10.1" xref="S2.E2.m1.10.10.1.1.cmml"><mrow id="S2.E2.m1.10.10.1.1" xref="S2.E2.m1.10.10.1.1.cmml"><msub id="S2.E2.m1.10.10.1.1.3" xref="S2.E2.m1.10.10.1.1.3.cmml"><mover accent="true" id="S2.E2.m1.10.10.1.1.3.2" xref="S2.E2.m1.10.10.1.1.3.2.cmml"><mi id="S2.E2.m1.10.10.1.1.3.2.2" xref="S2.E2.m1.10.10.1.1.3.2.2.cmml">y</mi><mo id="S2.E2.m1.10.10.1.1.3.2.1" xref="S2.E2.m1.10.10.1.1.3.2.1.cmml">~</mo></mover><mrow id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">i</mi><mo id="S2.E2.m1.2.2.2.4.1" xref="S2.E2.m1.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S2.E2.m1.10.10.1.1.2" xref="S2.E2.m1.10.10.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.10.10.1.1.1" xref="S2.E2.m1.10.10.1.1.1.cmml"><mfrac id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml"><mn id="S2.E2.m1.4.4.4" xref="S2.E2.m1.4.4.4.cmml">1</mn><msub id="S2.E2.m1.4.4.2" xref="S2.E2.m1.4.4.2.cmml"><mi id="S2.E2.m1.4.4.2.4" xref="S2.E2.m1.4.4.2.4.cmml">D</mi><mrow id="S2.E2.m1.4.4.2.2.2.4" xref="S2.E2.m1.4.4.2.2.2.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.cmml">i</mi><mo id="S2.E2.m1.4.4.2.2.2.4.1" xref="S2.E2.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.4.4.2.2.2.2" xref="S2.E2.m1.4.4.2.2.2.2.cmml">j</mi></mrow></msub></mfrac><mo lspace="0em" rspace="0em" id="S2.E2.m1.10.10.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.10.10.1.1.1.1" xref="S2.E2.m1.10.10.1.1.1.1.cmml"><munder id="S2.E2.m1.10.10.1.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E2.m1.10.10.1.1.1.1.2.2" xref="S2.E2.m1.10.10.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.8.8.4" xref="S2.E2.m1.8.8.4.cmml"><mrow id="S2.E2.m1.8.8.4.6.2" xref="S2.E2.m1.8.8.4.6.1.cmml"><mo stretchy="false" id="S2.E2.m1.8.8.4.6.2.1" xref="S2.E2.m1.8.8.4.6.1.cmml">(</mo><mi id="S2.E2.m1.7.7.3.3" xref="S2.E2.m1.7.7.3.3.cmml">x</mi><mo id="S2.E2.m1.8.8.4.6.2.2" xref="S2.E2.m1.8.8.4.6.1.cmml">,</mo><mi id="S2.E2.m1.8.8.4.4" xref="S2.E2.m1.8.8.4.4.cmml">y</mi><mo stretchy="false" id="S2.E2.m1.8.8.4.6.2.3" xref="S2.E2.m1.8.8.4.6.1.cmml">)</mo></mrow><mo id="S2.E2.m1.8.8.4.5" xref="S2.E2.m1.8.8.4.5.cmml">∈</mo><msub id="S2.E2.m1.8.8.4.7" xref="S2.E2.m1.8.8.4.7.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.8.8.4.7.2" xref="S2.E2.m1.8.8.4.7.2.cmml">𝒟</mi><mrow id="S2.E2.m1.6.6.2.2.2.4" xref="S2.E2.m1.6.6.2.2.2.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml">i</mi><mo id="S2.E2.m1.6.6.2.2.2.4.1" xref="S2.E2.m1.6.6.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.6.6.2.2.2.2" xref="S2.E2.m1.6.6.2.2.2.2.cmml">j</mi></mrow></msub></mrow></munder><mrow id="S2.E2.m1.10.10.1.1.1.1.1" xref="S2.E2.m1.10.10.1.1.1.1.1.cmml"><msub id="S2.E2.m1.10.10.1.1.1.1.1.3" xref="S2.E2.m1.10.10.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.10.10.1.1.1.1.1.3.2" xref="S2.E2.m1.10.10.1.1.1.1.1.3.2.cmml">f</mi><mi id="S2.E2.m1.10.10.1.1.1.1.1.3.3" xref="S2.E2.m1.10.10.1.1.1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.10.10.1.1.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.10.10.1.1.1.1.1.1.1" xref="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.10.10.1.1.1.1.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.E2.m1.10.10.1.1.1.1.1.1.1.3" xref="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E2.m1.9.9" xref="S2.E2.m1.9.9.cmml">𝒙</mi><mo stretchy="false" id="S2.E2.m1.10.10.1.1.1.1.1.1.1.4" xref="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.10.10.1.2" xref="S2.E2.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.10b"><apply id="S2.E2.m1.10.10.1.1.cmml" xref="S2.E2.m1.10.10.1"><eq id="S2.E2.m1.10.10.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.2"></eq><apply id="S2.E2.m1.10.10.1.1.3.cmml" xref="S2.E2.m1.10.10.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.10.10.1.1.3.1.cmml" xref="S2.E2.m1.10.10.1.1.3">subscript</csymbol><apply id="S2.E2.m1.10.10.1.1.3.2.cmml" xref="S2.E2.m1.10.10.1.1.3.2"><ci id="S2.E2.m1.10.10.1.1.3.2.1.cmml" xref="S2.E2.m1.10.10.1.1.3.2.1">~</ci><ci id="S2.E2.m1.10.10.1.1.3.2.2.cmml" xref="S2.E2.m1.10.10.1.1.3.2.2">𝑦</ci></apply><list id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.4"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑖</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S2.E2.m1.10.10.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1"><times id="S2.E2.m1.10.10.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.2"></times><apply id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4"><divide id="S2.E2.m1.4.4.3.cmml" xref="S2.E2.m1.4.4"></divide><cn type="integer" id="S2.E2.m1.4.4.4.cmml" xref="S2.E2.m1.4.4.4">1</cn><apply id="S2.E2.m1.4.4.2.cmml" xref="S2.E2.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.2.3.cmml" xref="S2.E2.m1.4.4.2">subscript</csymbol><ci id="S2.E2.m1.4.4.2.4.cmml" xref="S2.E2.m1.4.4.2.4">𝐷</ci><list id="S2.E2.m1.4.4.2.2.2.3.cmml" xref="S2.E2.m1.4.4.2.2.2.4"><ci id="S2.E2.m1.3.3.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1">𝑖</ci><ci id="S2.E2.m1.4.4.2.2.2.2.cmml" xref="S2.E2.m1.4.4.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S2.E2.m1.10.10.1.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1"><apply id="S2.E2.m1.10.10.1.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.10.10.1.1.1.1.2.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.10.10.1.1.1.1.2.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.2.2"></sum><apply id="S2.E2.m1.8.8.4.cmml" xref="S2.E2.m1.8.8.4"><in id="S2.E2.m1.8.8.4.5.cmml" xref="S2.E2.m1.8.8.4.5"></in><interval closure="open" id="S2.E2.m1.8.8.4.6.1.cmml" xref="S2.E2.m1.8.8.4.6.2"><ci id="S2.E2.m1.7.7.3.3.cmml" xref="S2.E2.m1.7.7.3.3">𝑥</ci><ci id="S2.E2.m1.8.8.4.4.cmml" xref="S2.E2.m1.8.8.4.4">𝑦</ci></interval><apply id="S2.E2.m1.8.8.4.7.cmml" xref="S2.E2.m1.8.8.4.7"><csymbol cd="ambiguous" id="S2.E2.m1.8.8.4.7.1.cmml" xref="S2.E2.m1.8.8.4.7">subscript</csymbol><ci id="S2.E2.m1.8.8.4.7.2.cmml" xref="S2.E2.m1.8.8.4.7.2">𝒟</ci><list id="S2.E2.m1.6.6.2.2.2.3.cmml" xref="S2.E2.m1.6.6.2.2.2.4"><ci id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1">𝑖</ci><ci id="S2.E2.m1.6.6.2.2.2.2.cmml" xref="S2.E2.m1.6.6.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="S2.E2.m1.10.10.1.1.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1"><times id="S2.E2.m1.10.10.1.1.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.2"></times><apply id="S2.E2.m1.10.10.1.1.1.1.1.3.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.10.10.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.10.10.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E2.m1.10.10.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.3.3">𝑒</ci></apply><list id="S2.E2.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1"><apply id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.10.10.1.1.1.1.1.1.1.1.3">𝑒</ci></apply><ci id="S2.E2.m1.9.9.cmml" xref="S2.E2.m1.9.9">𝒙</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.10c">\widetilde{y}_{i,j}=\frac{1}{D_{i,j}}\sum_{(x,y)\in\mathcal{D}_{i,j}}f_{e}(\omega_{e};\boldsymbol{x}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.SSS1.p1.7" class="ltx_p">where <math id="S2.SS3.SSS1.p1.3.m1.2" class="ltx_Math" alttext="\mathcal{D}_{i,j}" display="inline"><semantics id="S2.SS3.SSS1.p1.3.m1.2a"><msub id="S2.SS3.SSS1.p1.3.m1.2.3" xref="S2.SS3.SSS1.p1.3.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS1.p1.3.m1.2.3.2" xref="S2.SS3.SSS1.p1.3.m1.2.3.2.cmml">𝒟</mi><mrow id="S2.SS3.SSS1.p1.3.m1.2.2.2.4" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.3.cmml"><mi id="S2.SS3.SSS1.p1.3.m1.1.1.1.1" xref="S2.SS3.SSS1.p1.3.m1.1.1.1.1.cmml">i</mi><mo id="S2.SS3.SSS1.p1.3.m1.2.2.2.4.1" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS3.SSS1.p1.3.m1.2.2.2.2" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.3.m1.2b"><apply id="S2.SS3.SSS1.p1.3.m1.2.3.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.3.m1.2.3.1.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.3.m1.2.3.2.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.3.2">𝒟</ci><list id="S2.SS3.SSS1.p1.3.m1.2.2.2.3.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.4"><ci id="S2.SS3.SSS1.p1.3.m1.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.3.m1.1.1.1.1">𝑖</ci><ci id="S2.SS3.SSS1.p1.3.m1.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.3.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.3.m1.2c">\mathcal{D}_{i,j}</annotation></semantics></math> is the distribution of client <math id="S2.SS3.SSS1.p1.4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.SSS1.p1.4.m2.1a"><mi id="S2.SS3.SSS1.p1.4.m2.1.1" xref="S2.SS3.SSS1.p1.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.4.m2.1b"><ci id="S2.SS3.SSS1.p1.4.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.4.m2.1c">i</annotation></semantics></math>-th belong to the <math id="S2.SS3.SSS1.p1.5.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS3.SSS1.p1.5.m3.1a"><mi id="S2.SS3.SSS1.p1.5.m3.1.1" xref="S2.SS3.SSS1.p1.5.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.5.m3.1b"><ci id="S2.SS3.SSS1.p1.5.m3.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.5.m3.1c">j</annotation></semantics></math>-th class, and <math id="S2.SS3.SSS1.p1.6.m4.2" class="ltx_Math" alttext="D_{i,j}" display="inline"><semantics id="S2.SS3.SSS1.p1.6.m4.2a"><msub id="S2.SS3.SSS1.p1.6.m4.2.3" xref="S2.SS3.SSS1.p1.6.m4.2.3.cmml"><mi id="S2.SS3.SSS1.p1.6.m4.2.3.2" xref="S2.SS3.SSS1.p1.6.m4.2.3.2.cmml">D</mi><mrow id="S2.SS3.SSS1.p1.6.m4.2.2.2.4" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.3.cmml"><mi id="S2.SS3.SSS1.p1.6.m4.1.1.1.1" xref="S2.SS3.SSS1.p1.6.m4.1.1.1.1.cmml">i</mi><mo id="S2.SS3.SSS1.p1.6.m4.2.2.2.4.1" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.3.cmml">,</mo><mi id="S2.SS3.SSS1.p1.6.m4.2.2.2.2" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.6.m4.2b"><apply id="S2.SS3.SSS1.p1.6.m4.2.3.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.6.m4.2.3.1.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.6.m4.2.3.2.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.3.2">𝐷</ci><list id="S2.SS3.SSS1.p1.6.m4.2.2.2.3.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.4"><ci id="S2.SS3.SSS1.p1.6.m4.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.6.m4.1.1.1.1">𝑖</ci><ci id="S2.SS3.SSS1.p1.6.m4.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.6.m4.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.6.m4.2c">D_{i,j}</annotation></semantics></math> is the size for <math id="S2.SS3.SSS1.p1.7.m5.2" class="ltx_Math" alttext="\mathcal{D}_{i,j}" display="inline"><semantics id="S2.SS3.SSS1.p1.7.m5.2a"><msub id="S2.SS3.SSS1.p1.7.m5.2.3" xref="S2.SS3.SSS1.p1.7.m5.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.SSS1.p1.7.m5.2.3.2" xref="S2.SS3.SSS1.p1.7.m5.2.3.2.cmml">𝒟</mi><mrow id="S2.SS3.SSS1.p1.7.m5.2.2.2.4" xref="S2.SS3.SSS1.p1.7.m5.2.2.2.3.cmml"><mi id="S2.SS3.SSS1.p1.7.m5.1.1.1.1" xref="S2.SS3.SSS1.p1.7.m5.1.1.1.1.cmml">i</mi><mo id="S2.SS3.SSS1.p1.7.m5.2.2.2.4.1" xref="S2.SS3.SSS1.p1.7.m5.2.2.2.3.cmml">,</mo><mi id="S2.SS3.SSS1.p1.7.m5.2.2.2.2" xref="S2.SS3.SSS1.p1.7.m5.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.7.m5.2b"><apply id="S2.SS3.SSS1.p1.7.m5.2.3.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.7.m5.2.3.1.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.7.m5.2.3.2.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.3.2">𝒟</ci><list id="S2.SS3.SSS1.p1.7.m5.2.2.2.3.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.2.4"><ci id="S2.SS3.SSS1.p1.7.m5.1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.7.m5.1.1.1.1">𝑖</ci><ci id="S2.SS3.SSS1.p1.7.m5.2.2.2.2.cmml" xref="S2.SS3.SSS1.p1.7.m5.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.7.m5.2c">\mathcal{D}_{i,j}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S2.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS3.SSS2.4.1.1" class="ltx_text">II-C</span>2 </span>Global Prototype Aggregation</h4>

<div id="S2.SS3.SSS2.p1" class="ltx_para">
<p id="S2.SS3.SSS2.p1.3" class="ltx_p">As calculated by Eq. <a href="#S2.E2" title="In II-C1 Prototype Calculation ‣ II-C Prototype-based Model Inference Strategy ‣ II Proposed Framework ‣ Prototype Helps Federated Learning: Towards Faster Convergence" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, these computed prototypes can be sent to the server for aggregation, which can be defined as follows:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.4" class="ltx_Math" alttext="\overline{y}_{j}=\frac{1}{|\phi|}\sum_{i\in\phi}\widetilde{y}_{i,j}," display="block"><semantics id="S2.E3.m1.4a"><mrow id="S2.E3.m1.4.4.1" xref="S2.E3.m1.4.4.1.1.cmml"><mrow id="S2.E3.m1.4.4.1.1" xref="S2.E3.m1.4.4.1.1.cmml"><msub id="S2.E3.m1.4.4.1.1.2" xref="S2.E3.m1.4.4.1.1.2.cmml"><mover accent="true" id="S2.E3.m1.4.4.1.1.2.2" xref="S2.E3.m1.4.4.1.1.2.2.cmml"><mi id="S2.E3.m1.4.4.1.1.2.2.2" xref="S2.E3.m1.4.4.1.1.2.2.2.cmml">y</mi><mo id="S2.E3.m1.4.4.1.1.2.2.1" xref="S2.E3.m1.4.4.1.1.2.2.1.cmml">¯</mo></mover><mi id="S2.E3.m1.4.4.1.1.2.3" xref="S2.E3.m1.4.4.1.1.2.3.cmml">j</mi></msub><mo id="S2.E3.m1.4.4.1.1.1" xref="S2.E3.m1.4.4.1.1.1.cmml">=</mo><mrow id="S2.E3.m1.4.4.1.1.3" xref="S2.E3.m1.4.4.1.1.3.cmml"><mfrac id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mn id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">1</mn><mrow id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.2.1.cmml">|</mo><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">ϕ</mi><mo stretchy="false" id="S2.E3.m1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E3.m1.4.4.1.1.3.1" xref="S2.E3.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S2.E3.m1.4.4.1.1.3.2" xref="S2.E3.m1.4.4.1.1.3.2.cmml"><munder id="S2.E3.m1.4.4.1.1.3.2.1" xref="S2.E3.m1.4.4.1.1.3.2.1.cmml"><mo movablelimits="false" id="S2.E3.m1.4.4.1.1.3.2.1.2" xref="S2.E3.m1.4.4.1.1.3.2.1.2.cmml">∑</mo><mrow id="S2.E3.m1.4.4.1.1.3.2.1.3" xref="S2.E3.m1.4.4.1.1.3.2.1.3.cmml"><mi id="S2.E3.m1.4.4.1.1.3.2.1.3.2" xref="S2.E3.m1.4.4.1.1.3.2.1.3.2.cmml">i</mi><mo id="S2.E3.m1.4.4.1.1.3.2.1.3.1" xref="S2.E3.m1.4.4.1.1.3.2.1.3.1.cmml">∈</mo><mi id="S2.E3.m1.4.4.1.1.3.2.1.3.3" xref="S2.E3.m1.4.4.1.1.3.2.1.3.3.cmml">ϕ</mi></mrow></munder><msub id="S2.E3.m1.4.4.1.1.3.2.2" xref="S2.E3.m1.4.4.1.1.3.2.2.cmml"><mover accent="true" id="S2.E3.m1.4.4.1.1.3.2.2.2" xref="S2.E3.m1.4.4.1.1.3.2.2.2.cmml"><mi id="S2.E3.m1.4.4.1.1.3.2.2.2.2" xref="S2.E3.m1.4.4.1.1.3.2.2.2.2.cmml">y</mi><mo id="S2.E3.m1.4.4.1.1.3.2.2.2.1" xref="S2.E3.m1.4.4.1.1.3.2.2.2.1.cmml">~</mo></mover><mrow id="S2.E3.m1.3.3.2.4" xref="S2.E3.m1.3.3.2.3.cmml"><mi id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml">i</mi><mo id="S2.E3.m1.3.3.2.4.1" xref="S2.E3.m1.3.3.2.3.cmml">,</mo><mi id="S2.E3.m1.3.3.2.2" xref="S2.E3.m1.3.3.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S2.E3.m1.4.4.1.2" xref="S2.E3.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.4b"><apply id="S2.E3.m1.4.4.1.1.cmml" xref="S2.E3.m1.4.4.1"><eq id="S2.E3.m1.4.4.1.1.1.cmml" xref="S2.E3.m1.4.4.1.1.1"></eq><apply id="S2.E3.m1.4.4.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.2">subscript</csymbol><apply id="S2.E3.m1.4.4.1.1.2.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2"><ci id="S2.E3.m1.4.4.1.1.2.2.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2.1">¯</ci><ci id="S2.E3.m1.4.4.1.1.2.2.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2.2">𝑦</ci></apply><ci id="S2.E3.m1.4.4.1.1.2.3.cmml" xref="S2.E3.m1.4.4.1.1.2.3">𝑗</ci></apply><apply id="S2.E3.m1.4.4.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.3"><times id="S2.E3.m1.4.4.1.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.3.1"></times><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><divide id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1"></divide><cn type="integer" id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">1</cn><apply id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.3"><abs id="S2.E3.m1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.3.1"></abs><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">italic-ϕ</ci></apply></apply><apply id="S2.E3.m1.4.4.1.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.3.2"><apply id="S2.E3.m1.4.4.1.1.3.2.1.cmml" xref="S2.E3.m1.4.4.1.1.3.2.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.3.2.1.1.cmml" xref="S2.E3.m1.4.4.1.1.3.2.1">subscript</csymbol><sum id="S2.E3.m1.4.4.1.1.3.2.1.2.cmml" xref="S2.E3.m1.4.4.1.1.3.2.1.2"></sum><apply id="S2.E3.m1.4.4.1.1.3.2.1.3.cmml" xref="S2.E3.m1.4.4.1.1.3.2.1.3"><in id="S2.E3.m1.4.4.1.1.3.2.1.3.1.cmml" xref="S2.E3.m1.4.4.1.1.3.2.1.3.1"></in><ci id="S2.E3.m1.4.4.1.1.3.2.1.3.2.cmml" xref="S2.E3.m1.4.4.1.1.3.2.1.3.2">𝑖</ci><ci id="S2.E3.m1.4.4.1.1.3.2.1.3.3.cmml" xref="S2.E3.m1.4.4.1.1.3.2.1.3.3">italic-ϕ</ci></apply></apply><apply id="S2.E3.m1.4.4.1.1.3.2.2.cmml" xref="S2.E3.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.3.2.2.1.cmml" xref="S2.E3.m1.4.4.1.1.3.2.2">subscript</csymbol><apply id="S2.E3.m1.4.4.1.1.3.2.2.2.cmml" xref="S2.E3.m1.4.4.1.1.3.2.2.2"><ci id="S2.E3.m1.4.4.1.1.3.2.2.2.1.cmml" xref="S2.E3.m1.4.4.1.1.3.2.2.2.1">~</ci><ci id="S2.E3.m1.4.4.1.1.3.2.2.2.2.cmml" xref="S2.E3.m1.4.4.1.1.3.2.2.2.2">𝑦</ci></apply><list id="S2.E3.m1.3.3.2.3.cmml" xref="S2.E3.m1.3.3.2.4"><ci id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1.1">𝑖</ci><ci id="S2.E3.m1.3.3.2.2.cmml" xref="S2.E3.m1.3.3.2.2">𝑗</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.4c">\overline{y}_{j}=\frac{1}{|\phi|}\sum_{i\in\phi}\widetilde{y}_{i,j},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.SSS2.p1.2" class="ltx_p">where <math id="S2.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="|\phi|" display="inline"><semantics id="S2.SS3.SSS2.p1.1.m1.1a"><mrow id="S2.SS3.SSS2.p1.1.m1.1.2.2" xref="S2.SS3.SSS2.p1.1.m1.1.2.1.cmml"><mo stretchy="false" id="S2.SS3.SSS2.p1.1.m1.1.2.2.1" xref="S2.SS3.SSS2.p1.1.m1.1.2.1.1.cmml">|</mo><mi id="S2.SS3.SSS2.p1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.cmml">ϕ</mi><mo stretchy="false" id="S2.SS3.SSS2.p1.1.m1.1.2.2.2" xref="S2.SS3.SSS2.p1.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.m1.1b"><apply id="S2.SS3.SSS2.p1.1.m1.1.2.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.2.2"><abs id="S2.SS3.SSS2.p1.1.m1.1.2.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.2.2.1"></abs><ci id="S2.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.m1.1c">|\phi|</annotation></semantics></math> is the number of clients in the network. This Equation means to average the prototypes from those clients with <math id="S2.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.SS3.SSS2.p1.2.m2.1a"><mi id="S2.SS3.SSS2.p1.2.m2.1.1" xref="S2.SS3.SSS2.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.2.m2.1b"><ci id="S2.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.2.m2.1c">j</annotation></semantics></math>-th class as global prototypes.</p>
</div>
</section>
<section id="S2.SS3.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS3.SSS3.4.1.1" class="ltx_text">II-C</span>3 </span>Prototype-based Model Inference</h4>

<div id="S2.SS3.SSS3.p1" class="ltx_para">
<p id="S2.SS3.SSS3.p1.2" class="ltx_p">The results of Eq.<a href="#S2.E3" title="In II-C2 Global Prototype Aggregation ‣ II-C Prototype-based Model Inference Strategy ‣ II Proposed Framework ‣ Prototype Helps Federated Learning: Towards Faster Convergence" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> can be viewed as a global representation of each class for model inference. Therefore, the prediction can be made by measuring the L2 distance between the local prototype <math id="S2.SS3.SSS3.p1.1.m1.2" class="ltx_Math" alttext="f_{e}(\omega_{e};\boldsymbol{x})" display="inline"><semantics id="S2.SS3.SSS3.p1.1.m1.2a"><mrow id="S2.SS3.SSS3.p1.1.m1.2.2" xref="S2.SS3.SSS3.p1.1.m1.2.2.cmml"><msub id="S2.SS3.SSS3.p1.1.m1.2.2.3" xref="S2.SS3.SSS3.p1.1.m1.2.2.3.cmml"><mi id="S2.SS3.SSS3.p1.1.m1.2.2.3.2" xref="S2.SS3.SSS3.p1.1.m1.2.2.3.2.cmml">f</mi><mi id="S2.SS3.SSS3.p1.1.m1.2.2.3.3" xref="S2.SS3.SSS3.p1.1.m1.2.2.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS3.SSS3.p1.1.m1.2.2.2" xref="S2.SS3.SSS3.p1.1.m1.2.2.2.cmml">​</mo><mrow id="S2.SS3.SSS3.p1.1.m1.2.2.1.1" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.2" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.2.cmml">(</mo><msub id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.2" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.2.cmml">ω</mi><mi id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.3" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.3.cmml">e</mi></msub><mo id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.3" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.2.cmml">;</mo><mi id="S2.SS3.SSS3.p1.1.m1.1.1" xref="S2.SS3.SSS3.p1.1.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.4" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.1.m1.2b"><apply id="S2.SS3.SSS3.p1.1.m1.2.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2"><times id="S2.SS3.SSS3.p1.1.m1.2.2.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.2"></times><apply id="S2.SS3.SSS3.p1.1.m1.2.2.3.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.3"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.1.m1.2.2.3.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.3">subscript</csymbol><ci id="S2.SS3.SSS3.p1.1.m1.2.2.3.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.3.2">𝑓</ci><ci id="S2.SS3.SSS3.p1.1.m1.2.2.3.3.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.3.3">𝑒</ci></apply><list id="S2.SS3.SSS3.p1.1.m1.2.2.1.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.1"><apply id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.2">𝜔</ci><ci id="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS3.SSS3.p1.1.m1.2.2.1.1.1.3">𝑒</ci></apply><ci id="S2.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.1.m1.1.1">𝒙</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.1.m1.2c">f_{e}(\omega_{e};\boldsymbol{x})</annotation></semantics></math> and the global representation prototypes <math id="S2.SS3.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\overline{y}_{j}" display="inline"><semantics id="S2.SS3.SSS3.p1.2.m2.1a"><msub id="S2.SS3.SSS3.p1.2.m2.1.1" xref="S2.SS3.SSS3.p1.2.m2.1.1.cmml"><mover accent="true" id="S2.SS3.SSS3.p1.2.m2.1.1.2" xref="S2.SS3.SSS3.p1.2.m2.1.1.2.cmml"><mi id="S2.SS3.SSS3.p1.2.m2.1.1.2.2" xref="S2.SS3.SSS3.p1.2.m2.1.1.2.2.cmml">y</mi><mo id="S2.SS3.SSS3.p1.2.m2.1.1.2.1" xref="S2.SS3.SSS3.p1.2.m2.1.1.2.1.cmml">¯</mo></mover><mi id="S2.SS3.SSS3.p1.2.m2.1.1.3" xref="S2.SS3.SSS3.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.2.m2.1b"><apply id="S2.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1">subscript</csymbol><apply id="S2.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.2"><ci id="S2.SS3.SSS3.p1.2.m2.1.1.2.1.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.2.1">¯</ci><ci id="S2.SS3.SSS3.p1.2.m2.1.1.2.2.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.2.2">𝑦</ci></apply><ci id="S2.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.SSS3.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.2.m2.1c">\overline{y}_{j}</annotation></semantics></math>, which can be expressed as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>:</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.2" class="ltx_Math" alttext="\hat{y}=\mathop{\arg\min}_{j}\|f_{e}(\omega_{e};\boldsymbol{x})-\overline{y}_{j}\|_{2}," display="block"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><mover accent="true" id="S2.E4.m1.2.2.1.1.3" xref="S2.E4.m1.2.2.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.3.2" xref="S2.E4.m1.2.2.1.1.3.2.cmml">y</mi><mo id="S2.E4.m1.2.2.1.1.3.1" xref="S2.E4.m1.2.2.1.1.3.1.cmml">^</mo></mover><mo id="S2.E4.m1.2.2.1.1.2" xref="S2.E4.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><munder id="S2.E4.m1.2.2.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.2.cmml"><mrow id="S2.E4.m1.2.2.1.1.1.2.2" xref="S2.E4.m1.2.2.1.1.1.2.2.cmml"><mi id="S2.E4.m1.2.2.1.1.1.2.2.1" xref="S2.E4.m1.2.2.1.1.1.2.2.1.cmml">arg</mi><mo lspace="0.167em" id="S2.E4.m1.2.2.1.1.1.2.2a" xref="S2.E4.m1.2.2.1.1.1.2.2.cmml">⁡</mo><mi id="S2.E4.m1.2.2.1.1.1.2.2.2" xref="S2.E4.m1.2.2.1.1.1.2.2.2.cmml">min</mi></mrow><mi id="S2.E4.m1.2.2.1.1.1.2.3" xref="S2.E4.m1.2.2.1.1.1.2.3.cmml">j</mi></munder><msub id="S2.E4.m1.2.2.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">e</mi></msub><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">ω</mi><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">;</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">𝒙</mi><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.4" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml">−</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.2" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S2.E4.m1.2.2.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E4.m1.2.2.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.3.cmml">2</mn></msub></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" xref="S2.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><eq id="S2.E4.m1.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2"></eq><apply id="S2.E4.m1.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.3"><ci id="S2.E4.m1.2.2.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.3.1">^</ci><ci id="S2.E4.m1.2.2.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.3.2">𝑦</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><apply id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.2">subscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2.2"><arg id="S2.E4.m1.2.2.1.1.1.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.2.2.1"></arg><min id="S2.E4.m1.2.2.1.1.1.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2.2.2"></min></apply><ci id="S2.E4.m1.2.2.1.1.1.2.3.cmml" xref="S2.E4.m1.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E4.m1.2.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1">subscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1"><minus id="S2.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.2"></minus><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑒</ci></apply><list id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">𝜔</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑒</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝒙</ci></list></apply><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2"><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.1">¯</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="S2.E4.m1.2.2.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\hat{y}=\mathop{\arg\min}_{j}\|f_{e}(\omega_{e};\boldsymbol{x})-\overline{y}_{j}\|_{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.SSS3.p1.3" class="ltx_p">where the final predicted label is denoted as <math id="S2.SS3.SSS3.p1.3.m1.1" class="ltx_Math" alttext="\hat{y}" display="inline"><semantics id="S2.SS3.SSS3.p1.3.m1.1a"><mover accent="true" id="S2.SS3.SSS3.p1.3.m1.1.1" xref="S2.SS3.SSS3.p1.3.m1.1.1.cmml"><mi id="S2.SS3.SSS3.p1.3.m1.1.1.2" xref="S2.SS3.SSS3.p1.3.m1.1.1.2.cmml">y</mi><mo id="S2.SS3.SSS3.p1.3.m1.1.1.1" xref="S2.SS3.SSS3.p1.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS3.p1.3.m1.1b"><apply id="S2.SS3.SSS3.p1.3.m1.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m1.1.1"><ci id="S2.SS3.SSS3.p1.3.m1.1.1.1.cmml" xref="S2.SS3.SSS3.p1.3.m1.1.1.1">^</ci><ci id="S2.SS3.SSS3.p1.3.m1.1.1.2.cmml" xref="S2.SS3.SSS3.p1.3.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS3.p1.3.m1.1c">\hat{y}</annotation></semantics></math>. Further details about prototype-based federated learning are shown in Algorithm.1.</p>
</div>
<figure id="S2.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.12296/assets/x2.png" id="S2.F2.sf1.g1" class="ltx_graphics ltx_img_square" width="128" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.sf1.4.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><math id="S2.F2.sf1.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.F2.sf1.2.m1.1b"><mi mathsize="80%" id="S2.F2.sf1.2.m1.1.1" xref="S2.F2.sf1.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.F2.sf1.2.m1.1c"><ci id="S2.F2.sf1.2.m1.1.1.cmml" xref="S2.F2.sf1.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf1.2.m1.1d">\alpha</annotation></semantics></math><span id="S2.F2.sf1.5.2" class="ltx_text" style="font-size:80%;"> = 0.05</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.12296/assets/x3.png" id="S2.F2.sf2.g1" class="ltx_graphics ltx_img_square" width="128" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.sf2.4.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><math id="S2.F2.sf2.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.F2.sf2.2.m1.1b"><mi mathsize="80%" id="S2.F2.sf2.2.m1.1.1" xref="S2.F2.sf2.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.F2.sf2.2.m1.1c"><ci id="S2.F2.sf2.2.m1.1.1.cmml" xref="S2.F2.sf2.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.sf2.2.m1.1d">\alpha</annotation></semantics></math><span id="S2.F2.sf2.5.2" class="ltx_text" style="font-size:80%;"> = 0.1</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The top-1 average test accuracy of all methods on MNIST in different communication rounds with the degree of skewness <math id="S2.F2.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.F2.3.m1.1b"><mi id="S2.F2.3.m1.1.1" xref="S2.F2.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.F2.3.m1.1c"><ci id="S2.F2.3.m1.1.1.cmml" xref="S2.F2.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.3.m1.1d">\alpha</annotation></semantics></math> = 0.05 and <math id="S2.F2.4.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.F2.4.m2.1b"><mi id="S2.F2.4.m2.1.1" xref="S2.F2.4.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.F2.4.m2.1c"><ci id="S2.F2.4.m2.1.1.cmml" xref="S2.F2.4.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.4.m2.1d">\alpha</annotation></semantics></math> = 0.1.</figcaption>
</figure>
<figure id="S2.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.12296/assets/x4.png" id="S2.F3.sf1.g1" class="ltx_graphics ltx_img_square" width="128" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.sf1.4.1.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><math id="S2.F3.sf1.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.F3.sf1.2.m1.1b"><mi mathsize="80%" id="S2.F3.sf1.2.m1.1.1" xref="S2.F3.sf1.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.F3.sf1.2.m1.1c"><ci id="S2.F3.sf1.2.m1.1.1.cmml" xref="S2.F3.sf1.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.sf1.2.m1.1d">\alpha</annotation></semantics></math><span id="S2.F3.sf1.5.2" class="ltx_text" style="font-size:80%;"> = 0.05</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S2.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.12296/assets/x5.png" id="S2.F3.sf2.g1" class="ltx_graphics ltx_img_square" width="128" height="121" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.sf2.4.1.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><math id="S2.F3.sf2.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.F3.sf2.2.m1.1b"><mi mathsize="80%" id="S2.F3.sf2.2.m1.1.1" xref="S2.F3.sf2.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.F3.sf2.2.m1.1c"><ci id="S2.F3.sf2.2.m1.1.1.cmml" xref="S2.F3.sf2.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.sf2.2.m1.1d">\alpha</annotation></semantics></math><span id="S2.F3.sf2.5.2" class="ltx_text" style="font-size:80%;"> = 0.1</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>The top-1 average test accuracy of all methods on Fashion-MNIST in different communication rounds with the degree of skewness <math id="S2.F3.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.F3.3.m1.1b"><mi id="S2.F3.3.m1.1.1" xref="S2.F3.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.F3.3.m1.1c"><ci id="S2.F3.3.m1.1.1.cmml" xref="S2.F3.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.3.m1.1d">\alpha</annotation></semantics></math> = 0.05 and <math id="S2.F3.4.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.F3.4.m2.1b"><mi id="S2.F3.4.m2.1.1" xref="S2.F3.4.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.F3.4.m2.1c"><ci id="S2.F3.4.m2.1.1.cmml" xref="S2.F3.4.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F3.4.m2.1d">\alpha</annotation></semantics></math> = 0.1.</figcaption>
</figure>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Dataset and Local Model</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We use MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and Fashion-MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> as benchmarks for comparison. MNIST is a handwritten digit recognition dataset with 10 digits and an image size of 28x28x1. Fashion-MNIST is more complex than MNIST, covering a total of 70,000 images of different items in 10 categories and an image size of 28x28x1. We use a 4-layer CNN network with 2 convolutional layers and 2 fully connected layers for MNIST and Fashion-MNIST, similar networks are also adopted in their work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Implementation Details</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.5" class="ltx_p">We use 20 clients for all experiments, and the default training parameters for the MNIST and Fashion-MNIST datasets are set to <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">B</annotation></semantics></math> = 8, <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">E</annotation></semantics></math> = 1, <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\eta</annotation></semantics></math> = 0.01, representing the local batch size, local epochs, and learning rate, respectively. We sample 5000 samples from the training dataset and distribute them to all clients to mimic the situation where training samples are limited in the real-world <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Further, we adopt the Dirichlet distribution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> to simulate the heterogeneous setting among clients, which can be expressed as Dir(<math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\alpha</annotation></semantics></math>), where the smaller <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\alpha</annotation></semantics></math>, the more unbalanced the data distribution among clients is.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Accuracy and Communication Efficiency Comparison</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We compare our proposal with two popular baselines <span id="S3.SS3.p1.1.1" class="ltx_text ltx_font_typewriter">Local</span> and <span id="S3.SS3.p1.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span> under different heterogeneities, where <span id="S3.SS3.p1.1.3" class="ltx_text ltx_font_typewriter">Local</span> indicates that clients train their own model individually without any communication with the server or other clients, and <span id="S3.SS3.p1.1.4" class="ltx_text ltx_font_typewriter">FedAvg</span> as the first federated algorithm is the most popular baseline. Note that we perform prototype-based model inference in each round during training in order to compare their test accuracies after each global iteration.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">The accuracy and communication efficiency for comparison of all methods on MNIST and Fashion-MNIST are shown in Fig.<a href="#S2.F2" title="Figure 2 ‣ II-C3 Prototype-based Model Inference ‣ II-C Prototype-based Model Inference Strategy ‣ II Proposed Framework ‣ Prototype Helps Federated Learning: Towards Faster Convergence" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Fig.<a href="#S2.F3" title="Figure 3 ‣ II-C3 Prototype-based Model Inference ‣ II-C Prototype-based Model Inference Strategy ‣ II Proposed Framework ‣ Prototype Helps Federated Learning: Towards Faster Convergence" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, respectively. It appears that our prototype-based model inference strategy achieves higher test accuracy and a relatively faster convergence rate in each global communication round than other methods under different heterogeneous settings on both these two datasets.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.4" class="ltx_p">To be more specific, our proposal on MNIST outperforms <span id="S3.SS3.p3.4.1" class="ltx_text ltx_font_typewriter">Local</span> and <span id="S3.SS3.p3.4.2" class="ltx_text ltx_font_typewriter">FedAvg</span> by 18.9% and 2.4% in terms of accuracy when <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\alpha</annotation></semantics></math> = 0.05, and also outperforms them by 31.5% and 1.0% when <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">\alpha</annotation></semantics></math> = 0.05, respectively. Further, our proposal on Fashion-MNIST outperforms <span id="S3.SS3.p3.4.3" class="ltx_text ltx_font_typewriter">Local</span> and <span id="S3.SS3.p3.4.4" class="ltx_text ltx_font_typewriter">FedAvg</span> by 1.4% and 14.3% in terms of accuracy when <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\alpha</annotation></semantics></math> = 0.05, and also outperforms them by 18.4% and 7.4% when <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\alpha</annotation></semantics></math> = 0.1, respectively.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this paper, a prototype-based federated learning framework is proposed, which can help boost the performance of model inference. We first present the prototype calculation method, and then we introduce the prototype aggregation approach. Finally, we propose the prototype-based model inference strategy. Experiments show that our strategy can improve the accuracy by at least 1% on MNIST and Fashion-MNIST compared to two popular baselines <span id="S4.p1.1.1" class="ltx_text ltx_font_typewriter">Local</span> and <span id="S4.p1.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span>, and can achieve relatively efficient communication. For future works, our proposal has the potential to be combined with other state-of-the-art methods and tests on more datasets.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"> McMahan B, Moore E, Ramage D, et al. “Communication-efficient learning of deep networks from decentralized data,“ <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pp. 1273-1282, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"> Kevin Hsieh, Amar Phanishayee, Onur Mutlu, and Phillip Gibbons. “The non-iid data quagmire of decentralized machine learning,“ <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pp. 4387–4398, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"> Li, Q., B. He, D. Song. “Model-contrastive federated learning,“ <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition</span>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"> J. Wang, Q. Liu, H. Liang, G. Joshi, and H. V. Poor. “Tackling the objective inconsistency problem in heterogeneous federated optimization,“ <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, vol. 33, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"> Luo M, Chen F, Hu D, et al. “No fear of heterogeneity: Classifier calibration for federated learning with non-iid data,“ <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, vol. 34, pp. 5972-5984, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"> Tan Y, Long G, Liu L, et al. “Fedproto: Federated prototype learning across heterogeneous clients,“ <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">AAAI Conference on Artificial Intelligence</span>, vol. 1. no. 3, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"> LeCun, Yann, et al. “Gradient-based learning applied to document recognition,“ Proceedings of the IEEE, vol. 86, no.11, pp. 2278-2324, 1998.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"> Xiao, Han, Kashif Rasul, and Roland Vollgraf. “Fashion-mnist: a novel image dataset for benchmarking machine learning algorithms,“ arXiv preprint arXiv:1708.07747, 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"> Yurochkin M, Agarwal M, Ghosh S, et al. “Bayesian nonparametric federated learning of neural networks,” <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pp: 7252-7261, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">Qiao, Yu, et al. ”A Framework for Multi-Prototype Based Federated Learning: Towards the Edge Intelligence.” 2023 International Conference on Information Networking. IEEE, 2023.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">Qiao, Yu and Munir, Md Shirajum, et al. ”CDFed: Contribution-based Dynamic Federated Learning for Managing System and Statistical Heterogeneity.” IEEE/IFIP Network Operations and Management Symposium, 2023.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.12295" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.12296" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.12296">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.12296" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.12297" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 19:07:54 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
