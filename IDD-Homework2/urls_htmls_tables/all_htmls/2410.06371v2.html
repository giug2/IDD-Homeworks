<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling</title>
<!--Generated on Thu Oct 10 19:47:39 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="negative item sampling,  item recommendation,  implicit feedback" lang="en" name="keywords"/>
<base href="/html/2410.06371v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S1" title="In Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S2" title="In Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S3" title="In Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Problem Setting</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S3.SS1" title="In 3. Problem Setting ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Rank Dependent Losses</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S3.SS2" title="In 3. Problem Setting ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>WARP and LambdaRank</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S4" title="In Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Batch Training with Negative Sampling</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S4.SS1" title="In 4. Batch Training with Negative Sampling ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Estimation of Rank</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S4.SS2" title="In 4. Batch Training with Negative Sampling ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Discussion</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5" title="In Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5.SS1" title="In 5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5.SS2" title="In 5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5.SS2.SSS1" title="In 5.2. Results ‣ 5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.1 </span>Batch Training with Negative Sampling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5.SS2.SSS2" title="In 5.2. Results ‣ 5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.2 </span>Effect of Sample Sizes</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5.SS2.SSS3" title="In 5.2. Results ‣ 5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2.3 </span>Effect of Evaluation Threshold</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S6" title="In Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Anushya Subbiah
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0009-6005-6050" title="ORCID identifier">0009-0009-6005-6050</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Google Research</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Mountain View</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:anushyas@google.com">anushyas@google.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Steffen Rendle
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0004-6389-2509" title="ORCID identifier">0009-0004-6389-2509</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Google Research</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Mountain View</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:srendle@google.com">srendle@google.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Vikram Aggarwal
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a class="ltx_ref" href="https://orcid.org/0009-0004-1750-6806" title="ORCID identifier">0009-0004-1750-6806</a></span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Google Research</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Mountain View</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">USA</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:viki@google.com">viki@google.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024; 3 June 2024; 16 July 2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id10.id1">In recommendation systems, there has been a growth in the number of recommendable items (# of movies, music, products).
When the set of recommendable items is large, training and evaluation of item recommendation models becomes computationally expensive.
To lower this cost, it has become common to sample negative items.
However, the recommendation quality can suffer from biases introduced by traditional negative sampling mechanisms.</p>
<p class="ltx_p" id="id11.id2">In this work, we demonstrate the benefits from correcting the bias introduced by sampling of negatives.
We first provide sampled batch version of the well-studied WARP and LambdaRank methods.
Then, we present how these methods can benefit from improved ranking estimates.
Finally, we evaluate the recommendation quality as a result of correcting rank estimates and demonstrate that WARP and LambdaRank can be learned efficiently with negative sampling and our proposed correction technique.</p>
</div>
<div class="ltx_keywords">negative item sampling, item recommendation, implicit feedback
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 33rd ACM International
Conference on Information and Knowledge Management; October 21–25,
2024; Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 33rd ACM International Conference on
Information and Knowledge Management (CIKM ’24), October 21–25, 2024,
Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3627673.3679943</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0436-9/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Personalization</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recommendation systems are critical at navigating the vast item space in contemporary products.
Item recommenders select the most promising items for a user based on the user’s past interactions and present the items as a ranked list.
The data to train such systems is typically <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">implicit feedback</em> in the form of past positive interactions (e.g., listen or watch events, clicks, etc.) <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib14" title="">2022</a>)</cite>.
Training an item recommender from implicit feedback is computationally challenging since the learning algorithm needs to distinguish the <em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">positive</em> items from the full catalog of all items.
Sampling negative items during training has become a standard practice to lower the costs.
Instead of comparing the positive/ relevant items to all items, they compare the relevant items to a smaller subsets of sampled items.
A key challenge in negative sampling arises from the bias that it introduces into the loss functions.
Item recommendation models are typically trained for loss functions that try to move relevant items to the top of the list.
For example, <em class="ltx_emph ltx_font_italic" id="S1.p1.1.3">LambdaRank</em> <cite class="ltx_cite ltx_citemacro_citep">(Burges, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib5" title="">2010</a>)</cite> suggests to weight a pair of positive and negative items by the difference in their rank, and <em class="ltx_emph ltx_font_italic" id="S1.p1.1.4">Weighted Approximate-Rank Pairwise loss</em> <cite class="ltx_cite ltx_citemacro_citep">(Weston
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib18" title="">2011</a>)</cite> (WARP) weights based on the rank of the positive item.
However, a subsample of items provides only limited information about where the relevant item ranks in the full catalog.
In this work, we study how the rank of an item can be more reliably estimated on a subset of items and how this information can be used for training item recommenders with negative sampling.
Our work is inspired by recent work on evaluating recommender systems with sampled metrics <cite class="ltx_cite ltx_citemacro_citep">(Krichene and
Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib11" title="">2020</a>)</cite> where evaluation metrics are computed on a sample of negative items.
We apply their proposed method for estimating the rank within a sample to learning item recommendation models from sampled negatives and study the effect of these methods in LambdaRank and WARP.</p>
</div>
<figure class="ltx_table" id="S1.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S1.T1.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S1.T1.9.10.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S1.T1.9.10.1.1">Symbol</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S1.T1.9.10.1.2">Description</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S1.T1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S1.T1.1.1.1"><math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S1.T1.1.1.1.m1.1"><semantics id="S1.T1.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S1.T1.1.1.1.m1.1.1" xref="S1.T1.1.1.1.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S1.T1.1.1.1.m1.1b"><ci id="S1.T1.1.1.1.m1.1.1.cmml" xref="S1.T1.1.1.1.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.1.1.1.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.1.1.1.m1.1d">caligraphic_I</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S1.T1.1.1.2">catalog of all items</td>
</tr>
<tr class="ltx_tr" id="S1.T1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S1.T1.2.2.1"><math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S1.T1.2.2.1.m1.1"><semantics id="S1.T1.2.2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S1.T1.2.2.1.m1.1.1" xref="S1.T1.2.2.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S1.T1.2.2.1.m1.1b"><ci id="S1.T1.2.2.1.m1.1.1.cmml" xref="S1.T1.2.2.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.2.2.1.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.2.2.1.m1.1d">caligraphic_C</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S1.T1.2.2.2">recommendation context (e.g., a user)</td>
</tr>
<tr class="ltx_tr" id="S1.T1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S1.T1.3.3.1"><math alttext="\mathcal{S}\subset\mathcal{C}\times\mathcal{I}" class="ltx_Math" display="inline" id="S1.T1.3.3.1.m1.1"><semantics id="S1.T1.3.3.1.m1.1a"><mrow id="S1.T1.3.3.1.m1.1.1" xref="S1.T1.3.3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.T1.3.3.1.m1.1.1.2" xref="S1.T1.3.3.1.m1.1.1.2.cmml">𝒮</mi><mo id="S1.T1.3.3.1.m1.1.1.1" xref="S1.T1.3.3.1.m1.1.1.1.cmml">⊂</mo><mrow id="S1.T1.3.3.1.m1.1.1.3" xref="S1.T1.3.3.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.T1.3.3.1.m1.1.1.3.2" xref="S1.T1.3.3.1.m1.1.1.3.2.cmml">𝒞</mi><mo id="S1.T1.3.3.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S1.T1.3.3.1.m1.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S1.T1.3.3.1.m1.1.1.3.3" xref="S1.T1.3.3.1.m1.1.1.3.3.cmml">ℐ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.3.3.1.m1.1b"><apply id="S1.T1.3.3.1.m1.1.1.cmml" xref="S1.T1.3.3.1.m1.1.1"><subset id="S1.T1.3.3.1.m1.1.1.1.cmml" xref="S1.T1.3.3.1.m1.1.1.1"></subset><ci id="S1.T1.3.3.1.m1.1.1.2.cmml" xref="S1.T1.3.3.1.m1.1.1.2">𝒮</ci><apply id="S1.T1.3.3.1.m1.1.1.3.cmml" xref="S1.T1.3.3.1.m1.1.1.3"><times id="S1.T1.3.3.1.m1.1.1.3.1.cmml" xref="S1.T1.3.3.1.m1.1.1.3.1"></times><ci id="S1.T1.3.3.1.m1.1.1.3.2.cmml" xref="S1.T1.3.3.1.m1.1.1.3.2">𝒞</ci><ci id="S1.T1.3.3.1.m1.1.1.3.3.cmml" xref="S1.T1.3.3.1.m1.1.1.3.3">ℐ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.3.3.1.m1.1c">\mathcal{S}\subset\mathcal{C}\times\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.3.3.1.m1.1d">caligraphic_S ⊂ caligraphic_C × caligraphic_I</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S1.T1.3.3.2">set of training examples</td>
</tr>
<tr class="ltx_tr" id="S1.T1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S1.T1.4.4.1"><math alttext="y:\mathcal{I}\times\mathcal{C}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S1.T1.4.4.1.m1.1"><semantics id="S1.T1.4.4.1.m1.1a"><mrow id="S1.T1.4.4.1.m1.1.1" xref="S1.T1.4.4.1.m1.1.1.cmml"><mi id="S1.T1.4.4.1.m1.1.1.2" xref="S1.T1.4.4.1.m1.1.1.2.cmml">y</mi><mo id="S1.T1.4.4.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S1.T1.4.4.1.m1.1.1.1.cmml">:</mo><mrow id="S1.T1.4.4.1.m1.1.1.3" xref="S1.T1.4.4.1.m1.1.1.3.cmml"><mrow id="S1.T1.4.4.1.m1.1.1.3.2" xref="S1.T1.4.4.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.T1.4.4.1.m1.1.1.3.2.2" xref="S1.T1.4.4.1.m1.1.1.3.2.2.cmml">ℐ</mi><mo id="S1.T1.4.4.1.m1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S1.T1.4.4.1.m1.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S1.T1.4.4.1.m1.1.1.3.2.3" xref="S1.T1.4.4.1.m1.1.1.3.2.3.cmml">𝒞</mi></mrow><mo id="S1.T1.4.4.1.m1.1.1.3.1" stretchy="false" xref="S1.T1.4.4.1.m1.1.1.3.1.cmml">→</mo><mi id="S1.T1.4.4.1.m1.1.1.3.3" xref="S1.T1.4.4.1.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.4.4.1.m1.1b"><apply id="S1.T1.4.4.1.m1.1.1.cmml" xref="S1.T1.4.4.1.m1.1.1"><ci id="S1.T1.4.4.1.m1.1.1.1.cmml" xref="S1.T1.4.4.1.m1.1.1.1">:</ci><ci id="S1.T1.4.4.1.m1.1.1.2.cmml" xref="S1.T1.4.4.1.m1.1.1.2">𝑦</ci><apply id="S1.T1.4.4.1.m1.1.1.3.cmml" xref="S1.T1.4.4.1.m1.1.1.3"><ci id="S1.T1.4.4.1.m1.1.1.3.1.cmml" xref="S1.T1.4.4.1.m1.1.1.3.1">→</ci><apply id="S1.T1.4.4.1.m1.1.1.3.2.cmml" xref="S1.T1.4.4.1.m1.1.1.3.2"><times id="S1.T1.4.4.1.m1.1.1.3.2.1.cmml" xref="S1.T1.4.4.1.m1.1.1.3.2.1"></times><ci id="S1.T1.4.4.1.m1.1.1.3.2.2.cmml" xref="S1.T1.4.4.1.m1.1.1.3.2.2">ℐ</ci><ci id="S1.T1.4.4.1.m1.1.1.3.2.3.cmml" xref="S1.T1.4.4.1.m1.1.1.3.2.3">𝒞</ci></apply><ci id="S1.T1.4.4.1.m1.1.1.3.3.cmml" xref="S1.T1.4.4.1.m1.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.4.4.1.m1.1c">y:\mathcal{I}\times\mathcal{C}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.4.4.1.m1.1d">italic_y : caligraphic_I × caligraphic_C → blackboard_R</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S1.T1.4.4.2">scoring function</td>
</tr>
<tr class="ltx_tr" id="S1.T1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S1.T1.5.5.1"><math alttext="r:\mathcal{I}\times\mathcal{C}\rightarrow\{1,\ldots,|\mathcal{I}|\}" class="ltx_Math" display="inline" id="S1.T1.5.5.1.m1.4"><semantics id="S1.T1.5.5.1.m1.4a"><mrow id="S1.T1.5.5.1.m1.4.4" xref="S1.T1.5.5.1.m1.4.4.cmml"><mi id="S1.T1.5.5.1.m1.4.4.3" xref="S1.T1.5.5.1.m1.4.4.3.cmml">r</mi><mo id="S1.T1.5.5.1.m1.4.4.2" lspace="0.278em" rspace="0.278em" xref="S1.T1.5.5.1.m1.4.4.2.cmml">:</mo><mrow id="S1.T1.5.5.1.m1.4.4.1" xref="S1.T1.5.5.1.m1.4.4.1.cmml"><mrow id="S1.T1.5.5.1.m1.4.4.1.3" xref="S1.T1.5.5.1.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.T1.5.5.1.m1.4.4.1.3.2" xref="S1.T1.5.5.1.m1.4.4.1.3.2.cmml">ℐ</mi><mo id="S1.T1.5.5.1.m1.4.4.1.3.1" lspace="0.222em" rspace="0.222em" xref="S1.T1.5.5.1.m1.4.4.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S1.T1.5.5.1.m1.4.4.1.3.3" xref="S1.T1.5.5.1.m1.4.4.1.3.3.cmml">𝒞</mi></mrow><mo id="S1.T1.5.5.1.m1.4.4.1.2" stretchy="false" xref="S1.T1.5.5.1.m1.4.4.1.2.cmml">→</mo><mrow id="S1.T1.5.5.1.m1.4.4.1.1.1" xref="S1.T1.5.5.1.m1.4.4.1.1.2.cmml"><mo id="S1.T1.5.5.1.m1.4.4.1.1.1.2" stretchy="false" xref="S1.T1.5.5.1.m1.4.4.1.1.2.cmml">{</mo><mn id="S1.T1.5.5.1.m1.1.1" xref="S1.T1.5.5.1.m1.1.1.cmml">1</mn><mo id="S1.T1.5.5.1.m1.4.4.1.1.1.3" xref="S1.T1.5.5.1.m1.4.4.1.1.2.cmml">,</mo><mi id="S1.T1.5.5.1.m1.2.2" mathvariant="normal" xref="S1.T1.5.5.1.m1.2.2.cmml">…</mi><mo id="S1.T1.5.5.1.m1.4.4.1.1.1.4" xref="S1.T1.5.5.1.m1.4.4.1.1.2.cmml">,</mo><mrow id="S1.T1.5.5.1.m1.4.4.1.1.1.1.2" xref="S1.T1.5.5.1.m1.4.4.1.1.1.1.1.cmml"><mo id="S1.T1.5.5.1.m1.4.4.1.1.1.1.2.1" stretchy="false" xref="S1.T1.5.5.1.m1.4.4.1.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S1.T1.5.5.1.m1.3.3" xref="S1.T1.5.5.1.m1.3.3.cmml">ℐ</mi><mo id="S1.T1.5.5.1.m1.4.4.1.1.1.1.2.2" stretchy="false" xref="S1.T1.5.5.1.m1.4.4.1.1.1.1.1.1.cmml">|</mo></mrow><mo id="S1.T1.5.5.1.m1.4.4.1.1.1.5" stretchy="false" xref="S1.T1.5.5.1.m1.4.4.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.5.5.1.m1.4b"><apply id="S1.T1.5.5.1.m1.4.4.cmml" xref="S1.T1.5.5.1.m1.4.4"><ci id="S1.T1.5.5.1.m1.4.4.2.cmml" xref="S1.T1.5.5.1.m1.4.4.2">:</ci><ci id="S1.T1.5.5.1.m1.4.4.3.cmml" xref="S1.T1.5.5.1.m1.4.4.3">𝑟</ci><apply id="S1.T1.5.5.1.m1.4.4.1.cmml" xref="S1.T1.5.5.1.m1.4.4.1"><ci id="S1.T1.5.5.1.m1.4.4.1.2.cmml" xref="S1.T1.5.5.1.m1.4.4.1.2">→</ci><apply id="S1.T1.5.5.1.m1.4.4.1.3.cmml" xref="S1.T1.5.5.1.m1.4.4.1.3"><times id="S1.T1.5.5.1.m1.4.4.1.3.1.cmml" xref="S1.T1.5.5.1.m1.4.4.1.3.1"></times><ci id="S1.T1.5.5.1.m1.4.4.1.3.2.cmml" xref="S1.T1.5.5.1.m1.4.4.1.3.2">ℐ</ci><ci id="S1.T1.5.5.1.m1.4.4.1.3.3.cmml" xref="S1.T1.5.5.1.m1.4.4.1.3.3">𝒞</ci></apply><set id="S1.T1.5.5.1.m1.4.4.1.1.2.cmml" xref="S1.T1.5.5.1.m1.4.4.1.1.1"><cn id="S1.T1.5.5.1.m1.1.1.cmml" type="integer" xref="S1.T1.5.5.1.m1.1.1">1</cn><ci id="S1.T1.5.5.1.m1.2.2.cmml" xref="S1.T1.5.5.1.m1.2.2">…</ci><apply id="S1.T1.5.5.1.m1.4.4.1.1.1.1.1.cmml" xref="S1.T1.5.5.1.m1.4.4.1.1.1.1.2"><abs id="S1.T1.5.5.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S1.T1.5.5.1.m1.4.4.1.1.1.1.2.1"></abs><ci id="S1.T1.5.5.1.m1.3.3.cmml" xref="S1.T1.5.5.1.m1.3.3">ℐ</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.5.5.1.m1.4c">r:\mathcal{I}\times\mathcal{C}\rightarrow\{1,\ldots,|\mathcal{I}|\}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.5.5.1.m1.4d">italic_r : caligraphic_I × caligraphic_C → { 1 , … , | caligraphic_I | }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S1.T1.5.5.2">predicted rank of an item</td>
</tr>
<tr class="ltx_tr" id="S1.T1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S1.T1.6.6.1"><math alttext="m" class="ltx_Math" display="inline" id="S1.T1.6.6.1.m1.1"><semantics id="S1.T1.6.6.1.m1.1a"><mi id="S1.T1.6.6.1.m1.1.1" xref="S1.T1.6.6.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S1.T1.6.6.1.m1.1b"><ci id="S1.T1.6.6.1.m1.1.1.cmml" xref="S1.T1.6.6.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.6.6.1.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S1.T1.6.6.1.m1.1d">italic_m</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S1.T1.6.6.2">number of negative samples</td>
</tr>
<tr class="ltx_tr" id="S1.T1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S1.T1.7.7.1"><math alttext="\tilde{\mathcal{I}}\subseteq\mathcal{I},|\tilde{\mathcal{I}}|=m" class="ltx_Math" display="inline" id="S1.T1.7.7.1.m1.3"><semantics id="S1.T1.7.7.1.m1.3a"><mrow id="S1.T1.7.7.1.m1.3.3.2" xref="S1.T1.7.7.1.m1.3.3.3.cmml"><mrow id="S1.T1.7.7.1.m1.2.2.1.1" xref="S1.T1.7.7.1.m1.2.2.1.1.cmml"><mover accent="true" id="S1.T1.7.7.1.m1.2.2.1.1.2" xref="S1.T1.7.7.1.m1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.T1.7.7.1.m1.2.2.1.1.2.2" xref="S1.T1.7.7.1.m1.2.2.1.1.2.2.cmml">ℐ</mi><mo id="S1.T1.7.7.1.m1.2.2.1.1.2.1" xref="S1.T1.7.7.1.m1.2.2.1.1.2.1.cmml">~</mo></mover><mo id="S1.T1.7.7.1.m1.2.2.1.1.1" xref="S1.T1.7.7.1.m1.2.2.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S1.T1.7.7.1.m1.2.2.1.1.3" xref="S1.T1.7.7.1.m1.2.2.1.1.3.cmml">ℐ</mi></mrow><mo id="S1.T1.7.7.1.m1.3.3.2.3" xref="S1.T1.7.7.1.m1.3.3.3a.cmml">,</mo><mrow id="S1.T1.7.7.1.m1.3.3.2.2" xref="S1.T1.7.7.1.m1.3.3.2.2.cmml"><mrow id="S1.T1.7.7.1.m1.3.3.2.2.2.2" xref="S1.T1.7.7.1.m1.3.3.2.2.2.1.cmml"><mo id="S1.T1.7.7.1.m1.3.3.2.2.2.2.1" stretchy="false" xref="S1.T1.7.7.1.m1.3.3.2.2.2.1.1.cmml">|</mo><mover accent="true" id="S1.T1.7.7.1.m1.1.1" xref="S1.T1.7.7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.T1.7.7.1.m1.1.1.2" xref="S1.T1.7.7.1.m1.1.1.2.cmml">ℐ</mi><mo id="S1.T1.7.7.1.m1.1.1.1" xref="S1.T1.7.7.1.m1.1.1.1.cmml">~</mo></mover><mo id="S1.T1.7.7.1.m1.3.3.2.2.2.2.2" stretchy="false" xref="S1.T1.7.7.1.m1.3.3.2.2.2.1.1.cmml">|</mo></mrow><mo id="S1.T1.7.7.1.m1.3.3.2.2.1" xref="S1.T1.7.7.1.m1.3.3.2.2.1.cmml">=</mo><mi id="S1.T1.7.7.1.m1.3.3.2.2.3" xref="S1.T1.7.7.1.m1.3.3.2.2.3.cmml">m</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.7.7.1.m1.3b"><apply id="S1.T1.7.7.1.m1.3.3.3.cmml" xref="S1.T1.7.7.1.m1.3.3.2"><csymbol cd="ambiguous" id="S1.T1.7.7.1.m1.3.3.3a.cmml" xref="S1.T1.7.7.1.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S1.T1.7.7.1.m1.2.2.1.1.cmml" xref="S1.T1.7.7.1.m1.2.2.1.1"><subset id="S1.T1.7.7.1.m1.2.2.1.1.1.cmml" xref="S1.T1.7.7.1.m1.2.2.1.1.1"></subset><apply id="S1.T1.7.7.1.m1.2.2.1.1.2.cmml" xref="S1.T1.7.7.1.m1.2.2.1.1.2"><ci id="S1.T1.7.7.1.m1.2.2.1.1.2.1.cmml" xref="S1.T1.7.7.1.m1.2.2.1.1.2.1">~</ci><ci id="S1.T1.7.7.1.m1.2.2.1.1.2.2.cmml" xref="S1.T1.7.7.1.m1.2.2.1.1.2.2">ℐ</ci></apply><ci id="S1.T1.7.7.1.m1.2.2.1.1.3.cmml" xref="S1.T1.7.7.1.m1.2.2.1.1.3">ℐ</ci></apply><apply id="S1.T1.7.7.1.m1.3.3.2.2.cmml" xref="S1.T1.7.7.1.m1.3.3.2.2"><eq id="S1.T1.7.7.1.m1.3.3.2.2.1.cmml" xref="S1.T1.7.7.1.m1.3.3.2.2.1"></eq><apply id="S1.T1.7.7.1.m1.3.3.2.2.2.1.cmml" xref="S1.T1.7.7.1.m1.3.3.2.2.2.2"><abs id="S1.T1.7.7.1.m1.3.3.2.2.2.1.1.cmml" xref="S1.T1.7.7.1.m1.3.3.2.2.2.2.1"></abs><apply id="S1.T1.7.7.1.m1.1.1.cmml" xref="S1.T1.7.7.1.m1.1.1"><ci id="S1.T1.7.7.1.m1.1.1.1.cmml" xref="S1.T1.7.7.1.m1.1.1.1">~</ci><ci id="S1.T1.7.7.1.m1.1.1.2.cmml" xref="S1.T1.7.7.1.m1.1.1.2">ℐ</ci></apply></apply><ci id="S1.T1.7.7.1.m1.3.3.2.2.3.cmml" xref="S1.T1.7.7.1.m1.3.3.2.2.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.7.7.1.m1.3c">\tilde{\mathcal{I}}\subseteq\mathcal{I},|\tilde{\mathcal{I}}|=m</annotation><annotation encoding="application/x-llamapun" id="S1.T1.7.7.1.m1.3d">over~ start_ARG caligraphic_I end_ARG ⊆ caligraphic_I , | over~ start_ARG caligraphic_I end_ARG | = italic_m</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S1.T1.7.7.2">sampled set of items</td>
</tr>
<tr class="ltx_tr" id="S1.T1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S1.T1.8.8.1"><math alttext="\tilde{r}:\mathcal{I}\times\mathcal{C}\rightarrow\{1,\ldots,m\}" class="ltx_Math" display="inline" id="S1.T1.8.8.1.m1.3"><semantics id="S1.T1.8.8.1.m1.3a"><mrow id="S1.T1.8.8.1.m1.3.4" xref="S1.T1.8.8.1.m1.3.4.cmml"><mover accent="true" id="S1.T1.8.8.1.m1.3.4.2" xref="S1.T1.8.8.1.m1.3.4.2.cmml"><mi id="S1.T1.8.8.1.m1.3.4.2.2" xref="S1.T1.8.8.1.m1.3.4.2.2.cmml">r</mi><mo id="S1.T1.8.8.1.m1.3.4.2.1" xref="S1.T1.8.8.1.m1.3.4.2.1.cmml">~</mo></mover><mo id="S1.T1.8.8.1.m1.3.4.1" lspace="0.278em" rspace="0.278em" xref="S1.T1.8.8.1.m1.3.4.1.cmml">:</mo><mrow id="S1.T1.8.8.1.m1.3.4.3" xref="S1.T1.8.8.1.m1.3.4.3.cmml"><mrow id="S1.T1.8.8.1.m1.3.4.3.2" xref="S1.T1.8.8.1.m1.3.4.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.T1.8.8.1.m1.3.4.3.2.2" xref="S1.T1.8.8.1.m1.3.4.3.2.2.cmml">ℐ</mi><mo id="S1.T1.8.8.1.m1.3.4.3.2.1" lspace="0.222em" rspace="0.222em" xref="S1.T1.8.8.1.m1.3.4.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S1.T1.8.8.1.m1.3.4.3.2.3" xref="S1.T1.8.8.1.m1.3.4.3.2.3.cmml">𝒞</mi></mrow><mo id="S1.T1.8.8.1.m1.3.4.3.1" stretchy="false" xref="S1.T1.8.8.1.m1.3.4.3.1.cmml">→</mo><mrow id="S1.T1.8.8.1.m1.3.4.3.3.2" xref="S1.T1.8.8.1.m1.3.4.3.3.1.cmml"><mo id="S1.T1.8.8.1.m1.3.4.3.3.2.1" stretchy="false" xref="S1.T1.8.8.1.m1.3.4.3.3.1.cmml">{</mo><mn id="S1.T1.8.8.1.m1.1.1" xref="S1.T1.8.8.1.m1.1.1.cmml">1</mn><mo id="S1.T1.8.8.1.m1.3.4.3.3.2.2" xref="S1.T1.8.8.1.m1.3.4.3.3.1.cmml">,</mo><mi id="S1.T1.8.8.1.m1.2.2" mathvariant="normal" xref="S1.T1.8.8.1.m1.2.2.cmml">…</mi><mo id="S1.T1.8.8.1.m1.3.4.3.3.2.3" xref="S1.T1.8.8.1.m1.3.4.3.3.1.cmml">,</mo><mi id="S1.T1.8.8.1.m1.3.3" xref="S1.T1.8.8.1.m1.3.3.cmml">m</mi><mo id="S1.T1.8.8.1.m1.3.4.3.3.2.4" stretchy="false" xref="S1.T1.8.8.1.m1.3.4.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.8.8.1.m1.3b"><apply id="S1.T1.8.8.1.m1.3.4.cmml" xref="S1.T1.8.8.1.m1.3.4"><ci id="S1.T1.8.8.1.m1.3.4.1.cmml" xref="S1.T1.8.8.1.m1.3.4.1">:</ci><apply id="S1.T1.8.8.1.m1.3.4.2.cmml" xref="S1.T1.8.8.1.m1.3.4.2"><ci id="S1.T1.8.8.1.m1.3.4.2.1.cmml" xref="S1.T1.8.8.1.m1.3.4.2.1">~</ci><ci id="S1.T1.8.8.1.m1.3.4.2.2.cmml" xref="S1.T1.8.8.1.m1.3.4.2.2">𝑟</ci></apply><apply id="S1.T1.8.8.1.m1.3.4.3.cmml" xref="S1.T1.8.8.1.m1.3.4.3"><ci id="S1.T1.8.8.1.m1.3.4.3.1.cmml" xref="S1.T1.8.8.1.m1.3.4.3.1">→</ci><apply id="S1.T1.8.8.1.m1.3.4.3.2.cmml" xref="S1.T1.8.8.1.m1.3.4.3.2"><times id="S1.T1.8.8.1.m1.3.4.3.2.1.cmml" xref="S1.T1.8.8.1.m1.3.4.3.2.1"></times><ci id="S1.T1.8.8.1.m1.3.4.3.2.2.cmml" xref="S1.T1.8.8.1.m1.3.4.3.2.2">ℐ</ci><ci id="S1.T1.8.8.1.m1.3.4.3.2.3.cmml" xref="S1.T1.8.8.1.m1.3.4.3.2.3">𝒞</ci></apply><set id="S1.T1.8.8.1.m1.3.4.3.3.1.cmml" xref="S1.T1.8.8.1.m1.3.4.3.3.2"><cn id="S1.T1.8.8.1.m1.1.1.cmml" type="integer" xref="S1.T1.8.8.1.m1.1.1">1</cn><ci id="S1.T1.8.8.1.m1.2.2.cmml" xref="S1.T1.8.8.1.m1.2.2">…</ci><ci id="S1.T1.8.8.1.m1.3.3.cmml" xref="S1.T1.8.8.1.m1.3.3">𝑚</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.8.8.1.m1.3c">\tilde{r}:\mathcal{I}\times\mathcal{C}\rightarrow\{1,\ldots,m\}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.8.8.1.m1.3d">over~ start_ARG italic_r end_ARG : caligraphic_I × caligraphic_C → { 1 , … , italic_m }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left" id="S1.T1.8.8.2">rank of an item in a sample</td>
</tr>
<tr class="ltx_tr" id="S1.T1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S1.T1.9.9.1"><math alttext="\hat{r}:\mathcal{I}\times\mathcal{C}\rightarrow\{1,\ldots,|\mathcal{I}|\}" class="ltx_Math" display="inline" id="S1.T1.9.9.1.m1.4"><semantics id="S1.T1.9.9.1.m1.4a"><mrow id="S1.T1.9.9.1.m1.4.4" xref="S1.T1.9.9.1.m1.4.4.cmml"><mover accent="true" id="S1.T1.9.9.1.m1.4.4.3" xref="S1.T1.9.9.1.m1.4.4.3.cmml"><mi id="S1.T1.9.9.1.m1.4.4.3.2" xref="S1.T1.9.9.1.m1.4.4.3.2.cmml">r</mi><mo id="S1.T1.9.9.1.m1.4.4.3.1" xref="S1.T1.9.9.1.m1.4.4.3.1.cmml">^</mo></mover><mo id="S1.T1.9.9.1.m1.4.4.2" lspace="0.278em" rspace="0.278em" xref="S1.T1.9.9.1.m1.4.4.2.cmml">:</mo><mrow id="S1.T1.9.9.1.m1.4.4.1" xref="S1.T1.9.9.1.m1.4.4.1.cmml"><mrow id="S1.T1.9.9.1.m1.4.4.1.3" xref="S1.T1.9.9.1.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.T1.9.9.1.m1.4.4.1.3.2" xref="S1.T1.9.9.1.m1.4.4.1.3.2.cmml">ℐ</mi><mo id="S1.T1.9.9.1.m1.4.4.1.3.1" lspace="0.222em" rspace="0.222em" xref="S1.T1.9.9.1.m1.4.4.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S1.T1.9.9.1.m1.4.4.1.3.3" xref="S1.T1.9.9.1.m1.4.4.1.3.3.cmml">𝒞</mi></mrow><mo id="S1.T1.9.9.1.m1.4.4.1.2" stretchy="false" xref="S1.T1.9.9.1.m1.4.4.1.2.cmml">→</mo><mrow id="S1.T1.9.9.1.m1.4.4.1.1.1" xref="S1.T1.9.9.1.m1.4.4.1.1.2.cmml"><mo id="S1.T1.9.9.1.m1.4.4.1.1.1.2" stretchy="false" xref="S1.T1.9.9.1.m1.4.4.1.1.2.cmml">{</mo><mn id="S1.T1.9.9.1.m1.1.1" xref="S1.T1.9.9.1.m1.1.1.cmml">1</mn><mo id="S1.T1.9.9.1.m1.4.4.1.1.1.3" xref="S1.T1.9.9.1.m1.4.4.1.1.2.cmml">,</mo><mi id="S1.T1.9.9.1.m1.2.2" mathvariant="normal" xref="S1.T1.9.9.1.m1.2.2.cmml">…</mi><mo id="S1.T1.9.9.1.m1.4.4.1.1.1.4" xref="S1.T1.9.9.1.m1.4.4.1.1.2.cmml">,</mo><mrow id="S1.T1.9.9.1.m1.4.4.1.1.1.1.2" xref="S1.T1.9.9.1.m1.4.4.1.1.1.1.1.cmml"><mo id="S1.T1.9.9.1.m1.4.4.1.1.1.1.2.1" stretchy="false" xref="S1.T1.9.9.1.m1.4.4.1.1.1.1.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S1.T1.9.9.1.m1.3.3" xref="S1.T1.9.9.1.m1.3.3.cmml">ℐ</mi><mo id="S1.T1.9.9.1.m1.4.4.1.1.1.1.2.2" stretchy="false" xref="S1.T1.9.9.1.m1.4.4.1.1.1.1.1.1.cmml">|</mo></mrow><mo id="S1.T1.9.9.1.m1.4.4.1.1.1.5" stretchy="false" xref="S1.T1.9.9.1.m1.4.4.1.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.T1.9.9.1.m1.4b"><apply id="S1.T1.9.9.1.m1.4.4.cmml" xref="S1.T1.9.9.1.m1.4.4"><ci id="S1.T1.9.9.1.m1.4.4.2.cmml" xref="S1.T1.9.9.1.m1.4.4.2">:</ci><apply id="S1.T1.9.9.1.m1.4.4.3.cmml" xref="S1.T1.9.9.1.m1.4.4.3"><ci id="S1.T1.9.9.1.m1.4.4.3.1.cmml" xref="S1.T1.9.9.1.m1.4.4.3.1">^</ci><ci id="S1.T1.9.9.1.m1.4.4.3.2.cmml" xref="S1.T1.9.9.1.m1.4.4.3.2">𝑟</ci></apply><apply id="S1.T1.9.9.1.m1.4.4.1.cmml" xref="S1.T1.9.9.1.m1.4.4.1"><ci id="S1.T1.9.9.1.m1.4.4.1.2.cmml" xref="S1.T1.9.9.1.m1.4.4.1.2">→</ci><apply id="S1.T1.9.9.1.m1.4.4.1.3.cmml" xref="S1.T1.9.9.1.m1.4.4.1.3"><times id="S1.T1.9.9.1.m1.4.4.1.3.1.cmml" xref="S1.T1.9.9.1.m1.4.4.1.3.1"></times><ci id="S1.T1.9.9.1.m1.4.4.1.3.2.cmml" xref="S1.T1.9.9.1.m1.4.4.1.3.2">ℐ</ci><ci id="S1.T1.9.9.1.m1.4.4.1.3.3.cmml" xref="S1.T1.9.9.1.m1.4.4.1.3.3">𝒞</ci></apply><set id="S1.T1.9.9.1.m1.4.4.1.1.2.cmml" xref="S1.T1.9.9.1.m1.4.4.1.1.1"><cn id="S1.T1.9.9.1.m1.1.1.cmml" type="integer" xref="S1.T1.9.9.1.m1.1.1">1</cn><ci id="S1.T1.9.9.1.m1.2.2.cmml" xref="S1.T1.9.9.1.m1.2.2">…</ci><apply id="S1.T1.9.9.1.m1.4.4.1.1.1.1.1.cmml" xref="S1.T1.9.9.1.m1.4.4.1.1.1.1.2"><abs id="S1.T1.9.9.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S1.T1.9.9.1.m1.4.4.1.1.1.1.2.1"></abs><ci id="S1.T1.9.9.1.m1.3.3.cmml" xref="S1.T1.9.9.1.m1.3.3">ℐ</ci></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.T1.9.9.1.m1.4c">\hat{r}:\mathcal{I}\times\mathcal{C}\rightarrow\{1,\ldots,|\mathcal{I}|\}</annotation><annotation encoding="application/x-llamapun" id="S1.T1.9.9.1.m1.4d">over^ start_ARG italic_r end_ARG : caligraphic_I × caligraphic_C → { 1 , … , | caligraphic_I | }</annotation></semantics></math></th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S1.T1.9.9.2">estimated rank on the full catalog</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Symbols</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Item recommendation from implicit feedback is a widely studied task <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib14" title="">2022</a>)</cite>.
We shortly summarize some alternative approaches for tackling the task of item recommendation with large item catalogs.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">One direction of work is to change the sampling distribution, e.g., sampling by item popularity <cite class="ltx_cite ltx_citemacro_citep">(Bengio and
Senecal, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib2" title="">2003</a>)</cite> or sampling items that are highly ranked for a context <cite class="ltx_cite ltx_citemacro_citep">(Rendle and
Freudenthaler, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib15" title="">2014</a>; Yuan
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib19" title="">2016</a>)</cite>.
Using a more complex sampling distribution can serve as a correction, e.g., sampling according to the softmax distribution results in an unbiased softmax loss even with small sample sizes <cite class="ltx_cite ltx_citemacro_citep">(Blanc and Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib4" title="">2018</a>)</cite>.
Besides the higher computational costs for sampling itself, another downside of complex, context-dependent sampling distributions is that negative samples are not shared between multiple context in a batch.
This is problematic when batches of users and negative items should be processed in parallel, e.g., utilizing modern parallel hardware.
In our work, we take a different approach and investigate a simple sampling distribution (uniform sampling) but apply corrections to the statistics that we compute from the sample.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Moreover, there exist approaches for specialized loss functions that avoid sampling altogether and that can work efficiently on the full item catalog <cite class="ltx_cite ltx_citemacro_citep">(Hu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib7" title="">2008</a>; Krichene et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib10" title="">2019</a>)</cite>.
The computational trick that they employ works for spherical loss functions over negative items.
In our work, we focus on more complex ranking losses where efficient formulations are not available.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Problem Setting</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.7">Let <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">caligraphic_C</annotation></semantics></math> be a set of recommendation context (e.g., a user, or a sequence).
Let <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">caligraphic_I</annotation></semantics></math> be a set of items that can be recommended – we call this the <em class="ltx_emph ltx_font_italic" id="S3.p1.7.1">item catalog</em>.
Let <math alttext="y:\mathcal{C}\times\mathcal{I}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mi id="S3.p1.3.m3.1.1.2" xref="S3.p1.3.m3.1.1.2.cmml">y</mi><mo id="S3.p1.3.m3.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.p1.3.m3.1.1.1.cmml">:</mo><mrow id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mrow id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1.3.2.2" xref="S3.p1.3.m3.1.1.3.2.2.cmml">𝒞</mi><mo id="S3.p1.3.m3.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.p1.3.m3.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1.3.2.3" xref="S3.p1.3.m3.1.1.3.2.3.cmml">ℐ</mi></mrow><mo id="S3.p1.3.m3.1.1.3.1" stretchy="false" xref="S3.p1.3.m3.1.1.3.1.cmml">→</mo><mi id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1"><ci id="S3.p1.3.m3.1.1.1.cmml" xref="S3.p1.3.m3.1.1.1">:</ci><ci id="S3.p1.3.m3.1.1.2.cmml" xref="S3.p1.3.m3.1.1.2">𝑦</ci><apply id="S3.p1.3.m3.1.1.3.cmml" xref="S3.p1.3.m3.1.1.3"><ci id="S3.p1.3.m3.1.1.3.1.cmml" xref="S3.p1.3.m3.1.1.3.1">→</ci><apply id="S3.p1.3.m3.1.1.3.2.cmml" xref="S3.p1.3.m3.1.1.3.2"><times id="S3.p1.3.m3.1.1.3.2.1.cmml" xref="S3.p1.3.m3.1.1.3.2.1"></times><ci id="S3.p1.3.m3.1.1.3.2.2.cmml" xref="S3.p1.3.m3.1.1.3.2.2">𝒞</ci><ci id="S3.p1.3.m3.1.1.3.2.3.cmml" xref="S3.p1.3.m3.1.1.3.2.3">ℐ</ci></apply><ci id="S3.p1.3.m3.1.1.3.3.cmml" xref="S3.p1.3.m3.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">y:\mathcal{C}\times\mathcal{I}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_y : caligraphic_C × caligraphic_I → blackboard_R</annotation></semantics></math> be a recommendation scoring function.
This function can be used to rank items for a given context and to show the highest scoring items to the user.
<math alttext="y" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_y</annotation></semantics></math> is typically a learn-able function that is parameterized by model parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_θ</annotation></semantics></math>.
We aim to learn <math alttext="\theta" class="ltx_Math" display="inline" id="S3.p1.6.m6.1"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.1d">italic_θ</annotation></semantics></math> based on a set of training examples <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">caligraphic_S</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.9">Our work focuses on the task of learning the recommender from <em class="ltx_emph ltx_font_italic" id="S3.p2.9.1">implicit feedback</em> <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib14" title="">2022</a>)</cite>.
In this setting, the observations are positive-only observations such as clicks, listen events, etc.
The training examples are a set of such positive interactions: <math alttext="\mathcal{S}\subset\mathcal{C}\times\mathcal{I}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">𝒮</mi><mo id="S3.p2.1.m1.1.1.1" xref="S3.p2.1.m1.1.1.1.cmml">⊂</mo><mrow id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1.3.2" xref="S3.p2.1.m1.1.1.3.2.cmml">𝒞</mi><mo id="S3.p2.1.m1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.p2.1.m1.1.1.3.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1.3.3" xref="S3.p2.1.m1.1.1.3.3.cmml">ℐ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><subset id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1"></subset><ci id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">𝒮</ci><apply id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3"><times id="S3.p2.1.m1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.3.1"></times><ci id="S3.p2.1.m1.1.1.3.2.cmml" xref="S3.p2.1.m1.1.1.3.2">𝒞</ci><ci id="S3.p2.1.m1.1.1.3.3.cmml" xref="S3.p2.1.m1.1.1.3.3">ℐ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathcal{S}\subset\mathcal{C}\times\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">caligraphic_S ⊂ caligraphic_C × caligraphic_I</annotation></semantics></math>.
Each training context <math alttext="c" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">c</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_c</annotation></semantics></math> has some observed (or <em class="ltx_emph ltx_font_italic" id="S3.p2.9.2">positive</em>) items <math alttext="i" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">italic_i</annotation></semantics></math> (i.e., <math alttext="(c,i)\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.4.m4.2"><semantics id="S3.p2.4.m4.2a"><mrow id="S3.p2.4.m4.2.3" xref="S3.p2.4.m4.2.3.cmml"><mrow id="S3.p2.4.m4.2.3.2.2" xref="S3.p2.4.m4.2.3.2.1.cmml"><mo id="S3.p2.4.m4.2.3.2.2.1" stretchy="false" xref="S3.p2.4.m4.2.3.2.1.cmml">(</mo><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">c</mi><mo id="S3.p2.4.m4.2.3.2.2.2" xref="S3.p2.4.m4.2.3.2.1.cmml">,</mo><mi id="S3.p2.4.m4.2.2" xref="S3.p2.4.m4.2.2.cmml">i</mi><mo id="S3.p2.4.m4.2.3.2.2.3" stretchy="false" xref="S3.p2.4.m4.2.3.2.1.cmml">)</mo></mrow><mo id="S3.p2.4.m4.2.3.1" xref="S3.p2.4.m4.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.2.3.3" xref="S3.p2.4.m4.2.3.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.2b"><apply id="S3.p2.4.m4.2.3.cmml" xref="S3.p2.4.m4.2.3"><in id="S3.p2.4.m4.2.3.1.cmml" xref="S3.p2.4.m4.2.3.1"></in><interval closure="open" id="S3.p2.4.m4.2.3.2.1.cmml" xref="S3.p2.4.m4.2.3.2.2"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝑐</ci><ci id="S3.p2.4.m4.2.2.cmml" xref="S3.p2.4.m4.2.2">𝑖</ci></interval><ci id="S3.p2.4.m4.2.3.3.cmml" xref="S3.p2.4.m4.2.3.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.2c">(c,i)\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.2d">( italic_c , italic_i ) ∈ caligraphic_S</annotation></semantics></math>) and all other items are called <em class="ltx_emph ltx_font_italic" id="S3.p2.9.3">unobserved</em> and considered <em class="ltx_emph ltx_font_italic" id="S3.p2.9.4">negative</em> items.
For a training example <math alttext="(c,i)\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.5.m5.2"><semantics id="S3.p2.5.m5.2a"><mrow id="S3.p2.5.m5.2.3" xref="S3.p2.5.m5.2.3.cmml"><mrow id="S3.p2.5.m5.2.3.2.2" xref="S3.p2.5.m5.2.3.2.1.cmml"><mo id="S3.p2.5.m5.2.3.2.2.1" stretchy="false" xref="S3.p2.5.m5.2.3.2.1.cmml">(</mo><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">c</mi><mo id="S3.p2.5.m5.2.3.2.2.2" xref="S3.p2.5.m5.2.3.2.1.cmml">,</mo><mi id="S3.p2.5.m5.2.2" xref="S3.p2.5.m5.2.2.cmml">i</mi><mo id="S3.p2.5.m5.2.3.2.2.3" stretchy="false" xref="S3.p2.5.m5.2.3.2.1.cmml">)</mo></mrow><mo id="S3.p2.5.m5.2.3.1" xref="S3.p2.5.m5.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.2.3.3" xref="S3.p2.5.m5.2.3.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.2b"><apply id="S3.p2.5.m5.2.3.cmml" xref="S3.p2.5.m5.2.3"><in id="S3.p2.5.m5.2.3.1.cmml" xref="S3.p2.5.m5.2.3.1"></in><interval closure="open" id="S3.p2.5.m5.2.3.2.1.cmml" xref="S3.p2.5.m5.2.3.2.2"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑐</ci><ci id="S3.p2.5.m5.2.2.cmml" xref="S3.p2.5.m5.2.2">𝑖</ci></interval><ci id="S3.p2.5.m5.2.3.3.cmml" xref="S3.p2.5.m5.2.3.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.2c">(c,i)\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.2d">( italic_c , italic_i ) ∈ caligraphic_S</annotation></semantics></math>, we would like that the recommender scores positive items higher than negative items, i.e., we would like the learned scoring function to satisfy <math alttext="y(c,i)&gt;y(c,j)" class="ltx_Math" display="inline" id="S3.p2.6.m6.4"><semantics id="S3.p2.6.m6.4a"><mrow id="S3.p2.6.m6.4.5" xref="S3.p2.6.m6.4.5.cmml"><mrow id="S3.p2.6.m6.4.5.2" xref="S3.p2.6.m6.4.5.2.cmml"><mi id="S3.p2.6.m6.4.5.2.2" xref="S3.p2.6.m6.4.5.2.2.cmml">y</mi><mo id="S3.p2.6.m6.4.5.2.1" xref="S3.p2.6.m6.4.5.2.1.cmml">⁢</mo><mrow id="S3.p2.6.m6.4.5.2.3.2" xref="S3.p2.6.m6.4.5.2.3.1.cmml"><mo id="S3.p2.6.m6.4.5.2.3.2.1" stretchy="false" xref="S3.p2.6.m6.4.5.2.3.1.cmml">(</mo><mi id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">c</mi><mo id="S3.p2.6.m6.4.5.2.3.2.2" xref="S3.p2.6.m6.4.5.2.3.1.cmml">,</mo><mi id="S3.p2.6.m6.2.2" xref="S3.p2.6.m6.2.2.cmml">i</mi><mo id="S3.p2.6.m6.4.5.2.3.2.3" stretchy="false" xref="S3.p2.6.m6.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.p2.6.m6.4.5.1" xref="S3.p2.6.m6.4.5.1.cmml">&gt;</mo><mrow id="S3.p2.6.m6.4.5.3" xref="S3.p2.6.m6.4.5.3.cmml"><mi id="S3.p2.6.m6.4.5.3.2" xref="S3.p2.6.m6.4.5.3.2.cmml">y</mi><mo id="S3.p2.6.m6.4.5.3.1" xref="S3.p2.6.m6.4.5.3.1.cmml">⁢</mo><mrow id="S3.p2.6.m6.4.5.3.3.2" xref="S3.p2.6.m6.4.5.3.3.1.cmml"><mo id="S3.p2.6.m6.4.5.3.3.2.1" stretchy="false" xref="S3.p2.6.m6.4.5.3.3.1.cmml">(</mo><mi id="S3.p2.6.m6.3.3" xref="S3.p2.6.m6.3.3.cmml">c</mi><mo id="S3.p2.6.m6.4.5.3.3.2.2" xref="S3.p2.6.m6.4.5.3.3.1.cmml">,</mo><mi id="S3.p2.6.m6.4.4" xref="S3.p2.6.m6.4.4.cmml">j</mi><mo id="S3.p2.6.m6.4.5.3.3.2.3" stretchy="false" xref="S3.p2.6.m6.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.4b"><apply id="S3.p2.6.m6.4.5.cmml" xref="S3.p2.6.m6.4.5"><gt id="S3.p2.6.m6.4.5.1.cmml" xref="S3.p2.6.m6.4.5.1"></gt><apply id="S3.p2.6.m6.4.5.2.cmml" xref="S3.p2.6.m6.4.5.2"><times id="S3.p2.6.m6.4.5.2.1.cmml" xref="S3.p2.6.m6.4.5.2.1"></times><ci id="S3.p2.6.m6.4.5.2.2.cmml" xref="S3.p2.6.m6.4.5.2.2">𝑦</ci><interval closure="open" id="S3.p2.6.m6.4.5.2.3.1.cmml" xref="S3.p2.6.m6.4.5.2.3.2"><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">𝑐</ci><ci id="S3.p2.6.m6.2.2.cmml" xref="S3.p2.6.m6.2.2">𝑖</ci></interval></apply><apply id="S3.p2.6.m6.4.5.3.cmml" xref="S3.p2.6.m6.4.5.3"><times id="S3.p2.6.m6.4.5.3.1.cmml" xref="S3.p2.6.m6.4.5.3.1"></times><ci id="S3.p2.6.m6.4.5.3.2.cmml" xref="S3.p2.6.m6.4.5.3.2">𝑦</ci><interval closure="open" id="S3.p2.6.m6.4.5.3.3.1.cmml" xref="S3.p2.6.m6.4.5.3.3.2"><ci id="S3.p2.6.m6.3.3.cmml" xref="S3.p2.6.m6.3.3">𝑐</ci><ci id="S3.p2.6.m6.4.4.cmml" xref="S3.p2.6.m6.4.4">𝑗</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.4c">y(c,i)&gt;y(c,j)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m6.4d">italic_y ( italic_c , italic_i ) &gt; italic_y ( italic_c , italic_j )</annotation></semantics></math> if <math alttext="(c,i)\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.7.m7.2"><semantics id="S3.p2.7.m7.2a"><mrow id="S3.p2.7.m7.2.3" xref="S3.p2.7.m7.2.3.cmml"><mrow id="S3.p2.7.m7.2.3.2.2" xref="S3.p2.7.m7.2.3.2.1.cmml"><mo id="S3.p2.7.m7.2.3.2.2.1" stretchy="false" xref="S3.p2.7.m7.2.3.2.1.cmml">(</mo><mi id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml">c</mi><mo id="S3.p2.7.m7.2.3.2.2.2" xref="S3.p2.7.m7.2.3.2.1.cmml">,</mo><mi id="S3.p2.7.m7.2.2" xref="S3.p2.7.m7.2.2.cmml">i</mi><mo id="S3.p2.7.m7.2.3.2.2.3" stretchy="false" xref="S3.p2.7.m7.2.3.2.1.cmml">)</mo></mrow><mo id="S3.p2.7.m7.2.3.1" xref="S3.p2.7.m7.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.7.m7.2.3.3" xref="S3.p2.7.m7.2.3.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.2b"><apply id="S3.p2.7.m7.2.3.cmml" xref="S3.p2.7.m7.2.3"><in id="S3.p2.7.m7.2.3.1.cmml" xref="S3.p2.7.m7.2.3.1"></in><interval closure="open" id="S3.p2.7.m7.2.3.2.1.cmml" xref="S3.p2.7.m7.2.3.2.2"><ci id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1">𝑐</ci><ci id="S3.p2.7.m7.2.2.cmml" xref="S3.p2.7.m7.2.2">𝑖</ci></interval><ci id="S3.p2.7.m7.2.3.3.cmml" xref="S3.p2.7.m7.2.3.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.2c">(c,i)\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m7.2d">( italic_c , italic_i ) ∈ caligraphic_S</annotation></semantics></math> and <math alttext="(c,j)\not\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.p2.8.m8.2"><semantics id="S3.p2.8.m8.2a"><mrow id="S3.p2.8.m8.2.3" xref="S3.p2.8.m8.2.3.cmml"><mrow id="S3.p2.8.m8.2.3.2.2" xref="S3.p2.8.m8.2.3.2.1.cmml"><mo id="S3.p2.8.m8.2.3.2.2.1" stretchy="false" xref="S3.p2.8.m8.2.3.2.1.cmml">(</mo><mi id="S3.p2.8.m8.1.1" xref="S3.p2.8.m8.1.1.cmml">c</mi><mo id="S3.p2.8.m8.2.3.2.2.2" xref="S3.p2.8.m8.2.3.2.1.cmml">,</mo><mi id="S3.p2.8.m8.2.2" xref="S3.p2.8.m8.2.2.cmml">j</mi><mo id="S3.p2.8.m8.2.3.2.2.3" stretchy="false" xref="S3.p2.8.m8.2.3.2.1.cmml">)</mo></mrow><mo id="S3.p2.8.m8.2.3.1" xref="S3.p2.8.m8.2.3.1.cmml">∉</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.8.m8.2.3.3" xref="S3.p2.8.m8.2.3.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.8.m8.2b"><apply id="S3.p2.8.m8.2.3.cmml" xref="S3.p2.8.m8.2.3"><notin id="S3.p2.8.m8.2.3.1.cmml" xref="S3.p2.8.m8.2.3.1"></notin><interval closure="open" id="S3.p2.8.m8.2.3.2.1.cmml" xref="S3.p2.8.m8.2.3.2.2"><ci id="S3.p2.8.m8.1.1.cmml" xref="S3.p2.8.m8.1.1">𝑐</ci><ci id="S3.p2.8.m8.2.2.cmml" xref="S3.p2.8.m8.2.2">𝑗</ci></interval><ci id="S3.p2.8.m8.2.3.3.cmml" xref="S3.p2.8.m8.2.3.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m8.2c">(c,j)\not\in\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.8.m8.2d">( italic_c , italic_j ) ∉ caligraphic_S</annotation></semantics></math>.
Learning algorithms use <em class="ltx_emph ltx_font_italic" id="S3.p2.9.5">loss functions</em> to guide the search for optimal model parameters <math alttext="\theta" class="ltx_Math" display="inline" id="S3.p2.9.m9.1"><semantics id="S3.p2.9.m9.1a"><mi id="S3.p2.9.m9.1.1" xref="S3.p2.9.m9.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.9.m9.1b"><ci id="S3.p2.9.m9.1.1.cmml" xref="S3.p2.9.m9.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m9.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.p2.9.m9.1d">italic_θ</annotation></semantics></math>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Iterative Pairwise Training</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l1.2">Input:</span> dataset <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">caligraphic_S</annotation></semantics></math>, learning rate <math alttext="\eta" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_η</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l2.2">Output:</span> model parameters <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_θ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l3.2">repeat</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.2.1.1" style="font-size:80%;">4:</span></span>     sample <math alttext="(c,i)\sim\mathcal{S}" class="ltx_Math" display="inline" id="alg1.l4.m1.2"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.3" xref="alg1.l4.m1.2.3.cmml"><mrow id="alg1.l4.m1.2.3.2.2" xref="alg1.l4.m1.2.3.2.1.cmml"><mo id="alg1.l4.m1.2.3.2.2.1" stretchy="false" xref="alg1.l4.m1.2.3.2.1.cmml">(</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">c</mi><mo id="alg1.l4.m1.2.3.2.2.2" xref="alg1.l4.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">i</mi><mo id="alg1.l4.m1.2.3.2.2.3" stretchy="false" xref="alg1.l4.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg1.l4.m1.2.3.1" xref="alg1.l4.m1.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.2.3.3" xref="alg1.l4.m1.2.3.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><apply id="alg1.l4.m1.2.3.cmml" xref="alg1.l4.m1.2.3"><csymbol cd="latexml" id="alg1.l4.m1.2.3.1.cmml" xref="alg1.l4.m1.2.3.1">similar-to</csymbol><interval closure="open" id="alg1.l4.m1.2.3.2.1.cmml" xref="alg1.l4.m1.2.3.2.2"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑐</ci><ci id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">𝑖</ci></interval><ci id="alg1.l4.m1.2.3.3.cmml" xref="alg1.l4.m1.2.3.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">(c,i)\sim\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.2d">( italic_c , italic_i ) ∼ caligraphic_S</annotation></semantics></math> <span class="ltx_text" id="alg1.l4.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l4.1.m1.1"><semantics id="alg1.l4.1.m1.1a"><mo id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.1.m1.1d">▷</annotation></semantics></math> positive observation
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.2.1.1" style="font-size:80%;">5:</span></span>     sample <math alttext="j\sim\mathcal{I}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">j</mi><mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">similar-to</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝑗</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">j\sim\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_j ∼ caligraphic_I</annotation></semantics></math> with probability <math alttext="q(j|c,i)" class="ltx_Math" display="inline" id="alg1.l5.m2.3"><semantics id="alg1.l5.m2.3a"><mrow id="alg1.l5.m2.3.3" xref="alg1.l5.m2.3.3.cmml"><mi id="alg1.l5.m2.3.3.3" xref="alg1.l5.m2.3.3.3.cmml">q</mi><mo id="alg1.l5.m2.3.3.2" xref="alg1.l5.m2.3.3.2.cmml">⁢</mo><mrow id="alg1.l5.m2.3.3.1.1" xref="alg1.l5.m2.3.3.1.1.1.cmml"><mo id="alg1.l5.m2.3.3.1.1.2" stretchy="false" xref="alg1.l5.m2.3.3.1.1.1.cmml">(</mo><mrow id="alg1.l5.m2.3.3.1.1.1" xref="alg1.l5.m2.3.3.1.1.1.cmml"><mi id="alg1.l5.m2.3.3.1.1.1.2" xref="alg1.l5.m2.3.3.1.1.1.2.cmml">j</mi><mo fence="false" id="alg1.l5.m2.3.3.1.1.1.1" xref="alg1.l5.m2.3.3.1.1.1.1.cmml">|</mo><mrow id="alg1.l5.m2.3.3.1.1.1.3.2" xref="alg1.l5.m2.3.3.1.1.1.3.1.cmml"><mi id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">c</mi><mo id="alg1.l5.m2.3.3.1.1.1.3.2.1" xref="alg1.l5.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="alg1.l5.m2.2.2" xref="alg1.l5.m2.2.2.cmml">i</mi></mrow></mrow><mo id="alg1.l5.m2.3.3.1.1.3" stretchy="false" xref="alg1.l5.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.3b"><apply id="alg1.l5.m2.3.3.cmml" xref="alg1.l5.m2.3.3"><times id="alg1.l5.m2.3.3.2.cmml" xref="alg1.l5.m2.3.3.2"></times><ci id="alg1.l5.m2.3.3.3.cmml" xref="alg1.l5.m2.3.3.3">𝑞</ci><apply id="alg1.l5.m2.3.3.1.1.1.cmml" xref="alg1.l5.m2.3.3.1.1"><csymbol cd="latexml" id="alg1.l5.m2.3.3.1.1.1.1.cmml" xref="alg1.l5.m2.3.3.1.1.1.1">conditional</csymbol><ci id="alg1.l5.m2.3.3.1.1.1.2.cmml" xref="alg1.l5.m2.3.3.1.1.1.2">𝑗</ci><list id="alg1.l5.m2.3.3.1.1.1.3.1.cmml" xref="alg1.l5.m2.3.3.1.1.1.3.2"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑐</ci><ci id="alg1.l5.m2.2.2.cmml" xref="alg1.l5.m2.2.2">𝑖</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.3c">q(j|c,i)</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.3d">italic_q ( italic_j | italic_c , italic_i )</annotation></semantics></math> <span class="ltx_text" id="alg1.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l5.1.m1.1"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.1.m1.1d">▷</annotation></semantics></math> negative item 
</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.2.1.1" style="font-size:80%;">6:</span></span>     <math alttext="\theta\leftarrow\theta-\eta\,\alpha(c,i,j)\frac{\partial}{\partial\theta}l(c,i%
,j)" class="ltx_Math" display="inline" id="alg1.l6.m1.6"><semantics id="alg1.l6.m1.6a"><mrow id="alg1.l6.m1.6.7" xref="alg1.l6.m1.6.7.cmml"><mi id="alg1.l6.m1.6.7.2" xref="alg1.l6.m1.6.7.2.cmml">θ</mi><mo id="alg1.l6.m1.6.7.1" stretchy="false" xref="alg1.l6.m1.6.7.1.cmml">←</mo><mrow id="alg1.l6.m1.6.7.3" xref="alg1.l6.m1.6.7.3.cmml"><mi id="alg1.l6.m1.6.7.3.2" xref="alg1.l6.m1.6.7.3.2.cmml">θ</mi><mo id="alg1.l6.m1.6.7.3.1" xref="alg1.l6.m1.6.7.3.1.cmml">−</mo><mrow id="alg1.l6.m1.6.7.3.3" xref="alg1.l6.m1.6.7.3.3.cmml"><mi id="alg1.l6.m1.6.7.3.3.2" xref="alg1.l6.m1.6.7.3.3.2.cmml">η</mi><mo id="alg1.l6.m1.6.7.3.3.1" lspace="0.170em" xref="alg1.l6.m1.6.7.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.6.7.3.3.3" xref="alg1.l6.m1.6.7.3.3.3.cmml">α</mi><mo id="alg1.l6.m1.6.7.3.3.1a" xref="alg1.l6.m1.6.7.3.3.1.cmml">⁢</mo><mrow id="alg1.l6.m1.6.7.3.3.4.2" xref="alg1.l6.m1.6.7.3.3.4.1.cmml"><mo id="alg1.l6.m1.6.7.3.3.4.2.1" stretchy="false" xref="alg1.l6.m1.6.7.3.3.4.1.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">c</mi><mo id="alg1.l6.m1.6.7.3.3.4.2.2" xref="alg1.l6.m1.6.7.3.3.4.1.cmml">,</mo><mi id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">i</mi><mo id="alg1.l6.m1.6.7.3.3.4.2.3" xref="alg1.l6.m1.6.7.3.3.4.1.cmml">,</mo><mi id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">j</mi><mo id="alg1.l6.m1.6.7.3.3.4.2.4" stretchy="false" xref="alg1.l6.m1.6.7.3.3.4.1.cmml">)</mo></mrow><mo id="alg1.l6.m1.6.7.3.3.1b" xref="alg1.l6.m1.6.7.3.3.1.cmml">⁢</mo><mfrac id="alg1.l6.m1.6.7.3.3.5" xref="alg1.l6.m1.6.7.3.3.5.cmml"><mo id="alg1.l6.m1.6.7.3.3.5.2" xref="alg1.l6.m1.6.7.3.3.5.2.cmml">∂</mo><mrow id="alg1.l6.m1.6.7.3.3.5.3" xref="alg1.l6.m1.6.7.3.3.5.3.cmml"><mo id="alg1.l6.m1.6.7.3.3.5.3.1" rspace="0em" xref="alg1.l6.m1.6.7.3.3.5.3.1.cmml">∂</mo><mi id="alg1.l6.m1.6.7.3.3.5.3.2" xref="alg1.l6.m1.6.7.3.3.5.3.2.cmml">θ</mi></mrow></mfrac><mo id="alg1.l6.m1.6.7.3.3.1c" xref="alg1.l6.m1.6.7.3.3.1.cmml">⁢</mo><mi id="alg1.l6.m1.6.7.3.3.6" xref="alg1.l6.m1.6.7.3.3.6.cmml">l</mi><mo id="alg1.l6.m1.6.7.3.3.1d" xref="alg1.l6.m1.6.7.3.3.1.cmml">⁢</mo><mrow id="alg1.l6.m1.6.7.3.3.7.2" xref="alg1.l6.m1.6.7.3.3.7.1.cmml"><mo id="alg1.l6.m1.6.7.3.3.7.2.1" stretchy="false" xref="alg1.l6.m1.6.7.3.3.7.1.cmml">(</mo><mi id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml">c</mi><mo id="alg1.l6.m1.6.7.3.3.7.2.2" xref="alg1.l6.m1.6.7.3.3.7.1.cmml">,</mo><mi id="alg1.l6.m1.5.5" xref="alg1.l6.m1.5.5.cmml">i</mi><mo id="alg1.l6.m1.6.7.3.3.7.2.3" xref="alg1.l6.m1.6.7.3.3.7.1.cmml">,</mo><mi id="alg1.l6.m1.6.6" xref="alg1.l6.m1.6.6.cmml">j</mi><mo id="alg1.l6.m1.6.7.3.3.7.2.4" stretchy="false" xref="alg1.l6.m1.6.7.3.3.7.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.6b"><apply id="alg1.l6.m1.6.7.cmml" xref="alg1.l6.m1.6.7"><ci id="alg1.l6.m1.6.7.1.cmml" xref="alg1.l6.m1.6.7.1">←</ci><ci id="alg1.l6.m1.6.7.2.cmml" xref="alg1.l6.m1.6.7.2">𝜃</ci><apply id="alg1.l6.m1.6.7.3.cmml" xref="alg1.l6.m1.6.7.3"><minus id="alg1.l6.m1.6.7.3.1.cmml" xref="alg1.l6.m1.6.7.3.1"></minus><ci id="alg1.l6.m1.6.7.3.2.cmml" xref="alg1.l6.m1.6.7.3.2">𝜃</ci><apply id="alg1.l6.m1.6.7.3.3.cmml" xref="alg1.l6.m1.6.7.3.3"><times id="alg1.l6.m1.6.7.3.3.1.cmml" xref="alg1.l6.m1.6.7.3.3.1"></times><ci id="alg1.l6.m1.6.7.3.3.2.cmml" xref="alg1.l6.m1.6.7.3.3.2">𝜂</ci><ci id="alg1.l6.m1.6.7.3.3.3.cmml" xref="alg1.l6.m1.6.7.3.3.3">𝛼</ci><vector id="alg1.l6.m1.6.7.3.3.4.1.cmml" xref="alg1.l6.m1.6.7.3.3.4.2"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑐</ci><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">𝑖</ci><ci id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">𝑗</ci></vector><apply id="alg1.l6.m1.6.7.3.3.5.cmml" xref="alg1.l6.m1.6.7.3.3.5"><divide id="alg1.l6.m1.6.7.3.3.5.1.cmml" xref="alg1.l6.m1.6.7.3.3.5"></divide><partialdiff id="alg1.l6.m1.6.7.3.3.5.2.cmml" xref="alg1.l6.m1.6.7.3.3.5.2"></partialdiff><apply id="alg1.l6.m1.6.7.3.3.5.3.cmml" xref="alg1.l6.m1.6.7.3.3.5.3"><partialdiff id="alg1.l6.m1.6.7.3.3.5.3.1.cmml" xref="alg1.l6.m1.6.7.3.3.5.3.1"></partialdiff><ci id="alg1.l6.m1.6.7.3.3.5.3.2.cmml" xref="alg1.l6.m1.6.7.3.3.5.3.2">𝜃</ci></apply></apply><ci id="alg1.l6.m1.6.7.3.3.6.cmml" xref="alg1.l6.m1.6.7.3.3.6">𝑙</ci><vector id="alg1.l6.m1.6.7.3.3.7.1.cmml" xref="alg1.l6.m1.6.7.3.3.7.2"><ci id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4">𝑐</ci><ci id="alg1.l6.m1.5.5.cmml" xref="alg1.l6.m1.5.5">𝑖</ci><ci id="alg1.l6.m1.6.6.cmml" xref="alg1.l6.m1.6.6">𝑗</ci></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.6c">\theta\leftarrow\theta-\eta\,\alpha(c,i,j)\frac{\partial}{\partial\theta}l(c,i%
,j)</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.6d">italic_θ ← italic_θ - italic_η italic_α ( italic_c , italic_i , italic_j ) divide start_ARG ∂ end_ARG start_ARG ∂ italic_θ end_ARG italic_l ( italic_c , italic_i , italic_j )</annotation></semantics></math> <span class="ltx_text" id="alg1.l6.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l6.1.m1.1"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.1.m1.1d">▷</annotation></semantics></math> gradient step
</span>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l7.2">until</span> Convergence

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l8.2">return</span> <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_θ</annotation></semantics></math>
</div>
</div>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Rank Dependent Losses</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">Numerous loss functions have been proposed for learning from implicit feedback <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib14" title="">2022</a>)</cite>.
Some sophisticated ranking techniques such as WARP <cite class="ltx_cite ltx_citemacro_citep">(Weston
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib18" title="">2011</a>)</cite> and LambdaRank <cite class="ltx_cite ltx_citemacro_citep">(Burges, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib5" title="">2010</a>)</cite> depend on the position of the items in a ranked list as they try to encourage ranking relevant items at the top.
The rank of an item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_i</annotation></semantics></math> in an item set <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">caligraphic_I</annotation></semantics></math> using recommender <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_y</annotation></semantics></math> is defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r(i|c):=|\{j\in\mathcal{I}:y(j|c)&gt;y(i|c)\}|+1." class="ltx_math_unparsed" display="inline" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1b"><mi id="S3.E1.m1.1.1">r</mi><mrow id="S3.E1.m1.1.2"><mo id="S3.E1.m1.1.2.1" stretchy="false">(</mo><mi id="S3.E1.m1.1.2.2">i</mi><mo fence="false" id="S3.E1.m1.1.2.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E1.m1.1.2.4">c</mi><mo id="S3.E1.m1.1.2.5" rspace="0.278em" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.1.3" rspace="0em">:=</mo><mo fence="false" id="S3.E1.m1.1.4" rspace="0.167em" stretchy="false">|</mo><mrow id="S3.E1.m1.1.5"><mo id="S3.E1.m1.1.5.1" stretchy="false">{</mo><mi id="S3.E1.m1.1.5.2">j</mi><mo id="S3.E1.m1.1.5.3">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.5.4">ℐ</mi><mo id="S3.E1.m1.1.5.5" lspace="0.278em" rspace="0.278em">:</mo><mi id="S3.E1.m1.1.5.6">y</mi><mrow id="S3.E1.m1.1.5.7"><mo id="S3.E1.m1.1.5.7.1" stretchy="false">(</mo><mi id="S3.E1.m1.1.5.7.2">j</mi><mo fence="false" id="S3.E1.m1.1.5.7.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E1.m1.1.5.7.4">c</mi><mo id="S3.E1.m1.1.5.7.5" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.1.5.8">&gt;</mo><mi id="S3.E1.m1.1.5.9">y</mi><mrow id="S3.E1.m1.1.5.10"><mo id="S3.E1.m1.1.5.10.1" stretchy="false">(</mo><mi id="S3.E1.m1.1.5.10.2">i</mi><mo fence="false" id="S3.E1.m1.1.5.10.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E1.m1.1.5.10.4">c</mi><mo id="S3.E1.m1.1.5.10.5" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.1.5.11" stretchy="false">}</mo></mrow><mo fence="false" id="S3.E1.m1.1.6" stretchy="false">|</mo><mo id="S3.E1.m1.1.7" lspace="0em">+</mo><mn id="S3.E1.m1.1.8">1</mn><mo id="S3.E1.m1.1.9" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle r(i|c):=|\{j\in\mathcal{I}:y(j|c)&gt;y(i|c)\}|+1.</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_r ( italic_i | italic_c ) := | { italic_j ∈ caligraphic_I : italic_y ( italic_j | italic_c ) &gt; italic_y ( italic_i | italic_c ) } | + 1 .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.4">Computing the rank requires scoring all items in <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m1.1"><semantics id="S3.SS1.p1.4.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m1.1.1" xref="S3.SS1.p1.4.m1.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m1.1b"><ci id="S3.SS1.p1.4.m1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m1.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m1.1d">caligraphic_I</annotation></semantics></math> and therefore is an expensive operation.
This is especially expensive when the item catalog is large.
In this work, we investigate speeding up this step by sampling with rank correction methods.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>WARP and LambdaRank</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6">WARP and LambdaRank are iterative algorithms that draw one positive observation and one negative observation and apply a gradient step on this sampled pair of items.
See algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#alg1" title="Algorithm 1 ‣ 3. Problem Setting ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">1</span></a> for a generalized algorithm <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib14" title="">2022</a>)</cite>.
WARP and LambdaRank differ in (i) how they sample the negative item (i.e., in <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_q</annotation></semantics></math>) and (ii) how they weight the update (i.e., <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_α</annotation></semantics></math>).
We will discuss these two choices next.
For WARP, the negative item is drawn with a rejection sampling algorithm.
In particular, WARP draws candidate items uniformly until it finds a candidate <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_j</annotation></semantics></math> such that <math alttext="l(c,i,j)&gt;0" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.3"><semantics id="S3.SS2.p1.4.m4.3a"><mrow id="S3.SS2.p1.4.m4.3.4" xref="S3.SS2.p1.4.m4.3.4.cmml"><mrow id="S3.SS2.p1.4.m4.3.4.2" xref="S3.SS2.p1.4.m4.3.4.2.cmml"><mi id="S3.SS2.p1.4.m4.3.4.2.2" xref="S3.SS2.p1.4.m4.3.4.2.2.cmml">l</mi><mo id="S3.SS2.p1.4.m4.3.4.2.1" xref="S3.SS2.p1.4.m4.3.4.2.1.cmml">⁢</mo><mrow id="S3.SS2.p1.4.m4.3.4.2.3.2" xref="S3.SS2.p1.4.m4.3.4.2.3.1.cmml"><mo id="S3.SS2.p1.4.m4.3.4.2.3.2.1" stretchy="false" xref="S3.SS2.p1.4.m4.3.4.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">c</mi><mo id="S3.SS2.p1.4.m4.3.4.2.3.2.2" xref="S3.SS2.p1.4.m4.3.4.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.4.m4.2.2" xref="S3.SS2.p1.4.m4.2.2.cmml">i</mi><mo id="S3.SS2.p1.4.m4.3.4.2.3.2.3" xref="S3.SS2.p1.4.m4.3.4.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.4.m4.3.3" xref="S3.SS2.p1.4.m4.3.3.cmml">j</mi><mo id="S3.SS2.p1.4.m4.3.4.2.3.2.4" stretchy="false" xref="S3.SS2.p1.4.m4.3.4.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.4.m4.3.4.1" xref="S3.SS2.p1.4.m4.3.4.1.cmml">&gt;</mo><mn id="S3.SS2.p1.4.m4.3.4.3" xref="S3.SS2.p1.4.m4.3.4.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.3b"><apply id="S3.SS2.p1.4.m4.3.4.cmml" xref="S3.SS2.p1.4.m4.3.4"><gt id="S3.SS2.p1.4.m4.3.4.1.cmml" xref="S3.SS2.p1.4.m4.3.4.1"></gt><apply id="S3.SS2.p1.4.m4.3.4.2.cmml" xref="S3.SS2.p1.4.m4.3.4.2"><times id="S3.SS2.p1.4.m4.3.4.2.1.cmml" xref="S3.SS2.p1.4.m4.3.4.2.1"></times><ci id="S3.SS2.p1.4.m4.3.4.2.2.cmml" xref="S3.SS2.p1.4.m4.3.4.2.2">𝑙</ci><vector id="S3.SS2.p1.4.m4.3.4.2.3.1.cmml" xref="S3.SS2.p1.4.m4.3.4.2.3.2"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑐</ci><ci id="S3.SS2.p1.4.m4.2.2.cmml" xref="S3.SS2.p1.4.m4.2.2">𝑖</ci><ci id="S3.SS2.p1.4.m4.3.3.cmml" xref="S3.SS2.p1.4.m4.3.3">𝑗</ci></vector></apply><cn id="S3.SS2.p1.4.m4.3.4.3.cmml" type="integer" xref="S3.SS2.p1.4.m4.3.4.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.3c">l(c,i,j)&gt;0</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.3d">italic_l ( italic_c , italic_i , italic_j ) &gt; 0</annotation></semantics></math>, where <math alttext="l" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_l</annotation></semantics></math> is a pairwise loss function (see eqs. <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S3.E2" title="In 3.2. WARP and LambdaRank ‣ 3. Problem Setting ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S3.E3" title="In 3.2. WARP and LambdaRank ‣ 3. Problem Setting ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">3</span></a>).
If the rejection algorithm cannot find a candidate in a predefined number of steps, it will exit and discard the step.
For LambdaRank, negative items are drawn uniformly without any rejection step, i.e., <math alttext="q(j|c,i)=\frac{1}{|\mathcal{I}|-1}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.4"><semantics id="S3.SS2.p1.6.m6.4a"><mrow id="S3.SS2.p1.6.m6.4.4" xref="S3.SS2.p1.6.m6.4.4.cmml"><mrow id="S3.SS2.p1.6.m6.4.4.1" xref="S3.SS2.p1.6.m6.4.4.1.cmml"><mi id="S3.SS2.p1.6.m6.4.4.1.3" xref="S3.SS2.p1.6.m6.4.4.1.3.cmml">q</mi><mo id="S3.SS2.p1.6.m6.4.4.1.2" xref="S3.SS2.p1.6.m6.4.4.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.6.m6.4.4.1.1.1" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.cmml"><mo id="S3.SS2.p1.6.m6.4.4.1.1.1.2" stretchy="false" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.6.m6.4.4.1.1.1.1" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.cmml"><mi id="S3.SS2.p1.6.m6.4.4.1.1.1.1.2" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.2.cmml">j</mi><mo fence="false" id="S3.SS2.p1.6.m6.4.4.1.1.1.1.1" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.1.cmml">|</mo><mrow id="S3.SS2.p1.6.m6.4.4.1.1.1.1.3.2" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.3.1.cmml"><mi id="S3.SS2.p1.6.m6.2.2" xref="S3.SS2.p1.6.m6.2.2.cmml">c</mi><mo id="S3.SS2.p1.6.m6.4.4.1.1.1.1.3.2.1" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p1.6.m6.3.3" xref="S3.SS2.p1.6.m6.3.3.cmml">i</mi></mrow></mrow><mo id="S3.SS2.p1.6.m6.4.4.1.1.1.3" stretchy="false" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.6.m6.4.4.2" xref="S3.SS2.p1.6.m6.4.4.2.cmml">=</mo><mfrac id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mn id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">1</mn><mrow id="S3.SS2.p1.6.m6.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.cmml"><mrow id="S3.SS2.p1.6.m6.1.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.1.3.1.cmml"><mo id="S3.SS2.p1.6.m6.1.1.1.3.2.1" stretchy="false" xref="S3.SS2.p1.6.m6.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.cmml">ℐ</mi><mo id="S3.SS2.p1.6.m6.1.1.1.3.2.2" stretchy="false" xref="S3.SS2.p1.6.m6.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S3.SS2.p1.6.m6.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.2.cmml">−</mo><mn id="S3.SS2.p1.6.m6.1.1.1.4" xref="S3.SS2.p1.6.m6.1.1.1.4.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.4b"><apply id="S3.SS2.p1.6.m6.4.4.cmml" xref="S3.SS2.p1.6.m6.4.4"><eq id="S3.SS2.p1.6.m6.4.4.2.cmml" xref="S3.SS2.p1.6.m6.4.4.2"></eq><apply id="S3.SS2.p1.6.m6.4.4.1.cmml" xref="S3.SS2.p1.6.m6.4.4.1"><times id="S3.SS2.p1.6.m6.4.4.1.2.cmml" xref="S3.SS2.p1.6.m6.4.4.1.2"></times><ci id="S3.SS2.p1.6.m6.4.4.1.3.cmml" xref="S3.SS2.p1.6.m6.4.4.1.3">𝑞</ci><apply id="S3.SS2.p1.6.m6.4.4.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.4.4.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.6.m6.4.4.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.6.m6.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.2">𝑗</ci><list id="S3.SS2.p1.6.m6.4.4.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.4.4.1.1.1.1.3.2"><ci id="S3.SS2.p1.6.m6.2.2.cmml" xref="S3.SS2.p1.6.m6.2.2">𝑐</ci><ci id="S3.SS2.p1.6.m6.3.3.cmml" xref="S3.SS2.p1.6.m6.3.3">𝑖</ci></list></apply></apply><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><divide id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1"></divide><cn id="S3.SS2.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS2.p1.6.m6.1.1.3">1</cn><apply id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1"><minus id="S3.SS2.p1.6.m6.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.2"></minus><apply id="S3.SS2.p1.6.m6.1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.3.2"><abs id="S3.SS2.p1.6.m6.1.1.1.3.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.3.2.1"></abs><ci id="S3.SS2.p1.6.m6.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1">ℐ</ci></apply><cn id="S3.SS2.p1.6.m6.1.1.1.4.cmml" type="integer" xref="S3.SS2.p1.6.m6.1.1.1.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.4c">q(j|c,i)=\frac{1}{|\mathcal{I}|-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.4d">italic_q ( italic_j | italic_c , italic_i ) = divide start_ARG 1 end_ARG start_ARG | caligraphic_I | - 1 end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.10">The weighting function <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_α</annotation></semantics></math> of LambdaRank depends on the rank <math alttext="r(i|c)" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">r</mi><mo id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.2.m2.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.2.m2.1.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S3.SS2.p2.2.m2.1.1.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p2.2.m2.1.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS2.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><times id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2"></times><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑟</ci><apply id="S3.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.2">𝑖</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.1.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">r(i|c)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_r ( italic_i | italic_c )</annotation></semantics></math> of the positive item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_i</annotation></semantics></math> and the rank of the negative item <math alttext="j" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_j</annotation></semantics></math> and is <math alttext="\alpha(c,i,j)=|\mathrm{NDCG}(r(i|c))-\mathrm{NDCG}(r(j|c))|" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.5.m5.3"><semantics id="S3.SS2.p2.5.m5.3a"><mrow id="S3.SS2.p2.5.m5.3b"><mi id="S3.SS2.p2.5.m5.3.4">α</mi><mrow id="S3.SS2.p2.5.m5.3.5"><mo id="S3.SS2.p2.5.m5.3.5.1" stretchy="false">(</mo><mi id="S3.SS2.p2.5.m5.1.1">c</mi><mo id="S3.SS2.p2.5.m5.3.5.2">,</mo><mi id="S3.SS2.p2.5.m5.2.2">i</mi><mo id="S3.SS2.p2.5.m5.3.5.3">,</mo><mi id="S3.SS2.p2.5.m5.3.3">j</mi><mo id="S3.SS2.p2.5.m5.3.5.4" stretchy="false">)</mo></mrow><mo id="S3.SS2.p2.5.m5.3.6" rspace="0em">=</mo><mo fence="false" id="S3.SS2.p2.5.m5.3.7" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS2.p2.5.m5.3.8">NDCG</mi><mrow id="S3.SS2.p2.5.m5.3.9"><mo id="S3.SS2.p2.5.m5.3.9.1" stretchy="false">(</mo><mi id="S3.SS2.p2.5.m5.3.9.2">r</mi><mrow id="S3.SS2.p2.5.m5.3.9.3"><mo id="S3.SS2.p2.5.m5.3.9.3.1" stretchy="false">(</mo><mi id="S3.SS2.p2.5.m5.3.9.3.2">i</mi><mo fence="false" id="S3.SS2.p2.5.m5.3.9.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS2.p2.5.m5.3.9.3.4">c</mi><mo id="S3.SS2.p2.5.m5.3.9.3.5" stretchy="false">)</mo></mrow><mo id="S3.SS2.p2.5.m5.3.9.4" stretchy="false">)</mo></mrow><mo id="S3.SS2.p2.5.m5.3.10">−</mo><mi id="S3.SS2.p2.5.m5.3.11">NDCG</mi><mrow id="S3.SS2.p2.5.m5.3.12"><mo id="S3.SS2.p2.5.m5.3.12.1" stretchy="false">(</mo><mi id="S3.SS2.p2.5.m5.3.12.2">r</mi><mrow id="S3.SS2.p2.5.m5.3.12.3"><mo id="S3.SS2.p2.5.m5.3.12.3.1" stretchy="false">(</mo><mi id="S3.SS2.p2.5.m5.3.12.3.2">j</mi><mo fence="false" id="S3.SS2.p2.5.m5.3.12.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.SS2.p2.5.m5.3.12.3.4">c</mi><mo id="S3.SS2.p2.5.m5.3.12.3.5" stretchy="false">)</mo></mrow><mo id="S3.SS2.p2.5.m5.3.12.4" stretchy="false">)</mo></mrow><mo fence="false" id="S3.SS2.p2.5.m5.3.13" stretchy="false">|</mo></mrow><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.3c">\alpha(c,i,j)=|\mathrm{NDCG}(r(i|c))-\mathrm{NDCG}(r(j|c))|</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.3d">italic_α ( italic_c , italic_i , italic_j ) = | roman_NDCG ( italic_r ( italic_i | italic_c ) ) - roman_NDCG ( italic_r ( italic_j | italic_c ) ) |</annotation></semantics></math>.
This rank is computed over all items <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">caligraphic_I</annotation></semantics></math>.
The weighting function, <math alttext="\alpha" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_α</annotation></semantics></math> of WARP depends only on the rank of the positive item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><mi id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><ci id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">italic_i</annotation></semantics></math>.
However instead of computing this rank over all items, WARP estimates this rank, <math alttext="\hat{r}" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m9.1"><semantics id="S3.SS2.p2.9.m9.1a"><mover accent="true" id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">r</mi><mo id="S3.SS2.p2.9.m9.1.1.1" xref="S3.SS2.p2.9.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><ci id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1.1">^</ci><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">\hat{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m9.1d">over^ start_ARG italic_r end_ARG</annotation></semantics></math>, based on how many steps the rejection algorithm was run.
The weighting function is <math alttext="\alpha(c,i,j)=\sum_{r=1}^{\hat{r}(i|c)}\frac{1}{r}" class="ltx_Math" display="inline" id="S3.SS2.p2.10.m10.4"><semantics id="S3.SS2.p2.10.m10.4a"><mrow id="S3.SS2.p2.10.m10.4.5" xref="S3.SS2.p2.10.m10.4.5.cmml"><mrow id="S3.SS2.p2.10.m10.4.5.2" xref="S3.SS2.p2.10.m10.4.5.2.cmml"><mi id="S3.SS2.p2.10.m10.4.5.2.2" xref="S3.SS2.p2.10.m10.4.5.2.2.cmml">α</mi><mo id="S3.SS2.p2.10.m10.4.5.2.1" xref="S3.SS2.p2.10.m10.4.5.2.1.cmml">⁢</mo><mrow id="S3.SS2.p2.10.m10.4.5.2.3.2" xref="S3.SS2.p2.10.m10.4.5.2.3.1.cmml"><mo id="S3.SS2.p2.10.m10.4.5.2.3.2.1" stretchy="false" xref="S3.SS2.p2.10.m10.4.5.2.3.1.cmml">(</mo><mi id="S3.SS2.p2.10.m10.2.2" xref="S3.SS2.p2.10.m10.2.2.cmml">c</mi><mo id="S3.SS2.p2.10.m10.4.5.2.3.2.2" xref="S3.SS2.p2.10.m10.4.5.2.3.1.cmml">,</mo><mi id="S3.SS2.p2.10.m10.3.3" xref="S3.SS2.p2.10.m10.3.3.cmml">i</mi><mo id="S3.SS2.p2.10.m10.4.5.2.3.2.3" xref="S3.SS2.p2.10.m10.4.5.2.3.1.cmml">,</mo><mi id="S3.SS2.p2.10.m10.4.4" xref="S3.SS2.p2.10.m10.4.4.cmml">j</mi><mo id="S3.SS2.p2.10.m10.4.5.2.3.2.4" stretchy="false" xref="S3.SS2.p2.10.m10.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p2.10.m10.4.5.1" rspace="0.111em" xref="S3.SS2.p2.10.m10.4.5.1.cmml">=</mo><mrow id="S3.SS2.p2.10.m10.4.5.3" xref="S3.SS2.p2.10.m10.4.5.3.cmml"><msubsup id="S3.SS2.p2.10.m10.4.5.3.1" xref="S3.SS2.p2.10.m10.4.5.3.1.cmml"><mo id="S3.SS2.p2.10.m10.4.5.3.1.2.2" xref="S3.SS2.p2.10.m10.4.5.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p2.10.m10.4.5.3.1.2.3" xref="S3.SS2.p2.10.m10.4.5.3.1.2.3.cmml"><mi id="S3.SS2.p2.10.m10.4.5.3.1.2.3.2" xref="S3.SS2.p2.10.m10.4.5.3.1.2.3.2.cmml">r</mi><mo id="S3.SS2.p2.10.m10.4.5.3.1.2.3.1" xref="S3.SS2.p2.10.m10.4.5.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p2.10.m10.4.5.3.1.2.3.3" xref="S3.SS2.p2.10.m10.4.5.3.1.2.3.3.cmml">1</mn></mrow><mrow id="S3.SS2.p2.10.m10.1.1.1" xref="S3.SS2.p2.10.m10.1.1.1.cmml"><mover accent="true" id="S3.SS2.p2.10.m10.1.1.1.3" xref="S3.SS2.p2.10.m10.1.1.1.3.cmml"><mi id="S3.SS2.p2.10.m10.1.1.1.3.2" xref="S3.SS2.p2.10.m10.1.1.1.3.2.cmml">r</mi><mo id="S3.SS2.p2.10.m10.1.1.1.3.1" xref="S3.SS2.p2.10.m10.1.1.1.3.1.cmml">^</mo></mover><mo id="S3.SS2.p2.10.m10.1.1.1.2" xref="S3.SS2.p2.10.m10.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p2.10.m10.1.1.1.1.1" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.cmml"><mo id="S3.SS2.p2.10.m10.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.10.m10.1.1.1.1.1.1" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.10.m10.1.1.1.1.1.1.2" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S3.SS2.p2.10.m10.1.1.1.1.1.1.1" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p2.10.m10.1.1.1.1.1.1.3" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S3.SS2.p2.10.m10.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msubsup><mfrac id="S3.SS2.p2.10.m10.4.5.3.2" xref="S3.SS2.p2.10.m10.4.5.3.2.cmml"><mn id="S3.SS2.p2.10.m10.4.5.3.2.2" xref="S3.SS2.p2.10.m10.4.5.3.2.2.cmml">1</mn><mi id="S3.SS2.p2.10.m10.4.5.3.2.3" xref="S3.SS2.p2.10.m10.4.5.3.2.3.cmml">r</mi></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.4b"><apply id="S3.SS2.p2.10.m10.4.5.cmml" xref="S3.SS2.p2.10.m10.4.5"><eq id="S3.SS2.p2.10.m10.4.5.1.cmml" xref="S3.SS2.p2.10.m10.4.5.1"></eq><apply id="S3.SS2.p2.10.m10.4.5.2.cmml" xref="S3.SS2.p2.10.m10.4.5.2"><times id="S3.SS2.p2.10.m10.4.5.2.1.cmml" xref="S3.SS2.p2.10.m10.4.5.2.1"></times><ci id="S3.SS2.p2.10.m10.4.5.2.2.cmml" xref="S3.SS2.p2.10.m10.4.5.2.2">𝛼</ci><vector id="S3.SS2.p2.10.m10.4.5.2.3.1.cmml" xref="S3.SS2.p2.10.m10.4.5.2.3.2"><ci id="S3.SS2.p2.10.m10.2.2.cmml" xref="S3.SS2.p2.10.m10.2.2">𝑐</ci><ci id="S3.SS2.p2.10.m10.3.3.cmml" xref="S3.SS2.p2.10.m10.3.3">𝑖</ci><ci id="S3.SS2.p2.10.m10.4.4.cmml" xref="S3.SS2.p2.10.m10.4.4">𝑗</ci></vector></apply><apply id="S3.SS2.p2.10.m10.4.5.3.cmml" xref="S3.SS2.p2.10.m10.4.5.3"><apply id="S3.SS2.p2.10.m10.4.5.3.1.cmml" xref="S3.SS2.p2.10.m10.4.5.3.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m10.4.5.3.1.1.cmml" xref="S3.SS2.p2.10.m10.4.5.3.1">superscript</csymbol><apply id="S3.SS2.p2.10.m10.4.5.3.1.2.cmml" xref="S3.SS2.p2.10.m10.4.5.3.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m10.4.5.3.1.2.1.cmml" xref="S3.SS2.p2.10.m10.4.5.3.1">subscript</csymbol><sum id="S3.SS2.p2.10.m10.4.5.3.1.2.2.cmml" xref="S3.SS2.p2.10.m10.4.5.3.1.2.2"></sum><apply id="S3.SS2.p2.10.m10.4.5.3.1.2.3.cmml" xref="S3.SS2.p2.10.m10.4.5.3.1.2.3"><eq id="S3.SS2.p2.10.m10.4.5.3.1.2.3.1.cmml" xref="S3.SS2.p2.10.m10.4.5.3.1.2.3.1"></eq><ci id="S3.SS2.p2.10.m10.4.5.3.1.2.3.2.cmml" xref="S3.SS2.p2.10.m10.4.5.3.1.2.3.2">𝑟</ci><cn id="S3.SS2.p2.10.m10.4.5.3.1.2.3.3.cmml" type="integer" xref="S3.SS2.p2.10.m10.4.5.3.1.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p2.10.m10.1.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1.1"><times id="S3.SS2.p2.10.m10.1.1.1.2.cmml" xref="S3.SS2.p2.10.m10.1.1.1.2"></times><apply id="S3.SS2.p2.10.m10.1.1.1.3.cmml" xref="S3.SS2.p2.10.m10.1.1.1.3"><ci id="S3.SS2.p2.10.m10.1.1.1.3.1.cmml" xref="S3.SS2.p2.10.m10.1.1.1.3.1">^</ci><ci id="S3.SS2.p2.10.m10.1.1.1.3.2.cmml" xref="S3.SS2.p2.10.m10.1.1.1.3.2">𝑟</ci></apply><apply id="S3.SS2.p2.10.m10.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.2">𝑖</ci><ci id="S3.SS2.p2.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.10.m10.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply><apply id="S3.SS2.p2.10.m10.4.5.3.2.cmml" xref="S3.SS2.p2.10.m10.4.5.3.2"><divide id="S3.SS2.p2.10.m10.4.5.3.2.1.cmml" xref="S3.SS2.p2.10.m10.4.5.3.2"></divide><cn id="S3.SS2.p2.10.m10.4.5.3.2.2.cmml" type="integer" xref="S3.SS2.p2.10.m10.4.5.3.2.2">1</cn><ci id="S3.SS2.p2.10.m10.4.5.3.2.3.cmml" xref="S3.SS2.p2.10.m10.4.5.3.2.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.4c">\alpha(c,i,j)=\sum_{r=1}^{\hat{r}(i|c)}\frac{1}{r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m10.4d">italic_α ( italic_c , italic_i , italic_j ) = ∑ start_POSTSUBSCRIPT italic_r = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT over^ start_ARG italic_r end_ARG ( italic_i | italic_c ) end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_r end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">WARP employs usually a pairwise hinge loss, i.e.,</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx2">
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle l(c,i,j)=\max(0,1-(y(c,i)-y(c,j)))" class="ltx_Math" display="inline" id="S3.E2.m1.10"><semantics id="S3.E2.m1.10a"><mrow id="S3.E2.m1.10.10" xref="S3.E2.m1.10.10.cmml"><mrow id="S3.E2.m1.10.10.3" xref="S3.E2.m1.10.10.3.cmml"><mi id="S3.E2.m1.10.10.3.2" xref="S3.E2.m1.10.10.3.2.cmml">l</mi><mo id="S3.E2.m1.10.10.3.1" xref="S3.E2.m1.10.10.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.3.3.2" xref="S3.E2.m1.10.10.3.3.1.cmml"><mo id="S3.E2.m1.10.10.3.3.2.1" stretchy="false" xref="S3.E2.m1.10.10.3.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">c</mi><mo id="S3.E2.m1.10.10.3.3.2.2" xref="S3.E2.m1.10.10.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">i</mi><mo id="S3.E2.m1.10.10.3.3.2.3" xref="S3.E2.m1.10.10.3.3.1.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">j</mi><mo id="S3.E2.m1.10.10.3.3.2.4" stretchy="false" xref="S3.E2.m1.10.10.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.2" xref="S3.E2.m1.10.10.2.cmml">=</mo><mrow id="S3.E2.m1.10.10.1.1" xref="S3.E2.m1.10.10.1.2.cmml"><mi id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml">max</mi><mo id="S3.E2.m1.10.10.1.1a" xref="S3.E2.m1.10.10.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.10.10.1.1.1" xref="S3.E2.m1.10.10.1.2.cmml"><mo id="S3.E2.m1.10.10.1.1.1.2" stretchy="false" xref="S3.E2.m1.10.10.1.2.cmml">(</mo><mn id="S3.E2.m1.9.9" xref="S3.E2.m1.9.9.cmml">0</mn><mo id="S3.E2.m1.10.10.1.1.1.3" xref="S3.E2.m1.10.10.1.2.cmml">,</mo><mrow id="S3.E2.m1.10.10.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.cmml"><mn id="S3.E2.m1.10.10.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.3.cmml">1</mn><mo id="S3.E2.m1.10.10.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.2.cmml">−</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.2" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">c</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">i</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.2.cmml">y</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">c</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.2.2" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">j</mi><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.1.1.1.1.3" stretchy="false" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.10.10.1.1.1.4" stretchy="false" xref="S3.E2.m1.10.10.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.10b"><apply id="S3.E2.m1.10.10.cmml" xref="S3.E2.m1.10.10"><eq id="S3.E2.m1.10.10.2.cmml" xref="S3.E2.m1.10.10.2"></eq><apply id="S3.E2.m1.10.10.3.cmml" xref="S3.E2.m1.10.10.3"><times id="S3.E2.m1.10.10.3.1.cmml" xref="S3.E2.m1.10.10.3.1"></times><ci id="S3.E2.m1.10.10.3.2.cmml" xref="S3.E2.m1.10.10.3.2">𝑙</ci><vector id="S3.E2.m1.10.10.3.3.1.cmml" xref="S3.E2.m1.10.10.3.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝑐</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑖</ci><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑗</ci></vector></apply><apply id="S3.E2.m1.10.10.1.2.cmml" xref="S3.E2.m1.10.10.1.1"><max id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8"></max><cn id="S3.E2.m1.9.9.cmml" type="integer" xref="S3.E2.m1.9.9">0</cn><apply id="S3.E2.m1.10.10.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1"><minus id="S3.E2.m1.10.10.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.2"></minus><cn id="S3.E2.m1.10.10.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.10.10.1.1.1.1.3">1</cn><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1"><minus id="S3.E2.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2"><times id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.1"></times><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.2">𝑦</ci><interval closure="open" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.2.3.2"><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝑐</ci><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝑖</ci></interval></apply><apply id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3"><times id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.2">𝑦</ci><interval closure="open" id="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.10.10.1.1.1.1.1.1.1.3.3.2"><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">𝑐</ci><ci id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7">𝑗</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.10c">\displaystyle l(c,i,j)=\max(0,1-(y(c,i)-y(c,j)))</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.10d">italic_l ( italic_c , italic_i , italic_j ) = roman_max ( 0 , 1 - ( italic_y ( italic_c , italic_i ) - italic_y ( italic_c , italic_j ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.2">and LambdaRank a pairwise logistic loss</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx3">
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle l(c,i,j)=\ln\sigma(y(c,i)-y(c,j))." class="ltx_Math" display="inline" id="S3.E3.m1.8"><semantics id="S3.E3.m1.8a"><mrow id="S3.E3.m1.8.8.1" xref="S3.E3.m1.8.8.1.1.cmml"><mrow id="S3.E3.m1.8.8.1.1" xref="S3.E3.m1.8.8.1.1.cmml"><mrow id="S3.E3.m1.8.8.1.1.3" xref="S3.E3.m1.8.8.1.1.3.cmml"><mi id="S3.E3.m1.8.8.1.1.3.2" xref="S3.E3.m1.8.8.1.1.3.2.cmml">l</mi><mo id="S3.E3.m1.8.8.1.1.3.1" xref="S3.E3.m1.8.8.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.8.8.1.1.3.3.2" xref="S3.E3.m1.8.8.1.1.3.3.1.cmml"><mo id="S3.E3.m1.8.8.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.8.8.1.1.3.3.1.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">c</mi><mo id="S3.E3.m1.8.8.1.1.3.3.2.2" xref="S3.E3.m1.8.8.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">i</mi><mo id="S3.E3.m1.8.8.1.1.3.3.2.3" xref="S3.E3.m1.8.8.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">j</mi><mo id="S3.E3.m1.8.8.1.1.3.3.2.4" stretchy="false" xref="S3.E3.m1.8.8.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.8.8.1.1.2" xref="S3.E3.m1.8.8.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.8.8.1.1.1" xref="S3.E3.m1.8.8.1.1.1.cmml"><mrow id="S3.E3.m1.8.8.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.3.cmml"><mi id="S3.E3.m1.8.8.1.1.1.3.1" xref="S3.E3.m1.8.8.1.1.1.3.1.cmml">ln</mi><mo id="S3.E3.m1.8.8.1.1.1.3a" lspace="0.167em" xref="S3.E3.m1.8.8.1.1.1.3.cmml">⁡</mo><mi id="S3.E3.m1.8.8.1.1.1.3.2" xref="S3.E3.m1.8.8.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S3.E3.m1.8.8.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.8.8.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.1.1.2.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.2.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.1.cmml"><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.2.1" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.1.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">c</mi><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.2.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.1.cmml">,</mo><mi id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">i</mi><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.2.3" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1.3" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.8.8.1.1.1.1.1.1.3.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.2.cmml">y</mi><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.3.1" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E3.m1.6.6" xref="S3.E3.m1.6.6.cmml">c</mi><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.2.2" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E3.m1.7.7" xref="S3.E3.m1.7.7.cmml">j</mi><mo id="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.2.3" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.8.8.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.8.8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.8.8.1.2" lspace="0em" xref="S3.E3.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.8b"><apply id="S3.E3.m1.8.8.1.1.cmml" xref="S3.E3.m1.8.8.1"><eq id="S3.E3.m1.8.8.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.2"></eq><apply id="S3.E3.m1.8.8.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.3"><times id="S3.E3.m1.8.8.1.1.3.1.cmml" xref="S3.E3.m1.8.8.1.1.3.1"></times><ci id="S3.E3.m1.8.8.1.1.3.2.cmml" xref="S3.E3.m1.8.8.1.1.3.2">𝑙</ci><vector id="S3.E3.m1.8.8.1.1.3.3.1.cmml" xref="S3.E3.m1.8.8.1.1.3.3.2"><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑐</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝑖</ci><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝑗</ci></vector></apply><apply id="S3.E3.m1.8.8.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1"><times id="S3.E3.m1.8.8.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.2"></times><apply id="S3.E3.m1.8.8.1.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.3"><ln id="S3.E3.m1.8.8.1.1.1.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.3.1"></ln><ci id="S3.E3.m1.8.8.1.1.1.3.2.cmml" xref="S3.E3.m1.8.8.1.1.1.3.2">𝜎</ci></apply><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1"><minus id="S3.E3.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.1"></minus><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2"><times id="S3.E3.m1.8.8.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.1"></times><ci id="S3.E3.m1.8.8.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.2">𝑦</ci><interval closure="open" id="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.2.3.2"><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑐</ci><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">𝑖</ci></interval></apply><apply id="S3.E3.m1.8.8.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3"><times id="S3.E3.m1.8.8.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.1"></times><ci id="S3.E3.m1.8.8.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.2">𝑦</ci><interval closure="open" id="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.8.8.1.1.1.1.1.1.3.3.2"><ci id="S3.E3.m1.6.6.cmml" xref="S3.E3.m1.6.6">𝑐</ci><ci id="S3.E3.m1.7.7.cmml" xref="S3.E3.m1.7.7">𝑗</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.8c">\displaystyle l(c,i,j)=\ln\sigma(y(c,i)-y(c,j)).</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.8d">italic_l ( italic_c , italic_i , italic_j ) = roman_ln italic_σ ( italic_y ( italic_c , italic_i ) - italic_y ( italic_c , italic_j ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p3.3">We want to highlight that computing the rank is a crucial operation for LambdaRank and WARP.
For LambdaRank this is computationally expensive because it computes the rank over all items.
This becomes costly for large catalogs.
WARP computes the rank through the rejection sampling algorithm.
Again, if the item is ranked high and the item catalog is large, then this operation is costly.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Batch Training with Negative Sampling</h2>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg2.2.1.1">Algorithm 2</span> </span> Sampled Batch Training</figcaption>
<div class="ltx_listing ltx_listing" id="alg2.3">
<div class="ltx_listingline" id="alg2.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l1.1.1.1" style="font-size:80%;">1:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l1.2">Input:</span> dataset <math alttext="\mathcal{S}" class="ltx_Math" display="inline" id="alg2.l1.m1.1"><semantics id="alg2.l1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">𝒮</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝒮</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\mathcal{S}</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m1.1d">caligraphic_S</annotation></semantics></math>, learning rate <math alttext="\eta" class="ltx_Math" display="inline" id="alg2.l1.m2.1"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="alg2.l1.m2.1d">italic_η</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l2.1.1.1" style="font-size:80%;">2:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l2.2">Output:</span> model parameters <math alttext="\theta" class="ltx_Math" display="inline" id="alg2.l2.m1.1"><semantics id="alg2.l2.m1.1a"><mi id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg2.l2.m1.1d">italic_θ</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg2.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l3.1.1.1" style="font-size:80%;">3:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l3.2">repeat</span>
</div>
<div class="ltx_listingline" id="alg2.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l4.2.1.1" style="font-size:80%;">4:</span></span>     sample <math alttext="\tilde{\mathcal{S}}\sim 2^{\mathcal{S}}" class="ltx_Math" display="inline" id="alg2.l4.m1.1"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mover accent="true" id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1.2.2" xref="alg2.l4.m1.1.1.2.2.cmml">𝒮</mi><mo id="alg2.l4.m1.1.1.2.1" xref="alg2.l4.m1.1.1.2.1.cmml">~</mo></mover><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">∼</mo><msup id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mn id="alg2.l4.m1.1.1.3.2" xref="alg2.l4.m1.1.1.3.2.cmml">2</mn><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">𝒮</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><csymbol cd="latexml" id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">similar-to</csymbol><apply id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2"><ci id="alg2.l4.m1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.2.1">~</ci><ci id="alg2.l4.m1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.2.2">𝒮</ci></apply><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3">superscript</csymbol><cn id="alg2.l4.m1.1.1.3.2.cmml" type="integer" xref="alg2.l4.m1.1.1.3.2">2</cn><ci id="alg2.l4.m1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.3.3">𝒮</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\tilde{\mathcal{S}}\sim 2^{\mathcal{S}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m1.1d">over~ start_ARG caligraphic_S end_ARG ∼ 2 start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT</annotation></semantics></math> s.th. <math alttext="|\tilde{\mathcal{S}}|=k" class="ltx_Math" display="inline" id="alg2.l4.m2.1"><semantics id="alg2.l4.m2.1a"><mrow id="alg2.l4.m2.1.2" xref="alg2.l4.m2.1.2.cmml"><mrow id="alg2.l4.m2.1.2.2.2" xref="alg2.l4.m2.1.2.2.1.cmml"><mo id="alg2.l4.m2.1.2.2.2.1" stretchy="false" xref="alg2.l4.m2.1.2.2.1.1.cmml">|</mo><mover accent="true" id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2.cmml">𝒮</mi><mo id="alg2.l4.m2.1.1.1" xref="alg2.l4.m2.1.1.1.cmml">~</mo></mover><mo id="alg2.l4.m2.1.2.2.2.2" stretchy="false" xref="alg2.l4.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="alg2.l4.m2.1.2.1" xref="alg2.l4.m2.1.2.1.cmml">=</mo><mi id="alg2.l4.m2.1.2.3" xref="alg2.l4.m2.1.2.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.2.cmml" xref="alg2.l4.m2.1.2"><eq id="alg2.l4.m2.1.2.1.cmml" xref="alg2.l4.m2.1.2.1"></eq><apply id="alg2.l4.m2.1.2.2.1.cmml" xref="alg2.l4.m2.1.2.2.2"><abs id="alg2.l4.m2.1.2.2.1.1.cmml" xref="alg2.l4.m2.1.2.2.2.1"></abs><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><ci id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1.1">~</ci><ci id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2">𝒮</ci></apply></apply><ci id="alg2.l4.m2.1.2.3.cmml" xref="alg2.l4.m2.1.2.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">|\tilde{\mathcal{S}}|=k</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.m2.1d">| over~ start_ARG caligraphic_S end_ARG | = italic_k</annotation></semantics></math> <span class="ltx_text" id="alg2.l4.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l4.1.m1.1"><semantics id="alg2.l4.1.m1.1a"><mo id="alg2.l4.1.m1.1.1" xref="alg2.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l4.1.m1.1b"><ci id="alg2.l4.1.m1.1.1.cmml" xref="alg2.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l4.1.m1.1d">▷</annotation></semantics></math> positive observations
</span>
</div>
<div class="ltx_listingline" id="alg2.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l5.2.1.1" style="font-size:80%;">5:</span></span>     sample <math alttext="\tilde{\mathcal{I}}\sim 2^{\mathcal{I}}" class="ltx_Math" display="inline" id="alg2.l5.m1.1"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mover accent="true" id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">ℐ</mi><mo id="alg2.l5.m1.1.1.2.1" xref="alg2.l5.m1.1.1.2.1.cmml">~</mo></mover><mo id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">∼</mo><msup id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"><mn id="alg2.l5.m1.1.1.3.2" xref="alg2.l5.m1.1.1.3.2.cmml">2</mn><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1.3.3" xref="alg2.l5.m1.1.1.3.3.cmml">ℐ</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><csymbol cd="latexml" id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">similar-to</csymbol><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><ci id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2.1">~</ci><ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">ℐ</ci></apply><apply id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.3">superscript</csymbol><cn id="alg2.l5.m1.1.1.3.2.cmml" type="integer" xref="alg2.l5.m1.1.1.3.2">2</cn><ci id="alg2.l5.m1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3">ℐ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\tilde{\mathcal{I}}\sim 2^{\mathcal{I}}</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m1.1d">over~ start_ARG caligraphic_I end_ARG ∼ 2 start_POSTSUPERSCRIPT caligraphic_I end_POSTSUPERSCRIPT</annotation></semantics></math> s.th. <math alttext="|\tilde{\mathcal{I}}|=m" class="ltx_Math" display="inline" id="alg2.l5.m2.1"><semantics id="alg2.l5.m2.1a"><mrow id="alg2.l5.m2.1.2" xref="alg2.l5.m2.1.2.cmml"><mrow id="alg2.l5.m2.1.2.2.2" xref="alg2.l5.m2.1.2.2.1.cmml"><mo id="alg2.l5.m2.1.2.2.2.1" stretchy="false" xref="alg2.l5.m2.1.2.2.1.1.cmml">|</mo><mover accent="true" id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m2.1.1.2" xref="alg2.l5.m2.1.1.2.cmml">ℐ</mi><mo id="alg2.l5.m2.1.1.1" xref="alg2.l5.m2.1.1.1.cmml">~</mo></mover><mo id="alg2.l5.m2.1.2.2.2.2" stretchy="false" xref="alg2.l5.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="alg2.l5.m2.1.2.1" xref="alg2.l5.m2.1.2.1.cmml">=</mo><mi id="alg2.l5.m2.1.2.3" xref="alg2.l5.m2.1.2.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><apply id="alg2.l5.m2.1.2.cmml" xref="alg2.l5.m2.1.2"><eq id="alg2.l5.m2.1.2.1.cmml" xref="alg2.l5.m2.1.2.1"></eq><apply id="alg2.l5.m2.1.2.2.1.cmml" xref="alg2.l5.m2.1.2.2.2"><abs id="alg2.l5.m2.1.2.2.1.1.cmml" xref="alg2.l5.m2.1.2.2.2.1"></abs><apply id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1"><ci id="alg2.l5.m2.1.1.1.cmml" xref="alg2.l5.m2.1.1.1">~</ci><ci id="alg2.l5.m2.1.1.2.cmml" xref="alg2.l5.m2.1.1.2">ℐ</ci></apply></apply><ci id="alg2.l5.m2.1.2.3.cmml" xref="alg2.l5.m2.1.2.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">|\tilde{\mathcal{I}}|=m</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.m2.1d">| over~ start_ARG caligraphic_I end_ARG | = italic_m</annotation></semantics></math> <span class="ltx_text" id="alg2.l5.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l5.1.m1.1"><semantics id="alg2.l5.1.m1.1a"><mo id="alg2.l5.1.m1.1.1" xref="alg2.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l5.1.m1.1b"><ci id="alg2.l5.1.m1.1.1.cmml" xref="alg2.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l5.1.m1.1d">▷</annotation></semantics></math> negative items
</span>
</div>
<div class="ltx_listingline" id="alg2.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l6.2.1.1" style="font-size:80%;">6:</span></span>     <math alttext="\theta\leftarrow\theta-\eta\,\sum_{j\in\tilde{\mathcal{I}}}\sum_{(c,i)\in%
\tilde{\mathcal{S}}}\alpha(c,i,j)\frac{\partial}{\partial\theta}l(c,i,j)" class="ltx_Math" display="inline" id="alg2.l6.m1.8"><semantics id="alg2.l6.m1.8a"><mrow id="alg2.l6.m1.8.9" xref="alg2.l6.m1.8.9.cmml"><mi id="alg2.l6.m1.8.9.2" xref="alg2.l6.m1.8.9.2.cmml">θ</mi><mo id="alg2.l6.m1.8.9.1" stretchy="false" xref="alg2.l6.m1.8.9.1.cmml">←</mo><mrow id="alg2.l6.m1.8.9.3" xref="alg2.l6.m1.8.9.3.cmml"><mi id="alg2.l6.m1.8.9.3.2" xref="alg2.l6.m1.8.9.3.2.cmml">θ</mi><mo id="alg2.l6.m1.8.9.3.1" xref="alg2.l6.m1.8.9.3.1.cmml">−</mo><mrow id="alg2.l6.m1.8.9.3.3" xref="alg2.l6.m1.8.9.3.3.cmml"><mi id="alg2.l6.m1.8.9.3.3.2" xref="alg2.l6.m1.8.9.3.3.2.cmml">η</mi><mo id="alg2.l6.m1.8.9.3.3.1" lspace="0.337em" xref="alg2.l6.m1.8.9.3.3.1.cmml">⁢</mo><mrow id="alg2.l6.m1.8.9.3.3.3" xref="alg2.l6.m1.8.9.3.3.3.cmml"><msub id="alg2.l6.m1.8.9.3.3.3.1" xref="alg2.l6.m1.8.9.3.3.3.1.cmml"><mo id="alg2.l6.m1.8.9.3.3.3.1.2" rspace="0em" xref="alg2.l6.m1.8.9.3.3.3.1.2.cmml">∑</mo><mrow id="alg2.l6.m1.8.9.3.3.3.1.3" xref="alg2.l6.m1.8.9.3.3.3.1.3.cmml"><mi id="alg2.l6.m1.8.9.3.3.3.1.3.2" xref="alg2.l6.m1.8.9.3.3.3.1.3.2.cmml">j</mi><mo id="alg2.l6.m1.8.9.3.3.3.1.3.1" xref="alg2.l6.m1.8.9.3.3.3.1.3.1.cmml">∈</mo><mover accent="true" id="alg2.l6.m1.8.9.3.3.3.1.3.3" xref="alg2.l6.m1.8.9.3.3.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.8.9.3.3.3.1.3.3.2" xref="alg2.l6.m1.8.9.3.3.3.1.3.3.2.cmml">ℐ</mi><mo id="alg2.l6.m1.8.9.3.3.3.1.3.3.1" xref="alg2.l6.m1.8.9.3.3.3.1.3.3.1.cmml">~</mo></mover></mrow></msub><mrow id="alg2.l6.m1.8.9.3.3.3.2" xref="alg2.l6.m1.8.9.3.3.3.2.cmml"><msub id="alg2.l6.m1.8.9.3.3.3.2.1" xref="alg2.l6.m1.8.9.3.3.3.2.1.cmml"><mo id="alg2.l6.m1.8.9.3.3.3.2.1.2" xref="alg2.l6.m1.8.9.3.3.3.2.1.2.cmml">∑</mo><mrow id="alg2.l6.m1.2.2.2" xref="alg2.l6.m1.2.2.2.cmml"><mrow id="alg2.l6.m1.2.2.2.4.2" xref="alg2.l6.m1.2.2.2.4.1.cmml"><mo id="alg2.l6.m1.2.2.2.4.2.1" stretchy="false" xref="alg2.l6.m1.2.2.2.4.1.cmml">(</mo><mi id="alg2.l6.m1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.cmml">c</mi><mo id="alg2.l6.m1.2.2.2.4.2.2" xref="alg2.l6.m1.2.2.2.4.1.cmml">,</mo><mi id="alg2.l6.m1.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.cmml">i</mi><mo id="alg2.l6.m1.2.2.2.4.2.3" stretchy="false" xref="alg2.l6.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="alg2.l6.m1.2.2.2.3" xref="alg2.l6.m1.2.2.2.3.cmml">∈</mo><mover accent="true" id="alg2.l6.m1.2.2.2.5" xref="alg2.l6.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l6.m1.2.2.2.5.2" xref="alg2.l6.m1.2.2.2.5.2.cmml">𝒮</mi><mo id="alg2.l6.m1.2.2.2.5.1" xref="alg2.l6.m1.2.2.2.5.1.cmml">~</mo></mover></mrow></msub><mrow id="alg2.l6.m1.8.9.3.3.3.2.2" xref="alg2.l6.m1.8.9.3.3.3.2.2.cmml"><mi id="alg2.l6.m1.8.9.3.3.3.2.2.2" xref="alg2.l6.m1.8.9.3.3.3.2.2.2.cmml">α</mi><mo id="alg2.l6.m1.8.9.3.3.3.2.2.1" xref="alg2.l6.m1.8.9.3.3.3.2.2.1.cmml">⁢</mo><mrow id="alg2.l6.m1.8.9.3.3.3.2.2.3.2" xref="alg2.l6.m1.8.9.3.3.3.2.2.3.1.cmml"><mo id="alg2.l6.m1.8.9.3.3.3.2.2.3.2.1" stretchy="false" xref="alg2.l6.m1.8.9.3.3.3.2.2.3.1.cmml">(</mo><mi id="alg2.l6.m1.3.3" xref="alg2.l6.m1.3.3.cmml">c</mi><mo id="alg2.l6.m1.8.9.3.3.3.2.2.3.2.2" xref="alg2.l6.m1.8.9.3.3.3.2.2.3.1.cmml">,</mo><mi id="alg2.l6.m1.4.4" xref="alg2.l6.m1.4.4.cmml">i</mi><mo id="alg2.l6.m1.8.9.3.3.3.2.2.3.2.3" xref="alg2.l6.m1.8.9.3.3.3.2.2.3.1.cmml">,</mo><mi id="alg2.l6.m1.5.5" xref="alg2.l6.m1.5.5.cmml">j</mi><mo id="alg2.l6.m1.8.9.3.3.3.2.2.3.2.4" stretchy="false" xref="alg2.l6.m1.8.9.3.3.3.2.2.3.1.cmml">)</mo></mrow><mo id="alg2.l6.m1.8.9.3.3.3.2.2.1a" xref="alg2.l6.m1.8.9.3.3.3.2.2.1.cmml">⁢</mo><mfrac id="alg2.l6.m1.8.9.3.3.3.2.2.4" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.cmml"><mo id="alg2.l6.m1.8.9.3.3.3.2.2.4.2" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.2.cmml">∂</mo><mrow id="alg2.l6.m1.8.9.3.3.3.2.2.4.3" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.3.cmml"><mo id="alg2.l6.m1.8.9.3.3.3.2.2.4.3.1" rspace="0em" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.3.1.cmml">∂</mo><mi id="alg2.l6.m1.8.9.3.3.3.2.2.4.3.2" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.3.2.cmml">θ</mi></mrow></mfrac><mo id="alg2.l6.m1.8.9.3.3.3.2.2.1b" xref="alg2.l6.m1.8.9.3.3.3.2.2.1.cmml">⁢</mo><mi id="alg2.l6.m1.8.9.3.3.3.2.2.5" xref="alg2.l6.m1.8.9.3.3.3.2.2.5.cmml">l</mi><mo id="alg2.l6.m1.8.9.3.3.3.2.2.1c" xref="alg2.l6.m1.8.9.3.3.3.2.2.1.cmml">⁢</mo><mrow id="alg2.l6.m1.8.9.3.3.3.2.2.6.2" xref="alg2.l6.m1.8.9.3.3.3.2.2.6.1.cmml"><mo id="alg2.l6.m1.8.9.3.3.3.2.2.6.2.1" stretchy="false" xref="alg2.l6.m1.8.9.3.3.3.2.2.6.1.cmml">(</mo><mi id="alg2.l6.m1.6.6" xref="alg2.l6.m1.6.6.cmml">c</mi><mo id="alg2.l6.m1.8.9.3.3.3.2.2.6.2.2" xref="alg2.l6.m1.8.9.3.3.3.2.2.6.1.cmml">,</mo><mi id="alg2.l6.m1.7.7" xref="alg2.l6.m1.7.7.cmml">i</mi><mo id="alg2.l6.m1.8.9.3.3.3.2.2.6.2.3" xref="alg2.l6.m1.8.9.3.3.3.2.2.6.1.cmml">,</mo><mi id="alg2.l6.m1.8.8" xref="alg2.l6.m1.8.8.cmml">j</mi><mo id="alg2.l6.m1.8.9.3.3.3.2.2.6.2.4" stretchy="false" xref="alg2.l6.m1.8.9.3.3.3.2.2.6.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.8b"><apply id="alg2.l6.m1.8.9.cmml" xref="alg2.l6.m1.8.9"><ci id="alg2.l6.m1.8.9.1.cmml" xref="alg2.l6.m1.8.9.1">←</ci><ci id="alg2.l6.m1.8.9.2.cmml" xref="alg2.l6.m1.8.9.2">𝜃</ci><apply id="alg2.l6.m1.8.9.3.cmml" xref="alg2.l6.m1.8.9.3"><minus id="alg2.l6.m1.8.9.3.1.cmml" xref="alg2.l6.m1.8.9.3.1"></minus><ci id="alg2.l6.m1.8.9.3.2.cmml" xref="alg2.l6.m1.8.9.3.2">𝜃</ci><apply id="alg2.l6.m1.8.9.3.3.cmml" xref="alg2.l6.m1.8.9.3.3"><times id="alg2.l6.m1.8.9.3.3.1.cmml" xref="alg2.l6.m1.8.9.3.3.1"></times><ci id="alg2.l6.m1.8.9.3.3.2.cmml" xref="alg2.l6.m1.8.9.3.3.2">𝜂</ci><apply id="alg2.l6.m1.8.9.3.3.3.cmml" xref="alg2.l6.m1.8.9.3.3.3"><apply id="alg2.l6.m1.8.9.3.3.3.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.1"><csymbol cd="ambiguous" id="alg2.l6.m1.8.9.3.3.3.1.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.1">subscript</csymbol><sum id="alg2.l6.m1.8.9.3.3.3.1.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.1.2"></sum><apply id="alg2.l6.m1.8.9.3.3.3.1.3.cmml" xref="alg2.l6.m1.8.9.3.3.3.1.3"><in id="alg2.l6.m1.8.9.3.3.3.1.3.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.1.3.1"></in><ci id="alg2.l6.m1.8.9.3.3.3.1.3.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.1.3.2">𝑗</ci><apply id="alg2.l6.m1.8.9.3.3.3.1.3.3.cmml" xref="alg2.l6.m1.8.9.3.3.3.1.3.3"><ci id="alg2.l6.m1.8.9.3.3.3.1.3.3.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.1.3.3.1">~</ci><ci id="alg2.l6.m1.8.9.3.3.3.1.3.3.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.1.3.3.2">ℐ</ci></apply></apply></apply><apply id="alg2.l6.m1.8.9.3.3.3.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.2"><apply id="alg2.l6.m1.8.9.3.3.3.2.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.1"><csymbol cd="ambiguous" id="alg2.l6.m1.8.9.3.3.3.2.1.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.1">subscript</csymbol><sum id="alg2.l6.m1.8.9.3.3.3.2.1.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.1.2"></sum><apply id="alg2.l6.m1.2.2.2.cmml" xref="alg2.l6.m1.2.2.2"><in id="alg2.l6.m1.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.3"></in><interval closure="open" id="alg2.l6.m1.2.2.2.4.1.cmml" xref="alg2.l6.m1.2.2.2.4.2"><ci id="alg2.l6.m1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1">𝑐</ci><ci id="alg2.l6.m1.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2">𝑖</ci></interval><apply id="alg2.l6.m1.2.2.2.5.cmml" xref="alg2.l6.m1.2.2.2.5"><ci id="alg2.l6.m1.2.2.2.5.1.cmml" xref="alg2.l6.m1.2.2.2.5.1">~</ci><ci id="alg2.l6.m1.2.2.2.5.2.cmml" xref="alg2.l6.m1.2.2.2.5.2">𝒮</ci></apply></apply></apply><apply id="alg2.l6.m1.8.9.3.3.3.2.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2"><times id="alg2.l6.m1.8.9.3.3.3.2.2.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.1"></times><ci id="alg2.l6.m1.8.9.3.3.3.2.2.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.2">𝛼</ci><vector id="alg2.l6.m1.8.9.3.3.3.2.2.3.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.3.2"><ci id="alg2.l6.m1.3.3.cmml" xref="alg2.l6.m1.3.3">𝑐</ci><ci id="alg2.l6.m1.4.4.cmml" xref="alg2.l6.m1.4.4">𝑖</ci><ci id="alg2.l6.m1.5.5.cmml" xref="alg2.l6.m1.5.5">𝑗</ci></vector><apply id="alg2.l6.m1.8.9.3.3.3.2.2.4.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.4"><divide id="alg2.l6.m1.8.9.3.3.3.2.2.4.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.4"></divide><partialdiff id="alg2.l6.m1.8.9.3.3.3.2.2.4.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.2"></partialdiff><apply id="alg2.l6.m1.8.9.3.3.3.2.2.4.3.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.3"><partialdiff id="alg2.l6.m1.8.9.3.3.3.2.2.4.3.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.3.1"></partialdiff><ci id="alg2.l6.m1.8.9.3.3.3.2.2.4.3.2.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.4.3.2">𝜃</ci></apply></apply><ci id="alg2.l6.m1.8.9.3.3.3.2.2.5.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.5">𝑙</ci><vector id="alg2.l6.m1.8.9.3.3.3.2.2.6.1.cmml" xref="alg2.l6.m1.8.9.3.3.3.2.2.6.2"><ci id="alg2.l6.m1.6.6.cmml" xref="alg2.l6.m1.6.6">𝑐</ci><ci id="alg2.l6.m1.7.7.cmml" xref="alg2.l6.m1.7.7">𝑖</ci><ci id="alg2.l6.m1.8.8.cmml" xref="alg2.l6.m1.8.8">𝑗</ci></vector></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.8c">\theta\leftarrow\theta-\eta\,\sum_{j\in\tilde{\mathcal{I}}}\sum_{(c,i)\in%
\tilde{\mathcal{S}}}\alpha(c,i,j)\frac{\partial}{\partial\theta}l(c,i,j)</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.m1.8d">italic_θ ← italic_θ - italic_η ∑ start_POSTSUBSCRIPT italic_j ∈ over~ start_ARG caligraphic_I end_ARG end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( italic_c , italic_i ) ∈ over~ start_ARG caligraphic_S end_ARG end_POSTSUBSCRIPT italic_α ( italic_c , italic_i , italic_j ) divide start_ARG ∂ end_ARG start_ARG ∂ italic_θ end_ARG italic_l ( italic_c , italic_i , italic_j )</annotation></semantics></math> <span class="ltx_text" id="alg2.l6.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg2.l6.1.m1.1"><semantics id="alg2.l6.1.m1.1a"><mo id="alg2.l6.1.m1.1.1" xref="alg2.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l6.1.m1.1b"><ci id="alg2.l6.1.m1.1.1.cmml" xref="alg2.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg2.l6.1.m1.1d">▷</annotation></semantics></math> grad. step
</span>
</div>
<div class="ltx_listingline" id="alg2.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l7.1.1.1" style="font-size:80%;">7:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l7.2">until</span> Convergence

</div>
<div class="ltx_listingline" id="alg2.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg2.l8.1.1.1" style="font-size:80%;">8:</span></span><span class="ltx_text ltx_font_bold" id="alg2.l8.2">return</span> <math alttext="\theta" class="ltx_Math" display="inline" id="alg2.l8.m1.1"><semantics id="alg2.l8.m1.1a"><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.1b"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="alg2.l8.m1.1d">italic_θ</annotation></semantics></math>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.3">Modern training algorithms make use of hardware that is designed for parallel execution.
The WARP and LambdaRank algorithms discussed so far are not well suited for modern hardware as they process one item at a time.
Especially the iterative rejection sampling algorithm of WARP is not a good fit.
We will propose now a simple variant that processes several negative and positive items in parallel.
Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#alg2" title="Algorithm 2 ‣ 4. Batch Training with Negative Sampling ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">2</span></a> shows this generalized algorithm.
It simply samples uniformly batches of <math alttext="k" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_k</annotation></semantics></math> positives and <math alttext="m" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_m</annotation></semantics></math> negatives.
A gradient step is applied to all <math alttext="k\times m" class="ltx_Math" display="inline" id="S4.p1.3.m3.1"><semantics id="S4.p1.3.m3.1a"><mrow id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><mi id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml">k</mi><mo id="S4.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.3.m3.1.1.1.cmml">×</mo><mi id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><times id="S4.p1.3.m3.1.1.1.cmml" xref="S4.p1.3.m3.1.1.1"></times><ci id="S4.p1.3.m3.1.1.2.cmml" xref="S4.p1.3.m3.1.1.2">𝑘</ci><ci id="S4.p1.3.m3.1.1.3.cmml" xref="S4.p1.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">k\times m</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.1d">italic_k × italic_m</annotation></semantics></math> pairs.
This operation is better suited for parallel execution.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">We note that the sampled batch training algorithm samples uniformly and does not reject any negative items like the iterative WARP algorithm.
However, even in the original iterative WARP algorithm, the gradient steps would not change if the rejection algorithm would accept all items because accepting an item with <math alttext="l(c,i,j)=0" class="ltx_Math" display="inline" id="S4.p2.1.m1.3"><semantics id="S4.p2.1.m1.3a"><mrow id="S4.p2.1.m1.3.4" xref="S4.p2.1.m1.3.4.cmml"><mrow id="S4.p2.1.m1.3.4.2" xref="S4.p2.1.m1.3.4.2.cmml"><mi id="S4.p2.1.m1.3.4.2.2" xref="S4.p2.1.m1.3.4.2.2.cmml">l</mi><mo id="S4.p2.1.m1.3.4.2.1" xref="S4.p2.1.m1.3.4.2.1.cmml">⁢</mo><mrow id="S4.p2.1.m1.3.4.2.3.2" xref="S4.p2.1.m1.3.4.2.3.1.cmml"><mo id="S4.p2.1.m1.3.4.2.3.2.1" stretchy="false" xref="S4.p2.1.m1.3.4.2.3.1.cmml">(</mo><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">c</mi><mo id="S4.p2.1.m1.3.4.2.3.2.2" xref="S4.p2.1.m1.3.4.2.3.1.cmml">,</mo><mi id="S4.p2.1.m1.2.2" xref="S4.p2.1.m1.2.2.cmml">i</mi><mo id="S4.p2.1.m1.3.4.2.3.2.3" xref="S4.p2.1.m1.3.4.2.3.1.cmml">,</mo><mi id="S4.p2.1.m1.3.3" xref="S4.p2.1.m1.3.3.cmml">j</mi><mo id="S4.p2.1.m1.3.4.2.3.2.4" stretchy="false" xref="S4.p2.1.m1.3.4.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.p2.1.m1.3.4.1" xref="S4.p2.1.m1.3.4.1.cmml">=</mo><mn id="S4.p2.1.m1.3.4.3" xref="S4.p2.1.m1.3.4.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.3b"><apply id="S4.p2.1.m1.3.4.cmml" xref="S4.p2.1.m1.3.4"><eq id="S4.p2.1.m1.3.4.1.cmml" xref="S4.p2.1.m1.3.4.1"></eq><apply id="S4.p2.1.m1.3.4.2.cmml" xref="S4.p2.1.m1.3.4.2"><times id="S4.p2.1.m1.3.4.2.1.cmml" xref="S4.p2.1.m1.3.4.2.1"></times><ci id="S4.p2.1.m1.3.4.2.2.cmml" xref="S4.p2.1.m1.3.4.2.2">𝑙</ci><vector id="S4.p2.1.m1.3.4.2.3.1.cmml" xref="S4.p2.1.m1.3.4.2.3.2"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑐</ci><ci id="S4.p2.1.m1.2.2.cmml" xref="S4.p2.1.m1.2.2">𝑖</ci><ci id="S4.p2.1.m1.3.3.cmml" xref="S4.p2.1.m1.3.3">𝑗</ci></vector></apply><cn id="S4.p2.1.m1.3.4.3.cmml" type="integer" xref="S4.p2.1.m1.3.4.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.3c">l(c,i,j)=0</annotation><annotation encoding="application/x-llamapun" id="S4.p2.1.m1.3d">italic_l ( italic_c , italic_i , italic_j ) = 0</annotation></semantics></math> would anyway have a gradient of 0 for the hinge loss.
So the purpose of the rejection algorithm in WARP is mostly to compute the rank.
For sampled batch training, we can use other ways to estimate ranks and can therefore remove the rejection algorithm.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Estimation of Rank</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">To better deal with large item catalogs, we rank items within the sampled set <math alttext="\tilde{\mathcal{I}}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mover accent="true" id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">ℐ</mi><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><ci id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1">~</ci><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\tilde{\mathcal{I}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">over~ start_ARG caligraphic_I end_ARG</annotation></semantics></math> of negative items instead of computing the rank on the full catalog which would be very costly.
We define the rank in the sample <math alttext="\tilde{\mathcal{I}}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1"><semantics id="S4.SS1.p1.2.m2.1a"><mover accent="true" id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">ℐ</mi><mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><ci id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1">~</ci><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\tilde{\mathcal{I}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.1d">over~ start_ARG caligraphic_I end_ARG</annotation></semantics></math> as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx4">
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{r}_{\tilde{\mathcal{I}}}(i|c)=|\{j\in\tilde{\mathcal{I}}:y%
(c,j)&gt;y(c,i)\}|+1" class="ltx_Math" display="inline" id="S4.E4.m1.6"><semantics id="S4.E4.m1.6a"><mrow id="S4.E4.m1.6.6" xref="S4.E4.m1.6.6.cmml"><mrow id="S4.E4.m1.5.5.1" xref="S4.E4.m1.5.5.1.cmml"><msub id="S4.E4.m1.5.5.1.3" xref="S4.E4.m1.5.5.1.3.cmml"><mover accent="true" id="S4.E4.m1.5.5.1.3.2" xref="S4.E4.m1.5.5.1.3.2.cmml"><mi id="S4.E4.m1.5.5.1.3.2.2" xref="S4.E4.m1.5.5.1.3.2.2.cmml">r</mi><mo id="S4.E4.m1.5.5.1.3.2.1" xref="S4.E4.m1.5.5.1.3.2.1.cmml">~</mo></mover><mover accent="true" id="S4.E4.m1.5.5.1.3.3" xref="S4.E4.m1.5.5.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.5.5.1.3.3.2" xref="S4.E4.m1.5.5.1.3.3.2.cmml">ℐ</mi><mo id="S4.E4.m1.5.5.1.3.3.1" xref="S4.E4.m1.5.5.1.3.3.1.cmml">~</mo></mover></msub><mo id="S4.E4.m1.5.5.1.2" xref="S4.E4.m1.5.5.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.5.5.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.cmml"><mo id="S4.E4.m1.5.5.1.1.1.2" stretchy="false" xref="S4.E4.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.5.5.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.cmml"><mi id="S4.E4.m1.5.5.1.1.1.1.2" xref="S4.E4.m1.5.5.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S4.E4.m1.5.5.1.1.1.1.1" xref="S4.E4.m1.5.5.1.1.1.1.1.cmml">|</mo><mi id="S4.E4.m1.5.5.1.1.1.1.3" xref="S4.E4.m1.5.5.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E4.m1.5.5.1.1.1.3" stretchy="false" xref="S4.E4.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.6.6.3" xref="S4.E4.m1.6.6.3.cmml">=</mo><mrow id="S4.E4.m1.6.6.2" xref="S4.E4.m1.6.6.2.cmml"><mrow id="S4.E4.m1.6.6.2.1.1" xref="S4.E4.m1.6.6.2.1.2.cmml"><mo id="S4.E4.m1.6.6.2.1.1.2" stretchy="false" xref="S4.E4.m1.6.6.2.1.2.1.cmml">|</mo><mrow id="S4.E4.m1.6.6.2.1.1.1.2" xref="S4.E4.m1.6.6.2.1.1.1.3.cmml"><mo id="S4.E4.m1.6.6.2.1.1.1.2.3" stretchy="false" xref="S4.E4.m1.6.6.2.1.1.1.3.1.cmml">{</mo><mrow id="S4.E4.m1.6.6.2.1.1.1.1.1" xref="S4.E4.m1.6.6.2.1.1.1.1.1.cmml"><mi id="S4.E4.m1.6.6.2.1.1.1.1.1.2" xref="S4.E4.m1.6.6.2.1.1.1.1.1.2.cmml">j</mi><mo id="S4.E4.m1.6.6.2.1.1.1.1.1.1" xref="S4.E4.m1.6.6.2.1.1.1.1.1.1.cmml">∈</mo><mover accent="true" id="S4.E4.m1.6.6.2.1.1.1.1.1.3" xref="S4.E4.m1.6.6.2.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.6.6.2.1.1.1.1.1.3.2" xref="S4.E4.m1.6.6.2.1.1.1.1.1.3.2.cmml">ℐ</mi><mo id="S4.E4.m1.6.6.2.1.1.1.1.1.3.1" xref="S4.E4.m1.6.6.2.1.1.1.1.1.3.1.cmml">~</mo></mover></mrow><mo id="S4.E4.m1.6.6.2.1.1.1.2.4" lspace="0.278em" rspace="0.278em" xref="S4.E4.m1.6.6.2.1.1.1.3.1.cmml">:</mo><mrow id="S4.E4.m1.6.6.2.1.1.1.2.2" xref="S4.E4.m1.6.6.2.1.1.1.2.2.cmml"><mrow id="S4.E4.m1.6.6.2.1.1.1.2.2.2" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.cmml"><mi id="S4.E4.m1.6.6.2.1.1.1.2.2.2.2" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.2.cmml">y</mi><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.2.1" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.1.cmml">⁢</mo><mrow id="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.2" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.1.cmml"><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.2.1" stretchy="false" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.1.cmml">(</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">c</mi><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.2.2" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.1.cmml">,</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">j</mi><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.2.3" stretchy="false" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.1" xref="S4.E4.m1.6.6.2.1.1.1.2.2.1.cmml">&gt;</mo><mrow id="S4.E4.m1.6.6.2.1.1.1.2.2.3" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.cmml"><mi id="S4.E4.m1.6.6.2.1.1.1.2.2.3.2" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.2.cmml">y</mi><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.3.1" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.1.cmml">⁢</mo><mrow id="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.2" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.1.cmml"><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.2.1" stretchy="false" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.1.cmml">(</mo><mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">c</mi><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.2.2" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.1.cmml">,</mo><mi id="S4.E4.m1.4.4" xref="S4.E4.m1.4.4.cmml">i</mi><mo id="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.2.3" stretchy="false" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4.m1.6.6.2.1.1.1.2.5" stretchy="false" xref="S4.E4.m1.6.6.2.1.1.1.3.1.cmml">}</mo></mrow><mo id="S4.E4.m1.6.6.2.1.1.3" stretchy="false" xref="S4.E4.m1.6.6.2.1.2.1.cmml">|</mo></mrow><mo id="S4.E4.m1.6.6.2.2" xref="S4.E4.m1.6.6.2.2.cmml">+</mo><mn id="S4.E4.m1.6.6.2.3" xref="S4.E4.m1.6.6.2.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.6b"><apply id="S4.E4.m1.6.6.cmml" xref="S4.E4.m1.6.6"><eq id="S4.E4.m1.6.6.3.cmml" xref="S4.E4.m1.6.6.3"></eq><apply id="S4.E4.m1.5.5.1.cmml" xref="S4.E4.m1.5.5.1"><times id="S4.E4.m1.5.5.1.2.cmml" xref="S4.E4.m1.5.5.1.2"></times><apply id="S4.E4.m1.5.5.1.3.cmml" xref="S4.E4.m1.5.5.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.5.5.1.3.1.cmml" xref="S4.E4.m1.5.5.1.3">subscript</csymbol><apply id="S4.E4.m1.5.5.1.3.2.cmml" xref="S4.E4.m1.5.5.1.3.2"><ci id="S4.E4.m1.5.5.1.3.2.1.cmml" xref="S4.E4.m1.5.5.1.3.2.1">~</ci><ci id="S4.E4.m1.5.5.1.3.2.2.cmml" xref="S4.E4.m1.5.5.1.3.2.2">𝑟</ci></apply><apply id="S4.E4.m1.5.5.1.3.3.cmml" xref="S4.E4.m1.5.5.1.3.3"><ci id="S4.E4.m1.5.5.1.3.3.1.cmml" xref="S4.E4.m1.5.5.1.3.3.1">~</ci><ci id="S4.E4.m1.5.5.1.3.3.2.cmml" xref="S4.E4.m1.5.5.1.3.3.2">ℐ</ci></apply></apply><apply id="S4.E4.m1.5.5.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.5.5.1.1.1.1.1.cmml" xref="S4.E4.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S4.E4.m1.5.5.1.1.1.1.2.cmml" xref="S4.E4.m1.5.5.1.1.1.1.2">𝑖</ci><ci id="S4.E4.m1.5.5.1.1.1.1.3.cmml" xref="S4.E4.m1.5.5.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S4.E4.m1.6.6.2.cmml" xref="S4.E4.m1.6.6.2"><plus id="S4.E4.m1.6.6.2.2.cmml" xref="S4.E4.m1.6.6.2.2"></plus><apply id="S4.E4.m1.6.6.2.1.2.cmml" xref="S4.E4.m1.6.6.2.1.1"><abs id="S4.E4.m1.6.6.2.1.2.1.cmml" xref="S4.E4.m1.6.6.2.1.1.2"></abs><apply id="S4.E4.m1.6.6.2.1.1.1.3.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2"><csymbol cd="latexml" id="S4.E4.m1.6.6.2.1.1.1.3.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.3">conditional-set</csymbol><apply id="S4.E4.m1.6.6.2.1.1.1.1.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.1.1"><in id="S4.E4.m1.6.6.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.1.1.1"></in><ci id="S4.E4.m1.6.6.2.1.1.1.1.1.2.cmml" xref="S4.E4.m1.6.6.2.1.1.1.1.1.2">𝑗</ci><apply id="S4.E4.m1.6.6.2.1.1.1.1.1.3.cmml" xref="S4.E4.m1.6.6.2.1.1.1.1.1.3"><ci id="S4.E4.m1.6.6.2.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.1.1.3.1">~</ci><ci id="S4.E4.m1.6.6.2.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.6.6.2.1.1.1.1.1.3.2">ℐ</ci></apply></apply><apply id="S4.E4.m1.6.6.2.1.1.1.2.2.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2"><gt id="S4.E4.m1.6.6.2.1.1.1.2.2.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.1"></gt><apply id="S4.E4.m1.6.6.2.1.1.1.2.2.2.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2"><times id="S4.E4.m1.6.6.2.1.1.1.2.2.2.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.1"></times><ci id="S4.E4.m1.6.6.2.1.1.1.2.2.2.2.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.2">𝑦</ci><interval closure="open" id="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.2.3.2"><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">𝑐</ci><ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">𝑗</ci></interval></apply><apply id="S4.E4.m1.6.6.2.1.1.1.2.2.3.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3"><times id="S4.E4.m1.6.6.2.1.1.1.2.2.3.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.1"></times><ci id="S4.E4.m1.6.6.2.1.1.1.2.2.3.2.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.2">𝑦</ci><interval closure="open" id="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.1.cmml" xref="S4.E4.m1.6.6.2.1.1.1.2.2.3.3.2"><ci id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3">𝑐</ci><ci id="S4.E4.m1.4.4.cmml" xref="S4.E4.m1.4.4">𝑖</ci></interval></apply></apply></apply></apply><cn id="S4.E4.m1.6.6.2.3.cmml" type="integer" xref="S4.E4.m1.6.6.2.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.6c">\displaystyle\tilde{r}_{\tilde{\mathcal{I}}}(i|c)=|\{j\in\tilde{\mathcal{I}}:y%
(c,j)&gt;y(c,i)\}|+1</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.6d">over~ start_ARG italic_r end_ARG start_POSTSUBSCRIPT over~ start_ARG caligraphic_I end_ARG end_POSTSUBSCRIPT ( italic_i | italic_c ) = | { italic_j ∈ over~ start_ARG caligraphic_I end_ARG : italic_y ( italic_c , italic_j ) &gt; italic_y ( italic_c , italic_i ) } | + 1</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.8">and refer to it as the <em class="ltx_emph ltx_font_italic" id="S4.SS1.p1.8.1">sampled rank</em>.
The sampled rank from a subset <math alttext="\tilde{\mathcal{I}}\subset\mathcal{I}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m1.1"><semantics id="S4.SS1.p1.3.m1.1a"><mrow id="S4.SS1.p1.3.m1.1.1" xref="S4.SS1.p1.3.m1.1.1.cmml"><mover accent="true" id="S4.SS1.p1.3.m1.1.1.2" xref="S4.SS1.p1.3.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m1.1.1.2.2" xref="S4.SS1.p1.3.m1.1.1.2.2.cmml">ℐ</mi><mo id="S4.SS1.p1.3.m1.1.1.2.1" xref="S4.SS1.p1.3.m1.1.1.2.1.cmml">~</mo></mover><mo id="S4.SS1.p1.3.m1.1.1.1" xref="S4.SS1.p1.3.m1.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m1.1.1.3" xref="S4.SS1.p1.3.m1.1.1.3.cmml">ℐ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m1.1b"><apply id="S4.SS1.p1.3.m1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1"><subset id="S4.SS1.p1.3.m1.1.1.1.cmml" xref="S4.SS1.p1.3.m1.1.1.1"></subset><apply id="S4.SS1.p1.3.m1.1.1.2.cmml" xref="S4.SS1.p1.3.m1.1.1.2"><ci id="S4.SS1.p1.3.m1.1.1.2.1.cmml" xref="S4.SS1.p1.3.m1.1.1.2.1">~</ci><ci id="S4.SS1.p1.3.m1.1.1.2.2.cmml" xref="S4.SS1.p1.3.m1.1.1.2.2">ℐ</ci></apply><ci id="S4.SS1.p1.3.m1.1.1.3.cmml" xref="S4.SS1.p1.3.m1.1.1.3">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m1.1c">\tilde{\mathcal{I}}\subset\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.3.m1.1d">over~ start_ARG caligraphic_I end_ARG ⊂ caligraphic_I</annotation></semantics></math> is a poor estimate of the true rank, <math alttext="r" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m2.1"><semantics id="S4.SS1.p1.4.m2.1a"><mi id="S4.SS1.p1.4.m2.1.1" xref="S4.SS1.p1.4.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m2.1b"><ci id="S4.SS1.p1.4.m2.1.1.cmml" xref="S4.SS1.p1.4.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.4.m2.1d">italic_r</annotation></semantics></math>.
For example, the maximum rank is <math alttext="m" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m3.1"><semantics id="S4.SS1.p1.5.m3.1a"><mi id="S4.SS1.p1.5.m3.1.1" xref="S4.SS1.p1.5.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m3.1b"><ci id="S4.SS1.p1.5.m3.1.1.cmml" xref="S4.SS1.p1.5.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.5.m3.1d">italic_m</annotation></semantics></math> instead of <math alttext="|\mathcal{I}|" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m4.1"><semantics id="S4.SS1.p1.6.m4.1a"><mrow id="S4.SS1.p1.6.m4.1.2.2" xref="S4.SS1.p1.6.m4.1.2.1.cmml"><mo id="S4.SS1.p1.6.m4.1.2.2.1" stretchy="false" xref="S4.SS1.p1.6.m4.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m4.1.1" xref="S4.SS1.p1.6.m4.1.1.cmml">ℐ</mi><mo id="S4.SS1.p1.6.m4.1.2.2.2" stretchy="false" xref="S4.SS1.p1.6.m4.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m4.1b"><apply id="S4.SS1.p1.6.m4.1.2.1.cmml" xref="S4.SS1.p1.6.m4.1.2.2"><abs id="S4.SS1.p1.6.m4.1.2.1.1.cmml" xref="S4.SS1.p1.6.m4.1.2.2.1"></abs><ci id="S4.SS1.p1.6.m4.1.1.cmml" xref="S4.SS1.p1.6.m4.1.1">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m4.1c">|\mathcal{I}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.6.m4.1d">| caligraphic_I |</annotation></semantics></math>.
In general, it underestimates the rank because some of the items that are ranked above <math alttext="i" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m5.1"><semantics id="S4.SS1.p1.7.m5.1a"><mi id="S4.SS1.p1.7.m5.1.1" xref="S4.SS1.p1.7.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m5.1b"><ci id="S4.SS1.p1.7.m5.1.1.cmml" xref="S4.SS1.p1.7.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.7.m5.1d">italic_i</annotation></semantics></math> might be missing from <math alttext="\tilde{\mathcal{I}}" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m6.1"><semantics id="S4.SS1.p1.8.m6.1a"><mover accent="true" id="S4.SS1.p1.8.m6.1.1" xref="S4.SS1.p1.8.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.8.m6.1.1.2" xref="S4.SS1.p1.8.m6.1.1.2.cmml">ℐ</mi><mo id="S4.SS1.p1.8.m6.1.1.1" xref="S4.SS1.p1.8.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m6.1b"><apply id="S4.SS1.p1.8.m6.1.1.cmml" xref="S4.SS1.p1.8.m6.1.1"><ci id="S4.SS1.p1.8.m6.1.1.1.cmml" xref="S4.SS1.p1.8.m6.1.1.1">~</ci><ci id="S4.SS1.p1.8.m6.1.1.2.cmml" xref="S4.SS1.p1.8.m6.1.1.2">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m6.1c">\tilde{\mathcal{I}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.8.m6.1d">over~ start_ARG caligraphic_I end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">We will follow the ideas from <cite class="ltx_cite ltx_citemacro_citep">(Krichene and
Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib11" title="">2020</a>)</cite> that have previously analyzed this issue and provided correction methods in the context of evaluating with sampled metrics.
The sampled rank <math alttext="\tilde{r}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mover accent="true" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">r</mi><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><ci id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1">~</ci><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\tilde{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">over~ start_ARG italic_r end_ARG</annotation></semantics></math> is a random variable that depends on the sampled set of negatives.
The sampled rank counts how often a sampled item is ranked above the positive item.
If negative items are sampled uniformly, then the probability of sampling a negative item ranking above the positive item depends on the true rank of the positive item and the probability is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx5">
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle p(r(j|c)&gt;r(i|c))=\frac{r(i|c)-1}{|\mathcal{I}|-1}." class="ltx_Math" display="inline" id="S4.E5.m1.3"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3.3.1" xref="S4.E5.m1.3.3.1.1.cmml"><mrow id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml"><mrow id="S4.E5.m1.3.3.1.1.1" xref="S4.E5.m1.3.3.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.3.cmml">p</mi><mo id="S4.E5.m1.3.3.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml">r</mi><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">j</mi><mo fence="false" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3.cmml">&gt;</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.2.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.3.cmml">r</mi><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.2.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml">i</mi><mo fence="false" id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">|</mo><mi id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E5.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.3.3.1.1.2" xref="S4.E5.m1.3.3.1.1.2.cmml">=</mo><mstyle displaystyle="true" id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml"><mfrac id="S4.E5.m1.2.2a" xref="S4.E5.m1.2.2.cmml"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml">r</mi><mo id="S4.E5.m1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E5.m1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E5.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.2.cmml">−</mo><mn id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.3.cmml">1</mn></mrow><mrow id="S4.E5.m1.2.2.2" xref="S4.E5.m1.2.2.2.cmml"><mrow id="S4.E5.m1.2.2.2.3.2" xref="S4.E5.m1.2.2.2.3.1.cmml"><mo id="S4.E5.m1.2.2.2.3.2.1" stretchy="false" xref="S4.E5.m1.2.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.2.2.2.1" xref="S4.E5.m1.2.2.2.1.cmml">ℐ</mi><mo id="S4.E5.m1.2.2.2.3.2.2" stretchy="false" xref="S4.E5.m1.2.2.2.3.1.1.cmml">|</mo></mrow><mo id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.cmml">−</mo><mn id="S4.E5.m1.2.2.2.4" xref="S4.E5.m1.2.2.2.4.cmml">1</mn></mrow></mfrac></mstyle></mrow><mo id="S4.E5.m1.3.3.1.2" lspace="0em" xref="S4.E5.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.3b"><apply id="S4.E5.m1.3.3.1.1.cmml" xref="S4.E5.m1.3.3.1"><eq id="S4.E5.m1.3.3.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.2"></eq><apply id="S4.E5.m1.3.3.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1"><times id="S4.E5.m1.3.3.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.2"></times><ci id="S4.E5.m1.3.3.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.3">𝑝</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1"><gt id="S4.E5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.3"></gt><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1"><times id="S4.E5.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.2"></times><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.3">𝑟</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">𝑗</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2"><times id="S4.E5.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.2"></times><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.3">𝑟</ci><apply id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.2">𝑖</ci><ci id="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.1.1.1.2.1.1.1.3">𝑐</ci></apply></apply></apply></apply><apply id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2"><divide id="S4.E5.m1.2.2.3.cmml" xref="S4.E5.m1.2.2"></divide><apply id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><minus id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.2"></minus><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.2"></times><ci id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3">𝑟</ci><apply id="S4.E5.m1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><cn id="S4.E5.m1.1.1.1.3.cmml" type="integer" xref="S4.E5.m1.1.1.1.3">1</cn></apply><apply id="S4.E5.m1.2.2.2.cmml" xref="S4.E5.m1.2.2.2"><minus id="S4.E5.m1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2"></minus><apply id="S4.E5.m1.2.2.2.3.1.cmml" xref="S4.E5.m1.2.2.2.3.2"><abs id="S4.E5.m1.2.2.2.3.1.1.cmml" xref="S4.E5.m1.2.2.2.3.2.1"></abs><ci id="S4.E5.m1.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.1">ℐ</ci></apply><cn id="S4.E5.m1.2.2.2.4.cmml" type="integer" xref="S4.E5.m1.2.2.2.4">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.3c">\displaystyle p(r(j|c)&gt;r(i|c))=\frac{r(i|c)-1}{|\mathcal{I}|-1}.</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.3d">italic_p ( italic_r ( italic_j | italic_c ) &gt; italic_r ( italic_i | italic_c ) ) = divide start_ARG italic_r ( italic_i | italic_c ) - 1 end_ARG start_ARG | caligraphic_I | - 1 end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.2">The sampled rank (eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S4.E4" title="In 4.1. Estimation of Rank ‣ 4. Batch Training with Negative Sampling ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">4</span></a>) repeats this process <math alttext="m" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m1.1"><semantics id="S4.SS1.p2.2.m1.1a"><mi id="S4.SS1.p2.2.m1.1.1" xref="S4.SS1.p2.2.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m1.1b"><ci id="S4.SS1.p2.2.m1.1.1.cmml" xref="S4.SS1.p2.2.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m1.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m1.1d">italic_m</annotation></semantics></math> times and counts the successes.
Thus the sampled rank is binomial distributed</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx6">
<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\tilde{r}(i|c)\sim B\left(m,p\right)+1\quad\text{with}\quad p=%
\frac{r(i|c)-1}{|\mathcal{I}|-1}." class="ltx_Math" display="inline" id="S4.E6.m1.6"><semantics id="S4.E6.m1.6a"><mrow id="S4.E6.m1.6.6.1"><mrow id="S4.E6.m1.6.6.1.1.2" xref="S4.E6.m1.6.6.1.1.3.cmml"><mrow id="S4.E6.m1.6.6.1.1.1.1" xref="S4.E6.m1.6.6.1.1.1.1.cmml"><mrow id="S4.E6.m1.6.6.1.1.1.1.1" xref="S4.E6.m1.6.6.1.1.1.1.1.cmml"><mover accent="true" id="S4.E6.m1.6.6.1.1.1.1.1.3" xref="S4.E6.m1.6.6.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.6.6.1.1.1.1.1.3.2" xref="S4.E6.m1.6.6.1.1.1.1.1.3.2.cmml">r</mi><mo id="S4.E6.m1.6.6.1.1.1.1.1.3.1" xref="S4.E6.m1.6.6.1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="S4.E6.m1.6.6.1.1.1.1.1.2" xref="S4.E6.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.6.6.1.1.1.1.1.1.1" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.6.6.1.1.1.1.1.1.1.1" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E6.m1.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.6.6.1.1.1.1.3" xref="S4.E6.m1.6.6.1.1.1.1.3.cmml">∼</mo><mrow id="S4.E6.m1.6.6.1.1.1.1.2.1" xref="S4.E6.m1.6.6.1.1.1.1.2.2.cmml"><mrow id="S4.E6.m1.6.6.1.1.1.1.2.1.1" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.cmml"><mrow id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.cmml"><mi id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.2" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.2.cmml">B</mi><mo id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.1" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.2" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.1.cmml"><mo id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.2.1" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.1.cmml">(</mo><mi id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml">m</mi><mo id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.2.2" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.1.cmml">,</mo><mi id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml">p</mi><mo id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.2.3" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.6.6.1.1.1.1.2.1.1.1" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.1.cmml">+</mo><mn id="S4.E6.m1.6.6.1.1.1.1.2.1.1.3" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.3.cmml">1</mn></mrow><mspace id="S4.E6.m1.6.6.1.1.1.1.2.1.2" width="1em" xref="S4.E6.m1.6.6.1.1.1.1.2.2.cmml"></mspace><mtext id="S4.E6.m1.5.5" xref="S4.E6.m1.5.5a.cmml">with</mtext></mrow></mrow><mspace id="S4.E6.m1.6.6.1.1.2.3" width="1em" xref="S4.E6.m1.6.6.1.1.3a.cmml"></mspace><mrow id="S4.E6.m1.6.6.1.1.2.2" xref="S4.E6.m1.6.6.1.1.2.2.cmml"><mi id="S4.E6.m1.6.6.1.1.2.2.2" xref="S4.E6.m1.6.6.1.1.2.2.2.cmml">p</mi><mo id="S4.E6.m1.6.6.1.1.2.2.1" xref="S4.E6.m1.6.6.1.1.2.2.1.cmml">=</mo><mstyle displaystyle="true" id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml"><mfrac id="S4.E6.m1.2.2a" xref="S4.E6.m1.2.2.cmml"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml">r</mi><mo id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.2.cmml">−</mo><mn id="S4.E6.m1.1.1.1.3" xref="S4.E6.m1.1.1.1.3.cmml">1</mn></mrow><mrow id="S4.E6.m1.2.2.2" xref="S4.E6.m1.2.2.2.cmml"><mrow id="S4.E6.m1.2.2.2.3.2" xref="S4.E6.m1.2.2.2.3.1.cmml"><mo id="S4.E6.m1.2.2.2.3.2.1" stretchy="false" xref="S4.E6.m1.2.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.2.2.2.1" xref="S4.E6.m1.2.2.2.1.cmml">ℐ</mi><mo id="S4.E6.m1.2.2.2.3.2.2" stretchy="false" xref="S4.E6.m1.2.2.2.3.1.1.cmml">|</mo></mrow><mo id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">−</mo><mn id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.4.cmml">1</mn></mrow></mfrac></mstyle></mrow></mrow><mo id="S4.E6.m1.6.6.1.2" lspace="0em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.6b"><apply id="S4.E6.m1.6.6.1.1.3.cmml" xref="S4.E6.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.6.6.1.1.3a.cmml" xref="S4.E6.m1.6.6.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E6.m1.6.6.1.1.1.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.6.6.1.1.1.1.3.cmml" xref="S4.E6.m1.6.6.1.1.1.1.3">similar-to</csymbol><apply id="S4.E6.m1.6.6.1.1.1.1.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1"><times id="S4.E6.m1.6.6.1.1.1.1.1.2.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.2"></times><apply id="S4.E6.m1.6.6.1.1.1.1.1.3.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.3"><ci id="S4.E6.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.3.1">~</ci><ci id="S4.E6.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.3.2">𝑟</ci></apply><apply id="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.6.6.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><list id="S4.E6.m1.6.6.1.1.1.1.2.2.cmml" xref="S4.E6.m1.6.6.1.1.1.1.2.1"><apply id="S4.E6.m1.6.6.1.1.1.1.2.1.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1"><plus id="S4.E6.m1.6.6.1.1.1.1.2.1.1.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.1"></plus><apply id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.cmml" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2"><times id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.1"></times><ci id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.2.cmml" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.2">𝐵</ci><interval closure="open" id="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.1.cmml" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.2.3.2"><ci id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.3.3">𝑚</ci><ci id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4">𝑝</ci></interval></apply><cn id="S4.E6.m1.6.6.1.1.1.1.2.1.1.3.cmml" type="integer" xref="S4.E6.m1.6.6.1.1.1.1.2.1.1.3">1</cn></apply><ci id="S4.E6.m1.5.5a.cmml" xref="S4.E6.m1.5.5"><mtext id="S4.E6.m1.5.5.cmml" xref="S4.E6.m1.5.5">with</mtext></ci></list></apply><apply id="S4.E6.m1.6.6.1.1.2.2.cmml" xref="S4.E6.m1.6.6.1.1.2.2"><eq id="S4.E6.m1.6.6.1.1.2.2.1.cmml" xref="S4.E6.m1.6.6.1.1.2.2.1"></eq><ci id="S4.E6.m1.6.6.1.1.2.2.2.cmml" xref="S4.E6.m1.6.6.1.1.2.2.2">𝑝</ci><apply id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2"><divide id="S4.E6.m1.2.2.3.cmml" xref="S4.E6.m1.2.2"></divide><apply id="S4.E6.m1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><minus id="S4.E6.m1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.2"></minus><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3">𝑟</ci><apply id="S4.E6.m1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><cn id="S4.E6.m1.1.1.1.3.cmml" type="integer" xref="S4.E6.m1.1.1.1.3">1</cn></apply><apply id="S4.E6.m1.2.2.2.cmml" xref="S4.E6.m1.2.2.2"><minus id="S4.E6.m1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2"></minus><apply id="S4.E6.m1.2.2.2.3.1.cmml" xref="S4.E6.m1.2.2.2.3.2"><abs id="S4.E6.m1.2.2.2.3.1.1.cmml" xref="S4.E6.m1.2.2.2.3.2.1"></abs><ci id="S4.E6.m1.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.1">ℐ</ci></apply><cn id="S4.E6.m1.2.2.2.4.cmml" type="integer" xref="S4.E6.m1.2.2.2.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.6c">\displaystyle\tilde{r}(i|c)\sim B\left(m,p\right)+1\quad\text{with}\quad p=%
\frac{r(i|c)-1}{|\mathcal{I}|-1}.</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.6d">over~ start_ARG italic_r end_ARG ( italic_i | italic_c ) ∼ italic_B ( italic_m , italic_p ) + 1 with italic_p = divide start_ARG italic_r ( italic_i | italic_c ) - 1 end_ARG start_ARG | caligraphic_I | - 1 end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.5">In practice, we do not know <math alttext="r" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m1.1"><semantics id="S4.SS1.p2.3.m1.1a"><mi id="S4.SS1.p2.3.m1.1.1" xref="S4.SS1.p2.3.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m1.1b"><ci id="S4.SS1.p2.3.m1.1.1.cmml" xref="S4.SS1.p2.3.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m1.1d">italic_r</annotation></semantics></math> but want to estimate it from <math alttext="\tilde{r}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m2.1"><semantics id="S4.SS1.p2.4.m2.1a"><mover accent="true" id="S4.SS1.p2.4.m2.1.1" xref="S4.SS1.p2.4.m2.1.1.cmml"><mi id="S4.SS1.p2.4.m2.1.1.2" xref="S4.SS1.p2.4.m2.1.1.2.cmml">r</mi><mo id="S4.SS1.p2.4.m2.1.1.1" xref="S4.SS1.p2.4.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m2.1b"><apply id="S4.SS1.p2.4.m2.1.1.cmml" xref="S4.SS1.p2.4.m2.1.1"><ci id="S4.SS1.p2.4.m2.1.1.1.cmml" xref="S4.SS1.p2.4.m2.1.1.1">~</ci><ci id="S4.SS1.p2.4.m2.1.1.2.cmml" xref="S4.SS1.p2.4.m2.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m2.1c">\tilde{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m2.1d">over~ start_ARG italic_r end_ARG</annotation></semantics></math>.
First, the probability <math alttext="p" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m3.1"><semantics id="S4.SS1.p2.5.m3.1a"><mi id="S4.SS1.p2.5.m3.1.1" xref="S4.SS1.p2.5.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m3.1b"><ci id="S4.SS1.p2.5.m3.1.1.cmml" xref="S4.SS1.p2.5.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m3.1c">p</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m3.1d">italic_p</annotation></semantics></math> can be estimated from the sampled rank by:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx7">
<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{p}=\frac{\tilde{r}(i|c)-1}{m}" class="ltx_Math" display="inline" id="S4.E7.m1.1"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.2" xref="S4.E7.m1.1.2.cmml"><mover accent="true" id="S4.E7.m1.1.2.2" xref="S4.E7.m1.1.2.2.cmml"><mi id="S4.E7.m1.1.2.2.2" xref="S4.E7.m1.1.2.2.2.cmml">p</mi><mo id="S4.E7.m1.1.2.2.1" xref="S4.E7.m1.1.2.2.1.cmml">^</mo></mover><mo id="S4.E7.m1.1.2.1" xref="S4.E7.m1.1.2.1.cmml">=</mo><mstyle displaystyle="true" id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><mfrac id="S4.E7.m1.1.1a" xref="S4.E7.m1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><mover accent="true" id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.3.cmml"><mi id="S4.E7.m1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.3.2.cmml">r</mi><mo id="S4.E7.m1.1.1.1.1.3.1" xref="S4.E7.m1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S4.E7.m1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E7.m1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E7.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.1.1.1.2" xref="S4.E7.m1.1.1.1.2.cmml">−</mo><mn id="S4.E7.m1.1.1.1.3" xref="S4.E7.m1.1.1.1.3.cmml">1</mn></mrow><mi id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml">m</mi></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.2.cmml" xref="S4.E7.m1.1.2"><eq id="S4.E7.m1.1.2.1.cmml" xref="S4.E7.m1.1.2.1"></eq><apply id="S4.E7.m1.1.2.2.cmml" xref="S4.E7.m1.1.2.2"><ci id="S4.E7.m1.1.2.2.1.cmml" xref="S4.E7.m1.1.2.2.1">^</ci><ci id="S4.E7.m1.1.2.2.2.cmml" xref="S4.E7.m1.1.2.2.2">𝑝</ci></apply><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><divide id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1"></divide><apply id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><minus id="S4.E7.m1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.2"></minus><apply id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1"><times id="S4.E7.m1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.2"></times><apply id="S4.E7.m1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.3"><ci id="S4.E7.m1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3.1">~</ci><ci id="S4.E7.m1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3.2">𝑟</ci></apply><apply id="S4.E7.m1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S4.E7.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><cn id="S4.E7.m1.1.1.1.3.cmml" type="integer" xref="S4.E7.m1.1.1.1.3">1</cn></apply><ci id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">\displaystyle\hat{p}=\frac{\tilde{r}(i|c)-1}{m}</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.1d">over^ start_ARG italic_p end_ARG = divide start_ARG over~ start_ARG italic_r end_ARG ( italic_i | italic_c ) - 1 end_ARG start_ARG italic_m end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.9">And thus, an estimator of the rank on the full catalog is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx8">
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{r}(i|c)=1+\frac{\tilde{r}(i|c)-1}{m}(|\mathcal{I}|-1)." class="ltx_Math" display="inline" id="S4.E8.m1.3"><semantics id="S4.E8.m1.3a"><mrow id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.1" xref="S4.E8.m1.3.3.1.1.1.cmml"><mover accent="true" id="S4.E8.m1.3.3.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.3.cmml"><mi id="S4.E8.m1.3.3.1.1.1.3.2" xref="S4.E8.m1.3.3.1.1.1.3.2.cmml">r</mi><mo id="S4.E8.m1.3.3.1.1.1.3.1" xref="S4.E8.m1.3.3.1.1.1.3.1.cmml">^</mo></mover><mo id="S4.E8.m1.3.3.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.3.3.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.2" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S4.E8.m1.3.3.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E8.m1.3.3.1.1.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E8.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.3.3.1.1.3" xref="S4.E8.m1.3.3.1.1.3.cmml">=</mo><mrow id="S4.E8.m1.3.3.1.1.2" xref="S4.E8.m1.3.3.1.1.2.cmml"><mn id="S4.E8.m1.3.3.1.1.2.3" xref="S4.E8.m1.3.3.1.1.2.3.cmml">1</mn><mo id="S4.E8.m1.3.3.1.1.2.2" xref="S4.E8.m1.3.3.1.1.2.2.cmml">+</mo><mrow id="S4.E8.m1.3.3.1.1.2.1" xref="S4.E8.m1.3.3.1.1.2.1.cmml"><mstyle displaystyle="true" id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><mfrac id="S4.E8.m1.1.1a" xref="S4.E8.m1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><mrow id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml"><mover accent="true" id="S4.E8.m1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.1.3.2.cmml">r</mi><mo id="S4.E8.m1.1.1.1.1.3.1" xref="S4.E8.m1.1.1.1.1.3.1.cmml">~</mo></mover><mo id="S4.E8.m1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.1.2.cmml">i</mi><mo fence="false" id="S4.E8.m1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E8.m1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E8.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">−</mo><mn id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3.cmml">1</mn></mrow><mi id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml">m</mi></mfrac></mstyle><mo id="S4.E8.m1.3.3.1.1.2.1.2" xref="S4.E8.m1.3.3.1.1.2.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.3.3.1.1.2.1.1.1" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.cmml"><mo id="S4.E8.m1.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.3.3.1.1.2.1.1.1.1" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.cmml"><mrow id="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.2" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.1.cmml"><mo id="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.2.1" stretchy="false" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml">ℐ</mi><mo id="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.2.2" stretchy="false" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.cmml">−</mo><mn id="S4.E8.m1.3.3.1.1.2.1.1.1.1.3" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E8.m1.3.3.1.1.2.1.1.1.3" stretchy="false" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E8.m1.3.3.1.2" lspace="0em" xref="S4.E8.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.3b"><apply id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1"><eq id="S4.E8.m1.3.3.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.3"></eq><apply id="S4.E8.m1.3.3.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1"><times id="S4.E8.m1.3.3.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.2"></times><apply id="S4.E8.m1.3.3.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.3"><ci id="S4.E8.m1.3.3.1.1.1.3.1.cmml" xref="S4.E8.m1.3.3.1.1.1.3.1">^</ci><ci id="S4.E8.m1.3.3.1.1.1.3.2.cmml" xref="S4.E8.m1.3.3.1.1.1.3.2">𝑟</ci></apply><apply id="S4.E8.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.2">𝑖</ci><ci id="S4.E8.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.1.1.1.1.1.1.3">𝑐</ci></apply></apply><apply id="S4.E8.m1.3.3.1.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2"><plus id="S4.E8.m1.3.3.1.1.2.2.cmml" xref="S4.E8.m1.3.3.1.1.2.2"></plus><cn id="S4.E8.m1.3.3.1.1.2.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.2.3">1</cn><apply id="S4.E8.m1.3.3.1.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1"><times id="S4.E8.m1.3.3.1.1.2.1.2.cmml" xref="S4.E8.m1.3.3.1.1.2.1.2"></times><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><divide id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1"></divide><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><minus id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"></minus><apply id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1"><times id="S4.E8.m1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.2"></times><apply id="S4.E8.m1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.3"><ci id="S4.E8.m1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.1.1.3.1">~</ci><ci id="S4.E8.m1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.1.3.2">𝑟</ci></apply><apply id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S4.E8.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply><cn id="S4.E8.m1.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.1.1.1.3">1</cn></apply><ci id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3">𝑚</ci></apply><apply id="S4.E8.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.1"><minus id="S4.E8.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.1"></minus><apply id="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.2"><abs id="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.1.1.cmml" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.2.2.1"></abs><ci id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2">ℐ</ci></apply><cn id="S4.E8.m1.3.3.1.1.2.1.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.3.3.1.1.2.1.1.1.1.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.3c">\displaystyle\hat{r}(i|c)=1+\frac{\tilde{r}(i|c)-1}{m}(|\mathcal{I}|-1).</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.3d">over^ start_ARG italic_r end_ARG ( italic_i | italic_c ) = 1 + divide start_ARG over~ start_ARG italic_r end_ARG ( italic_i | italic_c ) - 1 end_ARG start_ARG italic_m end_ARG ( | caligraphic_I | - 1 ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p2.8">The estimated rank <math alttext="\hat{r}" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m1.1"><semantics id="S4.SS1.p2.6.m1.1a"><mover accent="true" id="S4.SS1.p2.6.m1.1.1" xref="S4.SS1.p2.6.m1.1.1.cmml"><mi id="S4.SS1.p2.6.m1.1.1.2" xref="S4.SS1.p2.6.m1.1.1.2.cmml">r</mi><mo id="S4.SS1.p2.6.m1.1.1.1" xref="S4.SS1.p2.6.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m1.1b"><apply id="S4.SS1.p2.6.m1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1"><ci id="S4.SS1.p2.6.m1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1.1">^</ci><ci id="S4.SS1.p2.6.m1.1.1.2.cmml" xref="S4.SS1.p2.6.m1.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m1.1c">\hat{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m1.1d">over^ start_ARG italic_r end_ARG</annotation></semantics></math> is a better estimator of the true rank <math alttext="r" class="ltx_Math" display="inline" id="S4.SS1.p2.7.m2.1"><semantics id="S4.SS1.p2.7.m2.1a"><mi id="S4.SS1.p2.7.m2.1.1" xref="S4.SS1.p2.7.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m2.1b"><ci id="S4.SS1.p2.7.m2.1.1.cmml" xref="S4.SS1.p2.7.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m2.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.7.m2.1d">italic_r</annotation></semantics></math> than the sampled rank <math alttext="\tilde{r}" class="ltx_Math" display="inline" id="S4.SS1.p2.8.m3.1"><semantics id="S4.SS1.p2.8.m3.1a"><mover accent="true" id="S4.SS1.p2.8.m3.1.1" xref="S4.SS1.p2.8.m3.1.1.cmml"><mi id="S4.SS1.p2.8.m3.1.1.2" xref="S4.SS1.p2.8.m3.1.1.2.cmml">r</mi><mo id="S4.SS1.p2.8.m3.1.1.1" xref="S4.SS1.p2.8.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m3.1b"><apply id="S4.SS1.p2.8.m3.1.1.cmml" xref="S4.SS1.p2.8.m3.1.1"><ci id="S4.SS1.p2.8.m3.1.1.1.cmml" xref="S4.SS1.p2.8.m3.1.1.1">~</ci><ci id="S4.SS1.p2.8.m3.1.1.2.cmml" xref="S4.SS1.p2.8.m3.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m3.1c">\tilde{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.8.m3.1d">over~ start_ARG italic_r end_ARG</annotation></semantics></math>.
In Section <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5" title="5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">5</span></a>, we compare batch training of WARP and LambdaRank with the sampled rank and the estimated rank.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Discussion</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.6">An alternative to estimating the rank, <math alttext="\hat{r}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mover accent="true" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">r</mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><ci id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">^</ci><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\hat{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">over^ start_ARG italic_r end_ARG</annotation></semantics></math>, would be to estimate <math alttext="\hat{\alpha}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mover accent="true" id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">α</mi><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><ci id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">^</ci><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝛼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\hat{\alpha}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">over^ start_ARG italic_α end_ARG</annotation></semantics></math> from the sampled ranks.
This could follow the ideas of <cite class="ltx_cite ltx_citemacro_citep">(Krichene and
Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib11" title="">2020</a>)</cite> for estimating a corrected metric from sampled ranks.
For example, for LambdaRank, <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><ci id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">italic_α</annotation></semantics></math> is a function of the <math alttext="\mathrm{NDCG}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">NDCG</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">NDCG</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\mathrm{NDCG}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">roman_NDCG</annotation></semantics></math> and <cite class="ltx_cite ltx_citemacro_citep">(Krichene and
Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib11" title="">2020</a>)</cite> suggested methods for estimating the <math alttext="\mathrm{NDCG}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m5.1"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">NDCG</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">NDCG</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\mathrm{NDCG}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.5.m5.1d">roman_NDCG</annotation></semantics></math> metric from sampled ranks <math alttext="\tilde{r}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m6.1"><semantics id="S4.SS2.p1.6.m6.1a"><mover accent="true" id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">r</mi><mo id="S4.SS2.p1.6.m6.1.1.1" xref="S4.SS2.p1.6.m6.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><ci id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1.1">~</ci><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\tilde{r}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.6.m6.1d">over~ start_ARG italic_r end_ARG</annotation></semantics></math>.
This is a promising direction for future work.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Evaluation</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This section investigates the batched versions of LambdaRank and WARP as well as the importance of improved rank estimation.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Setup</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.3">Our study is carried out on two well established item recommendation benchmarks: Movielens 20M (ML20M) <cite class="ltx_cite ltx_citemacro_citep">(Harper and
Konstan, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib6" title="">2015</a>)</cite> and Million Song Dataset (MSD) <cite class="ltx_cite ltx_citemacro_citep">(Bertin-Mahieux et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib3" title="">2011</a>)</cite>.
We follow the data preprocessing and data splits from <cite class="ltx_cite ltx_citemacro_citep">(Liang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib12" title="">2018</a>)</cite><span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/dawenl/vae_cf" title="">https://github.com/dawenl/vae_cf</a></span></span></span> which have been used by several studies, e.g., <cite class="ltx_cite ltx_citemacro_citep">(Shenbin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib16" title="">2020</a>; Kim and Suh, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib9" title="">2019</a>; Khawar
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib8" title="">2020</a>; Lobel
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib13" title="">2020</a>; Steck, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib17" title="">2019</a>)</cite>.
We refer the reader to <cite class="ltx_cite ltx_citemacro_citep">(Liang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib12" title="">2018</a>)</cite> for details about data preprocessing.
The preprocessed datasets contain user interactions with items from catalogs of about 20k movies (ML20M) and 41k songs (MSD).
The dataset split of <cite class="ltx_cite ltx_citemacro_citep">(Liang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib12" title="">2018</a>)</cite> holds out 20% of the interactions of 20k users (ML20M) and 100k users (MSD) for evaluation purposes.
We train the models on the remaining 80% of the interactions of the evaluation users and on all the interactions of the remaining users.
We measure the <math alttext="\mathrm{Recall}@20" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">Recall</mi><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mi id="S5.SS1.p1.1.m1.1.1.3" mathvariant="normal" xref="S5.SS1.p1.1.m1.1.1.3.cmml">@</mi><mo id="S5.SS1.p1.1.m1.1.1.1a" xref="S5.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><mn id="S5.SS1.p1.1.m1.1.1.4" xref="S5.SS1.p1.1.m1.1.1.4.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><times id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></times><ci id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">Recall</ci><ci id="S5.SS1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.p1.1.m1.1.1.3">@</ci><cn id="S5.SS1.p1.1.m1.1.1.4.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.4">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">\mathrm{Recall}@20</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">roman_Recall @ 20</annotation></semantics></math>, <math alttext="\mathrm{Recall}@50" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">Recall</mi><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.SS1.p1.2.m2.1.1.3" mathvariant="normal" xref="S5.SS1.p1.2.m2.1.1.3.cmml">@</mi><mo id="S5.SS1.p1.2.m2.1.1.1a" xref="S5.SS1.p1.2.m2.1.1.1.cmml">⁢</mo><mn id="S5.SS1.p1.2.m2.1.1.4" xref="S5.SS1.p1.2.m2.1.1.4.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><times id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></times><ci id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">Recall</ci><ci id="S5.SS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.p1.2.m2.1.1.3">@</ci><cn id="S5.SS1.p1.2.m2.1.1.4.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.4">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">\mathrm{Recall}@50</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">roman_Recall @ 50</annotation></semantics></math> and <math alttext="\mathrm{NDCG}@100" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">NDCG</mi><mo id="S5.SS1.p1.3.m3.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.cmml">⁢</mo><mi id="S5.SS1.p1.3.m3.1.1.3" mathvariant="normal" xref="S5.SS1.p1.3.m3.1.1.3.cmml">@</mi><mo id="S5.SS1.p1.3.m3.1.1.1a" xref="S5.SS1.p1.3.m3.1.1.1.cmml">⁢</mo><mn id="S5.SS1.p1.3.m3.1.1.4" xref="S5.SS1.p1.3.m3.1.1.4.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><times id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1"></times><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">NDCG</ci><ci id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3">@</ci><cn id="S5.SS1.p1.3.m3.1.1.4.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1.4">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">\mathrm{NDCG}@100</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">roman_NDCG @ 100</annotation></semantics></math> metrics on the evaluation users.
The evaluation users are divided into two sets of equal size: the tuning users and the test users.
We use the average metrics of the tuning users for hyperparameter tuning and we report the average metrics on the test users.
The test set for which we report our results is identical to <cite class="ltx_cite ltx_citemacro_citep">(Liang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib12" title="">2018</a>)</cite>.
Our evaluation protocol differs slightly from <cite class="ltx_cite ltx_citemacro_citep">(Liang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib12" title="">2018</a>)</cite> because we learn the user embeddings of test users together with all remaining users.
The reason is that (i) unlike autoencoder models (e.g., <cite class="ltx_cite ltx_citemacro_citep">(Liang
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib12" title="">2018</a>; Steck, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib17" title="">2019</a>)</cite>) that have only item embeddings, our model also requires user embeddings and (ii) unlike the iALS training method <cite class="ltx_cite ltx_citemacro_citep">(Hu
et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib7" title="">2008</a>)</cite>, our gradient descent based training does not offer a closed form equation to compute user embeddings.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">Our proposed learning method is general and not tied to a particular model.
In our study, we demonstrate the learning algorithm on the matrix factorization model.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T2.1.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S5.T2.1.1.1.2" style="padding-left:4.0pt;padding-right:4.0pt;">ML20M</th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.3" style="padding-left:4.0pt;padding-right:4.0pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S5.T2.1.1.1.4" style="padding-left:4.0pt;padding-right:4.0pt;">MSD</th>
</tr>
<tr class="ltx_tr" id="S5.T2.1.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T2.1.2.2.1" style="padding-left:4.0pt;padding-right:4.0pt;"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S5.T2.1.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">R20</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S5.T2.1.2.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">R50</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S5.T2.1.2.2.4" style="padding-left:4.0pt;padding-right:4.0pt;">N100</th>
<th class="ltx_td ltx_th ltx_th_column" id="S5.T2.1.2.2.5" style="padding-left:4.0pt;padding-right:4.0pt;"></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S5.T2.1.2.2.6" style="padding-left:4.0pt;padding-right:4.0pt;">R20</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S5.T2.1.2.2.7" style="padding-left:4.0pt;padding-right:4.0pt;">R50</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column" id="S5.T2.1.2.2.8" style="padding-left:4.0pt;padding-right:4.0pt;">N100</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.3.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">WARP (from <cite class="ltx_cite ltx_citemacro_citep">(Shenbin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib16" title="">2020</a>)</cite>)</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.3.1.2" style="padding-left:4.0pt;padding-right:4.0pt;">0.314</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.3.1.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.466</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.3.1.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.341</td>
<td class="ltx_td ltx_border_t" id="S5.T2.1.3.1.5" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.3.1.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.206</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.3.1.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.302</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.3.1.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.249</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T2.1.4.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">WARP (ours)</th>
<td class="ltx_td ltx_align_right" id="S5.T2.1.4.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">0.345</td>
<td class="ltx_td ltx_align_right" id="S5.T2.1.4.2.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.480</td>
<td class="ltx_td ltx_align_right" id="S5.T2.1.4.2.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.382</td>
<td class="ltx_td" id="S5.T2.1.4.2.5" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_right" id="S5.T2.1.4.2.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.240</td>
<td class="ltx_td ltx_align_right" id="S5.T2.1.4.2.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.350</td>
<td class="ltx_td ltx_align_right" id="S5.T2.1.4.2.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.292</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T2.1.5.3.1" style="padding-left:4.0pt;padding-right:4.0pt;">LambdaNet (from <cite class="ltx_cite ltx_citemacro_citep">(Shenbin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib16" title="">2020</a>)</cite>)</th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.5.3.2" style="padding-left:4.0pt;padding-right:4.0pt;">0.395</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.5.3.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.534</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.5.3.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.427</td>
<td class="ltx_td ltx_border_t" id="S5.T2.1.5.3.5" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.5.3.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.259</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.5.3.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.355</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S5.T2.1.5.3.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.308</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T2.1.6.4.1" style="padding-left:4.0pt;padding-right:4.0pt;">LambdaRank (ours)</th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.1.6.4.2" style="padding-left:4.0pt;padding-right:4.0pt;">0.379</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.1.6.4.3" style="padding-left:4.0pt;padding-right:4.0pt;">0.503</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.1.6.4.4" style="padding-left:4.0pt;padding-right:4.0pt;">0.401</td>
<td class="ltx_td ltx_border_bb" id="S5.T2.1.6.4.5" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.1.6.4.6" style="padding-left:4.0pt;padding-right:4.0pt;">0.269</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.1.6.4.7" style="padding-left:4.0pt;padding-right:4.0pt;">0.370</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S5.T2.1.6.4.8" style="padding-left:4.0pt;padding-right:4.0pt;">0.314</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2. </span>Comparison of our batched algorithms with sampling to existing results for WARP and LambdaRank.</figcaption>
</figure>
<figure class="ltx_figure" id="S5.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="439" id="S5.F1.g1" src="x1.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Evaluation of batched versions of WARP and LambdaRank with different negative sample sizes.</figcaption>
</figure>
<figure class="ltx_figure" id="S5.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="472" id="S5.F2.g1" src="x2.png" width="581"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Effect of correction at various thresholds k of <math alttext="\mathrm{NDCG}@k" class="ltx_Math" display="inline" id="S5.F2.2.m1.1"><semantics id="S5.F2.2.m1.1b"><mrow id="S5.F2.2.m1.1.1" xref="S5.F2.2.m1.1.1.cmml"><mi id="S5.F2.2.m1.1.1.2" xref="S5.F2.2.m1.1.1.2.cmml">NDCG</mi><mo id="S5.F2.2.m1.1.1.1" xref="S5.F2.2.m1.1.1.1.cmml">⁢</mo><mi id="S5.F2.2.m1.1.1.3" mathvariant="normal" xref="S5.F2.2.m1.1.1.3.cmml">@</mi><mo id="S5.F2.2.m1.1.1.1b" xref="S5.F2.2.m1.1.1.1.cmml">⁢</mo><mi id="S5.F2.2.m1.1.1.4" xref="S5.F2.2.m1.1.1.4.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.F2.2.m1.1c"><apply id="S5.F2.2.m1.1.1.cmml" xref="S5.F2.2.m1.1.1"><times id="S5.F2.2.m1.1.1.1.cmml" xref="S5.F2.2.m1.1.1.1"></times><ci id="S5.F2.2.m1.1.1.2.cmml" xref="S5.F2.2.m1.1.1.2">NDCG</ci><ci id="S5.F2.2.m1.1.1.3.cmml" xref="S5.F2.2.m1.1.1.3">@</ci><ci id="S5.F2.2.m1.1.1.4.cmml" xref="S5.F2.2.m1.1.1.4">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.2.m1.1d">\mathrm{NDCG}@k</annotation><annotation encoding="application/x-llamapun" id="S5.F2.2.m1.1e">roman_NDCG @ italic_k</annotation></semantics></math> for LambdaRank.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Results</h3>
<section class="ltx_subsubsection" id="S5.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.1. </span>Batch Training with Negative Sampling</h4>
<div class="ltx_para" id="S5.SS2.SSS1.p1">
<p class="ltx_p" id="S5.SS2.SSS1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5.T2" title="Table 2 ‣ 5.1. Setup ‣ 5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">2</span></a> compares our batched algorithms with negative sampling to existing results for WARP and LambdaRank from <cite class="ltx_cite ltx_citemacro_citep">(Shenbin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib16" title="">2020</a>)</cite>.
Our batch trained WARP with negative sampling improves over previous results on both the MSD and ML20M datasets.
Our LambdaRank with negative sampling outperforms the previously reported LambdaRank results on MSD but underperforms previous results on ML20M.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.2. </span>Effect of Sample Sizes</h4>
<div class="ltx_para" id="S5.SS2.SSS2.p1">
<p class="ltx_p" id="S5.SS2.SSS2.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5.F1" title="Figure 1 ‣ 5.1. Setup ‣ 5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">1</span></a> compares the prediction quality of batch training methods with different negative sample sizes.
The ranks are estimated from the sampled items <math alttext="\tilde{\mathcal{I}}" class="ltx_Math" display="inline" id="S5.SS2.SSS2.p1.1.m1.1"><semantics id="S5.SS2.SSS2.p1.1.m1.1a"><mover accent="true" id="S5.SS2.SSS2.p1.1.m1.1.1" xref="S5.SS2.SSS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.SSS2.p1.1.m1.1.1.2" xref="S5.SS2.SSS2.p1.1.m1.1.1.2.cmml">ℐ</mi><mo id="S5.SS2.SSS2.p1.1.m1.1.1.1" xref="S5.SS2.SSS2.p1.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS2.p1.1.m1.1b"><apply id="S5.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS2.p1.1.m1.1.1"><ci id="S5.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS2.p1.1.m1.1.1.1">~</ci><ci id="S5.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS2.p1.1.m1.1.1.2">ℐ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS2.p1.1.m1.1c">\tilde{\mathcal{I}}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS2.p1.1.m1.1d">over~ start_ARG caligraphic_I end_ARG</annotation></semantics></math>.
For LambdaRank, we show versions with and without correction and for WARP we always apply the correction.
The plots show that increasing the sample size improves the quality.</p>
</div>
<div class="ltx_para" id="S5.SS2.SSS2.p2">
<p class="ltx_p" id="S5.SS2.SSS2.p2.1">LambdaRank with correction performs in general better than LambdaRank without correction.
The benefits of correction is particularly strong for small sample sizes.
This finding is consistent with the theory where the bias decreases with larger sample sizes.</p>
</div>
<div class="ltx_para" id="S5.SS2.SSS2.p3">
<p class="ltx_p" id="S5.SS2.SSS2.p3.1">In general, LambdaRank (with and without correction) performs better than WARP.
Only for very small sample sizes, WARP performs better than uncorrected LambdaRank.
This indicates that in the small sample regime correction is especially important.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.2.3. </span>Effect of Evaluation Threshold</h4>
<div class="ltx_para" id="S5.SS2.SSS3.p1">
<p class="ltx_p" id="S5.SS2.SSS3.p1.5">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#S5.F2" title="Figure 2 ‣ 5.1. Setup ‣ 5. Evaluation ‣ Improved Estimation of Ranks for Learning Item Recommenders with Negative Sampling"><span class="ltx_text ltx_ref_tag">2</span></a> shows the quality for different LambdaRank version when varying the cutoff <math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.SSS3.p1.1.m1.1"><semantics id="S5.SS2.SSS3.p1.1.m1.1a"><mi id="S5.SS2.SSS3.p1.1.m1.1.1" xref="S5.SS2.SSS3.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.1.m1.1b"><ci id="S5.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS3.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS3.p1.1.m1.1d">italic_k</annotation></semantics></math> of the evaluation metric <math alttext="\mathrm{NDCG}@k" class="ltx_Math" display="inline" id="S5.SS2.SSS3.p1.2.m2.1"><semantics id="S5.SS2.SSS3.p1.2.m2.1a"><mrow id="S5.SS2.SSS3.p1.2.m2.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.cmml"><mi id="S5.SS2.SSS3.p1.2.m2.1.1.2" xref="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml">NDCG</mi><mo id="S5.SS2.SSS3.p1.2.m2.1.1.1" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.SS2.SSS3.p1.2.m2.1.1.3" mathvariant="normal" xref="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml">@</mi><mo id="S5.SS2.SSS3.p1.2.m2.1.1.1a" xref="S5.SS2.SSS3.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S5.SS2.SSS3.p1.2.m2.1.1.4" xref="S5.SS2.SSS3.p1.2.m2.1.1.4.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.2.m2.1b"><apply id="S5.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1"><times id="S5.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.1"></times><ci id="S5.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.2">NDCG</ci><ci id="S5.SS2.SSS3.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.3">@</ci><ci id="S5.SS2.SSS3.p1.2.m2.1.1.4.cmml" xref="S5.SS2.SSS3.p1.2.m2.1.1.4">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.2.m2.1c">\mathrm{NDCG}@k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS3.p1.2.m2.1d">roman_NDCG @ italic_k</annotation></semantics></math>.
In general, the prediction quality of all sample sizes reduces when the metric gets more top-heavy (i.e., <math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.SSS3.p1.3.m3.1"><semantics id="S5.SS2.SSS3.p1.3.m3.1a"><mi id="S5.SS2.SSS3.p1.3.m3.1.1" xref="S5.SS2.SSS3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.3.m3.1b"><ci id="S5.SS2.SSS3.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS3.p1.3.m3.1d">italic_k</annotation></semantics></math> smaller).
While the overall trends look similar, the quality gap between larger sample sizes (<math alttext="m=256" class="ltx_Math" display="inline" id="S5.SS2.SSS3.p1.4.m4.1"><semantics id="S5.SS2.SSS3.p1.4.m4.1a"><mrow id="S5.SS2.SSS3.p1.4.m4.1.1" xref="S5.SS2.SSS3.p1.4.m4.1.1.cmml"><mi id="S5.SS2.SSS3.p1.4.m4.1.1.2" xref="S5.SS2.SSS3.p1.4.m4.1.1.2.cmml">m</mi><mo id="S5.SS2.SSS3.p1.4.m4.1.1.1" xref="S5.SS2.SSS3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS3.p1.4.m4.1.1.3" xref="S5.SS2.SSS3.p1.4.m4.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.4.m4.1b"><apply id="S5.SS2.SSS3.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS3.p1.4.m4.1.1"><eq id="S5.SS2.SSS3.p1.4.m4.1.1.1.cmml" xref="S5.SS2.SSS3.p1.4.m4.1.1.1"></eq><ci id="S5.SS2.SSS3.p1.4.m4.1.1.2.cmml" xref="S5.SS2.SSS3.p1.4.m4.1.1.2">𝑚</ci><cn id="S5.SS2.SSS3.p1.4.m4.1.1.3.cmml" type="integer" xref="S5.SS2.SSS3.p1.4.m4.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.4.m4.1c">m=256</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS3.p1.4.m4.1d">italic_m = 256</annotation></semantics></math>) and smaller sample sizes (<math alttext="m=64" class="ltx_Math" display="inline" id="S5.SS2.SSS3.p1.5.m5.1"><semantics id="S5.SS2.SSS3.p1.5.m5.1a"><mrow id="S5.SS2.SSS3.p1.5.m5.1.1" xref="S5.SS2.SSS3.p1.5.m5.1.1.cmml"><mi id="S5.SS2.SSS3.p1.5.m5.1.1.2" xref="S5.SS2.SSS3.p1.5.m5.1.1.2.cmml">m</mi><mo id="S5.SS2.SSS3.p1.5.m5.1.1.1" xref="S5.SS2.SSS3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS3.p1.5.m5.1.1.3" xref="S5.SS2.SSS3.p1.5.m5.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS3.p1.5.m5.1b"><apply id="S5.SS2.SSS3.p1.5.m5.1.1.cmml" xref="S5.SS2.SSS3.p1.5.m5.1.1"><eq id="S5.SS2.SSS3.p1.5.m5.1.1.1.cmml" xref="S5.SS2.SSS3.p1.5.m5.1.1.1"></eq><ci id="S5.SS2.SSS3.p1.5.m5.1.1.2.cmml" xref="S5.SS2.SSS3.p1.5.m5.1.1.2">𝑚</ci><cn id="S5.SS2.SSS3.p1.5.m5.1.1.3.cmml" type="integer" xref="S5.SS2.SSS3.p1.5.m5.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS3.p1.5.m5.1c">m=64</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.SSS3.p1.5.m5.1d">italic_m = 64</annotation></semantics></math>) increases when the task gets harder (more top-heavy).</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.2">In this work, we have shown that methods that have been previously proposed for correcting sampled metrics can be applied to improve training algorithms with negative sampling.
We demonstrated this on WARP and LambdaRank, two well-known learning algorithms that depend on the rank of items.
We proposed sampled batch training versions of these algorithms and applied the correction methods to estimate ranks from samples of negative items.
We studied the benefits from the corrected rank estimates empirically.
Our experiments show that the proposed rank estimates improve the prediction quality over the naive computation of ranks on the sample.
Finally, we make a note that the proposed corrections are not restricted to WARP and LambdaRank but can be applied to any algorithm that performs loss calculation using ranking metrics.
A direction for further improvements would be to apply the metric correction methods from <cite class="ltx_cite ltx_citemacro_citep">(Krichene and
Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2410.06371v2#bib.bib11" title="">2020</a>)</cite>, in particular trading off the bias-variance when estimating the weighting function <math alttext="\alpha" class="ltx_Math" display="inline" id="S6.p1.1.m1.1"><semantics id="S6.p1.1.m1.1a"><mi id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S6.p1.1.m1.1d">italic_α</annotation></semantics></math> from samples.
This could further improve over correcting the rank as described in our work because the weighting function <math alttext="\alpha" class="ltx_Math" display="inline" id="S6.p1.2.m2.1"><semantics id="S6.p1.2.m2.1a"><mi id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><ci id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S6.p1.2.m2.1d">italic_α</annotation></semantics></math> is the quantity that we are ultimately interested in.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio and
Senecal (2003)</span>
<span class="ltx_bibblock">
Yoshua Bengio and
Jean-Sébastien Senecal.
2003.

</span>
<span class="ltx_bibblock">Quick Training of Probabilistic Neural Nets by
Importance Sampling. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the Ninth
International Workshop on Artificial Intelligence and Statistics, AISTATS
2003, Key West, Florida, USA, January 3-6, 2003</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bertin-Mahieux et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Thierry Bertin-Mahieux,
Daniel Ellis, Brian Whitman, and
Paul Lamere. 2011.

</span>
<span class="ltx_bibblock">The Million Song Dataset.. In
<em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">In Proceedings of the 12th International Conference
on Music Information Retrieval</em>. ISMIR,
Miami, 591–596.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Blanc and Rendle (2018)</span>
<span class="ltx_bibblock">
Guy Blanc and Steffen
Rendle. 2018.

</span>
<span class="ltx_bibblock">Adaptive Sampled Softmax with Kernel Based
Sampling. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Proceedings of the 35th International
Conference on Machine Learning</em> <em class="ltx_emph ltx_font_italic" id="bib.bib4.2.2">(Proceedings of
Machine Learning Research)</em>, Jennifer Dy
and Andreas Krause (Eds.), Vol. 80.
PMLR, Stockholmsmässan, Stockholm
Sweden, 590–599.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Burges (2010)</span>
<span class="ltx_bibblock">
Chris J.C. Burges.
2010.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">From RankNet to LambdaRank to LambdaMART:
An Overview</em>.

</span>
<span class="ltx_bibblock">Technical Report MSR-TR-2010-82.
Microsoft, Redmond, USA.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.microsoft.com/en-us/research/publication/from-ranknet-to-lambdarank-to-lambdamart-an-overview/" title="">https://www.microsoft.com/en-us/research/publication/from-ranknet-to-lambdarank-to-lambdamart-an-overview/</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and
Konstan (2015)</span>
<span class="ltx_bibblock">
F. Maxwell Harper and
Joseph A. Konstan. 2015.

</span>
<span class="ltx_bibblock">The MovieLens Datasets: History and Context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">ACM Trans. Interact. Intell. Syst.</em>
5, 4, Article 19
(Dec. 2015), 19 pages.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2827872" title="">https://doi.org/10.1145/2827872</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu
et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2008)</span>
<span class="ltx_bibblock">
Yifan Hu, Yehuda Koren,
and Chris Volinsky. 2008.

</span>
<span class="ltx_bibblock">Collaborative Filtering for Implicit Feedback
Datasets. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the 2008 Eighth IEEE
International Conference on Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib7.4.2">(ICDM
’08)</em>. 263–272.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khawar
et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Farhan Khawar, Leonard
Poon, and Nevin L. Zhang.
2020.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Learning the Structure of Auto-Encoding
Recommenders</em>.

</span>
<span class="ltx_bibblock">Association for Computing Machinery,
New York, NY, USA, 519–529.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3366423.3380135" title="">https://doi.org/10.1145/3366423.3380135</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim and Suh (2019)</span>
<span class="ltx_bibblock">
Daeryong Kim and Bongwon
Suh. 2019.

</span>
<span class="ltx_bibblock">Enhancing VAEs for Collaborative Filtering:
Flexible Priors &amp; Gating Mechanisms. In
<em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 13th ACM Conference on
Recommender Systems</em> <em class="ltx_emph ltx_font_italic" id="bib.bib9.2.2">(RecSys ’19)</em>.
Association for Computing Machinery,
New York, NY, USA, 403–407.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3298689.3347015" title="">https://doi.org/10.1145/3298689.3347015</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krichene et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Walid Krichene, Nicolas
Mayoraz, Steffen Rendle, Li Zhang,
Xinyang Yi, Lichan Hong,
Ed Chi, and John Anderson.
2019.

</span>
<span class="ltx_bibblock">Efficient Training on Very Large Corpora via
Gramian Estimation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">7th International Conference on Learning
Representations</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krichene and
Rendle (2020)</span>
<span class="ltx_bibblock">
Walid Krichene and
Steffen Rendle. 2020.

</span>
<span class="ltx_bibblock">On Sampled Metrics for Item Recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the 26th ACM SIGKDD International
Conference on Knowledge Discovery &amp; Data Mining</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib11.2.2">(KDD ’20)</em>. Association for
Computing Machinery, New York, NY, USA,
1748–1757.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3394486.3403226" title="">https://doi.org/10.1145/3394486.3403226</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang
et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Dawen Liang, Rahul G.
Krishnan, Matthew D. Hoffman, and Tony
Jebara. 2018.

</span>
<span class="ltx_bibblock">Variational Autoencoders for Collaborative
Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the 2018 World Wide
Web Conference</em> <em class="ltx_emph ltx_font_italic" id="bib.bib12.4.2">(WWW ’18)</em>.
International World Wide Web Conferences Steering
Committee, Republic and Canton of Geneva, CHE,
689–698.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3178876.3186150" title="">https://doi.org/10.1145/3178876.3186150</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lobel
et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Sam Lobel, Chunyuan Li,
Jianfeng Gao, and Lawrence Carin.
2020.

</span>
<span class="ltx_bibblock">RaCT: Toward Amortized Ranking-Critical Training
For Collaborative Filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">8th International
Conference on Learning Representations, ICLR 2020, Addis Ababa, Ethiopia,
April 26-30, 2020</em>. ICLR, Appleton,
WI, 19.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2022)</span>
<span class="ltx_bibblock">
Steffen Rendle.
2022.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Item Recommendation from Implicit
Feedback</em>.

</span>
<span class="ltx_bibblock">Springer US, New York, NY,
143–171.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1007/978-1-0716-2197-4_4" title="">https://doi.org/10.1007/978-1-0716-2197-4_4</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle and
Freudenthaler (2014)</span>
<span class="ltx_bibblock">
Steffen Rendle and
Christoph Freudenthaler. 2014.

</span>
<span class="ltx_bibblock">Improving Pairwise Learning for Item Recommendation
from Implicit Feedback. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 7th
ACM International Conference on Web Search and Data Mining</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib15.2.2">(WSDM ’14)</em>. Association for
Computing Machinery, New York, NY, USA,
273–282.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2556195.2556248" title="">https://doi.org/10.1145/2556195.2556248</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shenbin et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Ilya Shenbin, Anton
Alekseev, Elena Tutubalina, Valentin
Malykh, and Sergey I. Nikolenko.
2020.

</span>
<span class="ltx_bibblock">RecVAE: A New Variational Autoencoder for Top-N
Recommendations with Implicit Feedback. In
<em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 13th International Conference on
Web Search and Data Mining</em> <em class="ltx_emph ltx_font_italic" id="bib.bib16.4.2">(WSDM ’20)</em>.
Association for Computing Machinery,
New York, NY, USA, 528–536.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3336191.3371831" title="">https://doi.org/10.1145/3336191.3371831</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Steck (2019)</span>
<span class="ltx_bibblock">
Harald Steck.
2019.

</span>
<span class="ltx_bibblock">Embarrassingly Shallow Autoencoders for Sparse
Data. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">The World Wide Web Conference</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib17.2.2">(WWW ’19)</em>. Association for
Computing Machinery, New York, NY, USA,
3251–3257.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3308558.3313710" title="">https://doi.org/10.1145/3308558.3313710</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Weston
et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2011)</span>
<span class="ltx_bibblock">
Jason Weston, Samy
Bengio, and Nicolas Usunier.
2011.

</span>
<span class="ltx_bibblock">WSABIE: Scaling up to Large Vocabulary Image
Annotation. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of the Twenty-Second
International Joint Conference on Artificial Intelligence - Volume Volume
Three</em> <em class="ltx_emph ltx_font_italic" id="bib.bib18.4.2">(IJCAI’11)</em>. AAAI Press,
Barcelona, 2764–2770.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan
et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Fajie Yuan, Guibing Guo,
Joemon M. Jose, Long Chen,
Haitao Yu, and Weinan Zhang.
2016.

</span>
<span class="ltx_bibblock">LambdaFM: Learning Optimal Ranking with
Factorization Machines Using Lambda Surrogates. In
<em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the 25th ACM International on
Conference on Information and Knowledge Management</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib19.4.2">(CIKM ’16)</em>. Association for
Computing Machinery, New York, NY, USA,
227–236.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/2983323.2983758" title="">https://doi.org/10.1145/2983323.2983758</a>
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Oct 10 19:47:39 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
