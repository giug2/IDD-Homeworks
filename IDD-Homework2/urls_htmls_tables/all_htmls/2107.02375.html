<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2107.02375] SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging</title><meta property="og:description" content="Federated learning is an emerging research paradigm for enabling collaboratively training deep learning models without sharing patient data. However, the data from different institutions are usually heterogeneous acros…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2107.02375">

<!--Generated on Sat Mar  9 01:45:10 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Miao Zhang
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Liangqiong Qu
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Praveer Singh
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Jayashree Kalpathy-Cramer
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Daniel L. Rubin
</span><span class="ltx_author_notes">Manuscript received June 20, 2021. This work was supported in part by a grant from the NCI, U01CA242879. (corresponding authors: Liangqiong Qu and Daniel L. RubinMiao Zhang and Liangqiong Qu are with Department of Biomedical Data Science, Stanford University, United States (e-mail: miaozhangmi@gmail.com; liangqi@stanford.edu).Praveer Singh and Jayashree Kalpathy-Cramer are Athinoula A. Martinos Center for Biomedical Imaging, Massachusetts General Hospital, United States. (e-mail: psingh19@mgh.harvard.edu; kalpathy@nmr.mgh.harvard.edu).Daniel L. Rubin is with Department of Biomedical Data Science and Radiology, Stanford University, United States (e-mail: dlrubin@stanford.edu).Miao Zhang and Liangqiong Qu contributed equally.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning is an emerging research paradigm for enabling collaboratively training deep learning models without sharing patient data. However, the data from different institutions are usually heterogeneous across institutions, which may reduce the performance of models trained using federated learning. In this study, we propose a novel heterogeneity-aware federated learning method, SplitAVG, to overcome the performance drops from data heterogeneity in federated learning. Unlike previous federated methods that require complex heuristic training or hyper parameter tuning, our SplitAVG leverages the simple network split and feature map concatenation strategies to encourage the federated model training an unbiased estimator of the target data distribution. We compare SplitAVG with seven state-of-the-art federated learning methods, using centrally hosted training data as the baseline on a suite of both synthetic and real-world federated datasets. We find that the performance of models trained using all the comparison federated learning methods degraded significantly with the increasing degrees of data heterogeneity. In contrast, SplitAVG method achieves comparable results to the baseline method under all heterogeneous settings, that it achieves 96.2% of the accuracy and 110.4% of the mean absolute error obtained by the baseline in a diabetic retinopathy binary classification dataset and a bone age prediction dataset, respectively, on highly heterogeneous data partitions. We conclude that SplitAVG method can effectively overcome the performance drops from variability in data distributions across institutions. Experimental results also show that SplitAVG can be adapted to different base convolutional neural networks (CNNs) and generalized to various types of medical imaging tasks. The code is publicly available at <a target="_blank" href="https://github.com/zm17943/SplitAVG" title="" class="ltx_ref ltx_href">https://github.com/zm17943/SplitAVG</a>.</p>
</div>
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">{IEEEkeywords}</span>
<p id="p1.2" class="ltx_p">Biomedical imaging, Data heterogeneity, Federated learning</p>
</div>
<figure id="S0.F1" class="ltx_figure">
<p id="S0.F1.1" class="ltx_p ltx_align_center"><span id="S0.F1.1.1" class="ltx_text"><img src="/html/2107.02375/assets/picture/Architecture.png" id="S0.F1.1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="484" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Architecture of Split Averaging (SplitAVG): A deep learning network is split into two sub-networks at a pre-defined cut layer. An institutional sub-network resides at each local institution, and a server-based sub-network resides on a central server.</figcaption>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Deep learning techniques and advances in computer hardware offer the promise of great advances in various medical applications, e.g., diagnosing ocular diseases <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, detecting glaucoma from optical coherence tomography images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, identifying serious illnesses with natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, and providing appropriate treatment recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. However, training a robust deep learning model that generalizes across centers often requires a tremendous amount of training cases. The amount of patient data at individual medical institutions, or even in public data repositories such as The Cancer Imaging Archive, is often limited, especially for rarer diseases <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Aggregating patient data from multiple centers is often complicated owing to patient privacy, legal regulatory barriers to data sharing, and inefficiency of moving large amounts of data. As such, federated learning (also termed as “collaborative learning” or “distributed learning”), where the training of a global deep learning model is performed locally at each institution without sharing raw data, has become a promising alternative for accessing large scale data to train robust deep learning models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Existing federated learning methods can be grouped into aggregation-based federated learning methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> and transfer-based methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Aggregation-based federated learning methods repeatedly average weights or gradient updates of the models trained at local institutions, such as Federated Averaging (FedAvg) and Federated stochastic gradient descent (FedSGD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. Transfer-based methods train a model at each local institution for specific number of iterations and then transfer full or part of the model weights to next institution until model convergence, such as in Cyclical weight transfer (CWT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and SplitNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> respectively.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">One of the key challenges to federated learning algorithms is mitigating the effects of data heterogeneity among participating institutions on performance of the final learned model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. The distributed nature of federated learning means that there can be substantial heterogeneity in the distributions of training data across institutions. Aggregation-based methods like FedAvg can be robust to certain non-IID (independent and identically distributed) settings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, but the accuracy of the synchronized averaged model reduces significantly on highly skewed data partitions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Transfer-based methods may also lose model performance when heterogeneity exists in the training data across institutions, since the model trained in cyclic transferring way always suffers from catastrophic forgetting on non-IID settings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. It has been demonstrated that training on non-IID data partitions is a pervasive problem for federated learning methods, and it always degrades the performance of deep learning models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Several recent efforts have been devoted to overcoming the degrading effects of heterogeneous data across institutions in federated learning. The related studies include adding momentum to server model weight updates to prevent client updates trained on non-IID data partitions from diverging (FedAvgM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, applying the group normalization (Group Norm) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> layers as the alternative of batch normalization to avoid the skew-induced accuracy loss of the batch normalization layer for non-IID data (FedSGD+GD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, and sharing a subset of global data with local institutions to improve the training of FedAvg by mitigating weight divergence due to non-IID data (FedAVG+SD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Though these are promising approaches, the current approaches only work well on partitions with mild data distribution heterogeneity and still suffer performance drops on highly heterogeneous cases (see the comparison results in Fig.5 for details).</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this study, we propose a novel federated learning technique, Split Averaging (SplitAVG), to overcome the deleterious effects of heterogenous data distributions across institutions<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The data heterogeneity in our study indicates heterogeneity from cross-institution data, also written as non-IID or data skew.</span></span></span> in federated learning. At the heart of SplitAVG is a network splitting operation and an intermediate feature map concatenation strategy. Specifically, our SplitAVG splits the network into an institutional sub-network (residing at the local institutions) and a server-based sub-network (residing on a central server) at a predefined layer of the network (see Fig. <a href="#S0.F1" title="Figure 1 ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). As the training examples in each local institution are sampled from institution-specific data distribution, which is a biased-estimator of the actual distribution of the whole population on non-IID data partitions, we further apply a concatenation operation on the central server to concatenate all the intermediate feature maps collecting from the institutional sub-networks. This concatenation operation allows our SplitAVG method to learn from the union of institution-specific data distribution rather than directly learning a biased-estimator of the actual distribution of the whole population, thus working well on both IID and non-IID data partitions. Our experimental results demonstrate the capability of the proposed method in handling unbalanced and non-IID data partitions.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The remainder of this paper is organized as follows: 1) present our SplitAVG algorithm, detail its forward propagation and back propagation training stage, 2) detail the binary classification dataset and regression datasets used to evaluate our method, 3) compare SplitAVG with seven state-of-the-art federated learning methods and the baseline centrally-hosted method, 4) present the experimental setup, and 5) provide an experimental evaluation of SplitAVG and its comparison methods on both IID data partitions and various non-IID data partitions.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>MATERIALS and METHODS</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>SplitAVG</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">In this section, we outline our proposed federated learning platform, SplitAVG (see Fig. <a href="#S0.F1" title="Figure 1 ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), and provide a prospective to understand the advantage of the proposed method.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.10" class="ltx_p">Define the deep learning network involved in SplitAVG as a function <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">F</annotation></semantics></math>, which consists of a list of <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">N</annotation></semantics></math> sequential layers, i.e., <math id="S2.SS1.p2.3.m3.6" class="ltx_Math" alttext="F=\{l1,l2,…,lc,…,lN\}" display="inline"><semantics id="S2.SS1.p2.3.m3.6a"><mrow id="S2.SS1.p2.3.m3.6.6" xref="S2.SS1.p2.3.m3.6.6.cmml"><mi id="S2.SS1.p2.3.m3.6.6.6" xref="S2.SS1.p2.3.m3.6.6.6.cmml">F</mi><mo id="S2.SS1.p2.3.m3.6.6.5" xref="S2.SS1.p2.3.m3.6.6.5.cmml">=</mo><mrow id="S2.SS1.p2.3.m3.6.6.4.4" xref="S2.SS1.p2.3.m3.6.6.4.5.cmml"><mo stretchy="false" id="S2.SS1.p2.3.m3.6.6.4.4.5" xref="S2.SS1.p2.3.m3.6.6.4.5.cmml">{</mo><mrow id="S2.SS1.p2.3.m3.3.3.1.1.1" xref="S2.SS1.p2.3.m3.3.3.1.1.1.cmml"><mi id="S2.SS1.p2.3.m3.3.3.1.1.1.2" xref="S2.SS1.p2.3.m3.3.3.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.3.m3.3.3.1.1.1.1" xref="S2.SS1.p2.3.m3.3.3.1.1.1.1.cmml">​</mo><mn id="S2.SS1.p2.3.m3.3.3.1.1.1.3" xref="S2.SS1.p2.3.m3.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p2.3.m3.6.6.4.4.6" xref="S2.SS1.p2.3.m3.6.6.4.5.cmml">,</mo><mrow id="S2.SS1.p2.3.m3.4.4.2.2.2" xref="S2.SS1.p2.3.m3.4.4.2.2.2.cmml"><mi id="S2.SS1.p2.3.m3.4.4.2.2.2.2" xref="S2.SS1.p2.3.m3.4.4.2.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.3.m3.4.4.2.2.2.1" xref="S2.SS1.p2.3.m3.4.4.2.2.2.1.cmml">​</mo><mn id="S2.SS1.p2.3.m3.4.4.2.2.2.3" xref="S2.SS1.p2.3.m3.4.4.2.2.2.3.cmml">2</mn></mrow><mo id="S2.SS1.p2.3.m3.6.6.4.4.7" xref="S2.SS1.p2.3.m3.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">…</mi><mo id="S2.SS1.p2.3.m3.6.6.4.4.8" xref="S2.SS1.p2.3.m3.6.6.4.5.cmml">,</mo><mrow id="S2.SS1.p2.3.m3.5.5.3.3.3" xref="S2.SS1.p2.3.m3.5.5.3.3.3.cmml"><mi id="S2.SS1.p2.3.m3.5.5.3.3.3.2" xref="S2.SS1.p2.3.m3.5.5.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.3.m3.5.5.3.3.3.1" xref="S2.SS1.p2.3.m3.5.5.3.3.3.1.cmml">​</mo><mi id="S2.SS1.p2.3.m3.5.5.3.3.3.3" xref="S2.SS1.p2.3.m3.5.5.3.3.3.3.cmml">c</mi></mrow><mo id="S2.SS1.p2.3.m3.6.6.4.4.9" xref="S2.SS1.p2.3.m3.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p2.3.m3.2.2" xref="S2.SS1.p2.3.m3.2.2.cmml">…</mi><mo id="S2.SS1.p2.3.m3.6.6.4.4.10" xref="S2.SS1.p2.3.m3.6.6.4.5.cmml">,</mo><mrow id="S2.SS1.p2.3.m3.6.6.4.4.4" xref="S2.SS1.p2.3.m3.6.6.4.4.4.cmml"><mi id="S2.SS1.p2.3.m3.6.6.4.4.4.2" xref="S2.SS1.p2.3.m3.6.6.4.4.4.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.3.m3.6.6.4.4.4.1" xref="S2.SS1.p2.3.m3.6.6.4.4.4.1.cmml">​</mo><mi id="S2.SS1.p2.3.m3.6.6.4.4.4.3" xref="S2.SS1.p2.3.m3.6.6.4.4.4.3.cmml">N</mi></mrow><mo stretchy="false" id="S2.SS1.p2.3.m3.6.6.4.4.11" xref="S2.SS1.p2.3.m3.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.6b"><apply id="S2.SS1.p2.3.m3.6.6.cmml" xref="S2.SS1.p2.3.m3.6.6"><eq id="S2.SS1.p2.3.m3.6.6.5.cmml" xref="S2.SS1.p2.3.m3.6.6.5"></eq><ci id="S2.SS1.p2.3.m3.6.6.6.cmml" xref="S2.SS1.p2.3.m3.6.6.6">𝐹</ci><set id="S2.SS1.p2.3.m3.6.6.4.5.cmml" xref="S2.SS1.p2.3.m3.6.6.4.4"><apply id="S2.SS1.p2.3.m3.3.3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.3.3.1.1.1"><times id="S2.SS1.p2.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS1.p2.3.m3.3.3.1.1.1.1"></times><ci id="S2.SS1.p2.3.m3.3.3.1.1.1.2.cmml" xref="S2.SS1.p2.3.m3.3.3.1.1.1.2">𝑙</ci><cn type="integer" id="S2.SS1.p2.3.m3.3.3.1.1.1.3.cmml" xref="S2.SS1.p2.3.m3.3.3.1.1.1.3">1</cn></apply><apply id="S2.SS1.p2.3.m3.4.4.2.2.2.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2.2"><times id="S2.SS1.p2.3.m3.4.4.2.2.2.1.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2.2.1"></times><ci id="S2.SS1.p2.3.m3.4.4.2.2.2.2.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2.2.2">𝑙</ci><cn type="integer" id="S2.SS1.p2.3.m3.4.4.2.2.2.3.cmml" xref="S2.SS1.p2.3.m3.4.4.2.2.2.3">2</cn></apply><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">…</ci><apply id="S2.SS1.p2.3.m3.5.5.3.3.3.cmml" xref="S2.SS1.p2.3.m3.5.5.3.3.3"><times id="S2.SS1.p2.3.m3.5.5.3.3.3.1.cmml" xref="S2.SS1.p2.3.m3.5.5.3.3.3.1"></times><ci id="S2.SS1.p2.3.m3.5.5.3.3.3.2.cmml" xref="S2.SS1.p2.3.m3.5.5.3.3.3.2">𝑙</ci><ci id="S2.SS1.p2.3.m3.5.5.3.3.3.3.cmml" xref="S2.SS1.p2.3.m3.5.5.3.3.3.3">𝑐</ci></apply><ci id="S2.SS1.p2.3.m3.2.2.cmml" xref="S2.SS1.p2.3.m3.2.2">…</ci><apply id="S2.SS1.p2.3.m3.6.6.4.4.4.cmml" xref="S2.SS1.p2.3.m3.6.6.4.4.4"><times id="S2.SS1.p2.3.m3.6.6.4.4.4.1.cmml" xref="S2.SS1.p2.3.m3.6.6.4.4.4.1"></times><ci id="S2.SS1.p2.3.m3.6.6.4.4.4.2.cmml" xref="S2.SS1.p2.3.m3.6.6.4.4.4.2">𝑙</ci><ci id="S2.SS1.p2.3.m3.6.6.4.4.4.3.cmml" xref="S2.SS1.p2.3.m3.6.6.4.4.4.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.6c">F=\{l1,l2,…,lc,…,lN\}</annotation></semantics></math>. In SplitAVG, we split F into two sub-networks at a specific layer (also known as cut layer) <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="lc" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><mrow id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.4.m4.1.1.1" xref="S2.SS1.p2.4.m4.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><times id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1.1"></times><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝑙</ci><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">lc</annotation></semantics></math> and rewrite <math id="S2.SS1.p2.5.m5.2" class="ltx_Math" alttext="F=\{FI,FS\}" display="inline"><semantics id="S2.SS1.p2.5.m5.2a"><mrow id="S2.SS1.p2.5.m5.2.2" xref="S2.SS1.p2.5.m5.2.2.cmml"><mi id="S2.SS1.p2.5.m5.2.2.4" xref="S2.SS1.p2.5.m5.2.2.4.cmml">F</mi><mo id="S2.SS1.p2.5.m5.2.2.3" xref="S2.SS1.p2.5.m5.2.2.3.cmml">=</mo><mrow id="S2.SS1.p2.5.m5.2.2.2.2" xref="S2.SS1.p2.5.m5.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.p2.5.m5.2.2.2.2.3" xref="S2.SS1.p2.5.m5.2.2.2.3.cmml">{</mo><mrow id="S2.SS1.p2.5.m5.1.1.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.1.1.1.2" xref="S2.SS1.p2.5.m5.1.1.1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.5.m5.1.1.1.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.5.m5.1.1.1.1.1.3" xref="S2.SS1.p2.5.m5.1.1.1.1.1.3.cmml">I</mi></mrow><mo id="S2.SS1.p2.5.m5.2.2.2.2.4" xref="S2.SS1.p2.5.m5.2.2.2.3.cmml">,</mo><mrow id="S2.SS1.p2.5.m5.2.2.2.2.2" xref="S2.SS1.p2.5.m5.2.2.2.2.2.cmml"><mi id="S2.SS1.p2.5.m5.2.2.2.2.2.2" xref="S2.SS1.p2.5.m5.2.2.2.2.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.5.m5.2.2.2.2.2.1" xref="S2.SS1.p2.5.m5.2.2.2.2.2.1.cmml">​</mo><mi id="S2.SS1.p2.5.m5.2.2.2.2.2.3" xref="S2.SS1.p2.5.m5.2.2.2.2.2.3.cmml">S</mi></mrow><mo stretchy="false" id="S2.SS1.p2.5.m5.2.2.2.2.5" xref="S2.SS1.p2.5.m5.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.2b"><apply id="S2.SS1.p2.5.m5.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2"><eq id="S2.SS1.p2.5.m5.2.2.3.cmml" xref="S2.SS1.p2.5.m5.2.2.3"></eq><ci id="S2.SS1.p2.5.m5.2.2.4.cmml" xref="S2.SS1.p2.5.m5.2.2.4">𝐹</ci><set id="S2.SS1.p2.5.m5.2.2.2.3.cmml" xref="S2.SS1.p2.5.m5.2.2.2.2"><apply id="S2.SS1.p2.5.m5.1.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1"><times id="S2.SS1.p2.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1"></times><ci id="S2.SS1.p2.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.2">𝐹</ci><ci id="S2.SS1.p2.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.SS1.p2.5.m5.2.2.2.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2.2.2.2"><times id="S2.SS1.p2.5.m5.2.2.2.2.2.1.cmml" xref="S2.SS1.p2.5.m5.2.2.2.2.2.1"></times><ci id="S2.SS1.p2.5.m5.2.2.2.2.2.2.cmml" xref="S2.SS1.p2.5.m5.2.2.2.2.2.2">𝐹</ci><ci id="S2.SS1.p2.5.m5.2.2.2.2.2.3.cmml" xref="S2.SS1.p2.5.m5.2.2.2.2.2.3">𝑆</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.2c">F=\{FI,FS\}</annotation></semantics></math>, where <math id="S2.SS1.p2.6.m6.4" class="ltx_Math" alttext="FI=\{l1,l2,…,lc\}" display="inline"><semantics id="S2.SS1.p2.6.m6.4a"><mrow id="S2.SS1.p2.6.m6.4.4" xref="S2.SS1.p2.6.m6.4.4.cmml"><mrow id="S2.SS1.p2.6.m6.4.4.5" xref="S2.SS1.p2.6.m6.4.4.5.cmml"><mi id="S2.SS1.p2.6.m6.4.4.5.2" xref="S2.SS1.p2.6.m6.4.4.5.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.6.m6.4.4.5.1" xref="S2.SS1.p2.6.m6.4.4.5.1.cmml">​</mo><mi id="S2.SS1.p2.6.m6.4.4.5.3" xref="S2.SS1.p2.6.m6.4.4.5.3.cmml">I</mi></mrow><mo id="S2.SS1.p2.6.m6.4.4.4" xref="S2.SS1.p2.6.m6.4.4.4.cmml">=</mo><mrow id="S2.SS1.p2.6.m6.4.4.3.3" xref="S2.SS1.p2.6.m6.4.4.3.4.cmml"><mo stretchy="false" id="S2.SS1.p2.6.m6.4.4.3.3.4" xref="S2.SS1.p2.6.m6.4.4.3.4.cmml">{</mo><mrow id="S2.SS1.p2.6.m6.2.2.1.1.1" xref="S2.SS1.p2.6.m6.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.6.m6.2.2.1.1.1.2" xref="S2.SS1.p2.6.m6.2.2.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.6.m6.2.2.1.1.1.1" xref="S2.SS1.p2.6.m6.2.2.1.1.1.1.cmml">​</mo><mn id="S2.SS1.p2.6.m6.2.2.1.1.1.3" xref="S2.SS1.p2.6.m6.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S2.SS1.p2.6.m6.4.4.3.3.5" xref="S2.SS1.p2.6.m6.4.4.3.4.cmml">,</mo><mrow id="S2.SS1.p2.6.m6.3.3.2.2.2" xref="S2.SS1.p2.6.m6.3.3.2.2.2.cmml"><mi id="S2.SS1.p2.6.m6.3.3.2.2.2.2" xref="S2.SS1.p2.6.m6.3.3.2.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.6.m6.3.3.2.2.2.1" xref="S2.SS1.p2.6.m6.3.3.2.2.2.1.cmml">​</mo><mn id="S2.SS1.p2.6.m6.3.3.2.2.2.3" xref="S2.SS1.p2.6.m6.3.3.2.2.2.3.cmml">2</mn></mrow><mo id="S2.SS1.p2.6.m6.4.4.3.3.6" xref="S2.SS1.p2.6.m6.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml">…</mi><mo id="S2.SS1.p2.6.m6.4.4.3.3.7" xref="S2.SS1.p2.6.m6.4.4.3.4.cmml">,</mo><mrow id="S2.SS1.p2.6.m6.4.4.3.3.3" xref="S2.SS1.p2.6.m6.4.4.3.3.3.cmml"><mi id="S2.SS1.p2.6.m6.4.4.3.3.3.2" xref="S2.SS1.p2.6.m6.4.4.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.6.m6.4.4.3.3.3.1" xref="S2.SS1.p2.6.m6.4.4.3.3.3.1.cmml">​</mo><mi id="S2.SS1.p2.6.m6.4.4.3.3.3.3" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3.cmml">c</mi></mrow><mo stretchy="false" id="S2.SS1.p2.6.m6.4.4.3.3.8" xref="S2.SS1.p2.6.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.4b"><apply id="S2.SS1.p2.6.m6.4.4.cmml" xref="S2.SS1.p2.6.m6.4.4"><eq id="S2.SS1.p2.6.m6.4.4.4.cmml" xref="S2.SS1.p2.6.m6.4.4.4"></eq><apply id="S2.SS1.p2.6.m6.4.4.5.cmml" xref="S2.SS1.p2.6.m6.4.4.5"><times id="S2.SS1.p2.6.m6.4.4.5.1.cmml" xref="S2.SS1.p2.6.m6.4.4.5.1"></times><ci id="S2.SS1.p2.6.m6.4.4.5.2.cmml" xref="S2.SS1.p2.6.m6.4.4.5.2">𝐹</ci><ci id="S2.SS1.p2.6.m6.4.4.5.3.cmml" xref="S2.SS1.p2.6.m6.4.4.5.3">𝐼</ci></apply><set id="S2.SS1.p2.6.m6.4.4.3.4.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3"><apply id="S2.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1"><times id="S2.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1.1"></times><ci id="S2.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1.2">𝑙</ci><cn type="integer" id="S2.SS1.p2.6.m6.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.6.m6.2.2.1.1.1.3">1</cn></apply><apply id="S2.SS1.p2.6.m6.3.3.2.2.2.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2"><times id="S2.SS1.p2.6.m6.3.3.2.2.2.1.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2.1"></times><ci id="S2.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2.2">𝑙</ci><cn type="integer" id="S2.SS1.p2.6.m6.3.3.2.2.2.3.cmml" xref="S2.SS1.p2.6.m6.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">…</ci><apply id="S2.SS1.p2.6.m6.4.4.3.3.3.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3"><times id="S2.SS1.p2.6.m6.4.4.3.3.3.1.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3.1"></times><ci id="S2.SS1.p2.6.m6.4.4.3.3.3.2.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3.2">𝑙</ci><ci id="S2.SS1.p2.6.m6.4.4.3.3.3.3.cmml" xref="S2.SS1.p2.6.m6.4.4.3.3.3.3">𝑐</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.4c">FI=\{l1,l2,…,lc\}</annotation></semantics></math> is the institutional sub-network that resides at the local institutions, and <math id="S2.SS1.p2.7.m7.4" class="ltx_Math" alttext="FS=\{l(c+1),l(c+2),…,lN\}" display="inline"><semantics id="S2.SS1.p2.7.m7.4a"><mrow id="S2.SS1.p2.7.m7.4.4" xref="S2.SS1.p2.7.m7.4.4.cmml"><mrow id="S2.SS1.p2.7.m7.4.4.5" xref="S2.SS1.p2.7.m7.4.4.5.cmml"><mi id="S2.SS1.p2.7.m7.4.4.5.2" xref="S2.SS1.p2.7.m7.4.4.5.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.7.m7.4.4.5.1" xref="S2.SS1.p2.7.m7.4.4.5.1.cmml">​</mo><mi id="S2.SS1.p2.7.m7.4.4.5.3" xref="S2.SS1.p2.7.m7.4.4.5.3.cmml">S</mi></mrow><mo id="S2.SS1.p2.7.m7.4.4.4" xref="S2.SS1.p2.7.m7.4.4.4.cmml">=</mo><mrow id="S2.SS1.p2.7.m7.4.4.3.3" xref="S2.SS1.p2.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S2.SS1.p2.7.m7.4.4.3.3.4" xref="S2.SS1.p2.7.m7.4.4.3.4.cmml">{</mo><mrow id="S2.SS1.p2.7.m7.2.2.1.1.1" xref="S2.SS1.p2.7.m7.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.7.m7.2.2.1.1.1.3" xref="S2.SS1.p2.7.m7.2.2.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.7.m7.2.2.1.1.1.2" xref="S2.SS1.p2.7.m7.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.2" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.2" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.2.cmml">c</mi><mo id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.1" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.3" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.3" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p2.7.m7.4.4.3.3.5" xref="S2.SS1.p2.7.m7.4.4.3.4.cmml">,</mo><mrow id="S2.SS1.p2.7.m7.3.3.2.2.2" xref="S2.SS1.p2.7.m7.3.3.2.2.2.cmml"><mi id="S2.SS1.p2.7.m7.3.3.2.2.2.3" xref="S2.SS1.p2.7.m7.3.3.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.7.m7.3.3.2.2.2.2" xref="S2.SS1.p2.7.m7.3.3.2.2.2.2.cmml">​</mo><mrow id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.2" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.2" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.2.cmml">c</mi><mo id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.1" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.3" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.3" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p2.7.m7.4.4.3.3.6" xref="S2.SS1.p2.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml">…</mi><mo id="S2.SS1.p2.7.m7.4.4.3.3.7" xref="S2.SS1.p2.7.m7.4.4.3.4.cmml">,</mo><mrow id="S2.SS1.p2.7.m7.4.4.3.3.3" xref="S2.SS1.p2.7.m7.4.4.3.3.3.cmml"><mi id="S2.SS1.p2.7.m7.4.4.3.3.3.2" xref="S2.SS1.p2.7.m7.4.4.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.7.m7.4.4.3.3.3.1" xref="S2.SS1.p2.7.m7.4.4.3.3.3.1.cmml">​</mo><mi id="S2.SS1.p2.7.m7.4.4.3.3.3.3" xref="S2.SS1.p2.7.m7.4.4.3.3.3.3.cmml">N</mi></mrow><mo stretchy="false" id="S2.SS1.p2.7.m7.4.4.3.3.8" xref="S2.SS1.p2.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.4b"><apply id="S2.SS1.p2.7.m7.4.4.cmml" xref="S2.SS1.p2.7.m7.4.4"><eq id="S2.SS1.p2.7.m7.4.4.4.cmml" xref="S2.SS1.p2.7.m7.4.4.4"></eq><apply id="S2.SS1.p2.7.m7.4.4.5.cmml" xref="S2.SS1.p2.7.m7.4.4.5"><times id="S2.SS1.p2.7.m7.4.4.5.1.cmml" xref="S2.SS1.p2.7.m7.4.4.5.1"></times><ci id="S2.SS1.p2.7.m7.4.4.5.2.cmml" xref="S2.SS1.p2.7.m7.4.4.5.2">𝐹</ci><ci id="S2.SS1.p2.7.m7.4.4.5.3.cmml" xref="S2.SS1.p2.7.m7.4.4.5.3">𝑆</ci></apply><set id="S2.SS1.p2.7.m7.4.4.3.4.cmml" xref="S2.SS1.p2.7.m7.4.4.3.3"><apply id="S2.SS1.p2.7.m7.2.2.1.1.1.cmml" xref="S2.SS1.p2.7.m7.2.2.1.1.1"><times id="S2.SS1.p2.7.m7.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.7.m7.2.2.1.1.1.2"></times><ci id="S2.SS1.p2.7.m7.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.7.m7.2.2.1.1.1.3">𝑙</ci><apply id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1"><plus id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.1"></plus><ci id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.7.m7.2.2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.SS1.p2.7.m7.3.3.2.2.2.cmml" xref="S2.SS1.p2.7.m7.3.3.2.2.2"><times id="S2.SS1.p2.7.m7.3.3.2.2.2.2.cmml" xref="S2.SS1.p2.7.m7.3.3.2.2.2.2"></times><ci id="S2.SS1.p2.7.m7.3.3.2.2.2.3.cmml" xref="S2.SS1.p2.7.m7.3.3.2.2.2.3">𝑙</ci><apply id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.cmml" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1"><plus id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.1"></plus><ci id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.2">𝑐</ci><cn type="integer" id="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.7.m7.3.3.2.2.2.1.1.1.3">2</cn></apply></apply><ci id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">…</ci><apply id="S2.SS1.p2.7.m7.4.4.3.3.3.cmml" xref="S2.SS1.p2.7.m7.4.4.3.3.3"><times id="S2.SS1.p2.7.m7.4.4.3.3.3.1.cmml" xref="S2.SS1.p2.7.m7.4.4.3.3.3.1"></times><ci id="S2.SS1.p2.7.m7.4.4.3.3.3.2.cmml" xref="S2.SS1.p2.7.m7.4.4.3.3.3.2">𝑙</ci><ci id="S2.SS1.p2.7.m7.4.4.3.3.3.3.cmml" xref="S2.SS1.p2.7.m7.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.4c">FS=\{l(c+1),l(c+2),…,lN\}</annotation></semantics></math> is the server-based sub-network that resides on a central server. In each round of federated training, each local institution trains the institutional sub-network <math id="S2.SS1.p2.8.m8.1" class="ltx_Math" alttext="FI" display="inline"><semantics id="S2.SS1.p2.8.m8.1a"><mrow id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml"><mi id="S2.SS1.p2.8.m8.1.1.2" xref="S2.SS1.p2.8.m8.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.8.m8.1.1.1" xref="S2.SS1.p2.8.m8.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.8.m8.1.1.3" xref="S2.SS1.p2.8.m8.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><apply id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1"><times id="S2.SS1.p2.8.m8.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1.1"></times><ci id="S2.SS1.p2.8.m8.1.1.2.cmml" xref="S2.SS1.p2.8.m8.1.1.2">𝐹</ci><ci id="S2.SS1.p2.8.m8.1.1.3.cmml" xref="S2.SS1.p2.8.m8.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">FI</annotation></semantics></math> in parallel with its local data, sends the output feature maps to the central server for concatenating with those from other institutions, then the server completes the rest of the training with the aggregated feature maps on the server-based sub-network. Specifically, as depicted in Algorithm <a href="#algorithm1" title="In 2.1 SplitAVG ‣ 2 MATERIALS and METHODS ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, SplitAVG follows a two-stage training phase: 1) data forward propagation procedure from institutional sub-network to the server-based sub-network with the transfer of the intermediate feature maps and their corresponding labels, 2) aggregated gradient back propagation procedure from server-based sub-network to the institutional sub-network. This two-stage training process is continued until model convergence on a separate validation set or the maximum number of training epochs is reached. Once the training is finished, the server will send the weights of server-based sub-network <math id="S2.SS1.p2.9.m9.1" class="ltx_Math" alttext="FS" display="inline"><semantics id="S2.SS1.p2.9.m9.1a"><mrow id="S2.SS1.p2.9.m9.1.1" xref="S2.SS1.p2.9.m9.1.1.cmml"><mi id="S2.SS1.p2.9.m9.1.1.2" xref="S2.SS1.p2.9.m9.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.9.m9.1.1.1" xref="S2.SS1.p2.9.m9.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.9.m9.1.1.3" xref="S2.SS1.p2.9.m9.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m9.1b"><apply id="S2.SS1.p2.9.m9.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1"><times id="S2.SS1.p2.9.m9.1.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1.1"></times><ci id="S2.SS1.p2.9.m9.1.1.2.cmml" xref="S2.SS1.p2.9.m9.1.1.2">𝐹</ci><ci id="S2.SS1.p2.9.m9.1.1.3.cmml" xref="S2.SS1.p2.9.m9.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m9.1c">FS</annotation></semantics></math> back to each local institution. Then each institution can perform validation and testing with the complete network <math id="S2.SS1.p2.10.m10.2" class="ltx_Math" alttext="F=\{FI,FS\}" display="inline"><semantics id="S2.SS1.p2.10.m10.2a"><mrow id="S2.SS1.p2.10.m10.2.2" xref="S2.SS1.p2.10.m10.2.2.cmml"><mi id="S2.SS1.p2.10.m10.2.2.4" xref="S2.SS1.p2.10.m10.2.2.4.cmml">F</mi><mo id="S2.SS1.p2.10.m10.2.2.3" xref="S2.SS1.p2.10.m10.2.2.3.cmml">=</mo><mrow id="S2.SS1.p2.10.m10.2.2.2.2" xref="S2.SS1.p2.10.m10.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.p2.10.m10.2.2.2.2.3" xref="S2.SS1.p2.10.m10.2.2.2.3.cmml">{</mo><mrow id="S2.SS1.p2.10.m10.1.1.1.1.1" xref="S2.SS1.p2.10.m10.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.10.m10.1.1.1.1.1.2" xref="S2.SS1.p2.10.m10.1.1.1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.10.m10.1.1.1.1.1.1" xref="S2.SS1.p2.10.m10.1.1.1.1.1.1.cmml">​</mo><mi id="S2.SS1.p2.10.m10.1.1.1.1.1.3" xref="S2.SS1.p2.10.m10.1.1.1.1.1.3.cmml">I</mi></mrow><mo id="S2.SS1.p2.10.m10.2.2.2.2.4" xref="S2.SS1.p2.10.m10.2.2.2.3.cmml">,</mo><mrow id="S2.SS1.p2.10.m10.2.2.2.2.2" xref="S2.SS1.p2.10.m10.2.2.2.2.2.cmml"><mi id="S2.SS1.p2.10.m10.2.2.2.2.2.2" xref="S2.SS1.p2.10.m10.2.2.2.2.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p2.10.m10.2.2.2.2.2.1" xref="S2.SS1.p2.10.m10.2.2.2.2.2.1.cmml">​</mo><mi id="S2.SS1.p2.10.m10.2.2.2.2.2.3" xref="S2.SS1.p2.10.m10.2.2.2.2.2.3.cmml">S</mi></mrow><mo stretchy="false" id="S2.SS1.p2.10.m10.2.2.2.2.5" xref="S2.SS1.p2.10.m10.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m10.2b"><apply id="S2.SS1.p2.10.m10.2.2.cmml" xref="S2.SS1.p2.10.m10.2.2"><eq id="S2.SS1.p2.10.m10.2.2.3.cmml" xref="S2.SS1.p2.10.m10.2.2.3"></eq><ci id="S2.SS1.p2.10.m10.2.2.4.cmml" xref="S2.SS1.p2.10.m10.2.2.4">𝐹</ci><set id="S2.SS1.p2.10.m10.2.2.2.3.cmml" xref="S2.SS1.p2.10.m10.2.2.2.2"><apply id="S2.SS1.p2.10.m10.1.1.1.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1.1.1.1"><times id="S2.SS1.p2.10.m10.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1.1.1.1.1"></times><ci id="S2.SS1.p2.10.m10.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.10.m10.1.1.1.1.1.2">𝐹</ci><ci id="S2.SS1.p2.10.m10.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.10.m10.1.1.1.1.1.3">𝐼</ci></apply><apply id="S2.SS1.p2.10.m10.2.2.2.2.2.cmml" xref="S2.SS1.p2.10.m10.2.2.2.2.2"><times id="S2.SS1.p2.10.m10.2.2.2.2.2.1.cmml" xref="S2.SS1.p2.10.m10.2.2.2.2.2.1"></times><ci id="S2.SS1.p2.10.m10.2.2.2.2.2.2.cmml" xref="S2.SS1.p2.10.m10.2.2.2.2.2.2">𝐹</ci><ci id="S2.SS1.p2.10.m10.2.2.2.2.2.3.cmml" xref="S2.SS1.p2.10.m10.2.2.2.2.2.3">𝑆</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m10.2c">F=\{FI,FS\}</annotation></semantics></math>.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.59" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.59.60" class="ltx_listingline">
</div>
<div id="algorithm1.59.61" class="ltx_listingline">

</div>
<div id="algorithm1.59.62" class="ltx_listingline">
<span id="algorithm1.59.62.1" class="ltx_text ltx_font_bold">Initialize:</span> 
</div>
<div id="algorithm1.1.1" class="ltx_listingline">
<math id="algorithm1.1.1.m1.2" class="ltx_Math" alttext="F=\{FI,FS\}" display="inline"><semantics id="algorithm1.1.1.m1.2a"><mrow id="algorithm1.1.1.m1.2.2" xref="algorithm1.1.1.m1.2.2.cmml"><mi id="algorithm1.1.1.m1.2.2.4" xref="algorithm1.1.1.m1.2.2.4.cmml">F</mi><mo id="algorithm1.1.1.m1.2.2.3" xref="algorithm1.1.1.m1.2.2.3.cmml">=</mo><mrow id="algorithm1.1.1.m1.2.2.2.2" xref="algorithm1.1.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.1.1.m1.2.2.2.2.3" xref="algorithm1.1.1.m1.2.2.2.3.cmml">{</mo><mrow id="algorithm1.1.1.m1.1.1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.1.1.cmml"><mi id="algorithm1.1.1.m1.1.1.1.1.1.2" xref="algorithm1.1.1.m1.1.1.1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.1.1.m1.1.1.1.1.1.1" xref="algorithm1.1.1.m1.1.1.1.1.1.1.cmml">​</mo><mi id="algorithm1.1.1.m1.1.1.1.1.1.3" xref="algorithm1.1.1.m1.1.1.1.1.1.3.cmml">I</mi></mrow><mo id="algorithm1.1.1.m1.2.2.2.2.4" xref="algorithm1.1.1.m1.2.2.2.3.cmml">,</mo><mrow id="algorithm1.1.1.m1.2.2.2.2.2" xref="algorithm1.1.1.m1.2.2.2.2.2.cmml"><mi id="algorithm1.1.1.m1.2.2.2.2.2.2" xref="algorithm1.1.1.m1.2.2.2.2.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.1.1.m1.2.2.2.2.2.1" xref="algorithm1.1.1.m1.2.2.2.2.2.1.cmml">​</mo><mi id="algorithm1.1.1.m1.2.2.2.2.2.3" xref="algorithm1.1.1.m1.2.2.2.2.2.3.cmml">S</mi></mrow><mo stretchy="false" id="algorithm1.1.1.m1.2.2.2.2.5" xref="algorithm1.1.1.m1.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.2b"><apply id="algorithm1.1.1.m1.2.2.cmml" xref="algorithm1.1.1.m1.2.2"><eq id="algorithm1.1.1.m1.2.2.3.cmml" xref="algorithm1.1.1.m1.2.2.3"></eq><ci id="algorithm1.1.1.m1.2.2.4.cmml" xref="algorithm1.1.1.m1.2.2.4">𝐹</ci><set id="algorithm1.1.1.m1.2.2.2.3.cmml" xref="algorithm1.1.1.m1.2.2.2.2"><apply id="algorithm1.1.1.m1.1.1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1"><times id="algorithm1.1.1.m1.1.1.1.1.1.1.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.1"></times><ci id="algorithm1.1.1.m1.1.1.1.1.1.2.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.2">𝐹</ci><ci id="algorithm1.1.1.m1.1.1.1.1.1.3.cmml" xref="algorithm1.1.1.m1.1.1.1.1.1.3">𝐼</ci></apply><apply id="algorithm1.1.1.m1.2.2.2.2.2.cmml" xref="algorithm1.1.1.m1.2.2.2.2.2"><times id="algorithm1.1.1.m1.2.2.2.2.2.1.cmml" xref="algorithm1.1.1.m1.2.2.2.2.2.1"></times><ci id="algorithm1.1.1.m1.2.2.2.2.2.2.cmml" xref="algorithm1.1.1.m1.2.2.2.2.2.2">𝐹</ci><ci id="algorithm1.1.1.m1.2.2.2.2.2.3.cmml" xref="algorithm1.1.1.m1.2.2.2.2.2.3">𝑆</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.2c">F=\{FI,FS\}</annotation></semantics></math> 
</div>
<div id="algorithm1.5.5" class="ltx_listingline"> <math id="algorithm1.2.2.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.2.2.m1.1a"><mo id="algorithm1.2.2.m1.1.1" xref="algorithm1.2.2.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m1.1b"><ci id="algorithm1.2.2.m1.1.1.cmml" xref="algorithm1.2.2.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m1.1c">\triangleright</annotation></semantics></math> Institutions and the server split <math id="algorithm1.3.3.m2.1" class="ltx_Math" alttext="F" display="inline"><semantics id="algorithm1.3.3.m2.1a"><mi id="algorithm1.3.3.m2.1.1" xref="algorithm1.3.3.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m2.1b"><ci id="algorithm1.3.3.m2.1.1.cmml" xref="algorithm1.3.3.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m2.1c">F</annotation></semantics></math> into institutional sub-network <math id="algorithm1.4.4.m3.1" class="ltx_Math" alttext="FI" display="inline"><semantics id="algorithm1.4.4.m3.1a"><mrow id="algorithm1.4.4.m3.1.1" xref="algorithm1.4.4.m3.1.1.cmml"><mi id="algorithm1.4.4.m3.1.1.2" xref="algorithm1.4.4.m3.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.4.4.m3.1.1.1" xref="algorithm1.4.4.m3.1.1.1.cmml">​</mo><mi id="algorithm1.4.4.m3.1.1.3" xref="algorithm1.4.4.m3.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m3.1b"><apply id="algorithm1.4.4.m3.1.1.cmml" xref="algorithm1.4.4.m3.1.1"><times id="algorithm1.4.4.m3.1.1.1.cmml" xref="algorithm1.4.4.m3.1.1.1"></times><ci id="algorithm1.4.4.m3.1.1.2.cmml" xref="algorithm1.4.4.m3.1.1.2">𝐹</ci><ci id="algorithm1.4.4.m3.1.1.3.cmml" xref="algorithm1.4.4.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m3.1c">FI</annotation></semantics></math> and server-based sub-network <math id="algorithm1.5.5.m4.1" class="ltx_Math" alttext="FS" display="inline"><semantics id="algorithm1.5.5.m4.1a"><mrow id="algorithm1.5.5.m4.1.1" xref="algorithm1.5.5.m4.1.1.cmml"><mi id="algorithm1.5.5.m4.1.1.2" xref="algorithm1.5.5.m4.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.5.5.m4.1.1.1" xref="algorithm1.5.5.m4.1.1.1.cmml">​</mo><mi id="algorithm1.5.5.m4.1.1.3" xref="algorithm1.5.5.m4.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m4.1b"><apply id="algorithm1.5.5.m4.1.1.cmml" xref="algorithm1.5.5.m4.1.1"><times id="algorithm1.5.5.m4.1.1.1.cmml" xref="algorithm1.5.5.m4.1.1.1"></times><ci id="algorithm1.5.5.m4.1.1.2.cmml" xref="algorithm1.5.5.m4.1.1.2">𝐹</ci><ci id="algorithm1.5.5.m4.1.1.3.cmml" xref="algorithm1.5.5.m4.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m4.1c">FS</annotation></semantics></math> 
</div>
<div id="algorithm1.59.63" class="ltx_listingline">

</div>
<div id="algorithm1.6.6" class="ltx_listingline">
<math id="algorithm1.6.6.m1.4" class="ltx_Math" alttext="FI=\{l1,l2,…,lc\}" display="inline"><semantics id="algorithm1.6.6.m1.4a"><mrow id="algorithm1.6.6.m1.4.4" xref="algorithm1.6.6.m1.4.4.cmml"><mrow id="algorithm1.6.6.m1.4.4.5" xref="algorithm1.6.6.m1.4.4.5.cmml"><mi id="algorithm1.6.6.m1.4.4.5.2" xref="algorithm1.6.6.m1.4.4.5.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.6.m1.4.4.5.1" xref="algorithm1.6.6.m1.4.4.5.1.cmml">​</mo><mi id="algorithm1.6.6.m1.4.4.5.3" xref="algorithm1.6.6.m1.4.4.5.3.cmml">I</mi></mrow><mo id="algorithm1.6.6.m1.4.4.4" xref="algorithm1.6.6.m1.4.4.4.cmml">=</mo><mrow id="algorithm1.6.6.m1.4.4.3.3" xref="algorithm1.6.6.m1.4.4.3.4.cmml"><mo stretchy="false" id="algorithm1.6.6.m1.4.4.3.3.4" xref="algorithm1.6.6.m1.4.4.3.4.cmml">{</mo><mrow id="algorithm1.6.6.m1.2.2.1.1.1" xref="algorithm1.6.6.m1.2.2.1.1.1.cmml"><mi id="algorithm1.6.6.m1.2.2.1.1.1.2" xref="algorithm1.6.6.m1.2.2.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.6.m1.2.2.1.1.1.1" xref="algorithm1.6.6.m1.2.2.1.1.1.1.cmml">​</mo><mn id="algorithm1.6.6.m1.2.2.1.1.1.3" xref="algorithm1.6.6.m1.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="algorithm1.6.6.m1.4.4.3.3.5" xref="algorithm1.6.6.m1.4.4.3.4.cmml">,</mo><mrow id="algorithm1.6.6.m1.3.3.2.2.2" xref="algorithm1.6.6.m1.3.3.2.2.2.cmml"><mi id="algorithm1.6.6.m1.3.3.2.2.2.2" xref="algorithm1.6.6.m1.3.3.2.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.6.m1.3.3.2.2.2.1" xref="algorithm1.6.6.m1.3.3.2.2.2.1.cmml">​</mo><mn id="algorithm1.6.6.m1.3.3.2.2.2.3" xref="algorithm1.6.6.m1.3.3.2.2.2.3.cmml">2</mn></mrow><mo id="algorithm1.6.6.m1.4.4.3.3.6" xref="algorithm1.6.6.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml">…</mi><mo id="algorithm1.6.6.m1.4.4.3.3.7" xref="algorithm1.6.6.m1.4.4.3.4.cmml">,</mo><mrow id="algorithm1.6.6.m1.4.4.3.3.3" xref="algorithm1.6.6.m1.4.4.3.3.3.cmml"><mi id="algorithm1.6.6.m1.4.4.3.3.3.2" xref="algorithm1.6.6.m1.4.4.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.6.6.m1.4.4.3.3.3.1" xref="algorithm1.6.6.m1.4.4.3.3.3.1.cmml">​</mo><mi id="algorithm1.6.6.m1.4.4.3.3.3.3" xref="algorithm1.6.6.m1.4.4.3.3.3.3.cmml">c</mi></mrow><mo stretchy="false" id="algorithm1.6.6.m1.4.4.3.3.8" xref="algorithm1.6.6.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.4b"><apply id="algorithm1.6.6.m1.4.4.cmml" xref="algorithm1.6.6.m1.4.4"><eq id="algorithm1.6.6.m1.4.4.4.cmml" xref="algorithm1.6.6.m1.4.4.4"></eq><apply id="algorithm1.6.6.m1.4.4.5.cmml" xref="algorithm1.6.6.m1.4.4.5"><times id="algorithm1.6.6.m1.4.4.5.1.cmml" xref="algorithm1.6.6.m1.4.4.5.1"></times><ci id="algorithm1.6.6.m1.4.4.5.2.cmml" xref="algorithm1.6.6.m1.4.4.5.2">𝐹</ci><ci id="algorithm1.6.6.m1.4.4.5.3.cmml" xref="algorithm1.6.6.m1.4.4.5.3">𝐼</ci></apply><set id="algorithm1.6.6.m1.4.4.3.4.cmml" xref="algorithm1.6.6.m1.4.4.3.3"><apply id="algorithm1.6.6.m1.2.2.1.1.1.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1"><times id="algorithm1.6.6.m1.2.2.1.1.1.1.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1.1"></times><ci id="algorithm1.6.6.m1.2.2.1.1.1.2.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1.2">𝑙</ci><cn type="integer" id="algorithm1.6.6.m1.2.2.1.1.1.3.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1.3">1</cn></apply><apply id="algorithm1.6.6.m1.3.3.2.2.2.cmml" xref="algorithm1.6.6.m1.3.3.2.2.2"><times id="algorithm1.6.6.m1.3.3.2.2.2.1.cmml" xref="algorithm1.6.6.m1.3.3.2.2.2.1"></times><ci id="algorithm1.6.6.m1.3.3.2.2.2.2.cmml" xref="algorithm1.6.6.m1.3.3.2.2.2.2">𝑙</ci><cn type="integer" id="algorithm1.6.6.m1.3.3.2.2.2.3.cmml" xref="algorithm1.6.6.m1.3.3.2.2.2.3">2</cn></apply><ci id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1">…</ci><apply id="algorithm1.6.6.m1.4.4.3.3.3.cmml" xref="algorithm1.6.6.m1.4.4.3.3.3"><times id="algorithm1.6.6.m1.4.4.3.3.3.1.cmml" xref="algorithm1.6.6.m1.4.4.3.3.3.1"></times><ci id="algorithm1.6.6.m1.4.4.3.3.3.2.cmml" xref="algorithm1.6.6.m1.4.4.3.3.3.2">𝑙</ci><ci id="algorithm1.6.6.m1.4.4.3.3.3.3.cmml" xref="algorithm1.6.6.m1.4.4.3.3.3.3">𝑐</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.4c">FI=\{l1,l2,…,lc\}</annotation></semantics></math>

</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<math id="algorithm1.7.7.m1.4" class="ltx_Math" alttext="FS=\{l(c+1),l(c+2),…,lN\}" display="inline"><semantics id="algorithm1.7.7.m1.4a"><mrow id="algorithm1.7.7.m1.4.4" xref="algorithm1.7.7.m1.4.4.cmml"><mrow id="algorithm1.7.7.m1.4.4.5" xref="algorithm1.7.7.m1.4.4.5.cmml"><mi id="algorithm1.7.7.m1.4.4.5.2" xref="algorithm1.7.7.m1.4.4.5.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.7.7.m1.4.4.5.1" xref="algorithm1.7.7.m1.4.4.5.1.cmml">​</mo><mi id="algorithm1.7.7.m1.4.4.5.3" xref="algorithm1.7.7.m1.4.4.5.3.cmml">S</mi></mrow><mo id="algorithm1.7.7.m1.4.4.4" xref="algorithm1.7.7.m1.4.4.4.cmml">=</mo><mrow id="algorithm1.7.7.m1.4.4.3.3" xref="algorithm1.7.7.m1.4.4.3.4.cmml"><mo stretchy="false" id="algorithm1.7.7.m1.4.4.3.3.4" xref="algorithm1.7.7.m1.4.4.3.4.cmml">{</mo><mrow id="algorithm1.7.7.m1.2.2.1.1.1" xref="algorithm1.7.7.m1.2.2.1.1.1.cmml"><mi id="algorithm1.7.7.m1.2.2.1.1.1.3" xref="algorithm1.7.7.m1.2.2.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.7.7.m1.2.2.1.1.1.2" xref="algorithm1.7.7.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="algorithm1.7.7.m1.2.2.1.1.1.1.1" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.7.7.m1.2.2.1.1.1.1.1.2" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.7.7.m1.2.2.1.1.1.1.1.1" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.cmml"><mi id="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.2" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.2.cmml">c</mi><mo id="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.1" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.1.cmml">+</mo><mn id="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.3" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.7.7.m1.2.2.1.1.1.1.1.3" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.7.7.m1.4.4.3.3.5" xref="algorithm1.7.7.m1.4.4.3.4.cmml">,</mo><mrow id="algorithm1.7.7.m1.3.3.2.2.2" xref="algorithm1.7.7.m1.3.3.2.2.2.cmml"><mi id="algorithm1.7.7.m1.3.3.2.2.2.3" xref="algorithm1.7.7.m1.3.3.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.7.7.m1.3.3.2.2.2.2" xref="algorithm1.7.7.m1.3.3.2.2.2.2.cmml">​</mo><mrow id="algorithm1.7.7.m1.3.3.2.2.2.1.1" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.cmml"><mo stretchy="false" id="algorithm1.7.7.m1.3.3.2.2.2.1.1.2" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.cmml">(</mo><mrow id="algorithm1.7.7.m1.3.3.2.2.2.1.1.1" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.cmml"><mi id="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.2" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.2.cmml">c</mi><mo id="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.1" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.1.cmml">+</mo><mn id="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.3" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="algorithm1.7.7.m1.3.3.2.2.2.1.1.3" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.7.7.m1.4.4.3.3.6" xref="algorithm1.7.7.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml">…</mi><mo id="algorithm1.7.7.m1.4.4.3.3.7" xref="algorithm1.7.7.m1.4.4.3.4.cmml">,</mo><mrow id="algorithm1.7.7.m1.4.4.3.3.3" xref="algorithm1.7.7.m1.4.4.3.3.3.cmml"><mi id="algorithm1.7.7.m1.4.4.3.3.3.2" xref="algorithm1.7.7.m1.4.4.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.7.7.m1.4.4.3.3.3.1" xref="algorithm1.7.7.m1.4.4.3.3.3.1.cmml">​</mo><mi id="algorithm1.7.7.m1.4.4.3.3.3.3" xref="algorithm1.7.7.m1.4.4.3.3.3.3.cmml">N</mi></mrow><mo stretchy="false" id="algorithm1.7.7.m1.4.4.3.3.8" xref="algorithm1.7.7.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.4b"><apply id="algorithm1.7.7.m1.4.4.cmml" xref="algorithm1.7.7.m1.4.4"><eq id="algorithm1.7.7.m1.4.4.4.cmml" xref="algorithm1.7.7.m1.4.4.4"></eq><apply id="algorithm1.7.7.m1.4.4.5.cmml" xref="algorithm1.7.7.m1.4.4.5"><times id="algorithm1.7.7.m1.4.4.5.1.cmml" xref="algorithm1.7.7.m1.4.4.5.1"></times><ci id="algorithm1.7.7.m1.4.4.5.2.cmml" xref="algorithm1.7.7.m1.4.4.5.2">𝐹</ci><ci id="algorithm1.7.7.m1.4.4.5.3.cmml" xref="algorithm1.7.7.m1.4.4.5.3">𝑆</ci></apply><set id="algorithm1.7.7.m1.4.4.3.4.cmml" xref="algorithm1.7.7.m1.4.4.3.3"><apply id="algorithm1.7.7.m1.2.2.1.1.1.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1"><times id="algorithm1.7.7.m1.2.2.1.1.1.2.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.2"></times><ci id="algorithm1.7.7.m1.2.2.1.1.1.3.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.3">𝑙</ci><apply id="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1"><plus id="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.1"></plus><ci id="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.2.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.3.cmml" xref="algorithm1.7.7.m1.2.2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="algorithm1.7.7.m1.3.3.2.2.2.cmml" xref="algorithm1.7.7.m1.3.3.2.2.2"><times id="algorithm1.7.7.m1.3.3.2.2.2.2.cmml" xref="algorithm1.7.7.m1.3.3.2.2.2.2"></times><ci id="algorithm1.7.7.m1.3.3.2.2.2.3.cmml" xref="algorithm1.7.7.m1.3.3.2.2.2.3">𝑙</ci><apply id="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.cmml" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1"><plus id="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.1.cmml" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.1"></plus><ci id="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.2.cmml" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.3.cmml" xref="algorithm1.7.7.m1.3.3.2.2.2.1.1.1.3">2</cn></apply></apply><ci id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1">…</ci><apply id="algorithm1.7.7.m1.4.4.3.3.3.cmml" xref="algorithm1.7.7.m1.4.4.3.3.3"><times id="algorithm1.7.7.m1.4.4.3.3.3.1.cmml" xref="algorithm1.7.7.m1.4.4.3.3.3.1"></times><ci id="algorithm1.7.7.m1.4.4.3.3.3.2.cmml" xref="algorithm1.7.7.m1.4.4.3.3.3.2">𝑙</ci><ci id="algorithm1.7.7.m1.4.4.3.3.3.3.cmml" xref="algorithm1.7.7.m1.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.4c">FS=\{l(c+1),l(c+2),…,lN\}</annotation></semantics></math> 
</div>
<div id="algorithm1.9.9" class="ltx_listingline"> <math id="algorithm1.8.8.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.8.8.m1.1a"><mo id="algorithm1.8.8.m1.1.1" xref="algorithm1.8.8.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.1b"><ci id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.1c">\triangleright</annotation></semantics></math> <math id="algorithm1.9.9.m2.1" class="ltx_Math" alttext="lc" display="inline"><semantics id="algorithm1.9.9.m2.1a"><mrow id="algorithm1.9.9.m2.1.1" xref="algorithm1.9.9.m2.1.1.cmml"><mi id="algorithm1.9.9.m2.1.1.2" xref="algorithm1.9.9.m2.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.9.9.m2.1.1.1" xref="algorithm1.9.9.m2.1.1.1.cmml">​</mo><mi id="algorithm1.9.9.m2.1.1.3" xref="algorithm1.9.9.m2.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m2.1b"><apply id="algorithm1.9.9.m2.1.1.cmml" xref="algorithm1.9.9.m2.1.1"><times id="algorithm1.9.9.m2.1.1.1.cmml" xref="algorithm1.9.9.m2.1.1.1"></times><ci id="algorithm1.9.9.m2.1.1.2.cmml" xref="algorithm1.9.9.m2.1.1.2">𝑙</ci><ci id="algorithm1.9.9.m2.1.1.3.cmml" xref="algorithm1.9.9.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m2.1c">lc</annotation></semantics></math> as the cut layer 
</div>
<div id="algorithm1.59.64" class="ltx_listingline">

</div>
<div id="algorithm1.13.13" class="ltx_listingline">Server initializes weight <math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="algorithm1.10.10.m1.1a"><mi id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><ci id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">W</annotation></semantics></math> for <math id="algorithm1.11.11.m2.1" class="ltx_Math" alttext="FI" display="inline"><semantics id="algorithm1.11.11.m2.1a"><mrow id="algorithm1.11.11.m2.1.1" xref="algorithm1.11.11.m2.1.1.cmml"><mi id="algorithm1.11.11.m2.1.1.2" xref="algorithm1.11.11.m2.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.11.11.m2.1.1.1" xref="algorithm1.11.11.m2.1.1.1.cmml">​</mo><mi id="algorithm1.11.11.m2.1.1.3" xref="algorithm1.11.11.m2.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m2.1b"><apply id="algorithm1.11.11.m2.1.1.cmml" xref="algorithm1.11.11.m2.1.1"><times id="algorithm1.11.11.m2.1.1.1.cmml" xref="algorithm1.11.11.m2.1.1.1"></times><ci id="algorithm1.11.11.m2.1.1.2.cmml" xref="algorithm1.11.11.m2.1.1.2">𝐹</ci><ci id="algorithm1.11.11.m2.1.1.3.cmml" xref="algorithm1.11.11.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m2.1c">FI</annotation></semantics></math> and sends <math id="algorithm1.12.12.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="algorithm1.12.12.m3.1a"><mi id="algorithm1.12.12.m3.1.1" xref="algorithm1.12.12.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m3.1b"><ci id="algorithm1.12.12.m3.1.1.cmml" xref="algorithm1.12.12.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m3.1c">W</annotation></semantics></math> to <math id="algorithm1.13.13.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm1.13.13.m4.1a"><mi id="algorithm1.13.13.m4.1.1" xref="algorithm1.13.13.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m4.1b"><ci id="algorithm1.13.13.m4.1.1.cmml" xref="algorithm1.13.13.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m4.1c">K</annotation></semantics></math> institutions 
</div>
<div id="algorithm1.59.65" class="ltx_listingline">

</div>
<div id="algorithm1.15.15" class="ltx_listingline">Server initializes weight <math id="algorithm1.14.14.m1.1" class="ltx_Math" alttext="W_{S}" display="inline"><semantics id="algorithm1.14.14.m1.1a"><msub id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml"><mi id="algorithm1.14.14.m1.1.1.2" xref="algorithm1.14.14.m1.1.1.2.cmml">W</mi><mi id="algorithm1.14.14.m1.1.1.3" xref="algorithm1.14.14.m1.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><apply id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1">subscript</csymbol><ci id="algorithm1.14.14.m1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.2">𝑊</ci><ci id="algorithm1.14.14.m1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">W_{S}</annotation></semantics></math> for <math id="algorithm1.15.15.m2.1" class="ltx_Math" alttext="FS" display="inline"><semantics id="algorithm1.15.15.m2.1a"><mrow id="algorithm1.15.15.m2.1.1" xref="algorithm1.15.15.m2.1.1.cmml"><mi id="algorithm1.15.15.m2.1.1.2" xref="algorithm1.15.15.m2.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.15.15.m2.1.1.1" xref="algorithm1.15.15.m2.1.1.1.cmml">​</mo><mi id="algorithm1.15.15.m2.1.1.3" xref="algorithm1.15.15.m2.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m2.1b"><apply id="algorithm1.15.15.m2.1.1.cmml" xref="algorithm1.15.15.m2.1.1"><times id="algorithm1.15.15.m2.1.1.1.cmml" xref="algorithm1.15.15.m2.1.1.1"></times><ci id="algorithm1.15.15.m2.1.1.2.cmml" xref="algorithm1.15.15.m2.1.1.2">𝐹</ci><ci id="algorithm1.15.15.m2.1.1.3.cmml" xref="algorithm1.15.15.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m2.1c">FS</annotation></semantics></math> 
</div>
<div id="algorithm1.59.66" class="ltx_listingline">

</div>
<div id="algorithm1.59.67" class="ltx_listingline">
<span id="algorithm1.59.67.1" class="ltx_text"></span>

</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span id="algorithm1.17.17.1" class="ltx_text ltx_font_bold">for</span> each epoch i from <math id="algorithm1.16.16.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="algorithm1.16.16.m1.1a"><mn id="algorithm1.16.16.m1.1.1" xref="algorithm1.16.16.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.1b"><cn type="integer" id="algorithm1.16.16.m1.1.1.cmml" xref="algorithm1.16.16.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.1c">1</annotation></semantics></math> to <math id="algorithm1.17.17.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm1.17.17.m2.1a"><mi id="algorithm1.17.17.m2.1.1" xref="algorithm1.17.17.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m2.1b"><ci id="algorithm1.17.17.m2.1.1.cmml" xref="algorithm1.17.17.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m2.1c">E</annotation></semantics></math> <span id="algorithm1.17.17.2" class="ltx_text ltx_font_bold">do</span>: 
</div>
<div id="algorithm1.59.68" class="ltx_listingline">

</div>
<div id="algorithm1.18.18" class="ltx_listingline"> Server samples a subset of <math id="algorithm1.18.18.m1.1" class="ltx_Math" alttext="St" display="inline"><semantics id="algorithm1.18.18.m1.1a"><mrow id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml"><mi id="algorithm1.18.18.m1.1.1.2" xref="algorithm1.18.18.m1.1.1.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.18.18.m1.1.1.1" xref="algorithm1.18.18.m1.1.1.1.cmml">​</mo><mi id="algorithm1.18.18.m1.1.1.3" xref="algorithm1.18.18.m1.1.1.3.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><apply id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1"><times id="algorithm1.18.18.m1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1.1"></times><ci id="algorithm1.18.18.m1.1.1.2.cmml" xref="algorithm1.18.18.m1.1.1.2">𝑆</ci><ci id="algorithm1.18.18.m1.1.1.3.cmml" xref="algorithm1.18.18.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">St</annotation></semantics></math> institutions 
</div>
<div id="algorithm1.59.69" class="ltx_listingline">

</div>
<div id="algorithm1.19.19" class="ltx_listingline"> <span id="algorithm1.19.19.1" class="ltx_text ltx_font_bold">for</span> each institution <math id="algorithm1.19.19.m1.1" class="ltx_Math" alttext="k\in St" display="inline"><semantics id="algorithm1.19.19.m1.1a"><mrow id="algorithm1.19.19.m1.1.1" xref="algorithm1.19.19.m1.1.1.cmml"><mi id="algorithm1.19.19.m1.1.1.2" xref="algorithm1.19.19.m1.1.1.2.cmml">k</mi><mo id="algorithm1.19.19.m1.1.1.1" xref="algorithm1.19.19.m1.1.1.1.cmml">∈</mo><mrow id="algorithm1.19.19.m1.1.1.3" xref="algorithm1.19.19.m1.1.1.3.cmml"><mi id="algorithm1.19.19.m1.1.1.3.2" xref="algorithm1.19.19.m1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.19.19.m1.1.1.3.1" xref="algorithm1.19.19.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.19.19.m1.1.1.3.3" xref="algorithm1.19.19.m1.1.1.3.3.cmml">t</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m1.1b"><apply id="algorithm1.19.19.m1.1.1.cmml" xref="algorithm1.19.19.m1.1.1"><in id="algorithm1.19.19.m1.1.1.1.cmml" xref="algorithm1.19.19.m1.1.1.1"></in><ci id="algorithm1.19.19.m1.1.1.2.cmml" xref="algorithm1.19.19.m1.1.1.2">𝑘</ci><apply id="algorithm1.19.19.m1.1.1.3.cmml" xref="algorithm1.19.19.m1.1.1.3"><times id="algorithm1.19.19.m1.1.1.3.1.cmml" xref="algorithm1.19.19.m1.1.1.3.1"></times><ci id="algorithm1.19.19.m1.1.1.3.2.cmml" xref="algorithm1.19.19.m1.1.1.3.2">𝑆</ci><ci id="algorithm1.19.19.m1.1.1.3.3.cmml" xref="algorithm1.19.19.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m1.1c">k\in St</annotation></semantics></math> <span id="algorithm1.19.19.2" class="ltx_text ltx_font_bold">in parallel do</span>:

</div>
<div id="algorithm1.21.21" class="ltx_listingline">  For each local batch <math id="algorithm1.20.20.m1.2" class="ltx_Math" alttext="{x_{k},y_{k}}" display="inline"><semantics id="algorithm1.20.20.m1.2a"><mrow id="algorithm1.20.20.m1.2.2.2" xref="algorithm1.20.20.m1.2.2.3.cmml"><msub id="algorithm1.20.20.m1.1.1.1.1" xref="algorithm1.20.20.m1.1.1.1.1.cmml"><mi id="algorithm1.20.20.m1.1.1.1.1.2" xref="algorithm1.20.20.m1.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.20.20.m1.1.1.1.1.3" xref="algorithm1.20.20.m1.1.1.1.1.3.cmml">k</mi></msub><mo id="algorithm1.20.20.m1.2.2.2.3" xref="algorithm1.20.20.m1.2.2.3.cmml">,</mo><msub id="algorithm1.20.20.m1.2.2.2.2" xref="algorithm1.20.20.m1.2.2.2.2.cmml"><mi id="algorithm1.20.20.m1.2.2.2.2.2" xref="algorithm1.20.20.m1.2.2.2.2.2.cmml">y</mi><mi id="algorithm1.20.20.m1.2.2.2.2.3" xref="algorithm1.20.20.m1.2.2.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m1.2b"><list id="algorithm1.20.20.m1.2.2.3.cmml" xref="algorithm1.20.20.m1.2.2.2"><apply id="algorithm1.20.20.m1.1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.1.1.1.1.1.cmml" xref="algorithm1.20.20.m1.1.1.1.1">subscript</csymbol><ci id="algorithm1.20.20.m1.1.1.1.1.2.cmml" xref="algorithm1.20.20.m1.1.1.1.1.2">𝑥</ci><ci id="algorithm1.20.20.m1.1.1.1.1.3.cmml" xref="algorithm1.20.20.m1.1.1.1.1.3">𝑘</ci></apply><apply id="algorithm1.20.20.m1.2.2.2.2.cmml" xref="algorithm1.20.20.m1.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.20.20.m1.2.2.2.2.1.cmml" xref="algorithm1.20.20.m1.2.2.2.2">subscript</csymbol><ci id="algorithm1.20.20.m1.2.2.2.2.2.cmml" xref="algorithm1.20.20.m1.2.2.2.2.2">𝑦</ci><ci id="algorithm1.20.20.m1.2.2.2.2.3.cmml" xref="algorithm1.20.20.m1.2.2.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m1.2c">{x_{k},y_{k}}</annotation></semantics></math> in <math id="algorithm1.21.21.m2.2" class="ltx_Math" alttext="{\boldsymbol{x}_{k},\boldsymbol{y}_{k}}" display="inline"><semantics id="algorithm1.21.21.m2.2a"><mrow id="algorithm1.21.21.m2.2.2.2" xref="algorithm1.21.21.m2.2.2.3.cmml"><msub id="algorithm1.21.21.m2.1.1.1.1" xref="algorithm1.21.21.m2.1.1.1.1.cmml"><mi id="algorithm1.21.21.m2.1.1.1.1.2" xref="algorithm1.21.21.m2.1.1.1.1.2.cmml">𝒙</mi><mi id="algorithm1.21.21.m2.1.1.1.1.3" xref="algorithm1.21.21.m2.1.1.1.1.3.cmml">k</mi></msub><mo id="algorithm1.21.21.m2.2.2.2.3" xref="algorithm1.21.21.m2.2.2.3.cmml">,</mo><msub id="algorithm1.21.21.m2.2.2.2.2" xref="algorithm1.21.21.m2.2.2.2.2.cmml"><mi id="algorithm1.21.21.m2.2.2.2.2.2" xref="algorithm1.21.21.m2.2.2.2.2.2.cmml">𝒚</mi><mi id="algorithm1.21.21.m2.2.2.2.2.3" xref="algorithm1.21.21.m2.2.2.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m2.2b"><list id="algorithm1.21.21.m2.2.2.3.cmml" xref="algorithm1.21.21.m2.2.2.2"><apply id="algorithm1.21.21.m2.1.1.1.1.cmml" xref="algorithm1.21.21.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m2.1.1.1.1.1.cmml" xref="algorithm1.21.21.m2.1.1.1.1">subscript</csymbol><ci id="algorithm1.21.21.m2.1.1.1.1.2.cmml" xref="algorithm1.21.21.m2.1.1.1.1.2">𝒙</ci><ci id="algorithm1.21.21.m2.1.1.1.1.3.cmml" xref="algorithm1.21.21.m2.1.1.1.1.3">𝑘</ci></apply><apply id="algorithm1.21.21.m2.2.2.2.2.cmml" xref="algorithm1.21.21.m2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m2.2.2.2.2.1.cmml" xref="algorithm1.21.21.m2.2.2.2.2">subscript</csymbol><ci id="algorithm1.21.21.m2.2.2.2.2.2.cmml" xref="algorithm1.21.21.m2.2.2.2.2.2">𝒚</ci><ci id="algorithm1.21.21.m2.2.2.2.2.3.cmml" xref="algorithm1.21.21.m2.2.2.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m2.2c">{\boldsymbol{x}_{k},\boldsymbol{y}_{k}}</annotation></semantics></math> do:

</div>
<div id="algorithm1.59.70" class="ltx_listingline">   <span id="algorithm1.59.70.1" class="ltx_text ltx_font_bold">Forward Propagation:</span> 
</div>
<div id="algorithm1.59.71" class="ltx_listingline">

</div>
<div id="algorithm1.22.22" class="ltx_listingline">   <math id="algorithm1.22.22.m1.1" class="ltx_Math" alttext="x_{k}^{lc}\leftarrow FI_{k}(x_{k})" display="inline"><semantics id="algorithm1.22.22.m1.1a"><mrow id="algorithm1.22.22.m1.1.1" xref="algorithm1.22.22.m1.1.1.cmml"><msubsup id="algorithm1.22.22.m1.1.1.3" xref="algorithm1.22.22.m1.1.1.3.cmml"><mi id="algorithm1.22.22.m1.1.1.3.2.2" xref="algorithm1.22.22.m1.1.1.3.2.2.cmml">x</mi><mi id="algorithm1.22.22.m1.1.1.3.2.3" xref="algorithm1.22.22.m1.1.1.3.2.3.cmml">k</mi><mrow id="algorithm1.22.22.m1.1.1.3.3" xref="algorithm1.22.22.m1.1.1.3.3.cmml"><mi id="algorithm1.22.22.m1.1.1.3.3.2" xref="algorithm1.22.22.m1.1.1.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.1.1.3.3.1" xref="algorithm1.22.22.m1.1.1.3.3.1.cmml">​</mo><mi id="algorithm1.22.22.m1.1.1.3.3.3" xref="algorithm1.22.22.m1.1.1.3.3.3.cmml">c</mi></mrow></msubsup><mo stretchy="false" id="algorithm1.22.22.m1.1.1.2" xref="algorithm1.22.22.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.22.22.m1.1.1.1" xref="algorithm1.22.22.m1.1.1.1.cmml"><mi id="algorithm1.22.22.m1.1.1.1.3" xref="algorithm1.22.22.m1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.1.1.1.2" xref="algorithm1.22.22.m1.1.1.1.2.cmml">​</mo><msub id="algorithm1.22.22.m1.1.1.1.4" xref="algorithm1.22.22.m1.1.1.1.4.cmml"><mi id="algorithm1.22.22.m1.1.1.1.4.2" xref="algorithm1.22.22.m1.1.1.1.4.2.cmml">I</mi><mi id="algorithm1.22.22.m1.1.1.1.4.3" xref="algorithm1.22.22.m1.1.1.1.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.1.1.1.2a" xref="algorithm1.22.22.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.22.22.m1.1.1.1.1.1" xref="algorithm1.22.22.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.22.22.m1.1.1.1.1.1.2" xref="algorithm1.22.22.m1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.22.22.m1.1.1.1.1.1.1" xref="algorithm1.22.22.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.22.22.m1.1.1.1.1.1.1.2" xref="algorithm1.22.22.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.22.22.m1.1.1.1.1.1.1.3" xref="algorithm1.22.22.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm1.22.22.m1.1.1.1.1.1.3" xref="algorithm1.22.22.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.1b"><apply id="algorithm1.22.22.m1.1.1.cmml" xref="algorithm1.22.22.m1.1.1"><ci id="algorithm1.22.22.m1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.2">←</ci><apply id="algorithm1.22.22.m1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.3.1.cmml" xref="algorithm1.22.22.m1.1.1.3">superscript</csymbol><apply id="algorithm1.22.22.m1.1.1.3.2.cmml" xref="algorithm1.22.22.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.3.2.1.cmml" xref="algorithm1.22.22.m1.1.1.3">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.3.2.2.cmml" xref="algorithm1.22.22.m1.1.1.3.2.2">𝑥</ci><ci id="algorithm1.22.22.m1.1.1.3.2.3.cmml" xref="algorithm1.22.22.m1.1.1.3.2.3">𝑘</ci></apply><apply id="algorithm1.22.22.m1.1.1.3.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3"><times id="algorithm1.22.22.m1.1.1.3.3.1.cmml" xref="algorithm1.22.22.m1.1.1.3.3.1"></times><ci id="algorithm1.22.22.m1.1.1.3.3.2.cmml" xref="algorithm1.22.22.m1.1.1.3.3.2">𝑙</ci><ci id="algorithm1.22.22.m1.1.1.3.3.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3.3">𝑐</ci></apply></apply><apply id="algorithm1.22.22.m1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1"><times id="algorithm1.22.22.m1.1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.1.2"></times><ci id="algorithm1.22.22.m1.1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.1.3">𝐹</ci><apply id="algorithm1.22.22.m1.1.1.1.4.cmml" xref="algorithm1.22.22.m1.1.1.1.4"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.1.4.1.cmml" xref="algorithm1.22.22.m1.1.1.1.4">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.1.4.2.cmml" xref="algorithm1.22.22.m1.1.1.1.4.2">𝐼</ci><ci id="algorithm1.22.22.m1.1.1.1.4.3.cmml" xref="algorithm1.22.22.m1.1.1.1.4.3">𝑘</ci></apply><apply id="algorithm1.22.22.m1.1.1.1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm1.22.22.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.1c">x_{k}^{lc}\leftarrow FI_{k}(x_{k})</annotation></semantics></math> 
</div>
<div id="algorithm1.26.26" class="ltx_listingline">
   <math id="algorithm1.23.23.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.23.23.m1.1a"><mo id="algorithm1.23.23.m1.1.1" xref="algorithm1.23.23.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m1.1b"><ci id="algorithm1.23.23.m1.1.1.cmml" xref="algorithm1.23.23.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m1.1c">\triangleright</annotation></semantics></math> Institution <math id="algorithm1.24.24.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.24.24.m2.1a"><mi id="algorithm1.24.24.m2.1.1" xref="algorithm1.24.24.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m2.1b"><ci id="algorithm1.24.24.m2.1.1.cmml" xref="algorithm1.24.24.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m2.1c">k</annotation></semantics></math> forward propagates <math id="algorithm1.25.25.m3.1" class="ltx_Math" alttext="x_{k}" display="inline"><semantics id="algorithm1.25.25.m3.1a"><msub id="algorithm1.25.25.m3.1.1" xref="algorithm1.25.25.m3.1.1.cmml"><mi id="algorithm1.25.25.m3.1.1.2" xref="algorithm1.25.25.m3.1.1.2.cmml">x</mi><mi id="algorithm1.25.25.m3.1.1.3" xref="algorithm1.25.25.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m3.1b"><apply id="algorithm1.25.25.m3.1.1.cmml" xref="algorithm1.25.25.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.25.25.m3.1.1.1.cmml" xref="algorithm1.25.25.m3.1.1">subscript</csymbol><ci id="algorithm1.25.25.m3.1.1.2.cmml" xref="algorithm1.25.25.m3.1.1.2">𝑥</ci><ci id="algorithm1.25.25.m3.1.1.3.cmml" xref="algorithm1.25.25.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m3.1c">x_{k}</annotation></semantics></math> to cut layer <math id="algorithm1.26.26.m4.1" class="ltx_Math" alttext="lc" display="inline"><semantics id="algorithm1.26.26.m4.1a"><mrow id="algorithm1.26.26.m4.1.1" xref="algorithm1.26.26.m4.1.1.cmml"><mi id="algorithm1.26.26.m4.1.1.2" xref="algorithm1.26.26.m4.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.26.26.m4.1.1.1" xref="algorithm1.26.26.m4.1.1.1.cmml">​</mo><mi id="algorithm1.26.26.m4.1.1.3" xref="algorithm1.26.26.m4.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m4.1b"><apply id="algorithm1.26.26.m4.1.1.cmml" xref="algorithm1.26.26.m4.1.1"><times id="algorithm1.26.26.m4.1.1.1.cmml" xref="algorithm1.26.26.m4.1.1.1"></times><ci id="algorithm1.26.26.m4.1.1.2.cmml" xref="algorithm1.26.26.m4.1.1.2">𝑙</ci><ci id="algorithm1.26.26.m4.1.1.3.cmml" xref="algorithm1.26.26.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m4.1c">lc</annotation></semantics></math> 
</div>
<div id="algorithm1.59.72" class="ltx_listingline">

</div>
<div id="algorithm1.28.28" class="ltx_listingline">   Server <math id="algorithm1.27.27.m1.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="algorithm1.27.27.m1.1a"><mo stretchy="false" id="algorithm1.27.27.m1.1.1" xref="algorithm1.27.27.m1.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m1.1b"><ci id="algorithm1.27.27.m1.1.1.cmml" xref="algorithm1.27.27.m1.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m1.1c">\leftarrow</annotation></semantics></math> <math id="algorithm1.28.28.m2.2" class="ltx_Math" alttext="x_{k}^{lc},y_{k}" display="inline"><semantics id="algorithm1.28.28.m2.2a"><mrow id="algorithm1.28.28.m2.2.2.2" xref="algorithm1.28.28.m2.2.2.3.cmml"><msubsup id="algorithm1.28.28.m2.1.1.1.1" xref="algorithm1.28.28.m2.1.1.1.1.cmml"><mi id="algorithm1.28.28.m2.1.1.1.1.2.2" xref="algorithm1.28.28.m2.1.1.1.1.2.2.cmml">x</mi><mi id="algorithm1.28.28.m2.1.1.1.1.2.3" xref="algorithm1.28.28.m2.1.1.1.1.2.3.cmml">k</mi><mrow id="algorithm1.28.28.m2.1.1.1.1.3" xref="algorithm1.28.28.m2.1.1.1.1.3.cmml"><mi id="algorithm1.28.28.m2.1.1.1.1.3.2" xref="algorithm1.28.28.m2.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m2.1.1.1.1.3.1" xref="algorithm1.28.28.m2.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.28.28.m2.1.1.1.1.3.3" xref="algorithm1.28.28.m2.1.1.1.1.3.3.cmml">c</mi></mrow></msubsup><mo id="algorithm1.28.28.m2.2.2.2.3" xref="algorithm1.28.28.m2.2.2.3.cmml">,</mo><msub id="algorithm1.28.28.m2.2.2.2.2" xref="algorithm1.28.28.m2.2.2.2.2.cmml"><mi id="algorithm1.28.28.m2.2.2.2.2.2" xref="algorithm1.28.28.m2.2.2.2.2.2.cmml">y</mi><mi id="algorithm1.28.28.m2.2.2.2.2.3" xref="algorithm1.28.28.m2.2.2.2.2.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.28.28.m2.2b"><list id="algorithm1.28.28.m2.2.2.3.cmml" xref="algorithm1.28.28.m2.2.2.2"><apply id="algorithm1.28.28.m2.1.1.1.1.cmml" xref="algorithm1.28.28.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m2.1.1.1.1.1.cmml" xref="algorithm1.28.28.m2.1.1.1.1">superscript</csymbol><apply id="algorithm1.28.28.m2.1.1.1.1.2.cmml" xref="algorithm1.28.28.m2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m2.1.1.1.1.2.1.cmml" xref="algorithm1.28.28.m2.1.1.1.1">subscript</csymbol><ci id="algorithm1.28.28.m2.1.1.1.1.2.2.cmml" xref="algorithm1.28.28.m2.1.1.1.1.2.2">𝑥</ci><ci id="algorithm1.28.28.m2.1.1.1.1.2.3.cmml" xref="algorithm1.28.28.m2.1.1.1.1.2.3">𝑘</ci></apply><apply id="algorithm1.28.28.m2.1.1.1.1.3.cmml" xref="algorithm1.28.28.m2.1.1.1.1.3"><times id="algorithm1.28.28.m2.1.1.1.1.3.1.cmml" xref="algorithm1.28.28.m2.1.1.1.1.3.1"></times><ci id="algorithm1.28.28.m2.1.1.1.1.3.2.cmml" xref="algorithm1.28.28.m2.1.1.1.1.3.2">𝑙</ci><ci id="algorithm1.28.28.m2.1.1.1.1.3.3.cmml" xref="algorithm1.28.28.m2.1.1.1.1.3.3">𝑐</ci></apply></apply><apply id="algorithm1.28.28.m2.2.2.2.2.cmml" xref="algorithm1.28.28.m2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.28.28.m2.2.2.2.2.1.cmml" xref="algorithm1.28.28.m2.2.2.2.2">subscript</csymbol><ci id="algorithm1.28.28.m2.2.2.2.2.2.cmml" xref="algorithm1.28.28.m2.2.2.2.2.2">𝑦</ci><ci id="algorithm1.28.28.m2.2.2.2.2.3.cmml" xref="algorithm1.28.28.m2.2.2.2.2.3">𝑘</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.28.m2.2c">x_{k}^{lc},y_{k}</annotation></semantics></math> 
</div>
<div id="algorithm1.31.31" class="ltx_listingline">
   <math id="algorithm1.29.29.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.29.29.m1.1a"><mo id="algorithm1.29.29.m1.1.1" xref="algorithm1.29.29.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.29.29.m1.1b"><ci id="algorithm1.29.29.m1.1.1.cmml" xref="algorithm1.29.29.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.29.m1.1c">\triangleright</annotation></semantics></math> Institution <math id="algorithm1.30.30.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.30.30.m2.1a"><mi id="algorithm1.30.30.m2.1.1" xref="algorithm1.30.30.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.30.30.m2.1b"><ci id="algorithm1.30.30.m2.1.1.cmml" xref="algorithm1.30.30.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.30.m2.1c">k</annotation></semantics></math> sends intermediate feature maps at <math id="algorithm1.31.31.m3.1" class="ltx_Math" alttext="lc" display="inline"><semantics id="algorithm1.31.31.m3.1a"><mrow id="algorithm1.31.31.m3.1.1" xref="algorithm1.31.31.m3.1.1.cmml"><mi id="algorithm1.31.31.m3.1.1.2" xref="algorithm1.31.31.m3.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.31.31.m3.1.1.1" xref="algorithm1.31.31.m3.1.1.1.cmml">​</mo><mi id="algorithm1.31.31.m3.1.1.3" xref="algorithm1.31.31.m3.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.31.31.m3.1b"><apply id="algorithm1.31.31.m3.1.1.cmml" xref="algorithm1.31.31.m3.1.1"><times id="algorithm1.31.31.m3.1.1.1.cmml" xref="algorithm1.31.31.m3.1.1.1"></times><ci id="algorithm1.31.31.m3.1.1.2.cmml" xref="algorithm1.31.31.m3.1.1.2">𝑙</ci><ci id="algorithm1.31.31.m3.1.1.3.cmml" xref="algorithm1.31.31.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.31.m3.1c">lc</annotation></semantics></math> and labels to server 
</div>
<div id="algorithm1.59.73" class="ltx_listingline">

</div>
<div id="algorithm1.32.32" class="ltx_listingline">   <math id="algorithm1.32.32.m1.1" class="ltx_Math" alttext="X_{S}^{lc}\leftarrow{x_{1}^{lc}\oplus x_{2}^{lc}…\oplus x_{St}^{lc}}" display="inline"><semantics id="algorithm1.32.32.m1.1a"><mrow id="algorithm1.32.32.m1.1.1" xref="algorithm1.32.32.m1.1.1.cmml"><msubsup id="algorithm1.32.32.m1.1.1.2" xref="algorithm1.32.32.m1.1.1.2.cmml"><mi id="algorithm1.32.32.m1.1.1.2.2.2" xref="algorithm1.32.32.m1.1.1.2.2.2.cmml">X</mi><mi id="algorithm1.32.32.m1.1.1.2.2.3" xref="algorithm1.32.32.m1.1.1.2.2.3.cmml">S</mi><mrow id="algorithm1.32.32.m1.1.1.2.3" xref="algorithm1.32.32.m1.1.1.2.3.cmml"><mi id="algorithm1.32.32.m1.1.1.2.3.2" xref="algorithm1.32.32.m1.1.1.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.1.1.2.3.1" xref="algorithm1.32.32.m1.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.32.32.m1.1.1.2.3.3" xref="algorithm1.32.32.m1.1.1.2.3.3.cmml">c</mi></mrow></msubsup><mo stretchy="false" id="algorithm1.32.32.m1.1.1.1" xref="algorithm1.32.32.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.32.32.m1.1.1.3" xref="algorithm1.32.32.m1.1.1.3.cmml"><msubsup id="algorithm1.32.32.m1.1.1.3.2" xref="algorithm1.32.32.m1.1.1.3.2.cmml"><mi id="algorithm1.32.32.m1.1.1.3.2.2.2" xref="algorithm1.32.32.m1.1.1.3.2.2.2.cmml">x</mi><mn id="algorithm1.32.32.m1.1.1.3.2.2.3" xref="algorithm1.32.32.m1.1.1.3.2.2.3.cmml">1</mn><mrow id="algorithm1.32.32.m1.1.1.3.2.3" xref="algorithm1.32.32.m1.1.1.3.2.3.cmml"><mi id="algorithm1.32.32.m1.1.1.3.2.3.2" xref="algorithm1.32.32.m1.1.1.3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.1.1.3.2.3.1" xref="algorithm1.32.32.m1.1.1.3.2.3.1.cmml">​</mo><mi id="algorithm1.32.32.m1.1.1.3.2.3.3" xref="algorithm1.32.32.m1.1.1.3.2.3.3.cmml">c</mi></mrow></msubsup><mo id="algorithm1.32.32.m1.1.1.3.1" xref="algorithm1.32.32.m1.1.1.3.1.cmml">⊕</mo><mrow id="algorithm1.32.32.m1.1.1.3.3" xref="algorithm1.32.32.m1.1.1.3.3.cmml"><msubsup id="algorithm1.32.32.m1.1.1.3.3.2" xref="algorithm1.32.32.m1.1.1.3.3.2.cmml"><mi id="algorithm1.32.32.m1.1.1.3.3.2.2.2" xref="algorithm1.32.32.m1.1.1.3.3.2.2.2.cmml">x</mi><mn id="algorithm1.32.32.m1.1.1.3.3.2.2.3" xref="algorithm1.32.32.m1.1.1.3.3.2.2.3.cmml">2</mn><mrow id="algorithm1.32.32.m1.1.1.3.3.2.3" xref="algorithm1.32.32.m1.1.1.3.3.2.3.cmml"><mi id="algorithm1.32.32.m1.1.1.3.3.2.3.2" xref="algorithm1.32.32.m1.1.1.3.3.2.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.1.1.3.3.2.3.1" xref="algorithm1.32.32.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="algorithm1.32.32.m1.1.1.3.3.2.3.3" xref="algorithm1.32.32.m1.1.1.3.3.2.3.3.cmml">c</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.1.1.3.3.1" xref="algorithm1.32.32.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.32.32.m1.1.1.3.3.3" xref="algorithm1.32.32.m1.1.1.3.3.3.cmml">…</mi></mrow><mo id="algorithm1.32.32.m1.1.1.3.1a" xref="algorithm1.32.32.m1.1.1.3.1.cmml">⊕</mo><msubsup id="algorithm1.32.32.m1.1.1.3.4" xref="algorithm1.32.32.m1.1.1.3.4.cmml"><mi id="algorithm1.32.32.m1.1.1.3.4.2.2" xref="algorithm1.32.32.m1.1.1.3.4.2.2.cmml">x</mi><mrow id="algorithm1.32.32.m1.1.1.3.4.2.3" xref="algorithm1.32.32.m1.1.1.3.4.2.3.cmml"><mi id="algorithm1.32.32.m1.1.1.3.4.2.3.2" xref="algorithm1.32.32.m1.1.1.3.4.2.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.1.1.3.4.2.3.1" xref="algorithm1.32.32.m1.1.1.3.4.2.3.1.cmml">​</mo><mi id="algorithm1.32.32.m1.1.1.3.4.2.3.3" xref="algorithm1.32.32.m1.1.1.3.4.2.3.3.cmml">t</mi></mrow><mrow id="algorithm1.32.32.m1.1.1.3.4.3" xref="algorithm1.32.32.m1.1.1.3.4.3.cmml"><mi id="algorithm1.32.32.m1.1.1.3.4.3.2" xref="algorithm1.32.32.m1.1.1.3.4.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.32.32.m1.1.1.3.4.3.1" xref="algorithm1.32.32.m1.1.1.3.4.3.1.cmml">​</mo><mi id="algorithm1.32.32.m1.1.1.3.4.3.3" xref="algorithm1.32.32.m1.1.1.3.4.3.3.cmml">c</mi></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.32.32.m1.1b"><apply id="algorithm1.32.32.m1.1.1.cmml" xref="algorithm1.32.32.m1.1.1"><ci id="algorithm1.32.32.m1.1.1.1.cmml" xref="algorithm1.32.32.m1.1.1.1">←</ci><apply id="algorithm1.32.32.m1.1.1.2.cmml" xref="algorithm1.32.32.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.2.1.cmml" xref="algorithm1.32.32.m1.1.1.2">superscript</csymbol><apply id="algorithm1.32.32.m1.1.1.2.2.cmml" xref="algorithm1.32.32.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.2.2.1.cmml" xref="algorithm1.32.32.m1.1.1.2">subscript</csymbol><ci id="algorithm1.32.32.m1.1.1.2.2.2.cmml" xref="algorithm1.32.32.m1.1.1.2.2.2">𝑋</ci><ci id="algorithm1.32.32.m1.1.1.2.2.3.cmml" xref="algorithm1.32.32.m1.1.1.2.2.3">𝑆</ci></apply><apply id="algorithm1.32.32.m1.1.1.2.3.cmml" xref="algorithm1.32.32.m1.1.1.2.3"><times id="algorithm1.32.32.m1.1.1.2.3.1.cmml" xref="algorithm1.32.32.m1.1.1.2.3.1"></times><ci id="algorithm1.32.32.m1.1.1.2.3.2.cmml" xref="algorithm1.32.32.m1.1.1.2.3.2">𝑙</ci><ci id="algorithm1.32.32.m1.1.1.2.3.3.cmml" xref="algorithm1.32.32.m1.1.1.2.3.3">𝑐</ci></apply></apply><apply id="algorithm1.32.32.m1.1.1.3.cmml" xref="algorithm1.32.32.m1.1.1.3"><csymbol cd="latexml" id="algorithm1.32.32.m1.1.1.3.1.cmml" xref="algorithm1.32.32.m1.1.1.3.1">direct-sum</csymbol><apply id="algorithm1.32.32.m1.1.1.3.2.cmml" xref="algorithm1.32.32.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.3.2.1.cmml" xref="algorithm1.32.32.m1.1.1.3.2">superscript</csymbol><apply id="algorithm1.32.32.m1.1.1.3.2.2.cmml" xref="algorithm1.32.32.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.3.2.2.1.cmml" xref="algorithm1.32.32.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.32.32.m1.1.1.3.2.2.2.cmml" xref="algorithm1.32.32.m1.1.1.3.2.2.2">𝑥</ci><cn type="integer" id="algorithm1.32.32.m1.1.1.3.2.2.3.cmml" xref="algorithm1.32.32.m1.1.1.3.2.2.3">1</cn></apply><apply id="algorithm1.32.32.m1.1.1.3.2.3.cmml" xref="algorithm1.32.32.m1.1.1.3.2.3"><times id="algorithm1.32.32.m1.1.1.3.2.3.1.cmml" xref="algorithm1.32.32.m1.1.1.3.2.3.1"></times><ci id="algorithm1.32.32.m1.1.1.3.2.3.2.cmml" xref="algorithm1.32.32.m1.1.1.3.2.3.2">𝑙</ci><ci id="algorithm1.32.32.m1.1.1.3.2.3.3.cmml" xref="algorithm1.32.32.m1.1.1.3.2.3.3">𝑐</ci></apply></apply><apply id="algorithm1.32.32.m1.1.1.3.3.cmml" xref="algorithm1.32.32.m1.1.1.3.3"><times id="algorithm1.32.32.m1.1.1.3.3.1.cmml" xref="algorithm1.32.32.m1.1.1.3.3.1"></times><apply id="algorithm1.32.32.m1.1.1.3.3.2.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.3.3.2.1.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2">superscript</csymbol><apply id="algorithm1.32.32.m1.1.1.3.3.2.2.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.3.3.2.2.1.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2">subscript</csymbol><ci id="algorithm1.32.32.m1.1.1.3.3.2.2.2.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2.2.2">𝑥</ci><cn type="integer" id="algorithm1.32.32.m1.1.1.3.3.2.2.3.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2.2.3">2</cn></apply><apply id="algorithm1.32.32.m1.1.1.3.3.2.3.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2.3"><times id="algorithm1.32.32.m1.1.1.3.3.2.3.1.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2.3.1"></times><ci id="algorithm1.32.32.m1.1.1.3.3.2.3.2.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2.3.2">𝑙</ci><ci id="algorithm1.32.32.m1.1.1.3.3.2.3.3.cmml" xref="algorithm1.32.32.m1.1.1.3.3.2.3.3">𝑐</ci></apply></apply><ci id="algorithm1.32.32.m1.1.1.3.3.3.cmml" xref="algorithm1.32.32.m1.1.1.3.3.3">…</ci></apply><apply id="algorithm1.32.32.m1.1.1.3.4.cmml" xref="algorithm1.32.32.m1.1.1.3.4"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.3.4.1.cmml" xref="algorithm1.32.32.m1.1.1.3.4">superscript</csymbol><apply id="algorithm1.32.32.m1.1.1.3.4.2.cmml" xref="algorithm1.32.32.m1.1.1.3.4"><csymbol cd="ambiguous" id="algorithm1.32.32.m1.1.1.3.4.2.1.cmml" xref="algorithm1.32.32.m1.1.1.3.4">subscript</csymbol><ci id="algorithm1.32.32.m1.1.1.3.4.2.2.cmml" xref="algorithm1.32.32.m1.1.1.3.4.2.2">𝑥</ci><apply id="algorithm1.32.32.m1.1.1.3.4.2.3.cmml" xref="algorithm1.32.32.m1.1.1.3.4.2.3"><times id="algorithm1.32.32.m1.1.1.3.4.2.3.1.cmml" xref="algorithm1.32.32.m1.1.1.3.4.2.3.1"></times><ci id="algorithm1.32.32.m1.1.1.3.4.2.3.2.cmml" xref="algorithm1.32.32.m1.1.1.3.4.2.3.2">𝑆</ci><ci id="algorithm1.32.32.m1.1.1.3.4.2.3.3.cmml" xref="algorithm1.32.32.m1.1.1.3.4.2.3.3">𝑡</ci></apply></apply><apply id="algorithm1.32.32.m1.1.1.3.4.3.cmml" xref="algorithm1.32.32.m1.1.1.3.4.3"><times id="algorithm1.32.32.m1.1.1.3.4.3.1.cmml" xref="algorithm1.32.32.m1.1.1.3.4.3.1"></times><ci id="algorithm1.32.32.m1.1.1.3.4.3.2.cmml" xref="algorithm1.32.32.m1.1.1.3.4.3.2">𝑙</ci><ci id="algorithm1.32.32.m1.1.1.3.4.3.3.cmml" xref="algorithm1.32.32.m1.1.1.3.4.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.32.32.m1.1c">X_{S}^{lc}\leftarrow{x_{1}^{lc}\oplus x_{2}^{lc}…\oplus x_{St}^{lc}}</annotation></semantics></math> 
</div>
<div id="algorithm1.33.33" class="ltx_listingline">
   <math id="algorithm1.33.33.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.33.33.m1.1a"><mo id="algorithm1.33.33.m1.1.1" xref="algorithm1.33.33.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.33.33.m1.1b"><ci id="algorithm1.33.33.m1.1.1.cmml" xref="algorithm1.33.33.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.33.33.m1.1c">\triangleright</annotation></semantics></math> Server concatenates feature maps from all institutions

</div>
<div id="algorithm1.34.34" class="ltx_listingline">   <math id="algorithm1.34.34.m1.1" class="ltx_Math" alttext="Y_{S}\leftarrow{y_{1}\oplus y_{2}…\oplus y_{St}}" display="inline"><semantics id="algorithm1.34.34.m1.1a"><mrow id="algorithm1.34.34.m1.1.1" xref="algorithm1.34.34.m1.1.1.cmml"><msub id="algorithm1.34.34.m1.1.1.2" xref="algorithm1.34.34.m1.1.1.2.cmml"><mi id="algorithm1.34.34.m1.1.1.2.2" xref="algorithm1.34.34.m1.1.1.2.2.cmml">Y</mi><mi id="algorithm1.34.34.m1.1.1.2.3" xref="algorithm1.34.34.m1.1.1.2.3.cmml">S</mi></msub><mo stretchy="false" id="algorithm1.34.34.m1.1.1.1" xref="algorithm1.34.34.m1.1.1.1.cmml">←</mo><mrow id="algorithm1.34.34.m1.1.1.3" xref="algorithm1.34.34.m1.1.1.3.cmml"><msub id="algorithm1.34.34.m1.1.1.3.2" xref="algorithm1.34.34.m1.1.1.3.2.cmml"><mi id="algorithm1.34.34.m1.1.1.3.2.2" xref="algorithm1.34.34.m1.1.1.3.2.2.cmml">y</mi><mn id="algorithm1.34.34.m1.1.1.3.2.3" xref="algorithm1.34.34.m1.1.1.3.2.3.cmml">1</mn></msub><mo id="algorithm1.34.34.m1.1.1.3.1" xref="algorithm1.34.34.m1.1.1.3.1.cmml">⊕</mo><mrow id="algorithm1.34.34.m1.1.1.3.3" xref="algorithm1.34.34.m1.1.1.3.3.cmml"><msub id="algorithm1.34.34.m1.1.1.3.3.2" xref="algorithm1.34.34.m1.1.1.3.3.2.cmml"><mi id="algorithm1.34.34.m1.1.1.3.3.2.2" xref="algorithm1.34.34.m1.1.1.3.3.2.2.cmml">y</mi><mn id="algorithm1.34.34.m1.1.1.3.3.2.3" xref="algorithm1.34.34.m1.1.1.3.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="algorithm1.34.34.m1.1.1.3.3.1" xref="algorithm1.34.34.m1.1.1.3.3.1.cmml">​</mo><mi mathvariant="normal" id="algorithm1.34.34.m1.1.1.3.3.3" xref="algorithm1.34.34.m1.1.1.3.3.3.cmml">…</mi></mrow><mo id="algorithm1.34.34.m1.1.1.3.1a" xref="algorithm1.34.34.m1.1.1.3.1.cmml">⊕</mo><msub id="algorithm1.34.34.m1.1.1.3.4" xref="algorithm1.34.34.m1.1.1.3.4.cmml"><mi id="algorithm1.34.34.m1.1.1.3.4.2" xref="algorithm1.34.34.m1.1.1.3.4.2.cmml">y</mi><mrow id="algorithm1.34.34.m1.1.1.3.4.3" xref="algorithm1.34.34.m1.1.1.3.4.3.cmml"><mi id="algorithm1.34.34.m1.1.1.3.4.3.2" xref="algorithm1.34.34.m1.1.1.3.4.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.34.34.m1.1.1.3.4.3.1" xref="algorithm1.34.34.m1.1.1.3.4.3.1.cmml">​</mo><mi id="algorithm1.34.34.m1.1.1.3.4.3.3" xref="algorithm1.34.34.m1.1.1.3.4.3.3.cmml">t</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.34.34.m1.1b"><apply id="algorithm1.34.34.m1.1.1.cmml" xref="algorithm1.34.34.m1.1.1"><ci id="algorithm1.34.34.m1.1.1.1.cmml" xref="algorithm1.34.34.m1.1.1.1">←</ci><apply id="algorithm1.34.34.m1.1.1.2.cmml" xref="algorithm1.34.34.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.34.34.m1.1.1.2.1.cmml" xref="algorithm1.34.34.m1.1.1.2">subscript</csymbol><ci id="algorithm1.34.34.m1.1.1.2.2.cmml" xref="algorithm1.34.34.m1.1.1.2.2">𝑌</ci><ci id="algorithm1.34.34.m1.1.1.2.3.cmml" xref="algorithm1.34.34.m1.1.1.2.3">𝑆</ci></apply><apply id="algorithm1.34.34.m1.1.1.3.cmml" xref="algorithm1.34.34.m1.1.1.3"><csymbol cd="latexml" id="algorithm1.34.34.m1.1.1.3.1.cmml" xref="algorithm1.34.34.m1.1.1.3.1">direct-sum</csymbol><apply id="algorithm1.34.34.m1.1.1.3.2.cmml" xref="algorithm1.34.34.m1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.34.34.m1.1.1.3.2.1.cmml" xref="algorithm1.34.34.m1.1.1.3.2">subscript</csymbol><ci id="algorithm1.34.34.m1.1.1.3.2.2.cmml" xref="algorithm1.34.34.m1.1.1.3.2.2">𝑦</ci><cn type="integer" id="algorithm1.34.34.m1.1.1.3.2.3.cmml" xref="algorithm1.34.34.m1.1.1.3.2.3">1</cn></apply><apply id="algorithm1.34.34.m1.1.1.3.3.cmml" xref="algorithm1.34.34.m1.1.1.3.3"><times id="algorithm1.34.34.m1.1.1.3.3.1.cmml" xref="algorithm1.34.34.m1.1.1.3.3.1"></times><apply id="algorithm1.34.34.m1.1.1.3.3.2.cmml" xref="algorithm1.34.34.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.34.34.m1.1.1.3.3.2.1.cmml" xref="algorithm1.34.34.m1.1.1.3.3.2">subscript</csymbol><ci id="algorithm1.34.34.m1.1.1.3.3.2.2.cmml" xref="algorithm1.34.34.m1.1.1.3.3.2.2">𝑦</ci><cn type="integer" id="algorithm1.34.34.m1.1.1.3.3.2.3.cmml" xref="algorithm1.34.34.m1.1.1.3.3.2.3">2</cn></apply><ci id="algorithm1.34.34.m1.1.1.3.3.3.cmml" xref="algorithm1.34.34.m1.1.1.3.3.3">…</ci></apply><apply id="algorithm1.34.34.m1.1.1.3.4.cmml" xref="algorithm1.34.34.m1.1.1.3.4"><csymbol cd="ambiguous" id="algorithm1.34.34.m1.1.1.3.4.1.cmml" xref="algorithm1.34.34.m1.1.1.3.4">subscript</csymbol><ci id="algorithm1.34.34.m1.1.1.3.4.2.cmml" xref="algorithm1.34.34.m1.1.1.3.4.2">𝑦</ci><apply id="algorithm1.34.34.m1.1.1.3.4.3.cmml" xref="algorithm1.34.34.m1.1.1.3.4.3"><times id="algorithm1.34.34.m1.1.1.3.4.3.1.cmml" xref="algorithm1.34.34.m1.1.1.3.4.3.1"></times><ci id="algorithm1.34.34.m1.1.1.3.4.3.2.cmml" xref="algorithm1.34.34.m1.1.1.3.4.3.2">𝑆</ci><ci id="algorithm1.34.34.m1.1.1.3.4.3.3.cmml" xref="algorithm1.34.34.m1.1.1.3.4.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.34.34.m1.1c">Y_{S}\leftarrow{y_{1}\oplus y_{2}…\oplus y_{St}}</annotation></semantics></math> 
</div>
<div id="algorithm1.35.35" class="ltx_listingline">
   <math id="algorithm1.35.35.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.35.35.m1.1a"><mo id="algorithm1.35.35.m1.1.1" xref="algorithm1.35.35.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.35.35.m1.1b"><ci id="algorithm1.35.35.m1.1.1.cmml" xref="algorithm1.35.35.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.35.35.m1.1c">\triangleright</annotation></semantics></math> Server concatenates labels from all institutions 
</div>
<div id="algorithm1.59.74" class="ltx_listingline">

</div>
<div id="algorithm1.36.36" class="ltx_listingline">   <math id="algorithm1.36.36.m1.1" class="ltx_Math" alttext="\hat{Y}_{S}\leftarrow FS(X_{S}^{lc})" display="inline"><semantics id="algorithm1.36.36.m1.1a"><mrow id="algorithm1.36.36.m1.1.1" xref="algorithm1.36.36.m1.1.1.cmml"><msub id="algorithm1.36.36.m1.1.1.3" xref="algorithm1.36.36.m1.1.1.3.cmml"><mover accent="true" id="algorithm1.36.36.m1.1.1.3.2" xref="algorithm1.36.36.m1.1.1.3.2.cmml"><mi id="algorithm1.36.36.m1.1.1.3.2.2" xref="algorithm1.36.36.m1.1.1.3.2.2.cmml">Y</mi><mo id="algorithm1.36.36.m1.1.1.3.2.1" xref="algorithm1.36.36.m1.1.1.3.2.1.cmml">^</mo></mover><mi id="algorithm1.36.36.m1.1.1.3.3" xref="algorithm1.36.36.m1.1.1.3.3.cmml">S</mi></msub><mo stretchy="false" id="algorithm1.36.36.m1.1.1.2" xref="algorithm1.36.36.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.36.36.m1.1.1.1" xref="algorithm1.36.36.m1.1.1.1.cmml"><mi id="algorithm1.36.36.m1.1.1.1.3" xref="algorithm1.36.36.m1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.36.36.m1.1.1.1.2" xref="algorithm1.36.36.m1.1.1.1.2.cmml">​</mo><mi id="algorithm1.36.36.m1.1.1.1.4" xref="algorithm1.36.36.m1.1.1.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.36.36.m1.1.1.1.2a" xref="algorithm1.36.36.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.36.36.m1.1.1.1.1.1" xref="algorithm1.36.36.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.36.36.m1.1.1.1.1.1.2" xref="algorithm1.36.36.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="algorithm1.36.36.m1.1.1.1.1.1.1" xref="algorithm1.36.36.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.36.36.m1.1.1.1.1.1.1.2.2" xref="algorithm1.36.36.m1.1.1.1.1.1.1.2.2.cmml">X</mi><mi id="algorithm1.36.36.m1.1.1.1.1.1.1.2.3" xref="algorithm1.36.36.m1.1.1.1.1.1.1.2.3.cmml">S</mi><mrow id="algorithm1.36.36.m1.1.1.1.1.1.1.3" xref="algorithm1.36.36.m1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.36.36.m1.1.1.1.1.1.1.3.2" xref="algorithm1.36.36.m1.1.1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.36.36.m1.1.1.1.1.1.1.3.1" xref="algorithm1.36.36.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm1.36.36.m1.1.1.1.1.1.1.3.3" xref="algorithm1.36.36.m1.1.1.1.1.1.1.3.3.cmml">c</mi></mrow></msubsup><mo stretchy="false" id="algorithm1.36.36.m1.1.1.1.1.1.3" xref="algorithm1.36.36.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.36.36.m1.1b"><apply id="algorithm1.36.36.m1.1.1.cmml" xref="algorithm1.36.36.m1.1.1"><ci id="algorithm1.36.36.m1.1.1.2.cmml" xref="algorithm1.36.36.m1.1.1.2">←</ci><apply id="algorithm1.36.36.m1.1.1.3.cmml" xref="algorithm1.36.36.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.36.36.m1.1.1.3.1.cmml" xref="algorithm1.36.36.m1.1.1.3">subscript</csymbol><apply id="algorithm1.36.36.m1.1.1.3.2.cmml" xref="algorithm1.36.36.m1.1.1.3.2"><ci id="algorithm1.36.36.m1.1.1.3.2.1.cmml" xref="algorithm1.36.36.m1.1.1.3.2.1">^</ci><ci id="algorithm1.36.36.m1.1.1.3.2.2.cmml" xref="algorithm1.36.36.m1.1.1.3.2.2">𝑌</ci></apply><ci id="algorithm1.36.36.m1.1.1.3.3.cmml" xref="algorithm1.36.36.m1.1.1.3.3">𝑆</ci></apply><apply id="algorithm1.36.36.m1.1.1.1.cmml" xref="algorithm1.36.36.m1.1.1.1"><times id="algorithm1.36.36.m1.1.1.1.2.cmml" xref="algorithm1.36.36.m1.1.1.1.2"></times><ci id="algorithm1.36.36.m1.1.1.1.3.cmml" xref="algorithm1.36.36.m1.1.1.1.3">𝐹</ci><ci id="algorithm1.36.36.m1.1.1.1.4.cmml" xref="algorithm1.36.36.m1.1.1.1.4">𝑆</ci><apply id="algorithm1.36.36.m1.1.1.1.1.1.1.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.36.36.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.36.36.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.36.36.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.36.36.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1.1.2.2">𝑋</ci><ci id="algorithm1.36.36.m1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1.1.2.3">𝑆</ci></apply><apply id="algorithm1.36.36.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1.1.3"><times id="algorithm1.36.36.m1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.36.36.m1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="algorithm1.36.36.m1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.36.36.m1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.36.36.m1.1c">\hat{Y}_{S}\leftarrow FS(X_{S}^{lc})</annotation></semantics></math> 
</div>
<div id="algorithm1.59.75" class="ltx_listingline">

</div>
<div id="algorithm1.38.38" class="ltx_listingline">   <math id="algorithm1.37.37.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.37.37.m1.1a"><mo id="algorithm1.37.37.m1.1.1" xref="algorithm1.37.37.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.37.37.m1.1b"><ci id="algorithm1.37.37.m1.1.1.cmml" xref="algorithm1.37.37.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.37.37.m1.1c">\triangleright</annotation></semantics></math> Server forward propagates concatenated feature maps <math id="algorithm1.38.38.m2.1" class="ltx_Math" alttext="X_{S}^{lc}" display="inline"><semantics id="algorithm1.38.38.m2.1a"><msubsup id="algorithm1.38.38.m2.1.1" xref="algorithm1.38.38.m2.1.1.cmml"><mi id="algorithm1.38.38.m2.1.1.2.2" xref="algorithm1.38.38.m2.1.1.2.2.cmml">X</mi><mi id="algorithm1.38.38.m2.1.1.2.3" xref="algorithm1.38.38.m2.1.1.2.3.cmml">S</mi><mrow id="algorithm1.38.38.m2.1.1.3" xref="algorithm1.38.38.m2.1.1.3.cmml"><mi id="algorithm1.38.38.m2.1.1.3.2" xref="algorithm1.38.38.m2.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.38.38.m2.1.1.3.1" xref="algorithm1.38.38.m2.1.1.3.1.cmml">​</mo><mi id="algorithm1.38.38.m2.1.1.3.3" xref="algorithm1.38.38.m2.1.1.3.3.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.38.38.m2.1b"><apply id="algorithm1.38.38.m2.1.1.cmml" xref="algorithm1.38.38.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.38.38.m2.1.1.1.cmml" xref="algorithm1.38.38.m2.1.1">superscript</csymbol><apply id="algorithm1.38.38.m2.1.1.2.cmml" xref="algorithm1.38.38.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.38.38.m2.1.1.2.1.cmml" xref="algorithm1.38.38.m2.1.1">subscript</csymbol><ci id="algorithm1.38.38.m2.1.1.2.2.cmml" xref="algorithm1.38.38.m2.1.1.2.2">𝑋</ci><ci id="algorithm1.38.38.m2.1.1.2.3.cmml" xref="algorithm1.38.38.m2.1.1.2.3">𝑆</ci></apply><apply id="algorithm1.38.38.m2.1.1.3.cmml" xref="algorithm1.38.38.m2.1.1.3"><times id="algorithm1.38.38.m2.1.1.3.1.cmml" xref="algorithm1.38.38.m2.1.1.3.1"></times><ci id="algorithm1.38.38.m2.1.1.3.2.cmml" xref="algorithm1.38.38.m2.1.1.3.2">𝑙</ci><ci id="algorithm1.38.38.m2.1.1.3.3.cmml" xref="algorithm1.38.38.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.38.38.m2.1c">X_{S}^{lc}</annotation></semantics></math> till the final layer

</div>
<div id="algorithm1.59.76" class="ltx_listingline">
<span id="algorithm1.59.76.1" class="ltx_text"></span>

</div>
<div id="algorithm1.59.77" class="ltx_listingline">   <span id="algorithm1.59.77.1" class="ltx_text ltx_font_bold">Back propagation:</span> 
</div>
<div id="algorithm1.59.78" class="ltx_listingline">

</div>
<div id="algorithm1.39.39" class="ltx_listingline">   <math id="algorithm1.39.39.m1.2" class="ltx_Math" alttext="g^{lN}=\bigtriangledown\mathcal{L}(\hat{Y}_{S},Y_{S})" display="inline"><semantics id="algorithm1.39.39.m1.2a"><mrow id="algorithm1.39.39.m1.2.2" xref="algorithm1.39.39.m1.2.2.cmml"><msup id="algorithm1.39.39.m1.2.2.4" xref="algorithm1.39.39.m1.2.2.4.cmml"><mi id="algorithm1.39.39.m1.2.2.4.2" xref="algorithm1.39.39.m1.2.2.4.2.cmml">g</mi><mrow id="algorithm1.39.39.m1.2.2.4.3" xref="algorithm1.39.39.m1.2.2.4.3.cmml"><mi id="algorithm1.39.39.m1.2.2.4.3.2" xref="algorithm1.39.39.m1.2.2.4.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.39.39.m1.2.2.4.3.1" xref="algorithm1.39.39.m1.2.2.4.3.1.cmml">​</mo><mi id="algorithm1.39.39.m1.2.2.4.3.3" xref="algorithm1.39.39.m1.2.2.4.3.3.cmml">N</mi></mrow></msup><mo rspace="0.1389em" id="algorithm1.39.39.m1.2.2.3" xref="algorithm1.39.39.m1.2.2.3.cmml">=</mo><mrow id="algorithm1.39.39.m1.2.2.2" xref="algorithm1.39.39.m1.2.2.2.cmml"><mo lspace="0.1389em" rspace="0em" id="algorithm1.39.39.m1.2.2.2a" xref="algorithm1.39.39.m1.2.2.2.cmml">▽</mo><mrow id="algorithm1.39.39.m1.2.2.2.2" xref="algorithm1.39.39.m1.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.39.39.m1.2.2.2.2.4" xref="algorithm1.39.39.m1.2.2.2.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="algorithm1.39.39.m1.2.2.2.2.3" xref="algorithm1.39.39.m1.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.39.39.m1.2.2.2.2.2.2" xref="algorithm1.39.39.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.39.39.m1.2.2.2.2.2.2.3" xref="algorithm1.39.39.m1.2.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.39.39.m1.1.1.1.1.1.1.1" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="algorithm1.39.39.m1.1.1.1.1.1.1.1.2" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.cmml"><mi id="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.2" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.2.cmml">Y</mi><mo id="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.1" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm1.39.39.m1.1.1.1.1.1.1.1.3" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="algorithm1.39.39.m1.2.2.2.2.2.2.4" xref="algorithm1.39.39.m1.2.2.2.2.2.3.cmml">,</mo><msub id="algorithm1.39.39.m1.2.2.2.2.2.2.2" xref="algorithm1.39.39.m1.2.2.2.2.2.2.2.cmml"><mi id="algorithm1.39.39.m1.2.2.2.2.2.2.2.2" xref="algorithm1.39.39.m1.2.2.2.2.2.2.2.2.cmml">Y</mi><mi id="algorithm1.39.39.m1.2.2.2.2.2.2.2.3" xref="algorithm1.39.39.m1.2.2.2.2.2.2.2.3.cmml">S</mi></msub><mo stretchy="false" id="algorithm1.39.39.m1.2.2.2.2.2.2.5" xref="algorithm1.39.39.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.39.39.m1.2b"><apply id="algorithm1.39.39.m1.2.2.cmml" xref="algorithm1.39.39.m1.2.2"><eq id="algorithm1.39.39.m1.2.2.3.cmml" xref="algorithm1.39.39.m1.2.2.3"></eq><apply id="algorithm1.39.39.m1.2.2.4.cmml" xref="algorithm1.39.39.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm1.39.39.m1.2.2.4.1.cmml" xref="algorithm1.39.39.m1.2.2.4">superscript</csymbol><ci id="algorithm1.39.39.m1.2.2.4.2.cmml" xref="algorithm1.39.39.m1.2.2.4.2">𝑔</ci><apply id="algorithm1.39.39.m1.2.2.4.3.cmml" xref="algorithm1.39.39.m1.2.2.4.3"><times id="algorithm1.39.39.m1.2.2.4.3.1.cmml" xref="algorithm1.39.39.m1.2.2.4.3.1"></times><ci id="algorithm1.39.39.m1.2.2.4.3.2.cmml" xref="algorithm1.39.39.m1.2.2.4.3.2">𝑙</ci><ci id="algorithm1.39.39.m1.2.2.4.3.3.cmml" xref="algorithm1.39.39.m1.2.2.4.3.3">𝑁</ci></apply></apply><apply id="algorithm1.39.39.m1.2.2.2.cmml" xref="algorithm1.39.39.m1.2.2.2"><ci id="algorithm1.39.39.m1.2.2.2.3.cmml" xref="algorithm1.39.39.m1.2.2.2">▽</ci><apply id="algorithm1.39.39.m1.2.2.2.2.cmml" xref="algorithm1.39.39.m1.2.2.2.2"><times id="algorithm1.39.39.m1.2.2.2.2.3.cmml" xref="algorithm1.39.39.m1.2.2.2.2.3"></times><ci id="algorithm1.39.39.m1.2.2.2.2.4.cmml" xref="algorithm1.39.39.m1.2.2.2.2.4">ℒ</ci><interval closure="open" id="algorithm1.39.39.m1.2.2.2.2.2.3.cmml" xref="algorithm1.39.39.m1.2.2.2.2.2.2"><apply id="algorithm1.39.39.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.39.39.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.2"><ci id="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.1">^</ci><ci id="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.2.2">𝑌</ci></apply><ci id="algorithm1.39.39.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.39.39.m1.1.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="algorithm1.39.39.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.39.39.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.39.39.m1.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.39.39.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.39.39.m1.2.2.2.2.2.2.2.2.cmml" xref="algorithm1.39.39.m1.2.2.2.2.2.2.2.2">𝑌</ci><ci id="algorithm1.39.39.m1.2.2.2.2.2.2.2.3.cmml" xref="algorithm1.39.39.m1.2.2.2.2.2.2.2.3">𝑆</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.39.39.m1.2c">g^{lN}=\bigtriangledown\mathcal{L}(\hat{Y}_{S},Y_{S})</annotation></semantics></math> 
</div>
<div id="algorithm1.40.40" class="ltx_listingline">
   <math id="algorithm1.40.40.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.40.40.m1.1a"><mo id="algorithm1.40.40.m1.1.1" xref="algorithm1.40.40.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.40.40.m1.1b"><ci id="algorithm1.40.40.m1.1.1.cmml" xref="algorithm1.40.40.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.40.40.m1.1c">\triangleright</annotation></semantics></math> Server generates gradients at output layer

</div>
<div id="algorithm1.41.41" class="ltx_listingline">   <math id="algorithm1.41.41.m1.3" class="ltx_Math" alttext="g^{l}\leftarrow{W_{S}^{l+1}}^{T}g^{l+1},\text{for}\text{\quad}l=l(N-1),l(N-2),…,l(c+1)" display="inline"><semantics id="algorithm1.41.41.m1.3a"><mrow id="algorithm1.41.41.m1.3.3.2" xref="algorithm1.41.41.m1.3.3.3.cmml"><mrow id="algorithm1.41.41.m1.2.2.1.1" xref="algorithm1.41.41.m1.2.2.1.1.cmml"><msup id="algorithm1.41.41.m1.2.2.1.1.2" xref="algorithm1.41.41.m1.2.2.1.1.2.cmml"><mi id="algorithm1.41.41.m1.2.2.1.1.2.2" xref="algorithm1.41.41.m1.2.2.1.1.2.2.cmml">g</mi><mi id="algorithm1.41.41.m1.2.2.1.1.2.3" xref="algorithm1.41.41.m1.2.2.1.1.2.3.cmml">l</mi></msup><mo stretchy="false" id="algorithm1.41.41.m1.2.2.1.1.1" xref="algorithm1.41.41.m1.2.2.1.1.1.cmml">←</mo><mrow id="algorithm1.41.41.m1.2.2.1.1.3" xref="algorithm1.41.41.m1.2.2.1.1.3.cmml"><mmultiscripts id="algorithm1.41.41.m1.2.2.1.1.3.2" xref="algorithm1.41.41.m1.2.2.1.1.3.2.cmml"><mi id="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.2" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.2.cmml">W</mi><mi id="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.3" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.3.cmml">S</mi><mrow id="algorithm1.41.41.m1.2.2.1.1.3.2.2.3" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.cmml"><mi id="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.2" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.2.cmml">l</mi><mo id="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.1" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.1.cmml">+</mo><mn id="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.3" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mrow id="algorithm1.41.41.m1.2.2.1.1.3.2a" xref="algorithm1.41.41.m1.2.2.1.1.3.2.cmml"></mrow><mi id="algorithm1.41.41.m1.2.2.1.1.3.2.3" xref="algorithm1.41.41.m1.2.2.1.1.3.2.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="algorithm1.41.41.m1.2.2.1.1.3.1" xref="algorithm1.41.41.m1.2.2.1.1.3.1.cmml">​</mo><msup id="algorithm1.41.41.m1.2.2.1.1.3.3" xref="algorithm1.41.41.m1.2.2.1.1.3.3.cmml"><mi id="algorithm1.41.41.m1.2.2.1.1.3.3.2" xref="algorithm1.41.41.m1.2.2.1.1.3.3.2.cmml">g</mi><mrow id="algorithm1.41.41.m1.2.2.1.1.3.3.3" xref="algorithm1.41.41.m1.2.2.1.1.3.3.3.cmml"><mi id="algorithm1.41.41.m1.2.2.1.1.3.3.3.2" xref="algorithm1.41.41.m1.2.2.1.1.3.3.3.2.cmml">l</mi><mo id="algorithm1.41.41.m1.2.2.1.1.3.3.3.1" xref="algorithm1.41.41.m1.2.2.1.1.3.3.3.1.cmml">+</mo><mn id="algorithm1.41.41.m1.2.2.1.1.3.3.3.3" xref="algorithm1.41.41.m1.2.2.1.1.3.3.3.3.cmml">1</mn></mrow></msup></mrow></mrow><mo id="algorithm1.41.41.m1.3.3.2.3" xref="algorithm1.41.41.m1.3.3.3a.cmml">,</mo><mrow id="algorithm1.41.41.m1.3.3.2.2" xref="algorithm1.41.41.m1.3.3.2.2.cmml"><mrow id="algorithm1.41.41.m1.3.3.2.2.5" xref="algorithm1.41.41.m1.3.3.2.2.5.cmml"><mrow id="algorithm1.41.41.m1.3.3.2.2.5.2" xref="algorithm1.41.41.m1.3.3.2.2.5.2c.cmml"><mtext id="algorithm1.41.41.m1.3.3.2.2.5.2a" xref="algorithm1.41.41.m1.3.3.2.2.5.2c.cmml">for</mtext><mtext id="algorithm1.41.41.m1.3.3.2.2.5.2b" xref="algorithm1.41.41.m1.3.3.2.2.5.2c.cmml"> </mtext></mrow><mo lspace="0em" rspace="0em" id="algorithm1.41.41.m1.3.3.2.2.5.1" xref="algorithm1.41.41.m1.3.3.2.2.5.1.cmml">​</mo><mi id="algorithm1.41.41.m1.3.3.2.2.5.3" xref="algorithm1.41.41.m1.3.3.2.2.5.3.cmml">l</mi></mrow><mo id="algorithm1.41.41.m1.3.3.2.2.4" xref="algorithm1.41.41.m1.3.3.2.2.4.cmml">=</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.3.3" xref="algorithm1.41.41.m1.3.3.2.2.3.4.cmml"><mrow id="algorithm1.41.41.m1.3.3.2.2.1.1.1" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.cmml"><mi id="algorithm1.41.41.m1.3.3.2.2.1.1.1.3" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.41.41.m1.3.3.2.2.1.1.1.2" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.2.cmml">​</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.2" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.cmml"><mi id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.2" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.2.cmml">N</mi><mo id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.1" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.1.cmml">−</mo><mn id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.3" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.3" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.41.41.m1.3.3.2.2.3.3.4" xref="algorithm1.41.41.m1.3.3.2.2.3.4.cmml">,</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.2.2.2" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.cmml"><mi id="algorithm1.41.41.m1.3.3.2.2.2.2.2.3" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.41.41.m1.3.3.2.2.2.2.2.2" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.2.cmml">​</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.2" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.2" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.2.cmml">N</mi><mo id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.1" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.1.cmml">−</mo><mn id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.3" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.3.cmml">2</mn></mrow><mo stretchy="false" id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.3" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.41.41.m1.3.3.2.2.3.3.5" xref="algorithm1.41.41.m1.3.3.2.2.3.4.cmml">,</mo><mi mathvariant="normal" id="algorithm1.41.41.m1.1.1" xref="algorithm1.41.41.m1.1.1.cmml">…</mi><mo id="algorithm1.41.41.m1.3.3.2.2.3.3.6" xref="algorithm1.41.41.m1.3.3.2.2.3.4.cmml">,</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.3.3.3" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.cmml"><mi id="algorithm1.41.41.m1.3.3.2.2.3.3.3.3" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.41.41.m1.3.3.2.2.3.3.3.2" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.2.cmml">​</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.cmml"><mo stretchy="false" id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.2" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.cmml">(</mo><mrow id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.cmml"><mi id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.2" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.2.cmml">c</mi><mo id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.1" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.1.cmml">+</mo><mn id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.3" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.3" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.41.41.m1.3b"><apply id="algorithm1.41.41.m1.3.3.3.cmml" xref="algorithm1.41.41.m1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.41.41.m1.3.3.3a.cmml" xref="algorithm1.41.41.m1.3.3.2.3">formulae-sequence</csymbol><apply id="algorithm1.41.41.m1.2.2.1.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1"><ci id="algorithm1.41.41.m1.2.2.1.1.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.1">←</ci><apply id="algorithm1.41.41.m1.2.2.1.1.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.41.41.m1.2.2.1.1.2.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.2">superscript</csymbol><ci id="algorithm1.41.41.m1.2.2.1.1.2.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.2.2">𝑔</ci><ci id="algorithm1.41.41.m1.2.2.1.1.2.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.2.3">𝑙</ci></apply><apply id="algorithm1.41.41.m1.2.2.1.1.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3"><times id="algorithm1.41.41.m1.2.2.1.1.3.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.1"></times><apply id="algorithm1.41.41.m1.2.2.1.1.3.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.41.41.m1.2.2.1.1.3.2.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2">superscript</csymbol><apply id="algorithm1.41.41.m1.2.2.1.1.3.2.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.41.41.m1.2.2.1.1.3.2.2.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2">superscript</csymbol><apply id="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2">subscript</csymbol><ci id="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.2">𝑊</ci><ci id="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.2.3">𝑆</ci></apply><apply id="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.3"><plus id="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.1"></plus><ci id="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.2">𝑙</ci><cn type="integer" id="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.41.41.m1.2.2.1.1.3.2.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.2.3">𝑇</ci></apply><apply id="algorithm1.41.41.m1.2.2.1.1.3.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.41.41.m1.2.2.1.1.3.3.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.3">superscript</csymbol><ci id="algorithm1.41.41.m1.2.2.1.1.3.3.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.3.2">𝑔</ci><apply id="algorithm1.41.41.m1.2.2.1.1.3.3.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.3.3"><plus id="algorithm1.41.41.m1.2.2.1.1.3.3.3.1.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.3.3.1"></plus><ci id="algorithm1.41.41.m1.2.2.1.1.3.3.3.2.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.3.3.2">𝑙</ci><cn type="integer" id="algorithm1.41.41.m1.2.2.1.1.3.3.3.3.cmml" xref="algorithm1.41.41.m1.2.2.1.1.3.3.3.3">1</cn></apply></apply></apply></apply><apply id="algorithm1.41.41.m1.3.3.2.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2"><eq id="algorithm1.41.41.m1.3.3.2.2.4.cmml" xref="algorithm1.41.41.m1.3.3.2.2.4"></eq><apply id="algorithm1.41.41.m1.3.3.2.2.5.cmml" xref="algorithm1.41.41.m1.3.3.2.2.5"><times id="algorithm1.41.41.m1.3.3.2.2.5.1.cmml" xref="algorithm1.41.41.m1.3.3.2.2.5.1"></times><ci id="algorithm1.41.41.m1.3.3.2.2.5.2c.cmml" xref="algorithm1.41.41.m1.3.3.2.2.5.2"><mrow id="algorithm1.41.41.m1.3.3.2.2.5.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2.5.2"><mtext id="algorithm1.41.41.m1.3.3.2.2.5.2a.cmml" xref="algorithm1.41.41.m1.3.3.2.2.5.2">for</mtext><mtext id="algorithm1.41.41.m1.3.3.2.2.5.2b.cmml" xref="algorithm1.41.41.m1.3.3.2.2.5.2"> </mtext></mrow></ci><ci id="algorithm1.41.41.m1.3.3.2.2.5.3.cmml" xref="algorithm1.41.41.m1.3.3.2.2.5.3">𝑙</ci></apply><list id="algorithm1.41.41.m1.3.3.2.2.3.4.cmml" xref="algorithm1.41.41.m1.3.3.2.2.3.3"><apply id="algorithm1.41.41.m1.3.3.2.2.1.1.1.cmml" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1"><times id="algorithm1.41.41.m1.3.3.2.2.1.1.1.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.2"></times><ci id="algorithm1.41.41.m1.3.3.2.2.1.1.1.3.cmml" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.3">𝑙</ci><apply id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1"><minus id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.1"></minus><ci id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.2">𝑁</ci><cn type="integer" id="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.3.cmml" xref="algorithm1.41.41.m1.3.3.2.2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="algorithm1.41.41.m1.3.3.2.2.2.2.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2"><times id="algorithm1.41.41.m1.3.3.2.2.2.2.2.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.2"></times><ci id="algorithm1.41.41.m1.3.3.2.2.2.2.2.3.cmml" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.3">𝑙</ci><apply id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.cmml" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1"><minus id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.1"></minus><ci id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.2">𝑁</ci><cn type="integer" id="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.41.41.m1.3.3.2.2.2.2.2.1.1.1.3">2</cn></apply></apply><ci id="algorithm1.41.41.m1.1.1.cmml" xref="algorithm1.41.41.m1.1.1">…</ci><apply id="algorithm1.41.41.m1.3.3.2.2.3.3.3.cmml" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3"><times id="algorithm1.41.41.m1.3.3.2.2.3.3.3.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.2"></times><ci id="algorithm1.41.41.m1.3.3.2.2.3.3.3.3.cmml" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.3">𝑙</ci><apply id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.cmml" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1"><plus id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.1.cmml" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.1"></plus><ci id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.2.cmml" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.3.cmml" xref="algorithm1.41.41.m1.3.3.2.2.3.3.3.1.1.1.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.41.41.m1.3c">g^{l}\leftarrow{W_{S}^{l+1}}^{T}g^{l+1},\text{for}\text{\quad}l=l(N-1),l(N-2),…,l(c+1)</annotation></semantics></math> 
</div>
<div id="algorithm1.43.43" class="ltx_listingline">
   <math id="algorithm1.42.42.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.42.42.m1.1a"><mo id="algorithm1.42.42.m1.1.1" xref="algorithm1.42.42.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.42.42.m1.1b"><ci id="algorithm1.42.42.m1.1.1.cmml" xref="algorithm1.42.42.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.42.42.m1.1c">\triangleright</annotation></semantics></math> Server back propagates gradients to <math id="algorithm1.43.43.m2.1" class="ltx_Math" alttext="l(c+1)" display="inline"><semantics id="algorithm1.43.43.m2.1a"><mrow id="algorithm1.43.43.m2.1.1" xref="algorithm1.43.43.m2.1.1.cmml"><mi id="algorithm1.43.43.m2.1.1.3" xref="algorithm1.43.43.m2.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.43.43.m2.1.1.2" xref="algorithm1.43.43.m2.1.1.2.cmml">​</mo><mrow id="algorithm1.43.43.m2.1.1.1.1" xref="algorithm1.43.43.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.43.43.m2.1.1.1.1.2" xref="algorithm1.43.43.m2.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.43.43.m2.1.1.1.1.1" xref="algorithm1.43.43.m2.1.1.1.1.1.cmml"><mi id="algorithm1.43.43.m2.1.1.1.1.1.2" xref="algorithm1.43.43.m2.1.1.1.1.1.2.cmml">c</mi><mo id="algorithm1.43.43.m2.1.1.1.1.1.1" xref="algorithm1.43.43.m2.1.1.1.1.1.1.cmml">+</mo><mn id="algorithm1.43.43.m2.1.1.1.1.1.3" xref="algorithm1.43.43.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.43.43.m2.1.1.1.1.3" xref="algorithm1.43.43.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.43.43.m2.1b"><apply id="algorithm1.43.43.m2.1.1.cmml" xref="algorithm1.43.43.m2.1.1"><times id="algorithm1.43.43.m2.1.1.2.cmml" xref="algorithm1.43.43.m2.1.1.2"></times><ci id="algorithm1.43.43.m2.1.1.3.cmml" xref="algorithm1.43.43.m2.1.1.3">𝑙</ci><apply id="algorithm1.43.43.m2.1.1.1.1.1.cmml" xref="algorithm1.43.43.m2.1.1.1.1"><plus id="algorithm1.43.43.m2.1.1.1.1.1.1.cmml" xref="algorithm1.43.43.m2.1.1.1.1.1.1"></plus><ci id="algorithm1.43.43.m2.1.1.1.1.1.2.cmml" xref="algorithm1.43.43.m2.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.43.43.m2.1.1.1.1.1.3.cmml" xref="algorithm1.43.43.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.43.43.m2.1c">l(c+1)</annotation></semantics></math> 
</div>
<div id="algorithm1.59.79" class="ltx_listingline">

</div>
<div id="algorithm1.44.44" class="ltx_listingline">   Institution <math id="algorithm1.44.44.m1.1" class="ltx_Math" alttext="k\in St\leftarrow g^{l(c+1)}" display="inline"><semantics id="algorithm1.44.44.m1.1a"><mrow id="algorithm1.44.44.m1.1.2" xref="algorithm1.44.44.m1.1.2.cmml"><mi id="algorithm1.44.44.m1.1.2.2" xref="algorithm1.44.44.m1.1.2.2.cmml">k</mi><mo id="algorithm1.44.44.m1.1.2.3" xref="algorithm1.44.44.m1.1.2.3.cmml">∈</mo><mrow id="algorithm1.44.44.m1.1.2.4" xref="algorithm1.44.44.m1.1.2.4.cmml"><mi id="algorithm1.44.44.m1.1.2.4.2" xref="algorithm1.44.44.m1.1.2.4.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.44.44.m1.1.2.4.1" xref="algorithm1.44.44.m1.1.2.4.1.cmml">​</mo><mi id="algorithm1.44.44.m1.1.2.4.3" xref="algorithm1.44.44.m1.1.2.4.3.cmml">t</mi></mrow><mo stretchy="false" id="algorithm1.44.44.m1.1.2.5" xref="algorithm1.44.44.m1.1.2.5.cmml">←</mo><msup id="algorithm1.44.44.m1.1.2.6" xref="algorithm1.44.44.m1.1.2.6.cmml"><mi id="algorithm1.44.44.m1.1.2.6.2" xref="algorithm1.44.44.m1.1.2.6.2.cmml">g</mi><mrow id="algorithm1.44.44.m1.1.1.1" xref="algorithm1.44.44.m1.1.1.1.cmml"><mi id="algorithm1.44.44.m1.1.1.1.3" xref="algorithm1.44.44.m1.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.44.44.m1.1.1.1.2" xref="algorithm1.44.44.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.44.44.m1.1.1.1.1.1" xref="algorithm1.44.44.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.44.44.m1.1.1.1.1.1.2" xref="algorithm1.44.44.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.44.44.m1.1.1.1.1.1.1" xref="algorithm1.44.44.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.44.44.m1.1.1.1.1.1.1.2" xref="algorithm1.44.44.m1.1.1.1.1.1.1.2.cmml">c</mi><mo id="algorithm1.44.44.m1.1.1.1.1.1.1.1" xref="algorithm1.44.44.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="algorithm1.44.44.m1.1.1.1.1.1.1.3" xref="algorithm1.44.44.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.44.44.m1.1.1.1.1.1.3" xref="algorithm1.44.44.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.44.44.m1.1b"><apply id="algorithm1.44.44.m1.1.2.cmml" xref="algorithm1.44.44.m1.1.2"><and id="algorithm1.44.44.m1.1.2a.cmml" xref="algorithm1.44.44.m1.1.2"></and><apply id="algorithm1.44.44.m1.1.2b.cmml" xref="algorithm1.44.44.m1.1.2"><in id="algorithm1.44.44.m1.1.2.3.cmml" xref="algorithm1.44.44.m1.1.2.3"></in><ci id="algorithm1.44.44.m1.1.2.2.cmml" xref="algorithm1.44.44.m1.1.2.2">𝑘</ci><apply id="algorithm1.44.44.m1.1.2.4.cmml" xref="algorithm1.44.44.m1.1.2.4"><times id="algorithm1.44.44.m1.1.2.4.1.cmml" xref="algorithm1.44.44.m1.1.2.4.1"></times><ci id="algorithm1.44.44.m1.1.2.4.2.cmml" xref="algorithm1.44.44.m1.1.2.4.2">𝑆</ci><ci id="algorithm1.44.44.m1.1.2.4.3.cmml" xref="algorithm1.44.44.m1.1.2.4.3">𝑡</ci></apply></apply><apply id="algorithm1.44.44.m1.1.2c.cmml" xref="algorithm1.44.44.m1.1.2"><ci id="algorithm1.44.44.m1.1.2.5.cmml" xref="algorithm1.44.44.m1.1.2.5">←</ci><share href="#algorithm1.44.44.m1.1.2.4.cmml" id="algorithm1.44.44.m1.1.2d.cmml" xref="algorithm1.44.44.m1.1.2"></share><apply id="algorithm1.44.44.m1.1.2.6.cmml" xref="algorithm1.44.44.m1.1.2.6"><csymbol cd="ambiguous" id="algorithm1.44.44.m1.1.2.6.1.cmml" xref="algorithm1.44.44.m1.1.2.6">superscript</csymbol><ci id="algorithm1.44.44.m1.1.2.6.2.cmml" xref="algorithm1.44.44.m1.1.2.6.2">𝑔</ci><apply id="algorithm1.44.44.m1.1.1.1.cmml" xref="algorithm1.44.44.m1.1.1.1"><times id="algorithm1.44.44.m1.1.1.1.2.cmml" xref="algorithm1.44.44.m1.1.1.1.2"></times><ci id="algorithm1.44.44.m1.1.1.1.3.cmml" xref="algorithm1.44.44.m1.1.1.1.3">𝑙</ci><apply id="algorithm1.44.44.m1.1.1.1.1.1.1.cmml" xref="algorithm1.44.44.m1.1.1.1.1.1"><plus id="algorithm1.44.44.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.44.44.m1.1.1.1.1.1.1.1"></plus><ci id="algorithm1.44.44.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.44.44.m1.1.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.44.44.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.44.44.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.44.44.m1.1c">k\in St\leftarrow g^{l(c+1)}</annotation></semantics></math> 
</div>
<div id="algorithm1.46.46" class="ltx_listingline">
   <math id="algorithm1.45.45.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.45.45.m1.1a"><mo id="algorithm1.45.45.m1.1.1" xref="algorithm1.45.45.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.45.45.m1.1b"><ci id="algorithm1.45.45.m1.1.1.cmml" xref="algorithm1.45.45.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.45.45.m1.1c">\triangleright</annotation></semantics></math> Server sends gradients at <math id="algorithm1.46.46.m2.1" class="ltx_Math" alttext="l(c+1)" display="inline"><semantics id="algorithm1.46.46.m2.1a"><mrow id="algorithm1.46.46.m2.1.1" xref="algorithm1.46.46.m2.1.1.cmml"><mi id="algorithm1.46.46.m2.1.1.3" xref="algorithm1.46.46.m2.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.46.46.m2.1.1.2" xref="algorithm1.46.46.m2.1.1.2.cmml">​</mo><mrow id="algorithm1.46.46.m2.1.1.1.1" xref="algorithm1.46.46.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.46.46.m2.1.1.1.1.2" xref="algorithm1.46.46.m2.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.46.46.m2.1.1.1.1.1" xref="algorithm1.46.46.m2.1.1.1.1.1.cmml"><mi id="algorithm1.46.46.m2.1.1.1.1.1.2" xref="algorithm1.46.46.m2.1.1.1.1.1.2.cmml">c</mi><mo id="algorithm1.46.46.m2.1.1.1.1.1.1" xref="algorithm1.46.46.m2.1.1.1.1.1.1.cmml">+</mo><mn id="algorithm1.46.46.m2.1.1.1.1.1.3" xref="algorithm1.46.46.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.46.46.m2.1.1.1.1.3" xref="algorithm1.46.46.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.46.46.m2.1b"><apply id="algorithm1.46.46.m2.1.1.cmml" xref="algorithm1.46.46.m2.1.1"><times id="algorithm1.46.46.m2.1.1.2.cmml" xref="algorithm1.46.46.m2.1.1.2"></times><ci id="algorithm1.46.46.m2.1.1.3.cmml" xref="algorithm1.46.46.m2.1.1.3">𝑙</ci><apply id="algorithm1.46.46.m2.1.1.1.1.1.cmml" xref="algorithm1.46.46.m2.1.1.1.1"><plus id="algorithm1.46.46.m2.1.1.1.1.1.1.cmml" xref="algorithm1.46.46.m2.1.1.1.1.1.1"></plus><ci id="algorithm1.46.46.m2.1.1.1.1.1.2.cmml" xref="algorithm1.46.46.m2.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.46.46.m2.1.1.1.1.1.3.cmml" xref="algorithm1.46.46.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.46.46.m2.1c">l(c+1)</annotation></semantics></math> to each local institution 
</div>
<div id="algorithm1.59.80" class="ltx_listingline">

</div>
<div id="algorithm1.47.47" class="ltx_listingline">   <math id="algorithm1.47.47.m1.3" class="ltx_Math" alttext="g^{l}\leftarrow{W_{k}^{l+1}}^{T}g^{l+1},\text{for}\text{\quad}l=lc,l(c-1),…,l1" display="inline"><semantics id="algorithm1.47.47.m1.3a"><mrow id="algorithm1.47.47.m1.3.3.2" xref="algorithm1.47.47.m1.3.3.3.cmml"><mrow id="algorithm1.47.47.m1.2.2.1.1" xref="algorithm1.47.47.m1.2.2.1.1.cmml"><msup id="algorithm1.47.47.m1.2.2.1.1.2" xref="algorithm1.47.47.m1.2.2.1.1.2.cmml"><mi id="algorithm1.47.47.m1.2.2.1.1.2.2" xref="algorithm1.47.47.m1.2.2.1.1.2.2.cmml">g</mi><mi id="algorithm1.47.47.m1.2.2.1.1.2.3" xref="algorithm1.47.47.m1.2.2.1.1.2.3.cmml">l</mi></msup><mo stretchy="false" id="algorithm1.47.47.m1.2.2.1.1.1" xref="algorithm1.47.47.m1.2.2.1.1.1.cmml">←</mo><mrow id="algorithm1.47.47.m1.2.2.1.1.3" xref="algorithm1.47.47.m1.2.2.1.1.3.cmml"><mmultiscripts id="algorithm1.47.47.m1.2.2.1.1.3.2" xref="algorithm1.47.47.m1.2.2.1.1.3.2.cmml"><mi id="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.2" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.2.cmml">W</mi><mi id="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.3" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.3.cmml">k</mi><mrow id="algorithm1.47.47.m1.2.2.1.1.3.2.2.3" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.cmml"><mi id="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.2" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.2.cmml">l</mi><mo id="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.1" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.1.cmml">+</mo><mn id="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.3" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mrow id="algorithm1.47.47.m1.2.2.1.1.3.2a" xref="algorithm1.47.47.m1.2.2.1.1.3.2.cmml"></mrow><mi id="algorithm1.47.47.m1.2.2.1.1.3.2.3" xref="algorithm1.47.47.m1.2.2.1.1.3.2.3.cmml">T</mi></mmultiscripts><mo lspace="0em" rspace="0em" id="algorithm1.47.47.m1.2.2.1.1.3.1" xref="algorithm1.47.47.m1.2.2.1.1.3.1.cmml">​</mo><msup id="algorithm1.47.47.m1.2.2.1.1.3.3" xref="algorithm1.47.47.m1.2.2.1.1.3.3.cmml"><mi id="algorithm1.47.47.m1.2.2.1.1.3.3.2" xref="algorithm1.47.47.m1.2.2.1.1.3.3.2.cmml">g</mi><mrow id="algorithm1.47.47.m1.2.2.1.1.3.3.3" xref="algorithm1.47.47.m1.2.2.1.1.3.3.3.cmml"><mi id="algorithm1.47.47.m1.2.2.1.1.3.3.3.2" xref="algorithm1.47.47.m1.2.2.1.1.3.3.3.2.cmml">l</mi><mo id="algorithm1.47.47.m1.2.2.1.1.3.3.3.1" xref="algorithm1.47.47.m1.2.2.1.1.3.3.3.1.cmml">+</mo><mn id="algorithm1.47.47.m1.2.2.1.1.3.3.3.3" xref="algorithm1.47.47.m1.2.2.1.1.3.3.3.3.cmml">1</mn></mrow></msup></mrow></mrow><mo id="algorithm1.47.47.m1.3.3.2.3" xref="algorithm1.47.47.m1.3.3.3a.cmml">,</mo><mrow id="algorithm1.47.47.m1.3.3.2.2" xref="algorithm1.47.47.m1.3.3.2.2.cmml"><mrow id="algorithm1.47.47.m1.3.3.2.2.5" xref="algorithm1.47.47.m1.3.3.2.2.5.cmml"><mrow id="algorithm1.47.47.m1.3.3.2.2.5.2" xref="algorithm1.47.47.m1.3.3.2.2.5.2c.cmml"><mtext id="algorithm1.47.47.m1.3.3.2.2.5.2a" xref="algorithm1.47.47.m1.3.3.2.2.5.2c.cmml">for</mtext><mtext id="algorithm1.47.47.m1.3.3.2.2.5.2b" xref="algorithm1.47.47.m1.3.3.2.2.5.2c.cmml"> </mtext></mrow><mo lspace="0em" rspace="0em" id="algorithm1.47.47.m1.3.3.2.2.5.1" xref="algorithm1.47.47.m1.3.3.2.2.5.1.cmml">​</mo><mi id="algorithm1.47.47.m1.3.3.2.2.5.3" xref="algorithm1.47.47.m1.3.3.2.2.5.3.cmml">l</mi></mrow><mo id="algorithm1.47.47.m1.3.3.2.2.4" xref="algorithm1.47.47.m1.3.3.2.2.4.cmml">=</mo><mrow id="algorithm1.47.47.m1.3.3.2.2.3.3" xref="algorithm1.47.47.m1.3.3.2.2.3.4.cmml"><mrow id="algorithm1.47.47.m1.3.3.2.2.1.1.1" xref="algorithm1.47.47.m1.3.3.2.2.1.1.1.cmml"><mi id="algorithm1.47.47.m1.3.3.2.2.1.1.1.2" xref="algorithm1.47.47.m1.3.3.2.2.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.47.47.m1.3.3.2.2.1.1.1.1" xref="algorithm1.47.47.m1.3.3.2.2.1.1.1.1.cmml">​</mo><mi id="algorithm1.47.47.m1.3.3.2.2.1.1.1.3" xref="algorithm1.47.47.m1.3.3.2.2.1.1.1.3.cmml">c</mi></mrow><mo id="algorithm1.47.47.m1.3.3.2.2.3.3.4" xref="algorithm1.47.47.m1.3.3.2.2.3.4.cmml">,</mo><mrow id="algorithm1.47.47.m1.3.3.2.2.2.2.2" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.cmml"><mi id="algorithm1.47.47.m1.3.3.2.2.2.2.2.3" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.47.47.m1.3.3.2.2.2.2.2.2" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.2.cmml">​</mo><mrow id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.2" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.2" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.2.cmml">c</mi><mo id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.1" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.1.cmml">−</mo><mn id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.3" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.3" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.47.47.m1.3.3.2.2.3.3.5" xref="algorithm1.47.47.m1.3.3.2.2.3.4.cmml">,</mo><mi mathvariant="normal" id="algorithm1.47.47.m1.1.1" xref="algorithm1.47.47.m1.1.1.cmml">…</mi><mo id="algorithm1.47.47.m1.3.3.2.2.3.3.6" xref="algorithm1.47.47.m1.3.3.2.2.3.4.cmml">,</mo><mrow id="algorithm1.47.47.m1.3.3.2.2.3.3.3" xref="algorithm1.47.47.m1.3.3.2.2.3.3.3.cmml"><mi id="algorithm1.47.47.m1.3.3.2.2.3.3.3.2" xref="algorithm1.47.47.m1.3.3.2.2.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.47.47.m1.3.3.2.2.3.3.3.1" xref="algorithm1.47.47.m1.3.3.2.2.3.3.3.1.cmml">​</mo><mn id="algorithm1.47.47.m1.3.3.2.2.3.3.3.3" xref="algorithm1.47.47.m1.3.3.2.2.3.3.3.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.47.47.m1.3b"><apply id="algorithm1.47.47.m1.3.3.3.cmml" xref="algorithm1.47.47.m1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.47.47.m1.3.3.3a.cmml" xref="algorithm1.47.47.m1.3.3.2.3">formulae-sequence</csymbol><apply id="algorithm1.47.47.m1.2.2.1.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1"><ci id="algorithm1.47.47.m1.2.2.1.1.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.1">←</ci><apply id="algorithm1.47.47.m1.2.2.1.1.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.47.47.m1.2.2.1.1.2.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.2">superscript</csymbol><ci id="algorithm1.47.47.m1.2.2.1.1.2.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.2.2">𝑔</ci><ci id="algorithm1.47.47.m1.2.2.1.1.2.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.2.3">𝑙</ci></apply><apply id="algorithm1.47.47.m1.2.2.1.1.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3"><times id="algorithm1.47.47.m1.2.2.1.1.3.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.1"></times><apply id="algorithm1.47.47.m1.2.2.1.1.3.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.47.47.m1.2.2.1.1.3.2.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2">superscript</csymbol><apply id="algorithm1.47.47.m1.2.2.1.1.3.2.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.47.47.m1.2.2.1.1.3.2.2.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2">superscript</csymbol><apply id="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2">subscript</csymbol><ci id="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.2">𝑊</ci><ci id="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.2.3">𝑘</ci></apply><apply id="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.3"><plus id="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.1"></plus><ci id="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.2">𝑙</ci><cn type="integer" id="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="algorithm1.47.47.m1.2.2.1.1.3.2.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.2.3">𝑇</ci></apply><apply id="algorithm1.47.47.m1.2.2.1.1.3.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.47.47.m1.2.2.1.1.3.3.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.3">superscript</csymbol><ci id="algorithm1.47.47.m1.2.2.1.1.3.3.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.3.2">𝑔</ci><apply id="algorithm1.47.47.m1.2.2.1.1.3.3.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.3.3"><plus id="algorithm1.47.47.m1.2.2.1.1.3.3.3.1.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.3.3.1"></plus><ci id="algorithm1.47.47.m1.2.2.1.1.3.3.3.2.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.3.3.2">𝑙</ci><cn type="integer" id="algorithm1.47.47.m1.2.2.1.1.3.3.3.3.cmml" xref="algorithm1.47.47.m1.2.2.1.1.3.3.3.3">1</cn></apply></apply></apply></apply><apply id="algorithm1.47.47.m1.3.3.2.2.cmml" xref="algorithm1.47.47.m1.3.3.2.2"><eq id="algorithm1.47.47.m1.3.3.2.2.4.cmml" xref="algorithm1.47.47.m1.3.3.2.2.4"></eq><apply id="algorithm1.47.47.m1.3.3.2.2.5.cmml" xref="algorithm1.47.47.m1.3.3.2.2.5"><times id="algorithm1.47.47.m1.3.3.2.2.5.1.cmml" xref="algorithm1.47.47.m1.3.3.2.2.5.1"></times><ci id="algorithm1.47.47.m1.3.3.2.2.5.2c.cmml" xref="algorithm1.47.47.m1.3.3.2.2.5.2"><mrow id="algorithm1.47.47.m1.3.3.2.2.5.2.cmml" xref="algorithm1.47.47.m1.3.3.2.2.5.2"><mtext id="algorithm1.47.47.m1.3.3.2.2.5.2a.cmml" xref="algorithm1.47.47.m1.3.3.2.2.5.2">for</mtext><mtext id="algorithm1.47.47.m1.3.3.2.2.5.2b.cmml" xref="algorithm1.47.47.m1.3.3.2.2.5.2"> </mtext></mrow></ci><ci id="algorithm1.47.47.m1.3.3.2.2.5.3.cmml" xref="algorithm1.47.47.m1.3.3.2.2.5.3">𝑙</ci></apply><list id="algorithm1.47.47.m1.3.3.2.2.3.4.cmml" xref="algorithm1.47.47.m1.3.3.2.2.3.3"><apply id="algorithm1.47.47.m1.3.3.2.2.1.1.1.cmml" xref="algorithm1.47.47.m1.3.3.2.2.1.1.1"><times id="algorithm1.47.47.m1.3.3.2.2.1.1.1.1.cmml" xref="algorithm1.47.47.m1.3.3.2.2.1.1.1.1"></times><ci id="algorithm1.47.47.m1.3.3.2.2.1.1.1.2.cmml" xref="algorithm1.47.47.m1.3.3.2.2.1.1.1.2">𝑙</ci><ci id="algorithm1.47.47.m1.3.3.2.2.1.1.1.3.cmml" xref="algorithm1.47.47.m1.3.3.2.2.1.1.1.3">𝑐</ci></apply><apply id="algorithm1.47.47.m1.3.3.2.2.2.2.2.cmml" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2"><times id="algorithm1.47.47.m1.3.3.2.2.2.2.2.2.cmml" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.2"></times><ci id="algorithm1.47.47.m1.3.3.2.2.2.2.2.3.cmml" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.3">𝑙</ci><apply id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.cmml" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1"><minus id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.1"></minus><ci id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.47.47.m1.3.3.2.2.2.2.2.1.1.1.3">1</cn></apply></apply><ci id="algorithm1.47.47.m1.1.1.cmml" xref="algorithm1.47.47.m1.1.1">…</ci><apply id="algorithm1.47.47.m1.3.3.2.2.3.3.3.cmml" xref="algorithm1.47.47.m1.3.3.2.2.3.3.3"><times id="algorithm1.47.47.m1.3.3.2.2.3.3.3.1.cmml" xref="algorithm1.47.47.m1.3.3.2.2.3.3.3.1"></times><ci id="algorithm1.47.47.m1.3.3.2.2.3.3.3.2.cmml" xref="algorithm1.47.47.m1.3.3.2.2.3.3.3.2">𝑙</ci><cn type="integer" id="algorithm1.47.47.m1.3.3.2.2.3.3.3.3.cmml" xref="algorithm1.47.47.m1.3.3.2.2.3.3.3.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.47.47.m1.3c">g^{l}\leftarrow{W_{k}^{l+1}}^{T}g^{l+1},\text{for}\text{\quad}l=lc,l(c-1),…,l1</annotation></semantics></math> 
</div>
<div id="algorithm1.49.49" class="ltx_listingline">
   <math id="algorithm1.48.48.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.48.48.m1.1a"><mo id="algorithm1.48.48.m1.1.1" xref="algorithm1.48.48.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.48.48.m1.1b"><ci id="algorithm1.48.48.m1.1.1.cmml" xref="algorithm1.48.48.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.48.48.m1.1c">\triangleright</annotation></semantics></math> Institution <math id="algorithm1.49.49.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.49.49.m2.1a"><mi id="algorithm1.49.49.m2.1.1" xref="algorithm1.49.49.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.49.49.m2.1b"><ci id="algorithm1.49.49.m2.1.1.cmml" xref="algorithm1.49.49.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.49.49.m2.1c">k</annotation></semantics></math> back propagates gradients 
</div>
<div id="algorithm1.59.81" class="ltx_listingline">

</div>
<div id="algorithm1.50.50" class="ltx_listingline">   <math id="algorithm1.50.50.m1.3" class="ltx_Math" alttext="W_{k}^{l}\leftarrow W_{k}^{l}-\eta g^{l},\text{for}\text{\quad}l=lc,l(c-1),…,l1" display="inline"><semantics id="algorithm1.50.50.m1.3a"><mrow id="algorithm1.50.50.m1.3.3.2" xref="algorithm1.50.50.m1.3.3.3.cmml"><mrow id="algorithm1.50.50.m1.2.2.1.1" xref="algorithm1.50.50.m1.2.2.1.1.cmml"><msubsup id="algorithm1.50.50.m1.2.2.1.1.2" xref="algorithm1.50.50.m1.2.2.1.1.2.cmml"><mi id="algorithm1.50.50.m1.2.2.1.1.2.2.2" xref="algorithm1.50.50.m1.2.2.1.1.2.2.2.cmml">W</mi><mi id="algorithm1.50.50.m1.2.2.1.1.2.2.3" xref="algorithm1.50.50.m1.2.2.1.1.2.2.3.cmml">k</mi><mi id="algorithm1.50.50.m1.2.2.1.1.2.3" xref="algorithm1.50.50.m1.2.2.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="algorithm1.50.50.m1.2.2.1.1.1" xref="algorithm1.50.50.m1.2.2.1.1.1.cmml">←</mo><mrow id="algorithm1.50.50.m1.2.2.1.1.3" xref="algorithm1.50.50.m1.2.2.1.1.3.cmml"><msubsup id="algorithm1.50.50.m1.2.2.1.1.3.2" xref="algorithm1.50.50.m1.2.2.1.1.3.2.cmml"><mi id="algorithm1.50.50.m1.2.2.1.1.3.2.2.2" xref="algorithm1.50.50.m1.2.2.1.1.3.2.2.2.cmml">W</mi><mi id="algorithm1.50.50.m1.2.2.1.1.3.2.2.3" xref="algorithm1.50.50.m1.2.2.1.1.3.2.2.3.cmml">k</mi><mi id="algorithm1.50.50.m1.2.2.1.1.3.2.3" xref="algorithm1.50.50.m1.2.2.1.1.3.2.3.cmml">l</mi></msubsup><mo id="algorithm1.50.50.m1.2.2.1.1.3.1" xref="algorithm1.50.50.m1.2.2.1.1.3.1.cmml">−</mo><mrow id="algorithm1.50.50.m1.2.2.1.1.3.3" xref="algorithm1.50.50.m1.2.2.1.1.3.3.cmml"><mi id="algorithm1.50.50.m1.2.2.1.1.3.3.2" xref="algorithm1.50.50.m1.2.2.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="algorithm1.50.50.m1.2.2.1.1.3.3.1" xref="algorithm1.50.50.m1.2.2.1.1.3.3.1.cmml">​</mo><msup id="algorithm1.50.50.m1.2.2.1.1.3.3.3" xref="algorithm1.50.50.m1.2.2.1.1.3.3.3.cmml"><mi id="algorithm1.50.50.m1.2.2.1.1.3.3.3.2" xref="algorithm1.50.50.m1.2.2.1.1.3.3.3.2.cmml">g</mi><mi id="algorithm1.50.50.m1.2.2.1.1.3.3.3.3" xref="algorithm1.50.50.m1.2.2.1.1.3.3.3.3.cmml">l</mi></msup></mrow></mrow></mrow><mo id="algorithm1.50.50.m1.3.3.2.3" xref="algorithm1.50.50.m1.3.3.3a.cmml">,</mo><mrow id="algorithm1.50.50.m1.3.3.2.2" xref="algorithm1.50.50.m1.3.3.2.2.cmml"><mrow id="algorithm1.50.50.m1.3.3.2.2.5" xref="algorithm1.50.50.m1.3.3.2.2.5.cmml"><mrow id="algorithm1.50.50.m1.3.3.2.2.5.2" xref="algorithm1.50.50.m1.3.3.2.2.5.2c.cmml"><mtext id="algorithm1.50.50.m1.3.3.2.2.5.2a" xref="algorithm1.50.50.m1.3.3.2.2.5.2c.cmml">for</mtext><mtext id="algorithm1.50.50.m1.3.3.2.2.5.2b" xref="algorithm1.50.50.m1.3.3.2.2.5.2c.cmml"> </mtext></mrow><mo lspace="0em" rspace="0em" id="algorithm1.50.50.m1.3.3.2.2.5.1" xref="algorithm1.50.50.m1.3.3.2.2.5.1.cmml">​</mo><mi id="algorithm1.50.50.m1.3.3.2.2.5.3" xref="algorithm1.50.50.m1.3.3.2.2.5.3.cmml">l</mi></mrow><mo id="algorithm1.50.50.m1.3.3.2.2.4" xref="algorithm1.50.50.m1.3.3.2.2.4.cmml">=</mo><mrow id="algorithm1.50.50.m1.3.3.2.2.3.3" xref="algorithm1.50.50.m1.3.3.2.2.3.4.cmml"><mrow id="algorithm1.50.50.m1.3.3.2.2.1.1.1" xref="algorithm1.50.50.m1.3.3.2.2.1.1.1.cmml"><mi id="algorithm1.50.50.m1.3.3.2.2.1.1.1.2" xref="algorithm1.50.50.m1.3.3.2.2.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.50.50.m1.3.3.2.2.1.1.1.1" xref="algorithm1.50.50.m1.3.3.2.2.1.1.1.1.cmml">​</mo><mi id="algorithm1.50.50.m1.3.3.2.2.1.1.1.3" xref="algorithm1.50.50.m1.3.3.2.2.1.1.1.3.cmml">c</mi></mrow><mo id="algorithm1.50.50.m1.3.3.2.2.3.3.4" xref="algorithm1.50.50.m1.3.3.2.2.3.4.cmml">,</mo><mrow id="algorithm1.50.50.m1.3.3.2.2.2.2.2" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.cmml"><mi id="algorithm1.50.50.m1.3.3.2.2.2.2.2.3" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.50.50.m1.3.3.2.2.2.2.2.2" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.2.cmml">​</mo><mrow id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.2" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.2" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.2.cmml">c</mi><mo id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.1" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.1.cmml">−</mo><mn id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.3" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.3" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.50.50.m1.3.3.2.2.3.3.5" xref="algorithm1.50.50.m1.3.3.2.2.3.4.cmml">,</mo><mi mathvariant="normal" id="algorithm1.50.50.m1.1.1" xref="algorithm1.50.50.m1.1.1.cmml">…</mi><mo id="algorithm1.50.50.m1.3.3.2.2.3.3.6" xref="algorithm1.50.50.m1.3.3.2.2.3.4.cmml">,</mo><mrow id="algorithm1.50.50.m1.3.3.2.2.3.3.3" xref="algorithm1.50.50.m1.3.3.2.2.3.3.3.cmml"><mi id="algorithm1.50.50.m1.3.3.2.2.3.3.3.2" xref="algorithm1.50.50.m1.3.3.2.2.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.50.50.m1.3.3.2.2.3.3.3.1" xref="algorithm1.50.50.m1.3.3.2.2.3.3.3.1.cmml">​</mo><mn id="algorithm1.50.50.m1.3.3.2.2.3.3.3.3" xref="algorithm1.50.50.m1.3.3.2.2.3.3.3.3.cmml">1</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.50.50.m1.3b"><apply id="algorithm1.50.50.m1.3.3.3.cmml" xref="algorithm1.50.50.m1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.50.50.m1.3.3.3a.cmml" xref="algorithm1.50.50.m1.3.3.2.3">formulae-sequence</csymbol><apply id="algorithm1.50.50.m1.2.2.1.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1"><ci id="algorithm1.50.50.m1.2.2.1.1.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1.1">←</ci><apply id="algorithm1.50.50.m1.2.2.1.1.2.cmml" xref="algorithm1.50.50.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.50.50.m1.2.2.1.1.2.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1.2">superscript</csymbol><apply id="algorithm1.50.50.m1.2.2.1.1.2.2.cmml" xref="algorithm1.50.50.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.50.50.m1.2.2.1.1.2.2.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1.2">subscript</csymbol><ci id="algorithm1.50.50.m1.2.2.1.1.2.2.2.cmml" xref="algorithm1.50.50.m1.2.2.1.1.2.2.2">𝑊</ci><ci id="algorithm1.50.50.m1.2.2.1.1.2.2.3.cmml" xref="algorithm1.50.50.m1.2.2.1.1.2.2.3">𝑘</ci></apply><ci id="algorithm1.50.50.m1.2.2.1.1.2.3.cmml" xref="algorithm1.50.50.m1.2.2.1.1.2.3">𝑙</ci></apply><apply id="algorithm1.50.50.m1.2.2.1.1.3.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3"><minus id="algorithm1.50.50.m1.2.2.1.1.3.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.1"></minus><apply id="algorithm1.50.50.m1.2.2.1.1.3.2.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.50.50.m1.2.2.1.1.3.2.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.2">superscript</csymbol><apply id="algorithm1.50.50.m1.2.2.1.1.3.2.2.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.50.50.m1.2.2.1.1.3.2.2.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.2">subscript</csymbol><ci id="algorithm1.50.50.m1.2.2.1.1.3.2.2.2.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.2.2.2">𝑊</ci><ci id="algorithm1.50.50.m1.2.2.1.1.3.2.2.3.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.2.2.3">𝑘</ci></apply><ci id="algorithm1.50.50.m1.2.2.1.1.3.2.3.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.2.3">𝑙</ci></apply><apply id="algorithm1.50.50.m1.2.2.1.1.3.3.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.3"><times id="algorithm1.50.50.m1.2.2.1.1.3.3.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.3.1"></times><ci id="algorithm1.50.50.m1.2.2.1.1.3.3.2.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.3.2">𝜂</ci><apply id="algorithm1.50.50.m1.2.2.1.1.3.3.3.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.50.50.m1.2.2.1.1.3.3.3.1.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.3.3">superscript</csymbol><ci id="algorithm1.50.50.m1.2.2.1.1.3.3.3.2.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.3.3.2">𝑔</ci><ci id="algorithm1.50.50.m1.2.2.1.1.3.3.3.3.cmml" xref="algorithm1.50.50.m1.2.2.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply><apply id="algorithm1.50.50.m1.3.3.2.2.cmml" xref="algorithm1.50.50.m1.3.3.2.2"><eq id="algorithm1.50.50.m1.3.3.2.2.4.cmml" xref="algorithm1.50.50.m1.3.3.2.2.4"></eq><apply id="algorithm1.50.50.m1.3.3.2.2.5.cmml" xref="algorithm1.50.50.m1.3.3.2.2.5"><times id="algorithm1.50.50.m1.3.3.2.2.5.1.cmml" xref="algorithm1.50.50.m1.3.3.2.2.5.1"></times><ci id="algorithm1.50.50.m1.3.3.2.2.5.2c.cmml" xref="algorithm1.50.50.m1.3.3.2.2.5.2"><mrow id="algorithm1.50.50.m1.3.3.2.2.5.2.cmml" xref="algorithm1.50.50.m1.3.3.2.2.5.2"><mtext id="algorithm1.50.50.m1.3.3.2.2.5.2a.cmml" xref="algorithm1.50.50.m1.3.3.2.2.5.2">for</mtext><mtext id="algorithm1.50.50.m1.3.3.2.2.5.2b.cmml" xref="algorithm1.50.50.m1.3.3.2.2.5.2"> </mtext></mrow></ci><ci id="algorithm1.50.50.m1.3.3.2.2.5.3.cmml" xref="algorithm1.50.50.m1.3.3.2.2.5.3">𝑙</ci></apply><list id="algorithm1.50.50.m1.3.3.2.2.3.4.cmml" xref="algorithm1.50.50.m1.3.3.2.2.3.3"><apply id="algorithm1.50.50.m1.3.3.2.2.1.1.1.cmml" xref="algorithm1.50.50.m1.3.3.2.2.1.1.1"><times id="algorithm1.50.50.m1.3.3.2.2.1.1.1.1.cmml" xref="algorithm1.50.50.m1.3.3.2.2.1.1.1.1"></times><ci id="algorithm1.50.50.m1.3.3.2.2.1.1.1.2.cmml" xref="algorithm1.50.50.m1.3.3.2.2.1.1.1.2">𝑙</ci><ci id="algorithm1.50.50.m1.3.3.2.2.1.1.1.3.cmml" xref="algorithm1.50.50.m1.3.3.2.2.1.1.1.3">𝑐</ci></apply><apply id="algorithm1.50.50.m1.3.3.2.2.2.2.2.cmml" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2"><times id="algorithm1.50.50.m1.3.3.2.2.2.2.2.2.cmml" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.2"></times><ci id="algorithm1.50.50.m1.3.3.2.2.2.2.2.3.cmml" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.3">𝑙</ci><apply id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.cmml" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1"><minus id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.1"></minus><ci id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.50.50.m1.3.3.2.2.2.2.2.1.1.1.3">1</cn></apply></apply><ci id="algorithm1.50.50.m1.1.1.cmml" xref="algorithm1.50.50.m1.1.1">…</ci><apply id="algorithm1.50.50.m1.3.3.2.2.3.3.3.cmml" xref="algorithm1.50.50.m1.3.3.2.2.3.3.3"><times id="algorithm1.50.50.m1.3.3.2.2.3.3.3.1.cmml" xref="algorithm1.50.50.m1.3.3.2.2.3.3.3.1"></times><ci id="algorithm1.50.50.m1.3.3.2.2.3.3.3.2.cmml" xref="algorithm1.50.50.m1.3.3.2.2.3.3.3.2">𝑙</ci><cn type="integer" id="algorithm1.50.50.m1.3.3.2.2.3.3.3.3.cmml" xref="algorithm1.50.50.m1.3.3.2.2.3.3.3.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.50.50.m1.3c">W_{k}^{l}\leftarrow W_{k}^{l}-\eta g^{l},\text{for}\text{\quad}l=lc,l(c-1),…,l1</annotation></semantics></math> 
</div>
<div id="algorithm1.53.53" class="ltx_listingline">
   <math id="algorithm1.51.51.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.51.51.m1.1a"><mo id="algorithm1.51.51.m1.1.1" xref="algorithm1.51.51.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.51.51.m1.1b"><ci id="algorithm1.51.51.m1.1.1.cmml" xref="algorithm1.51.51.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.51.51.m1.1c">\triangleright</annotation></semantics></math> Institution <math id="algorithm1.52.52.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.52.52.m2.1a"><mi id="algorithm1.52.52.m2.1.1" xref="algorithm1.52.52.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.52.52.m2.1b"><ci id="algorithm1.52.52.m2.1.1.cmml" xref="algorithm1.52.52.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.52.52.m2.1c">k</annotation></semantics></math> updates <math id="algorithm1.53.53.m3.1" class="ltx_Math" alttext="FI" display="inline"><semantics id="algorithm1.53.53.m3.1a"><mrow id="algorithm1.53.53.m3.1.1" xref="algorithm1.53.53.m3.1.1.cmml"><mi id="algorithm1.53.53.m3.1.1.2" xref="algorithm1.53.53.m3.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.53.53.m3.1.1.1" xref="algorithm1.53.53.m3.1.1.1.cmml">​</mo><mi id="algorithm1.53.53.m3.1.1.3" xref="algorithm1.53.53.m3.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.53.53.m3.1b"><apply id="algorithm1.53.53.m3.1.1.cmml" xref="algorithm1.53.53.m3.1.1"><times id="algorithm1.53.53.m3.1.1.1.cmml" xref="algorithm1.53.53.m3.1.1.1"></times><ci id="algorithm1.53.53.m3.1.1.2.cmml" xref="algorithm1.53.53.m3.1.1.2">𝐹</ci><ci id="algorithm1.53.53.m3.1.1.3.cmml" xref="algorithm1.53.53.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.53.53.m3.1c">FI</annotation></semantics></math>

</div>
<div id="algorithm1.54.54" class="ltx_listingline">   <math id="algorithm1.54.54.m1.3" class="ltx_Math" alttext="W_{S}^{l}\leftarrow W_{S}^{l}-\eta g^{l},\text{for}\text{\quad}l=lN,l(N-1),…,l(c+1)" display="inline"><semantics id="algorithm1.54.54.m1.3a"><mrow id="algorithm1.54.54.m1.3.3.2" xref="algorithm1.54.54.m1.3.3.3.cmml"><mrow id="algorithm1.54.54.m1.2.2.1.1" xref="algorithm1.54.54.m1.2.2.1.1.cmml"><msubsup id="algorithm1.54.54.m1.2.2.1.1.2" xref="algorithm1.54.54.m1.2.2.1.1.2.cmml"><mi id="algorithm1.54.54.m1.2.2.1.1.2.2.2" xref="algorithm1.54.54.m1.2.2.1.1.2.2.2.cmml">W</mi><mi id="algorithm1.54.54.m1.2.2.1.1.2.2.3" xref="algorithm1.54.54.m1.2.2.1.1.2.2.3.cmml">S</mi><mi id="algorithm1.54.54.m1.2.2.1.1.2.3" xref="algorithm1.54.54.m1.2.2.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="algorithm1.54.54.m1.2.2.1.1.1" xref="algorithm1.54.54.m1.2.2.1.1.1.cmml">←</mo><mrow id="algorithm1.54.54.m1.2.2.1.1.3" xref="algorithm1.54.54.m1.2.2.1.1.3.cmml"><msubsup id="algorithm1.54.54.m1.2.2.1.1.3.2" xref="algorithm1.54.54.m1.2.2.1.1.3.2.cmml"><mi id="algorithm1.54.54.m1.2.2.1.1.3.2.2.2" xref="algorithm1.54.54.m1.2.2.1.1.3.2.2.2.cmml">W</mi><mi id="algorithm1.54.54.m1.2.2.1.1.3.2.2.3" xref="algorithm1.54.54.m1.2.2.1.1.3.2.2.3.cmml">S</mi><mi id="algorithm1.54.54.m1.2.2.1.1.3.2.3" xref="algorithm1.54.54.m1.2.2.1.1.3.2.3.cmml">l</mi></msubsup><mo id="algorithm1.54.54.m1.2.2.1.1.3.1" xref="algorithm1.54.54.m1.2.2.1.1.3.1.cmml">−</mo><mrow id="algorithm1.54.54.m1.2.2.1.1.3.3" xref="algorithm1.54.54.m1.2.2.1.1.3.3.cmml"><mi id="algorithm1.54.54.m1.2.2.1.1.3.3.2" xref="algorithm1.54.54.m1.2.2.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="algorithm1.54.54.m1.2.2.1.1.3.3.1" xref="algorithm1.54.54.m1.2.2.1.1.3.3.1.cmml">​</mo><msup id="algorithm1.54.54.m1.2.2.1.1.3.3.3" xref="algorithm1.54.54.m1.2.2.1.1.3.3.3.cmml"><mi id="algorithm1.54.54.m1.2.2.1.1.3.3.3.2" xref="algorithm1.54.54.m1.2.2.1.1.3.3.3.2.cmml">g</mi><mi id="algorithm1.54.54.m1.2.2.1.1.3.3.3.3" xref="algorithm1.54.54.m1.2.2.1.1.3.3.3.3.cmml">l</mi></msup></mrow></mrow></mrow><mo id="algorithm1.54.54.m1.3.3.2.3" xref="algorithm1.54.54.m1.3.3.3a.cmml">,</mo><mrow id="algorithm1.54.54.m1.3.3.2.2" xref="algorithm1.54.54.m1.3.3.2.2.cmml"><mrow id="algorithm1.54.54.m1.3.3.2.2.5" xref="algorithm1.54.54.m1.3.3.2.2.5.cmml"><mrow id="algorithm1.54.54.m1.3.3.2.2.5.2" xref="algorithm1.54.54.m1.3.3.2.2.5.2c.cmml"><mtext id="algorithm1.54.54.m1.3.3.2.2.5.2a" xref="algorithm1.54.54.m1.3.3.2.2.5.2c.cmml">for</mtext><mtext id="algorithm1.54.54.m1.3.3.2.2.5.2b" xref="algorithm1.54.54.m1.3.3.2.2.5.2c.cmml"> </mtext></mrow><mo lspace="0em" rspace="0em" id="algorithm1.54.54.m1.3.3.2.2.5.1" xref="algorithm1.54.54.m1.3.3.2.2.5.1.cmml">​</mo><mi id="algorithm1.54.54.m1.3.3.2.2.5.3" xref="algorithm1.54.54.m1.3.3.2.2.5.3.cmml">l</mi></mrow><mo id="algorithm1.54.54.m1.3.3.2.2.4" xref="algorithm1.54.54.m1.3.3.2.2.4.cmml">=</mo><mrow id="algorithm1.54.54.m1.3.3.2.2.3.3" xref="algorithm1.54.54.m1.3.3.2.2.3.4.cmml"><mrow id="algorithm1.54.54.m1.3.3.2.2.1.1.1" xref="algorithm1.54.54.m1.3.3.2.2.1.1.1.cmml"><mi id="algorithm1.54.54.m1.3.3.2.2.1.1.1.2" xref="algorithm1.54.54.m1.3.3.2.2.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.54.54.m1.3.3.2.2.1.1.1.1" xref="algorithm1.54.54.m1.3.3.2.2.1.1.1.1.cmml">​</mo><mi id="algorithm1.54.54.m1.3.3.2.2.1.1.1.3" xref="algorithm1.54.54.m1.3.3.2.2.1.1.1.3.cmml">N</mi></mrow><mo id="algorithm1.54.54.m1.3.3.2.2.3.3.4" xref="algorithm1.54.54.m1.3.3.2.2.3.4.cmml">,</mo><mrow id="algorithm1.54.54.m1.3.3.2.2.2.2.2" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.cmml"><mi id="algorithm1.54.54.m1.3.3.2.2.2.2.2.3" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.54.54.m1.3.3.2.2.2.2.2.2" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.2.cmml">​</mo><mrow id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.2" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.cmml"><mi id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.2" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.2.cmml">N</mi><mo id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.1" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.1.cmml">−</mo><mn id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.3" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.3" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.54.54.m1.3.3.2.2.3.3.5" xref="algorithm1.54.54.m1.3.3.2.2.3.4.cmml">,</mo><mi mathvariant="normal" id="algorithm1.54.54.m1.1.1" xref="algorithm1.54.54.m1.1.1.cmml">…</mi><mo id="algorithm1.54.54.m1.3.3.2.2.3.3.6" xref="algorithm1.54.54.m1.3.3.2.2.3.4.cmml">,</mo><mrow id="algorithm1.54.54.m1.3.3.2.2.3.3.3" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.cmml"><mi id="algorithm1.54.54.m1.3.3.2.2.3.3.3.3" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.54.54.m1.3.3.2.2.3.3.3.2" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.2.cmml">​</mo><mrow id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.cmml"><mo stretchy="false" id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.2" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.cmml">(</mo><mrow id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.cmml"><mi id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.2" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.2.cmml">c</mi><mo id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.1" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.1.cmml">+</mo><mn id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.3" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.3" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.54.54.m1.3b"><apply id="algorithm1.54.54.m1.3.3.3.cmml" xref="algorithm1.54.54.m1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.54.54.m1.3.3.3a.cmml" xref="algorithm1.54.54.m1.3.3.2.3">formulae-sequence</csymbol><apply id="algorithm1.54.54.m1.2.2.1.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1"><ci id="algorithm1.54.54.m1.2.2.1.1.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1.1">←</ci><apply id="algorithm1.54.54.m1.2.2.1.1.2.cmml" xref="algorithm1.54.54.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.54.54.m1.2.2.1.1.2.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1.2">superscript</csymbol><apply id="algorithm1.54.54.m1.2.2.1.1.2.2.cmml" xref="algorithm1.54.54.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="algorithm1.54.54.m1.2.2.1.1.2.2.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1.2">subscript</csymbol><ci id="algorithm1.54.54.m1.2.2.1.1.2.2.2.cmml" xref="algorithm1.54.54.m1.2.2.1.1.2.2.2">𝑊</ci><ci id="algorithm1.54.54.m1.2.2.1.1.2.2.3.cmml" xref="algorithm1.54.54.m1.2.2.1.1.2.2.3">𝑆</ci></apply><ci id="algorithm1.54.54.m1.2.2.1.1.2.3.cmml" xref="algorithm1.54.54.m1.2.2.1.1.2.3">𝑙</ci></apply><apply id="algorithm1.54.54.m1.2.2.1.1.3.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3"><minus id="algorithm1.54.54.m1.2.2.1.1.3.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.1"></minus><apply id="algorithm1.54.54.m1.2.2.1.1.3.2.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.54.54.m1.2.2.1.1.3.2.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.2">superscript</csymbol><apply id="algorithm1.54.54.m1.2.2.1.1.3.2.2.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="algorithm1.54.54.m1.2.2.1.1.3.2.2.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.2">subscript</csymbol><ci id="algorithm1.54.54.m1.2.2.1.1.3.2.2.2.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.2.2.2">𝑊</ci><ci id="algorithm1.54.54.m1.2.2.1.1.3.2.2.3.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.2.2.3">𝑆</ci></apply><ci id="algorithm1.54.54.m1.2.2.1.1.3.2.3.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.2.3">𝑙</ci></apply><apply id="algorithm1.54.54.m1.2.2.1.1.3.3.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.3"><times id="algorithm1.54.54.m1.2.2.1.1.3.3.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.3.1"></times><ci id="algorithm1.54.54.m1.2.2.1.1.3.3.2.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.3.2">𝜂</ci><apply id="algorithm1.54.54.m1.2.2.1.1.3.3.3.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.54.54.m1.2.2.1.1.3.3.3.1.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.3.3">superscript</csymbol><ci id="algorithm1.54.54.m1.2.2.1.1.3.3.3.2.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.3.3.2">𝑔</ci><ci id="algorithm1.54.54.m1.2.2.1.1.3.3.3.3.cmml" xref="algorithm1.54.54.m1.2.2.1.1.3.3.3.3">𝑙</ci></apply></apply></apply></apply><apply id="algorithm1.54.54.m1.3.3.2.2.cmml" xref="algorithm1.54.54.m1.3.3.2.2"><eq id="algorithm1.54.54.m1.3.3.2.2.4.cmml" xref="algorithm1.54.54.m1.3.3.2.2.4"></eq><apply id="algorithm1.54.54.m1.3.3.2.2.5.cmml" xref="algorithm1.54.54.m1.3.3.2.2.5"><times id="algorithm1.54.54.m1.3.3.2.2.5.1.cmml" xref="algorithm1.54.54.m1.3.3.2.2.5.1"></times><ci id="algorithm1.54.54.m1.3.3.2.2.5.2c.cmml" xref="algorithm1.54.54.m1.3.3.2.2.5.2"><mrow id="algorithm1.54.54.m1.3.3.2.2.5.2.cmml" xref="algorithm1.54.54.m1.3.3.2.2.5.2"><mtext id="algorithm1.54.54.m1.3.3.2.2.5.2a.cmml" xref="algorithm1.54.54.m1.3.3.2.2.5.2">for</mtext><mtext id="algorithm1.54.54.m1.3.3.2.2.5.2b.cmml" xref="algorithm1.54.54.m1.3.3.2.2.5.2"> </mtext></mrow></ci><ci id="algorithm1.54.54.m1.3.3.2.2.5.3.cmml" xref="algorithm1.54.54.m1.3.3.2.2.5.3">𝑙</ci></apply><list id="algorithm1.54.54.m1.3.3.2.2.3.4.cmml" xref="algorithm1.54.54.m1.3.3.2.2.3.3"><apply id="algorithm1.54.54.m1.3.3.2.2.1.1.1.cmml" xref="algorithm1.54.54.m1.3.3.2.2.1.1.1"><times id="algorithm1.54.54.m1.3.3.2.2.1.1.1.1.cmml" xref="algorithm1.54.54.m1.3.3.2.2.1.1.1.1"></times><ci id="algorithm1.54.54.m1.3.3.2.2.1.1.1.2.cmml" xref="algorithm1.54.54.m1.3.3.2.2.1.1.1.2">𝑙</ci><ci id="algorithm1.54.54.m1.3.3.2.2.1.1.1.3.cmml" xref="algorithm1.54.54.m1.3.3.2.2.1.1.1.3">𝑁</ci></apply><apply id="algorithm1.54.54.m1.3.3.2.2.2.2.2.cmml" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2"><times id="algorithm1.54.54.m1.3.3.2.2.2.2.2.2.cmml" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.2"></times><ci id="algorithm1.54.54.m1.3.3.2.2.2.2.2.3.cmml" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.3">𝑙</ci><apply id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.cmml" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1"><minus id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.1.cmml" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.1"></minus><ci id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.2.cmml" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.2">𝑁</ci><cn type="integer" id="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.3.cmml" xref="algorithm1.54.54.m1.3.3.2.2.2.2.2.1.1.1.3">1</cn></apply></apply><ci id="algorithm1.54.54.m1.1.1.cmml" xref="algorithm1.54.54.m1.1.1">…</ci><apply id="algorithm1.54.54.m1.3.3.2.2.3.3.3.cmml" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3"><times id="algorithm1.54.54.m1.3.3.2.2.3.3.3.2.cmml" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.2"></times><ci id="algorithm1.54.54.m1.3.3.2.2.3.3.3.3.cmml" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.3">𝑙</ci><apply id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.cmml" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1"><plus id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.1.cmml" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.1"></plus><ci id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.2.cmml" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.2">𝑐</ci><cn type="integer" id="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.3.cmml" xref="algorithm1.54.54.m1.3.3.2.2.3.3.3.1.1.1.3">1</cn></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.54.54.m1.3c">W_{S}^{l}\leftarrow W_{S}^{l}-\eta g^{l},\text{for}\text{\quad}l=lN,l(N-1),…,l(c+1)</annotation></semantics></math> 
</div>
<div id="algorithm1.56.56" class="ltx_listingline">
   <math id="algorithm1.55.55.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.55.55.m1.1a"><mo id="algorithm1.55.55.m1.1.1" xref="algorithm1.55.55.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.55.55.m1.1b"><ci id="algorithm1.55.55.m1.1.1.cmml" xref="algorithm1.55.55.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.55.55.m1.1c">\triangleright</annotation></semantics></math> Server updates <math id="algorithm1.56.56.m2.1" class="ltx_Math" alttext="FS" display="inline"><semantics id="algorithm1.56.56.m2.1a"><mrow id="algorithm1.56.56.m2.1.1" xref="algorithm1.56.56.m2.1.1.cmml"><mi id="algorithm1.56.56.m2.1.1.2" xref="algorithm1.56.56.m2.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.56.56.m2.1.1.1" xref="algorithm1.56.56.m2.1.1.1.cmml">​</mo><mi id="algorithm1.56.56.m2.1.1.3" xref="algorithm1.56.56.m2.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.56.56.m2.1b"><apply id="algorithm1.56.56.m2.1.1.cmml" xref="algorithm1.56.56.m2.1.1"><times id="algorithm1.56.56.m2.1.1.1.cmml" xref="algorithm1.56.56.m2.1.1.1"></times><ci id="algorithm1.56.56.m2.1.1.2.cmml" xref="algorithm1.56.56.m2.1.1.2">𝐹</ci><ci id="algorithm1.56.56.m2.1.1.3.cmml" xref="algorithm1.56.56.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.56.56.m2.1c">FS</annotation></semantics></math>

</div>
<div id="algorithm1.59.82" class="ltx_listingline"> <span id="algorithm1.59.82.1" class="ltx_text ltx_font_bold">Weight Transfer</span> 
</div>
<div id="algorithm1.57.57" class="ltx_listingline">
 Institution <math id="algorithm1.57.57.m1.4" class="ltx_Math" alttext="k\in{1,…,K}\leftarrow W_{S}" display="inline"><semantics id="algorithm1.57.57.m1.4a"><mrow id="algorithm1.57.57.m1.4.4.2" xref="algorithm1.57.57.m1.4.4.3.cmml"><mrow id="algorithm1.57.57.m1.3.3.1.1" xref="algorithm1.57.57.m1.3.3.1.1.cmml"><mi id="algorithm1.57.57.m1.3.3.1.1.2" xref="algorithm1.57.57.m1.3.3.1.1.2.cmml">k</mi><mo id="algorithm1.57.57.m1.3.3.1.1.1" xref="algorithm1.57.57.m1.3.3.1.1.1.cmml">∈</mo><mrow id="algorithm1.57.57.m1.3.3.1.1.3.2" xref="algorithm1.57.57.m1.3.3.1.1.3.1.cmml"><mn id="algorithm1.57.57.m1.1.1" xref="algorithm1.57.57.m1.1.1.cmml">1</mn><mo id="algorithm1.57.57.m1.3.3.1.1.3.2.1" xref="algorithm1.57.57.m1.3.3.1.1.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.57.57.m1.2.2" xref="algorithm1.57.57.m1.2.2.cmml">…</mi></mrow></mrow><mo id="algorithm1.57.57.m1.4.4.2.3" xref="algorithm1.57.57.m1.4.4.3a.cmml">,</mo><mrow id="algorithm1.57.57.m1.4.4.2.2" xref="algorithm1.57.57.m1.4.4.2.2.cmml"><mi id="algorithm1.57.57.m1.4.4.2.2.2" xref="algorithm1.57.57.m1.4.4.2.2.2.cmml">K</mi><mo stretchy="false" id="algorithm1.57.57.m1.4.4.2.2.1" xref="algorithm1.57.57.m1.4.4.2.2.1.cmml">←</mo><msub id="algorithm1.57.57.m1.4.4.2.2.3" xref="algorithm1.57.57.m1.4.4.2.2.3.cmml"><mi id="algorithm1.57.57.m1.4.4.2.2.3.2" xref="algorithm1.57.57.m1.4.4.2.2.3.2.cmml">W</mi><mi id="algorithm1.57.57.m1.4.4.2.2.3.3" xref="algorithm1.57.57.m1.4.4.2.2.3.3.cmml">S</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.57.57.m1.4b"><apply id="algorithm1.57.57.m1.4.4.3.cmml" xref="algorithm1.57.57.m1.4.4.2"><csymbol cd="ambiguous" id="algorithm1.57.57.m1.4.4.3a.cmml" xref="algorithm1.57.57.m1.4.4.2.3">formulae-sequence</csymbol><apply id="algorithm1.57.57.m1.3.3.1.1.cmml" xref="algorithm1.57.57.m1.3.3.1.1"><in id="algorithm1.57.57.m1.3.3.1.1.1.cmml" xref="algorithm1.57.57.m1.3.3.1.1.1"></in><ci id="algorithm1.57.57.m1.3.3.1.1.2.cmml" xref="algorithm1.57.57.m1.3.3.1.1.2">𝑘</ci><list id="algorithm1.57.57.m1.3.3.1.1.3.1.cmml" xref="algorithm1.57.57.m1.3.3.1.1.3.2"><cn type="integer" id="algorithm1.57.57.m1.1.1.cmml" xref="algorithm1.57.57.m1.1.1">1</cn><ci id="algorithm1.57.57.m1.2.2.cmml" xref="algorithm1.57.57.m1.2.2">…</ci></list></apply><apply id="algorithm1.57.57.m1.4.4.2.2.cmml" xref="algorithm1.57.57.m1.4.4.2.2"><ci id="algorithm1.57.57.m1.4.4.2.2.1.cmml" xref="algorithm1.57.57.m1.4.4.2.2.1">←</ci><ci id="algorithm1.57.57.m1.4.4.2.2.2.cmml" xref="algorithm1.57.57.m1.4.4.2.2.2">𝐾</ci><apply id="algorithm1.57.57.m1.4.4.2.2.3.cmml" xref="algorithm1.57.57.m1.4.4.2.2.3"><csymbol cd="ambiguous" id="algorithm1.57.57.m1.4.4.2.2.3.1.cmml" xref="algorithm1.57.57.m1.4.4.2.2.3">subscript</csymbol><ci id="algorithm1.57.57.m1.4.4.2.2.3.2.cmml" xref="algorithm1.57.57.m1.4.4.2.2.3.2">𝑊</ci><ci id="algorithm1.57.57.m1.4.4.2.2.3.3.cmml" xref="algorithm1.57.57.m1.4.4.2.2.3.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.57.57.m1.4c">k\in{1,…,K}\leftarrow W_{S}</annotation></semantics></math> 
</div>
<div id="algorithm1.59.59" class="ltx_listingline">
 <math id="algorithm1.58.58.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="algorithm1.58.58.m1.1a"><mo id="algorithm1.58.58.m1.1.1" xref="algorithm1.58.58.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="algorithm1.58.58.m1.1b"><ci id="algorithm1.58.58.m1.1.1.cmml" xref="algorithm1.58.58.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.58.58.m1.1c">\triangleright</annotation></semantics></math> Server sends <math id="algorithm1.59.59.m2.1" class="ltx_Math" alttext="FS" display="inline"><semantics id="algorithm1.59.59.m2.1a"><mrow id="algorithm1.59.59.m2.1.1" xref="algorithm1.59.59.m2.1.1.cmml"><mi id="algorithm1.59.59.m2.1.1.2" xref="algorithm1.59.59.m2.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="algorithm1.59.59.m2.1.1.1" xref="algorithm1.59.59.m2.1.1.1.cmml">​</mo><mi id="algorithm1.59.59.m2.1.1.3" xref="algorithm1.59.59.m2.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.59.59.m2.1b"><apply id="algorithm1.59.59.m2.1.1.cmml" xref="algorithm1.59.59.m2.1.1"><times id="algorithm1.59.59.m2.1.1.1.cmml" xref="algorithm1.59.59.m2.1.1.1"></times><ci id="algorithm1.59.59.m2.1.1.2.cmml" xref="algorithm1.59.59.m2.1.1.2">𝐹</ci><ci id="algorithm1.59.59.m2.1.1.3.cmml" xref="algorithm1.59.59.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.59.59.m2.1c">FS</annotation></semantics></math> to complete institution models

</div>
<div id="algorithm1.59.83" class="ltx_listingline">
<span id="algorithm1.59.83.1" class="ltx_text"></span>


</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.81.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>SplitAVG. The <math id="algorithm1.70.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm1.70.m1.1b"><mi id="algorithm1.70.m1.1.1" xref="algorithm1.70.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.70.m1.1c"><ci id="algorithm1.70.m1.1.1.cmml" xref="algorithm1.70.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.70.m1.1d">K</annotation></semantics></math> institutions are indexed by <math id="algorithm1.71.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.71.m2.1b"><mi id="algorithm1.71.m2.1.1" xref="algorithm1.71.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.71.m2.1c"><ci id="algorithm1.71.m2.1.1.cmml" xref="algorithm1.71.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.71.m2.1d">k</annotation></semantics></math>; <math id="algorithm1.72.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm1.72.m3.1b"><mi id="algorithm1.72.m3.1.1" xref="algorithm1.72.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm1.72.m3.1c"><ci id="algorithm1.72.m3.1.1.cmml" xref="algorithm1.72.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.72.m3.1d">E</annotation></semantics></math> is the number of training epochs; <math id="algorithm1.73.m4.2" class="ltx_Math" alttext="\{x_{k},y_{k}\}" display="inline"><semantics id="algorithm1.73.m4.2b"><mrow id="algorithm1.73.m4.2.2.2" xref="algorithm1.73.m4.2.2.3.cmml"><mo stretchy="false" id="algorithm1.73.m4.2.2.2.3" xref="algorithm1.73.m4.2.2.3.cmml">{</mo><msub id="algorithm1.73.m4.1.1.1.1" xref="algorithm1.73.m4.1.1.1.1.cmml"><mi id="algorithm1.73.m4.1.1.1.1.2" xref="algorithm1.73.m4.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.73.m4.1.1.1.1.3" xref="algorithm1.73.m4.1.1.1.1.3.cmml">k</mi></msub><mo id="algorithm1.73.m4.2.2.2.4" xref="algorithm1.73.m4.2.2.3.cmml">,</mo><msub id="algorithm1.73.m4.2.2.2.2" xref="algorithm1.73.m4.2.2.2.2.cmml"><mi id="algorithm1.73.m4.2.2.2.2.2" xref="algorithm1.73.m4.2.2.2.2.2.cmml">y</mi><mi id="algorithm1.73.m4.2.2.2.2.3" xref="algorithm1.73.m4.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm1.73.m4.2.2.2.5" xref="algorithm1.73.m4.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.73.m4.2c"><set id="algorithm1.73.m4.2.2.3.cmml" xref="algorithm1.73.m4.2.2.2"><apply id="algorithm1.73.m4.1.1.1.1.cmml" xref="algorithm1.73.m4.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.73.m4.1.1.1.1.1.cmml" xref="algorithm1.73.m4.1.1.1.1">subscript</csymbol><ci id="algorithm1.73.m4.1.1.1.1.2.cmml" xref="algorithm1.73.m4.1.1.1.1.2">𝑥</ci><ci id="algorithm1.73.m4.1.1.1.1.3.cmml" xref="algorithm1.73.m4.1.1.1.1.3">𝑘</ci></apply><apply id="algorithm1.73.m4.2.2.2.2.cmml" xref="algorithm1.73.m4.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.73.m4.2.2.2.2.1.cmml" xref="algorithm1.73.m4.2.2.2.2">subscript</csymbol><ci id="algorithm1.73.m4.2.2.2.2.2.cmml" xref="algorithm1.73.m4.2.2.2.2.2">𝑦</ci><ci id="algorithm1.73.m4.2.2.2.2.3.cmml" xref="algorithm1.73.m4.2.2.2.2.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.73.m4.2d">\{x_{k},y_{k}\}</annotation></semantics></math> is the data at institution <math id="algorithm1.74.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algorithm1.74.m5.1b"><mi id="algorithm1.74.m5.1.1" xref="algorithm1.74.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algorithm1.74.m5.1c"><ci id="algorithm1.74.m5.1.1.cmml" xref="algorithm1.74.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.74.m5.1d">k</annotation></semantics></math>; <math id="algorithm1.75.m6.6" class="ltx_Math" alttext="F=\{l1,l2,…,lc,...,lN\}" display="inline"><semantics id="algorithm1.75.m6.6b"><mrow id="algorithm1.75.m6.6.6" xref="algorithm1.75.m6.6.6.cmml"><mi id="algorithm1.75.m6.6.6.6" xref="algorithm1.75.m6.6.6.6.cmml">F</mi><mo id="algorithm1.75.m6.6.6.5" xref="algorithm1.75.m6.6.6.5.cmml">=</mo><mrow id="algorithm1.75.m6.6.6.4.4" xref="algorithm1.75.m6.6.6.4.5.cmml"><mo stretchy="false" id="algorithm1.75.m6.6.6.4.4.5" xref="algorithm1.75.m6.6.6.4.5.cmml">{</mo><mrow id="algorithm1.75.m6.3.3.1.1.1" xref="algorithm1.75.m6.3.3.1.1.1.cmml"><mi id="algorithm1.75.m6.3.3.1.1.1.2" xref="algorithm1.75.m6.3.3.1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.75.m6.3.3.1.1.1.1" xref="algorithm1.75.m6.3.3.1.1.1.1.cmml">​</mo><mn id="algorithm1.75.m6.3.3.1.1.1.3" xref="algorithm1.75.m6.3.3.1.1.1.3.cmml">1</mn></mrow><mo id="algorithm1.75.m6.6.6.4.4.6" xref="algorithm1.75.m6.6.6.4.5.cmml">,</mo><mrow id="algorithm1.75.m6.4.4.2.2.2" xref="algorithm1.75.m6.4.4.2.2.2.cmml"><mi id="algorithm1.75.m6.4.4.2.2.2.2" xref="algorithm1.75.m6.4.4.2.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.75.m6.4.4.2.2.2.1" xref="algorithm1.75.m6.4.4.2.2.2.1.cmml">​</mo><mn id="algorithm1.75.m6.4.4.2.2.2.3" xref="algorithm1.75.m6.4.4.2.2.2.3.cmml">2</mn></mrow><mo id="algorithm1.75.m6.6.6.4.4.7" xref="algorithm1.75.m6.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="algorithm1.75.m6.1.1" xref="algorithm1.75.m6.1.1.cmml">…</mi><mo id="algorithm1.75.m6.6.6.4.4.8" xref="algorithm1.75.m6.6.6.4.5.cmml">,</mo><mrow id="algorithm1.75.m6.5.5.3.3.3" xref="algorithm1.75.m6.5.5.3.3.3.cmml"><mi id="algorithm1.75.m6.5.5.3.3.3.2" xref="algorithm1.75.m6.5.5.3.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.75.m6.5.5.3.3.3.1" xref="algorithm1.75.m6.5.5.3.3.3.1.cmml">​</mo><mi id="algorithm1.75.m6.5.5.3.3.3.3" xref="algorithm1.75.m6.5.5.3.3.3.3.cmml">c</mi></mrow><mo id="algorithm1.75.m6.6.6.4.4.9" xref="algorithm1.75.m6.6.6.4.5.cmml">,</mo><mi mathvariant="normal" id="algorithm1.75.m6.2.2" xref="algorithm1.75.m6.2.2.cmml">…</mi><mo id="algorithm1.75.m6.6.6.4.4.10" xref="algorithm1.75.m6.6.6.4.5.cmml">,</mo><mrow id="algorithm1.75.m6.6.6.4.4.4" xref="algorithm1.75.m6.6.6.4.4.4.cmml"><mi id="algorithm1.75.m6.6.6.4.4.4.2" xref="algorithm1.75.m6.6.6.4.4.4.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.75.m6.6.6.4.4.4.1" xref="algorithm1.75.m6.6.6.4.4.4.1.cmml">​</mo><mi id="algorithm1.75.m6.6.6.4.4.4.3" xref="algorithm1.75.m6.6.6.4.4.4.3.cmml">N</mi></mrow><mo stretchy="false" id="algorithm1.75.m6.6.6.4.4.11" xref="algorithm1.75.m6.6.6.4.5.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.75.m6.6c"><apply id="algorithm1.75.m6.6.6.cmml" xref="algorithm1.75.m6.6.6"><eq id="algorithm1.75.m6.6.6.5.cmml" xref="algorithm1.75.m6.6.6.5"></eq><ci id="algorithm1.75.m6.6.6.6.cmml" xref="algorithm1.75.m6.6.6.6">𝐹</ci><set id="algorithm1.75.m6.6.6.4.5.cmml" xref="algorithm1.75.m6.6.6.4.4"><apply id="algorithm1.75.m6.3.3.1.1.1.cmml" xref="algorithm1.75.m6.3.3.1.1.1"><times id="algorithm1.75.m6.3.3.1.1.1.1.cmml" xref="algorithm1.75.m6.3.3.1.1.1.1"></times><ci id="algorithm1.75.m6.3.3.1.1.1.2.cmml" xref="algorithm1.75.m6.3.3.1.1.1.2">𝑙</ci><cn type="integer" id="algorithm1.75.m6.3.3.1.1.1.3.cmml" xref="algorithm1.75.m6.3.3.1.1.1.3">1</cn></apply><apply id="algorithm1.75.m6.4.4.2.2.2.cmml" xref="algorithm1.75.m6.4.4.2.2.2"><times id="algorithm1.75.m6.4.4.2.2.2.1.cmml" xref="algorithm1.75.m6.4.4.2.2.2.1"></times><ci id="algorithm1.75.m6.4.4.2.2.2.2.cmml" xref="algorithm1.75.m6.4.4.2.2.2.2">𝑙</ci><cn type="integer" id="algorithm1.75.m6.4.4.2.2.2.3.cmml" xref="algorithm1.75.m6.4.4.2.2.2.3">2</cn></apply><ci id="algorithm1.75.m6.1.1.cmml" xref="algorithm1.75.m6.1.1">…</ci><apply id="algorithm1.75.m6.5.5.3.3.3.cmml" xref="algorithm1.75.m6.5.5.3.3.3"><times id="algorithm1.75.m6.5.5.3.3.3.1.cmml" xref="algorithm1.75.m6.5.5.3.3.3.1"></times><ci id="algorithm1.75.m6.5.5.3.3.3.2.cmml" xref="algorithm1.75.m6.5.5.3.3.3.2">𝑙</ci><ci id="algorithm1.75.m6.5.5.3.3.3.3.cmml" xref="algorithm1.75.m6.5.5.3.3.3.3">𝑐</ci></apply><ci id="algorithm1.75.m6.2.2.cmml" xref="algorithm1.75.m6.2.2">…</ci><apply id="algorithm1.75.m6.6.6.4.4.4.cmml" xref="algorithm1.75.m6.6.6.4.4.4"><times id="algorithm1.75.m6.6.6.4.4.4.1.cmml" xref="algorithm1.75.m6.6.6.4.4.4.1"></times><ci id="algorithm1.75.m6.6.6.4.4.4.2.cmml" xref="algorithm1.75.m6.6.6.4.4.4.2">𝑙</ci><ci id="algorithm1.75.m6.6.6.4.4.4.3.cmml" xref="algorithm1.75.m6.6.6.4.4.4.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.75.m6.6d">F=\{l1,l2,…,lc,...,lN\}</annotation></semantics></math> is the network function, and <math id="algorithm1.76.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="algorithm1.76.m7.1b"><mi id="algorithm1.76.m7.1.1" xref="algorithm1.76.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="algorithm1.76.m7.1c"><ci id="algorithm1.76.m7.1.1.cmml" xref="algorithm1.76.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.76.m7.1d">l</annotation></semantics></math> is a layer in <math id="algorithm1.77.m8.1" class="ltx_Math" alttext="F" display="inline"><semantics id="algorithm1.77.m8.1b"><mi id="algorithm1.77.m8.1.1" xref="algorithm1.77.m8.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="algorithm1.77.m8.1c"><ci id="algorithm1.77.m8.1.1.cmml" xref="algorithm1.77.m8.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.77.m8.1d">F</annotation></semantics></math>. <math id="algorithm1.78.m9.1" class="ltx_Math" alttext="lc" display="inline"><semantics id="algorithm1.78.m9.1b"><mrow id="algorithm1.78.m9.1.1" xref="algorithm1.78.m9.1.1.cmml"><mi id="algorithm1.78.m9.1.1.2" xref="algorithm1.78.m9.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="algorithm1.78.m9.1.1.1" xref="algorithm1.78.m9.1.1.1.cmml">​</mo><mi id="algorithm1.78.m9.1.1.3" xref="algorithm1.78.m9.1.1.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.78.m9.1c"><apply id="algorithm1.78.m9.1.1.cmml" xref="algorithm1.78.m9.1.1"><times id="algorithm1.78.m9.1.1.1.cmml" xref="algorithm1.78.m9.1.1.1"></times><ci id="algorithm1.78.m9.1.1.2.cmml" xref="algorithm1.78.m9.1.1.2">𝑙</ci><ci id="algorithm1.78.m9.1.1.3.cmml" xref="algorithm1.78.m9.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.78.m9.1d">lc</annotation></semantics></math> is the cut layer. <math id="algorithm1.79.m10.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="algorithm1.79.m10.1b"><mi id="algorithm1.79.m10.1.1" xref="algorithm1.79.m10.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="algorithm1.79.m10.1c"><ci id="algorithm1.79.m10.1.1.cmml" xref="algorithm1.79.m10.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.79.m10.1d">\eta</annotation></semantics></math> is the learning rate.</figcaption>
</figure>
<section id="S2.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Forward Propagation</h4>

<div id="S2.SS1.SSS1.p1" class="ltx_para">
<p id="S2.SS1.SSS1.p1.12" class="ltx_p">Let’s assume there are total <math id="S2.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS1.SSS1.p1.1.m1.1a"><mi id="S2.SS1.SSS1.p1.1.m1.1.1" xref="S2.SS1.SSS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.1.m1.1b"><ci id="S2.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.1.m1.1c">K</annotation></semantics></math> local institutions involved in federated learning, indexed by <math id="S2.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.SSS1.p1.2.m2.1a"><mi id="S2.SS1.SSS1.p1.2.m2.1.1" xref="S2.SS1.SSS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.2.m2.1b"><ci id="S2.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.2.m2.1c">k</annotation></semantics></math>, and denote the training data of institution <math id="S2.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.SSS1.p1.3.m3.1a"><mi id="S2.SS1.SSS1.p1.3.m3.1.1" xref="S2.SS1.SSS1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.3.m3.1b"><ci id="S2.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.3.m3.1c">k</annotation></semantics></math> as <math id="S2.SS1.SSS1.p1.4.m4.2" class="ltx_Math" alttext="\{\boldsymbol{x_{k}},\boldsymbol{y_{k}}\}" display="inline"><semantics id="S2.SS1.SSS1.p1.4.m4.2a"><mrow id="S2.SS1.SSS1.p1.4.m4.2.2.2" xref="S2.SS1.SSS1.p1.4.m4.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.4.m4.2.2.2.3" xref="S2.SS1.SSS1.p1.4.m4.2.2.3.cmml">{</mo><msub id="S2.SS1.SSS1.p1.4.m4.1.1.1.1" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.4.m4.1.1.1.1.2" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.1.2.cmml">𝒙</mi><mi id="S2.SS1.SSS1.p1.4.m4.1.1.1.1.3" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.1.3.cmml">𝒌</mi></msub><mo id="S2.SS1.SSS1.p1.4.m4.2.2.2.4" xref="S2.SS1.SSS1.p1.4.m4.2.2.3.cmml">,</mo><msub id="S2.SS1.SSS1.p1.4.m4.2.2.2.2" xref="S2.SS1.SSS1.p1.4.m4.2.2.2.2.cmml"><mi id="S2.SS1.SSS1.p1.4.m4.2.2.2.2.2" xref="S2.SS1.SSS1.p1.4.m4.2.2.2.2.2.cmml">𝒚</mi><mi id="S2.SS1.SSS1.p1.4.m4.2.2.2.2.3" xref="S2.SS1.SSS1.p1.4.m4.2.2.2.2.3.cmml">𝒌</mi></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.4.m4.2.2.2.5" xref="S2.SS1.SSS1.p1.4.m4.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.4.m4.2b"><set id="S2.SS1.SSS1.p1.4.m4.2.2.3.cmml" xref="S2.SS1.SSS1.p1.4.m4.2.2.2"><apply id="S2.SS1.SSS1.p1.4.m4.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.4.m4.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.4.m4.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.1.2">𝒙</ci><ci id="S2.SS1.SSS1.p1.4.m4.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.4.m4.1.1.1.1.3">𝒌</ci></apply><apply id="S2.SS1.SSS1.p1.4.m4.2.2.2.2.cmml" xref="S2.SS1.SSS1.p1.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.4.m4.2.2.2.2.1.cmml" xref="S2.SS1.SSS1.p1.4.m4.2.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS1.p1.4.m4.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p1.4.m4.2.2.2.2.2">𝒚</ci><ci id="S2.SS1.SSS1.p1.4.m4.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p1.4.m4.2.2.2.2.3">𝒌</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.4.m4.2c">\{\boldsymbol{x_{k}},\boldsymbol{y_{k}}\}</annotation></semantics></math>. In SplitAVG, we select a subset of <math id="S2.SS1.SSS1.p1.5.m5.1" class="ltx_Math" alttext="St\ll K" display="inline"><semantics id="S2.SS1.SSS1.p1.5.m5.1a"><mrow id="S2.SS1.SSS1.p1.5.m5.1.1" xref="S2.SS1.SSS1.p1.5.m5.1.1.cmml"><mrow id="S2.SS1.SSS1.p1.5.m5.1.1.2" xref="S2.SS1.SSS1.p1.5.m5.1.1.2.cmml"><mi id="S2.SS1.SSS1.p1.5.m5.1.1.2.2" xref="S2.SS1.SSS1.p1.5.m5.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.5.m5.1.1.2.1" xref="S2.SS1.SSS1.p1.5.m5.1.1.2.1.cmml">​</mo><mi id="S2.SS1.SSS1.p1.5.m5.1.1.2.3" xref="S2.SS1.SSS1.p1.5.m5.1.1.2.3.cmml">t</mi></mrow><mo id="S2.SS1.SSS1.p1.5.m5.1.1.1" xref="S2.SS1.SSS1.p1.5.m5.1.1.1.cmml">≪</mo><mi id="S2.SS1.SSS1.p1.5.m5.1.1.3" xref="S2.SS1.SSS1.p1.5.m5.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.5.m5.1b"><apply id="S2.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1"><csymbol cd="latexml" id="S2.SS1.SSS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.1">much-less-than</csymbol><apply id="S2.SS1.SSS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.2"><times id="S2.SS1.SSS1.p1.5.m5.1.1.2.1.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.2.1"></times><ci id="S2.SS1.SSS1.p1.5.m5.1.1.2.2.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.2.2">𝑆</ci><ci id="S2.SS1.SSS1.p1.5.m5.1.1.2.3.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.2.3">𝑡</ci></apply><ci id="S2.SS1.SSS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.SSS1.p1.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.5.m5.1c">St\ll K</annotation></semantics></math> local institutions following the client-selecting methods in FedAvg  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, and then start the following forward propagation steps: 1) apply standard forward propagation on institutional sub-network <math id="S2.SS1.SSS1.p1.6.m6.1" class="ltx_Math" alttext="FI" display="inline"><semantics id="S2.SS1.SSS1.p1.6.m6.1a"><mrow id="S2.SS1.SSS1.p1.6.m6.1.1" xref="S2.SS1.SSS1.p1.6.m6.1.1.cmml"><mi id="S2.SS1.SSS1.p1.6.m6.1.1.2" xref="S2.SS1.SSS1.p1.6.m6.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.6.m6.1.1.1" xref="S2.SS1.SSS1.p1.6.m6.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS1.p1.6.m6.1.1.3" xref="S2.SS1.SSS1.p1.6.m6.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.6.m6.1b"><apply id="S2.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1"><times id="S2.SS1.SSS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.1"></times><ci id="S2.SS1.SSS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.2">𝐹</ci><ci id="S2.SS1.SSS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.SSS1.p1.6.m6.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.6.m6.1c">FI</annotation></semantics></math> with sampled min-batch <math id="S2.SS1.SSS1.p1.7.m7.2" class="ltx_Math" alttext="\{x_{k},y_{k}\}" display="inline"><semantics id="S2.SS1.SSS1.p1.7.m7.2a"><mrow id="S2.SS1.SSS1.p1.7.m7.2.2.2" xref="S2.SS1.SSS1.p1.7.m7.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.7.m7.2.2.2.3" xref="S2.SS1.SSS1.p1.7.m7.2.2.3.cmml">{</mo><msub id="S2.SS1.SSS1.p1.7.m7.1.1.1.1" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.7.m7.1.1.1.1.2" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.SSS1.p1.7.m7.1.1.1.1.3" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.SSS1.p1.7.m7.2.2.2.4" xref="S2.SS1.SSS1.p1.7.m7.2.2.3.cmml">,</mo><msub id="S2.SS1.SSS1.p1.7.m7.2.2.2.2" xref="S2.SS1.SSS1.p1.7.m7.2.2.2.2.cmml"><mi id="S2.SS1.SSS1.p1.7.m7.2.2.2.2.2" xref="S2.SS1.SSS1.p1.7.m7.2.2.2.2.2.cmml">y</mi><mi id="S2.SS1.SSS1.p1.7.m7.2.2.2.2.3" xref="S2.SS1.SSS1.p1.7.m7.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.7.m7.2.2.2.5" xref="S2.SS1.SSS1.p1.7.m7.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.7.m7.2b"><set id="S2.SS1.SSS1.p1.7.m7.2.2.3.cmml" xref="S2.SS1.SSS1.p1.7.m7.2.2.2"><apply id="S2.SS1.SSS1.p1.7.m7.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.7.m7.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.7.m7.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.SSS1.p1.7.m7.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.7.m7.1.1.1.1.3">𝑘</ci></apply><apply id="S2.SS1.SSS1.p1.7.m7.2.2.2.2.cmml" xref="S2.SS1.SSS1.p1.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.7.m7.2.2.2.2.1.cmml" xref="S2.SS1.SSS1.p1.7.m7.2.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS1.p1.7.m7.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p1.7.m7.2.2.2.2.2">𝑦</ci><ci id="S2.SS1.SSS1.p1.7.m7.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p1.7.m7.2.2.2.2.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.7.m7.2c">\{x_{k},y_{k}\}</annotation></semantics></math> in each selected local institution, getting intermediate feature maps <math id="S2.SS1.SSS1.p1.8.m8.1" class="ltx_Math" alttext="FI(x_{k})" display="inline"><semantics id="S2.SS1.SSS1.p1.8.m8.1a"><mrow id="S2.SS1.SSS1.p1.8.m8.1.1" xref="S2.SS1.SSS1.p1.8.m8.1.1.cmml"><mi id="S2.SS1.SSS1.p1.8.m8.1.1.3" xref="S2.SS1.SSS1.p1.8.m8.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.8.m8.1.1.2" xref="S2.SS1.SSS1.p1.8.m8.1.1.2.cmml">​</mo><mi id="S2.SS1.SSS1.p1.8.m8.1.1.4" xref="S2.SS1.SSS1.p1.8.m8.1.1.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.8.m8.1.1.2a" xref="S2.SS1.SSS1.p1.8.m8.1.1.2.cmml">​</mo><mrow id="S2.SS1.SSS1.p1.8.m8.1.1.1.1" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.2" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.3" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.8.m8.1b"><apply id="S2.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1"><times id="S2.SS1.SSS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.2"></times><ci id="S2.SS1.SSS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.3">𝐹</ci><ci id="S2.SS1.SSS1.p1.8.m8.1.1.4.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.4">𝐼</ci><apply id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.8.m8.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.8.m8.1c">FI(x_{k})</annotation></semantics></math>; 2) send the intermediate feature maps and their corresponding labels <math id="S2.SS1.SSS1.p1.9.m9.2" class="ltx_Math" alttext="\{FI(x_{k}),y_{k}\}" display="inline"><semantics id="S2.SS1.SSS1.p1.9.m9.2a"><mrow id="S2.SS1.SSS1.p1.9.m9.2.2.2" xref="S2.SS1.SSS1.p1.9.m9.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.9.m9.2.2.2.3" xref="S2.SS1.SSS1.p1.9.m9.2.2.3.cmml">{</mo><mrow id="S2.SS1.SSS1.p1.9.m9.1.1.1.1" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.3" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.2" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.2.cmml">​</mo><mi id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.4" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.2a" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.SSS1.p1.9.m9.2.2.2.4" xref="S2.SS1.SSS1.p1.9.m9.2.2.3.cmml">,</mo><msub id="S2.SS1.SSS1.p1.9.m9.2.2.2.2" xref="S2.SS1.SSS1.p1.9.m9.2.2.2.2.cmml"><mi id="S2.SS1.SSS1.p1.9.m9.2.2.2.2.2" xref="S2.SS1.SSS1.p1.9.m9.2.2.2.2.2.cmml">y</mi><mi id="S2.SS1.SSS1.p1.9.m9.2.2.2.2.3" xref="S2.SS1.SSS1.p1.9.m9.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.9.m9.2.2.2.5" xref="S2.SS1.SSS1.p1.9.m9.2.2.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.9.m9.2b"><set id="S2.SS1.SSS1.p1.9.m9.2.2.3.cmml" xref="S2.SS1.SSS1.p1.9.m9.2.2.2"><apply id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1"><times id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.2"></times><ci id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.3">𝐹</ci><ci id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.4.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.4">𝐼</ci><apply id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.9.m9.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply><apply id="S2.SS1.SSS1.p1.9.m9.2.2.2.2.cmml" xref="S2.SS1.SSS1.p1.9.m9.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.9.m9.2.2.2.2.1.cmml" xref="S2.SS1.SSS1.p1.9.m9.2.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS1.p1.9.m9.2.2.2.2.2.cmml" xref="S2.SS1.SSS1.p1.9.m9.2.2.2.2.2">𝑦</ci><ci id="S2.SS1.SSS1.p1.9.m9.2.2.2.2.3.cmml" xref="S2.SS1.SSS1.p1.9.m9.2.2.2.2.3">𝑘</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.9.m9.2c">\{FI(x_{k}),y_{k}\}</annotation></semantics></math> to the central server; 3) concatenate the received feature maps <math id="S2.SS1.SSS1.p1.10.m10.1" class="ltx_Math" alttext="X_{S}^{lc}=\{FI_{1}(x_{1})\oplus{FI}_{2}(x_{2})...\oplus{FI}_{St}(x_{St})\}" display="inline"><semantics id="S2.SS1.SSS1.p1.10.m10.1a"><mrow id="S2.SS1.SSS1.p1.10.m10.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.cmml"><msubsup id="S2.SS1.SSS1.p1.10.m10.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.3.2.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.2.2.cmml">X</mi><mi id="S2.SS1.SSS1.p1.10.m10.1.1.3.2.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.2.3.cmml">S</mi><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.3.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.3.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.3.3.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.3.3.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p1.10.m10.1.1.3.3.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.3.3.cmml">c</mi></mrow></msubsup><mo id="S2.SS1.SSS1.p1.10.m10.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.2.cmml">=</mo><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.cmml"><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2.cmml">​</mo><msub id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.2.cmml">I</mi><mn id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2a" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.4" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.4.cmml">⊕</mo><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.2.cmml">​</mo><msub id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.2.cmml">I</mi><mn id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.2a" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.2.cmml">x</mi><mn id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.2b" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.2.cmml">​</mo><mi mathvariant="normal" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.5" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.5.cmml">…</mi></mrow><mo id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.4a" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.4.cmml">⊕</mo><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.2.cmml">​</mo><msub id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.2.cmml">I</mi><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.3.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.2a" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.2.cmml">​</mo><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.cmml">(</mo><msub id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.2.cmml">x</mi><mrow id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.2" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.1" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.3.cmml">t</mi></mrow></msub><mo stretchy="false" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.3" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.10.m10.1b"><apply id="S2.SS1.SSS1.p1.10.m10.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1"><eq id="S2.SS1.SSS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.2"></eq><apply id="S2.SS1.SSS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3">superscript</csymbol><apply id="S2.SS1.SSS1.p1.10.m10.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.3.2.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.10.m10.1.1.3.2.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.2.2">𝑋</ci><ci id="S2.SS1.SSS1.p1.10.m10.1.1.3.2.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.2.3">𝑆</ci></apply><apply id="S2.SS1.SSS1.p1.10.m10.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.3"><times id="S2.SS1.SSS1.p1.10.m10.1.1.3.3.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.3.1"></times><ci id="S2.SS1.SSS1.p1.10.m10.1.1.3.3.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.3.2">𝑙</ci><ci id="S2.SS1.SSS1.p1.10.m10.1.1.3.3.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.3.3.3">𝑐</ci></apply></apply><set id="S2.SS1.SSS1.p1.10.m10.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1"><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.4.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.4">direct-sum</csymbol><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1"><times id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.2"></times><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.3">𝐹</ci><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.2">𝐼</ci><cn type="integer" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.4.3">1</cn></apply><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.2">𝑥</ci><cn type="integer" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2"><times id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.2"></times><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.3">𝐹</ci><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4">subscript</csymbol><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.2">𝐼</ci><cn type="integer" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.4.3">2</cn></apply><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.2">𝑥</ci><cn type="integer" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.1.1.1.3">2</cn></apply><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.5.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.2.5">…</ci></apply><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3"><times id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.2"></times><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.3">𝐹</ci><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4">subscript</csymbol><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.2">𝐼</ci><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3"><times id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.1"></times><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.2">𝑆</ci><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.4.3.3">𝑡</ci></apply></apply><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.2">𝑥</ci><apply id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3"><times id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.2">𝑆</ci><ci id="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.10.m10.1.1.1.1.1.3.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.10.m10.1c">X_{S}^{lc}=\{FI_{1}(x_{1})\oplus{FI}_{2}(x_{2})...\oplus{FI}_{St}(x_{St})\}</annotation></semantics></math> and their corresponding labels <math id="S2.SS1.SSS1.p1.11.m11.1" class="ltx_Math" alttext="Y_{S}=\{y_{1}\oplus y_{2}...\oplus y_{St}\}" display="inline"><semantics id="S2.SS1.SSS1.p1.11.m11.1a"><mrow id="S2.SS1.SSS1.p1.11.m11.1.1" xref="S2.SS1.SSS1.p1.11.m11.1.1.cmml"><msub id="S2.SS1.SSS1.p1.11.m11.1.1.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.11.m11.1.1.3.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.3.2.cmml">Y</mi><mi id="S2.SS1.SSS1.p1.11.m11.1.1.3.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.3.3.cmml">S</mi></msub><mo id="S2.SS1.SSS1.p1.11.m11.1.1.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.2.cmml">=</mo><mrow id="S2.SS1.SSS1.p1.11.m11.1.1.1.1" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.2.cmml">{</mo><mrow id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.cmml"><msub id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.cmml"><mi id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.2.cmml">y</mi><mn id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.1" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.1.cmml">⊕</mo><mrow id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.cmml"><msub id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.cmml"><mi id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.2.cmml">y</mi><mn id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.1" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.3.cmml">…</mi></mrow><mo id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.1a" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.1.cmml">⊕</mo><msub id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.cmml"><mi id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.2.cmml">y</mi><mrow id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.cmml"><mi id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.2" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.1" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.3.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.3" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.11.m11.1b"><apply id="S2.SS1.SSS1.p1.11.m11.1.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1"><eq id="S2.SS1.SSS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.2"></eq><apply id="S2.SS1.SSS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.11.m11.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.11.m11.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.3.2">𝑌</ci><ci id="S2.SS1.SSS1.p1.11.m11.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.3.3">𝑆</ci></apply><set id="S2.SS1.SSS1.p1.11.m11.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1"><apply id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.1">direct-sum</csymbol><apply id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.2">𝑦</ci><cn type="integer" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.2.3">1</cn></apply><apply id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3"><times id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.1"></times><apply id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.2">𝑦</ci><cn type="integer" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.2.3">2</cn></apply><ci id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.3.3">…</ci></apply><apply id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.2">𝑦</ci><apply id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3"><times id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.1.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.1"></times><ci id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.2.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.2">𝑆</ci><ci id="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.3.cmml" xref="S2.SS1.SSS1.p1.11.m11.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.11.m11.1c">Y_{S}=\{y_{1}\oplus y_{2}...\oplus y_{St}\}</annotation></semantics></math> at the central server; and finally 4) forward propagate the combined feature maps into the server-based sub-network <math id="S2.SS1.SSS1.p1.12.m12.1" class="ltx_Math" alttext="FS(X_{S}^{lc})" display="inline"><semantics id="S2.SS1.SSS1.p1.12.m12.1a"><mrow id="S2.SS1.SSS1.p1.12.m12.1.1" xref="S2.SS1.SSS1.p1.12.m12.1.1.cmml"><mi id="S2.SS1.SSS1.p1.12.m12.1.1.3" xref="S2.SS1.SSS1.p1.12.m12.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.12.m12.1.1.2" xref="S2.SS1.SSS1.p1.12.m12.1.1.2.cmml">​</mo><mi id="S2.SS1.SSS1.p1.12.m12.1.1.4" xref="S2.SS1.SSS1.p1.12.m12.1.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.12.m12.1.1.2a" xref="S2.SS1.SSS1.p1.12.m12.1.1.2.cmml">​</mo><mrow id="S2.SS1.SSS1.p1.12.m12.1.1.1.1" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.2" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.cmml">(</mo><msubsup id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.2" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.2.cmml">X</mi><mi id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.3" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.3.cmml">S</mi><mrow id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.2" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.1" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.3" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.3.cmml">c</mi></mrow></msubsup><mo stretchy="false" id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.3" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.12.m12.1b"><apply id="S2.SS1.SSS1.p1.12.m12.1.1.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1"><times id="S2.SS1.SSS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.2"></times><ci id="S2.SS1.SSS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.3">𝐹</ci><ci id="S2.SS1.SSS1.p1.12.m12.1.1.4.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.4">𝑆</ci><apply id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1">superscript</csymbol><apply id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.1.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.2.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.2">𝑋</ci><ci id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.3.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.2.3">𝑆</ci></apply><apply id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3"><times id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.1"></times><ci id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.2">𝑙</ci><ci id="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.3.cmml" xref="S2.SS1.SSS1.p1.12.m12.1.1.1.1.1.3.3">𝑐</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.12.m12.1c">FS(X_{S}^{lc})</annotation></semantics></math>. This will complete a round of forward propagation without sharing the raw data. Unlike traditional federated learning methods, such as FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, that directly average the model weights learned from institutional specific data distribution, where the synchronized averaged central model will lose accuracy or even completely diverge when high heterogeneity exists in the data partitions across sites<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, our concatenation of feature maps on the central server guarantees that the server-based sub-network is trained on the union of all the institutional data and not from biased institution-data, thus it works well on both IID and non-IID data partitions.</p>
</div>
</section>
<section id="S2.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>Back Propagation</h4>

<div id="S2.SS1.SSS2.p1" class="ltx_para">
<p id="S2.SS1.SSS2.p1.11" class="ltx_p">After a round of forward propagation, SplitAVG back propagates the gradients from the last layer of the server-based sub-network to the first layer of the institutional sub-network <math id="S2.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="FI" display="inline"><semantics id="S2.SS1.SSS2.p1.1.m1.1a"><mrow id="S2.SS1.SSS2.p1.1.m1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.1.m1.1.1.2" xref="S2.SS1.SSS2.p1.1.m1.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.1.m1.1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.1.m1.1.1.3" xref="S2.SS1.SSS2.p1.1.m1.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.1.m1.1b"><apply id="S2.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1"><times id="S2.SS1.SSS2.p1.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.1"></times><ci id="S2.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.2">𝐹</ci><ci id="S2.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.1.m1.1c">FI</annotation></semantics></math>. Given the loss function <math id="S2.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S2.SS1.SSS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS2.p1.2.m2.1.1" xref="S2.SS1.SSS2.p1.2.m2.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.2.m2.1b"><ci id="S2.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.2.m2.1c">\mathcal{L}</annotation></semantics></math>, the detailed back propagation of SplitAVG is shown as the following: 1) calculate the gradients <math id="S2.SS1.SSS2.p1.3.m3.2" class="ltx_Math" alttext="g^{lN}=\bigtriangledown\mathcal{L}(Y_{S},{FS}(X_{S}^{lc}))" display="inline"><semantics id="S2.SS1.SSS2.p1.3.m3.2a"><mrow id="S2.SS1.SSS2.p1.3.m3.2.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.cmml"><msup id="S2.SS1.SSS2.p1.3.m3.2.2.4" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.cmml"><mi id="S2.SS1.SSS2.p1.3.m3.2.2.4.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.2.cmml">g</mi><mrow id="S2.SS1.SSS2.p1.3.m3.2.2.4.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.3.cmml"><mi id="S2.SS1.SSS2.p1.3.m3.2.2.4.3.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.3.m3.2.2.4.3.1" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.3.m3.2.2.4.3.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.3.3.cmml">N</mi></mrow></msup><mo rspace="0.1389em" id="S2.SS1.SSS2.p1.3.m3.2.2.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S2.SS1.SSS2.p1.3.m3.2.2.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.cmml"><mo lspace="0.1389em" rspace="0em" id="S2.SS1.SSS2.p1.3.m3.2.2.2a" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.cmml">▽</mo><mrow id="S2.SS1.SSS2.p1.3.m3.2.2.2.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.4" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.3.cmml">​</mo><mrow id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.3.cmml">(</mo><msub id="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">Y</mi><mi id="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.3.cmml">S</mi></msub><mo id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.4" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.3.cmml">,</mo><mrow id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.cmml"><mi id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.2.cmml">​</mo><mi id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.4" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.2a" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.2.cmml">​</mo><mrow id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.2.cmml">X</mi><mi id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.3.cmml">S</mi><mrow id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.2" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.1" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.3.cmml">c</mi></mrow></msubsup><mo stretchy="false" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.3" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.5" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.3.m3.2b"><apply id="S2.SS1.SSS2.p1.3.m3.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2"><eq id="S2.SS1.SSS2.p1.3.m3.2.2.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.3"></eq><apply id="S2.SS1.SSS2.p1.3.m3.2.2.4.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.3.m3.2.2.4.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.4">superscript</csymbol><ci id="S2.SS1.SSS2.p1.3.m3.2.2.4.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.2">𝑔</ci><apply id="S2.SS1.SSS2.p1.3.m3.2.2.4.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.3"><times id="S2.SS1.SSS2.p1.3.m3.2.2.4.3.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.3.1"></times><ci id="S2.SS1.SSS2.p1.3.m3.2.2.4.3.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.3.2">𝑙</ci><ci id="S2.SS1.SSS2.p1.3.m3.2.2.4.3.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.4.3.3">𝑁</ci></apply></apply><apply id="S2.SS1.SSS2.p1.3.m3.2.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2"><ci id="S2.SS1.SSS2.p1.3.m3.2.2.2.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2">▽</ci><apply id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2"><times id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.3"></times><ci id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.4.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.4">ℒ</ci><interval closure="open" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2"><apply id="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.2">𝑌</ci><ci id="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2"><times id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.2"></times><ci id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.3">𝐹</ci><ci id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.4.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.4">𝑆</ci><apply id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1">superscript</csymbol><apply id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.2">𝑋</ci><ci id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.2.3">𝑆</ci></apply><apply id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3"><times id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.2">𝑙</ci><ci id="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p1.3.m3.2.2.2.2.2.2.2.1.1.1.3.3">𝑐</ci></apply></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.3.m3.2c">g^{lN}=\bigtriangledown\mathcal{L}(Y_{S},{FS}(X_{S}^{lc}))</annotation></semantics></math> of the server-based sub-network <math id="S2.SS1.SSS2.p1.4.m4.1" class="ltx_Math" alttext="FS" display="inline"><semantics id="S2.SS1.SSS2.p1.4.m4.1a"><mrow id="S2.SS1.SSS2.p1.4.m4.1.1" xref="S2.SS1.SSS2.p1.4.m4.1.1.cmml"><mi id="S2.SS1.SSS2.p1.4.m4.1.1.2" xref="S2.SS1.SSS2.p1.4.m4.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.4.m4.1.1.1" xref="S2.SS1.SSS2.p1.4.m4.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.4.m4.1.1.3" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.4.m4.1b"><apply id="S2.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1"><times id="S2.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.1"></times><ci id="S2.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.2">𝐹</ci><ci id="S2.SS1.SSS2.p1.4.m4.1.1.3.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.4.m4.1c">FS</annotation></semantics></math>; 2) back propagate gradients <math id="S2.SS1.SSS2.p1.5.m5.1" class="ltx_Math" alttext="g^{lN}" display="inline"><semantics id="S2.SS1.SSS2.p1.5.m5.1a"><msup id="S2.SS1.SSS2.p1.5.m5.1.1" xref="S2.SS1.SSS2.p1.5.m5.1.1.cmml"><mi id="S2.SS1.SSS2.p1.5.m5.1.1.2" xref="S2.SS1.SSS2.p1.5.m5.1.1.2.cmml">g</mi><mrow id="S2.SS1.SSS2.p1.5.m5.1.1.3" xref="S2.SS1.SSS2.p1.5.m5.1.1.3.cmml"><mi id="S2.SS1.SSS2.p1.5.m5.1.1.3.2" xref="S2.SS1.SSS2.p1.5.m5.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.5.m5.1.1.3.1" xref="S2.SS1.SSS2.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.5.m5.1.1.3.3" xref="S2.SS1.SSS2.p1.5.m5.1.1.3.3.cmml">N</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.5.m5.1b"><apply id="S2.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1">superscript</csymbol><ci id="S2.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1.2">𝑔</ci><apply id="S2.SS1.SSS2.p1.5.m5.1.1.3.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1.3"><times id="S2.SS1.SSS2.p1.5.m5.1.1.3.1.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1.3.1"></times><ci id="S2.SS1.SSS2.p1.5.m5.1.1.3.2.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1.3.2">𝑙</ci><ci id="S2.SS1.SSS2.p1.5.m5.1.1.3.3.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.5.m5.1c">g^{lN}</annotation></semantics></math> at the central server from the last layer of server-based sub-network <math id="S2.SS1.SSS2.p1.6.m6.1" class="ltx_Math" alttext="FS" display="inline"><semantics id="S2.SS1.SSS2.p1.6.m6.1a"><mrow id="S2.SS1.SSS2.p1.6.m6.1.1" xref="S2.SS1.SSS2.p1.6.m6.1.1.cmml"><mi id="S2.SS1.SSS2.p1.6.m6.1.1.2" xref="S2.SS1.SSS2.p1.6.m6.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.6.m6.1.1.1" xref="S2.SS1.SSS2.p1.6.m6.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.6.m6.1.1.3" xref="S2.SS1.SSS2.p1.6.m6.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.6.m6.1b"><apply id="S2.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S2.SS1.SSS2.p1.6.m6.1.1"><times id="S2.SS1.SSS2.p1.6.m6.1.1.1.cmml" xref="S2.SS1.SSS2.p1.6.m6.1.1.1"></times><ci id="S2.SS1.SSS2.p1.6.m6.1.1.2.cmml" xref="S2.SS1.SSS2.p1.6.m6.1.1.2">𝐹</ci><ci id="S2.SS1.SSS2.p1.6.m6.1.1.3.cmml" xref="S2.SS1.SSS2.p1.6.m6.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.6.m6.1c">FS</annotation></semantics></math> to its first layer, and denote the gradient at the first layer of server-based sub-network as <math id="S2.SS1.SSS2.p1.7.m7.1" class="ltx_Math" alttext="g^{l(c+1)}" display="inline"><semantics id="S2.SS1.SSS2.p1.7.m7.1a"><msup id="S2.SS1.SSS2.p1.7.m7.1.2" xref="S2.SS1.SSS2.p1.7.m7.1.2.cmml"><mi id="S2.SS1.SSS2.p1.7.m7.1.2.2" xref="S2.SS1.SSS2.p1.7.m7.1.2.2.cmml">g</mi><mrow id="S2.SS1.SSS2.p1.7.m7.1.1.1" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.7.m7.1.1.1.3" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.7.m7.1.1.1.2" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.2.cmml">c</mi><mo id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.3" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.3" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.7.m7.1b"><apply id="S2.SS1.SSS2.p1.7.m7.1.2.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.7.m7.1.2.1.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.2">superscript</csymbol><ci id="S2.SS1.SSS2.p1.7.m7.1.2.2.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.2.2">𝑔</ci><apply id="S2.SS1.SSS2.p1.7.m7.1.1.1.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.1.1"><times id="S2.SS1.SSS2.p1.7.m7.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.2"></times><ci id="S2.SS1.SSS2.p1.7.m7.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.3">𝑙</ci><apply id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1"><plus id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.1"></plus><ci id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.7.m7.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.7.m7.1c">g^{l(c+1)}</annotation></semantics></math> ; 3) transfer the gradients <math id="S2.SS1.SSS2.p1.8.m8.1" class="ltx_Math" alttext="g^{l(c+1)}" display="inline"><semantics id="S2.SS1.SSS2.p1.8.m8.1a"><msup id="S2.SS1.SSS2.p1.8.m8.1.2" xref="S2.SS1.SSS2.p1.8.m8.1.2.cmml"><mi id="S2.SS1.SSS2.p1.8.m8.1.2.2" xref="S2.SS1.SSS2.p1.8.m8.1.2.2.cmml">g</mi><mrow id="S2.SS1.SSS2.p1.8.m8.1.1.1" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.8.m8.1.1.1.3" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.8.m8.1.1.1.2" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.2.cmml">c</mi><mo id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.3" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.3" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.8.m8.1b"><apply id="S2.SS1.SSS2.p1.8.m8.1.2.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.8.m8.1.2.1.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.2">superscript</csymbol><ci id="S2.SS1.SSS2.p1.8.m8.1.2.2.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.2.2">𝑔</ci><apply id="S2.SS1.SSS2.p1.8.m8.1.1.1.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.1.1"><times id="S2.SS1.SSS2.p1.8.m8.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.2"></times><ci id="S2.SS1.SSS2.p1.8.m8.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.3">𝑙</ci><apply id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1"><plus id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.1"></plus><ci id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.8.m8.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.8.m8.1c">g^{l(c+1)}</annotation></semantics></math> back to each local institution and complete the rest of the back-propagation operation through each institutional sub-network <math id="S2.SS1.SSS2.p1.9.m9.1" class="ltx_Math" alttext="FI" display="inline"><semantics id="S2.SS1.SSS2.p1.9.m9.1a"><mrow id="S2.SS1.SSS2.p1.9.m9.1.1" xref="S2.SS1.SSS2.p1.9.m9.1.1.cmml"><mi id="S2.SS1.SSS2.p1.9.m9.1.1.2" xref="S2.SS1.SSS2.p1.9.m9.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.9.m9.1.1.1" xref="S2.SS1.SSS2.p1.9.m9.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.9.m9.1.1.3" xref="S2.SS1.SSS2.p1.9.m9.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.9.m9.1b"><apply id="S2.SS1.SSS2.p1.9.m9.1.1.cmml" xref="S2.SS1.SSS2.p1.9.m9.1.1"><times id="S2.SS1.SSS2.p1.9.m9.1.1.1.cmml" xref="S2.SS1.SSS2.p1.9.m9.1.1.1"></times><ci id="S2.SS1.SSS2.p1.9.m9.1.1.2.cmml" xref="S2.SS1.SSS2.p1.9.m9.1.1.2">𝐹</ci><ci id="S2.SS1.SSS2.p1.9.m9.1.1.3.cmml" xref="S2.SS1.SSS2.p1.9.m9.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.9.m9.1c">FI</annotation></semantics></math>; 4) update the model weights of both the server-based sub-network <math id="S2.SS1.SSS2.p1.10.m10.1" class="ltx_Math" alttext="FS" display="inline"><semantics id="S2.SS1.SSS2.p1.10.m10.1a"><mrow id="S2.SS1.SSS2.p1.10.m10.1.1" xref="S2.SS1.SSS2.p1.10.m10.1.1.cmml"><mi id="S2.SS1.SSS2.p1.10.m10.1.1.2" xref="S2.SS1.SSS2.p1.10.m10.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.10.m10.1.1.1" xref="S2.SS1.SSS2.p1.10.m10.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.10.m10.1.1.3" xref="S2.SS1.SSS2.p1.10.m10.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.10.m10.1b"><apply id="S2.SS1.SSS2.p1.10.m10.1.1.cmml" xref="S2.SS1.SSS2.p1.10.m10.1.1"><times id="S2.SS1.SSS2.p1.10.m10.1.1.1.cmml" xref="S2.SS1.SSS2.p1.10.m10.1.1.1"></times><ci id="S2.SS1.SSS2.p1.10.m10.1.1.2.cmml" xref="S2.SS1.SSS2.p1.10.m10.1.1.2">𝐹</ci><ci id="S2.SS1.SSS2.p1.10.m10.1.1.3.cmml" xref="S2.SS1.SSS2.p1.10.m10.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.10.m10.1c">FS</annotation></semantics></math> and the institutional sub-network <math id="S2.SS1.SSS2.p1.11.m11.1" class="ltx_Math" alttext="FI" display="inline"><semantics id="S2.SS1.SSS2.p1.11.m11.1a"><mrow id="S2.SS1.SSS2.p1.11.m11.1.1" xref="S2.SS1.SSS2.p1.11.m11.1.1.cmml"><mi id="S2.SS1.SSS2.p1.11.m11.1.1.2" xref="S2.SS1.SSS2.p1.11.m11.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p1.11.m11.1.1.1" xref="S2.SS1.SSS2.p1.11.m11.1.1.1.cmml">​</mo><mi id="S2.SS1.SSS2.p1.11.m11.1.1.3" xref="S2.SS1.SSS2.p1.11.m11.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.11.m11.1b"><apply id="S2.SS1.SSS2.p1.11.m11.1.1.cmml" xref="S2.SS1.SSS2.p1.11.m11.1.1"><times id="S2.SS1.SSS2.p1.11.m11.1.1.1.cmml" xref="S2.SS1.SSS2.p1.11.m11.1.1.1"></times><ci id="S2.SS1.SSS2.p1.11.m11.1.1.2.cmml" xref="S2.SS1.SSS2.p1.11.m11.1.1.2">𝐹</ci><ci id="S2.SS1.SSS2.p1.11.m11.1.1.3.cmml" xref="S2.SS1.SSS2.p1.11.m11.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.11.m11.1c">FI</annotation></semantics></math>. Our back propagation procedure strictly follows the chain rule in differentiation, and it will achieve exactly the same results as the normal deep learning training procedure.</p>
</div>
<div id="S2.SS1.SSS2.p2" class="ltx_para">
<p id="S2.SS1.SSS2.p2.2" class="ltx_p">As opposed to traditional federated learning methods (such as FedAvg and FedSGD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> that require frequent transfers of model weights or model gradients of the entire network, in SplitAVG, only the intermediate feature maps <math id="S2.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="X_{S}^{lc}" display="inline"><semantics id="S2.SS1.SSS2.p2.1.m1.1a"><msubsup id="S2.SS1.SSS2.p2.1.m1.1.1" xref="S2.SS1.SSS2.p2.1.m1.1.1.cmml"><mi id="S2.SS1.SSS2.p2.1.m1.1.1.2.2" xref="S2.SS1.SSS2.p2.1.m1.1.1.2.2.cmml">X</mi><mi id="S2.SS1.SSS2.p2.1.m1.1.1.2.3" xref="S2.SS1.SSS2.p2.1.m1.1.1.2.3.cmml">S</mi><mrow id="S2.SS1.SSS2.p2.1.m1.1.1.3" xref="S2.SS1.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p2.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p2.1.m1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p2.1.m1.1.1.3.1" xref="S2.SS1.SSS2.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S2.SS1.SSS2.p2.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p2.1.m1.1.1.3.3.cmml">c</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p2.1.m1.1b"><apply id="S2.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1">superscript</csymbol><apply id="S2.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p2.1.m1.1.1.2.1.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p2.1.m1.1.1.2.2.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1.2.2">𝑋</ci><ci id="S2.SS1.SSS2.p2.1.m1.1.1.2.3.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1.2.3">𝑆</ci></apply><apply id="S2.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1.3"><times id="S2.SS1.SSS2.p2.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1.3.1"></times><ci id="S2.SS1.SSS2.p2.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1.3.2">𝑙</ci><ci id="S2.SS1.SSS2.p2.1.m1.1.1.3.3.cmml" xref="S2.SS1.SSS2.p2.1.m1.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p2.1.m1.1c">X_{S}^{lc}</annotation></semantics></math> and gradients <math id="S2.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="g^{l(c+1)}" display="inline"><semantics id="S2.SS1.SSS2.p2.2.m2.1a"><msup id="S2.SS1.SSS2.p2.2.m2.1.2" xref="S2.SS1.SSS2.p2.2.m2.1.2.cmml"><mi id="S2.SS1.SSS2.p2.2.m2.1.2.2" xref="S2.SS1.SSS2.p2.2.m2.1.2.2.cmml">g</mi><mrow id="S2.SS1.SSS2.p2.2.m2.1.1.1" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.cmml"><mi id="S2.SS1.SSS2.p2.2.m2.1.1.1.3" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS1.SSS2.p2.2.m2.1.1.1.2" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.2" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.2" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.2.cmml">c</mi><mo id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.1" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.3" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.3" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p2.2.m2.1b"><apply id="S2.SS1.SSS2.p2.2.m2.1.2.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p2.2.m2.1.2.1.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.2">superscript</csymbol><ci id="S2.SS1.SSS2.p2.2.m2.1.2.2.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.2.2">𝑔</ci><apply id="S2.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.1.1"><times id="S2.SS1.SSS2.p2.2.m2.1.1.1.2.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.2"></times><ci id="S2.SS1.SSS2.p2.2.m2.1.1.1.3.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.3">𝑙</ci><apply id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1"><plus id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.1"></plus><ci id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS2.p2.2.m2.1.1.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p2.2.m2.1c">g^{l(c+1)}</annotation></semantics></math> at the cut layer are communicated between local institutions and the central server, which greatly reduces the computation and communication costs. In addition, the direct feature map concatenation step in the central server provides convergence guarantees for the model training and allows us to train a robust model on both IID and non-IID data partitions.</p>
</div>
</section>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Theory analysis for SplitAVG</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.15" class="ltx_p">SplitAVG improves local models with biased data generalizing to global data distributions. To illustrate, we use the performance bound for aggregated federated learning models built in previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>: Assuming there are <math id="S2.SS2.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.p1.1.m1.1a"><mi id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><ci id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">K</annotation></semantics></math> local institutions. <math id="S2.SS2.p1.2.m2.1" class="ltx_Math" alttext="T_{K}" display="inline"><semantics id="S2.SS2.p1.2.m2.1a"><msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml"><mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">T</mi><mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">K</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b"><apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">𝑇</ci><ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">T_{K}</annotation></semantics></math> is the <math id="S2.SS2.p1.3.m3.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S2.SS2.p1.3.m3.1a"><msup id="S2.SS2.p1.3.m3.1.1" xref="S2.SS2.p1.3.m3.1.1.cmml"><mi id="S2.SS2.p1.3.m3.1.1.2" xref="S2.SS2.p1.3.m3.1.1.2.cmml">k</mi><mrow id="S2.SS2.p1.3.m3.1.1.3" xref="S2.SS2.p1.3.m3.1.1.3.cmml"><mi id="S2.SS2.p1.3.m3.1.1.3.2" xref="S2.SS2.p1.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p1.3.m3.1.1.3.1" xref="S2.SS2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS2.p1.3.m3.1.1.3.3" xref="S2.SS2.p1.3.m3.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.3.m3.1b"><apply id="S2.SS2.p1.3.m3.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.3.m3.1.1.1.cmml" xref="S2.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p1.3.m3.1.1.2.cmml" xref="S2.SS2.p1.3.m3.1.1.2">𝑘</ci><apply id="S2.SS2.p1.3.m3.1.1.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3"><times id="S2.SS2.p1.3.m3.1.1.3.1.cmml" xref="S2.SS2.p1.3.m3.1.1.3.1"></times><ci id="S2.SS2.p1.3.m3.1.1.3.2.cmml" xref="S2.SS2.p1.3.m3.1.1.3.2">𝑡</ci><ci id="S2.SS2.p1.3.m3.1.1.3.3.cmml" xref="S2.SS2.p1.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.3.m3.1c">k^{th}</annotation></semantics></math> institution’s task domain where the raw data distribution is <math id="S2.SS2.p1.4.m4.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="S2.SS2.p1.4.m4.1a"><msub id="S2.SS2.p1.4.m4.1.1" xref="S2.SS2.p1.4.m4.1.1.cmml"><mi id="S2.SS2.p1.4.m4.1.1.2" xref="S2.SS2.p1.4.m4.1.1.2.cmml">D</mi><mi id="S2.SS2.p1.4.m4.1.1.3" xref="S2.SS2.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.4.m4.1b"><apply id="S2.SS2.p1.4.m4.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.4.m4.1.1.1.cmml" xref="S2.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p1.4.m4.1.1.2.cmml" xref="S2.SS2.p1.4.m4.1.1.2">𝐷</ci><ci id="S2.SS2.p1.4.m4.1.1.3.cmml" xref="S2.SS2.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.4.m4.1c">D_{k}</annotation></semantics></math>, the local model learnt on this domain is <math id="S2.SS2.p1.5.m5.1" class="ltx_Math" alttext="h_{k}" display="inline"><semantics id="S2.SS2.p1.5.m5.1a"><msub id="S2.SS2.p1.5.m5.1.1" xref="S2.SS2.p1.5.m5.1.1.cmml"><mi id="S2.SS2.p1.5.m5.1.1.2" xref="S2.SS2.p1.5.m5.1.1.2.cmml">h</mi><mi id="S2.SS2.p1.5.m5.1.1.3" xref="S2.SS2.p1.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.5.m5.1b"><apply id="S2.SS2.p1.5.m5.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.5.m5.1.1.1.cmml" xref="S2.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p1.5.m5.1.1.2.cmml" xref="S2.SS2.p1.5.m5.1.1.2">ℎ</ci><ci id="S2.SS2.p1.5.m5.1.1.3.cmml" xref="S2.SS2.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.5.m5.1c">h_{k}</annotation></semantics></math>, and the empirical risk of the model on <math id="S2.SS2.p1.6.m6.1" class="ltx_Math" alttext="T_{k}" display="inline"><semantics id="S2.SS2.p1.6.m6.1a"><msub id="S2.SS2.p1.6.m6.1.1" xref="S2.SS2.p1.6.m6.1.1.cmml"><mi id="S2.SS2.p1.6.m6.1.1.2" xref="S2.SS2.p1.6.m6.1.1.2.cmml">T</mi><mi id="S2.SS2.p1.6.m6.1.1.3" xref="S2.SS2.p1.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.6.m6.1b"><apply id="S2.SS2.p1.6.m6.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.6.m6.1.1.1.cmml" xref="S2.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p1.6.m6.1.1.2.cmml" xref="S2.SS2.p1.6.m6.1.1.2">𝑇</ci><ci id="S2.SS2.p1.6.m6.1.1.3.cmml" xref="S2.SS2.p1.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.6.m6.1c">T_{k}</annotation></semantics></math> is <math id="S2.SS2.p1.7.m7.1" class="ltx_Math" alttext="{\hat{\mathcal{L}}}_{T_{k}}(h_{k})" display="inline"><semantics id="S2.SS2.p1.7.m7.1a"><mrow id="S2.SS2.p1.7.m7.1.1" xref="S2.SS2.p1.7.m7.1.1.cmml"><msub id="S2.SS2.p1.7.m7.1.1.3" xref="S2.SS2.p1.7.m7.1.1.3.cmml"><mover accent="true" id="S2.SS2.p1.7.m7.1.1.3.2" xref="S2.SS2.p1.7.m7.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.7.m7.1.1.3.2.2" xref="S2.SS2.p1.7.m7.1.1.3.2.2.cmml">ℒ</mi><mo id="S2.SS2.p1.7.m7.1.1.3.2.1" xref="S2.SS2.p1.7.m7.1.1.3.2.1.cmml">^</mo></mover><msub id="S2.SS2.p1.7.m7.1.1.3.3" xref="S2.SS2.p1.7.m7.1.1.3.3.cmml"><mi id="S2.SS2.p1.7.m7.1.1.3.3.2" xref="S2.SS2.p1.7.m7.1.1.3.3.2.cmml">T</mi><mi id="S2.SS2.p1.7.m7.1.1.3.3.3" xref="S2.SS2.p1.7.m7.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.7.m7.1.1.2" xref="S2.SS2.p1.7.m7.1.1.2.cmml">​</mo><mrow id="S2.SS2.p1.7.m7.1.1.1.1" xref="S2.SS2.p1.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.p1.7.m7.1.1.1.1.2" xref="S2.SS2.p1.7.m7.1.1.1.1.1.cmml">(</mo><msub id="S2.SS2.p1.7.m7.1.1.1.1.1" xref="S2.SS2.p1.7.m7.1.1.1.1.1.cmml"><mi id="S2.SS2.p1.7.m7.1.1.1.1.1.2" xref="S2.SS2.p1.7.m7.1.1.1.1.1.2.cmml">h</mi><mi id="S2.SS2.p1.7.m7.1.1.1.1.1.3" xref="S2.SS2.p1.7.m7.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS2.p1.7.m7.1.1.1.1.3" xref="S2.SS2.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.7.m7.1b"><apply id="S2.SS2.p1.7.m7.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1"><times id="S2.SS2.p1.7.m7.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.2"></times><apply id="S2.SS2.p1.7.m7.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.3">subscript</csymbol><apply id="S2.SS2.p1.7.m7.1.1.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.3.2"><ci id="S2.SS2.p1.7.m7.1.1.3.2.1.cmml" xref="S2.SS2.p1.7.m7.1.1.3.2.1">^</ci><ci id="S2.SS2.p1.7.m7.1.1.3.2.2.cmml" xref="S2.SS2.p1.7.m7.1.1.3.2.2">ℒ</ci></apply><apply id="S2.SS2.p1.7.m7.1.1.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.3.3.1.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.3.3.2.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3.2">𝑇</ci><ci id="S2.SS2.p1.7.m7.1.1.3.3.3.cmml" xref="S2.SS2.p1.7.m7.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S2.SS2.p1.7.m7.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.1.2">ℎ</ci><ci id="S2.SS2.p1.7.m7.1.1.1.1.1.3.cmml" xref="S2.SS2.p1.7.m7.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.7.m7.1c">{\hat{\mathcal{L}}}_{T_{k}}(h_{k})</annotation></semantics></math>. <math id="S2.SS2.p1.8.m8.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS2.p1.8.m8.1a"><mi id="S2.SS2.p1.8.m8.1.1" xref="S2.SS2.p1.8.m8.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.8.m8.1b"><ci id="S2.SS2.p1.8.m8.1.1.cmml" xref="S2.SS2.p1.8.m8.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.8.m8.1c">T</annotation></semantics></math> is the global domain where the data distribution <math id="S2.SS2.p1.9.m9.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS2.p1.9.m9.1a"><mi id="S2.SS2.p1.9.m9.1.1" xref="S2.SS2.p1.9.m9.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.9.m9.1b"><ci id="S2.SS2.p1.9.m9.1.1.cmml" xref="S2.SS2.p1.9.m9.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.9.m9.1c">D</annotation></semantics></math> including <math id="S2.SS2.p1.10.m10.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS2.p1.10.m10.1a"><mi id="S2.SS2.p1.10.m10.1.1" xref="S2.SS2.p1.10.m10.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.10.m10.1b"><ci id="S2.SS2.p1.10.m10.1.1.cmml" xref="S2.SS2.p1.10.m10.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.10.m10.1c">m</annotation></semantics></math> samples is assumed to be unbiased. <math id="S2.SS2.p1.11.m11.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S2.SS2.p1.11.m11.1a"><mi id="S2.SS2.p1.11.m11.1.1" xref="S2.SS2.p1.11.m11.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.11.m11.1b"><ci id="S2.SS2.p1.11.m11.1.1.cmml" xref="S2.SS2.p1.11.m11.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.11.m11.1c">h</annotation></semantics></math> is a global model achieved from federated learning which aims to minimize the risk of task from all <math id="S2.SS2.p1.12.m12.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.p1.12.m12.1a"><mi id="S2.SS2.p1.12.m12.1.1" xref="S2.SS2.p1.12.m12.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.12.m12.1b"><ci id="S2.SS2.p1.12.m12.1.1.cmml" xref="S2.SS2.p1.12.m12.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.12.m12.1c">K</annotation></semantics></math> local site, written as <math id="S2.SS2.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{L}_{T}(h)" display="inline"><semantics id="S2.SS2.p1.13.m13.1a"><mrow id="S2.SS2.p1.13.m13.1.2" xref="S2.SS2.p1.13.m13.1.2.cmml"><msub id="S2.SS2.p1.13.m13.1.2.2" xref="S2.SS2.p1.13.m13.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.13.m13.1.2.2.2" xref="S2.SS2.p1.13.m13.1.2.2.2.cmml">ℒ</mi><mi id="S2.SS2.p1.13.m13.1.2.2.3" xref="S2.SS2.p1.13.m13.1.2.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.13.m13.1.2.1" xref="S2.SS2.p1.13.m13.1.2.1.cmml">​</mo><mrow id="S2.SS2.p1.13.m13.1.2.3.2" xref="S2.SS2.p1.13.m13.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.13.m13.1.2.3.2.1" xref="S2.SS2.p1.13.m13.1.2.cmml">(</mo><mi id="S2.SS2.p1.13.m13.1.1" xref="S2.SS2.p1.13.m13.1.1.cmml">h</mi><mo stretchy="false" id="S2.SS2.p1.13.m13.1.2.3.2.2" xref="S2.SS2.p1.13.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.13.m13.1b"><apply id="S2.SS2.p1.13.m13.1.2.cmml" xref="S2.SS2.p1.13.m13.1.2"><times id="S2.SS2.p1.13.m13.1.2.1.cmml" xref="S2.SS2.p1.13.m13.1.2.1"></times><apply id="S2.SS2.p1.13.m13.1.2.2.cmml" xref="S2.SS2.p1.13.m13.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.13.m13.1.2.2.1.cmml" xref="S2.SS2.p1.13.m13.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.13.m13.1.2.2.2.cmml" xref="S2.SS2.p1.13.m13.1.2.2.2">ℒ</ci><ci id="S2.SS2.p1.13.m13.1.2.2.3.cmml" xref="S2.SS2.p1.13.m13.1.2.2.3">𝑇</ci></apply><ci id="S2.SS2.p1.13.m13.1.1.cmml" xref="S2.SS2.p1.13.m13.1.1">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.13.m13.1c">\mathcal{L}_{T}(h)</annotation></semantics></math>. <math id="S2.SS2.p1.14.m14.1" class="ltx_Math" alttext="\mathcal{L}_{T}(h)" display="inline"><semantics id="S2.SS2.p1.14.m14.1a"><mrow id="S2.SS2.p1.14.m14.1.2" xref="S2.SS2.p1.14.m14.1.2.cmml"><msub id="S2.SS2.p1.14.m14.1.2.2" xref="S2.SS2.p1.14.m14.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p1.14.m14.1.2.2.2" xref="S2.SS2.p1.14.m14.1.2.2.2.cmml">ℒ</mi><mi id="S2.SS2.p1.14.m14.1.2.2.3" xref="S2.SS2.p1.14.m14.1.2.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p1.14.m14.1.2.1" xref="S2.SS2.p1.14.m14.1.2.1.cmml">​</mo><mrow id="S2.SS2.p1.14.m14.1.2.3.2" xref="S2.SS2.p1.14.m14.1.2.cmml"><mo stretchy="false" id="S2.SS2.p1.14.m14.1.2.3.2.1" xref="S2.SS2.p1.14.m14.1.2.cmml">(</mo><mi id="S2.SS2.p1.14.m14.1.1" xref="S2.SS2.p1.14.m14.1.1.cmml">h</mi><mo stretchy="false" id="S2.SS2.p1.14.m14.1.2.3.2.2" xref="S2.SS2.p1.14.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.14.m14.1b"><apply id="S2.SS2.p1.14.m14.1.2.cmml" xref="S2.SS2.p1.14.m14.1.2"><times id="S2.SS2.p1.14.m14.1.2.1.cmml" xref="S2.SS2.p1.14.m14.1.2.1"></times><apply id="S2.SS2.p1.14.m14.1.2.2.cmml" xref="S2.SS2.p1.14.m14.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p1.14.m14.1.2.2.1.cmml" xref="S2.SS2.p1.14.m14.1.2.2">subscript</csymbol><ci id="S2.SS2.p1.14.m14.1.2.2.2.cmml" xref="S2.SS2.p1.14.m14.1.2.2.2">ℒ</ci><ci id="S2.SS2.p1.14.m14.1.2.2.3.cmml" xref="S2.SS2.p1.14.m14.1.2.2.3">𝑇</ci></apply><ci id="S2.SS2.p1.14.m14.1.1.cmml" xref="S2.SS2.p1.14.m14.1.1">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.14.m14.1c">\mathcal{L}_{T}(h)</annotation></semantics></math> has an upper bound that with probability larger than <math id="S2.SS2.p1.15.m15.1" class="ltx_Math" alttext="1-\delta" display="inline"><semantics id="S2.SS2.p1.15.m15.1a"><mrow id="S2.SS2.p1.15.m15.1.1" xref="S2.SS2.p1.15.m15.1.1.cmml"><mn id="S2.SS2.p1.15.m15.1.1.2" xref="S2.SS2.p1.15.m15.1.1.2.cmml">1</mn><mo id="S2.SS2.p1.15.m15.1.1.1" xref="S2.SS2.p1.15.m15.1.1.1.cmml">−</mo><mi id="S2.SS2.p1.15.m15.1.1.3" xref="S2.SS2.p1.15.m15.1.1.3.cmml">δ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.15.m15.1b"><apply id="S2.SS2.p1.15.m15.1.1.cmml" xref="S2.SS2.p1.15.m15.1.1"><minus id="S2.SS2.p1.15.m15.1.1.1.cmml" xref="S2.SS2.p1.15.m15.1.1.1"></minus><cn type="integer" id="S2.SS2.p1.15.m15.1.1.2.cmml" xref="S2.SS2.p1.15.m15.1.1.2">1</cn><ci id="S2.SS2.p1.15.m15.1.1.3.cmml" xref="S2.SS2.p1.15.m15.1.1.3">𝛿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.15.m15.1c">1-\delta</annotation></semantics></math>:</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex1.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{T}(h)\equiv\mathcal{L}_{T}(\frac{1}{K}\sum_{k}h_{k})" display="inline"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2" xref="S2.Ex1.m1.2.2.cmml"><mrow id="S2.Ex1.m1.2.2.3" xref="S2.Ex1.m1.2.2.3.cmml"><msub id="S2.Ex1.m1.2.2.3.2" xref="S2.Ex1.m1.2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.3.2.2" xref="S2.Ex1.m1.2.2.3.2.2.cmml">ℒ</mi><mi id="S2.Ex1.m1.2.2.3.2.3" xref="S2.Ex1.m1.2.2.3.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.2.2.3.1" xref="S2.Ex1.m1.2.2.3.1.cmml">​</mo><mrow id="S2.Ex1.m1.2.2.3.3.2" xref="S2.Ex1.m1.2.2.3.cmml"><mo stretchy="false" id="S2.Ex1.m1.2.2.3.3.2.1" xref="S2.Ex1.m1.2.2.3.cmml">(</mo><mi id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">h</mi><mo stretchy="false" id="S2.Ex1.m1.2.2.3.3.2.2" xref="S2.Ex1.m1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex1.m1.2.2.2" xref="S2.Ex1.m1.2.2.2.cmml">≡</mo><mrow id="S2.Ex1.m1.2.2.1" xref="S2.Ex1.m1.2.2.1.cmml"><msub id="S2.Ex1.m1.2.2.1.3" xref="S2.Ex1.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.1.3.2" xref="S2.Ex1.m1.2.2.1.3.2.cmml">ℒ</mi><mi id="S2.Ex1.m1.2.2.1.3.3" xref="S2.Ex1.m1.2.2.1.3.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.2.2.1.2" xref="S2.Ex1.m1.2.2.1.2.cmml">​</mo><mrow id="S2.Ex1.m1.2.2.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex1.m1.2.2.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.2.cmml"><mfrac id="S2.Ex1.m1.2.2.1.1.1.1.2a" xref="S2.Ex1.m1.2.2.1.1.1.1.2.cmml"><mn id="S2.Ex1.m1.2.2.1.1.1.1.2.2" xref="S2.Ex1.m1.2.2.1.1.1.1.2.2.cmml">1</mn><mi id="S2.Ex1.m1.2.2.1.1.1.1.2.3" xref="S2.Ex1.m1.2.2.1.1.1.1.2.3.cmml">K</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.Ex1.m1.2.2.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.cmml">​</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S2.Ex1.m1.2.2.1.1.1.1.3.1" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1.cmml"><munder id="S2.Ex1.m1.2.2.1.1.1.1.3.1a" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S2.Ex1.m1.2.2.1.1.1.1.3.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1.2.cmml">∑</mo><mi id="S2.Ex1.m1.2.2.1.1.1.1.3.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1.3.cmml">k</mi></munder></mstyle><msub id="S2.Ex1.m1.2.2.1.1.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.3.2.2" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2.2.cmml">h</mi><mi id="S2.Ex1.m1.2.2.1.1.1.1.3.2.3" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S2.Ex1.m1.2.2.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.cmml" xref="S2.Ex1.m1.2.2"><equivalent id="S2.Ex1.m1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2"></equivalent><apply id="S2.Ex1.m1.2.2.3.cmml" xref="S2.Ex1.m1.2.2.3"><times id="S2.Ex1.m1.2.2.3.1.cmml" xref="S2.Ex1.m1.2.2.3.1"></times><apply id="S2.Ex1.m1.2.2.3.2.cmml" xref="S2.Ex1.m1.2.2.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.3.2.1.cmml" xref="S2.Ex1.m1.2.2.3.2">subscript</csymbol><ci id="S2.Ex1.m1.2.2.3.2.2.cmml" xref="S2.Ex1.m1.2.2.3.2.2">ℒ</ci><ci id="S2.Ex1.m1.2.2.3.2.3.cmml" xref="S2.Ex1.m1.2.2.3.2.3">𝑇</ci></apply><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">ℎ</ci></apply><apply id="S2.Ex1.m1.2.2.1.cmml" xref="S2.Ex1.m1.2.2.1"><times id="S2.Ex1.m1.2.2.1.2.cmml" xref="S2.Ex1.m1.2.2.1.2"></times><apply id="S2.Ex1.m1.2.2.1.3.cmml" xref="S2.Ex1.m1.2.2.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.3">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.3.2">ℒ</ci><ci id="S2.Ex1.m1.2.2.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.3.3">𝑇</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1"></times><apply id="S2.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.2"><divide id="S2.Ex1.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.2"></divide><cn type="integer" id="S2.Ex1.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.2.2">1</cn><ci id="S2.Ex1.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.2.3">𝐾</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3"><apply id="S2.Ex1.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.3.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1">subscript</csymbol><sum id="S2.Ex1.m1.2.2.1.1.1.1.3.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1.2"></sum><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.1.3">𝑘</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2.2">ℎ</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">\displaystyle\mathcal{L}_{T}(h)\equiv\mathcal{L}_{T}(\frac{1}{K}\sum_{k}h_{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex2.m1.3" class="ltx_Math" alttext="\displaystyle\leq\frac{1}{K}\sum_{k}{\hat{\mathcal{L}}}_{T_{k}}(h_{k})+\frac{1}{K}\sum_{k}(d({\tilde{D}_{k}},{\tilde{D}})+\lambda_{k})" display="inline"><semantics id="S2.Ex2.m1.3a"><mrow id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3.cmml"><mi id="S2.Ex2.m1.3.3.4" xref="S2.Ex2.m1.3.3.4.cmml"></mi><mo id="S2.Ex2.m1.3.3.3" xref="S2.Ex2.m1.3.3.3.cmml">≤</mo><mrow id="S2.Ex2.m1.3.3.2" xref="S2.Ex2.m1.3.3.2.cmml"><mrow id="S2.Ex2.m1.2.2.1.1" xref="S2.Ex2.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex2.m1.2.2.1.1.3" xref="S2.Ex2.m1.2.2.1.1.3.cmml"><mfrac id="S2.Ex2.m1.2.2.1.1.3a" xref="S2.Ex2.m1.2.2.1.1.3.cmml"><mn id="S2.Ex2.m1.2.2.1.1.3.2" xref="S2.Ex2.m1.2.2.1.1.3.2.cmml">1</mn><mi id="S2.Ex2.m1.2.2.1.1.3.3" xref="S2.Ex2.m1.2.2.1.1.3.3.cmml">K</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.2.2.1.1.2" xref="S2.Ex2.m1.2.2.1.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.2.2.1.1.1" xref="S2.Ex2.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex2.m1.2.2.1.1.1.2" xref="S2.Ex2.m1.2.2.1.1.1.2.cmml"><munder id="S2.Ex2.m1.2.2.1.1.1.2a" xref="S2.Ex2.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S2.Ex2.m1.2.2.1.1.1.2.2" xref="S2.Ex2.m1.2.2.1.1.1.2.2.cmml">∑</mo><mi id="S2.Ex2.m1.2.2.1.1.1.2.3" xref="S2.Ex2.m1.2.2.1.1.1.2.3.cmml">k</mi></munder></mstyle><mrow id="S2.Ex2.m1.2.2.1.1.1.1" xref="S2.Ex2.m1.2.2.1.1.1.1.cmml"><msub id="S2.Ex2.m1.2.2.1.1.1.1.3" xref="S2.Ex2.m1.2.2.1.1.1.1.3.cmml"><mover accent="true" id="S2.Ex2.m1.2.2.1.1.1.1.3.2" xref="S2.Ex2.m1.2.2.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.Ex2.m1.2.2.1.1.1.1.3.2.2" xref="S2.Ex2.m1.2.2.1.1.1.1.3.2.2.cmml">ℒ</mi><mo id="S2.Ex2.m1.2.2.1.1.1.1.3.2.1" xref="S2.Ex2.m1.2.2.1.1.1.1.3.2.1.cmml">^</mo></mover><msub id="S2.Ex2.m1.2.2.1.1.1.1.3.3" xref="S2.Ex2.m1.2.2.1.1.1.1.3.3.cmml"><mi id="S2.Ex2.m1.2.2.1.1.1.1.3.3.2" xref="S2.Ex2.m1.2.2.1.1.1.1.3.3.2.cmml">T</mi><mi id="S2.Ex2.m1.2.2.1.1.1.1.3.3.3" xref="S2.Ex2.m1.2.2.1.1.1.1.3.3.3.cmml">k</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.2.2.1.1.1.1.2" xref="S2.Ex2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.2.2.1.1.1.1.1.1" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.Ex2.m1.2.2.1.1.1.1.1.1.1" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.Ex2.m1.2.2.1.1.1.1.1.1.3" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.Ex2.m1.3.3.2.3" xref="S2.Ex2.m1.3.3.2.3.cmml">+</mo><mrow id="S2.Ex2.m1.3.3.2.2" xref="S2.Ex2.m1.3.3.2.2.cmml"><mstyle displaystyle="true" id="S2.Ex2.m1.3.3.2.2.3" xref="S2.Ex2.m1.3.3.2.2.3.cmml"><mfrac id="S2.Ex2.m1.3.3.2.2.3a" xref="S2.Ex2.m1.3.3.2.2.3.cmml"><mn id="S2.Ex2.m1.3.3.2.2.3.2" xref="S2.Ex2.m1.3.3.2.2.3.2.cmml">1</mn><mi id="S2.Ex2.m1.3.3.2.2.3.3" xref="S2.Ex2.m1.3.3.2.2.3.3.cmml">K</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.3.3.2.2.2" xref="S2.Ex2.m1.3.3.2.2.2.cmml">​</mo><mrow id="S2.Ex2.m1.3.3.2.2.1" xref="S2.Ex2.m1.3.3.2.2.1.cmml"><mstyle displaystyle="true" id="S2.Ex2.m1.3.3.2.2.1.2" xref="S2.Ex2.m1.3.3.2.2.1.2.cmml"><munder id="S2.Ex2.m1.3.3.2.2.1.2a" xref="S2.Ex2.m1.3.3.2.2.1.2.cmml"><mo movablelimits="false" id="S2.Ex2.m1.3.3.2.2.1.2.2" xref="S2.Ex2.m1.3.3.2.2.1.2.2.cmml">∑</mo><mi id="S2.Ex2.m1.3.3.2.2.1.2.3" xref="S2.Ex2.m1.3.3.2.2.1.2.3.cmml">k</mi></munder></mstyle><mrow id="S2.Ex2.m1.3.3.2.2.1.1.1" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex2.m1.3.3.2.2.1.1.1.2" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.3.3.2.2.1.1.1.1" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.cmml"><mrow id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.3" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.2" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.2.cmml">(</mo><msub id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.2.cmml">D</mi><mo id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.1" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.1.cmml">~</mo></mover><mi id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.3" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.2.cmml">,</mo><mover accent="true" id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1.cmml"><mi id="S2.Ex2.m1.1.1.2" xref="S2.Ex2.m1.1.1.2.cmml">D</mi><mo id="S2.Ex2.m1.1.1.1" xref="S2.Ex2.m1.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.4" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex2.m1.3.3.2.2.1.1.1.1.2" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.2.cmml">+</mo><msub id="S2.Ex2.m1.3.3.2.2.1.1.1.1.3" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.cmml"><mi id="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.2" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.2.cmml">λ</mi><mi id="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.3" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="S2.Ex2.m1.3.3.2.2.1.1.1.3" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.3b"><apply id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3"><leq id="S2.Ex2.m1.3.3.3.cmml" xref="S2.Ex2.m1.3.3.3"></leq><csymbol cd="latexml" id="S2.Ex2.m1.3.3.4.cmml" xref="S2.Ex2.m1.3.3.4">absent</csymbol><apply id="S2.Ex2.m1.3.3.2.cmml" xref="S2.Ex2.m1.3.3.2"><plus id="S2.Ex2.m1.3.3.2.3.cmml" xref="S2.Ex2.m1.3.3.2.3"></plus><apply id="S2.Ex2.m1.2.2.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1"><times id="S2.Ex2.m1.2.2.1.1.2.cmml" xref="S2.Ex2.m1.2.2.1.1.2"></times><apply id="S2.Ex2.m1.2.2.1.1.3.cmml" xref="S2.Ex2.m1.2.2.1.1.3"><divide id="S2.Ex2.m1.2.2.1.1.3.1.cmml" xref="S2.Ex2.m1.2.2.1.1.3"></divide><cn type="integer" id="S2.Ex2.m1.2.2.1.1.3.2.cmml" xref="S2.Ex2.m1.2.2.1.1.3.2">1</cn><ci id="S2.Ex2.m1.2.2.1.1.3.3.cmml" xref="S2.Ex2.m1.2.2.1.1.3.3">𝐾</ci></apply><apply id="S2.Ex2.m1.2.2.1.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1"><apply id="S2.Ex2.m1.2.2.1.1.1.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.1.1.1.2.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S2.Ex2.m1.2.2.1.1.1.2.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.2.2"></sum><ci id="S2.Ex2.m1.2.2.1.1.1.2.3.cmml" xref="S2.Ex2.m1.2.2.1.1.1.2.3">𝑘</ci></apply><apply id="S2.Ex2.m1.2.2.1.1.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1"><times id="S2.Ex2.m1.2.2.1.1.1.1.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.2"></times><apply id="S2.Ex2.m1.2.2.1.1.1.1.3.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3">subscript</csymbol><apply id="S2.Ex2.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3.2"><ci id="S2.Ex2.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3.2.1">^</ci><ci id="S2.Ex2.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3.2.2">ℒ</ci></apply><apply id="S2.Ex2.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3.3">subscript</csymbol><ci id="S2.Ex2.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3.3.2">𝑇</ci><ci id="S2.Ex2.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.2.2.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply><apply id="S2.Ex2.m1.3.3.2.2.cmml" xref="S2.Ex2.m1.3.3.2.2"><times id="S2.Ex2.m1.3.3.2.2.2.cmml" xref="S2.Ex2.m1.3.3.2.2.2"></times><apply id="S2.Ex2.m1.3.3.2.2.3.cmml" xref="S2.Ex2.m1.3.3.2.2.3"><divide id="S2.Ex2.m1.3.3.2.2.3.1.cmml" xref="S2.Ex2.m1.3.3.2.2.3"></divide><cn type="integer" id="S2.Ex2.m1.3.3.2.2.3.2.cmml" xref="S2.Ex2.m1.3.3.2.2.3.2">1</cn><ci id="S2.Ex2.m1.3.3.2.2.3.3.cmml" xref="S2.Ex2.m1.3.3.2.2.3.3">𝐾</ci></apply><apply id="S2.Ex2.m1.3.3.2.2.1.cmml" xref="S2.Ex2.m1.3.3.2.2.1"><apply id="S2.Ex2.m1.3.3.2.2.1.2.cmml" xref="S2.Ex2.m1.3.3.2.2.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.2.2.1.2.1.cmml" xref="S2.Ex2.m1.3.3.2.2.1.2">subscript</csymbol><sum id="S2.Ex2.m1.3.3.2.2.1.2.2.cmml" xref="S2.Ex2.m1.3.3.2.2.1.2.2"></sum><ci id="S2.Ex2.m1.3.3.2.2.1.2.3.cmml" xref="S2.Ex2.m1.3.3.2.2.1.2.3">𝑘</ci></apply><apply id="S2.Ex2.m1.3.3.2.2.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1"><plus id="S2.Ex2.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.2"></plus><apply id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1"><times id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.2"></times><ci id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.3">𝑑</ci><interval closure="open" id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1"><apply id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2"><ci id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.1">~</ci><ci id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.2">𝐷</ci></apply><ci id="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1"><ci id="S2.Ex2.m1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1">~</ci><ci id="S2.Ex2.m1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.2">𝐷</ci></apply></interval></apply><apply id="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.2">𝜆</ci><ci id="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.3.cmml" xref="S2.Ex2.m1.3.3.2.2.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.3c">\displaystyle\leq\frac{1}{K}\sum_{k}{\hat{\mathcal{L}}}_{T_{k}}(h_{k})+\frac{1}{K}\sum_{k}(d({\tilde{D}_{k}},{\tilde{D}})+\lambda_{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S2.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle+\sqrt{\frac{4}{m}(dlog\frac{2em}{d}+log\frac{4K}{\delta})}" display="inline"><semantics id="S2.Ex3.m1.1a"><mrow id="S2.Ex3.m1.1.2" xref="S2.Ex3.m1.1.2.cmml"><mo id="S2.Ex3.m1.1.2a" xref="S2.Ex3.m1.1.2.cmml">+</mo><msqrt id="S2.Ex3.m1.1.1" xref="S2.Ex3.m1.1.1.cmml"><mrow id="S2.Ex3.m1.1.1.1" xref="S2.Ex3.m1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.Ex3.m1.1.1.1.3" xref="S2.Ex3.m1.1.1.1.3.cmml"><mfrac id="S2.Ex3.m1.1.1.1.3a" xref="S2.Ex3.m1.1.1.1.3.cmml"><mn id="S2.Ex3.m1.1.1.1.3.2" xref="S2.Ex3.m1.1.1.1.3.2.cmml">4</mn><mi id="S2.Ex3.m1.1.1.1.3.3" xref="S2.Ex3.m1.1.1.1.3.3.cmml">m</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.2" xref="S2.Ex3.m1.1.1.1.2.cmml">​</mo><mrow id="S2.Ex3.m1.1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.Ex3.m1.1.1.1.1.1.2" xref="S2.Ex3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex3.m1.1.1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex3.m1.1.1.1.1.1.1.2" xref="S2.Ex3.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex3.m1.1.1.1.1.1.1.2.2" xref="S2.Ex3.m1.1.1.1.1.1.1.2.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.2.1" xref="S2.Ex3.m1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S2.Ex3.m1.1.1.1.1.1.1.2.3" xref="S2.Ex3.m1.1.1.1.1.1.1.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.2.1a" xref="S2.Ex3.m1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S2.Ex3.m1.1.1.1.1.1.1.2.4" xref="S2.Ex3.m1.1.1.1.1.1.1.2.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.2.1b" xref="S2.Ex3.m1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S2.Ex3.m1.1.1.1.1.1.1.2.5" xref="S2.Ex3.m1.1.1.1.1.1.1.2.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.2.1c" xref="S2.Ex3.m1.1.1.1.1.1.1.2.1.cmml">​</mo><mstyle displaystyle="true" id="S2.Ex3.m1.1.1.1.1.1.1.2.6" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.cmml"><mfrac id="S2.Ex3.m1.1.1.1.1.1.1.2.6a" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.cmml"><mrow id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.cmml"><mn id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.2" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.1" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.1.cmml">​</mo><mi id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.3" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.1a" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.1.cmml">​</mo><mi id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.4" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.4.cmml">m</mi></mrow><mi id="S2.Ex3.m1.1.1.1.1.1.1.2.6.3" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.3.cmml">d</mi></mfrac></mstyle></mrow><mo id="S2.Ex3.m1.1.1.1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.Ex3.m1.1.1.1.1.1.1.3" xref="S2.Ex3.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.Ex3.m1.1.1.1.1.1.1.3.2" xref="S2.Ex3.m1.1.1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.3.1" xref="S2.Ex3.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.Ex3.m1.1.1.1.1.1.1.3.3" xref="S2.Ex3.m1.1.1.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.3.1a" xref="S2.Ex3.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.Ex3.m1.1.1.1.1.1.1.3.4" xref="S2.Ex3.m1.1.1.1.1.1.1.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.3.1b" xref="S2.Ex3.m1.1.1.1.1.1.1.3.1.cmml">​</mo><mstyle displaystyle="true" id="S2.Ex3.m1.1.1.1.1.1.1.3.5" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.cmml"><mfrac id="S2.Ex3.m1.1.1.1.1.1.1.3.5a" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.cmml"><mrow id="S2.Ex3.m1.1.1.1.1.1.1.3.5.2" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.cmml"><mn id="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.2" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.1" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.1.cmml">​</mo><mi id="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.3" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.3.cmml">K</mi></mrow><mi id="S2.Ex3.m1.1.1.1.1.1.1.3.5.3" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.3.cmml">δ</mi></mfrac></mstyle></mrow></mrow><mo stretchy="false" id="S2.Ex3.m1.1.1.1.1.1.3" xref="S2.Ex3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.1b"><apply id="S2.Ex3.m1.1.2.cmml" xref="S2.Ex3.m1.1.2"><plus id="S2.Ex3.m1.1.2.1.cmml" xref="S2.Ex3.m1.1.2"></plus><apply id="S2.Ex3.m1.1.1.cmml" xref="S2.Ex3.m1.1.1"><root id="S2.Ex3.m1.1.1a.cmml" xref="S2.Ex3.m1.1.1"></root><apply id="S2.Ex3.m1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1"><times id="S2.Ex3.m1.1.1.1.2.cmml" xref="S2.Ex3.m1.1.1.1.2"></times><apply id="S2.Ex3.m1.1.1.1.3.cmml" xref="S2.Ex3.m1.1.1.1.3"><divide id="S2.Ex3.m1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.1.1.1.3"></divide><cn type="integer" id="S2.Ex3.m1.1.1.1.3.2.cmml" xref="S2.Ex3.m1.1.1.1.3.2">4</cn><ci id="S2.Ex3.m1.1.1.1.3.3.cmml" xref="S2.Ex3.m1.1.1.1.3.3">𝑚</ci></apply><apply id="S2.Ex3.m1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1"><plus id="S2.Ex3.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.1"></plus><apply id="S2.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2"><times id="S2.Ex3.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.1"></times><ci id="S2.Ex3.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.2">𝑑</ci><ci id="S2.Ex3.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.3">𝑙</ci><ci id="S2.Ex3.m1.1.1.1.1.1.1.2.4.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.4">𝑜</ci><ci id="S2.Ex3.m1.1.1.1.1.1.1.2.5.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.5">𝑔</ci><apply id="S2.Ex3.m1.1.1.1.1.1.1.2.6.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6"><divide id="S2.Ex3.m1.1.1.1.1.1.1.2.6.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6"></divide><apply id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2"><times id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.1"></times><cn type="integer" id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.2">2</cn><ci id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.3">𝑒</ci><ci id="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.4.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.2.4">𝑚</ci></apply><ci id="S2.Ex3.m1.1.1.1.1.1.1.2.6.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.2.6.3">𝑑</ci></apply></apply><apply id="S2.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3"><times id="S2.Ex3.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.1"></times><ci id="S2.Ex3.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.2">𝑙</ci><ci id="S2.Ex3.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.3">𝑜</ci><ci id="S2.Ex3.m1.1.1.1.1.1.1.3.4.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.4">𝑔</ci><apply id="S2.Ex3.m1.1.1.1.1.1.1.3.5.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5"><divide id="S2.Ex3.m1.1.1.1.1.1.1.3.5.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5"></divide><apply id="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.2"><times id="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.1.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.1"></times><cn type="integer" id="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.2.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.2">4</cn><ci id="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.2.3">𝐾</ci></apply><ci id="S2.Ex3.m1.1.1.1.1.1.1.3.5.3.cmml" xref="S2.Ex3.m1.1.1.1.1.1.1.3.5.3">𝛿</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.1c">\displaystyle+\sqrt{\frac{4}{m}(dlog\frac{2em}{d}+log\frac{4K}{\delta})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.13" class="ltx_p"><math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">d</annotation></semantics></math> denotes the divergence measured between two domains, and <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\tilde{D}_{k}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mover accent="true" id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2.2" xref="S2.SS2.p2.2.m2.1.1.2.2.cmml">D</mi><mo id="S2.SS2.p2.2.m2.1.1.2.1" xref="S2.SS2.p2.2.m2.1.1.2.1.cmml">~</mo></mover><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><apply id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2"><ci id="S2.SS2.p2.2.m2.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1.2.1">~</ci><ci id="S2.SS2.p2.2.m2.1.1.2.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2.2">𝐷</ci></apply><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\tilde{D}_{k}</annotation></semantics></math> and <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="\tilde{D}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mover accent="true" id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">D</mi><mo id="S2.SS2.p2.3.m3.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><ci id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1">~</ci><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\tilde{D}</annotation></semantics></math> are intermediate feature representations reduced from raw images in <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><msub id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml">D</mi><mi id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2">𝐷</ci><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">D_{k}</annotation></semantics></math> and <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><mi id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><ci id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">D</annotation></semantics></math> by a same feature extraction structure. The implication was derived that data heterogeneity of local sites to the global distribution leads to a high representation divergence <math id="S2.SS2.p2.6.m6.2" class="ltx_Math" alttext="d(\tilde{D}_{k},\tilde{D})" display="inline"><semantics id="S2.SS2.p2.6.m6.2a"><mrow id="S2.SS2.p2.6.m6.2.2" xref="S2.SS2.p2.6.m6.2.2.cmml"><mi id="S2.SS2.p2.6.m6.2.2.3" xref="S2.SS2.p2.6.m6.2.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.6.m6.2.2.2" xref="S2.SS2.p2.6.m6.2.2.2.cmml">​</mo><mrow id="S2.SS2.p2.6.m6.2.2.1.1" xref="S2.SS2.p2.6.m6.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.6.m6.2.2.1.1.2" xref="S2.SS2.p2.6.m6.2.2.1.2.cmml">(</mo><msub id="S2.SS2.p2.6.m6.2.2.1.1.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.cmml"><mover accent="true" id="S2.SS2.p2.6.m6.2.2.1.1.1.2" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2.cmml"><mi id="S2.SS2.p2.6.m6.2.2.1.1.1.2.2" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2.2.cmml">D</mi><mo id="S2.SS2.p2.6.m6.2.2.1.1.1.2.1" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2.1.cmml">~</mo></mover><mi id="S2.SS2.p2.6.m6.2.2.1.1.1.3" xref="S2.SS2.p2.6.m6.2.2.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS2.p2.6.m6.2.2.1.1.3" xref="S2.SS2.p2.6.m6.2.2.1.2.cmml">,</mo><mover accent="true" id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mi id="S2.SS2.p2.6.m6.1.1.2" xref="S2.SS2.p2.6.m6.1.1.2.cmml">D</mi><mo id="S2.SS2.p2.6.m6.1.1.1" xref="S2.SS2.p2.6.m6.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S2.SS2.p2.6.m6.2.2.1.1.4" xref="S2.SS2.p2.6.m6.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.2b"><apply id="S2.SS2.p2.6.m6.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2"><times id="S2.SS2.p2.6.m6.2.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2.2"></times><ci id="S2.SS2.p2.6.m6.2.2.3.cmml" xref="S2.SS2.p2.6.m6.2.2.3">𝑑</ci><interval closure="open" id="S2.SS2.p2.6.m6.2.2.1.2.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1"><apply id="S2.SS2.p2.6.m6.2.2.1.1.1.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1">subscript</csymbol><apply id="S2.SS2.p2.6.m6.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2"><ci id="S2.SS2.p2.6.m6.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2.1">~</ci><ci id="S2.SS2.p2.6.m6.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1.2.2">𝐷</ci></apply><ci id="S2.SS2.p2.6.m6.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.6.m6.2.2.1.1.1.3">𝑘</ci></apply><apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1"><ci id="S2.SS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1.1">~</ci><ci id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2">𝐷</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.2c">d(\tilde{D}_{k},\tilde{D})</annotation></semantics></math>. The divergence increases the risk bound of the aggregated model <math id="S2.SS2.p2.7.m7.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S2.SS2.p2.7.m7.1a"><mi id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><ci id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">h</annotation></semantics></math> on the global domain thus diminishes model quality. SplitAVG was motivated to reduce feature representation divergence, by proposing concatenation operation on representations from selected local client: <math id="S2.SS2.p2.8.m8.1" class="ltx_Math" alttext="\tilde{D}_{k}\leftarrow\{\tilde{D}_{1}\oplus\tilde{D}_{2}...\oplus\tilde{D}_{St}\}" display="inline"><semantics id="S2.SS2.p2.8.m8.1a"><mrow id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml"><msub id="S2.SS2.p2.8.m8.1.1.3" xref="S2.SS2.p2.8.m8.1.1.3.cmml"><mover accent="true" id="S2.SS2.p2.8.m8.1.1.3.2" xref="S2.SS2.p2.8.m8.1.1.3.2.cmml"><mi id="S2.SS2.p2.8.m8.1.1.3.2.2" xref="S2.SS2.p2.8.m8.1.1.3.2.2.cmml">D</mi><mo id="S2.SS2.p2.8.m8.1.1.3.2.1" xref="S2.SS2.p2.8.m8.1.1.3.2.1.cmml">~</mo></mover><mi id="S2.SS2.p2.8.m8.1.1.3.3" xref="S2.SS2.p2.8.m8.1.1.3.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS2.p2.8.m8.1.1.2" xref="S2.SS2.p2.8.m8.1.1.2.cmml">←</mo><mrow id="S2.SS2.p2.8.m8.1.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.8.m8.1.1.1.1.2" xref="S2.SS2.p2.8.m8.1.1.1.2.cmml">{</mo><mrow id="S2.SS2.p2.8.m8.1.1.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.cmml"><msub id="S2.SS2.p2.8.m8.1.1.1.1.1.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.cmml"><mover accent="true" id="S2.SS2.p2.8.m8.1.1.1.1.1.2.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.cmml"><mi id="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.2.cmml">D</mi><mo id="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mn id="S2.SS2.p2.8.m8.1.1.1.1.1.2.3" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.SS2.p2.8.m8.1.1.1.1.1.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.cmml">⊕</mo><mrow id="S2.SS2.p2.8.m8.1.1.1.1.1.3" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.cmml"><msub id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.cmml"><mover accent="true" id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.cmml"><mi id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.2.cmml">D</mi><mo id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.1.cmml">~</mo></mover><mn id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.3" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p2.8.m8.1.1.1.1.1.3.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="S2.SS2.p2.8.m8.1.1.1.1.1.3.3" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.3.cmml">…</mi></mrow><mo id="S2.SS2.p2.8.m8.1.1.1.1.1.1a" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1.cmml">⊕</mo><msub id="S2.SS2.p2.8.m8.1.1.1.1.1.4" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.cmml"><mover accent="true" id="S2.SS2.p2.8.m8.1.1.1.1.1.4.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.cmml"><mi id="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.2.cmml">D</mi><mo id="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.1.cmml">~</mo></mover><mrow id="S2.SS2.p2.8.m8.1.1.1.1.1.4.3" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.cmml"><mi id="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.2" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.1" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.3" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.3.cmml">t</mi></mrow></msub></mrow><mo stretchy="false" id="S2.SS2.p2.8.m8.1.1.1.1.3" xref="S2.SS2.p2.8.m8.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.1b"><apply id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1"><ci id="S2.SS2.p2.8.m8.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.2">←</ci><apply id="S2.SS2.p2.8.m8.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.3.1.cmml" xref="S2.SS2.p2.8.m8.1.1.3">subscript</csymbol><apply id="S2.SS2.p2.8.m8.1.1.3.2.cmml" xref="S2.SS2.p2.8.m8.1.1.3.2"><ci id="S2.SS2.p2.8.m8.1.1.3.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1.3.2.1">~</ci><ci id="S2.SS2.p2.8.m8.1.1.3.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.3.2.2">𝐷</ci></apply><ci id="S2.SS2.p2.8.m8.1.1.3.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3.3">𝑘</ci></apply><set id="S2.SS2.p2.8.m8.1.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1"><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.1">direct-sum</csymbol><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.1.1.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2">subscript</csymbol><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.2"><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.1">~</ci><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.2.2">𝐷</ci></apply><cn type="integer" id="S2.SS2.p2.8.m8.1.1.1.1.1.2.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.2.3">1</cn></apply><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3"><times id="S2.SS2.p2.8.m8.1.1.1.1.1.3.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.1"></times><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2">subscript</csymbol><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2"><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.1">~</ci><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.2.2">𝐷</ci></apply><cn type="integer" id="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.2.3">2</cn></apply><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.3.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.3.3">…</ci></apply><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.4.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.1.1.4.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4">subscript</csymbol><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.2"><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.1">~</ci><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.2.2">𝐷</ci></apply><apply id="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.3"><times id="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.1.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.1"></times><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.2.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.2">𝑆</ci><ci id="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.3.cmml" xref="S2.SS2.p2.8.m8.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.1c">\tilde{D}_{k}\leftarrow\{\tilde{D}_{1}\oplus\tilde{D}_{2}...\oplus\tilde{D}_{St}\}</annotation></semantics></math> at the server sub-network to reduce the distance between the collection to the global feature distribution <math id="S2.SS2.p2.9.m9.1" class="ltx_Math" alttext="\tilde{D}" display="inline"><semantics id="S2.SS2.p2.9.m9.1a"><mover accent="true" id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml"><mi id="S2.SS2.p2.9.m9.1.1.2" xref="S2.SS2.p2.9.m9.1.1.2.cmml">D</mi><mo id="S2.SS2.p2.9.m9.1.1.1" xref="S2.SS2.p2.9.m9.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.1b"><apply id="S2.SS2.p2.9.m9.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1"><ci id="S2.SS2.p2.9.m9.1.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1.1">~</ci><ci id="S2.SS2.p2.9.m9.1.1.2.cmml" xref="S2.SS2.p2.9.m9.1.1.2">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.1c">\tilde{D}</annotation></semantics></math>. With this approach, SplitAVG lowers the upper bound of aggregated model risk <math id="S2.SS2.p2.10.m10.1" class="ltx_Math" alttext="L_{T}(h)" display="inline"><semantics id="S2.SS2.p2.10.m10.1a"><mrow id="S2.SS2.p2.10.m10.1.2" xref="S2.SS2.p2.10.m10.1.2.cmml"><msub id="S2.SS2.p2.10.m10.1.2.2" xref="S2.SS2.p2.10.m10.1.2.2.cmml"><mi id="S2.SS2.p2.10.m10.1.2.2.2" xref="S2.SS2.p2.10.m10.1.2.2.2.cmml">L</mi><mi id="S2.SS2.p2.10.m10.1.2.2.3" xref="S2.SS2.p2.10.m10.1.2.2.3.cmml">T</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS2.p2.10.m10.1.2.1" xref="S2.SS2.p2.10.m10.1.2.1.cmml">​</mo><mrow id="S2.SS2.p2.10.m10.1.2.3.2" xref="S2.SS2.p2.10.m10.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.10.m10.1.2.3.2.1" xref="S2.SS2.p2.10.m10.1.2.cmml">(</mo><mi id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml">h</mi><mo stretchy="false" id="S2.SS2.p2.10.m10.1.2.3.2.2" xref="S2.SS2.p2.10.m10.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.1b"><apply id="S2.SS2.p2.10.m10.1.2.cmml" xref="S2.SS2.p2.10.m10.1.2"><times id="S2.SS2.p2.10.m10.1.2.1.cmml" xref="S2.SS2.p2.10.m10.1.2.1"></times><apply id="S2.SS2.p2.10.m10.1.2.2.cmml" xref="S2.SS2.p2.10.m10.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.1.2.2.1.cmml" xref="S2.SS2.p2.10.m10.1.2.2">subscript</csymbol><ci id="S2.SS2.p2.10.m10.1.2.2.2.cmml" xref="S2.SS2.p2.10.m10.1.2.2.2">𝐿</ci><ci id="S2.SS2.p2.10.m10.1.2.2.3.cmml" xref="S2.SS2.p2.10.m10.1.2.2.3">𝑇</ci></apply><ci id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.1c">L_{T}(h)</annotation></semantics></math> without touching raw data space <math id="S2.SS2.p2.11.m11.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="S2.SS2.p2.11.m11.1a"><msub id="S2.SS2.p2.11.m11.1.1" xref="S2.SS2.p2.11.m11.1.1.cmml"><mi id="S2.SS2.p2.11.m11.1.1.2" xref="S2.SS2.p2.11.m11.1.1.2.cmml">D</mi><mi id="S2.SS2.p2.11.m11.1.1.3" xref="S2.SS2.p2.11.m11.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m11.1b"><apply id="S2.SS2.p2.11.m11.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1">subscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1.2">𝐷</ci><ci id="S2.SS2.p2.11.m11.1.1.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m11.1c">D_{k}</annotation></semantics></math>. It is worth mentioning that according to the bound, cut layer selection in SplitAVG does not affect generalization performance of the final model if <math id="S2.SS2.p2.12.m12.2" class="ltx_Math" alttext="d(\tilde{D}_{k},\tilde{D})" display="inline"><semantics id="S2.SS2.p2.12.m12.2a"><mrow id="S2.SS2.p2.12.m12.2.2" xref="S2.SS2.p2.12.m12.2.2.cmml"><mi id="S2.SS2.p2.12.m12.2.2.3" xref="S2.SS2.p2.12.m12.2.2.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.12.m12.2.2.2" xref="S2.SS2.p2.12.m12.2.2.2.cmml">​</mo><mrow id="S2.SS2.p2.12.m12.2.2.1.1" xref="S2.SS2.p2.12.m12.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS2.p2.12.m12.2.2.1.1.2" xref="S2.SS2.p2.12.m12.2.2.1.2.cmml">(</mo><msub id="S2.SS2.p2.12.m12.2.2.1.1.1" xref="S2.SS2.p2.12.m12.2.2.1.1.1.cmml"><mover accent="true" id="S2.SS2.p2.12.m12.2.2.1.1.1.2" xref="S2.SS2.p2.12.m12.2.2.1.1.1.2.cmml"><mi id="S2.SS2.p2.12.m12.2.2.1.1.1.2.2" xref="S2.SS2.p2.12.m12.2.2.1.1.1.2.2.cmml">D</mi><mo id="S2.SS2.p2.12.m12.2.2.1.1.1.2.1" xref="S2.SS2.p2.12.m12.2.2.1.1.1.2.1.cmml">~</mo></mover><mi id="S2.SS2.p2.12.m12.2.2.1.1.1.3" xref="S2.SS2.p2.12.m12.2.2.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS2.p2.12.m12.2.2.1.1.3" xref="S2.SS2.p2.12.m12.2.2.1.2.cmml">,</mo><mover accent="true" id="S2.SS2.p2.12.m12.1.1" xref="S2.SS2.p2.12.m12.1.1.cmml"><mi id="S2.SS2.p2.12.m12.1.1.2" xref="S2.SS2.p2.12.m12.1.1.2.cmml">D</mi><mo id="S2.SS2.p2.12.m12.1.1.1" xref="S2.SS2.p2.12.m12.1.1.1.cmml">~</mo></mover><mo stretchy="false" id="S2.SS2.p2.12.m12.2.2.1.1.4" xref="S2.SS2.p2.12.m12.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.12.m12.2b"><apply id="S2.SS2.p2.12.m12.2.2.cmml" xref="S2.SS2.p2.12.m12.2.2"><times id="S2.SS2.p2.12.m12.2.2.2.cmml" xref="S2.SS2.p2.12.m12.2.2.2"></times><ci id="S2.SS2.p2.12.m12.2.2.3.cmml" xref="S2.SS2.p2.12.m12.2.2.3">𝑑</ci><interval closure="open" id="S2.SS2.p2.12.m12.2.2.1.2.cmml" xref="S2.SS2.p2.12.m12.2.2.1.1"><apply id="S2.SS2.p2.12.m12.2.2.1.1.1.cmml" xref="S2.SS2.p2.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.12.m12.2.2.1.1.1.1.cmml" xref="S2.SS2.p2.12.m12.2.2.1.1.1">subscript</csymbol><apply id="S2.SS2.p2.12.m12.2.2.1.1.1.2.cmml" xref="S2.SS2.p2.12.m12.2.2.1.1.1.2"><ci id="S2.SS2.p2.12.m12.2.2.1.1.1.2.1.cmml" xref="S2.SS2.p2.12.m12.2.2.1.1.1.2.1">~</ci><ci id="S2.SS2.p2.12.m12.2.2.1.1.1.2.2.cmml" xref="S2.SS2.p2.12.m12.2.2.1.1.1.2.2">𝐷</ci></apply><ci id="S2.SS2.p2.12.m12.2.2.1.1.1.3.cmml" xref="S2.SS2.p2.12.m12.2.2.1.1.1.3">𝑘</ci></apply><apply id="S2.SS2.p2.12.m12.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1"><ci id="S2.SS2.p2.12.m12.1.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1.1">~</ci><ci id="S2.SS2.p2.12.m12.1.1.2.cmml" xref="S2.SS2.p2.12.m12.1.1.2">𝐷</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.12.m12.2c">d(\tilde{D}_{k},\tilde{D})</annotation></semantics></math> is determined, instead, it affects model’s learning ability in extracting knowledge from <math id="S2.SS2.p2.13.m13.1" class="ltx_Math" alttext="\tilde{D}" display="inline"><semantics id="S2.SS2.p2.13.m13.1a"><mover accent="true" id="S2.SS2.p2.13.m13.1.1" xref="S2.SS2.p2.13.m13.1.1.cmml"><mi id="S2.SS2.p2.13.m13.1.1.2" xref="S2.SS2.p2.13.m13.1.1.2.cmml">D</mi><mo id="S2.SS2.p2.13.m13.1.1.1" xref="S2.SS2.p2.13.m13.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.13.m13.1b"><apply id="S2.SS2.p2.13.m13.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1"><ci id="S2.SS2.p2.13.m13.1.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1.1">~</ci><ci id="S2.SS2.p2.13.m13.1.1.2.cmml" xref="S2.SS2.p2.13.m13.1.1.2">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.13.m13.1c">\tilde{D}</annotation></semantics></math> and draw hypothesis. This influence might differ across medical imaging tasks but follow the same empirical conclusion that the earlier cut layer is, the more parameters server sub-network contains to facilitate learning.</p>
</div>
<figure id="S2.F2" class="ltx_figure">
<p id="S2.F2.1" class="ltx_p ltx_align_center"><span id="S2.F2.1.1" class="ltx_text"><img src="/html/2107.02375/assets/picture/architectureV2.png" id="S2.F2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="414" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>SplitAVG-v2: A variant of SplitAVG architecture which does not require local institutions sharing data labels to the central server. </figcaption>
</figure>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>SplitAVG-v2</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">The proposed SplitAVG algorithm includes the process of local institutions sending data labels to the central server, which brings in risks of privacy leaking, especially in tasks with high-dimensional labels. To this end, we introduce SplitAVG-v2, an improved version of SplitAVG by keeping the labels in local institutions to solve the privacy leakage concern raised from label sharing. As the architecture shown in Figure  <a href="#S2.F2" title="Figure 2 ‣ 2.2 Theory analysis for SplitAVG ‣ 2 MATERIALS and METHODS ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we further introduce a split point in the later part of the server network, where output predictions are split into chunks that each chunk of predictions is derived from an institution’s data. Prediction chucks are sent back to corresponding institutions and a scalar loss is computed with local data labels. The server collects institutional losses and generates the final loss and gradients.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p">SplitAVG-v2 does not require institutions to share raw data or raw labels, while retaining SplitAVG’s essence in generating unbiased gradients from collected loss. To illustrate, we take cross entropy loss as example. The traditional cross entropy in central server of SplitAVG is defined as:</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{CE}=-\sum_{i=1}^{N}[\sum_{c=1}^{C}t_{ic}log(p_{i}c)]" display="block"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml"><msub id="S2.E1.m1.1.1.3" xref="S2.E1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.3.2" xref="S2.E1.m1.1.1.3.2.cmml">ℒ</mi><mrow id="S2.E1.m1.1.1.3.3" xref="S2.E1.m1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.3.3.2" xref="S2.E1.m1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.3.3.1" xref="S2.E1.m1.1.1.3.3.1.cmml">​</mo><mi id="S2.E1.m1.1.1.3.3.3" xref="S2.E1.m1.1.1.3.3.3.cmml">E</mi></mrow></msub><mo id="S2.E1.m1.1.1.2" xref="S2.E1.m1.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1a" xref="S2.E1.m1.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><munderover id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E1.m1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.2.2.3.2" xref="S2.E1.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E1.m1.1.1.1.1.2.2.3.1" xref="S2.E1.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.1.1.1.1.2.2.3.3" xref="S2.E1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.cmml"><munderover id="S2.E1.m1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.2.cmml"><mo lspace="0em" movablelimits="false" id="S2.E1.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.1" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3.cmml">C</mi></munderover><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.4" xref="S2.E1.m1.1.1.1.1.1.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.2a" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.5" xref="S2.E1.m1.1.1.1.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.2b" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.6" xref="S2.E1.m1.1.1.1.1.1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.2c" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><eq id="S2.E1.m1.1.1.2.cmml" xref="S2.E1.m1.1.1.2"></eq><apply id="S2.E1.m1.1.1.3.cmml" xref="S2.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.3.2">ℒ</ci><apply id="S2.E1.m1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.3.3"><times id="S2.E1.m1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.3.3.1"></times><ci id="S2.E1.m1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.3.3.2">𝐶</ci><ci id="S2.E1.m1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.3.3.3">𝐸</ci></apply></apply><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><minus id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1"></minus><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.3"><eq id="S2.E1.m1.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.3"><eq id="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.2.3">𝐶</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.4">𝑙</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.5.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.5">𝑜</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.6.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.6">𝑔</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\mathcal{L}_{CE}=-\sum_{i=1}^{N}[\sum_{c=1}^{C}t_{ic}log(p_{i}c)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p3.6" class="ltx_p">, where <math id="S2.SS3.p3.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS3.p3.1.m1.1a"><mi id="S2.SS3.p3.1.m1.1.1" xref="S2.SS3.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.m1.1b"><ci id="S2.SS3.p3.1.m1.1.1.cmml" xref="S2.SS3.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.m1.1c">N</annotation></semantics></math> is the number of data points, <math id="S2.SS3.p3.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.SS3.p3.2.m2.1a"><mi id="S2.SS3.p3.2.m2.1.1" xref="S2.SS3.p3.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m2.1b"><ci id="S2.SS3.p3.2.m2.1.1.cmml" xref="S2.SS3.p3.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m2.1c">C</annotation></semantics></math> is is the number of classes, <math id="S2.SS3.p3.3.m3.1" class="ltx_Math" alttext="t_{ic}" display="inline"><semantics id="S2.SS3.p3.3.m3.1a"><msub id="S2.SS3.p3.3.m3.1.1" xref="S2.SS3.p3.3.m3.1.1.cmml"><mi id="S2.SS3.p3.3.m3.1.1.2" xref="S2.SS3.p3.3.m3.1.1.2.cmml">t</mi><mrow id="S2.SS3.p3.3.m3.1.1.3" xref="S2.SS3.p3.3.m3.1.1.3.cmml"><mi id="S2.SS3.p3.3.m3.1.1.3.2" xref="S2.SS3.p3.3.m3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.3.m3.1.1.3.1" xref="S2.SS3.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S2.SS3.p3.3.m3.1.1.3.3" xref="S2.SS3.p3.3.m3.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m3.1b"><apply id="S2.SS3.p3.3.m3.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.3.m3.1.1.1.cmml" xref="S2.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p3.3.m3.1.1.2.cmml" xref="S2.SS3.p3.3.m3.1.1.2">𝑡</ci><apply id="S2.SS3.p3.3.m3.1.1.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3"><times id="S2.SS3.p3.3.m3.1.1.3.1.cmml" xref="S2.SS3.p3.3.m3.1.1.3.1"></times><ci id="S2.SS3.p3.3.m3.1.1.3.2.cmml" xref="S2.SS3.p3.3.m3.1.1.3.2">𝑖</ci><ci id="S2.SS3.p3.3.m3.1.1.3.3.cmml" xref="S2.SS3.p3.3.m3.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m3.1c">t_{ic}</annotation></semantics></math> is the true label and <math id="S2.SS3.p3.4.m4.1" class="ltx_Math" alttext="p_{ic}" display="inline"><semantics id="S2.SS3.p3.4.m4.1a"><msub id="S2.SS3.p3.4.m4.1.1" xref="S2.SS3.p3.4.m4.1.1.cmml"><mi id="S2.SS3.p3.4.m4.1.1.2" xref="S2.SS3.p3.4.m4.1.1.2.cmml">p</mi><mrow id="S2.SS3.p3.4.m4.1.1.3" xref="S2.SS3.p3.4.m4.1.1.3.cmml"><mi id="S2.SS3.p3.4.m4.1.1.3.2" xref="S2.SS3.p3.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p3.4.m4.1.1.3.1" xref="S2.SS3.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS3.p3.4.m4.1.1.3.3" xref="S2.SS3.p3.4.m4.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m4.1b"><apply id="S2.SS3.p3.4.m4.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m4.1.1.1.cmml" xref="S2.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p3.4.m4.1.1.2.cmml" xref="S2.SS3.p3.4.m4.1.1.2">𝑝</ci><apply id="S2.SS3.p3.4.m4.1.1.3.cmml" xref="S2.SS3.p3.4.m4.1.1.3"><times id="S2.SS3.p3.4.m4.1.1.3.1.cmml" xref="S2.SS3.p3.4.m4.1.1.3.1"></times><ci id="S2.SS3.p3.4.m4.1.1.3.2.cmml" xref="S2.SS3.p3.4.m4.1.1.3.2">𝑖</ci><ci id="S2.SS3.p3.4.m4.1.1.3.3.cmml" xref="S2.SS3.p3.4.m4.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m4.1c">p_{ic}</annotation></semantics></math> is the SoftMax probability of class <math id="S2.SS3.p3.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S2.SS3.p3.5.m5.1a"><mi id="S2.SS3.p3.5.m5.1.1" xref="S2.SS3.p3.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m5.1b"><ci id="S2.SS3.p3.5.m5.1.1.cmml" xref="S2.SS3.p3.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m5.1c">c</annotation></semantics></math> at data point <math id="S2.SS3.p3.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.p3.6.m6.1a"><mi id="S2.SS3.p3.6.m6.1.1" xref="S2.SS3.p3.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m6.1b"><ci id="S2.SS3.p3.6.m6.1.1.cmml" xref="S2.SS3.p3.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m6.1c">i</annotation></semantics></math>.</p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.6" class="ltx_p">In SplitAVG-v2, we defined an institutional cross-entropy:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\mathcal{L}_{CE_{k}}=-\sum_{i=1}^{N_{k}}\sum_{c=1}^{C}t_{ic}log(p_{i}c)" display="block"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><msub id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.3.2" xref="S2.E2.m1.1.1.3.2.cmml">ℒ</mi><mrow id="S2.E2.m1.1.1.3.3" xref="S2.E2.m1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.3.3.2" xref="S2.E2.m1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.3.3.1" xref="S2.E2.m1.1.1.3.3.1.cmml">​</mo><msub id="S2.E2.m1.1.1.3.3.3" xref="S2.E2.m1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.1.1.3.3.3.2" xref="S2.E2.m1.1.1.3.3.3.2.cmml">E</mi><mi id="S2.E2.m1.1.1.3.3.3.3" xref="S2.E2.m1.1.1.3.3.3.3.cmml">k</mi></msub></mrow></msub><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1a" xref="S2.E2.m1.1.1.1.cmml">−</mo><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><munderover id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E2.m1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.2.2.3.2" xref="S2.E2.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E2.m1.1.1.1.1.2.2.3.1" xref="S2.E2.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.1.1.1.1.2.2.3.3" xref="S2.E2.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E2.m1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.2.3.2" xref="S2.E2.m1.1.1.1.1.2.3.2.cmml">N</mi><mi id="S2.E2.m1.1.1.1.1.2.3.3" xref="S2.E2.m1.1.1.1.1.2.3.3.cmml">k</mi></msub></munderover><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><munderover id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E2.m1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2.2.3.2" xref="S2.E2.m1.1.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="S2.E2.m1.1.1.1.1.1.2.2.3.1" xref="S2.E2.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.1.1.1.1.1.2.2.3.3" xref="S2.E2.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.2.3.cmml">C</mi></munderover><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mrow id="S2.E2.m1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E2.m1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.1.1.3.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E2.m1.1.1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.2a" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E2.m1.1.1.1.1.1.1.5" xref="S2.E2.m1.1.1.1.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.2b" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S2.E2.m1.1.1.1.1.1.1.6" xref="S2.E2.m1.1.1.1.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.2c" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></eq><apply id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.3.2">ℒ</ci><apply id="S2.E2.m1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.3.3"><times id="S2.E2.m1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.3.3.1"></times><ci id="S2.E2.m1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.3.3.2">𝐶</ci><apply id="S2.E2.m1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.E2.m1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.1.1.3.3.3.2">𝐸</ci><ci id="S2.E2.m1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><minus id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1"></minus><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.3"><eq id="S2.E2.m1.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.3.2">𝑁</ci><ci id="S2.E2.m1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.3"><eq id="S2.E2.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.2.3">𝐶</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2">𝑡</ci><apply id="S2.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3"><times id="S2.E2.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E2.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3.2">𝑖</ci><ci id="S2.E2.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3.3">𝑐</ci></apply></apply><ci id="S2.E2.m1.1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.4">𝑙</ci><ci id="S2.E2.m1.1.1.1.1.1.1.5.cmml" xref="S2.E2.m1.1.1.1.1.1.1.5">𝑜</ci><ci id="S2.E2.m1.1.1.1.1.1.1.6.cmml" xref="S2.E2.m1.1.1.1.1.1.1.6">𝑔</ci><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\mathcal{L}_{CE_{k}}=-\sum_{i=1}^{N_{k}}\sum_{c=1}^{C}t_{ic}log(p_{i}c)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p4.5" class="ltx_p">, where <math id="S2.SS3.p4.1.m1.1" class="ltx_Math" alttext="N_{k}" display="inline"><semantics id="S2.SS3.p4.1.m1.1a"><msub id="S2.SS3.p4.1.m1.1.1" xref="S2.SS3.p4.1.m1.1.1.cmml"><mi id="S2.SS3.p4.1.m1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.2.cmml">N</mi><mi id="S2.SS3.p4.1.m1.1.1.3" xref="S2.SS3.p4.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.1b"><apply id="S2.SS3.p4.1.m1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p4.1.m1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.2">𝑁</ci><ci id="S2.SS3.p4.1.m1.1.1.3.cmml" xref="S2.SS3.p4.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.1c">N_{k}</annotation></semantics></math> is the number of data points at the <math id="S2.SS3.p4.2.m2.1" class="ltx_Math" alttext="k^{th}" display="inline"><semantics id="S2.SS3.p4.2.m2.1a"><msup id="S2.SS3.p4.2.m2.1.1" xref="S2.SS3.p4.2.m2.1.1.cmml"><mi id="S2.SS3.p4.2.m2.1.1.2" xref="S2.SS3.p4.2.m2.1.1.2.cmml">k</mi><mrow id="S2.SS3.p4.2.m2.1.1.3" xref="S2.SS3.p4.2.m2.1.1.3.cmml"><mi id="S2.SS3.p4.2.m2.1.1.3.2" xref="S2.SS3.p4.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p4.2.m2.1.1.3.1" xref="S2.SS3.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S2.SS3.p4.2.m2.1.1.3.3" xref="S2.SS3.p4.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.2.m2.1b"><apply id="S2.SS3.p4.2.m2.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.2.m2.1.1.1.cmml" xref="S2.SS3.p4.2.m2.1.1">superscript</csymbol><ci id="S2.SS3.p4.2.m2.1.1.2.cmml" xref="S2.SS3.p4.2.m2.1.1.2">𝑘</ci><apply id="S2.SS3.p4.2.m2.1.1.3.cmml" xref="S2.SS3.p4.2.m2.1.1.3"><times id="S2.SS3.p4.2.m2.1.1.3.1.cmml" xref="S2.SS3.p4.2.m2.1.1.3.1"></times><ci id="S2.SS3.p4.2.m2.1.1.3.2.cmml" xref="S2.SS3.p4.2.m2.1.1.3.2">𝑡</ci><ci id="S2.SS3.p4.2.m2.1.1.3.3.cmml" xref="S2.SS3.p4.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.2.m2.1c">k^{th}</annotation></semantics></math> client. <math id="S2.SS3.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{CE_{k}}" display="inline"><semantics id="S2.SS3.p4.3.m3.1a"><msub id="S2.SS3.p4.3.m3.1.1" xref="S2.SS3.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS3.p4.3.m3.1.1.2" xref="S2.SS3.p4.3.m3.1.1.2.cmml">ℒ</mi><mrow id="S2.SS3.p4.3.m3.1.1.3" xref="S2.SS3.p4.3.m3.1.1.3.cmml"><mi id="S2.SS3.p4.3.m3.1.1.3.2" xref="S2.SS3.p4.3.m3.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p4.3.m3.1.1.3.1" xref="S2.SS3.p4.3.m3.1.1.3.1.cmml">​</mo><msub id="S2.SS3.p4.3.m3.1.1.3.3" xref="S2.SS3.p4.3.m3.1.1.3.3.cmml"><mi id="S2.SS3.p4.3.m3.1.1.3.3.2" xref="S2.SS3.p4.3.m3.1.1.3.3.2.cmml">E</mi><mi id="S2.SS3.p4.3.m3.1.1.3.3.3" xref="S2.SS3.p4.3.m3.1.1.3.3.3.cmml">k</mi></msub></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.3.m3.1b"><apply id="S2.SS3.p4.3.m3.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.3.m3.1.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p4.3.m3.1.1.2.cmml" xref="S2.SS3.p4.3.m3.1.1.2">ℒ</ci><apply id="S2.SS3.p4.3.m3.1.1.3.cmml" xref="S2.SS3.p4.3.m3.1.1.3"><times id="S2.SS3.p4.3.m3.1.1.3.1.cmml" xref="S2.SS3.p4.3.m3.1.1.3.1"></times><ci id="S2.SS3.p4.3.m3.1.1.3.2.cmml" xref="S2.SS3.p4.3.m3.1.1.3.2">𝐶</ci><apply id="S2.SS3.p4.3.m3.1.1.3.3.cmml" xref="S2.SS3.p4.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS3.p4.3.m3.1.1.3.3.1.cmml" xref="S2.SS3.p4.3.m3.1.1.3.3">subscript</csymbol><ci id="S2.SS3.p4.3.m3.1.1.3.3.2.cmml" xref="S2.SS3.p4.3.m3.1.1.3.3.2">𝐸</ci><ci id="S2.SS3.p4.3.m3.1.1.3.3.3.cmml" xref="S2.SS3.p4.3.m3.1.1.3.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.3.m3.1c">\mathcal{L}_{CE_{k}}</annotation></semantics></math> is independently computed at each local client thus preserves the privacy of label <math id="S2.SS3.p4.4.m4.1" class="ltx_Math" alttext="t_{ic}" display="inline"><semantics id="S2.SS3.p4.4.m4.1a"><msub id="S2.SS3.p4.4.m4.1.1" xref="S2.SS3.p4.4.m4.1.1.cmml"><mi id="S2.SS3.p4.4.m4.1.1.2" xref="S2.SS3.p4.4.m4.1.1.2.cmml">t</mi><mrow id="S2.SS3.p4.4.m4.1.1.3" xref="S2.SS3.p4.4.m4.1.1.3.cmml"><mi id="S2.SS3.p4.4.m4.1.1.3.2" xref="S2.SS3.p4.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p4.4.m4.1.1.3.1" xref="S2.SS3.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="S2.SS3.p4.4.m4.1.1.3.3" xref="S2.SS3.p4.4.m4.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.4.m4.1b"><apply id="S2.SS3.p4.4.m4.1.1.cmml" xref="S2.SS3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.4.m4.1.1.1.cmml" xref="S2.SS3.p4.4.m4.1.1">subscript</csymbol><ci id="S2.SS3.p4.4.m4.1.1.2.cmml" xref="S2.SS3.p4.4.m4.1.1.2">𝑡</ci><apply id="S2.SS3.p4.4.m4.1.1.3.cmml" xref="S2.SS3.p4.4.m4.1.1.3"><times id="S2.SS3.p4.4.m4.1.1.3.1.cmml" xref="S2.SS3.p4.4.m4.1.1.3.1"></times><ci id="S2.SS3.p4.4.m4.1.1.3.2.cmml" xref="S2.SS3.p4.4.m4.1.1.3.2">𝑖</ci><ci id="S2.SS3.p4.4.m4.1.1.3.3.cmml" xref="S2.SS3.p4.4.m4.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.4.m4.1c">t_{ic}</annotation></semantics></math>. The server in SplitAVG-v2 then collects the institutional cross-entropy from all local institutions, resulting in the overall loss <math id="S2.SS3.p4.5.m5.1" class="ltx_Math" alttext="L_{CEK}" display="inline"><semantics id="S2.SS3.p4.5.m5.1a"><msub id="S2.SS3.p4.5.m5.1.1" xref="S2.SS3.p4.5.m5.1.1.cmml"><mi id="S2.SS3.p4.5.m5.1.1.2" xref="S2.SS3.p4.5.m5.1.1.2.cmml">L</mi><mrow id="S2.SS3.p4.5.m5.1.1.3" xref="S2.SS3.p4.5.m5.1.1.3.cmml"><mi id="S2.SS3.p4.5.m5.1.1.3.2" xref="S2.SS3.p4.5.m5.1.1.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p4.5.m5.1.1.3.1" xref="S2.SS3.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S2.SS3.p4.5.m5.1.1.3.3" xref="S2.SS3.p4.5.m5.1.1.3.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p4.5.m5.1.1.3.1a" xref="S2.SS3.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S2.SS3.p4.5.m5.1.1.3.4" xref="S2.SS3.p4.5.m5.1.1.3.4.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.5.m5.1b"><apply id="S2.SS3.p4.5.m5.1.1.cmml" xref="S2.SS3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.5.m5.1.1.1.cmml" xref="S2.SS3.p4.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.p4.5.m5.1.1.2.cmml" xref="S2.SS3.p4.5.m5.1.1.2">𝐿</ci><apply id="S2.SS3.p4.5.m5.1.1.3.cmml" xref="S2.SS3.p4.5.m5.1.1.3"><times id="S2.SS3.p4.5.m5.1.1.3.1.cmml" xref="S2.SS3.p4.5.m5.1.1.3.1"></times><ci id="S2.SS3.p4.5.m5.1.1.3.2.cmml" xref="S2.SS3.p4.5.m5.1.1.3.2">𝐶</ci><ci id="S2.SS3.p4.5.m5.1.1.3.3.cmml" xref="S2.SS3.p4.5.m5.1.1.3.3">𝐸</ci><ci id="S2.SS3.p4.5.m5.1.1.3.4.cmml" xref="S2.SS3.p4.5.m5.1.1.3.4">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.5.m5.1c">L_{CEK}</annotation></semantics></math> as:</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.2" class="ltx_Math" alttext="\mathcal{L}_{CEK}=\sum_{k=1}^{K}\mathcal{L}_{CE_{k}}=-[\sum_{k=1}^{K}\sum_{i=1}^{N_{k}}][\sum_{c=1}^{C}t_{ic}log(p_{i}c)]=\mathcal{L}_{CE}" display="block"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><msub id="S2.E3.m1.2.2.4" xref="S2.E3.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.4.2" xref="S2.E3.m1.2.2.4.2.cmml">ℒ</mi><mrow id="S2.E3.m1.2.2.4.3" xref="S2.E3.m1.2.2.4.3.cmml"><mi id="S2.E3.m1.2.2.4.3.2" xref="S2.E3.m1.2.2.4.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.4.3.1" xref="S2.E3.m1.2.2.4.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.4.3.3" xref="S2.E3.m1.2.2.4.3.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.4.3.1a" xref="S2.E3.m1.2.2.4.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.4.3.4" xref="S2.E3.m1.2.2.4.3.4.cmml">K</mi></mrow></msub><mo rspace="0.111em" id="S2.E3.m1.2.2.5" xref="S2.E3.m1.2.2.5.cmml">=</mo><mrow id="S2.E3.m1.2.2.6" xref="S2.E3.m1.2.2.6.cmml"><munderover id="S2.E3.m1.2.2.6.1" xref="S2.E3.m1.2.2.6.1.cmml"><mo movablelimits="false" id="S2.E3.m1.2.2.6.1.2.2" xref="S2.E3.m1.2.2.6.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.6.1.2.3" xref="S2.E3.m1.2.2.6.1.2.3.cmml"><mi id="S2.E3.m1.2.2.6.1.2.3.2" xref="S2.E3.m1.2.2.6.1.2.3.2.cmml">k</mi><mo id="S2.E3.m1.2.2.6.1.2.3.1" xref="S2.E3.m1.2.2.6.1.2.3.1.cmml">=</mo><mn id="S2.E3.m1.2.2.6.1.2.3.3" xref="S2.E3.m1.2.2.6.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.2.2.6.1.3" xref="S2.E3.m1.2.2.6.1.3.cmml">K</mi></munderover><msub id="S2.E3.m1.2.2.6.2" xref="S2.E3.m1.2.2.6.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.6.2.2" xref="S2.E3.m1.2.2.6.2.2.cmml">ℒ</mi><mrow id="S2.E3.m1.2.2.6.2.3" xref="S2.E3.m1.2.2.6.2.3.cmml"><mi id="S2.E3.m1.2.2.6.2.3.2" xref="S2.E3.m1.2.2.6.2.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.6.2.3.1" xref="S2.E3.m1.2.2.6.2.3.1.cmml">​</mo><msub id="S2.E3.m1.2.2.6.2.3.3" xref="S2.E3.m1.2.2.6.2.3.3.cmml"><mi id="S2.E3.m1.2.2.6.2.3.3.2" xref="S2.E3.m1.2.2.6.2.3.3.2.cmml">E</mi><mi id="S2.E3.m1.2.2.6.2.3.3.3" xref="S2.E3.m1.2.2.6.2.3.3.3.cmml">k</mi></msub></mrow></msub></mrow><mo id="S2.E3.m1.2.2.7" xref="S2.E3.m1.2.2.7.cmml">=</mo><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><mo id="S2.E3.m1.2.2.2a" xref="S2.E3.m1.2.2.2.cmml">−</mo><mrow id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.cmml"><munderover id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" movablelimits="false" rspace="0em" id="S2.E3.m1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">=</mo><mn id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml">K</mi></munderover><munderover id="S2.E3.m1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S2.E3.m1.1.1.1.1.1.1.1.2.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.2.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E3.m1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.2.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3.2.cmml">N</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.2.3.3" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3.3.cmml">k</mi></msub></munderover></mrow><mo stretchy="false" id="S2.E3.m1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.3.cmml">​</mo><mrow id="S2.E3.m1.2.2.2.2.2.1" xref="S2.E3.m1.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.2.2.2.1.2" xref="S2.E3.m1.2.2.2.2.2.2.1.cmml">[</mo><mrow id="S2.E3.m1.2.2.2.2.2.1.1" xref="S2.E3.m1.2.2.2.2.2.1.1.cmml"><munderover id="S2.E3.m1.2.2.2.2.2.1.1.2" xref="S2.E3.m1.2.2.2.2.2.1.1.2.cmml"><mo lspace="0em" movablelimits="false" id="S2.E3.m1.2.2.2.2.2.1.1.2.2.2" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.2.2.2.1.1.2.2.3" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.cmml"><mi id="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.2" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.2.cmml">c</mi><mo id="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.1" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.3" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.2.2.2.2.2.1.1.2.3" xref="S2.E3.m1.2.2.2.2.2.1.1.2.3.cmml">C</mi></munderover><mrow id="S2.E3.m1.2.2.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.2.2.1.1.1.cmml"><msub id="S2.E3.m1.2.2.2.2.2.1.1.1.3" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.3.2" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.2.cmml">t</mi><mrow id="S2.E3.m1.2.2.2.2.2.1.1.1.3.3" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.cmml"><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.2" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.1" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.3" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.2.1.1.1.2" xref="S2.E3.m1.2.2.2.2.2.1.1.1.2.cmml">​</mo><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.4" xref="S2.E3.m1.2.2.2.2.2.1.1.1.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.2.1.1.1.2a" xref="S2.E3.m1.2.2.2.2.2.1.1.1.2.cmml">​</mo><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.5" xref="S2.E3.m1.2.2.2.2.2.1.1.1.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.2.1.1.1.2b" xref="S2.E3.m1.2.2.2.2.2.1.1.1.2.cmml">​</mo><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.6" xref="S2.E3.m1.2.2.2.2.2.1.1.1.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.2.1.1.1.2c" xref="S2.E3.m1.2.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.2" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.3" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml">​</mo><mi id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E3.m1.2.2.2.2.2.1.3" xref="S2.E3.m1.2.2.2.2.2.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.8" xref="S2.E3.m1.2.2.8.cmml">=</mo><msub id="S2.E3.m1.2.2.9" xref="S2.E3.m1.2.2.9.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.9.2" xref="S2.E3.m1.2.2.9.2.cmml">ℒ</mi><mrow id="S2.E3.m1.2.2.9.3" xref="S2.E3.m1.2.2.9.3.cmml"><mi id="S2.E3.m1.2.2.9.3.2" xref="S2.E3.m1.2.2.9.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.9.3.1" xref="S2.E3.m1.2.2.9.3.1.cmml">​</mo><mi id="S2.E3.m1.2.2.9.3.3" xref="S2.E3.m1.2.2.9.3.3.cmml">E</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><and id="S2.E3.m1.2.2a.cmml" xref="S2.E3.m1.2.2"></and><apply id="S2.E3.m1.2.2b.cmml" xref="S2.E3.m1.2.2"><eq id="S2.E3.m1.2.2.5.cmml" xref="S2.E3.m1.2.2.5"></eq><apply id="S2.E3.m1.2.2.4.cmml" xref="S2.E3.m1.2.2.4"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.4.1.cmml" xref="S2.E3.m1.2.2.4">subscript</csymbol><ci id="S2.E3.m1.2.2.4.2.cmml" xref="S2.E3.m1.2.2.4.2">ℒ</ci><apply id="S2.E3.m1.2.2.4.3.cmml" xref="S2.E3.m1.2.2.4.3"><times id="S2.E3.m1.2.2.4.3.1.cmml" xref="S2.E3.m1.2.2.4.3.1"></times><ci id="S2.E3.m1.2.2.4.3.2.cmml" xref="S2.E3.m1.2.2.4.3.2">𝐶</ci><ci id="S2.E3.m1.2.2.4.3.3.cmml" xref="S2.E3.m1.2.2.4.3.3">𝐸</ci><ci id="S2.E3.m1.2.2.4.3.4.cmml" xref="S2.E3.m1.2.2.4.3.4">𝐾</ci></apply></apply><apply id="S2.E3.m1.2.2.6.cmml" xref="S2.E3.m1.2.2.6"><apply id="S2.E3.m1.2.2.6.1.cmml" xref="S2.E3.m1.2.2.6.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.6.1.1.cmml" xref="S2.E3.m1.2.2.6.1">superscript</csymbol><apply id="S2.E3.m1.2.2.6.1.2.cmml" xref="S2.E3.m1.2.2.6.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.6.1.2.1.cmml" xref="S2.E3.m1.2.2.6.1">subscript</csymbol><sum id="S2.E3.m1.2.2.6.1.2.2.cmml" xref="S2.E3.m1.2.2.6.1.2.2"></sum><apply id="S2.E3.m1.2.2.6.1.2.3.cmml" xref="S2.E3.m1.2.2.6.1.2.3"><eq id="S2.E3.m1.2.2.6.1.2.3.1.cmml" xref="S2.E3.m1.2.2.6.1.2.3.1"></eq><ci id="S2.E3.m1.2.2.6.1.2.3.2.cmml" xref="S2.E3.m1.2.2.6.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E3.m1.2.2.6.1.2.3.3.cmml" xref="S2.E3.m1.2.2.6.1.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.2.2.6.1.3.cmml" xref="S2.E3.m1.2.2.6.1.3">𝐾</ci></apply><apply id="S2.E3.m1.2.2.6.2.cmml" xref="S2.E3.m1.2.2.6.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.6.2.1.cmml" xref="S2.E3.m1.2.2.6.2">subscript</csymbol><ci id="S2.E3.m1.2.2.6.2.2.cmml" xref="S2.E3.m1.2.2.6.2.2">ℒ</ci><apply id="S2.E3.m1.2.2.6.2.3.cmml" xref="S2.E3.m1.2.2.6.2.3"><times id="S2.E3.m1.2.2.6.2.3.1.cmml" xref="S2.E3.m1.2.2.6.2.3.1"></times><ci id="S2.E3.m1.2.2.6.2.3.2.cmml" xref="S2.E3.m1.2.2.6.2.3.2">𝐶</ci><apply id="S2.E3.m1.2.2.6.2.3.3.cmml" xref="S2.E3.m1.2.2.6.2.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.6.2.3.3.1.cmml" xref="S2.E3.m1.2.2.6.2.3.3">subscript</csymbol><ci id="S2.E3.m1.2.2.6.2.3.3.2.cmml" xref="S2.E3.m1.2.2.6.2.3.3.2">𝐸</ci><ci id="S2.E3.m1.2.2.6.2.3.3.3.cmml" xref="S2.E3.m1.2.2.6.2.3.3.3">𝑘</ci></apply></apply></apply></apply></apply><apply id="S2.E3.m1.2.2c.cmml" xref="S2.E3.m1.2.2"><eq id="S2.E3.m1.2.2.7.cmml" xref="S2.E3.m1.2.2.7"></eq><share href="#S2.E3.m1.2.2.6.cmml" id="S2.E3.m1.2.2d.cmml" xref="S2.E3.m1.2.2"></share><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><minus id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2"></minus><apply id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"><times id="S2.E3.m1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3"></times><apply id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><sum id="S2.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.2"></sum><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3"><eq id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.1"></eq><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3">𝐾</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.3"><eq id="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E3.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3.2">𝑁</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S2.E3.m1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S2.E3.m1.2.2.2.2.2.1.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1"><apply id="S2.E3.m1.2.2.2.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.2.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2">superscript</csymbol><apply id="S2.E3.m1.2.2.2.2.2.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.2.1.1.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2">subscript</csymbol><sum id="S2.E3.m1.2.2.2.2.2.1.1.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.2"></sum><apply id="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.3"><eq id="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.1"></eq><ci id="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.3.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.2.2.2.2.2.1.1.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.2.3">𝐶</ci></apply><apply id="S2.E3.m1.2.2.2.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1"><times id="S2.E3.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.2"></times><apply id="S2.E3.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.2">𝑡</ci><apply id="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.3"><times id="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.1"></times><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.2">𝑖</ci><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.3.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.3.3.3">𝑐</ci></apply></apply><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.4.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.4">𝑙</ci><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.5.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.5">𝑜</ci><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.6.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.6">𝑔</ci><apply id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1"><times id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.1"></times><apply id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.2">𝑝</ci><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.2.2.2.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S2.E3.m1.2.2e.cmml" xref="S2.E3.m1.2.2"><eq id="S2.E3.m1.2.2.8.cmml" xref="S2.E3.m1.2.2.8"></eq><share href="#S2.E3.m1.2.2.2.cmml" id="S2.E3.m1.2.2f.cmml" xref="S2.E3.m1.2.2"></share><apply id="S2.E3.m1.2.2.9.cmml" xref="S2.E3.m1.2.2.9"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.9.1.cmml" xref="S2.E3.m1.2.2.9">subscript</csymbol><ci id="S2.E3.m1.2.2.9.2.cmml" xref="S2.E3.m1.2.2.9.2">ℒ</ci><apply id="S2.E3.m1.2.2.9.3.cmml" xref="S2.E3.m1.2.2.9.3"><times id="S2.E3.m1.2.2.9.3.1.cmml" xref="S2.E3.m1.2.2.9.3.1"></times><ci id="S2.E3.m1.2.2.9.3.2.cmml" xref="S2.E3.m1.2.2.9.3.2">𝐶</ci><ci id="S2.E3.m1.2.2.9.3.3.cmml" xref="S2.E3.m1.2.2.9.3.3">𝐸</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\mathcal{L}_{CEK}=\sum_{k=1}^{K}\mathcal{L}_{CE_{k}}=-[\sum_{k=1}^{K}\sum_{i=1}^{N_{k}}][\sum_{c=1}^{C}t_{ic}log(p_{i}c)]=\mathcal{L}_{CE}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS3.p4.7" class="ltx_p">Even though a split point is introduced in SplitAVG-v2, the overall loss of SplitAVG-v2 is the same to the SplitAVG. Thus SplitAVG-v2 and SplitAVG will have the same experimental results if a same experimental setting is used for both models. We further tested SplitAVG-v2 on split 4 of Retina dataset, and obtained the identical results, mean accuracy of 76.5%, with the SplitAVG result.</p>
</div>
</section>
<section id="S2.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4 </span>Dataset and data partitions</h3>

<div id="S2.SS4.p1" class="ltx_para">
<p id="S2.SS4.p1.1" class="ltx_p">We evaluate our method on a set of both synthetic and real-world federated datasets, including the simulated federated datasets by artificially introducing data heterogeneity on a Diabetic Retinopathy (Retina) binary classification dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and a Bone Age (BoneAge) prediction dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, and the real-world federated Brain Tumor Segmentation (BraTS 2017) segmentation dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>:</p>
</div>
<div id="S2.SS4.p2" class="ltx_para">
<p id="S2.SS4.p2.1" class="ltx_p">The Retina dataset consists of 44 351 pairs of left and right eye color digital retinal fundus images obtained from the Kaggle Diabetic Retinopathy competition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Each image is labeled on a scale of 0-4 based on the disease severity of diabetic retinopathy (DR), where 0 indicates no DR, and 1-4 represent mild, moderate, severe, and proliferative DR, respectively. We binarize the image labels to Healthy (scale 0) and Diseased (scale 2, 3 or 4) to simplify model training, and the mild DR (scale 1) images were excluded <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Furthermore, we only utilize left eye images to avoid the possible confusion from inconsistent correlation between disease presence in left/right eyes. The dataset is randomly sampled to create a training set of 6000 images, a validation set of 3000 images, and a testing set of 3000 images. The images are pre-processed following Ben Graham’s methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>: rescaled to a radius of 300, subtracting the local average color, image clipping for boundary removal, and resized to 256 x 256 resolution. Random cropping (to 224 x 224), random rotations (0, 90, 180, or 270 degrees) and horizontal flips were applied for data augmentation.</p>
</div>
<div id="S2.SS4.p3" class="ltx_para">
<p id="S2.SS4.p3.1" class="ltx_p">The BoneAge dataset consists of 14 236 pediatric hand radiographs obtained from the Kaggle Radiological Society of North America (RSNA) Bone Age competition <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. Each image is labeled with the skeletal age provided by expert reviewers. The dataset is randomly sampled to create a training set of 4572 images, a validation set of 1000 images, and a testing set of 1000 images.</p>
</div>
<div id="S2.SS4.p4" class="ltx_para">
<p id="S2.SS4.p4.1" class="ltx_p">We simulate four “institutions” and create four kinds of data partitions for both the Retina and BoneAge datasets: one homogenous data partition, and three heterogeneous data partitions with label distribution skew. The degree of label distribution skew is controlled by the fraction of non-IID data and is scaled by the mean Kolmogorov-Smirnov (K-S) statistic between every two institutions. Specifically, the K-S value being 0 indicates homogeneity and 1 indicates entirely different distributions. Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.4 Dataset and data partitions ‣ 2 MATERIALS and METHODS ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> depicts the detailed data partitions.</p>
</div>
<figure id="S2.F3" class="ltx_figure">
<p id="S2.F3.1" class="ltx_p ltx_align_center"><span id="S2.F3.1.1" class="ltx_text"><img src="/html/2107.02375/assets/picture/Distribution.png" id="S2.F3.1.1.g1" class="ltx_graphics ltx_img_landscape" width="698" height="276" alt="Refer to caption"></span></p>
<br class="ltx_break ltx_break">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Simulated data partitions on Retina and BoneAge datasets to simulate heterogeneity in data among 4 simulated institutions. Data partitions on Retina dataset with (A) KS=0, (B) KS=0.40, (C) KS=0.56 and (D) KS=0.67. Data partitions on BoneAge dataset with (E) KS=0.29, (F) KS=0.59, (G) KS=0.73, (H) KS=0.97.</figcaption>
</figure>
<div id="S2.SS4.p5" class="ltx_para">
<p id="S2.SS4.p5.1" class="ltx_p">The BraTS dataset consists of magnetic resonance imaging (MRI) brain scans of gliomas collected from multiple institutions<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. Each scan is manually labeled with segmentation annotations of tumor regions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. In our experiments, we focus on the segmentation for whole tumor region, and we only use high-grade glioblastoma (HGG) scans in T2 Fluid Attenuated Inversion Recovery (FLAIR) modality. We randomly select scans from 45 subjects as the testing set and the rest scans (120 subjects) as the training set. As a real-world federated dataset, BraTS includes common types of data heterogeneity, i.e., imaging acquisition skew (the scans
are collected from ten institutions with different imaging equipment and protocols), label distribution skew and sample size distribution skew (one institution contributes 69 subjects while some institutions only contribute 4 or 5 subjects).</p>
</div>
</section>
<section id="S2.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5 </span>Comparison methods </h3>

<div id="S2.SS5.p1" class="ltx_para">
<p id="S2.SS5.p1.1" class="ltx_p">We compare our SplitAVG method with seven state-of-the-art federated learning methods including four traditional methods: FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, FedSGD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, CWT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and SplitNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, and three optimized methods proposed for non-IID data: Federated stochastic gradient descent with group normalization (FedSGD+GN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, Federated averaging with server momentum (FedAvgM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and Federated averaging with globally shared data (FedAvg+SD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. We use the performance of a model trained with centrally hosted data as the baseline approach, termed as “centrally hosted”. This represents the ideal situation for training deep learning models since all data are centralized.</p>
</div>
<div id="S2.SS5.p2" class="ltx_para">
<p id="S2.SS5.p2.4" class="ltx_p"><span id="S2.SS5.p2.4.1" class="ltx_text ltx_font_bold">FedAvg</span> is an aggregation-based method. For each epoch, local institutions conduct <math id="S2.SS5.p2.1.m1.1" class="ltx_Math" alttext="\frac{Q_{k}}{B}" display="inline"><semantics id="S2.SS5.p2.1.m1.1a"><mfrac id="S2.SS5.p2.1.m1.1.1" xref="S2.SS5.p2.1.m1.1.1.cmml"><msub id="S2.SS5.p2.1.m1.1.1.2" xref="S2.SS5.p2.1.m1.1.1.2.cmml"><mi id="S2.SS5.p2.1.m1.1.1.2.2" xref="S2.SS5.p2.1.m1.1.1.2.2.cmml">Q</mi><mi id="S2.SS5.p2.1.m1.1.1.2.3" xref="S2.SS5.p2.1.m1.1.1.2.3.cmml">k</mi></msub><mi id="S2.SS5.p2.1.m1.1.1.3" xref="S2.SS5.p2.1.m1.1.1.3.cmml">B</mi></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.1.m1.1b"><apply id="S2.SS5.p2.1.m1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1"><divide id="S2.SS5.p2.1.m1.1.1.1.cmml" xref="S2.SS5.p2.1.m1.1.1"></divide><apply id="S2.SS5.p2.1.m1.1.1.2.cmml" xref="S2.SS5.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS5.p2.1.m1.1.1.2.1.cmml" xref="S2.SS5.p2.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS5.p2.1.m1.1.1.2.2.cmml" xref="S2.SS5.p2.1.m1.1.1.2.2">𝑄</ci><ci id="S2.SS5.p2.1.m1.1.1.2.3.cmml" xref="S2.SS5.p2.1.m1.1.1.2.3">𝑘</ci></apply><ci id="S2.SS5.p2.1.m1.1.1.3.cmml" xref="S2.SS5.p2.1.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.1.m1.1c">\frac{Q_{k}}{B}</annotation></semantics></math> training iterations, then transfer model weights to a central server, which averages the weights and transfers the updated weights back to individual institutions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. <math id="S2.SS5.p2.2.m2.1" class="ltx_Math" alttext="Q_{k}" display="inline"><semantics id="S2.SS5.p2.2.m2.1a"><msub id="S2.SS5.p2.2.m2.1.1" xref="S2.SS5.p2.2.m2.1.1.cmml"><mi id="S2.SS5.p2.2.m2.1.1.2" xref="S2.SS5.p2.2.m2.1.1.2.cmml">Q</mi><mi id="S2.SS5.p2.2.m2.1.1.3" xref="S2.SS5.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.2.m2.1b"><apply id="S2.SS5.p2.2.m2.1.1.cmml" xref="S2.SS5.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS5.p2.2.m2.1.1.1.cmml" xref="S2.SS5.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS5.p2.2.m2.1.1.2.cmml" xref="S2.SS5.p2.2.m2.1.1.2">𝑄</ci><ci id="S2.SS5.p2.2.m2.1.1.3.cmml" xref="S2.SS5.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.2.m2.1c">Q_{k}</annotation></semantics></math> is the quantity of training samples at institution <math id="S2.SS5.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS5.p2.3.m3.1a"><mi id="S2.SS5.p2.3.m3.1.1" xref="S2.SS5.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.3.m3.1b"><ci id="S2.SS5.p2.3.m3.1.1.cmml" xref="S2.SS5.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.3.m3.1c">k</annotation></semantics></math>, and <math id="S2.SS5.p2.4.m4.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S2.SS5.p2.4.m4.1a"><mi id="S2.SS5.p2.4.m4.1.1" xref="S2.SS5.p2.4.m4.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p2.4.m4.1b"><ci id="S2.SS5.p2.4.m4.1.1.cmml" xref="S2.SS5.p2.4.m4.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p2.4.m4.1c">B</annotation></semantics></math> is the local mini-batch size.</p>
</div>
<div id="S2.SS5.p3" class="ltx_para">
<p id="S2.SS5.p3.1" class="ltx_p"><span id="S2.SS5.p3.1.1" class="ltx_text ltx_font_bold">FedSGD</span> is a full-communication version of FedAvg. For each training iteration, local institutions transfer model gradients to a central server, which generates weights updated from aggregated gradients and transfers the updated weights back to individual institutions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="S2.SS5.p4" class="ltx_para">
<p id="S2.SS5.p4.2" class="ltx_p"><span id="S2.SS5.p4.2.1" class="ltx_text ltx_font_bold">CWT</span> is a transfer-based method. For each epoch, local institutions conduct <math id="S2.SS5.p4.1.m1.1" class="ltx_Math" alttext="\frac{Q}{B\times K}" display="inline"><semantics id="S2.SS5.p4.1.m1.1a"><mfrac id="S2.SS5.p4.1.m1.1.1" xref="S2.SS5.p4.1.m1.1.1.cmml"><mi id="S2.SS5.p4.1.m1.1.1.2" xref="S2.SS5.p4.1.m1.1.1.2.cmml">Q</mi><mrow id="S2.SS5.p4.1.m1.1.1.3" xref="S2.SS5.p4.1.m1.1.1.3.cmml"><mi id="S2.SS5.p4.1.m1.1.1.3.2" xref="S2.SS5.p4.1.m1.1.1.3.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS5.p4.1.m1.1.1.3.1" xref="S2.SS5.p4.1.m1.1.1.3.1.cmml">×</mo><mi id="S2.SS5.p4.1.m1.1.1.3.3" xref="S2.SS5.p4.1.m1.1.1.3.3.cmml">K</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS5.p4.1.m1.1b"><apply id="S2.SS5.p4.1.m1.1.1.cmml" xref="S2.SS5.p4.1.m1.1.1"><divide id="S2.SS5.p4.1.m1.1.1.1.cmml" xref="S2.SS5.p4.1.m1.1.1"></divide><ci id="S2.SS5.p4.1.m1.1.1.2.cmml" xref="S2.SS5.p4.1.m1.1.1.2">𝑄</ci><apply id="S2.SS5.p4.1.m1.1.1.3.cmml" xref="S2.SS5.p4.1.m1.1.1.3"><times id="S2.SS5.p4.1.m1.1.1.3.1.cmml" xref="S2.SS5.p4.1.m1.1.1.3.1"></times><ci id="S2.SS5.p4.1.m1.1.1.3.2.cmml" xref="S2.SS5.p4.1.m1.1.1.3.2">𝐵</ci><ci id="S2.SS5.p4.1.m1.1.1.3.3.cmml" xref="S2.SS5.p4.1.m1.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p4.1.m1.1c">\frac{Q}{B\times K}</annotation></semantics></math> training iterations, where <math id="S2.SS5.p4.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S2.SS5.p4.2.m2.1a"><mi id="S2.SS5.p4.2.m2.1.1" xref="S2.SS5.p4.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S2.SS5.p4.2.m2.1b"><ci id="S2.SS5.p4.2.m2.1.1.cmml" xref="S2.SS5.p4.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p4.2.m2.1c">Q</annotation></semantics></math> is the quantity of training samples of the centrally hosted data, and cyclically transfers model weights to the next training institution until model convergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.</p>
</div>
<div id="S2.SS5.p5" class="ltx_para">
<p id="S2.SS5.p5.1" class="ltx_p"><span id="S2.SS5.p5.1.1" class="ltx_text ltx_font_bold">SplitNN</span> is a transfer-based method. For each epoch, local institutions conduct <math id="S2.SS5.p5.1.m1.1" class="ltx_Math" alttext="\frac{Q}{B\times K}" display="inline"><semantics id="S2.SS5.p5.1.m1.1a"><mfrac id="S2.SS5.p5.1.m1.1.1" xref="S2.SS5.p5.1.m1.1.1.cmml"><mi id="S2.SS5.p5.1.m1.1.1.2" xref="S2.SS5.p5.1.m1.1.1.2.cmml">Q</mi><mrow id="S2.SS5.p5.1.m1.1.1.3" xref="S2.SS5.p5.1.m1.1.1.3.cmml"><mi id="S2.SS5.p5.1.m1.1.1.3.2" xref="S2.SS5.p5.1.m1.1.1.3.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS5.p5.1.m1.1.1.3.1" xref="S2.SS5.p5.1.m1.1.1.3.1.cmml">×</mo><mi id="S2.SS5.p5.1.m1.1.1.3.3" xref="S2.SS5.p5.1.m1.1.1.3.3.cmml">K</mi></mrow></mfrac><annotation-xml encoding="MathML-Content" id="S2.SS5.p5.1.m1.1b"><apply id="S2.SS5.p5.1.m1.1.1.cmml" xref="S2.SS5.p5.1.m1.1.1"><divide id="S2.SS5.p5.1.m1.1.1.1.cmml" xref="S2.SS5.p5.1.m1.1.1"></divide><ci id="S2.SS5.p5.1.m1.1.1.2.cmml" xref="S2.SS5.p5.1.m1.1.1.2">𝑄</ci><apply id="S2.SS5.p5.1.m1.1.1.3.cmml" xref="S2.SS5.p5.1.m1.1.1.3"><times id="S2.SS5.p5.1.m1.1.1.3.1.cmml" xref="S2.SS5.p5.1.m1.1.1.3.1"></times><ci id="S2.SS5.p5.1.m1.1.1.3.2.cmml" xref="S2.SS5.p5.1.m1.1.1.3.2">𝐵</ci><ci id="S2.SS5.p5.1.m1.1.1.3.3.cmml" xref="S2.SS5.p5.1.m1.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS5.p5.1.m1.1c">\frac{Q}{B\times K}</annotation></semantics></math> training iterations with weights and gradients transferred between institutions and the server. Specifically, for each iteration: (1) a local institution forward propagates training data until the cut layer and transfers the outputs at the cut layer to a central server, (2) the server completes the rest of the training with the received output, (3) the server generates gradients, back propagates through the cut layer to the institution, and updates the model weights, and (4) the institution transfers model weights to the next training institution <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Similar to our SplitAVG, SplitNN also splits the whole network architecture into two parts, and involves frequent transfer of intermediate feature maps and gradients between the central server and local institutions. However, unlike SplitAVG that trains local institutional sub-networks in parallel and uses an aggregation operation to concatenate the intermediate feature maps in the central server, SplitNN directly uses a serial and cyclical transfer training mode in each local institution, which always suffers from catastrophic forgetting when data heterogeneity exists across institutions.</p>
</div>
<div id="S2.SS5.p6" class="ltx_para">
<p id="S2.SS5.p6.1" class="ltx_p"><span id="S2.SS5.p6.1.1" class="ltx_text ltx_font_bold">FedSGD+GD</span> is an optimization method for FedSGD, which applies GroupNorm layers to avoid the skew-induced accuracy loss of batch normalization layer for non-IID data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. We set the number of groups in GroupNorm layers to 32.</p>
</div>
<div id="S2.SS5.p7" class="ltx_para">
<p id="S2.SS5.p7.1" class="ltx_p"><span id="S2.SS5.p7.1.1" class="ltx_text ltx_font_bold">FedAvgM</span> is an optimization method for FedAvg, which applies a momentum optimizer on the server to improve its robustness on non-IID data partitions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. We set the momentum parameter to 0.9.</p>
</div>
<div id="S2.SS5.p8" class="ltx_para">
<p id="S2.SS5.p8.1" class="ltx_p"><span id="S2.SS5.p8.1.1" class="ltx_text ltx_font_bold">FedAvg+SD</span> is an optimization method for FedAvg, which applies a data-sharing strategy to improve the training of FedAvg on non-IID data partitions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Specifically, 5% of the global data was distributed and globally shared between all local institutions.</p>
</div>
</section>
<section id="S2.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.6 </span>Experimental setup</h3>

<div id="S2.SS6.p1" class="ltx_para">
<p id="S2.SS6.p1.1" class="ltx_p">We choose the 34-layer residual network (ResNet34) pre-trained on ImageNet as the base network for all methods on Retina and BoneAge dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. All methods are implemented in Pytorch and optimized using SGD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. The objective function for Retina classification task and BoneAge regression task is binary cross-entropy and L1-norm, respectively. We set the mini-batch size B to 32, the learning rate to 0.001 (scaled 0.1 every 40 epochs), the momentum coefficient to 0.9. Final models are evaluated by calculating the accuracy of testing data for the Retina classification task, and the mean absolute error (MAE) between true age values and predicting age values of testing data for the BoneAge regression task.</p>
</div>
<div id="S2.SS6.p2" class="ltx_para">
<p id="S2.SS6.p2.1" class="ltx_p">For BraTS segmentation task, we use U-Net as the base model and Dice Loss as the objective function <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. The final models are evaluated by Dice Similarity Coefficient (DSC) between the true and predicted boundaries <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>.</p>
</div>
<div id="S2.SS6.p3" class="ltx_para">
<p id="S2.SS6.p3.4" class="ltx_p">The numbers of selected institutions involved in each round of federated learning for all the comparing methods are set to 4 (<math id="S2.SS6.p3.1.m1.1" class="ltx_Math" alttext="St=4" display="inline"><semantics id="S2.SS6.p3.1.m1.1a"><mrow id="S2.SS6.p3.1.m1.1.1" xref="S2.SS6.p3.1.m1.1.1.cmml"><mrow id="S2.SS6.p3.1.m1.1.1.2" xref="S2.SS6.p3.1.m1.1.1.2.cmml"><mi id="S2.SS6.p3.1.m1.1.1.2.2" xref="S2.SS6.p3.1.m1.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS6.p3.1.m1.1.1.2.1" xref="S2.SS6.p3.1.m1.1.1.2.1.cmml">​</mo><mi id="S2.SS6.p3.1.m1.1.1.2.3" xref="S2.SS6.p3.1.m1.1.1.2.3.cmml">t</mi></mrow><mo id="S2.SS6.p3.1.m1.1.1.1" xref="S2.SS6.p3.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS6.p3.1.m1.1.1.3" xref="S2.SS6.p3.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS6.p3.1.m1.1b"><apply id="S2.SS6.p3.1.m1.1.1.cmml" xref="S2.SS6.p3.1.m1.1.1"><eq id="S2.SS6.p3.1.m1.1.1.1.cmml" xref="S2.SS6.p3.1.m1.1.1.1"></eq><apply id="S2.SS6.p3.1.m1.1.1.2.cmml" xref="S2.SS6.p3.1.m1.1.1.2"><times id="S2.SS6.p3.1.m1.1.1.2.1.cmml" xref="S2.SS6.p3.1.m1.1.1.2.1"></times><ci id="S2.SS6.p3.1.m1.1.1.2.2.cmml" xref="S2.SS6.p3.1.m1.1.1.2.2">𝑆</ci><ci id="S2.SS6.p3.1.m1.1.1.2.3.cmml" xref="S2.SS6.p3.1.m1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S2.SS6.p3.1.m1.1.1.3.cmml" xref="S2.SS6.p3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p3.1.m1.1c">St=4</annotation></semantics></math>, <math id="S2.SS6.p3.2.m2.1" class="ltx_Math" alttext="K=4" display="inline"><semantics id="S2.SS6.p3.2.m2.1a"><mrow id="S2.SS6.p3.2.m2.1.1" xref="S2.SS6.p3.2.m2.1.1.cmml"><mi id="S2.SS6.p3.2.m2.1.1.2" xref="S2.SS6.p3.2.m2.1.1.2.cmml">K</mi><mo id="S2.SS6.p3.2.m2.1.1.1" xref="S2.SS6.p3.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS6.p3.2.m2.1.1.3" xref="S2.SS6.p3.2.m2.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS6.p3.2.m2.1b"><apply id="S2.SS6.p3.2.m2.1.1.cmml" xref="S2.SS6.p3.2.m2.1.1"><eq id="S2.SS6.p3.2.m2.1.1.1.cmml" xref="S2.SS6.p3.2.m2.1.1.1"></eq><ci id="S2.SS6.p3.2.m2.1.1.2.cmml" xref="S2.SS6.p3.2.m2.1.1.2">𝐾</ci><cn type="integer" id="S2.SS6.p3.2.m2.1.1.3.cmml" xref="S2.SS6.p3.2.m2.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p3.2.m2.1c">K=4</annotation></semantics></math>) for the synthetic datasets (Retina and BoneAge). To ensure that the communication and storage costs of SplitAVG does not increase with more institutions, we also set (<math id="S2.SS6.p3.3.m3.1" class="ltx_Math" alttext="St=4" display="inline"><semantics id="S2.SS6.p3.3.m3.1a"><mrow id="S2.SS6.p3.3.m3.1.1" xref="S2.SS6.p3.3.m3.1.1.cmml"><mrow id="S2.SS6.p3.3.m3.1.1.2" xref="S2.SS6.p3.3.m3.1.1.2.cmml"><mi id="S2.SS6.p3.3.m3.1.1.2.2" xref="S2.SS6.p3.3.m3.1.1.2.2.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.SS6.p3.3.m3.1.1.2.1" xref="S2.SS6.p3.3.m3.1.1.2.1.cmml">​</mo><mi id="S2.SS6.p3.3.m3.1.1.2.3" xref="S2.SS6.p3.3.m3.1.1.2.3.cmml">t</mi></mrow><mo id="S2.SS6.p3.3.m3.1.1.1" xref="S2.SS6.p3.3.m3.1.1.1.cmml">=</mo><mn id="S2.SS6.p3.3.m3.1.1.3" xref="S2.SS6.p3.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS6.p3.3.m3.1b"><apply id="S2.SS6.p3.3.m3.1.1.cmml" xref="S2.SS6.p3.3.m3.1.1"><eq id="S2.SS6.p3.3.m3.1.1.1.cmml" xref="S2.SS6.p3.3.m3.1.1.1"></eq><apply id="S2.SS6.p3.3.m3.1.1.2.cmml" xref="S2.SS6.p3.3.m3.1.1.2"><times id="S2.SS6.p3.3.m3.1.1.2.1.cmml" xref="S2.SS6.p3.3.m3.1.1.2.1"></times><ci id="S2.SS6.p3.3.m3.1.1.2.2.cmml" xref="S2.SS6.p3.3.m3.1.1.2.2">𝑆</ci><ci id="S2.SS6.p3.3.m3.1.1.2.3.cmml" xref="S2.SS6.p3.3.m3.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S2.SS6.p3.3.m3.1.1.3.cmml" xref="S2.SS6.p3.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p3.3.m3.1c">St=4</annotation></semantics></math>, <math id="S2.SS6.p3.4.m4.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="S2.SS6.p3.4.m4.1a"><mrow id="S2.SS6.p3.4.m4.1.1" xref="S2.SS6.p3.4.m4.1.1.cmml"><mi id="S2.SS6.p3.4.m4.1.1.2" xref="S2.SS6.p3.4.m4.1.1.2.cmml">K</mi><mo id="S2.SS6.p3.4.m4.1.1.1" xref="S2.SS6.p3.4.m4.1.1.1.cmml">=</mo><mn id="S2.SS6.p3.4.m4.1.1.3" xref="S2.SS6.p3.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS6.p3.4.m4.1b"><apply id="S2.SS6.p3.4.m4.1.1.cmml" xref="S2.SS6.p3.4.m4.1.1"><eq id="S2.SS6.p3.4.m4.1.1.1.cmml" xref="S2.SS6.p3.4.m4.1.1.1"></eq><ci id="S2.SS6.p3.4.m4.1.1.2.cmml" xref="S2.SS6.p3.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S2.SS6.p3.4.m4.1.1.3.cmml" xref="S2.SS6.p3.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS6.p3.4.m4.1c">K=10</annotation></semantics></math>) for BraTS dataset.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results</h2>

<figure id="S3.F4" class="ltx_figure">
<table id="S3.F4.1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.F4.1.1.1" class="ltx_tr">
<td id="S3.F4.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2107.02375/assets/picture/CutLayer.png" id="S3.F4.1.1.1.1.g1" class="ltx_graphics ltx_img_portrait" width="538" height="760" alt="Refer to caption"></td>
<td id="S3.F4.1.1.1.2" class="ltx_td"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>For SplitAVG, when trained with different cut layers of ResNet34 (A) and ResNet50 (B) on a homogeneous split and a heterogeneous split of BoneAge dataset, the model performance on validation dataset is shown by the test mean absolute error (MAE).</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Cut layer selection for SplitAVG</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The selection of the affiliated cut layer for the institutional sub-network and server-based sub-network in SplitAVG affects the final model performance and needs to be carefully selected. We investigate the optimal cut layer for the base model ResNet34 and ResNet50 on BoneAge dataset with 1 homogeneous data partition and 1 heterogeneous data partition among 4 participating institutions. ResNet34 and ResNet50 consist of the following sequential layers: “conv1”, “bn1”, “relu”, “maxpool”, “layer1”, “layer2”, “layer3”, “layer4”, “avgpool”, and “fc”, which are tested as cut layers respectively <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. The selection of cut layer affects the final model performance. However, the optimal cut layer selection is irrelevant to data partition types or base network types, that earlier cut layers tend to result in better performance (Fig. <a href="#S3.F4" title="Figure 4 ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). This observation is consistent with what we inferred in theory analysis that SplitAVG method can learn more abundant unbiased information when the feature maps from local institutions are concatenated at earlier layers. Also, the results showed that deeper cut layers do not significantly compromise the model performance, especially as the base model complexity increases, comparing ResNet50 to ResNet34 results. The models fail only when setting last layer as cut layer, when the server network does not have sufficient model learnable parameters to interpret concatenated feature maps, so it can’t make valid predictions. Experimental results show that the ResNet34 model trained with “conv1” as the cut layer obtained a good performance in all settings. Therefore, we set “conv1” as the cut layer of ResNet34 for SplitAVG in all remaining experiments.</p>
</div>
<figure id="S3.F5" class="ltx_figure">
<p id="S3.F5.1" class="ltx_p ltx_align_center"><span id="S3.F5.1.1" class="ltx_text"><img src="/html/2107.02375/assets/picture/MainResults.png" id="S3.F5.1.1.g1" class="ltx_graphics ltx_img_square" width="548" height="462" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>(A) The test accuracy on Retina splits and (B) the test mean absolute error (MAE) on BoneAge splits of all comparison methods.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Model performance on synthetic federated datasets</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">We evaluate the performance of SplitAVG on the Retina and BoneAge datasets with both homogeneous and heterogeneous data partitions (Splits 1-4 shown in Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.4 Dataset and data partitions ‣ 2 MATERIALS and METHODS ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) and compare it to seven state-of-the-art federated learning methods (FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, FedSGD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, CWT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, SplitNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, FedSGD+GN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, FedAvgM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, FedAvg+SD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>). Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Cut layer selection for SplitAVG ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows that all the compared federated methods perform well on the homogeneous data partition (Split 1) but lose significant accuracy on splits with label distribution skew (Splits 2-4) (Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Cut layer selection for SplitAVG ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). For example, CWT, SplitNN, FedAvg, and FedSGD lose 35.0%, 35.7%, 33.2%, and 35.07% prediction accuracy on Split 4 of the Retina dataset, respectively (Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Cut layer selection for SplitAVG ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(A)). The three optimized methods, FedSGD+GN, FedAvgM, and FedAvg+SD may help mitigate the performance loss for data partitions with mildly skewed label distributions, but still diverge severely on splits with highly skewed label distributions. For example, even when 5% of centrally hosted data are globally shared among each institution, the prediction accuracy of FedAvg+SD is 8.6% lower on Split 4 (KS=0.67) than that on homogenous Split 1 of Retina dataset (Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Cut layer selection for SplitAVG ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(A)). For SplitAVG, there is only 1.89% drop in accuracy on Split 4 of Retina data (Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Cut layer selection for SplitAVG ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(A)), and 0.733% MAE rise on Split 4 of BoneAge data (Fig. <a href="#S3.F5" title="Figure 5 ‣ 3.1 Cut layer selection for SplitAVG ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(B)), than that on homogenous Split 1. In each training iteration, FedSGD method transfers <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="2.13\times 10^{7}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mn id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">2.13</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">×</mo><msup id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mn id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">10</mn><mn id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">7</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><times id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></times><cn type="float" id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">2.13</cn><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">10</cn><cn type="integer" id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">2.13\times 10^{7}</annotation></semantics></math> data (as float32) from local institutional model to the server, while SplitAVG only requires <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="8.03\times 10^{5}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mn id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">8.03</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">×</mo><msup id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mn id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">10</mn><mn id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></times><cn type="float" id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">8.03</cn><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">10</cn><cn type="integer" id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">8.03\times 10^{5}</annotation></semantics></math> data transfer.</p>
</div>
<figure id="S3.F6" class="ltx_figure">
<p id="S3.F6.1" class="ltx_p ltx_align_center"><span id="S3.F6.1.1" class="ltx_text"><img src="/html/2107.02375/assets/picture/BoneAgeMobileNet.png" id="S3.F6.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="285" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>The test mean absolute error (MAE) of CWT, FedAvg+SD, and SplitAVG on BoneAge dataset splits when MobileNet-v2 is applied as the base model.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Model robustness for a different deep learning architecture</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We replace the base model ResNet34 with MobileNet-v2 for all algorithms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. The architecture of MobileNet-v2 consists of a “Feature” structure including 16 “InvertedResidual” blocks, and a “Classifier” layer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. Following the cut layer empirical results in ResNet34, we set the first “InvertedResidual” block in MobileNet-V2 as the cut layer. The predicted MAE is used to evaluate SplitAVG, CWT, and FedAvg+SD on the BoneAge dataset when MobileNet-v2 is used as the base model. SplitAVG again demonstrates the best performance among all the compared methods. On the most skewed data partition (Split 4), SplitAVG achieves 104.7% of the MAE obtained by the baseline (Fig. <a href="#S3.F6" title="Figure 6 ‣ 3.2 Model performance on synthetic federated datasets ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>).</p>
</div>
<figure id="S3.F7" class="ltx_figure"><img src="/html/2107.02375/assets/picture/UMAP.png" id="S3.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="957" height="475" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Feature embedding visualization of (A) baseline centrally hosted, (B) SplitAVG, (C) FedAvgM, (D) FedAvg+SD, (E) FedSGD + GN on highly heterogeneous data splits (KS=0.67) of Retina dataset using UMAPs. Here, ResNet34 is applied as the base network.</figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>SplitAVG on a real-world federated dataset </h3>

<figure id="S3.F8" class="ltx_figure">
<p id="S3.F8.1" class="ltx_p ltx_align_center"><span id="S3.F8.1.1" class="ltx_text"><img src="/html/2107.02375/assets/picture/BratsResult.png" id="S3.F8.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="290" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>The dice similarity coefficient (DSC) of centrally hosted baseline, CWT, FedAvg+SD, and SplitAVG on BraTs dataset when U-Net is applied as the base model.</figcaption>
</figure>
<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.1" class="ltx_p">We use the BraTS segmentation dataset to test SplitAVG’s robustness to the real-world data heterogeneity settings <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. The BraTs dataset contains multi-modal magnetic resonance imaging (MRI) scans of 285 subjects with brain tumors. It is collected from 10 institutions with varying equipment and imaging protocols, thus resulting in heterogeneous data distributions among different clients, see Fig. <a href="#S3.F9" title="Figure 9 ‣ 3.4 SplitAVG on a real-world federated dataset ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> for four examples of images obtained from different institutions. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, we test the performance of SplitAVG on the whole tumor volume segmentation task and adopt the FLAIR modality as the input, comparing with the centrally hosted baseline, CWT, and FedAvg+SD methods. We performed three trials with each method and take the mean of segmentation results across the 10 participating institutions. The model trained with data centrally hosted obtained the mean DSC result of 85.67%, and the model trained with CWT, FedAvg+SD, and SplitAVG obtained the mean DSC results of 79.72%, 83.16%, and 84.6%, as shown in Fig. <a href="#S3.F8" title="Figure 8 ‣ 3.4 SplitAVG on a real-world federated dataset ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure id="S3.F9" class="ltx_figure">
<p id="S3.F9.1" class="ltx_p ltx_align_center"><span id="S3.F9.1.1" class="ltx_text"><img src="/html/2107.02375/assets/picture/Brain.png" id="S3.F9.1.1.g1" class="ltx_graphics ltx_img_square" width="598" height="624" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Examples of images (with varying intensity, image contrast, and etc) obtained from different institutions of BraTs dataset.</figcaption>
</figure>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Analyzing SplitAVG from interpretation perspective</h3>

<div id="S3.SS5.p1" class="ltx_para">
<p id="S3.SS5.p1.1" class="ltx_p">We further visualize the latent space embedding of the features (the first “fc” layer of ResNet34) from the models trained with our SplitAVG, three federated learning optimization methods, and the baseline centrally hosted training, to aid our understanding of different model’s robustness on heterogeneous data splits from interpretation perspective. We use Retina test dataset and draw features computed over samples of healthy label and diseased label with two different colors with UMAPs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. As shown in Fig. <a href="#S3.F7" title="Figure 7 ‣ 3.3 Model robustness for a different deep learning architecture ‣ 3 Results ‣ SplitAVG: A heterogeneity-aware federated deep learning method for medical imaging" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, the baseline UMAP presents the best clustering for same classes. Among UMAPs of comparing federated learning methods, SplitAVG shows the clearest separation for different classes, while the features of healthy and diseased shown from FedAvgM, FedAvg+SD, and FedSVG+GN are highly entangled. This experiment again demonstrates the superiority of SplitAVG on heterogenous data.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Federated learning has emerged as an attractive paradigm for enabling collaboratively training deep learning models without sharing patient data. Although numerous federated learning approaches have been proposed, a critical aspect of existing federated learning methods is that they either assume the data are IID across institutions or only consider mild skewed non-IID data distribution. The performance of models trained using these federated learning methods degrades with increasing degrees of data heterogeneity. In this study, we develop a heterogeneity-aware optimization platform, SplitAVG, to address the challenge of data heterogeneity in federated learning methods.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">We first evaluate our SplitAVG method on the simulated distributed data by artificially introducing various degrees of label distribution skew on the Retina binary classification dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> and bone age prediction dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> and compare it with seven state-of-the-art federated learning methods. We found that all the compared federated learning methods are vulnerable to label distribution skew. For Retina test dataset, the accuracy of models trained using FedAvg, FedSGD, CWT, and SplitNN, decreases from 74.3%, 77.8%, 78.3%, and 78.4% on data partitions with mild degree of label distribution skewness (KS=0.40) to 51.5%, 50.5%, 50.9%, and 50.4% on data partitions with high degree of label distribution skewness (KS=0.67), respectively. Even with complex heuristic parameters tuning (e.g., FedSGD+GN requires the extra pre-training on the model with GN layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, and FedAvgM includes the tuning for momentum parameters <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>) or with the risk of sharing partial raw data (FedAvg+SD) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, the compared methods still suffer from severe performance drops on highly heterogeneous data partition. With the help of simple network splitting strategy and the concatenation operation of intermediate feature maps, our SplitAVG, however, successfully mitigates model performance loss caused by the label distribution skew even in the extreme heterogeneous cases.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">We then investigate whether SplitAVG method can handle other kinds of data heterogeneity besides label distribution skew and if it performs well in other kinds of deep learning tasks besides image classification and regression. Experimental results on a real-world BraTS segmentation dataset show that, even when tested with a mixture of various types of data heterogeneity (quantity skew, imaging acquisition skew, label distribution skew, etc), SplitAVG still achieves comparable performance to the baseline centrally hosted case. In contrast to previous methods that different optimizations are required for each type of data heterogeneity, for example cyclic weighted loss for tackling label heterogeneity and proportional local training for handling sample size heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>, our SplitAVG is more scalable and that can more broadly address the challenge of data heterogeneity across centers in federated learning.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">One limitation of our work is that we only study the performance of federated learning methods with statistical data heterogeneity. There are other sources of heterogeneity, such as device heterogeneity (e.g., variation in computer hardware’s and communication speeds) and behavior heterogeneity (e.g., institutions may join in or drop out during federated model training at any time), which is an important area for future work. One data privacy concern for the proposed SplitAVG is the risk of reconstructing raw images from shared feature maps of the cut layer, which can be prevented by integrating privacy protecting techniques such as secure multi-party computation (MPC) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> and differential privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, and future work can develop adjusted configurations for SplitAVG combining these techniques.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we have proposed SplitAVG, a heterogeneity-aware optimization platform that tackles fundamental and pervasive data heterogeneity problems inherent in federated learning. Our SplitAVG can be consumed as an off-the-shelf federated learning platform and provides immediate improvements, without any complex hyper-parameter tuning, training heuristic, or additional training/fine-tuning. Our SplitAVG is also model agnostic and can be generalized to various types of medical imaging tasks. Experimental evaluation of SplitAVG on a suite of both simulated and real-world federated datasets with various degrees of non-IID data partitions, and its comparisons with seven state-of-the-art federated learning methods and a baseline of centrally hosted data demonstrate the effectiveness of SplitAVG method in handling common types of heterogeneous data across institutions. The findings in this work provide a promising solution to overcoming the challenge of heterogeneous data in real-world federated learning settings.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
H. Zhao, B. Yang, L. Cao, and H. Li, “Data-Driven enhancement of blurry
retinal images via generative adversarial networks,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Medical Image
Computing and Computer Assisted Intervention – MICCAI 2019</em>.   Springer International Publishing, 2019, pp.
75–83.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
X. Wang, H. Chen, L. Luo, A.-R. Ran, P. P. Chan, C. C. Tham, C. Y. Cheung, and
P.-A. Heng, “Unifying structure analysis and Surrogate-Driven function
regression for glaucoma OCT image screening,” in <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Medical Image
Computing and Computer Assisted Intervention – MICCAI 2019</em>.   Springer International Publishing, 2019, pp.
39–47.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
B. Udelsman, I. Chien, K. Ouchi, K. Brizzi, J. A. Tulsky, and C. Lindvall,
“Needle in a haystack: Natural language processing
to identify serious illness,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">J. Palliat.
Med.</em>, vol. 22, no. 2, pp. 179–182, Feb. 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
D.-K. Hwang, C.-C. Hsu, K.-J. Chang, D. Chao, C.-H. Sun, Y.-C. Jheng, A. A.
Yarmishyn, J.-C. Wu, C.-Y. Tsai, M.-L. Wang, C.-H. Peng, K.-H. Chien, C.-L.
Kao, T.-C. Lin, L.-C. Woung, S.-J. Chen, and S.-H. Chiou,
“Artificial intelligence-based decision-making for
age-related macular degeneration,”
<em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Theranostics</em>, vol. 9, no. 1, pp. 232–245,
Jan. 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
V. Tresp, J. Marc Overhage, M. Bundschus, S. Rabizadeh, P. A. Fasching, and
S. Yu, “Going digital: A survey on digitalization and Large-Scale data
analytics in healthcare,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE</em>, vol. 104, no. 11, pp.
2180–2206, Nov. 2016.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
K. Clark, B. Vendt, K. Smith, J. Freymann, J. Kirby, P. Koppel, S. Moore,
S. Phillips, D. Maffitt, M. Pringle, L. Tarbox, and F. Prior,
“The cancer imaging archive (TCIA): maintaining
and operating a public information repository,”
<em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">J. Digit. Imaging</em>, vol. 26, no. 6, pp.
1045–1057, Dec. 2013.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
R. Shokri and V. Shmatikov, “Privacy-preserving deep learning,”
<em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 22nd ACM SIGSAC</em>, 2015.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
A. Jochems, T. M. Deist, J. van Soest, M. Eble, P. Bulens, P. Coucke, W. Dries,
P. Lambin, and A. Dekker, “Distributed learning:
Developing a predictive model based on data from multiple hospitals without
data leaving the hospital - a real life proof of concept,”
<em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Radiother. Oncol.</em>, vol. 121, no. 3, pp.
459–467, Dec. 2016.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-Efficient Learning of Deep Networks from Decentralized
Data,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics</em>, ser. Proceedings of Machine Learning
Research, A. Singh and J. Zhu, Eds., vol. 54.   Fort Lauderdale, FL, USA: PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
K. Chang, N. Balachandar, C. Lam, D. Yi, J. Brown, A. Beers, B. Rosen, D. L.
Rubin, and J. Kalpathy-Cramer, “Distributed deep
learning networks among institutions for medical imaging,”
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">J. Am. Med. Inform. Assoc.</em>, vol. 25, no. 8,
pp. 945–954, Aug. 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
O. Gupta and R. Raskar, “Distributed learning of deep neural network over
multiple agents,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Journal of Network and Computer Applications</em>, vol.
116, pp. 1–8, Aug. 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Fernández, S. García, M. Galar, R. C. Prati, B. Krawczyk, and
F. Herrera, <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Learning from Imbalanced Data Sets</em>.   Springer, Cham, 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with Non-IID data,” Jun. 2018.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
S.-W. Lee, J.-H. Kim, J. Jun, J.-W. Ha, and B.-T. Zhang, “Overcoming
catastrophic forgetting by incremental moment matching,” Mar. 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Qu, L., Balachandar, N., Zhang, M. &amp; Rubin, D. Handling Data Heterogeneity with Generative Replay in Collaborative Learning for Medical Imaging. (2021,6)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
K. Hsieh, A. Phanishayee, O. Mutlu, and P. Gibbons, “The Non-IID data
quagmire of decentralized machine learning,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
37th International Conference on Machine Learning</em>, ser. Proceedings of
Machine Learning Research, H. D. Iii and A. Singh, Eds., vol. 119.   PMLR, 2020, pp. 4387–4398.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
T.-M. H. Hsu, H. Qi, and M. Brown, “Measuring the effects of Non-Identical
data distribution for federated visual classification,” Sep. 2019.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Y. Wu and K. He, “Group normalization,” pp. 742–755, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
L. G. Valiant, “A bridging model for parallel computation,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Commun.
ACM</em>, vol. 33, no. 8, pp. 103–111, Aug. 1990.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">Zhu, Z., Hong, J. &amp; Zhou, J. Data-free knowledge distillation for heterogeneous federated learning. <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">International Conference On Machine Learning</span>. pp. 12878-12889 (2021)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Kaggle, “Diabetic retinopathy detection.
https://www.kaggle.com/c/diabetic-retinopathy-detection [online].” [Online].
Available: <a target="_blank" href="https://www.kaggle.com/c/diabetic-retinopathy-detection" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.kaggle.com/c/diabetic-retinopathy-detection</a>

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Kaggle, “Rsna bone age. https://www.kaggle.com/kmader/rsna-bone-age
[online].” [Online]. Available:
<a target="_blank" href="https://www.kaggle.com/kmader/rsna-bone-age" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.kaggle.com/kmader/rsna-bone-age</a>

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
B. H. Menze, A. Jakab, S. Bauer, J. Kalpathy-Cramer, K. Farahani, J. Kirby,
Y. Burren, N. Porz, J. Slotboom, R. Wiest, L. Lanczi, E. Gerstner, M.-A.
Weber, T. Arbel, B. B. Avants, N. Ayache, P. Buendia, D. L. Collins,
N. Cordier, J. J. Corso, A. Criminisi, T. Das, H. Delingette, Ç. Demiralp, C. R. Durst, M. Dojat, S. Doyle, J. Festa, F. Forbes,
E. Geremia, B. Glocker, P. Golland, X. Guo, A. Hamamci, K. M. Iftekharuddin,
R. Jena, N. M. John, E. Konukoglu, D. Lashkari, J. A. Mariz, R. Meier,
S. Pereira, D. Precup, S. J. Price, T. R. Raviv, S. M. S. Reza, M. Ryan,
D. Sarikaya, L. Schwartz, H.-C. Shin, J. Shotton, C. A. Silva, N. Sousa,
N. K. Subbanna, G. Szekely, T. J. Taylor, O. M. Thomas, N. J. Tustison,
G. Unal, F. Vasseur, M. Wintermark, D. H. Ye, L. Zhao, B. Zhao, D. Zikic,
M. Prastawa, M. Reyes, and K. Van Leemput, “The
multimodal brain tumor image segmentation benchmark (BRATS),”
<em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Med. Imaging</em>, vol. 34, no. 10,
pp. 1993–2024, Oct. 2015.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
S. Bakas, H. Akbari, A. Sotiras, M. Bilello, M. Rozycki, J. S. Kirby, J. B.
Freymann, K. Farahani, and C. Davatzikos, “Advancing
the cancer genome atlas glioma MRI collections with expert segmentation
labels and radiomic features,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Sci Data</em>,
vol. 4, p. 170117, Sep. 2017.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
E. Carver, C. Liu, W. Zong, Z. Dai, J. M. Snyder, J. Lee, and N. Wen,
“Automatic brain tumor segmentation and overall survival prediction using
machine learning algorithms,” pp. 406–418, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
B. Graham, “Kaggle diabetic retinopathy detection competition report,”
<em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">University of Warwick</em>, 2015.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer
vision and pattern recognition</em>, 2016, pp. 770–778.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
O. Russakovsky, J. Deng, H. Su, J. Krause, S. Satheesh, S. Ma, Z. Huang,
A. Karpathy, A. Khosla, M. Bernstein, A. C. Berg, and L. Fei-Fei,
“ImageNet large scale visual recognition challenge,” <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Int. J.
Comput. Vis.</em>, vol. 115, no. 3, pp. 211–252, Dec. 2015.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
PyTorch, “Resnet. https://pytorch.org/hub/pytorch_vision_resnet [online].”
[Online]. Available: <a target="_blank" href="https://pytorch.org/hub/pytorch_vision_resnet" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://pytorch.org/hub/pytorch_vision_resnet</a>

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
PyTorch, “U-net.
https://pytorch.org/hub/mateuszbuda_brain-segmentation-pytorch_unet
[online].” [Online]. Available:
<a target="_blank" href="https://pytorch.org/hub/mateuszbuda_brain-segmentation-pytorch_unet" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://pytorch.org/hub/mateuszbuda_brain-segmentation-pytorch_unet</a>

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
L. R. Dice, “Measures of the amount of ecologic association between species,”
<em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Ecology</em>, vol. 26, no. 3, pp. 297–302, 1945.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
M. Sandler, A. Howard, M. Zhu, A. Zhmoginov, and L.-C. Chen, “Mobilenetv2:
Inverted residuals and linear bottlenecks,” in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the
IEEE conference on computer vision and pattern recognition</em>, 2018, pp.
4510–4520.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Pytorch, “Mobilenet v2.” [Online]. Available:
<a target="_blank" href="https://pytorch.org/hub/pytorch_vision_mobilenet_v2" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://pytorch.org/hub/pytorch_vision_mobilenet_v2</a>

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
M. J. Sheller, G. A. Reina, B. Edwards, J. Martin, and S. Bakas,
“Multi-Institutional deep learning modeling
without sharing patient data: A feasibility study on brain tumor
segmentation,” <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Brainlesion</em>, vol. 11383, pp.
92–104, Jan. 2019.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
N. Balachandar, K. Chang, J. Kalpathy-Cramer, and D. L. Rubin,
“Accounting for data variability in
multi-institutional distributed deep learning for medical imaging,”
<em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">J. Am. Med. Inform. Assoc.</em>, vol. 27, no. 5,
pp. 700–708, May 2020.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
O. Goldreich, “Secure multi-party computation,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Manuscript. Preliminary
version</em>, vol. 78, 1998.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
M. Abadi, A. Chu, I. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and
L. Zhang, “Deep learning with differential privacy,” in <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the 2016 ACM SIGSAC conference on computer and communications security</em>,
2016, pp. 308–318.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2107.02374" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2107.02375" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2107.02375">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2107.02375" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2107.02376" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  9 01:45:10 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
