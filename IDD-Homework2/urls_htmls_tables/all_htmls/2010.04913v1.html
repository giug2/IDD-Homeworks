<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2010.04913] Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program.</title><meta property="og:description" content="There are two main lines of research on visual question answering (VQA): compositional model with explicit multi-hop reasoning, and monolithic network with implicit reasoning in the latent feature space. The former exc…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program.">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program.">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2010.04913">

<!--Generated on Thu Mar 14 10:33:19 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="VQA Interpretable reasoning Neural-symbolic reasoning.">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>MoE Key Lab of Artificial Intelligence, AI Institute, Shanghai Jiao Tong University 
<br class="ltx_break"><span id="id1.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>{alicetang, chaoma}@sjtu.edu.cn</span></span></span></span></span></span>
<h1 class="ltx_title ltx_title_document">Interpretable Neural Computation for Real-World Compositional Visual Question Answering<span id="id1.id1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>This work was supported by NSFC (60906119) and Shanghai Pujiang Program.</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ruixue Tang 
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chao Ma
</span><span class="ltx_author_notes">Corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">There are two main lines of research on visual question answering (VQA): compositional model with explicit multi-hop reasoning, and monolithic network with implicit reasoning in the latent feature space. The former excels in interpretability and compositionality but fails on real-world images, while the latter usually achieves better performance due to model flexibility and parameter efficiency. We aim to combine the two to build an interpretable framework for real-world compositional VQA. In our framework, images and questions are disentangled into scene graphs and programs, and a symbolic program executor runs on them with full transparency to select the attention regions, which are then iteratively passed to a visual-linguistic pre-trained encoder to predict answers. Experiments conducted on the GQA benchmark demonstrate that our framework outperforms the compositional prior arts and achieves competitive accuracy among monolithic ones. With respect to the validity, plausibility and distribution metrics, our framework surpasses others by a considerable margin.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>VQA Interpretable reasoning Neural-symbolic reasoning.
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The advances in deep representation learning and the development of large-scale dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> have inspired a number of pioneering approaches in visual question answering (VQA). Though neural networks are powerful, flexible and robust, recent work has repeatedly demonstrated their flaws, showing how they struggle to generalize in a systematic manner <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, overly adhere to superficial and potentially misleading statistical associations instead of learning true causal relations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The statistical nature of these models that supports robustness and versatility is also what hinders their interpretability, modularity, and soundness.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Indeed, humans are particularly adept at making abstractions of various kinds. We instantly recognize objects and their attributes, parse complicated questions, and leverage such knowledge to reason and answer the questions. We can also clearly explain how we reason to obtain the answer. To this end, researchers consider how best to design a model that could imitate the reasoning procedure of humans while take advantages of neural networks. In particular, recent studies designed new VQA datasets, CLEVR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and GQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, in which each image comes with intricate, compositional questions generated by programs, and the programs exactly represent the human reasoning procedure. They facilitate us to learn an interpretable model by the supervision of programs.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Later, compositional models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> show a promising direction in conferring reasoning ability for the end-to-end design by composing neural modules from a fixed predefined collection. However, the behaviors of the attention-based neural executor are still hard to explain. NS-VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> moves one step further proposing a neural-symbolic approach for visual question answering that fully disentangles vision and language understanding from reasoning. However, these compositional models which designed for synthetic images in CLEVR are not capable of generalizing on real-images in GQA, where real images are much more semantic and visual richness than the synthetic ones and make it challenge to inferring objects, their interactions and subtle relations.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Drawing inspiration from NS-VQA, we further design a model for real-world visual reasoning and compositional question answering that incorporate the symbolic program execution with a vision-and-language pre-trained encoder, LXMERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. We use neural networks as powerful tools for parsing — generating scene graph from images, and programs from questions. Next, we incorporate the symbolic program executor with the LXMERT by running the programs on the scene graphs to locate attention on object regions, which are then iteratively fed to LXMERT to finally get the answer predictions.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The combination of symbolic program executor and the visual-linguistic encoder offers two advantages. First, the use of symbolic representation offers robustness to long, complex and compositional questions. It endows our proposed model with transparent and interpretable reasoning process. Second, the visual-linguistic encoder, LXMERT, offers great cross-modality (image and text) representations to compensate the noisy scene graph. By conducting experiments on GQA dataset, results show that our model achieves competitive accuracy among prior arts, and notably, outperforms state-of-the-art models concerning the essential qualities (i.e. validity, plausibility and distribution) which are necessarily evaluated in GQA datasets.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">To summarize, our main contributions are:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose an interpretable framework for real-world visual reasoning and compositional question answering, where images and questions are disentangled into scene graphs and programs, respectively, and by incorporating with a vision-and-language pre-trained encoder LXMERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, we do a soft logic reasoning over the scene graphs.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We extend the seq2seq <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> to predict two tokens at each step to generate the programs from questions.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Our model achieves competitive accuracy among prior arts on GQA dataset, and notably, outperforms state-of-the-art models with respect to the essential qualities by a considerable margin.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.0.1 </span>VQA</h4>

<div id="S2.SS0.SSS1.p1" class="ltx_para">
<p id="S2.SS0.SSS1.p1.1" class="ltx_p">There have been numerous prominent models that address the VQA task. By and large they can be partitioned into two groups: 1) monolithic approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, which embed both the image and question into a feature space and infer the answer by feature fusion; 2) neural module approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, which first parse the question into a program assembly of neural modules, and then execute the modules over the image features for visual reasoning.</p>
</div>
</section>
<section id="S2.SS0.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.0.2 </span>Scene Graph.</h4>

<div id="S2.SS0.SSS2.p1" class="ltx_para">
<p id="S2.SS0.SSS2.p1.1" class="ltx_p">This task is to produce graph representations of images in terms of objects and their relationships. Scene graphs have been shown effective in boosting several vision-language tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. However, scene graph detection is far from satisfactory compared to object detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>. To this end, we utilize a large-scale vision-and-language pre-trained encoder to compensate the noisy predicted scene graph.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we first briefly summarize the LXMERT model (Sec. <a href="#S3.SS1" title="3.1 Preliminary: LXMERT Background ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>) and then describe how we incorporate symbolic program executor with it (Sec. <a href="#S3.SS2" title="3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>).</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Preliminary: LXMERT Background</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">LXMERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>(Learning Cross-Modality Encoder Representations from Transformers) is a model for learning task-agnostic joint representations of image content and natural language. It is a large-scale Transformer model that consists of three encoders: an object relationship encoder, a language encoder, and a cross-modality encoder. As shown in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.1 Preliminary: LXMERT Background ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, LXMERT takes two inputs: an image and its related sentence (e.g., a caption or a question). Each image is represented as a sequence of objects, and each sentence is represented as a sequence of words. Via careful design and combination of these self-attention and cross-attention layers, LXMERT is able to generate language representations, image representations, and cross-modality representations from the inputs.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.6" class="ltx_p">The <span id="S3.SS1.p2.6.1" class="ltx_text ltx_font_bold">object-relationship encoder</span> and <span id="S3.SS1.p2.6.2" class="ltx_text ltx_font_bold">language encoder</span> are two transformer models and each of them only focuses on a single modality (i.e., language or vision). Each layer (left dashed blocks in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.1 Preliminary: LXMERT Background ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) in a single-modality encoder contains a self-attention (’Self’) sub-layer and a feed-forward (’FF’) sub-layer. The (’Self’) sub-layer at <em id="S3.SS1.p2.6.3" class="ltx_emph ltx_font_italic">k</em>-th layer could be formulated as:</p>
<table id="S5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\displaystyle\check{h}^{k}_{i}={\rm SelfAtt_{L\to L}}\Big{(}h_{i}^{k-1},\left\{h_{1}^{k-1},...,h_{n}^{k-1}\right\}\Big{)}" display="inline"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><msubsup id="S3.E1.m1.3.3.4" xref="S3.E1.m1.3.3.4.cmml"><mover accent="true" id="S3.E1.m1.3.3.4.2.2" xref="S3.E1.m1.3.3.4.2.2.cmml"><mi id="S3.E1.m1.3.3.4.2.2.2" xref="S3.E1.m1.3.3.4.2.2.2.cmml">h</mi><mo id="S3.E1.m1.3.3.4.2.2.1" xref="S3.E1.m1.3.3.4.2.2.1.cmml">ˇ</mo></mover><mi id="S3.E1.m1.3.3.4.3" xref="S3.E1.m1.3.3.4.3.cmml">i</mi><mi id="S3.E1.m1.3.3.4.2.3" xref="S3.E1.m1.3.3.4.2.3.cmml">k</mi></msubsup><mo id="S3.E1.m1.3.3.3" xref="S3.E1.m1.3.3.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml"><msub id="S3.E1.m1.3.3.2.4" xref="S3.E1.m1.3.3.2.4.cmml"><mi id="S3.E1.m1.3.3.2.4.2" xref="S3.E1.m1.3.3.2.4.2.cmml">SelfAtt</mi><mrow id="S3.E1.m1.3.3.2.4.3" xref="S3.E1.m1.3.3.2.4.3.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.2.4.3.2" xref="S3.E1.m1.3.3.2.4.3.2.cmml">L</mi><mo stretchy="false" id="S3.E1.m1.3.3.2.4.3.1" xref="S3.E1.m1.3.3.2.4.3.1.cmml">→</mo><mi mathvariant="normal" id="S3.E1.m1.3.3.2.4.3.3" xref="S3.E1.m1.3.3.2.4.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.2.3" xref="S3.E1.m1.3.3.2.3.cmml">​</mo><mrow id="S3.E1.m1.3.3.2.2.2" xref="S3.E1.m1.3.3.2.2.3.cmml"><mo maxsize="160%" minsize="160%" id="S3.E1.m1.3.3.2.2.2.3" xref="S3.E1.m1.3.3.2.2.3.cmml">(</mo><msubsup id="S3.E1.m1.2.2.1.1.1.1" xref="S3.E1.m1.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.1.2.2.cmml">h</mi><mi id="S3.E1.m1.2.2.1.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E1.m1.2.2.1.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.2.2.1.1.1.1.3.2" xref="S3.E1.m1.2.2.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E1.m1.2.2.1.1.1.1.3.1" xref="S3.E1.m1.2.2.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E1.m1.2.2.1.1.1.1.3.3" xref="S3.E1.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E1.m1.3.3.2.2.2.4" xref="S3.E1.m1.3.3.2.2.3.cmml">,</mo><mrow id="S3.E1.m1.3.3.2.2.2.2.2" xref="S3.E1.m1.3.3.2.2.2.2.3.cmml"><mo id="S3.E1.m1.3.3.2.2.2.2.2.3" xref="S3.E1.m1.3.3.2.2.2.2.3.cmml">{</mo><msubsup id="S3.E1.m1.3.3.2.2.2.2.1.1" xref="S3.E1.m1.3.3.2.2.2.2.1.1.cmml"><mi id="S3.E1.m1.3.3.2.2.2.2.1.1.2.2" xref="S3.E1.m1.3.3.2.2.2.2.1.1.2.2.cmml">h</mi><mn id="S3.E1.m1.3.3.2.2.2.2.1.1.2.3" xref="S3.E1.m1.3.3.2.2.2.2.1.1.2.3.cmml">1</mn><mrow id="S3.E1.m1.3.3.2.2.2.2.1.1.3" xref="S3.E1.m1.3.3.2.2.2.2.1.1.3.cmml"><mi id="S3.E1.m1.3.3.2.2.2.2.1.1.3.2" xref="S3.E1.m1.3.3.2.2.2.2.1.1.3.2.cmml">k</mi><mo id="S3.E1.m1.3.3.2.2.2.2.1.1.3.1" xref="S3.E1.m1.3.3.2.2.2.2.1.1.3.1.cmml">−</mo><mn id="S3.E1.m1.3.3.2.2.2.2.1.1.3.3" xref="S3.E1.m1.3.3.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E1.m1.3.3.2.2.2.2.2.4" xref="S3.E1.m1.3.3.2.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">…</mi><mo id="S3.E1.m1.3.3.2.2.2.2.2.5" xref="S3.E1.m1.3.3.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E1.m1.3.3.2.2.2.2.2.2" xref="S3.E1.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.3.3.2.2.2.2.2.2.2.2" xref="S3.E1.m1.3.3.2.2.2.2.2.2.2.2.cmml">h</mi><mi id="S3.E1.m1.3.3.2.2.2.2.2.2.2.3" xref="S3.E1.m1.3.3.2.2.2.2.2.2.2.3.cmml">n</mi><mrow id="S3.E1.m1.3.3.2.2.2.2.2.2.3" xref="S3.E1.m1.3.3.2.2.2.2.2.2.3.cmml"><mi id="S3.E1.m1.3.3.2.2.2.2.2.2.3.2" xref="S3.E1.m1.3.3.2.2.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E1.m1.3.3.2.2.2.2.2.2.3.1" xref="S3.E1.m1.3.3.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E1.m1.3.3.2.2.2.2.2.2.3.3" xref="S3.E1.m1.3.3.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E1.m1.3.3.2.2.2.2.2.6" xref="S3.E1.m1.3.3.2.2.2.2.3.cmml">}</mo></mrow><mo maxsize="160%" minsize="160%" id="S3.E1.m1.3.3.2.2.2.5" xref="S3.E1.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><eq id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3.3"></eq><apply id="S3.E1.m1.3.3.4.cmml" xref="S3.E1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.4.1.cmml" xref="S3.E1.m1.3.3.4">subscript</csymbol><apply id="S3.E1.m1.3.3.4.2.cmml" xref="S3.E1.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.4.2.1.cmml" xref="S3.E1.m1.3.3.4">superscript</csymbol><apply id="S3.E1.m1.3.3.4.2.2.cmml" xref="S3.E1.m1.3.3.4.2.2"><ci id="S3.E1.m1.3.3.4.2.2.1.cmml" xref="S3.E1.m1.3.3.4.2.2.1">ˇ</ci><ci id="S3.E1.m1.3.3.4.2.2.2.cmml" xref="S3.E1.m1.3.3.4.2.2.2">ℎ</ci></apply><ci id="S3.E1.m1.3.3.4.2.3.cmml" xref="S3.E1.m1.3.3.4.2.3">𝑘</ci></apply><ci id="S3.E1.m1.3.3.4.3.cmml" xref="S3.E1.m1.3.3.4.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2"><times id="S3.E1.m1.3.3.2.3.cmml" xref="S3.E1.m1.3.3.2.3"></times><apply id="S3.E1.m1.3.3.2.4.cmml" xref="S3.E1.m1.3.3.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.4.1.cmml" xref="S3.E1.m1.3.3.2.4">subscript</csymbol><ci id="S3.E1.m1.3.3.2.4.2.cmml" xref="S3.E1.m1.3.3.2.4.2">SelfAtt</ci><apply id="S3.E1.m1.3.3.2.4.3.cmml" xref="S3.E1.m1.3.3.2.4.3"><ci id="S3.E1.m1.3.3.2.4.3.1.cmml" xref="S3.E1.m1.3.3.2.4.3.1">→</ci><ci id="S3.E1.m1.3.3.2.4.3.2.cmml" xref="S3.E1.m1.3.3.2.4.3.2">L</ci><ci id="S3.E1.m1.3.3.2.4.3.3.cmml" xref="S3.E1.m1.3.3.2.4.3.3">L</ci></apply></apply><interval closure="open" id="S3.E1.m1.3.3.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.2"><apply id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.2">ℎ</ci><ci id="S3.E1.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E1.m1.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.3"><minus id="S3.E1.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.2.2.1.1.1.1.3.1"></minus><ci id="S3.E1.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E1.m1.2.2.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E1.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply><set id="S3.E1.m1.3.3.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2"><apply id="S3.E1.m1.3.3.2.2.2.2.1.1.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1">superscript</csymbol><apply id="S3.E1.m1.3.3.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.2.2.1.1.2.1.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.2.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1.2.2">ℎ</ci><cn type="integer" id="S3.E1.m1.3.3.2.2.2.2.1.1.2.3.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1.2.3">1</cn></apply><apply id="S3.E1.m1.3.3.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1.3"><minus id="S3.E1.m1.3.3.2.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1.3.1"></minus><ci id="S3.E1.m1.3.3.2.2.2.2.1.1.3.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.3.3.2.2.2.2.1.1.3.3.cmml" xref="S3.E1.m1.3.3.2.2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">…</ci><apply id="S3.E1.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E1.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2.2.2">ℎ</ci><ci id="S3.E1.m1.3.3.2.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2.2.3">𝑛</ci></apply><apply id="S3.E1.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2.3"><minus id="S3.E1.m1.3.3.2.2.2.2.2.2.3.1.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2.3.1"></minus><ci id="S3.E1.m1.3.3.2.2.2.2.2.2.3.2.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.3.3.2.2.2.2.2.2.3.3.cmml" xref="S3.E1.m1.3.3.2.2.2.2.2.2.3.3">1</cn></apply></apply></set></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\displaystyle\check{h}^{k}_{i}={\rm SelfAtt_{L\to L}}\Big{(}h_{i}^{k-1},\left\{h_{1}^{k-1},...,h_{n}^{k-1}\right\}\Big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.3" class="ltx_Math" alttext="\displaystyle\check{v}^{k}_{i}={\rm SelfAtt_{R\to R}}\Big{(}v_{i}^{k-1},\left\{v_{1}^{k-1},...,v_{m}^{k-1}\right\}\Big{)}" display="inline"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml"><msubsup id="S3.E2.m1.3.3.4" xref="S3.E2.m1.3.3.4.cmml"><mover accent="true" id="S3.E2.m1.3.3.4.2.2" xref="S3.E2.m1.3.3.4.2.2.cmml"><mi id="S3.E2.m1.3.3.4.2.2.2" xref="S3.E2.m1.3.3.4.2.2.2.cmml">v</mi><mo id="S3.E2.m1.3.3.4.2.2.1" xref="S3.E2.m1.3.3.4.2.2.1.cmml">ˇ</mo></mover><mi id="S3.E2.m1.3.3.4.3" xref="S3.E2.m1.3.3.4.3.cmml">i</mi><mi id="S3.E2.m1.3.3.4.2.3" xref="S3.E2.m1.3.3.4.2.3.cmml">k</mi></msubsup><mo id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml">=</mo><mrow id="S3.E2.m1.3.3.2" xref="S3.E2.m1.3.3.2.cmml"><msub id="S3.E2.m1.3.3.2.4" xref="S3.E2.m1.3.3.2.4.cmml"><mi id="S3.E2.m1.3.3.2.4.2" xref="S3.E2.m1.3.3.2.4.2.cmml">SelfAtt</mi><mrow id="S3.E2.m1.3.3.2.4.3" xref="S3.E2.m1.3.3.2.4.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.3.3.2.4.3.2" xref="S3.E2.m1.3.3.2.4.3.2.cmml">R</mi><mo stretchy="false" id="S3.E2.m1.3.3.2.4.3.1" xref="S3.E2.m1.3.3.2.4.3.1.cmml">→</mo><mi mathvariant="normal" id="S3.E2.m1.3.3.2.4.3.3" xref="S3.E2.m1.3.3.2.4.3.3.cmml">R</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.2.3" xref="S3.E2.m1.3.3.2.3.cmml">​</mo><mrow id="S3.E2.m1.3.3.2.2.2" xref="S3.E2.m1.3.3.2.2.3.cmml"><mo maxsize="160%" minsize="160%" id="S3.E2.m1.3.3.2.2.2.3" xref="S3.E2.m1.3.3.2.2.3.cmml">(</mo><msubsup id="S3.E2.m1.2.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E2.m1.2.2.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E2.m1.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E2.m1.2.2.1.1.1.1.3.1" xref="S3.E2.m1.2.2.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E2.m1.2.2.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m1.3.3.2.2.2.4" xref="S3.E2.m1.3.3.2.2.3.cmml">,</mo><mrow id="S3.E2.m1.3.3.2.2.2.2.2" xref="S3.E2.m1.3.3.2.2.2.2.3.cmml"><mo id="S3.E2.m1.3.3.2.2.2.2.2.3" xref="S3.E2.m1.3.3.2.2.2.2.3.cmml">{</mo><msubsup id="S3.E2.m1.3.3.2.2.2.2.1.1" xref="S3.E2.m1.3.3.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.3.3.2.2.2.2.1.1.2.2" xref="S3.E2.m1.3.3.2.2.2.2.1.1.2.2.cmml">v</mi><mn id="S3.E2.m1.3.3.2.2.2.2.1.1.2.3" xref="S3.E2.m1.3.3.2.2.2.2.1.1.2.3.cmml">1</mn><mrow id="S3.E2.m1.3.3.2.2.2.2.1.1.3" xref="S3.E2.m1.3.3.2.2.2.2.1.1.3.cmml"><mi id="S3.E2.m1.3.3.2.2.2.2.1.1.3.2" xref="S3.E2.m1.3.3.2.2.2.2.1.1.3.2.cmml">k</mi><mo id="S3.E2.m1.3.3.2.2.2.2.1.1.3.1" xref="S3.E2.m1.3.3.2.2.2.2.1.1.3.1.cmml">−</mo><mn id="S3.E2.m1.3.3.2.2.2.2.1.1.3.3" xref="S3.E2.m1.3.3.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m1.3.3.2.2.2.2.2.4" xref="S3.E2.m1.3.3.2.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">…</mi><mo id="S3.E2.m1.3.3.2.2.2.2.2.5" xref="S3.E2.m1.3.3.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.3.3.2.2.2.2.2.2" xref="S3.E2.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.3.3.2.2.2.2.2.2.2.2" xref="S3.E2.m1.3.3.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S3.E2.m1.3.3.2.2.2.2.2.2.2.3" xref="S3.E2.m1.3.3.2.2.2.2.2.2.2.3.cmml">m</mi><mrow id="S3.E2.m1.3.3.2.2.2.2.2.2.3" xref="S3.E2.m1.3.3.2.2.2.2.2.2.3.cmml"><mi id="S3.E2.m1.3.3.2.2.2.2.2.2.3.2" xref="S3.E2.m1.3.3.2.2.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E2.m1.3.3.2.2.2.2.2.2.3.1" xref="S3.E2.m1.3.3.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E2.m1.3.3.2.2.2.2.2.2.3.3" xref="S3.E2.m1.3.3.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E2.m1.3.3.2.2.2.2.2.6" xref="S3.E2.m1.3.3.2.2.2.2.3.cmml">}</mo></mrow><mo maxsize="160%" minsize="160%" id="S3.E2.m1.3.3.2.2.2.5" xref="S3.E2.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"><eq id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"></eq><apply id="S3.E2.m1.3.3.4.cmml" xref="S3.E2.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.4.1.cmml" xref="S3.E2.m1.3.3.4">subscript</csymbol><apply id="S3.E2.m1.3.3.4.2.cmml" xref="S3.E2.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.4.2.1.cmml" xref="S3.E2.m1.3.3.4">superscript</csymbol><apply id="S3.E2.m1.3.3.4.2.2.cmml" xref="S3.E2.m1.3.3.4.2.2"><ci id="S3.E2.m1.3.3.4.2.2.1.cmml" xref="S3.E2.m1.3.3.4.2.2.1">ˇ</ci><ci id="S3.E2.m1.3.3.4.2.2.2.cmml" xref="S3.E2.m1.3.3.4.2.2.2">𝑣</ci></apply><ci id="S3.E2.m1.3.3.4.2.3.cmml" xref="S3.E2.m1.3.3.4.2.3">𝑘</ci></apply><ci id="S3.E2.m1.3.3.4.3.cmml" xref="S3.E2.m1.3.3.4.3">𝑖</ci></apply><apply id="S3.E2.m1.3.3.2.cmml" xref="S3.E2.m1.3.3.2"><times id="S3.E2.m1.3.3.2.3.cmml" xref="S3.E2.m1.3.3.2.3"></times><apply id="S3.E2.m1.3.3.2.4.cmml" xref="S3.E2.m1.3.3.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.4.1.cmml" xref="S3.E2.m1.3.3.2.4">subscript</csymbol><ci id="S3.E2.m1.3.3.2.4.2.cmml" xref="S3.E2.m1.3.3.2.4.2">SelfAtt</ci><apply id="S3.E2.m1.3.3.2.4.3.cmml" xref="S3.E2.m1.3.3.2.4.3"><ci id="S3.E2.m1.3.3.2.4.3.1.cmml" xref="S3.E2.m1.3.3.2.4.3.1">→</ci><ci id="S3.E2.m1.3.3.2.4.3.2.cmml" xref="S3.E2.m1.3.3.2.4.3.2">R</ci><ci id="S3.E2.m1.3.3.2.4.3.3.cmml" xref="S3.E2.m1.3.3.2.4.3.3">R</ci></apply></apply><interval closure="open" id="S3.E2.m1.3.3.2.2.3.cmml" xref="S3.E2.m1.3.3.2.2.2"><apply id="S3.E2.m1.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2.2">𝑣</ci><ci id="S3.E2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3"><minus id="S3.E2.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3.1"></minus><ci id="S3.E2.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply><set id="S3.E2.m1.3.3.2.2.2.2.3.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2"><apply id="S3.E2.m1.3.3.2.2.2.2.1.1.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1">superscript</csymbol><apply id="S3.E2.m1.3.3.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.2.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1.2.2">𝑣</ci><cn type="integer" id="S3.E2.m1.3.3.2.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1.2.3">1</cn></apply><apply id="S3.E2.m1.3.3.2.2.2.2.1.1.3.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1.3"><minus id="S3.E2.m1.3.3.2.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1.3.1"></minus><ci id="S3.E2.m1.3.3.2.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.3.3.2.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.3.3.2.2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">…</ci><apply id="S3.E2.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2.2.2">𝑣</ci><ci id="S3.E2.m1.3.3.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2.2.3">𝑚</ci></apply><apply id="S3.E2.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2.3"><minus id="S3.E2.m1.3.3.2.2.2.2.2.2.3.1.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2.3.1"></minus><ci id="S3.E2.m1.3.3.2.2.2.2.2.2.3.2.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.3.3.2.2.2.2.2.2.3.3.cmml" xref="S3.E2.m1.3.3.2.2.2.2.2.2.3.3">1</cn></apply></apply></set></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\displaystyle\check{v}^{k}_{i}={\rm SelfAtt_{R\to R}}\Big{(}v_{i}^{k-1},\left\{v_{1}^{k-1},...,v_{m}^{k-1}\right\}\Big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.5" class="ltx_p">where <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\left\{\hat{h}^{k}_{i}\right\}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.2.cmml"><mo id="S3.SS1.p2.1.m1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">{</mo><msubsup id="S3.SS1.p2.1.m1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p2.1.m1.1.1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.2.2.2" xref="S3.SS1.p2.1.m1.1.1.1.1.2.2.2.cmml">h</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.2.2.1" xref="S3.SS1.p2.1.m1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS1.p2.1.m1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><set id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1"><apply id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2.2"><ci id="S3.SS1.p2.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2.2.1">^</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2.2.2">ℎ</ci></apply><ci id="S3.SS1.p2.1.m1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\left\{\hat{h}^{k}_{i}\right\}</annotation></semantics></math> are language features and <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\left\{\hat{v}^{k}_{i}\right\}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.2.cmml"><mo id="S3.SS1.p2.2.m2.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">{</mo><msubsup id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p2.2.m2.1.1.1.1.2.2" xref="S3.SS1.p2.2.m2.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.2.2.2" xref="S3.SS1.p2.2.m2.1.1.1.1.2.2.2.cmml">v</mi><mo id="S3.SS1.p2.2.m2.1.1.1.1.2.2.1" xref="S3.SS1.p2.2.m2.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.p2.2.m2.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.3.cmml">i</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.2.3" xref="S3.SS1.p2.2.m2.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS1.p2.2.m2.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><set id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1"><apply id="S3.SS1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2.2"><ci id="S3.SS1.p2.2.m2.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2.2.1">^</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2.2.2">𝑣</ci></apply><ci id="S3.SS1.p2.2.m2.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\left\{\hat{v}^{k}_{i}\right\}</annotation></semantics></math> are vision features.
We take <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="N_{L}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">N</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑁</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">N_{L}</annotation></semantics></math> and <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="N_{R}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><msub id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">N</mi><mi id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">𝑁</ci><ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">N_{R}</annotation></semantics></math> layers in the language encoder and the object-relationship encoder, respectively. A residual connection and layer normalization (annotated by the ‘+’ sign in Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.1 Preliminary: LXMERT Background ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is added after each sub-layer. Each cross-modality layer in the <span id="S3.SS1.p2.5.1" class="ltx_text ltx_font_bold">cross-modality encoder</span> consists of one bi-directional cross-attention sub-layer, two self-attention sub-layers, and two feed-forward sub-layers. We stack <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="N_{X}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><msub id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml"><mi id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">N</mi><mi id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">X</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">𝑁</ci><ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">N_{X}</annotation></semantics></math> these cross-modality layers in our encoder implementation. Inside the <em id="S3.SS1.p2.5.2" class="ltx_emph ltx_font_italic">k</em>-th layer, the bi-directional cross-attention sub-layer (’Cross’) is first applied, which contains two uni-directional cross-attention sub-layers: one from language to vision and one from vision to language, which are formulated as:</p>
<table id="S5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\displaystyle\hat{h}^{k}_{i}={\rm CrossAtt_{L\to R}}\Big{(}h_{i}^{k-1},\left\{v_{1}^{k-1},...,v_{m}^{k-1}\right\}\Big{)}" display="inline"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><msubsup id="S3.E3.m1.3.3.4" xref="S3.E3.m1.3.3.4.cmml"><mover accent="true" id="S3.E3.m1.3.3.4.2.2" xref="S3.E3.m1.3.3.4.2.2.cmml"><mi id="S3.E3.m1.3.3.4.2.2.2" xref="S3.E3.m1.3.3.4.2.2.2.cmml">h</mi><mo id="S3.E3.m1.3.3.4.2.2.1" xref="S3.E3.m1.3.3.4.2.2.1.cmml">^</mo></mover><mi id="S3.E3.m1.3.3.4.3" xref="S3.E3.m1.3.3.4.3.cmml">i</mi><mi id="S3.E3.m1.3.3.4.2.3" xref="S3.E3.m1.3.3.4.2.3.cmml">k</mi></msubsup><mo id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml">=</mo><mrow id="S3.E3.m1.3.3.2" xref="S3.E3.m1.3.3.2.cmml"><msub id="S3.E3.m1.3.3.2.4" xref="S3.E3.m1.3.3.2.4.cmml"><mi id="S3.E3.m1.3.3.2.4.2" xref="S3.E3.m1.3.3.2.4.2.cmml">CrossAtt</mi><mrow id="S3.E3.m1.3.3.2.4.3" xref="S3.E3.m1.3.3.2.4.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.3.3.2.4.3.2" xref="S3.E3.m1.3.3.2.4.3.2.cmml">L</mi><mo stretchy="false" id="S3.E3.m1.3.3.2.4.3.1" xref="S3.E3.m1.3.3.2.4.3.1.cmml">→</mo><mi mathvariant="normal" id="S3.E3.m1.3.3.2.4.3.3" xref="S3.E3.m1.3.3.2.4.3.3.cmml">R</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.2.3" xref="S3.E3.m1.3.3.2.3.cmml">​</mo><mrow id="S3.E3.m1.3.3.2.2.2" xref="S3.E3.m1.3.3.2.2.3.cmml"><mo maxsize="160%" minsize="160%" id="S3.E3.m1.3.3.2.2.2.3" xref="S3.E3.m1.3.3.2.2.3.cmml">(</mo><msubsup id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.2.2.cmml">h</mi><mi id="S3.E3.m1.2.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E3.m1.2.2.1.1.1.1.3.1" xref="S3.E3.m1.2.2.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E3.m1.2.2.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E3.m1.3.3.2.2.2.4" xref="S3.E3.m1.3.3.2.2.3.cmml">,</mo><mrow id="S3.E3.m1.3.3.2.2.2.2.2" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml"><mo id="S3.E3.m1.3.3.2.2.2.2.2.3" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml">{</mo><msubsup id="S3.E3.m1.3.3.2.2.2.2.1.1" xref="S3.E3.m1.3.3.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.1.1.2.2" xref="S3.E3.m1.3.3.2.2.2.2.1.1.2.2.cmml">v</mi><mn id="S3.E3.m1.3.3.2.2.2.2.1.1.2.3" xref="S3.E3.m1.3.3.2.2.2.2.1.1.2.3.cmml">1</mn><mrow id="S3.E3.m1.3.3.2.2.2.2.1.1.3" xref="S3.E3.m1.3.3.2.2.2.2.1.1.3.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.1.1.3.2" xref="S3.E3.m1.3.3.2.2.2.2.1.1.3.2.cmml">k</mi><mo id="S3.E3.m1.3.3.2.2.2.2.1.1.3.1" xref="S3.E3.m1.3.3.2.2.2.2.1.1.3.1.cmml">−</mo><mn id="S3.E3.m1.3.3.2.2.2.2.1.1.3.3" xref="S3.E3.m1.3.3.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E3.m1.3.3.2.2.2.2.2.4" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">…</mi><mo id="S3.E3.m1.3.3.2.2.2.2.2.5" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E3.m1.3.3.2.2.2.2.2.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.2.2.2.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="S3.E3.m1.3.3.2.2.2.2.2.2.2.3" xref="S3.E3.m1.3.3.2.2.2.2.2.2.2.3.cmml">m</mi><mrow id="S3.E3.m1.3.3.2.2.2.2.2.2.3" xref="S3.E3.m1.3.3.2.2.2.2.2.2.3.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.2.2.3.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E3.m1.3.3.2.2.2.2.2.2.3.1" xref="S3.E3.m1.3.3.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E3.m1.3.3.2.2.2.2.2.2.3.3" xref="S3.E3.m1.3.3.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E3.m1.3.3.2.2.2.2.2.6" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml">}</mo></mrow><mo maxsize="160%" minsize="160%" id="S3.E3.m1.3.3.2.2.2.5" xref="S3.E3.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><eq id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.3"></eq><apply id="S3.E3.m1.3.3.4.cmml" xref="S3.E3.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.4.1.cmml" xref="S3.E3.m1.3.3.4">subscript</csymbol><apply id="S3.E3.m1.3.3.4.2.cmml" xref="S3.E3.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.4.2.1.cmml" xref="S3.E3.m1.3.3.4">superscript</csymbol><apply id="S3.E3.m1.3.3.4.2.2.cmml" xref="S3.E3.m1.3.3.4.2.2"><ci id="S3.E3.m1.3.3.4.2.2.1.cmml" xref="S3.E3.m1.3.3.4.2.2.1">^</ci><ci id="S3.E3.m1.3.3.4.2.2.2.cmml" xref="S3.E3.m1.3.3.4.2.2.2">ℎ</ci></apply><ci id="S3.E3.m1.3.3.4.2.3.cmml" xref="S3.E3.m1.3.3.4.2.3">𝑘</ci></apply><ci id="S3.E3.m1.3.3.4.3.cmml" xref="S3.E3.m1.3.3.4.3">𝑖</ci></apply><apply id="S3.E3.m1.3.3.2.cmml" xref="S3.E3.m1.3.3.2"><times id="S3.E3.m1.3.3.2.3.cmml" xref="S3.E3.m1.3.3.2.3"></times><apply id="S3.E3.m1.3.3.2.4.cmml" xref="S3.E3.m1.3.3.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.4.1.cmml" xref="S3.E3.m1.3.3.2.4">subscript</csymbol><ci id="S3.E3.m1.3.3.2.4.2.cmml" xref="S3.E3.m1.3.3.2.4.2">CrossAtt</ci><apply id="S3.E3.m1.3.3.2.4.3.cmml" xref="S3.E3.m1.3.3.2.4.3"><ci id="S3.E3.m1.3.3.2.4.3.1.cmml" xref="S3.E3.m1.3.3.2.4.3.1">→</ci><ci id="S3.E3.m1.3.3.2.4.3.2.cmml" xref="S3.E3.m1.3.3.2.4.3.2">L</ci><ci id="S3.E3.m1.3.3.2.4.3.3.cmml" xref="S3.E3.m1.3.3.2.4.3.3">R</ci></apply></apply><interval closure="open" id="S3.E3.m1.3.3.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2"><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2">ℎ</ci><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3"><minus id="S3.E3.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.1"></minus><ci id="S3.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply><set id="S3.E3.m1.3.3.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2"><apply id="S3.E3.m1.3.3.2.2.2.2.1.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1">superscript</csymbol><apply id="S3.E3.m1.3.3.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.1.1.2.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.2.2.1.1.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1.2.2">𝑣</ci><cn type="integer" id="S3.E3.m1.3.3.2.2.2.2.1.1.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1.2.3">1</cn></apply><apply id="S3.E3.m1.3.3.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1.3"><minus id="S3.E3.m1.3.3.2.2.2.2.1.1.3.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1.3.1"></minus><ci id="S3.E3.m1.3.3.2.2.2.2.1.1.3.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.3.3.2.2.2.2.1.1.3.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">…</ci><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.2.2">𝑣</ci><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.2.3">𝑚</ci></apply><apply id="S3.E3.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.3"><minus id="S3.E3.m1.3.3.2.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.3.1"></minus><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.3.3.2.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2.3.3">1</cn></apply></apply></set></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\displaystyle\hat{h}^{k}_{i}={\rm CrossAtt_{L\to R}}\Big{(}h_{i}^{k-1},\left\{v_{1}^{k-1},...,v_{m}^{k-1}\right\}\Big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4.m1.3" class="ltx_Math" alttext="\displaystyle\hat{v}^{k}_{i}={\rm CrossAtt_{R\to L}}\Big{(}v_{i}^{k-1},\left\{h_{1}^{k-1},...,h_{n}^{k-1}\right\}\Big{)}" display="inline"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><msubsup id="S3.E4.m1.3.3.4" xref="S3.E4.m1.3.3.4.cmml"><mover accent="true" id="S3.E4.m1.3.3.4.2.2" xref="S3.E4.m1.3.3.4.2.2.cmml"><mi id="S3.E4.m1.3.3.4.2.2.2" xref="S3.E4.m1.3.3.4.2.2.2.cmml">v</mi><mo id="S3.E4.m1.3.3.4.2.2.1" xref="S3.E4.m1.3.3.4.2.2.1.cmml">^</mo></mover><mi id="S3.E4.m1.3.3.4.3" xref="S3.E4.m1.3.3.4.3.cmml">i</mi><mi id="S3.E4.m1.3.3.4.2.3" xref="S3.E4.m1.3.3.4.2.3.cmml">k</mi></msubsup><mo id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml">=</mo><mrow id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml"><msub id="S3.E4.m1.3.3.2.4" xref="S3.E4.m1.3.3.2.4.cmml"><mi id="S3.E4.m1.3.3.2.4.2" xref="S3.E4.m1.3.3.2.4.2.cmml">CrossAtt</mi><mrow id="S3.E4.m1.3.3.2.4.3" xref="S3.E4.m1.3.3.2.4.3.cmml"><mi mathvariant="normal" id="S3.E4.m1.3.3.2.4.3.2" xref="S3.E4.m1.3.3.2.4.3.2.cmml">R</mi><mo stretchy="false" id="S3.E4.m1.3.3.2.4.3.1" xref="S3.E4.m1.3.3.2.4.3.1.cmml">→</mo><mi mathvariant="normal" id="S3.E4.m1.3.3.2.4.3.3" xref="S3.E4.m1.3.3.2.4.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.2.3" xref="S3.E4.m1.3.3.2.3.cmml">​</mo><mrow id="S3.E4.m1.3.3.2.2.2" xref="S3.E4.m1.3.3.2.2.3.cmml"><mo maxsize="160%" minsize="160%" id="S3.E4.m1.3.3.2.2.2.3" xref="S3.E4.m1.3.3.2.2.3.cmml">(</mo><msubsup id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.2.2" xref="S3.E4.m1.2.2.1.1.1.1.2.2.cmml">v</mi><mi id="S3.E4.m1.2.2.1.1.1.1.2.3" xref="S3.E4.m1.2.2.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E4.m1.2.2.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.3.2.cmml">k</mi><mo id="S3.E4.m1.2.2.1.1.1.1.3.1" xref="S3.E4.m1.2.2.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E4.m1.2.2.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E4.m1.3.3.2.2.2.4" xref="S3.E4.m1.3.3.2.2.3.cmml">,</mo><mrow id="S3.E4.m1.3.3.2.2.2.2.2" xref="S3.E4.m1.3.3.2.2.2.2.3.cmml"><mo id="S3.E4.m1.3.3.2.2.2.2.2.3" xref="S3.E4.m1.3.3.2.2.2.2.3.cmml">{</mo><msubsup id="S3.E4.m1.3.3.2.2.2.2.1.1" xref="S3.E4.m1.3.3.2.2.2.2.1.1.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.1.1.2.2" xref="S3.E4.m1.3.3.2.2.2.2.1.1.2.2.cmml">h</mi><mn id="S3.E4.m1.3.3.2.2.2.2.1.1.2.3" xref="S3.E4.m1.3.3.2.2.2.2.1.1.2.3.cmml">1</mn><mrow id="S3.E4.m1.3.3.2.2.2.2.1.1.3" xref="S3.E4.m1.3.3.2.2.2.2.1.1.3.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.1.1.3.2" xref="S3.E4.m1.3.3.2.2.2.2.1.1.3.2.cmml">k</mi><mo id="S3.E4.m1.3.3.2.2.2.2.1.1.3.1" xref="S3.E4.m1.3.3.2.2.2.2.1.1.3.1.cmml">−</mo><mn id="S3.E4.m1.3.3.2.2.2.2.1.1.3.3" xref="S3.E4.m1.3.3.2.2.2.2.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E4.m1.3.3.2.2.2.2.2.4" xref="S3.E4.m1.3.3.2.2.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">…</mi><mo id="S3.E4.m1.3.3.2.2.2.2.2.5" xref="S3.E4.m1.3.3.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E4.m1.3.3.2.2.2.2.2.2" xref="S3.E4.m1.3.3.2.2.2.2.2.2.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.2.2.2.2" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.2.cmml">h</mi><mi id="S3.E4.m1.3.3.2.2.2.2.2.2.2.3" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.3.cmml">n</mi><mrow id="S3.E4.m1.3.3.2.2.2.2.2.2.3" xref="S3.E4.m1.3.3.2.2.2.2.2.2.3.cmml"><mi id="S3.E4.m1.3.3.2.2.2.2.2.2.3.2" xref="S3.E4.m1.3.3.2.2.2.2.2.2.3.2.cmml">k</mi><mo id="S3.E4.m1.3.3.2.2.2.2.2.2.3.1" xref="S3.E4.m1.3.3.2.2.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E4.m1.3.3.2.2.2.2.2.2.3.3" xref="S3.E4.m1.3.3.2.2.2.2.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E4.m1.3.3.2.2.2.2.2.6" xref="S3.E4.m1.3.3.2.2.2.2.3.cmml">}</mo></mrow><mo maxsize="160%" minsize="160%" id="S3.E4.m1.3.3.2.2.2.5" xref="S3.E4.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><eq id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"></eq><apply id="S3.E4.m1.3.3.4.cmml" xref="S3.E4.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.1.cmml" xref="S3.E4.m1.3.3.4">subscript</csymbol><apply id="S3.E4.m1.3.3.4.2.cmml" xref="S3.E4.m1.3.3.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.4.2.1.cmml" xref="S3.E4.m1.3.3.4">superscript</csymbol><apply id="S3.E4.m1.3.3.4.2.2.cmml" xref="S3.E4.m1.3.3.4.2.2"><ci id="S3.E4.m1.3.3.4.2.2.1.cmml" xref="S3.E4.m1.3.3.4.2.2.1">^</ci><ci id="S3.E4.m1.3.3.4.2.2.2.cmml" xref="S3.E4.m1.3.3.4.2.2.2">𝑣</ci></apply><ci id="S3.E4.m1.3.3.4.2.3.cmml" xref="S3.E4.m1.3.3.4.2.3">𝑘</ci></apply><ci id="S3.E4.m1.3.3.4.3.cmml" xref="S3.E4.m1.3.3.4.3">𝑖</ci></apply><apply id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2"><times id="S3.E4.m1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.2.3"></times><apply id="S3.E4.m1.3.3.2.4.cmml" xref="S3.E4.m1.3.3.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.4.1.cmml" xref="S3.E4.m1.3.3.2.4">subscript</csymbol><ci id="S3.E4.m1.3.3.2.4.2.cmml" xref="S3.E4.m1.3.3.2.4.2">CrossAtt</ci><apply id="S3.E4.m1.3.3.2.4.3.cmml" xref="S3.E4.m1.3.3.2.4.3"><ci id="S3.E4.m1.3.3.2.4.3.1.cmml" xref="S3.E4.m1.3.3.2.4.3.1">→</ci><ci id="S3.E4.m1.3.3.2.4.3.2.cmml" xref="S3.E4.m1.3.3.2.4.3.2">R</ci><ci id="S3.E4.m1.3.3.2.4.3.3.cmml" xref="S3.E4.m1.3.3.2.4.3.3">L</ci></apply></apply><interval closure="open" id="S3.E4.m1.3.3.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2"><apply id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.2">𝑣</ci><ci id="S3.E4.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3"><minus id="S3.E4.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.1"></minus><ci id="S3.E4.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E4.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3">1</cn></apply></apply><set id="S3.E4.m1.3.3.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2"><apply id="S3.E4.m1.3.3.2.2.2.2.1.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.2.2.1.1.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1">superscript</csymbol><apply id="S3.E4.m1.3.3.2.2.2.2.1.1.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.2.2.1.1.2.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.2.2.2.2.1.1.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1.2.2">ℎ</ci><cn type="integer" id="S3.E4.m1.3.3.2.2.2.2.1.1.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1.2.3">1</cn></apply><apply id="S3.E4.m1.3.3.2.2.2.2.1.1.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1.3"><minus id="S3.E4.m1.3.3.2.2.2.2.1.1.3.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1.3.1"></minus><ci id="S3.E4.m1.3.3.2.2.2.2.1.1.3.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="S3.E4.m1.3.3.2.2.2.2.1.1.3.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">…</ci><apply id="S3.E4.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E4.m1.3.3.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.2.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.3.3.2.2.2.2.2.2.2.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.2">ℎ</ci><ci id="S3.E4.m1.3.3.2.2.2.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.2.3">𝑛</ci></apply><apply id="S3.E4.m1.3.3.2.2.2.2.2.2.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.3"><minus id="S3.E4.m1.3.3.2.2.2.2.2.2.3.1.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.3.1"></minus><ci id="S3.E4.m1.3.3.2.2.2.2.2.2.3.2.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E4.m1.3.3.2.2.2.2.2.2.3.3.cmml" xref="S3.E4.m1.3.3.2.2.2.2.2.2.3.3">1</cn></apply></apply></set></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\displaystyle\hat{v}^{k}_{i}={\rm CrossAtt_{R\to L}}\Big{(}v_{i}^{k-1},\left\{h_{1}^{k-1},...,h_{n}^{k-1}\right\}\Big{)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.7" class="ltx_p">A residual connection and layer normalization are added after each sub-layer as in single-modality encoders.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">LXMERT is pretrained on the large scale of datasets via five diverse representative pre-training tasks: masked language modeling, masked object prediction (feature regression and label classification), cross-modality matching, and image question answering. These tasks help in learning both intra-modality and cross-modality relationships.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2010.04913/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="115" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The LXMERT model for learning vision-and-language cross-modality representations. ’Self’ and ’Cross’ are abbreviations for self-attention sub-layers and cross-attention sub-layers, respectively. ’FF’ denotes a feed-forward sub-layer. The components in the solid block which consist of an object-relation encoder, a language encoder and a cross-modality encoder are applied in our interpretable framework introduced in the following.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>The Interpretable Neural Computation</h3>

<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F2.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.04913/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_img_landscape" width="368" height="117" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.04913/assets/lstm2.png" id="S3.F2.2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="250" height="187" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F2.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2010.04913/assets/x3.png" id="S3.F2.3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="169" height="123" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Our interpretable framework has three components: first, a scene parser (Graph R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>) that generates a scene graph (c) of each image; second, a question parser (b) that converts a question in natural language into a program; third, a neural-symbolic program executor incorporated with a neural module (LXMERT) (a), which utilizes the generated programs and scene graphs to perform soft logical reasoning.</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Our framework has three components: a scene parser (de-renderer), a question parser (program generator), and a symbolic program executor with LXMERT. Given an image-question pair, the scene parser de-renders the image to obtain a scene graph (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), the question parser generates a program from the question (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), and the executor runs the program on the scene graph and passes the proposals to LXMERT to predict an answer (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Our scene parser generates a structural and disentangled representation of the scene in the image (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), based on which we can perform interpretable symbolic reasoning. We use a state-of-the-art method Graph R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> to generates the scene graphs, which classifies the object, its attributes and relationships.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">The question parser maps an input question in natural language (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) to a latent program. The program has a hierarchy of functional modules, each fulfilling an independent operation on the scene graph. Using a hierarchical program as our reasoning backbone naturally supplies compositionality and interpretability power.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">The program executor takes the program output from the question parser, applies these functional modules on the scene graph of the input image, and iteratively pass the attention object regions to the LXMERT (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) to predict the answers. The executable program performs purely symbolic operations on its input throughout the execution process, and by the cooperation with LXMERT, it could not only compensate the noisy scene graph but also endow the reasoning process with interpretability. In the following section, we introduce the three components in detail.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Scene Parser</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.1" class="ltx_p">The scene parser de-renders the image to obtain a structural scene representation, named scene graph (see Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). It generates a number of region proposals, and for each region, classifies the objects, attributes and their relationships.
We use Graph R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> to generate scene graphs for each image. Graph R-CNN is the prior art on scene graph generation, which is both effective and efficient at detecting objects and their relations in images. It utilizes Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> to localize a set of object regions, and a relation proposal network (RePN) to learn to efficiently compute relatedness scores between object pairs which are used to intelligently prune unlikely scene graph connections (as opposed to random pruning in prior work). Then, given the resulting sparsely connected scene graph candidate, it applies an attentional graph convolution network (aGCN) to propagate higher-order context throughout the graph — updating each object and relationship representation based on its neighbors. As for attributes of each object, we additionally train a simple CNN to classify them.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Question Parser</h4>

<div id="S3.SS2.SSS2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.p1.5" class="ltx_p">In GQA, each question could be represented as a program which is viewed as a sequence of functions <math id="S3.SS2.SSS2.p1.1.m1.3" class="ltx_Math" alttext="P=f_{0},f_{1},...f_{T}" display="inline"><semantics id="S3.SS2.SSS2.p1.1.m1.3a"><mrow id="S3.SS2.SSS2.p1.1.m1.3.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.3.3.5" xref="S3.SS2.SSS2.p1.1.m1.3.3.5.cmml">P</mi><mo id="S3.SS2.SSS2.p1.1.m1.3.3.4" xref="S3.SS2.SSS2.p1.1.m1.3.3.4.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.1.m1.3.3.3.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.4.cmml"><msub id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.4" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.2.cmml">f</mi><mn id="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.3" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.5" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.4.cmml">,</mo><mrow id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.2" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.1" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.1.cmml">​</mo><msub id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.2" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.2.cmml">f</mi><mi id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.3" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.3.cmml">T</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.3b"><apply id="S3.SS2.SSS2.p1.1.m1.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3"><eq id="S3.SS2.SSS2.p1.1.m1.3.3.4.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.4"></eq><ci id="S3.SS2.SSS2.p1.1.m1.3.3.5.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.5">𝑃</ci><list id="S3.SS2.SSS2.p1.1.m1.3.3.3.4.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2">𝑓</ci><cn type="integer" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3">0</cn></apply><apply id="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.2">𝑓</ci><cn type="integer" id="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.2.2.2.2.2.3">1</cn></apply><apply id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3"><times id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.1"></times><ci id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.2">…</ci><apply id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.2">𝑓</ci><ci id="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.3.3.3.3.3.3.3">𝑇</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.3c">P=f_{0},f_{1},...f_{T}</annotation></semantics></math>. Each function then sequentially executes on the output of the previous one to finally obtain the answer. There are 12 different categories of functions based on their coarse-grained functionality (e.g., “relate, verify, filter, choose, or”). In total, there are 139 fine-grained functions (e.g., “verify material, filter color, choose left<math id="S3.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="|" display="inline"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><mo fence="false" stretchy="false" id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><ci id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">|</annotation></semantics></math>right”). For example, in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, <math id="S3.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><msub id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.2">𝑓</ci><cn type="integer" id="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">f_{2}</annotation></semantics></math> is <span id="S3.SS2.SSS2.p1.5.1" class="ltx_text ltx_font_typewriter">Relate: furniture, to the right of, [1]</span>, the functionality of which is to find a furniture which is to the right if the objects returned by <math id="S3.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="f_{1}" display="inline"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><msub id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.2">𝑓</ci><cn type="integer" id="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">f_{1}</annotation></semantics></math>: <span id="S3.SS2.SSS2.p1.5.2" class="ltx_text ltx_font_typewriter">Filter hposition: left [0]</span>. <span id="S3.SS2.SSS2.p1.5.3" class="ltx_text ltx_font_typewriter">Relate</span> and <span id="S3.SS2.SSS2.p1.5.4" class="ltx_text ltx_font_typewriter">Filter</span> are called “operation”. <span id="S3.SS2.SSS2.p1.5.5" class="ltx_text ltx_font_typewriter">[1]</span> is the “dependency” which implies that function <math id="S3.SS2.SSS2.p1.5.m5.1" class="ltx_Math" alttext="f_{2}" display="inline"><semantics id="S3.SS2.SSS2.p1.5.m5.1a"><msub id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml">f</mi><mn id="S3.SS2.SSS2.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m5.1b"><apply id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.2">𝑓</ci><cn type="integer" id="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">f_{2}</annotation></semantics></math> depends on the second execution results and <span id="S3.SS2.SSS2.p1.5.6" class="ltx_text ltx_font_typewriter">furniture, to the right of</span> is the “arguments”.</p>
</div>
<div id="S3.SS2.SSS2.p2" class="ltx_para">
<p id="S3.SS2.SSS2.p2.2" class="ltx_p">Our question parser is to generate operation and arguments of each function from question sentence (dependency could be inferred from the generated function sequence, so we need not predict it). We apply an attention-based sequence to sequence (seq2seq) model with an encoder-decoder structure similar to that in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. The encoder is a bidirectional LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> that takes as input a question of variable lengths and outputs an encoded vector <math id="S3.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="e_{i}" display="inline"><semantics id="S3.SS2.SSS2.p2.1.m1.1a"><msub id="S3.SS2.SSS2.p2.1.m1.1.1" xref="S3.SS2.SSS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.1.m1.1.1.2" xref="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml">e</mi><mi id="S3.SS2.SSS2.p2.1.m1.1.1.3" xref="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.1.m1.1b"><apply id="S3.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.2">𝑒</ci><ci id="S3.SS2.SSS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.1.m1.1c">e_{i}</annotation></semantics></math> at time step <math id="S3.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS2.p2.2.m2.1a"><mi id="S3.SS2.SSS2.p2.2.m2.1.1" xref="S3.SS2.SSS2.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.2.m2.1b"><ci id="S3.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.2.m2.1c">i</annotation></semantics></math> as</p>
<table id="S5.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\displaystyle e_{i}=[e_{i}^{F},e_{i}^{B}]" display="inline"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><msub id="S3.E5.m1.2.2.4" xref="S3.E5.m1.2.2.4.cmml"><mi id="S3.E5.m1.2.2.4.2" xref="S3.E5.m1.2.2.4.2.cmml">e</mi><mi id="S3.E5.m1.2.2.4.3" xref="S3.E5.m1.2.2.4.3.cmml">i</mi></msub><mo id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml">=</mo><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml">[</mo><msubsup id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.1.2.2.cmml">e</mi><mi id="S3.E5.m1.1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml">F</mi></msubsup><mo id="S3.E5.m1.2.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><msubsup id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.cmml">e</mi><mi id="S3.E5.m1.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.3.cmml">B</mi></msubsup><mo stretchy="false" id="S3.E5.m1.2.2.2.2.5" xref="S3.E5.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"></eq><apply id="S3.E5.m1.2.2.4.cmml" xref="S3.E5.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.4.1.cmml" xref="S3.E5.m1.2.2.4">subscript</csymbol><ci id="S3.E5.m1.2.2.4.2.cmml" xref="S3.E5.m1.2.2.4.2">𝑒</ci><ci id="S3.E5.m1.2.2.4.3.cmml" xref="S3.E5.m1.2.2.4.3">𝑖</ci></apply><interval closure="closed" id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2"><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2.2">𝑒</ci><ci id="S3.E5.m1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">𝐹</ci></apply><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2">superscript</csymbol><apply id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2">𝑒</ci><ci id="S3.E5.m1.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E5.m1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.3">𝐵</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\displaystyle e_{i}=[e_{i}^{F},e_{i}^{B}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<table id="S5.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.4" class="ltx_Math" alttext="\displaystyle e_{i}^{F},h_{i}^{F}=\operatorname{LSTM}(\Phi_{E}(x_{i}),h_{i-1}^{F})\quad e_{i}^{B},h_{i}^{B}=\operatorname{LSTM}(\Phi_{E}(x_{i}),h_{i+1}^{B})" display="inline"><semantics id="S3.E6.m1.4a"><mrow id="S3.E6.m1.4.4.2" xref="S3.E6.m1.4.4.3.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.2.2" xref="S3.E6.m1.3.3.1.1.2.3.cmml"><msubsup id="S3.E6.m1.3.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.2.2" xref="S3.E6.m1.3.3.1.1.1.1.1.2.2.cmml">e</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E6.m1.3.3.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.3.cmml">F</mi></msubsup><mo id="S3.E6.m1.3.3.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml">,</mo><msubsup id="S3.E6.m1.3.3.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml">h</mi><mi id="S3.E6.m1.3.3.1.1.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3.cmml">i</mi><mi id="S3.E6.m1.3.3.1.1.2.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.2.3.cmml">F</mi></msubsup></mrow><mo id="S3.E6.m1.3.3.1.1.5" xref="S3.E6.m1.3.3.1.1.5.cmml">=</mo><mrow id="S3.E6.m1.3.3.1.1.4.2" xref="S3.E6.m1.3.3.1.1.4.3.cmml"><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">LSTM</mi><mo id="S3.E6.m1.3.3.1.1.4.2a" xref="S3.E6.m1.3.3.1.1.4.3.cmml">⁡</mo><mrow id="S3.E6.m1.3.3.1.1.4.2.2" xref="S3.E6.m1.3.3.1.1.4.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.4.2.2.3" xref="S3.E6.m1.3.3.1.1.4.3.cmml">(</mo><mrow id="S3.E6.m1.3.3.1.1.3.1.1.1" xref="S3.E6.m1.3.3.1.1.3.1.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.3.1.1.1.3" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E6.m1.3.3.1.1.3.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3.2.cmml">Φ</mi><mi id="S3.E6.m1.3.3.1.1.3.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3.3.cmml">E</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.3.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.1.1.4.2.2.4" xref="S3.E6.m1.3.3.1.1.4.3.cmml">,</mo><msubsup id="S3.E6.m1.3.3.1.1.4.2.2.2" xref="S3.E6.m1.3.3.1.1.4.2.2.2.cmml"><mi id="S3.E6.m1.3.3.1.1.4.2.2.2.2.2" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.2.cmml">h</mi><mrow id="S3.E6.m1.3.3.1.1.4.2.2.2.2.3" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.2" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.1" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.1.cmml">−</mo><mn id="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.3" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.3.3.1.1.4.2.2.2.3" xref="S3.E6.m1.3.3.1.1.4.2.2.2.3.cmml">F</mi></msubsup><mo stretchy="false" id="S3.E6.m1.3.3.1.1.4.2.2.5" xref="S3.E6.m1.3.3.1.1.4.3.cmml">)</mo></mrow></mrow></mrow><mspace width="1em" id="S3.E6.m1.4.4.2.3" xref="S3.E6.m1.4.4.3a.cmml"></mspace><mrow id="S3.E6.m1.4.4.2.2" xref="S3.E6.m1.4.4.2.2.cmml"><mrow id="S3.E6.m1.4.4.2.2.2.2" xref="S3.E6.m1.4.4.2.2.2.3.cmml"><msubsup id="S3.E6.m1.4.4.2.2.1.1.1" xref="S3.E6.m1.4.4.2.2.1.1.1.cmml"><mi id="S3.E6.m1.4.4.2.2.1.1.1.2.2" xref="S3.E6.m1.4.4.2.2.1.1.1.2.2.cmml">e</mi><mi id="S3.E6.m1.4.4.2.2.1.1.1.2.3" xref="S3.E6.m1.4.4.2.2.1.1.1.2.3.cmml">i</mi><mi id="S3.E6.m1.4.4.2.2.1.1.1.3" xref="S3.E6.m1.4.4.2.2.1.1.1.3.cmml">B</mi></msubsup><mo id="S3.E6.m1.4.4.2.2.2.2.3" xref="S3.E6.m1.4.4.2.2.2.3.cmml">,</mo><msubsup id="S3.E6.m1.4.4.2.2.2.2.2" xref="S3.E6.m1.4.4.2.2.2.2.2.cmml"><mi id="S3.E6.m1.4.4.2.2.2.2.2.2.2" xref="S3.E6.m1.4.4.2.2.2.2.2.2.2.cmml">h</mi><mi id="S3.E6.m1.4.4.2.2.2.2.2.2.3" xref="S3.E6.m1.4.4.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E6.m1.4.4.2.2.2.2.2.3" xref="S3.E6.m1.4.4.2.2.2.2.2.3.cmml">B</mi></msubsup></mrow><mo id="S3.E6.m1.4.4.2.2.5" xref="S3.E6.m1.4.4.2.2.5.cmml">=</mo><mrow id="S3.E6.m1.4.4.2.2.4.2" xref="S3.E6.m1.4.4.2.2.4.3.cmml"><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">LSTM</mi><mo id="S3.E6.m1.4.4.2.2.4.2a" xref="S3.E6.m1.4.4.2.2.4.3.cmml">⁡</mo><mrow id="S3.E6.m1.4.4.2.2.4.2.2" xref="S3.E6.m1.4.4.2.2.4.3.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.2.2.4.2.2.3" xref="S3.E6.m1.4.4.2.2.4.3.cmml">(</mo><mrow id="S3.E6.m1.4.4.2.2.3.1.1.1" xref="S3.E6.m1.4.4.2.2.3.1.1.1.cmml"><msub id="S3.E6.m1.4.4.2.2.3.1.1.1.3" xref="S3.E6.m1.4.4.2.2.3.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E6.m1.4.4.2.2.3.1.1.1.3.2" xref="S3.E6.m1.4.4.2.2.3.1.1.1.3.2.cmml">Φ</mi><mi id="S3.E6.m1.4.4.2.2.3.1.1.1.3.3" xref="S3.E6.m1.4.4.2.2.3.1.1.1.3.3.cmml">E</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.4.4.2.2.3.1.1.1.2" xref="S3.E6.m1.4.4.2.2.3.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.2" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.2" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.3" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.3" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.4.4.2.2.4.2.2.4" xref="S3.E6.m1.4.4.2.2.4.3.cmml">,</mo><msubsup id="S3.E6.m1.4.4.2.2.4.2.2.2" xref="S3.E6.m1.4.4.2.2.4.2.2.2.cmml"><mi id="S3.E6.m1.4.4.2.2.4.2.2.2.2.2" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.2.cmml">h</mi><mrow id="S3.E6.m1.4.4.2.2.4.2.2.2.2.3" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.cmml"><mi id="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.2" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.1" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.1.cmml">+</mo><mn id="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.3" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.4.4.2.2.4.2.2.2.3" xref="S3.E6.m1.4.4.2.2.4.2.2.2.3.cmml">B</mi></msubsup><mo stretchy="false" id="S3.E6.m1.4.4.2.2.4.2.2.5" xref="S3.E6.m1.4.4.2.2.4.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.4b"><apply id="S3.E6.m1.4.4.3.cmml" xref="S3.E6.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.3a.cmml" xref="S3.E6.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1"><eq id="S3.E6.m1.3.3.1.1.5.cmml" xref="S3.E6.m1.3.3.1.1.5"></eq><list id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2"><apply id="S3.E6.m1.3.3.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.2.2">𝑒</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E6.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.3">𝐹</ci></apply><apply id="S3.E6.m1.3.3.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.2">ℎ</ci><ci id="S3.E6.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E6.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2.3">𝐹</ci></apply></list><apply id="S3.E6.m1.3.3.1.1.4.3.cmml" xref="S3.E6.m1.3.3.1.1.4.2"><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">LSTM</ci><apply id="S3.E6.m1.3.3.1.1.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1"><times id="S3.E6.m1.3.3.1.1.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.2"></times><apply id="S3.E6.m1.3.3.1.1.3.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.3.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3.2">Φ</ci><ci id="S3.E6.m1.3.3.1.1.3.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.3.3">𝐸</ci></apply><apply id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.4.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.4.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.4.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.4.2.2.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.4.2.2.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.2">ℎ</ci><apply id="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.3"><minus id="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.1"></minus><ci id="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.3.3.1.1.4.2.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.4.2.2.2.3">𝐹</ci></apply></apply></apply><apply id="S3.E6.m1.4.4.2.2.cmml" xref="S3.E6.m1.4.4.2.2"><eq id="S3.E6.m1.4.4.2.2.5.cmml" xref="S3.E6.m1.4.4.2.2.5"></eq><list id="S3.E6.m1.4.4.2.2.2.3.cmml" xref="S3.E6.m1.4.4.2.2.2.2"><apply id="S3.E6.m1.4.4.2.2.1.1.1.cmml" xref="S3.E6.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E6.m1.4.4.2.2.1.1.1">superscript</csymbol><apply id="S3.E6.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.E6.m1.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.1.1.1.2.1.cmml" xref="S3.E6.m1.4.4.2.2.1.1.1">subscript</csymbol><ci id="S3.E6.m1.4.4.2.2.1.1.1.2.2.cmml" xref="S3.E6.m1.4.4.2.2.1.1.1.2.2">𝑒</ci><ci id="S3.E6.m1.4.4.2.2.1.1.1.2.3.cmml" xref="S3.E6.m1.4.4.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E6.m1.4.4.2.2.1.1.1.3.cmml" xref="S3.E6.m1.4.4.2.2.1.1.1.3">𝐵</ci></apply><apply id="S3.E6.m1.4.4.2.2.2.2.2.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.2.2.2.1.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2">superscript</csymbol><apply id="S3.E6.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E6.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2.2.2">ℎ</ci><ci id="S3.E6.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E6.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E6.m1.4.4.2.2.2.2.2.3">𝐵</ci></apply></list><apply id="S3.E6.m1.4.4.2.2.4.3.cmml" xref="S3.E6.m1.4.4.2.2.4.2"><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">LSTM</ci><apply id="S3.E6.m1.4.4.2.2.3.1.1.1.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1"><times id="S3.E6.m1.4.4.2.2.3.1.1.1.2.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.2"></times><apply id="S3.E6.m1.4.4.2.2.3.1.1.1.3.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.3.1.1.1.3.1.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.4.4.2.2.3.1.1.1.3.2.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.3.2">Φ</ci><ci id="S3.E6.m1.4.4.2.2.3.1.1.1.3.3.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.3.3">𝐸</ci></apply><apply id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.4.4.2.2.3.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.4.4.2.2.4.2.2.2.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.4.2.2.2.1.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2">superscript</csymbol><apply id="S3.E6.m1.4.4.2.2.4.2.2.2.2.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.4.4.2.2.4.2.2.2.2.1.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2">subscript</csymbol><ci id="S3.E6.m1.4.4.2.2.4.2.2.2.2.2.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.2">ℎ</ci><apply id="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.3"><plus id="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.1.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.1"></plus><ci id="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.2.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.3.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.4.4.2.2.4.2.2.2.3.cmml" xref="S3.E6.m1.4.4.2.2.4.2.2.2.3">𝐵</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.4c">\displaystyle e_{i}^{F},h_{i}^{F}=\operatorname{LSTM}(\Phi_{E}(x_{i}),h_{i-1}^{F})\quad e_{i}^{B},h_{i}^{B}=\operatorname{LSTM}(\Phi_{E}(x_{i}),h_{i+1}^{B})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p2.12" class="ltx_p">Here <math id="S3.SS2.SSS2.p2.3.m1.1" class="ltx_Math" alttext="\Phi_{E}" display="inline"><semantics id="S3.SS2.SSS2.p2.3.m1.1a"><msub id="S3.SS2.SSS2.p2.3.m1.1.1" xref="S3.SS2.SSS2.p2.3.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.p2.3.m1.1.1.2" xref="S3.SS2.SSS2.p2.3.m1.1.1.2.cmml">Φ</mi><mi id="S3.SS2.SSS2.p2.3.m1.1.1.3" xref="S3.SS2.SSS2.p2.3.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.3.m1.1b"><apply id="S3.SS2.SSS2.p2.3.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.3.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.3.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1.2">Φ</ci><ci id="S3.SS2.SSS2.p2.3.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.3.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.3.m1.1c">\Phi_{E}</annotation></semantics></math> is the jointly trained encoder word embedding. <math id="S3.SS2.SSS2.p2.4.m2.2" class="ltx_Math" alttext="(e_{i}^{F},h_{i}^{F})" display="inline"><semantics id="S3.SS2.SSS2.p2.4.m2.2a"><mrow id="S3.SS2.SSS2.p2.4.m2.2.2.2" xref="S3.SS2.SSS2.p2.4.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.4.m2.2.2.2.3" xref="S3.SS2.SSS2.p2.4.m2.2.2.3.cmml">(</mo><msubsup id="S3.SS2.SSS2.p2.4.m2.1.1.1.1" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.2" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.2.cmml">e</mi><mi id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.3" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.3" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1.3.cmml">F</mi></msubsup><mo id="S3.SS2.SSS2.p2.4.m2.2.2.2.4" xref="S3.SS2.SSS2.p2.4.m2.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS2.p2.4.m2.2.2.2.2" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.2" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.2.cmml">h</mi><mi id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.3" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.3" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2.3.cmml">F</mi></msubsup><mo stretchy="false" id="S3.SS2.SSS2.p2.4.m2.2.2.2.5" xref="S3.SS2.SSS2.p2.4.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.4.m2.2b"><interval closure="open" id="S3.SS2.SSS2.p2.4.m2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.4.m2.2.2.2"><apply id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.2">𝑒</ci><ci id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p2.4.m2.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.4.m2.1.1.1.1.3">𝐹</ci></apply><apply id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.2">ℎ</ci><ci id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p2.4.m2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.4.m2.2.2.2.2.3">𝐹</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.4.m2.2c">(e_{i}^{F},h_{i}^{F})</annotation></semantics></math>, <math id="S3.SS2.SSS2.p2.5.m3.2" class="ltx_Math" alttext="(e_{i}^{B},h_{i}^{B})" display="inline"><semantics id="S3.SS2.SSS2.p2.5.m3.2a"><mrow id="S3.SS2.SSS2.p2.5.m3.2.2.2" xref="S3.SS2.SSS2.p2.5.m3.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.5.m3.2.2.2.3" xref="S3.SS2.SSS2.p2.5.m3.2.2.3.cmml">(</mo><msubsup id="S3.SS2.SSS2.p2.5.m3.1.1.1.1" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.2" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.2.cmml">e</mi><mi id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.3" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.3" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1.3.cmml">B</mi></msubsup><mo id="S3.SS2.SSS2.p2.5.m3.2.2.2.4" xref="S3.SS2.SSS2.p2.5.m3.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS2.p2.5.m3.2.2.2.2" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.2" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.2.cmml">h</mi><mi id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.3" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.3" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2.3.cmml">B</mi></msubsup><mo stretchy="false" id="S3.SS2.SSS2.p2.5.m3.2.2.2.5" xref="S3.SS2.SSS2.p2.5.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.5.m3.2b"><interval closure="open" id="S3.SS2.SSS2.p2.5.m3.2.2.3.cmml" xref="S3.SS2.SSS2.p2.5.m3.2.2.2"><apply id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.2">𝑒</ci><ci id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p2.5.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.5.m3.1.1.1.1.3">𝐵</ci></apply><apply id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.2">ℎ</ci><ci id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p2.5.m3.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.5.m3.2.2.2.2.3">𝐵</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.5.m3.2c">(e_{i}^{B},h_{i}^{B})</annotation></semantics></math> are the outputs and hidden vectors of the forward and backward networks at time step <math id="S3.SS2.SSS2.p2.6.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS2.p2.6.m4.1a"><mi id="S3.SS2.SSS2.p2.6.m4.1.1" xref="S3.SS2.SSS2.p2.6.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.6.m4.1b"><ci id="S3.SS2.SSS2.p2.6.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.6.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.6.m4.1c">i</annotation></semantics></math>. The decoder is a similar LSTM that generates a vector <math id="S3.SS2.SSS2.p2.7.m5.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="S3.SS2.SSS2.p2.7.m5.1a"><msub id="S3.SS2.SSS2.p2.7.m5.1.1" xref="S3.SS2.SSS2.p2.7.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p2.7.m5.1.1.2" xref="S3.SS2.SSS2.p2.7.m5.1.1.2.cmml">q</mi><mi id="S3.SS2.SSS2.p2.7.m5.1.1.3" xref="S3.SS2.SSS2.p2.7.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.7.m5.1b"><apply id="S3.SS2.SSS2.p2.7.m5.1.1.cmml" xref="S3.SS2.SSS2.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.7.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p2.7.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.7.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p2.7.m5.1.1.2">𝑞</ci><ci id="S3.SS2.SSS2.p2.7.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p2.7.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.7.m5.1c">q_{t}</annotation></semantics></math> from the previous token of the output sequence. In this paper, we extend the decoder LSTM to have two heads where output operation tokens and arguments tokens, respectively (see Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). We concatenate the embedding of operation <math id="S3.SS2.SSS2.p2.8.m6.1" class="ltx_Math" alttext="o_{t-1}" display="inline"><semantics id="S3.SS2.SSS2.p2.8.m6.1a"><msub id="S3.SS2.SSS2.p2.8.m6.1.1" xref="S3.SS2.SSS2.p2.8.m6.1.1.cmml"><mi id="S3.SS2.SSS2.p2.8.m6.1.1.2" xref="S3.SS2.SSS2.p2.8.m6.1.1.2.cmml">o</mi><mrow id="S3.SS2.SSS2.p2.8.m6.1.1.3" xref="S3.SS2.SSS2.p2.8.m6.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.8.m6.1.1.3.2" xref="S3.SS2.SSS2.p2.8.m6.1.1.3.2.cmml">t</mi><mo id="S3.SS2.SSS2.p2.8.m6.1.1.3.1" xref="S3.SS2.SSS2.p2.8.m6.1.1.3.1.cmml">−</mo><mn id="S3.SS2.SSS2.p2.8.m6.1.1.3.3" xref="S3.SS2.SSS2.p2.8.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.8.m6.1b"><apply id="S3.SS2.SSS2.p2.8.m6.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.8.m6.1.1.1.cmml" xref="S3.SS2.SSS2.p2.8.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.8.m6.1.1.2.cmml" xref="S3.SS2.SSS2.p2.8.m6.1.1.2">𝑜</ci><apply id="S3.SS2.SSS2.p2.8.m6.1.1.3.cmml" xref="S3.SS2.SSS2.p2.8.m6.1.1.3"><minus id="S3.SS2.SSS2.p2.8.m6.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.8.m6.1.1.3.1"></minus><ci id="S3.SS2.SSS2.p2.8.m6.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.8.m6.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS2.p2.8.m6.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.8.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.8.m6.1c">o_{t-1}</annotation></semantics></math> and arguments <math id="S3.SS2.SSS2.p2.9.m7.1" class="ltx_Math" alttext="g_{t-1}" display="inline"><semantics id="S3.SS2.SSS2.p2.9.m7.1a"><msub id="S3.SS2.SSS2.p2.9.m7.1.1" xref="S3.SS2.SSS2.p2.9.m7.1.1.cmml"><mi id="S3.SS2.SSS2.p2.9.m7.1.1.2" xref="S3.SS2.SSS2.p2.9.m7.1.1.2.cmml">g</mi><mrow id="S3.SS2.SSS2.p2.9.m7.1.1.3" xref="S3.SS2.SSS2.p2.9.m7.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.9.m7.1.1.3.2" xref="S3.SS2.SSS2.p2.9.m7.1.1.3.2.cmml">t</mi><mo id="S3.SS2.SSS2.p2.9.m7.1.1.3.1" xref="S3.SS2.SSS2.p2.9.m7.1.1.3.1.cmml">−</mo><mn id="S3.SS2.SSS2.p2.9.m7.1.1.3.3" xref="S3.SS2.SSS2.p2.9.m7.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.9.m7.1b"><apply id="S3.SS2.SSS2.p2.9.m7.1.1.cmml" xref="S3.SS2.SSS2.p2.9.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.9.m7.1.1.1.cmml" xref="S3.SS2.SSS2.p2.9.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.9.m7.1.1.2.cmml" xref="S3.SS2.SSS2.p2.9.m7.1.1.2">𝑔</ci><apply id="S3.SS2.SSS2.p2.9.m7.1.1.3.cmml" xref="S3.SS2.SSS2.p2.9.m7.1.1.3"><minus id="S3.SS2.SSS2.p2.9.m7.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.9.m7.1.1.3.1"></minus><ci id="S3.SS2.SSS2.p2.9.m7.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.9.m7.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS2.p2.9.m7.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.9.m7.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.9.m7.1c">g_{t-1}</annotation></semantics></math> as the input of LSTM at step <math id="S3.SS2.SSS2.p2.10.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.SSS2.p2.10.m8.1a"><mi id="S3.SS2.SSS2.p2.10.m8.1.1" xref="S3.SS2.SSS2.p2.10.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.10.m8.1b"><ci id="S3.SS2.SSS2.p2.10.m8.1.1.cmml" xref="S3.SS2.SSS2.p2.10.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.10.m8.1c">t</annotation></semantics></math>. <math id="S3.SS2.SSS2.p2.11.m9.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="S3.SS2.SSS2.p2.11.m9.1a"><msub id="S3.SS2.SSS2.p2.11.m9.1.1" xref="S3.SS2.SSS2.p2.11.m9.1.1.cmml"><mi id="S3.SS2.SSS2.p2.11.m9.1.1.2" xref="S3.SS2.SSS2.p2.11.m9.1.1.2.cmml">q</mi><mi id="S3.SS2.SSS2.p2.11.m9.1.1.3" xref="S3.SS2.SSS2.p2.11.m9.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.11.m9.1b"><apply id="S3.SS2.SSS2.p2.11.m9.1.1.cmml" xref="S3.SS2.SSS2.p2.11.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.11.m9.1.1.1.cmml" xref="S3.SS2.SSS2.p2.11.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.11.m9.1.1.2.cmml" xref="S3.SS2.SSS2.p2.11.m9.1.1.2">𝑞</ci><ci id="S3.SS2.SSS2.p2.11.m9.1.1.3.cmml" xref="S3.SS2.SSS2.p2.11.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.11.m9.1c">q_{t}</annotation></semantics></math> is then fed to an attention layer to obtain a context vector <math id="S3.SS2.SSS2.p2.12.m10.1" class="ltx_Math" alttext="c_{t}" display="inline"><semantics id="S3.SS2.SSS2.p2.12.m10.1a"><msub id="S3.SS2.SSS2.p2.12.m10.1.1" xref="S3.SS2.SSS2.p2.12.m10.1.1.cmml"><mi id="S3.SS2.SSS2.p2.12.m10.1.1.2" xref="S3.SS2.SSS2.p2.12.m10.1.1.2.cmml">c</mi><mi id="S3.SS2.SSS2.p2.12.m10.1.1.3" xref="S3.SS2.SSS2.p2.12.m10.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.12.m10.1b"><apply id="S3.SS2.SSS2.p2.12.m10.1.1.cmml" xref="S3.SS2.SSS2.p2.12.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.12.m10.1.1.1.cmml" xref="S3.SS2.SSS2.p2.12.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.12.m10.1.1.2.cmml" xref="S3.SS2.SSS2.p2.12.m10.1.1.2">𝑐</ci><ci id="S3.SS2.SSS2.p2.12.m10.1.1.3.cmml" xref="S3.SS2.SSS2.p2.12.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.12.m10.1c">c_{t}</annotation></semantics></math> as a weighted sum of the encoded states via</p>
<table id="S5.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7.m1.4" class="ltx_Math" alttext="\displaystyle q_{t}=\operatorname{LSTM}([\Phi_{D}(o_{t-1}),\Phi_{D}(g_{t-1})]),\quad\alpha_{t_{i}}\propto\exp(q_{t}^{\top}W_{A}e_{i}),\quad c_{t}=\sum_{i}\alpha_{t_{i}}e_{i}" display="inline"><semantics id="S3.E7.m1.4a"><mrow id="S3.E7.m1.4.4.2" xref="S3.E7.m1.4.4.3.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><msub id="S3.E7.m1.3.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.3.2" xref="S3.E7.m1.3.3.1.1.3.2.cmml">q</mi><mi id="S3.E7.m1.3.3.1.1.3.3" xref="S3.E7.m1.3.3.1.1.3.3.cmml">t</mi></msub><mo id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">LSTM</mi><mo id="S3.E7.m1.3.3.1.1.1.1a" xref="S3.E7.m1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.2.cmml">(</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml">[</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">Φ</mi><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">D</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">o</mi><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.2.4" xref="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml">,</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.cmml"><msub id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.cmml"><mi mathvariant="normal" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.2.cmml">Φ</mi><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.3.cmml">D</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.2.cmml">​</mo><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.cmml">(</mo><msub id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.2.cmml">g</mi><mrow id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.2" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml">t</mi><mo id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.1" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml">−</mo><mn id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.5" xref="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S3.E7.m1.3.3.1.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E7.m1.4.4.2.3" xref="S3.E7.m1.4.4.3a.cmml">,</mo><mrow id="S3.E7.m1.4.4.2.2.2" xref="S3.E7.m1.4.4.2.2.3.cmml"><mrow id="S3.E7.m1.4.4.2.2.1.1" xref="S3.E7.m1.4.4.2.2.1.1.cmml"><msub id="S3.E7.m1.4.4.2.2.1.1.3" xref="S3.E7.m1.4.4.2.2.1.1.3.cmml"><mi id="S3.E7.m1.4.4.2.2.1.1.3.2" xref="S3.E7.m1.4.4.2.2.1.1.3.2.cmml">α</mi><msub id="S3.E7.m1.4.4.2.2.1.1.3.3" xref="S3.E7.m1.4.4.2.2.1.1.3.3.cmml"><mi id="S3.E7.m1.4.4.2.2.1.1.3.3.2" xref="S3.E7.m1.4.4.2.2.1.1.3.3.2.cmml">t</mi><mi id="S3.E7.m1.4.4.2.2.1.1.3.3.3" xref="S3.E7.m1.4.4.2.2.1.1.3.3.3.cmml">i</mi></msub></msub><mo id="S3.E7.m1.4.4.2.2.1.1.2" xref="S3.E7.m1.4.4.2.2.1.1.2.cmml">∝</mo><mrow id="S3.E7.m1.4.4.2.2.1.1.1.1" xref="S3.E7.m1.4.4.2.2.1.1.1.2.cmml"><mi id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml">exp</mi><mo id="S3.E7.m1.4.4.2.2.1.1.1.1a" xref="S3.E7.m1.4.4.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.E7.m1.4.4.2.2.1.1.1.1.1" xref="S3.E7.m1.4.4.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.2" xref="S3.E7.m1.4.4.2.2.1.1.1.2.cmml">(</mo><mrow id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.cmml"><msubsup id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.2.cmml">q</mi><mi id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.3.cmml">t</mi><mo id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.3" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.1" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.2" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.3" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.3.cmml">A</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.1a" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.cmml"><mi id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.2" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.2.cmml">e</mi><mi id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.3" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.3" xref="S3.E7.m1.4.4.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E7.m1.4.4.2.2.2.3" xref="S3.E7.m1.4.4.2.2.3a.cmml">,</mo><mrow id="S3.E7.m1.4.4.2.2.2.2" xref="S3.E7.m1.4.4.2.2.2.2.cmml"><msub id="S3.E7.m1.4.4.2.2.2.2.2" xref="S3.E7.m1.4.4.2.2.2.2.2.cmml"><mi id="S3.E7.m1.4.4.2.2.2.2.2.2" xref="S3.E7.m1.4.4.2.2.2.2.2.2.cmml">c</mi><mi id="S3.E7.m1.4.4.2.2.2.2.2.3" xref="S3.E7.m1.4.4.2.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.E7.m1.4.4.2.2.2.2.1" xref="S3.E7.m1.4.4.2.2.2.2.1.cmml">=</mo><mrow id="S3.E7.m1.4.4.2.2.2.2.3" xref="S3.E7.m1.4.4.2.2.2.2.3.cmml"><mstyle displaystyle="true" id="S3.E7.m1.4.4.2.2.2.2.3.1" xref="S3.E7.m1.4.4.2.2.2.2.3.1.cmml"><munder id="S3.E7.m1.4.4.2.2.2.2.3.1a" xref="S3.E7.m1.4.4.2.2.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E7.m1.4.4.2.2.2.2.3.1.2" xref="S3.E7.m1.4.4.2.2.2.2.3.1.2.cmml">∑</mo><mi id="S3.E7.m1.4.4.2.2.2.2.3.1.3" xref="S3.E7.m1.4.4.2.2.2.2.3.1.3.cmml">i</mi></munder></mstyle><mrow id="S3.E7.m1.4.4.2.2.2.2.3.2" xref="S3.E7.m1.4.4.2.2.2.2.3.2.cmml"><msub id="S3.E7.m1.4.4.2.2.2.2.3.2.2" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.cmml"><mi id="S3.E7.m1.4.4.2.2.2.2.3.2.2.2" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.2.cmml">α</mi><msub id="S3.E7.m1.4.4.2.2.2.2.3.2.2.3" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.cmml"><mi id="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.2" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.2.cmml">t</mi><mi id="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.3" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.3.cmml">i</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.4.4.2.2.2.2.3.2.1" xref="S3.E7.m1.4.4.2.2.2.2.3.2.1.cmml">​</mo><msub id="S3.E7.m1.4.4.2.2.2.2.3.2.3" xref="S3.E7.m1.4.4.2.2.2.2.3.2.3.cmml"><mi id="S3.E7.m1.4.4.2.2.2.2.3.2.3.2" xref="S3.E7.m1.4.4.2.2.2.2.3.2.3.2.cmml">e</mi><mi id="S3.E7.m1.4.4.2.2.2.2.3.2.3.3" xref="S3.E7.m1.4.4.2.2.2.2.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.4b"><apply id="S3.E7.m1.4.4.3.cmml" xref="S3.E7.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.3a.cmml" xref="S3.E7.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1"><eq id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"></eq><apply id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2">𝑞</ci><ci id="S3.E7.m1.3.3.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.3.3">𝑡</ci></apply><apply id="S3.E7.m1.3.3.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">LSTM</ci><interval closure="closed" id="S3.E7.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2"><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1"><times id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.2">Φ</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.3.3">𝐷</ci></apply><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑜</ci><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><minus id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1"></minus><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2"><times id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.2"></times><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.2">Φ</ci><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.3.3">𝐷</ci></apply><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.2">𝑔</ci><apply id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3"><minus id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.1"></minus><ci id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.1.1.2.2.1.1.1.3.3">1</cn></apply></apply></apply></interval></apply></apply><apply id="S3.E7.m1.4.4.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.3a.cmml" xref="S3.E7.m1.4.4.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.4.4.2.2.1.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1"><csymbol cd="latexml" id="S3.E7.m1.4.4.2.2.1.1.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.2">proportional-to</csymbol><apply id="S3.E7.m1.4.4.2.2.1.1.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.3.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.3">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.1.1.3.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.3.2">𝛼</ci><apply id="S3.E7.m1.4.4.2.2.1.1.3.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.3.3.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.1.1.3.3.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.3.3.2">𝑡</ci><ci id="S3.E7.m1.4.4.2.2.1.1.3.3.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E7.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1"><exp id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"></exp><apply id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1"><times id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.2">𝑞</ci><ci id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><csymbol cd="latexml" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.2.3">top</csymbol></apply><apply id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.3.3">𝐴</ci></apply><apply id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.2">𝑒</ci><ci id="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E7.m1.4.4.2.2.1.1.1.1.1.1.4.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E7.m1.4.4.2.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2"><eq id="S3.E7.m1.4.4.2.2.2.2.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2.1"></eq><apply id="S3.E7.m1.4.4.2.2.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.2.2.2.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.2.2">𝑐</ci><ci id="S3.E7.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.2.2.2.3">𝑡</ci></apply><apply id="S3.E7.m1.4.4.2.2.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3"><apply id="S3.E7.m1.4.4.2.2.2.2.3.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.2.2.3.1.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.1">subscript</csymbol><sum id="S3.E7.m1.4.4.2.2.2.2.3.1.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.1.2"></sum><ci id="S3.E7.m1.4.4.2.2.2.2.3.1.3.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.1.3">𝑖</ci></apply><apply id="S3.E7.m1.4.4.2.2.2.2.3.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2"><times id="S3.E7.m1.4.4.2.2.2.2.3.2.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.1"></times><apply id="S3.E7.m1.4.4.2.2.2.2.3.2.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.2.2.3.2.2.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.2.2.3.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.2">𝛼</ci><apply id="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.3">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.2">𝑡</ci><ci id="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.3.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.E7.m1.4.4.2.2.2.2.3.2.3.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.2.2.3.2.3.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.3">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.2.2.3.2.3.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.3.2">𝑒</ci><ci id="S3.E7.m1.4.4.2.2.2.2.3.2.3.3.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.4c">\displaystyle q_{t}=\operatorname{LSTM}([\Phi_{D}(o_{t-1}),\Phi_{D}(g_{t-1})]),\quad\alpha_{t_{i}}\propto\exp(q_{t}^{\top}W_{A}e_{i}),\quad c_{t}=\sum_{i}\alpha_{t_{i}}e_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.p2.18" class="ltx_p">where <math id="S3.SS2.SSS2.p2.13.m1.1" class="ltx_Math" alttext="\Phi_{D}" display="inline"><semantics id="S3.SS2.SSS2.p2.13.m1.1a"><msub id="S3.SS2.SSS2.p2.13.m1.1.1" xref="S3.SS2.SSS2.p2.13.m1.1.1.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.p2.13.m1.1.1.2" xref="S3.SS2.SSS2.p2.13.m1.1.1.2.cmml">Φ</mi><mi id="S3.SS2.SSS2.p2.13.m1.1.1.3" xref="S3.SS2.SSS2.p2.13.m1.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.13.m1.1b"><apply id="S3.SS2.SSS2.p2.13.m1.1.1.cmml" xref="S3.SS2.SSS2.p2.13.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.13.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.13.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.13.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.13.m1.1.1.2">Φ</ci><ci id="S3.SS2.SSS2.p2.13.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.13.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.13.m1.1c">\Phi_{D}</annotation></semantics></math> is the decoder word embedding. For simplicity we set the dimensions of vectors <math id="S3.SS2.SSS2.p2.14.m2.1" class="ltx_Math" alttext="q_{t}" display="inline"><semantics id="S3.SS2.SSS2.p2.14.m2.1a"><msub id="S3.SS2.SSS2.p2.14.m2.1.1" xref="S3.SS2.SSS2.p2.14.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p2.14.m2.1.1.2" xref="S3.SS2.SSS2.p2.14.m2.1.1.2.cmml">q</mi><mi id="S3.SS2.SSS2.p2.14.m2.1.1.3" xref="S3.SS2.SSS2.p2.14.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.14.m2.1b"><apply id="S3.SS2.SSS2.p2.14.m2.1.1.cmml" xref="S3.SS2.SSS2.p2.14.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.14.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p2.14.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.14.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p2.14.m2.1.1.2">𝑞</ci><ci id="S3.SS2.SSS2.p2.14.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p2.14.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.14.m2.1c">q_{t}</annotation></semantics></math>, <math id="S3.SS2.SSS2.p2.15.m3.1" class="ltx_Math" alttext="e_{i}" display="inline"><semantics id="S3.SS2.SSS2.p2.15.m3.1a"><msub id="S3.SS2.SSS2.p2.15.m3.1.1" xref="S3.SS2.SSS2.p2.15.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p2.15.m3.1.1.2" xref="S3.SS2.SSS2.p2.15.m3.1.1.2.cmml">e</mi><mi id="S3.SS2.SSS2.p2.15.m3.1.1.3" xref="S3.SS2.SSS2.p2.15.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.15.m3.1b"><apply id="S3.SS2.SSS2.p2.15.m3.1.1.cmml" xref="S3.SS2.SSS2.p2.15.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.15.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p2.15.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.15.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p2.15.m3.1.1.2">𝑒</ci><ci id="S3.SS2.SSS2.p2.15.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p2.15.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.15.m3.1c">e_{i}</annotation></semantics></math> to be the same and let the attention weight matrix <math id="S3.SS2.SSS2.p2.16.m4.1" class="ltx_Math" alttext="W_{A}" display="inline"><semantics id="S3.SS2.SSS2.p2.16.m4.1a"><msub id="S3.SS2.SSS2.p2.16.m4.1.1" xref="S3.SS2.SSS2.p2.16.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p2.16.m4.1.1.2" xref="S3.SS2.SSS2.p2.16.m4.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS2.p2.16.m4.1.1.3" xref="S3.SS2.SSS2.p2.16.m4.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.16.m4.1b"><apply id="S3.SS2.SSS2.p2.16.m4.1.1.cmml" xref="S3.SS2.SSS2.p2.16.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.16.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p2.16.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.16.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p2.16.m4.1.1.2">𝑊</ci><ci id="S3.SS2.SSS2.p2.16.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p2.16.m4.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.16.m4.1c">W_{A}</annotation></semantics></math> to be an identity matrix. Finally, the context vector, together with the decoder output, is passed to a fully connected layers with softmax activation to obtain the distribution for the predicted token <math id="S3.SS2.SSS2.p2.17.m5.1" class="ltx_Math" alttext="o_{t}\sim{\rm softmax}(W_{O}[q_{t},c_{t}])" display="inline"><semantics id="S3.SS2.SSS2.p2.17.m5.1a"><mrow id="S3.SS2.SSS2.p2.17.m5.1.1" xref="S3.SS2.SSS2.p2.17.m5.1.1.cmml"><msub id="S3.SS2.SSS2.p2.17.m5.1.1.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.17.m5.1.1.3.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.3.2.cmml">o</mi><mi id="S3.SS2.SSS2.p2.17.m5.1.1.3.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS2.SSS2.p2.17.m5.1.1.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.2.cmml">∼</mo><mrow id="S3.SS2.SSS2.p2.17.m5.1.1.1" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.17.m5.1.1.1.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.17.m5.1.1.1.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.cmml"><mi id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.2.cmml">W</mi><mi id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.3.cmml">O</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.4" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.2" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.2.cmml">c</mi><mi id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.5" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.17.m5.1b"><apply id="S3.SS2.SSS2.p2.17.m5.1.1.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p2.17.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.2">similar-to</csymbol><apply id="S3.SS2.SSS2.p2.17.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.17.m5.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p2.17.m5.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.3.2">𝑜</ci><ci id="S3.SS2.SSS2.p2.17.m5.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS2.p2.17.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1"><times id="S3.SS2.SSS2.p2.17.m5.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.2"></times><ci id="S3.SS2.SSS2.p2.17.m5.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.3">softmax</ci><apply id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1"><times id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.3"></times><apply id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.1.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.2.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.2">𝑊</ci><ci id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.3.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.4.3">𝑂</ci></apply><interval closure="closed" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2"><apply id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.2">𝑐</ci><ci id="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.17.m5.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.17.m5.1c">o_{t}\sim{\rm softmax}(W_{O}[q_{t},c_{t}])</annotation></semantics></math> and <math id="S3.SS2.SSS2.p2.18.m6.1" class="ltx_Math" alttext="g_{t}\sim{\rm softmax}(W_{G}[q_{t},c_{t}])" display="inline"><semantics id="S3.SS2.SSS2.p2.18.m6.1a"><mrow id="S3.SS2.SSS2.p2.18.m6.1.1" xref="S3.SS2.SSS2.p2.18.m6.1.1.cmml"><msub id="S3.SS2.SSS2.p2.18.m6.1.1.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.3.cmml"><mi id="S3.SS2.SSS2.p2.18.m6.1.1.3.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.3.2.cmml">g</mi><mi id="S3.SS2.SSS2.p2.18.m6.1.1.3.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.3.3.cmml">t</mi></msub><mo id="S3.SS2.SSS2.p2.18.m6.1.1.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.2.cmml">∼</mo><mrow id="S3.SS2.SSS2.p2.18.m6.1.1.1" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.18.m6.1.1.1.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.3.cmml">softmax</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.18.m6.1.1.1.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.cmml"><mi id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.2.cmml">W</mi><mi id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.3.cmml">[</mo><msub id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.2.cmml">q</mi><mi id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.4" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.2" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.2.cmml">c</mi><mi id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.5" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.3" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p2.18.m6.1b"><apply id="S3.SS2.SSS2.p2.18.m6.1.1.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p2.18.m6.1.1.2.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.2">similar-to</csymbol><apply id="S3.SS2.SSS2.p2.18.m6.1.1.3.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.18.m6.1.1.3.1.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p2.18.m6.1.1.3.2.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.3.2">𝑔</ci><ci id="S3.SS2.SSS2.p2.18.m6.1.1.3.3.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS2.p2.18.m6.1.1.1.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1"><times id="S3.SS2.SSS2.p2.18.m6.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.2"></times><ci id="S3.SS2.SSS2.p2.18.m6.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.3">softmax</ci><apply id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1"><times id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.3"></times><apply id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.1.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.2.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.2">𝑊</ci><ci id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.3.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.4.3">𝐺</ci></apply><interval closure="closed" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2"><apply id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.2">𝑞</ci><ci id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.2">𝑐</ci><ci id="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p2.18.m6.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p2.18.m6.1c">g_{t}\sim{\rm softmax}(W_{G}[q_{t},c_{t}])</annotation></semantics></math>. Both the encoder and decoder have two hidden layers with a 256-dim hidden vector. We set the dimensions of both the encoder and decoder word vectors to be 300.</p>
</div>
</section>
<section id="S3.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>The Soft Logic Program Execution</h4>

<div id="S3.SS2.SSS3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.p1.1" class="ltx_p">Previous neural-symbolic based work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> implements the program executor as a collection of deterministic, generic functional modules in Python, designed to host all logic operations on the scene graphs of synthetic images. However, the state-of-the-art scene graph generation of real images is far from practical to support all logical operations (the actual R@20 results of scene graph generation methods are around 25% while the desired are near 90%). Therefore, we apply a soft logic reasoning process that incorporates the symbolic program executor into a neural module (LXMERT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>) which learns a strong vision-and-language representation to compensate the noisy scene graphs and on the other side, the program executor endows the LXMERT with the interpretability and sound attention regions.</p>
</div>
<section id="S3.SS2.SSS3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">The Selection of Functions.</h5>

<div id="S3.SS2.SSS3.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS3.Px1.p1.10" class="ltx_p">The symbolic program executor performs purely symbolic operations on its input.
For example, given a scene graph (see Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), <span id="S3.SS2.SSS3.Px1.p1.10.1" class="ltx_text ltx_font_typewriter">Select: bird</span> is to find the bounding boxes that contain bird – the four red circles. <span id="S3.SS2.SSS3.Px1.p1.10.2" class="ltx_text ltx_font_typewriter">Filter hposition: left [0]</span> is to pick the one that locates on the left side (the darker red circle). <span id="S3.SS2.SSS3.Px1.p1.10.3" class="ltx_text ltx_font_typewriter">Relate: furniture, to the right of, [1]</span> is to find the furniture that is to the right of the picked bird – the green circle.
The functions output values could be <em id="S3.SS2.SSS3.Px1.p1.10.4" class="ltx_emph ltx_font_italic">List of Objects</em>, <em id="S3.SS2.SSS3.Px1.p1.10.5" class="ltx_emph ltx_font_italic">Boolean</em> or <em id="S3.SS2.SSS3.Px1.p1.10.6" class="ltx_emph ltx_font_italic">String</em> (we call these function sets <math id="S3.SS2.SSS3.Px1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{F}_{O}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.1.m1.1a"><msub id="S3.SS2.SSS3.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS3.Px1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS3.Px1.p1.1.m1.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.1.m1.1.1.3" xref="S3.SS2.SSS3.Px1.p1.1.m1.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS3.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.1.m1.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.1.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.1.m1.1c">\mathcal{F}_{O}</annotation></semantics></math>, <math id="S3.SS2.SSS3.Px1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{F}_{B}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.2.m2.1a"><msub id="S3.SS2.SSS3.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS3.Px1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS3.Px1.p1.2.m2.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS3.Px1.p1.2.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS3.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.2.m2.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.2.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.2.m2.1c">\mathcal{F}_{B}</annotation></semantics></math> and <math id="S3.SS2.SSS3.Px1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{F}_{S}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.3.m3.1a"><msub id="S3.SS2.SSS3.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS3.Px1.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.3.m3.1.1.2" xref="S3.SS2.SSS3.Px1.p1.3.m3.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.3.m3.1.1.3" xref="S3.SS2.SSS3.Px1.p1.3.m3.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.3.m3.1b"><apply id="S3.SS2.SSS3.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.3.m3.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.3.m3.1c">\mathcal{F}_{S}</annotation></semantics></math>, respectively, for simplicity), where <em id="S3.SS2.SSS3.Px1.p1.10.7" class="ltx_emph ltx_font_italic">Object</em> specifically refers to the detected bounding box and <em id="S3.SS2.SSS3.Px1.p1.10.8" class="ltx_emph ltx_font_italic">String</em> could refer to object name, attributes, relations, etc. Generally,
<math id="S3.SS2.SSS3.Px1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{F}_{O}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.4.m4.1a"><msub id="S3.SS2.SSS3.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS3.Px1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.4.m4.1.1.2" xref="S3.SS2.SSS3.Px1.p1.4.m4.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.4.m4.1.1.3" xref="S3.SS2.SSS3.Px1.p1.4.m4.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.4.m4.1b"><apply id="S3.SS2.SSS3.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.4.m4.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.4.m4.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.4.m4.1c">\mathcal{F}_{O}</annotation></semantics></math> would re-locate the attention of the object regions while <math id="S3.SS2.SSS3.Px1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{F}_{B}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.5.m5.1a"><msub id="S3.SS2.SSS3.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS3.Px1.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.5.m5.1.1.2" xref="S3.SS2.SSS3.Px1.p1.5.m5.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.5.m5.1.1.3" xref="S3.SS2.SSS3.Px1.p1.5.m5.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.5.m5.1b"><apply id="S3.SS2.SSS3.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.5.m5.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.5.m5.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.5.m5.1c">\mathcal{F}_{B}</annotation></semantics></math> and <math id="S3.SS2.SSS3.Px1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{F}_{S}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.6.m6.1a"><msub id="S3.SS2.SSS3.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS3.Px1.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.6.m6.1.1.2" xref="S3.SS2.SSS3.Px1.p1.6.m6.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.6.m6.1.1.3" xref="S3.SS2.SSS3.Px1.p1.6.m6.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.6.m6.1b"><apply id="S3.SS2.SSS3.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.6.m6.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.6.m6.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.6.m6.1c">\mathcal{F}_{S}</annotation></semantics></math> would not, and <math id="S3.SS2.SSS3.Px1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{F}_{O}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.7.m7.1a"><msub id="S3.SS2.SSS3.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS3.Px1.p1.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.7.m7.1.1.2" xref="S3.SS2.SSS3.Px1.p1.7.m7.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.7.m7.1.1.3" xref="S3.SS2.SSS3.Px1.p1.7.m7.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.7.m7.1b"><apply id="S3.SS2.SSS3.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.7.m7.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.7.m7.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.7.m7.1c">\mathcal{F}_{O}</annotation></semantics></math> is always at the front of the function sequence and followed <math id="S3.SS2.SSS3.Px1.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{F}_{B}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.8.m8.1a"><msub id="S3.SS2.SSS3.Px1.p1.8.m8.1.1" xref="S3.SS2.SSS3.Px1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.8.m8.1.1.2" xref="S3.SS2.SSS3.Px1.p1.8.m8.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.8.m8.1.1.3" xref="S3.SS2.SSS3.Px1.p1.8.m8.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.8.m8.1b"><apply id="S3.SS2.SSS3.Px1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.8.m8.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.8.m8.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.8.m8.1c">\mathcal{F}_{B}</annotation></semantics></math> and <math id="S3.SS2.SSS3.Px1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{F}_{S}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.9.m9.1a"><msub id="S3.SS2.SSS3.Px1.p1.9.m9.1.1" xref="S3.SS2.SSS3.Px1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.9.m9.1.1.2" xref="S3.SS2.SSS3.Px1.p1.9.m9.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.9.m9.1.1.3" xref="S3.SS2.SSS3.Px1.p1.9.m9.1.1.3.cmml">S</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.9.m9.1b"><apply id="S3.SS2.SSS3.Px1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.9.m9.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.9.m9.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.9.m9.1c">\mathcal{F}_{S}</annotation></semantics></math>. To help LXMERT locate attention on proper regions, <math id="S3.SS2.SSS3.Px1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{F}_{O}" display="inline"><semantics id="S3.SS2.SSS3.Px1.p1.10.m10.1a"><msub id="S3.SS2.SSS3.Px1.p1.10.m10.1.1" xref="S3.SS2.SSS3.Px1.p1.10.m10.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px1.p1.10.m10.1.1.2" xref="S3.SS2.SSS3.Px1.p1.10.m10.1.1.2.cmml">ℱ</mi><mi id="S3.SS2.SSS3.Px1.p1.10.m10.1.1.3" xref="S3.SS2.SSS3.Px1.p1.10.m10.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px1.p1.10.m10.1b"><apply id="S3.SS2.SSS3.Px1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px1.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS3.Px1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px1.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS3.Px1.p1.10.m10.1.1.2">ℱ</ci><ci id="S3.SS2.SSS3.Px1.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS3.Px1.p1.10.m10.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px1.p1.10.m10.1c">\mathcal{F}_{O}</annotation></semantics></math> is chose to incorporate with LXMERT and others are ignored. For example, in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the functions that with operation <span id="S3.SS2.SSS3.Px1.p1.10.9" class="ltx_text ltx_font_typewriter">Select</span>, <span id="S3.SS2.SSS3.Px1.p1.10.10" class="ltx_text ltx_font_typewriter">Filter</span> and <span id="S3.SS2.SSS3.Px1.p1.10.11" class="ltx_text ltx_font_typewriter">Relate</span> are selected to perform re-locating regions in our framework.</p>
</div>
</section>
<section id="S3.SS2.SSS3.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Input Embeddings.</h5>

<div id="S3.SS2.SSS3.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS3.Px2.p1.1" class="ltx_p">We need to convert the inputs of LXMERT (i.e., an image and a question) into two sequences of features: word-level question embeddings and object-level image embeddings. The question embeddings are <math id="S3.SS2.SSS3.Px2.p1.1.m1.1" class="ltx_Math" alttext="\left\{h_{i}\right\}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.1.m1.1a"><mrow id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.2.cmml"><mo id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.2" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.2" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.2.cmml">h</mi><mi id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.1.m1.1b"><set id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1"><apply id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.2">ℎ</ci><ci id="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.1.m1.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.1.m1.1c">\left\{h_{i}\right\}</annotation></semantics></math>:</p>
<table id="S5.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E8.m1.3" class="ltx_Math" alttext="\displaystyle\hat{w}_{i}={\rm WordEmbed}(w_{i}),\quad\hat{u}_{i}={\rm IdxEmbed}(i),\quad h_{i}={\rm LayerNorm}(\hat{w}_{i}+\hat{u}_{i})" display="inline"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.2" xref="S3.E8.m1.3.3.3.cmml"><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.1.cmml"><msub id="S3.E8.m1.2.2.1.1.3" xref="S3.E8.m1.2.2.1.1.3.cmml"><mover accent="true" id="S3.E8.m1.2.2.1.1.3.2" xref="S3.E8.m1.2.2.1.1.3.2.cmml"><mi id="S3.E8.m1.2.2.1.1.3.2.2" xref="S3.E8.m1.2.2.1.1.3.2.2.cmml">w</mi><mo id="S3.E8.m1.2.2.1.1.3.2.1" xref="S3.E8.m1.2.2.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.2.2.1.1.3.3" xref="S3.E8.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.2" xref="S3.E8.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.3.cmml">WordEmbed</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E8.m1.3.3.2.3" xref="S3.E8.m1.3.3.3a.cmml">,</mo><mrow id="S3.E8.m1.3.3.2.2.2" xref="S3.E8.m1.3.3.2.2.3.cmml"><mrow id="S3.E8.m1.3.3.2.2.1.1" xref="S3.E8.m1.3.3.2.2.1.1.cmml"><msub id="S3.E8.m1.3.3.2.2.1.1.2" xref="S3.E8.m1.3.3.2.2.1.1.2.cmml"><mover accent="true" id="S3.E8.m1.3.3.2.2.1.1.2.2" xref="S3.E8.m1.3.3.2.2.1.1.2.2.cmml"><mi id="S3.E8.m1.3.3.2.2.1.1.2.2.2" xref="S3.E8.m1.3.3.2.2.1.1.2.2.2.cmml">u</mi><mo id="S3.E8.m1.3.3.2.2.1.1.2.2.1" xref="S3.E8.m1.3.3.2.2.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.3.3.2.2.1.1.2.3" xref="S3.E8.m1.3.3.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.E8.m1.3.3.2.2.1.1.1" xref="S3.E8.m1.3.3.2.2.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.3.3.2.2.1.1.3" xref="S3.E8.m1.3.3.2.2.1.1.3.cmml"><mi id="S3.E8.m1.3.3.2.2.1.1.3.2" xref="S3.E8.m1.3.3.2.2.1.1.3.2.cmml">IdxEmbed</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.2.2.1.1.3.1" xref="S3.E8.m1.3.3.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E8.m1.3.3.2.2.1.1.3.3.2" xref="S3.E8.m1.3.3.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.2.2.1.1.3.3.2.1" xref="S3.E8.m1.3.3.2.2.1.1.3.cmml">(</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">i</mi><mo stretchy="false" id="S3.E8.m1.3.3.2.2.1.1.3.3.2.2" xref="S3.E8.m1.3.3.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E8.m1.3.3.2.2.2.3" xref="S3.E8.m1.3.3.2.2.3a.cmml">,</mo><mrow id="S3.E8.m1.3.3.2.2.2.2" xref="S3.E8.m1.3.3.2.2.2.2.cmml"><msub id="S3.E8.m1.3.3.2.2.2.2.3" xref="S3.E8.m1.3.3.2.2.2.2.3.cmml"><mi id="S3.E8.m1.3.3.2.2.2.2.3.2" xref="S3.E8.m1.3.3.2.2.2.2.3.2.cmml">h</mi><mi id="S3.E8.m1.3.3.2.2.2.2.3.3" xref="S3.E8.m1.3.3.2.2.2.2.3.3.cmml">i</mi></msub><mo id="S3.E8.m1.3.3.2.2.2.2.2" xref="S3.E8.m1.3.3.2.2.2.2.2.cmml">=</mo><mrow id="S3.E8.m1.3.3.2.2.2.2.1" xref="S3.E8.m1.3.3.2.2.2.2.1.cmml"><mi id="S3.E8.m1.3.3.2.2.2.2.1.3" xref="S3.E8.m1.3.3.2.2.2.2.1.3.cmml">LayerNorm</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.2.2.2.2.1.2" xref="S3.E8.m1.3.3.2.2.2.2.1.2.cmml">​</mo><mrow id="S3.E8.m1.3.3.2.2.2.2.1.1.1" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.2.2.2.2.1.1.1.2" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.cmml"><msub id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.cmml"><mover accent="true" id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.cmml"><mi id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.2" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.2.cmml">w</mi><mo id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.1" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.3" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.1" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.1.cmml">+</mo><msub id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.cmml"><mover accent="true" id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.2" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.2.cmml">u</mi><mo id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.1" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.3" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E8.m1.3.3.2.2.2.2.1.1.1.3" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.3.cmml" xref="S3.E8.m1.3.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3a.cmml" xref="S3.E8.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.2.2.1.1.cmml" xref="S3.E8.m1.2.2.1.1"><eq id="S3.E8.m1.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.2"></eq><apply id="S3.E8.m1.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.3">subscript</csymbol><apply id="S3.E8.m1.2.2.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2"><ci id="S3.E8.m1.2.2.1.1.3.2.1.cmml" xref="S3.E8.m1.2.2.1.1.3.2.1">^</ci><ci id="S3.E8.m1.2.2.1.1.3.2.2.cmml" xref="S3.E8.m1.2.2.1.1.3.2.2">𝑤</ci></apply><ci id="S3.E8.m1.2.2.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.2"></times><ci id="S3.E8.m1.2.2.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.3">WordEmbed</ci><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E8.m1.3.3.2.2.3.cmml" xref="S3.E8.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.2.2.3a.cmml" xref="S3.E8.m1.3.3.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E8.m1.3.3.2.2.1.1.cmml" xref="S3.E8.m1.3.3.2.2.1.1"><eq id="S3.E8.m1.3.3.2.2.1.1.1.cmml" xref="S3.E8.m1.3.3.2.2.1.1.1"></eq><apply id="S3.E8.m1.3.3.2.2.1.1.2.cmml" xref="S3.E8.m1.3.3.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.2.2.1.1.2.1.cmml" xref="S3.E8.m1.3.3.2.2.1.1.2">subscript</csymbol><apply id="S3.E8.m1.3.3.2.2.1.1.2.2.cmml" xref="S3.E8.m1.3.3.2.2.1.1.2.2"><ci id="S3.E8.m1.3.3.2.2.1.1.2.2.1.cmml" xref="S3.E8.m1.3.3.2.2.1.1.2.2.1">^</ci><ci id="S3.E8.m1.3.3.2.2.1.1.2.2.2.cmml" xref="S3.E8.m1.3.3.2.2.1.1.2.2.2">𝑢</ci></apply><ci id="S3.E8.m1.3.3.2.2.1.1.2.3.cmml" xref="S3.E8.m1.3.3.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.E8.m1.3.3.2.2.1.1.3.cmml" xref="S3.E8.m1.3.3.2.2.1.1.3"><times id="S3.E8.m1.3.3.2.2.1.1.3.1.cmml" xref="S3.E8.m1.3.3.2.2.1.1.3.1"></times><ci id="S3.E8.m1.3.3.2.2.1.1.3.2.cmml" xref="S3.E8.m1.3.3.2.2.1.1.3.2">IdxEmbed</ci><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝑖</ci></apply></apply><apply id="S3.E8.m1.3.3.2.2.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2"><eq id="S3.E8.m1.3.3.2.2.2.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.2"></eq><apply id="S3.E8.m1.3.3.2.2.2.2.3.cmml" xref="S3.E8.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.2.2.2.2.3.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2.3">subscript</csymbol><ci id="S3.E8.m1.3.3.2.2.2.2.3.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.3.2">ℎ</ci><ci id="S3.E8.m1.3.3.2.2.2.2.3.3.cmml" xref="S3.E8.m1.3.3.2.2.2.2.3.3">𝑖</ci></apply><apply id="S3.E8.m1.3.3.2.2.2.2.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1"><times id="S3.E8.m1.3.3.2.2.2.2.1.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.2"></times><ci id="S3.E8.m1.3.3.2.2.2.2.1.3.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.3">LayerNorm</ci><apply id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1"><plus id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.1"></plus><apply id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2">subscript</csymbol><apply id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2"><ci id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.1">^</ci><ci id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.2.2">𝑤</ci></apply><ci id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3">subscript</csymbol><apply id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2"><ci id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.1">^</ci><ci id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.2.2">𝑢</ci></apply><ci id="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E8.m1.3.3.2.2.2.2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\displaystyle\hat{w}_{i}={\rm WordEmbed}(w_{i}),\quad\hat{u}_{i}={\rm IdxEmbed}(i),\quad h_{i}={\rm LayerNorm}(\hat{w}_{i}+\hat{u}_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.Px2.p1.6" class="ltx_p">where <math id="S3.SS2.SSS3.Px2.p1.2.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.2.m1.1a"><msub id="S3.SS2.SSS3.Px2.p1.2.m1.1.1" xref="S3.SS2.SSS3.Px2.p1.2.m1.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.2.m1.1.1.2" xref="S3.SS2.SSS3.Px2.p1.2.m1.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS3.Px2.p1.2.m1.1.1.3" xref="S3.SS2.SSS3.Px2.p1.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.2.m1.1b"><apply id="S3.SS2.SSS3.Px2.p1.2.m1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.2.m1.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.2.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.2.m1.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.2.m1.1.1.2">𝑤</ci><ci id="S3.SS2.SSS3.Px2.p1.2.m1.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.2.m1.1c">w_{i}</annotation></semantics></math> is a word in question sentence <math id="S3.SS2.SSS3.Px2.p1.3.m2.3" class="ltx_Math" alttext="\left\{w_{1},...,w_{n}\right\}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.3.m2.3a"><mrow id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.3.cmml"><mo id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.3" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.3.cmml">{</mo><msub id="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1" xref="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.2" xref="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.2.cmml">w</mi><mn id="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.3" xref="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.4" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS3.Px2.p1.3.m2.1.1" xref="S3.SS2.SSS3.Px2.p1.3.m2.1.1.cmml">…</mi><mo id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.5" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.3.cmml">,</mo><msub id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.cmml"><mi id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.2" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.2.cmml">w</mi><mi id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.3" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.3.cmml">n</mi></msub><mo id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.6" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.3.m2.3b"><set id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.3.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2"><apply id="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.2">𝑤</ci><cn type="integer" id="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.SSS3.Px2.p1.3.m2.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.1.1">…</ci><apply id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.1.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.2.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.2">𝑤</ci><ci id="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.3.cmml" xref="S3.SS2.SSS3.Px2.p1.3.m2.3.3.2.2.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.3.m2.3c">\left\{w_{1},...,w_{n}\right\}</annotation></semantics></math>, <math id="S3.SS2.SSS3.Px2.p1.4.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.4.m3.1a"><mi id="S3.SS2.SSS3.Px2.p1.4.m3.1.1" xref="S3.SS2.SSS3.Px2.p1.4.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.4.m3.1b"><ci id="S3.SS2.SSS3.Px2.p1.4.m3.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.4.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.4.m3.1c">i</annotation></semantics></math> is <math id="S3.SS2.SSS3.Px2.p1.5.m4.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.5.m4.1a"><msub id="S3.SS2.SSS3.Px2.p1.5.m4.1.1" xref="S3.SS2.SSS3.Px2.p1.5.m4.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.5.m4.1.1.2" xref="S3.SS2.SSS3.Px2.p1.5.m4.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS3.Px2.p1.5.m4.1.1.3" xref="S3.SS2.SSS3.Px2.p1.5.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.5.m4.1b"><apply id="S3.SS2.SSS3.Px2.p1.5.m4.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.5.m4.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.5.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.5.m4.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.5.m4.1.1.2">𝑤</ci><ci id="S3.SS2.SSS3.Px2.p1.5.m4.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.5.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.5.m4.1c">w_{i}</annotation></semantics></math>’s absolute position in the sentence. The object-level image embeddings are <math id="S3.SS2.SSS3.Px2.p1.6.m5.1" class="ltx_Math" alttext="\left\{v_{j}\right\}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.6.m5.1a"><mrow id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.2.cmml"><mo id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.2" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.2" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.3" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.3" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.6.m5.1b"><set id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1"><apply id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.6.m5.1.1.1.1.3">𝑗</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.6.m5.1c">\left\{v_{j}\right\}</annotation></semantics></math>:</p>
<table id="S5.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E9.m1.2" class="ltx_Math" alttext="\displaystyle\hat{r}_{j}={\rm LayerNorm}(W_{F}r_{j}+b_{F}),~{}\hat{p}_{j}={\rm LayerNorm}(W_{P}p_{j}+b_{P}),~{}v_{j}=(\hat{r}_{j}+\hat{p}_{j})/2" display="inline"><semantics id="S3.E9.m1.2a"><mrow id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.3.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.2" xref="S3.E9.m1.1.1.1.1.3.2.2.cmml">r</mi><mo id="S3.E9.m1.1.1.1.1.3.2.1" xref="S3.E9.m1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml">j</mi></msub><mo id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.3.cmml">LayerNorm</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">F</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E9.m1.1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml">F</mi></msub></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.497em" id="S3.E9.m1.2.2.2.3" xref="S3.E9.m1.2.2.3a.cmml">,</mo><mrow id="S3.E9.m1.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.3.cmml"><mrow id="S3.E9.m1.2.2.2.2.1.1" xref="S3.E9.m1.2.2.2.2.1.1.cmml"><msub id="S3.E9.m1.2.2.2.2.1.1.3" xref="S3.E9.m1.2.2.2.2.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.2.2.2.2.1.1.3.2" xref="S3.E9.m1.2.2.2.2.1.1.3.2.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.3.2.2" xref="S3.E9.m1.2.2.2.2.1.1.3.2.2.cmml">p</mi><mo id="S3.E9.m1.2.2.2.2.1.1.3.2.1" xref="S3.E9.m1.2.2.2.2.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.2.2.2.2.1.1.3.3" xref="S3.E9.m1.2.2.2.2.1.1.3.3.cmml">j</mi></msub><mo id="S3.E9.m1.2.2.2.2.1.1.2" xref="S3.E9.m1.2.2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.2.2.2.2.1.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.1.3" xref="S3.E9.m1.2.2.2.2.1.1.1.3.cmml">LayerNorm</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.1.1.1.2" xref="S3.E9.m1.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E9.m1.2.2.2.2.1.1.1.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.cmml"><msub id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.2.cmml">W</mi><mi id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.3.cmml">P</mi></msub><mo lspace="0em" rspace="0em" id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.1" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.2" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.2.cmml">p</mi><mi id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.3" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.2" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.3" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml">P</mi></msub></mrow><mo stretchy="false" id="S3.E9.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.497em" id="S3.E9.m1.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E9.m1.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.cmml"><msub id="S3.E9.m1.2.2.2.2.2.2.3" xref="S3.E9.m1.2.2.2.2.2.2.3.cmml"><mi id="S3.E9.m1.2.2.2.2.2.2.3.2" xref="S3.E9.m1.2.2.2.2.2.2.3.2.cmml">v</mi><mi id="S3.E9.m1.2.2.2.2.2.2.3.3" xref="S3.E9.m1.2.2.2.2.2.2.3.3.cmml">j</mi></msub><mo id="S3.E9.m1.2.2.2.2.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.2.cmml">=</mo><mrow id="S3.E9.m1.2.2.2.2.2.2.1" xref="S3.E9.m1.2.2.2.2.2.2.1.cmml"><mrow id="S3.E9.m1.2.2.2.2.2.2.1.1.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.2.2.2.2.2.2.1.1.1.2" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.cmml"><msub id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.cmml"><mover accent="true" id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.cmml"><mi id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.2" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.2.cmml">r</mi><mo id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.3" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.1.cmml">+</mo><msub id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.cmml"><mover accent="true" id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.2" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.2.cmml">p</mi><mo id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.1" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.3" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E9.m1.2.2.2.2.2.2.1.1.1.3" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E9.m1.2.2.2.2.2.2.1.2" xref="S3.E9.m1.2.2.2.2.2.2.1.2.cmml">/</mo><mn id="S3.E9.m1.2.2.2.2.2.2.1.3" xref="S3.E9.m1.2.2.2.2.2.2.1.3.cmml">2</mn></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.2b"><apply id="S3.E9.m1.2.2.3.cmml" xref="S3.E9.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.3a.cmml" xref="S3.E9.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2"></eq><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2"><ci id="S3.E9.m1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2.1">^</ci><ci id="S3.E9.m1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2">𝑟</ci></apply><ci id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><times id="S3.E9.m1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.2"></times><ci id="S3.E9.m1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.3">LayerNorm</ci><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"><plus id="S3.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2"><times id="S3.E9.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.2.3">𝐹</ci></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E9.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1.1.3.3">𝐹</ci></apply></apply></apply></apply><apply id="S3.E9.m1.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.3a.cmml" xref="S3.E9.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E9.m1.2.2.2.2.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1"><eq id="S3.E9.m1.2.2.2.2.1.1.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.2"></eq><apply id="S3.E9.m1.2.2.2.2.1.1.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3">subscript</csymbol><apply id="S3.E9.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.2"><ci id="S3.E9.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.2.1">^</ci><ci id="S3.E9.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.2.2">𝑝</ci></apply><ci id="S3.E9.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.3.3">𝑗</ci></apply><apply id="S3.E9.m1.2.2.2.2.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1"><times id="S3.E9.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.2"></times><ci id="S3.E9.m1.2.2.2.2.1.1.1.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.3">LayerNorm</ci><apply id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1"><plus id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.1"></plus><apply id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2"><times id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.1"></times><apply id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.2">𝑊</ci><ci id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.3">𝑃</ci></apply><apply id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.2.2.2.2.1.1.1.1.1.1.3.3">𝑃</ci></apply></apply></apply></apply><apply id="S3.E9.m1.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2"><eq id="S3.E9.m1.2.2.2.2.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.2"></eq><apply id="S3.E9.m1.2.2.2.2.2.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.3.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E9.m1.2.2.2.2.2.2.3.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.3.2">𝑣</ci><ci id="S3.E9.m1.2.2.2.2.2.2.3.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.3.3">𝑗</ci></apply><apply id="S3.E9.m1.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1"><divide id="S3.E9.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.2"></divide><apply id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1"><plus id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.1"></plus><apply id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2">subscript</csymbol><apply id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2"><ci id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.1">^</ci><ci id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.2.2">𝑟</ci></apply><ci id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3">subscript</csymbol><apply id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2"><ci id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.1">^</ci><ci id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.2.2">𝑝</ci></apply><ci id="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.1.1.1.3.3">𝑗</ci></apply></apply><cn type="integer" id="S3.E9.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.2c">\displaystyle\hat{r}_{j}={\rm LayerNorm}(W_{F}r_{j}+b_{F}),~{}\hat{p}_{j}={\rm LayerNorm}(W_{P}p_{j}+b_{P}),~{}v_{j}=(\hat{r}_{j}+\hat{p}_{j})/2</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.Px2.p1.10" class="ltx_p">where each object <math id="S3.SS2.SSS3.Px2.p1.7.m1.1" class="ltx_Math" alttext="o_{j}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.7.m1.1a"><msub id="S3.SS2.SSS3.Px2.p1.7.m1.1.1" xref="S3.SS2.SSS3.Px2.p1.7.m1.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.7.m1.1.1.2" xref="S3.SS2.SSS3.Px2.p1.7.m1.1.1.2.cmml">o</mi><mi id="S3.SS2.SSS3.Px2.p1.7.m1.1.1.3" xref="S3.SS2.SSS3.Px2.p1.7.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.7.m1.1b"><apply id="S3.SS2.SSS3.Px2.p1.7.m1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.7.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.7.m1.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.7.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.7.m1.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.7.m1.1.1.2">𝑜</ci><ci id="S3.SS2.SSS3.Px2.p1.7.m1.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.7.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.7.m1.1c">o_{j}</annotation></semantics></math> is represented by its position feature (i.e., bounding box coordinates) <math id="S3.SS2.SSS3.Px2.p1.8.m2.1" class="ltx_Math" alttext="p_{j}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.8.m2.1a"><msub id="S3.SS2.SSS3.Px2.p1.8.m2.1.1" xref="S3.SS2.SSS3.Px2.p1.8.m2.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.8.m2.1.1.2" xref="S3.SS2.SSS3.Px2.p1.8.m2.1.1.2.cmml">p</mi><mi id="S3.SS2.SSS3.Px2.p1.8.m2.1.1.3" xref="S3.SS2.SSS3.Px2.p1.8.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.8.m2.1b"><apply id="S3.SS2.SSS3.Px2.p1.8.m2.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.8.m2.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.8.m2.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.8.m2.1.1.2">𝑝</ci><ci id="S3.SS2.SSS3.Px2.p1.8.m2.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.8.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.8.m2.1c">p_{j}</annotation></semantics></math> and its 2048-dimensional region-of-interest (RoI) feature <math id="S3.SS2.SSS3.Px2.p1.9.m3.1" class="ltx_Math" alttext="r_{i}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.9.m3.1a"><msub id="S3.SS2.SSS3.Px2.p1.9.m3.1.1" xref="S3.SS2.SSS3.Px2.p1.9.m3.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.9.m3.1.1.2" xref="S3.SS2.SSS3.Px2.p1.9.m3.1.1.2.cmml">r</mi><mi id="S3.SS2.SSS3.Px2.p1.9.m3.1.1.3" xref="S3.SS2.SSS3.Px2.p1.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.9.m3.1b"><apply id="S3.SS2.SSS3.Px2.p1.9.m3.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.9.m3.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.9.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.9.m3.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.9.m3.1.1.2">𝑟</ci><ci id="S3.SS2.SSS3.Px2.p1.9.m3.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.9.m3.1c">r_{i}</annotation></semantics></math>. We learn a position-aware embedding <math id="S3.SS2.SSS3.Px2.p1.10.m4.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.SS2.SSS3.Px2.p1.10.m4.1a"><msub id="S3.SS2.SSS3.Px2.p1.10.m4.1.1" xref="S3.SS2.SSS3.Px2.p1.10.m4.1.1.cmml"><mi id="S3.SS2.SSS3.Px2.p1.10.m4.1.1.2" xref="S3.SS2.SSS3.Px2.p1.10.m4.1.1.2.cmml">v</mi><mi id="S3.SS2.SSS3.Px2.p1.10.m4.1.1.3" xref="S3.SS2.SSS3.Px2.p1.10.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px2.p1.10.m4.1b"><apply id="S3.SS2.SSS3.Px2.p1.10.m4.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.10.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px2.p1.10.m4.1.1.1.cmml" xref="S3.SS2.SSS3.Px2.p1.10.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px2.p1.10.m4.1.1.2.cmml" xref="S3.SS2.SSS3.Px2.p1.10.m4.1.1.2">𝑣</ci><ci id="S3.SS2.SSS3.Px2.p1.10.m4.1.1.3.cmml" xref="S3.SS2.SSS3.Px2.p1.10.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px2.p1.10.m4.1c">v_{j}</annotation></semantics></math> by adding outputs of 2 fully-connected layers.</p>
</div>
</section>
<section id="S3.SS2.SSS3.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">The Layout</h5>

<div id="S3.SS2.SSS3.Px3.p1" class="ltx_para">
<p id="S3.SS2.SSS3.Px3.p1.7" class="ltx_p">As depicted in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, firstly, object-level image embeddings of all the objects in each image(<math id="S3.SS2.SSS3.Px3.p1.1.m1.1" class="ltx_Math" alttext="V_{0}=\left\{v_{j}\right\}" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.1.m1.1a"><mrow id="S3.SS2.SSS3.Px3.p1.1.m1.1.1" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.cmml"><msub id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.2.cmml">V</mi><mn id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.3.cmml">0</mn></msub><mo id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.2" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.2.cmml"><mo id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.2" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.3" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.1.m1.1b"><apply id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1"><eq id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.2"></eq><apply id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.2">𝑉</ci><cn type="integer" id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.3.3">0</cn></apply><set id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1"><apply id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.Px3.p1.1.m1.1.1.1.1.1.3">𝑗</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.1.m1.1c">V_{0}=\left\{v_{j}\right\}</annotation></semantics></math>) and question embeddings (<math id="S3.SS2.SSS3.Px3.p1.2.m2.1" class="ltx_Math" alttext="L_{0}=\left\{h_{i}\right\}" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.2.m2.1a"><mrow id="S3.SS2.SSS3.Px3.p1.2.m2.1.1" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.cmml"><msub id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.2.cmml">L</mi><mn id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.3.cmml">0</mn></msub><mo id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.2" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.2" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.2.cmml">h</mi><mi id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.3" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.2.m2.1b"><apply id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1"><eq id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.2"></eq><apply id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.2">𝐿</ci><cn type="integer" id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.3.3">0</cn></apply><set id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1"><apply id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.2">ℎ</ci><ci id="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.Px3.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.2.m2.1c">L_{0}=\left\{h_{i}\right\}</annotation></semantics></math>) are fed to LXMERT.
Then, the function <math id="S3.SS2.SSS3.Px3.p1.3.m3.1" class="ltx_Math" alttext="f_{t}\in\mathcal{P}_{O}" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.3.m3.1a"><mrow id="S3.SS2.SSS3.Px3.p1.3.m3.1.1" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.cmml"><msub id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.cmml"><mi id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.2" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.2.cmml">f</mi><mi id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.3" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.1" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.1.cmml">∈</mo><msub id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.2.cmml">𝒫</mi><mi id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.3" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.3.cmml">O</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.3.m3.1b"><apply id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1"><in id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.1"></in><apply id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.2">𝑓</ci><ci id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.3.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.2.3">𝑡</ci></apply><apply id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.2">𝒫</ci><ci id="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS3.Px3.p1.3.m3.1.1.3.3">𝑂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.3.m3.1c">f_{t}\in\mathcal{P}_{O}</annotation></semantics></math> selects a list of objects at every step <math id="S3.SS2.SSS3.Px3.p1.4.m4.3" class="ltx_Math" alttext="t\in\left\{0,...,T\right\}" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.4.m4.3a"><mrow id="S3.SS2.SSS3.Px3.p1.4.m4.3.4" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.cmml"><mi id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.2" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.2.cmml">t</mi><mo id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.1" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.1.cmml">∈</mo><mrow id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.2" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.1.cmml"><mo id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.2.1" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.1.cmml">{</mo><mn id="S3.SS2.SSS3.Px3.p1.4.m4.1.1" xref="S3.SS2.SSS3.Px3.p1.4.m4.1.1.cmml">0</mn><mo id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.2.2" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS3.Px3.p1.4.m4.2.2" xref="S3.SS2.SSS3.Px3.p1.4.m4.2.2.cmml">…</mi><mo id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.2.3" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS3.Px3.p1.4.m4.3.3" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.3.cmml">T</mi><mo id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.2.4" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.4.m4.3b"><apply id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.cmml" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4"><in id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.1.cmml" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.1"></in><ci id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.2.cmml" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.2">𝑡</ci><set id="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.4.3.2"><cn type="integer" id="S3.SS2.SSS3.Px3.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.4.m4.1.1">0</cn><ci id="S3.SS2.SSS3.Px3.p1.4.m4.2.2.cmml" xref="S3.SS2.SSS3.Px3.p1.4.m4.2.2">…</ci><ci id="S3.SS2.SSS3.Px3.p1.4.m4.3.3.cmml" xref="S3.SS2.SSS3.Px3.p1.4.m4.3.3">𝑇</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.4.m4.3c">t\in\left\{0,...,T\right\}</annotation></semantics></math> via our program executor, and the embeddings of selected object <math id="S3.SS2.SSS3.Px3.p1.5.m5.1" class="ltx_Math" alttext="V_{t+1}" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.5.m5.1a"><msub id="S3.SS2.SSS3.Px3.p1.5.m5.1.1" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.2" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.2.cmml">V</mi><mrow id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.2" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.2.cmml">t</mi><mo id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.1" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.1.cmml">+</mo><mn id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.3" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.5.m5.1b"><apply id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.2">𝑉</ci><apply id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3"><plus id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.1"></plus><ci id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS3.Px3.p1.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.5.m5.1c">V_{t+1}</annotation></semantics></math>, together with previous language representation output of LXMERT <math id="S3.SS2.SSS3.Px3.p1.6.m6.1" class="ltx_Math" alttext="L_{t+1}" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.6.m6.1a"><msub id="S3.SS2.SSS3.Px3.p1.6.m6.1.1" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.2" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.2.cmml">L</mi><mrow id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.2" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.2.cmml">t</mi><mo id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.1" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.1.cmml">+</mo><mn id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.3" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.6.m6.1b"><apply id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.2">𝐿</ci><apply id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3"><plus id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.1"></plus><ci id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS3.Px3.p1.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.6.m6.1c">L_{t+1}</annotation></semantics></math>, are passed to LXMERT to output the next language representation <math id="S3.SS2.SSS3.Px3.p1.7.m7.1" class="ltx_Math" alttext="L_{t+2}" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.7.m7.1a"><msub id="S3.SS2.SSS3.Px3.p1.7.m7.1.1" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.2" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.2.cmml">L</mi><mrow id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.cmml"><mi id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.2" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.2.cmml">t</mi><mo id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.1" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.1.cmml">+</mo><mn id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.3" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.3.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.7.m7.1b"><apply id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.2">𝐿</ci><apply id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3"><plus id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.1"></plus><ci id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.2.cmml" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.3.cmml" xref="S3.SS2.SSS3.Px3.p1.7.m7.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.7.m7.1c">L_{t+2}</annotation></semantics></math>. These could be formulated as:</p>
<table id="S5.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E10.m1.2" class="ltx_Math" alttext="\displaystyle L_{0}=\left\{h_{i}\right\},~{}V_{0}=\left\{v_{j}\right\},~{}V_{t+1}={\rm ImEmb}({\rm Exe}(f_{t},V_{t})),~{}L_{t+1}={\rm LXMERT}(V_{t},L_{t})" display="inline"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.3.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.3.2.cmml">L</mi><mn id="S3.E10.m1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.3.3.cmml">0</mn></msub><mo id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.2.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">{</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo rspace="0.497em" id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.3a.cmml">,</mo><mrow id="S3.E10.m1.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.3.cmml"><mrow id="S3.E10.m1.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.1.1.cmml"><msub id="S3.E10.m1.2.2.2.2.1.1.3" xref="S3.E10.m1.2.2.2.2.1.1.3.cmml"><mi id="S3.E10.m1.2.2.2.2.1.1.3.2" xref="S3.E10.m1.2.2.2.2.1.1.3.2.cmml">V</mi><mn id="S3.E10.m1.2.2.2.2.1.1.3.3" xref="S3.E10.m1.2.2.2.2.1.1.3.3.cmml">0</mn></msub><mo id="S3.E10.m1.2.2.2.2.1.1.2" xref="S3.E10.m1.2.2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.2.2.2.2.1.1.1.1" xref="S3.E10.m1.2.2.2.2.1.1.1.2.cmml"><mo id="S3.E10.m1.2.2.2.2.1.1.1.1.2" xref="S3.E10.m1.2.2.2.2.1.1.1.2.cmml">{</mo><msub id="S3.E10.m1.2.2.2.2.1.1.1.1.1" xref="S3.E10.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.2.2.1.1.1.1.1.2" xref="S3.E10.m1.2.2.2.2.1.1.1.1.1.2.cmml">v</mi><mi id="S3.E10.m1.2.2.2.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.2.2.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E10.m1.2.2.2.2.1.1.1.1.3" xref="S3.E10.m1.2.2.2.2.1.1.1.2.cmml">}</mo></mrow></mrow><mo rspace="0.497em" id="S3.E10.m1.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E10.m1.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.3.cmml"><mrow id="S3.E10.m1.2.2.2.2.2.2.1.1" xref="S3.E10.m1.2.2.2.2.2.2.1.1.cmml"><msub id="S3.E10.m1.2.2.2.2.2.2.1.1.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.1.1.3.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.2.cmml">V</mi><mrow id="S3.E10.m1.2.2.2.2.2.2.1.1.3.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.2.cmml">t</mi><mo id="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.1" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.1.cmml">+</mo><mn id="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10.m1.2.2.2.2.2.2.1.1.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.2.2.2.2.2.2.1.1.1" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.1.1.1.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.3.cmml">ImEmb</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.4" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.4.cmml">Exe</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml">f</mi><mi id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.4" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.2.cmml">V</mi><mi id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.5" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.497em" id="S3.E10.m1.2.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E10.m1.2.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.cmml"><msub id="S3.E10.m1.2.2.2.2.2.2.2.2.4" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2.2.4.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.2.cmml">L</mi><mrow id="S3.E10.m1.2.2.2.2.2.2.2.2.4.3" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.2.cmml">t</mi><mo id="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.1" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.1.cmml">+</mo><mn id="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.3" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.3.cmml">1</mn></mrow></msub><mo id="S3.E10.m1.2.2.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.2.2.3.cmml">=</mo><mrow id="S3.E10.m1.2.2.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2.2.2.4" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.4.cmml">LXMERT</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.2.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1" xref="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.2.cmml">V</mi><mi id="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.3" xref="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.4" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.2" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml">L</mi><mi id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.3" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.5" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.3a.cmml" xref="S3.E10.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"></eq><apply id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2">𝐿</ci><cn type="integer" id="S3.E10.m1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3">0</cn></apply><set id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1"><apply id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set></apply><apply id="S3.E10.m1.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.3a.cmml" xref="S3.E10.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E10.m1.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1"><eq id="S3.E10.m1.2.2.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.2"></eq><apply id="S3.E10.m1.2.2.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3.2">𝑉</ci><cn type="integer" id="S3.E10.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E10.m1.2.2.2.2.1.1.3.3">0</cn></apply><set id="S3.E10.m1.2.2.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1"><apply id="S3.E10.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1.1.2">𝑣</ci><ci id="S3.E10.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.1.1.1.1.1.3">𝑗</ci></apply></set></apply><apply id="S3.E10.m1.2.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.3a.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E10.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1"><eq id="S3.E10.m1.2.2.2.2.2.2.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.2"></eq><apply id="S3.E10.m1.2.2.2.2.2.2.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.1.1.3.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.1.1.3.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.2">𝑉</ci><apply id="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.3"><plus id="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.1"></plus><ci id="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E10.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1"><times id="S3.E10.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.2"></times><ci id="S3.E10.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.3">ImEmb</ci><apply id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1"><times id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.3"></times><ci id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.4">Exe</ci><interval closure="open" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2"><apply id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.2">𝑓</ci><ci id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.2">𝑉</ci><ci id="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1.1.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply><apply id="S3.E10.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2"><eq id="S3.E10.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.3"></eq><apply id="S3.E10.m1.2.2.2.2.2.2.2.2.4.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.2.2.4.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.4.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.2">𝐿</ci><apply id="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.3"><plus id="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.1"></plus><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.2">𝑡</ci><cn type="integer" id="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.4.3.3">1</cn></apply></apply><apply id="S3.E10.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2"><times id="S3.E10.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.3"></times><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.2.4.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.4">LXMERT</ci><interval closure="open" id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2"><apply id="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.2">𝑉</ci><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.2">𝐿</ci><ci id="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.2.2.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">\displaystyle L_{0}=\left\{h_{i}\right\},~{}V_{0}=\left\{v_{j}\right\},~{}V_{t+1}={\rm ImEmb}({\rm Exe}(f_{t},V_{t})),~{}L_{t+1}={\rm LXMERT}(V_{t},L_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS3.Px3.p1.9" class="ltx_p">where <math id="S3.SS2.SSS3.Px3.p1.8.m1.1" class="ltx_Math" alttext="{\rm ImEmb}()" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.8.m1.1a"><mrow id="S3.SS2.SSS3.Px3.p1.8.m1.1.1" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.cmml"><mi id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.2" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.2.cmml">ImEmb</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.1" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.1.cmml">​</mo><mrow id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.3.2" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.3.2.1" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.3.1.cmml">(</mo><mo stretchy="false" id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.3.2.2" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.8.m1.1b"><apply id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1"><times id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.1"></times><ci id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.2">ImEmb</ci><list id="S3.SS2.SSS3.Px3.p1.8.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.8.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.8.m1.1c">{\rm ImEmb}()</annotation></semantics></math> is the object-level image embeddings formulated in Eq. <a href="#S3.E9" title="In Input Embeddings. ‣ 3.2.3 The Soft Logic Program Execution ‣ 3.2 The Interpretable Neural Computation ‣ 3 Method ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, <math id="S3.SS2.SSS3.Px3.p1.9.m2.1" class="ltx_Math" alttext="{\rm Exe}()" display="inline"><semantics id="S3.SS2.SSS3.Px3.p1.9.m2.1a"><mrow id="S3.SS2.SSS3.Px3.p1.9.m2.1.1" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.cmml"><mi id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.2" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.2.cmml">Exe</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.1" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.1.cmml">​</mo><mrow id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.3.2" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.3.2.1" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.3.1.cmml">(</mo><mo stretchy="false" id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.3.2.2" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.Px3.p1.9.m2.1b"><apply id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1"><times id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.1.cmml" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.1"></times><ci id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.2.cmml" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.2">Exe</ci><list id="S3.SS2.SSS3.Px3.p1.9.m2.1.1.3.1.cmml" xref="S3.SS2.SSS3.Px3.p1.9.m2.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.Px3.p1.9.m2.1c">{\rm Exe}()</annotation></semantics></math> is the symbolic executor. We only pass the hidden representation via the language output of LXMERT.
Note that the LXMERT modules share the parameters. Finally, the language output at the last step is passed to a feed-forward network with softmax activation to obtain the distribution for the predicted answers.</p>
</div>
</section>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we conduct the following experiments: we evaluate our proposed model and its components on GQA v1.1 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Dataset</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We demonstrate the value and performance of our model on the “balanced-split” of GQA v1.1, which contains 1M questions over 140K images with a more balanced answer distribution.
Compared with the VQA v2.0 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, the questions in GQA are designed to require multi-hop reasoning to test the reasoning skills of developed models. Compared with the CLEVR dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, GQA greatly increases the complexity of the semantic structure of questions, leading to a more diverse function set. The real-world images in GQA also bring in a bigger challenge in visual understanding. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, the main evaluation metrics used in our experiments are accuracy, plausibility, validity and distribution.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation Details</h3>

<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Parser.</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.2" class="ltx_p">There are 1702 object classes and 310 relation classes in GQA dataset, and it has a long tail. Therefore, to train the Graph R-CNN, we only use the most frequent 500 object categories which account for 93.1% of the total instances and 50 relation categories which account for 95.9%. We use Faster R-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> associated with ResNet101 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> as the backbone based on the PyTorch re-implementation. During training, the number of proposals from RPN is 256. For each proposal, we perform ROI align pooling, to get a 7<math id="S4.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mo id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><times id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">\times</annotation></semantics></math>7 response map, which is then fed to a two-layer MLP to obtain each proposal’s representation. we perform stage-wise training — we first pre-trained Faster R-CNN for object detection, and then fix the parameters in the backbone to train the scene graph generation model. SGD is used as the optimizer, with initial learning rate 1e-2 for both training stages. For question parser, we train with learning rate <math id="S4.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="7\times 10^{-4}" display="inline"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><mrow id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml"><mn id="S4.SS2.SSS1.p1.2.m2.1.1.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml">7</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.SSS1.p1.2.m2.1.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.1.cmml">×</mo><msup id="S4.SS2.SSS1.p1.2.m2.1.1.3" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml"><mn id="S4.SS2.SSS1.p1.2.m2.1.1.3.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS2.SSS1.p1.2.m2.1.1.3.3" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.3.cmml"><mo id="S4.SS2.SSS1.p1.2.m2.1.1.3.3a" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS2.SSS1.p1.2.m2.1.1.3.3.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><apply id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1"><times id="S4.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.1"></times><cn type="integer" id="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.2">7</cn><apply id="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S4.SS2.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.2">10</cn><apply id="S4.SS2.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.3"><minus id="S4.SS2.SSS1.p1.2.m2.1.1.3.3.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.3"></minus><cn type="integer" id="S4.SS2.SSS1.p1.2.m2.1.1.3.3.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">7\times 10^{-4}</annotation></semantics></math> for 20,000 iterations. The batch size is fixed to be 64.</p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Program Executor with LXMERT.</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.4" class="ltx_p">For the LXMERT module, we set the number of layers <math id="S4.SS2.SSS2.p1.1.m1.1" class="ltx_Math" alttext="N_{L}" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.1a"><msub id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml">N</mi><mi id="S4.SS2.SSS2.p1.1.m1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.1b"><apply id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.2">𝑁</ci><ci id="S4.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.1c">N_{L}</annotation></semantics></math>, <math id="S4.SS2.SSS2.p1.2.m2.1" class="ltx_Math" alttext="N_{X}" display="inline"><semantics id="S4.SS2.SSS2.p1.2.m2.1a"><msub id="S4.SS2.SSS2.p1.2.m2.1.1" xref="S4.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.SSS2.p1.2.m2.1.1.2" xref="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml">N</mi><mi id="S4.SS2.SSS2.p1.2.m2.1.1.3" xref="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml">X</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.2.m2.1b"><apply id="S4.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.2">𝑁</ci><ci id="S4.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS2.p1.2.m2.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.2.m2.1c">N_{X}</annotation></semantics></math>, and <math id="S4.SS2.SSS2.p1.3.m3.1" class="ltx_Math" alttext="N_{R}" display="inline"><semantics id="S4.SS2.SSS2.p1.3.m3.1a"><msub id="S4.SS2.SSS2.p1.3.m3.1.1" xref="S4.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.SSS2.p1.3.m3.1.1.2" xref="S4.SS2.SSS2.p1.3.m3.1.1.2.cmml">N</mi><mi id="S4.SS2.SSS2.p1.3.m3.1.1.3" xref="S4.SS2.SSS2.p1.3.m3.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.3.m3.1b"><apply id="S4.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.2">𝑁</ci><ci id="S4.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.SSS2.p1.3.m3.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.3.m3.1c">N_{R}</annotation></semantics></math> to 9, 5, and 5 respectively.
We initialize the weights of LXMERT using the model pre-trained on the large aggregated dataset<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/airsplay/lxmert</span></span></span>. To train the executor, we use a learning rate of <math id="S4.SS2.SSS2.p1.4.m4.1" class="ltx_Math" alttext="1e-5" display="inline"><semantics id="S4.SS2.SSS2.p1.4.m4.1a"><mrow id="S4.SS2.SSS2.p1.4.m4.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.cmml"><mrow id="S4.SS2.SSS2.p1.4.m4.1.1.2" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.cmml"><mn id="S4.SS2.SSS2.p1.4.m4.1.1.2.2" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.4.m4.1.1.2.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.1.cmml">​</mo><mi id="S4.SS2.SSS2.p1.4.m4.1.1.2.3" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.3.cmml">e</mi></mrow><mo id="S4.SS2.SSS2.p1.4.m4.1.1.1" xref="S4.SS2.SSS2.p1.4.m4.1.1.1.cmml">−</mo><mn id="S4.SS2.SSS2.p1.4.m4.1.1.3" xref="S4.SS2.SSS2.p1.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.4.m4.1b"><apply id="S4.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1"><minus id="S4.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.1"></minus><apply id="S4.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.2"><times id="S4.SS2.SSS2.p1.4.m4.1.1.2.1.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.1"></times><cn type="integer" id="S4.SS2.SSS2.p1.4.m4.1.1.2.2.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.2">1</cn><ci id="S4.SS2.SSS2.p1.4.m4.1.1.2.3.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S4.SS2.SSS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p1.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.4.m4.1c">1e-5</annotation></semantics></math>, a batch size of 32, and fine-tune the model from pre-trained parameters for 4 epochs.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results</h3>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>VQA</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">We compare our performance both with baselines, as appear in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, as well as with other prior arts of VQA model. Apart from the standard accuracy metric and the more detailed type-based diagnosis (i.e. Binary, Open), we get further insight into reasoning capabilities by reporting three more metrics <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>: <span id="S4.SS3.SSS1.p1.1.1" class="ltx_text ltx_font_bold">Validity</span>, <span id="S4.SS3.SSS1.p1.1.2" class="ltx_text ltx_font_bold">Plausibility</span> and <span id="S4.SS3.SSS1.p1.1.3" class="ltx_text ltx_font_bold">Distribution</span>.
The validity metric checks whether a given answer is in the question scope, e.g. responding some color to a color question. The plausibility score goes a step further, measuring whether the answer is reasonable, or makes sense, given the question (e.g. elephant usually do not eat, say, pizza). The distribution score measures the overall match between the true answer distribution and the model predicted distribution (for this metric, lower is better).
As Table <a href="#S4.T1" title="Table 1 ‣ 4.3.1 VQA ‣ 4.3 Results ‣ 4 Experiment ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows, our model achieves competitive accuracy among published approaches. Notably, our model outperforms state-of-the-art models (especially, LXMERT) with respect to the three metrics, which indicates that our model has more a comprehensive understanding of questions and does not learn from the data bias. NMN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> is also a compositional method that uses the program supervision, but lack of cross-modality learning.
Its poor performance implies the complex content in real images and question induces challenge to multi-hop reasoning. The strong image and language representations play a crucial role in our framework.
More visualizations of the reasoning process in our method are provided in the supplementary material.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>VQA results for single-model settings. The models with * are submissions to the GQA server but without published paper. For distribution score, lower is better.</figcaption>
<table id="S4.T1.1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.1.2.1" class="ltx_text" style="font-size:90%;">Model</span></th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.1.3.1" class="ltx_text" style="font-size:90%;">Binary</span></th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.1.4.1" class="ltx_text" style="font-size:90%;">Open</span></th>
<th id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.1.5.1" class="ltx_text" style="font-size:90%;">Validity</span></th>
<th id="S4.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.1.6.1" class="ltx_text" style="font-size:90%;">Plausibility</span></th>
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">Distribution</span><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mo mathsize="90%" stretchy="false" id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\downarrow</annotation></semantics></math>
</th>
<th id="S4.T1.1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.1.7.1" class="ltx_text" style="font-size:90%;">Accuracy</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.2.1.1.1" class="ltx_text" style="font-size:90%;">Local Prior </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.2.1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T1.1.1.2.1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.2.1.2.1" class="ltx_text" style="font-size:90%;">47.90</span></td>
<td id="S4.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.2.1.3.1" class="ltx_text" style="font-size:90%;">16.66</span></td>
<td id="S4.T1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.2.1.4.1" class="ltx_text" style="font-size:90%;">84.33</span></td>
<td id="S4.T1.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.2.1.5.1" class="ltx_text" style="font-size:90%;">84.31</span></td>
<td id="S4.T1.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.2.1.6.1" class="ltx_text" style="font-size:90%;">13.98</span></td>
<td id="S4.T1.1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.2.1.7.1" class="ltx_text" style="font-size:90%;">31.24</span></td>
</tr>
<tr id="S4.T1.1.1.3.2" class="ltx_tr">
<th id="S4.T1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.3.2.1.1" class="ltx_text" style="font-size:90%;">Language </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.3.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T1.1.1.3.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.3.2.2.1" class="ltx_text" style="font-size:90%;">61.90</span></td>
<td id="S4.T1.1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.3.2.3.1" class="ltx_text" style="font-size:90%;">22.69</span></td>
<td id="S4.T1.1.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.3.2.4.1" class="ltx_text" style="font-size:90%;">96.39</span></td>
<td id="S4.T1.1.1.3.2.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.3.2.5.1" class="ltx_text" style="font-size:90%;">87.30</span></td>
<td id="S4.T1.1.1.3.2.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.3.2.6.1" class="ltx_text" style="font-size:90%;">17.93</span></td>
<td id="S4.T1.1.1.3.2.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.3.2.7.1" class="ltx_text" style="font-size:90%;">41.07</span></td>
</tr>
<tr id="S4.T1.1.1.4.3" class="ltx_tr">
<th id="S4.T1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.4.3.1.1" class="ltx_text" style="font-size:90%;">Vision </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.4.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T1.1.1.4.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.4.3.2.1" class="ltx_text" style="font-size:90%;">36.05</span></td>
<td id="S4.T1.1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.4.3.3.1" class="ltx_text" style="font-size:90%;">1.74</span></td>
<td id="S4.T1.1.1.4.3.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.4.3.4.1" class="ltx_text" style="font-size:90%;">35.78</span></td>
<td id="S4.T1.1.1.4.3.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.4.3.5.1" class="ltx_text" style="font-size:90%;">34.84</span></td>
<td id="S4.T1.1.1.4.3.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.4.3.6.1" class="ltx_text" style="font-size:90%;">19.99</span></td>
<td id="S4.T1.1.1.4.3.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.4.3.7.1" class="ltx_text" style="font-size:90%;">17.82</span></td>
</tr>
<tr id="S4.T1.1.1.5.4" class="ltx_tr">
<th id="S4.T1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.5.4.1.1" class="ltx_text" style="font-size:90%;">Lang+Vis </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.5.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T1.1.1.5.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.5.4.2.1" class="ltx_text" style="font-size:90%;">63.26</span></td>
<td id="S4.T1.1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.5.4.3.1" class="ltx_text" style="font-size:90%;">31.80</span></td>
<td id="S4.T1.1.1.5.4.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.5.4.4.1" class="ltx_text" style="font-size:90%;">96.02</span></td>
<td id="S4.T1.1.1.5.4.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.5.4.5.1" class="ltx_text" style="font-size:90%;">84.25</span></td>
<td id="S4.T1.1.1.5.4.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.5.4.6.1" class="ltx_text" style="font-size:90%;">7.46</span></td>
<td id="S4.T1.1.1.5.4.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.5.4.7.1" class="ltx_text" style="font-size:90%;">46.55</span></td>
</tr>
<tr id="S4.T1.1.1.6.5" class="ltx_tr">
<th id="S4.T1.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.6.5.1.1" class="ltx_text" style="font-size:90%;">BottomUp </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.6.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S4.T1.1.1.6.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.6.5.2.1" class="ltx_text" style="font-size:90%;">66.64</span></td>
<td id="S4.T1.1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.6.5.3.1" class="ltx_text" style="font-size:90%;">34.83</span></td>
<td id="S4.T1.1.1.6.5.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.6.5.4.1" class="ltx_text" style="font-size:90%;">96.18</span></td>
<td id="S4.T1.1.1.6.5.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.6.5.5.1" class="ltx_text" style="font-size:90%;">84.57</span></td>
<td id="S4.T1.1.1.6.5.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.6.5.6.1" class="ltx_text" style="font-size:90%;">5.98</span></td>
<td id="S4.T1.1.1.6.5.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.6.5.7.1" class="ltx_text" style="font-size:90%;">49.74</span></td>
</tr>
<tr id="S4.T1.1.1.7.6" class="ltx_tr">
<th id="S4.T1.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.7.6.1.1" class="ltx_text" style="font-size:90%;">MAC </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.7.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib10" title="" class="ltx_ref">10</a><span id="S4.T1.1.1.7.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.7.6.2.1" class="ltx_text" style="font-size:90%;">71.23</span></td>
<td id="S4.T1.1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.7.6.3.1" class="ltx_text" style="font-size:90%;">38.91</span></td>
<td id="S4.T1.1.1.7.6.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.7.6.4.1" class="ltx_text" style="font-size:90%;">96.16</span></td>
<td id="S4.T1.1.1.7.6.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.7.6.5.1" class="ltx_text" style="font-size:90%;">84.48</span></td>
<td id="S4.T1.1.1.7.6.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.7.6.6.1" class="ltx_text" style="font-size:90%;">5.34</span></td>
<td id="S4.T1.1.1.7.6.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.7.6.7.1" class="ltx_text" style="font-size:90%;">54.06</span></td>
</tr>
<tr id="S4.T1.1.1.8.7" class="ltx_tr">
<th id="S4.T1.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.8.7.1.1" class="ltx_text" style="font-size:90%;">NMN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.8.7.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T1.1.1.8.7.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.8.7.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.8.7.2.1" class="ltx_text" style="font-size:90%;">72.88</span></td>
<td id="S4.T1.1.1.8.7.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.8.7.3.1" class="ltx_text" style="font-size:90%;">40.53</span></td>
<td id="S4.T1.1.1.8.7.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.8.7.4.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T1.1.1.8.7.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.8.7.5.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T1.1.1.8.7.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.8.7.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T1.1.1.8.7.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.8.7.7.1" class="ltx_text" style="font-size:90%;">55.70</span></td>
</tr>
<tr id="S4.T1.1.1.9.8" class="ltx_tr">
<th id="S4.T1.1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.9.8.1.1" class="ltx_text" style="font-size:90%;">LCGN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.9.8.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib9" title="" class="ltx_ref">9</a><span id="S4.T1.1.1.9.8.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.9.8.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.9.8.2.1" class="ltx_text" style="font-size:90%;">73.77</span></td>
<td id="S4.T1.1.1.9.8.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.9.8.3.1" class="ltx_text" style="font-size:90%;">42.33</span></td>
<td id="S4.T1.1.1.9.8.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.9.8.4.1" class="ltx_text" style="font-size:90%;">96.48</span></td>
<td id="S4.T1.1.1.9.8.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.9.8.5.1" class="ltx_text" style="font-size:90%;">84.81</span></td>
<td id="S4.T1.1.1.9.8.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.9.8.6.1" class="ltx_text" style="font-size:90%;">4.70</span></td>
<td id="S4.T1.1.1.9.8.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.9.8.7.1" class="ltx_text" style="font-size:90%;">57.07</span></td>
</tr>
<tr id="S4.T1.1.1.10.9" class="ltx_tr">
<th id="S4.T1.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.10.9.1.1" class="ltx_text" style="font-size:90%;">BAN </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.10.9.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib14" title="" class="ltx_ref">14</a><span id="S4.T1.1.1.10.9.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.10.9.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.10.9.2.1" class="ltx_text" style="font-size:90%;">76.00</span></td>
<td id="S4.T1.1.1.10.9.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.10.9.3.1" class="ltx_text" style="font-size:90%;">40.41</span></td>
<td id="S4.T1.1.1.10.9.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.10.9.4.1" class="ltx_text" style="font-size:90%;">96.16</span></td>
<td id="S4.T1.1.1.10.9.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.10.9.5.1" class="ltx_text" style="font-size:90%;">85.58</span></td>
<td id="S4.T1.1.1.10.9.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.10.9.6.1" class="ltx_text" style="font-size:90%;">10.52</span></td>
<td id="S4.T1.1.1.10.9.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.10.9.7.1" class="ltx_text" style="font-size:90%;">57.10</span></td>
</tr>
<tr id="S4.T1.1.1.11.10" class="ltx_tr">
<th id="S4.T1.1.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.11.10.1.1" class="ltx_text" style="font-size:90%;">SK T-Brain*</span></th>
<td id="S4.T1.1.1.11.10.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.11.10.2.1" class="ltx_text" style="font-size:90%;">77.42</span></td>
<td id="S4.T1.1.1.11.10.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.11.10.3.1" class="ltx_text" style="font-size:90%;">43.10</span></td>
<td id="S4.T1.1.1.11.10.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.11.10.4.1" class="ltx_text" style="font-size:90%;">96.26</span></td>
<td id="S4.T1.1.1.11.10.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.11.10.5.1" class="ltx_text" style="font-size:90%;">85.27</span></td>
<td id="S4.T1.1.1.11.10.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.11.10.6.1" class="ltx_text" style="font-size:90%;">7.54</span></td>
<td id="S4.T1.1.1.11.10.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.11.10.7.1" class="ltx_text" style="font-size:90%;">59.19</span></td>
</tr>
<tr id="S4.T1.1.1.12.11" class="ltx_tr">
<th id="S4.T1.1.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.12.11.1.1" class="ltx_text" style="font-size:90%;">PVR*</span></th>
<td id="S4.T1.1.1.12.11.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.12.11.2.1" class="ltx_text" style="font-size:90%;">77.69</span></td>
<td id="S4.T1.1.1.12.11.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.12.11.3.1" class="ltx_text" style="font-size:90%;">43.01</span></td>
<td id="S4.T1.1.1.12.11.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.12.11.4.1" class="ltx_text" style="font-size:90%;">96.45</span></td>
<td id="S4.T1.1.1.12.11.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.12.11.5.1" class="ltx_text" style="font-size:90%;">84.53</span></td>
<td id="S4.T1.1.1.12.11.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.12.11.6.1" class="ltx_text" style="font-size:90%;">5.80</span></td>
<td id="S4.T1.1.1.12.11.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.12.11.7.1" class="ltx_text" style="font-size:90%;">59.27</span></td>
</tr>
<tr id="S4.T1.1.1.13.12" class="ltx_tr">
<th id="S4.T1.1.1.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:4.5pt;padding-right:4.5pt;">
<span id="S4.T1.1.1.13.12.1.1" class="ltx_text" style="font-size:90%;">LXMERT </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.13.12.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib20" title="" class="ltx_ref">20</a><span id="S4.T1.1.1.13.12.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.1.13.12.2" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.13.12.2.1" class="ltx_text" style="font-size:90%;">77.16</span></td>
<td id="S4.T1.1.1.13.12.3" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.13.12.3.1" class="ltx_text" style="font-size:90%;">45.47</span></td>
<td id="S4.T1.1.1.13.12.4" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.13.12.4.1" class="ltx_text" style="font-size:90%;">96.35</span></td>
<td id="S4.T1.1.1.13.12.5" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.13.12.5.1" class="ltx_text" style="font-size:90%;">84.53</span></td>
<td id="S4.T1.1.1.13.12.6" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.13.12.6.1" class="ltx_text" style="font-size:90%;">5.69</span></td>
<td id="S4.T1.1.1.13.12.7" class="ltx_td ltx_align_center" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.13.12.7.1" class="ltx_text" style="font-size:90%;">60.33</span></td>
</tr>
<tr id="S4.T1.1.1.14.13" class="ltx_tr">
<th id="S4.T1.1.1.14.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.14.13.1.1" class="ltx_text" style="font-size:90%;">Ours</span></th>
<td id="S4.T1.1.1.14.13.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.14.13.2.1" class="ltx_text" style="font-size:90%;">75.62</span></td>
<td id="S4.T1.1.1.14.13.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.14.13.3.1" class="ltx_text" style="font-size:90%;">41.07</span></td>
<td id="S4.T1.1.1.14.13.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.14.13.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">96.87</span></td>
<td id="S4.T1.1.1.14.13.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.14.13.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">87.94</span></td>
<td id="S4.T1.1.1.14.13.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.14.13.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">2.72</span></td>
<td id="S4.T1.1.1.14.13.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:4.5pt;padding-right:4.5pt;"><span id="S4.T1.1.1.14.13.7.1" class="ltx_text" style="font-size:90%;">58.50</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>The accuracy (%) of our question parser and symbolic executor. Program Acc. represents the accuracy of generated program, which is evaluated by the accuracy of operation token, arguments token and the function (It is positive when both operation and arguments in a function are correct). Executor Acc. represents the accuracy of the answers obtained by our deterministic part of program executor executed on the ground-truth scene graph, by using ground-truth (G.T.) and generated (Gen.) program.</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.1.1" class="ltx_tr">
<th id="S4.T2.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" rowspan="2"><span id="S4.T2.3.1.1.1.1" class="ltx_text" style="font-size:90%;">Data Split</span></th>
<th id="S4.T2.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="3"><span id="S4.T2.3.1.1.2.1" class="ltx_text" style="font-size:90%;">Program Acc.</span></th>
<th id="S4.T2.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:10.0pt;padding-right:10.0pt;" colspan="2"><span id="S4.T2.3.1.1.3.1" class="ltx_text" style="font-size:90%;">Executor Acc.</span></th>
</tr>
<tr id="S4.T2.3.2.2" class="ltx_tr">
<th id="S4.T2.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.2.2.1.1" class="ltx_text" style="font-size:90%;">Operation</span></th>
<th id="S4.T2.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.2.2.2.1" class="ltx_text" style="font-size:90%;">Arguments</span></th>
<th id="S4.T2.3.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.2.2.3.1" class="ltx_text" style="font-size:90%;">Function</span></th>
<th id="S4.T2.3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.2.2.4.1" class="ltx_text" style="font-size:90%;">G.T.</span></th>
<th id="S4.T2.3.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.2.2.5.1" class="ltx_text" style="font-size:90%;">Gen.</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.3.1" class="ltx_tr">
<td id="S4.T2.3.3.1.1" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.3.1.1.1" class="ltx_text" style="font-size:90%;">Testdev</span></td>
<td id="S4.T2.3.3.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.3.1.2.1" class="ltx_text" style="font-size:90%;">97.31</span></td>
<td id="S4.T2.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.3.1.3.1" class="ltx_text" style="font-size:90%;">82.52</span></td>
<td id="S4.T2.3.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.3.1.4.1" class="ltx_text" style="font-size:90%;">81.76</span></td>
<td id="S4.T2.3.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.3.1.5.1" class="ltx_text" style="font-size:90%;">-</span></td>
<td id="S4.T2.3.3.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.3.1.6.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S4.T2.3.4.2" class="ltx_tr">
<td id="S4.T2.3.4.2.1" class="ltx_td ltx_align_left ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.4.2.1.1" class="ltx_text" style="font-size:90%;">Val</span></td>
<td id="S4.T2.3.4.2.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.4.2.2.1" class="ltx_text" style="font-size:90%;">99.01</span></td>
<td id="S4.T2.3.4.2.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.4.2.3.1" class="ltx_text" style="font-size:90%;">83.20</span></td>
<td id="S4.T2.3.4.2.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.4.2.4.1" class="ltx_text" style="font-size:90%;">83.06</span></td>
<td id="S4.T2.3.4.2.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.4.2.5.1" class="ltx_text" style="font-size:90%;">97.71</span></td>
<td id="S4.T2.3.4.2.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:10.0pt;padding-right:10.0pt;"><span id="S4.T2.3.4.2.6.1" class="ltx_text" style="font-size:90%;">91.46</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>The Performance of Each Components.</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">Since each component in our framework has essential impacts on final prediction, we also report the individual performance of them.
Our question parser could reach the accuracy of 83.06% with respect to the function instances, specifically, 99.01% for “operation”, 83.2% for “arguments” on val set (see Table <a href="#S4.T2" title="Table 2 ‣ 4.3.1 VQA ‣ 4.3 Results ‣ 4 Experiment ‣ Interpretable Neural Computation for Real-World Compositional Visual Question AnsweringThis work was supported by NSFC (60906119) and Shanghai Pujiang Program." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). It implies our generated programs could recover the semantics of questions and provide sound interpretable reasoning skill.</p>
</div>
<div id="S4.SS3.SSS2.p2" class="ltx_para">
<p id="S4.SS3.SSS2.p2.1" class="ltx_p">We evaluate the scene graph generation via widely adopted metrics <span id="S4.SS3.SSS2.p2.1.1" class="ltx_text ltx_font_typewriter">SGDet</span>@K – the Recall@K of predicting objects and their relationships from scratch. We obtain 17.43, 22, 24.61 on <span id="S4.SS3.SSS2.p2.1.2" class="ltx_text ltx_font_typewriter">SGDet</span>@20, @50, @100, respectively.</p>
</div>
<div id="S4.SS3.SSS2.p3" class="ltx_para">
<p id="S4.SS3.SSS2.p3.1" class="ltx_p">We evaluate our deterministic symbolic program executor by applying it on ground-truth scene graph. Due to the incomplete and ambiguous annotations of scene graphs in GQA, the ground truth programs execute on the ground-truth scene graph results in a VQA accuracy of 97.71%. It revealing the performance upper-bound of models for GQA dataset. The accuracy of answers obtained by generated programs is 91.46%. These results suggest that the noisy visual recognition hinders the “high-level” logical reasoning in our model leading to the marginal decrease on the accuracy, but our interpretability enhanced design indeed helps our model to predict more valid and plausible answers.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we have proposed an interpretable model for real-world compositional visual question answering, which combines the compositional and monolithic model to leverage the merits of both. In our method, images and questions are disentangled into scene graphs and programs, and a symbolic program executor runs on them with full transparency to locate the attention regions, which are then iteratively passed to a visual-linguistic pre-trained encoder to predict answers. The proposed model can explain its reasoning steps with a sequence of image attentions because of the symbolic nature of the execution. Experimental results demonstrate that our method not only achieves competitive accuracy among previous works, but also could predict the answers with more validity and plausibility.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Agrawal, A., Batra, D., Parikh, D.: Analyzing the behavior of visual question
answering models. arXiv preprint arXiv:1606.07356 (2016)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Anderson, P., He, X., Buehler, C., Teney, D., Johnson, M., Gould, S., Zhang,
L.: Bottom-up and top-down attention for image captioning and visual question
answering. In: Proceedings of the IEEE conference on computer vision and
pattern recognition. pp. 6077–6086 (2018)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Andreas, J., Rohrbach, M., Darrell, T., Klein, D.: Neural module networks. In:
Proceedings of the IEEE Conference on Computer Vision and Pattern
Recognition. pp. 39–48 (2016)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Antol, S., Agrawal, A., Lu, J., Mitchell, M., Batra, D., Lawrence Zitnick, C.,
Parikh, D.: Vqa: Visual question answering. In: Proceedings of the IEEE
international conference on computer vision. pp. 2425–2433 (2015)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Bahdanau, D., Cho, K., Bengio, Y.: Neural machine translation by jointly
learning to align and translate. arXiv preprint arXiv:1409.0473 (2014)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., Sun, J.: Deep residual learning for image
recognition. In: Proceedings of the IEEE conference on computer vision and
pattern recognition. pp. 770–778 (2016)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Hochreiter, S., Schmidhuber, J.: Long short-term memory. Neural computation
<span id="bib.bib7.1.1" class="ltx_text ltx_font_bold">9</span>(8), 1735–1780 (1997)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Hu, R., Andreas, J., Rohrbach, M., Darrell, T., Saenko, K.: Learning to reason:
End-to-end module networks for visual question answering. In: Proceedings of
the IEEE International Conference on Computer Vision. pp. 804–813 (2017)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Hu, R., Rohrbach, A., Darrell, T., Saenko, K.: Language-conditioned graph
networks for relational reasoning. In: Proceedings of the IEEE International
Conference on Computer Vision. pp. 10294–10303 (2019)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Hudson, D.A., Manning, C.D.: Compositional attention networks for machine
reasoning. arXiv preprint arXiv:1803.03067 (2018)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Hudson, D.A., Manning, C.D.: Gqa: A new dataset for real-world visual reasoning
and compositional question answering. arXiv preprint arXiv:1902.09506 (2019)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Johnson, J., Hariharan, B., van der Maaten, L., Fei-Fei, L., Lawrence Zitnick,
C., Girshick, R.: Clevr: A diagnostic dataset for compositional language and
elementary visual reasoning. In: Proceedings of the IEEE Conference on
Computer Vision and Pattern Recognition. pp. 2901–2910 (2017)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Johnson, J., Krishna, R., Stark, M., Li, L.J., Shamma, D., Bernstein, M.,
Fei-Fei, L.: Image retrieval using scene graphs. In: Proceedings of the IEEE
conference on computer vision and pattern recognition. pp. 3668–3678 (2015)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Kim, J.H., Jun, J., Zhang, B.T.: Bilinear attention networks. In: Advances in
Neural Information Processing Systems. pp. 1564–1574 (2018)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Lake, B.M., Baroni, M.: Generalization without systematicity: On the
compositional skills of sequence-to-sequence recurrent networks. arXiv
preprint arXiv:1711.00350 (2017)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Li, Y., Ouyang, W., Zhou, B., Shi, J., Zhang, C., Wang, X.: Factorizable net:
an efficient subgraph-based framework for scene graph generation. In:
Proceedings of the European Conference on Computer Vision (ECCV). pp.
335–351 (2018)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Ren, S., He, K., Girshick, R., Sun, J.: Faster r-cnn: Towards real-time object
detection with region proposal networks. In: Advances in neural information
processing systems. pp. 91–99 (2015)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Santoro, A., Raposo, D., Barrett, D.G., Malinowski, M., Pascanu, R., Battaglia,
P., Lillicrap, T.: A simple neural network module for relational reasoning.
In: Advances in neural information processing systems. pp. 4967–4976 (2017)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Shi, J., Zhang, H., Li, J.: Explainable and explicit visual reasoning over
scene graphs. In: Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition. pp. 8376–8384 (2019)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Tan, H., Bansal, M.: Lxmert: Learning cross-modality encoder representations
from transformers. arXiv preprint arXiv:1908.07490 (2019)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Teney, D., Liu, L., van Den Hengel, A.: Graph-structured representations for
visual question answering. In: Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition. pp. 1–9 (2017)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Xu, D., Zhu, Y., Choy, C.B., Fei-Fei, L.: Scene graph generation by iterative
message passing. In: Proceedings of the IEEE Conference on Computer Vision
and Pattern Recognition. pp. 5410–5419 (2017)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Yang, J., Lu, J., Lee, S., Batra, D., Parikh, D.: Graph r-cnn for scene graph
generation. In: Proceedings of the European conference on computer vision
(ECCV). pp. 670–685 (2018)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Yi, K., Wu, J., Gan, C., Torralba, A., Kohli, P., Tenenbaum, J.:
Neural-symbolic vqa: Disentangling reasoning from vision and language
understanding. In: Advances in Neural Information Processing Systems. pp.
1031–1042 (2018)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Yin, X., Ordonez, V.: Obj2text: Generating visually descriptive language from
object layouts. arXiv preprint arXiv:1707.07102 (2017)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Zellers, R., Yatskar, M., Thomson, S., Choi, Y.: Neural motifs: Scene graph
parsing with global context. In: Proceedings of the IEEE Conference on
Computer Vision and Pattern Recognition. pp. 5831–5840 (2018)

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2010.04912" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2010.04913" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2010.04913">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2010.04913" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2010.04914" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 10:33:19 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
