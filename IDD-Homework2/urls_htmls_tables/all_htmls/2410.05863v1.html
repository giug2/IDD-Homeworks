<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework</title>
<!--Generated on Tue Oct  8 09:51:36 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="On-device,  video recommender systems,  choppy playback" lang="en" name="keywords"/>
<base href="/html/2410.05863v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S1" title="In Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S2" title="In Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>RELATED WORK</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S2.SS1" title="In 2. RELATED WORK ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>On-device Recommender Systems</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S2.SS2" title="In 2. RELATED WORK ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Playback Performance Optimization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3" title="In Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>SYSTEM</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.SS1" title="In 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Definition</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.SS2" title="In 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Stage I : Gating</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.SS3" title="In 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Stage II : Ranking</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.SS4" title="In 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Cache update Mechanism</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.SS5" title="In 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Recommendation in offline mode.</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.SS6" title="In 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.6 </span>System Implementation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4" title="In Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>EXPERIMENTS</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.SS1" title="In 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Offline Results of Gate model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.SS2" title="In 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Offline Results of Ranking model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.SS3" title="In 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Online A/B Testing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.SS4" title="In 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Case Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S5" title="In Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>CONCLUSION</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yunfei Yang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yfy@pku.edu.cn">yfy@pku.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhenghao Qi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:qizhenghao@kuaishou.com">qizhenghao@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Honghuan Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wuhonghuan@kuaishou.com">wuhonghuan@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qi Song
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:songqi@kuaishou.com">songqi@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tieyao Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id15.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhangtieyao@kuaishou.com">zhangtieyao@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hao Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id16.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id17.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id18.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lihao@kuaishou.com">lihao@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yimin Tu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id19.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id20.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id21.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yiming@kuaishou.com">yiming@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kaiqiao Zhan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id22.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id23.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id24.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhankaiqiao@kuaishou.com">zhankaiqiao@kuaishou.com</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ben Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id25.1.id1">Kuaishou Technology</span><span class="ltx_text ltx_affiliation_city" id="id26.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id27.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:wangben@kuaishou.com">wangben@kuaishou.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id28.id1">Video recommender systems (RSs) have gained increasing attention in recent years. Existing mainstream RSs focus on optimizing the matching function between users and items. However, we noticed that users frequently encounter playback issues such as slow loading or stuttering while browsing the videos, especially in weak network conditions, which will lead to a subpar browsing experience, and may cause users to leave, even when the video content and recommendations are superior. <span class="ltx_text ltx_font_bold" id="id28.id1.1">It is quite a serious issue, yet easily overlooked</span>.</p>
<p class="ltx_p" id="id29.id2">To tackle this issue, we propose an on-device <span class="ltx_text ltx_font_bold" id="id29.id2.1">G</span>ating and <span class="ltx_text ltx_font_bold" id="id29.id2.2">R</span>anking <span class="ltx_text ltx_font_bold" id="id29.id2.3">F</span>ramework (<span class="ltx_text ltx_font_bold" id="id29.id2.4">GRF</span>) that cooperates with server-side RS. Specifically, we utilize a gate model to identify videos that may have playback issues in real-time, and then we employ a ranking model to select the optimal result from a locally-cached pool to replace the stuttering videos. Our solution has been fully deployed on Kwai, a large-scale short video platform with hundreds of millions of users globally. Moreover, it significantly enhances video playback performance and improves overall user experience and retention rates.</p>
</div>
<div class="ltx_keywords">On-device, video recommender systems, choppy playback
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management; October 21–25, 2024; Boise, ID, USA.</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>Proceedings of the 33rd ACM International Conference on Information and Knowledge Management (CIKM ’24), October 21–25, 2024, Boise, ID, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-0436-9/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3627673.3680076</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Information systems Retrieval models and ranking</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The popularity of short video platforms, such as TikTok, YouTube Shorts and Kuaishou, has led to a surge in video recommendation technology over the past few years. While significant progress has been made in this field, most of them focused on matching and sorting algorithms, including both cloud-based methods <cite class="ltx_cite ltx_citemacro_citep">(Lin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib16" title="">2022</a>; Zhan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib22" title="">2022</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib23" title="">2018</a>)</cite> and on-device solutions <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib9" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib8" title="">2022</a>; Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib7" title="">2021</a>)</cite> that utilize real-time signals for addressing the delays caused by server-side paging mechanisms.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In real-world scenarios, users often face playback issues such as slow loading or stuttering (referred to as ”choppy”) as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">1</span></a>, This is especially prevalent in underdeveloped regions or areas with unstable network conditions. For instance, <span class="ltx_text ltx_font_bold" id="S1.p2.1.1">71% </span> of global users on Kwai have encountered subpar network conditions, leading to an average of 6-7 instances of choppy playback per day. This problem can significantly diminish the user experience and may cause users to leave the platform. Improving prediction accuracy, as the aforementioned algorithms aim to do, cannot completely mitigate this issue.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="553" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>An example interface of short video platform. (a) Users browse videos by scrolling up and down. (b) and (c) illustrate several playback issues while browsing the videos.</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">To evaluate the impact of playback performance on user experience, we select several representative playback issues, such as failed loading, slowing loading of the first screen, and video stuttering as choppy samples. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S1.F2" title="Figure 2 ‣ 1. Introduction ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">2</span></a> shows the relationship between average session watch time and the proportion of choppy videos within a session (choppy rate). We can conclude that the average session watch time significantly decreases as the choppy rate increases. Specifically when the choppy rate reaches 10%, the average session watch time drops by 56.1%. Therefore, it is evident that playback performance has a substantial impact on user experience, and addressing playback issues holds considerable potential for improving user engagement.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.3">Previous research has also noticed the issue of network influence. For example, <cite class="ltx_cite ltx_citemacro_citep">(Lang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib15" title="">2023</a>)</cite> attempts to jointly consider video attractiveness and network states to improve the overall revenue. However, most of these efforts were server-side, lacking the ability to adjust content based on real-time signals from the client. choppy playback is a multifaceted issue caused by complex factors. Such as <math alttext="(1)" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mrow id="S1.p4.1.m1.1.2.2"><mo id="S1.p4.1.m1.1.2.2.1" stretchy="false">(</mo><mn id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">1</mn><mo id="S1.p4.1.m1.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><cn id="S1.p4.1.m1.1.1.cmml" type="integer" xref="S1.p4.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">(1)</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">( 1 )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S1.p4.3.1">Network Environment</span>: Real-time traffic fluctuations due to volatility in network performance can cause playback lag behind video loading progress. <math alttext="(2)" class="ltx_Math" display="inline" id="S1.p4.2.m2.1"><semantics id="S1.p4.2.m2.1a"><mrow id="S1.p4.2.m2.1.2.2"><mo id="S1.p4.2.m2.1.2.2.1" stretchy="false">(</mo><mn id="S1.p4.2.m2.1.1" xref="S1.p4.2.m2.1.1.cmml">2</mn><mo id="S1.p4.2.m2.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.2.m2.1b"><cn id="S1.p4.2.m2.1.1.cmml" type="integer" xref="S1.p4.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.2.m2.1c">(2)</annotation><annotation encoding="application/x-llamapun" id="S1.p4.2.m2.1d">( 2 )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S1.p4.3.2">Device Status</span>: Resource contention and execution of time-consuming tasks caused by running multiple apps on the client can also cause stuttering. and <math alttext="(3)" class="ltx_Math" display="inline" id="S1.p4.3.m3.1"><semantics id="S1.p4.3.m3.1a"><mrow id="S1.p4.3.m3.1.2.2"><mo id="S1.p4.3.m3.1.2.2.1" stretchy="false">(</mo><mn id="S1.p4.3.m3.1.1" xref="S1.p4.3.m3.1.1.cmml">3</mn><mo id="S1.p4.3.m3.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p4.3.m3.1b"><cn id="S1.p4.3.m3.1.1.cmml" type="integer" xref="S1.p4.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.3.m3.1c">(3)</annotation><annotation encoding="application/x-llamapun" id="S1.p4.3.m3.1d">( 3 )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S1.p4.3.3">Content Quality</span>: Some high-bitrate videos require specific rendering and loading processes.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Enhancing playback performance is a real-time client scenario, where device and network status are subject to dynamic changes. Thus, the best solution is to address these issues on the client side. Numerous factors can contribute to playback performance, making it difficult to assess through simple strategies. Misjudging these factors can lead to replacing a high-quality video, thereby diminishing the user experience.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In this paper, we propose a novel on-device gating and ranking framework for enhancing video playback performance. In particular, to screen out the choppy instances accurately, we deploy a gate model on device to evaluate the playback status of upcoming video in real-time. Furthermore, we incorporate a ranking model to select the optimum result from a locally-cached pool for replacement of the choppy ones. To strengthen the attractiveness of cached videos, we dynamically maintain a personalized pool, where the videos are obtained from server-side recommender system via a cache update mechanism.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Our contributions can be summarized as follows:</p>
</div>
<figure class="ltx_figure" id="S1.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="441" id="S1.F2.g1" src="x2.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>The relation between average session watch time and the proportion of choppy videos in a session.</figcaption>
</figure>
<div class="ltx_para" id="S1.p8">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We highlight the choppy playback, a real issue experienced by the client, and demonstrate its substantial impact on video recommender systems. This indicates a prospective direction for improving user engagement.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose a simple yet effective on-device gating and ranking framework, called GRF, for enhancing playback performance in video recommender systems. To the best of our knowledge, we are the first to provide an on-device RS in a network-free environment, and it is easy to adapt our design to other scenarios.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We conducted extensive offline experiments and online A/B testing in a real-world industrial scenario, which further demonstrate the effectiveness of our framework.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>RELATED WORK</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>On-device Recommender Systems</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Most industry-scale recommender systems (RSs) were deployed on cloud server with a multi-stage paradigm. Typically, RSs compute the top-N items and transmitted an ordered list to client from each request, thus it cannot adjust the results between two adjacent requests. To fully utilize client-side real-time signals, some RSs have been successfully deployed on-device. For example, EdgeRec <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib9" title="">2020</a>)</cite> propose a context-aware reranking with behavior attention network to model interactions between candidate items and real-time user behavior. <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib8" title="">2022</a>)</cite> design a re-ranking solution that fits on mobile devices for short-video recommendation. These methods emphasize tackling system latency caused by server-side paging mechanisms and capturing real-time user preference. However, We highlight the importance of playback performance and address it on-device in a real-world video recommender system.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="276" id="S2.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>The proposed Gating and Ranking framework (GRF) involves two stages: Gating, which screens out choppy video (surround with a red rectangle), and Ranking, which selects the best local cache video for the replacement.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Playback Performance Optimization</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Due to the volatility of network conditions and the potential variability in video sizes, users frequently encounter choppy playback while browsing the videos. To address this, previous works <cite class="ltx_cite ltx_citemacro_citep">(Akhtar et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib3" title="">2018</a>; Feng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib6" title="">2019</a>; Hodzic et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib11" title="">2022</a>)</cite> employ a video bit rate adjustment algorithm, which adaptively adjusts the video bit rate during playing to improve playback performance. Through effective, the main limitations lie in (1) unable to handle the failed loading or slow loading of the first screen, (2) some user may be sensitive to video quality adjustment. <cite class="ltx_cite ltx_citemacro_citep">(Lang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib15" title="">2023</a>)</cite> propose a recommendation framework which jointly considers network status and video attractiveness. Since the solution works on the cloud server, it lacks the ability to adjust recommendation contents based on real-time playback performance.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>SYSTEM</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.2">In this section, we present an overview of the proposed system, As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S2.F3" title="Figure 3 ‣ 2.1. On-device Recommender Systems ‣ 2. RELATED WORK ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">3</span></a>, GRF works on the device and seeks to cooperate with RS on cloud, the system involves two stages: <math alttext="(1)" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.2.2"><mo id="S3.p1.1.m1.1.2.2.1" stretchy="false">(</mo><mn id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">1</mn><mo id="S3.p1.1.m1.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><cn id="S3.p1.1.m1.1.1.cmml" type="integer" xref="S3.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">(1)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">( 1 )</annotation></semantics></math> Gating and <math alttext="(2)" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.2.2"><mo id="S3.p1.2.m2.1.2.2.1" stretchy="false">(</mo><mn id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">2</mn><mo id="S3.p1.2.m2.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><cn id="S3.p1.2.m2.1.1.cmml" type="integer" xref="S3.p1.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">(2)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">( 2 )</annotation></semantics></math> Ranking. The gating operates when a user scrolls down on the screen and makes an inference for the upcoming video. Once the video is predicted to be a choppy sample, the ranking stage will automatically activate and select an optimal result from a personalized locally-cached pool to replace the choppy ones with real-time features.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Problem Definition</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.13">We formulate the GRF as a two-stage problem, whose input is the ranking list requested from the server side, represented as <math alttext="V=\left\{v_{1},v_{2},...,v_{n}\right\}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.4"><semantics id="S3.SS1.p1.1.m1.4a"><mrow id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml"><mi id="S3.SS1.p1.1.m1.4.4.5" xref="S3.SS1.p1.1.m1.4.4.5.cmml">V</mi><mo id="S3.SS1.p1.1.m1.4.4.4" xref="S3.SS1.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.1.m1.4.4.3.3" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS1.p1.1.m1.4.4.3.3.4" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.1.m1.2.2.1.1.1" xref="S3.SS1.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS1.p1.1.m1.2.2.1.1.1.3" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.5" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.3.3.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.3.3.2.2.2.2" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml">v</mi><mn id="S3.SS1.p1.1.m1.3.3.2.2.2.3" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.6" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS1.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS1.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.1.m1.4.4.3.3.7" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.1.m1.4.4.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.2" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml">v</mi><mi id="S3.SS1.p1.1.m1.4.4.3.3.3.3" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS1.p1.1.m1.4.4.3.3.8" xref="S3.SS1.p1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.4b"><apply id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4"><eq id="S3.SS1.p1.1.m1.4.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4.4"></eq><ci id="S3.SS1.p1.1.m1.4.4.5.cmml" xref="S3.SS1.p1.1.m1.4.4.5">𝑉</ci><set id="S3.SS1.p1.1.m1.4.4.3.4.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3"><apply id="S3.SS1.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.2.2.1.1.1.2">𝑣</ci><cn id="S3.SS1.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.3.3.2.2.2.2">𝑣</ci><cn id="S3.SS1.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">…</ci><apply id="S3.SS1.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.2">𝑣</ci><ci id="S3.SS1.p1.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.1.m1.4.4.3.3.3.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.4c">V=\left\{v_{1},v_{2},...,v_{n}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.4d">italic_V = { italic_v start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math>. Let <math alttext="C=\left\{c_{1},c_{2},...,c_{|C|}\right\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.5"><semantics id="S3.SS1.p1.2.m2.5a"><mrow id="S3.SS1.p1.2.m2.5.5" xref="S3.SS1.p1.2.m2.5.5.cmml"><mi id="S3.SS1.p1.2.m2.5.5.5" xref="S3.SS1.p1.2.m2.5.5.5.cmml">C</mi><mo id="S3.SS1.p1.2.m2.5.5.4" xref="S3.SS1.p1.2.m2.5.5.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.5.5.3.3" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml"><mo id="S3.SS1.p1.2.m2.5.5.3.3.4" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">{</mo><msub id="S3.SS1.p1.2.m2.3.3.1.1.1" xref="S3.SS1.p1.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.3.3.1.1.1.2" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml">c</mi><mn id="S3.SS1.p1.2.m2.3.3.1.1.1.3" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.5" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.4.4.2.2.2.2" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml">c</mi><mn id="S3.SS1.p1.2.m2.4.4.2.2.2.3" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.6" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><mi id="S3.SS1.p1.2.m2.2.2" mathvariant="normal" xref="S3.SS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p1.2.m2.5.5.3.3.7" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.5.5.3.3.3" xref="S3.SS1.p1.2.m2.5.5.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.5.5.3.3.3.2" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml">c</mi><mrow id="S3.SS1.p1.2.m2.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml">C</mi><mo id="S3.SS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub><mo id="S3.SS1.p1.2.m2.5.5.3.3.8" xref="S3.SS1.p1.2.m2.5.5.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.5b"><apply id="S3.SS1.p1.2.m2.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5"><eq id="S3.SS1.p1.2.m2.5.5.4.cmml" xref="S3.SS1.p1.2.m2.5.5.4"></eq><ci id="S3.SS1.p1.2.m2.5.5.5.cmml" xref="S3.SS1.p1.2.m2.5.5.5">𝐶</ci><set id="S3.SS1.p1.2.m2.5.5.3.4.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3"><apply id="S3.SS1.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.3.3.1.1.1.2">𝑐</ci><cn id="S3.SS1.p1.2.m2.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.4.4.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.4.4.2.2.2.2">𝑐</ci><cn id="S3.SS1.p1.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2">…</ci><apply id="S3.SS1.p1.2.m2.5.5.3.3.3.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.5.5.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.5.5.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.5.5.3.3.3.2">𝑐</ci><apply id="S3.SS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3"><abs id="S3.SS1.p1.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.3.1"></abs><ci id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">𝐶</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.5c">C=\left\{c_{1},c_{2},...,c_{|C|}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.5d">italic_C = { italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_c start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_c start_POSTSUBSCRIPT | italic_C | end_POSTSUBSCRIPT }</annotation></semantics></math> denote the videos in the locally-cached pool. The problem can be defined as follows: given a video sequence <math alttext="V" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_V</annotation></semantics></math>, user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_u</annotation></semantics></math> and corresponding candidates set <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_C</annotation></semantics></math>. We first train a binary classifier to determine the output value <math alttext="y_{i}\in\left\{0,1\right\}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.2"><semantics id="S3.SS1.p1.6.m6.2a"><mrow id="S3.SS1.p1.6.m6.2.3" xref="S3.SS1.p1.6.m6.2.3.cmml"><msub id="S3.SS1.p1.6.m6.2.3.2" xref="S3.SS1.p1.6.m6.2.3.2.cmml"><mi id="S3.SS1.p1.6.m6.2.3.2.2" xref="S3.SS1.p1.6.m6.2.3.2.2.cmml">y</mi><mi id="S3.SS1.p1.6.m6.2.3.2.3" xref="S3.SS1.p1.6.m6.2.3.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.6.m6.2.3.1" xref="S3.SS1.p1.6.m6.2.3.1.cmml">∈</mo><mrow id="S3.SS1.p1.6.m6.2.3.3.2" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml"><mo id="S3.SS1.p1.6.m6.2.3.3.2.1" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">{</mo><mn id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">0</mn><mo id="S3.SS1.p1.6.m6.2.3.3.2.2" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">,</mo><mn id="S3.SS1.p1.6.m6.2.2" xref="S3.SS1.p1.6.m6.2.2.cmml">1</mn><mo id="S3.SS1.p1.6.m6.2.3.3.2.3" xref="S3.SS1.p1.6.m6.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.2b"><apply id="S3.SS1.p1.6.m6.2.3.cmml" xref="S3.SS1.p1.6.m6.2.3"><in id="S3.SS1.p1.6.m6.2.3.1.cmml" xref="S3.SS1.p1.6.m6.2.3.1"></in><apply id="S3.SS1.p1.6.m6.2.3.2.cmml" xref="S3.SS1.p1.6.m6.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.2.3.2.1.cmml" xref="S3.SS1.p1.6.m6.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.6.m6.2.3.2.2.cmml" xref="S3.SS1.p1.6.m6.2.3.2.2">𝑦</ci><ci id="S3.SS1.p1.6.m6.2.3.2.3.cmml" xref="S3.SS1.p1.6.m6.2.3.2.3">𝑖</ci></apply><set id="S3.SS1.p1.6.m6.2.3.3.1.cmml" xref="S3.SS1.p1.6.m6.2.3.3.2"><cn id="S3.SS1.p1.6.m6.1.1.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.1">0</cn><cn id="S3.SS1.p1.6.m6.2.2.cmml" type="integer" xref="S3.SS1.p1.6.m6.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.2c">y_{i}\in\left\{0,1\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.2d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ { 0 , 1 }</annotation></semantics></math> for each upcoming video <math alttext="v_{i}\in V" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><msub id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2.2" xref="S3.SS1.p1.7.m7.1.1.2.2.cmml">v</mi><mi id="S3.SS1.p1.7.m7.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.7.m7.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><in id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1"></in><apply id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2">𝑣</ci><ci id="S3.SS1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">v_{i}\in V</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_V</annotation></semantics></math> , where <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">y</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑦</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the prediction status of <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝑣</ci><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Once <math alttext="y_{i}=1" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><msub id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2.2" xref="S3.SS1.p1.10.m10.1.1.2.2.cmml">y</mi><mi id="S3.SS1.p1.10.m10.1.1.2.3" xref="S3.SS1.p1.10.m10.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.10.m10.1.1.1" xref="S3.SS1.p1.10.m10.1.1.1.cmml">=</mo><mn id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><eq id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1.1"></eq><apply id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS1.p1.10.m10.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2.2">𝑦</ci><ci id="S3.SS1.p1.10.m10.1.1.2.3.cmml" xref="S3.SS1.p1.10.m10.1.1.2.3">𝑖</ci></apply><cn id="S3.SS1.p1.10.m10.1.1.3.cmml" type="integer" xref="S3.SS1.p1.10.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">y_{i}=1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = 1</annotation></semantics></math>, the ranking model is activated to choose an optimal video <math alttext="c_{j}\in C" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mrow id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><msub id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2.2" xref="S3.SS1.p1.11.m11.1.1.2.2.cmml">c</mi><mi id="S3.SS1.p1.11.m11.1.1.2.3" xref="S3.SS1.p1.11.m11.1.1.2.3.cmml">j</mi></msub><mo id="S3.SS1.p1.11.m11.1.1.1" xref="S3.SS1.p1.11.m11.1.1.1.cmml">∈</mo><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><in id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1.1"></in><apply id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.2.1.cmml" xref="S3.SS1.p1.11.m11.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2.2">𝑐</ci><ci id="S3.SS1.p1.11.m11.1.1.2.3.cmml" xref="S3.SS1.p1.11.m11.1.1.2.3">𝑗</ci></apply><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">c_{j}\in C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ italic_C</annotation></semantics></math> via a multi-task learning paradigm. After that, the video <math alttext="c_{j}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">c</mi><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝑐</ci><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">c_{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> will be displayed to the user, while the video <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">v</mi><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝑣</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> will queued for caching and stored in the locally-cached pool. The overall notations are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.T1" title="Table 1 ‣ 3.2. Stage I : Gating ‣ 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="415" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>The architecture of the on-device Gate model (a) and Ranking model (b).</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Stage I : Gating</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The goal of the gate model is to screen out the choppy videos. Based on the video playback status, we define cases such as video stuttering, slow loading of the first screen, and failed loading as positive (or choppy) samples, while seamless playback is considered a negative sample. The model structure is presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.F4" title="Figure 4 ‣ 3.1. Problem Definition ‣ 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">4</span></a> (a),</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.4"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.4.1">Features.</span> We elaborately pick out and extract features to keep the model lightweight yet effective. Input Features consist of several categories: <math alttext="(a)" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.2.2"><mo id="S3.SS2.p2.1.m1.1.2.2.1" stretchy="false">(</mo><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">a</mi><mo id="S3.SS2.p2.1.m1.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">(a)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">( italic_a )</annotation></semantics></math> Static feature, such as video duration, device score, prior bias, etc. Prior bias consists of several categorical features classified with statistical data manually. For example, the video’s size may divided into 3 levels: small, middle, and large, which can mapped to 0, 1, 2. <math alttext="(b)" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.2.2"><mo id="S3.SS2.p2.2.m2.1.2.2.1" stretchy="false">(</mo><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">b</mi><mo id="S3.SS2.p2.2.m2.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">(b)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">( italic_b )</annotation></semantics></math> Dynamic feature (such as network speed, video cached ratio, etc.). These features will collected during a real-time watched list and constructed as a sequence. and <math alttext="(c)" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.2.2"><mo id="S3.SS2.p2.3.m3.1.2.2.1" stretchy="false">(</mo><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">c</mi><mo id="S3.SS2.p2.3.m3.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">(c)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">( italic_c )</annotation></semantics></math> Choppy video list <math alttext="H_{c}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">H</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝐻</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">H_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_H start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math>, the choppy video sequence of the user’s watching history. To reduce the dimension of feature space, we bucketize the numerical features to equal distance bins. Following <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib8" title="">2022</a>)</cite>, we then embed the discrete features to latent space using AutoDis <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib10" title="">2021</a>)</cite> technique.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>The main notations and features of our work.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.15">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.15.16.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.15.16.1.1">Notation</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.15.16.1.2">Description</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.1.1"><math alttext="u" class="ltx_Math" display="inline" id="S3.T1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.m1.1a"><mi id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><ci id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">italic_u</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.1.2">a user</td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.2.2.1"><math alttext="v" class="ltx_Math" display="inline" id="S3.T1.2.2.1.m1.1"><semantics id="S3.T1.2.2.1.m1.1a"><mi id="S3.T1.2.2.1.m1.1.1" xref="S3.T1.2.2.1.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.1.m1.1b"><ci id="S3.T1.2.2.1.m1.1.1.cmml" xref="S3.T1.2.2.1.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.1.m1.1c">v</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.1.m1.1d">italic_v</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.2.2.2">a video</td>
</tr>
<tr class="ltx_tr" id="S3.T1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.3.3.1"><math alttext="V" class="ltx_Math" display="inline" id="S3.T1.3.3.1.m1.1"><semantics id="S3.T1.3.3.1.m1.1a"><mi id="S3.T1.3.3.1.m1.1.1" xref="S3.T1.3.3.1.m1.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.1.m1.1b"><ci id="S3.T1.3.3.1.m1.1.1.cmml" xref="S3.T1.3.3.1.m1.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.1.m1.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.1.m1.1d">italic_V</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.3.3.2">Ordered video list from cloud RS</td>
</tr>
<tr class="ltx_tr" id="S3.T1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.4.4.1"><math alttext="C" class="ltx_Math" display="inline" id="S3.T1.4.4.1.m1.1"><semantics id="S3.T1.4.4.1.m1.1a"><mi id="S3.T1.4.4.1.m1.1.1" xref="S3.T1.4.4.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.1.m1.1b"><ci id="S3.T1.4.4.1.m1.1.1.cmml" xref="S3.T1.4.4.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.1.m1.1d">italic_C</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.4.4.2">The set of videos in locally-cached pool.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.5.5.1"><math alttext="R" class="ltx_Math" display="inline" id="S3.T1.5.5.1.m1.1"><semantics id="S3.T1.5.5.1.m1.1a"><mi id="S3.T1.5.5.1.m1.1.1" xref="S3.T1.5.5.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><ci id="S3.T1.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.1.m1.1d">italic_R</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.5.5.2">latest video list in user’s watched history.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.6.6.1"><math alttext="H_{c}" class="ltx_Math" display="inline" id="S3.T1.6.6.1.m1.1"><semantics id="S3.T1.6.6.1.m1.1a"><msub id="S3.T1.6.6.1.m1.1.1" xref="S3.T1.6.6.1.m1.1.1.cmml"><mi id="S3.T1.6.6.1.m1.1.1.2" xref="S3.T1.6.6.1.m1.1.1.2.cmml">H</mi><mi id="S3.T1.6.6.1.m1.1.1.3" xref="S3.T1.6.6.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.1.m1.1b"><apply id="S3.T1.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.6.6.1.m1.1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1">subscript</csymbol><ci id="S3.T1.6.6.1.m1.1.1.2.cmml" xref="S3.T1.6.6.1.m1.1.1.2">𝐻</ci><ci id="S3.T1.6.6.1.m1.1.1.3.cmml" xref="S3.T1.6.6.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.1.m1.1c">H_{c}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.1.m1.1d">italic_H start_POSTSUBSCRIPT italic_c end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.6.6.2">Choppy video list in user’s watched history.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.7.7.1"><math alttext="s_{net}" class="ltx_Math" display="inline" id="S3.T1.7.7.1.m1.1"><semantics id="S3.T1.7.7.1.m1.1a"><msub id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml"><mi id="S3.T1.7.7.1.m1.1.1.2" xref="S3.T1.7.7.1.m1.1.1.2.cmml">s</mi><mrow id="S3.T1.7.7.1.m1.1.1.3" xref="S3.T1.7.7.1.m1.1.1.3.cmml"><mi id="S3.T1.7.7.1.m1.1.1.3.2" xref="S3.T1.7.7.1.m1.1.1.3.2.cmml">n</mi><mo id="S3.T1.7.7.1.m1.1.1.3.1" xref="S3.T1.7.7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.7.7.1.m1.1.1.3.3" xref="S3.T1.7.7.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.T1.7.7.1.m1.1.1.3.1a" xref="S3.T1.7.7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.7.7.1.m1.1.1.3.4" xref="S3.T1.7.7.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><apply id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.7.7.1.m1.1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">subscript</csymbol><ci id="S3.T1.7.7.1.m1.1.1.2.cmml" xref="S3.T1.7.7.1.m1.1.1.2">𝑠</ci><apply id="S3.T1.7.7.1.m1.1.1.3.cmml" xref="S3.T1.7.7.1.m1.1.1.3"><times id="S3.T1.7.7.1.m1.1.1.3.1.cmml" xref="S3.T1.7.7.1.m1.1.1.3.1"></times><ci id="S3.T1.7.7.1.m1.1.1.3.2.cmml" xref="S3.T1.7.7.1.m1.1.1.3.2">𝑛</ci><ci id="S3.T1.7.7.1.m1.1.1.3.3.cmml" xref="S3.T1.7.7.1.m1.1.1.3.3">𝑒</ci><ci id="S3.T1.7.7.1.m1.1.1.3.4.cmml" xref="S3.T1.7.7.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">s_{net}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_n italic_e italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.7.7.2">current network speed.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.8.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.8.8.1"><math alttext="V_{up}" class="ltx_Math" display="inline" id="S3.T1.8.8.1.m1.1"><semantics id="S3.T1.8.8.1.m1.1a"><msub id="S3.T1.8.8.1.m1.1.1" xref="S3.T1.8.8.1.m1.1.1.cmml"><mi id="S3.T1.8.8.1.m1.1.1.2" xref="S3.T1.8.8.1.m1.1.1.2.cmml">V</mi><mrow id="S3.T1.8.8.1.m1.1.1.3" xref="S3.T1.8.8.1.m1.1.1.3.cmml"><mi id="S3.T1.8.8.1.m1.1.1.3.2" xref="S3.T1.8.8.1.m1.1.1.3.2.cmml">u</mi><mo id="S3.T1.8.8.1.m1.1.1.3.1" xref="S3.T1.8.8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.8.8.1.m1.1.1.3.3" xref="S3.T1.8.8.1.m1.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.1.m1.1b"><apply id="S3.T1.8.8.1.m1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.8.8.1.m1.1.1.1.cmml" xref="S3.T1.8.8.1.m1.1.1">subscript</csymbol><ci id="S3.T1.8.8.1.m1.1.1.2.cmml" xref="S3.T1.8.8.1.m1.1.1.2">𝑉</ci><apply id="S3.T1.8.8.1.m1.1.1.3.cmml" xref="S3.T1.8.8.1.m1.1.1.3"><times id="S3.T1.8.8.1.m1.1.1.3.1.cmml" xref="S3.T1.8.8.1.m1.1.1.3.1"></times><ci id="S3.T1.8.8.1.m1.1.1.3.2.cmml" xref="S3.T1.8.8.1.m1.1.1.3.2">𝑢</ci><ci id="S3.T1.8.8.1.m1.1.1.3.3.cmml" xref="S3.T1.8.8.1.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.1.m1.1c">V_{up}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.1.m1.1d">italic_V start_POSTSUBSCRIPT italic_u italic_p end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.8.8.2">Upcoming video list.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.9.9">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.9.9.1"><math alttext="v_{dur}" class="ltx_Math" display="inline" id="S3.T1.9.9.1.m1.1"><semantics id="S3.T1.9.9.1.m1.1a"><msub id="S3.T1.9.9.1.m1.1.1" xref="S3.T1.9.9.1.m1.1.1.cmml"><mi id="S3.T1.9.9.1.m1.1.1.2" xref="S3.T1.9.9.1.m1.1.1.2.cmml">v</mi><mrow id="S3.T1.9.9.1.m1.1.1.3" xref="S3.T1.9.9.1.m1.1.1.3.cmml"><mi id="S3.T1.9.9.1.m1.1.1.3.2" xref="S3.T1.9.9.1.m1.1.1.3.2.cmml">d</mi><mo id="S3.T1.9.9.1.m1.1.1.3.1" xref="S3.T1.9.9.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.9.9.1.m1.1.1.3.3" xref="S3.T1.9.9.1.m1.1.1.3.3.cmml">u</mi><mo id="S3.T1.9.9.1.m1.1.1.3.1a" xref="S3.T1.9.9.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.9.9.1.m1.1.1.3.4" xref="S3.T1.9.9.1.m1.1.1.3.4.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.1.m1.1b"><apply id="S3.T1.9.9.1.m1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.9.9.1.m1.1.1.1.cmml" xref="S3.T1.9.9.1.m1.1.1">subscript</csymbol><ci id="S3.T1.9.9.1.m1.1.1.2.cmml" xref="S3.T1.9.9.1.m1.1.1.2">𝑣</ci><apply id="S3.T1.9.9.1.m1.1.1.3.cmml" xref="S3.T1.9.9.1.m1.1.1.3"><times id="S3.T1.9.9.1.m1.1.1.3.1.cmml" xref="S3.T1.9.9.1.m1.1.1.3.1"></times><ci id="S3.T1.9.9.1.m1.1.1.3.2.cmml" xref="S3.T1.9.9.1.m1.1.1.3.2">𝑑</ci><ci id="S3.T1.9.9.1.m1.1.1.3.3.cmml" xref="S3.T1.9.9.1.m1.1.1.3.3">𝑢</ci><ci id="S3.T1.9.9.1.m1.1.1.3.4.cmml" xref="S3.T1.9.9.1.m1.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.1.m1.1c">v_{dur}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_d italic_u italic_r end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.9.9.2">The cached duration of a video.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.10.10">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.10.10.1"><math alttext="v_{rat}" class="ltx_Math" display="inline" id="S3.T1.10.10.1.m1.1"><semantics id="S3.T1.10.10.1.m1.1a"><msub id="S3.T1.10.10.1.m1.1.1" xref="S3.T1.10.10.1.m1.1.1.cmml"><mi id="S3.T1.10.10.1.m1.1.1.2" xref="S3.T1.10.10.1.m1.1.1.2.cmml">v</mi><mrow id="S3.T1.10.10.1.m1.1.1.3" xref="S3.T1.10.10.1.m1.1.1.3.cmml"><mi id="S3.T1.10.10.1.m1.1.1.3.2" xref="S3.T1.10.10.1.m1.1.1.3.2.cmml">r</mi><mo id="S3.T1.10.10.1.m1.1.1.3.1" xref="S3.T1.10.10.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.10.10.1.m1.1.1.3.3" xref="S3.T1.10.10.1.m1.1.1.3.3.cmml">a</mi><mo id="S3.T1.10.10.1.m1.1.1.3.1a" xref="S3.T1.10.10.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.T1.10.10.1.m1.1.1.3.4" xref="S3.T1.10.10.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.1.m1.1b"><apply id="S3.T1.10.10.1.m1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.1.m1.1.1.1.cmml" xref="S3.T1.10.10.1.m1.1.1">subscript</csymbol><ci id="S3.T1.10.10.1.m1.1.1.2.cmml" xref="S3.T1.10.10.1.m1.1.1.2">𝑣</ci><apply id="S3.T1.10.10.1.m1.1.1.3.cmml" xref="S3.T1.10.10.1.m1.1.1.3"><times id="S3.T1.10.10.1.m1.1.1.3.1.cmml" xref="S3.T1.10.10.1.m1.1.1.3.1"></times><ci id="S3.T1.10.10.1.m1.1.1.3.2.cmml" xref="S3.T1.10.10.1.m1.1.1.3.2">𝑟</ci><ci id="S3.T1.10.10.1.m1.1.1.3.3.cmml" xref="S3.T1.10.10.1.m1.1.1.3.3">𝑎</ci><ci id="S3.T1.10.10.1.m1.1.1.3.4.cmml" xref="S3.T1.10.10.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.1.m1.1c">v_{rat}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_r italic_a italic_t end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.10.10.2">The cached ratio of a video.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.11.11">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.11.11.1"><math alttext="pxtr" class="ltx_Math" display="inline" id="S3.T1.11.11.1.m1.1"><semantics id="S3.T1.11.11.1.m1.1a"><mrow id="S3.T1.11.11.1.m1.1.1" xref="S3.T1.11.11.1.m1.1.1.cmml"><mi id="S3.T1.11.11.1.m1.1.1.2" xref="S3.T1.11.11.1.m1.1.1.2.cmml">p</mi><mo id="S3.T1.11.11.1.m1.1.1.1" xref="S3.T1.11.11.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.11.11.1.m1.1.1.3" xref="S3.T1.11.11.1.m1.1.1.3.cmml">x</mi><mo id="S3.T1.11.11.1.m1.1.1.1a" xref="S3.T1.11.11.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.11.11.1.m1.1.1.4" xref="S3.T1.11.11.1.m1.1.1.4.cmml">t</mi><mo id="S3.T1.11.11.1.m1.1.1.1b" xref="S3.T1.11.11.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.11.11.1.m1.1.1.5" xref="S3.T1.11.11.1.m1.1.1.5.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.1.m1.1b"><apply id="S3.T1.11.11.1.m1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1"><times id="S3.T1.11.11.1.m1.1.1.1.cmml" xref="S3.T1.11.11.1.m1.1.1.1"></times><ci id="S3.T1.11.11.1.m1.1.1.2.cmml" xref="S3.T1.11.11.1.m1.1.1.2">𝑝</ci><ci id="S3.T1.11.11.1.m1.1.1.3.cmml" xref="S3.T1.11.11.1.m1.1.1.3">𝑥</ci><ci id="S3.T1.11.11.1.m1.1.1.4.cmml" xref="S3.T1.11.11.1.m1.1.1.4">𝑡</ci><ci id="S3.T1.11.11.1.m1.1.1.5.cmml" xref="S3.T1.11.11.1.m1.1.1.5">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.1.m1.1c">pxtr</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.11.1.m1.1d">italic_p italic_x italic_t italic_r</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.11.11.2">The predicted value of server-side ranking model.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.12.12">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.12.12.1"><math alttext="fpr" class="ltx_Math" display="inline" id="S3.T1.12.12.1.m1.1"><semantics id="S3.T1.12.12.1.m1.1a"><mrow id="S3.T1.12.12.1.m1.1.1" xref="S3.T1.12.12.1.m1.1.1.cmml"><mi id="S3.T1.12.12.1.m1.1.1.2" xref="S3.T1.12.12.1.m1.1.1.2.cmml">f</mi><mo id="S3.T1.12.12.1.m1.1.1.1" xref="S3.T1.12.12.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.12.12.1.m1.1.1.3" xref="S3.T1.12.12.1.m1.1.1.3.cmml">p</mi><mo id="S3.T1.12.12.1.m1.1.1.1a" xref="S3.T1.12.12.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.12.12.1.m1.1.1.4" xref="S3.T1.12.12.1.m1.1.1.4.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.1.m1.1b"><apply id="S3.T1.12.12.1.m1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1"><times id="S3.T1.12.12.1.m1.1.1.1.cmml" xref="S3.T1.12.12.1.m1.1.1.1"></times><ci id="S3.T1.12.12.1.m1.1.1.2.cmml" xref="S3.T1.12.12.1.m1.1.1.2">𝑓</ci><ci id="S3.T1.12.12.1.m1.1.1.3.cmml" xref="S3.T1.12.12.1.m1.1.1.3">𝑝</ci><ci id="S3.T1.12.12.1.m1.1.1.4.cmml" xref="S3.T1.12.12.1.m1.1.1.4">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.1.m1.1c">fpr</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.12.1.m1.1d">italic_f italic_p italic_r</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.12.12.2">the predicted rate of completely watching video.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.13.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.13.13.1"><math alttext="evr" class="ltx_Math" display="inline" id="S3.T1.13.13.1.m1.1"><semantics id="S3.T1.13.13.1.m1.1a"><mrow id="S3.T1.13.13.1.m1.1.1" xref="S3.T1.13.13.1.m1.1.1.cmml"><mi id="S3.T1.13.13.1.m1.1.1.2" xref="S3.T1.13.13.1.m1.1.1.2.cmml">e</mi><mo id="S3.T1.13.13.1.m1.1.1.1" xref="S3.T1.13.13.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.13.13.1.m1.1.1.3" xref="S3.T1.13.13.1.m1.1.1.3.cmml">v</mi><mo id="S3.T1.13.13.1.m1.1.1.1a" xref="S3.T1.13.13.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.13.13.1.m1.1.1.4" xref="S3.T1.13.13.1.m1.1.1.4.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.13.13.1.m1.1b"><apply id="S3.T1.13.13.1.m1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1"><times id="S3.T1.13.13.1.m1.1.1.1.cmml" xref="S3.T1.13.13.1.m1.1.1.1"></times><ci id="S3.T1.13.13.1.m1.1.1.2.cmml" xref="S3.T1.13.13.1.m1.1.1.2">𝑒</ci><ci id="S3.T1.13.13.1.m1.1.1.3.cmml" xref="S3.T1.13.13.1.m1.1.1.3">𝑣</ci><ci id="S3.T1.13.13.1.m1.1.1.4.cmml" xref="S3.T1.13.13.1.m1.1.1.4">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.13.1.m1.1c">evr</annotation><annotation encoding="application/x-llamapun" id="S3.T1.13.13.1.m1.1d">italic_e italic_v italic_r</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.13.13.2">the predicted rate of effectively watching video.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.14.14">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.14.14.1"><math alttext="lvr" class="ltx_Math" display="inline" id="S3.T1.14.14.1.m1.1"><semantics id="S3.T1.14.14.1.m1.1a"><mrow id="S3.T1.14.14.1.m1.1.1" xref="S3.T1.14.14.1.m1.1.1.cmml"><mi id="S3.T1.14.14.1.m1.1.1.2" xref="S3.T1.14.14.1.m1.1.1.2.cmml">l</mi><mo id="S3.T1.14.14.1.m1.1.1.1" xref="S3.T1.14.14.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.14.14.1.m1.1.1.3" xref="S3.T1.14.14.1.m1.1.1.3.cmml">v</mi><mo id="S3.T1.14.14.1.m1.1.1.1a" xref="S3.T1.14.14.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.14.14.1.m1.1.1.4" xref="S3.T1.14.14.1.m1.1.1.4.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.14.14.1.m1.1b"><apply id="S3.T1.14.14.1.m1.1.1.cmml" xref="S3.T1.14.14.1.m1.1.1"><times id="S3.T1.14.14.1.m1.1.1.1.cmml" xref="S3.T1.14.14.1.m1.1.1.1"></times><ci id="S3.T1.14.14.1.m1.1.1.2.cmml" xref="S3.T1.14.14.1.m1.1.1.2">𝑙</ci><ci id="S3.T1.14.14.1.m1.1.1.3.cmml" xref="S3.T1.14.14.1.m1.1.1.3">𝑣</ci><ci id="S3.T1.14.14.1.m1.1.1.4.cmml" xref="S3.T1.14.14.1.m1.1.1.4">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.14.1.m1.1c">lvr</annotation><annotation encoding="application/x-llamapun" id="S3.T1.14.14.1.m1.1d">italic_l italic_v italic_r</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S3.T1.14.14.2">the predicted rate of long watching video.</td>
</tr>
<tr class="ltx_tr" id="S3.T1.15.15">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T1.15.15.1"><math alttext="svr" class="ltx_Math" display="inline" id="S3.T1.15.15.1.m1.1"><semantics id="S3.T1.15.15.1.m1.1a"><mrow id="S3.T1.15.15.1.m1.1.1" xref="S3.T1.15.15.1.m1.1.1.cmml"><mi id="S3.T1.15.15.1.m1.1.1.2" xref="S3.T1.15.15.1.m1.1.1.2.cmml">s</mi><mo id="S3.T1.15.15.1.m1.1.1.1" xref="S3.T1.15.15.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.15.15.1.m1.1.1.3" xref="S3.T1.15.15.1.m1.1.1.3.cmml">v</mi><mo id="S3.T1.15.15.1.m1.1.1.1a" xref="S3.T1.15.15.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.T1.15.15.1.m1.1.1.4" xref="S3.T1.15.15.1.m1.1.1.4.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.15.15.1.m1.1b"><apply id="S3.T1.15.15.1.m1.1.1.cmml" xref="S3.T1.15.15.1.m1.1.1"><times id="S3.T1.15.15.1.m1.1.1.1.cmml" xref="S3.T1.15.15.1.m1.1.1.1"></times><ci id="S3.T1.15.15.1.m1.1.1.2.cmml" xref="S3.T1.15.15.1.m1.1.1.2">𝑠</ci><ci id="S3.T1.15.15.1.m1.1.1.3.cmml" xref="S3.T1.15.15.1.m1.1.1.3">𝑣</ci><ci id="S3.T1.15.15.1.m1.1.1.4.cmml" xref="S3.T1.15.15.1.m1.1.1.4">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.15.1.m1.1c">svr</annotation><annotation encoding="application/x-llamapun" id="S3.T1.15.15.1.m1.1d">italic_s italic_v italic_r</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.15.15.2">the predicted rate of watching less then 3 seconds.</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.1">MaskNet &amp; Target attention.</span> We adopt a parallel MaskNet layer <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib21" title="">2021</a>)</cite> to capture complex high-order features effectively. This layer takes the feature embedding concatenation as input and exploits multiple MaskBlock to incorporate different kinds of features and their interactions. Then, we employ a hierarchical target attention <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib23" title="">2018</a>)</cite> to attend most important information in feature sequence. The first attention layer is used to capture feature evolution with time series, while the second layer is utilized to highlight the informative features in history choppy video list.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.2"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.2.1">Output Layer.</span> Let <math alttext="h" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_h</annotation></semantics></math> be the final hidden representation of the last target attention layer, we concatenate <math alttext="h" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_h</annotation></semantics></math> with the representation of the prior bias feature. Then, we employ a linear layer followed by a sigmoid activation function to predict whether the target video is choppy.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Stage II : Ranking</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.2">The structure of ranking model is presented in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.F4" title="Figure 4 ‣ 3.1. Problem Definition ‣ 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">4</span></a> (b). Different from gating stage, the goal of the Ranking model is to predict multiple xtrs and can be formulated as a multi-task learning problem. <cite class="ltx_cite ltx_citemacro_citep">(Caruana, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib4" title="">1997</a>)</cite>. Let <math alttext="v_{i}\in V" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mrow id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><msub id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2.2" xref="S3.SS3.p1.1.m1.1.1.2.2.cmml">v</mi><mi id="S3.SS3.p1.1.m1.1.1.2.3" xref="S3.SS3.p1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p1.1.m1.1.1.1" xref="S3.SS3.p1.1.m1.1.1.1.cmml">∈</mo><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><in id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1.1"></in><apply id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.2.1.cmml" xref="S3.SS3.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2.2">𝑣</ci><ci id="S3.SS3.p1.1.m1.1.1.2.3.cmml" xref="S3.SS3.p1.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">v_{i}\in V</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_V</annotation></semantics></math> be a choppy video identified by discriminator and <math alttext="v_{i-1}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">v</mi><mrow id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml"><mi id="S3.SS3.p1.2.m2.1.1.3.2" xref="S3.SS3.p1.2.m2.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p1.2.m2.1.1.3.1" xref="S3.SS3.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p1.2.m2.1.1.3.3" xref="S3.SS3.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑣</ci><apply id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3"><minus id="S3.SS3.p1.2.m2.1.1.3.1.cmml" xref="S3.SS3.p1.2.m2.1.1.3.1"></minus><ci id="S3.SS3.p1.2.m2.1.1.3.2.cmml" xref="S3.SS3.p1.2.m2.1.1.3.2">𝑖</ci><cn id="S3.SS3.p1.2.m2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">v_{i-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_v start_POSTSUBSCRIPT italic_i - 1 end_POSTSUBSCRIPT</annotation></semantics></math> be impression video at present, the input features of the model are as follows:</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">Real-time watched list <math alttext="R" class="ltx_Math" display="inline" id="S3.SS3.p2.1.1.m1.1"><semantics id="S3.SS3.p2.1.1.m1.1a"><mi id="S3.SS3.p2.1.1.m1.1.1" xref="S3.SS3.p2.1.1.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.1.m1.1b"><ci id="S3.SS3.p2.1.1.m1.1.1.cmml" xref="S3.SS3.p2.1.1.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.1.m1.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.1.m1.1d">italic_R</annotation></semantics></math>.</span> The latest videos in user’s watched history, The information of these videos contains categorical features, dense pxtrs from server-side model, bucketized numeric and user feedback, etc.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p3.1.1">Target video.</span> Target video and its information are stored in locally-cached pool.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.3"><span class="ltx_text ltx_font_bold" id="S3.SS3.p4.1.1">Upcoming video list. <math alttext="V_{up}" class="ltx_Math" display="inline" id="S3.SS3.p4.1.1.m1.1"><semantics id="S3.SS3.p4.1.1.m1.1a"><msub id="S3.SS3.p4.1.1.m1.1.1" xref="S3.SS3.p4.1.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.1.m1.1.1.2" xref="S3.SS3.p4.1.1.m1.1.1.2.cmml">V</mi><mrow id="S3.SS3.p4.1.1.m1.1.1.3" xref="S3.SS3.p4.1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p4.1.1.m1.1.1.3.2" xref="S3.SS3.p4.1.1.m1.1.1.3.2.cmml">u</mi><mo id="S3.SS3.p4.1.1.m1.1.1.3.1" xref="S3.SS3.p4.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p4.1.1.m1.1.1.3.3" xref="S3.SS3.p4.1.1.m1.1.1.3.3.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.1.m1.1b"><apply id="S3.SS3.p4.1.1.m1.1.1.cmml" xref="S3.SS3.p4.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.1.m1.1.1.2">𝑉</ci><apply id="S3.SS3.p4.1.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.1.m1.1.1.3"><times id="S3.SS3.p4.1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p4.1.1.m1.1.1.3.1"></times><ci id="S3.SS3.p4.1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p4.1.1.m1.1.1.3.2">𝑢</ci><ci id="S3.SS3.p4.1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p4.1.1.m1.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.1.m1.1c">V_{up}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.1.1.m1.1d">italic_V start_POSTSUBSCRIPT italic_u italic_p end_POSTSUBSCRIPT</annotation></semantics></math></span> Since ranking model aims to select a video to replace <math alttext="v_{i}" class="ltx_Math" display="inline" id="S3.SS3.p4.2.m1.1"><semantics id="S3.SS3.p4.2.m1.1a"><msub id="S3.SS3.p4.2.m1.1.1" xref="S3.SS3.p4.2.m1.1.1.cmml"><mi id="S3.SS3.p4.2.m1.1.1.2" xref="S3.SS3.p4.2.m1.1.1.2.cmml">v</mi><mi id="S3.SS3.p4.2.m1.1.1.3" xref="S3.SS3.p4.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m1.1b"><apply id="S3.SS3.p4.2.m1.1.1.cmml" xref="S3.SS3.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.2.m1.1.1.1.cmml" xref="S3.SS3.p4.2.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.2.m1.1.1.2.cmml" xref="S3.SS3.p4.2.m1.1.1.2">𝑣</ci><ci id="S3.SS3.p4.2.m1.1.1.3.cmml" xref="S3.SS3.p4.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m1.1c">v_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.2.m1.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, the remaining videos <math alttext="\left\{v_{i+1},v_{i+2},...,v_{n}\right\}" class="ltx_Math" display="inline" id="S3.SS3.p4.3.m2.4"><semantics id="S3.SS3.p4.3.m2.4a"><mrow id="S3.SS3.p4.3.m2.4.4.3" xref="S3.SS3.p4.3.m2.4.4.4.cmml"><mo id="S3.SS3.p4.3.m2.4.4.3.4" xref="S3.SS3.p4.3.m2.4.4.4.cmml">{</mo><msub id="S3.SS3.p4.3.m2.2.2.1.1" xref="S3.SS3.p4.3.m2.2.2.1.1.cmml"><mi id="S3.SS3.p4.3.m2.2.2.1.1.2" xref="S3.SS3.p4.3.m2.2.2.1.1.2.cmml">v</mi><mrow id="S3.SS3.p4.3.m2.2.2.1.1.3" xref="S3.SS3.p4.3.m2.2.2.1.1.3.cmml"><mi id="S3.SS3.p4.3.m2.2.2.1.1.3.2" xref="S3.SS3.p4.3.m2.2.2.1.1.3.2.cmml">i</mi><mo id="S3.SS3.p4.3.m2.2.2.1.1.3.1" xref="S3.SS3.p4.3.m2.2.2.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p4.3.m2.2.2.1.1.3.3" xref="S3.SS3.p4.3.m2.2.2.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS3.p4.3.m2.4.4.3.5" xref="S3.SS3.p4.3.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.p4.3.m2.3.3.2.2" xref="S3.SS3.p4.3.m2.3.3.2.2.cmml"><mi id="S3.SS3.p4.3.m2.3.3.2.2.2" xref="S3.SS3.p4.3.m2.3.3.2.2.2.cmml">v</mi><mrow id="S3.SS3.p4.3.m2.3.3.2.2.3" xref="S3.SS3.p4.3.m2.3.3.2.2.3.cmml"><mi id="S3.SS3.p4.3.m2.3.3.2.2.3.2" xref="S3.SS3.p4.3.m2.3.3.2.2.3.2.cmml">i</mi><mo id="S3.SS3.p4.3.m2.3.3.2.2.3.1" xref="S3.SS3.p4.3.m2.3.3.2.2.3.1.cmml">+</mo><mn id="S3.SS3.p4.3.m2.3.3.2.2.3.3" xref="S3.SS3.p4.3.m2.3.3.2.2.3.3.cmml">2</mn></mrow></msub><mo id="S3.SS3.p4.3.m2.4.4.3.6" xref="S3.SS3.p4.3.m2.4.4.4.cmml">,</mo><mi id="S3.SS3.p4.3.m2.1.1" mathvariant="normal" xref="S3.SS3.p4.3.m2.1.1.cmml">…</mi><mo id="S3.SS3.p4.3.m2.4.4.3.7" xref="S3.SS3.p4.3.m2.4.4.4.cmml">,</mo><msub id="S3.SS3.p4.3.m2.4.4.3.3" xref="S3.SS3.p4.3.m2.4.4.3.3.cmml"><mi id="S3.SS3.p4.3.m2.4.4.3.3.2" xref="S3.SS3.p4.3.m2.4.4.3.3.2.cmml">v</mi><mi id="S3.SS3.p4.3.m2.4.4.3.3.3" xref="S3.SS3.p4.3.m2.4.4.3.3.3.cmml">n</mi></msub><mo id="S3.SS3.p4.3.m2.4.4.3.8" xref="S3.SS3.p4.3.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m2.4b"><set id="S3.SS3.p4.3.m2.4.4.4.cmml" xref="S3.SS3.p4.3.m2.4.4.3"><apply id="S3.SS3.p4.3.m2.2.2.1.1.cmml" xref="S3.SS3.p4.3.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m2.2.2.1.1.1.cmml" xref="S3.SS3.p4.3.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p4.3.m2.2.2.1.1.2.cmml" xref="S3.SS3.p4.3.m2.2.2.1.1.2">𝑣</ci><apply id="S3.SS3.p4.3.m2.2.2.1.1.3.cmml" xref="S3.SS3.p4.3.m2.2.2.1.1.3"><plus id="S3.SS3.p4.3.m2.2.2.1.1.3.1.cmml" xref="S3.SS3.p4.3.m2.2.2.1.1.3.1"></plus><ci id="S3.SS3.p4.3.m2.2.2.1.1.3.2.cmml" xref="S3.SS3.p4.3.m2.2.2.1.1.3.2">𝑖</ci><cn id="S3.SS3.p4.3.m2.2.2.1.1.3.3.cmml" type="integer" xref="S3.SS3.p4.3.m2.2.2.1.1.3.3">1</cn></apply></apply><apply id="S3.SS3.p4.3.m2.3.3.2.2.cmml" xref="S3.SS3.p4.3.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m2.3.3.2.2.1.cmml" xref="S3.SS3.p4.3.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p4.3.m2.3.3.2.2.2.cmml" xref="S3.SS3.p4.3.m2.3.3.2.2.2">𝑣</ci><apply id="S3.SS3.p4.3.m2.3.3.2.2.3.cmml" xref="S3.SS3.p4.3.m2.3.3.2.2.3"><plus id="S3.SS3.p4.3.m2.3.3.2.2.3.1.cmml" xref="S3.SS3.p4.3.m2.3.3.2.2.3.1"></plus><ci id="S3.SS3.p4.3.m2.3.3.2.2.3.2.cmml" xref="S3.SS3.p4.3.m2.3.3.2.2.3.2">𝑖</ci><cn id="S3.SS3.p4.3.m2.3.3.2.2.3.3.cmml" type="integer" xref="S3.SS3.p4.3.m2.3.3.2.2.3.3">2</cn></apply></apply><ci id="S3.SS3.p4.3.m2.1.1.cmml" xref="S3.SS3.p4.3.m2.1.1">…</ci><apply id="S3.SS3.p4.3.m2.4.4.3.3.cmml" xref="S3.SS3.p4.3.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p4.3.m2.4.4.3.3.1.cmml" xref="S3.SS3.p4.3.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS3.p4.3.m2.4.4.3.3.2.cmml" xref="S3.SS3.p4.3.m2.4.4.3.3.2">𝑣</ci><ci id="S3.SS3.p4.3.m2.4.4.3.3.3.cmml" xref="S3.SS3.p4.3.m2.4.4.3.3.3">𝑛</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m2.4c">\left\{v_{i+1},v_{i+2},...,v_{n}\right\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p4.3.m2.4d">{ italic_v start_POSTSUBSCRIPT italic_i + 1 end_POSTSUBSCRIPT , italic_v start_POSTSUBSCRIPT italic_i + 2 end_POSTSUBSCRIPT , … , italic_v start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT }</annotation></semantics></math> of original ranked list are also be feed into model as a contextual feature to capture mutual influence between different items.</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.3"><span class="ltx_text ltx_font_bold" id="S3.SS3.p5.3.1">Multi-head Target Attention.</span> We incorporate a multi-head attention mechanism (MHA) <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib20" title="">2017</a>)</cite> to capture the interactions between target video and real-time watched sequence. In this context, we have replaced self-attention with target attention proposed in <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib23" title="">2018</a>)</cite>.
This layer takes target video representation <math alttext="h\in R^{1\times d_{h}}" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><mrow id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">h</mi><mo id="S3.SS3.p5.1.m1.1.1.1" xref="S3.SS3.p5.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.2" xref="S3.SS3.p5.1.m1.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p5.1.m1.1.1.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.cmml"><mn id="S3.SS3.p5.1.m1.1.1.3.3.2" xref="S3.SS3.p5.1.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.SS3.p5.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p5.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p5.1.m1.1.1.3.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.p5.1.m1.1.1.3.3.3.2" xref="S3.SS3.p5.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p5.1.m1.1.1.3.3.3.3" xref="S3.SS3.p5.1.m1.1.1.3.3.3.3.cmml">h</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><in id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1.1"></in><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">ℎ</ci><apply id="S3.SS3.p5.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.2">𝑅</ci><apply id="S3.SS3.p5.1.m1.1.1.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3"><times id="S3.SS3.p5.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.1"></times><cn id="S3.SS3.p5.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.p5.1.m1.1.1.3.3.2">1</cn><apply id="S3.SS3.p5.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p5.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.p5.1.m1.1.1.3.3.3.3">ℎ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">h\in R^{1\times d_{h}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">italic_h ∈ italic_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>, real-time watched sequence representation <math alttext="s\in R^{l\times d_{s}}" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><mrow id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">s</mi><mo id="S3.SS3.p5.2.m2.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml"><mi id="S3.SS3.p5.2.m2.1.1.3.2" xref="S3.SS3.p5.2.m2.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p5.2.m2.1.1.3.3" xref="S3.SS3.p5.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.p5.2.m2.1.1.3.3.2" xref="S3.SS3.p5.2.m2.1.1.3.3.2.cmml">l</mi><mo id="S3.SS3.p5.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p5.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p5.2.m2.1.1.3.3.3" xref="S3.SS3.p5.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS3.p5.2.m2.1.1.3.3.3.2" xref="S3.SS3.p5.2.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p5.2.m2.1.1.3.3.3.3" xref="S3.SS3.p5.2.m2.1.1.3.3.3.3.cmml">s</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><in id="S3.SS3.p5.2.m2.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1"></in><ci id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2">𝑠</ci><apply id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.3.1.cmml" xref="S3.SS3.p5.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.3.2.cmml" xref="S3.SS3.p5.2.m2.1.1.3.2">𝑅</ci><apply id="S3.SS3.p5.2.m2.1.1.3.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3"><times id="S3.SS3.p5.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3.1"></times><ci id="S3.SS3.p5.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3.2">𝑙</ci><apply id="S3.SS3.p5.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p5.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">s\in R^{l\times d_{s}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">italic_s ∈ italic_R start_POSTSUPERSCRIPT italic_l × italic_d start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> as input and output a vector <math alttext="o\in R^{1\times d_{o}}" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.1"><semantics id="S3.SS3.p5.3.m3.1a"><mrow id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml"><mi id="S3.SS3.p5.3.m3.1.1.2" xref="S3.SS3.p5.3.m3.1.1.2.cmml">o</mi><mo id="S3.SS3.p5.3.m3.1.1.1" xref="S3.SS3.p5.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.3.m3.1.1.3" xref="S3.SS3.p5.3.m3.1.1.3.cmml"><mi id="S3.SS3.p5.3.m3.1.1.3.2" xref="S3.SS3.p5.3.m3.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p5.3.m3.1.1.3.3" xref="S3.SS3.p5.3.m3.1.1.3.3.cmml"><mn id="S3.SS3.p5.3.m3.1.1.3.3.2" xref="S3.SS3.p5.3.m3.1.1.3.3.2.cmml">1</mn><mo id="S3.SS3.p5.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p5.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p5.3.m3.1.1.3.3.3" xref="S3.SS3.p5.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.p5.3.m3.1.1.3.3.3.2" xref="S3.SS3.p5.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p5.3.m3.1.1.3.3.3.3" xref="S3.SS3.p5.3.m3.1.1.3.3.3.3.cmml">o</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><apply id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1"><in id="S3.SS3.p5.3.m3.1.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1.1"></in><ci id="S3.SS3.p5.3.m3.1.1.2.cmml" xref="S3.SS3.p5.3.m3.1.1.2">𝑜</ci><apply id="S3.SS3.p5.3.m3.1.1.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.3.1.cmml" xref="S3.SS3.p5.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.3.2.cmml" xref="S3.SS3.p5.3.m3.1.1.3.2">𝑅</ci><apply id="S3.SS3.p5.3.m3.1.1.3.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3"><times id="S3.SS3.p5.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3.1"></times><cn id="S3.SS3.p5.3.m3.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.p5.3.m3.1.1.3.3.2">1</cn><apply id="S3.SS3.p5.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p5.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p5.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p5.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.p5.3.m3.1.1.3.3.3.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">o\in R^{1\times d_{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.1d">italic_o ∈ italic_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> to represent user’s interest. Specifically, the multi-head attention layer is computed as:</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="MultiHead(Q,K,V)=Concat(h_{1},...,h_{n})W^{O}" class="ltx_Math" display="block" id="S3.Ex1.m1.6"><semantics id="S3.Ex1.m1.6a"><mrow id="S3.Ex1.m1.6.6" xref="S3.Ex1.m1.6.6.cmml"><mrow id="S3.Ex1.m1.6.6.4" xref="S3.Ex1.m1.6.6.4.cmml"><mi id="S3.Ex1.m1.6.6.4.2" xref="S3.Ex1.m1.6.6.4.2.cmml">M</mi><mo id="S3.Ex1.m1.6.6.4.1" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.4.3" xref="S3.Ex1.m1.6.6.4.3.cmml">u</mi><mo id="S3.Ex1.m1.6.6.4.1a" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.4.4" xref="S3.Ex1.m1.6.6.4.4.cmml">l</mi><mo id="S3.Ex1.m1.6.6.4.1b" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.4.5" xref="S3.Ex1.m1.6.6.4.5.cmml">t</mi><mo id="S3.Ex1.m1.6.6.4.1c" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.4.6" xref="S3.Ex1.m1.6.6.4.6.cmml">i</mi><mo id="S3.Ex1.m1.6.6.4.1d" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.4.7" xref="S3.Ex1.m1.6.6.4.7.cmml">H</mi><mo id="S3.Ex1.m1.6.6.4.1e" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.4.8" xref="S3.Ex1.m1.6.6.4.8.cmml">e</mi><mo id="S3.Ex1.m1.6.6.4.1f" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.4.9" xref="S3.Ex1.m1.6.6.4.9.cmml">a</mi><mo id="S3.Ex1.m1.6.6.4.1g" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.4.10" xref="S3.Ex1.m1.6.6.4.10.cmml">d</mi><mo id="S3.Ex1.m1.6.6.4.1h" xref="S3.Ex1.m1.6.6.4.1.cmml">⁢</mo><mrow id="S3.Ex1.m1.6.6.4.11.2" xref="S3.Ex1.m1.6.6.4.11.1.cmml"><mo id="S3.Ex1.m1.6.6.4.11.2.1" stretchy="false" xref="S3.Ex1.m1.6.6.4.11.1.cmml">(</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">Q</mi><mo id="S3.Ex1.m1.6.6.4.11.2.2" xref="S3.Ex1.m1.6.6.4.11.1.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">K</mi><mo id="S3.Ex1.m1.6.6.4.11.2.3" xref="S3.Ex1.m1.6.6.4.11.1.cmml">,</mo><mi id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml">V</mi><mo id="S3.Ex1.m1.6.6.4.11.2.4" stretchy="false" xref="S3.Ex1.m1.6.6.4.11.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.6.6.3" xref="S3.Ex1.m1.6.6.3.cmml">=</mo><mrow id="S3.Ex1.m1.6.6.2" xref="S3.Ex1.m1.6.6.2.cmml"><mi id="S3.Ex1.m1.6.6.2.4" xref="S3.Ex1.m1.6.6.2.4.cmml">C</mi><mo id="S3.Ex1.m1.6.6.2.3" xref="S3.Ex1.m1.6.6.2.3.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.2.5" xref="S3.Ex1.m1.6.6.2.5.cmml">o</mi><mo id="S3.Ex1.m1.6.6.2.3a" xref="S3.Ex1.m1.6.6.2.3.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.2.6" xref="S3.Ex1.m1.6.6.2.6.cmml">n</mi><mo id="S3.Ex1.m1.6.6.2.3b" xref="S3.Ex1.m1.6.6.2.3.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.2.7" xref="S3.Ex1.m1.6.6.2.7.cmml">c</mi><mo id="S3.Ex1.m1.6.6.2.3c" xref="S3.Ex1.m1.6.6.2.3.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.2.8" xref="S3.Ex1.m1.6.6.2.8.cmml">a</mi><mo id="S3.Ex1.m1.6.6.2.3d" xref="S3.Ex1.m1.6.6.2.3.cmml">⁢</mo><mi id="S3.Ex1.m1.6.6.2.9" xref="S3.Ex1.m1.6.6.2.9.cmml">t</mi><mo id="S3.Ex1.m1.6.6.2.3e" xref="S3.Ex1.m1.6.6.2.3.cmml">⁢</mo><mrow id="S3.Ex1.m1.6.6.2.2.2" xref="S3.Ex1.m1.6.6.2.2.3.cmml"><mo id="S3.Ex1.m1.6.6.2.2.2.3" stretchy="false" xref="S3.Ex1.m1.6.6.2.2.3.cmml">(</mo><msub id="S3.Ex1.m1.5.5.1.1.1.1" xref="S3.Ex1.m1.5.5.1.1.1.1.cmml"><mi id="S3.Ex1.m1.5.5.1.1.1.1.2" xref="S3.Ex1.m1.5.5.1.1.1.1.2.cmml">h</mi><mn id="S3.Ex1.m1.5.5.1.1.1.1.3" xref="S3.Ex1.m1.5.5.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex1.m1.6.6.2.2.2.4" xref="S3.Ex1.m1.6.6.2.2.3.cmml">,</mo><mi id="S3.Ex1.m1.4.4" mathvariant="normal" xref="S3.Ex1.m1.4.4.cmml">…</mi><mo id="S3.Ex1.m1.6.6.2.2.2.5" xref="S3.Ex1.m1.6.6.2.2.3.cmml">,</mo><msub id="S3.Ex1.m1.6.6.2.2.2.2" xref="S3.Ex1.m1.6.6.2.2.2.2.cmml"><mi id="S3.Ex1.m1.6.6.2.2.2.2.2" xref="S3.Ex1.m1.6.6.2.2.2.2.2.cmml">h</mi><mi id="S3.Ex1.m1.6.6.2.2.2.2.3" xref="S3.Ex1.m1.6.6.2.2.2.2.3.cmml">n</mi></msub><mo id="S3.Ex1.m1.6.6.2.2.2.6" stretchy="false" xref="S3.Ex1.m1.6.6.2.2.3.cmml">)</mo></mrow><mo id="S3.Ex1.m1.6.6.2.3f" xref="S3.Ex1.m1.6.6.2.3.cmml">⁢</mo><msup id="S3.Ex1.m1.6.6.2.10" xref="S3.Ex1.m1.6.6.2.10.cmml"><mi id="S3.Ex1.m1.6.6.2.10.2" xref="S3.Ex1.m1.6.6.2.10.2.cmml">W</mi><mi id="S3.Ex1.m1.6.6.2.10.3" xref="S3.Ex1.m1.6.6.2.10.3.cmml">O</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.6b"><apply id="S3.Ex1.m1.6.6.cmml" xref="S3.Ex1.m1.6.6"><eq id="S3.Ex1.m1.6.6.3.cmml" xref="S3.Ex1.m1.6.6.3"></eq><apply id="S3.Ex1.m1.6.6.4.cmml" xref="S3.Ex1.m1.6.6.4"><times id="S3.Ex1.m1.6.6.4.1.cmml" xref="S3.Ex1.m1.6.6.4.1"></times><ci id="S3.Ex1.m1.6.6.4.2.cmml" xref="S3.Ex1.m1.6.6.4.2">𝑀</ci><ci id="S3.Ex1.m1.6.6.4.3.cmml" xref="S3.Ex1.m1.6.6.4.3">𝑢</ci><ci id="S3.Ex1.m1.6.6.4.4.cmml" xref="S3.Ex1.m1.6.6.4.4">𝑙</ci><ci id="S3.Ex1.m1.6.6.4.5.cmml" xref="S3.Ex1.m1.6.6.4.5">𝑡</ci><ci id="S3.Ex1.m1.6.6.4.6.cmml" xref="S3.Ex1.m1.6.6.4.6">𝑖</ci><ci id="S3.Ex1.m1.6.6.4.7.cmml" xref="S3.Ex1.m1.6.6.4.7">𝐻</ci><ci id="S3.Ex1.m1.6.6.4.8.cmml" xref="S3.Ex1.m1.6.6.4.8">𝑒</ci><ci id="S3.Ex1.m1.6.6.4.9.cmml" xref="S3.Ex1.m1.6.6.4.9">𝑎</ci><ci id="S3.Ex1.m1.6.6.4.10.cmml" xref="S3.Ex1.m1.6.6.4.10">𝑑</ci><vector id="S3.Ex1.m1.6.6.4.11.1.cmml" xref="S3.Ex1.m1.6.6.4.11.2"><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝑄</ci><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝐾</ci><ci id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3">𝑉</ci></vector></apply><apply id="S3.Ex1.m1.6.6.2.cmml" xref="S3.Ex1.m1.6.6.2"><times id="S3.Ex1.m1.6.6.2.3.cmml" xref="S3.Ex1.m1.6.6.2.3"></times><ci id="S3.Ex1.m1.6.6.2.4.cmml" xref="S3.Ex1.m1.6.6.2.4">𝐶</ci><ci id="S3.Ex1.m1.6.6.2.5.cmml" xref="S3.Ex1.m1.6.6.2.5">𝑜</ci><ci id="S3.Ex1.m1.6.6.2.6.cmml" xref="S3.Ex1.m1.6.6.2.6">𝑛</ci><ci id="S3.Ex1.m1.6.6.2.7.cmml" xref="S3.Ex1.m1.6.6.2.7">𝑐</ci><ci id="S3.Ex1.m1.6.6.2.8.cmml" xref="S3.Ex1.m1.6.6.2.8">𝑎</ci><ci id="S3.Ex1.m1.6.6.2.9.cmml" xref="S3.Ex1.m1.6.6.2.9">𝑡</ci><vector id="S3.Ex1.m1.6.6.2.2.3.cmml" xref="S3.Ex1.m1.6.6.2.2.2"><apply id="S3.Ex1.m1.5.5.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.1.1.1.1.1.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.5.5.1.1.1.1.2.cmml" xref="S3.Ex1.m1.5.5.1.1.1.1.2">ℎ</ci><cn id="S3.Ex1.m1.5.5.1.1.1.1.3.cmml" type="integer" xref="S3.Ex1.m1.5.5.1.1.1.1.3">1</cn></apply><ci id="S3.Ex1.m1.4.4.cmml" xref="S3.Ex1.m1.4.4">…</ci><apply id="S3.Ex1.m1.6.6.2.2.2.2.cmml" xref="S3.Ex1.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.2.2.2.2.1.cmml" xref="S3.Ex1.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.6.6.2.2.2.2.2.cmml" xref="S3.Ex1.m1.6.6.2.2.2.2.2">ℎ</ci><ci id="S3.Ex1.m1.6.6.2.2.2.2.3.cmml" xref="S3.Ex1.m1.6.6.2.2.2.2.3">𝑛</ci></apply></vector><apply id="S3.Ex1.m1.6.6.2.10.cmml" xref="S3.Ex1.m1.6.6.2.10"><csymbol cd="ambiguous" id="S3.Ex1.m1.6.6.2.10.1.cmml" xref="S3.Ex1.m1.6.6.2.10">superscript</csymbol><ci id="S3.Ex1.m1.6.6.2.10.2.cmml" xref="S3.Ex1.m1.6.6.2.10.2">𝑊</ci><ci id="S3.Ex1.m1.6.6.2.10.3.cmml" xref="S3.Ex1.m1.6.6.2.10.3">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.6c">MultiHead(Q,K,V)=Concat(h_{1},...,h_{n})W^{O}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.6d">italic_M italic_u italic_l italic_t italic_i italic_H italic_e italic_a italic_d ( italic_Q , italic_K , italic_V ) = italic_C italic_o italic_n italic_c italic_a italic_t ( italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_h start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<p class="ltx_p" id="S3.SS3.p7.2">where <math alttext="h_{i}\in R^{1\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.1"><semantics id="S3.SS3.p7.1.m1.1a"><mrow id="S3.SS3.p7.1.m1.1.1" xref="S3.SS3.p7.1.m1.1.1.cmml"><msub id="S3.SS3.p7.1.m1.1.1.2" xref="S3.SS3.p7.1.m1.1.1.2.cmml"><mi id="S3.SS3.p7.1.m1.1.1.2.2" xref="S3.SS3.p7.1.m1.1.1.2.2.cmml">h</mi><mi id="S3.SS3.p7.1.m1.1.1.2.3" xref="S3.SS3.p7.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.p7.1.m1.1.1.1" xref="S3.SS3.p7.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p7.1.m1.1.1.3" xref="S3.SS3.p7.1.m1.1.1.3.cmml"><mi id="S3.SS3.p7.1.m1.1.1.3.2" xref="S3.SS3.p7.1.m1.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p7.1.m1.1.1.3.3" xref="S3.SS3.p7.1.m1.1.1.3.3.cmml"><mn id="S3.SS3.p7.1.m1.1.1.3.3.2" xref="S3.SS3.p7.1.m1.1.1.3.3.2.cmml">1</mn><mo id="S3.SS3.p7.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p7.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p7.1.m1.1.1.3.3.3" xref="S3.SS3.p7.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS3.p7.1.m1.1.1.3.3.3.2" xref="S3.SS3.p7.1.m1.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p7.1.m1.1.1.3.3.3.3" xref="S3.SS3.p7.1.m1.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.1b"><apply id="S3.SS3.p7.1.m1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1"><in id="S3.SS3.p7.1.m1.1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1.1"></in><apply id="S3.SS3.p7.1.m1.1.1.2.cmml" xref="S3.SS3.p7.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.1.1.2.1.cmml" xref="S3.SS3.p7.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p7.1.m1.1.1.2.2.cmml" xref="S3.SS3.p7.1.m1.1.1.2.2">ℎ</ci><ci id="S3.SS3.p7.1.m1.1.1.2.3.cmml" xref="S3.SS3.p7.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p7.1.m1.1.1.3.cmml" xref="S3.SS3.p7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.1.1.3.1.cmml" xref="S3.SS3.p7.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p7.1.m1.1.1.3.2.cmml" xref="S3.SS3.p7.1.m1.1.1.3.2">𝑅</ci><apply id="S3.SS3.p7.1.m1.1.1.3.3.cmml" xref="S3.SS3.p7.1.m1.1.1.3.3"><times id="S3.SS3.p7.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p7.1.m1.1.1.3.3.1"></times><cn id="S3.SS3.p7.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.p7.1.m1.1.1.3.3.2">1</cn><apply id="S3.SS3.p7.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p7.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS3.p7.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p7.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS3.p7.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p7.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS3.p7.1.m1.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.1c">h_{i}\in R^{1\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the output of a single head, <math alttext="W^{O}\in R^{n\textperiodcentered d_{v}\times d_{o}}" class="ltx_Math" display="inline" id="S3.SS3.p7.2.m2.1"><semantics id="S3.SS3.p7.2.m2.1a"><mrow id="S3.SS3.p7.2.m2.1.1" xref="S3.SS3.p7.2.m2.1.1.cmml"><msup id="S3.SS3.p7.2.m2.1.1.2" xref="S3.SS3.p7.2.m2.1.1.2.cmml"><mi id="S3.SS3.p7.2.m2.1.1.2.2" xref="S3.SS3.p7.2.m2.1.1.2.2.cmml">W</mi><mi id="S3.SS3.p7.2.m2.1.1.2.3" xref="S3.SS3.p7.2.m2.1.1.2.3.cmml">O</mi></msup><mo id="S3.SS3.p7.2.m2.1.1.1" xref="S3.SS3.p7.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p7.2.m2.1.1.3" xref="S3.SS3.p7.2.m2.1.1.3.cmml"><mi id="S3.SS3.p7.2.m2.1.1.3.2" xref="S3.SS3.p7.2.m2.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p7.2.m2.1.1.3.3" xref="S3.SS3.p7.2.m2.1.1.3.3.cmml"><mrow id="S3.SS3.p7.2.m2.1.1.3.3.2" xref="S3.SS3.p7.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS3.p7.2.m2.1.1.3.3.2.2" xref="S3.SS3.p7.2.m2.1.1.3.3.2.2.cmml">n</mi><mo id="S3.SS3.p7.2.m2.1.1.3.3.2.1" xref="S3.SS3.p7.2.m2.1.1.3.3.2.1.cmml">⁢</mo><mi id="S3.SS3.p7.2.m2.1.1.3.3.2.3" mathvariant="normal" xref="S3.SS3.p7.2.m2.1.1.3.3.2.3.cmml">·</mi><mo id="S3.SS3.p7.2.m2.1.1.3.3.2.1a" xref="S3.SS3.p7.2.m2.1.1.3.3.2.1.cmml">⁢</mo><msub id="S3.SS3.p7.2.m2.1.1.3.3.2.4" xref="S3.SS3.p7.2.m2.1.1.3.3.2.4.cmml"><mi id="S3.SS3.p7.2.m2.1.1.3.3.2.4.2" xref="S3.SS3.p7.2.m2.1.1.3.3.2.4.2.cmml">d</mi><mi id="S3.SS3.p7.2.m2.1.1.3.3.2.4.3" xref="S3.SS3.p7.2.m2.1.1.3.3.2.4.3.cmml">v</mi></msub></mrow><mo id="S3.SS3.p7.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p7.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p7.2.m2.1.1.3.3.3" xref="S3.SS3.p7.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS3.p7.2.m2.1.1.3.3.3.2" xref="S3.SS3.p7.2.m2.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p7.2.m2.1.1.3.3.3.3" xref="S3.SS3.p7.2.m2.1.1.3.3.3.3.cmml">o</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.2.m2.1b"><apply id="S3.SS3.p7.2.m2.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1"><in id="S3.SS3.p7.2.m2.1.1.1.cmml" xref="S3.SS3.p7.2.m2.1.1.1"></in><apply id="S3.SS3.p7.2.m2.1.1.2.cmml" xref="S3.SS3.p7.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.1.2.1.cmml" xref="S3.SS3.p7.2.m2.1.1.2">superscript</csymbol><ci id="S3.SS3.p7.2.m2.1.1.2.2.cmml" xref="S3.SS3.p7.2.m2.1.1.2.2">𝑊</ci><ci id="S3.SS3.p7.2.m2.1.1.2.3.cmml" xref="S3.SS3.p7.2.m2.1.1.2.3">𝑂</ci></apply><apply id="S3.SS3.p7.2.m2.1.1.3.cmml" xref="S3.SS3.p7.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.1.3.1.cmml" xref="S3.SS3.p7.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p7.2.m2.1.1.3.2.cmml" xref="S3.SS3.p7.2.m2.1.1.3.2">𝑅</ci><apply id="S3.SS3.p7.2.m2.1.1.3.3.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3"><times id="S3.SS3.p7.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.1"></times><apply id="S3.SS3.p7.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.2"><times id="S3.SS3.p7.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.2.1"></times><ci id="S3.SS3.p7.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.2.2">𝑛</ci><ci id="S3.SS3.p7.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.2.3">·</ci><apply id="S3.SS3.p7.2.m2.1.1.3.3.2.4.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.2.4"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.1.3.3.2.4.1.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.2.4">subscript</csymbol><ci id="S3.SS3.p7.2.m2.1.1.3.3.2.4.2.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.2.4.2">𝑑</ci><ci id="S3.SS3.p7.2.m2.1.1.3.3.2.4.3.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.2.4.3">𝑣</ci></apply></apply><apply id="S3.SS3.p7.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p7.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p7.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p7.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS3.p7.2.m2.1.1.3.3.3.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.2.m2.1c">W^{O}\in R^{n\textperiodcentered d_{v}\times d_{o}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.2.m2.1d">italic_W start_POSTSUPERSCRIPT italic_O end_POSTSUPERSCRIPT ∈ italic_R start_POSTSUPERSCRIPT italic_n · italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the projection parameter matrix.</p>
</div>
<div class="ltx_para" id="S3.SS3.p8">
<p class="ltx_p" id="S3.SS3.p8.1">We compute each <math alttext="h_{i}" class="ltx_Math" display="inline" id="S3.SS3.p8.1.m1.1"><semantics id="S3.SS3.p8.1.m1.1a"><msub id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml"><mi id="S3.SS3.p8.1.m1.1.1.2" xref="S3.SS3.p8.1.m1.1.1.2.cmml">h</mi><mi id="S3.SS3.p8.1.m1.1.1.3" xref="S3.SS3.p8.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><apply id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.2.cmml" xref="S3.SS3.p8.1.m1.1.1.2">ℎ</ci><ci id="S3.SS3.p8.1.m1.1.1.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">h_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with a scaled dot product attention, the equation as:</p>
</div>
<div class="ltx_para" id="S3.SS3.p9">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Attention(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{d_{k}}})V" class="ltx_Math" display="block" id="S3.Ex2.m1.4"><semantics id="S3.Ex2.m1.4a"><mrow id="S3.Ex2.m1.4.5" xref="S3.Ex2.m1.4.5.cmml"><mrow id="S3.Ex2.m1.4.5.2" xref="S3.Ex2.m1.4.5.2.cmml"><mi id="S3.Ex2.m1.4.5.2.2" xref="S3.Ex2.m1.4.5.2.2.cmml">A</mi><mo id="S3.Ex2.m1.4.5.2.1" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.2.3" xref="S3.Ex2.m1.4.5.2.3.cmml">t</mi><mo id="S3.Ex2.m1.4.5.2.1a" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.2.4" xref="S3.Ex2.m1.4.5.2.4.cmml">t</mi><mo id="S3.Ex2.m1.4.5.2.1b" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.2.5" xref="S3.Ex2.m1.4.5.2.5.cmml">e</mi><mo id="S3.Ex2.m1.4.5.2.1c" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.2.6" xref="S3.Ex2.m1.4.5.2.6.cmml">n</mi><mo id="S3.Ex2.m1.4.5.2.1d" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.2.7" xref="S3.Ex2.m1.4.5.2.7.cmml">t</mi><mo id="S3.Ex2.m1.4.5.2.1e" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.2.8" xref="S3.Ex2.m1.4.5.2.8.cmml">i</mi><mo id="S3.Ex2.m1.4.5.2.1f" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.2.9" xref="S3.Ex2.m1.4.5.2.9.cmml">o</mi><mo id="S3.Ex2.m1.4.5.2.1g" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.2.10" xref="S3.Ex2.m1.4.5.2.10.cmml">n</mi><mo id="S3.Ex2.m1.4.5.2.1h" xref="S3.Ex2.m1.4.5.2.1.cmml">⁢</mo><mrow id="S3.Ex2.m1.4.5.2.11.2" xref="S3.Ex2.m1.4.5.2.11.1.cmml"><mo id="S3.Ex2.m1.4.5.2.11.2.1" stretchy="false" xref="S3.Ex2.m1.4.5.2.11.1.cmml">(</mo><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">Q</mi><mo id="S3.Ex2.m1.4.5.2.11.2.2" xref="S3.Ex2.m1.4.5.2.11.1.cmml">,</mo><mi id="S3.Ex2.m1.2.2" xref="S3.Ex2.m1.2.2.cmml">K</mi><mo id="S3.Ex2.m1.4.5.2.11.2.3" xref="S3.Ex2.m1.4.5.2.11.1.cmml">,</mo><mi id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml">V</mi><mo id="S3.Ex2.m1.4.5.2.11.2.4" stretchy="false" xref="S3.Ex2.m1.4.5.2.11.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.4.5.1" xref="S3.Ex2.m1.4.5.1.cmml">=</mo><mrow id="S3.Ex2.m1.4.5.3" xref="S3.Ex2.m1.4.5.3.cmml"><mi id="S3.Ex2.m1.4.5.3.2" xref="S3.Ex2.m1.4.5.3.2.cmml">s</mi><mo id="S3.Ex2.m1.4.5.3.1" xref="S3.Ex2.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.3.3" xref="S3.Ex2.m1.4.5.3.3.cmml">o</mi><mo id="S3.Ex2.m1.4.5.3.1a" xref="S3.Ex2.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.3.4" xref="S3.Ex2.m1.4.5.3.4.cmml">f</mi><mo id="S3.Ex2.m1.4.5.3.1b" xref="S3.Ex2.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.3.5" xref="S3.Ex2.m1.4.5.3.5.cmml">t</mi><mo id="S3.Ex2.m1.4.5.3.1c" xref="S3.Ex2.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.3.6" xref="S3.Ex2.m1.4.5.3.6.cmml">m</mi><mo id="S3.Ex2.m1.4.5.3.1d" xref="S3.Ex2.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.3.7" xref="S3.Ex2.m1.4.5.3.7.cmml">a</mi><mo id="S3.Ex2.m1.4.5.3.1e" xref="S3.Ex2.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.3.8" xref="S3.Ex2.m1.4.5.3.8.cmml">x</mi><mo id="S3.Ex2.m1.4.5.3.1f" xref="S3.Ex2.m1.4.5.3.1.cmml">⁢</mo><mrow id="S3.Ex2.m1.4.5.3.9.2" xref="S3.Ex2.m1.4.4.cmml"><mo id="S3.Ex2.m1.4.5.3.9.2.1" stretchy="false" xref="S3.Ex2.m1.4.4.cmml">(</mo><mfrac id="S3.Ex2.m1.4.4" xref="S3.Ex2.m1.4.4.cmml"><mrow id="S3.Ex2.m1.4.4.2" xref="S3.Ex2.m1.4.4.2.cmml"><mi id="S3.Ex2.m1.4.4.2.2" xref="S3.Ex2.m1.4.4.2.2.cmml">Q</mi><mo id="S3.Ex2.m1.4.4.2.1" xref="S3.Ex2.m1.4.4.2.1.cmml">⁢</mo><msup id="S3.Ex2.m1.4.4.2.3" xref="S3.Ex2.m1.4.4.2.3.cmml"><mi id="S3.Ex2.m1.4.4.2.3.2" xref="S3.Ex2.m1.4.4.2.3.2.cmml">K</mi><mi id="S3.Ex2.m1.4.4.2.3.3" xref="S3.Ex2.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.Ex2.m1.4.4.3" xref="S3.Ex2.m1.4.4.3.cmml"><msub id="S3.Ex2.m1.4.4.3.2" xref="S3.Ex2.m1.4.4.3.2.cmml"><mi id="S3.Ex2.m1.4.4.3.2.2" xref="S3.Ex2.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.Ex2.m1.4.4.3.2.3" xref="S3.Ex2.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S3.Ex2.m1.4.5.3.9.2.2" stretchy="false" xref="S3.Ex2.m1.4.4.cmml">)</mo></mrow><mo id="S3.Ex2.m1.4.5.3.1g" xref="S3.Ex2.m1.4.5.3.1.cmml">⁢</mo><mi id="S3.Ex2.m1.4.5.3.10" xref="S3.Ex2.m1.4.5.3.10.cmml">V</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.4b"><apply id="S3.Ex2.m1.4.5.cmml" xref="S3.Ex2.m1.4.5"><eq id="S3.Ex2.m1.4.5.1.cmml" xref="S3.Ex2.m1.4.5.1"></eq><apply id="S3.Ex2.m1.4.5.2.cmml" xref="S3.Ex2.m1.4.5.2"><times id="S3.Ex2.m1.4.5.2.1.cmml" xref="S3.Ex2.m1.4.5.2.1"></times><ci id="S3.Ex2.m1.4.5.2.2.cmml" xref="S3.Ex2.m1.4.5.2.2">𝐴</ci><ci id="S3.Ex2.m1.4.5.2.3.cmml" xref="S3.Ex2.m1.4.5.2.3">𝑡</ci><ci id="S3.Ex2.m1.4.5.2.4.cmml" xref="S3.Ex2.m1.4.5.2.4">𝑡</ci><ci id="S3.Ex2.m1.4.5.2.5.cmml" xref="S3.Ex2.m1.4.5.2.5">𝑒</ci><ci id="S3.Ex2.m1.4.5.2.6.cmml" xref="S3.Ex2.m1.4.5.2.6">𝑛</ci><ci id="S3.Ex2.m1.4.5.2.7.cmml" xref="S3.Ex2.m1.4.5.2.7">𝑡</ci><ci id="S3.Ex2.m1.4.5.2.8.cmml" xref="S3.Ex2.m1.4.5.2.8">𝑖</ci><ci id="S3.Ex2.m1.4.5.2.9.cmml" xref="S3.Ex2.m1.4.5.2.9">𝑜</ci><ci id="S3.Ex2.m1.4.5.2.10.cmml" xref="S3.Ex2.m1.4.5.2.10">𝑛</ci><vector id="S3.Ex2.m1.4.5.2.11.1.cmml" xref="S3.Ex2.m1.4.5.2.11.2"><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝑄</ci><ci id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2">𝐾</ci><ci id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3">𝑉</ci></vector></apply><apply id="S3.Ex2.m1.4.5.3.cmml" xref="S3.Ex2.m1.4.5.3"><times id="S3.Ex2.m1.4.5.3.1.cmml" xref="S3.Ex2.m1.4.5.3.1"></times><ci id="S3.Ex2.m1.4.5.3.2.cmml" xref="S3.Ex2.m1.4.5.3.2">𝑠</ci><ci id="S3.Ex2.m1.4.5.3.3.cmml" xref="S3.Ex2.m1.4.5.3.3">𝑜</ci><ci id="S3.Ex2.m1.4.5.3.4.cmml" xref="S3.Ex2.m1.4.5.3.4">𝑓</ci><ci id="S3.Ex2.m1.4.5.3.5.cmml" xref="S3.Ex2.m1.4.5.3.5">𝑡</ci><ci id="S3.Ex2.m1.4.5.3.6.cmml" xref="S3.Ex2.m1.4.5.3.6">𝑚</ci><ci id="S3.Ex2.m1.4.5.3.7.cmml" xref="S3.Ex2.m1.4.5.3.7">𝑎</ci><ci id="S3.Ex2.m1.4.5.3.8.cmml" xref="S3.Ex2.m1.4.5.3.8">𝑥</ci><apply id="S3.Ex2.m1.4.4.cmml" xref="S3.Ex2.m1.4.5.3.9.2"><divide id="S3.Ex2.m1.4.4.1.cmml" xref="S3.Ex2.m1.4.5.3.9.2"></divide><apply id="S3.Ex2.m1.4.4.2.cmml" xref="S3.Ex2.m1.4.4.2"><times id="S3.Ex2.m1.4.4.2.1.cmml" xref="S3.Ex2.m1.4.4.2.1"></times><ci id="S3.Ex2.m1.4.4.2.2.cmml" xref="S3.Ex2.m1.4.4.2.2">𝑄</ci><apply id="S3.Ex2.m1.4.4.2.3.cmml" xref="S3.Ex2.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.4.4.2.3.1.cmml" xref="S3.Ex2.m1.4.4.2.3">superscript</csymbol><ci id="S3.Ex2.m1.4.4.2.3.2.cmml" xref="S3.Ex2.m1.4.4.2.3.2">𝐾</ci><ci id="S3.Ex2.m1.4.4.2.3.3.cmml" xref="S3.Ex2.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S3.Ex2.m1.4.4.3.cmml" xref="S3.Ex2.m1.4.4.3"><root id="S3.Ex2.m1.4.4.3a.cmml" xref="S3.Ex2.m1.4.4.3"></root><apply id="S3.Ex2.m1.4.4.3.2.cmml" xref="S3.Ex2.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.4.4.3.2.1.cmml" xref="S3.Ex2.m1.4.4.3.2">subscript</csymbol><ci id="S3.Ex2.m1.4.4.3.2.2.cmml" xref="S3.Ex2.m1.4.4.3.2.2">𝑑</ci><ci id="S3.Ex2.m1.4.4.3.2.3.cmml" xref="S3.Ex2.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply><ci id="S3.Ex2.m1.4.5.3.10.cmml" xref="S3.Ex2.m1.4.5.3.10">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.4c">Attention(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{d_{k}}})V</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.4d">italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ( italic_Q , italic_K , italic_V ) = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( divide start_ARG italic_Q italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) italic_V</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p10">
<p class="ltx_p" id="S3.SS3.p10.5">where <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS3.p10.1.m1.1"><semantics id="S3.SS3.p10.1.m1.1a"><mi id="S3.SS3.p10.1.m1.1.1" xref="S3.SS3.p10.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p10.1.m1.1b"><ci id="S3.SS3.p10.1.m1.1.1.cmml" xref="S3.SS3.p10.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p10.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p10.1.m1.1d">italic_Q</annotation></semantics></math> is projected from target video representation <math alttext="h" class="ltx_Math" display="inline" id="S3.SS3.p10.2.m2.1"><semantics id="S3.SS3.p10.2.m2.1a"><mi id="S3.SS3.p10.2.m2.1.1" xref="S3.SS3.p10.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p10.2.m2.1b"><ci id="S3.SS3.p10.2.m2.1.1.cmml" xref="S3.SS3.p10.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p10.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p10.2.m2.1d">italic_h</annotation></semantics></math>, <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.p10.3.m3.1"><semantics id="S3.SS3.p10.3.m3.1a"><mi id="S3.SS3.p10.3.m3.1.1" xref="S3.SS3.p10.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p10.3.m3.1b"><ci id="S3.SS3.p10.3.m3.1.1.cmml" xref="S3.SS3.p10.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p10.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p10.3.m3.1d">italic_K</annotation></semantics></math> and <math alttext="V" class="ltx_Math" display="inline" id="S3.SS3.p10.4.m4.1"><semantics id="S3.SS3.p10.4.m4.1a"><mi id="S3.SS3.p10.4.m4.1.1" xref="S3.SS3.p10.4.m4.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p10.4.m4.1b"><ci id="S3.SS3.p10.4.m4.1.1.cmml" xref="S3.SS3.p10.4.m4.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p10.4.m4.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p10.4.m4.1d">italic_V</annotation></semantics></math> is projected from sequence representation <math alttext="s" class="ltx_Math" display="inline" id="S3.SS3.p10.5.m5.1"><semantics id="S3.SS3.p10.5.m5.1a"><mi id="S3.SS3.p10.5.m5.1.1" xref="S3.SS3.p10.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p10.5.m5.1b"><ci id="S3.SS3.p10.5.m5.1.1.cmml" xref="S3.SS3.p10.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p10.5.m5.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p10.5.m5.1d">italic_s</annotation></semantics></math> respectively.</p>
</div>
<div class="ltx_para" id="S3.SS3.p11">
<p class="ltx_p" id="S3.SS3.p11.4">Then we compute the contextual representations <math alttext="o" class="ltx_Math" display="inline" id="S3.SS3.p11.1.m1.1"><semantics id="S3.SS3.p11.1.m1.1a"><mi id="S3.SS3.p11.1.m1.1.1" xref="S3.SS3.p11.1.m1.1.1.cmml">o</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p11.1.m1.1b"><ci id="S3.SS3.p11.1.m1.1.1.cmml" xref="S3.SS3.p11.1.m1.1.1">𝑜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p11.1.m1.1c">o</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p11.1.m1.1d">italic_o</annotation></semantics></math> as <math alttext="o=ew_{o}^{T}" class="ltx_Math" display="inline" id="S3.SS3.p11.2.m2.1"><semantics id="S3.SS3.p11.2.m2.1a"><mrow id="S3.SS3.p11.2.m2.1.1" xref="S3.SS3.p11.2.m2.1.1.cmml"><mi id="S3.SS3.p11.2.m2.1.1.2" xref="S3.SS3.p11.2.m2.1.1.2.cmml">o</mi><mo id="S3.SS3.p11.2.m2.1.1.1" xref="S3.SS3.p11.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS3.p11.2.m2.1.1.3" xref="S3.SS3.p11.2.m2.1.1.3.cmml"><mi id="S3.SS3.p11.2.m2.1.1.3.2" xref="S3.SS3.p11.2.m2.1.1.3.2.cmml">e</mi><mo id="S3.SS3.p11.2.m2.1.1.3.1" xref="S3.SS3.p11.2.m2.1.1.3.1.cmml">⁢</mo><msubsup id="S3.SS3.p11.2.m2.1.1.3.3" xref="S3.SS3.p11.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.p11.2.m2.1.1.3.3.2.2" xref="S3.SS3.p11.2.m2.1.1.3.3.2.2.cmml">w</mi><mi id="S3.SS3.p11.2.m2.1.1.3.3.2.3" xref="S3.SS3.p11.2.m2.1.1.3.3.2.3.cmml">o</mi><mi id="S3.SS3.p11.2.m2.1.1.3.3.3" xref="S3.SS3.p11.2.m2.1.1.3.3.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p11.2.m2.1b"><apply id="S3.SS3.p11.2.m2.1.1.cmml" xref="S3.SS3.p11.2.m2.1.1"><eq id="S3.SS3.p11.2.m2.1.1.1.cmml" xref="S3.SS3.p11.2.m2.1.1.1"></eq><ci id="S3.SS3.p11.2.m2.1.1.2.cmml" xref="S3.SS3.p11.2.m2.1.1.2">𝑜</ci><apply id="S3.SS3.p11.2.m2.1.1.3.cmml" xref="S3.SS3.p11.2.m2.1.1.3"><times id="S3.SS3.p11.2.m2.1.1.3.1.cmml" xref="S3.SS3.p11.2.m2.1.1.3.1"></times><ci id="S3.SS3.p11.2.m2.1.1.3.2.cmml" xref="S3.SS3.p11.2.m2.1.1.3.2">𝑒</ci><apply id="S3.SS3.p11.2.m2.1.1.3.3.cmml" xref="S3.SS3.p11.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p11.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p11.2.m2.1.1.3.3">superscript</csymbol><apply id="S3.SS3.p11.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p11.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p11.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS3.p11.2.m2.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p11.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS3.p11.2.m2.1.1.3.3.2.2">𝑤</ci><ci id="S3.SS3.p11.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS3.p11.2.m2.1.1.3.3.2.3">𝑜</ci></apply><ci id="S3.SS3.p11.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p11.2.m2.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p11.2.m2.1c">o=ew_{o}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p11.2.m2.1d">italic_o = italic_e italic_w start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="e\in R^{1\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS3.p11.3.m3.1"><semantics id="S3.SS3.p11.3.m3.1a"><mrow id="S3.SS3.p11.3.m3.1.1" xref="S3.SS3.p11.3.m3.1.1.cmml"><mi id="S3.SS3.p11.3.m3.1.1.2" xref="S3.SS3.p11.3.m3.1.1.2.cmml">e</mi><mo id="S3.SS3.p11.3.m3.1.1.1" xref="S3.SS3.p11.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p11.3.m3.1.1.3" xref="S3.SS3.p11.3.m3.1.1.3.cmml"><mi id="S3.SS3.p11.3.m3.1.1.3.2" xref="S3.SS3.p11.3.m3.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p11.3.m3.1.1.3.3" xref="S3.SS3.p11.3.m3.1.1.3.3.cmml"><mn id="S3.SS3.p11.3.m3.1.1.3.3.2" xref="S3.SS3.p11.3.m3.1.1.3.3.2.cmml">1</mn><mo id="S3.SS3.p11.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p11.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p11.3.m3.1.1.3.3.3" xref="S3.SS3.p11.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS3.p11.3.m3.1.1.3.3.3.2" xref="S3.SS3.p11.3.m3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p11.3.m3.1.1.3.3.3.3" xref="S3.SS3.p11.3.m3.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p11.3.m3.1b"><apply id="S3.SS3.p11.3.m3.1.1.cmml" xref="S3.SS3.p11.3.m3.1.1"><in id="S3.SS3.p11.3.m3.1.1.1.cmml" xref="S3.SS3.p11.3.m3.1.1.1"></in><ci id="S3.SS3.p11.3.m3.1.1.2.cmml" xref="S3.SS3.p11.3.m3.1.1.2">𝑒</ci><apply id="S3.SS3.p11.3.m3.1.1.3.cmml" xref="S3.SS3.p11.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p11.3.m3.1.1.3.1.cmml" xref="S3.SS3.p11.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p11.3.m3.1.1.3.2.cmml" xref="S3.SS3.p11.3.m3.1.1.3.2">𝑅</ci><apply id="S3.SS3.p11.3.m3.1.1.3.3.cmml" xref="S3.SS3.p11.3.m3.1.1.3.3"><times id="S3.SS3.p11.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p11.3.m3.1.1.3.3.1"></times><cn id="S3.SS3.p11.3.m3.1.1.3.3.2.cmml" type="integer" xref="S3.SS3.p11.3.m3.1.1.3.3.2">1</cn><apply id="S3.SS3.p11.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p11.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p11.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS3.p11.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p11.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS3.p11.3.m3.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p11.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS3.p11.3.m3.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p11.3.m3.1c">e\in R^{1\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p11.3.m3.1d">italic_e ∈ italic_R start_POSTSUPERSCRIPT 1 × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the concatenation of multi-head representation, <math alttext="w_{o}\in R^{d_{o}\times d_{v}}" class="ltx_Math" display="inline" id="S3.SS3.p11.4.m4.1"><semantics id="S3.SS3.p11.4.m4.1a"><mrow id="S3.SS3.p11.4.m4.1.1" xref="S3.SS3.p11.4.m4.1.1.cmml"><msub id="S3.SS3.p11.4.m4.1.1.2" xref="S3.SS3.p11.4.m4.1.1.2.cmml"><mi id="S3.SS3.p11.4.m4.1.1.2.2" xref="S3.SS3.p11.4.m4.1.1.2.2.cmml">w</mi><mi id="S3.SS3.p11.4.m4.1.1.2.3" xref="S3.SS3.p11.4.m4.1.1.2.3.cmml">o</mi></msub><mo id="S3.SS3.p11.4.m4.1.1.1" xref="S3.SS3.p11.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p11.4.m4.1.1.3" xref="S3.SS3.p11.4.m4.1.1.3.cmml"><mi id="S3.SS3.p11.4.m4.1.1.3.2" xref="S3.SS3.p11.4.m4.1.1.3.2.cmml">R</mi><mrow id="S3.SS3.p11.4.m4.1.1.3.3" xref="S3.SS3.p11.4.m4.1.1.3.3.cmml"><msub id="S3.SS3.p11.4.m4.1.1.3.3.2" xref="S3.SS3.p11.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS3.p11.4.m4.1.1.3.3.2.2" xref="S3.SS3.p11.4.m4.1.1.3.3.2.2.cmml">d</mi><mi id="S3.SS3.p11.4.m4.1.1.3.3.2.3" xref="S3.SS3.p11.4.m4.1.1.3.3.2.3.cmml">o</mi></msub><mo id="S3.SS3.p11.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p11.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS3.p11.4.m4.1.1.3.3.3" xref="S3.SS3.p11.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS3.p11.4.m4.1.1.3.3.3.2" xref="S3.SS3.p11.4.m4.1.1.3.3.3.2.cmml">d</mi><mi id="S3.SS3.p11.4.m4.1.1.3.3.3.3" xref="S3.SS3.p11.4.m4.1.1.3.3.3.3.cmml">v</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p11.4.m4.1b"><apply id="S3.SS3.p11.4.m4.1.1.cmml" xref="S3.SS3.p11.4.m4.1.1"><in id="S3.SS3.p11.4.m4.1.1.1.cmml" xref="S3.SS3.p11.4.m4.1.1.1"></in><apply id="S3.SS3.p11.4.m4.1.1.2.cmml" xref="S3.SS3.p11.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p11.4.m4.1.1.2.1.cmml" xref="S3.SS3.p11.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS3.p11.4.m4.1.1.2.2.cmml" xref="S3.SS3.p11.4.m4.1.1.2.2">𝑤</ci><ci id="S3.SS3.p11.4.m4.1.1.2.3.cmml" xref="S3.SS3.p11.4.m4.1.1.2.3">𝑜</ci></apply><apply id="S3.SS3.p11.4.m4.1.1.3.cmml" xref="S3.SS3.p11.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p11.4.m4.1.1.3.1.cmml" xref="S3.SS3.p11.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p11.4.m4.1.1.3.2.cmml" xref="S3.SS3.p11.4.m4.1.1.3.2">𝑅</ci><apply id="S3.SS3.p11.4.m4.1.1.3.3.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3"><times id="S3.SS3.p11.4.m4.1.1.3.3.1.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.1"></times><apply id="S3.SS3.p11.4.m4.1.1.3.3.2.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS3.p11.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS3.p11.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS3.p11.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.2.3">𝑜</ci></apply><apply id="S3.SS3.p11.4.m4.1.1.3.3.3.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p11.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS3.p11.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS3.p11.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS3.p11.4.m4.1.1.3.3.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p11.4.m4.1c">w_{o}\in R^{d_{o}\times d_{v}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p11.4.m4.1d">italic_w start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ∈ italic_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is the projection matrix of output.</p>
</div>
<div class="ltx_para" id="S3.SS3.p12">
<p class="ltx_p" id="S3.SS3.p12.1"><span class="ltx_text ltx_font_bold" id="S3.SS3.p12.1.1">MMoE.</span> We utilize a multi-gate mixture-of-experts <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib17" title="">2018</a>)</cite> layer to incorporate various user feedbacks and model the correlation between different objectives. Each expert pays attention to specific kind of important features, and the fusing information in mixture-of-experts was combined through different gating networks for each task. Finally, the prediction of task <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p12.1.m1.1"><semantics id="S3.SS3.p12.1.m1.1a"><mi id="S3.SS3.p12.1.m1.1.1" xref="S3.SS3.p12.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p12.1.m1.1b"><ci id="S3.SS3.p12.1.m1.1.1.cmml" xref="S3.SS3.p12.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p12.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p12.1.m1.1d">italic_i</annotation></semantics></math> is:</p>
</div>
<div class="ltx_para" id="S3.SS3.p13">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="pxtr_{i}=sigmoid_{i}(MLP_{i}(x_{gate_{i}}))" class="ltx_Math" display="block" id="S3.Ex3.m1.1"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><mrow id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml"><mi id="S3.Ex3.m1.1.1.3.2" xref="S3.Ex3.m1.1.1.3.2.cmml">p</mi><mo id="S3.Ex3.m1.1.1.3.1" xref="S3.Ex3.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.3.3" xref="S3.Ex3.m1.1.1.3.3.cmml">x</mi><mo id="S3.Ex3.m1.1.1.3.1a" xref="S3.Ex3.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.3.4" xref="S3.Ex3.m1.1.1.3.4.cmml">t</mi><mo id="S3.Ex3.m1.1.1.3.1b" xref="S3.Ex3.m1.1.1.3.1.cmml">⁢</mo><msub id="S3.Ex3.m1.1.1.3.5" xref="S3.Ex3.m1.1.1.3.5.cmml"><mi id="S3.Ex3.m1.1.1.3.5.2" xref="S3.Ex3.m1.1.1.3.5.2.cmml">r</mi><mi id="S3.Ex3.m1.1.1.3.5.3" xref="S3.Ex3.m1.1.1.3.5.3.cmml">i</mi></msub></mrow><mo id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml">s</mi><mo id="S3.Ex3.m1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.4.cmml">i</mi><mo id="S3.Ex3.m1.1.1.1.2a" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.5" xref="S3.Ex3.m1.1.1.1.5.cmml">g</mi><mo id="S3.Ex3.m1.1.1.1.2b" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.6" xref="S3.Ex3.m1.1.1.1.6.cmml">m</mi><mo id="S3.Ex3.m1.1.1.1.2c" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.7" xref="S3.Ex3.m1.1.1.1.7.cmml">o</mi><mo id="S3.Ex3.m1.1.1.1.2d" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.8" xref="S3.Ex3.m1.1.1.1.8.cmml">i</mi><mo id="S3.Ex3.m1.1.1.1.2e" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><msub id="S3.Ex3.m1.1.1.1.9" xref="S3.Ex3.m1.1.1.1.9.cmml"><mi id="S3.Ex3.m1.1.1.1.9.2" xref="S3.Ex3.m1.1.1.1.9.2.cmml">d</mi><mi id="S3.Ex3.m1.1.1.1.9.3" xref="S3.Ex3.m1.1.1.1.9.3.cmml">i</mi></msub><mo id="S3.Ex3.m1.1.1.1.2f" xref="S3.Ex3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.3.cmml">M</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.1.1.4" xref="S3.Ex3.m1.1.1.1.1.1.1.4.cmml">L</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.2a" xref="S3.Ex3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.5" xref="S3.Ex3.m1.1.1.1.1.1.1.5.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.5.2" xref="S3.Ex3.m1.1.1.1.1.1.1.5.2.cmml">P</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.5.3" xref="S3.Ex3.m1.1.1.1.1.1.1.5.3.cmml">i</mi></msub><mo id="S3.Ex3.m1.1.1.1.1.1.1.2b" xref="S3.Ex3.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">a</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1a" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.4" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.4.cmml">t</mi><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1b" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><msub id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.cmml"><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.2" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.2.cmml">e</mi><mi id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.3" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.3.cmml">i</mi></msub></mrow></msub><mo id="S3.Ex3.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><eq id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2"></eq><apply id="S3.Ex3.m1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.3"><times id="S3.Ex3.m1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.3.1"></times><ci id="S3.Ex3.m1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.3.2">𝑝</ci><ci id="S3.Ex3.m1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.3.3">𝑥</ci><ci id="S3.Ex3.m1.1.1.3.4.cmml" xref="S3.Ex3.m1.1.1.3.4">𝑡</ci><apply id="S3.Ex3.m1.1.1.3.5.cmml" xref="S3.Ex3.m1.1.1.3.5"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.3.5.1.cmml" xref="S3.Ex3.m1.1.1.3.5">subscript</csymbol><ci id="S3.Ex3.m1.1.1.3.5.2.cmml" xref="S3.Ex3.m1.1.1.3.5.2">𝑟</ci><ci id="S3.Ex3.m1.1.1.3.5.3.cmml" xref="S3.Ex3.m1.1.1.3.5.3">𝑖</ci></apply></apply><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><times id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.2"></times><ci id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3">𝑠</ci><ci id="S3.Ex3.m1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.4">𝑖</ci><ci id="S3.Ex3.m1.1.1.1.5.cmml" xref="S3.Ex3.m1.1.1.1.5">𝑔</ci><ci id="S3.Ex3.m1.1.1.1.6.cmml" xref="S3.Ex3.m1.1.1.1.6">𝑚</ci><ci id="S3.Ex3.m1.1.1.1.7.cmml" xref="S3.Ex3.m1.1.1.1.7">𝑜</ci><ci id="S3.Ex3.m1.1.1.1.8.cmml" xref="S3.Ex3.m1.1.1.1.8">𝑖</ci><apply id="S3.Ex3.m1.1.1.1.9.cmml" xref="S3.Ex3.m1.1.1.1.9"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.9.1.cmml" xref="S3.Ex3.m1.1.1.1.9">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.9.2.cmml" xref="S3.Ex3.m1.1.1.1.9.2">𝑑</ci><ci id="S3.Ex3.m1.1.1.1.9.3.cmml" xref="S3.Ex3.m1.1.1.1.9.3">𝑖</ci></apply><apply id="S3.Ex3.m1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1"><times id="S3.Ex3.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.2"></times><ci id="S3.Ex3.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.3">𝑀</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.4">𝐿</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.5.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.5.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.5.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.5.2">𝑃</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.5.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.5.3">𝑖</ci></apply><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.3">𝑎</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.4">𝑡</ci><apply id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.1.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.2.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.2">𝑒</ci><ci id="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.3.cmml" xref="S3.Ex3.m1.1.1.1.1.1.1.1.1.1.3.5.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">pxtr_{i}=sigmoid_{i}(MLP_{i}(x_{gate_{i}}))</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.1d">italic_p italic_x italic_t italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_s italic_i italic_g italic_m italic_o italic_i italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_M italic_L italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_g italic_a italic_t italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p14">
<p class="ltx_p" id="S3.SS3.p14.1">where pxtr donates the prediction of a certain objective, such as effective_view, long_view, etc. We calculate the final score of each video by a weighted sum of multiple pxtrs, and choose the video with the highest score for display.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4. </span>Cache update Mechanism</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.6">Cache updated in the following situations: <math alttext="(1)" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.2.2"><mo id="S3.SS4.p1.1.m1.1.2.2.1" stretchy="false">(</mo><mn id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">1</mn><mo id="S3.SS4.p1.1.m1.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><cn id="S3.SS4.p1.1.m1.1.1.cmml" type="integer" xref="S3.SS4.p1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">(1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">( 1 )</annotation></semantics></math> Choppy video is automatically added to the cache pool after being replaced. <math alttext="(2)" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><mrow id="S3.SS4.p1.2.m2.1.2.2"><mo id="S3.SS4.p1.2.m2.1.2.2.1" stretchy="false">(</mo><mn id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">2</mn><mo id="S3.SS4.p1.2.m2.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><cn id="S3.SS4.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS4.p1.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">(2)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">( 2 )</annotation></semantics></math> If the video’s caching time exceeds 2 weeks, it will be removed from the cache pool. <math alttext="(3)" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><mrow id="S3.SS4.p1.3.m3.1.2.2"><mo id="S3.SS4.p1.3.m3.1.2.2.1" stretchy="false">(</mo><mn id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">3</mn><mo id="S3.SS4.p1.3.m3.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><cn id="S3.SS4.p1.3.m3.1.1.cmml" type="integer" xref="S3.SS4.p1.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">(3)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">( 3 )</annotation></semantics></math> Each user has a local cache with the capacity of <math alttext="C_{u}" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">C</mi><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝐶</ci><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">C_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.1d">italic_C start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> where <math alttext="C_{u}" class="ltx_Math" display="inline" id="S3.SS4.p1.5.m5.1"><semantics id="S3.SS4.p1.5.m5.1a"><msub id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.2" xref="S3.SS4.p1.5.m5.1.1.2.cmml">C</mi><mi id="S3.SS4.p1.5.m5.1.1.3" xref="S3.SS4.p1.5.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><apply id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.2">𝐶</ci><ci id="S3.SS4.p1.5.m5.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">C_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.5.m5.1d">italic_C start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the max daily cache consumption in recent 7-days . If the current cached video is less than <math alttext="0.75*C_{u}" class="ltx_Math" display="inline" id="S3.SS4.p1.6.m6.1"><semantics id="S3.SS4.p1.6.m6.1a"><mrow id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml"><mn id="S3.SS4.p1.6.m6.1.1.2" xref="S3.SS4.p1.6.m6.1.1.2.cmml">0.75</mn><mo id="S3.SS4.p1.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS4.p1.6.m6.1.1.1.cmml">∗</mo><msub id="S3.SS4.p1.6.m6.1.1.3" xref="S3.SS4.p1.6.m6.1.1.3.cmml"><mi id="S3.SS4.p1.6.m6.1.1.3.2" xref="S3.SS4.p1.6.m6.1.1.3.2.cmml">C</mi><mi id="S3.SS4.p1.6.m6.1.1.3.3" xref="S3.SS4.p1.6.m6.1.1.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1"><times id="S3.SS4.p1.6.m6.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1.1"></times><cn id="S3.SS4.p1.6.m6.1.1.2.cmml" type="float" xref="S3.SS4.p1.6.m6.1.1.2">0.75</cn><apply id="S3.SS4.p1.6.m6.1.1.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.6.m6.1.1.3.1.cmml" xref="S3.SS4.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.6.m6.1.1.3.2.cmml" xref="S3.SS4.p1.6.m6.1.1.3.2">𝐶</ci><ci id="S3.SS4.p1.6.m6.1.1.3.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">0.75*C_{u}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.6.m6.1d">0.75 ∗ italic_C start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, the client will ask for cache replenishment from the cloud. In our system, the average number of cached videos per user is 24.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5. </span>Recommendation in offline mode.</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">It is worth mentioning that our system can also work effectively even without an internet connection, which we refer to as offline mode. In this scenario, since the client is unable to interact with the cloud server, we only perform the ranking stage for videos in the locally-cached pool. Offline mode continues until network connectivity is restored or the user has viewed all cached videos.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6. </span>System Implementation</h3>
<div class="ltx_para" id="S3.SS6.p1">
<p class="ltx_p" id="S3.SS6.p1.1">We have deployed our proposed GRF in a real-world industry-scale video recommendation system. The structure of the online system is depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.F5" title="Figure 5 ‣ 3.6. System Implementation ‣ 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">5</span></a>, and we will introduce the system implementation in three parts: model training, deployment and inference, and system efficiency.</p>
</div>
<div class="ltx_para" id="S3.SS6.p2">
<p class="ltx_p" id="S3.SS6.p2.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS6.p2.1.1">Model Training<span class="ltx_text ltx_font_upright" id="S3.SS6.p2.1.1.1"> </span></span> When users browse the videos, we combine features (such as network speed, video cached duration, bit rate, etc.) with labels (such as whether the video is choppy and the user engagement metrics like watch time, likes, follows, comments, etc.) to create a complete sample. These samples will be stored in a Hive database <cite class="ltx_cite ltx_citemacro_citep">(Thusoo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib19" title="">2009</a>)</cite>. We collect an offline dataset from the Hive table to train the gate model. Additionally, we use Kafka streams <cite class="ltx_cite ltx_citemacro_citep">(Narkhede et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib18" title="">2017</a>)</cite> to train the ranking model via an online learning paradigm, and we save the checkpoint of ranking model every four hours.</p>
</div>
<div class="ltx_para" id="S3.SS6.p3">
<p class="ltx_p" id="S3.SS6.p3.3"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS6.p3.3.4">Deployment and Inference<span class="ltx_text ltx_font_upright" id="S3.SS6.p3.3.4.1"> </span></span> The deployment of a checkpoint to the mobile device involves three steps: <span class="ltx_text ltx_font_bold" id="S3.SS6.p3.1.1">step <math alttext="1" class="ltx_Math" display="inline" id="S3.SS6.p3.1.1.m1.1"><semantics id="S3.SS6.p3.1.1.m1.1a"><mn id="S3.SS6.p3.1.1.m1.1.1" xref="S3.SS6.p3.1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.1.1.m1.1b"><cn id="S3.SS6.p3.1.1.m1.1.1.cmml" type="integer" xref="S3.SS6.p3.1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.1.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.1.1.m1.1d">1</annotation></semantics></math></span>: Convert the TensorFlow checkpoint model into TFLite <cite class="ltx_cite ltx_citemacro_citep">(Abadi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib2" title="">2016</a>)</cite> format. <span class="ltx_text ltx_font_bold" id="S3.SS6.p3.2.2">step <math alttext="2" class="ltx_Math" display="inline" id="S3.SS6.p3.2.2.m1.1"><semantics id="S3.SS6.p3.2.2.m1.1a"><mn id="S3.SS6.p3.2.2.m1.1.1" xref="S3.SS6.p3.2.2.m1.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.2.2.m1.1b"><cn id="S3.SS6.p3.2.2.m1.1.1.cmml" type="integer" xref="S3.SS6.p3.2.2.m1.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.2.2.m1.1c">2</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.2.2.m1.1d">2</annotation></semantics></math></span>: Upload the compressed TFLite format file to CDN. <span class="ltx_text ltx_font_bold" id="S3.SS6.p3.3.3">step <math alttext="3" class="ltx_Math" display="inline" id="S3.SS6.p3.3.3.m1.1"><semantics id="S3.SS6.p3.3.3.m1.1a"><mn id="S3.SS6.p3.3.3.m1.1.1" xref="S3.SS6.p3.3.3.m1.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS6.p3.3.3.m1.1b"><cn id="S3.SS6.p3.3.3.m1.1.1.cmml" type="integer" xref="S3.SS6.p3.3.3.m1.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS6.p3.3.3.m1.1c">3</annotation><annotation encoding="application/x-llamapun" id="S3.SS6.p3.3.3.m1.1d">3</annotation></semantics></math></span>: The client downloads the model from CDN. We update the ranking model periodically with the latest checkpoints to maintain its real-time performance. For inference, the client collects features from both server-side and client-side, feeds the features into TFLite model, and makes recommendations based on the model’s output.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>the efficiency metrics of GRF.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.1.1.1.1">model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T2.1.1.1.2">parameter</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.3">storage (TFLite)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T2.1.1.1.4">inference time</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T2.1.2.1.1">Gate</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T2.1.2.1.2">654757</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.3">2.727M</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.1.2.1.4">43ms</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T2.1.3.2.1">Ranking</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T2.1.3.2.2">1310860</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.3.2.3">5.318M</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T2.1.3.2.4">69.7ms</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="584" id="S3.F5.g1" src="x5.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>GRF System Implementation.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS6.p4">
<p class="ltx_p" id="S3.SS6.p4.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S3.SS6.p4.1.1">System Efficiency<span class="ltx_text ltx_font_upright" id="S3.SS6.p4.1.1.1"> </span></span> Given the limited computing power, energy, and storage on mobile devices, resource consumption is a key metric for evaluating the system. the computing efficiency metrics of our system are listed in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S3.T2" title="Table 2 ‣ 3.6. System Implementation ‣ 3. SYSTEM ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">2</span></a>. It is evident that both models are sufficiently lightweight in terms of storage and inference time, allowing them to run smoothly without a significant performance deterioration on the user’s mobile device.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>EXPERIMENTS</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we conduct offline and online experiments with real-world video RS dataset to demonstrate the effectiveness of our proposed framework.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Offline Results of Gate model</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS1.p1.1.1">Experiment Setup.<span class="ltx_text ltx_font_upright" id="S4.SS1.p1.1.1.1"> </span></span> The goal of the gate model is to screen out choppy videos, which can be formulated as a binary classification task. We use an exponential decay learning rate schedule which keeps the value for the first 50 steps, the initial learning rate is 7e-5, and the decay rate is 0.98. We apply a class weight of 10:1 for positive and negative samples respectively to alleviate the imbalanced issue. the batch size is 2048 and the number of maskBlocks is 3.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS1.p2.1.1">Dataset<span class="ltx_text ltx_font_upright" id="S4.SS1.p2.1.1.1"> </span></span>We collected data from online recommendation logs in Kwai from 2023-09-11 to 2023-09-17. There are a total of 12368053 impressions consisting of 386501 choppy samples. We randomly split data into training, validation, and testing three parts with the ratio of 8:1:1, respectively.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>offline results of different models.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.1">model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.2">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.3">recall@p0.7</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.1">Xgboost</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.2">0.847</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.3">0.624</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.2">
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.2.1">SimpleDNN</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.2.2">0.887</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.2.3">0.651</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.3">
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.3.1">TabTransformer</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.3.2">0.919</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.3.3">0.675</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.5.4.1">Ours</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.5.4.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.5.4.2.1">0.957</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.5.4.3.1">0.692</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.3"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS1.p3.3.1">Evaluation Metrics and Baselines.<span class="ltx_text ltx_font_upright" id="S4.SS1.p3.3.1.1"> </span></span> We use AUC and recall at precision 0.7 as evaluation metric. We compare our model with three representative baselines: <math alttext="(1)" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.2.2"><mo id="S4.SS1.p3.1.m1.1.2.2.1" stretchy="false">(</mo><mn id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">1</mn><mo id="S4.SS1.p3.1.m1.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><cn id="S4.SS1.p3.1.m1.1.1.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">(1)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">( 1 )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.3.2">Xgboost</span>. A widely used gradient boosting decision tree algorithm <cite class="ltx_cite ltx_citemacro_citep">(Chen and Guestrin, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib5" title="">2016</a>)</cite>. <math alttext="(2)" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.2.2"><mo id="S4.SS1.p3.2.m2.1.2.2.1" stretchy="false">(</mo><mn id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">2</mn><mo id="S4.SS1.p3.2.m2.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><cn id="S4.SS1.p3.2.m2.1.1.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">(2)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">( 2 )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.3.3">SimpleDNN</span>. A DNN model with embedding strategy in our work. and <math alttext="(3)" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.2.2"><mo id="S4.SS1.p3.3.m3.1.2.2.1" stretchy="false">(</mo><mn id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">3</mn><mo id="S4.SS1.p3.3.m3.1.2.2.2" stretchy="false">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><cn id="S4.SS1.p3.3.m3.1.1.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">(3)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">( 3 )</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="S4.SS1.p3.3.4">TabTransformer</span>. <cite class="ltx_cite ltx_citemacro_citep">(Huang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib12" title="">2020</a>)</cite> Which is a novel transformer architecture for modeling tabular data. We implement it with pytorch_tabular toolkits<cite class="ltx_cite ltx_citemacro_citep">(Joseph, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib13" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">We evaluation recall@p0.7 as this threshold achieves a good balance between cache costs and overall benefits in online experiments. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.T3" title="Table 3 ‣ 4.1. Offline Results of Gate model ‣ 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates that our gate model significantly outperforms other baselines including both machine learning and deep learning algorithms, which shows the effectiveness of our methods.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Offline Results of Ranking model</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS2.p1.1.1">Experiment Setup.<span class="ltx_text ltx_font_upright" id="S4.SS2.p1.1.1.1"> </span></span> Our ranking model aims to predict the ratio of four objectives: effective_view (evr), long_view (lvr), short_view (svr) and finish_play (fpr), each indicating varying degrees of user engagement during watching. We use 4 attention heads in both real-time and upcoming video list MHA layer, and the dimension of each head is 64. The MMoE module consists of 8 experts and 4 gates. We use Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma and Ba, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib14" title="">2014</a>)</cite> to optimize the model parameters, the batch size is 4096 and the learning rate is 4e-5.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_font_bold ltx_font_italic" id="S4.SS2.p2.1.1">Evaluation Metrics and Baselines.<span class="ltx_text ltx_font_upright" id="S4.SS2.p2.1.1.1"> </span></span> Following <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#bib.bib8" title="">2022</a>)</cite>, we use AUC as main metric. When ranking cached videos, we have two options: 1. use the pxtr from the server-side model, or 2. use our ranking model. Therefore, we take the server-side model as baseline. Since the model architecture is not the main contribution of this paper, and some state-of-the-art cloud-based models are difficult to deploy on devices due to resource constraints, we did not conduct additional experimental comparisons with more SOTA models.</p>
</div>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span>offline AUC results. The bold number indicates statistical significance improvement compared to baseline, measured by t-test with p-value ¡ 0.05. </figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.1">model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.2">evr</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.3">lvr</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.4">svr</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.1.1.1.5">fpr</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.1">Server-side Model</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.2">0.8135</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.3">0.8340</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.4">0.8087</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.2.1.5">0.8705</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.3.2.1">Our Ranking Model</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.3.2.2.1">0.8170</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.3.2.3.1">0.8372</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.3.2.4.1">0.8161</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T4.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S4.T4.1.3.2.5.1">0.8756</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">As shown in table <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.T4" title="Table 4 ‣ 4.2. Offline Results of Ranking model ‣ 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">4</span></a>, our lightweight ranking model achieves superior performance compared with server-side large model, showing the ability of our method to select optimal videos. An intuitive explanation is that we jointly leverage the output of server-side model and real-time client features.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Online A/B Testing</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We conducted online A/B Testing in production environment from 2023-08 to 2023-10. We divide experiments into three settings. <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.1">1. base</span>: a blank control group without GRF system, <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.2">2. gate</span>: a group with gate model, and rank the cached video with server-side pxtr. and <span class="ltx_text ltx_font_bold" id="S4.SS3.p1.1.3">3. full</span>: a group with full proposed methods. We attribute 10% traffic for each experiment group.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.F6" title="Figure 6 ‣ 4.3. Online A/B Testing ‣ 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">6</span></a> plots the online performance of different experiment group, where the x axis stands for the number of days since experiment started, and y axis denotes the percentage improvement of overall watch time. After over a month’s rigorous testing, we report the results in table <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.T5" title="Table 5 ‣ 4.3. Online A/B Testing ‣ 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">5</span></a>, where the data is taken from the average values of the last seven days in online experiment.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="266" id="S4.F6.g1" src="extracted/5910019/app_time.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>The online performance of different experiment group.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5. </span>Results of online A/B testing, measured by overall watch time (WT), watch time in poor network conditions (WTP), Day 1 Retention Rates (D1RR), Day 7 Retention Rates (D7RR), and Day 30 Retention Rates (D30RR). Here bold text indicates the best results, while * donates statistical significance improvement, measured by t-test with p-value ¡ 0.05.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S4.T5.1.1.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.2">WT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.3">WTP</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.4">D1RR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.5">D7RR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T5.1.1.1.6">D30RR</th>
</tr>
<tr class="ltx_tr" id="S4.T5.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T5.1.2.2.1">base</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.2">+0.00%</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.3">+0.00%</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.4">+0.00%</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.5">+0.00%</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T5.1.2.2.6">+0.00%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T5.1.3.1.1">gate</th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.3.1.2">+0.551%*</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.3.1.3">+31.57%*</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.3.1.4">+0.134%*</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.3.1.5">+0.122%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T5.1.3.1.6">+0.141%*</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T5.1.4.2.1">Full</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.4.2.2">
<span class="ltx_text ltx_font_bold" id="S4.T5.1.4.2.2.1">+0.839%</span>*</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.4.2.3">
<span class="ltx_text ltx_font_bold" id="S4.T5.1.4.2.3.1">+44.45%</span>*</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.4.2.4">
<span class="ltx_text ltx_font_bold" id="S4.T5.1.4.2.4.1">+0.141%</span>*</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.4.2.5">
<span class="ltx_text ltx_font_bold" id="S4.T5.1.4.2.5.1">+0.136%</span>*</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.4.2.6">
<span class="ltx_text ltx_font_bold" id="S4.T5.1.4.2.6.1">+0.157%</span>*</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">Results in table <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.T5" title="Table 5 ‣ 4.3. Online A/B Testing ‣ 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">5</span></a> manifest that both Gate model and full GRF system achieves a considerable gains. Compare with base group, our method improved the overall watch time by 0.839%, and watch time in poor network conditions (slow internet speed or weak network signal) by a large margin <span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">44.45%</span>, which further demonstrates the effectiveness of our methods in real-world scenarios. Our solution has been deployed online from then on.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Case Study</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">We present two real-world cases to illustrate the impact of our proposed gating and ranking framework, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.05863v1#S4.F7" title="Figure 7 ‣ 4.4. Case Study ‣ 4. EXPERIMENTS ‣ Enhancing Playback Performance in Video Recommender Systems with an On-Device Gating and Ranking Framework"><span class="ltx_text ltx_ref_tag">7</span></a>. The top row displays the server-side recommendation results, the bottom row indicates the results of our GRF system, and the remaining rows show the video playback status and predicted value of the gate model. Once the GRF is implemented, the actual playback status of the replaced video is no longer known. In these two cases, we only obtain the GRF model’s predicted results without making any changes to the recommendation contents.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">For case A, the third video encounters a failed loading playback issue, the predicted choppy rate of this video from the gate model is 0.8201, which is greater than the threshold of our online settings (0.75), thus our GRF system will replace it with a locally-cached video and dissolve this playback issue case. Case B shows another representative scenario, The user lost the network connection, making it impossible to interact with the cloud server and watch videos seamlessly.
However, our GRF system will switch to offline mode and make recommendations from a locally-cached pool, providing users with the ability to watch videos temporarily.</p>
</div>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="493" id="S4.F7.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>Two real-world cases to illustrate the impact of
our proposed gating and ranking framework.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>CONCLUSION</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, We highlight the choppy playback, a real issue experienced by the client and show its substantial impact on user experience in video recommender systems. Furthermore, we propose a gating and ranking recommendation framework, called GRF, for enhancing playback performance, which makes the first attempt to provide an on-device RS that tackles the issue of choppy playback. Specifically, GRF involves two stages: the gating stage, which aims to identify videos that may have playback issues, and the ranking stage, which seeks to select the optimal result from a locally-cached pool to replace the choppy videos. We conduct extensive offline experiments and online A/B testing in a real-world industrial scenario to demonstrate the effectiveness of our methods. Currently, our solution has been fully deployed on mobile Kwai and significantly improved overall user watch time and retention rates.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">We believe that tackling the issues in real-world recommender systems, such as choppy video playback, is a promising direction in the future. We will explore the collaboration and consistency between the recommendation models on the cloud and the device for further work.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abadi et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Martín Abadi, Ashish Agarwal, Paul Barham, Eugene Brevdo, Zhifeng Chen, Craig Citro, Greg S Corrado, Andy Davis, Jeffrey Dean, Matthieu Devin, et al<span class="ltx_text" id="bib.bib2.3.1">.</span> 2016.

</span>
<span class="ltx_bibblock">Tensorflow: Large-scale machine learning on heterogeneous distributed systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.4.1">arXiv preprint arXiv:1603.04467</em> (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akhtar et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Zahaib Akhtar, Yun Seong Nam, Ramesh Govindan, Sanjay Rao, Jessica Chen, Ethan Katz-Bassett, Bruno Ribeiro, Jibin Zhan, and Hui Zhang. 2018.

</span>
<span class="ltx_bibblock">Oboe: Auto-tuning video ABR algorithms to network conditions. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 2018 Conference of the ACM Special Interest Group on Data Communication</em>. 44–58.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caruana (1997)</span>
<span class="ltx_bibblock">
Rich Caruana. 1997.

</span>
<span class="ltx_bibblock">Multitask learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Machine learning</em> 28 (1997), 41–75.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Guestrin (2016)</span>
<span class="ltx_bibblock">
Tianqi Chen and Carlos Guestrin. 2016.

</span>
<span class="ltx_bibblock">Xgboost: A scalable tree boosting system. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 22nd acm sigkdd international conference on knowledge discovery and data mining</em>. 785–794.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Tongtong Feng, Haifeng Sun, Qi Qi, Jingyu Wang, and Jianxin Liao. 2019.

</span>
<span class="ltx_bibblock">Vabis: Video adaptation bitrate system for time-critical live streaming.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">IEEE Transactions on Multimedia</em> 22, 11 (2019), 2963–2976.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yufei Feng, Binbin Hu, Yu Gong, Fei Sun, Qingwen Liu, and Wenwu Ou. 2021.

</span>
<span class="ltx_bibblock">GRN: Generative Rerank Network for Context-wise Recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">arXiv preprint arXiv:2104.00860</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Xudong Gong, Qinlin Feng, Yuan Zhang, Jiangling Qin, Weijie Ding, Biao Li, Peng Jiang, and Kun Gai. 2022.

</span>
<span class="ltx_bibblock">Real-time Short Video Recommendation on Mobile Devices. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</em>. 3103–3112.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yu Gong, Ziwen Jiang, Yufei Feng, Binbin Hu, Kaiqi Zhao, Qingwen Liu, and Wenwu Ou. 2020.

</span>
<span class="ltx_bibblock">EdgeRec: recommender system on edge in Mobile Taobao. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em>. 2477–2484.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Huifeng Guo, Bo Chen, Ruiming Tang, Weinan Zhang, Zhenguo Li, and Xiuqiang He. 2021.

</span>
<span class="ltx_bibblock">An embedding learning framework for numerical features in ctr prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining</em>. 2910–2918.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hodzic et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Kerim Hodzic, Mirsad Cosovic, Sasa Mrdovic, Jason J Quinlan, and Darijo Raca. 2022.

</span>
<span class="ltx_bibblock">Realistic video sequences for subjective QoE analysis. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of the 13th ACM Multimedia Systems Conference</em>. 246–251.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xin Huang, Ashish Khetan, Milan Cvitkovic, and Zohar Karnin. 2020.

</span>
<span class="ltx_bibblock">Tabtransformer: Tabular data modeling using contextual embeddings.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">arXiv preprint arXiv:2012.06678</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Joseph (2021)</span>
<span class="ltx_bibblock">
Manu Joseph. 2021.

</span>
<span class="ltx_bibblock">PyTorch Tabular: A Framework for Deep Learning with Tabular Data.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2104.13638 [cs.LG]

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba (2014)</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba. 2014.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:1412.6980</em> (2014).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lang et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Lihui Lang, Meiqi Hu, Changhua Pei, and Guo Chen. 2023.

</span>
<span class="ltx_bibblock">Beyond the Content: Considering the Network for Online Video Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Proceedings of the 7th Asia-Pacific Workshop on Networking</em>. 150–156.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zihan Lin, Hui Wang, Jingshu Mao, Wayne Xin Zhao, Cheng Wang, Peng Jiang, and Ji-Rong Wen. 2022.

</span>
<span class="ltx_bibblock">Feature-aware diversified re-ranking with disentangled representations for relevant recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 3327–3335.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Jiaqi Ma, Zhe Zhao, Xinyang Yi, Jilin Chen, Lichan Hong, and Ed H Chi. 2018.

</span>
<span class="ltx_bibblock">Modeling task relationships in multi-task learning with multi-gate mixture-of-experts. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1930–1939.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Narkhede et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Neha Narkhede, Gwen Shapira, and Todd Palino. 2017.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Kafka: the definitive guide: real-time data and stream processing at scale</em>.

</span>
<span class="ltx_bibblock">” O’Reilly Media, Inc.”.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Thusoo et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2009)</span>
<span class="ltx_bibblock">
Ashish Thusoo, Joydeep Sen Sarma, Namit Jain, Zheng Shao, Prasad Chakka, Suresh Anthony, Hao Liu, Pete Wyckoff, and Raghotham Murthy. 2009.

</span>
<span class="ltx_bibblock">Hive: a warehousing solution over a map-reduce framework.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Proceedings of the VLDB Endowment</em> 2, 2 (2009), 1626–1629.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhiqiang Wang, Qingyun She, and Junlin Zhang. 2021.

</span>
<span class="ltx_bibblock">MaskNet: Introducing feature-wise multiplication to CTR ranking models by instance-guided mask.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">arXiv preprint arXiv:2102.07619</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhan et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Ruohan Zhan, Changhua Pei, Qiang Su, Jianfeng Wen, Xueliang Wang, Guanyu Mu, Dong Zheng, Peng Jiang, and Kun Gai. 2022.

</span>
<span class="ltx_bibblock">Deconfounding Duration Bias in Watch-time Prediction for Video Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the 28th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 4472–4481.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep interest network for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 24th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 1059–1068.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Tue Oct  8 09:51:36 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
