<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2210.06820] Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning</title><meta property="og:description" content="Multi-Agent Reinforcement Learning currently focuses on implementations where all data and training can be centralized to one machine. But what if local agents are split across multiple tasks, and need to keep data pri…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2210.06820">

<!--Generated on Thu Mar 14 03:20:16 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Doseok Jang, Larry Yan, Lucas Spangher, &amp; Costas J. Spanos 
<br class="ltx_break">Department of Electrical Engineering and Computer Science
<br class="ltx_break">University of California, Berkeley
<br class="ltx_break">Berkeley, CA 94720, USA 
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter">{ djang,yanlarry,lucas_spangher,spanos }@berkeley.edu</span> 
<br class="ltx_break">
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">Multi-Agent Reinforcement Learning currently focuses on implementations where all data and training can be centralized to one machine. But what if local agents are split across multiple tasks, and need to keep data private between each? We develop the first application of Personalized Federated Hypernetworks (PFH) to Reinforcement Learning (RL). We then present a novel application of PFH to few-shot transfer, and demonstrate significant initial increases in learning. PFH has never been demonstrated beyond supervised learning benchmarks, so we apply PFH to an important domain: RL price-setting for energy demand response. We consider a general case across where agents are split across multiple microgrids, wherein energy consumption data must be kept private within each microgrid. Together, our work explores how the fields of personalized federated learning and RL can come together to make learning efficient across multiple tasks while keeping data secure.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">As Reinforcement Learning (RL) is brought to bear on pressing societal issues such as the green energy transition, the types of environments that RL must perform well in may display characteristics exotic to classical RL environments. Real applications at scale may require privacy guarantees which are not provided by modern multi-agent RL algorithms as they may train on privileged or corporate data <cite class="ltx_cite ltx_citemacro_citep">(Lowe et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>; Sunehag et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>; Rashid et al., <a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>; any app that personalizes an RL agent to individual users must take care to protect their privacy by not storing all their data in a central server. Real world applications will also likely feature heterogeneous tasks; every user, robot, energy system will have different traits that cannot be accounted for by ”one size fits all” algorithms. As previous work in privacy-preserving RL <cite class="ltx_cite ltx_citemacro_citep">(Qi et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2020</a>; Ren et al., <a href="#bib.bib17" title="" class="ltx_ref">2019</a>; Anwar &amp; Raychowdhury, <a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite> does not extend to personalized models, the competing goals of privacy and personalization must be accomplished at the other’s expense.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">One approach toward privacy preservation by decentralizing data servers within <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">supervised</span> learning is <span id="S1.p2.1.2" class="ltx_text ltx_font_bold">federated learning</span> <cite class="ltx_cite ltx_citemacro_citep">(Shokri &amp; Shmatikov, <a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite>. Federated learning algorithms train a global model from gradient updates sent by individual clients training on their own data, which is never sent to the central server. An extension of federated learning technique is personalized federated learning using hypernetworks (PFH, <cite class="ltx_cite ltx_citemacro_citet">Shamsian et al. (<a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>), which allows for behavior tailored to individual heterogeneous tasks by splitting the model into a global common component (i.e. the <span id="S1.p2.1.3" class="ltx_text ltx_font_bold">hypernetwork</span>), and a local individual component (a <span id="S1.p2.1.4" class="ltx_text ltx_font_bold">local network</span> generated by the hypernetwork), which is tailored to each client. This task specialization allows for learning common features together in the global component while allowing for learning client-specific knowledge in the local component.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">We present a novel application of PFH to RL in a realistic power systems setting that requires both privacy and heterogeneity in agents to accommodate diverse, sensitive environments. An RL controller optimizing hourly transactive energy pricing has been shown to optimize energy usage <cite class="ltx_cite ltx_citemacro_citep">(Li &amp; Hong, <a href="#bib.bib11" title="" class="ltx_ref">2014</a>; Spangher, <a href="#bib.bib24" title="" class="ltx_ref">2021</a>; Vázquez-Canteli et al., <a href="#bib.bib27" title="" class="ltx_ref">2019</a>; Agwan et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite> by incentivizing consumers, at the scale of groups of buildings (microgrids) or office workers within buildings, to shift demand to different times of day. By guiding consumers to defer energy demands to hours when solar is especially active, it is possible to drop a building’s carbon impact to 48% of normal operation through RL price-setting <cite class="ltx_cite ltx_citemacro_citep">(Jang et al., <a href="#bib.bib10" title="" class="ltx_ref">2022</a>)</cite>, which could have massive implications for grid sustainability. However, RL can be extremely data hungry; prior transactive control attempts required about 80 years of training data <cite class="ltx_cite ltx_citemacro_citep">(Agwan et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">To increase the amount of data available, we consider multiple RL agents, each managing their own (slightly different) microgrid through energy prices and collecting data in parallel. This microgrid environment is a multi-task, multi-agent setup in which the management of each microgrid, through prices, constitutes a task. We characterize our problem as multi-agent because we have multiple RL agents optimizing a shared reward (total profit), and multi-task because optimization of profit in each of the different microgrids presents tasks that are related but also independent due to differences in size, number of batteries in each building, etc. We hypothesize we can accelerate training by incorporating data from multiple microgrids with different characteristics. Learning to set prices using data from multiple microgrids (source tasks) also opens the door to few-shot learning in new microgrids (target tasks), wherein we learn to generate near-optimal prices for a microgrid very quickly.</p>
</div>
<div id="S1.p5" class="ltx_para ltx_noindent">
<p id="S1.p5.1" class="ltx_p">However, energy data is data in which privacy concerns are paramount. It is our hope to contribute to privacy protection by aggregating learning, <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">not</span> data, to one central source. Not only would keeping data of buildings’ energy consumption at one central location present a major privacy concern if this central machine is compromised, but message passing of the raw data could present an additional source of vulnerability. Although each microgrid might have access to the data of a few buildings at a time, the scale of damage would be much larger if data was stored in a central server across multiple microgrids.</p>
</div>
<div id="S1.p6" class="ltx_para ltx_noindent">
<p id="S1.p6.1" class="ltx_p">We now present a hypothetical setting in which our architecture would be useful. One could imagine a hacker being able to learn when the hypothetical company CovertAI trains their new 80 quintillion parameter language model CPT-4 from the energy consumption of CovertAI’s compute warehouses. The hacker could sabotage power lines at the right moment to erase learning gains. They may then turn their attention to residential neighborhoods. Here, they could figure out when people are not home from the energy consumption of domestic buildings, timing a theft; they could also disaggregate energy signals to learn the appliances the homeowner has or glean sensitive health information if medical devices produce noticeable patterns in energy consumption.</p>
</div>
<div id="S1.p7" class="ltx_para ltx_noindent">
<p id="S1.p7.1" class="ltx_p">Applying PFH to the energy application remedies both of these competing issues. PFH takes privacy-preservation into account by design, and accounts for heterogeneous tasks by generating RL agents individualized to each microgrid’s size, number of solar panels, batteries, etc. We demonstrate that PFH learns the underlying factors that define an environment by applying PFH to the microgrid price-setting problem, where we observe increases on the scale of millions of dollars in total microgrid profit (reward) over federated and local learning. We also demonstrate how PFH can be used for few-shot transfer learning for new local agents entering the system by reporting drastic training speed-ups (<math id="S1.p7.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="S1.p7.1.m1.1a"><mo id="S1.p7.1.m1.1.1" xref="S1.p7.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="S1.p7.1.m1.1b"><gt id="S1.p7.1.m1.1.1.cmml" xref="S1.p7.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="S1.p7.1.m1.1c">&gt;</annotation></semantics></math>100x) when transferring from source tasks to target tasks. Thus PFH drastically increases the feasibility of RL for energy price-setting.</p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p">Methodologically, our paper is novel in its presentation of an adaptation of a state of the art privacy-preserving algorithm to RL. To our knowledge<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>See <a href="#A1" title="Appendix A Related Work ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a> for a discussion of related work.</span></span></span>, we are the first to explicitly apply personalized federated learning to multi-task, multi-agent RL when centralized learning and joint action-values are unavailable. Application-wise, our paper is also novel in its improvement in energy demand response across heterogeneous microgrids. We hope our work highlights an important microgrid environment to the RL community, helps establish the use of PFH within RL, and allows for RL to address problems where learning speed and privacy are fundamental.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Definitions</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Energy Demand Response</span> is a technique used by grid operators to incentivize consumers to shift demand to times when it is better for grid stability/climate emissions, such as when solar energy peaks. Demand response has the same function as grid-level batteries would in easing the volatility of wind and solar energy and is seen as an important tool in the energy transition <cite class="ltx_cite ltx_citemacro_citep">(Albadi &amp; El-Saadany, <a href="#bib.bib3" title="" class="ltx_ref">2007</a>)</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p">A <span id="S2.p2.1.1" class="ltx_text ltx_font_bold">microgrid</span> is defined as a small group of buildings that transacts energy with each other through some energy aggregator, governed by an hourly energy pricing scheme. One may imagine they are situated close together with respect to not only geography but also the wiring topology of the grid, making trading within the microgrid preferable to trading with the grid. We will refer to groups of microgrids as ”<span id="S2.p2.1.2" class="ltx_text ltx_font_bold">microgrid clusters </span>”. <span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Please note that while ”microgrid clusters ” <span id="footnote2.1" class="ltx_text ltx_font_italic">does</span> appear in the literature, there is no clear consensus around the term being the only appropriate term for multiple connected microgrids.</span></span></span></p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p">A <span id="S2.p3.1.1" class="ltx_text ltx_font_bold">prosumer</span> is an entity that both consumes and produces energy, like a building with rooftop solar.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p">We wish to disambiguate between <span id="S2.p4.1.1" class="ltx_text ltx_font_bold">multi-task</span> and <span id="S2.p4.1.2" class="ltx_text ltx_font_bold">multi-agent</span> for the reader’s convenience. We use them in the conventional sense: multi-task relates to multiple, related settings (in our case slightly different MDP’s in each different microgrid) whereas multi-agent refers to multiple different policies.</p>
</div>
<div id="S2.p5" class="ltx_para ltx_noindent">
<p id="S2.p5.1" class="ltx_p">A <span id="S2.p5.1.1" class="ltx_text ltx_font_bold">hypernetwork</span> is a neural network that outputs the weights of another neural network.</p>
</div>
<div id="S2.p6" class="ltx_para ltx_noindent">
<p id="S2.p6.1" class="ltx_p">A <span id="S2.p6.1.1" class="ltx_text ltx_font_bold">privacy-preserving algorithm</span> is one that does not require communication or storage of raw data samples to a central server.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Learning environment</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.3" class="ltx_p">The MicrogridLearn <cite class="ltx_cite ltx_citemacro_citep">(Agwan et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite> environment is an OpenAI Gym <cite class="ltx_cite ltx_citemacro_citep">(Brockman et al., <a href="#bib.bib6" title="" class="ltx_ref">2016</a>)</cite> environment used to study RL-set pricing in prosumer aggregations. Specifically, the environment is structured such that an RL agent and an energy utility both broadcast a day’s worth of hourly buy and sell prices; <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\vec{A}_{b},\vec{A}_{s}," display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1.1"><mrow id="S3.SS1.p1.1.m1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.3.cmml"><msub id="S3.SS1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.2.cmml">A</mi><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.1" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.SS1.p1.1.m1.1.1.1.1.2.3" xref="S3.SS1.p1.1.m1.1.1.1.1.3.cmml">,</mo><msub id="S3.SS1.p1.1.m1.1.1.1.1.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.cmml"><mover accent="true" id="S3.SS1.p1.1.m1.1.1.1.1.2.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.2" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.2.cmml">A</mi><mo stretchy="false" id="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.1" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.1.cmml">→</mo></mover><mi id="S3.SS1.p1.1.m1.1.1.1.1.2.2.3" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.3.cmml">s</mi></msub></mrow><mo id="S3.SS1.p1.1.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><list id="S3.SS1.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2"><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2"><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.1">→</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.2.2">𝐴</ci></apply><ci id="S3.SS1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.1.1.3">𝑏</ci></apply><apply id="S3.SS1.p1.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2">subscript</csymbol><apply id="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.2"><ci id="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.1">→</ci><ci id="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.2.2">𝐴</ci></apply><ci id="S3.SS1.p1.1.m1.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p1.1.m1.1.1.1.1.2.2.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\vec{A}_{b},\vec{A}_{s},</annotation></semantics></math> and <math id="S3.SS1.p1.2.m2.2" class="ltx_Math" alttext="\vec{U}_{b},\vec{U}_{s}" display="inline"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.3.cmml"><msub id="S3.SS1.p1.2.m2.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p1.2.m2.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.2.2" xref="S3.SS1.p1.2.m2.1.1.1.1.2.2.cmml">U</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.1.1.1.1.2.1" xref="S3.SS1.p1.2.m2.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS1.p1.2.m2.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.SS1.p1.2.m2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.cmml"><mover accent="true" id="S3.SS1.p1.2.m2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml">U</mi><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.2.2.2.1" xref="S3.SS1.p1.2.m2.2.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.SS1.p1.2.m2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.2.2.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><list id="S3.SS1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2"><apply id="S3.SS1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.2"><ci id="S3.SS1.p1.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.2.1">→</ci><ci id="S3.SS1.p1.2.m2.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.2.2">𝑈</ci></apply><ci id="S3.SS1.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.3">𝑏</ci></apply><apply id="S3.SS1.p1.2.m2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2"><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.1">→</ci><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2">𝑈</ci></apply><ci id="S3.SS1.p1.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">\vec{U}_{b},\vec{U}_{s}</annotation></semantics></math>, respectively, to a microgrid’s simulated prosumers, who choose at the beginning of the day which hours they will transact with the RL agent and which hours they will transact with the energy utility. Each prosumer is an office building composed of a year’s worth of historical data and user-defined, non-negative battery and photovoltaic capacities<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>The photovoltaic output is defined by a fixed year’s worth of solar generation for one unit of panels, which is then scaled by the number of photovoltaic panels assigned at initialization.</span></span></span> At every step, i.e. one day where all 24 hours are considered, every prosumer solves a convex optimization optimizing their battery charging/discharging, <math id="S3.SS1.p1.3.m3.2" class="ltx_Math" alttext="\vec{u}_{+},\vec{u}_{-}" display="inline"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.2.2" xref="S3.SS1.p1.3.m3.2.2.3.cmml"><msub id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p1.3.m3.1.1.1.1.2" xref="S3.SS1.p1.3.m3.1.1.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.1.1.2.2.cmml">u</mi><mo stretchy="false" id="S3.SS1.p1.3.m3.1.1.1.1.2.1" xref="S3.SS1.p1.3.m3.1.1.1.1.2.1.cmml">→</mo></mover><mo id="S3.SS1.p1.3.m3.1.1.1.1.3" xref="S3.SS1.p1.3.m3.1.1.1.1.3.cmml">+</mo></msub><mo id="S3.SS1.p1.3.m3.2.2.2.3" xref="S3.SS1.p1.3.m3.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.3.m3.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.cmml"><mover accent="true" id="S3.SS1.p1.3.m3.2.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.3.m3.2.2.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.2.2.cmml">u</mi><mo stretchy="false" id="S3.SS1.p1.3.m3.2.2.2.2.2.1" xref="S3.SS1.p1.3.m3.2.2.2.2.2.1.cmml">→</mo></mover><mo id="S3.SS1.p1.3.m3.2.2.2.2.3" xref="S3.SS1.p1.3.m3.2.2.2.2.3.cmml">−</mo></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><list id="S3.SS1.p1.3.m3.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2"><apply id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p1.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.2"><ci id="S3.SS1.p1.3.m3.1.1.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.2.1">→</ci><ci id="S3.SS1.p1.3.m3.1.1.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.2.2">𝑢</ci></apply><plus id="S3.SS1.p1.3.m3.1.1.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1.3"></plus></apply><apply id="S3.SS1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.2.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2"><ci id="S3.SS1.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.1">→</ci><ci id="S3.SS1.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.2.2">𝑢</ci></apply><minus id="S3.SS1.p1.3.m3.2.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2.3"></minus></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">\vec{u}_{+},\vec{u}_{-}</annotation></semantics></math>, to maximize their individual profit; i.e.:</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.6" class="ltx_Math" alttext="\operatorname*{arg\,max}_{\vec{u}_{+},\vec{u}_{-}}\left[\langle\max(\vec{A}_{s},\vec{U}_{s}),(\vec{e}_{s}+\vec{u}_{+})\rangle-\langle\min(\vec{A}_{b},\vec{U}_{s}),(\vec{e}_{b}+\vec{u}_{-})\rangle\right]" display="block"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6.2" xref="S3.E1.m1.6.6.3.cmml"><munder id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mi id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.1" xref="S3.E1.m1.5.5.1.1.2.1.cmml">​</mo><mi id="S3.E1.m1.5.5.1.1.2.3" xref="S3.E1.m1.5.5.1.1.2.3.cmml">max</mi></mrow><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml"><msub id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.2.2.cmml">u</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.1.2.1.cmml">→</mo></mover><mo id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">+</mo></msub><mo id="S3.E1.m1.2.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.cmml"><mover accent="true" id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml">u</mi><mo stretchy="false" id="S3.E1.m1.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.1.cmml">→</mo></mover><mo id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.3.cmml">−</mo></msub></mrow></munder><mo id="S3.E1.m1.6.6.2a" xref="S3.E1.m1.6.6.3.cmml">⁡</mo><mrow id="S3.E1.m1.6.6.2.2" xref="S3.E1.m1.6.6.3.cmml"><mo id="S3.E1.m1.6.6.2.2.2" xref="S3.E1.m1.6.6.3.cmml">[</mo><mrow id="S3.E1.m1.6.6.2.2.1" xref="S3.E1.m1.6.6.2.2.1.cmml"><mrow id="S3.E1.m1.6.6.2.2.1.2.2" xref="S3.E1.m1.6.6.2.2.1.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.2.2.3" xref="S3.E1.m1.6.6.2.2.1.2.3.cmml">⟨</mo><mrow id="S3.E1.m1.6.6.2.2.1.1.1.1.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">max</mi><mo id="S3.E1.m1.6.6.2.2.1.1.1.1.2a" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml">⁡</mo><mrow id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.3" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml">(</mo><msub id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.2.cmml">A</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.3" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.4" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml">,</mo><msub id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.cmml"><mover accent="true" id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.2.cmml">U</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.1" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.3" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.5" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.2.2.1.2.2.4" xref="S3.E1.m1.6.6.2.2.1.2.3.cmml">,</mo><mrow id="S3.E1.m1.6.6.2.2.1.2.2.2.1" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.2.2.2.1.2" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.cmml"><msub id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.cmml"><mover accent="true" id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.cmml"><mi id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.2" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.2.cmml">e</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.1" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.3" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.3.cmml">s</mi></msub><mo id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.1" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.1.cmml">+</mo><msub id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.cmml"><mover accent="true" id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.cmml"><mi id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.2" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.2.cmml">u</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.1" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.1.cmml">→</mo></mover><mo id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.3" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.3.cmml">+</mo></msub></mrow><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.2.2.2.1.3" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.2.2.5" xref="S3.E1.m1.6.6.2.2.1.2.3.cmml">⟩</mo></mrow><mo id="S3.E1.m1.6.6.2.2.1.5" xref="S3.E1.m1.6.6.2.2.1.5.cmml">−</mo><mrow id="S3.E1.m1.6.6.2.2.1.4.2" xref="S3.E1.m1.6.6.2.2.1.4.3.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.4.2.3" xref="S3.E1.m1.6.6.2.2.1.4.3.cmml">⟨</mo><mrow id="S3.E1.m1.6.6.2.2.1.3.1.1.2" xref="S3.E1.m1.6.6.2.2.1.3.1.1.3.cmml"><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">min</mi><mo id="S3.E1.m1.6.6.2.2.1.3.1.1.2a" xref="S3.E1.m1.6.6.2.2.1.3.1.1.3.cmml">⁡</mo><mrow id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2" xref="S3.E1.m1.6.6.2.2.1.3.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.3" xref="S3.E1.m1.6.6.2.2.1.3.1.1.3.cmml">(</mo><msub id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.cmml"><mover accent="true" id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.2" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.2.cmml">A</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.1" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.3" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.4" xref="S3.E1.m1.6.6.2.2.1.3.1.1.3.cmml">,</mo><msub id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.cmml"><mover accent="true" id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.cmml"><mi id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.2" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.2.cmml">U</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.1" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.3" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.5" xref="S3.E1.m1.6.6.2.2.1.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.2.2.1.4.2.4" xref="S3.E1.m1.6.6.2.2.1.4.3.cmml">,</mo><mrow id="S3.E1.m1.6.6.2.2.1.4.2.2.1" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.4.2.2.1.2" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.cmml">(</mo><mrow id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.cmml"><msub id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.cmml"><mover accent="true" id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.cmml"><mi id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.2" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.2.cmml">e</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.1" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.1.cmml">→</mo></mover><mi id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.3" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.3.cmml">b</mi></msub><mo id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.1" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.1.cmml">+</mo><msub id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.cmml"><mover accent="true" id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.cmml"><mi id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.2" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.2.cmml">u</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.1" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.1.cmml">→</mo></mover><mo id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.3" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.3.cmml">−</mo></msub></mrow><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.4.2.2.1.3" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.4.2.5" xref="S3.E1.m1.6.6.2.2.1.4.3.cmml">⟩</mo></mrow></mrow><mo id="S3.E1.m1.6.6.2.2.3" xref="S3.E1.m1.6.6.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.3.cmml" xref="S3.E1.m1.6.6.2"><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1">subscript</csymbol><apply id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"><times id="S3.E1.m1.5.5.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.1"></times><ci id="S3.E1.m1.5.5.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2">arg</ci><ci id="S3.E1.m1.5.5.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.3">max</ci></apply><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"><ci id="S3.E1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2.1">→</ci><ci id="S3.E1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2">𝑢</ci></apply><plus id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3"></plus></apply><apply id="S3.E1.m1.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><ci id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.1">→</ci><ci id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2">𝑢</ci></apply><minus id="S3.E1.m1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.3"></minus></apply></list></apply><apply id="S3.E1.m1.6.6.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1"><minus id="S3.E1.m1.6.6.2.2.1.5.cmml" xref="S3.E1.m1.6.6.2.2.1.5"></minus><list id="S3.E1.m1.6.6.2.2.1.2.3.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2"><apply id="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2"><max id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"></max><apply id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2"><ci id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.1">→</ci><ci id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.2.2">𝐴</ci></apply><ci id="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2">subscript</csymbol><apply id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2"><ci id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.1">→</ci><ci id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.2.2">𝑈</ci></apply><ci id="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.2.2.3">𝑠</ci></apply></apply><apply id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1"><plus id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.1"></plus><apply id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2">subscript</csymbol><apply id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2"><ci id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.1">→</ci><ci id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.2.2">𝑒</ci></apply><ci id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.3.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.2.3">𝑠</ci></apply><apply id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3">subscript</csymbol><apply id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2"><ci id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.1">→</ci><ci id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.2.2">𝑢</ci></apply><plus id="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.3.cmml" xref="S3.E1.m1.6.6.2.2.1.2.2.2.1.1.3.3"></plus></apply></apply></list><list id="S3.E1.m1.6.6.2.2.1.4.3.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2"><apply id="S3.E1.m1.6.6.2.2.1.3.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2"><min id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"></min><apply id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1">subscript</csymbol><apply id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2"><ci id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.1">→</ci><ci id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.2.2">𝐴</ci></apply><ci id="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.1.1.1.3">𝑏</ci></apply><apply id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2">subscript</csymbol><apply id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2"><ci id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.1">→</ci><ci id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.2.2">𝑈</ci></apply><ci id="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.1.3.1.1.2.2.2.3">𝑠</ci></apply></apply><apply id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1"><plus id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.1.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.1"></plus><apply id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2">subscript</csymbol><apply id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2"><ci id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.1">→</ci><ci id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.2.2">𝑒</ci></apply><ci id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.3.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.2.3">𝑏</ci></apply><apply id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.1.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3">subscript</csymbol><apply id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2"><ci id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.1.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.1">→</ci><ci id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.2.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.2.2">𝑢</ci></apply><minus id="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.3.cmml" xref="S3.E1.m1.6.6.2.2.1.4.2.2.1.1.3.3"></minus></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">\operatorname*{arg\,max}_{\vec{u}_{+},\vec{u}_{-}}\left[\langle\max(\vec{A}_{s},\vec{U}_{s}),(\vec{e}_{s}+\vec{u}_{+})\rangle-\langle\min(\vec{A}_{b},\vec{U}_{s}),(\vec{e}_{b}+\vec{u}_{-})\rangle\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.2" class="ltx_p">Where <math id="S3.SS1.p3.1.m1.2" class="ltx_Math" alttext="\vec{e}_{s},\vec{e}_{b}" display="inline"><semantics id="S3.SS1.p3.1.m1.2a"><mrow id="S3.SS1.p3.1.m1.2.2.2" xref="S3.SS1.p3.1.m1.2.2.3.cmml"><msub id="S3.SS1.p3.1.m1.1.1.1.1" xref="S3.SS1.p3.1.m1.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p3.1.m1.1.1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.1.1.2.cmml"><mi id="S3.SS1.p3.1.m1.1.1.1.1.2.2" xref="S3.SS1.p3.1.m1.1.1.1.1.2.2.cmml">e</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.1.1.1.1.2.1" xref="S3.SS1.p3.1.m1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS1.p3.1.m1.1.1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS1.p3.1.m1.2.2.2.3" xref="S3.SS1.p3.1.m1.2.2.3.cmml">,</mo><msub id="S3.SS1.p3.1.m1.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.2.cmml"><mover accent="true" id="S3.SS1.p3.1.m1.2.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS1.p3.1.m1.2.2.2.2.2.2" xref="S3.SS1.p3.1.m1.2.2.2.2.2.2.cmml">e</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.2.2.2.2.2.1" xref="S3.SS1.p3.1.m1.2.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.SS1.p3.1.m1.2.2.2.2.3" xref="S3.SS1.p3.1.m1.2.2.2.2.3.cmml">b</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.2b"><list id="S3.SS1.p3.1.m1.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2"><apply id="S3.SS1.p3.1.m1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2"><ci id="S3.SS1.p3.1.m1.1.1.1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.1">→</ci><ci id="S3.SS1.p3.1.m1.1.1.1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.2.2">𝑒</ci></apply><ci id="S3.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.p3.1.m1.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.2.2.2.2.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2"><ci id="S3.SS1.p3.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.1">→</ci><ci id="S3.SS1.p3.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.2.2">𝑒</ci></apply><ci id="S3.SS1.p3.1.m1.2.2.2.2.3.cmml" xref="S3.SS1.p3.1.m1.2.2.2.2.3">𝑏</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.2c">\vec{e}_{s},\vec{e}_{b}</annotation></semantics></math> are inflexible energy generation and consumption, respectively, of the prosumers, and <math id="S3.SS1.p3.2.m2.2" class="ltx_Math" alttext="\langle a,b\rangle" display="inline"><semantics id="S3.SS1.p3.2.m2.2a"><mrow id="S3.SS1.p3.2.m2.2.3.2" xref="S3.SS1.p3.2.m2.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p3.2.m2.2.3.2.1" xref="S3.SS1.p3.2.m2.2.3.1.cmml">⟨</mo><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">a</mi><mo id="S3.SS1.p3.2.m2.2.3.2.2" xref="S3.SS1.p3.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS1.p3.2.m2.2.2" xref="S3.SS1.p3.2.m2.2.2.cmml">b</mi><mo stretchy="false" id="S3.SS1.p3.2.m2.2.3.2.3" xref="S3.SS1.p3.2.m2.2.3.1.cmml">⟩</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.2b"><list id="S3.SS1.p3.2.m2.2.3.1.cmml" xref="S3.SS1.p3.2.m2.2.3.2"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑎</ci><ci id="S3.SS1.p3.2.m2.2.2.cmml" xref="S3.SS1.p3.2.m2.2.2">𝑏</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.2c">\langle a,b\rangle</annotation></semantics></math> is a dot product. Please note that every vector here may be considered a 24 hour vector, and that opposing actions are exclusive (i.e. sell and buy, or charge and discharge.) Thus, entries in the sell vector in which the prosumer is buying are represented by 0’s.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.5" class="ltx_p">In an environment with this collection of prosumers, the RL agent solves an MDP defined by state space <math id="S3.SS1.p4.1.m1.9" class="ltx_Math" alttext="S:=(\vec{U}_{s},\vec{U}_{b},\vec{g},\vec{e}_{b,t-1},\vec{e}_{s,t-1})\in\mathbb{R}^{24+24+24+24+24}" display="inline"><semantics id="S3.SS1.p4.1.m1.9a"><mrow id="S3.SS1.p4.1.m1.9.9" xref="S3.SS1.p4.1.m1.9.9.cmml"><mi id="S3.SS1.p4.1.m1.9.9.6" xref="S3.SS1.p4.1.m1.9.9.6.cmml">S</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p4.1.m1.9.9.7" xref="S3.SS1.p4.1.m1.9.9.7.cmml">:=</mo><mrow id="S3.SS1.p4.1.m1.9.9.4.4" xref="S3.SS1.p4.1.m1.9.9.4.5.cmml"><mo stretchy="false" id="S3.SS1.p4.1.m1.9.9.4.4.5" xref="S3.SS1.p4.1.m1.9.9.4.5.cmml">(</mo><msub id="S3.SS1.p4.1.m1.6.6.1.1.1" xref="S3.SS1.p4.1.m1.6.6.1.1.1.cmml"><mover accent="true" id="S3.SS1.p4.1.m1.6.6.1.1.1.2" xref="S3.SS1.p4.1.m1.6.6.1.1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.6.6.1.1.1.2.2" xref="S3.SS1.p4.1.m1.6.6.1.1.1.2.2.cmml">U</mi><mo stretchy="false" id="S3.SS1.p4.1.m1.6.6.1.1.1.2.1" xref="S3.SS1.p4.1.m1.6.6.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS1.p4.1.m1.6.6.1.1.1.3" xref="S3.SS1.p4.1.m1.6.6.1.1.1.3.cmml">s</mi></msub><mo id="S3.SS1.p4.1.m1.9.9.4.4.6" xref="S3.SS1.p4.1.m1.9.9.4.5.cmml">,</mo><msub id="S3.SS1.p4.1.m1.7.7.2.2.2" xref="S3.SS1.p4.1.m1.7.7.2.2.2.cmml"><mover accent="true" id="S3.SS1.p4.1.m1.7.7.2.2.2.2" xref="S3.SS1.p4.1.m1.7.7.2.2.2.2.cmml"><mi id="S3.SS1.p4.1.m1.7.7.2.2.2.2.2" xref="S3.SS1.p4.1.m1.7.7.2.2.2.2.2.cmml">U</mi><mo stretchy="false" id="S3.SS1.p4.1.m1.7.7.2.2.2.2.1" xref="S3.SS1.p4.1.m1.7.7.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.SS1.p4.1.m1.7.7.2.2.2.3" xref="S3.SS1.p4.1.m1.7.7.2.2.2.3.cmml">b</mi></msub><mo id="S3.SS1.p4.1.m1.9.9.4.4.7" xref="S3.SS1.p4.1.m1.9.9.4.5.cmml">,</mo><mover accent="true" id="S3.SS1.p4.1.m1.5.5" xref="S3.SS1.p4.1.m1.5.5.cmml"><mi id="S3.SS1.p4.1.m1.5.5.2" xref="S3.SS1.p4.1.m1.5.5.2.cmml">g</mi><mo stretchy="false" id="S3.SS1.p4.1.m1.5.5.1" xref="S3.SS1.p4.1.m1.5.5.1.cmml">→</mo></mover><mo id="S3.SS1.p4.1.m1.9.9.4.4.8" xref="S3.SS1.p4.1.m1.9.9.4.5.cmml">,</mo><msub id="S3.SS1.p4.1.m1.8.8.3.3.3" xref="S3.SS1.p4.1.m1.8.8.3.3.3.cmml"><mover accent="true" id="S3.SS1.p4.1.m1.8.8.3.3.3.2" xref="S3.SS1.p4.1.m1.8.8.3.3.3.2.cmml"><mi id="S3.SS1.p4.1.m1.8.8.3.3.3.2.2" xref="S3.SS1.p4.1.m1.8.8.3.3.3.2.2.cmml">e</mi><mo stretchy="false" id="S3.SS1.p4.1.m1.8.8.3.3.3.2.1" xref="S3.SS1.p4.1.m1.8.8.3.3.3.2.1.cmml">→</mo></mover><mrow id="S3.SS1.p4.1.m1.2.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.1.cmml">b</mi><mo id="S3.SS1.p4.1.m1.2.2.2.2.2" xref="S3.SS1.p4.1.m1.2.2.2.3.cmml">,</mo><mrow id="S3.SS1.p4.1.m1.2.2.2.2.1" xref="S3.SS1.p4.1.m1.2.2.2.2.1.cmml"><mi id="S3.SS1.p4.1.m1.2.2.2.2.1.2" xref="S3.SS1.p4.1.m1.2.2.2.2.1.2.cmml">t</mi><mo id="S3.SS1.p4.1.m1.2.2.2.2.1.1" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1.cmml">−</mo><mn id="S3.SS1.p4.1.m1.2.2.2.2.1.3" xref="S3.SS1.p4.1.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S3.SS1.p4.1.m1.9.9.4.4.9" xref="S3.SS1.p4.1.m1.9.9.4.5.cmml">,</mo><msub id="S3.SS1.p4.1.m1.9.9.4.4.4" xref="S3.SS1.p4.1.m1.9.9.4.4.4.cmml"><mover accent="true" id="S3.SS1.p4.1.m1.9.9.4.4.4.2" xref="S3.SS1.p4.1.m1.9.9.4.4.4.2.cmml"><mi id="S3.SS1.p4.1.m1.9.9.4.4.4.2.2" xref="S3.SS1.p4.1.m1.9.9.4.4.4.2.2.cmml">e</mi><mo stretchy="false" id="S3.SS1.p4.1.m1.9.9.4.4.4.2.1" xref="S3.SS1.p4.1.m1.9.9.4.4.4.2.1.cmml">→</mo></mover><mrow id="S3.SS1.p4.1.m1.4.4.2.2" xref="S3.SS1.p4.1.m1.4.4.2.3.cmml"><mi id="S3.SS1.p4.1.m1.3.3.1.1" xref="S3.SS1.p4.1.m1.3.3.1.1.cmml">s</mi><mo id="S3.SS1.p4.1.m1.4.4.2.2.2" xref="S3.SS1.p4.1.m1.4.4.2.3.cmml">,</mo><mrow id="S3.SS1.p4.1.m1.4.4.2.2.1" xref="S3.SS1.p4.1.m1.4.4.2.2.1.cmml"><mi id="S3.SS1.p4.1.m1.4.4.2.2.1.2" xref="S3.SS1.p4.1.m1.4.4.2.2.1.2.cmml">t</mi><mo id="S3.SS1.p4.1.m1.4.4.2.2.1.1" xref="S3.SS1.p4.1.m1.4.4.2.2.1.1.cmml">−</mo><mn id="S3.SS1.p4.1.m1.4.4.2.2.1.3" xref="S3.SS1.p4.1.m1.4.4.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo stretchy="false" id="S3.SS1.p4.1.m1.9.9.4.4.10" xref="S3.SS1.p4.1.m1.9.9.4.5.cmml">)</mo></mrow><mo id="S3.SS1.p4.1.m1.9.9.8" xref="S3.SS1.p4.1.m1.9.9.8.cmml">∈</mo><msup id="S3.SS1.p4.1.m1.9.9.9" xref="S3.SS1.p4.1.m1.9.9.9.cmml"><mi id="S3.SS1.p4.1.m1.9.9.9.2" xref="S3.SS1.p4.1.m1.9.9.9.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.1.m1.9.9.9.3" xref="S3.SS1.p4.1.m1.9.9.9.3.cmml"><mn id="S3.SS1.p4.1.m1.9.9.9.3.2" xref="S3.SS1.p4.1.m1.9.9.9.3.2.cmml">24</mn><mo id="S3.SS1.p4.1.m1.9.9.9.3.1" xref="S3.SS1.p4.1.m1.9.9.9.3.1.cmml">+</mo><mn id="S3.SS1.p4.1.m1.9.9.9.3.3" xref="S3.SS1.p4.1.m1.9.9.9.3.3.cmml">24</mn><mo id="S3.SS1.p4.1.m1.9.9.9.3.1a" xref="S3.SS1.p4.1.m1.9.9.9.3.1.cmml">+</mo><mn id="S3.SS1.p4.1.m1.9.9.9.3.4" xref="S3.SS1.p4.1.m1.9.9.9.3.4.cmml">24</mn><mo id="S3.SS1.p4.1.m1.9.9.9.3.1b" xref="S3.SS1.p4.1.m1.9.9.9.3.1.cmml">+</mo><mn id="S3.SS1.p4.1.m1.9.9.9.3.5" xref="S3.SS1.p4.1.m1.9.9.9.3.5.cmml">24</mn><mo id="S3.SS1.p4.1.m1.9.9.9.3.1c" xref="S3.SS1.p4.1.m1.9.9.9.3.1.cmml">+</mo><mn id="S3.SS1.p4.1.m1.9.9.9.3.6" xref="S3.SS1.p4.1.m1.9.9.9.3.6.cmml">24</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.9b"><apply id="S3.SS1.p4.1.m1.9.9.cmml" xref="S3.SS1.p4.1.m1.9.9"><and id="S3.SS1.p4.1.m1.9.9a.cmml" xref="S3.SS1.p4.1.m1.9.9"></and><apply id="S3.SS1.p4.1.m1.9.9b.cmml" xref="S3.SS1.p4.1.m1.9.9"><csymbol cd="latexml" id="S3.SS1.p4.1.m1.9.9.7.cmml" xref="S3.SS1.p4.1.m1.9.9.7">assign</csymbol><ci id="S3.SS1.p4.1.m1.9.9.6.cmml" xref="S3.SS1.p4.1.m1.9.9.6">𝑆</ci><vector id="S3.SS1.p4.1.m1.9.9.4.5.cmml" xref="S3.SS1.p4.1.m1.9.9.4.4"><apply id="S3.SS1.p4.1.m1.6.6.1.1.1.cmml" xref="S3.SS1.p4.1.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.6.6.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.6.6.1.1.1">subscript</csymbol><apply id="S3.SS1.p4.1.m1.6.6.1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.6.6.1.1.1.2"><ci id="S3.SS1.p4.1.m1.6.6.1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.6.6.1.1.1.2.1">→</ci><ci id="S3.SS1.p4.1.m1.6.6.1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.6.6.1.1.1.2.2">𝑈</ci></apply><ci id="S3.SS1.p4.1.m1.6.6.1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.6.6.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.p4.1.m1.7.7.2.2.2.cmml" xref="S3.SS1.p4.1.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.7.7.2.2.2.1.cmml" xref="S3.SS1.p4.1.m1.7.7.2.2.2">subscript</csymbol><apply id="S3.SS1.p4.1.m1.7.7.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.7.7.2.2.2.2"><ci id="S3.SS1.p4.1.m1.7.7.2.2.2.2.1.cmml" xref="S3.SS1.p4.1.m1.7.7.2.2.2.2.1">→</ci><ci id="S3.SS1.p4.1.m1.7.7.2.2.2.2.2.cmml" xref="S3.SS1.p4.1.m1.7.7.2.2.2.2.2">𝑈</ci></apply><ci id="S3.SS1.p4.1.m1.7.7.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.7.7.2.2.2.3">𝑏</ci></apply><apply id="S3.SS1.p4.1.m1.5.5.cmml" xref="S3.SS1.p4.1.m1.5.5"><ci id="S3.SS1.p4.1.m1.5.5.1.cmml" xref="S3.SS1.p4.1.m1.5.5.1">→</ci><ci id="S3.SS1.p4.1.m1.5.5.2.cmml" xref="S3.SS1.p4.1.m1.5.5.2">𝑔</ci></apply><apply id="S3.SS1.p4.1.m1.8.8.3.3.3.cmml" xref="S3.SS1.p4.1.m1.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.8.8.3.3.3.1.cmml" xref="S3.SS1.p4.1.m1.8.8.3.3.3">subscript</csymbol><apply id="S3.SS1.p4.1.m1.8.8.3.3.3.2.cmml" xref="S3.SS1.p4.1.m1.8.8.3.3.3.2"><ci id="S3.SS1.p4.1.m1.8.8.3.3.3.2.1.cmml" xref="S3.SS1.p4.1.m1.8.8.3.3.3.2.1">→</ci><ci id="S3.SS1.p4.1.m1.8.8.3.3.3.2.2.cmml" xref="S3.SS1.p4.1.m1.8.8.3.3.3.2.2">𝑒</ci></apply><list id="S3.SS1.p4.1.m1.2.2.2.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2"><ci id="S3.SS1.p4.1.m1.1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1.1">𝑏</ci><apply id="S3.SS1.p4.1.m1.2.2.2.2.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1"><minus id="S3.SS1.p4.1.m1.2.2.2.2.1.1.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.1"></minus><ci id="S3.SS1.p4.1.m1.2.2.2.2.1.2.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p4.1.m1.2.2.2.2.1.3.cmml" xref="S3.SS1.p4.1.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="S3.SS1.p4.1.m1.9.9.4.4.4.cmml" xref="S3.SS1.p4.1.m1.9.9.4.4.4"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.9.9.4.4.4.1.cmml" xref="S3.SS1.p4.1.m1.9.9.4.4.4">subscript</csymbol><apply id="S3.SS1.p4.1.m1.9.9.4.4.4.2.cmml" xref="S3.SS1.p4.1.m1.9.9.4.4.4.2"><ci id="S3.SS1.p4.1.m1.9.9.4.4.4.2.1.cmml" xref="S3.SS1.p4.1.m1.9.9.4.4.4.2.1">→</ci><ci id="S3.SS1.p4.1.m1.9.9.4.4.4.2.2.cmml" xref="S3.SS1.p4.1.m1.9.9.4.4.4.2.2">𝑒</ci></apply><list id="S3.SS1.p4.1.m1.4.4.2.3.cmml" xref="S3.SS1.p4.1.m1.4.4.2.2"><ci id="S3.SS1.p4.1.m1.3.3.1.1.cmml" xref="S3.SS1.p4.1.m1.3.3.1.1">𝑠</ci><apply id="S3.SS1.p4.1.m1.4.4.2.2.1.cmml" xref="S3.SS1.p4.1.m1.4.4.2.2.1"><minus id="S3.SS1.p4.1.m1.4.4.2.2.1.1.cmml" xref="S3.SS1.p4.1.m1.4.4.2.2.1.1"></minus><ci id="S3.SS1.p4.1.m1.4.4.2.2.1.2.cmml" xref="S3.SS1.p4.1.m1.4.4.2.2.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p4.1.m1.4.4.2.2.1.3.cmml" xref="S3.SS1.p4.1.m1.4.4.2.2.1.3">1</cn></apply></list></apply></vector></apply><apply id="S3.SS1.p4.1.m1.9.9c.cmml" xref="S3.SS1.p4.1.m1.9.9"><in id="S3.SS1.p4.1.m1.9.9.8.cmml" xref="S3.SS1.p4.1.m1.9.9.8"></in><share href="#S3.SS1.p4.1.m1.9.9.4.cmml" id="S3.SS1.p4.1.m1.9.9d.cmml" xref="S3.SS1.p4.1.m1.9.9"></share><apply id="S3.SS1.p4.1.m1.9.9.9.cmml" xref="S3.SS1.p4.1.m1.9.9.9"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.9.9.9.1.cmml" xref="S3.SS1.p4.1.m1.9.9.9">superscript</csymbol><ci id="S3.SS1.p4.1.m1.9.9.9.2.cmml" xref="S3.SS1.p4.1.m1.9.9.9.2">ℝ</ci><apply id="S3.SS1.p4.1.m1.9.9.9.3.cmml" xref="S3.SS1.p4.1.m1.9.9.9.3"><plus id="S3.SS1.p4.1.m1.9.9.9.3.1.cmml" xref="S3.SS1.p4.1.m1.9.9.9.3.1"></plus><cn type="integer" id="S3.SS1.p4.1.m1.9.9.9.3.2.cmml" xref="S3.SS1.p4.1.m1.9.9.9.3.2">24</cn><cn type="integer" id="S3.SS1.p4.1.m1.9.9.9.3.3.cmml" xref="S3.SS1.p4.1.m1.9.9.9.3.3">24</cn><cn type="integer" id="S3.SS1.p4.1.m1.9.9.9.3.4.cmml" xref="S3.SS1.p4.1.m1.9.9.9.3.4">24</cn><cn type="integer" id="S3.SS1.p4.1.m1.9.9.9.3.5.cmml" xref="S3.SS1.p4.1.m1.9.9.9.3.5">24</cn><cn type="integer" id="S3.SS1.p4.1.m1.9.9.9.3.6.cmml" xref="S3.SS1.p4.1.m1.9.9.9.3.6">24</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.9c">S:=(\vec{U}_{s},\vec{U}_{b},\vec{g},\vec{e}_{b,t-1},\vec{e}_{s,t-1})\in\mathbb{R}^{24+24+24+24+24}</annotation></semantics></math>, where <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="\vec{g}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mover accent="true" id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">g</mi><mo stretchy="false" id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">→</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><ci id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1">→</ci><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">\vec{g}</annotation></semantics></math> is the day’s solar prediction<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The day’s solar predictions are simply read from a csv.</span></span></span> and the <math id="S3.SS1.p4.3.m3.2" class="ltx_Math" alttext="\vec{e}_{b/s,t-1}" display="inline"><semantics id="S3.SS1.p4.3.m3.2a"><msub id="S3.SS1.p4.3.m3.2.3" xref="S3.SS1.p4.3.m3.2.3.cmml"><mover accent="true" id="S3.SS1.p4.3.m3.2.3.2" xref="S3.SS1.p4.3.m3.2.3.2.cmml"><mi id="S3.SS1.p4.3.m3.2.3.2.2" xref="S3.SS1.p4.3.m3.2.3.2.2.cmml">e</mi><mo stretchy="false" id="S3.SS1.p4.3.m3.2.3.2.1" xref="S3.SS1.p4.3.m3.2.3.2.1.cmml">→</mo></mover><mrow id="S3.SS1.p4.3.m3.2.2.2.2" xref="S3.SS1.p4.3.m3.2.2.2.3.cmml"><mrow id="S3.SS1.p4.3.m3.1.1.1.1.1" xref="S3.SS1.p4.3.m3.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.3.m3.1.1.1.1.1.2" xref="S3.SS1.p4.3.m3.1.1.1.1.1.2.cmml">b</mi><mo id="S3.SS1.p4.3.m3.1.1.1.1.1.1" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1.cmml">/</mo><mi id="S3.SS1.p4.3.m3.1.1.1.1.1.3" xref="S3.SS1.p4.3.m3.1.1.1.1.1.3.cmml">s</mi></mrow><mo id="S3.SS1.p4.3.m3.2.2.2.2.3" xref="S3.SS1.p4.3.m3.2.2.2.3.cmml">,</mo><mrow id="S3.SS1.p4.3.m3.2.2.2.2.2" xref="S3.SS1.p4.3.m3.2.2.2.2.2.cmml"><mi id="S3.SS1.p4.3.m3.2.2.2.2.2.2" xref="S3.SS1.p4.3.m3.2.2.2.2.2.2.cmml">t</mi><mo id="S3.SS1.p4.3.m3.2.2.2.2.2.1" xref="S3.SS1.p4.3.m3.2.2.2.2.2.1.cmml">−</mo><mn id="S3.SS1.p4.3.m3.2.2.2.2.2.3" xref="S3.SS1.p4.3.m3.2.2.2.2.2.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.2b"><apply id="S3.SS1.p4.3.m3.2.3.cmml" xref="S3.SS1.p4.3.m3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.2.3.1.cmml" xref="S3.SS1.p4.3.m3.2.3">subscript</csymbol><apply id="S3.SS1.p4.3.m3.2.3.2.cmml" xref="S3.SS1.p4.3.m3.2.3.2"><ci id="S3.SS1.p4.3.m3.2.3.2.1.cmml" xref="S3.SS1.p4.3.m3.2.3.2.1">→</ci><ci id="S3.SS1.p4.3.m3.2.3.2.2.cmml" xref="S3.SS1.p4.3.m3.2.3.2.2">𝑒</ci></apply><list id="S3.SS1.p4.3.m3.2.2.2.3.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2"><apply id="S3.SS1.p4.3.m3.1.1.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1"><divide id="S3.SS1.p4.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1"></divide><ci id="S3.SS1.p4.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1.2">𝑏</ci><ci id="S3.SS1.p4.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.SS1.p4.3.m3.2.2.2.2.2.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.2"><minus id="S3.SS1.p4.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.2.1"></minus><ci id="S3.SS1.p4.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.2.2">𝑡</ci><cn type="integer" id="S3.SS1.p4.3.m3.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.3.m3.2.2.2.2.2.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.2c">\vec{e}_{b/s,t-1}</annotation></semantics></math> are prosumer buying and selling energy from the previous day. The RL controller emits actions <math id="S3.SS1.p4.4.m4.2" class="ltx_Math" alttext="A:=(\vec{A}_{b},\vec{A}_{s})" display="inline"><semantics id="S3.SS1.p4.4.m4.2a"><mrow id="S3.SS1.p4.4.m4.2.2" xref="S3.SS1.p4.4.m4.2.2.cmml"><mi id="S3.SS1.p4.4.m4.2.2.4" xref="S3.SS1.p4.4.m4.2.2.4.cmml">A</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p4.4.m4.2.2.3" xref="S3.SS1.p4.4.m4.2.2.3.cmml">:=</mo><mrow id="S3.SS1.p4.4.m4.2.2.2.2" xref="S3.SS1.p4.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p4.4.m4.2.2.2.2.3" xref="S3.SS1.p4.4.m4.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p4.4.m4.1.1.1.1.1" xref="S3.SS1.p4.4.m4.1.1.1.1.1.cmml"><mover accent="true" id="S3.SS1.p4.4.m4.1.1.1.1.1.2" xref="S3.SS1.p4.4.m4.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p4.4.m4.1.1.1.1.1.2.2" xref="S3.SS1.p4.4.m4.1.1.1.1.1.2.2.cmml">A</mi><mo stretchy="false" id="S3.SS1.p4.4.m4.1.1.1.1.1.2.1" xref="S3.SS1.p4.4.m4.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.SS1.p4.4.m4.1.1.1.1.1.3" xref="S3.SS1.p4.4.m4.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.SS1.p4.4.m4.2.2.2.2.4" xref="S3.SS1.p4.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p4.4.m4.2.2.2.2.2" xref="S3.SS1.p4.4.m4.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS1.p4.4.m4.2.2.2.2.2.2" xref="S3.SS1.p4.4.m4.2.2.2.2.2.2.cmml"><mi id="S3.SS1.p4.4.m4.2.2.2.2.2.2.2" xref="S3.SS1.p4.4.m4.2.2.2.2.2.2.2.cmml">A</mi><mo stretchy="false" id="S3.SS1.p4.4.m4.2.2.2.2.2.2.1" xref="S3.SS1.p4.4.m4.2.2.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.SS1.p4.4.m4.2.2.2.2.2.3" xref="S3.SS1.p4.4.m4.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS1.p4.4.m4.2.2.2.2.5" xref="S3.SS1.p4.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.2b"><apply id="S3.SS1.p4.4.m4.2.2.cmml" xref="S3.SS1.p4.4.m4.2.2"><csymbol cd="latexml" id="S3.SS1.p4.4.m4.2.2.3.cmml" xref="S3.SS1.p4.4.m4.2.2.3">assign</csymbol><ci id="S3.SS1.p4.4.m4.2.2.4.cmml" xref="S3.SS1.p4.4.m4.2.2.4">𝐴</ci><interval closure="open" id="S3.SS1.p4.4.m4.2.2.2.3.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2"><apply id="S3.SS1.p4.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p4.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.2"><ci id="S3.SS1.p4.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.2.1">→</ci><ci id="S3.SS1.p4.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.2.2">𝐴</ci></apply><ci id="S3.SS1.p4.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.4.m4.1.1.1.1.1.3">𝑏</ci></apply><apply id="S3.SS1.p4.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p4.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.2.2"><ci id="S3.SS1.p4.4.m4.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.2.2.1">→</ci><ci id="S3.SS1.p4.4.m4.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.2.2.2">𝐴</ci></apply><ci id="S3.SS1.p4.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS1.p4.4.m4.2.2.2.2.2.3">𝑠</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.2c">A:=(\vec{A}_{b},\vec{A}_{s})</annotation></semantics></math> <math id="S3.SS1.p4.5.m5.1" class="ltx_Math" alttext="\in\mathbb{R}^{24+24}" display="inline"><semantics id="S3.SS1.p4.5.m5.1a"><mrow id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml"><mi id="S3.SS1.p4.5.m5.1.1.2" xref="S3.SS1.p4.5.m5.1.1.2.cmml"></mi><mo id="S3.SS1.p4.5.m5.1.1.1" xref="S3.SS1.p4.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.5.m5.1.1.3" xref="S3.SS1.p4.5.m5.1.1.3.cmml"><mi id="S3.SS1.p4.5.m5.1.1.3.2" xref="S3.SS1.p4.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.5.m5.1.1.3.3" xref="S3.SS1.p4.5.m5.1.1.3.3.cmml"><mn id="S3.SS1.p4.5.m5.1.1.3.3.2" xref="S3.SS1.p4.5.m5.1.1.3.3.2.cmml">24</mn><mo id="S3.SS1.p4.5.m5.1.1.3.3.1" xref="S3.SS1.p4.5.m5.1.1.3.3.1.cmml">+</mo><mn id="S3.SS1.p4.5.m5.1.1.3.3.3" xref="S3.SS1.p4.5.m5.1.1.3.3.3.cmml">24</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><apply id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1"><in id="S3.SS1.p4.5.m5.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1"></in><csymbol cd="latexml" id="S3.SS1.p4.5.m5.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2">absent</csymbol><apply id="S3.SS1.p4.5.m5.1.1.3.cmml" xref="S3.SS1.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.5.m5.1.1.3.1.cmml" xref="S3.SS1.p4.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.5.m5.1.1.3.2.cmml" xref="S3.SS1.p4.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.5.m5.1.1.3.3.cmml" xref="S3.SS1.p4.5.m5.1.1.3.3"><plus id="S3.SS1.p4.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p4.5.m5.1.1.3.3.1"></plus><cn type="integer" id="S3.SS1.p4.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p4.5.m5.1.1.3.3.2">24</cn><cn type="integer" id="S3.SS1.p4.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p4.5.m5.1.1.3.3.3">24</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">\in\mathbb{R}^{24+24}</annotation></semantics></math>. The agent seeks to maximize a reward defined by its individual profit, i.e.:</p>
</div>
<div id="S3.SS1.p5" class="ltx_para ltx_noindent">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\operatorname*{arg\,max}_{\vec{A}_{b},\vec{A}_{s}}\left[\langle\vec{A}_{b},\vec{E}_{b}\rangle-\langle\vec{A}_{s},\vec{E}_{s}\rangle\right]" display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.3.cmml"><munder id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1.2" xref="S3.E2.m1.3.3.1.1.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E2.m1.3.3.1.1.2.1" xref="S3.E2.m1.3.3.1.1.2.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">max</mi></mrow><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml"><msub id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.1.2.2" xref="S3.E2.m1.1.1.1.1.1.2.2.cmml">A</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.2.1" xref="S3.E2.m1.1.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><msub id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.cmml"><mover accent="true" id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.2.cmml">A</mi><mo stretchy="false" id="S3.E2.m1.2.2.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml">s</mi></msub></mrow></munder><mo id="S3.E2.m1.4.4.2a" xref="S3.E2.m1.4.4.3.cmml">⁡</mo><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.3.cmml"><mo id="S3.E2.m1.4.4.2.2.2" xref="S3.E2.m1.4.4.3.cmml">[</mo><mrow id="S3.E2.m1.4.4.2.2.1" xref="S3.E2.m1.4.4.2.2.1.cmml"><mrow id="S3.E2.m1.4.4.2.2.1.2.2" xref="S3.E2.m1.4.4.2.2.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.2.2.1.2.2.3" xref="S3.E2.m1.4.4.2.2.1.2.3.cmml">⟨</mo><msub id="S3.E2.m1.4.4.2.2.1.1.1.1" xref="S3.E2.m1.4.4.2.2.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.4.4.2.2.1.1.1.1.2" xref="S3.E2.m1.4.4.2.2.1.1.1.1.2.cmml"><mi id="S3.E2.m1.4.4.2.2.1.1.1.1.2.2" xref="S3.E2.m1.4.4.2.2.1.1.1.1.2.2.cmml">A</mi><mo stretchy="false" id="S3.E2.m1.4.4.2.2.1.1.1.1.2.1" xref="S3.E2.m1.4.4.2.2.1.1.1.1.2.1.cmml">→</mo></mover><mi id="S3.E2.m1.4.4.2.2.1.1.1.1.3" xref="S3.E2.m1.4.4.2.2.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.E2.m1.4.4.2.2.1.2.2.4" xref="S3.E2.m1.4.4.2.2.1.2.3.cmml">,</mo><msub id="S3.E2.m1.4.4.2.2.1.2.2.2" xref="S3.E2.m1.4.4.2.2.1.2.2.2.cmml"><mover accent="true" id="S3.E2.m1.4.4.2.2.1.2.2.2.2" xref="S3.E2.m1.4.4.2.2.1.2.2.2.2.cmml"><mi id="S3.E2.m1.4.4.2.2.1.2.2.2.2.2" xref="S3.E2.m1.4.4.2.2.1.2.2.2.2.2.cmml">E</mi><mo stretchy="false" id="S3.E2.m1.4.4.2.2.1.2.2.2.2.1" xref="S3.E2.m1.4.4.2.2.1.2.2.2.2.1.cmml">→</mo></mover><mi id="S3.E2.m1.4.4.2.2.1.2.2.2.3" xref="S3.E2.m1.4.4.2.2.1.2.2.2.3.cmml">b</mi></msub><mo stretchy="false" id="S3.E2.m1.4.4.2.2.1.2.2.5" xref="S3.E2.m1.4.4.2.2.1.2.3.cmml">⟩</mo></mrow><mo id="S3.E2.m1.4.4.2.2.1.5" xref="S3.E2.m1.4.4.2.2.1.5.cmml">−</mo><mrow id="S3.E2.m1.4.4.2.2.1.4.2" xref="S3.E2.m1.4.4.2.2.1.4.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.2.2.1.4.2.3" xref="S3.E2.m1.4.4.2.2.1.4.3.cmml">⟨</mo><msub id="S3.E2.m1.4.4.2.2.1.3.1.1" xref="S3.E2.m1.4.4.2.2.1.3.1.1.cmml"><mover accent="true" id="S3.E2.m1.4.4.2.2.1.3.1.1.2" xref="S3.E2.m1.4.4.2.2.1.3.1.1.2.cmml"><mi id="S3.E2.m1.4.4.2.2.1.3.1.1.2.2" xref="S3.E2.m1.4.4.2.2.1.3.1.1.2.2.cmml">A</mi><mo stretchy="false" id="S3.E2.m1.4.4.2.2.1.3.1.1.2.1" xref="S3.E2.m1.4.4.2.2.1.3.1.1.2.1.cmml">→</mo></mover><mi id="S3.E2.m1.4.4.2.2.1.3.1.1.3" xref="S3.E2.m1.4.4.2.2.1.3.1.1.3.cmml">s</mi></msub><mo id="S3.E2.m1.4.4.2.2.1.4.2.4" xref="S3.E2.m1.4.4.2.2.1.4.3.cmml">,</mo><msub id="S3.E2.m1.4.4.2.2.1.4.2.2" xref="S3.E2.m1.4.4.2.2.1.4.2.2.cmml"><mover accent="true" id="S3.E2.m1.4.4.2.2.1.4.2.2.2" xref="S3.E2.m1.4.4.2.2.1.4.2.2.2.cmml"><mi id="S3.E2.m1.4.4.2.2.1.4.2.2.2.2" xref="S3.E2.m1.4.4.2.2.1.4.2.2.2.2.cmml">E</mi><mo stretchy="false" id="S3.E2.m1.4.4.2.2.1.4.2.2.2.1" xref="S3.E2.m1.4.4.2.2.1.4.2.2.2.1.cmml">→</mo></mover><mi id="S3.E2.m1.4.4.2.2.1.4.2.2.3" xref="S3.E2.m1.4.4.2.2.1.4.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E2.m1.4.4.2.2.1.4.2.5" xref="S3.E2.m1.4.4.2.2.1.4.3.cmml">⟩</mo></mrow></mrow><mo id="S3.E2.m1.4.4.2.2.3" xref="S3.E2.m1.4.4.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4.2"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1">subscript</csymbol><apply id="S3.E2.m1.3.3.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.2"><times id="S3.E2.m1.3.3.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.1"></times><ci id="S3.E2.m1.3.3.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2">arg</ci><ci id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.3">max</ci></apply><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"><ci id="S3.E2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.2.1">→</ci><ci id="S3.E2.m1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2.2">𝐴</ci></apply><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑏</ci></apply><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2">subscript</csymbol><apply id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"><ci id="S3.E2.m1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.2.1">→</ci><ci id="S3.E2.m1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2.2">𝐴</ci></apply><ci id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3">𝑠</ci></apply></list></apply><apply id="S3.E2.m1.4.4.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1"><minus id="S3.E2.m1.4.4.2.2.1.5.cmml" xref="S3.E2.m1.4.4.2.2.1.5"></minus><list id="S3.E2.m1.4.4.2.2.1.2.3.cmml" xref="S3.E2.m1.4.4.2.2.1.2.2"><apply id="S3.E2.m1.4.4.2.2.1.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.2"><ci id="S3.E2.m1.4.4.2.2.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.2.1">→</ci><ci id="S3.E2.m1.4.4.2.2.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.2.2">𝐴</ci></apply><ci id="S3.E2.m1.4.4.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.3">𝑏</ci></apply><apply id="S3.E2.m1.4.4.2.2.1.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.2.2.2">subscript</csymbol><apply id="S3.E2.m1.4.4.2.2.1.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.2.2.2.2"><ci id="S3.E2.m1.4.4.2.2.1.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.2.2.2.2.1">→</ci><ci id="S3.E2.m1.4.4.2.2.1.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.2.2.2.2.2">𝐸</ci></apply><ci id="S3.E2.m1.4.4.2.2.1.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.1.2.2.2.3">𝑏</ci></apply></list><list id="S3.E2.m1.4.4.2.2.1.4.3.cmml" xref="S3.E2.m1.4.4.2.2.1.4.2"><apply id="S3.E2.m1.4.4.2.2.1.3.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.3.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.3.1.1">subscript</csymbol><apply id="S3.E2.m1.4.4.2.2.1.3.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.1.3.1.1.2"><ci id="S3.E2.m1.4.4.2.2.1.3.1.1.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.3.1.1.2.1">→</ci><ci id="S3.E2.m1.4.4.2.2.1.3.1.1.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.3.1.1.2.2">𝐴</ci></apply><ci id="S3.E2.m1.4.4.2.2.1.3.1.1.3.cmml" xref="S3.E2.m1.4.4.2.2.1.3.1.1.3">𝑠</ci></apply><apply id="S3.E2.m1.4.4.2.2.1.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.4.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.4.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.4.2.2">subscript</csymbol><apply id="S3.E2.m1.4.4.2.2.1.4.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.4.2.2.2"><ci id="S3.E2.m1.4.4.2.2.1.4.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.4.2.2.2.1">→</ci><ci id="S3.E2.m1.4.4.2.2.1.4.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.4.2.2.2.2">𝐸</ci></apply><ci id="S3.E2.m1.4.4.2.2.1.4.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.1.4.2.2.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\operatorname*{arg\,max}_{\vec{A}_{b},\vec{A}_{s}}\left[\langle\vec{A}_{b},\vec{E}_{b}\rangle-\langle\vec{A}_{s},\vec{E}_{s}\rangle\right]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p6" class="ltx_para ltx_noindent">
<p id="S3.SS1.p6.2" class="ltx_p">We somewhat abuse the <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="\vec{E}" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mover accent="true" id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml"><mi id="S3.SS1.p6.1.m1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.2.cmml">E</mi><mo stretchy="false" id="S3.SS1.p6.1.m1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.cmml">→</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1"><ci id="S3.SS1.p6.1.m1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1">→</ci><ci id="S3.SS1.p6.1.m1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.2">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\vec{E}</annotation></semantics></math> notation to conveniently define <math id="S3.SS1.p6.2.m2.1" class="ltx_Math" alttext="\vec{E}_{b/s}" display="inline"><semantics id="S3.SS1.p6.2.m2.1a"><msub id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml"><mover accent="true" id="S3.SS1.p6.2.m2.1.1.2" xref="S3.SS1.p6.2.m2.1.1.2.cmml"><mi id="S3.SS1.p6.2.m2.1.1.2.2" xref="S3.SS1.p6.2.m2.1.1.2.2.cmml">E</mi><mo stretchy="false" id="S3.SS1.p6.2.m2.1.1.2.1" xref="S3.SS1.p6.2.m2.1.1.2.1.cmml">→</mo></mover><mrow id="S3.SS1.p6.2.m2.1.1.3" xref="S3.SS1.p6.2.m2.1.1.3.cmml"><mi id="S3.SS1.p6.2.m2.1.1.3.2" xref="S3.SS1.p6.2.m2.1.1.3.2.cmml">b</mi><mo id="S3.SS1.p6.2.m2.1.1.3.1" xref="S3.SS1.p6.2.m2.1.1.3.1.cmml">/</mo><mi id="S3.SS1.p6.2.m2.1.1.3.3" xref="S3.SS1.p6.2.m2.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><apply id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">subscript</csymbol><apply id="S3.SS1.p6.2.m2.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.2"><ci id="S3.SS1.p6.2.m2.1.1.2.1.cmml" xref="S3.SS1.p6.2.m2.1.1.2.1">→</ci><ci id="S3.SS1.p6.2.m2.1.1.2.2.cmml" xref="S3.SS1.p6.2.m2.1.1.2.2">𝐸</ci></apply><apply id="S3.SS1.p6.2.m2.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3"><divide id="S3.SS1.p6.2.m2.1.1.3.1.cmml" xref="S3.SS1.p6.2.m2.1.1.3.1"></divide><ci id="S3.SS1.p6.2.m2.1.1.3.2.cmml" xref="S3.SS1.p6.2.m2.1.1.3.2">𝑏</ci><ci id="S3.SS1.p6.2.m2.1.1.3.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">\vec{E}_{b/s}</annotation></semantics></math> as the total amount of energy bought from or sold to the RL agent hour to hour.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2210.06820/assets/figs/description.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="384" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span id="S3.F1.5.1" class="ltx_text ltx_font_bold">Microgrids and PFH:</span> <span id="S3.F1.6.2" class="ltx_text ltx_font_bold">A.</span> We imagine a prosumer that can, at each hour of the day, choose to sell energy surplus or purchase unmet energy demand from the larger utility or to the microgrid aggregator. The microgrid aggregator’s energy buy/sell prices are determined by an RL controller. <span id="S3.F1.7.3" class="ltx_text ltx_font_bold">B.</span> A Hypernetwork for Personalized Federated Learning (PFH) receives gradient updates from RL controllers and sends back weights. <span id="S3.F1.8.4" class="ltx_text ltx_font_bold">C.</span> The hypernetwork takes as input an environment embedding vector and outputs weights for an RL controller. The RL agent takes as input buy/sell prices from the utility and outputs buy/sell prices to the buildings in the microgrid the agent manages. The RL agent sends back a gradient update to the hypernetwork, which uses the update to compute the gradient update for the hypernetwork’s own weights. </figcaption>
</figure>
<div id="S3.SS1.p7" class="ltx_para ltx_noindent">
<p id="S3.SS1.p7.1" class="ltx_p">Because the agent is an aggregator that does not generate its own energy, the profit the agent generates comes from the difference in price between the energy it buys from prosumers at that timestep and the energy it sells to prosumers at that timestep. Any excess supply or demand is transacted with the energy utility. In this way, the environment neatly models a realistic transactive system.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Reinforcement Learning</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.1" class="ltx_p">We use Proximal Policy Optimization <cite class="ltx_cite ltx_citemacro_citep">(Schulman et al., <a href="#bib.bib19" title="" class="ltx_ref">2017</a>)</cite> (PPO), a popular actor-critic based algorithm, to train all of our RL agents to solve the MDP introduced in <a href="#S3.SS1" title="3.1 Learning environment ‣ 3 Methods ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> because PPO is reliable and highly performant. Note that both algorithms introduced in <a href="#S3.SS3" title="3.3 Federated Learning ‣ 3 Methods ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a> and <a href="#S3.SS4" title="3.4 Hypernetworks for Personalized Federated Learning (PFH) ‣ 3 Methods ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a> are agnostic to the architecture of the local policies, so one could use any gradient-based model.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Federated Learning</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.11" class="ltx_p">In order to learn a shared model between multiple microgrids in a privacy preserving manner, we turn to federated learning. <cite class="ltx_cite ltx_citemacro_citet">McMahan et al. (<a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite> presented what is now the most popular federated learning scheme: Federated Averaging (FedAvg). FedAvg is simple to implement. Denote the parameters for the policy for microgrid <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">i</annotation></semantics></math> at timestep <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">t</annotation></semantics></math> as <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\theta_{it}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">θ</mi><mrow id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.1.1.3.1" xref="S3.SS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝜃</ci><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><times id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.1"></times><ci id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">𝑖</ci><ci id="S3.SS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\theta_{it}</annotation></semantics></math>. All the <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\theta_{i0}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">θ</mi><mrow id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m4.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.3.1.cmml">​</mo><mn id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝜃</ci><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><times id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.1"></times><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\theta_{i0}</annotation></semantics></math> are initialized with the same weights, so <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\theta_{10}=\theta_{20}=...=\theta_{n0}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><msub id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml"><mi id="S3.SS3.p1.5.m5.1.1.2.2" xref="S3.SS3.p1.5.m5.1.1.2.2.cmml">θ</mi><mn id="S3.SS3.p1.5.m5.1.1.2.3" xref="S3.SS3.p1.5.m5.1.1.2.3.cmml">10</mn></msub><mo id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml">=</mo><msub id="S3.SS3.p1.5.m5.1.1.4" xref="S3.SS3.p1.5.m5.1.1.4.cmml"><mi id="S3.SS3.p1.5.m5.1.1.4.2" xref="S3.SS3.p1.5.m5.1.1.4.2.cmml">θ</mi><mn id="S3.SS3.p1.5.m5.1.1.4.3" xref="S3.SS3.p1.5.m5.1.1.4.3.cmml">20</mn></msub><mo id="S3.SS3.p1.5.m5.1.1.5" xref="S3.SS3.p1.5.m5.1.1.5.cmml">=</mo><mi mathvariant="normal" id="S3.SS3.p1.5.m5.1.1.6" xref="S3.SS3.p1.5.m5.1.1.6.cmml">…</mi><mo id="S3.SS3.p1.5.m5.1.1.7" xref="S3.SS3.p1.5.m5.1.1.7.cmml">=</mo><msub id="S3.SS3.p1.5.m5.1.1.8" xref="S3.SS3.p1.5.m5.1.1.8.cmml"><mi id="S3.SS3.p1.5.m5.1.1.8.2" xref="S3.SS3.p1.5.m5.1.1.8.2.cmml">θ</mi><mrow id="S3.SS3.p1.5.m5.1.1.8.3" xref="S3.SS3.p1.5.m5.1.1.8.3.cmml"><mi id="S3.SS3.p1.5.m5.1.1.8.3.2" xref="S3.SS3.p1.5.m5.1.1.8.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.5.m5.1.1.8.3.1" xref="S3.SS3.p1.5.m5.1.1.8.3.1.cmml">​</mo><mn id="S3.SS3.p1.5.m5.1.1.8.3.3" xref="S3.SS3.p1.5.m5.1.1.8.3.3.cmml">0</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><and id="S3.SS3.p1.5.m5.1.1a.cmml" xref="S3.SS3.p1.5.m5.1.1"></and><apply id="S3.SS3.p1.5.m5.1.1b.cmml" xref="S3.SS3.p1.5.m5.1.1"><eq id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3"></eq><apply id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.2.1.cmml" xref="S3.SS3.p1.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.2.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2.2">𝜃</ci><cn type="integer" id="S3.SS3.p1.5.m5.1.1.2.3.cmml" xref="S3.SS3.p1.5.m5.1.1.2.3">10</cn></apply><apply id="S3.SS3.p1.5.m5.1.1.4.cmml" xref="S3.SS3.p1.5.m5.1.1.4"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.4.1.cmml" xref="S3.SS3.p1.5.m5.1.1.4">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.4.2.cmml" xref="S3.SS3.p1.5.m5.1.1.4.2">𝜃</ci><cn type="integer" id="S3.SS3.p1.5.m5.1.1.4.3.cmml" xref="S3.SS3.p1.5.m5.1.1.4.3">20</cn></apply></apply><apply id="S3.SS3.p1.5.m5.1.1c.cmml" xref="S3.SS3.p1.5.m5.1.1"><eq id="S3.SS3.p1.5.m5.1.1.5.cmml" xref="S3.SS3.p1.5.m5.1.1.5"></eq><share href="#S3.SS3.p1.5.m5.1.1.4.cmml" id="S3.SS3.p1.5.m5.1.1d.cmml" xref="S3.SS3.p1.5.m5.1.1"></share><ci id="S3.SS3.p1.5.m5.1.1.6.cmml" xref="S3.SS3.p1.5.m5.1.1.6">…</ci></apply><apply id="S3.SS3.p1.5.m5.1.1e.cmml" xref="S3.SS3.p1.5.m5.1.1"><eq id="S3.SS3.p1.5.m5.1.1.7.cmml" xref="S3.SS3.p1.5.m5.1.1.7"></eq><share href="#S3.SS3.p1.5.m5.1.1.6.cmml" id="S3.SS3.p1.5.m5.1.1f.cmml" xref="S3.SS3.p1.5.m5.1.1"></share><apply id="S3.SS3.p1.5.m5.1.1.8.cmml" xref="S3.SS3.p1.5.m5.1.1.8"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.8.1.cmml" xref="S3.SS3.p1.5.m5.1.1.8">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.8.2.cmml" xref="S3.SS3.p1.5.m5.1.1.8.2">𝜃</ci><apply id="S3.SS3.p1.5.m5.1.1.8.3.cmml" xref="S3.SS3.p1.5.m5.1.1.8.3"><times id="S3.SS3.p1.5.m5.1.1.8.3.1.cmml" xref="S3.SS3.p1.5.m5.1.1.8.3.1"></times><ci id="S3.SS3.p1.5.m5.1.1.8.3.2.cmml" xref="S3.SS3.p1.5.m5.1.1.8.3.2">𝑛</ci><cn type="integer" id="S3.SS3.p1.5.m5.1.1.8.3.3.cmml" xref="S3.SS3.p1.5.m5.1.1.8.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\theta_{10}=\theta_{20}=...=\theta_{n0}</annotation></semantics></math>, etc. Then each policy trains on its own microgrid for <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">k</annotation></semantics></math> local steps, producing a new <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="\theta_{ik}^{\prime}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msubsup id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2.2" xref="S3.SS3.p1.7.m7.1.1.2.2.cmml">θ</mi><mrow id="S3.SS3.p1.7.m7.1.1.2.3" xref="S3.SS3.p1.7.m7.1.1.2.3.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2.3.2" xref="S3.SS3.p1.7.m7.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.7.m7.1.1.2.3.1" xref="S3.SS3.p1.7.m7.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.7.m7.1.1.2.3.3" xref="S3.SS3.p1.7.m7.1.1.2.3.3.cmml">k</mi></mrow><mo id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">superscript</csymbol><apply id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.2.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2.2">𝜃</ci><apply id="S3.SS3.p1.7.m7.1.1.2.3.cmml" xref="S3.SS3.p1.7.m7.1.1.2.3"><times id="S3.SS3.p1.7.m7.1.1.2.3.1.cmml" xref="S3.SS3.p1.7.m7.1.1.2.3.1"></times><ci id="S3.SS3.p1.7.m7.1.1.2.3.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p1.7.m7.1.1.2.3.3.cmml" xref="S3.SS3.p1.7.m7.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">\theta_{ik}^{\prime}</annotation></semantics></math> for each microgrid, which has adapted to be better at price-setting in microgrid <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">i</annotation></semantics></math> than the original <math id="S3.SS3.p1.9.m9.1" class="ltx_Math" alttext="\theta_{i0}" display="inline"><semantics id="S3.SS3.p1.9.m9.1a"><msub id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml"><mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">θ</mi><mrow id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml"><mi id="S3.SS3.p1.9.m9.1.1.3.2" xref="S3.SS3.p1.9.m9.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.9.m9.1.1.3.1" xref="S3.SS3.p1.9.m9.1.1.3.1.cmml">​</mo><mn id="S3.SS3.p1.9.m9.1.1.3.3" xref="S3.SS3.p1.9.m9.1.1.3.3.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">𝜃</ci><apply id="S3.SS3.p1.9.m9.1.1.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3"><times id="S3.SS3.p1.9.m9.1.1.3.1.cmml" xref="S3.SS3.p1.9.m9.1.1.3.1"></times><ci id="S3.SS3.p1.9.m9.1.1.3.2.cmml" xref="S3.SS3.p1.9.m9.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p1.9.m9.1.1.3.3.cmml" xref="S3.SS3.p1.9.m9.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">\theta_{i0}</annotation></semantics></math>. All the <math id="S3.SS3.p1.10.m10.1" class="ltx_Math" alttext="\theta_{ik}^{\prime}" display="inline"><semantics id="S3.SS3.p1.10.m10.1a"><msubsup id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml"><mi id="S3.SS3.p1.10.m10.1.1.2.2" xref="S3.SS3.p1.10.m10.1.1.2.2.cmml">θ</mi><mrow id="S3.SS3.p1.10.m10.1.1.2.3" xref="S3.SS3.p1.10.m10.1.1.2.3.cmml"><mi id="S3.SS3.p1.10.m10.1.1.2.3.2" xref="S3.SS3.p1.10.m10.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.10.m10.1.1.2.3.1" xref="S3.SS3.p1.10.m10.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.10.m10.1.1.2.3.3" xref="S3.SS3.p1.10.m10.1.1.2.3.3.cmml">k</mi></mrow><mo id="S3.SS3.p1.10.m10.1.1.3" xref="S3.SS3.p1.10.m10.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">superscript</csymbol><apply id="S3.SS3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.2.1.cmml" xref="S3.SS3.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.2.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2.2">𝜃</ci><apply id="S3.SS3.p1.10.m10.1.1.2.3.cmml" xref="S3.SS3.p1.10.m10.1.1.2.3"><times id="S3.SS3.p1.10.m10.1.1.2.3.1.cmml" xref="S3.SS3.p1.10.m10.1.1.2.3.1"></times><ci id="S3.SS3.p1.10.m10.1.1.2.3.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p1.10.m10.1.1.2.3.3.cmml" xref="S3.SS3.p1.10.m10.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p1.10.m10.1.1.3.cmml" xref="S3.SS3.p1.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">\theta_{ik}^{\prime}</annotation></semantics></math> are transmitted back to a central server, where they compute the shared model for the next iteration by averaging all the <math id="S3.SS3.p1.11.m11.1" class="ltx_Math" alttext="\theta_{ik}^{\prime}" display="inline"><semantics id="S3.SS3.p1.11.m11.1a"><msubsup id="S3.SS3.p1.11.m11.1.1" xref="S3.SS3.p1.11.m11.1.1.cmml"><mi id="S3.SS3.p1.11.m11.1.1.2.2" xref="S3.SS3.p1.11.m11.1.1.2.2.cmml">θ</mi><mrow id="S3.SS3.p1.11.m11.1.1.2.3" xref="S3.SS3.p1.11.m11.1.1.2.3.cmml"><mi id="S3.SS3.p1.11.m11.1.1.2.3.2" xref="S3.SS3.p1.11.m11.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.11.m11.1.1.2.3.1" xref="S3.SS3.p1.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p1.11.m11.1.1.2.3.3" xref="S3.SS3.p1.11.m11.1.1.2.3.3.cmml">k</mi></mrow><mo id="S3.SS3.p1.11.m11.1.1.3" xref="S3.SS3.p1.11.m11.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m11.1b"><apply id="S3.SS3.p1.11.m11.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m11.1.1.1.cmml" xref="S3.SS3.p1.11.m11.1.1">superscript</csymbol><apply id="S3.SS3.p1.11.m11.1.1.2.cmml" xref="S3.SS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m11.1.1.2.1.cmml" xref="S3.SS3.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS3.p1.11.m11.1.1.2.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2.2">𝜃</ci><apply id="S3.SS3.p1.11.m11.1.1.2.3.cmml" xref="S3.SS3.p1.11.m11.1.1.2.3"><times id="S3.SS3.p1.11.m11.1.1.2.3.1.cmml" xref="S3.SS3.p1.11.m11.1.1.2.3.1"></times><ci id="S3.SS3.p1.11.m11.1.1.2.3.2.cmml" xref="S3.SS3.p1.11.m11.1.1.2.3.2">𝑖</ci><ci id="S3.SS3.p1.11.m11.1.1.2.3.3.cmml" xref="S3.SS3.p1.11.m11.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS3.p1.11.m11.1.1.3.cmml" xref="S3.SS3.p1.11.m11.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m11.1c">\theta_{ik}^{\prime}</annotation></semantics></math>.</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\theta_{1k}=\theta_{2k}=...\theta_{nk}=\frac{1}{n}\sum_{i=1}^{n}\theta_{ik}^{\prime}" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">θ</mi><mrow id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml"><mn id="S3.E3.m1.1.1.2.3.2" xref="S3.E3.m1.1.1.2.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.2.3.1" xref="S3.E3.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.2.3.3" xref="S3.E3.m1.1.1.2.3.3.cmml">k</mi></mrow></msub><mo id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml">=</mo><msub id="S3.E3.m1.1.1.4" xref="S3.E3.m1.1.1.4.cmml"><mi id="S3.E3.m1.1.1.4.2" xref="S3.E3.m1.1.1.4.2.cmml">θ</mi><mrow id="S3.E3.m1.1.1.4.3" xref="S3.E3.m1.1.1.4.3.cmml"><mn id="S3.E3.m1.1.1.4.3.2" xref="S3.E3.m1.1.1.4.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.4.3.1" xref="S3.E3.m1.1.1.4.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.4.3.3" xref="S3.E3.m1.1.1.4.3.3.cmml">k</mi></mrow></msub><mo id="S3.E3.m1.1.1.5" xref="S3.E3.m1.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.1.1.6" xref="S3.E3.m1.1.1.6.cmml"><mi mathvariant="normal" id="S3.E3.m1.1.1.6.2" xref="S3.E3.m1.1.1.6.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.6.1" xref="S3.E3.m1.1.1.6.1.cmml">​</mo><msub id="S3.E3.m1.1.1.6.3" xref="S3.E3.m1.1.1.6.3.cmml"><mi id="S3.E3.m1.1.1.6.3.2" xref="S3.E3.m1.1.1.6.3.2.cmml">θ</mi><mrow id="S3.E3.m1.1.1.6.3.3" xref="S3.E3.m1.1.1.6.3.3.cmml"><mi id="S3.E3.m1.1.1.6.3.3.2" xref="S3.E3.m1.1.1.6.3.3.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.6.3.3.1" xref="S3.E3.m1.1.1.6.3.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.6.3.3.3" xref="S3.E3.m1.1.1.6.3.3.3.cmml">k</mi></mrow></msub></mrow><mo id="S3.E3.m1.1.1.7" xref="S3.E3.m1.1.1.7.cmml">=</mo><mrow id="S3.E3.m1.1.1.8" xref="S3.E3.m1.1.1.8.cmml"><mfrac id="S3.E3.m1.1.1.8.2" xref="S3.E3.m1.1.1.8.2.cmml"><mn id="S3.E3.m1.1.1.8.2.2" xref="S3.E3.m1.1.1.8.2.2.cmml">1</mn><mi id="S3.E3.m1.1.1.8.2.3" xref="S3.E3.m1.1.1.8.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.8.1" xref="S3.E3.m1.1.1.8.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.8.3" xref="S3.E3.m1.1.1.8.3.cmml"><munderover id="S3.E3.m1.1.1.8.3.1" xref="S3.E3.m1.1.1.8.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.1.1.8.3.1.2.2" xref="S3.E3.m1.1.1.8.3.1.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.8.3.1.2.3" xref="S3.E3.m1.1.1.8.3.1.2.3.cmml"><mi id="S3.E3.m1.1.1.8.3.1.2.3.2" xref="S3.E3.m1.1.1.8.3.1.2.3.2.cmml">i</mi><mo id="S3.E3.m1.1.1.8.3.1.2.3.1" xref="S3.E3.m1.1.1.8.3.1.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.8.3.1.2.3.3" xref="S3.E3.m1.1.1.8.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.8.3.1.3" xref="S3.E3.m1.1.1.8.3.1.3.cmml">n</mi></munderover><msubsup id="S3.E3.m1.1.1.8.3.2" xref="S3.E3.m1.1.1.8.3.2.cmml"><mi id="S3.E3.m1.1.1.8.3.2.2.2" xref="S3.E3.m1.1.1.8.3.2.2.2.cmml">θ</mi><mrow id="S3.E3.m1.1.1.8.3.2.2.3" xref="S3.E3.m1.1.1.8.3.2.2.3.cmml"><mi id="S3.E3.m1.1.1.8.3.2.2.3.2" xref="S3.E3.m1.1.1.8.3.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.8.3.2.2.3.1" xref="S3.E3.m1.1.1.8.3.2.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.8.3.2.2.3.3" xref="S3.E3.m1.1.1.8.3.2.2.3.3.cmml">k</mi></mrow><mo id="S3.E3.m1.1.1.8.3.2.3" xref="S3.E3.m1.1.1.8.3.2.3.cmml">′</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><and id="S3.E3.m1.1.1a.cmml" xref="S3.E3.m1.1.1"></and><apply id="S3.E3.m1.1.1b.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"></eq><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">𝜃</ci><apply id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3"><times id="S3.E3.m1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.2.3.1"></times><cn type="integer" id="S3.E3.m1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.2.3.2">1</cn><ci id="S3.E3.m1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S3.E3.m1.1.1.4.cmml" xref="S3.E3.m1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.4.2">𝜃</ci><apply id="S3.E3.m1.1.1.4.3.cmml" xref="S3.E3.m1.1.1.4.3"><times id="S3.E3.m1.1.1.4.3.1.cmml" xref="S3.E3.m1.1.1.4.3.1"></times><cn type="integer" id="S3.E3.m1.1.1.4.3.2.cmml" xref="S3.E3.m1.1.1.4.3.2">2</cn><ci id="S3.E3.m1.1.1.4.3.3.cmml" xref="S3.E3.m1.1.1.4.3.3">𝑘</ci></apply></apply></apply><apply id="S3.E3.m1.1.1c.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.5.cmml" xref="S3.E3.m1.1.1.5"></eq><share href="#S3.E3.m1.1.1.4.cmml" id="S3.E3.m1.1.1d.cmml" xref="S3.E3.m1.1.1"></share><apply id="S3.E3.m1.1.1.6.cmml" xref="S3.E3.m1.1.1.6"><times id="S3.E3.m1.1.1.6.1.cmml" xref="S3.E3.m1.1.1.6.1"></times><ci id="S3.E3.m1.1.1.6.2.cmml" xref="S3.E3.m1.1.1.6.2">…</ci><apply id="S3.E3.m1.1.1.6.3.cmml" xref="S3.E3.m1.1.1.6.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.6.3.1.cmml" xref="S3.E3.m1.1.1.6.3">subscript</csymbol><ci id="S3.E3.m1.1.1.6.3.2.cmml" xref="S3.E3.m1.1.1.6.3.2">𝜃</ci><apply id="S3.E3.m1.1.1.6.3.3.cmml" xref="S3.E3.m1.1.1.6.3.3"><times id="S3.E3.m1.1.1.6.3.3.1.cmml" xref="S3.E3.m1.1.1.6.3.3.1"></times><ci id="S3.E3.m1.1.1.6.3.3.2.cmml" xref="S3.E3.m1.1.1.6.3.3.2">𝑛</ci><ci id="S3.E3.m1.1.1.6.3.3.3.cmml" xref="S3.E3.m1.1.1.6.3.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E3.m1.1.1e.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.7.cmml" xref="S3.E3.m1.1.1.7"></eq><share href="#S3.E3.m1.1.1.6.cmml" id="S3.E3.m1.1.1f.cmml" xref="S3.E3.m1.1.1"></share><apply id="S3.E3.m1.1.1.8.cmml" xref="S3.E3.m1.1.1.8"><times id="S3.E3.m1.1.1.8.1.cmml" xref="S3.E3.m1.1.1.8.1"></times><apply id="S3.E3.m1.1.1.8.2.cmml" xref="S3.E3.m1.1.1.8.2"><divide id="S3.E3.m1.1.1.8.2.1.cmml" xref="S3.E3.m1.1.1.8.2"></divide><cn type="integer" id="S3.E3.m1.1.1.8.2.2.cmml" xref="S3.E3.m1.1.1.8.2.2">1</cn><ci id="S3.E3.m1.1.1.8.2.3.cmml" xref="S3.E3.m1.1.1.8.2.3">𝑛</ci></apply><apply id="S3.E3.m1.1.1.8.3.cmml" xref="S3.E3.m1.1.1.8.3"><apply id="S3.E3.m1.1.1.8.3.1.cmml" xref="S3.E3.m1.1.1.8.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.8.3.1.1.cmml" xref="S3.E3.m1.1.1.8.3.1">superscript</csymbol><apply id="S3.E3.m1.1.1.8.3.1.2.cmml" xref="S3.E3.m1.1.1.8.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.8.3.1.2.1.cmml" xref="S3.E3.m1.1.1.8.3.1">subscript</csymbol><sum id="S3.E3.m1.1.1.8.3.1.2.2.cmml" xref="S3.E3.m1.1.1.8.3.1.2.2"></sum><apply id="S3.E3.m1.1.1.8.3.1.2.3.cmml" xref="S3.E3.m1.1.1.8.3.1.2.3"><eq id="S3.E3.m1.1.1.8.3.1.2.3.1.cmml" xref="S3.E3.m1.1.1.8.3.1.2.3.1"></eq><ci id="S3.E3.m1.1.1.8.3.1.2.3.2.cmml" xref="S3.E3.m1.1.1.8.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.1.1.8.3.1.2.3.3.cmml" xref="S3.E3.m1.1.1.8.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.8.3.1.3.cmml" xref="S3.E3.m1.1.1.8.3.1.3">𝑛</ci></apply><apply id="S3.E3.m1.1.1.8.3.2.cmml" xref="S3.E3.m1.1.1.8.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.8.3.2.1.cmml" xref="S3.E3.m1.1.1.8.3.2">superscript</csymbol><apply id="S3.E3.m1.1.1.8.3.2.2.cmml" xref="S3.E3.m1.1.1.8.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.8.3.2.2.1.cmml" xref="S3.E3.m1.1.1.8.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.8.3.2.2.2.cmml" xref="S3.E3.m1.1.1.8.3.2.2.2">𝜃</ci><apply id="S3.E3.m1.1.1.8.3.2.2.3.cmml" xref="S3.E3.m1.1.1.8.3.2.2.3"><times id="S3.E3.m1.1.1.8.3.2.2.3.1.cmml" xref="S3.E3.m1.1.1.8.3.2.2.3.1"></times><ci id="S3.E3.m1.1.1.8.3.2.2.3.2.cmml" xref="S3.E3.m1.1.1.8.3.2.2.3.2">𝑖</ci><ci id="S3.E3.m1.1.1.8.3.2.2.3.3.cmml" xref="S3.E3.m1.1.1.8.3.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.E3.m1.1.1.8.3.2.3.cmml" xref="S3.E3.m1.1.1.8.3.2.3">′</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\theta_{1k}=\theta_{2k}=...\theta_{nk}=\frac{1}{n}\sum_{i=1}^{n}\theta_{ik}^{\prime}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.12" class="ltx_p">Then the local models train on their own, send trained models back to a central server, and repeat. Sending model information only preserves privacy because only the parameters <math id="S3.SS3.p1.12.m1.1" class="ltx_Math" alttext="\theta_{it}" display="inline"><semantics id="S3.SS3.p1.12.m1.1a"><msub id="S3.SS3.p1.12.m1.1.1" xref="S3.SS3.p1.12.m1.1.1.cmml"><mi id="S3.SS3.p1.12.m1.1.1.2" xref="S3.SS3.p1.12.m1.1.1.2.cmml">θ</mi><mrow id="S3.SS3.p1.12.m1.1.1.3" xref="S3.SS3.p1.12.m1.1.1.3.cmml"><mi id="S3.SS3.p1.12.m1.1.1.3.2" xref="S3.SS3.p1.12.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.12.m1.1.1.3.1" xref="S3.SS3.p1.12.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.12.m1.1.1.3.3" xref="S3.SS3.p1.12.m1.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m1.1b"><apply id="S3.SS3.p1.12.m1.1.1.cmml" xref="S3.SS3.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m1.1.1.1.cmml" xref="S3.SS3.p1.12.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.12.m1.1.1.2.cmml" xref="S3.SS3.p1.12.m1.1.1.2">𝜃</ci><apply id="S3.SS3.p1.12.m1.1.1.3.cmml" xref="S3.SS3.p1.12.m1.1.1.3"><times id="S3.SS3.p1.12.m1.1.1.3.1.cmml" xref="S3.SS3.p1.12.m1.1.1.3.1"></times><ci id="S3.SS3.p1.12.m1.1.1.3.2.cmml" xref="S3.SS3.p1.12.m1.1.1.3.2">𝑖</ci><ci id="S3.SS3.p1.12.m1.1.1.3.3.cmml" xref="S3.SS3.p1.12.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m1.1c">\theta_{it}</annotation></semantics></math>’ are communicated with the central server, never any data. Note that in our setup, every client participates in the weight exchange process, not just a sampled subset of the clients.
While FedAvg is a simple algorithm that performs well in supervised learning, it learns a global policy for all the price-setting agents. In our case, a global model is not ideal as microgrids may have different energy consumption/supply behaviors.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Hypernetworks for Personalized Federated Learning (PFH)</h3>

<div id="S3.SS4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS4.p1.1" class="ltx_p">To learn a shared model that is still able to personalize to individual microgrids, we turn to hypernetworks for personalized federated learning. <cite class="ltx_cite ltx_citemacro_citep">(Shamsian et al., <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>. Personalized federated learning algorithm has found great success in supervised learning, beating FedAvg and personalized federated learning approaches based on meta-learning <cite class="ltx_cite ltx_citemacro_citep">(Fallah et al., <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>, Moreau Envelopes <cite class="ltx_cite ltx_citemacro_citep">(T Dinh et al., <a href="#bib.bib26" title="" class="ltx_ref">2020</a>)</cite>, and Personalization Layers <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib5" title="" class="ltx_ref">2019</a>)</cite>. However, personalized federated learning has never been used before for RL.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para ltx_noindent">
<p id="S3.SS4.p2.13" class="ltx_p">Now we will describe PFH more formally. Please refer to Fig. <a href="#S3.F1" title="Figure 1 ‣ 3.1 Learning environment ‣ 3 Methods ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> for a visual of the algorithm, and Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3.4 Hypernetworks for Personalized Federated Learning (PFH) ‣ 3 Methods ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> for pseudocode. Consider again <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\theta_{it}\in\mathbb{R}^{m}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><msub id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2.2" xref="S3.SS4.p2.1.m1.1.1.2.2.cmml">θ</mi><mrow id="S3.SS4.p2.1.m1.1.1.2.3" xref="S3.SS4.p2.1.m1.1.1.2.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2.3.2" xref="S3.SS4.p2.1.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.2.3.1" xref="S3.SS4.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.2.3.3" xref="S3.SS4.p2.1.m1.1.1.2.3.3.cmml">t</mi></mrow></msub><mo id="S3.SS4.p2.1.m1.1.1.1" xref="S3.SS4.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS4.p2.1.m1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><in id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1.1"></in><apply id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2.2">𝜃</ci><apply id="S3.SS4.p2.1.m1.1.1.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.2.3"><times id="S3.SS4.p2.1.m1.1.1.2.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.2.3.1"></times><ci id="S3.SS4.p2.1.m1.1.1.2.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2.3.2">𝑖</ci><ci id="S3.SS4.p2.1.m1.1.1.2.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\theta_{it}\in\mathbb{R}^{m}</annotation></semantics></math> as an <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">m</annotation></semantics></math> dimensional vector denoting the parameters of the policy for microgrid <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><mi id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><ci id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">i</annotation></semantics></math> at timestep <math id="S3.SS4.p2.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS4.p2.4.m4.1a"><mi id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><ci id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">t</annotation></semantics></math>. A <span id="S3.SS4.p2.13.1" class="ltx_text ltx_font_bold">hypernetwork</span> is a neural network that outputs the parameters of another neural network. We will have one global <math id="S3.SS4.p2.5.m5.1" class="ltx_Math" alttext="H_{\phi_{t}}\in\mathbb{R}^{l}\rightarrow\mathbb{R}^{m}" display="inline"><semantics id="S3.SS4.p2.5.m5.1a"><mrow id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml"><msub id="S3.SS4.p2.5.m5.1.1.2" xref="S3.SS4.p2.5.m5.1.1.2.cmml"><mi id="S3.SS4.p2.5.m5.1.1.2.2" xref="S3.SS4.p2.5.m5.1.1.2.2.cmml">H</mi><msub id="S3.SS4.p2.5.m5.1.1.2.3" xref="S3.SS4.p2.5.m5.1.1.2.3.cmml"><mi id="S3.SS4.p2.5.m5.1.1.2.3.2" xref="S3.SS4.p2.5.m5.1.1.2.3.2.cmml">ϕ</mi><mi id="S3.SS4.p2.5.m5.1.1.2.3.3" xref="S3.SS4.p2.5.m5.1.1.2.3.3.cmml">t</mi></msub></msub><mo id="S3.SS4.p2.5.m5.1.1.3" xref="S3.SS4.p2.5.m5.1.1.3.cmml">∈</mo><msup id="S3.SS4.p2.5.m5.1.1.4" xref="S3.SS4.p2.5.m5.1.1.4.cmml"><mi id="S3.SS4.p2.5.m5.1.1.4.2" xref="S3.SS4.p2.5.m5.1.1.4.2.cmml">ℝ</mi><mi id="S3.SS4.p2.5.m5.1.1.4.3" xref="S3.SS4.p2.5.m5.1.1.4.3.cmml">l</mi></msup><mo stretchy="false" id="S3.SS4.p2.5.m5.1.1.5" xref="S3.SS4.p2.5.m5.1.1.5.cmml">→</mo><msup id="S3.SS4.p2.5.m5.1.1.6" xref="S3.SS4.p2.5.m5.1.1.6.cmml"><mi id="S3.SS4.p2.5.m5.1.1.6.2" xref="S3.SS4.p2.5.m5.1.1.6.2.cmml">ℝ</mi><mi id="S3.SS4.p2.5.m5.1.1.6.3" xref="S3.SS4.p2.5.m5.1.1.6.3.cmml">m</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1"><and id="S3.SS4.p2.5.m5.1.1a.cmml" xref="S3.SS4.p2.5.m5.1.1"></and><apply id="S3.SS4.p2.5.m5.1.1b.cmml" xref="S3.SS4.p2.5.m5.1.1"><in id="S3.SS4.p2.5.m5.1.1.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3"></in><apply id="S3.SS4.p2.5.m5.1.1.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.2.1.cmml" xref="S3.SS4.p2.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.2.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2.2">𝐻</ci><apply id="S3.SS4.p2.5.m5.1.1.2.3.cmml" xref="S3.SS4.p2.5.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.2.3.1.cmml" xref="S3.SS4.p2.5.m5.1.1.2.3">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.2.3.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2.3.2">italic-ϕ</ci><ci id="S3.SS4.p2.5.m5.1.1.2.3.3.cmml" xref="S3.SS4.p2.5.m5.1.1.2.3.3">𝑡</ci></apply></apply><apply id="S3.SS4.p2.5.m5.1.1.4.cmml" xref="S3.SS4.p2.5.m5.1.1.4"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.4.1.cmml" xref="S3.SS4.p2.5.m5.1.1.4">superscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.4.2.cmml" xref="S3.SS4.p2.5.m5.1.1.4.2">ℝ</ci><ci id="S3.SS4.p2.5.m5.1.1.4.3.cmml" xref="S3.SS4.p2.5.m5.1.1.4.3">𝑙</ci></apply></apply><apply id="S3.SS4.p2.5.m5.1.1c.cmml" xref="S3.SS4.p2.5.m5.1.1"><ci id="S3.SS4.p2.5.m5.1.1.5.cmml" xref="S3.SS4.p2.5.m5.1.1.5">→</ci><share href="#S3.SS4.p2.5.m5.1.1.4.cmml" id="S3.SS4.p2.5.m5.1.1d.cmml" xref="S3.SS4.p2.5.m5.1.1"></share><apply id="S3.SS4.p2.5.m5.1.1.6.cmml" xref="S3.SS4.p2.5.m5.1.1.6"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.6.1.cmml" xref="S3.SS4.p2.5.m5.1.1.6">superscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.6.2.cmml" xref="S3.SS4.p2.5.m5.1.1.6.2">ℝ</ci><ci id="S3.SS4.p2.5.m5.1.1.6.3.cmml" xref="S3.SS4.p2.5.m5.1.1.6.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">H_{\phi_{t}}\in\mathbb{R}^{l}\rightarrow\mathbb{R}^{m}</annotation></semantics></math> parameterized by <math id="S3.SS4.p2.6.m6.1" class="ltx_Math" alttext="\phi_{t}" display="inline"><semantics id="S3.SS4.p2.6.m6.1a"><msub id="S3.SS4.p2.6.m6.1.1" xref="S3.SS4.p2.6.m6.1.1.cmml"><mi id="S3.SS4.p2.6.m6.1.1.2" xref="S3.SS4.p2.6.m6.1.1.2.cmml">ϕ</mi><mi id="S3.SS4.p2.6.m6.1.1.3" xref="S3.SS4.p2.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.6.m6.1b"><apply id="S3.SS4.p2.6.m6.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.6.m6.1.1.1.cmml" xref="S3.SS4.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS4.p2.6.m6.1.1.2.cmml" xref="S3.SS4.p2.6.m6.1.1.2">italic-ϕ</ci><ci id="S3.SS4.p2.6.m6.1.1.3.cmml" xref="S3.SS4.p2.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.6.m6.1c">\phi_{t}</annotation></semantics></math>. <math id="S3.SS4.p2.7.m7.1" class="ltx_Math" alttext="H_{\phi_{t}}" display="inline"><semantics id="S3.SS4.p2.7.m7.1a"><msub id="S3.SS4.p2.7.m7.1.1" xref="S3.SS4.p2.7.m7.1.1.cmml"><mi id="S3.SS4.p2.7.m7.1.1.2" xref="S3.SS4.p2.7.m7.1.1.2.cmml">H</mi><msub id="S3.SS4.p2.7.m7.1.1.3" xref="S3.SS4.p2.7.m7.1.1.3.cmml"><mi id="S3.SS4.p2.7.m7.1.1.3.2" xref="S3.SS4.p2.7.m7.1.1.3.2.cmml">ϕ</mi><mi id="S3.SS4.p2.7.m7.1.1.3.3" xref="S3.SS4.p2.7.m7.1.1.3.3.cmml">t</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.7.m7.1b"><apply id="S3.SS4.p2.7.m7.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.1.1.1.cmml" xref="S3.SS4.p2.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p2.7.m7.1.1.2.cmml" xref="S3.SS4.p2.7.m7.1.1.2">𝐻</ci><apply id="S3.SS4.p2.7.m7.1.1.3.cmml" xref="S3.SS4.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.7.m7.1.1.3.1.cmml" xref="S3.SS4.p2.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.7.m7.1.1.3.2.cmml" xref="S3.SS4.p2.7.m7.1.1.3.2">italic-ϕ</ci><ci id="S3.SS4.p2.7.m7.1.1.3.3.cmml" xref="S3.SS4.p2.7.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.7.m7.1c">H_{\phi_{t}}</annotation></semantics></math> takes as input an environment embedding vector <math id="S3.SS4.p2.8.m8.1" class="ltx_Math" alttext="v_{i}\in\mathbb{R}^{l}" display="inline"><semantics id="S3.SS4.p2.8.m8.1a"><mrow id="S3.SS4.p2.8.m8.1.1" xref="S3.SS4.p2.8.m8.1.1.cmml"><msub id="S3.SS4.p2.8.m8.1.1.2" xref="S3.SS4.p2.8.m8.1.1.2.cmml"><mi id="S3.SS4.p2.8.m8.1.1.2.2" xref="S3.SS4.p2.8.m8.1.1.2.2.cmml">v</mi><mi id="S3.SS4.p2.8.m8.1.1.2.3" xref="S3.SS4.p2.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS4.p2.8.m8.1.1.1" xref="S3.SS4.p2.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS4.p2.8.m8.1.1.3" xref="S3.SS4.p2.8.m8.1.1.3.cmml"><mi id="S3.SS4.p2.8.m8.1.1.3.2" xref="S3.SS4.p2.8.m8.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS4.p2.8.m8.1.1.3.3" xref="S3.SS4.p2.8.m8.1.1.3.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.8.m8.1b"><apply id="S3.SS4.p2.8.m8.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1"><in id="S3.SS4.p2.8.m8.1.1.1.cmml" xref="S3.SS4.p2.8.m8.1.1.1"></in><apply id="S3.SS4.p2.8.m8.1.1.2.cmml" xref="S3.SS4.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m8.1.1.2.1.cmml" xref="S3.SS4.p2.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS4.p2.8.m8.1.1.2.2.cmml" xref="S3.SS4.p2.8.m8.1.1.2.2">𝑣</ci><ci id="S3.SS4.p2.8.m8.1.1.2.3.cmml" xref="S3.SS4.p2.8.m8.1.1.2.3">𝑖</ci></apply><apply id="S3.SS4.p2.8.m8.1.1.3.cmml" xref="S3.SS4.p2.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.8.m8.1.1.3.1.cmml" xref="S3.SS4.p2.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS4.p2.8.m8.1.1.3.2.cmml" xref="S3.SS4.p2.8.m8.1.1.3.2">ℝ</ci><ci id="S3.SS4.p2.8.m8.1.1.3.3.cmml" xref="S3.SS4.p2.8.m8.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.8.m8.1c">v_{i}\in\mathbb{R}^{l}</annotation></semantics></math>, which is learned for each environment along with the hypernetwork. We initialize <math id="S3.SS4.p2.9.m9.1" class="ltx_Math" alttext="\theta_{i0}=H_{\phi_{0}}(v_{i})" display="inline"><semantics id="S3.SS4.p2.9.m9.1a"><mrow id="S3.SS4.p2.9.m9.1.1" xref="S3.SS4.p2.9.m9.1.1.cmml"><msub id="S3.SS4.p2.9.m9.1.1.3" xref="S3.SS4.p2.9.m9.1.1.3.cmml"><mi id="S3.SS4.p2.9.m9.1.1.3.2" xref="S3.SS4.p2.9.m9.1.1.3.2.cmml">θ</mi><mrow id="S3.SS4.p2.9.m9.1.1.3.3" xref="S3.SS4.p2.9.m9.1.1.3.3.cmml"><mi id="S3.SS4.p2.9.m9.1.1.3.3.2" xref="S3.SS4.p2.9.m9.1.1.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.9.m9.1.1.3.3.1" xref="S3.SS4.p2.9.m9.1.1.3.3.1.cmml">​</mo><mn id="S3.SS4.p2.9.m9.1.1.3.3.3" xref="S3.SS4.p2.9.m9.1.1.3.3.3.cmml">0</mn></mrow></msub><mo id="S3.SS4.p2.9.m9.1.1.2" xref="S3.SS4.p2.9.m9.1.1.2.cmml">=</mo><mrow id="S3.SS4.p2.9.m9.1.1.1" xref="S3.SS4.p2.9.m9.1.1.1.cmml"><msub id="S3.SS4.p2.9.m9.1.1.1.3" xref="S3.SS4.p2.9.m9.1.1.1.3.cmml"><mi id="S3.SS4.p2.9.m9.1.1.1.3.2" xref="S3.SS4.p2.9.m9.1.1.1.3.2.cmml">H</mi><msub id="S3.SS4.p2.9.m9.1.1.1.3.3" xref="S3.SS4.p2.9.m9.1.1.1.3.3.cmml"><mi id="S3.SS4.p2.9.m9.1.1.1.3.3.2" xref="S3.SS4.p2.9.m9.1.1.1.3.3.2.cmml">ϕ</mi><mn id="S3.SS4.p2.9.m9.1.1.1.3.3.3" xref="S3.SS4.p2.9.m9.1.1.1.3.3.3.cmml">0</mn></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p2.9.m9.1.1.1.2" xref="S3.SS4.p2.9.m9.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p2.9.m9.1.1.1.1.1" xref="S3.SS4.p2.9.m9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p2.9.m9.1.1.1.1.1.2" xref="S3.SS4.p2.9.m9.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.9.m9.1.1.1.1.1.1" xref="S3.SS4.p2.9.m9.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.9.m9.1.1.1.1.1.1.2" xref="S3.SS4.p2.9.m9.1.1.1.1.1.1.2.cmml">v</mi><mi id="S3.SS4.p2.9.m9.1.1.1.1.1.1.3" xref="S3.SS4.p2.9.m9.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS4.p2.9.m9.1.1.1.1.1.3" xref="S3.SS4.p2.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.9.m9.1b"><apply id="S3.SS4.p2.9.m9.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1"><eq id="S3.SS4.p2.9.m9.1.1.2.cmml" xref="S3.SS4.p2.9.m9.1.1.2"></eq><apply id="S3.SS4.p2.9.m9.1.1.3.cmml" xref="S3.SS4.p2.9.m9.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m9.1.1.3.1.cmml" xref="S3.SS4.p2.9.m9.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.9.m9.1.1.3.2.cmml" xref="S3.SS4.p2.9.m9.1.1.3.2">𝜃</ci><apply id="S3.SS4.p2.9.m9.1.1.3.3.cmml" xref="S3.SS4.p2.9.m9.1.1.3.3"><times id="S3.SS4.p2.9.m9.1.1.3.3.1.cmml" xref="S3.SS4.p2.9.m9.1.1.3.3.1"></times><ci id="S3.SS4.p2.9.m9.1.1.3.3.2.cmml" xref="S3.SS4.p2.9.m9.1.1.3.3.2">𝑖</ci><cn type="integer" id="S3.SS4.p2.9.m9.1.1.3.3.3.cmml" xref="S3.SS4.p2.9.m9.1.1.3.3.3">0</cn></apply></apply><apply id="S3.SS4.p2.9.m9.1.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1.1"><times id="S3.SS4.p2.9.m9.1.1.1.2.cmml" xref="S3.SS4.p2.9.m9.1.1.1.2"></times><apply id="S3.SS4.p2.9.m9.1.1.1.3.cmml" xref="S3.SS4.p2.9.m9.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m9.1.1.1.3.1.cmml" xref="S3.SS4.p2.9.m9.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.9.m9.1.1.1.3.2.cmml" xref="S3.SS4.p2.9.m9.1.1.1.3.2">𝐻</ci><apply id="S3.SS4.p2.9.m9.1.1.1.3.3.cmml" xref="S3.SS4.p2.9.m9.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m9.1.1.1.3.3.1.cmml" xref="S3.SS4.p2.9.m9.1.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p2.9.m9.1.1.1.3.3.2.cmml" xref="S3.SS4.p2.9.m9.1.1.1.3.3.2">italic-ϕ</ci><cn type="integer" id="S3.SS4.p2.9.m9.1.1.1.3.3.3.cmml" xref="S3.SS4.p2.9.m9.1.1.1.3.3.3">0</cn></apply></apply><apply id="S3.SS4.p2.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.9.m9.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.9.m9.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.9.m9.1.1.1.1.1.1.2">𝑣</ci><ci id="S3.SS4.p2.9.m9.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.9.m9.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.9.m9.1c">\theta_{i0}=H_{\phi_{0}}(v_{i})</annotation></semantics></math> <math id="S3.SS4.p2.10.m10.3" class="ltx_Math" alttext="\forall i\in[1,...,n]" display="inline"><semantics id="S3.SS4.p2.10.m10.3a"><mrow id="S3.SS4.p2.10.m10.3.4" xref="S3.SS4.p2.10.m10.3.4.cmml"><mrow id="S3.SS4.p2.10.m10.3.4.2" xref="S3.SS4.p2.10.m10.3.4.2.cmml"><mo rspace="0.167em" id="S3.SS4.p2.10.m10.3.4.2.1" xref="S3.SS4.p2.10.m10.3.4.2.1.cmml">∀</mo><mi id="S3.SS4.p2.10.m10.3.4.2.2" xref="S3.SS4.p2.10.m10.3.4.2.2.cmml">i</mi></mrow><mo id="S3.SS4.p2.10.m10.3.4.1" xref="S3.SS4.p2.10.m10.3.4.1.cmml">∈</mo><mrow id="S3.SS4.p2.10.m10.3.4.3.2" xref="S3.SS4.p2.10.m10.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS4.p2.10.m10.3.4.3.2.1" xref="S3.SS4.p2.10.m10.3.4.3.1.cmml">[</mo><mn id="S3.SS4.p2.10.m10.1.1" xref="S3.SS4.p2.10.m10.1.1.cmml">1</mn><mo id="S3.SS4.p2.10.m10.3.4.3.2.2" xref="S3.SS4.p2.10.m10.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p2.10.m10.2.2" xref="S3.SS4.p2.10.m10.2.2.cmml">…</mi><mo id="S3.SS4.p2.10.m10.3.4.3.2.3" xref="S3.SS4.p2.10.m10.3.4.3.1.cmml">,</mo><mi id="S3.SS4.p2.10.m10.3.3" xref="S3.SS4.p2.10.m10.3.3.cmml">n</mi><mo stretchy="false" id="S3.SS4.p2.10.m10.3.4.3.2.4" xref="S3.SS4.p2.10.m10.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.10.m10.3b"><apply id="S3.SS4.p2.10.m10.3.4.cmml" xref="S3.SS4.p2.10.m10.3.4"><in id="S3.SS4.p2.10.m10.3.4.1.cmml" xref="S3.SS4.p2.10.m10.3.4.1"></in><apply id="S3.SS4.p2.10.m10.3.4.2.cmml" xref="S3.SS4.p2.10.m10.3.4.2"><csymbol cd="latexml" id="S3.SS4.p2.10.m10.3.4.2.1.cmml" xref="S3.SS4.p2.10.m10.3.4.2.1">for-all</csymbol><ci id="S3.SS4.p2.10.m10.3.4.2.2.cmml" xref="S3.SS4.p2.10.m10.3.4.2.2">𝑖</ci></apply><list id="S3.SS4.p2.10.m10.3.4.3.1.cmml" xref="S3.SS4.p2.10.m10.3.4.3.2"><cn type="integer" id="S3.SS4.p2.10.m10.1.1.cmml" xref="S3.SS4.p2.10.m10.1.1">1</cn><ci id="S3.SS4.p2.10.m10.2.2.cmml" xref="S3.SS4.p2.10.m10.2.2">…</ci><ci id="S3.SS4.p2.10.m10.3.3.cmml" xref="S3.SS4.p2.10.m10.3.3">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.10.m10.3c">\forall i\in[1,...,n]</annotation></semantics></math>. Then each<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Note our setup is slightly different from the original PFH <cite class="ltx_cite ltx_citemacro_citep">(Shamsian et al., <a href="#bib.bib21" title="" class="ltx_ref">2021</a>)</cite>; every client participates in each round, not just a sampled subset of clients. We made this small variation to better understand whether scaling the algorithm to larger numbers of microgrids would be useful.</span></span></span> local agent trains for <math id="S3.SS4.p2.11.m11.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p2.11.m11.1a"><mi id="S3.SS4.p2.11.m11.1.1" xref="S3.SS4.p2.11.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.11.m11.1b"><ci id="S3.SS4.p2.11.m11.1.1.cmml" xref="S3.SS4.p2.11.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.11.m11.1c">k</annotation></semantics></math> steps, producing new parameters <math id="S3.SS4.p2.12.m12.1" class="ltx_Math" alttext="\theta_{ik}^{\prime}" display="inline"><semantics id="S3.SS4.p2.12.m12.1a"><msubsup id="S3.SS4.p2.12.m12.1.1" xref="S3.SS4.p2.12.m12.1.1.cmml"><mi id="S3.SS4.p2.12.m12.1.1.2.2" xref="S3.SS4.p2.12.m12.1.1.2.2.cmml">θ</mi><mrow id="S3.SS4.p2.12.m12.1.1.2.3" xref="S3.SS4.p2.12.m12.1.1.2.3.cmml"><mi id="S3.SS4.p2.12.m12.1.1.2.3.2" xref="S3.SS4.p2.12.m12.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.12.m12.1.1.2.3.1" xref="S3.SS4.p2.12.m12.1.1.2.3.1.cmml">​</mo><mi id="S3.SS4.p2.12.m12.1.1.2.3.3" xref="S3.SS4.p2.12.m12.1.1.2.3.3.cmml">k</mi></mrow><mo id="S3.SS4.p2.12.m12.1.1.3" xref="S3.SS4.p2.12.m12.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.12.m12.1b"><apply id="S3.SS4.p2.12.m12.1.1.cmml" xref="S3.SS4.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.12.m12.1.1.1.cmml" xref="S3.SS4.p2.12.m12.1.1">superscript</csymbol><apply id="S3.SS4.p2.12.m12.1.1.2.cmml" xref="S3.SS4.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.12.m12.1.1.2.1.cmml" xref="S3.SS4.p2.12.m12.1.1">subscript</csymbol><ci id="S3.SS4.p2.12.m12.1.1.2.2.cmml" xref="S3.SS4.p2.12.m12.1.1.2.2">𝜃</ci><apply id="S3.SS4.p2.12.m12.1.1.2.3.cmml" xref="S3.SS4.p2.12.m12.1.1.2.3"><times id="S3.SS4.p2.12.m12.1.1.2.3.1.cmml" xref="S3.SS4.p2.12.m12.1.1.2.3.1"></times><ci id="S3.SS4.p2.12.m12.1.1.2.3.2.cmml" xref="S3.SS4.p2.12.m12.1.1.2.3.2">𝑖</ci><ci id="S3.SS4.p2.12.m12.1.1.2.3.3.cmml" xref="S3.SS4.p2.12.m12.1.1.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.12.m12.1.1.3.cmml" xref="S3.SS4.p2.12.m12.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.12.m12.1c">\theta_{ik}^{\prime}</annotation></semantics></math>. Then, <math id="S3.SS4.p2.13.m13.1" class="ltx_Math" alttext="\Delta\theta_{ik}=\theta_{ik}^{\prime}-\theta_{i0}" display="inline"><semantics id="S3.SS4.p2.13.m13.1a"><mrow id="S3.SS4.p2.13.m13.1.1" xref="S3.SS4.p2.13.m13.1.1.cmml"><mrow id="S3.SS4.p2.13.m13.1.1.2" xref="S3.SS4.p2.13.m13.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS4.p2.13.m13.1.1.2.2" xref="S3.SS4.p2.13.m13.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.13.m13.1.1.2.1" xref="S3.SS4.p2.13.m13.1.1.2.1.cmml">​</mo><msub id="S3.SS4.p2.13.m13.1.1.2.3" xref="S3.SS4.p2.13.m13.1.1.2.3.cmml"><mi id="S3.SS4.p2.13.m13.1.1.2.3.2" xref="S3.SS4.p2.13.m13.1.1.2.3.2.cmml">θ</mi><mrow id="S3.SS4.p2.13.m13.1.1.2.3.3" xref="S3.SS4.p2.13.m13.1.1.2.3.3.cmml"><mi id="S3.SS4.p2.13.m13.1.1.2.3.3.2" xref="S3.SS4.p2.13.m13.1.1.2.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.13.m13.1.1.2.3.3.1" xref="S3.SS4.p2.13.m13.1.1.2.3.3.1.cmml">​</mo><mi id="S3.SS4.p2.13.m13.1.1.2.3.3.3" xref="S3.SS4.p2.13.m13.1.1.2.3.3.3.cmml">k</mi></mrow></msub></mrow><mo id="S3.SS4.p2.13.m13.1.1.1" xref="S3.SS4.p2.13.m13.1.1.1.cmml">=</mo><mrow id="S3.SS4.p2.13.m13.1.1.3" xref="S3.SS4.p2.13.m13.1.1.3.cmml"><msubsup id="S3.SS4.p2.13.m13.1.1.3.2" xref="S3.SS4.p2.13.m13.1.1.3.2.cmml"><mi id="S3.SS4.p2.13.m13.1.1.3.2.2.2" xref="S3.SS4.p2.13.m13.1.1.3.2.2.2.cmml">θ</mi><mrow id="S3.SS4.p2.13.m13.1.1.3.2.2.3" xref="S3.SS4.p2.13.m13.1.1.3.2.2.3.cmml"><mi id="S3.SS4.p2.13.m13.1.1.3.2.2.3.2" xref="S3.SS4.p2.13.m13.1.1.3.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.13.m13.1.1.3.2.2.3.1" xref="S3.SS4.p2.13.m13.1.1.3.2.2.3.1.cmml">​</mo><mi id="S3.SS4.p2.13.m13.1.1.3.2.2.3.3" xref="S3.SS4.p2.13.m13.1.1.3.2.2.3.3.cmml">k</mi></mrow><mo id="S3.SS4.p2.13.m13.1.1.3.2.3" xref="S3.SS4.p2.13.m13.1.1.3.2.3.cmml">′</mo></msubsup><mo id="S3.SS4.p2.13.m13.1.1.3.1" xref="S3.SS4.p2.13.m13.1.1.3.1.cmml">−</mo><msub id="S3.SS4.p2.13.m13.1.1.3.3" xref="S3.SS4.p2.13.m13.1.1.3.3.cmml"><mi id="S3.SS4.p2.13.m13.1.1.3.3.2" xref="S3.SS4.p2.13.m13.1.1.3.3.2.cmml">θ</mi><mrow id="S3.SS4.p2.13.m13.1.1.3.3.3" xref="S3.SS4.p2.13.m13.1.1.3.3.3.cmml"><mi id="S3.SS4.p2.13.m13.1.1.3.3.3.2" xref="S3.SS4.p2.13.m13.1.1.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.13.m13.1.1.3.3.3.1" xref="S3.SS4.p2.13.m13.1.1.3.3.3.1.cmml">​</mo><mn id="S3.SS4.p2.13.m13.1.1.3.3.3.3" xref="S3.SS4.p2.13.m13.1.1.3.3.3.3.cmml">0</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.13.m13.1b"><apply id="S3.SS4.p2.13.m13.1.1.cmml" xref="S3.SS4.p2.13.m13.1.1"><eq id="S3.SS4.p2.13.m13.1.1.1.cmml" xref="S3.SS4.p2.13.m13.1.1.1"></eq><apply id="S3.SS4.p2.13.m13.1.1.2.cmml" xref="S3.SS4.p2.13.m13.1.1.2"><times id="S3.SS4.p2.13.m13.1.1.2.1.cmml" xref="S3.SS4.p2.13.m13.1.1.2.1"></times><ci id="S3.SS4.p2.13.m13.1.1.2.2.cmml" xref="S3.SS4.p2.13.m13.1.1.2.2">Δ</ci><apply id="S3.SS4.p2.13.m13.1.1.2.3.cmml" xref="S3.SS4.p2.13.m13.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS4.p2.13.m13.1.1.2.3.1.cmml" xref="S3.SS4.p2.13.m13.1.1.2.3">subscript</csymbol><ci id="S3.SS4.p2.13.m13.1.1.2.3.2.cmml" xref="S3.SS4.p2.13.m13.1.1.2.3.2">𝜃</ci><apply id="S3.SS4.p2.13.m13.1.1.2.3.3.cmml" xref="S3.SS4.p2.13.m13.1.1.2.3.3"><times id="S3.SS4.p2.13.m13.1.1.2.3.3.1.cmml" xref="S3.SS4.p2.13.m13.1.1.2.3.3.1"></times><ci id="S3.SS4.p2.13.m13.1.1.2.3.3.2.cmml" xref="S3.SS4.p2.13.m13.1.1.2.3.3.2">𝑖</ci><ci id="S3.SS4.p2.13.m13.1.1.2.3.3.3.cmml" xref="S3.SS4.p2.13.m13.1.1.2.3.3.3">𝑘</ci></apply></apply></apply><apply id="S3.SS4.p2.13.m13.1.1.3.cmml" xref="S3.SS4.p2.13.m13.1.1.3"><minus id="S3.SS4.p2.13.m13.1.1.3.1.cmml" xref="S3.SS4.p2.13.m13.1.1.3.1"></minus><apply id="S3.SS4.p2.13.m13.1.1.3.2.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.13.m13.1.1.3.2.1.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2">superscript</csymbol><apply id="S3.SS4.p2.13.m13.1.1.3.2.2.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.13.m13.1.1.3.2.2.1.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2">subscript</csymbol><ci id="S3.SS4.p2.13.m13.1.1.3.2.2.2.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2.2.2">𝜃</ci><apply id="S3.SS4.p2.13.m13.1.1.3.2.2.3.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2.2.3"><times id="S3.SS4.p2.13.m13.1.1.3.2.2.3.1.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2.2.3.1"></times><ci id="S3.SS4.p2.13.m13.1.1.3.2.2.3.2.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2.2.3.2">𝑖</ci><ci id="S3.SS4.p2.13.m13.1.1.3.2.2.3.3.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2.2.3.3">𝑘</ci></apply></apply><ci id="S3.SS4.p2.13.m13.1.1.3.2.3.cmml" xref="S3.SS4.p2.13.m13.1.1.3.2.3">′</ci></apply><apply id="S3.SS4.p2.13.m13.1.1.3.3.cmml" xref="S3.SS4.p2.13.m13.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS4.p2.13.m13.1.1.3.3.1.cmml" xref="S3.SS4.p2.13.m13.1.1.3.3">subscript</csymbol><ci id="S3.SS4.p2.13.m13.1.1.3.3.2.cmml" xref="S3.SS4.p2.13.m13.1.1.3.3.2">𝜃</ci><apply id="S3.SS4.p2.13.m13.1.1.3.3.3.cmml" xref="S3.SS4.p2.13.m13.1.1.3.3.3"><times id="S3.SS4.p2.13.m13.1.1.3.3.3.1.cmml" xref="S3.SS4.p2.13.m13.1.1.3.3.3.1"></times><ci id="S3.SS4.p2.13.m13.1.1.3.3.3.2.cmml" xref="S3.SS4.p2.13.m13.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="S3.SS4.p2.13.m13.1.1.3.3.3.3.cmml" xref="S3.SS4.p2.13.m13.1.1.3.3.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.13.m13.1c">\Delta\theta_{ik}=\theta_{ik}^{\prime}-\theta_{i0}</annotation></semantics></math>, is sent back to the central server, where it is used to update the hypernetwork:</p>
</div>
<div id="S3.SS4.p3" class="ltx_para ltx_noindent">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="\phi_{k}=\phi_{0}-\frac{1}{n}\sum_{i=1}^{n}\alpha\nabla_{\phi_{0}}\theta_{i0}^{T}\Delta\theta_{ik}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msub id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml"><mi id="S3.E4.m1.1.1.2.2" xref="S3.E4.m1.1.1.2.2.cmml">ϕ</mi><mi id="S3.E4.m1.1.1.2.3" xref="S3.E4.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><msub id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml"><mi id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml">ϕ</mi><mn id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml">0</mn></msub><mo id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">−</mo><mrow id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><mfrac id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml"><mn id="S3.E4.m1.1.1.3.3.2.2" xref="S3.E4.m1.1.1.3.3.2.2.cmml">1</mn><mi id="S3.E4.m1.1.1.3.3.2.3" xref="S3.E4.m1.1.1.3.3.2.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.3.3.1" xref="S3.E4.m1.1.1.3.3.1.cmml">​</mo><mrow id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml"><munderover id="S3.E4.m1.1.1.3.3.3.1" xref="S3.E4.m1.1.1.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E4.m1.1.1.3.3.3.1.2.2" xref="S3.E4.m1.1.1.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.1.1.3.3.3.1.2.3" xref="S3.E4.m1.1.1.3.3.3.1.2.3.cmml"><mi id="S3.E4.m1.1.1.3.3.3.1.2.3.2" xref="S3.E4.m1.1.1.3.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E4.m1.1.1.3.3.3.1.2.3.1" xref="S3.E4.m1.1.1.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E4.m1.1.1.3.3.3.1.2.3.3" xref="S3.E4.m1.1.1.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.1.1.3.3.3.1.3" xref="S3.E4.m1.1.1.3.3.3.1.3.cmml">n</mi></munderover><mrow id="S3.E4.m1.1.1.3.3.3.2" xref="S3.E4.m1.1.1.3.3.3.2.cmml"><mi id="S3.E4.m1.1.1.3.3.3.2.2" xref="S3.E4.m1.1.1.3.3.3.2.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="S3.E4.m1.1.1.3.3.3.2.1" xref="S3.E4.m1.1.1.3.3.3.2.1.cmml">​</mo><mrow id="S3.E4.m1.1.1.3.3.3.2.3" xref="S3.E4.m1.1.1.3.3.3.2.3.cmml"><msub id="S3.E4.m1.1.1.3.3.3.2.3.1" xref="S3.E4.m1.1.1.3.3.3.2.3.1.cmml"><mo rspace="0.167em" id="S3.E4.m1.1.1.3.3.3.2.3.1.2" xref="S3.E4.m1.1.1.3.3.3.2.3.1.2.cmml">∇</mo><msub id="S3.E4.m1.1.1.3.3.3.2.3.1.3" xref="S3.E4.m1.1.1.3.3.3.2.3.1.3.cmml"><mi id="S3.E4.m1.1.1.3.3.3.2.3.1.3.2" xref="S3.E4.m1.1.1.3.3.3.2.3.1.3.2.cmml">ϕ</mi><mn id="S3.E4.m1.1.1.3.3.3.2.3.1.3.3" xref="S3.E4.m1.1.1.3.3.3.2.3.1.3.3.cmml">0</mn></msub></msub><mrow id="S3.E4.m1.1.1.3.3.3.2.3.2" xref="S3.E4.m1.1.1.3.3.3.2.3.2.cmml"><msubsup id="S3.E4.m1.1.1.3.3.3.2.3.2.2" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.cmml"><mi id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.2" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.2.cmml">θ</mi><mrow id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.2" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.1" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.1.cmml">​</mo><mn id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.3" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.3.cmml">0</mn></mrow><mi id="S3.E4.m1.1.1.3.3.3.2.3.2.2.3" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.3.3.3.2.3.2.1" xref="S3.E4.m1.1.1.3.3.3.2.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E4.m1.1.1.3.3.3.2.3.2.3" xref="S3.E4.m1.1.1.3.3.3.2.3.2.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.3.3.3.2.3.2.1a" xref="S3.E4.m1.1.1.3.3.3.2.3.2.1.cmml">​</mo><msub id="S3.E4.m1.1.1.3.3.3.2.3.2.4" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.cmml"><mi id="S3.E4.m1.1.1.3.3.3.2.3.2.4.2" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.2.cmml">θ</mi><mrow id="S3.E4.m1.1.1.3.3.3.2.3.2.4.3" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.cmml"><mi id="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.2" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.1" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.3" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.3.cmml">k</mi></mrow></msub></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></eq><apply id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.2.2.cmml" xref="S3.E4.m1.1.1.2.2">italic-ϕ</ci><ci id="S3.E4.m1.1.1.2.3.cmml" xref="S3.E4.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><minus id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1"></minus><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2">italic-ϕ</ci><cn type="integer" id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3">0</cn></apply><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><times id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.1"></times><apply id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2"><divide id="S3.E4.m1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.1.1.3.3.2"></divide><cn type="integer" id="S3.E4.m1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.1.1.3.3.2.2">1</cn><ci id="S3.E4.m1.1.1.3.3.2.3.cmml" xref="S3.E4.m1.1.1.3.3.2.3">𝑛</ci></apply><apply id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3"><apply id="S3.E4.m1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.1.1.cmml" xref="S3.E4.m1.1.1.3.3.3.1">superscript</csymbol><apply id="S3.E4.m1.1.1.3.3.3.1.2.cmml" xref="S3.E4.m1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.1.2.1.cmml" xref="S3.E4.m1.1.1.3.3.3.1">subscript</csymbol><sum id="S3.E4.m1.1.1.3.3.3.1.2.2.cmml" xref="S3.E4.m1.1.1.3.3.3.1.2.2"></sum><apply id="S3.E4.m1.1.1.3.3.3.1.2.3.cmml" xref="S3.E4.m1.1.1.3.3.3.1.2.3"><eq id="S3.E4.m1.1.1.3.3.3.1.2.3.1.cmml" xref="S3.E4.m1.1.1.3.3.3.1.2.3.1"></eq><ci id="S3.E4.m1.1.1.3.3.3.1.2.3.2.cmml" xref="S3.E4.m1.1.1.3.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.1.1.3.3.3.1.2.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.1.1.3.3.3.1.3.cmml" xref="S3.E4.m1.1.1.3.3.3.1.3">𝑛</ci></apply><apply id="S3.E4.m1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2"><times id="S3.E4.m1.1.1.3.3.3.2.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.1"></times><ci id="S3.E4.m1.1.1.3.3.3.2.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.2">𝛼</ci><apply id="S3.E4.m1.1.1.3.3.3.2.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3"><apply id="S3.E4.m1.1.1.3.3.3.2.3.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.2.3.1.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.1">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.3.2.3.1.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.1.2">∇</ci><apply id="S3.E4.m1.1.1.3.3.3.2.3.1.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.2.3.1.3.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.3.2.3.1.3.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.1.3.2">italic-ϕ</ci><cn type="integer" id="S3.E4.m1.1.1.3.3.3.2.3.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.1.3.3">0</cn></apply></apply><apply id="S3.E4.m1.1.1.3.3.3.2.3.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2"><times id="S3.E4.m1.1.1.3.3.3.2.3.2.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.1"></times><apply id="S3.E4.m1.1.1.3.3.3.2.3.2.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.2.3.2.2.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2">superscript</csymbol><apply id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.2">𝜃</ci><apply id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3"><times id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.1"></times><ci id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.2.3.3">0</cn></apply></apply><ci id="S3.E4.m1.1.1.3.3.3.2.3.2.2.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.2.3">𝑇</ci></apply><ci id="S3.E4.m1.1.1.3.3.3.2.3.2.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.3">Δ</ci><apply id="S3.E4.m1.1.1.3.3.3.2.3.2.4.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.3.2.3.2.4.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.3.2.3.2.4.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.2">𝜃</ci><apply id="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.3"><times id="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.1.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.1"></times><ci id="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.2.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.2">𝑖</ci><ci id="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3.2.3.2.4.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\phi_{k}=\phi_{0}-\frac{1}{n}\sum_{i=1}^{n}\alpha\nabla_{\phi_{0}}\theta_{i0}^{T}\Delta\theta_{ik}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p4" class="ltx_para ltx_noindent">
<p id="S3.SS4.p4.1" class="ltx_p">Since the hypernetwork outputs neural networks conditioned on the environment, it is able to create RL agents that are personalized to the needs of each microgrid. We also still preserve privacy by only communicating parameters with the central server instead of data.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Personalized Federated Hypernetworks</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> Environments <math id="alg1.l1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">E</annotation></semantics></math> and hypernetwork <math id="alg1.l1.m2.1" class="ltx_Math" alttext="H_{\phi}" display="inline"><semantics id="alg1.l1.m2.1a"><msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">H</mi><mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">𝐻</ci><ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">H_{\phi}</annotation></semantics></math>. For each environment <math id="alg1.l1.m3.1" class="ltx_Math" alttext="e\in E" display="inline"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">e</mi><mo id="alg1.l1.m3.1.1.1" xref="alg1.l1.m3.1.1.1.cmml">∈</mo><mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><in id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1.1"></in><ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">𝑒</ci><ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">e\in E</annotation></semantics></math>, an RL policy <math id="alg1.l1.m4.1" class="ltx_Math" alttext="A(e)" display="inline"><semantics id="alg1.l1.m4.1a"><mrow id="alg1.l1.m4.1.2" xref="alg1.l1.m4.1.2.cmml"><mi id="alg1.l1.m4.1.2.2" xref="alg1.l1.m4.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m4.1.2.1" xref="alg1.l1.m4.1.2.1.cmml">​</mo><mrow id="alg1.l1.m4.1.2.3.2" xref="alg1.l1.m4.1.2.cmml"><mo stretchy="false" id="alg1.l1.m4.1.2.3.2.1" xref="alg1.l1.m4.1.2.cmml">(</mo><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">e</mi><mo stretchy="false" id="alg1.l1.m4.1.2.3.2.2" xref="alg1.l1.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.2.cmml" xref="alg1.l1.m4.1.2"><times id="alg1.l1.m4.1.2.1.cmml" xref="alg1.l1.m4.1.2.1"></times><ci id="alg1.l1.m4.1.2.2.cmml" xref="alg1.l1.m4.1.2.2">𝐴</ci><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">A(e)</annotation></semantics></math> and hypernetwork-specified parameters <math id="alg1.l1.m5.1" class="ltx_Math" alttext="H_{\phi}(e)" display="inline"><semantics id="alg1.l1.m5.1a"><mrow id="alg1.l1.m5.1.2" xref="alg1.l1.m5.1.2.cmml"><msub id="alg1.l1.m5.1.2.2" xref="alg1.l1.m5.1.2.2.cmml"><mi id="alg1.l1.m5.1.2.2.2" xref="alg1.l1.m5.1.2.2.2.cmml">H</mi><mi id="alg1.l1.m5.1.2.2.3" xref="alg1.l1.m5.1.2.2.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l1.m5.1.2.1" xref="alg1.l1.m5.1.2.1.cmml">​</mo><mrow id="alg1.l1.m5.1.2.3.2" xref="alg1.l1.m5.1.2.cmml"><mo stretchy="false" id="alg1.l1.m5.1.2.3.2.1" xref="alg1.l1.m5.1.2.cmml">(</mo><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">e</mi><mo stretchy="false" id="alg1.l1.m5.1.2.3.2.2" xref="alg1.l1.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.2.cmml" xref="alg1.l1.m5.1.2"><times id="alg1.l1.m5.1.2.1.cmml" xref="alg1.l1.m5.1.2.1"></times><apply id="alg1.l1.m5.1.2.2.cmml" xref="alg1.l1.m5.1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m5.1.2.2.1.cmml" xref="alg1.l1.m5.1.2.2">subscript</csymbol><ci id="alg1.l1.m5.1.2.2.2.cmml" xref="alg1.l1.m5.1.2.2.2">𝐻</ci><ci id="alg1.l1.m5.1.2.2.3.cmml" xref="alg1.l1.m5.1.2.2.3">italic-ϕ</ci></apply><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">H_{\phi}(e)</annotation></semantics></math>.

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Hyperparameters:</span> Number of rounds <math id="alg1.l2.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">R</annotation></semantics></math>, number of local training steps per hypernetwork update <math id="alg1.l2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">K</annotation></semantics></math>, learning rate <math id="alg1.l2.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg1.l2.m3.1a"><mi id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><ci id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\alpha</annotation></semantics></math>.

</div>
<div id="alg1.l3" class="ltx_listingline">  <span id="alg1.l3.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.3" class="ltx_Math" alttext="r=1,\dots,R" display="inline"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mi id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml">r</mi><mo id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">=</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">…</mi><mo id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">R</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><eq id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></eq><ci id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2">𝑟</ci><list id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">…</ci><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">𝑅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">r=1,\dots,R</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">     <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> environment <math id="alg1.l4.m1.1" class="ltx_Math" alttext="e\in E" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">e</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑒</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">e\in E</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">        Get parameters <math id="alg1.l5.m1.3" class="ltx_Math" alttext="\tilde{\theta}(e)\coloneqq\theta(e)\coloneqq H_{\phi}(e)" display="inline"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.4" xref="alg1.l5.m1.3.4.cmml"><mrow id="alg1.l5.m1.3.4.2" xref="alg1.l5.m1.3.4.2.cmml"><mover accent="true" id="alg1.l5.m1.3.4.2.2" xref="alg1.l5.m1.3.4.2.2.cmml"><mi id="alg1.l5.m1.3.4.2.2.2" xref="alg1.l5.m1.3.4.2.2.2.cmml">θ</mi><mo id="alg1.l5.m1.3.4.2.2.1" xref="alg1.l5.m1.3.4.2.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.4.2.1" xref="alg1.l5.m1.3.4.2.1.cmml">​</mo><mrow id="alg1.l5.m1.3.4.2.3.2" xref="alg1.l5.m1.3.4.2.cmml"><mo stretchy="false" id="alg1.l5.m1.3.4.2.3.2.1" xref="alg1.l5.m1.3.4.2.cmml">(</mo><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">e</mi><mo stretchy="false" id="alg1.l5.m1.3.4.2.3.2.2" xref="alg1.l5.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="alg1.l5.m1.3.4.3" xref="alg1.l5.m1.3.4.3.cmml">≔</mo><mrow id="alg1.l5.m1.3.4.4" xref="alg1.l5.m1.3.4.4.cmml"><mi id="alg1.l5.m1.3.4.4.2" xref="alg1.l5.m1.3.4.4.2.cmml">θ</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.4.4.1" xref="alg1.l5.m1.3.4.4.1.cmml">​</mo><mrow id="alg1.l5.m1.3.4.4.3.2" xref="alg1.l5.m1.3.4.4.cmml"><mo stretchy="false" id="alg1.l5.m1.3.4.4.3.2.1" xref="alg1.l5.m1.3.4.4.cmml">(</mo><mi id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">e</mi><mo stretchy="false" id="alg1.l5.m1.3.4.4.3.2.2" xref="alg1.l5.m1.3.4.4.cmml">)</mo></mrow></mrow><mo id="alg1.l5.m1.3.4.5" xref="alg1.l5.m1.3.4.5.cmml">≔</mo><mrow id="alg1.l5.m1.3.4.6" xref="alg1.l5.m1.3.4.6.cmml"><msub id="alg1.l5.m1.3.4.6.2" xref="alg1.l5.m1.3.4.6.2.cmml"><mi id="alg1.l5.m1.3.4.6.2.2" xref="alg1.l5.m1.3.4.6.2.2.cmml">H</mi><mi id="alg1.l5.m1.3.4.6.2.3" xref="alg1.l5.m1.3.4.6.2.3.cmml">ϕ</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l5.m1.3.4.6.1" xref="alg1.l5.m1.3.4.6.1.cmml">​</mo><mrow id="alg1.l5.m1.3.4.6.3.2" xref="alg1.l5.m1.3.4.6.cmml"><mo stretchy="false" id="alg1.l5.m1.3.4.6.3.2.1" xref="alg1.l5.m1.3.4.6.cmml">(</mo><mi id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">e</mi><mo stretchy="false" id="alg1.l5.m1.3.4.6.3.2.2" xref="alg1.l5.m1.3.4.6.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.4.cmml" xref="alg1.l5.m1.3.4"><and id="alg1.l5.m1.3.4a.cmml" xref="alg1.l5.m1.3.4"></and><apply id="alg1.l5.m1.3.4b.cmml" xref="alg1.l5.m1.3.4"><ci id="alg1.l5.m1.3.4.3.cmml" xref="alg1.l5.m1.3.4.3">≔</ci><apply id="alg1.l5.m1.3.4.2.cmml" xref="alg1.l5.m1.3.4.2"><times id="alg1.l5.m1.3.4.2.1.cmml" xref="alg1.l5.m1.3.4.2.1"></times><apply id="alg1.l5.m1.3.4.2.2.cmml" xref="alg1.l5.m1.3.4.2.2"><ci id="alg1.l5.m1.3.4.2.2.1.cmml" xref="alg1.l5.m1.3.4.2.2.1">~</ci><ci id="alg1.l5.m1.3.4.2.2.2.cmml" xref="alg1.l5.m1.3.4.2.2.2">𝜃</ci></apply><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑒</ci></apply><apply id="alg1.l5.m1.3.4.4.cmml" xref="alg1.l5.m1.3.4.4"><times id="alg1.l5.m1.3.4.4.1.cmml" xref="alg1.l5.m1.3.4.4.1"></times><ci id="alg1.l5.m1.3.4.4.2.cmml" xref="alg1.l5.m1.3.4.4.2">𝜃</ci><ci id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">𝑒</ci></apply></apply><apply id="alg1.l5.m1.3.4c.cmml" xref="alg1.l5.m1.3.4"><ci id="alg1.l5.m1.3.4.5.cmml" xref="alg1.l5.m1.3.4.5">≔</ci><share href="#alg1.l5.m1.3.4.4.cmml" id="alg1.l5.m1.3.4d.cmml" xref="alg1.l5.m1.3.4"></share><apply id="alg1.l5.m1.3.4.6.cmml" xref="alg1.l5.m1.3.4.6"><times id="alg1.l5.m1.3.4.6.1.cmml" xref="alg1.l5.m1.3.4.6.1"></times><apply id="alg1.l5.m1.3.4.6.2.cmml" xref="alg1.l5.m1.3.4.6.2"><csymbol cd="ambiguous" id="alg1.l5.m1.3.4.6.2.1.cmml" xref="alg1.l5.m1.3.4.6.2">subscript</csymbol><ci id="alg1.l5.m1.3.4.6.2.2.cmml" xref="alg1.l5.m1.3.4.6.2.2">𝐻</ci><ci id="alg1.l5.m1.3.4.6.2.3.cmml" xref="alg1.l5.m1.3.4.6.2.3">italic-ϕ</ci></apply><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">\tilde{\theta}(e)\coloneqq\theta(e)\coloneqq H_{\phi}(e)</annotation></semantics></math>.

</div>
<div id="alg1.l6" class="ltx_listingline">        <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l6.m1.3" class="ltx_Math" alttext="k=1,\dots,K" display="inline"><semantics id="alg1.l6.m1.3a"><mrow id="alg1.l6.m1.3.4" xref="alg1.l6.m1.3.4.cmml"><mi id="alg1.l6.m1.3.4.2" xref="alg1.l6.m1.3.4.2.cmml">k</mi><mo id="alg1.l6.m1.3.4.1" xref="alg1.l6.m1.3.4.1.cmml">=</mo><mrow id="alg1.l6.m1.3.4.3.2" xref="alg1.l6.m1.3.4.3.1.cmml"><mn id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">1</mn><mo id="alg1.l6.m1.3.4.3.2.1" xref="alg1.l6.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">…</mi><mo id="alg1.l6.m1.3.4.3.2.2" xref="alg1.l6.m1.3.4.3.1.cmml">,</mo><mi id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.3b"><apply id="alg1.l6.m1.3.4.cmml" xref="alg1.l6.m1.3.4"><eq id="alg1.l6.m1.3.4.1.cmml" xref="alg1.l6.m1.3.4.1"></eq><ci id="alg1.l6.m1.3.4.2.cmml" xref="alg1.l6.m1.3.4.2">𝑘</ci><list id="alg1.l6.m1.3.4.3.1.cmml" xref="alg1.l6.m1.3.4.3.2"><cn type="integer" id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">1</cn><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">…</ci><ci id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.3c">k=1,\dots,K</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">           Collect rollouts <math id="alg1.l7.m1.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">R</annotation></semantics></math> from <math id="alg1.l7.m2.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">e</annotation></semantics></math> using policy <math id="alg1.l7.m3.1" class="ltx_Math" alttext="A(e)" display="inline"><semantics id="alg1.l7.m3.1a"><mrow id="alg1.l7.m3.1.2" xref="alg1.l7.m3.1.2.cmml"><mi id="alg1.l7.m3.1.2.2" xref="alg1.l7.m3.1.2.2.cmml">A</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m3.1.2.1" xref="alg1.l7.m3.1.2.1.cmml">​</mo><mrow id="alg1.l7.m3.1.2.3.2" xref="alg1.l7.m3.1.2.cmml"><mo stretchy="false" id="alg1.l7.m3.1.2.3.2.1" xref="alg1.l7.m3.1.2.cmml">(</mo><mi id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml">e</mi><mo stretchy="false" id="alg1.l7.m3.1.2.3.2.2" xref="alg1.l7.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><apply id="alg1.l7.m3.1.2.cmml" xref="alg1.l7.m3.1.2"><times id="alg1.l7.m3.1.2.1.cmml" xref="alg1.l7.m3.1.2.1"></times><ci id="alg1.l7.m3.1.2.2.cmml" xref="alg1.l7.m3.1.2.2">𝐴</ci><ci id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">A(e)</annotation></semantics></math> with parameters <math id="alg1.l7.m4.1" class="ltx_Math" alttext="{\tilde{\theta}(e)}" display="inline"><semantics id="alg1.l7.m4.1a"><mrow id="alg1.l7.m4.1.2" xref="alg1.l7.m4.1.2.cmml"><mover accent="true" id="alg1.l7.m4.1.2.2" xref="alg1.l7.m4.1.2.2.cmml"><mi id="alg1.l7.m4.1.2.2.2" xref="alg1.l7.m4.1.2.2.2.cmml">θ</mi><mo id="alg1.l7.m4.1.2.2.1" xref="alg1.l7.m4.1.2.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="alg1.l7.m4.1.2.1" xref="alg1.l7.m4.1.2.1.cmml">​</mo><mrow id="alg1.l7.m4.1.2.3.2" xref="alg1.l7.m4.1.2.cmml"><mo stretchy="false" id="alg1.l7.m4.1.2.3.2.1" xref="alg1.l7.m4.1.2.cmml">(</mo><mi id="alg1.l7.m4.1.1" xref="alg1.l7.m4.1.1.cmml">e</mi><mo stretchy="false" id="alg1.l7.m4.1.2.3.2.2" xref="alg1.l7.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m4.1b"><apply id="alg1.l7.m4.1.2.cmml" xref="alg1.l7.m4.1.2"><times id="alg1.l7.m4.1.2.1.cmml" xref="alg1.l7.m4.1.2.1"></times><apply id="alg1.l7.m4.1.2.2.cmml" xref="alg1.l7.m4.1.2.2"><ci id="alg1.l7.m4.1.2.2.1.cmml" xref="alg1.l7.m4.1.2.2.1">~</ci><ci id="alg1.l7.m4.1.2.2.2.cmml" xref="alg1.l7.m4.1.2.2.2">𝜃</ci></apply><ci id="alg1.l7.m4.1.1.cmml" xref="alg1.l7.m4.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m4.1c">{\tilde{\theta}(e)}</annotation></semantics></math>.

</div>
<div id="alg1.l8" class="ltx_listingline">           Update <math id="alg1.l8.m1.1" class="ltx_Math" alttext="\tilde{\theta}(e)" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.2" xref="alg1.l8.m1.1.2.cmml"><mover accent="true" id="alg1.l8.m1.1.2.2" xref="alg1.l8.m1.1.2.2.cmml"><mi id="alg1.l8.m1.1.2.2.2" xref="alg1.l8.m1.1.2.2.2.cmml">θ</mi><mo id="alg1.l8.m1.1.2.2.1" xref="alg1.l8.m1.1.2.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="alg1.l8.m1.1.2.1" xref="alg1.l8.m1.1.2.1.cmml">​</mo><mrow id="alg1.l8.m1.1.2.3.2" xref="alg1.l8.m1.1.2.cmml"><mo stretchy="false" id="alg1.l8.m1.1.2.3.2.1" xref="alg1.l8.m1.1.2.cmml">(</mo><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">e</mi><mo stretchy="false" id="alg1.l8.m1.1.2.3.2.2" xref="alg1.l8.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.2.cmml" xref="alg1.l8.m1.1.2"><times id="alg1.l8.m1.1.2.1.cmml" xref="alg1.l8.m1.1.2.1"></times><apply id="alg1.l8.m1.1.2.2.cmml" xref="alg1.l8.m1.1.2.2"><ci id="alg1.l8.m1.1.2.2.1.cmml" xref="alg1.l8.m1.1.2.2.1">~</ci><ci id="alg1.l8.m1.1.2.2.2.cmml" xref="alg1.l8.m1.1.2.2.2">𝜃</ci></apply><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\tilde{\theta}(e)</annotation></semantics></math> using PPO with rollouts <math id="alg1.l8.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">R</annotation></semantics></math>.

</div>
<div id="alg1.l9" class="ltx_listingline">     Initialize <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\bar{\phi}_{\mathrm{update}}\coloneqq 0" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mover accent="true" id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml"><mi id="alg1.l9.m1.1.1.2.2.2" xref="alg1.l9.m1.1.1.2.2.2.cmml">ϕ</mi><mo id="alg1.l9.m1.1.1.2.2.1" xref="alg1.l9.m1.1.1.2.2.1.cmml">¯</mo></mover><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">update</mi></msub><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">≔</mo><mn id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">≔</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><apply id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2"><ci id="alg1.l9.m1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.2.2.1">¯</ci><ci id="alg1.l9.m1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.2.2.2">italic-ϕ</ci></apply><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">update</ci></apply><cn type="integer" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\bar{\phi}_{\mathrm{update}}\coloneqq 0</annotation></semantics></math>.

</div>
<div id="alg1.l10" class="ltx_listingline">     <span id="alg1.l10.1" class="ltx_text ltx_font_bold">for</span> environment <math id="alg1.l10.m1.1" class="ltx_Math" alttext="e\in E" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">e</mi><mo id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">∈</mo><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><in id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"></in><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑒</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">e\in E</annotation></semantics></math> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l11" class="ltx_listingline">        <math id="alg1.l11.m1.3" class="ltx_Math" alttext="\Delta\theta(e)\coloneqq\tilde{\theta}(e)-\theta(e)" display="inline"><semantics id="alg1.l11.m1.3a"><mrow id="alg1.l11.m1.3.4" xref="alg1.l11.m1.3.4.cmml"><mrow id="alg1.l11.m1.3.4.2" xref="alg1.l11.m1.3.4.2.cmml"><mi mathvariant="normal" id="alg1.l11.m1.3.4.2.2" xref="alg1.l11.m1.3.4.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.3.4.2.1" xref="alg1.l11.m1.3.4.2.1.cmml">​</mo><mi id="alg1.l11.m1.3.4.2.3" xref="alg1.l11.m1.3.4.2.3.cmml">θ</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.3.4.2.1a" xref="alg1.l11.m1.3.4.2.1.cmml">​</mo><mrow id="alg1.l11.m1.3.4.2.4.2" xref="alg1.l11.m1.3.4.2.cmml"><mo stretchy="false" id="alg1.l11.m1.3.4.2.4.2.1" xref="alg1.l11.m1.3.4.2.cmml">(</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">e</mi><mo stretchy="false" id="alg1.l11.m1.3.4.2.4.2.2" xref="alg1.l11.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="alg1.l11.m1.3.4.1" xref="alg1.l11.m1.3.4.1.cmml">≔</mo><mrow id="alg1.l11.m1.3.4.3" xref="alg1.l11.m1.3.4.3.cmml"><mrow id="alg1.l11.m1.3.4.3.2" xref="alg1.l11.m1.3.4.3.2.cmml"><mover accent="true" id="alg1.l11.m1.3.4.3.2.2" xref="alg1.l11.m1.3.4.3.2.2.cmml"><mi id="alg1.l11.m1.3.4.3.2.2.2" xref="alg1.l11.m1.3.4.3.2.2.2.cmml">θ</mi><mo id="alg1.l11.m1.3.4.3.2.2.1" xref="alg1.l11.m1.3.4.3.2.2.1.cmml">~</mo></mover><mo lspace="0em" rspace="0em" id="alg1.l11.m1.3.4.3.2.1" xref="alg1.l11.m1.3.4.3.2.1.cmml">​</mo><mrow id="alg1.l11.m1.3.4.3.2.3.2" xref="alg1.l11.m1.3.4.3.2.cmml"><mo stretchy="false" id="alg1.l11.m1.3.4.3.2.3.2.1" xref="alg1.l11.m1.3.4.3.2.cmml">(</mo><mi id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">e</mi><mo stretchy="false" id="alg1.l11.m1.3.4.3.2.3.2.2" xref="alg1.l11.m1.3.4.3.2.cmml">)</mo></mrow></mrow><mo id="alg1.l11.m1.3.4.3.1" xref="alg1.l11.m1.3.4.3.1.cmml">−</mo><mrow id="alg1.l11.m1.3.4.3.3" xref="alg1.l11.m1.3.4.3.3.cmml"><mi id="alg1.l11.m1.3.4.3.3.2" xref="alg1.l11.m1.3.4.3.3.2.cmml">θ</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.3.4.3.3.1" xref="alg1.l11.m1.3.4.3.3.1.cmml">​</mo><mrow id="alg1.l11.m1.3.4.3.3.3.2" xref="alg1.l11.m1.3.4.3.3.cmml"><mo stretchy="false" id="alg1.l11.m1.3.4.3.3.3.2.1" xref="alg1.l11.m1.3.4.3.3.cmml">(</mo><mi id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml">e</mi><mo stretchy="false" id="alg1.l11.m1.3.4.3.3.3.2.2" xref="alg1.l11.m1.3.4.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.3b"><apply id="alg1.l11.m1.3.4.cmml" xref="alg1.l11.m1.3.4"><ci id="alg1.l11.m1.3.4.1.cmml" xref="alg1.l11.m1.3.4.1">≔</ci><apply id="alg1.l11.m1.3.4.2.cmml" xref="alg1.l11.m1.3.4.2"><times id="alg1.l11.m1.3.4.2.1.cmml" xref="alg1.l11.m1.3.4.2.1"></times><ci id="alg1.l11.m1.3.4.2.2.cmml" xref="alg1.l11.m1.3.4.2.2">Δ</ci><ci id="alg1.l11.m1.3.4.2.3.cmml" xref="alg1.l11.m1.3.4.2.3">𝜃</ci><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑒</ci></apply><apply id="alg1.l11.m1.3.4.3.cmml" xref="alg1.l11.m1.3.4.3"><minus id="alg1.l11.m1.3.4.3.1.cmml" xref="alg1.l11.m1.3.4.3.1"></minus><apply id="alg1.l11.m1.3.4.3.2.cmml" xref="alg1.l11.m1.3.4.3.2"><times id="alg1.l11.m1.3.4.3.2.1.cmml" xref="alg1.l11.m1.3.4.3.2.1"></times><apply id="alg1.l11.m1.3.4.3.2.2.cmml" xref="alg1.l11.m1.3.4.3.2.2"><ci id="alg1.l11.m1.3.4.3.2.2.1.cmml" xref="alg1.l11.m1.3.4.3.2.2.1">~</ci><ci id="alg1.l11.m1.3.4.3.2.2.2.cmml" xref="alg1.l11.m1.3.4.3.2.2.2">𝜃</ci></apply><ci id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">𝑒</ci></apply><apply id="alg1.l11.m1.3.4.3.3.cmml" xref="alg1.l11.m1.3.4.3.3"><times id="alg1.l11.m1.3.4.3.3.1.cmml" xref="alg1.l11.m1.3.4.3.3.1"></times><ci id="alg1.l11.m1.3.4.3.3.2.cmml" xref="alg1.l11.m1.3.4.3.3.2">𝜃</ci><ci id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.3c">\Delta\theta(e)\coloneqq\tilde{\theta}(e)-\theta(e)</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">        <math id="alg1.l12.m1.3" class="ltx_Math" alttext="\bar{\phi}_{\mathrm{update}}\coloneqq\bar{\phi}_{\mathrm{update}}+\frac{\nabla_{\phi}\theta(e)^{T}\Delta\theta(e)}{|E|}" display="inline"><semantics id="alg1.l12.m1.3a"><mrow id="alg1.l12.m1.3.4" xref="alg1.l12.m1.3.4.cmml"><msub id="alg1.l12.m1.3.4.2" xref="alg1.l12.m1.3.4.2.cmml"><mover accent="true" id="alg1.l12.m1.3.4.2.2" xref="alg1.l12.m1.3.4.2.2.cmml"><mi id="alg1.l12.m1.3.4.2.2.2" xref="alg1.l12.m1.3.4.2.2.2.cmml">ϕ</mi><mo id="alg1.l12.m1.3.4.2.2.1" xref="alg1.l12.m1.3.4.2.2.1.cmml">¯</mo></mover><mi id="alg1.l12.m1.3.4.2.3" xref="alg1.l12.m1.3.4.2.3.cmml">update</mi></msub><mo id="alg1.l12.m1.3.4.1" xref="alg1.l12.m1.3.4.1.cmml">≔</mo><mrow id="alg1.l12.m1.3.4.3" xref="alg1.l12.m1.3.4.3.cmml"><msub id="alg1.l12.m1.3.4.3.2" xref="alg1.l12.m1.3.4.3.2.cmml"><mover accent="true" id="alg1.l12.m1.3.4.3.2.2" xref="alg1.l12.m1.3.4.3.2.2.cmml"><mi id="alg1.l12.m1.3.4.3.2.2.2" xref="alg1.l12.m1.3.4.3.2.2.2.cmml">ϕ</mi><mo id="alg1.l12.m1.3.4.3.2.2.1" xref="alg1.l12.m1.3.4.3.2.2.1.cmml">¯</mo></mover><mi id="alg1.l12.m1.3.4.3.2.3" xref="alg1.l12.m1.3.4.3.2.3.cmml">update</mi></msub><mo id="alg1.l12.m1.3.4.3.1" xref="alg1.l12.m1.3.4.3.1.cmml">+</mo><mfrac id="alg1.l12.m1.3.3" xref="alg1.l12.m1.3.3.cmml"><mrow id="alg1.l12.m1.2.2.2" xref="alg1.l12.m1.2.2.2.cmml"><mrow id="alg1.l12.m1.2.2.2.4" xref="alg1.l12.m1.2.2.2.4.cmml"><msub id="alg1.l12.m1.2.2.2.4.1" xref="alg1.l12.m1.2.2.2.4.1.cmml"><mo id="alg1.l12.m1.2.2.2.4.1.2" xref="alg1.l12.m1.2.2.2.4.1.2.cmml">∇</mo><mi id="alg1.l12.m1.2.2.2.4.1.3" xref="alg1.l12.m1.2.2.2.4.1.3.cmml">ϕ</mi></msub><mi id="alg1.l12.m1.2.2.2.4.2" xref="alg1.l12.m1.2.2.2.4.2.cmml">θ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.2.3" xref="alg1.l12.m1.2.2.2.3.cmml">​</mo><msup id="alg1.l12.m1.2.2.2.5" xref="alg1.l12.m1.2.2.2.5.cmml"><mrow id="alg1.l12.m1.2.2.2.5.2.2" xref="alg1.l12.m1.2.2.2.5.cmml"><mo stretchy="false" id="alg1.l12.m1.2.2.2.5.2.2.1" xref="alg1.l12.m1.2.2.2.5.cmml">(</mo><mi id="alg1.l12.m1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.cmml">e</mi><mo stretchy="false" id="alg1.l12.m1.2.2.2.5.2.2.2" xref="alg1.l12.m1.2.2.2.5.cmml">)</mo></mrow><mi id="alg1.l12.m1.2.2.2.5.3" xref="alg1.l12.m1.2.2.2.5.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.2.3a" xref="alg1.l12.m1.2.2.2.3.cmml">​</mo><mi mathvariant="normal" id="alg1.l12.m1.2.2.2.6" xref="alg1.l12.m1.2.2.2.6.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.2.3b" xref="alg1.l12.m1.2.2.2.3.cmml">​</mo><mi id="alg1.l12.m1.2.2.2.7" xref="alg1.l12.m1.2.2.2.7.cmml">θ</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.2.3c" xref="alg1.l12.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l12.m1.2.2.2.8.2" xref="alg1.l12.m1.2.2.2.cmml"><mo stretchy="false" id="alg1.l12.m1.2.2.2.8.2.1" xref="alg1.l12.m1.2.2.2.cmml">(</mo><mi id="alg1.l12.m1.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.cmml">e</mi><mo stretchy="false" id="alg1.l12.m1.2.2.2.8.2.2" xref="alg1.l12.m1.2.2.2.cmml">)</mo></mrow></mrow><mrow id="alg1.l12.m1.3.3.3.3" xref="alg1.l12.m1.3.3.3.2.cmml"><mo stretchy="false" id="alg1.l12.m1.3.3.3.3.1" xref="alg1.l12.m1.3.3.3.2.1.cmml">|</mo><mi id="alg1.l12.m1.3.3.3.1" xref="alg1.l12.m1.3.3.3.1.cmml">E</mi><mo stretchy="false" id="alg1.l12.m1.3.3.3.3.2" xref="alg1.l12.m1.3.3.3.2.1.cmml">|</mo></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.3b"><apply id="alg1.l12.m1.3.4.cmml" xref="alg1.l12.m1.3.4"><ci id="alg1.l12.m1.3.4.1.cmml" xref="alg1.l12.m1.3.4.1">≔</ci><apply id="alg1.l12.m1.3.4.2.cmml" xref="alg1.l12.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.4.2.1.cmml" xref="alg1.l12.m1.3.4.2">subscript</csymbol><apply id="alg1.l12.m1.3.4.2.2.cmml" xref="alg1.l12.m1.3.4.2.2"><ci id="alg1.l12.m1.3.4.2.2.1.cmml" xref="alg1.l12.m1.3.4.2.2.1">¯</ci><ci id="alg1.l12.m1.3.4.2.2.2.cmml" xref="alg1.l12.m1.3.4.2.2.2">italic-ϕ</ci></apply><ci id="alg1.l12.m1.3.4.2.3.cmml" xref="alg1.l12.m1.3.4.2.3">update</ci></apply><apply id="alg1.l12.m1.3.4.3.cmml" xref="alg1.l12.m1.3.4.3"><plus id="alg1.l12.m1.3.4.3.1.cmml" xref="alg1.l12.m1.3.4.3.1"></plus><apply id="alg1.l12.m1.3.4.3.2.cmml" xref="alg1.l12.m1.3.4.3.2"><csymbol cd="ambiguous" id="alg1.l12.m1.3.4.3.2.1.cmml" xref="alg1.l12.m1.3.4.3.2">subscript</csymbol><apply id="alg1.l12.m1.3.4.3.2.2.cmml" xref="alg1.l12.m1.3.4.3.2.2"><ci id="alg1.l12.m1.3.4.3.2.2.1.cmml" xref="alg1.l12.m1.3.4.3.2.2.1">¯</ci><ci id="alg1.l12.m1.3.4.3.2.2.2.cmml" xref="alg1.l12.m1.3.4.3.2.2.2">italic-ϕ</ci></apply><ci id="alg1.l12.m1.3.4.3.2.3.cmml" xref="alg1.l12.m1.3.4.3.2.3">update</ci></apply><apply id="alg1.l12.m1.3.3.cmml" xref="alg1.l12.m1.3.3"><divide id="alg1.l12.m1.3.3.4.cmml" xref="alg1.l12.m1.3.3"></divide><apply id="alg1.l12.m1.2.2.2.cmml" xref="alg1.l12.m1.2.2.2"><times id="alg1.l12.m1.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.3"></times><apply id="alg1.l12.m1.2.2.2.4.cmml" xref="alg1.l12.m1.2.2.2.4"><apply id="alg1.l12.m1.2.2.2.4.1.cmml" xref="alg1.l12.m1.2.2.2.4.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.2.4.1.1.cmml" xref="alg1.l12.m1.2.2.2.4.1">subscript</csymbol><ci id="alg1.l12.m1.2.2.2.4.1.2.cmml" xref="alg1.l12.m1.2.2.2.4.1.2">∇</ci><ci id="alg1.l12.m1.2.2.2.4.1.3.cmml" xref="alg1.l12.m1.2.2.2.4.1.3">italic-ϕ</ci></apply><ci id="alg1.l12.m1.2.2.2.4.2.cmml" xref="alg1.l12.m1.2.2.2.4.2">𝜃</ci></apply><apply id="alg1.l12.m1.2.2.2.5.cmml" xref="alg1.l12.m1.2.2.2.5"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.2.5.1.cmml" xref="alg1.l12.m1.2.2.2.5">superscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1">𝑒</ci><ci id="alg1.l12.m1.2.2.2.5.3.cmml" xref="alg1.l12.m1.2.2.2.5.3">𝑇</ci></apply><ci id="alg1.l12.m1.2.2.2.6.cmml" xref="alg1.l12.m1.2.2.2.6">Δ</ci><ci id="alg1.l12.m1.2.2.2.7.cmml" xref="alg1.l12.m1.2.2.2.7">𝜃</ci><ci id="alg1.l12.m1.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2">𝑒</ci></apply><apply id="alg1.l12.m1.3.3.3.2.cmml" xref="alg1.l12.m1.3.3.3.3"><abs id="alg1.l12.m1.3.3.3.2.1.cmml" xref="alg1.l12.m1.3.3.3.3.1"></abs><ci id="alg1.l12.m1.3.3.3.1.cmml" xref="alg1.l12.m1.3.3.3.1">𝐸</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.3c">\bar{\phi}_{\mathrm{update}}\coloneqq\bar{\phi}_{\mathrm{update}}+\frac{\nabla_{\phi}\theta(e)^{T}\Delta\theta(e)}{|E|}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">     Update hypernetwork parameters <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\phi=\phi-\alpha\cdot\bar{\phi}_{\mathrm{update}}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">ϕ</mi><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">=</mo><mrow id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2" xref="alg1.l13.m1.1.1.3.2.cmml">ϕ</mi><mo id="alg1.l13.m1.1.1.3.1" xref="alg1.l13.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml"><mi id="alg1.l13.m1.1.1.3.3.2" xref="alg1.l13.m1.1.1.3.3.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l13.m1.1.1.3.3.1" xref="alg1.l13.m1.1.1.3.3.1.cmml">⋅</mo><msub id="alg1.l13.m1.1.1.3.3.3" xref="alg1.l13.m1.1.1.3.3.3.cmml"><mover accent="true" id="alg1.l13.m1.1.1.3.3.3.2" xref="alg1.l13.m1.1.1.3.3.3.2.cmml"><mi id="alg1.l13.m1.1.1.3.3.3.2.2" xref="alg1.l13.m1.1.1.3.3.3.2.2.cmml">ϕ</mi><mo id="alg1.l13.m1.1.1.3.3.3.2.1" xref="alg1.l13.m1.1.1.3.3.3.2.1.cmml">¯</mo></mover><mi id="alg1.l13.m1.1.1.3.3.3.3" xref="alg1.l13.m1.1.1.3.3.3.3.cmml">update</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><eq id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></eq><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">italic-ϕ</ci><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><minus id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3.1"></minus><ci id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3.2">italic-ϕ</ci><apply id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3"><ci id="alg1.l13.m1.1.1.3.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.1">⋅</ci><ci id="alg1.l13.m1.1.1.3.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.2">𝛼</ci><apply id="alg1.l13.m1.1.1.3.3.3.cmml" xref="alg1.l13.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.3.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.3">subscript</csymbol><apply id="alg1.l13.m1.1.1.3.3.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2"><ci id="alg1.l13.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.1">¯</ci><ci id="alg1.l13.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.3.3.2.2">italic-ϕ</ci></apply><ci id="alg1.l13.m1.1.1.3.3.3.3.cmml" xref="alg1.l13.m1.1.1.3.3.3.3">update</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\phi=\phi-\alpha\cdot\bar{\phi}_{\mathrm{update}}</annotation></semantics></math>.

</div>
</div>
</figure>
</section>
<section id="S3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Diversity and optimal use of PFH</h3>

<div id="S3.SS5.p1" class="ltx_para ltx_noindent">
<p id="S3.SS5.p1.1" class="ltx_p">One factor that could affect the relative performance of PFH is the heterogeneity of the scenario. A homogeneous scenario (imagine a cookie-cutter residential neighborhood) could be suitable for federated learning methods due to similarity in behavior. In contrast, an extremely heterogeneous scenario (imagine mixed-use city blocks with night-life, shopping, and residential real estate) could have wildly different energy demands, which may be better learned by individual local networks without any mechanism to share learning. We hypothesize PFH will perform competitively in some average of these two extremes. If local environments are diverse yet share similar underlying mechanisms, PFH will be able to fit to local conditions while sharing information on common trends.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Setup</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Simulating Diverse Microgrids</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.4" class="ltx_p">Because each microgrid is defined by a distribution of photovoltaics and battery sizes, we propose a simple way to tweak the amount of diversity in a system. We sample photovoltaic and battery sizes from normal distributions, changing the variance <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="\sigma^{2}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msup id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">σ</mi><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝜎</ci><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">\sigma^{2}</annotation></semantics></math> as the diversity parameter, and round outcomes to the nearest integer<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>As we are sampling from a “hyper” distribution to instantiate houses, the means of the distribution are not as important as the variances in instantiating diversity.</span></span></span> We sample from <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{N}(\mu=100,\sigma=10)" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">​</mo><mrow id="S4.SS1.p1.2.m2.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.2.m2.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.cmml">(</mo><mrow id="S4.SS1.p1.2.m2.1.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml"><mrow id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml">μ</mi><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml">100</mn></mrow><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.2" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.2.cmml">σ</mi><mo id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.1" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.1.cmml">=</mo><mn id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.3" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.3.cmml">10</mn></mrow></mrow><mo stretchy="false" id="S4.SS1.p1.2.m2.1.1.1.1.3" xref="S4.SS1.p1.2.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><times id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2"></times><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝒩</ci><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.1.1.3a.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1"><eq id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.1"></eq><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.2">𝜇</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.1.1.3">100</cn></apply><apply id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2"><eq id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.1"></eq><ci id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.2">𝜎</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.1.1.1.2.2.3">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">\mathcal{N}(\mu=100,\sigma=10)</annotation></semantics></math> for low diversity cases, <math id="S4.SS1.p1.3.m3.2" class="ltx_Math" alttext="\mathcal{N}(100,30)" display="inline"><semantics id="S4.SS1.p1.3.m3.2a"><mrow id="S4.SS1.p1.3.m3.2.3" xref="S4.SS1.p1.3.m3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m3.2.3.2" xref="S4.SS1.p1.3.m3.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.3.m3.2.3.1" xref="S4.SS1.p1.3.m3.2.3.1.cmml">​</mo><mrow id="S4.SS1.p1.3.m3.2.3.3.2" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.2.3.3.2.1" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">(</mo><mn id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">100</mn><mo id="S4.SS1.p1.3.m3.2.3.3.2.2" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.3.m3.2.2" xref="S4.SS1.p1.3.m3.2.2.cmml">30</mn><mo stretchy="false" id="S4.SS1.p1.3.m3.2.3.3.2.3" xref="S4.SS1.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.2b"><apply id="S4.SS1.p1.3.m3.2.3.cmml" xref="S4.SS1.p1.3.m3.2.3"><times id="S4.SS1.p1.3.m3.2.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.1"></times><ci id="S4.SS1.p1.3.m3.2.3.2.cmml" xref="S4.SS1.p1.3.m3.2.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p1.3.m3.2.3.3.1.cmml" xref="S4.SS1.p1.3.m3.2.3.3.2"><cn type="integer" id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">100</cn><cn type="integer" id="S4.SS1.p1.3.m3.2.2.cmml" xref="S4.SS1.p1.3.m3.2.2">30</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.2c">\mathcal{N}(100,30)</annotation></semantics></math> for medium diversity and <math id="S4.SS1.p1.4.m4.2" class="ltx_Math" alttext="\mathcal{N}(100,50)" display="inline"><semantics id="S4.SS1.p1.4.m4.2a"><mrow id="S4.SS1.p1.4.m4.2.3" xref="S4.SS1.p1.4.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.4.m4.2.3.2" xref="S4.SS1.p1.4.m4.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.4.m4.2.3.1" xref="S4.SS1.p1.4.m4.2.3.1.cmml">​</mo><mrow id="S4.SS1.p1.4.m4.2.3.3.2" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m4.2.3.3.2.1" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">(</mo><mn id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">100</mn><mo id="S4.SS1.p1.4.m4.2.3.3.2.2" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p1.4.m4.2.2" xref="S4.SS1.p1.4.m4.2.2.cmml">50</mn><mo stretchy="false" id="S4.SS1.p1.4.m4.2.3.3.2.3" xref="S4.SS1.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.2b"><apply id="S4.SS1.p1.4.m4.2.3.cmml" xref="S4.SS1.p1.4.m4.2.3"><times id="S4.SS1.p1.4.m4.2.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3.1"></times><ci id="S4.SS1.p1.4.m4.2.3.2.cmml" xref="S4.SS1.p1.4.m4.2.3.2">𝒩</ci><interval closure="open" id="S4.SS1.p1.4.m4.2.3.3.1.cmml" xref="S4.SS1.p1.4.m4.2.3.3.2"><cn type="integer" id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">100</cn><cn type="integer" id="S4.SS1.p1.4.m4.2.2.cmml" xref="S4.SS1.p1.4.m4.2.2">50</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.2c">\mathcal{N}(100,50)</annotation></semantics></math> for high based on the spread of two standard deviations<span id="footnote7" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>All distributions are truncated at 0.</span></span></span>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Baselines</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">We compare PFH against FedAvg and two other baselines. First, we observe what happens with no RL control at all; the microgrid aggregator outputs prices that are exactly the same as the utility’s. We assume buildings choose to meet half their energy demand/surplus with the utility and half with the aggregator. Our second baseline is the approach used in <cite class="ltx_cite ltx_citemacro_citet">Agwan et al. (<a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>: training all the local RL controllers with only their own data: no central model or inter-microgrid communication. These two baselines, no RL and local control, are designed to highlight the added value of RL<span id="footnote8" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span>The most common non-RL methods for microgrid price-setting are iterative pricing methods (IP) <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib12" title="" class="ltx_ref">2017</a>; Wang &amp; Huang, <a href="#bib.bib28" title="" class="ltx_ref">2016</a>)</cite> in which buildings ”bargain” with microgrids to reach equilibrium prices. We exclude these baselines because they require <span id="footnote8.1" class="ltx_text ltx_font_italic">each building</span> to develop their own demand forecasts. This requirement raises the computational barrier for entry by an order of magnitude. For comparison, if we had 10 microgrids with 10 buildings each, local RL requires training 10 models (10 microgrids), PFH and FedAvg requires 11 (10 microgrids + 1 central model), and IP requires 100 (10 buildings x 10 microgrids). <cite class="ltx_cite ltx_citemacro_citet">Agwan et al. (<a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite> also showed RL results in less volatile pricing curves and better performance compared to IP.</span></span></span> to the task of price-setting for energy demand response in microgrids, and the added value of having some central model that aggregates learning across multiple microgrids, respectively.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">For specification on how we selected hyperparameters, please see Appendix <a href="#A5" title="Appendix E Appendix for Hyperparameter Exploration ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Cumulative profits above base utility pricing after 10,000 days, in hundred thousands.</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" style="padding-bottom:2.15277pt;padding-top:2.5pt;padding-bottom:2.5pt;">Scenario</th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-bottom:2.15277pt;padding-top:2.5pt;padding-bottom:2.5pt;">PFH</th>
<th id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-bottom:2.15277pt;padding-top:2.5pt;padding-bottom:2.5pt;">FedAvg</th>
<th id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" style="padding-bottom:2.15277pt;padding-top:2.5pt;padding-bottom:2.5pt;">Local Baseline</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">Simple, 5 agents</th>
<td id="S4.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">39.23</td>
<td id="S4.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.2.1.3.1" class="ltx_text ltx_font_bold">45.75</span></td>
<td id="S4.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-top:2.5pt;padding-bottom:2.5pt;">43.72</td>
</tr>
<tr id="S4.T1.1.3.2" class="ltx_tr">
<th id="S4.T1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">Simple, 10 agents</th>
<td id="S4.T1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">42.11</td>
<td id="S4.T1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">41.65</td>
<td id="S4.T1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.3.2.4.1" class="ltx_text ltx_font_bold">43.18</span></td>
</tr>
<tr id="S4.T1.1.4.3" class="ltx_tr">
<th id="S4.T1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">Simple, 20 agents</th>
<td id="S4.T1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">40.85</td>
<td id="S4.T1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">34.52</td>
<td id="S4.T1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.4.3.4.1" class="ltx_text ltx_font_bold">42.82</span></td>
</tr>
<tr id="S4.T1.1.5.4" class="ltx_tr">
<th id="S4.T1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">Medium, 5 agents</th>
<td id="S4.T1.1.5.4.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.5.4.2.1" class="ltx_text ltx_font_bold">47.50</span></td>
<td id="S4.T1.1.5.4.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">40.95</td>
<td id="S4.T1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">40.12</td>
</tr>
<tr id="S4.T1.1.6.5" class="ltx_tr">
<th id="S4.T1.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">Medium, 10 agents</th>
<td id="S4.T1.1.6.5.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.6.5.2.1" class="ltx_text ltx_font_bold">46.89</span></td>
<td id="S4.T1.1.6.5.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">43.82</td>
<td id="S4.T1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">41.73</td>
</tr>
<tr id="S4.T1.1.7.6" class="ltx_tr">
<th id="S4.T1.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">Medium, 20 agents</th>
<td id="S4.T1.1.7.6.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.7.6.2.1" class="ltx_text ltx_font_bold">48.22</span></td>
<td id="S4.T1.1.7.6.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">39.38</td>
<td id="S4.T1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">39.66</td>
</tr>
<tr id="S4.T1.1.8.7" class="ltx_tr">
<th id="S4.T1.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">Complex, 5 agents</th>
<td id="S4.T1.1.8.7.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">34.77</td>
<td id="S4.T1.1.8.7.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">32.66</td>
<td id="S4.T1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.8.7.4.1" class="ltx_text ltx_font_bold">35.60</span></td>
</tr>
<tr id="S4.T1.1.9.8" class="ltx_tr">
<th id="S4.T1.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">Complex, 10 agents</th>
<td id="S4.T1.1.9.8.2" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">43.01</td>
<td id="S4.T1.1.9.8.3" class="ltx_td ltx_align_center" style="padding-top:2.5pt;padding-bottom:2.5pt;">42.08</td>
<td id="S4.T1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.9.8.4.1" class="ltx_text ltx_font_bold">45.24</span></td>
</tr>
<tr id="S4.T1.1.10.9" class="ltx_tr">
<th id="S4.T1.1.10.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">Complex, 20 agents</th>
<td id="S4.T1.1.10.9.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.5pt;padding-bottom:2.5pt;"><span id="S4.T1.1.10.9.2.1" class="ltx_text ltx_font_bold">44.39</span></td>
<td id="S4.T1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:2.5pt;padding-bottom:2.5pt;">38.70</td>
<td id="S4.T1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r" style="padding-top:2.5pt;padding-bottom:2.5pt;">40.78</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Multi-Task Transfer</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">An interesting feature of our hypernetwork-based setup is the potential for multi-task learning and few-shot transfer learning. The optimization problem of setting prices for each microgrid can be viewed as an individual task. Since the hypernetwork should learn some common strategies for each task, we tested whether it can generalize to unseen tasks with little training. To test this hypothesis, we simply take a hypernetwork that has trained for to manage a microgrid cluster with 20 microgrids of medium diversity and train the hypernetwork to manage a <em id="S4.SS3.p1.1.1" class="ltx_emph ltx_font_italic">new</em> microgrid cluster of 20 microgrids with the same level of diversity. By pretraining our hypernetwork on 20 varied source tasks, we hope to encode enough knowledge applicable to the new target tasks to make few-shot transfer learning possible. We will refer to such a pretrained hypernetwork as a Few-Shot PFH.</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2210.06820/assets/figs/results_grid_updated.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_square" width="548" height="467" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S4.F2.2.1" class="ltx_text ltx_font_bold">RL Agent Performance:</span> The performance of the RL price-setting agent as a function of the number and diversity of the microgrids in the microgrid cluster . Performance is measured by looking at the average daily profit gained by each microgrid.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results and Discussion</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>PFH accelerates learning in medium diversity microgrid clusters </h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p">Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.3 Multi-Task Transfer ‣ 4 Experimental Setup ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows average daily profit gained by each microgrid in a microgrid cluster with 5, 10, and 20 microgrids, with varying amounts of diversity. The middle column of Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.3 Multi-Task Transfer ‣ 4 Experimental Setup ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows PFH is more efficient and profitable for a microgrid cluster than a microgrid cluster under a FedAvg or local control scheme. As shown in Table <a href="#S4.T1" title="Table 1 ‣ 4.2 Baselines ‣ 4 Experimental Setup ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, PFH results in up to $8,500,000 of additional cumulative profit after 10,000 days over the local control baseline in a microgrid cluster with 20 microgrids. However, this advantage does not carry over to cases of small or large diversity. For less diverse scenarios, PFH was comparable or less profitable than FedAvg or local control. For more diverse scenarios, local control was generally more profitable. The number of microgrids in microgrid clusters also did not seem to have much effect on learning speed here.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2210.06820/assets/figs/few_shot_updated.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="548" height="387" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S5.F3.5.1" class="ltx_text ltx_font_bold">PFH Enables Few Shot Learning:</span> <span id="S5.F3.6.2" class="ltx_text ltx_font_bold">A.</span> Mean microgrid profit of PFH pretrained on 20 microgrids learning to manage 20 new microgrids (“Pretrained PFH”), compared to randomly initialized PFH (“Baseline PFH”) and the local agents baseline (“Local Baseline”), over training days on the new microgrids. <span id="S5.F3.7.3" class="ltx_text ltx_font_bold">B.</span> Mean microgrid profit of PFH pretrained on 5, 10, and 20 microgrids on a new set of microgrids, over a longer time than A. <span id="S5.F3.8.4" class="ltx_text ltx_font_bold">C.</span> A plausible scenario in which PFH may need to quickly adapt to new microgrids.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>FedAvg recovers local performance at best</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p">Curiously, our results indicated that FedAvg presented did not improve the management of a microgrid cluster over a collection of local agents. We had expected FedAvg to perform better in the homogeneous case, and to scale with the number of agents, but neither effect appears in our results. Although FedAvg may perform well in supervised learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite>, it may not extend well to RL. We explain FedAvg’s poor performance as follows: unlike supervised learning, RL requires exploration. One could imagine each microgrid’s local agent explores in different direction to another, causing gradient updates that are not well conditioned when averaged together. Meanwhile, the hypernetwork is able to learn how to build RL policies with different exploration behaviors from the aggregated gradient because it outputs agents personalized to each task.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>PFH enables few-shot learning</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.4" class="ltx_p">Fig.<a href="#S5.F3" title="Figure 3 ‣ 5.1 PFH accelerates learning in medium diversity microgrid clusters ‣ 5 Results and Discussion ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.A shows the hypernetwork adapted to a new set of microgrid management tasks extremely quickly. On average, within <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mo id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><approx id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\approx</annotation></semantics></math> 1.5 months (42 days), each new microgrid achieved <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mo id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><approx id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\approx</annotation></semantics></math> $380 in daily profit, which is about the daily profit of the local agents baseline after 13 years (5000 days) of training. The original, randomly initialized PFH required 3000 days to achieve similar performance. Thus, Few-Shot PFH achieved a 119x speedup over local agents and 71.4x over a randomly initialized PFH over the first 1.5 months. Within 7 months (210 days), Few-Shot PFH achieved a daily profit of $565: 44% higher profit than the local agents ever achieve. A randomly initialized PFH required <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mo id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><approx id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">\approx</annotation></semantics></math> 22 years (8000 days) to achieve similar performance: a 38x speedup in the first 7 months of training. Cumulatively, having a pretrained PFH on 20 microgrids saves <math id="S5.SS3.p1.4.m4.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="S5.SS3.p1.4.m4.1a"><mo id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.1b"><approx id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.1c">\approx</annotation></semantics></math> $1,500,000 over the course of training on the new microgrid management tasks compared to a randomly initialized PFH.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Few-shot learning capability scales with microgrid cluster size</h3>

<div id="S5.SS4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS4.p1.1" class="ltx_p">When we tried the same experiment with hypernetworks that were trained for 10,000 days on 5 microgrid management tasks and 10 tasks in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.1 PFH accelerates learning in medium diversity microgrid clusters ‣ 5 Results and Discussion ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.B and tested on 5 and 10, respectively, we saw significantly smaller boosts in the mean reward over groups of new tasks with fewer training tasks. The smaller scale of benefit was expected given a multi-task learning strategy with fewer source tasks and data. Indeed, when trained on 5 tasks, there was hardly any initial training speedup. Starting from 10 tasks, we observed a large initial boost (although not as large as with 20.) Rather strikingly, Few-Shot PFH pretrained on 5 and 10 tasks converged to lower reward curves than even the baseline PFH (i.e., a randomly initialized hypernetwork.) With 20 tasks, we saw both a large initial boost in training speed and no adverse impact on long term training. We hypothesize the fewer microgrid source tasks provided, the more information is stored in the environment embedding, which makes the hypernetwork brittle to new environments. Thus in the 5 and 10 case, the net has not learned enough shared dynamics in the other parameters to generalize to new settings. In the case of 20 and above, we expect that enough shared dynamics are learned that the net can generalize. The range of training speed benefits we observed suggested the potential in some configurations for a Few-Shot PFH to quickly adapt to new tasks depends on how many tasks it was initially trained on.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitations and Future Work</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">Technically, our work is limited in several ways. We presented a “goldilocks” zone in which PFH outperforms other methods, but as we tested only in simulation, it is unclear how or where this goldilocks zone would appear in the real world. Second, we protect privacy by only communicating parameters, but it is possible to reconstruct data from parameters for some models <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
<div id="S6.p2" class="ltx_para ltx_noindent">
<p id="S6.p2.1" class="ltx_p">We would like to address these two issues in future work. First, we would like to explore other environments to determine whether the “goldilocks” phenomenon is unique to the MicrogridLearn environment. Second, we would like to combine our PFH training procedure with differential privacy measures like those in <cite class="ltx_cite ltx_citemacro_citet">Abadi et al. (<a href="#bib.bib1" title="" class="ltx_ref">2016</a>)</cite> to further impede reconstruction of training data.</p>
</div>
<div id="S6.p3" class="ltx_para ltx_noindent">
<p id="S6.p3.1" class="ltx_p">For two more extended examples of future work we are excited to test, as well as further discussion on potential societal impact of the application of our algorithm, please see Appendix <a href="#A3" title="Appendix C More Future Works ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a> and <a href="#A4" title="Appendix D Discussion of Societal Impact ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p id="S7.p1.1" class="ltx_p">We seek a privacy preserving mechanism for improved training speeds on profit-driven energy aggregation in a microgrid cluster . To this end, we are the first to demonstrate a PFH for RL to output local model gradient updates and show improved training times. We hypothesize that PFH shines when the setting is diverse enough to differ meaningfully between systems, but not so diverse that system behavior diverges. We prove our hypothesis and demonstrate the efficacy of PFH for few shot learning approaches.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abadi et al. (2016)</span>
<span class="ltx_bibblock">
Martin Abadi, Andy Chu, Ian Goodfellow, H Brendan McMahan, Ilya Mironov, Kunal
Talwar, and Li Zhang.

</span>
<span class="ltx_bibblock">Deep learning with differential privacy.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2016 ACM SIGSAC conference on computer
and communications security</em>, pp.  308–318, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agwan et al. (2021)</span>
<span class="ltx_bibblock">
Utkarsha Agwan, Lucas Spangher, William Arnold, Tarang Srivastava, Kameshwar
Poolla, and Costas J Spanos.

</span>
<span class="ltx_bibblock">Pricing in prosumer aggregations using reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Twelfth ACM International Conference on
Future Energy Systems</em>, pp.  220–224, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Albadi &amp; El-Saadany (2007)</span>
<span class="ltx_bibblock">
Mohamed H Albadi and Ehab F El-Saadany.

</span>
<span class="ltx_bibblock">Demand response in electricity markets: An overview.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">2007 IEEE power engineering society general meeting</em>, pp. 1–5. IEEE, 2007.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anwar &amp; Raychowdhury (2021)</span>
<span class="ltx_bibblock">
Aqeel Anwar and Arijit Raychowdhury.

</span>
<span class="ltx_bibblock">Multi-task federated reinforcement learning with adversaries.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2103.06473</em>, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav
Choudhary.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.00818</em>, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brockman et al. (2016)</span>
<span class="ltx_bibblock">
Greg Brockman, Vicki Cheung, Ludwig Pettersson, Jonas Schneider, John Schulman,
Jie Tang, and Wojciech Zaremba.

</span>
<span class="ltx_bibblock">Openai gym.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1606.01540</em>, 2016.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini et al. (2020)</span>
<span class="ltx_bibblock">
N Carlini, F Tramer, E Wallace, M Jagielski, A Herbert-Voss, K Lee, A Roberts,
T Brown, D Song, U Erlingsson, et al.

</span>
<span class="ltx_bibblock">Extracting training data from large language models. arxiv.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Preprint posted online December</em>, 14, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah et al. (2020)</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.

</span>
<span class="ltx_bibblock">Personalized federated learning: A meta-learning approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.07948</em>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2021)</span>
<span class="ltx_bibblock">
G. Han, S. Lee, J. Lee, K. Lee, and J. Bae.

</span>
<span class="ltx_bibblock">Deep-learning- and reinforcement-learning-based profitable strategy
of a grid-level energy storage system for the smart grid.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Journal of Energy Storage</em>, 41, 2021.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1016/j.est.2021.102868</span>.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.scopus.com/inward/record.uri?eid=2-s2.0-85109466142&amp;doi=10.1016%2fj.est.2021.102868&amp;partnerID=40&amp;md5=a9503a5cb3b35614969f648504d6b0cf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.scopus.com/inward/record.uri?eid=2-s2.0-85109466142&amp;doi=10.1016%2fj.est.2021.102868&amp;partnerID=40&amp;md5=a9503a5cb3b35614969f648504d6b0cf</a>.

</span>
<span class="ltx_bibblock">cited By 1.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jang et al. (2022)</span>
<span class="ltx_bibblock">
Doseok Jang, Lucas Spangher, Selvaprabu Nadarajah, and Costas Spanos.

</span>
<span class="ltx_bibblock">Decarbonizing buildings via energy demand response and deep
reinforcement learning: The deployment value of supervisory planning and
guardrails.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Available at SSRN 4078206</em>, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li &amp; Hong (2014)</span>
<span class="ltx_bibblock">
Xiao Hui Li and Seung Ho Hong.

</span>
<span class="ltx_bibblock">User-expected price-based demand response algorithm for a
home-to-grid system.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Energy</em>, 64:437–449, 2014.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2017)</span>
<span class="ltx_bibblock">
Nian Liu, Xinghuo Yu, Cheng Wang, Chaojie Li, Li Ma, and Jinyong Lei.

</span>
<span class="ltx_bibblock">Energy-sharing model with price-based demand response for microgrids
of peer-to-peer prosumers.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Power Systems</em>, 32(5):3569–3583, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lowe et al. (2017)</span>
<span class="ltx_bibblock">
Ryan Lowe, Yi I Wu, Aviv Tamar, Jean Harb, OpenAI Pieter Abbeel, and Igor
Mordatch.

</span>
<span class="ltx_bibblock">Multi-agent actor-critic for mixed cooperative-competitive
environments.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. (2021)</span>
<span class="ltx_bibblock">
Jiaju Qi, Qihao Zhou, Lei Lei, and Kan Zheng.

</span>
<span class="ltx_bibblock">Federated reinforcement learning: Techniques, applications, and open
challenges.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2108.11887</em>, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rashid et al. (2018)</span>
<span class="ltx_bibblock">
Tabish Rashid, Mikayel Samvelyan, Christian Schroeder, Gregory Farquhar, Jakob
Foerster, and Shimon Whiteson.

</span>
<span class="ltx_bibblock">Qmix: Monotonic value function factorisation for deep multi-agent
reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 4295–4304. PMLR, 2018.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2019)</span>
<span class="ltx_bibblock">
Jianji Ren, Haichao Wang, Tingting Hou, Shuai Zheng, and Chaosheng Tang.

</span>
<span class="ltx_bibblock">Federated learning-based computation offloading optimization in edge
computing-supported internet of things.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, 7:69194–69201, 2019.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rolnick et al. (2022)</span>
<span class="ltx_bibblock">
David Rolnick, Priya L Donti, Lynn H Kaack, Kelly Kochanski, Alexandre Lacoste,
Kris Sankaran, Andrew Slavin Ross, Nikola Milojevic-Dupont, Natasha Jaques,
Anna Waldman-Brown, et al.

</span>
<span class="ltx_bibblock">Tackling climate change with machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys (CSUR)</em>, 55(2):1–96,
2022.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. (2017)</span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1707.06347</em>, 2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seeger (2004)</span>
<span class="ltx_bibblock">
Matthias Seeger.

</span>
<span class="ltx_bibblock">Gaussian processes for machine learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International journal of neural systems</em>, 14(02):69–106, 2004.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shamsian et al. (2021)</span>
<span class="ltx_bibblock">
Aviv Shamsian, Aviv Navon, Ethan Fetaya, and Gal Chechik.

</span>
<span class="ltx_bibblock">Personalized federated learning using hypernetworks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 9489–9502. PMLR, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shojaeighadikolaei et al. (2021)</span>
<span class="ltx_bibblock">
Amin Shojaeighadikolaei, Arman Ghasemi, Kailani R Jones, Alexandru G Bardas,
Morteza Hashemi, and Reza Ahmadi.

</span>
<span class="ltx_bibblock">Demand responsive dynamic pricing framework for prosumer dominated
microgrids using multiagent reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">2020 52nd North American Power Symposium (NAPS)</em>, pp. 1–6. IEEE, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shokri &amp; Shmatikov (2015)</span>
<span class="ltx_bibblock">
Reza Shokri and Vitaly Shmatikov.

</span>
<span class="ltx_bibblock">Privacy-preserving deep learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 22nd ACM SIGSAC Conference on Computer
and Communications Security</em>, CCS ’15, pp.  1310–1321, New York, NY, USA,
2015. Association for Computing Machinery.

</span>
<span class="ltx_bibblock">ISBN 9781450338325.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1145/2810103.2813687</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1145/2810103.2813687" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/2810103.2813687</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Spangher (2021)</span>
<span class="ltx_bibblock">
Lucas Spangher.

</span>
<span class="ltx_bibblock">Transactive multi-agent reinforcement learning for distributed energy
price localization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 8th ACM International Conference on
Systems for Energy-Efficient Buildings, Cities, and Transportation</em>, pp. 244–245, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sunehag et al. (2017)</span>
<span class="ltx_bibblock">
Peter Sunehag, Guy Lever, Audrunas Gruslys, Wojciech Marian Czarnecki, Vinicius
Zambaldi, Max Jaderberg, Marc Lanctot, Nicolas Sonnerat, Joel Z Leibo, Karl
Tuyls, et al.

</span>
<span class="ltx_bibblock">Value-decomposition networks for cooperative multi-agent learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1706.05296</em>, 2017.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">T Dinh et al. (2020)</span>
<span class="ltx_bibblock">
Canh T Dinh, Nguyen Tran, and Josh Nguyen.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:21394–21405, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vázquez-Canteli et al. (2019)</span>
<span class="ltx_bibblock">
José R Vázquez-Canteli, Jérôme Kämpf, Gregor Henze, and
Zoltan Nagy.

</span>
<span class="ltx_bibblock">Citylearn v1. 0: An openai gym environment for demand response with
deep reinforcement learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 6th ACM International Conference on
Systems for Energy-Efficient Buildings, Cities, and Transportation</em>, pp. 356–357, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang &amp; Huang (2016)</span>
<span class="ltx_bibblock">
Hao Wang and Jianwei Huang.

</span>
<span class="ltx_bibblock">Incentivizing energy trading for interconnected microgrids.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Smart Grid</em>, 9(4):2647–2657, 2016.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Xiaofei Wang, Chenyang Wang, Xiuhua Li, Victor CM Leung, and Tarik Taleb.

</span>
<span class="ltx_bibblock">Federated deep reinforcement learning for internet of things with
decentralized cooperative edge caching.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">IEEE Internet of Things Journal</em>, 7(10):9441–9455, 2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wen et al. (2020)</span>
<span class="ltx_bibblock">
Lulu Wen, Kaile Zhou, Jun Li, and Shanyong Wang.

</span>
<span class="ltx_bibblock">Modified deep learning and reinforcement learning for an
incentive-based demand response model.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Energy</em>, 205:118019, 2020.

</span>
<span class="ltx_bibblock">ISSN 0360-5442.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">https://doi.org/10.1016/j.energy.2020.118019</span>.

</span>
<span class="ltx_bibblock">URL
<a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0360544220311269" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0360544220311269</a>.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Related Work</h2>

<div id="A1.p1" class="ltx_para ltx_noindent">
<p id="A1.p1.1" class="ltx_p">We position our literature within an ecosystem of work related to transactive pricing in microgrids. A price-setting RL agent was first shown to help an energy aggregator improve demand response and generate a profit <cite class="ltx_cite ltx_citemacro_citep">(Agwan et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>. Since then a number of works have explored the issue <cite class="ltx_cite ltx_citemacro_citep">(Shojaeighadikolaei et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>; Wen et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>; Han et al., <a href="#bib.bib9" title="" class="ltx_ref">2021</a>; Rolnick et al., <a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite>, with some work exploring different configurations of RL.</p>
</div>
<div id="A1.p2" class="ltx_para ltx_noindent">
<p id="A1.p2.1" class="ltx_p">We wish to provide an example of federated learning. “Distributed Selective Stochastic Gradient Descent”, i.e. DSSGD <cite class="ltx_cite ltx_citemacro_citep">(Shokri &amp; Shmatikov, <a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite>, is an interesting example which deserves further exploration from the interested reader. DSSGD has each local model exchange select parameters and gradient updates with the central server. In contrast, FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib14" title="" class="ltx_ref">2017</a>)</cite> just averages all local model gradient updates and syncs all local model parameters.</p>
</div>
<div id="A1.p3" class="ltx_para ltx_noindent">
<p id="A1.p3.1" class="ltx_p">Existing multi-agent environments are often solved through multi-agent RL algorithms like MADDPG <cite class="ltx_cite ltx_citemacro_citep">(Lowe et al., <a href="#bib.bib13" title="" class="ltx_ref">2017</a>)</cite>, VDN <cite class="ltx_cite ltx_citemacro_citep">(Sunehag et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>, and Q-Mix <cite class="ltx_cite ltx_citemacro_citep">(Rashid et al., <a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>, but these aggregate data from all the agents onto one central machine during training, and take advantage of joint action-values from all agents. Other works use federated hypernetworks for multi-task setups, but specifically not those in RL.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Hyperparameter Selection</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.1" class="ltx_p">In previous work in multi-agent RL (MARL), hypernetworks have been used to combine local agent networks into a global model (i.e. Q-Mix); however they were used to generate new mixing networks and not to generate new policies <cite class="ltx_cite ltx_citemacro_citep">(Rashid et al., <a href="#bib.bib16" title="" class="ltx_ref">2018</a>)</cite>. Other works have used federated learning before in RL <cite class="ltx_cite ltx_citemacro_citep">(Qi et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>; Wang et al., <a href="#bib.bib29" title="" class="ltx_ref">2020</a>; Ren et al., <a href="#bib.bib17" title="" class="ltx_ref">2019</a>; Anwar &amp; Raychowdhury, <a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite>, but focus on learning global models, not personalized models for heterogeneous tasks.</p>
</div>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.1" class="ltx_p">We select hyperparameters for each algorithm by conducting hyperparameter sweeps, with parameters proposed by Bayesian hyperparameter optimization <cite class="ltx_cite ltx_citemacro_citep">(Seeger, <a href="#bib.bib20" title="" class="ltx_ref">2004</a>)</cite> trying to maximize the mean reward across all agents. For the local agent baseline we run 3 sweeps, one for each level of diversity, as each level has a different distribution of microgrids. For FedAvg and PFH, we conducted 9 sweeps, varying diversity (simple, medium, complex), and the number of agents (5, 10, 20). The number of agents is relevant to FedAvg and PFH because they learn from data across multiple agents. Each local agents and FedAvg sweep had 50 runs, and each PFH sweep had 100 runs, because PFH had <math id="A2.p2.1.m1.1" class="ltx_Math" alttext="\approx" display="inline"><semantics id="A2.p2.1.m1.1a"><mo id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml">≈</mo><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><approx id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"></approx></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\approx</annotation></semantics></math> double the number of parameters to optimize.</p>
</div>
<div id="A2.p3" class="ltx_para ltx_noindent">
<p id="A2.p3.1" class="ltx_p">To minimize the effect of outliers, we use the hyperparameters from the third highest performing run from each sweep. Detailed parameter bounds for hyperparameter sweeps can be found in the appendix in Table <a href="#A4.T2" title="Table 2 ‣ Appendix D Discussion of Societal Impact ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, and simple analyses of the hyperparameters can be found in Appendix <a href="#A5.SS2" title="E.2 Regression explorations of hyperparameter sweeps ‣ Appendix E Appendix for Hyperparameter Exploration ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E.2</span></a>.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>More Future Works</h2>

<section id="A3.SS0.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">C.0.1 </span>“Cost of Privacy”</h4>

<div id="A3.SS0.SSS1.p1" class="ltx_para ltx_noindent">
<p id="A3.SS0.SSS1.p1.1" class="ltx_p">We wish to further investigate the “cost” of privacy in terms of the negative impact it may have on training time and thus on cumulative aggregator profit. In order to create a true apples-to-apples comparison, we would need a mechanism that aggregates information across microgrids in a suitable way. Some ideas on this front include multi-agent RL that shares the critic but personalizes policies, and hierarchical RL with a global aggregator.</p>
</div>
</section>
<section id="A3.SS0.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">C.0.2 </span>Vertical Integration of the Hierarchy</h4>

<div id="A3.SS0.SSS2.p1" class="ltx_para ltx_noindent">
<p id="A3.SS0.SSS2.p1.1" class="ltx_p">In the future, PFH may enable further exploitation of the hierarchical nature of price setting for energy demand response. The energy grid can be imagined as a hierarchical tree, with buildings responding to energy prices set by microgrids, which respond to energy prices set by city utilities, which respond to energy prices set by state utilities, etc. In the future, we may have IoT devices adjusting demand to energy prices set at the building level. At any level of the energy grid, the task is the same: set prices for agents beneath you to elicit a demand response. In this work we have only looked at one level of this energy hierarchy, but the methods we have used could be applied to other layers of the hierarchy as well, and even multiple levels of the hierarchy. One could imagine a hypernetwork that learns from price-setting agents at every level of the hierarchy, and can be used to rapidly initialize agents to manage any new entrants to the energy grid, all while preserving privacy at different levels of the tree.</p>
</div>
</section>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Discussion of Societal Impact</h2>

<div id="A4.p1" class="ltx_para ltx_noindent">
<p id="A4.p1.1" class="ltx_p">What are potential negative societal effects of our work? Overall, negative effects to prosumers are limited, as the focus of our work is in protecting consumer information. Furthermore, prior work demonstrated that the presence of an aggregator consistently reduced energy costs for consumers.</p>
</div>
<div id="A4.p2" class="ltx_para ltx_noindent">
<p id="A4.p2.1" class="ltx_p">However, a persistent danger of AI is that it is often deployed through centralized profit-seekers. Our work is no different in this regard. Although our specific innovation protects prosumers, it may improve the economic viability of a profit-seeking entity whose scale may eventually enable it to further its own profit at the expense of prosumers.</p>
</div>
<div id="A4.p3" class="ltx_para ltx_noindent">
<p id="A4.p3.1" class="ltx_p">Also, the act of setting prices in systems may raise fairness concerns. If initial training microgrids are biased towards wealthier residents, the PFH may initialize new policies with pricing that benefits consumption habits of wealthier clients but not poorer clients. A vivid illustration may be seen in the types of prosumers who are best poised to benefit from economic aggregation: prosumers with large solar panels and batteries are able to shield themselves from or profit off of high prices by consuming their own energy, and may fully charge their batteries when prices are low. Prosumers with smaller or no storage capabilities do not have this luxury, and thus are more vulnerable to the negative effects of price fluctuation.</p>
</div>
<figure id="A4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="A4.T2.17.1" class="ltx_text ltx_font_bold">Hyperparameter Sweep Bounds</span> All sweeps swept over the first 6 hyperparameters. AFL sweeps additionally swept over the ”AFL # of Local Steps” parameter. PFH sweeps additionally swept over the last 7 parameters. Due to the high dimensionality of the sweep, we used Bayesian hyperparameter optimization. We refer to four types of distributions: Uniform, Int Uniform, Log Uniform, and Int Log Uniform. The ”Int” type distributions simply quantize the underlying distribution (e.g. if <math id="A4.T2.5.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="A4.T2.5.m1.1b"><mi id="A4.T2.5.m1.1.1" xref="A4.T2.5.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="A4.T2.5.m1.1c"><ci id="A4.T2.5.m1.1.1.cmml" xref="A4.T2.5.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.5.m1.1d">x</annotation></semantics></math> is sampled from a uniform distribution, <math id="A4.T2.6.m2.1" class="ltx_Math" alttext="\lfloor x\rfloor" display="inline"><semantics id="A4.T2.6.m2.1b"><mrow id="A4.T2.6.m2.1.2.2" xref="A4.T2.6.m2.1.2.1.cmml"><mo stretchy="false" id="A4.T2.6.m2.1.2.2.1" xref="A4.T2.6.m2.1.2.1.1.cmml">⌊</mo><mi id="A4.T2.6.m2.1.1" xref="A4.T2.6.m2.1.1.cmml">x</mi><mo stretchy="false" id="A4.T2.6.m2.1.2.2.2" xref="A4.T2.6.m2.1.2.1.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.T2.6.m2.1c"><apply id="A4.T2.6.m2.1.2.1.cmml" xref="A4.T2.6.m2.1.2.2"><floor id="A4.T2.6.m2.1.2.1.1.cmml" xref="A4.T2.6.m2.1.2.2.1"></floor><ci id="A4.T2.6.m2.1.1.cmml" xref="A4.T2.6.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.6.m2.1d">\lfloor x\rfloor</annotation></semantics></math> is returned by an int uniform distribution). The Log Uniform distribution samples uniformly over the log of the value, so the probability of sampling <math id="A4.T2.7.m3.1" class="ltx_Math" alttext="e^{1}" display="inline"><semantics id="A4.T2.7.m3.1b"><msup id="A4.T2.7.m3.1.1" xref="A4.T2.7.m3.1.1.cmml"><mi id="A4.T2.7.m3.1.1.2" xref="A4.T2.7.m3.1.1.2.cmml">e</mi><mn id="A4.T2.7.m3.1.1.3" xref="A4.T2.7.m3.1.1.3.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="A4.T2.7.m3.1c"><apply id="A4.T2.7.m3.1.1.cmml" xref="A4.T2.7.m3.1.1"><csymbol cd="ambiguous" id="A4.T2.7.m3.1.1.1.cmml" xref="A4.T2.7.m3.1.1">superscript</csymbol><ci id="A4.T2.7.m3.1.1.2.cmml" xref="A4.T2.7.m3.1.1.2">𝑒</ci><cn type="integer" id="A4.T2.7.m3.1.1.3.cmml" xref="A4.T2.7.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.7.m3.1d">e^{1}</annotation></semantics></math> is the same as <math id="A4.T2.8.m4.1" class="ltx_Math" alttext="e^{2}" display="inline"><semantics id="A4.T2.8.m4.1b"><msup id="A4.T2.8.m4.1.1" xref="A4.T2.8.m4.1.1.cmml"><mi id="A4.T2.8.m4.1.1.2" xref="A4.T2.8.m4.1.1.2.cmml">e</mi><mn id="A4.T2.8.m4.1.1.3" xref="A4.T2.8.m4.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="A4.T2.8.m4.1c"><apply id="A4.T2.8.m4.1.1.cmml" xref="A4.T2.8.m4.1.1"><csymbol cd="ambiguous" id="A4.T2.8.m4.1.1.1.cmml" xref="A4.T2.8.m4.1.1">superscript</csymbol><ci id="A4.T2.8.m4.1.1.2.cmml" xref="A4.T2.8.m4.1.1.2">𝑒</ci><cn type="integer" id="A4.T2.8.m4.1.1.3.cmml" xref="A4.T2.8.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.8.m4.1d">e^{2}</annotation></semantics></math>, etc.</figcaption>
<table id="A4.T2.15" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A4.T2.15.8.1" class="ltx_tr">
<td id="A4.T2.15.8.1.1" class="ltx_td ltx_align_center ltx_border_tt" style="padding-bottom:2.15277pt;">Parameter</td>
<td id="A4.T2.15.8.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-bottom:2.15277pt;">Lower Bound</td>
<td id="A4.T2.15.8.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-bottom:2.15277pt;">Upper Bound</td>
<td id="A4.T2.15.8.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-bottom:2.15277pt;">Distribution</td>
</tr>
<tr id="A4.T2.9.1" class="ltx_tr">
<td id="A4.T2.9.1.2" class="ltx_td ltx_align_center ltx_border_t">Batch Size</td>
<td id="A4.T2.9.1.3" class="ltx_td ltx_align_center ltx_border_t">16</td>
<td id="A4.T2.9.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="A4.T2.9.1.1.m1.1" class="ltx_Math" alttext="\lfloor e^{8}\rfloor" display="inline"><semantics id="A4.T2.9.1.1.m1.1a"><mrow id="A4.T2.9.1.1.m1.1.1.1" xref="A4.T2.9.1.1.m1.1.1.2.cmml"><mo stretchy="false" id="A4.T2.9.1.1.m1.1.1.1.2" xref="A4.T2.9.1.1.m1.1.1.2.1.cmml">⌊</mo><msup id="A4.T2.9.1.1.m1.1.1.1.1" xref="A4.T2.9.1.1.m1.1.1.1.1.cmml"><mi id="A4.T2.9.1.1.m1.1.1.1.1.2" xref="A4.T2.9.1.1.m1.1.1.1.1.2.cmml">e</mi><mn id="A4.T2.9.1.1.m1.1.1.1.1.3" xref="A4.T2.9.1.1.m1.1.1.1.1.3.cmml">8</mn></msup><mo stretchy="false" id="A4.T2.9.1.1.m1.1.1.1.3" xref="A4.T2.9.1.1.m1.1.1.2.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.T2.9.1.1.m1.1b"><apply id="A4.T2.9.1.1.m1.1.1.2.cmml" xref="A4.T2.9.1.1.m1.1.1.1"><floor id="A4.T2.9.1.1.m1.1.1.2.1.cmml" xref="A4.T2.9.1.1.m1.1.1.1.2"></floor><apply id="A4.T2.9.1.1.m1.1.1.1.1.cmml" xref="A4.T2.9.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.T2.9.1.1.m1.1.1.1.1.1.cmml" xref="A4.T2.9.1.1.m1.1.1.1.1">superscript</csymbol><ci id="A4.T2.9.1.1.m1.1.1.1.1.2.cmml" xref="A4.T2.9.1.1.m1.1.1.1.1.2">𝑒</ci><cn type="integer" id="A4.T2.9.1.1.m1.1.1.1.1.3.cmml" xref="A4.T2.9.1.1.m1.1.1.1.1.3">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.9.1.1.m1.1c">\lfloor e^{8}\rfloor</annotation></semantics></math></td>
<td id="A4.T2.9.1.4" class="ltx_td ltx_align_center ltx_border_t">Int Uniform</td>
</tr>
<tr id="A4.T2.10.2" class="ltx_tr">
<td id="A4.T2.10.2.2" class="ltx_td ltx_align_center">Learning Rate</td>
<td id="A4.T2.10.2.1" class="ltx_td ltx_align_center"><math id="A4.T2.10.2.1.m1.1" class="ltx_Math" alttext="e^{-8}" display="inline"><semantics id="A4.T2.10.2.1.m1.1a"><msup id="A4.T2.10.2.1.m1.1.1" xref="A4.T2.10.2.1.m1.1.1.cmml"><mi id="A4.T2.10.2.1.m1.1.1.2" xref="A4.T2.10.2.1.m1.1.1.2.cmml">e</mi><mrow id="A4.T2.10.2.1.m1.1.1.3" xref="A4.T2.10.2.1.m1.1.1.3.cmml"><mo id="A4.T2.10.2.1.m1.1.1.3a" xref="A4.T2.10.2.1.m1.1.1.3.cmml">−</mo><mn id="A4.T2.10.2.1.m1.1.1.3.2" xref="A4.T2.10.2.1.m1.1.1.3.2.cmml">8</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A4.T2.10.2.1.m1.1b"><apply id="A4.T2.10.2.1.m1.1.1.cmml" xref="A4.T2.10.2.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T2.10.2.1.m1.1.1.1.cmml" xref="A4.T2.10.2.1.m1.1.1">superscript</csymbol><ci id="A4.T2.10.2.1.m1.1.1.2.cmml" xref="A4.T2.10.2.1.m1.1.1.2">𝑒</ci><apply id="A4.T2.10.2.1.m1.1.1.3.cmml" xref="A4.T2.10.2.1.m1.1.1.3"><minus id="A4.T2.10.2.1.m1.1.1.3.1.cmml" xref="A4.T2.10.2.1.m1.1.1.3"></minus><cn type="integer" id="A4.T2.10.2.1.m1.1.1.3.2.cmml" xref="A4.T2.10.2.1.m1.1.1.3.2">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.10.2.1.m1.1c">e^{-8}</annotation></semantics></math></td>
<td id="A4.T2.10.2.3" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.10.2.4" class="ltx_td ltx_align_center">Log Uniform</td>
</tr>
<tr id="A4.T2.15.9.2" class="ltx_tr">
<td id="A4.T2.15.9.2.1" class="ltx_td ltx_align_center"># of Hidden Layers</td>
<td id="A4.T2.15.9.2.2" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.15.9.2.3" class="ltx_td ltx_align_center">7</td>
<td id="A4.T2.15.9.2.4" class="ltx_td ltx_align_center">Int Uniform</td>
</tr>
<tr id="A4.T2.11.3" class="ltx_tr">
<td id="A4.T2.11.3.2" class="ltx_td ltx_align_center"># of Neurons per Hidden Layer</td>
<td id="A4.T2.11.3.3" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.11.3.1" class="ltx_td ltx_align_center"><math id="A4.T2.11.3.1.m1.1" class="ltx_Math" alttext="\lfloor e^{7}\rfloor" display="inline"><semantics id="A4.T2.11.3.1.m1.1a"><mrow id="A4.T2.11.3.1.m1.1.1.1" xref="A4.T2.11.3.1.m1.1.1.2.cmml"><mo stretchy="false" id="A4.T2.11.3.1.m1.1.1.1.2" xref="A4.T2.11.3.1.m1.1.1.2.1.cmml">⌊</mo><msup id="A4.T2.11.3.1.m1.1.1.1.1" xref="A4.T2.11.3.1.m1.1.1.1.1.cmml"><mi id="A4.T2.11.3.1.m1.1.1.1.1.2" xref="A4.T2.11.3.1.m1.1.1.1.1.2.cmml">e</mi><mn id="A4.T2.11.3.1.m1.1.1.1.1.3" xref="A4.T2.11.3.1.m1.1.1.1.1.3.cmml">7</mn></msup><mo stretchy="false" id="A4.T2.11.3.1.m1.1.1.1.3" xref="A4.T2.11.3.1.m1.1.1.2.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.T2.11.3.1.m1.1b"><apply id="A4.T2.11.3.1.m1.1.1.2.cmml" xref="A4.T2.11.3.1.m1.1.1.1"><floor id="A4.T2.11.3.1.m1.1.1.2.1.cmml" xref="A4.T2.11.3.1.m1.1.1.1.2"></floor><apply id="A4.T2.11.3.1.m1.1.1.1.1.cmml" xref="A4.T2.11.3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.T2.11.3.1.m1.1.1.1.1.1.cmml" xref="A4.T2.11.3.1.m1.1.1.1.1">superscript</csymbol><ci id="A4.T2.11.3.1.m1.1.1.1.1.2.cmml" xref="A4.T2.11.3.1.m1.1.1.1.1.2">𝑒</ci><cn type="integer" id="A4.T2.11.3.1.m1.1.1.1.1.3.cmml" xref="A4.T2.11.3.1.m1.1.1.1.1.3">7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.11.3.1.m1.1c">\lfloor e^{7}\rfloor</annotation></semantics></math></td>
<td id="A4.T2.11.3.4" class="ltx_td ltx_align_center">Int Log Uniform</td>
</tr>
<tr id="A4.T2.15.10.3" class="ltx_tr">
<td id="A4.T2.15.10.3.1" class="ltx_td ltx_align_center">PPO Clipping Param</td>
<td id="A4.T2.15.10.3.2" class="ltx_td ltx_align_center">0.01</td>
<td id="A4.T2.15.10.3.3" class="ltx_td ltx_align_center">1.0</td>
<td id="A4.T2.15.10.3.4" class="ltx_td ltx_align_center">Uniform</td>
</tr>
<tr id="A4.T2.15.11.4" class="ltx_tr">
<td id="A4.T2.15.11.4.1" class="ltx_td ltx_align_center">PPO # of SGD Iterations</td>
<td id="A4.T2.15.11.4.2" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.15.11.4.3" class="ltx_td ltx_align_center">30</td>
<td id="A4.T2.15.11.4.4" class="ltx_td ltx_align_center">Int Uniform</td>
</tr>
<tr id="A4.T2.12.4" class="ltx_tr">
<td id="A4.T2.12.4.2" class="ltx_td ltx_align_center ltx_border_t">AFL # of Local Steps</td>
<td id="A4.T2.12.4.3" class="ltx_td ltx_align_center ltx_border_t">2</td>
<td id="A4.T2.12.4.1" class="ltx_td ltx_align_center ltx_border_t"><math id="A4.T2.12.4.1.m1.1" class="ltx_Math" alttext="\lfloor e^{6}\rfloor" display="inline"><semantics id="A4.T2.12.4.1.m1.1a"><mrow id="A4.T2.12.4.1.m1.1.1.1" xref="A4.T2.12.4.1.m1.1.1.2.cmml"><mo stretchy="false" id="A4.T2.12.4.1.m1.1.1.1.2" xref="A4.T2.12.4.1.m1.1.1.2.1.cmml">⌊</mo><msup id="A4.T2.12.4.1.m1.1.1.1.1" xref="A4.T2.12.4.1.m1.1.1.1.1.cmml"><mi id="A4.T2.12.4.1.m1.1.1.1.1.2" xref="A4.T2.12.4.1.m1.1.1.1.1.2.cmml">e</mi><mn id="A4.T2.12.4.1.m1.1.1.1.1.3" xref="A4.T2.12.4.1.m1.1.1.1.1.3.cmml">6</mn></msup><mo stretchy="false" id="A4.T2.12.4.1.m1.1.1.1.3" xref="A4.T2.12.4.1.m1.1.1.2.1.cmml">⌋</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.T2.12.4.1.m1.1b"><apply id="A4.T2.12.4.1.m1.1.1.2.cmml" xref="A4.T2.12.4.1.m1.1.1.1"><floor id="A4.T2.12.4.1.m1.1.1.2.1.cmml" xref="A4.T2.12.4.1.m1.1.1.1.2"></floor><apply id="A4.T2.12.4.1.m1.1.1.1.1.cmml" xref="A4.T2.12.4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A4.T2.12.4.1.m1.1.1.1.1.1.cmml" xref="A4.T2.12.4.1.m1.1.1.1.1">superscript</csymbol><ci id="A4.T2.12.4.1.m1.1.1.1.1.2.cmml" xref="A4.T2.12.4.1.m1.1.1.1.1.2">𝑒</ci><cn type="integer" id="A4.T2.12.4.1.m1.1.1.1.1.3.cmml" xref="A4.T2.12.4.1.m1.1.1.1.1.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.12.4.1.m1.1c">\lfloor e^{6}\rfloor</annotation></semantics></math></td>
<td id="A4.T2.12.4.4" class="ltx_td ltx_align_center ltx_border_t">Int Log Uniform</td>
</tr>
<tr id="A4.T2.13.5" class="ltx_tr">
<td id="A4.T2.13.5.2" class="ltx_td ltx_align_center ltx_border_t">PFH Dropout</td>
<td id="A4.T2.13.5.1" class="ltx_td ltx_align_center ltx_border_t"><math id="A4.T2.13.5.1.m1.1" class="ltx_Math" alttext="e^{-}10" display="inline"><semantics id="A4.T2.13.5.1.m1.1a"><mrow id="A4.T2.13.5.1.m1.1.1" xref="A4.T2.13.5.1.m1.1.1.cmml"><msup id="A4.T2.13.5.1.m1.1.1.2" xref="A4.T2.13.5.1.m1.1.1.2.cmml"><mi id="A4.T2.13.5.1.m1.1.1.2.2" xref="A4.T2.13.5.1.m1.1.1.2.2.cmml">e</mi><mo id="A4.T2.13.5.1.m1.1.1.2.3" xref="A4.T2.13.5.1.m1.1.1.2.3.cmml">−</mo></msup><mo lspace="0em" rspace="0em" id="A4.T2.13.5.1.m1.1.1.1" xref="A4.T2.13.5.1.m1.1.1.1.cmml">​</mo><mn id="A4.T2.13.5.1.m1.1.1.3" xref="A4.T2.13.5.1.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.T2.13.5.1.m1.1b"><apply id="A4.T2.13.5.1.m1.1.1.cmml" xref="A4.T2.13.5.1.m1.1.1"><times id="A4.T2.13.5.1.m1.1.1.1.cmml" xref="A4.T2.13.5.1.m1.1.1.1"></times><apply id="A4.T2.13.5.1.m1.1.1.2.cmml" xref="A4.T2.13.5.1.m1.1.1.2"><csymbol cd="ambiguous" id="A4.T2.13.5.1.m1.1.1.2.1.cmml" xref="A4.T2.13.5.1.m1.1.1.2">superscript</csymbol><ci id="A4.T2.13.5.1.m1.1.1.2.2.cmml" xref="A4.T2.13.5.1.m1.1.1.2.2">𝑒</ci><minus id="A4.T2.13.5.1.m1.1.1.2.3.cmml" xref="A4.T2.13.5.1.m1.1.1.2.3"></minus></apply><cn type="integer" id="A4.T2.13.5.1.m1.1.1.3.cmml" xref="A4.T2.13.5.1.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.13.5.1.m1.1c">e^{-}10</annotation></semantics></math></td>
<td id="A4.T2.13.5.3" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="A4.T2.13.5.4" class="ltx_td ltx_align_center ltx_border_t">Log Uniform</td>
</tr>
<tr id="A4.T2.15.12.5" class="ltx_tr">
<td id="A4.T2.15.12.5.1" class="ltx_td ltx_align_center">PFH Embedding Dim</td>
<td id="A4.T2.15.12.5.2" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.15.12.5.3" class="ltx_td ltx_align_center">512</td>
<td id="A4.T2.15.12.5.4" class="ltx_td ltx_align_center">Int Uniform</td>
</tr>
<tr id="A4.T2.14.6" class="ltx_tr">
<td id="A4.T2.14.6.2" class="ltx_td ltx_align_center">PFH L2 Regularization</td>
<td id="A4.T2.14.6.1" class="ltx_td ltx_align_center"><math id="A4.T2.14.6.1.m1.1" class="ltx_Math" alttext="e^{-10}" display="inline"><semantics id="A4.T2.14.6.1.m1.1a"><msup id="A4.T2.14.6.1.m1.1.1" xref="A4.T2.14.6.1.m1.1.1.cmml"><mi id="A4.T2.14.6.1.m1.1.1.2" xref="A4.T2.14.6.1.m1.1.1.2.cmml">e</mi><mrow id="A4.T2.14.6.1.m1.1.1.3" xref="A4.T2.14.6.1.m1.1.1.3.cmml"><mo id="A4.T2.14.6.1.m1.1.1.3a" xref="A4.T2.14.6.1.m1.1.1.3.cmml">−</mo><mn id="A4.T2.14.6.1.m1.1.1.3.2" xref="A4.T2.14.6.1.m1.1.1.3.2.cmml">10</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A4.T2.14.6.1.m1.1b"><apply id="A4.T2.14.6.1.m1.1.1.cmml" xref="A4.T2.14.6.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T2.14.6.1.m1.1.1.1.cmml" xref="A4.T2.14.6.1.m1.1.1">superscript</csymbol><ci id="A4.T2.14.6.1.m1.1.1.2.cmml" xref="A4.T2.14.6.1.m1.1.1.2">𝑒</ci><apply id="A4.T2.14.6.1.m1.1.1.3.cmml" xref="A4.T2.14.6.1.m1.1.1.3"><minus id="A4.T2.14.6.1.m1.1.1.3.1.cmml" xref="A4.T2.14.6.1.m1.1.1.3"></minus><cn type="integer" id="A4.T2.14.6.1.m1.1.1.3.2.cmml" xref="A4.T2.14.6.1.m1.1.1.3.2">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.14.6.1.m1.1c">e^{-10}</annotation></semantics></math></td>
<td id="A4.T2.14.6.3" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.14.6.4" class="ltx_td ltx_align_center">Log Uniform</td>
</tr>
<tr id="A4.T2.15.7" class="ltx_tr">
<td id="A4.T2.15.7.2" class="ltx_td ltx_align_center">PFH Learning Rate</td>
<td id="A4.T2.15.7.1" class="ltx_td ltx_align_center"><math id="A4.T2.15.7.1.m1.1" class="ltx_Math" alttext="e^{-4}" display="inline"><semantics id="A4.T2.15.7.1.m1.1a"><msup id="A4.T2.15.7.1.m1.1.1" xref="A4.T2.15.7.1.m1.1.1.cmml"><mi id="A4.T2.15.7.1.m1.1.1.2" xref="A4.T2.15.7.1.m1.1.1.2.cmml">e</mi><mrow id="A4.T2.15.7.1.m1.1.1.3" xref="A4.T2.15.7.1.m1.1.1.3.cmml"><mo id="A4.T2.15.7.1.m1.1.1.3a" xref="A4.T2.15.7.1.m1.1.1.3.cmml">−</mo><mn id="A4.T2.15.7.1.m1.1.1.3.2" xref="A4.T2.15.7.1.m1.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="A4.T2.15.7.1.m1.1b"><apply id="A4.T2.15.7.1.m1.1.1.cmml" xref="A4.T2.15.7.1.m1.1.1"><csymbol cd="ambiguous" id="A4.T2.15.7.1.m1.1.1.1.cmml" xref="A4.T2.15.7.1.m1.1.1">superscript</csymbol><ci id="A4.T2.15.7.1.m1.1.1.2.cmml" xref="A4.T2.15.7.1.m1.1.1.2">𝑒</ci><apply id="A4.T2.15.7.1.m1.1.1.3.cmml" xref="A4.T2.15.7.1.m1.1.1.3"><minus id="A4.T2.15.7.1.m1.1.1.3.1.cmml" xref="A4.T2.15.7.1.m1.1.1.3"></minus><cn type="integer" id="A4.T2.15.7.1.m1.1.1.3.2.cmml" xref="A4.T2.15.7.1.m1.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.T2.15.7.1.m1.1c">e^{-4}</annotation></semantics></math></td>
<td id="A4.T2.15.7.3" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.15.7.4" class="ltx_td ltx_align_center">Log Uniform</td>
</tr>
<tr id="A4.T2.15.13.6" class="ltx_tr">
<td id="A4.T2.15.13.6.1" class="ltx_td ltx_align_center">PFH # of Hidden Layers</td>
<td id="A4.T2.15.13.6.2" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.15.13.6.3" class="ltx_td ltx_align_center">6</td>
<td id="A4.T2.15.13.6.4" class="ltx_td ltx_align_center">Int Uniform</td>
</tr>
<tr id="A4.T2.15.14.7" class="ltx_tr">
<td id="A4.T2.15.14.7.1" class="ltx_td ltx_align_center">PFH # of Neurons per Hidden Layer</td>
<td id="A4.T2.15.14.7.2" class="ltx_td ltx_align_center">1</td>
<td id="A4.T2.15.14.7.3" class="ltx_td ltx_align_center">1024</td>
<td id="A4.T2.15.14.7.4" class="ltx_td ltx_align_center">Int Uniform</td>
</tr>
<tr id="A4.T2.15.15.8" class="ltx_tr">
<td id="A4.T2.15.15.8.1" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:4.30554pt;">PFH # of Local Steps</td>
<td id="A4.T2.15.15.8.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:4.30554pt;">1</td>
<td id="A4.T2.15.15.8.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:4.30554pt;">100</td>
<td id="A4.T2.15.15.8.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-bottom:4.30554pt;">Int Uniform</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Appendix for Hyperparameter Exploration</h2>

<section id="A5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.1 </span>Hyperparameter Sweep Specifications</h3>

<div id="A5.SS1.p1" class="ltx_para ltx_noindent">
<p id="A5.SS1.p1.1" class="ltx_p">See Table <a href="#A4.T2" title="Table 2 ‣ Appendix D Discussion of Societal Impact ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> for the bounds of the hyperparameter sweeps that we performed.</p>
</div>
</section>
<section id="A5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">E.2 </span>Regression explorations of hyperparameter sweeps</h3>

<div id="A5.SS2.p1" class="ltx_para ltx_noindent">
<p id="A5.SS2.p1.1" class="ltx_p">We present, for the reader’s interest, a regression fit on the hyperparameters that were swept over. In this regression, each observation is a single run of the sweep, the dependent variable in both is the reward mean of the learning trajectory, and the independent variables are those listed in the rows. We believe that this regression contains some interesting information; specifically on the direction of coefficients (i.e. whether they are negative or positive) and on which parameters were significant in producing a positive reward. We note that the basic assumption of linear regression, that observations are sampled IID from a distribution, is not the case here; observations are loosely dependent on each other as the parameter configurations in each batch are determined by the performance of parameters in the previous batch. Thus, we relegate these results as a curiosity for supplementary material only. We are more confident in the <span id="A5.SS2.p1.1.1" class="ltx_text ltx_font_italic">negative</span> results of this regression, i.e. which variables are insignificant after controlling for the others, than the positive results, as this indicates parameters that the sweep chose not to focus on. We believe that further work in regressions of hyperparameter values may be an interesting research endeavor for understanding ML models as well as for ML applications like AutoML.</p>
</div>
<section id="A5.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">E.2.1 </span>Full regression model (Table <a href="#A5.T3" title="Table 3 ‣ E.2.1 Full regression model (Table 3) ‣ E.2 Regression explorations of hyperparameter sweeps ‣ Appendix E Appendix for Hyperparameter Exploration ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>)</h4>

<div id="A5.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p id="A5.SS2.SSS1.p1.1" class="ltx_p">Of specific interest in the full regression are which hyperparameters did and did not effect the average reward. Many variables in the hypernetwork itself do not seem to matter: the hypernetwork’s learning rate, number of layers, and L2 regularization did not matter. However, whether or not the hypernetwork selected for dropout <span id="A5.SS2.SSS1.p1.1.1" class="ltx_text ltx_font_italic">did</span> matter, and it hurt the performance, implying that hypernetwork fitting was more important than robustness. Some parameters of the PPO agents, such as the clip parameter or number of gradient updates, did not matter much either.</p>
</div>
<figure id="A5.T3" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Full regression model</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="A5.T3.3" class="ltx_tabular ltx_figure_panel ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A5.T3.3.1.1" class="ltx_tr">
<td id="A5.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="A5.T3.3.1.1.1.1" class="ltx_text ltx_font_bold">Dep. Variable:</span></td>
<td id="A5.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Avg Reward</td>
<td id="A5.T3.3.1.1.3" class="ltx_td ltx_align_left ltx_border_tt"><span id="A5.T3.3.1.1.3.1" class="ltx_text ltx_font_bold">R-squared:</span></td>
<td id="A5.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">0.362</td>
</tr>
<tr id="A5.T3.3.2.2" class="ltx_tr">
<td id="A5.T3.3.2.2.1" class="ltx_td ltx_align_left"><span id="A5.T3.3.2.2.1.1" class="ltx_text ltx_font_bold">Model:</span></td>
<td id="A5.T3.3.2.2.2" class="ltx_td ltx_align_center">OLS</td>
<td id="A5.T3.3.2.2.3" class="ltx_td ltx_align_left"><span id="A5.T3.3.2.2.3.1" class="ltx_text ltx_font_bold">Adj. R-squared:</span></td>
<td id="A5.T3.3.2.2.4" class="ltx_td ltx_align_center">0.348</td>
</tr>
<tr id="A5.T3.3.3.3" class="ltx_tr">
<td id="A5.T3.3.3.3.1" class="ltx_td ltx_align_left"><span id="A5.T3.3.3.3.1.1" class="ltx_text ltx_font_bold">Method:</span></td>
<td id="A5.T3.3.3.3.2" class="ltx_td ltx_align_center">Least Squares</td>
<td id="A5.T3.3.3.3.3" class="ltx_td ltx_align_left"><span id="A5.T3.3.3.3.3.1" class="ltx_text ltx_font_bold">F-statistic:</span></td>
<td id="A5.T3.3.3.3.4" class="ltx_td ltx_align_center">24.62</td>
</tr>
<tr id="A5.T3.3.4.4" class="ltx_tr">
<td id="A5.T3.3.4.4.1" class="ltx_td ltx_align_left"><span id="A5.T3.3.4.4.1.1" class="ltx_text ltx_font_bold">Date:</span></td>
<td id="A5.T3.3.4.4.2" class="ltx_td ltx_align_center">Thu, 19 May 2022</td>
<td id="A5.T3.3.4.4.3" class="ltx_td ltx_align_left"><span id="A5.T3.3.4.4.3.1" class="ltx_text ltx_font_bold">Prob (F-statistic):</span></td>
<td id="A5.T3.3.4.4.4" class="ltx_td ltx_align_center">1.08e-43</td>
</tr>
<tr id="A5.T3.3.5.5" class="ltx_tr">
<td id="A5.T3.3.5.5.1" class="ltx_td ltx_align_left"><span id="A5.T3.3.5.5.1.1" class="ltx_text ltx_font_bold">Time:</span></td>
<td id="A5.T3.3.5.5.2" class="ltx_td ltx_align_center">08:16:34</td>
<td id="A5.T3.3.5.5.3" class="ltx_td ltx_align_left"><span id="A5.T3.3.5.5.3.1" class="ltx_text ltx_font_bold">Log-Likelihood:</span></td>
<td id="A5.T3.3.5.5.4" class="ltx_td ltx_align_center">-3188.0</td>
</tr>
<tr id="A5.T3.3.6.6" class="ltx_tr">
<td id="A5.T3.3.6.6.1" class="ltx_td ltx_align_left"><span id="A5.T3.3.6.6.1.1" class="ltx_text ltx_font_bold">No. Observations:</span></td>
<td id="A5.T3.3.6.6.2" class="ltx_td ltx_align_center">533</td>
<td id="A5.T3.3.6.6.3" class="ltx_td ltx_align_left"><span id="A5.T3.3.6.6.3.1" class="ltx_text ltx_font_bold">AIC:</span></td>
<td id="A5.T3.3.6.6.4" class="ltx_td ltx_align_center">6402.</td>
</tr>
<tr id="A5.T3.3.7.7" class="ltx_tr">
<td id="A5.T3.3.7.7.1" class="ltx_td ltx_align_left"><span id="A5.T3.3.7.7.1.1" class="ltx_text ltx_font_bold">Df Residuals:</span></td>
<td id="A5.T3.3.7.7.2" class="ltx_td ltx_align_center">520</td>
<td id="A5.T3.3.7.7.3" class="ltx_td ltx_align_left"><span id="A5.T3.3.7.7.3.1" class="ltx_text ltx_font_bold">BIC:</span></td>
<td id="A5.T3.3.7.7.4" class="ltx_td ltx_align_center">6458.</td>
</tr>
<tr id="A5.T3.3.8.8" class="ltx_tr">
<td id="A5.T3.3.8.8.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="A5.T3.3.8.8.1.1" class="ltx_text ltx_font_bold">Df Model:</span></td>
<td id="A5.T3.3.8.8.2" class="ltx_td ltx_align_center ltx_border_bb">12</td>
<td id="A5.T3.3.8.8.3" class="ltx_td ltx_border_bb"></td>
<td id="A5.T3.3.8.8.4" class="ltx_td ltx_border_bb"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="A5.T3.2" class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A5.T3.2.2" class="ltx_tr">
<th id="A5.T3.2.2.3" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A5.T3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T3.2.2.4.1" class="ltx_text ltx_font_bold">coef</span></th>
<th id="A5.T3.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T3.2.2.5.1" class="ltx_text ltx_font_bold">std err</span></th>
<th id="A5.T3.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T3.2.2.6.1" class="ltx_text ltx_font_bold">t</span></th>
<th id="A5.T3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T3.2.2.2.2" class="ltx_text ltx_font_bold">P<math id="A5.T3.1.1.1.1.m1.1" class="ltx_math_unparsed" alttext="&gt;|" display="inline"><semantics id="A5.T3.1.1.1.1.m1.1a"><mrow id="A5.T3.1.1.1.1.m1.1b"><mo rspace="0em" id="A5.T3.1.1.1.1.m1.1.1">&gt;</mo><mo fence="false" stretchy="false" id="A5.T3.1.1.1.1.m1.1.2">|</mo></mrow><annotation encoding="application/x-tex" id="A5.T3.1.1.1.1.m1.1c">&gt;|</annotation></semantics></math>t<math id="A5.T3.2.2.2.2.m2.1" class="ltx_Math" alttext="|" display="inline"><semantics id="A5.T3.2.2.2.2.m2.1a"><mo fence="false" stretchy="false" id="A5.T3.2.2.2.2.m2.1.1" xref="A5.T3.2.2.2.2.m2.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="A5.T3.2.2.2.2.m2.1b"><ci id="A5.T3.2.2.2.2.m2.1.1.cmml" xref="A5.T3.2.2.2.2.m2.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T3.2.2.2.2.m2.1c">|</annotation></semantics></math></span></th>
<th id="A5.T3.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T3.2.2.7.1" class="ltx_text ltx_font_bold">[0.025</span></th>
<th id="A5.T3.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T3.2.2.8.1" class="ltx_text ltx_font_bold">0.975]</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A5.T3.2.3.1" class="ltx_tr">
<th id="A5.T3.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="A5.T3.2.3.1.1.1" class="ltx_text ltx_font_bold">Intercept</span></th>
<td id="A5.T3.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t">344.6188</td>
<td id="A5.T3.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t">29.679</td>
<td id="A5.T3.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t">11.612</td>
<td id="A5.T3.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t">0.000</td>
<td id="A5.T3.2.3.1.6" class="ltx_td ltx_align_center ltx_border_t">286.314</td>
<td id="A5.T3.2.3.1.7" class="ltx_td ltx_align_center ltx_border_t">402.924</td>
</tr>
<tr id="A5.T3.2.4.2" class="ltx_tr">
<th id="A5.T3.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.4.2.1.1" class="ltx_text ltx_font_bold">sizes</span></th>
<td id="A5.T3.2.4.2.2" class="ltx_td ltx_align_center">-1.9453</td>
<td id="A5.T3.2.4.2.3" class="ltx_td ltx_align_center">0.777</td>
<td id="A5.T3.2.4.2.4" class="ltx_td ltx_align_center">-2.504</td>
<td id="A5.T3.2.4.2.5" class="ltx_td ltx_align_center"><span id="A5.T3.2.4.2.5.1" class="ltx_text ltx_font_bold">0.013</span></td>
<td id="A5.T3.2.4.2.6" class="ltx_td ltx_align_center">-3.472</td>
<td id="A5.T3.2.4.2.7" class="ltx_td ltx_align_center">-0.419</td>
</tr>
<tr id="A5.T3.2.5.3" class="ltx_tr">
<th id="A5.T3.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.5.3.1.1" class="ltx_text ltx_font_bold">n_layers</span></th>
<td id="A5.T3.2.5.3.2" class="ltx_td ltx_align_center">5.2696</td>
<td id="A5.T3.2.5.3.3" class="ltx_td ltx_align_center">2.806</td>
<td id="A5.T3.2.5.3.4" class="ltx_td ltx_align_center">1.878</td>
<td id="A5.T3.2.5.3.5" class="ltx_td ltx_align_center"><span id="A5.T3.2.5.3.5.1" class="ltx_text ltx_font_bold">0.061</span></td>
<td id="A5.T3.2.5.3.6" class="ltx_td ltx_align_center">-0.243</td>
<td id="A5.T3.2.5.3.7" class="ltx_td ltx_align_center">10.782</td>
</tr>
<tr id="A5.T3.2.6.4" class="ltx_tr">
<th id="A5.T3.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.6.4.1.1" class="ltx_text ltx_font_bold">learning_rate</span></th>
<td id="A5.T3.2.6.4.2" class="ltx_td ltx_align_center">-1835.5718</td>
<td id="A5.T3.2.6.4.3" class="ltx_td ltx_align_center">128.380</td>
<td id="A5.T3.2.6.4.4" class="ltx_td ltx_align_center">-14.298</td>
<td id="A5.T3.2.6.4.5" class="ltx_td ltx_align_center"><span id="A5.T3.2.6.4.5.1" class="ltx_text ltx_font_bold">0.000</span></td>
<td id="A5.T3.2.6.4.6" class="ltx_td ltx_align_center">-2087.779</td>
<td id="A5.T3.2.6.4.7" class="ltx_td ltx_align_center">-1583.364</td>
</tr>
<tr id="A5.T3.2.7.5" class="ltx_tr">
<th id="A5.T3.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.7.5.1.1" class="ltx_text ltx_font_bold">ppo_clip_param</span></th>
<td id="A5.T3.2.7.5.2" class="ltx_td ltx_align_center">49.4402</td>
<td id="A5.T3.2.7.5.3" class="ltx_td ltx_align_center">38.009</td>
<td id="A5.T3.2.7.5.4" class="ltx_td ltx_align_center">1.301</td>
<td id="A5.T3.2.7.5.5" class="ltx_td ltx_align_center">0.194</td>
<td id="A5.T3.2.7.5.6" class="ltx_td ltx_align_center">-25.230</td>
<td id="A5.T3.2.7.5.7" class="ltx_td ltx_align_center">124.110</td>
</tr>
<tr id="A5.T3.2.8.6" class="ltx_tr">
<th id="A5.T3.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.8.6.1.1" class="ltx_text ltx_font_bold">hnet_lr</span></th>
<td id="A5.T3.2.8.6.2" class="ltx_td ltx_align_center">77.4179</td>
<td id="A5.T3.2.8.6.3" class="ltx_td ltx_align_center">63.747</td>
<td id="A5.T3.2.8.6.4" class="ltx_td ltx_align_center">1.214</td>
<td id="A5.T3.2.8.6.5" class="ltx_td ltx_align_center">0.225</td>
<td id="A5.T3.2.8.6.6" class="ltx_td ltx_align_center">-47.815</td>
<td id="A5.T3.2.8.6.7" class="ltx_td ltx_align_center">202.651</td>
</tr>
<tr id="A5.T3.2.9.7" class="ltx_tr">
<th id="A5.T3.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.9.7.1.1" class="ltx_text ltx_font_bold">hnet_num_local_steps</span></th>
<td id="A5.T3.2.9.7.2" class="ltx_td ltx_align_center">1.0579</td>
<td id="A5.T3.2.9.7.3" class="ltx_td ltx_align_center">0.150</td>
<td id="A5.T3.2.9.7.4" class="ltx_td ltx_align_center">7.043</td>
<td id="A5.T3.2.9.7.5" class="ltx_td ltx_align_center"><span id="A5.T3.2.9.7.5.1" class="ltx_text ltx_font_bold">0.000</span></td>
<td id="A5.T3.2.9.7.6" class="ltx_td ltx_align_center">0.763</td>
<td id="A5.T3.2.9.7.7" class="ltx_td ltx_align_center">1.353</td>
</tr>
<tr id="A5.T3.2.10.8" class="ltx_tr">
<th id="A5.T3.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.10.8.1.1" class="ltx_text ltx_font_bold">ppo_num_sgd_iter</span></th>
<td id="A5.T3.2.10.8.2" class="ltx_td ltx_align_center">-0.3889</td>
<td id="A5.T3.2.10.8.3" class="ltx_td ltx_align_center">0.741</td>
<td id="A5.T3.2.10.8.4" class="ltx_td ltx_align_center">-0.525</td>
<td id="A5.T3.2.10.8.5" class="ltx_td ltx_align_center">0.600</td>
<td id="A5.T3.2.10.8.6" class="ltx_td ltx_align_center">-1.845</td>
<td id="A5.T3.2.10.8.7" class="ltx_td ltx_align_center">1.068</td>
</tr>
<tr id="A5.T3.2.11.9" class="ltx_tr">
<th id="A5.T3.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.11.9.1.1" class="ltx_text ltx_font_bold">hnet_num_layers</span></th>
<td id="A5.T3.2.11.9.2" class="ltx_td ltx_align_center">-2.3439</td>
<td id="A5.T3.2.11.9.3" class="ltx_td ltx_align_center">2.571</td>
<td id="A5.T3.2.11.9.4" class="ltx_td ltx_align_center">-0.912</td>
<td id="A5.T3.2.11.9.5" class="ltx_td ltx_align_center">0.362</td>
<td id="A5.T3.2.11.9.6" class="ltx_td ltx_align_center">-7.395</td>
<td id="A5.T3.2.11.9.7" class="ltx_td ltx_align_center">2.708</td>
</tr>
<tr id="A5.T3.2.12.10" class="ltx_tr">
<th id="A5.T3.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.12.10.1.1" class="ltx_text ltx_font_bold">batch_size</span></th>
<td id="A5.T3.2.12.10.2" class="ltx_td ltx_align_center">-0.6685</td>
<td id="A5.T3.2.12.10.3" class="ltx_td ltx_align_center">0.171</td>
<td id="A5.T3.2.12.10.4" class="ltx_td ltx_align_center">-3.910</td>
<td id="A5.T3.2.12.10.5" class="ltx_td ltx_align_center"><span id="A5.T3.2.12.10.5.1" class="ltx_text ltx_font_bold">0.000</span></td>
<td id="A5.T3.2.12.10.6" class="ltx_td ltx_align_center">-1.004</td>
<td id="A5.T3.2.12.10.7" class="ltx_td ltx_align_center">-0.333</td>
</tr>
<tr id="A5.T3.2.13.11" class="ltx_tr">
<th id="A5.T3.2.13.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.13.11.1.1" class="ltx_text ltx_font_bold">hnet_embedding_dim</span></th>
<td id="A5.T3.2.13.11.2" class="ltx_td ltx_align_center">0.0077</td>
<td id="A5.T3.2.13.11.3" class="ltx_td ltx_align_center">0.028</td>
<td id="A5.T3.2.13.11.4" class="ltx_td ltx_align_center">0.271</td>
<td id="A5.T3.2.13.11.5" class="ltx_td ltx_align_center">0.786</td>
<td id="A5.T3.2.13.11.6" class="ltx_td ltx_align_center">-0.048</td>
<td id="A5.T3.2.13.11.7" class="ltx_td ltx_align_center">0.063</td>
</tr>
<tr id="A5.T3.2.14.12" class="ltx_tr">
<th id="A5.T3.2.14.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T3.2.14.12.1.1" class="ltx_text ltx_font_bold">hnet_l2_reg</span></th>
<td id="A5.T3.2.14.12.2" class="ltx_td ltx_align_center">-10.4826</td>
<td id="A5.T3.2.14.12.3" class="ltx_td ltx_align_center">19.912</td>
<td id="A5.T3.2.14.12.4" class="ltx_td ltx_align_center">-0.526</td>
<td id="A5.T3.2.14.12.5" class="ltx_td ltx_align_center">0.599</td>
<td id="A5.T3.2.14.12.6" class="ltx_td ltx_align_center">-49.601</td>
<td id="A5.T3.2.14.12.7" class="ltx_td ltx_align_center">28.636</td>
</tr>
<tr id="A5.T3.2.15.13" class="ltx_tr">
<th id="A5.T3.2.15.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="A5.T3.2.15.13.1.1" class="ltx_text ltx_font_bold">hnet_dropout</span></th>
<td id="A5.T3.2.15.13.2" class="ltx_td ltx_align_center ltx_border_bb">-68.5849</td>
<td id="A5.T3.2.15.13.3" class="ltx_td ltx_align_center ltx_border_bb">21.070</td>
<td id="A5.T3.2.15.13.4" class="ltx_td ltx_align_center ltx_border_bb">-3.255</td>
<td id="A5.T3.2.15.13.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="A5.T3.2.15.13.5.1" class="ltx_text ltx_font_bold">0.001</span></td>
<td id="A5.T3.2.15.13.6" class="ltx_td ltx_align_center ltx_border_bb">-109.978</td>
<td id="A5.T3.2.15.13.7" class="ltx_td ltx_align_center ltx_border_bb">-27.192</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
<figure id="A5.SS2.SSS1.tab1" class="ltx_table">
<table id="A5.SS2.SSS1.tab1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A5.SS2.SSS1.tab1.1.1.1" class="ltx_tr">
<td id="A5.SS2.SSS1.tab1.1.1.1.1" class="ltx_td ltx_align_left"><span id="A5.SS2.SSS1.tab1.1.1.1.1.1" class="ltx_text ltx_font_bold">Omnibus:</span></td>
<td id="A5.SS2.SSS1.tab1.1.1.1.2" class="ltx_td ltx_align_center">16.401</td>
<td id="A5.SS2.SSS1.tab1.1.1.1.3" class="ltx_td ltx_align_left"><span id="A5.SS2.SSS1.tab1.1.1.1.3.1" class="ltx_text ltx_font_bold">Durbin-Watson:</span></td>
<td id="A5.SS2.SSS1.tab1.1.1.1.4" class="ltx_td ltx_align_center">1.670</td>
</tr>
<tr id="A5.SS2.SSS1.tab1.1.2.2" class="ltx_tr">
<td id="A5.SS2.SSS1.tab1.1.2.2.1" class="ltx_td ltx_align_left"><span id="A5.SS2.SSS1.tab1.1.2.2.1.1" class="ltx_text ltx_font_bold">Prob(Omnibus):</span></td>
<td id="A5.SS2.SSS1.tab1.1.2.2.2" class="ltx_td ltx_align_center">0.000</td>
<td id="A5.SS2.SSS1.tab1.1.2.2.3" class="ltx_td ltx_align_left"><span id="A5.SS2.SSS1.tab1.1.2.2.3.1" class="ltx_text ltx_font_bold">Jarque-Bera (JB):</span></td>
<td id="A5.SS2.SSS1.tab1.1.2.2.4" class="ltx_td ltx_align_center">19.555</td>
</tr>
<tr id="A5.SS2.SSS1.tab1.1.3.3" class="ltx_tr">
<td id="A5.SS2.SSS1.tab1.1.3.3.1" class="ltx_td ltx_align_left"><span id="A5.SS2.SSS1.tab1.1.3.3.1.1" class="ltx_text ltx_font_bold">Skew:</span></td>
<td id="A5.SS2.SSS1.tab1.1.3.3.2" class="ltx_td ltx_align_center">0.336</td>
<td id="A5.SS2.SSS1.tab1.1.3.3.3" class="ltx_td ltx_align_left"><span id="A5.SS2.SSS1.tab1.1.3.3.3.1" class="ltx_text ltx_font_bold">Prob(JB):</span></td>
<td id="A5.SS2.SSS1.tab1.1.3.3.4" class="ltx_td ltx_align_center">5.67e-05</td>
</tr>
<tr id="A5.SS2.SSS1.tab1.1.4.4" class="ltx_tr">
<td id="A5.SS2.SSS1.tab1.1.4.4.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="A5.SS2.SSS1.tab1.1.4.4.1.1" class="ltx_text ltx_font_bold">Kurtosis:</span></td>
<td id="A5.SS2.SSS1.tab1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_bb">3.655</td>
<td id="A5.SS2.SSS1.tab1.1.4.4.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="A5.SS2.SSS1.tab1.1.4.4.3.1" class="ltx_text ltx_font_bold">Cond. No.</span></td>
<td id="A5.SS2.SSS1.tab1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_bb">9.08e+03</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="A5.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">E.2.2 </span>Reduced regression model with only significant coefficients included (Table <a href="#A5.T4" title="Table 4 ‣ E.2.2 Reduced regression model with only significant coefficients included (Table 4) ‣ E.2 Regression explorations of hyperparameter sweeps ‣ Appendix E Appendix for Hyperparameter Exploration ‣ Personalized Federated Hypernetworks for Privacy Preservation in Multi-Task Reinforcement Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>)</h4>

<div id="A5.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p id="A5.SS2.SSS2.p1.1" class="ltx_p">We believe that this test is more interesting for examining the direction of significant variables after controlling for the other variables. Here, it is interesting to note greater sizes of policy networks, (“sizes”), has a negative effect, while number of layers of policy networks have a positive effect, offering a mixed view on whether policy complexity is important. The learning rate is negatively important, implying that more stability in network is preferred. The number of local model update steps allowed is positively correlated to mean reward, implying that the more the local models are allowed to fit, the better. The combination of a negative effect of batch size and positive effect of learning rate implies that the local RL agents found it easier to take few steps (lower batch sizes) but update policies at a more conservative rate (lower learning rates), which makes sense in the RL context.</p>
</div>
<figure id="A5.T4" class="ltx_table">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Reduced regression model</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="A5.T4.3" class="ltx_tabular ltx_figure_panel ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A5.T4.3.1.1" class="ltx_tr">
<td id="A5.T4.3.1.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="A5.T4.3.1.1.1.1" class="ltx_text ltx_font_bold">Dep. Variable:</span></td>
<td id="A5.T4.3.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">Avg Reward</td>
<td id="A5.T4.3.1.1.3" class="ltx_td ltx_align_left ltx_border_tt"><span id="A5.T4.3.1.1.3.1" class="ltx_text ltx_font_bold">R-squared:</span></td>
<td id="A5.T4.3.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">0.357</td>
</tr>
<tr id="A5.T4.3.2.2" class="ltx_tr">
<td id="A5.T4.3.2.2.1" class="ltx_td ltx_align_left"><span id="A5.T4.3.2.2.1.1" class="ltx_text ltx_font_bold">Model:</span></td>
<td id="A5.T4.3.2.2.2" class="ltx_td ltx_align_center">OLS</td>
<td id="A5.T4.3.2.2.3" class="ltx_td ltx_align_left"><span id="A5.T4.3.2.2.3.1" class="ltx_text ltx_font_bold">Adj. R-squared:</span></td>
<td id="A5.T4.3.2.2.4" class="ltx_td ltx_align_center">0.349</td>
</tr>
<tr id="A5.T4.3.3.3" class="ltx_tr">
<td id="A5.T4.3.3.3.1" class="ltx_td ltx_align_left"><span id="A5.T4.3.3.3.1.1" class="ltx_text ltx_font_bold">Method:</span></td>
<td id="A5.T4.3.3.3.2" class="ltx_td ltx_align_center">Least Squares</td>
<td id="A5.T4.3.3.3.3" class="ltx_td ltx_align_left"><span id="A5.T4.3.3.3.3.1" class="ltx_text ltx_font_bold">F-statistic:</span></td>
<td id="A5.T4.3.3.3.4" class="ltx_td ltx_align_center">48.63</td>
</tr>
<tr id="A5.T4.3.4.4" class="ltx_tr">
<td id="A5.T4.3.4.4.1" class="ltx_td ltx_align_left"><span id="A5.T4.3.4.4.1.1" class="ltx_text ltx_font_bold">Prob (F-statistic):</span></td>
<td id="A5.T4.3.4.4.2" class="ltx_td ltx_align_center">1.79e-47</td>
<td id="A5.T4.3.4.4.3" class="ltx_td ltx_align_left"><span id="A5.T4.3.4.4.3.1" class="ltx_text ltx_font_bold">Log-Likelihood:</span></td>
<td id="A5.T4.3.4.4.4" class="ltx_td ltx_align_center">-3190.3</td>
</tr>
<tr id="A5.T4.3.5.5" class="ltx_tr">
<td id="A5.T4.3.5.5.1" class="ltx_td ltx_align_left"><span id="A5.T4.3.5.5.1.1" class="ltx_text ltx_font_bold">No. Observations:</span></td>
<td id="A5.T4.3.5.5.2" class="ltx_td ltx_align_center">533</td>
<td id="A5.T4.3.5.5.3" class="ltx_td ltx_align_left"><span id="A5.T4.3.5.5.3.1" class="ltx_text ltx_font_bold">AIC:</span></td>
<td id="A5.T4.3.5.5.4" class="ltx_td ltx_align_center">6395.</td>
</tr>
<tr id="A5.T4.3.6.6" class="ltx_tr">
<td id="A5.T4.3.6.6.1" class="ltx_td ltx_align_left"><span id="A5.T4.3.6.6.1.1" class="ltx_text ltx_font_bold">Df Residuals:</span></td>
<td id="A5.T4.3.6.6.2" class="ltx_td ltx_align_center">526</td>
<td id="A5.T4.3.6.6.3" class="ltx_td ltx_align_left"><span id="A5.T4.3.6.6.3.1" class="ltx_text ltx_font_bold">BIC:</span></td>
<td id="A5.T4.3.6.6.4" class="ltx_td ltx_align_center">6425.</td>
</tr>
<tr id="A5.T4.3.7.7" class="ltx_tr">
<td id="A5.T4.3.7.7.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="A5.T4.3.7.7.1.1" class="ltx_text ltx_font_bold">Df Model:</span></td>
<td id="A5.T4.3.7.7.2" class="ltx_td ltx_align_center ltx_border_bb">6</td>
<td id="A5.T4.3.7.7.3" class="ltx_td ltx_border_bb"></td>
<td id="A5.T4.3.7.7.4" class="ltx_td ltx_border_bb"></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="A5.T4.2" class="ltx_tabular ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A5.T4.2.2" class="ltx_tr">
<th id="A5.T4.2.2.3" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A5.T4.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T4.2.2.4.1" class="ltx_text ltx_font_bold">coef</span></th>
<th id="A5.T4.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T4.2.2.5.1" class="ltx_text ltx_font_bold">std err</span></th>
<th id="A5.T4.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T4.2.2.6.1" class="ltx_text ltx_font_bold">t</span></th>
<th id="A5.T4.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T4.2.2.2.2" class="ltx_text ltx_font_bold">P<math id="A5.T4.1.1.1.1.m1.1" class="ltx_math_unparsed" alttext="&gt;|" display="inline"><semantics id="A5.T4.1.1.1.1.m1.1a"><mrow id="A5.T4.1.1.1.1.m1.1b"><mo rspace="0em" id="A5.T4.1.1.1.1.m1.1.1">&gt;</mo><mo fence="false" stretchy="false" id="A5.T4.1.1.1.1.m1.1.2">|</mo></mrow><annotation encoding="application/x-tex" id="A5.T4.1.1.1.1.m1.1c">&gt;|</annotation></semantics></math>t<math id="A5.T4.2.2.2.2.m2.1" class="ltx_Math" alttext="|" display="inline"><semantics id="A5.T4.2.2.2.2.m2.1a"><mo fence="false" stretchy="false" id="A5.T4.2.2.2.2.m2.1.1" xref="A5.T4.2.2.2.2.m2.1.1.cmml">|</mo><annotation-xml encoding="MathML-Content" id="A5.T4.2.2.2.2.m2.1b"><ci id="A5.T4.2.2.2.2.m2.1.1.cmml" xref="A5.T4.2.2.2.2.m2.1.1">|</ci></annotation-xml><annotation encoding="application/x-tex" id="A5.T4.2.2.2.2.m2.1c">|</annotation></semantics></math></span></th>
<th id="A5.T4.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T4.2.2.7.1" class="ltx_text ltx_font_bold">[0.025</span></th>
<th id="A5.T4.2.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A5.T4.2.2.8.1" class="ltx_text ltx_font_bold">0.975]</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A5.T4.2.3.1" class="ltx_tr">
<th id="A5.T4.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="A5.T4.2.3.1.1.1" class="ltx_text ltx_font_bold">Intercept</span></th>
<td id="A5.T4.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t">364.7212</td>
<td id="A5.T4.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t">15.515</td>
<td id="A5.T4.2.3.1.4" class="ltx_td ltx_align_center ltx_border_t">23.507</td>
<td id="A5.T4.2.3.1.5" class="ltx_td ltx_align_center ltx_border_t">0.000</td>
<td id="A5.T4.2.3.1.6" class="ltx_td ltx_align_center ltx_border_t">334.242</td>
<td id="A5.T4.2.3.1.7" class="ltx_td ltx_align_center ltx_border_t">395.201</td>
</tr>
<tr id="A5.T4.2.4.2" class="ltx_tr">
<th id="A5.T4.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T4.2.4.2.1.1" class="ltx_text ltx_font_bold">sizes</span></th>
<td id="A5.T4.2.4.2.2" class="ltx_td ltx_align_center">-2.1970</td>
<td id="A5.T4.2.4.2.3" class="ltx_td ltx_align_center">0.627</td>
<td id="A5.T4.2.4.2.4" class="ltx_td ltx_align_center">-3.502</td>
<td id="A5.T4.2.4.2.5" class="ltx_td ltx_align_center">0.001</td>
<td id="A5.T4.2.4.2.6" class="ltx_td ltx_align_center">-3.429</td>
<td id="A5.T4.2.4.2.7" class="ltx_td ltx_align_center">-0.965</td>
</tr>
<tr id="A5.T4.2.5.3" class="ltx_tr">
<th id="A5.T4.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T4.2.5.3.1.1" class="ltx_text ltx_font_bold">n_layers</span></th>
<td id="A5.T4.2.5.3.2" class="ltx_td ltx_align_center">5.1216</td>
<td id="A5.T4.2.5.3.3" class="ltx_td ltx_align_center">2.759</td>
<td id="A5.T4.2.5.3.4" class="ltx_td ltx_align_center">1.856</td>
<td id="A5.T4.2.5.3.5" class="ltx_td ltx_align_center">0.064</td>
<td id="A5.T4.2.5.3.6" class="ltx_td ltx_align_center">-0.299</td>
<td id="A5.T4.2.5.3.7" class="ltx_td ltx_align_center">10.542</td>
</tr>
<tr id="A5.T4.2.6.4" class="ltx_tr">
<th id="A5.T4.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T4.2.6.4.1.1" class="ltx_text ltx_font_bold">learning_rate</span></th>
<td id="A5.T4.2.6.4.2" class="ltx_td ltx_align_center">-1829.2013</td>
<td id="A5.T4.2.6.4.3" class="ltx_td ltx_align_center">127.609</td>
<td id="A5.T4.2.6.4.4" class="ltx_td ltx_align_center">-14.334</td>
<td id="A5.T4.2.6.4.5" class="ltx_td ltx_align_center">0.000</td>
<td id="A5.T4.2.6.4.6" class="ltx_td ltx_align_center">-2079.887</td>
<td id="A5.T4.2.6.4.7" class="ltx_td ltx_align_center">-1578.516</td>
</tr>
<tr id="A5.T4.2.7.5" class="ltx_tr">
<th id="A5.T4.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T4.2.7.5.1.1" class="ltx_text ltx_font_bold">hnet_num_local_steps</span></th>
<td id="A5.T4.2.7.5.2" class="ltx_td ltx_align_center">1.0482</td>
<td id="A5.T4.2.7.5.3" class="ltx_td ltx_align_center">0.149</td>
<td id="A5.T4.2.7.5.4" class="ltx_td ltx_align_center">7.055</td>
<td id="A5.T4.2.7.5.5" class="ltx_td ltx_align_center">0.000</td>
<td id="A5.T4.2.7.5.6" class="ltx_td ltx_align_center">0.756</td>
<td id="A5.T4.2.7.5.7" class="ltx_td ltx_align_center">1.340</td>
</tr>
<tr id="A5.T4.2.8.6" class="ltx_tr">
<th id="A5.T4.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="A5.T4.2.8.6.1.1" class="ltx_text ltx_font_bold">batch_size</span></th>
<td id="A5.T4.2.8.6.2" class="ltx_td ltx_align_center">-0.6409</td>
<td id="A5.T4.2.8.6.3" class="ltx_td ltx_align_center">0.167</td>
<td id="A5.T4.2.8.6.4" class="ltx_td ltx_align_center">-3.841</td>
<td id="A5.T4.2.8.6.5" class="ltx_td ltx_align_center">0.000</td>
<td id="A5.T4.2.8.6.6" class="ltx_td ltx_align_center">-0.969</td>
<td id="A5.T4.2.8.6.7" class="ltx_td ltx_align_center">-0.313</td>
</tr>
<tr id="A5.T4.2.9.7" class="ltx_tr">
<th id="A5.T4.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="A5.T4.2.9.7.1.1" class="ltx_text ltx_font_bold">hnet_dropout</span></th>
<td id="A5.T4.2.9.7.2" class="ltx_td ltx_align_center ltx_border_bb">-65.1701</td>
<td id="A5.T4.2.9.7.3" class="ltx_td ltx_align_center ltx_border_bb">20.923</td>
<td id="A5.T4.2.9.7.4" class="ltx_td ltx_align_center ltx_border_bb">-3.115</td>
<td id="A5.T4.2.9.7.5" class="ltx_td ltx_align_center ltx_border_bb">0.002</td>
<td id="A5.T4.2.9.7.6" class="ltx_td ltx_align_center ltx_border_bb">-106.273</td>
<td id="A5.T4.2.9.7.7" class="ltx_td ltx_align_center ltx_border_bb">-24.067</td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<table id="A5.T4.4" class="ltx_tabular ltx_figure_panel ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A5.T4.4.1.1" class="ltx_tr">
<td id="A5.T4.4.1.1.1" class="ltx_td ltx_align_left"><span id="A5.T4.4.1.1.1.1" class="ltx_text ltx_font_bold">Omnibus:</span></td>
<td id="A5.T4.4.1.1.2" class="ltx_td ltx_align_center">17.230</td>
<td id="A5.T4.4.1.1.3" class="ltx_td ltx_align_left"><span id="A5.T4.4.1.1.3.1" class="ltx_text ltx_font_bold">Durbin-Watson:</span></td>
<td id="A5.T4.4.1.1.4" class="ltx_td ltx_align_center">1.669</td>
</tr>
<tr id="A5.T4.4.2.2" class="ltx_tr">
<td id="A5.T4.4.2.2.1" class="ltx_td ltx_align_left"><span id="A5.T4.4.2.2.1.1" class="ltx_text ltx_font_bold">Prob(Omnibus):</span></td>
<td id="A5.T4.4.2.2.2" class="ltx_td ltx_align_center">0.000</td>
<td id="A5.T4.4.2.2.3" class="ltx_td ltx_align_left"><span id="A5.T4.4.2.2.3.1" class="ltx_text ltx_font_bold">Jarque-Bera (JB):</span></td>
<td id="A5.T4.4.2.2.4" class="ltx_td ltx_align_center">19.988</td>
</tr>
<tr id="A5.T4.4.3.3" class="ltx_tr">
<td id="A5.T4.4.3.3.1" class="ltx_td ltx_align_left"><span id="A5.T4.4.3.3.1.1" class="ltx_text ltx_font_bold">Skew:</span></td>
<td id="A5.T4.4.3.3.2" class="ltx_td ltx_align_center">0.360</td>
<td id="A5.T4.4.3.3.3" class="ltx_td ltx_align_left"><span id="A5.T4.4.3.3.3.1" class="ltx_text ltx_font_bold">Prob(JB):</span></td>
<td id="A5.T4.4.3.3.4" class="ltx_td ltx_align_center">4.57e-05</td>
</tr>
<tr id="A5.T4.4.4.4" class="ltx_tr">
<td id="A5.T4.4.4.4.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="A5.T4.4.4.4.1.1" class="ltx_text ltx_font_bold">Kurtosis:</span></td>
<td id="A5.T4.4.4.4.2" class="ltx_td ltx_align_center ltx_border_bb">3.618</td>
<td id="A5.T4.4.4.4.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="A5.T4.4.4.4.3.1" class="ltx_text ltx_font_bold">Cond. No.</span></td>
<td id="A5.T4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_bb">2.57e+03</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</section>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2210.06819" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2210.06820" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2210.06820">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2210.06820" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2210.06821" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 03:20:16 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
