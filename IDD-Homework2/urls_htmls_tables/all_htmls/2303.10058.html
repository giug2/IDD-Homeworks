<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.10058] No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier</title><meta property="og:description" content="Data heterogeneity is an inherent challenge that hinders the performance of federated learning (FL). Recent studies have identified the biased classifiers of local models as the key bottleneck. Previous attempts have u…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.10058">

<!--Generated on Thu Feb 29 19:37:58 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zexi Li<sup id="id10.10.id1" class="ltx_sup">1</sup>  Xinyi Shang<sup id="id11.11.id2" class="ltx_sup"><span id="id11.11.id2.1" class="ltx_text ltx_font_italic">2†</span></sup>  Rui He<sup id="id12.12.id3" class="ltx_sup">1</sup>  Tao Lin<sup id="id13.13.id4" class="ltx_sup"><span id="id13.13.id4.1" class="ltx_text ltx_font_italic">3</span></sup>  Chao Wu<sup id="id14.14.id5" class="ltx_sup"><span id="id14.14.id5.1" class="ltx_text ltx_font_italic">1∗</span></sup>
<br class="ltx_break"><sup id="id15.15.id6" class="ltx_sup">1</sup>Zhejiang University  <sup id="id16.16.id7" class="ltx_sup">2</sup>Xiamen University  <sup id="id17.17.id8" class="ltx_sup">3</sup>Westlake University
<br class="ltx_break"><span id="id18.18.id9" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{zexi.li,ruihe,chao.wu}@zju.edu.cn</span> <span id="id19.19.id10" class="ltx_text ltx_font_typewriter" style="font-size:90%;">shangxinyi@stu.xmu.edu.cn</span> <span id="id20.20.id11" class="ltx_text ltx_font_typewriter" style="font-size:90%;">lintao@westlake.edu.cn</span>
</span><span class="ltx_author_notes">Corresponding authors. <sup id="id21.21.id1" class="ltx_sup"><span id="id21.21.id1.1" class="ltx_text ltx_font_italic">†</span></sup>Work was done during Xinyi’s visit to Westlake University.
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id22.id1" class="ltx_p">Data heterogeneity is an inherent challenge that hinders the performance of federated learning (FL). Recent studies have identified the biased classifiers of local models as the key bottleneck. Previous attempts have used classifier calibration after FL training, but this approach falls short in improving the poor feature representations caused by training-time classifier biases. Resolving the classifier bias dilemma in FL requires a full understanding of the mechanisms behind the classifier. Recent advances in neural collapse have shown that the classifiers and feature prototypes under perfect training scenarios collapse into an optimal structure called simplex equiangular tight frame (ETF). Building on this neural collapse insight, we propose a solution to the FL’s classifier bias problem by utilizing a synthetic and fixed ETF classifier during training. The optimal classifier structure enables all clients to learn unified and optimal feature representations even under extremely heterogeneous data. We devise several effective modules to better adapt the ETF structure in FL, achieving both high generalization and personalization. Extensive experiments demonstrate that our method achieves state-of-the-art performances on CIFAR-10, CIFAR-100, and Tiny-ImageNet. The code is available at <a target="_blank" href="https://github.com/ZexiLee/ICCV-2023-FedETF" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="color:#FF00FF;">https://github.com/ZexiLee/ICCV-2023-FedETF</a><span id="id22.id1.1" class="ltx_text" style="color:#000000;">.</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> is a distributed training paradigm that enables collaborative training from massive multi-source datasets without transferring the raw data, reserving data ownership <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> while relieving communication burdens <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. FL facilitates broad applications in medical images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, the internet of things <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, mobile services <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, and so on; it shows promising prospects in data collaboration.
However, clients in FL training may hold heterogeneous data, in other words, clients’ datasets are in Non-IID distributions<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We use “data heterogeneity” and “Non-IID data” interchangeably.</span></span></span>, which causes a huge degradation to the global model’s generalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Numerous recent studies have shown that <span id="S1.p2.1.1" class="ltx_text ltx_font_bold ltx_font_italic">classifier biases</span> in clients’ local models caused by Non-IID data are the primary cause of degradation in FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. It has been discovered that the classifier layer is more biased than other layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, and classifier biases will create a <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">vicious cycle</span> between biased classifiers and misaligned features across clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the issue of classifier bias in FL, where Non-IID data leads to poor pairwise cosine similarities among clients’ classifiers and feature prototypes. Furthermore, class-wise classifier vectors of clients are scattered in the embedding space, leading to significant generalization declines.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2303.10058/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="215" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span> <span id="S1.F1.5.1" class="ltx_text ltx_font_bold">How data heterogeneity causes classifier biases in FL.</span> Smaller <math id="S1.F1.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S1.F1.2.m1.1b"><mi id="S1.F1.2.m1.1.1" xref="S1.F1.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S1.F1.2.m1.1c"><ci id="S1.F1.2.m1.1.1.cmml" xref="S1.F1.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.m1.1d">\alpha</annotation></semantics></math> corresponds to higher Non-IID. Experiments are conducted on CIFAR-10 with vanilla <span id="S1.F1.6.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>. Columns from left to right: (1) Non-IID data results in poor generalization, biased classifiers, and misaligned features. (2) Clients’ data distributions. (3) Clients with Non-IID data have smaller pair-wise classifier cosine similarities. (4) t-SNE visualization of clients’ class-wise classifier vectors (represented by colors), which are more scattered in Non-IID data. </figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Previous research has attempted to mitigate classifier biases through classifier retraining via generated virtual features at the end of FL training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. However, these methods fail to address classifier biases during training. Biased classifiers during the training phase lead to inadequate feature extractors and poor representations of generated features, negatively affecting the retrained classifiers. Our experiments have also shown the limitations of classifier retraining methods (Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Therefore, we wonder:</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p"><em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">Can we break the classifier bias dilemma during training, improving both the classifiers and feature representations?</em></p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To resolve the classifier bias dilemma, it is essential to fully understand the mechanisms behind the classifier. We further wonder: <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">what are the properties of a well-trained (i.e. good) classifier?</span> An emerging discovery called neural collapse <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> has shed light on this matter. It describes the phenomenon that, in the perfect training scenario, where the dataset is balanced and sufficient, the feature prototypes and classifier vectors converge to an optimal simplex equiangular tight frame (ETF) with maximal pairwise angles <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. Insights from balanced training inspire us to tackle the challenges in Non-IID FL.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Thus, in this paper, <span id="S1.p6.1.1" class="ltx_text ltx_font_italic">we <span id="S1.p6.1.1.1" class="ltx_text ltx_font_bold">fundamentally solve the FL’s classifier bias problem</span> with a neural-collapse-inspired approach. </span>
Knowing the optimal classifier structure, we make the first attempt to introduce a synthetic simplex ETF as a fixed classifier for all clients so that the clients can learn unified and optimal feature representations even under high heterogeneity. We devise <span id="S1.p6.1.2" class="ltx_text ltx_font_smallcaps">FedETF</span> which incorporates several effective modules that better adapt the ETF structure in FL training, reaching strong results on <span id="S1.p6.1.3" class="ltx_text ltx_font_bold ltx_font_italic">both</span> <span id="S1.p6.1.4" class="ltx_text ltx_font_bold ltx_font_italic">generalization</span> <span id="S1.p6.1.5" class="ltx_text ltx_font_bold ltx_font_italic">and</span> <span id="S1.p6.1.6" class="ltx_text ltx_font_bold ltx_font_italic">personalization</span>.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Specifically, we employ a projection layer that maps the features to a space where neural collapse is more likely to occur. We also implement a balanced feature loss with a learnable temperature to minimize entropy between the features and the fixed ETF classifier. These techniques enable us to achieve high generalization performance of the global model during FL training.
To further improve personalization, we introduce a novel fine-tuning strategy that adapts the global model locally after FL training.
Extensive experiments have strongly supported the effectiveness of our method. Our contributions are summarized as follows.</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">To the best of our knowledge, this is the first paper that tackles the data heterogeneity problem in FL from the perspective of neural collapse.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We devise <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span>, which takes the simplex ETF as a fixed classifier, and it fundamentally solves the classifier biases brought by Non-IID data, reaching high generalization of the global model.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We propose a local fine-tuning strategy in <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span> to boost personalization in each client after FL training.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Our method is validated on three vision datasets: CIFAR-10, CIFAR-100, and Tiny-ImageNet. Our proposed method outperforms strong baselines and achieves sota in both generalization and personalization.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Data Heterogeneity in Federated Learning.</span>
A variety of solutions have been proposed to tackle data heterogeneity in FL. Recent works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> have revealed that the biased classifier is the main cause leading to poor performance of the global model, and they use classifier retraining <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite> or classifier variance reduction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> to calibrate the classifier. In particular, <span id="S2.p1.1.2" class="ltx_text ltx_font_smallcaps">CCVR</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> finds that there exists a greater bias in the classifier than in other layers, and only calibrating the classifier via virtual features after FL training can improve the global model performance. However, this approach cannot resolve the misaligned representations of local models caused by biased classifiers during FL training. Consequently, the backbone feature extractor cannot be improved. Moreover, some concurrent works use classifier variance reduction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> or feature anchors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> to relieve classifier biases. However, when data is highly Non-IID, variance-reduced classifiers and aggregated feature anchors are also biased and far from optimal (i.e., trained on IID data). Although these methods can alleviate classifier biases to some extent, they cannot completely solve them.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">To improve the misaligned features, another line of works use prototypical methods to aid client training. <span id="S2.p2.1.1" class="ltx_text ltx_font_smallcaps">FedProto</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> only transmits and aggregates prototypes on the server to deal with data heterogeneity and model heterogeneity, and <span id="S2.p2.1.2" class="ltx_text ltx_font_smallcaps">FedFM</span> anchors clients’ features to improve generalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>. A concurrent work named <span id="S2.p2.1.3" class="ltx_text ltx_font_smallcaps">FedNH</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> adopts a prototypical classifier and uses a smoothing aggregation strategy to update the classifier based on clients’ local prototypes.
However, the aggregated prototypes will also be biased in extreme Non-IID settings, and these methods did not use the classifier’s ETF optimality to tackle this problem, which is where our contribution lies.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Besides, data heterogeneity can be relieved by improving aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. Apart from generalization, there are data heterogeneity challenges for personalization, methods such as decoupling classifiers and feature extractors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, separating feature information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>, adaptive local aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>, and edge-cloud collaboration <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> can be used to facilitate better local personalized models.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Neural Collapse.</span>
The neural collapse was firstly observed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> that at the terminal phase of training on a balanced dataset, the feature prototypes and the classifier vectors will converge to a simplex ETF where the vectors are normalized and the pair-wise angles are maximized. Afterward, there are some works trying to figure out the mechanism behind neural collapse <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> and in which conditions neural collapse will happen <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Recent works use neural-collapse-inspired methods to solve the problems in imbalanced training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, incremental learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, and transfer learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.
Despite the neural-collapse-inspired methods’ success in centralized learning, deep insights and effective solutions regarding neural collapse are missing in distributed training. In this paper, we find neural collapse is also the key to success in FL and we show that inducing ETF optimality can inherently solve the classifier bias and feature misalignment problem in FL and largely improve performance.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Federated Learning</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.23" class="ltx_p"><span id="S3.SS1.p1.23.1" class="ltx_text ltx_font_bold">Basic Settings.</span> We introduce a typical FL setting with <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">K</annotation></semantics></math> clients holding potentially Non-IID data partitions <math id="S3.SS1.p1.2.m2.4" class="ltx_Math" alttext="\mathcal{D}_{1},\mathcal{D}_{2},...,\mathcal{D}_{K}" display="inline"><semantics id="S3.SS1.p1.2.m2.4a"><mrow id="S3.SS1.p1.2.m2.4.4.3" xref="S3.SS1.p1.2.m2.4.4.4.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.2.2.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.4.4.3.4" xref="S3.SS1.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml">𝒟</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.4.4.3.5" xref="S3.SS1.p1.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.4.4.3.6" xref="S3.SS1.p1.2.m2.4.4.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.4.4.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m2.4.4.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.4b"><list id="S3.SS1.p1.2.m2.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.3"><apply id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.2">𝒟</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">𝒟</ci><cn type="integer" id="S3.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.2">𝒟</ci><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3">𝐾</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.4c">\mathcal{D}_{1},\mathcal{D}_{2},...,\mathcal{D}_{K}</annotation></semantics></math>, respectively. A supervised classification task with <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">C</annotation></semantics></math> classes is considered. Let <math id="S3.SS1.p1.4.m4.2" class="ltx_Math" alttext="n_{k,c}" display="inline"><semantics id="S3.SS1.p1.4.m4.2a"><msub id="S3.SS1.p1.4.m4.2.3" xref="S3.SS1.p1.4.m4.2.3.cmml"><mi id="S3.SS1.p1.4.m4.2.3.2" xref="S3.SS1.p1.4.m4.2.3.2.cmml">n</mi><mrow id="S3.SS1.p1.4.m4.2.2.2.4" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml">k</mi><mo id="S3.SS1.p1.4.m4.2.2.2.4.1" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.4.m4.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.2b"><apply id="S3.SS1.p1.4.m4.2.3.cmml" xref="S3.SS1.p1.4.m4.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.2.3.1.cmml" xref="S3.SS1.p1.4.m4.2.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.2.3.2.cmml" xref="S3.SS1.p1.4.m4.2.3.2">𝑛</ci><list id="S3.SS1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.4"><ci id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">𝑘</ci><ci id="S3.SS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.2c">n_{k,c}</annotation></semantics></math> be the number of samples of class <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">c</annotation></semantics></math> on client <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">k</annotation></semantics></math>, and <math id="S3.SS1.p1.7.m7.3" class="ltx_Math" alttext="n_{k}=\sum_{c=1}^{C}n_{k,c}=|\mathcal{D}_{k}|" display="inline"><semantics id="S3.SS1.p1.7.m7.3a"><mrow id="S3.SS1.p1.7.m7.3.3" xref="S3.SS1.p1.7.m7.3.3.cmml"><msub id="S3.SS1.p1.7.m7.3.3.3" xref="S3.SS1.p1.7.m7.3.3.3.cmml"><mi id="S3.SS1.p1.7.m7.3.3.3.2" xref="S3.SS1.p1.7.m7.3.3.3.2.cmml">n</mi><mi id="S3.SS1.p1.7.m7.3.3.3.3" xref="S3.SS1.p1.7.m7.3.3.3.3.cmml">k</mi></msub><mo rspace="0.111em" id="S3.SS1.p1.7.m7.3.3.4" xref="S3.SS1.p1.7.m7.3.3.4.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.3.3.5" xref="S3.SS1.p1.7.m7.3.3.5.cmml"><msubsup id="S3.SS1.p1.7.m7.3.3.5.1" xref="S3.SS1.p1.7.m7.3.3.5.1.cmml"><mo id="S3.SS1.p1.7.m7.3.3.5.1.2.2" xref="S3.SS1.p1.7.m7.3.3.5.1.2.2.cmml">∑</mo><mrow id="S3.SS1.p1.7.m7.3.3.5.1.2.3" xref="S3.SS1.p1.7.m7.3.3.5.1.2.3.cmml"><mi id="S3.SS1.p1.7.m7.3.3.5.1.2.3.2" xref="S3.SS1.p1.7.m7.3.3.5.1.2.3.2.cmml">c</mi><mo id="S3.SS1.p1.7.m7.3.3.5.1.2.3.1" xref="S3.SS1.p1.7.m7.3.3.5.1.2.3.1.cmml">=</mo><mn id="S3.SS1.p1.7.m7.3.3.5.1.2.3.3" xref="S3.SS1.p1.7.m7.3.3.5.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.7.m7.3.3.5.1.3" xref="S3.SS1.p1.7.m7.3.3.5.1.3.cmml">C</mi></msubsup><msub id="S3.SS1.p1.7.m7.3.3.5.2" xref="S3.SS1.p1.7.m7.3.3.5.2.cmml"><mi id="S3.SS1.p1.7.m7.3.3.5.2.2" xref="S3.SS1.p1.7.m7.3.3.5.2.2.cmml">n</mi><mrow id="S3.SS1.p1.7.m7.2.2.2.4" xref="S3.SS1.p1.7.m7.2.2.2.3.cmml"><mi id="S3.SS1.p1.7.m7.1.1.1.1" xref="S3.SS1.p1.7.m7.1.1.1.1.cmml">k</mi><mo id="S3.SS1.p1.7.m7.2.2.2.4.1" xref="S3.SS1.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.7.m7.2.2.2.2" xref="S3.SS1.p1.7.m7.2.2.2.2.cmml">c</mi></mrow></msub></mrow><mo id="S3.SS1.p1.7.m7.3.3.6" xref="S3.SS1.p1.7.m7.3.3.6.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.3.3.1.1" xref="S3.SS1.p1.7.m7.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.3.3.1.1.2" xref="S3.SS1.p1.7.m7.3.3.1.2.1.cmml">|</mo><msub id="S3.SS1.p1.7.m7.3.3.1.1.1" xref="S3.SS1.p1.7.m7.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.3.3.1.1.1.2" xref="S3.SS1.p1.7.m7.3.3.1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.7.m7.3.3.1.1.1.3" xref="S3.SS1.p1.7.m7.3.3.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS1.p1.7.m7.3.3.1.1.3" xref="S3.SS1.p1.7.m7.3.3.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.3b"><apply id="S3.SS1.p1.7.m7.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3"><and id="S3.SS1.p1.7.m7.3.3a.cmml" xref="S3.SS1.p1.7.m7.3.3"></and><apply id="S3.SS1.p1.7.m7.3.3b.cmml" xref="S3.SS1.p1.7.m7.3.3"><eq id="S3.SS1.p1.7.m7.3.3.4.cmml" xref="S3.SS1.p1.7.m7.3.3.4"></eq><apply id="S3.SS1.p1.7.m7.3.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.3.1.cmml" xref="S3.SS1.p1.7.m7.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.3.2.cmml" xref="S3.SS1.p1.7.m7.3.3.3.2">𝑛</ci><ci id="S3.SS1.p1.7.m7.3.3.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3.3.3">𝑘</ci></apply><apply id="S3.SS1.p1.7.m7.3.3.5.cmml" xref="S3.SS1.p1.7.m7.3.3.5"><apply id="S3.SS1.p1.7.m7.3.3.5.1.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.5.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1">superscript</csymbol><apply id="S3.SS1.p1.7.m7.3.3.5.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.5.1.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1">subscript</csymbol><sum id="S3.SS1.p1.7.m7.3.3.5.1.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1.2.2"></sum><apply id="S3.SS1.p1.7.m7.3.3.5.1.2.3.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1.2.3"><eq id="S3.SS1.p1.7.m7.3.3.5.1.2.3.1.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1.2.3.1"></eq><ci id="S3.SS1.p1.7.m7.3.3.5.1.2.3.2.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1.2.3.2">𝑐</ci><cn type="integer" id="S3.SS1.p1.7.m7.3.3.5.1.2.3.3.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.7.m7.3.3.5.1.3.cmml" xref="S3.SS1.p1.7.m7.3.3.5.1.3">𝐶</ci></apply><apply id="S3.SS1.p1.7.m7.3.3.5.2.cmml" xref="S3.SS1.p1.7.m7.3.3.5.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.5.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.5.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.5.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.5.2.2">𝑛</ci><list id="S3.SS1.p1.7.m7.2.2.2.3.cmml" xref="S3.SS1.p1.7.m7.2.2.2.4"><ci id="S3.SS1.p1.7.m7.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1.1">𝑘</ci><ci id="S3.SS1.p1.7.m7.2.2.2.2.cmml" xref="S3.SS1.p1.7.m7.2.2.2.2">𝑐</ci></list></apply></apply></apply><apply id="S3.SS1.p1.7.m7.3.3c.cmml" xref="S3.SS1.p1.7.m7.3.3"><eq id="S3.SS1.p1.7.m7.3.3.6.cmml" xref="S3.SS1.p1.7.m7.3.3.6"></eq><share href="#S3.SS1.p1.7.m7.3.3.5.cmml" id="S3.SS1.p1.7.m7.3.3d.cmml" xref="S3.SS1.p1.7.m7.3.3"></share><apply id="S3.SS1.p1.7.m7.3.3.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1"><abs id="S3.SS1.p1.7.m7.3.3.1.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.2"></abs><apply id="S3.SS1.p1.7.m7.3.3.1.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.2">𝒟</ci><ci id="S3.SS1.p1.7.m7.3.3.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.3.3.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.3c">n_{k}=\sum_{c=1}^{C}n_{k,c}=|\mathcal{D}_{k}|</annotation></semantics></math> denotes the number of training samples held by client <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">k</annotation></semantics></math>. FL aims to realize generalization or personalization by distributed training under the coordination of a central server without any data transmission.
For <span id="S3.SS1.p1.23.2" class="ltx_text ltx_font_italic">generalization</span> in FL, the goal is to learn a global model over the whole training data <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{D}\triangleq\bigcup_{k}\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mrow id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.SS1.p1.9.m9.1.1.1" xref="S3.SS1.p1.9.m9.1.1.1.cmml">≜</mo><mrow id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml"><msub id="S3.SS1.p1.9.m9.1.1.3.1" xref="S3.SS1.p1.9.m9.1.1.3.1.cmml"><mo id="S3.SS1.p1.9.m9.1.1.3.1.2" xref="S3.SS1.p1.9.m9.1.1.3.1.2.cmml">⋃</mo><mi id="S3.SS1.p1.9.m9.1.1.3.1.3" xref="S3.SS1.p1.9.m9.1.1.3.1.3.cmml">k</mi></msub><msub id="S3.SS1.p1.9.m9.1.1.3.2" xref="S3.SS1.p1.9.m9.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m9.1.1.3.2.2" xref="S3.SS1.p1.9.m9.1.1.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.9.m9.1.1.3.2.3" xref="S3.SS1.p1.9.m9.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><ci id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.1">≜</ci><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝒟</ci><apply id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3"><apply id="S3.SS1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1">subscript</csymbol><union id="S3.SS1.p1.9.m9.1.1.3.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.2"></union><ci id="S3.SS1.p1.9.m9.1.1.3.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.1.3">𝑘</ci></apply><apply id="S3.SS1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.3.2.1.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.3.2.2.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2.2">𝒟</ci><ci id="S3.SS1.p1.9.m9.1.1.3.2.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">\mathcal{D}\triangleq\bigcup_{k}\mathcal{D}_{k}</annotation></semantics></math> and the global model is expected to be generalized to the distribution of the whole data <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">\mathcal{D}</annotation></semantics></math>. For <span id="S3.SS1.p1.23.3" class="ltx_text ltx_font_italic">personalization</span>, the goal is to learn <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">K</annotation></semantics></math> personalized local models by FL training, and the local model <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">k</annotation></semantics></math> is expected to have better adaptation in local data distribution <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝒟</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\mathcal{D}_{k}</annotation></semantics></math> than the independently trained one.
For the model in FL, we typically consider a neural network <math id="S3.SS1.p1.14.m14.1" class="ltx_Math" alttext="\phi_{\mathbf{w}}" display="inline"><semantics id="S3.SS1.p1.14.m14.1a"><msub id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">ϕ</mi><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">𝐰</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">italic-ϕ</ci><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">\phi_{\mathbf{w}}</annotation></semantics></math> with parameters <math id="S3.SS1.p1.15.m15.2" class="ltx_Math" alttext="\mathbf{w}=\{\mathbf{u},\mathbf{v}\}" display="inline"><semantics id="S3.SS1.p1.15.m15.2a"><mrow id="S3.SS1.p1.15.m15.2.3" xref="S3.SS1.p1.15.m15.2.3.cmml"><mi id="S3.SS1.p1.15.m15.2.3.2" xref="S3.SS1.p1.15.m15.2.3.2.cmml">𝐰</mi><mo id="S3.SS1.p1.15.m15.2.3.1" xref="S3.SS1.p1.15.m15.2.3.1.cmml">=</mo><mrow id="S3.SS1.p1.15.m15.2.3.3.2" xref="S3.SS1.p1.15.m15.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.15.m15.2.3.3.2.1" xref="S3.SS1.p1.15.m15.2.3.3.1.cmml">{</mo><mi id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">𝐮</mi><mo id="S3.SS1.p1.15.m15.2.3.3.2.2" xref="S3.SS1.p1.15.m15.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.15.m15.2.2" xref="S3.SS1.p1.15.m15.2.2.cmml">𝐯</mi><mo stretchy="false" id="S3.SS1.p1.15.m15.2.3.3.2.3" xref="S3.SS1.p1.15.m15.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.2b"><apply id="S3.SS1.p1.15.m15.2.3.cmml" xref="S3.SS1.p1.15.m15.2.3"><eq id="S3.SS1.p1.15.m15.2.3.1.cmml" xref="S3.SS1.p1.15.m15.2.3.1"></eq><ci id="S3.SS1.p1.15.m15.2.3.2.cmml" xref="S3.SS1.p1.15.m15.2.3.2">𝐰</ci><set id="S3.SS1.p1.15.m15.2.3.3.1.cmml" xref="S3.SS1.p1.15.m15.2.3.3.2"><ci id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">𝐮</ci><ci id="S3.SS1.p1.15.m15.2.2.cmml" xref="S3.SS1.p1.15.m15.2.2">𝐯</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.2c">\mathbf{w}=\{\mathbf{u},\mathbf{v}\}</annotation></semantics></math>. It has two main components: 1) a feature extractor <math id="S3.SS1.p1.16.m16.1" class="ltx_Math" alttext="f_{\mathbf{u}}" display="inline"><semantics id="S3.SS1.p1.16.m16.1a"><msub id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml"><mi id="S3.SS1.p1.16.m16.1.1.2" xref="S3.SS1.p1.16.m16.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.16.m16.1.1.3" xref="S3.SS1.p1.16.m16.1.1.3.cmml">𝐮</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><apply id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.1.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m16.1.1.2.cmml" xref="S3.SS1.p1.16.m16.1.1.2">𝑓</ci><ci id="S3.SS1.p1.16.m16.1.1.3.cmml" xref="S3.SS1.p1.16.m16.1.1.3">𝐮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">f_{\mathbf{u}}</annotation></semantics></math> parameterized by <math id="S3.SS1.p1.17.m17.1" class="ltx_Math" alttext="\mathbf{u}" display="inline"><semantics id="S3.SS1.p1.17.m17.1a"><mi id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><ci id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">\mathbf{u}</annotation></semantics></math>, mapping each input sample <math id="S3.SS1.p1.18.m18.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.SS1.p1.18.m18.1a"><mi id="S3.SS1.p1.18.m18.1.1" xref="S3.SS1.p1.18.m18.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.1b"><ci id="S3.SS1.p1.18.m18.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.1c">\mathbf{x}</annotation></semantics></math> to a <math id="S3.SS1.p1.19.m19.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S3.SS1.p1.19.m19.1a"><mi id="S3.SS1.p1.19.m19.1.1" xref="S3.SS1.p1.19.m19.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.1b"><ci id="S3.SS1.p1.19.m19.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.1c">d</annotation></semantics></math>-dim feature vector; 2) a classifier <math id="S3.SS1.p1.20.m20.1" class="ltx_Math" alttext="h_{\mathbf{v}}" display="inline"><semantics id="S3.SS1.p1.20.m20.1a"><msub id="S3.SS1.p1.20.m20.1.1" xref="S3.SS1.p1.20.m20.1.1.cmml"><mi id="S3.SS1.p1.20.m20.1.1.2" xref="S3.SS1.p1.20.m20.1.1.2.cmml">h</mi><mi id="S3.SS1.p1.20.m20.1.1.3" xref="S3.SS1.p1.20.m20.1.1.3.cmml">𝐯</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.20.m20.1b"><apply id="S3.SS1.p1.20.m20.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.20.m20.1.1.1.cmml" xref="S3.SS1.p1.20.m20.1.1">subscript</csymbol><ci id="S3.SS1.p1.20.m20.1.1.2.cmml" xref="S3.SS1.p1.20.m20.1.1.2">ℎ</ci><ci id="S3.SS1.p1.20.m20.1.1.3.cmml" xref="S3.SS1.p1.20.m20.1.1.3">𝐯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.20.m20.1c">h_{\mathbf{v}}</annotation></semantics></math> parameterized by <math id="S3.SS1.p1.21.m21.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="S3.SS1.p1.21.m21.1a"><mi id="S3.SS1.p1.21.m21.1.1" xref="S3.SS1.p1.21.m21.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.21.m21.1b"><ci id="S3.SS1.p1.21.m21.1.1.cmml" xref="S3.SS1.p1.21.m21.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.21.m21.1c">\mathbf{v}</annotation></semantics></math>. The parameters of client <math id="S3.SS1.p1.22.m22.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p1.22.m22.1a"><mi id="S3.SS1.p1.22.m22.1.1" xref="S3.SS1.p1.22.m22.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.22.m22.1b"><ci id="S3.SS1.p1.22.m22.1.1.cmml" xref="S3.SS1.p1.22.m22.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.22.m22.1c">k</annotation></semantics></math>’s local model are denoted as <math id="S3.SS1.p1.23.m23.1" class="ltx_Math" alttext="\mathbf{w}_{k}" display="inline"><semantics id="S3.SS1.p1.23.m23.1a"><msub id="S3.SS1.p1.23.m23.1.1" xref="S3.SS1.p1.23.m23.1.1.cmml"><mi id="S3.SS1.p1.23.m23.1.1.2" xref="S3.SS1.p1.23.m23.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p1.23.m23.1.1.3" xref="S3.SS1.p1.23.m23.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.23.m23.1b"><apply id="S3.SS1.p1.23.m23.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.23.m23.1.1.1.cmml" xref="S3.SS1.p1.23.m23.1.1">subscript</csymbol><ci id="S3.SS1.p1.23.m23.1.1.2.cmml" xref="S3.SS1.p1.23.m23.1.1.2">𝐰</ci><ci id="S3.SS1.p1.23.m23.1.1.3.cmml" xref="S3.SS1.p1.23.m23.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.23.m23.1c">\mathbf{w}_{k}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.3" class="ltx_p"><span id="S3.SS1.p2.3.1" class="ltx_text ltx_font_bold">Model updates.</span> There are two iterative steps in FL, client local training and server global aggregation, and the iteration lasts for <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">T</annotation></semantics></math> rounds. In round <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">t</annotation></semantics></math>, the server first sends a global model <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathbf{w}^{t}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msup id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝐰</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathbf{w}^{t}</annotation></semantics></math> to clients.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para ltx_noindent">
<p id="S3.SS1.p3.2" class="ltx_p"><span id="S3.SS1.p3.2.1" class="ltx_text ltx_font_bold ltx_font_italic">Client local training:</span> For each client <math id="S3.SS1.p3.1.m1.3" class="ltx_Math" alttext="k,~{}\forall k\in[K]" display="inline"><semantics id="S3.SS1.p3.1.m1.3a"><mrow id="S3.SS1.p3.1.m1.3.3" xref="S3.SS1.p3.1.m1.3.3.cmml"><mrow id="S3.SS1.p3.1.m1.3.3.1.1" xref="S3.SS1.p3.1.m1.3.3.1.2.cmml"><mi id="S3.SS1.p3.1.m1.2.2" xref="S3.SS1.p3.1.m1.2.2.cmml">k</mi><mo rspace="0.497em" id="S3.SS1.p3.1.m1.3.3.1.1.2" xref="S3.SS1.p3.1.m1.3.3.1.2.cmml">,</mo><mrow id="S3.SS1.p3.1.m1.3.3.1.1.1" xref="S3.SS1.p3.1.m1.3.3.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS1.p3.1.m1.3.3.1.1.1.1" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1.cmml">∀</mo><mi id="S3.SS1.p3.1.m1.3.3.1.1.1.2" xref="S3.SS1.p3.1.m1.3.3.1.1.1.2.cmml">k</mi></mrow></mrow><mo id="S3.SS1.p3.1.m1.3.3.2" xref="S3.SS1.p3.1.m1.3.3.2.cmml">∈</mo><mrow id="S3.SS1.p3.1.m1.3.3.3.2" xref="S3.SS1.p3.1.m1.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p3.1.m1.3.3.3.2.1" xref="S3.SS1.p3.1.m1.3.3.3.1.1.cmml">[</mo><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">K</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.3.3.3.2.2" xref="S3.SS1.p3.1.m1.3.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.3b"><apply id="S3.SS1.p3.1.m1.3.3.cmml" xref="S3.SS1.p3.1.m1.3.3"><in id="S3.SS1.p3.1.m1.3.3.2.cmml" xref="S3.SS1.p3.1.m1.3.3.2"></in><list id="S3.SS1.p3.1.m1.3.3.1.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1"><ci id="S3.SS1.p3.1.m1.2.2.cmml" xref="S3.SS1.p3.1.m1.2.2">𝑘</ci><apply id="S3.SS1.p3.1.m1.3.3.1.1.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS1.p3.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.1.1">for-all</csymbol><ci id="S3.SS1.p3.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.3.3.1.1.1.2">𝑘</ci></apply></list><apply id="S3.SS1.p3.1.m1.3.3.3.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.2"><csymbol cd="latexml" id="S3.SS1.p3.1.m1.3.3.3.1.1.cmml" xref="S3.SS1.p3.1.m1.3.3.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.3c">k,~{}\forall k\in[K]</annotation></semantics></math>, it conducts SGD updates on the local data <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><msub id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.2.m2.1.1.2" xref="S3.SS1.p3.2.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p3.2.m2.1.1.3" xref="S3.SS1.p3.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><apply id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.2.m2.1.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p3.2.m2.1.1.2.cmml" xref="S3.SS1.p3.2.m2.1.1.2">𝒟</ci><ci id="S3.SS1.p3.2.m2.1.1.3.cmml" xref="S3.SS1.p3.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">\mathcal{D}_{k}</annotation></semantics></math>:</p>
<table id="A3.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{w}_{k}^{t}\leftarrow\mathbf{w}_{k}^{t}-\eta\nabla_{\mathbf{w}}\ell(\mathbf{w}_{k}^{t};\mathcal{B}^{i})," display="inline"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msubsup id="S3.E1.m1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.4.cmml"><mi id="S3.E1.m1.1.1.1.1.4.2.2" xref="S3.E1.m1.1.1.1.1.4.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.1.1.1.1.4.2.3" xref="S3.E1.m1.1.1.1.1.4.2.3.cmml">k</mi><mi id="S3.E1.m1.1.1.1.1.4.3" xref="S3.E1.m1.1.1.1.1.4.3.cmml">t</mi></msubsup><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">←</mo><mrow id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><msubsup id="S3.E1.m1.1.1.1.1.2.4" xref="S3.E1.m1.1.1.1.1.2.4.cmml"><mi id="S3.E1.m1.1.1.1.1.2.4.2.2" xref="S3.E1.m1.1.1.1.1.2.4.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.1.1.1.1.2.4.2.3" xref="S3.E1.m1.1.1.1.1.2.4.2.3.cmml">k</mi><mi id="S3.E1.m1.1.1.1.1.2.4.3" xref="S3.E1.m1.1.1.1.1.2.4.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml">−</mo><mrow id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.4.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.5" xref="S3.E1.m1.1.1.1.1.2.2.5.cmml"><msub id="S3.E1.m1.1.1.1.1.2.2.5.1" xref="S3.E1.m1.1.1.1.1.2.2.5.1.cmml"><mo rspace="0.167em" id="S3.E1.m1.1.1.1.1.2.2.5.1.2" xref="S3.E1.m1.1.1.1.1.2.2.5.1.2.cmml">∇</mo><mi id="S3.E1.m1.1.1.1.1.2.2.5.1.3" xref="S3.E1.m1.1.1.1.1.2.2.5.1.3.cmml">𝐰</mi></msub><mi mathvariant="normal" id="S3.E1.m1.1.1.1.1.2.2.5.2" xref="S3.E1.m1.1.1.1.1.2.2.5.2.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2.2.3a" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.2.2.2.2.4" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">;</mo><msup id="S3.E1.m1.1.1.1.1.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml">ℬ</mi><mi id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2.2.2.2.5" xref="S3.E1.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><ci id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3">←</ci><apply id="S3.E1.m1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.1.4">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.4.2.cmml" xref="S3.E1.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.4.2.1.cmml" xref="S3.E1.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.4.2.2">𝐰</ci><ci id="S3.E1.m1.1.1.1.1.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.4.2.3">𝑘</ci></apply><ci id="S3.E1.m1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.1.1.1.1.4.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><minus id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3"></minus><apply id="S3.E1.m1.1.1.1.1.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.4.1.cmml" xref="S3.E1.m1.1.1.1.1.2.4">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.4.2.cmml" xref="S3.E1.m1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.4.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.4.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.4.2.2">𝐰</ci><ci id="S3.E1.m1.1.1.1.1.2.4.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.4.2.3">𝑘</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.4.3.cmml" xref="S3.E1.m1.1.1.1.1.2.4.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2"><times id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"></times><ci id="S3.E1.m1.1.1.1.1.2.2.4.cmml" xref="S3.E1.m1.1.1.1.1.2.2.4">𝜂</ci><apply id="S3.E1.m1.1.1.1.1.2.2.5.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5"><apply id="S3.E1.m1.1.1.1.1.2.2.5.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.5.1.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.5.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.1.2">∇</ci><ci id="S3.E1.m1.1.1.1.1.2.2.5.1.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.1.3">𝐰</ci></apply><ci id="S3.E1.m1.1.1.1.1.2.2.5.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.5.2">ℓ</ci></apply><list id="S3.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.2">ℬ</ci><ci id="S3.E1.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\displaystyle\mathbf{w}_{k}^{t}\leftarrow\mathbf{w}_{k}^{t}-\eta\nabla_{\mathbf{w}}\ell(\mathbf{w}_{k}^{t};\mathcal{B}^{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.7" class="ltx_p">where <math id="S3.SS1.p3.3.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS1.p3.3.m1.1a"><mi id="S3.SS1.p3.3.m1.1.1" xref="S3.SS1.p3.3.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m1.1b"><ci id="S3.SS1.p3.3.m1.1.1.cmml" xref="S3.SS1.p3.3.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m1.1c">\eta</annotation></semantics></math> is the learning rate, <math id="S3.SS1.p3.4.m2.1" class="ltx_Math" alttext="\mathcal{B}^{i}" display="inline"><semantics id="S3.SS1.p3.4.m2.1a"><msup id="S3.SS1.p3.4.m2.1.1" xref="S3.SS1.p3.4.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.4.m2.1.1.2" xref="S3.SS1.p3.4.m2.1.1.2.cmml">ℬ</mi><mi id="S3.SS1.p3.4.m2.1.1.3" xref="S3.SS1.p3.4.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m2.1b"><apply id="S3.SS1.p3.4.m2.1.1.cmml" xref="S3.SS1.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m2.1.1.1.cmml" xref="S3.SS1.p3.4.m2.1.1">superscript</csymbol><ci id="S3.SS1.p3.4.m2.1.1.2.cmml" xref="S3.SS1.p3.4.m2.1.1.2">ℬ</ci><ci id="S3.SS1.p3.4.m2.1.1.3.cmml" xref="S3.SS1.p3.4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m2.1c">\mathcal{B}^{i}</annotation></semantics></math> is the mini-batch sampled from <math id="S3.SS1.p3.5.m3.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS1.p3.5.m3.1a"><msub id="S3.SS1.p3.5.m3.1.1" xref="S3.SS1.p3.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p3.5.m3.1.1.2" xref="S3.SS1.p3.5.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p3.5.m3.1.1.3" xref="S3.SS1.p3.5.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m3.1b"><apply id="S3.SS1.p3.5.m3.1.1.cmml" xref="S3.SS1.p3.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m3.1.1.1.cmml" xref="S3.SS1.p3.5.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.5.m3.1.1.2.cmml" xref="S3.SS1.p3.5.m3.1.1.2">𝒟</ci><ci id="S3.SS1.p3.5.m3.1.1.3.cmml" xref="S3.SS1.p3.5.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m3.1c">\mathcal{D}_{k}</annotation></semantics></math> at the <math id="S3.SS1.p3.6.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p3.6.m4.1a"><mi id="S3.SS1.p3.6.m4.1.1" xref="S3.SS1.p3.6.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m4.1b"><ci id="S3.SS1.p3.6.m4.1.1.cmml" xref="S3.SS1.p3.6.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m4.1c">i</annotation></semantics></math>-th local iteration. The local epoch is <math id="S3.SS1.p3.7.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS1.p3.7.m5.1a"><mi id="S3.SS1.p3.7.m5.1.1" xref="S3.SS1.p3.7.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m5.1b"><ci id="S3.SS1.p3.7.m5.1.1.cmml" xref="S3.SS1.p3.7.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m5.1c">E</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para ltx_noindent">
<p id="S3.SS1.p4.2" class="ltx_p"><span id="S3.SS1.p4.2.1" class="ltx_text ltx_font_bold ltx_font_italic">Server global aggregation:</span>
After local training, the server samples a set of clients <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{A}^{t}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msup id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">𝒜</mi><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝒜</ci><ci id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathcal{A}^{t}</annotation></semantics></math> and the sampled clients send their updated models to the server. Then the server performs the weighted aggregation to update the global model for round <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="t+1" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mrow id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">t</mi><mo id="S3.SS1.p4.2.m2.1.1.1" xref="S3.SS1.p4.2.m2.1.1.1.cmml">+</mo><mn id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><plus id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1.1"></plus><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">t+1</annotation></semantics></math>. The vanilla aggregation strategy is <span id="S3.SS1.p4.2.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> where the aggregation weights are proportional to clients’ data sizes.</p>
<table id="A3.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{w}^{t+1}" display="inline"><semantics id="S3.E2.m1.1a"><msup id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><mi id="S3.E2.m1.1.1.2" xref="S3.E2.m1.1.1.2.cmml">𝐰</mi><mrow id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.3.2" xref="S3.E2.m1.1.1.3.2.cmml">t</mi><mo id="S3.E2.m1.1.1.3.1" xref="S3.E2.m1.1.1.3.1.cmml">+</mo><mn id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.1.2">𝐰</ci><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><plus id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3.1"></plus><ci id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle\mathbf{w}^{t+1}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{k\in\mathcal{A}^{t}}\frac{n_{k}}{\sum_{j\in\mathcal{A}^{t}}n_{j}}\mathbf{w}_{k}^{t}." display="inline"><semantics id="S3.E2.m2.1a"><mrow id="S3.E2.m2.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml"><mrow id="S3.E2.m2.1.1.1.1" xref="S3.E2.m2.1.1.1.1.cmml"><mi id="S3.E2.m2.1.1.1.1.2" xref="S3.E2.m2.1.1.1.1.2.cmml"></mi><mo id="S3.E2.m2.1.1.1.1.1" xref="S3.E2.m2.1.1.1.1.1.cmml">=</mo><mrow id="S3.E2.m2.1.1.1.1.3" xref="S3.E2.m2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E2.m2.1.1.1.1.3.1" xref="S3.E2.m2.1.1.1.1.3.1.cmml"><munder id="S3.E2.m2.1.1.1.1.3.1a" xref="S3.E2.m2.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E2.m2.1.1.1.1.3.1.2" xref="S3.E2.m2.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S3.E2.m2.1.1.1.1.3.1.3" xref="S3.E2.m2.1.1.1.1.3.1.3.cmml"><mi id="S3.E2.m2.1.1.1.1.3.1.3.2" xref="S3.E2.m2.1.1.1.1.3.1.3.2.cmml">k</mi><mo id="S3.E2.m2.1.1.1.1.3.1.3.1" xref="S3.E2.m2.1.1.1.1.3.1.3.1.cmml">∈</mo><msup id="S3.E2.m2.1.1.1.1.3.1.3.3" xref="S3.E2.m2.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.1.1.1.1.3.1.3.3.2" xref="S3.E2.m2.1.1.1.1.3.1.3.3.2.cmml">𝒜</mi><mi id="S3.E2.m2.1.1.1.1.3.1.3.3.3" xref="S3.E2.m2.1.1.1.1.3.1.3.3.3.cmml">t</mi></msup></mrow></munder></mstyle><mrow id="S3.E2.m2.1.1.1.1.3.2" xref="S3.E2.m2.1.1.1.1.3.2.cmml"><mstyle displaystyle="true" id="S3.E2.m2.1.1.1.1.3.2.2" xref="S3.E2.m2.1.1.1.1.3.2.2.cmml"><mfrac id="S3.E2.m2.1.1.1.1.3.2.2a" xref="S3.E2.m2.1.1.1.1.3.2.2.cmml"><msub id="S3.E2.m2.1.1.1.1.3.2.2.2" xref="S3.E2.m2.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E2.m2.1.1.1.1.3.2.2.2.2" xref="S3.E2.m2.1.1.1.1.3.2.2.2.2.cmml">n</mi><mi id="S3.E2.m2.1.1.1.1.3.2.2.2.3" xref="S3.E2.m2.1.1.1.1.3.2.2.2.3.cmml">k</mi></msub><mrow id="S3.E2.m2.1.1.1.1.3.2.2.3" xref="S3.E2.m2.1.1.1.1.3.2.2.3.cmml"><msub id="S3.E2.m2.1.1.1.1.3.2.2.3.1" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.cmml"><mo id="S3.E2.m2.1.1.1.1.3.2.2.3.1.2" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.2.cmml">∑</mo><mrow id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.cmml"><mi id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.2" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.2.cmml">j</mi><mo id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.1" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.1.cmml">∈</mo><msup id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.2" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.2.cmml">𝒜</mi><mi id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.3" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.3.cmml">t</mi></msup></mrow></msub><msub id="S3.E2.m2.1.1.1.1.3.2.2.3.2" xref="S3.E2.m2.1.1.1.1.3.2.2.3.2.cmml"><mi id="S3.E2.m2.1.1.1.1.3.2.2.3.2.2" xref="S3.E2.m2.1.1.1.1.3.2.2.3.2.2.cmml">n</mi><mi id="S3.E2.m2.1.1.1.1.3.2.2.3.2.3" xref="S3.E2.m2.1.1.1.1.3.2.2.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E2.m2.1.1.1.1.3.2.1" xref="S3.E2.m2.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E2.m2.1.1.1.1.3.2.3" xref="S3.E2.m2.1.1.1.1.3.2.3.cmml"><mi id="S3.E2.m2.1.1.1.1.3.2.3.2.2" xref="S3.E2.m2.1.1.1.1.3.2.3.2.2.cmml">𝐰</mi><mi id="S3.E2.m2.1.1.1.1.3.2.3.2.3" xref="S3.E2.m2.1.1.1.1.3.2.3.2.3.cmml">k</mi><mi id="S3.E2.m2.1.1.1.1.3.2.3.3" xref="S3.E2.m2.1.1.1.1.3.2.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m2.1.1.1.2" xref="S3.E2.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m2.1b"><apply id="S3.E2.m2.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1"><eq id="S3.E2.m2.1.1.1.1.1.cmml" xref="S3.E2.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="S3.E2.m2.1.1.1.1.2.cmml" xref="S3.E2.m2.1.1.1.1.2">absent</csymbol><apply id="S3.E2.m2.1.1.1.1.3.cmml" xref="S3.E2.m2.1.1.1.1.3"><apply id="S3.E2.m2.1.1.1.1.3.1.cmml" xref="S3.E2.m2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.3.1.1.cmml" xref="S3.E2.m2.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E2.m2.1.1.1.1.3.1.2.cmml" xref="S3.E2.m2.1.1.1.1.3.1.2"></sum><apply id="S3.E2.m2.1.1.1.1.3.1.3.cmml" xref="S3.E2.m2.1.1.1.1.3.1.3"><in id="S3.E2.m2.1.1.1.1.3.1.3.1.cmml" xref="S3.E2.m2.1.1.1.1.3.1.3.1"></in><ci id="S3.E2.m2.1.1.1.1.3.1.3.2.cmml" xref="S3.E2.m2.1.1.1.1.3.1.3.2">𝑘</ci><apply id="S3.E2.m2.1.1.1.1.3.1.3.3.cmml" xref="S3.E2.m2.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.3.1.3.3.1.cmml" xref="S3.E2.m2.1.1.1.1.3.1.3.3">superscript</csymbol><ci id="S3.E2.m2.1.1.1.1.3.1.3.3.2.cmml" xref="S3.E2.m2.1.1.1.1.3.1.3.3.2">𝒜</ci><ci id="S3.E2.m2.1.1.1.1.3.1.3.3.3.cmml" xref="S3.E2.m2.1.1.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m2.1.1.1.1.3.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2"><times id="S3.E2.m2.1.1.1.1.3.2.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.1"></times><apply id="S3.E2.m2.1.1.1.1.3.2.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2"><divide id="S3.E2.m2.1.1.1.1.3.2.2.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2"></divide><apply id="S3.E2.m2.1.1.1.1.3.2.2.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.2.2">𝑛</ci><ci id="S3.E2.m2.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.2.3">𝑘</ci></apply><apply id="S3.E2.m2.1.1.1.1.3.2.2.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3"><apply id="S3.E2.m2.1.1.1.1.3.2.2.3.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.3.2.2.3.1.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1">subscript</csymbol><sum id="S3.E2.m2.1.1.1.1.3.2.2.3.1.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.2"></sum><apply id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3"><in id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.1"></in><ci id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.2">𝑗</ci><apply id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3">superscript</csymbol><ci id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.2">𝒜</ci><ci id="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E2.m2.1.1.1.1.3.2.2.3.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.3.2.2.3.2.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.3.2.2.3.2.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.2.2">𝑛</ci><ci id="S3.E2.m2.1.1.1.1.3.2.2.3.2.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E2.m2.1.1.1.1.3.2.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.3.2.3.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.3">superscript</csymbol><apply id="S3.E2.m2.1.1.1.1.3.2.3.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E2.m2.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E2.m2.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E2.m2.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E2.m2.1.1.1.1.3.2.3.2.2">𝐰</ci><ci id="S3.E2.m2.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.3.2.3">𝑘</ci></apply><ci id="S3.E2.m2.1.1.1.1.3.2.3.3.cmml" xref="S3.E2.m2.1.1.1.1.3.2.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m2.1c">\displaystyle=\sum_{k\in\mathcal{A}^{t}}\frac{n_{k}}{\sum_{j\in\mathcal{A}^{t}}n_{j}}\mathbf{w}_{k}^{t}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Neural Collapse</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Neural collapse refers to a phenomenon about the last-layer features and classifier vectors at the terminal phase of training (zero training loss) on a balanced dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. We first give the definition of simplex ETF in neural collapse.</p>
</div>
<div id="S3.Thmtheorem1" class="ltx_theorem ltx_theorem_definition">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="S3.Thmtheorem1.1.1.1" class="ltx_text ltx_font_bold">Definition 3.1</span></span><span id="S3.Thmtheorem1.2.2" class="ltx_text ltx_font_bold"> </span>(Simplex Equiangular Tight Frame)<span id="S3.Thmtheorem1.3.3" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="S3.Thmtheorem1.p1" class="ltx_para">
<p id="S3.Thmtheorem1.p1.3" class="ltx_p">A collection of vectors <math id="S3.Thmtheorem1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{v}_{i}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.Thmtheorem1.p1.1.m1.1a"><mrow id="S3.Thmtheorem1.p1.1.m1.1.1" xref="S3.Thmtheorem1.p1.1.m1.1.1.cmml"><msub id="S3.Thmtheorem1.p1.1.m1.1.1.2" xref="S3.Thmtheorem1.p1.1.m1.1.1.2.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.1.1.2.2" xref="S3.Thmtheorem1.p1.1.m1.1.1.2.2.cmml">𝐯</mi><mi id="S3.Thmtheorem1.p1.1.m1.1.1.2.3" xref="S3.Thmtheorem1.p1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.Thmtheorem1.p1.1.m1.1.1.1" xref="S3.Thmtheorem1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.Thmtheorem1.p1.1.m1.1.1.3" xref="S3.Thmtheorem1.p1.1.m1.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.1.m1.1.1.3.2" xref="S3.Thmtheorem1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.Thmtheorem1.p1.1.m1.1.1.3.3" xref="S3.Thmtheorem1.p1.1.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.1.m1.1b"><apply id="S3.Thmtheorem1.p1.1.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1"><in id="S3.Thmtheorem1.p1.1.m1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.1"></in><apply id="S3.Thmtheorem1.p1.1.m1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.m1.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.1.m1.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.2.2">𝐯</ci><ci id="S3.Thmtheorem1.p1.1.m1.1.1.2.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.Thmtheorem1.p1.1.m1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.1.m1.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.Thmtheorem1.p1.1.m1.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.3.2">ℝ</ci><ci id="S3.Thmtheorem1.p1.1.m1.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.1.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.1.m1.1c">\mathbf{v}_{i}\in\mathbb{R}^{d}</annotation></semantics></math>, <math id="S3.Thmtheorem1.p1.2.m2.1" class="ltx_Math" alttext="i\in[C]" display="inline"><semantics id="S3.Thmtheorem1.p1.2.m2.1a"><mrow id="S3.Thmtheorem1.p1.2.m2.1.2" xref="S3.Thmtheorem1.p1.2.m2.1.2.cmml"><mi id="S3.Thmtheorem1.p1.2.m2.1.2.2" xref="S3.Thmtheorem1.p1.2.m2.1.2.2.cmml">i</mi><mo id="S3.Thmtheorem1.p1.2.m2.1.2.1" xref="S3.Thmtheorem1.p1.2.m2.1.2.1.cmml">∈</mo><mrow id="S3.Thmtheorem1.p1.2.m2.1.2.3.2" xref="S3.Thmtheorem1.p1.2.m2.1.2.3.1.cmml"><mo stretchy="false" id="S3.Thmtheorem1.p1.2.m2.1.2.3.2.1" xref="S3.Thmtheorem1.p1.2.m2.1.2.3.1.1.cmml">[</mo><mi id="S3.Thmtheorem1.p1.2.m2.1.1" xref="S3.Thmtheorem1.p1.2.m2.1.1.cmml">C</mi><mo stretchy="false" id="S3.Thmtheorem1.p1.2.m2.1.2.3.2.2" xref="S3.Thmtheorem1.p1.2.m2.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.2.m2.1b"><apply id="S3.Thmtheorem1.p1.2.m2.1.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.2"><in id="S3.Thmtheorem1.p1.2.m2.1.2.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.2.1"></in><ci id="S3.Thmtheorem1.p1.2.m2.1.2.2.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.2.2">𝑖</ci><apply id="S3.Thmtheorem1.p1.2.m2.1.2.3.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.2.3.2"><csymbol cd="latexml" id="S3.Thmtheorem1.p1.2.m2.1.2.3.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.Thmtheorem1.p1.2.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.2.m2.1.1">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.2.m2.1c">i\in[C]</annotation></semantics></math>, <math id="S3.Thmtheorem1.p1.3.m3.1" class="ltx_Math" alttext="d\geq C-1" display="inline"><semantics id="S3.Thmtheorem1.p1.3.m3.1a"><mrow id="S3.Thmtheorem1.p1.3.m3.1.1" xref="S3.Thmtheorem1.p1.3.m3.1.1.cmml"><mi id="S3.Thmtheorem1.p1.3.m3.1.1.2" xref="S3.Thmtheorem1.p1.3.m3.1.1.2.cmml">d</mi><mo id="S3.Thmtheorem1.p1.3.m3.1.1.1" xref="S3.Thmtheorem1.p1.3.m3.1.1.1.cmml">≥</mo><mrow id="S3.Thmtheorem1.p1.3.m3.1.1.3" xref="S3.Thmtheorem1.p1.3.m3.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.3.m3.1.1.3.2" xref="S3.Thmtheorem1.p1.3.m3.1.1.3.2.cmml">C</mi><mo id="S3.Thmtheorem1.p1.3.m3.1.1.3.1" xref="S3.Thmtheorem1.p1.3.m3.1.1.3.1.cmml">−</mo><mn id="S3.Thmtheorem1.p1.3.m3.1.1.3.3" xref="S3.Thmtheorem1.p1.3.m3.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.3.m3.1b"><apply id="S3.Thmtheorem1.p1.3.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1"><geq id="S3.Thmtheorem1.p1.3.m3.1.1.1.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1.1"></geq><ci id="S3.Thmtheorem1.p1.3.m3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1.2">𝑑</ci><apply id="S3.Thmtheorem1.p1.3.m3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1.3"><minus id="S3.Thmtheorem1.p1.3.m3.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1.3.1"></minus><ci id="S3.Thmtheorem1.p1.3.m3.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1.3.2">𝐶</ci><cn type="integer" id="S3.Thmtheorem1.p1.3.m3.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.3.m3.1c">d\geq C-1</annotation></semantics></math>, is said to be a simplex equiangular tight frame if:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="\mathbf{V}=\sqrt{\frac{C}{C-1}}\mathbf{U}\left(\mathbf{I}_{C}-\frac{1}{C}\mathbf{1}_{C}\mathbf{1}_{C}^{T}\right)," display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml">𝐕</mi><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><msqrt id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml"><mfrac id="S3.E3.m1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.3.2.2.cmml">C</mi><mrow id="S3.E3.m1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.3.2.3.2" xref="S3.E3.m1.1.1.1.1.1.3.2.3.2.cmml">C</mi><mo id="S3.E3.m1.1.1.1.1.1.3.2.3.1" xref="S3.E3.m1.1.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S3.E3.m1.1.1.1.1.1.3.2.3.3" xref="S3.E3.m1.1.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></mfrac></msqrt><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E3.m1.1.1.1.1.1.4" xref="S3.E3.m1.1.1.1.1.1.4.cmml">𝐔</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.2a" xref="S3.E3.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐈</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml">C</mi></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">1</mn><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">C</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.2.cmml">𝟏</mn><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.3.cmml">C</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.1a" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.cmml"><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.2.cmml">𝟏</mn><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.3.cmml">C</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.3.cmml">T</mi></msubsup></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"></eq><ci id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3">𝐕</ci><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3"><root id="S3.E3.m1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.3"></root><apply id="S3.E3.m1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.3.2"><divide id="S3.E3.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.3.2"></divide><ci id="S3.E3.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.3.2.2">𝐶</ci><apply id="S3.E3.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3.2.3"><minus id="S3.E3.m1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.3.2.3.1"></minus><ci id="S3.E3.m1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.3.2.3.2">𝐶</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3.2.3.3">1</cn></apply></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.1.1.4">𝐔</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.2">𝐈</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.3">𝐶</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2"><divide id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2"></divide><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.2">1</cn><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.2.3">𝐶</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.3.3">𝐶</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4">subscript</csymbol><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.2">1</cn><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.2.3">𝐶</ci></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.4.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\mathbf{V}=\sqrt{\frac{C}{C-1}}\mathbf{U}\left(\mathbf{I}_{C}-\frac{1}{C}\mathbf{1}_{C}\mathbf{1}_{C}^{T}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.Thmtheorem1.p1.9" class="ltx_p">where <math id="S3.Thmtheorem1.p1.4.m1.3" class="ltx_Math" alttext="\mathbf{V}=[\mathbf{v}_{1},\cdots,\mathbf{v}_{C}]\in\mathbb{R}^{d\times C}" display="inline"><semantics id="S3.Thmtheorem1.p1.4.m1.3a"><mrow id="S3.Thmtheorem1.p1.4.m1.3.3" xref="S3.Thmtheorem1.p1.4.m1.3.3.cmml"><mi id="S3.Thmtheorem1.p1.4.m1.3.3.4" xref="S3.Thmtheorem1.p1.4.m1.3.3.4.cmml">𝐕</mi><mo id="S3.Thmtheorem1.p1.4.m1.3.3.5" xref="S3.Thmtheorem1.p1.4.m1.3.3.5.cmml">=</mo><mrow id="S3.Thmtheorem1.p1.4.m1.3.3.2.2" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.3.cmml"><mo stretchy="false" id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.3" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.3.cmml">[</mo><msub id="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1" xref="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.cmml"><mi id="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.2" xref="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.2.cmml">𝐯</mi><mn id="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.3" xref="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.4" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.Thmtheorem1.p1.4.m1.1.1" xref="S3.Thmtheorem1.p1.4.m1.1.1.cmml">⋯</mi><mo id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.5" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.3.cmml">,</mo><msub id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.cmml"><mi id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.2" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.2.cmml">𝐯</mi><mi id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.3" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.3.cmml">C</mi></msub><mo stretchy="false" id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.6" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.3.cmml">]</mo></mrow><mo id="S3.Thmtheorem1.p1.4.m1.3.3.6" xref="S3.Thmtheorem1.p1.4.m1.3.3.6.cmml">∈</mo><msup id="S3.Thmtheorem1.p1.4.m1.3.3.7" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.cmml"><mi id="S3.Thmtheorem1.p1.4.m1.3.3.7.2" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.2.cmml">ℝ</mi><mrow id="S3.Thmtheorem1.p1.4.m1.3.3.7.3" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.3.cmml"><mi id="S3.Thmtheorem1.p1.4.m1.3.3.7.3.2" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.Thmtheorem1.p1.4.m1.3.3.7.3.1" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.3.1.cmml">×</mo><mi id="S3.Thmtheorem1.p1.4.m1.3.3.7.3.3" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.4.m1.3b"><apply id="S3.Thmtheorem1.p1.4.m1.3.3.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3"><and id="S3.Thmtheorem1.p1.4.m1.3.3a.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3"></and><apply id="S3.Thmtheorem1.p1.4.m1.3.3b.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3"><eq id="S3.Thmtheorem1.p1.4.m1.3.3.5.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.5"></eq><ci id="S3.Thmtheorem1.p1.4.m1.3.3.4.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.4">𝐕</ci><list id="S3.Thmtheorem1.p1.4.m1.3.3.2.3.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.2"><apply id="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.2.cmml" xref="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.2">𝐯</ci><cn type="integer" id="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.3.cmml" xref="S3.Thmtheorem1.p1.4.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.Thmtheorem1.p1.4.m1.1.1.cmml" xref="S3.Thmtheorem1.p1.4.m1.1.1">⋯</ci><apply id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.1.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.2">𝐯</ci><ci id="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.2.2.2.3">𝐶</ci></apply></list></apply><apply id="S3.Thmtheorem1.p1.4.m1.3.3c.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3"><in id="S3.Thmtheorem1.p1.4.m1.3.3.6.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.6"></in><share href="#S3.Thmtheorem1.p1.4.m1.3.3.2.cmml" id="S3.Thmtheorem1.p1.4.m1.3.3d.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3"></share><apply id="S3.Thmtheorem1.p1.4.m1.3.3.7.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.7"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.4.m1.3.3.7.1.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.7">superscript</csymbol><ci id="S3.Thmtheorem1.p1.4.m1.3.3.7.2.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.2">ℝ</ci><apply id="S3.Thmtheorem1.p1.4.m1.3.3.7.3.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.3"><times id="S3.Thmtheorem1.p1.4.m1.3.3.7.3.1.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.3.1"></times><ci id="S3.Thmtheorem1.p1.4.m1.3.3.7.3.2.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.3.2">𝑑</ci><ci id="S3.Thmtheorem1.p1.4.m1.3.3.7.3.3.cmml" xref="S3.Thmtheorem1.p1.4.m1.3.3.7.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.4.m1.3c">\mathbf{V}=[\mathbf{v}_{1},\cdots,\mathbf{v}_{C}]\in\mathbb{R}^{d\times C}</annotation></semantics></math>, <math id="S3.Thmtheorem1.p1.5.m2.1" class="ltx_Math" alttext="\mathbf{U}\in\mathbb{R}^{d\times C}" display="inline"><semantics id="S3.Thmtheorem1.p1.5.m2.1a"><mrow id="S3.Thmtheorem1.p1.5.m2.1.1" xref="S3.Thmtheorem1.p1.5.m2.1.1.cmml"><mi id="S3.Thmtheorem1.p1.5.m2.1.1.2" xref="S3.Thmtheorem1.p1.5.m2.1.1.2.cmml">𝐔</mi><mo id="S3.Thmtheorem1.p1.5.m2.1.1.1" xref="S3.Thmtheorem1.p1.5.m2.1.1.1.cmml">∈</mo><msup id="S3.Thmtheorem1.p1.5.m2.1.1.3" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.5.m2.1.1.3.2" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.Thmtheorem1.p1.5.m2.1.1.3.3" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.3.cmml"><mi id="S3.Thmtheorem1.p1.5.m2.1.1.3.3.2" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.Thmtheorem1.p1.5.m2.1.1.3.3.1" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.Thmtheorem1.p1.5.m2.1.1.3.3.3" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.5.m2.1b"><apply id="S3.Thmtheorem1.p1.5.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1"><in id="S3.Thmtheorem1.p1.5.m2.1.1.1.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.1"></in><ci id="S3.Thmtheorem1.p1.5.m2.1.1.2.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.2">𝐔</ci><apply id="S3.Thmtheorem1.p1.5.m2.1.1.3.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.5.m2.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.3">superscript</csymbol><ci id="S3.Thmtheorem1.p1.5.m2.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.2">ℝ</ci><apply id="S3.Thmtheorem1.p1.5.m2.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.3"><times id="S3.Thmtheorem1.p1.5.m2.1.1.3.3.1.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.3.1"></times><ci id="S3.Thmtheorem1.p1.5.m2.1.1.3.3.2.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.3.2">𝑑</ci><ci id="S3.Thmtheorem1.p1.5.m2.1.1.3.3.3.cmml" xref="S3.Thmtheorem1.p1.5.m2.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.5.m2.1c">\mathbf{U}\in\mathbb{R}^{d\times C}</annotation></semantics></math> allows a rotation and satisfies <math id="S3.Thmtheorem1.p1.6.m3.1" class="ltx_Math" alttext="\mathbf{U}^{T}\mathbf{U}=\mathbf{I}_{C}" display="inline"><semantics id="S3.Thmtheorem1.p1.6.m3.1a"><mrow id="S3.Thmtheorem1.p1.6.m3.1.1" xref="S3.Thmtheorem1.p1.6.m3.1.1.cmml"><mrow id="S3.Thmtheorem1.p1.6.m3.1.1.2" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.cmml"><msup id="S3.Thmtheorem1.p1.6.m3.1.1.2.2" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.2.cmml"><mi id="S3.Thmtheorem1.p1.6.m3.1.1.2.2.2" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.2.2.cmml">𝐔</mi><mi id="S3.Thmtheorem1.p1.6.m3.1.1.2.2.3" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.Thmtheorem1.p1.6.m3.1.1.2.1" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.1.cmml">​</mo><mi id="S3.Thmtheorem1.p1.6.m3.1.1.2.3" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.3.cmml">𝐔</mi></mrow><mo id="S3.Thmtheorem1.p1.6.m3.1.1.1" xref="S3.Thmtheorem1.p1.6.m3.1.1.1.cmml">=</mo><msub id="S3.Thmtheorem1.p1.6.m3.1.1.3" xref="S3.Thmtheorem1.p1.6.m3.1.1.3.cmml"><mi id="S3.Thmtheorem1.p1.6.m3.1.1.3.2" xref="S3.Thmtheorem1.p1.6.m3.1.1.3.2.cmml">𝐈</mi><mi id="S3.Thmtheorem1.p1.6.m3.1.1.3.3" xref="S3.Thmtheorem1.p1.6.m3.1.1.3.3.cmml">C</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.6.m3.1b"><apply id="S3.Thmtheorem1.p1.6.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1"><eq id="S3.Thmtheorem1.p1.6.m3.1.1.1.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.1"></eq><apply id="S3.Thmtheorem1.p1.6.m3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.2"><times id="S3.Thmtheorem1.p1.6.m3.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.1"></times><apply id="S3.Thmtheorem1.p1.6.m3.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.2"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.m3.1.1.2.2.1.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.2">superscript</csymbol><ci id="S3.Thmtheorem1.p1.6.m3.1.1.2.2.2.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.2.2">𝐔</ci><ci id="S3.Thmtheorem1.p1.6.m3.1.1.2.2.3.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.2.3">𝑇</ci></apply><ci id="S3.Thmtheorem1.p1.6.m3.1.1.2.3.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.2.3">𝐔</ci></apply><apply id="S3.Thmtheorem1.p1.6.m3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.6.m3.1.1.3.1.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.3">subscript</csymbol><ci id="S3.Thmtheorem1.p1.6.m3.1.1.3.2.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.3.2">𝐈</ci><ci id="S3.Thmtheorem1.p1.6.m3.1.1.3.3.cmml" xref="S3.Thmtheorem1.p1.6.m3.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.6.m3.1c">\mathbf{U}^{T}\mathbf{U}=\mathbf{I}_{C}</annotation></semantics></math>, <math id="S3.Thmtheorem1.p1.7.m4.1" class="ltx_Math" alttext="\mathbf{I}_{C}" display="inline"><semantics id="S3.Thmtheorem1.p1.7.m4.1a"><msub id="S3.Thmtheorem1.p1.7.m4.1.1" xref="S3.Thmtheorem1.p1.7.m4.1.1.cmml"><mi id="S3.Thmtheorem1.p1.7.m4.1.1.2" xref="S3.Thmtheorem1.p1.7.m4.1.1.2.cmml">𝐈</mi><mi id="S3.Thmtheorem1.p1.7.m4.1.1.3" xref="S3.Thmtheorem1.p1.7.m4.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.7.m4.1b"><apply id="S3.Thmtheorem1.p1.7.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.7.m4.1.1.1.cmml" xref="S3.Thmtheorem1.p1.7.m4.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.7.m4.1.1.2.cmml" xref="S3.Thmtheorem1.p1.7.m4.1.1.2">𝐈</ci><ci id="S3.Thmtheorem1.p1.7.m4.1.1.3.cmml" xref="S3.Thmtheorem1.p1.7.m4.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.7.m4.1c">\mathbf{I}_{C}</annotation></semantics></math> is the identity matrix, and <math id="S3.Thmtheorem1.p1.8.m5.1" class="ltx_Math" alttext="\mathbf{1}_{C}" display="inline"><semantics id="S3.Thmtheorem1.p1.8.m5.1a"><msub id="S3.Thmtheorem1.p1.8.m5.1.1" xref="S3.Thmtheorem1.p1.8.m5.1.1.cmml"><mn id="S3.Thmtheorem1.p1.8.m5.1.1.2" xref="S3.Thmtheorem1.p1.8.m5.1.1.2.cmml">𝟏</mn><mi id="S3.Thmtheorem1.p1.8.m5.1.1.3" xref="S3.Thmtheorem1.p1.8.m5.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.8.m5.1b"><apply id="S3.Thmtheorem1.p1.8.m5.1.1.cmml" xref="S3.Thmtheorem1.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.8.m5.1.1.1.cmml" xref="S3.Thmtheorem1.p1.8.m5.1.1">subscript</csymbol><cn type="integer" id="S3.Thmtheorem1.p1.8.m5.1.1.2.cmml" xref="S3.Thmtheorem1.p1.8.m5.1.1.2">1</cn><ci id="S3.Thmtheorem1.p1.8.m5.1.1.3.cmml" xref="S3.Thmtheorem1.p1.8.m5.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.8.m5.1c">\mathbf{1}_{C}</annotation></semantics></math> is an all-ones vector. All vectors in a simplex ETF have an equal <math id="S3.Thmtheorem1.p1.9.m6.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S3.Thmtheorem1.p1.9.m6.1a"><msub id="S3.Thmtheorem1.p1.9.m6.1.1" xref="S3.Thmtheorem1.p1.9.m6.1.1.cmml"><mi mathvariant="normal" id="S3.Thmtheorem1.p1.9.m6.1.1.2" xref="S3.Thmtheorem1.p1.9.m6.1.1.2.cmml">ℓ</mi><mn id="S3.Thmtheorem1.p1.9.m6.1.1.3" xref="S3.Thmtheorem1.p1.9.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.9.m6.1b"><apply id="S3.Thmtheorem1.p1.9.m6.1.1.cmml" xref="S3.Thmtheorem1.p1.9.m6.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.9.m6.1.1.1.cmml" xref="S3.Thmtheorem1.p1.9.m6.1.1">subscript</csymbol><ci id="S3.Thmtheorem1.p1.9.m6.1.1.2.cmml" xref="S3.Thmtheorem1.p1.9.m6.1.1.2">ℓ</ci><cn type="integer" id="S3.Thmtheorem1.p1.9.m6.1.1.3.cmml" xref="S3.Thmtheorem1.p1.9.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.9.m6.1c">\ell_{2}</annotation></semantics></math> norm and the same pair-wise angle, i.e.</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\mathbf{v}_{i}^{T}\mathbf{v}_{j}=\frac{C}{C-1}\delta_{i,j}-\frac{1}{C-1},\forall i,j\in[C]," display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4.1"><mrow id="S3.E4.m1.4.4.1.1.2" xref="S3.E4.m1.4.4.1.1.3.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.4" xref="S3.E4.m1.4.4.1.1.1.1.4.cmml"><msubsup id="S3.E4.m1.4.4.1.1.1.1.4.2" xref="S3.E4.m1.4.4.1.1.1.1.4.2.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.4.2.2.2" xref="S3.E4.m1.4.4.1.1.1.1.4.2.2.2.cmml">𝐯</mi><mi id="S3.E4.m1.4.4.1.1.1.1.4.2.2.3" xref="S3.E4.m1.4.4.1.1.1.1.4.2.2.3.cmml">i</mi><mi id="S3.E4.m1.4.4.1.1.1.1.4.2.3" xref="S3.E4.m1.4.4.1.1.1.1.4.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.1.1.4.1" xref="S3.E4.m1.4.4.1.1.1.1.4.1.cmml">​</mo><msub id="S3.E4.m1.4.4.1.1.1.1.4.3" xref="S3.E4.m1.4.4.1.1.1.1.4.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.4.3.2" xref="S3.E4.m1.4.4.1.1.1.1.4.3.2.cmml">𝐯</mi><mi id="S3.E4.m1.4.4.1.1.1.1.4.3.3" xref="S3.E4.m1.4.4.1.1.1.1.4.3.3.cmml">j</mi></msub></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.3.cmml">=</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.3.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mfrac id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml">C</mi><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.cmml">C</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.1.cmml">−</mo><mn id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">​</mo><msub id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml">δ</mi><mrow id="S3.E4.m1.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">i</mi><mo id="S3.E4.m1.2.2.2.4.1" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mn id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">1</mn><mrow id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml">C</mi><mo id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mrow><mo id="S3.E4.m1.4.4.1.1.1.1.2.2.3" xref="S3.E4.m1.4.4.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.2.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S3.E4.m1.4.4.1.1.1.1.2.2.2.1" xref="S3.E4.m1.4.4.1.1.1.1.2.2.2.1.cmml">∀</mo><mi id="S3.E4.m1.4.4.1.1.1.1.2.2.2.2" xref="S3.E4.m1.4.4.1.1.1.1.2.2.2.2.cmml">i</mi></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.2.3" xref="S3.E4.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S3.E4.m1.4.4.1.1.2.2" xref="S3.E4.m1.4.4.1.1.2.2.cmml"><mi id="S3.E4.m1.4.4.1.1.2.2.2" xref="S3.E4.m1.4.4.1.1.2.2.2.cmml">j</mi><mo id="S3.E4.m1.4.4.1.1.2.2.1" xref="S3.E4.m1.4.4.1.1.2.2.1.cmml">∈</mo><mrow id="S3.E4.m1.4.4.1.1.2.2.3.2" xref="S3.E4.m1.4.4.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.2.2.3.2.1" xref="S3.E4.m1.4.4.1.1.2.2.3.1.1.cmml">[</mo><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">C</mi><mo stretchy="false" id="S3.E4.m1.4.4.1.1.2.2.3.2.2" xref="S3.E4.m1.4.4.1.1.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.3a.cmml" xref="S3.E4.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1"><eq id="S3.E4.m1.4.4.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.3"></eq><apply id="S3.E4.m1.4.4.1.1.1.1.4.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4"><times id="S3.E4.m1.4.4.1.1.1.1.4.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.1"></times><apply id="S3.E4.m1.4.4.1.1.1.1.4.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.4.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.2">superscript</csymbol><apply id="S3.E4.m1.4.4.1.1.1.1.4.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.4.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.4.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.2.2.2">𝐯</ci><ci id="S3.E4.m1.4.4.1.1.1.1.4.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.2.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.1.1.1.1.4.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.2.3">𝑇</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.1.4.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.4.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.3">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.4.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.3.2">𝐯</ci><ci id="S3.E4.m1.4.4.1.1.1.1.4.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.4.3.3">𝑗</ci></apply></apply><list id="S3.E4.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2"><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1"><minus id="S3.E4.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.1"></minus><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2"><times id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.1"></times><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2"><divide id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2"></divide><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.2">𝐶</ci><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3"><minus id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.1"></minus><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.2">𝐶</ci><cn type="integer" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.2.3.2">𝛿</ci><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.4"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑖</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑗</ci></list></apply></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3"><divide id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3"></divide><cn type="integer" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.2">1</cn><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3"><minus id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.2">𝐶</ci><cn type="integer" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S3.E4.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2.2.1">for-all</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.2.2.2.2">𝑖</ci></apply></list></apply><apply id="S3.E4.m1.4.4.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.2"><in id="S3.E4.m1.4.4.1.1.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.2.2.1"></in><ci id="S3.E4.m1.4.4.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.2.2">𝑗</ci><apply id="S3.E4.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E4.m1.4.4.1.1.2.2.3.2"><csymbol cd="latexml" id="S3.E4.m1.4.4.1.1.2.2.3.1.1.cmml" xref="S3.E4.m1.4.4.1.1.2.2.3.2.1">delimited-[]</csymbol><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\mathbf{v}_{i}^{T}\mathbf{v}_{j}=\frac{C}{C-1}\delta_{i,j}-\frac{1}{C-1},\forall i,j\in[C],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.Thmtheorem1.p1.16" class="ltx_p">where <math id="S3.Thmtheorem1.p1.10.m1.2" class="ltx_Math" alttext="\delta_{i,j}" display="inline"><semantics id="S3.Thmtheorem1.p1.10.m1.2a"><msub id="S3.Thmtheorem1.p1.10.m1.2.3" xref="S3.Thmtheorem1.p1.10.m1.2.3.cmml"><mi id="S3.Thmtheorem1.p1.10.m1.2.3.2" xref="S3.Thmtheorem1.p1.10.m1.2.3.2.cmml">δ</mi><mrow id="S3.Thmtheorem1.p1.10.m1.2.2.2.4" xref="S3.Thmtheorem1.p1.10.m1.2.2.2.3.cmml"><mi id="S3.Thmtheorem1.p1.10.m1.1.1.1.1" xref="S3.Thmtheorem1.p1.10.m1.1.1.1.1.cmml">i</mi><mo id="S3.Thmtheorem1.p1.10.m1.2.2.2.4.1" xref="S3.Thmtheorem1.p1.10.m1.2.2.2.3.cmml">,</mo><mi id="S3.Thmtheorem1.p1.10.m1.2.2.2.2" xref="S3.Thmtheorem1.p1.10.m1.2.2.2.2.cmml">j</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.10.m1.2b"><apply id="S3.Thmtheorem1.p1.10.m1.2.3.cmml" xref="S3.Thmtheorem1.p1.10.m1.2.3"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.10.m1.2.3.1.cmml" xref="S3.Thmtheorem1.p1.10.m1.2.3">subscript</csymbol><ci id="S3.Thmtheorem1.p1.10.m1.2.3.2.cmml" xref="S3.Thmtheorem1.p1.10.m1.2.3.2">𝛿</ci><list id="S3.Thmtheorem1.p1.10.m1.2.2.2.3.cmml" xref="S3.Thmtheorem1.p1.10.m1.2.2.2.4"><ci id="S3.Thmtheorem1.p1.10.m1.1.1.1.1.cmml" xref="S3.Thmtheorem1.p1.10.m1.1.1.1.1">𝑖</ci><ci id="S3.Thmtheorem1.p1.10.m1.2.2.2.2.cmml" xref="S3.Thmtheorem1.p1.10.m1.2.2.2.2">𝑗</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.10.m1.2c">\delta_{i,j}</annotation></semantics></math> equals to <math id="S3.Thmtheorem1.p1.11.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.Thmtheorem1.p1.11.m2.1a"><mn id="S3.Thmtheorem1.p1.11.m2.1.1" xref="S3.Thmtheorem1.p1.11.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.11.m2.1b"><cn type="integer" id="S3.Thmtheorem1.p1.11.m2.1.1.cmml" xref="S3.Thmtheorem1.p1.11.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.11.m2.1c">1</annotation></semantics></math> when <math id="S3.Thmtheorem1.p1.12.m3.1" class="ltx_Math" alttext="i=j" display="inline"><semantics id="S3.Thmtheorem1.p1.12.m3.1a"><mrow id="S3.Thmtheorem1.p1.12.m3.1.1" xref="S3.Thmtheorem1.p1.12.m3.1.1.cmml"><mi id="S3.Thmtheorem1.p1.12.m3.1.1.2" xref="S3.Thmtheorem1.p1.12.m3.1.1.2.cmml">i</mi><mo id="S3.Thmtheorem1.p1.12.m3.1.1.1" xref="S3.Thmtheorem1.p1.12.m3.1.1.1.cmml">=</mo><mi id="S3.Thmtheorem1.p1.12.m3.1.1.3" xref="S3.Thmtheorem1.p1.12.m3.1.1.3.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.12.m3.1b"><apply id="S3.Thmtheorem1.p1.12.m3.1.1.cmml" xref="S3.Thmtheorem1.p1.12.m3.1.1"><eq id="S3.Thmtheorem1.p1.12.m3.1.1.1.cmml" xref="S3.Thmtheorem1.p1.12.m3.1.1.1"></eq><ci id="S3.Thmtheorem1.p1.12.m3.1.1.2.cmml" xref="S3.Thmtheorem1.p1.12.m3.1.1.2">𝑖</ci><ci id="S3.Thmtheorem1.p1.12.m3.1.1.3.cmml" xref="S3.Thmtheorem1.p1.12.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.12.m3.1c">i=j</annotation></semantics></math> and <math id="S3.Thmtheorem1.p1.13.m4.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.Thmtheorem1.p1.13.m4.1a"><mn id="S3.Thmtheorem1.p1.13.m4.1.1" xref="S3.Thmtheorem1.p1.13.m4.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.13.m4.1b"><cn type="integer" id="S3.Thmtheorem1.p1.13.m4.1.1.cmml" xref="S3.Thmtheorem1.p1.13.m4.1.1">0</cn></annotation-xml></semantics></math> otherwise. The pair-wise angle <math id="S3.Thmtheorem1.p1.14.m5.1" class="ltx_Math" alttext="-\frac{1}{C-1}" display="inline"><semantics id="S3.Thmtheorem1.p1.14.m5.1a"><mrow id="S3.Thmtheorem1.p1.14.m5.1.1" xref="S3.Thmtheorem1.p1.14.m5.1.1.cmml"><mo id="S3.Thmtheorem1.p1.14.m5.1.1a" xref="S3.Thmtheorem1.p1.14.m5.1.1.cmml">−</mo><mfrac id="S3.Thmtheorem1.p1.14.m5.1.1.2" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.cmml"><mn id="S3.Thmtheorem1.p1.14.m5.1.1.2.2" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.2.cmml">1</mn><mrow id="S3.Thmtheorem1.p1.14.m5.1.1.2.3" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.3.cmml"><mi id="S3.Thmtheorem1.p1.14.m5.1.1.2.3.2" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.3.2.cmml">C</mi><mo id="S3.Thmtheorem1.p1.14.m5.1.1.2.3.1" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.3.1.cmml">−</mo><mn id="S3.Thmtheorem1.p1.14.m5.1.1.2.3.3" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.14.m5.1b"><apply id="S3.Thmtheorem1.p1.14.m5.1.1.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1"><minus id="S3.Thmtheorem1.p1.14.m5.1.1.1.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1"></minus><apply id="S3.Thmtheorem1.p1.14.m5.1.1.2.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1.2"><divide id="S3.Thmtheorem1.p1.14.m5.1.1.2.1.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1.2"></divide><cn type="integer" id="S3.Thmtheorem1.p1.14.m5.1.1.2.2.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.2">1</cn><apply id="S3.Thmtheorem1.p1.14.m5.1.1.2.3.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.3"><minus id="S3.Thmtheorem1.p1.14.m5.1.1.2.3.1.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.3.1"></minus><ci id="S3.Thmtheorem1.p1.14.m5.1.1.2.3.2.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.3.2">𝐶</ci><cn type="integer" id="S3.Thmtheorem1.p1.14.m5.1.1.2.3.3.cmml" xref="S3.Thmtheorem1.p1.14.m5.1.1.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.14.m5.1c">-\frac{1}{C-1}</annotation></semantics></math> is the maximal equiangular separation of <math id="S3.Thmtheorem1.p1.15.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.Thmtheorem1.p1.15.m6.1a"><mi id="S3.Thmtheorem1.p1.15.m6.1.1" xref="S3.Thmtheorem1.p1.15.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.15.m6.1b"><ci id="S3.Thmtheorem1.p1.15.m6.1.1.cmml" xref="S3.Thmtheorem1.p1.15.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.15.m6.1c">C</annotation></semantics></math> vectors in <math id="S3.Thmtheorem1.p1.16.m7.1" class="ltx_Math" alttext="\mathbb{R}^{d}" display="inline"><semantics id="S3.Thmtheorem1.p1.16.m7.1a"><msup id="S3.Thmtheorem1.p1.16.m7.1.1" xref="S3.Thmtheorem1.p1.16.m7.1.1.cmml"><mi id="S3.Thmtheorem1.p1.16.m7.1.1.2" xref="S3.Thmtheorem1.p1.16.m7.1.1.2.cmml">ℝ</mi><mi id="S3.Thmtheorem1.p1.16.m7.1.1.3" xref="S3.Thmtheorem1.p1.16.m7.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S3.Thmtheorem1.p1.16.m7.1b"><apply id="S3.Thmtheorem1.p1.16.m7.1.1.cmml" xref="S3.Thmtheorem1.p1.16.m7.1.1"><csymbol cd="ambiguous" id="S3.Thmtheorem1.p1.16.m7.1.1.1.cmml" xref="S3.Thmtheorem1.p1.16.m7.1.1">superscript</csymbol><ci id="S3.Thmtheorem1.p1.16.m7.1.1.2.cmml" xref="S3.Thmtheorem1.p1.16.m7.1.1.2">ℝ</ci><ci id="S3.Thmtheorem1.p1.16.m7.1.1.3.cmml" xref="S3.Thmtheorem1.p1.16.m7.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Thmtheorem1.p1.16.m7.1c">\mathbb{R}^{d}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>.</p>
</div>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">We highlight three key properties of the neural collapse (NC) phenomenon below.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.8" class="ltx_p"><span id="S3.SS2.p3.8.1" class="ltx_text ltx_font_bold">NC1</span> (Features collapse to the class prototypes).
The last-layer features will collapse to their within-class mean (prototypes), i.e. for any class <math id="S3.SS2.p3.1.m1.3" class="ltx_Math" alttext="c,~{}\forall c\in[C]" display="inline"><semantics id="S3.SS2.p3.1.m1.3a"><mrow id="S3.SS2.p3.1.m1.3.3" xref="S3.SS2.p3.1.m1.3.3.cmml"><mrow id="S3.SS2.p3.1.m1.3.3.1.1" xref="S3.SS2.p3.1.m1.3.3.1.2.cmml"><mi id="S3.SS2.p3.1.m1.2.2" xref="S3.SS2.p3.1.m1.2.2.cmml">c</mi><mo rspace="0.497em" id="S3.SS2.p3.1.m1.3.3.1.1.2" xref="S3.SS2.p3.1.m1.3.3.1.2.cmml">,</mo><mrow id="S3.SS2.p3.1.m1.3.3.1.1.1" xref="S3.SS2.p3.1.m1.3.3.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS2.p3.1.m1.3.3.1.1.1.1" xref="S3.SS2.p3.1.m1.3.3.1.1.1.1.cmml">∀</mo><mi id="S3.SS2.p3.1.m1.3.3.1.1.1.2" xref="S3.SS2.p3.1.m1.3.3.1.1.1.2.cmml">c</mi></mrow></mrow><mo id="S3.SS2.p3.1.m1.3.3.2" xref="S3.SS2.p3.1.m1.3.3.2.cmml">∈</mo><mrow id="S3.SS2.p3.1.m1.3.3.3.2" xref="S3.SS2.p3.1.m1.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p3.1.m1.3.3.3.2.1" xref="S3.SS2.p3.1.m1.3.3.3.1.1.cmml">[</mo><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">C</mi><mo stretchy="false" id="S3.SS2.p3.1.m1.3.3.3.2.2" xref="S3.SS2.p3.1.m1.3.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.3b"><apply id="S3.SS2.p3.1.m1.3.3.cmml" xref="S3.SS2.p3.1.m1.3.3"><in id="S3.SS2.p3.1.m1.3.3.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2"></in><list id="S3.SS2.p3.1.m1.3.3.1.2.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1"><ci id="S3.SS2.p3.1.m1.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2">𝑐</ci><apply id="S3.SS2.p3.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S3.SS2.p3.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1.1.1">for-all</csymbol><ci id="S3.SS2.p3.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.3.3.1.1.1.2">𝑐</ci></apply></list><apply id="S3.SS2.p3.1.m1.3.3.3.1.cmml" xref="S3.SS2.p3.1.m1.3.3.3.2"><csymbol cd="latexml" id="S3.SS2.p3.1.m1.3.3.3.1.1.cmml" xref="S3.SS2.p3.1.m1.3.3.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.3c">c,~{}\forall c\in[C]</annotation></semantics></math>, the covariance <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="\Sigma_{W}^{c}\rightarrow\mathbf{0}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><msubsup id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS2.p3.2.m2.1.1.2.2.2" xref="S3.SS2.p3.2.m2.1.1.2.2.2.cmml">Σ</mi><mi id="S3.SS2.p3.2.m2.1.1.2.2.3" xref="S3.SS2.p3.2.m2.1.1.2.2.3.cmml">W</mi><mi id="S3.SS2.p3.2.m2.1.1.2.3" xref="S3.SS2.p3.2.m2.1.1.2.3.cmml">c</mi></msubsup><mo stretchy="false" id="S3.SS2.p3.2.m2.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.cmml">→</mo><mn id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><ci id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1">→</ci><apply id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1.2">superscript</csymbol><apply id="S3.SS2.p3.2.m2.1.1.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.2.2.1.cmml" xref="S3.SS2.p3.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.2.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2.2.2">Σ</ci><ci id="S3.SS2.p3.2.m2.1.1.2.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.2.2.3">𝑊</ci></apply><ci id="S3.SS2.p3.2.m2.1.1.2.3.cmml" xref="S3.SS2.p3.2.m2.1.1.2.3">𝑐</ci></apply><cn type="integer" id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">\Sigma_{W}^{c}\rightarrow\mathbf{0}</annotation></semantics></math>, where <math id="S3.SS2.p3.3.m3.6" class="ltx_Math" alttext="\Sigma_{W}^{c}:=\frac{1}{n_{c}}\sum_{i=1}^{n_{c}}(\mathbf{h}_{c,i}-\mathbf{h}_{c})(\mathbf{h}_{c,i}-\mathbf{h}_{c})^{T}" display="inline"><semantics id="S3.SS2.p3.3.m3.6a"><mrow id="S3.SS2.p3.3.m3.6.6" xref="S3.SS2.p3.3.m3.6.6.cmml"><msubsup id="S3.SS2.p3.3.m3.6.6.4" xref="S3.SS2.p3.3.m3.6.6.4.cmml"><mi mathvariant="normal" id="S3.SS2.p3.3.m3.6.6.4.2.2" xref="S3.SS2.p3.3.m3.6.6.4.2.2.cmml">Σ</mi><mi id="S3.SS2.p3.3.m3.6.6.4.2.3" xref="S3.SS2.p3.3.m3.6.6.4.2.3.cmml">W</mi><mi id="S3.SS2.p3.3.m3.6.6.4.3" xref="S3.SS2.p3.3.m3.6.6.4.3.cmml">c</mi></msubsup><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p3.3.m3.6.6.3" xref="S3.SS2.p3.3.m3.6.6.3.cmml">:=</mo><mrow id="S3.SS2.p3.3.m3.6.6.2" xref="S3.SS2.p3.3.m3.6.6.2.cmml"><mfrac id="S3.SS2.p3.3.m3.6.6.2.4" xref="S3.SS2.p3.3.m3.6.6.2.4.cmml"><mn id="S3.SS2.p3.3.m3.6.6.2.4.2" xref="S3.SS2.p3.3.m3.6.6.2.4.2.cmml">1</mn><msub id="S3.SS2.p3.3.m3.6.6.2.4.3" xref="S3.SS2.p3.3.m3.6.6.2.4.3.cmml"><mi id="S3.SS2.p3.3.m3.6.6.2.4.3.2" xref="S3.SS2.p3.3.m3.6.6.2.4.3.2.cmml">n</mi><mi id="S3.SS2.p3.3.m3.6.6.2.4.3.3" xref="S3.SS2.p3.3.m3.6.6.2.4.3.3.cmml">c</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.SS2.p3.3.m3.6.6.2.3" xref="S3.SS2.p3.3.m3.6.6.2.3.cmml">​</mo><mrow id="S3.SS2.p3.3.m3.6.6.2.2" xref="S3.SS2.p3.3.m3.6.6.2.2.cmml"><msubsup id="S3.SS2.p3.3.m3.6.6.2.2.3" xref="S3.SS2.p3.3.m3.6.6.2.2.3.cmml"><mo rspace="0em" id="S3.SS2.p3.3.m3.6.6.2.2.3.2.2" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.2.cmml">∑</mo><mrow id="S3.SS2.p3.3.m3.6.6.2.2.3.2.3" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.cmml"><mi id="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.2" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.2.cmml">i</mi><mo id="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.1" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.3" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S3.SS2.p3.3.m3.6.6.2.2.3.3" xref="S3.SS2.p3.3.m3.6.6.2.2.3.3.cmml"><mi id="S3.SS2.p3.3.m3.6.6.2.2.3.3.2" xref="S3.SS2.p3.3.m3.6.6.2.2.3.3.2.cmml">n</mi><mi id="S3.SS2.p3.3.m3.6.6.2.2.3.3.3" xref="S3.SS2.p3.3.m3.6.6.2.2.3.3.3.cmml">c</mi></msub></msubsup><mrow id="S3.SS2.p3.3.m3.6.6.2.2.2" xref="S3.SS2.p3.3.m3.6.6.2.2.2.cmml"><mrow id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.2" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2.2" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mrow id="S3.SS2.p3.3.m3.2.2.2.4" xref="S3.SS2.p3.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.p3.3.m3.1.1.1.1" xref="S3.SS2.p3.3.m3.1.1.1.1.cmml">c</mi><mo id="S3.SS2.p3.3.m3.2.2.2.4.1" xref="S3.SS2.p3.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.3.m3.2.2.2.2" xref="S3.SS2.p3.3.m3.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.1" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.2" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.2.cmml">𝐡</mi><mi id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.3" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.3" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.p3.3.m3.6.6.2.2.2.3" xref="S3.SS2.p3.3.m3.6.6.2.2.2.3.cmml">​</mo><msup id="S3.SS2.p3.3.m3.6.6.2.2.2.2" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.cmml"><mrow id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.2" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.cmml"><msub id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2.cmml"><mi id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2.2" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2.2.cmml">𝐡</mi><mrow id="S3.SS2.p3.3.m3.4.4.2.4" xref="S3.SS2.p3.3.m3.4.4.2.3.cmml"><mi id="S3.SS2.p3.3.m3.3.3.1.1" xref="S3.SS2.p3.3.m3.3.3.1.1.cmml">c</mi><mo id="S3.SS2.p3.3.m3.4.4.2.4.1" xref="S3.SS2.p3.3.m3.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p3.3.m3.4.4.2.2" xref="S3.SS2.p3.3.m3.4.4.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.1" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.1.cmml">−</mo><msub id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.2" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.2.cmml">𝐡</mi><mi id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.3" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.3.cmml">c</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.3" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.SS2.p3.3.m3.6.6.2.2.2.2.3" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.3.cmml">T</mi></msup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.6b"><apply id="S3.SS2.p3.3.m3.6.6.cmml" xref="S3.SS2.p3.3.m3.6.6"><csymbol cd="latexml" id="S3.SS2.p3.3.m3.6.6.3.cmml" xref="S3.SS2.p3.3.m3.6.6.3">assign</csymbol><apply id="S3.SS2.p3.3.m3.6.6.4.cmml" xref="S3.SS2.p3.3.m3.6.6.4"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.4.1.cmml" xref="S3.SS2.p3.3.m3.6.6.4">superscript</csymbol><apply id="S3.SS2.p3.3.m3.6.6.4.2.cmml" xref="S3.SS2.p3.3.m3.6.6.4"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.4.2.1.cmml" xref="S3.SS2.p3.3.m3.6.6.4">subscript</csymbol><ci id="S3.SS2.p3.3.m3.6.6.4.2.2.cmml" xref="S3.SS2.p3.3.m3.6.6.4.2.2">Σ</ci><ci id="S3.SS2.p3.3.m3.6.6.4.2.3.cmml" xref="S3.SS2.p3.3.m3.6.6.4.2.3">𝑊</ci></apply><ci id="S3.SS2.p3.3.m3.6.6.4.3.cmml" xref="S3.SS2.p3.3.m3.6.6.4.3">𝑐</ci></apply><apply id="S3.SS2.p3.3.m3.6.6.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2"><times id="S3.SS2.p3.3.m3.6.6.2.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.3"></times><apply id="S3.SS2.p3.3.m3.6.6.2.4.cmml" xref="S3.SS2.p3.3.m3.6.6.2.4"><divide id="S3.SS2.p3.3.m3.6.6.2.4.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.4"></divide><cn type="integer" id="S3.SS2.p3.3.m3.6.6.2.4.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.4.2">1</cn><apply id="S3.SS2.p3.3.m3.6.6.2.4.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.4.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.2.4.3.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.4.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.6.6.2.4.3.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.4.3.2">𝑛</ci><ci id="S3.SS2.p3.3.m3.6.6.2.4.3.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.4.3.3">𝑐</ci></apply></apply><apply id="S3.SS2.p3.3.m3.6.6.2.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2"><apply id="S3.SS2.p3.3.m3.6.6.2.2.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.2.2.3.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3">superscript</csymbol><apply id="S3.SS2.p3.3.m3.6.6.2.2.3.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.2.2.3.2.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3">subscript</csymbol><sum id="S3.SS2.p3.3.m3.6.6.2.2.3.2.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.2"></sum><apply id="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.3"><eq id="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.1"></eq><ci id="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p3.3.m3.6.6.2.2.3.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.2.2.3.3.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.6.6.2.2.3.3.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.3.2">𝑛</ci><ci id="S3.SS2.p3.3.m3.6.6.2.2.3.3.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.3.3.3">𝑐</ci></apply></apply><apply id="S3.SS2.p3.3.m3.6.6.2.2.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2"><times id="S3.SS2.p3.3.m3.6.6.2.2.2.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.3"></times><apply id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1"><minus id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.1"></minus><apply id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.2.2">𝐡</ci><list id="S3.SS2.p3.3.m3.2.2.2.3.cmml" xref="S3.SS2.p3.3.m3.2.2.2.4"><ci id="S3.SS2.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1.1.1">𝑐</ci><ci id="S3.SS2.p3.3.m3.2.2.2.2.cmml" xref="S3.SS2.p3.3.m3.2.2.2.2">𝑖</ci></list></apply><apply id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.2">𝐡</ci><ci id="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.3.m3.5.5.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply><apply id="S3.SS2.p3.3.m3.6.6.2.2.2.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.2.2.2.2.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2">superscript</csymbol><apply id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1"><minus id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.1"></minus><apply id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.2.2">𝐡</ci><list id="S3.SS2.p3.3.m3.4.4.2.3.cmml" xref="S3.SS2.p3.3.m3.4.4.2.4"><ci id="S3.SS2.p3.3.m3.3.3.1.1.cmml" xref="S3.SS2.p3.3.m3.3.3.1.1">𝑐</ci><ci id="S3.SS2.p3.3.m3.4.4.2.2.cmml" xref="S3.SS2.p3.3.m3.4.4.2.2">𝑖</ci></list></apply><apply id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.2">𝐡</ci><ci id="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.1.1.1.3.3">𝑐</ci></apply></apply><ci id="S3.SS2.p3.3.m3.6.6.2.2.2.2.3.cmml" xref="S3.SS2.p3.3.m3.6.6.2.2.2.2.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.6c">\Sigma_{W}^{c}:=\frac{1}{n_{c}}\sum_{i=1}^{n_{c}}(\mathbf{h}_{c,i}-\mathbf{h}_{c})(\mathbf{h}_{c,i}-\mathbf{h}_{c})^{T}</annotation></semantics></math>. <math id="S3.SS2.p3.4.m4.6" class="ltx_Math" alttext="\mathbf{h}_{c,i}=f(\mathbf{u};\mathbf{x}_{c,i})" display="inline"><semantics id="S3.SS2.p3.4.m4.6a"><mrow id="S3.SS2.p3.4.m4.6.6" xref="S3.SS2.p3.4.m4.6.6.cmml"><msub id="S3.SS2.p3.4.m4.6.6.3" xref="S3.SS2.p3.4.m4.6.6.3.cmml"><mi id="S3.SS2.p3.4.m4.6.6.3.2" xref="S3.SS2.p3.4.m4.6.6.3.2.cmml">𝐡</mi><mrow id="S3.SS2.p3.4.m4.2.2.2.4" xref="S3.SS2.p3.4.m4.2.2.2.3.cmml"><mi id="S3.SS2.p3.4.m4.1.1.1.1" xref="S3.SS2.p3.4.m4.1.1.1.1.cmml">c</mi><mo id="S3.SS2.p3.4.m4.2.2.2.4.1" xref="S3.SS2.p3.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.4.m4.2.2.2.2" xref="S3.SS2.p3.4.m4.2.2.2.2.cmml">i</mi></mrow></msub><mo id="S3.SS2.p3.4.m4.6.6.2" xref="S3.SS2.p3.4.m4.6.6.2.cmml">=</mo><mrow id="S3.SS2.p3.4.m4.6.6.1" xref="S3.SS2.p3.4.m4.6.6.1.cmml"><mi id="S3.SS2.p3.4.m4.6.6.1.3" xref="S3.SS2.p3.4.m4.6.6.1.3.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.4.m4.6.6.1.2" xref="S3.SS2.p3.4.m4.6.6.1.2.cmml">​</mo><mrow id="S3.SS2.p3.4.m4.6.6.1.1.1" xref="S3.SS2.p3.4.m4.6.6.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.4.m4.6.6.1.1.1.2" xref="S3.SS2.p3.4.m4.6.6.1.1.2.cmml">(</mo><mi id="S3.SS2.p3.4.m4.5.5" xref="S3.SS2.p3.4.m4.5.5.cmml">𝐮</mi><mo id="S3.SS2.p3.4.m4.6.6.1.1.1.3" xref="S3.SS2.p3.4.m4.6.6.1.1.2.cmml">;</mo><msub id="S3.SS2.p3.4.m4.6.6.1.1.1.1" xref="S3.SS2.p3.4.m4.6.6.1.1.1.1.cmml"><mi id="S3.SS2.p3.4.m4.6.6.1.1.1.1.2" xref="S3.SS2.p3.4.m4.6.6.1.1.1.1.2.cmml">𝐱</mi><mrow id="S3.SS2.p3.4.m4.4.4.2.4" xref="S3.SS2.p3.4.m4.4.4.2.3.cmml"><mi id="S3.SS2.p3.4.m4.3.3.1.1" xref="S3.SS2.p3.4.m4.3.3.1.1.cmml">c</mi><mo id="S3.SS2.p3.4.m4.4.4.2.4.1" xref="S3.SS2.p3.4.m4.4.4.2.3.cmml">,</mo><mi id="S3.SS2.p3.4.m4.4.4.2.2" xref="S3.SS2.p3.4.m4.4.4.2.2.cmml">i</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p3.4.m4.6.6.1.1.1.4" xref="S3.SS2.p3.4.m4.6.6.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.6b"><apply id="S3.SS2.p3.4.m4.6.6.cmml" xref="S3.SS2.p3.4.m4.6.6"><eq id="S3.SS2.p3.4.m4.6.6.2.cmml" xref="S3.SS2.p3.4.m4.6.6.2"></eq><apply id="S3.SS2.p3.4.m4.6.6.3.cmml" xref="S3.SS2.p3.4.m4.6.6.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.6.6.3.1.cmml" xref="S3.SS2.p3.4.m4.6.6.3">subscript</csymbol><ci id="S3.SS2.p3.4.m4.6.6.3.2.cmml" xref="S3.SS2.p3.4.m4.6.6.3.2">𝐡</ci><list id="S3.SS2.p3.4.m4.2.2.2.3.cmml" xref="S3.SS2.p3.4.m4.2.2.2.4"><ci id="S3.SS2.p3.4.m4.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1.1.1">𝑐</ci><ci id="S3.SS2.p3.4.m4.2.2.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2.2.2">𝑖</ci></list></apply><apply id="S3.SS2.p3.4.m4.6.6.1.cmml" xref="S3.SS2.p3.4.m4.6.6.1"><times id="S3.SS2.p3.4.m4.6.6.1.2.cmml" xref="S3.SS2.p3.4.m4.6.6.1.2"></times><ci id="S3.SS2.p3.4.m4.6.6.1.3.cmml" xref="S3.SS2.p3.4.m4.6.6.1.3">𝑓</ci><list id="S3.SS2.p3.4.m4.6.6.1.1.2.cmml" xref="S3.SS2.p3.4.m4.6.6.1.1.1"><ci id="S3.SS2.p3.4.m4.5.5.cmml" xref="S3.SS2.p3.4.m4.5.5">𝐮</ci><apply id="S3.SS2.p3.4.m4.6.6.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.6.6.1.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.6.6.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.4.m4.6.6.1.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.6.6.1.1.1.1.2">𝐱</ci><list id="S3.SS2.p3.4.m4.4.4.2.3.cmml" xref="S3.SS2.p3.4.m4.4.4.2.4"><ci id="S3.SS2.p3.4.m4.3.3.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1">𝑐</ci><ci id="S3.SS2.p3.4.m4.4.4.2.2.cmml" xref="S3.SS2.p3.4.m4.4.4.2.2">𝑖</ci></list></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.6c">\mathbf{h}_{c,i}=f(\mathbf{u};\mathbf{x}_{c,i})</annotation></semantics></math> is the feature of the <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">i</annotation></semantics></math>-th sample in the class <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">c</annotation></semantics></math>, and <math id="S3.SS2.p3.7.m7.2" class="ltx_Math" alttext="\mathbf{h}_{c}=\frac{1}{n_{c}}\sum_{i=1}^{n_{c}}\mathbf{h}_{c,i}" display="inline"><semantics id="S3.SS2.p3.7.m7.2a"><mrow id="S3.SS2.p3.7.m7.2.3" xref="S3.SS2.p3.7.m7.2.3.cmml"><msub id="S3.SS2.p3.7.m7.2.3.2" xref="S3.SS2.p3.7.m7.2.3.2.cmml"><mi id="S3.SS2.p3.7.m7.2.3.2.2" xref="S3.SS2.p3.7.m7.2.3.2.2.cmml">𝐡</mi><mi id="S3.SS2.p3.7.m7.2.3.2.3" xref="S3.SS2.p3.7.m7.2.3.2.3.cmml">c</mi></msub><mo id="S3.SS2.p3.7.m7.2.3.1" xref="S3.SS2.p3.7.m7.2.3.1.cmml">=</mo><mrow id="S3.SS2.p3.7.m7.2.3.3" xref="S3.SS2.p3.7.m7.2.3.3.cmml"><mfrac id="S3.SS2.p3.7.m7.2.3.3.2" xref="S3.SS2.p3.7.m7.2.3.3.2.cmml"><mn id="S3.SS2.p3.7.m7.2.3.3.2.2" xref="S3.SS2.p3.7.m7.2.3.3.2.2.cmml">1</mn><msub id="S3.SS2.p3.7.m7.2.3.3.2.3" xref="S3.SS2.p3.7.m7.2.3.3.2.3.cmml"><mi id="S3.SS2.p3.7.m7.2.3.3.2.3.2" xref="S3.SS2.p3.7.m7.2.3.3.2.3.2.cmml">n</mi><mi id="S3.SS2.p3.7.m7.2.3.3.2.3.3" xref="S3.SS2.p3.7.m7.2.3.3.2.3.3.cmml">c</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.SS2.p3.7.m7.2.3.3.1" xref="S3.SS2.p3.7.m7.2.3.3.1.cmml">​</mo><mrow id="S3.SS2.p3.7.m7.2.3.3.3" xref="S3.SS2.p3.7.m7.2.3.3.3.cmml"><msubsup id="S3.SS2.p3.7.m7.2.3.3.3.1" xref="S3.SS2.p3.7.m7.2.3.3.3.1.cmml"><mo id="S3.SS2.p3.7.m7.2.3.3.3.1.2.2" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p3.7.m7.2.3.3.3.1.2.3" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.cmml"><mi id="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.2" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.1" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.3" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S3.SS2.p3.7.m7.2.3.3.3.1.3" xref="S3.SS2.p3.7.m7.2.3.3.3.1.3.cmml"><mi id="S3.SS2.p3.7.m7.2.3.3.3.1.3.2" xref="S3.SS2.p3.7.m7.2.3.3.3.1.3.2.cmml">n</mi><mi id="S3.SS2.p3.7.m7.2.3.3.3.1.3.3" xref="S3.SS2.p3.7.m7.2.3.3.3.1.3.3.cmml">c</mi></msub></msubsup><msub id="S3.SS2.p3.7.m7.2.3.3.3.2" xref="S3.SS2.p3.7.m7.2.3.3.3.2.cmml"><mi id="S3.SS2.p3.7.m7.2.3.3.3.2.2" xref="S3.SS2.p3.7.m7.2.3.3.3.2.2.cmml">𝐡</mi><mrow id="S3.SS2.p3.7.m7.2.2.2.4" xref="S3.SS2.p3.7.m7.2.2.2.3.cmml"><mi id="S3.SS2.p3.7.m7.1.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.cmml">c</mi><mo id="S3.SS2.p3.7.m7.2.2.2.4.1" xref="S3.SS2.p3.7.m7.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p3.7.m7.2.2.2.2" xref="S3.SS2.p3.7.m7.2.2.2.2.cmml">i</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.2b"><apply id="S3.SS2.p3.7.m7.2.3.cmml" xref="S3.SS2.p3.7.m7.2.3"><eq id="S3.SS2.p3.7.m7.2.3.1.cmml" xref="S3.SS2.p3.7.m7.2.3.1"></eq><apply id="S3.SS2.p3.7.m7.2.3.2.cmml" xref="S3.SS2.p3.7.m7.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.2.3.2.1.cmml" xref="S3.SS2.p3.7.m7.2.3.2">subscript</csymbol><ci id="S3.SS2.p3.7.m7.2.3.2.2.cmml" xref="S3.SS2.p3.7.m7.2.3.2.2">𝐡</ci><ci id="S3.SS2.p3.7.m7.2.3.2.3.cmml" xref="S3.SS2.p3.7.m7.2.3.2.3">𝑐</ci></apply><apply id="S3.SS2.p3.7.m7.2.3.3.cmml" xref="S3.SS2.p3.7.m7.2.3.3"><times id="S3.SS2.p3.7.m7.2.3.3.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.1"></times><apply id="S3.SS2.p3.7.m7.2.3.3.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.2"><divide id="S3.SS2.p3.7.m7.2.3.3.2.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.2"></divide><cn type="integer" id="S3.SS2.p3.7.m7.2.3.3.2.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.2.2">1</cn><apply id="S3.SS2.p3.7.m7.2.3.3.2.3.cmml" xref="S3.SS2.p3.7.m7.2.3.3.2.3"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.2.3.3.2.3.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.2.3">subscript</csymbol><ci id="S3.SS2.p3.7.m7.2.3.3.2.3.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.2.3.2">𝑛</ci><ci id="S3.SS2.p3.7.m7.2.3.3.2.3.3.cmml" xref="S3.SS2.p3.7.m7.2.3.3.2.3.3">𝑐</ci></apply></apply><apply id="S3.SS2.p3.7.m7.2.3.3.3.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3"><apply id="S3.SS2.p3.7.m7.2.3.3.3.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.2.3.3.3.1.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1">superscript</csymbol><apply id="S3.SS2.p3.7.m7.2.3.3.3.1.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.2.3.3.3.1.2.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1">subscript</csymbol><sum id="S3.SS2.p3.7.m7.2.3.3.3.1.2.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.2"></sum><apply id="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.3"><eq id="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.1"></eq><ci id="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.3.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p3.7.m7.2.3.3.3.1.3.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.2.3.3.3.1.3.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.3">subscript</csymbol><ci id="S3.SS2.p3.7.m7.2.3.3.3.1.3.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.3.2">𝑛</ci><ci id="S3.SS2.p3.7.m7.2.3.3.3.1.3.3.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.1.3.3">𝑐</ci></apply></apply><apply id="S3.SS2.p3.7.m7.2.3.3.3.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.2.3.3.3.2.1.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.2">subscript</csymbol><ci id="S3.SS2.p3.7.m7.2.3.3.3.2.2.cmml" xref="S3.SS2.p3.7.m7.2.3.3.3.2.2">𝐡</ci><list id="S3.SS2.p3.7.m7.2.2.2.3.cmml" xref="S3.SS2.p3.7.m7.2.2.2.4"><ci id="S3.SS2.p3.7.m7.1.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1">𝑐</ci><ci id="S3.SS2.p3.7.m7.2.2.2.2.cmml" xref="S3.SS2.p3.7.m7.2.2.2.2">𝑖</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.2c">\mathbf{h}_{c}=\frac{1}{n_{c}}\sum_{i=1}^{n_{c}}\mathbf{h}_{c,i}</annotation></semantics></math> is the class <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">c</annotation></semantics></math>’s prototype.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para ltx_noindent">
<p id="S3.SS2.p4.3" class="ltx_p"><span id="S3.SS2.p4.3.1" class="ltx_text ltx_font_bold">NC2</span> (Prototypes collapse to simplex ETFs). <math id="S3.SS2.p4.1.m1.3" class="ltx_Math" alttext="\tilde{\mathbf{h}}_{c}=(\mathbf{h}_{c}-\mathbf{h}_{G})/||\mathbf{h}_{c}-\mathbf{h}_{G}||,\forall c\in[C]" display="inline"><semantics id="S3.SS2.p4.1.m1.3a"><mrow id="S3.SS2.p4.1.m1.3.3.2" xref="S3.SS2.p4.1.m1.3.3.3.cmml"><mrow id="S3.SS2.p4.1.m1.2.2.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.cmml"><msub id="S3.SS2.p4.1.m1.2.2.1.1.4" xref="S3.SS2.p4.1.m1.2.2.1.1.4.cmml"><mover accent="true" id="S3.SS2.p4.1.m1.2.2.1.1.4.2" xref="S3.SS2.p4.1.m1.2.2.1.1.4.2.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.4.2.2" xref="S3.SS2.p4.1.m1.2.2.1.1.4.2.2.cmml">𝐡</mi><mo id="S3.SS2.p4.1.m1.2.2.1.1.4.2.1" xref="S3.SS2.p4.1.m1.2.2.1.1.4.2.1.cmml">~</mo></mover><mi id="S3.SS2.p4.1.m1.2.2.1.1.4.3" xref="S3.SS2.p4.1.m1.2.2.1.1.4.3.cmml">c</mi></msub><mo id="S3.SS2.p4.1.m1.2.2.1.1.3" xref="S3.SS2.p4.1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.SS2.p4.1.m1.2.2.1.1.2" xref="S3.SS2.p4.1.m1.2.2.1.1.2.cmml"><mrow id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mi id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝐡</mi><mi id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">G</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.p4.1.m1.2.2.1.1.2.3" xref="S3.SS2.p4.1.m1.2.2.1.1.2.3.cmml">/</mo><mrow id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.2" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.2.1.cmml">‖</mo><mrow id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.cmml"><msub id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.2" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.2.cmml">𝐡</mi><mi id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.3" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.3.cmml">c</mi></msub><mo id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.1.cmml">−</mo><msub id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.2" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.2.cmml">𝐡</mi><mi id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.3" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.3.cmml">G</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.3" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="S3.SS2.p4.1.m1.3.3.2.3" xref="S3.SS2.p4.1.m1.3.3.3a.cmml">,</mo><mrow id="S3.SS2.p4.1.m1.3.3.2.2" xref="S3.SS2.p4.1.m1.3.3.2.2.cmml"><mrow id="S3.SS2.p4.1.m1.3.3.2.2.2" xref="S3.SS2.p4.1.m1.3.3.2.2.2.cmml"><mo rspace="0.167em" id="S3.SS2.p4.1.m1.3.3.2.2.2.1" xref="S3.SS2.p4.1.m1.3.3.2.2.2.1.cmml">∀</mo><mi id="S3.SS2.p4.1.m1.3.3.2.2.2.2" xref="S3.SS2.p4.1.m1.3.3.2.2.2.2.cmml">c</mi></mrow><mo id="S3.SS2.p4.1.m1.3.3.2.2.1" xref="S3.SS2.p4.1.m1.3.3.2.2.1.cmml">∈</mo><mrow id="S3.SS2.p4.1.m1.3.3.2.2.3.2" xref="S3.SS2.p4.1.m1.3.3.2.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p4.1.m1.3.3.2.2.3.2.1" xref="S3.SS2.p4.1.m1.3.3.2.2.3.1.1.cmml">[</mo><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">C</mi><mo stretchy="false" id="S3.SS2.p4.1.m1.3.3.2.2.3.2.2" xref="S3.SS2.p4.1.m1.3.3.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.3b"><apply id="S3.SS2.p4.1.m1.3.3.3.cmml" xref="S3.SS2.p4.1.m1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.3.3.3a.cmml" xref="S3.SS2.p4.1.m1.3.3.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p4.1.m1.2.2.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1"><eq id="S3.SS2.p4.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.3"></eq><apply id="S3.SS2.p4.1.m1.2.2.1.1.4.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.4.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4">subscript</csymbol><apply id="S3.SS2.p4.1.m1.2.2.1.1.4.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4.2"><ci id="S3.SS2.p4.1.m1.2.2.1.1.4.2.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4.2.1">~</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.4.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4.2.2">𝐡</ci></apply><ci id="S3.SS2.p4.1.m1.2.2.1.1.4.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.4.3">𝑐</ci></apply><apply id="S3.SS2.p4.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2"><divide id="S3.SS2.p4.1.m1.2.2.1.1.2.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.3"></divide><apply id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1"><minus id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.2">𝐡</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.2.3">𝑐</ci></apply><apply id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.2">𝐡</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.3.3">𝐺</ci></apply></apply><apply id="S3.SS2.p4.1.m1.2.2.1.1.2.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.2">norm</csymbol><apply id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1"><minus id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.1"></minus><apply id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.2">𝐡</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.2.3">𝑐</ci></apply><apply id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.2">𝐡</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2.2.1.1.3.3">𝐺</ci></apply></apply></apply></apply></apply><apply id="S3.SS2.p4.1.m1.3.3.2.2.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2"><in id="S3.SS2.p4.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.1"></in><apply id="S3.SS2.p4.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.2"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.2.1">for-all</csymbol><ci id="S3.SS2.p4.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.2.2">𝑐</ci></apply><apply id="S3.SS2.p4.1.m1.3.3.2.2.3.1.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.3.2"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.3.3.2.2.3.1.1.cmml" xref="S3.SS2.p4.1.m1.3.3.2.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.3c">\tilde{\mathbf{h}}_{c}=(\mathbf{h}_{c}-\mathbf{h}_{G})/||\mathbf{h}_{c}-\mathbf{h}_{G}||,\forall c\in[C]</annotation></semantics></math>, collapses to a simplex ETF which satisfies Eq. (<a href="#S3.E4" title="In Definition 3.1 (Simplex Equiangular Tight Frame). ‣ 3.2 Neural Collapse ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathbf{h}_{G}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">𝐡</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝐡</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\mathbf{h}_{G}</annotation></semantics></math> is the global mean of the last-layer features, that <math id="S3.SS2.p4.3.m3.2" class="ltx_Math" alttext="\mathbf{h}_{G}=\sum_{c=1}^{C}\sum_{i=1}^{n_{c}}\mathbf{h}_{c,i}" display="inline"><semantics id="S3.SS2.p4.3.m3.2a"><mrow id="S3.SS2.p4.3.m3.2.3" xref="S3.SS2.p4.3.m3.2.3.cmml"><msub id="S3.SS2.p4.3.m3.2.3.2" xref="S3.SS2.p4.3.m3.2.3.2.cmml"><mi id="S3.SS2.p4.3.m3.2.3.2.2" xref="S3.SS2.p4.3.m3.2.3.2.2.cmml">𝐡</mi><mi id="S3.SS2.p4.3.m3.2.3.2.3" xref="S3.SS2.p4.3.m3.2.3.2.3.cmml">G</mi></msub><mo rspace="0.111em" id="S3.SS2.p4.3.m3.2.3.1" xref="S3.SS2.p4.3.m3.2.3.1.cmml">=</mo><mrow id="S3.SS2.p4.3.m3.2.3.3" xref="S3.SS2.p4.3.m3.2.3.3.cmml"><msubsup id="S3.SS2.p4.3.m3.2.3.3.1" xref="S3.SS2.p4.3.m3.2.3.3.1.cmml"><mo rspace="0em" id="S3.SS2.p4.3.m3.2.3.3.1.2.2" xref="S3.SS2.p4.3.m3.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p4.3.m3.2.3.3.1.2.3" xref="S3.SS2.p4.3.m3.2.3.3.1.2.3.cmml"><mi id="S3.SS2.p4.3.m3.2.3.3.1.2.3.2" xref="S3.SS2.p4.3.m3.2.3.3.1.2.3.2.cmml">c</mi><mo id="S3.SS2.p4.3.m3.2.3.3.1.2.3.1" xref="S3.SS2.p4.3.m3.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p4.3.m3.2.3.3.1.2.3.3" xref="S3.SS2.p4.3.m3.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p4.3.m3.2.3.3.1.3" xref="S3.SS2.p4.3.m3.2.3.3.1.3.cmml">C</mi></msubsup><mrow id="S3.SS2.p4.3.m3.2.3.3.2" xref="S3.SS2.p4.3.m3.2.3.3.2.cmml"><msubsup id="S3.SS2.p4.3.m3.2.3.3.2.1" xref="S3.SS2.p4.3.m3.2.3.3.2.1.cmml"><mo id="S3.SS2.p4.3.m3.2.3.3.2.1.2.2" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p4.3.m3.2.3.3.2.1.2.3" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.cmml"><mi id="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.2" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.2.cmml">i</mi><mo id="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.1" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.3" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.3.cmml">1</mn></mrow><msub id="S3.SS2.p4.3.m3.2.3.3.2.1.3" xref="S3.SS2.p4.3.m3.2.3.3.2.1.3.cmml"><mi id="S3.SS2.p4.3.m3.2.3.3.2.1.3.2" xref="S3.SS2.p4.3.m3.2.3.3.2.1.3.2.cmml">n</mi><mi id="S3.SS2.p4.3.m3.2.3.3.2.1.3.3" xref="S3.SS2.p4.3.m3.2.3.3.2.1.3.3.cmml">c</mi></msub></msubsup><msub id="S3.SS2.p4.3.m3.2.3.3.2.2" xref="S3.SS2.p4.3.m3.2.3.3.2.2.cmml"><mi id="S3.SS2.p4.3.m3.2.3.3.2.2.2" xref="S3.SS2.p4.3.m3.2.3.3.2.2.2.cmml">𝐡</mi><mrow id="S3.SS2.p4.3.m3.2.2.2.4" xref="S3.SS2.p4.3.m3.2.2.2.3.cmml"><mi id="S3.SS2.p4.3.m3.1.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.1.cmml">c</mi><mo id="S3.SS2.p4.3.m3.2.2.2.4.1" xref="S3.SS2.p4.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS2.p4.3.m3.2.2.2.2" xref="S3.SS2.p4.3.m3.2.2.2.2.cmml">i</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.2b"><apply id="S3.SS2.p4.3.m3.2.3.cmml" xref="S3.SS2.p4.3.m3.2.3"><eq id="S3.SS2.p4.3.m3.2.3.1.cmml" xref="S3.SS2.p4.3.m3.2.3.1"></eq><apply id="S3.SS2.p4.3.m3.2.3.2.cmml" xref="S3.SS2.p4.3.m3.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.3.2.1.cmml" xref="S3.SS2.p4.3.m3.2.3.2">subscript</csymbol><ci id="S3.SS2.p4.3.m3.2.3.2.2.cmml" xref="S3.SS2.p4.3.m3.2.3.2.2">𝐡</ci><ci id="S3.SS2.p4.3.m3.2.3.2.3.cmml" xref="S3.SS2.p4.3.m3.2.3.2.3">𝐺</ci></apply><apply id="S3.SS2.p4.3.m3.2.3.3.cmml" xref="S3.SS2.p4.3.m3.2.3.3"><apply id="S3.SS2.p4.3.m3.2.3.3.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.3.3.1.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1">superscript</csymbol><apply id="S3.SS2.p4.3.m3.2.3.3.1.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.3.3.1.2.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1">subscript</csymbol><sum id="S3.SS2.p4.3.m3.2.3.3.1.2.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1.2.2"></sum><apply id="S3.SS2.p4.3.m3.2.3.3.1.2.3.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1.2.3"><eq id="S3.SS2.p4.3.m3.2.3.3.1.2.3.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1.2.3.1"></eq><ci id="S3.SS2.p4.3.m3.2.3.3.1.2.3.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1.2.3.2">𝑐</ci><cn type="integer" id="S3.SS2.p4.3.m3.2.3.3.1.2.3.3.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p4.3.m3.2.3.3.1.3.cmml" xref="S3.SS2.p4.3.m3.2.3.3.1.3">𝐶</ci></apply><apply id="S3.SS2.p4.3.m3.2.3.3.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2"><apply id="S3.SS2.p4.3.m3.2.3.3.2.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.3.3.2.1.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1">superscript</csymbol><apply id="S3.SS2.p4.3.m3.2.3.3.2.1.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.3.3.2.1.2.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1">subscript</csymbol><sum id="S3.SS2.p4.3.m3.2.3.3.2.1.2.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.2"></sum><apply id="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.3"><eq id="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.1"></eq><ci id="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.3.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.2.3.3">1</cn></apply></apply><apply id="S3.SS2.p4.3.m3.2.3.3.2.1.3.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.3.3.2.1.3.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.3">subscript</csymbol><ci id="S3.SS2.p4.3.m3.2.3.3.2.1.3.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.3.2">𝑛</ci><ci id="S3.SS2.p4.3.m3.2.3.3.2.1.3.3.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.1.3.3">𝑐</ci></apply></apply><apply id="S3.SS2.p4.3.m3.2.3.3.2.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.2.3.3.2.2.1.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p4.3.m3.2.3.3.2.2.2.cmml" xref="S3.SS2.p4.3.m3.2.3.3.2.2.2">𝐡</ci><list id="S3.SS2.p4.3.m3.2.2.2.3.cmml" xref="S3.SS2.p4.3.m3.2.2.2.4"><ci id="S3.SS2.p4.3.m3.1.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1.1">𝑐</ci><ci id="S3.SS2.p4.3.m3.2.2.2.2.cmml" xref="S3.SS2.p4.3.m3.2.2.2.2">𝑖</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.2c">\mathbf{h}_{G}=\sum_{c=1}^{C}\sum_{i=1}^{n_{c}}\mathbf{h}_{c,i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para ltx_noindent">
<p id="S3.SS2.p5.4" class="ltx_p"><span id="S3.SS2.p5.4.1" class="ltx_text ltx_font_bold">NC3</span> (Classifiers collapse to the same simplex ETFs). The normalized feature prototype <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="\tilde{\mathbf{h}}_{c}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mover accent="true" id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2.2" xref="S3.SS2.p5.1.m1.1.1.2.2.cmml">𝐡</mi><mo id="S3.SS2.p5.1.m1.1.1.2.1" xref="S3.SS2.p5.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2"><ci id="S3.SS2.p5.1.m1.1.1.2.1.cmml" xref="S3.SS2.p5.1.m1.1.1.2.1">~</ci><ci id="S3.SS2.p5.1.m1.1.1.2.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2.2">𝐡</ci></apply><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\tilde{\mathbf{h}}_{c}</annotation></semantics></math> is aligned with their corresponding classifier weights<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>For simplicity, we omit the bias term in a linear classifier layer.</span></span></span>, which means that the classifier weights collapse to the same simplex ETF, i.e. <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="\tilde{\mathbf{h}}_{c}=\mathbf{v}_{c}/||\mathbf{v}_{c}||" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mrow id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><msub id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml"><mover accent="true" id="S3.SS2.p5.2.m2.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.3.2.cmml"><mi id="S3.SS2.p5.2.m2.1.1.3.2.2" xref="S3.SS2.p5.2.m2.1.1.3.2.2.cmml">𝐡</mi><mo id="S3.SS2.p5.2.m2.1.1.3.2.1" xref="S3.SS2.p5.2.m2.1.1.3.2.1.cmml">~</mo></mover><mi id="S3.SS2.p5.2.m2.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.3.3.cmml">c</mi></msub><mo id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">=</mo><mrow id="S3.SS2.p5.2.m2.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.cmml"><msub id="S3.SS2.p5.2.m2.1.1.1.3" xref="S3.SS2.p5.2.m2.1.1.1.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.1.3.2" xref="S3.SS2.p5.2.m2.1.1.1.3.2.cmml">𝐯</mi><mi id="S3.SS2.p5.2.m2.1.1.1.3.3" xref="S3.SS2.p5.2.m2.1.1.1.3.3.cmml">c</mi></msub><mo id="S3.SS2.p5.2.m2.1.1.1.2" xref="S3.SS2.p5.2.m2.1.1.1.2.cmml">/</mo><mrow id="S3.SS2.p5.2.m2.1.1.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p5.2.m2.1.1.1.1.1.2" xref="S3.SS2.p5.2.m2.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.SS2.p5.2.m2.1.1.1.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S3.SS2.p5.2.m2.1.1.1.1.1.3" xref="S3.SS2.p5.2.m2.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><eq id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2"></eq><apply id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3">subscript</csymbol><apply id="S3.SS2.p5.2.m2.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2"><ci id="S3.SS2.p5.2.m2.1.1.3.2.1.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2.1">~</ci><ci id="S3.SS2.p5.2.m2.1.1.3.2.2.cmml" xref="S3.SS2.p5.2.m2.1.1.3.2.2">𝐡</ci></apply><ci id="S3.SS2.p5.2.m2.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3.3">𝑐</ci></apply><apply id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1"><divide id="S3.SS2.p5.2.m2.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.2"></divide><apply id="S3.SS2.p5.2.m2.1.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.3.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.1.3.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.3.2">𝐯</ci><ci id="S3.SS2.p5.2.m2.1.1.1.3.3.cmml" xref="S3.SS2.p5.2.m2.1.1.1.3.3">𝑐</ci></apply><apply id="S3.SS2.p5.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p5.2.m2.1.1.1.1.2.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.2">norm</csymbol><apply id="S3.SS2.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.2">𝐯</ci><ci id="S3.SS2.p5.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\tilde{\mathbf{h}}_{c}=\mathbf{v}_{c}/||\mathbf{v}_{c}||</annotation></semantics></math>, where <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="\mathbf{v}_{c}" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">𝐯</mi><mi id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝐯</ci><ci id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">\mathbf{v}_{c}</annotation></semantics></math> refers to the vectorized classifier weights of class <math id="S3.SS2.p5.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS2.p5.4.m4.1a"><mi id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><ci id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">c</annotation></semantics></math>.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2303.10058/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="507" height="112" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span id="S3.F2.3.1" class="ltx_text ltx_font_bold">Proposed <span id="S3.F2.3.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span> during FL training.</span> (a) In vanilla FL training, the feature extractor and linear classifier are both learned at clients and aggregated at server. (b) In our <span id="S3.F2.4.2" class="ltx_text ltx_font_smallcaps">FedETF</span>, only the feature extractor and projection layer are learned and aggregated, and we adopt the same synthetic and fixed ETF classifier for all clients throughout the FL training process. Instead of prediction logit loss in vanilla FL, we use a novel balanced feature loss for the ETF classifier.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methods</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Neural collapse tells us the optimal structure (i.e. simplex ETF) of classifiers and feature prototypes in a perfect training setting. It inspires us to use a synthetic simplex ETF as a fixed classifier from the start to mitigate the classifier bias and feature misalignment problems (see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) brought by clients’ data heterogeneity. Therefore, we propose <span id="S4.p1.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span>, a novel FL algorithm inspired by neural collapse. Concretely, as elaborated in Section <a href="#S4.SS1" title="4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>, to promote the generalization of the global model, we reformulate the model architecture by replacing the learnable classifier with a fixed ETF classifier and devise a tailored loss for robust learning during FL training. Moreover, as described in Section <a href="#S4.SS2" title="4.2 Personalized Adaptation by Local Finetuning ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>, to improve local personalization after FL training, we propose a finetuning strategy for both finetuning the model and the formerly fixed ETF classifier.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Improving Generalization by ETF Classifier</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Reformulation of the model architecture.</span> In previous works of FL, a model architecture that consists of a learnable feature extractor and a learnable linear classifier is adopted <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, as shown in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Neural Collapse ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (a). However, due to clients’ data heterogeneity, the classifiers will be more biased than other layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, and a vicious cycle between classifier biases and feature misalignment will exist <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. In this paper, we reformulate the model in FL into the combination of a learnable feature extractor and a fixed ETF classifier, as demonstrated in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Neural Collapse ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (b).</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.10" class="ltx_p"><span id="S4.SS1.p2.10.1" class="ltx_text ltx_font_bold ltx_font_italic">ETF classifier initialization:</span> At the beginning of the FL training, we first randomly synthesize a simplex ETF <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{V}_{ETF}\in\mathbb{R}^{d\times C}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><msub id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2.2" xref="S4.SS1.p2.1.m1.1.1.2.2.cmml">𝐕</mi><mrow id="S4.SS1.p2.1.m1.1.1.2.3" xref="S4.SS1.p2.1.m1.1.1.2.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2.3.2" xref="S4.SS1.p2.1.m1.1.1.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.1.1.2.3.1" xref="S4.SS1.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p2.1.m1.1.1.2.3.3" xref="S4.SS1.p2.1.m1.1.1.2.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.1.1.2.3.1a" xref="S4.SS1.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p2.1.m1.1.1.2.3.4" xref="S4.SS1.p2.1.m1.1.1.2.3.4.cmml">F</mi></mrow></msub><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p2.1.m1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml"><mi id="S4.SS1.p2.1.m1.1.1.3.3.2" xref="S4.SS1.p2.1.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.p2.1.m1.1.1.3.3.1" xref="S4.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p2.1.m1.1.1.3.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><in id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></in><apply id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2.2">𝐕</ci><apply id="S4.SS1.p2.1.m1.1.1.2.3.cmml" xref="S4.SS1.p2.1.m1.1.1.2.3"><times id="S4.SS1.p2.1.m1.1.1.2.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.2.3.1"></times><ci id="S4.SS1.p2.1.m1.1.1.2.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2.3.2">𝐸</ci><ci id="S4.SS1.p2.1.m1.1.1.2.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.2.3.3">𝑇</ci><ci id="S4.SS1.p2.1.m1.1.1.2.3.4.cmml" xref="S4.SS1.p2.1.m1.1.1.2.3.4">𝐹</ci></apply></apply><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S4.SS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3"><times id="S4.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.1"></times><ci id="S4.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.2">𝑑</ci><ci id="S4.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\mathbf{V}_{ETF}\in\mathbb{R}^{d\times C}</annotation></semantics></math> by Eq. (<a href="#S3.E3" title="In Definition 3.1 (Simplex Equiangular Tight Frame). ‣ 3.2 Neural Collapse ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), where <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">d</annotation></semantics></math> denotes the feature dimension of the ETF and <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">C</annotation></semantics></math> is the number of classes. The feature dimension <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">d</annotation></semantics></math> should require <math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="d\geq C-1" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mi id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">d</mi><mo id="S4.SS1.p2.5.m5.1.1.1" xref="S4.SS1.p2.5.m5.1.1.1.cmml">≥</mo><mrow id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml"><mi id="S4.SS1.p2.5.m5.1.1.3.2" xref="S4.SS1.p2.5.m5.1.1.3.2.cmml">C</mi><mo id="S4.SS1.p2.5.m5.1.1.3.1" xref="S4.SS1.p2.5.m5.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p2.5.m5.1.1.3.3" xref="S4.SS1.p2.5.m5.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><geq id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1"></geq><ci id="S4.SS1.p2.5.m5.1.1.2.cmml" xref="S4.SS1.p2.5.m5.1.1.2">𝑑</ci><apply id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3"><minus id="S4.SS1.p2.5.m5.1.1.3.1.cmml" xref="S4.SS1.p2.5.m5.1.1.3.1"></minus><ci id="S4.SS1.p2.5.m5.1.1.3.2.cmml" xref="S4.SS1.p2.5.m5.1.1.3.2">𝐶</ci><cn type="integer" id="S4.SS1.p2.5.m5.1.1.3.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">d\geq C-1</annotation></semantics></math> in Definition <a href="#S3.Thmtheorem1" title="Definition 3.1 (Simplex Equiangular Tight Frame). ‣ 3.2 Neural Collapse ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>, and we will discuss in Figure <a href="#S5.F6" title="Figure 6 ‣ 5.3 Understanding FedETF ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (a) that a relatively low dimension is beneficial to neural collapse. For each class’s classifier vector <math id="S4.SS1.p2.6.m6.3" class="ltx_Math" alttext="\mathbf{v}_{i},~{}\forall i\in[C]" display="inline"><semantics id="S4.SS1.p2.6.m6.3a"><mrow id="S4.SS1.p2.6.m6.3.3" xref="S4.SS1.p2.6.m6.3.3.cmml"><mrow id="S4.SS1.p2.6.m6.3.3.2.2" xref="S4.SS1.p2.6.m6.3.3.2.3.cmml"><msub id="S4.SS1.p2.6.m6.2.2.1.1.1" xref="S4.SS1.p2.6.m6.2.2.1.1.1.cmml"><mi id="S4.SS1.p2.6.m6.2.2.1.1.1.2" xref="S4.SS1.p2.6.m6.2.2.1.1.1.2.cmml">𝐯</mi><mi id="S4.SS1.p2.6.m6.2.2.1.1.1.3" xref="S4.SS1.p2.6.m6.2.2.1.1.1.3.cmml">i</mi></msub><mo rspace="0.497em" id="S4.SS1.p2.6.m6.3.3.2.2.3" xref="S4.SS1.p2.6.m6.3.3.2.3.cmml">,</mo><mrow id="S4.SS1.p2.6.m6.3.3.2.2.2" xref="S4.SS1.p2.6.m6.3.3.2.2.2.cmml"><mo rspace="0.167em" id="S4.SS1.p2.6.m6.3.3.2.2.2.1" xref="S4.SS1.p2.6.m6.3.3.2.2.2.1.cmml">∀</mo><mi id="S4.SS1.p2.6.m6.3.3.2.2.2.2" xref="S4.SS1.p2.6.m6.3.3.2.2.2.2.cmml">i</mi></mrow></mrow><mo id="S4.SS1.p2.6.m6.3.3.3" xref="S4.SS1.p2.6.m6.3.3.3.cmml">∈</mo><mrow id="S4.SS1.p2.6.m6.3.3.4.2" xref="S4.SS1.p2.6.m6.3.3.4.1.cmml"><mo stretchy="false" id="S4.SS1.p2.6.m6.3.3.4.2.1" xref="S4.SS1.p2.6.m6.3.3.4.1.1.cmml">[</mo><mi id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml">C</mi><mo stretchy="false" id="S4.SS1.p2.6.m6.3.3.4.2.2" xref="S4.SS1.p2.6.m6.3.3.4.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.3b"><apply id="S4.SS1.p2.6.m6.3.3.cmml" xref="S4.SS1.p2.6.m6.3.3"><in id="S4.SS1.p2.6.m6.3.3.3.cmml" xref="S4.SS1.p2.6.m6.3.3.3"></in><list id="S4.SS1.p2.6.m6.3.3.2.3.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2"><apply id="S4.SS1.p2.6.m6.2.2.1.1.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.6.m6.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.2">𝐯</ci><ci id="S4.SS1.p2.6.m6.2.2.1.1.1.3.cmml" xref="S4.SS1.p2.6.m6.2.2.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p2.6.m6.3.3.2.2.2.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2"><csymbol cd="latexml" id="S4.SS1.p2.6.m6.3.3.2.2.2.1.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2.1">for-all</csymbol><ci id="S4.SS1.p2.6.m6.3.3.2.2.2.2.cmml" xref="S4.SS1.p2.6.m6.3.3.2.2.2.2">𝑖</ci></apply></list><apply id="S4.SS1.p2.6.m6.3.3.4.1.cmml" xref="S4.SS1.p2.6.m6.3.3.4.2"><csymbol cd="latexml" id="S4.SS1.p2.6.m6.3.3.4.1.1.cmml" xref="S4.SS1.p2.6.m6.3.3.4.2.1">delimited-[]</csymbol><ci id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.3c">\mathbf{v}_{i},~{}\forall i\in[C]</annotation></semantics></math> in the ETF <math id="S4.SS1.p2.7.m7.1" class="ltx_Math" alttext="\mathbf{V}_{ETF}" display="inline"><semantics id="S4.SS1.p2.7.m7.1a"><msub id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.p2.7.m7.1.1.2" xref="S4.SS1.p2.7.m7.1.1.2.cmml">𝐕</mi><mrow id="S4.SS1.p2.7.m7.1.1.3" xref="S4.SS1.p2.7.m7.1.1.3.cmml"><mi id="S4.SS1.p2.7.m7.1.1.3.2" xref="S4.SS1.p2.7.m7.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.7.m7.1.1.3.1" xref="S4.SS1.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.7.m7.1.1.3.3" xref="S4.SS1.p2.7.m7.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.7.m7.1.1.3.1a" xref="S4.SS1.p2.7.m7.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p2.7.m7.1.1.3.4" xref="S4.SS1.p2.7.m7.1.1.3.4.cmml">F</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m7.1b"><apply id="S4.SS1.p2.7.m7.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m7.1.1.1.cmml" xref="S4.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS1.p2.7.m7.1.1.2.cmml" xref="S4.SS1.p2.7.m7.1.1.2">𝐕</ci><apply id="S4.SS1.p2.7.m7.1.1.3.cmml" xref="S4.SS1.p2.7.m7.1.1.3"><times id="S4.SS1.p2.7.m7.1.1.3.1.cmml" xref="S4.SS1.p2.7.m7.1.1.3.1"></times><ci id="S4.SS1.p2.7.m7.1.1.3.2.cmml" xref="S4.SS1.p2.7.m7.1.1.3.2">𝐸</ci><ci id="S4.SS1.p2.7.m7.1.1.3.3.cmml" xref="S4.SS1.p2.7.m7.1.1.3.3">𝑇</ci><ci id="S4.SS1.p2.7.m7.1.1.3.4.cmml" xref="S4.SS1.p2.7.m7.1.1.3.4">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m7.1c">\mathbf{V}_{ETF}</annotation></semantics></math>, it requires <math id="S4.SS1.p2.8.m8.1" class="ltx_Math" alttext="\|\mathbf{v}_{i}\|_{2}=1" display="inline"><semantics id="S4.SS1.p2.8.m8.1a"><mrow id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml"><msub id="S4.SS1.p2.8.m8.1.1.1" xref="S4.SS1.p2.8.m8.1.1.1.cmml"><mrow id="S4.SS1.p2.8.m8.1.1.1.1.1" xref="S4.SS1.p2.8.m8.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.8.m8.1.1.1.1.1.2" xref="S4.SS1.p2.8.m8.1.1.1.1.2.1.cmml">‖</mo><msub id="S4.SS1.p2.8.m8.1.1.1.1.1.1" xref="S4.SS1.p2.8.m8.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.8.m8.1.1.1.1.1.1.2" xref="S4.SS1.p2.8.m8.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="S4.SS1.p2.8.m8.1.1.1.1.1.1.3" xref="S4.SS1.p2.8.m8.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.SS1.p2.8.m8.1.1.1.1.1.3" xref="S4.SS1.p2.8.m8.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.SS1.p2.8.m8.1.1.1.3" xref="S4.SS1.p2.8.m8.1.1.1.3.cmml">2</mn></msub><mo id="S4.SS1.p2.8.m8.1.1.2" xref="S4.SS1.p2.8.m8.1.1.2.cmml">=</mo><mn id="S4.SS1.p2.8.m8.1.1.3" xref="S4.SS1.p2.8.m8.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m8.1b"><apply id="S4.SS1.p2.8.m8.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1"><eq id="S4.SS1.p2.8.m8.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.2"></eq><apply id="S4.SS1.p2.8.m8.1.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m8.1.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.1">subscript</csymbol><apply id="S4.SS1.p2.8.m8.1.1.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.8.m8.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.8.m8.1.1.1.1.1.2">norm</csymbol><apply id="S4.SS1.p2.8.m8.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m8.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.8.m8.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.8.m8.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.8.m8.1.1.1.1.1.1.2">𝐯</ci><ci id="S4.SS1.p2.8.m8.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.8.m8.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="S4.SS1.p2.8.m8.1.1.1.3.cmml" xref="S4.SS1.p2.8.m8.1.1.1.3">2</cn></apply><cn type="integer" id="S4.SS1.p2.8.m8.1.1.3.cmml" xref="S4.SS1.p2.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m8.1c">\|\mathbf{v}_{i}\|_{2}=1</annotation></semantics></math>; and any pair of classifier vectors <math id="S4.SS1.p2.9.m9.5" class="ltx_Math" alttext="(\mathbf{v}_{i},\mathbf{v}_{j}),~{}i\neq j,~{}\forall i,j\in[C]" display="inline"><semantics id="S4.SS1.p2.9.m9.5a"><mrow id="S4.SS1.p2.9.m9.5.5.2" xref="S4.SS1.p2.9.m9.5.5.3.cmml"><mrow id="S4.SS1.p2.9.m9.4.4.1.1" xref="S4.SS1.p2.9.m9.4.4.1.1.cmml"><mrow id="S4.SS1.p2.9.m9.4.4.1.1.1.1" xref="S4.SS1.p2.9.m9.4.4.1.1.1.2.cmml"><mrow id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.3" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.3.cmml">(</mo><msub id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.2" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.3" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.4" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.3.cmml">,</mo><msub id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.cmml"><mi id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.2" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.2.cmml">𝐯</mi><mi id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.3" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.5" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.3.cmml">)</mo></mrow><mo rspace="0.497em" id="S4.SS1.p2.9.m9.4.4.1.1.1.1.2" xref="S4.SS1.p2.9.m9.4.4.1.1.1.2.cmml">,</mo><mi id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml">i</mi></mrow><mo id="S4.SS1.p2.9.m9.4.4.1.1.2" xref="S4.SS1.p2.9.m9.4.4.1.1.2.cmml">≠</mo><mi id="S4.SS1.p2.9.m9.4.4.1.1.3" xref="S4.SS1.p2.9.m9.4.4.1.1.3.cmml">j</mi></mrow><mo rspace="0.497em" id="S4.SS1.p2.9.m9.5.5.2.3" xref="S4.SS1.p2.9.m9.5.5.3a.cmml">,</mo><mrow id="S4.SS1.p2.9.m9.5.5.2.2" xref="S4.SS1.p2.9.m9.5.5.2.2.cmml"><mrow id="S4.SS1.p2.9.m9.5.5.2.2.1.1" xref="S4.SS1.p2.9.m9.5.5.2.2.1.2.cmml"><mrow id="S4.SS1.p2.9.m9.5.5.2.2.1.1.1" xref="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.cmml"><mo rspace="0.167em" id="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.1" xref="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.1.cmml">∀</mo><mi id="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.2" xref="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.2.cmml">i</mi></mrow><mo id="S4.SS1.p2.9.m9.5.5.2.2.1.1.2" xref="S4.SS1.p2.9.m9.5.5.2.2.1.2.cmml">,</mo><mi id="S4.SS1.p2.9.m9.3.3" xref="S4.SS1.p2.9.m9.3.3.cmml">j</mi></mrow><mo id="S4.SS1.p2.9.m9.5.5.2.2.2" xref="S4.SS1.p2.9.m9.5.5.2.2.2.cmml">∈</mo><mrow id="S4.SS1.p2.9.m9.5.5.2.2.3.2" xref="S4.SS1.p2.9.m9.5.5.2.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.9.m9.5.5.2.2.3.2.1" xref="S4.SS1.p2.9.m9.5.5.2.2.3.1.1.cmml">[</mo><mi id="S4.SS1.p2.9.m9.2.2" xref="S4.SS1.p2.9.m9.2.2.cmml">C</mi><mo stretchy="false" id="S4.SS1.p2.9.m9.5.5.2.2.3.2.2" xref="S4.SS1.p2.9.m9.5.5.2.2.3.1.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m9.5b"><apply id="S4.SS1.p2.9.m9.5.5.3.cmml" xref="S4.SS1.p2.9.m9.5.5.2"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m9.5.5.3a.cmml" xref="S4.SS1.p2.9.m9.5.5.2.3">formulae-sequence</csymbol><apply id="S4.SS1.p2.9.m9.4.4.1.1.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1"><neq id="S4.SS1.p2.9.m9.4.4.1.1.2.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.2"></neq><list id="S4.SS1.p2.9.m9.4.4.1.1.1.2.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1"><interval closure="open" id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2"><apply id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.2">𝐯</ci><ci id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2">subscript</csymbol><ci id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.2">𝐯</ci><ci id="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.3.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.1.1.1.2.2.3">𝑗</ci></apply></interval><ci id="S4.SS1.p2.9.m9.1.1.cmml" xref="S4.SS1.p2.9.m9.1.1">𝑖</ci></list><ci id="S4.SS1.p2.9.m9.4.4.1.1.3.cmml" xref="S4.SS1.p2.9.m9.4.4.1.1.3">𝑗</ci></apply><apply id="S4.SS1.p2.9.m9.5.5.2.2.cmml" xref="S4.SS1.p2.9.m9.5.5.2.2"><in id="S4.SS1.p2.9.m9.5.5.2.2.2.cmml" xref="S4.SS1.p2.9.m9.5.5.2.2.2"></in><list id="S4.SS1.p2.9.m9.5.5.2.2.1.2.cmml" xref="S4.SS1.p2.9.m9.5.5.2.2.1.1"><apply id="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.cmml" xref="S4.SS1.p2.9.m9.5.5.2.2.1.1.1"><csymbol cd="latexml" id="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.1">for-all</csymbol><ci id="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.2.cmml" xref="S4.SS1.p2.9.m9.5.5.2.2.1.1.1.2">𝑖</ci></apply><ci id="S4.SS1.p2.9.m9.3.3.cmml" xref="S4.SS1.p2.9.m9.3.3">𝑗</ci></list><apply id="S4.SS1.p2.9.m9.5.5.2.2.3.1.cmml" xref="S4.SS1.p2.9.m9.5.5.2.2.3.2"><csymbol cd="latexml" id="S4.SS1.p2.9.m9.5.5.2.2.3.1.1.cmml" xref="S4.SS1.p2.9.m9.5.5.2.2.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.p2.9.m9.2.2.cmml" xref="S4.SS1.p2.9.m9.2.2">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m9.5c">(\mathbf{v}_{i},\mathbf{v}_{j}),~{}i\neq j,~{}\forall i,j\in[C]</annotation></semantics></math> satisfies <math id="S4.SS1.p2.10.m10.3" class="ltx_Math" alttext="\cos(\mathbf{v}_{i},\mathbf{v}_{j})=-\frac{1}{C-1}" display="inline"><semantics id="S4.SS1.p2.10.m10.3a"><mrow id="S4.SS1.p2.10.m10.3.3" xref="S4.SS1.p2.10.m10.3.3.cmml"><mrow id="S4.SS1.p2.10.m10.3.3.2.2" xref="S4.SS1.p2.10.m10.3.3.2.3.cmml"><mi id="S4.SS1.p2.10.m10.1.1" xref="S4.SS1.p2.10.m10.1.1.cmml">cos</mi><mo id="S4.SS1.p2.10.m10.3.3.2.2a" xref="S4.SS1.p2.10.m10.3.3.2.3.cmml">⁡</mo><mrow id="S4.SS1.p2.10.m10.3.3.2.2.2" xref="S4.SS1.p2.10.m10.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.10.m10.3.3.2.2.2.3" xref="S4.SS1.p2.10.m10.3.3.2.3.cmml">(</mo><msub id="S4.SS1.p2.10.m10.2.2.1.1.1.1" xref="S4.SS1.p2.10.m10.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p2.10.m10.2.2.1.1.1.1.2" xref="S4.SS1.p2.10.m10.2.2.1.1.1.1.2.cmml">𝐯</mi><mi id="S4.SS1.p2.10.m10.2.2.1.1.1.1.3" xref="S4.SS1.p2.10.m10.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.p2.10.m10.3.3.2.2.2.4" xref="S4.SS1.p2.10.m10.3.3.2.3.cmml">,</mo><msub id="S4.SS1.p2.10.m10.3.3.2.2.2.2" xref="S4.SS1.p2.10.m10.3.3.2.2.2.2.cmml"><mi id="S4.SS1.p2.10.m10.3.3.2.2.2.2.2" xref="S4.SS1.p2.10.m10.3.3.2.2.2.2.2.cmml">𝐯</mi><mi id="S4.SS1.p2.10.m10.3.3.2.2.2.2.3" xref="S4.SS1.p2.10.m10.3.3.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S4.SS1.p2.10.m10.3.3.2.2.2.5" xref="S4.SS1.p2.10.m10.3.3.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p2.10.m10.3.3.3" xref="S4.SS1.p2.10.m10.3.3.3.cmml">=</mo><mrow id="S4.SS1.p2.10.m10.3.3.4" xref="S4.SS1.p2.10.m10.3.3.4.cmml"><mo id="S4.SS1.p2.10.m10.3.3.4a" xref="S4.SS1.p2.10.m10.3.3.4.cmml">−</mo><mfrac id="S4.SS1.p2.10.m10.3.3.4.2" xref="S4.SS1.p2.10.m10.3.3.4.2.cmml"><mn id="S4.SS1.p2.10.m10.3.3.4.2.2" xref="S4.SS1.p2.10.m10.3.3.4.2.2.cmml">1</mn><mrow id="S4.SS1.p2.10.m10.3.3.4.2.3" xref="S4.SS1.p2.10.m10.3.3.4.2.3.cmml"><mi id="S4.SS1.p2.10.m10.3.3.4.2.3.2" xref="S4.SS1.p2.10.m10.3.3.4.2.3.2.cmml">C</mi><mo id="S4.SS1.p2.10.m10.3.3.4.2.3.1" xref="S4.SS1.p2.10.m10.3.3.4.2.3.1.cmml">−</mo><mn id="S4.SS1.p2.10.m10.3.3.4.2.3.3" xref="S4.SS1.p2.10.m10.3.3.4.2.3.3.cmml">1</mn></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m10.3b"><apply id="S4.SS1.p2.10.m10.3.3.cmml" xref="S4.SS1.p2.10.m10.3.3"><eq id="S4.SS1.p2.10.m10.3.3.3.cmml" xref="S4.SS1.p2.10.m10.3.3.3"></eq><apply id="S4.SS1.p2.10.m10.3.3.2.3.cmml" xref="S4.SS1.p2.10.m10.3.3.2.2"><cos id="S4.SS1.p2.10.m10.1.1.cmml" xref="S4.SS1.p2.10.m10.1.1"></cos><apply id="S4.SS1.p2.10.m10.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.10.m10.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m10.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.10.m10.2.2.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p2.10.m10.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.10.m10.2.2.1.1.1.1.2">𝐯</ci><ci id="S4.SS1.p2.10.m10.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.10.m10.2.2.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.p2.10.m10.3.3.2.2.2.2.cmml" xref="S4.SS1.p2.10.m10.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.10.m10.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p2.10.m10.3.3.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p2.10.m10.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p2.10.m10.3.3.2.2.2.2.2">𝐯</ci><ci id="S4.SS1.p2.10.m10.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p2.10.m10.3.3.2.2.2.2.3">𝑗</ci></apply></apply><apply id="S4.SS1.p2.10.m10.3.3.4.cmml" xref="S4.SS1.p2.10.m10.3.3.4"><minus id="S4.SS1.p2.10.m10.3.3.4.1.cmml" xref="S4.SS1.p2.10.m10.3.3.4"></minus><apply id="S4.SS1.p2.10.m10.3.3.4.2.cmml" xref="S4.SS1.p2.10.m10.3.3.4.2"><divide id="S4.SS1.p2.10.m10.3.3.4.2.1.cmml" xref="S4.SS1.p2.10.m10.3.3.4.2"></divide><cn type="integer" id="S4.SS1.p2.10.m10.3.3.4.2.2.cmml" xref="S4.SS1.p2.10.m10.3.3.4.2.2">1</cn><apply id="S4.SS1.p2.10.m10.3.3.4.2.3.cmml" xref="S4.SS1.p2.10.m10.3.3.4.2.3"><minus id="S4.SS1.p2.10.m10.3.3.4.2.3.1.cmml" xref="S4.SS1.p2.10.m10.3.3.4.2.3.1"></minus><ci id="S4.SS1.p2.10.m10.3.3.4.2.3.2.cmml" xref="S4.SS1.p2.10.m10.3.3.4.2.3.2">𝐶</ci><cn type="integer" id="S4.SS1.p2.10.m10.3.3.4.2.3.3.cmml" xref="S4.SS1.p2.10.m10.3.3.4.2.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m10.3c">\cos(\mathbf{v}_{i},\mathbf{v}_{j})=-\frac{1}{C-1}</annotation></semantics></math> according to Eq. (<a href="#S3.E4" title="In Definition 3.1 (Simplex Equiangular Tight Frame). ‣ 3.2 Neural Collapse ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.5" class="ltx_p"><span id="S4.SS1.p3.5.1" class="ltx_text ltx_font_bold ltx_font_italic">Projection layer:</span> Given a data sample <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\mathbf{x}</annotation></semantics></math>, we first use the feature extractor <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="f_{\mathbf{u}}" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><msub id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">f</mi><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">𝐮</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑓</ci><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">𝐮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">f_{\mathbf{u}}</annotation></semantics></math> to transform the data into the raw feature <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mi id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><ci id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">\mathbf{h}</annotation></semantics></math> and then use a projection layer <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="g_{\mathbf{p}}" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><msub id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mi id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">g</mi><mi id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml">𝐩</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">𝑔</ci><ci id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3">𝐩</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">g_{\mathbf{p}}</annotation></semantics></math> to map this raw feature to the ETF feature space and normalize it into <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="\boldsymbol{\mu}" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mi id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">𝝁</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><ci id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">𝝁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">\boldsymbol{\mu}</annotation></semantics></math>.</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.6" class="ltx_Math" alttext="\boldsymbol{\mu}=\hat{\boldsymbol{\mu}}/\|\hat{\boldsymbol{\mu}}\|_{2},\quad\hat{\boldsymbol{\mu}}=g(\mathbf{p};\mathbf{h}),\quad\mathbf{h}=f(\mathbf{u};\mathbf{x})," display="block"><semantics id="S4.E5.m1.6a"><mrow id="S4.E5.m1.6.6.1"><mrow id="S4.E5.m1.6.6.1.1.2" xref="S4.E5.m1.6.6.1.1.3.cmml"><mrow id="S4.E5.m1.6.6.1.1.1.1" xref="S4.E5.m1.6.6.1.1.1.1.cmml"><mi id="S4.E5.m1.6.6.1.1.1.1.2" xref="S4.E5.m1.6.6.1.1.1.1.2.cmml">𝝁</mi><mo id="S4.E5.m1.6.6.1.1.1.1.1" xref="S4.E5.m1.6.6.1.1.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.6.6.1.1.1.1.3" xref="S4.E5.m1.6.6.1.1.1.1.3.cmml"><mover accent="true" id="S4.E5.m1.6.6.1.1.1.1.3.2" xref="S4.E5.m1.6.6.1.1.1.1.3.2.cmml"><mi id="S4.E5.m1.6.6.1.1.1.1.3.2.2" xref="S4.E5.m1.6.6.1.1.1.1.3.2.2.cmml">𝝁</mi><mo id="S4.E5.m1.6.6.1.1.1.1.3.2.1" xref="S4.E5.m1.6.6.1.1.1.1.3.2.1.cmml">^</mo></mover><mo id="S4.E5.m1.6.6.1.1.1.1.3.1" xref="S4.E5.m1.6.6.1.1.1.1.3.1.cmml">/</mo><msub id="S4.E5.m1.6.6.1.1.1.1.3.3" xref="S4.E5.m1.6.6.1.1.1.1.3.3.cmml"><mrow id="S4.E5.m1.6.6.1.1.1.1.3.3.2.2" xref="S4.E5.m1.6.6.1.1.1.1.3.3.2.1.cmml"><mo stretchy="false" id="S4.E5.m1.6.6.1.1.1.1.3.3.2.2.1" xref="S4.E5.m1.6.6.1.1.1.1.3.3.2.1.1.cmml">‖</mo><mover accent="true" id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mi id="S4.E5.m1.1.1.2" xref="S4.E5.m1.1.1.2.cmml">𝝁</mi><mo id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S4.E5.m1.6.6.1.1.1.1.3.3.2.2.2" xref="S4.E5.m1.6.6.1.1.1.1.3.3.2.1.1.cmml">‖</mo></mrow><mn id="S4.E5.m1.6.6.1.1.1.1.3.3.3" xref="S4.E5.m1.6.6.1.1.1.1.3.3.3.cmml">2</mn></msub></mrow></mrow><mo rspace="1.167em" id="S4.E5.m1.6.6.1.1.2.3" xref="S4.E5.m1.6.6.1.1.3a.cmml">,</mo><mrow id="S4.E5.m1.6.6.1.1.2.2.2" xref="S4.E5.m1.6.6.1.1.2.2.3.cmml"><mrow id="S4.E5.m1.6.6.1.1.2.2.1.1" xref="S4.E5.m1.6.6.1.1.2.2.1.1.cmml"><mover accent="true" id="S4.E5.m1.6.6.1.1.2.2.1.1.2" xref="S4.E5.m1.6.6.1.1.2.2.1.1.2.cmml"><mi id="S4.E5.m1.6.6.1.1.2.2.1.1.2.2" xref="S4.E5.m1.6.6.1.1.2.2.1.1.2.2.cmml">𝝁</mi><mo id="S4.E5.m1.6.6.1.1.2.2.1.1.2.1" xref="S4.E5.m1.6.6.1.1.2.2.1.1.2.1.cmml">^</mo></mover><mo id="S4.E5.m1.6.6.1.1.2.2.1.1.1" xref="S4.E5.m1.6.6.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.6.6.1.1.2.2.1.1.3" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.cmml"><mi id="S4.E5.m1.6.6.1.1.2.2.1.1.3.2" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.2.2.1.1.3.1" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.1.cmml">​</mo><mrow id="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.2" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.1.cmml"><mo stretchy="false" id="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.2.1" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.1.cmml">(</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">𝐩</mi><mo id="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.2.2" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.1.cmml">;</mo><mi id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">𝐡</mi><mo stretchy="false" id="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.2.3" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S4.E5.m1.6.6.1.1.2.2.2.3" xref="S4.E5.m1.6.6.1.1.2.2.3a.cmml">,</mo><mrow id="S4.E5.m1.6.6.1.1.2.2.2.2" xref="S4.E5.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S4.E5.m1.6.6.1.1.2.2.2.2.2" xref="S4.E5.m1.6.6.1.1.2.2.2.2.2.cmml">𝐡</mi><mo id="S4.E5.m1.6.6.1.1.2.2.2.2.1" xref="S4.E5.m1.6.6.1.1.2.2.2.2.1.cmml">=</mo><mrow id="S4.E5.m1.6.6.1.1.2.2.2.2.3" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.cmml"><mi id="S4.E5.m1.6.6.1.1.2.2.2.2.3.2" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.6.6.1.1.2.2.2.2.3.1" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.1.cmml">​</mo><mrow id="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.2" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.1.cmml"><mo stretchy="false" id="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.2.1" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.1.cmml">(</mo><mi id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml">𝐮</mi><mo id="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.2.2" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.1.cmml">;</mo><mi id="S4.E5.m1.5.5" xref="S4.E5.m1.5.5.cmml">𝐱</mi><mo stretchy="false" id="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.2.3" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.6.6.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.6b"><apply id="S4.E5.m1.6.6.1.1.3.cmml" xref="S4.E5.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.1.1.3a.cmml" xref="S4.E5.m1.6.6.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.6.6.1.1.1.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1"><eq id="S4.E5.m1.6.6.1.1.1.1.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1.1"></eq><ci id="S4.E5.m1.6.6.1.1.1.1.2.cmml" xref="S4.E5.m1.6.6.1.1.1.1.2">𝝁</ci><apply id="S4.E5.m1.6.6.1.1.1.1.3.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3"><divide id="S4.E5.m1.6.6.1.1.1.1.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.1"></divide><apply id="S4.E5.m1.6.6.1.1.1.1.3.2.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.2"><ci id="S4.E5.m1.6.6.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.2.1">^</ci><ci id="S4.E5.m1.6.6.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.2.2">𝝁</ci></apply><apply id="S4.E5.m1.6.6.1.1.1.1.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.3">subscript</csymbol><apply id="S4.E5.m1.6.6.1.1.1.1.3.3.2.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.3.2.2"><csymbol cd="latexml" id="S4.E5.m1.6.6.1.1.1.1.3.3.2.1.1.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.3.2.2.1">norm</csymbol><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><ci id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1">^</ci><ci id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1.2">𝝁</ci></apply></apply><cn type="integer" id="S4.E5.m1.6.6.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.6.6.1.1.1.1.3.3.3">2</cn></apply></apply></apply><apply id="S4.E5.m1.6.6.1.1.2.2.3.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.6.6.1.1.2.2.3a.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E5.m1.6.6.1.1.2.2.1.1.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1"><eq id="S4.E5.m1.6.6.1.1.2.2.1.1.1.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1.1"></eq><apply id="S4.E5.m1.6.6.1.1.2.2.1.1.2.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1.2"><ci id="S4.E5.m1.6.6.1.1.2.2.1.1.2.1.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1.2.1">^</ci><ci id="S4.E5.m1.6.6.1.1.2.2.1.1.2.2.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1.2.2">𝝁</ci></apply><apply id="S4.E5.m1.6.6.1.1.2.2.1.1.3.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3"><times id="S4.E5.m1.6.6.1.1.2.2.1.1.3.1.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.1"></times><ci id="S4.E5.m1.6.6.1.1.2.2.1.1.3.2.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.2">𝑔</ci><list id="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.1.cmml" xref="S4.E5.m1.6.6.1.1.2.2.1.1.3.3.2"><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝐩</ci><ci id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3">𝐡</ci></list></apply></apply><apply id="S4.E5.m1.6.6.1.1.2.2.2.2.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2.2"><eq id="S4.E5.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2.2.1"></eq><ci id="S4.E5.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2.2.2">𝐡</ci><apply id="S4.E5.m1.6.6.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3"><times id="S4.E5.m1.6.6.1.1.2.2.2.2.3.1.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.1"></times><ci id="S4.E5.m1.6.6.1.1.2.2.2.2.3.2.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.2">𝑓</ci><list id="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.1.cmml" xref="S4.E5.m1.6.6.1.1.2.2.2.2.3.3.2"><ci id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4">𝐮</ci><ci id="S4.E5.m1.5.5.cmml" xref="S4.E5.m1.5.5">𝐱</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.6c">\boldsymbol{\mu}=\hat{\boldsymbol{\mu}}/\|\hat{\boldsymbol{\mu}}\|_{2},\quad\hat{\boldsymbol{\mu}}=g(\mathbf{p};\mathbf{h}),\quad\mathbf{h}=f(\mathbf{u};\mathbf{x}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.10" class="ltx_p">where <math id="S4.SS1.p3.6.m1.1" class="ltx_Math" alttext="\mathbf{u}" display="inline"><semantics id="S4.SS1.p3.6.m1.1a"><mi id="S4.SS1.p3.6.m1.1.1" xref="S4.SS1.p3.6.m1.1.1.cmml">𝐮</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m1.1b"><ci id="S4.SS1.p3.6.m1.1.1.cmml" xref="S4.SS1.p3.6.m1.1.1">𝐮</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m1.1c">\mathbf{u}</annotation></semantics></math> and <math id="S4.SS1.p3.7.m2.1" class="ltx_Math" alttext="\mathbf{p}" display="inline"><semantics id="S4.SS1.p3.7.m2.1a"><mi id="S4.SS1.p3.7.m2.1.1" xref="S4.SS1.p3.7.m2.1.1.cmml">𝐩</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m2.1b"><ci id="S4.SS1.p3.7.m2.1.1.cmml" xref="S4.SS1.p3.7.m2.1.1">𝐩</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m2.1c">\mathbf{p}</annotation></semantics></math> denote the parameters of the feature extractor and the projection layer. We note that the projection layer is essential in our <span id="S4.SS1.p3.10.1" class="ltx_text ltx_font_smallcaps">FedETF</span> design: 1) If the last layer of the feature extractor is the non-linear activation, e.g. the ReLU, the raw feature <math id="S4.SS1.p3.8.m3.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S4.SS1.p3.8.m3.1a"><mi id="S4.SS1.p3.8.m3.1.1" xref="S4.SS1.p3.8.m3.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m3.1b"><ci id="S4.SS1.p3.8.m3.1.1.cmml" xref="S4.SS1.p3.8.m3.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m3.1c">\mathbf{h}</annotation></semantics></math> will be sparse with zeros (or near zero values), and it is hard for <math id="S4.SS1.p3.9.m4.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S4.SS1.p3.9.m4.1a"><mi id="S4.SS1.p3.9.m4.1.1" xref="S4.SS1.p3.9.m4.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m4.1b"><ci id="S4.SS1.p3.9.m4.1.1.cmml" xref="S4.SS1.p3.9.m4.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m4.1c">\mathbf{h}</annotation></semantics></math> to be close to the dense ETF classifier vectors. 2) The raw features always have high dimensions, and high-dimensional vectors are more prone to be orthogonal, which is harder to collapse into the ETF with maximal angles. It is necessary to use the projection layer to map the features into a suitable dimension <math id="S4.SS1.p3.10.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p3.10.m5.1a"><mi id="S4.SS1.p3.10.m5.1.1" xref="S4.SS1.p3.10.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m5.1b"><ci id="S4.SS1.p3.10.m5.1.1.cmml" xref="S4.SS1.p3.10.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m5.1c">d</annotation></semantics></math>. 3) The projection layer is helpful in the local finetuning stage for personalization.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">Balanced feature loss with learnable temperature.</span> In neural-collapse-inspired imbalanced learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, it is found that when the ETF classifier is used, the gradients of cross entropy (CE) will be biased towards the head class, and the authors proposed a dot regression loss to tackle this problem. In FL, clients’ local datasets are also class-imbalanced due to data heterogeneity, so techniques tackling the imbalanced problem are also needed in our design. Following previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> which induces balanced softmax loss to logit-prediction-based CE in FL, in this paper, we also incorporate the balanced loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> into our feature-based CE. Instead of using former dot regression loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>, it is found that our balanced feature CE loss also can solve the imbalanced gradient problem in learning with the ETF classifier.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.6" class="ltx_p">Moreover, the softmax function’s input of the vanilla CE loss is the logits, generated by MLP, while that of our method is the features’ product <math id="S4.SS1.p5.1.m1.1" class="ltx_Math" alttext="\mathbf{v}_{y}^{T}\boldsymbol{\mu}" display="inline"><semantics id="S4.SS1.p5.1.m1.1a"><mrow id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><msubsup id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2.2.2" xref="S4.SS1.p5.1.m1.1.1.2.2.2.cmml">𝐯</mi><mi id="S4.SS1.p5.1.m1.1.1.2.2.3" xref="S4.SS1.p5.1.m1.1.1.2.2.3.cmml">y</mi><mi id="S4.SS1.p5.1.m1.1.1.2.3" xref="S4.SS1.p5.1.m1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS1.p5.1.m1.1.1.1" xref="S4.SS1.p5.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">𝝁</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><times id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1.1"></times><apply id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.2.1.cmml" xref="S4.SS1.p5.1.m1.1.1.2">superscript</csymbol><apply id="S4.SS1.p5.1.m1.1.1.2.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.2.2.1.cmml" xref="S4.SS1.p5.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.2.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2.2.2">𝐯</ci><ci id="S4.SS1.p5.1.m1.1.1.2.2.3.cmml" xref="S4.SS1.p5.1.m1.1.1.2.2.3">𝑦</ci></apply><ci id="S4.SS1.p5.1.m1.1.1.2.3.cmml" xref="S4.SS1.p5.1.m1.1.1.2.3">𝑇</ci></apply><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝝁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\mathbf{v}_{y}^{T}\boldsymbol{\mu}</annotation></semantics></math>. The logits have a wide range of value since the output of MLP has no constraints, but our features’ product has a limited range [-1, 1]<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Knowing the fact that both the vectors are normalized.</span></span></span>, which is sensitive to scaling. Therefore, we add a temperature<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>The term “temperature” is borrowed from a similar concept in knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</span></span></span> scalar <math id="S4.SS1.p5.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p5.2.m2.1a"><mi id="S4.SS1.p5.2.m2.1.1" xref="S4.SS1.p5.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m2.1b"><ci id="S4.SS1.p5.2.m2.1.1.cmml" xref="S4.SS1.p5.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m2.1c">\beta</annotation></semantics></math> to scale the features’ product. Further, we found that in different stages of training, it requires different <math id="S4.SS1.p5.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p5.3.m3.1a"><mi id="S4.SS1.p5.3.m3.1.1" xref="S4.SS1.p5.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m3.1b"><ci id="S4.SS1.p5.3.m3.1.1.cmml" xref="S4.SS1.p5.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m3.1c">\beta</annotation></semantics></math>, and fixed <math id="S4.SS1.p5.4.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p5.4.m4.1a"><mi id="S4.SS1.p5.4.m4.1.1" xref="S4.SS1.p5.4.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m4.1b"><ci id="S4.SS1.p5.4.m4.1.1.cmml" xref="S4.SS1.p5.4.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m4.1c">\beta</annotation></semantics></math> is hard to tune and may impede performance if not appropriate. To solve this, we take <math id="S4.SS1.p5.5.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p5.5.m5.1a"><mi id="S4.SS1.p5.5.m5.1.1" xref="S4.SS1.p5.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m5.1b"><ci id="S4.SS1.p5.5.m5.1.1.cmml" xref="S4.SS1.p5.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m5.1c">\beta</annotation></semantics></math> as one of the parameters in the model and update it by SGD during training. This learnable temperature <math id="S4.SS1.p5.6.m6.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p5.6.m6.1a"><mi id="S4.SS1.p5.6.m6.1.1" xref="S4.SS1.p5.6.m6.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.6.m6.1b"><ci id="S4.SS1.p5.6.m6.1.1.cmml" xref="S4.SS1.p5.6.m6.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.6.m6.1c">\beta</annotation></semantics></math> will capture the learning dynamics in each client under various heterogeneity.</p>
</div>
<div id="S4.SS1.p6" class="ltx_para">
<p id="S4.SS1.p6.3" class="ltx_p">We define the model parameters in our <span id="S4.SS1.p6.3.1" class="ltx_text ltx_font_smallcaps">FedETF</span> as <math id="S4.SS1.p6.1.m1.3" class="ltx_Math" alttext="\mathbf{w}=\{\mathbf{u},\mathbf{p},\beta\}" display="inline"><semantics id="S4.SS1.p6.1.m1.3a"><mrow id="S4.SS1.p6.1.m1.3.4" xref="S4.SS1.p6.1.m1.3.4.cmml"><mi id="S4.SS1.p6.1.m1.3.4.2" xref="S4.SS1.p6.1.m1.3.4.2.cmml">𝐰</mi><mo id="S4.SS1.p6.1.m1.3.4.1" xref="S4.SS1.p6.1.m1.3.4.1.cmml">=</mo><mrow id="S4.SS1.p6.1.m1.3.4.3.2" xref="S4.SS1.p6.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS1.p6.1.m1.3.4.3.2.1" xref="S4.SS1.p6.1.m1.3.4.3.1.cmml">{</mo><mi id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml">𝐮</mi><mo id="S4.SS1.p6.1.m1.3.4.3.2.2" xref="S4.SS1.p6.1.m1.3.4.3.1.cmml">,</mo><mi id="S4.SS1.p6.1.m1.2.2" xref="S4.SS1.p6.1.m1.2.2.cmml">𝐩</mi><mo id="S4.SS1.p6.1.m1.3.4.3.2.3" xref="S4.SS1.p6.1.m1.3.4.3.1.cmml">,</mo><mi id="S4.SS1.p6.1.m1.3.3" xref="S4.SS1.p6.1.m1.3.3.cmml">β</mi><mo stretchy="false" id="S4.SS1.p6.1.m1.3.4.3.2.4" xref="S4.SS1.p6.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.1.m1.3b"><apply id="S4.SS1.p6.1.m1.3.4.cmml" xref="S4.SS1.p6.1.m1.3.4"><eq id="S4.SS1.p6.1.m1.3.4.1.cmml" xref="S4.SS1.p6.1.m1.3.4.1"></eq><ci id="S4.SS1.p6.1.m1.3.4.2.cmml" xref="S4.SS1.p6.1.m1.3.4.2">𝐰</ci><set id="S4.SS1.p6.1.m1.3.4.3.1.cmml" xref="S4.SS1.p6.1.m1.3.4.3.2"><ci id="S4.SS1.p6.1.m1.1.1.cmml" xref="S4.SS1.p6.1.m1.1.1">𝐮</ci><ci id="S4.SS1.p6.1.m1.2.2.cmml" xref="S4.SS1.p6.1.m1.2.2">𝐩</ci><ci id="S4.SS1.p6.1.m1.3.3.cmml" xref="S4.SS1.p6.1.m1.3.3">𝛽</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.1.m1.3c">\mathbf{w}=\{\mathbf{u},\mathbf{p},\beta\}</annotation></semantics></math>, which consists of the feature extractor, the projection layer, and the learnable temperature. For a given sample <math id="S4.SS1.p6.2.m2.2" class="ltx_Math" alttext="(\mathbf{x},y)" display="inline"><semantics id="S4.SS1.p6.2.m2.2a"><mrow id="S4.SS1.p6.2.m2.2.3.2" xref="S4.SS1.p6.2.m2.2.3.1.cmml"><mo stretchy="false" id="S4.SS1.p6.2.m2.2.3.2.1" xref="S4.SS1.p6.2.m2.2.3.1.cmml">(</mo><mi id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml">𝐱</mi><mo id="S4.SS1.p6.2.m2.2.3.2.2" xref="S4.SS1.p6.2.m2.2.3.1.cmml">,</mo><mi id="S4.SS1.p6.2.m2.2.2" xref="S4.SS1.p6.2.m2.2.2.cmml">y</mi><mo stretchy="false" id="S4.SS1.p6.2.m2.2.3.2.3" xref="S4.SS1.p6.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.2.m2.2b"><interval closure="open" id="S4.SS1.p6.2.m2.2.3.1.cmml" xref="S4.SS1.p6.2.m2.2.3.2"><ci id="S4.SS1.p6.2.m2.1.1.cmml" xref="S4.SS1.p6.2.m2.1.1">𝐱</ci><ci id="S4.SS1.p6.2.m2.2.2.cmml" xref="S4.SS1.p6.2.m2.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.2.m2.2c">(\mathbf{x},y)</annotation></semantics></math> of client <math id="S4.SS1.p6.3.m3.3" class="ltx_Math" alttext="k,~{}\forall k\in[K]" display="inline"><semantics id="S4.SS1.p6.3.m3.3a"><mrow id="S4.SS1.p6.3.m3.3.3" xref="S4.SS1.p6.3.m3.3.3.cmml"><mrow id="S4.SS1.p6.3.m3.3.3.1.1" xref="S4.SS1.p6.3.m3.3.3.1.2.cmml"><mi id="S4.SS1.p6.3.m3.2.2" xref="S4.SS1.p6.3.m3.2.2.cmml">k</mi><mo rspace="0.497em" id="S4.SS1.p6.3.m3.3.3.1.1.2" xref="S4.SS1.p6.3.m3.3.3.1.2.cmml">,</mo><mrow id="S4.SS1.p6.3.m3.3.3.1.1.1" xref="S4.SS1.p6.3.m3.3.3.1.1.1.cmml"><mo rspace="0.167em" id="S4.SS1.p6.3.m3.3.3.1.1.1.1" xref="S4.SS1.p6.3.m3.3.3.1.1.1.1.cmml">∀</mo><mi id="S4.SS1.p6.3.m3.3.3.1.1.1.2" xref="S4.SS1.p6.3.m3.3.3.1.1.1.2.cmml">k</mi></mrow></mrow><mo id="S4.SS1.p6.3.m3.3.3.2" xref="S4.SS1.p6.3.m3.3.3.2.cmml">∈</mo><mrow id="S4.SS1.p6.3.m3.3.3.3.2" xref="S4.SS1.p6.3.m3.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p6.3.m3.3.3.3.2.1" xref="S4.SS1.p6.3.m3.3.3.3.1.1.cmml">[</mo><mi id="S4.SS1.p6.3.m3.1.1" xref="S4.SS1.p6.3.m3.1.1.cmml">K</mi><mo stretchy="false" id="S4.SS1.p6.3.m3.3.3.3.2.2" xref="S4.SS1.p6.3.m3.3.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.3.m3.3b"><apply id="S4.SS1.p6.3.m3.3.3.cmml" xref="S4.SS1.p6.3.m3.3.3"><in id="S4.SS1.p6.3.m3.3.3.2.cmml" xref="S4.SS1.p6.3.m3.3.3.2"></in><list id="S4.SS1.p6.3.m3.3.3.1.2.cmml" xref="S4.SS1.p6.3.m3.3.3.1.1"><ci id="S4.SS1.p6.3.m3.2.2.cmml" xref="S4.SS1.p6.3.m3.2.2">𝑘</ci><apply id="S4.SS1.p6.3.m3.3.3.1.1.1.cmml" xref="S4.SS1.p6.3.m3.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS1.p6.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS1.p6.3.m3.3.3.1.1.1.1">for-all</csymbol><ci id="S4.SS1.p6.3.m3.3.3.1.1.1.2.cmml" xref="S4.SS1.p6.3.m3.3.3.1.1.1.2">𝑘</ci></apply></list><apply id="S4.SS1.p6.3.m3.3.3.3.1.cmml" xref="S4.SS1.p6.3.m3.3.3.3.2"><csymbol cd="latexml" id="S4.SS1.p6.3.m3.3.3.3.1.1.cmml" xref="S4.SS1.p6.3.m3.3.3.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.p6.3.m3.1.1.cmml" xref="S4.SS1.p6.3.m3.1.1">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.3.m3.3c">k,~{}\forall k\in[K]</annotation></semantics></math>, we define the loss function for generalization in Eq. (<a href="#S4.E6" title="In 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>), where the <span id="S4.SS1.p6.3.2" class="ltx_text" style="color:#FF8000;">orange</span> term is for balanced feature loss and the <span id="S4.SS1.p6.3.3" class="ltx_text" style="color:#0000FF;">blue</span> term is for learnable temperature.</p>
<table id="A3.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.13" class="ltx_Math" alttext="\displaystyle\small\ell^{g}(\mathbf{w},\mathbf{V}_{ETF};\mathbf{x},y)=-\log\frac{{\color[rgb]{1,.5,0}n_{k,y}^{\gamma}}\exp({\color[rgb]{0,0,1}\beta}\cdot\mathbf{v}_{y}^{T}\boldsymbol{\mu})}{\sum_{c\in[C]}{\color[rgb]{1,.5,0}n_{k,c}^{\gamma}}\exp({\color[rgb]{0,0,1}\beta}\cdot\mathbf{v}_{c}^{T}\boldsymbol{\mu})}," display="inline"><semantics id="S4.E6.m1.13a"><mrow id="S4.E6.m1.13.13.1" xref="S4.E6.m1.13.13.1.1.cmml"><mrow id="S4.E6.m1.13.13.1.1" xref="S4.E6.m1.13.13.1.1.cmml"><mrow id="S4.E6.m1.13.13.1.1.1" xref="S4.E6.m1.13.13.1.1.1.cmml"><msup id="S4.E6.m1.13.13.1.1.1.3" xref="S4.E6.m1.13.13.1.1.1.3.cmml"><mi mathsize="90%" mathvariant="normal" id="S4.E6.m1.13.13.1.1.1.3.2" xref="S4.E6.m1.13.13.1.1.1.3.2.cmml">ℓ</mi><mi mathsize="90%" id="S4.E6.m1.13.13.1.1.1.3.3" xref="S4.E6.m1.13.13.1.1.1.3.3.cmml">g</mi></msup><mo lspace="0em" rspace="0em" id="S4.E6.m1.13.13.1.1.1.2" xref="S4.E6.m1.13.13.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.13.13.1.1.1.1.1" xref="S4.E6.m1.13.13.1.1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.2" xref="S4.E6.m1.13.13.1.1.1.1.2.cmml">(</mo><mi mathsize="90%" id="S4.E6.m1.10.10" xref="S4.E6.m1.10.10.cmml">𝐰</mi><mo mathsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.3" xref="S4.E6.m1.13.13.1.1.1.1.2.cmml">,</mo><msub id="S4.E6.m1.13.13.1.1.1.1.1.1" xref="S4.E6.m1.13.13.1.1.1.1.1.1.cmml"><mi mathsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.1.2" xref="S4.E6.m1.13.13.1.1.1.1.1.1.2.cmml">𝐕</mi><mrow id="S4.E6.m1.13.13.1.1.1.1.1.1.3" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.cmml"><mi mathsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.1.3.2" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.13.13.1.1.1.1.1.1.3.1" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.1.3.3" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.13.13.1.1.1.1.1.1.3.1a" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.1.3.4" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.4.cmml">F</mi></mrow></msub><mo mathsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.4" xref="S4.E6.m1.13.13.1.1.1.1.2.cmml">;</mo><mi mathsize="90%" id="S4.E6.m1.11.11" xref="S4.E6.m1.11.11.cmml">𝐱</mi><mo mathsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.5" xref="S4.E6.m1.13.13.1.1.1.1.2.cmml">,</mo><mi mathsize="90%" id="S4.E6.m1.12.12" xref="S4.E6.m1.12.12.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S4.E6.m1.13.13.1.1.1.1.1.6" xref="S4.E6.m1.13.13.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S4.E6.m1.13.13.1.1.2" xref="S4.E6.m1.13.13.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.13.13.1.1.3" xref="S4.E6.m1.13.13.1.1.3.cmml"><mo mathsize="90%" rspace="0.167em" id="S4.E6.m1.13.13.1.1.3a" xref="S4.E6.m1.13.13.1.1.3.cmml">−</mo><mrow id="S4.E6.m1.13.13.1.1.3.2" xref="S4.E6.m1.13.13.1.1.3.2.cmml"><mi mathsize="90%" id="S4.E6.m1.13.13.1.1.3.2.1" xref="S4.E6.m1.13.13.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S4.E6.m1.13.13.1.1.3.2a" xref="S4.E6.m1.13.13.1.1.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S4.E6.m1.9.9" xref="S4.E6.m1.9.9.cmml"><mfrac id="S4.E6.m1.9.9a" xref="S4.E6.m1.9.9.cmml"><mrow id="S4.E6.m1.4.4.4" xref="S4.E6.m1.4.4.4.cmml"><msubsup id="S4.E6.m1.4.4.4.6" xref="S4.E6.m1.4.4.4.6.cmml"><mi mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.4.4.4.6.2.2" xref="S4.E6.m1.4.4.4.6.2.2.cmml">n</mi><mrow id="S4.E6.m1.2.2.2.2.2.4" xref="S4.E6.m1.2.2.2.2.2.3.cmml"><mi mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml">k</mi><mo mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.2.2.2.2.2.4.1" xref="S4.E6.m1.2.2.2.2.2.3.cmml">,</mo><mi mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.2.2.2.2.2.2" xref="S4.E6.m1.2.2.2.2.2.2.cmml">y</mi></mrow><mi mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.4.4.4.6.3" xref="S4.E6.m1.4.4.4.6.3.cmml">γ</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S4.E6.m1.4.4.4.5" xref="S4.E6.m1.4.4.4.5.cmml">​</mo><mrow id="S4.E6.m1.4.4.4.4.1" xref="S4.E6.m1.4.4.4.4.2.cmml"><mi mathsize="90%" id="S4.E6.m1.3.3.3.3" xref="S4.E6.m1.3.3.3.3.cmml">exp</mi><mo id="S4.E6.m1.4.4.4.4.1a" xref="S4.E6.m1.4.4.4.4.2.cmml">⁡</mo><mrow id="S4.E6.m1.4.4.4.4.1.1" xref="S4.E6.m1.4.4.4.4.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E6.m1.4.4.4.4.1.1.2" xref="S4.E6.m1.4.4.4.4.2.cmml">(</mo><mrow id="S4.E6.m1.4.4.4.4.1.1.1" xref="S4.E6.m1.4.4.4.4.1.1.1.cmml"><mrow id="S4.E6.m1.4.4.4.4.1.1.1.2" xref="S4.E6.m1.4.4.4.4.1.1.1.2.cmml"><mi mathcolor="#0000FF" mathsize="90%" id="S4.E6.m1.4.4.4.4.1.1.1.2.2" xref="S4.E6.m1.4.4.4.4.1.1.1.2.2.cmml">β</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S4.E6.m1.4.4.4.4.1.1.1.2.1" xref="S4.E6.m1.4.4.4.4.1.1.1.2.1.cmml">⋅</mo><msubsup id="S4.E6.m1.4.4.4.4.1.1.1.2.3" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3.cmml"><mi mathsize="90%" id="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.2" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.2.cmml">𝐯</mi><mi mathsize="90%" id="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.3" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.3.cmml">y</mi><mi mathsize="90%" id="S4.E6.m1.4.4.4.4.1.1.1.2.3.3" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S4.E6.m1.4.4.4.4.1.1.1.1" xref="S4.E6.m1.4.4.4.4.1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.4.4.4.4.1.1.1.3" xref="S4.E6.m1.4.4.4.4.1.1.1.3.cmml">𝝁</mi></mrow><mo maxsize="90%" minsize="90%" id="S4.E6.m1.4.4.4.4.1.1.3" xref="S4.E6.m1.4.4.4.4.2.cmml">)</mo></mrow></mrow></mrow><mrow id="S4.E6.m1.9.9.9" xref="S4.E6.m1.9.9.9.cmml"><msub id="S4.E6.m1.9.9.9.6" xref="S4.E6.m1.9.9.9.6.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="S4.E6.m1.9.9.9.6.2" xref="S4.E6.m1.9.9.9.6.2.cmml">∑</mo><mrow id="S4.E6.m1.5.5.5.1.1" xref="S4.E6.m1.5.5.5.1.1.cmml"><mi mathsize="90%" id="S4.E6.m1.5.5.5.1.1.3" xref="S4.E6.m1.5.5.5.1.1.3.cmml">c</mi><mo mathsize="90%" id="S4.E6.m1.5.5.5.1.1.2" xref="S4.E6.m1.5.5.5.1.1.2.cmml">∈</mo><mrow id="S4.E6.m1.5.5.5.1.1.4.2" xref="S4.E6.m1.5.5.5.1.1.4.1.cmml"><mo maxsize="90%" minsize="90%" id="S4.E6.m1.5.5.5.1.1.4.2.1" xref="S4.E6.m1.5.5.5.1.1.4.1.1.cmml">[</mo><mi mathsize="90%" id="S4.E6.m1.5.5.5.1.1.1" xref="S4.E6.m1.5.5.5.1.1.1.cmml">C</mi><mo maxsize="90%" minsize="90%" id="S4.E6.m1.5.5.5.1.1.4.2.2" xref="S4.E6.m1.5.5.5.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mrow id="S4.E6.m1.9.9.9.5" xref="S4.E6.m1.9.9.9.5.cmml"><msubsup id="S4.E6.m1.9.9.9.5.3" xref="S4.E6.m1.9.9.9.5.3.cmml"><mi mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.9.9.9.5.3.2.2" xref="S4.E6.m1.9.9.9.5.3.2.2.cmml">n</mi><mrow id="S4.E6.m1.7.7.7.3.2.4" xref="S4.E6.m1.7.7.7.3.2.3.cmml"><mi mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.6.6.6.2.1.1" xref="S4.E6.m1.6.6.6.2.1.1.cmml">k</mi><mo mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.7.7.7.3.2.4.1" xref="S4.E6.m1.7.7.7.3.2.3.cmml">,</mo><mi mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.7.7.7.3.2.2" xref="S4.E6.m1.7.7.7.3.2.2.cmml">c</mi></mrow><mi mathcolor="#FF8000" mathsize="90%" id="S4.E6.m1.9.9.9.5.3.3" xref="S4.E6.m1.9.9.9.5.3.3.cmml">γ</mi></msubsup><mo lspace="0.167em" rspace="0em" id="S4.E6.m1.9.9.9.5.2" xref="S4.E6.m1.9.9.9.5.2.cmml">​</mo><mrow id="S4.E6.m1.9.9.9.5.1.1" xref="S4.E6.m1.9.9.9.5.1.2.cmml"><mi mathsize="90%" id="S4.E6.m1.8.8.8.4" xref="S4.E6.m1.8.8.8.4.cmml">exp</mi><mo id="S4.E6.m1.9.9.9.5.1.1a" xref="S4.E6.m1.9.9.9.5.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.9.9.9.5.1.1.1" xref="S4.E6.m1.9.9.9.5.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S4.E6.m1.9.9.9.5.1.1.1.2" xref="S4.E6.m1.9.9.9.5.1.2.cmml">(</mo><mrow id="S4.E6.m1.9.9.9.5.1.1.1.1" xref="S4.E6.m1.9.9.9.5.1.1.1.1.cmml"><mrow id="S4.E6.m1.9.9.9.5.1.1.1.1.2" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.cmml"><mi mathcolor="#0000FF" mathsize="90%" id="S4.E6.m1.9.9.9.5.1.1.1.1.2.2" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.2.cmml">β</mi><mo lspace="0.222em" mathsize="90%" rspace="0.222em" id="S4.E6.m1.9.9.9.5.1.1.1.1.2.1" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.1.cmml">⋅</mo><msubsup id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.cmml"><mi mathsize="90%" id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.2" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.2.cmml">𝐯</mi><mi mathsize="90%" id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.3" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.3.cmml">c</mi><mi mathsize="90%" id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.3" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S4.E6.m1.9.9.9.5.1.1.1.1.1" xref="S4.E6.m1.9.9.9.5.1.1.1.1.1.cmml">​</mo><mi mathsize="90%" id="S4.E6.m1.9.9.9.5.1.1.1.1.3" xref="S4.E6.m1.9.9.9.5.1.1.1.1.3.cmml">𝝁</mi></mrow><mo maxsize="90%" minsize="90%" id="S4.E6.m1.9.9.9.5.1.1.1.3" xref="S4.E6.m1.9.9.9.5.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo mathsize="90%" id="S4.E6.m1.13.13.1.2" xref="S4.E6.m1.13.13.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.13b"><apply id="S4.E6.m1.13.13.1.1.cmml" xref="S4.E6.m1.13.13.1"><eq id="S4.E6.m1.13.13.1.1.2.cmml" xref="S4.E6.m1.13.13.1.1.2"></eq><apply id="S4.E6.m1.13.13.1.1.1.cmml" xref="S4.E6.m1.13.13.1.1.1"><times id="S4.E6.m1.13.13.1.1.1.2.cmml" xref="S4.E6.m1.13.13.1.1.1.2"></times><apply id="S4.E6.m1.13.13.1.1.1.3.cmml" xref="S4.E6.m1.13.13.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.13.13.1.1.1.3.1.cmml" xref="S4.E6.m1.13.13.1.1.1.3">superscript</csymbol><ci id="S4.E6.m1.13.13.1.1.1.3.2.cmml" xref="S4.E6.m1.13.13.1.1.1.3.2">ℓ</ci><ci id="S4.E6.m1.13.13.1.1.1.3.3.cmml" xref="S4.E6.m1.13.13.1.1.1.3.3">𝑔</ci></apply><vector id="S4.E6.m1.13.13.1.1.1.1.2.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1"><ci id="S4.E6.m1.10.10.cmml" xref="S4.E6.m1.10.10">𝐰</ci><apply id="S4.E6.m1.13.13.1.1.1.1.1.1.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.13.13.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.13.13.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1.1.2">𝐕</ci><apply id="S4.E6.m1.13.13.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3"><times id="S4.E6.m1.13.13.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.1"></times><ci id="S4.E6.m1.13.13.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S4.E6.m1.13.13.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.3">𝑇</ci><ci id="S4.E6.m1.13.13.1.1.1.1.1.1.3.4.cmml" xref="S4.E6.m1.13.13.1.1.1.1.1.1.3.4">𝐹</ci></apply></apply><ci id="S4.E6.m1.11.11.cmml" xref="S4.E6.m1.11.11">𝐱</ci><ci id="S4.E6.m1.12.12.cmml" xref="S4.E6.m1.12.12">𝑦</ci></vector></apply><apply id="S4.E6.m1.13.13.1.1.3.cmml" xref="S4.E6.m1.13.13.1.1.3"><minus id="S4.E6.m1.13.13.1.1.3.1.cmml" xref="S4.E6.m1.13.13.1.1.3"></minus><apply id="S4.E6.m1.13.13.1.1.3.2.cmml" xref="S4.E6.m1.13.13.1.1.3.2"><log id="S4.E6.m1.13.13.1.1.3.2.1.cmml" xref="S4.E6.m1.13.13.1.1.3.2.1"></log><apply id="S4.E6.m1.9.9.cmml" xref="S4.E6.m1.9.9"><divide id="S4.E6.m1.9.9.10.cmml" xref="S4.E6.m1.9.9"></divide><apply id="S4.E6.m1.4.4.4.cmml" xref="S4.E6.m1.4.4.4"><times id="S4.E6.m1.4.4.4.5.cmml" xref="S4.E6.m1.4.4.4.5"></times><apply id="S4.E6.m1.4.4.4.6.cmml" xref="S4.E6.m1.4.4.4.6"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.6.1.cmml" xref="S4.E6.m1.4.4.4.6">superscript</csymbol><apply id="S4.E6.m1.4.4.4.6.2.cmml" xref="S4.E6.m1.4.4.4.6"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.6.2.1.cmml" xref="S4.E6.m1.4.4.4.6">subscript</csymbol><ci id="S4.E6.m1.4.4.4.6.2.2.cmml" xref="S4.E6.m1.4.4.4.6.2.2">𝑛</ci><list id="S4.E6.m1.2.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.2.4"><ci id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1">𝑘</ci><ci id="S4.E6.m1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.2.2">𝑦</ci></list></apply><ci id="S4.E6.m1.4.4.4.6.3.cmml" xref="S4.E6.m1.4.4.4.6.3">𝛾</ci></apply><apply id="S4.E6.m1.4.4.4.4.2.cmml" xref="S4.E6.m1.4.4.4.4.1"><exp id="S4.E6.m1.3.3.3.3.cmml" xref="S4.E6.m1.3.3.3.3"></exp><apply id="S4.E6.m1.4.4.4.4.1.1.1.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1"><times id="S4.E6.m1.4.4.4.4.1.1.1.1.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.1"></times><apply id="S4.E6.m1.4.4.4.4.1.1.1.2.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2"><ci id="S4.E6.m1.4.4.4.4.1.1.1.2.1.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.1">⋅</ci><ci id="S4.E6.m1.4.4.4.4.1.1.1.2.2.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.2">𝛽</ci><apply id="S4.E6.m1.4.4.4.4.1.1.1.2.3.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.4.1.1.1.2.3.1.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3">superscript</csymbol><apply id="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.1.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3">subscript</csymbol><ci id="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.2.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.2">𝐯</ci><ci id="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.3.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3.2.3">𝑦</ci></apply><ci id="S4.E6.m1.4.4.4.4.1.1.1.2.3.3.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S4.E6.m1.4.4.4.4.1.1.1.3.cmml" xref="S4.E6.m1.4.4.4.4.1.1.1.3">𝝁</ci></apply></apply></apply><apply id="S4.E6.m1.9.9.9.cmml" xref="S4.E6.m1.9.9.9"><apply id="S4.E6.m1.9.9.9.6.cmml" xref="S4.E6.m1.9.9.9.6"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.9.6.1.cmml" xref="S4.E6.m1.9.9.9.6">subscript</csymbol><sum id="S4.E6.m1.9.9.9.6.2.cmml" xref="S4.E6.m1.9.9.9.6.2"></sum><apply id="S4.E6.m1.5.5.5.1.1.cmml" xref="S4.E6.m1.5.5.5.1.1"><in id="S4.E6.m1.5.5.5.1.1.2.cmml" xref="S4.E6.m1.5.5.5.1.1.2"></in><ci id="S4.E6.m1.5.5.5.1.1.3.cmml" xref="S4.E6.m1.5.5.5.1.1.3">𝑐</ci><apply id="S4.E6.m1.5.5.5.1.1.4.1.cmml" xref="S4.E6.m1.5.5.5.1.1.4.2"><csymbol cd="latexml" id="S4.E6.m1.5.5.5.1.1.4.1.1.cmml" xref="S4.E6.m1.5.5.5.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.E6.m1.5.5.5.1.1.1.cmml" xref="S4.E6.m1.5.5.5.1.1.1">𝐶</ci></apply></apply></apply><apply id="S4.E6.m1.9.9.9.5.cmml" xref="S4.E6.m1.9.9.9.5"><times id="S4.E6.m1.9.9.9.5.2.cmml" xref="S4.E6.m1.9.9.9.5.2"></times><apply id="S4.E6.m1.9.9.9.5.3.cmml" xref="S4.E6.m1.9.9.9.5.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.9.5.3.1.cmml" xref="S4.E6.m1.9.9.9.5.3">superscript</csymbol><apply id="S4.E6.m1.9.9.9.5.3.2.cmml" xref="S4.E6.m1.9.9.9.5.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.9.5.3.2.1.cmml" xref="S4.E6.m1.9.9.9.5.3">subscript</csymbol><ci id="S4.E6.m1.9.9.9.5.3.2.2.cmml" xref="S4.E6.m1.9.9.9.5.3.2.2">𝑛</ci><list id="S4.E6.m1.7.7.7.3.2.3.cmml" xref="S4.E6.m1.7.7.7.3.2.4"><ci id="S4.E6.m1.6.6.6.2.1.1.cmml" xref="S4.E6.m1.6.6.6.2.1.1">𝑘</ci><ci id="S4.E6.m1.7.7.7.3.2.2.cmml" xref="S4.E6.m1.7.7.7.3.2.2">𝑐</ci></list></apply><ci id="S4.E6.m1.9.9.9.5.3.3.cmml" xref="S4.E6.m1.9.9.9.5.3.3">𝛾</ci></apply><apply id="S4.E6.m1.9.9.9.5.1.2.cmml" xref="S4.E6.m1.9.9.9.5.1.1"><exp id="S4.E6.m1.8.8.8.4.cmml" xref="S4.E6.m1.8.8.8.4"></exp><apply id="S4.E6.m1.9.9.9.5.1.1.1.1.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1"><times id="S4.E6.m1.9.9.9.5.1.1.1.1.1.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.1"></times><apply id="S4.E6.m1.9.9.9.5.1.1.1.1.2.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2"><ci id="S4.E6.m1.9.9.9.5.1.1.1.1.2.1.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.1">⋅</ci><ci id="S4.E6.m1.9.9.9.5.1.1.1.1.2.2.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.2">𝛽</ci><apply id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.1.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3">superscript</csymbol><apply id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.1.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3">subscript</csymbol><ci id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.2.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.2">𝐯</ci><ci id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.3.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.2.3">𝑐</ci></apply><ci id="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.3.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S4.E6.m1.9.9.9.5.1.1.1.1.3.cmml" xref="S4.E6.m1.9.9.9.5.1.1.1.1.3">𝝁</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.13c">\displaystyle\small\ell^{g}(\mathbf{w},\mathbf{V}_{ETF};\mathbf{x},y)=-\log\frac{{\color[rgb]{1,.5,0}n_{k,y}^{\gamma}}\exp({\color[rgb]{0,0,1}\beta}\cdot\mathbf{v}_{y}^{T}\boldsymbol{\mu})}{\sum_{c\in[C]}{\color[rgb]{1,.5,0}n_{k,c}^{\gamma}}\exp({\color[rgb]{0,0,1}\beta}\cdot\mathbf{v}_{c}^{T}\boldsymbol{\mu})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p6.13" class="ltx_p">where <math id="S4.SS1.p6.4.m1.2" class="ltx_Math" alttext="n_{k,c}" display="inline"><semantics id="S4.SS1.p6.4.m1.2a"><msub id="S4.SS1.p6.4.m1.2.3" xref="S4.SS1.p6.4.m1.2.3.cmml"><mi id="S4.SS1.p6.4.m1.2.3.2" xref="S4.SS1.p6.4.m1.2.3.2.cmml">n</mi><mrow id="S4.SS1.p6.4.m1.2.2.2.4" xref="S4.SS1.p6.4.m1.2.2.2.3.cmml"><mi id="S4.SS1.p6.4.m1.1.1.1.1" xref="S4.SS1.p6.4.m1.1.1.1.1.cmml">k</mi><mo id="S4.SS1.p6.4.m1.2.2.2.4.1" xref="S4.SS1.p6.4.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p6.4.m1.2.2.2.2" xref="S4.SS1.p6.4.m1.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.4.m1.2b"><apply id="S4.SS1.p6.4.m1.2.3.cmml" xref="S4.SS1.p6.4.m1.2.3"><csymbol cd="ambiguous" id="S4.SS1.p6.4.m1.2.3.1.cmml" xref="S4.SS1.p6.4.m1.2.3">subscript</csymbol><ci id="S4.SS1.p6.4.m1.2.3.2.cmml" xref="S4.SS1.p6.4.m1.2.3.2">𝑛</ci><list id="S4.SS1.p6.4.m1.2.2.2.3.cmml" xref="S4.SS1.p6.4.m1.2.2.2.4"><ci id="S4.SS1.p6.4.m1.1.1.1.1.cmml" xref="S4.SS1.p6.4.m1.1.1.1.1">𝑘</ci><ci id="S4.SS1.p6.4.m1.2.2.2.2.cmml" xref="S4.SS1.p6.4.m1.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.4.m1.2c">n_{k,c}</annotation></semantics></math> refers to the number of samples in class <math id="S4.SS1.p6.5.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p6.5.m2.1a"><mi id="S4.SS1.p6.5.m2.1.1" xref="S4.SS1.p6.5.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.5.m2.1b"><ci id="S4.SS1.p6.5.m2.1.1.cmml" xref="S4.SS1.p6.5.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.5.m2.1c">c</annotation></semantics></math> of client <math id="S4.SS1.p6.6.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p6.6.m3.1a"><mi id="S4.SS1.p6.6.m3.1.1" xref="S4.SS1.p6.6.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.6.m3.1b"><ci id="S4.SS1.p6.6.m3.1.1.cmml" xref="S4.SS1.p6.6.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.6.m3.1c">k</annotation></semantics></math>, <math id="S4.SS1.p6.7.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p6.7.m4.1a"><mi id="S4.SS1.p6.7.m4.1.1" xref="S4.SS1.p6.7.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.7.m4.1b"><ci id="S4.SS1.p6.7.m4.1.1.cmml" xref="S4.SS1.p6.7.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.7.m4.1c">\beta</annotation></semantics></math> is the learnable temperature, <math id="S4.SS1.p6.8.m5.1" class="ltx_Math" alttext="\boldsymbol{\mu}" display="inline"><semantics id="S4.SS1.p6.8.m5.1a"><mi id="S4.SS1.p6.8.m5.1.1" xref="S4.SS1.p6.8.m5.1.1.cmml">𝝁</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.8.m5.1b"><ci id="S4.SS1.p6.8.m5.1.1.cmml" xref="S4.SS1.p6.8.m5.1.1">𝝁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.8.m5.1c">\boldsymbol{\mu}</annotation></semantics></math> is the normalized feature in Eq. (<a href="#S4.E5" title="In 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), <math id="S4.SS1.p6.9.m6.1" class="ltx_Math" alttext="\mathbf{v}_{c}" display="inline"><semantics id="S4.SS1.p6.9.m6.1a"><msub id="S4.SS1.p6.9.m6.1.1" xref="S4.SS1.p6.9.m6.1.1.cmml"><mi id="S4.SS1.p6.9.m6.1.1.2" xref="S4.SS1.p6.9.m6.1.1.2.cmml">𝐯</mi><mi id="S4.SS1.p6.9.m6.1.1.3" xref="S4.SS1.p6.9.m6.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.9.m6.1b"><apply id="S4.SS1.p6.9.m6.1.1.cmml" xref="S4.SS1.p6.9.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.9.m6.1.1.1.cmml" xref="S4.SS1.p6.9.m6.1.1">subscript</csymbol><ci id="S4.SS1.p6.9.m6.1.1.2.cmml" xref="S4.SS1.p6.9.m6.1.1.2">𝐯</ci><ci id="S4.SS1.p6.9.m6.1.1.3.cmml" xref="S4.SS1.p6.9.m6.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.9.m6.1c">\mathbf{v}_{c}</annotation></semantics></math> is the class <math id="S4.SS1.p6.10.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p6.10.m7.1a"><mi id="S4.SS1.p6.10.m7.1.1" xref="S4.SS1.p6.10.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.10.m7.1b"><ci id="S4.SS1.p6.10.m7.1.1.cmml" xref="S4.SS1.p6.10.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.10.m7.1c">c</annotation></semantics></math>’s classifier vector in <math id="S4.SS1.p6.11.m8.1" class="ltx_Math" alttext="\mathbf{V}_{ETF}" display="inline"><semantics id="S4.SS1.p6.11.m8.1a"><msub id="S4.SS1.p6.11.m8.1.1" xref="S4.SS1.p6.11.m8.1.1.cmml"><mi id="S4.SS1.p6.11.m8.1.1.2" xref="S4.SS1.p6.11.m8.1.1.2.cmml">𝐕</mi><mrow id="S4.SS1.p6.11.m8.1.1.3" xref="S4.SS1.p6.11.m8.1.1.3.cmml"><mi id="S4.SS1.p6.11.m8.1.1.3.2" xref="S4.SS1.p6.11.m8.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p6.11.m8.1.1.3.1" xref="S4.SS1.p6.11.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p6.11.m8.1.1.3.3" xref="S4.SS1.p6.11.m8.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p6.11.m8.1.1.3.1a" xref="S4.SS1.p6.11.m8.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p6.11.m8.1.1.3.4" xref="S4.SS1.p6.11.m8.1.1.3.4.cmml">F</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.11.m8.1b"><apply id="S4.SS1.p6.11.m8.1.1.cmml" xref="S4.SS1.p6.11.m8.1.1"><csymbol cd="ambiguous" id="S4.SS1.p6.11.m8.1.1.1.cmml" xref="S4.SS1.p6.11.m8.1.1">subscript</csymbol><ci id="S4.SS1.p6.11.m8.1.1.2.cmml" xref="S4.SS1.p6.11.m8.1.1.2">𝐕</ci><apply id="S4.SS1.p6.11.m8.1.1.3.cmml" xref="S4.SS1.p6.11.m8.1.1.3"><times id="S4.SS1.p6.11.m8.1.1.3.1.cmml" xref="S4.SS1.p6.11.m8.1.1.3.1"></times><ci id="S4.SS1.p6.11.m8.1.1.3.2.cmml" xref="S4.SS1.p6.11.m8.1.1.3.2">𝐸</ci><ci id="S4.SS1.p6.11.m8.1.1.3.3.cmml" xref="S4.SS1.p6.11.m8.1.1.3.3">𝑇</ci><ci id="S4.SS1.p6.11.m8.1.1.3.4.cmml" xref="S4.SS1.p6.11.m8.1.1.3.4">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.11.m8.1c">\mathbf{V}_{ETF}</annotation></semantics></math>, and <math id="S4.SS1.p6.12.m9.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p6.12.m9.1a"><mi id="S4.SS1.p6.12.m9.1.1" xref="S4.SS1.p6.12.m9.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.12.m9.1b"><ci id="S4.SS1.p6.12.m9.1.1.cmml" xref="S4.SS1.p6.12.m9.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.12.m9.1c">\gamma</annotation></semantics></math> is the hyperparameter for balanced loss. Below, we give the learning objective of client <math id="S4.SS1.p6.13.m10.3" class="ltx_Math" alttext="k,~{}\forall k\in[K]" display="inline"><semantics id="S4.SS1.p6.13.m10.3a"><mrow id="S4.SS1.p6.13.m10.3.3" xref="S4.SS1.p6.13.m10.3.3.cmml"><mrow id="S4.SS1.p6.13.m10.3.3.1.1" xref="S4.SS1.p6.13.m10.3.3.1.2.cmml"><mi id="S4.SS1.p6.13.m10.2.2" xref="S4.SS1.p6.13.m10.2.2.cmml">k</mi><mo rspace="0.497em" id="S4.SS1.p6.13.m10.3.3.1.1.2" xref="S4.SS1.p6.13.m10.3.3.1.2.cmml">,</mo><mrow id="S4.SS1.p6.13.m10.3.3.1.1.1" xref="S4.SS1.p6.13.m10.3.3.1.1.1.cmml"><mo rspace="0.167em" id="S4.SS1.p6.13.m10.3.3.1.1.1.1" xref="S4.SS1.p6.13.m10.3.3.1.1.1.1.cmml">∀</mo><mi id="S4.SS1.p6.13.m10.3.3.1.1.1.2" xref="S4.SS1.p6.13.m10.3.3.1.1.1.2.cmml">k</mi></mrow></mrow><mo id="S4.SS1.p6.13.m10.3.3.2" xref="S4.SS1.p6.13.m10.3.3.2.cmml">∈</mo><mrow id="S4.SS1.p6.13.m10.3.3.3.2" xref="S4.SS1.p6.13.m10.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p6.13.m10.3.3.3.2.1" xref="S4.SS1.p6.13.m10.3.3.3.1.1.cmml">[</mo><mi id="S4.SS1.p6.13.m10.1.1" xref="S4.SS1.p6.13.m10.1.1.cmml">K</mi><mo stretchy="false" id="S4.SS1.p6.13.m10.3.3.3.2.2" xref="S4.SS1.p6.13.m10.3.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p6.13.m10.3b"><apply id="S4.SS1.p6.13.m10.3.3.cmml" xref="S4.SS1.p6.13.m10.3.3"><in id="S4.SS1.p6.13.m10.3.3.2.cmml" xref="S4.SS1.p6.13.m10.3.3.2"></in><list id="S4.SS1.p6.13.m10.3.3.1.2.cmml" xref="S4.SS1.p6.13.m10.3.3.1.1"><ci id="S4.SS1.p6.13.m10.2.2.cmml" xref="S4.SS1.p6.13.m10.2.2">𝑘</ci><apply id="S4.SS1.p6.13.m10.3.3.1.1.1.cmml" xref="S4.SS1.p6.13.m10.3.3.1.1.1"><csymbol cd="latexml" id="S4.SS1.p6.13.m10.3.3.1.1.1.1.cmml" xref="S4.SS1.p6.13.m10.3.3.1.1.1.1">for-all</csymbol><ci id="S4.SS1.p6.13.m10.3.3.1.1.1.2.cmml" xref="S4.SS1.p6.13.m10.3.3.1.1.1.2">𝑘</ci></apply></list><apply id="S4.SS1.p6.13.m10.3.3.3.1.cmml" xref="S4.SS1.p6.13.m10.3.3.3.2"><csymbol cd="latexml" id="S4.SS1.p6.13.m10.3.3.3.1.1.cmml" xref="S4.SS1.p6.13.m10.3.3.3.2.1">delimited-[]</csymbol><ci id="S4.SS1.p6.13.m10.1.1.cmml" xref="S4.SS1.p6.13.m10.1.1">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p6.13.m10.3c">k,~{}\forall k\in[K]</annotation></semantics></math>, and solve the objective by SGD in Eq. (<a href="#S3.E1" title="In 3.1 Federated Learning ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
<table id="A3.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E7.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{w}_{k}^{t}" display="inline"><semantics id="S4.E7.m1.1a"><msubsup id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><mi id="S4.E7.m1.1.1.2.2" xref="S4.E7.m1.1.1.2.2.cmml">𝐰</mi><mi id="S4.E7.m1.1.1.2.3" xref="S4.E7.m1.1.1.2.3.cmml">k</mi><mi id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.cmml" xref="S4.E7.m1.1.1">superscript</csymbol><apply id="S4.E7.m1.1.1.2.cmml" xref="S4.E7.m1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.2.1.cmml" xref="S4.E7.m1.1.1">subscript</csymbol><ci id="S4.E7.m1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.2.2">𝐰</ci><ci id="S4.E7.m1.1.1.2.3.cmml" xref="S4.E7.m1.1.1.2.3">𝑘</ci></apply><ci id="S4.E7.m1.1.1.3.cmml" xref="S4.E7.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">\displaystyle\mathbf{w}_{k}^{t}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E7.m2.2" class="ltx_Math" alttext="\displaystyle=\arg\min_{\mathbf{w}}\mathcal{L}_{k}^{g}(\mathbf{w})," display="inline"><semantics id="S4.E7.m2.2a"><mrow id="S4.E7.m2.2.2.1" xref="S4.E7.m2.2.2.1.1.cmml"><mrow id="S4.E7.m2.2.2.1.1" xref="S4.E7.m2.2.2.1.1.cmml"><mi id="S4.E7.m2.2.2.1.1.2" xref="S4.E7.m2.2.2.1.1.2.cmml"></mi><mo id="S4.E7.m2.2.2.1.1.1" xref="S4.E7.m2.2.2.1.1.1.cmml">=</mo><mrow id="S4.E7.m2.2.2.1.1.3" xref="S4.E7.m2.2.2.1.1.3.cmml"><mrow id="S4.E7.m2.2.2.1.1.3.2" xref="S4.E7.m2.2.2.1.1.3.2.cmml"><mi id="S4.E7.m2.2.2.1.1.3.2.1" xref="S4.E7.m2.2.2.1.1.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E7.m2.2.2.1.1.3.2a" xref="S4.E7.m2.2.2.1.1.3.2.cmml">⁡</mo><mrow id="S4.E7.m2.2.2.1.1.3.2.2" xref="S4.E7.m2.2.2.1.1.3.2.2.cmml"><munder id="S4.E7.m2.2.2.1.1.3.2.2.1" xref="S4.E7.m2.2.2.1.1.3.2.2.1.cmml"><mi id="S4.E7.m2.2.2.1.1.3.2.2.1.2" xref="S4.E7.m2.2.2.1.1.3.2.2.1.2.cmml">min</mi><mi id="S4.E7.m2.2.2.1.1.3.2.2.1.3" xref="S4.E7.m2.2.2.1.1.3.2.2.1.3.cmml">𝐰</mi></munder><mo lspace="0.167em" id="S4.E7.m2.2.2.1.1.3.2.2a" xref="S4.E7.m2.2.2.1.1.3.2.2.cmml">⁡</mo><msubsup id="S4.E7.m2.2.2.1.1.3.2.2.2" xref="S4.E7.m2.2.2.1.1.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m2.2.2.1.1.3.2.2.2.2.2" xref="S4.E7.m2.2.2.1.1.3.2.2.2.2.2.cmml">ℒ</mi><mi id="S4.E7.m2.2.2.1.1.3.2.2.2.2.3" xref="S4.E7.m2.2.2.1.1.3.2.2.2.2.3.cmml">k</mi><mi id="S4.E7.m2.2.2.1.1.3.2.2.2.3" xref="S4.E7.m2.2.2.1.1.3.2.2.2.3.cmml">g</mi></msubsup></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E7.m2.2.2.1.1.3.1" xref="S4.E7.m2.2.2.1.1.3.1.cmml">​</mo><mrow id="S4.E7.m2.2.2.1.1.3.3.2" xref="S4.E7.m2.2.2.1.1.3.cmml"><mo stretchy="false" id="S4.E7.m2.2.2.1.1.3.3.2.1" xref="S4.E7.m2.2.2.1.1.3.cmml">(</mo><mi id="S4.E7.m2.1.1" xref="S4.E7.m2.1.1.cmml">𝐰</mi><mo stretchy="false" id="S4.E7.m2.2.2.1.1.3.3.2.2" xref="S4.E7.m2.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m2.2.2.1.2" xref="S4.E7.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m2.2b"><apply id="S4.E7.m2.2.2.1.1.cmml" xref="S4.E7.m2.2.2.1"><eq id="S4.E7.m2.2.2.1.1.1.cmml" xref="S4.E7.m2.2.2.1.1.1"></eq><csymbol cd="latexml" id="S4.E7.m2.2.2.1.1.2.cmml" xref="S4.E7.m2.2.2.1.1.2">absent</csymbol><apply id="S4.E7.m2.2.2.1.1.3.cmml" xref="S4.E7.m2.2.2.1.1.3"><times id="S4.E7.m2.2.2.1.1.3.1.cmml" xref="S4.E7.m2.2.2.1.1.3.1"></times><apply id="S4.E7.m2.2.2.1.1.3.2.cmml" xref="S4.E7.m2.2.2.1.1.3.2"><arg id="S4.E7.m2.2.2.1.1.3.2.1.cmml" xref="S4.E7.m2.2.2.1.1.3.2.1"></arg><apply id="S4.E7.m2.2.2.1.1.3.2.2.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2"><apply id="S4.E7.m2.2.2.1.1.3.2.2.1.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.1"><csymbol cd="ambiguous" id="S4.E7.m2.2.2.1.1.3.2.2.1.1.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.1">subscript</csymbol><min id="S4.E7.m2.2.2.1.1.3.2.2.1.2.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.1.2"></min><ci id="S4.E7.m2.2.2.1.1.3.2.2.1.3.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.1.3">𝐰</ci></apply><apply id="S4.E7.m2.2.2.1.1.3.2.2.2.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m2.2.2.1.1.3.2.2.2.1.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.2">superscript</csymbol><apply id="S4.E7.m2.2.2.1.1.3.2.2.2.2.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m2.2.2.1.1.3.2.2.2.2.1.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E7.m2.2.2.1.1.3.2.2.2.2.2.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.2.2.2">ℒ</ci><ci id="S4.E7.m2.2.2.1.1.3.2.2.2.2.3.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.2.2.3">𝑘</ci></apply><ci id="S4.E7.m2.2.2.1.1.3.2.2.2.3.cmml" xref="S4.E7.m2.2.2.1.1.3.2.2.2.3">𝑔</ci></apply></apply></apply><ci id="S4.E7.m2.1.1.cmml" xref="S4.E7.m2.1.1">𝐰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m2.2c">\displaystyle=\arg\min_{\mathbf{w}}\mathcal{L}_{k}^{g}(\mathbf{w}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\displaystyle\text{where }\mathcal{L}_{k}^{g}(\mathbf{w})" display="inline"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.2" xref="S4.E8.m1.1.2.cmml"><mtext id="S4.E8.m1.1.2.2" xref="S4.E8.m1.1.2.2a.cmml">where </mtext><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.2.1" xref="S4.E8.m1.1.2.1.cmml">​</mo><msubsup id="S4.E8.m1.1.2.3" xref="S4.E8.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.1.2.3.2.2" xref="S4.E8.m1.1.2.3.2.2.cmml">ℒ</mi><mi id="S4.E8.m1.1.2.3.2.3" xref="S4.E8.m1.1.2.3.2.3.cmml">k</mi><mi id="S4.E8.m1.1.2.3.3" xref="S4.E8.m1.1.2.3.3.cmml">g</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.2.1a" xref="S4.E8.m1.1.2.1.cmml">​</mo><mrow id="S4.E8.m1.1.2.4.2" xref="S4.E8.m1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.1.2.4.2.1" xref="S4.E8.m1.1.2.cmml">(</mo><mi id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">𝐰</mi><mo stretchy="false" id="S4.E8.m1.1.2.4.2.2" xref="S4.E8.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.2.cmml" xref="S4.E8.m1.1.2"><times id="S4.E8.m1.1.2.1.cmml" xref="S4.E8.m1.1.2.1"></times><ci id="S4.E8.m1.1.2.2a.cmml" xref="S4.E8.m1.1.2.2"><mtext id="S4.E8.m1.1.2.2.cmml" xref="S4.E8.m1.1.2.2">where </mtext></ci><apply id="S4.E8.m1.1.2.3.cmml" xref="S4.E8.m1.1.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.2.3.1.cmml" xref="S4.E8.m1.1.2.3">superscript</csymbol><apply id="S4.E8.m1.1.2.3.2.cmml" xref="S4.E8.m1.1.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.2.3.2.1.cmml" xref="S4.E8.m1.1.2.3">subscript</csymbol><ci id="S4.E8.m1.1.2.3.2.2.cmml" xref="S4.E8.m1.1.2.3.2.2">ℒ</ci><ci id="S4.E8.m1.1.2.3.2.3.cmml" xref="S4.E8.m1.1.2.3.2.3">𝑘</ci></apply><ci id="S4.E8.m1.1.2.3.3.cmml" xref="S4.E8.m1.1.2.3.3">𝑔</ci></apply><ci id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\displaystyle\text{where }\mathcal{L}_{k}^{g}(\mathbf{w})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E8.m2.4" class="ltx_Math" alttext="\displaystyle=\frac{1}{n_{k}}\sum_{(\mathbf{x}_{i},y_{i})\in\mathcal{D}_{k}}\ell^{g}(\mathbf{w},\mathbf{V}_{ETF};\mathbf{x}_{i},y_{i})." display="inline"><semantics id="S4.E8.m2.4a"><mrow id="S4.E8.m2.4.4.1" xref="S4.E8.m2.4.4.1.1.cmml"><mrow id="S4.E8.m2.4.4.1.1" xref="S4.E8.m2.4.4.1.1.cmml"><mi id="S4.E8.m2.4.4.1.1.5" xref="S4.E8.m2.4.4.1.1.5.cmml"></mi><mo id="S4.E8.m2.4.4.1.1.4" xref="S4.E8.m2.4.4.1.1.4.cmml">=</mo><mrow id="S4.E8.m2.4.4.1.1.3" xref="S4.E8.m2.4.4.1.1.3.cmml"><mstyle displaystyle="true" id="S4.E8.m2.4.4.1.1.3.5" xref="S4.E8.m2.4.4.1.1.3.5.cmml"><mfrac id="S4.E8.m2.4.4.1.1.3.5a" xref="S4.E8.m2.4.4.1.1.3.5.cmml"><mn id="S4.E8.m2.4.4.1.1.3.5.2" xref="S4.E8.m2.4.4.1.1.3.5.2.cmml">1</mn><msub id="S4.E8.m2.4.4.1.1.3.5.3" xref="S4.E8.m2.4.4.1.1.3.5.3.cmml"><mi id="S4.E8.m2.4.4.1.1.3.5.3.2" xref="S4.E8.m2.4.4.1.1.3.5.3.2.cmml">n</mi><mi id="S4.E8.m2.4.4.1.1.3.5.3.3" xref="S4.E8.m2.4.4.1.1.3.5.3.3.cmml">k</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E8.m2.4.4.1.1.3.4" xref="S4.E8.m2.4.4.1.1.3.4.cmml">​</mo><mrow id="S4.E8.m2.4.4.1.1.3.3" xref="S4.E8.m2.4.4.1.1.3.3.cmml"><mstyle displaystyle="true" id="S4.E8.m2.4.4.1.1.3.3.4" xref="S4.E8.m2.4.4.1.1.3.3.4.cmml"><munder id="S4.E8.m2.4.4.1.1.3.3.4a" xref="S4.E8.m2.4.4.1.1.3.3.4.cmml"><mo movablelimits="false" id="S4.E8.m2.4.4.1.1.3.3.4.2" xref="S4.E8.m2.4.4.1.1.3.3.4.2.cmml">∑</mo><mrow id="S4.E8.m2.2.2.2" xref="S4.E8.m2.2.2.2.cmml"><mrow id="S4.E8.m2.2.2.2.2.2" xref="S4.E8.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E8.m2.2.2.2.2.2.3" xref="S4.E8.m2.2.2.2.2.3.cmml">(</mo><msub id="S4.E8.m2.1.1.1.1.1.1" xref="S4.E8.m2.1.1.1.1.1.1.cmml"><mi id="S4.E8.m2.1.1.1.1.1.1.2" xref="S4.E8.m2.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.E8.m2.1.1.1.1.1.1.3" xref="S4.E8.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E8.m2.2.2.2.2.2.4" xref="S4.E8.m2.2.2.2.2.3.cmml">,</mo><msub id="S4.E8.m2.2.2.2.2.2.2" xref="S4.E8.m2.2.2.2.2.2.2.cmml"><mi id="S4.E8.m2.2.2.2.2.2.2.2" xref="S4.E8.m2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E8.m2.2.2.2.2.2.2.3" xref="S4.E8.m2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E8.m2.2.2.2.2.2.5" xref="S4.E8.m2.2.2.2.2.3.cmml">)</mo></mrow><mo id="S4.E8.m2.2.2.2.3" xref="S4.E8.m2.2.2.2.3.cmml">∈</mo><msub id="S4.E8.m2.2.2.2.4" xref="S4.E8.m2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m2.2.2.2.4.2" xref="S4.E8.m2.2.2.2.4.2.cmml">𝒟</mi><mi id="S4.E8.m2.2.2.2.4.3" xref="S4.E8.m2.2.2.2.4.3.cmml">k</mi></msub></mrow></munder></mstyle><mrow id="S4.E8.m2.4.4.1.1.3.3.3" xref="S4.E8.m2.4.4.1.1.3.3.3.cmml"><msup id="S4.E8.m2.4.4.1.1.3.3.3.5" xref="S4.E8.m2.4.4.1.1.3.3.3.5.cmml"><mi mathvariant="normal" id="S4.E8.m2.4.4.1.1.3.3.3.5.2" xref="S4.E8.m2.4.4.1.1.3.3.3.5.2.cmml">ℓ</mi><mi id="S4.E8.m2.4.4.1.1.3.3.3.5.3" xref="S4.E8.m2.4.4.1.1.3.3.3.5.3.cmml">g</mi></msup><mo lspace="0em" rspace="0em" id="S4.E8.m2.4.4.1.1.3.3.3.4" xref="S4.E8.m2.4.4.1.1.3.3.3.4.cmml">​</mo><mrow id="S4.E8.m2.4.4.1.1.3.3.3.3.3" xref="S4.E8.m2.4.4.1.1.3.3.3.3.4.cmml"><mo stretchy="false" id="S4.E8.m2.4.4.1.1.3.3.3.3.3.4" xref="S4.E8.m2.4.4.1.1.3.3.3.3.4.cmml">(</mo><mi id="S4.E8.m2.3.3" xref="S4.E8.m2.3.3.cmml">𝐰</mi><mo id="S4.E8.m2.4.4.1.1.3.3.3.3.3.5" xref="S4.E8.m2.4.4.1.1.3.3.3.3.4.cmml">,</mo><msub id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.2.cmml">𝐕</mi><mrow id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.2" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.1" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.3" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.1a" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.4" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.4.cmml">F</mi></mrow></msub><mo id="S4.E8.m2.4.4.1.1.3.3.3.3.3.6" xref="S4.E8.m2.4.4.1.1.3.3.3.3.4.cmml">;</mo><msub id="S4.E8.m2.4.4.1.1.2.2.2.2.2.2" xref="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.2" xref="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.2.cmml">𝐱</mi><mi id="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.3" xref="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.E8.m2.4.4.1.1.3.3.3.3.3.7" xref="S4.E8.m2.4.4.1.1.3.3.3.3.4.cmml">,</mo><msub id="S4.E8.m2.4.4.1.1.3.3.3.3.3.3" xref="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.cmml"><mi id="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.2" xref="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.2.cmml">y</mi><mi id="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.3" xref="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E8.m2.4.4.1.1.3.3.3.3.3.8" xref="S4.E8.m2.4.4.1.1.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E8.m2.4.4.1.2" xref="S4.E8.m2.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m2.4b"><apply id="S4.E8.m2.4.4.1.1.cmml" xref="S4.E8.m2.4.4.1"><eq id="S4.E8.m2.4.4.1.1.4.cmml" xref="S4.E8.m2.4.4.1.1.4"></eq><csymbol cd="latexml" id="S4.E8.m2.4.4.1.1.5.cmml" xref="S4.E8.m2.4.4.1.1.5">absent</csymbol><apply id="S4.E8.m2.4.4.1.1.3.cmml" xref="S4.E8.m2.4.4.1.1.3"><times id="S4.E8.m2.4.4.1.1.3.4.cmml" xref="S4.E8.m2.4.4.1.1.3.4"></times><apply id="S4.E8.m2.4.4.1.1.3.5.cmml" xref="S4.E8.m2.4.4.1.1.3.5"><divide id="S4.E8.m2.4.4.1.1.3.5.1.cmml" xref="S4.E8.m2.4.4.1.1.3.5"></divide><cn type="integer" id="S4.E8.m2.4.4.1.1.3.5.2.cmml" xref="S4.E8.m2.4.4.1.1.3.5.2">1</cn><apply id="S4.E8.m2.4.4.1.1.3.5.3.cmml" xref="S4.E8.m2.4.4.1.1.3.5.3"><csymbol cd="ambiguous" id="S4.E8.m2.4.4.1.1.3.5.3.1.cmml" xref="S4.E8.m2.4.4.1.1.3.5.3">subscript</csymbol><ci id="S4.E8.m2.4.4.1.1.3.5.3.2.cmml" xref="S4.E8.m2.4.4.1.1.3.5.3.2">𝑛</ci><ci id="S4.E8.m2.4.4.1.1.3.5.3.3.cmml" xref="S4.E8.m2.4.4.1.1.3.5.3.3">𝑘</ci></apply></apply><apply id="S4.E8.m2.4.4.1.1.3.3.cmml" xref="S4.E8.m2.4.4.1.1.3.3"><apply id="S4.E8.m2.4.4.1.1.3.3.4.cmml" xref="S4.E8.m2.4.4.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.E8.m2.4.4.1.1.3.3.4.1.cmml" xref="S4.E8.m2.4.4.1.1.3.3.4">subscript</csymbol><sum id="S4.E8.m2.4.4.1.1.3.3.4.2.cmml" xref="S4.E8.m2.4.4.1.1.3.3.4.2"></sum><apply id="S4.E8.m2.2.2.2.cmml" xref="S4.E8.m2.2.2.2"><in id="S4.E8.m2.2.2.2.3.cmml" xref="S4.E8.m2.2.2.2.3"></in><interval closure="open" id="S4.E8.m2.2.2.2.2.3.cmml" xref="S4.E8.m2.2.2.2.2.2"><apply id="S4.E8.m2.1.1.1.1.1.1.cmml" xref="S4.E8.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m2.1.1.1.1.1.1.1.cmml" xref="S4.E8.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m2.1.1.1.1.1.1.2.cmml" xref="S4.E8.m2.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.E8.m2.1.1.1.1.1.1.3.cmml" xref="S4.E8.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E8.m2.2.2.2.2.2.2.cmml" xref="S4.E8.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m2.2.2.2.2.2.2.1.cmml" xref="S4.E8.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E8.m2.2.2.2.2.2.2.2.cmml" xref="S4.E8.m2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E8.m2.2.2.2.2.2.2.3.cmml" xref="S4.E8.m2.2.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S4.E8.m2.2.2.2.4.cmml" xref="S4.E8.m2.2.2.2.4"><csymbol cd="ambiguous" id="S4.E8.m2.2.2.2.4.1.cmml" xref="S4.E8.m2.2.2.2.4">subscript</csymbol><ci id="S4.E8.m2.2.2.2.4.2.cmml" xref="S4.E8.m2.2.2.2.4.2">𝒟</ci><ci id="S4.E8.m2.2.2.2.4.3.cmml" xref="S4.E8.m2.2.2.2.4.3">𝑘</ci></apply></apply></apply><apply id="S4.E8.m2.4.4.1.1.3.3.3.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3"><times id="S4.E8.m2.4.4.1.1.3.3.3.4.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.4"></times><apply id="S4.E8.m2.4.4.1.1.3.3.3.5.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.5"><csymbol cd="ambiguous" id="S4.E8.m2.4.4.1.1.3.3.3.5.1.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.5">superscript</csymbol><ci id="S4.E8.m2.4.4.1.1.3.3.3.5.2.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.5.2">ℓ</ci><ci id="S4.E8.m2.4.4.1.1.3.3.3.5.3.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.5.3">𝑔</ci></apply><vector id="S4.E8.m2.4.4.1.1.3.3.3.3.4.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.3.3"><ci id="S4.E8.m2.3.3.cmml" xref="S4.E8.m2.3.3">𝐰</ci><apply id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.2">𝐕</ci><apply id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3"><times id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.2">𝐸</ci><ci id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.3">𝑇</ci><ci id="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E8.m2.4.4.1.1.1.1.1.1.1.1.3.4">𝐹</ci></apply></apply><apply id="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.cmml" xref="S4.E8.m2.4.4.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E8.m2.4.4.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.2">𝐱</ci><ci id="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E8.m2.4.4.1.1.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.1.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.3.3.3">subscript</csymbol><ci id="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.2.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.2">𝑦</ci><ci id="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.3.cmml" xref="S4.E8.m2.4.4.1.1.3.3.3.3.3.3.3">𝑖</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m2.4c">\displaystyle=\frac{1}{n_{k}}\sum_{(\mathbf{x}_{i},y_{i})\in\mathcal{D}_{k}}\ell^{g}(\mathbf{w},\mathbf{V}_{ETF};\mathbf{x}_{i},y_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p6.14" class="ltx_p">We adopt the vanilla aggregation strategy on the server, formulated in Eq. (<a href="#S3.E2" title="In 3.1 Federated Learning ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). The pseudo code of the proposed <span id="S4.SS1.p6.14.1" class="ltx_text ltx_font_smallcaps">FedETF</span> is shown in Algorithm 1 in Appendix.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2303.10058/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="207" height="152" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.2.1" class="ltx_text ltx_font_bold">Local finetuning stage of proposed <span id="S4.F3.2.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span> for personalization.</span> This stage is after the whole FL training stage when clients receive the final global model. For each client, we first finetune the feature extractor and then we finetune the ETF prototypical classifier and projection layer alternately.</figcaption>
</figure>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 1: </span><span id="S4.T1.7.1" class="ltx_text ltx_font_bold">Results in terms of generalization (General.) accuracy (%) of global models and personalization (Personal.) accuracy (%) of local models on three datasets under different heterogeneity.</span> Best two methods in each setting are highlighted in <span id="S4.T1.8.2" class="ltx_text ltx_font_bold">bold</span> fonts.</figcaption>
<div id="S4.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:148.1pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-127.3pt,43.3pt) scale(0.630148389455854,0.630148389455854) ;">
<table id="S4.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt"><span id="S4.T1.1.1.2.1.1.1" class="ltx_text" style="font-size:80%;">Dataset</span></th>
<td id="S4.T1.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S4.T1.1.1.2.1.2.1" class="ltx_text" style="font-size:80%;">CIFAR-10</span></td>
<td id="S4.T1.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S4.T1.1.1.2.1.3.1" class="ltx_text" style="font-size:80%;">CIFAR-100</span></td>
<td id="S4.T1.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="S4.T1.1.1.2.1.4.1" class="ltx_text" style="font-size:80%;">Tiny-ImageNet</span></td>
</tr>
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.1.1.1" class="ltx_text" style="font-size:80%;">NonIID (</span><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mi mathsize="80%" id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\alpha</annotation></semantics></math><span id="S4.T1.1.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span>
</th>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.1.1.1.2.1" class="ltx_text" style="font-size:80%;">0.1</span></td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.1.1.1.3.1" class="ltx_text" style="font-size:80%;">0.05</span></td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.1.1.1.4.1" class="ltx_text" style="font-size:80%;">0.1</span></td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.1.1.1.5.1" class="ltx_text" style="font-size:80%;">0.05</span></td>
<td id="S4.T1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.1.1.1.6.1" class="ltx_text" style="font-size:80%;">0.1</span></td>
<td id="S4.T1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_t" colspan="2"><span id="S4.T1.1.1.1.7.1" class="ltx_text" style="font-size:80%;">0.05</span></td>
</tr>
<tr id="S4.T1.1.1.3.2" class="ltx_tr">
<th id="S4.T1.1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S4.T1.1.1.3.2.1.1" class="ltx_text" style="font-size:80%;">Methods/Metrics</span></th>
<td id="S4.T1.1.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.3.2.2.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S4.T1.1.1.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.1.3.2.3.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S4.T1.1.1.3.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.3.2.4.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S4.T1.1.1.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.1.3.2.5.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S4.T1.1.1.3.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.3.2.6.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S4.T1.1.1.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.1.3.2.7.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S4.T1.1.1.3.2.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.3.2.8.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S4.T1.1.1.3.2.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.1.3.2.9.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S4.T1.1.1.3.2.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.3.2.10.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S4.T1.1.1.3.2.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.1.3.2.11.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S4.T1.1.1.3.2.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.3.2.12.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S4.T1.1.1.3.2.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.3.2.13.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
</tr>
<tr id="S4.T1.1.1.4.3" class="ltx_tr">
<th id="S4.T1.1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.4.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedAvg</span><span id="S4.T1.1.1.4.3.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.4.3.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib33" title="" class="ltx_ref">33</a><span id="S4.T1.1.1.4.3.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.4.3.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.4.3.2.1" class="ltx_text" style="font-size:80%;">52.76</span><span id="S4.T1.1.1.4.3.2.2" class="ltx_text" style="font-size:50%;">±6.08</span>
</td>
<td id="S4.T1.1.1.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.4.3.3.1" class="ltx_text" style="font-size:80%;">83.85</span><span id="S4.T1.1.1.4.3.3.2" class="ltx_text" style="font-size:50%;">±0.89</span>
</td>
<td id="S4.T1.1.1.4.3.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.4.3.4.1" class="ltx_text" style="font-size:80%;">44.48</span><span id="S4.T1.1.1.4.3.4.2" class="ltx_text" style="font-size:50%;">±6.19</span>
</td>
<td id="S4.T1.1.1.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.4.3.5.1" class="ltx_text" style="font-size:80%;">89.80</span><span id="S4.T1.1.1.4.3.5.2" class="ltx_text" style="font-size:50%;">±0.39</span>
</td>
<td id="S4.T1.1.1.4.3.6" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.4.3.6.1" class="ltx_text" style="font-size:80%;">24.77</span><span id="S4.T1.1.1.4.3.6.2" class="ltx_text" style="font-size:50%;">±1.19</span>
</td>
<td id="S4.T1.1.1.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.4.3.7.1" class="ltx_text" style="font-size:80%;">49.93</span><span id="S4.T1.1.1.4.3.7.2" class="ltx_text" style="font-size:50%;">±1.17</span>
</td>
<td id="S4.T1.1.1.4.3.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.4.3.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">22.53<span id="S4.T1.1.1.4.3.8.1.1" class="ltx_text" style="font-size:63%;">±0.40</span></span></td>
<td id="S4.T1.1.1.4.3.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.4.3.9.1" class="ltx_text" style="font-size:80%;">58.85</span><span id="S4.T1.1.1.4.3.9.2" class="ltx_text" style="font-size:50%;">±0.33</span>
</td>
<td id="S4.T1.1.1.4.3.10" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.4.3.10.1" class="ltx_text" style="font-size:80%;">28.93</span><span id="S4.T1.1.1.4.3.10.2" class="ltx_text" style="font-size:50%;">±0.52</span>
</td>
<td id="S4.T1.1.1.4.3.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.4.3.11.1" class="ltx_text" style="font-size:80%;">40.81</span><span id="S4.T1.1.1.4.3.11.2" class="ltx_text" style="font-size:50%;">±0.35</span>
</td>
<td id="S4.T1.1.1.4.3.12" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.4.3.12.1" class="ltx_text" style="font-size:80%;">24.88</span><span id="S4.T1.1.1.4.3.12.2" class="ltx_text" style="font-size:50%;">±0.34</span>
</td>
<td id="S4.T1.1.1.4.3.13" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.4.3.13.1" class="ltx_text" style="font-size:80%;">46.90</span><span id="S4.T1.1.1.4.3.13.2" class="ltx_text" style="font-size:50%;">±0.44</span>
</td>
</tr>
<tr id="S4.T1.1.1.5.4" class="ltx_tr">
<th id="S4.T1.1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.5.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedProx</span><span id="S4.T1.1.1.5.4.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.5.4.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib25" title="" class="ltx_ref">25</a><span id="S4.T1.1.1.5.4.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.5.4.2.1" class="ltx_text" style="font-size:80%;">46.59</span><span id="S4.T1.1.1.5.4.2.2" class="ltx_text" style="font-size:50%;">±3.04</span>
</td>
<td id="S4.T1.1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.5.4.3.1" class="ltx_text" style="font-size:80%;">82.08</span><span id="S4.T1.1.1.5.4.3.2" class="ltx_text" style="font-size:50%;">±0.27</span>
</td>
<td id="S4.T1.1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.5.4.4.1" class="ltx_text" style="font-size:80%;">40.95</span><span id="S4.T1.1.1.5.4.4.2" class="ltx_text" style="font-size:50%;">±5.75</span>
</td>
<td id="S4.T1.1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.5.4.5.1" class="ltx_text" style="font-size:80%;">87.69</span><span id="S4.T1.1.1.5.4.5.2" class="ltx_text" style="font-size:50%;">±2.85</span>
</td>
<td id="S4.T1.1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.5.4.6.1" class="ltx_text" style="font-size:80%;">23.33</span><span id="S4.T1.1.1.5.4.6.2" class="ltx_text" style="font-size:50%;">±1.72</span>
</td>
<td id="S4.T1.1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.5.4.7.1" class="ltx_text" style="font-size:80%;">46.44</span><span id="S4.T1.1.1.5.4.7.2" class="ltx_text" style="font-size:50%;">±1.64</span>
</td>
<td id="S4.T1.1.1.5.4.8" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.5.4.8.1" class="ltx_text" style="font-size:80%;">19.12</span><span id="S4.T1.1.1.5.4.8.2" class="ltx_text" style="font-size:50%;">±0.77</span>
</td>
<td id="S4.T1.1.1.5.4.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.5.4.9.1" class="ltx_text" style="font-size:80%;">57.01</span><span id="S4.T1.1.1.5.4.9.2" class="ltx_text" style="font-size:50%;">±2.17</span>
</td>
<td id="S4.T1.1.1.5.4.10" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.5.4.10.1" class="ltx_text" style="font-size:80%;">25.93</span><span id="S4.T1.1.1.5.4.10.2" class="ltx_text" style="font-size:50%;">±0.27</span>
</td>
<td id="S4.T1.1.1.5.4.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.5.4.11.1" class="ltx_text" style="font-size:80%;">31.90</span><span id="S4.T1.1.1.5.4.11.2" class="ltx_text" style="font-size:50%;">±1.91</span>
</td>
<td id="S4.T1.1.1.5.4.12" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.5.4.12.1" class="ltx_text" style="font-size:80%;">23.06</span><span id="S4.T1.1.1.5.4.12.2" class="ltx_text" style="font-size:50%;">±0.68</span>
</td>
<td id="S4.T1.1.1.5.4.13" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.5.4.13.1" class="ltx_text" style="font-size:80%;">32.43</span><span id="S4.T1.1.1.5.4.13.2" class="ltx_text" style="font-size:50%;">±0.65</span>
</td>
</tr>
<tr id="S4.T1.1.1.6.5" class="ltx_tr">
<th id="S4.T1.1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T1.1.1.6.5.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedDyn</span><span id="S4.T1.1.1.6.5.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.6.5.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S4.T1.1.1.6.5.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.6.5.2" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.6.5.2.1" class="ltx_text" style="font-size:80%;">36.35</span><span id="S4.T1.1.1.6.5.2.2" class="ltx_text" style="font-size:50%;">±5.33</span>
</td>
<td id="S4.T1.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.6.5.3.1" class="ltx_text" style="font-size:80%;">85.39</span><span id="S4.T1.1.1.6.5.3.2" class="ltx_text" style="font-size:50%;">±0.77</span>
</td>
<td id="S4.T1.1.1.6.5.4" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.6.5.4.1" class="ltx_text" style="font-size:80%;">23.90</span><span id="S4.T1.1.1.6.5.4.2" class="ltx_text" style="font-size:50%;">±1.40</span>
</td>
<td id="S4.T1.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.6.5.5.1" class="ltx_text" style="font-size:80%;">88.72</span><span id="S4.T1.1.1.6.5.5.2" class="ltx_text" style="font-size:50%;">±1.59</span>
</td>
<td id="S4.T1.1.1.6.5.6" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.6.5.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">25.53<span id="S4.T1.1.1.6.5.6.1.1" class="ltx_text" style="font-size:63%;">±2.39</span></span></td>
<td id="S4.T1.1.1.6.5.7" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.6.5.7.1" class="ltx_text" style="font-size:80%;">51.79</span><span id="S4.T1.1.1.6.5.7.2" class="ltx_text" style="font-size:50%;">±2.12</span>
</td>
<td id="S4.T1.1.1.6.5.8" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.6.5.8.1" class="ltx_text" style="font-size:80%;">20.71</span><span id="S4.T1.1.1.6.5.8.2" class="ltx_text" style="font-size:50%;">±2.83</span>
</td>
<td id="S4.T1.1.1.6.5.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.1.1.6.5.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">61.77<span id="S4.T1.1.1.6.5.9.1.1" class="ltx_text" style="font-size:63%;">±0.32</span></span></td>
<td id="S4.T1.1.1.6.5.10" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.6.5.10.1" class="ltx_text" style="font-size:80%;">26.42</span><span id="S4.T1.1.1.6.5.10.2" class="ltx_text" style="font-size:50%;">±0.56</span>
</td>
<td id="S4.T1.1.1.6.5.11" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.6.5.11.1" class="ltx_text" style="font-size:80%;">45.84</span><span id="S4.T1.1.1.6.5.11.2" class="ltx_text" style="font-size:50%;">±0.34</span>
</td>
<td id="S4.T1.1.1.6.5.12" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.6.5.12.1" class="ltx_text" style="font-size:80%;">23.63</span><span id="S4.T1.1.1.6.5.12.2" class="ltx_text" style="font-size:50%;">±1.55</span>
</td>
<td id="S4.T1.1.1.6.5.13" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.6.5.13.1" class="ltx_text" style="font-size:80%;">52.27</span><span id="S4.T1.1.1.6.5.13.2" class="ltx_text" style="font-size:50%;">±1.06</span>
</td>
</tr>
<tr id="S4.T1.1.1.7.6" class="ltx_tr">
<th id="S4.T1.1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.7.6.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">Ditto</span><span id="S4.T1.1.1.7.6.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.7.6.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib24" title="" class="ltx_ref">24</a><span id="S4.T1.1.1.7.6.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.7.6.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.7.6.2.1" class="ltx_text" style="font-size:80%;">52.76</span><span id="S4.T1.1.1.7.6.2.2" class="ltx_text" style="font-size:50%;">±6.08</span>
</td>
<td id="S4.T1.1.1.7.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.7.6.3.1" class="ltx_text" style="font-size:80%;">79.81</span><span id="S4.T1.1.1.7.6.3.2" class="ltx_text" style="font-size:50%;">±1.89</span>
</td>
<td id="S4.T1.1.1.7.6.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.7.6.4.1" class="ltx_text" style="font-size:80%;">44.48</span><span id="S4.T1.1.1.7.6.4.2" class="ltx_text" style="font-size:50%;">±6.19</span>
</td>
<td id="S4.T1.1.1.7.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.7.6.5.1" class="ltx_text" style="font-size:80%;">85.17</span><span id="S4.T1.1.1.7.6.5.2" class="ltx_text" style="font-size:50%;">±3.47</span>
</td>
<td id="S4.T1.1.1.7.6.6" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.7.6.6.1" class="ltx_text" style="font-size:80%;">24.77</span><span id="S4.T1.1.1.7.6.6.2" class="ltx_text" style="font-size:50%;">±1.19</span>
</td>
<td id="S4.T1.1.1.7.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.7.6.7.1" class="ltx_text" style="font-size:80%;">38.06</span><span id="S4.T1.1.1.7.6.7.2" class="ltx_text" style="font-size:50%;">±1.26</span>
</td>
<td id="S4.T1.1.1.7.6.8" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.7.6.8.1" class="ltx_text" style="font-size:80%;">22.53</span><span id="S4.T1.1.1.7.6.8.2" class="ltx_text" style="font-size:50%;">±0.40</span>
</td>
<td id="S4.T1.1.1.7.6.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.7.6.9.1" class="ltx_text" style="font-size:80%;">50.18</span><span id="S4.T1.1.1.7.6.9.2" class="ltx_text" style="font-size:50%;">±1.22</span>
</td>
<td id="S4.T1.1.1.7.6.10" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.7.6.10.1" class="ltx_text" style="font-size:80%;">28.93</span><span id="S4.T1.1.1.7.6.10.2" class="ltx_text" style="font-size:50%;">±0.52</span>
</td>
<td id="S4.T1.1.1.7.6.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.7.6.11.1" class="ltx_text" style="font-size:80%;">33.00</span><span id="S4.T1.1.1.7.6.11.2" class="ltx_text" style="font-size:50%;">±1.01</span>
</td>
<td id="S4.T1.1.1.7.6.12" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.7.6.12.1" class="ltx_text" style="font-size:80%;">24.88</span><span id="S4.T1.1.1.7.6.12.2" class="ltx_text" style="font-size:50%;">±0.34</span>
</td>
<td id="S4.T1.1.1.7.6.13" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.7.6.13.1" class="ltx_text" style="font-size:80%;">40.31</span><span id="S4.T1.1.1.7.6.13.2" class="ltx_text" style="font-size:50%;">±0.12</span>
</td>
</tr>
<tr id="S4.T1.1.1.8.7" class="ltx_tr">
<th id="S4.T1.1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T1.1.1.8.7.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedRep</span><span id="S4.T1.1.1.8.7.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.8.7.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib4" title="" class="ltx_ref">4</a><span id="S4.T1.1.1.8.7.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.8.7.2" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.8.7.2.1" class="ltx_text" style="font-size:80%;">26.85</span><span id="S4.T1.1.1.8.7.2.2" class="ltx_text" style="font-size:50%;">±10.13</span>
</td>
<td id="S4.T1.1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.1.1.8.7.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">87.76<span id="S4.T1.1.1.8.7.3.1.1" class="ltx_text" style="font-size:63%;">±0.87</span></span></td>
<td id="S4.T1.1.1.8.7.4" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.8.7.4.1" class="ltx_text" style="font-size:80%;">15.79</span><span id="S4.T1.1.1.8.7.4.2" class="ltx_text" style="font-size:50%;">±3.68</span>
</td>
<td id="S4.T1.1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.8.7.5.1" class="ltx_text" style="font-size:80%;">90.71</span><span id="S4.T1.1.1.8.7.5.2" class="ltx_text" style="font-size:50%;">±2.25</span>
</td>
<td id="S4.T1.1.1.8.7.6" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.8.7.6.1" class="ltx_text" style="font-size:80%;">5.47</span><span id="S4.T1.1.1.8.7.6.2" class="ltx_text" style="font-size:50%;">±0.20</span>
</td>
<td id="S4.T1.1.1.8.7.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.1.1.8.7.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">53.62<span id="S4.T1.1.1.8.7.7.1.1" class="ltx_text" style="font-size:63%;">±1.49</span></span></td>
<td id="S4.T1.1.1.8.7.8" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.8.7.8.1" class="ltx_text" style="font-size:80%;">4.18</span><span id="S4.T1.1.1.8.7.8.2" class="ltx_text" style="font-size:50%;">±0.85</span>
</td>
<td id="S4.T1.1.1.8.7.9" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.8.7.9.1" class="ltx_text" style="font-size:80%;">61.51</span><span id="S4.T1.1.1.8.7.9.2" class="ltx_text" style="font-size:50%;">±0.61</span>
</td>
<td id="S4.T1.1.1.8.7.10" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.8.7.10.1" class="ltx_text" style="font-size:80%;">4.10</span><span id="S4.T1.1.1.8.7.10.2" class="ltx_text" style="font-size:50%;">±0.22</span>
</td>
<td id="S4.T1.1.1.8.7.11" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.8.7.11.1" class="ltx_text" style="font-size:80%;">43.66</span><span id="S4.T1.1.1.8.7.11.2" class="ltx_text" style="font-size:50%;">±0.48</span>
</td>
<td id="S4.T1.1.1.8.7.12" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.8.7.12.1" class="ltx_text" style="font-size:80%;">2.20</span><span id="S4.T1.1.1.8.7.12.2" class="ltx_text" style="font-size:50%;">±0.19</span>
</td>
<td id="S4.T1.1.1.8.7.13" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.8.7.13.1" class="ltx_text" style="font-size:80%;">49.52</span><span id="S4.T1.1.1.8.7.13.2" class="ltx_text" style="font-size:50%;">±1.64</span>
</td>
</tr>
<tr id="S4.T1.1.1.9.8" class="ltx_tr">
<th id="S4.T1.1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.9.8.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">CCVR</span><span id="S4.T1.1.1.9.8.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.9.8.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">32</a><span id="S4.T1.1.1.9.8.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.9.8.2.1" class="ltx_text" style="font-size:80%;">52.50</span><span id="S4.T1.1.1.9.8.2.2" class="ltx_text" style="font-size:50%;">±6.31</span>
</td>
<td id="S4.T1.1.1.9.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.9.8.3.1" class="ltx_text" style="font-size:80%;">55.62</span><span id="S4.T1.1.1.9.8.3.2" class="ltx_text" style="font-size:50%;">±5.89</span>
</td>
<td id="S4.T1.1.1.9.8.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.9.8.4.1" class="ltx_text" style="font-size:80%;">47.98</span><span id="S4.T1.1.1.9.8.4.2" class="ltx_text" style="font-size:50%;">±6.24</span>
</td>
<td id="S4.T1.1.1.9.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.9.8.5.1" class="ltx_text" style="font-size:80%;">73.52</span><span id="S4.T1.1.1.9.8.5.2" class="ltx_text" style="font-size:50%;">±7.49</span>
</td>
<td id="S4.T1.1.1.9.8.6" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.9.8.6.1" class="ltx_text" style="font-size:80%;">24.54</span><span id="S4.T1.1.1.9.8.6.2" class="ltx_text" style="font-size:50%;">±0.71</span>
</td>
<td id="S4.T1.1.1.9.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.9.8.7.1" class="ltx_text" style="font-size:80%;">34.01</span><span id="S4.T1.1.1.9.8.7.2" class="ltx_text" style="font-size:50%;">±2.01</span>
</td>
<td id="S4.T1.1.1.9.8.8" class="ltx_td ltx_align_center ltx_border_t">
<span id="S4.T1.1.1.9.8.8.1" class="ltx_text" style="font-size:80%;">22.28</span><span id="S4.T1.1.1.9.8.8.2" class="ltx_text" style="font-size:50%;">±0.43</span>
</td>
<td id="S4.T1.1.1.9.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.9.8.9.1" class="ltx_text" style="font-size:80%;">39.16</span><span id="S4.T1.1.1.9.8.9.2" class="ltx_text" style="font-size:50%;">±1.41</span>
</td>
<td id="S4.T1.1.1.9.8.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.9.8.10.1" class="ltx_text ltx_font_bold" style="font-size:80%;">32.78<span id="S4.T1.1.1.9.8.10.1.1" class="ltx_text" style="font-size:63%;">±0.24</span></span></td>
<td id="S4.T1.1.1.9.8.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T1.1.1.9.8.11.1" class="ltx_text ltx_font_bold" style="font-size:80%;">54.00<span id="S4.T1.1.1.9.8.11.1.1" class="ltx_text" style="font-size:63%;">±0.46</span></span></td>
<td id="S4.T1.1.1.9.8.12" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.9.8.12.1" class="ltx_text ltx_font_bold" style="font-size:80%;">29.27<span id="S4.T1.1.1.9.8.12.1.1" class="ltx_text" style="font-size:63%;">±0.25</span></span></td>
<td id="S4.T1.1.1.9.8.13" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.9.8.13.1" class="ltx_text ltx_font_bold" style="font-size:80%;">59.29<span id="S4.T1.1.1.9.8.13.1.1" class="ltx_text" style="font-size:63%;">±0.30</span></span></td>
</tr>
<tr id="S4.T1.1.1.10.9" class="ltx_tr">
<th id="S4.T1.1.1.10.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T1.1.1.10.9.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedProto</span><span id="S4.T1.1.1.10.9.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.10.9.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib40" title="" class="ltx_ref">40</a><span id="S4.T1.1.1.10.9.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.10.9.2" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.2.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S4.T1.1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.10.9.3.1" class="ltx_text" style="font-size:80%;">83.34</span><span id="S4.T1.1.1.10.9.3.2" class="ltx_text" style="font-size:50%;">±0.71</span>
</td>
<td id="S4.T1.1.1.10.9.4" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.4.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S4.T1.1.1.10.9.5" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.10.9.5.1" class="ltx_text" style="font-size:80%;">88.21</span><span id="S4.T1.1.1.10.9.5.2" class="ltx_text" style="font-size:50%;">±1.77</span>
</td>
<td id="S4.T1.1.1.10.9.6" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.6.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S4.T1.1.1.10.9.7" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.10.9.7.1" class="ltx_text" style="font-size:80%;">43.31</span><span id="S4.T1.1.1.10.9.7.2" class="ltx_text" style="font-size:50%;">±0.70</span>
</td>
<td id="S4.T1.1.1.10.9.8" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.8.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S4.T1.1.1.10.9.9" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.10.9.9.1" class="ltx_text" style="font-size:80%;">54.87</span><span id="S4.T1.1.1.10.9.9.2" class="ltx_text" style="font-size:50%;">±0.52</span>
</td>
<td id="S4.T1.1.1.10.9.10" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.10.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S4.T1.1.1.10.9.11" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.10.9.11.1" class="ltx_text" style="font-size:80%;">40.74</span><span id="S4.T1.1.1.10.9.11.2" class="ltx_text" style="font-size:50%;">±0.87</span>
</td>
<td id="S4.T1.1.1.10.9.12" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.10.9.12.1" class="ltx_text" style="font-size:80%;">-</span></td>
<td id="S4.T1.1.1.10.9.13" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.10.9.13.1" class="ltx_text" style="font-size:80%;">48.05</span><span id="S4.T1.1.1.10.9.13.2" class="ltx_text" style="font-size:50%;">±0.82</span>
</td>
</tr>
<tr id="S4.T1.1.1.11.10" class="ltx_tr">
<th id="S4.T1.1.1.11.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T1.1.1.11.10.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedRoD</span><span id="S4.T1.1.1.11.10.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.11.10.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T1.1.1.11.10.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.11.10.2" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.11.10.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">55.72<span id="S4.T1.1.1.11.10.2.1.1" class="ltx_text" style="font-size:63%;">±2.40</span></span></td>
<td id="S4.T1.1.1.11.10.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.11.10.3.1" class="ltx_text" style="font-size:80%;">86.19</span><span id="S4.T1.1.1.11.10.3.2" class="ltx_text" style="font-size:50%;">±0.91</span>
</td>
<td id="S4.T1.1.1.11.10.4" class="ltx_td ltx_align_center"><span id="S4.T1.1.1.11.10.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">49.89<span id="S4.T1.1.1.11.10.4.1.1" class="ltx_text" style="font-size:63%;">±3.64</span></span></td>
<td id="S4.T1.1.1.11.10.5" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.11.10.5.1" class="ltx_text" style="font-size:80%;">88.83</span><span id="S4.T1.1.1.11.10.5.2" class="ltx_text" style="font-size:50%;">±4.14</span>
</td>
<td id="S4.T1.1.1.11.10.6" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.11.10.6.1" class="ltx_text" style="font-size:80%;">24.49</span><span id="S4.T1.1.1.11.10.6.2" class="ltx_text" style="font-size:50%;">±1.05</span>
</td>
<td id="S4.T1.1.1.11.10.7" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.11.10.7.1" class="ltx_text" style="font-size:80%;">51.78</span><span id="S4.T1.1.1.11.10.7.2" class="ltx_text" style="font-size:50%;">±1.16</span>
</td>
<td id="S4.T1.1.1.11.10.8" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.11.10.8.1" class="ltx_text" style="font-size:80%;">21.63</span><span id="S4.T1.1.1.11.10.8.2" class="ltx_text" style="font-size:50%;">±0.42</span>
</td>
<td id="S4.T1.1.1.11.10.9" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.11.10.9.1" class="ltx_text" style="font-size:80%;">59.44</span><span id="S4.T1.1.1.11.10.9.2" class="ltx_text" style="font-size:50%;">±0.45</span>
</td>
<td id="S4.T1.1.1.11.10.10" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.11.10.10.1" class="ltx_text" style="font-size:80%;">32.17</span><span id="S4.T1.1.1.11.10.10.2" class="ltx_text" style="font-size:50%;">±0.41</span>
</td>
<td id="S4.T1.1.1.11.10.11" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.11.10.11.1" class="ltx_text" style="font-size:80%;">38.27</span><span id="S4.T1.1.1.11.10.11.2" class="ltx_text" style="font-size:50%;">±1.00</span>
</td>
<td id="S4.T1.1.1.11.10.12" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.11.10.12.1" class="ltx_text" style="font-size:80%;">28.45</span><span id="S4.T1.1.1.11.10.12.2" class="ltx_text" style="font-size:50%;">±0.58</span>
</td>
<td id="S4.T1.1.1.11.10.13" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.11.10.13.1" class="ltx_text" style="font-size:80%;">44.09</span><span id="S4.T1.1.1.11.10.13.2" class="ltx_text" style="font-size:50%;">±0.44</span>
</td>
</tr>
<tr id="S4.T1.1.1.12.11" class="ltx_tr">
<th id="S4.T1.1.1.12.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S4.T1.1.1.12.11.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedNH</span><span id="S4.T1.1.1.12.11.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.1.12.11.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S4.T1.1.1.12.11.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S4.T1.1.1.12.11.2" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.12.11.2.1" class="ltx_text" style="font-size:80%;">55.37</span><span id="S4.T1.1.1.12.11.2.2" class="ltx_text" style="font-size:50%;">±4.48</span>
</td>
<td id="S4.T1.1.1.12.11.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.12.11.3.1" class="ltx_text" style="font-size:80%;">85.98</span><span id="S4.T1.1.1.12.11.3.2" class="ltx_text" style="font-size:50%;">±0.15</span>
</td>
<td id="S4.T1.1.1.12.11.4" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.12.11.4.1" class="ltx_text" style="font-size:80%;">47.96</span><span id="S4.T1.1.1.12.11.4.2" class="ltx_text" style="font-size:50%;">±2.59</span>
</td>
<td id="S4.T1.1.1.12.11.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.1.1.12.11.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">91.06<span id="S4.T1.1.1.12.11.5.1.1" class="ltx_text" style="font-size:63%;">±3.13</span></span></td>
<td id="S4.T1.1.1.12.11.6" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.12.11.6.1" class="ltx_text" style="font-size:80%;">24.67</span><span id="S4.T1.1.1.12.11.6.2" class="ltx_text" style="font-size:50%;">±0.68</span>
</td>
<td id="S4.T1.1.1.12.11.7" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.12.11.7.1" class="ltx_text" style="font-size:80%;">52.09</span><span id="S4.T1.1.1.12.11.7.2" class="ltx_text" style="font-size:50%;">±0.78</span>
</td>
<td id="S4.T1.1.1.12.11.8" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.12.11.8.1" class="ltx_text" style="font-size:80%;">21.95</span><span id="S4.T1.1.1.12.11.8.2" class="ltx_text" style="font-size:50%;">±0.85</span>
</td>
<td id="S4.T1.1.1.12.11.9" class="ltx_td ltx_align_center ltx_border_r"><span id="S4.T1.1.1.12.11.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">62.71<span id="S4.T1.1.1.12.11.9.1.1" class="ltx_text" style="font-size:63%;">±0.22</span></span></td>
<td id="S4.T1.1.1.12.11.10" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.12.11.10.1" class="ltx_text" style="font-size:80%;">17.51</span><span id="S4.T1.1.1.12.11.10.2" class="ltx_text" style="font-size:50%;">±0.62</span>
</td>
<td id="S4.T1.1.1.12.11.11" class="ltx_td ltx_align_center ltx_border_r">
<span id="S4.T1.1.1.12.11.11.1" class="ltx_text" style="font-size:80%;">36.53</span><span id="S4.T1.1.1.12.11.11.2" class="ltx_text" style="font-size:50%;">±0.29</span>
</td>
<td id="S4.T1.1.1.12.11.12" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.12.11.12.1" class="ltx_text" style="font-size:80%;">14.00</span><span id="S4.T1.1.1.12.11.12.2" class="ltx_text" style="font-size:50%;">±0.17</span>
</td>
<td id="S4.T1.1.1.12.11.13" class="ltx_td ltx_align_center">
<span id="S4.T1.1.1.12.11.13.1" class="ltx_text" style="font-size:80%;">41.80</span><span id="S4.T1.1.1.12.11.13.2" class="ltx_text" style="font-size:50%;">±1.78</span>
</td>
</tr>
<tr id="S4.T1.1.1.13.12" class="ltx_tr">
<th id="S4.T1.1.1.13.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.13.12.1.1" class="ltx_ERROR undefined">\rowcolor</span><span id="S4.T1.1.1.13.12.1.2" class="ltx_text" style="font-size:80%;">gray!20</span><span id="S4.T1.1.1.13.12.1.3" class="ltx_text ltx_font_bold" style="font-size:80%;">Our <span id="S4.T1.1.1.13.12.1.3.1" class="ltx_text ltx_font_smallcaps">FedETF</span></span>
</th>
<td id="S4.T1.1.1.13.12.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.1.1.13.12.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">59.56<span id="S4.T1.1.1.13.12.2.1.1" class="ltx_text" style="font-size:63%;">±1.84</span></span></td>
<td id="S4.T1.1.1.13.12.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T1.1.1.13.12.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">87.89<span id="S4.T1.1.1.13.12.3.1.1" class="ltx_text" style="font-size:63%;">±1.19</span></span></td>
<td id="S4.T1.1.1.13.12.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.1.1.13.12.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">56.08<span id="S4.T1.1.1.13.12.4.1.1" class="ltx_text" style="font-size:63%;">±3.44</span></span></td>
<td id="S4.T1.1.1.13.12.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T1.1.1.13.12.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">92.62<span id="S4.T1.1.1.13.12.5.1.1" class="ltx_text" style="font-size:63%;">±0.54</span></span></td>
<td id="S4.T1.1.1.13.12.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.1.1.13.12.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">26.24<span id="S4.T1.1.1.13.12.6.1.1" class="ltx_text" style="font-size:63%;">±1.78</span></span></td>
<td id="S4.T1.1.1.13.12.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T1.1.1.13.12.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">52.86<span id="S4.T1.1.1.13.12.7.1.1" class="ltx_text" style="font-size:63%;">±1.53</span></span></td>
<td id="S4.T1.1.1.13.12.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.1.1.13.12.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">24.17<span id="S4.T1.1.1.13.12.8.1.1" class="ltx_text" style="font-size:63%;">±0.54</span></span></td>
<td id="S4.T1.1.1.13.12.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">
<span id="S4.T1.1.1.13.12.9.1" class="ltx_text" style="font-size:80%;">60.68</span><span id="S4.T1.1.1.13.12.9.2" class="ltx_text" style="font-size:50%;">±0.91</span>
</td>
<td id="S4.T1.1.1.13.12.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.1.1.13.12.10.1" class="ltx_text ltx_font_bold" style="font-size:80%;">33.49<span id="S4.T1.1.1.13.12.10.1.1" class="ltx_text" style="font-size:63%;">±0.82</span></span></td>
<td id="S4.T1.1.1.13.12.11" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T1.1.1.13.12.11.1" class="ltx_text ltx_font_bold" style="font-size:80%;">55.82<span id="S4.T1.1.1.13.12.11.1.1" class="ltx_text" style="font-size:63%;">±0.60</span></span></td>
<td id="S4.T1.1.1.13.12.12" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.1.1.13.12.12.1" class="ltx_text ltx_font_bold" style="font-size:80%;">29.15<span id="S4.T1.1.1.13.12.12.1.1" class="ltx_text" style="font-size:63%;">±1.03</span></span></td>
<td id="S4.T1.1.1.13.12.13" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><span id="S4.T1.1.1.13.12.13.1" class="ltx_text ltx_font_bold" style="font-size:80%;">62.36<span id="S4.T1.1.1.13.12.13.1.1" class="ltx_text" style="font-size:63%;">±0.13</span></span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x4.png" id="S4.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="115" height="88" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x5.png" id="S4.F4.2.g1" class="ltx_graphics ltx_img_landscape" width="115" height="88" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x6.png" id="S4.F4.3.g1" class="ltx_graphics ltx_img_landscape" width="115" height="88" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x7.png" id="S4.F4.4.g1" class="ltx_graphics ltx_img_landscape" width="115" height="88" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.14.1" class="ltx_text ltx_font_bold">Global models’ test accuracy curves of the methods.</span> (a) CIFAR-10 with <math id="S4.F4.9.m1.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="S4.F4.9.m1.1b"><mrow id="S4.F4.9.m1.1.1" xref="S4.F4.9.m1.1.1.cmml"><mi id="S4.F4.9.m1.1.1.2" xref="S4.F4.9.m1.1.1.2.cmml">α</mi><mo id="S4.F4.9.m1.1.1.1" xref="S4.F4.9.m1.1.1.1.cmml">=</mo><mn id="S4.F4.9.m1.1.1.3" xref="S4.F4.9.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.9.m1.1c"><apply id="S4.F4.9.m1.1.1.cmml" xref="S4.F4.9.m1.1.1"><eq id="S4.F4.9.m1.1.1.1.cmml" xref="S4.F4.9.m1.1.1.1"></eq><ci id="S4.F4.9.m1.1.1.2.cmml" xref="S4.F4.9.m1.1.1.2">𝛼</ci><cn type="float" id="S4.F4.9.m1.1.1.3.cmml" xref="S4.F4.9.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.9.m1.1d">\alpha=0.05</annotation></semantics></math>. (b) CIFAR-100 with <math id="S4.F4.10.m2.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="S4.F4.10.m2.1b"><mrow id="S4.F4.10.m2.1.1" xref="S4.F4.10.m2.1.1.cmml"><mi id="S4.F4.10.m2.1.1.2" xref="S4.F4.10.m2.1.1.2.cmml">α</mi><mo id="S4.F4.10.m2.1.1.1" xref="S4.F4.10.m2.1.1.1.cmml">=</mo><mn id="S4.F4.10.m2.1.1.3" xref="S4.F4.10.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.10.m2.1c"><apply id="S4.F4.10.m2.1.1.cmml" xref="S4.F4.10.m2.1.1"><eq id="S4.F4.10.m2.1.1.1.cmml" xref="S4.F4.10.m2.1.1.1"></eq><ci id="S4.F4.10.m2.1.1.2.cmml" xref="S4.F4.10.m2.1.1.2">𝛼</ci><cn type="float" id="S4.F4.10.m2.1.1.3.cmml" xref="S4.F4.10.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.10.m2.1d">\alpha=0.05</annotation></semantics></math>. (c) CIFAR-10 with <math id="S4.F4.11.m3.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.F4.11.m3.1b"><mrow id="S4.F4.11.m3.1.1" xref="S4.F4.11.m3.1.1.cmml"><mi id="S4.F4.11.m3.1.1.2" xref="S4.F4.11.m3.1.1.2.cmml">α</mi><mo id="S4.F4.11.m3.1.1.1" xref="S4.F4.11.m3.1.1.1.cmml">=</mo><mn id="S4.F4.11.m3.1.1.3" xref="S4.F4.11.m3.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.11.m3.1c"><apply id="S4.F4.11.m3.1.1.cmml" xref="S4.F4.11.m3.1.1"><eq id="S4.F4.11.m3.1.1.1.cmml" xref="S4.F4.11.m3.1.1.1"></eq><ci id="S4.F4.11.m3.1.1.2.cmml" xref="S4.F4.11.m3.1.1.2">𝛼</ci><cn type="float" id="S4.F4.11.m3.1.1.3.cmml" xref="S4.F4.11.m3.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.11.m3.1d">\alpha=0.1</annotation></semantics></math>. (d) CIFAR-100 with <math id="S4.F4.12.m4.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.F4.12.m4.1b"><mrow id="S4.F4.12.m4.1.1" xref="S4.F4.12.m4.1.1.cmml"><mi id="S4.F4.12.m4.1.1.2" xref="S4.F4.12.m4.1.1.2.cmml">α</mi><mo id="S4.F4.12.m4.1.1.1" xref="S4.F4.12.m4.1.1.1.cmml">=</mo><mn id="S4.F4.12.m4.1.1.3" xref="S4.F4.12.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.12.m4.1c"><apply id="S4.F4.12.m4.1.1.cmml" xref="S4.F4.12.m4.1.1"><eq id="S4.F4.12.m4.1.1.1.cmml" xref="S4.F4.12.m4.1.1.1"></eq><ci id="S4.F4.12.m4.1.1.2.cmml" xref="S4.F4.12.m4.1.1.2">𝛼</ci><cn type="float" id="S4.F4.12.m4.1.1.3.cmml" xref="S4.F4.12.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.12.m4.1d">\alpha=0.1</annotation></semantics></math>.
</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Personalized Adaptation by Local Finetuning</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.3" class="ltx_p">As discovered in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, local adaptation of a more generalized global model will reach stronger personalization. We will also verify this finding in our <span id="S4.SS2.p1.3.1" class="ltx_text ltx_font_smallcaps">FedETF</span>. After the FL training, we obtain a global model <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}^{g}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">𝐰</mi><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝐰</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\mathbf{w}^{g}</annotation></semantics></math> with better generalization, and we use <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{w}^{g}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msup id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">𝐰</mi><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝐰</ci><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mathbf{w}^{g}</annotation></semantics></math> as the initialization in each client for personalization. We will show that by our tailored local finetuning of <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{w}^{g}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><msup id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">𝐰</mi><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝐰</ci><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\mathbf{w}^{g}</annotation></semantics></math>, we will also reach the state-of-the-art in personalization.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Our personalized local finetuning consists of two parts: <span id="S4.SS2.p2.1.1" class="ltx_text ltx_font_italic">local feature adaptation</span> and <span id="S4.SS2.p2.1.2" class="ltx_text ltx_font_italic">classifier finetuning</span>.
In the <span id="S4.SS2.p2.1.3" class="ltx_text ltx_font_italic">local feature adaptation</span>, we fix the projection layer and ETF classifier and finetune the feature extractor to let the feature extractor be more customized to the features of clients’ local data.
In the <span id="S4.SS2.p2.1.4" class="ltx_text ltx_font_italic">classifier finetuning period</span>, we finetune the ETF classifier and projection layer alternately for several iterations to make the classifier more biased to the local class distributions. We note that the simplex ETF is not an ideal classifier for local personalization, since the clients may have imbalanced class distributions or even have missing classes. Biased classifiers are needed for personalization to take the local class distributions as prior knowledge and maximize the prediction likelihood. We alternately finetune the ETF classifier and projection layer to make the projected features and classifier vectors converge to be aligned.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.7" class="ltx_p">The process of local finetuning is illustrated in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The learned model parameters in the personalization stage are <math id="S4.SS2.p3.1.m1.4" class="ltx_Math" alttext="\mathbf{w}=\{\mathbf{u},\mathbf{p},\beta,\mathbf{V}_{ETF}\}" display="inline"><semantics id="S4.SS2.p3.1.m1.4a"><mrow id="S4.SS2.p3.1.m1.4.4" xref="S4.SS2.p3.1.m1.4.4.cmml"><mi id="S4.SS2.p3.1.m1.4.4.3" xref="S4.SS2.p3.1.m1.4.4.3.cmml">𝐰</mi><mo id="S4.SS2.p3.1.m1.4.4.2" xref="S4.SS2.p3.1.m1.4.4.2.cmml">=</mo><mrow id="S4.SS2.p3.1.m1.4.4.1.1" xref="S4.SS2.p3.1.m1.4.4.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.4.4.1.1.2" xref="S4.SS2.p3.1.m1.4.4.1.2.cmml">{</mo><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">𝐮</mi><mo id="S4.SS2.p3.1.m1.4.4.1.1.3" xref="S4.SS2.p3.1.m1.4.4.1.2.cmml">,</mo><mi id="S4.SS2.p3.1.m1.2.2" xref="S4.SS2.p3.1.m1.2.2.cmml">𝐩</mi><mo id="S4.SS2.p3.1.m1.4.4.1.1.4" xref="S4.SS2.p3.1.m1.4.4.1.2.cmml">,</mo><mi id="S4.SS2.p3.1.m1.3.3" xref="S4.SS2.p3.1.m1.3.3.cmml">β</mi><mo id="S4.SS2.p3.1.m1.4.4.1.1.5" xref="S4.SS2.p3.1.m1.4.4.1.2.cmml">,</mo><msub id="S4.SS2.p3.1.m1.4.4.1.1.1" xref="S4.SS2.p3.1.m1.4.4.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.4.4.1.1.1.2" xref="S4.SS2.p3.1.m1.4.4.1.1.1.2.cmml">𝐕</mi><mrow id="S4.SS2.p3.1.m1.4.4.1.1.1.3" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.cmml"><mi id="S4.SS2.p3.1.m1.4.4.1.1.1.3.2" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.4.4.1.1.1.3.1" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.1.m1.4.4.1.1.1.3.3" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.4.4.1.1.1.3.1a" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.1.m1.4.4.1.1.1.3.4" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.4.cmml">F</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p3.1.m1.4.4.1.1.6" xref="S4.SS2.p3.1.m1.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.4b"><apply id="S4.SS2.p3.1.m1.4.4.cmml" xref="S4.SS2.p3.1.m1.4.4"><eq id="S4.SS2.p3.1.m1.4.4.2.cmml" xref="S4.SS2.p3.1.m1.4.4.2"></eq><ci id="S4.SS2.p3.1.m1.4.4.3.cmml" xref="S4.SS2.p3.1.m1.4.4.3">𝐰</ci><set id="S4.SS2.p3.1.m1.4.4.1.2.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝐮</ci><ci id="S4.SS2.p3.1.m1.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2">𝐩</ci><ci id="S4.SS2.p3.1.m1.3.3.cmml" xref="S4.SS2.p3.1.m1.3.3">𝛽</ci><apply id="S4.SS2.p3.1.m1.4.4.1.1.1.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.4.4.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.1.m1.4.4.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1.1.2">𝐕</ci><apply id="S4.SS2.p3.1.m1.4.4.1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3"><times id="S4.SS2.p3.1.m1.4.4.1.1.1.3.1.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.1"></times><ci id="S4.SS2.p3.1.m1.4.4.1.1.1.3.2.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.2">𝐸</ci><ci id="S4.SS2.p3.1.m1.4.4.1.1.1.3.3.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.3">𝑇</ci><ci id="S4.SS2.p3.1.m1.4.4.1.1.1.3.4.cmml" xref="S4.SS2.p3.1.m1.4.4.1.1.1.3.4">𝐹</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.4c">\mathbf{w}=\{\mathbf{u},\mathbf{p},\beta,\mathbf{V}_{ETF}\}</annotation></semantics></math>, and we split <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\mathbf{w}</annotation></semantics></math> into the tuned parameters <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\hat{\mathbf{w}}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mover accent="true" id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">𝐰</mi><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><ci id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1">^</ci><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\hat{\mathbf{w}}</annotation></semantics></math> and the fixed parameters <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="\overline{\mathbf{w}}" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mover accent="true" id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml">𝐰</mi><mo id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><ci id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1">¯</ci><ci id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\overline{\mathbf{w}}</annotation></semantics></math>. When finetune the feature extractor, <math id="S4.SS2.p3.5.m5.5" class="ltx_Math" alttext="\hat{\mathbf{w}}=\{\mathbf{u},\beta\},~{}\overline{\mathbf{w}}=\{\mathbf{p},\mathbf{V}_{ETF}\}" display="inline"><semantics id="S4.SS2.p3.5.m5.5a"><mrow id="S4.SS2.p3.5.m5.5.5.2" xref="S4.SS2.p3.5.m5.5.5.3.cmml"><mrow id="S4.SS2.p3.5.m5.4.4.1.1" xref="S4.SS2.p3.5.m5.4.4.1.1.cmml"><mover accent="true" id="S4.SS2.p3.5.m5.4.4.1.1.2" xref="S4.SS2.p3.5.m5.4.4.1.1.2.cmml"><mi id="S4.SS2.p3.5.m5.4.4.1.1.2.2" xref="S4.SS2.p3.5.m5.4.4.1.1.2.2.cmml">𝐰</mi><mo id="S4.SS2.p3.5.m5.4.4.1.1.2.1" xref="S4.SS2.p3.5.m5.4.4.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS2.p3.5.m5.4.4.1.1.1" xref="S4.SS2.p3.5.m5.4.4.1.1.1.cmml">=</mo><mrow id="S4.SS2.p3.5.m5.4.4.1.1.3.2" xref="S4.SS2.p3.5.m5.4.4.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS2.p3.5.m5.4.4.1.1.3.2.1" xref="S4.SS2.p3.5.m5.4.4.1.1.3.1.cmml">{</mo><mi id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">𝐮</mi><mo id="S4.SS2.p3.5.m5.4.4.1.1.3.2.2" xref="S4.SS2.p3.5.m5.4.4.1.1.3.1.cmml">,</mo><mi id="S4.SS2.p3.5.m5.2.2" xref="S4.SS2.p3.5.m5.2.2.cmml">β</mi><mo stretchy="false" id="S4.SS2.p3.5.m5.4.4.1.1.3.2.3" xref="S4.SS2.p3.5.m5.4.4.1.1.3.1.cmml">}</mo></mrow></mrow><mo rspace="0.497em" id="S4.SS2.p3.5.m5.5.5.2.3" xref="S4.SS2.p3.5.m5.5.5.3a.cmml">,</mo><mrow id="S4.SS2.p3.5.m5.5.5.2.2" xref="S4.SS2.p3.5.m5.5.5.2.2.cmml"><mover accent="true" id="S4.SS2.p3.5.m5.5.5.2.2.3" xref="S4.SS2.p3.5.m5.5.5.2.2.3.cmml"><mi id="S4.SS2.p3.5.m5.5.5.2.2.3.2" xref="S4.SS2.p3.5.m5.5.5.2.2.3.2.cmml">𝐰</mi><mo id="S4.SS2.p3.5.m5.5.5.2.2.3.1" xref="S4.SS2.p3.5.m5.5.5.2.2.3.1.cmml">¯</mo></mover><mo id="S4.SS2.p3.5.m5.5.5.2.2.2" xref="S4.SS2.p3.5.m5.5.5.2.2.2.cmml">=</mo><mrow id="S4.SS2.p3.5.m5.5.5.2.2.1.1" xref="S4.SS2.p3.5.m5.5.5.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.5.m5.5.5.2.2.1.1.2" xref="S4.SS2.p3.5.m5.5.5.2.2.1.2.cmml">{</mo><mi id="S4.SS2.p3.5.m5.3.3" xref="S4.SS2.p3.5.m5.3.3.cmml">𝐩</mi><mo id="S4.SS2.p3.5.m5.5.5.2.2.1.1.3" xref="S4.SS2.p3.5.m5.5.5.2.2.1.2.cmml">,</mo><msub id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.cmml"><mi id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.2" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.2.cmml">𝐕</mi><mrow id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.2" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.1" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.3" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.1a" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.4" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.4.cmml">F</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p3.5.m5.5.5.2.2.1.1.4" xref="S4.SS2.p3.5.m5.5.5.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.5b"><apply id="S4.SS2.p3.5.m5.5.5.3.cmml" xref="S4.SS2.p3.5.m5.5.5.2"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.5.5.3a.cmml" xref="S4.SS2.p3.5.m5.5.5.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p3.5.m5.4.4.1.1.cmml" xref="S4.SS2.p3.5.m5.4.4.1.1"><eq id="S4.SS2.p3.5.m5.4.4.1.1.1.cmml" xref="S4.SS2.p3.5.m5.4.4.1.1.1"></eq><apply id="S4.SS2.p3.5.m5.4.4.1.1.2.cmml" xref="S4.SS2.p3.5.m5.4.4.1.1.2"><ci id="S4.SS2.p3.5.m5.4.4.1.1.2.1.cmml" xref="S4.SS2.p3.5.m5.4.4.1.1.2.1">^</ci><ci id="S4.SS2.p3.5.m5.4.4.1.1.2.2.cmml" xref="S4.SS2.p3.5.m5.4.4.1.1.2.2">𝐰</ci></apply><set id="S4.SS2.p3.5.m5.4.4.1.1.3.1.cmml" xref="S4.SS2.p3.5.m5.4.4.1.1.3.2"><ci id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1">𝐮</ci><ci id="S4.SS2.p3.5.m5.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2">𝛽</ci></set></apply><apply id="S4.SS2.p3.5.m5.5.5.2.2.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2"><eq id="S4.SS2.p3.5.m5.5.5.2.2.2.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.2"></eq><apply id="S4.SS2.p3.5.m5.5.5.2.2.3.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.3"><ci id="S4.SS2.p3.5.m5.5.5.2.2.3.1.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.3.1">¯</ci><ci id="S4.SS2.p3.5.m5.5.5.2.2.3.2.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.3.2">𝐰</ci></apply><set id="S4.SS2.p3.5.m5.5.5.2.2.1.2.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1"><ci id="S4.SS2.p3.5.m5.3.3.cmml" xref="S4.SS2.p3.5.m5.3.3">𝐩</ci><apply id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.2">𝐕</ci><apply id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3"><times id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.1"></times><ci id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.2">𝐸</ci><ci id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.3">𝑇</ci><ci id="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.4.cmml" xref="S4.SS2.p3.5.m5.5.5.2.2.1.1.1.3.4">𝐹</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.5c">\hat{\mathbf{w}}=\{\mathbf{u},\beta\},~{}\overline{\mathbf{w}}=\{\mathbf{p},\mathbf{V}_{ETF}\}</annotation></semantics></math>; when finetune the ETF classifier, <math id="S4.SS2.p3.6.m6.5" class="ltx_Math" alttext="\hat{\mathbf{w}}=\{\mathbf{V}_{ETF},\beta\},~{}\overline{\mathbf{w}}=\{\mathbf{u},\mathbf{p}\}" display="inline"><semantics id="S4.SS2.p3.6.m6.5a"><mrow id="S4.SS2.p3.6.m6.5.5.2" xref="S4.SS2.p3.6.m6.5.5.3.cmml"><mrow id="S4.SS2.p3.6.m6.4.4.1.1" xref="S4.SS2.p3.6.m6.4.4.1.1.cmml"><mover accent="true" id="S4.SS2.p3.6.m6.4.4.1.1.3" xref="S4.SS2.p3.6.m6.4.4.1.1.3.cmml"><mi id="S4.SS2.p3.6.m6.4.4.1.1.3.2" xref="S4.SS2.p3.6.m6.4.4.1.1.3.2.cmml">𝐰</mi><mo id="S4.SS2.p3.6.m6.4.4.1.1.3.1" xref="S4.SS2.p3.6.m6.4.4.1.1.3.1.cmml">^</mo></mover><mo id="S4.SS2.p3.6.m6.4.4.1.1.2" xref="S4.SS2.p3.6.m6.4.4.1.1.2.cmml">=</mo><mrow id="S4.SS2.p3.6.m6.4.4.1.1.1.1" xref="S4.SS2.p3.6.m6.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.6.m6.4.4.1.1.1.1.2" xref="S4.SS2.p3.6.m6.4.4.1.1.1.2.cmml">{</mo><msub id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.2" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.2.cmml">𝐕</mi><mrow id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.2" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.1" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.3" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.1a" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.4" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.4.cmml">F</mi></mrow></msub><mo id="S4.SS2.p3.6.m6.4.4.1.1.1.1.3" xref="S4.SS2.p3.6.m6.4.4.1.1.1.2.cmml">,</mo><mi id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">β</mi><mo stretchy="false" id="S4.SS2.p3.6.m6.4.4.1.1.1.1.4" xref="S4.SS2.p3.6.m6.4.4.1.1.1.2.cmml">}</mo></mrow></mrow><mo rspace="0.497em" id="S4.SS2.p3.6.m6.5.5.2.3" xref="S4.SS2.p3.6.m6.5.5.3a.cmml">,</mo><mrow id="S4.SS2.p3.6.m6.5.5.2.2" xref="S4.SS2.p3.6.m6.5.5.2.2.cmml"><mover accent="true" id="S4.SS2.p3.6.m6.5.5.2.2.2" xref="S4.SS2.p3.6.m6.5.5.2.2.2.cmml"><mi id="S4.SS2.p3.6.m6.5.5.2.2.2.2" xref="S4.SS2.p3.6.m6.5.5.2.2.2.2.cmml">𝐰</mi><mo id="S4.SS2.p3.6.m6.5.5.2.2.2.1" xref="S4.SS2.p3.6.m6.5.5.2.2.2.1.cmml">¯</mo></mover><mo id="S4.SS2.p3.6.m6.5.5.2.2.1" xref="S4.SS2.p3.6.m6.5.5.2.2.1.cmml">=</mo><mrow id="S4.SS2.p3.6.m6.5.5.2.2.3.2" xref="S4.SS2.p3.6.m6.5.5.2.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p3.6.m6.5.5.2.2.3.2.1" xref="S4.SS2.p3.6.m6.5.5.2.2.3.1.cmml">{</mo><mi id="S4.SS2.p3.6.m6.2.2" xref="S4.SS2.p3.6.m6.2.2.cmml">𝐮</mi><mo id="S4.SS2.p3.6.m6.5.5.2.2.3.2.2" xref="S4.SS2.p3.6.m6.5.5.2.2.3.1.cmml">,</mo><mi id="S4.SS2.p3.6.m6.3.3" xref="S4.SS2.p3.6.m6.3.3.cmml">𝐩</mi><mo stretchy="false" id="S4.SS2.p3.6.m6.5.5.2.2.3.2.3" xref="S4.SS2.p3.6.m6.5.5.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.5b"><apply id="S4.SS2.p3.6.m6.5.5.3.cmml" xref="S4.SS2.p3.6.m6.5.5.2"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.5.5.3a.cmml" xref="S4.SS2.p3.6.m6.5.5.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p3.6.m6.4.4.1.1.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1"><eq id="S4.SS2.p3.6.m6.4.4.1.1.2.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.2"></eq><apply id="S4.SS2.p3.6.m6.4.4.1.1.3.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.3"><ci id="S4.SS2.p3.6.m6.4.4.1.1.3.1.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.3.1">^</ci><ci id="S4.SS2.p3.6.m6.4.4.1.1.3.2.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.3.2">𝐰</ci></apply><set id="S4.SS2.p3.6.m6.4.4.1.1.1.2.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1"><apply id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.2.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.2">𝐕</ci><apply id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3"><times id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.1"></times><ci id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.2">𝐸</ci><ci id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.3">𝑇</ci><ci id="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.4.cmml" xref="S4.SS2.p3.6.m6.4.4.1.1.1.1.1.3.4">𝐹</ci></apply></apply><ci id="S4.SS2.p3.6.m6.1.1.cmml" xref="S4.SS2.p3.6.m6.1.1">𝛽</ci></set></apply><apply id="S4.SS2.p3.6.m6.5.5.2.2.cmml" xref="S4.SS2.p3.6.m6.5.5.2.2"><eq id="S4.SS2.p3.6.m6.5.5.2.2.1.cmml" xref="S4.SS2.p3.6.m6.5.5.2.2.1"></eq><apply id="S4.SS2.p3.6.m6.5.5.2.2.2.cmml" xref="S4.SS2.p3.6.m6.5.5.2.2.2"><ci id="S4.SS2.p3.6.m6.5.5.2.2.2.1.cmml" xref="S4.SS2.p3.6.m6.5.5.2.2.2.1">¯</ci><ci id="S4.SS2.p3.6.m6.5.5.2.2.2.2.cmml" xref="S4.SS2.p3.6.m6.5.5.2.2.2.2">𝐰</ci></apply><set id="S4.SS2.p3.6.m6.5.5.2.2.3.1.cmml" xref="S4.SS2.p3.6.m6.5.5.2.2.3.2"><ci id="S4.SS2.p3.6.m6.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2">𝐮</ci><ci id="S4.SS2.p3.6.m6.3.3.cmml" xref="S4.SS2.p3.6.m6.3.3">𝐩</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.5c">\hat{\mathbf{w}}=\{\mathbf{V}_{ETF},\beta\},~{}\overline{\mathbf{w}}=\{\mathbf{u},\mathbf{p}\}</annotation></semantics></math>; when finetune the projection layer, <math id="S4.SS2.p3.7.m7.5" class="ltx_Math" alttext="\hat{\mathbf{w}}=\{\mathbf{p},\beta\},~{}\overline{\mathbf{w}}=\{\mathbf{u},\mathbf{V}_{ETF}\}" display="inline"><semantics id="S4.SS2.p3.7.m7.5a"><mrow id="S4.SS2.p3.7.m7.5.5.2" xref="S4.SS2.p3.7.m7.5.5.3.cmml"><mrow id="S4.SS2.p3.7.m7.4.4.1.1" xref="S4.SS2.p3.7.m7.4.4.1.1.cmml"><mover accent="true" id="S4.SS2.p3.7.m7.4.4.1.1.2" xref="S4.SS2.p3.7.m7.4.4.1.1.2.cmml"><mi id="S4.SS2.p3.7.m7.4.4.1.1.2.2" xref="S4.SS2.p3.7.m7.4.4.1.1.2.2.cmml">𝐰</mi><mo id="S4.SS2.p3.7.m7.4.4.1.1.2.1" xref="S4.SS2.p3.7.m7.4.4.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS2.p3.7.m7.4.4.1.1.1" xref="S4.SS2.p3.7.m7.4.4.1.1.1.cmml">=</mo><mrow id="S4.SS2.p3.7.m7.4.4.1.1.3.2" xref="S4.SS2.p3.7.m7.4.4.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS2.p3.7.m7.4.4.1.1.3.2.1" xref="S4.SS2.p3.7.m7.4.4.1.1.3.1.cmml">{</mo><mi id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml">𝐩</mi><mo id="S4.SS2.p3.7.m7.4.4.1.1.3.2.2" xref="S4.SS2.p3.7.m7.4.4.1.1.3.1.cmml">,</mo><mi id="S4.SS2.p3.7.m7.2.2" xref="S4.SS2.p3.7.m7.2.2.cmml">β</mi><mo stretchy="false" id="S4.SS2.p3.7.m7.4.4.1.1.3.2.3" xref="S4.SS2.p3.7.m7.4.4.1.1.3.1.cmml">}</mo></mrow></mrow><mo rspace="0.497em" id="S4.SS2.p3.7.m7.5.5.2.3" xref="S4.SS2.p3.7.m7.5.5.3a.cmml">,</mo><mrow id="S4.SS2.p3.7.m7.5.5.2.2" xref="S4.SS2.p3.7.m7.5.5.2.2.cmml"><mover accent="true" id="S4.SS2.p3.7.m7.5.5.2.2.3" xref="S4.SS2.p3.7.m7.5.5.2.2.3.cmml"><mi id="S4.SS2.p3.7.m7.5.5.2.2.3.2" xref="S4.SS2.p3.7.m7.5.5.2.2.3.2.cmml">𝐰</mi><mo id="S4.SS2.p3.7.m7.5.5.2.2.3.1" xref="S4.SS2.p3.7.m7.5.5.2.2.3.1.cmml">¯</mo></mover><mo id="S4.SS2.p3.7.m7.5.5.2.2.2" xref="S4.SS2.p3.7.m7.5.5.2.2.2.cmml">=</mo><mrow id="S4.SS2.p3.7.m7.5.5.2.2.1.1" xref="S4.SS2.p3.7.m7.5.5.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.7.m7.5.5.2.2.1.1.2" xref="S4.SS2.p3.7.m7.5.5.2.2.1.2.cmml">{</mo><mi id="S4.SS2.p3.7.m7.3.3" xref="S4.SS2.p3.7.m7.3.3.cmml">𝐮</mi><mo id="S4.SS2.p3.7.m7.5.5.2.2.1.1.3" xref="S4.SS2.p3.7.m7.5.5.2.2.1.2.cmml">,</mo><msub id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.cmml"><mi id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.2" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.2.cmml">𝐕</mi><mrow id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.2" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.1" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.3" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.1a" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.4" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.4.cmml">F</mi></mrow></msub><mo stretchy="false" id="S4.SS2.p3.7.m7.5.5.2.2.1.1.4" xref="S4.SS2.p3.7.m7.5.5.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.5b"><apply id="S4.SS2.p3.7.m7.5.5.3.cmml" xref="S4.SS2.p3.7.m7.5.5.2"><csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.5.5.3a.cmml" xref="S4.SS2.p3.7.m7.5.5.2.3">formulae-sequence</csymbol><apply id="S4.SS2.p3.7.m7.4.4.1.1.cmml" xref="S4.SS2.p3.7.m7.4.4.1.1"><eq id="S4.SS2.p3.7.m7.4.4.1.1.1.cmml" xref="S4.SS2.p3.7.m7.4.4.1.1.1"></eq><apply id="S4.SS2.p3.7.m7.4.4.1.1.2.cmml" xref="S4.SS2.p3.7.m7.4.4.1.1.2"><ci id="S4.SS2.p3.7.m7.4.4.1.1.2.1.cmml" xref="S4.SS2.p3.7.m7.4.4.1.1.2.1">^</ci><ci id="S4.SS2.p3.7.m7.4.4.1.1.2.2.cmml" xref="S4.SS2.p3.7.m7.4.4.1.1.2.2">𝐰</ci></apply><set id="S4.SS2.p3.7.m7.4.4.1.1.3.1.cmml" xref="S4.SS2.p3.7.m7.4.4.1.1.3.2"><ci id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">𝐩</ci><ci id="S4.SS2.p3.7.m7.2.2.cmml" xref="S4.SS2.p3.7.m7.2.2">𝛽</ci></set></apply><apply id="S4.SS2.p3.7.m7.5.5.2.2.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2"><eq id="S4.SS2.p3.7.m7.5.5.2.2.2.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.2"></eq><apply id="S4.SS2.p3.7.m7.5.5.2.2.3.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.3"><ci id="S4.SS2.p3.7.m7.5.5.2.2.3.1.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.3.1">¯</ci><ci id="S4.SS2.p3.7.m7.5.5.2.2.3.2.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.3.2">𝐰</ci></apply><set id="S4.SS2.p3.7.m7.5.5.2.2.1.2.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1"><ci id="S4.SS2.p3.7.m7.3.3.cmml" xref="S4.SS2.p3.7.m7.3.3">𝐮</ci><apply id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1">subscript</csymbol><ci id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.2">𝐕</ci><apply id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3"><times id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.1"></times><ci id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.2">𝐸</ci><ci id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.3">𝑇</ci><ci id="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.4.cmml" xref="S4.SS2.p3.7.m7.5.5.2.2.1.1.1.3.4">𝐹</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.5c">\hat{\mathbf{w}}=\{\mathbf{p},\beta\},~{}\overline{\mathbf{w}}=\{\mathbf{u},\mathbf{V}_{ETF}\}</annotation></semantics></math>. We use the vanilla CE loss without balanced softmax in each stage of finetuning.</p>
<table id="A3.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9.m1.10" class="ltx_Math" alttext="\displaystyle\ell^{p}(\hat{\mathbf{w}},\overline{\mathbf{w}};\mathbf{x},y)=-\log\frac{\exp(\beta\cdot\mathbf{v}_{y}^{T}\boldsymbol{\mu})}{\sum_{c\in[C]}\exp(\beta\cdot\mathbf{v}_{c}^{T}\boldsymbol{\mu})}." display="inline"><semantics id="S4.E9.m1.10a"><mrow id="S4.E9.m1.10.10.1" xref="S4.E9.m1.10.10.1.1.cmml"><mrow id="S4.E9.m1.10.10.1.1" xref="S4.E9.m1.10.10.1.1.cmml"><mrow id="S4.E9.m1.10.10.1.1.2" xref="S4.E9.m1.10.10.1.1.2.cmml"><msup id="S4.E9.m1.10.10.1.1.2.2" xref="S4.E9.m1.10.10.1.1.2.2.cmml"><mi mathvariant="normal" id="S4.E9.m1.10.10.1.1.2.2.2" xref="S4.E9.m1.10.10.1.1.2.2.2.cmml">ℓ</mi><mi id="S4.E9.m1.10.10.1.1.2.2.3" xref="S4.E9.m1.10.10.1.1.2.2.3.cmml">p</mi></msup><mo lspace="0em" rspace="0em" id="S4.E9.m1.10.10.1.1.2.1" xref="S4.E9.m1.10.10.1.1.2.1.cmml">​</mo><mrow id="S4.E9.m1.10.10.1.1.2.3.2" xref="S4.E9.m1.10.10.1.1.2.3.1.cmml"><mo stretchy="false" id="S4.E9.m1.10.10.1.1.2.3.2.1" xref="S4.E9.m1.10.10.1.1.2.3.1.cmml">(</mo><mover accent="true" id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml"><mi id="S4.E9.m1.6.6.2" xref="S4.E9.m1.6.6.2.cmml">𝐰</mi><mo id="S4.E9.m1.6.6.1" xref="S4.E9.m1.6.6.1.cmml">^</mo></mover><mo id="S4.E9.m1.10.10.1.1.2.3.2.2" xref="S4.E9.m1.10.10.1.1.2.3.1.cmml">,</mo><mover accent="true" id="S4.E9.m1.7.7" xref="S4.E9.m1.7.7.cmml"><mi id="S4.E9.m1.7.7.2" xref="S4.E9.m1.7.7.2.cmml">𝐰</mi><mo id="S4.E9.m1.7.7.1" xref="S4.E9.m1.7.7.1.cmml">¯</mo></mover><mo id="S4.E9.m1.10.10.1.1.2.3.2.3" xref="S4.E9.m1.10.10.1.1.2.3.1.cmml">;</mo><mi id="S4.E9.m1.8.8" xref="S4.E9.m1.8.8.cmml">𝐱</mi><mo id="S4.E9.m1.10.10.1.1.2.3.2.4" xref="S4.E9.m1.10.10.1.1.2.3.1.cmml">,</mo><mi id="S4.E9.m1.9.9" xref="S4.E9.m1.9.9.cmml">y</mi><mo stretchy="false" id="S4.E9.m1.10.10.1.1.2.3.2.5" xref="S4.E9.m1.10.10.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.10.10.1.1.1" xref="S4.E9.m1.10.10.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.10.10.1.1.3" xref="S4.E9.m1.10.10.1.1.3.cmml"><mo rspace="0.167em" id="S4.E9.m1.10.10.1.1.3a" xref="S4.E9.m1.10.10.1.1.3.cmml">−</mo><mrow id="S4.E9.m1.10.10.1.1.3.2" xref="S4.E9.m1.10.10.1.1.3.2.cmml"><mi id="S4.E9.m1.10.10.1.1.3.2.1" xref="S4.E9.m1.10.10.1.1.3.2.1.cmml">log</mi><mo lspace="0.167em" id="S4.E9.m1.10.10.1.1.3.2a" xref="S4.E9.m1.10.10.1.1.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml"><mfrac id="S4.E9.m1.5.5a" xref="S4.E9.m1.5.5.cmml"><mrow id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E9.m1.2.2.2.2a" xref="S4.E9.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E9.m1.2.2.2.2.1" xref="S4.E9.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.2.2.1.2" xref="S4.E9.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E9.m1.2.2.2.2.1.1" xref="S4.E9.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E9.m1.2.2.2.2.1.1.2" xref="S4.E9.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.2.2" xref="S4.E9.m1.2.2.2.2.1.1.2.2.cmml">β</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E9.m1.2.2.2.2.1.1.2.1" xref="S4.E9.m1.2.2.2.2.1.1.2.1.cmml">⋅</mo><msubsup id="S4.E9.m1.2.2.2.2.1.1.2.3" xref="S4.E9.m1.2.2.2.2.1.1.2.3.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.2.3.2.2" xref="S4.E9.m1.2.2.2.2.1.1.2.3.2.2.cmml">𝐯</mi><mi id="S4.E9.m1.2.2.2.2.1.1.2.3.2.3" xref="S4.E9.m1.2.2.2.2.1.1.2.3.2.3.cmml">y</mi><mi id="S4.E9.m1.2.2.2.2.1.1.2.3.3" xref="S4.E9.m1.2.2.2.2.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.2.1.1.1" xref="S4.E9.m1.2.2.2.2.1.1.1.cmml">​</mo><mi id="S4.E9.m1.2.2.2.2.1.1.3" xref="S4.E9.m1.2.2.2.2.1.1.3.cmml">𝝁</mi></mrow><mo stretchy="false" id="S4.E9.m1.2.2.2.2.1.3" xref="S4.E9.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E9.m1.5.5.5" xref="S4.E9.m1.5.5.5.cmml"><msub id="S4.E9.m1.5.5.5.4" xref="S4.E9.m1.5.5.5.4.cmml"><mo id="S4.E9.m1.5.5.5.4.2" xref="S4.E9.m1.5.5.5.4.2.cmml">∑</mo><mrow id="S4.E9.m1.3.3.3.1.1" xref="S4.E9.m1.3.3.3.1.1.cmml"><mi id="S4.E9.m1.3.3.3.1.1.3" xref="S4.E9.m1.3.3.3.1.1.3.cmml">c</mi><mo id="S4.E9.m1.3.3.3.1.1.2" xref="S4.E9.m1.3.3.3.1.1.2.cmml">∈</mo><mrow id="S4.E9.m1.3.3.3.1.1.4.2" xref="S4.E9.m1.3.3.3.1.1.4.1.cmml"><mo stretchy="false" id="S4.E9.m1.3.3.3.1.1.4.2.1" xref="S4.E9.m1.3.3.3.1.1.4.1.1.cmml">[</mo><mi id="S4.E9.m1.3.3.3.1.1.1" xref="S4.E9.m1.3.3.3.1.1.1.cmml">C</mi><mo stretchy="false" id="S4.E9.m1.3.3.3.1.1.4.2.2" xref="S4.E9.m1.3.3.3.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><mrow id="S4.E9.m1.5.5.5.3.1" xref="S4.E9.m1.5.5.5.3.2.cmml"><mi id="S4.E9.m1.4.4.4.2" xref="S4.E9.m1.4.4.4.2.cmml">exp</mi><mo id="S4.E9.m1.5.5.5.3.1a" xref="S4.E9.m1.5.5.5.3.2.cmml">⁡</mo><mrow id="S4.E9.m1.5.5.5.3.1.1" xref="S4.E9.m1.5.5.5.3.2.cmml"><mo stretchy="false" id="S4.E9.m1.5.5.5.3.1.1.2" xref="S4.E9.m1.5.5.5.3.2.cmml">(</mo><mrow id="S4.E9.m1.5.5.5.3.1.1.1" xref="S4.E9.m1.5.5.5.3.1.1.1.cmml"><mrow id="S4.E9.m1.5.5.5.3.1.1.1.2" xref="S4.E9.m1.5.5.5.3.1.1.1.2.cmml"><mi id="S4.E9.m1.5.5.5.3.1.1.1.2.2" xref="S4.E9.m1.5.5.5.3.1.1.1.2.2.cmml">β</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E9.m1.5.5.5.3.1.1.1.2.1" xref="S4.E9.m1.5.5.5.3.1.1.1.2.1.cmml">⋅</mo><msubsup id="S4.E9.m1.5.5.5.3.1.1.1.2.3" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3.cmml"><mi id="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.2" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.2.cmml">𝐯</mi><mi id="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.3" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.3.cmml">c</mi><mi id="S4.E9.m1.5.5.5.3.1.1.1.2.3.3" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.5.5.5.3.1.1.1.1" xref="S4.E9.m1.5.5.5.3.1.1.1.1.cmml">​</mo><mi id="S4.E9.m1.5.5.5.3.1.1.1.3" xref="S4.E9.m1.5.5.5.3.1.1.1.3.cmml">𝝁</mi></mrow><mo stretchy="false" id="S4.E9.m1.5.5.5.3.1.1.3" xref="S4.E9.m1.5.5.5.3.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo lspace="0em" id="S4.E9.m1.10.10.1.2" xref="S4.E9.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.10b"><apply id="S4.E9.m1.10.10.1.1.cmml" xref="S4.E9.m1.10.10.1"><eq id="S4.E9.m1.10.10.1.1.1.cmml" xref="S4.E9.m1.10.10.1.1.1"></eq><apply id="S4.E9.m1.10.10.1.1.2.cmml" xref="S4.E9.m1.10.10.1.1.2"><times id="S4.E9.m1.10.10.1.1.2.1.cmml" xref="S4.E9.m1.10.10.1.1.2.1"></times><apply id="S4.E9.m1.10.10.1.1.2.2.cmml" xref="S4.E9.m1.10.10.1.1.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.10.10.1.1.2.2.1.cmml" xref="S4.E9.m1.10.10.1.1.2.2">superscript</csymbol><ci id="S4.E9.m1.10.10.1.1.2.2.2.cmml" xref="S4.E9.m1.10.10.1.1.2.2.2">ℓ</ci><ci id="S4.E9.m1.10.10.1.1.2.2.3.cmml" xref="S4.E9.m1.10.10.1.1.2.2.3">𝑝</ci></apply><vector id="S4.E9.m1.10.10.1.1.2.3.1.cmml" xref="S4.E9.m1.10.10.1.1.2.3.2"><apply id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6"><ci id="S4.E9.m1.6.6.1.cmml" xref="S4.E9.m1.6.6.1">^</ci><ci id="S4.E9.m1.6.6.2.cmml" xref="S4.E9.m1.6.6.2">𝐰</ci></apply><apply id="S4.E9.m1.7.7.cmml" xref="S4.E9.m1.7.7"><ci id="S4.E9.m1.7.7.1.cmml" xref="S4.E9.m1.7.7.1">¯</ci><ci id="S4.E9.m1.7.7.2.cmml" xref="S4.E9.m1.7.7.2">𝐰</ci></apply><ci id="S4.E9.m1.8.8.cmml" xref="S4.E9.m1.8.8">𝐱</ci><ci id="S4.E9.m1.9.9.cmml" xref="S4.E9.m1.9.9">𝑦</ci></vector></apply><apply id="S4.E9.m1.10.10.1.1.3.cmml" xref="S4.E9.m1.10.10.1.1.3"><minus id="S4.E9.m1.10.10.1.1.3.1.cmml" xref="S4.E9.m1.10.10.1.1.3"></minus><apply id="S4.E9.m1.10.10.1.1.3.2.cmml" xref="S4.E9.m1.10.10.1.1.3.2"><log id="S4.E9.m1.10.10.1.1.3.2.1.cmml" xref="S4.E9.m1.10.10.1.1.3.2.1"></log><apply id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5"><divide id="S4.E9.m1.5.5.6.cmml" xref="S4.E9.m1.5.5"></divide><apply id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2"><exp id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1"></exp><apply id="S4.E9.m1.2.2.2.2.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1"><times id="S4.E9.m1.2.2.2.2.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1"></times><apply id="S4.E9.m1.2.2.2.2.1.1.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2"><ci id="S4.E9.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.1">⋅</ci><ci id="S4.E9.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.2">𝛽</ci><apply id="S4.E9.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.2.3.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.3">superscript</csymbol><apply id="S4.E9.m1.2.2.2.2.1.1.2.3.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.2.3.2.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.3">subscript</csymbol><ci id="S4.E9.m1.2.2.2.2.1.1.2.3.2.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.3.2.2">𝐯</ci><ci id="S4.E9.m1.2.2.2.2.1.1.2.3.2.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.3.2.3">𝑦</ci></apply><ci id="S4.E9.m1.2.2.2.2.1.1.2.3.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S4.E9.m1.2.2.2.2.1.1.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3">𝝁</ci></apply></apply><apply id="S4.E9.m1.5.5.5.cmml" xref="S4.E9.m1.5.5.5"><apply id="S4.E9.m1.5.5.5.4.cmml" xref="S4.E9.m1.5.5.5.4"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.4.1.cmml" xref="S4.E9.m1.5.5.5.4">subscript</csymbol><sum id="S4.E9.m1.5.5.5.4.2.cmml" xref="S4.E9.m1.5.5.5.4.2"></sum><apply id="S4.E9.m1.3.3.3.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1"><in id="S4.E9.m1.3.3.3.1.1.2.cmml" xref="S4.E9.m1.3.3.3.1.1.2"></in><ci id="S4.E9.m1.3.3.3.1.1.3.cmml" xref="S4.E9.m1.3.3.3.1.1.3">𝑐</ci><apply id="S4.E9.m1.3.3.3.1.1.4.1.cmml" xref="S4.E9.m1.3.3.3.1.1.4.2"><csymbol cd="latexml" id="S4.E9.m1.3.3.3.1.1.4.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.E9.m1.3.3.3.1.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1.1">𝐶</ci></apply></apply></apply><apply id="S4.E9.m1.5.5.5.3.2.cmml" xref="S4.E9.m1.5.5.5.3.1"><exp id="S4.E9.m1.4.4.4.2.cmml" xref="S4.E9.m1.4.4.4.2"></exp><apply id="S4.E9.m1.5.5.5.3.1.1.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1"><times id="S4.E9.m1.5.5.5.3.1.1.1.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.1"></times><apply id="S4.E9.m1.5.5.5.3.1.1.1.2.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2"><ci id="S4.E9.m1.5.5.5.3.1.1.1.2.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.1">⋅</ci><ci id="S4.E9.m1.5.5.5.3.1.1.1.2.2.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.2">𝛽</ci><apply id="S4.E9.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.3.1.1.1.2.3.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3">superscript</csymbol><apply id="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3">subscript</csymbol><ci id="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.2.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.2">𝐯</ci><ci id="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.3.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3.2.3">𝑐</ci></apply><ci id="S4.E9.m1.5.5.5.3.1.1.1.2.3.3.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3.3">𝑇</ci></apply></apply><ci id="S4.E9.m1.5.5.5.3.1.1.1.3.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.3">𝝁</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.10c">\displaystyle\ell^{p}(\hat{\mathbf{w}},\overline{\mathbf{w}};\mathbf{x},y)=-\log\frac{\exp(\beta\cdot\mathbf{v}_{y}^{T}\boldsymbol{\mu})}{\sum_{c\in[C]}\exp(\beta\cdot\mathbf{v}_{c}^{T}\boldsymbol{\mu})}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.8" class="ltx_p">The learning objective in each stage is shown as follows.</p>
<table id="A3.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E10.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{w}_{k}^{p}" display="inline"><semantics id="S4.E10.m1.1a"><msubsup id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml"><mi id="S4.E10.m1.1.1.2.2" xref="S4.E10.m1.1.1.2.2.cmml">𝐰</mi><mi id="S4.E10.m1.1.1.2.3" xref="S4.E10.m1.1.1.2.3.cmml">k</mi><mi id="S4.E10.m1.1.1.3" xref="S4.E10.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.cmml" xref="S4.E10.m1.1.1">superscript</csymbol><apply id="S4.E10.m1.1.1.2.cmml" xref="S4.E10.m1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.2.1.cmml" xref="S4.E10.m1.1.1">subscript</csymbol><ci id="S4.E10.m1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.2.2">𝐰</ci><ci id="S4.E10.m1.1.1.2.3.cmml" xref="S4.E10.m1.1.1.2.3">𝑘</ci></apply><ci id="S4.E10.m1.1.1.3.cmml" xref="S4.E10.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\displaystyle\mathbf{w}_{k}^{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E10.m2.3" class="ltx_Math" alttext="\displaystyle=\{\overline{\mathbf{w}},\arg\min_{\hat{\mathbf{w}}}\mathcal{L}_{k}^{p}(\hat{\mathbf{w}})\}," display="inline"><semantics id="S4.E10.m2.3a"><mrow id="S4.E10.m2.3.3.1" xref="S4.E10.m2.3.3.1.1.cmml"><mrow id="S4.E10.m2.3.3.1.1" xref="S4.E10.m2.3.3.1.1.cmml"><mi id="S4.E10.m2.3.3.1.1.3" xref="S4.E10.m2.3.3.1.1.3.cmml"></mi><mo id="S4.E10.m2.3.3.1.1.2" xref="S4.E10.m2.3.3.1.1.2.cmml">=</mo><mrow id="S4.E10.m2.3.3.1.1.1.1" xref="S4.E10.m2.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S4.E10.m2.3.3.1.1.1.1.2" xref="S4.E10.m2.3.3.1.1.1.2.cmml">{</mo><mover accent="true" id="S4.E10.m2.2.2" xref="S4.E10.m2.2.2.cmml"><mi id="S4.E10.m2.2.2.2" xref="S4.E10.m2.2.2.2.cmml">𝐰</mi><mo id="S4.E10.m2.2.2.1" xref="S4.E10.m2.2.2.1.cmml">¯</mo></mover><mo id="S4.E10.m2.3.3.1.1.1.1.3" xref="S4.E10.m2.3.3.1.1.1.2.cmml">,</mo><mrow id="S4.E10.m2.3.3.1.1.1.1.1" xref="S4.E10.m2.3.3.1.1.1.1.1.cmml"><mrow id="S4.E10.m2.3.3.1.1.1.1.1.2" xref="S4.E10.m2.3.3.1.1.1.1.1.2.cmml"><mi id="S4.E10.m2.3.3.1.1.1.1.1.2.1" xref="S4.E10.m2.3.3.1.1.1.1.1.2.1.cmml">arg</mi><mo lspace="0.167em" id="S4.E10.m2.3.3.1.1.1.1.1.2a" xref="S4.E10.m2.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E10.m2.3.3.1.1.1.1.1.2.2" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.cmml"><munder id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.cmml"><mi id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.2" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.2.cmml">min</mi><mover accent="true" id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.cmml"><mi id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.2" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.2.cmml">𝐰</mi><mo id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.1" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.1.cmml">^</mo></mover></munder><mo lspace="0.167em" id="S4.E10.m2.3.3.1.1.1.1.1.2.2a" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.cmml">⁡</mo><msubsup id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.2" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.2.cmml">ℒ</mi><mi id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.3" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.3.cmml">k</mi><mi id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.3" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.3.cmml">p</mi></msubsup></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m2.3.3.1.1.1.1.1.1" xref="S4.E10.m2.3.3.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.E10.m2.3.3.1.1.1.1.1.3.2" xref="S4.E10.m2.1.1.cmml"><mo stretchy="false" id="S4.E10.m2.3.3.1.1.1.1.1.3.2.1" xref="S4.E10.m2.1.1.cmml">(</mo><mover accent="true" id="S4.E10.m2.1.1" xref="S4.E10.m2.1.1.cmml"><mi id="S4.E10.m2.1.1.2" xref="S4.E10.m2.1.1.2.cmml">𝐰</mi><mo id="S4.E10.m2.1.1.1" xref="S4.E10.m2.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S4.E10.m2.3.3.1.1.1.1.1.3.2.2" xref="S4.E10.m2.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E10.m2.3.3.1.1.1.1.4" xref="S4.E10.m2.3.3.1.1.1.2.cmml">}</mo></mrow></mrow><mo id="S4.E10.m2.3.3.1.2" xref="S4.E10.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m2.3b"><apply id="S4.E10.m2.3.3.1.1.cmml" xref="S4.E10.m2.3.3.1"><eq id="S4.E10.m2.3.3.1.1.2.cmml" xref="S4.E10.m2.3.3.1.1.2"></eq><csymbol cd="latexml" id="S4.E10.m2.3.3.1.1.3.cmml" xref="S4.E10.m2.3.3.1.1.3">absent</csymbol><set id="S4.E10.m2.3.3.1.1.1.2.cmml" xref="S4.E10.m2.3.3.1.1.1.1"><apply id="S4.E10.m2.2.2.cmml" xref="S4.E10.m2.2.2"><ci id="S4.E10.m2.2.2.1.cmml" xref="S4.E10.m2.2.2.1">¯</ci><ci id="S4.E10.m2.2.2.2.cmml" xref="S4.E10.m2.2.2.2">𝐰</ci></apply><apply id="S4.E10.m2.3.3.1.1.1.1.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1"><times id="S4.E10.m2.3.3.1.1.1.1.1.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.1"></times><apply id="S4.E10.m2.3.3.1.1.1.1.1.2.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2"><arg id="S4.E10.m2.3.3.1.1.1.1.1.2.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.1"></arg><apply id="S4.E10.m2.3.3.1.1.1.1.1.2.2.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2"><apply id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1">subscript</csymbol><min id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.2.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.2"></min><apply id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3"><ci id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.1">^</ci><ci id="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.2.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.1.3.2">𝐰</ci></apply></apply><apply id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.2">ℒ</ci><ci id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.2.3">𝑘</ci></apply><ci id="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.2.2.2.3">𝑝</ci></apply></apply></apply><apply id="S4.E10.m2.1.1.cmml" xref="S4.E10.m2.3.3.1.1.1.1.1.3.2"><ci id="S4.E10.m2.1.1.1.cmml" xref="S4.E10.m2.1.1.1">^</ci><ci id="S4.E10.m2.1.1.2.cmml" xref="S4.E10.m2.1.1.2">𝐰</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m2.3c">\displaystyle=\{\overline{\mathbf{w}},\arg\min_{\hat{\mathbf{w}}}\mathcal{L}_{k}^{p}(\hat{\mathbf{w}})\},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E11.m1.1" class="ltx_Math" alttext="\displaystyle\text{where }\mathcal{L}_{k}^{p}(\hat{\mathbf{w}})" display="inline"><semantics id="S4.E11.m1.1a"><mrow id="S4.E11.m1.1.2" xref="S4.E11.m1.1.2.cmml"><mtext id="S4.E11.m1.1.2.2" xref="S4.E11.m1.1.2.2a.cmml">where </mtext><mo lspace="0em" rspace="0em" id="S4.E11.m1.1.2.1" xref="S4.E11.m1.1.2.1.cmml">​</mo><msubsup id="S4.E11.m1.1.2.3" xref="S4.E11.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.2.3.2.2" xref="S4.E11.m1.1.2.3.2.2.cmml">ℒ</mi><mi id="S4.E11.m1.1.2.3.2.3" xref="S4.E11.m1.1.2.3.2.3.cmml">k</mi><mi id="S4.E11.m1.1.2.3.3" xref="S4.E11.m1.1.2.3.3.cmml">p</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E11.m1.1.2.1a" xref="S4.E11.m1.1.2.1.cmml">​</mo><mrow id="S4.E11.m1.1.2.4.2" xref="S4.E11.m1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.1.2.4.2.1" xref="S4.E11.m1.1.1.cmml">(</mo><mover accent="true" id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml"><mi id="S4.E11.m1.1.1.2" xref="S4.E11.m1.1.1.2.cmml">𝐰</mi><mo id="S4.E11.m1.1.1.1" xref="S4.E11.m1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S4.E11.m1.1.2.4.2.2" xref="S4.E11.m1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.1b"><apply id="S4.E11.m1.1.2.cmml" xref="S4.E11.m1.1.2"><times id="S4.E11.m1.1.2.1.cmml" xref="S4.E11.m1.1.2.1"></times><ci id="S4.E11.m1.1.2.2a.cmml" xref="S4.E11.m1.1.2.2"><mtext id="S4.E11.m1.1.2.2.cmml" xref="S4.E11.m1.1.2.2">where </mtext></ci><apply id="S4.E11.m1.1.2.3.cmml" xref="S4.E11.m1.1.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.2.3.1.cmml" xref="S4.E11.m1.1.2.3">superscript</csymbol><apply id="S4.E11.m1.1.2.3.2.cmml" xref="S4.E11.m1.1.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.1.2.3.2.1.cmml" xref="S4.E11.m1.1.2.3">subscript</csymbol><ci id="S4.E11.m1.1.2.3.2.2.cmml" xref="S4.E11.m1.1.2.3.2.2">ℒ</ci><ci id="S4.E11.m1.1.2.3.2.3.cmml" xref="S4.E11.m1.1.2.3.2.3">𝑘</ci></apply><ci id="S4.E11.m1.1.2.3.3.cmml" xref="S4.E11.m1.1.2.3.3">𝑝</ci></apply><apply id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.2.4.2"><ci id="S4.E11.m1.1.1.1.cmml" xref="S4.E11.m1.1.1.1">^</ci><ci id="S4.E11.m1.1.1.2.cmml" xref="S4.E11.m1.1.1.2">𝐰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.1c">\displaystyle\text{where }\mathcal{L}_{k}^{p}(\hat{\mathbf{w}})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E11.m2.5" class="ltx_Math" alttext="\displaystyle=\frac{1}{n_{k}}\sum_{(\mathbf{x}_{i},y_{i})\in\mathcal{D}_{k}}\ell^{p}(\hat{\mathbf{w}},\overline{\mathbf{w}};\mathbf{x}_{i},y_{i})." display="inline"><semantics id="S4.E11.m2.5a"><mrow id="S4.E11.m2.5.5.1" xref="S4.E11.m2.5.5.1.1.cmml"><mrow id="S4.E11.m2.5.5.1.1" xref="S4.E11.m2.5.5.1.1.cmml"><mi id="S4.E11.m2.5.5.1.1.4" xref="S4.E11.m2.5.5.1.1.4.cmml"></mi><mo id="S4.E11.m2.5.5.1.1.3" xref="S4.E11.m2.5.5.1.1.3.cmml">=</mo><mrow id="S4.E11.m2.5.5.1.1.2" xref="S4.E11.m2.5.5.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E11.m2.5.5.1.1.2.4" xref="S4.E11.m2.5.5.1.1.2.4.cmml"><mfrac id="S4.E11.m2.5.5.1.1.2.4a" xref="S4.E11.m2.5.5.1.1.2.4.cmml"><mn id="S4.E11.m2.5.5.1.1.2.4.2" xref="S4.E11.m2.5.5.1.1.2.4.2.cmml">1</mn><msub id="S4.E11.m2.5.5.1.1.2.4.3" xref="S4.E11.m2.5.5.1.1.2.4.3.cmml"><mi id="S4.E11.m2.5.5.1.1.2.4.3.2" xref="S4.E11.m2.5.5.1.1.2.4.3.2.cmml">n</mi><mi id="S4.E11.m2.5.5.1.1.2.4.3.3" xref="S4.E11.m2.5.5.1.1.2.4.3.3.cmml">k</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E11.m2.5.5.1.1.2.3" xref="S4.E11.m2.5.5.1.1.2.3.cmml">​</mo><mrow id="S4.E11.m2.5.5.1.1.2.2" xref="S4.E11.m2.5.5.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E11.m2.5.5.1.1.2.2.3" xref="S4.E11.m2.5.5.1.1.2.2.3.cmml"><munder id="S4.E11.m2.5.5.1.1.2.2.3a" xref="S4.E11.m2.5.5.1.1.2.2.3.cmml"><mo movablelimits="false" id="S4.E11.m2.5.5.1.1.2.2.3.2" xref="S4.E11.m2.5.5.1.1.2.2.3.2.cmml">∑</mo><mrow id="S4.E11.m2.2.2.2" xref="S4.E11.m2.2.2.2.cmml"><mrow id="S4.E11.m2.2.2.2.2.2" xref="S4.E11.m2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E11.m2.2.2.2.2.2.3" xref="S4.E11.m2.2.2.2.2.3.cmml">(</mo><msub id="S4.E11.m2.1.1.1.1.1.1" xref="S4.E11.m2.1.1.1.1.1.1.cmml"><mi id="S4.E11.m2.1.1.1.1.1.1.2" xref="S4.E11.m2.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.E11.m2.1.1.1.1.1.1.3" xref="S4.E11.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E11.m2.2.2.2.2.2.4" xref="S4.E11.m2.2.2.2.2.3.cmml">,</mo><msub id="S4.E11.m2.2.2.2.2.2.2" xref="S4.E11.m2.2.2.2.2.2.2.cmml"><mi id="S4.E11.m2.2.2.2.2.2.2.2" xref="S4.E11.m2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E11.m2.2.2.2.2.2.2.3" xref="S4.E11.m2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E11.m2.2.2.2.2.2.5" xref="S4.E11.m2.2.2.2.2.3.cmml">)</mo></mrow><mo id="S4.E11.m2.2.2.2.3" xref="S4.E11.m2.2.2.2.3.cmml">∈</mo><msub id="S4.E11.m2.2.2.2.4" xref="S4.E11.m2.2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m2.2.2.2.4.2" xref="S4.E11.m2.2.2.2.4.2.cmml">𝒟</mi><mi id="S4.E11.m2.2.2.2.4.3" xref="S4.E11.m2.2.2.2.4.3.cmml">k</mi></msub></mrow></munder></mstyle><mrow id="S4.E11.m2.5.5.1.1.2.2.2" xref="S4.E11.m2.5.5.1.1.2.2.2.cmml"><msup id="S4.E11.m2.5.5.1.1.2.2.2.4" xref="S4.E11.m2.5.5.1.1.2.2.2.4.cmml"><mi mathvariant="normal" id="S4.E11.m2.5.5.1.1.2.2.2.4.2" xref="S4.E11.m2.5.5.1.1.2.2.2.4.2.cmml">ℓ</mi><mi id="S4.E11.m2.5.5.1.1.2.2.2.4.3" xref="S4.E11.m2.5.5.1.1.2.2.2.4.3.cmml">p</mi></msup><mo lspace="0em" rspace="0em" id="S4.E11.m2.5.5.1.1.2.2.2.3" xref="S4.E11.m2.5.5.1.1.2.2.2.3.cmml">​</mo><mrow id="S4.E11.m2.5.5.1.1.2.2.2.2.2" xref="S4.E11.m2.5.5.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E11.m2.5.5.1.1.2.2.2.2.2.3" xref="S4.E11.m2.5.5.1.1.2.2.2.2.3.cmml">(</mo><mover accent="true" id="S4.E11.m2.3.3" xref="S4.E11.m2.3.3.cmml"><mi id="S4.E11.m2.3.3.2" xref="S4.E11.m2.3.3.2.cmml">𝐰</mi><mo id="S4.E11.m2.3.3.1" xref="S4.E11.m2.3.3.1.cmml">^</mo></mover><mo id="S4.E11.m2.5.5.1.1.2.2.2.2.2.4" xref="S4.E11.m2.5.5.1.1.2.2.2.2.3.cmml">,</mo><mover accent="true" id="S4.E11.m2.4.4" xref="S4.E11.m2.4.4.cmml"><mi id="S4.E11.m2.4.4.2" xref="S4.E11.m2.4.4.2.cmml">𝐰</mi><mo id="S4.E11.m2.4.4.1" xref="S4.E11.m2.4.4.1.cmml">¯</mo></mover><mo id="S4.E11.m2.5.5.1.1.2.2.2.2.2.5" xref="S4.E11.m2.5.5.1.1.2.2.2.2.3.cmml">;</mo><msub id="S4.E11.m2.5.5.1.1.1.1.1.1.1.1" xref="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.2" xref="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.3" xref="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E11.m2.5.5.1.1.2.2.2.2.2.6" xref="S4.E11.m2.5.5.1.1.2.2.2.2.3.cmml">,</mo><msub id="S4.E11.m2.5.5.1.1.2.2.2.2.2.2" xref="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.2" xref="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.3" xref="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E11.m2.5.5.1.1.2.2.2.2.2.7" xref="S4.E11.m2.5.5.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S4.E11.m2.5.5.1.2" xref="S4.E11.m2.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m2.5b"><apply id="S4.E11.m2.5.5.1.1.cmml" xref="S4.E11.m2.5.5.1"><eq id="S4.E11.m2.5.5.1.1.3.cmml" xref="S4.E11.m2.5.5.1.1.3"></eq><csymbol cd="latexml" id="S4.E11.m2.5.5.1.1.4.cmml" xref="S4.E11.m2.5.5.1.1.4">absent</csymbol><apply id="S4.E11.m2.5.5.1.1.2.cmml" xref="S4.E11.m2.5.5.1.1.2"><times id="S4.E11.m2.5.5.1.1.2.3.cmml" xref="S4.E11.m2.5.5.1.1.2.3"></times><apply id="S4.E11.m2.5.5.1.1.2.4.cmml" xref="S4.E11.m2.5.5.1.1.2.4"><divide id="S4.E11.m2.5.5.1.1.2.4.1.cmml" xref="S4.E11.m2.5.5.1.1.2.4"></divide><cn type="integer" id="S4.E11.m2.5.5.1.1.2.4.2.cmml" xref="S4.E11.m2.5.5.1.1.2.4.2">1</cn><apply id="S4.E11.m2.5.5.1.1.2.4.3.cmml" xref="S4.E11.m2.5.5.1.1.2.4.3"><csymbol cd="ambiguous" id="S4.E11.m2.5.5.1.1.2.4.3.1.cmml" xref="S4.E11.m2.5.5.1.1.2.4.3">subscript</csymbol><ci id="S4.E11.m2.5.5.1.1.2.4.3.2.cmml" xref="S4.E11.m2.5.5.1.1.2.4.3.2">𝑛</ci><ci id="S4.E11.m2.5.5.1.1.2.4.3.3.cmml" xref="S4.E11.m2.5.5.1.1.2.4.3.3">𝑘</ci></apply></apply><apply id="S4.E11.m2.5.5.1.1.2.2.cmml" xref="S4.E11.m2.5.5.1.1.2.2"><apply id="S4.E11.m2.5.5.1.1.2.2.3.cmml" xref="S4.E11.m2.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E11.m2.5.5.1.1.2.2.3.1.cmml" xref="S4.E11.m2.5.5.1.1.2.2.3">subscript</csymbol><sum id="S4.E11.m2.5.5.1.1.2.2.3.2.cmml" xref="S4.E11.m2.5.5.1.1.2.2.3.2"></sum><apply id="S4.E11.m2.2.2.2.cmml" xref="S4.E11.m2.2.2.2"><in id="S4.E11.m2.2.2.2.3.cmml" xref="S4.E11.m2.2.2.2.3"></in><interval closure="open" id="S4.E11.m2.2.2.2.2.3.cmml" xref="S4.E11.m2.2.2.2.2.2"><apply id="S4.E11.m2.1.1.1.1.1.1.cmml" xref="S4.E11.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m2.1.1.1.1.1.1.1.cmml" xref="S4.E11.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m2.1.1.1.1.1.1.2.cmml" xref="S4.E11.m2.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.E11.m2.1.1.1.1.1.1.3.cmml" xref="S4.E11.m2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E11.m2.2.2.2.2.2.2.cmml" xref="S4.E11.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m2.2.2.2.2.2.2.1.cmml" xref="S4.E11.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E11.m2.2.2.2.2.2.2.2.cmml" xref="S4.E11.m2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E11.m2.2.2.2.2.2.2.3.cmml" xref="S4.E11.m2.2.2.2.2.2.2.3">𝑖</ci></apply></interval><apply id="S4.E11.m2.2.2.2.4.cmml" xref="S4.E11.m2.2.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m2.2.2.2.4.1.cmml" xref="S4.E11.m2.2.2.2.4">subscript</csymbol><ci id="S4.E11.m2.2.2.2.4.2.cmml" xref="S4.E11.m2.2.2.2.4.2">𝒟</ci><ci id="S4.E11.m2.2.2.2.4.3.cmml" xref="S4.E11.m2.2.2.2.4.3">𝑘</ci></apply></apply></apply><apply id="S4.E11.m2.5.5.1.1.2.2.2.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2"><times id="S4.E11.m2.5.5.1.1.2.2.2.3.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.3"></times><apply id="S4.E11.m2.5.5.1.1.2.2.2.4.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m2.5.5.1.1.2.2.2.4.1.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.4">superscript</csymbol><ci id="S4.E11.m2.5.5.1.1.2.2.2.4.2.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.4.2">ℓ</ci><ci id="S4.E11.m2.5.5.1.1.2.2.2.4.3.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.4.3">𝑝</ci></apply><vector id="S4.E11.m2.5.5.1.1.2.2.2.2.3.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.2.2"><apply id="S4.E11.m2.3.3.cmml" xref="S4.E11.m2.3.3"><ci id="S4.E11.m2.3.3.1.cmml" xref="S4.E11.m2.3.3.1">^</ci><ci id="S4.E11.m2.3.3.2.cmml" xref="S4.E11.m2.3.3.2">𝐰</ci></apply><apply id="S4.E11.m2.4.4.cmml" xref="S4.E11.m2.4.4"><ci id="S4.E11.m2.4.4.1.cmml" xref="S4.E11.m2.4.4.1">¯</ci><ci id="S4.E11.m2.4.4.2.cmml" xref="S4.E11.m2.4.4.2">𝐰</ci></apply><apply id="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m2.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m2.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m2.5.5.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E11.m2.5.5.1.1.2.2.2.2.2.2.3">𝑖</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m2.5c">\displaystyle=\frac{1}{n_{k}}\sum_{(\mathbf{x}_{i},y_{i})\in\mathcal{D}_{k}}\ell^{p}(\hat{\mathbf{w}},\overline{\mathbf{w}};\mathbf{x}_{i},y_{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p3.9" class="ltx_p">Personalization will be reached after several iterative stages of finetuning in Figure <a href="#S4.F3" title="Figure 3 ‣ 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The pseudo code of the personalized local finetuning is shown in Algorithm 2 in Appendix.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments and Results</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Settings</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets and Models.</span> Following previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, we use three vision datasets to conduct experiments: CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, CIFAR-100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, and Tiny-ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Tiny-ImageNet is a subset of ImageNet with 100k samples of 200 classes. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, we adopt ResNet20 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> for CIFAR-10/100 and use ResNet-18 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> for Tiny-ImageNet. We use a linear layer as the classifier for the baselines and as the projection layer for our method.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Compared Methods.</span> We take three lines of methods as baselines.
<span id="S5.SS1.p2.1.2" class="ltx_text ltx_font_bold ltx_font_italic">1) Classical FL with Non-IID data:</span> <span id="S5.SS1.p2.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> with vanilla local training, a simple but strong baseline; <span id="S5.SS1.p2.1.4" class="ltx_text ltx_font_smallcaps">FedProx</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, FL with proximal regularization at clients; <span id="S5.SS1.p2.1.5" class="ltx_text ltx_font_smallcaps">FedDyn</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, FL based on dynamic regularization.
<span id="S5.SS1.p2.1.6" class="ltx_text ltx_font_bold ltx_font_italic">2) Personalized FL:</span> <span id="S5.SS1.p2.1.7" class="ltx_text ltx_font_smallcaps">Ditto</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, personalization through separated local models; <span id="S5.SS1.p2.1.8" class="ltx_text ltx_font_smallcaps">FedRep</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, personalization by only aggregating feature extractors; <span id="S5.SS1.p2.1.9" class="ltx_text ltx_font_smallcaps">FedRoD</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, personalization through decoupling models.
<span id="S5.SS1.p2.1.10" class="ltx_text ltx_font_bold ltx_font_italic">3) FL methods most relevant to ours:</span> <span id="S5.SS1.p2.1.11" class="ltx_text ltx_font_smallcaps">CCVR</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, FL with classifier retraining; <span id="S5.SS1.p2.1.12" class="ltx_text ltx_font_smallcaps">FedProto</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>, FL with only prototype sharing; <span id="S5.SS1.p2.1.13" class="ltx_text ltx_font_smallcaps">FedRoD</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, generalization through decoupling and balanced softmax loss; <span id="S5.SS1.p2.1.14" class="ltx_text ltx_font_smallcaps">FedNH</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, FL with smoothing aggregation of prototypical classifiers.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 2: </span><span id="S5.T2.7.1" class="ltx_text ltx_font_bold">Results (%) under various numbers of clients with partial client sampling.</span> The dataset is CIFAR-10 with Non-IID <math id="S5.T2.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.T2.2.m1.1b"><mrow id="S5.T2.2.m1.1.1" xref="S5.T2.2.m1.1.1.cmml"><mi id="S5.T2.2.m1.1.1.2" xref="S5.T2.2.m1.1.1.2.cmml">α</mi><mo id="S5.T2.2.m1.1.1.1" xref="S5.T2.2.m1.1.1.1.cmml">=</mo><mn id="S5.T2.2.m1.1.1.3" xref="S5.T2.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.2.m1.1c"><apply id="S5.T2.2.m1.1.1.cmml" xref="S5.T2.2.m1.1.1"><eq id="S5.T2.2.m1.1.1.1.cmml" xref="S5.T2.2.m1.1.1.1"></eq><ci id="S5.T2.2.m1.1.1.2.cmml" xref="S5.T2.2.m1.1.1.2">𝛼</ci><cn type="float" id="S5.T2.2.m1.1.1.3.cmml" xref="S5.T2.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.m1.1d">\alpha=0.1</annotation></semantics></math>.</figcaption>
<table id="S5.T2.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.8.1.1" class="ltx_tr">
<th id="S5.T2.8.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.1.1.1.1" class="ltx_text" style="font-size:80%;">Number of Clients</span></th>
<td id="S5.T2.8.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="4"><span id="S5.T2.8.1.1.2.1" class="ltx_text" style="font-size:80%;">50</span></td>
<td id="S5.T2.8.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="4"><span id="S5.T2.8.1.1.3.1" class="ltx_text" style="font-size:80%;">100</span></td>
</tr>
<tr id="S5.T2.8.2.2" class="ltx_tr">
<th id="S5.T2.8.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.2.2.1.1" class="ltx_text" style="font-size:80%;">Sampling Rate</span></th>
<td id="S5.T2.8.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="2"><span id="S5.T2.8.2.2.2.1" class="ltx_text" style="font-size:80%;">0.4</span></td>
<td id="S5.T2.8.2.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="2"><span id="S5.T2.8.2.2.3.1" class="ltx_text" style="font-size:80%;">0.6</span></td>
<td id="S5.T2.8.2.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="2"><span id="S5.T2.8.2.2.4.1" class="ltx_text" style="font-size:80%;">0.4</span></td>
<td id="S5.T2.8.2.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="2"><span id="S5.T2.8.2.2.5.1" class="ltx_text" style="font-size:80%;">0.6</span></td>
</tr>
<tr id="S5.T2.8.3.3" class="ltx_tr">
<th id="S5.T2.8.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.1.1" class="ltx_text" style="font-size:80%;">Methods/Metrics</span></th>
<td id="S5.T2.8.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.2.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T2.8.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.3.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S5.T2.8.3.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.4.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T2.8.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.5.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S5.T2.8.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.6.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T2.8.3.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.7.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S5.T2.8.3.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.8.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T2.8.3.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.3.3.9.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
</tr>
<tr id="S5.T2.8.4.4" class="ltx_tr">
<th id="S5.T2.8.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedAvg</span><span id="S5.T2.8.4.4.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.8.4.4.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib33" title="" class="ltx_ref">33</a><span id="S5.T2.8.4.4.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S5.T2.8.4.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.2.1" class="ltx_text" style="font-size:80%;">38.13</span><span id="S5.T2.8.4.4.2.2" class="ltx_text" style="font-size:50%;">±5.12</span>
</td>
<td id="S5.T2.8.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.3.1" class="ltx_text" style="font-size:80%;">77.28</span><span id="S5.T2.8.4.4.3.2" class="ltx_text" style="font-size:50%;">±2.17</span>
</td>
<td id="S5.T2.8.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.4.1" class="ltx_text" style="font-size:80%;">42.68</span><span id="S5.T2.8.4.4.4.2" class="ltx_text" style="font-size:50%;">±6.28</span>
</td>
<td id="S5.T2.8.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.5.1" class="ltx_text" style="font-size:80%;">74.99</span><span id="S5.T2.8.4.4.5.2" class="ltx_text" style="font-size:50%;">±2.34</span>
</td>
<td id="S5.T2.8.4.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.6.1" class="ltx_text" style="font-size:80%;">42.15</span><span id="S5.T2.8.4.4.6.2" class="ltx_text" style="font-size:50%;">±1.61</span>
</td>
<td id="S5.T2.8.4.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.7.1" class="ltx_text" style="font-size:80%;">71.52</span><span id="S5.T2.8.4.4.7.2" class="ltx_text" style="font-size:50%;">±1.88</span>
</td>
<td id="S5.T2.8.4.4.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.8.1" class="ltx_text" style="font-size:80%;">41.42</span><span id="S5.T2.8.4.4.8.2" class="ltx_text" style="font-size:50%;">±3.31</span>
</td>
<td id="S5.T2.8.4.4.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.4.4.9.1" class="ltx_text" style="font-size:80%;">70.40</span><span id="S5.T2.8.4.4.9.2" class="ltx_text" style="font-size:50%;">±2.13</span>
</td>
</tr>
<tr id="S5.T2.8.5.5" class="ltx_tr">
<th id="S5.T2.8.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.5.5.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">CCVR</span><span id="S5.T2.8.5.5.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.8.5.5.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">32</a><span id="S5.T2.8.5.5.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S5.T2.8.5.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.5.5.2.1" class="ltx_text" style="font-size:80%;">44.59</span><span id="S5.T2.8.5.5.2.2" class="ltx_text" style="font-size:50%;">±11.4</span>
</td>
<td id="S5.T2.8.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.5.5.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">78.93<span id="S5.T2.8.5.5.3.1.1" class="ltx_text" style="font-size:63%;">±3.26</span></span></td>
<td id="S5.T2.8.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.5.5.4.1" class="ltx_text" style="font-size:80%;">52.49</span><span id="S5.T2.8.5.5.4.2" class="ltx_text" style="font-size:50%;">±6.73</span>
</td>
<td id="S5.T2.8.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.5.5.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">82.33<span id="S5.T2.8.5.5.5.1.1" class="ltx_text" style="font-size:63%;">±1.72</span></span></td>
<td id="S5.T2.8.5.5.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.5.5.6.1" class="ltx_text" style="font-size:80%;">50.07</span><span id="S5.T2.8.5.5.6.2" class="ltx_text" style="font-size:50%;">±0.80</span>
</td>
<td id="S5.T2.8.5.5.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.5.5.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">76.27<span id="S5.T2.8.5.5.7.1.1" class="ltx_text" style="font-size:63%;">±2.08</span></span></td>
<td id="S5.T2.8.5.5.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.5.5.8.1" class="ltx_text" style="font-size:80%;">50.41</span><span id="S5.T2.8.5.5.8.2" class="ltx_text" style="font-size:50%;">±3.93</span>
</td>
<td id="S5.T2.8.5.5.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.5.5.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">77.27<span id="S5.T2.8.5.5.9.1.1" class="ltx_text" style="font-size:63%;">±1.22</span></span></td>
</tr>
<tr id="S5.T2.8.6.6" class="ltx_tr">
<th id="S5.T2.8.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.6.6.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedRoD</span><span id="S5.T2.8.6.6.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.8.6.6.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S5.T2.8.6.6.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S5.T2.8.6.6.2" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.6.6.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">55.84<span id="S5.T2.8.6.6.2.1.1" class="ltx_text" style="font-size:63%;">±3.96</span></span></td>
<td id="S5.T2.8.6.6.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.6.6.3.1" class="ltx_text" style="font-size:80%;">76.60</span><span id="S5.T2.8.6.6.3.2" class="ltx_text" style="font-size:50%;">±0.13</span>
</td>
<td id="S5.T2.8.6.6.4" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.6.6.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">53.04<span id="S5.T2.8.6.6.4.1.1" class="ltx_text" style="font-size:63%;">±2.54</span></span></td>
<td id="S5.T2.8.6.6.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.6.6.5.1" class="ltx_text" style="font-size:80%;">74.42</span><span id="S5.T2.8.6.6.5.2" class="ltx_text" style="font-size:50%;">±1.99</span>
</td>
<td id="S5.T2.8.6.6.6" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.6.6.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">52.62<span id="S5.T2.8.6.6.6.1.1" class="ltx_text" style="font-size:63%;">±1.68</span></span></td>
<td id="S5.T2.8.6.6.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.6.6.7.1" class="ltx_text" style="font-size:80%;">71.27</span><span id="S5.T2.8.6.6.7.2" class="ltx_text" style="font-size:50%;">±0.69</span>
</td>
<td id="S5.T2.8.6.6.8" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.6.6.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">52.34<span id="S5.T2.8.6.6.8.1.1" class="ltx_text" style="font-size:63%;">±0.11</span></span></td>
<td id="S5.T2.8.6.6.9" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.6.6.9.1" class="ltx_text" style="font-size:80%;">72.41</span><span id="S5.T2.8.6.6.9.2" class="ltx_text" style="font-size:50%;">±0.74</span>
</td>
</tr>
<tr id="S5.T2.8.7.7" class="ltx_tr">
<th id="S5.T2.8.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedNH</span><span id="S5.T2.8.7.7.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.8.7.7.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S5.T2.8.7.7.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S5.T2.8.7.7.2" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.2.1" class="ltx_text" style="font-size:80%;">39.97</span><span id="S5.T2.8.7.7.2.2" class="ltx_text" style="font-size:50%;">±6.90</span>
</td>
<td id="S5.T2.8.7.7.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.3.1" class="ltx_text" style="font-size:80%;">76.59</span><span id="S5.T2.8.7.7.3.2" class="ltx_text" style="font-size:50%;">±0.59</span>
</td>
<td id="S5.T2.8.7.7.4" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.4.1" class="ltx_text" style="font-size:80%;">45.36</span><span id="S5.T2.8.7.7.4.2" class="ltx_text" style="font-size:50%;">±3.58</span>
</td>
<td id="S5.T2.8.7.7.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.5.1" class="ltx_text" style="font-size:80%;">78.17</span><span id="S5.T2.8.7.7.5.2" class="ltx_text" style="font-size:50%;">±1.15</span>
</td>
<td id="S5.T2.8.7.7.6" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.6.1" class="ltx_text" style="font-size:80%;">42.77</span><span id="S5.T2.8.7.7.6.2" class="ltx_text" style="font-size:50%;">±0.65</span>
</td>
<td id="S5.T2.8.7.7.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.7.1" class="ltx_text" style="font-size:80%;">73.47</span><span id="S5.T2.8.7.7.7.2" class="ltx_text" style="font-size:50%;">±1.38</span>
</td>
<td id="S5.T2.8.7.7.8" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.8.1" class="ltx_text" style="font-size:80%;">45.85</span><span id="S5.T2.8.7.7.8.2" class="ltx_text" style="font-size:50%;">±2.98</span>
</td>
<td id="S5.T2.8.7.7.9" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.7.7.9.1" class="ltx_text" style="font-size:80%;">73.15</span><span id="S5.T2.8.7.7.9.2" class="ltx_text" style="font-size:50%;">±0.95</span>
</td>
</tr>
<tr id="S5.T2.8.8.8" class="ltx_tr">
<th id="S5.T2.8.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T2.8.8.8.1.1" class="ltx_ERROR undefined">\rowcolor</span><span id="S5.T2.8.8.8.1.2" class="ltx_text" style="font-size:80%;">gray!20</span><span id="S5.T2.8.8.8.1.3" class="ltx_text ltx_font_bold" style="font-size:80%;">Our <span id="S5.T2.8.8.8.1.3.1" class="ltx_text ltx_font_smallcaps">FedETF</span></span>
</th>
<td id="S5.T2.8.8.8.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.8.8.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">58.05<span id="S5.T2.8.8.8.2.1.1" class="ltx_text" style="font-size:63%;">±4.63</span></span></td>
<td id="S5.T2.8.8.8.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.8.8.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">85.82<span id="S5.T2.8.8.8.3.1.1" class="ltx_text" style="font-size:63%;">±0.86</span></span></td>
<td id="S5.T2.8.8.8.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">58.75<span id="S5.T2.8.8.8.4.1.1" class="ltx_text" style="font-size:63%;">±1.72</span></span></td>
<td id="S5.T2.8.8.8.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.8.8.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">85.05<span id="S5.T2.8.8.8.5.1.1" class="ltx_text" style="font-size:63%;">±0.87</span></span></td>
<td id="S5.T2.8.8.8.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.8.8.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">56.67<span id="S5.T2.8.8.8.6.1.1" class="ltx_text" style="font-size:63%;">±0.88</span></span></td>
<td id="S5.T2.8.8.8.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.8.8.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">83.47<span id="S5.T2.8.8.8.7.1.1" class="ltx_text" style="font-size:63%;">±0.45</span></span></td>
<td id="S5.T2.8.8.8.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.8.8.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">55.96<span id="S5.T2.8.8.8.8.1.1" class="ltx_text" style="font-size:63%;">±0.23</span></span></td>
<td id="S5.T2.8.8.8.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T2.8.8.8.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">83.38<span id="S5.T2.8.8.8.9.1.1" class="ltx_text" style="font-size:63%;">±0.72</span></span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 3: </span><span id="S5.T3.3.1" class="ltx_text ltx_font_bold">Results (%) under different local epochs (<math id="S5.T3.3.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.T3.3.1.m1.1b"><mi id="S5.T3.3.1.m1.1.1" xref="S5.T3.3.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.T3.3.1.m1.1c"><ci id="S5.T3.3.1.m1.1.1.cmml" xref="S5.T3.3.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.1.m1.1d">E</annotation></semantics></math>).</span> The dataset is CIFAR-10 with Non-IID <math id="S5.T3.4.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.T3.4.m1.1b"><mrow id="S5.T3.4.m1.1.1" xref="S5.T3.4.m1.1.1.cmml"><mi id="S5.T3.4.m1.1.1.2" xref="S5.T3.4.m1.1.1.2.cmml">α</mi><mo id="S5.T3.4.m1.1.1.1" xref="S5.T3.4.m1.1.1.1.cmml">=</mo><mn id="S5.T3.4.m1.1.1.3" xref="S5.T3.4.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.4.m1.1c"><apply id="S5.T3.4.m1.1.1.cmml" xref="S5.T3.4.m1.1.1"><eq id="S5.T3.4.m1.1.1.1.cmml" xref="S5.T3.4.m1.1.1.1"></eq><ci id="S5.T3.4.m1.1.1.2.cmml" xref="S5.T3.4.m1.1.1.2">𝛼</ci><cn type="float" id="S5.T3.4.m1.1.1.3.cmml" xref="S5.T3.4.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.m1.1d">\alpha=0.1</annotation></semantics></math>.</figcaption>
<table id="S5.T3.5" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.5.1" class="ltx_tr">
<th id="S5.T3.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" style="padding-left:10.8pt;padding-right:10.8pt;"><math id="S5.T3.5.1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.T3.5.1.1.m1.1a"><mi mathsize="80%" id="S5.T3.5.1.1.m1.1.1" xref="S5.T3.5.1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.T3.5.1.1.m1.1b"><ci id="S5.T3.5.1.1.m1.1.1.cmml" xref="S5.T3.5.1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.1.1.m1.1c">E</annotation></semantics></math></th>
<td id="S5.T3.5.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="2"><span id="S5.T3.5.1.2.1" class="ltx_text" style="font-size:80%;">1</span></td>
<td id="S5.T3.5.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="2"><span id="S5.T3.5.1.3.1" class="ltx_text" style="font-size:80%;">2</span></td>
<td id="S5.T3.5.1.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="2"><span id="S5.T3.5.1.4.1" class="ltx_text" style="font-size:80%;">4</span></td>
<td id="S5.T3.5.1.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:10.8pt;padding-right:10.8pt;" colspan="2"><span id="S5.T3.5.1.5.1" class="ltx_text" style="font-size:80%;">8</span></td>
</tr>
<tr id="S5.T3.5.2.1" class="ltx_tr">
<th id="S5.T3.5.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.1.1" class="ltx_text" style="font-size:80%;">Methods/Metrics</span></th>
<td id="S5.T3.5.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.2.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T3.5.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.3.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S5.T3.5.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.4.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T3.5.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.5.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S5.T3.5.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.6.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T3.5.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.7.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S5.T3.5.2.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.8.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T3.5.2.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.2.1.9.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
</tr>
<tr id="S5.T3.5.3.2" class="ltx_tr">
<th id="S5.T3.5.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedAvg</span><span id="S5.T3.5.3.2.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T3.5.3.2.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib33" title="" class="ltx_ref">33</a><span id="S5.T3.5.3.2.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S5.T3.5.3.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.2.1" class="ltx_text" style="font-size:80%;">45.75</span><span id="S5.T3.5.3.2.2.2" class="ltx_text" style="font-size:50%;">±1.97</span>
</td>
<td id="S5.T3.5.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.3.1" class="ltx_text" style="font-size:80%;">74.18</span><span id="S5.T3.5.3.2.3.2" class="ltx_text" style="font-size:50%;">±2.22</span>
</td>
<td id="S5.T3.5.3.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.4.1" class="ltx_text" style="font-size:80%;">43.02</span><span id="S5.T3.5.3.2.4.2" class="ltx_text" style="font-size:50%;">±2.16</span>
</td>
<td id="S5.T3.5.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.5.1" class="ltx_text" style="font-size:80%;">77.45</span><span id="S5.T3.5.3.2.5.2" class="ltx_text" style="font-size:50%;">±0.79</span>
</td>
<td id="S5.T3.5.3.2.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.6.1" class="ltx_text" style="font-size:80%;">36.30</span><span id="S5.T3.5.3.2.6.2" class="ltx_text" style="font-size:50%;">±2.88</span>
</td>
<td id="S5.T3.5.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.7.1" class="ltx_text" style="font-size:80%;">80.66</span><span id="S5.T3.5.3.2.7.2" class="ltx_text" style="font-size:50%;">±1.37</span>
</td>
<td id="S5.T3.5.3.2.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.8.1" class="ltx_text" style="font-size:80%;">32.58</span><span id="S5.T3.5.3.2.8.2" class="ltx_text" style="font-size:50%;">±4.87</span>
</td>
<td id="S5.T3.5.3.2.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.3.2.9.1" class="ltx_text" style="font-size:80%;">84.24</span><span id="S5.T3.5.3.2.9.2" class="ltx_text" style="font-size:50%;">±0.92</span>
</td>
</tr>
<tr id="S5.T3.5.4.3" class="ltx_tr">
<th id="S5.T3.5.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.4.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">CCVR</span><span id="S5.T3.5.4.3.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T3.5.4.3.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib32" title="" class="ltx_ref">32</a><span id="S5.T3.5.4.3.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S5.T3.5.4.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.4.3.2.1" class="ltx_text" style="font-size:80%;">59.82</span><span id="S5.T3.5.4.3.2.2" class="ltx_text" style="font-size:50%;">±4.35</span>
</td>
<td id="S5.T3.5.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.4.3.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">79.83<span id="S5.T3.5.4.3.3.1.1" class="ltx_text" style="font-size:63%;">±1.66</span></span></td>
<td id="S5.T3.5.4.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.4.3.4.1" class="ltx_text" style="font-size:80%;">53.73</span><span id="S5.T3.5.4.3.4.2" class="ltx_text" style="font-size:50%;">±8.48</span>
</td>
<td id="S5.T3.5.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.4.3.5.1" class="ltx_text" style="font-size:80%;">80.43</span><span id="S5.T3.5.4.3.5.2" class="ltx_text" style="font-size:50%;">±2.54</span>
</td>
<td id="S5.T3.5.4.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.4.3.6.1" class="ltx_text" style="font-size:80%;">55.73</span><span id="S5.T3.5.4.3.6.2" class="ltx_text" style="font-size:50%;">±4.00</span>
</td>
<td id="S5.T3.5.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.4.3.7.1" class="ltx_text" style="font-size:80%;">81.83</span><span id="S5.T3.5.4.3.7.2" class="ltx_text" style="font-size:50%;">±1.32</span>
</td>
<td id="S5.T3.5.4.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.4.3.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">55.00<span id="S5.T3.5.4.3.8.1.1" class="ltx_text" style="font-size:63%;">±2.29</span></span></td>
<td id="S5.T3.5.4.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.4.3.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">85.61<span id="S5.T3.5.4.3.9.1.1" class="ltx_text" style="font-size:63%;">±1.12</span></span></td>
</tr>
<tr id="S5.T3.5.5.4" class="ltx_tr">
<th id="S5.T3.5.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.5.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedRoD</span><span id="S5.T3.5.5.4.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T3.5.5.4.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S5.T3.5.5.4.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S5.T3.5.5.4.2" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.5.4.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">60.34<span id="S5.T3.5.5.4.2.1.1" class="ltx_text" style="font-size:63%;">±3.22</span></span></td>
<td id="S5.T3.5.5.4.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.5.4.3.1" class="ltx_text" style="font-size:80%;">77.10</span><span id="S5.T3.5.5.4.3.2" class="ltx_text" style="font-size:50%;">±1.97</span>
</td>
<td id="S5.T3.5.5.4.4" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.5.4.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">56.74<span id="S5.T3.5.5.4.4.1.1" class="ltx_text" style="font-size:63%;">±5.59</span></span></td>
<td id="S5.T3.5.5.4.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.5.4.5.1" class="ltx_text" style="font-size:80%;">76.96</span><span id="S5.T3.5.5.4.5.2" class="ltx_text" style="font-size:50%;">±4.26</span>
</td>
<td id="S5.T3.5.5.4.6" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.5.4.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">57.85<span id="S5.T3.5.5.4.6.1.1" class="ltx_text" style="font-size:63%;">±5.22</span></span></td>
<td id="S5.T3.5.5.4.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.5.4.7.1" class="ltx_text" style="font-size:80%;">81.08</span><span id="S5.T3.5.5.4.7.2" class="ltx_text" style="font-size:50%;">±1.74</span>
</td>
<td id="S5.T3.5.5.4.8" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.5.4.8.1" class="ltx_text" style="font-size:80%;">50.63</span><span id="S5.T3.5.5.4.8.2" class="ltx_text" style="font-size:50%;">±9.49</span>
</td>
<td id="S5.T3.5.5.4.9" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.5.4.9.1" class="ltx_text" style="font-size:80%;">84.75</span><span id="S5.T3.5.5.4.9.2" class="ltx_text" style="font-size:50%;">±0.96</span>
</td>
</tr>
<tr id="S5.T3.5.6.5" class="ltx_tr">
<th id="S5.T3.5.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.6.5.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedNH</span><span id="S5.T3.5.6.5.1.2" class="ltx_text" style="font-size:80%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T3.5.6.5.1.3.1" class="ltx_text" style="font-size:80%;">[</span><a href="#bib.bib5" title="" class="ltx_ref">5</a><span id="S5.T3.5.6.5.1.4.2" class="ltx_text" style="font-size:80%;">]</span></cite>
</th>
<td id="S5.T3.5.6.5.2" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.6.5.2.1" class="ltx_text" style="font-size:80%;">39.14</span><span id="S5.T3.5.6.5.2.2" class="ltx_text" style="font-size:50%;">±9.56</span>
</td>
<td id="S5.T3.5.6.5.3" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.6.5.3.1" class="ltx_text" style="font-size:80%;">77.27</span><span id="S5.T3.5.6.5.3.2" class="ltx_text" style="font-size:50%;">±1.53</span>
</td>
<td id="S5.T3.5.6.5.4" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.6.5.4.1" class="ltx_text" style="font-size:80%;">45.13</span><span id="S5.T3.5.6.5.4.2" class="ltx_text" style="font-size:50%;">±1.60</span>
</td>
<td id="S5.T3.5.6.5.5" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.6.5.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">81.84<span id="S5.T3.5.6.5.5.1.1" class="ltx_text" style="font-size:63%;">±0.88</span></span></td>
<td id="S5.T3.5.6.5.6" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.6.5.6.1" class="ltx_text" style="font-size:80%;">40.28</span><span id="S5.T3.5.6.5.6.2" class="ltx_text" style="font-size:50%;">±2.78</span>
</td>
<td id="S5.T3.5.6.5.7" class="ltx_td ltx_align_center ltx_border_r" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.6.5.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">82.90<span id="S5.T3.5.6.5.7.1.1" class="ltx_text" style="font-size:63%;">±1.00</span></span></td>
<td id="S5.T3.5.6.5.8" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.6.5.8.1" class="ltx_text" style="font-size:80%;">39.18</span><span id="S5.T3.5.6.5.8.2" class="ltx_text" style="font-size:50%;">±3.66</span>
</td>
<td id="S5.T3.5.6.5.9" class="ltx_td ltx_align_center" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.6.5.9.1" class="ltx_text" style="font-size:80%;">83.95</span><span id="S5.T3.5.6.5.9.2" class="ltx_text" style="font-size:50%;">±1.23</span>
</td>
</tr>
<tr id="S5.T3.5.7.6" class="ltx_tr">
<th id="S5.T3.5.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;">
<span id="S5.T3.5.7.6.1.1" class="ltx_ERROR undefined">\rowcolor</span><span id="S5.T3.5.7.6.1.2" class="ltx_text" style="font-size:80%;">gray!20</span><span id="S5.T3.5.7.6.1.3" class="ltx_text ltx_font_bold" style="font-size:80%;">Our <span id="S5.T3.5.7.6.1.3.1" class="ltx_text ltx_font_smallcaps">FedETF</span></span>
</th>
<td id="S5.T3.5.7.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.7.6.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">62.76<span id="S5.T3.5.7.6.2.1.1" class="ltx_text" style="font-size:63%;">±2.90</span></span></td>
<td id="S5.T3.5.7.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.7.6.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.00<span id="S5.T3.5.7.6.3.1.1" class="ltx_text" style="font-size:63%;">±0.65</span></span></td>
<td id="S5.T3.5.7.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.7.6.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">62.34<span id="S5.T3.5.7.6.4.1.1" class="ltx_text" style="font-size:63%;">±4.10</span></span></td>
<td id="S5.T3.5.7.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.7.6.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.20<span id="S5.T3.5.7.6.5.1.1" class="ltx_text" style="font-size:63%;">±0.93</span></span></td>
<td id="S5.T3.5.7.6.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.7.6.6.1" class="ltx_text ltx_font_bold" style="font-size:80%;">61.78<span id="S5.T3.5.7.6.6.1.1" class="ltx_text" style="font-size:63%;">±3.21</span></span></td>
<td id="S5.T3.5.7.6.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.7.6.7.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.46<span id="S5.T3.5.7.6.7.1.1" class="ltx_text" style="font-size:63%;">±0.75</span></span></td>
<td id="S5.T3.5.7.6.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.7.6.8.1" class="ltx_text ltx_font_bold" style="font-size:80%;">54.23<span id="S5.T3.5.7.6.8.1.1" class="ltx_text" style="font-size:63%;">±10.8</span></span></td>
<td id="S5.T3.5.7.6.9" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:10.8pt;padding-right:10.8pt;"><span id="S5.T3.5.7.6.9.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.40<span id="S5.T3.5.7.6.9.1.1" class="ltx_text" style="font-size:63%;">±0.98</span></span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.8" class="ltx_p"><span id="S5.SS1.p3.8.1" class="ltx_text ltx_font_bold">Client Settings.</span> We adopt the Dirichlet sampling to generate Non-IID data for each client. We note that the Dirichlet-sampling-based data heterogeneity is widely used in FL literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. It considers a class-imbalanced data heterogeneity, controlled by hyperparameter <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mi id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><ci id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\alpha</annotation></semantics></math>, and smaller <math id="S5.SS1.p3.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.p3.2.m2.1a"><mi id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><ci id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">\alpha</annotation></semantics></math> refers to more Non-IID data of clients.
In our experiments, we evaluate the methods under strong Non-IID settings with <math id="S5.SS1.p3.3.m3.2" class="ltx_Math" alttext="\alpha\in\{0.1,0.05\}" display="inline"><semantics id="S5.SS1.p3.3.m3.2a"><mrow id="S5.SS1.p3.3.m3.2.3" xref="S5.SS1.p3.3.m3.2.3.cmml"><mi id="S5.SS1.p3.3.m3.2.3.2" xref="S5.SS1.p3.3.m3.2.3.2.cmml">α</mi><mo id="S5.SS1.p3.3.m3.2.3.1" xref="S5.SS1.p3.3.m3.2.3.1.cmml">∈</mo><mrow id="S5.SS1.p3.3.m3.2.3.3.2" xref="S5.SS1.p3.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS1.p3.3.m3.2.3.3.2.1" xref="S5.SS1.p3.3.m3.2.3.3.1.cmml">{</mo><mn id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml">0.1</mn><mo id="S5.SS1.p3.3.m3.2.3.3.2.2" xref="S5.SS1.p3.3.m3.2.3.3.1.cmml">,</mo><mn id="S5.SS1.p3.3.m3.2.2" xref="S5.SS1.p3.3.m3.2.2.cmml">0.05</mn><mo stretchy="false" id="S5.SS1.p3.3.m3.2.3.3.2.3" xref="S5.SS1.p3.3.m3.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.2b"><apply id="S5.SS1.p3.3.m3.2.3.cmml" xref="S5.SS1.p3.3.m3.2.3"><in id="S5.SS1.p3.3.m3.2.3.1.cmml" xref="S5.SS1.p3.3.m3.2.3.1"></in><ci id="S5.SS1.p3.3.m3.2.3.2.cmml" xref="S5.SS1.p3.3.m3.2.3.2">𝛼</ci><set id="S5.SS1.p3.3.m3.2.3.3.1.cmml" xref="S5.SS1.p3.3.m3.2.3.3.2"><cn type="float" id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1">0.1</cn><cn type="float" id="S5.SS1.p3.3.m3.2.2.cmml" xref="S5.SS1.p3.3.m3.2.2">0.05</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.2c">\alpha\in\{0.1,0.05\}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite>.
If without mentioning otherwise, the number of clients <math id="S5.SS1.p3.4.m4.1" class="ltx_Math" alttext="K=20" display="inline"><semantics id="S5.SS1.p3.4.m4.1a"><mrow id="S5.SS1.p3.4.m4.1.1" xref="S5.SS1.p3.4.m4.1.1.cmml"><mi id="S5.SS1.p3.4.m4.1.1.2" xref="S5.SS1.p3.4.m4.1.1.2.cmml">K</mi><mo id="S5.SS1.p3.4.m4.1.1.1" xref="S5.SS1.p3.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.4.m4.1.1.3" xref="S5.SS1.p3.4.m4.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.4.m4.1b"><apply id="S5.SS1.p3.4.m4.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1"><eq id="S5.SS1.p3.4.m4.1.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1.1"></eq><ci id="S5.SS1.p3.4.m4.1.1.2.cmml" xref="S5.SS1.p3.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S5.SS1.p3.4.m4.1.1.3.cmml" xref="S5.SS1.p3.4.m4.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.4.m4.1c">K=20</annotation></semantics></math> and we adopt full client participation.
For CIFAR-10 and CIFAR-100 the number of local epochs <math id="S5.SS1.p3.5.m5.1" class="ltx_Math" alttext="E=3" display="inline"><semantics id="S5.SS1.p3.5.m5.1a"><mrow id="S5.SS1.p3.5.m5.1.1" xref="S5.SS1.p3.5.m5.1.1.cmml"><mi id="S5.SS1.p3.5.m5.1.1.2" xref="S5.SS1.p3.5.m5.1.1.2.cmml">E</mi><mo id="S5.SS1.p3.5.m5.1.1.1" xref="S5.SS1.p3.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.5.m5.1.1.3" xref="S5.SS1.p3.5.m5.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.5.m5.1b"><apply id="S5.SS1.p3.5.m5.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1"><eq id="S5.SS1.p3.5.m5.1.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1.1"></eq><ci id="S5.SS1.p3.5.m5.1.1.2.cmml" xref="S5.SS1.p3.5.m5.1.1.2">𝐸</ci><cn type="integer" id="S5.SS1.p3.5.m5.1.1.3.cmml" xref="S5.SS1.p3.5.m5.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.5.m5.1c">E=3</annotation></semantics></math> and the number of communication rounds <math id="S5.SS1.p3.6.m6.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S5.SS1.p3.6.m6.1a"><mrow id="S5.SS1.p3.6.m6.1.1" xref="S5.SS1.p3.6.m6.1.1.cmml"><mi id="S5.SS1.p3.6.m6.1.1.2" xref="S5.SS1.p3.6.m6.1.1.2.cmml">T</mi><mo id="S5.SS1.p3.6.m6.1.1.1" xref="S5.SS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.6.m6.1.1.3" xref="S5.SS1.p3.6.m6.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.6.m6.1b"><apply id="S5.SS1.p3.6.m6.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1"><eq id="S5.SS1.p3.6.m6.1.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1.1"></eq><ci id="S5.SS1.p3.6.m6.1.1.2.cmml" xref="S5.SS1.p3.6.m6.1.1.2">𝑇</ci><cn type="integer" id="S5.SS1.p3.6.m6.1.1.3.cmml" xref="S5.SS1.p3.6.m6.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.6.m6.1c">T=200</annotation></semantics></math>, while for Tiny-ImageNet, considering the high computation costs, we set <math id="S5.SS1.p3.7.m7.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S5.SS1.p3.7.m7.1a"><mrow id="S5.SS1.p3.7.m7.1.1" xref="S5.SS1.p3.7.m7.1.1.cmml"><mi id="S5.SS1.p3.7.m7.1.1.2" xref="S5.SS1.p3.7.m7.1.1.2.cmml">E</mi><mo id="S5.SS1.p3.7.m7.1.1.1" xref="S5.SS1.p3.7.m7.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.7.m7.1.1.3" xref="S5.SS1.p3.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.7.m7.1b"><apply id="S5.SS1.p3.7.m7.1.1.cmml" xref="S5.SS1.p3.7.m7.1.1"><eq id="S5.SS1.p3.7.m7.1.1.1.cmml" xref="S5.SS1.p3.7.m7.1.1.1"></eq><ci id="S5.SS1.p3.7.m7.1.1.2.cmml" xref="S5.SS1.p3.7.m7.1.1.2">𝐸</ci><cn type="integer" id="S5.SS1.p3.7.m7.1.1.3.cmml" xref="S5.SS1.p3.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.7.m7.1c">E=1</annotation></semantics></math> and <math id="S5.SS1.p3.8.m8.1" class="ltx_Math" alttext="T=50" display="inline"><semantics id="S5.SS1.p3.8.m8.1a"><mrow id="S5.SS1.p3.8.m8.1.1" xref="S5.SS1.p3.8.m8.1.1.cmml"><mi id="S5.SS1.p3.8.m8.1.1.2" xref="S5.SS1.p3.8.m8.1.1.2.cmml">T</mi><mo id="S5.SS1.p3.8.m8.1.1.1" xref="S5.SS1.p3.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.8.m8.1.1.3" xref="S5.SS1.p3.8.m8.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.8.m8.1b"><apply id="S5.SS1.p3.8.m8.1.1.cmml" xref="S5.SS1.p3.8.m8.1.1"><eq id="S5.SS1.p3.8.m8.1.1.1.cmml" xref="S5.SS1.p3.8.m8.1.1.1"></eq><ci id="S5.SS1.p3.8.m8.1.1.2.cmml" xref="S5.SS1.p3.8.m8.1.1.2">𝑇</ci><cn type="integer" id="S5.SS1.p3.8.m8.1.1.3.cmml" xref="S5.SS1.p3.8.m8.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.8.m8.1c">T=50</annotation></semantics></math>.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.p4.1" class="ltx_p"><span id="S5.SS1.p4.1.1" class="ltx_text ltx_font_bold">Evaluation Metrics.</span> We test the generalization of the aggregated global model (General.) and the personalization of clients’ local models (Personal.). Generalization performance is validated on the balanced testset of each dataset after the global model is generated on the server. For each client, we split 70% of the local data for the trainset and 30% for the testset. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, we validate the personalization performance on each client’s local testset after the local training and average the personalized accuracies.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para ltx_noindent">
<p id="S5.SS1.p5.1" class="ltx_p"><span id="S5.SS1.p5.1.1" class="ltx_text ltx_font_bold">Implementation.</span> In all the experiments, we conduct three trials for each setting and present the mean accuracy and the standard deviation in the tables. For more implementation details, please refer to the Appendix.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Main Results</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.2" class="ltx_p"><span id="S5.SS2.p1.2.1" class="ltx_text ltx_font_bold">Results under various vision datasets and data heterogeneity.</span> Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the results of all methods on three vision datasets with Non-IID <math id="S5.SS2.p1.1.m1.2" class="ltx_Math" alttext="\alpha\in\{0.1,0.05\}" display="inline"><semantics id="S5.SS2.p1.1.m1.2a"><mrow id="S5.SS2.p1.1.m1.2.3" xref="S5.SS2.p1.1.m1.2.3.cmml"><mi id="S5.SS2.p1.1.m1.2.3.2" xref="S5.SS2.p1.1.m1.2.3.2.cmml">α</mi><mo id="S5.SS2.p1.1.m1.2.3.1" xref="S5.SS2.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S5.SS2.p1.1.m1.2.3.3.2" xref="S5.SS2.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS2.p1.1.m1.2.3.3.2.1" xref="S5.SS2.p1.1.m1.2.3.3.1.cmml">{</mo><mn id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">0.1</mn><mo id="S5.SS2.p1.1.m1.2.3.3.2.2" xref="S5.SS2.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S5.SS2.p1.1.m1.2.2" xref="S5.SS2.p1.1.m1.2.2.cmml">0.05</mn><mo stretchy="false" id="S5.SS2.p1.1.m1.2.3.3.2.3" xref="S5.SS2.p1.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.2b"><apply id="S5.SS2.p1.1.m1.2.3.cmml" xref="S5.SS2.p1.1.m1.2.3"><in id="S5.SS2.p1.1.m1.2.3.1.cmml" xref="S5.SS2.p1.1.m1.2.3.1"></in><ci id="S5.SS2.p1.1.m1.2.3.2.cmml" xref="S5.SS2.p1.1.m1.2.3.2">𝛼</ci><set id="S5.SS2.p1.1.m1.2.3.3.1.cmml" xref="S5.SS2.p1.1.m1.2.3.3.2"><cn type="float" id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">0.1</cn><cn type="float" id="S5.SS2.p1.1.m1.2.2.cmml" xref="S5.SS2.p1.1.m1.2.2">0.05</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.2c">\alpha\in\{0.1,0.05\}</annotation></semantics></math>. <span id="S5.SS2.p1.2.2" class="ltx_text ltx_font_italic">Our method achieves state-of-the-art performances in 11 out of 12 settings in both generalization and personalization. It is notable that except for our <span id="S5.SS2.p1.2.2.1" class="ltx_text ltx_font_smallcaps">FedETF</span>, there is no comparable baseline that can achieve high results in all datasets.</span> Generally, our method has more significant improvement under more heterogeneous settings (<math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS2.p1.2.m2.1.1.1" xref="S5.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><eq id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1"></eq><ci id="S5.SS2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.p1.2.m2.1.1.2">𝛼</ci><cn type="float" id="S5.SS2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.p1.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\alpha=0.05</annotation></semantics></math>), especially in CIFAR-10. We also visualize the learning curves in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. <span id="S5.SS2.p1.2.3" class="ltx_text ltx_font_italic">Our <span id="S5.SS2.p1.2.3.1" class="ltx_text ltx_font_smallcaps">FedETF</span> not only has higher accuracies but also has faster and more steady convergence. </span></p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">For generalization, in most cases, <span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_smallcaps">FedRoD</span> can improve the accuracies upon <span id="S5.SS2.p2.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>, which showcases the effectiveness of the balanced loss. However, the balanced loss cannot thoroughly solve the classifier bias problem, and <span id="S5.SS2.p2.1.3" class="ltx_text ltx_font_italic">our method <span id="S5.SS2.p2.1.3.1" class="ltx_text ltx_font_smallcaps">FedETF</span> which adopts the optimal classifier structure has large-margin gains over <span id="S5.SS2.p2.1.3.2" class="ltx_text ltx_font_smallcaps">FedRoD</span></span>. We notice that the classifier retraining algorithm <span id="S5.SS2.p2.1.4" class="ltx_text ltx_font_smallcaps">CCVR</span> is not effective in all cases, which indicates that the retraining method is not practical enough for solving classifier biases.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">For personalization, we find the personalized FL <span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_smallcaps">FedRep</span> and <span id="S5.SS2.p3.1.2" class="ltx_text ltx_font_smallcaps">FedRoD</span> are strong baselines. Compared with these personalized FL methods, our <span id="S5.SS2.p3.1.3" class="ltx_text ltx_font_smallcaps">FedETF</span> also reaches the state-of-the-art in almost all cases. <span id="S5.SS2.p3.1.4" class="ltx_text ltx_font_italic">The success of <span id="S5.SS2.p3.1.4.1" class="ltx_text ltx_font_smallcaps">FedETF</span> in personalization is the result of training a better generalized global model and the effective local adaption of such a global model.</span></p>
</div>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F5.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x8.png" id="S5.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="120" height="92" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F5.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x9.png" id="S5.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="120" height="92" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F5.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x10.png" id="S5.F5.3.g1" class="ltx_graphics ltx_img_landscape" width="120" height="92" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span id="S5.F5.9.1" class="ltx_text ltx_font_bold">Understanding feature alignment and neural collapse of <span id="S5.F5.9.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span>.</span> Test accuracy of final global models: <span id="S5.F5.10.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> 29.73%, <span id="S5.F5.11.3" class="ltx_text ltx_font_smallcaps">FedETF</span> 54.95%. Experiments on CIFAR-10 with <math id="S5.F5.5.m1.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="S5.F5.5.m1.1b"><mrow id="S5.F5.5.m1.1.1" xref="S5.F5.5.m1.1.1.cmml"><mi id="S5.F5.5.m1.1.1.2" xref="S5.F5.5.m1.1.1.2.cmml">α</mi><mo id="S5.F5.5.m1.1.1.1" xref="S5.F5.5.m1.1.1.1.cmml">=</mo><mn id="S5.F5.5.m1.1.1.3" xref="S5.F5.5.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.5.m1.1c"><apply id="S5.F5.5.m1.1.1.cmml" xref="S5.F5.5.m1.1.1"><eq id="S5.F5.5.m1.1.1.1.cmml" xref="S5.F5.5.m1.1.1.1"></eq><ci id="S5.F5.5.m1.1.1.2.cmml" xref="S5.F5.5.m1.1.1.2">𝛼</ci><cn type="float" id="S5.F5.5.m1.1.1.3.cmml" xref="S5.F5.5.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.5.m1.1d">\alpha=0.05</annotation></semantics></math>. (a) Feature prototype consistency of clients’ local models, higher values mean better feature alignment. (b) Neural collapse error of the aggregated global model, lower values mean greater neural collapse. (c) Local model consistency: averaged pair-wise cosine similarities of clients’ local models, higher values mean smaller model drifts.</figcaption>
</figure>
<div id="S5.SS2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.p4.4" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">Results under different <math id="S5.SS2.p4.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS2.p4.1.1.m1.1a"><mi id="S5.SS2.p4.1.1.m1.1.1" xref="S5.SS2.p4.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.1.m1.1b"><ci id="S5.SS2.p4.1.1.m1.1.1.cmml" xref="S5.SS2.p4.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.1.m1.1c">K</annotation></semantics></math> with partial client sampling.</span>
We select the best baselines in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and conduct experiments on CIFAR-10 under various numbers of clients <math id="S5.SS2.p4.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S5.SS2.p4.2.m1.1a"><mi id="S5.SS2.p4.2.m1.1.1" xref="S5.SS2.p4.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.2.m1.1b"><ci id="S5.SS2.p4.2.m1.1.1.cmml" xref="S5.SS2.p4.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.2.m1.1c">K</annotation></semantics></math> with partial client sampling in Table <a href="#S5.T2" title="Table 2 ‣ 5.1 Settings ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We set <math id="S5.SS2.p4.3.m2.2" class="ltx_Math" alttext="K\in\{50,100\}" display="inline"><semantics id="S5.SS2.p4.3.m2.2a"><mrow id="S5.SS2.p4.3.m2.2.3" xref="S5.SS2.p4.3.m2.2.3.cmml"><mi id="S5.SS2.p4.3.m2.2.3.2" xref="S5.SS2.p4.3.m2.2.3.2.cmml">K</mi><mo id="S5.SS2.p4.3.m2.2.3.1" xref="S5.SS2.p4.3.m2.2.3.1.cmml">∈</mo><mrow id="S5.SS2.p4.3.m2.2.3.3.2" xref="S5.SS2.p4.3.m2.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS2.p4.3.m2.2.3.3.2.1" xref="S5.SS2.p4.3.m2.2.3.3.1.cmml">{</mo><mn id="S5.SS2.p4.3.m2.1.1" xref="S5.SS2.p4.3.m2.1.1.cmml">50</mn><mo id="S5.SS2.p4.3.m2.2.3.3.2.2" xref="S5.SS2.p4.3.m2.2.3.3.1.cmml">,</mo><mn id="S5.SS2.p4.3.m2.2.2" xref="S5.SS2.p4.3.m2.2.2.cmml">100</mn><mo stretchy="false" id="S5.SS2.p4.3.m2.2.3.3.2.3" xref="S5.SS2.p4.3.m2.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.3.m2.2b"><apply id="S5.SS2.p4.3.m2.2.3.cmml" xref="S5.SS2.p4.3.m2.2.3"><in id="S5.SS2.p4.3.m2.2.3.1.cmml" xref="S5.SS2.p4.3.m2.2.3.1"></in><ci id="S5.SS2.p4.3.m2.2.3.2.cmml" xref="S5.SS2.p4.3.m2.2.3.2">𝐾</ci><set id="S5.SS2.p4.3.m2.2.3.3.1.cmml" xref="S5.SS2.p4.3.m2.2.3.3.2"><cn type="integer" id="S5.SS2.p4.3.m2.1.1.cmml" xref="S5.SS2.p4.3.m2.1.1">50</cn><cn type="integer" id="S5.SS2.p4.3.m2.2.2.cmml" xref="S5.SS2.p4.3.m2.2.2">100</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.3.m2.2c">K\in\{50,100\}</annotation></semantics></math> and set the sampling rate as 0.4 and 0.6. To ensure fair comparisons, we randomly generate and save a sampling list in advance and let every method load the same sampling list during training. It is obvious that our <span id="S5.SS2.p4.4.2" class="ltx_text ltx_font_smallcaps">FedETF</span> is the best method in both generalization and personalization. Compared with <span id="S5.SS2.p4.4.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>, the advantage of our method is more dominant under the smaller sampling rate, i.e. 0.4. With respect to generalization, when <math id="S5.SS2.p4.4.m3.1" class="ltx_Math" alttext="K=50" display="inline"><semantics id="S5.SS2.p4.4.m3.1a"><mrow id="S5.SS2.p4.4.m3.1.1" xref="S5.SS2.p4.4.m3.1.1.cmml"><mi id="S5.SS2.p4.4.m3.1.1.2" xref="S5.SS2.p4.4.m3.1.1.2.cmml">K</mi><mo id="S5.SS2.p4.4.m3.1.1.1" xref="S5.SS2.p4.4.m3.1.1.1.cmml">=</mo><mn id="S5.SS2.p4.4.m3.1.1.3" xref="S5.SS2.p4.4.m3.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.4.m3.1b"><apply id="S5.SS2.p4.4.m3.1.1.cmml" xref="S5.SS2.p4.4.m3.1.1"><eq id="S5.SS2.p4.4.m3.1.1.1.cmml" xref="S5.SS2.p4.4.m3.1.1.1"></eq><ci id="S5.SS2.p4.4.m3.1.1.2.cmml" xref="S5.SS2.p4.4.m3.1.1.2">𝐾</ci><cn type="integer" id="S5.SS2.p4.4.m3.1.1.3.cmml" xref="S5.SS2.p4.4.m3.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.4.m3.1c">K=50</annotation></semantics></math>, the improvement is 5.2% for the sampling rate 0.4, and 3.8% for the sampling rate 0.6. <span id="S5.SS2.p4.4.4" class="ltx_text ltx_font_italic">It indicates that the fixed ETF classifier is more robust than the learnable classifier to tackle <span id="S5.SS2.p4.4.4.1" class="ltx_text ltx_font_bold">system heterogeneity</span>.</span> Moreover, our method has smaller variances of accuracies, which also verifies its robustness.</p>
</div>
<div id="S5.SS2.p5" class="ltx_para ltx_noindent">
<p id="S5.SS2.p5.3" class="ltx_p"><span id="S5.SS2.p5.1.1" class="ltx_text ltx_font_bold">Results under different local epochs <math id="S5.SS2.p5.1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS2.p5.1.1.m1.1a"><mi id="S5.SS2.p5.1.1.m1.1.1" xref="S5.SS2.p5.1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.1.1.m1.1b"><ci id="S5.SS2.p5.1.1.m1.1.1.cmml" xref="S5.SS2.p5.1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.1.1.m1.1c">E</annotation></semantics></math>.</span> In Table <a href="#S5.T3" title="Table 3 ‣ 5.1 Settings ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, generally, when the number of local epochs varies, our <span id="S5.SS2.p5.3.3" class="ltx_text ltx_font_smallcaps">FedETF</span> also achieves constantly state-of-the-art performances.
For <span id="S5.SS2.p5.3.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> and <span id="S5.SS2.p5.3.5" class="ltx_text ltx_font_smallcaps">FedRoD</span>, when <math id="S5.SS2.p5.2.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS2.p5.2.m1.1a"><mi id="S5.SS2.p5.2.m1.1.1" xref="S5.SS2.p5.2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.2.m1.1b"><ci id="S5.SS2.p5.2.m1.1.1.cmml" xref="S5.SS2.p5.2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.2.m1.1c">E</annotation></semantics></math> is larger, the generalization performance will decline. <span id="S5.SS2.p5.3.2" class="ltx_text ltx_font_italic">However, for our <span id="S5.SS2.p5.3.2.1" class="ltx_text ltx_font_smallcaps">FedETF</span>, the declines are weaker, showing its robustness and effectiveness. For personalization, <span id="S5.SS2.p5.3.2.2" class="ltx_text ltx_font_smallcaps">FedETF</span> has more steady and promising results under different <math id="S5.SS2.p5.3.2.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS2.p5.3.2.m1.1a"><mi id="S5.SS2.p5.3.2.m1.1.1" xref="S5.SS2.p5.3.2.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.3.2.m1.1b"><ci id="S5.SS2.p5.3.2.m1.1.1.cmml" xref="S5.SS2.p5.3.2.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.3.2.m1.1c">E</annotation></semantics></math>.</span></p>
</div>
<figure id="S5.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 4: </span><span id="S5.T4.7.1" class="ltx_text ltx_font_bold">Evaluation (%) of <span id="S5.T4.7.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span> using different model architectures.</span> The dataset is CIFAR-10 with Non-IID <math id="S5.T4.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.T4.2.m1.1b"><mrow id="S5.T4.2.m1.1.1" xref="S5.T4.2.m1.1.1.cmml"><mi id="S5.T4.2.m1.1.1.2" xref="S5.T4.2.m1.1.1.2.cmml">α</mi><mo id="S5.T4.2.m1.1.1.1" xref="S5.T4.2.m1.1.1.1.cmml">=</mo><mn id="S5.T4.2.m1.1.1.3" xref="S5.T4.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T4.2.m1.1c"><apply id="S5.T4.2.m1.1.1.cmml" xref="S5.T4.2.m1.1.1"><eq id="S5.T4.2.m1.1.1.1.cmml" xref="S5.T4.2.m1.1.1.1"></eq><ci id="S5.T4.2.m1.1.1.2.cmml" xref="S5.T4.2.m1.1.1.2">𝛼</ci><cn type="float" id="S5.T4.2.m1.1.1.3.cmml" xref="S5.T4.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T4.2.m1.1d">\alpha=0.1</annotation></semantics></math>.</figcaption>
<table id="S5.T4.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T4.8.1.1" class="ltx_tr">
<th id="S5.T4.8.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt"><span id="S5.T4.8.1.1.1.1" class="ltx_text" style="font-size:80%;">Methods</span></th>
<td id="S5.T4.8.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S5.T4.8.1.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedAvg</span></td>
<td id="S5.T4.8.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S5.T4.8.1.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedETF</span></td>
</tr>
<tr id="S5.T4.8.2.2" class="ltx_tr">
<th id="S5.T4.8.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T4.8.2.2.1.1" class="ltx_text" style="font-size:80%;">Models/Metrics</span></th>
<td id="S5.T4.8.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.8.2.2.2.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T4.8.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T4.8.2.2.3.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
<td id="S5.T4.8.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.8.2.2.4.1" class="ltx_text" style="font-size:80%;">General.</span></td>
<td id="S5.T4.8.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.8.2.2.5.1" class="ltx_text" style="font-size:80%;">Personal.</span></td>
</tr>
<tr id="S5.T4.8.3.3" class="ltx_tr">
<th id="S5.T4.8.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T4.8.3.3.1.1" class="ltx_text" style="font-size:80%;">DenseNet121</span></th>
<td id="S5.T4.8.3.3.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T4.8.3.3.2.1" class="ltx_text" style="font-size:80%;">62.87</span><span id="S5.T4.8.3.3.2.2" class="ltx_text" style="font-size:50%;">±2.23</span>
</td>
<td id="S5.T4.8.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S5.T4.8.3.3.3.1" class="ltx_text" style="font-size:80%;">85.66</span><span id="S5.T4.8.3.3.3.2" class="ltx_text" style="font-size:50%;">±3.70</span>
</td>
<td id="S5.T4.8.3.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.8.3.3.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">74.92<span id="S5.T4.8.3.3.4.1.1" class="ltx_text" style="font-size:63%;">±2.75</span></span></td>
<td id="S5.T4.8.3.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.8.3.3.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">91.83<span id="S5.T4.8.3.3.5.1.1" class="ltx_text" style="font-size:63%;">±0.67</span></span></td>
</tr>
<tr id="S5.T4.8.4.4" class="ltx_tr">
<th id="S5.T4.8.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T4.8.4.4.1.1" class="ltx_text" style="font-size:80%;">MobileNetV2</span></th>
<td id="S5.T4.8.4.4.2" class="ltx_td ltx_align_center">
<span id="S5.T4.8.4.4.2.1" class="ltx_text" style="font-size:80%;">43.20</span><span id="S5.T4.8.4.4.2.2" class="ltx_text" style="font-size:50%;">±4.45</span>
</td>
<td id="S5.T4.8.4.4.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T4.8.4.4.3.1" class="ltx_text" style="font-size:80%;">87.07</span><span id="S5.T4.8.4.4.3.2" class="ltx_text" style="font-size:50%;">±1.04</span>
</td>
<td id="S5.T4.8.4.4.4" class="ltx_td ltx_align_center"><span id="S5.T4.8.4.4.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">57.43<span id="S5.T4.8.4.4.4.1.1" class="ltx_text" style="font-size:63%;">±12.0</span></span></td>
<td id="S5.T4.8.4.4.5" class="ltx_td ltx_align_center"><span id="S5.T4.8.4.4.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">89.88<span id="S5.T4.8.4.4.5.1.1" class="ltx_text" style="font-size:63%;">±0.40</span></span></td>
</tr>
<tr id="S5.T4.8.5.5" class="ltx_tr">
<th id="S5.T4.8.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T4.8.5.5.1.1" class="ltx_text" style="font-size:80%;">EfficientNet</span></th>
<td id="S5.T4.8.5.5.2" class="ltx_td ltx_align_center">
<span id="S5.T4.8.5.5.2.1" class="ltx_text" style="font-size:80%;">35.92</span><span id="S5.T4.8.5.5.2.2" class="ltx_text" style="font-size:50%;">±4.47</span>
</td>
<td id="S5.T4.8.5.5.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T4.8.5.5.3.1" class="ltx_text" style="font-size:80%;">84.69</span><span id="S5.T4.8.5.5.3.2" class="ltx_text" style="font-size:50%;">±1.26</span>
</td>
<td id="S5.T4.8.5.5.4" class="ltx_td ltx_align_center"><span id="S5.T4.8.5.5.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">56.70<span id="S5.T4.8.5.5.4.1.1" class="ltx_text" style="font-size:63%;">±5.52</span></span></td>
<td id="S5.T4.8.5.5.5" class="ltx_td ltx_align_center"><span id="S5.T4.8.5.5.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">87.50<span id="S5.T4.8.5.5.5.1.1" class="ltx_text" style="font-size:63%;">±0.74</span></span></td>
</tr>
<tr id="S5.T4.8.6.6" class="ltx_tr">
<th id="S5.T4.8.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S5.T4.8.6.6.1.1" class="ltx_text" style="font-size:80%;">ResNet20</span></th>
<td id="S5.T4.8.6.6.2" class="ltx_td ltx_align_center ltx_border_t">
<span id="S5.T4.8.6.6.2.1" class="ltx_text" style="font-size:80%;">52.76</span><span id="S5.T4.8.6.6.2.2" class="ltx_text" style="font-size:50%;">±6.08</span>
</td>
<td id="S5.T4.8.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S5.T4.8.6.6.3.1" class="ltx_text" style="font-size:80%;">83.85</span><span id="S5.T4.8.6.6.3.2" class="ltx_text" style="font-size:50%;">±0.89</span>
</td>
<td id="S5.T4.8.6.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.8.6.6.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">59.56<span id="S5.T4.8.6.6.4.1.1" class="ltx_text" style="font-size:63%;">±1.84</span></span></td>
<td id="S5.T4.8.6.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.8.6.6.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">87.89<span id="S5.T4.8.6.6.5.1.1" class="ltx_text" style="font-size:63%;">±1.19</span></span></td>
</tr>
<tr id="S5.T4.8.7.7" class="ltx_tr">
<th id="S5.T4.8.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T4.8.7.7.1.1" class="ltx_text" style="font-size:80%;">ResNet32</span></th>
<td id="S5.T4.8.7.7.2" class="ltx_td ltx_align_center">
<span id="S5.T4.8.7.7.2.1" class="ltx_text" style="font-size:80%;">53.22</span><span id="S5.T4.8.7.7.2.2" class="ltx_text" style="font-size:50%;">±7.73</span>
</td>
<td id="S5.T4.8.7.7.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T4.8.7.7.3.1" class="ltx_text" style="font-size:80%;">82.90</span><span id="S5.T4.8.7.7.3.2" class="ltx_text" style="font-size:50%;">±4.31</span>
</td>
<td id="S5.T4.8.7.7.4" class="ltx_td ltx_align_center"><span id="S5.T4.8.7.7.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">60.71<span id="S5.T4.8.7.7.4.1.1" class="ltx_text" style="font-size:63%;">±2.67</span></span></td>
<td id="S5.T4.8.7.7.5" class="ltx_td ltx_align_center"><span id="S5.T4.8.7.7.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">87.97<span id="S5.T4.8.7.7.5.1.1" class="ltx_text" style="font-size:63%;">±1.17</span></span></td>
</tr>
<tr id="S5.T4.8.8.8" class="ltx_tr">
<th id="S5.T4.8.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S5.T4.8.8.8.1.1" class="ltx_text" style="font-size:80%;">ResNet56</span></th>
<td id="S5.T4.8.8.8.2" class="ltx_td ltx_align_center">
<span id="S5.T4.8.8.8.2.1" class="ltx_text" style="font-size:80%;">57.09</span><span id="S5.T4.8.8.8.2.2" class="ltx_text" style="font-size:50%;">±6.10</span>
</td>
<td id="S5.T4.8.8.8.3" class="ltx_td ltx_align_center ltx_border_r">
<span id="S5.T4.8.8.8.3.1" class="ltx_text" style="font-size:80%;">83.70</span><span id="S5.T4.8.8.8.3.2" class="ltx_text" style="font-size:50%;">±4.65</span>
</td>
<td id="S5.T4.8.8.8.4" class="ltx_td ltx_align_center"><span id="S5.T4.8.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">60.44<span id="S5.T4.8.8.8.4.1.1" class="ltx_text" style="font-size:63%;">±3.57</span></span></td>
<td id="S5.T4.8.8.8.5" class="ltx_td ltx_align_center"><span id="S5.T4.8.8.8.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">88.23<span id="S5.T4.8.8.8.5.1.1" class="ltx_text" style="font-size:63%;">±0.99</span></span></td>
</tr>
<tr id="S5.T4.8.9.9" class="ltx_tr">
<th id="S5.T4.8.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S5.T4.8.9.9.1.1" class="ltx_text" style="font-size:80%;">WRN56_4</span></th>
<td id="S5.T4.8.9.9.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S5.T4.8.9.9.2.1" class="ltx_text" style="font-size:80%;">63.64</span><span id="S5.T4.8.9.9.2.2" class="ltx_text" style="font-size:50%;">±4.91</span>
</td>
<td id="S5.T4.8.9.9.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">
<span id="S5.T4.8.9.9.3.1" class="ltx_text" style="font-size:80%;">86.76</span><span id="S5.T4.8.9.9.3.2" class="ltx_text" style="font-size:50%;">±1.08</span>
</td>
<td id="S5.T4.8.9.9.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.8.9.9.4.1" class="ltx_text ltx_font_bold" style="font-size:80%;">66.30<span id="S5.T4.8.9.9.4.1.1" class="ltx_text" style="font-size:63%;">±3.88</span></span></td>
<td id="S5.T4.8.9.9.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T4.8.9.9.5.1" class="ltx_text ltx_font_bold" style="font-size:80%;">89.94<span id="S5.T4.8.9.9.5.1.1" class="ltx_text" style="font-size:63%;">±0.52</span></span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Understanding <span id="S5.SS3.1.1" class="ltx_text ltx_font_bold ltx_font_smallcaps">FedETF</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.p1.1" class="ltx_p"><span id="S5.SS3.p1.1.1" class="ltx_text ltx_font_bold">Evaluation using different model architectures.</span>
We consider two scenarios: <span id="S5.SS3.p1.1.2" class="ltx_text ltx_font_bold ltx_font_italic">1) Different backbones.</span> DenseNet121 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, MobileNetV2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, and EfficientNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>. <span id="S5.SS3.p1.1.3" class="ltx_text ltx_font_bold ltx_font_italic">2) Deeper and wider models.</span>
Deeper models: ResNet20, ResNet32, and ResNet56 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> (the larger number refers to the deeper model); wider models: ResNet56 and WRN56_4 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> (WRN: the abbreviation for Wide ResNet). The results are shown in Table <a href="#S5.T4" title="Table 4 ‣ 5.2 Main Results ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. <span id="S5.SS3.p1.1.4" class="ltx_text ltx_font_italic">Our method can also improve performance under various model architectures.</span> For models with different depths, we observe that <span id="S5.SS3.p1.1.5" class="ltx_text ltx_font_smallcaps">FedETF</span> has larger superiority in shallower models.
Specifically, <span id="S5.SS3.p1.1.6" class="ltx_text ltx_font_smallcaps">FedETF</span> can release the full potential of ResNet20 (shallower and smaller model) to let it has even better performance than <span id="S5.SS3.p1.1.7" class="ltx_text ltx_font_smallcaps">FedAvg</span> with ResNet56 (deeper and larger model). <span id="S5.SS3.p1.1.8" class="ltx_text ltx_font_italic">It showcases the applicability of <span id="S5.SS3.p1.1.8.1" class="ltx_text ltx_font_smallcaps">FedETF</span> that it can enable smaller models to have better performances than the larger ones, saving both computation and communication costs in FL.</span></p>
</div>
<div id="S5.SS3.p2" class="ltx_para ltx_noindent">
<p id="S5.SS3.p2.1" class="ltx_p"><span id="S5.SS3.p2.1.1" class="ltx_text ltx_font_bold">Why does <span id="S5.SS3.p2.1.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span> work well?</span> We explore how the features are learned in <span id="S5.SS3.p2.1.2" class="ltx_text ltx_font_smallcaps">FedETF</span> compared with <span id="S5.SS3.p2.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>. We first examine the feature alignment of local models. In each round, after local training, we compute class prototypes (feature mean of each class) in each client and calculate the cosine similarities of clients’ class-wise prototypes, which is analogous to NC1 in Section <a href="#S3.SS2" title="3.2 Neural Collapse ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>. Then we average all the cosine similarities to indicate the feature alignment, a larger value reveals more aligned clients’ features. The results are in Figure <a href="#S5.F5" title="Figure 5 ‣ 5.2 Main Results ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (a). <span id="S5.SS3.p2.1.4" class="ltx_text ltx_font_italic">It shows that only after a few rounds, <span id="S5.SS3.p2.1.4.1" class="ltx_text ltx_font_smallcaps">FedETF</span> has constantly stronger clients’ feature alignment than <span id="S5.SS3.p2.1.4.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>, showing the fixed ETF classifier is effective to align local features.</span></p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.2" class="ltx_p">We also study whether <span id="S5.SS3.p3.2.1" class="ltx_text ltx_font_smallcaps">FedETF</span> can help the global model reach neural collapse in terms of NC2 in Figure <a href="#S5.F5" title="Figure 5 ‣ 5.2 Main Results ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (b).
In each round, we first compute the class prototypes of the global model and calculate the pair-wise cosine similarities of these prototypes. In neural collapse optimality (Definition <a href="#S3.Thmtheorem1" title="Definition 3.1 (Simplex Equiangular Tight Frame). ‣ 3.2 Neural Collapse ‣ 3 Preliminaries ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>), the pair-wise cosine similarities of prototypes are <math id="S5.SS3.p3.1.m1.1" class="ltx_Math" alttext="-\frac{1}{K-1}" display="inline"><semantics id="S5.SS3.p3.1.m1.1a"><mrow id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml"><mo id="S5.SS3.p3.1.m1.1.1a" xref="S5.SS3.p3.1.m1.1.1.cmml">−</mo><mfrac id="S5.SS3.p3.1.m1.1.1.2" xref="S5.SS3.p3.1.m1.1.1.2.cmml"><mn id="S5.SS3.p3.1.m1.1.1.2.2" xref="S5.SS3.p3.1.m1.1.1.2.2.cmml">1</mn><mrow id="S5.SS3.p3.1.m1.1.1.2.3" xref="S5.SS3.p3.1.m1.1.1.2.3.cmml"><mi id="S5.SS3.p3.1.m1.1.1.2.3.2" xref="S5.SS3.p3.1.m1.1.1.2.3.2.cmml">K</mi><mo id="S5.SS3.p3.1.m1.1.1.2.3.1" xref="S5.SS3.p3.1.m1.1.1.2.3.1.cmml">−</mo><mn id="S5.SS3.p3.1.m1.1.1.2.3.3" xref="S5.SS3.p3.1.m1.1.1.2.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><apply id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1"><minus id="S5.SS3.p3.1.m1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1"></minus><apply id="S5.SS3.p3.1.m1.1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2"><divide id="S5.SS3.p3.1.m1.1.1.2.1.cmml" xref="S5.SS3.p3.1.m1.1.1.2"></divide><cn type="integer" id="S5.SS3.p3.1.m1.1.1.2.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2.2">1</cn><apply id="S5.SS3.p3.1.m1.1.1.2.3.cmml" xref="S5.SS3.p3.1.m1.1.1.2.3"><minus id="S5.SS3.p3.1.m1.1.1.2.3.1.cmml" xref="S5.SS3.p3.1.m1.1.1.2.3.1"></minus><ci id="S5.SS3.p3.1.m1.1.1.2.3.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2.3.2">𝐾</ci><cn type="integer" id="S5.SS3.p3.1.m1.1.1.2.3.3.cmml" xref="S5.SS3.p3.1.m1.1.1.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">-\frac{1}{K-1}</annotation></semantics></math>. Hence, we calculate the mean square error between the global model’s cosines and <math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="-\frac{1}{K-1}" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><mrow id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml"><mo id="S5.SS3.p3.2.m2.1.1a" xref="S5.SS3.p3.2.m2.1.1.cmml">−</mo><mfrac id="S5.SS3.p3.2.m2.1.1.2" xref="S5.SS3.p3.2.m2.1.1.2.cmml"><mn id="S5.SS3.p3.2.m2.1.1.2.2" xref="S5.SS3.p3.2.m2.1.1.2.2.cmml">1</mn><mrow id="S5.SS3.p3.2.m2.1.1.2.3" xref="S5.SS3.p3.2.m2.1.1.2.3.cmml"><mi id="S5.SS3.p3.2.m2.1.1.2.3.2" xref="S5.SS3.p3.2.m2.1.1.2.3.2.cmml">K</mi><mo id="S5.SS3.p3.2.m2.1.1.2.3.1" xref="S5.SS3.p3.2.m2.1.1.2.3.1.cmml">−</mo><mn id="S5.SS3.p3.2.m2.1.1.2.3.3" xref="S5.SS3.p3.2.m2.1.1.2.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><apply id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1"><minus id="S5.SS3.p3.2.m2.1.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1"></minus><apply id="S5.SS3.p3.2.m2.1.1.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2"><divide id="S5.SS3.p3.2.m2.1.1.2.1.cmml" xref="S5.SS3.p3.2.m2.1.1.2"></divide><cn type="integer" id="S5.SS3.p3.2.m2.1.1.2.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2.2">1</cn><apply id="S5.SS3.p3.2.m2.1.1.2.3.cmml" xref="S5.SS3.p3.2.m2.1.1.2.3"><minus id="S5.SS3.p3.2.m2.1.1.2.3.1.cmml" xref="S5.SS3.p3.2.m2.1.1.2.3.1"></minus><ci id="S5.SS3.p3.2.m2.1.1.2.3.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2.3.2">𝐾</ci><cn type="integer" id="S5.SS3.p3.2.m2.1.1.2.3.3.cmml" xref="S5.SS3.p3.2.m2.1.1.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">-\frac{1}{K-1}</annotation></semantics></math> to indicate the neural collapse error. Results display that <span id="S5.SS3.p3.2.2" class="ltx_text ltx_font_smallcaps">FedETF</span> has a much smaller neural collapse error than <span id="S5.SS3.p3.2.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>, and the error of <span id="S5.SS3.p3.2.4" class="ltx_text ltx_font_smallcaps">FedETF</span> is decreasing along the training. <span id="S5.SS3.p3.2.5" class="ltx_text ltx_font_italic">It indicates that <span id="S5.SS3.p3.2.5.1" class="ltx_text ltx_font_smallcaps">FedETF</span> can help the global model reach neural collapse.</span> Note that <span id="S5.SS3.p3.2.6" class="ltx_text ltx_font_smallcaps">FedAvg</span> has 29.73% in global test accuracy while <span id="S5.SS3.p3.2.7" class="ltx_text ltx_font_smallcaps">FedETF</span> has 54.95%.
<span id="S5.SS3.p3.2.8" class="ltx_text ltx_font_italic">It also verifies that the global model’s generalization is connected with neural collapse optimality in FL, which is consistent with the observations in centralized training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.</span></p>
</div>
<div id="S5.SS3.p4" class="ltx_para">
<p id="S5.SS3.p4.1" class="ltx_p">Additionally, we study why <span id="S5.SS3.p4.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span> works well from the perspective of model drift (local model consistency) in Figure <a href="#S5.F5" title="Figure 5 ‣ 5.2 Main Results ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (c). Results demonstrate that <span id="S5.SS3.p4.1.2" class="ltx_text ltx_font_smallcaps">FedETF</span> has stably higher local model consistency than <span id="S5.SS3.p4.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> throughout the training, indicating lower model drift. It is consistent with the intuition that the fixed ETF classifier can reduce the model drifts of feature extractors, resulting in better aggregation and convergence.</p>
</div>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x11.png" id="S5.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="110" height="85" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.10058/assets/x12.png" id="S5.F6.2.g1" class="ltx_graphics ltx_img_landscape" width="110" height="85" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span id="S5.F6.8.1" class="ltx_text ltx_font_bold">Understanding feature dimension and local personalization in <span id="S5.F6.8.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span>.</span> Experiments on CIFAR-10 with <math id="S5.F6.4.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.F6.4.m1.1b"><mrow id="S5.F6.4.m1.1.1" xref="S5.F6.4.m1.1.1.cmml"><mi id="S5.F6.4.m1.1.1.2" xref="S5.F6.4.m1.1.1.2.cmml">α</mi><mo id="S5.F6.4.m1.1.1.1" xref="S5.F6.4.m1.1.1.1.cmml">=</mo><mn id="S5.F6.4.m1.1.1.3" xref="S5.F6.4.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F6.4.m1.1c"><apply id="S5.F6.4.m1.1.1.cmml" xref="S5.F6.4.m1.1.1"><eq id="S5.F6.4.m1.1.1.1.cmml" xref="S5.F6.4.m1.1.1.1"></eq><ci id="S5.F6.4.m1.1.1.2.cmml" xref="S5.F6.4.m1.1.1.2">𝛼</ci><cn type="float" id="S5.F6.4.m1.1.1.3.cmml" xref="S5.F6.4.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.4.m1.1d">\alpha=0.1</annotation></semantics></math>. (a) How feature dimension affects <span id="S5.F6.9.2" class="ltx_text ltx_font_smallcaps">FedETF</span>’s generalization and neural collapse. (b) How personalization is reached in each iteration of <span id="S5.F6.10.3" class="ltx_text ltx_font_smallcaps">FedETF</span>’s local finetuning. </figcaption>
</figure>
<div id="S5.SS3.p5" class="ltx_para ltx_noindent">
<p id="S5.SS3.p5.7" class="ltx_p"><span id="S5.SS3.p5.7.3" class="ltx_text ltx_font_bold">How feature dimension affects <span id="S5.SS3.p5.7.3.1" class="ltx_text ltx_font_smallcaps">FedETF</span>.</span> We analyse how the feature dimension <math id="S5.SS3.p5.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S5.SS3.p5.1.m1.1a"><mi id="S5.SS3.p5.1.m1.1.1" xref="S5.SS3.p5.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.1.m1.1b"><ci id="S5.SS3.p5.1.m1.1.1.cmml" xref="S5.SS3.p5.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.1.m1.1c">d</annotation></semantics></math> of ETF affects <span id="S5.SS3.p5.7.4" class="ltx_text ltx_font_smallcaps">FedETF</span>’s performance on CIFAR-10 in Figure <a href="#S5.F6" title="Figure 6 ‣ 5.3 Understanding FedETF ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (a). We find that smaller <math id="S5.SS3.p5.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S5.SS3.p5.2.m2.1a"><mi id="S5.SS3.p5.2.m2.1.1" xref="S5.SS3.p5.2.m2.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.2.m2.1b"><ci id="S5.SS3.p5.2.m2.1.1.cmml" xref="S5.SS3.p5.2.m2.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.2.m2.1c">d</annotation></semantics></math> will cause smaller neural collapse errors and are slightly beneficial to generalization. Random high-dimensional vectors are more prone to be orthogonal, so we suppose that prototypes in higher dimensions are more likely to be orthogonal. In CIFAR-10, the number of classes <math id="S5.SS3.p5.3.m3.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="S5.SS3.p5.3.m3.1a"><mrow id="S5.SS3.p5.3.m3.1.1" xref="S5.SS3.p5.3.m3.1.1.cmml"><mi id="S5.SS3.p5.3.m3.1.1.2" xref="S5.SS3.p5.3.m3.1.1.2.cmml">K</mi><mo id="S5.SS3.p5.3.m3.1.1.1" xref="S5.SS3.p5.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS3.p5.3.m3.1.1.3" xref="S5.SS3.p5.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.3.m3.1b"><apply id="S5.SS3.p5.3.m3.1.1.cmml" xref="S5.SS3.p5.3.m3.1.1"><eq id="S5.SS3.p5.3.m3.1.1.1.cmml" xref="S5.SS3.p5.3.m3.1.1.1"></eq><ci id="S5.SS3.p5.3.m3.1.1.2.cmml" xref="S5.SS3.p5.3.m3.1.1.2">𝐾</ci><cn type="integer" id="S5.SS3.p5.3.m3.1.1.3.cmml" xref="S5.SS3.p5.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.3.m3.1c">K=10</annotation></semantics></math>, and the ETF angles are obtuse with -0.11 pair-wise cosines. Therefore, it is hard for high-dimensional features to collapse into the obtuse angle’s structure. <span id="S5.SS3.p5.5.2" class="ltx_text ltx_font_italic">We suggest setting the feature dimension <math id="S5.SS3.p5.4.1.m1.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S5.SS3.p5.4.1.m1.1a"><mi id="S5.SS3.p5.4.1.m1.1.1" xref="S5.SS3.p5.4.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.4.1.m1.1b"><ci id="S5.SS3.p5.4.1.m1.1.1.cmml" xref="S5.SS3.p5.4.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.4.1.m1.1c">d</annotation></semantics></math> in <span id="S5.SS3.p5.5.2.1" class="ltx_text ltx_font_smallcaps">FedETF</span> according to the number of classes <math id="S5.SS3.p5.5.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.SS3.p5.5.2.m2.1a"><mi id="S5.SS3.p5.5.2.m2.1.1" xref="S5.SS3.p5.5.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.5.2.m2.1b"><ci id="S5.SS3.p5.5.2.m2.1.1.cmml" xref="S5.SS3.p5.5.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.5.2.m2.1c">C</annotation></semantics></math>.</span> If <math id="S5.SS3.p5.6.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S5.SS3.p5.6.m4.1a"><mi id="S5.SS3.p5.6.m4.1.1" xref="S5.SS3.p5.6.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.6.m4.1b"><ci id="S5.SS3.p5.6.m4.1.1.cmml" xref="S5.SS3.p5.6.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.6.m4.1c">C</annotation></semantics></math> is small, it also requires a relatively small <math id="S5.SS3.p5.7.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S5.SS3.p5.7.m5.1a"><mi id="S5.SS3.p5.7.m5.1.1" xref="S5.SS3.p5.7.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.7.m5.1b"><ci id="S5.SS3.p5.7.m5.1.1.cmml" xref="S5.SS3.p5.7.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.7.m5.1c">d</annotation></semantics></math> to improve neural collapse.</p>
</div>
<div id="S5.SS3.p6" class="ltx_para ltx_noindent">
<p id="S5.SS3.p6.1" class="ltx_p"><span id="S5.SS3.p6.1.1" class="ltx_text ltx_font_bold">How personalization is reached during local finetuning.</span> We visualize the averaged personalized accuracies of different iterations during <span id="S5.SS3.p6.1.2" class="ltx_text ltx_font_smallcaps">FedETF</span>’s local finetuning in Figure <a href="#S5.F6" title="Figure 6 ‣ 5.3 Understanding FedETF ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (b). At first, when clients’ local models are initialized as the final global model, the personalization is poor. After finetuning the feature extractor, <span id="S5.SS3.p6.1.3" class="ltx_text ltx_font_smallcaps">FedETF</span> has better results than the baseline <span id="S5.SS3.p6.1.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> with finetuning. Then alternatively finetuning the ETF classifier and projection layer further improves the personalization and makes the accuracy converge to a higher point.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Ablation Study</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">We conduct the ablation study of <span id="S5.SS4.p1.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span> in terms of generalization<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Figure <a href="#S5.F6" title="Figure 6 ‣ 5.3 Understanding FedETF ‣ 5 Experiments and Results ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> (b) can be viewed as the ablation study of the personalized local finetuning stage.</span></span></span> on CIFAR-10 with Non-IID <math id="S5.SS4.p1.1.m1.2" class="ltx_Math" alttext="\alpha\in\{0.1,0.05\}" display="inline"><semantics id="S5.SS4.p1.1.m1.2a"><mrow id="S5.SS4.p1.1.m1.2.3" xref="S5.SS4.p1.1.m1.2.3.cmml"><mi id="S5.SS4.p1.1.m1.2.3.2" xref="S5.SS4.p1.1.m1.2.3.2.cmml">α</mi><mo id="S5.SS4.p1.1.m1.2.3.1" xref="S5.SS4.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="S5.SS4.p1.1.m1.2.3.3.2" xref="S5.SS4.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S5.SS4.p1.1.m1.2.3.3.2.1" xref="S5.SS4.p1.1.m1.2.3.3.1.cmml">{</mo><mn id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">0.1</mn><mo id="S5.SS4.p1.1.m1.2.3.3.2.2" xref="S5.SS4.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="S5.SS4.p1.1.m1.2.2" xref="S5.SS4.p1.1.m1.2.2.cmml">0.05</mn><mo stretchy="false" id="S5.SS4.p1.1.m1.2.3.3.2.3" xref="S5.SS4.p1.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.2b"><apply id="S5.SS4.p1.1.m1.2.3.cmml" xref="S5.SS4.p1.1.m1.2.3"><in id="S5.SS4.p1.1.m1.2.3.1.cmml" xref="S5.SS4.p1.1.m1.2.3.1"></in><ci id="S5.SS4.p1.1.m1.2.3.2.cmml" xref="S5.SS4.p1.1.m1.2.3.2">𝛼</ci><set id="S5.SS4.p1.1.m1.2.3.3.1.cmml" xref="S5.SS4.p1.1.m1.2.3.3.2"><cn type="float" id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">0.1</cn><cn type="float" id="S5.SS4.p1.1.m1.2.2.cmml" xref="S5.SS4.p1.1.m1.2.2">0.05</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.2c">\alpha\in\{0.1,0.05\}</annotation></semantics></math>. <span id="S5.SS4.p1.1.2" class="ltx_text ltx_font_italic">It is found that every module in <span id="S5.SS4.p1.1.2.1" class="ltx_text ltx_font_smallcaps">FedETF</span> plays an important role and the modules strengthen each other to realize better performances.</span> If taking one module off, the performance will meet severe declines, but the results are still better than <span id="S5.SS4.p1.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> in general. We notice the balanced loss module is more important under a more heterogeneous environment, and this observation is consistent with previous works in neural collapse <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> and FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. It is also notable to emphasize the significance and necessity of the projection layer. Our method without a projection layer only has marginal gains over <span id="S5.SS4.p1.1.4" class="ltx_text ltx_font_smallcaps">FedAvg</span>. We also find that <span id="S5.SS4.p1.1.5" class="ltx_text ltx_font_smallcaps">FedNH</span> has relatively poor performances in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Improving Generalization by ETF Classifier ‣ 4 Methods ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, especially on CIFAR-100 and Tiny-ImageNet, and we suppose the main cause may be that <span id="S5.SS4.p1.1.6" class="ltx_text ltx_font_smallcaps">FedNH</span> does not adopt a projection layer to map the raw features into a space where neural collapse is more prone to happen. Moreover, the learnable temperature is also crucial for <span id="S5.SS4.p1.1.7" class="ltx_text ltx_font_smallcaps">FedETF</span> to adaptively adjust the softmax temperature so as to meet the learning dynamics of feature representations.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we fundamentally solve the classifier biases caused by data heterogeneity in FL by proposing a neural-collapse-inspired solution. Specifically, we employ a simplex ETF as a fixed classifier for all clients during federated training, which allows them to learn unified and optimal feature representations. Afterward, we introduce a novel finetuning strategy to enable clients to have more personalized local models.
Our method achieves the state-of-the-art performance regarding both generalization and personalization compared to strong baselines, as shown by extensive experimental results on CIFAR-10/100 and Tiny-ImageNet. Furthermore, we gained insights into understanding the effectiveness and applicability of our approach.</p>
</div>
<figure id="S6.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 5: </span><span id="S6.T5.5.1" class="ltx_text ltx_font_bold">Ablation study of <span id="S6.T5.5.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span> in terms of global model’s generalization.</span> The dataset is CIFAR-10.</figcaption>
<table id="S6.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T5.1.1" class="ltx_tr">
<th id="S6.T5.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.1.1.1" class="ltx_text" style="font-size:80%;">Methods/NonIID(</span><math id="S6.T5.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.T5.1.1.1.m1.1a"><mi mathsize="80%" id="S6.T5.1.1.1.m1.1.1" xref="S6.T5.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.T5.1.1.1.m1.1b"><ci id="S6.T5.1.1.1.m1.1.1.cmml" xref="S6.T5.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T5.1.1.1.m1.1c">\alpha</annotation></semantics></math><span id="S6.T5.1.1.1.2" class="ltx_text" style="font-size:80%;">)</span>
</th>
<td id="S6.T5.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:11.6pt;padding-right:11.6pt;"><span id="S6.T5.1.1.2.1" class="ltx_text" style="font-size:80%;">0.1</span></td>
<td id="S6.T5.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:11.6pt;padding-right:11.6pt;"><span id="S6.T5.1.1.3.1" class="ltx_text" style="font-size:80%;">0.05</span></td>
</tr>
<tr id="S6.T5.1.2.1" class="ltx_tr">
<th id="S6.T5.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;"><span id="S6.T5.1.2.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:80%;">FedAvg</span></th>
<td id="S6.T5.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.2.1.2.1" class="ltx_text" style="font-size:80%;">43.75</span><span id="S6.T5.1.2.1.2.2" class="ltx_text" style="font-size:50%;">±0.42</span>
</td>
<td id="S6.T5.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.2.1.3.1" class="ltx_text" style="font-size:80%;">38.47</span><span id="S6.T5.1.2.1.3.2" class="ltx_text" style="font-size:50%;">±1.95</span>
</td>
</tr>
<tr id="S6.T5.1.3.2" class="ltx_tr">
<th id="S6.T5.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;"><span id="S6.T5.1.3.2.1.1" class="ltx_text" style="font-size:80%;">Ours w/o Projection Layer</span></th>
<td id="S6.T5.1.3.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.3.2.2.1" class="ltx_text" style="font-size:80%;">44.92</span><span id="S6.T5.1.3.2.2.2" class="ltx_text" style="font-size:50%;">±6.22</span>
</td>
<td id="S6.T5.1.3.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.3.2.3.1" class="ltx_text" style="font-size:80%;">41.91</span><span id="S6.T5.1.3.2.3.2" class="ltx_text" style="font-size:50%;">±1.47</span>
</td>
</tr>
<tr id="S6.T5.1.4.3" class="ltx_tr">
<th id="S6.T5.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:11.6pt;padding-right:11.6pt;"><span id="S6.T5.1.4.3.1.1" class="ltx_text" style="font-size:80%;">Ours w/o Balanced Loss</span></th>
<td id="S6.T5.1.4.3.2" class="ltx_td ltx_align_center" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.4.3.2.1" class="ltx_text" style="font-size:80%;">46.06</span><span id="S6.T5.1.4.3.2.2" class="ltx_text" style="font-size:50%;">±0.75</span>
</td>
<td id="S6.T5.1.4.3.3" class="ltx_td ltx_align_center" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.4.3.3.1" class="ltx_text" style="font-size:80%;">37.63</span><span id="S6.T5.1.4.3.3.2" class="ltx_text" style="font-size:50%;">±4.45</span>
</td>
</tr>
<tr id="S6.T5.1.5.4" class="ltx_tr">
<th id="S6.T5.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:11.6pt;padding-right:11.6pt;"><span id="S6.T5.1.5.4.1.1" class="ltx_text" style="font-size:80%;">Ours w/o Learnable Temperature</span></th>
<td id="S6.T5.1.5.4.2" class="ltx_td ltx_align_center" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.5.4.2.1" class="ltx_text" style="font-size:80%;">49.80</span><span id="S6.T5.1.5.4.2.2" class="ltx_text" style="font-size:50%;">±4.52</span>
</td>
<td id="S6.T5.1.5.4.3" class="ltx_td ltx_align_center" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.5.4.3.1" class="ltx_text" style="font-size:80%;">46.07</span><span id="S6.T5.1.5.4.3.2" class="ltx_text" style="font-size:50%;">±1.61</span>
</td>
</tr>
<tr id="S6.T5.1.6.5" class="ltx_tr">
<th id="S6.T5.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;">
<span id="S6.T5.1.6.5.1.1" class="ltx_ERROR undefined">\rowcolor</span><span id="S6.T5.1.6.5.1.2" class="ltx_text" style="font-size:80%;">gray!20Ours</span>
</th>
<td id="S6.T5.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;"><span id="S6.T5.1.6.5.2.1" class="ltx_text ltx_font_bold" style="font-size:80%;">56.46<span id="S6.T5.1.6.5.2.1.1" class="ltx_text" style="font-size:63%;">±4.18</span></span></td>
<td id="S6.T5.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-left:11.6pt;padding-right:11.6pt;"><span id="S6.T5.1.6.5.3.1" class="ltx_text ltx_font_bold" style="font-size:80%;">53.98<span id="S6.T5.1.6.5.3.1.1" class="ltx_text" style="font-size:63%;">±1.29</span></span></td>
</tr>
</tbody>
</table>
</figure>
<section id="S6.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Acknowledgments</h3>

<div id="S6.SSx1.p1" class="ltx_para">
<p id="S6.SSx1.p1.1" class="ltx_p">This work was supported by the National Key Research and Development Project of China (2021YFC3340300), National Natural Science Foundation of China (U19B2042), the Zhejiang Provincial Key Research and Development Project (2022C03106), University Synergy Innovation Program of Anhui Province (GXXT-2021-004), Academy Of Social Governance Zhejiang University, Fundamental Research Funds for the Central Universities (226-2022-00064). This work was supported in part by the National Key R&amp;D Program of China (Project No. 2022ZD0115100), the Research Center for Industries of the Future (RCIF) at Westlake University, and Westlake Education Foundation.</p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue Zhao, Ramon Matas, Matthew Mattina, Paul Whatmough,
and Venkatesh Saligrama.

</span>
<span class="ltx_bibblock">Federated learning based on dynamic regularization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Mohammed Adnan, Shivam Kalra, Jesse C Cresswell, Graham W Taylor, and Hamid R
Tizhoosh.

</span>
<span class="ltx_bibblock">Federated learning and differential privacy for medical image
analysis.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Scientific reports</span>, 12(1):1953, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Hong-You Chen and Wei-Lun Chao.

</span>
<span class="ltx_bibblock">On bridging generic and personalized federated learning for image
classification.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
2089–2099. PMLR, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Yutong Dai, Zeyuan Chen, Junnan Li, Shelby Heinecke, Lichao Sun, and Ran Xu.

</span>
<span class="ltx_bibblock">Tackling data heterogeneity in federated learning with class
prototypes.

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">2009 IEEE conference on computer vision and pattern
recognition</span>, pages 248–255. Ieee, 2009.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Avishek Ghosh, Jichan Chung, Dong Yin, and Kannan Ramchandran.

</span>
<span class="ltx_bibblock">An efficient framework for clustered federated learning.

</span>
<span class="ltx_bibblock">In Hugo Larochelle, Marc’Aurelio Ranzato, Raia Hadsell,
Maria-Florina Balcan, and Hsuan-Tien Lin, editors, <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Advances in
Neural Information Processing Systems 33: Annual Conference on Neural
Information Processing Systems 2020, NeurIPS 2020, December 6-12, 2020,
virtual</span>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Pengfei Guo, Dong Yang, Ali Hatamizadeh, An Xu, Ziyue Xu, Wenqi Li, Can Zhao,
Daguang Xu, Stephanie Harmon, Evrim Turkbey, et al.

</span>
<span class="ltx_bibblock">Auto-fedrl: Federated hyperparameter optimization for
multi-institutional medical image segmentation.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2203.06338</span>, 2022.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Andrew Hard, Kurt Partridge, Cameron Nguyen, Niranjan Subrahmanya, Aishanee
Shah, Pai Zhu, Ignacio Lopez Moreno, and Rajiv Mathews.

</span>
<span class="ltx_bibblock">Training keyword spotting models on non-iid data with federated
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2005.10406</span>, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 770–778, 2016.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol Vinyals, Jeff Dean, et al.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1503.02531</span>, 2(7), 2015.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Andrew Howard, Andrey Zhmoginov, Liang-Chieh Chen, Mark Sandler, and Menglong
Zhu.

</span>
<span class="ltx_bibblock">Inverted residuals and linear bottlenecks: Mobile networks for
classification, detection and segmentation.

</span>
<span class="ltx_bibblock">2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Gao Huang, Zhuang Liu, Laurens Van Der Maaten, and Kilian Q Weinberger.

</span>
<span class="ltx_bibblock">Densely connected convolutional networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 4700–4708, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Wenke Huang, Mang Ye, and Bo Du.

</span>
<span class="ltx_bibblock">Learn from others and be yourself in heterogeneous federated
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2022.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Wenke Huang, Mang Ye, Zekun Shi, He Li, and Bo Du.

</span>
<span class="ltx_bibblock">Rethinking federated learning with domain shift: A prototype view.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2023.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Wenlong Ji, Yiping Lu, Yiliang Zhang, Zhun Deng, and Weijie J Su.

</span>
<span class="ltx_bibblock">An unconstrained layer-peeled perspective on neural collapse.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2110.02796</span>, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jiawen Kang, Zehui Xiong, Dusit Niyato, Yuze Zou, Yang Zhang, and Mohsen
Guizani.

</span>
<span class="ltx_bibblock">Reliable federated learning for mobile networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">IEEE Wireless Communications</span>, 27(2):72–80, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Latif U Khan, Walid Saad, Zhu Han, Ekram Hossain, and Choong Seon Hong.

</span>
<span class="ltx_bibblock">Federated learning for internet of things: Recent advances, taxonomy,
and open challenges.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">IEEE Communications Surveys &amp; Tutorials</span>, 23(3):1759–1799,
2021.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Vignesh Kothapalli, Ebrahim Rasromani, and Vasudev Awatramani.

</span>
<span class="ltx_bibblock">Neural collapse: A review on modelling principles and generalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2206.04041</span>, 2022.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Alex Krizhevsky et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Citeseer</span>, 2009.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Ya Le and Xuan Yang.

</span>
<span class="ltx_bibblock">Tiny imagenet visual recognition challenge.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">CS 231N</span>, 7(7):3, 2015.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Bo Li, Mikkel N Schmidt, Tommy S Alstrøm, and Sebastian U Stich.

</span>
<span class="ltx_bibblock">Partial variance reduction improves non-convex federated learning on
heterogeneous data.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2212.02191</span>, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Hao Li, Zheng Xu, Gavin Taylor, Christoph Studer, and Tom Goldstein.

</span>
<span class="ltx_bibblock">Visualizing the loss landscape of neural nets.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>, 31, 2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through personalization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
6357–6368. PMLR, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Proceedings of Machine Learning and Systems</span>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Xiao Li, Sheng Liu, Jinxin Zhou, Xinyu Lu, Carlos Fernandez-Granda, Zhihui Zhu,
and Qing Qu.

</span>
<span class="ltx_bibblock">Principled and efficient transfer learning of deep models via neural
collapse.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2212.12206</span>, 2022.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Zexi Li, Qunwei Li, Yi Zhou, Wenliang Zhong, Guannan Zhang, and Chao Wu.

</span>
<span class="ltx_bibblock">Edge-cloud collaborative learning with federated and centralized
features.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">Proceedings of the 46th International ACM SIGIR Conference on
Research and Development in Information Retrieval</span>, SIGIR ’23, page
1949–1953, New York, NY, USA, 2023. Association for Computing Machinery.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Zexi Li, Tao Lin, Xinyi Shang, and Chao Wu.

</span>
<span class="ltx_bibblock">Revisiting weighted aggregation in federated learning with neural
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>. PMLR, 2023.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Zexi Li, Jiaxun Lu, Shuang Luo, Didi Zhu, Yunfeng Shao, Yinchuan Li, Zhimeng
Zhang, Yongheng Wang, and Chao Wu.

</span>
<span class="ltx_bibblock">Towards effective clustered federated learning: A peer-to-peer
framework with adaptive neighbor matching.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Big Data</span>, 2022.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Zexi Li, Feng Mao, and Chao Wu.

</span>
<span class="ltx_bibblock">Can we share models if sharing data is not an option?

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">Patterns</span>, 3(11):100603, 2022.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Tao Lin, Lingjing Kong, Sebastian U Stich, and Martin Jaggi.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
33:2351–2363, 2020.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Mi Luo, Fei Chen, Dapeng Hu, Yifan Zhang, Jian Liang, and Jiashi Feng.

</span>
<span class="ltx_bibblock">No fear of heterogeneity: Classifier calibration for federated
learning with non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
34:5972–5984, 2021.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y
Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and statistics</span>, pages 1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Dinh C Nguyen, Ming Ding, Pubudu N Pathirana, Aruna Seneviratne, Jun Li, and
H Vincent Poor.

</span>
<span class="ltx_bibblock">Federated learning for internet of things: A comprehensive survey.

</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">IEEE Communications Surveys &amp; Tutorials</span>, 23(3):1622–1658,
2021.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Vardan Papyan, XY Han, and David L Donoho.

</span>
<span class="ltx_bibblock">Prevalence of neural collapse during the terminal phase of deep
learning training.

</span>
<span class="ltx_bibblock">volume 117, pages 24652–24663. National Acad Sciences, 2020.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Jiawei Ren, Cunjun Yu, Xiao Ma, Haiyu Zhao, Shuai Yi, et al.

</span>
<span class="ltx_bibblock">Balanced meta-softmax for long-tailed visual recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>,
33:4175–4186, 2020.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Mark Sandler, Andrew Howard, Menglong Zhu, Andrey Zhmoginov, and Liang-Chieh
Chen.

</span>
<span class="ltx_bibblock">Mobilenetv2: Inverted residuals and linear bottlenecks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 4510–4520, 2018.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Xinyi Shang, Yang Lu, Gang Huang, and Hanzi Wang.

</span>
<span class="ltx_bibblock">Federated learning on heterogeneous and long-tailed data via
classifier re-training with federated features.

</span>
<span class="ltx_bibblock">pages 2218–2224, 2022.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Mingxing Tan and Quoc Le.

</span>
<span class="ltx_bibblock">Efficientnet: Rethinking model scaling for convolutional neural
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">International conference on machine learning</span>, pages
6105–6114. PMLR, 2019.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Yue Tan, Guodong Long, Lu Liu, Tianyi Zhou, Qinghua Lu, Jing Jiang, and Chengqi
Zhang.

</span>
<span class="ltx_bibblock">Fedproto: Federated prototype learning across heterogeneous clients.

</span>
<span class="ltx_bibblock">In <span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, volume 36, pages 8432–8440, 2022.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Christos Thrampoulidis, Ganesh R Kini, Vala Vakilian, and Tina Behnia.

</span>
<span class="ltx_bibblock">Imbalance trouble: Revisiting neural-collapse geometry.

</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2208.05512</span>, 2022.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Tom Tirer and Joan Bruna.

</span>
<span class="ltx_bibblock">Extended unconstrained features model for exploring deep neural
collapse.

</span>
<span class="ltx_bibblock">In <span id="bib.bib42.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
21478–21505. PMLR, 2022.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Liang Xie, Yibo Yang, Deng Cai, and Xiaofei He.

</span>
<span class="ltx_bibblock">Neural collapse inspired attraction-repulsion-balanced loss for
imbalanced learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">Neurocomputing</span>, 2023.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Yibo Yang, Liang Xie, Shixiang Chen, Xiangtai Li, Zhouchen Lin, and Dacheng
Tao.

</span>
<span class="ltx_bibblock">Do we really need a learnable classifier at the end of deep neural
network?

</span>
<span class="ltx_bibblock">volume 33, pages 2351–2363, 2022.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Yibo Yang, Haobo Yuan, Xiangtai Li, Zhouchen Lin, Philip Torr, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Neural collapse inspired feature-classifier alignment for few-shot
class-incremental learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2023.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Rui Ye, Zhenyang Ni, Chenxin Xu, Jianyu Wang, Siheng Chen, and Yonina C Eldar.

</span>
<span class="ltx_bibblock">Fedfm: Anchor-based feature matching for data heterogeneity in
federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2210.07615</span>, 2022.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Rui Ye, Mingkai Xu, Jianyu Wang, Chenxin Xu, Siheng Chen, and Yanfeng Wang.

</span>
<span class="ltx_bibblock">Feddisco: Federated learning with discrepancy-aware collaboration.

</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2305.19229</span>, 2023.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Honglin Yuan, Warren Richard Morningstar, Lin Ning, and Karan Singhal.

</span>
<span class="ltx_bibblock">What do we mean by generalization in federated learning?

</span>
<span class="ltx_bibblock">In <span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2021.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Jie Zhang, Chen Chen, Bo Li, Lingjuan Lyu, Shuang Wu, Shouhong Ding, Chunhua
Shen, and Chao Wu.

</span>
<span class="ltx_bibblock">Dense: Data-free one-shot federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>,
35:21414–21428, 2022.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Jianqing Zhang, Yang Hua, Hao Wang, Tao Song, Zhengui Xue, Ruhui Ma, and
Haibing Guan.

</span>
<span class="ltx_bibblock">Fedala: Adaptive local aggregation for personalized federated
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib50.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, volume 37, pages 11237–11244, 2023.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Jianqing Zhang, Yang Hua, Hao Wang, Tao Song, Zhengui Xue, Ruhui Ma, and
Haibing Guan.

</span>
<span class="ltx_bibblock">Fedcp: Separating feature information for personalized federated
learning via conditional policy.

</span>
<span class="ltx_bibblock">In <span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">Proceedings of the 29th ACM SIGKDD Conference on Knowledge
Discovery and Data Mining</span>, KDD ’23, page 3249–3261, New York, NY, USA,
2023. Association for Computing Machinery.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Jie Zhang, Zhiqi Li, Bo Li, Jianghe Xu, Shuang Wu, Shouhong Ding, and Chao Wu.

</span>
<span class="ltx_bibblock">Federated learning with label distribution skew via logits
calibration.

</span>
<span class="ltx_bibblock">In <span id="bib.bib52.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
26311–26329. PMLR, 2022.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Tailin Zhou, Jun Zhang, and Danny Tsang.

</span>
<span class="ltx_bibblock">Fedfa: Federated learning with feature anchors to align feature and
classifier for heterogeneous data.

</span>
<span class="ltx_bibblock"><span id="bib.bib53.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2211.09299</span>, 2022.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Zhihui Zhu, Tianyu Ding, Jinxin Zhou, Xiao Li, Chong You, Jeremias Sulam, and
Qing Qu.

</span>
<span class="ltx_bibblock">A geometric analysis of neural collapse with unconstrained features.

</span>
<span class="ltx_bibblock">volume 34, pages 29820–29834, 2021.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold" style="font-size:173%;">Appendix</span></p>
</div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Pseudo Codes of the Proposed Method</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">To better present our approach and demonstrate the workflow, we give the pseudo codes of <span id="A1.p1.1.1" class="ltx_text ltx_font_smallcaps">FedETF</span>. The pseudo code of the federated learning (FL) training is shown in Algorithm <a href="#algorithm1" title="In Appendix A Pseudo Codes of the Proposed Method ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, and the pseudo code of the personalized local finetuning is shown in Algorithm <a href="#algorithm2" title="In Appendix A Pseudo Codes of the Proposed Method ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.17" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.6.6" class="ltx_listingline">
<span id="algorithm1.6.6.1" class="ltx_text"><span id="algorithm1.6.6.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Clients <math id="algorithm1.1.1.m1.3" class="ltx_Math" alttext="\{1,\dots,K\}" display="inline"><semantics id="algorithm1.1.1.m1.3a"><mrow id="algorithm1.1.1.m1.3.4.2" xref="algorithm1.1.1.m1.3.4.1.cmml"><mo stretchy="false" id="algorithm1.1.1.m1.3.4.2.1" xref="algorithm1.1.1.m1.3.4.1.cmml">{</mo><mn id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">1</mn><mo id="algorithm1.1.1.m1.3.4.2.2" xref="algorithm1.1.1.m1.3.4.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.1.1.m1.2.2" xref="algorithm1.1.1.m1.2.2.cmml">…</mi><mo id="algorithm1.1.1.m1.3.4.2.3" xref="algorithm1.1.1.m1.3.4.1.cmml">,</mo><mi id="algorithm1.1.1.m1.3.3" xref="algorithm1.1.1.m1.3.3.cmml">K</mi><mo stretchy="false" id="algorithm1.1.1.m1.3.4.2.4" xref="algorithm1.1.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.3b"><set id="algorithm1.1.1.m1.3.4.1.cmml" xref="algorithm1.1.1.m1.3.4.2"><cn type="integer" id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">1</cn><ci id="algorithm1.1.1.m1.2.2.cmml" xref="algorithm1.1.1.m1.2.2">…</ci><ci id="algorithm1.1.1.m1.3.3.cmml" xref="algorithm1.1.1.m1.3.3">𝐾</ci></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.3c">\{1,\dots,K\}</annotation></semantics></math>, communication round <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mi id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">T</annotation></semantics></math>, local epoch <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mi id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><ci id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">E</annotation></semantics></math>, initial model <math id="algorithm1.4.4.m4.3" class="ltx_Math" alttext="\mathbf{w}^{1}=\{\mathbf{u},\mathbf{p},\beta\}" display="inline"><semantics id="algorithm1.4.4.m4.3a"><mrow id="algorithm1.4.4.m4.3.4" xref="algorithm1.4.4.m4.3.4.cmml"><msup id="algorithm1.4.4.m4.3.4.2" xref="algorithm1.4.4.m4.3.4.2.cmml"><mi id="algorithm1.4.4.m4.3.4.2.2" xref="algorithm1.4.4.m4.3.4.2.2.cmml">𝐰</mi><mn id="algorithm1.4.4.m4.3.4.2.3" xref="algorithm1.4.4.m4.3.4.2.3.cmml">1</mn></msup><mo id="algorithm1.4.4.m4.3.4.1" xref="algorithm1.4.4.m4.3.4.1.cmml">=</mo><mrow id="algorithm1.4.4.m4.3.4.3.2" xref="algorithm1.4.4.m4.3.4.3.1.cmml"><mo stretchy="false" id="algorithm1.4.4.m4.3.4.3.2.1" xref="algorithm1.4.4.m4.3.4.3.1.cmml">{</mo><mi id="algorithm1.4.4.m4.1.1" xref="algorithm1.4.4.m4.1.1.cmml">𝐮</mi><mo id="algorithm1.4.4.m4.3.4.3.2.2" xref="algorithm1.4.4.m4.3.4.3.1.cmml">,</mo><mi id="algorithm1.4.4.m4.2.2" xref="algorithm1.4.4.m4.2.2.cmml">𝐩</mi><mo id="algorithm1.4.4.m4.3.4.3.2.3" xref="algorithm1.4.4.m4.3.4.3.1.cmml">,</mo><mi id="algorithm1.4.4.m4.3.3" xref="algorithm1.4.4.m4.3.3.cmml">β</mi><mo stretchy="false" id="algorithm1.4.4.m4.3.4.3.2.4" xref="algorithm1.4.4.m4.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m4.3b"><apply id="algorithm1.4.4.m4.3.4.cmml" xref="algorithm1.4.4.m4.3.4"><eq id="algorithm1.4.4.m4.3.4.1.cmml" xref="algorithm1.4.4.m4.3.4.1"></eq><apply id="algorithm1.4.4.m4.3.4.2.cmml" xref="algorithm1.4.4.m4.3.4.2"><csymbol cd="ambiguous" id="algorithm1.4.4.m4.3.4.2.1.cmml" xref="algorithm1.4.4.m4.3.4.2">superscript</csymbol><ci id="algorithm1.4.4.m4.3.4.2.2.cmml" xref="algorithm1.4.4.m4.3.4.2.2">𝐰</ci><cn type="integer" id="algorithm1.4.4.m4.3.4.2.3.cmml" xref="algorithm1.4.4.m4.3.4.2.3">1</cn></apply><set id="algorithm1.4.4.m4.3.4.3.1.cmml" xref="algorithm1.4.4.m4.3.4.3.2"><ci id="algorithm1.4.4.m4.1.1.cmml" xref="algorithm1.4.4.m4.1.1">𝐮</ci><ci id="algorithm1.4.4.m4.2.2.cmml" xref="algorithm1.4.4.m4.2.2">𝐩</ci><ci id="algorithm1.4.4.m4.3.3.cmml" xref="algorithm1.4.4.m4.3.3">𝛽</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m4.3c">\mathbf{w}^{1}=\{\mathbf{u},\mathbf{p},\beta\}</annotation></semantics></math>, feature dimension <math id="algorithm1.5.5.m5.1" class="ltx_Math" alttext="d" display="inline"><semantics id="algorithm1.5.5.m5.1a"><mi id="algorithm1.5.5.m5.1.1" xref="algorithm1.5.5.m5.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m5.1b"><ci id="algorithm1.5.5.m5.1.1.cmml" xref="algorithm1.5.5.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m5.1c">d</annotation></semantics></math>, balanced loss hyperparameter <math id="algorithm1.6.6.m6.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="algorithm1.6.6.m6.1a"><mi id="algorithm1.6.6.m6.1.1" xref="algorithm1.6.6.m6.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m6.1b"><ci id="algorithm1.6.6.m6.1.1.cmml" xref="algorithm1.6.6.m6.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m6.1c">\gamma</annotation></semantics></math>.
</div>
<div id="algorithm1.7.7" class="ltx_listingline">
<span id="algorithm1.7.7.1" class="ltx_text"><span id="algorithm1.7.7.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Gloabl model <math id="algorithm1.7.7.m1.1" class="ltx_Math" alttext="\mathbf{w}^{g}" display="inline"><semantics id="algorithm1.7.7.m1.1a"><msup id="algorithm1.7.7.m1.1.1" xref="algorithm1.7.7.m1.1.1.cmml"><mi id="algorithm1.7.7.m1.1.1.2" xref="algorithm1.7.7.m1.1.1.2.cmml">𝐰</mi><mi id="algorithm1.7.7.m1.1.1.3" xref="algorithm1.7.7.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><apply id="algorithm1.7.7.m1.1.1.cmml" xref="algorithm1.7.7.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1">superscript</csymbol><ci id="algorithm1.7.7.m1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.2">𝐰</ci><ci id="algorithm1.7.7.m1.1.1.3.cmml" xref="algorithm1.7.7.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">\mathbf{w}^{g}</annotation></semantics></math>.
</div>
<div id="algorithm1.8.8" class="ltx_listingline">
Synthesize a simplex ETF <math id="algorithm1.8.8.m1.1" class="ltx_Math" alttext="\mathbf{V}_{ETF}\in\mathbb{R}^{d\times C}" display="inline"><semantics id="algorithm1.8.8.m1.1a"><mrow id="algorithm1.8.8.m1.1.1" xref="algorithm1.8.8.m1.1.1.cmml"><msub id="algorithm1.8.8.m1.1.1.2" xref="algorithm1.8.8.m1.1.1.2.cmml"><mi id="algorithm1.8.8.m1.1.1.2.2" xref="algorithm1.8.8.m1.1.1.2.2.cmml">𝐕</mi><mrow id="algorithm1.8.8.m1.1.1.2.3" xref="algorithm1.8.8.m1.1.1.2.3.cmml"><mi id="algorithm1.8.8.m1.1.1.2.3.2" xref="algorithm1.8.8.m1.1.1.2.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="algorithm1.8.8.m1.1.1.2.3.1" xref="algorithm1.8.8.m1.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.8.8.m1.1.1.2.3.3" xref="algorithm1.8.8.m1.1.1.2.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="algorithm1.8.8.m1.1.1.2.3.1a" xref="algorithm1.8.8.m1.1.1.2.3.1.cmml">​</mo><mi id="algorithm1.8.8.m1.1.1.2.3.4" xref="algorithm1.8.8.m1.1.1.2.3.4.cmml">F</mi></mrow></msub><mo id="algorithm1.8.8.m1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.cmml">∈</mo><msup id="algorithm1.8.8.m1.1.1.3" xref="algorithm1.8.8.m1.1.1.3.cmml"><mi id="algorithm1.8.8.m1.1.1.3.2" xref="algorithm1.8.8.m1.1.1.3.2.cmml">ℝ</mi><mrow id="algorithm1.8.8.m1.1.1.3.3" xref="algorithm1.8.8.m1.1.1.3.3.cmml"><mi id="algorithm1.8.8.m1.1.1.3.3.2" xref="algorithm1.8.8.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="algorithm1.8.8.m1.1.1.3.3.1" xref="algorithm1.8.8.m1.1.1.3.3.1.cmml">×</mo><mi id="algorithm1.8.8.m1.1.1.3.3.3" xref="algorithm1.8.8.m1.1.1.3.3.3.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.1b"><apply id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1"><in id="algorithm1.8.8.m1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1"></in><apply id="algorithm1.8.8.m1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.1.1.2.1.cmml" xref="algorithm1.8.8.m1.1.1.2">subscript</csymbol><ci id="algorithm1.8.8.m1.1.1.2.2.cmml" xref="algorithm1.8.8.m1.1.1.2.2">𝐕</ci><apply id="algorithm1.8.8.m1.1.1.2.3.cmml" xref="algorithm1.8.8.m1.1.1.2.3"><times id="algorithm1.8.8.m1.1.1.2.3.1.cmml" xref="algorithm1.8.8.m1.1.1.2.3.1"></times><ci id="algorithm1.8.8.m1.1.1.2.3.2.cmml" xref="algorithm1.8.8.m1.1.1.2.3.2">𝐸</ci><ci id="algorithm1.8.8.m1.1.1.2.3.3.cmml" xref="algorithm1.8.8.m1.1.1.2.3.3">𝑇</ci><ci id="algorithm1.8.8.m1.1.1.2.3.4.cmml" xref="algorithm1.8.8.m1.1.1.2.3.4">𝐹</ci></apply></apply><apply id="algorithm1.8.8.m1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.1.1.3.1.cmml" xref="algorithm1.8.8.m1.1.1.3">superscript</csymbol><ci id="algorithm1.8.8.m1.1.1.3.2.cmml" xref="algorithm1.8.8.m1.1.1.3.2">ℝ</ci><apply id="algorithm1.8.8.m1.1.1.3.3.cmml" xref="algorithm1.8.8.m1.1.1.3.3"><times id="algorithm1.8.8.m1.1.1.3.3.1.cmml" xref="algorithm1.8.8.m1.1.1.3.3.1"></times><ci id="algorithm1.8.8.m1.1.1.3.3.2.cmml" xref="algorithm1.8.8.m1.1.1.3.3.2">𝑑</ci><ci id="algorithm1.8.8.m1.1.1.3.3.3.cmml" xref="algorithm1.8.8.m1.1.1.3.3.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.1c">\mathbf{V}_{ETF}\in\mathbb{R}^{d\times C}</annotation></semantics></math> by Eq. (3) as the fixed classifier for all clients;
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span id="algorithm1.9.9.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.9.9.1" class="ltx_emph ltx_font_italic"><math id="algorithm1.9.9.1.m1.3" class="ltx_Math" alttext="t=1,\dots,T" display="inline"><semantics id="algorithm1.9.9.1.m1.3a"><mrow id="algorithm1.9.9.1.m1.3.4" xref="algorithm1.9.9.1.m1.3.4.cmml"><mi id="algorithm1.9.9.1.m1.3.4.2" xref="algorithm1.9.9.1.m1.3.4.2.cmml">t</mi><mo id="algorithm1.9.9.1.m1.3.4.1" xref="algorithm1.9.9.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm1.9.9.1.m1.3.4.3.2" xref="algorithm1.9.9.1.m1.3.4.3.1.cmml"><mn id="algorithm1.9.9.1.m1.1.1" xref="algorithm1.9.9.1.m1.1.1.cmml">1</mn><mo id="algorithm1.9.9.1.m1.3.4.3.2.1" xref="algorithm1.9.9.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.9.9.1.m1.2.2" xref="algorithm1.9.9.1.m1.2.2.cmml">…</mi><mo id="algorithm1.9.9.1.m1.3.4.3.2.2" xref="algorithm1.9.9.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm1.9.9.1.m1.3.3" xref="algorithm1.9.9.1.m1.3.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.1.m1.3b"><apply id="algorithm1.9.9.1.m1.3.4.cmml" xref="algorithm1.9.9.1.m1.3.4"><eq id="algorithm1.9.9.1.m1.3.4.1.cmml" xref="algorithm1.9.9.1.m1.3.4.1"></eq><ci id="algorithm1.9.9.1.m1.3.4.2.cmml" xref="algorithm1.9.9.1.m1.3.4.2">𝑡</ci><list id="algorithm1.9.9.1.m1.3.4.3.1.cmml" xref="algorithm1.9.9.1.m1.3.4.3.2"><cn type="integer" id="algorithm1.9.9.1.m1.1.1.cmml" xref="algorithm1.9.9.1.m1.1.1">1</cn><ci id="algorithm1.9.9.1.m1.2.2.cmml" xref="algorithm1.9.9.1.m1.2.2">…</ci><ci id="algorithm1.9.9.1.m1.3.3.cmml" xref="algorithm1.9.9.1.m1.3.3">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.1.m1.3c">t=1,\dots,T</annotation></semantics></math></em> <span id="algorithm1.9.9.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.10.10" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.10.10.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.10.10.1" class="ltx_emph ltx_font_italic"><span id="algorithm1.10.10.1.1" class="ltx_text ltx_font_upright">client</span> <math id="algorithm1.10.10.1.m1.3" class="ltx_Math" alttext="k=1,\dots,K" display="inline"><semantics id="algorithm1.10.10.1.m1.3a"><mrow id="algorithm1.10.10.1.m1.3.4" xref="algorithm1.10.10.1.m1.3.4.cmml"><mi id="algorithm1.10.10.1.m1.3.4.2" xref="algorithm1.10.10.1.m1.3.4.2.cmml">k</mi><mo id="algorithm1.10.10.1.m1.3.4.1" xref="algorithm1.10.10.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm1.10.10.1.m1.3.4.3.2" xref="algorithm1.10.10.1.m1.3.4.3.1.cmml"><mn id="algorithm1.10.10.1.m1.1.1" xref="algorithm1.10.10.1.m1.1.1.cmml">1</mn><mo id="algorithm1.10.10.1.m1.3.4.3.2.1" xref="algorithm1.10.10.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.10.10.1.m1.2.2" xref="algorithm1.10.10.1.m1.2.2.cmml">…</mi><mo id="algorithm1.10.10.1.m1.3.4.3.2.2" xref="algorithm1.10.10.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm1.10.10.1.m1.3.3" xref="algorithm1.10.10.1.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.1.m1.3b"><apply id="algorithm1.10.10.1.m1.3.4.cmml" xref="algorithm1.10.10.1.m1.3.4"><eq id="algorithm1.10.10.1.m1.3.4.1.cmml" xref="algorithm1.10.10.1.m1.3.4.1"></eq><ci id="algorithm1.10.10.1.m1.3.4.2.cmml" xref="algorithm1.10.10.1.m1.3.4.2">𝑘</ci><list id="algorithm1.10.10.1.m1.3.4.3.1.cmml" xref="algorithm1.10.10.1.m1.3.4.3.2"><cn type="integer" id="algorithm1.10.10.1.m1.1.1.cmml" xref="algorithm1.10.10.1.m1.1.1">1</cn><ci id="algorithm1.10.10.1.m1.2.2.cmml" xref="algorithm1.10.10.1.m1.2.2">…</ci><ci id="algorithm1.10.10.1.m1.3.3.cmml" xref="algorithm1.10.10.1.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.1.m1.3c">k=1,\dots,K</annotation></semantics></math> <span id="algorithm1.10.10.1.2" class="ltx_text ltx_font_bold">in parallel</span></em> <span id="algorithm1.10.10.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.11.11" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.11.11.m1.1" class="ltx_Math" alttext="\mathbf{w}_{k}^{t}\leftarrow\mathbf{w}^{t}" display="inline"><semantics id="algorithm1.11.11.m1.1a"><mrow id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml"><msubsup id="algorithm1.11.11.m1.1.1.2" xref="algorithm1.11.11.m1.1.1.2.cmml"><mi id="algorithm1.11.11.m1.1.1.2.2.2" xref="algorithm1.11.11.m1.1.1.2.2.2.cmml">𝐰</mi><mi id="algorithm1.11.11.m1.1.1.2.2.3" xref="algorithm1.11.11.m1.1.1.2.2.3.cmml">k</mi><mi id="algorithm1.11.11.m1.1.1.2.3" xref="algorithm1.11.11.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="algorithm1.11.11.m1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.cmml">←</mo><msup id="algorithm1.11.11.m1.1.1.3" xref="algorithm1.11.11.m1.1.1.3.cmml"><mi id="algorithm1.11.11.m1.1.1.3.2" xref="algorithm1.11.11.m1.1.1.3.2.cmml">𝐰</mi><mi id="algorithm1.11.11.m1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1"><ci id="algorithm1.11.11.m1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1">←</ci><apply id="algorithm1.11.11.m1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.2.1.cmml" xref="algorithm1.11.11.m1.1.1.2">superscript</csymbol><apply id="algorithm1.11.11.m1.1.1.2.2.cmml" xref="algorithm1.11.11.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.2.2.1.cmml" xref="algorithm1.11.11.m1.1.1.2">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.2.2.2.cmml" xref="algorithm1.11.11.m1.1.1.2.2.2">𝐰</ci><ci id="algorithm1.11.11.m1.1.1.2.2.3.cmml" xref="algorithm1.11.11.m1.1.1.2.2.3">𝑘</ci></apply><ci id="algorithm1.11.11.m1.1.1.2.3.cmml" xref="algorithm1.11.11.m1.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.11.11.m1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.3">superscript</csymbol><ci id="algorithm1.11.11.m1.1.1.3.2.cmml" xref="algorithm1.11.11.m1.1.1.3.2">𝐰</ci><ci id="algorithm1.11.11.m1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">\mathbf{w}_{k}^{t}\leftarrow\mathbf{w}^{t}</annotation></semantics></math>; 
</div>
<div id="algorithm1.12.12" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.12.12.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.12.12.1" class="ltx_emph ltx_font_italic"><span id="algorithm1.12.12.1.1" class="ltx_text ltx_font_upright">local epoch</span> <math id="algorithm1.12.12.1.m1.3" class="ltx_Math" alttext="e=1,\dots,E" display="inline"><semantics id="algorithm1.12.12.1.m1.3a"><mrow id="algorithm1.12.12.1.m1.3.4" xref="algorithm1.12.12.1.m1.3.4.cmml"><mi id="algorithm1.12.12.1.m1.3.4.2" xref="algorithm1.12.12.1.m1.3.4.2.cmml">e</mi><mo id="algorithm1.12.12.1.m1.3.4.1" xref="algorithm1.12.12.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm1.12.12.1.m1.3.4.3.2" xref="algorithm1.12.12.1.m1.3.4.3.1.cmml"><mn id="algorithm1.12.12.1.m1.1.1" xref="algorithm1.12.12.1.m1.1.1.cmml">1</mn><mo id="algorithm1.12.12.1.m1.3.4.3.2.1" xref="algorithm1.12.12.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm1.12.12.1.m1.2.2" xref="algorithm1.12.12.1.m1.2.2.cmml">…</mi><mo id="algorithm1.12.12.1.m1.3.4.3.2.2" xref="algorithm1.12.12.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm1.12.12.1.m1.3.3" xref="algorithm1.12.12.1.m1.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.1.m1.3b"><apply id="algorithm1.12.12.1.m1.3.4.cmml" xref="algorithm1.12.12.1.m1.3.4"><eq id="algorithm1.12.12.1.m1.3.4.1.cmml" xref="algorithm1.12.12.1.m1.3.4.1"></eq><ci id="algorithm1.12.12.1.m1.3.4.2.cmml" xref="algorithm1.12.12.1.m1.3.4.2">𝑒</ci><list id="algorithm1.12.12.1.m1.3.4.3.1.cmml" xref="algorithm1.12.12.1.m1.3.4.3.2"><cn type="integer" id="algorithm1.12.12.1.m1.1.1.cmml" xref="algorithm1.12.12.1.m1.1.1">1</cn><ci id="algorithm1.12.12.1.m1.2.2.cmml" xref="algorithm1.12.12.1.m1.2.2">…</ci><ci id="algorithm1.12.12.1.m1.3.3.cmml" xref="algorithm1.12.12.1.m1.3.3">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.1.m1.3c">e=1,\dots,E</annotation></semantics></math></em> <span id="algorithm1.12.12.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.14.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Obtain <math id="algorithm1.13.13.m1.1" class="ltx_Math" alttext="\mathcal{L}_{k}^{g}" display="inline"><semantics id="algorithm1.13.13.m1.1a"><msubsup id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.13.13.m1.1.1.2.2" xref="algorithm1.13.13.m1.1.1.2.2.cmml">ℒ</mi><mi id="algorithm1.13.13.m1.1.1.2.3" xref="algorithm1.13.13.m1.1.1.2.3.cmml">k</mi><mi id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1">superscript</csymbol><apply id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.2.1.cmml" xref="algorithm1.13.13.m1.1.1">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.2.2.cmml" xref="algorithm1.13.13.m1.1.1.2.2">ℒ</ci><ci id="algorithm1.13.13.m1.1.1.2.3.cmml" xref="algorithm1.13.13.m1.1.1.2.3">𝑘</ci></apply><ci id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">\mathcal{L}_{k}^{g}</annotation></semantics></math> by Eq. (6, 7, 8);
<math id="algorithm1.14.14.m2.1" class="ltx_Math" alttext="\mathbf{w}_{k}^{t}\leftarrow\mathbf{w}_{k}^{t}-\eta\nabla\mathcal{L}_{k}^{g}(\mathbf{w}_{k}^{t})" display="inline"><semantics id="algorithm1.14.14.m2.1a"><mrow id="algorithm1.14.14.m2.1.1" xref="algorithm1.14.14.m2.1.1.cmml"><msubsup id="algorithm1.14.14.m2.1.1.3" xref="algorithm1.14.14.m2.1.1.3.cmml"><mi id="algorithm1.14.14.m2.1.1.3.2.2" xref="algorithm1.14.14.m2.1.1.3.2.2.cmml">𝐰</mi><mi id="algorithm1.14.14.m2.1.1.3.2.3" xref="algorithm1.14.14.m2.1.1.3.2.3.cmml">k</mi><mi id="algorithm1.14.14.m2.1.1.3.3" xref="algorithm1.14.14.m2.1.1.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="algorithm1.14.14.m2.1.1.2" xref="algorithm1.14.14.m2.1.1.2.cmml">←</mo><mrow id="algorithm1.14.14.m2.1.1.1" xref="algorithm1.14.14.m2.1.1.1.cmml"><msubsup id="algorithm1.14.14.m2.1.1.1.3" xref="algorithm1.14.14.m2.1.1.1.3.cmml"><mi id="algorithm1.14.14.m2.1.1.1.3.2.2" xref="algorithm1.14.14.m2.1.1.1.3.2.2.cmml">𝐰</mi><mi id="algorithm1.14.14.m2.1.1.1.3.2.3" xref="algorithm1.14.14.m2.1.1.1.3.2.3.cmml">k</mi><mi id="algorithm1.14.14.m2.1.1.1.3.3" xref="algorithm1.14.14.m2.1.1.1.3.3.cmml">t</mi></msubsup><mo id="algorithm1.14.14.m2.1.1.1.2" xref="algorithm1.14.14.m2.1.1.1.2.cmml">−</mo><mrow id="algorithm1.14.14.m2.1.1.1.1" xref="algorithm1.14.14.m2.1.1.1.1.cmml"><mi id="algorithm1.14.14.m2.1.1.1.1.3" xref="algorithm1.14.14.m2.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm1.14.14.m2.1.1.1.1.2" xref="algorithm1.14.14.m2.1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.14.14.m2.1.1.1.1.4" xref="algorithm1.14.14.m2.1.1.1.1.4.cmml"><mo rspace="0.167em" id="algorithm1.14.14.m2.1.1.1.1.4.1" xref="algorithm1.14.14.m2.1.1.1.1.4.1.cmml">∇</mo><msubsup id="algorithm1.14.14.m2.1.1.1.1.4.2" xref="algorithm1.14.14.m2.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.14.14.m2.1.1.1.1.4.2.2.2" xref="algorithm1.14.14.m2.1.1.1.1.4.2.2.2.cmml">ℒ</mi><mi id="algorithm1.14.14.m2.1.1.1.1.4.2.2.3" xref="algorithm1.14.14.m2.1.1.1.1.4.2.2.3.cmml">k</mi><mi id="algorithm1.14.14.m2.1.1.1.1.4.2.3" xref="algorithm1.14.14.m2.1.1.1.1.4.2.3.cmml">g</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="algorithm1.14.14.m2.1.1.1.1.2a" xref="algorithm1.14.14.m2.1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.14.14.m2.1.1.1.1.1.1" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm1.14.14.m2.1.1.1.1.1.1.2" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="algorithm1.14.14.m2.1.1.1.1.1.1.1" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.2" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.3" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="algorithm1.14.14.m2.1.1.1.1.1.1.1.3" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="algorithm1.14.14.m2.1.1.1.1.1.1.3" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m2.1b"><apply id="algorithm1.14.14.m2.1.1.cmml" xref="algorithm1.14.14.m2.1.1"><ci id="algorithm1.14.14.m2.1.1.2.cmml" xref="algorithm1.14.14.m2.1.1.2">←</ci><apply id="algorithm1.14.14.m2.1.1.3.cmml" xref="algorithm1.14.14.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.1.1.3.1.cmml" xref="algorithm1.14.14.m2.1.1.3">superscript</csymbol><apply id="algorithm1.14.14.m2.1.1.3.2.cmml" xref="algorithm1.14.14.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.1.1.3.2.1.cmml" xref="algorithm1.14.14.m2.1.1.3">subscript</csymbol><ci id="algorithm1.14.14.m2.1.1.3.2.2.cmml" xref="algorithm1.14.14.m2.1.1.3.2.2">𝐰</ci><ci id="algorithm1.14.14.m2.1.1.3.2.3.cmml" xref="algorithm1.14.14.m2.1.1.3.2.3">𝑘</ci></apply><ci id="algorithm1.14.14.m2.1.1.3.3.cmml" xref="algorithm1.14.14.m2.1.1.3.3">𝑡</ci></apply><apply id="algorithm1.14.14.m2.1.1.1.cmml" xref="algorithm1.14.14.m2.1.1.1"><minus id="algorithm1.14.14.m2.1.1.1.2.cmml" xref="algorithm1.14.14.m2.1.1.1.2"></minus><apply id="algorithm1.14.14.m2.1.1.1.3.cmml" xref="algorithm1.14.14.m2.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.1.1.1.3.1.cmml" xref="algorithm1.14.14.m2.1.1.1.3">superscript</csymbol><apply id="algorithm1.14.14.m2.1.1.1.3.2.cmml" xref="algorithm1.14.14.m2.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.1.1.1.3.2.1.cmml" xref="algorithm1.14.14.m2.1.1.1.3">subscript</csymbol><ci id="algorithm1.14.14.m2.1.1.1.3.2.2.cmml" xref="algorithm1.14.14.m2.1.1.1.3.2.2">𝐰</ci><ci id="algorithm1.14.14.m2.1.1.1.3.2.3.cmml" xref="algorithm1.14.14.m2.1.1.1.3.2.3">𝑘</ci></apply><ci id="algorithm1.14.14.m2.1.1.1.3.3.cmml" xref="algorithm1.14.14.m2.1.1.1.3.3">𝑡</ci></apply><apply id="algorithm1.14.14.m2.1.1.1.1.cmml" xref="algorithm1.14.14.m2.1.1.1.1"><times id="algorithm1.14.14.m2.1.1.1.1.2.cmml" xref="algorithm1.14.14.m2.1.1.1.1.2"></times><ci id="algorithm1.14.14.m2.1.1.1.1.3.cmml" xref="algorithm1.14.14.m2.1.1.1.1.3">𝜂</ci><apply id="algorithm1.14.14.m2.1.1.1.1.4.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4"><ci id="algorithm1.14.14.m2.1.1.1.1.4.1.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4.1">∇</ci><apply id="algorithm1.14.14.m2.1.1.1.1.4.2.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.1.1.1.1.4.2.1.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4.2">superscript</csymbol><apply id="algorithm1.14.14.m2.1.1.1.1.4.2.2.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.1.1.1.1.4.2.2.1.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4.2">subscript</csymbol><ci id="algorithm1.14.14.m2.1.1.1.1.4.2.2.2.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4.2.2.2">ℒ</ci><ci id="algorithm1.14.14.m2.1.1.1.1.4.2.2.3.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4.2.2.3">𝑘</ci></apply><ci id="algorithm1.14.14.m2.1.1.1.1.4.2.3.cmml" xref="algorithm1.14.14.m2.1.1.1.1.4.2.3">𝑔</ci></apply></apply><apply id="algorithm1.14.14.m2.1.1.1.1.1.1.1.cmml" xref="algorithm1.14.14.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.14.14.m2.1.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.14.14.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.14.14.m2.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="algorithm1.14.14.m2.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.14.14.m2.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m2.1c">\mathbf{w}_{k}^{t}\leftarrow\mathbf{w}_{k}^{t}-\eta\nabla\mathcal{L}_{k}^{g}(\mathbf{w}_{k}^{t})</annotation></semantics></math>;

</div>
<div id="algorithm1.17.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.17.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm1.17.20" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.15.15" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   The server updates <math id="algorithm1.15.15.m1.1" class="ltx_Math" alttext="\mathbf{w}^{t+1}" display="inline"><semantics id="algorithm1.15.15.m1.1a"><msup id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><mi id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml">𝐰</mi><mrow id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml"><mi id="algorithm1.15.15.m1.1.1.3.2" xref="algorithm1.15.15.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.15.15.m1.1.1.3.1" xref="algorithm1.15.15.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.15.15.m1.1.1.3.3" xref="algorithm1.15.15.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1">superscript</csymbol><ci id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2">𝐰</ci><apply id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3"><plus id="algorithm1.15.15.m1.1.1.3.1.cmml" xref="algorithm1.15.15.m1.1.1.3.1"></plus><ci id="algorithm1.15.15.m1.1.1.3.2.cmml" xref="algorithm1.15.15.m1.1.1.3.2">𝑡</ci><cn type="integer" id="algorithm1.15.15.m1.1.1.3.3.cmml" xref="algorithm1.15.15.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">\mathbf{w}^{t+1}</annotation></semantics></math> by Eq. (2).

</div>
<div id="algorithm1.17.21" class="ltx_listingline"> end for
</div>
<div id="algorithm1.17.17" class="ltx_listingline">The final global model <math id="algorithm1.16.16.m1.1" class="ltx_Math" alttext="\mathbf{w}^{g}" display="inline"><semantics id="algorithm1.16.16.m1.1a"><msup id="algorithm1.16.16.m1.1.1" xref="algorithm1.16.16.m1.1.1.cmml"><mi id="algorithm1.16.16.m1.1.1.2" xref="algorithm1.16.16.m1.1.1.2.cmml">𝐰</mi><mi id="algorithm1.16.16.m1.1.1.3" xref="algorithm1.16.16.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.1b"><apply id="algorithm1.16.16.m1.1.1.cmml" xref="algorithm1.16.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1">superscript</csymbol><ci id="algorithm1.16.16.m1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.2">𝐰</ci><ci id="algorithm1.16.16.m1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.1c">\mathbf{w}^{g}</annotation></semantics></math> = <math id="algorithm1.17.17.m2.1" class="ltx_Math" alttext="\mathbf{w}^{T}" display="inline"><semantics id="algorithm1.17.17.m2.1a"><msup id="algorithm1.17.17.m2.1.1" xref="algorithm1.17.17.m2.1.1.cmml"><mi id="algorithm1.17.17.m2.1.1.2" xref="algorithm1.17.17.m2.1.1.2.cmml">𝐰</mi><mi id="algorithm1.17.17.m2.1.1.3" xref="algorithm1.17.17.m2.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m2.1b"><apply id="algorithm1.17.17.m2.1.1.cmml" xref="algorithm1.17.17.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m2.1.1.1.cmml" xref="algorithm1.17.17.m2.1.1">superscript</csymbol><ci id="algorithm1.17.17.m2.1.1.2.cmml" xref="algorithm1.17.17.m2.1.1.2">𝐰</ci><ci id="algorithm1.17.17.m2.1.1.3.cmml" xref="algorithm1.17.17.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m2.1c">\mathbf{w}^{T}</annotation></semantics></math>.

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.20.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="algorithm1.21.2" class="ltx_text ltx_font_smallcaps">FedETF</span> FL Training </figcaption>
</figure>
<figure id="algorithm2" class="ltx_float ltx_algorithm">
<div id="algorithm2.22" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm2.4.4" class="ltx_listingline">

<span id="algorithm2.4.4.1" class="ltx_text"><span id="algorithm2.4.4.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>Clients <math id="algorithm2.1.1.m1.3" class="ltx_Math" alttext="\{1,\dots,K\}" display="inline"><semantics id="algorithm2.1.1.m1.3a"><mrow id="algorithm2.1.1.m1.3.4.2" xref="algorithm2.1.1.m1.3.4.1.cmml"><mo stretchy="false" id="algorithm2.1.1.m1.3.4.2.1" xref="algorithm2.1.1.m1.3.4.1.cmml">{</mo><mn id="algorithm2.1.1.m1.1.1" xref="algorithm2.1.1.m1.1.1.cmml">1</mn><mo id="algorithm2.1.1.m1.3.4.2.2" xref="algorithm2.1.1.m1.3.4.1.cmml">,</mo><mi mathvariant="normal" id="algorithm2.1.1.m1.2.2" xref="algorithm2.1.1.m1.2.2.cmml">…</mi><mo id="algorithm2.1.1.m1.3.4.2.3" xref="algorithm2.1.1.m1.3.4.1.cmml">,</mo><mi id="algorithm2.1.1.m1.3.3" xref="algorithm2.1.1.m1.3.3.cmml">K</mi><mo stretchy="false" id="algorithm2.1.1.m1.3.4.2.4" xref="algorithm2.1.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.1.1.m1.3b"><set id="algorithm2.1.1.m1.3.4.1.cmml" xref="algorithm2.1.1.m1.3.4.2"><cn type="integer" id="algorithm2.1.1.m1.1.1.cmml" xref="algorithm2.1.1.m1.1.1">1</cn><ci id="algorithm2.1.1.m1.2.2.cmml" xref="algorithm2.1.1.m1.2.2">…</ci><ci id="algorithm2.1.1.m1.3.3.cmml" xref="algorithm2.1.1.m1.3.3">𝐾</ci></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.1.1.m1.3c">\{1,\dots,K\}</annotation></semantics></math>, iteration round <math id="algorithm2.2.2.m2.1" class="ltx_Math" alttext="T_{p}" display="inline"><semantics id="algorithm2.2.2.m2.1a"><msub id="algorithm2.2.2.m2.1.1" xref="algorithm2.2.2.m2.1.1.cmml"><mi id="algorithm2.2.2.m2.1.1.2" xref="algorithm2.2.2.m2.1.1.2.cmml">T</mi><mi id="algorithm2.2.2.m2.1.1.3" xref="algorithm2.2.2.m2.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm2.2.2.m2.1b"><apply id="algorithm2.2.2.m2.1.1.cmml" xref="algorithm2.2.2.m2.1.1"><csymbol cd="ambiguous" id="algorithm2.2.2.m2.1.1.1.cmml" xref="algorithm2.2.2.m2.1.1">subscript</csymbol><ci id="algorithm2.2.2.m2.1.1.2.cmml" xref="algorithm2.2.2.m2.1.1.2">𝑇</ci><ci id="algorithm2.2.2.m2.1.1.3.cmml" xref="algorithm2.2.2.m2.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.2.2.m2.1c">T_{p}</annotation></semantics></math>, epoch for each stage <math id="algorithm2.3.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algorithm2.3.3.m3.1a"><mi id="algorithm2.3.3.m3.1.1" xref="algorithm2.3.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algorithm2.3.3.m3.1b"><ci id="algorithm2.3.3.m3.1.1.cmml" xref="algorithm2.3.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.3.3.m3.1c">E</annotation></semantics></math>, final global model <math id="algorithm2.4.4.m4.4" class="ltx_Math" alttext="\mathbf{w}^{g}=\{\mathbf{u},\mathbf{p},\beta,\mathbf{V}_{ETF}\}" display="inline"><semantics id="algorithm2.4.4.m4.4a"><mrow id="algorithm2.4.4.m4.4.4" xref="algorithm2.4.4.m4.4.4.cmml"><msup id="algorithm2.4.4.m4.4.4.3" xref="algorithm2.4.4.m4.4.4.3.cmml"><mi id="algorithm2.4.4.m4.4.4.3.2" xref="algorithm2.4.4.m4.4.4.3.2.cmml">𝐰</mi><mi id="algorithm2.4.4.m4.4.4.3.3" xref="algorithm2.4.4.m4.4.4.3.3.cmml">g</mi></msup><mo id="algorithm2.4.4.m4.4.4.2" xref="algorithm2.4.4.m4.4.4.2.cmml">=</mo><mrow id="algorithm2.4.4.m4.4.4.1.1" xref="algorithm2.4.4.m4.4.4.1.2.cmml"><mo stretchy="false" id="algorithm2.4.4.m4.4.4.1.1.2" xref="algorithm2.4.4.m4.4.4.1.2.cmml">{</mo><mi id="algorithm2.4.4.m4.1.1" xref="algorithm2.4.4.m4.1.1.cmml">𝐮</mi><mo id="algorithm2.4.4.m4.4.4.1.1.3" xref="algorithm2.4.4.m4.4.4.1.2.cmml">,</mo><mi id="algorithm2.4.4.m4.2.2" xref="algorithm2.4.4.m4.2.2.cmml">𝐩</mi><mo id="algorithm2.4.4.m4.4.4.1.1.4" xref="algorithm2.4.4.m4.4.4.1.2.cmml">,</mo><mi id="algorithm2.4.4.m4.3.3" xref="algorithm2.4.4.m4.3.3.cmml">β</mi><mo id="algorithm2.4.4.m4.4.4.1.1.5" xref="algorithm2.4.4.m4.4.4.1.2.cmml">,</mo><msub id="algorithm2.4.4.m4.4.4.1.1.1" xref="algorithm2.4.4.m4.4.4.1.1.1.cmml"><mi id="algorithm2.4.4.m4.4.4.1.1.1.2" xref="algorithm2.4.4.m4.4.4.1.1.1.2.cmml">𝐕</mi><mrow id="algorithm2.4.4.m4.4.4.1.1.1.3" xref="algorithm2.4.4.m4.4.4.1.1.1.3.cmml"><mi id="algorithm2.4.4.m4.4.4.1.1.1.3.2" xref="algorithm2.4.4.m4.4.4.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="algorithm2.4.4.m4.4.4.1.1.1.3.1" xref="algorithm2.4.4.m4.4.4.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.4.4.m4.4.4.1.1.1.3.3" xref="algorithm2.4.4.m4.4.4.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="algorithm2.4.4.m4.4.4.1.1.1.3.1a" xref="algorithm2.4.4.m4.4.4.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.4.4.m4.4.4.1.1.1.3.4" xref="algorithm2.4.4.m4.4.4.1.1.1.3.4.cmml">F</mi></mrow></msub><mo stretchy="false" id="algorithm2.4.4.m4.4.4.1.1.6" xref="algorithm2.4.4.m4.4.4.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.4.4.m4.4b"><apply id="algorithm2.4.4.m4.4.4.cmml" xref="algorithm2.4.4.m4.4.4"><eq id="algorithm2.4.4.m4.4.4.2.cmml" xref="algorithm2.4.4.m4.4.4.2"></eq><apply id="algorithm2.4.4.m4.4.4.3.cmml" xref="algorithm2.4.4.m4.4.4.3"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.4.4.3.1.cmml" xref="algorithm2.4.4.m4.4.4.3">superscript</csymbol><ci id="algorithm2.4.4.m4.4.4.3.2.cmml" xref="algorithm2.4.4.m4.4.4.3.2">𝐰</ci><ci id="algorithm2.4.4.m4.4.4.3.3.cmml" xref="algorithm2.4.4.m4.4.4.3.3">𝑔</ci></apply><set id="algorithm2.4.4.m4.4.4.1.2.cmml" xref="algorithm2.4.4.m4.4.4.1.1"><ci id="algorithm2.4.4.m4.1.1.cmml" xref="algorithm2.4.4.m4.1.1">𝐮</ci><ci id="algorithm2.4.4.m4.2.2.cmml" xref="algorithm2.4.4.m4.2.2">𝐩</ci><ci id="algorithm2.4.4.m4.3.3.cmml" xref="algorithm2.4.4.m4.3.3">𝛽</ci><apply id="algorithm2.4.4.m4.4.4.1.1.1.cmml" xref="algorithm2.4.4.m4.4.4.1.1.1"><csymbol cd="ambiguous" id="algorithm2.4.4.m4.4.4.1.1.1.1.cmml" xref="algorithm2.4.4.m4.4.4.1.1.1">subscript</csymbol><ci id="algorithm2.4.4.m4.4.4.1.1.1.2.cmml" xref="algorithm2.4.4.m4.4.4.1.1.1.2">𝐕</ci><apply id="algorithm2.4.4.m4.4.4.1.1.1.3.cmml" xref="algorithm2.4.4.m4.4.4.1.1.1.3"><times id="algorithm2.4.4.m4.4.4.1.1.1.3.1.cmml" xref="algorithm2.4.4.m4.4.4.1.1.1.3.1"></times><ci id="algorithm2.4.4.m4.4.4.1.1.1.3.2.cmml" xref="algorithm2.4.4.m4.4.4.1.1.1.3.2">𝐸</ci><ci id="algorithm2.4.4.m4.4.4.1.1.1.3.3.cmml" xref="algorithm2.4.4.m4.4.4.1.1.1.3.3">𝑇</ci><ci id="algorithm2.4.4.m4.4.4.1.1.1.3.4.cmml" xref="algorithm2.4.4.m4.4.4.1.1.1.3.4">𝐹</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.4.4.m4.4c">\mathbf{w}^{g}=\{\mathbf{u},\mathbf{p},\beta,\mathbf{V}_{ETF}\}</annotation></semantics></math>.
</div>
<div id="algorithm2.5.5" class="ltx_listingline">
<span id="algorithm2.5.5.1" class="ltx_text"><span id="algorithm2.5.5.1.1" class="ltx_text ltx_font_bold">Output:</span> </span>Personalized local models <math id="algorithm2.5.5.m1.1" class="ltx_Math" alttext="\{\mathbf{w}_{k}^{p}\}_{k=1}^{K}" display="inline"><semantics id="algorithm2.5.5.m1.1a"><msubsup id="algorithm2.5.5.m1.1.1" xref="algorithm2.5.5.m1.1.1.cmml"><mrow id="algorithm2.5.5.m1.1.1.1.1.1" xref="algorithm2.5.5.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm2.5.5.m1.1.1.1.1.1.2" xref="algorithm2.5.5.m1.1.1.1.1.2.cmml">{</mo><msubsup id="algorithm2.5.5.m1.1.1.1.1.1.1" xref="algorithm2.5.5.m1.1.1.1.1.1.1.cmml"><mi id="algorithm2.5.5.m1.1.1.1.1.1.1.2.2" xref="algorithm2.5.5.m1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="algorithm2.5.5.m1.1.1.1.1.1.1.2.3" xref="algorithm2.5.5.m1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="algorithm2.5.5.m1.1.1.1.1.1.1.3" xref="algorithm2.5.5.m1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo stretchy="false" id="algorithm2.5.5.m1.1.1.1.1.1.3" xref="algorithm2.5.5.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm2.5.5.m1.1.1.1.3" xref="algorithm2.5.5.m1.1.1.1.3.cmml"><mi id="algorithm2.5.5.m1.1.1.1.3.2" xref="algorithm2.5.5.m1.1.1.1.3.2.cmml">k</mi><mo id="algorithm2.5.5.m1.1.1.1.3.1" xref="algorithm2.5.5.m1.1.1.1.3.1.cmml">=</mo><mn id="algorithm2.5.5.m1.1.1.1.3.3" xref="algorithm2.5.5.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm2.5.5.m1.1.1.3" xref="algorithm2.5.5.m1.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm2.5.5.m1.1b"><apply id="algorithm2.5.5.m1.1.1.cmml" xref="algorithm2.5.5.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.5.5.m1.1.1.2.cmml" xref="algorithm2.5.5.m1.1.1">superscript</csymbol><apply id="algorithm2.5.5.m1.1.1.1.cmml" xref="algorithm2.5.5.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.5.5.m1.1.1.1.2.cmml" xref="algorithm2.5.5.m1.1.1">subscript</csymbol><set id="algorithm2.5.5.m1.1.1.1.1.2.cmml" xref="algorithm2.5.5.m1.1.1.1.1.1"><apply id="algorithm2.5.5.m1.1.1.1.1.1.1.cmml" xref="algorithm2.5.5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.5.5.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.5.5.m1.1.1.1.1.1.1">superscript</csymbol><apply id="algorithm2.5.5.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.5.5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.5.5.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm2.5.5.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.5.5.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.5.5.m1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="algorithm2.5.5.m1.1.1.1.1.1.1.2.3.cmml" xref="algorithm2.5.5.m1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="algorithm2.5.5.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.5.5.m1.1.1.1.1.1.1.3">𝑝</ci></apply></set><apply id="algorithm2.5.5.m1.1.1.1.3.cmml" xref="algorithm2.5.5.m1.1.1.1.3"><eq id="algorithm2.5.5.m1.1.1.1.3.1.cmml" xref="algorithm2.5.5.m1.1.1.1.3.1"></eq><ci id="algorithm2.5.5.m1.1.1.1.3.2.cmml" xref="algorithm2.5.5.m1.1.1.1.3.2">𝑘</ci><cn type="integer" id="algorithm2.5.5.m1.1.1.1.3.3.cmml" xref="algorithm2.5.5.m1.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm2.5.5.m1.1.1.3.cmml" xref="algorithm2.5.5.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.5.5.m1.1c">\{\mathbf{w}_{k}^{p}\}_{k=1}^{K}</annotation></semantics></math>.
</div>
<div id="algorithm2.6.6" class="ltx_listingline">
Assign the final global model <math id="algorithm2.6.6.m1.1" class="ltx_Math" alttext="\mathbf{w}^{g}" display="inline"><semantics id="algorithm2.6.6.m1.1a"><msup id="algorithm2.6.6.m1.1.1" xref="algorithm2.6.6.m1.1.1.cmml"><mi id="algorithm2.6.6.m1.1.1.2" xref="algorithm2.6.6.m1.1.1.2.cmml">𝐰</mi><mi id="algorithm2.6.6.m1.1.1.3" xref="algorithm2.6.6.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm2.6.6.m1.1b"><apply id="algorithm2.6.6.m1.1.1.cmml" xref="algorithm2.6.6.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.6.6.m1.1.1.1.cmml" xref="algorithm2.6.6.m1.1.1">superscript</csymbol><ci id="algorithm2.6.6.m1.1.1.2.cmml" xref="algorithm2.6.6.m1.1.1.2">𝐰</ci><ci id="algorithm2.6.6.m1.1.1.3.cmml" xref="algorithm2.6.6.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.6.6.m1.1c">\mathbf{w}^{g}</annotation></semantics></math> as clients’ initial local models.
</div>
<div id="algorithm2.22.23" class="ltx_listingline">
<span id="algorithm2.22.23.1" class="ltx_text ltx_font_italic">Finetune the feature extractor.</span> 
</div>
<div id="algorithm2.7.7" class="ltx_listingline">
<span id="algorithm2.7.7.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.7.7.1" class="ltx_emph ltx_font_italic"><span id="algorithm2.7.7.1.1" class="ltx_text ltx_font_upright">client</span> <math id="algorithm2.7.7.1.m1.3" class="ltx_Math" alttext="k=1,\dots,K" display="inline"><semantics id="algorithm2.7.7.1.m1.3a"><mrow id="algorithm2.7.7.1.m1.3.4" xref="algorithm2.7.7.1.m1.3.4.cmml"><mi id="algorithm2.7.7.1.m1.3.4.2" xref="algorithm2.7.7.1.m1.3.4.2.cmml">k</mi><mo id="algorithm2.7.7.1.m1.3.4.1" xref="algorithm2.7.7.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm2.7.7.1.m1.3.4.3.2" xref="algorithm2.7.7.1.m1.3.4.3.1.cmml"><mn id="algorithm2.7.7.1.m1.1.1" xref="algorithm2.7.7.1.m1.1.1.cmml">1</mn><mo id="algorithm2.7.7.1.m1.3.4.3.2.1" xref="algorithm2.7.7.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm2.7.7.1.m1.2.2" xref="algorithm2.7.7.1.m1.2.2.cmml">…</mi><mo id="algorithm2.7.7.1.m1.3.4.3.2.2" xref="algorithm2.7.7.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm2.7.7.1.m1.3.3" xref="algorithm2.7.7.1.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.7.7.1.m1.3b"><apply id="algorithm2.7.7.1.m1.3.4.cmml" xref="algorithm2.7.7.1.m1.3.4"><eq id="algorithm2.7.7.1.m1.3.4.1.cmml" xref="algorithm2.7.7.1.m1.3.4.1"></eq><ci id="algorithm2.7.7.1.m1.3.4.2.cmml" xref="algorithm2.7.7.1.m1.3.4.2">𝑘</ci><list id="algorithm2.7.7.1.m1.3.4.3.1.cmml" xref="algorithm2.7.7.1.m1.3.4.3.2"><cn type="integer" id="algorithm2.7.7.1.m1.1.1.cmml" xref="algorithm2.7.7.1.m1.1.1">1</cn><ci id="algorithm2.7.7.1.m1.2.2.cmml" xref="algorithm2.7.7.1.m1.2.2">…</ci><ci id="algorithm2.7.7.1.m1.3.3.cmml" xref="algorithm2.7.7.1.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.7.7.1.m1.3c">k=1,\dots,K</annotation></semantics></math> <span id="algorithm2.7.7.1.2" class="ltx_text ltx_font_bold">in parallel</span></em> <span id="algorithm2.7.7.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.8.8" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.8.8.m1.5" class="ltx_Math" alttext="\hat{\mathbf{w}}_{k}=\{\mathbf{u},\beta\},~{}\overline{\mathbf{w}}_{k}=\{\mathbf{p},\mathbf{V}_{ETF}\}" display="inline"><semantics id="algorithm2.8.8.m1.5a"><mrow id="algorithm2.8.8.m1.5.5.2" xref="algorithm2.8.8.m1.5.5.3.cmml"><mrow id="algorithm2.8.8.m1.4.4.1.1" xref="algorithm2.8.8.m1.4.4.1.1.cmml"><msub id="algorithm2.8.8.m1.4.4.1.1.2" xref="algorithm2.8.8.m1.4.4.1.1.2.cmml"><mover accent="true" id="algorithm2.8.8.m1.4.4.1.1.2.2" xref="algorithm2.8.8.m1.4.4.1.1.2.2.cmml"><mi id="algorithm2.8.8.m1.4.4.1.1.2.2.2" xref="algorithm2.8.8.m1.4.4.1.1.2.2.2.cmml">𝐰</mi><mo id="algorithm2.8.8.m1.4.4.1.1.2.2.1" xref="algorithm2.8.8.m1.4.4.1.1.2.2.1.cmml">^</mo></mover><mi id="algorithm2.8.8.m1.4.4.1.1.2.3" xref="algorithm2.8.8.m1.4.4.1.1.2.3.cmml">k</mi></msub><mo id="algorithm2.8.8.m1.4.4.1.1.1" xref="algorithm2.8.8.m1.4.4.1.1.1.cmml">=</mo><mrow id="algorithm2.8.8.m1.4.4.1.1.3.2" xref="algorithm2.8.8.m1.4.4.1.1.3.1.cmml"><mo stretchy="false" id="algorithm2.8.8.m1.4.4.1.1.3.2.1" xref="algorithm2.8.8.m1.4.4.1.1.3.1.cmml">{</mo><mi id="algorithm2.8.8.m1.1.1" xref="algorithm2.8.8.m1.1.1.cmml">𝐮</mi><mo id="algorithm2.8.8.m1.4.4.1.1.3.2.2" xref="algorithm2.8.8.m1.4.4.1.1.3.1.cmml">,</mo><mi id="algorithm2.8.8.m1.2.2" xref="algorithm2.8.8.m1.2.2.cmml">β</mi><mo stretchy="false" id="algorithm2.8.8.m1.4.4.1.1.3.2.3" xref="algorithm2.8.8.m1.4.4.1.1.3.1.cmml">}</mo></mrow></mrow><mo rspace="0.497em" id="algorithm2.8.8.m1.5.5.2.3" xref="algorithm2.8.8.m1.5.5.3a.cmml">,</mo><mrow id="algorithm2.8.8.m1.5.5.2.2" xref="algorithm2.8.8.m1.5.5.2.2.cmml"><msub id="algorithm2.8.8.m1.5.5.2.2.3" xref="algorithm2.8.8.m1.5.5.2.2.3.cmml"><mover accent="true" id="algorithm2.8.8.m1.5.5.2.2.3.2" xref="algorithm2.8.8.m1.5.5.2.2.3.2.cmml"><mi id="algorithm2.8.8.m1.5.5.2.2.3.2.2" xref="algorithm2.8.8.m1.5.5.2.2.3.2.2.cmml">𝐰</mi><mo id="algorithm2.8.8.m1.5.5.2.2.3.2.1" xref="algorithm2.8.8.m1.5.5.2.2.3.2.1.cmml">¯</mo></mover><mi id="algorithm2.8.8.m1.5.5.2.2.3.3" xref="algorithm2.8.8.m1.5.5.2.2.3.3.cmml">k</mi></msub><mo id="algorithm2.8.8.m1.5.5.2.2.2" xref="algorithm2.8.8.m1.5.5.2.2.2.cmml">=</mo><mrow id="algorithm2.8.8.m1.5.5.2.2.1.1" xref="algorithm2.8.8.m1.5.5.2.2.1.2.cmml"><mo stretchy="false" id="algorithm2.8.8.m1.5.5.2.2.1.1.2" xref="algorithm2.8.8.m1.5.5.2.2.1.2.cmml">{</mo><mi id="algorithm2.8.8.m1.3.3" xref="algorithm2.8.8.m1.3.3.cmml">𝐩</mi><mo id="algorithm2.8.8.m1.5.5.2.2.1.1.3" xref="algorithm2.8.8.m1.5.5.2.2.1.2.cmml">,</mo><msub id="algorithm2.8.8.m1.5.5.2.2.1.1.1" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.cmml"><mi id="algorithm2.8.8.m1.5.5.2.2.1.1.1.2" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.2.cmml">𝐕</mi><mrow id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.cmml"><mi id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.2" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.1" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.3" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.1a" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.4" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.4.cmml">F</mi></mrow></msub><mo stretchy="false" id="algorithm2.8.8.m1.5.5.2.2.1.1.4" xref="algorithm2.8.8.m1.5.5.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.8.8.m1.5b"><apply id="algorithm2.8.8.m1.5.5.3.cmml" xref="algorithm2.8.8.m1.5.5.2"><csymbol cd="ambiguous" id="algorithm2.8.8.m1.5.5.3a.cmml" xref="algorithm2.8.8.m1.5.5.2.3">formulae-sequence</csymbol><apply id="algorithm2.8.8.m1.4.4.1.1.cmml" xref="algorithm2.8.8.m1.4.4.1.1"><eq id="algorithm2.8.8.m1.4.4.1.1.1.cmml" xref="algorithm2.8.8.m1.4.4.1.1.1"></eq><apply id="algorithm2.8.8.m1.4.4.1.1.2.cmml" xref="algorithm2.8.8.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="algorithm2.8.8.m1.4.4.1.1.2.1.cmml" xref="algorithm2.8.8.m1.4.4.1.1.2">subscript</csymbol><apply id="algorithm2.8.8.m1.4.4.1.1.2.2.cmml" xref="algorithm2.8.8.m1.4.4.1.1.2.2"><ci id="algorithm2.8.8.m1.4.4.1.1.2.2.1.cmml" xref="algorithm2.8.8.m1.4.4.1.1.2.2.1">^</ci><ci id="algorithm2.8.8.m1.4.4.1.1.2.2.2.cmml" xref="algorithm2.8.8.m1.4.4.1.1.2.2.2">𝐰</ci></apply><ci id="algorithm2.8.8.m1.4.4.1.1.2.3.cmml" xref="algorithm2.8.8.m1.4.4.1.1.2.3">𝑘</ci></apply><set id="algorithm2.8.8.m1.4.4.1.1.3.1.cmml" xref="algorithm2.8.8.m1.4.4.1.1.3.2"><ci id="algorithm2.8.8.m1.1.1.cmml" xref="algorithm2.8.8.m1.1.1">𝐮</ci><ci id="algorithm2.8.8.m1.2.2.cmml" xref="algorithm2.8.8.m1.2.2">𝛽</ci></set></apply><apply id="algorithm2.8.8.m1.5.5.2.2.cmml" xref="algorithm2.8.8.m1.5.5.2.2"><eq id="algorithm2.8.8.m1.5.5.2.2.2.cmml" xref="algorithm2.8.8.m1.5.5.2.2.2"></eq><apply id="algorithm2.8.8.m1.5.5.2.2.3.cmml" xref="algorithm2.8.8.m1.5.5.2.2.3"><csymbol cd="ambiguous" id="algorithm2.8.8.m1.5.5.2.2.3.1.cmml" xref="algorithm2.8.8.m1.5.5.2.2.3">subscript</csymbol><apply id="algorithm2.8.8.m1.5.5.2.2.3.2.cmml" xref="algorithm2.8.8.m1.5.5.2.2.3.2"><ci id="algorithm2.8.8.m1.5.5.2.2.3.2.1.cmml" xref="algorithm2.8.8.m1.5.5.2.2.3.2.1">¯</ci><ci id="algorithm2.8.8.m1.5.5.2.2.3.2.2.cmml" xref="algorithm2.8.8.m1.5.5.2.2.3.2.2">𝐰</ci></apply><ci id="algorithm2.8.8.m1.5.5.2.2.3.3.cmml" xref="algorithm2.8.8.m1.5.5.2.2.3.3">𝑘</ci></apply><set id="algorithm2.8.8.m1.5.5.2.2.1.2.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1"><ci id="algorithm2.8.8.m1.3.3.cmml" xref="algorithm2.8.8.m1.3.3">𝐩</ci><apply id="algorithm2.8.8.m1.5.5.2.2.1.1.1.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm2.8.8.m1.5.5.2.2.1.1.1.1.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1">subscript</csymbol><ci id="algorithm2.8.8.m1.5.5.2.2.1.1.1.2.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.2">𝐕</ci><apply id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3"><times id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.1.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.1"></times><ci id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.2.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.2">𝐸</ci><ci id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.3.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.3">𝑇</ci><ci id="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.4.cmml" xref="algorithm2.8.8.m1.5.5.2.2.1.1.1.3.4">𝐹</ci></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.8.8.m1.5c">\hat{\mathbf{w}}_{k}=\{\mathbf{u},\beta\},~{}\overline{\mathbf{w}}_{k}=\{\mathbf{p},\mathbf{V}_{ETF}\}</annotation></semantics></math>; 
</div>
<div id="algorithm2.9.9" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.9.9.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.9.9.1" class="ltx_emph ltx_font_italic"><span id="algorithm2.9.9.1.1" class="ltx_text ltx_font_upright">local epoch</span> <math id="algorithm2.9.9.1.m1.3" class="ltx_Math" alttext="e=1,\dots,E" display="inline"><semantics id="algorithm2.9.9.1.m1.3a"><mrow id="algorithm2.9.9.1.m1.3.4" xref="algorithm2.9.9.1.m1.3.4.cmml"><mi id="algorithm2.9.9.1.m1.3.4.2" xref="algorithm2.9.9.1.m1.3.4.2.cmml">e</mi><mo id="algorithm2.9.9.1.m1.3.4.1" xref="algorithm2.9.9.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm2.9.9.1.m1.3.4.3.2" xref="algorithm2.9.9.1.m1.3.4.3.1.cmml"><mn id="algorithm2.9.9.1.m1.1.1" xref="algorithm2.9.9.1.m1.1.1.cmml">1</mn><mo id="algorithm2.9.9.1.m1.3.4.3.2.1" xref="algorithm2.9.9.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm2.9.9.1.m1.2.2" xref="algorithm2.9.9.1.m1.2.2.cmml">…</mi><mo id="algorithm2.9.9.1.m1.3.4.3.2.2" xref="algorithm2.9.9.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm2.9.9.1.m1.3.3" xref="algorithm2.9.9.1.m1.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.9.9.1.m1.3b"><apply id="algorithm2.9.9.1.m1.3.4.cmml" xref="algorithm2.9.9.1.m1.3.4"><eq id="algorithm2.9.9.1.m1.3.4.1.cmml" xref="algorithm2.9.9.1.m1.3.4.1"></eq><ci id="algorithm2.9.9.1.m1.3.4.2.cmml" xref="algorithm2.9.9.1.m1.3.4.2">𝑒</ci><list id="algorithm2.9.9.1.m1.3.4.3.1.cmml" xref="algorithm2.9.9.1.m1.3.4.3.2"><cn type="integer" id="algorithm2.9.9.1.m1.1.1.cmml" xref="algorithm2.9.9.1.m1.1.1">1</cn><ci id="algorithm2.9.9.1.m1.2.2.cmml" xref="algorithm2.9.9.1.m1.2.2">…</ci><ci id="algorithm2.9.9.1.m1.3.3.cmml" xref="algorithm2.9.9.1.m1.3.3">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.9.9.1.m1.3c">e=1,\dots,E</annotation></semantics></math></em> <span id="algorithm2.9.9.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.11.11" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Obtain <math id="algorithm2.10.10.m1.1" class="ltx_Math" alttext="\mathcal{L}_{k}^{p}" display="inline"><semantics id="algorithm2.10.10.m1.1a"><msubsup id="algorithm2.10.10.m1.1.1" xref="algorithm2.10.10.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.10.10.m1.1.1.2.2" xref="algorithm2.10.10.m1.1.1.2.2.cmml">ℒ</mi><mi id="algorithm2.10.10.m1.1.1.2.3" xref="algorithm2.10.10.m1.1.1.2.3.cmml">k</mi><mi id="algorithm2.10.10.m1.1.1.3" xref="algorithm2.10.10.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm2.10.10.m1.1b"><apply id="algorithm2.10.10.m1.1.1.cmml" xref="algorithm2.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.10.10.m1.1.1.1.cmml" xref="algorithm2.10.10.m1.1.1">superscript</csymbol><apply id="algorithm2.10.10.m1.1.1.2.cmml" xref="algorithm2.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.10.10.m1.1.1.2.1.cmml" xref="algorithm2.10.10.m1.1.1">subscript</csymbol><ci id="algorithm2.10.10.m1.1.1.2.2.cmml" xref="algorithm2.10.10.m1.1.1.2.2">ℒ</ci><ci id="algorithm2.10.10.m1.1.1.2.3.cmml" xref="algorithm2.10.10.m1.1.1.2.3">𝑘</ci></apply><ci id="algorithm2.10.10.m1.1.1.3.cmml" xref="algorithm2.10.10.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.10.10.m1.1c">\mathcal{L}_{k}^{p}</annotation></semantics></math> by Eq. (9, 10, 11);
<math id="algorithm2.11.11.m2.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{k}\leftarrow\hat{\mathbf{w}}_{k}-\eta\nabla\mathcal{L}_{k}^{p}(\hat{\mathbf{w}}_{k})" display="inline"><semantics id="algorithm2.11.11.m2.1a"><mrow id="algorithm2.11.11.m2.1.1" xref="algorithm2.11.11.m2.1.1.cmml"><msub id="algorithm2.11.11.m2.1.1.3" xref="algorithm2.11.11.m2.1.1.3.cmml"><mover accent="true" id="algorithm2.11.11.m2.1.1.3.2" xref="algorithm2.11.11.m2.1.1.3.2.cmml"><mi id="algorithm2.11.11.m2.1.1.3.2.2" xref="algorithm2.11.11.m2.1.1.3.2.2.cmml">𝐰</mi><mo id="algorithm2.11.11.m2.1.1.3.2.1" xref="algorithm2.11.11.m2.1.1.3.2.1.cmml">^</mo></mover><mi id="algorithm2.11.11.m2.1.1.3.3" xref="algorithm2.11.11.m2.1.1.3.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm2.11.11.m2.1.1.2" xref="algorithm2.11.11.m2.1.1.2.cmml">←</mo><mrow id="algorithm2.11.11.m2.1.1.1" xref="algorithm2.11.11.m2.1.1.1.cmml"><msub id="algorithm2.11.11.m2.1.1.1.3" xref="algorithm2.11.11.m2.1.1.1.3.cmml"><mover accent="true" id="algorithm2.11.11.m2.1.1.1.3.2" xref="algorithm2.11.11.m2.1.1.1.3.2.cmml"><mi id="algorithm2.11.11.m2.1.1.1.3.2.2" xref="algorithm2.11.11.m2.1.1.1.3.2.2.cmml">𝐰</mi><mo id="algorithm2.11.11.m2.1.1.1.3.2.1" xref="algorithm2.11.11.m2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="algorithm2.11.11.m2.1.1.1.3.3" xref="algorithm2.11.11.m2.1.1.1.3.3.cmml">k</mi></msub><mo id="algorithm2.11.11.m2.1.1.1.2" xref="algorithm2.11.11.m2.1.1.1.2.cmml">−</mo><mrow id="algorithm2.11.11.m2.1.1.1.1" xref="algorithm2.11.11.m2.1.1.1.1.cmml"><mi id="algorithm2.11.11.m2.1.1.1.1.3" xref="algorithm2.11.11.m2.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm2.11.11.m2.1.1.1.1.2" xref="algorithm2.11.11.m2.1.1.1.1.2.cmml">​</mo><mrow id="algorithm2.11.11.m2.1.1.1.1.4" xref="algorithm2.11.11.m2.1.1.1.1.4.cmml"><mo rspace="0.167em" id="algorithm2.11.11.m2.1.1.1.1.4.1" xref="algorithm2.11.11.m2.1.1.1.1.4.1.cmml">∇</mo><msubsup id="algorithm2.11.11.m2.1.1.1.1.4.2" xref="algorithm2.11.11.m2.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.11.11.m2.1.1.1.1.4.2.2.2" xref="algorithm2.11.11.m2.1.1.1.1.4.2.2.2.cmml">ℒ</mi><mi id="algorithm2.11.11.m2.1.1.1.1.4.2.2.3" xref="algorithm2.11.11.m2.1.1.1.1.4.2.2.3.cmml">k</mi><mi id="algorithm2.11.11.m2.1.1.1.1.4.2.3" xref="algorithm2.11.11.m2.1.1.1.1.4.2.3.cmml">p</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="algorithm2.11.11.m2.1.1.1.1.2a" xref="algorithm2.11.11.m2.1.1.1.1.2.cmml">​</mo><mrow id="algorithm2.11.11.m2.1.1.1.1.1.1" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm2.11.11.m2.1.1.1.1.1.1.2" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm2.11.11.m2.1.1.1.1.1.1.1" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="algorithm2.11.11.m2.1.1.1.1.1.1.1.2" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.cmml"><mi id="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.2" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mo id="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.1" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm2.11.11.m2.1.1.1.1.1.1.1.3" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm2.11.11.m2.1.1.1.1.1.1.3" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.11.11.m2.1b"><apply id="algorithm2.11.11.m2.1.1.cmml" xref="algorithm2.11.11.m2.1.1"><ci id="algorithm2.11.11.m2.1.1.2.cmml" xref="algorithm2.11.11.m2.1.1.2">←</ci><apply id="algorithm2.11.11.m2.1.1.3.cmml" xref="algorithm2.11.11.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm2.11.11.m2.1.1.3.1.cmml" xref="algorithm2.11.11.m2.1.1.3">subscript</csymbol><apply id="algorithm2.11.11.m2.1.1.3.2.cmml" xref="algorithm2.11.11.m2.1.1.3.2"><ci id="algorithm2.11.11.m2.1.1.3.2.1.cmml" xref="algorithm2.11.11.m2.1.1.3.2.1">^</ci><ci id="algorithm2.11.11.m2.1.1.3.2.2.cmml" xref="algorithm2.11.11.m2.1.1.3.2.2">𝐰</ci></apply><ci id="algorithm2.11.11.m2.1.1.3.3.cmml" xref="algorithm2.11.11.m2.1.1.3.3">𝑘</ci></apply><apply id="algorithm2.11.11.m2.1.1.1.cmml" xref="algorithm2.11.11.m2.1.1.1"><minus id="algorithm2.11.11.m2.1.1.1.2.cmml" xref="algorithm2.11.11.m2.1.1.1.2"></minus><apply id="algorithm2.11.11.m2.1.1.1.3.cmml" xref="algorithm2.11.11.m2.1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.11.11.m2.1.1.1.3.1.cmml" xref="algorithm2.11.11.m2.1.1.1.3">subscript</csymbol><apply id="algorithm2.11.11.m2.1.1.1.3.2.cmml" xref="algorithm2.11.11.m2.1.1.1.3.2"><ci id="algorithm2.11.11.m2.1.1.1.3.2.1.cmml" xref="algorithm2.11.11.m2.1.1.1.3.2.1">^</ci><ci id="algorithm2.11.11.m2.1.1.1.3.2.2.cmml" xref="algorithm2.11.11.m2.1.1.1.3.2.2">𝐰</ci></apply><ci id="algorithm2.11.11.m2.1.1.1.3.3.cmml" xref="algorithm2.11.11.m2.1.1.1.3.3">𝑘</ci></apply><apply id="algorithm2.11.11.m2.1.1.1.1.cmml" xref="algorithm2.11.11.m2.1.1.1.1"><times id="algorithm2.11.11.m2.1.1.1.1.2.cmml" xref="algorithm2.11.11.m2.1.1.1.1.2"></times><ci id="algorithm2.11.11.m2.1.1.1.1.3.cmml" xref="algorithm2.11.11.m2.1.1.1.1.3">𝜂</ci><apply id="algorithm2.11.11.m2.1.1.1.1.4.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4"><ci id="algorithm2.11.11.m2.1.1.1.1.4.1.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4.1">∇</ci><apply id="algorithm2.11.11.m2.1.1.1.1.4.2.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm2.11.11.m2.1.1.1.1.4.2.1.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4.2">superscript</csymbol><apply id="algorithm2.11.11.m2.1.1.1.1.4.2.2.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm2.11.11.m2.1.1.1.1.4.2.2.1.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4.2">subscript</csymbol><ci id="algorithm2.11.11.m2.1.1.1.1.4.2.2.2.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4.2.2.2">ℒ</ci><ci id="algorithm2.11.11.m2.1.1.1.1.4.2.2.3.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4.2.2.3">𝑘</ci></apply><ci id="algorithm2.11.11.m2.1.1.1.1.4.2.3.cmml" xref="algorithm2.11.11.m2.1.1.1.1.4.2.3">𝑝</ci></apply></apply><apply id="algorithm2.11.11.m2.1.1.1.1.1.1.1.cmml" xref="algorithm2.11.11.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.11.11.m2.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.11.11.m2.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.2"><ci id="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.1">^</ci><ci id="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.2.2">𝐰</ci></apply><ci id="algorithm2.11.11.m2.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.11.11.m2.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.11.11.m2.1c">\hat{\mathbf{w}}_{k}\leftarrow\hat{\mathbf{w}}_{k}-\eta\nabla\mathcal{L}_{k}^{p}(\hat{\mathbf{w}}_{k})</annotation></semantics></math>;

</div>
<div id="algorithm2.22.24" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.22.25" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm2.22.26" class="ltx_listingline"> end for
</div>
<div id="algorithm2.12.12" class="ltx_listingline">
<span id="algorithm2.12.12.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.12.12.1" class="ltx_emph ltx_font_italic"><math id="algorithm2.12.12.1.m1.3" class="ltx_Math" alttext="t=1,\dots,T_{p}" display="inline"><semantics id="algorithm2.12.12.1.m1.3a"><mrow id="algorithm2.12.12.1.m1.3.3" xref="algorithm2.12.12.1.m1.3.3.cmml"><mi id="algorithm2.12.12.1.m1.3.3.3" xref="algorithm2.12.12.1.m1.3.3.3.cmml">t</mi><mo id="algorithm2.12.12.1.m1.3.3.2" xref="algorithm2.12.12.1.m1.3.3.2.cmml">=</mo><mrow id="algorithm2.12.12.1.m1.3.3.1.1" xref="algorithm2.12.12.1.m1.3.3.1.2.cmml"><mn id="algorithm2.12.12.1.m1.1.1" xref="algorithm2.12.12.1.m1.1.1.cmml">1</mn><mo id="algorithm2.12.12.1.m1.3.3.1.1.2" xref="algorithm2.12.12.1.m1.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="algorithm2.12.12.1.m1.2.2" xref="algorithm2.12.12.1.m1.2.2.cmml">…</mi><mo id="algorithm2.12.12.1.m1.3.3.1.1.3" xref="algorithm2.12.12.1.m1.3.3.1.2.cmml">,</mo><msub id="algorithm2.12.12.1.m1.3.3.1.1.1" xref="algorithm2.12.12.1.m1.3.3.1.1.1.cmml"><mi id="algorithm2.12.12.1.m1.3.3.1.1.1.2" xref="algorithm2.12.12.1.m1.3.3.1.1.1.2.cmml">T</mi><mi id="algorithm2.12.12.1.m1.3.3.1.1.1.3" xref="algorithm2.12.12.1.m1.3.3.1.1.1.3.cmml">p</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.12.12.1.m1.3b"><apply id="algorithm2.12.12.1.m1.3.3.cmml" xref="algorithm2.12.12.1.m1.3.3"><eq id="algorithm2.12.12.1.m1.3.3.2.cmml" xref="algorithm2.12.12.1.m1.3.3.2"></eq><ci id="algorithm2.12.12.1.m1.3.3.3.cmml" xref="algorithm2.12.12.1.m1.3.3.3">𝑡</ci><list id="algorithm2.12.12.1.m1.3.3.1.2.cmml" xref="algorithm2.12.12.1.m1.3.3.1.1"><cn type="integer" id="algorithm2.12.12.1.m1.1.1.cmml" xref="algorithm2.12.12.1.m1.1.1">1</cn><ci id="algorithm2.12.12.1.m1.2.2.cmml" xref="algorithm2.12.12.1.m1.2.2">…</ci><apply id="algorithm2.12.12.1.m1.3.3.1.1.1.cmml" xref="algorithm2.12.12.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="algorithm2.12.12.1.m1.3.3.1.1.1.1.cmml" xref="algorithm2.12.12.1.m1.3.3.1.1.1">subscript</csymbol><ci id="algorithm2.12.12.1.m1.3.3.1.1.1.2.cmml" xref="algorithm2.12.12.1.m1.3.3.1.1.1.2">𝑇</ci><ci id="algorithm2.12.12.1.m1.3.3.1.1.1.3.cmml" xref="algorithm2.12.12.1.m1.3.3.1.1.1.3">𝑝</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.12.12.1.m1.3c">t=1,\dots,T_{p}</annotation></semantics></math></em> <span id="algorithm2.12.12.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.13.13" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.13.13.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.13.13.1" class="ltx_emph ltx_font_italic"><span id="algorithm2.13.13.1.1" class="ltx_text ltx_font_upright">client</span> <math id="algorithm2.13.13.1.m1.3" class="ltx_Math" alttext="k=1,\dots,K" display="inline"><semantics id="algorithm2.13.13.1.m1.3a"><mrow id="algorithm2.13.13.1.m1.3.4" xref="algorithm2.13.13.1.m1.3.4.cmml"><mi id="algorithm2.13.13.1.m1.3.4.2" xref="algorithm2.13.13.1.m1.3.4.2.cmml">k</mi><mo id="algorithm2.13.13.1.m1.3.4.1" xref="algorithm2.13.13.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm2.13.13.1.m1.3.4.3.2" xref="algorithm2.13.13.1.m1.3.4.3.1.cmml"><mn id="algorithm2.13.13.1.m1.1.1" xref="algorithm2.13.13.1.m1.1.1.cmml">1</mn><mo id="algorithm2.13.13.1.m1.3.4.3.2.1" xref="algorithm2.13.13.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm2.13.13.1.m1.2.2" xref="algorithm2.13.13.1.m1.2.2.cmml">…</mi><mo id="algorithm2.13.13.1.m1.3.4.3.2.2" xref="algorithm2.13.13.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm2.13.13.1.m1.3.3" xref="algorithm2.13.13.1.m1.3.3.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.13.13.1.m1.3b"><apply id="algorithm2.13.13.1.m1.3.4.cmml" xref="algorithm2.13.13.1.m1.3.4"><eq id="algorithm2.13.13.1.m1.3.4.1.cmml" xref="algorithm2.13.13.1.m1.3.4.1"></eq><ci id="algorithm2.13.13.1.m1.3.4.2.cmml" xref="algorithm2.13.13.1.m1.3.4.2">𝑘</ci><list id="algorithm2.13.13.1.m1.3.4.3.1.cmml" xref="algorithm2.13.13.1.m1.3.4.3.2"><cn type="integer" id="algorithm2.13.13.1.m1.1.1.cmml" xref="algorithm2.13.13.1.m1.1.1">1</cn><ci id="algorithm2.13.13.1.m1.2.2.cmml" xref="algorithm2.13.13.1.m1.2.2">…</ci><ci id="algorithm2.13.13.1.m1.3.3.cmml" xref="algorithm2.13.13.1.m1.3.3">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.13.13.1.m1.3c">k=1,\dots,K</annotation></semantics></math> <span id="algorithm2.13.13.1.2" class="ltx_text ltx_font_bold">in parallel</span></em> <span id="algorithm2.13.13.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.22.27" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.22.27.1" class="ltx_text ltx_font_italic">Finetune the ETF classifier.</span> 
</div>
<div id="algorithm2.14.14" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.14.14.m1.5" class="ltx_Math" alttext="\hat{\mathbf{w}}_{k}=\{\mathbf{V}_{ETF},\beta\},~{}\overline{\mathbf{w}}_{k}=\{\mathbf{p},\mathbf{u}\}" display="inline"><semantics id="algorithm2.14.14.m1.5a"><mrow id="algorithm2.14.14.m1.5.5.2" xref="algorithm2.14.14.m1.5.5.3.cmml"><mrow id="algorithm2.14.14.m1.4.4.1.1" xref="algorithm2.14.14.m1.4.4.1.1.cmml"><msub id="algorithm2.14.14.m1.4.4.1.1.3" xref="algorithm2.14.14.m1.4.4.1.1.3.cmml"><mover accent="true" id="algorithm2.14.14.m1.4.4.1.1.3.2" xref="algorithm2.14.14.m1.4.4.1.1.3.2.cmml"><mi id="algorithm2.14.14.m1.4.4.1.1.3.2.2" xref="algorithm2.14.14.m1.4.4.1.1.3.2.2.cmml">𝐰</mi><mo id="algorithm2.14.14.m1.4.4.1.1.3.2.1" xref="algorithm2.14.14.m1.4.4.1.1.3.2.1.cmml">^</mo></mover><mi id="algorithm2.14.14.m1.4.4.1.1.3.3" xref="algorithm2.14.14.m1.4.4.1.1.3.3.cmml">k</mi></msub><mo id="algorithm2.14.14.m1.4.4.1.1.2" xref="algorithm2.14.14.m1.4.4.1.1.2.cmml">=</mo><mrow id="algorithm2.14.14.m1.4.4.1.1.1.1" xref="algorithm2.14.14.m1.4.4.1.1.1.2.cmml"><mo stretchy="false" id="algorithm2.14.14.m1.4.4.1.1.1.1.2" xref="algorithm2.14.14.m1.4.4.1.1.1.2.cmml">{</mo><msub id="algorithm2.14.14.m1.4.4.1.1.1.1.1" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.cmml"><mi id="algorithm2.14.14.m1.4.4.1.1.1.1.1.2" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.2.cmml">𝐕</mi><mrow id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.cmml"><mi id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.2" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.1" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.3" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.1a" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.4" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.4.cmml">F</mi></mrow></msub><mo id="algorithm2.14.14.m1.4.4.1.1.1.1.3" xref="algorithm2.14.14.m1.4.4.1.1.1.2.cmml">,</mo><mi id="algorithm2.14.14.m1.1.1" xref="algorithm2.14.14.m1.1.1.cmml">β</mi><mo stretchy="false" id="algorithm2.14.14.m1.4.4.1.1.1.1.4" xref="algorithm2.14.14.m1.4.4.1.1.1.2.cmml">}</mo></mrow></mrow><mo rspace="0.497em" id="algorithm2.14.14.m1.5.5.2.3" xref="algorithm2.14.14.m1.5.5.3a.cmml">,</mo><mrow id="algorithm2.14.14.m1.5.5.2.2" xref="algorithm2.14.14.m1.5.5.2.2.cmml"><msub id="algorithm2.14.14.m1.5.5.2.2.2" xref="algorithm2.14.14.m1.5.5.2.2.2.cmml"><mover accent="true" id="algorithm2.14.14.m1.5.5.2.2.2.2" xref="algorithm2.14.14.m1.5.5.2.2.2.2.cmml"><mi id="algorithm2.14.14.m1.5.5.2.2.2.2.2" xref="algorithm2.14.14.m1.5.5.2.2.2.2.2.cmml">𝐰</mi><mo id="algorithm2.14.14.m1.5.5.2.2.2.2.1" xref="algorithm2.14.14.m1.5.5.2.2.2.2.1.cmml">¯</mo></mover><mi id="algorithm2.14.14.m1.5.5.2.2.2.3" xref="algorithm2.14.14.m1.5.5.2.2.2.3.cmml">k</mi></msub><mo id="algorithm2.14.14.m1.5.5.2.2.1" xref="algorithm2.14.14.m1.5.5.2.2.1.cmml">=</mo><mrow id="algorithm2.14.14.m1.5.5.2.2.3.2" xref="algorithm2.14.14.m1.5.5.2.2.3.1.cmml"><mo stretchy="false" id="algorithm2.14.14.m1.5.5.2.2.3.2.1" xref="algorithm2.14.14.m1.5.5.2.2.3.1.cmml">{</mo><mi id="algorithm2.14.14.m1.2.2" xref="algorithm2.14.14.m1.2.2.cmml">𝐩</mi><mo id="algorithm2.14.14.m1.5.5.2.2.3.2.2" xref="algorithm2.14.14.m1.5.5.2.2.3.1.cmml">,</mo><mi id="algorithm2.14.14.m1.3.3" xref="algorithm2.14.14.m1.3.3.cmml">𝐮</mi><mo stretchy="false" id="algorithm2.14.14.m1.5.5.2.2.3.2.3" xref="algorithm2.14.14.m1.5.5.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.14.14.m1.5b"><apply id="algorithm2.14.14.m1.5.5.3.cmml" xref="algorithm2.14.14.m1.5.5.2"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.5.5.3a.cmml" xref="algorithm2.14.14.m1.5.5.2.3">formulae-sequence</csymbol><apply id="algorithm2.14.14.m1.4.4.1.1.cmml" xref="algorithm2.14.14.m1.4.4.1.1"><eq id="algorithm2.14.14.m1.4.4.1.1.2.cmml" xref="algorithm2.14.14.m1.4.4.1.1.2"></eq><apply id="algorithm2.14.14.m1.4.4.1.1.3.cmml" xref="algorithm2.14.14.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.4.4.1.1.3.1.cmml" xref="algorithm2.14.14.m1.4.4.1.1.3">subscript</csymbol><apply id="algorithm2.14.14.m1.4.4.1.1.3.2.cmml" xref="algorithm2.14.14.m1.4.4.1.1.3.2"><ci id="algorithm2.14.14.m1.4.4.1.1.3.2.1.cmml" xref="algorithm2.14.14.m1.4.4.1.1.3.2.1">^</ci><ci id="algorithm2.14.14.m1.4.4.1.1.3.2.2.cmml" xref="algorithm2.14.14.m1.4.4.1.1.3.2.2">𝐰</ci></apply><ci id="algorithm2.14.14.m1.4.4.1.1.3.3.cmml" xref="algorithm2.14.14.m1.4.4.1.1.3.3">𝑘</ci></apply><set id="algorithm2.14.14.m1.4.4.1.1.1.2.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1"><apply id="algorithm2.14.14.m1.4.4.1.1.1.1.1.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.4.4.1.1.1.1.1.1.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="algorithm2.14.14.m1.4.4.1.1.1.1.1.2.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.2">𝐕</ci><apply id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3"><times id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.1.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.1"></times><ci id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.2.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.2">𝐸</ci><ci id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.3.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.3">𝑇</ci><ci id="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.4.cmml" xref="algorithm2.14.14.m1.4.4.1.1.1.1.1.3.4">𝐹</ci></apply></apply><ci id="algorithm2.14.14.m1.1.1.cmml" xref="algorithm2.14.14.m1.1.1">𝛽</ci></set></apply><apply id="algorithm2.14.14.m1.5.5.2.2.cmml" xref="algorithm2.14.14.m1.5.5.2.2"><eq id="algorithm2.14.14.m1.5.5.2.2.1.cmml" xref="algorithm2.14.14.m1.5.5.2.2.1"></eq><apply id="algorithm2.14.14.m1.5.5.2.2.2.cmml" xref="algorithm2.14.14.m1.5.5.2.2.2"><csymbol cd="ambiguous" id="algorithm2.14.14.m1.5.5.2.2.2.1.cmml" xref="algorithm2.14.14.m1.5.5.2.2.2">subscript</csymbol><apply id="algorithm2.14.14.m1.5.5.2.2.2.2.cmml" xref="algorithm2.14.14.m1.5.5.2.2.2.2"><ci id="algorithm2.14.14.m1.5.5.2.2.2.2.1.cmml" xref="algorithm2.14.14.m1.5.5.2.2.2.2.1">¯</ci><ci id="algorithm2.14.14.m1.5.5.2.2.2.2.2.cmml" xref="algorithm2.14.14.m1.5.5.2.2.2.2.2">𝐰</ci></apply><ci id="algorithm2.14.14.m1.5.5.2.2.2.3.cmml" xref="algorithm2.14.14.m1.5.5.2.2.2.3">𝑘</ci></apply><set id="algorithm2.14.14.m1.5.5.2.2.3.1.cmml" xref="algorithm2.14.14.m1.5.5.2.2.3.2"><ci id="algorithm2.14.14.m1.2.2.cmml" xref="algorithm2.14.14.m1.2.2">𝐩</ci><ci id="algorithm2.14.14.m1.3.3.cmml" xref="algorithm2.14.14.m1.3.3">𝐮</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.14.14.m1.5c">\hat{\mathbf{w}}_{k}=\{\mathbf{V}_{ETF},\beta\},~{}\overline{\mathbf{w}}_{k}=\{\mathbf{p},\mathbf{u}\}</annotation></semantics></math>; 
</div>
<div id="algorithm2.15.15" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.15.15.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.15.15.1" class="ltx_emph ltx_font_italic"><span id="algorithm2.15.15.1.1" class="ltx_text ltx_font_upright">local epoch</span> <math id="algorithm2.15.15.1.m1.3" class="ltx_Math" alttext="e=1,\dots,E" display="inline"><semantics id="algorithm2.15.15.1.m1.3a"><mrow id="algorithm2.15.15.1.m1.3.4" xref="algorithm2.15.15.1.m1.3.4.cmml"><mi id="algorithm2.15.15.1.m1.3.4.2" xref="algorithm2.15.15.1.m1.3.4.2.cmml">e</mi><mo id="algorithm2.15.15.1.m1.3.4.1" xref="algorithm2.15.15.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm2.15.15.1.m1.3.4.3.2" xref="algorithm2.15.15.1.m1.3.4.3.1.cmml"><mn id="algorithm2.15.15.1.m1.1.1" xref="algorithm2.15.15.1.m1.1.1.cmml">1</mn><mo id="algorithm2.15.15.1.m1.3.4.3.2.1" xref="algorithm2.15.15.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm2.15.15.1.m1.2.2" xref="algorithm2.15.15.1.m1.2.2.cmml">…</mi><mo id="algorithm2.15.15.1.m1.3.4.3.2.2" xref="algorithm2.15.15.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm2.15.15.1.m1.3.3" xref="algorithm2.15.15.1.m1.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.15.15.1.m1.3b"><apply id="algorithm2.15.15.1.m1.3.4.cmml" xref="algorithm2.15.15.1.m1.3.4"><eq id="algorithm2.15.15.1.m1.3.4.1.cmml" xref="algorithm2.15.15.1.m1.3.4.1"></eq><ci id="algorithm2.15.15.1.m1.3.4.2.cmml" xref="algorithm2.15.15.1.m1.3.4.2">𝑒</ci><list id="algorithm2.15.15.1.m1.3.4.3.1.cmml" xref="algorithm2.15.15.1.m1.3.4.3.2"><cn type="integer" id="algorithm2.15.15.1.m1.1.1.cmml" xref="algorithm2.15.15.1.m1.1.1">1</cn><ci id="algorithm2.15.15.1.m1.2.2.cmml" xref="algorithm2.15.15.1.m1.2.2">…</ci><ci id="algorithm2.15.15.1.m1.3.3.cmml" xref="algorithm2.15.15.1.m1.3.3">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.15.15.1.m1.3c">e=1,\dots,E</annotation></semantics></math></em> <span id="algorithm2.15.15.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.17.17" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Obtain <math id="algorithm2.16.16.m1.1" class="ltx_Math" alttext="\mathcal{L}_{k}^{p}" display="inline"><semantics id="algorithm2.16.16.m1.1a"><msubsup id="algorithm2.16.16.m1.1.1" xref="algorithm2.16.16.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.16.16.m1.1.1.2.2" xref="algorithm2.16.16.m1.1.1.2.2.cmml">ℒ</mi><mi id="algorithm2.16.16.m1.1.1.2.3" xref="algorithm2.16.16.m1.1.1.2.3.cmml">k</mi><mi id="algorithm2.16.16.m1.1.1.3" xref="algorithm2.16.16.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm2.16.16.m1.1b"><apply id="algorithm2.16.16.m1.1.1.cmml" xref="algorithm2.16.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.16.16.m1.1.1.1.cmml" xref="algorithm2.16.16.m1.1.1">superscript</csymbol><apply id="algorithm2.16.16.m1.1.1.2.cmml" xref="algorithm2.16.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.16.16.m1.1.1.2.1.cmml" xref="algorithm2.16.16.m1.1.1">subscript</csymbol><ci id="algorithm2.16.16.m1.1.1.2.2.cmml" xref="algorithm2.16.16.m1.1.1.2.2">ℒ</ci><ci id="algorithm2.16.16.m1.1.1.2.3.cmml" xref="algorithm2.16.16.m1.1.1.2.3">𝑘</ci></apply><ci id="algorithm2.16.16.m1.1.1.3.cmml" xref="algorithm2.16.16.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.16.16.m1.1c">\mathcal{L}_{k}^{p}</annotation></semantics></math> by Eq. (9, 10, 11);
<math id="algorithm2.17.17.m2.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{k}\leftarrow\hat{\mathbf{w}}_{k}-\eta\nabla\mathcal{L}_{k}^{p}(\hat{\mathbf{w}}_{k})" display="inline"><semantics id="algorithm2.17.17.m2.1a"><mrow id="algorithm2.17.17.m2.1.1" xref="algorithm2.17.17.m2.1.1.cmml"><msub id="algorithm2.17.17.m2.1.1.3" xref="algorithm2.17.17.m2.1.1.3.cmml"><mover accent="true" id="algorithm2.17.17.m2.1.1.3.2" xref="algorithm2.17.17.m2.1.1.3.2.cmml"><mi id="algorithm2.17.17.m2.1.1.3.2.2" xref="algorithm2.17.17.m2.1.1.3.2.2.cmml">𝐰</mi><mo id="algorithm2.17.17.m2.1.1.3.2.1" xref="algorithm2.17.17.m2.1.1.3.2.1.cmml">^</mo></mover><mi id="algorithm2.17.17.m2.1.1.3.3" xref="algorithm2.17.17.m2.1.1.3.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm2.17.17.m2.1.1.2" xref="algorithm2.17.17.m2.1.1.2.cmml">←</mo><mrow id="algorithm2.17.17.m2.1.1.1" xref="algorithm2.17.17.m2.1.1.1.cmml"><msub id="algorithm2.17.17.m2.1.1.1.3" xref="algorithm2.17.17.m2.1.1.1.3.cmml"><mover accent="true" id="algorithm2.17.17.m2.1.1.1.3.2" xref="algorithm2.17.17.m2.1.1.1.3.2.cmml"><mi id="algorithm2.17.17.m2.1.1.1.3.2.2" xref="algorithm2.17.17.m2.1.1.1.3.2.2.cmml">𝐰</mi><mo id="algorithm2.17.17.m2.1.1.1.3.2.1" xref="algorithm2.17.17.m2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="algorithm2.17.17.m2.1.1.1.3.3" xref="algorithm2.17.17.m2.1.1.1.3.3.cmml">k</mi></msub><mo id="algorithm2.17.17.m2.1.1.1.2" xref="algorithm2.17.17.m2.1.1.1.2.cmml">−</mo><mrow id="algorithm2.17.17.m2.1.1.1.1" xref="algorithm2.17.17.m2.1.1.1.1.cmml"><mi id="algorithm2.17.17.m2.1.1.1.1.3" xref="algorithm2.17.17.m2.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm2.17.17.m2.1.1.1.1.2" xref="algorithm2.17.17.m2.1.1.1.1.2.cmml">​</mo><mrow id="algorithm2.17.17.m2.1.1.1.1.4" xref="algorithm2.17.17.m2.1.1.1.1.4.cmml"><mo rspace="0.167em" id="algorithm2.17.17.m2.1.1.1.1.4.1" xref="algorithm2.17.17.m2.1.1.1.1.4.1.cmml">∇</mo><msubsup id="algorithm2.17.17.m2.1.1.1.1.4.2" xref="algorithm2.17.17.m2.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.17.17.m2.1.1.1.1.4.2.2.2" xref="algorithm2.17.17.m2.1.1.1.1.4.2.2.2.cmml">ℒ</mi><mi id="algorithm2.17.17.m2.1.1.1.1.4.2.2.3" xref="algorithm2.17.17.m2.1.1.1.1.4.2.2.3.cmml">k</mi><mi id="algorithm2.17.17.m2.1.1.1.1.4.2.3" xref="algorithm2.17.17.m2.1.1.1.1.4.2.3.cmml">p</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="algorithm2.17.17.m2.1.1.1.1.2a" xref="algorithm2.17.17.m2.1.1.1.1.2.cmml">​</mo><mrow id="algorithm2.17.17.m2.1.1.1.1.1.1" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm2.17.17.m2.1.1.1.1.1.1.2" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm2.17.17.m2.1.1.1.1.1.1.1" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="algorithm2.17.17.m2.1.1.1.1.1.1.1.2" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.cmml"><mi id="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.2" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mo id="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.1" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm2.17.17.m2.1.1.1.1.1.1.1.3" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm2.17.17.m2.1.1.1.1.1.1.3" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.17.17.m2.1b"><apply id="algorithm2.17.17.m2.1.1.cmml" xref="algorithm2.17.17.m2.1.1"><ci id="algorithm2.17.17.m2.1.1.2.cmml" xref="algorithm2.17.17.m2.1.1.2">←</ci><apply id="algorithm2.17.17.m2.1.1.3.cmml" xref="algorithm2.17.17.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm2.17.17.m2.1.1.3.1.cmml" xref="algorithm2.17.17.m2.1.1.3">subscript</csymbol><apply id="algorithm2.17.17.m2.1.1.3.2.cmml" xref="algorithm2.17.17.m2.1.1.3.2"><ci id="algorithm2.17.17.m2.1.1.3.2.1.cmml" xref="algorithm2.17.17.m2.1.1.3.2.1">^</ci><ci id="algorithm2.17.17.m2.1.1.3.2.2.cmml" xref="algorithm2.17.17.m2.1.1.3.2.2">𝐰</ci></apply><ci id="algorithm2.17.17.m2.1.1.3.3.cmml" xref="algorithm2.17.17.m2.1.1.3.3">𝑘</ci></apply><apply id="algorithm2.17.17.m2.1.1.1.cmml" xref="algorithm2.17.17.m2.1.1.1"><minus id="algorithm2.17.17.m2.1.1.1.2.cmml" xref="algorithm2.17.17.m2.1.1.1.2"></minus><apply id="algorithm2.17.17.m2.1.1.1.3.cmml" xref="algorithm2.17.17.m2.1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.17.17.m2.1.1.1.3.1.cmml" xref="algorithm2.17.17.m2.1.1.1.3">subscript</csymbol><apply id="algorithm2.17.17.m2.1.1.1.3.2.cmml" xref="algorithm2.17.17.m2.1.1.1.3.2"><ci id="algorithm2.17.17.m2.1.1.1.3.2.1.cmml" xref="algorithm2.17.17.m2.1.1.1.3.2.1">^</ci><ci id="algorithm2.17.17.m2.1.1.1.3.2.2.cmml" xref="algorithm2.17.17.m2.1.1.1.3.2.2">𝐰</ci></apply><ci id="algorithm2.17.17.m2.1.1.1.3.3.cmml" xref="algorithm2.17.17.m2.1.1.1.3.3">𝑘</ci></apply><apply id="algorithm2.17.17.m2.1.1.1.1.cmml" xref="algorithm2.17.17.m2.1.1.1.1"><times id="algorithm2.17.17.m2.1.1.1.1.2.cmml" xref="algorithm2.17.17.m2.1.1.1.1.2"></times><ci id="algorithm2.17.17.m2.1.1.1.1.3.cmml" xref="algorithm2.17.17.m2.1.1.1.1.3">𝜂</ci><apply id="algorithm2.17.17.m2.1.1.1.1.4.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4"><ci id="algorithm2.17.17.m2.1.1.1.1.4.1.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4.1">∇</ci><apply id="algorithm2.17.17.m2.1.1.1.1.4.2.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm2.17.17.m2.1.1.1.1.4.2.1.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4.2">superscript</csymbol><apply id="algorithm2.17.17.m2.1.1.1.1.4.2.2.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm2.17.17.m2.1.1.1.1.4.2.2.1.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4.2">subscript</csymbol><ci id="algorithm2.17.17.m2.1.1.1.1.4.2.2.2.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4.2.2.2">ℒ</ci><ci id="algorithm2.17.17.m2.1.1.1.1.4.2.2.3.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4.2.2.3">𝑘</ci></apply><ci id="algorithm2.17.17.m2.1.1.1.1.4.2.3.cmml" xref="algorithm2.17.17.m2.1.1.1.1.4.2.3">𝑝</ci></apply></apply><apply id="algorithm2.17.17.m2.1.1.1.1.1.1.1.cmml" xref="algorithm2.17.17.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.17.17.m2.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.17.17.m2.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.2"><ci id="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.1">^</ci><ci id="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.2.2">𝐰</ci></apply><ci id="algorithm2.17.17.m2.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.17.17.m2.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.17.17.m2.1c">\hat{\mathbf{w}}_{k}\leftarrow\hat{\mathbf{w}}_{k}-\eta\nabla\mathcal{L}_{k}^{p}(\hat{\mathbf{w}}_{k})</annotation></semantics></math>;

</div>
<div id="algorithm2.22.28" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.22.29" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm2.22.29.1" class="ltx_text ltx_font_italic">Finetune the projection layer.</span> 
</div>
<div id="algorithm2.18.18" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm2.18.18.m1.5" class="ltx_Math" alttext="\hat{\mathbf{w}}_{k}=\{\mathbf{p},\beta\},~{}\overline{\mathbf{w}}_{k}=\{\mathbf{V}_{ETF},\mathbf{u}\}" display="inline"><semantics id="algorithm2.18.18.m1.5a"><mrow id="algorithm2.18.18.m1.5.5.2" xref="algorithm2.18.18.m1.5.5.3.cmml"><mrow id="algorithm2.18.18.m1.4.4.1.1" xref="algorithm2.18.18.m1.4.4.1.1.cmml"><msub id="algorithm2.18.18.m1.4.4.1.1.2" xref="algorithm2.18.18.m1.4.4.1.1.2.cmml"><mover accent="true" id="algorithm2.18.18.m1.4.4.1.1.2.2" xref="algorithm2.18.18.m1.4.4.1.1.2.2.cmml"><mi id="algorithm2.18.18.m1.4.4.1.1.2.2.2" xref="algorithm2.18.18.m1.4.4.1.1.2.2.2.cmml">𝐰</mi><mo id="algorithm2.18.18.m1.4.4.1.1.2.2.1" xref="algorithm2.18.18.m1.4.4.1.1.2.2.1.cmml">^</mo></mover><mi id="algorithm2.18.18.m1.4.4.1.1.2.3" xref="algorithm2.18.18.m1.4.4.1.1.2.3.cmml">k</mi></msub><mo id="algorithm2.18.18.m1.4.4.1.1.1" xref="algorithm2.18.18.m1.4.4.1.1.1.cmml">=</mo><mrow id="algorithm2.18.18.m1.4.4.1.1.3.2" xref="algorithm2.18.18.m1.4.4.1.1.3.1.cmml"><mo stretchy="false" id="algorithm2.18.18.m1.4.4.1.1.3.2.1" xref="algorithm2.18.18.m1.4.4.1.1.3.1.cmml">{</mo><mi id="algorithm2.18.18.m1.1.1" xref="algorithm2.18.18.m1.1.1.cmml">𝐩</mi><mo id="algorithm2.18.18.m1.4.4.1.1.3.2.2" xref="algorithm2.18.18.m1.4.4.1.1.3.1.cmml">,</mo><mi id="algorithm2.18.18.m1.2.2" xref="algorithm2.18.18.m1.2.2.cmml">β</mi><mo stretchy="false" id="algorithm2.18.18.m1.4.4.1.1.3.2.3" xref="algorithm2.18.18.m1.4.4.1.1.3.1.cmml">}</mo></mrow></mrow><mo rspace="0.497em" id="algorithm2.18.18.m1.5.5.2.3" xref="algorithm2.18.18.m1.5.5.3a.cmml">,</mo><mrow id="algorithm2.18.18.m1.5.5.2.2" xref="algorithm2.18.18.m1.5.5.2.2.cmml"><msub id="algorithm2.18.18.m1.5.5.2.2.3" xref="algorithm2.18.18.m1.5.5.2.2.3.cmml"><mover accent="true" id="algorithm2.18.18.m1.5.5.2.2.3.2" xref="algorithm2.18.18.m1.5.5.2.2.3.2.cmml"><mi id="algorithm2.18.18.m1.5.5.2.2.3.2.2" xref="algorithm2.18.18.m1.5.5.2.2.3.2.2.cmml">𝐰</mi><mo id="algorithm2.18.18.m1.5.5.2.2.3.2.1" xref="algorithm2.18.18.m1.5.5.2.2.3.2.1.cmml">¯</mo></mover><mi id="algorithm2.18.18.m1.5.5.2.2.3.3" xref="algorithm2.18.18.m1.5.5.2.2.3.3.cmml">k</mi></msub><mo id="algorithm2.18.18.m1.5.5.2.2.2" xref="algorithm2.18.18.m1.5.5.2.2.2.cmml">=</mo><mrow id="algorithm2.18.18.m1.5.5.2.2.1.1" xref="algorithm2.18.18.m1.5.5.2.2.1.2.cmml"><mo stretchy="false" id="algorithm2.18.18.m1.5.5.2.2.1.1.2" xref="algorithm2.18.18.m1.5.5.2.2.1.2.cmml">{</mo><msub id="algorithm2.18.18.m1.5.5.2.2.1.1.1" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.cmml"><mi id="algorithm2.18.18.m1.5.5.2.2.1.1.1.2" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.2.cmml">𝐕</mi><mrow id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.cmml"><mi id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.2" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.1" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.3" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.1a" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.1.cmml">​</mo><mi id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.4" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.4.cmml">F</mi></mrow></msub><mo id="algorithm2.18.18.m1.5.5.2.2.1.1.3" xref="algorithm2.18.18.m1.5.5.2.2.1.2.cmml">,</mo><mi id="algorithm2.18.18.m1.3.3" xref="algorithm2.18.18.m1.3.3.cmml">𝐮</mi><mo stretchy="false" id="algorithm2.18.18.m1.5.5.2.2.1.1.4" xref="algorithm2.18.18.m1.5.5.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.18.18.m1.5b"><apply id="algorithm2.18.18.m1.5.5.3.cmml" xref="algorithm2.18.18.m1.5.5.2"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.5.5.3a.cmml" xref="algorithm2.18.18.m1.5.5.2.3">formulae-sequence</csymbol><apply id="algorithm2.18.18.m1.4.4.1.1.cmml" xref="algorithm2.18.18.m1.4.4.1.1"><eq id="algorithm2.18.18.m1.4.4.1.1.1.cmml" xref="algorithm2.18.18.m1.4.4.1.1.1"></eq><apply id="algorithm2.18.18.m1.4.4.1.1.2.cmml" xref="algorithm2.18.18.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.4.4.1.1.2.1.cmml" xref="algorithm2.18.18.m1.4.4.1.1.2">subscript</csymbol><apply id="algorithm2.18.18.m1.4.4.1.1.2.2.cmml" xref="algorithm2.18.18.m1.4.4.1.1.2.2"><ci id="algorithm2.18.18.m1.4.4.1.1.2.2.1.cmml" xref="algorithm2.18.18.m1.4.4.1.1.2.2.1">^</ci><ci id="algorithm2.18.18.m1.4.4.1.1.2.2.2.cmml" xref="algorithm2.18.18.m1.4.4.1.1.2.2.2">𝐰</ci></apply><ci id="algorithm2.18.18.m1.4.4.1.1.2.3.cmml" xref="algorithm2.18.18.m1.4.4.1.1.2.3">𝑘</ci></apply><set id="algorithm2.18.18.m1.4.4.1.1.3.1.cmml" xref="algorithm2.18.18.m1.4.4.1.1.3.2"><ci id="algorithm2.18.18.m1.1.1.cmml" xref="algorithm2.18.18.m1.1.1">𝐩</ci><ci id="algorithm2.18.18.m1.2.2.cmml" xref="algorithm2.18.18.m1.2.2">𝛽</ci></set></apply><apply id="algorithm2.18.18.m1.5.5.2.2.cmml" xref="algorithm2.18.18.m1.5.5.2.2"><eq id="algorithm2.18.18.m1.5.5.2.2.2.cmml" xref="algorithm2.18.18.m1.5.5.2.2.2"></eq><apply id="algorithm2.18.18.m1.5.5.2.2.3.cmml" xref="algorithm2.18.18.m1.5.5.2.2.3"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.5.5.2.2.3.1.cmml" xref="algorithm2.18.18.m1.5.5.2.2.3">subscript</csymbol><apply id="algorithm2.18.18.m1.5.5.2.2.3.2.cmml" xref="algorithm2.18.18.m1.5.5.2.2.3.2"><ci id="algorithm2.18.18.m1.5.5.2.2.3.2.1.cmml" xref="algorithm2.18.18.m1.5.5.2.2.3.2.1">¯</ci><ci id="algorithm2.18.18.m1.5.5.2.2.3.2.2.cmml" xref="algorithm2.18.18.m1.5.5.2.2.3.2.2">𝐰</ci></apply><ci id="algorithm2.18.18.m1.5.5.2.2.3.3.cmml" xref="algorithm2.18.18.m1.5.5.2.2.3.3">𝑘</ci></apply><set id="algorithm2.18.18.m1.5.5.2.2.1.2.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1"><apply id="algorithm2.18.18.m1.5.5.2.2.1.1.1.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm2.18.18.m1.5.5.2.2.1.1.1.1.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1">subscript</csymbol><ci id="algorithm2.18.18.m1.5.5.2.2.1.1.1.2.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.2">𝐕</ci><apply id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3"><times id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.1.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.1"></times><ci id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.2.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.2">𝐸</ci><ci id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.3.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.3">𝑇</ci><ci id="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.4.cmml" xref="algorithm2.18.18.m1.5.5.2.2.1.1.1.3.4">𝐹</ci></apply></apply><ci id="algorithm2.18.18.m1.3.3.cmml" xref="algorithm2.18.18.m1.3.3">𝐮</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.18.18.m1.5c">\hat{\mathbf{w}}_{k}=\{\mathbf{p},\beta\},~{}\overline{\mathbf{w}}_{k}=\{\mathbf{V}_{ETF},\mathbf{u}\}</annotation></semantics></math>; 
</div>
<div id="algorithm2.19.19" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm2.19.19.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm2.19.19.1" class="ltx_emph ltx_font_italic"><span id="algorithm2.19.19.1.1" class="ltx_text ltx_font_upright">local epoch</span> <math id="algorithm2.19.19.1.m1.3" class="ltx_Math" alttext="e=1,\dots,E" display="inline"><semantics id="algorithm2.19.19.1.m1.3a"><mrow id="algorithm2.19.19.1.m1.3.4" xref="algorithm2.19.19.1.m1.3.4.cmml"><mi id="algorithm2.19.19.1.m1.3.4.2" xref="algorithm2.19.19.1.m1.3.4.2.cmml">e</mi><mo id="algorithm2.19.19.1.m1.3.4.1" xref="algorithm2.19.19.1.m1.3.4.1.cmml">=</mo><mrow id="algorithm2.19.19.1.m1.3.4.3.2" xref="algorithm2.19.19.1.m1.3.4.3.1.cmml"><mn id="algorithm2.19.19.1.m1.1.1" xref="algorithm2.19.19.1.m1.1.1.cmml">1</mn><mo id="algorithm2.19.19.1.m1.3.4.3.2.1" xref="algorithm2.19.19.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="algorithm2.19.19.1.m1.2.2" xref="algorithm2.19.19.1.m1.2.2.cmml">…</mi><mo id="algorithm2.19.19.1.m1.3.4.3.2.2" xref="algorithm2.19.19.1.m1.3.4.3.1.cmml">,</mo><mi id="algorithm2.19.19.1.m1.3.3" xref="algorithm2.19.19.1.m1.3.3.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.19.19.1.m1.3b"><apply id="algorithm2.19.19.1.m1.3.4.cmml" xref="algorithm2.19.19.1.m1.3.4"><eq id="algorithm2.19.19.1.m1.3.4.1.cmml" xref="algorithm2.19.19.1.m1.3.4.1"></eq><ci id="algorithm2.19.19.1.m1.3.4.2.cmml" xref="algorithm2.19.19.1.m1.3.4.2">𝑒</ci><list id="algorithm2.19.19.1.m1.3.4.3.1.cmml" xref="algorithm2.19.19.1.m1.3.4.3.2"><cn type="integer" id="algorithm2.19.19.1.m1.1.1.cmml" xref="algorithm2.19.19.1.m1.1.1">1</cn><ci id="algorithm2.19.19.1.m1.2.2.cmml" xref="algorithm2.19.19.1.m1.2.2">…</ci><ci id="algorithm2.19.19.1.m1.3.3.cmml" xref="algorithm2.19.19.1.m1.3.3">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.19.19.1.m1.3c">e=1,\dots,E</annotation></semantics></math></em> <span id="algorithm2.19.19.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm2.21.21" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Obtain <math id="algorithm2.20.20.m1.1" class="ltx_Math" alttext="\mathcal{L}_{k}^{p}" display="inline"><semantics id="algorithm2.20.20.m1.1a"><msubsup id="algorithm2.20.20.m1.1.1" xref="algorithm2.20.20.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.20.20.m1.1.1.2.2" xref="algorithm2.20.20.m1.1.1.2.2.cmml">ℒ</mi><mi id="algorithm2.20.20.m1.1.1.2.3" xref="algorithm2.20.20.m1.1.1.2.3.cmml">k</mi><mi id="algorithm2.20.20.m1.1.1.3" xref="algorithm2.20.20.m1.1.1.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm2.20.20.m1.1b"><apply id="algorithm2.20.20.m1.1.1.cmml" xref="algorithm2.20.20.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.20.20.m1.1.1.1.cmml" xref="algorithm2.20.20.m1.1.1">superscript</csymbol><apply id="algorithm2.20.20.m1.1.1.2.cmml" xref="algorithm2.20.20.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.20.20.m1.1.1.2.1.cmml" xref="algorithm2.20.20.m1.1.1">subscript</csymbol><ci id="algorithm2.20.20.m1.1.1.2.2.cmml" xref="algorithm2.20.20.m1.1.1.2.2">ℒ</ci><ci id="algorithm2.20.20.m1.1.1.2.3.cmml" xref="algorithm2.20.20.m1.1.1.2.3">𝑘</ci></apply><ci id="algorithm2.20.20.m1.1.1.3.cmml" xref="algorithm2.20.20.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.20.20.m1.1c">\mathcal{L}_{k}^{p}</annotation></semantics></math> by Eq. (9, 10, 11);
<math id="algorithm2.21.21.m2.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{k}\leftarrow\hat{\mathbf{w}}_{k}-\eta\nabla\mathcal{L}_{k}^{p}(\hat{\mathbf{w}}_{k})" display="inline"><semantics id="algorithm2.21.21.m2.1a"><mrow id="algorithm2.21.21.m2.1.1" xref="algorithm2.21.21.m2.1.1.cmml"><msub id="algorithm2.21.21.m2.1.1.3" xref="algorithm2.21.21.m2.1.1.3.cmml"><mover accent="true" id="algorithm2.21.21.m2.1.1.3.2" xref="algorithm2.21.21.m2.1.1.3.2.cmml"><mi id="algorithm2.21.21.m2.1.1.3.2.2" xref="algorithm2.21.21.m2.1.1.3.2.2.cmml">𝐰</mi><mo id="algorithm2.21.21.m2.1.1.3.2.1" xref="algorithm2.21.21.m2.1.1.3.2.1.cmml">^</mo></mover><mi id="algorithm2.21.21.m2.1.1.3.3" xref="algorithm2.21.21.m2.1.1.3.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm2.21.21.m2.1.1.2" xref="algorithm2.21.21.m2.1.1.2.cmml">←</mo><mrow id="algorithm2.21.21.m2.1.1.1" xref="algorithm2.21.21.m2.1.1.1.cmml"><msub id="algorithm2.21.21.m2.1.1.1.3" xref="algorithm2.21.21.m2.1.1.1.3.cmml"><mover accent="true" id="algorithm2.21.21.m2.1.1.1.3.2" xref="algorithm2.21.21.m2.1.1.1.3.2.cmml"><mi id="algorithm2.21.21.m2.1.1.1.3.2.2" xref="algorithm2.21.21.m2.1.1.1.3.2.2.cmml">𝐰</mi><mo id="algorithm2.21.21.m2.1.1.1.3.2.1" xref="algorithm2.21.21.m2.1.1.1.3.2.1.cmml">^</mo></mover><mi id="algorithm2.21.21.m2.1.1.1.3.3" xref="algorithm2.21.21.m2.1.1.1.3.3.cmml">k</mi></msub><mo id="algorithm2.21.21.m2.1.1.1.2" xref="algorithm2.21.21.m2.1.1.1.2.cmml">−</mo><mrow id="algorithm2.21.21.m2.1.1.1.1" xref="algorithm2.21.21.m2.1.1.1.1.cmml"><mi id="algorithm2.21.21.m2.1.1.1.1.3" xref="algorithm2.21.21.m2.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm2.21.21.m2.1.1.1.1.2" xref="algorithm2.21.21.m2.1.1.1.1.2.cmml">​</mo><mrow id="algorithm2.21.21.m2.1.1.1.1.4" xref="algorithm2.21.21.m2.1.1.1.1.4.cmml"><mo rspace="0.167em" id="algorithm2.21.21.m2.1.1.1.1.4.1" xref="algorithm2.21.21.m2.1.1.1.1.4.1.cmml">∇</mo><msubsup id="algorithm2.21.21.m2.1.1.1.1.4.2" xref="algorithm2.21.21.m2.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm2.21.21.m2.1.1.1.1.4.2.2.2" xref="algorithm2.21.21.m2.1.1.1.1.4.2.2.2.cmml">ℒ</mi><mi id="algorithm2.21.21.m2.1.1.1.1.4.2.2.3" xref="algorithm2.21.21.m2.1.1.1.1.4.2.2.3.cmml">k</mi><mi id="algorithm2.21.21.m2.1.1.1.1.4.2.3" xref="algorithm2.21.21.m2.1.1.1.1.4.2.3.cmml">p</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="algorithm2.21.21.m2.1.1.1.1.2a" xref="algorithm2.21.21.m2.1.1.1.1.2.cmml">​</mo><mrow id="algorithm2.21.21.m2.1.1.1.1.1.1" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="algorithm2.21.21.m2.1.1.1.1.1.1.2" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm2.21.21.m2.1.1.1.1.1.1.1" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.cmml"><mover accent="true" id="algorithm2.21.21.m2.1.1.1.1.1.1.1.2" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.cmml"><mi id="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.2" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mo id="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.1" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="algorithm2.21.21.m2.1.1.1.1.1.1.1.3" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm2.21.21.m2.1.1.1.1.1.1.3" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm2.21.21.m2.1b"><apply id="algorithm2.21.21.m2.1.1.cmml" xref="algorithm2.21.21.m2.1.1"><ci id="algorithm2.21.21.m2.1.1.2.cmml" xref="algorithm2.21.21.m2.1.1.2">←</ci><apply id="algorithm2.21.21.m2.1.1.3.cmml" xref="algorithm2.21.21.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm2.21.21.m2.1.1.3.1.cmml" xref="algorithm2.21.21.m2.1.1.3">subscript</csymbol><apply id="algorithm2.21.21.m2.1.1.3.2.cmml" xref="algorithm2.21.21.m2.1.1.3.2"><ci id="algorithm2.21.21.m2.1.1.3.2.1.cmml" xref="algorithm2.21.21.m2.1.1.3.2.1">^</ci><ci id="algorithm2.21.21.m2.1.1.3.2.2.cmml" xref="algorithm2.21.21.m2.1.1.3.2.2">𝐰</ci></apply><ci id="algorithm2.21.21.m2.1.1.3.3.cmml" xref="algorithm2.21.21.m2.1.1.3.3">𝑘</ci></apply><apply id="algorithm2.21.21.m2.1.1.1.cmml" xref="algorithm2.21.21.m2.1.1.1"><minus id="algorithm2.21.21.m2.1.1.1.2.cmml" xref="algorithm2.21.21.m2.1.1.1.2"></minus><apply id="algorithm2.21.21.m2.1.1.1.3.cmml" xref="algorithm2.21.21.m2.1.1.1.3"><csymbol cd="ambiguous" id="algorithm2.21.21.m2.1.1.1.3.1.cmml" xref="algorithm2.21.21.m2.1.1.1.3">subscript</csymbol><apply id="algorithm2.21.21.m2.1.1.1.3.2.cmml" xref="algorithm2.21.21.m2.1.1.1.3.2"><ci id="algorithm2.21.21.m2.1.1.1.3.2.1.cmml" xref="algorithm2.21.21.m2.1.1.1.3.2.1">^</ci><ci id="algorithm2.21.21.m2.1.1.1.3.2.2.cmml" xref="algorithm2.21.21.m2.1.1.1.3.2.2">𝐰</ci></apply><ci id="algorithm2.21.21.m2.1.1.1.3.3.cmml" xref="algorithm2.21.21.m2.1.1.1.3.3">𝑘</ci></apply><apply id="algorithm2.21.21.m2.1.1.1.1.cmml" xref="algorithm2.21.21.m2.1.1.1.1"><times id="algorithm2.21.21.m2.1.1.1.1.2.cmml" xref="algorithm2.21.21.m2.1.1.1.1.2"></times><ci id="algorithm2.21.21.m2.1.1.1.1.3.cmml" xref="algorithm2.21.21.m2.1.1.1.1.3">𝜂</ci><apply id="algorithm2.21.21.m2.1.1.1.1.4.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4"><ci id="algorithm2.21.21.m2.1.1.1.1.4.1.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4.1">∇</ci><apply id="algorithm2.21.21.m2.1.1.1.1.4.2.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm2.21.21.m2.1.1.1.1.4.2.1.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4.2">superscript</csymbol><apply id="algorithm2.21.21.m2.1.1.1.1.4.2.2.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="algorithm2.21.21.m2.1.1.1.1.4.2.2.1.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4.2">subscript</csymbol><ci id="algorithm2.21.21.m2.1.1.1.1.4.2.2.2.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4.2.2.2">ℒ</ci><ci id="algorithm2.21.21.m2.1.1.1.1.4.2.2.3.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4.2.2.3">𝑘</ci></apply><ci id="algorithm2.21.21.m2.1.1.1.1.4.2.3.cmml" xref="algorithm2.21.21.m2.1.1.1.1.4.2.3">𝑝</ci></apply></apply><apply id="algorithm2.21.21.m2.1.1.1.1.1.1.1.cmml" xref="algorithm2.21.21.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm2.21.21.m2.1.1.1.1.1.1.1.1.cmml" xref="algorithm2.21.21.m2.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.cmml" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.2"><ci id="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.1.cmml" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.1">^</ci><ci id="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.2.2">𝐰</ci></apply><ci id="algorithm2.21.21.m2.1.1.1.1.1.1.1.3.cmml" xref="algorithm2.21.21.m2.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.21.21.m2.1c">\hat{\mathbf{w}}_{k}\leftarrow\hat{\mathbf{w}}_{k}-\eta\nabla\mathcal{L}_{k}^{p}(\hat{\mathbf{w}}_{k})</annotation></semantics></math>;

</div>
<div id="algorithm2.22.30" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.22.31" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm2.22.32" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm2.22.33" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div id="algorithm2.22.34" class="ltx_listingline"> end for
</div>
<div id="algorithm2.22.22" class="ltx_listingline">The personalized local models are <math id="algorithm2.22.22.m1.1" class="ltx_Math" alttext="\{\mathbf{w}_{k}^{p}=\hat{\mathbf{w}}_{k}\cup\overline{\mathbf{w}}_{k}\}_{k=1}^{K}" display="inline"><semantics id="algorithm2.22.22.m1.1a"><msubsup id="algorithm2.22.22.m1.1.1" xref="algorithm2.22.22.m1.1.1.cmml"><mrow id="algorithm2.22.22.m1.1.1.1.1.1" xref="algorithm2.22.22.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm2.22.22.m1.1.1.1.1.1.2" xref="algorithm2.22.22.m1.1.1.1.1.2.cmml">{</mo><mrow id="algorithm2.22.22.m1.1.1.1.1.1.1" xref="algorithm2.22.22.m1.1.1.1.1.1.1.cmml"><msubsup id="algorithm2.22.22.m1.1.1.1.1.1.1.2" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2.cmml"><mi id="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.2" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.2.cmml">𝐰</mi><mi id="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.3" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.3.cmml">k</mi><mi id="algorithm2.22.22.m1.1.1.1.1.1.1.2.3" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2.3.cmml">p</mi></msubsup><mo id="algorithm2.22.22.m1.1.1.1.1.1.1.1" xref="algorithm2.22.22.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="algorithm2.22.22.m1.1.1.1.1.1.1.3" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.cmml"><msub id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.cmml"><mover accent="true" id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.cmml"><mi id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.2" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.2.cmml">𝐰</mi><mo id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.1" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.3" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.3.cmml">k</mi></msub><mo id="algorithm2.22.22.m1.1.1.1.1.1.1.3.1" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.1.cmml">∪</mo><msub id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.cmml"><mover accent="true" id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.cmml"><mi id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.2" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.2.cmml">𝐰</mi><mo id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.1" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.1.cmml">¯</mo></mover><mi id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.3" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="algorithm2.22.22.m1.1.1.1.1.1.3" xref="algorithm2.22.22.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm2.22.22.m1.1.1.1.3" xref="algorithm2.22.22.m1.1.1.1.3.cmml"><mi id="algorithm2.22.22.m1.1.1.1.3.2" xref="algorithm2.22.22.m1.1.1.1.3.2.cmml">k</mi><mo id="algorithm2.22.22.m1.1.1.1.3.1" xref="algorithm2.22.22.m1.1.1.1.3.1.cmml">=</mo><mn id="algorithm2.22.22.m1.1.1.1.3.3" xref="algorithm2.22.22.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm2.22.22.m1.1.1.3" xref="algorithm2.22.22.m1.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm2.22.22.m1.1b"><apply id="algorithm2.22.22.m1.1.1.cmml" xref="algorithm2.22.22.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.22.22.m1.1.1.2.cmml" xref="algorithm2.22.22.m1.1.1">superscript</csymbol><apply id="algorithm2.22.22.m1.1.1.1.cmml" xref="algorithm2.22.22.m1.1.1"><csymbol cd="ambiguous" id="algorithm2.22.22.m1.1.1.1.2.cmml" xref="algorithm2.22.22.m1.1.1">subscript</csymbol><set id="algorithm2.22.22.m1.1.1.1.1.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1"><apply id="algorithm2.22.22.m1.1.1.1.1.1.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1"><eq id="algorithm2.22.22.m1.1.1.1.1.1.1.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.1"></eq><apply id="algorithm2.22.22.m1.1.1.1.1.1.1.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.22.22.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.2">𝐰</ci><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.3.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.2.3.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.2.3">𝑝</ci></apply><apply id="algorithm2.22.22.m1.1.1.1.1.1.1.3.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3"><union id="algorithm2.22.22.m1.1.1.1.1.1.1.3.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.1"></union><apply id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2">subscript</csymbol><apply id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2"><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.2.2">𝐰</ci></apply><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.3.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3">subscript</csymbol><apply id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2"><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.1">¯</ci><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.2.2">𝐰</ci></apply><ci id="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.3.cmml" xref="algorithm2.22.22.m1.1.1.1.1.1.1.3.3.3">𝑘</ci></apply></apply></apply></set><apply id="algorithm2.22.22.m1.1.1.1.3.cmml" xref="algorithm2.22.22.m1.1.1.1.3"><eq id="algorithm2.22.22.m1.1.1.1.3.1.cmml" xref="algorithm2.22.22.m1.1.1.1.3.1"></eq><ci id="algorithm2.22.22.m1.1.1.1.3.2.cmml" xref="algorithm2.22.22.m1.1.1.1.3.2">𝑘</ci><cn type="integer" id="algorithm2.22.22.m1.1.1.1.3.3.cmml" xref="algorithm2.22.22.m1.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm2.22.22.m1.1.1.3.cmml" xref="algorithm2.22.22.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm2.22.22.m1.1c">\{\mathbf{w}_{k}^{p}=\hat{\mathbf{w}}_{k}\cup\overline{\mathbf{w}}_{k}\}_{k=1}^{K}</annotation></semantics></math>.

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm2.25.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> <span id="algorithm2.26.2" class="ltx_text ltx_font_smallcaps">FedETF</span> Personalized Finetuning </figcaption>
</figure>
<figure id="A1.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2303.10058/assets/x13.png" id="A1.F7.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="122" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2303.10058/assets/x14.png" id="A1.F7.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="207" height="122" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span> <span id="A1.F7.6.1" class="ltx_text ltx_font_bold">Visualization of clients’ data distributions.</span> Random seed is 8. Left: data distributions of Non-IID <math id="A1.F7.3.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="A1.F7.3.m1.1b"><mrow id="A1.F7.3.m1.1.1" xref="A1.F7.3.m1.1.1.cmml"><mi id="A1.F7.3.m1.1.1.2" xref="A1.F7.3.m1.1.1.2.cmml">α</mi><mo id="A1.F7.3.m1.1.1.1" xref="A1.F7.3.m1.1.1.1.cmml">=</mo><mn id="A1.F7.3.m1.1.1.3" xref="A1.F7.3.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F7.3.m1.1c"><apply id="A1.F7.3.m1.1.1.cmml" xref="A1.F7.3.m1.1.1"><eq id="A1.F7.3.m1.1.1.1.cmml" xref="A1.F7.3.m1.1.1.1"></eq><ci id="A1.F7.3.m1.1.1.2.cmml" xref="A1.F7.3.m1.1.1.2">𝛼</ci><cn type="float" id="A1.F7.3.m1.1.1.3.cmml" xref="A1.F7.3.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.3.m1.1d">\alpha=0.1</annotation></semantics></math> with 20 clients. Right: data distributions of Non-IID <math id="A1.F7.4.m2.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="A1.F7.4.m2.1b"><mrow id="A1.F7.4.m2.1.1" xref="A1.F7.4.m2.1.1.cmml"><mi id="A1.F7.4.m2.1.1.2" xref="A1.F7.4.m2.1.1.2.cmml">α</mi><mo id="A1.F7.4.m2.1.1.1" xref="A1.F7.4.m2.1.1.1.cmml">=</mo><mn id="A1.F7.4.m2.1.1.3" xref="A1.F7.4.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.F7.4.m2.1c"><apply id="A1.F7.4.m2.1.1.cmml" xref="A1.F7.4.m2.1.1"><eq id="A1.F7.4.m2.1.1.1.cmml" xref="A1.F7.4.m2.1.1.1"></eq><ci id="A1.F7.4.m2.1.1.2.cmml" xref="A1.F7.4.m2.1.1.2">𝛼</ci><cn type="float" id="A1.F7.4.m2.1.1.3.cmml" xref="A1.F7.4.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.F7.4.m2.1d">\alpha=0.05</annotation></semantics></math> with 20 clients.</figcaption>
</figure>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Implementation Details</h2>

<div id="A2.p1" class="ltx_para ltx_noindent">
<p id="A2.p1.4" class="ltx_p"><span id="A2.p1.4.1" class="ltx_text ltx_font_bold">Models and Data.</span> Our model implementations of the ResNet series and the DenseNet are referred from the codes of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. The model implementation of the EfficientNet is referred from the official code in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, and the implementation of the MobileNetv2 is referred from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. For the data, we use the Dirichlet-sampling-based data partition adopted in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. It considers a class-imbalanced data heterogeneity, controlled by hyperparameter <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.p1.1.m1.1a"><mi id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><ci id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">\alpha</annotation></semantics></math>, and smaller <math id="A2.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.p1.2.m2.1a"><mi id="A2.p1.2.m2.1.1" xref="A2.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.p1.2.m2.1b"><ci id="A2.p1.2.m2.1.1.cmml" xref="A2.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.2.m2.1c">\alpha</annotation></semantics></math> refers to more Non-IID data of clients. When <math id="A2.p1.3.m3.1" class="ltx_Math" alttext="\alpha&lt;1" display="inline"><semantics id="A2.p1.3.m3.1a"><mrow id="A2.p1.3.m3.1.1" xref="A2.p1.3.m3.1.1.cmml"><mi id="A2.p1.3.m3.1.1.2" xref="A2.p1.3.m3.1.1.2.cmml">α</mi><mo id="A2.p1.3.m3.1.1.1" xref="A2.p1.3.m3.1.1.1.cmml">&lt;</mo><mn id="A2.p1.3.m3.1.1.3" xref="A2.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p1.3.m3.1b"><apply id="A2.p1.3.m3.1.1.cmml" xref="A2.p1.3.m3.1.1"><lt id="A2.p1.3.m3.1.1.1.cmml" xref="A2.p1.3.m3.1.1.1"></lt><ci id="A2.p1.3.m3.1.1.2.cmml" xref="A2.p1.3.m3.1.1.2">𝛼</ci><cn type="integer" id="A2.p1.3.m3.1.1.3.cmml" xref="A2.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.3.m3.1c">\alpha&lt;1</annotation></semantics></math>, the data are considered to be rather Non-IID, which means that most of the training samples of one class are likely assigned to a small portion of clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. In our Dirichlet implementation, when <math id="A2.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.p1.4.m4.1a"><mi id="A2.p1.4.m4.1.1" xref="A2.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A2.p1.4.m4.1b"><ci id="A2.p1.4.m4.1.1.cmml" xref="A2.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.4.m4.1c">\alpha</annotation></semantics></math> goes smaller, the number of samples in each client along with the class distribution of each client both become more heterogeneous, which is realistic in practical scenarios.
We use the same Tiny-ImageNet dataset as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.</p>
</div>
<div id="A2.p2" class="ltx_para ltx_noindent">
<p id="A2.p2.3" class="ltx_p"><span id="A2.p2.3.1" class="ltx_text ltx_font_bold">Local learning rate and optimizer.</span> For CIFAR-10 the local learning rate (LR) <math id="A2.p2.1.m1.1" class="ltx_Math" alttext="\eta=0.04" display="inline"><semantics id="A2.p2.1.m1.1a"><mrow id="A2.p2.1.m1.1.1" xref="A2.p2.1.m1.1.1.cmml"><mi id="A2.p2.1.m1.1.1.2" xref="A2.p2.1.m1.1.1.2.cmml">η</mi><mo id="A2.p2.1.m1.1.1.1" xref="A2.p2.1.m1.1.1.1.cmml">=</mo><mn id="A2.p2.1.m1.1.1.3" xref="A2.p2.1.m1.1.1.3.cmml">0.04</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.1.m1.1b"><apply id="A2.p2.1.m1.1.1.cmml" xref="A2.p2.1.m1.1.1"><eq id="A2.p2.1.m1.1.1.1.cmml" xref="A2.p2.1.m1.1.1.1"></eq><ci id="A2.p2.1.m1.1.1.2.cmml" xref="A2.p2.1.m1.1.1.2">𝜂</ci><cn type="float" id="A2.p2.1.m1.1.1.3.cmml" xref="A2.p2.1.m1.1.1.3">0.04</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.1.m1.1c">\eta=0.04</annotation></semantics></math>, and for CIFAR-10 and Tiny-ImageNet, <math id="A2.p2.2.m2.1" class="ltx_Math" alttext="\eta=0.01" display="inline"><semantics id="A2.p2.2.m2.1a"><mrow id="A2.p2.2.m2.1.1" xref="A2.p2.2.m2.1.1.cmml"><mi id="A2.p2.2.m2.1.1.2" xref="A2.p2.2.m2.1.1.2.cmml">η</mi><mo id="A2.p2.2.m2.1.1.1" xref="A2.p2.2.m2.1.1.1.cmml">=</mo><mn id="A2.p2.2.m2.1.1.3" xref="A2.p2.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.2.m2.1b"><apply id="A2.p2.2.m2.1.1.cmml" xref="A2.p2.2.m2.1.1"><eq id="A2.p2.2.m2.1.1.1.cmml" xref="A2.p2.2.m2.1.1.1"></eq><ci id="A2.p2.2.m2.1.1.2.cmml" xref="A2.p2.2.m2.1.1.2">𝜂</ci><cn type="float" id="A2.p2.2.m2.1.1.3.cmml" xref="A2.p2.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.2.m2.1c">\eta=0.01</annotation></semantics></math>. For clients, we use SGD optimizer with momentum 0.9 and weight decay <math id="A2.p2.3.m3.1" class="ltx_Math" alttext="5\times 10^{-4}" display="inline"><semantics id="A2.p2.3.m3.1a"><mrow id="A2.p2.3.m3.1.1" xref="A2.p2.3.m3.1.1.cmml"><mn id="A2.p2.3.m3.1.1.2" xref="A2.p2.3.m3.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="A2.p2.3.m3.1.1.1" xref="A2.p2.3.m3.1.1.1.cmml">×</mo><msup id="A2.p2.3.m3.1.1.3" xref="A2.p2.3.m3.1.1.3.cmml"><mn id="A2.p2.3.m3.1.1.3.2" xref="A2.p2.3.m3.1.1.3.2.cmml">10</mn><mrow id="A2.p2.3.m3.1.1.3.3" xref="A2.p2.3.m3.1.1.3.3.cmml"><mo id="A2.p2.3.m3.1.1.3.3a" xref="A2.p2.3.m3.1.1.3.3.cmml">−</mo><mn id="A2.p2.3.m3.1.1.3.3.2" xref="A2.p2.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.p2.3.m3.1b"><apply id="A2.p2.3.m3.1.1.cmml" xref="A2.p2.3.m3.1.1"><times id="A2.p2.3.m3.1.1.1.cmml" xref="A2.p2.3.m3.1.1.1"></times><cn type="integer" id="A2.p2.3.m3.1.1.2.cmml" xref="A2.p2.3.m3.1.1.2">5</cn><apply id="A2.p2.3.m3.1.1.3.cmml" xref="A2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="A2.p2.3.m3.1.1.3.1.cmml" xref="A2.p2.3.m3.1.1.3">superscript</csymbol><cn type="integer" id="A2.p2.3.m3.1.1.3.2.cmml" xref="A2.p2.3.m3.1.1.3.2">10</cn><apply id="A2.p2.3.m3.1.1.3.3.cmml" xref="A2.p2.3.m3.1.1.3.3"><minus id="A2.p2.3.m3.1.1.3.3.1.cmml" xref="A2.p2.3.m3.1.1.3.3"></minus><cn type="integer" id="A2.p2.3.m3.1.1.3.3.2.cmml" xref="A2.p2.3.m3.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p2.3.m3.1c">5\times 10^{-4}</annotation></semantics></math>. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, we adopt a learning rate decaying scheduler, which decays the local LR by 0.99 in each round.</p>
</div>
<div id="A2.p3" class="ltx_para ltx_noindent">
<p id="A2.p3.8" class="ltx_p"><span id="A2.p3.8.1" class="ltx_text ltx_font_bold">Hyperparameters.</span>
For <span id="A2.p3.8.2" class="ltx_text ltx_font_smallcaps">FedETF</span>, we set the feature dimension to the number of classes, i.e. <math id="A2.p3.1.m1.1" class="ltx_Math" alttext="d=C" display="inline"><semantics id="A2.p3.1.m1.1a"><mrow id="A2.p3.1.m1.1.1" xref="A2.p3.1.m1.1.1.cmml"><mi id="A2.p3.1.m1.1.1.2" xref="A2.p3.1.m1.1.1.2.cmml">d</mi><mo id="A2.p3.1.m1.1.1.1" xref="A2.p3.1.m1.1.1.1.cmml">=</mo><mi id="A2.p3.1.m1.1.1.3" xref="A2.p3.1.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="A2.p3.1.m1.1b"><apply id="A2.p3.1.m1.1.1.cmml" xref="A2.p3.1.m1.1.1"><eq id="A2.p3.1.m1.1.1.1.cmml" xref="A2.p3.1.m1.1.1.1"></eq><ci id="A2.p3.1.m1.1.1.2.cmml" xref="A2.p3.1.m1.1.1.2">𝑑</ci><ci id="A2.p3.1.m1.1.1.3.cmml" xref="A2.p3.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.1.m1.1c">d=C</annotation></semantics></math>; the initial temperature <math id="A2.p3.2.m2.1" class="ltx_Math" alttext="\beta=1" display="inline"><semantics id="A2.p3.2.m2.1a"><mrow id="A2.p3.2.m2.1.1" xref="A2.p3.2.m2.1.1.cmml"><mi id="A2.p3.2.m2.1.1.2" xref="A2.p3.2.m2.1.1.2.cmml">β</mi><mo id="A2.p3.2.m2.1.1.1" xref="A2.p3.2.m2.1.1.1.cmml">=</mo><mn id="A2.p3.2.m2.1.1.3" xref="A2.p3.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p3.2.m2.1b"><apply id="A2.p3.2.m2.1.1.cmml" xref="A2.p3.2.m2.1.1"><eq id="A2.p3.2.m2.1.1.1.cmml" xref="A2.p3.2.m2.1.1.1"></eq><ci id="A2.p3.2.m2.1.1.2.cmml" xref="A2.p3.2.m2.1.1.2">𝛽</ci><cn type="integer" id="A2.p3.2.m2.1.1.3.cmml" xref="A2.p3.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.2.m2.1c">\beta=1</annotation></semantics></math>; <math id="A2.p3.3.m3.1" class="ltx_Math" alttext="\gamma=1" display="inline"><semantics id="A2.p3.3.m3.1a"><mrow id="A2.p3.3.m3.1.1" xref="A2.p3.3.m3.1.1.cmml"><mi id="A2.p3.3.m3.1.1.2" xref="A2.p3.3.m3.1.1.2.cmml">γ</mi><mo id="A2.p3.3.m3.1.1.1" xref="A2.p3.3.m3.1.1.1.cmml">=</mo><mn id="A2.p3.3.m3.1.1.3" xref="A2.p3.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p3.3.m3.1b"><apply id="A2.p3.3.m3.1.1.cmml" xref="A2.p3.3.m3.1.1"><eq id="A2.p3.3.m3.1.1.1.cmml" xref="A2.p3.3.m3.1.1.1"></eq><ci id="A2.p3.3.m3.1.1.2.cmml" xref="A2.p3.3.m3.1.1.2">𝛾</ci><cn type="integer" id="A2.p3.3.m3.1.1.3.cmml" xref="A2.p3.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.3.m3.1c">\gamma=1</annotation></semantics></math>.
We set <math id="A2.p3.4.m4.1" class="ltx_Math" alttext="\mu_{FedProx}=0.001" display="inline"><semantics id="A2.p3.4.m4.1a"><mrow id="A2.p3.4.m4.1.1" xref="A2.p3.4.m4.1.1.cmml"><msub id="A2.p3.4.m4.1.1.2" xref="A2.p3.4.m4.1.1.2.cmml"><mi id="A2.p3.4.m4.1.1.2.2" xref="A2.p3.4.m4.1.1.2.2.cmml">μ</mi><mrow id="A2.p3.4.m4.1.1.2.3" xref="A2.p3.4.m4.1.1.2.3.cmml"><mi id="A2.p3.4.m4.1.1.2.3.2" xref="A2.p3.4.m4.1.1.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="A2.p3.4.m4.1.1.2.3.1" xref="A2.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.4.m4.1.1.2.3.3" xref="A2.p3.4.m4.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.p3.4.m4.1.1.2.3.1a" xref="A2.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.4.m4.1.1.2.3.4" xref="A2.p3.4.m4.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A2.p3.4.m4.1.1.2.3.1b" xref="A2.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.4.m4.1.1.2.3.5" xref="A2.p3.4.m4.1.1.2.3.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="A2.p3.4.m4.1.1.2.3.1c" xref="A2.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.4.m4.1.1.2.3.6" xref="A2.p3.4.m4.1.1.2.3.6.cmml">r</mi><mo lspace="0em" rspace="0em" id="A2.p3.4.m4.1.1.2.3.1d" xref="A2.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.4.m4.1.1.2.3.7" xref="A2.p3.4.m4.1.1.2.3.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="A2.p3.4.m4.1.1.2.3.1e" xref="A2.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.4.m4.1.1.2.3.8" xref="A2.p3.4.m4.1.1.2.3.8.cmml">x</mi></mrow></msub><mo id="A2.p3.4.m4.1.1.1" xref="A2.p3.4.m4.1.1.1.cmml">=</mo><mn id="A2.p3.4.m4.1.1.3" xref="A2.p3.4.m4.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p3.4.m4.1b"><apply id="A2.p3.4.m4.1.1.cmml" xref="A2.p3.4.m4.1.1"><eq id="A2.p3.4.m4.1.1.1.cmml" xref="A2.p3.4.m4.1.1.1"></eq><apply id="A2.p3.4.m4.1.1.2.cmml" xref="A2.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="A2.p3.4.m4.1.1.2.1.cmml" xref="A2.p3.4.m4.1.1.2">subscript</csymbol><ci id="A2.p3.4.m4.1.1.2.2.cmml" xref="A2.p3.4.m4.1.1.2.2">𝜇</ci><apply id="A2.p3.4.m4.1.1.2.3.cmml" xref="A2.p3.4.m4.1.1.2.3"><times id="A2.p3.4.m4.1.1.2.3.1.cmml" xref="A2.p3.4.m4.1.1.2.3.1"></times><ci id="A2.p3.4.m4.1.1.2.3.2.cmml" xref="A2.p3.4.m4.1.1.2.3.2">𝐹</ci><ci id="A2.p3.4.m4.1.1.2.3.3.cmml" xref="A2.p3.4.m4.1.1.2.3.3">𝑒</ci><ci id="A2.p3.4.m4.1.1.2.3.4.cmml" xref="A2.p3.4.m4.1.1.2.3.4">𝑑</ci><ci id="A2.p3.4.m4.1.1.2.3.5.cmml" xref="A2.p3.4.m4.1.1.2.3.5">𝑃</ci><ci id="A2.p3.4.m4.1.1.2.3.6.cmml" xref="A2.p3.4.m4.1.1.2.3.6">𝑟</ci><ci id="A2.p3.4.m4.1.1.2.3.7.cmml" xref="A2.p3.4.m4.1.1.2.3.7">𝑜</ci><ci id="A2.p3.4.m4.1.1.2.3.8.cmml" xref="A2.p3.4.m4.1.1.2.3.8">𝑥</ci></apply></apply><cn type="float" id="A2.p3.4.m4.1.1.3.cmml" xref="A2.p3.4.m4.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.4.m4.1c">\mu_{FedProx}=0.001</annotation></semantics></math> in <span id="A2.p3.8.3" class="ltx_text ltx_font_smallcaps">FedProx</span> and <math id="A2.p3.5.m5.1" class="ltx_Math" alttext="\alpha_{FedDyn}=0.01" display="inline"><semantics id="A2.p3.5.m5.1a"><mrow id="A2.p3.5.m5.1.1" xref="A2.p3.5.m5.1.1.cmml"><msub id="A2.p3.5.m5.1.1.2" xref="A2.p3.5.m5.1.1.2.cmml"><mi id="A2.p3.5.m5.1.1.2.2" xref="A2.p3.5.m5.1.1.2.2.cmml">α</mi><mrow id="A2.p3.5.m5.1.1.2.3" xref="A2.p3.5.m5.1.1.2.3.cmml"><mi id="A2.p3.5.m5.1.1.2.3.2" xref="A2.p3.5.m5.1.1.2.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="A2.p3.5.m5.1.1.2.3.1" xref="A2.p3.5.m5.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.5.m5.1.1.2.3.3" xref="A2.p3.5.m5.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="A2.p3.5.m5.1.1.2.3.1a" xref="A2.p3.5.m5.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.5.m5.1.1.2.3.4" xref="A2.p3.5.m5.1.1.2.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="A2.p3.5.m5.1.1.2.3.1b" xref="A2.p3.5.m5.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.5.m5.1.1.2.3.5" xref="A2.p3.5.m5.1.1.2.3.5.cmml">D</mi><mo lspace="0em" rspace="0em" id="A2.p3.5.m5.1.1.2.3.1c" xref="A2.p3.5.m5.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.5.m5.1.1.2.3.6" xref="A2.p3.5.m5.1.1.2.3.6.cmml">y</mi><mo lspace="0em" rspace="0em" id="A2.p3.5.m5.1.1.2.3.1d" xref="A2.p3.5.m5.1.1.2.3.1.cmml">​</mo><mi id="A2.p3.5.m5.1.1.2.3.7" xref="A2.p3.5.m5.1.1.2.3.7.cmml">n</mi></mrow></msub><mo id="A2.p3.5.m5.1.1.1" xref="A2.p3.5.m5.1.1.1.cmml">=</mo><mn id="A2.p3.5.m5.1.1.3" xref="A2.p3.5.m5.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p3.5.m5.1b"><apply id="A2.p3.5.m5.1.1.cmml" xref="A2.p3.5.m5.1.1"><eq id="A2.p3.5.m5.1.1.1.cmml" xref="A2.p3.5.m5.1.1.1"></eq><apply id="A2.p3.5.m5.1.1.2.cmml" xref="A2.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="A2.p3.5.m5.1.1.2.1.cmml" xref="A2.p3.5.m5.1.1.2">subscript</csymbol><ci id="A2.p3.5.m5.1.1.2.2.cmml" xref="A2.p3.5.m5.1.1.2.2">𝛼</ci><apply id="A2.p3.5.m5.1.1.2.3.cmml" xref="A2.p3.5.m5.1.1.2.3"><times id="A2.p3.5.m5.1.1.2.3.1.cmml" xref="A2.p3.5.m5.1.1.2.3.1"></times><ci id="A2.p3.5.m5.1.1.2.3.2.cmml" xref="A2.p3.5.m5.1.1.2.3.2">𝐹</ci><ci id="A2.p3.5.m5.1.1.2.3.3.cmml" xref="A2.p3.5.m5.1.1.2.3.3">𝑒</ci><ci id="A2.p3.5.m5.1.1.2.3.4.cmml" xref="A2.p3.5.m5.1.1.2.3.4">𝑑</ci><ci id="A2.p3.5.m5.1.1.2.3.5.cmml" xref="A2.p3.5.m5.1.1.2.3.5">𝐷</ci><ci id="A2.p3.5.m5.1.1.2.3.6.cmml" xref="A2.p3.5.m5.1.1.2.3.6">𝑦</ci><ci id="A2.p3.5.m5.1.1.2.3.7.cmml" xref="A2.p3.5.m5.1.1.2.3.7">𝑛</ci></apply></apply><cn type="float" id="A2.p3.5.m5.1.1.3.cmml" xref="A2.p3.5.m5.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.5.m5.1c">\alpha_{FedDyn}=0.01</annotation></semantics></math> in <span id="A2.p3.8.4" class="ltx_text ltx_font_smallcaps">FedDyn</span> as suggested in their official implementations or papers. For <span id="A2.p3.8.5" class="ltx_text ltx_font_smallcaps">Ditto</span>, the learning setting of the personalized model is the same as the one of the global model. For <span id="A2.p3.8.6" class="ltx_text ltx_font_smallcaps">FedRep</span>, the epoch number of the classifier training and the epoch number of the feature extractor training are the same and are set as <math id="A2.p3.6.m6.1" class="ltx_Math" alttext="E" display="inline"><semantics id="A2.p3.6.m6.1a"><mi id="A2.p3.6.m6.1.1" xref="A2.p3.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="A2.p3.6.m6.1b"><ci id="A2.p3.6.m6.1.1.cmml" xref="A2.p3.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.6.m6.1c">E</annotation></semantics></math>. For <span id="A2.p3.8.7" class="ltx_text ltx_font_smallcaps">FedRoD</span>, we set <math id="A2.p3.7.m7.1" class="ltx_Math" alttext="\gamma=1" display="inline"><semantics id="A2.p3.7.m7.1a"><mrow id="A2.p3.7.m7.1.1" xref="A2.p3.7.m7.1.1.cmml"><mi id="A2.p3.7.m7.1.1.2" xref="A2.p3.7.m7.1.1.2.cmml">γ</mi><mo id="A2.p3.7.m7.1.1.1" xref="A2.p3.7.m7.1.1.1.cmml">=</mo><mn id="A2.p3.7.m7.1.1.3" xref="A2.p3.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p3.7.m7.1b"><apply id="A2.p3.7.m7.1.1.cmml" xref="A2.p3.7.m7.1.1"><eq id="A2.p3.7.m7.1.1.1.cmml" xref="A2.p3.7.m7.1.1.1"></eq><ci id="A2.p3.7.m7.1.1.2.cmml" xref="A2.p3.7.m7.1.1.2">𝛾</ci><cn type="integer" id="A2.p3.7.m7.1.1.3.cmml" xref="A2.p3.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.7.m7.1c">\gamma=1</annotation></semantics></math>. For <span id="A2.p3.8.8" class="ltx_text ltx_font_smallcaps">CCVR</span>, the number of virtual features is 10 per class, and the number of classifier calibration training epochs is 100. For <span id="A2.p3.8.9" class="ltx_text ltx_font_smallcaps">FedNH</span>, the smoothing hyperparameter <math id="A2.p3.8.m8.1" class="ltx_Math" alttext="\rho=0.9" display="inline"><semantics id="A2.p3.8.m8.1a"><mrow id="A2.p3.8.m8.1.1" xref="A2.p3.8.m8.1.1.cmml"><mi id="A2.p3.8.m8.1.1.2" xref="A2.p3.8.m8.1.1.2.cmml">ρ</mi><mo id="A2.p3.8.m8.1.1.1" xref="A2.p3.8.m8.1.1.1.cmml">=</mo><mn id="A2.p3.8.m8.1.1.3" xref="A2.p3.8.m8.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p3.8.m8.1b"><apply id="A2.p3.8.m8.1.1.cmml" xref="A2.p3.8.m8.1.1"><eq id="A2.p3.8.m8.1.1.1.cmml" xref="A2.p3.8.m8.1.1.1"></eq><ci id="A2.p3.8.m8.1.1.2.cmml" xref="A2.p3.8.m8.1.1.2">𝜌</ci><cn type="float" id="A2.p3.8.m8.1.1.3.cmml" xref="A2.p3.8.m8.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p3.8.m8.1c">\rho=0.9</annotation></semantics></math> as suggested in the paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.</p>
</div>
<div id="A2.p4" class="ltx_para ltx_noindent">
<p id="A2.p4.2" class="ltx_p"><span id="A2.p4.2.1" class="ltx_text ltx_font_bold">Randomness.</span> We set the same random seeds for all methods in the same setting. The random seed list is <math id="A2.p4.1.m1.4" class="ltx_Math" alttext="\{7,8,9,10\}" display="inline"><semantics id="A2.p4.1.m1.4a"><mrow id="A2.p4.1.m1.4.5.2" xref="A2.p4.1.m1.4.5.1.cmml"><mo stretchy="false" id="A2.p4.1.m1.4.5.2.1" xref="A2.p4.1.m1.4.5.1.cmml">{</mo><mn id="A2.p4.1.m1.1.1" xref="A2.p4.1.m1.1.1.cmml">7</mn><mo id="A2.p4.1.m1.4.5.2.2" xref="A2.p4.1.m1.4.5.1.cmml">,</mo><mn id="A2.p4.1.m1.2.2" xref="A2.p4.1.m1.2.2.cmml">8</mn><mo id="A2.p4.1.m1.4.5.2.3" xref="A2.p4.1.m1.4.5.1.cmml">,</mo><mn id="A2.p4.1.m1.3.3" xref="A2.p4.1.m1.3.3.cmml">9</mn><mo id="A2.p4.1.m1.4.5.2.4" xref="A2.p4.1.m1.4.5.1.cmml">,</mo><mn id="A2.p4.1.m1.4.4" xref="A2.p4.1.m1.4.4.cmml">10</mn><mo stretchy="false" id="A2.p4.1.m1.4.5.2.5" xref="A2.p4.1.m1.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A2.p4.1.m1.4b"><set id="A2.p4.1.m1.4.5.1.cmml" xref="A2.p4.1.m1.4.5.2"><cn type="integer" id="A2.p4.1.m1.1.1.cmml" xref="A2.p4.1.m1.1.1">7</cn><cn type="integer" id="A2.p4.1.m1.2.2.cmml" xref="A2.p4.1.m1.2.2">8</cn><cn type="integer" id="A2.p4.1.m1.3.3.cmml" xref="A2.p4.1.m1.3.3">9</cn><cn type="integer" id="A2.p4.1.m1.4.4.cmml" xref="A2.p4.1.m1.4.4">10</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.1.m1.4c">\{7,8,9,10\}</annotation></semantics></math>. For the extremely Non-IID settings when <math id="A2.p4.2.m2.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="A2.p4.2.m2.1a"><mrow id="A2.p4.2.m2.1.1" xref="A2.p4.2.m2.1.1.cmml"><mi id="A2.p4.2.m2.1.1.2" xref="A2.p4.2.m2.1.1.2.cmml">α</mi><mo id="A2.p4.2.m2.1.1.1" xref="A2.p4.2.m2.1.1.1.cmml">=</mo><mn id="A2.p4.2.m2.1.1.3" xref="A2.p4.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.p4.2.m2.1b"><apply id="A2.p4.2.m2.1.1.cmml" xref="A2.p4.2.m2.1.1"><eq id="A2.p4.2.m2.1.1.1.cmml" xref="A2.p4.2.m2.1.1.1"></eq><ci id="A2.p4.2.m2.1.1.2.cmml" xref="A2.p4.2.m2.1.1.2">𝛼</ci><cn type="float" id="A2.p4.2.m2.1.1.3.cmml" xref="A2.p4.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.p4.2.m2.1c">\alpha=0.05</annotation></semantics></math>, we use the random seeds that can ensure all clients can be assigned a proportion of training data (on the contrary, some random seeds will generate a data partition where particular clients have zero data samples).</p>
</div>
<div id="A2.p5" class="ltx_para ltx_noindent">
<p id="A2.p5.1" class="ltx_p"><span id="A2.p5.1.1" class="ltx_text ltx_font_bold">Environments.</span> All experiments are conducted in PyTorch with Quadro RTX 8000 GPUs.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Visualization</h2>

<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Visualization of clients’ data distributions.</h3>

<div id="A3.SS1.p1" class="ltx_para">
<p id="A3.SS1.p1.2" class="ltx_p">Here, we additionally visualize the clients’ data distributions mainly adopted in the main paper. In the main paper, we adopt <math id="A3.SS1.p1.1.m1.2" class="ltx_Math" alttext="\alpha\in\{0.1,0.05\}" display="inline"><semantics id="A3.SS1.p1.1.m1.2a"><mrow id="A3.SS1.p1.1.m1.2.3" xref="A3.SS1.p1.1.m1.2.3.cmml"><mi id="A3.SS1.p1.1.m1.2.3.2" xref="A3.SS1.p1.1.m1.2.3.2.cmml">α</mi><mo id="A3.SS1.p1.1.m1.2.3.1" xref="A3.SS1.p1.1.m1.2.3.1.cmml">∈</mo><mrow id="A3.SS1.p1.1.m1.2.3.3.2" xref="A3.SS1.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="A3.SS1.p1.1.m1.2.3.3.2.1" xref="A3.SS1.p1.1.m1.2.3.3.1.cmml">{</mo><mn id="A3.SS1.p1.1.m1.1.1" xref="A3.SS1.p1.1.m1.1.1.cmml">0.1</mn><mo id="A3.SS1.p1.1.m1.2.3.3.2.2" xref="A3.SS1.p1.1.m1.2.3.3.1.cmml">,</mo><mn id="A3.SS1.p1.1.m1.2.2" xref="A3.SS1.p1.1.m1.2.2.cmml">0.05</mn><mo stretchy="false" id="A3.SS1.p1.1.m1.2.3.3.2.3" xref="A3.SS1.p1.1.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.1.m1.2b"><apply id="A3.SS1.p1.1.m1.2.3.cmml" xref="A3.SS1.p1.1.m1.2.3"><in id="A3.SS1.p1.1.m1.2.3.1.cmml" xref="A3.SS1.p1.1.m1.2.3.1"></in><ci id="A3.SS1.p1.1.m1.2.3.2.cmml" xref="A3.SS1.p1.1.m1.2.3.2">𝛼</ci><set id="A3.SS1.p1.1.m1.2.3.3.1.cmml" xref="A3.SS1.p1.1.m1.2.3.3.2"><cn type="float" id="A3.SS1.p1.1.m1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1">0.1</cn><cn type="float" id="A3.SS1.p1.1.m1.2.2.cmml" xref="A3.SS1.p1.1.m1.2.2">0.05</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.1.m1.2c">\alpha\in\{0.1,0.05\}</annotation></semantics></math> with 20 clients in Tables 1, 3, and 4. We visualize the data distributions in Figure <a href="#A1.F7" title="Figure 7 ‣ Appendix A Pseudo Codes of the Proposed Method ‣ No Fear of Classifier Biases: Neural Collapse Inspired Federated Learning with Synthetic and Fixed Classifier" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. It shows that in both settings, the clients have extremely heterogeneous data distributions. Especially when <math id="A3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="A3.SS1.p1.2.m2.1a"><mrow id="A3.SS1.p1.2.m2.1.1" xref="A3.SS1.p1.2.m2.1.1.cmml"><mi id="A3.SS1.p1.2.m2.1.1.2" xref="A3.SS1.p1.2.m2.1.1.2.cmml">α</mi><mo id="A3.SS1.p1.2.m2.1.1.1" xref="A3.SS1.p1.2.m2.1.1.1.cmml">=</mo><mn id="A3.SS1.p1.2.m2.1.1.3" xref="A3.SS1.p1.2.m2.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.2.m2.1b"><apply id="A3.SS1.p1.2.m2.1.1.cmml" xref="A3.SS1.p1.2.m2.1.1"><eq id="A3.SS1.p1.2.m2.1.1.1.cmml" xref="A3.SS1.p1.2.m2.1.1.1"></eq><ci id="A3.SS1.p1.2.m2.1.1.2.cmml" xref="A3.SS1.p1.2.m2.1.1.2">𝛼</ci><cn type="float" id="A3.SS1.p1.2.m2.1.1.3.cmml" xref="A3.SS1.p1.2.m2.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.2.m2.1c">\alpha=0.05</annotation></semantics></math>, all clients have some classes missing, and some clients have extremely rare data (e.g. client 1). We note that these settings are very realistic in practical FL scenarios.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.10057" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.10058" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.10058">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.10058" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.10059" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 19:37:58 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
