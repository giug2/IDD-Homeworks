<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2311.13665] A Joint Gradient and Loss Based Clustered Federated Learning Design</title><meta property="og:description" content="In this paper, a novel clustered FL framework that enables distributed edge devices with non-IID data to independently form several clusters in a distributed manner and implement FL training within each cluster is prop…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Joint Gradient and Loss Based Clustered Federated Learning Design">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="A Joint Gradient and Loss Based Clustered Federated Learning Design">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2311.13665">

<!--Generated on Tue Feb 27 17:38:48 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
clustered federated learning,  gradient and loss based distributed clustering, 
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">A Joint Gradient and Loss Based Clustered Federated Learning Design</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">

Licheng Lin1,
Mingzhe Chen12,
Zhaohui Yang3,
Yusen Wu2,
Yuchen Liu4
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><math id="id1.1.m1.1" class="ltx_Math" alttext="{1}" display="inline"><semantics id="id1.1.m1.1a"><mn id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><cn type="integer" id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">{1}</annotation></semantics></math>Department of Electrical and Computer Engineering,
University of Miami, Coral Gables, FL, 33146, USA

<br class="ltx_break"><math id="id2.2.m2.1" class="ltx_Math" alttext="{2}" display="inline"><semantics id="id2.2.m2.1a"><mn id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><cn type="integer" id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">{2}</annotation></semantics></math>Frost Institute for Data Science and Computing, University of Miami, Coral Gables, FL, 33146, USA,

<br class="ltx_break"><math id="id3.3.m3.1" class="ltx_Math" alttext="{3}" display="inline"><semantics id="id3.3.m3.1a"><mn id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="id3.3.m3.1b"><cn type="integer" id="id3.3.m3.1.1.cmml" xref="id3.3.m3.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.1c">{3}</annotation></semantics></math>College of Information Science and Electronic Engineering, Zhejiang University, Hangzhou, 310027, China,

<br class="ltx_break"><math id="id4.4.m4.1" class="ltx_Math" alttext="{4}" display="inline"><semantics id="id4.4.m4.1a"><mn id="id4.4.m4.1.1" xref="id4.4.m4.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="id4.4.m4.1b"><cn type="integer" id="id4.4.m4.1.1.cmml" xref="id4.4.m4.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="id4.4.m4.1c">{4}</annotation></semantics></math>Department of Computer Science, North Carolina State University, Raleigh, NC, 27695, USA

<br class="ltx_break">Emails: {lxl1293, mingzhe.chen, yxw1259}@miami.edu,
yang_zhaohui@zju.edu.cn,
yuchen.liu@ncsu.edu

</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id5.1" class="ltx_p">In this paper, a novel clustered FL framework that enables distributed edge devices with non-IID data to independently form several clusters in a distributed manner and implement FL training within each cluster is proposed.
In particular, our designed clustered FL algorithm must overcome two challenges associated with FL training.
First, the server has limited FL training information (i.e., the parameter server can only obtain the FL model information of each device) and limited computational power for finding the differences among a large amount of devices.
Second, each device does not have the data information of other devices for device clustering and can only use global FL model parameters received from the server and its data information to determine its cluster identity, which will increase the difficulty of device clustering.
To overcome these two challenges, we propose a joint gradient and loss based distributed clustering method in which each device determines its cluster identity considering the gradient similarity and training loss. The proposed clustering method not only considers how a local FL model of one device contributes to each cluster but also the direction of gradient descent thus improving clustering speed. By delegating clustering decisions to edge devices, each device can fully leverage its private data information to determine its own cluster identity, thereby reducing clustering overhead and improving overall clustering performance.
Simulation results demonstrate that our proposed clustered FL algorithm can reduce clustering iterations by up to <math id="id5.1.m1.1" class="ltx_Math" alttext="99" display="inline"><semantics id="id5.1.m1.1a"><mn id="id5.1.m1.1.1" xref="id5.1.m1.1.1.cmml">99</mn><annotation-xml encoding="MathML-Content" id="id5.1.m1.1b"><cn type="integer" id="id5.1.m1.1.1.cmml" xref="id5.1.m1.1.1">99</cn></annotation-xml><annotation encoding="application/x-tex" id="id5.1.m1.1c">99</annotation></semantics></math>% compared to the existing baseline.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
clustered federated learning, gradient and loss based distributed clustering,

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The development of mobile devices and video streaming applications (i.e., metaverse and virtual reality) motivates the development of distributed learning frameworks where devices can train their models locally using their own data. Federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> is a such decentralized learning algorithm that allows devices to collaboratively learn a shared machine learning (ML) model while keeping their data localized on their own devices.
However, standard FL may not be applied for devices with non independent and identically distributed (non-IID) data since a standard FL method directly aggregates the ML models of devices without considering the data distributions of devices. To address this problem, one promising solution is to cluster the devices according to their data distributions such that the devices in a cluster with similar data distributions can collaboratively train a ML model thus solving the non-IID problem and improving training performance. However, designing clustered FL algorithms still presents several challenges including:
1) The parameter server (PS) has limited information (i.e., FL model parameters) to determine cluster identities of all devices.
2) The PS has limited computational resource to identify differences among a large number of devices.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Recently, a number of existing works such as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> have studied the design and deployment of clustered FL over wireless networks.
In particular, the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> designed a clustered FL algorithm that first trains local models on each device, and then uses clustering algorithms such as k-means to cluster devices according to their locally trained convergent models.
The work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> developed a FL algorithm with hierarchical clustering approach. The designed algorithm first trains a global model over several FL training iterations and then clusters devices according to the similarities between updated local FL models.
The authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> designed a clustered FL framework in which an original cluster containing all devices is recursively divided into smaller sub-clusters. The device clustering starts when the FL models are stationary and ends when the gradient norm of any devices in the sub-cluster is below a preset threshold value.
The work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> designed a novel clustered FL which integrates the clustering algorithm into the training procedure, and to iteratively adjust the devices’ cluster identities through FL process.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, the authors investigated clustered FL under Byzantine attacks and shows that clustered FL can reliably detect and remove malicious clients.
The authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> introduced a clustering algorithm based on social awareness for clustered FL and developed a heuristic algorithm to minimize the training time per FL iteration. Meanwhile, the designed clustering method in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> can eliminate the need of a centralized PS.
The work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> designed a device selection approach for clustered FL to accelerate the convergence rate.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, a three-phased clustering algorithm based on generative adversarial network is introduced. The designed clustering method can create dynamic clusters and change the number of clusters over different iterations.
However, most of these existing works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> focused on the design of centralized clustering methods which may lead to significant communication and computational overhead. Meanwhile, these works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> considered the use of only local loss values of edge devices for device clustering without using other information (i.e., gradient vectors) of FL training.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The main contribution of this paper is a novel clustered FL framework that enables distributed edge devices with non-IID data to independently form several clusters in a distributed manner and implement FL training within each cluster. In particular, our designed clustered FL algorithm must overcome two challenges associated with FL training. First, the server has limited FL training information (i.e., the PS can only obtain the FL model information of each device) and limited computational power for finding the differences among a large amount of devices.
Second, each device does not have the data information of other devices for device clustering and can only use global FL model parameters received from the server and its data information to determine its cluster identity, which will increase the difficulty of device clustering.
To overcome these two challenges, we propose a joint gradient and loss based distributed clustering method in which each device determines its cluster identity considering the gradient similarity and training loss. The proposed clustering method not only considers how a local FL model of one device contributes to each cluster but also the direction of gradient descent thus improving clustering speed. By delegating clustering decisions to edge devices, each device can fully leverage its private data information to determine its own cluster identity, thereby reducing clustering overhead and improving overall clustering performance.
Simulation results over multiple datasets demonstrate that our proposed clustered FL algorithm can reduce the iterations required to cluster the devices correctly by up to <math id="S1.p3.1.m1.1" class="ltx_Math" alttext="99" display="inline"><semantics id="S1.p3.1.m1.1a"><mn id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml">99</mn><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><cn type="integer" id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1">99</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">99</annotation></semantics></math>% compared to the existing baseline.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The rest of the paper is organized as follows. The proposed clustered FL algorithm is described in Section <a href="#S2" title="II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. Simulation settings and results are introduced in Section <a href="#S3" title="III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. Conclusions are drawn in Section <a href="#S4" title="IV Conclusion ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2311.13665/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="221" height="192" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>A Framework of Clustered FL</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Proposed clustered FL System</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.4" class="ltx_p">Consider a clustered federated learning framework in which one parameter server and a set <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\mathcal{M}</annotation></semantics></math> of <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">M</annotation></semantics></math> devices collaboratively perform federated learning algorithms.
In our model, devices have different datasets and hence the data distribution of the devices is non-IID.
We assume that the total number of data distributions of all devices is <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">K</annotation></semantics></math>.
To address the data heterogeneity problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, devices should be divided into <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">K</annotation></semantics></math> clusters based on the characteristics of their datasets.
The devices with similar data distributions are clustered into a group and jointly perform an FL training.
In our model, we consider a general scenario where each device does not know the data distribution of other devices and the PS also does not know the data distributions of all devices.
Hence, the PS cannot directly determine the cluster of each device and each device must use its limited FL parameter information to determine its cluster.
To this end, it is necessary to design a novel clustered FL method where each device exploits its FL parameter information to determine its cluster individually.
Next, we introduce our designed clustered FL algorithm.
In particular, we first discuss the general process of clustered federated learning and then provide more details about the proposed clustering algorithm in clustered FL.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">General Procedure of Clustered FL</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Here, we introduce the general training process of clustered FL, which is summarized as follows:</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<ol id="S2.I1" class="ltx_enumerate">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.5" class="ltx_p">The server broadcast the parameters of <math id="S2.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.I1.i1.p1.1.m1.1a"><mi id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><ci id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">K</annotation></semantics></math> FL models to all devices. We assume that <math id="S2.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="w^{t}_{k}" display="inline"><semantics id="S2.I1.i1.p1.2.m2.1a"><msubsup id="S2.I1.i1.p1.2.m2.1.1" xref="S2.I1.i1.p1.2.m2.1.1.cmml"><mi id="S2.I1.i1.p1.2.m2.1.1.2.2" xref="S2.I1.i1.p1.2.m2.1.1.2.2.cmml">w</mi><mi id="S2.I1.i1.p1.2.m2.1.1.3" xref="S2.I1.i1.p1.2.m2.1.1.3.cmml">k</mi><mi id="S2.I1.i1.p1.2.m2.1.1.2.3" xref="S2.I1.i1.p1.2.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.2.m2.1b"><apply id="S2.I1.i1.p1.2.m2.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">subscript</csymbol><apply id="S2.I1.i1.p1.2.m2.1.1.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i1.p1.2.m2.1.1.2.1.cmml" xref="S2.I1.i1.p1.2.m2.1.1">superscript</csymbol><ci id="S2.I1.i1.p1.2.m2.1.1.2.2.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2.2">𝑤</ci><ci id="S2.I1.i1.p1.2.m2.1.1.2.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.2.3">𝑡</ci></apply><ci id="S2.I1.i1.p1.2.m2.1.1.3.cmml" xref="S2.I1.i1.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.2.m2.1c">w^{t}_{k}</annotation></semantics></math> represents the FL model parameters of cluster <math id="S2.I1.i1.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.I1.i1.p1.3.m3.1a"><mi id="S2.I1.i1.p1.3.m3.1.1" xref="S2.I1.i1.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.3.m3.1b"><ci id="S2.I1.i1.p1.3.m3.1.1.cmml" xref="S2.I1.i1.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.3.m3.1c">k</annotation></semantics></math> at iteration <math id="S2.I1.i1.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.I1.i1.p1.4.m4.1a"><mi id="S2.I1.i1.p1.4.m4.1.1" xref="S2.I1.i1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.4.m4.1b"><ci id="S2.I1.i1.p1.4.m4.1.1.cmml" xref="S2.I1.i1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.4.m4.1c">t</annotation></semantics></math>. Here, the set of devices at each group <math id="S2.I1.i1.p1.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.I1.i1.p1.5.m5.1a"><mi id="S2.I1.i1.p1.5.m5.1.1" xref="S2.I1.i1.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.5.m5.1b"><ci id="S2.I1.i1.p1.5.m5.1.1.cmml" xref="S2.I1.i1.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.5.m5.1c">k</annotation></semantics></math> may be changed according to the clustering results.</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.5" class="ltx_p">Each device <math id="S2.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="i\in\mathcal{M}" display="inline"><semantics id="S2.I1.i2.p1.1.m1.1a"><mrow id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml">i</mi><mo id="S2.I1.i2.p1.1.m1.1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><in id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1.1"></in><ci id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">𝑖</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">i\in\mathcal{M}</annotation></semantics></math> determines its cluster identity, i.e., which cluster it belongs to, via its private dataset and the model parameters received from the PS. Since this cluster identity would change through FL process, we denote the cluster identity of device <math id="S2.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.I1.i2.p1.2.m2.1a"><mi id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><ci id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">i</annotation></semantics></math> at <math id="S2.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.I1.i2.p1.3.m3.1a"><mi id="S2.I1.i2.p1.3.m3.1.1" xref="S2.I1.i2.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.1b"><ci id="S2.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.1c">t</annotation></semantics></math>-th iteration as <math id="S2.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="s_{i}^{t}" display="inline"><semantics id="S2.I1.i2.p1.4.m4.1a"><msubsup id="S2.I1.i2.p1.4.m4.1.1" xref="S2.I1.i2.p1.4.m4.1.1.cmml"><mi id="S2.I1.i2.p1.4.m4.1.1.2.2" xref="S2.I1.i2.p1.4.m4.1.1.2.2.cmml">s</mi><mi id="S2.I1.i2.p1.4.m4.1.1.2.3" xref="S2.I1.i2.p1.4.m4.1.1.2.3.cmml">i</mi><mi id="S2.I1.i2.p1.4.m4.1.1.3" xref="S2.I1.i2.p1.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m4.1b"><apply id="S2.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.4.m4.1.1.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.2.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.1.1.2.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.2.2">𝑠</ci><ci id="S2.I1.i2.p1.4.m4.1.1.2.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S2.I1.i2.p1.4.m4.1.1.3.cmml" xref="S2.I1.i2.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m4.1c">s_{i}^{t}</annotation></semantics></math>. Given its cluster identity <math id="S2.I1.i2.p1.5.m5.1" class="ltx_Math" alttext="s_{i}^{t}" display="inline"><semantics id="S2.I1.i2.p1.5.m5.1a"><msubsup id="S2.I1.i2.p1.5.m5.1.1" xref="S2.I1.i2.p1.5.m5.1.1.cmml"><mi id="S2.I1.i2.p1.5.m5.1.1.2.2" xref="S2.I1.i2.p1.5.m5.1.1.2.2.cmml">s</mi><mi id="S2.I1.i2.p1.5.m5.1.1.2.3" xref="S2.I1.i2.p1.5.m5.1.1.2.3.cmml">i</mi><mi id="S2.I1.i2.p1.5.m5.1.1.3" xref="S2.I1.i2.p1.5.m5.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.5.m5.1b"><apply id="S2.I1.i2.p1.5.m5.1.1.cmml" xref="S2.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.5.m5.1.1.1.cmml" xref="S2.I1.i2.p1.5.m5.1.1">superscript</csymbol><apply id="S2.I1.i2.p1.5.m5.1.1.2.cmml" xref="S2.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.5.m5.1.1.2.1.cmml" xref="S2.I1.i2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.5.m5.1.1.2.2.cmml" xref="S2.I1.i2.p1.5.m5.1.1.2.2">𝑠</ci><ci id="S2.I1.i2.p1.5.m5.1.1.2.3.cmml" xref="S2.I1.i2.p1.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S2.I1.i2.p1.5.m5.1.1.3.cmml" xref="S2.I1.i2.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.5.m5.1c">s_{i}^{t}</annotation></semantics></math>, each device will update its local FL model and transmit its FL parameters and cluster identity to the PS.</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S2.I1.i3.p1" class="ltx_para">
<p id="S2.I1.i3.p1.2" class="ltx_p">The PS will aggregate the FL parameters with the same cluster identity and generate a global FL model. Since the devices are divided into <math id="S2.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.I1.i3.p1.1.m1.1a"><mi id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><ci id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">K</annotation></semantics></math> clusters, the PS will generate <math id="S2.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.I1.i3.p1.2.m2.1a"><mi id="S2.I1.i3.p1.2.m2.1.1" xref="S2.I1.i3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.2.m2.1b"><ci id="S2.I1.i3.p1.2.m2.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.2.m2.1c">K</annotation></semantics></math> global FL models.</p>
</div>
</li>
<li id="S2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S2.I1.i4.p1" class="ltx_para">
<p id="S2.I1.i4.p1.1" class="ltx_p">Repeat Steps 1-3 until converge.</p>
</div>
</li>
</ol>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">From the training process of clustered FL, we see that clustered FL requires each device to use only its dataset and global FL models received from the PS to identify cluster identities and each device does not know the data distribution and cluster identify. Devices need to determine their clustering identities per iteration.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Proposed Clustered FL Algorithm</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Given the general process of clustered FL, in this subsection, we introduce our proposed clustered FL, which also consists of four steps: <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_italic">1)</span> cluster FL model broadcast, <span id="S2.SS2.p1.1.2" class="ltx_text ltx_font_italic">2)</span> device cluster identity determination, <span id="S2.SS2.p1.1.3" class="ltx_text ltx_font_italic">3)</span> local FL model update, and <span id="S2.SS2.p1.1.4" class="ltx_text ltx_font_italic">4)</span> local FL model aggregation, which are specified as follows.</p>
</div>
<section id="S2.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS2.SSS1.4.1.1" class="ltx_text">II-B</span>1 </span>Cluster model broadcast</h4>

<div id="S2.SS2.SSS1.p1" class="ltx_para">
<p id="S2.SS2.SSS1.p1.4" class="ltx_p">Since the devices are grouped into <math id="S2.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mi id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">K</annotation></semantics></math> clusters, the server will generate <math id="S2.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><mi id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><ci id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">K</annotation></semantics></math> initial global FL models for all clusters.
Hence, to implement our proposed clustered FL, the server will first broadcast the parameters of <math id="S2.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><mi id="S2.SS2.SSS1.p1.3.m3.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><ci id="S2.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">K</annotation></semantics></math> global FL models <math id="S2.SS2.SSS1.p1.4.m4.4" class="ltx_Math" alttext="\{\boldsymbol{w}_{1}^{t},\boldsymbol{w}_{2}^{t},\ldots,\boldsymbol{w}_{K}^{t}\}" display="inline"><semantics id="S2.SS2.SSS1.p1.4.m4.4a"><mrow id="S2.SS2.SSS1.p1.4.m4.4.4.3" xref="S2.SS2.SSS1.p1.4.m4.4.4.4.cmml"><mo stretchy="false" id="S2.SS2.SSS1.p1.4.m4.4.4.3.4" xref="S2.SS2.SSS1.p1.4.m4.4.4.4.cmml">{</mo><msubsup id="S2.SS2.SSS1.p1.4.m4.2.2.1.1" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.2" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.2.cmml">𝒘</mi><mn id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.3" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.3.cmml">1</mn><mi id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.3" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1.3.cmml">t</mi></msubsup><mo id="S2.SS2.SSS1.p1.4.m4.4.4.3.5" xref="S2.SS2.SSS1.p1.4.m4.4.4.4.cmml">,</mo><msubsup id="S2.SS2.SSS1.p1.4.m4.3.3.2.2" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.2" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.2.cmml">𝒘</mi><mn id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.3" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.3.cmml">2</mn><mi id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.3" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2.3.cmml">t</mi></msubsup><mo id="S2.SS2.SSS1.p1.4.m4.4.4.3.6" xref="S2.SS2.SSS1.p1.4.m4.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.SSS1.p1.4.m4.1.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.cmml">…</mi><mo id="S2.SS2.SSS1.p1.4.m4.4.4.3.7" xref="S2.SS2.SSS1.p1.4.m4.4.4.4.cmml">,</mo><msubsup id="S2.SS2.SSS1.p1.4.m4.4.4.3.3" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.2" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.3" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.3.cmml">K</mi><mi id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.3" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.SS2.SSS1.p1.4.m4.4.4.3.8" xref="S2.SS2.SSS1.p1.4.m4.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m4.4b"><set id="S2.SS2.SSS1.p1.4.m4.4.4.4.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4.3"><apply id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1">superscript</csymbol><apply id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.2">𝒘</ci><cn type="integer" id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1.2.3">1</cn></apply><ci id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1.3">𝑡</ci></apply><apply id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2">subscript</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.2">𝒘</ci><cn type="integer" id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS2.SSS1.p1.4.m4.3.3.2.2.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.3.3.2.2.3">𝑡</ci></apply><ci id="S2.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1">…</ci><apply id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3">superscript</csymbol><apply id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3">subscript</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.2">𝒘</ci><ci id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3.2.3">𝐾</ci></apply><ci id="S2.SS2.SSS1.p1.4.m4.4.4.3.3.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m4.4c">\{\boldsymbol{w}_{1}^{t},\boldsymbol{w}_{2}^{t},\ldots,\boldsymbol{w}_{K}^{t}\}</annotation></semantics></math> to the devices.</p>
</div>
</section>
<section id="S2.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS2.SSS2.4.1.1" class="ltx_text">II-B</span>2 </span>Determination of cluster identity for each device</h4>

<div id="S2.SS2.SSS2.p1" class="ltx_para">
<p id="S2.SS2.SSS2.p1.1" class="ltx_p">Given the training process of clustered FL, two challenge must be solved when we design the device clustering algorithm.
First, the device clustering method must be distributed since the server has limited FL training information (i.e., the PS can only obtain the FL model information of each device) and limited computational power for finding the differences among a large amount of devices.
Second, each device does not have the data information of other devices for device clustering and can only use global FL model parameters received from the server and its data information to determine its cluster identity, which will increase the difficulty of device clustering.
To overcome these two challenges, we propose a joint gradient and loss based distributed clustering method that consists of four steps: 1) Loss calculation, 2) Back-propagation, 3) Similarity calculation, and 4) Cluster identity determination, which are specified as follows:</p>
</div>
<div id="S2.SS2.SSS2.p2" class="ltx_para">
<p id="S2.SS2.SSS2.p2.4" class="ltx_p"><span id="S2.SS2.SSS2.p2.4.1" class="ltx_text ltx_font_bold">Step 1: Loss calculation</span> Given the parameters of <math id="S2.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.SSS2.p2.1.m1.1a"><mi id="S2.SS2.SSS2.p2.1.m1.1.1" xref="S2.SS2.SSS2.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.1.m1.1b"><ci id="S2.SS2.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.1.m1.1c">K</annotation></semantics></math> FL models, <math id="S2.SS2.SSS2.p2.2.m2.4" class="ltx_Math" alttext="\{\boldsymbol{w}_{1}^{t},\boldsymbol{w}_{2}^{t},\ldots,\boldsymbol{w}_{K}^{t}\}" display="inline"><semantics id="S2.SS2.SSS2.p2.2.m2.4a"><mrow id="S2.SS2.SSS2.p2.2.m2.4.4.3" xref="S2.SS2.SSS2.p2.2.m2.4.4.4.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p2.2.m2.4.4.3.4" xref="S2.SS2.SSS2.p2.2.m2.4.4.4.cmml">{</mo><msubsup id="S2.SS2.SSS2.p2.2.m2.2.2.1.1" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1.cmml"><mi id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.2" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.2.cmml">𝒘</mi><mn id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.3" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.3.cmml">1</mn><mi id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.3" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1.3.cmml">t</mi></msubsup><mo id="S2.SS2.SSS2.p2.2.m2.4.4.3.5" xref="S2.SS2.SSS2.p2.2.m2.4.4.4.cmml">,</mo><msubsup id="S2.SS2.SSS2.p2.2.m2.3.3.2.2" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2.cmml"><mi id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.2" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.2.cmml">𝒘</mi><mn id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.3" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.3.cmml">2</mn><mi id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.3" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2.3.cmml">t</mi></msubsup><mo id="S2.SS2.SSS2.p2.2.m2.4.4.3.6" xref="S2.SS2.SSS2.p2.2.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.SSS2.p2.2.m2.1.1" xref="S2.SS2.SSS2.p2.2.m2.1.1.cmml">…</mi><mo id="S2.SS2.SSS2.p2.2.m2.4.4.3.7" xref="S2.SS2.SSS2.p2.2.m2.4.4.4.cmml">,</mo><msubsup id="S2.SS2.SSS2.p2.2.m2.4.4.3.3" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3.cmml"><mi id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.2" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.3" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.3.cmml">K</mi><mi id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.3" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.SS2.SSS2.p2.2.m2.4.4.3.8" xref="S2.SS2.SSS2.p2.2.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.2.m2.4b"><set id="S2.SS2.SSS2.p2.2.m2.4.4.4.cmml" xref="S2.SS2.SSS2.p2.2.m2.4.4.3"><apply id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.2">𝒘</ci><cn type="integer" id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1.2.3">1</cn></apply><ci id="S2.SS2.SSS2.p2.2.m2.2.2.1.1.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.2.2.1.1.3">𝑡</ci></apply><apply id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2">superscript</csymbol><apply id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.2">𝒘</ci><cn type="integer" id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S2.SS2.SSS2.p2.2.m2.3.3.2.2.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.3.3.2.2.3">𝑡</ci></apply><ci id="S2.SS2.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.1.1">…</ci><apply id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3">superscript</csymbol><apply id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.1.cmml" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3">subscript</csymbol><ci id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.2.cmml" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3.2.3">𝐾</ci></apply><ci id="S2.SS2.SSS2.p2.2.m2.4.4.3.3.3.cmml" xref="S2.SS2.SSS2.p2.2.m2.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.2.m2.4c">\{\boldsymbol{w}_{1}^{t},\boldsymbol{w}_{2}^{t},\ldots,\boldsymbol{w}_{K}^{t}\}</annotation></semantics></math>, device <math id="S2.SS2.SSS2.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.SSS2.p2.3.m3.1a"><mi id="S2.SS2.SSS2.p2.3.m3.1.1" xref="S2.SS2.SSS2.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.3.m3.1b"><ci id="S2.SS2.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.3.m3.1c">i</annotation></semantics></math> first calculates the loss with respect to each global FL model using a mini-batch of local data samples <math id="S2.SS2.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{Z}_{i}^{t}" display="inline"><semantics id="S2.SS2.SSS2.p2.4.m4.1a"><msubsup id="S2.SS2.SSS2.p2.4.m4.1.1" xref="S2.SS2.SSS2.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p2.4.m4.1.1.2.2" xref="S2.SS2.SSS2.p2.4.m4.1.1.2.2.cmml">𝒵</mi><mi id="S2.SS2.SSS2.p2.4.m4.1.1.2.3" xref="S2.SS2.SSS2.p2.4.m4.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS2.p2.4.m4.1.1.3" xref="S2.SS2.SSS2.p2.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.4.m4.1b"><apply id="S2.SS2.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.4.m4.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.4.m4.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1.2.2">𝒵</ci><ci id="S2.SS2.SSS2.p2.4.m4.1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.4.m4.1c">\mathcal{Z}_{i}^{t}</annotation></semantics></math>, as follows:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.8" class="ltx_Math" alttext="\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t})=\sum_{\boldsymbol{z}\in\mathcal{Z}_{i}^{t}}l(\boldsymbol{w}_{k}^{t},\boldsymbol{z}),\forall k=1,2,\ldots,K." display="block"><semantics id="S2.E1.m1.8a"><mrow id="S2.E1.m1.8.8.1"><mrow id="S2.E1.m1.8.8.1.1.2" xref="S2.E1.m1.8.8.1.1.3.cmml"><mrow id="S2.E1.m1.8.8.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.cmml"><mrow id="S2.E1.m1.8.8.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.cmml"><msubsup id="S2.E1.m1.8.8.1.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.8.8.1.1.1.1.1.3.2.2" xref="S2.E1.m1.8.8.1.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">i</mi><mo id="S2.E1.m1.2.2.2.4.1" xref="S2.E1.m1.2.2.2.3.cmml">,</mo><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">k</mi></mrow><mi id="S2.E1.m1.8.8.1.1.1.1.1.3.3" xref="S2.E1.m1.8.8.1.1.1.1.1.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml">𝒵</mi><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S2.E1.m1.8.8.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.2.cmml"><munder id="S2.E1.m1.8.8.1.1.1.1.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.cmml"><mo movablelimits="false" id="S2.E1.m1.8.8.1.1.1.1.2.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.2.2.3" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.2.2.3.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.2.cmml">𝒛</mi><mo id="S2.E1.m1.8.8.1.1.1.1.2.2.3.1" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.1.cmml">∈</mo><msubsup id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.2.cmml">𝒵</mi><mi id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.3" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.3.cmml">i</mi><mi id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.3" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.3.cmml">t</mi></msubsup></mrow></munder><mrow id="S2.E1.m1.8.8.1.1.1.1.2.1" xref="S2.E1.m1.8.8.1.1.1.1.2.1.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.2.1.3" xref="S2.E1.m1.8.8.1.1.1.1.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.8.8.1.1.1.1.2.1.2" xref="S2.E1.m1.8.8.1.1.1.1.2.1.2.cmml">​</mo><mrow id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.2" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.2.cmml">(</mo><msubsup id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.cmml"><mi id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.2" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.2.cmml">𝒘</mi><mi id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.3" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.3.cmml">k</mi><mi id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.3.cmml">t</mi></msubsup><mo id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.3" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.2.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">𝒛</mi><mo stretchy="false" id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.4" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.8.8.1.1.2.3" xref="S2.E1.m1.8.8.1.1.3a.cmml">,</mo><mrow id="S2.E1.m1.8.8.1.1.2.2" xref="S2.E1.m1.8.8.1.1.2.2.cmml"><mrow id="S2.E1.m1.8.8.1.1.2.2.2" xref="S2.E1.m1.8.8.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S2.E1.m1.8.8.1.1.2.2.2.1" xref="S2.E1.m1.8.8.1.1.2.2.2.1.cmml">∀</mo><mi id="S2.E1.m1.8.8.1.1.2.2.2.2" xref="S2.E1.m1.8.8.1.1.2.2.2.2.cmml">k</mi></mrow><mo id="S2.E1.m1.8.8.1.1.2.2.1" xref="S2.E1.m1.8.8.1.1.2.2.1.cmml">=</mo><mrow id="S2.E1.m1.8.8.1.1.2.2.3.2" xref="S2.E1.m1.8.8.1.1.2.2.3.1.cmml"><mn id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">1</mn><mo id="S2.E1.m1.8.8.1.1.2.2.3.2.1" xref="S2.E1.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mn id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">2</mn><mo id="S2.E1.m1.8.8.1.1.2.2.3.2.2" xref="S2.E1.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml">…</mi><mo id="S2.E1.m1.8.8.1.1.2.2.3.2.3" xref="S2.E1.m1.8.8.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E1.m1.7.7" xref="S2.E1.m1.7.7.cmml">K</mi></mrow></mrow></mrow><mo lspace="0em" id="S2.E1.m1.8.8.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.8b"><apply id="S2.E1.m1.8.8.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.3a.cmml" xref="S2.E1.m1.8.8.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.8.8.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1"><eq id="S2.E1.m1.8.8.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.3"></eq><apply id="S2.E1.m1.8.8.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1"><times id="S2.E1.m1.8.8.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.2"></times><apply id="S2.E1.m1.8.8.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E1.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3.2.2">ℒ</ci><list id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.4"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑖</ci><ci id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S2.E1.m1.8.8.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.2">𝒵</ci><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.E1.m1.8.8.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2"><apply id="S2.E1.m1.8.8.1.1.1.1.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2">subscript</csymbol><sum id="S2.E1.m1.8.8.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.8.8.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3"><in id="S2.E1.m1.8.8.1.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.1"></in><ci id="S2.E1.m1.8.8.1.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.2">𝒛</ci><apply id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3">superscript</csymbol><apply id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.2">𝒵</ci><ci id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.2.3">𝑖</ci></apply><ci id="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S2.E1.m1.8.8.1.1.1.1.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1"><times id="S2.E1.m1.8.8.1.1.1.1.2.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.2"></times><ci id="S2.E1.m1.8.8.1.1.1.1.2.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.3">𝑙</ci><interval closure="open" id="S2.E1.m1.8.8.1.1.1.1.2.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1"><apply id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.2">𝒘</ci><ci id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.2.3">𝑘</ci></apply><ci id="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.3.cmml" xref="S2.E1.m1.8.8.1.1.1.1.2.1.1.1.1.3">𝑡</ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝒛</ci></interval></apply></apply></apply><apply id="S2.E1.m1.8.8.1.1.2.2.cmml" xref="S2.E1.m1.8.8.1.1.2.2"><eq id="S2.E1.m1.8.8.1.1.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.2.2.1"></eq><apply id="S2.E1.m1.8.8.1.1.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.2.2.2"><csymbol cd="latexml" id="S2.E1.m1.8.8.1.1.2.2.2.1.cmml" xref="S2.E1.m1.8.8.1.1.2.2.2.1">for-all</csymbol><ci id="S2.E1.m1.8.8.1.1.2.2.2.2.cmml" xref="S2.E1.m1.8.8.1.1.2.2.2.2">𝑘</ci></apply><list id="S2.E1.m1.8.8.1.1.2.2.3.1.cmml" xref="S2.E1.m1.8.8.1.1.2.2.3.2"><cn type="integer" id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">1</cn><cn type="integer" id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">2</cn><ci id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6">…</ci><ci id="S2.E1.m1.7.7.cmml" xref="S2.E1.m1.7.7">𝐾</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.8c">\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t})=\sum_{\boldsymbol{z}\in\mathcal{Z}_{i}^{t}}l(\boldsymbol{w}_{k}^{t},\boldsymbol{z}),\forall k=1,2,\ldots,K.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS2.p2.9" class="ltx_p">where <math id="S2.SS2.SSS2.p2.5.m1.1" class="ltx_Math" alttext="\boldsymbol{z}" display="inline"><semantics id="S2.SS2.SSS2.p2.5.m1.1a"><mi id="S2.SS2.SSS2.p2.5.m1.1.1" xref="S2.SS2.SSS2.p2.5.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.5.m1.1b"><ci id="S2.SS2.SSS2.p2.5.m1.1.1.cmml" xref="S2.SS2.SSS2.p2.5.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.5.m1.1c">\boldsymbol{z}</annotation></semantics></math> is a single sample in <math id="S2.SS2.SSS2.p2.6.m2.1" class="ltx_Math" alttext="\mathcal{Z}_{i}^{t}" display="inline"><semantics id="S2.SS2.SSS2.p2.6.m2.1a"><msubsup id="S2.SS2.SSS2.p2.6.m2.1.1" xref="S2.SS2.SSS2.p2.6.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p2.6.m2.1.1.2.2" xref="S2.SS2.SSS2.p2.6.m2.1.1.2.2.cmml">𝒵</mi><mi id="S2.SS2.SSS2.p2.6.m2.1.1.2.3" xref="S2.SS2.SSS2.p2.6.m2.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS2.p2.6.m2.1.1.3" xref="S2.SS2.SSS2.p2.6.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.6.m2.1b"><apply id="S2.SS2.SSS2.p2.6.m2.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.6.m2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p2.6.m2.1.1.2.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.6.m2.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.6.m2.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1.2.2">𝒵</ci><ci id="S2.SS2.SSS2.p2.6.m2.1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS2.p2.6.m2.1.1.3.cmml" xref="S2.SS2.SSS2.p2.6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.6.m2.1c">\mathcal{Z}_{i}^{t}</annotation></semantics></math>, and <math id="S2.SS2.SSS2.p2.7.m3.2" class="ltx_Math" alttext="l(\boldsymbol{w}_{k}^{t},\boldsymbol{z})" display="inline"><semantics id="S2.SS2.SSS2.p2.7.m3.2a"><mrow id="S2.SS2.SSS2.p2.7.m3.2.2" xref="S2.SS2.SSS2.p2.7.m3.2.2.cmml"><mi id="S2.SS2.SSS2.p2.7.m3.2.2.3" xref="S2.SS2.SSS2.p2.7.m3.2.2.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p2.7.m3.2.2.2" xref="S2.SS2.SSS2.p2.7.m3.2.2.2.cmml">​</mo><mrow id="S2.SS2.SSS2.p2.7.m3.2.2.1.1" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.2" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.2.cmml">(</mo><msubsup id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.cmml"><mi id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.2" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.3" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.3.cmml">k</mi><mi id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.3" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.3.cmml">t</mi></msubsup><mo id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.3" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.2.cmml">,</mo><mi id="S2.SS2.SSS2.p2.7.m3.1.1" xref="S2.SS2.SSS2.p2.7.m3.1.1.cmml">𝒛</mi><mo stretchy="false" id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.4" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.7.m3.2b"><apply id="S2.SS2.SSS2.p2.7.m3.2.2.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2"><times id="S2.SS2.SSS2.p2.7.m3.2.2.2.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.2"></times><ci id="S2.SS2.SSS2.p2.7.m3.2.2.3.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.3">𝑙</ci><interval closure="open" id="S2.SS2.SSS2.p2.7.m3.2.2.1.2.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1"><apply id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.1.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.3.cmml" xref="S2.SS2.SSS2.p2.7.m3.2.2.1.1.1.3">𝑡</ci></apply><ci id="S2.SS2.SSS2.p2.7.m3.1.1.cmml" xref="S2.SS2.SSS2.p2.7.m3.1.1">𝒛</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.7.m3.2c">l(\boldsymbol{w}_{k}^{t},\boldsymbol{z})</annotation></semantics></math> is the loss value of model <math id="S2.SS2.SSS2.p2.8.m4.1" class="ltx_Math" alttext="\boldsymbol{w}_{k}^{t}" display="inline"><semantics id="S2.SS2.SSS2.p2.8.m4.1a"><msubsup id="S2.SS2.SSS2.p2.8.m4.1.1" xref="S2.SS2.SSS2.p2.8.m4.1.1.cmml"><mi id="S2.SS2.SSS2.p2.8.m4.1.1.2.2" xref="S2.SS2.SSS2.p2.8.m4.1.1.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p2.8.m4.1.1.2.3" xref="S2.SS2.SSS2.p2.8.m4.1.1.2.3.cmml">k</mi><mi id="S2.SS2.SSS2.p2.8.m4.1.1.3" xref="S2.SS2.SSS2.p2.8.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.8.m4.1b"><apply id="S2.SS2.SSS2.p2.8.m4.1.1.cmml" xref="S2.SS2.SSS2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.8.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p2.8.m4.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p2.8.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p2.8.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p2.8.m4.1.1.2.1.cmml" xref="S2.SS2.SSS2.p2.8.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p2.8.m4.1.1.2.2.cmml" xref="S2.SS2.SSS2.p2.8.m4.1.1.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p2.8.m4.1.1.2.3.cmml" xref="S2.SS2.SSS2.p2.8.m4.1.1.2.3">𝑘</ci></apply><ci id="S2.SS2.SSS2.p2.8.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p2.8.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.8.m4.1c">\boldsymbol{w}_{k}^{t}</annotation></semantics></math> with data sample <math id="S2.SS2.SSS2.p2.9.m5.1" class="ltx_Math" alttext="\boldsymbol{z}" display="inline"><semantics id="S2.SS2.SSS2.p2.9.m5.1a"><mi id="S2.SS2.SSS2.p2.9.m5.1.1" xref="S2.SS2.SSS2.p2.9.m5.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p2.9.m5.1b"><ci id="S2.SS2.SSS2.p2.9.m5.1.1.cmml" xref="S2.SS2.SSS2.p2.9.m5.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p2.9.m5.1c">\boldsymbol{z}</annotation></semantics></math>.</p>
</div>
<div id="S2.SS2.SSS2.p3" class="ltx_para">
<p id="S2.SS2.SSS2.p3.6" class="ltx_p"><span id="S2.SS2.SSS2.p3.6.1" class="ltx_text ltx_font_bold">Step 2 Back-propagation: </span> Next, device <math id="S2.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.SSS2.p3.1.m1.1a"><mi id="S2.SS2.SSS2.p3.1.m1.1.1" xref="S2.SS2.SSS2.p3.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.1.m1.1b"><ci id="S2.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p3.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.1.m1.1c">i</annotation></semantics></math> can calculate the gradients of <math id="S2.SS2.SSS2.p3.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS2.SSS2.p3.2.m2.1a"><mi id="S2.SS2.SSS2.p3.2.m2.1.1" xref="S2.SS2.SSS2.p3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.2.m2.1b"><ci id="S2.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p3.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.2.m2.1c">K</annotation></semantics></math> FL models based on the loss values obtained in the first step via back-propagation algorithm. In particular, we assume that the gradient of loss function <math id="S2.SS2.SSS2.p3.3.m3.3" class="ltx_Math" alttext="\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t})" display="inline"><semantics id="S2.SS2.SSS2.p3.3.m3.3a"><mrow id="S2.SS2.SSS2.p3.3.m3.3.3" xref="S2.SS2.SSS2.p3.3.m3.3.3.cmml"><msubsup id="S2.SS2.SSS2.p3.3.m3.3.3.3" xref="S2.SS2.SSS2.p3.3.m3.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p3.3.m3.3.3.3.2.2" xref="S2.SS2.SSS2.p3.3.m3.3.3.3.2.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p3.3.m3.2.2.2.4" xref="S2.SS2.SSS2.p3.3.m3.2.2.2.3.cmml"><mi id="S2.SS2.SSS2.p3.3.m3.1.1.1.1" xref="S2.SS2.SSS2.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p3.3.m3.2.2.2.4.1" xref="S2.SS2.SSS2.p3.3.m3.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS2.p3.3.m3.2.2.2.2" xref="S2.SS2.SSS2.p3.3.m3.2.2.2.2.cmml">k</mi></mrow><mi id="S2.SS2.SSS2.p3.3.m3.3.3.3.3" xref="S2.SS2.SSS2.p3.3.m3.3.3.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p3.3.m3.3.3.2" xref="S2.SS2.SSS2.p3.3.m3.3.3.2.cmml">​</mo><mrow id="S2.SS2.SSS2.p3.3.m3.3.3.1.1" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.2" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.cmml">(</mo><msubsup id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.2" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.2.cmml">𝒵</mi><mi id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.3" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.3" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.3" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.3.m3.3b"><apply id="S2.SS2.SSS2.p3.3.m3.3.3.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3"><times id="S2.SS2.SSS2.p3.3.m3.3.3.2.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.2"></times><apply id="S2.SS2.SSS2.p3.3.m3.3.3.3.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.3.m3.3.3.3.1.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.3">superscript</csymbol><apply id="S2.SS2.SSS2.p3.3.m3.3.3.3.2.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.3.m3.3.3.3.2.1.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.3">subscript</csymbol><ci id="S2.SS2.SSS2.p3.3.m3.3.3.3.2.2.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.3.2.2">ℒ</ci><list id="S2.SS2.SSS2.p3.3.m3.2.2.2.3.cmml" xref="S2.SS2.SSS2.p3.3.m3.2.2.2.4"><ci id="S2.SS2.SSS2.p3.3.m3.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.3.m3.1.1.1.1">𝑖</ci><ci id="S2.SS2.SSS2.p3.3.m3.2.2.2.2.cmml" xref="S2.SS2.SSS2.p3.3.m3.2.2.2.2">𝑘</ci></list></apply><ci id="S2.SS2.SSS2.p3.3.m3.3.3.3.3.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.3.3">𝑡</ci></apply><apply id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.2">𝒵</ci><ci id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.3.cmml" xref="S2.SS2.SSS2.p3.3.m3.3.3.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.3.m3.3c">\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t})</annotation></semantics></math> with respect to the global FL model <math id="S2.SS2.SSS2.p3.4.m4.1" class="ltx_Math" alttext="\boldsymbol{w}_{k}^{t}" display="inline"><semantics id="S2.SS2.SSS2.p3.4.m4.1a"><msubsup id="S2.SS2.SSS2.p3.4.m4.1.1" xref="S2.SS2.SSS2.p3.4.m4.1.1.cmml"><mi id="S2.SS2.SSS2.p3.4.m4.1.1.2.2" xref="S2.SS2.SSS2.p3.4.m4.1.1.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p3.4.m4.1.1.2.3" xref="S2.SS2.SSS2.p3.4.m4.1.1.2.3.cmml">k</mi><mi id="S2.SS2.SSS2.p3.4.m4.1.1.3" xref="S2.SS2.SSS2.p3.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.4.m4.1b"><apply id="S2.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.4.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p3.4.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.4.m4.1.1.2.1.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.4.m4.1.1.2.2.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p3.4.m4.1.1.2.3.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S2.SS2.SSS2.p3.4.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p3.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.4.m4.1c">\boldsymbol{w}_{k}^{t}</annotation></semantics></math> at device <math id="S2.SS2.SSS2.p3.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.SSS2.p3.5.m5.1a"><mi id="S2.SS2.SSS2.p3.5.m5.1.1" xref="S2.SS2.SSS2.p3.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.5.m5.1b"><ci id="S2.SS2.SSS2.p3.5.m5.1.1.cmml" xref="S2.SS2.SSS2.p3.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.5.m5.1c">i</annotation></semantics></math> is <math id="S2.SS2.SSS2.p3.6.m6.7" class="ltx_Math" alttext="\nabla\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t}),\forall k=1,2,\ldots,K" display="inline"><semantics id="S2.SS2.SSS2.p3.6.m6.7a"><mrow id="S2.SS2.SSS2.p3.6.m6.7.7.2" xref="S2.SS2.SSS2.p3.6.m6.7.7.3.cmml"><mrow id="S2.SS2.SSS2.p3.6.m6.6.6.1.1" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.cmml"><mrow id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.3.cmml"><mrow id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.cmml"><mrow id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.cmml"><mo rspace="0.167em" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.1" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.1.cmml">∇</mo><msubsup id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.2.2" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.2.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p3.6.m6.2.2.2.4" xref="S2.SS2.SSS2.p3.6.m6.2.2.2.3.cmml"><mi id="S2.SS2.SSS2.p3.6.m6.1.1.1.1" xref="S2.SS2.SSS2.p3.6.m6.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p3.6.m6.2.2.2.4.1" xref="S2.SS2.SSS2.p3.6.m6.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS2.p3.6.m6.2.2.2.2" xref="S2.SS2.SSS2.p3.6.m6.2.2.2.2.cmml">k</mi></mrow><mi id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.3" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.2" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.2" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.2.cmml">𝒵</mi><mi id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.3" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.3" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.3" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.3.cmml">,</mo><mrow id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.1" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.1.cmml">∀</mo><mi id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.2" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.2.cmml">k</mi></mrow></mrow><mo id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.3" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.3.cmml">=</mo><mn id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.4" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.4.cmml">1</mn></mrow><mo id="S2.SS2.SSS2.p3.6.m6.7.7.2.3" xref="S2.SS2.SSS2.p3.6.m6.7.7.3a.cmml">,</mo><mrow id="S2.SS2.SSS2.p3.6.m6.7.7.2.2.2" xref="S2.SS2.SSS2.p3.6.m6.7.7.2.2.1.cmml"><mn id="S2.SS2.SSS2.p3.6.m6.3.3" xref="S2.SS2.SSS2.p3.6.m6.3.3.cmml">2</mn><mo id="S2.SS2.SSS2.p3.6.m6.7.7.2.2.2.1" xref="S2.SS2.SSS2.p3.6.m6.7.7.2.2.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.SSS2.p3.6.m6.4.4" xref="S2.SS2.SSS2.p3.6.m6.4.4.cmml">…</mi><mo id="S2.SS2.SSS2.p3.6.m6.7.7.2.2.2.2" xref="S2.SS2.SSS2.p3.6.m6.7.7.2.2.1.cmml">,</mo><mi id="S2.SS2.SSS2.p3.6.m6.5.5" xref="S2.SS2.SSS2.p3.6.m6.5.5.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p3.6.m6.7b"><apply id="S2.SS2.SSS2.p3.6.m6.7.7.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.7.7.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.6.m6.7.7.3a.cmml" xref="S2.SS2.SSS2.p3.6.m6.7.7.2.3">formulae-sequence</csymbol><apply id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1"><eq id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.3"></eq><list id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2"><apply id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1"><times id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.2"></times><apply id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3"><ci id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.1">∇</ci><apply id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2">superscript</csymbol><apply id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.2.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.2.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.2.2">ℒ</ci><list id="S2.SS2.SSS2.p3.6.m6.2.2.2.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.2.2.2.4"><ci id="S2.SS2.SSS2.p3.6.m6.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.1.1.1.1">𝑖</ci><ci id="S2.SS2.SSS2.p3.6.m6.2.2.2.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.2.2.2.2">𝑘</ci></list></apply><ci id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.2">𝒵</ci><ci id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2"><csymbol cd="latexml" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.1">for-all</csymbol><ci id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.2.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.2.2.2.2">𝑘</ci></apply></list><cn type="integer" id="S2.SS2.SSS2.p3.6.m6.6.6.1.1.4.cmml" xref="S2.SS2.SSS2.p3.6.m6.6.6.1.1.4">1</cn></apply><list id="S2.SS2.SSS2.p3.6.m6.7.7.2.2.1.cmml" xref="S2.SS2.SSS2.p3.6.m6.7.7.2.2.2"><cn type="integer" id="S2.SS2.SSS2.p3.6.m6.3.3.cmml" xref="S2.SS2.SSS2.p3.6.m6.3.3">2</cn><ci id="S2.SS2.SSS2.p3.6.m6.4.4.cmml" xref="S2.SS2.SSS2.p3.6.m6.4.4">…</ci><ci id="S2.SS2.SSS2.p3.6.m6.5.5.cmml" xref="S2.SS2.SSS2.p3.6.m6.5.5">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p3.6.m6.7c">\nabla\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t}),\forall k=1,2,\ldots,K</annotation></semantics></math></p>
</div>
<div id="S2.SS2.SSS2.p4" class="ltx_para">
<p id="S2.SS2.SSS2.p4.6" class="ltx_p"><span id="S2.SS2.SSS2.p4.6.1" class="ltx_text ltx_font_bold">Step 3 Similarity calculation: </span> The gap between the global FL model <math id="S2.SS2.SSS2.p4.1.m1.1" class="ltx_Math" alttext="\boldsymbol{w}_{k}^{t}" display="inline"><semantics id="S2.SS2.SSS2.p4.1.m1.1a"><msubsup id="S2.SS2.SSS2.p4.1.m1.1.1" xref="S2.SS2.SSS2.p4.1.m1.1.1.cmml"><mi id="S2.SS2.SSS2.p4.1.m1.1.1.2.2" xref="S2.SS2.SSS2.p4.1.m1.1.1.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p4.1.m1.1.1.2.3" xref="S2.SS2.SSS2.p4.1.m1.1.1.2.3.cmml">k</mi><mi id="S2.SS2.SSS2.p4.1.m1.1.1.3" xref="S2.SS2.SSS2.p4.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.1.m1.1b"><apply id="S2.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.1.m1.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.1.m1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p4.1.m1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p4.1.m1.1.1.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p4.1.m1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p4.1.m1.1.1.2.3">𝑘</ci></apply><ci id="S2.SS2.SSS2.p4.1.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p4.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.1.m1.1c">\boldsymbol{w}_{k}^{t}</annotation></semantics></math> of cluster <math id="S2.SS2.SSS2.p4.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.SSS2.p4.2.m2.1a"><mi id="S2.SS2.SSS2.p4.2.m2.1.1" xref="S2.SS2.SSS2.p4.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.2.m2.1b"><ci id="S2.SS2.SSS2.p4.2.m2.1.1.cmml" xref="S2.SS2.SSS2.p4.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.2.m2.1c">k</annotation></semantics></math> at iteration <math id="S2.SS2.SSS2.p4.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.SSS2.p4.3.m3.1a"><mi id="S2.SS2.SSS2.p4.3.m3.1.1" xref="S2.SS2.SSS2.p4.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.3.m3.1b"><ci id="S2.SS2.SSS2.p4.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p4.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.3.m3.1c">t</annotation></semantics></math> and the global FL model <math id="S2.SS2.SSS2.p4.4.m4.1" class="ltx_Math" alttext="\boldsymbol{w}_{k}^{t-1}" display="inline"><semantics id="S2.SS2.SSS2.p4.4.m4.1a"><msubsup id="S2.SS2.SSS2.p4.4.m4.1.1" xref="S2.SS2.SSS2.p4.4.m4.1.1.cmml"><mi id="S2.SS2.SSS2.p4.4.m4.1.1.2.2" xref="S2.SS2.SSS2.p4.4.m4.1.1.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p4.4.m4.1.1.2.3" xref="S2.SS2.SSS2.p4.4.m4.1.1.2.3.cmml">k</mi><mrow id="S2.SS2.SSS2.p4.4.m4.1.1.3" xref="S2.SS2.SSS2.p4.4.m4.1.1.3.cmml"><mi id="S2.SS2.SSS2.p4.4.m4.1.1.3.2" xref="S2.SS2.SSS2.p4.4.m4.1.1.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p4.4.m4.1.1.3.1" xref="S2.SS2.SSS2.p4.4.m4.1.1.3.1.cmml">−</mo><mn id="S2.SS2.SSS2.p4.4.m4.1.1.3.3" xref="S2.SS2.SSS2.p4.4.m4.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.4.m4.1b"><apply id="S2.SS2.SSS2.p4.4.m4.1.1.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.4.m4.1.1.1.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p4.4.m4.1.1.2.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.4.m4.1.1.2.1.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p4.4.m4.1.1.2.2.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p4.4.m4.1.1.2.3.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1.2.3">𝑘</ci></apply><apply id="S2.SS2.SSS2.p4.4.m4.1.1.3.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1.3"><minus id="S2.SS2.SSS2.p4.4.m4.1.1.3.1.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1.3.1"></minus><ci id="S2.SS2.SSS2.p4.4.m4.1.1.3.2.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S2.SS2.SSS2.p4.4.m4.1.1.3.3.cmml" xref="S2.SS2.SSS2.p4.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.4.m4.1c">\boldsymbol{w}_{k}^{t-1}</annotation></semantics></math> of cluster <math id="S2.SS2.SSS2.p4.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.SSS2.p4.5.m5.1a"><mi id="S2.SS2.SSS2.p4.5.m5.1.1" xref="S2.SS2.SSS2.p4.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.5.m5.1b"><ci id="S2.SS2.SSS2.p4.5.m5.1.1.cmml" xref="S2.SS2.SSS2.p4.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.5.m5.1c">k</annotation></semantics></math> at iteration <math id="S2.SS2.SSS2.p4.6.m6.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="S2.SS2.SSS2.p4.6.m6.1a"><mrow id="S2.SS2.SSS2.p4.6.m6.1.1" xref="S2.SS2.SSS2.p4.6.m6.1.1.cmml"><mi id="S2.SS2.SSS2.p4.6.m6.1.1.2" xref="S2.SS2.SSS2.p4.6.m6.1.1.2.cmml">t</mi><mo id="S2.SS2.SSS2.p4.6.m6.1.1.1" xref="S2.SS2.SSS2.p4.6.m6.1.1.1.cmml">−</mo><mn id="S2.SS2.SSS2.p4.6.m6.1.1.3" xref="S2.SS2.SSS2.p4.6.m6.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.6.m6.1b"><apply id="S2.SS2.SSS2.p4.6.m6.1.1.cmml" xref="S2.SS2.SSS2.p4.6.m6.1.1"><minus id="S2.SS2.SSS2.p4.6.m6.1.1.1.cmml" xref="S2.SS2.SSS2.p4.6.m6.1.1.1"></minus><ci id="S2.SS2.SSS2.p4.6.m6.1.1.2.cmml" xref="S2.SS2.SSS2.p4.6.m6.1.1.2">𝑡</ci><cn type="integer" id="S2.SS2.SSS2.p4.6.m6.1.1.3.cmml" xref="S2.SS2.SSS2.p4.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.6.m6.1c">t-1</annotation></semantics></math> is</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\Delta\boldsymbol{w}_{k}^{t-1}=\boldsymbol{w}_{k}^{t}-\boldsymbol{w}_{k}^{t-1}," display="block"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S2.E2.m1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.2.1" xref="S2.E2.m1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S2.E2.m1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.2.3.2.2" xref="S2.E2.m1.1.1.1.1.2.3.2.2.cmml">𝒘</mi><mi id="S2.E2.m1.1.1.1.1.2.3.2.3" xref="S2.E2.m1.1.1.1.1.2.3.2.3.cmml">k</mi><mrow id="S2.E2.m1.1.1.1.1.2.3.3" xref="S2.E2.m1.1.1.1.1.2.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.2.3.3.2" xref="S2.E2.m1.1.1.1.1.2.3.3.2.cmml">t</mi><mo id="S2.E2.m1.1.1.1.1.2.3.3.1" xref="S2.E2.m1.1.1.1.1.2.3.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.1.2.3.3.3" xref="S2.E2.m1.1.1.1.1.2.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml"><msubsup id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.2.cmml">𝒘</mi><mi id="S2.E2.m1.1.1.1.1.3.2.2.3" xref="S2.E2.m1.1.1.1.1.3.2.2.3.cmml">k</mi><mi id="S2.E2.m1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S2.E2.m1.1.1.1.1.3.1" xref="S2.E2.m1.1.1.1.1.3.1.cmml">−</mo><msubsup id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.2.2" xref="S2.E2.m1.1.1.1.1.3.3.2.2.cmml">𝒘</mi><mi id="S2.E2.m1.1.1.1.1.3.3.2.3" xref="S2.E2.m1.1.1.1.1.3.3.2.3.cmml">k</mi><mrow id="S2.E2.m1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.cmml"><mi id="S2.E2.m1.1.1.1.1.3.3.3.2" xref="S2.E2.m1.1.1.1.1.3.3.3.2.cmml">t</mi><mo id="S2.E2.m1.1.1.1.1.3.3.3.1" xref="S2.E2.m1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S2.E2.m1.1.1.1.1.3.3.3.3" xref="S2.E2.m1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><eq id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"></eq><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"><times id="S2.E2.m1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.1"></times><ci id="S2.E2.m1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.2">Δ</ci><apply id="S2.E2.m1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.2.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.2.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.2.3.2.2">𝒘</ci><ci id="S2.E2.m1.1.1.1.1.2.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3.2.3">𝑘</ci></apply><apply id="S2.E2.m1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3.3"><minus id="S2.E2.m1.1.1.1.1.2.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.2.3.3.1"></minus><ci id="S2.E2.m1.1.1.1.1.2.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.2.3.3.2">𝑡</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.2.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.2.3.3.3">1</cn></apply></apply></apply><apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"><minus id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.1"></minus><apply id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.2">𝒘</ci><ci id="S2.E2.m1.1.1.1.1.3.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2.3">𝑘</ci></apply><ci id="S2.E2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.2">𝒘</ci><ci id="S2.E2.m1.1.1.1.1.3.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.2.3">𝑘</ci></apply><apply id="S2.E2.m1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3"><minus id="S2.E2.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.1"></minus><ci id="S2.E2.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\Delta\boldsymbol{w}_{k}^{t-1}=\boldsymbol{w}_{k}^{t}-\boldsymbol{w}_{k}^{t-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS2.p4.11" class="ltx_p">In (<a href="#S2.E2" title="In II-B2 Determination of cluster identity for each device ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), <math id="S2.SS2.SSS2.p4.7.m1.1" class="ltx_Math" alttext="\Delta\boldsymbol{w}_{k}^{t-1}" display="inline"><semantics id="S2.SS2.SSS2.p4.7.m1.1a"><mrow id="S2.SS2.SSS2.p4.7.m1.1.1" xref="S2.SS2.SSS2.p4.7.m1.1.1.cmml"><mi mathvariant="normal" id="S2.SS2.SSS2.p4.7.m1.1.1.2" xref="S2.SS2.SSS2.p4.7.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p4.7.m1.1.1.1" xref="S2.SS2.SSS2.p4.7.m1.1.1.1.cmml">​</mo><msubsup id="S2.SS2.SSS2.p4.7.m1.1.1.3" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.cmml"><mi id="S2.SS2.SSS2.p4.7.m1.1.1.3.2.2" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p4.7.m1.1.1.3.2.3" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.2.3.cmml">k</mi><mrow id="S2.SS2.SSS2.p4.7.m1.1.1.3.3" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.3.cmml"><mi id="S2.SS2.SSS2.p4.7.m1.1.1.3.3.2" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p4.7.m1.1.1.3.3.1" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.3.1.cmml">−</mo><mn id="S2.SS2.SSS2.p4.7.m1.1.1.3.3.3" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.7.m1.1b"><apply id="S2.SS2.SSS2.p4.7.m1.1.1.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1"><times id="S2.SS2.SSS2.p4.7.m1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.1"></times><ci id="S2.SS2.SSS2.p4.7.m1.1.1.2.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.2">Δ</ci><apply id="S2.SS2.SSS2.p4.7.m1.1.1.3.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.7.m1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3">superscript</csymbol><apply id="S2.SS2.SSS2.p4.7.m1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.7.m1.1.1.3.2.1.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p4.7.m1.1.1.3.2.2.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p4.7.m1.1.1.3.2.3.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.2.3">𝑘</ci></apply><apply id="S2.SS2.SSS2.p4.7.m1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.3"><minus id="S2.SS2.SSS2.p4.7.m1.1.1.3.3.1.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.3.1"></minus><ci id="S2.SS2.SSS2.p4.7.m1.1.1.3.3.2.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S2.SS2.SSS2.p4.7.m1.1.1.3.3.3.cmml" xref="S2.SS2.SSS2.p4.7.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.7.m1.1c">\Delta\boldsymbol{w}_{k}^{t-1}</annotation></semantics></math> is the average gradient of all devices in cluster <math id="S2.SS2.SSS2.p4.8.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.SSS2.p4.8.m2.1a"><mi id="S2.SS2.SSS2.p4.8.m2.1.1" xref="S2.SS2.SSS2.p4.8.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.8.m2.1b"><ci id="S2.SS2.SSS2.p4.8.m2.1.1.cmml" xref="S2.SS2.SSS2.p4.8.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.8.m2.1c">k</annotation></semantics></math> at iteration <math id="S2.SS2.SSS2.p4.9.m3.1" class="ltx_Math" alttext="t-1" display="inline"><semantics id="S2.SS2.SSS2.p4.9.m3.1a"><mrow id="S2.SS2.SSS2.p4.9.m3.1.1" xref="S2.SS2.SSS2.p4.9.m3.1.1.cmml"><mi id="S2.SS2.SSS2.p4.9.m3.1.1.2" xref="S2.SS2.SSS2.p4.9.m3.1.1.2.cmml">t</mi><mo id="S2.SS2.SSS2.p4.9.m3.1.1.1" xref="S2.SS2.SSS2.p4.9.m3.1.1.1.cmml">−</mo><mn id="S2.SS2.SSS2.p4.9.m3.1.1.3" xref="S2.SS2.SSS2.p4.9.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.9.m3.1b"><apply id="S2.SS2.SSS2.p4.9.m3.1.1.cmml" xref="S2.SS2.SSS2.p4.9.m3.1.1"><minus id="S2.SS2.SSS2.p4.9.m3.1.1.1.cmml" xref="S2.SS2.SSS2.p4.9.m3.1.1.1"></minus><ci id="S2.SS2.SSS2.p4.9.m3.1.1.2.cmml" xref="S2.SS2.SSS2.p4.9.m3.1.1.2">𝑡</ci><cn type="integer" id="S2.SS2.SSS2.p4.9.m3.1.1.3.cmml" xref="S2.SS2.SSS2.p4.9.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.9.m3.1c">t-1</annotation></semantics></math>.
The similarity between the local gradient <math id="S2.SS2.SSS2.p4.10.m4.3" class="ltx_Math" alttext="\nabla\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t})" display="inline"><semantics id="S2.SS2.SSS2.p4.10.m4.3a"><mrow id="S2.SS2.SSS2.p4.10.m4.3.3" xref="S2.SS2.SSS2.p4.10.m4.3.3.cmml"><mrow id="S2.SS2.SSS2.p4.10.m4.3.3.3" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.cmml"><mo rspace="0.167em" id="S2.SS2.SSS2.p4.10.m4.3.3.3.1" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.1.cmml">∇</mo><msubsup id="S2.SS2.SSS2.p4.10.m4.3.3.3.2" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p4.10.m4.3.3.3.2.2.2" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2.2.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p4.10.m4.2.2.2.4" xref="S2.SS2.SSS2.p4.10.m4.2.2.2.3.cmml"><mi id="S2.SS2.SSS2.p4.10.m4.1.1.1.1" xref="S2.SS2.SSS2.p4.10.m4.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p4.10.m4.2.2.2.4.1" xref="S2.SS2.SSS2.p4.10.m4.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS2.p4.10.m4.2.2.2.2" xref="S2.SS2.SSS2.p4.10.m4.2.2.2.2.cmml">k</mi></mrow><mi id="S2.SS2.SSS2.p4.10.m4.3.3.3.2.3" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2.3.cmml">t</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p4.10.m4.3.3.2" xref="S2.SS2.SSS2.p4.10.m4.3.3.2.cmml">​</mo><mrow id="S2.SS2.SSS2.p4.10.m4.3.3.1.1" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.2" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.cmml">(</mo><msubsup id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.2" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.2.cmml">𝒵</mi><mi id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.3" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.3" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.3" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.10.m4.3b"><apply id="S2.SS2.SSS2.p4.10.m4.3.3.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3"><times id="S2.SS2.SSS2.p4.10.m4.3.3.2.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.2"></times><apply id="S2.SS2.SSS2.p4.10.m4.3.3.3.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.3"><ci id="S2.SS2.SSS2.p4.10.m4.3.3.3.1.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.1">∇</ci><apply id="S2.SS2.SSS2.p4.10.m4.3.3.3.2.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.10.m4.3.3.3.2.1.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2">superscript</csymbol><apply id="S2.SS2.SSS2.p4.10.m4.3.3.3.2.2.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.10.m4.3.3.3.2.2.1.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2">subscript</csymbol><ci id="S2.SS2.SSS2.p4.10.m4.3.3.3.2.2.2.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2.2.2">ℒ</ci><list id="S2.SS2.SSS2.p4.10.m4.2.2.2.3.cmml" xref="S2.SS2.SSS2.p4.10.m4.2.2.2.4"><ci id="S2.SS2.SSS2.p4.10.m4.1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.10.m4.1.1.1.1">𝑖</ci><ci id="S2.SS2.SSS2.p4.10.m4.2.2.2.2.cmml" xref="S2.SS2.SSS2.p4.10.m4.2.2.2.2">𝑘</ci></list></apply><ci id="S2.SS2.SSS2.p4.10.m4.3.3.3.2.3.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.3.2.3">𝑡</ci></apply></apply><apply id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1">superscript</csymbol><apply id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1">subscript</csymbol><ci id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.2">𝒵</ci><ci id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.3.cmml" xref="S2.SS2.SSS2.p4.10.m4.3.3.1.1.1.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.10.m4.3c">\nabla\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t})</annotation></semantics></math> and <math id="S2.SS2.SSS2.p4.11.m5.1" class="ltx_Math" alttext="\Delta\boldsymbol{w}_{k}^{t-1}" display="inline"><semantics id="S2.SS2.SSS2.p4.11.m5.1a"><mrow id="S2.SS2.SSS2.p4.11.m5.1.1" xref="S2.SS2.SSS2.p4.11.m5.1.1.cmml"><mi mathvariant="normal" id="S2.SS2.SSS2.p4.11.m5.1.1.2" xref="S2.SS2.SSS2.p4.11.m5.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p4.11.m5.1.1.1" xref="S2.SS2.SSS2.p4.11.m5.1.1.1.cmml">​</mo><msubsup id="S2.SS2.SSS2.p4.11.m5.1.1.3" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.cmml"><mi id="S2.SS2.SSS2.p4.11.m5.1.1.3.2.2" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p4.11.m5.1.1.3.2.3" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.2.3.cmml">k</mi><mrow id="S2.SS2.SSS2.p4.11.m5.1.1.3.3" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.3.cmml"><mi id="S2.SS2.SSS2.p4.11.m5.1.1.3.3.2" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p4.11.m5.1.1.3.3.1" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.3.1.cmml">−</mo><mn id="S2.SS2.SSS2.p4.11.m5.1.1.3.3.3" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.11.m5.1b"><apply id="S2.SS2.SSS2.p4.11.m5.1.1.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1"><times id="S2.SS2.SSS2.p4.11.m5.1.1.1.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.1"></times><ci id="S2.SS2.SSS2.p4.11.m5.1.1.2.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.2">Δ</ci><apply id="S2.SS2.SSS2.p4.11.m5.1.1.3.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.11.m5.1.1.3.1.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3">superscript</csymbol><apply id="S2.SS2.SSS2.p4.11.m5.1.1.3.2.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.11.m5.1.1.3.2.1.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3">subscript</csymbol><ci id="S2.SS2.SSS2.p4.11.m5.1.1.3.2.2.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p4.11.m5.1.1.3.2.3.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.2.3">𝑘</ci></apply><apply id="S2.SS2.SSS2.p4.11.m5.1.1.3.3.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.3"><minus id="S2.SS2.SSS2.p4.11.m5.1.1.3.3.1.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.3.1"></minus><ci id="S2.SS2.SSS2.p4.11.m5.1.1.3.3.2.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.3.2">𝑡</ci><cn type="integer" id="S2.SS2.SSS2.p4.11.m5.1.1.3.3.3.cmml" xref="S2.SS2.SSS2.p4.11.m5.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.11.m5.1c">\Delta\boldsymbol{w}_{k}^{t-1}</annotation></semantics></math> is calculated by</p>
<table id="S2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E3.m1.14" class="ltx_Math" alttext="S_{i,k}^{t}=\frac{\left(\nabla\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t})\right)\cdot\Delta\boldsymbol{w}_{k}^{t-1}}{|\nabla\mathcal{L}_{i,k}^{t}||\Delta\boldsymbol{w}_{k}^{t-1}|},\forall k=1,2,\ldots,K." display="block"><semantics id="S2.E3.m1.14a"><mrow id="S2.E3.m1.14.14.1"><mrow id="S2.E3.m1.14.14.1.1.2" xref="S2.E3.m1.14.14.1.1.3.cmml"><mrow id="S2.E3.m1.14.14.1.1.1.1" xref="S2.E3.m1.14.14.1.1.1.1.cmml"><msubsup id="S2.E3.m1.14.14.1.1.1.1.2" xref="S2.E3.m1.14.14.1.1.1.1.2.cmml"><mi id="S2.E3.m1.14.14.1.1.1.1.2.2.2" xref="S2.E3.m1.14.14.1.1.1.1.2.2.2.cmml">S</mi><mrow id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">i</mi><mo id="S2.E3.m1.2.2.2.4.1" xref="S2.E3.m1.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">k</mi></mrow><mi id="S2.E3.m1.14.14.1.1.1.1.2.3" xref="S2.E3.m1.14.14.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S2.E3.m1.14.14.1.1.1.1.1" xref="S2.E3.m1.14.14.1.1.1.1.1.cmml">=</mo><mfrac id="S2.E3.m1.9.9" xref="S2.E3.m1.9.9.cmml"><mrow id="S2.E3.m1.5.5.3" xref="S2.E3.m1.5.5.3.cmml"><mrow id="S2.E3.m1.5.5.3.3" xref="S2.E3.m1.5.5.3.3.cmml"><mrow id="S2.E3.m1.5.5.3.3.1.1" xref="S2.E3.m1.5.5.3.3.1.1.1.cmml"><mo id="S2.E3.m1.5.5.3.3.1.1.2" xref="S2.E3.m1.5.5.3.3.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.5.5.3.3.1.1.1" xref="S2.E3.m1.5.5.3.3.1.1.1.cmml"><mrow id="S2.E3.m1.5.5.3.3.1.1.1.3" xref="S2.E3.m1.5.5.3.3.1.1.1.3.cmml"><mo rspace="0.167em" id="S2.E3.m1.5.5.3.3.1.1.1.3.1" xref="S2.E3.m1.5.5.3.3.1.1.1.3.1.cmml">∇</mo><msubsup id="S2.E3.m1.5.5.3.3.1.1.1.3.2" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.5.3.3.1.1.1.3.2.2.2" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2.2.2.cmml">ℒ</mi><mrow id="S2.E3.m1.4.4.2.2.2.4" xref="S2.E3.m1.4.4.2.2.2.3.cmml"><mi id="S2.E3.m1.3.3.1.1.1.1" xref="S2.E3.m1.3.3.1.1.1.1.cmml">i</mi><mo id="S2.E3.m1.4.4.2.2.2.4.1" xref="S2.E3.m1.4.4.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.4.4.2.2.2.2" xref="S2.E3.m1.4.4.2.2.2.2.cmml">k</mi></mrow><mi id="S2.E3.m1.5.5.3.3.1.1.1.3.2.3" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2.3.cmml">t</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.3.3.1.1.1.2" xref="S2.E3.m1.5.5.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.5.5.3.3.1.1.1.1.1" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.5.5.3.3.1.1.1.1.1.2" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.2" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.2.cmml">𝒵</mi><mi id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.3" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.3" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.E3.m1.5.5.3.3.1.1.1.1.1.3" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S2.E3.m1.5.5.3.3.1.1.3" xref="S2.E3.m1.5.5.3.3.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.E3.m1.5.5.3.3.2" xref="S2.E3.m1.5.5.3.3.2.cmml">⋅</mo><mi mathvariant="normal" id="S2.E3.m1.5.5.3.3.3" xref="S2.E3.m1.5.5.3.3.3.cmml">Δ</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.5.5.3.4" xref="S2.E3.m1.5.5.3.4.cmml">​</mo><msubsup id="S2.E3.m1.5.5.3.5" xref="S2.E3.m1.5.5.3.5.cmml"><mi id="S2.E3.m1.5.5.3.5.2.2" xref="S2.E3.m1.5.5.3.5.2.2.cmml">𝒘</mi><mi id="S2.E3.m1.5.5.3.5.2.3" xref="S2.E3.m1.5.5.3.5.2.3.cmml">k</mi><mrow id="S2.E3.m1.5.5.3.5.3" xref="S2.E3.m1.5.5.3.5.3.cmml"><mi id="S2.E3.m1.5.5.3.5.3.2" xref="S2.E3.m1.5.5.3.5.3.2.cmml">t</mi><mo id="S2.E3.m1.5.5.3.5.3.1" xref="S2.E3.m1.5.5.3.5.3.1.cmml">−</mo><mn id="S2.E3.m1.5.5.3.5.3.3" xref="S2.E3.m1.5.5.3.5.3.3.cmml">1</mn></mrow></msubsup></mrow><mrow id="S2.E3.m1.9.9.7" xref="S2.E3.m1.9.9.7.cmml"><mrow id="S2.E3.m1.8.8.6.3.1" xref="S2.E3.m1.8.8.6.3.2.cmml"><mo stretchy="false" id="S2.E3.m1.8.8.6.3.1.2" xref="S2.E3.m1.8.8.6.3.2.1.cmml">|</mo><mrow id="S2.E3.m1.8.8.6.3.1.1" xref="S2.E3.m1.8.8.6.3.1.1.cmml"><mo rspace="0.167em" id="S2.E3.m1.8.8.6.3.1.1.1" xref="S2.E3.m1.8.8.6.3.1.1.1.cmml">∇</mo><msubsup id="S2.E3.m1.8.8.6.3.1.1.2" xref="S2.E3.m1.8.8.6.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.8.8.6.3.1.1.2.2.2" xref="S2.E3.m1.8.8.6.3.1.1.2.2.2.cmml">ℒ</mi><mrow id="S2.E3.m1.7.7.5.2.2.4" xref="S2.E3.m1.7.7.5.2.2.3.cmml"><mi id="S2.E3.m1.6.6.4.1.1.1" xref="S2.E3.m1.6.6.4.1.1.1.cmml">i</mi><mo id="S2.E3.m1.7.7.5.2.2.4.1" xref="S2.E3.m1.7.7.5.2.2.3.cmml">,</mo><mi id="S2.E3.m1.7.7.5.2.2.2" xref="S2.E3.m1.7.7.5.2.2.2.cmml">k</mi></mrow><mi id="S2.E3.m1.8.8.6.3.1.1.2.3" xref="S2.E3.m1.8.8.6.3.1.1.2.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="S2.E3.m1.8.8.6.3.1.3" xref="S2.E3.m1.8.8.6.3.2.1.cmml">|</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.9.9.7.5" xref="S2.E3.m1.9.9.7.5.cmml">​</mo><mrow id="S2.E3.m1.9.9.7.4.1" xref="S2.E3.m1.9.9.7.4.2.cmml"><mo stretchy="false" id="S2.E3.m1.9.9.7.4.1.2" xref="S2.E3.m1.9.9.7.4.2.1.cmml">|</mo><mrow id="S2.E3.m1.9.9.7.4.1.1" xref="S2.E3.m1.9.9.7.4.1.1.cmml"><mi mathvariant="normal" id="S2.E3.m1.9.9.7.4.1.1.2" xref="S2.E3.m1.9.9.7.4.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.9.9.7.4.1.1.1" xref="S2.E3.m1.9.9.7.4.1.1.1.cmml">​</mo><msubsup id="S2.E3.m1.9.9.7.4.1.1.3" xref="S2.E3.m1.9.9.7.4.1.1.3.cmml"><mi id="S2.E3.m1.9.9.7.4.1.1.3.2.2" xref="S2.E3.m1.9.9.7.4.1.1.3.2.2.cmml">𝒘</mi><mi id="S2.E3.m1.9.9.7.4.1.1.3.2.3" xref="S2.E3.m1.9.9.7.4.1.1.3.2.3.cmml">k</mi><mrow id="S2.E3.m1.9.9.7.4.1.1.3.3" xref="S2.E3.m1.9.9.7.4.1.1.3.3.cmml"><mi id="S2.E3.m1.9.9.7.4.1.1.3.3.2" xref="S2.E3.m1.9.9.7.4.1.1.3.3.2.cmml">t</mi><mo id="S2.E3.m1.9.9.7.4.1.1.3.3.1" xref="S2.E3.m1.9.9.7.4.1.1.3.3.1.cmml">−</mo><mn id="S2.E3.m1.9.9.7.4.1.1.3.3.3" xref="S2.E3.m1.9.9.7.4.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo stretchy="false" id="S2.E3.m1.9.9.7.4.1.3" xref="S2.E3.m1.9.9.7.4.2.1.cmml">|</mo></mrow></mrow></mfrac></mrow><mo id="S2.E3.m1.14.14.1.1.2.3" xref="S2.E3.m1.14.14.1.1.3a.cmml">,</mo><mrow id="S2.E3.m1.14.14.1.1.2.2" xref="S2.E3.m1.14.14.1.1.2.2.cmml"><mrow id="S2.E3.m1.14.14.1.1.2.2.2" xref="S2.E3.m1.14.14.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S2.E3.m1.14.14.1.1.2.2.2.1" xref="S2.E3.m1.14.14.1.1.2.2.2.1.cmml">∀</mo><mi id="S2.E3.m1.14.14.1.1.2.2.2.2" xref="S2.E3.m1.14.14.1.1.2.2.2.2.cmml">k</mi></mrow><mo id="S2.E3.m1.14.14.1.1.2.2.1" xref="S2.E3.m1.14.14.1.1.2.2.1.cmml">=</mo><mrow id="S2.E3.m1.14.14.1.1.2.2.3.2" xref="S2.E3.m1.14.14.1.1.2.2.3.1.cmml"><mn id="S2.E3.m1.10.10" xref="S2.E3.m1.10.10.cmml">1</mn><mo id="S2.E3.m1.14.14.1.1.2.2.3.2.1" xref="S2.E3.m1.14.14.1.1.2.2.3.1.cmml">,</mo><mn id="S2.E3.m1.11.11" xref="S2.E3.m1.11.11.cmml">2</mn><mo id="S2.E3.m1.14.14.1.1.2.2.3.2.2" xref="S2.E3.m1.14.14.1.1.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.E3.m1.12.12" xref="S2.E3.m1.12.12.cmml">…</mi><mo id="S2.E3.m1.14.14.1.1.2.2.3.2.3" xref="S2.E3.m1.14.14.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E3.m1.13.13" xref="S2.E3.m1.13.13.cmml">K</mi></mrow></mrow></mrow><mo lspace="0em" id="S2.E3.m1.14.14.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.14b"><apply id="S2.E3.m1.14.14.1.1.3.cmml" xref="S2.E3.m1.14.14.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.14.14.1.1.3a.cmml" xref="S2.E3.m1.14.14.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E3.m1.14.14.1.1.1.1.cmml" xref="S2.E3.m1.14.14.1.1.1.1"><eq id="S2.E3.m1.14.14.1.1.1.1.1.cmml" xref="S2.E3.m1.14.14.1.1.1.1.1"></eq><apply id="S2.E3.m1.14.14.1.1.1.1.2.cmml" xref="S2.E3.m1.14.14.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.14.14.1.1.1.1.2.1.cmml" xref="S2.E3.m1.14.14.1.1.1.1.2">superscript</csymbol><apply id="S2.E3.m1.14.14.1.1.1.1.2.2.cmml" xref="S2.E3.m1.14.14.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.14.14.1.1.1.1.2.2.1.cmml" xref="S2.E3.m1.14.14.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.14.14.1.1.1.1.2.2.2.cmml" xref="S2.E3.m1.14.14.1.1.1.1.2.2.2">𝑆</ci><list id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝑖</ci><ci id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S2.E3.m1.14.14.1.1.1.1.2.3.cmml" xref="S2.E3.m1.14.14.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.E3.m1.9.9.cmml" xref="S2.E3.m1.9.9"><divide id="S2.E3.m1.9.9.8.cmml" xref="S2.E3.m1.9.9"></divide><apply id="S2.E3.m1.5.5.3.cmml" xref="S2.E3.m1.5.5.3"><times id="S2.E3.m1.5.5.3.4.cmml" xref="S2.E3.m1.5.5.3.4"></times><apply id="S2.E3.m1.5.5.3.3.cmml" xref="S2.E3.m1.5.5.3.3"><ci id="S2.E3.m1.5.5.3.3.2.cmml" xref="S2.E3.m1.5.5.3.3.2">⋅</ci><apply id="S2.E3.m1.5.5.3.3.1.1.1.cmml" xref="S2.E3.m1.5.5.3.3.1.1"><times id="S2.E3.m1.5.5.3.3.1.1.1.2.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.2"></times><apply id="S2.E3.m1.5.5.3.3.1.1.1.3.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.3"><ci id="S2.E3.m1.5.5.3.3.1.1.1.3.1.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.3.1">∇</ci><apply id="S2.E3.m1.5.5.3.3.1.1.1.3.2.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.3.1.1.1.3.2.1.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2">superscript</csymbol><apply id="S2.E3.m1.5.5.3.3.1.1.1.3.2.2.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.3.1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2">subscript</csymbol><ci id="S2.E3.m1.5.5.3.3.1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2.2.2">ℒ</ci><list id="S2.E3.m1.4.4.2.2.2.3.cmml" xref="S2.E3.m1.4.4.2.2.2.4"><ci id="S2.E3.m1.3.3.1.1.1.1.cmml" xref="S2.E3.m1.3.3.1.1.1.1">𝑖</ci><ci id="S2.E3.m1.4.4.2.2.2.2.cmml" xref="S2.E3.m1.4.4.2.2.2.2">𝑘</ci></list></apply><ci id="S2.E3.m1.5.5.3.3.1.1.1.3.2.3.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.3.2.3">𝑡</ci></apply></apply><apply id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.2">𝒵</ci><ci id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.5.5.3.3.1.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S2.E3.m1.5.5.3.3.3.cmml" xref="S2.E3.m1.5.5.3.3.3">Δ</ci></apply><apply id="S2.E3.m1.5.5.3.5.cmml" xref="S2.E3.m1.5.5.3.5"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.5.1.cmml" xref="S2.E3.m1.5.5.3.5">superscript</csymbol><apply id="S2.E3.m1.5.5.3.5.2.cmml" xref="S2.E3.m1.5.5.3.5"><csymbol cd="ambiguous" id="S2.E3.m1.5.5.3.5.2.1.cmml" xref="S2.E3.m1.5.5.3.5">subscript</csymbol><ci id="S2.E3.m1.5.5.3.5.2.2.cmml" xref="S2.E3.m1.5.5.3.5.2.2">𝒘</ci><ci id="S2.E3.m1.5.5.3.5.2.3.cmml" xref="S2.E3.m1.5.5.3.5.2.3">𝑘</ci></apply><apply id="S2.E3.m1.5.5.3.5.3.cmml" xref="S2.E3.m1.5.5.3.5.3"><minus id="S2.E3.m1.5.5.3.5.3.1.cmml" xref="S2.E3.m1.5.5.3.5.3.1"></minus><ci id="S2.E3.m1.5.5.3.5.3.2.cmml" xref="S2.E3.m1.5.5.3.5.3.2">𝑡</ci><cn type="integer" id="S2.E3.m1.5.5.3.5.3.3.cmml" xref="S2.E3.m1.5.5.3.5.3.3">1</cn></apply></apply></apply><apply id="S2.E3.m1.9.9.7.cmml" xref="S2.E3.m1.9.9.7"><times id="S2.E3.m1.9.9.7.5.cmml" xref="S2.E3.m1.9.9.7.5"></times><apply id="S2.E3.m1.8.8.6.3.2.cmml" xref="S2.E3.m1.8.8.6.3.1"><abs id="S2.E3.m1.8.8.6.3.2.1.cmml" xref="S2.E3.m1.8.8.6.3.1.2"></abs><apply id="S2.E3.m1.8.8.6.3.1.1.cmml" xref="S2.E3.m1.8.8.6.3.1.1"><ci id="S2.E3.m1.8.8.6.3.1.1.1.cmml" xref="S2.E3.m1.8.8.6.3.1.1.1">∇</ci><apply id="S2.E3.m1.8.8.6.3.1.1.2.cmml" xref="S2.E3.m1.8.8.6.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.6.3.1.1.2.1.cmml" xref="S2.E3.m1.8.8.6.3.1.1.2">superscript</csymbol><apply id="S2.E3.m1.8.8.6.3.1.1.2.2.cmml" xref="S2.E3.m1.8.8.6.3.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.8.8.6.3.1.1.2.2.1.cmml" xref="S2.E3.m1.8.8.6.3.1.1.2">subscript</csymbol><ci id="S2.E3.m1.8.8.6.3.1.1.2.2.2.cmml" xref="S2.E3.m1.8.8.6.3.1.1.2.2.2">ℒ</ci><list id="S2.E3.m1.7.7.5.2.2.3.cmml" xref="S2.E3.m1.7.7.5.2.2.4"><ci id="S2.E3.m1.6.6.4.1.1.1.cmml" xref="S2.E3.m1.6.6.4.1.1.1">𝑖</ci><ci id="S2.E3.m1.7.7.5.2.2.2.cmml" xref="S2.E3.m1.7.7.5.2.2.2">𝑘</ci></list></apply><ci id="S2.E3.m1.8.8.6.3.1.1.2.3.cmml" xref="S2.E3.m1.8.8.6.3.1.1.2.3">𝑡</ci></apply></apply></apply><apply id="S2.E3.m1.9.9.7.4.2.cmml" xref="S2.E3.m1.9.9.7.4.1"><abs id="S2.E3.m1.9.9.7.4.2.1.cmml" xref="S2.E3.m1.9.9.7.4.1.2"></abs><apply id="S2.E3.m1.9.9.7.4.1.1.cmml" xref="S2.E3.m1.9.9.7.4.1.1"><times id="S2.E3.m1.9.9.7.4.1.1.1.cmml" xref="S2.E3.m1.9.9.7.4.1.1.1"></times><ci id="S2.E3.m1.9.9.7.4.1.1.2.cmml" xref="S2.E3.m1.9.9.7.4.1.1.2">Δ</ci><apply id="S2.E3.m1.9.9.7.4.1.1.3.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.7.4.1.1.3.1.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3">superscript</csymbol><apply id="S2.E3.m1.9.9.7.4.1.1.3.2.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.9.9.7.4.1.1.3.2.1.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3">subscript</csymbol><ci id="S2.E3.m1.9.9.7.4.1.1.3.2.2.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3.2.2">𝒘</ci><ci id="S2.E3.m1.9.9.7.4.1.1.3.2.3.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3.2.3">𝑘</ci></apply><apply id="S2.E3.m1.9.9.7.4.1.1.3.3.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3.3"><minus id="S2.E3.m1.9.9.7.4.1.1.3.3.1.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3.3.1"></minus><ci id="S2.E3.m1.9.9.7.4.1.1.3.3.2.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3.3.2">𝑡</ci><cn type="integer" id="S2.E3.m1.9.9.7.4.1.1.3.3.3.cmml" xref="S2.E3.m1.9.9.7.4.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply><apply id="S2.E3.m1.14.14.1.1.2.2.cmml" xref="S2.E3.m1.14.14.1.1.2.2"><eq id="S2.E3.m1.14.14.1.1.2.2.1.cmml" xref="S2.E3.m1.14.14.1.1.2.2.1"></eq><apply id="S2.E3.m1.14.14.1.1.2.2.2.cmml" xref="S2.E3.m1.14.14.1.1.2.2.2"><csymbol cd="latexml" id="S2.E3.m1.14.14.1.1.2.2.2.1.cmml" xref="S2.E3.m1.14.14.1.1.2.2.2.1">for-all</csymbol><ci id="S2.E3.m1.14.14.1.1.2.2.2.2.cmml" xref="S2.E3.m1.14.14.1.1.2.2.2.2">𝑘</ci></apply><list id="S2.E3.m1.14.14.1.1.2.2.3.1.cmml" xref="S2.E3.m1.14.14.1.1.2.2.3.2"><cn type="integer" id="S2.E3.m1.10.10.cmml" xref="S2.E3.m1.10.10">1</cn><cn type="integer" id="S2.E3.m1.11.11.cmml" xref="S2.E3.m1.11.11">2</cn><ci id="S2.E3.m1.12.12.cmml" xref="S2.E3.m1.12.12">…</ci><ci id="S2.E3.m1.13.13.cmml" xref="S2.E3.m1.13.13">𝐾</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.14c">S_{i,k}^{t}=\frac{\left(\nabla\mathcal{L}_{i,k}^{t}(\mathcal{Z}_{i}^{t})\right)\cdot\Delta\boldsymbol{w}_{k}^{t-1}}{|\nabla\mathcal{L}_{i,k}^{t}||\Delta\boldsymbol{w}_{k}^{t-1}|},\forall k=1,2,\ldots,K.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS2.p4.12" class="ltx_p">In (<a href="#S2.E3" title="In II-B2 Determination of cluster identity for each device ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), we use cosine similarity to characterize the similarity between local gradient and the latest global FL model update, which ignores the magnitude of gradient values and focuses on the direction of gradient descent.
We can also use other functions to characterize the similarity between local gradient and the latest global FL model update. For example, if we consider both the magnitude and direction, we can use euclidean metric and treat the inverse of distance as similarity (i.e. <math id="S2.SS2.SSS2.p4.12.m1.11" class="ltx_Math" alttext="S_{i,k}^{t}=-\boldsymbol{d}(\nabla\mathcal{L}_{i,k}^{t},\Delta\boldsymbol{w}_{k}^{t-1})=-||\nabla\mathcal{L}_{i,k}^{t}-\Delta\boldsymbol{w}_{k}^{t-1}||,\forall k=1,2,\ldots,K." display="inline"><semantics id="S2.SS2.SSS2.p4.12.m1.11a"><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1"><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.3.cmml"><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.cmml"><msubsup id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.2.2.cmml">S</mi><mrow id="S2.SS2.SSS2.p4.12.m1.2.2.2.4" xref="S2.SS2.SSS2.p4.12.m1.2.2.2.3.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.1.1.1.1" xref="S2.SS2.SSS2.p4.12.m1.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p4.12.m1.2.2.2.4.1" xref="S2.SS2.SSS2.p4.12.m1.2.2.2.3.cmml">,</mo><mi id="S2.SS2.SSS2.p4.12.m1.2.2.2.2" xref="S2.SS2.SSS2.p4.12.m1.2.2.2.2.cmml">k</mi></mrow><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.3.cmml">t</mi></msubsup><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.6" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.6.cmml">=</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.cmml"><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2a" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.cmml">−</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.4" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.4.cmml">𝒅</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.3.cmml">​</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.3.cmml">(</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml">∇</mo><msubsup id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.2.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p4.12.m1.4.4.2.4" xref="S2.SS2.SSS2.p4.12.m1.4.4.2.3.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.3.3.1.1" xref="S2.SS2.SSS2.p4.12.m1.3.3.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p4.12.m1.4.4.2.4.1" xref="S2.SS2.SSS2.p4.12.m1.4.4.2.3.cmml">,</mo><mi id="S2.SS2.SSS2.p4.12.m1.4.4.2.2" xref="S2.SS2.SSS2.p4.12.m1.4.4.2.2.cmml">k</mi></mrow><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msubsup></mrow><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.4" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.3.cmml">,</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.1.cmml">​</mo><msubsup id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.3.cmml">k</mi><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.1.cmml">−</mo><mn id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo stretchy="false" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.5" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.7" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.7.cmml">=</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.cmml"><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3a" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.cmml">−</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.2.cmml"><mo stretchy="false" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.2.1.cmml">‖</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.cmml"><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.cmml"><mo rspace="0.167em" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.1.cmml">∇</mo><msubsup id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.2.2.cmml">ℒ</mi><mrow id="S2.SS2.SSS2.p4.12.m1.6.6.2.4" xref="S2.SS2.SSS2.p4.12.m1.6.6.2.3.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.5.5.1.1" xref="S2.SS2.SSS2.p4.12.m1.5.5.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p4.12.m1.6.6.2.4.1" xref="S2.SS2.SSS2.p4.12.m1.6.6.2.3.cmml">,</mo><mi id="S2.SS2.SSS2.p4.12.m1.6.6.2.2" xref="S2.SS2.SSS2.p4.12.m1.6.6.2.2.cmml">k</mi></mrow><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.3.cmml">t</mi></msubsup></mrow><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.1.cmml">−</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.cmml"><mi mathvariant="normal" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.1.cmml">​</mo><msubsup id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.3.cmml">k</mi><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.cmml"><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.2.cmml">t</mi><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.1.cmml">−</mo><mn id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow><mo stretchy="false" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.3a.cmml">,</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.cmml"><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.1.cmml">∀</mo><mi id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.2.cmml">k</mi></mrow><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.1.cmml">=</mo><mrow id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.1.cmml"><mn id="S2.SS2.SSS2.p4.12.m1.7.7" xref="S2.SS2.SSS2.p4.12.m1.7.7.cmml">1</mn><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.2.1" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.1.cmml">,</mo><mn id="S2.SS2.SSS2.p4.12.m1.8.8" xref="S2.SS2.SSS2.p4.12.m1.8.8.cmml">2</mn><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.2.2" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.SS2.SSS2.p4.12.m1.9.9" xref="S2.SS2.SSS2.p4.12.m1.9.9.cmml">…</mi><mo id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.2.3" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.1.cmml">,</mo><mi id="S2.SS2.SSS2.p4.12.m1.10.10" xref="S2.SS2.SSS2.p4.12.m1.10.10.cmml">K</mi></mrow></mrow></mrow><mo lspace="0em" id="S2.SS2.SSS2.p4.12.m1.11.11.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p4.12.m1.11b"><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.3a.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.3">formulae-sequence</csymbol><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1"><and id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1a.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1"></and><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1b.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1"><eq id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.6.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.6"></eq><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5">superscript</csymbol><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5">subscript</csymbol><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.2.2">𝑆</ci><list id="S2.SS2.SSS2.p4.12.m1.2.2.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.2.2.2.4"><ci id="S2.SS2.SSS2.p4.12.m1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.1.1.1.1">𝑖</ci><ci id="S2.SS2.SSS2.p4.12.m1.2.2.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.2.2.2.2">𝑘</ci></list></apply><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.5.3">𝑡</ci></apply><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2"><minus id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2"></minus><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2"><times id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.3"></times><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.4.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.4">𝒅</ci><interval closure="open" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2"><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1"><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.1">∇</ci><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.2.2">ℒ</ci><list id="S2.SS2.SSS2.p4.12.m1.4.4.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.4.4.2.4"><ci id="S2.SS2.SSS2.p4.12.m1.3.3.1.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.3.3.1.1">𝑖</ci><ci id="S2.SS2.SSS2.p4.12.m1.4.4.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.4.4.2.2">𝑘</ci></list></apply><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.1.1.1.1.1.2.3">𝑡</ci></apply></apply><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2"><times id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.1"></times><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.2">Δ</ci><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3">superscript</csymbol><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3">subscript</csymbol><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.2.3">𝑘</ci></apply><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3"><minus id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.1"></minus><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.2">𝑡</ci><cn type="integer" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.2.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></apply></apply></apply><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1c.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1"><eq id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.7.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.7"></eq><share href="#S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.2.cmml" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1d.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1"></share><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3"><minus id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3"></minus><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1"><csymbol cd="latexml" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.2">norm</csymbol><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1"><minus id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.1"></minus><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2"><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.1">∇</ci><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2">superscript</csymbol><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2">subscript</csymbol><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.2.2">ℒ</ci><list id="S2.SS2.SSS2.p4.12.m1.6.6.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.6.6.2.4"><ci id="S2.SS2.SSS2.p4.12.m1.5.5.1.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.5.5.1.1">𝑖</ci><ci id="S2.SS2.SSS2.p4.12.m1.6.6.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.6.6.2.2">𝑘</ci></list></apply><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.2.2.3">𝑡</ci></apply></apply><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3"><times id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.1"></times><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.2">Δ</ci><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3">superscript</csymbol><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3">subscript</csymbol><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.2">𝒘</ci><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.2.3">𝑘</ci></apply><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3"><minus id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.1"></minus><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.2">𝑡</ci><cn type="integer" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.3.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.1.1.3.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></apply></apply><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2"><eq id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.1"></eq><apply id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2"><csymbol cd="latexml" id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.1">for-all</csymbol><ci id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.2.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.2.2">𝑘</ci></apply><list id="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.1.cmml" xref="S2.SS2.SSS2.p4.12.m1.11.11.1.1.2.2.3.2"><cn type="integer" id="S2.SS2.SSS2.p4.12.m1.7.7.cmml" xref="S2.SS2.SSS2.p4.12.m1.7.7">1</cn><cn type="integer" id="S2.SS2.SSS2.p4.12.m1.8.8.cmml" xref="S2.SS2.SSS2.p4.12.m1.8.8">2</cn><ci id="S2.SS2.SSS2.p4.12.m1.9.9.cmml" xref="S2.SS2.SSS2.p4.12.m1.9.9">…</ci><ci id="S2.SS2.SSS2.p4.12.m1.10.10.cmml" xref="S2.SS2.SSS2.p4.12.m1.10.10">𝐾</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p4.12.m1.11c">S_{i,k}^{t}=-\boldsymbol{d}(\nabla\mathcal{L}_{i,k}^{t},\Delta\boldsymbol{w}_{k}^{t-1})=-||\nabla\mathcal{L}_{i,k}^{t}-\Delta\boldsymbol{w}_{k}^{t-1}||,\forall k=1,2,\ldots,K.</annotation></semantics></math>)</p>
</div>
<div id="S2.SS2.SSS2.p5" class="ltx_para">
<p id="S2.SS2.SSS2.p5.2" class="ltx_p"><span id="S2.SS2.SSS2.p5.2.1" class="ltx_text ltx_font_bold">Step 4 Cluster identity determination: </span> Given (<a href="#S2.E3" title="In II-B2 Determination of cluster identity for each device ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>), the cluster identity is estimated by</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1.9" class="ltx_Math" alttext="s_{i}^{t}=\underset{k=1,2,\ldots,K}{\mathrm{argmax}}\left(\lambda S_{i,k}^{t}+(1-\lambda)(-\mathcal{L}_{i,k}^{t})\right)." display="block"><semantics id="S2.E4.m1.9a"><mrow id="S2.E4.m1.9.9.1" xref="S2.E4.m1.9.9.1.1.cmml"><mrow id="S2.E4.m1.9.9.1.1" xref="S2.E4.m1.9.9.1.1.cmml"><msubsup id="S2.E4.m1.9.9.1.1.3" xref="S2.E4.m1.9.9.1.1.3.cmml"><mi id="S2.E4.m1.9.9.1.1.3.2.2" xref="S2.E4.m1.9.9.1.1.3.2.2.cmml">s</mi><mi id="S2.E4.m1.9.9.1.1.3.2.3" xref="S2.E4.m1.9.9.1.1.3.2.3.cmml">i</mi><mi id="S2.E4.m1.9.9.1.1.3.3" xref="S2.E4.m1.9.9.1.1.3.3.cmml">t</mi></msubsup><mo id="S2.E4.m1.9.9.1.1.2" xref="S2.E4.m1.9.9.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.9.9.1.1.1" xref="S2.E4.m1.9.9.1.1.1.cmml"><munder accentunder="true" id="S2.E4.m1.4.4" xref="S2.E4.m1.4.4.cmml"><mi id="S2.E4.m1.4.4.5" xref="S2.E4.m1.4.4.5.cmml">argmax</mi><mrow id="S2.E4.m1.4.4.4" xref="S2.E4.m1.4.4.4.cmml"><mi id="S2.E4.m1.4.4.4.6" xref="S2.E4.m1.4.4.4.6.cmml">k</mi><mo id="S2.E4.m1.4.4.4.5" xref="S2.E4.m1.4.4.4.5.cmml">=</mo><mrow id="S2.E4.m1.4.4.4.7.2" xref="S2.E4.m1.4.4.4.7.1.cmml"><mn id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">1</mn><mo id="S2.E4.m1.4.4.4.7.2.1" xref="S2.E4.m1.4.4.4.7.1.cmml">,</mo><mn id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">2</mn><mo id="S2.E4.m1.4.4.4.7.2.2" xref="S2.E4.m1.4.4.4.7.1.cmml">,</mo><mi mathvariant="normal" id="S2.E4.m1.3.3.3.3" xref="S2.E4.m1.3.3.3.3.cmml">…</mi><mo id="S2.E4.m1.4.4.4.7.2.3" xref="S2.E4.m1.4.4.4.7.1.cmml">,</mo><mi id="S2.E4.m1.4.4.4.4" xref="S2.E4.m1.4.4.4.4.cmml">K</mi></mrow></mrow></munder><mo lspace="0em" rspace="0em" id="S2.E4.m1.9.9.1.1.1.2" xref="S2.E4.m1.9.9.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.9.9.1.1.1.1.1" xref="S2.E4.m1.9.9.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.9.9.1.1.1.1.1.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.9.9.1.1.1.1.1.1" xref="S2.E4.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.9.9.1.1.1.1.1.1.4" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.cmml"><mi id="S2.E4.m1.9.9.1.1.1.1.1.1.4.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.9.9.1.1.1.1.1.1.4.1" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.1.cmml">​</mo><msubsup id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.cmml"><mi id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.2.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.2.2.cmml">S</mi><mrow id="S2.E4.m1.6.6.2.4" xref="S2.E4.m1.6.6.2.3.cmml"><mi id="S2.E4.m1.5.5.1.1" xref="S2.E4.m1.5.5.1.1.cmml">i</mi><mo id="S2.E4.m1.6.6.2.4.1" xref="S2.E4.m1.6.6.2.3.cmml">,</mo><mi id="S2.E4.m1.6.6.2.2" xref="S2.E4.m1.6.6.2.2.cmml">k</mi></mrow><mi id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.3.cmml">t</mi></msubsup></mrow><mo id="S2.E4.m1.9.9.1.1.1.1.1.1.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S2.E4.m1.9.9.1.1.1.1.1.1.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.cmml"><mrow id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.9.9.1.1.1.1.1.1.2.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.cmml">(</mo><mrow id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.cmml"><mo id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1a" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.cmml">−</mo><msubsup id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.2.2" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.2.2.cmml">ℒ</mi><mrow id="S2.E4.m1.8.8.2.4" xref="S2.E4.m1.8.8.2.3.cmml"><mi id="S2.E4.m1.7.7.1.1" xref="S2.E4.m1.7.7.1.1.cmml">i</mi><mo id="S2.E4.m1.8.8.2.4.1" xref="S2.E4.m1.8.8.2.3.cmml">,</mo><mi id="S2.E4.m1.8.8.2.2" xref="S2.E4.m1.8.8.2.2.cmml">k</mi></mrow><mi id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.9.9.1.1.1.1.1.3" xref="S2.E4.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S2.E4.m1.9.9.1.2" xref="S2.E4.m1.9.9.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.9b"><apply id="S2.E4.m1.9.9.1.1.cmml" xref="S2.E4.m1.9.9.1"><eq id="S2.E4.m1.9.9.1.1.2.cmml" xref="S2.E4.m1.9.9.1.1.2"></eq><apply id="S2.E4.m1.9.9.1.1.3.cmml" xref="S2.E4.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.3.1.cmml" xref="S2.E4.m1.9.9.1.1.3">superscript</csymbol><apply id="S2.E4.m1.9.9.1.1.3.2.cmml" xref="S2.E4.m1.9.9.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.3.2.1.cmml" xref="S2.E4.m1.9.9.1.1.3">subscript</csymbol><ci id="S2.E4.m1.9.9.1.1.3.2.2.cmml" xref="S2.E4.m1.9.9.1.1.3.2.2">𝑠</ci><ci id="S2.E4.m1.9.9.1.1.3.2.3.cmml" xref="S2.E4.m1.9.9.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E4.m1.9.9.1.1.3.3.cmml" xref="S2.E4.m1.9.9.1.1.3.3">𝑡</ci></apply><apply id="S2.E4.m1.9.9.1.1.1.cmml" xref="S2.E4.m1.9.9.1.1.1"><times id="S2.E4.m1.9.9.1.1.1.2.cmml" xref="S2.E4.m1.9.9.1.1.1.2"></times><apply id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4"><apply id="S2.E4.m1.4.4.4.cmml" xref="S2.E4.m1.4.4.4"><eq id="S2.E4.m1.4.4.4.5.cmml" xref="S2.E4.m1.4.4.4.5"></eq><ci id="S2.E4.m1.4.4.4.6.cmml" xref="S2.E4.m1.4.4.4.6">𝑘</ci><list id="S2.E4.m1.4.4.4.7.1.cmml" xref="S2.E4.m1.4.4.4.7.2"><cn type="integer" id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">1</cn><cn type="integer" id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">2</cn><ci id="S2.E4.m1.3.3.3.3.cmml" xref="S2.E4.m1.3.3.3.3">…</ci><ci id="S2.E4.m1.4.4.4.4.cmml" xref="S2.E4.m1.4.4.4.4">𝐾</ci></list></apply><ci id="S2.E4.m1.4.4.5.cmml" xref="S2.E4.m1.4.4.5">argmax</ci></apply><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1"><plus id="S2.E4.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.3"></plus><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.4.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4"><times id="S2.E4.m1.9.9.1.1.1.1.1.1.4.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.1"></times><ci id="S2.E4.m1.9.9.1.1.1.1.1.1.4.2.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.2">𝜆</ci><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3">superscript</csymbol><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.2.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.2.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.2.2.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.2.2">𝑆</ci><list id="S2.E4.m1.6.6.2.3.cmml" xref="S2.E4.m1.6.6.2.4"><ci id="S2.E4.m1.5.5.1.1.cmml" xref="S2.E4.m1.5.5.1.1">𝑖</ci><ci id="S2.E4.m1.6.6.2.2.cmml" xref="S2.E4.m1.6.6.2.2">𝑘</ci></list></apply><ci id="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.3.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.4.3.3">𝑡</ci></apply></apply><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2"><times id="S2.E4.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.3"></times><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1"><minus id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">𝜆</ci></apply><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1"><minus id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1"></minus><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2">superscript</csymbol><apply id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.2.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.2.1.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2">subscript</csymbol><ci id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.2.2.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.2.2">ℒ</ci><list id="S2.E4.m1.8.8.2.3.cmml" xref="S2.E4.m1.8.8.2.4"><ci id="S2.E4.m1.7.7.1.1.cmml" xref="S2.E4.m1.7.7.1.1">𝑖</ci><ci id="S2.E4.m1.8.8.2.2.cmml" xref="S2.E4.m1.8.8.2.2">𝑘</ci></list></apply><ci id="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.3.cmml" xref="S2.E4.m1.9.9.1.1.1.1.1.1.2.2.1.1.2.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.9c">s_{i}^{t}=\underset{k=1,2,\ldots,K}{\mathrm{argmax}}\left(\lambda S_{i,k}^{t}+(1-\lambda)(-\mathcal{L}_{i,k}^{t})\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS2.p5.1" class="ltx_p">where <math id="S2.SS2.SSS2.p5.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.SS2.SSS2.p5.1.m1.1a"><mi id="S2.SS2.SSS2.p5.1.m1.1.1" xref="S2.SS2.SSS2.p5.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p5.1.m1.1b"><ci id="S2.SS2.SSS2.p5.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p5.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p5.1.m1.1c">\lambda</annotation></semantics></math> is a weight parameter that controls the importance of the gradient similarity and the training loss for the cluster identification.
From (3), we see that the cluster identify of each device depends on the gradient similarity and the training loss.</p>
</div>
</section>
<section id="S2.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS2.SSS3.4.1.1" class="ltx_text">II-B</span>3 </span>Local model update</h4>

<div id="S2.SS2.SSS3.p1" class="ltx_para">
<p id="S2.SS2.SSS3.p1.2" class="ltx_p">Given cluster identity <math id="S2.SS2.SSS3.p1.1.m1.1" class="ltx_Math" alttext="s_{i}^{t}" display="inline"><semantics id="S2.SS2.SSS3.p1.1.m1.1a"><msubsup id="S2.SS2.SSS3.p1.1.m1.1.1" xref="S2.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS3.p1.1.m1.1.1.2.2" xref="S2.SS2.SSS3.p1.1.m1.1.1.2.2.cmml">s</mi><mi id="S2.SS2.SSS3.p1.1.m1.1.1.2.3" xref="S2.SS2.SSS3.p1.1.m1.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS3.p1.1.m1.1.1.3" xref="S2.SS2.SSS3.p1.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.1.m1.1b"><apply id="S2.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.1.m1.1.1.2.1.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS3.p1.1.m1.1.1.2.2.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1.2.2">𝑠</ci><ci id="S2.SS2.SSS3.p1.1.m1.1.1.2.3.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.1.m1.1c">s_{i}^{t}</annotation></semantics></math>, device <math id="S2.SS2.SSS3.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.SSS3.p1.2.m2.1a"><mi id="S2.SS2.SSS3.p1.2.m2.1.1" xref="S2.SS2.SSS3.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.2.m2.1b"><ci id="S2.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS3.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.2.m2.1c">i</annotation></semantics></math> updates its local model as</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1.4" class="ltx_Math" alttext="\boldsymbol{w}_{i}^{(t+1)}=\boldsymbol{w}_{s_{i}^{t}}^{t}-\alpha\nabla\mathcal{L}_{i,s_{i}^{t}}^{t}," display="block"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1" xref="S2.E5.m1.4.4.1.1.cmml"><msubsup id="S2.E5.m1.4.4.1.1.2" xref="S2.E5.m1.4.4.1.1.2.cmml"><mi id="S2.E5.m1.4.4.1.1.2.2.2" xref="S2.E5.m1.4.4.1.1.2.2.2.cmml">𝒘</mi><mi id="S2.E5.m1.4.4.1.1.2.2.3" xref="S2.E5.m1.4.4.1.1.2.2.3.cmml">i</mi><mrow id="S2.E5.m1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E5.m1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E5.m1.4.4.1.1.1" xref="S2.E5.m1.4.4.1.1.1.cmml">=</mo><mrow id="S2.E5.m1.4.4.1.1.3" xref="S2.E5.m1.4.4.1.1.3.cmml"><msubsup id="S2.E5.m1.4.4.1.1.3.2" xref="S2.E5.m1.4.4.1.1.3.2.cmml"><mi id="S2.E5.m1.4.4.1.1.3.2.2.2" xref="S2.E5.m1.4.4.1.1.3.2.2.2.cmml">𝒘</mi><msubsup id="S2.E5.m1.4.4.1.1.3.2.2.3" xref="S2.E5.m1.4.4.1.1.3.2.2.3.cmml"><mi id="S2.E5.m1.4.4.1.1.3.2.2.3.2.2" xref="S2.E5.m1.4.4.1.1.3.2.2.3.2.2.cmml">s</mi><mi id="S2.E5.m1.4.4.1.1.3.2.2.3.2.3" xref="S2.E5.m1.4.4.1.1.3.2.2.3.2.3.cmml">i</mi><mi id="S2.E5.m1.4.4.1.1.3.2.2.3.3" xref="S2.E5.m1.4.4.1.1.3.2.2.3.3.cmml">t</mi></msubsup><mi id="S2.E5.m1.4.4.1.1.3.2.3" xref="S2.E5.m1.4.4.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S2.E5.m1.4.4.1.1.3.1" xref="S2.E5.m1.4.4.1.1.3.1.cmml">−</mo><mrow id="S2.E5.m1.4.4.1.1.3.3" xref="S2.E5.m1.4.4.1.1.3.3.cmml"><mi id="S2.E5.m1.4.4.1.1.3.3.2" xref="S2.E5.m1.4.4.1.1.3.3.2.cmml">α</mi><mo lspace="0.167em" rspace="0em" id="S2.E5.m1.4.4.1.1.3.3.1" xref="S2.E5.m1.4.4.1.1.3.3.1.cmml">​</mo><mrow id="S2.E5.m1.4.4.1.1.3.3.3" xref="S2.E5.m1.4.4.1.1.3.3.3.cmml"><mo rspace="0.167em" id="S2.E5.m1.4.4.1.1.3.3.3.1" xref="S2.E5.m1.4.4.1.1.3.3.3.1.cmml">∇</mo><msubsup id="S2.E5.m1.4.4.1.1.3.3.3.2" xref="S2.E5.m1.4.4.1.1.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.4.4.1.1.3.3.3.2.2.2" xref="S2.E5.m1.4.4.1.1.3.3.3.2.2.2.cmml">ℒ</mi><mrow id="S2.E5.m1.3.3.2.2" xref="S2.E5.m1.3.3.2.3.cmml"><mi id="S2.E5.m1.2.2.1.1" xref="S2.E5.m1.2.2.1.1.cmml">i</mi><mo id="S2.E5.m1.3.3.2.2.2" xref="S2.E5.m1.3.3.2.3.cmml">,</mo><msubsup id="S2.E5.m1.3.3.2.2.1" xref="S2.E5.m1.3.3.2.2.1.cmml"><mi id="S2.E5.m1.3.3.2.2.1.2.2" xref="S2.E5.m1.3.3.2.2.1.2.2.cmml">s</mi><mi id="S2.E5.m1.3.3.2.2.1.2.3" xref="S2.E5.m1.3.3.2.2.1.2.3.cmml">i</mi><mi id="S2.E5.m1.3.3.2.2.1.3" xref="S2.E5.m1.3.3.2.2.1.3.cmml">t</mi></msubsup></mrow><mi id="S2.E5.m1.4.4.1.1.3.3.3.2.3" xref="S2.E5.m1.4.4.1.1.3.3.3.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow></mrow><mo id="S2.E5.m1.4.4.1.2" xref="S2.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.1.1.cmml" xref="S2.E5.m1.4.4.1"><eq id="S2.E5.m1.4.4.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1"></eq><apply id="S2.E5.m1.4.4.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.2.1.cmml" xref="S2.E5.m1.4.4.1.1.2">superscript</csymbol><apply id="S2.E5.m1.4.4.1.1.2.2.cmml" xref="S2.E5.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.2.2.1.cmml" xref="S2.E5.m1.4.4.1.1.2">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.2.2.2">𝒘</ci><ci id="S2.E5.m1.4.4.1.1.2.2.3.cmml" xref="S2.E5.m1.4.4.1.1.2.2.3">𝑖</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1"><plus id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1"></plus><ci id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S2.E5.m1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.E5.m1.4.4.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.3"><minus id="S2.E5.m1.4.4.1.1.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3.1"></minus><apply id="S2.E5.m1.4.4.1.1.3.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.2.1.cmml" xref="S2.E5.m1.4.4.1.1.3.2">superscript</csymbol><apply id="S2.E5.m1.4.4.1.1.3.2.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.2.2.1.cmml" xref="S2.E5.m1.4.4.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.3.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.2">𝒘</ci><apply id="S2.E5.m1.4.4.1.1.3.2.2.3.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.2.2.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.3">superscript</csymbol><apply id="S2.E5.m1.4.4.1.1.3.2.2.3.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.2.2.3.2.1.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.3.2.2.3.2.2.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.3.2.2">𝑠</ci><ci id="S2.E5.m1.4.4.1.1.3.2.2.3.2.3.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.3.2.3">𝑖</ci></apply><ci id="S2.E5.m1.4.4.1.1.3.2.2.3.3.cmml" xref="S2.E5.m1.4.4.1.1.3.2.2.3.3">𝑡</ci></apply></apply><ci id="S2.E5.m1.4.4.1.1.3.2.3.cmml" xref="S2.E5.m1.4.4.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E5.m1.4.4.1.1.3.3.cmml" xref="S2.E5.m1.4.4.1.1.3.3"><times id="S2.E5.m1.4.4.1.1.3.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3.3.1"></times><ci id="S2.E5.m1.4.4.1.1.3.3.2.cmml" xref="S2.E5.m1.4.4.1.1.3.3.2">𝛼</ci><apply id="S2.E5.m1.4.4.1.1.3.3.3.cmml" xref="S2.E5.m1.4.4.1.1.3.3.3"><ci id="S2.E5.m1.4.4.1.1.3.3.3.1.cmml" xref="S2.E5.m1.4.4.1.1.3.3.3.1">∇</ci><apply id="S2.E5.m1.4.4.1.1.3.3.3.2.cmml" xref="S2.E5.m1.4.4.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.3.3.2.1.cmml" xref="S2.E5.m1.4.4.1.1.3.3.3.2">superscript</csymbol><apply id="S2.E5.m1.4.4.1.1.3.3.3.2.2.cmml" xref="S2.E5.m1.4.4.1.1.3.3.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.3.3.3.2.2.1.cmml" xref="S2.E5.m1.4.4.1.1.3.3.3.2">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.3.3.3.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.3.3.3.2.2.2">ℒ</ci><list id="S2.E5.m1.3.3.2.3.cmml" xref="S2.E5.m1.3.3.2.2"><ci id="S2.E5.m1.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1.1">𝑖</ci><apply id="S2.E5.m1.3.3.2.2.1.cmml" xref="S2.E5.m1.3.3.2.2.1"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.2.2.1.1.cmml" xref="S2.E5.m1.3.3.2.2.1">superscript</csymbol><apply id="S2.E5.m1.3.3.2.2.1.2.cmml" xref="S2.E5.m1.3.3.2.2.1"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.2.2.1.2.1.cmml" xref="S2.E5.m1.3.3.2.2.1">subscript</csymbol><ci id="S2.E5.m1.3.3.2.2.1.2.2.cmml" xref="S2.E5.m1.3.3.2.2.1.2.2">𝑠</ci><ci id="S2.E5.m1.3.3.2.2.1.2.3.cmml" xref="S2.E5.m1.3.3.2.2.1.2.3">𝑖</ci></apply><ci id="S2.E5.m1.3.3.2.2.1.3.cmml" xref="S2.E5.m1.3.3.2.2.1.3">𝑡</ci></apply></list></apply><ci id="S2.E5.m1.4.4.1.1.3.3.3.2.3.cmml" xref="S2.E5.m1.4.4.1.1.3.3.3.2.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">\boldsymbol{w}_{i}^{(t+1)}=\boldsymbol{w}_{s_{i}^{t}}^{t}-\alpha\nabla\mathcal{L}_{i,s_{i}^{t}}^{t},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS3.p1.6" class="ltx_p">where <math id="S2.SS2.SSS3.p1.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S2.SS2.SSS3.p1.3.m1.1a"><mi id="S2.SS2.SSS3.p1.3.m1.1.1" xref="S2.SS2.SSS3.p1.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.3.m1.1b"><ci id="S2.SS2.SSS3.p1.3.m1.1.1.cmml" xref="S2.SS2.SSS3.p1.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.3.m1.1c">\alpha</annotation></semantics></math> is the learning rate. Then, device <math id="S2.SS2.SSS3.p1.4.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS2.SSS3.p1.4.m2.1a"><mi id="S2.SS2.SSS3.p1.4.m2.1.1" xref="S2.SS2.SSS3.p1.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.4.m2.1b"><ci id="S2.SS2.SSS3.p1.4.m2.1.1.cmml" xref="S2.SS2.SSS3.p1.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.4.m2.1c">i</annotation></semantics></math> transmits its updated FL model parameters <math id="S2.SS2.SSS3.p1.5.m3.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}^{(t+1)}" display="inline"><semantics id="S2.SS2.SSS3.p1.5.m3.1a"><msubsup id="S2.SS2.SSS3.p1.5.m3.1.2" xref="S2.SS2.SSS3.p1.5.m3.1.2.cmml"><mi id="S2.SS2.SSS3.p1.5.m3.1.2.2.2" xref="S2.SS2.SSS3.p1.5.m3.1.2.2.2.cmml">𝒘</mi><mi id="S2.SS2.SSS3.p1.5.m3.1.2.2.3" xref="S2.SS2.SSS3.p1.5.m3.1.2.2.3.cmml">i</mi><mrow id="S2.SS2.SSS3.p1.5.m3.1.1.1.1" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.2" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.2" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.2.cmml">t</mi><mo id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.1" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.1.cmml">+</mo><mn id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.3" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.3" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.5.m3.1b"><apply id="S2.SS2.SSS3.p1.5.m3.1.2.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.5.m3.1.2.1.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.2">superscript</csymbol><apply id="S2.SS2.SSS3.p1.5.m3.1.2.2.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.5.m3.1.2.2.1.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.2">subscript</csymbol><ci id="S2.SS2.SSS3.p1.5.m3.1.2.2.2.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.2.2.2">𝒘</ci><ci id="S2.SS2.SSS3.p1.5.m3.1.2.2.3.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.2.2.3">𝑖</ci></apply><apply id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1"><plus id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.1"></plus><ci id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.3.cmml" xref="S2.SS2.SSS3.p1.5.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.5.m3.1c">\boldsymbol{w}_{i}^{(t+1)}</annotation></semantics></math> and the cluster identity <math id="S2.SS2.SSS3.p1.6.m4.1" class="ltx_Math" alttext="s_{i}^{t}" display="inline"><semantics id="S2.SS2.SSS3.p1.6.m4.1a"><msubsup id="S2.SS2.SSS3.p1.6.m4.1.1" xref="S2.SS2.SSS3.p1.6.m4.1.1.cmml"><mi id="S2.SS2.SSS3.p1.6.m4.1.1.2.2" xref="S2.SS2.SSS3.p1.6.m4.1.1.2.2.cmml">s</mi><mi id="S2.SS2.SSS3.p1.6.m4.1.1.2.3" xref="S2.SS2.SSS3.p1.6.m4.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS3.p1.6.m4.1.1.3" xref="S2.SS2.SSS3.p1.6.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS3.p1.6.m4.1b"><apply id="S2.SS2.SSS3.p1.6.m4.1.1.cmml" xref="S2.SS2.SSS3.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.6.m4.1.1.1.cmml" xref="S2.SS2.SSS3.p1.6.m4.1.1">superscript</csymbol><apply id="S2.SS2.SSS3.p1.6.m4.1.1.2.cmml" xref="S2.SS2.SSS3.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS3.p1.6.m4.1.1.2.1.cmml" xref="S2.SS2.SSS3.p1.6.m4.1.1">subscript</csymbol><ci id="S2.SS2.SSS3.p1.6.m4.1.1.2.2.cmml" xref="S2.SS2.SSS3.p1.6.m4.1.1.2.2">𝑠</ci><ci id="S2.SS2.SSS3.p1.6.m4.1.1.2.3.cmml" xref="S2.SS2.SSS3.p1.6.m4.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS3.p1.6.m4.1.1.3.cmml" xref="S2.SS2.SSS3.p1.6.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS3.p1.6.m4.1c">s_{i}^{t}</annotation></semantics></math> to the PS.</p>
</div>
</section>
<section id="S2.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S2.SS2.SSS4.4.1.1" class="ltx_text">II-B</span>4 </span>Local FL model aggregation</h4>

<div id="S2.SS2.SSS4.p1" class="ltx_para">
<p id="S2.SS2.SSS4.p1.3" class="ltx_p">The uploaded models with the same cluster identity <math id="S2.SS2.SSS4.p1.1.m1.1" class="ltx_Math" alttext="s_{i}^{t}" display="inline"><semantics id="S2.SS2.SSS4.p1.1.m1.1a"><msubsup id="S2.SS2.SSS4.p1.1.m1.1.1" xref="S2.SS2.SSS4.p1.1.m1.1.1.cmml"><mi id="S2.SS2.SSS4.p1.1.m1.1.1.2.2" xref="S2.SS2.SSS4.p1.1.m1.1.1.2.2.cmml">s</mi><mi id="S2.SS2.SSS4.p1.1.m1.1.1.2.3" xref="S2.SS2.SSS4.p1.1.m1.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS4.p1.1.m1.1.1.3" xref="S2.SS2.SSS4.p1.1.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.1.m1.1b"><apply id="S2.SS2.SSS4.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p1.1.m1.1.1.1.cmml" xref="S2.SS2.SSS4.p1.1.m1.1.1">superscript</csymbol><apply id="S2.SS2.SSS4.p1.1.m1.1.1.2.cmml" xref="S2.SS2.SSS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p1.1.m1.1.1.2.1.cmml" xref="S2.SS2.SSS4.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.SSS4.p1.1.m1.1.1.2.2.cmml" xref="S2.SS2.SSS4.p1.1.m1.1.1.2.2">𝑠</ci><ci id="S2.SS2.SSS4.p1.1.m1.1.1.2.3.cmml" xref="S2.SS2.SSS4.p1.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS4.p1.1.m1.1.1.3.cmml" xref="S2.SS2.SSS4.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.1.m1.1c">s_{i}^{t}</annotation></semantics></math> are aggregated by the PS so as to generate a global model of cluster <math id="S2.SS2.SSS4.p1.2.m2.1" class="ltx_Math" alttext="s_{i}^{t}" display="inline"><semantics id="S2.SS2.SSS4.p1.2.m2.1a"><msubsup id="S2.SS2.SSS4.p1.2.m2.1.1" xref="S2.SS2.SSS4.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS4.p1.2.m2.1.1.2.2" xref="S2.SS2.SSS4.p1.2.m2.1.1.2.2.cmml">s</mi><mi id="S2.SS2.SSS4.p1.2.m2.1.1.2.3" xref="S2.SS2.SSS4.p1.2.m2.1.1.2.3.cmml">i</mi><mi id="S2.SS2.SSS4.p1.2.m2.1.1.3" xref="S2.SS2.SSS4.p1.2.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.2.m2.1b"><apply id="S2.SS2.SSS4.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS4.p1.2.m2.1.1">superscript</csymbol><apply id="S2.SS2.SSS4.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS4.p1.2.m2.1.1.2.1.cmml" xref="S2.SS2.SSS4.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.SSS4.p1.2.m2.1.1.2.2.cmml" xref="S2.SS2.SSS4.p1.2.m2.1.1.2.2">𝑠</ci><ci id="S2.SS2.SSS4.p1.2.m2.1.1.2.3.cmml" xref="S2.SS2.SSS4.p1.2.m2.1.1.2.3">𝑖</ci></apply><ci id="S2.SS2.SSS4.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS4.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.2.m2.1c">s_{i}^{t}</annotation></semantics></math>.
Denote the set of devices identified as cluster <math id="S2.SS2.SSS4.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.SSS4.p1.3.m3.1a"><mi id="S2.SS2.SSS4.p1.3.m3.1.1" xref="S2.SS2.SSS4.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.3.m3.1b"><ci id="S2.SS2.SSS4.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS4.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.3.m3.1c">k</annotation></semantics></math> as</p>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1.2" class="ltx_Math" alttext="\mathcal{M}_{k}=\{i|i\in\mathcal{M},s_{i}^{t}=k\}." display="block"><semantics id="S2.E6.m1.2a"><mrow id="S2.E6.m1.2.2.1" xref="S2.E6.m1.2.2.1.1.cmml"><mrow id="S2.E6.m1.2.2.1.1" xref="S2.E6.m1.2.2.1.1.cmml"><msub id="S2.E6.m1.2.2.1.1.3" xref="S2.E6.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.2.2.1.1.3.2" xref="S2.E6.m1.2.2.1.1.3.2.cmml">ℳ</mi><mi id="S2.E6.m1.2.2.1.1.3.3" xref="S2.E6.m1.2.2.1.1.3.3.cmml">k</mi></msub><mo id="S2.E6.m1.2.2.1.1.2" xref="S2.E6.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E6.m1.2.2.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E6.m1.2.2.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.2.1.cmml">{</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">i</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.2.2.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.2.1.cmml">|</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.3.cmml"><mrow id="S2.E6.m1.2.2.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml">ℳ</mi></mrow><mo id="S2.E6.m1.2.2.1.1.1.1.1.2.3" xref="S2.E6.m1.2.2.1.1.1.1.1.3a.cmml">,</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.1.2.2" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.cmml"><msubsup id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.2" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml">s</mi><mi id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.3" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mi id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">t</mi></msubsup><mo id="S2.E6.m1.2.2.1.1.1.1.1.2.2.1" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.1.cmml">=</mo><mi id="S2.E6.m1.2.2.1.1.1.1.1.2.2.3" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.3.cmml">k</mi></mrow></mrow><mo stretchy="false" id="S2.E6.m1.2.2.1.1.1.1.4" xref="S2.E6.m1.2.2.1.1.1.2.1.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S2.E6.m1.2.2.1.2" xref="S2.E6.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.2b"><apply id="S2.E6.m1.2.2.1.1.cmml" xref="S2.E6.m1.2.2.1"><eq id="S2.E6.m1.2.2.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.2"></eq><apply id="S2.E6.m1.2.2.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.3.1.cmml" xref="S2.E6.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.3.2.cmml" xref="S2.E6.m1.2.2.1.1.3.2">ℳ</ci><ci id="S2.E6.m1.2.2.1.1.3.3.cmml" xref="S2.E6.m1.2.2.1.1.3.3">𝑘</ci></apply><apply id="S2.E6.m1.2.2.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.2.2.1.1.1.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2">conditional-set</csymbol><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝑖</ci><apply id="S2.E6.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.3a.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1"><in id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.1"></in><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.3">ℳ</ci></apply><apply id="S2.E6.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2"><eq id="S2.E6.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.1"></eq><apply id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.2">𝑠</ci><ci id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S2.E6.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.2.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.2c">\mathcal{M}_{k}=\{i|i\in\mathcal{M},s_{i}^{t}=k\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.SSS4.p1.4" class="ltx_p">The global model aggregation of cluster <math id="S2.SS2.SSS4.p1.4.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS2.SSS4.p1.4.m1.1a"><mi id="S2.SS2.SSS4.p1.4.m1.1.1" xref="S2.SS2.SSS4.p1.4.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS4.p1.4.m1.1b"><ci id="S2.SS2.SSS4.p1.4.m1.1.1.cmml" xref="S2.SS2.SSS4.p1.4.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS4.p1.4.m1.1c">k</annotation></semantics></math> can be represented as</p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1.3" class="ltx_Math" alttext="\boldsymbol{w}_{k}^{(t+1)}=\frac{1}{|\mathcal{M}_{k}|}\sum_{i\in\mathcal{M}_{k}}\boldsymbol{w}_{i}^{(t+1)}" display="block"><semantics id="S2.E7.m1.3a"><mrow id="S2.E7.m1.3.4" xref="S2.E7.m1.3.4.cmml"><msubsup id="S2.E7.m1.3.4.2" xref="S2.E7.m1.3.4.2.cmml"><mi id="S2.E7.m1.3.4.2.2.2" xref="S2.E7.m1.3.4.2.2.2.cmml">𝒘</mi><mi id="S2.E7.m1.3.4.2.2.3" xref="S2.E7.m1.3.4.2.2.3.cmml">k</mi><mrow id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E7.m1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E7.m1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S2.E7.m1.3.4.1" xref="S2.E7.m1.3.4.1.cmml">=</mo><mrow id="S2.E7.m1.3.4.3" xref="S2.E7.m1.3.4.3.cmml"><mfrac id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml"><mn id="S2.E7.m1.2.2.3" xref="S2.E7.m1.2.2.3.cmml">1</mn><mrow id="S2.E7.m1.2.2.1.1" xref="S2.E7.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.E7.m1.2.2.1.1.2" xref="S2.E7.m1.2.2.1.2.1.cmml">|</mo><msub id="S2.E7.m1.2.2.1.1.1" xref="S2.E7.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.2.2.1.1.1.2" xref="S2.E7.m1.2.2.1.1.1.2.cmml">ℳ</mi><mi id="S2.E7.m1.2.2.1.1.1.3" xref="S2.E7.m1.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E7.m1.2.2.1.1.3" xref="S2.E7.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S2.E7.m1.3.4.3.1" xref="S2.E7.m1.3.4.3.1.cmml">​</mo><mrow id="S2.E7.m1.3.4.3.2" xref="S2.E7.m1.3.4.3.2.cmml"><munder id="S2.E7.m1.3.4.3.2.1" xref="S2.E7.m1.3.4.3.2.1.cmml"><mo movablelimits="false" id="S2.E7.m1.3.4.3.2.1.2" xref="S2.E7.m1.3.4.3.2.1.2.cmml">∑</mo><mrow id="S2.E7.m1.3.4.3.2.1.3" xref="S2.E7.m1.3.4.3.2.1.3.cmml"><mi id="S2.E7.m1.3.4.3.2.1.3.2" xref="S2.E7.m1.3.4.3.2.1.3.2.cmml">i</mi><mo id="S2.E7.m1.3.4.3.2.1.3.1" xref="S2.E7.m1.3.4.3.2.1.3.1.cmml">∈</mo><msub id="S2.E7.m1.3.4.3.2.1.3.3" xref="S2.E7.m1.3.4.3.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.3.4.3.2.1.3.3.2" xref="S2.E7.m1.3.4.3.2.1.3.3.2.cmml">ℳ</mi><mi id="S2.E7.m1.3.4.3.2.1.3.3.3" xref="S2.E7.m1.3.4.3.2.1.3.3.3.cmml">k</mi></msub></mrow></munder><msubsup id="S2.E7.m1.3.4.3.2.2" xref="S2.E7.m1.3.4.3.2.2.cmml"><mi id="S2.E7.m1.3.4.3.2.2.2.2" xref="S2.E7.m1.3.4.3.2.2.2.2.cmml">𝒘</mi><mi id="S2.E7.m1.3.4.3.2.2.2.3" xref="S2.E7.m1.3.4.3.2.2.2.3.cmml">i</mi><mrow id="S2.E7.m1.3.3.1.1" xref="S2.E7.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.3.3.1.1.2" xref="S2.E7.m1.3.3.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.3.3.1.1.1" xref="S2.E7.m1.3.3.1.1.1.cmml"><mi id="S2.E7.m1.3.3.1.1.1.2" xref="S2.E7.m1.3.3.1.1.1.2.cmml">t</mi><mo id="S2.E7.m1.3.3.1.1.1.1" xref="S2.E7.m1.3.3.1.1.1.1.cmml">+</mo><mn id="S2.E7.m1.3.3.1.1.1.3" xref="S2.E7.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E7.m1.3.3.1.1.3" xref="S2.E7.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.3b"><apply id="S2.E7.m1.3.4.cmml" xref="S2.E7.m1.3.4"><eq id="S2.E7.m1.3.4.1.cmml" xref="S2.E7.m1.3.4.1"></eq><apply id="S2.E7.m1.3.4.2.cmml" xref="S2.E7.m1.3.4.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.4.2.1.cmml" xref="S2.E7.m1.3.4.2">superscript</csymbol><apply id="S2.E7.m1.3.4.2.2.cmml" xref="S2.E7.m1.3.4.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.4.2.2.1.cmml" xref="S2.E7.m1.3.4.2">subscript</csymbol><ci id="S2.E7.m1.3.4.2.2.2.cmml" xref="S2.E7.m1.3.4.2.2.2">𝒘</ci><ci id="S2.E7.m1.3.4.2.2.3.cmml" xref="S2.E7.m1.3.4.2.2.3">𝑘</ci></apply><apply id="S2.E7.m1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1"><plus id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1"></plus><ci id="S2.E7.m1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S2.E7.m1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S2.E7.m1.3.4.3.cmml" xref="S2.E7.m1.3.4.3"><times id="S2.E7.m1.3.4.3.1.cmml" xref="S2.E7.m1.3.4.3.1"></times><apply id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2"><divide id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2"></divide><cn type="integer" id="S2.E7.m1.2.2.3.cmml" xref="S2.E7.m1.2.2.3">1</cn><apply id="S2.E7.m1.2.2.1.2.cmml" xref="S2.E7.m1.2.2.1.1"><abs id="S2.E7.m1.2.2.1.2.1.cmml" xref="S2.E7.m1.2.2.1.1.2"></abs><apply id="S2.E7.m1.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.E7.m1.2.2.1.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.1.2">ℳ</ci><ci id="S2.E7.m1.2.2.1.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="S2.E7.m1.3.4.3.2.cmml" xref="S2.E7.m1.3.4.3.2"><apply id="S2.E7.m1.3.4.3.2.1.cmml" xref="S2.E7.m1.3.4.3.2.1"><csymbol cd="ambiguous" id="S2.E7.m1.3.4.3.2.1.1.cmml" xref="S2.E7.m1.3.4.3.2.1">subscript</csymbol><sum id="S2.E7.m1.3.4.3.2.1.2.cmml" xref="S2.E7.m1.3.4.3.2.1.2"></sum><apply id="S2.E7.m1.3.4.3.2.1.3.cmml" xref="S2.E7.m1.3.4.3.2.1.3"><in id="S2.E7.m1.3.4.3.2.1.3.1.cmml" xref="S2.E7.m1.3.4.3.2.1.3.1"></in><ci id="S2.E7.m1.3.4.3.2.1.3.2.cmml" xref="S2.E7.m1.3.4.3.2.1.3.2">𝑖</ci><apply id="S2.E7.m1.3.4.3.2.1.3.3.cmml" xref="S2.E7.m1.3.4.3.2.1.3.3"><csymbol cd="ambiguous" id="S2.E7.m1.3.4.3.2.1.3.3.1.cmml" xref="S2.E7.m1.3.4.3.2.1.3.3">subscript</csymbol><ci id="S2.E7.m1.3.4.3.2.1.3.3.2.cmml" xref="S2.E7.m1.3.4.3.2.1.3.3.2">ℳ</ci><ci id="S2.E7.m1.3.4.3.2.1.3.3.3.cmml" xref="S2.E7.m1.3.4.3.2.1.3.3.3">𝑘</ci></apply></apply></apply><apply id="S2.E7.m1.3.4.3.2.2.cmml" xref="S2.E7.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.4.3.2.2.1.cmml" xref="S2.E7.m1.3.4.3.2.2">superscript</csymbol><apply id="S2.E7.m1.3.4.3.2.2.2.cmml" xref="S2.E7.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.4.3.2.2.2.1.cmml" xref="S2.E7.m1.3.4.3.2.2">subscript</csymbol><ci id="S2.E7.m1.3.4.3.2.2.2.2.cmml" xref="S2.E7.m1.3.4.3.2.2.2.2">𝒘</ci><ci id="S2.E7.m1.3.4.3.2.2.2.3.cmml" xref="S2.E7.m1.3.4.3.2.2.2.3">𝑖</ci></apply><apply id="S2.E7.m1.3.3.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1"><plus id="S2.E7.m1.3.3.1.1.1.1.cmml" xref="S2.E7.m1.3.3.1.1.1.1"></plus><ci id="S2.E7.m1.3.3.1.1.1.2.cmml" xref="S2.E7.m1.3.3.1.1.1.2">𝑡</ci><cn type="integer" id="S2.E7.m1.3.3.1.1.1.3.cmml" xref="S2.E7.m1.3.3.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.3c">\boldsymbol{w}_{k}^{(t+1)}=\frac{1}{|\mathcal{M}_{k}|}\sum_{i\in\mathcal{M}_{k}}\boldsymbol{w}_{i}^{(t+1)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS2.SSS4.p2" class="ltx_para">
<p id="S2.SS2.SSS4.p2.1" class="ltx_p">The full procedure of our proposed clustered FL algorithm is summarized in Algorithm <a href="#alg1" title="Algorithm 1 ‣ II-B4 Local FL model aggregation ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Proposed Clustered Federated Learning</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Input: </span> number of clusters <math id="alg1.l1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">K</annotation></semantics></math>, number of clustering iterations <math id="alg1.l1.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">T</annotation></semantics></math>, number of devices <math id="alg1.l1.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">M</annotation></semantics></math>, set of devices <math id="alg1.l1.m4.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="alg1.l1.m4.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">\mathcal{M}</annotation></semantics></math>, learning rate <math id="alg1.l1.m5.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="alg1.l1.m5.1a"><mi id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><ci id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">\lambda</annotation></semantics></math>, <math id="alg1.l1.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">K</annotation></semantics></math> initial cluster models <math id="alg1.l1.m7.7" class="ltx_Math" alttext="\{\boldsymbol{w}_{1}^{(0)},\boldsymbol{w}_{2}^{(0)},\ldots,\boldsymbol{w}_{K}^{(0)}\}" display="inline"><semantics id="alg1.l1.m7.7a"><mrow id="alg1.l1.m7.7.7.3" xref="alg1.l1.m7.7.7.4.cmml"><mo stretchy="false" id="alg1.l1.m7.7.7.3.4" xref="alg1.l1.m7.7.7.4.cmml">{</mo><msubsup id="alg1.l1.m7.5.5.1.1" xref="alg1.l1.m7.5.5.1.1.cmml"><mi id="alg1.l1.m7.5.5.1.1.2.2" xref="alg1.l1.m7.5.5.1.1.2.2.cmml">𝒘</mi><mn id="alg1.l1.m7.5.5.1.1.2.3" xref="alg1.l1.m7.5.5.1.1.2.3.cmml">1</mn><mrow id="alg1.l1.m7.1.1.1.3" xref="alg1.l1.m7.5.5.1.1.cmml"><mo stretchy="false" id="alg1.l1.m7.1.1.1.3.1" xref="alg1.l1.m7.5.5.1.1.cmml">(</mo><mn id="alg1.l1.m7.1.1.1.1" xref="alg1.l1.m7.1.1.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l1.m7.1.1.1.3.2" xref="alg1.l1.m7.5.5.1.1.cmml">)</mo></mrow></msubsup><mo id="alg1.l1.m7.7.7.3.5" xref="alg1.l1.m7.7.7.4.cmml">,</mo><msubsup id="alg1.l1.m7.6.6.2.2" xref="alg1.l1.m7.6.6.2.2.cmml"><mi id="alg1.l1.m7.6.6.2.2.2.2" xref="alg1.l1.m7.6.6.2.2.2.2.cmml">𝒘</mi><mn id="alg1.l1.m7.6.6.2.2.2.3" xref="alg1.l1.m7.6.6.2.2.2.3.cmml">2</mn><mrow id="alg1.l1.m7.2.2.1.3" xref="alg1.l1.m7.6.6.2.2.cmml"><mo stretchy="false" id="alg1.l1.m7.2.2.1.3.1" xref="alg1.l1.m7.6.6.2.2.cmml">(</mo><mn id="alg1.l1.m7.2.2.1.1" xref="alg1.l1.m7.2.2.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l1.m7.2.2.1.3.2" xref="alg1.l1.m7.6.6.2.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l1.m7.7.7.3.6" xref="alg1.l1.m7.7.7.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m7.4.4" xref="alg1.l1.m7.4.4.cmml">…</mi><mo id="alg1.l1.m7.7.7.3.7" xref="alg1.l1.m7.7.7.4.cmml">,</mo><msubsup id="alg1.l1.m7.7.7.3.3" xref="alg1.l1.m7.7.7.3.3.cmml"><mi id="alg1.l1.m7.7.7.3.3.2.2" xref="alg1.l1.m7.7.7.3.3.2.2.cmml">𝒘</mi><mi id="alg1.l1.m7.7.7.3.3.2.3" xref="alg1.l1.m7.7.7.3.3.2.3.cmml">K</mi><mrow id="alg1.l1.m7.3.3.1.3" xref="alg1.l1.m7.7.7.3.3.cmml"><mo stretchy="false" id="alg1.l1.m7.3.3.1.3.1" xref="alg1.l1.m7.7.7.3.3.cmml">(</mo><mn id="alg1.l1.m7.3.3.1.1" xref="alg1.l1.m7.3.3.1.1.cmml">0</mn><mo stretchy="false" id="alg1.l1.m7.3.3.1.3.2" xref="alg1.l1.m7.7.7.3.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l1.m7.7.7.3.8" xref="alg1.l1.m7.7.7.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m7.7b"><set id="alg1.l1.m7.7.7.4.cmml" xref="alg1.l1.m7.7.7.3"><apply id="alg1.l1.m7.5.5.1.1.cmml" xref="alg1.l1.m7.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m7.5.5.1.1.1.cmml" xref="alg1.l1.m7.5.5.1.1">superscript</csymbol><apply id="alg1.l1.m7.5.5.1.1.2.cmml" xref="alg1.l1.m7.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m7.5.5.1.1.2.1.cmml" xref="alg1.l1.m7.5.5.1.1">subscript</csymbol><ci id="alg1.l1.m7.5.5.1.1.2.2.cmml" xref="alg1.l1.m7.5.5.1.1.2.2">𝒘</ci><cn type="integer" id="alg1.l1.m7.5.5.1.1.2.3.cmml" xref="alg1.l1.m7.5.5.1.1.2.3">1</cn></apply><cn type="integer" id="alg1.l1.m7.1.1.1.1.cmml" xref="alg1.l1.m7.1.1.1.1">0</cn></apply><apply id="alg1.l1.m7.6.6.2.2.cmml" xref="alg1.l1.m7.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l1.m7.6.6.2.2.1.cmml" xref="alg1.l1.m7.6.6.2.2">superscript</csymbol><apply id="alg1.l1.m7.6.6.2.2.2.cmml" xref="alg1.l1.m7.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l1.m7.6.6.2.2.2.1.cmml" xref="alg1.l1.m7.6.6.2.2">subscript</csymbol><ci id="alg1.l1.m7.6.6.2.2.2.2.cmml" xref="alg1.l1.m7.6.6.2.2.2.2">𝒘</ci><cn type="integer" id="alg1.l1.m7.6.6.2.2.2.3.cmml" xref="alg1.l1.m7.6.6.2.2.2.3">2</cn></apply><cn type="integer" id="alg1.l1.m7.2.2.1.1.cmml" xref="alg1.l1.m7.2.2.1.1">0</cn></apply><ci id="alg1.l1.m7.4.4.cmml" xref="alg1.l1.m7.4.4">…</ci><apply id="alg1.l1.m7.7.7.3.3.cmml" xref="alg1.l1.m7.7.7.3.3"><csymbol cd="ambiguous" id="alg1.l1.m7.7.7.3.3.1.cmml" xref="alg1.l1.m7.7.7.3.3">superscript</csymbol><apply id="alg1.l1.m7.7.7.3.3.2.cmml" xref="alg1.l1.m7.7.7.3.3"><csymbol cd="ambiguous" id="alg1.l1.m7.7.7.3.3.2.1.cmml" xref="alg1.l1.m7.7.7.3.3">subscript</csymbol><ci id="alg1.l1.m7.7.7.3.3.2.2.cmml" xref="alg1.l1.m7.7.7.3.3.2.2">𝒘</ci><ci id="alg1.l1.m7.7.7.3.3.2.3.cmml" xref="alg1.l1.m7.7.7.3.3.2.3">𝐾</ci></apply><cn type="integer" id="alg1.l1.m7.3.3.1.1.cmml" xref="alg1.l1.m7.3.3.1.1">0</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m7.7c">\{\boldsymbol{w}_{1}^{(0)},\boldsymbol{w}_{2}^{(0)},\ldots,\boldsymbol{w}_{K}^{(0)}\}</annotation></semantics></math>.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.4" class="ltx_Math" alttext="t=0,1,\ldots,T-1" display="inline"><semantics id="alg1.l2.m1.4a"><mrow id="alg1.l2.m1.4.4" xref="alg1.l2.m1.4.4.cmml"><mi id="alg1.l2.m1.4.4.3" xref="alg1.l2.m1.4.4.3.cmml">t</mi><mo id="alg1.l2.m1.4.4.2" xref="alg1.l2.m1.4.4.2.cmml">=</mo><mrow id="alg1.l2.m1.4.4.1.1" xref="alg1.l2.m1.4.4.1.2.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">0</mn><mo id="alg1.l2.m1.4.4.1.1.2" xref="alg1.l2.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">1</mn><mo id="alg1.l2.m1.4.4.1.1.3" xref="alg1.l2.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">…</mi><mo id="alg1.l2.m1.4.4.1.1.4" xref="alg1.l2.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l2.m1.4.4.1.1.1" xref="alg1.l2.m1.4.4.1.1.1.cmml"><mi id="alg1.l2.m1.4.4.1.1.1.2" xref="alg1.l2.m1.4.4.1.1.1.2.cmml">T</mi><mo id="alg1.l2.m1.4.4.1.1.1.1" xref="alg1.l2.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l2.m1.4.4.1.1.1.3" xref="alg1.l2.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.4b"><apply id="alg1.l2.m1.4.4.cmml" xref="alg1.l2.m1.4.4"><eq id="alg1.l2.m1.4.4.2.cmml" xref="alg1.l2.m1.4.4.2"></eq><ci id="alg1.l2.m1.4.4.3.cmml" xref="alg1.l2.m1.4.4.3">𝑡</ci><list id="alg1.l2.m1.4.4.1.2.cmml" xref="alg1.l2.m1.4.4.1.1"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">0</cn><cn type="integer" id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">1</cn><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">…</ci><apply id="alg1.l2.m1.4.4.1.1.1.cmml" xref="alg1.l2.m1.4.4.1.1.1"><minus id="alg1.l2.m1.4.4.1.1.1.1.cmml" xref="alg1.l2.m1.4.4.1.1.1.1"></minus><ci id="alg1.l2.m1.4.4.1.1.1.2.cmml" xref="alg1.l2.m1.4.4.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l2.m1.4.4.1.1.1.3.cmml" xref="alg1.l2.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.4c">t=0,1,\ldots,T-1</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3.2" class="ltx_text ltx_framed ltx_framed_underline">server:</span> broadcast <math id="alg1.l3.m1.4" class="ltx_Math" alttext="\{\boldsymbol{w}_{1}^{t},\boldsymbol{w}_{2}^{t},\ldots,\boldsymbol{w}_{K}^{t}\}" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.4.3" xref="alg1.l3.m1.4.4.4.cmml"><mo stretchy="false" id="alg1.l3.m1.4.4.3.4" xref="alg1.l3.m1.4.4.4.cmml">{</mo><msubsup id="alg1.l3.m1.2.2.1.1" xref="alg1.l3.m1.2.2.1.1.cmml"><mi id="alg1.l3.m1.2.2.1.1.2.2" xref="alg1.l3.m1.2.2.1.1.2.2.cmml">𝒘</mi><mn id="alg1.l3.m1.2.2.1.1.2.3" xref="alg1.l3.m1.2.2.1.1.2.3.cmml">1</mn><mi id="alg1.l3.m1.2.2.1.1.3" xref="alg1.l3.m1.2.2.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l3.m1.4.4.3.5" xref="alg1.l3.m1.4.4.4.cmml">,</mo><msubsup id="alg1.l3.m1.3.3.2.2" xref="alg1.l3.m1.3.3.2.2.cmml"><mi id="alg1.l3.m1.3.3.2.2.2.2" xref="alg1.l3.m1.3.3.2.2.2.2.cmml">𝒘</mi><mn id="alg1.l3.m1.3.3.2.2.2.3" xref="alg1.l3.m1.3.3.2.2.2.3.cmml">2</mn><mi id="alg1.l3.m1.3.3.2.2.3" xref="alg1.l3.m1.3.3.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l3.m1.4.4.3.6" xref="alg1.l3.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">…</mi><mo id="alg1.l3.m1.4.4.3.7" xref="alg1.l3.m1.4.4.4.cmml">,</mo><msubsup id="alg1.l3.m1.4.4.3.3" xref="alg1.l3.m1.4.4.3.3.cmml"><mi id="alg1.l3.m1.4.4.3.3.2.2" xref="alg1.l3.m1.4.4.3.3.2.2.cmml">𝒘</mi><mi id="alg1.l3.m1.4.4.3.3.2.3" xref="alg1.l3.m1.4.4.3.3.2.3.cmml">K</mi><mi id="alg1.l3.m1.4.4.3.3.3" xref="alg1.l3.m1.4.4.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l3.m1.4.4.3.8" xref="alg1.l3.m1.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><set id="alg1.l3.m1.4.4.4.cmml" xref="alg1.l3.m1.4.4.3"><apply id="alg1.l3.m1.2.2.1.1.cmml" xref="alg1.l3.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.1.cmml" xref="alg1.l3.m1.2.2.1.1">superscript</csymbol><apply id="alg1.l3.m1.2.2.1.1.2.cmml" xref="alg1.l3.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.1.1.2.1.cmml" xref="alg1.l3.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l3.m1.2.2.1.1.2.2.cmml" xref="alg1.l3.m1.2.2.1.1.2.2">𝒘</ci><cn type="integer" id="alg1.l3.m1.2.2.1.1.2.3.cmml" xref="alg1.l3.m1.2.2.1.1.2.3">1</cn></apply><ci id="alg1.l3.m1.2.2.1.1.3.cmml" xref="alg1.l3.m1.2.2.1.1.3">𝑡</ci></apply><apply id="alg1.l3.m1.3.3.2.2.cmml" xref="alg1.l3.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.3.3.2.2.1.cmml" xref="alg1.l3.m1.3.3.2.2">superscript</csymbol><apply id="alg1.l3.m1.3.3.2.2.2.cmml" xref="alg1.l3.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l3.m1.3.3.2.2.2.1.cmml" xref="alg1.l3.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l3.m1.3.3.2.2.2.2.cmml" xref="alg1.l3.m1.3.3.2.2.2.2">𝒘</ci><cn type="integer" id="alg1.l3.m1.3.3.2.2.2.3.cmml" xref="alg1.l3.m1.3.3.2.2.2.3">2</cn></apply><ci id="alg1.l3.m1.3.3.2.2.3.cmml" xref="alg1.l3.m1.3.3.2.2.3">𝑡</ci></apply><ci id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">…</ci><apply id="alg1.l3.m1.4.4.3.3.cmml" xref="alg1.l3.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.4.4.3.3.1.cmml" xref="alg1.l3.m1.4.4.3.3">superscript</csymbol><apply id="alg1.l3.m1.4.4.3.3.2.cmml" xref="alg1.l3.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.4.4.3.3.2.1.cmml" xref="alg1.l3.m1.4.4.3.3">subscript</csymbol><ci id="alg1.l3.m1.4.4.3.3.2.2.cmml" xref="alg1.l3.m1.4.4.3.3.2.2">𝒘</ci><ci id="alg1.l3.m1.4.4.3.3.2.3.cmml" xref="alg1.l3.m1.4.4.3.3.2.3">𝐾</ci></apply><ci id="alg1.l3.m1.4.4.3.3.3.cmml" xref="alg1.l3.m1.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">\{\boldsymbol{w}_{1}^{t},\boldsymbol{w}_{2}^{t},\ldots,\boldsymbol{w}_{K}^{t}\}</annotation></semantics></math> to all devices.

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> <span id="alg1.l4.3" class="ltx_text ltx_framed ltx_framed_underline">device</span> <math id="alg1.l4.m1.1" class="ltx_Math" alttext="i\in\mathcal{M}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">i</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">ℳ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><in id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></in><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑖</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">ℳ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i\in\mathcal{M}</annotation></semantics></math> in parallel <span id="alg1.l4.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        <span id="alg1.l5.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l5.m1.4" class="ltx_Math" alttext="k=1,2,\ldots,K" display="inline"><semantics id="alg1.l5.m1.4a"><mrow id="alg1.l5.m1.4.5" xref="alg1.l5.m1.4.5.cmml"><mi id="alg1.l5.m1.4.5.2" xref="alg1.l5.m1.4.5.2.cmml">k</mi><mo id="alg1.l5.m1.4.5.1" xref="alg1.l5.m1.4.5.1.cmml">=</mo><mrow id="alg1.l5.m1.4.5.3.2" xref="alg1.l5.m1.4.5.3.1.cmml"><mn id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">1</mn><mo id="alg1.l5.m1.4.5.3.2.1" xref="alg1.l5.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">2</mn><mo id="alg1.l5.m1.4.5.3.2.2" xref="alg1.l5.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml">…</mi><mo id="alg1.l5.m1.4.5.3.2.3" xref="alg1.l5.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l5.m1.4.4" xref="alg1.l5.m1.4.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.4b"><apply id="alg1.l5.m1.4.5.cmml" xref="alg1.l5.m1.4.5"><eq id="alg1.l5.m1.4.5.1.cmml" xref="alg1.l5.m1.4.5.1"></eq><ci id="alg1.l5.m1.4.5.2.cmml" xref="alg1.l5.m1.4.5.2">𝑘</ci><list id="alg1.l5.m1.4.5.3.1.cmml" xref="alg1.l5.m1.4.5.3.2"><cn type="integer" id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">1</cn><cn type="integer" id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">2</cn><ci id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3">…</ci><ci id="alg1.l5.m1.4.4.cmml" xref="alg1.l5.m1.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.4c">k=1,2,\ldots,K</annotation></semantics></math> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>           Calculate loss <math id="alg1.l6.m1.2" class="ltx_Math" alttext="\mathcal{L}_{i,k}^{t}" display="inline"><semantics id="alg1.l6.m1.2a"><msubsup id="alg1.l6.m1.2.3" xref="alg1.l6.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m1.2.3.2.2" xref="alg1.l6.m1.2.3.2.2.cmml">ℒ</mi><mrow id="alg1.l6.m1.2.2.2.4" xref="alg1.l6.m1.2.2.2.3.cmml"><mi id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l6.m1.2.2.2.4.1" xref="alg1.l6.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.cmml">k</mi></mrow><mi id="alg1.l6.m1.2.3.3" xref="alg1.l6.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.3.cmml" xref="alg1.l6.m1.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.3.1.cmml" xref="alg1.l6.m1.2.3">superscript</csymbol><apply id="alg1.l6.m1.2.3.2.cmml" xref="alg1.l6.m1.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.3.2.1.cmml" xref="alg1.l6.m1.2.3">subscript</csymbol><ci id="alg1.l6.m1.2.3.2.2.cmml" xref="alg1.l6.m1.2.3.2.2">ℒ</ci><list id="alg1.l6.m1.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.4"><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">𝑖</ci><ci id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2">𝑘</ci></list></apply><ci id="alg1.l6.m1.2.3.3.cmml" xref="alg1.l6.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\mathcal{L}_{i,k}^{t}</annotation></semantics></math> by (<a href="#S2.E1" title="In II-B2 Determination of cluster identity for each device ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>           Obtain gradient <math id="alg1.l7.m1.2" class="ltx_Math" alttext="\nabla\mathcal{L}_{i,k}^{t}" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.3" xref="alg1.l7.m1.2.3.cmml"><mo rspace="0.167em" id="alg1.l7.m1.2.3.1" xref="alg1.l7.m1.2.3.1.cmml">∇</mo><msubsup id="alg1.l7.m1.2.3.2" xref="alg1.l7.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.2.3.2.2.2" xref="alg1.l7.m1.2.3.2.2.2.cmml">ℒ</mi><mrow id="alg1.l7.m1.2.2.2.4" xref="alg1.l7.m1.2.2.2.3.cmml"><mi id="alg1.l7.m1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l7.m1.2.2.2.4.1" xref="alg1.l7.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l7.m1.2.2.2.2" xref="alg1.l7.m1.2.2.2.2.cmml">k</mi></mrow><mi id="alg1.l7.m1.2.3.2.3" xref="alg1.l7.m1.2.3.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.3.cmml" xref="alg1.l7.m1.2.3"><ci id="alg1.l7.m1.2.3.1.cmml" xref="alg1.l7.m1.2.3.1">∇</ci><apply id="alg1.l7.m1.2.3.2.cmml" xref="alg1.l7.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.3.2.1.cmml" xref="alg1.l7.m1.2.3.2">superscript</csymbol><apply id="alg1.l7.m1.2.3.2.2.cmml" xref="alg1.l7.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l7.m1.2.3.2.2.1.cmml" xref="alg1.l7.m1.2.3.2">subscript</csymbol><ci id="alg1.l7.m1.2.3.2.2.2.cmml" xref="alg1.l7.m1.2.3.2.2.2">ℒ</ci><list id="alg1.l7.m1.2.2.2.3.cmml" xref="alg1.l7.m1.2.2.2.4"><ci id="alg1.l7.m1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1">𝑖</ci><ci id="alg1.l7.m1.2.2.2.2.cmml" xref="alg1.l7.m1.2.2.2.2">𝑘</ci></list></apply><ci id="alg1.l7.m1.2.3.2.3.cmml" xref="alg1.l7.m1.2.3.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">\nabla\mathcal{L}_{i,k}^{t}</annotation></semantics></math> via back-propagation.

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>           Calculate gradient similarity <math id="alg1.l8.m1.2" class="ltx_Math" alttext="S_{i,k}^{t}" display="inline"><semantics id="alg1.l8.m1.2a"><msubsup id="alg1.l8.m1.2.3" xref="alg1.l8.m1.2.3.cmml"><mi id="alg1.l8.m1.2.3.2.2" xref="alg1.l8.m1.2.3.2.2.cmml">S</mi><mrow id="alg1.l8.m1.2.2.2.4" xref="alg1.l8.m1.2.2.2.3.cmml"><mi id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l8.m1.2.2.2.4.1" xref="alg1.l8.m1.2.2.2.3.cmml">,</mo><mi id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.cmml">k</mi></mrow><mi id="alg1.l8.m1.2.3.3" xref="alg1.l8.m1.2.3.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.3.cmml" xref="alg1.l8.m1.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.1.cmml" xref="alg1.l8.m1.2.3">superscript</csymbol><apply id="alg1.l8.m1.2.3.2.cmml" xref="alg1.l8.m1.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.2.1.cmml" xref="alg1.l8.m1.2.3">subscript</csymbol><ci id="alg1.l8.m1.2.3.2.2.cmml" xref="alg1.l8.m1.2.3.2.2">𝑆</ci><list id="alg1.l8.m1.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.4"><ci id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1">𝑖</ci><ci id="alg1.l8.m1.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2">𝑘</ci></list></apply><ci id="alg1.l8.m1.2.3.3.cmml" xref="alg1.l8.m1.2.3.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">S_{i,k}^{t}</annotation></semantics></math> by (<a href="#S2.E3" title="In II-B2 Determination of cluster identity for each device ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>        <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>        Estimate cluster identity by (<a href="#S2.E4" title="In II-B2 Determination of cluster identity for each device ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>)

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>        Update the local model by (<a href="#S2.E5" title="In II-B3 Local model update ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>)

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>        Upload <math id="alg1.l12.m1.1" class="ltx_Math" alttext="s_{i}^{t}" display="inline"><semantics id="alg1.l12.m1.1a"><msubsup id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">s</mi><mi id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml">i</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝑠</ci><ci id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">s_{i}^{t}</annotation></semantics></math> and <math id="alg1.l12.m2.1" class="ltx_Math" alttext="\boldsymbol{w}_{i}^{t}" display="inline"><semantics id="alg1.l12.m2.1a"><msubsup id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mi id="alg1.l12.m2.1.1.2.2" xref="alg1.l12.m2.1.1.2.2.cmml">𝒘</mi><mi id="alg1.l12.m2.1.1.2.3" xref="alg1.l12.m2.1.1.2.3.cmml">i</mi><mi id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1">superscript</csymbol><apply id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.2.1.cmml" xref="alg1.l12.m2.1.1">subscript</csymbol><ci id="alg1.l12.m2.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.2.2">𝒘</ci><ci id="alg1.l12.m2.1.1.2.3.cmml" xref="alg1.l12.m2.1.1.2.3">𝑖</ci></apply><ci id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\boldsymbol{w}_{i}^{t}</annotation></semantics></math> to the server.

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <span id="alg1.l14.2" class="ltx_text ltx_framed ltx_framed_underline">server:</span> aggregate received models of each cluster based on (<a href="#S2.E7" title="In II-B4 Local FL model aggregation ‣ II-B Proposed Clustered FL Algorithm ‣ II Proposed clustered FL System ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>)

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>  <span id="alg1.l15.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg1.l16.2" class="ltx_text ltx_font_bold">Output: </span> global cluster models <math id="alg1.l16.m1.4" class="ltx_Math" alttext="\{\boldsymbol{w}_{1}^{t},\boldsymbol{w}_{2}^{t},\ldots,\boldsymbol{w}_{K}^{t}\}" display="inline"><semantics id="alg1.l16.m1.4a"><mrow id="alg1.l16.m1.4.4.3" xref="alg1.l16.m1.4.4.4.cmml"><mo stretchy="false" id="alg1.l16.m1.4.4.3.4" xref="alg1.l16.m1.4.4.4.cmml">{</mo><msubsup id="alg1.l16.m1.2.2.1.1" xref="alg1.l16.m1.2.2.1.1.cmml"><mi id="alg1.l16.m1.2.2.1.1.2.2" xref="alg1.l16.m1.2.2.1.1.2.2.cmml">𝒘</mi><mn id="alg1.l16.m1.2.2.1.1.2.3" xref="alg1.l16.m1.2.2.1.1.2.3.cmml">1</mn><mi id="alg1.l16.m1.2.2.1.1.3" xref="alg1.l16.m1.2.2.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l16.m1.4.4.3.5" xref="alg1.l16.m1.4.4.4.cmml">,</mo><msubsup id="alg1.l16.m1.3.3.2.2" xref="alg1.l16.m1.3.3.2.2.cmml"><mi id="alg1.l16.m1.3.3.2.2.2.2" xref="alg1.l16.m1.3.3.2.2.2.2.cmml">𝒘</mi><mn id="alg1.l16.m1.3.3.2.2.2.3" xref="alg1.l16.m1.3.3.2.2.2.3.cmml">2</mn><mi id="alg1.l16.m1.3.3.2.2.3" xref="alg1.l16.m1.3.3.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l16.m1.4.4.3.6" xref="alg1.l16.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml">…</mi><mo id="alg1.l16.m1.4.4.3.7" xref="alg1.l16.m1.4.4.4.cmml">,</mo><msubsup id="alg1.l16.m1.4.4.3.3" xref="alg1.l16.m1.4.4.3.3.cmml"><mi id="alg1.l16.m1.4.4.3.3.2.2" xref="alg1.l16.m1.4.4.3.3.2.2.cmml">𝒘</mi><mi id="alg1.l16.m1.4.4.3.3.2.3" xref="alg1.l16.m1.4.4.3.3.2.3.cmml">K</mi><mi id="alg1.l16.m1.4.4.3.3.3" xref="alg1.l16.m1.4.4.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l16.m1.4.4.3.8" xref="alg1.l16.m1.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.4b"><set id="alg1.l16.m1.4.4.4.cmml" xref="alg1.l16.m1.4.4.3"><apply id="alg1.l16.m1.2.2.1.1.cmml" xref="alg1.l16.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.1.cmml" xref="alg1.l16.m1.2.2.1.1">superscript</csymbol><apply id="alg1.l16.m1.2.2.1.1.2.cmml" xref="alg1.l16.m1.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.1.1.2.1.cmml" xref="alg1.l16.m1.2.2.1.1">subscript</csymbol><ci id="alg1.l16.m1.2.2.1.1.2.2.cmml" xref="alg1.l16.m1.2.2.1.1.2.2">𝒘</ci><cn type="integer" id="alg1.l16.m1.2.2.1.1.2.3.cmml" xref="alg1.l16.m1.2.2.1.1.2.3">1</cn></apply><ci id="alg1.l16.m1.2.2.1.1.3.cmml" xref="alg1.l16.m1.2.2.1.1.3">𝑡</ci></apply><apply id="alg1.l16.m1.3.3.2.2.cmml" xref="alg1.l16.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.2.2.1.cmml" xref="alg1.l16.m1.3.3.2.2">superscript</csymbol><apply id="alg1.l16.m1.3.3.2.2.2.cmml" xref="alg1.l16.m1.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.2.2.2.1.cmml" xref="alg1.l16.m1.3.3.2.2">subscript</csymbol><ci id="alg1.l16.m1.3.3.2.2.2.2.cmml" xref="alg1.l16.m1.3.3.2.2.2.2">𝒘</ci><cn type="integer" id="alg1.l16.m1.3.3.2.2.2.3.cmml" xref="alg1.l16.m1.3.3.2.2.2.3">2</cn></apply><ci id="alg1.l16.m1.3.3.2.2.3.cmml" xref="alg1.l16.m1.3.3.2.2.3">𝑡</ci></apply><ci id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1">…</ci><apply id="alg1.l16.m1.4.4.3.3.cmml" xref="alg1.l16.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.4.4.3.3.1.cmml" xref="alg1.l16.m1.4.4.3.3">superscript</csymbol><apply id="alg1.l16.m1.4.4.3.3.2.cmml" xref="alg1.l16.m1.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.4.4.3.3.2.1.cmml" xref="alg1.l16.m1.4.4.3.3">subscript</csymbol><ci id="alg1.l16.m1.4.4.3.3.2.2.cmml" xref="alg1.l16.m1.4.4.3.3.2.2">𝒘</ci><ci id="alg1.l16.m1.4.4.3.3.2.3.cmml" xref="alg1.l16.m1.4.4.3.3.2.3">𝐾</ci></apply><ci id="alg1.l16.m1.4.4.3.3.3.cmml" xref="alg1.l16.m1.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.4c">\{\boldsymbol{w}_{1}^{t},\boldsymbol{w}_{2}^{t},\ldots,\boldsymbol{w}_{K}^{t}\}</annotation></semantics></math> and the cluster identities of devices <math id="alg1.l16.m2.4" class="ltx_Math" alttext="\{s_{1}^{t},s_{2}^{t},\ldots,s_{M}^{t}\}" display="inline"><semantics id="alg1.l16.m2.4a"><mrow id="alg1.l16.m2.4.4.3" xref="alg1.l16.m2.4.4.4.cmml"><mo stretchy="false" id="alg1.l16.m2.4.4.3.4" xref="alg1.l16.m2.4.4.4.cmml">{</mo><msubsup id="alg1.l16.m2.2.2.1.1" xref="alg1.l16.m2.2.2.1.1.cmml"><mi id="alg1.l16.m2.2.2.1.1.2.2" xref="alg1.l16.m2.2.2.1.1.2.2.cmml">s</mi><mn id="alg1.l16.m2.2.2.1.1.2.3" xref="alg1.l16.m2.2.2.1.1.2.3.cmml">1</mn><mi id="alg1.l16.m2.2.2.1.1.3" xref="alg1.l16.m2.2.2.1.1.3.cmml">t</mi></msubsup><mo id="alg1.l16.m2.4.4.3.5" xref="alg1.l16.m2.4.4.4.cmml">,</mo><msubsup id="alg1.l16.m2.3.3.2.2" xref="alg1.l16.m2.3.3.2.2.cmml"><mi id="alg1.l16.m2.3.3.2.2.2.2" xref="alg1.l16.m2.3.3.2.2.2.2.cmml">s</mi><mn id="alg1.l16.m2.3.3.2.2.2.3" xref="alg1.l16.m2.3.3.2.2.2.3.cmml">2</mn><mi id="alg1.l16.m2.3.3.2.2.3" xref="alg1.l16.m2.3.3.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l16.m2.4.4.3.6" xref="alg1.l16.m2.4.4.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l16.m2.1.1" xref="alg1.l16.m2.1.1.cmml">…</mi><mo id="alg1.l16.m2.4.4.3.7" xref="alg1.l16.m2.4.4.4.cmml">,</mo><msubsup id="alg1.l16.m2.4.4.3.3" xref="alg1.l16.m2.4.4.3.3.cmml"><mi id="alg1.l16.m2.4.4.3.3.2.2" xref="alg1.l16.m2.4.4.3.3.2.2.cmml">s</mi><mi id="alg1.l16.m2.4.4.3.3.2.3" xref="alg1.l16.m2.4.4.3.3.2.3.cmml">M</mi><mi id="alg1.l16.m2.4.4.3.3.3" xref="alg1.l16.m2.4.4.3.3.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l16.m2.4.4.3.8" xref="alg1.l16.m2.4.4.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m2.4b"><set id="alg1.l16.m2.4.4.4.cmml" xref="alg1.l16.m2.4.4.3"><apply id="alg1.l16.m2.2.2.1.1.cmml" xref="alg1.l16.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.2.2.1.1.1.cmml" xref="alg1.l16.m2.2.2.1.1">superscript</csymbol><apply id="alg1.l16.m2.2.2.1.1.2.cmml" xref="alg1.l16.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l16.m2.2.2.1.1.2.1.cmml" xref="alg1.l16.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l16.m2.2.2.1.1.2.2.cmml" xref="alg1.l16.m2.2.2.1.1.2.2">𝑠</ci><cn type="integer" id="alg1.l16.m2.2.2.1.1.2.3.cmml" xref="alg1.l16.m2.2.2.1.1.2.3">1</cn></apply><ci id="alg1.l16.m2.2.2.1.1.3.cmml" xref="alg1.l16.m2.2.2.1.1.3">𝑡</ci></apply><apply id="alg1.l16.m2.3.3.2.2.cmml" xref="alg1.l16.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l16.m2.3.3.2.2.1.cmml" xref="alg1.l16.m2.3.3.2.2">superscript</csymbol><apply id="alg1.l16.m2.3.3.2.2.2.cmml" xref="alg1.l16.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l16.m2.3.3.2.2.2.1.cmml" xref="alg1.l16.m2.3.3.2.2">subscript</csymbol><ci id="alg1.l16.m2.3.3.2.2.2.2.cmml" xref="alg1.l16.m2.3.3.2.2.2.2">𝑠</ci><cn type="integer" id="alg1.l16.m2.3.3.2.2.2.3.cmml" xref="alg1.l16.m2.3.3.2.2.2.3">2</cn></apply><ci id="alg1.l16.m2.3.3.2.2.3.cmml" xref="alg1.l16.m2.3.3.2.2.3">𝑡</ci></apply><ci id="alg1.l16.m2.1.1.cmml" xref="alg1.l16.m2.1.1">…</ci><apply id="alg1.l16.m2.4.4.3.3.cmml" xref="alg1.l16.m2.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l16.m2.4.4.3.3.1.cmml" xref="alg1.l16.m2.4.4.3.3">superscript</csymbol><apply id="alg1.l16.m2.4.4.3.3.2.cmml" xref="alg1.l16.m2.4.4.3.3"><csymbol cd="ambiguous" id="alg1.l16.m2.4.4.3.3.2.1.cmml" xref="alg1.l16.m2.4.4.3.3">subscript</csymbol><ci id="alg1.l16.m2.4.4.3.3.2.2.cmml" xref="alg1.l16.m2.4.4.3.3.2.2">𝑠</ci><ci id="alg1.l16.m2.4.4.3.3.2.3.cmml" xref="alg1.l16.m2.4.4.3.3.2.3">𝑀</ci></apply><ci id="alg1.l16.m2.4.4.3.3.3.cmml" xref="alg1.l16.m2.4.4.3.3.3">𝑡</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m2.4c">\{s_{1}^{t},s_{2}^{t},\ldots,s_{M}^{t}\}</annotation></semantics></math>.

</div>
</div>
</figure>
</section>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Empty Cluster Problem in Cluster FL Training</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.2" class="ltx_p">To implement the proposed clustered FL, we may also need to solve a problem where one cluster may not have any devices during the training of clustered FL.
This is because all the devices in this cluster may be misclassified into other clusters. Although this scenario may not happen frequently, it will significantly reduce the performance of clustered FL. In particular,
at one clustered FL training iteration, if one cluster does not have any devices, the FL model of this cluster will not be updated.
When the FL model is not updated, the gradient vector calculated by each device may not be correct such that the device will not select the cluster without updated FL model in the following iterations.
In consequence, the number of clusters considered in our algorithm will be reduced.
To address this issue, we can randomly select <math id="S2.SS3.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS3.p1.1.m1.1a"><mi id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><ci id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">K</annotation></semantics></math> devices and allocate one device to one cluster.
Here, <math id="S2.SS3.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S2.SS3.p1.2.m2.1a"><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">K</annotation></semantics></math> devices can have the same data distributions and we only need to make sure that each cluster will have one device per FL training iteration.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Simulation Results and Analysis</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We consider the implementation of the proposed clustered FL for learning tasks:1) 10 class hand written digits identification (i.e., MNIST<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>), 2) 10 class fashion product images classification (i.e. FashionMNIST<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>), 3) 10 class objects classification (i.e., CIFAR10<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>)
, and 4) 62 class hand written letters and digits identification (i.e., EMNIST<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>)
.
To evaluate the performance, we run our proposed clustered FL method in 4 experiments, each of which extracts its cluster task datasets from a classification dataset.
For comparison purpose, we use the iterative clustered FL scheme from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> as baseline.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2311.13665/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="211" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Example splits of MNIST, FashionMNIST, and CIFAR10</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Simulation Settings and Performance Metrics</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Here, we first explain how to generate the dataset for the devices in each cluster of each learning task. Then, we introduce the local FL model settings for each learning task. Finally, we describe the performance metrics used in the simulations.</p>
</div>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS1.4.1.1" class="ltx_text">III-A</span>1 </span>Dataset Settings</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.1" class="ltx_p">For the experiments on MNIST, FashionMNIST, and CIFAR10, we consider 80 devices jointly implement the clustered FL algorithm. These devices are equally divided into 4 clusters (i.e., clusters A, B, C, and D as shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) and each cluster has 20 devices. Each dataset totally has 10 class data and a device in each cluster has 8 class data. Hence the devices in different clusters will have at least 6 overlapped class data. In Fig. <a href="#S3.F2" title="Figure 2 ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we show the data distribution of the four clusters for each learning task. From this figure, we see that, in MNIST, the devices in cluster A have a total of 17500 samples of number 0, 1, 2, 3, 4, 5, 6, 8, while the devices in cluster B have 14500 samples of number 0, 1, 2, 3, 4, 6, 7, 9. Hence, there are 6 overlapped class data between devices in cluster A and B.
The data samples of each cluster will be further distributed to its devices equally and randomly.</p>
</div>
<div id="S3.SS1.SSS1.p2" class="ltx_para">
<p id="S3.SS1.SSS1.p2.1" class="ltx_p">For EMNIST learning task, we consider the clustered FL is implemented by 200 devices which are divided into 8 clusters.
To reduce ambiguity between the uppercase and lowercase forms of some easily hard-to-distinguish letters, we merged the uppercase and lowercase classes for the letters C, I, J, K, L, M, O, P, S, U, V, W, X, Y and Z, such that 62 class data are changed into 47 classes.
We further split these classes into clusters in the same manner as was done for the MNIST dataset, each of which has 40 class data.</p>
</div>
</section>
<section id="S3.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS2.4.1.1" class="ltx_text">III-A</span>2 </span>Learning Models</h4>

<div id="S3.SS1.SSS2.p1" class="ltx_para">
<p id="S3.SS1.SSS2.p1.1" class="ltx_p">For each learning task, we consider the use of two neural network models as local FL models. The first one is a multi-layer perceptron (MLP) with three fully-connected layers with ReLU activation. The second model is a convolutional neural network (CNN) which consists of two convolutional layers followed by fully-connected layers. The detailed MLP and CNN model architectures are shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ III-A2 Learning Models ‣ III-A Simulation Settings and Performance Metrics ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2311.13665/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="221" height="217" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Model architectures of the MLP and CNN for each experiment</figcaption>
</figure>
</section>
<section id="S3.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S3.SS1.SSS3.4.1.1" class="ltx_text">III-A</span>3 </span>Performance Metrics</h4>

<div id="S3.SS1.SSS3.p1" class="ltx_para">
<p id="S3.SS1.SSS3.p1.2" class="ltx_p">To measure the clustering accuracy of the clustered FL algorithm, we use purity which is defined as the percentage of devices that are classified correctly.
The purity <math id="S3.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="P^{t}" display="inline"><semantics id="S3.SS1.SSS3.p1.1.m1.1a"><msup id="S3.SS1.SSS3.p1.1.m1.1.1" xref="S3.SS1.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS3.p1.1.m1.1.1.2" xref="S3.SS1.SSS3.p1.1.m1.1.1.2.cmml">P</mi><mi id="S3.SS1.SSS3.p1.1.m1.1.1.3" xref="S3.SS1.SSS3.p1.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.1.m1.1b"><apply id="S3.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1.2">𝑃</ci><ci id="S3.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS3.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.1.m1.1c">P^{t}</annotation></semantics></math> at iteration <math id="S3.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.SSS3.p1.2.m2.1a"><mi id="S3.SS1.SSS3.p1.2.m2.1.1" xref="S3.SS1.SSS3.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.2.m2.1b"><ci id="S3.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.2.m2.1c">t</annotation></semantics></math> is mathematically expressed as</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.2" class="ltx_Math" alttext="P^{t}=\frac{1}{|\mathcal{M}|}\sum_{k}\max_{j}|\mathcal{M}_{j}^{*}\cap\mathcal{M}_{k}^{t}|," display="block"><semantics id="S3.Ex1.m1.2a"><mrow id="S3.Ex1.m1.2.2.1" xref="S3.Ex1.m1.2.2.1.1.cmml"><mrow id="S3.Ex1.m1.2.2.1.1" xref="S3.Ex1.m1.2.2.1.1.cmml"><msup id="S3.Ex1.m1.2.2.1.1.3" xref="S3.Ex1.m1.2.2.1.1.3.cmml"><mi id="S3.Ex1.m1.2.2.1.1.3.2" xref="S3.Ex1.m1.2.2.1.1.3.2.cmml">P</mi><mi id="S3.Ex1.m1.2.2.1.1.3.3" xref="S3.Ex1.m1.2.2.1.1.3.3.cmml">t</mi></msup><mo id="S3.Ex1.m1.2.2.1.1.2" xref="S3.Ex1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.2.2.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.cmml"><mfrac id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mn id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.3.1" xref="S3.Ex1.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml">ℳ</mi><mo stretchy="false" id="S3.Ex1.m1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.2.2.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.cmml"><munder id="S3.Ex1.m1.2.2.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m1.2.2.1.1.1.1.2.2" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.Ex1.m1.2.2.1.1.1.1.2.3" xref="S3.Ex1.m1.2.2.1.1.1.1.2.3.cmml">k</mi></munder><mrow id="S3.Ex1.m1.2.2.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.cmml"><munder id="S3.Ex1.m1.2.2.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.2.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2.2.cmml">max</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.2.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2.3.cmml">j</mi></munder><mo id="S3.Ex1.m1.2.2.1.1.1.1.1a" xref="S3.Ex1.m1.2.2.1.1.1.1.1.cmml">⁡</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml">ℳ</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml">j</mi><mo id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">∗</mo></msubsup><mo id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">∩</mo><msubsup id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml">ℳ</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml">k</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.Ex1.m1.2.2.1.2" xref="S3.Ex1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b"><apply id="S3.Ex1.m1.2.2.1.1.cmml" xref="S3.Ex1.m1.2.2.1"><eq id="S3.Ex1.m1.2.2.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.2"></eq><apply id="S3.Ex1.m1.2.2.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.3.2">𝑃</ci><ci id="S3.Ex1.m1.2.2.1.1.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.3.3">𝑡</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1"><times id="S3.Ex1.m1.2.2.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2"></times><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><divide id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1"></divide><cn type="integer" id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3">1</cn><apply id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.3"><abs id="S3.Ex1.m1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.3.1"></abs><ci id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1">ℳ</ci></apply></apply><apply id="S3.Ex1.m1.2.2.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1"><apply id="S3.Ex1.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex1.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.2"></sum><ci id="S3.Ex1.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1"><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2">subscript</csymbol><max id="S3.Ex1.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2.2"></max><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1"><abs id="S3.Ex1.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.2"></abs><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1"><intersect id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1"></intersect><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.2">ℳ</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.2.3">𝑗</ci></apply><times id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.2.3"></times></apply><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.2">ℳ</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">P^{t}=\frac{1}{|\mathcal{M}|}\sum_{k}\max_{j}|\mathcal{M}_{j}^{*}\cap\mathcal{M}_{k}^{t}|,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS3.p1.6" class="ltx_p">where <math id="S3.SS1.SSS3.p1.3.m1.1" class="ltx_Math" alttext="\mathcal{M}_{j}^{*}" display="inline"><semantics id="S3.SS1.SSS3.p1.3.m1.1a"><msubsup id="S3.SS1.SSS3.p1.3.m1.1.1" xref="S3.SS1.SSS3.p1.3.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.3.m1.1.1.2.2" xref="S3.SS1.SSS3.p1.3.m1.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS1.SSS3.p1.3.m1.1.1.2.3" xref="S3.SS1.SSS3.p1.3.m1.1.1.2.3.cmml">j</mi><mo id="S3.SS1.SSS3.p1.3.m1.1.1.3" xref="S3.SS1.SSS3.p1.3.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.3.m1.1b"><apply id="S3.SS1.SSS3.p1.3.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m1.1.1.1.cmml" xref="S3.SS1.SSS3.p1.3.m1.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p1.3.m1.1.1.2.cmml" xref="S3.SS1.SSS3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.3.m1.1.1.2.1.cmml" xref="S3.SS1.SSS3.p1.3.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.3.m1.1.1.2.2.cmml" xref="S3.SS1.SSS3.p1.3.m1.1.1.2.2">ℳ</ci><ci id="S3.SS1.SSS3.p1.3.m1.1.1.2.3.cmml" xref="S3.SS1.SSS3.p1.3.m1.1.1.2.3">𝑗</ci></apply><times id="S3.SS1.SSS3.p1.3.m1.1.1.3.cmml" xref="S3.SS1.SSS3.p1.3.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.3.m1.1c">\mathcal{M}_{j}^{*}</annotation></semantics></math> is the ground truth set of devices at cluster <math id="S3.SS1.SSS3.p1.4.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.SSS3.p1.4.m2.1a"><mi id="S3.SS1.SSS3.p1.4.m2.1.1" xref="S3.SS1.SSS3.p1.4.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.4.m2.1b"><ci id="S3.SS1.SSS3.p1.4.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.4.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.4.m2.1c">j</annotation></semantics></math>, and <math id="S3.SS1.SSS3.p1.5.m3.1" class="ltx_Math" alttext="\mathcal{M}_{k}^{t}" display="inline"><semantics id="S3.SS1.SSS3.p1.5.m3.1a"><msubsup id="S3.SS1.SSS3.p1.5.m3.1.1" xref="S3.SS1.SSS3.p1.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS3.p1.5.m3.1.1.2.2" xref="S3.SS1.SSS3.p1.5.m3.1.1.2.2.cmml">ℳ</mi><mi id="S3.SS1.SSS3.p1.5.m3.1.1.2.3" xref="S3.SS1.SSS3.p1.5.m3.1.1.2.3.cmml">k</mi><mi id="S3.SS1.SSS3.p1.5.m3.1.1.3" xref="S3.SS1.SSS3.p1.5.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.5.m3.1b"><apply id="S3.SS1.SSS3.p1.5.m3.1.1.cmml" xref="S3.SS1.SSS3.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.5.m3.1.1.1.cmml" xref="S3.SS1.SSS3.p1.5.m3.1.1">superscript</csymbol><apply id="S3.SS1.SSS3.p1.5.m3.1.1.2.cmml" xref="S3.SS1.SSS3.p1.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS3.p1.5.m3.1.1.2.1.cmml" xref="S3.SS1.SSS3.p1.5.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS3.p1.5.m3.1.1.2.2.cmml" xref="S3.SS1.SSS3.p1.5.m3.1.1.2.2">ℳ</ci><ci id="S3.SS1.SSS3.p1.5.m3.1.1.2.3.cmml" xref="S3.SS1.SSS3.p1.5.m3.1.1.2.3">𝑘</ci></apply><ci id="S3.SS1.SSS3.p1.5.m3.1.1.3.cmml" xref="S3.SS1.SSS3.p1.5.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.5.m3.1c">\mathcal{M}_{k}^{t}</annotation></semantics></math> is the set of devices that are clustered by the clustered FL algorithm at iteration <math id="S3.SS1.SSS3.p1.6.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.SSS3.p1.6.m4.1a"><mi id="S3.SS1.SSS3.p1.6.m4.1.1" xref="S3.SS1.SSS3.p1.6.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.6.m4.1b"><ci id="S3.SS1.SSS3.p1.6.m4.1.1.cmml" xref="S3.SS1.SSS3.p1.6.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.6.m4.1c">t</annotation></semantics></math>, with</p>
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1.7" class="ltx_Math" alttext="\mathcal{M}_{k}^{t}=\{i|i\in\mathcal{M},s_{i}^{t}=k\},\forall k=1,2,\ldots,K" display="block"><semantics id="S3.Ex2.m1.7a"><mrow id="S3.Ex2.m1.7.7.2" xref="S3.Ex2.m1.7.7.3.cmml"><mrow id="S3.Ex2.m1.6.6.1.1" xref="S3.Ex2.m1.6.6.1.1.cmml"><msubsup id="S3.Ex2.m1.6.6.1.1.3" xref="S3.Ex2.m1.6.6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.6.6.1.1.3.2.2" xref="S3.Ex2.m1.6.6.1.1.3.2.2.cmml">ℳ</mi><mi id="S3.Ex2.m1.6.6.1.1.3.2.3" xref="S3.Ex2.m1.6.6.1.1.3.2.3.cmml">k</mi><mi id="S3.Ex2.m1.6.6.1.1.3.3" xref="S3.Ex2.m1.6.6.1.1.3.3.cmml">t</mi></msubsup><mo id="S3.Ex2.m1.6.6.1.1.2" xref="S3.Ex2.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex2.m1.6.6.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.2.1.cmml">{</mo><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.6.6.1.1.1.1.3" xref="S3.Ex2.m1.6.6.1.1.1.2.1.cmml">|</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.3.cmml"><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.3.cmml">ℳ</mi></mrow><mo id="S3.Ex2.m1.6.6.1.1.1.1.1.2.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.cmml"><msubsup id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.cmml"><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.2" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.2.cmml">s</mi><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.3.cmml">i</mi><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.3.cmml">t</mi></msubsup><mo id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.1" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.1.cmml">=</mo><mi id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.3" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.3.cmml">k</mi></mrow></mrow><mo stretchy="false" id="S3.Ex2.m1.6.6.1.1.1.1.4" xref="S3.Ex2.m1.6.6.1.1.1.2.1.cmml">}</mo></mrow></mrow><mo id="S3.Ex2.m1.7.7.2.3" xref="S3.Ex2.m1.7.7.3a.cmml">,</mo><mrow id="S3.Ex2.m1.7.7.2.2" xref="S3.Ex2.m1.7.7.2.2.cmml"><mrow id="S3.Ex2.m1.7.7.2.2.2" xref="S3.Ex2.m1.7.7.2.2.2.cmml"><mo rspace="0.167em" id="S3.Ex2.m1.7.7.2.2.2.1" xref="S3.Ex2.m1.7.7.2.2.2.1.cmml">∀</mo><mi id="S3.Ex2.m1.7.7.2.2.2.2" xref="S3.Ex2.m1.7.7.2.2.2.2.cmml">k</mi></mrow><mo id="S3.Ex2.m1.7.7.2.2.1" xref="S3.Ex2.m1.7.7.2.2.1.cmml">=</mo><mrow id="S3.Ex2.m1.7.7.2.2.3.2" xref="S3.Ex2.m1.7.7.2.2.3.1.cmml"><mn id="S3.Ex2.m1.2.2" xref="S3.Ex2.m1.2.2.cmml">1</mn><mo id="S3.Ex2.m1.7.7.2.2.3.2.1" xref="S3.Ex2.m1.7.7.2.2.3.1.cmml">,</mo><mn id="S3.Ex2.m1.3.3" xref="S3.Ex2.m1.3.3.cmml">2</mn><mo id="S3.Ex2.m1.7.7.2.2.3.2.2" xref="S3.Ex2.m1.7.7.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.Ex2.m1.4.4" xref="S3.Ex2.m1.4.4.cmml">…</mi><mo id="S3.Ex2.m1.7.7.2.2.3.2.3" xref="S3.Ex2.m1.7.7.2.2.3.1.cmml">,</mo><mi id="S3.Ex2.m1.5.5" xref="S3.Ex2.m1.5.5.cmml">K</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.7b"><apply id="S3.Ex2.m1.7.7.3.cmml" xref="S3.Ex2.m1.7.7.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.7.7.3a.cmml" xref="S3.Ex2.m1.7.7.2.3">formulae-sequence</csymbol><apply id="S3.Ex2.m1.6.6.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1"><eq id="S3.Ex2.m1.6.6.1.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1.2"></eq><apply id="S3.Ex2.m1.6.6.1.1.3.cmml" xref="S3.Ex2.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.3.1.cmml" xref="S3.Ex2.m1.6.6.1.1.3">superscript</csymbol><apply id="S3.Ex2.m1.6.6.1.1.3.2.cmml" xref="S3.Ex2.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.3.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.6.6.1.1.3.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.3.2.2">ℳ</ci><ci id="S3.Ex2.m1.6.6.1.1.3.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.3.2.3">𝑘</ci></apply><ci id="S3.Ex2.m1.6.6.1.1.3.3.cmml" xref="S3.Ex2.m1.6.6.1.1.3.3">𝑡</ci></apply><apply id="S3.Ex2.m1.6.6.1.1.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S3.Ex2.m1.6.6.1.1.1.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.2">conditional-set</csymbol><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝑖</ci><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.1.3a.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1"><in id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.1"></in><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.2">𝑖</ci><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.1.1.3">ℳ</ci></apply><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2"><eq id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.1"></eq><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2">superscript</csymbol><apply id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.2">𝑠</ci><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.2.3">𝑡</ci></apply><ci id="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex2.m1.6.6.1.1.1.1.1.2.2.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.Ex2.m1.7.7.2.2.cmml" xref="S3.Ex2.m1.7.7.2.2"><eq id="S3.Ex2.m1.7.7.2.2.1.cmml" xref="S3.Ex2.m1.7.7.2.2.1"></eq><apply id="S3.Ex2.m1.7.7.2.2.2.cmml" xref="S3.Ex2.m1.7.7.2.2.2"><csymbol cd="latexml" id="S3.Ex2.m1.7.7.2.2.2.1.cmml" xref="S3.Ex2.m1.7.7.2.2.2.1">for-all</csymbol><ci id="S3.Ex2.m1.7.7.2.2.2.2.cmml" xref="S3.Ex2.m1.7.7.2.2.2.2">𝑘</ci></apply><list id="S3.Ex2.m1.7.7.2.2.3.1.cmml" xref="S3.Ex2.m1.7.7.2.2.3.2"><cn type="integer" id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2">1</cn><cn type="integer" id="S3.Ex2.m1.3.3.cmml" xref="S3.Ex2.m1.3.3">2</cn><ci id="S3.Ex2.m1.4.4.cmml" xref="S3.Ex2.m1.4.4">…</ci><ci id="S3.Ex2.m1.5.5.cmml" xref="S3.Ex2.m1.5.5">𝐾</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.7c">\mathcal{M}_{k}^{t}=\{i|i\in\mathcal{M},s_{i}^{t}=k\},\forall k=1,2,\ldots,K</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS3.p1.8" class="ltx_p">is the set of devices with the same cluster identity <math id="S3.SS1.SSS3.p1.7.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.SSS3.p1.7.m1.1a"><mi id="S3.SS1.SSS3.p1.7.m1.1.1" xref="S3.SS1.SSS3.p1.7.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.7.m1.1b"><ci id="S3.SS1.SSS3.p1.7.m1.1.1.cmml" xref="S3.SS1.SSS3.p1.7.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.7.m1.1c">k</annotation></semantics></math> at iteration <math id="S3.SS1.SSS3.p1.8.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.SSS3.p1.8.m2.1a"><mi id="S3.SS1.SSS3.p1.8.m2.1.1" xref="S3.SS1.SSS3.p1.8.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS3.p1.8.m2.1b"><ci id="S3.SS1.SSS3.p1.8.m2.1.1.cmml" xref="S3.SS1.SSS3.p1.8.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS3.p1.8.m2.1c">t</annotation></semantics></math>.</p>
</div>
<div id="S3.SS1.SSS3.p2" class="ltx_para">
<p id="S3.SS1.SSS3.p2.1" class="ltx_p">In order to demonstrate that proposed algorithm brings better performance to the clustered FL training, we also use test accuracy to measure the training effect of clustered FL.
While splitting the training dataset, we also split the test dataset for each user which has the same sample distribution as their training dataset.
The total test accuracy of the clustered FL system is obtained by averaging test accuracy of all users.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Results Analysis</span>
</h3>

<figure id="S3.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F4.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x4.png" id="S3.F4.1.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F4.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x5.png" id="S3.F4.2.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F4.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x6.png" id="S3.F4.3.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F4.4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x7.png" id="S3.F4.4.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F4.5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x8.png" id="S3.F4.5.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F4.6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x9.png" id="S3.F4.6.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance metrics vary as the number of clustered FL iterations changes on MNIST experiment.</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.8" class="ltx_p">In Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we show how the clustering purity, training loss, and test accuracy vary as the number of training iterations changes. This experiment is implemented over MNIST dataset.
Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, and Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> are results of MNIST experiments where MLP is used as FL models, while Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, and Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> are results of experiments where CNN is used as FL models.
Figs. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> show how clustering purity changes as the number of iterations increases.
From Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we see that the proposed algorithm with <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\lambda=0.2" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">λ</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><eq id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></eq><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝜆</ci><cn type="float" id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\lambda=0.2</annotation></semantics></math> can reduce <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="99" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mn id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">99</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><cn type="integer" id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">99</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">99</annotation></semantics></math>% iterations to achieve <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mn id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><cn type="float" id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">0.9</annotation></semantics></math> clustering purity compared to the baseline.
This is because the proposed clustered FL algorithm jointly uses gradient direction and loss value to cluster devices.
From Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we also see that when <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\lambda</annotation></semantics></math> changes from <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mn id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><cn type="float" id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">0.1</annotation></semantics></math> to <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mn id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><cn type="float" id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">0.5</annotation></semantics></math>, the proposed algorithm can achieve higher purity at the beginning.
This is because the gradient direction can cluster devices better than loss value at the beginning, therefore higher weight for gradient direction brings better performance.
Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> show that the proposed clustered FL algorithm can reduce <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="14" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mn id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">14</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><cn type="integer" id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">14</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">14</annotation></semantics></math>% iterations to achieve <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mn id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><cn type="float" id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">0.8</annotation></semantics></math> test accuracy compared to the baseline.
Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, Fig. <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, and Fig <a href="#S3.F4" title="Figure 4 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> show that when CNN is used as FL model, the cluster performance and training efficiency of the proposed algorithm is also better, compared to the baseline.
This stems from the fact that the clustering process of the proposed algorithm is more efficient, which accelerates the training of FL.</p>
</div>
<figure id="S3.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F5.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x10.png" id="S3.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S3.F5.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x11.png" id="S3.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S3.F5.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2311.13665/assets/x12.png" id="S3.F5.3.g1" class="ltx_graphics ltx_img_landscape" width="152" height="100" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Clustering Purities vary as the number of iterations increases on FashionMNIST, CIFAR10, EMNIST experiment.</figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.4" class="ltx_p">In Fig. <a href="#S3.F5" title="Figure 5 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we show how the clustering purity varies as the number of training iteration increases in experiments implemented over FashionMNIST, CIFAR10, and EMNIST.
From Fig. <a href="#S3.F5" title="Figure 5 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, Fig. <a href="#S3.F5" title="Figure 5 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, and Fig. <a href="#S3.F5" title="Figure 5 ‣ III-B Results Analysis ‣ III Simulation Results and Analysis ‣ A Joint Gradient and Loss Based Clustered Federated Learning Design" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we see that the proposed algorithm respectfully reduces iterations required to achieve <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mn id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><cn type="float" id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">0.9</annotation></semantics></math> clustering purity by up to <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="98" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">98</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><cn type="integer" id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">98</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">98</annotation></semantics></math>%, <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="21" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mn id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">21</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><cn type="integer" id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">21</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">21</annotation></semantics></math>% and <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="97" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mn id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">97</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><cn type="integer" id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">97</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">97</annotation></semantics></math>% compared to the baseline.
This is because the proposed algorithm can jointly use gradient direction and loss value to cluster devices.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this paper, we have developed a novel clustered FL framework that enables distributed edge devices with non-IID data to independently form several clusters in a distributed manner and implement FL training within each cluster.
In particular, our designed device method considered two unique FL features: 1) limited FL training information and computational power at the PS and 2) each device does not have the data information of other devices for device clustering and can only use global FL model parameters received from the server and its data information to determine its cluster identity. We have proposed a joint gradient and loss based distributed clustering method, in which each device determines its cluster identity considering the gradient similarity and training loss.
The proposed clustering method not only considers how a local FL model of one device contributes to each cluster but also the direction of gradient descent thus improving clustering speed.
Simulation results over multiple datasets demonstrate that our proposed clustered FL algorithm can yield significant gains compared to the existing method.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proc. Artificial Intelligence and Statistics</em>, Fort
Lauderdale, FL, USA, April 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
A. Ghosh, J. Hong, D. Yin, and K. Ramchandran, “Robust federated learning in a
heterogeneous environment,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.06629</em>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
C. Briggs, Z. Fan, and P. Andras, “Federated learning with hierarchical
clustering of local updates to improve training on non-IID data,” in
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proc. International Joint Conference on Neural Networks (IJCNN)</em>,
Glasgow, UK, July 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
F. Sattler, K.-R. Müller, and W. Samek, “Clustered federated learning:
Model-agnostic distributed multitask optimization under privacy
constraints,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning
Systems</em>, vol. 32, no. 8, pp. 3710–3722, August 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
A. Ghosh, J. Chung, D. Yin, and K. Ramchandran, “An efficient framework for
clustered federated learning,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Information
Theory</em>, vol. 68, no. 12, pp. 8076–8091, July 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
F. Sattler, K.-R. Müller, T. Wiegand, and W. Samek, “On the byzantine
robustness of clustered federated learning,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE
International Conference on Acoustics, Speech and Signal Processing
(ICASSP)</em>, Barcelona, Spain, May 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
L. U. Khan, M. Alsenwi, Z. Han, and C. S. Hong, “Self organizing federated
learning over wireless networks: A socially aware clustering approach,” in
<em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proc. International Conference on Information Networking (ICOIN)</em>,
Barcelona, Spain, Jan. 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
A. Albaseer, M. Abdallah, A. Al-Fuqaha, and A. Erbad, “Client selection
approach in support of clustered federated learning over wireless edge
networks,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proc. IEEE Global Communications Conference (GLOBECOM)</em>,
Madrid, Spain, Dec. 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Y. Kim, E. Al Hakim, J. Haraldson, H. Eriksson, J. M. B. da Silva, and
C. Fischione, “Dynamic clustering in federated learning,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proc.
IEEE International Conference on Communications</em>, Montreal, QC, Canada, June
2021, pp. 1–6.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
C. Feng, H. H. Yang, D. Hu, Z. Zhao, T. Q. Quek, and G. Min, “Mobility-aware
cluster federated learning in hierarchical wireless networks,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">IEEE
Transactions on Wireless Communications</em>, vol. 21, no. 10, pp. 8441–8458,
April 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner, “Gradient-based learning
applied to document recognition,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, vol. 86,
no. 11, pp. 2278–2324, 1998.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
H. Xiao, K. Rasul, and R. Vollgraf. (2017) Fashion-MNIST: A novel image
dataset for benchmarking machine learning algorithms.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
A. Krizhevsky, “Learning multiple layers of features from tiny images,”
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic"><span id="bib.bib14.1.1.1" class="ltx_text ltx_font_upright">Available Online</span>:
https://www.cs.toronto.edu/ kriz/learning-features-2009-TR.pdf</em>, April 2009.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
G. Cohen, S. Afshar, J. Tapson, and A. Van Schaik, “EMNIST: Extending mnist
to handwritten letters,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proc. International Joint Conference on
Neural Networks (IJCNN)</em>, Anchorage, AK, USA, May 2017.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2311.13664" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2311.13665" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2311.13665">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2311.13665" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2311.13666" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 17:38:48 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
